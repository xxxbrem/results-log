2025-01-19 03:15:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:16:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:16:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-01-19 03:16:26 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:27 - root - INFO - SQL:
-- Query 1: Get distinct country codes from the PUBLICATIONS table
SELECT DISTINCT "country_code" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000
Results:
country_code
JP
GB
BE
FI
DK
WO
EP
LU
CA
NL
RU
KR
US
DE
ES
CN
FR

2025-01-19 03:16:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-19 03:16:28 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:28 - root - INFO - SQL:
-- Query 2: Get distinct kind codes from the PUBLICATIONS table
SELECT DISTINCT "kind_code" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000
Results:
kind_code
B1
S
D2
U8
H
C1
T0
A5
Y2
T2
C9
U4
P1
R2
V0
B8
F
R1
L
A0
B9
E1
C3
A7
K4
Z1
A1
T3
H1
T7
A4
T5
A8
I5
I2
B
Y1
K1
R
A
B3
T4
P
T8
U0
T1
Y4
A2
I4
Y
T9
I1
U9
P2
P3
D1
C2
B4
C5
H3
A3
K5
U1
A6
C
U
S1
U3
M
T
B2
A9
D0
E

2025-01-19 03:16:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:30 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:30 - root - INFO - SQL:
-- Query 3: Retrieve publication numbers and grant dates for US B2 patents granted between 2010 and 2014
SELECT "publication_number", "grant_date" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "country_code" = 'US' 
  AND "kind_code" = 'B2' 
  AND "grant_date" BETWEEN 20100101 AND 20141231 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,grant_date
US-8908679-B2,20141209
US-7960413-B2,20110614
US-7704877-B2,20100427
US-7727473-B2,20100601
US-8425821-B2,20130423
US-8899209-B2,20141202
US-8499502-B2,20130806
US-8207994-B2,20120626
US-7932928-B2,20110426
US-8858390-B2,20141014
US-8902701-B2,20141202
US-8836621-B2,20140916
US-8130625-B2,20120306
US-8846234-B2,20140930
US-7846394-B2,20101207
US-8087045-B2,20111227
US-8684320-B2,20140401
US-8639874-B2,20140128
US-8527303-B2,20130903
US-8697506-B2,20140415
US-8779491-B2,20140715
US-8622869-B2,20140107
US-8194070-B2,20120605
US-8618832-B2,20131231
US-8303190-B2,20121106
US-7869016-B2,20110111
US-8609823-B2,20131217
US-8717022-B2,20140506
US-8843939-B2,20140923
US-8144627-B2,20120327
US-8631198-B2,20140114
US-8764962-B2,20140701
US-8563362-B2,20131022
US-7836829-B2,20101123
US-8503430-B2,20130806
US-7813884-B2,20101012
US-8539588-B2,20130917
US-8898576-B2,20141125
US-8694495-B2,20140408
US-8479056-B2,20130702
US-8450859-B2,20130528
US-8021293-B2,20110920
US-8436539-B2,20130507
US-8759357-B2,20140624
US-8353788-B2,20130115
US-8278976-B2,20121002
US-8434758-B2,20130507
US-8444050-B2,20130521
US-8069254-B2,20111129
US-8689073-B2,20140401
US-8786203-B2,20140722
US-7882056-B2,20110201
US-8076449-B2,20111213
US-8257725-B2,20120904
US-8613270-B2,20131224
US-7935790-B2,20110503
US-8356512-B2,20130122
US-7711138-B2,20100504
US-8824537-B2,20140902
US-8823688-B2,20140902
US-8583474-B2,20131112
US-7658251-B2,20100209
US-8919085-B2,20141230
US-8190360-B2,20120529
US-7678644-B2,20100316
US-8733316-B2,20140527
US-7896350-B2,20110301
US-8020161-B2,20110913
US-7987607-B2,20110802
US-7648844-B2,20100119
US-7919545-B2,20110405
US-8546892-B2,20131001
US-8267738-B2,20120918
US-8570935-B2,20131029
US-7944114-B2,20110517
US-7662837-B2,20100216
US-8831557-B2,20140909
US-8509035-B2,20130813
US-8240654-B2,20120814
US-8039409-B2,20111018
US-8399879-B2,20130319
US-8558957-B2,20131015
US-8119772-B2,20120221
US-8389713-B2,20130305
US-8629558-B2,20140114
US-8513702-B2,20130820
US-8515341-B2,20130820
US-8027159-B2,20110927
US-8253921-B2,20120828
US-8391624-B2,20130305
US-7678577-B2,20100316
US-8883278-B2,20141111
US-8768937-B2,20140701
US-8527172-B2,20130903
US-7916232-B2,20110329
US-8179406-B2,20120515
US-8512590-B2,20130820
US-8597297-B2,20131203
US-8195593-B2,20120605
US-8043863-B2,20111025
US-8298048-B2,20121030
US-8468999-B2,20130625
US-8563604-B2,20131022
US-8388547-B2,20130305
US-7919127-B2,20110405
US-7960124-B2,20110614
US-8360677-B2,20130129
US-8120188-B2,20120221
US-8510585-B2,20130813
US-7972997-B2,20110705
US-8345648-B2,20130101
US-8907742-B2,20141209
US-8358913-B2,20130122
US-8715559-B2,20140506
US-8255820-B2,20120828
US-8921814-B2,20141230
US-8734946-B2,20140527
US-8817655-B2,20140826
US-8246978-B2,20120821
US-8616292-B2,20131231
US-8815476-B2,20140826
US-8726198-B2,20140513
US-8277534-B2,20121002
US-8862262-B2,20141014
US-7756270-B2,20100713
US-8313878-B2,20121120
US-7824486-B2,20101102
US-8687170-B2,20140401
US-8563509-B2,20131022
US-7989172-B2,20110802
US-8136703-B2,20120320
US-7852716-B2,20101214
US-7818987-B2,20101026
US-7885873-B2,20110208
US-8043372-B2,20111025
US-8146530-B2,20120403
US-7755655-B2,20100713
US-8518710-B2,20130827
US-7871625-B2,20110118
US-7701466-B2,20100420
US-7854621-B2,20101221
US-8246536-B2,20120821
US-7746216-B2,20100629
US-8907126-B2,20141209
US-7831285-B2,20101109
US-8912169-B2,20141216
US-7753494-B2,20100713
US-8632084-B2,20140121
US-7923105-B2,20110412
US-8335430-B2,20121218
US-8495918-B2,20130730
US-8770810-B2,20140708
US-8432488-B2,20130430
US-7728626-B2,20100601
US-8445009-B2,20130521
US-8509891-B2,20130813
US-8834270-B2,20140916
US-8109540-B2,20120207
US-7911653-B2,20110322
US-8729226-B2,20140520
US-8842218-B2,20140923
US-8287432-B2,20121016
US-8810656-B2,20140819
US-7926244-B2,20110419
US-7952029-B2,20110531
US-8470434-B2,20130625
US-7946504-B2,20110524
US-8779972-B2,20140715
US-8685118-B2,20140401
US-8553716-B2,20131008
US-8549245-B2,20131001
US-8491897-B2,20130723
US-8874103-B2,20141028
US-7707114-B2,20100427
US-8130173-B2,20120306
US-7978780-B2,20110712
US-7800606-B2,20100921
US-8497546-B2,20130730
US-8797438-B2,20140805
US-8304245-B2,20121106
US-8897526-B2,20141125
US-7804071-B2,20100928
US-8124536-B2,20120228
US-8804737-B2,20140812
US-7830628-B2,20101109
US-8527566-B2,20130903
US-8502997-B2,20130806
US-8020794-B2,20110920
US-8329868-B2,20121211
US-7756645-B2,20100713
US-8649809-B2,20140211
US-8021985-B2,20110920
US-8264652-B2,20120911
US-8301234-B2,20121030
US-8216606-B2,20120710
US-8061906-B2,20111122
US-7820716-B2,20101026
US-8314237-B2,20121120
US-8267034-B2,20120918
US-8173292-B2,20120508
US-7796644-B2,20100914
US-8906215-B2,20141209
US-7996845-B2,20110809
US-8454000-B2,20130604
US-8811454-B2,20140819
US-7830641-B2,20101109
US-8527950-B2,20130903
US-8071712-B2,20111206
US-8852491-B2,20141007
US-8592044-B2,20131126
US-8583693-B2,20131112
US-8109010-B2,20120207
US-7829013-B2,20101109
US-8855718-B2,20141007
US-8011363-B2,20110906
US-7725227-B2,20100525
US

2025-01-19 03:16:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:32 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:32 - root - INFO - SQL:
-- Query 4: Retrieve publication numbers and filing dates where filing date is available
SELECT "publication_number", "filing_date" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "filing_date" IS NOT NULL 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-

2025-01-19 03:16:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:33 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:34 - root - INFO - SQL:
-- Query 5: Retrieve publication numbers and number of backward citations
SELECT "publication_number", ARRAY_SIZE("citation") AS "num_backward_citations" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,num_backward_citations
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,0
ES-8501233-A1,0
CA-2165155-A1,0
FR-2409943-B1,0
GB-1086860-A,0
JP-S54117658-A,0
JP-H0710178-Y2,0
JP-3172057-B2,0
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,0
DE-1479218-U,0
EP-2512367-B1,0
ES-2312527-T3,0
FR-1000748-A,0
FR-1573809-A,0
JP-S5066757-U,0
JP-S5845249-Y2,0
US-2103405-A,0
GB-201114438-D0,0
JP-5707248-B2,0
JP-2016211567-A,0
KR-20040075216-A,0
CN-1954806-A,0
CN-201399214-Y,0
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,0
DE-2707796-A1,0
DE-2962208-D1,0
FR-2233137-A1,0
GB-2224027-B,0
JP-S5911756-Y2,0
JP-2000218515-A,0
JP-S56169301-A,0
US-2002102047-A1,0
CN-1467804-A,0
EP-0988417-B1,0
JP-H04334685-A,0
JP-S6359143-U,0
JP-H0685910-B2,0
JP-H0350567-B2,0
JP-5108773-B2,0
CN-2768052-Y,0
CN-1940157-B,0
CN-202318915-U,0
CN-203200362-U,0
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,0
CA-118661-S,0
FI-882364-A0,0
CA-810158-A,0
DE-2335240-A1,0
DE-7610943-U1,0
JP-H0673947-U,0
JP-S54153049-A,0
JP-S5716116-U,0
US-548167-A,0
CN-1055840-A,0
JP-S6020713-A,0
JP-S6234024-A,0
JP-H0995081-A,0
JP-H1088758-A,0
GB-189709494-A,0
JP-2001195445-A,0
JP-2010101160-A,0
CN-101746294-A,0
CN-104170353-A,0
CN-206056613-U,0
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,0
CA-564325-A,0
GB-0802422-D0,0
JP-S53139175-U,0
JP-H01150349-U,0
JP-2600796-Y2,0
JP-S591896-U,0
JP-S4922438-B1,0
US-419959-A,0
DE-69331528-D1,0
DE-69430885-T2,0
EP-1474362-B1,0
JP-2000346423-A,0
JP-2765752-B2,0
KR-900003183-Y1,0
JP-2003229053-A,0
JP-2007241524-A,0
JP-5129599-B2,0
KR-100547071-B1,0
KR-20070020426-A,0
KR-20130050682-A,0
CN-204556165-U,0
ES-66185-Y,0
CA-1331409-C,0
FI-891492-A0,0
GB-1348507-A,0
JP-S60179587-U,0
US-332138-A,0
CN-1112492-C,0
DE-566539-C,0
DE-845109-C,0
JP-S63125649-A,0
JP-S6423693-U,0
JP-S5243021-U,0
JP-S5566205-U,0
JP-H0825023-B2,0
JP-2003215980-A,0
JP-4255884-B2,0
KR-100295305-B1,0
CN-101547005-A,0
CN-101988676-A,0
CN-203259375-U,0
CN-205932945-U,0
DE-202006018912-U1,0
FR-2828332-A1,0
GB-1375879-A,0
JP-S53161674-U,0
US-2053075-A,0
CN-2484753-Y,0
CN-1212523-A,0
FI-20010786-A,0
JP-S6359144-U,0
JP-2799203-B2,0
JP-H08143121-A,0
US-1837725-A,0
US-2304134-A,0
US-1864623-A,0
JP-5991128-B2,0
JP-2016105749-A,0
RU-2191214-C2,0
RU-2008140707-A,0
CN-103265598-B,0
CN-203928708-U,0
CN-204557664-U,0
CN-206326242-U,0
CN-104559893-B,0
CN-106856628-A,0
US-6778773-B2,21
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,0
FR-877274-A,0
JP-S60218905-A,0
JP-H04326774-A,0
JP-S5125160-A,0
FR-1012104-A,0
JP-S5944363-A,0
JP-H081564-A,0
US-1233474-A,0
US-2002011230-A1,0
JP-2003169856-A,0
US-811638-A,0
KR-200338652-Y1,0
KR-20070041890-A,0
CN-1816294-A,0
CN-2858160-Y,0
CN-201276086-Y,0
CN-201816145-U,0
CN-102907994-A,0
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,0
ES-146285-Y,0
GB-478690-A,0
DE-2649618-B2,0
DE-3766112-D1,0
DE-8007402-U1,0
FR-390089-A,0
FR-638126-A,0
FR-2638622-B1,0
JP-H0584037-U,0
JP-S4739450-Y1,0
JP-H0642846-U,0
NL-296405-A,0
NL-7211943-A,0
EP-2781788-B1,0
JP-S5072414-U,0
JP-S5846920-U,0
JP-S5874811-U,0
JP-S5687776-U,0
US-D279853-S,0
KR-920008597-Y1,0
JP-2004313014-A,0
JP-6137070-B2,0
RU-2008132286-A,0
US-754320-A,0
CN-105823611-A,0
CN-106739164-A,0
CN-205558012-U,0
BE-512467-A,0
CA-2244766-A1,0
DE-1803332-A1,0
DE-2149141-A1,0
GB-2089320-A,0
JP-S62164685-U,0
JP-H066780-Y2,0
DE-69322442-T2,0
EP-1933436-B1,0
EP-0782478-B1,0
EP-0993180-B1,0
JP-S5128923-U,0
JP-S5153284-U,0
JP-S5376919-A,0
JP-3340813-B2,0
JP-2000192758-A,0
JP-H11193667-A,0
RU-17326-U1,0
KR-20110049427-A,0
CN-101531763-A,0
CN-201900010-U,0
CN-202142477-U,0
CN-202417422-U,0
CN-202807027-U,0
CA-27189-A,0
JP-S4874140-A,0
JP-2887866-B2,0
FR-2239893-A5,0
JP-H09201246-A,0
JP-S6125607-Y2,0
JP-H069665-Y2,0
JP-H02145867-U,0
DE-1899993-U,0
DK-1279779-T3,0
EP-1395943-B1,0
JP-S61104472-A,0
US-3605178-A,0
ES-2301340-B1,0
KR-890006762-Y1,0
KR-910005717-Y1,0
JP-WO2006134667-A1,0
JP-WO2011121828-A1,0
JP-6013229-B2,0
KR-200371816-Y1,0
KR-20040093694-A,0
CN-104911016-A,0
JP-1721970-C,0
JP-H00979262-A,0
JP-2045702-C,0
CA-607467-A,0
CA-870537-A,0
DE-2913333-C2,0
GB-2156898-B,0
GB-9701425-D0,0
DE-69108459-T2,0
DE-69402587-D1,0
DE-690465-C,0
JP-S5354430-A,0
JP-S5788835-A,0
JP-H0510017-A,0
JP-H08159838-A,0
US-1863894-A,0
JP-4882580-B2,0
JP-5210626-B2,0
RU-2345965-C2,0
RU-2355420-C2,0
KR-100352139-B1,0
KR-100387884-B1,0
KR-20120048256-A,0
CN-201742521-U,0
CN-202693633-U,0
CN-202679530-U,0
CN-106625363-A,0
CN-205519698-U,0
JP-1260064-C,0
DE-54582-C,0
ES-128308-A1,0
DE-2516533-A1,0
GB-0905075-D0,0
GB-192211-A,0
JP-2605593-Y2,0
JP-S5020200-Y2,0
JP-S524076-A,0
DE-19811661-A1,0
DE-29605835-U1,0
DE-69131766-T2,0
EP-2982223-A2,0
EP-0172283-B1,0
JP-S5743740-U,0
JP-H04296316-A,0
US-D487006-S,0
US-3538803-A,0
US-2002044447-A1,0
JP-2003225526-A,0
JP-2005299236-A,0
JP-2010128199-A,0
KR-101187803-B1,0
CN-201628697-U,0
CA-1192088-A1,0
JP-1028326-C,0
BE-782111-A1,0
CA-1190527-A,0
CA-2093193-C,0
DE-130839-C,0
ES-2051228-B1,0
FR-554877-A,0
FR-2636364-B1,0
JP-S57153931-A,0
JP-S5224357-Y2,0
JP-H04314168-A,0
DE-19851242-

2025-01-19 03:16:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:16:35 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:36 - root - INFO - SQL:
-- Query 6: Explore the structure of the "citation" field for one patent
SELECT "publication_number", "citation" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "citation" IS NOT NULL 
LIMIT 1
Results:
publication_number,citation
JP-1810118-C,[]

2025-01-19 03:16:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:37 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:38 - root - INFO - SQL:
-- Query 7: List all cited publication numbers by flattening the "citation" field
SELECT "publication_number", f.value::VARIANT:"publication_number"::STRING AS "cited_publication_number" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS, 
     LATERAL FLATTEN(input => "citation") f 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,cited_publication_number
US-6778773-B2,US-4067027-A
US-6778773-B2,US-4262988-A
US-6778773-B2,JP-S5779909-A
US-6778773-B2,US-4400065-A
US-6778773-B2,JP-S6296919-A
US-6778773-B2,JP-H052132-A
US-6778773-B2,JP-H062330-A
US-6778773-B2,JP-H078848-A
US-6778773-B2,JP-H07283978-A
US-6778773-B2,US-5583692-A
US-6778773-B2,US-5729390-A
US-6778773-B2,US-5926657-A
US-6778773-B2,JP-H11248996-A
US-6778773-B2,US-6088053-A
US-6778773-B2,WO-0152531-A1
US-6778773-B2,JP-2001281555-A
US-6778773-B2,US-2001028498-A1
US-6778773-B2,JP-2001311868-A
US-6778773-B2,US-6476963-B1
US-6778773-B2,
US-6778773-B2,
EP-2042690-A2,JP-H05141259-A
EP-2042690-A2,JP-H1019045-A
EP-2295559-A1,GB-1358599-A
EP-2295559-A1,GB-2094826-A
EP-2295559-A1,GB-2095275-A
EP-2295559-A1,US-4435307-A
EP-2295559-A1,US-4816567-A
EP-2295559-A1,US-4822516-A
EP-2295559-A1,WO-9104673-A1
EP-2295559-A1,WO-9206209-A1
EP-2295559-A1,US-5246853-A
EP-2295559-A1,WO-9428117-A1
EP-2295559-A1,US-5475101-A
EP-2295559-A1,US-5648263-A
EP-2295559-A1,US-5650322-A
EP-2295559-A1,US-5691178-A
EP-2295559-A1,WO-9821339-A1
EP-2295559-A1,US-5776757-A
EP-2295559-A1,WO-9831821-A2
EP-2295559-A1,US-5861271-A
EP-2295559-A1,US-6162782-A
EP-2295559-A1,WO-0104284-A1
EP-2295559-A1,US-6255115-B1
EP-2295559-A1,US-6599722-B2
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
JP-2013069423-A,JP-2006066328-A
JP-2013069423-A,JP-2006120691-A
JP-2013069423-A,WO-2011089805-A1
JP-2013069423-A,JP-2011150264-A
WO-9837591-A1,US-4209789-A
EP-2372484-A2,
US-6979660-B2,US-4403012-A
US-6979660-B2,US-4411854-A
US-6979660-B2,US-4413110-A
US-6979660-B2,US-4422993-A
US-6979660-B2,US-4430383-A
US-6979660-B2,US-4436689-A
US-6979660-B2,US-4455273-A
US-6979660-B2,US-4457985-A
US-6979660-B2,US-4501856-A
US-6979660-B2,US-4536536-A
US-6979660-B2,US-4543286-A
US-6979660-B2,US-4545950-A
US-6979660-B2,US-4551296-A
US-6979660-B2,US-4563392-A
US-6979660-B2,US-4584347-A
US-6979660-B2,US-4613535-A
US-6979660-B2,US-4623574-A
US-6979660-B2,US-4650710-A
US-6979660-B2,US-4663101-A
US-6979660-B2,US-4681792-A
US-6979660-B2,US-4737401-A
US-6979660-B2,US-4737402-A
US-6979660-B2,US-4748064-A
US-6979660-B2,US-4820568-A
US-6979660-B2,US-4858287-A
US-6979660-B2,US-4883700-A
US-6979660-B2,US-4916000-A
US-6979660-B2,US-4953234-A
US-6979660-B2,US-5006390-A
US-6979660-B2,US-5061545-A
US-6979660-B2,US-5112667-A
US-6979660-B2,US-5124195-A
US-6979660-B2,US-5160776-A
US-6979660-B2,US-5165989-A
US-6979660-B2,US-5167876-A
US-6979660-B2,US-5175040-A
US-6979660-B2,US-5185195-A
US-6979660-B2,US-5187023-A
US-6979660-B2,US-5190802-A
US-6979660-B2,US-5196252-A
US-6979660-B2,US-5248471-A
US-6979660-B2,US-5330820-A
US-6979660-B2,US-5343796-A
US-6979660-B2,US-5376426-A
US-6979660-B2,US-5440965-A
US-6979660-B2,US-5471906-A
US-6979660-B2,US-5480706-A
US-6979660-B2,US-5525414-A
US-6979660-B2,US-5552208-A
US-6979660-B2,US-5578374-A
US-6979660-B2,US-5587230-A
US-6979660-B2,US-5677029-A
US-6979660-B2,US-5736244-A
US-6979660-B2,US-5741451-A
US-6979660-B2,US-5788907-A
US-6979660-B2,US-5804015-A
US-6979660-B2,US-5958804-A
US-6979660-B2,US-5972498-A
US-6979660-B2,US-6003424-A
US-6979660-B2,US-6219842-B1
US-697966

2025-01-19 03:16:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 03:16:40 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:41 - root - INFO - SQL:
-- Query 8: Retrieve publication numbers and embeddings from the ABS_AND_EMB table
SELECT "publication_number", "embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 

2025-01-19 03:16:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:42 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:42 - root - INFO - SQL:
-- Query 9: Get the size of the embeddings vector in the ABS_AND_EMB table
SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_size" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_size
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,64
DK-45

2025-01-19 03:16:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:44 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:44 - root - INFO - SQL:
-- Query 10: Get filing dates and grant dates to calculate the time between filing and grant
SELECT "publication_number", "filing_date", "grant_date", ("grant_date" - "filing_date") AS "processing_time" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "filing_date" IS NOT NULL AND "grant_date" IS NOT NULL 
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date,grant_date,processing_time
JP-1810118-C,0,0,0
JP-1203714-C,0,0,0
FR-1500580-A,19661104,19671103,9999
ES-8501233-A1,19831124,0,-19831124
CA-2165155-A1,19940603,0,-19940603
FR-2409943-B1,19771125,19800822,29697
GB-1086860-A,19660422,0,-19660422
JP-S54117658-A,19780306,0,-19780306
JP-H0710178-Y2,19880302,19950308,70006
JP-3172057-B2,19950405,20010604,60199
US-136580-A,0,18730311,18730311
US-272220-A,0,18830213,18830213
US-599187-A,0,18980215,18980215
CN-1062411-C,19940709,20010228,69519
DE-1479218-U,0,0,0
EP-2512367-B1,20101209,20131113,29904
ES-2312527-T3,20021205,20090301,69096
FR-1000748-A,19491117,19520215,29098
FR-1573809-A,19640424,19690711,50287
JP-S5066757-U,19731018,0,-19731018
JP-S5845249-Y2,19751212,19831014,79802
US-2103405-A,19310429,19371228,60799
GB-201114438-D0,20110822,20111005,183
JP-5707248-B2,20110622,20150422,39800
JP-2016211567-A,20160502,0,-20160502
KR-20040075216-A,20030220,0,-20030220
CN-1954806-A,20051027,0,-20051027
CN-201399214-Y,20090409,20100210,9801
JP-1368881-C,0,0,0
JP-1444589-C,0,0,0
FR-1497898-A,19661027,19671013,9986
DE-2707796-A1,19770223,0,-19770223
DE-2962208-D1,19790928,19820325,29397
FR-2233137-A1,19740617,0,-19740617
GB-2224027-B,19891011,19920115,29104
JP-S5911756-Y2,19790131,19840410,50279
JP-2000218515-A,19990204,0,-19990204
JP-S56169301-A,19800602,0,-19800602
US-2002102047-A1,20020226,0,-20020226
CN-1467804-A,20020712,0,-20020712
EP-0988417-B1,19980603,20060823,80220
JP-H04334685-A,19910509,0,-19910509
JP-S6359143-U,19861007,0,-19861007
JP-H0685910-B2,19851219,19941102,89883
JP-H0350567-B2,19840507,19910802,70295
JP-5108773-B2,20060829,20121226,60397
CN-2768052-Y,20041102,20060329,19227
CN-1940157-B,20060925,20110413,49488
CN-202318915-U,20111123,20120711,9588
CN-203200362-U,20130419,20130918,499
JP-897785-C,0,0,0
JP-1789132-C,0,0,0
JP-S62113530-U,19860109,0,-19860109
CA-118661-S,20061213,20080124,18911
FI-882364-A0,19880519,0,-19880519
CA-810158-A,0,19690408,19690408
DE-2335240-A1,19730711,0,-19730711
DE-7610943-U1,19760408,19760729,321
JP-H0673947-U,19930324,0,-19930324
JP-S54153049-A,19780523,0,-19780523
JP-S5716116-U,19800624,0,-19800624
US-548167-A,0,18951015,18951015
CN-1055840-A,19910408,0,-19910408
JP-S6020713-A,19830713,0,-19830713
JP-S6234024-A,19850806,0,-19850806
JP-H0995081-A,19951002,0,-19951002
JP-H1088758-A,19960917,0,-19960917
GB-189709494-A,18970414,0,-18970414
JP-2001195445-A,20001128,0,-20001128
JP-2010101160-A,20091021,0,-20091021
CN-101746294-A,20090903,0,-20090903
CN-104170353-A,20131227,0,-20131227
CN-206056613-U,20160726,20170329,9603
JP-1032657-C,0,0,0
JP-1654837-C,0,0,0
DK-146223-C,19720608,19840109,119501
CA-564325-A,0,19581007,19581007
GB-0802422-D0,20080208,20080319,111
JP-S53139175-U,19770408,0,-19770408
JP-H01150349-U,19880407,0,-19880407
JP-2600796-Y2,19921015,19991025,70010
JP-S591896-U,19820628,0,-19820628
JP-S4922438-B1,19691202,19740608,49406
US-419959-A,0,18900121,18900121
DE-69331528-D1,19931110,20020314,89204
DE-69430885-T2,19940405,20030130,89725
EP-1474362-B1,20030211,20061122,30911
JP-2000346423-A,19990531,0,-19990531
JP-2765752-B2,19900926,19980618,79692
KR-900003183-Y1,19870430,19900414,29984
JP-2003229053-A,20020131,0,-20020131
JP-2007241524-A,20060307,0,-20060307
JP-5129599-B2,20080208,20130130,49922
KR-100547071-B1,20030228,20060131,29903
KR-20070020426-A,20050210,0,-20050210
KR-20130050682-A,20111108,0,-20111108
CN-204556165-U,20150506,20150812,306
ES-66185-Y,19580519,19581201,682
CA-1331409-C,19891023,19940809,49786
FI-891492-A0,19890329,0,-19890329
GB-1348507-A,19710419,0,-19710419
JP-S60179587-U,19840510,0,-19840510
US-332138-A,0,18851208,18851208
CN-1112492-C,20000616,20030625,30009
DE-566539-C,19280927,19321217,40290
DE-845109-C,19500618,19520728,20110
JP-S63125649-A,19870430,0,-19870430
JP-S6423693-U,19870801,0,-19870801
JP-S5243021-U,19750922,0,-19750922
JP-S5566205-U,19781031,0,-19781031
JP-H0825023-B2,19880630,19960313,79683
JP-2003215980-A,20020425,0,-20020425
JP-4255884-B2,20040608,20090415,49807
KR-100295305-B1,19990212,20010712,20500
CN-101547005-A,20080328,0,-20080328
CN-101988676-A,20090806,0,-20090806
CN-203259375-U,20130516,20131030,514
CN-205932945-U,20160822,20170208,9386
DE-202006018912-U1,20061214,20070215,9001
FR-2828332-A1,20000623,0,-20000623
GB-1375879-A,19730427,0,-19730427
JP-S53161674-U,19770523,0,-19770523
US-2053075-A,19351119,19360901,9782
CN-2484753-Y,20010531,20020410,9879
CN-1212523-A,19980910,0,-19980910
FI-20010786-A,20010417,0,-20010417
JP-S6359144-U,19861004,0,-19861004
JP-2799203-B2,19891128,19980917,89789
JP-H08143121-A,19941117,0,-19941117
US-1837725-A,19290917,19311222,20305
US-2304134-A,19410527,19421208,10681
US-1864623-A,19310103,19320628,10525
JP-5991128-B2,20120929,20160914,39985
JP-2016105749-A,20130405,0,-20130405
RU-2191214-C2,20010109,20021020,10911
RU-2008140707-A,20081015,0,-20081015
CN-103265598-B,20130603,20150304,19701
CN-203928708-U,20140627,20141105,478
CN-204557664-U,20150410,20150812,402
CN-206326242-U,20160701,20170714,10013
C

2025-01-19 03:16:44 - root - INFO - itercount: 0
2025-01-19 03:16:44 - root - INFO - Database Name: PATENTS_GOOGLE
Schema Name: PATENTS_GOOGLE
DDL describes table information.
,0
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

,1
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,2
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""description_localized"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""citation"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,3
table_name,ABS_AND_EMB
description,
DDL,"create or replace TABLE ABS_AND_EMB (
	""publication_number"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""title_translated"" BOOLEAN,
	""abstract"" VARCHAR(16777216),
	""abstract_translated"" BOOLEAN,
	""cpc"" VARIANT,
	""cpc_low"" VARIANT,
	""cpc_inventive_low"" VARIANT,
	""top_terms"" VARIANT,
	""similar"" VARIANT,
	""url"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""publication_description"" VARCHAR(16777216),
	""cited_by"" VARIANT,
	""embedding_v1"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS`

   - **"publication_number"**: Used to uniquely identify each patent.
   
   - **"country_code"**: To filter for United States patents (`"country_code" = 'US'`).

   - **"kind_code"**: To filter for B2 classification patents (`"kind_code" = 'B2'`).

   - **"grant_date"**: To select patents granted between 2010 and 2014 (`"grant_date" BETWEEN 20100101 AND 20141231`).

   - **"filing_date"**: Used to calculate the window for citations within a month of filing date.

   - **"citation"**: VARIANT field containing backward citations; used to identify forward citations by examining other patents that cite a given patent.

2. **Table:** `PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB`

   - **"publication_number"**: Used to join with the `PUBLICATIONS` table.

   - **"embedding_v1"**: Contains text embeddings for similarity comparisons.

**Conditions that May Be Used:**

- **United States Patents:** `"country_code" = 'US'`

- **B2 Classification:** `"kind_code" = 'B2'`

- **Grant Date Range:** `"grant_date" BETWEEN 20100101 AND 20141231`

- **Filing Date Within One Month:** Used to calculate forward citations within a month of filing date.

---

**SQL Queries:**

```sql
-- Query 1: Get distinct country codes from the PUBLICATIONS table
SELECT DISTINCT "country_code" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000;

-- Query 2: Get distinct kind codes from the PUBLICATIONS table
SELECT DISTINCT "kind_code" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000;

-- Query 3: Retrieve publication numbers and grant dates for US B2 patents granted between 2010 and 2014
SELECT "publication_number", "grant_date" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "country_code" = 'US' 
  AND "kind_code" = 'B2' 
  AND "grant_date" BETWEEN 20100101 AND 20141231 
LIMIT 1000;

-- Query 4: Retrieve publication numbers and filing dates where filing date is available
SELECT "publication_number", "filing_date" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "filing_date" IS NOT NULL 
LIMIT 1000;

-- Query 5: Retrieve publication numbers and number of backward citations
SELECT "publication_number", ARRAY_SIZE("citation") AS "num_backward_citations" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000;

-- Query 6: Explore the structure of the "citation" field for one patent
SELECT "publication_number", "citation" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "citation" IS NOT NULL 
LIMIT 1;

-- Query 7: List all cited publication numbers by flattening the "citation" field
SELECT "publication_number", f.value::VARIANT:"publication_number"::STRING AS "cited_publication_number" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS, 
     LATERAL FLATTEN(input => "citation") f 
LIMIT 1000;

-- Query 8: Retrieve publication numbers and embeddings from the ABS_AND_EMB table
SELECT "publication_number", "embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
LIMIT 1000;

-- Query 9: Get the size of the embeddings vector in the ABS_AND_EMB table
SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_size" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
LIMIT 1000;

-- Query 10: Get filing dates and grant dates to calculate the time between filing and grant
SELECT "publication_number", "filing_date", "grant_date", ("grant_date" - "filing_date") AS "processing_time" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "filing_date" IS NOT NULL AND "grant_date" IS NOT NULL 
LIMIT 1000;
```

---

These queries help explore the data needed for the task:

- **Queries 1 & 2**: Identify the values present in the `"country_code"` and `"kind_code"` columns to understand how to filter for US B2 patents.

- **Query 3**: Retrieve US B2 patents granted between 2010 and 2014.

- **Query 4**: Check the availability of filing dates.

- **Query 5**: Examine the number of backward citations per patent.

- **Query 6**: Explore the structure of the `"citation"` field to understand how to extract cited publication numbers.

- **Query 7**: Flatten the `"citation"` field to list all cited publication numbers.

- **Queries 8 & 9**: Access and understand the embeddings for patents, which are necessary for calculating similarity.

- **Query 10**: Calculate the time between filing and grant dates, which might be useful for additional analysis.

These queries provide insights into the data structure and content, enabling a better understanding of how to approach the original task.Query:
-- Query 1: Get distinct country codes from the PUBLICATIONS table
SELECT DISTINCT "country_code" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000
Answer:
country_code
JP
GB
BE
FI
DK
WO
EP
LU
CA
NL
RU
KR
US
DE
ES
CN
FR
Query:
-- Query 2: Get distinct kind codes from the PUBLICATIONS table
SELECT DISTINCT "kind_code" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000
Answer:
kind_code
B1
S
D2
U8
H
C1
T0
A5
Y2
T2
C9
U4
P1
R2
V0
B8
F
R1
L
A0
B9
E1
C3
A7
K4
Z1
A1
T3
H1
T7
A4
T5
A8
I5
I2
B
Y1
K1
R
A
B3
T4
P
T8
U0
T1
Y4
A2
I4
Y
T9
I1
U9
P2
P3
D1
C2
B4
C5
H3
A3
K5
U1
A6
C
U
S1
U3
M
T
B2
A9
D0
E
Query:
-- Query 3: Retrieve publication numbers and grant dates for US B2 patents granted between 2010 and 2014
SELECT "publication_number", "grant_date" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "country_code" = 'US' 
  AND "kind_code" = 'B2' 
  AND "grant_date" BETWEEN 20100101 AND 20141231 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,grant_date
US-8908679-B2,20141209
US-7960413-B2,20110614
US-7704877-B2,20100427
US-7727473-B2,20100601
US-8425821-B2,20130423
US-8899209-B2,20141202
US-8499502-B2,20130806
US-8207994-B2,20120626
US-7932928-B2,20110426
US-8858390-B2,20141014
US-8902701-B2,20141202
US-8836621-B2,20140916
US-8130625-B2,20120306
US-8846234-B2,20140930
US-7846394-B2,20101207
US-8087045-B2,20111227
US-8684320-B2,20140401
US-8639874-B2,20140128
US-8527303-B2,20130903
US-8697506-B2,20140415
US-8779491-B2,20140715
US-8622869-B2,20140107
US-8194070-B2,20120605
US-8618832-B2,20131231
US-8303190-B2,20121106
US-7869016-B2,20110111
US-8609823-B2,20131217
US-8717022-B2,20140506
US-8843939-B2,20140923
US-8144627-B2,20120327
US-8631198-B2,20140114
US-8764962-B2,20140701
US-8563362-B2,20131022
US-7836829-B2,20101123
US-8503430-B2,20130806
US-7813884-B2,20101012
US-8539588-B2,20130917
US-8898576-B2,20141125
US-8694495-B2,20140408
US-8479056-B2,20130702
US-8450859-B2,20130528
US-8021293-B2,20110920
US-8436539-B2,20130507
US-8759357-B2,20140624
US-8353788-B2,20130115
US-8278976-B2,20121002
US-8434758-B2,20130507
US-8444050-B2,20130521
US-8069254-B2,20111129
US-8689073-B2,20140401
US-8786203-B2,20140722
US-7882056-B2,20110201
US-8076449-B2,20111213
US-8257725-B2,20120904
US-8613270-B2,20131224
US-7935790-B2,20110503
US-8356512-B2,20130122
US-7711138-B2,20100504
US-8824537-B2,20140902
US-8823688-B2,20140902
US-8583474-B2,20131112
US-7658251-B2,20100209
US-8919085-B2,20141230
US-8190360-B2,20120529
US-7678644-B2,20100316
US-8733316-B2,20140527
US-7896350-B2,20110301
US-8020161-B2,20110913
US-7987607-B2,20110802
US-7648844-B2,20100119
US-7919545-B2,20110405
US-8546892-B2,20131001
US-8267738-B2,20120918
US-8570935-B2,20131029
US-7944114-B2,20110517
US-7662837-B2,20100216
US-8831557-B2,20140909
US-8509035-B2,20130813
US-8240654-B2,20120814
US-8039409-B2,20111018
US-8399879-B2,20130319
US-8558957-B2,20131015
US-8119772-B2,20120221
US-8389713-B2,20130305
US-8629558-B2,20140114
US-8513702-B2,20130820
US-8515341-B2,20130820
US-8027159-B2,20110927
US-8253921-B2,20120828
US-8391624-B2,20130305
US-7678577-B2,20100316
US-8883278-B2,20141111
US-8768937-B2,20140701
US-8527172-B2,20130903
US-7916232-B2,20110329
US-8179406-B2,20120515
US-8512590-B2,20130820
US-8597297-B2,20131203
US-8195593-B2,20120605
US-8043863-B2,20111025
US-8298048-B2,20121030
US-8468999-B2,20130625
US-8563604-B2,20131022
US-8388547-B2,20130305
US-7919127-B2,20110405
US-7960124-B2,20110614
US-8360677-B2,20130129
US-8120188-B2,20120221
US-8510585-B2,20130813
US-7972997-B2,20110705
US-8345648-B2,20130101
US-8907742-B2,20141209
US-8358913-B2,20130122
US-8715559-B2,20140506
US-8255820-B2,20120828
US-8921814-B2,20141230
US-8734946-B2,20140527
US-8817655-B2,20140826
US-8246978-B2,20120821
US-8616292-B2,20131231
US-8815476-B2,20140826
US-8726198-B2,20140513
US-8277534-B2,20121002
US-8862262-B2,20141014
US-7756270-B2,20100713
US-8313878-B2,20121120
US-7824486-B2,20101102
US-8687170-B2,20140401
US-8563509-B2,20131022
US-7989172-B2,20110802
US-8136703-B2,20120320
US-7852716-B2,20101214
US-7818987-B2,20101026
US-7885873-B2,20110208
US-8043372-B2,20111025
US-8146530-B2,20120403
US-7755655-B2,20100713
US-8518710-B2,20130827
US-7871625-B2,20110118
US-7701466-B2,20100420
US-7854621-B2,20101221
US-8246536-B2,20120821
US-7746216-B2,20100629
US-8907126-B2,20141209
US-7831285-B2,20101109
US-8912169-B2,20141216
US-7753494-B2,20100713
US-8632084-B2,20140121
US-7923105-B2,20110412
US-8335430-B2,20121218
US-8495918-B2,20130730
US-8770810-B2,20140708
US-8432488-B2,20130430
US-7728626-B2,20100601
US-8445009-B2,20130521
US-8509891-B2,20130813
US-8834270-B2,20140916
US-8109540-B2,20120207
US-7911653-B2,20110322
US-8729226-B2,20140520
US-8842218-B2,20140923
US-8287432-B2,20121016
US-8810656-B2,20140819
US-7926244-B2,20110419
US-7952029-B2,20110531
US-8470434-B2,20130625
US-7946504-B2,20110524
US-8779972-B2,20140715
US-8685118-B2,20140401
US-8553716-B2,20131008
US-8549245-B2,20131001
US-8491897-B2,20130723
US-8874103-B2,20141028
US-7707114-B2,20100427
US-8130173-B2,20120306
US-7978780-B2,20110712
US-7800606-B2,20100921
US-8497546-B2,20130730
US-8797438-B2,20140805
US-8304245-B2,20121106
US-8897526-B2,20141125
US-7804071-B2,20100928
US-8124536-B2,20120228
US-8804737-B2,20140812
US-7830628-B2,20101109
US-8527566-B2,20130903
US-8502997-B2,20130806
US-8020794-B2,20110920
US-8329868-B2,20121211
US-7756645-B2,20100713
US-8649809-B2,20140211
US-8021985-B2,20110920
US-8264652-B2,20120911
US-8301234-B2,20121030
US-8216606-B2,20120710
US-8061906-B2,20111122
US-7820716-B2,20101026
US-8314237-B2,20121120
US-8267034-B2,20120918
US-8173292-B2,20120508
US-7796644-B2,20100914
US-8906215-B2,20141209
US-7996845-B2,20110809
US-8454000-B2,20130604
US-8811454-B2,20140819
US-7830641-B2,20101109
US-8527950-B2,20130903
US-8071712-B2,20111206
US-8852491-B2,20141007
US-8592044-B2,20131126
US-8583693-B2,20131112
US-8109010-B2,20120207
US-7829013-B2,20101109
US-8855718-B2,20141007
US-8011363-B2,20110906
US-7725227-B2,20100525
US
Query:
-- Query 4: Retrieve publication numbers and filing dates where filing date is available
SELECT "publication_number", "filing_date" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "filing_date" IS NOT NULL 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-
Query:
-- Query 5: Retrieve publication numbers and number of backward citations
SELECT "publication_number", ARRAY_SIZE("citation") AS "num_backward_citations" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,num_backward_citations
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,0
ES-8501233-A1,0
CA-2165155-A1,0
FR-2409943-B1,0
GB-1086860-A,0
JP-S54117658-A,0
JP-H0710178-Y2,0
JP-3172057-B2,0
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,0
DE-1479218-U,0
EP-2512367-B1,0
ES-2312527-T3,0
FR-1000748-A,0
FR-1573809-A,0
JP-S5066757-U,0
JP-S5845249-Y2,0
US-2103405-A,0
GB-201114438-D0,0
JP-5707248-B2,0
JP-2016211567-A,0
KR-20040075216-A,0
CN-1954806-A,0
CN-201399214-Y,0
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,0
DE-2707796-A1,0
DE-2962208-D1,0
FR-2233137-A1,0
GB-2224027-B,0
JP-S5911756-Y2,0
JP-2000218515-A,0
JP-S56169301-A,0
US-2002102047-A1,0
CN-1467804-A,0
EP-0988417-B1,0
JP-H04334685-A,0
JP-S6359143-U,0
JP-H0685910-B2,0
JP-H0350567-B2,0
JP-5108773-B2,0
CN-2768052-Y,0
CN-1940157-B,0
CN-202318915-U,0
CN-203200362-U,0
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,0
CA-118661-S,0
FI-882364-A0,0
CA-810158-A,0
DE-2335240-A1,0
DE-7610943-U1,0
JP-H0673947-U,0
JP-S54153049-A,0
JP-S5716116-U,0
US-548167-A,0
CN-1055840-A,0
JP-S6020713-A,0
JP-S6234024-A,0
JP-H0995081-A,0
JP-H1088758-A,0
GB-189709494-A,0
JP-2001195445-A,0
JP-2010101160-A,0
CN-101746294-A,0
CN-104170353-A,0
CN-206056613-U,0
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,0
CA-564325-A,0
GB-0802422-D0,0
JP-S53139175-U,0
JP-H01150349-U,0
JP-2600796-Y2,0
JP-S591896-U,0
JP-S4922438-B1,0
US-419959-A,0
DE-69331528-D1,0
DE-69430885-T2,0
EP-1474362-B1,0
JP-2000346423-A,0
JP-2765752-B2,0
KR-900003183-Y1,0
JP-2003229053-A,0
JP-2007241524-A,0
JP-5129599-B2,0
KR-100547071-B1,0
KR-20070020426-A,0
KR-20130050682-A,0
CN-204556165-U,0
ES-66185-Y,0
CA-1331409-C,0
FI-891492-A0,0
GB-1348507-A,0
JP-S60179587-U,0
US-332138-A,0
CN-1112492-C,0
DE-566539-C,0
DE-845109-C,0
JP-S63125649-A,0
JP-S6423693-U,0
JP-S5243021-U,0
JP-S5566205-U,0
JP-H0825023-B2,0
JP-2003215980-A,0
JP-4255884-B2,0
KR-100295305-B1,0
CN-101547005-A,0
CN-101988676-A,0
CN-203259375-U,0
CN-205932945-U,0
DE-202006018912-U1,0
FR-2828332-A1,0
GB-1375879-A,0
JP-S53161674-U,0
US-2053075-A,0
CN-2484753-Y,0
CN-1212523-A,0
FI-20010786-A,0
JP-S6359144-U,0
JP-2799203-B2,0
JP-H08143121-A,0
US-1837725-A,0
US-2304134-A,0
US-1864623-A,0
JP-5991128-B2,0
JP-2016105749-A,0
RU-2191214-C2,0
RU-2008140707-A,0
CN-103265598-B,0
CN-203928708-U,0
CN-204557664-U,0
CN-206326242-U,0
CN-104559893-B,0
CN-106856628-A,0
US-6778773-B2,21
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,0
FR-877274-A,0
JP-S60218905-A,0
JP-H04326774-A,0
JP-S5125160-A,0
FR-1012104-A,0
JP-S5944363-A,0
JP-H081564-A,0
US-1233474-A,0
US-2002011230-A1,0
JP-2003169856-A,0
US-811638-A,0
KR-200338652-Y1,0
KR-20070041890-A,0
CN-1816294-A,0
CN-2858160-Y,0
CN-201276086-Y,0
CN-201816145-U,0
CN-102907994-A,0
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,0
ES-146285-Y,0
GB-478690-A,0
DE-2649618-B2,0
DE-3766112-D1,0
DE-8007402-U1,0
FR-390089-A,0
FR-638126-A,0
FR-2638622-B1,0
JP-H0584037-U,0
JP-S4739450-Y1,0
JP-H0642846-U,0
NL-296405-A,0
NL-7211943-A,0
EP-2781788-B1,0
JP-S5072414-U,0
JP-S5846920-U,0
JP-S5874811-U,0
JP-S5687776-U,0
US-D279853-S,0
KR-920008597-Y1,0
JP-2004313014-A,0
JP-6137070-B2,0
RU-2008132286-A,0
US-754320-A,0
CN-105823611-A,0
CN-106739164-A,0
CN-205558012-U,0
BE-512467-A,0
CA-2244766-A1,0
DE-1803332-A1,0
DE-2149141-A1,0
GB-2089320-A,0
JP-S62164685-U,0
JP-H066780-Y2,0
DE-69322442-T2,0
EP-1933436-B1,0
EP-0782478-B1,0
EP-0993180-B1,0
JP-S5128923-U,0
JP-S5153284-U,0
JP-S5376919-A,0
JP-3340813-B2,0
JP-2000192758-A,0
JP-H11193667-A,0
RU-17326-U1,0
KR-20110049427-A,0
CN-101531763-A,0
CN-201900010-U,0
CN-202142477-U,0
CN-202417422-U,0
CN-202807027-U,0
CA-27189-A,0
JP-S4874140-A,0
JP-2887866-B2,0
FR-2239893-A5,0
JP-H09201246-A,0
JP-S6125607-Y2,0
JP-H069665-Y2,0
JP-H02145867-U,0
DE-1899993-U,0
DK-1279779-T3,0
EP-1395943-B1,0
JP-S61104472-A,0
US-3605178-A,0
ES-2301340-B1,0
KR-890006762-Y1,0
KR-910005717-Y1,0
JP-WO2006134667-A1,0
JP-WO2011121828-A1,0
JP-6013229-B2,0
KR-200371816-Y1,0
KR-20040093694-A,0
CN-104911016-A,0
JP-1721970-C,0
JP-H00979262-A,0
JP-2045702-C,0
CA-607467-A,0
CA-870537-A,0
DE-2913333-C2,0
GB-2156898-B,0
GB-9701425-D0,0
DE-69108459-T2,0
DE-69402587-D1,0
DE-690465-C,0
JP-S5354430-A,0
JP-S5788835-A,0
JP-H0510017-A,0
JP-H08159838-A,0
US-1863894-A,0
JP-4882580-B2,0
JP-5210626-B2,0
RU-2345965-C2,0
RU-2355420-C2,0
KR-100352139-B1,0
KR-100387884-B1,0
KR-20120048256-A,0
CN-201742521-U,0
CN-202693633-U,0
CN-202679530-U,0
CN-106625363-A,0
CN-205519698-U,0
JP-1260064-C,0
DE-54582-C,0
ES-128308-A1,0
DE-2516533-A1,0
GB-0905075-D0,0
GB-192211-A,0
JP-2605593-Y2,0
JP-S5020200-Y2,0
JP-S524076-A,0
DE-19811661-A1,0
DE-29605835-U1,0
DE-69131766-T2,0
EP-2982223-A2,0
EP-0172283-B1,0
JP-S5743740-U,0
JP-H04296316-A,0
US-D487006-S,0
US-3538803-A,0
US-2002044447-A1,0
JP-2003225526-A,0
JP-2005299236-A,0
JP-2010128199-A,0
KR-101187803-B1,0
CN-201628697-U,0
CA-1192088-A1,0
JP-1028326-C,0
BE-782111-A1,0
CA-1190527-A,0
CA-2093193-C,0
DE-130839-C,0
ES-2051228-B1,0
FR-554877-A,0
FR-2636364-B1,0
JP-S57153931-A,0
JP-S5224357-Y2,0
JP-H04314168-A,0
DE-19851242-
Query:
-- Query 6: Explore the structure of the "citation" field for one patent
SELECT "publication_number", "citation" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "citation" IS NOT NULL 
LIMIT 1
Answer:
publication_number,citation
JP-1810118-C,[]
Query:
-- Query 7: List all cited publication numbers by flattening the "citation" field
SELECT "publication_number", f.value::VARIANT:"publication_number"::STRING AS "cited_publication_number" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS, 
     LATERAL FLATTEN(input => "citation") f 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,cited_publication_number
US-6778773-B2,US-4067027-A
US-6778773-B2,US-4262988-A
US-6778773-B2,JP-S5779909-A
US-6778773-B2,US-4400065-A
US-6778773-B2,JP-S6296919-A
US-6778773-B2,JP-H052132-A
US-6778773-B2,JP-H062330-A
US-6778773-B2,JP-H078848-A
US-6778773-B2,JP-H07283978-A
US-6778773-B2,US-5583692-A
US-6778773-B2,US-5729390-A
US-6778773-B2,US-5926657-A
US-6778773-B2,JP-H11248996-A
US-6778773-B2,US-6088053-A
US-6778773-B2,WO-0152531-A1
US-6778773-B2,JP-2001281555-A
US-6778773-B2,US-2001028498-A1
US-6778773-B2,JP-2001311868-A
US-6778773-B2,US-6476963-B1
US-6778773-B2,
US-6778773-B2,
EP-2042690-A2,JP-H05141259-A
EP-2042690-A2,JP-H1019045-A
EP-2295559-A1,GB-1358599-A
EP-2295559-A1,GB-2094826-A
EP-2295559-A1,GB-2095275-A
EP-2295559-A1,US-4435307-A
EP-2295559-A1,US-4816567-A
EP-2295559-A1,US-4822516-A
EP-2295559-A1,WO-9104673-A1
EP-2295559-A1,WO-9206209-A1
EP-2295559-A1,US-5246853-A
EP-2295559-A1,WO-9428117-A1
EP-2295559-A1,US-5475101-A
EP-2295559-A1,US-5648263-A
EP-2295559-A1,US-5650322-A
EP-2295559-A1,US-5691178-A
EP-2295559-A1,WO-9821339-A1
EP-2295559-A1,US-5776757-A
EP-2295559-A1,WO-9831821-A2
EP-2295559-A1,US-5861271-A
EP-2295559-A1,US-6162782-A
EP-2295559-A1,WO-0104284-A1
EP-2295559-A1,US-6255115-B1
EP-2295559-A1,US-6599722-B2
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
EP-2295559-A1,
JP-2013069423-A,JP-2006066328-A
JP-2013069423-A,JP-2006120691-A
JP-2013069423-A,WO-2011089805-A1
JP-2013069423-A,JP-2011150264-A
WO-9837591-A1,US-4209789-A
EP-2372484-A2,
US-6979660-B2,US-4403012-A
US-6979660-B2,US-4411854-A
US-6979660-B2,US-4413110-A
US-6979660-B2,US-4422993-A
US-6979660-B2,US-4430383-A
US-6979660-B2,US-4436689-A
US-6979660-B2,US-4455273-A
US-6979660-B2,US-4457985-A
US-6979660-B2,US-4501856-A
US-6979660-B2,US-4536536-A
US-6979660-B2,US-4543286-A
US-6979660-B2,US-4545950-A
US-6979660-B2,US-4551296-A
US-6979660-B2,US-4563392-A
US-6979660-B2,US-4584347-A
US-6979660-B2,US-4613535-A
US-6979660-B2,US-4623574-A
US-6979660-B2,US-4650710-A
US-6979660-B2,US-4663101-A
US-6979660-B2,US-4681792-A
US-6979660-B2,US-4737401-A
US-6979660-B2,US-4737402-A
US-6979660-B2,US-4748064-A
US-6979660-B2,US-4820568-A
US-6979660-B2,US-4858287-A
US-6979660-B2,US-4883700-A
US-6979660-B2,US-4916000-A
US-6979660-B2,US-4953234-A
US-6979660-B2,US-5006390-A
US-6979660-B2,US-5061545-A
US-6979660-B2,US-5112667-A
US-6979660-B2,US-5124195-A
US-6979660-B2,US-5160776-A
US-6979660-B2,US-5165989-A
US-6979660-B2,US-5167876-A
US-6979660-B2,US-5175040-A
US-6979660-B2,US-5185195-A
US-6979660-B2,US-5187023-A
US-6979660-B2,US-5190802-A
US-6979660-B2,US-5196252-A
US-6979660-B2,US-5248471-A
US-6979660-B2,US-5330820-A
US-6979660-B2,US-5343796-A
US-6979660-B2,US-5376426-A
US-6979660-B2,US-5440965-A
US-6979660-B2,US-5471906-A
US-6979660-B2,US-5480706-A
US-6979660-B2,US-5525414-A
US-6979660-B2,US-5552208-A
US-6979660-B2,US-5578374-A
US-6979660-B2,US-5587230-A
US-6979660-B2,US-5677029-A
US-6979660-B2,US-5736244-A
US-6979660-B2,US-5741451-A
US-6979660-B2,US-5788907-A
US-6979660-B2,US-5804015-A
US-6979660-B2,US-5958804-A
US-6979660-B2,US-5972498-A
US-6979660-B2,US-6003424-A
US-6979660-B2,US-6219842-B1
US-697966
Query:
-- Query 8: Retrieve publication numbers and embeddings from the ABS_AND_EMB table
SELECT "publication_number", "embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 
Query:
-- Query 9: Get the size of the embeddings vector in the ABS_AND_EMB table
SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_size" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_size
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,64
DK-45
Query:
-- Query 10: Get filing dates and grant dates to calculate the time between filing and grant
SELECT "publication_number", "filing_date", "grant_date", ("grant_date" - "filing_date") AS "processing_time" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
WHERE "filing_date" IS NOT NULL AND "grant_date" IS NOT NULL 
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date,grant_date,processing_time
JP-1810118-C,0,0,0
JP-1203714-C,0,0,0
FR-1500580-A,19661104,19671103,9999
ES-8501233-A1,19831124,0,-19831124
CA-2165155-A1,19940603,0,-19940603
FR-2409943-B1,19771125,19800822,29697
GB-1086860-A,19660422,0,-19660422
JP-S54117658-A,19780306,0,-19780306
JP-H0710178-Y2,19880302,19950308,70006
JP-3172057-B2,19950405,20010604,60199
US-136580-A,0,18730311,18730311
US-272220-A,0,18830213,18830213
US-599187-A,0,18980215,18980215
CN-1062411-C,19940709,20010228,69519
DE-1479218-U,0,0,0
EP-2512367-B1,20101209,20131113,29904
ES-2312527-T3,20021205,20090301,69096
FR-1000748-A,19491117,19520215,29098
FR-1573809-A,19640424,19690711,50287
JP-S5066757-U,19731018,0,-19731018
JP-S5845249-Y2,19751212,19831014,79802
US-2103405-A,19310429,19371228,60799
GB-201114438-D0,20110822,20111005,183
JP-5707248-B2,20110622,20150422,39800
JP-2016211567-A,20160502,0,-20160502
KR-20040075216-A,20030220,0,-20030220
CN-1954806-A,20051027,0,-20051027
CN-201399214-Y,20090409,20100210,9801
JP-1368881-C,0,0,0
JP-1444589-C,0,0,0
FR-1497898-A,19661027,19671013,9986
DE-2707796-A1,19770223,0,-19770223
DE-2962208-D1,19790928,19820325,29397
FR-2233137-A1,19740617,0,-19740617
GB-2224027-B,19891011,19920115,29104
JP-S5911756-Y2,19790131,19840410,50279
JP-2000218515-A,19990204,0,-19990204
JP-S56169301-A,19800602,0,-19800602
US-2002102047-A1,20020226,0,-20020226
CN-1467804-A,20020712,0,-20020712
EP-0988417-B1,19980603,20060823,80220
JP-H04334685-A,19910509,0,-19910509
JP-S6359143-U,19861007,0,-19861007
JP-H0685910-B2,19851219,19941102,89883
JP-H0350567-B2,19840507,19910802,70295
JP-5108773-B2,20060829,20121226,60397
CN-2768052-Y,20041102,20060329,19227
CN-1940157-B,20060925,20110413,49488
CN-202318915-U,20111123,20120711,9588
CN-203200362-U,20130419,20130918,499
JP-897785-C,0,0,0
JP-1789132-C,0,0,0
JP-S62113530-U,19860109,0,-19860109
CA-118661-S,20061213,20080124,18911
FI-882364-A0,19880519,0,-19880519
CA-810158-A,0,19690408,19690408
DE-2335240-A1,19730711,0,-19730711
DE-7610943-U1,19760408,19760729,321
JP-H0673947-U,19930324,0,-19930324
JP-S54153049-A,19780523,0,-19780523
JP-S5716116-U,19800624,0,-19800624
US-548167-A,0,18951015,18951015
CN-1055840-A,19910408,0,-19910408
JP-S6020713-A,19830713,0,-19830713
JP-S6234024-A,19850806,0,-19850806
JP-H0995081-A,19951002,0,-19951002
JP-H1088758-A,19960917,0,-19960917
GB-189709494-A,18970414,0,-18970414
JP-2001195445-A,20001128,0,-20001128
JP-2010101160-A,20091021,0,-20091021
CN-101746294-A,20090903,0,-20090903
CN-104170353-A,20131227,0,-20131227
CN-206056613-U,20160726,20170329,9603
JP-1032657-C,0,0,0
JP-1654837-C,0,0,0
DK-146223-C,19720608,19840109,119501
CA-564325-A,0,19581007,19581007
GB-0802422-D0,20080208,20080319,111
JP-S53139175-U,19770408,0,-19770408
JP-H01150349-U,19880407,0,-19880407
JP-2600796-Y2,19921015,19991025,70010
JP-S591896-U,19820628,0,-19820628
JP-S4922438-B1,19691202,19740608,49406
US-419959-A,0,18900121,18900121
DE-69331528-D1,19931110,20020314,89204
DE-69430885-T2,19940405,20030130,89725
EP-1474362-B1,20030211,20061122,30911
JP-2000346423-A,19990531,0,-19990531
JP-2765752-B2,19900926,19980618,79692
KR-900003183-Y1,19870430,19900414,29984
JP-2003229053-A,20020131,0,-20020131
JP-2007241524-A,20060307,0,-20060307
JP-5129599-B2,20080208,20130130,49922
KR-100547071-B1,20030228,20060131,29903
KR-20070020426-A,20050210,0,-20050210
KR-20130050682-A,20111108,0,-20111108
CN-204556165-U,20150506,20150812,306
ES-66185-Y,19580519,19581201,682
CA-1331409-C,19891023,19940809,49786
FI-891492-A0,19890329,0,-19890329
GB-1348507-A,19710419,0,-19710419
JP-S60179587-U,19840510,0,-19840510
US-332138-A,0,18851208,18851208
CN-1112492-C,20000616,20030625,30009
DE-566539-C,19280927,19321217,40290
DE-845109-C,19500618,19520728,20110
JP-S63125649-A,19870430,0,-19870430
JP-S6423693-U,19870801,0,-19870801
JP-S5243021-U,19750922,0,-19750922
JP-S5566205-U,19781031,0,-19781031
JP-H0825023-B2,19880630,19960313,79683
JP-2003215980-A,20020425,0,-20020425
JP-4255884-B2,20040608,20090415,49807
KR-100295305-B1,19990212,20010712,20500
CN-101547005-A,20080328,0,-20080328
CN-101988676-A,20090806,0,-20090806
CN-203259375-U,20130516,20131030,514
CN-205932945-U,20160822,20170208,9386
DE-202006018912-U1,20061214,20070215,9001
FR-2828332-A1,20000623,0,-20000623
GB-1375879-A,19730427,0,-19730427
JP-S53161674-U,19770523,0,-19770523
US-2053075-A,19351119,19360901,9782
CN-2484753-Y,20010531,20020410,9879
CN-1212523-A,19980910,0,-19980910
FI-20010786-A,20010417,0,-20010417
JP-S6359144-U,19861004,0,-19861004
JP-2799203-B2,19891128,19980917,89789
JP-H08143121-A,19941117,0,-19941117
US-1837725-A,19290917,19311222,20305
US-2304134-A,19410527,19421208,10681
US-1864623-A,19310103,19320628,10525
JP-5991128-B2,20120929,20160914,39985
JP-2016105749-A,20130405,0,-20130405
RU-2191214-C2,20010109,20021020,10911
RU-2008140707-A,20081015,0,-20081015
CN-103265598-B,20130603,20150304,19701
CN-203928708-U,20140627,20141105,478
CN-204557664-U,20150410,20150812,402
CN-206326242-U,20160701,20170714,10013
C
End Exploring Related Columns
Task: For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Focal_patent_number,Most_similar_patent_number
patent_number:str,similar_patent_number:str (Attention: answer in one row)
```

**Explanation:**

We identified the United States utility patent under the B2 classification granted between 2010 and 2014 with the most forward citations within a month of its filing date. Using text embeddings to calculate similarity, we then determined the most similar patent from the same filing year, regardless of its type..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 03:18:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:18:00 - root - INFO - ```sql
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        f.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") f
    WHERE 
        cp."filing_date" IS NOT NULL
),
citations_within_one_month AS (
    SELECT 
        f."focal_pub_num",
        COUNT(*) as citation_count,
        f."focal_filing_date"
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c."cited_pub_num" = f."focal_pub_num"
            AND c."citing_filing_date" BETWEEN f."focal_filing_date" AND f."focal_filing_date" + 30
    GROUP BY 
        f."focal_pub_num",
        f."focal_filing_date"
),
best_patent AS (
    SELECT
        f."focal_pub_num",
        f."focal_filing_date"
    FROM
        citations_within_one_month f
    ORDER BY
        f."citation_count" DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp."focal_pub_num"
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND SUBSTR(p."filing_date"::STRING, 1, 4) = SUBSTR((SELECT f."focal_filing_date"::STRING FROM best_patent f), 1, 4)
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.value::FLOAT * c_e.value::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f
        LATERAL FLATTEN(input => c."embedding_v1") c_e
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
```
2025-01-19 03:18:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:18:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:18:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:18:01 - snowflake.connector.connection - INFO - closed
2025-01-19 03:18:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:18:01 - root - INFO - itercount: 1
2025-01-19 03:18:01 - root - INFO - 001003 (42000): 01b9cea6-0004-7b17-0001-11c300eec182: SQL compilation error:
syntax error line 77 at position 8 unexpected 'LATERAL'.
syntax error line 77 at position 24 unexpected 'input'.
syntax error line 77 at position 51 unexpected 'c_e'.
2025-01-19 03:18:01 - root - INFO - Input sql:
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        f.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") f
    WHERE 
        cp."filing_date" IS NOT NULL
),
citations_within_one_month AS (
    SELECT 
        f."focal_pub_num",
        COUNT(*) as citation_count,
        f."focal_filing_date"
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c."cited_pub_num" = f."focal_pub_num"
            AND c."citing_filing_date" BETWEEN f."focal_filing_date" AND f."focal_filing_date" + 30
    GROUP BY 
        f."focal_pub_num",
        f."focal_filing_date"
),
best_patent AS (
    SELECT
        f."focal_pub_num",
        f."focal_filing_date"
    FROM
        citations_within_one_month f
    ORDER BY
        f."citation_count" DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp."focal_pub_num"
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND SUBSTR(p."filing_date"::STRING, 1, 4) = SUBSTR((SELECT f."focal_filing_date"::STRING FROM best_patent f), 1, 4)
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.value::FLOAT * c_e.value::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f
        LATERAL FLATTEN(input => c."embedding_v1") c_e
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
The error information is:
001003 (42000): 01b9cea6-0004-7b17-0001-11c300eec182: SQL compilation error:
syntax error line 77 at position 8 unexpected 'LATERAL'.
syntax error line 77 at position 24 unexpected 'input'.
syntax error line 77 at position 51 unexpected 'c_e'.
Please correct it and output only 1 complete SQL query.
2025-01-19 03:19:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:19:00 - root - INFO - ```sql
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') as focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') as citing_filing_date_dt,
        f.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") f
    WHERE 
        cp."filing_date" IS NOT NULL
),
citations_within_one_month AS (
    SELECT 
        f."focal_pub_num",
        COUNT(*) as citation_count,
        f."focal_filing_date_dt"
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c."cited_pub_num" = f."focal_pub_num"
            AND c."citing_filing_date_dt" BETWEEN f."focal_filing_date_dt" AND DATEADD(day, 30, f."focal_filing_date_dt")
    GROUP BY 
        f."focal_pub_num",
        f."focal_filing_date_dt"
),
best_patent AS (
    SELECT
        f."focal_pub_num",
        f."focal_filing_date_dt"
    FROM
        citations_within_one_month f
    ORDER BY
        f."citation_count" DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp."focal_pub_num"
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT f."focal_filing_date_dt" FROM best_patent f))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f
        , LATERAL FLATTEN(input => c."embedding_v1") c_e
        , LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
```
2025-01-19 03:19:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:19:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:19:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:19:01 - snowflake.connector.connection - INFO - closed
2025-01-19 03:19:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:19:02 - root - INFO - itercount: 2
2025-01-19 03:19:02 - root - INFO - 000904 (42000): 01b9cea7-0004-7b17-0001-11c300eec35e: SQL compilation error: error line 28 at position 8
invalid identifier 'F."focal_pub_num"'
2025-01-19 03:19:02 - root - INFO - Input sql:
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') as focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') as citing_filing_date_dt,
        f.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") f
    WHERE 
        cp."filing_date" IS NOT NULL
),
citations_within_one_month AS (
    SELECT 
        f."focal_pub_num",
        COUNT(*) as citation_count,
        f."focal_filing_date_dt"
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c."cited_pub_num" = f."focal_pub_num"
            AND c."citing_filing_date_dt" BETWEEN f."focal_filing_date_dt" AND DATEADD(day, 30, f."focal_filing_date_dt")
    GROUP BY 
        f."focal_pub_num",
        f."focal_filing_date_dt"
),
best_patent AS (
    SELECT
        f."focal_pub_num",
        f."focal_filing_date_dt"
    FROM
        citations_within_one_month f
    ORDER BY
        f."citation_count" DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp."focal_pub_num"
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT f."focal_filing_date_dt" FROM best_patent f))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f
        , LATERAL FLATTEN(input => c."embedding_v1") c_e
        , LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
The error information is:
000904 (42000): 01b9cea7-0004-7b17-0001-11c300eec35e: SQL compilation error: error line 28 at position 8
invalid identifier 'F."focal_pub_num"'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:20:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:20:01 - root - INFO - ```sql
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') as focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') as citing_filing_date_dt,
        cf.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") cf
    WHERE 
        cp."filing_date" IS NOT NULL
),
citations_within_one_month AS (
    SELECT 
        f.focal_pub_num,
        COUNT(*) as citation_count,
        f.focal_filing_date_dt
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c.cited_pub_num = f.focal_pub_num
            AND c.citing_filing_date_dt BETWEEN f.focal_filing_date_dt AND DATEADD(day, 30, f.focal_filing_date_dt)
    GROUP BY 
        f.focal_pub_num,
        f.focal_filing_date_dt
),
best_patent AS (
    SELECT
        f.focal_pub_num,
        f.focal_filing_date_dt
    FROM
        citations_within_one_month f
    ORDER BY
        citation_count DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp.focal_pub_num
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT focal_filing_date_dt FROM best_patent))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f,
        LATERAL FLATTEN(input => c."embedding_v1") c_e,
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
```
2025-01-19 03:20:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:20:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:20:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:20:03 - snowflake.connector.connection - INFO - closed
2025-01-19 03:20:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:20:03 - root - INFO - itercount: 3
2025-01-19 03:20:03 - root - INFO - 100097 (22007): 01b9cea8-0004-7b17-0001-11c300eec52e: Can't parse '0' as date with format 'YYYYMMDD'
2025-01-19 03:20:03 - root - INFO - Input sql:
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') as focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') as citing_filing_date_dt,
        cf.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") cf
    WHERE 
        cp."filing_date" IS NOT NULL
),
citations_within_one_month AS (
    SELECT 
        f.focal_pub_num,
        COUNT(*) as citation_count,
        f.focal_filing_date_dt
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c.cited_pub_num = f.focal_pub_num
            AND c.citing_filing_date_dt BETWEEN f.focal_filing_date_dt AND DATEADD(day, 30, f.focal_filing_date_dt)
    GROUP BY 
        f.focal_pub_num,
        f.focal_filing_date_dt
),
best_patent AS (
    SELECT
        f.focal_pub_num,
        f.focal_filing_date_dt
    FROM
        citations_within_one_month f
    ORDER BY
        citation_count DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp.focal_pub_num
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT focal_filing_date_dt FROM best_patent))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f,
        LATERAL FLATTEN(input => c."embedding_v1") c_e,
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
The error information is:
100097 (22007): 01b9cea8-0004-7b17-0001-11c300eec52e: Can't parse '0' as date with format 'YYYYMMDD'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:20:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:20:55 - root - INFO - ```sql
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') as focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
        AND p."filing_date" != 0
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') as citing_filing_date_dt,
        cf.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") cf
    WHERE 
        cp."filing_date" IS NOT NULL
        AND cp."filing_date" != 0
),
citations_within_one_month AS (
    SELECT 
        f.focal_pub_num,
        COUNT(*) as citation_count,
        f.focal_filing_date_dt
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c.cited_pub_num = f.focal_pub_num
            AND c.citing_filing_date_dt BETWEEN f.focal_filing_date_dt AND DATEADD(day, 30, f.focal_filing_date_dt)
    GROUP BY 
        f.focal_pub_num,
        f.focal_filing_date_dt
),
best_patent AS (
    SELECT
        f.focal_pub_num,
        f.focal_filing_date_dt
    FROM
        citations_within_one_month f
    ORDER BY
        citation_count DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp.focal_pub_num
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND p."filing_date" != 0
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT focal_filing_date_dt FROM best_patent))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f,
        LATERAL FLATTEN(input => c."embedding_v1") c_e,
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
```
2025-01-19 03:20:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:20:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:20:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:20:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:20:58 - snowflake.connector.connection - INFO - closed
2025-01-19 03:20:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:20:58 - root - INFO - itercount: 4
2025-01-19 03:20:58 - root - INFO - 0
2025-01-19 03:20:58 - root - INFO - results: 
FOCAL_PATENT_NUMBER,MOST_SIMILAR_PATENT_NUMBER
US-7877798-B2,US-2009192703-A1


2025-01-19 03:20:58 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Focal_patent_number,Most_similar_patent_number
patent_number:str,similar_patent_number:str (Attention: answer in one row)
```

**Explanation:**

We identified the United States utility patent under the B2 classification granted between 2010 and 2014 with the most forward citations within a month of its filing date. Using text embeddings to calculate similarity, we then determined the most similar patent from the same filing year, regardless of its type. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
FOCAL_PATENT_NUMBER,MOST_SIMILAR_PATENT_NUMBER
US-7877798-B2,US-2009192703-A1
Current sql:
WITH focal_pats AS (
    SELECT 
        p."publication_number" as focal_pub_num, 
        p."filing_date" as focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') as focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
        AND p."filing_date" != 0
),
citing_pats AS (
    SELECT 
        cp."publication_number" as citing_pub_num, 
        cp."filing_date" as citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') as citing_filing_date_dt,
        cf.value:"publication_number"::STRING as cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") cf
    WHERE 
        cp."filing_date" IS NOT NULL
        AND cp."filing_date" != 0
),
citations_within_one_month AS (
    SELECT 
        f.focal_pub_num,
        COUNT(*) as citation_count,
        f.focal_filing_date_dt
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c.cited_pub_num = f.focal_pub_num
            AND c.citing_filing_date_dt BETWEEN f.focal_filing_date_dt AND DATEADD(day, 30, f.focal_filing_date_dt)
    GROUP BY 
        f.focal_pub_num,
        f.focal_filing_date_dt
),
best_patent AS (
    SELECT
        f.focal_pub_num,
        f.focal_filing_date_dt
    FROM
        citations_within_one_month f
    ORDER BY
        citation_count DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" as focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp.focal_pub_num
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND p."filing_date" != 0
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT focal_filing_date_dt FROM best_patent))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" as candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) as similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f,
        LATERAL FLATTEN(input => c."embedding_v1") c_e,
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) as Focal_patent_number,
    candidate_pub_num as Most_similar_patent_number
FROM
    most_similar_patent;
2025-01-19 03:21:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:21:44 - root - INFO - ```sql
WITH focal_pats AS (
    SELECT 
        p."publication_number" AS focal_pub_num, 
        p."filing_date" AS focal_filing_date,
        TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS focal_filing_date_dt
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    WHERE 
        p."country_code" = 'US' 
        AND p."kind_code" = 'B2' 
        AND p."grant_date" BETWEEN 20100101 AND 20141231
        AND p."filing_date" IS NOT NULL
        AND p."filing_date" != 0
),
citing_pats AS (
    SELECT 
        cp."publication_number" AS citing_pub_num, 
        cp."filing_date" AS citing_filing_date,
        TO_DATE(cp."filing_date"::VARCHAR, 'YYYYMMDD') AS citing_filing_date_dt,
        cf.VALUE:"publication_number"::STRING AS cited_pub_num
    FROM 
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS cp,
        LATERAL FLATTEN(input => cp."citation") cf
    WHERE 
        cp."filing_date" IS NOT NULL
        AND cp."filing_date" != 0
),
citations_within_one_month AS (
    SELECT 
        f.focal_pub_num,
        COUNT(*) AS citation_count,
        f.focal_filing_date_dt
    FROM 
        focal_pats f 
        JOIN citing_pats c
            ON c.cited_pub_num = f.focal_pub_num
            AND c.citing_filing_date_dt BETWEEN f.focal_filing_date_dt AND DATEADD(day, 30, f.focal_filing_date_dt)
    GROUP BY 
        f.focal_pub_num,
        f.focal_filing_date_dt
),
best_patent AS (
    SELECT
        f.focal_pub_num,
        f.focal_filing_date_dt
    FROM
        citations_within_one_month f
    ORDER BY
        citation_count DESC NULLS LAST
    LIMIT 1
),
focal_embedding AS (
    SELECT
        ae."embedding_v1" AS focal_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae
        JOIN best_patent bp ON ae."publication_number" = bp.focal_pub_num
    WHERE
        ae."embedding_v1" IS NOT NULL
),
candidate_pats AS (
    SELECT
        p."publication_number",
        ae."embedding_v1"
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number"
    WHERE
        p."filing_date" IS NOT NULL
        AND p."filing_date" != 0
        AND EXTRACT(year FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = EXTRACT(year FROM (SELECT focal_filing_date_dt FROM best_patent))
        AND ae."embedding_v1" IS NOT NULL
        AND p."publication_number" <> (SELECT focal_pub_num FROM best_patent)
),
similarity_calculations AS (
    SELECT
        c."publication_number" AS candidate_pub_num,
        SUM(f_e.VALUE::FLOAT * c_e.VALUE::FLOAT) AS similarity_score
    FROM
        candidate_pats c
        CROSS JOIN focal_embedding f,
        LATERAL FLATTEN(input => c."embedding_v1") c_e,
        LATERAL FLATTEN(input => f.focal_embedding) f_e
    WHERE
        c_e.SEQ = f_e.SEQ
    GROUP BY
        c."publication_number"
),
most_similar_patent AS (
    SELECT
        candidate_pub_num
    FROM
        similarity_calculations
    ORDER BY
        similarity_score DESC NULLS LAST
    LIMIT 1
)
SELECT
    (SELECT focal_pub_num FROM best_patent) AS Focal_patent_number,
    candidate_pub_num AS Most_similar_patent_number
FROM
    most_similar_patent;
```
2025-01-19 03:21:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:21:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:21:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:21:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:21:47 - snowflake.connector.connection - INFO - closed
2025-01-19 03:21:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:21:47 - root - INFO - itercount: 5
2025-01-19 03:21:47 - root - INFO - 0
2025-01-19 03:21:47 - root - INFO - Total iteration counts: 5
