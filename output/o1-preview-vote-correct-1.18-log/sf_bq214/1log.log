2025-01-19 03:15:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:15:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:15:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:15:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:15:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-01-19 03:16:01 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:02 - root - INFO - SQL:
-- 1. Select distinct country codes from PUBLICATIONS
SELECT DISTINCT "country_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Results:
country_code
JP
GB
BE
FI
DK
WO
EP
LU
CA
NL
RU
KR
US
DE
ES
CN
FR

2025-01-19 03:16:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-19 03:16:03 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:04 - root - INFO - SQL:
-- 2. Select distinct kind codes from PUBLICATIONS
SELECT DISTINCT "kind_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Results:
kind_code
B1
S
D2
U8
H
C1
T0
A5
Y2
T2
C9
U4
P1
R2
V0
B8
F
R1
L
A0
B9
E1
C3
A7
K4
Z1
A1
T3
H1
T7
A4
T5
A8
I5
I2
B
Y1
K1
R
A
B3
T4
P
T8
U0
T1
Y4
A2
I4
Y
T9
I1
U9
P2
P3
D1
C2
B4
C5
H3
A3
K5
U1
A6
C
U
S1
U3
M
T
B2
A9
D0
E

2025-01-19 03:16:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:05 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:06 - root - INFO - SQL:
-- 3. Select publication numbers and grant dates for patents granted between 2010 and 2014
SELECT "publication_number", "grant_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "grant_date" BETWEEN 20100101 AND 20141231
LIMIT 1000
Results:
Too long, hard cut:
publication_number,grant_date
US-8018125-B2,20110913
CN-101677236-B,20130213
CN-102221403-B,20130109
JP-4523317-B2,20100811
RU-2507287-C1,20140220
CN-102350882-B,20131113
KR-101146405-B1,20120517
CN-101732051-B,20111228
US-8297434-B2,20121030
CN-101160889-B,20110427
CN-101533632-B,20120725
US-7642037-B2,20100105
CN-101366149-B,20130306
CN-102257368-B,20130306
KR-101281684-B1,20130705
CN-203336222-U,20131211
US-7859134-B2,20101228
CN-203737902-U,20140730
US-8039891-B2,20111018
KR-101258912-B1,20130430
US-8224596-B2,20120717
CN-102443425-B,20140402
CN-101505919-B,20110608
CN-101893789-B,20120829
US-8330621-B2,20121211
US-8167101-B2,20120501
US-8702088-B2,20140422
US-8108347-B2,20120131
KR-101321554-B1,20131022
KR-101239020-B1,20130304
CN-101884112-B,20120905
KR-101249166-B1,20130401
RU-2471117-C1,20121227
US-7938000-B2,20110510
KR-100948793-B1,20100324
CN-101772484-B,20130918
DE-202010003013-U1,20110809
RU-2516333-C2,20140520
CN-101963389-B,20120822
US-7751638-B1,20100706
KR-101103662-B1,20120111
CN-101753094-B,20120620
CN-101808060-B,20121205
KR-101140245-B1,20120515
CN-102202977-B,20141022
CN-102656572-B,20141203
US-8109016-B2,20120207
CN-101785640-B,20140730
CN-101115214-B,20110420
US-7995810-B2,20110809
US-8260772-B2,20120904
US-8102623-B2,20120124
US-7913963-B2,20110329
US-7823930-B2,20101102
CN-204066732-U,20141231
US-8582104-B2,20131112
RU-2505352-C1,20140127
CN-101600477-B,20120125
CN-101298726-B,20110727
CN-101753530-B,20120704
RU-2452368-C2,20120610
RU-2479431-C2,20130420
KR-101016825-B1,20110221
CN-101431492-B,20110525
RU-2388467-C2,20100510
CN-101977740-B,20130501
ES-2333277-T3,20100218
JP-5243906-B2,20130724
US-8908679-B2,20141209
DE-202012010311-U1,20121129
JP-4799283-B2,20111026
CN-202324442-U,20120711
CN-203795264-U,20140827
US-7960413-B2,20110614
US-7704877-B2,20100427
JP-5487331-B1,20140507
JP-4405907-B2,20100127
JP-5367651-B2,20131211
KR-101165755-B1,20120718
CA-150285-S,20140514
EP-1897467-B1,20100317
EP-2032364-B1,20110119
EP-1043858-B1,20110817
US-D659890-S,20120515
JP-4902427-B2,20120321
JP-4805213-B2,20111102
JP-5287051-B2,20130911
CN-102375433-B,20130821
CN-203670027-U,20140625
CN-201729641-U,20110202
CA-2611991-C,20140325
CA-2612759-C,20140121
CN-201557964-U,20100825
CN-102531489-B,20130918
CN-202606183-U,20121219
CN-202892211-U,20130424
CN-203322964-U,20131204
JP-5109415-B2,20121226
CN-204046263-U,20141224
CN-203220495-U,20131002
CN-202508119-U,20121031
CN-203869096-U,20141008
ES-2351940-T3,20110214
CN-101364543-B,20110420
CN-202511065-U,20121031
CN-202777070-U,20130313
JP-5614830-B2,20141029
CN-202428800-U,20120912
CN-203512410-U,20140402
GB-201410750-D0,20140730
CN-202193148-U,20120418
CN-202607290-U,20121219
CN-202607049-U,20121219
EP-1547681-B1,20131009
EP-2406190-B1,20130403
CN-201533905-U,20100728
EP-1357378-B1,20130424
CN-202210037-U,20120502
JP-5419524-B2,20140219
CN-203300604-U,20131120
JP-5468921-B2,20140409
CN-201393954-Y,20100203
CN-202170911-U,20120321
CN-203801641-U,20140903
GB-201007731-D0,20100623
JP-5050909-B2,20121017
JP-5131922-B2,20130130
CN-201849116-U,20110601
CN-102074409-B,20110921
CN-202473583-U,20121003
CN-203726106-U,20140723
CN-203827968-U,20140917
EP-2174819-B1,20120516
CN-201423700-Y,20100317
CN-203421770-U,20140205
US-7727473-B2,20100601
US-8425821-B2,20130423
US-D613747-S,20100413
FR-2979364-B1,20140718
JP-4944847-B2,20120606
CN-203449360-U,20140226
CN-203905888-U,20141029
DE-602004031872-D1,20110428
CN-202147027-U,20120222
CN-203077788-U,20130724
CN-203319995-U,20131204
US-7885444-B2,20110208
US-8771847-B2,20140708
US-8403121-B2,20130326
JP-4604714-B2,20110105
RU-2417621-C2,20110510
EP-2215338-B1,20140611
JP-5265712-B2,20130814
CN-202404318-U,20120829
EP-2031831-B1,20121003
EP-2591243-B1,20140702
RU-137026-U1,20140127
JP-4996061-B2,20120808
EP-1858433-B1,20120829
CN-202522907-U,20121107
CN-203853051-U,20141001
CN-204025888-U,20141217
DE-602006012692-D1,20100415
CN-101614473-B,20110406
CN-202082057-U,20111221
EP-1882702-B1,20100303
CN-202232751-U,20120530
CN-202875621-U,20130417
DE-60330265-D1,20100107
JP-5262286-B2,20130814
CN-202145559-U,20120215
CA-2532913-C,20120731
CN-201753784-U,20110302
CN-202792826-U,20130313
CN-201845688-U,20110525
CN-202485452-U,20121010
JP-4535358-B2,20100901
JP-5641286-B2,20141217
CN-203910701-U,20141029
CN-204067456-U,20141231
JP-5519435-B2,20140611
CN-201648388-U,20101124
JP-4971129-B2,20120711
JP-5600140-B2,20141001
JP-4953920-B2,20120613
CN-203641849-U,20140611
CN-201547566-U,20100811
CN-201489841-U,20100526
US-8400024-B2,20130319
CA-2458138-C,20121009
JP-5032692-B1,20120926
JP-5571073-B2,20140813
US-8877381-B2,20141104
US-8499967-B2,20130806
JP-5134515-B2,20130130
JP-4831526-B2,20111207
CN-201868153-U,20110615
CN-202992920-U,20130612
US-7982267-B2,20110719
KR-100978408-B1,20100826
EP-1029928-B1,20100721
JP-5355841-B2,20131127
KR-101231527-B1,20130207
JP-4908506-B2,20120404
US-8004671-B2,20110823
US-8150897-B2,20120403
CN-203814396-U,20140910
CN-203961659-U,20141126
JP-4510797-B2,20100728
RU-2380712-C1,20100127
CN-2040

2025-01-19 03:16:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:08 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:08 - root - INFO - SQL:
-- 4. Select publication numbers and kind codes where kind code is 'B2'
SELECT "publication_number", "kind_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "kind_code" = 'B2'
LIMIT 1000
Results:
Too long, hard cut:
publication_number,kind_code
US-6594862-B2,B2
US-8395734-B2,B2
US-7781260-B2,B2
JP-4565593-B2,B2
JP-4813799-B2,B2
US-7197968-B2,B2
US-6766870-B2,B2
JP-4719627-B2,B2
US-7518315-B2,B2
US-7879487-B2,B2
US-8229907-B2,B2
US-8405269-B2,B2
US-8423896-B2,B2
US-8694822-B2,B2
JP-H0625495-B2,B2
US-7717638-B2,B2
US-9658993-B2,B2
US-7432680-B2,B2
US-8984416-B2,B2
JP-5036281-B2,B2
JP-3289126-B2,B2
JP-3561612-B2,B2
JP-3742545-B2,B2
JP-5065641-B2,B2
JP-H0585322-B2,B2
JP-6072843-B2,B2
JP-4351557-B2,B2
JP-5008058-B2,B2
JP-5439596-B2,B2
US-9558401-B2,B2
JP-3737523-B2,B2
JP-H0779562-B2,B2
DE-2446227-B2,B2
JP-5551640-B2,B2
JP-6127609-B2,B2
JP-3605011-B2,B2
JP-5914227-B2,B2
JP-5823463-B2,B2
JP-H0824432-B2,B2
JP-S5836136-B2,B2
US-8593015-B2,B2
US-6908096-B2,B2
US-7137747-B2,B2
US-8127992-B2,B2
JP-S5838878-B2,B2
US-8290010-B2,B2
US-6708776-B2,B2
JP-H0473349-B2,B2
US-7057340-B2,B2
US-7498861-B2,B2
US-9473501-B2,B2
JP-2837361-B2,B2
US-9086293-B2,B2
US-7643385-B2,B2
US-8456858-B2,B2
US-7066032-B2,B2
JP-2697479-B2,B2
US-8153074-B2,B2
US-9333719-B2,B2
US-8919830-B2,B2
US-9743211-B2,B2
US-6917653-B2,B2
US-7939921-B2,B2
US-6666152-B2,B2
US-6914921-B2,B2
US-6817384-B2,B2
US-7421051-B2,B2
US-8777490-B2,B2
US-9160846-B2,B2
JP-S633988-B2,B2
US-8216528-B2,B2
US-8373784-B2,B2
US-7695394-B2,B2
US-8166308-B2,B2
US-8505748-B2,B2
JP-3234711-B2,B2
US-8932580-B2,B2
US-8522458-B2,B2
US-9053990-B2,B2
US-6888054-B2,B2
JP-4597740-B2,B2
US-9351680-B2,B2
US-8965717-B2,B2
US-6575894-B2,B2
US-7360059-B2,B2
US-7703738-B2,B2
US-7113713-B2,B2
US-8423568-B2,B2
US-8553286-B2,B2
US-9326023-B2,B2
US-8173931-B2,B2
JP-4485842-B2,B2
US-9152509-B2,B2
US-9344066-B2,B2
US-8547754-B2,B2
US-7992681-B2,B2
US-9139321-B2,B2
US-8296622-B2,B2
US-7108617-B2,B2
US-9623324-B2,B2
US-8702289-B2,B2
US-8036024-B2,B2
US-8770567-B2,B2
US-6335590-B2,B2
US-7753494-B2,B2
US-9231312-B2,B2
US-7112652-B2,B2
US-8632084-B2,B2
JP-4866116-B2,B2
JP-6145545-B2,B2
US-9054177-B2,B2
JP-2704264-B2,B2
JP-3886824-B2,B2
JP-4867002-B2,B2
JP-6107081-B2,B2
JP-4676500-B2,B2
US-7923105-B2,B2
US-8335430-B2,B2
JP-5401090-B2,B2
JP-3206823-B2,B2
JP-2541012-B2,B2
JP-5565832-B2,B2
JP-6067127-B2,B2
JP-5453194-B2,B2
JP-3007301-B2,B2
JP-S5236393-B2,B2
JP-3506173-B2,B2
JP-S5741871-B2,B2
JP-S6251408-B2,B2
JP-2813048-B2,B2
JP-S6051741-B2,B2
JP-H0687104-B2,B2
JP-3049791-B2,B2
JP-2548641-B2,B2
JP-2630209-B2,B2
JP-2956544-B2,B2
JP-5816120-B2,B2
JP-3418717-B2,B2
JP-5099247-B2,B2
JP-H0636475-B2,B2
JP-4194791-B2,B2
JP-4113539-B2,B2
JP-H0774002-B2,B2
JP-5309914-B2,B2
JP-5001554-B2,B2
JP-H0768619-B2,B2
US-8735738-B2,B2
JP-3370339-B2,B2
US-9694234-B2,B2
US-7913538-B2,B2
US-8108683-B2,B2
US-8407406-B2,B2
US-8453236-B2,B2
US-9326904-B2,B2
US-8937584-B2,B2
US-6516621-B2,B2
US-8160008-B2,B2
US-7845489-B2,B2
JP-H0138031-B2,B2
US-9510605-B2,B2
JP-3019915-B2,B2
US-7792790-B2,B2
US-6588095-B2,B2
US-9424300-B2,B2
US-8209044-B2,B2
US-8632085-B2,B2
US-6827891-B2,B2
US-8753277-B2,B2
JP-4700305-B2,B2
US-9319581-B2,B2
US-7854729-B2,B2
US-8234525-B2,B2
US-7225471-B2,B2
US-8797370-B2,B2
US-9180598-B2,B2
US-9085831-B2,B2
US-7057966-B2,B2
US-8573251-B2,B2
US-9564307-B2,B2
JP-4672714-B2,B2
US-9539539-B2,B2
US-7570911-B2,B2
US-8561216-B2,B2
JP-4764888-B2,B2
US-9720238-B2,B2
US-8118210-B2,B2
US-7951389-B2,B2
US-6842614-B2,B2
US-9207311-B2,B2
US-9248944-B2,B2
US-7562889-B2,B2
US-9002995-B2,B2
US-8395592-B2,B2
US-7933540-B2,B2
US-7543608-B2,B2
US-6862124-B2,B2
US-7815667-B2,B2
US-6595516-B2,B2
US-7640341-B2,B2
JP-H0140002-B2,B2
JP-5234226-B2,B2
JP-S5724543-B2,B2
JP-2543119-B2,B2
JP-S6230126-B2,B2
JP-4649309-B2,B2
JP-S5641110-B2,B2
US-8150333-B2,B2
US-9534636-B2,B2
US-8521803-B2,B2
US-7724258-B2,B2
US-8705060-B2,B2
US-7588957-B2,B2
US-9213606-B2,B2
US-8141480-B2,B2
US-8460785-B2,B2
JP-H057427-B2,B2
US-8354967-B2,B2
US-9107671-B2,B2
US-7272949-B2,B2
JP-H0522270-B2,B2
US-8221179-B2,B2
US-6994534-B2,B2
US-9611232-B2,B2
JP-H0369560-B2,B2
US-7151424-B2,B2
US-9392914-B2,B2
JP-S6244046-B2,B2
US-9683702-B2,B2
US-8352094-B2,B2
US-7002780-B2,B2
JP-6062052-B2,B2
US-8520301-B2,B2
US-8463797-B2,B2
US-7173260-B2,B2
US-7218306-B2,B2
JP-4622665-B2,B2
US-9322575-B2,B2
US-8251903-B2,B2
US-8011721-B2,B2
JP-3203231-B2,B2
JP-S6260989-B2,B2
JP-4496124-B2,B2
JP-4676540-B2,B2
US-7674988-B2,B2
US-7890720-B2,B2
US-7587611-B2,B2
US-8555064-B2,B2
US-9388108-B2,B2
JP-S5827857-B2,B2
JP-S6352211-B2,B2
US-9005975-B2,B2
US-7811452-B2,B2
US-9733126-B2,B2
US-8660712-B2,B2
US-8723563-B2,B2
US-9589942-B2,B2
US-7533243-B2,B2
US-9558040-B2,B2
US-7318140-B2,B2
US-7813102-B2,B2
US-7136766-B2,B2
US-7673942-B2,B2
US-8488198-B2,B2
JP-4528090-B2,B2
US-9321589-B2,B2
US-7258828-B2,B2
JP-S5922784-B2,B2
US-8941934-B2,B2
US-6720711-B2,B2
US-8777123-B2,B2
US-9100676-B2,B2
US-9128197-B2,B2
JP-5359876-B2,B2
US-9318799-B2,B2
US-7547705-B2,B2
JP-S5120640-B2,B2
JP-2766264-B2,B2
JP-3651581-B2,B2
JP-5401096-B2,B2
DE-2020823-B2,B2
JP-3546614-B2,B2
JP-4021937-B2,B2
JP-H0778203-B2,B2
JP-5690082-B2,B2
DE-2362377-B2,B2
DE-2422895-B2,B2
JP-4074010-B2,B2
DE-2651848-B2,B2
JP-H0635817-B2,B2
JP-S5617024-B2,B2
US-8495918

2025-01-19 03:16:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:10 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:10 - root - INFO - SQL:
-- 5. Select publication numbers and country codes where country code is 'US'
SELECT "publication_number", "country_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
LIMIT 1000
Results:
Too long, hard cut:
publication_number,country_code
US-4314796-A,US
US-7255124-B2,US
US-5356642-A,US
US-2593956-A,US
US-5189263-A,US
US-4064751-A,US
US-2014308545-A1,US
US-2009302562-A1,US
US-3130704-A,US
US-8503036-B2,US
US-3904467-A,US
US-4403287-A,US
US-3949207-A,US
US-3632254-A,US
US-8178184-B2,US
US-3239383-A,US
US-7274413-B1,US
US-5442064-A,US
US-5365487-A,US
US-6946026-B2,US
US-5863294-A,US
US-6326774-B1,US
US-4744173-A,US
US-5605992-A,US
US-2961970-A,US
US-5127771-A,US
US-4359891-A,US
US-5593482-A,US
US-6924955-B2,US
US-5733019-A,US
US-5038405-A,US
US-4753095-A,US
US-8879934-B2,US
US-3129884-A,US
US-8547039-B2,US
US-4003678-A,US
US-4666475-A,US
US-5788562-A,US
US-3419727-A,US
US-3103783-A,US
US-8802933-B2,US
US-4069179-A,US
US-3673753-A,US
US-5269439-A,US
US-4571258-A,US
US-4069530-A,US
US-4123665-A,US
US-6903210-B2,US
US-6788828-B2,US
US-8103295-B2,US
US-2007201436-A1,US
US-9407145-B1,US
US-7581880-B2,US
US-2008196881-A1,US
US-9614020-B2,US
US-8673549-B2,US
US-2003094317-A1,US
US-2008281992-A1,US
US-2016354748-A1,US
US-2017013888-A1,US
US-2017072311-A1,US
US-2014153051-A1,US
US-2013328242-A1,US
US-2010089921-A1,US
US-2013252459-A1,US
US-6288085-B1,US
US-2012161609-A1,US
US-2014042836-A1,US
US-2016014835-A1,US
US-2012148910-A1,US
US-2016254790-A1,US
US-D532151-S,US
US-2007009740-A1,US
US-2014316902-A1,US
US-2006274700-A1,US
US-2011120677-A1,US
US-2010152081-A1,US
US-2010134029-A1,US
US-2810136-A,US
US-2003008654-A9,US
US-2010058869-A1,US
US-2004120148-A1,US
US-2006271029-A1,US
US-2011266680-A1,US
US-2011181508-A1,US
US-2009067478-A1,US
US-2014062501-A1,US
US-7495178-B2,US
US-7690976-B2,US
US-4045115-A,US
US-2008258975-A1,US
US-2002042744-A1,US
US-6743873-B2,US
US-8142536-B2,US
US-2016267729-A1,US
US-2008192815-A1,US
US-2012312924-A1,US
US-6594862-B2,US
US-2008051656-A1,US
US-4859461-A,US
US-3162925-A,US
US-7136374-B1,US
US-9451715-B1,US
US-2680954-A,US
US-2014297747-A1,US
US-9517269-B1,US
US-2003127734-A1,US
US-2013312230-A1,US
US-5925071-A,US
US-3965956-A,US
US-8395734-B2,US
US-7781260-B2,US
US-5006347-A,US
US-5585084-A,US
US-4310627-A,US
US-3990787-A,US
US-4748887-A,US
US-4395601-A,US
US-4525140-A,US
US-5552785-A,US
US-6157871-A,US
US-D468550-S,US
US-2007013729-A1,US
US-2013309431-A1,US
US-2016375553-A1,US
US-2010037801-A1,US
US-2008279111-A1,US
US-6757087-B1,US
US-7197968-B2,US
US-6766870-B2,US
US-2016059789-A1,US
US-2003174075-A1,US
US-2010011146-A1,US
US-2004239394-A1,US
US-2014139812-A1,US
US-2009121086-A1,US
US-2009017283-A1,US
US-2016106445-A1,US
US-2013304676-A1,US
US-2007072657-A1,US
US-2009096419-A1,US
US-3501538-A,US
US-3611242-A,US
US-2013041104-A1,US
US-2009284106-A1,US
US-2010102963-A1,US
US-2011240441-A1,US
US-2009267887-A1,US
US-2002047271-A1,US
US-2004148945-A1,US
US-7518315-B2,US
US-7879487-B2,US
US-8229907-B2,US
US-2009253069-A1,US
US-8405269-B2,US
US-2002002062-A1,US
US-2002141706-A1,US
US-2009119833-A1,US
US-8423896-B2,US
US-2009257082-A1,US
US-6621008-B1,US
US-8694822-B2,US
US-2013066852-A1,US
US-2011052637-A1,US
US-2010025510-A1,US
US-2016351058-A1,US
US-7717638-B2,US
US-3845538-A,US
US-4361892-A,US
US-3763318-A,US
US-2008318205-A1,US
US-2006013739-A1,US
US-9658993-B2,US
US-7432680-B2,US
US-8984416-B2,US
US-6112004-A,US
US-5171340-A,US
US-6089978-A,US
US-6974995-B1,US
US-7900566-B1,US
US-3427959-A,US
US-4832354-A,US
US-2008128430-A1,US
US-1702956-A,US
US-D450923-S,US
US-1380529-A,US
US-9558401-B2,US
US-26512-A,US
US-2002141229-A1,US
US-2040388-A,US
US-2004176590-A1,US
US-1464489-A,US
US-168574-A,US
US-2002152358-A1,US
US-2015281053-A1,US
US-6335590-B2,US
US-D720261-S,US
US-8145812-B1,US
US-7753494-B2,US
US-8857442-B1,US
US-9231312-B2,US
US-7112652-B2,US
US-8632084-B2,US
US-1913107-A,US
US-2012177138-A1,US
US-553727-A,US
US-D244732-S,US
US-9054177-B2,US
US-1268890-A,US
US-2012122213-A1,US
US-2014091605-A1,US
US-7923105-B2,US
US-8335430-B2,US
US-2014267822-A1,US
US-1600561-A,US
US-2001010400-A1,US
US-308737-A,US
US-243561-A,US
US-1582755-A,US
US-2010055664-A1,US
US-1126474-A,US
US-711962-A,US
US-1207490-A,US
US-690812-A,US
US-1197291-A,US
US-8702-A,US
US-1703379-A,US
US-670398-A,US
US-1058309-A,US
US-196436-A,US
US-2002047753-A1,US
US-1564322-A,US
US-7811452-B2,US
US-9733126-B2,US
US-2002115116-A1,US
US-2004052009-A1,US
US-2002061505-A1,US
US-8660712-B2,US
US-2008272692-A1,US
US-2005025813-A1,US
US-2013064650-A1,US
US-8723563-B2,US
US-2008189482-A1,US
US-2013017093-A1,US
US-2013274292-A1,US
US-2015304568-A1,US
US-9589942-B2,US
US-7533243-B2,US
US-9558040-B2,US
US-2006163234-A1,US
US-2004043342-A1,US
US-2017085455-A1,US
US-7318140-B2,US
US-2013079924-A1,US
US-2006291891-A1,US
US-2631212-A,US
US-7813102-B2,US
US-7136766-B2,US
US-2016154938-A1,US
US-7673942-B2,US
US-4229080-A,US
US-2015194281-A1,US
US-2012324816-A1,US
US-2011015934-A1,US
US-2015322185-A1,US
US-8488198-B2,US
US-2643977-A,US
US-5593044-A,US
US-3955812-A,US
US-3739896-A,US
US-7119852-B1,US
US-5438267-A,US
US-2008099571-A1,US
US-3751825-A,US
US-4605176-A,US
US-2743280-A,US
US-5070536-A,US
US-2501225-A,US
US-9321589-B2,US
US-4909676-A,US


2025-01-19 03:16:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:12 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:12 - root - INFO - SQL:
-- 6. Select publication numbers and filing dates where filing date is not null
SELECT "publication_number", "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "filing_date" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-

2025-01-19 03:16:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:14 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:15 - root - INFO - SQL:
-- 7. Select publication numbers and countries from ABS_AND_EMB
SELECT "publication_number", "country"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,country
CA-27-A,CANADA
ES-81-Y,SPAIN
DE-303-C,FEDERAL REPUBLIC GERMANY
ES-866-Y,SPAIN
FI-150-A,FINLAND
FI-250-A,FINLAND
FR-336-E,FRANCE
NL-284-C,NETHERLANDS
NL-947-C,NETHERLANDS
BE-107-T1,BELGIUM
CA-1911-A,CANADA
CA-4005-A,CANADA
CA-4106-A,CANADA
CA-4698-A,CANADA
CA-4801-A,CANADA
CA-5943-A,CANADA
CA-6183-A,CANADA
CA-6207-A,CANADA
CA-6390-A,CANADA
CA-6969-A,CANADA
CA-8931-S,CANADA
CA-9897-A,CANADA
DE-3129-C,FEDERAL REPUBLIC GERMANY
DE-3301-C,FEDERAL REPUBLIC GERMANY
DE-3884-C,FEDERAL REPUBLIC GERMANY
DE-3983-C,FEDERAL REPUBLIC GERMANY
DE-5976-C,FEDERAL REPUBLIC GERMANY
DK-2807-C,DENMARK
DK-3080-C,DENMARK
DK-3107-C,DENMARK
DK-3184-C,DENMARK
DK-3510-C,DENMARK
DK-5867-C,DENMARK
DK-5921-C,DENMARK
DK-6491-A,DENMARK
DK-7210-C,DENMARK
DK-8069-C,DENMARK
DK-8466-C,DENMARK
DK-9281-C,DENMARK
DK-9359-C,DENMARK
ES-1062-U,SPAIN
ES-1498-U,SPAIN
ES-1524-Y,SPAIN
ES-1872-U,SPAIN
ES-2542-Y,SPAIN
ES-2819-Y,SPAIN
ES-2960-U,SPAIN
ES-3045-U,SPAIN
ES-4483-Y,SPAIN
ES-4723-Y,SPAIN
ES-4858-U,SPAIN
ES-5089-Y,SPAIN
ES-5219-Y,SPAIN
ES-5716-U,SPAIN
ES-5975-Y,SPAIN
ES-6454-U,SPAIN
ES-6552-Y,SPAIN
ES-6928-Y,SPAIN
ES-6962-Y,SPAIN
ES-7086-Y,SPAIN
ES-7407-Y,SPAIN
ES-7489-Y,SPAIN
ES-7516-U,SPAIN
ES-7538-U,SPAIN
ES-764-H3,SPAIN
ES-8269-Y,SPAIN
FI-1825-A,FINLAND
FI-291-U1,FINLAND
FI-3021-A,FINLAND
FI-4211-A,FINLAND
FI-4543-A,FINLAND
FI-8034-A,FINLAND
FI-8619-A,FINLAND
FI-8985-A,FINLAND
FI-902-U1,FINLAND
FR-1186-E,FRANCE
FR-1382-E,FRANCE
FR-1550-M,FRANCE
FR-2064-E,FRANCE
FR-2510-M,FRANCE
FR-2578-M,FRANCE
FR-2635-E,FRANCE
FR-3293-M,FRANCE
FR-5174-E,FRANCE
FR-5770-E,FRANCE
FR-7085-M,FRANCE
FR-7747-E,FRANCE
FR-8053-M,FRANCE
FR-8143-M,FRANCE
NL-3613-C,NETHERLANDS
NL-4187-C,NETHERLANDS
NL-5034-C,NETHERLANDS
NL-9752-C,NETHERLANDS
NL-9761-C,NETHERLANDS
RU-815-U1,RUSSIAN FEDERATION
US-1260-A,USA
US-1844-A,USA
US-3704-A,USA
US-4174-P,USA
US-4340-A,USA
US-4449-P,USA
US-4570-P,USA
US-5293-P,USA
US-5333-A,USA
US-5618-A,USA
US-6399-A,USA
US-6501-P,USA
US-7090-A,USA
US-7624-A,USA
US-7703-P,USA
US-7765-P,USA
US-8162-P,USA
US-8923-P,USA
US-9153-A,USA
US-9563-A,USA
US-H817-H,USA
CA-10240-A,CANADA
CA-10445-A,CANADA
CA-11856-A,CANADA
CA-12085-A,CANADA
CA-12299-A,CANADA
CA-12359-A,CANADA
CA-12986-A,CANADA
CA-14364-A,CANADA
CA-15108-A,CANADA
CA-15467-A,CANADA
CA-16464-A,CANADA
CA-16944-A,CANADA
CA-17107-A,CANADA
CA-18535-S,CANADA
CA-19006-S,CANADA
CA-21676-A,CANADA
CA-21706-A,CANADA
CA-21979-A,CANADA
CA-22497-S,CANADA
CA-22705-A,CANADA
CA-23044-A,CANADA
CA-25240-S,CANADA
CA-25587-A,CANADA
CA-26172-A,CANADA
CA-27810-A,CANADA
CA-29171-S,CANADA
CA-29565-A,CANADA
CA-30563-S,CANADA
CA-30747-A,CANADA
CA-31066-A,CANADA
CA-31656-A,CANADA
CA-34117-A,CANADA
CA-34328-A,CANADA
CA-35530-A,CANADA
CA-36126-A,CANADA
CA-37060-A,CANADA
CA-37412-A,CANADA
CA-38186-A,CANADA
CA-38290-A,CANADA
CA-38566-A,CANADA
CA-39941-A,CANADA
CA-41986-A,CANADA
CA-42957-A,CANADA
CA-43582-A,CANADA
CA-43613-A,CANADA
CA-43665-A,CANADA
CA-44103-A,CANADA
CA-44675-A,CANADA
CA-45114-S,CANADA
CA-45162-A,CANADA
CA-46041-S,CANADA
CA-46346-S,CANADA
CA-46414-S,CANADA
CA-46650-A,CANADA
CA-47228-S,CANADA
CA-47556-A,CANADA
CA-47943-A,CANADA
CA-48005-S,CANADA
CA-50059-A,CANADA
CA-51084-S,CANADA
CA-51448-A,CANADA
CA-53020-A,CANADA
CA-53342-A,CANADA
CA-53679-A,CANADA
CA-54019-A,CANADA
CA-56199-S,CANADA
CA-57871-A,CANADA
CA-58112-A,CANADA
CA-59658-S,CANADA
CA-62116-A,CANADA
CA-63512-A,CANADA
CA-64348-A,CANADA
CA-64895-A,CANADA
CA-64959-A,CANADA
CA-65051-A,CANADA
CA-65468-A,CANADA
CA-66408-A,CANADA
CA-67027-A,CANADA
CA-67256-A,CANADA
CA-68355-A,CANADA
CA-68561-A,CANADA
CA-69952-A,CANADA
CA-69969-A,CANADA
CA-70837-S,CANADA
CA-71352-A,CANADA
CA-72557-S,CANADA
CA-73229-S,CANADA
CA-73434-A,CANADA
CA-73648-A,CANADA
CA-75054-A,CANADA
CA-75833-A,CANADA
CA-75940-A,CANADA
CA-76442-A,CANADA
CA-77673-S,CANADA
CA-78154-A,CANADA
CA-78848-A,CANADA
CA-80485-S,CANADA
CA-81879-A,CANADA
CA-82735-A,CANADA
CA-83640-A,CANADA
CA-84428-S,CANADA
CA-84611-A,CANADA
CA-85458-S,CANADA
CA-87085-A,CANADA
CA-87655-A,CANADA
CA-88869-A,CANADA
CA-89598-S,CANADA
CA-90451-A,CANADA
CA-90703-A,CANADA
CA-91407-A,CANADA
CA-91839-A,CANADA
CA-92136-S,CANADA
CA-92671-S,CANADA
CA-93153-A,CANADA
CA-93847-S,CANADA
CA-94404-A,CANADA
CA-94834-A,CANADA
CA-95812-A,CANADA
CA-96813-A,CANADA
CA-97691-A,CANADA
CA-97784-A,CANADA
CA-98415-S,CANADA
CA-98613-A,CANADA
CA-98742-A,CANADA
CA-99391-S,CANADA
CA-99529-A,CANADA
DE-10599-C,FEDERAL REPUBLIC GERMANY
DE-10678-C,FEDERAL REPUBLIC GERMANY
DE-10717-C,FEDERAL REPUBLIC GERMANY
DE-12268-C,FEDERAL REPUBLIC GERMANY
DE-16453-C,FEDERAL REPUBLIC GERMANY
DE-17382-C,FEDERAL REPUBLIC GERMANY
DE-17635-C,FEDERAL REPUBLIC GERMANY
DE-18657-C,FEDERAL REPUBLIC GERMANY
DE-21533-C,FEDERAL REPUBLIC GERMANY
DE-21800-C,FEDERAL REPUBLIC GERMANY
DE-22191-C,FEDERAL REPUBLIC GERMANY
DE-24092-C,FEDERAL REPUBLIC GERMANY
DE-24550-C,FEDERAL REPUBLIC GERMANY
DE-26040-C,FEDERAL REPUBLIC GERMANY
DE-26251-C,FEDERAL REPUBLIC GERMANY
DE-26645-C,FEDERAL REPUBLIC GERMANY
DE-27162-C,FEDERAL REPUBLIC GERMANY
DE-28245-C,FEDERAL REPUBLIC GERMANY
DE-2866

2025-01-19 03:16:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 81
2025-01-19 03:16:18 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:19 - root - INFO - SQL:
-- 8. Select publication numbers and embeddings from ABS_AND_EMB
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 

2025-01-19 03:16:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 628
2025-01-19 03:16:22 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:22 - root - INFO - SQL:
-- 9. Inspect the structure of the 'cited_by' column in ABS_AND_EMB
SELECT t."publication_number", f.value AS "citing_publication_number"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
LATERAL FLATTEN(input => t."cited_by") f
LIMIT 1000
Results:
Too long, hard cut:
publication_number,citing_publication_number
JP-H11311351-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2006108223-A1"",
  ""type"": ""X""
}"
JP-S55101582-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2009019747-A1"",
  ""type"": ""A""
}"
JP-2007261350-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2015098042-A1"",
  ""type"": ""Y""
}"
JP-2013195867-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2015125364-A1"",
  ""type"": ""Y""
}"
JP-H09275620-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""KR-100722292-B1"",
  ""type"": """"
}"
JP-S615524-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-H03259843-A"",
  ""type"": """"
}"
JP-2005297895-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2007253801-A"",
  ""type"": """"
}"
JP-H08322367-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2010031181-A1"",
  ""type"": ""A""
}"
JP-H04247151-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009501564-A"",
  ""type"": """"
}"
JP-2000214640-A,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7883016-B2"",
  ""type"": """"
}"
JP-S6223320-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-S6443031-A"",
  ""type"": """"
}"
JP-S5243785-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-S59165710-U"",
  ""type"": """"
}"
JP-2004062130-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2013516653-A"",
  ""type"": """"
}"
JP-2001284831-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""CN-102340956-A"",
  ""type"": ""A""
}"
JP-2010042916-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2012111628-A"",
  ""type"": """"
}"
JP-H05268224-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009506590-A"",
  ""type"": """"
}"
JP-H11231257-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009211091-A"",
  ""type"": """"
}"
JP-2015117367-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""KR-101796548-B1"",
  ""type"": """"
}"
JP-S63257513-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2015532000-A"",
  ""type"": """"
}"
JP-2006027947-A,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-8784562-B2"",
  ""type"": """"
}"
JP-2001063207-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2003096341-A"",
  ""type"": """"
}"
JP-S5785313-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-H04111902-U"",
  ""type"": """"
}"
JP-H0419932-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2006308526-A"",
  ""type"": """"
}"
JP-2009039138-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2013137198-A"",
  ""type"": """"
}"
JP-H04215410-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""CN-104240895-A"",
  ""type"": ""A""
}"
JP-H03248457-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-H04277675-A"",
  ""type"": """"
}"
JP-2005309329-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": 

2025-01-19 03:16:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:16:23 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:16:24 - root - INFO - SQL:
-- 10. Select publication numbers and the count of forward citations from ABS_AND_EMB
SELECT "publication_number", ARRAY_SIZE("cited_by") AS "num_forward_citations"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,num_forward_citations
CA-27-A,0
ES-81-Y,0
DE-303-C,0
ES-866-Y,0
FI-150-A,0
FI-250-A,0
FR-336-E,0
NL-284-C,0
NL-947-C,0
BE-107-T1,0
CA-1911-A,0
CA-4005-A,0
CA-4106-A,0
CA-4698-A,0
CA-4801-A,0
CA-5943-A,0
CA-6183-A,0
CA-6207-A,0
CA-6390-A,0
CA-6969-A,0
CA-8931-S,0
CA-9897-A,0
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,0
DK-3080-C,0
DK-3107-C,0
DK-3184-C,0
DK-3510-C,0
DK-5867-C,0
DK-5921-C,0
DK-6491-A,0
DK-7210-C,0
DK-8069-C,0
DK-8466-C,0
DK-9281-C,0
DK-9359-C,0
ES-1062-U,0
ES-1498-U,0
ES-1524-Y,0
ES-1872-U,0
ES-2542-Y,0
ES-2819-Y,0
ES-2960-U,0
ES-3045-U,0
ES-4483-Y,0
ES-4723-Y,0
ES-4858-U,0
ES-5089-Y,0
ES-5219-Y,0
ES-5716-U,0
ES-5975-Y,0
ES-6454-U,0
ES-6552-Y,0
ES-6928-Y,0
ES-6962-Y,0
ES-7086-Y,0
ES-7407-Y,0
ES-7489-Y,0
ES-7516-U,0
ES-7538-U,0
ES-764-H3,0
ES-8269-Y,0
FI-1825-A,0
FI-291-U1,0
FI-3021-A,0
FI-4211-A,0
FI-4543-A,0
FI-8034-A,0
FI-8619-A,0
FI-8985-A,0
FI-902-U1,0
FR-1186-E,0
FR-1382-E,0
FR-1550-M,0
FR-2064-E,0
FR-2510-M,0
FR-2578-M,0
FR-2635-E,0
FR-3293-M,0
FR-5174-E,0
FR-5770-E,0
FR-7085-M,0
FR-7747-E,0
FR-8053-M,0
FR-8143-M,0
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,0
RU-815-U1,0
US-1260-A,0
US-1844-A,0
US-3704-A,0
US-4174-P,0
US-4340-A,0
US-4449-P,0
US-4570-P,0
US-5293-P,0
US-5333-A,0
US-5618-A,0
US-6399-A,0
US-6501-P,0
US-7090-A,0
US-7624-A,0
US-7703-P,0
US-7765-P,0
US-8162-P,0
US-8923-P,0
US-9153-A,0
US-9563-A,0
US-H817-H,0
CA-10240-A,0
CA-10445-A,0
CA-11856-A,0
CA-12085-A,0
CA-12299-A,0
CA-12359-A,0
CA-12986-A,0
CA-14364-A,0
CA-15108-A,0
CA-15467-A,0
CA-16464-A,0
CA-16944-A,0
CA-17107-A,0
CA-18535-S,0
CA-19006-S,0
CA-21676-A,0
CA-21706-A,0
CA-21979-A,0
CA-22497-S,0
CA-22705-A,0
CA-23044-A,0
CA-25240-S,0
CA-25587-A,0
CA-26172-A,0
CA-27810-A,0
CA-29171-S,0
CA-29565-A,0
CA-30563-S,0
CA-30747-A,0
CA-31066-A,0
CA-31656-A,0
CA-34117-A,0
CA-34328-A,0
CA-35530-A,0
CA-36126-A,0
CA-37060-A,0
CA-37412-A,0
CA-38186-A,0
CA-38290-A,0
CA-38566-A,0
CA-39941-A,0
CA-41986-A,0
CA-42957-A,0
CA-43582-A,0
CA-43613-A,0
CA-43665-A,0
CA-44103-A,0
CA-44675-A,0
CA-45114-S,0
CA-45162-A,0
CA-46041-S,0
CA-46346-S,0
CA-46414-S,0
CA-46650-A,0
CA-47228-S,0
CA-47556-A,0
CA-47943-A,0
CA-48005-S,0
CA-50059-A,0
CA-51084-S,0
CA-51448-A,0
CA-53020-A,0
CA-53342-A,0
CA-53679-A,0
CA-54019-A,0
CA-56199-S,0
CA-57871-A,0
CA-58112-A,0
CA-59658-S,0
CA-62116-A,0
CA-63512-A,0
CA-64348-A,0
CA-64895-A,0
CA-64959-A,0
CA-65051-A,0
CA-65468-A,0
CA-66408-A,0
CA-67027-A,0
CA-67256-A,0
CA-68355-A,0
CA-68561-A,0
CA-69952-A,0
CA-69969-A,0
CA-70837-S,0
CA-71352-A,0
CA-72557-S,0
CA-73229-S,0
CA-73434-A,0
CA-73648-A,0
CA-75054-A,0
CA-75833-A,0
CA-75940-A,0
CA-76442-A,0
CA-77673-S,0
CA-78154-A,0
CA-78848-A,0
CA-80485-S,0
CA-81879-A,0
CA-82735-A,0
CA-83640-A,0
CA-84428-S,0
CA-84611-A,0
CA-85458-S,0
CA-87085-A,0
CA-87655-A,0
CA-88869-A,0
CA-89598-S,0
CA-90451-A,0
CA-90703-A,0
CA-91407-A,0
CA-91839-A,0
CA-92136-S,0
CA-92671-S,0
CA-93153-A,0
CA-93847-S,0
CA-94404-A,0
CA-94834-A,0
CA-95812-A,0
CA-96813-A,0
CA-97691-A,0
CA-97784-A,0
CA-98415-S,0
CA-98613-A,0
CA-98742-A,0
CA-99391-S,0
CA-99529-A,0
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,0
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,0
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,0
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,0
DK-11017-C,0
DK-11274-A,0
DK-11549-C,0
DK-13429-C,0
DK-14113-C,0
DK-15486-A,0
DK-15672-C,0
DK-16003-C,0
DK-16200-C,0
DK-16721-C,0
DK-17077-C,0
DK-17891-C,0
DK-18174-A,0
DK-18287-C,0
DK-18953-C,0
DK-19067-C,0
DK-20848-C,0
DK-21534-C,0
DK-21593-C,0
DK-24093-C,0
DK-24122-C,0
DK-24560-C,0
DK-24764-C,0
DK-25033-C,0
DK-26002-C,0
DK-28460-C,0
DK-30663-C,0
DK-31338-C,0
DK-32802-C,0
DK-32923-C,0
DK-32960-C,0
DK-33342-C,0
DK-33585-C,0
DK-34417-C,0
DK-34475-A,0
DK-34847-C,0
DK-3485-D0,0
DK-35287-A,0
DK-35387-A,0
DK-36818-C,0
DK-37723-C,0
DK-38288-C,0
DK-3889-D0,0
DK-40323-C,0
DK-42091-A,0
DK-44173-C,0
DK-45094-C,0
DK-46556-C,0
DK-47464-C,0
DK-48374-C,0
DK-48877-A,0
DK-49091-A,0
DK-49195-A,0
DK-49500-C,0
DK-49630-C,0
DK-50267-C,0
DK-50495-C,0
DK-50958-C,0
DK-51991-A,0
DK-54440-C,0
DK-57003-C,0
DK-57783-C,0
DK-58127-C,0
DK-58679-A,0
DK-59291-C,0
DK-59541-C,0
DK-61292-A,0
DK-

2025-01-19 03:16:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:16:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:16:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:16:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 03:16:25 - snowflake.connector.connection - INFO - closed
2025-01-19 03:16:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:17:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:17:22 - root - INFO - ```sql
SELECT
    p."publication_number",
    p."filing_date",
    ARRAY_SIZE(a."cited_by") AS num_forward_citations
FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
JOIN
    PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
ON
    p."publication_number" = a."publication_number"
ORDER BY
    num_forward_citations DESC
LIMIT 1;
```
2025-01-19 03:17:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:17:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:17:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:17:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:17:23 - snowflake.connector.connection - INFO - closed
2025-01-19 03:17:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:17:24 - root - INFO - SQL:
SELECT
    p."publication_number",
    p."filing_date",
    ARRAY_SIZE(a."cited_by") AS num_forward_citations
FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
JOIN
    PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
ON
    p."publication_number" = a."publication_number"
ORDER BY
    num_forward_citations DESC
LIMIT 1;
Results:
publication_number,filing_date,NUM_FORWARD_CITATIONS
US-2007046191-A1,20060811,2667

2025-01-19 03:17:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:17:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:17:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:17:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:17:26 - snowflake.connector.connection - INFO - closed
2025-01-19 03:17:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:17:26 - root - INFO - SQL:
-- 12. Select publication numbers and grant dates for patents with kind code 'B2' and country code 'US'
SELECT "publication_number", "grant_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "kind_code" = 'B2' AND "country_code" = 'US'
LIMIT 1000
Results:
Too long, hard cut:
publication_number,grant_date
US-6594862-B2,20030722
US-8395734-B2,20130312
US-7781260-B2,20100824
US-7197968-B2,20070403
US-6766870-B2,20040727
US-7518315-B2,20090414
US-7879487-B2,20110201
US-8229907-B2,20120724
US-8405269-B2,20130326
US-8423896-B2,20130416
US-8694822-B2,20140408
US-7717638-B2,20100518
US-9658993-B2,20170523
US-7432680-B2,20081007
US-8984416-B2,20150317
US-8520301-B2,20130827
US-8463797-B2,20130611
US-7173260-B2,20070206
US-7218306-B2,20070515
US-9322575-B2,20160426
US-8251903-B2,20120828
US-8011721-B2,20110906
US-7674988-B2,20100309
US-7890720-B2,20110215
US-7587611-B2,20090908
US-8555064-B2,20131008
US-9388108-B2,20160712
US-9005975-B2,20150414
US-7431883-B2,20081007
US-9384181-B2,20160705
US-7540698-B2,20090602
US-7118014-B2,20061010
US-9200008-B2,20151201
US-7715549-B2,20100511
US-6723201-B2,20040420
US-9293519-B2,20160322
US-9711737-B2,20170718
US-7130860-B2,20061031
US-9660655-B2,20170523
US-9624723-B2,20170418
US-9683466-B2,20170620
US-9186273-B2,20151117
US-9077131-B2,20150707
US-7868069-B2,20110111
US-9022857-B2,20150505
US-6906028-B2,20050614
US-6555432-B2,20030429
US-9224593-B2,20151229
US-6915077-B2,20050705
US-8908076-B2,20141209
US-9108579-B2,20150818
US-6590697-B2,20030708
US-7848876-B2,20101207
US-8229089-B2,20120724
US-8656944-B2,20140225
US-8174698-B2,20120508
US-7054128-B2,20060530
US-8071460-B2,20111206
US-9242288-B2,20160126
US-7894503-B2,20110222
US-6650779-B2,20031118
US-7341790-B2,20080311
US-7151395-B2,20061219
US-7051556-B2,20060530
US-7627407-B2,20091201
US-8531956-B2,20130910
US-9717416-B2,20170801
US-9079085-B2,20150714
US-8384812-B2,20130226
US-6865799-B2,20050315
US-7208289-B2,20070424
US-8685222-B2,20140401
US-9316252-B2,20160419
US-9647310-B2,20170509
US-8979283-B2,20150317
US-7859720-B2,20101228
US-8721568-B2,20140513
US-7923193-B2,20110412
US-7551218-B2,20090623
US-9095149-B2,20150804
US-8083000-B2,20111227
US-7693757-B2,20100406
US-9387868-B2,20160712
US-6655685-B2,20031202
US-8614090-B2,20131224
US-7532829-B2,20090512
US-7535127-B2,20090519
US-8356007-B2,20130115
US-7474706-B2,20090106
US-8866673-B2,20141021
US-9113475-B2,20150818
US-8920021-B2,20141230
US-8523131-B2,20130903
US-8981057-B2,20150317
US-7648250-B2,20100119
US-7880528-B2,20110201
US-8442540-B2,20130514
US-8197852-B2,20120612
US-9230189-B2,20160105
US-9224524-B2,20151229
US-9724574-B2,20170808
US-7750987-B2,20100706
US-9588141-B2,20170307
US-7711626-B2,20100504
US-9072123-B2,20150630
US-6809443-B2,20041026
US-8224960-B2,20120717
US-8963162-B2,20150224
US-9105604-B2,20150811
US-9484479-B2,20161101
US-6969040-B2,20051129
US-8467623-B2,20130618
US-7069677-B2,20060704
US-7504376-B2,20090317
US-7578867-B2,20090825
US-8920531-B2,20141230
US-7729242-B2,20100601
US-8032070-B2,20111004
US-9512383-B2,20161206
US-8295044-B2,20121023
US-8563297-B2,20131022
US-9497512-B2,20161115
US-8522638-B2,20130903
US-9254734-B2,20160209
US-8564570-B2,20131022
US-9052899-B2,20150609
US-7139800-B2,20061121
US-7059616-B2,20060613
US-9129081-B2,20150908
US-7869229-B2,20110111
US-9019344-B2,20150428
US-7766626-B2,20100803
US-7894970-B2,20110222
US-6870480-B2,20050322
US-9124456-B2,20150901
US-7921420-B2,20110405
US-7657683-B2,20100202
US-8039612-B2,20111018
US-9360734-B2,20160607
US-9313000-B2,20160412
US-8237168-B2,20120807
US-9366739-B2,20160614
US-8679858-B2,20140325
US-8240244-B2,20120814
US-9355325-B2,20160531
US-8611413-B2,20131217
US-9682365-B2,20170620
US-8293181-B2,20121023
US-9161130-B2,20151013
US-7591715-B2,20090922
US-7381205-B2,20080603
US-9138417-B2,20150922
US-6670606-B2,20031230
US-6881764-B2,20050419
US-6840585-B2,20050111
US-7032893-B2,20060425
US-8411927-B2,20130402
US-7463910-B2,20081209
US-6530865-B2,20030311
US-9654967-B2,20170516
US-8019092-B2,20110913
US-8941821-B2,20150127
US-8560450-B2,20131015
US-6864120-B2,20050308
US-8559021-B2,20131015
US-6982158-B2,20060103
US-7071989-B2,20060704
US-6537876-B2,20030325
US-8737709-B2,20140527
US-8177385-B2,20120515
US-9687557-B2,20170627
US-7378253-B2,20080527
US-7760001-B2,20100720
US-6814687-B2,20041109
US-7165933-B2,20070123
US-7941865-B2,20110510
US-8422031-B2,20130416
US-8925436-B2,20150106
US-9519080-B2,20161213
US-9173042-B2,20151027
US-6946024-B2,20050920
US-8921985-B2,20141230
US-6745148-B2,20040601
US-9320981-B2,20160426
US-9071009-B2,20150630
US-7005020-B2,20060228
US-9035405-B2,20150519
US-9089118-B2,20150728
US-7631669-B2,20091215
US-8876138-B2,20141104
US-6991728-B2,20060131
US-6434382-B2,20020813
US-7694767-B2,20100413
US-9591464-B2,20170307
US-9097401-B2,20150804
US-9100808-B2,20150804
US-7017231-B2,20060328
US-6579638-B2,20030617
US-7069159-B2,20060627
US-6853584-B2,20050208
US-6875977-B2,20050405
US-8925670-B2,20150106
US-9548125-B2,20170117
US-8244519-B2,20120814
US-6594725-B2,20030715
US-7325466-B2,20080205
US-6582228-B2,20030624
US-9563718-B2,20170207
US-9109382-B2,20150818
US-7902031-B2,20110308
US-7608693-B2,20091027
US-7464329-B2,20081209
US-8296413-B2,20121023
US-7970723-B2,20110628
US-7780352-B2,20100824
US-7658953-B2,20100209
US

2025-01-19 03:17:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:17:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:17:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:17:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 73
2025-01-19 03:17:30 - snowflake.connector.connection - INFO - closed
2025-01-19 03:17:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:17:30 - root - INFO - SQL:
-- 13. Select publication numbers and embeddings where embeddings are not null
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
WHERE "embedding_v1" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_v1
US-2951957-A,"[
  8.362335999999999e-02,
  -1.428828100000000e-01,
  -5.209156000000000e-03,
  -6.813269000000000e-02,
  -5.278470400000000e-02,
  -1.435878600000000e-01,
  5.047881000000000e-02,
  6.861719300000000e-04,
  2.224949900000000e-01,
  -8.987959000000000e-02,
  -4.084670500000000e-02,
  -1.282170400000000e-02,
  -1.603074800000000e-01,
  -1.031415800000000e-01,
  1.410270300000000e-01,
  -8.313097000000000e-02,
  2.386805700000000e-01,
  7.057566999999999e-02,
  -2.290654700000000e-02,
  9.825958000000000e-02,
  3.188707000000000e-03,
  -2.647633100000000e-02,
  -1.092003900000000e-01,
  -5.279829000000000e-02,
  -2.569500000000000e-02,
  -5.484348000000000e-02,
  2.931414200000000e-01,
  -5.625863000000000e-02,
  7.671317499999999e-02,
  -2.101696000000000e-02,
  -9.648903500000000e-02,
  2.814773800000000e-02,
  1.196730400000000e-01,
  -1.809715700000000e-02,
  5.101946000000000e-02,
  -1.260035600000000e-01,
  -4.599736300000000e-02,
  -1.099367140000000e-01,
  2.253598100000000e-01,
  1.840519200000000e-01,
  -2.293222200000000e-01,
  2.864085500000000e-02,
  1.707429800000000e-02,
  1.232229000000000e-01,
  1.622332800000000e-01,
  1.543603700000000e-01,
  -4.663030800000000e-02,
  1.824901800000000e-01,
  9.075740000000000e-02,
  -3.217364800000000e-01,
  -5.368751700000000e-02,
  -6.377889000000000e-03,
  -1.489741000000000e-01,
  1.935613900000000e-01,
  -7.129235000000000e-03,
  6.445281000000000e-02,
  -2.489995800000000e-01,
  -2.271947300000000e-02,
  -6.134887000000000e-02,
  1.986401000000000e-01,
  3.393093000000000e-02,
  1.078262100000000e-01,
  -1.761589300000000e-01,
  8.991186000000000e-02
]"
US-4897035-A,"[
  3.940709000000000e-02,
  -2.597278200000000e-02,
  -6.800645000000000e-02,
  -2.881745000000000e-01,
  4.827634000000000e-02,
  -6.236814000000000e-04,
  -2.521992000000000e-02,
  -1.599087600000000e-02,
  4.216611800000000e-02,
  -3.821041400000000e-02,
  1.730927200000000e-01,
  -3.798891600000000e-02,
  1.830829000000000e-01,
  7.517589000000000e-02,
  8.099699000000000e-03,
  1.149717100000000e-01,
  1.722225800000000e-01,
  -1.944074000000000e-02,
  -1.152504000000000e-01,
  -1.621994400000000e-01,
  -1.620336000000000e-01,
  -1.014300900000000e-01,
  -9.175859000000000e-02,
  3.969524000000000e-02,
  -2.761362500000000e-01,
  -1.333980300000000e-01,
  -1.668396400000000e-02,
  1.957727200000000e-01,
  1.239102800000000e-02,
  -1.144100500000000e-02,
  1.131469300000000e-01,
  -1.321501300000000e-01,
  -4.336641000000000e-02,
  -1.311177600000000e-01,
  -1.619727600000000e-01,
  -1.946237000000000e-01,
  1.297715500000000e-01,
  -7.682512000000000e-02,
  8.311364999999999e-03,
  2.755730000000000e-02,
  -1.120370100000000e-02,
  -9.150763600000000e-02,
  1.413144200000000e-01,
  -1.402106000000000e-01,
  1.395930500000000e-01,
  3.988200000000000e-02,
  6.982776500000000e-02,
  -2.444522300000000e-02,
  1.771123700000000e-01,
  -1.097915300000000e-01,
  -9.719206399999999e-02,
  -2.927858200000000e-02,
  1.482062300000000e-01,
  1.132943260000000e-01,
  -2.464319200000000e-01,
  -1.034510660000000e-01,
  -2.769150200000000e-02,
  -1.443465000000000e-01,
  -1.429210200000000e-01,
  3.029047900000000e-02,
  -2.345570200000000e-01,
  1.843463200000000e-01,
  -2.501799000000000e-01,
  6.695028000000000e-02
]"
US-5832509-A,"[
  8.716943000000001e-02,
  -6.795622400000000e-02,
  -1.447544200000000e-01,
  -4.215143600000000e-02,
  3.562337500000000e-02,
  -4.434270400000000e-02,
  9.165478500000000e-02,
  -1.708218000000000e-02,
  3.506425300000000e-01,
  3.633461500000000e-02,
  8.391910000000000e-02,
  1.031111900000000e-01,
  -3.371140700000000e-02,
  2.321766700000000e-02,
  2.394382000000000e-03,
  -9.655345999999999e-02,
  -4.717555000000000e-02,
  1.349720800000000e-01,
  -1.789933300000000e-02,
  1.247093200000000e-01,
  4.784599000000000e-02,
  1.001340800000000e-02,
  -4.928872500000000e-03,
  -7.338276500000000e-02,
  -5.507919000000000e-02,
  1.026705700000000e-01,
  1.393821100000000e-01,
  1.276103600000000e-01,
  9.779023000000001e-02,
  -7.936486600000001e-02,
  -8.535474000000000e-02,
  8.279648400000000e-02,
  -1.261513700000000e-01,
  7.045916300000000e-03,
  -1.357231700000000e-01,
  -2.007939000000000e-01,
  3.253786600000000e-02,
  -2.664299500000000e-02,
  2.653538600000000e-01,
  4.831082700000000e-02,
  -8.429014000000000e-02,
  -5.002477000000000e-02,
  2.030032600000000e-01,
  9.217891000000000e-02,
  8.634042000000000e-03,
  9.044094000000000e-02,
  9.375375499999999e-02,
  -3.200432000000000e-02,
  1.610973100000000e-02,
  5.450559000000000e-03,
  -3.384401000000000e-01,
  2.149827200000000e-01,
  2.593768500000000e-01,
  2.543867000000000e-02,
  -1.129539760000000e-01,
  1.078855500000000e-02,
  2.471758900000000e-01,
  2.002329200000000e-02,
  -1.504945800000000e-01,
  1.058296600000000e-01,
  -1.340331500000000e-02,
  1.870675100000000e-01,
  -2.313979600000000e-01,
  1.557590400000000e-01
]"
US-4560189-A,"[

2025-01-19 03:17:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:17:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:17:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:17:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 03:17:32 - snowflake.connector.connection - INFO - closed
2025-01-19 03:17:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:17:33 - root - INFO - SQL:
-- 14. Select sample embeddings for analysis
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 

2025-01-19 03:17:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:17:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:17:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:17:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:17:34 - snowflake.connector.connection - INFO - closed
2025-01-19 03:17:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:17:35 - root - INFO - SQL:
-- 15. Select publication numbers and the size of 'embedding_v1' array
SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_length"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_length
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,64
DK-

2025-01-19 03:17:35 - root - INFO - itercount: 0
2025-01-19 03:17:35 - root - INFO - Database Name: PATENTS_GOOGLE
Schema Name: PATENTS_GOOGLE
DDL describes table information.
,0
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

,1
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,2
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""description_localized"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""citation"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,3
table_name,ABS_AND_EMB
description,
DDL,"create or replace TABLE ABS_AND_EMB (
	""publication_number"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""title_translated"" BOOLEAN,
	""abstract"" VARCHAR(16777216),
	""abstract_translated"" BOOLEAN,
	""cpc"" VARIANT,
	""cpc_low"" VARIANT,
	""cpc_inventive_low"" VARIANT,
	""top_terms"" VARIANT,
	""similar"" VARIANT,
	""url"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""publication_description"" VARCHAR(16777216),
	""cited_by"" VARIANT,
	""embedding_v1"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
```
Columns and potential usage:

From PUBLICATIONS:
- "publication_number": To identify patents.
- "country_code": To filter for United States patents ("US").
- "kind_code": To select utility patents under the B2 classification ("B2").
- "grant_date": To select patents granted between 2010 and 2014.
- "filing_date": To determine filing dates for time calculations.

From ABS_AND_EMB:
- "publication_number": To identify patents.
- "country": To filter for United States patents ("US").
- "embedding_v1": To obtain embedding vectors for similarity calculations.
- "cited_by": To get forward citations of a patent.

Conditions that may be used:
- "country_code" = 'US' (in PUBLICATIONS)
- "country" = 'US' (in ABS_AND_EMB)
- "kind_code" = 'B2'
- "grant_date" BETWEEN 20100101 AND 20141231
```

```sql
-- 1. Select distinct country codes from PUBLICATIONS
SELECT DISTINCT "country_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000;

-- 2. Select distinct kind codes from PUBLICATIONS
SELECT DISTINCT "kind_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000;

-- 3. Select publication numbers and grant dates for patents granted between 2010 and 2014
SELECT "publication_number", "grant_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "grant_date" BETWEEN 20100101 AND 20141231
LIMIT 1000;

-- 4. Select publication numbers and kind codes where kind code is 'B2'
SELECT "publication_number", "kind_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "kind_code" = 'B2'
LIMIT 1000;

-- 5. Select publication numbers and country codes where country code is 'US'
SELECT "publication_number", "country_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
LIMIT 1000;

-- 6. Select publication numbers and filing dates where filing date is not null
SELECT "publication_number", "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "filing_date" IS NOT NULL
LIMIT 1000;

-- 7. Select publication numbers and countries from ABS_AND_EMB
SELECT "publication_number", "country"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;

-- 8. Select publication numbers and embeddings from ABS_AND_EMB
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;

-- 9. Inspect the structure of the 'cited_by' column in ABS_AND_EMB
SELECT t."publication_number", f.value AS "citing_publication_number"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
LATERAL FLATTEN(input => t."cited_by") f
LIMIT 1000;

-- 10. Select publication numbers and the count of forward citations from ABS_AND_EMB
SELECT "publication_number", ARRAY_SIZE("cited_by") AS "num_forward_citations"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;

-- 11. Select publication numbers and titles where country is 'US' from ABS_AND_EMB
SELECT "publication_number", "title"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
WHERE "country" = 'US'
LIMIT 1000;

-- 12. Select publication numbers and grant dates for patents with kind code 'B2' and country code 'US'
SELECT "publication_number", "grant_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "kind_code" = 'B2' AND "country_code" = 'US'
LIMIT 1000;

-- 13. Select publication numbers and embeddings where embeddings are not null
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
WHERE "embedding_v1" IS NOT NULL
LIMIT 1000;

-- 14. Select sample embeddings for analysis
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;

-- 15. Select publication numbers and the size of 'embedding_v1' array
SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_length"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;
```Query:
-- 1. Select distinct country codes from PUBLICATIONS
SELECT DISTINCT "country_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Answer:
country_code
JP
GB
BE
FI
DK
WO
EP
LU
CA
NL
RU
KR
US
DE
ES
CN
FR
Query:
-- 2. Select distinct kind codes from PUBLICATIONS
SELECT DISTINCT "kind_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Answer:
kind_code
B1
S
D2
U8
H
C1
T0
A5
Y2
T2
C9
U4
P1
R2
V0
B8
F
R1
L
A0
B9
E1
C3
A7
K4
Z1
A1
T3
H1
T7
A4
T5
A8
I5
I2
B
Y1
K1
R
A
B3
T4
P
T8
U0
T1
Y4
A2
I4
Y
T9
I1
U9
P2
P3
D1
C2
B4
C5
H3
A3
K5
U1
A6
C
U
S1
U3
M
T
B2
A9
D0
E
Query:
-- 3. Select publication numbers and grant dates for patents granted between 2010 and 2014
SELECT "publication_number", "grant_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "grant_date" BETWEEN 20100101 AND 20141231
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,grant_date
US-8018125-B2,20110913
CN-101677236-B,20130213
CN-102221403-B,20130109
JP-4523317-B2,20100811
RU-2507287-C1,20140220
CN-102350882-B,20131113
KR-101146405-B1,20120517
CN-101732051-B,20111228
US-8297434-B2,20121030
CN-101160889-B,20110427
CN-101533632-B,20120725
US-7642037-B2,20100105
CN-101366149-B,20130306
CN-102257368-B,20130306
KR-101281684-B1,20130705
CN-203336222-U,20131211
US-7859134-B2,20101228
CN-203737902-U,20140730
US-8039891-B2,20111018
KR-101258912-B1,20130430
US-8224596-B2,20120717
CN-102443425-B,20140402
CN-101505919-B,20110608
CN-101893789-B,20120829
US-8330621-B2,20121211
US-8167101-B2,20120501
US-8702088-B2,20140422
US-8108347-B2,20120131
KR-101321554-B1,20131022
KR-101239020-B1,20130304
CN-101884112-B,20120905
KR-101249166-B1,20130401
RU-2471117-C1,20121227
US-7938000-B2,20110510
KR-100948793-B1,20100324
CN-101772484-B,20130918
DE-202010003013-U1,20110809
RU-2516333-C2,20140520
CN-101963389-B,20120822
US-7751638-B1,20100706
KR-101103662-B1,20120111
CN-101753094-B,20120620
CN-101808060-B,20121205
KR-101140245-B1,20120515
CN-102202977-B,20141022
CN-102656572-B,20141203
US-8109016-B2,20120207
CN-101785640-B,20140730
CN-101115214-B,20110420
US-7995810-B2,20110809
US-8260772-B2,20120904
US-8102623-B2,20120124
US-7913963-B2,20110329
US-7823930-B2,20101102
CN-204066732-U,20141231
US-8582104-B2,20131112
RU-2505352-C1,20140127
CN-101600477-B,20120125
CN-101298726-B,20110727
CN-101753530-B,20120704
RU-2452368-C2,20120610
RU-2479431-C2,20130420
KR-101016825-B1,20110221
CN-101431492-B,20110525
RU-2388467-C2,20100510
CN-101977740-B,20130501
ES-2333277-T3,20100218
JP-5243906-B2,20130724
US-8908679-B2,20141209
DE-202012010311-U1,20121129
JP-4799283-B2,20111026
CN-202324442-U,20120711
CN-203795264-U,20140827
US-7960413-B2,20110614
US-7704877-B2,20100427
JP-5487331-B1,20140507
JP-4405907-B2,20100127
JP-5367651-B2,20131211
KR-101165755-B1,20120718
CA-150285-S,20140514
EP-1897467-B1,20100317
EP-2032364-B1,20110119
EP-1043858-B1,20110817
US-D659890-S,20120515
JP-4902427-B2,20120321
JP-4805213-B2,20111102
JP-5287051-B2,20130911
CN-102375433-B,20130821
CN-203670027-U,20140625
CN-201729641-U,20110202
CA-2611991-C,20140325
CA-2612759-C,20140121
CN-201557964-U,20100825
CN-102531489-B,20130918
CN-202606183-U,20121219
CN-202892211-U,20130424
CN-203322964-U,20131204
JP-5109415-B2,20121226
CN-204046263-U,20141224
CN-203220495-U,20131002
CN-202508119-U,20121031
CN-203869096-U,20141008
ES-2351940-T3,20110214
CN-101364543-B,20110420
CN-202511065-U,20121031
CN-202777070-U,20130313
JP-5614830-B2,20141029
CN-202428800-U,20120912
CN-203512410-U,20140402
GB-201410750-D0,20140730
CN-202193148-U,20120418
CN-202607290-U,20121219
CN-202607049-U,20121219
EP-1547681-B1,20131009
EP-2406190-B1,20130403
CN-201533905-U,20100728
EP-1357378-B1,20130424
CN-202210037-U,20120502
JP-5419524-B2,20140219
CN-203300604-U,20131120
JP-5468921-B2,20140409
CN-201393954-Y,20100203
CN-202170911-U,20120321
CN-203801641-U,20140903
GB-201007731-D0,20100623
JP-5050909-B2,20121017
JP-5131922-B2,20130130
CN-201849116-U,20110601
CN-102074409-B,20110921
CN-202473583-U,20121003
CN-203726106-U,20140723
CN-203827968-U,20140917
EP-2174819-B1,20120516
CN-201423700-Y,20100317
CN-203421770-U,20140205
US-7727473-B2,20100601
US-8425821-B2,20130423
US-D613747-S,20100413
FR-2979364-B1,20140718
JP-4944847-B2,20120606
CN-203449360-U,20140226
CN-203905888-U,20141029
DE-602004031872-D1,20110428
CN-202147027-U,20120222
CN-203077788-U,20130724
CN-203319995-U,20131204
US-7885444-B2,20110208
US-8771847-B2,20140708
US-8403121-B2,20130326
JP-4604714-B2,20110105
RU-2417621-C2,20110510
EP-2215338-B1,20140611
JP-5265712-B2,20130814
CN-202404318-U,20120829
EP-2031831-B1,20121003
EP-2591243-B1,20140702
RU-137026-U1,20140127
JP-4996061-B2,20120808
EP-1858433-B1,20120829
CN-202522907-U,20121107
CN-203853051-U,20141001
CN-204025888-U,20141217
DE-602006012692-D1,20100415
CN-101614473-B,20110406
CN-202082057-U,20111221
EP-1882702-B1,20100303
CN-202232751-U,20120530
CN-202875621-U,20130417
DE-60330265-D1,20100107
JP-5262286-B2,20130814
CN-202145559-U,20120215
CA-2532913-C,20120731
CN-201753784-U,20110302
CN-202792826-U,20130313
CN-201845688-U,20110525
CN-202485452-U,20121010
JP-4535358-B2,20100901
JP-5641286-B2,20141217
CN-203910701-U,20141029
CN-204067456-U,20141231
JP-5519435-B2,20140611
CN-201648388-U,20101124
JP-4971129-B2,20120711
JP-5600140-B2,20141001
JP-4953920-B2,20120613
CN-203641849-U,20140611
CN-201547566-U,20100811
CN-201489841-U,20100526
US-8400024-B2,20130319
CA-2458138-C,20121009
JP-5032692-B1,20120926
JP-5571073-B2,20140813
US-8877381-B2,20141104
US-8499967-B2,20130806
JP-5134515-B2,20130130
JP-4831526-B2,20111207
CN-201868153-U,20110615
CN-202992920-U,20130612
US-7982267-B2,20110719
KR-100978408-B1,20100826
EP-1029928-B1,20100721
JP-5355841-B2,20131127
KR-101231527-B1,20130207
JP-4908506-B2,20120404
US-8004671-B2,20110823
US-8150897-B2,20120403
CN-203814396-U,20140910
CN-203961659-U,20141126
JP-4510797-B2,20100728
RU-2380712-C1,20100127
CN-2040
Query:
-- 4. Select publication numbers and kind codes where kind code is 'B2'
SELECT "publication_number", "kind_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "kind_code" = 'B2'
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,kind_code
US-6594862-B2,B2
US-8395734-B2,B2
US-7781260-B2,B2
JP-4565593-B2,B2
JP-4813799-B2,B2
US-7197968-B2,B2
US-6766870-B2,B2
JP-4719627-B2,B2
US-7518315-B2,B2
US-7879487-B2,B2
US-8229907-B2,B2
US-8405269-B2,B2
US-8423896-B2,B2
US-8694822-B2,B2
JP-H0625495-B2,B2
US-7717638-B2,B2
US-9658993-B2,B2
US-7432680-B2,B2
US-8984416-B2,B2
JP-5036281-B2,B2
JP-3289126-B2,B2
JP-3561612-B2,B2
JP-3742545-B2,B2
JP-5065641-B2,B2
JP-H0585322-B2,B2
JP-6072843-B2,B2
JP-4351557-B2,B2
JP-5008058-B2,B2
JP-5439596-B2,B2
US-9558401-B2,B2
JP-3737523-B2,B2
JP-H0779562-B2,B2
DE-2446227-B2,B2
JP-5551640-B2,B2
JP-6127609-B2,B2
JP-3605011-B2,B2
JP-5914227-B2,B2
JP-5823463-B2,B2
JP-H0824432-B2,B2
JP-S5836136-B2,B2
US-8593015-B2,B2
US-6908096-B2,B2
US-7137747-B2,B2
US-8127992-B2,B2
JP-S5838878-B2,B2
US-8290010-B2,B2
US-6708776-B2,B2
JP-H0473349-B2,B2
US-7057340-B2,B2
US-7498861-B2,B2
US-9473501-B2,B2
JP-2837361-B2,B2
US-9086293-B2,B2
US-7643385-B2,B2
US-8456858-B2,B2
US-7066032-B2,B2
JP-2697479-B2,B2
US-8153074-B2,B2
US-9333719-B2,B2
US-8919830-B2,B2
US-9743211-B2,B2
US-6917653-B2,B2
US-7939921-B2,B2
US-6666152-B2,B2
US-6914921-B2,B2
US-6817384-B2,B2
US-7421051-B2,B2
US-8777490-B2,B2
US-9160846-B2,B2
JP-S633988-B2,B2
US-8216528-B2,B2
US-8373784-B2,B2
US-7695394-B2,B2
US-8166308-B2,B2
US-8505748-B2,B2
JP-3234711-B2,B2
US-8932580-B2,B2
US-8522458-B2,B2
US-9053990-B2,B2
US-6888054-B2,B2
JP-4597740-B2,B2
US-9351680-B2,B2
US-8965717-B2,B2
US-6575894-B2,B2
US-7360059-B2,B2
US-7703738-B2,B2
US-7113713-B2,B2
US-8423568-B2,B2
US-8553286-B2,B2
US-9326023-B2,B2
US-8173931-B2,B2
JP-4485842-B2,B2
US-9152509-B2,B2
US-9344066-B2,B2
US-8547754-B2,B2
US-7992681-B2,B2
US-9139321-B2,B2
US-8296622-B2,B2
US-7108617-B2,B2
US-9623324-B2,B2
US-8702289-B2,B2
US-8036024-B2,B2
US-8770567-B2,B2
US-6335590-B2,B2
US-7753494-B2,B2
US-9231312-B2,B2
US-7112652-B2,B2
US-8632084-B2,B2
JP-4866116-B2,B2
JP-6145545-B2,B2
US-9054177-B2,B2
JP-2704264-B2,B2
JP-3886824-B2,B2
JP-4867002-B2,B2
JP-6107081-B2,B2
JP-4676500-B2,B2
US-7923105-B2,B2
US-8335430-B2,B2
JP-5401090-B2,B2
JP-3206823-B2,B2
JP-2541012-B2,B2
JP-5565832-B2,B2
JP-6067127-B2,B2
JP-5453194-B2,B2
JP-3007301-B2,B2
JP-S5236393-B2,B2
JP-3506173-B2,B2
JP-S5741871-B2,B2
JP-S6251408-B2,B2
JP-2813048-B2,B2
JP-S6051741-B2,B2
JP-H0687104-B2,B2
JP-3049791-B2,B2
JP-2548641-B2,B2
JP-2630209-B2,B2
JP-2956544-B2,B2
JP-5816120-B2,B2
JP-3418717-B2,B2
JP-5099247-B2,B2
JP-H0636475-B2,B2
JP-4194791-B2,B2
JP-4113539-B2,B2
JP-H0774002-B2,B2
JP-5309914-B2,B2
JP-5001554-B2,B2
JP-H0768619-B2,B2
US-8735738-B2,B2
JP-3370339-B2,B2
US-9694234-B2,B2
US-7913538-B2,B2
US-8108683-B2,B2
US-8407406-B2,B2
US-8453236-B2,B2
US-9326904-B2,B2
US-8937584-B2,B2
US-6516621-B2,B2
US-8160008-B2,B2
US-7845489-B2,B2
JP-H0138031-B2,B2
US-9510605-B2,B2
JP-3019915-B2,B2
US-7792790-B2,B2
US-6588095-B2,B2
US-9424300-B2,B2
US-8209044-B2,B2
US-8632085-B2,B2
US-6827891-B2,B2
US-8753277-B2,B2
JP-4700305-B2,B2
US-9319581-B2,B2
US-7854729-B2,B2
US-8234525-B2,B2
US-7225471-B2,B2
US-8797370-B2,B2
US-9180598-B2,B2
US-9085831-B2,B2
US-7057966-B2,B2
US-8573251-B2,B2
US-9564307-B2,B2
JP-4672714-B2,B2
US-9539539-B2,B2
US-7570911-B2,B2
US-8561216-B2,B2
JP-4764888-B2,B2
US-9720238-B2,B2
US-8118210-B2,B2
US-7951389-B2,B2
US-6842614-B2,B2
US-9207311-B2,B2
US-9248944-B2,B2
US-7562889-B2,B2
US-9002995-B2,B2
US-8395592-B2,B2
US-7933540-B2,B2
US-7543608-B2,B2
US-6862124-B2,B2
US-7815667-B2,B2
US-6595516-B2,B2
US-7640341-B2,B2
JP-H0140002-B2,B2
JP-5234226-B2,B2
JP-S5724543-B2,B2
JP-2543119-B2,B2
JP-S6230126-B2,B2
JP-4649309-B2,B2
JP-S5641110-B2,B2
US-8150333-B2,B2
US-9534636-B2,B2
US-8521803-B2,B2
US-7724258-B2,B2
US-8705060-B2,B2
US-7588957-B2,B2
US-9213606-B2,B2
US-8141480-B2,B2
US-8460785-B2,B2
JP-H057427-B2,B2
US-8354967-B2,B2
US-9107671-B2,B2
US-7272949-B2,B2
JP-H0522270-B2,B2
US-8221179-B2,B2
US-6994534-B2,B2
US-9611232-B2,B2
JP-H0369560-B2,B2
US-7151424-B2,B2
US-9392914-B2,B2
JP-S6244046-B2,B2
US-9683702-B2,B2
US-8352094-B2,B2
US-7002780-B2,B2
JP-6062052-B2,B2
US-8520301-B2,B2
US-8463797-B2,B2
US-7173260-B2,B2
US-7218306-B2,B2
JP-4622665-B2,B2
US-9322575-B2,B2
US-8251903-B2,B2
US-8011721-B2,B2
JP-3203231-B2,B2
JP-S6260989-B2,B2
JP-4496124-B2,B2
JP-4676540-B2,B2
US-7674988-B2,B2
US-7890720-B2,B2
US-7587611-B2,B2
US-8555064-B2,B2
US-9388108-B2,B2
JP-S5827857-B2,B2
JP-S6352211-B2,B2
US-9005975-B2,B2
US-7811452-B2,B2
US-9733126-B2,B2
US-8660712-B2,B2
US-8723563-B2,B2
US-9589942-B2,B2
US-7533243-B2,B2
US-9558040-B2,B2
US-7318140-B2,B2
US-7813102-B2,B2
US-7136766-B2,B2
US-7673942-B2,B2
US-8488198-B2,B2
JP-4528090-B2,B2
US-9321589-B2,B2
US-7258828-B2,B2
JP-S5922784-B2,B2
US-8941934-B2,B2
US-6720711-B2,B2
US-8777123-B2,B2
US-9100676-B2,B2
US-9128197-B2,B2
JP-5359876-B2,B2
US-9318799-B2,B2
US-7547705-B2,B2
JP-S5120640-B2,B2
JP-2766264-B2,B2
JP-3651581-B2,B2
JP-5401096-B2,B2
DE-2020823-B2,B2
JP-3546614-B2,B2
JP-4021937-B2,B2
JP-H0778203-B2,B2
JP-5690082-B2,B2
DE-2362377-B2,B2
DE-2422895-B2,B2
JP-4074010-B2,B2
DE-2651848-B2,B2
JP-H0635817-B2,B2
JP-S5617024-B2,B2
US-8495918
Query:
-- 5. Select publication numbers and country codes where country code is 'US'
SELECT "publication_number", "country_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,country_code
US-4314796-A,US
US-7255124-B2,US
US-5356642-A,US
US-2593956-A,US
US-5189263-A,US
US-4064751-A,US
US-2014308545-A1,US
US-2009302562-A1,US
US-3130704-A,US
US-8503036-B2,US
US-3904467-A,US
US-4403287-A,US
US-3949207-A,US
US-3632254-A,US
US-8178184-B2,US
US-3239383-A,US
US-7274413-B1,US
US-5442064-A,US
US-5365487-A,US
US-6946026-B2,US
US-5863294-A,US
US-6326774-B1,US
US-4744173-A,US
US-5605992-A,US
US-2961970-A,US
US-5127771-A,US
US-4359891-A,US
US-5593482-A,US
US-6924955-B2,US
US-5733019-A,US
US-5038405-A,US
US-4753095-A,US
US-8879934-B2,US
US-3129884-A,US
US-8547039-B2,US
US-4003678-A,US
US-4666475-A,US
US-5788562-A,US
US-3419727-A,US
US-3103783-A,US
US-8802933-B2,US
US-4069179-A,US
US-3673753-A,US
US-5269439-A,US
US-4571258-A,US
US-4069530-A,US
US-4123665-A,US
US-6903210-B2,US
US-6788828-B2,US
US-8103295-B2,US
US-2007201436-A1,US
US-9407145-B1,US
US-7581880-B2,US
US-2008196881-A1,US
US-9614020-B2,US
US-8673549-B2,US
US-2003094317-A1,US
US-2008281992-A1,US
US-2016354748-A1,US
US-2017013888-A1,US
US-2017072311-A1,US
US-2014153051-A1,US
US-2013328242-A1,US
US-2010089921-A1,US
US-2013252459-A1,US
US-6288085-B1,US
US-2012161609-A1,US
US-2014042836-A1,US
US-2016014835-A1,US
US-2012148910-A1,US
US-2016254790-A1,US
US-D532151-S,US
US-2007009740-A1,US
US-2014316902-A1,US
US-2006274700-A1,US
US-2011120677-A1,US
US-2010152081-A1,US
US-2010134029-A1,US
US-2810136-A,US
US-2003008654-A9,US
US-2010058869-A1,US
US-2004120148-A1,US
US-2006271029-A1,US
US-2011266680-A1,US
US-2011181508-A1,US
US-2009067478-A1,US
US-2014062501-A1,US
US-7495178-B2,US
US-7690976-B2,US
US-4045115-A,US
US-2008258975-A1,US
US-2002042744-A1,US
US-6743873-B2,US
US-8142536-B2,US
US-2016267729-A1,US
US-2008192815-A1,US
US-2012312924-A1,US
US-6594862-B2,US
US-2008051656-A1,US
US-4859461-A,US
US-3162925-A,US
US-7136374-B1,US
US-9451715-B1,US
US-2680954-A,US
US-2014297747-A1,US
US-9517269-B1,US
US-2003127734-A1,US
US-2013312230-A1,US
US-5925071-A,US
US-3965956-A,US
US-8395734-B2,US
US-7781260-B2,US
US-5006347-A,US
US-5585084-A,US
US-4310627-A,US
US-3990787-A,US
US-4748887-A,US
US-4395601-A,US
US-4525140-A,US
US-5552785-A,US
US-6157871-A,US
US-D468550-S,US
US-2007013729-A1,US
US-2013309431-A1,US
US-2016375553-A1,US
US-2010037801-A1,US
US-2008279111-A1,US
US-6757087-B1,US
US-7197968-B2,US
US-6766870-B2,US
US-2016059789-A1,US
US-2003174075-A1,US
US-2010011146-A1,US
US-2004239394-A1,US
US-2014139812-A1,US
US-2009121086-A1,US
US-2009017283-A1,US
US-2016106445-A1,US
US-2013304676-A1,US
US-2007072657-A1,US
US-2009096419-A1,US
US-3501538-A,US
US-3611242-A,US
US-2013041104-A1,US
US-2009284106-A1,US
US-2010102963-A1,US
US-2011240441-A1,US
US-2009267887-A1,US
US-2002047271-A1,US
US-2004148945-A1,US
US-7518315-B2,US
US-7879487-B2,US
US-8229907-B2,US
US-2009253069-A1,US
US-8405269-B2,US
US-2002002062-A1,US
US-2002141706-A1,US
US-2009119833-A1,US
US-8423896-B2,US
US-2009257082-A1,US
US-6621008-B1,US
US-8694822-B2,US
US-2013066852-A1,US
US-2011052637-A1,US
US-2010025510-A1,US
US-2016351058-A1,US
US-7717638-B2,US
US-3845538-A,US
US-4361892-A,US
US-3763318-A,US
US-2008318205-A1,US
US-2006013739-A1,US
US-9658993-B2,US
US-7432680-B2,US
US-8984416-B2,US
US-6112004-A,US
US-5171340-A,US
US-6089978-A,US
US-6974995-B1,US
US-7900566-B1,US
US-3427959-A,US
US-4832354-A,US
US-2008128430-A1,US
US-1702956-A,US
US-D450923-S,US
US-1380529-A,US
US-9558401-B2,US
US-26512-A,US
US-2002141229-A1,US
US-2040388-A,US
US-2004176590-A1,US
US-1464489-A,US
US-168574-A,US
US-2002152358-A1,US
US-2015281053-A1,US
US-6335590-B2,US
US-D720261-S,US
US-8145812-B1,US
US-7753494-B2,US
US-8857442-B1,US
US-9231312-B2,US
US-7112652-B2,US
US-8632084-B2,US
US-1913107-A,US
US-2012177138-A1,US
US-553727-A,US
US-D244732-S,US
US-9054177-B2,US
US-1268890-A,US
US-2012122213-A1,US
US-2014091605-A1,US
US-7923105-B2,US
US-8335430-B2,US
US-2014267822-A1,US
US-1600561-A,US
US-2001010400-A1,US
US-308737-A,US
US-243561-A,US
US-1582755-A,US
US-2010055664-A1,US
US-1126474-A,US
US-711962-A,US
US-1207490-A,US
US-690812-A,US
US-1197291-A,US
US-8702-A,US
US-1703379-A,US
US-670398-A,US
US-1058309-A,US
US-196436-A,US
US-2002047753-A1,US
US-1564322-A,US
US-7811452-B2,US
US-9733126-B2,US
US-2002115116-A1,US
US-2004052009-A1,US
US-2002061505-A1,US
US-8660712-B2,US
US-2008272692-A1,US
US-2005025813-A1,US
US-2013064650-A1,US
US-8723563-B2,US
US-2008189482-A1,US
US-2013017093-A1,US
US-2013274292-A1,US
US-2015304568-A1,US
US-9589942-B2,US
US-7533243-B2,US
US-9558040-B2,US
US-2006163234-A1,US
US-2004043342-A1,US
US-2017085455-A1,US
US-7318140-B2,US
US-2013079924-A1,US
US-2006291891-A1,US
US-2631212-A,US
US-7813102-B2,US
US-7136766-B2,US
US-2016154938-A1,US
US-7673942-B2,US
US-4229080-A,US
US-2015194281-A1,US
US-2012324816-A1,US
US-2011015934-A1,US
US-2015322185-A1,US
US-8488198-B2,US
US-2643977-A,US
US-5593044-A,US
US-3955812-A,US
US-3739896-A,US
US-7119852-B1,US
US-5438267-A,US
US-2008099571-A1,US
US-3751825-A,US
US-4605176-A,US
US-2743280-A,US
US-5070536-A,US
US-2501225-A,US
US-9321589-B2,US
US-4909676-A,US

Query:
-- 6. Select publication numbers and filing dates where filing date is not null
SELECT "publication_number", "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "filing_date" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-
Query:
-- 7. Select publication numbers and countries from ABS_AND_EMB
SELECT "publication_number", "country"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,country
CA-27-A,CANADA
ES-81-Y,SPAIN
DE-303-C,FEDERAL REPUBLIC GERMANY
ES-866-Y,SPAIN
FI-150-A,FINLAND
FI-250-A,FINLAND
FR-336-E,FRANCE
NL-284-C,NETHERLANDS
NL-947-C,NETHERLANDS
BE-107-T1,BELGIUM
CA-1911-A,CANADA
CA-4005-A,CANADA
CA-4106-A,CANADA
CA-4698-A,CANADA
CA-4801-A,CANADA
CA-5943-A,CANADA
CA-6183-A,CANADA
CA-6207-A,CANADA
CA-6390-A,CANADA
CA-6969-A,CANADA
CA-8931-S,CANADA
CA-9897-A,CANADA
DE-3129-C,FEDERAL REPUBLIC GERMANY
DE-3301-C,FEDERAL REPUBLIC GERMANY
DE-3884-C,FEDERAL REPUBLIC GERMANY
DE-3983-C,FEDERAL REPUBLIC GERMANY
DE-5976-C,FEDERAL REPUBLIC GERMANY
DK-2807-C,DENMARK
DK-3080-C,DENMARK
DK-3107-C,DENMARK
DK-3184-C,DENMARK
DK-3510-C,DENMARK
DK-5867-C,DENMARK
DK-5921-C,DENMARK
DK-6491-A,DENMARK
DK-7210-C,DENMARK
DK-8069-C,DENMARK
DK-8466-C,DENMARK
DK-9281-C,DENMARK
DK-9359-C,DENMARK
ES-1062-U,SPAIN
ES-1498-U,SPAIN
ES-1524-Y,SPAIN
ES-1872-U,SPAIN
ES-2542-Y,SPAIN
ES-2819-Y,SPAIN
ES-2960-U,SPAIN
ES-3045-U,SPAIN
ES-4483-Y,SPAIN
ES-4723-Y,SPAIN
ES-4858-U,SPAIN
ES-5089-Y,SPAIN
ES-5219-Y,SPAIN
ES-5716-U,SPAIN
ES-5975-Y,SPAIN
ES-6454-U,SPAIN
ES-6552-Y,SPAIN
ES-6928-Y,SPAIN
ES-6962-Y,SPAIN
ES-7086-Y,SPAIN
ES-7407-Y,SPAIN
ES-7489-Y,SPAIN
ES-7516-U,SPAIN
ES-7538-U,SPAIN
ES-764-H3,SPAIN
ES-8269-Y,SPAIN
FI-1825-A,FINLAND
FI-291-U1,FINLAND
FI-3021-A,FINLAND
FI-4211-A,FINLAND
FI-4543-A,FINLAND
FI-8034-A,FINLAND
FI-8619-A,FINLAND
FI-8985-A,FINLAND
FI-902-U1,FINLAND
FR-1186-E,FRANCE
FR-1382-E,FRANCE
FR-1550-M,FRANCE
FR-2064-E,FRANCE
FR-2510-M,FRANCE
FR-2578-M,FRANCE
FR-2635-E,FRANCE
FR-3293-M,FRANCE
FR-5174-E,FRANCE
FR-5770-E,FRANCE
FR-7085-M,FRANCE
FR-7747-E,FRANCE
FR-8053-M,FRANCE
FR-8143-M,FRANCE
NL-3613-C,NETHERLANDS
NL-4187-C,NETHERLANDS
NL-5034-C,NETHERLANDS
NL-9752-C,NETHERLANDS
NL-9761-C,NETHERLANDS
RU-815-U1,RUSSIAN FEDERATION
US-1260-A,USA
US-1844-A,USA
US-3704-A,USA
US-4174-P,USA
US-4340-A,USA
US-4449-P,USA
US-4570-P,USA
US-5293-P,USA
US-5333-A,USA
US-5618-A,USA
US-6399-A,USA
US-6501-P,USA
US-7090-A,USA
US-7624-A,USA
US-7703-P,USA
US-7765-P,USA
US-8162-P,USA
US-8923-P,USA
US-9153-A,USA
US-9563-A,USA
US-H817-H,USA
CA-10240-A,CANADA
CA-10445-A,CANADA
CA-11856-A,CANADA
CA-12085-A,CANADA
CA-12299-A,CANADA
CA-12359-A,CANADA
CA-12986-A,CANADA
CA-14364-A,CANADA
CA-15108-A,CANADA
CA-15467-A,CANADA
CA-16464-A,CANADA
CA-16944-A,CANADA
CA-17107-A,CANADA
CA-18535-S,CANADA
CA-19006-S,CANADA
CA-21676-A,CANADA
CA-21706-A,CANADA
CA-21979-A,CANADA
CA-22497-S,CANADA
CA-22705-A,CANADA
CA-23044-A,CANADA
CA-25240-S,CANADA
CA-25587-A,CANADA
CA-26172-A,CANADA
CA-27810-A,CANADA
CA-29171-S,CANADA
CA-29565-A,CANADA
CA-30563-S,CANADA
CA-30747-A,CANADA
CA-31066-A,CANADA
CA-31656-A,CANADA
CA-34117-A,CANADA
CA-34328-A,CANADA
CA-35530-A,CANADA
CA-36126-A,CANADA
CA-37060-A,CANADA
CA-37412-A,CANADA
CA-38186-A,CANADA
CA-38290-A,CANADA
CA-38566-A,CANADA
CA-39941-A,CANADA
CA-41986-A,CANADA
CA-42957-A,CANADA
CA-43582-A,CANADA
CA-43613-A,CANADA
CA-43665-A,CANADA
CA-44103-A,CANADA
CA-44675-A,CANADA
CA-45114-S,CANADA
CA-45162-A,CANADA
CA-46041-S,CANADA
CA-46346-S,CANADA
CA-46414-S,CANADA
CA-46650-A,CANADA
CA-47228-S,CANADA
CA-47556-A,CANADA
CA-47943-A,CANADA
CA-48005-S,CANADA
CA-50059-A,CANADA
CA-51084-S,CANADA
CA-51448-A,CANADA
CA-53020-A,CANADA
CA-53342-A,CANADA
CA-53679-A,CANADA
CA-54019-A,CANADA
CA-56199-S,CANADA
CA-57871-A,CANADA
CA-58112-A,CANADA
CA-59658-S,CANADA
CA-62116-A,CANADA
CA-63512-A,CANADA
CA-64348-A,CANADA
CA-64895-A,CANADA
CA-64959-A,CANADA
CA-65051-A,CANADA
CA-65468-A,CANADA
CA-66408-A,CANADA
CA-67027-A,CANADA
CA-67256-A,CANADA
CA-68355-A,CANADA
CA-68561-A,CANADA
CA-69952-A,CANADA
CA-69969-A,CANADA
CA-70837-S,CANADA
CA-71352-A,CANADA
CA-72557-S,CANADA
CA-73229-S,CANADA
CA-73434-A,CANADA
CA-73648-A,CANADA
CA-75054-A,CANADA
CA-75833-A,CANADA
CA-75940-A,CANADA
CA-76442-A,CANADA
CA-77673-S,CANADA
CA-78154-A,CANADA
CA-78848-A,CANADA
CA-80485-S,CANADA
CA-81879-A,CANADA
CA-82735-A,CANADA
CA-83640-A,CANADA
CA-84428-S,CANADA
CA-84611-A,CANADA
CA-85458-S,CANADA
CA-87085-A,CANADA
CA-87655-A,CANADA
CA-88869-A,CANADA
CA-89598-S,CANADA
CA-90451-A,CANADA
CA-90703-A,CANADA
CA-91407-A,CANADA
CA-91839-A,CANADA
CA-92136-S,CANADA
CA-92671-S,CANADA
CA-93153-A,CANADA
CA-93847-S,CANADA
CA-94404-A,CANADA
CA-94834-A,CANADA
CA-95812-A,CANADA
CA-96813-A,CANADA
CA-97691-A,CANADA
CA-97784-A,CANADA
CA-98415-S,CANADA
CA-98613-A,CANADA
CA-98742-A,CANADA
CA-99391-S,CANADA
CA-99529-A,CANADA
DE-10599-C,FEDERAL REPUBLIC GERMANY
DE-10678-C,FEDERAL REPUBLIC GERMANY
DE-10717-C,FEDERAL REPUBLIC GERMANY
DE-12268-C,FEDERAL REPUBLIC GERMANY
DE-16453-C,FEDERAL REPUBLIC GERMANY
DE-17382-C,FEDERAL REPUBLIC GERMANY
DE-17635-C,FEDERAL REPUBLIC GERMANY
DE-18657-C,FEDERAL REPUBLIC GERMANY
DE-21533-C,FEDERAL REPUBLIC GERMANY
DE-21800-C,FEDERAL REPUBLIC GERMANY
DE-22191-C,FEDERAL REPUBLIC GERMANY
DE-24092-C,FEDERAL REPUBLIC GERMANY
DE-24550-C,FEDERAL REPUBLIC GERMANY
DE-26040-C,FEDERAL REPUBLIC GERMANY
DE-26251-C,FEDERAL REPUBLIC GERMANY
DE-26645-C,FEDERAL REPUBLIC GERMANY
DE-27162-C,FEDERAL REPUBLIC GERMANY
DE-28245-C,FEDERAL REPUBLIC GERMANY
DE-2866
Query:
-- 8. Select publication numbers and embeddings from ABS_AND_EMB
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 
Query:
-- 9. Inspect the structure of the 'cited_by' column in ABS_AND_EMB
SELECT t."publication_number", f.value AS "citing_publication_number"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
LATERAL FLATTEN(input => t."cited_by") f
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,citing_publication_number
JP-H11311351-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2006108223-A1"",
  ""type"": ""X""
}"
JP-S55101582-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2009019747-A1"",
  ""type"": ""A""
}"
JP-2007261350-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2015098042-A1"",
  ""type"": ""Y""
}"
JP-2013195867-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2015125364-A1"",
  ""type"": ""Y""
}"
JP-H09275620-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""KR-100722292-B1"",
  ""type"": """"
}"
JP-S615524-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-H03259843-A"",
  ""type"": """"
}"
JP-2005297895-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2007253801-A"",
  ""type"": """"
}"
JP-H08322367-A,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2010031181-A1"",
  ""type"": ""A""
}"
JP-H04247151-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009501564-A"",
  ""type"": """"
}"
JP-2000214640-A,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7883016-B2"",
  ""type"": """"
}"
JP-S6223320-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-S6443031-A"",
  ""type"": """"
}"
JP-S5243785-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-S59165710-U"",
  ""type"": """"
}"
JP-2004062130-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2013516653-A"",
  ""type"": """"
}"
JP-2001284831-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""CN-102340956-A"",
  ""type"": ""A""
}"
JP-2010042916-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2012111628-A"",
  ""type"": """"
}"
JP-H05268224-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009506590-A"",
  ""type"": """"
}"
JP-H11231257-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009211091-A"",
  ""type"": """"
}"
JP-2015117367-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""KR-101796548-B1"",
  ""type"": """"
}"
JP-S63257513-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2015532000-A"",
  ""type"": """"
}"
JP-2006027947-A,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-8784562-B2"",
  ""type"": """"
}"
JP-2001063207-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2003096341-A"",
  ""type"": """"
}"
JP-S5785313-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-H04111902-U"",
  ""type"": """"
}"
JP-H0419932-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2006308526-A"",
  ""type"": """"
}"
JP-2009039138-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2013137198-A"",
  ""type"": """"
}"
JP-H04215410-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""CN-104240895-A"",
  ""type"": ""A""
}"
JP-H03248457-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-H04277675-A"",
  ""type"": """"
}"
JP-2005309329-A,"{
  ""application_number"": """",
  ""category"": ""EXA"",
  ""filing_date"": 0,
  ""npl_text"": 
Query:
-- 10. Select publication numbers and the count of forward citations from ABS_AND_EMB
SELECT "publication_number", ARRAY_SIZE("cited_by") AS "num_forward_citations"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,num_forward_citations
CA-27-A,0
ES-81-Y,0
DE-303-C,0
ES-866-Y,0
FI-150-A,0
FI-250-A,0
FR-336-E,0
NL-284-C,0
NL-947-C,0
BE-107-T1,0
CA-1911-A,0
CA-4005-A,0
CA-4106-A,0
CA-4698-A,0
CA-4801-A,0
CA-5943-A,0
CA-6183-A,0
CA-6207-A,0
CA-6390-A,0
CA-6969-A,0
CA-8931-S,0
CA-9897-A,0
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,0
DK-3080-C,0
DK-3107-C,0
DK-3184-C,0
DK-3510-C,0
DK-5867-C,0
DK-5921-C,0
DK-6491-A,0
DK-7210-C,0
DK-8069-C,0
DK-8466-C,0
DK-9281-C,0
DK-9359-C,0
ES-1062-U,0
ES-1498-U,0
ES-1524-Y,0
ES-1872-U,0
ES-2542-Y,0
ES-2819-Y,0
ES-2960-U,0
ES-3045-U,0
ES-4483-Y,0
ES-4723-Y,0
ES-4858-U,0
ES-5089-Y,0
ES-5219-Y,0
ES-5716-U,0
ES-5975-Y,0
ES-6454-U,0
ES-6552-Y,0
ES-6928-Y,0
ES-6962-Y,0
ES-7086-Y,0
ES-7407-Y,0
ES-7489-Y,0
ES-7516-U,0
ES-7538-U,0
ES-764-H3,0
ES-8269-Y,0
FI-1825-A,0
FI-291-U1,0
FI-3021-A,0
FI-4211-A,0
FI-4543-A,0
FI-8034-A,0
FI-8619-A,0
FI-8985-A,0
FI-902-U1,0
FR-1186-E,0
FR-1382-E,0
FR-1550-M,0
FR-2064-E,0
FR-2510-M,0
FR-2578-M,0
FR-2635-E,0
FR-3293-M,0
FR-5174-E,0
FR-5770-E,0
FR-7085-M,0
FR-7747-E,0
FR-8053-M,0
FR-8143-M,0
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,0
RU-815-U1,0
US-1260-A,0
US-1844-A,0
US-3704-A,0
US-4174-P,0
US-4340-A,0
US-4449-P,0
US-4570-P,0
US-5293-P,0
US-5333-A,0
US-5618-A,0
US-6399-A,0
US-6501-P,0
US-7090-A,0
US-7624-A,0
US-7703-P,0
US-7765-P,0
US-8162-P,0
US-8923-P,0
US-9153-A,0
US-9563-A,0
US-H817-H,0
CA-10240-A,0
CA-10445-A,0
CA-11856-A,0
CA-12085-A,0
CA-12299-A,0
CA-12359-A,0
CA-12986-A,0
CA-14364-A,0
CA-15108-A,0
CA-15467-A,0
CA-16464-A,0
CA-16944-A,0
CA-17107-A,0
CA-18535-S,0
CA-19006-S,0
CA-21676-A,0
CA-21706-A,0
CA-21979-A,0
CA-22497-S,0
CA-22705-A,0
CA-23044-A,0
CA-25240-S,0
CA-25587-A,0
CA-26172-A,0
CA-27810-A,0
CA-29171-S,0
CA-29565-A,0
CA-30563-S,0
CA-30747-A,0
CA-31066-A,0
CA-31656-A,0
CA-34117-A,0
CA-34328-A,0
CA-35530-A,0
CA-36126-A,0
CA-37060-A,0
CA-37412-A,0
CA-38186-A,0
CA-38290-A,0
CA-38566-A,0
CA-39941-A,0
CA-41986-A,0
CA-42957-A,0
CA-43582-A,0
CA-43613-A,0
CA-43665-A,0
CA-44103-A,0
CA-44675-A,0
CA-45114-S,0
CA-45162-A,0
CA-46041-S,0
CA-46346-S,0
CA-46414-S,0
CA-46650-A,0
CA-47228-S,0
CA-47556-A,0
CA-47943-A,0
CA-48005-S,0
CA-50059-A,0
CA-51084-S,0
CA-51448-A,0
CA-53020-A,0
CA-53342-A,0
CA-53679-A,0
CA-54019-A,0
CA-56199-S,0
CA-57871-A,0
CA-58112-A,0
CA-59658-S,0
CA-62116-A,0
CA-63512-A,0
CA-64348-A,0
CA-64895-A,0
CA-64959-A,0
CA-65051-A,0
CA-65468-A,0
CA-66408-A,0
CA-67027-A,0
CA-67256-A,0
CA-68355-A,0
CA-68561-A,0
CA-69952-A,0
CA-69969-A,0
CA-70837-S,0
CA-71352-A,0
CA-72557-S,0
CA-73229-S,0
CA-73434-A,0
CA-73648-A,0
CA-75054-A,0
CA-75833-A,0
CA-75940-A,0
CA-76442-A,0
CA-77673-S,0
CA-78154-A,0
CA-78848-A,0
CA-80485-S,0
CA-81879-A,0
CA-82735-A,0
CA-83640-A,0
CA-84428-S,0
CA-84611-A,0
CA-85458-S,0
CA-87085-A,0
CA-87655-A,0
CA-88869-A,0
CA-89598-S,0
CA-90451-A,0
CA-90703-A,0
CA-91407-A,0
CA-91839-A,0
CA-92136-S,0
CA-92671-S,0
CA-93153-A,0
CA-93847-S,0
CA-94404-A,0
CA-94834-A,0
CA-95812-A,0
CA-96813-A,0
CA-97691-A,0
CA-97784-A,0
CA-98415-S,0
CA-98613-A,0
CA-98742-A,0
CA-99391-S,0
CA-99529-A,0
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,0
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,0
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,0
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,0
DK-11017-C,0
DK-11274-A,0
DK-11549-C,0
DK-13429-C,0
DK-14113-C,0
DK-15486-A,0
DK-15672-C,0
DK-16003-C,0
DK-16200-C,0
DK-16721-C,0
DK-17077-C,0
DK-17891-C,0
DK-18174-A,0
DK-18287-C,0
DK-18953-C,0
DK-19067-C,0
DK-20848-C,0
DK-21534-C,0
DK-21593-C,0
DK-24093-C,0
DK-24122-C,0
DK-24560-C,0
DK-24764-C,0
DK-25033-C,0
DK-26002-C,0
DK-28460-C,0
DK-30663-C,0
DK-31338-C,0
DK-32802-C,0
DK-32923-C,0
DK-32960-C,0
DK-33342-C,0
DK-33585-C,0
DK-34417-C,0
DK-34475-A,0
DK-34847-C,0
DK-3485-D0,0
DK-35287-A,0
DK-35387-A,0
DK-36818-C,0
DK-37723-C,0
DK-38288-C,0
DK-3889-D0,0
DK-40323-C,0
DK-42091-A,0
DK-44173-C,0
DK-45094-C,0
DK-46556-C,0
DK-47464-C,0
DK-48374-C,0
DK-48877-A,0
DK-49091-A,0
DK-49195-A,0
DK-49500-C,0
DK-49630-C,0
DK-50267-C,0
DK-50495-C,0
DK-50958-C,0
DK-51991-A,0
DK-54440-C,0
DK-57003-C,0
DK-57783-C,0
DK-58127-C,0
DK-58679-A,0
DK-59291-C,0
DK-59541-C,0
DK-61292-A,0
DK-
Query:
SELECT
    p."publication_number",
    p."filing_date",
    ARRAY_SIZE(a."cited_by") AS num_forward_citations
FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
JOIN
    PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
ON
    p."publication_number" = a."publication_number"
ORDER BY
    num_forward_citations DESC
LIMIT 1;
Answer:
publication_number,filing_date,NUM_FORWARD_CITATIONS
US-2007046191-A1,20060811,2667
Query:
-- 12. Select publication numbers and grant dates for patents with kind code 'B2' and country code 'US'
SELECT "publication_number", "grant_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "kind_code" = 'B2' AND "country_code" = 'US'
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,grant_date
US-6594862-B2,20030722
US-8395734-B2,20130312
US-7781260-B2,20100824
US-7197968-B2,20070403
US-6766870-B2,20040727
US-7518315-B2,20090414
US-7879487-B2,20110201
US-8229907-B2,20120724
US-8405269-B2,20130326
US-8423896-B2,20130416
US-8694822-B2,20140408
US-7717638-B2,20100518
US-9658993-B2,20170523
US-7432680-B2,20081007
US-8984416-B2,20150317
US-8520301-B2,20130827
US-8463797-B2,20130611
US-7173260-B2,20070206
US-7218306-B2,20070515
US-9322575-B2,20160426
US-8251903-B2,20120828
US-8011721-B2,20110906
US-7674988-B2,20100309
US-7890720-B2,20110215
US-7587611-B2,20090908
US-8555064-B2,20131008
US-9388108-B2,20160712
US-9005975-B2,20150414
US-7431883-B2,20081007
US-9384181-B2,20160705
US-7540698-B2,20090602
US-7118014-B2,20061010
US-9200008-B2,20151201
US-7715549-B2,20100511
US-6723201-B2,20040420
US-9293519-B2,20160322
US-9711737-B2,20170718
US-7130860-B2,20061031
US-9660655-B2,20170523
US-9624723-B2,20170418
US-9683466-B2,20170620
US-9186273-B2,20151117
US-9077131-B2,20150707
US-7868069-B2,20110111
US-9022857-B2,20150505
US-6906028-B2,20050614
US-6555432-B2,20030429
US-9224593-B2,20151229
US-6915077-B2,20050705
US-8908076-B2,20141209
US-9108579-B2,20150818
US-6590697-B2,20030708
US-7848876-B2,20101207
US-8229089-B2,20120724
US-8656944-B2,20140225
US-8174698-B2,20120508
US-7054128-B2,20060530
US-8071460-B2,20111206
US-9242288-B2,20160126
US-7894503-B2,20110222
US-6650779-B2,20031118
US-7341790-B2,20080311
US-7151395-B2,20061219
US-7051556-B2,20060530
US-7627407-B2,20091201
US-8531956-B2,20130910
US-9717416-B2,20170801
US-9079085-B2,20150714
US-8384812-B2,20130226
US-6865799-B2,20050315
US-7208289-B2,20070424
US-8685222-B2,20140401
US-9316252-B2,20160419
US-9647310-B2,20170509
US-8979283-B2,20150317
US-7859720-B2,20101228
US-8721568-B2,20140513
US-7923193-B2,20110412
US-7551218-B2,20090623
US-9095149-B2,20150804
US-8083000-B2,20111227
US-7693757-B2,20100406
US-9387868-B2,20160712
US-6655685-B2,20031202
US-8614090-B2,20131224
US-7532829-B2,20090512
US-7535127-B2,20090519
US-8356007-B2,20130115
US-7474706-B2,20090106
US-8866673-B2,20141021
US-9113475-B2,20150818
US-8920021-B2,20141230
US-8523131-B2,20130903
US-8981057-B2,20150317
US-7648250-B2,20100119
US-7880528-B2,20110201
US-8442540-B2,20130514
US-8197852-B2,20120612
US-9230189-B2,20160105
US-9224524-B2,20151229
US-9724574-B2,20170808
US-7750987-B2,20100706
US-9588141-B2,20170307
US-7711626-B2,20100504
US-9072123-B2,20150630
US-6809443-B2,20041026
US-8224960-B2,20120717
US-8963162-B2,20150224
US-9105604-B2,20150811
US-9484479-B2,20161101
US-6969040-B2,20051129
US-8467623-B2,20130618
US-7069677-B2,20060704
US-7504376-B2,20090317
US-7578867-B2,20090825
US-8920531-B2,20141230
US-7729242-B2,20100601
US-8032070-B2,20111004
US-9512383-B2,20161206
US-8295044-B2,20121023
US-8563297-B2,20131022
US-9497512-B2,20161115
US-8522638-B2,20130903
US-9254734-B2,20160209
US-8564570-B2,20131022
US-9052899-B2,20150609
US-7139800-B2,20061121
US-7059616-B2,20060613
US-9129081-B2,20150908
US-7869229-B2,20110111
US-9019344-B2,20150428
US-7766626-B2,20100803
US-7894970-B2,20110222
US-6870480-B2,20050322
US-9124456-B2,20150901
US-7921420-B2,20110405
US-7657683-B2,20100202
US-8039612-B2,20111018
US-9360734-B2,20160607
US-9313000-B2,20160412
US-8237168-B2,20120807
US-9366739-B2,20160614
US-8679858-B2,20140325
US-8240244-B2,20120814
US-9355325-B2,20160531
US-8611413-B2,20131217
US-9682365-B2,20170620
US-8293181-B2,20121023
US-9161130-B2,20151013
US-7591715-B2,20090922
US-7381205-B2,20080603
US-9138417-B2,20150922
US-6670606-B2,20031230
US-6881764-B2,20050419
US-6840585-B2,20050111
US-7032893-B2,20060425
US-8411927-B2,20130402
US-7463910-B2,20081209
US-6530865-B2,20030311
US-9654967-B2,20170516
US-8019092-B2,20110913
US-8941821-B2,20150127
US-8560450-B2,20131015
US-6864120-B2,20050308
US-8559021-B2,20131015
US-6982158-B2,20060103
US-7071989-B2,20060704
US-6537876-B2,20030325
US-8737709-B2,20140527
US-8177385-B2,20120515
US-9687557-B2,20170627
US-7378253-B2,20080527
US-7760001-B2,20100720
US-6814687-B2,20041109
US-7165933-B2,20070123
US-7941865-B2,20110510
US-8422031-B2,20130416
US-8925436-B2,20150106
US-9519080-B2,20161213
US-9173042-B2,20151027
US-6946024-B2,20050920
US-8921985-B2,20141230
US-6745148-B2,20040601
US-9320981-B2,20160426
US-9071009-B2,20150630
US-7005020-B2,20060228
US-9035405-B2,20150519
US-9089118-B2,20150728
US-7631669-B2,20091215
US-8876138-B2,20141104
US-6991728-B2,20060131
US-6434382-B2,20020813
US-7694767-B2,20100413
US-9591464-B2,20170307
US-9097401-B2,20150804
US-9100808-B2,20150804
US-7017231-B2,20060328
US-6579638-B2,20030617
US-7069159-B2,20060627
US-6853584-B2,20050208
US-6875977-B2,20050405
US-8925670-B2,20150106
US-9548125-B2,20170117
US-8244519-B2,20120814
US-6594725-B2,20030715
US-7325466-B2,20080205
US-6582228-B2,20030624
US-9563718-B2,20170207
US-9109382-B2,20150818
US-7902031-B2,20110308
US-7608693-B2,20091027
US-7464329-B2,20081209
US-8296413-B2,20121023
US-7970723-B2,20110628
US-7780352-B2,20100824
US-7658953-B2,20100209
US
Query:
-- 13. Select publication numbers and embeddings where embeddings are not null
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
WHERE "embedding_v1" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_v1
US-2951957-A,"[
  8.362335999999999e-02,
  -1.428828100000000e-01,
  -5.209156000000000e-03,
  -6.813269000000000e-02,
  -5.278470400000000e-02,
  -1.435878600000000e-01,
  5.047881000000000e-02,
  6.861719300000000e-04,
  2.224949900000000e-01,
  -8.987959000000000e-02,
  -4.084670500000000e-02,
  -1.282170400000000e-02,
  -1.603074800000000e-01,
  -1.031415800000000e-01,
  1.410270300000000e-01,
  -8.313097000000000e-02,
  2.386805700000000e-01,
  7.057566999999999e-02,
  -2.290654700000000e-02,
  9.825958000000000e-02,
  3.188707000000000e-03,
  -2.647633100000000e-02,
  -1.092003900000000e-01,
  -5.279829000000000e-02,
  -2.569500000000000e-02,
  -5.484348000000000e-02,
  2.931414200000000e-01,
  -5.625863000000000e-02,
  7.671317499999999e-02,
  -2.101696000000000e-02,
  -9.648903500000000e-02,
  2.814773800000000e-02,
  1.196730400000000e-01,
  -1.809715700000000e-02,
  5.101946000000000e-02,
  -1.260035600000000e-01,
  -4.599736300000000e-02,
  -1.099367140000000e-01,
  2.253598100000000e-01,
  1.840519200000000e-01,
  -2.293222200000000e-01,
  2.864085500000000e-02,
  1.707429800000000e-02,
  1.232229000000000e-01,
  1.622332800000000e-01,
  1.543603700000000e-01,
  -4.663030800000000e-02,
  1.824901800000000e-01,
  9.075740000000000e-02,
  -3.217364800000000e-01,
  -5.368751700000000e-02,
  -6.377889000000000e-03,
  -1.489741000000000e-01,
  1.935613900000000e-01,
  -7.129235000000000e-03,
  6.445281000000000e-02,
  -2.489995800000000e-01,
  -2.271947300000000e-02,
  -6.134887000000000e-02,
  1.986401000000000e-01,
  3.393093000000000e-02,
  1.078262100000000e-01,
  -1.761589300000000e-01,
  8.991186000000000e-02
]"
US-4897035-A,"[
  3.940709000000000e-02,
  -2.597278200000000e-02,
  -6.800645000000000e-02,
  -2.881745000000000e-01,
  4.827634000000000e-02,
  -6.236814000000000e-04,
  -2.521992000000000e-02,
  -1.599087600000000e-02,
  4.216611800000000e-02,
  -3.821041400000000e-02,
  1.730927200000000e-01,
  -3.798891600000000e-02,
  1.830829000000000e-01,
  7.517589000000000e-02,
  8.099699000000000e-03,
  1.149717100000000e-01,
  1.722225800000000e-01,
  -1.944074000000000e-02,
  -1.152504000000000e-01,
  -1.621994400000000e-01,
  -1.620336000000000e-01,
  -1.014300900000000e-01,
  -9.175859000000000e-02,
  3.969524000000000e-02,
  -2.761362500000000e-01,
  -1.333980300000000e-01,
  -1.668396400000000e-02,
  1.957727200000000e-01,
  1.239102800000000e-02,
  -1.144100500000000e-02,
  1.131469300000000e-01,
  -1.321501300000000e-01,
  -4.336641000000000e-02,
  -1.311177600000000e-01,
  -1.619727600000000e-01,
  -1.946237000000000e-01,
  1.297715500000000e-01,
  -7.682512000000000e-02,
  8.311364999999999e-03,
  2.755730000000000e-02,
  -1.120370100000000e-02,
  -9.150763600000000e-02,
  1.413144200000000e-01,
  -1.402106000000000e-01,
  1.395930500000000e-01,
  3.988200000000000e-02,
  6.982776500000000e-02,
  -2.444522300000000e-02,
  1.771123700000000e-01,
  -1.097915300000000e-01,
  -9.719206399999999e-02,
  -2.927858200000000e-02,
  1.482062300000000e-01,
  1.132943260000000e-01,
  -2.464319200000000e-01,
  -1.034510660000000e-01,
  -2.769150200000000e-02,
  -1.443465000000000e-01,
  -1.429210200000000e-01,
  3.029047900000000e-02,
  -2.345570200000000e-01,
  1.843463200000000e-01,
  -2.501799000000000e-01,
  6.695028000000000e-02
]"
US-5832509-A,"[
  8.716943000000001e-02,
  -6.795622400000000e-02,
  -1.447544200000000e-01,
  -4.215143600000000e-02,
  3.562337500000000e-02,
  -4.434270400000000e-02,
  9.165478500000000e-02,
  -1.708218000000000e-02,
  3.506425300000000e-01,
  3.633461500000000e-02,
  8.391910000000000e-02,
  1.031111900000000e-01,
  -3.371140700000000e-02,
  2.321766700000000e-02,
  2.394382000000000e-03,
  -9.655345999999999e-02,
  -4.717555000000000e-02,
  1.349720800000000e-01,
  -1.789933300000000e-02,
  1.247093200000000e-01,
  4.784599000000000e-02,
  1.001340800000000e-02,
  -4.928872500000000e-03,
  -7.338276500000000e-02,
  -5.507919000000000e-02,
  1.026705700000000e-01,
  1.393821100000000e-01,
  1.276103600000000e-01,
  9.779023000000001e-02,
  -7.936486600000001e-02,
  -8.535474000000000e-02,
  8.279648400000000e-02,
  -1.261513700000000e-01,
  7.045916300000000e-03,
  -1.357231700000000e-01,
  -2.007939000000000e-01,
  3.253786600000000e-02,
  -2.664299500000000e-02,
  2.653538600000000e-01,
  4.831082700000000e-02,
  -8.429014000000000e-02,
  -5.002477000000000e-02,
  2.030032600000000e-01,
  9.217891000000000e-02,
  8.634042000000000e-03,
  9.044094000000000e-02,
  9.375375499999999e-02,
  -3.200432000000000e-02,
  1.610973100000000e-02,
  5.450559000000000e-03,
  -3.384401000000000e-01,
  2.149827200000000e-01,
  2.593768500000000e-01,
  2.543867000000000e-02,
  -1.129539760000000e-01,
  1.078855500000000e-02,
  2.471758900000000e-01,
  2.002329200000000e-02,
  -1.504945800000000e-01,
  1.058296600000000e-01,
  -1.340331500000000e-02,
  1.870675100000000e-01,
  -2.313979600000000e-01,
  1.557590400000000e-01
]"
US-4560189-A,"[
Query:
-- 14. Select sample embeddings for analysis
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 
Query:
-- 15. Select publication numbers and the size of 'embedding_v1' array
SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_length"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_length
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,64
DK-
End Exploring Related Columns
Task: For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
publication_number,num_forward_citations,most_similar_publication_number,similarity_score
pub_num:str,num_citations:int,similar_pub_num:str,similarity_score:float
(Attention: answer in one row)
```

The United States utility patent under the B2 classification granted between 2010 and 2014 with the most forward citations within a month of its filing date is identified by `publication_number`. The patent most similar to it from the same filing year, regardless of its type, is identified by `most_similar_publication_number`, with a similarity score of `similarity_score`..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 03:19:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:19:06 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    , LATERAL FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        "filing_date_A"
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp."filing_date_A"), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.value::float * op_val.value::float), 4) AS similarity_score
FROM
    other_patents op
CROSS JOIN target_embedding te
LATERAL FLATTEN(input => te.target_embedding) te_val
LATERAL FLATTEN(input => op.other_embedding) op_val
WHERE
    te_val."index" = op_val."index"
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:19:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:19:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:19:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:19:08 - snowflake.connector.connection - INFO - closed
2025-01-19 03:19:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:19:08 - root - INFO - itercount: 1
2025-01-19 03:19:08 - root - INFO - 001003 (42000): 01b9cea7-0004-7b17-0001-11c300eec396: SQL compilation error:
syntax error line 75 at position 0 unexpected 'LATERAL'.
2025-01-19 03:19:08 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    , LATERAL FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        "filing_date_A"
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp."filing_date_A"), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.value::float * op_val.value::float), 4) AS similarity_score
FROM
    other_patents op
CROSS JOIN target_embedding te
LATERAL FLATTEN(input => te.target_embedding) te_val
LATERAL FLATTEN(input => op.other_embedding) op_val
WHERE
    te_val."index" = op_val."index"
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
001003 (42000): 01b9cea7-0004-7b17-0001-11c300eec396: SQL compilation error:
syntax error line 75 at position 0 unexpected 'LATERAL'.
Please correct it and output only 1 complete SQL query.
2025-01-19 03:20:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:20:38 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f ON TRUE
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        "filing_date_A"
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp."filing_date_A"), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.value::float * op_val.value::float), 4) AS similarity_score
FROM
    other_patents op
JOIN target_embedding te ON TRUE
JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val ON TRUE
JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val ON te_val."index" = op_val."index"
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:20:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:20:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:20:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:20:39 - snowflake.connector.connection - INFO - closed
2025-01-19 03:20:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:20:39 - root - INFO - itercount: 2
2025-01-19 03:20:39 - root - INFO - 000904 (42000): 01b9cea8-0004-7b17-0001-11c300eec5b6: SQL compilation error: error line 35 at position 8
invalid identifier '"filing_date_A"'
2025-01-19 03:20:39 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f ON TRUE
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        "filing_date_A"
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp."filing_date_A"), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.value::float * op_val.value::float), 4) AS similarity_score
FROM
    other_patents op
JOIN target_embedding te ON TRUE
JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val ON TRUE
JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val ON te_val."index" = op_val."index"
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9cea8-0004-7b17-0001-11c300eec5b6: SQL compilation error: error line 35 at position 8
invalid identifier '"filing_date_A"'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:21:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:21:12 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f ON TRUE
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp.filing_date_A), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.value::float * op_val.value::float), 4) AS similarity_score
FROM
    other_patents op
JOIN target_embedding te ON TRUE
JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val ON TRUE
JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val ON te_val."index" = op_val."index"
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:21:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:21:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:21:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:21:14 - snowflake.connector.connection - INFO - closed
2025-01-19 03:21:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:21:14 - root - INFO - itercount: 3
2025-01-19 03:21:14 - root - INFO - 000904 (42000): 01b9cea9-0004-7b17-0001-11c300eec5be: SQL compilation error: error line 77 at position 63
invalid identifier 'TE_VAL."index"'
2025-01-19 03:21:14 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f ON TRUE
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp.filing_date_A), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.value::float * op_val.value::float), 4) AS similarity_score
FROM
    other_patents op
JOIN target_embedding te ON TRUE
JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val ON TRUE
JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val ON te_val."index" = op_val."index"
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9cea9-0004-7b17-0001-11c300eec5be: SQL compilation error: error line 77 at position 63
invalid identifier 'TE_VAL."index"'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:22:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:22:11 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f ON TRUE
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp.filing_date_A), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    other_patents op
JOIN target_embedding te ON TRUE
JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val ON TRUE
JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val ON te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:22:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:22:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:22:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:22:12 - snowflake.connector.connection - INFO - closed
2025-01-19 03:22:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:22:13 - root - INFO - itercount: 4
2025-01-19 03:22:13 - root - INFO - 000002 (0A000): 01b9ceaa-0004-7b17-0001-11c300eec5e6: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
2025-01-19 03:22:13 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f ON TRUE
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(TO_VARCHAR(p1."filing_date"), 'YYYYMMDD'),
            TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(TO_VARCHAR(sp.filing_date_A), 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(TO_VARCHAR(p2."filing_date"), 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    other_patents op
JOIN target_embedding te ON TRUE
JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val ON TRUE
JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val ON te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
000002 (0A000): 01b9ceaa-0004-7b17-0001-11c300eec5e6: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
Please correct it and output only 1 complete SQL query.
2025-01-19 03:23:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:23:00 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
            TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(sp.filing_date_A::varchar, 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:23:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:23:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:23:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:23:02 - snowflake.connector.connection - INFO - closed
2025-01-19 03:23:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:23:02 - root - INFO - itercount: 5
2025-01-19 03:23:02 - root - INFO - 100097 (22007): 01b9ceab-0004-7b17-0001-11c300eec5ea: Can't parse '0' as date with format 'YYYYMMDD'
2025-01-19 03:23:02 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL
        AND p2."filing_date" IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
            TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(sp.filing_date_A::varchar, 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
100097 (22007): 01b9ceab-0004-7b17-0001-11c300eec5ea: Can't parse '0' as date with format 'YYYYMMDD'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:23:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:23:43 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL AND p1."filing_date" != 0
        AND p2."filing_date" IS NOT NULL AND p2."filing_date" != 0
        AND DATEDIFF(
            'day',
            TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
            TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(sp.filing_date_A::varchar, 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
    WHERE
        sp.filing_date_A IS NOT NULL AND sp.filing_date_A != 0
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL AND p2."filing_date" != 0
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:23:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:23:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:23:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:23:45 - snowflake.connector.connection - INFO - closed
2025-01-19 03:23:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:23:45 - root - INFO - itercount: 6
2025-01-19 03:23:45 - root - INFO - 100097 (22007): 01b9ceab-0004-7dde-0001-11c300eed2b2: Can't parse '0' as date with format 'YYYYMMDD'
2025-01-19 03:23:45 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL AND p1."filing_date" != 0
        AND p2."filing_date" IS NOT NULL AND p2."filing_date" != 0
        AND DATEDIFF(
            'day',
            TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
            TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(sp.filing_date_A::varchar, 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
    WHERE
        sp.filing_date_A IS NOT NULL AND sp.filing_date_A != 0
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL AND p2."filing_date" != 0
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
100097 (22007): 01b9ceab-0004-7dde-0001-11c300eed2b2: Can't parse '0' as date with format 'YYYYMMDD'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:24:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:24:47 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
        AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
        AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
            TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    WHERE
        filing_date_A IS NOT NULL AND filing_date_A > 0
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(sp.filing_date_A::varchar, 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
    WHERE
        sp.filing_date_A IS NOT NULL AND sp.filing_date_A > 0
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:24:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:24:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:24:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:24:49 - snowflake.connector.connection - INFO - closed
2025-01-19 03:24:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:24:49 - root - INFO - itercount: 7
2025-01-19 03:24:49 - root - INFO - 100097 (22007): 01b9ceac-0004-7dde-0001-11c300eed2ba: Can't parse '0' as date with format 'YYYYMMDD'
2025-01-19 03:24:49 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
        AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
        AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
        AND DATEDIFF(
            'day',
            TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
            TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date"
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A
    FROM
        forward_citation_counts
    WHERE
        filing_date_A IS NOT NULL AND filing_date_A > 0
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(TO_DATE(sp.filing_date_A::varchar, 'YYYYMMDD')) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
    WHERE
        sp.filing_date_A IS NOT NULL AND sp.filing_date_A > 0
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(te_val.VALUE::float * op_val.VALUE::float), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
100097 (22007): 01b9ceac-0004-7dde-0001-11c300eed2ba: Can't parse '0' as date with format 'YYYYMMDD'
Please correct it and output only 1 complete SQL query.
2025-01-19 03:25:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:25:35 - root - INFO - ```sql
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A,
        TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') AS p1_filing_date,
        TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') AS p2_filing_date
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
        AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND p1_filing_date IS NOT NULL
        AND p2_filing_date IS NOT NULL
        AND DATEDIFF(
            'day',
            p1_filing_date,
            p2_filing_date
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date",
        p1_filing_date
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A,
        p1_filing_date
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(sp.p1_filing_date) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
    WHERE
        sp.p1_filing_date IS NOT NULL
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(CAST(te_val.VALUE AS FLOAT) * CAST(op_val.VALUE AS FLOAT)), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:25:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:25:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:25:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:25:37 - snowflake.connector.connection - INFO - closed
2025-01-19 03:25:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:25:37 - root - INFO - itercount: 8
2025-01-19 03:25:37 - root - INFO - 001104 (42601): 01b9cead-0004-7dde-0001-11c300eed2c2: SQL compilation error: error line 8 at position 20
'P2."filing_date"' in select clause is neither an aggregate nor in the group by clause.
2025-01-19 03:25:37 - root - INFO - Input sql:
WITH
forward_citation_counts AS (
    SELECT
        p1."publication_number",
        COUNT(*) AS num_forward_citations,
        p1."filing_date" AS filing_date_A,
        TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') AS p1_filing_date,
        TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') AS p2_filing_date
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
        ON t1."publication_number" = p1."publication_number"
    JOIN LATERAL
        FLATTEN(input => t1."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        ON f.value:"publication_number"::string = p2."publication_number"
    WHERE
        p1."country_code" = 'US'
        AND p1."kind_code" = 'B2'
        AND p1."grant_date" BETWEEN 20100101 AND 20141231
        AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
        AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND p1_filing_date IS NOT NULL
        AND p2_filing_date IS NOT NULL
        AND DATEDIFF(
            'day',
            p1_filing_date,
            p2_filing_date
        ) BETWEEN 0 AND 30
    GROUP BY
        p1."publication_number",
        p1."filing_date",
        p1_filing_date
),
selected_patent AS (
    SELECT
        "publication_number" AS target_pub_num,
        num_forward_citations,
        filing_date_A,
        p1_filing_date
    FROM
        forward_citation_counts
    ORDER BY
        num_forward_citations DESC NULLS LAST
    LIMIT 1
),
target_embedding AS (
    SELECT
        sp.target_pub_num,
        sp.num_forward_citations,
        a1."embedding_v1" AS target_embedding,
        YEAR(sp.p1_filing_date) AS filing_year
    FROM
        selected_patent sp
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
        ON sp.target_pub_num = a1."publication_number"
    WHERE
        sp.p1_filing_date IS NOT NULL
),
other_patents AS (
    SELECT
        p2."publication_number" AS other_pub_num,
        a2."embedding_v1" AS other_embedding
    FROM
        PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
        ON p2."publication_number" = a2."publication_number"
    CROSS JOIN target_embedding te
    WHERE
        p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
        AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
        AND a2."embedding_v1" IS NOT NULL
        AND p2."publication_number" != te.target_pub_num
        AND YEAR(TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
)
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(CAST(te_val.VALUE AS FLOAT) * CAST(op_val.VALUE AS FLOAT)), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
The error information is:
001104 (42601): 01b9cead-0004-7dde-0001-11c300eed2c2: SQL compilation error: error line 8 at position 20
'P2."filing_date"' in select clause is neither an aggregate nor in the group by clause.
Please correct it and output only 1 complete SQL query.
2025-01-19 03:26:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:26:18 - root - INFO - ```sql
WITH
    forward_citation_counts AS (
        SELECT
            p1."publication_number",
            COUNT(*) AS num_forward_citations,
            p1."filing_date" AS filing_date_A,
            TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') AS p1_filing_date
        FROM
            PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
        JOIN LATERAL
            FLATTEN(input => t1."cited_by") f
        LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
            ON f.value:"publication_number"::string = p2."publication_number"
        WHERE
            p1."country_code" = 'US'
            AND p1."kind_code" = 'B2'
            AND p1."grant_date" BETWEEN 20100101 AND 20141231
            AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
            AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
            AND TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND DATEDIFF(
                'day',
                TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
                TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
            ) BETWEEN 0 AND 30
        GROUP BY
            p1."publication_number",
            p1."filing_date",
            p1_filing_date
    ),
    selected_patent AS (
        SELECT
            "publication_number" AS target_pub_num,
            num_forward_citations,
            filing_date_A,
            p1_filing_date
        FROM
            forward_citation_counts
        ORDER BY
            num_forward_citations DESC NULLS LAST
        LIMIT 1
    ),
    target_embedding AS (
        SELECT
            sp.target_pub_num,
            sp.num_forward_citations,
            a1."embedding_v1" AS target_embedding,
            YEAR(sp.p1_filing_date) AS filing_year
        FROM
            selected_patent sp
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
            ON sp.target_pub_num = a1."publication_number"
        WHERE
            sp.p1_filing_date IS NOT NULL
    ),
    other_patents AS (
        SELECT
            p2."publication_number" AS other_pub_num,
            a2."embedding_v1" AS other_embedding
        FROM
            PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
            ON p2."publication_number" = a2."publication_number"
        CROSS JOIN target_embedding te
        WHERE
            p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
            AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND a2."embedding_v1" IS NOT NULL
            AND p2."publication_number" != te.target_pub_num
            AND YEAR(TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
    )
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(CAST(te_val.VALUE AS FLOAT) * CAST(op_val.VALUE AS FLOAT)), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:26:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:26:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:26:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:26:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:26:20 - snowflake.connector.connection - INFO - closed
2025-01-19 03:26:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:26:21 - root - INFO - itercount: 9
2025-01-19 03:26:21 - root - INFO - 0
2025-01-19 03:26:21 - root - INFO - results: 
PUBLICATION_NUMBER,NUM_FORWARD_CITATIONS,MOST_SIMILAR_PUBLICATION_NUMBER,SIMILARITY_SCORE
US-7877798-B2,1,US-2009209314-A1,0.8447


2025-01-19 03:26:21 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
publication_number,num_forward_citations,most_similar_publication_number,similarity_score
pub_num:str,num_citations:int,similar_pub_num:str,similarity_score:float
(Attention: answer in one row)
```

The United States utility patent under the B2 classification granted between 2010 and 2014 with the most forward citations within a month of its filing date is identified by `publication_number`. The patent most similar to it from the same filing year, regardless of its type, is identified by `most_similar_publication_number`, with a similarity score of `similarity_score`. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
PUBLICATION_NUMBER,NUM_FORWARD_CITATIONS,MOST_SIMILAR_PUBLICATION_NUMBER,SIMILARITY_SCORE
US-7877798-B2,1,US-2009209314-A1,0.8447
Current sql:
WITH
    forward_citation_counts AS (
        SELECT
            p1."publication_number",
            COUNT(*) AS num_forward_citations,
            p1."filing_date" AS filing_date_A,
            TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') AS p1_filing_date
        FROM
            PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
        JOIN LATERAL
            FLATTEN(input => t1."cited_by") f
        LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
            ON f.value:"publication_number"::string = p2."publication_number"
        WHERE
            p1."country_code" = 'US'
            AND p1."kind_code" = 'B2'
            AND p1."grant_date" BETWEEN 20100101 AND 20141231
            AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
            AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
            AND TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND DATEDIFF(
                'day',
                TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
                TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
            ) BETWEEN 0 AND 30
        GROUP BY
            p1."publication_number",
            p1."filing_date",
            p1_filing_date
    ),
    selected_patent AS (
        SELECT
            "publication_number" AS target_pub_num,
            num_forward_citations,
            filing_date_A,
            p1_filing_date
        FROM
            forward_citation_counts
        ORDER BY
            num_forward_citations DESC NULLS LAST
        LIMIT 1
    ),
    target_embedding AS (
        SELECT
            sp.target_pub_num,
            sp.num_forward_citations,
            a1."embedding_v1" AS target_embedding,
            YEAR(sp.p1_filing_date) AS filing_year
        FROM
            selected_patent sp
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
            ON sp.target_pub_num = a1."publication_number"
        WHERE
            sp.p1_filing_date IS NOT NULL
    ),
    other_patents AS (
        SELECT
            p2."publication_number" AS other_pub_num,
            a2."embedding_v1" AS other_embedding
        FROM
            PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
            ON p2."publication_number" = a2."publication_number"
        CROSS JOIN target_embedding te
        WHERE
            p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
            AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND a2."embedding_v1" IS NOT NULL
            AND p2."publication_number" != te.target_pub_num
            AND YEAR(TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
    )
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(CAST(te_val.VALUE AS FLOAT) * CAST(op_val.VALUE AS FLOAT)), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
2025-01-19 03:27:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:27:32 - root - INFO - ```sql
WITH
    forward_citation_counts AS (
        SELECT
            p1."publication_number",
            COUNT(*) AS num_forward_citations,
            p1."filing_date" AS filing_date_A,
            TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') AS p1_filing_date
        FROM
            PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t1
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p1
            ON t1."publication_number" = p1."publication_number"
        JOIN LATERAL
            FLATTEN(input => t1."cited_by") f
        LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
            ON f.value:"publication_number"::string = p2."publication_number"
        WHERE
            p1."country_code" = 'US'
            AND p1."kind_code" = 'B2'
            AND p1."grant_date" BETWEEN 20100101 AND 20141231
            AND p1."filing_date" IS NOT NULL AND p1."filing_date" > 0
            AND p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
            AND TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND DATEDIFF(
                'day',
                TRY_TO_DATE(p1."filing_date"::varchar, 'YYYYMMDD'),
                TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')
            ) BETWEEN 0 AND 30
        GROUP BY
            p1."publication_number",
            p1."filing_date",
            p1_filing_date
    ),
    selected_patent AS (
        SELECT
            "publication_number" AS target_pub_num,
            num_forward_citations,
            filing_date_A,
            p1_filing_date
        FROM
            forward_citation_counts
        ORDER BY
            num_forward_citations DESC NULLS LAST
        LIMIT 1
    ),
    target_embedding AS (
        SELECT
            sp.target_pub_num,
            sp.num_forward_citations,
            a1."embedding_v1" AS target_embedding,
            YEAR(sp.p1_filing_date) AS filing_year
        FROM
            selected_patent sp
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a1
            ON sp.target_pub_num = a1."publication_number"
        WHERE
            sp.p1_filing_date IS NOT NULL
    ),
    other_patents AS (
        SELECT
            p2."publication_number" AS other_pub_num,
            a2."embedding_v1" AS other_embedding
        FROM
            PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2
        JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a2
            ON p2."publication_number" = a2."publication_number"
        CROSS JOIN target_embedding te
        WHERE
            p2."filing_date" IS NOT NULL AND p2."filing_date" > 0
            AND TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD') IS NOT NULL
            AND a2."embedding_v1" IS NOT NULL
            AND p2."publication_number" != te.target_pub_num
            AND YEAR(TRY_TO_DATE(p2."filing_date"::varchar, 'YYYYMMDD')) = te.filing_year
    )
SELECT
    te.target_pub_num AS publication_number,
    te.num_forward_citations,
    op.other_pub_num AS most_similar_publication_number,
    ROUND(SUM(CAST(te_val.VALUE AS FLOAT) * CAST(op_val.VALUE AS FLOAT)), 4) AS similarity_score
FROM
    target_embedding te
CROSS JOIN other_patents op
CROSS JOIN LATERAL FLATTEN(input => te.target_embedding) AS te_val
CROSS JOIN LATERAL FLATTEN(input => op.other_embedding) AS op_val
WHERE
    te_val.INDEX = op_val.INDEX
GROUP BY
    te.target_pub_num,
    te.num_forward_citations,
    op.other_pub_num
ORDER BY
    similarity_score DESC NULLS LAST
LIMIT 1;
```
2025-01-19 03:27:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:27:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:27:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:27:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:27:33 - snowflake.connector.connection - INFO - closed
2025-01-19 03:27:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:27:34 - root - INFO - Total iteration counts: 10
