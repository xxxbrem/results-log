2025-01-19 16:10:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 16:11:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 16:11:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 16:11:40 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:40 - root - INFO - SQL:
SELECT DISTINCT "calendar_year"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Results:
calendar_year
2020
2019
2018

2025-01-19 16:11:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-19 16:11:42 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:42 - root - INFO - SQL:
SELECT DISTINCT "month_number"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" IN (2018, 2019, 2020)
   LIMIT 1000;
Results:
month_number
8
7
6
5
4
3
9

2025-01-19 16:11:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-19 16:11:43 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:44 - root - INFO - SQL:
SELECT DISTINCT "week_number"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018
   LIMIT 1000;
Results:
week_number
36
35
34
33
31
30
29
27
26
25
24
22
20
18
32
19
16
15
14
13
28
23
21
17

2025-01-19 16:11:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-19 16:11:45 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:46 - root - INFO - SQL:
SELECT DISTINCT "week_date"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "month_number" = 6
   LIMIT 1000;
Results:
week_date
2018-06-25
2018-06-18
2018-06-11
2018-06-04

2025-01-19 16:11:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 16:11:47 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:48 - root - INFO - SQL:
SELECT "week_date", "sales"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "week_number" BETWEEN 20 AND 24
   LIMIT 1000;
Results:
Too long, hard cut:
week_date,sales
2018-06-11,8872
2018-06-11,599428
2018-06-11,3376
2018-06-11,9067
2018-06-11,1106388
2018-06-11,11342
2018-06-11,26129
2018-06-11,4981850
2018-06-11,2503852
2018-06-11,7784
2018-06-11,37087
2018-06-11,21396
2018-06-11,25158
2018-06-11,11434
2018-06-11,5089
2018-06-11,13407541
2018-06-11,147672
2018-06-11,2295726
2018-06-11,4348
2018-06-11,24241
2018-06-11,75934
2018-06-11,16319647
2018-06-11,28537
2018-06-11,10046
2018-06-11,425176
2018-06-11,18162
2018-06-11,3833
2018-06-11,315
2018-06-11,1112686
2018-06-11,18746
2018-06-11,7553
2018-06-11,14155
2018-06-11,204864
2018-06-11,20648
2018-06-11,6992
2018-06-11,874977
2018-06-11,8892
2018-06-11,19120
2018-06-11,45937
2018-06-11,590874
2018-06-11,2823
2018-06-11,4747642
2018-06-11,1474258
2018-06-11,1661208
2018-06-11,2025226
2018-06-11,1057265
2018-06-11,872544
2018-06-11,194891
2018-06-11,4783369
2018-06-11,16698
2018-06-11,692614
2018-06-11,6065268
2018-06-11,29761
2018-06-11,670490
2018-06-11,33556
2018-06-11,2042
2018-06-11,21615
2018-06-11,2239999
2018-06-11,5229
2018-06-11,406698
2018-06-11,24213
2018-06-11,2869364
2018-06-11,818381
2018-06-11,3629615
2018-06-11,1344116
2018-06-11,2641
2018-06-11,16338668
2018-06-11,466471
2018-06-11,457686
2018-06-11,1807
2018-06-11,8089459
2018-06-11,3188543
2018-06-11,8956
2018-06-11,34876
2018-06-11,57675
2018-06-11,5976020
2018-06-11,1263
2018-06-11,4653781
2018-06-11,1083
2018-06-11,2172474
2018-06-11,675764
2018-06-11,70884
2018-06-11,13818746
2018-06-11,29083
2018-06-11,866655
2018-06-11,127191
2018-06-11,247971
2018-06-11,370955
2018-06-11,43580
2018-06-11,973450
2018-06-11,2601253
2018-06-11,42687
2018-06-11,643833
2018-06-11,17298594
2018-06-11,103002
2018-06-11,8950657
2018-06-11,3521233
2018-06-11,1238
2018-06-11,3015554
2018-06-11,3735576
2018-06-11,2364447
2018-06-11,5083
2018-06-11,2582650
2018-06-11,2594216
2018-06-11,782355
2018-06-11,22862
2018-06-11,36422
2018-06-11,863137
2018-06-11,1025535
2018-06-11,3688874
2018-06-11,3451215
2018-06-11,45457692
2018-06-11,1447
2018-06-11,1869959
2018-06-11,424744
2018-06-11,9492
2018-06-11,1657858
2018-06-11,292720
2018-06-11,395095
2018-06-11,281396
2018-06-11,5154
2018-06-11,1398343
2018-06-11,3997517
2018-06-11,12219442
2018-06-11,183079
2018-06-11,8844241
2018-06-11,41795
2018-06-11,288966
2018-06-11,59992
2018-06-11,67957
2018-06-11,949969
2018-06-11,200527
2018-06-11,11731
2018-06-11,80675
2018-06-11,974570
2018-06-11,2270402
2018-06-11,5297231
2018-06-11,516
2018-06-11,29603
2018-06-11,11943362
2018-06-11,168689
2018-06-11,72259
2018-06-11,1674382
2018-06-11,78217
2018-06-11,6610714
2018-06-11,27898
2018-06-11,42154
2018-06-11,317882
2018-06-11,141389
2018-06-11,474
2018-06-11,11700
2018-06-11,107708
2018-06-11,1097916
2018-06-11,12869
2018-06-11,42898
2018-06-11,3862038
2018-06-11,3773700
2018-06-11,101267
2018-06-11,191115
2018-06-11,1982463
2018-06-11,1788
2018-06-11,140018
2018-06-11,554435
2018-06-11,18888
2018-06-11,176422
2018-06-11,45941
2018-06-11,20798
2018-06-11,46374089
2018-06-11,62744987
2018-06-11,20499
2018-06-11,499003
2018-06-11,264516
2018-06-11,66093
2018-06-11,4283
2018-06-11,7584275
2018-06-11,63701
2018-06-11,165
2018-06-11,1131
2018-06-11,1405097
2018-06-11,2308082
2018-06-11,56029
2018-06-11,263917
2018-06-11,61774
2018-06-11,25171
2018-06-11,24975
2018-06-11,2750
2018-06-11,410843
2018-06-11,4688696
2018-06-11,18580
2018-06-11,179999
2018-06-11,27988
2018-06-11,35506
2018-06-11,2103267
2018-06-11,5275148
2018-06-11,76242
2018-06-11,10712
2018-06-11,9776
2018-06-11,24734
2018-06-11,32038
2018-06-11,505429
2018-06-11,560894
2018-06-11,233158
2018-06-11,55002
2018-06-11,19258180
2018-06-11,274177
2018-06-11,15710
2018-06-11,8679
2018-06-11,1230114
2018-06-11,15294732
2018-06-11,25171
2018-06-11,505170
2018-06-11,864993
2018-06-11,87193
2018-06-11,14242
2018-06-11,2111113
2018-06-11,22006
2018-06-11,247
2018-06-11,1679258
2018-06-11,179446
2018-06-11,4494744
2018-06-11,789593
2018-06-11,3935578
2018-06-11,26016926
2018-06-11,190429
2018-06-11,34453
2018-06-11,3855
2018-06-11,71480
2018-06-11,7059
2018-06-11,809932
2018-06-11,48298
2018-06-11,295585
2018-06-11,2270
2018-06-11,319
2018-06-11,1326
2018-06-11,15372
2018-06-11,1391101
2018-06-11,191428
2018-06-11,99690
2018-06-04,856954
2018-06-04,17430358
2018-06-04,90749
2018-06-04,338624
2018-06-04,608
2018-06-04,11888324
2018-06-04,3860699
2018-06-04,3156
2018-06-04,4119
2018-06-04,1611020
2018-06-04,193013
2018-06-04,304043
2018-06-04,20111
2018-06-04,190508
2018-06-04,8557
2018-06-04,479062
2018-06-04,660944
2018-06-04,46330
2018-06-04,3278
2018-06-04,208182
2018-06-04,25295650
2018-06-04,27450
2018-06-04,102197
2018-06-04,383314
2018-06-04,574447
2018-06-04,9098
2018-06-04,68874
2018-06-04,2129350
2018-06-04,19407
2018-06-04,324667
2018-06-04,52156
2018-06-04,3658363
2018-06-04,18960302
2018-06-04,35244
2018-06-04,12739
2018-06-04,3090
2018-06-04,4528994
2018-06-04,965704
2018-06-04,1152276
2018-06-04,40963
2018-06-04,1061363
2018-06-04,550332
2018-06-04,16291305
2018-

2025-01-19 16:11:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 951
2025-01-19 16:11:49 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:49 - root - INFO - SQL:
SELECT "week_date", "sales"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "week_number" BETWEEN 25 AND 28
   LIMIT 1000;
Results:
Too long, hard cut:
week_date,sales
2018-07-09,611498
2018-07-09,5804
2018-07-09,531748
2018-07-09,1710131
2018-07-09,889598
2018-07-09,2408783
2018-07-09,31570
2018-07-09,12572
2018-07-09,4461407
2018-07-09,2546080
2018-07-09,1237
2018-07-09,1674187
2018-07-09,1235
2018-07-09,200206
2018-07-09,5188811
2018-07-09,2117864
2018-07-09,30757
2018-07-09,264131
2018-07-09,7961322
2018-07-09,333013
2018-07-09,10557
2018-07-09,451747
2018-07-09,779550
2018-07-09,3806530
2018-07-09,3338
2018-07-09,3380597
2018-07-09,207605
2018-07-09,210058
2018-07-09,38605
2018-07-09,76776
2018-07-09,180535
2018-07-09,5071
2018-07-09,324744
2018-07-09,73310
2018-07-09,18004456
2018-07-09,140580
2018-07-09,32308
2018-07-09,16029504
2018-07-09,25436
2018-07-09,198223
2018-07-09,951606
2018-07-09,2548126
2018-07-09,20215
2018-07-09,258847
2018-07-09,863477
2018-07-09,4734536
2018-07-09,47302
2018-07-09,1790957
2018-07-09,12422253
2018-07-09,372186
2018-07-09,517187
2018-07-09,16833185
2018-07-09,1291
2018-07-09,470909
2018-07-09,22621
2018-07-09,47624
2018-07-09,1128536
2018-07-09,18224
2018-07-09,32258
2018-07-09,27440
2018-07-09,1434
2018-07-09,16874
2018-07-09,8568
2018-07-09,383680
2018-07-09,20626
2018-07-09,581726
2018-07-09,1204045
2018-07-09,1458823
2018-07-09,1472
2018-07-09,69898
2018-07-09,36377
2018-07-09,2437629
2018-07-09,7447
2018-07-09,612225
2018-07-09,860
2018-07-09,825106
2018-07-09,8774
2018-07-09,5029330
2018-07-09,11986225
2018-07-09,881
2018-07-09,305470
2018-07-09,322780
2018-07-09,689909
2018-07-09,11682
2018-07-09,4124
2018-07-09,69526
2018-07-09,30488
2018-07-09,43146
2018-07-09,49181
2018-07-09,3997972
2018-07-09,48524433
2018-07-09,101988
2018-07-09,78363
2018-07-09,46808
2018-07-09,5777
2018-07-09,919591
2018-07-09,13964
2018-07-09,28635
2018-07-09,78100
2018-07-09,2147156
2018-07-09,8367
2018-07-09,108038
2018-07-09,484976
2018-07-09,13705869
2018-07-09,7434676
2018-07-09,80423
2018-07-09,999840
2018-07-09,4352434
2018-07-09,3549
2018-07-09,2535291
2018-07-09,857384
2018-07-09,4571
2018-07-09,220
2018-07-09,281581
2018-07-09,132799
2018-07-09,190786
2018-07-09,20623
2018-07-09,33683
2018-07-09,19944730
2018-07-09,1624945
2018-07-09,152455
2018-07-09,24251
2018-07-09,12194
2018-07-09,966445
2018-07-09,46812
2018-07-09,3692500
2018-07-09,15584
2018-07-09,2965223
2018-07-09,2903
2018-07-09,2648013
2018-07-09,51186
2018-07-09,938
2018-07-09,18022
2018-07-09,6734
2018-07-09,7935
2018-07-09,6524
2018-07-09,1318737
2018-07-09,2241653
2018-07-09,64744769
2018-07-09,304731
2018-07-09,1027770
2018-07-09,6309
2018-07-09,34155
2018-07-09,2343
2018-07-09,10420
2018-07-09,2023172
2018-07-09,142366
2018-07-09,1371394
2018-07-09,4053481
2018-07-09,946
2018-07-09,1442609
2018-07-09,152795
2018-07-09,25824442
2018-07-09,24824
2018-07-09,20725
2018-07-09,5322402
2018-07-09,29500
2018-07-09,4914862
2018-07-09,8876740
2018-07-09,1676625
2018-07-09,14545900
2018-07-09,54203
2018-07-09,64589
2018-07-09,10381
2018-07-09,477
2018-07-09,1480
2018-07-09,28183
2018-07-09,6639593
2018-07-09,29061
2018-07-09,2265833
2018-07-09,9909
2018-07-09,424136
2018-07-09,4927
2018-07-09,1113254
2018-07-09,6175153
2018-07-09,37853
2018-07-09,27732
2018-07-09,836125
2018-07-09,8388
2018-07-09,110493
2018-07-09,1081553
2018-07-09,22076
2018-07-09,2187703
2018-07-09,61961
2018-07-09,2820253
2018-07-09,3309803
2018-07-09,37964
2018-07-09,272201
2018-07-09,543196
2018-07-09,195890
2018-07-09,292606
2018-07-09,16913687
2018-07-09,36222
2018-07-09,7665
2018-07-09,1763892
2018-07-09,13931
2018-07-09,6618
2018-07-09,9622439
2018-07-09,2178409
2018-07-09,6581
2018-07-09,24725
2018-07-09,72925
2018-07-09,70702
2018-07-09,18037
2018-07-09,8314
2018-07-09,4872679
2018-07-09,26862
2018-07-09,17294
2018-07-09,114144
2018-07-09,84094
2018-07-09,12867
2018-07-09,329394
2018-07-09,209062
2018-07-09,593992
2018-07-09,200194
2018-07-09,3590357
2018-07-09,130
2018-07-09,48362188
2018-07-09,5962158
2018-07-09,3471373
2018-07-09,1080786
2018-07-09,395419
2018-07-09,183106
2018-07-09,3737094
2018-07-09,2477712
2018-07-09,24155
2018-07-09,929240
2018-07-09,950
2018-07-09,42746
2018-07-09,822964
2018-07-09,542330
2018-07-09,4286062
2018-07-09,27277
2018-07-09,404799
2018-07-09,659369
2018-07-09,3658
2018-07-09,61327
2018-07-09,65359
2018-07-02,61516
2018-07-02,417290
2018-07-02,311
2018-07-02,58179
2018-07-02,20606
2018-07-02,8640
2018-07-02,1103996
2018-07-02,2261211
2018-07-02,16067
2018-07-02,3976
2018-07-02,595119
2018-07-02,35136
2018-07-02,4940
2018-07-02,9579773
2018-07-02,2101076
2018-07-02,10932
2018-07-02,10532
2018-07-02,1028
2018-07-02,1458781
2018-07-02,34843
2018-07-02,3594
2018-07-02,72197
2018-07-02,17549
2018-07-02,2488231
2018-07-02,1064605
2018-07-02,114424
2018-07-02,972231
2018-07-02,21479
2018-07-02,2060
2018-07-02,9815
2018-07-02,150798
2018-07-02,8538
2018-07-02,3391
2018-07-02,1738
2018-07-02,312208
2018-07-02,58519
2018-07-02,12400256
2018-07-02,90096
2018-07-02,1668196
2018-07-02,36824
2018-07-02,29844
2018-07-02,378137
2018-07-02,805
2018-07-02,72772
2018-07-02,8

2025-01-19 16:11:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-19 16:11:50 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:51 - root - INFO - SQL:
SELECT DISTINCT "platform"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Results:
platform
Retail
Shopify

2025-01-19 16:11:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-19 16:11:52 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:53 - root - INFO - SQL:
SELECT DISTINCT "region"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Results:
region
ASIA
USA
EUROPE
AFRICA
CANADA
SOUTH AMERICA
OCEANIA

2025-01-19 16:11:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-19 16:11:54 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:55 - root - INFO - SQL:
SELECT DISTINCT "age_band"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Results:
age_band
Retirees
Young Adults
Middle Aged
unknown

2025-01-19 16:11:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 16:11:56 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:56 - root - INFO - SQL:
SELECT DISTINCT "demographic"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
Results:
demographic
Couples
Families
unknown

2025-01-19 16:11:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:11:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 16:11:58 - snowflake.connector.connection - INFO - closed
2025-01-19 16:11:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:11:58 - root - INFO - SQL:
SELECT "week_date", "sales", "transactions"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1000;
Results:
Too long, hard cut:
week_date,sales,transactions
2020-08-31,3656163,120631
2020-08-31,996575,31574
2020-08-31,16509610,529151
2020-08-31,141942,4517
2020-08-31,1758388,58046
2020-08-31,243878,1336
2020-08-31,519502,2514
2020-08-31,371417,2158
2020-08-31,49557,318
2020-08-31,3888162,111032
2020-08-31,260773,1398
2020-08-31,882690,4661
2020-08-31,38762,1029
2020-08-31,917,6
2020-08-31,35215,115
2020-08-31,30371770,551905
2020-08-31,374327,1969
2020-08-31,5185233,97604
2020-08-31,2980673,111219
2020-08-31,463738,11820
2020-08-31,65730,1363
2020-08-31,14430196,284971
2020-08-31,2176980,70496
2020-08-31,478756,2678
2020-08-31,3319,22
2020-08-31,5306746,94274
2020-08-31,4511841,94287
2020-08-31,134249,3064
2020-08-31,1579,7
2020-08-31,11451,329
2020-08-31,31589,854
2020-08-31,53567,180
2020-08-31,4023,15
2020-08-31,4768214,112361
2020-08-31,396909,2269
2020-08-31,8562,58
2020-08-31,8723663,142898
2020-08-31,957939,4703
2020-08-31,7625,40
2020-08-31,20635,164
2020-08-31,2265,20
2020-08-31,633917,14583
2020-08-31,72293,452
2020-08-31,13839,382
2020-08-31,68009,1503
2020-08-31,269176,7033
2020-08-31,10874,329
2020-08-31,1306932,24153
2020-08-31,3507,15
2020-08-31,1144376,18676
2020-08-31,3325,19
2020-08-31,15074,87
2020-08-31,1473178,29577
2020-08-31,1369115,41631
2020-08-31,20255591,402652
2020-08-31,48773122,1936351
2020-08-31,55780,413
2020-08-31,554,4
2020-08-31,2126153,43493
2020-08-31,6603287,169157
2020-08-31,1026838,5893
2020-08-31,11086427,245151
2020-08-31,19049,119
2020-08-31,564306,2983
2020-08-31,7331,32
2020-08-31,2272687,40076
2020-08-31,1562,7
2020-08-31,12836,88
2020-08-31,1548637,46545
2020-08-31,45518,228
2020-08-31,37786,1045
2020-08-31,48624,279
2020-08-31,2156778,66042
2020-08-31,5941067,117018
2020-08-31,395877,6769
2020-08-31,22712143,403810
2020-08-31,16149,74
2020-08-31,3322211,61517
2020-08-31,66422,1655
2020-08-31,27184,201
2020-08-31,979807,5794
2020-08-31,833470,23416
2020-08-31,7178808,144056
2020-08-31,7422165,151673
2020-08-31,91616,585
2020-08-31,661362,18180
2020-08-31,786613,30402
2020-08-31,11755,69
2020-08-31,883573,26620
2020-08-31,2232935,58165
2020-08-31,12438,97
2020-08-31,8473,37
2020-08-31,104677,2857
2020-08-31,2016930,65594
2020-08-31,461694,9710
2020-08-31,1221,3
2020-08-31,95547,567
2020-08-31,990085,36069
2020-08-31,10624187,220712
2020-08-31,2078649,11218
2020-08-31,33536,205
2020-08-31,35957,299
2020-08-31,40760,953
2020-08-31,8917,45
2020-08-31,154393,846
2020-08-31,2393490,57648
2020-08-31,3288,21
2020-08-31,1437,9
2020-08-31,30264,190
2020-08-31,530397,2647
2020-08-31,2494,21
2020-08-31,3101538,91435
2020-08-31,158799,3843
2020-08-31,1096531,28987
2020-08-31,35519,245
2020-08-31,16520774,339633
2020-08-31,45036,182
2020-08-31,126801,659
2020-08-31,56734,340
2020-08-31,6218547,187781
2020-08-31,1373529,6870
2020-08-31,3964262,172521
2020-08-31,14694,105
2020-08-31,690966,19524
2020-08-31,1520060,53286
2020-08-31,52421,2466
2020-08-31,3352338,97001
2020-08-31,6107,36
2020-08-31,402380,2031
2020-08-31,14910405,277600
2020-08-31,25858,157
2020-08-31,4085,20
2020-08-31,481198,2801
2020-08-31,11133538,396145
2020-08-31,1063716,28592
2020-08-31,1001335,23062
2020-08-31,63989387,2437738
2020-08-31,79359,343
2020-08-31,836865,3920
2020-08-31,67279,384
2020-08-31,11863,329
2020-08-31,72565,1738
2020-08-31,3749562,110894
2020-08-31,40740,196
2020-08-31,5786447,102736
2020-08-31,250536,4652
2020-08-31,2056315,50786
2020-08-31,372,3
2020-08-31,136743,731
2020-08-31,16103,115
2020-08-31,407861,2172
2020-08-31,10501,63
2020-08-31,451994,13579
2020-08-31,29757,164
2020-08-31,125653,726
2020-08-31,35572,247
2020-08-31,35314,277
2020-08-31,83877,507
2020-08-31,2819145,132545
2020-08-31,2770220,89785
2020-08-31,224778,1083
2020-08-31,210754,1282
2020-08-31,51883,300
2020-08-31,15077,100
2020-08-31,18437,414
2020-08-31,472,3
2020-08-31,411147,8410
2020-08-31,55333,249
2020-08-31,85926,3087
2020-08-31,20927,122
2020-08-31,1657269,37883
2020-08-31,6147,46
2020-08-31,4894437,110176
2020-08-31,44346247,1547309
2020-08-31,839437,4498
2020-08-31,134990,789
2020-08-31,23057,109
2020-08-31,49263,1352
2020-08-31,1493771,38663
2020-08-31,57455,389
2020-08-31,561282,14685
2020-08-31,930478,22186
2020-08-31,132424,842
2020-08-31,20860,135
2020-08-31,6891042,186404
2020-08-31,269373,1689
2020-08-31,16755039,413244
2020-08-31,33200,228
2020-08-31,9284850,260181
2020-08-31,887564,14482
2020-08-31,27732,118
2020-08-31,2423159,97673
2020-08-31,15927,113
2020-08-31,44500,1266
2020-08-31,623,6
2020-08-31,1769576,46838
2020-08-31,665292,18774
2020-08-31,2186307,40024
2020-08-31,277104,1420
2020-08-31,2234801,87269
2020-08-31,25762,154
2020-08-31,312519,1501
2020-08-31,4971,22
2020-08-31,3227065,62206
2020-08-31,269863,1621
2020-08-31,2291992,65304
2020-08-31,150741,3211
2020-08-31,46931,278
2020-08-31,30015,138
2020-08-31,5527494,96079
2020-08-31,128749,739
2020-08-31,48912,1098
2020-08-31,2829225,83764
2020-08-31,815588,14816
2020-08-31,471837,2568
2020-08-31,372983,1916
2020-08-31,48796,333
2020-08-31,25570,906
2020-08-

2025-01-19 16:11:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:11:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:11:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:12:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 16:12:00 - snowflake.connector.connection - INFO - closed
2025-01-19 16:12:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:12:00 - root - INFO - SQL:
SELECT DISTINCT "customer_type"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
Results:
customer_type
New
Guest
Existing

2025-01-19 16:12:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:12:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:12:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:12:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-19 16:12:02 - snowflake.connector.connection - INFO - closed
2025-01-19 16:12:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:12:02 - root - INFO - SQL:
SELECT "week_number", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2018
    GROUP BY "week_number"
    ORDER BY "week_number"
    LIMIT 1000;
Results:
week_number,total_sales
13,536755452
14,541167115
15,529574544
16,526355503
17,536075195
18,539632290
19,534072854
20,527788555
21,522377362
22,544417653
23,525086015
24,533259779
25,524368733
26,525737676
27,532366710
28,546769795
29,541086855
30,547653578
31,539321534
32,549636536
33,543535235
34,544330787
35,553039709
36,552971362

2025-01-19 16:12:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:12:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:12:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:12:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-19 16:12:03 - snowflake.connector.connection - INFO - closed
2025-01-19 16:12:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:12:04 - root - INFO - SQL:
SELECT "month_number", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2018
    GROUP BY "month_number"
    ORDER BY "month_number"
    LIMIT 1000;
Results:
month_number,total_sales
3,536755452
4,2672804647
5,2128656424
6,2108452203
7,2707198472
8,2190542267
9,552971362

2025-01-19 16:12:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:12:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:12:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:12:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 16:12:05 - snowflake.connector.connection - INFO - closed
2025-01-19 16:12:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:12:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 16:12:57 - root - INFO - ```sql
SELECT "week_date", "sales"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
WHERE "month_number" = 6
LIMIT 1000;
```
2025-01-19 16:12:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:12:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:12:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:12:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 16:12:59 - snowflake.connector.connection - INFO - closed
2025-01-19 16:12:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:12:59 - root - INFO - SQL:
SELECT "week_date", "sales"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
WHERE "month_number" = 6
LIMIT 1000;
Results:
Too long, hard cut:
week_date,sales
2020-06-29,771649
2020-06-29,248186
2020-06-29,41232
2020-06-29,746
2020-06-29,17430
2020-06-29,28788145
2020-06-29,357156
2020-06-29,3222249
2020-06-29,83692
2020-06-29,6219
2020-06-29,339336
2020-06-29,18485
2020-06-29,2033692
2020-06-29,31393
2020-06-29,2509564
2020-06-29,865
2020-06-29,22101960
2020-06-29,8563
2020-06-29,2444
2020-06-29,1753657
2020-06-29,16297956
2020-06-29,31008
2020-06-29,40816
2020-06-29,2311
2020-06-29,5151347
2020-06-29,47898629
2020-06-29,137746
2020-06-29,474829
2020-06-29,1142258
2020-06-29,3387378
2020-06-29,337
2020-06-29,15402
2020-06-29,473733
2020-06-29,32127
2020-06-29,3372
2020-06-29,621849
2020-06-29,10224
2020-06-29,1283298
2020-06-29,38761
2020-06-29,32575
2020-06-29,2069075
2020-06-29,3518
2020-06-29,957978
2020-06-29,4328
2020-06-29,261
2020-06-29,5126468
2020-06-29,818184
2020-06-29,49917
2020-06-29,194204
2020-06-29,137468
2020-06-29,2312994
2020-06-29,16476365
2020-06-29,47122
2020-06-29,4820666
2020-06-29,6426709
2020-06-29,2353412
2020-06-29,8766
2020-06-29,808388
2020-06-29,1983459
2020-06-29,26020
2020-06-29,1953580
2020-06-29,493184
2020-06-29,2359
2020-06-29,549
2020-06-29,3613601
2020-06-29,1229
2020-06-29,1039
2020-06-29,315699
2020-06-29,81944
2020-06-29,5970777
2020-06-29,471006
2020-06-29,1478098
2020-06-29,48331
2020-06-29,82717
2020-06-29,11041636
2020-06-29,6042
2020-06-29,71681
2020-06-29,17908
2020-06-29,11034700
2020-06-29,5366430
2020-06-29,6235333
2020-06-29,418206
2020-06-29,34465
2020-06-29,46263
2020-06-29,38169
2020-06-29,645361
2020-06-29,5232
2020-06-29,4591704
2020-06-29,4686381
2020-06-29,346893
2020-06-29,63043806
2020-06-29,74791
2020-06-29,1605875
2020-06-29,11368
2020-06-29,868246
2020-06-29,44246
2020-06-29,159886
2020-06-29,136777
2020-06-29,18645
2020-06-29,871802
2020-06-29,1342126
2020-06-29,36681
2020-06-29,7451077
2020-06-29,5765543
2020-06-29,115232
2020-06-29,25006
2020-06-29,25758
2020-06-29,60231
2020-06-29,691104
2020-06-29,80500
2020-06-29,1693971
2020-06-29,4991052
2020-06-29,15236
2020-06-29,2205239
2020-06-29,2773702
2020-06-29,12326
2020-06-29,27727
2020-06-29,134236
2020-06-29,19047003
2020-06-29,1337460
2020-06-29,1403
2020-06-29,20922
2020-06-29,3597624
2020-06-29,14711185
2020-06-29,3217134
2020-06-29,10114
2020-06-29,1469626
2020-06-29,777148
2020-06-29,3648
2020-06-29,1052
2020-06-29,6210
2020-06-29,59917
2020-06-29,257850
2020-06-29,9157
2020-06-29,1445099
2020-06-29,57267
2020-06-29,12589
2020-06-29,4722
2020-06-29,20418
2020-06-29,137688
2020-06-29,26191
2020-06-29,38634
2020-06-29,241820
2020-06-29,786690
2020-06-29,1778357
2020-06-29,5292
2020-06-29,16778
2020-06-29,44574827
2020-06-29,241198
2020-06-29,423284
2020-06-29,2316291
2020-06-29,16411
2020-06-29,2795126
2020-06-29,446915
2020-06-29,1716
2020-06-29,10231
2020-06-29,2377430
2020-06-29,12155
2020-06-29,24314
2020-06-29,73349
2020-06-29,74011
2020-06-29,301370
2020-06-29,43148
2020-06-29,425189
2020-06-29,522
2020-06-29,89148
2020-06-29,646402
2020-06-29,10023093
2020-06-29,171759
2020-06-29,43036
2020-06-29,327256
2020-06-29,70075
2020-06-29,7345
2020-06-29,15140
2020-06-29,20018
2020-06-29,2172470
2020-06-29,64023
2020-06-29,1122634
2020-06-29,116461
2020-06-29,46236
2020-06-29,925527
2020-06-29,2622381
2020-06-29,450734
2020-06-29,7586276
2020-06-29,274806
2020-06-29,225451
2020-06-29,977652
2020-06-29,98965
2020-06-29,112042
2020-06-29,1006688
2020-06-29,47204
2020-06-29,109276
2020-06-29,2606202
2020-06-29,611536
2020-06-29,527320
2020-06-29,49839
2020-06-29,970952
2020-06-29,6755547
2020-06-29,18995
2020-06-29,353939
2020-06-29,5279
2020-06-29,38068
2020-06-29,4830448
2020-06-29,1653
2020-06-29,411142
2020-06-29,8957686
2020-06-29,18095
2020-06-29,11888
2020-06-29,824649
2020-06-29,2254122
2020-06-29,759575
2020-06-29,112466
2020-06-29,418727
2020-06-29,1066
2020-06-29,2095525
2020-06-29,16219267
2020-06-29,26223
2020-06-29,2271507
2020-06-29,393315
2020-06-29,887139
2020-06-29,8452
2020-06-29,865037
2020-06-29,90369
2020-06-29,20393
2020-06-29,652292
2020-06-29,61210
2020-06-29,14395106
2020-06-29,17149423
2020-06-29,3508936
2020-06-29,247362
2020-06-29,28790
2020-06-29,972030
2020-06-29,851108
2020-06-29,26284
2020-06-29,1655880
2020-06-29,3883895
2020-06-29,362077
2020-06-29,8130575
2020-06-22,53111
2020-06-22,3287
2020-06-22,25281
2020-06-22,3481797
2020-06-22,249776
2020-06-22,737
2020-06-22,869867
2020-06-22,3941
2020-06-22,8857025
2020-06-22,7787
2020-06-22,2299491
2020-06-22,11595
2020-06-22,4780
2020-06-22,6514327
2020-06-22,347475
2020-06-22,13568
2020-06-22,279258
2020-06-22,237650
2020-06-22,14317
2020-06-22,1009206
2020-06-22,127033
2020-06-22,659
2020-06-22,14002069
2020-06-22,374786
2020-06-22,564571
2020-06-22,97556
2020-06-22,7521785
2020-06-22,1006442
2020-06-22,16769158
2020-06-22,27011
2020-06-22,5827
2020-06-22,136838
2020-06-22,2243252
2020-06-22,1781302
2020-06-22,642126
2020-06-22,5042513
2020-06-22,3528540
2020-06-22,1280
2020-06-22,6056934
2020-06-22,19188715
2020-06-22,1268637
2020-06-22,893516
2020-

2025-01-19 16:12:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:12:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:12:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:13:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 952
2025-01-19 16:13:01 - snowflake.connector.connection - INFO - closed
2025-01-19 16:13:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:13:01 - root - INFO - SQL:
SELECT "week_date_formatted", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2019 AND "month_number" = 6
    LIMIT 1000;
Results:
Too long, hard cut:
week_date_formatted,sales
2019-6-24,1301640
2019-6-24,38925
2019-6-24,2282
2019-6-24,4120633
2019-6-24,626993
2019-6-24,379135
2019-6-24,4297399
2019-6-24,3636107
2019-6-24,6987
2019-6-24,7186507
2019-6-24,43709
2019-6-24,29716
2019-6-24,15236876
2019-6-24,1363972
2019-6-24,26159
2019-6-24,366286
2019-6-24,353815
2019-6-24,3362183
2019-6-24,762452
2019-6-24,59759
2019-6-24,10818
2019-6-24,5090780
2019-6-24,7186
2019-6-24,134166
2019-6-24,46157461
2019-6-24,596944
2019-6-24,68575
2019-6-24,13486347
2019-6-24,28660
2019-6-24,63910100
2019-6-24,5386709
2019-6-24,14340
2019-6-24,1975871
2019-6-24,9876451
2019-6-24,5637102
2019-6-24,97836
2019-6-24,34913
2019-6-24,15998108
2019-6-24,371572
2019-6-24,39282
2019-6-24,2195234
2019-6-24,681655
2019-6-24,9276
2019-6-24,51360
2019-6-24,42041
2019-6-24,80009
2019-6-24,111072
2019-6-24,79204
2019-6-24,5831730
2019-6-24,2285350
2019-6-24,34267
2019-6-24,207395
2019-6-24,11262
2019-6-24,14791
2019-6-24,3296302
2019-6-24,22084
2019-6-24,385102
2019-6-24,2172241
2019-6-24,13052
2019-6-24,7527
2019-6-24,79
2019-6-24,199341
2019-6-24,22458
2019-6-24,2280355
2019-6-24,1383
2019-6-24,8277287
2019-6-24,339671
2019-6-24,11236
2019-6-24,98149
2019-6-24,28956
2019-6-24,252759
2019-6-24,7003237
2019-6-24,528835
2019-6-24,4990
2019-6-24,819
2019-6-24,904576
2019-6-24,13304072
2019-6-24,269805
2019-6-24,254092
2019-6-24,16247
2019-6-24,30302
2019-6-24,1521
2019-6-24,50350
2019-6-24,1092730
2019-6-24,12851
2019-6-24,8881
2019-6-24,119139
2019-6-24,74609
2019-6-24,3111
2019-6-24,2903459
2019-6-24,454543
2019-6-24,43744
2019-6-24,40182
2019-6-24,180945
2019-6-24,260944
2019-6-24,165813
2019-6-24,45318
2019-6-24,30885
2019-6-24,34047
2019-6-24,325971
2019-6-24,78104
2019-6-24,17748
2019-6-24,30919
2019-6-24,29341
2019-6-24,936783
2019-6-24,33356
2019-6-24,6203020
2019-6-24,1606206
2019-6-24,1106600
2019-6-24,2038581
2019-6-24,331054
2019-6-24,13062
2019-6-24,423558
2019-6-24,161060
2019-6-24,1573
2019-6-24,98552
2019-6-24,1889005
2019-6-24,1339183
2019-6-24,77965
2019-6-24,54372
2019-6-24,5155499
2019-6-24,25259
2019-6-24,139275
2019-6-24,558825
2019-6-24,2401628
2019-6-24,374335
2019-6-24,937431
2019-6-24,227420
2019-6-24,65290
2019-6-24,77177
2019-6-24,2322229
2019-6-24,2266154
2019-6-24,47403019
2019-6-24,678251
2019-6-24,268778
2019-6-24,31537
2019-6-24,15989275
2019-6-24,17465369
2019-6-24,32192
2019-6-24,4430301
2019-6-24,6042
2019-6-24,15396
2019-6-24,825219
2019-6-24,1067558
2019-6-24,636987
2019-6-24,1487138
2019-6-24,33328
2019-6-24,27380003
2019-6-24,1077203
2019-6-24,43701
2019-6-24,3462668
2019-6-24,2132
2019-6-24,31733
2019-6-24,4439938
2019-6-24,10313
2019-6-24,2944409
2019-6-24,72960
2019-6-24,58796
2019-6-24,483558
2019-6-24,20118
2019-6-24,1822
2019-6-24,321450
2019-6-24,108331
2019-6-24,141218
2019-6-24,382
2019-6-24,17222
2019-6-24,2473119
2019-6-24,805444
2019-6-24,192558
2019-6-24,569667
2019-6-24,33593
2019-6-24,7980239
2019-6-24,514
2019-6-24,630673
2019-6-24,5786
2019-6-24,40501
2019-6-24,613538
2019-6-24,76971
2019-6-24,48183
2019-6-24,814075
2019-6-24,3659716
2019-6-24,629420
2019-6-24,11860068
2019-6-24,927888
2019-6-24,3859
2019-6-24,102518
2019-6-24,4950491
2019-6-24,1913960
2019-6-24,17898
2019-6-24,41892
2019-6-24,14615
2019-6-24,1715401
2019-6-24,2367141
2019-6-24,391920
2019-6-24,2602
2019-6-24,32096
2019-6-24,288081
2019-6-24,414324
2019-6-24,14652
2019-6-24,3322265
2019-6-24,17784
2019-6-24,17363845
2019-6-24,9185423
2019-6-24,481
2019-6-24,19942
2019-6-24,1902952
2019-6-24,237753
2019-6-24,665201
2019-6-24,5229722
2019-6-24,2640336
2019-6-24,180198
2019-6-24,118445
2019-6-24,58233
2019-6-24,2838049
2019-6-24,1555
2019-6-24,4322941
2019-6-24,1314925
2019-6-24,2145
2019-6-24,32290
2019-6-24,1014969
2019-6-24,977138
2019-6-24,1324704
2019-6-24,282794
2019-6-24,52237
2019-6-24,922473
2019-6-24,2529
2019-6-24,87042
2019-6-24,1632734
2019-6-24,4668
2019-6-24,35202
2019-6-24,4190
2019-6-24,797430
2019-6-24,12364
2019-6-24,5870
2019-6-24,11825
2019-6-24,11653
2019-6-24,20620650
2019-6-24,3144220
2019-6-17,811432
2019-6-17,24598
2019-6-17,2413656
2019-6-17,275978
2019-6-17,312146
2019-6-17,44036
2019-6-17,46733
2019-6-17,103287
2019-6-17,2022689
2019-6-17,2284775
2019-6-17,1494465
2019-6-17,5658271
2019-6-17,32921
2019-6-17,1146718
2019-6-17,501760
2019-6-17,927994
2019-6-17,571097
2019-6-17,6237220
2019-6-17,369513
2019-6-17,3361043
2019-6-17,5830970
2019-6-17,12151
2019-6-17,2453
2019-6-17,372813
2019-6-17,17072
2019-6-17,16719
2019-6-17,19138
2019-6-17,2973532
2019-6-17,636176
2019-6-17,282290
2019-6-17,274875
2019-6-17,75408
2019-6-17,2598566
2019-6-17,83
2019-6-17,74168
2019-6-17,32962
2019-6-17,34458
2019-6-17,2846
2019-6-17,8407952
2019-6-17,57526
2019-6-17,481255
2019-6-17,72356
2019-6-17,1016803
2019-6-17,113989
2019-6-17,27874936
2019-6-17,21025
2019-6-17,38979
2019-6-17,203484
2019-6-17,2579386
2019-6-17,5411160
2019-6-17,271321
2019-6-17,11875557
2019-6-17,4475699
2019-6-17,1660327
2019-6-17,4142
2019-6-17,337175
2019-6-17,986630
2019-6-17,250339
20

2025-01-19 16:13:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:13:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:13:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:13:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-19 16:13:03 - snowflake.connector.connection - INFO - closed
2025-01-19 16:13:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:13:03 - root - INFO - SQL:
SELECT "region", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2020 AND "month_number" = 6
    GROUP BY "region"
    LIMIT 1000;
Results:
region,total_sales
OCEANIA,951984238
USA,277763625
SOUTH AMERICA,87360985
EUROPE,47351180
ASIA,658863091
CANADA,174745093
AFRICA,702340026

2025-01-19 16:13:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:13:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:13:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:13:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 951
2025-01-19 16:13:04 - snowflake.connector.connection - INFO - closed
2025-01-19 16:13:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:13:05 - root - INFO - SQL:
SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-06-01' AND '2018-06-30'
    LIMIT 1000;
Results:
Too long, hard cut:
week_date,sales
2018-06-25,4784320
2018-06-25,980247
2018-06-25,610184
2018-06-25,9058
2018-06-25,2430726
2018-06-25,4494
2018-06-25,411615
2018-06-25,1498072
2018-06-25,42924
2018-06-25,14335
2018-06-25,3053553
2018-06-25,3402800
2018-06-25,98731
2018-06-25,1539
2018-06-25,41931
2018-06-25,5977
2018-06-25,2303157
2018-06-25,4781297
2018-06-25,26129
2018-06-25,9957
2018-06-25,13031
2018-06-25,4080
2018-06-25,2306973
2018-06-25,413182
2018-06-25,17831
2018-06-25,12307
2018-06-25,20453
2018-06-25,77985
2018-06-25,24996545
2018-06-25,33563
2018-06-25,23649
2018-06-25,55407
2018-06-25,307
2018-06-25,2234500
2018-06-25,27885
2018-06-25,3347
2018-06-25,8297875
2018-06-25,793
2018-06-25,120340
2018-06-25,8577
2018-06-25,33831
2018-06-25,7356
2018-06-25,289806
2018-06-25,62243
2018-06-25,1626236
2018-06-25,163954
2018-06-25,75114
2018-06-25,8360
2018-06-25,57084
2018-06-25,7758
2018-06-25,1103704
2018-06-25,8636
2018-06-25,33131
2018-06-25,2547864
2018-06-25,577
2018-06-25,102674
2018-06-25,149138
2018-06-25,822356
2018-06-25,109946
2018-06-25,4242076
2018-06-25,10552
2018-06-25,7651
2018-06-25,184592
2018-06-25,1672173
2018-06-25,78511
2018-06-25,2849696
2018-06-25,26683
2018-06-25,8738789
2018-06-25,26824
2018-06-25,608274
2018-06-25,3499
2018-06-25,21378
2018-06-25,71114
2018-06-25,18917331
2018-06-25,27001
2018-06-25,186687
2018-06-25,495391
2018-06-25,198274
2018-06-25,23955
2018-06-25,362831
2018-06-25,180084
2018-06-25,73791
2018-06-25,70410
2018-06-25,17804
2018-06-25,886397
2018-06-25,7339088
2018-06-25,293192
2018-06-25,14113
2018-06-25,18254
2018-06-25,11552
2018-06-25,12842306
2018-06-25,2056991
2018-06-25,36666
2018-06-25,11898455
2018-06-25,3812138
2018-06-25,2995554
2018-06-25,20224
2018-06-25,680840
2018-06-25,15158401
2018-06-25,2203439
2018-06-25,31522
2018-06-25,9473
2018-06-25,181791
2018-06-25,45843
2018-06-25,257011
2018-06-25,15290107
2018-06-25,5052582
2018-06-25,2126186
2018-06-25,26513
2018-06-25,21468
2018-06-25,1360266
2018-06-25,4671
2018-06-25,31719
2018-06-25,1228824
2018-06-25,16287
2018-06-25,7479
2018-06-25,1044691
2018-06-25,64697
2018-06-25,12781
2018-06-25,6080231
2018-06-25,938392
2018-06-25,193426
2018-06-25,2589
2018-06-25,527867
2018-06-25,8045
2018-06-25,1947375
2018-06-25,16995
2018-06-25,1029085
2018-06-25,865735
2018-06-25,189722
2018-06-25,490531
2018-06-25,31208
2018-06-25,255432
2018-06-25,2144210
2018-06-25,3565999
2018-06-25,76181
2018-06-25,1109831
2018-06-25,880686
2018-06-25,387252
2018-06-25,19202
2018-06-25,148551
2018-06-25,427332
2018-06-25,1512
2018-06-25,2008147
2018-06-25,24546
2018-06-25,1710862
2018-06-25,8792
2018-06-25,4334
2018-06-25,270323
2018-06-25,46239
2018-06-25,32404
2018-06-25,305064
2018-06-25,273410
2018-06-25,6105
2018-06-25,7767057
2018-06-25,1868502
2018-06-25,351
2018-06-25,1662
2018-06-25,3805316
2018-06-25,57987
2018-06-25,1521003
2018-06-25,6587
2018-06-25,82190
2018-06-25,1207888
2018-06-25,814784
2018-06-25,13030
2018-06-25,13684262
2018-06-25,28555
2018-06-25,10405
2018-06-25,4490049
2018-06-25,24295
2018-06-25,24061
2018-06-25,2568012
2018-06-25,3739885
2018-06-25,3587807
2018-06-25,2770
2018-06-25,463048
2018-06-25,18376
2018-06-25,885815
2018-06-25,200901
2018-06-25,15435775
2018-06-25,3903411
2018-06-25,1363225
2018-06-25,1524
2018-06-25,12284532
2018-06-25,1678010
2018-06-25,23466
2018-06-25,2513401
2018-06-25,457754
2018-06-25,1305
2018-06-25,300916
2018-06-25,54056
2018-06-25,52609
2018-06-25,24949
2018-06-25,3363509
2018-06-25,440274
2018-06-25,43259
2018-06-25,440
2018-06-25,781083
2018-06-25,1171
2018-06-25,633015
2018-06-25,6255
2018-06-25,119007
2018-06-25,17581490
2018-06-25,136428
2018-06-25,2367537
2018-06-25,4742107
2018-06-25,291230
2018-06-25,346
2018-06-25,969548
2018-06-25,833039
2018-06-25,673560
2018-06-25,4510759
2018-06-25,1073
2018-06-25,35723
2018-06-25,5985851
2018-06-25,6412949
2018-06-25,4914683
2018-06-25,2826
2018-06-25,2346
2018-06-25,210460
2018-06-25,108496
2018-06-25,46154511
2018-06-25,314869
2018-06-25,302838
2018-06-25,886488
2018-06-25,430708
2018-06-25,52896
2018-06-25,35581
2018-06-25,152531
2018-06-25,44370
2018-06-25,25017
2018-06-25,4896922
2018-06-25,45790
2018-06-25,750447
2018-06-25,46194251
2018-06-25,516576
2018-06-25,62201935
2018-06-18,850432
2018-06-18,197694
2018-06-18,48079
2018-06-18,259145
2018-06-18,1356
2018-06-18,1955977
2018-06-18,47811
2018-06-18,1662663
2018-06-18,9473
2018-06-18,2843857
2018-06-18,23047
2018-06-18,67618
2018-06-18,23077
2018-06-18,371060
2018-06-18,15160887
2018-06-18,32768
2018-06-18,997110
2018-06-18,828629
2018-06-18,961163
2018-06-18,959705
2018-06-18,902
2018-06-18,7330858
2018-06-18,271923
2018-06-18,6678
2018-06-18,210278
2018-06-18,2584766
2018-06-18,85501
2018-06-18,10315
2018-06-18,421769
2018-06-18,15602
2018-06-18,2579875
2018-06-18,456644
2018-06-18,3881100
2018-06-18,860
2018-06-18,1211160
2018-06-18,1666337
2018-06-18,7861845
2018-06-18,9017
2018-06-18,3537336
2018-06-18,19658
2018-06-18,15311
2018-06-18,425500
2018-06-18,34585
2018-06-18

2025-01-19 16:13:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:13:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:13:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:13:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 16:13:06 - snowflake.connector.connection - INFO - closed
2025-01-19 16:13:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:13:07 - root - INFO - SQL:
SELECT DISTINCT "avg_transaction"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
Results:
Too long, hard cut:
avg_transaction
30.31
31.56
31.2
31.42
30.29
182.54
206.64
172.11
35.02
186.53
189.38
306.22
190.11
26.8
48.22
50.64
30.88
178.77
150.86
43.81
225.57
34.81
297.59
42.44
190.63
113.25
43.47
159.94
36.23
33.05
54.11
233.8
50.31
39.04
40.13
156.61
56.32
157.33
35.15
194.67
194.86
53.13
268.2
61.05
45.25
32.89
48.88
174.25
189.17
229.09
30.75
47.55
168.51
185.3
28.53
198.12
171.8
211.53
57.53
184.05
165.63
190.27
173.76
35.57
155.84
37.67
39.23
56.29
147.62
61.28
175.0
160.08
33.27
36.16
56.24
170.36
33.19
229.0
198.16
182.5
41.52
35.39
53.71
54.62
158.13
206.07
152.83
55.03
47.85
174.93
173.26
25.19
138.5
45.22
223.14
145.86
199.64
32.66
54.0
135.24
49.83
25.87
407.0
120.26
156.57
118.76
33.92
37.83
144.98
247.45
139.94
169.64
53.86
187.78
33.29
127.49
21.27
44.42
186.62
157.27
159.49
40.55
174.22
55.05
132.34
137.39
26.15
45.69
197.6
166.63
42.57
140.22
135.03
21.89
201.87
178.82
40.25
170.45
36.71
25.56
159.12
167.01
125.82
36.38
38.39
48.14
21.26
34.56
164.7
204.25
37.2
175.21
207.86
173.08
164.39
43.75
147.7
195.14
166.48
28.22
40.87
187.76
196.96
179.05
33.09
165.55
27.09
161.48
173.04
175.71
27.73
201.65
40.28
173.97
60.26
35.03
30.64
34.49
152.26
169.38
167.0
198.17
200.25
161.05
38.1
35.38
40.8
34.55
168.73
49.94
193.77
51.91
36.99
49.81
56.71
174.28
58.48
169.11
48.94
128.23
36.64
163.59
48.64
166.86
33.12
231.37
36.06
124.0
181.45
144.02
207.55
41.94
154.52
35.69
167.29
208.21
217.5
36.08
209.28
191.4
30.87
170.08
235.36
152.39
22.38
160.92
38.01
125.88
33.1
43.54
219.14
39.06
32.27
42.41
49.26
203.69
38.27
135.06
218.23
35.59
27.45
159.67
159.28
200.38
41.32
192.41
199.93
22.98
28.1
43.42
26.25
213.49
33.81
187.06
140.03
166.68
44.53
48.89
27.83
171.53
133.63
28.66
38.64
38.22
145.61
140.95
103.83
35.44
25.61
225.95
35.1
183.74
146.53
192.25
52.32
32.03
37.97
160.33
34.99
150.91
28.48
188.93
166.81
194.65
170.07
219.5
199.71
44.54
35.23
179.01
131.69
145.15
38.98
59.84
31.23
39.15
163.0
152.0
54.35
40.19
311.47
29.85
313.25
150.88
44.9
195.5
35.72
158.15
34.93
35.87
184.57
223.22
159.39
37.46
56.51
48.42
52.45
41.3
192.1
48.16
165.78
26.35
170.71
47.69
36.12
34.67
193.41
214.28
23.75
202.57
53.91
55.91
53.75
130.84
203.18
43.56
208.64
137.22
27.99
28.56
190.75
29.92
121.5
191.74
242.37
50.46
195.7
140.54
204.74
48.57
189.92
159.0
158.08
38.7
40.32
204.22
156.02
38.89
168.6
30.47
30.91
160.04
42.13
256.47
197.01
188.21
188.86
202.62
172.23
52.97
52.82
176.31
25.14
34.08
60.4
166.64
163.37
185.33
42.11
32.45
21.34
56.41
229.68
207.23
43.79
179.31
48.17
47.2
168.81
50.87
165.1
195.16
55.78
24.59
45.29
165.12
38.72
93.5
31.89
181.37
166.61
173.63
21.29
51.66
35.75
174.49
53.55
154.71
29.68
160.31
179.29
133.42
37.82
47.8
167.57
220.11
145.33
279.16
41.46
48.19
177.39
153.03
107.67
38.38
59.83
55.58
40.23
131.46
25.64
42.8
179.63
176.33
164.85
147.31
320.6
171.13
161.32
34.21
40.64
159.89
49.7
48.04
212.83
185.41
45.15
42.81
197.88
190.95
211.97
175.2
146.11
45.64
35.53
189.71
172.06
129.0
163.95
46.58
170.74
32.46
53.09
157.16
40.92
163.66
125.71
148.16
217.0
46.71
30.33
45.68
46.34
118.3
278.89
115.33
181.73
37.66
177.25
162.2
185.04
118.55
195.76
174.94
281.93
198.74
332.73
152.86
182.92
204.7
57.91
194.69
152.38
128.97
178.48
56.4
32.62
41.31
206.63
25.96
25.22
25.94
40.17
119.52
231.49
165.44
51.88
43.16
58.42
45.74
53.93
145.31
30.76
259.29
260.99
48.43
50.71
36.69
32.78
160.13
166.42
208.88
24.92
187.27
33.69
180.6
34.47
43.17
99.5
203.82
40.29
195.47
42.16
49.68
34.59
250.16
125.62
49.51
149.52
30.39
38.8
37.68
123.73
206.45
247.15
50.41
138.45
188.1
146.58
37.22
46.11
242.63
146.94
185.82
215.72
45.08
36.81
184.56
122.21
161.2
43.13
29.97
58.44
170.13
46.54
185.93
190.6
28.47
45.61
34.7
166.0
184.87
50.57
188.59
144.62
160.14
32.34
254.71
43.09
39.57
153.88
144.89
167.1
53.83
30.65
36.4
34.48
175.46
198.48
206.92
28.77
206.76
50.67
223.53
35.96
56.62
44.46
193.86
31.43
149.11
28.7
30.35
50.17
33.72
52.85
172.32
180.82
314.42
196.01
192.18
208.16
174.57
38.58
119.13
36.18
199.53
147.43
184.88
26.02
48.73
248.38
366.73
48.71
129.99
37.94
42.42
25.72
133.62
187.17
140.32
27.89
126.72
50.56
148.09
22.7
175.68
43.35
210.81
224.85
203.68
53.78
171.17
151.03
43.57
314.0
36.22
185.87
159.83
28.52
54.67
28.71
181.98
26.36
54.41
34.62
35.25
50.97
38.19
187.19
33.15
30.43
167.67
190.3
22.66
227.59
47.82
206.66
155.47
151.67
131.73
150.33
31.06
136.73
181.0
31.31
53.79
58.59
166.41
155.99
50.77
222.22
171.09
168.82
56.21
40.81
33.91
181.18
42.77
41.75
40.49
30.85
150.77
36.97
235.02
24.81
49.11
180.96
137.65
37.88
50.63
183.28
42.78
28.98
153.87
35.68
35.54
43.64
31.28
181.95
205.81
178.89
271.96
55.82
234.5
180.19
213.36
53.03
29.66
38.23
31.7
205.63
162.18
34.42
155.79
198.62
47.75
169.75
37.81
120.36
166.79
49.99
34.63
185.2
154.86
54.66
30.83
34.86
40.82
47.77
150.1
141.66
176.96
45.89
187.54
158.68
231.09
25.17
44.13
57.26
55.08
146.2
182.23
30.77
194.19
180.03
161.59
187.22
41.99
28.65
170.93
52.94
210.07
166.6
29.99
165.52
29.32
210.89
212.34
142.54
48.46
40.07
27.64
36.33
167.89
149.27
168.59
186.13

2025-01-19 16:13:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:13:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:13:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:13:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 952
2025-01-19 16:13:08 - snowflake.connector.connection - INFO - closed
2025-01-19 16:13:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:13:08 - root - INFO - SQL:
SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2020 AND "week_number" BETWEEN 23 AND 26
    LIMIT 1000;
Results:
Too long, hard cut:
week_date,sales
2020-06-22,53111
2020-06-22,3287
2020-06-22,25281
2020-06-22,3481797
2020-06-22,249776
2020-06-22,737
2020-06-22,869867
2020-06-22,3941
2020-06-22,8857025
2020-06-22,7787
2020-06-22,2299491
2020-06-22,11595
2020-06-22,4780
2020-06-22,6514327
2020-06-22,347475
2020-06-22,13568
2020-06-22,279258
2020-06-22,237650
2020-06-22,14317
2020-06-22,1009206
2020-06-22,127033
2020-06-22,659
2020-06-22,14002069
2020-06-22,374786
2020-06-22,564571
2020-06-22,97556
2020-06-22,7521785
2020-06-22,1006442
2020-06-22,16769158
2020-06-22,27011
2020-06-22,5827
2020-06-22,136838
2020-06-22,2243252
2020-06-22,1781302
2020-06-22,642126
2020-06-22,5042513
2020-06-22,3528540
2020-06-22,1280
2020-06-22,6056934
2020-06-22,19188715
2020-06-22,1268637
2020-06-22,893516
2020-06-22,139866
2020-06-22,959622
2020-06-22,55252
2020-06-22,729
2020-06-22,136819
2020-06-22,21061
2020-06-22,3224538
2020-06-22,1581679
2020-06-22,9999
2020-06-22,9466
2020-06-22,486932
2020-06-22,28570
2020-06-22,110201
2020-06-22,602021
2020-06-22,5870994
2020-06-22,742634
2020-06-22,434808
2020-06-22,2780044
2020-06-22,2159960
2020-06-22,802181
2020-06-22,4623876
2020-06-22,26612
2020-06-22,790128
2020-06-22,41141
2020-06-22,6121
2020-06-22,2224
2020-06-22,11445
2020-06-22,23548
2020-06-22,18256
2020-06-22,41314
2020-06-22,33053
2020-06-22,123662
2020-06-22,251028
2020-06-22,3755213
2020-06-22,11832
2020-06-22,2353
2020-06-22,1645958
2020-06-22,2538165
2020-06-22,42700
2020-06-22,4749717
2020-06-22,2889
2020-06-22,2114099
2020-06-22,1280621
2020-06-22,31912
2020-06-22,2848367
2020-06-22,53989
2020-06-22,11169
2020-06-22,25912
2020-06-22,8454874
2020-06-22,66085
2020-06-22,124844
2020-06-22,306177
2020-06-22,39105
2020-06-22,433866
2020-06-22,3685864
2020-06-22,3235
2020-06-22,8112
2020-06-22,460
2020-06-22,17475466
2020-06-22,425159
2020-06-22,46548966
2020-06-22,249388
2020-06-22,5338752
2020-06-22,125293
2020-06-22,86670
2020-06-22,1280381
2020-06-22,889002
2020-06-22,9964700
2020-06-22,22528
2020-06-22,11567284
2020-06-22,751926
2020-06-22,66049652
2020-06-22,329532
2020-06-22,7612
2020-06-22,48496
2020-06-22,83007
2020-06-22,17876981
2020-06-22,439785
2020-06-22,42418
2020-06-22,807015
2020-06-22,252312
2020-06-22,29199
2020-06-22,631199
2020-06-22,8622
2020-06-22,37370
2020-06-22,5255765
2020-06-22,934219
2020-06-22,49446341
2020-06-22,5765453
2020-06-22,2034364
2020-06-22,59421
2020-06-22,72803
2020-06-22,873151
2020-06-22,14892
2020-06-22,2112
2020-06-22,781231
2020-06-22,123993
2020-06-22,52213
2020-06-22,13255
2020-06-22,32201
2020-06-22,3366957
2020-06-22,7764
2020-06-22,10987703
2020-06-22,14368969
2020-06-22,413211
2020-06-22,29671173
2020-06-22,478130
2020-06-22,2127
2020-06-22,372372
2020-06-22,69866
2020-06-22,49144
2020-06-22,42537
2020-06-22,1708191
2020-06-22,3078
2020-06-22,25408
2020-06-22,34101
2020-06-22,5113755
2020-06-22,21756436
2020-06-22,9078
2020-06-22,23334
2020-06-22,994049
2020-06-22,7833
2020-06-22,451853
2020-06-22,82617
2020-06-22,1458631
2020-06-22,32150
2020-06-22,21755
2020-06-22,182943
2020-06-22,2106565
2020-06-22,80007
2020-06-22,16384433
2020-06-22,45714
2020-06-22,1483421
2020-06-22,7228205
2020-06-22,478704
2020-06-22,1918461
2020-06-22,754
2020-06-22,1981918
2020-06-22,431
2020-06-22,1141981
2020-06-22,38451
2020-06-22,3366573
2020-06-22,240233
2020-06-22,4632320
2020-06-22,1317083
2020-06-22,66435
2020-06-22,1545187
2020-06-22,76651
2020-06-22,42844
2020-06-22,44290
2020-06-22,14489
2020-06-22,901347
2020-06-22,22195
2020-06-22,1963911
2020-06-22,405250
2020-06-22,484192
2020-06-22,16238
2020-06-22,899
2020-06-22,16046
2020-06-22,94301
2020-06-22,18844
2020-06-22,905546
2020-06-22,1168407
2020-06-22,14069
2020-06-22,34282
2020-06-22,78307
2020-06-22,353139
2020-06-22,2186696
2020-06-22,192435
2020-06-22,76402
2020-06-22,33711
2020-06-22,312863
2020-06-22,432988
2020-06-22,181025
2020-06-22,4506459
2020-06-22,2559918
2020-06-22,302353
2020-06-22,523748
2020-06-22,2404405
2020-06-22,6470053
2020-06-22,664875
2020-06-22,2561107
2020-06-22,2741
2020-06-22,7501
2020-06-22,2304334
2020-06-22,8576
2020-06-22,576
2020-06-22,932002
2020-06-22,737519
2020-06-22,53543
2020-06-22,11801
2020-06-22,130060
2020-06-22,13971
2020-06-22,2332011
2020-06-22,22425
2020-06-22,47185
2020-06-15,14539790
2020-06-15,44710
2020-06-15,2705612
2020-06-15,635075
2020-06-15,5926732
2020-06-15,248890
2020-06-15,20722
2020-06-15,51674
2020-06-15,2237137
2020-06-15,767218
2020-06-15,14229
2020-06-15,1165
2020-06-15,67936
2020-06-15,2452340
2020-06-15,1639588
2020-06-15,2557
2020-06-15,60814
2020-06-15,25492
2020-06-15,904245
2020-06-15,510043
2020-06-15,3345407
2020-06-15,46911
2020-06-15,2157457
2020-06-15,450601
2020-06-15,95325
2020-06-15,84403
2020-06-15,3678695
2020-06-15,257281
2020-06-15,823955
2020-06-15,6682
2020-06-15,1621104
2020-06-15,124959
2020-06-15,41141
2020-06-15,442936
2020-06-15,28213
2020-06-15,10901782
2020-06-15,25053
2020-06-15,193527
2020-06-15,33251
2020-06-15,399445
2020-06-15,2121690
2020-06-15,252715
2020-06-

2025-01-19 16:13:08 - root - INFO - itercount: 0
2025-01-19 16:13:08 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- **"week_date"**: Identifies the date of each week; used for filtering specific time periods.
- **"calendar_year"**: Used to filter data for the years 2018, 2019, and 2020.
- **"month_number"**: Helps identify months around mid-June (month 6).
- **"week_number"**: Used to determine the weeks before and after June 15.
- **"sales"**: Sales figures needed to calculate total sales.
- **"transactions"**: Number of transactions; may provide additional insights.
- **"week_date_formatted"**: Possibly a standardized date format for "week_date".
- **"age_band"**: May be useful if analyzing sales by age groups.
- **"demographic"**: Could be used to break down sales performance by demographic.
- **"platform"**: To analyze sales across different platforms.
- **"region"**: To consider regional sales performance.

**Conditions That May Be Used:**

- `WHERE "calendar_year" IN (2018, 2019, 2020)`
- `WHERE "month_number" = 6` (for June)
- `WHERE "week_number" BETWEEN x AND y` (to select specific weeks around June 15)
- `WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-05-18' AND '2018-06-15'` (example date range)
- `WHERE "sales" IS NOT NULL` (to ensure sales data is present)

**SQL Queries:**

1. ```sql
   SELECT DISTINCT "calendar_year"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
   ```
   *Retrieve all unique years available in the sales data.*

2. ```sql
   SELECT DISTINCT "month_number"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" IN (2018, 2019, 2020)
   LIMIT 1000;
   ```
   *Identify the months present for the years 2018, 2019, and 2020.*

3. ```sql
   SELECT DISTINCT "week_number"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018
   LIMIT 1000;
   ```
   *Get all week numbers for the year 2018.*

4. ```sql
   SELECT DISTINCT "week_date"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "month_number" = 6
   LIMIT 1000;
   ```
   *List all week dates in June 2018.*

5. ```sql
   SELECT "week_date", "sales"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "week_number" BETWEEN 20 AND 24
   LIMIT 1000;
   ```
   *Retrieve sales data for weeks leading up to mid-June 2018.*

6. ```sql
   SELECT "week_date", "sales"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "week_number" BETWEEN 25 AND 28
   LIMIT 1000;
   ```
   *Retrieve sales data for weeks following mid-June 2018.*

7. ```sql
   SELECT DISTINCT "platform"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
   ```
   *Identify all platforms through which sales were made.*

8. ```sql
   SELECT DISTINCT "region"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
   ```
   *List all regions covered in the sales data.*

9. ```sql
   SELECT DISTINCT "age_band"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
   ```
   *Find the different age bands of customers.*

10. ```sql
    SELECT DISTINCT "demographic"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
    ```
    *Identify customer demographic categories.*

11. ```sql
    SELECT "week_date", "sales", "transactions"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1000;
    ```
    *Retrieve sales and transaction data where "week_date" can be parsed into a valid date.*

12. ```sql
    SELECT DISTINCT "customer_type"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
    ```
    *List different types of customers in the data.*

13. ```sql
    SELECT "week_number", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2018
    GROUP BY "week_number"
    ORDER BY "week_number"
    LIMIT 1000;
    ```
    *Aggregate sales by week number for the year 2018.*

14. ```sql
    SELECT "month_number", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2018
    GROUP BY "month_number"
    ORDER BY "month_number"
    LIMIT 1000;
    ```
    *Aggregate sales by month for the year 2018.*

15. ```sql
    SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "week_date" ILIKE '%June%'
    LIMIT 1000;
    ```
    *Retrieve sales data for weeks where "week_date" contains 'June'.*

16. ```sql
    SELECT "week_date_formatted", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2019 AND "month_number" = 6
    LIMIT 1000;
    ```
    *Get sales data for June 2019 using the formatted week date.*

17. ```sql
    SELECT "region", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2020 AND "month_number" = 6
    GROUP BY "region"
    LIMIT 1000;
    ```
    *Sum up sales by region for June 2020.*

18. ```sql
    SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-06-01' AND '2018-06-30'
    LIMIT 1000;
    ```
    *Retrieve sales data for June 2018 using date comparison.*

19. ```sql
    SELECT DISTINCT "avg_transaction"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
    ```
    *Explore different average transaction values.*

20. ```sql
    SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2020 AND "week_number" BETWEEN 23 AND 26
    LIMIT 1000;
    ```
    *Retrieve sales data around mid-June 2020.*

These queries help to understand the structure and content of the relevant columns in the **CLEANED_WEEKLY_SALES** table, which is essential for analyzing sales performance around mid-June for the specified years.Query:
SELECT DISTINCT "calendar_year"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Answer:
calendar_year
2020
2019
2018
Query:
SELECT DISTINCT "month_number"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" IN (2018, 2019, 2020)
   LIMIT 1000;
Answer:
month_number
8
7
6
5
4
3
9
Query:
SELECT DISTINCT "week_number"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018
   LIMIT 1000;
Answer:
week_number
36
35
34
33
31
30
29
27
26
25
24
22
20
18
32
19
16
15
14
13
28
23
21
17
Query:
SELECT DISTINCT "week_date"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "month_number" = 6
   LIMIT 1000;
Answer:
week_date
2018-06-25
2018-06-18
2018-06-11
2018-06-04
Query:
SELECT "week_date", "sales"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "week_number" BETWEEN 20 AND 24
   LIMIT 1000;
Answer:
Too long, hard cut:
week_date,sales
2018-06-11,8872
2018-06-11,599428
2018-06-11,3376
2018-06-11,9067
2018-06-11,1106388
2018-06-11,11342
2018-06-11,26129
2018-06-11,4981850
2018-06-11,2503852
2018-06-11,7784
2018-06-11,37087
2018-06-11,21396
2018-06-11,25158
2018-06-11,11434
2018-06-11,5089
2018-06-11,13407541
2018-06-11,147672
2018-06-11,2295726
2018-06-11,4348
2018-06-11,24241
2018-06-11,75934
2018-06-11,16319647
2018-06-11,28537
2018-06-11,10046
2018-06-11,425176
2018-06-11,18162
2018-06-11,3833
2018-06-11,315
2018-06-11,1112686
2018-06-11,18746
2018-06-11,7553
2018-06-11,14155
2018-06-11,204864
2018-06-11,20648
2018-06-11,6992
2018-06-11,874977
2018-06-11,8892
2018-06-11,19120
2018-06-11,45937
2018-06-11,590874
2018-06-11,2823
2018-06-11,4747642
2018-06-11,1474258
2018-06-11,1661208
2018-06-11,2025226
2018-06-11,1057265
2018-06-11,872544
2018-06-11,194891
2018-06-11,4783369
2018-06-11,16698
2018-06-11,692614
2018-06-11,6065268
2018-06-11,29761
2018-06-11,670490
2018-06-11,33556
2018-06-11,2042
2018-06-11,21615
2018-06-11,2239999
2018-06-11,5229
2018-06-11,406698
2018-06-11,24213
2018-06-11,2869364
2018-06-11,818381
2018-06-11,3629615
2018-06-11,1344116
2018-06-11,2641
2018-06-11,16338668
2018-06-11,466471
2018-06-11,457686
2018-06-11,1807
2018-06-11,8089459
2018-06-11,3188543
2018-06-11,8956
2018-06-11,34876
2018-06-11,57675
2018-06-11,5976020
2018-06-11,1263
2018-06-11,4653781
2018-06-11,1083
2018-06-11,2172474
2018-06-11,675764
2018-06-11,70884
2018-06-11,13818746
2018-06-11,29083
2018-06-11,866655
2018-06-11,127191
2018-06-11,247971
2018-06-11,370955
2018-06-11,43580
2018-06-11,973450
2018-06-11,2601253
2018-06-11,42687
2018-06-11,643833
2018-06-11,17298594
2018-06-11,103002
2018-06-11,8950657
2018-06-11,3521233
2018-06-11,1238
2018-06-11,3015554
2018-06-11,3735576
2018-06-11,2364447
2018-06-11,5083
2018-06-11,2582650
2018-06-11,2594216
2018-06-11,782355
2018-06-11,22862
2018-06-11,36422
2018-06-11,863137
2018-06-11,1025535
2018-06-11,3688874
2018-06-11,3451215
2018-06-11,45457692
2018-06-11,1447
2018-06-11,1869959
2018-06-11,424744
2018-06-11,9492
2018-06-11,1657858
2018-06-11,292720
2018-06-11,395095
2018-06-11,281396
2018-06-11,5154
2018-06-11,1398343
2018-06-11,3997517
2018-06-11,12219442
2018-06-11,183079
2018-06-11,8844241
2018-06-11,41795
2018-06-11,288966
2018-06-11,59992
2018-06-11,67957
2018-06-11,949969
2018-06-11,200527
2018-06-11,11731
2018-06-11,80675
2018-06-11,974570
2018-06-11,2270402
2018-06-11,5297231
2018-06-11,516
2018-06-11,29603
2018-06-11,11943362
2018-06-11,168689
2018-06-11,72259
2018-06-11,1674382
2018-06-11,78217
2018-06-11,6610714
2018-06-11,27898
2018-06-11,42154
2018-06-11,317882
2018-06-11,141389
2018-06-11,474
2018-06-11,11700
2018-06-11,107708
2018-06-11,1097916
2018-06-11,12869
2018-06-11,42898
2018-06-11,3862038
2018-06-11,3773700
2018-06-11,101267
2018-06-11,191115
2018-06-11,1982463
2018-06-11,1788
2018-06-11,140018
2018-06-11,554435
2018-06-11,18888
2018-06-11,176422
2018-06-11,45941
2018-06-11,20798
2018-06-11,46374089
2018-06-11,62744987
2018-06-11,20499
2018-06-11,499003
2018-06-11,264516
2018-06-11,66093
2018-06-11,4283
2018-06-11,7584275
2018-06-11,63701
2018-06-11,165
2018-06-11,1131
2018-06-11,1405097
2018-06-11,2308082
2018-06-11,56029
2018-06-11,263917
2018-06-11,61774
2018-06-11,25171
2018-06-11,24975
2018-06-11,2750
2018-06-11,410843
2018-06-11,4688696
2018-06-11,18580
2018-06-11,179999
2018-06-11,27988
2018-06-11,35506
2018-06-11,2103267
2018-06-11,5275148
2018-06-11,76242
2018-06-11,10712
2018-06-11,9776
2018-06-11,24734
2018-06-11,32038
2018-06-11,505429
2018-06-11,560894
2018-06-11,233158
2018-06-11,55002
2018-06-11,19258180
2018-06-11,274177
2018-06-11,15710
2018-06-11,8679
2018-06-11,1230114
2018-06-11,15294732
2018-06-11,25171
2018-06-11,505170
2018-06-11,864993
2018-06-11,87193
2018-06-11,14242
2018-06-11,2111113
2018-06-11,22006
2018-06-11,247
2018-06-11,1679258
2018-06-11,179446
2018-06-11,4494744
2018-06-11,789593
2018-06-11,3935578
2018-06-11,26016926
2018-06-11,190429
2018-06-11,34453
2018-06-11,3855
2018-06-11,71480
2018-06-11,7059
2018-06-11,809932
2018-06-11,48298
2018-06-11,295585
2018-06-11,2270
2018-06-11,319
2018-06-11,1326
2018-06-11,15372
2018-06-11,1391101
2018-06-11,191428
2018-06-11,99690
2018-06-04,856954
2018-06-04,17430358
2018-06-04,90749
2018-06-04,338624
2018-06-04,608
2018-06-04,11888324
2018-06-04,3860699
2018-06-04,3156
2018-06-04,4119
2018-06-04,1611020
2018-06-04,193013
2018-06-04,304043
2018-06-04,20111
2018-06-04,190508
2018-06-04,8557
2018-06-04,479062
2018-06-04,660944
2018-06-04,46330
2018-06-04,3278
2018-06-04,208182
2018-06-04,25295650
2018-06-04,27450
2018-06-04,102197
2018-06-04,383314
2018-06-04,574447
2018-06-04,9098
2018-06-04,68874
2018-06-04,2129350
2018-06-04,19407
2018-06-04,324667
2018-06-04,52156
2018-06-04,3658363
2018-06-04,18960302
2018-06-04,35244
2018-06-04,12739
2018-06-04,3090
2018-06-04,4528994
2018-06-04,965704
2018-06-04,1152276
2018-06-04,40963
2018-06-04,1061363
2018-06-04,550332
2018-06-04,16291305
2018-
Query:
SELECT "week_date", "sales"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   WHERE "calendar_year" = 2018 AND "week_number" BETWEEN 25 AND 28
   LIMIT 1000;
Answer:
Too long, hard cut:
week_date,sales
2018-07-09,611498
2018-07-09,5804
2018-07-09,531748
2018-07-09,1710131
2018-07-09,889598
2018-07-09,2408783
2018-07-09,31570
2018-07-09,12572
2018-07-09,4461407
2018-07-09,2546080
2018-07-09,1237
2018-07-09,1674187
2018-07-09,1235
2018-07-09,200206
2018-07-09,5188811
2018-07-09,2117864
2018-07-09,30757
2018-07-09,264131
2018-07-09,7961322
2018-07-09,333013
2018-07-09,10557
2018-07-09,451747
2018-07-09,779550
2018-07-09,3806530
2018-07-09,3338
2018-07-09,3380597
2018-07-09,207605
2018-07-09,210058
2018-07-09,38605
2018-07-09,76776
2018-07-09,180535
2018-07-09,5071
2018-07-09,324744
2018-07-09,73310
2018-07-09,18004456
2018-07-09,140580
2018-07-09,32308
2018-07-09,16029504
2018-07-09,25436
2018-07-09,198223
2018-07-09,951606
2018-07-09,2548126
2018-07-09,20215
2018-07-09,258847
2018-07-09,863477
2018-07-09,4734536
2018-07-09,47302
2018-07-09,1790957
2018-07-09,12422253
2018-07-09,372186
2018-07-09,517187
2018-07-09,16833185
2018-07-09,1291
2018-07-09,470909
2018-07-09,22621
2018-07-09,47624
2018-07-09,1128536
2018-07-09,18224
2018-07-09,32258
2018-07-09,27440
2018-07-09,1434
2018-07-09,16874
2018-07-09,8568
2018-07-09,383680
2018-07-09,20626
2018-07-09,581726
2018-07-09,1204045
2018-07-09,1458823
2018-07-09,1472
2018-07-09,69898
2018-07-09,36377
2018-07-09,2437629
2018-07-09,7447
2018-07-09,612225
2018-07-09,860
2018-07-09,825106
2018-07-09,8774
2018-07-09,5029330
2018-07-09,11986225
2018-07-09,881
2018-07-09,305470
2018-07-09,322780
2018-07-09,689909
2018-07-09,11682
2018-07-09,4124
2018-07-09,69526
2018-07-09,30488
2018-07-09,43146
2018-07-09,49181
2018-07-09,3997972
2018-07-09,48524433
2018-07-09,101988
2018-07-09,78363
2018-07-09,46808
2018-07-09,5777
2018-07-09,919591
2018-07-09,13964
2018-07-09,28635
2018-07-09,78100
2018-07-09,2147156
2018-07-09,8367
2018-07-09,108038
2018-07-09,484976
2018-07-09,13705869
2018-07-09,7434676
2018-07-09,80423
2018-07-09,999840
2018-07-09,4352434
2018-07-09,3549
2018-07-09,2535291
2018-07-09,857384
2018-07-09,4571
2018-07-09,220
2018-07-09,281581
2018-07-09,132799
2018-07-09,190786
2018-07-09,20623
2018-07-09,33683
2018-07-09,19944730
2018-07-09,1624945
2018-07-09,152455
2018-07-09,24251
2018-07-09,12194
2018-07-09,966445
2018-07-09,46812
2018-07-09,3692500
2018-07-09,15584
2018-07-09,2965223
2018-07-09,2903
2018-07-09,2648013
2018-07-09,51186
2018-07-09,938
2018-07-09,18022
2018-07-09,6734
2018-07-09,7935
2018-07-09,6524
2018-07-09,1318737
2018-07-09,2241653
2018-07-09,64744769
2018-07-09,304731
2018-07-09,1027770
2018-07-09,6309
2018-07-09,34155
2018-07-09,2343
2018-07-09,10420
2018-07-09,2023172
2018-07-09,142366
2018-07-09,1371394
2018-07-09,4053481
2018-07-09,946
2018-07-09,1442609
2018-07-09,152795
2018-07-09,25824442
2018-07-09,24824
2018-07-09,20725
2018-07-09,5322402
2018-07-09,29500
2018-07-09,4914862
2018-07-09,8876740
2018-07-09,1676625
2018-07-09,14545900
2018-07-09,54203
2018-07-09,64589
2018-07-09,10381
2018-07-09,477
2018-07-09,1480
2018-07-09,28183
2018-07-09,6639593
2018-07-09,29061
2018-07-09,2265833
2018-07-09,9909
2018-07-09,424136
2018-07-09,4927
2018-07-09,1113254
2018-07-09,6175153
2018-07-09,37853
2018-07-09,27732
2018-07-09,836125
2018-07-09,8388
2018-07-09,110493
2018-07-09,1081553
2018-07-09,22076
2018-07-09,2187703
2018-07-09,61961
2018-07-09,2820253
2018-07-09,3309803
2018-07-09,37964
2018-07-09,272201
2018-07-09,543196
2018-07-09,195890
2018-07-09,292606
2018-07-09,16913687
2018-07-09,36222
2018-07-09,7665
2018-07-09,1763892
2018-07-09,13931
2018-07-09,6618
2018-07-09,9622439
2018-07-09,2178409
2018-07-09,6581
2018-07-09,24725
2018-07-09,72925
2018-07-09,70702
2018-07-09,18037
2018-07-09,8314
2018-07-09,4872679
2018-07-09,26862
2018-07-09,17294
2018-07-09,114144
2018-07-09,84094
2018-07-09,12867
2018-07-09,329394
2018-07-09,209062
2018-07-09,593992
2018-07-09,200194
2018-07-09,3590357
2018-07-09,130
2018-07-09,48362188
2018-07-09,5962158
2018-07-09,3471373
2018-07-09,1080786
2018-07-09,395419
2018-07-09,183106
2018-07-09,3737094
2018-07-09,2477712
2018-07-09,24155
2018-07-09,929240
2018-07-09,950
2018-07-09,42746
2018-07-09,822964
2018-07-09,542330
2018-07-09,4286062
2018-07-09,27277
2018-07-09,404799
2018-07-09,659369
2018-07-09,3658
2018-07-09,61327
2018-07-09,65359
2018-07-02,61516
2018-07-02,417290
2018-07-02,311
2018-07-02,58179
2018-07-02,20606
2018-07-02,8640
2018-07-02,1103996
2018-07-02,2261211
2018-07-02,16067
2018-07-02,3976
2018-07-02,595119
2018-07-02,35136
2018-07-02,4940
2018-07-02,9579773
2018-07-02,2101076
2018-07-02,10932
2018-07-02,10532
2018-07-02,1028
2018-07-02,1458781
2018-07-02,34843
2018-07-02,3594
2018-07-02,72197
2018-07-02,17549
2018-07-02,2488231
2018-07-02,1064605
2018-07-02,114424
2018-07-02,972231
2018-07-02,21479
2018-07-02,2060
2018-07-02,9815
2018-07-02,150798
2018-07-02,8538
2018-07-02,3391
2018-07-02,1738
2018-07-02,312208
2018-07-02,58519
2018-07-02,12400256
2018-07-02,90096
2018-07-02,1668196
2018-07-02,36824
2018-07-02,29844
2018-07-02,378137
2018-07-02,805
2018-07-02,72772
2018-07-02,8
Query:
SELECT DISTINCT "platform"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Answer:
platform
Retail
Shopify
Query:
SELECT DISTINCT "region"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Answer:
region
ASIA
USA
EUROPE
AFRICA
CANADA
SOUTH AMERICA
OCEANIA
Query:
SELECT DISTINCT "age_band"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
   LIMIT 1000;
Answer:
age_band
Retirees
Young Adults
Middle Aged
unknown
Query:
SELECT DISTINCT "demographic"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
Answer:
demographic
Couples
Families
unknown
Query:
SELECT "week_date", "sales", "transactions"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1000;
Answer:
Too long, hard cut:
week_date,sales,transactions
2020-08-31,3656163,120631
2020-08-31,996575,31574
2020-08-31,16509610,529151
2020-08-31,141942,4517
2020-08-31,1758388,58046
2020-08-31,243878,1336
2020-08-31,519502,2514
2020-08-31,371417,2158
2020-08-31,49557,318
2020-08-31,3888162,111032
2020-08-31,260773,1398
2020-08-31,882690,4661
2020-08-31,38762,1029
2020-08-31,917,6
2020-08-31,35215,115
2020-08-31,30371770,551905
2020-08-31,374327,1969
2020-08-31,5185233,97604
2020-08-31,2980673,111219
2020-08-31,463738,11820
2020-08-31,65730,1363
2020-08-31,14430196,284971
2020-08-31,2176980,70496
2020-08-31,478756,2678
2020-08-31,3319,22
2020-08-31,5306746,94274
2020-08-31,4511841,94287
2020-08-31,134249,3064
2020-08-31,1579,7
2020-08-31,11451,329
2020-08-31,31589,854
2020-08-31,53567,180
2020-08-31,4023,15
2020-08-31,4768214,112361
2020-08-31,396909,2269
2020-08-31,8562,58
2020-08-31,8723663,142898
2020-08-31,957939,4703
2020-08-31,7625,40
2020-08-31,20635,164
2020-08-31,2265,20
2020-08-31,633917,14583
2020-08-31,72293,452
2020-08-31,13839,382
2020-08-31,68009,1503
2020-08-31,269176,7033
2020-08-31,10874,329
2020-08-31,1306932,24153
2020-08-31,3507,15
2020-08-31,1144376,18676
2020-08-31,3325,19
2020-08-31,15074,87
2020-08-31,1473178,29577
2020-08-31,1369115,41631
2020-08-31,20255591,402652
2020-08-31,48773122,1936351
2020-08-31,55780,413
2020-08-31,554,4
2020-08-31,2126153,43493
2020-08-31,6603287,169157
2020-08-31,1026838,5893
2020-08-31,11086427,245151
2020-08-31,19049,119
2020-08-31,564306,2983
2020-08-31,7331,32
2020-08-31,2272687,40076
2020-08-31,1562,7
2020-08-31,12836,88
2020-08-31,1548637,46545
2020-08-31,45518,228
2020-08-31,37786,1045
2020-08-31,48624,279
2020-08-31,2156778,66042
2020-08-31,5941067,117018
2020-08-31,395877,6769
2020-08-31,22712143,403810
2020-08-31,16149,74
2020-08-31,3322211,61517
2020-08-31,66422,1655
2020-08-31,27184,201
2020-08-31,979807,5794
2020-08-31,833470,23416
2020-08-31,7178808,144056
2020-08-31,7422165,151673
2020-08-31,91616,585
2020-08-31,661362,18180
2020-08-31,786613,30402
2020-08-31,11755,69
2020-08-31,883573,26620
2020-08-31,2232935,58165
2020-08-31,12438,97
2020-08-31,8473,37
2020-08-31,104677,2857
2020-08-31,2016930,65594
2020-08-31,461694,9710
2020-08-31,1221,3
2020-08-31,95547,567
2020-08-31,990085,36069
2020-08-31,10624187,220712
2020-08-31,2078649,11218
2020-08-31,33536,205
2020-08-31,35957,299
2020-08-31,40760,953
2020-08-31,8917,45
2020-08-31,154393,846
2020-08-31,2393490,57648
2020-08-31,3288,21
2020-08-31,1437,9
2020-08-31,30264,190
2020-08-31,530397,2647
2020-08-31,2494,21
2020-08-31,3101538,91435
2020-08-31,158799,3843
2020-08-31,1096531,28987
2020-08-31,35519,245
2020-08-31,16520774,339633
2020-08-31,45036,182
2020-08-31,126801,659
2020-08-31,56734,340
2020-08-31,6218547,187781
2020-08-31,1373529,6870
2020-08-31,3964262,172521
2020-08-31,14694,105
2020-08-31,690966,19524
2020-08-31,1520060,53286
2020-08-31,52421,2466
2020-08-31,3352338,97001
2020-08-31,6107,36
2020-08-31,402380,2031
2020-08-31,14910405,277600
2020-08-31,25858,157
2020-08-31,4085,20
2020-08-31,481198,2801
2020-08-31,11133538,396145
2020-08-31,1063716,28592
2020-08-31,1001335,23062
2020-08-31,63989387,2437738
2020-08-31,79359,343
2020-08-31,836865,3920
2020-08-31,67279,384
2020-08-31,11863,329
2020-08-31,72565,1738
2020-08-31,3749562,110894
2020-08-31,40740,196
2020-08-31,5786447,102736
2020-08-31,250536,4652
2020-08-31,2056315,50786
2020-08-31,372,3
2020-08-31,136743,731
2020-08-31,16103,115
2020-08-31,407861,2172
2020-08-31,10501,63
2020-08-31,451994,13579
2020-08-31,29757,164
2020-08-31,125653,726
2020-08-31,35572,247
2020-08-31,35314,277
2020-08-31,83877,507
2020-08-31,2819145,132545
2020-08-31,2770220,89785
2020-08-31,224778,1083
2020-08-31,210754,1282
2020-08-31,51883,300
2020-08-31,15077,100
2020-08-31,18437,414
2020-08-31,472,3
2020-08-31,411147,8410
2020-08-31,55333,249
2020-08-31,85926,3087
2020-08-31,20927,122
2020-08-31,1657269,37883
2020-08-31,6147,46
2020-08-31,4894437,110176
2020-08-31,44346247,1547309
2020-08-31,839437,4498
2020-08-31,134990,789
2020-08-31,23057,109
2020-08-31,49263,1352
2020-08-31,1493771,38663
2020-08-31,57455,389
2020-08-31,561282,14685
2020-08-31,930478,22186
2020-08-31,132424,842
2020-08-31,20860,135
2020-08-31,6891042,186404
2020-08-31,269373,1689
2020-08-31,16755039,413244
2020-08-31,33200,228
2020-08-31,9284850,260181
2020-08-31,887564,14482
2020-08-31,27732,118
2020-08-31,2423159,97673
2020-08-31,15927,113
2020-08-31,44500,1266
2020-08-31,623,6
2020-08-31,1769576,46838
2020-08-31,665292,18774
2020-08-31,2186307,40024
2020-08-31,277104,1420
2020-08-31,2234801,87269
2020-08-31,25762,154
2020-08-31,312519,1501
2020-08-31,4971,22
2020-08-31,3227065,62206
2020-08-31,269863,1621
2020-08-31,2291992,65304
2020-08-31,150741,3211
2020-08-31,46931,278
2020-08-31,30015,138
2020-08-31,5527494,96079
2020-08-31,128749,739
2020-08-31,48912,1098
2020-08-31,2829225,83764
2020-08-31,815588,14816
2020-08-31,471837,2568
2020-08-31,372983,1916
2020-08-31,48796,333
2020-08-31,25570,906
2020-08-
Query:
SELECT DISTINCT "customer_type"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
Answer:
customer_type
New
Guest
Existing
Query:
SELECT "week_number", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2018
    GROUP BY "week_number"
    ORDER BY "week_number"
    LIMIT 1000;
Answer:
week_number,total_sales
13,536755452
14,541167115
15,529574544
16,526355503
17,536075195
18,539632290
19,534072854
20,527788555
21,522377362
22,544417653
23,525086015
24,533259779
25,524368733
26,525737676
27,532366710
28,546769795
29,541086855
30,547653578
31,539321534
32,549636536
33,543535235
34,544330787
35,553039709
36,552971362
Query:
SELECT "month_number", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2018
    GROUP BY "month_number"
    ORDER BY "month_number"
    LIMIT 1000;
Answer:
month_number,total_sales
3,536755452
4,2672804647
5,2128656424
6,2108452203
7,2707198472
8,2190542267
9,552971362
Query:
SELECT "week_date", "sales"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
WHERE "month_number" = 6
LIMIT 1000;
Answer:
Too long, hard cut:
week_date,sales
2020-06-29,771649
2020-06-29,248186
2020-06-29,41232
2020-06-29,746
2020-06-29,17430
2020-06-29,28788145
2020-06-29,357156
2020-06-29,3222249
2020-06-29,83692
2020-06-29,6219
2020-06-29,339336
2020-06-29,18485
2020-06-29,2033692
2020-06-29,31393
2020-06-29,2509564
2020-06-29,865
2020-06-29,22101960
2020-06-29,8563
2020-06-29,2444
2020-06-29,1753657
2020-06-29,16297956
2020-06-29,31008
2020-06-29,40816
2020-06-29,2311
2020-06-29,5151347
2020-06-29,47898629
2020-06-29,137746
2020-06-29,474829
2020-06-29,1142258
2020-06-29,3387378
2020-06-29,337
2020-06-29,15402
2020-06-29,473733
2020-06-29,32127
2020-06-29,3372
2020-06-29,621849
2020-06-29,10224
2020-06-29,1283298
2020-06-29,38761
2020-06-29,32575
2020-06-29,2069075
2020-06-29,3518
2020-06-29,957978
2020-06-29,4328
2020-06-29,261
2020-06-29,5126468
2020-06-29,818184
2020-06-29,49917
2020-06-29,194204
2020-06-29,137468
2020-06-29,2312994
2020-06-29,16476365
2020-06-29,47122
2020-06-29,4820666
2020-06-29,6426709
2020-06-29,2353412
2020-06-29,8766
2020-06-29,808388
2020-06-29,1983459
2020-06-29,26020
2020-06-29,1953580
2020-06-29,493184
2020-06-29,2359
2020-06-29,549
2020-06-29,3613601
2020-06-29,1229
2020-06-29,1039
2020-06-29,315699
2020-06-29,81944
2020-06-29,5970777
2020-06-29,471006
2020-06-29,1478098
2020-06-29,48331
2020-06-29,82717
2020-06-29,11041636
2020-06-29,6042
2020-06-29,71681
2020-06-29,17908
2020-06-29,11034700
2020-06-29,5366430
2020-06-29,6235333
2020-06-29,418206
2020-06-29,34465
2020-06-29,46263
2020-06-29,38169
2020-06-29,645361
2020-06-29,5232
2020-06-29,4591704
2020-06-29,4686381
2020-06-29,346893
2020-06-29,63043806
2020-06-29,74791
2020-06-29,1605875
2020-06-29,11368
2020-06-29,868246
2020-06-29,44246
2020-06-29,159886
2020-06-29,136777
2020-06-29,18645
2020-06-29,871802
2020-06-29,1342126
2020-06-29,36681
2020-06-29,7451077
2020-06-29,5765543
2020-06-29,115232
2020-06-29,25006
2020-06-29,25758
2020-06-29,60231
2020-06-29,691104
2020-06-29,80500
2020-06-29,1693971
2020-06-29,4991052
2020-06-29,15236
2020-06-29,2205239
2020-06-29,2773702
2020-06-29,12326
2020-06-29,27727
2020-06-29,134236
2020-06-29,19047003
2020-06-29,1337460
2020-06-29,1403
2020-06-29,20922
2020-06-29,3597624
2020-06-29,14711185
2020-06-29,3217134
2020-06-29,10114
2020-06-29,1469626
2020-06-29,777148
2020-06-29,3648
2020-06-29,1052
2020-06-29,6210
2020-06-29,59917
2020-06-29,257850
2020-06-29,9157
2020-06-29,1445099
2020-06-29,57267
2020-06-29,12589
2020-06-29,4722
2020-06-29,20418
2020-06-29,137688
2020-06-29,26191
2020-06-29,38634
2020-06-29,241820
2020-06-29,786690
2020-06-29,1778357
2020-06-29,5292
2020-06-29,16778
2020-06-29,44574827
2020-06-29,241198
2020-06-29,423284
2020-06-29,2316291
2020-06-29,16411
2020-06-29,2795126
2020-06-29,446915
2020-06-29,1716
2020-06-29,10231
2020-06-29,2377430
2020-06-29,12155
2020-06-29,24314
2020-06-29,73349
2020-06-29,74011
2020-06-29,301370
2020-06-29,43148
2020-06-29,425189
2020-06-29,522
2020-06-29,89148
2020-06-29,646402
2020-06-29,10023093
2020-06-29,171759
2020-06-29,43036
2020-06-29,327256
2020-06-29,70075
2020-06-29,7345
2020-06-29,15140
2020-06-29,20018
2020-06-29,2172470
2020-06-29,64023
2020-06-29,1122634
2020-06-29,116461
2020-06-29,46236
2020-06-29,925527
2020-06-29,2622381
2020-06-29,450734
2020-06-29,7586276
2020-06-29,274806
2020-06-29,225451
2020-06-29,977652
2020-06-29,98965
2020-06-29,112042
2020-06-29,1006688
2020-06-29,47204
2020-06-29,109276
2020-06-29,2606202
2020-06-29,611536
2020-06-29,527320
2020-06-29,49839
2020-06-29,970952
2020-06-29,6755547
2020-06-29,18995
2020-06-29,353939
2020-06-29,5279
2020-06-29,38068
2020-06-29,4830448
2020-06-29,1653
2020-06-29,411142
2020-06-29,8957686
2020-06-29,18095
2020-06-29,11888
2020-06-29,824649
2020-06-29,2254122
2020-06-29,759575
2020-06-29,112466
2020-06-29,418727
2020-06-29,1066
2020-06-29,2095525
2020-06-29,16219267
2020-06-29,26223
2020-06-29,2271507
2020-06-29,393315
2020-06-29,887139
2020-06-29,8452
2020-06-29,865037
2020-06-29,90369
2020-06-29,20393
2020-06-29,652292
2020-06-29,61210
2020-06-29,14395106
2020-06-29,17149423
2020-06-29,3508936
2020-06-29,247362
2020-06-29,28790
2020-06-29,972030
2020-06-29,851108
2020-06-29,26284
2020-06-29,1655880
2020-06-29,3883895
2020-06-29,362077
2020-06-29,8130575
2020-06-22,53111
2020-06-22,3287
2020-06-22,25281
2020-06-22,3481797
2020-06-22,249776
2020-06-22,737
2020-06-22,869867
2020-06-22,3941
2020-06-22,8857025
2020-06-22,7787
2020-06-22,2299491
2020-06-22,11595
2020-06-22,4780
2020-06-22,6514327
2020-06-22,347475
2020-06-22,13568
2020-06-22,279258
2020-06-22,237650
2020-06-22,14317
2020-06-22,1009206
2020-06-22,127033
2020-06-22,659
2020-06-22,14002069
2020-06-22,374786
2020-06-22,564571
2020-06-22,97556
2020-06-22,7521785
2020-06-22,1006442
2020-06-22,16769158
2020-06-22,27011
2020-06-22,5827
2020-06-22,136838
2020-06-22,2243252
2020-06-22,1781302
2020-06-22,642126
2020-06-22,5042513
2020-06-22,3528540
2020-06-22,1280
2020-06-22,6056934
2020-06-22,19188715
2020-06-22,1268637
2020-06-22,893516
2020-
Query:
SELECT "week_date_formatted", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2019 AND "month_number" = 6
    LIMIT 1000;
Answer:
Too long, hard cut:
week_date_formatted,sales
2019-6-24,1301640
2019-6-24,38925
2019-6-24,2282
2019-6-24,4120633
2019-6-24,626993
2019-6-24,379135
2019-6-24,4297399
2019-6-24,3636107
2019-6-24,6987
2019-6-24,7186507
2019-6-24,43709
2019-6-24,29716
2019-6-24,15236876
2019-6-24,1363972
2019-6-24,26159
2019-6-24,366286
2019-6-24,353815
2019-6-24,3362183
2019-6-24,762452
2019-6-24,59759
2019-6-24,10818
2019-6-24,5090780
2019-6-24,7186
2019-6-24,134166
2019-6-24,46157461
2019-6-24,596944
2019-6-24,68575
2019-6-24,13486347
2019-6-24,28660
2019-6-24,63910100
2019-6-24,5386709
2019-6-24,14340
2019-6-24,1975871
2019-6-24,9876451
2019-6-24,5637102
2019-6-24,97836
2019-6-24,34913
2019-6-24,15998108
2019-6-24,371572
2019-6-24,39282
2019-6-24,2195234
2019-6-24,681655
2019-6-24,9276
2019-6-24,51360
2019-6-24,42041
2019-6-24,80009
2019-6-24,111072
2019-6-24,79204
2019-6-24,5831730
2019-6-24,2285350
2019-6-24,34267
2019-6-24,207395
2019-6-24,11262
2019-6-24,14791
2019-6-24,3296302
2019-6-24,22084
2019-6-24,385102
2019-6-24,2172241
2019-6-24,13052
2019-6-24,7527
2019-6-24,79
2019-6-24,199341
2019-6-24,22458
2019-6-24,2280355
2019-6-24,1383
2019-6-24,8277287
2019-6-24,339671
2019-6-24,11236
2019-6-24,98149
2019-6-24,28956
2019-6-24,252759
2019-6-24,7003237
2019-6-24,528835
2019-6-24,4990
2019-6-24,819
2019-6-24,904576
2019-6-24,13304072
2019-6-24,269805
2019-6-24,254092
2019-6-24,16247
2019-6-24,30302
2019-6-24,1521
2019-6-24,50350
2019-6-24,1092730
2019-6-24,12851
2019-6-24,8881
2019-6-24,119139
2019-6-24,74609
2019-6-24,3111
2019-6-24,2903459
2019-6-24,454543
2019-6-24,43744
2019-6-24,40182
2019-6-24,180945
2019-6-24,260944
2019-6-24,165813
2019-6-24,45318
2019-6-24,30885
2019-6-24,34047
2019-6-24,325971
2019-6-24,78104
2019-6-24,17748
2019-6-24,30919
2019-6-24,29341
2019-6-24,936783
2019-6-24,33356
2019-6-24,6203020
2019-6-24,1606206
2019-6-24,1106600
2019-6-24,2038581
2019-6-24,331054
2019-6-24,13062
2019-6-24,423558
2019-6-24,161060
2019-6-24,1573
2019-6-24,98552
2019-6-24,1889005
2019-6-24,1339183
2019-6-24,77965
2019-6-24,54372
2019-6-24,5155499
2019-6-24,25259
2019-6-24,139275
2019-6-24,558825
2019-6-24,2401628
2019-6-24,374335
2019-6-24,937431
2019-6-24,227420
2019-6-24,65290
2019-6-24,77177
2019-6-24,2322229
2019-6-24,2266154
2019-6-24,47403019
2019-6-24,678251
2019-6-24,268778
2019-6-24,31537
2019-6-24,15989275
2019-6-24,17465369
2019-6-24,32192
2019-6-24,4430301
2019-6-24,6042
2019-6-24,15396
2019-6-24,825219
2019-6-24,1067558
2019-6-24,636987
2019-6-24,1487138
2019-6-24,33328
2019-6-24,27380003
2019-6-24,1077203
2019-6-24,43701
2019-6-24,3462668
2019-6-24,2132
2019-6-24,31733
2019-6-24,4439938
2019-6-24,10313
2019-6-24,2944409
2019-6-24,72960
2019-6-24,58796
2019-6-24,483558
2019-6-24,20118
2019-6-24,1822
2019-6-24,321450
2019-6-24,108331
2019-6-24,141218
2019-6-24,382
2019-6-24,17222
2019-6-24,2473119
2019-6-24,805444
2019-6-24,192558
2019-6-24,569667
2019-6-24,33593
2019-6-24,7980239
2019-6-24,514
2019-6-24,630673
2019-6-24,5786
2019-6-24,40501
2019-6-24,613538
2019-6-24,76971
2019-6-24,48183
2019-6-24,814075
2019-6-24,3659716
2019-6-24,629420
2019-6-24,11860068
2019-6-24,927888
2019-6-24,3859
2019-6-24,102518
2019-6-24,4950491
2019-6-24,1913960
2019-6-24,17898
2019-6-24,41892
2019-6-24,14615
2019-6-24,1715401
2019-6-24,2367141
2019-6-24,391920
2019-6-24,2602
2019-6-24,32096
2019-6-24,288081
2019-6-24,414324
2019-6-24,14652
2019-6-24,3322265
2019-6-24,17784
2019-6-24,17363845
2019-6-24,9185423
2019-6-24,481
2019-6-24,19942
2019-6-24,1902952
2019-6-24,237753
2019-6-24,665201
2019-6-24,5229722
2019-6-24,2640336
2019-6-24,180198
2019-6-24,118445
2019-6-24,58233
2019-6-24,2838049
2019-6-24,1555
2019-6-24,4322941
2019-6-24,1314925
2019-6-24,2145
2019-6-24,32290
2019-6-24,1014969
2019-6-24,977138
2019-6-24,1324704
2019-6-24,282794
2019-6-24,52237
2019-6-24,922473
2019-6-24,2529
2019-6-24,87042
2019-6-24,1632734
2019-6-24,4668
2019-6-24,35202
2019-6-24,4190
2019-6-24,797430
2019-6-24,12364
2019-6-24,5870
2019-6-24,11825
2019-6-24,11653
2019-6-24,20620650
2019-6-24,3144220
2019-6-17,811432
2019-6-17,24598
2019-6-17,2413656
2019-6-17,275978
2019-6-17,312146
2019-6-17,44036
2019-6-17,46733
2019-6-17,103287
2019-6-17,2022689
2019-6-17,2284775
2019-6-17,1494465
2019-6-17,5658271
2019-6-17,32921
2019-6-17,1146718
2019-6-17,501760
2019-6-17,927994
2019-6-17,571097
2019-6-17,6237220
2019-6-17,369513
2019-6-17,3361043
2019-6-17,5830970
2019-6-17,12151
2019-6-17,2453
2019-6-17,372813
2019-6-17,17072
2019-6-17,16719
2019-6-17,19138
2019-6-17,2973532
2019-6-17,636176
2019-6-17,282290
2019-6-17,274875
2019-6-17,75408
2019-6-17,2598566
2019-6-17,83
2019-6-17,74168
2019-6-17,32962
2019-6-17,34458
2019-6-17,2846
2019-6-17,8407952
2019-6-17,57526
2019-6-17,481255
2019-6-17,72356
2019-6-17,1016803
2019-6-17,113989
2019-6-17,27874936
2019-6-17,21025
2019-6-17,38979
2019-6-17,203484
2019-6-17,2579386
2019-6-17,5411160
2019-6-17,271321
2019-6-17,11875557
2019-6-17,4475699
2019-6-17,1660327
2019-6-17,4142
2019-6-17,337175
2019-6-17,986630
2019-6-17,250339
20
Query:
SELECT "region", SUM("sales") AS "total_sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2020 AND "month_number" = 6
    GROUP BY "region"
    LIMIT 1000;
Answer:
region,total_sales
OCEANIA,951984238
USA,277763625
SOUTH AMERICA,87360985
EUROPE,47351180
ASIA,658863091
CANADA,174745093
AFRICA,702340026
Query:
SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE TRY_TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-06-01' AND '2018-06-30'
    LIMIT 1000;
Answer:
Too long, hard cut:
week_date,sales
2018-06-25,4784320
2018-06-25,980247
2018-06-25,610184
2018-06-25,9058
2018-06-25,2430726
2018-06-25,4494
2018-06-25,411615
2018-06-25,1498072
2018-06-25,42924
2018-06-25,14335
2018-06-25,3053553
2018-06-25,3402800
2018-06-25,98731
2018-06-25,1539
2018-06-25,41931
2018-06-25,5977
2018-06-25,2303157
2018-06-25,4781297
2018-06-25,26129
2018-06-25,9957
2018-06-25,13031
2018-06-25,4080
2018-06-25,2306973
2018-06-25,413182
2018-06-25,17831
2018-06-25,12307
2018-06-25,20453
2018-06-25,77985
2018-06-25,24996545
2018-06-25,33563
2018-06-25,23649
2018-06-25,55407
2018-06-25,307
2018-06-25,2234500
2018-06-25,27885
2018-06-25,3347
2018-06-25,8297875
2018-06-25,793
2018-06-25,120340
2018-06-25,8577
2018-06-25,33831
2018-06-25,7356
2018-06-25,289806
2018-06-25,62243
2018-06-25,1626236
2018-06-25,163954
2018-06-25,75114
2018-06-25,8360
2018-06-25,57084
2018-06-25,7758
2018-06-25,1103704
2018-06-25,8636
2018-06-25,33131
2018-06-25,2547864
2018-06-25,577
2018-06-25,102674
2018-06-25,149138
2018-06-25,822356
2018-06-25,109946
2018-06-25,4242076
2018-06-25,10552
2018-06-25,7651
2018-06-25,184592
2018-06-25,1672173
2018-06-25,78511
2018-06-25,2849696
2018-06-25,26683
2018-06-25,8738789
2018-06-25,26824
2018-06-25,608274
2018-06-25,3499
2018-06-25,21378
2018-06-25,71114
2018-06-25,18917331
2018-06-25,27001
2018-06-25,186687
2018-06-25,495391
2018-06-25,198274
2018-06-25,23955
2018-06-25,362831
2018-06-25,180084
2018-06-25,73791
2018-06-25,70410
2018-06-25,17804
2018-06-25,886397
2018-06-25,7339088
2018-06-25,293192
2018-06-25,14113
2018-06-25,18254
2018-06-25,11552
2018-06-25,12842306
2018-06-25,2056991
2018-06-25,36666
2018-06-25,11898455
2018-06-25,3812138
2018-06-25,2995554
2018-06-25,20224
2018-06-25,680840
2018-06-25,15158401
2018-06-25,2203439
2018-06-25,31522
2018-06-25,9473
2018-06-25,181791
2018-06-25,45843
2018-06-25,257011
2018-06-25,15290107
2018-06-25,5052582
2018-06-25,2126186
2018-06-25,26513
2018-06-25,21468
2018-06-25,1360266
2018-06-25,4671
2018-06-25,31719
2018-06-25,1228824
2018-06-25,16287
2018-06-25,7479
2018-06-25,1044691
2018-06-25,64697
2018-06-25,12781
2018-06-25,6080231
2018-06-25,938392
2018-06-25,193426
2018-06-25,2589
2018-06-25,527867
2018-06-25,8045
2018-06-25,1947375
2018-06-25,16995
2018-06-25,1029085
2018-06-25,865735
2018-06-25,189722
2018-06-25,490531
2018-06-25,31208
2018-06-25,255432
2018-06-25,2144210
2018-06-25,3565999
2018-06-25,76181
2018-06-25,1109831
2018-06-25,880686
2018-06-25,387252
2018-06-25,19202
2018-06-25,148551
2018-06-25,427332
2018-06-25,1512
2018-06-25,2008147
2018-06-25,24546
2018-06-25,1710862
2018-06-25,8792
2018-06-25,4334
2018-06-25,270323
2018-06-25,46239
2018-06-25,32404
2018-06-25,305064
2018-06-25,273410
2018-06-25,6105
2018-06-25,7767057
2018-06-25,1868502
2018-06-25,351
2018-06-25,1662
2018-06-25,3805316
2018-06-25,57987
2018-06-25,1521003
2018-06-25,6587
2018-06-25,82190
2018-06-25,1207888
2018-06-25,814784
2018-06-25,13030
2018-06-25,13684262
2018-06-25,28555
2018-06-25,10405
2018-06-25,4490049
2018-06-25,24295
2018-06-25,24061
2018-06-25,2568012
2018-06-25,3739885
2018-06-25,3587807
2018-06-25,2770
2018-06-25,463048
2018-06-25,18376
2018-06-25,885815
2018-06-25,200901
2018-06-25,15435775
2018-06-25,3903411
2018-06-25,1363225
2018-06-25,1524
2018-06-25,12284532
2018-06-25,1678010
2018-06-25,23466
2018-06-25,2513401
2018-06-25,457754
2018-06-25,1305
2018-06-25,300916
2018-06-25,54056
2018-06-25,52609
2018-06-25,24949
2018-06-25,3363509
2018-06-25,440274
2018-06-25,43259
2018-06-25,440
2018-06-25,781083
2018-06-25,1171
2018-06-25,633015
2018-06-25,6255
2018-06-25,119007
2018-06-25,17581490
2018-06-25,136428
2018-06-25,2367537
2018-06-25,4742107
2018-06-25,291230
2018-06-25,346
2018-06-25,969548
2018-06-25,833039
2018-06-25,673560
2018-06-25,4510759
2018-06-25,1073
2018-06-25,35723
2018-06-25,5985851
2018-06-25,6412949
2018-06-25,4914683
2018-06-25,2826
2018-06-25,2346
2018-06-25,210460
2018-06-25,108496
2018-06-25,46154511
2018-06-25,314869
2018-06-25,302838
2018-06-25,886488
2018-06-25,430708
2018-06-25,52896
2018-06-25,35581
2018-06-25,152531
2018-06-25,44370
2018-06-25,25017
2018-06-25,4896922
2018-06-25,45790
2018-06-25,750447
2018-06-25,46194251
2018-06-25,516576
2018-06-25,62201935
2018-06-18,850432
2018-06-18,197694
2018-06-18,48079
2018-06-18,259145
2018-06-18,1356
2018-06-18,1955977
2018-06-18,47811
2018-06-18,1662663
2018-06-18,9473
2018-06-18,2843857
2018-06-18,23047
2018-06-18,67618
2018-06-18,23077
2018-06-18,371060
2018-06-18,15160887
2018-06-18,32768
2018-06-18,997110
2018-06-18,828629
2018-06-18,961163
2018-06-18,959705
2018-06-18,902
2018-06-18,7330858
2018-06-18,271923
2018-06-18,6678
2018-06-18,210278
2018-06-18,2584766
2018-06-18,85501
2018-06-18,10315
2018-06-18,421769
2018-06-18,15602
2018-06-18,2579875
2018-06-18,456644
2018-06-18,3881100
2018-06-18,860
2018-06-18,1211160
2018-06-18,1666337
2018-06-18,7861845
2018-06-18,9017
2018-06-18,3537336
2018-06-18,19658
2018-06-18,15311
2018-06-18,425500
2018-06-18,34585
2018-06-18
Query:
SELECT DISTINCT "avg_transaction"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    LIMIT 1000;
Answer:
Too long, hard cut:
avg_transaction
30.31
31.56
31.2
31.42
30.29
182.54
206.64
172.11
35.02
186.53
189.38
306.22
190.11
26.8
48.22
50.64
30.88
178.77
150.86
43.81
225.57
34.81
297.59
42.44
190.63
113.25
43.47
159.94
36.23
33.05
54.11
233.8
50.31
39.04
40.13
156.61
56.32
157.33
35.15
194.67
194.86
53.13
268.2
61.05
45.25
32.89
48.88
174.25
189.17
229.09
30.75
47.55
168.51
185.3
28.53
198.12
171.8
211.53
57.53
184.05
165.63
190.27
173.76
35.57
155.84
37.67
39.23
56.29
147.62
61.28
175.0
160.08
33.27
36.16
56.24
170.36
33.19
229.0
198.16
182.5
41.52
35.39
53.71
54.62
158.13
206.07
152.83
55.03
47.85
174.93
173.26
25.19
138.5
45.22
223.14
145.86
199.64
32.66
54.0
135.24
49.83
25.87
407.0
120.26
156.57
118.76
33.92
37.83
144.98
247.45
139.94
169.64
53.86
187.78
33.29
127.49
21.27
44.42
186.62
157.27
159.49
40.55
174.22
55.05
132.34
137.39
26.15
45.69
197.6
166.63
42.57
140.22
135.03
21.89
201.87
178.82
40.25
170.45
36.71
25.56
159.12
167.01
125.82
36.38
38.39
48.14
21.26
34.56
164.7
204.25
37.2
175.21
207.86
173.08
164.39
43.75
147.7
195.14
166.48
28.22
40.87
187.76
196.96
179.05
33.09
165.55
27.09
161.48
173.04
175.71
27.73
201.65
40.28
173.97
60.26
35.03
30.64
34.49
152.26
169.38
167.0
198.17
200.25
161.05
38.1
35.38
40.8
34.55
168.73
49.94
193.77
51.91
36.99
49.81
56.71
174.28
58.48
169.11
48.94
128.23
36.64
163.59
48.64
166.86
33.12
231.37
36.06
124.0
181.45
144.02
207.55
41.94
154.52
35.69
167.29
208.21
217.5
36.08
209.28
191.4
30.87
170.08
235.36
152.39
22.38
160.92
38.01
125.88
33.1
43.54
219.14
39.06
32.27
42.41
49.26
203.69
38.27
135.06
218.23
35.59
27.45
159.67
159.28
200.38
41.32
192.41
199.93
22.98
28.1
43.42
26.25
213.49
33.81
187.06
140.03
166.68
44.53
48.89
27.83
171.53
133.63
28.66
38.64
38.22
145.61
140.95
103.83
35.44
25.61
225.95
35.1
183.74
146.53
192.25
52.32
32.03
37.97
160.33
34.99
150.91
28.48
188.93
166.81
194.65
170.07
219.5
199.71
44.54
35.23
179.01
131.69
145.15
38.98
59.84
31.23
39.15
163.0
152.0
54.35
40.19
311.47
29.85
313.25
150.88
44.9
195.5
35.72
158.15
34.93
35.87
184.57
223.22
159.39
37.46
56.51
48.42
52.45
41.3
192.1
48.16
165.78
26.35
170.71
47.69
36.12
34.67
193.41
214.28
23.75
202.57
53.91
55.91
53.75
130.84
203.18
43.56
208.64
137.22
27.99
28.56
190.75
29.92
121.5
191.74
242.37
50.46
195.7
140.54
204.74
48.57
189.92
159.0
158.08
38.7
40.32
204.22
156.02
38.89
168.6
30.47
30.91
160.04
42.13
256.47
197.01
188.21
188.86
202.62
172.23
52.97
52.82
176.31
25.14
34.08
60.4
166.64
163.37
185.33
42.11
32.45
21.34
56.41
229.68
207.23
43.79
179.31
48.17
47.2
168.81
50.87
165.1
195.16
55.78
24.59
45.29
165.12
38.72
93.5
31.89
181.37
166.61
173.63
21.29
51.66
35.75
174.49
53.55
154.71
29.68
160.31
179.29
133.42
37.82
47.8
167.57
220.11
145.33
279.16
41.46
48.19
177.39
153.03
107.67
38.38
59.83
55.58
40.23
131.46
25.64
42.8
179.63
176.33
164.85
147.31
320.6
171.13
161.32
34.21
40.64
159.89
49.7
48.04
212.83
185.41
45.15
42.81
197.88
190.95
211.97
175.2
146.11
45.64
35.53
189.71
172.06
129.0
163.95
46.58
170.74
32.46
53.09
157.16
40.92
163.66
125.71
148.16
217.0
46.71
30.33
45.68
46.34
118.3
278.89
115.33
181.73
37.66
177.25
162.2
185.04
118.55
195.76
174.94
281.93
198.74
332.73
152.86
182.92
204.7
57.91
194.69
152.38
128.97
178.48
56.4
32.62
41.31
206.63
25.96
25.22
25.94
40.17
119.52
231.49
165.44
51.88
43.16
58.42
45.74
53.93
145.31
30.76
259.29
260.99
48.43
50.71
36.69
32.78
160.13
166.42
208.88
24.92
187.27
33.69
180.6
34.47
43.17
99.5
203.82
40.29
195.47
42.16
49.68
34.59
250.16
125.62
49.51
149.52
30.39
38.8
37.68
123.73
206.45
247.15
50.41
138.45
188.1
146.58
37.22
46.11
242.63
146.94
185.82
215.72
45.08
36.81
184.56
122.21
161.2
43.13
29.97
58.44
170.13
46.54
185.93
190.6
28.47
45.61
34.7
166.0
184.87
50.57
188.59
144.62
160.14
32.34
254.71
43.09
39.57
153.88
144.89
167.1
53.83
30.65
36.4
34.48
175.46
198.48
206.92
28.77
206.76
50.67
223.53
35.96
56.62
44.46
193.86
31.43
149.11
28.7
30.35
50.17
33.72
52.85
172.32
180.82
314.42
196.01
192.18
208.16
174.57
38.58
119.13
36.18
199.53
147.43
184.88
26.02
48.73
248.38
366.73
48.71
129.99
37.94
42.42
25.72
133.62
187.17
140.32
27.89
126.72
50.56
148.09
22.7
175.68
43.35
210.81
224.85
203.68
53.78
171.17
151.03
43.57
314.0
36.22
185.87
159.83
28.52
54.67
28.71
181.98
26.36
54.41
34.62
35.25
50.97
38.19
187.19
33.15
30.43
167.67
190.3
22.66
227.59
47.82
206.66
155.47
151.67
131.73
150.33
31.06
136.73
181.0
31.31
53.79
58.59
166.41
155.99
50.77
222.22
171.09
168.82
56.21
40.81
33.91
181.18
42.77
41.75
40.49
30.85
150.77
36.97
235.02
24.81
49.11
180.96
137.65
37.88
50.63
183.28
42.78
28.98
153.87
35.68
35.54
43.64
31.28
181.95
205.81
178.89
271.96
55.82
234.5
180.19
213.36
53.03
29.66
38.23
31.7
205.63
162.18
34.42
155.79
198.62
47.75
169.75
37.81
120.36
166.79
49.99
34.63
185.2
154.86
54.66
30.83
34.86
40.82
47.77
150.1
141.66
176.96
45.89
187.54
158.68
231.09
25.17
44.13
57.26
55.08
146.2
182.23
30.77
194.19
180.03
161.59
187.22
41.99
28.65
170.93
52.94
210.07
166.6
29.99
165.52
29.32
210.89
212.34
142.54
48.46
40.07
27.64
36.33
167.89
149.27
168.59
186.13
Query:
SELECT "week_date", "sales"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
    WHERE "calendar_year" = 2020 AND "week_number" BETWEEN 23 AND 26
    LIMIT 1000;
Answer:
Too long, hard cut:
week_date,sales
2020-06-22,53111
2020-06-22,3287
2020-06-22,25281
2020-06-22,3481797
2020-06-22,249776
2020-06-22,737
2020-06-22,869867
2020-06-22,3941
2020-06-22,8857025
2020-06-22,7787
2020-06-22,2299491
2020-06-22,11595
2020-06-22,4780
2020-06-22,6514327
2020-06-22,347475
2020-06-22,13568
2020-06-22,279258
2020-06-22,237650
2020-06-22,14317
2020-06-22,1009206
2020-06-22,127033
2020-06-22,659
2020-06-22,14002069
2020-06-22,374786
2020-06-22,564571
2020-06-22,97556
2020-06-22,7521785
2020-06-22,1006442
2020-06-22,16769158
2020-06-22,27011
2020-06-22,5827
2020-06-22,136838
2020-06-22,2243252
2020-06-22,1781302
2020-06-22,642126
2020-06-22,5042513
2020-06-22,3528540
2020-06-22,1280
2020-06-22,6056934
2020-06-22,19188715
2020-06-22,1268637
2020-06-22,893516
2020-06-22,139866
2020-06-22,959622
2020-06-22,55252
2020-06-22,729
2020-06-22,136819
2020-06-22,21061
2020-06-22,3224538
2020-06-22,1581679
2020-06-22,9999
2020-06-22,9466
2020-06-22,486932
2020-06-22,28570
2020-06-22,110201
2020-06-22,602021
2020-06-22,5870994
2020-06-22,742634
2020-06-22,434808
2020-06-22,2780044
2020-06-22,2159960
2020-06-22,802181
2020-06-22,4623876
2020-06-22,26612
2020-06-22,790128
2020-06-22,41141
2020-06-22,6121
2020-06-22,2224
2020-06-22,11445
2020-06-22,23548
2020-06-22,18256
2020-06-22,41314
2020-06-22,33053
2020-06-22,123662
2020-06-22,251028
2020-06-22,3755213
2020-06-22,11832
2020-06-22,2353
2020-06-22,1645958
2020-06-22,2538165
2020-06-22,42700
2020-06-22,4749717
2020-06-22,2889
2020-06-22,2114099
2020-06-22,1280621
2020-06-22,31912
2020-06-22,2848367
2020-06-22,53989
2020-06-22,11169
2020-06-22,25912
2020-06-22,8454874
2020-06-22,66085
2020-06-22,124844
2020-06-22,306177
2020-06-22,39105
2020-06-22,433866
2020-06-22,3685864
2020-06-22,3235
2020-06-22,8112
2020-06-22,460
2020-06-22,17475466
2020-06-22,425159
2020-06-22,46548966
2020-06-22,249388
2020-06-22,5338752
2020-06-22,125293
2020-06-22,86670
2020-06-22,1280381
2020-06-22,889002
2020-06-22,9964700
2020-06-22,22528
2020-06-22,11567284
2020-06-22,751926
2020-06-22,66049652
2020-06-22,329532
2020-06-22,7612
2020-06-22,48496
2020-06-22,83007
2020-06-22,17876981
2020-06-22,439785
2020-06-22,42418
2020-06-22,807015
2020-06-22,252312
2020-06-22,29199
2020-06-22,631199
2020-06-22,8622
2020-06-22,37370
2020-06-22,5255765
2020-06-22,934219
2020-06-22,49446341
2020-06-22,5765453
2020-06-22,2034364
2020-06-22,59421
2020-06-22,72803
2020-06-22,873151
2020-06-22,14892
2020-06-22,2112
2020-06-22,781231
2020-06-22,123993
2020-06-22,52213
2020-06-22,13255
2020-06-22,32201
2020-06-22,3366957
2020-06-22,7764
2020-06-22,10987703
2020-06-22,14368969
2020-06-22,413211
2020-06-22,29671173
2020-06-22,478130
2020-06-22,2127
2020-06-22,372372
2020-06-22,69866
2020-06-22,49144
2020-06-22,42537
2020-06-22,1708191
2020-06-22,3078
2020-06-22,25408
2020-06-22,34101
2020-06-22,5113755
2020-06-22,21756436
2020-06-22,9078
2020-06-22,23334
2020-06-22,994049
2020-06-22,7833
2020-06-22,451853
2020-06-22,82617
2020-06-22,1458631
2020-06-22,32150
2020-06-22,21755
2020-06-22,182943
2020-06-22,2106565
2020-06-22,80007
2020-06-22,16384433
2020-06-22,45714
2020-06-22,1483421
2020-06-22,7228205
2020-06-22,478704
2020-06-22,1918461
2020-06-22,754
2020-06-22,1981918
2020-06-22,431
2020-06-22,1141981
2020-06-22,38451
2020-06-22,3366573
2020-06-22,240233
2020-06-22,4632320
2020-06-22,1317083
2020-06-22,66435
2020-06-22,1545187
2020-06-22,76651
2020-06-22,42844
2020-06-22,44290
2020-06-22,14489
2020-06-22,901347
2020-06-22,22195
2020-06-22,1963911
2020-06-22,405250
2020-06-22,484192
2020-06-22,16238
2020-06-22,899
2020-06-22,16046
2020-06-22,94301
2020-06-22,18844
2020-06-22,905546
2020-06-22,1168407
2020-06-22,14069
2020-06-22,34282
2020-06-22,78307
2020-06-22,353139
2020-06-22,2186696
2020-06-22,192435
2020-06-22,76402
2020-06-22,33711
2020-06-22,312863
2020-06-22,432988
2020-06-22,181025
2020-06-22,4506459
2020-06-22,2559918
2020-06-22,302353
2020-06-22,523748
2020-06-22,2404405
2020-06-22,6470053
2020-06-22,664875
2020-06-22,2561107
2020-06-22,2741
2020-06-22,7501
2020-06-22,2304334
2020-06-22,8576
2020-06-22,576
2020-06-22,932002
2020-06-22,737519
2020-06-22,53543
2020-06-22,11801
2020-06-22,130060
2020-06-22,13971
2020-06-22,2332011
2020-06-22,22425
2020-06-22,47185
2020-06-15,14539790
2020-06-15,44710
2020-06-15,2705612
2020-06-15,635075
2020-06-15,5926732
2020-06-15,248890
2020-06-15,20722
2020-06-15,51674
2020-06-15,2237137
2020-06-15,767218
2020-06-15,14229
2020-06-15,1165
2020-06-15,67936
2020-06-15,2452340
2020-06-15,1639588
2020-06-15,2557
2020-06-15,60814
2020-06-15,25492
2020-06-15,904245
2020-06-15,510043
2020-06-15,3345407
2020-06-15,46911
2020-06-15,2157457
2020-06-15,450601
2020-06-15,95325
2020-06-15,84403
2020-06-15,3678695
2020-06-15,257281
2020-06-15,823955
2020-06-15,6682
2020-06-15,1621104
2020-06-15,124959
2020-06-15,41141
2020-06-15,442936
2020-06-15,28213
2020-06-15,10901782
2020-06-15,25053
2020-06-15,193527
2020-06-15,33251
2020-06-15,399445
2020-06-15,2121690
2020-06-15,252715
2020-06-
End Exploring Related Columns
Task: For weekly-sales data, I need an analysis of our sales performance around mid-June for the years 2018, 2019, and 2020. Specifically, calculate the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year,Sales_Before,Sales_After,Percentage_Change
2018:int,Sales_Before_2018:float,Sales_After_2018:float,Percentage_Change_2018:float
2019:int,Sales_Before_2019:float,Sales_After_2019:float,Percentage_Change_2019:float
2020:int,Sales_Before_2020:float,Sales_After_2020:float,Percentage_Change_2020:float
```

**Explanation:**

The table above analyzes the sales performance around mid-June for the years 2018, 2019, and 2020. For each year, it provides:

- **Year:** The calendar year.
- **Sales_Before:** Total sales for the four weeks leading up to June 15.
- **Sales_After:** Total sales for the four weeks following June 15.
- **Percentage_Change:** The percentage change in sales from the four weeks before June 15 to the four weeks after June 15.

This comparison highlights how sales evolved around mid-June each year, indicating any significant increases or decreases in performance during that period..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 16:14:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 16:14:05 - root - INFO - ```sql
SELECT
  "Year",
  "Sales_Before",
  "Sales_After",
  ROUND((("Sales_After" - "Sales_Before") / "Sales_Before") * 100, 4) AS "Percentage_Change"
FROM
  (
    SELECT
      "calendar_year" AS "Year",
      SUM(CASE WHEN "week_date_converted" >= DATEADD(week, -4, DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15'))))
               AND "week_date_converted" < DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15')))
               THEN "sales" ELSE 0 END) AS "Sales_Before",
      SUM(CASE WHEN "week_date_converted" >= DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15')))
               AND "week_date_converted" < DATEADD(week, 4, DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15'))))
               THEN "sales" ELSE 0 END) AS "Sales_After"
    FROM
      (
        SELECT
          "calendar_year",
          TRY_TO_DATE("week_date", 'YYYY-MM-DD') AS "week_date_converted",
          "sales"
        FROM
          "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
        WHERE
          "calendar_year" IN (2018, 2019, 2020)
      ) AS sub
    GROUP BY
      "calendar_year"
  )
ORDER BY
  "Year";
```
2025-01-19 16:14:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:14:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:14:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:14:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 16:14:06 - snowflake.connector.connection - INFO - closed
2025-01-19 16:14:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:14:07 - root - INFO - itercount: 1
2025-01-19 16:14:07 - root - INFO - 0
2025-01-19 16:14:07 - root - INFO - results: 
Year,Sales_Before,Sales_After,Percentage_Change
2018,2119669585,2115732898,-0.1857
2019,2257925201,2237175841,-0.9190
2020,2345878357,2318994169,-1.1460


2025-01-19 16:14:07 - root - INFO - Please check the answer again by reviewing For weekly-sales data, I need an analysis of our sales performance around mid-June for the years 2018, 2019, and 2020. Specifically, calculate the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year,Sales_Before,Sales_After,Percentage_Change
2018:int,Sales_Before_2018:float,Sales_After_2018:float,Percentage_Change_2018:float
2019:int,Sales_Before_2019:float,Sales_After_2019:float,Percentage_Change_2019:float
2020:int,Sales_Before_2020:float,Sales_After_2020:float,Percentage_Change_2020:float
```

**Explanation:**

The table above analyzes the sales performance around mid-June for the years 2018, 2019, and 2020. For each year, it provides:

- **Year:** The calendar year.
- **Sales_Before:** Total sales for the four weeks leading up to June 15.
- **Sales_After:** Total sales for the four weeks following June 15.
- **Percentage_Change:** The percentage change in sales from the four weeks before June 15 to the four weeks after June 15.

This comparison highlights how sales evolved around mid-June each year, indicating any significant increases or decreases in performance during that period. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Sales_Before,Sales_After,Percentage_Change
2018,2119669585,2115732898,-0.1857
2019,2257925201,2237175841,-0.9190
2020,2345878357,2318994169,-1.1460
Current sql:
SELECT
  "Year",
  "Sales_Before",
  "Sales_After",
  ROUND((("Sales_After" - "Sales_Before") / "Sales_Before") * 100, 4) AS "Percentage_Change"
FROM
  (
    SELECT
      "calendar_year" AS "Year",
      SUM(CASE WHEN "week_date_converted" >= DATEADD(week, -4, DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15'))))
               AND "week_date_converted" < DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15')))
               THEN "sales" ELSE 0 END) AS "Sales_Before",
      SUM(CASE WHEN "week_date_converted" >= DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15')))
               AND "week_date_converted" < DATEADD(week, 4, DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15'))))
               THEN "sales" ELSE 0 END) AS "Sales_After"
    FROM
      (
        SELECT
          "calendar_year",
          TRY_TO_DATE("week_date", 'YYYY-MM-DD') AS "week_date_converted",
          "sales"
        FROM
          "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
        WHERE
          "calendar_year" IN (2018, 2019, 2020)
      ) AS sub
    GROUP BY
      "calendar_year"
  )
ORDER BY
  "Year";
2025-01-19 16:14:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 16:14:43 - root - INFO - ```sql
SELECT
  "Year",
  "Sales_Before",
  "Sales_After",
  ROUND((("Sales_After" - "Sales_Before") / "Sales_Before") * 100, 4) AS "Percentage_Change"
FROM
  (
    SELECT
      "calendar_year" AS "Year",
      SUM(CASE WHEN "week_date_converted" >= DATEADD(week, -4, DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15'))))
               AND "week_date_converted" < DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15')))
               THEN "sales" ELSE 0 END) AS "Sales_Before",
      SUM(CASE WHEN "week_date_converted" >= DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15')))
               AND "week_date_converted" < DATEADD(week, 4, DATE_TRUNC('week', TO_DATE(CONCAT("calendar_year", '-06-15'))))
               THEN "sales" ELSE 0 END) AS "Sales_After"
    FROM
      (
        SELECT
          "calendar_year",
          TRY_TO_DATE("week_date", 'YYYY-MM-DD') AS "week_date_converted",
          "sales"
        FROM
          "BANK_SALES_TRADING"."BANK_SALES_TRADING"."CLEANED_WEEKLY_SALES"
        WHERE
          "calendar_year" IN (2018, 2019, 2020)
      ) AS sub
    GROUP BY
      "calendar_year"
  )
ORDER BY
  "Year";
```
2025-01-19 16:14:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 16:14:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 16:14:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 16:14:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 16:14:45 - snowflake.connector.connection - INFO - closed
2025-01-19 16:14:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 16:14:45 - root - INFO - itercount: 2
2025-01-19 16:14:45 - root - INFO - 0
2025-01-19 16:14:45 - root - INFO - Total iteration counts: 2
