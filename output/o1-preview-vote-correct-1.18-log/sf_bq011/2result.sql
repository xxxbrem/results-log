SELECT COUNT(DISTINCT "USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    SELECT "USER_PSEUDO_ID"
    FROM (
        SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210101"
        UNION
        SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210102"
        UNION
        SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210103"
        UNION
        SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210104"
        UNION
        SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210105"
    ) AS active_users
    WHERE "USER_PSEUDO_ID" NOT IN (
        SELECT DISTINCT "USER_PSEUDO_ID"
        FROM (
            SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210106"
            UNION
            SELECT DISTINCT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210107"
        )
    )
);