2025-01-19 14:25:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:26:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:26:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:26:11 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:26:11 - root - INFO - SQL:
SELECT DISTINCT "interest_id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
6111.0
19422.0
6110.0
6217.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
6286.0
19621.0
63.0
165.0
18351.0
""
17314.0
4914.0
6107.0
40.0
5938.0
16137.0
6330.0
6006.0
6228.0
4902.0
97.0
20764.0
5.0
19610.0
4940.0
10838.0
6255.0
69.0
79.0
4895.0
5991.0
114.0
96.0
19758.0
6029.0
6334.0
6315.0
6206.0
20768.0
4855.0
56.0
23.0
98.0
18646.0
6162.0
128.0
6308.0
148.0
18347.0
4910.0
32703.0
6214.0
4.0
6218.0
161.0
92.0
6184.0
6232.0
36.0
150.0
17730.0
4869.0
31.0
19757.0
4911.0
5946.0
6378.0
6172.0
169.0
6299.0
6304.0
6123.0
103.0
38.0
17786.0
15.0
115.0
22403.0
4852.0
6108.0
6219.0
10250.0
149.0
16197.0
11067.0
4913.0
6316.0
17803.0
44.0
19.0
4873.0
86.0
24.0
12133.0
6141.0
4943.0
18996.0
85.0
19587.0
135.0
19588.0
77.0
4944.0
111.0
151.0
7461.0
17785.0
6318.0
7605.0
12.0
70.0
19579.0
18490.0
147.0
6062.0
19760.0
6115.0
6265.0
18350.0
6148.0
6340.0
109.0
12027.0
18784.0
34.0
102.0
6323.0
5896.0
6301.0
22411.0
6321.0
62.0
6222.0
6341.0
17673.0
6112.0
20753.0
125.0
17269.0
6284.0
7557.0
117.0
33.0
17320.0
18202.0
10008.0
10976.0
21242.0
21293.0
6278.0
64.0
88.0
5921.0
21057.0
6133.0
22096.0
18622.0
19294.0
5963.0
10988.0
116.0
21061.0
5984.0
45.0
21058.0
4857.0
6024.0
157.0
143.0
14901.0
6320.0
19604.0
7536.0
16196.0
18203.0
38360.0
36864.0
37876.0
10954.0
133.0
11974.0
15935.0
18647.0
5968.0
5943.0
16.0
6277.0
6285.0
6128.0
17674.0
93.0
22502.0
20750.0
6087.0
104.0
39.0
5952.0
164.0
5989.0
138.0
12277.0
61.0
6211.0
5972.0
6023.0
5960.0
90.0
6144.0
49.0
75.0
18781.0
4848.0
5930.0
13496.0
4920.0
163.0
33191.0
5918.0
13421.0
12025.0
19297.0
10870.0
19606.0
170.0
6151.0
1.0
60.0
158.0
132.0
6365.0
7537.0
6227.0
6085.0
11975.0
13.0
89.0
37.0
6084.0
8.0
4909.0
6127.0
66.0
7453.0
6171.0
131.0
10839.0
67.0
4861.0
19630.0
5970.0
4907.0
20767.0
10837.0
130.0
27.0
19879.0
4915.0
6250.0
6237.0
6302.0
22425.0
6207.0
141.0
6181.0
6298.0
6145.0
22.0
4918.0
17671.0
5906.0
35.0
21292.0
19250.0
82.0
13498.0
4925.0
6319.0
10365.0
6366.0
4898.0
7425.0
16119.0
65.0
5898.0
6051.0
5901.0
4866.0
6095.0
6229.0
20814.0
4904.0
7527.0
20963.0
6221.0
6210.0
139.0
19603.0
126.0
5920.0
7529.0
41.0
10972.0
22424.0
19338.0
19578.0
6263.0
10980.0
6267.0
119.0
4859.0
155.0
12031.0
107.0
17318.0
21060.0
5961.0
18997.0
6142.0
87.0
22423.0
21236.0
21238.0
80.0
6208.0
23778.0
18204.0
19628.0
19590.0
22095.0
145.0
20815.0
6305.0
6328.0
30.0
4928.0
59.0
55.0
18619.0
6030.0
10284.0
6209.0
6169.0
142.0
6194.0
153.0
10832.0
6088.0
11065.0
22093.0
6393.0
50.0
20755.0
12821.0
14800.0
6300.0
10009.0
18807.0
32705.0
6335.0
108.0
6149.0
10364.0
6367.0
4903.0
110.0
20816.0
4867.0
20730.0
7546.0
18924.0
4908.0
19593.0
6230.0
6317.0
5936.0
18783.0
7597.0
7545.0
6345.0
17729.0
4906.0
10970.0
22401.0
10836.0
4933.0
6215.0
6156.0
5945.0
112.0
6339.0
6122.0
19594.0
4931.0
6034.0
22398.0
72.0
19609.0
6332.0
21248.0
58.0
10971.0
7598.0
19626.0
19631.0
6047.0
21244.0
34462.0
34082.0
34461.0
34077.0
34084.0
34079.0
34460.0
33534.0
21245.0
34651.0
34643.0
34647.0
34650.0
34638.0
34646.0
36343.0
37411.0
37423.0
37874.0
37420.0
36876.0
38355.0
37414.0
38362.0
38351.0
37887.0
37166.0
38365.0
37165.0
37878.0
37416.0
38358.0
38989.0
39190.0
39192.0
39770.0
39651.0
39199.0
39659.0
41854.0
41191.0
41192.0
42238.0
42237.0
41554.0
40692.0
40687.0
40427.0
40694.0
42964.0
44470.0
44476.0
44479.0
44456.0
45524.0
44379.0
45669.0
45668.0
46567.0
49979.0
10011.0
22427.0
16138.0
18621.0
6329.0
6076.0
5914.0
6337.0
10977.0
12132.0
5911.0
6260.0
4917.0
5907.0
4924.0
95.0
5942.0
10978.0
19627.0
83.0
17672.0
6234.0
6322.0
28.0
19633.0
5909.0
10872.0
6324.0
6134.0
6253.0
6174.0
6212.0
6391.0
6159.0
19878.0
7543.0
10834.0
25.0
5934.0
6257.0
22400.0
4935.0
5929.0
22417.0
10975.0
6098.0
12032.0
6385.0
6124.0
32702.0
19612.0
10974.0
10010.0
6049.0
19634.0
166.0
5971.0
19624.0
21249.0
6236.0
121.0
10955.0
19615.0
5900.0
21251.0
15884.0
17274.0
11977.0
20752.0
2.0
19596.0
33474.0
34574.0
34088.0
34468.0
33972.0
33962.0
33958.0
35953.0
35169.0
34637.0
34644.0
34649.0
34642.0
37413.0
37877.0
36869.0
38284.0
37418.0
38361.0
37417.0
37412.0
38990.0
40183.0
40685.0
40683.0
39196.0
39649.0
40697.0
40691.0
40688.0
39643.0
40195.0
39547.0
39645.0
39658.0
39331.0
39338.0
39654.0
41856.0
41190.0
41855.0
41078.0
41079.0
41066.0
41059.0
40695.0
40526.0
44453.0
44587.0
45670.0
44473.0
44466.0
44484.0
45519.0
45675.0
45679.0
45673.0
44483.0
44589.0
44471.0
44458.0
44467.0
44384.0
45528.0
43551.0
39655.0
44580.0
42008.0
49972.0
51678.0
49975.0
84.0
13428.0
19635.0
19595.0
35742.0
37875.0
36873.0
36863.0
40525.0
40187.0
40699.0
41067.0
41075.0
43550.0
44486.0
45672.0
14802.0
44459.0
7540.0
12490.0
21237.0
4897.0
101.0
137.0
20731.0
6182.0
3.0
6336.0
15877.0
5951.0
6143.0
6173.0
12820.0
19295.0
6045.0
4894.0
5999.0
6220.0
6264.0
5895.0
5944.0
14.0
99.0
74.0
5924.0
21059.0
162.0
22413.0
26.0
6266.0
5910.0
18352.0
6183.0
6081.0
21239.0
7535.0
5958.0
4930.0
19617.0
5956.0
168.0
134.0
17271.0
18.0
4936.0
32701.0
10833.0
81.0
7464.0
71.0
19607.0
10251.0
4937.0
6303.0
1

2025-01-19 14:26:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:26:13 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:26:13 - root - INFO - SQL:
SELECT DISTINCT "id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
Results:
Too long, hard cut:
id
1
2
3
4
5
6
7
13
14
15
16
18
19
20
21
22
23
24
26
31
35
40
41
43
49
54
61
71
75
78
80
81
104
135
4895
4896
4920
17
25
28
29
51
65
86
87
90
99
109
111
114
121
169
4857
4858
4917
4918
5942
69
132
153
4898
4903
6131
6194
8
12
30
37
42
48
50
64
66
67
70
74
91
92
94
97
102
106
112
113
117
131
134
138
27
33
38
39
44
46
53
57
59
60
63
82
84
88
89
93
95
110
115
116
125
129
137
141
145
154
158
162
165
4847
4848
4855
4869
4897
4908
4914
4925
4931
4932
5895
5906
5907
5916
5926
5929
5934
5945
5961
62
118
133
142
143
160
4852
4902
4905
4906
4907
4919
5901
5911
5921
5943
5951
5968
151
5904
5914
5972
5984
6010
6013
6065
6077
6107
6123
6141
6145
6172
6174
6182
6224
6225
6226
6227
6230
6253
6301
6323
6335
6344
6364
7454
7535
10249
11067
12027
13498
17674
19250
19606
20754
21244
56
128
34
36
45
55
58
72
77
83
98
101
103
108
124
139
4859
4866
4873
4912
4924
4926
4927
4935
5896
5924
5933
5936
5957
5960
79
85
96
107
119
123
136
140
146
147
148
150
155
157
161
163
168
170
171
4867
4872
4899
4909
4910
4911
4913
4916
4921
4928
4930
4933
4937
4940
4943
4944
5897
5898
5910
5913
5920
5925
5938
5944
5946
5962
5967
5969
130
4861
4915
4929
4936
5917
5956
5963
5970
5971
5989
5991
5999
6006
6008
6023
6024
6029
6030
6034
6045
6049
6050
6051
6081
6085
6087
6095
6098
6106
6108
6111
6115
6120
6122
6127
6128
6134
6148
6149
6151
6156
6160
6162
6164
6169
6177
6183
6206
6208
6209
6215
6218
6219
6221
6231
6232
6234
6250
6255
6259
6260
6264
6266
6267
6278
6285
6298
6300
6303
6305
6308
6314
6315
6320
6321
6322
6328
6330
6331
6332
6334
6336
6341
6343
6363
6365
6367
6378
6386
6389
6393
7461
7537
7544
7597
7605
10007
10008
12032
10250
10834
10835
10836
10869
10870
10871
10872
10954
10976
10978
10981
10988
11065
11066
11975
12025
12490
13428
13496
13497
14801
14901
15878
15882
15883
15884
16137
16138
16196
17269
17314
17318
17452
17669
17670
17786
18203
18348
18352
18620
18648
18781
18782
18783
18923
18997
19251
19338
19423
19578
19594
19597
19598
19601
19603
19609
19610
19612
19613
19619
19620
19622
19624
19627
19628
19634
20730
20755
20768
21060
21247
21251
22092
22408
22415
22421
22422
22426
32486
32701
32702
32703
32705
33964
33968
34081
34087
34460
6142
6184
6237
6302
6319
6329
6340
6366
6387
6390
7534
7536
7542
7557
10010
10364
10365
10837
10839
10955
10973
10975
12026
12132
12602
16197
17729
17730
18202
18204
18490
18995
19422
19579
19587
35742
19607
19617
19621
19623
19632
19879
20751
20764
20766
21058
21062
21237
21239
21241
21242
21245
21249
21293
22398
22420
22423
22425
33191
33474
33533
33534
33958
33959
33960
33961
33962
33969
34077
34078
34079
34084
34085
20814
33963
34462
34465
34466
34468
34470
34640
34641
34643
34645
34648
34650
35905
36862
36868
36872
36875
36876
36877
36879
36882
37257
37407
37408
37410
37412
37417
37877
37878
37880
38284
38353
38358
38361
38365
38991
38993
39198
39330
39331
39334
39335
39462
39551
39644
39645
39647
39768
40188
40190
40193
40194
40195
40439
41055
41062
41065
41066
41087
41195
41550
41553
42011
42203
44378
44383
44387
44390
44452
44456
44458
44464
44471
44479
44486
44579
44588
45520
45522
45665
45667
45673
45675
45679
47065
48463
49978
51120
51678
38363
39646
40702
41546
44457
44463
46132
49974
49979
44585
100
126
4904
5900
73
149
164
4870
5909
5918
5922
5930
5952
5958
6047
6048
6064
6067
6076
6084
6089
6112
6124
6133
6138
6143
6144
6168
6171
6173
6181
6188
6189
6207
6210
6211
6216
6217
6220
6222
6223
6228
6235
6236
6257
6284
6286
6304
6306
6316
6318
6324
6325
6333
6391
7453
7483
7540
7541
7546
7598
10284
10366
10971
10979
10980
11974
11977
13421
14800
14895
15879
16119
17540
17671
18351
18621
19296
19297
19298
19519
19599
19602
19604
19614
19615
19616
19633
19635
20750
20752
21236
21238
21240
21243
21248
21326
22094
22096
22419
22428
33972
34086
34088
34459
6062
6159
6212
6214
6229
6263
6265
6277
6299
6317
6337
6339
7425
7464
7527
7543
7545
10009
10251
10351
10832
10833
10838
10953
10970
10972
10974
10977
12031
12133
12277
12820
12821
14802
15877
15935
16198
17271
17274
17320
17672
17673
17785
17803
18347
18350
18619
18622
18646
18647
18784
18807
18924
18996
18998
19588
19589
19590
19591
19592
19593
19596
19608
19611
19626
19629
19630
19631
19757
19758
19759
19760
19878
20731
20753
20756
20767
20815
20817
20963
21057
21059
21061
21246
21250
21292
22400
22401
22403
22406
22411
22413
22417
22427
22502
32485
32704
33966
33967
33970
34082
34083
6088
6385
19295
20816
22091
33965
33971
34461
34463
34464
34467
34469
34471
34574
34635
34636
34638
34639
34642
34647
34649
34651
34909
34948
34950
35169
35903
35904
35906
35932
35953
35964
36020
36343
36860
36863
36864
36869
36870
36871
36873
36874
36878
36881
36883
36884
37166
37406
37409
37411
37413
37416
37419
37420
37421
37423
37524
37874
37875
37876
37879
37881
37883
37887
38283
38350
38351
38352
38355
38356
38360
38364
38366
38368
38989
38990
38992
38994
38995
38996
39189
39190
39191
39193
39194
39195
39196
39197
39199
39332
39336
39337
39338
39547
39640
39641
39643
39648
39650
39651
39652
39653
39654
39655
39657
39659
39665
39685
39767
39770
40183
40185


2025-01-19 14:26:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:26:15 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:26:15 - root - INFO - SQL:
SELECT DISTINCT "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
Results:
Too long, hard cut:
interest_name
Fitness Enthusiasts
Gamers
Car Enthusiasts
Luxury Retail Researchers
Brides & Wedding Planners
Vacation Planners
Motorcycle Enthusiasts
Business News Readers
Thrift Store Shoppers
NFL Fans
NBA Fans
Nascar Fans
Eco-Conscious Consumers
Moviegoers
DIYers
Techies
Doctors
Streaming Video Fans
Auto Insurance Shoppers
College Students
Home Decor Shoppers
Kids Clothing Shoppers
Teen Girl Clothing Shoppers
Mens Clothing Shoppers
Baby Products Buyers
Jewelry & Watch Shoppers
Sporting Goods Shoppers
Apartment Hunters
Home Buyers
Discount Big Box Shoppers
Seasonal Allergy Sufferers
Discount Device Shoppers
Budget Wireless Shoppers
Menopause Researchers
High-End Kids Furniture and Clothes Shoppers
Fantasy & Comic Fans
Drug Store Shoppers
Mailing & Shipping Shoppers
Online Movie Downloaders
Parents with Toddlers
Day Care Users
Auto Repair Researchers
Coders & Developers
Online Alcohol Shoppers
Truck Drivers
Teachers
Bed & Bath Shoppers
Online Health Researchers
Contractors & Construction Professionals
Democrats
Hardware Shoppers
Reggaeton Fans
Major Appliance Shoppers
Pet Owners
Skin Care Researchers
Federal Employees
Doves
Business Logistics Managers
Dieters
Orthopedic Health Researchers
Tax Filers
Cruise Travel Intenders
Social Conservatives
Supply Chain Professionals
NCAA Fans
Grill Masters
Intimates Shoppers
Charitable Donors
Streaming Device Shoppers
Lawn & Garden Enthusiasts
Luxury Travel Researchers
Travel Researchers
Order-in Eaters
Audio Equipment Researchers
Business Accounting Software Researchers
Asthma Sufferers
Cardio Health Researchers
Readers of Data Scientist blogs
Advertising Professionals
Home Design Enthusiasts
Fast Fashion Shoppers
Moving Services Shoppers
NHL Fans
Black Friday Deal Shoppers
Hip Hop Fans
Beauty & Skincare Buyers
Hands-On Parents
Nurses
Office Supply Shoppers
Luxury Retail Shoppers
Republicans
HDTV Researchers
Sale Seekers
Ski and Snowboard Enthusiasts
Parents with Kids
Young Boomers
Exercise and Gym Researchers
Home Kitchen Chefs
Restaurant Researchers
Nutrition Conscious Eaters
Flower & Gift Basket Shoppers
Live Concert Fans
Avid Readers
Womens Fashion Magazine Readers
Boxing Fans
Healthcare Discount Shoppers
Soccer Fans
Makeup Researchers
TV Junkies
Business Travelers
Travel Reward Points Enthusiasts
Voters
IT Decision Makers
Tech-Savvy Moms
Credit Union Researchers
Cosmetics and Beauty Shoppers
Adult Acne Sufferers
Sinus Researchers
Back Pain Sufferers
Mens Health Researchers
Teen Content Readers
Surfers
Immigration Rights Advocates
Right Wing Radicals
Occupy Movement Supporters
Orthodontics Researchers
Career Focused Individuals
Flooring Shoppers
New & Expecting Parents
Ink & Toner Shoppers
Theme Park Researchers
Stay-at-Home Parents
Comedy Fans
Joint Pain Sufferers
Mens Shoe Shoppers
Military Servicemembers & Veterans
Credit Card Researchers
Sightseeing Travelers
Conservative News Readers
Entertainment & Tabloid Magazine Readers
TV Game Show Fans
Mature Parents
Headache and Migraine Sufferers
Vitamin Shoppers
Gun Rights Advocates
Immigration Control Advocates
Family Values Advocates
Liberal Think Tank Readers
Online Grocery Shoppers
Budget Small Business Researchers
Tax Policy Researchers
Financial News Readers
Law Enforcement Officers
Android Fans
Small Business Employees
Parents of Teenagers Going to College
Luxury Home Fixture Shoppers
Financial Investors
Joint Pain Health Care Professionals
Spa and Pool Owners
Backyard Farmers
Readers of Portuguese Content
Solar Energy Researchers
Coffee Lovers
Dental Hygiene Students
Rugby Fans
Fantasy Football Enthusiasts
Open Source Developers
United Arab Emirates Trip Planners
College Aspirants
Non-Profit Volunteers
Medicare Researchers
Environmental Activists
Physicians
Gastroenterologists
Pharmacists
New Orleans Trip Planners
HVAC Service Researchers
Economy Grocery Shoppers
Japanese Luxury Car Enthusiasts
Dallas Cowboys Fans
NCAA Football Fans
Last Minute Travelers
Luxury Boutique Hotel Researchers
Professional Sound Products Researchers
Home Design and Living Publication Readers
Houston Rockets Fans
New York Giants Fans
Online Investors
Sleep Disorder Researchers
Automotive Safety Researchers
Flight and Hotel Shoppers
Oncology Researchers
MLB Fans
Department Store Shoppers
Furniture Shoppers
Lawyers
Healthy Eaters
Coupon Researchers
Plus Size Women
Country Music Fans
Pain Management Researchers
Retirement Planners
Mortgage Researchers
Aftermarket Accessories Shoppers
Home Printer Shoppers
Tablet Researchers
Home Kitchen Bakers
Broadway Fans
Womens Fitness Enthusiasts
Readers of Mexican Content
Military Families
LGBT Activists
Tire Shoppers
Business Communication Product Researchers
Credit Score Researchers
Caribbean Trip Planners
Luxury Bedding Shoppers
Job Seekers
Pain Medication Users
Home Security Shoppers
Kitchen & Bathroom Remodelers
Health Insurance Researchers
Property Insurance Researchers
Streaming Radio Listeners
Big & Tall Men
Phone Accessory Shoppers
Prepaid Smartphone Shoppers
Retirees
Social Liberals
Shoe 

2025-01-19 14:26:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:26:17 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:26:17 - root - INFO - SQL:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.

2025-01-19 14:26:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-19 14:26:19 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:26:19 - root - INFO - SQL:
SELECT DISTINCT "_month", "_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
_month,_year
7.0,2018.0
,
8.0,2018.0
9.0,2018.0
10.0,2018.0
11.0,2018.0
12.0,2018.0
1.0,2019.0
2.0,2019.0
3.0,2019.0
4.0,2019.0
5.0,2019.0
7.0,2019.0
6.0,2019.0
8.0,2019.0

2025-01-19 14:26:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-19 14:26:20 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:26:21 - root - INFO - SQL:
SELECT DISTINCT "month_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019

2025-01-19 14:26:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:26:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:26:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:26:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 14:26:22 - snowflake.connector.connection - INFO - closed
2025-01-19 14:26:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:27:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:27:11 - root - INFO - ```sql
SELECT
    mc."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    mc."composition" AS "Composition_Value"
FROM (
    SELECT
        im."interest_id",
        im."month_year",
        im."composition",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
) mc
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap ON mc."interest_id" = imap."id"
WHERE
    mc.rn = 1
ORDER BY
    mc."composition" DESC
LIMIT 10

UNION ALL

SELECT
    mc."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    mc."composition" AS "Composition_Value"
FROM (
    SELECT
        im."interest_id",
        im."month_year",
        im."composition",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
) mc
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap ON mc."interest_id" = imap."id"
WHERE
    mc.rn = 1
ORDER BY
    mc."composition" ASC
LIMIT 10;
```
2025-01-19 14:27:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:27:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:27:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:27:12 - snowflake.connector.connection - INFO - closed
2025-01-19 14:27:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:28:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:28:43 - root - INFO - ```sql
(
    SELECT
        mc."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        mc."composition" AS "Composition_Value"
    FROM (
        SELECT
            im."interest_id",
            im."month_year",
            im."composition",
            ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
        FROM
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
        WHERE
            im."composition" IS NOT NULL
    ) mc
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON mc."interest_id" = imap."id"
    WHERE
        mc.rn = 1
    ORDER BY
        mc."composition" DESC
    LIMIT 10
)
UNION ALL
(
    SELECT
        mc."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        mc."composition" AS "Composition_Value"
    FROM (
        SELECT
            im."interest_id",
            im."month_year",
            im."composition",
            ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
        FROM
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
        WHERE
            im."composition" IS NOT NULL
    ) mc
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON mc."interest_id" = imap."id"
    WHERE
        mc.rn = 1
    ORDER BY
        mc."composition" ASC
    LIMIT 10
)
ORDER BY
    "Composition_Value" DESC;
```

**Explanation:**

The syntax error occurred because `ORDER BY` and `LIMIT` clauses cannot be used directly before a `UNION ALL` without enclosing the queries in parentheses. By enclosing each `SELECT` statement (including its `ORDER BY` and `LIMIT` clauses) within parentheses, we ensure that each query is correctly structured, and the `UNION ALL` can combine their results.

This query:

- **Selects the maximum composition value for each interest category** by using `ROW_NUMBER()` partitioned by `"interest_id"` and ordered by `"composition"` descending.
- **Retrieves the corresponding time and interest name** by joining with the `INTEREST_MAP` table.
- **Fetches the top 10 interest categories** with the highest maximum composition values.
- **Fetches the bottom 10 interest categories** with the lowest maximum composition values.
- **Combines the results with `UNION ALL`** and orders the final result by `"Composition_Value"` in descending order.

This single SQL query addresses the task and should execute without syntax errors.
2025-01-19 14:28:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:28:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:28:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:28:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:28:45 - snowflake.connector.connection - INFO - closed
2025-01-19 14:28:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:28:45 - root - INFO - SQL:
(
    SELECT
        mc."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        mc."composition" AS "Composition_Value"
    FROM (
        SELECT
            im."interest_id",
            im."month_year",
            im."composition",
            ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
        FROM
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
        WHERE
            im."composition" IS NOT NULL
    ) mc
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON mc."interest_id" = imap."id"
    WHERE
        mc.rn = 1
    ORDER BY
        mc."composition" DESC
    LIMIT 10
)
UNION ALL
(
    SELECT
        mc."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        mc."composition" AS "Composition_Value"
    FROM (
        SELECT
            im."interest_id",
            im."month_year",
            im."composition",
            ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
        FROM
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
        WHERE
            im."composition" IS NOT NULL
    ) mc
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON mc."interest_id" = imap."id"
    WHERE
        mc.rn = 1
    ORDER BY
        mc."composition" ASC
    LIMIT 10
)
ORDER BY
    "Composition_Value" DESC;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-19 14:28:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:28:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:28:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:28:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:28:47 - snowflake.connector.connection - INFO - closed
2025-01-19 14:28:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:28:47 - root - INFO - SQL:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" > 0
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.

2025-01-19 14:28:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:28:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:28:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:28:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 14:28:48 - snowflake.connector.connection - INFO - closed
2025-01-19 14:28:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:29:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:29:43 - root - INFO - ```sql
(
    SELECT
        im."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        im."composition" AS "Composition_Value"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    ORDER BY
        im."composition" DESC
    LIMIT 10
)
UNION ALL
(
    SELECT
        im."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        im."composition" AS "Composition_Value"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    ORDER BY
        im."composition" ASC
    LIMIT 10
)
ORDER BY
    "Composition_Value" DESC;
```
2025-01-19 14:29:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:29:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:29:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:29:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:29:45 - snowflake.connector.connection - INFO - closed
2025-01-19 14:29:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:29:45 - root - INFO - SQL:
(
    SELECT
        im."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        im."composition" AS "Composition_Value"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    ORDER BY
        im."composition" DESC
    LIMIT 10
)
UNION ALL
(
    SELECT
        im."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        im."composition" AS "Composition_Value"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    ORDER BY
        im."composition" ASC
    LIMIT 10
)
ORDER BY
    "Composition_Value" DESC;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
10-2018,Work Comes First Travelers,20.28
11-2018,Work Comes First Travelers,19.45
01-2019,Work Comes First Travelers,18.99
07-2018,Gym Equipment Owners,18.82
02-2019,Work Comes First Travelers,18.39
09-2018,Work Comes First Travelers,18.18
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
05-2019,Gastrointestinal Researchers,1.52
03-2019,World of Warcraft Enthusiasts,1.52
06-2019,Disney Fans,1.52
04-2019,United Nations Donors,1.52
05-2019,Beer Aficionados,1.52
04-2019,Minnesota Vikings Fans,1.52
05-2019,Philadelphia 76ers Fans,1.52
06-2019,New York Giants Fans,1.52
08-2018,Readers of Jamaican Content,1.52
05-2019,Mowing Equipment Shoppers,1.51

2025-01-19 14:29:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:29:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:29:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:29:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 14:29:46 - snowflake.connector.connection - INFO - closed
2025-01-19 14:29:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:30:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:30:37 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM
    max_compositions
WHERE
    rn = 1
ORDER BY
    "Composition_Value" DESC
LIMIT 10

UNION ALL

SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM
    max_compositions
WHERE
    rn = 1
ORDER BY
    "Composition_Value" ASC
LIMIT 10
ORDER BY
    "Composition_Value" DESC;
```
2025-01-19 14:30:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:30:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:30:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:30:39 - snowflake.connector.connection - INFO - closed
2025-01-19 14:30:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:31:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:31:44 - root - INFO - It seems you're encountering a syntax error due to the use of `ORDER BY` and `LIMIT` clauses within the `UNION ALL` statement. In SQL, when using `UNION ALL`, the individual `SELECT` statements cannot contain `ORDER BY` clauses unless enclosed properly, and the `ORDER BY` should generally be applied to the entire result set.

Here's a corrected SQL query that should execute without errors:

```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS rn_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS rn_asc
    FROM
        max_compositions
    WHERE
        rn = 1
) sub
WHERE
    rn_desc <= 10 OR rn_asc <= 10
ORDER BY
    "Composition_Value" DESC;
```

**Explanation:**

1. **Calculate Maximum Composition per Interest Category:**
   - The `max_compositions` CTE (Common Table Expression) calculates the highest composition value for each interest category.
   - It uses `ROW_NUMBER()` to assign a rank (`rn`) within each `interest_id`, ordering by `"composition"` descending.

2. **Assign Overall Rankings:**
   - In the subquery, we assign two new rankings:
     - `rn_desc`: Ranks compositions from highest to lowest.
     - `rn_asc`: Ranks compositions from lowest to highest.

3. **Select Top and Bottom 10 Categories:**
   - The `WHERE` clause filters records where either `rn_desc` is less than or equal to 10 (top 10) or `rn_asc` is less than or equal to 10 (bottom 10).

4. **Order Final Results:**
   - The final `ORDER BY` clause sorts the combined result set in descending order of `"Composition_Value"`.

**Why This Works:**

- **Avoids Syntax Errors:**
  - By assigning ranks and filtering in the outer query, we eliminate the need for `ORDER BY` and `LIMIT` clauses within individual subqueries of the `UNION ALL`, which can cause syntax errors.
  
- **Efficient Ranking:**
  - Using `ROW_NUMBER()` allows us to efficiently rank the records without the need for multiple subqueries or complex joins.

**Additional Notes:**

- **Data Validation:**
  - Ensure that all columns (`"interest_id"`, `"interest_name"`, `"month_year"`, and `"composition"`) exist and contain valid data.

- **Date Formats:**
  - If you encounter issues with the `"month_year"` field, verify its format and data. It should be in `MM-YYYY` format.

- **Handling Nulls:**
  - The query filters out records where `"composition"` is `NULL`. If there are any `NULL` values you wish to include or handle differently, adjust the `WHERE` clause accordingly.

**Example Output Format:**

Assuming the query executes successfully, the output will be in the following format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1,str,composition_value1
MM-YYYY2,str,composition_value2
...
```

- The top 10 interest categories based on their highest composition values will be listed first.
- Followed by the bottom 10 interest categories based on their highest composition values.
- The entire result set is ordered in descending order of `Composition_Value`.

**Possible Reasons for Previous Errors:**

- **Misplaced `ORDER BY` Clauses:**
  - Using `ORDER BY` within subqueries of a `UNION ALL` without proper nesting can lead to syntax errors.

- **Multiple `ORDER BY` Clauses:**
  - Only one `ORDER BY` should be used in the overall query when combining results with `UNION ALL`.

- **SQL Dialect Differences:**
  - Some SQL dialects have specific rules about the use of `ORDER BY` and `LIMIT` in subqueries and `UNION` operations.

**Testing the Query:**

- **Run the Query:**
  - Execute the query in your SQL environment.
  
- **Verify Results:**
  - Check that the output includes the top 10 and bottom 10 interest categories as per the composition values.

- **Troubleshoot If Needed:**
  - If you encounter further errors, verify each part of the query and ensure all table and column names are correct.

**Alternative Approach Without `UNION ALL`:**

If you prefer to avoid `UNION ALL`, you can adjust the query to select both top and bottom records in a single result set:

```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC;
```

**Conclusion:**

- The provided SQL query should resolve the syntax errors and fulfill the task requirement.
- Let me know if you need further assistance or if any additional issues arise.

**Note:** The error message you mentioned seems to reference a different query involving `UNION`. Ensure that you're running the corrected query above and that any previous queries causing errors are not being confused with the current one.
2025-01-19 14:31:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:31:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:31:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:31:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:31:46 - snowflake.connector.connection - INFO - closed
2025-01-19 14:31:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:31:46 - root - INFO - SQL:
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-19 14:31:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:31:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:31:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:31:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:31:48 - snowflake.connector.connection - INFO - closed
2025-01-19 14:31:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:31:48 - root - INFO - SQL:
SELECT "interest_id", "percentile_ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Results:
Too long, hard cut:
interest_id,percentile_ranking
32486.0,99.86
6106.0,99.73
18923.0,99.59
6344.0,99.45
100.0,99.31
69.0,99.18
79.0,99.04
6111.0,98.9
6214.0,98.9
19422.0,98.63
6110.0,98.49
4895.0,98.35
6217.0,98.22
4.0,98.08
6218.0,97.94
6123.0,97.81
171.0,97.67
19613.0,97.53
17.0,97.39
6.0,97.26
6013.0,97.12
4870.0,96.98
19423.0,96.84
6089.0,96.71
161.0,96.57
6286.0,96.57
5991.0,96.3
92.0,96.16
6184.0,96.02
19621.0,95.88
63.0,95.75
103.0,95.61
38.0,95.47
17786.0,95.34
6232.0,95.2
165.0,95.06
18351.0,94.92
15.0,94.79
,96.4
17314.0,94.65
6151.0,94.65
4914.0,94.65
115.0,94.24
5968.0,94.24
36.0,93.96
5943.0,93.83
133.0,93.69
1.0,93.69
114.0,93.42
6107.0,93.28
150.0,93.28
60.0,93.0
96.0,92.87
22403.0,92.73
40.0,92.59
19758.0,92.59
17730.0,92.32
5938.0,92.18
4869.0,92.18
4897.0,91.91
6029.0,91.77
31.0,91.77
16137.0,91.5
6330.0,91.36
6334.0,91.36
6315.0,91.36
4852.0,90.95
16.0,90.95
6108.0,90.67
6206.0,90.67
6006.0,90.4
6228.0,90.4
20768.0,90.4
4902.0,89.99
6277.0,89.85
19757.0,89.71
4911.0,89.71
,96.23
4910.0,89.44
6285.0,89.3
11974.0,89.16
6219.0,89.16
10250.0,88.89
6128.0,88.75
5946.0,88.61
158.0,88.61
15935.0,88.34
4855.0,88.2
149.0,88.2
16197.0,87.93
11067.0,87.79
17674.0,87.65
4913.0,87.65
56.0,87.38
6341.0,87.38
6316.0,87.38
18647.0,87.38
17803.0,87.38
23.0,86.69
132.0,86.56
6365.0,86.56
6378.0,86.28
17673.0,86.15
97.0,86.15
7537.0,86.15
20764.0,86.15
44.0,85.6
5.0,85.6
6227.0,85.6
19.0,85.19
93.0,85.19
6085.0,84.91
6112.0,84.77
4873.0,84.64
11975.0,84.5
22502.0,84.36
86.0,84.36
19610.0,84.09
20753.0,83.95
24.0,83.95
20750.0,83.95
12133.0,83.95
6141.0,83.4
6172.0,83.4
98.0,83.4
125.0,82.99
17269.0,82.99
4943.0,82.72
18996.0,82.72
13.0,82.72
89.0,82.72
169.0,82.17
101.0,82.17
6087.0,81.89
104.0,81.89
6284.0,81.89
7557.0,81.89
37.0,81.89
6084.0,81.21
8.0,81.07
5969.0,81.07
39.0,81.07
117.0,80.66
19298.0,80.52
22427.0,80.52
85.0,80.25
5952.0,80.25
164.0,80.25
19587.0,79.84
33.0,79.84
135.0,79.56
19588.0,79.42
17320.0,79.42
77.0,79.42
18648.0,79.01
5989.0,78.88
138.0,78.74
18202.0,78.74
137.0,78.46
4940.0,78.33
12277.0,78.33
4909.0,78.33
4944.0,78.33
10008.0,77.78
6299.0,77.64
20731.0,77.64
10838.0,77.64
111.0,77.64
6127.0,77.09
6304.0,77.09
61.0,77.09
6211.0,76.68
66.0,76.68
6182.0,76.68
151.0,76.68
3.0,76.13
10976.0,75.99
18646.0,75.99
21242.0,75.99
7453.0,75.58
6162.0,75.45
128.0,75.45
5972.0,75.45
6171.0,75.03
131.0,75.03
21293.0,75.03
7461.0,75.03
17785.0,75.03
10839.0,75.03
4912.0,75.03
6318.0,74.07
7605.0,74.07
4905.0,74.07
6023.0,74.07
67.0,73.53
16138.0,73.53
5960.0,73.53
6308.0,73.53
18621.0,73.53
4861.0,72.84
12.0,72.7
90.0,72.7
19630.0,72.7
6278.0,72.29
70.0,72.29
64.0,72.29
19579.0,72.29
6329.0,71.74
5970.0,71.74
4907.0,71.47
6076.0,71.47
18490.0,71.19
20767.0,71.19
147.0,71.19
10837.0,70.78
130.0,70.78
5914.0,70.78
6144.0,70.78
88.0,70.23
6255.0,70.23
27.0,70.23
6336.0,70.23
5921.0,69.68
19879.0,69.68
15877.0,69.41
21057.0,69.41
148.0,69.14
32704.0,69.14
5951.0,69.14
6062.0,69.14
4915.0,68.59
6133.0,68.59
6250.0,68.59
6143.0,68.59
49.0,68.59
6173.0,67.9
75.0,67.76
19614.0,67.76
18781.0,67.49
4848.0,67.49
6237.0,67.49
19760.0,67.49
5930.0,66.94
6302.0,66.94
13496.0,66.94
12820.0,66.94
4920.0,66.39
6115.0,66.26
22425.0,66.26
73.0,66.26
22096.0,65.84
6337.0,65.84
6265.0,65.84
19295.0,65.43
18347.0,65.43
6343.0,65.43
6207.0,65.43
18350.0,65.43
6064.0,64.75
18622.0,64.75
141.0,64.75
6181.0,64.75
6148.0,64.75
10977.0,64.75
6045.0,63.92
6298.0,63.92
6145.0,63.92
22.0,63.92
12132.0,63.92
4918.0,63.92
17671.0,63.1
5906.0,63.1
35.0,62.83
5911.0,62.83
6340.0,62.83
21292.0,62.41
19250.0,62.41
19294.0,62.41
163.0,62.0
82.0,62.0
13498.0,62.0
4925.0,62.0
109.0,62.0
6319.0,62.0
33191.0,61.18
10365.0,61.18
6366.0,60.91
4898.0,60.91
4894.0,60.63
12027.0,60.63
5963.0,60.63
6260.0,60.63
4917.0,60.63
7425.0,60.63
20817.0,60.63
16119.0,59.67
5999.0,59.67
5907.0,59.4
18784.0,59.4
65.0,59.12
5898.0,59.12
6220.0,59.12
19296.0,59.12
6264.0,59.12
6051.0,59.12
5918.0,58.3
5895.0,58.3
12602.0,58.02
5901.0,58.02
34.0,57.75
10988.0,57.61
116.0,57.61
4866.0,57.61
6095.0,57.61
6229.0,57.61
13421.0,57.61
102.0,56.79
4919.0,56.65
20814.0,56.65
4904.0,56.65
7527.0,56.24
12026.0,56.24
4924.0,55.97
21061.0,55.97
20963.0,55.69
6323.0,55.69
5944.0,55.69
14.0,55.69
6221.0,55.14
99.0,55.14
6210.0,55.14
139.0,55.14
74.0,55.14
19603.0,54.46
5924.0,54.46
126.0,54.46
5920.0,54.46
7529.0,54.46
95.0,53.77
21059.0,53.77
162.0,53.5
41.0,53.5
10972.0,53.5
5942.0,53.09
22413.0,53.09
7540.0,52.81
5896.0,52.81
22424.0,52.54
26.0,52.54
19338.0,52.54
4847.0,52.54
19578.0,52.54
6263.0,51.85
12490.0,51.71
22428.0,51.71
21237.0,51.71
10980.0,51.71
5984.0,51.71
6267.0,51.03
6235.0,51.03
45.0,51.03
18620.0,51.03
12025.0,50.48
43.0,50.34
119.0,50.34
6266.0,50.07
4859.0,50.07
6077.0,49.79
21058.0,49.79
155.0,49.52
4857.0,49.52
12031.0,49.52
10978.0,49.11
22419.0,49.11
107.0,49.11
5913.0,49.11
32703.0,48.56
19619.0,48.42
19627.0,48.42
17318.0,48.15
21060.0,48.01
5961.0,48.01
5910.0,48.01
18997.0,47.6
5957.0,47.6
83.0,47.6
19592.0,47.19
160.0,47.05
6142.0,47.05
87.0,46.78
22423.

2025-01-19 14:31:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:31:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:31:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:31:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:31:49 - snowflake.connector.connection - INFO - closed
2025-01-19 14:31:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:31:50 - root - INFO - SQL:
SELECT "interest_id", "index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Results:
Too long, hard cut:
interest_id,index_value
32486.0,6.19
6106.0,5.31
18923.0,5.29
6344.0,5.1
100.0,5.04
69.0,5.03
79.0,4.97
6111.0,4.83
6214.0,4.83
19422.0,4.81
6110.0,4.79
4895.0,4.67
6217.0,4.62
4.0,4.53
6218.0,4.5
6123.0,4.49
171.0,4.47
19613.0,4.38
17.0,4.15
6.0,4.08
6013.0,3.99
4870.0,3.95
19423.0,3.92
6089.0,3.84
161.0,3.82
6286.0,3.82
5991.0,3.81
92.0,3.77
6184.0,3.75
19621.0,3.74
63.0,3.73
103.0,3.69
38.0,3.66
17786.0,3.65
6232.0,3.64
165.0,3.59
18351.0,3.58
15.0,3.56
,2.85
17314.0,3.55
6151.0,3.55
4914.0,3.55
115.0,3.53
5968.0,3.53
36.0,3.51
5943.0,3.48
133.0,3.44
1.0,3.44
114.0,3.41
6107.0,3.39
150.0,3.39
60.0,3.36
96.0,3.35
22403.0,3.33
40.0,3.32
19758.0,3.32
17730.0,3.3
5938.0,3.29
4869.0,3.29
4897.0,3.27
6029.0,3.26
31.0,3.26
16137.0,3.24
6330.0,3.22
6334.0,3.22
6315.0,3.22
4852.0,3.2
16.0,3.2
6108.0,3.17
6206.0,3.17
6006.0,3.15
6228.0,3.15
20768.0,3.15
4902.0,3.12
6277.0,3.1
19757.0,3.08
4911.0,3.08
,2.84
4910.0,3.07
6285.0,3.04
11974.0,3.02
6219.0,3.02
10250.0,3.01
6128.0,2.98
5946.0,2.97
158.0,2.97
15935.0,2.96
4855.0,2.95
149.0,2.95
16197.0,2.94
11067.0,2.93
17674.0,2.92
4913.0,2.92
56.0,2.91
6341.0,2.91
6316.0,2.91
18647.0,2.91
17803.0,2.91
23.0,2.89
132.0,2.88
6365.0,2.88
6378.0,2.87
17673.0,2.86
97.0,2.86
7537.0,2.86
20764.0,2.86
44.0,2.85
5.0,2.85
6227.0,2.85
19.0,2.84
93.0,2.84
6085.0,2.83
6112.0,2.82
4873.0,2.81
11975.0,2.8
22502.0,2.79
86.0,2.79
19610.0,2.77
20753.0,2.76
24.0,2.76
20750.0,2.76
12133.0,2.76
6141.0,2.75
6172.0,2.75
98.0,2.75
125.0,2.74
17269.0,2.74
4943.0,2.73
18996.0,2.73
13.0,2.73
89.0,2.73
169.0,2.72
101.0,2.72
6087.0,2.71
104.0,2.71
6284.0,2.71
7557.0,2.71
37.0,2.71
6084.0,2.69
8.0,2.68
5969.0,2.68
39.0,2.68
117.0,2.67
19298.0,2.66
22427.0,2.66
85.0,2.63
5952.0,2.63
164.0,2.63
19587.0,2.62
33.0,2.62
135.0,2.61
19588.0,2.6
17320.0,2.6
77.0,2.6
18648.0,2.59
5989.0,2.57
138.0,2.55
18202.0,2.55
137.0,2.54
4940.0,2.53
12277.0,2.53
4909.0,2.53
4944.0,2.53
10008.0,2.52
6299.0,2.51
20731.0,2.51
10838.0,2.51
111.0,2.51
6127.0,2.5
6304.0,2.5
61.0,2.5
6211.0,2.49
66.0,2.49
6182.0,2.49
151.0,2.49
3.0,2.47
10976.0,2.46
18646.0,2.46
21242.0,2.46
7453.0,2.45
6162.0,2.44
128.0,2.44
5972.0,2.44
6171.0,2.43
131.0,2.43
21293.0,2.43
7461.0,2.43
17785.0,2.43
10839.0,2.43
4912.0,2.43
6318.0,2.41
7605.0,2.41
4905.0,2.41
6023.0,2.41
67.0,2.4
16138.0,2.4
5960.0,2.4
6308.0,2.4
18621.0,2.4
4861.0,2.39
12.0,2.38
90.0,2.38
19630.0,2.38
6278.0,2.37
70.0,2.37
64.0,2.37
19579.0,2.37
6329.0,2.36
5970.0,2.36
4907.0,2.35
6076.0,2.35
18490.0,2.33
20767.0,2.33
147.0,2.33
10837.0,2.32
130.0,2.32
5914.0,2.32
6144.0,2.32
88.0,2.31
6255.0,2.31
27.0,2.31
6336.0,2.31
5921.0,2.29
19879.0,2.29
15877.0,2.28
21057.0,2.28
148.0,2.27
32704.0,2.27
5951.0,2.27
6062.0,2.27
4915.0,2.26
6133.0,2.26
6250.0,2.26
6143.0,2.26
49.0,2.26
6173.0,2.25
75.0,2.24
19614.0,2.24
18781.0,2.23
4848.0,2.23
6237.0,2.23
19760.0,2.23
5930.0,2.22
6302.0,2.22
13496.0,2.22
12820.0,2.22
4920.0,2.21
6115.0,2.2
22425.0,2.2
73.0,2.2
22096.0,2.19
6337.0,2.19
6265.0,2.19
19295.0,2.18
18347.0,2.18
6343.0,2.18
6207.0,2.18
18350.0,2.18
6064.0,2.17
18622.0,2.17
141.0,2.17
6181.0,2.17
6148.0,2.17
10977.0,2.17
6045.0,2.16
6298.0,2.16
6145.0,2.16
22.0,2.16
12132.0,2.16
4918.0,2.16
17671.0,2.15
5906.0,2.15
35.0,2.14
5911.0,2.14
6340.0,2.14
21292.0,2.13
19250.0,2.13
19294.0,2.13
163.0,2.12
82.0,2.12
13498.0,2.12
4925.0,2.12
109.0,2.12
6319.0,2.12
33191.0,2.11
10365.0,2.11
6366.0,2.1
4898.0,2.1
4894.0,2.09
12027.0,2.09
5963.0,2.09
6260.0,2.09
4917.0,2.09
7425.0,2.09
20817.0,2.09
16119.0,2.08
5999.0,2.08
5907.0,2.07
18784.0,2.07
65.0,2.06
5898.0,2.06
6220.0,2.06
19296.0,2.06
6264.0,2.06
6051.0,2.06
5918.0,2.05
5895.0,2.05
12602.0,2.04
5901.0,2.04
34.0,2.03
10988.0,2.02
116.0,2.02
4866.0,2.02
6095.0,2.02
6229.0,2.02
13421.0,2.02
102.0,2.01
4919.0,2.0
20814.0,2.0
4904.0,2.0
7527.0,1.99
12026.0,1.99
4924.0,1.98
21061.0,1.98
20963.0,1.97
6323.0,1.97
5944.0,1.97
14.0,1.97
6221.0,1.96
99.0,1.96
6210.0,1.96
139.0,1.96
74.0,1.96
19603.0,1.95
5924.0,1.95
126.0,1.95
5920.0,1.95
7529.0,1.95
95.0,1.94
21059.0,1.94
162.0,1.93
41.0,1.93
10972.0,1.93
5942.0,1.92
22413.0,1.92
7540.0,1.91
5896.0,1.91
22424.0,1.9
26.0,1.9
19338.0,1.9
4847.0,1.9
19578.0,1.9
6263.0,1.89
12490.0,1.88
22428.0,1.88
21237.0,1.88
10980.0,1.88
5984.0,1.88
6267.0,1.87
6235.0,1.87
45.0,1.87
18620.0,1.87
12025.0,1.86
43.0,1.85
119.0,1.85
6266.0,1.84
4859.0,1.84
6077.0,1.83
21058.0,1.83
155.0,1.82
4857.0,1.82
12031.0,1.82
10978.0,1.81
22419.0,1.81
107.0,1.81
5913.0,1.81
32703.0,1.8
19619.0,1.79
19627.0,1.79
17318.0,1.78
21060.0,1.77
5961.0,1.77
5910.0,1.77
18997.0,1.76
5957.0,1.76
83.0,1.76
19592.0,1.75
160.0,1.74
6142.0,1.74
87.0,1.73
22423.0,1.73
6164.0,1.72
18352.0,1.72
113.0,1.71
21236.0,1.71
6183.0,1.7
21238.0,1.7
80.0,1.69
6081.0,1.69
6208.0,1.69
91.0,1.69
23778.0,1.68
18204.0,1.66
17540.0,1.66
21239.0,1.66
19628.0,1.66
18995.0,1.66
19590.0,1.65
29.0,1.65
22095.0,1.64
145.0,1.64
19297.0,1.63
19600.0,1.63
10870.0,1.62
6160.0,1.62
18998.0,1.62
6314.0,1.62
20815.0,1.61
6301.0,1.61
48.0,1.61
10869.0,1.61
6024.0,1.61
606

2025-01-19 14:31:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:31:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:31:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:31:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 14:31:51 - snowflake.connector.connection - INFO - closed
2025-01-19 14:31:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:32:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:32:56 - root - INFO - ```sql
SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
ORDER BY
    im."composition" DESC
LIMIT 10;
```
2025-01-19 14:32:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:32:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:32:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:32:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-19 14:32:57 - snowflake.connector.connection - INFO - closed
2025-01-19 14:32:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:32:58 - root - INFO - SQL:
SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
ORDER BY
    im."composition" DESC
LIMIT 10;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
10-2018,Work Comes First Travelers,20.28
11-2018,Work Comes First Travelers,19.45
01-2019,Work Comes First Travelers,18.99
07-2018,Gym Equipment Owners,18.82
02-2019,Work Comes First Travelers,18.39
09-2018,Work Comes First Travelers,18.18
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15

2025-01-19 14:32:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:32:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:32:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:32:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:32:59 - snowflake.connector.connection - INFO - closed
2025-01-19 14:32:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:33:00 - root - INFO - SQL:
SELECT "interest_id", "ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "ranking" IS NOT NULL
    LIMIT 1000;
Results:
Too long, hard cut:
interest_id,ranking
32486.0,1
6106.0,2
18923.0,3
6344.0,4
100.0,5
69.0,6
79.0,7
6111.0,8
6214.0,8
19422.0,10
6110.0,11
4895.0,12
6217.0,13
4.0,14
6218.0,15
6123.0,16
171.0,17
19613.0,18
17.0,19
6.0,20
6013.0,21
4870.0,22
19423.0,23
6089.0,24
161.0,25
6286.0,25
5991.0,27
92.0,28
6184.0,29
19621.0,30
63.0,31
103.0,32
38.0,33
17786.0,34
6232.0,35
165.0,36
18351.0,37
15.0,38
,43
17314.0,39
6151.0,39
4914.0,39
115.0,42
5968.0,42
36.0,44
5943.0,45
133.0,46
1.0,46
114.0,48
6107.0,49
150.0,49
60.0,51
96.0,52
22403.0,53
40.0,54
19758.0,54
17730.0,56
5938.0,57
4869.0,57
4897.0,59
6029.0,60
31.0,60
16137.0,62
6330.0,63
6334.0,63
6315.0,63
4852.0,66
16.0,66
6108.0,68
6206.0,68
6006.0,70
6228.0,70
20768.0,70
4902.0,73
6277.0,74
19757.0,75
4911.0,75
,45
4910.0,77
6285.0,78
11974.0,79
6219.0,79
10250.0,81
6128.0,82
5946.0,83
158.0,83
15935.0,85
4855.0,86
149.0,86
16197.0,88
11067.0,89
17674.0,90
4913.0,90
56.0,92
6341.0,92
6316.0,92
18647.0,92
17803.0,92
23.0,97
132.0,98
6365.0,98
6378.0,100
17673.0,101
97.0,101
7537.0,101
20764.0,101
44.0,105
5.0,105
6227.0,105
19.0,108
93.0,108
6085.0,110
6112.0,111
4873.0,112
11975.0,113
22502.0,114
86.0,114
19610.0,116
20753.0,117
24.0,117
20750.0,117
12133.0,117
6141.0,121
6172.0,121
98.0,121
125.0,124
17269.0,124
4943.0,126
18996.0,126
13.0,126
89.0,126
169.0,130
101.0,130
6087.0,132
104.0,132
6284.0,132
7557.0,132
37.0,132
6084.0,137
8.0,138
5969.0,138
39.0,138
117.0,141
19298.0,142
22427.0,142
85.0,144
5952.0,144
164.0,144
19587.0,147
33.0,147
135.0,149
19588.0,150
17320.0,150
77.0,150
18648.0,153
5989.0,154
138.0,155
18202.0,155
137.0,157
4940.0,158
12277.0,158
4909.0,158
4944.0,158
10008.0,162
6299.0,163
20731.0,163
10838.0,163
111.0,163
6127.0,167
6304.0,167
61.0,167
6211.0,170
66.0,170
6182.0,170
151.0,170
3.0,174
10976.0,175
18646.0,175
21242.0,175
7453.0,178
6162.0,179
128.0,179
5972.0,179
6171.0,182
131.0,182
21293.0,182
7461.0,182
17785.0,182
10839.0,182
4912.0,182
6318.0,189
7605.0,189
4905.0,189
6023.0,189
67.0,193
16138.0,193
5960.0,193
6308.0,193
18621.0,193
4861.0,198
12.0,199
90.0,199
19630.0,199
6278.0,202
70.0,202
64.0,202
19579.0,202
6329.0,206
5970.0,206
4907.0,208
6076.0,208
18490.0,210
20767.0,210
147.0,210
10837.0,213
130.0,213
5914.0,213
6144.0,213
88.0,217
6255.0,217
27.0,217
6336.0,217
5921.0,221
19879.0,221
15877.0,223
21057.0,223
148.0,225
32704.0,225
5951.0,225
6062.0,225
4915.0,229
6133.0,229
6250.0,229
6143.0,229
49.0,229
6173.0,234
75.0,235
19614.0,235
18781.0,237
4848.0,237
6237.0,237
19760.0,237
5930.0,241
6302.0,241
13496.0,241
12820.0,241
4920.0,245
6115.0,246
22425.0,246
73.0,246
22096.0,249
6337.0,249
6265.0,249
19295.0,252
18347.0,252
6343.0,252
6207.0,252
18350.0,252
6064.0,257
18622.0,257
141.0,257
6181.0,257
6148.0,257
10977.0,257
6045.0,263
6298.0,263
6145.0,263
22.0,263
12132.0,263
4918.0,263
17671.0,269
5906.0,269
35.0,271
5911.0,271
6340.0,271
21292.0,274
19250.0,274
19294.0,274
163.0,277
82.0,277
13498.0,277
4925.0,277
109.0,277
6319.0,277
33191.0,283
10365.0,283
6366.0,285
4898.0,285
4894.0,287
12027.0,287
5963.0,287
6260.0,287
4917.0,287
7425.0,287
20817.0,287
16119.0,294
5999.0,294
5907.0,296
18784.0,296
65.0,298
5898.0,298
6220.0,298
19296.0,298
6264.0,298
6051.0,298
5918.0,304
5895.0,304
12602.0,306
5901.0,306
34.0,308
10988.0,309
116.0,309
4866.0,309
6095.0,309
6229.0,309
13421.0,309
102.0,315
4919.0,316
20814.0,316
4904.0,316
7527.0,319
12026.0,319
4924.0,321
21061.0,321
20963.0,323
6323.0,323
5944.0,323
14.0,323
6221.0,327
99.0,327
6210.0,327
139.0,327
74.0,327
19603.0,332
5924.0,332
126.0,332
5920.0,332
7529.0,332
95.0,337
21059.0,337
162.0,339
41.0,339
10972.0,339
5942.0,342
22413.0,342
7540.0,344
5896.0,344
22424.0,346
26.0,346
19338.0,346
4847.0,346
19578.0,346
6263.0,351
12490.0,352
22428.0,352
21237.0,352
10980.0,352
5984.0,352
6267.0,357
6235.0,357
45.0,357
18620.0,357
12025.0,361
43.0,362
119.0,362
6266.0,364
4859.0,364
6077.0,366
21058.0,366
155.0,368
4857.0,368
12031.0,368
10978.0,371
22419.0,371
107.0,371
5913.0,371
32703.0,375
19619.0,376
19627.0,376
17318.0,378
21060.0,379
5961.0,379
5910.0,379
18997.0,382
5957.0,382
83.0,382
19592.0,385
160.0,386
6142.0,386
87.0,388
22423.0,388
6164.0,390
18352.0,390
113.0,392
21236.0,392
6183.0,394
21238.0,394
80.0,396
6081.0,396
6208.0,396
91.0,396
23778.0,400
18204.0,401
17540.0,401
21239.0,401
19628.0,401
18995.0,401
19590.0,406
29.0,406
22095.0,408
145.0,408
19297.0,410
19600.0,410
10870.0,412
6160.0,412
18998.0,412
6314.0,412
20815.0,416
6301.0,416
48.0,416
10869.0,416
6024.0,416
6067.0,421
17672.0,422
6234.0,423
7535.0,423
5958.0,423
157.0,423
6305.0,423
6177.0,423
6328.0,423
143.0,430
4930.0,430
22411.0,430
30.0,430
10835.0,430
19617.0,435
18782.0,435
5956.0,437
4928.0,437
59.0,439
14901.0,439
20756.0,439
55.0,439
6321.0,443
13497.0,444
6320.0,444
18619.0,446
6030.0,447
168.0,447
6322.0,447
134.0,447
32485.0,447
17271.0,447
10284.0,453
6209.0,454
10981.0,454
6169.0,456
142.0,456
6131.0,456
19625.0,456
28.0,456
6194.0,456
19633.0,462
153.0,462
10832.0,462
19606.0,462
6088.0,

2025-01-19 14:33:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:33:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:33:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:33:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:33:01 - snowflake.connector.connection - INFO - closed
2025-01-19 14:33:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:33:01 - root - INFO - SQL:
SELECT "composition", "index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Results:
Too long, hard cut:
composition,index_value
11.89,6.19
9.93,5.31
10.85,5.29
10.32,5.1
10.77,5.04
10.82,5.03
11.21,4.97
10.71,4.83
9.71,4.83
10.11,4.81
11.57,4.79
9.47,4.67
10.8,4.62
13.97,4.53
9.29,4.5
9.49,4.49
14.91,4.47
12.62,4.38
7.89,4.15
11.99,4.08
9.35,3.99
10.29,3.95
12.22,3.92
6.97,3.84
11.48,3.82
14.1,3.82
11.04,3.81
9.77,3.77
13.35,3.75
11.61,3.74
9.37,3.73
6.61,3.69
9.48,3.66
13.67,3.65
9.97,3.64
6.05,3.59
6.09,3.58
6.9,3.56
6.12,2.85
10.43,3.55
6.83,3.55
7.42,3.55
11.68,3.53
12.87,3.53
9.27,3.51
6.37,3.48
10.91,3.44
7.02,3.44
6.25,3.41
8.84,3.39
5.3,3.39
6.71,3.36
7.21,3.35
12.27,3.33
10.86,3.32
6.28,3.32
11.38,3.3
11.63,3.29
6.47,3.29
12.93,3.27
8.72,3.26
7.9,3.26
9.65,3.24
6.82,3.22
11.63,3.22
8.14,3.22
6.77,3.2
6.24,3.2
6.65,3.17
10.76,3.17
6.26,3.15
10.22,3.15
6.53,3.15
8.17,3.12
11.72,3.1
10.95,3.08
6.87,3.08
7.13,2.84
6.09,3.07
9.97,3.04
7.19,3.02
6.37,3.02
11.4,3.01
6.28,2.98
5.99,2.97
7.46,2.97
9.13,2.96
5.99,2.95
6.88,2.95
6.13,2.94
5.14,2.93
6.25,2.92
6.76,2.92
7.09,2.91
5.68,2.91
6.52,2.91
6.45,2.91
6.21,2.91
5.41,2.89
7.48,2.88
6.45,2.88
9.64,2.87
8.07,2.86
6.41,2.86
7.82,2.86
5.85,2.86
6.11,2.85
10.82,2.85
6.07,2.85
6.57,2.84
7.08,2.84
7.08,2.83
9.22,2.82
5.45,2.81
7.81,2.8
8.24,2.79
6.13,2.79
7.56,2.77
5.79,2.76
6.54,2.76
5.87,2.76
10.79,2.76
6.34,2.75
5.88,2.75
7.64,2.75
6.38,2.74
8.64,2.74
8.81,2.73
7.84,2.73
6.72,2.73
8.48,2.73
6.1,2.72
7.38,2.72
5.41,2.71
5.42,2.71
18.82,2.71
8.17,2.71
7.82,2.71
6.97,2.69
6.67,2.68
11.15,2.68
17.44,2.68
6.49,2.67
10.27,2.66
8.04,2.66
6.46,2.63
7.11,2.63
6.14,2.63
5.85,2.62
7.6,2.62
7.01,2.61
5.87,2.6
3.98,2.6
17.19,2.6
7.1,2.59
5.57,2.57
7.3,2.55
7.61,2.55
7.94,2.54
5.89,2.53
6.2,2.53
7.01,2.53
8.32,2.53
9.46,2.52
5.71,2.51
5.86,2.51
6.8,2.51
7.42,2.51
5.96,2.5
8.31,2.5
6.59,2.5
8.09,2.49
6.51,2.49
6.57,2.49
7.97,2.49
6.14,2.47
8.16,2.46
6.85,2.46
7.36,2.46
6.45,2.45
6.32,2.44
6.5,2.44
6.58,2.44
8.19,2.43
5.09,2.43
7.28,2.43
7.0,2.43
7.66,2.43
5.59,2.43
7.77,2.43
6.65,2.41
6.82,2.41
5.66,2.41
8.02,2.41
6.67,2.4
8.81,2.4
7.86,2.4
7.67,2.4
7.31,2.4
5.29,2.39
7.23,2.38
5.91,2.38
7.15,2.38
6.18,2.37
6.96,2.37
8.8,2.37
6.24,2.37
7.63,2.36
9.21,2.36
6.26,2.35
5.75,2.35
7.09,2.33
7.73,2.33
6.17,2.33
7.48,2.32
7.66,2.32
6.4,2.32
6.61,2.32
4.99,2.31
7.55,2.31
6.81,2.31
8.5,2.31
7.37,2.29
6.95,2.29
5.77,2.28
10.95,2.28
5.49,2.27
8.04,2.27
6.09,2.27
7.33,2.27
6.28,2.26
3.82,2.26
5.54,2.26
5.47,2.26
5.09,2.26
7.66,2.25
7.23,2.24
5.57,2.24
6.56,2.23
6.49,2.23
7.7,2.23
5.36,2.23
6.17,2.22
7.41,2.22
6.78,2.22
6.07,2.22
5.93,2.21
6.67,2.2
6.41,2.2
7.06,2.2
6.56,2.19
7.02,2.19
7.31,2.19
8.44,2.18
7.8,2.18
8.15,2.18
7.81,2.18
6.85,2.18
7.02,2.17
7.44,2.17
7.77,2.17
6.11,2.17
7.13,2.17
8.3,2.17
7.42,2.16
5.38,2.16
6.1,2.16
6.26,2.16
7.12,2.16
6.29,2.16
5.65,2.15
7.69,2.15
5.25,2.14
6.94,2.14
7.44,2.14
7.19,2.13
7.45,2.13
7.22,2.13
6.4,2.12
9.99,2.12
6.42,2.12
6.4,2.12
6.75,2.12
7.39,2.12
3.99,2.11
5.21,2.11
6.6,2.1
14.23,2.1
5.81,2.09
8.32,2.09
5.36,2.09
5.27,2.09
6.1,2.09
7.43,2.09
3.62,2.09
7.93,2.08
5.14,2.08
7.12,2.07
6.92,2.07
5.94,2.06
7.85,2.06
7.59,2.06
6.66,2.06
7.7,2.06
5.31,2.06
6.8,2.05
7.89,2.05
7.15,2.04
6.79,2.04
8.26,2.03
8.17,2.02
6.31,2.02
6.33,2.02
7.5,2.02
7.2,2.02
7.15,2.02
7.74,2.01
6.35,2.0
3.89,2.0
6.28,2.0
5.97,1.99
7.21,1.99
5.11,1.98
7.23,1.98
5.78,1.97
6.28,1.97
6.39,1.97
3.53,1.97
5.94,1.96
6.79,1.96
6.09,1.96
6.87,1.96
7.37,1.96
6.05,1.95
5.68,1.95
3.8,1.95
6.07,1.95
6.5,1.95
7.15,1.94
6.66,1.94
5.16,1.93
6.96,1.93
7.35,1.93
6.29,1.92
6.26,1.92
6.8,1.91
6.09,1.91
6.05,1.9
6.01,1.9
7.68,1.9
5.65,1.9
4.14,1.9
4.98,1.89
6.85,1.88
5.59,1.88
5.27,1.88
6.14,1.88
4.9,1.88
6.88,1.87
4.67,1.87
6.29,1.87
6.16,1.87
8.45,1.86
5.98,1.85
6.31,1.85
6.64,1.84
6.48,1.84
4.83,1.83
8.5,1.83
4.97,1.82
6.56,1.82
6.67,1.82
6.53,1.81
6.84,1.81
8.32,1.81
6.0,1.81
5.53,1.8
6.0,1.79
3.98,1.79
4.93,1.78
8.58,1.77
7.12,1.77
5.22,1.77
5.8,1.76
6.08,1.76
4.04,1.76
5.08,1.75
5.92,1.74
5.5,1.74
5.01,1.73
5.33,1.73
5.37,1.72
6.55,1.72
5.53,1.71
4.04,1.71
6.71,1.7
4.92,1.7
4.47,1.69
5.92,1.69
9.67,1.69
5.87,1.69
5.13,1.68
5.93,1.66
5.06,1.66
3.52,1.66
4.66,1.66
4.97,1.66
4.59,1.65
5.2,1.65
4.54,1.64
4.89,1.64
4.26,1.63
5.21,1.63
3.29,1.62
4.93,1.62
4.12,1.62
3.77,1.62
3.03,1.61
5.58,1.61
5.33,1.61
5.0,1.61
4.7,1.61
4.71,1.6
4.09,1.59
4.26,1.58
4.18,1.58
4.27,1.58
4.94,1.58
5.84,1.58
4.41,1.58
5.43,1.58
4.68,1.56
4.37,1.56
5.22,1.56
3.0,1.56
5.69,1.56
4.07,1.55
5.64,1.55
4.65,1.54
4.76,1.54
3.97,1.53
3.75,1.53
5.29,1.53
4.0,1.53
4.97,1.52
5.37,1.51
4.72,1.51
9.15,1.5
3.85,1.49
3.75,1.49
5.67,1.49
4.54,1.49
4.31,1.49
3.74,1.49
5.02,1.48
4.45,1.47
5.47,1.47
3.8,1.46
4.73,1.46
2.81,1.46
4.32,1.46
4.84,1.46
4.39,1.46
3.17,1.45
5.08,1.45
4.4,1.45
4.42,1.45
4.28,1.44
4.6,1.44
4.22,1.44
3.18,1.44
4.29,1.44
3.49,1.44
4.54,1.44
3.78,1.43
3.69,1.43
4.22,1.43
4.33,1.43
4.15,1.42
4.37,1.42
3.76,1.42
4.34,1.42
2.62,1.42
4.46,1.42
2.91,1.41
4.23,1.41
3.07,1.4
4.77,1.4
3.94,1.4
10.3,1.4
4.63,1.4
5.08,1.39
4.18,1.38
6.41,1.38
3.42,1.38
4.11,1.37
4.63,1.37
3.47,1.36
4.1,1.36
3.31,1.36
3.52,1.36
4.13,1.3

2025-01-19 14:33:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:33:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:33:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:33:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 14:33:03 - snowflake.connector.connection - INFO - closed
2025-01-19 14:33:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:33:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:33:32 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name",
        MAX(im."composition") AS "Composition_Value",
        MAX(im."month_year") KEEP (DENSE_RANK LAST ORDER BY im."composition") AS "Time(MM-YYYY)"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    GROUP BY
        im."interest_id",
        imap."interest_name"
)
SELECT
    "Time(MM-YYYY)",
    "interest_name" AS "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS asc_rank
    FROM
        max_compositions
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC;
```
2025-01-19 14:33:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:33:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:33:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:33:34 - snowflake.connector.connection - INFO - closed
2025-01-19 14:33:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:34:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:34:03 - root - INFO - It appears that you're encountering a syntax error due to the use of the `KEEP` clause within the `MAX` function. The `KEEP` clause is not supported in Snowflake SQL, which is causing the error in your query. To achieve the desired result without using `KEEP`, we can utilize window functions and the `QUALIFY` clause to identify the maximum composition values and their corresponding times for each interest category.

Here's the corrected SQL query that should execute without errors:

---

```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC;
```

---

**Explanation:**

1. **Identify Maximum Composition per Interest Category:**
   - The `max_compositions` CTE (Common Table Expression) selects each interest category's maximum composition value.
   - The `ROW_NUMBER()` function assigns a rank (`rn`) within each `interest_id` partition, ordering by `"composition"` in descending order.
   - By filtering where `rn = 1`, we select the entry with the highest composition value for each interest category.

2. **Rank the Interest Categories Globally:**
   - In the subquery, we use `ROW_NUMBER()` to assign global ranks based on the composition values:
     - `desc_rank` ranks the categories from highest to lowest composition values.
     - `asc_rank` ranks the categories from lowest to highest composition values.

3. **Select Top and Bottom 10 Categories:**
   - The `WHERE` clause filters for the top 10 (`desc_rank <= 10`) and bottom 10 (`asc_rank <= 10`) categories.
   - We ensure that we get both the highest and lowest interest categories based on their maximum composition values.

4. **Order the Final Results:**
   - The final `ORDER BY` clause sorts the results in descending order of `"Composition_Value"`.

**Sample Output Format:**

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1,str,composition_value1
MM-YYYY2,str,composition_value2
...
```

- The top 10 interest categories based on their highest composition values will be listed first.
- Followed by the bottom 10 interest categories based on their highest composition values.
- The entire result set is ordered in descending order of `"Composition_Value"`.

**Addressing the Error:**

- **Issue with `KEEP` Clause:**
  - The error in your previous query was due to the use of the `MAX` function with the `KEEP (DENSE_RANK LAST ORDER BY ...)` clause, which is not supported in Snowflake SQL.
  - To fix this, we replaced that logic with a window function using `ROW_NUMBER()` to effectively achieve the same result.

- **Use of `QUALIFY`:**
  - The `QUALIFY` clause can be used to filter results after window functions are applied.
  - However, in this case, we included the filtering logic within the subquery to ensure compatibility and clarity.

**Testing the Query:**

- **Execution:**
  - Run the provided SQL query in your Snowflake environment.
  - It should execute without syntax errors and return the desired results.

- **Verification:**
  - Ensure that the output lists the top 10 and bottom 10 interest categories based on their highest composition values.
  - Check that the "Time(MM-YYYY)" reflects the time when each interest category had its highest composition value.

**Conclusion:**

This corrected query avoids the syntax errors and fulfills the task requirements by:

- Retrieving the top 10 and bottom 10 interest categories based on their highest composition values.
- Displaying the time (MM-YYYY), interest name, and the composition value for each category.
- Ordering the results properly for clear presentation.

**Note:**

If you continue to experience errors or have further questions, please let me know, and I'll be happy to assist you further.
2025-01-19 14:34:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:34:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:34:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:34:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:34:05 - snowflake.connector.connection - INFO - closed
2025-01-19 14:34:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:34:05 - root - INFO - SQL:
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-19 14:34:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:34:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:34:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:34:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:34:06 - snowflake.connector.connection - INFO - closed
2025-01-19 14:34:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:34:07 - root - INFO - SQL:
SELECT "interest_id", "_month", "_year"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Results:
Too long, hard cut:
interest_id,_month,_year
32486.0,7.0,2018.0
6106.0,7.0,2018.0
18923.0,7.0,2018.0
6344.0,7.0,2018.0
100.0,7.0,2018.0
69.0,7.0,2018.0
79.0,7.0,2018.0
6111.0,7.0,2018.0
6214.0,7.0,2018.0
19422.0,7.0,2018.0
6110.0,7.0,2018.0
4895.0,7.0,2018.0
6217.0,7.0,2018.0
4.0,7.0,2018.0
6218.0,7.0,2018.0
6123.0,7.0,2018.0
171.0,7.0,2018.0
19613.0,7.0,2018.0
17.0,7.0,2018.0
6.0,7.0,2018.0
6013.0,7.0,2018.0
4870.0,7.0,2018.0
19423.0,7.0,2018.0
6089.0,7.0,2018.0
161.0,7.0,2018.0
6286.0,7.0,2018.0
5991.0,7.0,2018.0
92.0,7.0,2018.0
6184.0,7.0,2018.0
19621.0,7.0,2018.0
63.0,7.0,2018.0
103.0,7.0,2018.0
38.0,7.0,2018.0
17786.0,7.0,2018.0
6232.0,7.0,2018.0
165.0,7.0,2018.0
18351.0,7.0,2018.0
15.0,7.0,2018.0
,,
17314.0,7.0,2018.0
6151.0,7.0,2018.0
4914.0,7.0,2018.0
115.0,7.0,2018.0
5968.0,7.0,2018.0
36.0,7.0,2018.0
5943.0,7.0,2018.0
133.0,7.0,2018.0
1.0,7.0,2018.0
114.0,7.0,2018.0
6107.0,7.0,2018.0
150.0,7.0,2018.0
60.0,7.0,2018.0
96.0,7.0,2018.0
22403.0,7.0,2018.0
40.0,7.0,2018.0
19758.0,7.0,2018.0
17730.0,7.0,2018.0
5938.0,7.0,2018.0
4869.0,7.0,2018.0
4897.0,7.0,2018.0
6029.0,7.0,2018.0
31.0,7.0,2018.0
16137.0,7.0,2018.0
6330.0,7.0,2018.0
6334.0,7.0,2018.0
6315.0,7.0,2018.0
4852.0,7.0,2018.0
16.0,7.0,2018.0
6108.0,7.0,2018.0
6206.0,7.0,2018.0
6006.0,7.0,2018.0
6228.0,7.0,2018.0
20768.0,7.0,2018.0
4902.0,7.0,2018.0
6277.0,7.0,2018.0
19757.0,7.0,2018.0
4911.0,7.0,2018.0
,,
4910.0,7.0,2018.0
6285.0,7.0,2018.0
11974.0,7.0,2018.0
6219.0,7.0,2018.0
10250.0,7.0,2018.0
6128.0,7.0,2018.0
5946.0,7.0,2018.0
158.0,7.0,2018.0
15935.0,7.0,2018.0
4855.0,7.0,2018.0
149.0,7.0,2018.0
16197.0,7.0,2018.0
11067.0,7.0,2018.0
17674.0,7.0,2018.0
4913.0,7.0,2018.0
56.0,7.0,2018.0
6341.0,7.0,2018.0
6316.0,7.0,2018.0
18647.0,7.0,2018.0
17803.0,7.0,2018.0
23.0,7.0,2018.0
132.0,7.0,2018.0
6365.0,7.0,2018.0
6378.0,7.0,2018.0
17673.0,7.0,2018.0
97.0,7.0,2018.0
7537.0,7.0,2018.0
20764.0,7.0,2018.0
44.0,7.0,2018.0
5.0,7.0,2018.0
6227.0,7.0,2018.0
19.0,7.0,2018.0
93.0,7.0,2018.0
6085.0,7.0,2018.0
6112.0,7.0,2018.0
4873.0,7.0,2018.0
11975.0,7.0,2018.0
22502.0,7.0,2018.0
86.0,7.0,2018.0
19610.0,7.0,2018.0
20753.0,7.0,2018.0
24.0,7.0,2018.0
20750.0,7.0,2018.0
12133.0,7.0,2018.0
6141.0,7.0,2018.0
6172.0,7.0,2018.0
98.0,7.0,2018.0
125.0,7.0,2018.0
17269.0,7.0,2018.0
4943.0,7.0,2018.0
18996.0,7.0,2018.0
13.0,7.0,2018.0
89.0,7.0,2018.0
169.0,7.0,2018.0
101.0,7.0,2018.0
6087.0,7.0,2018.0
104.0,7.0,2018.0
6284.0,7.0,2018.0
7557.0,7.0,2018.0
37.0,7.0,2018.0
6084.0,7.0,2018.0
8.0,7.0,2018.0
5969.0,7.0,2018.0
39.0,7.0,2018.0
117.0,7.0,2018.0
19298.0,7.0,2018.0
22427.0,7.0,2018.0
85.0,7.0,2018.0
5952.0,7.0,2018.0
164.0,7.0,2018.0
19587.0,7.0,2018.0
33.0,7.0,2018.0
135.0,7.0,2018.0
19588.0,7.0,2018.0
17320.0,7.0,2018.0
77.0,7.0,2018.0
18648.0,7.0,2018.0
5989.0,7.0,2018.0
138.0,7.0,2018.0
18202.0,7.0,2018.0
137.0,7.0,2018.0
4940.0,7.0,2018.0
12277.0,7.0,2018.0
4909.0,7.0,2018.0
4944.0,7.0,2018.0
10008.0,7.0,2018.0
6299.0,7.0,2018.0
20731.0,7.0,2018.0
10838.0,7.0,2018.0
111.0,7.0,2018.0
6127.0,7.0,2018.0
6304.0,7.0,2018.0
61.0,7.0,2018.0
6211.0,7.0,2018.0
66.0,7.0,2018.0
6182.0,7.0,2018.0
151.0,7.0,2018.0
3.0,7.0,2018.0
10976.0,7.0,2018.0
18646.0,7.0,2018.0
21242.0,7.0,2018.0
7453.0,7.0,2018.0
6162.0,7.0,2018.0
128.0,7.0,2018.0
5972.0,7.0,2018.0
6171.0,7.0,2018.0
131.0,7.0,2018.0
21293.0,7.0,2018.0
7461.0,7.0,2018.0
17785.0,7.0,2018.0
10839.0,7.0,2018.0
4912.0,7.0,2018.0
6318.0,7.0,2018.0
7605.0,7.0,2018.0
4905.0,7.0,2018.0
6023.0,7.0,2018.0
67.0,7.0,2018.0
16138.0,7.0,2018.0
5960.0,7.0,2018.0
6308.0,7.0,2018.0
18621.0,7.0,2018.0
4861.0,7.0,2018.0
12.0,7.0,2018.0
90.0,7.0,2018.0
19630.0,7.0,2018.0
6278.0,7.0,2018.0
70.0,7.0,2018.0
64.0,7.0,2018.0
19579.0,7.0,2018.0
6329.0,7.0,2018.0
5970.0,7.0,2018.0
4907.0,7.0,2018.0
6076.0,7.0,2018.0
18490.0,7.0,2018.0
20767.0,7.0,2018.0
147.0,7.0,2018.0
10837.0,7.0,2018.0
130.0,7.0,2018.0
5914.0,7.0,2018.0
6144.0,7.0,2018.0
88.0,7.0,2018.0
6255.0,7.0,2018.0
27.0,7.0,2018.0
6336.0,7.0,2018.0
5921.0,7.0,2018.0
19879.0,7.0,2018.0
15877.0,7.0,2018.0
21057.0,7.0,2018.0
148.0,7.0,2018.0
32704.0,7.0,2018.0
5951.0,7.0,2018.0
6062.0,7.0,2018.0
4915.0,7.0,2018.0
6133.0,7.0,2018.0
6250.0,7.0,2018.0
6143.0,7.0,2018.0
49.0,7.0,2018.0
6173.0,7.0,2018.0
75.0,7.0,2018.0
19614.0,7.0,2018.0
18781.0,7.0,2018.0
4848.0,7.0,2018.0
6237.0,7.0,2018.0
19760.0,7.0,2018.0
5930.0,7.0,2018.0
6302.0,7.0,2018.0
13496.0,7.0,2018.0
12820.0,7.0,2018.0
4920.0,7.0,2018.0
6115.0,7.0,2018.0
22425.0,7.0,2018.0
73.0,7.0,2018.0
22096.0,7.0,2018.0
6337.0,7.0,2018.0
6265.0,7.0,2018.0
19295.0,7.0,2018.0
18347.0,7.0,2018.0
6343.0,7.0,2018.0
6207.0,7.0,2018.0
18350.0,7.0,2018.0
6064.0,7.0,2018.0
18622.0,7.0,2018.0
141.0,7.0,2018.0
6181.0,7.0,2018.0
6148.0,7.0,2018.0
10977.0,7.0,2018.0
6045.0,7.0,2018.0
6298.0,7.0,2018.0
6145.0,7.0,2018.0
22.0,7.0,2018.0
12132.0,7.0,2018.0
4918.0,7.0,2018.0
17671.0,7.0,2018.0
5906.0,7.0,2018.0
35.0,7.0,2018.0
5911.0,7.0,2018.0
6340.0,7.0,2018.0
21292.0,7.0,2018.0
19250.0,7.0,2018.0
19294.0,7.0,2018.0
163.0,7.0,2018.0
82.0,7.0,2018.0
13498.0,7.0,2018.0
4925

2025-01-19 14:34:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:34:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:34:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:34:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 824
2025-01-19 14:34:08 - snowflake.connector.connection - INFO - closed
2025-01-19 14:34:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:34:09 - root - INFO - SQL:
SELECT "interest_id", "composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "_month" = 6 -- June
    LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
41548.0,5.03
22502.0,4.32
42203.0,3.86
115.0,4.21
6206.0,4.55
19250.0,4.5
44272.0,3.5
151.0,3.9
41854.0,2.86
45518.0,3.24
35904.0,3.42
48154.0,3.34
6285.0,3.85
40439.0,3.45
12133.0,4.21
39665.0,3.54
19298.0,3.71
47713.0,3.1
47130.0,2.97
44588.0,3.17
17269.0,3.23
4.0,3.45
6232.0,2.99
6286.0,3.84
19295.0,3.72
171.0,3.38
37875.0,3.37
38.0,2.86
5970.0,4.39
41069.0,2.74
41191.0,2.85
10008.0,3.84
44446.0,2.55
45678.0,2.87
44489.0,2.55
6219.0,2.68
5969.0,4.63
38990.0,3.24
6378.0,3.52
44453.0,2.86
31.0,2.73
6013.0,2.45
16.0,2.44
49979.0,2.73
44469.0,3.01
6284.0,6.94
44585.0,3.1
6023.0,3.62
16137.0,2.96
6.0,2.87
19423.0,2.97
4897.0,3.66
18347.0,3.34
33.0,3.08
12025.0,4.61
6107.0,2.62
21242.0,3.04
5968.0,3.24
11067.0,2.34
44476.0,2.98
10980.0,3.21
40183.0,2.97
6218.0,2.29
44587.0,2.27
21237.0,3.16
4943.0,2.87
39.0,6.03
79.0,2.4
36879.0,2.91
5960.0,3.12
6144.0,2.83
6305.0,2.96
101.0,2.47
18996.0,3.02
6304.0,3.38
6184.0,2.89
19613.0,2.69
17320.0,2.3
4912.0,2.74
37423.0,2.83
6110.0,2.48
41080.0,2.16
141.0,3.12
38994.0,2.61
32486.0,2.42
32704.0,2.95
39657.0,2.44
44455.0,2.46
34465.0,2.13
18202.0,2.86
41083.0,2.29
49.0,2.43
6142.0,2.75
39649.0,2.3
19621.0,3.11
6343.0,3.08
6029.0,2.27
4924.0,2.63
134.0,2.71
35903.0,2.75
36868.0,2.47
41070.0,2.35
44447.0,2.73
6263.0,2.4
37411.0,2.46
42239.0,1.9
10977.0,3.24
41552.0,2.69
39656.0,2.38
17.0,1.93
158.0,2.57
33191.0,2.13
137.0,2.75
147.0,2.44
6328.0,2.52
64.0,3.17
17673.0,2.37
39331.0,2.07
33959.0,2.02
5944.0,2.53
6250.0,2.28
89.0,2.55
40699.0,1.68
6340.0,2.78
35.0,2.08
30.0,1.99
5896.0,2.97
15.0,2.08
39646.0,1.93
34462.0,2.01
39643.0,1.87
4911.0,2.07
40682.0,2.58
77.0,5.53
7527.0,2.6
40184.0,2.54
33971.0,2.38
18995.0,2.45
10351.0,2.92
41197.0,2.64
88.0,2.12
39336.0,2.0
85.0,2.2
111.0,2.43
21238.0,2.56
5958.0,2.29
44.0,2.06
34469.0,2.33
98.0,2.26
39642.0,1.87
17786.0,2.73
17785.0,2.54
22403.0,2.9
6171.0,2.33
39330.0,1.85
6173.0,2.63
34463.0,1.75
44448.0,1.86
10250.0,2.7
41190.0,2.59
36867.0,2.3
37880.0,1.95
20766.0,2.1
6133.0,1.9
16138.0,2.62
43550.0,2.32
33474.0,2.19
5938.0,2.73
22427.0,2.32
6062.0,2.36
36860.0,2.0
11974.0,2.13
33960.0,1.84
39650.0,1.77
45521.0,2.17
7534.0,2.42
41087.0,1.98
6051.0,2.44
19603.0,2.71
7535.0,4.67
45725.0,2.23
10981.0,3.4
45673.0,2.42
56.0,2.21
40.0,2.55
6143.0,2.17
20817.0,1.77
20814.0,1.87
12031.0,2.62
41082.0,1.84
39337.0,1.85
23778.0,2.4
6081.0,2.61
44378.0,2.25
39334.0,1.8
45676.0,2.68
38356.0,2.18
45519.0,2.32
6323.0,2.32
17730.0,2.87
6315.0,1.81
83.0,1.89
155.0,2.19
21292.0,2.44
44490.0,2.02
39648.0,1.85
18204.0,2.99
44470.0,1.93
35169.0,2.26
33964.0,1.79
36020.0,2.29
41081.0,1.82
44589.0,1.92
45675.0,1.98
7557.0,2.26
34467.0,2.42
18923.0,2.0
44465.0,2.02
6210.0,2.61
37877.0,1.76
38360.0,2.12
20755.0,2.13
38995.0,2.41
22428.0,2.38
33967.0,1.81
5906.0,2.48
126.0,2.17
41079.0,1.86
37.0,2.22
32703.0,2.79
39339.0,1.8
44473.0,2.03
45671.0,2.42
74.0,2.37
44450.0,2.1
12821.0,2.59
35953.0,2.36
6128.0,1.83
33966.0,1.75
6235.0,2.16
19590.0,2.21
37878.0,1.87
35906.0,2.15
41055.0,2.16
39658.0,1.98
37874.0,2.25
33972.0,1.83
60.0,1.66
75.0,2.18
16196.0,2.86
44586.0,2.34
135.0,2.07
41554.0,1.86
41856.0,2.18
10284.0,2.33
5913.0,2.55
4914.0,1.82
41052.0,2.2
19338.0,2.75
44381.0,2.43
45670.0,2.42
33968.0,1.76
20768.0,1.84
5967.0,2.34
18997.0,2.19
17674.0,1.72
82.0,4.05
19592.0,2.21
41054.0,1.79
5907.0,2.34
37879.0,2.29
34643.0,1.61
4910.0,1.64
41072.0,1.9
6085.0,1.82
45516.0,1.98
39193.0,2.09
157.0,2.21
50.0,1.83
21293.0,2.35
33965.0,1.82
19578.0,1.89
6112.0,3.29
44468.0,2.16
6234.0,2.21
10832.0,2.35
41067.0,1.77
34464.0,1.67
39335.0,1.78
39333.0,1.71
39332.0,1.78
40190.0,2.02
6207.0,2.66
99.0,2.4
42237.0,2.0
50860.0,1.89
40525.0,2.5
12026.0,2.59
42398.0,1.87
44457.0,1.76
5963.0,2.05
17314.0,1.97
6098.0,2.48
4902.0,2.03
19625.0,2.26
143.0,1.94
41088.0,1.89
10974.0,2.98
41547.0,2.11
6106.0,1.61
6264.0,2.31
41066.0,1.71
41199.0,1.77
42238.0,2.01
160.0,2.36
39338.0,1.76
36876.0,2.05
44456.0,1.68
11975.0,1.99
38991.0,1.89
6319.0,2.77
6336.0,2.33
107.0,4.15
45517.0,1.88
41059.0,1.72
102.0,2.79
61.0,2.07
6108.0,1.69
18782.0,2.6
44389.0,1.76
20751.0,2.05
113.0,2.26
169.0,1.63
34466.0,1.8
44458.0,1.63
6316.0,1.68
34082.0,1.78
21240.0,2.0
17318.0,1.97
10988.0,2.81
19600.0,2.35
43544.0,1.97
6208.0,4.24
80.0,1.88
5956.0,2.13
19628.0,2.32
39196.0,1.67
40688.0,1.82
4944.0,2.26
5933.0,2.56
6045.0,2.29
6030.0,1.9
4936.0,2.11
34574.0,2.0
6084.0,1.7
86.0,1.67
12027.0,2.64
36884.0,2.32
39644.0,1.67
20750.0,1.75
34461.0,2.08
162.0,1.69
4909.0,1.84
10972.0,2.46
38357.0,2.11
6335.0,2.14
36862.0,1.98
39653.0,1.69
6211.0,2.06
41075.0,1.64
18924.0,2.55
14895.0,2.12
161.0,1.92
48462.0,1.95
5916.0,2.43
132.0,1.98
12132.0,2.04
44487.0,1.92
44474.0,1.96
5910.0,2.21
43542.0,1.93
4870.0,1.86
10835.0,2.6
40194.0,1.65
6077.0,1.93
41855.0,1.84
39654.0,1.67
20816.0,1.78
22423.0,2.31
34638.0,1.64
41078.0,1.67
34468.0,2.01
6168.0,2.41
32705.0,2.45
38989.0,2.15
7685.0,2.34
41063.0,1.7
7542.0,2.58
39768.0,1.83
35905.0,2.15
36871.0,1.9
39195.0,1.55
36882.0,1.86
39652.0,1.81

2025-01-19 14:34:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:34:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:34:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:34:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 14:34:10 - snowflake.connector.connection - INFO - closed
2025-01-19 14:34:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:35:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:35:37 - root - INFO - ```sql
(SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
WHERE
    im."composition" IS NOT NULL
ORDER BY
    im."composition" DESC
LIMIT 10)
UNION ALL
(SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
WHERE
    im."composition" IS NOT NULL
ORDER BY
    im."composition" ASC
LIMIT 10)
ORDER BY
    "Composition_Value" DESC;
```
2025-01-19 14:35:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:35:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:35:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:35:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:35:38 - snowflake.connector.connection - INFO - closed
2025-01-19 14:35:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:35:39 - root - INFO - SQL:
(SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
WHERE
    im."composition" IS NOT NULL
ORDER BY
    im."composition" DESC
LIMIT 10)
UNION ALL
(SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
WHERE
    im."composition" IS NOT NULL
ORDER BY
    im."composition" ASC
LIMIT 10)
ORDER BY
    "Composition_Value" DESC;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
10-2018,Work Comes First Travelers,20.28
11-2018,Work Comes First Travelers,19.45
01-2019,Work Comes First Travelers,18.99
07-2018,Gym Equipment Owners,18.82
02-2019,Work Comes First Travelers,18.39
09-2018,Work Comes First Travelers,18.18
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
05-2019,Gastrointestinal Researchers,1.52
03-2019,World of Warcraft Enthusiasts,1.52
06-2019,Disney Fans,1.52
04-2019,United Nations Donors,1.52
05-2019,Beer Aficionados,1.52
04-2019,Minnesota Vikings Fans,1.52
05-2019,Philadelphia 76ers Fans,1.52
06-2019,New York Giants Fans,1.52
08-2018,Readers of Jamaican Content,1.52
05-2019,Mowing Equipment Shoppers,1.51

2025-01-19 14:35:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:35:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:35:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:35:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 14:35:41 - snowflake.connector.connection - INFO - closed
2025-01-19 14:35:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:35:41 - root - INFO - SQL:
SELECT "interest_name", "interest_summary"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    LIMIT 1000;
Results:
Too long, hard cut:
interest_name,interest_summary
Fitness Enthusiasts,Consumers using fitness tracking apps and websites.
Gamers,Consumers researching game reviews and cheat codes.
Car Enthusiasts,Readers of automotive news and car reviews.
Luxury Retail Researchers,Consumers researching luxury product reviews and gift ideas.
Brides & Wedding Planners,People researching wedding ideas and vendors.
Vacation Planners,Consumers reading reviews of vacation destinations and accommodations.
Motorcycle Enthusiasts,Readers of motorcycle news and reviews.
Business News Readers,Readers of online business news content.
Thrift Store Shoppers,Consumers shopping online for clothing at thrift stores and researching locations.
Advertising Professionals,People who read advertising industry news.
NFL Fans,People reading articles and websites about football and the NFL.
NBA Fans,People reading articles and websites about basketball and the NBA.
NCAA Fans,People reading articles and websites about college sports and the NCAA.
MLB Fans,People reading articles and websites about baseball and the MLB.
Nascar Fans,People reading articles and websites about nascar.
Eco-Conscious Consumers,People researching climate change and sustainable living.
Moviegoers,Consumers researching box office listings and buying movie tickets.
DIYers,Consumers researching DIY projects.
Grill Masters,Grill owners researching new recipes.
Techies,Readers of tech news and gadget reviews.
Home Design Enthusiasts,Consumers researching home design styles and trends.
Doctors,People reading medical journals and using online prescribing services.
Streaming Video Fans,Consumers streaming feature length movies and TV shows.
Auto Insurance Shoppers,Consumers shopping for auto insurance.
Teachers,People reading education industry publications and teaching advice websites.
College Students,People visiting university websites.
Department Store Shoppers,Consumes shopping at multi-category department stores.
Home Decor Shoppers,"Consumers shopping for home design, art and accessories."
Kids Clothing Shoppers,Consumers shopping for childrens apparel.
Teen Girl Clothing Shoppers,Consumers in-market for clothing for teenage girls.
Mens Clothing Shoppers,Consumers in-market for mens clothing.
Baby Products Buyers,Consumers shopping for baby-related products.
Jewelry & Watch Shoppers,Consumers researching high-end watch and jewelry brands.
Sporting Goods Shoppers,Consumers shopping for sporting goods and activewear apparel.
Furniture Shoppers,Consumers shopping for major home furnishings.
Bed & Bath Shoppers,Consumers shopping for bed and bath products.
Intimates Shoppers,Consumers shopping for lingerie.
Fast Fashion Shoppers,Consumers shopping for apparel that mimics current runway trends.
Apartment Hunters,People reading real estate rental listings.
Home Buyers,People reading real estate sales listings.
Moving Services Shoppers,Consumers who are shopping for moving services.
Job Seekers,People researching job boards.
Charitable Donors,People researching major charitable organizations.
NHL Fans,People reading articles and websites about hockey and the NHL.
Discount Big Box Shoppers,Consumers shopping at big box retailers.
Black Friday Deal Shoppers,Consumers researching holiday sales events.
Hip Hop Fans,People reading about hip hop music and hip hop stars.
Online Investors,Consumers with an active online trading account.
Seasonal Allergy Sufferers,People researching allergy trends and treatment options.
Discount Device Shoppers,Consumers shopping for discounted electronics.
Mobile Phone Comparison Shoppers,Consumers researching alternative mobile phones and wireless plans.
Budget Wireless Shoppers,Consumers researching discount wireless service plans.
Menopause Researchers,People researching menopause symptoms.
Online Health Researchers,People researching general health questions.
Beauty & Skincare Buyers,Consumers shopping for beauty and skincare products.
Streaming Device Shoppers,Consumers shopping for connected TV products.
New & Expecting Parents,People researching pregnancy issues and baby names.
High-End Kids Furniture and Clothes Shoppers,People shopping at high end childrens clothing and toy retailers.
Hands-On Parents,"People reading about family cooking, parenting advice and childrens activities."
Fantasy & Comic Fans,Consumers of online comics and fantasy novels.
Lawyers,People reading legal journals and industry publications.
Healthy Eaters,People researching healthy eating options.
Drug Store Shoppers,Consumers shopping online or searching for a local drug store.
Lawn & Garden Enthusiasts,Consumers reseraching lawn and garden maintenance techniques.
Nurses,People reading websites about nursing lifestyle and career advice.
Mailing & Shipping Shoppers,Consumers shopping for shipping supplies and postage.
Office Supply Shoppers,Individuals in-market for office supplies.
Ink & Toner Shoppers,Consumers shopping for printer ink.
Luxury Retail Shoppers,Consumers shopping for high end 

2025-01-19 14:35:41 - root - INFO - itercount: 0
2025-01-19 14:35:41 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `INTEREST_MAP`
  - `"id"`: Interest category ID, used to join with `INTEREST_METRICS`.
  - `"interest_name"`: Name of the interest category.
  - `"created_at"`: Creation date of the interest category.
  - `"last_modified"`: Last modification date of the interest category.

- **Table:** `INTEREST_METRICS`
  - `"_month"`: Month number (used to construct the time as MM-YYYY).
  - `"_year"`: Year number.
  - `"month_year"`: Time in a string format (possibly MM-YYYY).
  - `"interest_id"`: Corresponds to `"id"` in `INTEREST_MAP` for joining tables.
  - `"composition"`: Composition value used for ranking interest categories.
  - `"index_value"`: An index metric (potentially useful for analysis).
  - `"ranking"`: Ranking of the interest category.
  - `"percentile_ranking"`: Percentile ranking of the interest category.

**Potential Conditions:**

- **Joining Conditions:** Join `INTEREST_METRICS` and `INTEREST_MAP` on `"interest_id" = "id"`.
- **Filtering Conditions:** 
  - `"composition"` values should be considered when they are not null and greater than zero.
  - Time can be filtered or formatted using `"_month"` and `"_year"` or `"month_year"`.

---

**SQL Queries to Explore Related Columns:**

1. **List distinct interest IDs from `INTEREST_METRICS`:**

   ```sql
   SELECT DISTINCT "interest_id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

2. **List distinct interest category IDs from `INTEREST_MAP`:**

   ```sql
   SELECT DISTINCT "id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
   ```

3. **List distinct interest names:**

   ```sql
   SELECT DISTINCT "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
   ```

4. **Retrieve composition values and their corresponding interest IDs:**

   ```sql
   SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" IS NOT NULL
   LIMIT 1000;
   ```

5. **Get the month and year from `INTEREST_METRICS`:**

   ```sql
   SELECT DISTINCT "_month", "_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

6. **Check the format of `"month_year"` column:**

   ```sql
   SELECT DISTINCT "month_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

7. **List interest names containing a specific keyword using fuzzy matching:**

   ```sql
   SELECT "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   WHERE "interest_name" ILIKE '%interest%'
   LIMIT 1000;
   ```

8. **Find records where the composition value is above a certain threshold:**

   ```sql
   SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" > 0
   LIMIT 1000;
   ```

9. **Explore interest categories with composition values in a specific year:**

   ```sql
   SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "_year" = 2021
   LIMIT 1000;
   ```

10. **Check for valid dates in the `"created_at"` column in `INTEREST_MAP`:**

    ```sql
    SELECT "id", "created_at"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    WHERE TRY_TO_DATE("created_at", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1000;
    ```

11. **Get percentile rankings of interest categories:**

    ```sql
    SELECT "interest_id", "percentile_ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
    ```

12. **List index values for interest categories:**

    ```sql
    SELECT "interest_id", "index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
    ```

13. **Retrieve last modified dates from `INTEREST_MAP`:**

    ```sql
    SELECT "id", "last_modified"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    WHERE TRY_TO_DATE("last_modified", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1000;
    ```

14. **Find interest categories with the highest ranking:**

    ```sql
    SELECT "interest_id", "ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "ranking" IS NOT NULL
    LIMIT 1000;
    ```

15. **Explore the relationship between composition and index value:**

    ```sql
    SELECT "composition", "index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
    ```

16. **Get interest categories updated in the recent past using fuzzy date matching:**

    ```sql
    SELECT "id", "interest_name", "last_modified"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    WHERE "last_modified" ILIKE '%2021%'
    LIMIT 1000;
    ```

17. **List interest IDs and their corresponding months and years:**

    ```sql
    SELECT "interest_id", "_month", "_year"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
    ```

18. **Select interest categories with composition values in a specific month:**

    ```sql
    SELECT "interest_id", "composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "_month" = 6 -- June
    LIMIT 1000;
    ```

19. **Check for null or missing composition values:**

    ```sql
    SELECT "interest_id"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "composition" IS NULL
    LIMIT 1000;
    ```

20. **List all interest names along with their summaries:**

    ```sql
    SELECT "interest_name", "interest_summary"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    LIMIT 1000;
    ```

These queries provide insights into the structure and content of the relevant tables and columns, helping to understand the data needed to identify the top 10 and bottom 10 interest categories based on their highest composition values across all months.Query:
SELECT DISTINCT "interest_id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
6111.0
19422.0
6110.0
6217.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
6286.0
19621.0
63.0
165.0
18351.0
""
17314.0
4914.0
6107.0
40.0
5938.0
16137.0
6330.0
6006.0
6228.0
4902.0
97.0
20764.0
5.0
19610.0
4940.0
10838.0
6255.0
69.0
79.0
4895.0
5991.0
114.0
96.0
19758.0
6029.0
6334.0
6315.0
6206.0
20768.0
4855.0
56.0
23.0
98.0
18646.0
6162.0
128.0
6308.0
148.0
18347.0
4910.0
32703.0
6214.0
4.0
6218.0
161.0
92.0
6184.0
6232.0
36.0
150.0
17730.0
4869.0
31.0
19757.0
4911.0
5946.0
6378.0
6172.0
169.0
6299.0
6304.0
6123.0
103.0
38.0
17786.0
15.0
115.0
22403.0
4852.0
6108.0
6219.0
10250.0
149.0
16197.0
11067.0
4913.0
6316.0
17803.0
44.0
19.0
4873.0
86.0
24.0
12133.0
6141.0
4943.0
18996.0
85.0
19587.0
135.0
19588.0
77.0
4944.0
111.0
151.0
7461.0
17785.0
6318.0
7605.0
12.0
70.0
19579.0
18490.0
147.0
6062.0
19760.0
6115.0
6265.0
18350.0
6148.0
6340.0
109.0
12027.0
18784.0
34.0
102.0
6323.0
5896.0
6301.0
22411.0
6321.0
62.0
6222.0
6341.0
17673.0
6112.0
20753.0
125.0
17269.0
6284.0
7557.0
117.0
33.0
17320.0
18202.0
10008.0
10976.0
21242.0
21293.0
6278.0
64.0
88.0
5921.0
21057.0
6133.0
22096.0
18622.0
19294.0
5963.0
10988.0
116.0
21061.0
5984.0
45.0
21058.0
4857.0
6024.0
157.0
143.0
14901.0
6320.0
19604.0
7536.0
16196.0
18203.0
38360.0
36864.0
37876.0
10954.0
133.0
11974.0
15935.0
18647.0
5968.0
5943.0
16.0
6277.0
6285.0
6128.0
17674.0
93.0
22502.0
20750.0
6087.0
104.0
39.0
5952.0
164.0
5989.0
138.0
12277.0
61.0
6211.0
5972.0
6023.0
5960.0
90.0
6144.0
49.0
75.0
18781.0
4848.0
5930.0
13496.0
4920.0
163.0
33191.0
5918.0
13421.0
12025.0
19297.0
10870.0
19606.0
170.0
6151.0
1.0
60.0
158.0
132.0
6365.0
7537.0
6227.0
6085.0
11975.0
13.0
89.0
37.0
6084.0
8.0
4909.0
6127.0
66.0
7453.0
6171.0
131.0
10839.0
67.0
4861.0
19630.0
5970.0
4907.0
20767.0
10837.0
130.0
27.0
19879.0
4915.0
6250.0
6237.0
6302.0
22425.0
6207.0
141.0
6181.0
6298.0
6145.0
22.0
4918.0
17671.0
5906.0
35.0
21292.0
19250.0
82.0
13498.0
4925.0
6319.0
10365.0
6366.0
4898.0
7425.0
16119.0
65.0
5898.0
6051.0
5901.0
4866.0
6095.0
6229.0
20814.0
4904.0
7527.0
20963.0
6221.0
6210.0
139.0
19603.0
126.0
5920.0
7529.0
41.0
10972.0
22424.0
19338.0
19578.0
6263.0
10980.0
6267.0
119.0
4859.0
155.0
12031.0
107.0
17318.0
21060.0
5961.0
18997.0
6142.0
87.0
22423.0
21236.0
21238.0
80.0
6208.0
23778.0
18204.0
19628.0
19590.0
22095.0
145.0
20815.0
6305.0
6328.0
30.0
4928.0
59.0
55.0
18619.0
6030.0
10284.0
6209.0
6169.0
142.0
6194.0
153.0
10832.0
6088.0
11065.0
22093.0
6393.0
50.0
20755.0
12821.0
14800.0
6300.0
10009.0
18807.0
32705.0
6335.0
108.0
6149.0
10364.0
6367.0
4903.0
110.0
20816.0
4867.0
20730.0
7546.0
18924.0
4908.0
19593.0
6230.0
6317.0
5936.0
18783.0
7597.0
7545.0
6345.0
17729.0
4906.0
10970.0
22401.0
10836.0
4933.0
6215.0
6156.0
5945.0
112.0
6339.0
6122.0
19594.0
4931.0
6034.0
22398.0
72.0
19609.0
6332.0
21248.0
58.0
10971.0
7598.0
19626.0
19631.0
6047.0
21244.0
34462.0
34082.0
34461.0
34077.0
34084.0
34079.0
34460.0
33534.0
21245.0
34651.0
34643.0
34647.0
34650.0
34638.0
34646.0
36343.0
37411.0
37423.0
37874.0
37420.0
36876.0
38355.0
37414.0
38362.0
38351.0
37887.0
37166.0
38365.0
37165.0
37878.0
37416.0
38358.0
38989.0
39190.0
39192.0
39770.0
39651.0
39199.0
39659.0
41854.0
41191.0
41192.0
42238.0
42237.0
41554.0
40692.0
40687.0
40427.0
40694.0
42964.0
44470.0
44476.0
44479.0
44456.0
45524.0
44379.0
45669.0
45668.0
46567.0
49979.0
10011.0
22427.0
16138.0
18621.0
6329.0
6076.0
5914.0
6337.0
10977.0
12132.0
5911.0
6260.0
4917.0
5907.0
4924.0
95.0
5942.0
10978.0
19627.0
83.0
17672.0
6234.0
6322.0
28.0
19633.0
5909.0
10872.0
6324.0
6134.0
6253.0
6174.0
6212.0
6391.0
6159.0
19878.0
7543.0
10834.0
25.0
5934.0
6257.0
22400.0
4935.0
5929.0
22417.0
10975.0
6098.0
12032.0
6385.0
6124.0
32702.0
19612.0
10974.0
10010.0
6049.0
19634.0
166.0
5971.0
19624.0
21249.0
6236.0
121.0
10955.0
19615.0
5900.0
21251.0
15884.0
17274.0
11977.0
20752.0
2.0
19596.0
33474.0
34574.0
34088.0
34468.0
33972.0
33962.0
33958.0
35953.0
35169.0
34637.0
34644.0
34649.0
34642.0
37413.0
37877.0
36869.0
38284.0
37418.0
38361.0
37417.0
37412.0
38990.0
40183.0
40685.0
40683.0
39196.0
39649.0
40697.0
40691.0
40688.0
39643.0
40195.0
39547.0
39645.0
39658.0
39331.0
39338.0
39654.0
41856.0
41190.0
41855.0
41078.0
41079.0
41066.0
41059.0
40695.0
40526.0
44453.0
44587.0
45670.0
44473.0
44466.0
44484.0
45519.0
45675.0
45679.0
45673.0
44483.0
44589.0
44471.0
44458.0
44467.0
44384.0
45528.0
43551.0
39655.0
44580.0
42008.0
49972.0
51678.0
49975.0
84.0
13428.0
19635.0
19595.0
35742.0
37875.0
36873.0
36863.0
40525.0
40187.0
40699.0
41067.0
41075.0
43550.0
44486.0
45672.0
14802.0
44459.0
7540.0
12490.0
21237.0
4897.0
101.0
137.0
20731.0
6182.0
3.0
6336.0
15877.0
5951.0
6143.0
6173.0
12820.0
19295.0
6045.0
4894.0
5999.0
6220.0
6264.0
5895.0
5944.0
14.0
99.0
74.0
5924.0
21059.0
162.0
22413.0
26.0
6266.0
5910.0
18352.0
6183.0
6081.0
21239.0
7535.0
5958.0
4930.0
19617.0
5956.0
168.0
134.0
17271.0
18.0
4936.0
32701.0
10833.0
81.0
7464.0
71.0
19607.0
10251.0
4937.0
6303.0
1
Query:
SELECT DISTINCT "id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
Answer:
Too long, hard cut:
id
1
2
3
4
5
6
7
13
14
15
16
18
19
20
21
22
23
24
26
31
35
40
41
43
49
54
61
71
75
78
80
81
104
135
4895
4896
4920
17
25
28
29
51
65
86
87
90
99
109
111
114
121
169
4857
4858
4917
4918
5942
69
132
153
4898
4903
6131
6194
8
12
30
37
42
48
50
64
66
67
70
74
91
92
94
97
102
106
112
113
117
131
134
138
27
33
38
39
44
46
53
57
59
60
63
82
84
88
89
93
95
110
115
116
125
129
137
141
145
154
158
162
165
4847
4848
4855
4869
4897
4908
4914
4925
4931
4932
5895
5906
5907
5916
5926
5929
5934
5945
5961
62
118
133
142
143
160
4852
4902
4905
4906
4907
4919
5901
5911
5921
5943
5951
5968
151
5904
5914
5972
5984
6010
6013
6065
6077
6107
6123
6141
6145
6172
6174
6182
6224
6225
6226
6227
6230
6253
6301
6323
6335
6344
6364
7454
7535
10249
11067
12027
13498
17674
19250
19606
20754
21244
56
128
34
36
45
55
58
72
77
83
98
101
103
108
124
139
4859
4866
4873
4912
4924
4926
4927
4935
5896
5924
5933
5936
5957
5960
79
85
96
107
119
123
136
140
146
147
148
150
155
157
161
163
168
170
171
4867
4872
4899
4909
4910
4911
4913
4916
4921
4928
4930
4933
4937
4940
4943
4944
5897
5898
5910
5913
5920
5925
5938
5944
5946
5962
5967
5969
130
4861
4915
4929
4936
5917
5956
5963
5970
5971
5989
5991
5999
6006
6008
6023
6024
6029
6030
6034
6045
6049
6050
6051
6081
6085
6087
6095
6098
6106
6108
6111
6115
6120
6122
6127
6128
6134
6148
6149
6151
6156
6160
6162
6164
6169
6177
6183
6206
6208
6209
6215
6218
6219
6221
6231
6232
6234
6250
6255
6259
6260
6264
6266
6267
6278
6285
6298
6300
6303
6305
6308
6314
6315
6320
6321
6322
6328
6330
6331
6332
6334
6336
6341
6343
6363
6365
6367
6378
6386
6389
6393
7461
7537
7544
7597
7605
10007
10008
12032
10250
10834
10835
10836
10869
10870
10871
10872
10954
10976
10978
10981
10988
11065
11066
11975
12025
12490
13428
13496
13497
14801
14901
15878
15882
15883
15884
16137
16138
16196
17269
17314
17318
17452
17669
17670
17786
18203
18348
18352
18620
18648
18781
18782
18783
18923
18997
19251
19338
19423
19578
19594
19597
19598
19601
19603
19609
19610
19612
19613
19619
19620
19622
19624
19627
19628
19634
20730
20755
20768
21060
21247
21251
22092
22408
22415
22421
22422
22426
32486
32701
32702
32703
32705
33964
33968
34081
34087
34460
6142
6184
6237
6302
6319
6329
6340
6366
6387
6390
7534
7536
7542
7557
10010
10364
10365
10837
10839
10955
10973
10975
12026
12132
12602
16197
17729
17730
18202
18204
18490
18995
19422
19579
19587
35742
19607
19617
19621
19623
19632
19879
20751
20764
20766
21058
21062
21237
21239
21241
21242
21245
21249
21293
22398
22420
22423
22425
33191
33474
33533
33534
33958
33959
33960
33961
33962
33969
34077
34078
34079
34084
34085
20814
33963
34462
34465
34466
34468
34470
34640
34641
34643
34645
34648
34650
35905
36862
36868
36872
36875
36876
36877
36879
36882
37257
37407
37408
37410
37412
37417
37877
37878
37880
38284
38353
38358
38361
38365
38991
38993
39198
39330
39331
39334
39335
39462
39551
39644
39645
39647
39768
40188
40190
40193
40194
40195
40439
41055
41062
41065
41066
41087
41195
41550
41553
42011
42203
44378
44383
44387
44390
44452
44456
44458
44464
44471
44479
44486
44579
44588
45520
45522
45665
45667
45673
45675
45679
47065
48463
49978
51120
51678
38363
39646
40702
41546
44457
44463
46132
49974
49979
44585
100
126
4904
5900
73
149
164
4870
5909
5918
5922
5930
5952
5958
6047
6048
6064
6067
6076
6084
6089
6112
6124
6133
6138
6143
6144
6168
6171
6173
6181
6188
6189
6207
6210
6211
6216
6217
6220
6222
6223
6228
6235
6236
6257
6284
6286
6304
6306
6316
6318
6324
6325
6333
6391
7453
7483
7540
7541
7546
7598
10284
10366
10971
10979
10980
11974
11977
13421
14800
14895
15879
16119
17540
17671
18351
18621
19296
19297
19298
19519
19599
19602
19604
19614
19615
19616
19633
19635
20750
20752
21236
21238
21240
21243
21248
21326
22094
22096
22419
22428
33972
34086
34088
34459
6062
6159
6212
6214
6229
6263
6265
6277
6299
6317
6337
6339
7425
7464
7527
7543
7545
10009
10251
10351
10832
10833
10838
10953
10970
10972
10974
10977
12031
12133
12277
12820
12821
14802
15877
15935
16198
17271
17274
17320
17672
17673
17785
17803
18347
18350
18619
18622
18646
18647
18784
18807
18924
18996
18998
19588
19589
19590
19591
19592
19593
19596
19608
19611
19626
19629
19630
19631
19757
19758
19759
19760
19878
20731
20753
20756
20767
20815
20817
20963
21057
21059
21061
21246
21250
21292
22400
22401
22403
22406
22411
22413
22417
22427
22502
32485
32704
33966
33967
33970
34082
34083
6088
6385
19295
20816
22091
33965
33971
34461
34463
34464
34467
34469
34471
34574
34635
34636
34638
34639
34642
34647
34649
34651
34909
34948
34950
35169
35903
35904
35906
35932
35953
35964
36020
36343
36860
36863
36864
36869
36870
36871
36873
36874
36878
36881
36883
36884
37166
37406
37409
37411
37413
37416
37419
37420
37421
37423
37524
37874
37875
37876
37879
37881
37883
37887
38283
38350
38351
38352
38355
38356
38360
38364
38366
38368
38989
38990
38992
38994
38995
38996
39189
39190
39191
39193
39194
39195
39196
39197
39199
39332
39336
39337
39338
39547
39640
39641
39643
39648
39650
39651
39652
39653
39654
39655
39657
39659
39665
39685
39767
39770
40183
40185

Query:
SELECT DISTINCT "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_name
Fitness Enthusiasts
Gamers
Car Enthusiasts
Luxury Retail Researchers
Brides & Wedding Planners
Vacation Planners
Motorcycle Enthusiasts
Business News Readers
Thrift Store Shoppers
NFL Fans
NBA Fans
Nascar Fans
Eco-Conscious Consumers
Moviegoers
DIYers
Techies
Doctors
Streaming Video Fans
Auto Insurance Shoppers
College Students
Home Decor Shoppers
Kids Clothing Shoppers
Teen Girl Clothing Shoppers
Mens Clothing Shoppers
Baby Products Buyers
Jewelry & Watch Shoppers
Sporting Goods Shoppers
Apartment Hunters
Home Buyers
Discount Big Box Shoppers
Seasonal Allergy Sufferers
Discount Device Shoppers
Budget Wireless Shoppers
Menopause Researchers
High-End Kids Furniture and Clothes Shoppers
Fantasy & Comic Fans
Drug Store Shoppers
Mailing & Shipping Shoppers
Online Movie Downloaders
Parents with Toddlers
Day Care Users
Auto Repair Researchers
Coders & Developers
Online Alcohol Shoppers
Truck Drivers
Teachers
Bed & Bath Shoppers
Online Health Researchers
Contractors & Construction Professionals
Democrats
Hardware Shoppers
Reggaeton Fans
Major Appliance Shoppers
Pet Owners
Skin Care Researchers
Federal Employees
Doves
Business Logistics Managers
Dieters
Orthopedic Health Researchers
Tax Filers
Cruise Travel Intenders
Social Conservatives
Supply Chain Professionals
NCAA Fans
Grill Masters
Intimates Shoppers
Charitable Donors
Streaming Device Shoppers
Lawn & Garden Enthusiasts
Luxury Travel Researchers
Travel Researchers
Order-in Eaters
Audio Equipment Researchers
Business Accounting Software Researchers
Asthma Sufferers
Cardio Health Researchers
Readers of Data Scientist blogs
Advertising Professionals
Home Design Enthusiasts
Fast Fashion Shoppers
Moving Services Shoppers
NHL Fans
Black Friday Deal Shoppers
Hip Hop Fans
Beauty & Skincare Buyers
Hands-On Parents
Nurses
Office Supply Shoppers
Luxury Retail Shoppers
Republicans
HDTV Researchers
Sale Seekers
Ski and Snowboard Enthusiasts
Parents with Kids
Young Boomers
Exercise and Gym Researchers
Home Kitchen Chefs
Restaurant Researchers
Nutrition Conscious Eaters
Flower & Gift Basket Shoppers
Live Concert Fans
Avid Readers
Womens Fashion Magazine Readers
Boxing Fans
Healthcare Discount Shoppers
Soccer Fans
Makeup Researchers
TV Junkies
Business Travelers
Travel Reward Points Enthusiasts
Voters
IT Decision Makers
Tech-Savvy Moms
Credit Union Researchers
Cosmetics and Beauty Shoppers
Adult Acne Sufferers
Sinus Researchers
Back Pain Sufferers
Mens Health Researchers
Teen Content Readers
Surfers
Immigration Rights Advocates
Right Wing Radicals
Occupy Movement Supporters
Orthodontics Researchers
Career Focused Individuals
Flooring Shoppers
New & Expecting Parents
Ink & Toner Shoppers
Theme Park Researchers
Stay-at-Home Parents
Comedy Fans
Joint Pain Sufferers
Mens Shoe Shoppers
Military Servicemembers & Veterans
Credit Card Researchers
Sightseeing Travelers
Conservative News Readers
Entertainment & Tabloid Magazine Readers
TV Game Show Fans
Mature Parents
Headache and Migraine Sufferers
Vitamin Shoppers
Gun Rights Advocates
Immigration Control Advocates
Family Values Advocates
Liberal Think Tank Readers
Online Grocery Shoppers
Budget Small Business Researchers
Tax Policy Researchers
Financial News Readers
Law Enforcement Officers
Android Fans
Small Business Employees
Parents of Teenagers Going to College
Luxury Home Fixture Shoppers
Financial Investors
Joint Pain Health Care Professionals
Spa and Pool Owners
Backyard Farmers
Readers of Portuguese Content
Solar Energy Researchers
Coffee Lovers
Dental Hygiene Students
Rugby Fans
Fantasy Football Enthusiasts
Open Source Developers
United Arab Emirates Trip Planners
College Aspirants
Non-Profit Volunteers
Medicare Researchers
Environmental Activists
Physicians
Gastroenterologists
Pharmacists
New Orleans Trip Planners
HVAC Service Researchers
Economy Grocery Shoppers
Japanese Luxury Car Enthusiasts
Dallas Cowboys Fans
NCAA Football Fans
Last Minute Travelers
Luxury Boutique Hotel Researchers
Professional Sound Products Researchers
Home Design and Living Publication Readers
Houston Rockets Fans
New York Giants Fans
Online Investors
Sleep Disorder Researchers
Automotive Safety Researchers
Flight and Hotel Shoppers
Oncology Researchers
MLB Fans
Department Store Shoppers
Furniture Shoppers
Lawyers
Healthy Eaters
Coupon Researchers
Plus Size Women
Country Music Fans
Pain Management Researchers
Retirement Planners
Mortgage Researchers
Aftermarket Accessories Shoppers
Home Printer Shoppers
Tablet Researchers
Home Kitchen Bakers
Broadway Fans
Womens Fitness Enthusiasts
Readers of Mexican Content
Military Families
LGBT Activists
Tire Shoppers
Business Communication Product Researchers
Credit Score Researchers
Caribbean Trip Planners
Luxury Bedding Shoppers
Job Seekers
Pain Medication Users
Home Security Shoppers
Kitchen & Bathroom Remodelers
Health Insurance Researchers
Property Insurance Researchers
Streaming Radio Listeners
Big & Tall Men
Phone Accessory Shoppers
Prepaid Smartphone Shoppers
Retirees
Social Liberals
Shoe 
Query:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.
Query:
SELECT DISTINCT "_month", "_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
_month,_year
7.0,2018.0
,
8.0,2018.0
9.0,2018.0
10.0,2018.0
11.0,2018.0
12.0,2018.0
1.0,2019.0
2.0,2019.0
3.0,2019.0
4.0,2019.0
5.0,2019.0
7.0,2019.0
6.0,2019.0
8.0,2019.0
Query:
SELECT DISTINCT "month_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019
Query:
(
    SELECT
        mc."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        mc."composition" AS "Composition_Value"
    FROM (
        SELECT
            im."interest_id",
            im."month_year",
            im."composition",
            ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
        FROM
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
        WHERE
            im."composition" IS NOT NULL
    ) mc
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON mc."interest_id" = imap."id"
    WHERE
        mc.rn = 1
    ORDER BY
        mc."composition" DESC
    LIMIT 10
)
UNION ALL
(
    SELECT
        mc."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        mc."composition" AS "Composition_Value"
    FROM (
        SELECT
            im."interest_id",
            im."month_year",
            im."composition",
            ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
        FROM
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
        WHERE
            im."composition" IS NOT NULL
    ) mc
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON mc."interest_id" = imap."id"
    WHERE
        mc.rn = 1
    ORDER BY
        mc."composition" ASC
    LIMIT 10
)
ORDER BY
    "Composition_Value" DESC;
Answer:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Query:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" > 0
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.
Query:
(
    SELECT
        im."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        im."composition" AS "Composition_Value"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    ORDER BY
        im."composition" DESC
    LIMIT 10
)
UNION ALL
(
    SELECT
        im."month_year" AS "Time(MM-YYYY)",
        imap."interest_name" AS "Interest_Name",
        im."composition" AS "Composition_Value"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
        ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
    ORDER BY
        im."composition" ASC
    LIMIT 10
)
ORDER BY
    "Composition_Value" DESC;
Answer:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
10-2018,Work Comes First Travelers,20.28
11-2018,Work Comes First Travelers,19.45
01-2019,Work Comes First Travelers,18.99
07-2018,Gym Equipment Owners,18.82
02-2019,Work Comes First Travelers,18.39
09-2018,Work Comes First Travelers,18.18
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
05-2019,Gastrointestinal Researchers,1.52
03-2019,World of Warcraft Enthusiasts,1.52
06-2019,Disney Fans,1.52
04-2019,United Nations Donors,1.52
05-2019,Beer Aficionados,1.52
04-2019,Minnesota Vikings Fans,1.52
05-2019,Philadelphia 76ers Fans,1.52
06-2019,New York Giants Fans,1.52
08-2018,Readers of Jamaican Content,1.52
05-2019,Mowing Equipment Shoppers,1.51
Query:
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC) AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC) AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC;
Answer:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Query:
SELECT "interest_id", "percentile_ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,percentile_ranking
32486.0,99.86
6106.0,99.73
18923.0,99.59
6344.0,99.45
100.0,99.31
69.0,99.18
79.0,99.04
6111.0,98.9
6214.0,98.9
19422.0,98.63
6110.0,98.49
4895.0,98.35
6217.0,98.22
4.0,98.08
6218.0,97.94
6123.0,97.81
171.0,97.67
19613.0,97.53
17.0,97.39
6.0,97.26
6013.0,97.12
4870.0,96.98
19423.0,96.84
6089.0,96.71
161.0,96.57
6286.0,96.57
5991.0,96.3
92.0,96.16
6184.0,96.02
19621.0,95.88
63.0,95.75
103.0,95.61
38.0,95.47
17786.0,95.34
6232.0,95.2
165.0,95.06
18351.0,94.92
15.0,94.79
,96.4
17314.0,94.65
6151.0,94.65
4914.0,94.65
115.0,94.24
5968.0,94.24
36.0,93.96
5943.0,93.83
133.0,93.69
1.0,93.69
114.0,93.42
6107.0,93.28
150.0,93.28
60.0,93.0
96.0,92.87
22403.0,92.73
40.0,92.59
19758.0,92.59
17730.0,92.32
5938.0,92.18
4869.0,92.18
4897.0,91.91
6029.0,91.77
31.0,91.77
16137.0,91.5
6330.0,91.36
6334.0,91.36
6315.0,91.36
4852.0,90.95
16.0,90.95
6108.0,90.67
6206.0,90.67
6006.0,90.4
6228.0,90.4
20768.0,90.4
4902.0,89.99
6277.0,89.85
19757.0,89.71
4911.0,89.71
,96.23
4910.0,89.44
6285.0,89.3
11974.0,89.16
6219.0,89.16
10250.0,88.89
6128.0,88.75
5946.0,88.61
158.0,88.61
15935.0,88.34
4855.0,88.2
149.0,88.2
16197.0,87.93
11067.0,87.79
17674.0,87.65
4913.0,87.65
56.0,87.38
6341.0,87.38
6316.0,87.38
18647.0,87.38
17803.0,87.38
23.0,86.69
132.0,86.56
6365.0,86.56
6378.0,86.28
17673.0,86.15
97.0,86.15
7537.0,86.15
20764.0,86.15
44.0,85.6
5.0,85.6
6227.0,85.6
19.0,85.19
93.0,85.19
6085.0,84.91
6112.0,84.77
4873.0,84.64
11975.0,84.5
22502.0,84.36
86.0,84.36
19610.0,84.09
20753.0,83.95
24.0,83.95
20750.0,83.95
12133.0,83.95
6141.0,83.4
6172.0,83.4
98.0,83.4
125.0,82.99
17269.0,82.99
4943.0,82.72
18996.0,82.72
13.0,82.72
89.0,82.72
169.0,82.17
101.0,82.17
6087.0,81.89
104.0,81.89
6284.0,81.89
7557.0,81.89
37.0,81.89
6084.0,81.21
8.0,81.07
5969.0,81.07
39.0,81.07
117.0,80.66
19298.0,80.52
22427.0,80.52
85.0,80.25
5952.0,80.25
164.0,80.25
19587.0,79.84
33.0,79.84
135.0,79.56
19588.0,79.42
17320.0,79.42
77.0,79.42
18648.0,79.01
5989.0,78.88
138.0,78.74
18202.0,78.74
137.0,78.46
4940.0,78.33
12277.0,78.33
4909.0,78.33
4944.0,78.33
10008.0,77.78
6299.0,77.64
20731.0,77.64
10838.0,77.64
111.0,77.64
6127.0,77.09
6304.0,77.09
61.0,77.09
6211.0,76.68
66.0,76.68
6182.0,76.68
151.0,76.68
3.0,76.13
10976.0,75.99
18646.0,75.99
21242.0,75.99
7453.0,75.58
6162.0,75.45
128.0,75.45
5972.0,75.45
6171.0,75.03
131.0,75.03
21293.0,75.03
7461.0,75.03
17785.0,75.03
10839.0,75.03
4912.0,75.03
6318.0,74.07
7605.0,74.07
4905.0,74.07
6023.0,74.07
67.0,73.53
16138.0,73.53
5960.0,73.53
6308.0,73.53
18621.0,73.53
4861.0,72.84
12.0,72.7
90.0,72.7
19630.0,72.7
6278.0,72.29
70.0,72.29
64.0,72.29
19579.0,72.29
6329.0,71.74
5970.0,71.74
4907.0,71.47
6076.0,71.47
18490.0,71.19
20767.0,71.19
147.0,71.19
10837.0,70.78
130.0,70.78
5914.0,70.78
6144.0,70.78
88.0,70.23
6255.0,70.23
27.0,70.23
6336.0,70.23
5921.0,69.68
19879.0,69.68
15877.0,69.41
21057.0,69.41
148.0,69.14
32704.0,69.14
5951.0,69.14
6062.0,69.14
4915.0,68.59
6133.0,68.59
6250.0,68.59
6143.0,68.59
49.0,68.59
6173.0,67.9
75.0,67.76
19614.0,67.76
18781.0,67.49
4848.0,67.49
6237.0,67.49
19760.0,67.49
5930.0,66.94
6302.0,66.94
13496.0,66.94
12820.0,66.94
4920.0,66.39
6115.0,66.26
22425.0,66.26
73.0,66.26
22096.0,65.84
6337.0,65.84
6265.0,65.84
19295.0,65.43
18347.0,65.43
6343.0,65.43
6207.0,65.43
18350.0,65.43
6064.0,64.75
18622.0,64.75
141.0,64.75
6181.0,64.75
6148.0,64.75
10977.0,64.75
6045.0,63.92
6298.0,63.92
6145.0,63.92
22.0,63.92
12132.0,63.92
4918.0,63.92
17671.0,63.1
5906.0,63.1
35.0,62.83
5911.0,62.83
6340.0,62.83
21292.0,62.41
19250.0,62.41
19294.0,62.41
163.0,62.0
82.0,62.0
13498.0,62.0
4925.0,62.0
109.0,62.0
6319.0,62.0
33191.0,61.18
10365.0,61.18
6366.0,60.91
4898.0,60.91
4894.0,60.63
12027.0,60.63
5963.0,60.63
6260.0,60.63
4917.0,60.63
7425.0,60.63
20817.0,60.63
16119.0,59.67
5999.0,59.67
5907.0,59.4
18784.0,59.4
65.0,59.12
5898.0,59.12
6220.0,59.12
19296.0,59.12
6264.0,59.12
6051.0,59.12
5918.0,58.3
5895.0,58.3
12602.0,58.02
5901.0,58.02
34.0,57.75
10988.0,57.61
116.0,57.61
4866.0,57.61
6095.0,57.61
6229.0,57.61
13421.0,57.61
102.0,56.79
4919.0,56.65
20814.0,56.65
4904.0,56.65
7527.0,56.24
12026.0,56.24
4924.0,55.97
21061.0,55.97
20963.0,55.69
6323.0,55.69
5944.0,55.69
14.0,55.69
6221.0,55.14
99.0,55.14
6210.0,55.14
139.0,55.14
74.0,55.14
19603.0,54.46
5924.0,54.46
126.0,54.46
5920.0,54.46
7529.0,54.46
95.0,53.77
21059.0,53.77
162.0,53.5
41.0,53.5
10972.0,53.5
5942.0,53.09
22413.0,53.09
7540.0,52.81
5896.0,52.81
22424.0,52.54
26.0,52.54
19338.0,52.54
4847.0,52.54
19578.0,52.54
6263.0,51.85
12490.0,51.71
22428.0,51.71
21237.0,51.71
10980.0,51.71
5984.0,51.71
6267.0,51.03
6235.0,51.03
45.0,51.03
18620.0,51.03
12025.0,50.48
43.0,50.34
119.0,50.34
6266.0,50.07
4859.0,50.07
6077.0,49.79
21058.0,49.79
155.0,49.52
4857.0,49.52
12031.0,49.52
10978.0,49.11
22419.0,49.11
107.0,49.11
5913.0,49.11
32703.0,48.56
19619.0,48.42
19627.0,48.42
17318.0,48.15
21060.0,48.01
5961.0,48.01
5910.0,48.01
18997.0,47.6
5957.0,47.6
83.0,47.6
19592.0,47.19
160.0,47.05
6142.0,47.05
87.0,46.78
22423.
Query:
SELECT "interest_id", "index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,index_value
32486.0,6.19
6106.0,5.31
18923.0,5.29
6344.0,5.1
100.0,5.04
69.0,5.03
79.0,4.97
6111.0,4.83
6214.0,4.83
19422.0,4.81
6110.0,4.79
4895.0,4.67
6217.0,4.62
4.0,4.53
6218.0,4.5
6123.0,4.49
171.0,4.47
19613.0,4.38
17.0,4.15
6.0,4.08
6013.0,3.99
4870.0,3.95
19423.0,3.92
6089.0,3.84
161.0,3.82
6286.0,3.82
5991.0,3.81
92.0,3.77
6184.0,3.75
19621.0,3.74
63.0,3.73
103.0,3.69
38.0,3.66
17786.0,3.65
6232.0,3.64
165.0,3.59
18351.0,3.58
15.0,3.56
,2.85
17314.0,3.55
6151.0,3.55
4914.0,3.55
115.0,3.53
5968.0,3.53
36.0,3.51
5943.0,3.48
133.0,3.44
1.0,3.44
114.0,3.41
6107.0,3.39
150.0,3.39
60.0,3.36
96.0,3.35
22403.0,3.33
40.0,3.32
19758.0,3.32
17730.0,3.3
5938.0,3.29
4869.0,3.29
4897.0,3.27
6029.0,3.26
31.0,3.26
16137.0,3.24
6330.0,3.22
6334.0,3.22
6315.0,3.22
4852.0,3.2
16.0,3.2
6108.0,3.17
6206.0,3.17
6006.0,3.15
6228.0,3.15
20768.0,3.15
4902.0,3.12
6277.0,3.1
19757.0,3.08
4911.0,3.08
,2.84
4910.0,3.07
6285.0,3.04
11974.0,3.02
6219.0,3.02
10250.0,3.01
6128.0,2.98
5946.0,2.97
158.0,2.97
15935.0,2.96
4855.0,2.95
149.0,2.95
16197.0,2.94
11067.0,2.93
17674.0,2.92
4913.0,2.92
56.0,2.91
6341.0,2.91
6316.0,2.91
18647.0,2.91
17803.0,2.91
23.0,2.89
132.0,2.88
6365.0,2.88
6378.0,2.87
17673.0,2.86
97.0,2.86
7537.0,2.86
20764.0,2.86
44.0,2.85
5.0,2.85
6227.0,2.85
19.0,2.84
93.0,2.84
6085.0,2.83
6112.0,2.82
4873.0,2.81
11975.0,2.8
22502.0,2.79
86.0,2.79
19610.0,2.77
20753.0,2.76
24.0,2.76
20750.0,2.76
12133.0,2.76
6141.0,2.75
6172.0,2.75
98.0,2.75
125.0,2.74
17269.0,2.74
4943.0,2.73
18996.0,2.73
13.0,2.73
89.0,2.73
169.0,2.72
101.0,2.72
6087.0,2.71
104.0,2.71
6284.0,2.71
7557.0,2.71
37.0,2.71
6084.0,2.69
8.0,2.68
5969.0,2.68
39.0,2.68
117.0,2.67
19298.0,2.66
22427.0,2.66
85.0,2.63
5952.0,2.63
164.0,2.63
19587.0,2.62
33.0,2.62
135.0,2.61
19588.0,2.6
17320.0,2.6
77.0,2.6
18648.0,2.59
5989.0,2.57
138.0,2.55
18202.0,2.55
137.0,2.54
4940.0,2.53
12277.0,2.53
4909.0,2.53
4944.0,2.53
10008.0,2.52
6299.0,2.51
20731.0,2.51
10838.0,2.51
111.0,2.51
6127.0,2.5
6304.0,2.5
61.0,2.5
6211.0,2.49
66.0,2.49
6182.0,2.49
151.0,2.49
3.0,2.47
10976.0,2.46
18646.0,2.46
21242.0,2.46
7453.0,2.45
6162.0,2.44
128.0,2.44
5972.0,2.44
6171.0,2.43
131.0,2.43
21293.0,2.43
7461.0,2.43
17785.0,2.43
10839.0,2.43
4912.0,2.43
6318.0,2.41
7605.0,2.41
4905.0,2.41
6023.0,2.41
67.0,2.4
16138.0,2.4
5960.0,2.4
6308.0,2.4
18621.0,2.4
4861.0,2.39
12.0,2.38
90.0,2.38
19630.0,2.38
6278.0,2.37
70.0,2.37
64.0,2.37
19579.0,2.37
6329.0,2.36
5970.0,2.36
4907.0,2.35
6076.0,2.35
18490.0,2.33
20767.0,2.33
147.0,2.33
10837.0,2.32
130.0,2.32
5914.0,2.32
6144.0,2.32
88.0,2.31
6255.0,2.31
27.0,2.31
6336.0,2.31
5921.0,2.29
19879.0,2.29
15877.0,2.28
21057.0,2.28
148.0,2.27
32704.0,2.27
5951.0,2.27
6062.0,2.27
4915.0,2.26
6133.0,2.26
6250.0,2.26
6143.0,2.26
49.0,2.26
6173.0,2.25
75.0,2.24
19614.0,2.24
18781.0,2.23
4848.0,2.23
6237.0,2.23
19760.0,2.23
5930.0,2.22
6302.0,2.22
13496.0,2.22
12820.0,2.22
4920.0,2.21
6115.0,2.2
22425.0,2.2
73.0,2.2
22096.0,2.19
6337.0,2.19
6265.0,2.19
19295.0,2.18
18347.0,2.18
6343.0,2.18
6207.0,2.18
18350.0,2.18
6064.0,2.17
18622.0,2.17
141.0,2.17
6181.0,2.17
6148.0,2.17
10977.0,2.17
6045.0,2.16
6298.0,2.16
6145.0,2.16
22.0,2.16
12132.0,2.16
4918.0,2.16
17671.0,2.15
5906.0,2.15
35.0,2.14
5911.0,2.14
6340.0,2.14
21292.0,2.13
19250.0,2.13
19294.0,2.13
163.0,2.12
82.0,2.12
13498.0,2.12
4925.0,2.12
109.0,2.12
6319.0,2.12
33191.0,2.11
10365.0,2.11
6366.0,2.1
4898.0,2.1
4894.0,2.09
12027.0,2.09
5963.0,2.09
6260.0,2.09
4917.0,2.09
7425.0,2.09
20817.0,2.09
16119.0,2.08
5999.0,2.08
5907.0,2.07
18784.0,2.07
65.0,2.06
5898.0,2.06
6220.0,2.06
19296.0,2.06
6264.0,2.06
6051.0,2.06
5918.0,2.05
5895.0,2.05
12602.0,2.04
5901.0,2.04
34.0,2.03
10988.0,2.02
116.0,2.02
4866.0,2.02
6095.0,2.02
6229.0,2.02
13421.0,2.02
102.0,2.01
4919.0,2.0
20814.0,2.0
4904.0,2.0
7527.0,1.99
12026.0,1.99
4924.0,1.98
21061.0,1.98
20963.0,1.97
6323.0,1.97
5944.0,1.97
14.0,1.97
6221.0,1.96
99.0,1.96
6210.0,1.96
139.0,1.96
74.0,1.96
19603.0,1.95
5924.0,1.95
126.0,1.95
5920.0,1.95
7529.0,1.95
95.0,1.94
21059.0,1.94
162.0,1.93
41.0,1.93
10972.0,1.93
5942.0,1.92
22413.0,1.92
7540.0,1.91
5896.0,1.91
22424.0,1.9
26.0,1.9
19338.0,1.9
4847.0,1.9
19578.0,1.9
6263.0,1.89
12490.0,1.88
22428.0,1.88
21237.0,1.88
10980.0,1.88
5984.0,1.88
6267.0,1.87
6235.0,1.87
45.0,1.87
18620.0,1.87
12025.0,1.86
43.0,1.85
119.0,1.85
6266.0,1.84
4859.0,1.84
6077.0,1.83
21058.0,1.83
155.0,1.82
4857.0,1.82
12031.0,1.82
10978.0,1.81
22419.0,1.81
107.0,1.81
5913.0,1.81
32703.0,1.8
19619.0,1.79
19627.0,1.79
17318.0,1.78
21060.0,1.77
5961.0,1.77
5910.0,1.77
18997.0,1.76
5957.0,1.76
83.0,1.76
19592.0,1.75
160.0,1.74
6142.0,1.74
87.0,1.73
22423.0,1.73
6164.0,1.72
18352.0,1.72
113.0,1.71
21236.0,1.71
6183.0,1.7
21238.0,1.7
80.0,1.69
6081.0,1.69
6208.0,1.69
91.0,1.69
23778.0,1.68
18204.0,1.66
17540.0,1.66
21239.0,1.66
19628.0,1.66
18995.0,1.66
19590.0,1.65
29.0,1.65
22095.0,1.64
145.0,1.64
19297.0,1.63
19600.0,1.63
10870.0,1.62
6160.0,1.62
18998.0,1.62
6314.0,1.62
20815.0,1.61
6301.0,1.61
48.0,1.61
10869.0,1.61
6024.0,1.61
606
Query:
SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
ORDER BY
    im."composition" DESC
LIMIT 10;
Answer:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
10-2018,Work Comes First Travelers,20.28
11-2018,Work Comes First Travelers,19.45
01-2019,Work Comes First Travelers,18.99
07-2018,Gym Equipment Owners,18.82
02-2019,Work Comes First Travelers,18.39
09-2018,Work Comes First Travelers,18.18
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
Query:
SELECT "interest_id", "ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "ranking" IS NOT NULL
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,ranking
32486.0,1
6106.0,2
18923.0,3
6344.0,4
100.0,5
69.0,6
79.0,7
6111.0,8
6214.0,8
19422.0,10
6110.0,11
4895.0,12
6217.0,13
4.0,14
6218.0,15
6123.0,16
171.0,17
19613.0,18
17.0,19
6.0,20
6013.0,21
4870.0,22
19423.0,23
6089.0,24
161.0,25
6286.0,25
5991.0,27
92.0,28
6184.0,29
19621.0,30
63.0,31
103.0,32
38.0,33
17786.0,34
6232.0,35
165.0,36
18351.0,37
15.0,38
,43
17314.0,39
6151.0,39
4914.0,39
115.0,42
5968.0,42
36.0,44
5943.0,45
133.0,46
1.0,46
114.0,48
6107.0,49
150.0,49
60.0,51
96.0,52
22403.0,53
40.0,54
19758.0,54
17730.0,56
5938.0,57
4869.0,57
4897.0,59
6029.0,60
31.0,60
16137.0,62
6330.0,63
6334.0,63
6315.0,63
4852.0,66
16.0,66
6108.0,68
6206.0,68
6006.0,70
6228.0,70
20768.0,70
4902.0,73
6277.0,74
19757.0,75
4911.0,75
,45
4910.0,77
6285.0,78
11974.0,79
6219.0,79
10250.0,81
6128.0,82
5946.0,83
158.0,83
15935.0,85
4855.0,86
149.0,86
16197.0,88
11067.0,89
17674.0,90
4913.0,90
56.0,92
6341.0,92
6316.0,92
18647.0,92
17803.0,92
23.0,97
132.0,98
6365.0,98
6378.0,100
17673.0,101
97.0,101
7537.0,101
20764.0,101
44.0,105
5.0,105
6227.0,105
19.0,108
93.0,108
6085.0,110
6112.0,111
4873.0,112
11975.0,113
22502.0,114
86.0,114
19610.0,116
20753.0,117
24.0,117
20750.0,117
12133.0,117
6141.0,121
6172.0,121
98.0,121
125.0,124
17269.0,124
4943.0,126
18996.0,126
13.0,126
89.0,126
169.0,130
101.0,130
6087.0,132
104.0,132
6284.0,132
7557.0,132
37.0,132
6084.0,137
8.0,138
5969.0,138
39.0,138
117.0,141
19298.0,142
22427.0,142
85.0,144
5952.0,144
164.0,144
19587.0,147
33.0,147
135.0,149
19588.0,150
17320.0,150
77.0,150
18648.0,153
5989.0,154
138.0,155
18202.0,155
137.0,157
4940.0,158
12277.0,158
4909.0,158
4944.0,158
10008.0,162
6299.0,163
20731.0,163
10838.0,163
111.0,163
6127.0,167
6304.0,167
61.0,167
6211.0,170
66.0,170
6182.0,170
151.0,170
3.0,174
10976.0,175
18646.0,175
21242.0,175
7453.0,178
6162.0,179
128.0,179
5972.0,179
6171.0,182
131.0,182
21293.0,182
7461.0,182
17785.0,182
10839.0,182
4912.0,182
6318.0,189
7605.0,189
4905.0,189
6023.0,189
67.0,193
16138.0,193
5960.0,193
6308.0,193
18621.0,193
4861.0,198
12.0,199
90.0,199
19630.0,199
6278.0,202
70.0,202
64.0,202
19579.0,202
6329.0,206
5970.0,206
4907.0,208
6076.0,208
18490.0,210
20767.0,210
147.0,210
10837.0,213
130.0,213
5914.0,213
6144.0,213
88.0,217
6255.0,217
27.0,217
6336.0,217
5921.0,221
19879.0,221
15877.0,223
21057.0,223
148.0,225
32704.0,225
5951.0,225
6062.0,225
4915.0,229
6133.0,229
6250.0,229
6143.0,229
49.0,229
6173.0,234
75.0,235
19614.0,235
18781.0,237
4848.0,237
6237.0,237
19760.0,237
5930.0,241
6302.0,241
13496.0,241
12820.0,241
4920.0,245
6115.0,246
22425.0,246
73.0,246
22096.0,249
6337.0,249
6265.0,249
19295.0,252
18347.0,252
6343.0,252
6207.0,252
18350.0,252
6064.0,257
18622.0,257
141.0,257
6181.0,257
6148.0,257
10977.0,257
6045.0,263
6298.0,263
6145.0,263
22.0,263
12132.0,263
4918.0,263
17671.0,269
5906.0,269
35.0,271
5911.0,271
6340.0,271
21292.0,274
19250.0,274
19294.0,274
163.0,277
82.0,277
13498.0,277
4925.0,277
109.0,277
6319.0,277
33191.0,283
10365.0,283
6366.0,285
4898.0,285
4894.0,287
12027.0,287
5963.0,287
6260.0,287
4917.0,287
7425.0,287
20817.0,287
16119.0,294
5999.0,294
5907.0,296
18784.0,296
65.0,298
5898.0,298
6220.0,298
19296.0,298
6264.0,298
6051.0,298
5918.0,304
5895.0,304
12602.0,306
5901.0,306
34.0,308
10988.0,309
116.0,309
4866.0,309
6095.0,309
6229.0,309
13421.0,309
102.0,315
4919.0,316
20814.0,316
4904.0,316
7527.0,319
12026.0,319
4924.0,321
21061.0,321
20963.0,323
6323.0,323
5944.0,323
14.0,323
6221.0,327
99.0,327
6210.0,327
139.0,327
74.0,327
19603.0,332
5924.0,332
126.0,332
5920.0,332
7529.0,332
95.0,337
21059.0,337
162.0,339
41.0,339
10972.0,339
5942.0,342
22413.0,342
7540.0,344
5896.0,344
22424.0,346
26.0,346
19338.0,346
4847.0,346
19578.0,346
6263.0,351
12490.0,352
22428.0,352
21237.0,352
10980.0,352
5984.0,352
6267.0,357
6235.0,357
45.0,357
18620.0,357
12025.0,361
43.0,362
119.0,362
6266.0,364
4859.0,364
6077.0,366
21058.0,366
155.0,368
4857.0,368
12031.0,368
10978.0,371
22419.0,371
107.0,371
5913.0,371
32703.0,375
19619.0,376
19627.0,376
17318.0,378
21060.0,379
5961.0,379
5910.0,379
18997.0,382
5957.0,382
83.0,382
19592.0,385
160.0,386
6142.0,386
87.0,388
22423.0,388
6164.0,390
18352.0,390
113.0,392
21236.0,392
6183.0,394
21238.0,394
80.0,396
6081.0,396
6208.0,396
91.0,396
23778.0,400
18204.0,401
17540.0,401
21239.0,401
19628.0,401
18995.0,401
19590.0,406
29.0,406
22095.0,408
145.0,408
19297.0,410
19600.0,410
10870.0,412
6160.0,412
18998.0,412
6314.0,412
20815.0,416
6301.0,416
48.0,416
10869.0,416
6024.0,416
6067.0,421
17672.0,422
6234.0,423
7535.0,423
5958.0,423
157.0,423
6305.0,423
6177.0,423
6328.0,423
143.0,430
4930.0,430
22411.0,430
30.0,430
10835.0,430
19617.0,435
18782.0,435
5956.0,437
4928.0,437
59.0,439
14901.0,439
20756.0,439
55.0,439
6321.0,443
13497.0,444
6320.0,444
18619.0,446
6030.0,447
168.0,447
6322.0,447
134.0,447
32485.0,447
17271.0,447
10284.0,453
6209.0,454
10981.0,454
6169.0,456
142.0,456
6131.0,456
19625.0,456
28.0,456
6194.0,456
19633.0,462
153.0,462
10832.0,462
19606.0,462
6088.0,
Query:
SELECT "composition", "index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Answer:
Too long, hard cut:
composition,index_value
11.89,6.19
9.93,5.31
10.85,5.29
10.32,5.1
10.77,5.04
10.82,5.03
11.21,4.97
10.71,4.83
9.71,4.83
10.11,4.81
11.57,4.79
9.47,4.67
10.8,4.62
13.97,4.53
9.29,4.5
9.49,4.49
14.91,4.47
12.62,4.38
7.89,4.15
11.99,4.08
9.35,3.99
10.29,3.95
12.22,3.92
6.97,3.84
11.48,3.82
14.1,3.82
11.04,3.81
9.77,3.77
13.35,3.75
11.61,3.74
9.37,3.73
6.61,3.69
9.48,3.66
13.67,3.65
9.97,3.64
6.05,3.59
6.09,3.58
6.9,3.56
6.12,2.85
10.43,3.55
6.83,3.55
7.42,3.55
11.68,3.53
12.87,3.53
9.27,3.51
6.37,3.48
10.91,3.44
7.02,3.44
6.25,3.41
8.84,3.39
5.3,3.39
6.71,3.36
7.21,3.35
12.27,3.33
10.86,3.32
6.28,3.32
11.38,3.3
11.63,3.29
6.47,3.29
12.93,3.27
8.72,3.26
7.9,3.26
9.65,3.24
6.82,3.22
11.63,3.22
8.14,3.22
6.77,3.2
6.24,3.2
6.65,3.17
10.76,3.17
6.26,3.15
10.22,3.15
6.53,3.15
8.17,3.12
11.72,3.1
10.95,3.08
6.87,3.08
7.13,2.84
6.09,3.07
9.97,3.04
7.19,3.02
6.37,3.02
11.4,3.01
6.28,2.98
5.99,2.97
7.46,2.97
9.13,2.96
5.99,2.95
6.88,2.95
6.13,2.94
5.14,2.93
6.25,2.92
6.76,2.92
7.09,2.91
5.68,2.91
6.52,2.91
6.45,2.91
6.21,2.91
5.41,2.89
7.48,2.88
6.45,2.88
9.64,2.87
8.07,2.86
6.41,2.86
7.82,2.86
5.85,2.86
6.11,2.85
10.82,2.85
6.07,2.85
6.57,2.84
7.08,2.84
7.08,2.83
9.22,2.82
5.45,2.81
7.81,2.8
8.24,2.79
6.13,2.79
7.56,2.77
5.79,2.76
6.54,2.76
5.87,2.76
10.79,2.76
6.34,2.75
5.88,2.75
7.64,2.75
6.38,2.74
8.64,2.74
8.81,2.73
7.84,2.73
6.72,2.73
8.48,2.73
6.1,2.72
7.38,2.72
5.41,2.71
5.42,2.71
18.82,2.71
8.17,2.71
7.82,2.71
6.97,2.69
6.67,2.68
11.15,2.68
17.44,2.68
6.49,2.67
10.27,2.66
8.04,2.66
6.46,2.63
7.11,2.63
6.14,2.63
5.85,2.62
7.6,2.62
7.01,2.61
5.87,2.6
3.98,2.6
17.19,2.6
7.1,2.59
5.57,2.57
7.3,2.55
7.61,2.55
7.94,2.54
5.89,2.53
6.2,2.53
7.01,2.53
8.32,2.53
9.46,2.52
5.71,2.51
5.86,2.51
6.8,2.51
7.42,2.51
5.96,2.5
8.31,2.5
6.59,2.5
8.09,2.49
6.51,2.49
6.57,2.49
7.97,2.49
6.14,2.47
8.16,2.46
6.85,2.46
7.36,2.46
6.45,2.45
6.32,2.44
6.5,2.44
6.58,2.44
8.19,2.43
5.09,2.43
7.28,2.43
7.0,2.43
7.66,2.43
5.59,2.43
7.77,2.43
6.65,2.41
6.82,2.41
5.66,2.41
8.02,2.41
6.67,2.4
8.81,2.4
7.86,2.4
7.67,2.4
7.31,2.4
5.29,2.39
7.23,2.38
5.91,2.38
7.15,2.38
6.18,2.37
6.96,2.37
8.8,2.37
6.24,2.37
7.63,2.36
9.21,2.36
6.26,2.35
5.75,2.35
7.09,2.33
7.73,2.33
6.17,2.33
7.48,2.32
7.66,2.32
6.4,2.32
6.61,2.32
4.99,2.31
7.55,2.31
6.81,2.31
8.5,2.31
7.37,2.29
6.95,2.29
5.77,2.28
10.95,2.28
5.49,2.27
8.04,2.27
6.09,2.27
7.33,2.27
6.28,2.26
3.82,2.26
5.54,2.26
5.47,2.26
5.09,2.26
7.66,2.25
7.23,2.24
5.57,2.24
6.56,2.23
6.49,2.23
7.7,2.23
5.36,2.23
6.17,2.22
7.41,2.22
6.78,2.22
6.07,2.22
5.93,2.21
6.67,2.2
6.41,2.2
7.06,2.2
6.56,2.19
7.02,2.19
7.31,2.19
8.44,2.18
7.8,2.18
8.15,2.18
7.81,2.18
6.85,2.18
7.02,2.17
7.44,2.17
7.77,2.17
6.11,2.17
7.13,2.17
8.3,2.17
7.42,2.16
5.38,2.16
6.1,2.16
6.26,2.16
7.12,2.16
6.29,2.16
5.65,2.15
7.69,2.15
5.25,2.14
6.94,2.14
7.44,2.14
7.19,2.13
7.45,2.13
7.22,2.13
6.4,2.12
9.99,2.12
6.42,2.12
6.4,2.12
6.75,2.12
7.39,2.12
3.99,2.11
5.21,2.11
6.6,2.1
14.23,2.1
5.81,2.09
8.32,2.09
5.36,2.09
5.27,2.09
6.1,2.09
7.43,2.09
3.62,2.09
7.93,2.08
5.14,2.08
7.12,2.07
6.92,2.07
5.94,2.06
7.85,2.06
7.59,2.06
6.66,2.06
7.7,2.06
5.31,2.06
6.8,2.05
7.89,2.05
7.15,2.04
6.79,2.04
8.26,2.03
8.17,2.02
6.31,2.02
6.33,2.02
7.5,2.02
7.2,2.02
7.15,2.02
7.74,2.01
6.35,2.0
3.89,2.0
6.28,2.0
5.97,1.99
7.21,1.99
5.11,1.98
7.23,1.98
5.78,1.97
6.28,1.97
6.39,1.97
3.53,1.97
5.94,1.96
6.79,1.96
6.09,1.96
6.87,1.96
7.37,1.96
6.05,1.95
5.68,1.95
3.8,1.95
6.07,1.95
6.5,1.95
7.15,1.94
6.66,1.94
5.16,1.93
6.96,1.93
7.35,1.93
6.29,1.92
6.26,1.92
6.8,1.91
6.09,1.91
6.05,1.9
6.01,1.9
7.68,1.9
5.65,1.9
4.14,1.9
4.98,1.89
6.85,1.88
5.59,1.88
5.27,1.88
6.14,1.88
4.9,1.88
6.88,1.87
4.67,1.87
6.29,1.87
6.16,1.87
8.45,1.86
5.98,1.85
6.31,1.85
6.64,1.84
6.48,1.84
4.83,1.83
8.5,1.83
4.97,1.82
6.56,1.82
6.67,1.82
6.53,1.81
6.84,1.81
8.32,1.81
6.0,1.81
5.53,1.8
6.0,1.79
3.98,1.79
4.93,1.78
8.58,1.77
7.12,1.77
5.22,1.77
5.8,1.76
6.08,1.76
4.04,1.76
5.08,1.75
5.92,1.74
5.5,1.74
5.01,1.73
5.33,1.73
5.37,1.72
6.55,1.72
5.53,1.71
4.04,1.71
6.71,1.7
4.92,1.7
4.47,1.69
5.92,1.69
9.67,1.69
5.87,1.69
5.13,1.68
5.93,1.66
5.06,1.66
3.52,1.66
4.66,1.66
4.97,1.66
4.59,1.65
5.2,1.65
4.54,1.64
4.89,1.64
4.26,1.63
5.21,1.63
3.29,1.62
4.93,1.62
4.12,1.62
3.77,1.62
3.03,1.61
5.58,1.61
5.33,1.61
5.0,1.61
4.7,1.61
4.71,1.6
4.09,1.59
4.26,1.58
4.18,1.58
4.27,1.58
4.94,1.58
5.84,1.58
4.41,1.58
5.43,1.58
4.68,1.56
4.37,1.56
5.22,1.56
3.0,1.56
5.69,1.56
4.07,1.55
5.64,1.55
4.65,1.54
4.76,1.54
3.97,1.53
3.75,1.53
5.29,1.53
4.0,1.53
4.97,1.52
5.37,1.51
4.72,1.51
9.15,1.5
3.85,1.49
3.75,1.49
5.67,1.49
4.54,1.49
4.31,1.49
3.74,1.49
5.02,1.48
4.45,1.47
5.47,1.47
3.8,1.46
4.73,1.46
2.81,1.46
4.32,1.46
4.84,1.46
4.39,1.46
3.17,1.45
5.08,1.45
4.4,1.45
4.42,1.45
4.28,1.44
4.6,1.44
4.22,1.44
3.18,1.44
4.29,1.44
3.49,1.44
4.54,1.44
3.78,1.43
3.69,1.43
4.22,1.43
4.33,1.43
4.15,1.42
4.37,1.42
3.76,1.42
4.34,1.42
2.62,1.42
4.46,1.42
2.91,1.41
4.23,1.41
3.07,1.4
4.77,1.4
3.94,1.4
10.3,1.4
4.63,1.4
5.08,1.39
4.18,1.38
6.41,1.38
3.42,1.38
4.11,1.37
4.63,1.37
3.47,1.36
4.1,1.36
3.31,1.36
3.52,1.36
4.13,1.3
Query:
SELECT "interest_id", "_month", "_year"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,_month,_year
32486.0,7.0,2018.0
6106.0,7.0,2018.0
18923.0,7.0,2018.0
6344.0,7.0,2018.0
100.0,7.0,2018.0
69.0,7.0,2018.0
79.0,7.0,2018.0
6111.0,7.0,2018.0
6214.0,7.0,2018.0
19422.0,7.0,2018.0
6110.0,7.0,2018.0
4895.0,7.0,2018.0
6217.0,7.0,2018.0
4.0,7.0,2018.0
6218.0,7.0,2018.0
6123.0,7.0,2018.0
171.0,7.0,2018.0
19613.0,7.0,2018.0
17.0,7.0,2018.0
6.0,7.0,2018.0
6013.0,7.0,2018.0
4870.0,7.0,2018.0
19423.0,7.0,2018.0
6089.0,7.0,2018.0
161.0,7.0,2018.0
6286.0,7.0,2018.0
5991.0,7.0,2018.0
92.0,7.0,2018.0
6184.0,7.0,2018.0
19621.0,7.0,2018.0
63.0,7.0,2018.0
103.0,7.0,2018.0
38.0,7.0,2018.0
17786.0,7.0,2018.0
6232.0,7.0,2018.0
165.0,7.0,2018.0
18351.0,7.0,2018.0
15.0,7.0,2018.0
,,
17314.0,7.0,2018.0
6151.0,7.0,2018.0
4914.0,7.0,2018.0
115.0,7.0,2018.0
5968.0,7.0,2018.0
36.0,7.0,2018.0
5943.0,7.0,2018.0
133.0,7.0,2018.0
1.0,7.0,2018.0
114.0,7.0,2018.0
6107.0,7.0,2018.0
150.0,7.0,2018.0
60.0,7.0,2018.0
96.0,7.0,2018.0
22403.0,7.0,2018.0
40.0,7.0,2018.0
19758.0,7.0,2018.0
17730.0,7.0,2018.0
5938.0,7.0,2018.0
4869.0,7.0,2018.0
4897.0,7.0,2018.0
6029.0,7.0,2018.0
31.0,7.0,2018.0
16137.0,7.0,2018.0
6330.0,7.0,2018.0
6334.0,7.0,2018.0
6315.0,7.0,2018.0
4852.0,7.0,2018.0
16.0,7.0,2018.0
6108.0,7.0,2018.0
6206.0,7.0,2018.0
6006.0,7.0,2018.0
6228.0,7.0,2018.0
20768.0,7.0,2018.0
4902.0,7.0,2018.0
6277.0,7.0,2018.0
19757.0,7.0,2018.0
4911.0,7.0,2018.0
,,
4910.0,7.0,2018.0
6285.0,7.0,2018.0
11974.0,7.0,2018.0
6219.0,7.0,2018.0
10250.0,7.0,2018.0
6128.0,7.0,2018.0
5946.0,7.0,2018.0
158.0,7.0,2018.0
15935.0,7.0,2018.0
4855.0,7.0,2018.0
149.0,7.0,2018.0
16197.0,7.0,2018.0
11067.0,7.0,2018.0
17674.0,7.0,2018.0
4913.0,7.0,2018.0
56.0,7.0,2018.0
6341.0,7.0,2018.0
6316.0,7.0,2018.0
18647.0,7.0,2018.0
17803.0,7.0,2018.0
23.0,7.0,2018.0
132.0,7.0,2018.0
6365.0,7.0,2018.0
6378.0,7.0,2018.0
17673.0,7.0,2018.0
97.0,7.0,2018.0
7537.0,7.0,2018.0
20764.0,7.0,2018.0
44.0,7.0,2018.0
5.0,7.0,2018.0
6227.0,7.0,2018.0
19.0,7.0,2018.0
93.0,7.0,2018.0
6085.0,7.0,2018.0
6112.0,7.0,2018.0
4873.0,7.0,2018.0
11975.0,7.0,2018.0
22502.0,7.0,2018.0
86.0,7.0,2018.0
19610.0,7.0,2018.0
20753.0,7.0,2018.0
24.0,7.0,2018.0
20750.0,7.0,2018.0
12133.0,7.0,2018.0
6141.0,7.0,2018.0
6172.0,7.0,2018.0
98.0,7.0,2018.0
125.0,7.0,2018.0
17269.0,7.0,2018.0
4943.0,7.0,2018.0
18996.0,7.0,2018.0
13.0,7.0,2018.0
89.0,7.0,2018.0
169.0,7.0,2018.0
101.0,7.0,2018.0
6087.0,7.0,2018.0
104.0,7.0,2018.0
6284.0,7.0,2018.0
7557.0,7.0,2018.0
37.0,7.0,2018.0
6084.0,7.0,2018.0
8.0,7.0,2018.0
5969.0,7.0,2018.0
39.0,7.0,2018.0
117.0,7.0,2018.0
19298.0,7.0,2018.0
22427.0,7.0,2018.0
85.0,7.0,2018.0
5952.0,7.0,2018.0
164.0,7.0,2018.0
19587.0,7.0,2018.0
33.0,7.0,2018.0
135.0,7.0,2018.0
19588.0,7.0,2018.0
17320.0,7.0,2018.0
77.0,7.0,2018.0
18648.0,7.0,2018.0
5989.0,7.0,2018.0
138.0,7.0,2018.0
18202.0,7.0,2018.0
137.0,7.0,2018.0
4940.0,7.0,2018.0
12277.0,7.0,2018.0
4909.0,7.0,2018.0
4944.0,7.0,2018.0
10008.0,7.0,2018.0
6299.0,7.0,2018.0
20731.0,7.0,2018.0
10838.0,7.0,2018.0
111.0,7.0,2018.0
6127.0,7.0,2018.0
6304.0,7.0,2018.0
61.0,7.0,2018.0
6211.0,7.0,2018.0
66.0,7.0,2018.0
6182.0,7.0,2018.0
151.0,7.0,2018.0
3.0,7.0,2018.0
10976.0,7.0,2018.0
18646.0,7.0,2018.0
21242.0,7.0,2018.0
7453.0,7.0,2018.0
6162.0,7.0,2018.0
128.0,7.0,2018.0
5972.0,7.0,2018.0
6171.0,7.0,2018.0
131.0,7.0,2018.0
21293.0,7.0,2018.0
7461.0,7.0,2018.0
17785.0,7.0,2018.0
10839.0,7.0,2018.0
4912.0,7.0,2018.0
6318.0,7.0,2018.0
7605.0,7.0,2018.0
4905.0,7.0,2018.0
6023.0,7.0,2018.0
67.0,7.0,2018.0
16138.0,7.0,2018.0
5960.0,7.0,2018.0
6308.0,7.0,2018.0
18621.0,7.0,2018.0
4861.0,7.0,2018.0
12.0,7.0,2018.0
90.0,7.0,2018.0
19630.0,7.0,2018.0
6278.0,7.0,2018.0
70.0,7.0,2018.0
64.0,7.0,2018.0
19579.0,7.0,2018.0
6329.0,7.0,2018.0
5970.0,7.0,2018.0
4907.0,7.0,2018.0
6076.0,7.0,2018.0
18490.0,7.0,2018.0
20767.0,7.0,2018.0
147.0,7.0,2018.0
10837.0,7.0,2018.0
130.0,7.0,2018.0
5914.0,7.0,2018.0
6144.0,7.0,2018.0
88.0,7.0,2018.0
6255.0,7.0,2018.0
27.0,7.0,2018.0
6336.0,7.0,2018.0
5921.0,7.0,2018.0
19879.0,7.0,2018.0
15877.0,7.0,2018.0
21057.0,7.0,2018.0
148.0,7.0,2018.0
32704.0,7.0,2018.0
5951.0,7.0,2018.0
6062.0,7.0,2018.0
4915.0,7.0,2018.0
6133.0,7.0,2018.0
6250.0,7.0,2018.0
6143.0,7.0,2018.0
49.0,7.0,2018.0
6173.0,7.0,2018.0
75.0,7.0,2018.0
19614.0,7.0,2018.0
18781.0,7.0,2018.0
4848.0,7.0,2018.0
6237.0,7.0,2018.0
19760.0,7.0,2018.0
5930.0,7.0,2018.0
6302.0,7.0,2018.0
13496.0,7.0,2018.0
12820.0,7.0,2018.0
4920.0,7.0,2018.0
6115.0,7.0,2018.0
22425.0,7.0,2018.0
73.0,7.0,2018.0
22096.0,7.0,2018.0
6337.0,7.0,2018.0
6265.0,7.0,2018.0
19295.0,7.0,2018.0
18347.0,7.0,2018.0
6343.0,7.0,2018.0
6207.0,7.0,2018.0
18350.0,7.0,2018.0
6064.0,7.0,2018.0
18622.0,7.0,2018.0
141.0,7.0,2018.0
6181.0,7.0,2018.0
6148.0,7.0,2018.0
10977.0,7.0,2018.0
6045.0,7.0,2018.0
6298.0,7.0,2018.0
6145.0,7.0,2018.0
22.0,7.0,2018.0
12132.0,7.0,2018.0
4918.0,7.0,2018.0
17671.0,7.0,2018.0
5906.0,7.0,2018.0
35.0,7.0,2018.0
5911.0,7.0,2018.0
6340.0,7.0,2018.0
21292.0,7.0,2018.0
19250.0,7.0,2018.0
19294.0,7.0,2018.0
163.0,7.0,2018.0
82.0,7.0,2018.0
13498.0,7.0,2018.0
4925
Query:
SELECT "interest_id", "composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "_month" = 6 -- June
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
41548.0,5.03
22502.0,4.32
42203.0,3.86
115.0,4.21
6206.0,4.55
19250.0,4.5
44272.0,3.5
151.0,3.9
41854.0,2.86
45518.0,3.24
35904.0,3.42
48154.0,3.34
6285.0,3.85
40439.0,3.45
12133.0,4.21
39665.0,3.54
19298.0,3.71
47713.0,3.1
47130.0,2.97
44588.0,3.17
17269.0,3.23
4.0,3.45
6232.0,2.99
6286.0,3.84
19295.0,3.72
171.0,3.38
37875.0,3.37
38.0,2.86
5970.0,4.39
41069.0,2.74
41191.0,2.85
10008.0,3.84
44446.0,2.55
45678.0,2.87
44489.0,2.55
6219.0,2.68
5969.0,4.63
38990.0,3.24
6378.0,3.52
44453.0,2.86
31.0,2.73
6013.0,2.45
16.0,2.44
49979.0,2.73
44469.0,3.01
6284.0,6.94
44585.0,3.1
6023.0,3.62
16137.0,2.96
6.0,2.87
19423.0,2.97
4897.0,3.66
18347.0,3.34
33.0,3.08
12025.0,4.61
6107.0,2.62
21242.0,3.04
5968.0,3.24
11067.0,2.34
44476.0,2.98
10980.0,3.21
40183.0,2.97
6218.0,2.29
44587.0,2.27
21237.0,3.16
4943.0,2.87
39.0,6.03
79.0,2.4
36879.0,2.91
5960.0,3.12
6144.0,2.83
6305.0,2.96
101.0,2.47
18996.0,3.02
6304.0,3.38
6184.0,2.89
19613.0,2.69
17320.0,2.3
4912.0,2.74
37423.0,2.83
6110.0,2.48
41080.0,2.16
141.0,3.12
38994.0,2.61
32486.0,2.42
32704.0,2.95
39657.0,2.44
44455.0,2.46
34465.0,2.13
18202.0,2.86
41083.0,2.29
49.0,2.43
6142.0,2.75
39649.0,2.3
19621.0,3.11
6343.0,3.08
6029.0,2.27
4924.0,2.63
134.0,2.71
35903.0,2.75
36868.0,2.47
41070.0,2.35
44447.0,2.73
6263.0,2.4
37411.0,2.46
42239.0,1.9
10977.0,3.24
41552.0,2.69
39656.0,2.38
17.0,1.93
158.0,2.57
33191.0,2.13
137.0,2.75
147.0,2.44
6328.0,2.52
64.0,3.17
17673.0,2.37
39331.0,2.07
33959.0,2.02
5944.0,2.53
6250.0,2.28
89.0,2.55
40699.0,1.68
6340.0,2.78
35.0,2.08
30.0,1.99
5896.0,2.97
15.0,2.08
39646.0,1.93
34462.0,2.01
39643.0,1.87
4911.0,2.07
40682.0,2.58
77.0,5.53
7527.0,2.6
40184.0,2.54
33971.0,2.38
18995.0,2.45
10351.0,2.92
41197.0,2.64
88.0,2.12
39336.0,2.0
85.0,2.2
111.0,2.43
21238.0,2.56
5958.0,2.29
44.0,2.06
34469.0,2.33
98.0,2.26
39642.0,1.87
17786.0,2.73
17785.0,2.54
22403.0,2.9
6171.0,2.33
39330.0,1.85
6173.0,2.63
34463.0,1.75
44448.0,1.86
10250.0,2.7
41190.0,2.59
36867.0,2.3
37880.0,1.95
20766.0,2.1
6133.0,1.9
16138.0,2.62
43550.0,2.32
33474.0,2.19
5938.0,2.73
22427.0,2.32
6062.0,2.36
36860.0,2.0
11974.0,2.13
33960.0,1.84
39650.0,1.77
45521.0,2.17
7534.0,2.42
41087.0,1.98
6051.0,2.44
19603.0,2.71
7535.0,4.67
45725.0,2.23
10981.0,3.4
45673.0,2.42
56.0,2.21
40.0,2.55
6143.0,2.17
20817.0,1.77
20814.0,1.87
12031.0,2.62
41082.0,1.84
39337.0,1.85
23778.0,2.4
6081.0,2.61
44378.0,2.25
39334.0,1.8
45676.0,2.68
38356.0,2.18
45519.0,2.32
6323.0,2.32
17730.0,2.87
6315.0,1.81
83.0,1.89
155.0,2.19
21292.0,2.44
44490.0,2.02
39648.0,1.85
18204.0,2.99
44470.0,1.93
35169.0,2.26
33964.0,1.79
36020.0,2.29
41081.0,1.82
44589.0,1.92
45675.0,1.98
7557.0,2.26
34467.0,2.42
18923.0,2.0
44465.0,2.02
6210.0,2.61
37877.0,1.76
38360.0,2.12
20755.0,2.13
38995.0,2.41
22428.0,2.38
33967.0,1.81
5906.0,2.48
126.0,2.17
41079.0,1.86
37.0,2.22
32703.0,2.79
39339.0,1.8
44473.0,2.03
45671.0,2.42
74.0,2.37
44450.0,2.1
12821.0,2.59
35953.0,2.36
6128.0,1.83
33966.0,1.75
6235.0,2.16
19590.0,2.21
37878.0,1.87
35906.0,2.15
41055.0,2.16
39658.0,1.98
37874.0,2.25
33972.0,1.83
60.0,1.66
75.0,2.18
16196.0,2.86
44586.0,2.34
135.0,2.07
41554.0,1.86
41856.0,2.18
10284.0,2.33
5913.0,2.55
4914.0,1.82
41052.0,2.2
19338.0,2.75
44381.0,2.43
45670.0,2.42
33968.0,1.76
20768.0,1.84
5967.0,2.34
18997.0,2.19
17674.0,1.72
82.0,4.05
19592.0,2.21
41054.0,1.79
5907.0,2.34
37879.0,2.29
34643.0,1.61
4910.0,1.64
41072.0,1.9
6085.0,1.82
45516.0,1.98
39193.0,2.09
157.0,2.21
50.0,1.83
21293.0,2.35
33965.0,1.82
19578.0,1.89
6112.0,3.29
44468.0,2.16
6234.0,2.21
10832.0,2.35
41067.0,1.77
34464.0,1.67
39335.0,1.78
39333.0,1.71
39332.0,1.78
40190.0,2.02
6207.0,2.66
99.0,2.4
42237.0,2.0
50860.0,1.89
40525.0,2.5
12026.0,2.59
42398.0,1.87
44457.0,1.76
5963.0,2.05
17314.0,1.97
6098.0,2.48
4902.0,2.03
19625.0,2.26
143.0,1.94
41088.0,1.89
10974.0,2.98
41547.0,2.11
6106.0,1.61
6264.0,2.31
41066.0,1.71
41199.0,1.77
42238.0,2.01
160.0,2.36
39338.0,1.76
36876.0,2.05
44456.0,1.68
11975.0,1.99
38991.0,1.89
6319.0,2.77
6336.0,2.33
107.0,4.15
45517.0,1.88
41059.0,1.72
102.0,2.79
61.0,2.07
6108.0,1.69
18782.0,2.6
44389.0,1.76
20751.0,2.05
113.0,2.26
169.0,1.63
34466.0,1.8
44458.0,1.63
6316.0,1.68
34082.0,1.78
21240.0,2.0
17318.0,1.97
10988.0,2.81
19600.0,2.35
43544.0,1.97
6208.0,4.24
80.0,1.88
5956.0,2.13
19628.0,2.32
39196.0,1.67
40688.0,1.82
4944.0,2.26
5933.0,2.56
6045.0,2.29
6030.0,1.9
4936.0,2.11
34574.0,2.0
6084.0,1.7
86.0,1.67
12027.0,2.64
36884.0,2.32
39644.0,1.67
20750.0,1.75
34461.0,2.08
162.0,1.69
4909.0,1.84
10972.0,2.46
38357.0,2.11
6335.0,2.14
36862.0,1.98
39653.0,1.69
6211.0,2.06
41075.0,1.64
18924.0,2.55
14895.0,2.12
161.0,1.92
48462.0,1.95
5916.0,2.43
132.0,1.98
12132.0,2.04
44487.0,1.92
44474.0,1.96
5910.0,2.21
43542.0,1.93
4870.0,1.86
10835.0,2.6
40194.0,1.65
6077.0,1.93
41855.0,1.84
39654.0,1.67
20816.0,1.78
22423.0,2.31
34638.0,1.64
41078.0,1.67
34468.0,2.01
6168.0,2.41
32705.0,2.45
38989.0,2.15
7685.0,2.34
41063.0,1.7
7542.0,2.58
39768.0,1.83
35905.0,2.15
36871.0,1.9
39195.0,1.55
36882.0,1.86
39652.0,1.81
Query:
(SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
WHERE
    im."composition" IS NOT NULL
ORDER BY
    im."composition" DESC
LIMIT 10)
UNION ALL
(SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
    ON im."interest_id" = imap."id"
WHERE
    im."composition" IS NOT NULL
ORDER BY
    im."composition" ASC
LIMIT 10)
ORDER BY
    "Composition_Value" DESC;
Answer:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
10-2018,Work Comes First Travelers,20.28
11-2018,Work Comes First Travelers,19.45
01-2019,Work Comes First Travelers,18.99
07-2018,Gym Equipment Owners,18.82
02-2019,Work Comes First Travelers,18.39
09-2018,Work Comes First Travelers,18.18
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
05-2019,Gastrointestinal Researchers,1.52
03-2019,World of Warcraft Enthusiasts,1.52
06-2019,Disney Fans,1.52
04-2019,United Nations Donors,1.52
05-2019,Beer Aficionados,1.52
04-2019,Minnesota Vikings Fans,1.52
05-2019,Philadelphia 76ers Fans,1.52
06-2019,New York Giants Fans,1.52
08-2018,Readers of Jamaican Content,1.52
05-2019,Mowing Equipment Shoppers,1.51
Query:
SELECT "interest_name", "interest_summary"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_name,interest_summary
Fitness Enthusiasts,Consumers using fitness tracking apps and websites.
Gamers,Consumers researching game reviews and cheat codes.
Car Enthusiasts,Readers of automotive news and car reviews.
Luxury Retail Researchers,Consumers researching luxury product reviews and gift ideas.
Brides & Wedding Planners,People researching wedding ideas and vendors.
Vacation Planners,Consumers reading reviews of vacation destinations and accommodations.
Motorcycle Enthusiasts,Readers of motorcycle news and reviews.
Business News Readers,Readers of online business news content.
Thrift Store Shoppers,Consumers shopping online for clothing at thrift stores and researching locations.
Advertising Professionals,People who read advertising industry news.
NFL Fans,People reading articles and websites about football and the NFL.
NBA Fans,People reading articles and websites about basketball and the NBA.
NCAA Fans,People reading articles and websites about college sports and the NCAA.
MLB Fans,People reading articles and websites about baseball and the MLB.
Nascar Fans,People reading articles and websites about nascar.
Eco-Conscious Consumers,People researching climate change and sustainable living.
Moviegoers,Consumers researching box office listings and buying movie tickets.
DIYers,Consumers researching DIY projects.
Grill Masters,Grill owners researching new recipes.
Techies,Readers of tech news and gadget reviews.
Home Design Enthusiasts,Consumers researching home design styles and trends.
Doctors,People reading medical journals and using online prescribing services.
Streaming Video Fans,Consumers streaming feature length movies and TV shows.
Auto Insurance Shoppers,Consumers shopping for auto insurance.
Teachers,People reading education industry publications and teaching advice websites.
College Students,People visiting university websites.
Department Store Shoppers,Consumes shopping at multi-category department stores.
Home Decor Shoppers,"Consumers shopping for home design, art and accessories."
Kids Clothing Shoppers,Consumers shopping for childrens apparel.
Teen Girl Clothing Shoppers,Consumers in-market for clothing for teenage girls.
Mens Clothing Shoppers,Consumers in-market for mens clothing.
Baby Products Buyers,Consumers shopping for baby-related products.
Jewelry & Watch Shoppers,Consumers researching high-end watch and jewelry brands.
Sporting Goods Shoppers,Consumers shopping for sporting goods and activewear apparel.
Furniture Shoppers,Consumers shopping for major home furnishings.
Bed & Bath Shoppers,Consumers shopping for bed and bath products.
Intimates Shoppers,Consumers shopping for lingerie.
Fast Fashion Shoppers,Consumers shopping for apparel that mimics current runway trends.
Apartment Hunters,People reading real estate rental listings.
Home Buyers,People reading real estate sales listings.
Moving Services Shoppers,Consumers who are shopping for moving services.
Job Seekers,People researching job boards.
Charitable Donors,People researching major charitable organizations.
NHL Fans,People reading articles and websites about hockey and the NHL.
Discount Big Box Shoppers,Consumers shopping at big box retailers.
Black Friday Deal Shoppers,Consumers researching holiday sales events.
Hip Hop Fans,People reading about hip hop music and hip hop stars.
Online Investors,Consumers with an active online trading account.
Seasonal Allergy Sufferers,People researching allergy trends and treatment options.
Discount Device Shoppers,Consumers shopping for discounted electronics.
Mobile Phone Comparison Shoppers,Consumers researching alternative mobile phones and wireless plans.
Budget Wireless Shoppers,Consumers researching discount wireless service plans.
Menopause Researchers,People researching menopause symptoms.
Online Health Researchers,People researching general health questions.
Beauty & Skincare Buyers,Consumers shopping for beauty and skincare products.
Streaming Device Shoppers,Consumers shopping for connected TV products.
New & Expecting Parents,People researching pregnancy issues and baby names.
High-End Kids Furniture and Clothes Shoppers,People shopping at high end childrens clothing and toy retailers.
Hands-On Parents,"People reading about family cooking, parenting advice and childrens activities."
Fantasy & Comic Fans,Consumers of online comics and fantasy novels.
Lawyers,People reading legal journals and industry publications.
Healthy Eaters,People researching healthy eating options.
Drug Store Shoppers,Consumers shopping online or searching for a local drug store.
Lawn & Garden Enthusiasts,Consumers reseraching lawn and garden maintenance techniques.
Nurses,People reading websites about nursing lifestyle and career advice.
Mailing & Shipping Shoppers,Consumers shopping for shipping supplies and postage.
Office Supply Shoppers,Individuals in-market for office supplies.
Ink & Toner Shoppers,Consumers shopping for printer ink.
Luxury Retail Shoppers,Consumers shopping for high end 
End Exploring Related Columns
Task: Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, the results can be presented in the following format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1:str,InterestName1:str,CompositionValue1:float
MM-YYYY2:str,InterestName2:str,CompositionValue2:float
...
MM-YYYY10:str,InterestName10:str,CompositionValue10:float
(Top 10 interest categories based on highest composition values)

MM-YYYY11:str,InterestName11:str,CompositionValue11:float
...
MM-YYYY20:str,InterestName20:str,CompositionValue20:float
(Bottom 10 interest categories based on highest composition values)
```

**Explanation:**

- **Time(MM-YYYY):** The month and year when the interest category had its highest composition value.
- **Interest_Name:** The name of the interest category.
- **Composition_Value:** The highest composition value for the interest category across all months.

This table lists the top 10 interest categories with the highest composition values followed by the bottom 10 interest categories with the lowest composition values, providing a clear comparison based on their peak performance over time..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 14:36:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:36:07 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (
            PARTITION BY im."interest_id"
            ORDER BY im."composition" DESC, im."month_year" DESC
        ) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC, "interest_id") AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC, "interest_id") AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC, "interest_id";
```
2025-01-19 14:36:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:36:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:36:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:36:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:36:08 - snowflake.connector.connection - INFO - closed
2025-01-19 14:36:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:36:09 - root - INFO - itercount: 1
2025-01-19 14:36:09 - root - INFO - 0
2025-01-19 14:36:09 - root - INFO - results: 
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57


2025-01-19 14:36:09 - root - INFO - Please check the answer again by reviewing Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, the results can be presented in the following format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1:str,InterestName1:str,CompositionValue1:float
MM-YYYY2:str,InterestName2:str,CompositionValue2:float
...
MM-YYYY10:str,InterestName10:str,CompositionValue10:float
(Top 10 interest categories based on highest composition values)

MM-YYYY11:str,InterestName11:str,CompositionValue11:float
...
MM-YYYY20:str,InterestName20:str,CompositionValue20:float
(Bottom 10 interest categories based on highest composition values)
```

**Explanation:**

- **Time(MM-YYYY):** The month and year when the interest category had its highest composition value.
- **Interest_Name:** The name of the interest category.
- **Composition_Value:** The highest composition value for the interest category across all months.

This table lists the top 10 interest categories with the highest composition values followed by the bottom 10 interest categories with the lowest composition values, providing a clear comparison based on their peak performance over time. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Current sql:
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        im."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (
            PARTITION BY im."interest_id"
            ORDER BY im."composition" DESC, im."month_year" DESC
        ) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" DESC, "interest_id") AS desc_rank,
        ROW_NUMBER() OVER (ORDER BY "Composition_Value" ASC, "interest_id") AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC, "interest_id";For tasks asking fullname or name, you may combine first name and last name into one column called name.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-19 14:36:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 14:36:33 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        im."interest_id",
        imap."interest_name" AS "Interest_Name",
        im."month_year" AS "Time(MM-YYYY)",
        ROUND(im."composition", 4) AS "Composition_Value",
        ROW_NUMBER() OVER (
            PARTITION BY im."interest_id"
            ORDER BY im."composition" DESC NULLS LAST, im."month_year" DESC
        ) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP imap
            ON im."interest_id" = imap."id"
    WHERE
        im."composition" IS NOT NULL
)
SELECT
    "Time(MM-YYYY)",
    "Interest_Name",
    "Composition_Value"
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (
            ORDER BY "Composition_Value" DESC NULLS LAST, "interest_id"
        ) AS desc_rank,
        ROW_NUMBER() OVER (
            ORDER BY "Composition_Value" ASC NULLS LAST, "interest_id"
        ) AS asc_rank
    FROM
        max_compositions
    WHERE
        rn = 1
) ranked
WHERE
    desc_rank <= 10 OR asc_rank <= 10
ORDER BY
    "Composition_Value" DESC NULLS LAST, "interest_id";
```
2025-01-19 14:36:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 14:36:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 14:36:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 14:36:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 14:36:34 - snowflake.connector.connection - INFO - closed
2025-01-19 14:36:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 14:36:35 - root - INFO - itercount: 2
2025-01-19 14:36:35 - root - INFO - 0
2025-01-19 14:36:35 - root - INFO - Total iteration counts: 2
