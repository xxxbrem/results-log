2025-01-19 03:41:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:42:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:42:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-19 03:42:45 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:45 - root - INFO - SQL:
-- 1. List distinct years present in the sales data
SELECT DISTINCT EXTRACT(YEAR FROM "date") AS "year"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Results:
year
2017
2024
2016
2019
2013
2018
2014
2021
2020
2012
2022
2015
2023

2025-01-19 03:42:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:42:46 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:47 - root - INFO - SQL:
-- 2. Retrieve a sample of item numbers and their descriptions
SELECT DISTINCT "item_number", "item_description"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Results:
Too long, hard cut:
item_number,item_description
31718,PHILLIPS GIN
56874,BACARDI HURRICANE RTS
9432,PASSPORT SCOTCH
38847,TRULY PINEAPPLE MANGO
36908,MCCORMICK VODKA PET
101233,PATRON SILVER TEQUILA LIMITED EDITION
34001,ABSOLUT SWEDISH VODKA 80 PRF MINI
35947,FLEISCHMANNS 80PRF VODKA
39918,NEW AMSTERDAM APPLE
68039,BAILEY'S ORIGINAL IRISH CREAM
59037,DESERT ISLAND LONG ISLAND ICED TEA COCKTAIL
22244,YELLOWSTONE SELECT
24156,HAWKEYE BLENDED WHISKEY
26432,BIRD DOG PEANUT BUTTER
86112,DEKUYPER TRIPLE SEC
17085,BULLEIT BOURBON
101239,WHISTLEPIG RYE PIGLETS MINI
36901,MCCORMICK 80PRF VODKA MINI
86668,JACK DANIELS TENNESSEE HONEY MINI
101462,YUKON JACK ASSORTED MINIS
25603,SEAGRAMS 7 CROWN BL WHISKEY
32233,SEAGRAMS EXTRA DRY GIN
43123,BACARDI SUPERIOR
901116,LATTE MACHIATTO
42714,MALIBU COCONUT
73253,DAMSO BLUEBERRY SOJU
102057,FIREBALL FALL TAILGATE BAG
14495,REVEL STOKE ROOT BEER MINI
84187,99 CINNAMON
100448,1800 SILVER W/FLASK
101457,ARDBEG SCORCH GIFT BOX
17050,BROTHERS BOND STRAIGHT BOURBON WHISKEY
17092,BULLEIT BOURBON BARREL STRENGTH
43134,BACARDI LIMON
21538,STAGG BOURBON
63345,ON THE ROCKS COCKTAILS TRES GEN JALAPENO PINEAPPLE MARGARITA
238,FORBIDDEN SECRET COFFEE PACK
100433,SUNTORY TOKI W/HIGHBALL GLASS
26293,REVELTON SHINE WHITE WHISKEY
26986,IOWA LEGENDARY RYE PRIVATE RESERVE
65896,METAXA OUZO
67556,KAMORA COFFEE LIQUEUR
67296,YUKON JACK PERMA FROST SCHNAPPS DISCO
86771,OLE SMOKY WHITE LIGHTNIN
89242,CORRALEJO REPOSADO TEQUILA
89916,TORTILLA GOLD
10553,BLACK VELVET CINNAMON RUSH DISCO
36258,DEHNER DISTILLERY VODKA
37526,PRAIRIE ORGANIC VODKA
41077,JEREMIAH WEED SWEET TEA
41604,UV GRAPE VODKA
35916,FIVE O'CLOCK VODKA
28893,BOMBAY BRAMBLE
33966,ABSOLUT ORIENT APPLE
40678,PUCKER VODKA LEMONADE LUST
76239,MOSHINE PEACH MINI
57585,BEAGANS CRANBERRY VODKA
18424,REMUS HIGHEST RYE
85835,TEQUILA PADRE AZUL ANEJO MINI
100236,ZING 72 GIN W/COPPER CUP
25251,WHISKEYSMITH BLOOD ORANGE FLAVORED WHISKEY
101028,RUMHAVEN W/TIKI MUG
102035,DOS HOMBRES MEZCAL + FEVER TREE PINK GRAPEFRUIT SODA VAP
20368,OLD FORESTER BOURBON 86PRF
42009,UV CAKE VODKA
59159,1800 ULTIMATE RASPBERRY
62616,ZIYAD WATERMELON DRIP
87725,GRAN CORAMINO REPOSADO CRISTALINO
994771,DIPLOMATICO RESERVA EXCLUSIVA
3310,JAGERMEISTER W/FLASK
34198,CIROC SUPER PREMIUM VODKA
33110,INDOGGO STRAWBERRY GIN
903892,LINIE AQUAVIT
62811,ON THE ROCKS KNOB CREEK OLD FASHIONED
101452,DEWARS DISCOVERY PACK W/2 MINIS
127,DEEP EDDY LEMON W/2 TIN CUPS
25866,STONE BREAKER
63131,ON THE ROCKS COCKTAILS CRUZAN DAIQUIRI
3916,ABSOLUT MINI BAR
58210,CRAFTHOUSE COCKTAILS PINEAPPLE DAIQUIRI
28147,MERICA SMALL BATCH BOURBON
37690,CM KNEE HIGH DISTILLING VODKA
42666,MT GAY ECLIPSE RUM
942481,DICTADOR RUM 12YR
1500,JAMESON IRISH WHISKEY TIN
59205,1800 PASSION FRUIT ULTIMATE MARGARITA
101018,GLENLIVET TRIAL PACK MINIS
68559,KERRYGOLD IRISH CREAM LIQUEUR
87027,ADICTIVO REPOSADO TEQUILA
918417,HA REMUS REPEAL RESERVE BOURBON II
39707,WESTERN SON WATERMELON VODKA
4084,ABERLOUR 12 YEAR SINGLE MALT SCOTCH
51328,MARASKA SLIVOVITZ 10YR
56804,PAUL MASSON RED BERRY GRANDE AMBER BRANDY
21671,BP TOWN BRANCH SINGLE BARREL RESERVE BOURBON
27715,BP KOVAL SINGLE BARREL BOURBON WHISKEY
901203,YAHARA BAY LAVENDAR LIQUEUR
68842,ST. BRENDAN'S SUPERIOR IRISH CREAM LIQUEUR
77497,TORTILLA SILVER DSS
89535,FAMILIA CAMARENA REPOSADO
983927,MAUI TROPICAL SCHNAPPS
101428,SMIRNOFF W/50ML PINK LEMONADE
5014,GLENFIDDICH 15 YR SOLERA RESERVA
977250,MARK ROGERS PEACH MOONSHINE MINI
65260,JAGERMEISTER COOLPACK DISCO
88543,SAUZA CIEN ANOS PLATA
28078,OXLEY LONDON DRY GIN
100306,PATR�N EXTRA A�EJO
77050,FIELD FIRE
87990,LOS SIETE MISTERIOS DOBA YEJ
901112,LATTE MACHIATTO
28485,FORDS GIN
17958,EVAN WILLIAMS BLACK
43388,CASTILLO SILVER RUM
64866,FIREBALL CINNAMON WHISKEY
58838,JOSE CUERVO AUTHENTIC LIME MARGARITA
76488,PARAMOUNT AMARETTO
28867,TANQUERAY GIN
54647,ARROW BLACKBERRY FLAV BRANDY
27175,TEMPLETON 4YR RYE
43285,CAPTAIN MORGAN ORIGINAL SPICED RUM PET
42717,MALIBU COCONUT
64753,CHUM CHURUM ORIGINAL SOJU
55087,PARAMOUNT BLACKBERRY BRANDY
100938,FIREBALL VALENTINE PACK
39301,REVELTON HONEY VODKA MINI
65929,MALIBU PEACH MINI
69940,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR MINI
72977,NORTH FOREST KREME HUCKLEBERRY VANILLA MINI
88291,PATRON SILVER MINI
38174,TITOS HANDMADE VODKA
45274,PARAMOUNT WHITE RUM
101988,FIREBALL SUMMER BAG
33670,GREY GOOSE LE MELON MINI
33866,KUHL MANGO LEMONADE MINI
22288,WOODFORD RESERVE BATCH PROOF
16466,1792 BOTTLE IN BOND BOURBON
19235,KNOB CREEK SINGLE BARREL RESERVE
26104,HIGH WEST LIMITED SUPPLY HIGH COUNTRY AMERICAN SINGLE MALT
101471,99 HOLIDAY ORNAMENT MINIS
19239,KNOB CREEK 12YR
100636,JIM BEAM MINI 12 SEASONS
101293,JIM BEAM WHITE W/ HOLIDAY TUMBLER
13542,LEGACY CANADIAN WHISKY
27126,RUSSELLS RESERVE RYE 6YR
17260,RANCH ROAD STRAIGHT BOURBON WHISKEY
100855,MAKER''S MARK GENERATIONS TRI-PACK
89635,OLMECA REPOSADO
42177,BLUE CHAIR BAY BANANA RUM MINI
19065,BP JEFFERSONS OCEAN WHEATED BOURBON BARREL
28600,GLENDALOUGH ROSE GIN
35179,PEARL BLUEBERRY
37394,CM JUST ANOTHER VODKA - BLACK
41320,BURNETTS W

2025-01-19 03:42:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:42:48 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:49 - root - INFO - SQL:
-- 3. Calculate total sales revenue per item in 2023
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
LIMIT 1000
Results:
Too long, hard cut:
item_number,total_sales_2023
43127,1015896.75
100865,28496.64
12404,61167.86
16416,86305.5
24466,33137.88999999999
34036,136738.78
39466,28636.5
5555,274229.96
56206,24241.67
58866,14358.96
76413,305097.0
77698,47539.200000000004
12858,30750.0
39424,25072.369999999995
58838,809004.9900000001
77487,1092768.6
82147,44151.64000000001
37784,3699.0
67534,17942.410000000003
44175,6831.0
903203,13893.75
30528,43833.47
34566,13009.5
82610,39728.840000000004
45217,75608.49999999999
78292,29314.150000000012
80308,1297.1999999999996
38089,25723.479999999992
21256,20587.5
39026,1530.0
900606,9180.0
88267,38898.75
89644,141244.5
89519,33642.0
42166,13277.25
73253,6411.999999999999
100737,42075.740000000005
4246,23938.569999999992
76850,10576.620000000003
940082,5292.0
15622,58092.75
35356,15322.0
80451,1467.0
88356,23365.5
965815,3932.9399999999996
902256,14242.5
21211,37050.0
85981,6637.5
19461,24300.0
26665,24555.75
87178,4893.75
39622,13758.779999999995
46599,916.5
20300,50850.0
49069,8770.319999999996
101967,1349.4
38074,5966.700000000002
916092,2433.2
28526,6519.24
922370,742.5
100891,607.5
943618,1079.28
975028,5551.200000000001
930746,164553.69000000003
25519,615.2200000000001
994524,6719.76
915917,1642.5
938480,16002.0
906317,1674.0
997094,870.24
940083,1134.0
937023,828.0
928370,1350.0
73662,1168.0900000000001
926045,1209.6
984373,4050.0
926812,720.0
984128,325.44
943298,324.0
980086,155.88
24735,462.21000000000004
37189,270.0
985550,2997.0
100862,309.6
973343,125.88
928621,396.0
995276,351.0
944230,787.5
55068,32575.5
68036,1344223.1600000004
36304,953160.0
11786,665417.3000000002
34422,974358.0
89207,149760.0
10006,19998.159999999996
15940,260700.75
21206,90371.25
26586,307704.99999999994
28086,119849.38000000005
31656,33031.209999999985
34014,93627.53999999998
35316,45803.12
36989,132215.27999999997
4866,194258.25
5006,214593.75
65926,61649.29999999999
86250,12966.480000000005
88556,177329.25
37259,86950.5
46506,164345.26000000004
57122,11778.0
88118,22520.25
36970,200222.0
101512,16795.799999999996
81124,202470.66000000006
24451,14336.999999999996
43134,18643.5
42714,87245.12
987003,9702.0
4936,38156.65999999999
21687,41475.0
26974,11134.529999999993
49510,20962.5
27544,523330.5
77683,301552.04
46142,58498.15000000001
15627,3038113.8
28233,358899.75
52199,84637.5
74804,39347.25
16906,152010.0
27145,78661.66999999998
41316,24441.75
85425,57916.240000000005
987360,33048.72
88996,11700.0
928616,625.3199999999999
22026,26208.0
67309,14332.5
80058,14274.0
56664,7782.579999999997
26189,25878.840000000007
100803,8709.119999999995
922371,900.0
26105,2719.5
87636,3319.3400000000006
987281,1417.5
39532,1729.9099999999999
947946,4164.48
942462,1341.8999999999999
976751,630.0
941938,1070.1599999999999
38530,245.1
904696,1958.3999999999999
973420,282.12
962475,23224.32
85828,419.04
984195,675.0
952186,756.0
902192,607.5
975390,828.0
927425,724.5
921219,33525.0
964478,495.18
989961,1050.24
922374,28080.0
996267,2955.12
911468,810.0
965282,382.56
77889,235.22000000000003
972729,522.72
985986,57.12
15582,143350.18
16580,127200.0
21215,207867.0
22121,82517.25
34702,33673.6
40192,44250.0
49084,389527.17000000004
52314,54704.8
54706,17759.25
56195,68373.48000000003
64121,32514.0
68126,105920.25
75268,38808.0
88036,169446.37
88766,27962.010000000013
32233,92277.38
86487,12704.000000000002
89387,996215.2599999997
15621,95866.65000000001
32231,48851.55000000002
39250,12854.700000000003
43022,69083.13
65204,70098.29999999999
80398,227477.25000000003
86828,48200.23
64510,24532.5
15320,62100.0
19468,9676.799999999997
21986,14463.75
37416,15690.0
87849,82134.0
928193,12582.0
965185,5617.5
37937,18900.96
26150,55566.04
13036,11891.790000000003
5103,46070.07999999999
63505,35402.25
19021,57581.25000000001
24862,4095.0
72330,34398.0
19323,30577.5
75264,33795.0
77324,11385.0
66993,102007.5
84166,32152.5
27523,27060.0
43073,24108.75
101674,6727.5
27615,17415.0
37782,1914.0
906565,2358.75
26714,2894.460000000001
88102,11412.0
43895,8652.0
928821,504.0
87270,15156.959999999997
73074,574.89
904161,2256.48
80573,9.75
37275,1333.28
951421,2052.0
978243,1152.0
980548,115.2
965076,162.0
902613,647.64
965986,2520.0
905316,3149.58
39704,221.82
33569,603.0
4532,1124.85
984135,128.64
986175,1215.0
985783,643.5
972101,234.0
986471,233.46
928691,210.0
946408,235.56
916269,792.0
944202,1710.0
985348,384.06
916334,423.0
25608,1371486.6
57210,75885.0
88355,128536.98000000001
10836,157683.53
16516,41792.52
22215,1466267.25
39917,29034.0
43126,567726.84
43747,48972.779999999984
48247,279083.20000000007
41688,36562.5
58876,11026.35
72928,151965.37000000005
965269,15800.399999999998
48099,1104352.4799999993
34029,425375.8600000001
85437,50523.75
5753,37080.0
84230,18034.199999999997
69604,5790.0
47861,193279.51999999996
16307,78030.0
22376,10263.75
27197,17432.58000000001
5596,23190.0
32462,24063.0
39186,2923.1
64854,37405.5
26844,31308.75
40071,55560.0
4367,84510.0
915654,4318.26
67174,1500.0
965072,1026.24
43797,68931.0
75181,84524.0
86692,359124.15000000

2025-01-19 03:42:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:42:50 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:51 - root - INFO - SQL:
-- 4. Calculate total sales revenue per item in 2022
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "item_number"
LIMIT 1000
Results:
Too long, hard cut:
item_number,total_sales_2022
43338,2602557.0
64866,1973484.0
8828,285727.9799999999
58908,17291.4
86390,84291.20000000001
37888,204000.0
11294,962722.5199999998
33256,33651.149999999994
34052,115123.2
36976,57039.47
37233,105964.5
40656,25600.15000000001
43244,218758.62999999998
43501,81062.52000000002
55106,24418.8
64348,81666.74
64776,734955.4400000001
78071,73871.45999999999
76843,53291.25
82606,81810.26000000001
82780,48304.149999999994
26851,9384.460000000003
36874,353424.04
69709,11910.0
80371,49014.29
19062,57395.1
41703,18416.100000000002
5842,93207.93000000001
26737,15841.250000000002
65556,9195.839999999998
86139,57755.88000000002
88947,6265.0
43728,5370.0
34747,64212.79999999999
18116,54034.5
68611,34376.42
80096,30976.280000000002
73054,118725.0
8827,56033.64
17087,226316.80000000005
55084,23318.749999999993
24453,17558.75
64356,20567.22
63124,17208.75
59288,714.0
88120,9157.5
903892,14287.5
19905,8767.5
27012,1957.5
922046,6412.5
101276,15319.209999999995
990305,792.0
101766,10350.0
926508,2430.0
978294,5187.0
916715,2076.3
977443,11182.5
915860,2698.38
32464,4290.0
72526,850.5
14524,371.48
25388,6240.0
922187,270.0
35109,4259.150000000001
64266,832.26
915920,2835.0
999936,17712.0
80700,2432.859999999999
987296,756.0
921916,270.0
32819,1665.0
951854,792.0
100216,256.31
905195,1416.48
4358,2925.72
985535,810.51
59173,1468.5
903998,283.5
978242,288.0
919000,9020.88
988280,1007.76
988831,269.1
925169,302.4
988912,564.0
901365,151.56
985685,5400.0
976548,153.0
928312,345.12
976367,180.0
994722,135.0
951550,56.25
100862,29876.400000000005
72979,1136.25
78292,62551.80000000002
80451,4680.0
16416,93676.5
20300,66881.25
4246,34159.22
5555,192177.20000000004
56206,28982.25
76413,203859.75
43127,1000179.0
82147,40005.0
100737,17063.239999999998
88356,10739.25
58838,880270.9499999995
77698,52689.28000000001
12404,50028.76
89519,27426.0
89644,97563.0
903203,23152.5
15622,15819.590000000004
34566,20325.0
24466,29102.129999999997
30528,52012.079999999994
45217,50881.600000000006
965815,5120.61
77487,860255.7600000001
930746,113883.83999999998
49069,48124.319999999985
12858,31706.25
38089,27228.799999999992
26665,31811.460000000003
67534,21622.15
58866,16257.78
82610,54089.8
39466,27603.75
928370,1124.82
34036,132526.58999999997
900606,10125.0
25519,2962.7700000000013
39622,11014.919999999998
73533,18859.780000000002
902256,13891.5
39026,1890.0
73662,2678.06
21211,17385.0
997094,1305.3600000000001
35356,2983.01
664,42.75
916092,3754.08
24735,1584.7199999999998
86562,855.0
904781,830.25
922370,247.5
43409,5714.25
46599,1611.0
940082,3732.0
995276,1053.0
100891,2077.5
87178,5175.0
921554,1845.84
938480,12096.0
951698,136.56
940083,1242.0
89590,769.5
943684,1524.24
905734,336.78
915917,985.5
76850,1210.26
984373,307.5
937023,1242.0
926045,1209.6
926812,1192.2
905186,271.38
26463,33.75
943618,539.64
943298,162.0
903620,115.56
88298,185503.5
36878,55406.40000000001
35626,102716.25
45275,63756.0
45886,267915.0
80419,2666.25
80423,6997.5
37993,148159.47
13928,17671.5
30058,74971.5
77318,75619.5
34007,957106.9299999999
926248,3341.5199999999995
933938,675.0
39320,17842.779999999995
76069,25894.439999999988
71529,16884.0
33110,34762.5
43641,37886.25
43735,59192.64000000001
78231,13701.870000000003
88818,5832.0
89233,36135.54000000001
10624,21444.75
26063,14422.5
43296,44577.0
66994,25042.5
39763,3469.2199999999993
27380,248835.62999999995
68080,29526.0
32460,23685.0
38494,20211.75
101473,6579.000000000001
80443,519.75
88984,18321.53999999999
29997,22882.680000000004
87647,230635.5
65126,353898.0
88285,52266.51000000002
19475,84154.0
922273,2925.0
27171,31800.0
39322,72088.5
15539,19287.25
87266,33201.00000000001
101292,16372.5
16514,3585.4499999999994
80445,4312.5
938030,456.0
88015,10126.5
42204,16212.199999999993
87579,16350.0
903124,3700.6400000000003
63261,8322.569999999998
49509,16686.0
958875,3434.4
100759,6264.0
26447,2490.0
14530,489.9
76844,3240.0
52559,4491.66
57630,5169.5999999999985
101773,5557.5
73069,420.0
968888,1079.28
26231,509.6
904611,855.0
902533,135.0
40186,1046.25
985683,2700.0
6032,444.4
904522,3780.0
903563,135.0
965112,171.48
964424,285.12
964558,1344.48
23828,544537.0199999999
49188,65768.97
56856,35406.8
57158,31151.25
57174,114055.5
58913,107239.80000000003
59192,40405.98
63959,10510.079999999996
19067,961233.0
64867,1857777.2100000007
77632,124344.72
40313,20788.5
918010,75348.0
48105,2196215.5599999996
14516,14186.400000000005
26814,64980.0
27461,8416.289999999997
77852,92788.09999999998
86885,155294.5
918380,18481.319999999996
48102,197864.1
16075,17066.25
74836,13912.5
6214,2730.0
89824,38130.0
85987,1746.0
26205,22230.16999999999
25113,36300.0
45887,70626.98999999999
100413,1198384.2
34839,9264.0
89836,364340.25
76505,73711.5
88548,474398.25
67158,26965.379999999997
63259,3557.2500000000005
34605,13072.5
89339,80340.0
62120,13351.5
76373,12383.999999999998
64913,23804.199999999997
994529,11020.099999999997
39611,11874.719999999998
57632,5169.5999999999985
26611,22068.959999999995
39299

2025-01-19 03:42:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-19 03:42:52 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:53 - root - INFO - SQL:
-- 5. Find the top 10 items by total sales revenue in 2023
SELECT "item_number", SUM("sale_dollars") AS "total_sales"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
ORDER BY "total_sales" DESC
LIMIT 10
Results:
item_number,total_sales
38178,11393245.5
38177,10001010.239999996
11788,8560030.739999996
1799,7061536.239999999
38176,6565380.0
88296,5252856.0
43337,5014554.569999999
65013,4394133.45
10807,3787875.1999999993
10802,3705297.9199999995

2025-01-19 03:42:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:42:54 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:54 - root - INFO - SQL:
-- 6. Calculate total bottles sold per item in 2023
SELECT "item_number", SUM("bottles_sold") AS "total_bottles_sold_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
LIMIT 1000
Results:
Too long, hard cut:
item_number,total_bottles_sold_2023
78292,2615
80308,184
38089,17826
21256,610
39026,51
5555,4418
76413,15646
900606,72
43127,71291
88267,2255
89644,5539
34036,9122
39466,2246
77698,3840
89519,1074
58838,61709
12404,18097
42166,843
44175,396
73253,1400
34566,826
100737,1123
16416,4262
4246,593
15622,8775
82147,5603
35356,1064
12858,1640
30528,3769
56206,2809
20300,904
88356,842
39424,1125
902256,1055
67534,809
21211,1300
76850,402
940082,252
24466,4007
85981,354
39622,697
58866,2072
82610,3364
26665,1129
45217,12815
77487,148676
903203,1235
100865,1086
80451,163
19461,360
101967,60
975028,240
49069,78
28526,199
943618,72
46599,58
87178,87
922370,18
965815,202
38074,885
100891,18
37784,274
916092,70
928370,72
25519,38
938480,1524
24735,21
984128,96
100862,4
928621,8
73662,41
930746,8331
915917,30
995276,6
940083,54
984373,540
926812,24
926045,24
997094,24
937023,24
994524,24
906317,18
985550,300
980086,12
943298,12
37189,6
944230,6
973343,12
15621,5630
19021,4625
32231,9869
39250,1863
43022,8137
65204,9942
80398,17325
86828,3671
64510,3271
40192,7375
56195,14156
15320,276
16580,2827
19468,630
21215,12598
21986,707
22121,4429
24862,65
37416,2092
52314,11210
88766,2799
928193,233
965185,214
87849,2018
37937,2704
32233,30862
15582,9464
19323,302
26150,2246
34702,3095
88036,14895
84166,2858
13036,1861
68126,7433
5103,992
63505,3631
89387,79492
26714,57
75268,1848
49084,17101
72330,1764
75264,2253
77324,690
66993,3886
27523,451
27615,1290
64121,1145
54706,2631
43073,2041
86487,3970
37782,116
906565,17
43895,206
87270,340
101674,299
928821,12
88102,634
73074,7
904161,48
916269,12
37275,968
984135,96
944202,12
39704,31
951421,36
916334,6
33569,30
985348,6
965986,84
80573,5
4532,15
978243,96
965076,6
905316,42
980548,6
902613,36
928691,6
946408,6
985783,6
986471,6
986175,18
972101,12
26172,2659
53211,5356
87054,648
36968,64656
49185,26336
87402,41560
16096,11061
4111,247
6076,766
89139,2219
920374,1805
87194,1693
922188,24
73558,757
35418,9469
72505,1391
4867,6747
11346,13696
88511,249
910882,617
37356,18663
15852,165
80236,7867
89665,578
40191,5044
28481,893
83370,2909
89230,2017
965266,3438
66522,2733
87646,4612
8825,2134
16281,144
75604,173
20248,18511
38091,1213
35948,40896
64149,3660
974829,312
67610,2306
88458,392
34154,739
21296,255
62816,374
964531,30
85550,434
936859,71784
14467,437
57631,183
101950,238
902667,6
73000,48
15895,558
905829,36
15465,260
84373,279
63563,134
21798,359
987155,6
25251,44
937053,1158
42201,58
915804,30
922378,6
101706,50
928002,36
37167,35
928650,48
916619,6
922290,1560
944177,18
38563,6
937792,12
926233,24
943681,36
915996,12
930710,6
934886,12
992136,1
984194,24
943705,6
44160,3
915495,6
36308,208363
28275,13005
86668,11104
86883,11005
47869,81
5136,349
5446,3076
68100,1875
88931,179
42717,106977
45277,26237
53214,94700
65963,137
10008,10312
102040,1315
86019,21514
16850,15564
39922,6766
80545,1138
87225,283
67551,50
80358,683
927516,120
78113,1120
62787,280
994851,12
38046,2887
38225,1496
87410,8200
18358,816
31658,14686
904759,1158
102092,15535
73588,1205
87369,1219
100605,60
51156,1040
44340,9929
89887,7984
28795,1695
36531,1146
21208,625
6107,938
89445,4272
85788,464
951745,30
34436,28
89535,1105
943791,2
67044,80
901271,30
995915,72
903764,21
73896,34
997100,114
977237,2
902833,18
59283,282
66262,85
44184,91
918852,24
966872,6
86830,62
941843,48
916664,201
951594,12
985693,120
72978,29
994449,6
16237,7
902840,42
964530,6
942404,36
926337,120
916071,30
921213,12
985369,9
965424,12
915194,156
911216,18
928270,282
906332,6
928653,12
903995,12
987904,12
87579,730
101473,186
39320,1634
76069,741
37993,35622
88285,10188
71529,1680
38790,671
17207,5629
19475,5782
26231,10
27380,3646
35626,9463
43735,1561
65126,11251
78231,595
88984,122
89233,1072
10624,2658
33110,1319
39322,6585
45886,15292
34007,37305
39763,63
10778,12365
30058,8125
32460,1022
43641,814
66994,1711
13928,1134
68080,823
26063,49
27171,1342
87266,550
45275,9385
77318,4194
36878,4915
38494,1240
42204,1158
88298,2318
87647,14249
903124,553
29997,3210
52559,374
101292,38
15539,425
80423,446
976559,84
926248,354
958875,30
63261,29
33696,132
938030,42
80419,307
995568,12
88818,167
999921,42
38782,282
57630,1
965112,30
985906,12
88015,25
80445,21
904611,48
964558,12
904522,24
916001,12
73069,1
918617,6
901636,12
973339,12
964424,12
76500,1380
10788,5412
33466,3426
46550,1797
34423,21866
47865,9005
50686,4813
72382,423
73986,16209
77740,16297
77858,12395
79966,1333
80365,12752
917527,1945
922042,246
34030,18474
17915,2722
17106,107
26855,250
36769,3965
80362,8601
28868,16737
81207,11363
48164,3620
73762,2213
101247,30
26474,4082
21464,3809
39648,734
86673,2638
59646,528
26010,855
88172,443
22156,19550
985347,39
87050,5823
80488,2847
48107,18705
14208,1873
12860,6798
46146,3174
33665,1099
88361,162
80458,12162
77994,3145
44217,29360
59101,871
911475,120
100954,2225
26625,86
87872,429
21228,23
26185,343
85643,339
85826,22
28033,59
905274,30
915257,592
17210,370
39174,201
14845,114
988839,6
76563,120
903560,48
905613,78
985290

2025-01-19 03:42:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:42:56 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:56 - root - INFO - SQL:
-- 7. Calculate total bottles sold per item in 2022
SELECT "item_number", SUM("bottles_sold") AS "total_bottles_sold_2022"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "item_number"
LIMIT 1000
Results:
Too long, hard cut:
item_number,total_bottles_sold_2022
30528,4806
58838,67145
43127,70188
45217,8624
77487,118167
34036,8841
100862,386
72979,101
78292,5580
12404,15647
16416,4626
20300,1189
49069,428
56206,3513
76413,10581
15622,2641
24735,72
5555,3376
902256,1029
24466,3519
39622,558
77698,4256
82147,5334
89519,952
21211,610
34566,1355
38089,20320
82610,4580
80451,520
67534,1085
39466,2165
89644,3826
12858,1691
4246,928
35356,199
26665,1542
73533,1178
903203,2058
73662,94
100737,474
997094,36
900606,90
25519,183
88356,387
58866,2346
664,3
916092,108
965815,263
39026,63
922370,6
43409,401
86562,19
930746,6048
928370,60
904781,123
995276,18
46599,86
100891,64
940082,174
915917,18
76850,46
87178,92
938480,1152
984373,41
921554,24
926812,30
940083,48
89590,18
951698,6
905734,6
943684,24
926045,24
937023,36
903620,12
943618,36
943298,6
905186,6
26463,1
35918,79522
28081,2094
49189,53152
18613,736
26710,4811
39866,4441
67905,1187
86559,5615
88186,22863
43026,47662
74688,304
12467,1599
41705,7835
33663,6725
71886,3016
80363,10116
66259,180
77774,4411
4044,1104
77367,2177
10789,6570
10625,2875
5362,1159
63355,3122
74807,838
26573,366
101183,288
101347,1457
902291,668
558,1539
15739,2298
4616,1706
86916,6127
68846,4644
911010,6
15945,481
903037,980
101600,5601
72395,978
72983,73
951744,60
12886,337
962476,14688
87112,617
64279,60
921806,9
25153,93
5744,90
916445,1092
29772,31
65745,49
68207,114
4949,39
985777,3
943634,24
977230,48
926425,444
902729,30
987841,20
27877,71
76432,48
928466,18
977235,42
43894,3
968848,48
978104,42
995232,12
966580,24
972415,12
967037,5
19471,1604
26164,1407
38575,3987
43121,18934
75218,5265
19063,16823
63319,12446
69722,148
43860,3792
6206,999
75197,3003
82626,4665
926618,45
100939,614
84219,62415
19226,18050
64409,320
38178,374035
43120,30062
57157,5999
11347,3055
22157,9825
22786,5954
34821,62457
101306,594
20368,1203
26496,505
918530,57
83357,1844
101763,343
80686,3066
80130,2083
59185,2161
30236,4483
40500,12278
6997,1498
19028,1674
87481,1146
80826,3601
58886,10923
30057,4585
62811,193
101545,251
26787,169
62610,67
86606,437
26125,498
63372,70
915673,152
26217,248
80422,6
17186,334
87722,233
902086,126
86560,196
928648,394
964304,18
3354,10
944088,12
965073,54
904556,24
951549,18
964464,36
14531,110
942305,18
989320,3
910933,12
943878,48
986771,18
946302,564
949984,60
975940,12
943683,12
910855,12
902046,12
100815,2289
101710,508
75212,13030
76412,6557
88728,410
54647,6112
17956,40093
32235,4932
35416,11012
65066,7196
72732,2666
77231,1586
58840,3242
51326,1686
902029,579
58860,8563
17194,1059
19227,1584
9432,1177
68127,3224
19070,22948
19250,438
65453,46
900793,36
89199,41263
25166,307
73065,11940
15206,310
19017,3648
42167,1760
86604,710
86463,325
68584,997
78247,45
65750,4929
101100,143
101614,655
39412,164
926684,6522
87898,106
88123,484
85849,609
966390,24
919218,360
948361,30
87057,11
995513,24
911074,7
936749,360
904965,12
904682,36
907705,18
988830,48
985698,12
904517,12
964634,24
922897,6
36901,15423
39245,985
84143,6190
84207,15810
67522,1469
84102,2389
17086,44729
23536,728
25079,1282
36576,6184
39029,1605
65451,600
82820,6179
87172,124
916492,30
87025,570
919320,144
904844,546
28236,19756
65416,2585
73754,2341
903707,305
999931,12
38058,12405
34244,1870
18006,50406
64736,5636
34819,2275
21226,628
89136,175
72945,187
21836,502
29410,132
86582,1396
39352,1117
89177,16958
82636,6769
37934,9443
59037,15944
87513,1416
27188,451
77699,7809
927114,181
89504,338
88633,537
39282,2618
41209,3069
76409,1832
915635,24
902570,114
962093,6480
26758,623
39601,550
964076,96
26220,62
90039,175
943803,60
87684,149
25517,114
18997,87
985669,6
37968,267
995096,44
916701,15
972958,144
925016,18
37105,96
64559,43
928485,46
906532,7
905653,12
902497,60
906067,18
916018,18
972434,288
966770,72
915747,12
947033,12
3233,4
904859,6
917562,12
6024,16
987039,30
988352,6
26160,1316
27618,1089
64774,2892
86669,13848
21212,134
28866,26638
42566,2809
5318,2366
64136,21521
998917,75
34155,8397
36390,466
41670,4388
36668,2782
43848,4661
39255,1657
63345,5506
67266,5356
67296,1076
84159,2595
17766,7740
47649,239
51158,1084
86990,1442
34162,1385
904581,258
941467,960
35628,5411
58877,1905
57051,11062
101841,54
27016,4442
43025,27092
34164,5191
77647,4313
87043,13585
77055,13530
11940,3381
36305,129877
28617,2200
6075,174
36908,59903
966122,938
57129,9692
61215,179
33660,872
65457,508
17659,574
932650,1073
926093,1020
24856,51
37578,309
89235,999
87102,219
18672,280
53814,89
65456,54
904988,12
73149,10
987956,24
943382,12
965288,42
995735,24
943435,72
995516,6
951696,84
918217,234
943827,6
995774,12
926468,24
985933,300
39118,5
988253,6
101561,4
977331,6
34001,19532
24860,836
86544,1496
87509,12292
19066,82042
25616,9898
26096,1903
27125,9079
2849,308
28886,3122
37040,1100
87136,277
910839,228
39699,906
39825,7613
40053,25840
86018,6171
82600,1268
67037,470
82827,2640
87499,1054
5430,1449
100429,109
101770,2406
65144,4400
917510,204
36875,59641
15244,3111
2229,4817
47786,9247
89787,6524
965344,6576
987082,461
17929,190
84192

2025-01-19 03:42:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:42:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:42:58 - snowflake.connector.connection - INFO - closed
2025-01-19 03:42:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:42:58 - root - INFO - SQL:
-- 8. Identify items sold in 2023 but not in 2022
SELECT DISTINCT "item_number"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
AND "item_number" NOT IN (
  SELECT DISTINCT "item_number"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
)
LIMIT 1000
Results:
Too long, hard cut:
item_number
88530
27462
988206
101819
66524
84214
89584
57637
65627
25028
37144
932819
990742
917210
929820
939176
985726
926266
988207
985839
85643
911475
21228
14845
17106
910776
46550
80362
59646
39174
17210
985347
916218
972096
85826
901954
988839
905613
905274
917632
932474
985290
994806
76563
924923
951154
17020
84135
19325
102086
922263
906129
6164
73256
85490
84388
57633
16305
59550
917625
922208
66995
56948
975261
985532
928498
926581
926751
925026
928603
917337
941848
906260
64352
53853
102149
103106
989346
102069
922390
918011
926294
967605
984216
22488
22447
66932
76239
16275
4031
65527
22071
25121
995939
102228
901993
21068
966726
990043
978198
988990
986035
924921
937664
926150
904329
906100
994739
922430
985748
926931
974486
916347
980523
76704
26572
22460
804
16619
68625
102013
922261
76841
72434
949780
969596
903151
985996
901891
951591
988102
905874
966388
928271
916150
76830
68623
88641
27516
15934
85982
57324
86198
28607
987121
89488
906087
21672
994652
87991
931296
86175
972133
980445
944634
965423
989590
965428
987802
985419
966474
951070
989622
964620
998074
904854
916468
100948
21671
22496
76425
102031
976741
61706
925303
67612
18390
62788
102042
15451
102100
76238
918288
925019
964390
905779
951593
986061
965970
928538
923060
73559
22249
973539
21493
66833
76831
21064
59281
84277
904362
972543
966567
63089
101712
926614
33427
942851
988939
938771
976200
66959
37959
78187
21067
85536
101971
46688
22389
915449
903475
915807
87483
972752
905118
989234
947806
921640
932530
925473
22289
59534
28321
35464
86973
988453
88803
85711
73120
985534
21235
925934
31599
996274
76825
938645
989650
926478
916841
988703
985368
85388
100443
58972
19501
63213
37712
78186
85331
925182
22406
921244
26354
86020
922180
965483
972955
916337
985959
943728
931167
977199
922544
994256
976717
85451
101209
4476
18400
38813
951584
85712
987930
974840
965823
76712
77980
101942
976079
925567
915550
939123
928473
987059
973122
985370
905755
915500
999940
67032
25940
18424
101989
102096
23063
24861
22262
66097
990071
76755
62515
915855
76901
902813
14846
965964
986345
901822
945995
987833
987442
67607
89580
76220
85665
33430
78245
934498
88528
986623
19457
76466
985825
966123
990015
928822
905433
38792
902213
6281
17921
916221
10777
88524
902082
928441
85965
944106
926052
976831
937577
915604
37780
918286
929828
988076
906576
944232
998071
965367
916135
63851
918381
25999
19065
87039
80309
101988
85588
44195
86007
10856
71615
22375
6100
34238
15448
965957
985631
985853
987218
915505
922402
901885
965071
987136
967279
927324
80364
932652
102027
68620
76900
85545
101648
37781
87355
20165
25293
986782
973894
938770
926389
982656
941179
985756
38828
37857
25068
76262
64334
964543
915447
86471
924475
939442
66127
86423
22382
85943
988687
978112
905778
928539
29782
985487
905682
972706
984132
987156
925114
909265
919878
102061
14465
926804
25949
57575
10858
76829
42715
73891
59536
973721
976796
965516
989765
987406
904215
944072
910470
988077
942265
76261
69939
23539
28012
67676
985843
59049
988401
37692
24859
939721
984214
925215
915767
922493
902766
977055
932662
973917
986043
935677
59219
102057
37982
21242
65737
22513
24999
102012
28485
77332
976689
85901
986536
967617
925467
921024
924890
922471
69718
101527
51000
76753
985499
16260
985908
80129
966292
926055
928345
921452
927662
916029
985256
986450
937640
985517
942171
4457
89155
21462
974304
921865
945903
65533
2834
76679
19564
987793
984399
20494
27999
26970
4828
934598
967317
994496
987483
951589
906374
976702
972131
63834
25936
57343
101677
19000
10776
20304
80240
35676
68624
85346
985795
920118
980455
947325
916336
4797
916068
985987
987680
915896
987797
31538
990062
102077
38795
88543
25039
25059
67220
26975
916308
72706
972095
905974
66631
59285
951302
965090
905339
964131
944179
967207
987799
986161
951138
990225
995560
952324
17207
33696
10778
38790
38782
976559
999921
916001
995568
973339
918617
901636
985906
102037
78191
906564
28601
925013
62514
73199
37952
22069
17089
951601
976698
945320
986560
962040
925015
922450
910874
943991
49465
22279
17093
101943
984390
918568
101765
101521
88730
966019
85596
977989
89679
951065
14205
17107
988482
85742
951700
984140
915443
985349
905780
22376
57325
78212
16307
944635
48247
976742
57210
67085
42301
102025
67174
992167
923327
921022
987032
986050
986228
915420
996241
980546
968296
988007
101554
85683
88936
67420
85710
100490
999922
73254
948245
22419
966665
926217
942800
916238
987389
984394
916335
967269
977778
916199
987679
65963
85788
927516
68100
102092
951745
62787
44184
67044
73588
6107
87225
67551
73896
80358
102040
987904
941843
59283
943791
965424
911216
951594
906332
921213
966872
985693
915194
902833
928270
985369
926337
62041
68622
68024
980032
933181
915421
57327
995567
28539
972889
85329
38781
920487
913730
973079
63044
906367
995752
937747
102011
88514
80546
15789
102036
16466
985675
85482
918384
101768
76424
66726
67036
921259
987033
25242
59551
987312
965332
962138
984370
988091
951298
928422
980

2025-01-19 03:42:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:42:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:42:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 149
2025-01-19 03:43:00 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:00 - root - INFO - SQL:
-- 9. List distinct categories and their names
SELECT DISTINCT "category", "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Results:
category,category_name
1011800.0,IOWA DISTILLERY WHISKIES
1081300.0,AMERICAN CORDIALS & LIQUEURS
1012100.0,CANADIAN WHISKIES
1022100.0,TEQUILA
1081335.0,RASPBERRY SCHNAPPS
1051140.0,PEACH BRANDIES
1081000.0,AMERICAN CORDIALS & LIQUEURS
1091300.0,
1012300.0,IRISH WHISKIES
1062050.0,BARBADOS RUM
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1022300.0,
1082000.0,IMPORTED CORDIALS & LIQUEURS
1011200.0,STRAIGHT BOURBON WHISKIES
1032100.0,IMPORTED VODKAS
1081020.0,ANISETTE
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1011000.0,AMERICAN WHISKIES
1701200.0,HOLIDAY VAP
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1081600.0,WHISKEY LIQUEUR
1051100.0,APRICOT BRANDIES
1012400.0,JAPANESE WHISKY
1041100.0,AMERICAN DRY GINS
1051110.0,BLACKBERRY BRANDIES
1081380.0,MISCELLANEOUS SCHNAPPS
1081340.0,ROOT BEER SCHNAPPS
1081100.0,
1012300.0,SINGLE MALT SCOTCH
1062200.0,WHITE RUM
1052100.0,IMPORTED BRANDIES
1082200.0,IMPORTED SCHNAPPS
1041200.0,AMERICAN SLOE GINS
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1701100.0,DECANTERS & SPECIALTY PACKAGES
1091200.0,NEUTRAL GRAIN SPIRITS
1071000.0,COCKTAILS/RTD
1900000.0,DELISTED / SPECIAL ORDER ITEMS
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1031100.0,AMERICAN VODKAS
1081390.0,IMPORTED SCHNAPPS
101220.0,
1032100.0,
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1012400.0,IRISH WHISKIES
1082015.0,IMPORTED AMARETTO
1031080.0,VODKA 80 PROOF
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1011700.0,
1022300.0,MEZCAL
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1081250.0,WHITE CREME DE MENTHE
1081500.0,ROCK & RYE
1051010.0,AMERICAN GRAPE BRANDIES
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1031200.0,AMERICAN FLAVORED VODKA
1081220.0,DARK CREME DE CACAO
1070000.0,COCKTAILS/RTD
1011600.0,CORN WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1091400.0,IOWA DISTILLERIES
1062300.0,AGED DARK RUM
1081200.0,CREAM LIQUEURS
1070100.0,TEMPORARY & SPECIALTY PACKAGES
1062250.0,
1901200.0,SPECIAL ORDER ITEMS
1031110.0,LOW PROOF VODKA
1012000.0,IMPORTED WHISKIES
1071100.0,COCKTAILS/RTD
1081010.0,AMERICAN AMARETTO
1011500.0,BOTTLED IN BOND BOURBON
1052010.0,IMPORTED GRAPE BRANDIES
1089290.0,
1032080.0,IMPORTED VODKAS
1082010.0,AMARETTO - IMPORTED
1042000.0,IMPORTED GINS
1011700.0,CORN WHISKIES
1032200.0,IMPORTED VODKA - MISC
1011300.0,SINGLE BARREL BOURBON WHISKIES
1081015.0,IMPORTED AMARETTO
1081300.0,PEPPERMINT SCHNAPPS
1032230.0,IMPORTED VODKA - CHERRY
1012210.0,SINGLE MALT SCOTCH
1081312.0,BUTTERSCOTCH SCHNAPPS
1041150.0,FLAVORED GINS
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED
1081700.0,DISTILLED SPIRITS SPECIALTY
1081355.0,STRAWBERRY SCHNAPPS
1081400.0,AMERICAN SCHNAPPS
1081500.0,TRIPLE SEC
1062400.0,
1081210.0,CREME DE ALMOND
,
1081100.0,COFFEE LIQUEURS
1062100.0,JAMAICA RUM
1091200.0,
1011500.0,STRAIGHT RYE WHISKIES
1901000.0,SPECIAL ORDER ITEMS
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1051150.0,MISCELLANEOUS  BRANDIES
1062400.0,SPICED RUM
1051100.0,AMERICAN BRANDIES
1081365.0,TROPICAL FRUIT SCHNAPPS
1092100.0,
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES
1082200.0,
1031200.0,VODKA FLAVORED
1101100.0,AMERICAN ALCOHOL
1031000.0,AMERICAN VODKAS
1081370.0,WATERMELON SCHNAPPS
1090000.0,DISTILLED SPIRITS SPECIALTY
1081350.0,SPEARMINT SCHNAPPS
1052100.0,
1032000.0,IMPORTED VODKAS
1011400.0,BOTTLED IN BOND BOURBON
1091100.0,
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1082390.0,SCHNAPPS - IMPORTED
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM
1081317.0,GRAPE SCHNAPPS
1042100.0,IMPORTED DRY GINS
1062300.0,FLAVORED RUM
1082100.0,IMPORTED CORDIALS & LIQUEURS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1081240.0,GREEN CREME DE MENTHE
1022100.0,MIXTO TEQUILA
1062310.0,SPICED RUM
1062500.0,FLAVORED RUM
1901100.0,DELISTED ITEMS
1031100.0,100 PROOF VODKA
1062100.0,GOLD RUM
1082300.0,SCHNAPPS - IMPORTED

2025-01-19 03:43:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-19 03:43:01 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:02 - root - INFO - SQL:
-- 10. Calculate total sales revenue per category in 2023
SELECT "category", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "category"
LIMIT 1000
Results:
category,total_sales_2023
1082200.0,6119548.080000001
1701100.0,9509374.330000002
1011300.0,2276485.09
1091300.0,3688622.360000001
1011100.0,10723238.490000004
1092000.0,26889.339999999997
1011200.0,38677699.67
1081300.0,4354246.45
1032000.0,7874.62
1092100.0,2543429.1300000004
1012300.0,4367603.44
1032100.0,11963818.330000004
1031100.0,67338842.36999999
1081400.0,7306666.690000001
1062500.0,8309968.749999998
1011700.0,251152.56999999995
1031200.0,11816546.34
1041300.0,27100.260000000013
1091200.0,600076.2899999998
1062100.0,1039397.7799999999
1081600.0,26535647.129999995
1062400.0,23179414.500000004
1041100.0,3322886.720000001
1081200.0,8449040.209999999
1012200.0,5822671.240000002
1062200.0,5898568.830000001
1011400.0,16801219.220000003
1051100.0,4696783.27
1091100.0,2128590.9899999998
1042100.0,5366126.899999999
1071000.0,7888568.39
1081100.0,2199223.939999999
1901000.0,1355413.5500000003
1082100.0,12453635.24
1022100.0,11331074.050000008
1032200.0,4647635.529999999
1062300.0,1020934.2299999997
1081000.0,15682.740000000002
1082000.0,48065.44
1041200.0,984554.94
1011600.0,4652360.48
1081500.0,871320.69
1022300.0,528416.5499999999
1011500.0,1267438.1300000001
1012100.0,50361823.690000005
1052100.0,11192039.439999998
1022200.0,32323236.840000004
1012400.0,9779709.26

2025-01-19 03:43:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:43:03 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:04 - root - INFO - SQL:
-- 11. Retrieve a list of sale dates to examine date ranges
SELECT DISTINCT "date"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
ORDER BY "date" DESC
LIMIT 1000
Results:
Too long, hard cut:
date
2024-09-30
2024-09-29
2024-09-27
2024-09-26
2024-09-25
2024-09-24
2024-09-23
2024-09-22
2024-09-20
2024-09-19
2024-09-18
2024-09-17
2024-09-16
2024-09-15
2024-09-13
2024-09-12
2024-09-11
2024-09-10
2024-09-09
2024-09-08
2024-09-06
2024-09-05
2024-09-04
2024-09-03
2024-09-02
2024-08-30
2024-08-29
2024-08-28
2024-08-27
2024-08-26
2024-08-25
2024-08-23
2024-08-22
2024-08-21
2024-08-20
2024-08-19
2024-08-18
2024-08-16
2024-08-15
2024-08-14
2024-08-13
2024-08-12
2024-08-11
2024-08-09
2024-08-08
2024-08-07
2024-08-06
2024-08-05
2024-08-04
2024-08-02
2024-08-01
2024-07-31
2024-07-30
2024-07-29
2024-07-28
2024-07-26
2024-07-25
2024-07-24
2024-07-23
2024-07-22
2024-07-21
2024-07-20
2024-07-19
2024-07-18
2024-07-17
2024-07-16
2024-07-15
2024-07-14
2024-07-12
2024-07-11
2024-07-10
2024-07-09
2024-07-08
2024-07-07
2024-07-06
2024-07-05
2024-07-04
2024-07-03
2024-07-02
2024-07-01
2024-06-30
2024-06-29
2024-06-28
2024-06-27
2024-06-26
2024-06-25
2024-06-24
2024-06-23
2024-06-21
2024-06-20
2024-06-19
2024-06-18
2024-06-17
2024-06-16
2024-06-14
2024-06-13
2024-06-12
2024-06-11
2024-06-10
2024-06-09
2024-06-07
2024-06-06
2024-06-05
2024-06-04
2024-06-03
2024-06-02
2024-06-01
2024-05-31
2024-05-30
2024-05-29
2024-05-28
2024-05-27
2024-05-25
2024-05-24
2024-05-23
2024-05-22
2024-05-21
2024-05-20
2024-05-19
2024-05-17
2024-05-16
2024-05-15
2024-05-14
2024-05-13
2024-05-12
2024-05-11
2024-05-10
2024-05-09
2024-05-08
2024-05-07
2024-05-06
2024-05-03
2024-05-02
2024-05-01
2024-04-30
2024-04-29
2024-04-28
2024-04-26
2024-04-25
2024-04-24
2024-04-23
2024-04-22
2024-04-21
2024-04-19
2024-04-18
2024-04-17
2024-04-16
2024-04-15
2024-04-14
2024-04-12
2024-04-11
2024-04-10
2024-04-09
2024-04-08
2024-04-05
2024-04-04
2024-04-03
2024-04-02
2024-04-01
2024-03-29
2024-03-28
2024-03-27
2024-03-26
2024-03-25
2024-03-24
2024-03-22
2024-03-21
2024-03-20
2024-03-19
2024-03-18
2024-03-17
2024-03-15
2024-03-14
2024-03-13
2024-03-12
2024-03-11
2024-03-10
2024-03-08
2024-03-07
2024-03-06
2024-03-05
2024-03-04
2024-03-03
2024-03-01
2024-02-29
2024-02-28
2024-02-27
2024-02-26
2024-02-25
2024-02-23
2024-02-22
2024-02-21
2024-02-20
2024-02-19
2024-02-18
2024-02-16
2024-02-15
2024-02-14
2024-02-13
2024-02-12
2024-02-11
2024-02-09
2024-02-08
2024-02-07
2024-02-06
2024-02-05
2024-02-04
2024-02-02
2024-02-01
2024-01-31
2024-01-30
2024-01-29
2024-01-28
2024-01-26
2024-01-25
2024-01-24
2024-01-23
2024-01-22
2024-01-21
2024-01-19
2024-01-18
2024-01-17
2024-01-16
2024-01-15
2024-01-14
2024-01-12
2024-01-11
2024-01-10
2024-01-09
2024-01-08
2024-01-07
2024-01-05
2024-01-04
2024-01-03
2024-01-02
2024-01-01
2023-12-30
2023-12-29
2023-12-28
2023-12-27
2023-12-26
2023-12-22
2023-12-21
2023-12-20
2023-12-19
2023-12-18
2023-12-16
2023-12-15
2023-12-14
2023-12-13
2023-12-12
2023-12-11
2023-12-10
2023-12-09
2023-12-08
2023-12-07
2023-12-06
2023-12-05
2023-12-04
2023-12-03
2023-12-01
2023-11-30
2023-11-29
2023-11-28
2023-11-27
2023-11-26
2023-11-25
2023-11-24
2023-11-23
2023-11-22
2023-11-21
2023-11-20
2023-11-19
2023-11-18
2023-11-17
2023-11-16
2023-11-15
2023-11-14
2023-11-13
2023-11-12
2023-11-11
2023-11-10
2023-11-09
2023-11-08
2023-11-07
2023-11-06
2023-11-05
2023-11-03
2023-11-02
2023-11-01
2023-10-31
2023-10-30
2023-10-27
2023-10-26
2023-10-25
2023-10-24
2023-10-23
2023-10-22
2023-10-20
2023-10-19
2023-10-18
2023-10-17
2023-10-16
2023-10-15
2023-10-13
2023-10-12
2023-10-11
2023-10-10
2023-10-09
2023-10-06
2023-10-05
2023-10-04
2023-10-03
2023-10-02
2023-09-29
2023-09-28
2023-09-27
2023-09-26
2023-09-25
2023-09-22
2023-09-21
2023-09-20
2023-09-19
2023-09-18
2023-09-15
2023-09-14
2023-09-13
2023-09-12
2023-09-11
2023-09-09
2023-09-08
2023-09-07
2023-09-06
2023-09-05
2023-09-04
2023-09-02
2023-09-01
2023-08-31
2023-08-30
2023-08-29
2023-08-28
2023-08-27
2023-08-25
2023-08-24
2023-08-23
2023-08-22
2023-08-21
2023-08-18
2023-08-17
2023-08-16
2023-08-15
2023-08-14
2023-08-13
2023-08-11
2023-08-10
2023-08-09
2023-08-08
2023-08-07
2023-08-04
2023-08-03
2023-08-02
2023-08-01
2023-07-31
2023-07-30
2023-07-28
2023-07-27
2023-07-26
2023-07-25
2023-07-24
2023-07-23
2023-07-21
2023-07-20
2023-07-19
2023-07-18
2023-07-17
2023-07-14
2023-07-13
2023-07-12
2023-07-11
2023-07-10
2023-07-08
2023-07-07
2023-07-06
2023-07-05
2023-07-04
2023-07-03
2023-06-30
2023-06-29
2023-06-28
2023-06-27
2023-06-26
2023-06-23
2023-06-22
2023-06-21
2023-06-20
2023-06-19
2023-06-16
2023-06-15
2023-06-14
2023-06-13
2023-06-12
2023-06-09
2023-06-08
2023-06-07
2023-06-06
2023-06-05
2023-06-03
2023-06-02
2023-06-01
2023-05-31
2023-05-30
2023-05-29
2023-05-26
2023-05-25
2023-05-24
2023-05-23
2023-05-22
2023-05-21
2023-05-19
2023-05-18
2023-05-17
2023-05-16
2023-05-15
2023-05-12
2023-05-11
2023-05-10
2023-05-09
2023-05-08
2023-05-05
2023-05-04
2023-05-03
2023-05-02
2023-05-01
2023-04-28
2023-04-27
2023-04-26
2023-04-25
2023-04-24
2023-04-21
2023-04-20
2023-04-19
2023-04-18
2023-04-17
2023-04-14
2023-04-13
2023-04-12
2023-04-11
2023-04-10
2023-04-09
2023-04-07
2023-04-06
2023-04-05
2023-04-04
2023-04-03
2

2025-01-19 03:43:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 251
2025-01-19 03:43:05 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:06 - root - INFO - SQL:
-- 12. Calculate total sales revenue per vendor in 2023
SELECT "vendor_number", "vendor_name", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "vendor_number", "vendor_name"
LIMIT 1000
Results:
Too long, hard cut:
vendor_number,vendor_name,total_sales_2023
325,LONELY OAK DISTILLERY,265744.69000000006
935,ALAMBIC INC.,2825.28
549,"GREEN FROG DISTILLERY, LLC",61004.25
273,HAWAII SEA SPIRITS LLC,20201.739999999998
937,OLD LOUISVILLE WHISKEY CO. LLC,10890.0
907,DRY FLY DISTILLING,1290.0
540,MEISENBURG BREWING & DISTILLING,180.0
85,BROWN FORMAN CORP.,20513550.880000006
772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,2409294.1700000004
727,BENCHMARK BEVERAGE COMPANY LLC,46451.850000000006
391,HOTALING & CO,187829.12000000002
780,CLEAR WATER DISTILLING CO,2765.9700000000003
822,WHIDBEY ISLAND DISTILLERIES LLC,422.16
934,LONG ISLAND SPIRITS INC.,297.0
625,MIDDLE WEST SPIRITS,3586.5
539,GARGOYLE ENTERPRISES / LAWS WHISKEY HOUSE,16839.0
437,OPICI IMPORT COMPANY,2430.0
752,COPPER STILL DISTILLERY,2190.0
268,IMPEX BEVERAGE INC,22932.540000000005
558,ALTAMAR BRANDS LLC,49533.82
557,"WORLDWIDE LIBATIONS, LLC",60962.840000000004
775,"BONAVITA BEVERAGE GROUP, LLC",35151.15
368,PARK STREET IMPORTS,3092789.0500000003
91,CASTLE BRANDS,45449.4
353,"JOHN ERNEST DISTILLERY, INC.",77341.93000000001
924,BALUARTE SPIRITS LLC,2176.4
231,RS LIPMAN COMPANY LLC,3084.48
342,DV SPIRITS LLC,364011.4
116,BAD BEAR ENTERPRISES LLC / LEGENDARY RYE,90137.61
892,"CHACHO SPIRITS / ZJ LIQUORS, LLC",1336.5
734,"ELIXIR, INC.",2700.0
384,PIEDMONT DISTILLERS INC,358055.48
338,"MARUSSIA BEVERAGES USA, INC / NICHE IMPORT",141347.71000000002
805,WMC-PBD LLC/ PINE BLUFFS DISTILLING,4387.5
583,"USA WINE WEST, LLC",17222.0
65,JIM BEAM BRANDS,30037947.910000004
232,DRIFTLESS GLEN DISTILLERY,46275.98999999999
402,OZ SPIRITS LLC,28290.24000000001
742,WILDCAT PRODUCTS LLC,30412.5
580,MARA IMPORTS,4228.799999999999
792,RIVER VALLEY ORCHARDS & WINERY,3168.0
347,NORTH SHORE DISTILLERY,195.06
837,ONE LIFE SPIRITS LLC,18614.700000000004
677,DURHAM DISTILLERY,1559.52
492,WESTERN SPIRITS BEVERAGE,918640.7899999999
454,SALOON SPIRITS LLC,148289.94
797,UNA FAMILIA SPIRITS LLC,25669.069999999992
351,"TATTERSALL COMPANIES, LLC",6533.369999999999
334,DES MOINES IMPORTS / DSM IMPORTS LLC,702.0
195,SWELL LIQUOR LLC,248410.49999999997
163,STOLLER IMPORTS INC / MARSALLE COMPANY,182356.74
785,MAISON FERRAND USA,10974.189999999997
650,HIGHCLERE CASTLE SPIRITS,625.3199999999999
305,MHW LTD,2368884.9500000007
100,AIKO IMPORTERS INC,165455.28999999998
370,PERNOD RICARD USA,27709155.019999996
690,TOM'S TOWN DISTILLING CO,11978.750000000002
110,3 BADGE CORPORATION,44358.84000000001
556,BOOT HILL DISTILLERY LLC,1732.5
421,SAZERAC COMPANY  INC,66752599.61999999
346,OLE SMOKY DISTILLERY LLC,5252152.899999999
90,CARRIAGE HOUSE IMPORTS,38677.5
525,CATS EYE DISTILLERY,159136.27
363,PATERNO IMPORTS LTD / TERLATO WINES INTERNATIONAL,106614.52
428,"TRAVERSE CITY WHISKEY CO / TCWC, LLC",22327.38
832,ROYAL WINE CORPORATION,1120.5
606,SAVAGE & COOKE / SANTA CROCE LLC,16579.559999999998
235,DEMERARA DISTILLERS (USA) INC.,11379.12
638,DC BEVERAGE LLC,954.0
118,AMERICAN SPIRITS EXCHANGE,872681.03
460,SHAW-ROSS INTERNATIONAL,189432.6
705,"VALHALLA IMPORTS, LLC",1231.92
673,INTERNATIONAL TRADE ONE CORP,1038.06
448,ST GEORGE SPIRITS INC,59704.5
477,VINO.COM DBA TOTAL BEVERAGE SOLUTION,29041.94999999999
789,SARGE'S SPIRITS LLC,25956.0
209,MINHAS MICRO DISTILLERY,222525.30000000002
108,CVI BRANDS / CALIFORNIA VINEYARDS INC,2205.0
749,GRAYBEARD DISTILLERY INC,577.5
886,GEORGETOWN TRADING CO. LLC / JAMES PEPPER DISTILLING CO.,171.5
784,ALTOS PLANOS INC.,2162.7000000000003
561,DOC BROWN ENTERPRISES,330.0
287,CHATHAM IMPORTS INC,366185.25
888,"TRUST ME VODKA, INC.",92233.5
573,TEMPLETON DISTILLING LLC,115031.34
803,LEVECKE CORPORATION,1731901.5
807,TERRANOVA SPIRITS LLC,5754.780000000001
607,"SURO INTERNATIONAL IMPORTERS, INC",870.24
779,BOVEDA RESERVE DISTRIBUTION LLC,7200.0
482,"SOVEREIGN BRANDS, LLC",400293.45000000007
522,10TH MOUNTAIN WHISKEY AND SPIRIT COMPANY,10264.5
645,ROCKY TOP INVESTMENTS / ROCK RIVER DISTILLATION,15090.0
812,WILLIAM WRIGHT / BAY AND ROUSE LLC,540.0
537,"GLOBAL SPIRITS USA, LLC",1224.7200000000003
712,"BLACKBIRD SPIRITS, LLC / DR. STONERS HERB INFUSED SPIRITS",5184.069999999998
280,MACCHU PISCO LLC,5101.0
783,CITADEL BEVERAGES,16303.939999999999
422,MACH FLYNT INC.,164553.68999999997
932,COPPERMUSE INC/COPPERMUSE DISTILLERY,567.12
560,HEAVENLY SPIRITS LLC,2494.6800000000003
568,21ST CENTURY SPIRITS LLC,46372.30999999998
785,MAISON FERRAND USA / COGNAC FERRAND USA INC,123354.90000000001
589,PREMIER DISTRIBUTORS LLC,41503.92
793,CEO DISTILLING LLC,19770.66
547,FETZER VINEYARDS,1005.12
205,E & J GALLO WINERY,9603379.85
472,"TEQUILAS PREMIUM, INC",537352.54
782,KINDRED VINES IMPORT CO/ J&J IMPORTERS,8746.5
521,JEM BEVERAGE COMPANY / WESTERN SON,279088.0
626,JDSO INC / RED BOOT DISTILLERY,1983.9599999999998
478,SUTTER HOME WINERY INC / TRINCHERO FAMILY ESTATES,28563.620000000006
926,"GRATON SPIRITS COMPANY, LLC / PURPLE BRANDS",70132.5
777,"BLUE OX SPIRITS, INC.",2135285.9200000004
266,EDRINGTON GROUP USA LLC,675753.96
942,LALO SPIRITS LLC,16704.0
654,REVELTON DISTILLING COMPANY

2025-01-19 03:43:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 03:43:07 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:07 - root - INFO - SQL:
-- 13. Find average sale amount per transaction in 2023
SELECT AVG("sale_dollars") AS "average_sale_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
LIMIT 1000
Results:
average_sale_2023
168.9945178376523

2025-01-19 03:43:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:43:09 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:09 - root - INFO - SQL:
-- 14. List distinct store numbers and names
SELECT DISTINCT "store_number", "store_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Results:
Too long, hard cut:
store_number,store_name
6269,"NEIGHBORHOOD FOOD, LIQUOR & TOBACCO / CEDAR RAPIDS"
5630,CASEY'S GENERAL STORE #3009 / SIOUX CITY
4444,KUM & GO #4127 / SLOAN
4277,CORK IT!
6176,MINI-MART / CEDAR FALLS
6045,KUM & GO #3156 / CLIVE
6145,THE DEPOT VAN HORNE
6274,OSKALOOSA WATERING HOLE
5601,CASEY'S GENERAL STORE #1889 / MONTICELLO
6233,QUICK STOP / CEDAR RAPIDS
10153,IOWA SPIRITS / BURLINGTON
5861,TAYLOR QUIK PIK - COUNCIL BLUFFS
3813,CGI FOODS
4247,FAREWAY STORES #879 / BELMOND
2612,HY-VEE STORE / PERRY
3461,HOMETOWN FOODS / STUART
2707,HY-VEE FAST AND FRESH - URBANDALE
5329,DIVA & TEJ GAS & FOOD
5762,CASEY'S GENERAL STORE #1329 / ESTHERVILLE
10423,KWIK STAR #1153 / MILFORD
4105,FAREWAY STORES #426 / NEVADA
3889,WAL-MART 1005 / WAVERLY
10350,SUPER SAVER LIQUOR / MUSCATINE
6087,SMOKER'S GENIE / WAUKEE
5738,CASEY'S GENERAL STORE #3291
6218,BOJI JUNCTION / MILFORD
5023,HAWKEYE CONVENIENCE STORES / 16TH AV
6109,MOES MART #11 / SIOUX CENTER
5357,GAMEDAY LIQUOR/ ORANGE CITY
5919,CASEY'S GENERAL STORE #2584  / OSSIAN
4509,A J'S LIQUOR II
2964,DAHL'S / ANKENY
10049,JEFFS FOODS REMSEN / REMSEN
10224,KIMMES DENISON COUNTRY STORE 11 / DENISON
3562,WAL-MART 0797 / W BURLINGTON
4821,CASEY'S GENERAL STORE #3215 / OSKALOOSA
5666,COSTCO WHOLESALE #1325 / DAVENPORT
3645,WAL-MART 1764 / WINDSOR HEIGHTS
4533,CASEY'S GENERAL STORE #1985 / ST. AN
4307,CROSSROADS WINE AND LIQUOR
4992,OLD 34 GAS & GRILL
6321,COLONY POINT FUEL & GAS - WILLIAMSBURG
4386,KUM & GO #701 / MARSHALLTOWN
10332,METRO MART #3 / CEDAR FALLS
10091,CASEY'S #6116 / COUNCIL BLUFFS
4848,KUM & GO #246 / WINTERSET
5415,PRIME MART 7 / WATERLOO
2614,HY-VEE #3 FOOD & DRUGSTORE / DAVENPORT
2670,HY-VEE FOOD STORE / CORALVILLE
2248,INGERSOLL LIQUOR AND BEVERAGE
5656,CODY MART GAS & LIQUOR
5691,LOGAN AVE CONVENIENCE STORE / WATERLOO
5437,GREAT PASTIMES
6168,BREW OIL #32 / SPENCER
4427,KUM & GO #507 / NORTH LIBERTY
2584,HY-VEE FOOD STORE / FORT MADISON
4638,GD XPRESS / DAVENPORT
5922,CASEY'S GENERAL STORE #3896 / CENTER POINT
4131,FAREWAY STORES #933 / URBANDALE
4777,CASEY'S GENERAL STORE #3730 / PAULLINA
5908,NEIGHBORHOOD TOBACCO OUTLET / MARION
10025,HY-VEE FAST AND FRESH #4 (7583) / URBANDALE
5000,CASEY'S GENERAL STORE #3319 / NEVADA
2575,HY-VEE FOOD STORE #1 / WATERLOO
6081,CIRCLE K / WDM
2555,HY-VEE FOOD STORE / KEOKUK
5593,GRANDVIEW MART
6018,CASEY'S GENERAL STORE #2532 / ELDORA
2703,HY-VEE FAST AND FRESH / CLIVE
6291,JET STOP BURLINGTON SOUTH / BURLINGTON
5276,CASEY'S GENERAL STORE # 3502/ STANTO
5488,YESWAY #1103 / ROCKFORD
6255,KWIK STAR #1165 / SIBLEY
5714,YESWAY #1031
5736,218 FUEL EXPRESS
4908,ZAPF'S PRONTO MARKET
4960,AJ'S LIQUOR III
5348,"SUPER LUCKY, INC"
4597,QUIK TRIP #523 / ARMY POST DM
6169,JACK & JILL STORE / WEST BRANCH
3891,"WILD ROSE EMMETSBURG, LLC"
10197,SUNSHINE FOODS / HAWARDEN
4690,SUPER STOP AND SHOP / BALDWIN
4283,GUPPYS ON THE GO
4514,CASEY'S GENERAL STORE #2813 / FORT D
4210,SICHANH LIQUOR STORE
4708,NO FRILLS SUPERMARKETS #803 / GLENWO
5941,PRIME MART - CEDAR FALLS
4417,KUM & GO #76 / ADAIR
4499,CASEY'S GENERAL STORE #1316 / MILFORD
5984,CASEY'S GENERAL STORE #3214 / OSKALOOSA
10134,"FAREWAY STORES, INC. #232 / WEST DES MOINES"
2535,HY-VEE FOOD STORE #1 / WDM
5339,PRIME STAR
2698,HY-VEE GAS #4 - WDM
4385,KUM & GO #43 / NEW VIRGINIA
2600,HY-VEE FOOD STORE / OSKALOOSA
4792,CASEY'S GENERAL STORE #2899 / DE SOTO
4468,CIRCLE K #6600 / MUSCATINE
5998,WILTON EXPRESS
6046,CASEY'S GENERAL STORE #2150 / WDM
5739,CASEY'S GENERAL STORE #1455
6203,WORLD LIQUOR & TOBACCO + VAPORS / WAUKEE
5375,CASEY'S GENERAL STORE # 3518/ DES MOINES
5699,FLASHMART #102 /PERRY
4474,BUCKY'S EXPRESS #34 / COUNCIL BLUFFS
3732,NORTH SCOTT FOODS
5709,JW LIQUOR
4582,JIFFY #926 / SPIRIT LAKE
4770,CASEY'S GENERAL STORE #3080 / HUDSON
6085,CIRCLE K #22654122 / BOONE
5648,FAREWAY STORES #189 / AMES
10440,JJ'S VALLEY MART / ROCK VALLEY
5571,CASEY'S GENERAL STORE #2782 / CEDAR RAPIDS
6202,XO FOOD & LIQUOR / WATERLOO
10281,CORYDON CORNER / CORYDON
6080,CHEEMA GAS AND LIQUORS / NEW SHARON
4004,WAL-MART 4256 / AMES
3565,HARTIG DRUG STORE #10
3928,SMOKIN' JOE'S #12 TOBACCO AND LIQUOR
4165,I-35 SPIRITS / ANKENY
2588,HY-VEE FOOD AND DRUG #6 / CEDAR RAPI
3912,SMOKIN' JOE'S #14 TOBACCO AND LIQUOR
4801,WALGREENS #05852 / DES MOINES
4273,SMOKIN' JOE'S #4 TOBACCO AND LIQUOR
5241,BP  /  DUBUQUE
5333,FAREWAY STORES # 166/ ANAMOSA
3910,RIVERSIDE CASINO AND RESORT
5295,YESWAY STORE # 10023/ WATERLOO
6018,CASEY'S GENERAL STORE - #2532
10225,B&L DRIVE THRU / FORT DODGE
5820,CASEY'S GENERAL STORE #57 / EDDYVILLE
5506,CASEY'S GENERAL STORE #2168
5125,CASH SAVER  /  E EUCLID AVE
3776,WAL-MART 5115 / DAVENPORT
3790,WAL-MART 0784 / MT PLEASAN
5694,FLASHMART #104
4430,KUM & GO #87 / FORT DODGE
4590,CASEY'S GENERAL STORE #3045 / CEDAR
4524,CASEY'S GENERAL STORE #1139 / NORA S
5401,CLINTON GAS & MART
2513,HY-VEE FOOD STORE #2 (1285) / IOWA CITY
5069,CASEY'S GENERAL STORE #1705 / LAKE M
4152,FOOD LAND SUPER MARKETS
6313,DANNYS TOBACCO & LIQUOR / GUTTENBERG
5782,CASEY'S GENERAL STORE #3606
6024,CASEY'S GENERAL ST

2025-01-19 03:43:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 03:43:11 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:11 - root - INFO - SQL:
-- 15. Calculate total sales revenue per store in 2023
SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "store_number", "store_name"
LIMIT 1000
Results:
Too long, hard cut:
store_number,store_name,total_sales_2023
6045,KUM & GO #3156 / CLIVE,92150.12999999999
10049,JEFFS FOODS REMSEN / REMSEN,41003.75000000001
4821,CASEY'S GENERAL STORE #3215 / OSKALOOSA,46552.259999999995
6176,MINI-MART / CEDAR FALLS,218242.49000000005
3461,HOMETOWN FOODS / STUART,139487.32
3889,WAL-MART 1005 / WAVERLY,298720.82999999996
2612,HY-VEE STORE / PERRY,254771.91999999998
5630,CASEY'S GENERAL STORE #3009 / SIOUX CITY,81620.72999999998
4105,FAREWAY STORES #426 / NEVADA,245074.97999999992
2707,HY-VEE FAST AND FRESH - URBANDALE,31717.710000000003
6269,"NEIGHBORHOOD FOOD, LIQUOR & TOBACCO / CEDAR RAPIDS",187927.57
10153,IOWA SPIRITS / BURLINGTON,210943.69999999998
3562,WAL-MART 0797 / W BURLINGTON,593212.76
6233,QUICK STOP / CEDAR RAPIDS,243781.33000000002
5601,CASEY'S GENERAL STORE #1889 / MONTICELLO,60327.05000000001
6274,OSKALOOSA WATERING HOLE,12252.81
5666,COSTCO WHOLESALE #1325 / DAVENPORT,1849806.8400000003
4444,KUM & GO #4127 / SLOAN,56953.41000000001
6145,THE DEPOT VAN HORNE,33410.060000000005
4277,CORK IT!,203065.79000000007
10224,KIMMES DENISON COUNTRY STORE 11 / DENISON,14449.479999999998
5762,CASEY'S GENERAL STORE #1329 / ESTHERVILLE,56617.6
6218,BOJI JUNCTION / MILFORD,14943.420000000004
5738,CASEY'S GENERAL STORE #3291,51745.85
3645,WAL-MART 1764 / WINDSOR HEIGHTS,430382.22000000003
4247,FAREWAY STORES #879 / BELMOND,171430.68000000002
5329,DIVA & TEJ GAS & FOOD,80489.97
5861,TAYLOR QUIK PIK - COUNCIL BLUFFS,69967.78999999998
5919,CASEY'S GENERAL STORE #2584  / OSSIAN,25887.0
6321,COLONY POINT FUEL & GAS - WILLIAMSBURG,3953.9
4004,WAL-MART 4256 / AMES,719055.7300000002
6202,XO FOOD & LIQUOR / WATERLOO,146153.80999999997
10134,"FAREWAY STORES, INC. #232 / WEST DES MOINES",170669.26999999996
4582,JIFFY #926 / SPIRIT LAKE,344456.9700000001
2600,HY-VEE FOOD STORE / OSKALOOSA,230650.09
6046,CASEY'S GENERAL STORE #2150 / WDM,85251.27
5571,CASEY'S GENERAL STORE #2782 / CEDAR RAPIDS,48213.520000000004
5998,WILTON EXPRESS,54390.96999999999
5984,CASEY'S GENERAL STORE #3214 / OSKALOOSA,54502.58000000001
4385,KUM & GO #43 / NEW VIRGINIA,62493.94000000001
5941,PRIME MART - CEDAR FALLS,280508.9299999999
5295,YESWAY STORE # 10023/ WATERLOO,63920.20999999999
3776,WAL-MART 5115 / DAVENPORT,403692.42
4792,CASEY'S GENERAL STORE #2899 / DE SOTO,73942.72
4801,WALGREENS #05852 / DES MOINES,36362.950000000004
5375,CASEY'S GENERAL STORE # 3518/ DES MOINES,118114.38
4499,CASEY'S GENERAL STORE #1316 / MILFORD,54696.23
6085,CIRCLE K #22654122 / BOONE,22689.28000000001
3790,WAL-MART 0784 / MT PLEASAN,297205.76
3732,NORTH SCOTT FOODS,46930.23999999998
6203,WORLD LIQUOR & TOBACCO + VAPORS / WAUKEE,22575.060000000005
3910,RIVERSIDE CASINO AND RESORT,155796.05
5820,CASEY'S GENERAL STORE #57 / EDDYVILLE,29520.91
5739,CASEY'S GENERAL STORE #1455,28811.009999999995
4770,CASEY'S GENERAL STORE #3080 / HUDSON,44799.060000000005
4417,KUM & GO #76 / ADAIR,47957.219999999994
5648,FAREWAY STORES #189 / AMES,72783.84999999999
2698,HY-VEE GAS #4 - WDM,15742.140000000003
10281,CORYDON CORNER / CORYDON,11316.219999999998
10225,B&L DRIVE THRU / FORT DODGE,3868.980000000001
9037,"GREEN FROG DISTILLERY, LLC",16600.5
2585,HY-VEE WINE AND SPIRITS (1010) / ALGONA,735897.4199999999
10115,"FAREWAY STORES, INC. #236 / BONDURANT",172946.88999999998
5603,CASEY'S GENERAL STORE #2480 / CHARLES CITY,38926.40000000001
5117,FOOD & GAS MART  /  MARSHALLTOWN,45184.000000000015
4854,CASEY'S GENERAL STORE #3029 / ARMSTRONG,76025.12999999999
5708,BROTHERS MARKET / WILLIAMSBURG,104744.51000000004
5396,CASEY'S GENERAL STORE # 3512/ INDIANOLA,65665.12
4378,KUM & GO #1202 / WAUKEE,109469.55000000002
4642,LIQUOR AND TOBACCO OUTLET / UNIV AVE WATERLOO,50020.26
4800,WALGREENS #07968 / DES MOINES,22300.510000000002
4902,BROADWAY LIQUOR,121844.46
6008,TARGET STORE T-3374 / IOWA CITY,117017.78999999998
6117,FAREWAY STORES #212 / COLFAX,94835.45999999998
5109,CASEY'S GENERAL STORE #3404 / CARLIS,89058.25000000003
5847,MOTI'S FOOD,125432.83000000003
4236,FAREWAY STORES #551 / EAGLE GROVE,166780.97999999998
3065,MONTEZUMA SUPER VALU,78798.40999999999
6148,BEER ON FLOYD / SIOUX CITY,78239.69
5184,CASEY'S GENERAL STORE #3440 / CAMANC,89965.37000000001
5196,THE DEPOT CORALVILLE,42527.95
4491,CASEY'S GENERAL STORE #2772 / CEDAR RAPIDS,94469.99999999999
10143,BREW #63 / DAVENPORT,19904.450000000004
4630,EZ STOP / DAVENPORT,249265.2800000001
6314,JET STOP MILTON / MILTON,32382.540000000008
6293,JET STOP WEST POINT / WEST POINT,28033.89
5409,CASEY'S GENERAL STORE # 2179/ WAUKEE,53469.42999999999
6120,CRESCO MART,56873.21000000001
4546,CASEY'S GENERAL STORE #2303 / GLIDDEN,37331.93
6186,SAVE MORE SUPER MARKET / DAVENPORT,16663.529999999995
6058,PANTHER TRAVEL CENTER / CEDAR FALLS,9362.039999999999
10189,HY-VEE / KNOXVILLE,14144.189999999997
6281,MARTELLE STORE / MARTELLE,221.4
3644,WAL-MART 2764 / ALTOONA,603255.83
10032,KWIK STAR #1158 / AMES,44192.45000000001
6290,S & S MEATS AND SPIRITS / OSAGE,114022.65000000002
5358,KUM & GO #1056/ BEVINGTON,78060.02000000002
4457,KUM &

2025-01-19 03:43:11 - root - INFO - itercount: 0
2025-01-19 03:43:11 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
DDL describes table information.
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **"date"**: Used to filter and group sales by year.
- **"item_number"**: Used to identify and group sales data by item.
- **"item_description"**: Provides descriptive names for items.
- **"sale_dollars"**: Used to calculate total sales revenue.
- **"bottles_sold"**: Used to analyze the quantity of items sold.

**Conditions that may be used:**

- **Filter sales for specific years**:
  - For 2023: `"date" BETWEEN '2023-01-01' AND '2023-12-31'`
  - For 2022: `"date" BETWEEN '2022-01-01' AND '2022-12-31'`
- **Group data by item**:
  - `GROUP BY "item_number"`
- **Order results to find top items**:
  - `ORDER BY "total_sales" DESC`

---

```sql
-- 1. List distinct years present in the sales data
SELECT DISTINCT EXTRACT(YEAR FROM "date") AS "year"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000;

-- 2. Retrieve a sample of item numbers and their descriptions
SELECT DISTINCT "item_number", "item_description"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000;

-- 3. Calculate total sales revenue per item in 2023
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
LIMIT 1000;

-- 4. Calculate total sales revenue per item in 2022
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "item_number"
LIMIT 1000;

-- 5. Find the top 10 items by total sales revenue in 2023
SELECT "item_number", SUM("sale_dollars") AS "total_sales"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
ORDER BY "total_sales" DESC
LIMIT 10;

-- 6. Calculate total bottles sold per item in 2023
SELECT "item_number", SUM("bottles_sold") AS "total_bottles_sold_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
LIMIT 1000;

-- 7. Calculate total bottles sold per item in 2022
SELECT "item_number", SUM("bottles_sold") AS "total_bottles_sold_2022"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "item_number"
LIMIT 1000;

-- 8. Identify items sold in 2023 but not in 2022
SELECT DISTINCT "item_number"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
AND "item_number" NOT IN (
  SELECT DISTINCT "item_number"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
)
LIMIT 1000;

-- 9. List distinct categories and their names
SELECT DISTINCT "category", "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000;

-- 10. Calculate total sales revenue per category in 2023
SELECT "category", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "category"
LIMIT 1000;

-- 11. Retrieve a list of sale dates to examine date ranges
SELECT DISTINCT "date"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
ORDER BY "date" DESC
LIMIT 1000;

-- 12. Calculate total sales revenue per vendor in 2023
SELECT "vendor_number", "vendor_name", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "vendor_number", "vendor_name"
LIMIT 1000;

-- 13. Find average sale amount per transaction in 2023
SELECT AVG("sale_dollars") AS "average_sale_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
LIMIT 1000;

-- 14. List distinct store numbers and names
SELECT DISTINCT "store_number", "store_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000;

-- 15. Calculate total sales revenue per store in 2023
SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "store_number", "store_name"
LIMIT 1000;
```Query:
-- 1. List distinct years present in the sales data
SELECT DISTINCT EXTRACT(YEAR FROM "date") AS "year"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Answer:
year
2017
2024
2016
2019
2013
2018
2014
2021
2020
2012
2022
2015
2023
Query:
-- 2. Retrieve a sample of item numbers and their descriptions
SELECT DISTINCT "item_number", "item_description"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Answer:
Too long, hard cut:
item_number,item_description
31718,PHILLIPS GIN
56874,BACARDI HURRICANE RTS
9432,PASSPORT SCOTCH
38847,TRULY PINEAPPLE MANGO
36908,MCCORMICK VODKA PET
101233,PATRON SILVER TEQUILA LIMITED EDITION
34001,ABSOLUT SWEDISH VODKA 80 PRF MINI
35947,FLEISCHMANNS 80PRF VODKA
39918,NEW AMSTERDAM APPLE
68039,BAILEY'S ORIGINAL IRISH CREAM
59037,DESERT ISLAND LONG ISLAND ICED TEA COCKTAIL
22244,YELLOWSTONE SELECT
24156,HAWKEYE BLENDED WHISKEY
26432,BIRD DOG PEANUT BUTTER
86112,DEKUYPER TRIPLE SEC
17085,BULLEIT BOURBON
101239,WHISTLEPIG RYE PIGLETS MINI
36901,MCCORMICK 80PRF VODKA MINI
86668,JACK DANIELS TENNESSEE HONEY MINI
101462,YUKON JACK ASSORTED MINIS
25603,SEAGRAMS 7 CROWN BL WHISKEY
32233,SEAGRAMS EXTRA DRY GIN
43123,BACARDI SUPERIOR
901116,LATTE MACHIATTO
42714,MALIBU COCONUT
73253,DAMSO BLUEBERRY SOJU
102057,FIREBALL FALL TAILGATE BAG
14495,REVEL STOKE ROOT BEER MINI
84187,99 CINNAMON
100448,1800 SILVER W/FLASK
101457,ARDBEG SCORCH GIFT BOX
17050,BROTHERS BOND STRAIGHT BOURBON WHISKEY
17092,BULLEIT BOURBON BARREL STRENGTH
43134,BACARDI LIMON
21538,STAGG BOURBON
63345,ON THE ROCKS COCKTAILS TRES GEN JALAPENO PINEAPPLE MARGARITA
238,FORBIDDEN SECRET COFFEE PACK
100433,SUNTORY TOKI W/HIGHBALL GLASS
26293,REVELTON SHINE WHITE WHISKEY
26986,IOWA LEGENDARY RYE PRIVATE RESERVE
65896,METAXA OUZO
67556,KAMORA COFFEE LIQUEUR
67296,YUKON JACK PERMA FROST SCHNAPPS DISCO
86771,OLE SMOKY WHITE LIGHTNIN
89242,CORRALEJO REPOSADO TEQUILA
89916,TORTILLA GOLD
10553,BLACK VELVET CINNAMON RUSH DISCO
36258,DEHNER DISTILLERY VODKA
37526,PRAIRIE ORGANIC VODKA
41077,JEREMIAH WEED SWEET TEA
41604,UV GRAPE VODKA
35916,FIVE O'CLOCK VODKA
28893,BOMBAY BRAMBLE
33966,ABSOLUT ORIENT APPLE
40678,PUCKER VODKA LEMONADE LUST
76239,MOSHINE PEACH MINI
57585,BEAGANS CRANBERRY VODKA
18424,REMUS HIGHEST RYE
85835,TEQUILA PADRE AZUL ANEJO MINI
100236,ZING 72 GIN W/COPPER CUP
25251,WHISKEYSMITH BLOOD ORANGE FLAVORED WHISKEY
101028,RUMHAVEN W/TIKI MUG
102035,DOS HOMBRES MEZCAL + FEVER TREE PINK GRAPEFRUIT SODA VAP
20368,OLD FORESTER BOURBON 86PRF
42009,UV CAKE VODKA
59159,1800 ULTIMATE RASPBERRY
62616,ZIYAD WATERMELON DRIP
87725,GRAN CORAMINO REPOSADO CRISTALINO
994771,DIPLOMATICO RESERVA EXCLUSIVA
3310,JAGERMEISTER W/FLASK
34198,CIROC SUPER PREMIUM VODKA
33110,INDOGGO STRAWBERRY GIN
903892,LINIE AQUAVIT
62811,ON THE ROCKS KNOB CREEK OLD FASHIONED
101452,DEWARS DISCOVERY PACK W/2 MINIS
127,DEEP EDDY LEMON W/2 TIN CUPS
25866,STONE BREAKER
63131,ON THE ROCKS COCKTAILS CRUZAN DAIQUIRI
3916,ABSOLUT MINI BAR
58210,CRAFTHOUSE COCKTAILS PINEAPPLE DAIQUIRI
28147,MERICA SMALL BATCH BOURBON
37690,CM KNEE HIGH DISTILLING VODKA
42666,MT GAY ECLIPSE RUM
942481,DICTADOR RUM 12YR
1500,JAMESON IRISH WHISKEY TIN
59205,1800 PASSION FRUIT ULTIMATE MARGARITA
101018,GLENLIVET TRIAL PACK MINIS
68559,KERRYGOLD IRISH CREAM LIQUEUR
87027,ADICTIVO REPOSADO TEQUILA
918417,HA REMUS REPEAL RESERVE BOURBON II
39707,WESTERN SON WATERMELON VODKA
4084,ABERLOUR 12 YEAR SINGLE MALT SCOTCH
51328,MARASKA SLIVOVITZ 10YR
56804,PAUL MASSON RED BERRY GRANDE AMBER BRANDY
21671,BP TOWN BRANCH SINGLE BARREL RESERVE BOURBON
27715,BP KOVAL SINGLE BARREL BOURBON WHISKEY
901203,YAHARA BAY LAVENDAR LIQUEUR
68842,ST. BRENDAN'S SUPERIOR IRISH CREAM LIQUEUR
77497,TORTILLA SILVER DSS
89535,FAMILIA CAMARENA REPOSADO
983927,MAUI TROPICAL SCHNAPPS
101428,SMIRNOFF W/50ML PINK LEMONADE
5014,GLENFIDDICH 15 YR SOLERA RESERVA
977250,MARK ROGERS PEACH MOONSHINE MINI
65260,JAGERMEISTER COOLPACK DISCO
88543,SAUZA CIEN ANOS PLATA
28078,OXLEY LONDON DRY GIN
100306,PATR�N EXTRA A�EJO
77050,FIELD FIRE
87990,LOS SIETE MISTERIOS DOBA YEJ
901112,LATTE MACHIATTO
28485,FORDS GIN
17958,EVAN WILLIAMS BLACK
43388,CASTILLO SILVER RUM
64866,FIREBALL CINNAMON WHISKEY
58838,JOSE CUERVO AUTHENTIC LIME MARGARITA
76488,PARAMOUNT AMARETTO
28867,TANQUERAY GIN
54647,ARROW BLACKBERRY FLAV BRANDY
27175,TEMPLETON 4YR RYE
43285,CAPTAIN MORGAN ORIGINAL SPICED RUM PET
42717,MALIBU COCONUT
64753,CHUM CHURUM ORIGINAL SOJU
55087,PARAMOUNT BLACKBERRY BRANDY
100938,FIREBALL VALENTINE PACK
39301,REVELTON HONEY VODKA MINI
65929,MALIBU PEACH MINI
69940,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR MINI
72977,NORTH FOREST KREME HUCKLEBERRY VANILLA MINI
88291,PATRON SILVER MINI
38174,TITOS HANDMADE VODKA
45274,PARAMOUNT WHITE RUM
101988,FIREBALL SUMMER BAG
33670,GREY GOOSE LE MELON MINI
33866,KUHL MANGO LEMONADE MINI
22288,WOODFORD RESERVE BATCH PROOF
16466,1792 BOTTLE IN BOND BOURBON
19235,KNOB CREEK SINGLE BARREL RESERVE
26104,HIGH WEST LIMITED SUPPLY HIGH COUNTRY AMERICAN SINGLE MALT
101471,99 HOLIDAY ORNAMENT MINIS
19239,KNOB CREEK 12YR
100636,JIM BEAM MINI 12 SEASONS
101293,JIM BEAM WHITE W/ HOLIDAY TUMBLER
13542,LEGACY CANADIAN WHISKY
27126,RUSSELLS RESERVE RYE 6YR
17260,RANCH ROAD STRAIGHT BOURBON WHISKEY
100855,MAKER''S MARK GENERATIONS TRI-PACK
89635,OLMECA REPOSADO
42177,BLUE CHAIR BAY BANANA RUM MINI
19065,BP JEFFERSONS OCEAN WHEATED BOURBON BARREL
28600,GLENDALOUGH ROSE GIN
35179,PEARL BLUEBERRY
37394,CM JUST ANOTHER VODKA - BLACK
41320,BURNETTS W
Query:
-- 3. Calculate total sales revenue per item in 2023
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
LIMIT 1000
Answer:
Too long, hard cut:
item_number,total_sales_2023
43127,1015896.75
100865,28496.64
12404,61167.86
16416,86305.5
24466,33137.88999999999
34036,136738.78
39466,28636.5
5555,274229.96
56206,24241.67
58866,14358.96
76413,305097.0
77698,47539.200000000004
12858,30750.0
39424,25072.369999999995
58838,809004.9900000001
77487,1092768.6
82147,44151.64000000001
37784,3699.0
67534,17942.410000000003
44175,6831.0
903203,13893.75
30528,43833.47
34566,13009.5
82610,39728.840000000004
45217,75608.49999999999
78292,29314.150000000012
80308,1297.1999999999996
38089,25723.479999999992
21256,20587.5
39026,1530.0
900606,9180.0
88267,38898.75
89644,141244.5
89519,33642.0
42166,13277.25
73253,6411.999999999999
100737,42075.740000000005
4246,23938.569999999992
76850,10576.620000000003
940082,5292.0
15622,58092.75
35356,15322.0
80451,1467.0
88356,23365.5
965815,3932.9399999999996
902256,14242.5
21211,37050.0
85981,6637.5
19461,24300.0
26665,24555.75
87178,4893.75
39622,13758.779999999995
46599,916.5
20300,50850.0
49069,8770.319999999996
101967,1349.4
38074,5966.700000000002
916092,2433.2
28526,6519.24
922370,742.5
100891,607.5
943618,1079.28
975028,5551.200000000001
930746,164553.69000000003
25519,615.2200000000001
994524,6719.76
915917,1642.5
938480,16002.0
906317,1674.0
997094,870.24
940083,1134.0
937023,828.0
928370,1350.0
73662,1168.0900000000001
926045,1209.6
984373,4050.0
926812,720.0
984128,325.44
943298,324.0
980086,155.88
24735,462.21000000000004
37189,270.0
985550,2997.0
100862,309.6
973343,125.88
928621,396.0
995276,351.0
944230,787.5
55068,32575.5
68036,1344223.1600000004
36304,953160.0
11786,665417.3000000002
34422,974358.0
89207,149760.0
10006,19998.159999999996
15940,260700.75
21206,90371.25
26586,307704.99999999994
28086,119849.38000000005
31656,33031.209999999985
34014,93627.53999999998
35316,45803.12
36989,132215.27999999997
4866,194258.25
5006,214593.75
65926,61649.29999999999
86250,12966.480000000005
88556,177329.25
37259,86950.5
46506,164345.26000000004
57122,11778.0
88118,22520.25
36970,200222.0
101512,16795.799999999996
81124,202470.66000000006
24451,14336.999999999996
43134,18643.5
42714,87245.12
987003,9702.0
4936,38156.65999999999
21687,41475.0
26974,11134.529999999993
49510,20962.5
27544,523330.5
77683,301552.04
46142,58498.15000000001
15627,3038113.8
28233,358899.75
52199,84637.5
74804,39347.25
16906,152010.0
27145,78661.66999999998
41316,24441.75
85425,57916.240000000005
987360,33048.72
88996,11700.0
928616,625.3199999999999
22026,26208.0
67309,14332.5
80058,14274.0
56664,7782.579999999997
26189,25878.840000000007
100803,8709.119999999995
922371,900.0
26105,2719.5
87636,3319.3400000000006
987281,1417.5
39532,1729.9099999999999
947946,4164.48
942462,1341.8999999999999
976751,630.0
941938,1070.1599999999999
38530,245.1
904696,1958.3999999999999
973420,282.12
962475,23224.32
85828,419.04
984195,675.0
952186,756.0
902192,607.5
975390,828.0
927425,724.5
921219,33525.0
964478,495.18
989961,1050.24
922374,28080.0
996267,2955.12
911468,810.0
965282,382.56
77889,235.22000000000003
972729,522.72
985986,57.12
15582,143350.18
16580,127200.0
21215,207867.0
22121,82517.25
34702,33673.6
40192,44250.0
49084,389527.17000000004
52314,54704.8
54706,17759.25
56195,68373.48000000003
64121,32514.0
68126,105920.25
75268,38808.0
88036,169446.37
88766,27962.010000000013
32233,92277.38
86487,12704.000000000002
89387,996215.2599999997
15621,95866.65000000001
32231,48851.55000000002
39250,12854.700000000003
43022,69083.13
65204,70098.29999999999
80398,227477.25000000003
86828,48200.23
64510,24532.5
15320,62100.0
19468,9676.799999999997
21986,14463.75
37416,15690.0
87849,82134.0
928193,12582.0
965185,5617.5
37937,18900.96
26150,55566.04
13036,11891.790000000003
5103,46070.07999999999
63505,35402.25
19021,57581.25000000001
24862,4095.0
72330,34398.0
19323,30577.5
75264,33795.0
77324,11385.0
66993,102007.5
84166,32152.5
27523,27060.0
43073,24108.75
101674,6727.5
27615,17415.0
37782,1914.0
906565,2358.75
26714,2894.460000000001
88102,11412.0
43895,8652.0
928821,504.0
87270,15156.959999999997
73074,574.89
904161,2256.48
80573,9.75
37275,1333.28
951421,2052.0
978243,1152.0
980548,115.2
965076,162.0
902613,647.64
965986,2520.0
905316,3149.58
39704,221.82
33569,603.0
4532,1124.85
984135,128.64
986175,1215.0
985783,643.5
972101,234.0
986471,233.46
928691,210.0
946408,235.56
916269,792.0
944202,1710.0
985348,384.06
916334,423.0
25608,1371486.6
57210,75885.0
88355,128536.98000000001
10836,157683.53
16516,41792.52
22215,1466267.25
39917,29034.0
43126,567726.84
43747,48972.779999999984
48247,279083.20000000007
41688,36562.5
58876,11026.35
72928,151965.37000000005
965269,15800.399999999998
48099,1104352.4799999993
34029,425375.8600000001
85437,50523.75
5753,37080.0
84230,18034.199999999997
69604,5790.0
47861,193279.51999999996
16307,78030.0
22376,10263.75
27197,17432.58000000001
5596,23190.0
32462,24063.0
39186,2923.1
64854,37405.5
26844,31308.75
40071,55560.0
4367,84510.0
915654,4318.26
67174,1500.0
965072,1026.24
43797,68931.0
75181,84524.0
86692,359124.15000000
Query:
-- 4. Calculate total sales revenue per item in 2022
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "item_number"
LIMIT 1000
Answer:
Too long, hard cut:
item_number,total_sales_2022
43338,2602557.0
64866,1973484.0
8828,285727.9799999999
58908,17291.4
86390,84291.20000000001
37888,204000.0
11294,962722.5199999998
33256,33651.149999999994
34052,115123.2
36976,57039.47
37233,105964.5
40656,25600.15000000001
43244,218758.62999999998
43501,81062.52000000002
55106,24418.8
64348,81666.74
64776,734955.4400000001
78071,73871.45999999999
76843,53291.25
82606,81810.26000000001
82780,48304.149999999994
26851,9384.460000000003
36874,353424.04
69709,11910.0
80371,49014.29
19062,57395.1
41703,18416.100000000002
5842,93207.93000000001
26737,15841.250000000002
65556,9195.839999999998
86139,57755.88000000002
88947,6265.0
43728,5370.0
34747,64212.79999999999
18116,54034.5
68611,34376.42
80096,30976.280000000002
73054,118725.0
8827,56033.64
17087,226316.80000000005
55084,23318.749999999993
24453,17558.75
64356,20567.22
63124,17208.75
59288,714.0
88120,9157.5
903892,14287.5
19905,8767.5
27012,1957.5
922046,6412.5
101276,15319.209999999995
990305,792.0
101766,10350.0
926508,2430.0
978294,5187.0
916715,2076.3
977443,11182.5
915860,2698.38
32464,4290.0
72526,850.5
14524,371.48
25388,6240.0
922187,270.0
35109,4259.150000000001
64266,832.26
915920,2835.0
999936,17712.0
80700,2432.859999999999
987296,756.0
921916,270.0
32819,1665.0
951854,792.0
100216,256.31
905195,1416.48
4358,2925.72
985535,810.51
59173,1468.5
903998,283.5
978242,288.0
919000,9020.88
988280,1007.76
988831,269.1
925169,302.4
988912,564.0
901365,151.56
985685,5400.0
976548,153.0
928312,345.12
976367,180.0
994722,135.0
951550,56.25
100862,29876.400000000005
72979,1136.25
78292,62551.80000000002
80451,4680.0
16416,93676.5
20300,66881.25
4246,34159.22
5555,192177.20000000004
56206,28982.25
76413,203859.75
43127,1000179.0
82147,40005.0
100737,17063.239999999998
88356,10739.25
58838,880270.9499999995
77698,52689.28000000001
12404,50028.76
89519,27426.0
89644,97563.0
903203,23152.5
15622,15819.590000000004
34566,20325.0
24466,29102.129999999997
30528,52012.079999999994
45217,50881.600000000006
965815,5120.61
77487,860255.7600000001
930746,113883.83999999998
49069,48124.319999999985
12858,31706.25
38089,27228.799999999992
26665,31811.460000000003
67534,21622.15
58866,16257.78
82610,54089.8
39466,27603.75
928370,1124.82
34036,132526.58999999997
900606,10125.0
25519,2962.7700000000013
39622,11014.919999999998
73533,18859.780000000002
902256,13891.5
39026,1890.0
73662,2678.06
21211,17385.0
997094,1305.3600000000001
35356,2983.01
664,42.75
916092,3754.08
24735,1584.7199999999998
86562,855.0
904781,830.25
922370,247.5
43409,5714.25
46599,1611.0
940082,3732.0
995276,1053.0
100891,2077.5
87178,5175.0
921554,1845.84
938480,12096.0
951698,136.56
940083,1242.0
89590,769.5
943684,1524.24
905734,336.78
915917,985.5
76850,1210.26
984373,307.5
937023,1242.0
926045,1209.6
926812,1192.2
905186,271.38
26463,33.75
943618,539.64
943298,162.0
903620,115.56
88298,185503.5
36878,55406.40000000001
35626,102716.25
45275,63756.0
45886,267915.0
80419,2666.25
80423,6997.5
37993,148159.47
13928,17671.5
30058,74971.5
77318,75619.5
34007,957106.9299999999
926248,3341.5199999999995
933938,675.0
39320,17842.779999999995
76069,25894.439999999988
71529,16884.0
33110,34762.5
43641,37886.25
43735,59192.64000000001
78231,13701.870000000003
88818,5832.0
89233,36135.54000000001
10624,21444.75
26063,14422.5
43296,44577.0
66994,25042.5
39763,3469.2199999999993
27380,248835.62999999995
68080,29526.0
32460,23685.0
38494,20211.75
101473,6579.000000000001
80443,519.75
88984,18321.53999999999
29997,22882.680000000004
87647,230635.5
65126,353898.0
88285,52266.51000000002
19475,84154.0
922273,2925.0
27171,31800.0
39322,72088.5
15539,19287.25
87266,33201.00000000001
101292,16372.5
16514,3585.4499999999994
80445,4312.5
938030,456.0
88015,10126.5
42204,16212.199999999993
87579,16350.0
903124,3700.6400000000003
63261,8322.569999999998
49509,16686.0
958875,3434.4
100759,6264.0
26447,2490.0
14530,489.9
76844,3240.0
52559,4491.66
57630,5169.5999999999985
101773,5557.5
73069,420.0
968888,1079.28
26231,509.6
904611,855.0
902533,135.0
40186,1046.25
985683,2700.0
6032,444.4
904522,3780.0
903563,135.0
965112,171.48
964424,285.12
964558,1344.48
23828,544537.0199999999
49188,65768.97
56856,35406.8
57158,31151.25
57174,114055.5
58913,107239.80000000003
59192,40405.98
63959,10510.079999999996
19067,961233.0
64867,1857777.2100000007
77632,124344.72
40313,20788.5
918010,75348.0
48105,2196215.5599999996
14516,14186.400000000005
26814,64980.0
27461,8416.289999999997
77852,92788.09999999998
86885,155294.5
918380,18481.319999999996
48102,197864.1
16075,17066.25
74836,13912.5
6214,2730.0
89824,38130.0
85987,1746.0
26205,22230.16999999999
25113,36300.0
45887,70626.98999999999
100413,1198384.2
34839,9264.0
89836,364340.25
76505,73711.5
88548,474398.25
67158,26965.379999999997
63259,3557.2500000000005
34605,13072.5
89339,80340.0
62120,13351.5
76373,12383.999999999998
64913,23804.199999999997
994529,11020.099999999997
39611,11874.719999999998
57632,5169.5999999999985
26611,22068.959999999995
39299
Query:
-- 5. Find the top 10 items by total sales revenue in 2023
SELECT "item_number", SUM("sale_dollars") AS "total_sales"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
ORDER BY "total_sales" DESC
LIMIT 10
Answer:
item_number,total_sales
38178,11393245.5
38177,10001010.239999996
11788,8560030.739999996
1799,7061536.239999999
38176,6565380.0
88296,5252856.0
43337,5014554.569999999
65013,4394133.45
10807,3787875.1999999993
10802,3705297.9199999995
Query:
-- 6. Calculate total bottles sold per item in 2023
SELECT "item_number", SUM("bottles_sold") AS "total_bottles_sold_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "item_number"
LIMIT 1000
Answer:
Too long, hard cut:
item_number,total_bottles_sold_2023
78292,2615
80308,184
38089,17826
21256,610
39026,51
5555,4418
76413,15646
900606,72
43127,71291
88267,2255
89644,5539
34036,9122
39466,2246
77698,3840
89519,1074
58838,61709
12404,18097
42166,843
44175,396
73253,1400
34566,826
100737,1123
16416,4262
4246,593
15622,8775
82147,5603
35356,1064
12858,1640
30528,3769
56206,2809
20300,904
88356,842
39424,1125
902256,1055
67534,809
21211,1300
76850,402
940082,252
24466,4007
85981,354
39622,697
58866,2072
82610,3364
26665,1129
45217,12815
77487,148676
903203,1235
100865,1086
80451,163
19461,360
101967,60
975028,240
49069,78
28526,199
943618,72
46599,58
87178,87
922370,18
965815,202
38074,885
100891,18
37784,274
916092,70
928370,72
25519,38
938480,1524
24735,21
984128,96
100862,4
928621,8
73662,41
930746,8331
915917,30
995276,6
940083,54
984373,540
926812,24
926045,24
997094,24
937023,24
994524,24
906317,18
985550,300
980086,12
943298,12
37189,6
944230,6
973343,12
15621,5630
19021,4625
32231,9869
39250,1863
43022,8137
65204,9942
80398,17325
86828,3671
64510,3271
40192,7375
56195,14156
15320,276
16580,2827
19468,630
21215,12598
21986,707
22121,4429
24862,65
37416,2092
52314,11210
88766,2799
928193,233
965185,214
87849,2018
37937,2704
32233,30862
15582,9464
19323,302
26150,2246
34702,3095
88036,14895
84166,2858
13036,1861
68126,7433
5103,992
63505,3631
89387,79492
26714,57
75268,1848
49084,17101
72330,1764
75264,2253
77324,690
66993,3886
27523,451
27615,1290
64121,1145
54706,2631
43073,2041
86487,3970
37782,116
906565,17
43895,206
87270,340
101674,299
928821,12
88102,634
73074,7
904161,48
916269,12
37275,968
984135,96
944202,12
39704,31
951421,36
916334,6
33569,30
985348,6
965986,84
80573,5
4532,15
978243,96
965076,6
905316,42
980548,6
902613,36
928691,6
946408,6
985783,6
986471,6
986175,18
972101,12
26172,2659
53211,5356
87054,648
36968,64656
49185,26336
87402,41560
16096,11061
4111,247
6076,766
89139,2219
920374,1805
87194,1693
922188,24
73558,757
35418,9469
72505,1391
4867,6747
11346,13696
88511,249
910882,617
37356,18663
15852,165
80236,7867
89665,578
40191,5044
28481,893
83370,2909
89230,2017
965266,3438
66522,2733
87646,4612
8825,2134
16281,144
75604,173
20248,18511
38091,1213
35948,40896
64149,3660
974829,312
67610,2306
88458,392
34154,739
21296,255
62816,374
964531,30
85550,434
936859,71784
14467,437
57631,183
101950,238
902667,6
73000,48
15895,558
905829,36
15465,260
84373,279
63563,134
21798,359
987155,6
25251,44
937053,1158
42201,58
915804,30
922378,6
101706,50
928002,36
37167,35
928650,48
916619,6
922290,1560
944177,18
38563,6
937792,12
926233,24
943681,36
915996,12
930710,6
934886,12
992136,1
984194,24
943705,6
44160,3
915495,6
36308,208363
28275,13005
86668,11104
86883,11005
47869,81
5136,349
5446,3076
68100,1875
88931,179
42717,106977
45277,26237
53214,94700
65963,137
10008,10312
102040,1315
86019,21514
16850,15564
39922,6766
80545,1138
87225,283
67551,50
80358,683
927516,120
78113,1120
62787,280
994851,12
38046,2887
38225,1496
87410,8200
18358,816
31658,14686
904759,1158
102092,15535
73588,1205
87369,1219
100605,60
51156,1040
44340,9929
89887,7984
28795,1695
36531,1146
21208,625
6107,938
89445,4272
85788,464
951745,30
34436,28
89535,1105
943791,2
67044,80
901271,30
995915,72
903764,21
73896,34
997100,114
977237,2
902833,18
59283,282
66262,85
44184,91
918852,24
966872,6
86830,62
941843,48
916664,201
951594,12
985693,120
72978,29
994449,6
16237,7
902840,42
964530,6
942404,36
926337,120
916071,30
921213,12
985369,9
965424,12
915194,156
911216,18
928270,282
906332,6
928653,12
903995,12
987904,12
87579,730
101473,186
39320,1634
76069,741
37993,35622
88285,10188
71529,1680
38790,671
17207,5629
19475,5782
26231,10
27380,3646
35626,9463
43735,1561
65126,11251
78231,595
88984,122
89233,1072
10624,2658
33110,1319
39322,6585
45886,15292
34007,37305
39763,63
10778,12365
30058,8125
32460,1022
43641,814
66994,1711
13928,1134
68080,823
26063,49
27171,1342
87266,550
45275,9385
77318,4194
36878,4915
38494,1240
42204,1158
88298,2318
87647,14249
903124,553
29997,3210
52559,374
101292,38
15539,425
80423,446
976559,84
926248,354
958875,30
63261,29
33696,132
938030,42
80419,307
995568,12
88818,167
999921,42
38782,282
57630,1
965112,30
985906,12
88015,25
80445,21
904611,48
964558,12
904522,24
916001,12
73069,1
918617,6
901636,12
973339,12
964424,12
76500,1380
10788,5412
33466,3426
46550,1797
34423,21866
47865,9005
50686,4813
72382,423
73986,16209
77740,16297
77858,12395
79966,1333
80365,12752
917527,1945
922042,246
34030,18474
17915,2722
17106,107
26855,250
36769,3965
80362,8601
28868,16737
81207,11363
48164,3620
73762,2213
101247,30
26474,4082
21464,3809
39648,734
86673,2638
59646,528
26010,855
88172,443
22156,19550
985347,39
87050,5823
80488,2847
48107,18705
14208,1873
12860,6798
46146,3174
33665,1099
88361,162
80458,12162
77994,3145
44217,29360
59101,871
911475,120
100954,2225
26625,86
87872,429
21228,23
26185,343
85643,339
85826,22
28033,59
905274,30
915257,592
17210,370
39174,201
14845,114
988839,6
76563,120
903560,48
905613,78
985290
Query:
-- 7. Calculate total bottles sold per item in 2022
SELECT "item_number", SUM("bottles_sold") AS "total_bottles_sold_2022"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "item_number"
LIMIT 1000
Answer:
Too long, hard cut:
item_number,total_bottles_sold_2022
30528,4806
58838,67145
43127,70188
45217,8624
77487,118167
34036,8841
100862,386
72979,101
78292,5580
12404,15647
16416,4626
20300,1189
49069,428
56206,3513
76413,10581
15622,2641
24735,72
5555,3376
902256,1029
24466,3519
39622,558
77698,4256
82147,5334
89519,952
21211,610
34566,1355
38089,20320
82610,4580
80451,520
67534,1085
39466,2165
89644,3826
12858,1691
4246,928
35356,199
26665,1542
73533,1178
903203,2058
73662,94
100737,474
997094,36
900606,90
25519,183
88356,387
58866,2346
664,3
916092,108
965815,263
39026,63
922370,6
43409,401
86562,19
930746,6048
928370,60
904781,123
995276,18
46599,86
100891,64
940082,174
915917,18
76850,46
87178,92
938480,1152
984373,41
921554,24
926812,30
940083,48
89590,18
951698,6
905734,6
943684,24
926045,24
937023,36
903620,12
943618,36
943298,6
905186,6
26463,1
35918,79522
28081,2094
49189,53152
18613,736
26710,4811
39866,4441
67905,1187
86559,5615
88186,22863
43026,47662
74688,304
12467,1599
41705,7835
33663,6725
71886,3016
80363,10116
66259,180
77774,4411
4044,1104
77367,2177
10789,6570
10625,2875
5362,1159
63355,3122
74807,838
26573,366
101183,288
101347,1457
902291,668
558,1539
15739,2298
4616,1706
86916,6127
68846,4644
911010,6
15945,481
903037,980
101600,5601
72395,978
72983,73
951744,60
12886,337
962476,14688
87112,617
64279,60
921806,9
25153,93
5744,90
916445,1092
29772,31
65745,49
68207,114
4949,39
985777,3
943634,24
977230,48
926425,444
902729,30
987841,20
27877,71
76432,48
928466,18
977235,42
43894,3
968848,48
978104,42
995232,12
966580,24
972415,12
967037,5
19471,1604
26164,1407
38575,3987
43121,18934
75218,5265
19063,16823
63319,12446
69722,148
43860,3792
6206,999
75197,3003
82626,4665
926618,45
100939,614
84219,62415
19226,18050
64409,320
38178,374035
43120,30062
57157,5999
11347,3055
22157,9825
22786,5954
34821,62457
101306,594
20368,1203
26496,505
918530,57
83357,1844
101763,343
80686,3066
80130,2083
59185,2161
30236,4483
40500,12278
6997,1498
19028,1674
87481,1146
80826,3601
58886,10923
30057,4585
62811,193
101545,251
26787,169
62610,67
86606,437
26125,498
63372,70
915673,152
26217,248
80422,6
17186,334
87722,233
902086,126
86560,196
928648,394
964304,18
3354,10
944088,12
965073,54
904556,24
951549,18
964464,36
14531,110
942305,18
989320,3
910933,12
943878,48
986771,18
946302,564
949984,60
975940,12
943683,12
910855,12
902046,12
100815,2289
101710,508
75212,13030
76412,6557
88728,410
54647,6112
17956,40093
32235,4932
35416,11012
65066,7196
72732,2666
77231,1586
58840,3242
51326,1686
902029,579
58860,8563
17194,1059
19227,1584
9432,1177
68127,3224
19070,22948
19250,438
65453,46
900793,36
89199,41263
25166,307
73065,11940
15206,310
19017,3648
42167,1760
86604,710
86463,325
68584,997
78247,45
65750,4929
101100,143
101614,655
39412,164
926684,6522
87898,106
88123,484
85849,609
966390,24
919218,360
948361,30
87057,11
995513,24
911074,7
936749,360
904965,12
904682,36
907705,18
988830,48
985698,12
904517,12
964634,24
922897,6
36901,15423
39245,985
84143,6190
84207,15810
67522,1469
84102,2389
17086,44729
23536,728
25079,1282
36576,6184
39029,1605
65451,600
82820,6179
87172,124
916492,30
87025,570
919320,144
904844,546
28236,19756
65416,2585
73754,2341
903707,305
999931,12
38058,12405
34244,1870
18006,50406
64736,5636
34819,2275
21226,628
89136,175
72945,187
21836,502
29410,132
86582,1396
39352,1117
89177,16958
82636,6769
37934,9443
59037,15944
87513,1416
27188,451
77699,7809
927114,181
89504,338
88633,537
39282,2618
41209,3069
76409,1832
915635,24
902570,114
962093,6480
26758,623
39601,550
964076,96
26220,62
90039,175
943803,60
87684,149
25517,114
18997,87
985669,6
37968,267
995096,44
916701,15
972958,144
925016,18
37105,96
64559,43
928485,46
906532,7
905653,12
902497,60
906067,18
916018,18
972434,288
966770,72
915747,12
947033,12
3233,4
904859,6
917562,12
6024,16
987039,30
988352,6
26160,1316
27618,1089
64774,2892
86669,13848
21212,134
28866,26638
42566,2809
5318,2366
64136,21521
998917,75
34155,8397
36390,466
41670,4388
36668,2782
43848,4661
39255,1657
63345,5506
67266,5356
67296,1076
84159,2595
17766,7740
47649,239
51158,1084
86990,1442
34162,1385
904581,258
941467,960
35628,5411
58877,1905
57051,11062
101841,54
27016,4442
43025,27092
34164,5191
77647,4313
87043,13585
77055,13530
11940,3381
36305,129877
28617,2200
6075,174
36908,59903
966122,938
57129,9692
61215,179
33660,872
65457,508
17659,574
932650,1073
926093,1020
24856,51
37578,309
89235,999
87102,219
18672,280
53814,89
65456,54
904988,12
73149,10
987956,24
943382,12
965288,42
995735,24
943435,72
995516,6
951696,84
918217,234
943827,6
995774,12
926468,24
985933,300
39118,5
988253,6
101561,4
977331,6
34001,19532
24860,836
86544,1496
87509,12292
19066,82042
25616,9898
26096,1903
27125,9079
2849,308
28886,3122
37040,1100
87136,277
910839,228
39699,906
39825,7613
40053,25840
86018,6171
82600,1268
67037,470
82827,2640
87499,1054
5430,1449
100429,109
101770,2406
65144,4400
917510,204
36875,59641
15244,3111
2229,4817
47786,9247
89787,6524
965344,6576
987082,461
17929,190
84192
Query:
-- 8. Identify items sold in 2023 but not in 2022
SELECT DISTINCT "item_number"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
AND "item_number" NOT IN (
  SELECT DISTINCT "item_number"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
)
LIMIT 1000
Answer:
Too long, hard cut:
item_number
88530
27462
988206
101819
66524
84214
89584
57637
65627
25028
37144
932819
990742
917210
929820
939176
985726
926266
988207
985839
85643
911475
21228
14845
17106
910776
46550
80362
59646
39174
17210
985347
916218
972096
85826
901954
988839
905613
905274
917632
932474
985290
994806
76563
924923
951154
17020
84135
19325
102086
922263
906129
6164
73256
85490
84388
57633
16305
59550
917625
922208
66995
56948
975261
985532
928498
926581
926751
925026
928603
917337
941848
906260
64352
53853
102149
103106
989346
102069
922390
918011
926294
967605
984216
22488
22447
66932
76239
16275
4031
65527
22071
25121
995939
102228
901993
21068
966726
990043
978198
988990
986035
924921
937664
926150
904329
906100
994739
922430
985748
926931
974486
916347
980523
76704
26572
22460
804
16619
68625
102013
922261
76841
72434
949780
969596
903151
985996
901891
951591
988102
905874
966388
928271
916150
76830
68623
88641
27516
15934
85982
57324
86198
28607
987121
89488
906087
21672
994652
87991
931296
86175
972133
980445
944634
965423
989590
965428
987802
985419
966474
951070
989622
964620
998074
904854
916468
100948
21671
22496
76425
102031
976741
61706
925303
67612
18390
62788
102042
15451
102100
76238
918288
925019
964390
905779
951593
986061
965970
928538
923060
73559
22249
973539
21493
66833
76831
21064
59281
84277
904362
972543
966567
63089
101712
926614
33427
942851
988939
938771
976200
66959
37959
78187
21067
85536
101971
46688
22389
915449
903475
915807
87483
972752
905118
989234
947806
921640
932530
925473
22289
59534
28321
35464
86973
988453
88803
85711
73120
985534
21235
925934
31599
996274
76825
938645
989650
926478
916841
988703
985368
85388
100443
58972
19501
63213
37712
78186
85331
925182
22406
921244
26354
86020
922180
965483
972955
916337
985959
943728
931167
977199
922544
994256
976717
85451
101209
4476
18400
38813
951584
85712
987930
974840
965823
76712
77980
101942
976079
925567
915550
939123
928473
987059
973122
985370
905755
915500
999940
67032
25940
18424
101989
102096
23063
24861
22262
66097
990071
76755
62515
915855
76901
902813
14846
965964
986345
901822
945995
987833
987442
67607
89580
76220
85665
33430
78245
934498
88528
986623
19457
76466
985825
966123
990015
928822
905433
38792
902213
6281
17921
916221
10777
88524
902082
928441
85965
944106
926052
976831
937577
915604
37780
918286
929828
988076
906576
944232
998071
965367
916135
63851
918381
25999
19065
87039
80309
101988
85588
44195
86007
10856
71615
22375
6100
34238
15448
965957
985631
985853
987218
915505
922402
901885
965071
987136
967279
927324
80364
932652
102027
68620
76900
85545
101648
37781
87355
20165
25293
986782
973894
938770
926389
982656
941179
985756
38828
37857
25068
76262
64334
964543
915447
86471
924475
939442
66127
86423
22382
85943
988687
978112
905778
928539
29782
985487
905682
972706
984132
987156
925114
909265
919878
102061
14465
926804
25949
57575
10858
76829
42715
73891
59536
973721
976796
965516
989765
987406
904215
944072
910470
988077
942265
76261
69939
23539
28012
67676
985843
59049
988401
37692
24859
939721
984214
925215
915767
922493
902766
977055
932662
973917
986043
935677
59219
102057
37982
21242
65737
22513
24999
102012
28485
77332
976689
85901
986536
967617
925467
921024
924890
922471
69718
101527
51000
76753
985499
16260
985908
80129
966292
926055
928345
921452
927662
916029
985256
986450
937640
985517
942171
4457
89155
21462
974304
921865
945903
65533
2834
76679
19564
987793
984399
20494
27999
26970
4828
934598
967317
994496
987483
951589
906374
976702
972131
63834
25936
57343
101677
19000
10776
20304
80240
35676
68624
85346
985795
920118
980455
947325
916336
4797
916068
985987
987680
915896
987797
31538
990062
102077
38795
88543
25039
25059
67220
26975
916308
72706
972095
905974
66631
59285
951302
965090
905339
964131
944179
967207
987799
986161
951138
990225
995560
952324
17207
33696
10778
38790
38782
976559
999921
916001
995568
973339
918617
901636
985906
102037
78191
906564
28601
925013
62514
73199
37952
22069
17089
951601
976698
945320
986560
962040
925015
922450
910874
943991
49465
22279
17093
101943
984390
918568
101765
101521
88730
966019
85596
977989
89679
951065
14205
17107
988482
85742
951700
984140
915443
985349
905780
22376
57325
78212
16307
944635
48247
976742
57210
67085
42301
102025
67174
992167
923327
921022
987032
986050
986228
915420
996241
980546
968296
988007
101554
85683
88936
67420
85710
100490
999922
73254
948245
22419
966665
926217
942800
916238
987389
984394
916335
967269
977778
916199
987679
65963
85788
927516
68100
102092
951745
62787
44184
67044
73588
6107
87225
67551
73896
80358
102040
987904
941843
59283
943791
965424
911216
951594
906332
921213
966872
985693
915194
902833
928270
985369
926337
62041
68622
68024
980032
933181
915421
57327
995567
28539
972889
85329
38781
920487
913730
973079
63044
906367
995752
937747
102011
88514
80546
15789
102036
16466
985675
85482
918384
101768
76424
66726
67036
921259
987033
25242
59551
987312
965332
962138
984370
988091
951298
928422
980
Query:
-- 9. List distinct categories and their names
SELECT DISTINCT "category", "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Answer:
category,category_name
1011800.0,IOWA DISTILLERY WHISKIES
1081300.0,AMERICAN CORDIALS & LIQUEURS
1012100.0,CANADIAN WHISKIES
1022100.0,TEQUILA
1081335.0,RASPBERRY SCHNAPPS
1051140.0,PEACH BRANDIES
1081000.0,AMERICAN CORDIALS & LIQUEURS
1091300.0,
1012300.0,IRISH WHISKIES
1062050.0,BARBADOS RUM
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1022300.0,
1082000.0,IMPORTED CORDIALS & LIQUEURS
1011200.0,STRAIGHT BOURBON WHISKIES
1032100.0,IMPORTED VODKAS
1081020.0,ANISETTE
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1011000.0,AMERICAN WHISKIES
1701200.0,HOLIDAY VAP
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1081600.0,WHISKEY LIQUEUR
1051100.0,APRICOT BRANDIES
1012400.0,JAPANESE WHISKY
1041100.0,AMERICAN DRY GINS
1051110.0,BLACKBERRY BRANDIES
1081380.0,MISCELLANEOUS SCHNAPPS
1081340.0,ROOT BEER SCHNAPPS
1081100.0,
1012300.0,SINGLE MALT SCOTCH
1062200.0,WHITE RUM
1052100.0,IMPORTED BRANDIES
1082200.0,IMPORTED SCHNAPPS
1041200.0,AMERICAN SLOE GINS
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1701100.0,DECANTERS & SPECIALTY PACKAGES
1091200.0,NEUTRAL GRAIN SPIRITS
1071000.0,COCKTAILS/RTD
1900000.0,DELISTED / SPECIAL ORDER ITEMS
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1031100.0,AMERICAN VODKAS
1081390.0,IMPORTED SCHNAPPS
101220.0,
1032100.0,
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1012400.0,IRISH WHISKIES
1082015.0,IMPORTED AMARETTO
1031080.0,VODKA 80 PROOF
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1011700.0,
1022300.0,MEZCAL
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1081250.0,WHITE CREME DE MENTHE
1081500.0,ROCK & RYE
1051010.0,AMERICAN GRAPE BRANDIES
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1031200.0,AMERICAN FLAVORED VODKA
1081220.0,DARK CREME DE CACAO
1070000.0,COCKTAILS/RTD
1011600.0,CORN WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1091400.0,IOWA DISTILLERIES
1062300.0,AGED DARK RUM
1081200.0,CREAM LIQUEURS
1070100.0,TEMPORARY & SPECIALTY PACKAGES
1062250.0,
1901200.0,SPECIAL ORDER ITEMS
1031110.0,LOW PROOF VODKA
1012000.0,IMPORTED WHISKIES
1071100.0,COCKTAILS/RTD
1081010.0,AMERICAN AMARETTO
1011500.0,BOTTLED IN BOND BOURBON
1052010.0,IMPORTED GRAPE BRANDIES
1089290.0,
1032080.0,IMPORTED VODKAS
1082010.0,AMARETTO - IMPORTED
1042000.0,IMPORTED GINS
1011700.0,CORN WHISKIES
1032200.0,IMPORTED VODKA - MISC
1011300.0,SINGLE BARREL BOURBON WHISKIES
1081015.0,IMPORTED AMARETTO
1081300.0,PEPPERMINT SCHNAPPS
1032230.0,IMPORTED VODKA - CHERRY
1012210.0,SINGLE MALT SCOTCH
1081312.0,BUTTERSCOTCH SCHNAPPS
1041150.0,FLAVORED GINS
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED
1081700.0,DISTILLED SPIRITS SPECIALTY
1081355.0,STRAWBERRY SCHNAPPS
1081400.0,AMERICAN SCHNAPPS
1081500.0,TRIPLE SEC
1062400.0,
1081210.0,CREME DE ALMOND
,
1081100.0,COFFEE LIQUEURS
1062100.0,JAMAICA RUM
1091200.0,
1011500.0,STRAIGHT RYE WHISKIES
1901000.0,SPECIAL ORDER ITEMS
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1051150.0,MISCELLANEOUS  BRANDIES
1062400.0,SPICED RUM
1051100.0,AMERICAN BRANDIES
1081365.0,TROPICAL FRUIT SCHNAPPS
1092100.0,
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES
1082200.0,
1031200.0,VODKA FLAVORED
1101100.0,AMERICAN ALCOHOL
1031000.0,AMERICAN VODKAS
1081370.0,WATERMELON SCHNAPPS
1090000.0,DISTILLED SPIRITS SPECIALTY
1081350.0,SPEARMINT SCHNAPPS
1052100.0,
1032000.0,IMPORTED VODKAS
1011400.0,BOTTLED IN BOND BOURBON
1091100.0,
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1082390.0,SCHNAPPS - IMPORTED
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM
1081317.0,GRAPE SCHNAPPS
1042100.0,IMPORTED DRY GINS
1062300.0,FLAVORED RUM
1082100.0,IMPORTED CORDIALS & LIQUEURS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1081240.0,GREEN CREME DE MENTHE
1022100.0,MIXTO TEQUILA
1062310.0,SPICED RUM
1062500.0,FLAVORED RUM
1901100.0,DELISTED ITEMS
1031100.0,100 PROOF VODKA
1062100.0,GOLD RUM
1082300.0,SCHNAPPS - IMPORTED
Query:
-- 10. Calculate total sales revenue per category in 2023
SELECT "category", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "category"
LIMIT 1000
Answer:
category,total_sales_2023
1082200.0,6119548.080000001
1701100.0,9509374.330000002
1011300.0,2276485.09
1091300.0,3688622.360000001
1011100.0,10723238.490000004
1092000.0,26889.339999999997
1011200.0,38677699.67
1081300.0,4354246.45
1032000.0,7874.62
1092100.0,2543429.1300000004
1012300.0,4367603.44
1032100.0,11963818.330000004
1031100.0,67338842.36999999
1081400.0,7306666.690000001
1062500.0,8309968.749999998
1011700.0,251152.56999999995
1031200.0,11816546.34
1041300.0,27100.260000000013
1091200.0,600076.2899999998
1062100.0,1039397.7799999999
1081600.0,26535647.129999995
1062400.0,23179414.500000004
1041100.0,3322886.720000001
1081200.0,8449040.209999999
1012200.0,5822671.240000002
1062200.0,5898568.830000001
1011400.0,16801219.220000003
1051100.0,4696783.27
1091100.0,2128590.9899999998
1042100.0,5366126.899999999
1071000.0,7888568.39
1081100.0,2199223.939999999
1901000.0,1355413.5500000003
1082100.0,12453635.24
1022100.0,11331074.050000008
1032200.0,4647635.529999999
1062300.0,1020934.2299999997
1081000.0,15682.740000000002
1082000.0,48065.44
1041200.0,984554.94
1011600.0,4652360.48
1081500.0,871320.69
1022300.0,528416.5499999999
1011500.0,1267438.1300000001
1012100.0,50361823.690000005
1052100.0,11192039.439999998
1022200.0,32323236.840000004
1012400.0,9779709.26
Query:
-- 11. Retrieve a list of sale dates to examine date ranges
SELECT DISTINCT "date"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
ORDER BY "date" DESC
LIMIT 1000
Answer:
Too long, hard cut:
date
2024-09-30
2024-09-29
2024-09-27
2024-09-26
2024-09-25
2024-09-24
2024-09-23
2024-09-22
2024-09-20
2024-09-19
2024-09-18
2024-09-17
2024-09-16
2024-09-15
2024-09-13
2024-09-12
2024-09-11
2024-09-10
2024-09-09
2024-09-08
2024-09-06
2024-09-05
2024-09-04
2024-09-03
2024-09-02
2024-08-30
2024-08-29
2024-08-28
2024-08-27
2024-08-26
2024-08-25
2024-08-23
2024-08-22
2024-08-21
2024-08-20
2024-08-19
2024-08-18
2024-08-16
2024-08-15
2024-08-14
2024-08-13
2024-08-12
2024-08-11
2024-08-09
2024-08-08
2024-08-07
2024-08-06
2024-08-05
2024-08-04
2024-08-02
2024-08-01
2024-07-31
2024-07-30
2024-07-29
2024-07-28
2024-07-26
2024-07-25
2024-07-24
2024-07-23
2024-07-22
2024-07-21
2024-07-20
2024-07-19
2024-07-18
2024-07-17
2024-07-16
2024-07-15
2024-07-14
2024-07-12
2024-07-11
2024-07-10
2024-07-09
2024-07-08
2024-07-07
2024-07-06
2024-07-05
2024-07-04
2024-07-03
2024-07-02
2024-07-01
2024-06-30
2024-06-29
2024-06-28
2024-06-27
2024-06-26
2024-06-25
2024-06-24
2024-06-23
2024-06-21
2024-06-20
2024-06-19
2024-06-18
2024-06-17
2024-06-16
2024-06-14
2024-06-13
2024-06-12
2024-06-11
2024-06-10
2024-06-09
2024-06-07
2024-06-06
2024-06-05
2024-06-04
2024-06-03
2024-06-02
2024-06-01
2024-05-31
2024-05-30
2024-05-29
2024-05-28
2024-05-27
2024-05-25
2024-05-24
2024-05-23
2024-05-22
2024-05-21
2024-05-20
2024-05-19
2024-05-17
2024-05-16
2024-05-15
2024-05-14
2024-05-13
2024-05-12
2024-05-11
2024-05-10
2024-05-09
2024-05-08
2024-05-07
2024-05-06
2024-05-03
2024-05-02
2024-05-01
2024-04-30
2024-04-29
2024-04-28
2024-04-26
2024-04-25
2024-04-24
2024-04-23
2024-04-22
2024-04-21
2024-04-19
2024-04-18
2024-04-17
2024-04-16
2024-04-15
2024-04-14
2024-04-12
2024-04-11
2024-04-10
2024-04-09
2024-04-08
2024-04-05
2024-04-04
2024-04-03
2024-04-02
2024-04-01
2024-03-29
2024-03-28
2024-03-27
2024-03-26
2024-03-25
2024-03-24
2024-03-22
2024-03-21
2024-03-20
2024-03-19
2024-03-18
2024-03-17
2024-03-15
2024-03-14
2024-03-13
2024-03-12
2024-03-11
2024-03-10
2024-03-08
2024-03-07
2024-03-06
2024-03-05
2024-03-04
2024-03-03
2024-03-01
2024-02-29
2024-02-28
2024-02-27
2024-02-26
2024-02-25
2024-02-23
2024-02-22
2024-02-21
2024-02-20
2024-02-19
2024-02-18
2024-02-16
2024-02-15
2024-02-14
2024-02-13
2024-02-12
2024-02-11
2024-02-09
2024-02-08
2024-02-07
2024-02-06
2024-02-05
2024-02-04
2024-02-02
2024-02-01
2024-01-31
2024-01-30
2024-01-29
2024-01-28
2024-01-26
2024-01-25
2024-01-24
2024-01-23
2024-01-22
2024-01-21
2024-01-19
2024-01-18
2024-01-17
2024-01-16
2024-01-15
2024-01-14
2024-01-12
2024-01-11
2024-01-10
2024-01-09
2024-01-08
2024-01-07
2024-01-05
2024-01-04
2024-01-03
2024-01-02
2024-01-01
2023-12-30
2023-12-29
2023-12-28
2023-12-27
2023-12-26
2023-12-22
2023-12-21
2023-12-20
2023-12-19
2023-12-18
2023-12-16
2023-12-15
2023-12-14
2023-12-13
2023-12-12
2023-12-11
2023-12-10
2023-12-09
2023-12-08
2023-12-07
2023-12-06
2023-12-05
2023-12-04
2023-12-03
2023-12-01
2023-11-30
2023-11-29
2023-11-28
2023-11-27
2023-11-26
2023-11-25
2023-11-24
2023-11-23
2023-11-22
2023-11-21
2023-11-20
2023-11-19
2023-11-18
2023-11-17
2023-11-16
2023-11-15
2023-11-14
2023-11-13
2023-11-12
2023-11-11
2023-11-10
2023-11-09
2023-11-08
2023-11-07
2023-11-06
2023-11-05
2023-11-03
2023-11-02
2023-11-01
2023-10-31
2023-10-30
2023-10-27
2023-10-26
2023-10-25
2023-10-24
2023-10-23
2023-10-22
2023-10-20
2023-10-19
2023-10-18
2023-10-17
2023-10-16
2023-10-15
2023-10-13
2023-10-12
2023-10-11
2023-10-10
2023-10-09
2023-10-06
2023-10-05
2023-10-04
2023-10-03
2023-10-02
2023-09-29
2023-09-28
2023-09-27
2023-09-26
2023-09-25
2023-09-22
2023-09-21
2023-09-20
2023-09-19
2023-09-18
2023-09-15
2023-09-14
2023-09-13
2023-09-12
2023-09-11
2023-09-09
2023-09-08
2023-09-07
2023-09-06
2023-09-05
2023-09-04
2023-09-02
2023-09-01
2023-08-31
2023-08-30
2023-08-29
2023-08-28
2023-08-27
2023-08-25
2023-08-24
2023-08-23
2023-08-22
2023-08-21
2023-08-18
2023-08-17
2023-08-16
2023-08-15
2023-08-14
2023-08-13
2023-08-11
2023-08-10
2023-08-09
2023-08-08
2023-08-07
2023-08-04
2023-08-03
2023-08-02
2023-08-01
2023-07-31
2023-07-30
2023-07-28
2023-07-27
2023-07-26
2023-07-25
2023-07-24
2023-07-23
2023-07-21
2023-07-20
2023-07-19
2023-07-18
2023-07-17
2023-07-14
2023-07-13
2023-07-12
2023-07-11
2023-07-10
2023-07-08
2023-07-07
2023-07-06
2023-07-05
2023-07-04
2023-07-03
2023-06-30
2023-06-29
2023-06-28
2023-06-27
2023-06-26
2023-06-23
2023-06-22
2023-06-21
2023-06-20
2023-06-19
2023-06-16
2023-06-15
2023-06-14
2023-06-13
2023-06-12
2023-06-09
2023-06-08
2023-06-07
2023-06-06
2023-06-05
2023-06-03
2023-06-02
2023-06-01
2023-05-31
2023-05-30
2023-05-29
2023-05-26
2023-05-25
2023-05-24
2023-05-23
2023-05-22
2023-05-21
2023-05-19
2023-05-18
2023-05-17
2023-05-16
2023-05-15
2023-05-12
2023-05-11
2023-05-10
2023-05-09
2023-05-08
2023-05-05
2023-05-04
2023-05-03
2023-05-02
2023-05-01
2023-04-28
2023-04-27
2023-04-26
2023-04-25
2023-04-24
2023-04-21
2023-04-20
2023-04-19
2023-04-18
2023-04-17
2023-04-14
2023-04-13
2023-04-12
2023-04-11
2023-04-10
2023-04-09
2023-04-07
2023-04-06
2023-04-05
2023-04-04
2023-04-03
2
Query:
-- 12. Calculate total sales revenue per vendor in 2023
SELECT "vendor_number", "vendor_name", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "vendor_number", "vendor_name"
LIMIT 1000
Answer:
Too long, hard cut:
vendor_number,vendor_name,total_sales_2023
325,LONELY OAK DISTILLERY,265744.69000000006
935,ALAMBIC INC.,2825.28
549,"GREEN FROG DISTILLERY, LLC",61004.25
273,HAWAII SEA SPIRITS LLC,20201.739999999998
937,OLD LOUISVILLE WHISKEY CO. LLC,10890.0
907,DRY FLY DISTILLING,1290.0
540,MEISENBURG BREWING & DISTILLING,180.0
85,BROWN FORMAN CORP.,20513550.880000006
772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,2409294.1700000004
727,BENCHMARK BEVERAGE COMPANY LLC,46451.850000000006
391,HOTALING & CO,187829.12000000002
780,CLEAR WATER DISTILLING CO,2765.9700000000003
822,WHIDBEY ISLAND DISTILLERIES LLC,422.16
934,LONG ISLAND SPIRITS INC.,297.0
625,MIDDLE WEST SPIRITS,3586.5
539,GARGOYLE ENTERPRISES / LAWS WHISKEY HOUSE,16839.0
437,OPICI IMPORT COMPANY,2430.0
752,COPPER STILL DISTILLERY,2190.0
268,IMPEX BEVERAGE INC,22932.540000000005
558,ALTAMAR BRANDS LLC,49533.82
557,"WORLDWIDE LIBATIONS, LLC",60962.840000000004
775,"BONAVITA BEVERAGE GROUP, LLC",35151.15
368,PARK STREET IMPORTS,3092789.0500000003
91,CASTLE BRANDS,45449.4
353,"JOHN ERNEST DISTILLERY, INC.",77341.93000000001
924,BALUARTE SPIRITS LLC,2176.4
231,RS LIPMAN COMPANY LLC,3084.48
342,DV SPIRITS LLC,364011.4
116,BAD BEAR ENTERPRISES LLC / LEGENDARY RYE,90137.61
892,"CHACHO SPIRITS / ZJ LIQUORS, LLC",1336.5
734,"ELIXIR, INC.",2700.0
384,PIEDMONT DISTILLERS INC,358055.48
338,"MARUSSIA BEVERAGES USA, INC / NICHE IMPORT",141347.71000000002
805,WMC-PBD LLC/ PINE BLUFFS DISTILLING,4387.5
583,"USA WINE WEST, LLC",17222.0
65,JIM BEAM BRANDS,30037947.910000004
232,DRIFTLESS GLEN DISTILLERY,46275.98999999999
402,OZ SPIRITS LLC,28290.24000000001
742,WILDCAT PRODUCTS LLC,30412.5
580,MARA IMPORTS,4228.799999999999
792,RIVER VALLEY ORCHARDS & WINERY,3168.0
347,NORTH SHORE DISTILLERY,195.06
837,ONE LIFE SPIRITS LLC,18614.700000000004
677,DURHAM DISTILLERY,1559.52
492,WESTERN SPIRITS BEVERAGE,918640.7899999999
454,SALOON SPIRITS LLC,148289.94
797,UNA FAMILIA SPIRITS LLC,25669.069999999992
351,"TATTERSALL COMPANIES, LLC",6533.369999999999
334,DES MOINES IMPORTS / DSM IMPORTS LLC,702.0
195,SWELL LIQUOR LLC,248410.49999999997
163,STOLLER IMPORTS INC / MARSALLE COMPANY,182356.74
785,MAISON FERRAND USA,10974.189999999997
650,HIGHCLERE CASTLE SPIRITS,625.3199999999999
305,MHW LTD,2368884.9500000007
100,AIKO IMPORTERS INC,165455.28999999998
370,PERNOD RICARD USA,27709155.019999996
690,TOM'S TOWN DISTILLING CO,11978.750000000002
110,3 BADGE CORPORATION,44358.84000000001
556,BOOT HILL DISTILLERY LLC,1732.5
421,SAZERAC COMPANY  INC,66752599.61999999
346,OLE SMOKY DISTILLERY LLC,5252152.899999999
90,CARRIAGE HOUSE IMPORTS,38677.5
525,CATS EYE DISTILLERY,159136.27
363,PATERNO IMPORTS LTD / TERLATO WINES INTERNATIONAL,106614.52
428,"TRAVERSE CITY WHISKEY CO / TCWC, LLC",22327.38
832,ROYAL WINE CORPORATION,1120.5
606,SAVAGE & COOKE / SANTA CROCE LLC,16579.559999999998
235,DEMERARA DISTILLERS (USA) INC.,11379.12
638,DC BEVERAGE LLC,954.0
118,AMERICAN SPIRITS EXCHANGE,872681.03
460,SHAW-ROSS INTERNATIONAL,189432.6
705,"VALHALLA IMPORTS, LLC",1231.92
673,INTERNATIONAL TRADE ONE CORP,1038.06
448,ST GEORGE SPIRITS INC,59704.5
477,VINO.COM DBA TOTAL BEVERAGE SOLUTION,29041.94999999999
789,SARGE'S SPIRITS LLC,25956.0
209,MINHAS MICRO DISTILLERY,222525.30000000002
108,CVI BRANDS / CALIFORNIA VINEYARDS INC,2205.0
749,GRAYBEARD DISTILLERY INC,577.5
886,GEORGETOWN TRADING CO. LLC / JAMES PEPPER DISTILLING CO.,171.5
784,ALTOS PLANOS INC.,2162.7000000000003
561,DOC BROWN ENTERPRISES,330.0
287,CHATHAM IMPORTS INC,366185.25
888,"TRUST ME VODKA, INC.",92233.5
573,TEMPLETON DISTILLING LLC,115031.34
803,LEVECKE CORPORATION,1731901.5
807,TERRANOVA SPIRITS LLC,5754.780000000001
607,"SURO INTERNATIONAL IMPORTERS, INC",870.24
779,BOVEDA RESERVE DISTRIBUTION LLC,7200.0
482,"SOVEREIGN BRANDS, LLC",400293.45000000007
522,10TH MOUNTAIN WHISKEY AND SPIRIT COMPANY,10264.5
645,ROCKY TOP INVESTMENTS / ROCK RIVER DISTILLATION,15090.0
812,WILLIAM WRIGHT / BAY AND ROUSE LLC,540.0
537,"GLOBAL SPIRITS USA, LLC",1224.7200000000003
712,"BLACKBIRD SPIRITS, LLC / DR. STONERS HERB INFUSED SPIRITS",5184.069999999998
280,MACCHU PISCO LLC,5101.0
783,CITADEL BEVERAGES,16303.939999999999
422,MACH FLYNT INC.,164553.68999999997
932,COPPERMUSE INC/COPPERMUSE DISTILLERY,567.12
560,HEAVENLY SPIRITS LLC,2494.6800000000003
568,21ST CENTURY SPIRITS LLC,46372.30999999998
785,MAISON FERRAND USA / COGNAC FERRAND USA INC,123354.90000000001
589,PREMIER DISTRIBUTORS LLC,41503.92
793,CEO DISTILLING LLC,19770.66
547,FETZER VINEYARDS,1005.12
205,E & J GALLO WINERY,9603379.85
472,"TEQUILAS PREMIUM, INC",537352.54
782,KINDRED VINES IMPORT CO/ J&J IMPORTERS,8746.5
521,JEM BEVERAGE COMPANY / WESTERN SON,279088.0
626,JDSO INC / RED BOOT DISTILLERY,1983.9599999999998
478,SUTTER HOME WINERY INC / TRINCHERO FAMILY ESTATES,28563.620000000006
926,"GRATON SPIRITS COMPANY, LLC / PURPLE BRANDS",70132.5
777,"BLUE OX SPIRITS, INC.",2135285.9200000004
266,EDRINGTON GROUP USA LLC,675753.96
942,LALO SPIRITS LLC,16704.0
654,REVELTON DISTILLING COMPANY
Query:
-- 13. Find average sale amount per transaction in 2023
SELECT AVG("sale_dollars") AS "average_sale_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
LIMIT 1000
Answer:
average_sale_2023
168.9945178376523
Query:
-- 14. List distinct store numbers and names
SELECT DISTINCT "store_number", "store_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 1000
Answer:
Too long, hard cut:
store_number,store_name
6269,"NEIGHBORHOOD FOOD, LIQUOR & TOBACCO / CEDAR RAPIDS"
5630,CASEY'S GENERAL STORE #3009 / SIOUX CITY
4444,KUM & GO #4127 / SLOAN
4277,CORK IT!
6176,MINI-MART / CEDAR FALLS
6045,KUM & GO #3156 / CLIVE
6145,THE DEPOT VAN HORNE
6274,OSKALOOSA WATERING HOLE
5601,CASEY'S GENERAL STORE #1889 / MONTICELLO
6233,QUICK STOP / CEDAR RAPIDS
10153,IOWA SPIRITS / BURLINGTON
5861,TAYLOR QUIK PIK - COUNCIL BLUFFS
3813,CGI FOODS
4247,FAREWAY STORES #879 / BELMOND
2612,HY-VEE STORE / PERRY
3461,HOMETOWN FOODS / STUART
2707,HY-VEE FAST AND FRESH - URBANDALE
5329,DIVA & TEJ GAS & FOOD
5762,CASEY'S GENERAL STORE #1329 / ESTHERVILLE
10423,KWIK STAR #1153 / MILFORD
4105,FAREWAY STORES #426 / NEVADA
3889,WAL-MART 1005 / WAVERLY
10350,SUPER SAVER LIQUOR / MUSCATINE
6087,SMOKER'S GENIE / WAUKEE
5738,CASEY'S GENERAL STORE #3291
6218,BOJI JUNCTION / MILFORD
5023,HAWKEYE CONVENIENCE STORES / 16TH AV
6109,MOES MART #11 / SIOUX CENTER
5357,GAMEDAY LIQUOR/ ORANGE CITY
5919,CASEY'S GENERAL STORE #2584  / OSSIAN
4509,A J'S LIQUOR II
2964,DAHL'S / ANKENY
10049,JEFFS FOODS REMSEN / REMSEN
10224,KIMMES DENISON COUNTRY STORE 11 / DENISON
3562,WAL-MART 0797 / W BURLINGTON
4821,CASEY'S GENERAL STORE #3215 / OSKALOOSA
5666,COSTCO WHOLESALE #1325 / DAVENPORT
3645,WAL-MART 1764 / WINDSOR HEIGHTS
4533,CASEY'S GENERAL STORE #1985 / ST. AN
4307,CROSSROADS WINE AND LIQUOR
4992,OLD 34 GAS & GRILL
6321,COLONY POINT FUEL & GAS - WILLIAMSBURG
4386,KUM & GO #701 / MARSHALLTOWN
10332,METRO MART #3 / CEDAR FALLS
10091,CASEY'S #6116 / COUNCIL BLUFFS
4848,KUM & GO #246 / WINTERSET
5415,PRIME MART 7 / WATERLOO
2614,HY-VEE #3 FOOD & DRUGSTORE / DAVENPORT
2670,HY-VEE FOOD STORE / CORALVILLE
2248,INGERSOLL LIQUOR AND BEVERAGE
5656,CODY MART GAS & LIQUOR
5691,LOGAN AVE CONVENIENCE STORE / WATERLOO
5437,GREAT PASTIMES
6168,BREW OIL #32 / SPENCER
4427,KUM & GO #507 / NORTH LIBERTY
2584,HY-VEE FOOD STORE / FORT MADISON
4638,GD XPRESS / DAVENPORT
5922,CASEY'S GENERAL STORE #3896 / CENTER POINT
4131,FAREWAY STORES #933 / URBANDALE
4777,CASEY'S GENERAL STORE #3730 / PAULLINA
5908,NEIGHBORHOOD TOBACCO OUTLET / MARION
10025,HY-VEE FAST AND FRESH #4 (7583) / URBANDALE
5000,CASEY'S GENERAL STORE #3319 / NEVADA
2575,HY-VEE FOOD STORE #1 / WATERLOO
6081,CIRCLE K / WDM
2555,HY-VEE FOOD STORE / KEOKUK
5593,GRANDVIEW MART
6018,CASEY'S GENERAL STORE #2532 / ELDORA
2703,HY-VEE FAST AND FRESH / CLIVE
6291,JET STOP BURLINGTON SOUTH / BURLINGTON
5276,CASEY'S GENERAL STORE # 3502/ STANTO
5488,YESWAY #1103 / ROCKFORD
6255,KWIK STAR #1165 / SIBLEY
5714,YESWAY #1031
5736,218 FUEL EXPRESS
4908,ZAPF'S PRONTO MARKET
4960,AJ'S LIQUOR III
5348,"SUPER LUCKY, INC"
4597,QUIK TRIP #523 / ARMY POST DM
6169,JACK & JILL STORE / WEST BRANCH
3891,"WILD ROSE EMMETSBURG, LLC"
10197,SUNSHINE FOODS / HAWARDEN
4690,SUPER STOP AND SHOP / BALDWIN
4283,GUPPYS ON THE GO
4514,CASEY'S GENERAL STORE #2813 / FORT D
4210,SICHANH LIQUOR STORE
4708,NO FRILLS SUPERMARKETS #803 / GLENWO
5941,PRIME MART - CEDAR FALLS
4417,KUM & GO #76 / ADAIR
4499,CASEY'S GENERAL STORE #1316 / MILFORD
5984,CASEY'S GENERAL STORE #3214 / OSKALOOSA
10134,"FAREWAY STORES, INC. #232 / WEST DES MOINES"
2535,HY-VEE FOOD STORE #1 / WDM
5339,PRIME STAR
2698,HY-VEE GAS #4 - WDM
4385,KUM & GO #43 / NEW VIRGINIA
2600,HY-VEE FOOD STORE / OSKALOOSA
4792,CASEY'S GENERAL STORE #2899 / DE SOTO
4468,CIRCLE K #6600 / MUSCATINE
5998,WILTON EXPRESS
6046,CASEY'S GENERAL STORE #2150 / WDM
5739,CASEY'S GENERAL STORE #1455
6203,WORLD LIQUOR & TOBACCO + VAPORS / WAUKEE
5375,CASEY'S GENERAL STORE # 3518/ DES MOINES
5699,FLASHMART #102 /PERRY
4474,BUCKY'S EXPRESS #34 / COUNCIL BLUFFS
3732,NORTH SCOTT FOODS
5709,JW LIQUOR
4582,JIFFY #926 / SPIRIT LAKE
4770,CASEY'S GENERAL STORE #3080 / HUDSON
6085,CIRCLE K #22654122 / BOONE
5648,FAREWAY STORES #189 / AMES
10440,JJ'S VALLEY MART / ROCK VALLEY
5571,CASEY'S GENERAL STORE #2782 / CEDAR RAPIDS
6202,XO FOOD & LIQUOR / WATERLOO
10281,CORYDON CORNER / CORYDON
6080,CHEEMA GAS AND LIQUORS / NEW SHARON
4004,WAL-MART 4256 / AMES
3565,HARTIG DRUG STORE #10
3928,SMOKIN' JOE'S #12 TOBACCO AND LIQUOR
4165,I-35 SPIRITS / ANKENY
2588,HY-VEE FOOD AND DRUG #6 / CEDAR RAPI
3912,SMOKIN' JOE'S #14 TOBACCO AND LIQUOR
4801,WALGREENS #05852 / DES MOINES
4273,SMOKIN' JOE'S #4 TOBACCO AND LIQUOR
5241,BP  /  DUBUQUE
5333,FAREWAY STORES # 166/ ANAMOSA
3910,RIVERSIDE CASINO AND RESORT
5295,YESWAY STORE # 10023/ WATERLOO
6018,CASEY'S GENERAL STORE - #2532
10225,B&L DRIVE THRU / FORT DODGE
5820,CASEY'S GENERAL STORE #57 / EDDYVILLE
5506,CASEY'S GENERAL STORE #2168
5125,CASH SAVER  /  E EUCLID AVE
3776,WAL-MART 5115 / DAVENPORT
3790,WAL-MART 0784 / MT PLEASAN
5694,FLASHMART #104
4430,KUM & GO #87 / FORT DODGE
4590,CASEY'S GENERAL STORE #3045 / CEDAR
4524,CASEY'S GENERAL STORE #1139 / NORA S
5401,CLINTON GAS & MART
2513,HY-VEE FOOD STORE #2 (1285) / IOWA CITY
5069,CASEY'S GENERAL STORE #1705 / LAKE M
4152,FOOD LAND SUPER MARKETS
6313,DANNYS TOBACCO & LIQUOR / GUTTENBERG
5782,CASEY'S GENERAL STORE #3606
6024,CASEY'S GENERAL ST
Query:
-- 15. Calculate total sales revenue per store in 2023
SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales_2023"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY "store_number", "store_name"
LIMIT 1000
Answer:
Too long, hard cut:
store_number,store_name,total_sales_2023
6045,KUM & GO #3156 / CLIVE,92150.12999999999
10049,JEFFS FOODS REMSEN / REMSEN,41003.75000000001
4821,CASEY'S GENERAL STORE #3215 / OSKALOOSA,46552.259999999995
6176,MINI-MART / CEDAR FALLS,218242.49000000005
3461,HOMETOWN FOODS / STUART,139487.32
3889,WAL-MART 1005 / WAVERLY,298720.82999999996
2612,HY-VEE STORE / PERRY,254771.91999999998
5630,CASEY'S GENERAL STORE #3009 / SIOUX CITY,81620.72999999998
4105,FAREWAY STORES #426 / NEVADA,245074.97999999992
2707,HY-VEE FAST AND FRESH - URBANDALE,31717.710000000003
6269,"NEIGHBORHOOD FOOD, LIQUOR & TOBACCO / CEDAR RAPIDS",187927.57
10153,IOWA SPIRITS / BURLINGTON,210943.69999999998
3562,WAL-MART 0797 / W BURLINGTON,593212.76
6233,QUICK STOP / CEDAR RAPIDS,243781.33000000002
5601,CASEY'S GENERAL STORE #1889 / MONTICELLO,60327.05000000001
6274,OSKALOOSA WATERING HOLE,12252.81
5666,COSTCO WHOLESALE #1325 / DAVENPORT,1849806.8400000003
4444,KUM & GO #4127 / SLOAN,56953.41000000001
6145,THE DEPOT VAN HORNE,33410.060000000005
4277,CORK IT!,203065.79000000007
10224,KIMMES DENISON COUNTRY STORE 11 / DENISON,14449.479999999998
5762,CASEY'S GENERAL STORE #1329 / ESTHERVILLE,56617.6
6218,BOJI JUNCTION / MILFORD,14943.420000000004
5738,CASEY'S GENERAL STORE #3291,51745.85
3645,WAL-MART 1764 / WINDSOR HEIGHTS,430382.22000000003
4247,FAREWAY STORES #879 / BELMOND,171430.68000000002
5329,DIVA & TEJ GAS & FOOD,80489.97
5861,TAYLOR QUIK PIK - COUNCIL BLUFFS,69967.78999999998
5919,CASEY'S GENERAL STORE #2584  / OSSIAN,25887.0
6321,COLONY POINT FUEL & GAS - WILLIAMSBURG,3953.9
4004,WAL-MART 4256 / AMES,719055.7300000002
6202,XO FOOD & LIQUOR / WATERLOO,146153.80999999997
10134,"FAREWAY STORES, INC. #232 / WEST DES MOINES",170669.26999999996
4582,JIFFY #926 / SPIRIT LAKE,344456.9700000001
2600,HY-VEE FOOD STORE / OSKALOOSA,230650.09
6046,CASEY'S GENERAL STORE #2150 / WDM,85251.27
5571,CASEY'S GENERAL STORE #2782 / CEDAR RAPIDS,48213.520000000004
5998,WILTON EXPRESS,54390.96999999999
5984,CASEY'S GENERAL STORE #3214 / OSKALOOSA,54502.58000000001
4385,KUM & GO #43 / NEW VIRGINIA,62493.94000000001
5941,PRIME MART - CEDAR FALLS,280508.9299999999
5295,YESWAY STORE # 10023/ WATERLOO,63920.20999999999
3776,WAL-MART 5115 / DAVENPORT,403692.42
4792,CASEY'S GENERAL STORE #2899 / DE SOTO,73942.72
4801,WALGREENS #05852 / DES MOINES,36362.950000000004
5375,CASEY'S GENERAL STORE # 3518/ DES MOINES,118114.38
4499,CASEY'S GENERAL STORE #1316 / MILFORD,54696.23
6085,CIRCLE K #22654122 / BOONE,22689.28000000001
3790,WAL-MART 0784 / MT PLEASAN,297205.76
3732,NORTH SCOTT FOODS,46930.23999999998
6203,WORLD LIQUOR & TOBACCO + VAPORS / WAUKEE,22575.060000000005
3910,RIVERSIDE CASINO AND RESORT,155796.05
5820,CASEY'S GENERAL STORE #57 / EDDYVILLE,29520.91
5739,CASEY'S GENERAL STORE #1455,28811.009999999995
4770,CASEY'S GENERAL STORE #3080 / HUDSON,44799.060000000005
4417,KUM & GO #76 / ADAIR,47957.219999999994
5648,FAREWAY STORES #189 / AMES,72783.84999999999
2698,HY-VEE GAS #4 - WDM,15742.140000000003
10281,CORYDON CORNER / CORYDON,11316.219999999998
10225,B&L DRIVE THRU / FORT DODGE,3868.980000000001
9037,"GREEN FROG DISTILLERY, LLC",16600.5
2585,HY-VEE WINE AND SPIRITS (1010) / ALGONA,735897.4199999999
10115,"FAREWAY STORES, INC. #236 / BONDURANT",172946.88999999998
5603,CASEY'S GENERAL STORE #2480 / CHARLES CITY,38926.40000000001
5117,FOOD & GAS MART  /  MARSHALLTOWN,45184.000000000015
4854,CASEY'S GENERAL STORE #3029 / ARMSTRONG,76025.12999999999
5708,BROTHERS MARKET / WILLIAMSBURG,104744.51000000004
5396,CASEY'S GENERAL STORE # 3512/ INDIANOLA,65665.12
4378,KUM & GO #1202 / WAUKEE,109469.55000000002
4642,LIQUOR AND TOBACCO OUTLET / UNIV AVE WATERLOO,50020.26
4800,WALGREENS #07968 / DES MOINES,22300.510000000002
4902,BROADWAY LIQUOR,121844.46
6008,TARGET STORE T-3374 / IOWA CITY,117017.78999999998
6117,FAREWAY STORES #212 / COLFAX,94835.45999999998
5109,CASEY'S GENERAL STORE #3404 / CARLIS,89058.25000000003
5847,MOTI'S FOOD,125432.83000000003
4236,FAREWAY STORES #551 / EAGLE GROVE,166780.97999999998
3065,MONTEZUMA SUPER VALU,78798.40999999999
6148,BEER ON FLOYD / SIOUX CITY,78239.69
5184,CASEY'S GENERAL STORE #3440 / CAMANC,89965.37000000001
5196,THE DEPOT CORALVILLE,42527.95
4491,CASEY'S GENERAL STORE #2772 / CEDAR RAPIDS,94469.99999999999
10143,BREW #63 / DAVENPORT,19904.450000000004
4630,EZ STOP / DAVENPORT,249265.2800000001
6314,JET STOP MILTON / MILTON,32382.540000000008
6293,JET STOP WEST POINT / WEST POINT,28033.89
5409,CASEY'S GENERAL STORE # 2179/ WAUKEE,53469.42999999999
6120,CRESCO MART,56873.21000000001
4546,CASEY'S GENERAL STORE #2303 / GLIDDEN,37331.93
6186,SAVE MORE SUPER MARKET / DAVENPORT,16663.529999999995
6058,PANTHER TRAVEL CENTER / CEDAR FALLS,9362.039999999999
10189,HY-VEE / KNOXVILLE,14144.189999999997
6281,MARTELLE STORE / MARTELLE,221.4
3644,WAL-MART 2764 / ALTOONA,603255.83
10032,KWIK STAR #1158 / AMES,44192.45000000001
6290,S & S MEATS AND SPIRITS / OSAGE,114022.65000000002
5358,KUM & GO #1056/ BEVINGTON,78060.02000000002
4457,KUM &
End Exploring Related Columns
Task: What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
item_number,item_description,growth_percentage
item1:str,description1:str,growth1:float > 0
item2:str,description2:str,growth2:float > 0
item3:str,description3:str,growth3:float > 0
item4:str,description4:str,growth4:float > 0
item5:str,description5:str,growth5:float > 0
```

The table above lists the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023. Each row includes the item number, item description, and the growth percentage compared to the previous year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-19 03:43:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:43:54 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT
    "item_number",
    SUM("sale_dollars") AS "total_sales_2022"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT
    "item_number",
    "item_description",
    SUM("sale_dollars") AS "total_sales_2023"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
  GROUP BY "item_number", "item_description"
)
SELECT
  s23."item_number",
  s23."item_description",
  ROUND(((s23."total_sales_2023" - s22."total_sales_2022") / s22."total_sales_2022") * 100, 4) AS "growth_percentage"
FROM
  sales_2023 s23
JOIN
  sales_2022 s22 ON s23."item_number" = s22."item_number"
WHERE
  s22."total_sales_2022" > 0
ORDER BY
  "growth_percentage" DESC
LIMIT 5
```
2025-01-19 03:43:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:43:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:43:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:43:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-19 03:43:56 - snowflake.connector.connection - INFO - closed
2025-01-19 03:43:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:43:56 - root - INFO - itercount: 1
2025-01-19 03:43:56 - root - INFO - 0
2025-01-19 03:43:56 - root - INFO - results: 
item_number,item_description,growth_percentage
74782,JACK DANIELS WINTER JACK,82851.2924
84155,99 CHERRIES MINI,14440.9091
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0
38073,STATE VODKA,5882.9744
65543,LICOR 43 CHOCOLATE,4146.7422


2025-01-19 03:43:56 - root - INFO - Please check the answer again by reviewing What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
item_number,item_description,growth_percentage
item1:str,description1:str,growth1:float > 0
item2:str,description2:str,growth2:float > 0
item3:str,description3:str,growth3:float > 0
item4:str,description4:str,growth4:float > 0
item5:str,description5:str,growth5:float > 0
```

The table above lists the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023. Each row includes the item number, item description, and the growth percentage compared to the previous year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
item_number,item_description,growth_percentage
74782,JACK DANIELS WINTER JACK,82851.2924
84155,99 CHERRIES MINI,14440.9091
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0
38073,STATE VODKA,5882.9744
65543,LICOR 43 CHOCOLATE,4146.7422
Current sql:
WITH sales_2022 AS (
  SELECT
    "item_number",
    SUM("sale_dollars") AS "total_sales_2022"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT
    "item_number",
    "item_description",
    SUM("sale_dollars") AS "total_sales_2023"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
  GROUP BY "item_number", "item_description"
)
SELECT
  s23."item_number",
  s23."item_description",
  ROUND(((s23."total_sales_2023" - s22."total_sales_2022") / s22."total_sales_2022") * 100, 4) AS "growth_percentage"
FROM
  sales_2023 s23
JOIN
  sales_2022 s22 ON s23."item_number" = s22."item_number"
WHERE
  s22."total_sales_2022" > 0
ORDER BY
  "growth_percentage" DESC
LIMIT 5When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-19 03:44:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 03:44:17 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT
    "item_number",
    SUM("sale_dollars") AS "total_sales_2022"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT
    "item_number",
    "item_description",
    SUM("sale_dollars") AS "total_sales_2023"
  FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
  WHERE "date" BETWEEN '2023-01-01' AND '2023-12-31'
  GROUP BY "item_number", "item_description"
)
SELECT
  s23."item_number",
  s23."item_description",
  ROUND(((s23."total_sales_2023" - s22."total_sales_2022") / s22."total_sales_2022") * 100, 4) AS "growth_percentage"
FROM
  sales_2023 s23
JOIN
  sales_2022 s22 ON s23."item_number" = s22."item_number"
WHERE
  s22."total_sales_2022" > 0
ORDER BY
  "growth_percentage" DESC NULLS LAST
LIMIT 5
```
2025-01-19 03:44:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 03:44:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 03:44:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 03:44:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-19 03:44:19 - snowflake.connector.connection - INFO - closed
2025-01-19 03:44:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 03:44:19 - root - INFO - itercount: 2
2025-01-19 03:44:19 - root - INFO - 0
2025-01-19 03:44:19 - root - INFO - Total iteration counts: 2
