2025-01-19 11:05:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:05:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:05:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:05:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:05:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:06:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-01-19 11:06:01 - snowflake.connector.connection - INFO - closed
2025-01-19 11:06:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:06:01 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Results:
event_name
first_open
app_update
app_exception
level_retry_quickplay
level_fail
error
level_complete
level_up
level_reset
completed_5_levels
spend_virtual_currency
no_more_extra_steps
ad_reward
firebase_campaign
app_remove
challenge_a_friend
post_score
level_retry
level_start
screen_view
select_content
user_engagement
level_end_quickplay
level_reset_quickplay
level_start_quickplay
level_complete_quickplay
os_update
use_extra_steps
level_end
session_start
level_fail_quickplay

2025-01-19 11:06:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:06:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:06:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:06:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 11:06:02 - snowflake.connector.connection - INFO - closed
2025-01-19 11:06:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:06:03 - root - INFO - SQL:
SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Results:
event_date
20180915

2025-01-19 11:06:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:06:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:06:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:06:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 11:06:04 - snowflake.connector.connection - INFO - closed
2025-01-19 11:06:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:06:05 - root - INFO - SQL:
SELECT DISTINCT "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Results:
Too long, hard cut:
event_timestamp
1537076339359000
1537051267227000
1537005246537000
1537040769430000
1537043473906000
1537031154410000
1537054497182000
1537003648146000
1537047872198000
1537024207496000
1537033428081000
1537050812506003
1537050751507004
1537067332037000
1537032995920000
1537018737041000
1537041658827001
1537068765508000
1537022362749000
1537067741424002
1537067699749000
1537038441589000
1536995780777000
1537067846686000
1537075615932000
1537053142420000
1537043707699000
1537025889057000
1537078255387033
1537074967910032
1537023190841033
1537061571114000
1537062499941002
1537005304030086
1537069365733330
1537005917769000
1537057883894000
1537041707829002
1537046237189000
1537036031425000
1537017536255000
1537034208497000
1537075301232000
1537023606262029
1537061423077000
1537061395077030
1537061868174000
1537062358545039
1537065366266001
1537049179949016
1537068586559063
1537018108650010
1537018168650011
1537006365446001
1537007483804152
1537007964848202
1537010784960003
1537028994222030
1537057384012004
1537008487500014
1537048542412013
1537001919928156
1537012199625022
1537069185545235
1537040757487005
1537050722579000
1537054134796000
1537061448359000
1537077753138000
1537020758462000
1537013441404000
1537028747146000
1537043114002000
1537026723607001
1537023016297000
1537023484905013
1537061446873000
1537061460259010
1537061723255003
1537065306943024
1537051455687001
1537006274862000
1537006433446016
1537006765087000
1537035403701003
1537050268258000
1537027750027000
1537066659421000
1537048716124000
1537058186682000
1537006149051006
1536996352546001
1537009813616004
1537078293728054
1537023076878106
1537061462873003
1537061573114022
1537061717134000
1537061629134003
1537061690684011
1537062032756006
1537062167682003
1537062519941063
1537005496910021
1537036304287001
1537005923206012
1537061889712000
1537065144069001
1537033595781009
1537068698203087
1537068868077154
1537005866077003
1537006110079001
1537006069079004
1537006320823003
1537006650384003
1537006801796001
1537006933652003
1537007763192010
1537008154018012
1537008958000016
1537009138027017
1537000394403003
1537073245203005
1537061450304003
1537061963756001
1537039402874018
1537062471428004
1537035661971105
1537029360059001
1537065338356006
1537005891077000
1537005847769007
1537006225862003
1537006567647038
1537006859796019
1537006856220002
1537006879220042
1537006975652055
1537006971655079
1537007401511126
1537008133018224
1537009518427003
1537010714960000
1537073798643041
1537000350450000
1537000328450003
1537000386403000
1537035351701000
1537067076422034
1537000593056054
1537051914240015
1537066882260006
1537017727923058
1537035523007076
1537008432500258
1537061218699025
1537066073726005
1537051053156083
1537051000891075
1537033293928015
1537062626234040
1537048841473002
1537037186671003
1536999768843025
1536994894504000
1536994971504003
1536995007600011
1537032693227089
1537020117458004
1537067198753092
1537067697508081
1537067985532019
1537068140987035
1537068862385031
1537068885038050
1537070555472081
1537070989103077
1537071196565187
1537049829532003
1537066997079018
1537057591501073
1537056606412005
1537043511878003
1537025859133004
1537034550953013
1537020822324026
1537056501492009
1537034474193000
1537054604632000
1537054581632000
1537018719929396
1537058875383028
1537061979756000
1537035350209056
1537005827176009
1537009113027338
1537040738488006
1537039355296000
1537018044113000
1537006091050005
1537031597919000
1537061712255000
1537061806174001
1537073953849001
1537035710888126
1537035780465155
1537068514962014
1537018096663012
1537005810176000
1537006023597003
1537006078079000
1537007235308113
1537007530367009
1537007937848011
1537008330532013
1537008916000315
1537010918627001
1537010878627030
1537005747358002
1537000293358045
1537071472908015
1537052348686002
1537048544686000
1537066889262007
1537016079149003
1537065888414000
1537006059084000
1537022727097015
1537061458304000
1537061928347000
1537062177682000
1537062298280016
1537070167231093
1537005908206011
1537074020581000
1537034816634026
1537068236196242
1537068295003262
1537068781611107
1537069288267280
1537005955597000
1537006383823000
1537006582384050
1537006762087006
1537007011655004
1537007127939005
1537007128939092
1537007386511007
1537007436804008
1537007751192189
1537008299532236
1537008544519015
1537009310550011
1537009496427000
1537073799643040
1537074107701015
1537000295358000
1537000467159000
1537000401159001
1537000455159004
1537029072031015
1537078606084140
1537052354684001
1537000533378041
1537000422317004
1537000567378042
1537029533197027
1537017762947059
1537062240280001
1537031313530015
1537007304308006
1537045222788001
1537074781557001
1537021351819006
1537069338508310
1537005795356001
1537065888414023
1537066046726000
1537065954815001
1537050914231027
1537050956185039
1537050992891074
1537051058339095
1537050943231028
1537050891185040
1537050964339096
1537033294376015
1537033287383017
1537033291376016
1537033285922014
1537062612234000
1537023014443010
153

2025-01-19 11:06:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:06:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:06:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:06:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 210
2025-01-19 11:06:07 - snowflake.connector.connection - INFO - closed
2025-01-19 11:06:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:06:07 - root - INFO - SQL:
SELECT "event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Results:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""previous_app_version"",
    ""value"": {
      ""string_value"": ""2.2.5""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""previous_os_version"",
    ""value"": {
      ""string_value"": ""9.3.2""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172545
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value

2025-01-19 11:06:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:06:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:06:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:06:08 - snowflake.connector.connection - INFO - closed
2025-01-19 11:06:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:06:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:06:35 - root - INFO - The error you're encountering:

```
SQL compilation error: error line 1 at position 7
invalid identifier 'F."key"'
```

indicates that the SQL compiler does not recognize the identifier `f."key"` in your query. This issue arises due to the way Snowflake handles case sensitivity and the naming of columns returned by the `FLATTEN` function.

### **Understanding the Issue:**

- In Snowflake, **unquoted identifiers** (like `column_name`) are **automatically uppercased** and are **case-insensitive**.
- **Quoted identifiers** (like `"column_name"`) are **case-sensitive** and **preserve the case** exactly as written.
- The `FLATTEN` function returns columns named in **uppercase** by default: `KEY`, `VALUE`, `INDEX`, etc.

In your query, you're referencing `f."key"` and `f."value"`, which means you're looking for columns named exactly `key` and `value` in lowercase. However, since `FLATTEN` returns columns in uppercase (`KEY`, `VALUE`), the identifiers `f."key"` and `f."value"` are not found, leading to the invalid identifier error.

### **Solution:**

To fix the issue, you need to reference the `FLATTEN` columns correctly. You have two options:

1. **Use Unquoted Uppercase Identifiers (recommended):**

   Remove the double quotes and use the column names in uppercase:

   ```sql
   SELECT f.KEY, f.VALUE
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
   LATERAL FLATTEN(input => "event_params") f
   LIMIT 1000;
   ```

   - Here, `KEY` and `VALUE` are unquoted and will match the uppercase column names returned by `FLATTEN`.

2. **Use Quoted Uppercase Identifiers:**

   Keep the double quotes and change the column names to uppercase inside the quotes:

   ```sql
   SELECT f."KEY", f."VALUE"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
   LATERAL FLATTEN(input => "event_params") f
   LIMIT 1000;
   ```

   - Since `FLATTEN` returns columns named `KEY` and `VALUE` in uppercase, quoting them with the correct case will allow the identifiers to match.

### **Explanation:**

- **Option 1** is generally preferred because it avoids case sensitivity issues and makes the SQL more readable.
- By removing the quotes and using uppercase, you leverage Snowflake's behavior of treating unquoted identifiers as case-insensitive.
- **Option 2** works as well but requires you to be precise with the case inside the quotes.

### **Revised Query:**

Using Option 1 (unquoted identifiers):

```sql
SELECT f.KEY, f.VALUE
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
LATERAL FLATTEN(input => "event_params") f
LIMIT 1000;
```

### **Additional Tips:**

- **Referencing the `event_params` Column:**

  Ensure that the `event_params` column is correctly referenced. If it was created with double quotes and a specific case, you might need to adjust accordingly.

- **Inspecting Nested JSON Data:**

  Since `event_params` contains nested JSON data, you can further extract values using the `VALUE` column. For example, to get specific keys within the JSON:

  ```sql
  SELECT
    f.VALUE:"key"::STRING AS param_key,
    f.VALUE:"value" AS param_value
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
  LATERAL FLATTEN(input => event_params) f
  LIMIT 1000;
  ```

  - This will extract the `key` and `value` from each JSON object within the `event_params` array.

### **Conclusion:**

By adjusting the case of the identifiers and ensuring they match the columns returned by the `FLATTEN` function, the error should be resolved. Use the revised query provided, and you should be able to retrieve the desired data without any compilation errors.
2025-01-19 11:06:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:06:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:06:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:06:37 - snowflake.connector.connection - INFO - closed
2025-01-19 11:06:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:07:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:07:04 - root - INFO - **Understanding the Error:**

The error message you're encountering:

```
000904 (42000): 01b9d07a-0004-7b17-0001-11c300ef41f6: SQL compilation error: error line 5 at position 27
invalid identifier 'EVENT_PARAMS'
```

indicates that the SQL compiler cannot recognize the identifier `event_params` in your query. This is happening because:

- The `FLATTEN` function needs a fully qualified reference to the `event_params` column.
- Without properly qualifying the column with the table name or alias, the compiler does not know which table (or alias) `event_params` belongs to.

### **Issue with the Query:**

In your query:

```sql
SELECT f."key", f."value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
LATERAL FLATTEN(input => "event_params") f
LIMIT 1000;
```

- The `FLATTEN` function is called with `input => "event_params"`, but `"event_params"` is not prefixed with a table name or alias.
- Since there is no table alias or reference, the compiler cannot resolve which `event_params` column you're referring to.
- Additionally, in Snowflake, referencing columns requires careful handling of case sensitivity and quotation marks.

### **Solution:**

To resolve the error, you need to:

1. **Assign an Alias to the Table:**

   - Assign an alias (e.g., `t`) to the table `"EVENTS_20180915"`.

2. **Fully Qualify the Column Reference:**

   - Use the table alias to reference the `event_params` column as `t."event_params"`.

3. **Handle Quotation Marks and Case Sensitivity Correctly:**

   - Ensure that the column names are correctly quoted to match how they are defined in the table schema.

### **Revised Query:**

Here is the corrected query:

```sql
SELECT f."KEY", f."VALUE"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

- **Explanation:**
  - We assigned the alias `t` to the table `"EVENTS_20180915"`.
  - We referenced the `event_params` column using the table alias `t."event_params"`.
  - We adjusted the case and quotation for the `KEY` and `VALUE` columns returned by the `FLATTEN` function.
    - Since `FLATTEN` returns columns named in uppercase (`KEY`, `VALUE`), we referenced them accordingly.

### **Detailed Breakdown:**

1. **Assigning the Table Alias:**

   ```sql
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t
   ```

   - Assigns the alias `t` to the table for easier reference.

2. **Referencing the `event_params` Column:**

   ```sql
   LATERAL FLATTEN(input => t."event_params") f
   ```

   - The `input` parameter now correctly references the `event_params` column from table `t`.
   - The column name `event_params` is enclosed in double quotes to preserve its case (assuming it was defined using double quotes in the schema).

3. **Selecting Columns from `FLATTEN`:**

   ```sql
   SELECT f."KEY", f."VALUE"
   ```

   - The columns returned by `FLATTEN` are named `KEY`, `VALUE`, `INDEX`, etc., in uppercase.
   - We use double quotes and uppercase to match the exact column names.

### **Alternative Query Using Unquoted Identifiers:**

If you prefer using unquoted identifiers and rely on Snowflake's default case handling:

```sql
SELECT f.KEY, f.VALUE
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t.event_params) f
LIMIT 1000;
```

- **Note:**
  - By removing the quotes, identifiers are automatically converted to uppercase.
  - Ensure that the column names in your table are uppercase or that this conversion does not cause issues.

### **Additional Tips:**

- **Understanding Case Sensitivity in Snowflake:**

  - **Unquoted Identifiers:**
    - Are treated as uppercase.
    - Are case-insensitive.
    - Example: `column_name` becomes `COLUMN_NAME`.

  - **Quoted Identifiers:**
    - Are case-sensitive.
    - Preserve the exact case as written.
    - Example: `"column_name"` remains `"column_name"`.

- **Reference Columns Carefully:**

  - Always use the table alias when referencing columns in expressions like `FLATTEN(input => t."event_params")`.
  - This practice avoids ambiguity and ensures the compiler can resolve the column references correctly.

### **Testing the Revised Query:**

Please run the revised query:

```sql
SELECT f."KEY", f."VALUE"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

**Or**

```sql
SELECT f.KEY, f.VALUE
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t.event_params) f
LIMIT 1000;
```

This should resolve the `invalid identifier 'EVENT_PARAMS'` error and allow you to retrieve the keys and values from the `event_params` column.

### **Extracting Specific Data from Nested JSON:**

If you want to extract specific keys and their corresponding values from the nested JSON in `event_params`, you can modify the query as follows:

```sql
SELECT
    f.VALUE:"key"::STRING AS param_key,
    f.VALUE:"value" AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

- This query will:

  - Extract the `"key"` and `"value"` fields from each JSON object within the `event_params` array.
  - Cast the `"key"` to a `STRING` and alias it as `param_key`.
  - Leave `param_value` as a `VARIANT`, which you can further process based on the data type (e.g., `string_value`, `int_value`).

### **Example of Further Extracting Values:**

To get the actual values from `param_value`, you may need to handle different data types (e.g., strings, integers). Here's how you could do it:

```sql
SELECT
    f.VALUE:"key"::STRING AS param_key,
    COALESCE(
        f.VALUE:"value":"string_value"::STRING,
        TO_VARCHAR(f.VALUE:"value":"int_value"::INT),
        TO_VARCHAR(f.VALUE:"value":"float_value"::FLOAT)
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

- **Explanation:**
  - We attempt to extract the `"string_value"`, `"int_value"`, or `"float_value"` from the `"value"` object.
  - The `COALESCE` function returns the first non-null value.
  - This allows you to handle different types of values within the `event_params`.

### **Conclusion:**

By properly aliasing the table and fully qualifying the column references, you should be able to resolve the error and execute your query successfully. Remember to pay attention to case sensitivity and the use of quotation marks when working with identifiers in Snowflake.

Let me know if you have any further questions or need additional assistance!
2025-01-19 11:07:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:07:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:07:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:07:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 11:07:06 - snowflake.connector.connection - INFO - closed
2025-01-19 11:07:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:07:06 - root - INFO - SQL:
SELECT
    f.VALUE:"key"::STRING AS param_key,
    COALESCE(
        f.VALUE:"value":"string_value"::STRING,
        TO_VARCHAR(f.VALUE:"value":"int_value"::INT),
        TO_VARCHAR(f.VALUE:"value":"float_value"::FLOAT)
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Results:
Too long, hard cut:
PARAM_KEY,PARAM_VALUE
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,5640021151996172547
previous_app_version,2.2.5
firebase_screen_class,main_menu
firebase_event_origin,auto
previous_os_version,9.3.2
firebase_screen_id,5640021151996172547
firebase_screen_class,main_menu
firebase_event_origin,auto
firebase_screen_id,5640021151996172545
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6713771638975339060
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,2
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
previous_app_version,2.2.5
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,9.3.3
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7436990882465658089
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
firebase_screen_id,8204971095873061646
firebase_screen_class,main_menu
update_with_analytics,1
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7228239341162181857
previous_app_version,2.6.26
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,11.2.6
firebase_screen_id,-7228239341162181857
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
timestamp,1537067682000
fatal,1
firebase_event_origin,clx
firebase_screen_id,-904519747924484668
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0


2025-01-19 11:07:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:07:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:07:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:07:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:07:08 - snowflake.connector.connection - INFO - closed
2025-01-19 11:07:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:07:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:07:30 - root - INFO - ```sql
SELECT
    board_type,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN f.VALUE:"key"::STRING = 'board_type' THEN f.VALUE:"value":"string_value"::STRING END) AS board_type,
        MAX(CASE WHEN f.VALUE:"key"::STRING = 'score' THEN TRY_TO_NUMBER(f.VALUE:"value":"int_value"::STRING) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp"
) sub
WHERE board_type IS NOT NULL AND score IS NOT NULL
GROUP BY board_type;
```
2025-01-19 11:07:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:07:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:07:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:07:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:07:31 - snowflake.connector.connection - INFO - closed
2025-01-19 11:07:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:08:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:08:27 - root - INFO - ```sql
SELECT
    board_type,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN f.VALUE:"key"::STRING = 'board_type' THEN f.VALUE:"value":"string_value"::STRING END) AS board_type,
        MAX(CASE WHEN f.VALUE:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                f.VALUE:"value":"string_value",
                f.VALUE:"value":"int_value"::STRING,
                f.VALUE:"value":"double_value"::STRING,
                f.VALUE:"value":"float_value"::STRING
            )
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
         LATERAL FLATTEN(input => "event_params") f
    GROUP BY "event_timestamp"
) sub
WHERE board_type IS NOT NULL AND score IS NOT NULL
GROUP BY board_type;
```
2025-01-19 11:08:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:08:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:08:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:08:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:08:29 - snowflake.connector.connection - INFO - closed
2025-01-19 11:08:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:09:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:09:34 - root - INFO - ```sql
SELECT
    ep.VALUE:"key"::STRING AS param_key,
    COALESCE(
        ep.VALUE:"value":"string_value"::STRING,
        TO_VARCHAR(ep.VALUE:"value":"int_value"::INT),
        TO_VARCHAR(ep.VALUE:"value":"double_value"::FLOAT)
    ) AS param_value
FROM
    "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
    LATERAL FLATTEN(input => "event_params") ep
LIMIT 1000;
```
2025-01-19 11:09:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:09:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:09:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:09:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 11:09:36 - snowflake.connector.connection - INFO - closed
2025-01-19 11:09:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:09:36 - root - INFO - SQL:
SELECT
    ep.VALUE:"key"::STRING AS param_key,
    COALESCE(
        ep.VALUE:"value":"string_value"::STRING,
        TO_VARCHAR(ep.VALUE:"value":"int_value"::INT),
        TO_VARCHAR(ep.VALUE:"value":"double_value"::FLOAT)
    ) AS param_value
FROM
    "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
    LATERAL FLATTEN(input => "event_params") ep
LIMIT 1000;
Results:
Too long, hard cut:
PARAM_KEY,PARAM_VALUE
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,5640021151996172547
previous_app_version,2.2.5
firebase_screen_class,main_menu
firebase_event_origin,auto
previous_os_version,9.3.2
firebase_screen_id,5640021151996172547
firebase_screen_class,main_menu
firebase_event_origin,auto
firebase_screen_id,5640021151996172545
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6713771638975339060
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,2
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
previous_app_version,2.2.5
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,9.3.3
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7436990882465658089
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
firebase_screen_id,8204971095873061646
firebase_screen_class,main_menu
update_with_analytics,1
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7228239341162181857
previous_app_version,2.6.26
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,11.2.6
firebase_screen_id,-7228239341162181857
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
timestamp,1537067682000
fatal,1
firebase_event_origin,clx
firebase_screen_id,-904519747924484668
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0


2025-01-19 11:09:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:09:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:09:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:09:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:09:38 - snowflake.connector.connection - INFO - closed
2025-01-19 11:09:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:10:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:10:18 - root - INFO - ```sql
SELECT
    board_type,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board_type' THEN ep.value:"value":"string_value"::STRING END) AS board_type,
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_timestamp"
) sub
WHERE board_type IS NOT NULL AND score IS NOT NULL
GROUP BY board_type;
```
2025-01-19 11:10:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:10:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:10:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:10:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:10:20 - snowflake.connector.connection - INFO - closed
2025-01-19 11:10:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:11:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:11:22 - root - INFO - ```sql
SELECT
    t."event_name",
    t."event_params"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t
LIMIT 1000;
```
2025-01-19 11:11:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:11:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:11:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:11:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 200
2025-01-19 11:11:24 - snowflake.connector.connection - INFO - closed
2025-01-19 11:11:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:11:24 - root - INFO - SQL:
SELECT
    t."event_name",
    t."event_params"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t
LIMIT 1000;
Results:
Too long, hard cut:
event_name,event_params
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
app_update,"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""previous_app_version"",
    ""value"": {
      ""string_value"": ""2.2.5""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
os_update,"[
  {
    ""key"": ""previous_os_version"",
    ""value"": {
      ""string_value"": ""9.3.2""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172545
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_

2025-01-19 11:11:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:11:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:11:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:11:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:11:26 - snowflake.connector.connection - INFO - closed
2025-01-19 11:11:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:12:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:12:14 - root - INFO - ```sql
SELECT
    t."event_name",
    ep.value:"key"::STRING AS param_key,
    COALESCE(
        ep.value:"value":"string_value",
        ep.value:"value":"int_value"::STRING,
        ep.value:"value":"double_value"::STRING
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
LIMIT 1000;
```
2025-01-19 11:12:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:12:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:12:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:12:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 11:12:15 - snowflake.connector.connection - INFO - closed
2025-01-19 11:12:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:12:16 - root - INFO - SQL:
SELECT
    t."event_name",
    ep.value:"key"::STRING AS param_key,
    COALESCE(
        ep.value:"value":"string_value",
        ep.value:"value":"int_value"::STRING,
        ep.value:"value":"double_value"::STRING
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
LIMIT 1000;
Results:
Too long, hard cut:
event_name,PARAM_KEY,PARAM_VALUE
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
app_update,firebase_screen_id,5640021151996172547
app_update,previous_app_version,2.2.5
app_update,firebase_screen_class,main_menu
app_update,firebase_event_origin,auto
os_update,previous_os_version,9.3.2
os_update,firebase_screen_id,5640021151996172547
os_update,firebase_screen_class,main_menu
os_update,firebase_event_origin,auto
first_open,firebase_screen_id,5640021151996172545
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,firebase_screen_id,6713771638975339060
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,2
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
app_update,firebase_screen_id,6383319623192119062
app_update,previous_app_version,2.2.5
app_update,firebase_screen_class,FIRootViewController
app_update,firebase_event_origin,auto
os_update,previous_os_version,9.3.3
os_update,firebase_screen_id,6383319623192119062
os_update,firebase_screen_class,FIRootViewController
os_update,firebase_event_origin,auto
first_open,firebase_screen_id,6383319623192119062
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,firebase_screen_id,-7436990882465658089
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,0
first_open,firebase_screen_id,8204971095873061646
first_open,firebase_screen_class,main_menu
first_open,update_with_analytics,1
first_open,previous_first_open_count,1
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
app_update,firebase_screen_id,-7228239341162181857
app_update,pr

2025-01-19 11:12:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:12:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:12:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:12:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 11:12:17 - snowflake.connector.connection - INFO - closed
2025-01-19 11:12:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:13:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:13:21 - root - INFO - ```sql
SELECT
    t."event_name",
    t."user_pseudo_id",
    ep.value:"key"::STRING AS param_key,
    COALESCE(
        ep.value:"value":"string_value",
        TO_VARCHAR(ep.value:"value":"int_value"),
        TO_VARCHAR(ep.value:"value":"double_value")
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
WHERE t."event_name" = 'level_complete_quickplay'
  AND ep.value:"key"::STRING IN ('board_type', 'score')
  AND COALESCE(
        ep.value:"value":"string_value",
        TO_VARCHAR(ep.value:"value":"int_value"),
        TO_VARCHAR(ep.value:"value":"double_value")
    ) IS NOT NULL
LIMIT 1000;
```
2025-01-19 11:13:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:13:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:13:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:13:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:13:22 - snowflake.connector.connection - INFO - closed
2025-01-19 11:13:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:14:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:14:05 - root - INFO - ```sql
SELECT
    t."event_name",
    ep.value:"key"::STRING AS param_key,
    ep.value:"value" AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
LIMIT 1000;
```
2025-01-19 11:14:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:14:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:14:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:14:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 11:14:07 - snowflake.connector.connection - INFO - closed
2025-01-19 11:14:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:14:07 - root - INFO - SQL:
SELECT
    t."event_name",
    ep.value:"key"::STRING AS param_key,
    ep.value:"value" AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
LIMIT 1000;
Results:
Too long, hard cut:
event_name,PARAM_KEY,PARAM_VALUE
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
app_update,firebase_screen_id,"{
  ""int_value"": 5640021151996172547
}"
app_update,previous_app_version,"{
  ""string_value"": ""2.2.5""
}"
app_update,firebase_screen_class,"{
  ""string_value"": ""main_menu""
}"
app_update,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
os_update,previous_os_version,"{
  ""string_value"": ""9.3.2""
}"
os_update,firebase_screen_id,"{
  ""int_value"": 5640021151996172547
}"
os_update,firebase_screen_class,"{
  ""string_value"": ""main_menu""
}"
os_update,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,firebase_screen_id,"{
  ""int_value"": 5640021151996172545
}"
first_open,firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
first_open,update_with_analytics,"{
  ""int_value"": 1
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 1
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{


2025-01-19 11:14:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:14:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:14:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:14:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:14:09 - snowflake.connector.connection - INFO - closed
2025-01-19 11:14:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:14:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:14:39 - root - INFO - ```sql
SELECT
    board_type,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board_type' THEN ep.value:"value":"string_value"::STRING END) AS board_type,
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp"
    HAVING board_type IS NOT NULL AND score IS NOT NULL
) sub
GROUP BY board_type;
```
2025-01-19 11:14:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:14:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:14:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:14:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:14:41 - snowflake.connector.connection - INFO - closed
2025-01-19 11:14:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:15:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:15:13 - root - INFO - ```sql
SELECT
    ep.value:"key"::STRING AS param_key,
    COUNT(*) AS occurrences
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
GROUP BY param_key
ORDER BY occurrences DESC
LIMIT 100;
```
2025-01-19 11:15:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:15:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:15:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:15:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 36
2025-01-19 11:15:15 - snowflake.connector.connection - INFO - closed
2025-01-19 11:15:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:15:15 - root - INFO - SQL:
SELECT
    ep.value:"key"::STRING AS param_key,
    COUNT(*) AS occurrences
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
GROUP BY param_key
ORDER BY occurrences DESC
LIMIT 100;
Results:
PARAM_KEY,OCCURRENCES
firebase_event_origin,50000
firebase_screen_class,49316
firebase_screen_id,49316
firebase_previous_id,21079
firebase_previous_class,21079
board,11417
engagement_time_msec,11200
level,3702
level_name,3466
value,2402
score,2045
firebase_screen,1420
content_type,947
item_id,947
firebase_conversion,881
time,772
firebase_previous_screen,662
virtual_currency_name,121
item_name,121
update_with_analytics,46
previous_first_open_count,46
source,35
medium,35
system_app,26
system_app_update,26
firebase_error,24
error_value,24
fatal,24
previous_os_version,24
timestamp,24
click_timestamp,22
previous_app_version,19
type,9
ad_unit_code,9
gclid,8
ad_event_id,4

2025-01-19 11:15:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:15:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:15:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:15:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:15:17 - snowflake.connector.connection - INFO - closed
2025-01-19 11:15:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:15:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:15:55 - root - INFO - ```sql
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_timestamp"
) sub
WHERE board IS NOT NULL AND score IS NOT NULL
GROUP BY board;
```
2025-01-19 11:15:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:15:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:15:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:15:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:15:57 - snowflake.connector.connection - INFO - closed
2025-01-19 11:15:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:16:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:16:34 - root - INFO - ```sql
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete'
    GROUP BY t."event_timestamp"
) sub
WHERE board IS NOT NULL AND score IS NOT NULL
GROUP BY board;
```
2025-01-19 11:16:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:16:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:16:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:16:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:16:35 - snowflake.connector.connection - INFO - closed
2025-01-19 11:16:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:17:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:17:09 - root - INFO - ```sql
SELECT
    "board",
    AVG("score") AS average_score
FROM (
    SELECT
        t."event_id",
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_id"
) sub
WHERE "board" IS NOT NULL AND "score" IS NOT NULL
GROUP BY "board";
```
2025-01-19 11:17:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:17:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:17:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:17:10 - snowflake.connector.connection - INFO - closed
2025-01-19 11:17:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:17:11 - root - INFO - SQL:
SELECT
    "board",
    AVG("score") AS average_score
FROM (
    SELECT
        t."event_id",
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_id"
) sub
WHERE "board" IS NOT NULL AND "score" IS NOT NULL
GROUP BY "board";
Results:
000904 (42000): 01b9d085-0004-7b17-0001-11c300ef4536: SQL compilation error: error line 6 at position 8
invalid identifier 'T."event_id"'
2025-01-19 11:17:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:17:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:17:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:17:12 - snowflake.connector.connection - INFO - closed
2025-01-19 11:17:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:17:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:17:31 - root - INFO - ```sql
SELECT DISTINCT f.KEY
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```
2025-01-19 11:17:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:17:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:17:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:17:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 11:17:32 - snowflake.connector.connection - INFO - closed
2025-01-19 11:17:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:17:33 - root - INFO - SQL:
SELECT DISTINCT f.KEY
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Results:
KEY
""

2025-01-19 11:17:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:17:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:17:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:17:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:17:34 - snowflake.connector.connection - INFO - closed
2025-01-19 11:17:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:18:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:18:03 - root - INFO - ```sql
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE board IS NOT NULL AND score IS NOT NULL
GROUP BY board;
```
2025-01-19 11:18:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:18:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:18:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:18:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:18:04 - snowflake.connector.connection - INFO - closed
2025-01-19 11:18:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:19:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:19:00 - root - INFO - ```sql
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        COALESCE(
            params:"board":"string_value"::STRING,
            TO_VARCHAR(params:"board":"int_value"::INT),
            TO_VARCHAR(params:"board":"double_value"::FLOAT)
        ) AS board,
        TRY_TO_NUMBER(
            COALESCE(
                params:"score":"string_value",
                params:"score":"int_value"::STRING,
                params:"score":"double_value"::STRING
            )
        ) AS score
    FROM (
        SELECT
            t."event_name",
            t."event_timestamp",
            t."user_pseudo_id",
            OBJECT_CONSTRUCT_AGG(ep.value:"key"::STRING, ep.value:"value") AS params
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
             LATERAL FLATTEN(input => t."event_params") ep
        GROUP BY t."event_name", t."event_timestamp", t."user_pseudo_id"
    ) sub
    WHERE params:"board" IS NOT NULL AND params:"score" IS NOT NULL
) data
GROUP BY board;
```
2025-01-19 11:19:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:19:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:19:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:19:01 - snowflake.connector.connection - INFO - closed
2025-01-19 11:19:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:19:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:19:54 - root - INFO - ```sql
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN f.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(f.value:"value":"string_value", f.value:"value":"int_value"::STRING)
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") f
    GROUP BY t."event_name", t."event_timestamp"
) sub
WHERE board IS NOT NULL AND score IS NOT NULL
GROUP BY board;
```
2025-01-19 11:19:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:19:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:19:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:19:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:19:55 - snowflake.connector.connection - INFO - closed
2025-01-19 11:19:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:19:56 - root - INFO - SQL:
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN f.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(f.value:"value":"string_value", f.value:"value":"int_value"::STRING)
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") f
    GROUP BY t."event_name", t."event_timestamp"
) sub
WHERE board IS NOT NULL AND score IS NOT NULL
GROUP BY board;
Results:
No data found for the specified query.

2025-01-19 11:19:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:19:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:19:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:19:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:19:57 - snowflake.connector.connection - INFO - closed
2025-01-19 11:19:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:20:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:20:49 - root - INFO - ```sql
SELECT
    board,
    AVG(value) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN ep.value:"key"::STRING = 'value' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS value
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE board IS NOT NULL AND value IS NOT NULL
GROUP BY board;
```
2025-01-19 11:20:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:20:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:20:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:20:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 11:20:51 - snowflake.connector.connection - INFO - closed
2025-01-19 11:20:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:20:51 - root - INFO - SQL:
SELECT
    board,
    AVG(value) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN ep.value:"key"::STRING = 'value' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS value
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE board IS NOT NULL AND value IS NOT NULL
GROUP BY board;
Results:
BOARD,AVERAGE_SCORE
S,20.471182
L,34.169231
M,28.181818

2025-01-19 11:20:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:20:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:20:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:20:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-19 11:20:52 - snowflake.connector.connection - INFO - closed
2025-01-19 11:20:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:20:53 - root - INFO - SQL:
SELECT "platform", COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
    GROUP BY "platform"
    LIMIT 1000;
Results:
platform,event_count
ANDROID,15426
IOS,34574

2025-01-19 11:20:53 - root - INFO - itercount: 0
2025-01-19 11:20:53 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Considered Tables and Columns:**

**Table:**
- `"FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"`: This table contains all the events recorded on September 15, 2018.

**Columns and Potential Usage:**

- `"event_name"`: Used to identify events related to quick play mode completions.
- `"event_date"`: Used to confirm the date of the events.
- `"event_timestamp"`: May be used to filter events within specific time ranges on the day.
- `"event_params"`: A VARIANT column containing nested JSON data. Potentially includes:
  - `"board_type"`: The type of board used in the game.
  - `"score"`: The score achieved by the user.
  - `"mode"`: The game mode, which can help to filter for quick play mode.
- `"user_id"`: Can be used to identify unique users if needed.

**Conditions That May Be Used:**

- `WHERE "event_name" ILIKE '%quick%play%completed%'`: To filter events related to quick play mode completions.
- `WHERE "event_date" = '20180915'`: To ensure we are only looking at events from September 15, 2018.
- `WHERE "event_params":VARIANT:"mode"::STRING = 'quick_play'`: To filter events specifically in quick play mode.
- `WHERE "event_params":VARIANT:"board_type" IS NOT NULL`: To focus on events where the board type is recorded.

**SQL Queries to Understand Values in Related Columns:**

1. **Retrieve distinct event names to see what types of events occurred on that day:**

   ```sql
   SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
   ```

2. **Check the format and values of the event dates:**

   ```sql
   SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
   ```

3. **List distinct event timestamps to understand the time distribution of events:**

   ```sql
   SELECT DISTINCT "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
   ```

4. **Explore the structure of "event_params" by selecting a sample of the data:**

   ```sql
   SELECT "event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
   ```

5. **Flatten "event_params" to see all keys and values present:**

   ```sql
   SELECT f."key", f."value"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
   LATERAL FLATTEN(input => "event_params") f
   LIMIT 1000;
   ```

6. **Identify all distinct board types used in events on that day:**

   ```sql
   SELECT DISTINCT f.value::VARIANT:"board_type"::STRING AS "board_type"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
   LATERAL FLATTEN(input => "event_params") f
   WHERE f.value::VARIANT:"board_type" IS NOT NULL
   LIMIT 1000;
   ```

7. **Get distinct mode values to confirm the modes available:**

   ```sql
   SELECT DISTINCT f.value::VARIANT:"mode"::STRING AS "mode"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
   LATERAL FLATTEN(input => "event_params") f
   WHERE f.value::VARIANT:"mode" IS NOT NULL
   LIMIT 1000;
   ```

8. **Retrieve sample scores from events to understand score distributions:**

   ```sql
   SELECT f.value::VARIANT:"score"::NUMBER AS "score"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
   LATERAL FLATTEN(input => "event_params") f
   WHERE f.value::VARIANT:"score" IS NOT NULL
   LIMIT 1000;
   ```

9. **Select distinct user IDs to estimate the number of users engaged:**

   ```sql
   SELECT DISTINCT "user_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
   ```

10. **Find events where "event_name" is related to quick play completions using fuzzy matching:**

    ```sql
    SELECT DISTINCT "event_name"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
    WHERE "event_name" ILIKE '%quick%play%complete%'
    LIMIT 1000;
    ```

11. **Extract "board_type" and "score" from "event_params" for events in quick play mode:**

    ```sql
    SELECT
        f.value::VARIANT:"board_type"::STRING AS "board_type",
        f.value::VARIANT:"score"::NUMBER AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
    LATERAL FLATTEN(input => "event_params") f
    WHERE f.value::VARIANT:"mode"::STRING = 'quick_play'
    LIMIT 1000;
    ```

12. **List all keys in "event_params" to fully understand its structure:**

    ```sql
    SELECT DISTINCT f."key"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
    LATERAL FLATTEN(input => "event_params") f
    LIMIT 1000;
    ```

13. **Identify events with non-null "board_type" and "score" values:**

    ```sql
    SELECT "event_name", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
    WHERE "event_params":VARIANT:"board_type" IS NOT NULL
      AND "event_params":VARIANT:"score" IS NOT NULL
    LIMIT 1000;
    ```

14. **Find events where users achieved a score greater than a certain threshold:**

    ```sql
    SELECT f.value::VARIANT:"user_id"::STRING AS "user_id", f.value::VARIANT:"score"::NUMBER AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
    LATERAL FLATTEN(input => "event_params") f
    WHERE f.value::VARIANT:"score"::NUMBER > 1000
    LIMIT 1000;
    ```

15. **Explore event counts per "platform" to understand user distribution:**

    ```sql
    SELECT "platform", COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
    GROUP BY "platform"
    LIMIT 1000;
    ```

These queries are designed to help understand the structure and content of the data in the relevant columns. They explore different aspects such as event names, dates, parameters, user IDs, and other attributes that are crucial for performing the analysis required for the task.Query:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Answer:
event_name
first_open
app_update
app_exception
level_retry_quickplay
level_fail
error
level_complete
level_up
level_reset
completed_5_levels
spend_virtual_currency
no_more_extra_steps
ad_reward
firebase_campaign
app_remove
challenge_a_friend
post_score
level_retry
level_start
screen_view
select_content
user_engagement
level_end_quickplay
level_reset_quickplay
level_start_quickplay
level_complete_quickplay
os_update
use_extra_steps
level_end
session_start
level_fail_quickplay
Query:
SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Answer:
event_date
20180915
Query:
SELECT DISTINCT "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Answer:
Too long, hard cut:
event_timestamp
1537076339359000
1537051267227000
1537005246537000
1537040769430000
1537043473906000
1537031154410000
1537054497182000
1537003648146000
1537047872198000
1537024207496000
1537033428081000
1537050812506003
1537050751507004
1537067332037000
1537032995920000
1537018737041000
1537041658827001
1537068765508000
1537022362749000
1537067741424002
1537067699749000
1537038441589000
1536995780777000
1537067846686000
1537075615932000
1537053142420000
1537043707699000
1537025889057000
1537078255387033
1537074967910032
1537023190841033
1537061571114000
1537062499941002
1537005304030086
1537069365733330
1537005917769000
1537057883894000
1537041707829002
1537046237189000
1537036031425000
1537017536255000
1537034208497000
1537075301232000
1537023606262029
1537061423077000
1537061395077030
1537061868174000
1537062358545039
1537065366266001
1537049179949016
1537068586559063
1537018108650010
1537018168650011
1537006365446001
1537007483804152
1537007964848202
1537010784960003
1537028994222030
1537057384012004
1537008487500014
1537048542412013
1537001919928156
1537012199625022
1537069185545235
1537040757487005
1537050722579000
1537054134796000
1537061448359000
1537077753138000
1537020758462000
1537013441404000
1537028747146000
1537043114002000
1537026723607001
1537023016297000
1537023484905013
1537061446873000
1537061460259010
1537061723255003
1537065306943024
1537051455687001
1537006274862000
1537006433446016
1537006765087000
1537035403701003
1537050268258000
1537027750027000
1537066659421000
1537048716124000
1537058186682000
1537006149051006
1536996352546001
1537009813616004
1537078293728054
1537023076878106
1537061462873003
1537061573114022
1537061717134000
1537061629134003
1537061690684011
1537062032756006
1537062167682003
1537062519941063
1537005496910021
1537036304287001
1537005923206012
1537061889712000
1537065144069001
1537033595781009
1537068698203087
1537068868077154
1537005866077003
1537006110079001
1537006069079004
1537006320823003
1537006650384003
1537006801796001
1537006933652003
1537007763192010
1537008154018012
1537008958000016
1537009138027017
1537000394403003
1537073245203005
1537061450304003
1537061963756001
1537039402874018
1537062471428004
1537035661971105
1537029360059001
1537065338356006
1537005891077000
1537005847769007
1537006225862003
1537006567647038
1537006859796019
1537006856220002
1537006879220042
1537006975652055
1537006971655079
1537007401511126
1537008133018224
1537009518427003
1537010714960000
1537073798643041
1537000350450000
1537000328450003
1537000386403000
1537035351701000
1537067076422034
1537000593056054
1537051914240015
1537066882260006
1537017727923058
1537035523007076
1537008432500258
1537061218699025
1537066073726005
1537051053156083
1537051000891075
1537033293928015
1537062626234040
1537048841473002
1537037186671003
1536999768843025
1536994894504000
1536994971504003
1536995007600011
1537032693227089
1537020117458004
1537067198753092
1537067697508081
1537067985532019
1537068140987035
1537068862385031
1537068885038050
1537070555472081
1537070989103077
1537071196565187
1537049829532003
1537066997079018
1537057591501073
1537056606412005
1537043511878003
1537025859133004
1537034550953013
1537020822324026
1537056501492009
1537034474193000
1537054604632000
1537054581632000
1537018719929396
1537058875383028
1537061979756000
1537035350209056
1537005827176009
1537009113027338
1537040738488006
1537039355296000
1537018044113000
1537006091050005
1537031597919000
1537061712255000
1537061806174001
1537073953849001
1537035710888126
1537035780465155
1537068514962014
1537018096663012
1537005810176000
1537006023597003
1537006078079000
1537007235308113
1537007530367009
1537007937848011
1537008330532013
1537008916000315
1537010918627001
1537010878627030
1537005747358002
1537000293358045
1537071472908015
1537052348686002
1537048544686000
1537066889262007
1537016079149003
1537065888414000
1537006059084000
1537022727097015
1537061458304000
1537061928347000
1537062177682000
1537062298280016
1537070167231093
1537005908206011
1537074020581000
1537034816634026
1537068236196242
1537068295003262
1537068781611107
1537069288267280
1537005955597000
1537006383823000
1537006582384050
1537006762087006
1537007011655004
1537007127939005
1537007128939092
1537007386511007
1537007436804008
1537007751192189
1537008299532236
1537008544519015
1537009310550011
1537009496427000
1537073799643040
1537074107701015
1537000295358000
1537000467159000
1537000401159001
1537000455159004
1537029072031015
1537078606084140
1537052354684001
1537000533378041
1537000422317004
1537000567378042
1537029533197027
1537017762947059
1537062240280001
1537031313530015
1537007304308006
1537045222788001
1537074781557001
1537021351819006
1537069338508310
1537005795356001
1537065888414023
1537066046726000
1537065954815001
1537050914231027
1537050956185039
1537050992891074
1537051058339095
1537050943231028
1537050891185040
1537050964339096
1537033294376015
1537033287383017
1537033291376016
1537033285922014
1537062612234000
1537023014443010
153
Query:
SELECT "event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   LIMIT 1000;
Answer:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""previous_app_version"",
    ""value"": {
      ""string_value"": ""2.2.5""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""previous_os_version"",
    ""value"": {
      ""string_value"": ""9.3.2""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172545
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value
Query:
SELECT
    f.VALUE:"key"::STRING AS param_key,
    COALESCE(
        f.VALUE:"value":"string_value"::STRING,
        TO_VARCHAR(f.VALUE:"value":"int_value"::INT),
        TO_VARCHAR(f.VALUE:"value":"float_value"::FLOAT)
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Answer:
Too long, hard cut:
PARAM_KEY,PARAM_VALUE
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,5640021151996172547
previous_app_version,2.2.5
firebase_screen_class,main_menu
firebase_event_origin,auto
previous_os_version,9.3.2
firebase_screen_id,5640021151996172547
firebase_screen_class,main_menu
firebase_event_origin,auto
firebase_screen_id,5640021151996172545
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6713771638975339060
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,2
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
previous_app_version,2.2.5
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,9.3.3
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7436990882465658089
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
firebase_screen_id,8204971095873061646
firebase_screen_class,main_menu
update_with_analytics,1
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7228239341162181857
previous_app_version,2.6.26
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,11.2.6
firebase_screen_id,-7228239341162181857
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
timestamp,1537067682000
fatal,1
firebase_event_origin,clx
firebase_screen_id,-904519747924484668
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0

Query:
SELECT
    ep.VALUE:"key"::STRING AS param_key,
    COALESCE(
        ep.VALUE:"value":"string_value"::STRING,
        TO_VARCHAR(ep.VALUE:"value":"int_value"::INT),
        TO_VARCHAR(ep.VALUE:"value":"double_value"::FLOAT)
    ) AS param_value
FROM
    "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915",
    LATERAL FLATTEN(input => "event_params") ep
LIMIT 1000;
Answer:
Too long, hard cut:
PARAM_KEY,PARAM_VALUE
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,5640021151996172547
previous_app_version,2.2.5
firebase_screen_class,main_menu
firebase_event_origin,auto
previous_os_version,9.3.2
firebase_screen_id,5640021151996172547
firebase_screen_class,main_menu
firebase_event_origin,auto
firebase_screen_id,5640021151996172545
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6713771638975339060
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,2
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
previous_app_version,2.2.5
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,9.3.3
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
firebase_screen_id,6383319623192119062
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7436990882465658089
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
firebase_screen_id,8204971095873061646
firebase_screen_class,main_menu
update_with_analytics,1
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
firebase_screen_id,-7228239341162181857
previous_app_version,2.6.26
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
previous_os_version,11.2.6
firebase_screen_id,-7228239341162181857
firebase_screen_class,FIRootViewController
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,1
firebase_conversion,1
firebase_event_origin,auto
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
timestamp,1537067682000
fatal,1
firebase_event_origin,clx
firebase_screen_id,-904519747924484668
firebase_screen_class,FIRootViewController
update_with_analytics,1
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0
firebase_conversion,1
firebase_event_origin,auto
system_app,0
system_app_update,0
update_with_analytics,0
previous_first_open_count,0

Query:
SELECT
    t."event_name",
    t."event_params"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t
LIMIT 1000;
Answer:
Too long, hard cut:
event_name,event_params
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
app_update,"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""previous_app_version"",
    ""value"": {
      ""string_value"": ""2.2.5""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
os_update,"[
  {
    ""key"": ""previous_os_version"",
    ""value"": {
      ""string_value"": ""9.3.2""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172547
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""main_menu""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 5640021151996172545
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_app_update"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""update_with_analytics"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""previous_first_open_count"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""firebase_conversion"",
    ""value"": {
      ""int_value"": 1
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""auto""
    }
  }
]"
first_open,"[
  {
    ""key"": ""system_app"",
    ""value"": {
      ""int_value"": 0
    }
  },
  {
    ""key"": ""system_
Query:
SELECT
    t."event_name",
    ep.value:"key"::STRING AS param_key,
    COALESCE(
        ep.value:"value":"string_value",
        ep.value:"value":"int_value"::STRING,
        ep.value:"value":"double_value"::STRING
    ) AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
LIMIT 1000;
Answer:
Too long, hard cut:
event_name,PARAM_KEY,PARAM_VALUE
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
app_update,firebase_screen_id,5640021151996172547
app_update,previous_app_version,2.2.5
app_update,firebase_screen_class,main_menu
app_update,firebase_event_origin,auto
os_update,previous_os_version,9.3.2
os_update,firebase_screen_id,5640021151996172547
os_update,firebase_screen_class,main_menu
os_update,firebase_event_origin,auto
first_open,firebase_screen_id,5640021151996172545
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,firebase_screen_id,6713771638975339060
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,2
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
app_update,firebase_screen_id,6383319623192119062
app_update,previous_app_version,2.2.5
app_update,firebase_screen_class,FIRootViewController
app_update,firebase_event_origin,auto
os_update,previous_os_version,9.3.3
os_update,firebase_screen_id,6383319623192119062
os_update,firebase_screen_class,FIRootViewController
os_update,firebase_event_origin,auto
first_open,firebase_screen_id,6383319623192119062
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,firebase_screen_id,-7436990882465658089
first_open,firebase_screen_class,FIRootViewController
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,system_app,0
first_open,system_app_update,0
first_open,update_with_analytics,0
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,1
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,previous_first_open_count,0
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
first_open,update_with_analytics,0
first_open,firebase_screen_id,8204971095873061646
first_open,firebase_screen_class,main_menu
first_open,update_with_analytics,1
first_open,previous_first_open_count,1
first_open,firebase_conversion,1
first_open,firebase_event_origin,auto
app_update,firebase_screen_id,-7228239341162181857
app_update,pr
Query:
SELECT
    t."event_name",
    ep.value:"key"::STRING AS param_key,
    ep.value:"value" AS param_value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
LIMIT 1000;
Answer:
Too long, hard cut:
event_name,PARAM_KEY,PARAM_VALUE
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
app_update,firebase_screen_id,"{
  ""int_value"": 5640021151996172547
}"
app_update,previous_app_version,"{
  ""string_value"": ""2.2.5""
}"
app_update,firebase_screen_class,"{
  ""string_value"": ""main_menu""
}"
app_update,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
os_update,previous_os_version,"{
  ""string_value"": ""9.3.2""
}"
os_update,firebase_screen_id,"{
  ""int_value"": 5640021151996172547
}"
os_update,firebase_screen_class,"{
  ""string_value"": ""main_menu""
}"
os_update,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,firebase_screen_id,"{
  ""int_value"": 5640021151996172545
}"
first_open,firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
first_open,update_with_analytics,"{
  ""int_value"": 1
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 1
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{
  ""string_value"": ""auto""
}"
first_open,system_app,"{
  ""int_value"": 0
}"
first_open,system_app_update,"{
  ""int_value"": 0
}"
first_open,update_with_analytics,"{
  ""int_value"": 0
}"
first_open,previous_first_open_count,"{
  ""int_value"": 0
}"
first_open,firebase_conversion,"{
  ""int_value"": 1
}"
first_open,firebase_event_origin,"{

Query:
SELECT
    ep.value:"key"::STRING AS param_key,
    COUNT(*) AS occurrences
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") ep
GROUP BY param_key
ORDER BY occurrences DESC
LIMIT 100;
Answer:
PARAM_KEY,OCCURRENCES
firebase_event_origin,50000
firebase_screen_class,49316
firebase_screen_id,49316
firebase_previous_id,21079
firebase_previous_class,21079
board,11417
engagement_time_msec,11200
level,3702
level_name,3466
value,2402
score,2045
firebase_screen,1420
content_type,947
item_id,947
firebase_conversion,881
time,772
firebase_previous_screen,662
virtual_currency_name,121
item_name,121
update_with_analytics,46
previous_first_open_count,46
source,35
medium,35
system_app,26
system_app_update,26
firebase_error,24
error_value,24
fatal,24
previous_os_version,24
timestamp,24
click_timestamp,22
previous_app_version,19
type,9
ad_unit_code,9
gclid,8
ad_event_id,4
Query:
SELECT
    "board",
    AVG("score") AS average_score
FROM (
    SELECT
        t."event_id",
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_id"
) sub
WHERE "board" IS NOT NULL AND "score" IS NOT NULL
GROUP BY "board";
Answer:
000904 (42000): 01b9d085-0004-7b17-0001-11c300ef4536: SQL compilation error: error line 6 at position 8
invalid identifier 'T."event_id"'Query:
SELECT DISTINCT f.KEY
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Answer:
KEY
""
Query:
SELECT
    board,
    AVG(score) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN f.value:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(f.value:"value":"string_value", f.value:"value":"int_value"::STRING)
        ) END) AS score
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") f
    GROUP BY t."event_name", t."event_timestamp"
) sub
WHERE board IS NOT NULL AND score IS NOT NULL
GROUP BY board;
Answer:
No data found for the specified query.
Query:
SELECT
    board,
    AVG(value) AS average_score
FROM (
    SELECT
        MAX(CASE WHEN ep.value:"key"::STRING = 'board' THEN ep.value:"value":"string_value"::STRING END) AS board,
        MAX(CASE WHEN ep.value:"key"::STRING = 'value' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.value:"value":"string_value",
                ep.value:"value":"int_value"::STRING,
                ep.value:"value":"double_value"::STRING
            )
        ) END) AS value
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE board IS NOT NULL AND value IS NOT NULL
GROUP BY board;
Answer:
BOARD,AVERAGE_SCORE
S,20.471182
L,34.169231
M,28.181818
Query:
SELECT "platform", COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
    GROUP BY "platform"
    LIMIT 1000;
Answer:
platform,event_count
ANDROID,15426
IOS,34574
End Exploring Related Columns
Task: I'm trying to evaluate which board types were most effective on September 15, 2018. Can you find out the average scores for each board type from the quick play mode completions on that day?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: To evaluate the effectiveness of different board types on September 15, 2018, we calculated the average scores for each board type based on quick play mode completions on that day.

```csv
board_type,average_score
type1:str,avg_score1:float
type2:str,avg_score2:float
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 11:21:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:21:40 - root - INFO - To evaluate the effectiveness of different board types on September 15, 2018, we calculated the average scores for each board type based on quick play mode completions on that day.

```sql
SELECT 
    "board" AS "board_type",
    AVG("score") AS "average_score"
FROM (
    SELECT 
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'board' THEN ep.VALUE:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.VALUE:"value":"string_value",
                ep.VALUE:"value":"int_value"::STRING,
                ep.VALUE:"value":"double_value"::STRING
            )
        ) END) AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE "board" IS NOT NULL AND "score" IS NOT NULL
GROUP BY "board";
```
2025-01-19 11:21:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:21:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:21:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:21:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 11:21:41 - snowflake.connector.connection - INFO - closed
2025-01-19 11:21:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:21:42 - root - INFO - itercount: 1
2025-01-19 11:21:42 - root - INFO - No data found for the specified query.

2025-01-19 11:21:42 - root - INFO - Input sql:
SELECT 
    "board" AS "board_type",
    AVG("score") AS "average_score"
FROM (
    SELECT 
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'board' THEN ep.VALUE:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'score' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.VALUE:"value":"string_value",
                ep.VALUE:"value":"int_value"::STRING,
                ep.VALUE:"value":"double_value"::STRING
            )
        ) END) AS "score"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE "board" IS NOT NULL AND "score" IS NOT NULL
GROUP BY "board";
The error information is:
 No data found for the specified query.

2025-01-19 11:22:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:22:17 - root - INFO - It appears that the `score` parameter might not be present in the `level_complete_quickplay` events. Instead, the `value` parameter likely represents the score in these events. To resolve the issue, we'll adjust the query to use the `value` parameter instead of `score`.

Here is the updated SQL query:

```sql
SELECT 
    "board" AS "board_type",
    AVG("value") AS "average_score"
FROM (
    SELECT 
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'board' THEN ep.VALUE:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'value' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.VALUE:"value":"string_value",
                ep.VALUE:"value":"int_value"::STRING,
                ep.VALUE:"value":"double_value"::STRING
            )
        ) END) AS "value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE "board" IS NOT NULL AND "value" IS NOT NULL
GROUP BY "board";
```

This query calculates the average `value` (which represents the score) for each `board` type from the `level_complete_quickplay` events on September 15, 2018.
2025-01-19 11:22:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:22:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:22:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:22:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 11:22:18 - snowflake.connector.connection - INFO - closed
2025-01-19 11:22:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:22:19 - root - INFO - itercount: 2
2025-01-19 11:22:19 - root - INFO - 0
2025-01-19 11:22:19 - root - INFO - results: 
board_type,average_score
L,34.169231
S,20.471182
M,28.181818


2025-01-19 11:22:19 - root - INFO - Please check the answer again by reviewing I'm trying to evaluate which board types were most effective on September 15, 2018. Can you find out the average scores for each board type from the quick play mode completions on that day?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To evaluate the effectiveness of different board types on September 15, 2018, we calculated the average scores for each board type based on quick play mode completions on that day.

```csv
board_type,average_score
type1:str,avg_score1:float
type2:str,avg_score2:float
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
board_type,average_score
L,34.169231
S,20.471182
M,28.181818
Current sql:
SELECT 
    "board" AS "board_type",
    AVG("value") AS "average_score"
FROM (
    SELECT 
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'board' THEN ep.VALUE:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'value' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.VALUE:"value":"string_value",
                ep.VALUE:"value":"int_value"::STRING,
                ep.VALUE:"value":"double_value"::STRING
            )
        ) END) AS "value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE "board" IS NOT NULL AND "value" IS NOT NULL
GROUP BY "board";
2025-01-19 11:22:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 11:22:54 - root - INFO - To evaluate the effectiveness of different board types on September 15, 2018, we calculated the average scores for each board type based on quick play mode completions on that day.

```csv
board_type,average_score
L,34.1692
M,28.1818
S,20.4712
```

```sql
SELECT 
    "board" AS "board_type",
    ROUND(AVG("value"), 4) AS "average_score"
FROM (
    SELECT 
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'board' THEN ep.VALUE:"value":"string_value"::STRING END) AS "board",
        MAX(CASE WHEN ep.VALUE:"key"::STRING = 'value' THEN TRY_TO_NUMBER(
            COALESCE(
                ep.VALUE:"value":"string_value",
                ep.VALUE:"value":"int_value"::STRING,
                ep.VALUE:"value":"double_value"::STRING
            )
        ) END) AS "value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE t."event_name" = 'level_complete_quickplay'
    GROUP BY t."event_timestamp", t."user_pseudo_id"
) sub
WHERE "board" IS NOT NULL AND "value" IS NOT NULL
GROUP BY "board";
```
2025-01-19 11:22:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 11:22:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 11:22:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 11:22:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-19 11:22:55 - snowflake.connector.connection - INFO - closed
2025-01-19 11:22:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 11:22:56 - root - INFO - itercount: 3
2025-01-19 11:22:56 - root - INFO - 0
2025-01-19 11:22:56 - root - INFO - Total iteration counts: 3
