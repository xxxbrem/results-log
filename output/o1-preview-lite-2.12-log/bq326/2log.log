2025-02-11 04:54:34 - openai._base_client - INFO - Retrying request to /chat/completions in 0.472750 seconds
2025-02-11 04:56:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 04:56:09 - root - INFO - SQL:
SELECT DISTINCT indicator_code, indicator_name
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE LOWER(indicator_name) LIKE '%health expenditure per capita%'
LIMIT 100;
Results:
indicator_code,indicator_name
SH.XPD.CHEX.PC.CD,Current health expenditure per capita (current US$)
SH.XPD.CHEX.PP.CD,"Current health expenditure per capita, PPP (current international $)"
SH.XPD.GHED.PP.CD,"Domestic general government health expenditure per capita, PPP (current international $)"
SH.XPD.EHEX.PC.CD,External health expenditure per capita (current US$)
SH.XPD.GHED.PC.CD,Domestic general government health expenditure per capita (current US$)
SH.XPD.PVTD.PP.CD,"Domestic private health expenditure per capita, PPP  (current international $)"
SH.XPD.PVTD.PC.CD,Domestic private health expenditure per capita (current US$)
SH.XPD.EHEX.PP.CD,"External health expenditure per capita, PPP (current international $)"

2025-02-11 04:56:10 - root - INFO - SQL:
SELECT DISTINCT indicator_code, indicator_name
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE LOWER(indicator_name) LIKE '%current health expenditure per capita%'
  AND LOWER(indicator_name) LIKE '%ppp%'
LIMIT 100;
Results:
indicator_code,indicator_name
SH.XPD.CHEX.PP.CD,"Current health expenditure per capita, PPP (current international $)"

2025-02-11 04:56:11 - root - INFO - SQL:
SELECT country_code, country_name, year, value AS health_expenditure_per_capita_ppp
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
  AND year IN (2017, 2018)
LIMIT 100;
Results:
country_code,country_name,year,health_expenditure_per_capita_ppp
DJI,Djibouti,2017,134.43319702
MUS,Mauritius,2018,1380.73596191
MNG,Mongolia,2017,512.30932617
MNE,Montenegro,2018,1711.20996094
NIC,Nicaragua,2017,473.00387573
PHL,Philippines,2018,393.90402222
POL,Poland,2017,1978.63806152
SLE,Sierra Leone,2017,255.2999115
IDN,Indonesia,2017,352.1897583
KGZ,Kyrgyz Republic,2018,259.92599487
MIC,Middle income,2017,613.584403311481
ATG,Antigua and Barbuda,2017,1274.50341797
LCA,St. Lucia,2017,636.71325684
ARG,Argentina,2018,1989.63562012
BEL,Belgium,2017,5289.40039063
BFA,Burkina Faso,2018,111.71577454
MDA,Moldova,2018,479.85287476
DEU,Germany,2017,5930.57617188
PER,Peru,2017,698.16088867
ROU,Romania,2017,1367.82080078
TSS,Sub-Saharan Africa (IDA & IBRD countries),2017,201.156557039325
BHR,Bahrain,2018,1955.35192871
CPV,Cabo Verde,2017,375.52709961
PAK,Pakistan,2017,152.12948608
HIC,High income,2018,6065.06312742882
TLA,Latin America & the Caribbean (IDA & IBRD countries),2018,1228.16209266781
PRY,Paraguay,2018,935.32897949
SMR,San Marino,2017,4262.75585938
SVN,Slovenia,2017,2960.59326172
MEA,Middle East & North Africa,2018,1336.40615439374
LBN,Lebanon,2018,1085.85119629
CUB,Cuba,2017,2517.68164063
NZL,New Zealand,2017,3815.65722656
HIC,High income,2017,5857.99472467572
KEN,Kenya,2017,157.59783936
SAS,South Asia,2018,249.034231503484
LSO,Lesotho,2018,308.99752808
THA,Thailand,2017,686.5927124
BRA,Brazil,2017,1482.5333252
BGR,Bulgaria,2018,1633.80444336
TCD,Chad,2018,79.01350403
MKD,North Macedonia,2018,1073.19555664

2025-02-11 04:56:12 - root - INFO - SQL:
SELECT country_code, country, year_2017, year_2018
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
LIMIT 100;
Results:
country_code,country,year_2017,year_2018
SXM,Sint Maarten (Dutch part),40574.0,40654.0
INX,Not classified,,
PSE,West Bank and Gaza,4454805.0,4569087.0
SRB,Serbia,7020858.0,6982084.0
KHM,Cambodia,16009414.0,16249798.0
ARE,United Arab Emirates,9487203.0,9630959.0
CYP,Cyprus,1179680.0,1189265.0
LMC,Lower middle income,2981420591.0,3022905169.0
MDV,Maldives,496402.0,515696.0
LIC,Low income,687449530.0,705417321.0
PER,Peru,31444297.0,31989256.0
EAR,Early-demographic dividend,3207188541.0,3249140605.0
FJI,Fiji,877459.0,883483.0
TCD,Chad,15016773.0,15477751.0
MNA,Middle East & North Africa (excluding high income),376546755.0,382896715.0
TMN,Middle East & North Africa (IDA & IBRD countries),372091950.0,378327628.0
WLD,World,7510990456.0,7594270356.0
SAU,Saudi Arabia,33099147.0,33699947.0
DOM,Dominican Republic,10513131.0,10627165.0
KEN,Kenya,50221473.0,51393010.0
VEN,"Venezuela, RB",29390409.0,28870195.0
CAN,Canada,36540268.0,37058856.0
GIN,Guinea,12067539.0,12414318.0
PAK,Pakistan,207896686.0,212215030.0
LVA,Latvia,1942248.0,1926542.0
DNK,Denmark,5764980.0,5797446.0
HKG,"Hong Kong SAR, China",7391700.0,7451000.0
NRU,Nauru,12876.0,12704.0
QAT,Qatar,2724724.0,2781677.0
USA,United States,325147121.0,327167434.0
TEC,Europe & Central Asia (IDA & IBRD countries),457810292.0,459865205.0
BRA,Brazil,207833831.0,209469333.0
NGA,Nigeria,190873311.0,195874740.0
YEM,"Yemen, Rep.",27834821.0,28498687.0
MKD,North Macedonia,2081996.0,2082958.0
NAM,Namibia,2402603.0,2448255.0
RWA,Rwanda,11980937.0,12301939.0
LDC,Least developed countries: UN classification,986365080.0,1009662578.0
CEB,Central Europe and the Baltics,102738854.0,102511922.0
CPV,Cabo Verde,537497.0,543767.0
BRN,Brunei Darussalam,424473.0,428962.0
PHL,Philippines,105173264.0,106651922.0
PLW,Palau,17808.0,17907.0
LKA,Sri Lanka,21444000.0,21670000.0
STP,Sao Tome and Principe,207089.0,211028.0
HTI,Haiti,10982366.0,11123176.0
PSS,Pacific island small states,2422086.0,2457367.0
CHN,China,1386395000.0,1392730000.0
DEU,Germany,82657002.0,82927922.0
MAF,St. Martin (French part),36560.0,37264.0
FRO,Faroe Islands,48331.0,48497.0
NOR,Norway,5276968.0,5314336.0

2025-02-11 04:56:13 - root - INFO - SQL:
SELECT country_code, country,
  ((year_2018 - year_2017) / CAST(year_2017 AS FLOAT64)) * 100 AS percent_increase_population
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
LIMIT 100;
Results:
country_code,country,percent_increase_population
SXM,Sint Maarten (Dutch part),0.1971706018632622
INX,Not classified,
PSE,West Bank and Gaza,2.565364813948085
SRB,Serbia,-0.552268682830503
KHM,Cambodia,1.5015165452027164
ARE,United Arab Emirates,1.5152621905528953
CYP,Cyprus,0.8125084768750848
LMC,Lower middle income,1.3914366233744175
MDV,Maldives,3.8867691910991495
LIC,Low income,2.613688745994197
PER,Peru,1.7330932855646286
EAR,Early-demographic dividend,1.3080635411262527
FJI,Fiji,0.6865278035782869
TCD,Chad,3.0697540676682
MNA,Middle East & North Africa (excluding high income),1.6863669426655927
TMN,Middle East & North Africa (IDA & IBRD countries),1.6758432962605077
WLD,World,1.10877387593368
SAU,Saudi Arabia,1.8151525173745415
DOM,Dominican Republic,1.0846816233907863
KEN,Kenya,2.332741216092965
VEN,"Venezuela, RB",-1.7700127956708598
CAN,Canada,1.4192233072838984
GIN,Guinea,2.873651371667413
PAK,Pakistan,2.077158651773795
LVA,Latvia,-0.8086505945687676
DNK,Denmark,0.5631589355036791
HKG,"Hong Kong SAR, China",0.8022511736136477
NRU,Nauru,-1.3358185771978874
QAT,Qatar,2.090230056328641
USA,United States,0.621353494930684
TEC,Europe & Central Asia (IDA & IBRD countries),0.4488568815311823
BRA,Brazil,0.7869277066831338
NGA,Nigeria,2.6202872333471494
YEM,"Yemen, Rep.",2.3850198282216364
MKD,North Macedonia,0.04620566033748384
NAM,Namibia,1.900105843537197
RWA,Rwanda,2.679272914964831
LDC,Least developed countries: UN classification,2.3619548656365654
CEB,Central Europe and the Baltics,-0.2208823547905255
CPV,Cabo Verde,1.1665181387058905
BRN,Brunei Darussalam,1.057546651966085
PHL,Philippines,1.4059257493425326
PLW,Palau,0.5559299191374663
LKA,Sri Lanka,1.0539078530124977
STP,Sao Tome and Principe,1.9020807478910033
HTI,Haiti,1.2821463061784684
PSS,Pacific island small states,1.4566369649962883
CHN,China,0.45694048233007184
DEU,Germany,0.32776412577847913

2025-02-11 04:56:15 - root - INFO - SQL:
SELECT country_code, country_name,
  SUM(CASE WHEN year = 2017 THEN value END) AS health_exp_2017,
  SUM(CASE WHEN year = 2018 THEN value END) AS health_exp_2018,
  ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
   / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
  AND year IN (2017, 2018)
GROUP BY country_code, country_name
LIMIT 100;
Results:
country_code,country_name,health_exp_2017,health_exp_2018,percent_increase_health_exp
DJI,Djibouti,134.43319702,134.88937378,0.3393334162335949
MUS,Mauritius,1278.09350586,1380.73596191,8.030903496449127
MNG,Mongolia,512.30932617,519.26660156,1.3580223967446232
MNE,Montenegro,,1711.20996094,
NIC,Nicaragua,473.00387573,473.92501831,0.19474313578897326
PHL,Philippines,370.81732178,393.90402222,6.225895901836266
POL,Poland,1978.63806152,2015.28588867,1.8521743750267778
SLE,Sierra Leone,255.2999115,257.32653809,0.7938218928838047
IDN,Indonesia,352.1897583,375.15563965,6.520882793655053
KGZ,Kyrgyz Republic,231.27180481,259.92599487,12.389832856426533
MIC,Middle income,613.584403311481,651.024194518279,6.101815985663521
ATG,Antigua and Barbuda,1274.50341797,1405.76794434,10.299268289062342
LCA,St. Lucia,636.71325684,610.52154541,-4.113580351693804
ARG,Argentina,2184.91918945,1989.63562012,-8.937793684678915
BEL,Belgium,5289.40039063,5404.91601563,2.1839077488751304
BFA,Burkina Faso,129.01049805,111.71577454,-13.405671454192172
MDA,Moldova,481.33169556,479.85287476,-0.3072352836186025
DEU,Germany,5930.57617188,6098.20263672,2.826478574456307
PER,Peru,698.16088867,766.63635254,9.807977642581225
ROU,Romania,1367.82080078,1576.29931641,15.24165413416109
TSS,Sub-Saharan Africa (IDA & IBRD countries),201.156557039325,205.394948790297,2.1070114806863676
BHR,Bahrain,2263.04296875,1955.35192871,-13.596341045612325
CPV,Cabo Verde,375.52709961,399.53582764,6.393341001204444
PAK,Pakistan,152.12948608,178.24232483,17.164876726309394
HIC,High income,5857.99472467572,6065.06312742882,3.534800089198823
TLA,Latin America & the Caribbean (IDA & IBRD countries),1230.69946390644,1228.16209266781,-0.2061731001796433
PRY,Paraguay,863.2098999,935.32897949,8.354755847720794
SMR,San Marino,4262.75585938,4340.04199219,1.8130555762403138
SVN,Slovenia,2960.59326172,3158.38500977,6.680814639667525

2025-02-11 04:56:16 - root - INFO - SQL:
SELECT country_code, country
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
WHERE ((year_2018 - year_2017) / CAST(year_2017 AS FLOAT64)) * 100 > 1
LIMIT 100;
Results:
country_code,country
PSE,West Bank and Gaza
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
MDV,Maldives
LIC,Low income
PER,Peru
EAR,Early-demographic dividend
TCD,Chad
MNA,Middle East & North Africa (excluding high income)
TMN,Middle East & North Africa (IDA & IBRD countries)
WLD,World
SAU,Saudi Arabia
DOM,Dominican Republic
KEN,Kenya
CAN,Canada
GIN,Guinea
PAK,Pakistan
QAT,Qatar
NGA,Nigeria
YEM,"Yemen, Rep."
NAM,Namibia
RWA,Rwanda
LDC,Least developed countries: UN classification
CPV,Cabo Verde
BRN,Brunei Darussalam
PHL,Philippines
LKA,Sri Lanka
STP,Sao Tome and Principe
HTI,Haiti
PSS,Pacific island small states
MAF,St. Martin (French part)
SST,Small states
TZA,Tanzania
BTN,Bhutan
ZMB,Zambia
GTM,Guatemala
OMN,Oman
TUN,Tunisia
ZAF,South Africa
PRE,Pre-demographic dividend
SLE,Sierra Leone
MEA,Middle East & North Africa
NIC,Nicaragua
FCS,Fragile and conflict affected situations
MEX,Mexico
MAR,Morocco
AGO,Angola
CMR,Cameroon
SLB,Solomon Islands
NER,Niger
SEN,Senegal
TSA,South Asia (IDA & IBRD)
SAS,South Asia
GNQ,Equatorial Guinea
HND,Honduras
IBT,IDA & IBRD total
BFA,Burkina Faso
CHI,Channel Islands
BDI,Burundi
AFG,Afghanistan
MDG,Madagascar
ETH,Ethiopia
PRY,Paraguay
MAC,"Macao SAR, China"
MNG,Mongolia
OSS,Other small states
LUX,Luxembourg
MLI,Mali
ARB,Arab World
BHR,Bahrain
COD,"Congo, Dem. Rep."
COL,Colombia
AUS,Australia
CHL,Chile
SOM,Somalia
BEN,Benin
IDA,IDA total
TJK,Tajikistan
TON,Tonga
KGZ,Kyrgyz Republic
COG,"Congo, Rep."
MIC,Middle income
COM,Comoros
MLT,Malta
NCL,New Caledonia
LMY,Low & middle income
IDN,Indonesia
IRQ,Iraq
BLZ,Belize
TLS,Timor-Leste
ZWE,Zimbabwe
SDN,Sudan
ECU,Ecuador
DJI,Djibouti
CYM,Cayman Islands
TKM,Turkmenistan
MYS,Malaysia
EGY,"Egypt, Arab Rep."
TCA,Turks and Caicos Islands

2025-02-11 04:56:17 - root - INFO - SQL:
SELECT country_code, country_name
FROM (
  SELECT country_code, country_name,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code, country_name
)
WHERE percent_increase_health_exp > 1
LIMIT 100;
Results:
country_code,country_name
MUS,Mauritius
MNG,Mongolia
PHL,Philippines
POL,Poland
IDN,Indonesia
KGZ,Kyrgyz Republic
MIC,Middle income
ATG,Antigua and Barbuda
BEL,Belgium
DEU,Germany
PER,Peru
ROU,Romania
TSS,Sub-Saharan Africa (IDA & IBRD countries)
CPV,Cabo Verde
PAK,Pakistan
HIC,High income
PRY,Paraguay
SMR,San Marino
SVN,Slovenia
NZL,New Zealand
KEN,Kenya
SAS,South Asia
LSO,Lesotho
THA,Thailand
BRA,Brazil
BGR,Bulgaria
MKD,North Macedonia
ISR,Israel
BOL,Bolivia
CHL,Chile
MAR,Morocco
AFW,Africa Western and Central
JPN,Japan
MDV,Maldives
BGD,Bangladesh
KHM,Cambodia
ARE,United Arab Emirates
ZMB,Zambia
HRV,Croatia
MMR,Myanmar
NPL,Nepal
EMU,Euro area
GIN,Guinea
SYC,Seychelles
ALB,Albania
SWE,Sweden
CHE,Switzerland
TUN,Tunisia
BTN,Bhutan
FIN,Finland
SGP,Singapore
IRL,Ireland
LMC,Lower middle income
SSF,Sub-Saharan Africa
LTU,Lithuania
VNM,Vietnam
ITA,Italy
WLD,World
LUX,Luxembourg
TZA,Tanzania
DOM,Dominican Republic
HUN,Hungary
UZB,Uzbekistan
DMA,Dominica
MCO,Monaco
GUY,Guyana
AUT,Austria
COM,Comoros
CYP,Cyprus
ECA,Europe & Central Asia (excluding high income)
LMY,Low & middle income
PNG,Papua New Guinea
VCT,St. Vincent and the Grenadines
ARM,Armenia
EAR,Early-demographic dividend
ISL,Iceland
OED,OECD members
TSA,South Asia (IDA & IBRD)
LKA,Sri Lanka
TON,Tonga
CAF,Central African Republic
TEC,Europe & Central Asia (IDA & IBRD countries)
SLV,El Salvador
EST,Estonia
IND,India
GBR,United Kingdom
CAN,Canada
LAC,Latin America & Caribbean (excluding high income)
CZE,Czech Republic
NOR,Norway
GNB,Guinea-Bissau
PRT,Portugal

2025-02-11 04:56:18 - root - INFO - SQL:
SELECT 
  pop.country_code,
  pop.country,
  ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 AS percent_increase_population,
  exp.percent_increase_health_exp
FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
JOIN (
  SELECT country_code,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code
) AS exp
ON pop.country_code = exp.country_code
LIMIT 100;
Results:
country_code,country,percent_increase_population,percent_increase_health_exp
SRB,Serbia,-0.552268682830503,10.058843469188531
KHM,Cambodia,1.5015165452027164,9.682096701147762
ARE,United Arab Emirates,1.5152621905528953,4.663505847905878
CYP,Cyprus,0.8125084768750848,5.058535450528741
LMC,Lower middle income,1.3914366233744175,4.859841588386322
MDV,Maldives,3.8867691910991495,7.064431850180757
LIC,Low income,2.613688745994197,-4.2655355575512415
PER,Peru,1.7330932855646286,9.807977642581225
EAR,Early-demographic dividend,1.3080635411262527,1.155713263926843
FJI,Fiji,0.6865278035782869,13.145350273636053
TCD,Chad,3.0697540676682,-7.782875489518702
MNA,Middle East & North Africa (excluding high income),1.6863669426655927,-3.043545348909082
TMN,Middle East & North Africa (IDA & IBRD countries),1.6758432962605077,-3.043545348909082
WLD,World,1.10877387593368,3.803807230162976
SAU,Saudi Arabia,1.8151525173745415,-6.392527005315368
DOM,Dominican Republic,1.0846816233907863,6.597805657430963
KEN,Kenya,2.332741216092965,13.694728244781942
VEN,"Venezuela, RB",-1.7700127956708598,-51.04958125709261
CAN,Canada,1.4192233072838984,3.516020833511536
GIN,Guinea,2.873651371667413,8.043626497028214
PAK,Pakistan,2.077158651773795,17.164876726309394
LVA,Latvia,-0.8086505945687676,11.227458011940097
DNK,Denmark,0.5631589355036791,3.6649324886397423
NRU,Nauru,-1.3358185771978874,-17.914344696955613
QAT,Qatar,2.090230056328641,-6.649542924759741
USA,United States,0.621353494930684,4.057137380431737
TEC,Europe & Central Asia (IDA & IBRD countries),0.4488568815311823,4.951745881289868
BRA,Brazil,0.7869277066831338,3.2571908913740963
NGA,Nigeria,2.6202872333471494,5.373821440597682
MKD,North Macedonia,0.04620566033748384,6.123092927453969
NAM,Namibia,1.900105843537197,-4.1059460982336
RWA,Rwanda,2.679272914964831,17.930277482427908
LDC,Least developed countries: UN classification,2.3619548656365654,0.5079618084527765

2025-02-11 04:56:20 - root - INFO - SQL:
SELECT 
  pop.country_code,
  pop.country
FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
JOIN (
  SELECT country_code,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code
  HAVING percent_increase_health_exp > 1
) AS exp
ON pop.country_code = exp.country_code
WHERE ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 > 1
LIMIT 100;
Results:
country_code,country
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
MDV,Maldives
PER,Peru
EAR,Early-demographic dividend
WLD,World
DOM,Dominican Republic
KEN,Kenya
CAN,Canada
GIN,Guinea
PAK,Pakistan
NGA,Nigeria
RWA,Rwanda
CPV,Cabo Verde
BRN,Brunei Darussalam
PHL,Philippines
LKA,Sri Lanka
PSS,Pacific island small states
TZA,Tanzania
BTN,Bhutan
ZMB,Zambia
GTM,Guatemala
OMN,Oman
TUN,Tunisia
ZAF,South Africa
MAR,Morocco
CMR,Cameroon
SEN,Senegal
TSA,South Asia (IDA & IBRD)
SAS,South Asia
HND,Honduras
IBT,IDA & IBRD total
BDI,Burundi
ETH,Ethiopia
PRY,Paraguay
MNG,Mongolia
LUX,Luxembourg
COL,Colombia
AUS,Australia
CHL,Chile
TJK,Tajikistan
TON,Tonga
KGZ,Kyrgyz Republic
MIC,Middle income
COM,Comoros
LMY,Low & middle income
IDN,Indonesia
BLZ,Belize
TLS,Timor-Leste
TKM,Turkmenistan
MYS,Malaysia
BGD,Bangladesh
PAN,Panama
SSF,Sub-Saharan Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries)
GNB,Guinea-Bissau
VUT,Vanuatu
TUV,Tuvalu
MRT,Mauritania
ISL,Iceland
NZL,New Zealand
NPL,Nepal
UZB,Uzbekistan
GHA,Ghana
IND,India
TGO,Togo
SSA,Sub-Saharan Africa (excluding high income)
ISR,Israel
CAF,Central African Republic
MOZ,Mozambique
SWE,Sweden
KIR,Kiribati
PNG,Papua New Guinea
UGA,Uganda
BOL,Bolivia

2025-02-11 04:56:20 - root - INFO - itercount: 0
2025-02-11 04:56:20 - root - INFO - Database Name: bigquery-public-data
Schema Name: world_bank_global_population
,0
table_name,population_by_country
ddl,"CREATE TABLE `bigquery-public-data.world_bank_global_population.population_by_country`
(
  country STRING,
  country_code STRING,
  year_1960 INT64,
  year_1961 INT64,
  year_1962 INT64,
  year_1963 INT64,
  year_1964 INT64,
  year_1965 INT64,
  year_1966 INT64,
  year_1967 INT64,
  year_1968 INT64,
  year_1969 INT64,
  year_1970 INT64,
  year_1971 INT64,
  year_1972 INT64,
  year_1973 INT64,
  year_1974 INT64,
  year_1975 INT64,
  year_1976 INT64,
  year_1977 INT64,
  year_1978 INT64,
  year_1979 INT64,
  year_1980 INT64,
  year_1981 INT64,
  year_1982 INT64,
  year_1983 INT64,
  year_1984 INT64,
  year_1985 INT64,
  year_1986 INT64,
  year_1987 INT64,
  year_1988 INT64,
  year_1989 INT64,
  year_1990 INT64,
  year_1991 INT64,
  year_1992 INT64,
  year_1993 INT64,
  year_1994 INT64,
  year_1995 INT64,
  year_1996 INT64,
  year_1997 INT64,
  year_1998 INT64,
  year_1999 INT64,
  year_2000 INT64,
  year_2001 INT64,
  year_2002 INT64,
  year_2003 INT64,
  year_2004 INT64,
  year_2005 INT64,
  year_2006 INT64,
  year_2007 INT64,
  year_2008 INT64,
  year_2009 INT64,
  year_2010 INT64,
  year_2011 INT64,
  year_2012 INT64,
  year_2013 INT64,
  year_2014 INT64,
  year_2015 INT64,
  year_2016 INT64,
  year_2017 INT64,
  year_2018 INT64,
  year_2019 INT64
)
PARTITION BY DATE(_PARTITIONTIME);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period INT64,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
,4
table_name,health_nutrition_population
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.health_nutrition_population`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_Income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
,4
table_name,international_debt
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.international_debt`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
,2
table_name,international_education
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.international_education`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_two_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_summary`
(
  series_code STRING OPTIONS(description=""A number or a sequence of related statistical units arranged or occurring in temporal spatial or other order or succession. WDI carries mostly time series.""),
  topic STRING OPTIONS(description=""The matter dealt with in the context discourse or subject related to the series.""),
  indicator_name STRING OPTIONS(description=""Given name of a series.""),
  short_definition STRING OPTIONS(description=""Short statement of the exact meaning of a series.""),
  long_definition STRING OPTIONS(description=""Extended statement of the exact meaning of a series.""),
  unit_of_measure STRING OPTIONS(description=""A quantity used as a standard of measurement. Example: Units of time are second minute hour day week month year and decade.""),
  periodicity STRING OPTIONS(description=""Applies to series recurring at regular intervals. Most of the time this term denotes that interval of recurrence.""),
  base_period STRING OPTIONS(description=""Base period is the period of time for which data is used as the base of an index number or other ratio have been collected. This period is frequently one of a year but it may be as short as one day or as long as the average of a group of years.""),
  other_notes STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  aggregation_method STRING OPTIONS(description=""Aggregation methods are types of calculations used to group attribute values into a metric for each dimension value. For example for each region one may retrieve the total value of country entries (the sum of the series value for countries belonging to the region).""),
  limitations_and_exceptions STRING OPTIONS(description=""A limiting rule or circumstance that applies to usage of the series such as the scope of the survey collecting the data or missing years and countries.  It should also note when data are imputed or estimated""),
  notes_from_original_source STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  general_comments STRING OPTIONS(description=""Other notes regarding the series which do not appear in Development relevance or Limitations or exceptions""),
  source STRING OPTIONS(description=""A place person or organization from which the series comes or can be obtained.""),
  statistical_concept_and_methodology STRING OPTIONS(description=""The abstract idea general statistical notions or a system of methods used to generate the series.""),
  development_relevance STRING OPTIONS(description=""The relevance of a series refers to how the indicator’s data may be used to monitor particular aspects of development goals and programs for example the Sustainable Development Goals. The indicator may conclusively measure progress towards a particular objective or may act as a proxy or interpretation of a development aim.""),
  related_source_links STRING OPTIONS(description=""Internet address of related source page tool or knowledge base.""),
  other_web_links STRING OPTIONS(description=""Internet addresses of related pages tools or knowledge bases.""),
  related_indicators STRING OPTIONS(description=""In general indicator that are of interest and related to the specific series.""),
  license_type STRING OPTIONS(description=""Explains the rights conferred and restrictions imposed by the owner to the users of a series"")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_series_definitions`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
,2
table_name,footnotes
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.footnotes`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  year STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
,3
table_name,series_time
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_time`
(
  series_code STRING OPTIONS(description=""""),
  year INT64 OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
,4
table_name,indicators_data
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.indicators_data`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
,5
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_summary`
(
  country_code STRING OPTIONS(description=""A short alphabetic or numeric geographical code representing a specific country or area. In April 2016 WDI has adopted the three digit ISO code to identify countries in its databases.""),
  short_name STRING OPTIONS(description=""Country name the country's official name as approved by the relevant body (Italy is used as an example): conventional short form (Italy).""),
  table_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional short form (Republic of Italy).""),
  long_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional long form (Republic of Italy).""),
  two_alpha_code STRING OPTIONS(description=""ISO-2 digit alpha code value of the country. Re: www.iso.org""),
  currency_unit STRING OPTIONS(description=""Currency unit (such as the dollar euro peso rupee) issued as a coin or banknote a standard unit of value and a unit of account.""),
  special_notes STRING OPTIONS(description=""Country special notes for data and metadata users.""),
  region STRING OPTIONS(description=""World Bank region to which a country belongs.""),
  income_group STRING OPTIONS(description=""World Bank income group to which a country belongs after the country classification is completed every year.""),
  wb_2_code STRING OPTIONS(description=""World Bank 2 digit code value of the country.""),
  national_accounts_base_year STRING OPTIONS(description=""Base year is the base or pricing period used for constant price calculations in the country’s national accounts. Price indexes derived from national accounts aggregates such as the implicit deflator for gross domestic product (GDP) express the price level relative to base year prices.""),
  national_accounts_reference_year STRING OPTIONS(description=""Reference year is the year in which the local currency constant price series of a country is valued. The reference year is usually the same as the base year used to report the constant price series. However when the constant price data are chain linked the base year is changed annually so the data are rescaled to a specific reference year to provide a consistent time series. When the country has not rescaled following a change in base year World Bank staff rescale the data to maintain a longer historical series. To allow for cross-country comparison and data aggregation constant price data reported in World Development Indicators are rescaled to a common reference year (2010) and currency (U.S. dollars).""),
  sna_price_valuation STRING OPTIONS(description=""SNA price valuation shows whether value added in the national accounts is reported at basic prices (B) or producer prices (P). Producer prices include taxes paid by producers and thus tend to overstate the actual value added in production. However value added can be higher at basic prices than at producer prices in countries with high agricultural subsidies.""),
  lending_category STRING OPTIONS(description=""World Bank lending category to which a country belongs after the operational guidelines are completed every year.""),
  other_groups STRING OPTIONS(description=""Other types of grouping approved by the WDI team.""),
  system_of_national_accounts STRING OPTIONS(description=""System of National Accounts identifies whether a country uses the 1968 1993 or 2008 System of National Accounts (SNA). The 2008 SNA is an update of the 1993 SNA and retains its basic theoretical framework.""),
  alternative_conversion_factor STRING OPTIONS(description=""Alternative conversion factor identifies the countries and years for which a World Bank–estimated conversion factor has been used in place of the official exchange rate (line rf in the International Monetary Fund’s [IMF] International Financial Statistics). See later in Sources and methods for further discussion of alternative conversion factors.""),
  ppp_survey_year STRING OPTIONS(description=""Purchasing power parity (PPP) survey year is the latest available survey year for the International Comparison Program’s estimates of PPPs.""),
  balance_of_payments_manual_in_use STRING OPTIONS(description=""Balance of Payments Manual in use refers to the classification system used to compile and report data on balance of payments. 6 refers to the 6th edition of the IMF’s Balance of Payments Manual (2009).""),
  external_debt_reporting_status STRING OPTIONS(description=""External debt shows debt reporting status for 2016 data. A indicates that data are as reported P that data are based on reported or collected information but include an element of staff estimation and E that data are World Bank staff estimates.""),
  system_of_trade STRING OPTIONS(description=""System of trade refers to the United Nations general trade system (G) or special trade system (S). Under the general trade system goods entering directly for domestic consumption and goods entered into customs storage are recorded as imports at arrival. Under the special trade system goods are recorded as imports when declared for domestic consumption whether at time of entry or on withdrawal from customs storage.""),
  government_accounting_concept STRING OPTIONS(description=""Government finance accounting concept is the accounting basis for reporting central government financial data. For most countries government finance data have been consolidated (C) into one set of accounts capturing all central government fiscal activities. Budgetary central government accounts (B) exclude some central government units.""),
  imf_data_dissemination_standard STRING OPTIONS(description=""IMF data dissemination standard shows the countries that subscribe to the IMF’s Special Data Dissemination Standard (S) or Enhanced General Data Dissemination System (e-GDDS). S refers to countries that subscribe to the SDDS and have posted data on the Dissemination Standards Bulletin Board at http://dsbb.imf.org. S+ countries must observe additional coverage periodicity and timeliness requirements. e-G refers to countries that subscribe to the e-GDDS.""),
  latest_population_census STRING OPTIONS(description=""Latest population census shows the most recent year in which a census was conducted and in which at least preliminary results have been released. The preliminary results from the very recent censuses could be reflected in timely revisions if basic data are available such as population by age and sex as well as the detailed definition of counting coverage and completeness.""),
  latest_household_survey STRING OPTIONS(description=""Latest demographic education or health household survey indicates the household surveys used to compile the demographic education and health data. Detailed information on each survey is provided through the following links:  AIDS Indicator Survey Demographic and Health Survey Health Issues Survey and Malaria Indicator Survey - www.dhsprogram.com; Living Standards Measurement Study -  www.worldbank.org/lsms; Multiple Indicator Cluster Survey - http://mics.unicef.org; Reproductive Health Survey -  www.cdc.gov/reproductivehealth; World Health Survey is available at - www.who.int/healthinfo/survey/en.""),
  source_of_most_recent_income_and_expenditure_data STRING OPTIONS(description=""Source of most recent income and expenditure data shows household surveys that collect income and expenditure data. Names and detailed information on household surveys can be found on the website of the International Household Survey Network (www.surveynetwork.org). Core Welfare Indicator Questionnaire Surveys (CWIQ) developed by the World Bank measure changes in key social indicators for different population groups—specifically indicators of access utilization and satisfaction with core social and economic services. Expenditure survey/budget surveys (ES/BS) collect detailed information on household consumption as well as on general demographic social and economic characteristics. Integrated household surveys (IHS) collect detailed information on a wide variety of topics including health education economic activities housing and utilities.""),
  vital_registration_complete STRING OPTIONS(description=""Vital registration complete identifies countries that report at least 90 percent complete registries of vital (birth and death) statistics to the United Nations Statistics Division and are reported in its Population and Vital Statistics Reports. Countries with complete vital statistics registries may have more accurate and more timely demographic indicators than other countries.""),
  latest_agricultural_census STRING OPTIONS(description=""Latest agricultural census shows the most recent year in which an agricultural census was conducted or planned to be conducted as reported to the Food and Agriculture Organization.""),
  latest_industrial_data STRING OPTIONS(description=""Latest industrial data show the most recent year for which manufacturing value added data at the three-digit level of the International Standard Industrial Classification (revision 2 or 3) are available in the United Nations Industrial Development Organization database.""),
  latest_trade_data STRING OPTIONS(description=""Latest trade data show the most recent year for which structure of merchandise trade data from the United Nations Statistics Division’s Commodity Trade (Comtrade) database are available."")
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['series_summary', 'country_series_definitions', 'series_times', 'country_summary', 'health_nutrition_population'], 'world_bank_intl_debt': ['series_summary', 'country_series_definitions', 'series_times', 'country_summary', 'international_debt'], 'world_bank_intl_education': ['series_summary', 'country_series_definitions', 'international_education', 'country_summary'], 'world_bank_wdi': ['series_summary', 'country_series_definitions', 'footnotes', 'series_time', 'indicators_data', 'country_summary']}}
Begin Exploring Related Columns
**Relevant Tables and Columns**

1. **Table**: `bigquery-public-data.world_bank_global_population.population_by_country`

   - **`country`** (STRING): Country name  
     *Potential usage*: Identifying the country.
     
   - **`country_code`** (STRING): Country code  
     *Potential usage*: Joining with other datasets.
     
   - **`year_2017`** (INT64): Population in 2017  
     *Potential usage*: Retrieving the total population for 2017.
     
   - **`year_2018`** (INT64): Population in 2018  
     *Potential usage*: Retrieving the total population for 2018.

2. **Table**: `bigquery-public-data.world_bank_health_population.health_nutrition_population`

   - **`country_name`** (STRING): Country name  
     *Potential usage*: Identifying the country.
     
   - **`country_code`** (STRING): Country code  
     *Potential usage*: Joining with other datasets.
     
   - **`indicator_name`** (STRING): Name of the health indicator  
     *Potential usage*: Filtering to select "per capita current health expenditure (PPP)".
     
   - **`indicator_code`** (STRING): Code of the health indicator  
     *Potential usage*: Filtering to select "per capita current health expenditure (PPP)".
     
   - **`year`** (INT64): Year of the data  
     *Potential usage*: Selecting data for 2017 and 2018.
     
   - **`value`** (FLOAT64): Indicator value  
     *Potential usage*: Retrieving the per capita health expenditure values.

**Potential Conditions**

- Use `indicator_name` or `indicator_code` to filter for the specific health expenditure indicator.
- Select records where `year` is 2017 or 2018.
- Calculate percentage increase from 2017 to 2018.
- Identify countries with increases greater than 1% in both population and health expenditure.

---

**SQL Queries**

1. **Query 1**: List distinct indicator codes and names related to health expenditure per capita.

```sql
SELECT DISTINCT indicator_code, indicator_name
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE LOWER(indicator_name) LIKE '%health expenditure per capita%'
LIMIT 100;
```

2. **Query 2**: Find indicator codes for "per capita current health expenditure (PPP)".

```sql
SELECT DISTINCT indicator_code, indicator_name
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE LOWER(indicator_name) LIKE '%current health expenditure per capita%'
  AND LOWER(indicator_name) LIKE '%ppp%'
LIMIT 100;
```

3. **Query 3**: Retrieve health expenditure per capita (PPP) data for 2017 and 2018.

*Assuming the indicator code obtained from Query 2 is `SH.XPD.CHEX.PP.CD`.*

```sql
SELECT country_code, country_name, year, value AS health_expenditure_per_capita_ppp
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
  AND year IN (2017, 2018)
LIMIT 100;
```

4. **Query 4**: Retrieve population data for countries in 2017 and 2018.

```sql
SELECT country_code, country, year_2017, year_2018
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
LIMIT 100;
```

5. **Query 5**: Calculate percentage increase in population from 2017 to 2018 for each country.

```sql
SELECT country_code, country,
  ((year_2018 - year_2017) / CAST(year_2017 AS FLOAT64)) * 100 AS percent_increase_population
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
LIMIT 100;
```

6. **Query 6**: Calculate percentage increase in health expenditure per capita from 2017 to 2018.

```sql
SELECT country_code, country_name,
  SUM(CASE WHEN year = 2017 THEN value END) AS health_exp_2017,
  SUM(CASE WHEN year = 2018 THEN value END) AS health_exp_2018,
  ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
   / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
  AND year IN (2017, 2018)
GROUP BY country_code, country_name
LIMIT 100;
```

7. **Query 7**: List countries with more than 1% increase in population from 2017 to 2018.

```sql
SELECT country_code, country
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
WHERE ((year_2018 - year_2017) / CAST(year_2017 AS FLOAT64)) * 100 > 1
LIMIT 100;
```

8. **Query 8**: List countries with more than 1% increase in health expenditure per capita from 2017 to 2018.

```sql
SELECT country_code, country_name
FROM (
  SELECT country_code, country_name,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code, country_name
)
WHERE percent_increase_health_exp > 1
LIMIT 100;
```

9. **Query 9**: Retrieve the list of countries along with their population and health expenditure increases.

```sql
SELECT 
  pop.country_code,
  pop.country,
  ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 AS percent_increase_population,
  exp.percent_increase_health_exp
FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
JOIN (
  SELECT country_code,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code
) AS exp
ON pop.country_code = exp.country_code
LIMIT 100;
```

10. **Query 10**: List countries that experienced more than 1% increase in both population and health expenditure per capita.

```sql
SELECT 
  pop.country_code,
  pop.country
FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
JOIN (
  SELECT country_code,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code
  HAVING percent_increase_health_exp > 1
) AS exp
ON pop.country_code = exp.country_code
WHERE ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 > 1
LIMIT 100;
```

---

These queries help explore the relevant data, identify the appropriate indicators, and calculate the percentage increases required to answer the task.Query:
SELECT DISTINCT indicator_code, indicator_name
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE LOWER(indicator_name) LIKE '%health expenditure per capita%'
LIMIT 100;
Answer:
indicator_code,indicator_name
SH.XPD.CHEX.PC.CD,Current health expenditure per capita (current US$)
SH.XPD.CHEX.PP.CD,"Current health expenditure per capita, PPP (current international $)"
SH.XPD.GHED.PP.CD,"Domestic general government health expenditure per capita, PPP (current international $)"
SH.XPD.EHEX.PC.CD,External health expenditure per capita (current US$)
SH.XPD.GHED.PC.CD,Domestic general government health expenditure per capita (current US$)
SH.XPD.PVTD.PP.CD,"Domestic private health expenditure per capita, PPP  (current international $)"
SH.XPD.PVTD.PC.CD,Domestic private health expenditure per capita (current US$)
SH.XPD.EHEX.PP.CD,"External health expenditure per capita, PPP (current international $)"
Query:
SELECT DISTINCT indicator_code, indicator_name
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE LOWER(indicator_name) LIKE '%current health expenditure per capita%'
  AND LOWER(indicator_name) LIKE '%ppp%'
LIMIT 100;
Answer:
indicator_code,indicator_name
SH.XPD.CHEX.PP.CD,"Current health expenditure per capita, PPP (current international $)"
Query:
SELECT country_code, country_name, year, value AS health_expenditure_per_capita_ppp
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
  AND year IN (2017, 2018)
LIMIT 100;
Answer:
country_code,country_name,year,health_expenditure_per_capita_ppp
DJI,Djibouti,2017,134.43319702
MUS,Mauritius,2018,1380.73596191
MNG,Mongolia,2017,512.30932617
MNE,Montenegro,2018,1711.20996094
NIC,Nicaragua,2017,473.00387573
PHL,Philippines,2018,393.90402222
POL,Poland,2017,1978.63806152
SLE,Sierra Leone,2017,255.2999115
IDN,Indonesia,2017,352.1897583
KGZ,Kyrgyz Republic,2018,259.92599487
MIC,Middle income,2017,613.584403311481
ATG,Antigua and Barbuda,2017,1274.50341797
LCA,St. Lucia,2017,636.71325684
ARG,Argentina,2018,1989.63562012
BEL,Belgium,2017,5289.40039063
BFA,Burkina Faso,2018,111.71577454
MDA,Moldova,2018,479.85287476
DEU,Germany,2017,5930.57617188
PER,Peru,2017,698.16088867
ROU,Romania,2017,1367.82080078
TSS,Sub-Saharan Africa (IDA & IBRD countries),2017,201.156557039325
BHR,Bahrain,2018,1955.35192871
CPV,Cabo Verde,2017,375.52709961
PAK,Pakistan,2017,152.12948608
HIC,High income,2018,6065.06312742882
TLA,Latin America & the Caribbean (IDA & IBRD countries),2018,1228.16209266781
PRY,Paraguay,2018,935.32897949
SMR,San Marino,2017,4262.75585938
SVN,Slovenia,2017,2960.59326172
MEA,Middle East & North Africa,2018,1336.40615439374
LBN,Lebanon,2018,1085.85119629
CUB,Cuba,2017,2517.68164063
NZL,New Zealand,2017,3815.65722656
HIC,High income,2017,5857.99472467572
KEN,Kenya,2017,157.59783936
SAS,South Asia,2018,249.034231503484
LSO,Lesotho,2018,308.99752808
THA,Thailand,2017,686.5927124
BRA,Brazil,2017,1482.5333252
BGR,Bulgaria,2018,1633.80444336
TCD,Chad,2018,79.01350403
MKD,North Macedonia,2018,1073.19555664
Query:
SELECT country_code, country, year_2017, year_2018
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
LIMIT 100;
Answer:
country_code,country,year_2017,year_2018
SXM,Sint Maarten (Dutch part),40574.0,40654.0
INX,Not classified,,
PSE,West Bank and Gaza,4454805.0,4569087.0
SRB,Serbia,7020858.0,6982084.0
KHM,Cambodia,16009414.0,16249798.0
ARE,United Arab Emirates,9487203.0,9630959.0
CYP,Cyprus,1179680.0,1189265.0
LMC,Lower middle income,2981420591.0,3022905169.0
MDV,Maldives,496402.0,515696.0
LIC,Low income,687449530.0,705417321.0
PER,Peru,31444297.0,31989256.0
EAR,Early-demographic dividend,3207188541.0,3249140605.0
FJI,Fiji,877459.0,883483.0
TCD,Chad,15016773.0,15477751.0
MNA,Middle East & North Africa (excluding high income),376546755.0,382896715.0
TMN,Middle East & North Africa (IDA & IBRD countries),372091950.0,378327628.0
WLD,World,7510990456.0,7594270356.0
SAU,Saudi Arabia,33099147.0,33699947.0
DOM,Dominican Republic,10513131.0,10627165.0
KEN,Kenya,50221473.0,51393010.0
VEN,"Venezuela, RB",29390409.0,28870195.0
CAN,Canada,36540268.0,37058856.0
GIN,Guinea,12067539.0,12414318.0
PAK,Pakistan,207896686.0,212215030.0
LVA,Latvia,1942248.0,1926542.0
DNK,Denmark,5764980.0,5797446.0
HKG,"Hong Kong SAR, China",7391700.0,7451000.0
NRU,Nauru,12876.0,12704.0
QAT,Qatar,2724724.0,2781677.0
USA,United States,325147121.0,327167434.0
TEC,Europe & Central Asia (IDA & IBRD countries),457810292.0,459865205.0
BRA,Brazil,207833831.0,209469333.0
NGA,Nigeria,190873311.0,195874740.0
YEM,"Yemen, Rep.",27834821.0,28498687.0
MKD,North Macedonia,2081996.0,2082958.0
NAM,Namibia,2402603.0,2448255.0
RWA,Rwanda,11980937.0,12301939.0
LDC,Least developed countries: UN classification,986365080.0,1009662578.0
CEB,Central Europe and the Baltics,102738854.0,102511922.0
CPV,Cabo Verde,537497.0,543767.0
BRN,Brunei Darussalam,424473.0,428962.0
PHL,Philippines,105173264.0,106651922.0
PLW,Palau,17808.0,17907.0
LKA,Sri Lanka,21444000.0,21670000.0
STP,Sao Tome and Principe,207089.0,211028.0
HTI,Haiti,10982366.0,11123176.0
PSS,Pacific island small states,2422086.0,2457367.0
CHN,China,1386395000.0,1392730000.0
DEU,Germany,82657002.0,82927922.0
MAF,St. Martin (French part),36560.0,37264.0
FRO,Faroe Islands,48331.0,48497.0
NOR,Norway,5276968.0,5314336.0
Query:
SELECT country_code, country,
  ((year_2018 - year_2017) / CAST(year_2017 AS FLOAT64)) * 100 AS percent_increase_population
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
LIMIT 100;
Answer:
country_code,country,percent_increase_population
SXM,Sint Maarten (Dutch part),0.1971706018632622
INX,Not classified,
PSE,West Bank and Gaza,2.565364813948085
SRB,Serbia,-0.552268682830503
KHM,Cambodia,1.5015165452027164
ARE,United Arab Emirates,1.5152621905528953
CYP,Cyprus,0.8125084768750848
LMC,Lower middle income,1.3914366233744175
MDV,Maldives,3.8867691910991495
LIC,Low income,2.613688745994197
PER,Peru,1.7330932855646286
EAR,Early-demographic dividend,1.3080635411262527
FJI,Fiji,0.6865278035782869
TCD,Chad,3.0697540676682
MNA,Middle East & North Africa (excluding high income),1.6863669426655927
TMN,Middle East & North Africa (IDA & IBRD countries),1.6758432962605077
WLD,World,1.10877387593368
SAU,Saudi Arabia,1.8151525173745415
DOM,Dominican Republic,1.0846816233907863
KEN,Kenya,2.332741216092965
VEN,"Venezuela, RB",-1.7700127956708598
CAN,Canada,1.4192233072838984
GIN,Guinea,2.873651371667413
PAK,Pakistan,2.077158651773795
LVA,Latvia,-0.8086505945687676
DNK,Denmark,0.5631589355036791
HKG,"Hong Kong SAR, China",0.8022511736136477
NRU,Nauru,-1.3358185771978874
QAT,Qatar,2.090230056328641
USA,United States,0.621353494930684
TEC,Europe & Central Asia (IDA & IBRD countries),0.4488568815311823
BRA,Brazil,0.7869277066831338
NGA,Nigeria,2.6202872333471494
YEM,"Yemen, Rep.",2.3850198282216364
MKD,North Macedonia,0.04620566033748384
NAM,Namibia,1.900105843537197
RWA,Rwanda,2.679272914964831
LDC,Least developed countries: UN classification,2.3619548656365654
CEB,Central Europe and the Baltics,-0.2208823547905255
CPV,Cabo Verde,1.1665181387058905
BRN,Brunei Darussalam,1.057546651966085
PHL,Philippines,1.4059257493425326
PLW,Palau,0.5559299191374663
LKA,Sri Lanka,1.0539078530124977
STP,Sao Tome and Principe,1.9020807478910033
HTI,Haiti,1.2821463061784684
PSS,Pacific island small states,1.4566369649962883
CHN,China,0.45694048233007184
DEU,Germany,0.32776412577847913
Query:
SELECT country_code, country_name,
  SUM(CASE WHEN year = 2017 THEN value END) AS health_exp_2017,
  SUM(CASE WHEN year = 2018 THEN value END) AS health_exp_2018,
  ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
   / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
  AND year IN (2017, 2018)
GROUP BY country_code, country_name
LIMIT 100;
Answer:
country_code,country_name,health_exp_2017,health_exp_2018,percent_increase_health_exp
DJI,Djibouti,134.43319702,134.88937378,0.3393334162335949
MUS,Mauritius,1278.09350586,1380.73596191,8.030903496449127
MNG,Mongolia,512.30932617,519.26660156,1.3580223967446232
MNE,Montenegro,,1711.20996094,
NIC,Nicaragua,473.00387573,473.92501831,0.19474313578897326
PHL,Philippines,370.81732178,393.90402222,6.225895901836266
POL,Poland,1978.63806152,2015.28588867,1.8521743750267778
SLE,Sierra Leone,255.2999115,257.32653809,0.7938218928838047
IDN,Indonesia,352.1897583,375.15563965,6.520882793655053
KGZ,Kyrgyz Republic,231.27180481,259.92599487,12.389832856426533
MIC,Middle income,613.584403311481,651.024194518279,6.101815985663521
ATG,Antigua and Barbuda,1274.50341797,1405.76794434,10.299268289062342
LCA,St. Lucia,636.71325684,610.52154541,-4.113580351693804
ARG,Argentina,2184.91918945,1989.63562012,-8.937793684678915
BEL,Belgium,5289.40039063,5404.91601563,2.1839077488751304
BFA,Burkina Faso,129.01049805,111.71577454,-13.405671454192172
MDA,Moldova,481.33169556,479.85287476,-0.3072352836186025
DEU,Germany,5930.57617188,6098.20263672,2.826478574456307
PER,Peru,698.16088867,766.63635254,9.807977642581225
ROU,Romania,1367.82080078,1576.29931641,15.24165413416109
TSS,Sub-Saharan Africa (IDA & IBRD countries),201.156557039325,205.394948790297,2.1070114806863676
BHR,Bahrain,2263.04296875,1955.35192871,-13.596341045612325
CPV,Cabo Verde,375.52709961,399.53582764,6.393341001204444
PAK,Pakistan,152.12948608,178.24232483,17.164876726309394
HIC,High income,5857.99472467572,6065.06312742882,3.534800089198823
TLA,Latin America & the Caribbean (IDA & IBRD countries),1230.69946390644,1228.16209266781,-0.2061731001796433
PRY,Paraguay,863.2098999,935.32897949,8.354755847720794
SMR,San Marino,4262.75585938,4340.04199219,1.8130555762403138
SVN,Slovenia,2960.59326172,3158.38500977,6.680814639667525
Query:
SELECT country_code, country
FROM `bigquery-public-data.world_bank_global_population.population_by_country`
WHERE ((year_2018 - year_2017) / CAST(year_2017 AS FLOAT64)) * 100 > 1
LIMIT 100;
Answer:
country_code,country
PSE,West Bank and Gaza
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
MDV,Maldives
LIC,Low income
PER,Peru
EAR,Early-demographic dividend
TCD,Chad
MNA,Middle East & North Africa (excluding high income)
TMN,Middle East & North Africa (IDA & IBRD countries)
WLD,World
SAU,Saudi Arabia
DOM,Dominican Republic
KEN,Kenya
CAN,Canada
GIN,Guinea
PAK,Pakistan
QAT,Qatar
NGA,Nigeria
YEM,"Yemen, Rep."
NAM,Namibia
RWA,Rwanda
LDC,Least developed countries: UN classification
CPV,Cabo Verde
BRN,Brunei Darussalam
PHL,Philippines
LKA,Sri Lanka
STP,Sao Tome and Principe
HTI,Haiti
PSS,Pacific island small states
MAF,St. Martin (French part)
SST,Small states
TZA,Tanzania
BTN,Bhutan
ZMB,Zambia
GTM,Guatemala
OMN,Oman
TUN,Tunisia
ZAF,South Africa
PRE,Pre-demographic dividend
SLE,Sierra Leone
MEA,Middle East & North Africa
NIC,Nicaragua
FCS,Fragile and conflict affected situations
MEX,Mexico
MAR,Morocco
AGO,Angola
CMR,Cameroon
SLB,Solomon Islands
NER,Niger
SEN,Senegal
TSA,South Asia (IDA & IBRD)
SAS,South Asia
GNQ,Equatorial Guinea
HND,Honduras
IBT,IDA & IBRD total
BFA,Burkina Faso
CHI,Channel Islands
BDI,Burundi
AFG,Afghanistan
MDG,Madagascar
ETH,Ethiopia
PRY,Paraguay
MAC,"Macao SAR, China"
MNG,Mongolia
OSS,Other small states
LUX,Luxembourg
MLI,Mali
ARB,Arab World
BHR,Bahrain
COD,"Congo, Dem. Rep."
COL,Colombia
AUS,Australia
CHL,Chile
SOM,Somalia
BEN,Benin
IDA,IDA total
TJK,Tajikistan
TON,Tonga
KGZ,Kyrgyz Republic
COG,"Congo, Rep."
MIC,Middle income
COM,Comoros
MLT,Malta
NCL,New Caledonia
LMY,Low & middle income
IDN,Indonesia
IRQ,Iraq
BLZ,Belize
TLS,Timor-Leste
ZWE,Zimbabwe
SDN,Sudan
ECU,Ecuador
DJI,Djibouti
CYM,Cayman Islands
TKM,Turkmenistan
MYS,Malaysia
EGY,"Egypt, Arab Rep."
TCA,Turks and Caicos Islands
Query:
SELECT country_code, country_name
FROM (
  SELECT country_code, country_name,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code, country_name
)
WHERE percent_increase_health_exp > 1
LIMIT 100;
Answer:
country_code,country_name
MUS,Mauritius
MNG,Mongolia
PHL,Philippines
POL,Poland
IDN,Indonesia
KGZ,Kyrgyz Republic
MIC,Middle income
ATG,Antigua and Barbuda
BEL,Belgium
DEU,Germany
PER,Peru
ROU,Romania
TSS,Sub-Saharan Africa (IDA & IBRD countries)
CPV,Cabo Verde
PAK,Pakistan
HIC,High income
PRY,Paraguay
SMR,San Marino
SVN,Slovenia
NZL,New Zealand
KEN,Kenya
SAS,South Asia
LSO,Lesotho
THA,Thailand
BRA,Brazil
BGR,Bulgaria
MKD,North Macedonia
ISR,Israel
BOL,Bolivia
CHL,Chile
MAR,Morocco
AFW,Africa Western and Central
JPN,Japan
MDV,Maldives
BGD,Bangladesh
KHM,Cambodia
ARE,United Arab Emirates
ZMB,Zambia
HRV,Croatia
MMR,Myanmar
NPL,Nepal
EMU,Euro area
GIN,Guinea
SYC,Seychelles
ALB,Albania
SWE,Sweden
CHE,Switzerland
TUN,Tunisia
BTN,Bhutan
FIN,Finland
SGP,Singapore
IRL,Ireland
LMC,Lower middle income
SSF,Sub-Saharan Africa
LTU,Lithuania
VNM,Vietnam
ITA,Italy
WLD,World
LUX,Luxembourg
TZA,Tanzania
DOM,Dominican Republic
HUN,Hungary
UZB,Uzbekistan
DMA,Dominica
MCO,Monaco
GUY,Guyana
AUT,Austria
COM,Comoros
CYP,Cyprus
ECA,Europe & Central Asia (excluding high income)
LMY,Low & middle income
PNG,Papua New Guinea
VCT,St. Vincent and the Grenadines
ARM,Armenia
EAR,Early-demographic dividend
ISL,Iceland
OED,OECD members
TSA,South Asia (IDA & IBRD)
LKA,Sri Lanka
TON,Tonga
CAF,Central African Republic
TEC,Europe & Central Asia (IDA & IBRD countries)
SLV,El Salvador
EST,Estonia
IND,India
GBR,United Kingdom
CAN,Canada
LAC,Latin America & Caribbean (excluding high income)
CZE,Czech Republic
NOR,Norway
GNB,Guinea-Bissau
PRT,Portugal
Query:
SELECT 
  pop.country_code,
  pop.country,
  ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 AS percent_increase_population,
  exp.percent_increase_health_exp
FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
JOIN (
  SELECT country_code,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code
) AS exp
ON pop.country_code = exp.country_code
LIMIT 100;
Answer:
country_code,country,percent_increase_population,percent_increase_health_exp
SRB,Serbia,-0.552268682830503,10.058843469188531
KHM,Cambodia,1.5015165452027164,9.682096701147762
ARE,United Arab Emirates,1.5152621905528953,4.663505847905878
CYP,Cyprus,0.8125084768750848,5.058535450528741
LMC,Lower middle income,1.3914366233744175,4.859841588386322
MDV,Maldives,3.8867691910991495,7.064431850180757
LIC,Low income,2.613688745994197,-4.2655355575512415
PER,Peru,1.7330932855646286,9.807977642581225
EAR,Early-demographic dividend,1.3080635411262527,1.155713263926843
FJI,Fiji,0.6865278035782869,13.145350273636053
TCD,Chad,3.0697540676682,-7.782875489518702
MNA,Middle East & North Africa (excluding high income),1.6863669426655927,-3.043545348909082
TMN,Middle East & North Africa (IDA & IBRD countries),1.6758432962605077,-3.043545348909082
WLD,World,1.10877387593368,3.803807230162976
SAU,Saudi Arabia,1.8151525173745415,-6.392527005315368
DOM,Dominican Republic,1.0846816233907863,6.597805657430963
KEN,Kenya,2.332741216092965,13.694728244781942
VEN,"Venezuela, RB",-1.7700127956708598,-51.04958125709261
CAN,Canada,1.4192233072838984,3.516020833511536
GIN,Guinea,2.873651371667413,8.043626497028214
PAK,Pakistan,2.077158651773795,17.164876726309394
LVA,Latvia,-0.8086505945687676,11.227458011940097
DNK,Denmark,0.5631589355036791,3.6649324886397423
NRU,Nauru,-1.3358185771978874,-17.914344696955613
QAT,Qatar,2.090230056328641,-6.649542924759741
USA,United States,0.621353494930684,4.057137380431737
TEC,Europe & Central Asia (IDA & IBRD countries),0.4488568815311823,4.951745881289868
BRA,Brazil,0.7869277066831338,3.2571908913740963
NGA,Nigeria,2.6202872333471494,5.373821440597682
MKD,North Macedonia,0.04620566033748384,6.123092927453969
NAM,Namibia,1.900105843537197,-4.1059460982336
RWA,Rwanda,2.679272914964831,17.930277482427908
LDC,Least developed countries: UN classification,2.3619548656365654,0.5079618084527765
Query:
SELECT 
  pop.country_code,
  pop.country
FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
JOIN (
  SELECT country_code,
    ((SUM(CASE WHEN year = 2018 THEN value END) - SUM(CASE WHEN year = 2017 THEN value END))
     / SUM(CASE WHEN year = 2017 THEN value END)) * 100 AS percent_increase_health_exp
  FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
  WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
    AND year IN (2017, 2018)
  GROUP BY country_code
  HAVING percent_increase_health_exp > 1
) AS exp
ON pop.country_code = exp.country_code
WHERE ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 > 1
LIMIT 100;
Answer:
country_code,country
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
MDV,Maldives
PER,Peru
EAR,Early-demographic dividend
WLD,World
DOM,Dominican Republic
KEN,Kenya
CAN,Canada
GIN,Guinea
PAK,Pakistan
NGA,Nigeria
RWA,Rwanda
CPV,Cabo Verde
BRN,Brunei Darussalam
PHL,Philippines
LKA,Sri Lanka
PSS,Pacific island small states
TZA,Tanzania
BTN,Bhutan
ZMB,Zambia
GTM,Guatemala
OMN,Oman
TUN,Tunisia
ZAF,South Africa
MAR,Morocco
CMR,Cameroon
SEN,Senegal
TSA,South Asia (IDA & IBRD)
SAS,South Asia
HND,Honduras
IBT,IDA & IBRD total
BDI,Burundi
ETH,Ethiopia
PRY,Paraguay
MNG,Mongolia
LUX,Luxembourg
COL,Colombia
AUS,Australia
CHL,Chile
TJK,Tajikistan
TON,Tonga
KGZ,Kyrgyz Republic
MIC,Middle income
COM,Comoros
LMY,Low & middle income
IDN,Indonesia
BLZ,Belize
TLS,Timor-Leste
TKM,Turkmenistan
MYS,Malaysia
BGD,Bangladesh
PAN,Panama
SSF,Sub-Saharan Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries)
GNB,Guinea-Bissau
VUT,Vanuatu
TUV,Tuvalu
MRT,Mauritania
ISL,Iceland
NZL,New Zealand
NPL,Nepal
UZB,Uzbekistan
GHA,Ghana
IND,India
TGO,Togo
SSA,Sub-Saharan Africa (excluding high income)
ISR,Israel
CAF,Central African Republic
MOZ,Mozambique
SWE,Sweden
KIR,Kiribati
PNG,Papua New Guinea
UGA,Uganda
BOL,Bolivia
End Exploring Related Columns
Task: Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Number_of_Countries
count:int
```

To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), we analyzed the `population_by_country` table from the `world_bank_global_population` dataset and the `health_nutrition_population` table from the `world_bank_health_population` dataset. We calculated the year-over-year percentage change for each country in both total population and per capita health expenditure and counted those that exceeded a 1% increase in both metrics..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['series_summary', 'country_series_definitions', 'series_times', 'country_summary', 'health_nutrition_population'], 'world_bank_intl_debt': ['series_summary', 'country_series_definitions', 'series_times', 'country_summary', 'international_debt'], 'world_bank_intl_education': ['series_summary', 'country_series_definitions', 'international_education', 'country_summary'], 'world_bank_wdi': ['series_summary', 'country_series_definitions', 'footnotes', 'series_time', 'indicators_data', 'country_summary']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 04:56:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 04:56:54 - root - INFO - ```sql
SELECT COUNT(*) AS Number_of_Countries
FROM (
  SELECT pop.country_code
  FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
  JOIN (
    SELECT country_code,
      SUM(CASE WHEN year = 2017 THEN value END) AS exp_2017,
      SUM(CASE WHEN year = 2018 THEN value END) AS exp_2018
    FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
    WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
      AND year IN (2017, 2018)
    GROUP BY country_code
    HAVING exp_2017 IS NOT NULL AND exp_2018 IS NOT NULL AND exp_2017 > 0
  ) AS health
  ON pop.country_code = health.country_code
  WHERE ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 > 1
    AND ((health.exp_2018 - health.exp_2017) / health.exp_2017) * 100 > 1
)
```
2025-02-11 04:56:56 - root - INFO - itercount: 1
2025-02-11 04:56:56 - root - INFO - 0
2025-02-11 04:56:56 - root - INFO - results: 
Number_of_Countries
76


2025-02-11 04:56:56 - root - INFO - Please check the answer again by reviewing Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Number_of_Countries
count:int
```

To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), we analyzed the `population_by_country` table from the `world_bank_global_population` dataset and the `health_nutrition_population` table from the `world_bank_health_population` dataset. We calculated the year-over-year percentage change for each country in both total population and per capita health expenditure and counted those that exceeded a 1% increase in both metrics. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Countries
76
Current sql:
SELECT COUNT(*) AS Number_of_Countries
FROM (
  SELECT pop.country_code
  FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
  JOIN (
    SELECT country_code,
      SUM(CASE WHEN year = 2017 THEN value END) AS exp_2017,
      SUM(CASE WHEN year = 2018 THEN value END) AS exp_2018
    FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
    WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
      AND year IN (2017, 2018)
    GROUP BY country_code
    HAVING exp_2017 IS NOT NULL AND exp_2018 IS NOT NULL AND exp_2017 > 0
  ) AS health
  ON pop.country_code = health.country_code
  WHERE ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 > 1
    AND ((health.exp_2018 - health.exp_2017) / health.exp_2017) * 100 > 1
)
2025-02-11 04:57:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 04:57:37 - root - INFO - ```sql
SELECT COUNT(*) AS Number_of_Countries
FROM (
  SELECT pop.country_code
  FROM `bigquery-public-data.world_bank_global_population.population_by_country` AS pop
  JOIN (
    SELECT country_code,
      SUM(CASE WHEN year = 2017 THEN value END) AS exp_2017,
      SUM(CASE WHEN year = 2018 THEN value END) AS exp_2018
    FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`
    WHERE indicator_code = 'SH.XPD.CHEX.PP.CD'
      AND year IN (2017, 2018)
    GROUP BY country_code
    HAVING exp_2017 IS NOT NULL AND exp_2018 IS NOT NULL AND exp_2017 > 0
  ) AS health
  ON pop.country_code = health.country_code
  WHERE ((pop.year_2018 - pop.year_2017) / CAST(pop.year_2017 AS FLOAT64)) * 100 > 1
    AND ((health.exp_2018 - health.exp_2017) / health.exp_2017) * 100 > 1
)
```
2025-02-11 04:57:38 - root - INFO - itercount: 2
2025-02-11 04:57:38 - root - INFO - 0
2025-02-11 04:57:38 - root - INFO - Total iteration counts: 2
