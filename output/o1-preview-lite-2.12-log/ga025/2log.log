2025-02-10 16:35:52 - openai._base_client - INFO - Retrying request to /chat/completions in 0.486818 seconds
2025-02-10 16:37:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:37:20 - root - INFO - SQL:
-- 1. Select distinct event names to see available events
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_201809*`
LIMIT 100;
Results:
event_name
level_complete
level_up
post_score
level_retry
level_start
user_engagement
app_exception
session_start
level_start_quickplay
level_retry_quickplay
app_remove
level_reset_quickplay
use_extra_steps
firebase_campaign
error
ad_reward
first_open
in_app_purchase
dynamic_link_first_open
completed_5_levels
level_end
screen_view
select_content
level_complete_quickplay
level_fail_quickplay
level_end_quickplay
spend_virtual_currency
app_clear_data
os_update
app_update
dynamic_link_app_open
challenge_accepted
level_fail
level_reset
no_more_extra_steps
challenge_a_friend

2025-02-10 16:37:22 - root - INFO - SQL:
-- 2. Select user IDs and their first touch timestamps for users who first opened the app in September 2018
SELECT user_pseudo_id, user_first_touch_timestamp
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
LIMIT 100;
Results:
user_pseudo_id,user_first_touch_timestamp
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000

2025-02-10 16:37:24 - root - INFO - SQL:
-- 3. Select uninstall events in September 2018
SELECT user_pseudo_id, event_name, event_timestamp
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
LIMIT 100;
Results:
user_pseudo_id,event_name,event_timestamp
C7DD86F06FD4AA8A0967E27E20750FCD,app_remove,1536368658104000
761430CDF522B29DB21632D60AA62446,app_remove,1536319117653000
E41F819718B0E2C49D347493BFACA027,app_remove,1536387398323000
130AD6E923A7BD4C62978F61DDB6D91F,app_remove,1536378770442000
E2372AFD5CBA85F1395201FB687AEC46,app_remove,1536304448680000
63D8ACC080B6F91722C1ECD735FF3395,app_remove,1536375553279000
4A2A03B50BDA6AC1687703BD39A91E3E,app_remove,1536373943292000
3E8245CE87EEDBDF995B682A717AE2FC,app_remove,1536338284652001
9EAAC1C6222FFE3D209C02C81C20F2A2,app_remove,1536332089666003
10CD441F79B53D8F7E281C38ACBEE2C3,app_remove,1536321975096087
C98FE4C10160A105798C65E6AA160974,app_remove,1536383727725000
0E65A1967A3EE64A4D33E6038D677FAD,app_remove,1536305843908000
0E5DAB111CB3C0001C0019712A83CB49,app_remove,1536342759713003
B7093DF68B89E56839995C16B8F68E93,app_remove,1536371536160000
F12F4F196933013F64399BF74945999B,app_remove,1536382731144046
B1C093A32996E59C0298E81A14398491,app_remove,1536325480816025
4150BBD5EF0CA2AF8F7DEF6564F2BEC7,app_remove,1536733810759000
83D52734761E2D2CD2A0FA00CDFC51A1,app_remove,1536663520179007
E993BC6B5A2E0A3A5668FC8D50DF7D57,app_remove,1536671166907000
4B6CFDAE1DAD6B5F0128A3220FA8A8FA,app_remove,1536697580677000
91F04D1260096767FD632D6988359288,app_remove,1536685558412000
1F0F7898A5CFCF4487F7A550FF382C0F,app_remove,1536711610195000
B85AED507ACF71D8DA3759892142E630,app_remove,1536673855204000
B79FEE3597E3C4A3B5A38FE33B684341,app_remove,1536694347122022
EDDB568DA4003B001E757D4D7C684422,app_remove,1536677892284000
093C7C670AB7A93613DB339730E922CA,app_remove,1536716244646000
E98C2033935E43DBA50950F7039FF492,app_remove,1536664560317031
F37788083CD17FEF93F66A5A8CFA9BCD,app_remove,1536706263714004
1FF5408483DCCD0779F33A5808028D60,app_remove,1536676367122003
41B8B6917AC3C354AC6A10CDC715FDDB,app_remove,1536684457978013
289290E298ED08B95B10DE971359B101,app_remove,1536686983196182
75E809C8A3B994794D2D6819057B1F3D,app_remove,1536735454608000
92400633510BB9E545007254608CF161,app_remove,1536670018754021
B1C1053B94816C354AC84E74D25158DC,app_remove,1536664236319000
350EE49AD4A5D94271B68547943EA11C,app_remove,1536704275730000
545182C3DDA3B8F17547979958C0CC01,app_remove,1536672766708000
DA2F5E960C7642C25BC2A610C7306E6C,app_remove,1536672754236000
A30EF85A0D907AC6D3CE8B2969F763BC,app_remove,1536679367302000
43B9E5915CF39E53BAF74E0B6C201BE1,app_remove,1536468624000014
9787E24A278D1ADF6BA8F7E041B33E89,app_remove,1536413613744000
108522345C425B9AEB5F83FE07C1A3A4,app_remove,1536466771508000
F24BBD36208042C587CEEFBF6951AA2B,app_remove,1536447346108118
9D1DFD3B46E37390B640CCDEF5B6B022,app_remove,1536401630670000

2025-02-10 16:37:26 - root - INFO - SQL:
-- 4. Get users who experienced an app crash ('app_exception') in September 2018
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_exception'
LIMIT 100;
Results:
user_pseudo_id
23670FFEF0FFC29FF59EA8E1A82E3A93
5002015381342F7B1BED810BB664801D
A2B8271B8CE580EC92A8D8CCAD85FE5C
7B12B56BE42BA15EE493BDC9902B54E4
FA30269453141794E79B8F15EE0BA5B9
FE46EFC1DA3F3159AD9343EC53466F3F
2E92432649219E3D30D0B72F89C5F51B
9664FAE9A17FD550BE78549EEA2773AC
E80C958E3C33898989A30B8F5A4514F0
8A1C79A7DD82197D40A2F4845010CF67
1690882C6796582749CA6818CBF9773F
0AF862AFEB5358EBFDA7AFE3AC908844
382B7E4C3513E0B32AD100ABCC15B917
0C777BD44F304574371C97674DCD0702
23183C7A7E31451194345099C978F49E
F488B4536BA104FE39ED63F2D4959B9C
E63711A66A34FED2396D9129A9B3E914
757F371D73A59AA7B6FB5CF1E6483B33
004D2DFEB866BFB00427DB2F530C1F3D
7CB4F979C9025D90BBBA34B3F3BF80C4
81D3DD49AA2304FD1ED8C498747B5FC6
FE4A220061DD4F9A25167AA519CD0620
BD3B5EDA6B9A4E0CD9DDDB6D7BC30C52
AFA41EF5E9CDCC4DF87A199049813E45
3DEB0C12C49AD19D7ACE68FA59E7ACD6
C8DC7E5DCC6A705EE7201AEB725A523B
02F5084C948BF823B7261A0353E92EE3
386EE7D00E029293C53C2ED7319EF520
0B15684EDDCE9514EFC8DDE9F80C5E7E
E594F4CE9B23146A461021258CC7ACA2
D31F0611DE6B94A5F001584286883AB7
9CD5BB1A0B88ABE7A4EDFD5A05972F33
E5A2CB7A471E740E758BE5E2E0C79BC2
C028D1BCE3EE4626D117DF55D6A617B8
18F64B514B4D980CF9605EBF1B77A330
390CFE5F2487173EC95DCF3CEECDB837
A95BA9143018CA81430258E8A725C3E6
A6112956075518E4697E3A60A55715A6
0DF6A14F536F6514A6F18BC12A532A82
4549717C06BAFE84FB1FFE5DDBD7EB2E
D6F5820E5B2C721C1677E1BC873B074A
E6FEE8B98E75EA5311FE004F98559A27
32C1DCB54AA38EDE6064F9574F80FF92
3F6F1E87699993F0F2136DAED1BD5729
C13987810D859EC3869A5D43C4A7D65A
3E8245CE87EEDBDF995B682A717AE2FC
7DCD9440F2BF5EB73FFCC4F26E26F580
5114C593C19D72F98121F32B0FA1BA7E
CC4F9BBD0104A39837B34D488E0EB689
F91F493916395FE4E16DE98B24388985
72B0A7CF704348BBF6061BC012F84B99
216BD01E519F6AD2E75A9564DDA116D6
12A0B6E613AC52FAAA4EA602FAB670FE
6DC218CEE0AD1BC0663FF76DA21B06A1
5145D8121071A9EA903A1098034962F6
BD5A3594B390BA8DD9489C06CBD73ADE
08A1668F786A08C724B1F99689AAF716
3B9DDD282F488869CFFCC057F70958B0
17934EF7C1BC1CF2C7D942401FDE84CE
14DE6B1CDA3BFD44679C7E9382644AC7
0A26E7281EC31038AD42F28C930FFF90
E1A3C786B2E4D56629EE808A3A174995
7392FB7027578690D48268EE642A3895
C96F1CB586725A7D165BCF665C131114
FD807541F1DE049B5D16ED3EE2DCF160
135BE5A161033D5A7BC7A0A8F4C80ACE
747538074CEC9FE551F488F3E47F9FD9
859BD5756C9635B9A657B90A7265679A
C139256BC6B95411865D96398AAC81B2
7AD3EDBE934417314BCC9116601C356D
176303D3809058BEA84AD4B59E6B6AF5
9BCF204FEB7332261F870DE9EAD57DCC
F9EF5F13B83A4CA8C74C7ABD868F23D5
0A74C26349ABD323C5CE34AB8DD52164
0CAAA1B6F161BA4D363EB7A2DEF64A08
C8FF91430B5EEEB18B55940C3B4F9B83
38D5FCD878ADCCC31D6410D6B1F81C20
BB29F8B0FF330F326605FA421BB37BC1
5C0B5019D09A484ECA0AF6E636D4205E
2CD0A58C01E50CB6D66FCF06ECAA4C1B
55F9FB7C14AA4BAB066EA326D4A2221B
079A0986730A27E47BDE659B49D0F1FC
89BD2B0E233951461CF06C9B4FDA0D81
51B215871E81C64077434452838DE86A
7FB0FA98A8949CD6D75B48C449DAE33B
734ADBB5D0874A5007E58B2F99625EE0
8A36D1D846123090C677E3E184B30614
CF788D99F3611C9C60EC709AA8368C09
51FB83B864E295B2E3961F703F37C945
86B8B276CF182074D6995751D2171075
9A46A573C1A4263A449716650F25ABFF
C3326C2CCF5D46173E4973A13512B163
5D6068901468CC98EA73004802D5E9A3

2025-02-10 16:37:28 - root - INFO - SQL:
-- 5. Retrieve all events for users who first opened the app in September 2018
SELECT *
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
LIMIT 100;
Results:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform,event_dimensions
20180904,1536121760967000,select_content,"[{'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 8275384520248787955, 'float_value': None, 'double_value': None}}, {'key': 'content_type', 'value': {'string_value': 'mode', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'item_id', 'value': {'string_value': 'progressive', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'main_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}]",1535819988624000,,26,1130478,,34ADF71F1AADCA26EC8008496F7CC87E,"[{'key': 'plays_quickplay', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778871379000}}, {'key': 'num_levels_available', 'value': {'string_value': '30', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121758963000}}, {'key': 'firebase_exp_4', 'value': {'string_value': '1', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121760406000}}, {'key': 'plays_progressive', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535779076831000}}, {'key': 'firebase_exp_1', 'value': {'string_value': '0', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778750288000}}, {'key': 'first_open_time', 'value': {'string_value': None, 'int_value': 1535778825958000, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778747958000}}, {'key': 'ad_frequency', 'value': {'string_value': '4', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778750226000}}, {'key': 'initial_extra_steps', 'value': {'string_value': '5', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778750226000}}]",1535778825958000,,"{'category': 'mobile', 'mobile_brand_name': 'not available in demo dataset', 'mobile_model_name': 'not available in demo dataset', 'mobile_marketing_name': 'not available in demo dataset', 'mobile_os_hardware_model': 'not available in demo dataset', 'operating_system': 'ANDROID', 'operating_system_version': 'not available in demo dataset', 'vendor_id': None, 'advertising_id': None, 'language': 'en-gb', 'is_limited_ad_tracking': 'No', 'time_zone_offset_seconds': 19800, 'browser': None, 'browser_version': None, 'web_info': None}","{'continent': 'Asia', 'country': 'India', 'region': None, 'city': None, 'sub_continent': None, 'metro': None}","{'id': 'com.labpixies.flood', 'version': '2.62', 'install_store': None, 'firebase_app_id': '1:300830567303:android:9b9ba2ce17104d0c', 'install_source': 'com.android.vending'}","{'name': '(direct)', 'medium': '(none)', 'source': '(direct)'}",1051193346,ANDROID,
20180904,1536121771609004,select_content,"[{'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 8275384520248787965, 'float_value': None, 'double_value': None}}, {'key': 'content_type', 'value': {'string_value': 'level', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'item_id', 'value': {'string_value': '26', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'level_select', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}]",1536121746967004,,26,1130478,,34ADF71F1AADCA26EC8008496F7CC87E,"[{'key': 'plays_quickplay', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778880379000}}, {'key': 'num_levels_available', 'value': {'string_value': '30', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121767963000}}, {'key': 'firebase_exp_4', 'value': {'string_value': '1', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121769406000}}, {'key': 'plays_progressive', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535779085831000}}, {'key': 'firebase_exp_1', 'value': {'string_value': '0', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778759288000}}, {'key': 'first_open_time', 'value': {'string_value': None, 'int_value': 1535778

2025-02-10 16:37:31 - root - INFO - SQL:
-- 6. Get users who uninstalled the app within 7 days of first opening
SELECT user_pseudo_id,
  DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) AS first_open_date,
  DATE(TIMESTAMP_MICROS(event_timestamp)) AS uninstall_date,
  DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) AS days_to_uninstall
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
Results:
user_pseudo_id,first_open_date,uninstall_date,days_to_uninstall
C7DD86F06FD4AA8A0967E27E20750FCD,2018-09-01,2018-09-08,7
63D8ACC080B6F91722C1ECD735FF3395,2018-09-05,2018-09-08,3
4A2A03B50BDA6AC1687703BD39A91E3E,2018-09-02,2018-09-08,6
3E8245CE87EEDBDF995B682A717AE2FC,2018-09-07,2018-09-07,0
9EAAC1C6222FFE3D209C02C81C20F2A2,2018-09-06,2018-09-07,1
10CD441F79B53D8F7E281C38ACBEE2C3,2018-09-07,2018-09-07,0
0E65A1967A3EE64A4D33E6038D677FAD,2018-09-07,2018-09-07,0
0E5DAB111CB3C0001C0019712A83CB49,2018-09-07,2018-09-07,0
F12F4F196933013F64399BF74945999B,2018-09-08,2018-09-08,0
B1C093A32996E59C0298E81A14398491,2018-09-05,2018-09-07,2
B9DFF32CBEB23C14C0CA2E839FBFA852,2018-09-25,2018-09-29,4
17318F4DF263AC8E1ADC63B2E3114549,2018-09-25,2018-09-29,4
9776078469CC89E9D043D18197701134,2018-09-27,2018-09-29,2
A0130C6FFE82A4523C6F6E97EC0A9B02,2018-09-26,2018-09-30,4
7F66A1BC5980819BC227A173BF506D68,2018-09-29,2018-09-29,0
3E5C1CCFC0B5ED76F342F57F7CDD0C9B,2018-09-29,2018-09-29,0
875A6901B633D21352CDE560EE3DA656,2018-09-26,2018-09-30,4
C6928D8A0DAE782911786BF2C5614279,2018-09-29,2018-09-30,1
88CE6B580698B1629E831342E186DD0C,2018-09-27,2018-09-30,3
0B77ADA5A9D24037334C6E339894BF64,2018-09-30,2018-09-30,0
8310DC2A15DC92C13DF598D4C7C35F9C,2018-09-30,2018-09-30,0
B6084E4BDF1F19A277C07ACB37026177,2018-09-29,2018-09-29,0
AEA5BEDF425C70ECD0E4EA2F546CD82C,2018-09-30,2018-09-30,0
D7EF597CFE7E3923048F66F89F156165,2018-09-29,2018-09-29,0
6722ACD286AC0F5CA22E745302CAEB89,2018-08-27,2018-09-01,5
14FC1A25D55E89AC7ECD600CD3A08C13,2018-09-02,2018-09-02,0
4EEE67C2E335213F6815144829801E0F,2018-09-02,2018-09-02,0
6D6EB70E837A5007BE550C44FF276440,2018-09-01,2018-09-01,0
C576922AC96E60240D148752D36BF34C,2018-08-26,2018-09-01,6
97D9D96077AD3E8859BF5C54C873E59D,2018-09-01,2018-09-01,0

2025-02-10 16:37:33 - root - INFO - SQL:
-- 7. Get users who first opened in September 2018 and uninstalled within 7 days
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
Results:
user_pseudo_id
AAED48FF76D1A69357473AD6C042D1BC
80FC9DC8D2C527192F27DBC2A449FA26
03E20359BA2BCB4CC83EC96EEF5CC8E5
1DA9CE8F372D1E9E57A9916E28AAC4B9
C7DD86F06FD4AA8A0967E27E20750FCD
3E8245CE87EEDBDF995B682A717AE2FC
0E65A1967A3EE64A4D33E6038D677FAD
0E5DAB111CB3C0001C0019712A83CB49
E8FE09424907F6CA22E68BE02A0ADF2C
7AA099658D8AF4D591404CDF2B2820C1
6A890958B89C55FCDFDDFA794B1A649D
837DA3BC7F14F77F8FC1402099FE43F4
5F86C514B339814A604D3ED457388B47
CEBA063FD7BF190D727CC948185CCEC8
7AB9D5F7D122A38CA8769C9C93F3A12F
DAD134C77F7E09BC552E290534CB90E8
A5302213F1605BE400E8AA34992B18A8
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
C945C989CF380E22E1B1E4B28E26801A
27C0BAADCE9520F17249A8B85F6477DA
747538074CEC9FE551F488F3E47F9FD9
69BB8289D391EEDAAB396DA0C3F8FF1D
CD3D8A3BFE9DDD830834C98597561029
6A1D30C821861EACD41F274E8E6D5455
8AE0BEA642E3BFAADCABB2FFC6D4B6B4
00AE0CA4117376AE083FD6AEA744CE88
2979D1B301F7F36C666AE78523223737
E1FEA6BA9D049EF343C2D18C13E32756
578CB14FCF0AB3CD15250A6991E76B91
4C2614370EF19318C141072F3EBFB9EC
C8D74BCA384C771A8D916972C4B214C0
1F0F7898A5CFCF4487F7A550FF382C0F
B79FEE3597E3C4A3B5A38FE33B684341
350EE49AD4A5D94271B68547943EA11C
545182C3DDA3B8F17547979958C0CC01
D8AC870224C476596EF7FCFC400C900C
9F162037940FC15E9F3A3E9DFCA4D2AE
24B74996895DBBFE033044C0D0088766
7064BC64E47E869B36967E854748969E
02508ACF3E0BA4D0C4770C03817AFDE3
501ED1D90DFFE96E802854A6364809BB
19AC79A99DEC69AED51C4EBE7F2DC4F6
95B590F12E8E14749D6634ACD4AF518F
6AA58246505F9C7A54D55074B908CBBD
80FD9717450806029DA432E39BBB5DFD
6E66FDFAD3496F82200B2C23B1EF0EF2
8041E05E5422C53623460B04B135D134
BDCFD1F0FDE47E594874CA47CD49C303
886A60A8D62105AC1400F05F6B36BC4B
328723183CB680790972B8FBBC3A1CE3
09A78964F0C8B9886D1169DBF3E21739
512DAA6DE2804B4BB543D1BED5781189
9EEF99CE81B3CB2D6AD1C850953E2871
A89BC996120727ACE4C955CA37F0E042
9776078469CC89E9D043D18197701134
A0130C6FFE82A4523C6F6E97EC0A9B02
7F66A1BC5980819BC227A173BF506D68
3E5C1CCFC0B5ED76F342F57F7CDD0C9B
C6928D8A0DAE782911786BF2C5614279
88CE6B580698B1629E831342E186DD0C
AEA5BEDF425C70ECD0E4EA2F546CD82C
68FD7BAA83E0EBA01BF3D9944032C0B3
492F7F04FA27A466D29C9C0FE7D0E843
8F780847855ADB932B0121C7278F375F
0EFA419FF8D1FB5BAA12E4794D511937
E15B0CD4F51AD17273D0EC73D1A787B3
23670FFEF0FFC29FF59EA8E1A82E3A93
264749B887AA92394A2F4E449D16A9F6
B2F5306E7AE65E6FA44BF49361F59A74
0969A1FA5300A40F4CFA6AE5BD539DE4
AA137B66E1975E5B854D7A786BDBC380
E6BD402E986856BE45A107744EA310EC
F3AABA92CF30313AB63EFFE29972B8D6
AB34C2DC3FDFA61951DFCD3831F38723
625B68C757B6B3A4EF64BA934546FED6
5F6DD799F3958CF37A364C8CDDB1560A
B65315819D817477B810CA2370FB5935
2DC473377FAF752C77B586711AA66A90
196CDAC439AE9EB9B70F6868A05FAD3D
E5E4C7E5600DD124D56BA0B0FF41B07C
B43BC1AF8B548310005F04BC42441D96
CB7266A7C254F626D21EE1A060CB4926
3B2F510266EE4C430F9105E6D77F9084
77538D72AC418FA45C2D6CDBEB4BBF49
2EC341EDFBBFB0D1C449264FE5C74FF9
57E7A689A86A94D750A4C68220DDD679
433E34F1BFEEF8A34A78D2C73D3AA014
4293BE87C4C4EE3249F6DCA7A27A866C
64E3BBB507EEFDE76364031EADF502F4
260F744C558B490AA7A98F05BB3E9E05
76B80AC19A11BEB87D87ED5D1A8642BA
8FEAB3AAF7434731E003747C511F06DE
AAE4779C1A0F48E482C71DE95A4FA0E1

2025-02-10 16:37:36 - root - INFO - SQL:
-- 8. Get users who first opened in September 2018, uninstalled within 7 days, and experienced an app crash
SELECT DISTINCT e1.user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*` AS e1
JOIN `firebase-public-project.analytics_153293282.events_201809*` AS e2
  ON e1.user_pseudo_id = e2.user_pseudo_id
WHERE e1.event_name = 'app_remove'
  AND e2.event_name = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
  AND e2.event_timestamp < e1.event_timestamp
LIMIT 100;
Results:
user_pseudo_id
F24BBD36208042C587CEEFBF6951AA2B
CF3F621F23B4C697E784B0998A1DB94E
747538074CEC9FE551F488F3E47F9FD9
3E8245CE87EEDBDF995B682A717AE2FC
361F3570C32F1CE252B63BA587E7BDDC
9664FAE9A17FD550BE78549EEA2773AC
23670FFEF0FFC29FF59EA8E1A82E3A93
9A10BF8F0166076BD918A5027396A46B
9EAAC1C6222FFE3D209C02C81C20F2A2
A622BBB66D14F224D949A6A86B87D4BA

2025-02-10 16:37:38 - root - INFO - SQL:
-- 9. Count total users who first opened in September 2018 and uninstalled within 7 days
SELECT COUNT(DISTINCT user_pseudo_id) AS total_users
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
Results:
total_users
347

2025-02-10 16:37:41 - root - INFO - SQL:
-- 10. Get the count of users who uninstalled within 7 days and experienced an app crash before uninstalling
SELECT COUNT(DISTINCT e1.user_pseudo_id) AS users_with_crash
FROM `firebase-public-project.analytics_153293282.events_201809*` AS e1
JOIN `firebase-public-project.analytics_153293282.events_201809*` AS e2
  ON e1.user_pseudo_id = e2.user_pseudo_id
WHERE e1.event_name = 'app_remove'
  AND e2.event_name = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
  AND e2.event_timestamp < e1.event_timestamp
LIMIT 100;
Results:
users_with_crash
10

2025-02-10 16:37:41 - root - INFO - itercount: 0
2025-02-10 16:37:41 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180801', 'events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **`event_name`**: Used to identify event types such as `'app_exception'` (app crash) and `'app_remove'` (uninstall).
- **`event_timestamp`**: The timestamp of the event, used to determine when events occurred.
- **`user_pseudo_id`**: A unique identifier for a user, used to group events by user.
- **`user_first_touch_timestamp`**: The timestamp when the user first opened the app, used to filter users who first opened the app in September 2018.
- **`event_date`**: String representation of the event date, used for date-based filtering.

**Conditions that may be used:**

- **`DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'`**: To select users who first opened the app in September 2018.
- **`event_name = 'app_remove'`**: To identify uninstall events.
- **`event_name = 'app_exception'`**: To identify app crash events.
- **`DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7`**: To find events that occurred within seven days of the user's first app open.

---

Here are 10 BigQuery SQL queries from simple to complex:

```sql
-- 1. Select distinct event names to see available events
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_201809*`
LIMIT 100;
```

---

```sql
-- 2. Select user IDs and their first touch timestamps for users who first opened the app in September 2018
SELECT user_pseudo_id, user_first_touch_timestamp
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
LIMIT 100;
```

---

```sql
-- 3. Select uninstall events in September 2018
SELECT user_pseudo_id, event_name, event_timestamp
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
LIMIT 100;
```

---

```sql
-- 4. Get users who experienced an app crash ('app_exception') in September 2018
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_exception'
LIMIT 100;
```

---

```sql
-- 5. Retrieve all events for users who first opened the app in September 2018
SELECT *
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
LIMIT 100;
```

---

```sql
-- 6. Get users who uninstalled the app within 7 days of first opening
SELECT user_pseudo_id,
  DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) AS first_open_date,
  DATE(TIMESTAMP_MICROS(event_timestamp)) AS uninstall_date,
  DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) AS days_to_uninstall
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
```

---

```sql
-- 7. Get users who first opened in September 2018 and uninstalled within 7 days
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
```

---

```sql
-- 8. Get users who first opened in September 2018, uninstalled within 7 days, and experienced an app crash
SELECT DISTINCT e1.user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*` AS e1
JOIN `firebase-public-project.analytics_153293282.events_201809*` AS e2
  ON e1.user_pseudo_id = e2.user_pseudo_id
WHERE e1.event_name = 'app_remove'
  AND e2.event_name = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
  AND e2.event_timestamp < e1.event_timestamp
LIMIT 100;
```

---

```sql
-- 9. Count total users who first opened in September 2018 and uninstalled within 7 days
SELECT COUNT(DISTINCT user_pseudo_id) AS total_users
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
```

---

```sql
-- 10. Get the count of users who uninstalled within 7 days and experienced an app crash before uninstalling
SELECT COUNT(DISTINCT e1.user_pseudo_id) AS users_with_crash
FROM `firebase-public-project.analytics_153293282.events_201809*` AS e1
JOIN `firebase-public-project.analytics_153293282.events_201809*` AS e2
  ON e1.user_pseudo_id = e2.user_pseudo_id
WHERE e1.event_name = 'app_remove'
  AND e2.event_name = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
  AND e2.event_timestamp < e1.event_timestamp
LIMIT 100;
```

---

**Additional Notes:**

- **Wildcard Table Selection**: The queries use the wildcard `events_201809*` to include all event tables for September 2018 (from `events_20180901` to `events_20180930`). This ensures that all relevant data for September is included.

- **Timestamp Conversion**: The `user_first_touch_timestamp` and `event_timestamp` are in microseconds since the epoch. The `TIMESTAMP_MICROS` function converts them to a TIMESTAMP data type, and `DATE` extracts the date part.

- **Calculating Days Difference**: The `DATE_DIFF` function calculates the difference in days between two dates, which is used to determine if the uninstall occurred within 7 days of the first app open.

- **Filtering Order of Events**: In query 8 and 10, we ensure that the `'app_exception'` event occurred before the `'app_remove'` event by comparing `event_timestamp`s.

- **Counting Distinct Users**: When counting users, we use `COUNT(DISTINCT user_pseudo_id)` to ensure each user is counted only once.

---

These queries should help in understanding the data and extracting the required information step by step. Running these queries will provide insights into the number of users who fit the criteria and help calculate the percentage you're interested in.Query:
-- 1. Select distinct event names to see available events
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_201809*`
LIMIT 100;
Answer:
event_name
level_complete
level_up
post_score
level_retry
level_start
user_engagement
app_exception
session_start
level_start_quickplay
level_retry_quickplay
app_remove
level_reset_quickplay
use_extra_steps
firebase_campaign
error
ad_reward
first_open
in_app_purchase
dynamic_link_first_open
completed_5_levels
level_end
screen_view
select_content
level_complete_quickplay
level_fail_quickplay
level_end_quickplay
spend_virtual_currency
app_clear_data
os_update
app_update
dynamic_link_app_open
challenge_accepted
level_fail
level_reset
no_more_extra_steps
challenge_a_friend
Query:
-- 2. Select user IDs and their first touch timestamps for users who first opened the app in September 2018
SELECT user_pseudo_id, user_first_touch_timestamp
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
LIMIT 100;
Answer:
user_pseudo_id,user_first_touch_timestamp
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000
Query:
-- 3. Select uninstall events in September 2018
SELECT user_pseudo_id, event_name, event_timestamp
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
LIMIT 100;
Answer:
user_pseudo_id,event_name,event_timestamp
C7DD86F06FD4AA8A0967E27E20750FCD,app_remove,1536368658104000
761430CDF522B29DB21632D60AA62446,app_remove,1536319117653000
E41F819718B0E2C49D347493BFACA027,app_remove,1536387398323000
130AD6E923A7BD4C62978F61DDB6D91F,app_remove,1536378770442000
E2372AFD5CBA85F1395201FB687AEC46,app_remove,1536304448680000
63D8ACC080B6F91722C1ECD735FF3395,app_remove,1536375553279000
4A2A03B50BDA6AC1687703BD39A91E3E,app_remove,1536373943292000
3E8245CE87EEDBDF995B682A717AE2FC,app_remove,1536338284652001
9EAAC1C6222FFE3D209C02C81C20F2A2,app_remove,1536332089666003
10CD441F79B53D8F7E281C38ACBEE2C3,app_remove,1536321975096087
C98FE4C10160A105798C65E6AA160974,app_remove,1536383727725000
0E65A1967A3EE64A4D33E6038D677FAD,app_remove,1536305843908000
0E5DAB111CB3C0001C0019712A83CB49,app_remove,1536342759713003
B7093DF68B89E56839995C16B8F68E93,app_remove,1536371536160000
F12F4F196933013F64399BF74945999B,app_remove,1536382731144046
B1C093A32996E59C0298E81A14398491,app_remove,1536325480816025
4150BBD5EF0CA2AF8F7DEF6564F2BEC7,app_remove,1536733810759000
83D52734761E2D2CD2A0FA00CDFC51A1,app_remove,1536663520179007
E993BC6B5A2E0A3A5668FC8D50DF7D57,app_remove,1536671166907000
4B6CFDAE1DAD6B5F0128A3220FA8A8FA,app_remove,1536697580677000
91F04D1260096767FD632D6988359288,app_remove,1536685558412000
1F0F7898A5CFCF4487F7A550FF382C0F,app_remove,1536711610195000
B85AED507ACF71D8DA3759892142E630,app_remove,1536673855204000
B79FEE3597E3C4A3B5A38FE33B684341,app_remove,1536694347122022
EDDB568DA4003B001E757D4D7C684422,app_remove,1536677892284000
093C7C670AB7A93613DB339730E922CA,app_remove,1536716244646000
E98C2033935E43DBA50950F7039FF492,app_remove,1536664560317031
F37788083CD17FEF93F66A5A8CFA9BCD,app_remove,1536706263714004
1FF5408483DCCD0779F33A5808028D60,app_remove,1536676367122003
41B8B6917AC3C354AC6A10CDC715FDDB,app_remove,1536684457978013
289290E298ED08B95B10DE971359B101,app_remove,1536686983196182
75E809C8A3B994794D2D6819057B1F3D,app_remove,1536735454608000
92400633510BB9E545007254608CF161,app_remove,1536670018754021
B1C1053B94816C354AC84E74D25158DC,app_remove,1536664236319000
350EE49AD4A5D94271B68547943EA11C,app_remove,1536704275730000
545182C3DDA3B8F17547979958C0CC01,app_remove,1536672766708000
DA2F5E960C7642C25BC2A610C7306E6C,app_remove,1536672754236000
A30EF85A0D907AC6D3CE8B2969F763BC,app_remove,1536679367302000
43B9E5915CF39E53BAF74E0B6C201BE1,app_remove,1536468624000014
9787E24A278D1ADF6BA8F7E041B33E89,app_remove,1536413613744000
108522345C425B9AEB5F83FE07C1A3A4,app_remove,1536466771508000
F24BBD36208042C587CEEFBF6951AA2B,app_remove,1536447346108118
9D1DFD3B46E37390B640CCDEF5B6B022,app_remove,1536401630670000
Query:
-- 4. Get users who experienced an app crash ('app_exception') in September 2018
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_exception'
LIMIT 100;
Answer:
user_pseudo_id
23670FFEF0FFC29FF59EA8E1A82E3A93
5002015381342F7B1BED810BB664801D
A2B8271B8CE580EC92A8D8CCAD85FE5C
7B12B56BE42BA15EE493BDC9902B54E4
FA30269453141794E79B8F15EE0BA5B9
FE46EFC1DA3F3159AD9343EC53466F3F
2E92432649219E3D30D0B72F89C5F51B
9664FAE9A17FD550BE78549EEA2773AC
E80C958E3C33898989A30B8F5A4514F0
8A1C79A7DD82197D40A2F4845010CF67
1690882C6796582749CA6818CBF9773F
0AF862AFEB5358EBFDA7AFE3AC908844
382B7E4C3513E0B32AD100ABCC15B917
0C777BD44F304574371C97674DCD0702
23183C7A7E31451194345099C978F49E
F488B4536BA104FE39ED63F2D4959B9C
E63711A66A34FED2396D9129A9B3E914
757F371D73A59AA7B6FB5CF1E6483B33
004D2DFEB866BFB00427DB2F530C1F3D
7CB4F979C9025D90BBBA34B3F3BF80C4
81D3DD49AA2304FD1ED8C498747B5FC6
FE4A220061DD4F9A25167AA519CD0620
BD3B5EDA6B9A4E0CD9DDDB6D7BC30C52
AFA41EF5E9CDCC4DF87A199049813E45
3DEB0C12C49AD19D7ACE68FA59E7ACD6
C8DC7E5DCC6A705EE7201AEB725A523B
02F5084C948BF823B7261A0353E92EE3
386EE7D00E029293C53C2ED7319EF520
0B15684EDDCE9514EFC8DDE9F80C5E7E
E594F4CE9B23146A461021258CC7ACA2
D31F0611DE6B94A5F001584286883AB7
9CD5BB1A0B88ABE7A4EDFD5A05972F33
E5A2CB7A471E740E758BE5E2E0C79BC2
C028D1BCE3EE4626D117DF55D6A617B8
18F64B514B4D980CF9605EBF1B77A330
390CFE5F2487173EC95DCF3CEECDB837
A95BA9143018CA81430258E8A725C3E6
A6112956075518E4697E3A60A55715A6
0DF6A14F536F6514A6F18BC12A532A82
4549717C06BAFE84FB1FFE5DDBD7EB2E
D6F5820E5B2C721C1677E1BC873B074A
E6FEE8B98E75EA5311FE004F98559A27
32C1DCB54AA38EDE6064F9574F80FF92
3F6F1E87699993F0F2136DAED1BD5729
C13987810D859EC3869A5D43C4A7D65A
3E8245CE87EEDBDF995B682A717AE2FC
7DCD9440F2BF5EB73FFCC4F26E26F580
5114C593C19D72F98121F32B0FA1BA7E
CC4F9BBD0104A39837B34D488E0EB689
F91F493916395FE4E16DE98B24388985
72B0A7CF704348BBF6061BC012F84B99
216BD01E519F6AD2E75A9564DDA116D6
12A0B6E613AC52FAAA4EA602FAB670FE
6DC218CEE0AD1BC0663FF76DA21B06A1
5145D8121071A9EA903A1098034962F6
BD5A3594B390BA8DD9489C06CBD73ADE
08A1668F786A08C724B1F99689AAF716
3B9DDD282F488869CFFCC057F70958B0
17934EF7C1BC1CF2C7D942401FDE84CE
14DE6B1CDA3BFD44679C7E9382644AC7
0A26E7281EC31038AD42F28C930FFF90
E1A3C786B2E4D56629EE808A3A174995
7392FB7027578690D48268EE642A3895
C96F1CB586725A7D165BCF665C131114
FD807541F1DE049B5D16ED3EE2DCF160
135BE5A161033D5A7BC7A0A8F4C80ACE
747538074CEC9FE551F488F3E47F9FD9
859BD5756C9635B9A657B90A7265679A
C139256BC6B95411865D96398AAC81B2
7AD3EDBE934417314BCC9116601C356D
176303D3809058BEA84AD4B59E6B6AF5
9BCF204FEB7332261F870DE9EAD57DCC
F9EF5F13B83A4CA8C74C7ABD868F23D5
0A74C26349ABD323C5CE34AB8DD52164
0CAAA1B6F161BA4D363EB7A2DEF64A08
C8FF91430B5EEEB18B55940C3B4F9B83
38D5FCD878ADCCC31D6410D6B1F81C20
BB29F8B0FF330F326605FA421BB37BC1
5C0B5019D09A484ECA0AF6E636D4205E
2CD0A58C01E50CB6D66FCF06ECAA4C1B
55F9FB7C14AA4BAB066EA326D4A2221B
079A0986730A27E47BDE659B49D0F1FC
89BD2B0E233951461CF06C9B4FDA0D81
51B215871E81C64077434452838DE86A
7FB0FA98A8949CD6D75B48C449DAE33B
734ADBB5D0874A5007E58B2F99625EE0
8A36D1D846123090C677E3E184B30614
CF788D99F3611C9C60EC709AA8368C09
51FB83B864E295B2E3961F703F37C945
86B8B276CF182074D6995751D2171075
9A46A573C1A4263A449716650F25ABFF
C3326C2CCF5D46173E4973A13512B163
5D6068901468CC98EA73004802D5E9A3
Query:
-- 5. Retrieve all events for users who first opened the app in September 2018
SELECT *
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
LIMIT 100;
Answer:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform,event_dimensions
20180904,1536121760967000,select_content,"[{'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 8275384520248787955, 'float_value': None, 'double_value': None}}, {'key': 'content_type', 'value': {'string_value': 'mode', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'item_id', 'value': {'string_value': 'progressive', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'main_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}]",1535819988624000,,26,1130478,,34ADF71F1AADCA26EC8008496F7CC87E,"[{'key': 'plays_quickplay', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778871379000}}, {'key': 'num_levels_available', 'value': {'string_value': '30', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121758963000}}, {'key': 'firebase_exp_4', 'value': {'string_value': '1', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121760406000}}, {'key': 'plays_progressive', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535779076831000}}, {'key': 'firebase_exp_1', 'value': {'string_value': '0', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778750288000}}, {'key': 'first_open_time', 'value': {'string_value': None, 'int_value': 1535778825958000, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778747958000}}, {'key': 'ad_frequency', 'value': {'string_value': '4', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778750226000}}, {'key': 'initial_extra_steps', 'value': {'string_value': '5', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778750226000}}]",1535778825958000,,"{'category': 'mobile', 'mobile_brand_name': 'not available in demo dataset', 'mobile_model_name': 'not available in demo dataset', 'mobile_marketing_name': 'not available in demo dataset', 'mobile_os_hardware_model': 'not available in demo dataset', 'operating_system': 'ANDROID', 'operating_system_version': 'not available in demo dataset', 'vendor_id': None, 'advertising_id': None, 'language': 'en-gb', 'is_limited_ad_tracking': 'No', 'time_zone_offset_seconds': 19800, 'browser': None, 'browser_version': None, 'web_info': None}","{'continent': 'Asia', 'country': 'India', 'region': None, 'city': None, 'sub_continent': None, 'metro': None}","{'id': 'com.labpixies.flood', 'version': '2.62', 'install_store': None, 'firebase_app_id': '1:300830567303:android:9b9ba2ce17104d0c', 'install_source': 'com.android.vending'}","{'name': '(direct)', 'medium': '(none)', 'source': '(direct)'}",1051193346,ANDROID,
20180904,1536121771609004,select_content,"[{'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 8275384520248787965, 'float_value': None, 'double_value': None}}, {'key': 'content_type', 'value': {'string_value': 'level', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'item_id', 'value': {'string_value': '26', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'level_select', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}]",1536121746967004,,26,1130478,,34ADF71F1AADCA26EC8008496F7CC87E,"[{'key': 'plays_quickplay', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778880379000}}, {'key': 'num_levels_available', 'value': {'string_value': '30', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121767963000}}, {'key': 'firebase_exp_4', 'value': {'string_value': '1', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1536121769406000}}, {'key': 'plays_progressive', 'value': {'string_value': 'true', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535779085831000}}, {'key': 'firebase_exp_1', 'value': {'string_value': '0', 'int_value': None, 'float_value': None, 'double_value': None, 'set_timestamp_micros': 1535778759288000}}, {'key': 'first_open_time', 'value': {'string_value': None, 'int_value': 1535778
Query:
-- 6. Get users who uninstalled the app within 7 days of first opening
SELECT user_pseudo_id,
  DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) AS first_open_date,
  DATE(TIMESTAMP_MICROS(event_timestamp)) AS uninstall_date,
  DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) AS days_to_uninstall
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
Answer:
user_pseudo_id,first_open_date,uninstall_date,days_to_uninstall
C7DD86F06FD4AA8A0967E27E20750FCD,2018-09-01,2018-09-08,7
63D8ACC080B6F91722C1ECD735FF3395,2018-09-05,2018-09-08,3
4A2A03B50BDA6AC1687703BD39A91E3E,2018-09-02,2018-09-08,6
3E8245CE87EEDBDF995B682A717AE2FC,2018-09-07,2018-09-07,0
9EAAC1C6222FFE3D209C02C81C20F2A2,2018-09-06,2018-09-07,1
10CD441F79B53D8F7E281C38ACBEE2C3,2018-09-07,2018-09-07,0
0E65A1967A3EE64A4D33E6038D677FAD,2018-09-07,2018-09-07,0
0E5DAB111CB3C0001C0019712A83CB49,2018-09-07,2018-09-07,0
F12F4F196933013F64399BF74945999B,2018-09-08,2018-09-08,0
B1C093A32996E59C0298E81A14398491,2018-09-05,2018-09-07,2
B9DFF32CBEB23C14C0CA2E839FBFA852,2018-09-25,2018-09-29,4
17318F4DF263AC8E1ADC63B2E3114549,2018-09-25,2018-09-29,4
9776078469CC89E9D043D18197701134,2018-09-27,2018-09-29,2
A0130C6FFE82A4523C6F6E97EC0A9B02,2018-09-26,2018-09-30,4
7F66A1BC5980819BC227A173BF506D68,2018-09-29,2018-09-29,0
3E5C1CCFC0B5ED76F342F57F7CDD0C9B,2018-09-29,2018-09-29,0
875A6901B633D21352CDE560EE3DA656,2018-09-26,2018-09-30,4
C6928D8A0DAE782911786BF2C5614279,2018-09-29,2018-09-30,1
88CE6B580698B1629E831342E186DD0C,2018-09-27,2018-09-30,3
0B77ADA5A9D24037334C6E339894BF64,2018-09-30,2018-09-30,0
8310DC2A15DC92C13DF598D4C7C35F9C,2018-09-30,2018-09-30,0
B6084E4BDF1F19A277C07ACB37026177,2018-09-29,2018-09-29,0
AEA5BEDF425C70ECD0E4EA2F546CD82C,2018-09-30,2018-09-30,0
D7EF597CFE7E3923048F66F89F156165,2018-09-29,2018-09-29,0
6722ACD286AC0F5CA22E745302CAEB89,2018-08-27,2018-09-01,5
14FC1A25D55E89AC7ECD600CD3A08C13,2018-09-02,2018-09-02,0
4EEE67C2E335213F6815144829801E0F,2018-09-02,2018-09-02,0
6D6EB70E837A5007BE550C44FF276440,2018-09-01,2018-09-01,0
C576922AC96E60240D148752D36BF34C,2018-08-26,2018-09-01,6
97D9D96077AD3E8859BF5C54C873E59D,2018-09-01,2018-09-01,0
Query:
-- 7. Get users who first opened in September 2018 and uninstalled within 7 days
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
Answer:
user_pseudo_id
AAED48FF76D1A69357473AD6C042D1BC
80FC9DC8D2C527192F27DBC2A449FA26
03E20359BA2BCB4CC83EC96EEF5CC8E5
1DA9CE8F372D1E9E57A9916E28AAC4B9
C7DD86F06FD4AA8A0967E27E20750FCD
3E8245CE87EEDBDF995B682A717AE2FC
0E65A1967A3EE64A4D33E6038D677FAD
0E5DAB111CB3C0001C0019712A83CB49
E8FE09424907F6CA22E68BE02A0ADF2C
7AA099658D8AF4D591404CDF2B2820C1
6A890958B89C55FCDFDDFA794B1A649D
837DA3BC7F14F77F8FC1402099FE43F4
5F86C514B339814A604D3ED457388B47
CEBA063FD7BF190D727CC948185CCEC8
7AB9D5F7D122A38CA8769C9C93F3A12F
DAD134C77F7E09BC552E290534CB90E8
A5302213F1605BE400E8AA34992B18A8
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
C945C989CF380E22E1B1E4B28E26801A
27C0BAADCE9520F17249A8B85F6477DA
747538074CEC9FE551F488F3E47F9FD9
69BB8289D391EEDAAB396DA0C3F8FF1D
CD3D8A3BFE9DDD830834C98597561029
6A1D30C821861EACD41F274E8E6D5455
8AE0BEA642E3BFAADCABB2FFC6D4B6B4
00AE0CA4117376AE083FD6AEA744CE88
2979D1B301F7F36C666AE78523223737
E1FEA6BA9D049EF343C2D18C13E32756
578CB14FCF0AB3CD15250A6991E76B91
4C2614370EF19318C141072F3EBFB9EC
C8D74BCA384C771A8D916972C4B214C0
1F0F7898A5CFCF4487F7A550FF382C0F
B79FEE3597E3C4A3B5A38FE33B684341
350EE49AD4A5D94271B68547943EA11C
545182C3DDA3B8F17547979958C0CC01
D8AC870224C476596EF7FCFC400C900C
9F162037940FC15E9F3A3E9DFCA4D2AE
24B74996895DBBFE033044C0D0088766
7064BC64E47E869B36967E854748969E
02508ACF3E0BA4D0C4770C03817AFDE3
501ED1D90DFFE96E802854A6364809BB
19AC79A99DEC69AED51C4EBE7F2DC4F6
95B590F12E8E14749D6634ACD4AF518F
6AA58246505F9C7A54D55074B908CBBD
80FD9717450806029DA432E39BBB5DFD
6E66FDFAD3496F82200B2C23B1EF0EF2
8041E05E5422C53623460B04B135D134
BDCFD1F0FDE47E594874CA47CD49C303
886A60A8D62105AC1400F05F6B36BC4B
328723183CB680790972B8FBBC3A1CE3
09A78964F0C8B9886D1169DBF3E21739
512DAA6DE2804B4BB543D1BED5781189
9EEF99CE81B3CB2D6AD1C850953E2871
A89BC996120727ACE4C955CA37F0E042
9776078469CC89E9D043D18197701134
A0130C6FFE82A4523C6F6E97EC0A9B02
7F66A1BC5980819BC227A173BF506D68
3E5C1CCFC0B5ED76F342F57F7CDD0C9B
C6928D8A0DAE782911786BF2C5614279
88CE6B580698B1629E831342E186DD0C
AEA5BEDF425C70ECD0E4EA2F546CD82C
68FD7BAA83E0EBA01BF3D9944032C0B3
492F7F04FA27A466D29C9C0FE7D0E843
8F780847855ADB932B0121C7278F375F
0EFA419FF8D1FB5BAA12E4794D511937
E15B0CD4F51AD17273D0EC73D1A787B3
23670FFEF0FFC29FF59EA8E1A82E3A93
264749B887AA92394A2F4E449D16A9F6
B2F5306E7AE65E6FA44BF49361F59A74
0969A1FA5300A40F4CFA6AE5BD539DE4
AA137B66E1975E5B854D7A786BDBC380
E6BD402E986856BE45A107744EA310EC
F3AABA92CF30313AB63EFFE29972B8D6
AB34C2DC3FDFA61951DFCD3831F38723
625B68C757B6B3A4EF64BA934546FED6
5F6DD799F3958CF37A364C8CDDB1560A
B65315819D817477B810CA2370FB5935
2DC473377FAF752C77B586711AA66A90
196CDAC439AE9EB9B70F6868A05FAD3D
E5E4C7E5600DD124D56BA0B0FF41B07C
B43BC1AF8B548310005F04BC42441D96
CB7266A7C254F626D21EE1A060CB4926
3B2F510266EE4C430F9105E6D77F9084
77538D72AC418FA45C2D6CDBEB4BBF49
2EC341EDFBBFB0D1C449264FE5C74FF9
57E7A689A86A94D750A4C68220DDD679
433E34F1BFEEF8A34A78D2C73D3AA014
4293BE87C4C4EE3249F6DCA7A27A866C
64E3BBB507EEFDE76364031EADF502F4
260F744C558B490AA7A98F05BB3E9E05
76B80AC19A11BEB87D87ED5D1A8642BA
8FEAB3AAF7434731E003747C511F06DE
AAE4779C1A0F48E482C71DE95A4FA0E1
Query:
-- 8. Get users who first opened in September 2018, uninstalled within 7 days, and experienced an app crash
SELECT DISTINCT e1.user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_201809*` AS e1
JOIN `firebase-public-project.analytics_153293282.events_201809*` AS e2
  ON e1.user_pseudo_id = e2.user_pseudo_id
WHERE e1.event_name = 'app_remove'
  AND e2.event_name = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
  AND e2.event_timestamp < e1.event_timestamp
LIMIT 100;
Answer:
user_pseudo_id
F24BBD36208042C587CEEFBF6951AA2B
CF3F621F23B4C697E784B0998A1DB94E
747538074CEC9FE551F488F3E47F9FD9
3E8245CE87EEDBDF995B682A717AE2FC
361F3570C32F1CE252B63BA587E7BDDC
9664FAE9A17FD550BE78549EEA2773AC
23670FFEF0FFC29FF59EA8E1A82E3A93
9A10BF8F0166076BD918A5027396A46B
9EAAC1C6222FFE3D209C02C81C20F2A2
A622BBB66D14F224D949A6A86B87D4BA
Query:
-- 9. Count total users who first opened in September 2018 and uninstalled within 7 days
SELECT COUNT(DISTINCT user_pseudo_id) AS total_users
FROM `firebase-public-project.analytics_153293282.events_201809*`
WHERE event_name = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
LIMIT 100;
Answer:
total_users
347
Query:
-- 10. Get the count of users who uninstalled within 7 days and experienced an app crash before uninstalling
SELECT COUNT(DISTINCT e1.user_pseudo_id) AS users_with_crash
FROM `firebase-public-project.analytics_153293282.events_201809*` AS e1
JOIN `firebase-public-project.analytics_153293282.events_201809*` AS e2
  ON e1.user_pseudo_id = e2.user_pseudo_id
WHERE e1.event_name = 'app_remove'
  AND e2.event_name = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
  AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
  AND e2.event_timestamp < e1.event_timestamp
LIMIT 100;
Answer:
users_with_crash
10
End Exploring Related Columns
Task: For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Percentage
value:0<=float<=100
(Attention: answer in one row)
```

This represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash (`app_exception` event) before uninstalling..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180801', 'events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 16:38:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:38:53 - root - INFO - ```sql
SELECT
  (
    (SELECT COUNT(DISTINCT e1.user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e1
     JOIN `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e2
       ON e1.user_pseudo_id = e2.user_pseudo_id
     WHERE e1.event_name = 'app_remove'
       AND e2.event_name = 'app_exception'
       AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
       AND e2.event_timestamp < e1.event_timestamp
    ) /
    (SELECT COUNT(DISTINCT user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*`
     WHERE event_name = 'app_remove'
       AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
    )
  ) * 100 AS Percentage
```
2025-02-10 16:38:55 - root - INFO - itercount: 1
2025-02-10 16:38:55 - root - INFO - 0
2025-02-10 16:38:55 - root - INFO - results: 
Percentage
2.881844380403458


2025-02-10 16:38:55 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage
value:0<=float<=100
(Attention: answer in one row)
```

This represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash (`app_exception` event) before uninstalling. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage
2.881844380403458
Current sql:
SELECT
  (
    (SELECT COUNT(DISTINCT e1.user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e1
     JOIN `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e2
       ON e1.user_pseudo_id = e2.user_pseudo_id
     WHERE e1.event_name = 'app_remove'
       AND e2.event_name = 'app_exception'
       AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(DATE(TIMESTAMP_MICROS(e1.event_timestamp)), DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)), DAY) <= 7
       AND e2.event_timestamp < e1.event_timestamp
    ) /
    (SELECT COUNT(DISTINCT user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*`
     WHERE event_name = 'app_remove'
       AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)), DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) <= 7
    )
  ) * 100 AS Percentage
2025-02-10 16:39:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:39:19 - root - INFO - ```sql
SELECT
  (
    (SELECT COUNT(DISTINCT e1.user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e1
     JOIN `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e2
       ON e1.user_pseudo_id = e2.user_pseudo_id
     WHERE e1.event_name = 'app_remove'
       AND e2.event_name = 'app_exception'
       AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(
         DATE(TIMESTAMP_MICROS(e1.event_timestamp)),
         DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)),
         DAY
       ) <= 7
       AND DATE(TIMESTAMP_MICROS(e2.event_timestamp)) < DATE(TIMESTAMP_MICROS(e1.event_timestamp))
    ) /
    (SELECT COUNT(DISTINCT user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*`
     WHERE event_name = 'app_remove'
       AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(
         DATE(TIMESTAMP_MICROS(event_timestamp)),
         DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
         DAY
       ) <= 7
    )
  ) * 100 AS Percentage
```

```csv
Percentage
2.8818
```
2025-02-10 16:39:21 - root - INFO - itercount: 2
2025-02-10 16:39:21 - root - INFO - 0
2025-02-10 16:39:21 - root - INFO - results: 
Percentage
1.1527377521613833


2025-02-10 16:39:21 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage
value:0<=float<=100
(Attention: answer in one row)
```

This represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash (`app_exception` event) before uninstalling. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage
1.1527377521613833
Current sql:
SELECT
  (
    (SELECT COUNT(DISTINCT e1.user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e1
     JOIN `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e2
       ON e1.user_pseudo_id = e2.user_pseudo_id
     WHERE e1.event_name = 'app_remove'
       AND e2.event_name = 'app_exception'
       AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(
         DATE(TIMESTAMP_MICROS(e1.event_timestamp)),
         DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)),
         DAY
       ) <= 7
       AND DATE(TIMESTAMP_MICROS(e2.event_timestamp)) < DATE(TIMESTAMP_MICROS(e1.event_timestamp))
    ) /
    (SELECT COUNT(DISTINCT user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*`
     WHERE event_name = 'app_remove'
       AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(
         DATE(TIMESTAMP_MICROS(event_timestamp)),
         DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
         DAY
       ) <= 7
    )
  ) * 100 AS Percentage
2025-02-10 16:40:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:40:14 - root - INFO - ```sql
SELECT
  ROUND((
    (SELECT COUNT(DISTINCT e1.user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e1
     JOIN `firebase-public-project`.`analytics_153293282`.`events_201809*` AS e2
       ON e1.user_pseudo_id = e2.user_pseudo_id
     WHERE e1.event_name = 'app_remove'
       AND e2.event_name = 'app_exception'
       AND DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(
         DATE(TIMESTAMP_MICROS(e1.event_timestamp)),
         DATE(TIMESTAMP_MICROS(e1.user_first_touch_timestamp)),
         DAY
       ) <= 7
       AND DATE(TIMESTAMP_MICROS(e2.event_timestamp)) < DATE(TIMESTAMP_MICROS(e1.event_timestamp))
    ) /
    (SELECT COUNT(DISTINCT user_pseudo_id)
     FROM `firebase-public-project`.`analytics_153293282`.`events_201809*`
     WHERE event_name = 'app_remove'
       AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-09-01' AND '2018-09-30'
       AND DATE_DIFF(
         DATE(TIMESTAMP_MICROS(event_timestamp)),
         DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
         DAY
       ) <= 7
    ) * 100
  ), 4) AS Percentage
```

```csv
Percentage
1.1527
```
2025-02-10 16:40:17 - root - INFO - itercount: 3
2025-02-10 16:40:17 - root - INFO - 0
2025-02-10 16:40:17 - root - INFO - Total iteration counts: 3
