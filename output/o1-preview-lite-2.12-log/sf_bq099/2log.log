2025-01-22 21:24:40 - openai._base_client - INFO - Retrying request to /chat/completions in 0.397449 seconds
2025-01-22 21:25:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:25:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:45 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:46 - root - INFO - SQL:
SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f
   LIMIT 100;
Results:
Too long, hard cut:
cpc_code
"{""code"":""B29K2021/00"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03C7/3212"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D17/4012"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04Q1/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""E04B1/803"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G01N33/726"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C21B2100/22"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C08F8/42"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H03F2200/451"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H04L49/1515"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D04H1/54"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B32B27/325"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A46B1/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C12N5/0068"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61F9/027"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G03F7/2008"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G06F3/0638"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/6876"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C02F3/341"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F02K9/86"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06F9/45558"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L29/66136"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06V20/49"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04L9/3247"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65B65/08"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H10K71/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G01N2223/401"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03B15/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G03F7/70883"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B44B7/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C12P7/46"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65H15/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G11B2007/2432"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""E02D27/42"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L21/0242"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/04"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C04B2235/663"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01L21/78"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/3441"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01L24/97"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B23B2228/10"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H05K1/0284"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01F41/046"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G02B6/3526"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L2224/32225"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""D06F37/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D06F37/265"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04W72/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D307/33"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/150984"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2013/8497"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2005/3128"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""D06M14/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/744"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M16/024"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C09D11/54"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G09G2320/0257"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02F1/133528"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02B6/428"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01S13/765"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G01C21/3469"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01V5/0025"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07K14/7155"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/0406"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01F41/063"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E21B17/01""

2025-01-22 21:25:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:47 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:48 - root - INFO - SQL:
SELECT t."application_number"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f
   WHERE f.value::STRING ILIKE '%A01B3%'
   LIMIT 100;
Results:
application_number
US-1904197554-A
US-50994255-A
US-50994255-A
US-52103631-A
US-52103631-A
US-501724D-A
US-20046750-A
US-20046750-A
US-220177D-A
US-5528360-A
US-5528360-A
US-6966360-A
US-6966360-A
US-5637735-A
US-5637735-A
AU-7115874-A
GB-1095134-A
GB-1095134-A
GB-585551-A
IL-26862419-A
IL-26862419-A
BE-192096-A
BE-192096-A
BE-192096-A
KR-20180111810-A
KR-20180111810-A
US-130700D-A
FR-960102D-A
FR-960102D-A
US-231385D-A
KR-20050007441-U
AT-720679-A
BE-727862D-A
FR-0901549-A
KR-20000035371-A
BE-154048-A
BE-154048-A
US-530054D-A
US-25445318-A
US-25445318-A
US-290366D-A
EP-17737210-A
EP-17737210-A
DE-102017102683-A
KR-20000009753-U
US-51933174-A
US-51933174-A
US-51933174-A
US-51933174-A
KR-20180002946-U
US-1901066531-A
FR-508965D-A
FR-508965D-A
US-77255596-A
US-77255596-A
CN-201810758930-A
CN-201810758930-A
PL-44042622-A
PL-44042622-A
PL-44042622-A
PL-44042622-A
CN-202210179147-A
CN-202210179147-A
CN-202210179147-A
US-202217990129-A
US-202217990129-A
US-202217990129-A
CN-202111095366-A
CN-202111095366-A
KR-20000011273-A
CN-201580056876-A
CN-201580056876-A
CN-201580056876-A
CN-201710053605-A
KR-20120005914-A
KR-20150076822-A
CN-201510892651-A
CN-201510892651-A
CN-201811558564-A
CN-201811558564-A
KR-20110130418-A
KR-20010007666-A
AU-2016269849-A
AU-2016269849-A
CN-202210606325-A
CN-202210606325-A
NO-822521-A
DE-L0066972-D
US-72598847-A
US-72598847-A
US-72598847-A
US-72598847-A
HU-E16197432-A
KR-20130001424-U
US-71336434-A
US-71336434-A
US-1913771943-A
KR-20060032729-A
KR-20060032729-A
DE-102010019819-A

2025-01-22 21:25:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:49 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:50 - root - INFO - SQL:
SELECT f.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f
   LIMIT 100;
Results:
assignee_name
SKYWORKS SOLUTIONS INC
USNR LLC
KENNAMETAL INC
HONEYWELL FEDERAL MFG & TECH LLC
TROBOLOWITSCH FRIEDRICH
GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD
WERIDE CORP
ASCENSIA DIABETES CARE HOLDINGS AG
TYCO FIRE PRODUCTS LP
ELLIOTT DAVID LEAMON
IBM
WONG DAVID I KEONG
SPECTRASENSORS INC
HEWLETT PACKARD ENTPR DEV LP
TOYOTA MOTOR CO LTD
QUALCOMM INC
NXP USA INC
UNIV CALIFORNIA
TOYOTA MOTOR CO LTD
BRONNERT HERVE X
CISCO TECH INC
SKYWORKS SOLUTIONS INC
BOLB INC
BAXALTA INC
Baxalta GmbH
ATOMITE INC
RECKITT BENCKISER BRANDS LTD
MOBILE APPLIANCE INC
SCIVAX CORP
JXTG NIPPON OIL & ENERGY CORP
CHIYODA CORP
VOLPARA HEALTH TECH LIMITED
BIGBEN INTERACTIVE SA
BYD CO LTD
HEWLETT PACKARD DEVELOPMENT CO
NOON HOME INC
TOMOEGAWA CO LTD
AFI LICENSING LLC
ACETYLON PHARMACEUTICALS INC
MARTINEZ NANCY
CISCO TECH INC
NITTO DENKO CORP
COLGATE PALMOLIVE CO
FLUIDMASTER
CELLMIG BIOLABS INC
WISCONSIN ALUMNI RES FOUND
CROWDSTRIKE INC
TOYOTA ENG & MFG NORTH AMERICA
BASF SE
DELTA ELECTRONICS INC
OSCILLOSCAPE LLC
NUOVO PIGNONE TECNOLOGIE SRL
GOOGLE LLC
Infrrd Inc
CHIUN MAI COMMUNICATION SYSTEMS INC
VITRO FLAT GLASS LLC
EMC IP HOLDING CO LLC
YAMAHA MOTOR CO LTD
POWER SURVEY LLC
ELECTRONICS FOR IMAGING INC
WOERMANN BERND
UNIV BEIJING TECHNOLOGY
GOPC PTY LTD
EVONIK DEGUSSA GMBH
KS GLEITLAGER GMBH
LG ELECTRONICS INC
NICOMATIC
NIELSEN CO US LLC
CARGILL INC
EPIC TECH LLC
FUJIFILM CORP
MICRON TECHNOLOGY INC
PAX LABS INC
SENKO ADVANCED COMPONENTS INC
APPAREO SYSTEMS LLC
DETOXICATED INC
UNITED TECHNOLOGIES CORP
FUJI ELECTRIC CO LTD
PMG VENTURES INC
CUMMINS POWER GENERATION IP
SK SILTRON CO LTD
BIOSENSE WEBSTER ISRAEL LTD
R J REYNOLDS TOBACCO PRODUCTS
DGSHAPE CORP
GOOGLE LLC
ABBOTT LAB
TAIWAN SEMICONDUCTOR MFG CO LTD
SIEMENS HEALTHCARE GMBH
OREAL
SZ DJI TECHNOLOGY CO LTD
CONTEMPORARY AMPEREX TECHNOLOGY CO LTD
Baidu online network technology beijing co ltd
IBM
IBM
EBARA CORP
TORONTO DOMINION BANK
EMC IP HOLDING CO LLC
SNIPR TECH LTD
TOSHIBA KK
SAMSUNG ELECTRONICS CO LTD

2025-01-22 21:25:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:52 - root - INFO - SQL:
SELECT t."application_number", f1.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f2,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
   WHERE f2.value::STRING ILIKE '%A01B3%'
   LIMIT 100;
Results:
application_number,assignee_name
US-50994255-A,JIM ALEX SMITH
US-50994255-A,JIM ALEX SMITH
US-52103631-A,GLASIER HAROLD H
US-52103631-A,GLASIER HAROLD H
CA-2543900-A,EDWARDS JOHN W
CA-2543900-A,EDWARDS JOHN W
US-1912673206-A,SOUTHERN PLOW COMPANY
GB-585551-A,ARTHUR BROOKS SPURR
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC
US-20046750-A,SHEPPARD RICHARD H
US-20046750-A,SHEPPARD RICHARD H
US-201715634192-A,MARTIN CHARLES H
US-201715634192-A,MARTIN DOMINIC R
US-201715634192-A,MARTIN CHARLES H
US-201715634192-A,MARTIN DOMINIC R
US-201715634192-A,MARTIN CHARLES H
US-201715634192-A,MARTIN DOMINIC R
US-5637735-A,CAMPBELL CLARENCE L
US-5637735-A,CAMPBELL CLARENCE L
AU-7115874-A,NEW ZEALAND INVENTIONS DEV
GB-1095134-A,WILLIAM HENRY HONY FROST
GB-1095134-A,WILLIAM HENRY HONY FROST
HU-E16197432-A,WALLNER KLAUS
DE-102010019819-A,LEMKEN GMBH & CO KG
US-202217990129-A,CNH IND AMERICA LLC
US-202217990129-A,CNH IND AMERICA LLC
US-202217990129-A,CNH IND AMERICA LLC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
US-51933174-A,CARLUCCI JAMES J
US-51933174-A,CARLUCCI JAMES J
US-51933174-A,CARLUCCI JAMES J
US-51933174-A,CARLUCCI JAMES J
US-77445391-A,HARRELL DANNY H
US-77445391-A,HARRELL DANNY H
KR-20000035371-A,KIM JAE KEUN
US-1901066531-A,GEORGE A KELLY PLOW COMPANY
KR-20000011273-A,KUBOTA KK
CN-201510892651-A,CHONGQING TIANJI IND CO LTD
CN-201510892651-A,CHONGQING TIANJI IND CO LTD
AT-720679-A,AMAZONEN WERKE DREYER H
NL-7909063-A,DEERE & CO
KR-20010007666-A,KIM JONG JIN
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG
CN-201580056876-A,BETEK GMBH & CO KG
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG
CN-201580056876-A,BETEK GMBH & CO KG
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG
CN-201580056876-A,BETEK GMBH & CO KG
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
US-1913771943-A,SALGE HENRY F
KR-20060032729-A,SAMSUNG SDI CO LTD
KR-20060032729-A,SAMSUNG SDI CO LTD
CN-202210625064-A,WANG XUEDONG
CN-202210625064-A,WANG XUEDONG
GB-202013028-A,ARWAC LTD
GB-202013028-A,ARWAC LTD
GB-202013028-A,ARWAC LTD
CN-202111095366-A,ZHANG LIJIN
CN-202111095366-A,ZHANG LIJIN
DE-L0066972-D,HOLGER LETH
DE-L0066972-D,CHRISTEN ARNE JENSEN
NO-910950-A,EMPR IMPORT EXPORT Y DISTRIB P
CA-2945250-A,KUHN SA
CA-2945250-A,KUHN SA
EP-19182149-A,DEERE & CO
EP-19182149-A,DEERE & CO
US-71336434-A,CHOATE STOREY NORMAN
US-71336434-A,RUDOLPH HASSON PAUL
US-71336434-A,CHOATE STOREY NORMAN
US-71336434-A,RUDOLPH HASSON PAUL
US-9826126-A,WILLIAM DREFKE
US-9826126-A,WILLIAM DREFKE
US-72598847-A,WALTER ROWAN JAMES
US-72598847-A,WALTER ROWAN JAMES
US-72598847-A,WALTER ROWAN JAMES
US-72598847-A,WALTER ROWAN JAMES
CN-201710636376-A,UNIV TONGJI
CN-201710636376-A,UNIV TONGJI
KR-19960029894-A,KIM BYUNG SUB
KR-19960029894-A,KIM BYUNG SUB
KR-19970019112-U,CHO SUNG GU
AU-2016269849-A,UNIV SYDNEY
AU-2016269849-A,UNIV SYDNEY
US-38733520-A,KORSMEYER ERNEST H
US-38733520-A,KORSMEYER ERNEST H
CA-3089518-A,ELEOS ROBOTICS INC
KR-870011914-A,DAIYO TANGO CO LTD
ZA-808003-A,MCKAY RALPH LTD
ZA-808003-A,MCKAY RALPH LTD
ZA-808003-A,MCKAY RALPH LTD

2025-01-22 21:25:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:54 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:26:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:26:25 - root - INFO - The error you're encountering occurs because some of the `"filing_date"` values in the dataset are `'0'` or are not in a valid date format that can be parsed using the `'YYYYMMDD'` pattern. The `TO_DATE` function cannot convert these invalid date strings into date objects, resulting in the error.

To resolve this issue, you can modify your query to handle invalid date entries. Here are a couple of approaches:

1. **Exclude Rows with Invalid or Null Filing Dates:**

   You can filter out records where the `"filing_date"` is `'0'` or `NULL` before attempting to parse them.

   ```sql
   SELECT t."filing_date",
          DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
   LIMIT 100;
   ```

2. **Use `TRY_TO_DATE` Function to Handle Invalid Dates:**

   The `TRY_TO_DATE` function attempts to convert a string to a date but returns `NULL` if the conversion fails, instead of throwing an error. You can then filter out the `NULL` results.

   ```sql
   SELECT t."filing_date",
          DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
   LIMIT 100;
   ```

**Explanation:**

- **Issue with `'0'` Filing Dates:**

  The value `'0'` does not correspond to a valid date in the `'YYYYMMDD'` format. Attempting to parse it results in an error.

- **Filtering Invalid Dates:**

  By adding a `WHERE` clause to exclude `'0'` and `NULL` values, we ensure that only valid date strings are passed to the `TO_DATE` function.

- **Using `TRY_TO_DATE`:**

  This function safely attempts to parse the date and returns `NULL` if it fails, which prevents the query from erroring out. We then exclude the `NULL` results to work only with valid dates.

**Next Steps:**

- **Test the Modified Query:**

  Run the adjusted query to verify that it now executes without errors and returns the desired results.

- **Proceed with Data Analysis:**

  Once you have the filing years extracted correctly, you can proceed to aggregate and analyze the data as needed for your task.

**Additional Example - Extracting Filing Year for Valid Dates:**

```sql
SELECT t."application_number",
       DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
LIMIT 100;
```

This query retrieves the application numbers along with the filing years for records with valid filing dates.

---

Please let me know if you need further assistance or if you encounter any other issues.
2025-01-22 21:26:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:26:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:26:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:26:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:26:27 - snowflake.connector.connection - INFO - closed
2025-01-22 21:26:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:27:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:27:47 - root - INFO - SQL:
SELECT t."filing_date",
          DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
   LIMIT 100;
Results:
filing_date,filing_year
20080425,2008
19950404,1995
19931103,1993
19990929,1999
19910125,1991
19920416,1992
19951018,1995
19960503,1996
19920325,1992
19991210,1999
19910204,1991
19911113,1991
19920625,1992
19950531,1995
19990607,1999
19910129,1991
19910725,1991
19920701,1992
19960919,1996
19961112,1996
19990910,1999
20121119,2012
20160610,2016
20171227,2017
20190724,2019
20201229,2020
19770131,1977
19780213,1978
19801003,1980
19820512,1982
19831018,1983
19831109,1983
19890718,1989
19891102,1989
19901229,1990
19931122,1993
19980526,1998
19970520,1997
19990119,1999
19991231,1999
20011003,2001
20031104,2003
20031211,2003
20030808,2003
20070716,2007
20070917,2007
20080430,2008
20111215,2011
20120706,2012
20140702,2014
20150629,2015
20180427,2018
20201006,2020
20050406,2005
20050408,2005
20050414,2005
20080422,2008
20050415,2005
20050414,2005
20050418,2005
20050421,2005
20080430,2008
20020327,2002
20020405,2002
20050503,2005
20080516,2008
20050506,2005
20050511,2005
20080603,2008
20050519,2005
20080611,2008
20020508,2002
20080619,2008
20020510,2002
20080623,2008
20050609,2005
20050620,2005
20050621,2005
20061212,2006
20020530,2002
20050729,2005
20020605,2002
20020604,2002
20080702,2008
20080702,2008
20050629,2005
20050708,2005
20010214,2001
20080730,2008
20050721,2005
20050722,2005
20080806,2008
20020703,2002
20020703,2002
20020702,2002
20050726,2005
20050728,2005
20080814,2008
20050729,2005
20050801,2005

2025-01-22 21:27:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:27:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:27:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:27:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-22 21:27:49 - snowflake.connector.connection - INFO - closed
2025-01-22 21:27:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:27:49 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
LATERAL FLATTEN(INPUT => t."cpc") f2,
LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value::STRING ILIKE '%A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100
Results:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
SAMSUNG SDI CO LTD,1
WILLIAM HENRY HONY FROST,1
SJOEHOLMS MEKANISKA AB,1
ELEOS ROBOTICS INC,1
WALLNER KLAUS,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
TRECKER FRANCIS J,1
GUERBET FRANCOIS,1
TEXAS INDUSTRIES INC,1
SHEPPARD RICHARD H,1
CAMPBELL CLARENCE L,1
LEINFELDER DIPL-LANDW HERMANN,1
CHOATE STOREY NORMAN,1
KORSMEYER ERNEST H,1
ARTHUR BROOKS SPURR,1
PREC PLANTING LLC,1
GERBER HUBERT,1
WANG XUEDONG,1
INT HARVESTER GREAT BRITAIN,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
SOUTHERN PLOW COMPANY,1
Liu Yueshang,1
TWOSE OF TIVERTON LTD,1
MARTIN CHARLES H,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
GLASIER HAROLD H,1
ZHANG LIJIN,1
SIGFRID ANDERSON ANDERS,1
WILLIAM DREFKE,1
KIM JONG JIN,1
SALGE HENRY F,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
LIM HEON HO,1
HOLGER LETH,1
CHONGQING TIANJI IND CO LTD,1
BULLS CO LTD,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
CHO SUNG GU,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHRISTEN ARNE JENSEN,1
UNIV JIANGSU,1
OTULAK PRZEMYSLAW PRO CNC,1
UNIV TONGJI,1
PATENT CONCERN NV,1
EDWARDS JOHN W,1
EDMOND HEE,1
RUDOLPH HASSON PAUL,1
MCKAY RALPH LTD,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
LG ELECTRONICS INC,1
LEMKEN GMBH & CO KG,1
DAIYO TANGO CO LTD,1
BOTVID SETTERGREN ANDERS GOSTA,1
SAMSUNG KWANGJU ELECTRONICS CO,1
GEORGE A KELLY PLOW COMPANY,1
KUBOTA KK,1
FISHER VAN E,1
HARRELL DANNY H,1
UNIV HEILONGJIANG SCI & TECH,1
HUBER FRANZ FERDINAND,1
ALLEN SAMUEL L,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
AGSOILWORKS TECH COMPANY LLC,1
WALTER ROWAN JAMES,1
UNIV CHUNG ANG IND,1
MARTIN DOMINIC R,1
AUGUST SETTERGREN OTTO GORAN,1
GERBER MAURICE,1
QUINSTAR CORP,1
DAEHO FARMING MACHINERY CO LTD,1
CHRISTOPHER H R WOODWARD,1
RICHARD CO,1
CNH IND AMERICA LLC,1
LEIJENAAR SYTZE,1
UNIV SYDNEY,1
BETEK GMBH & CO KG,1
JIM ALEX SMITH,1
NEW ZEALAND INVENTIONS DEV,1
KIM BYUNG SUB,1
SAPHIR MASCHB GMBH,1
KIM JAE KEUN,1
KUHN SA,1

2025-01-22 21:27:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:27:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:27:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:27:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-22 21:27:51 - snowflake.connector.connection - INFO - closed
2025-01-22 21:27:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:28:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:28:44 - root - INFO - ```sql
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100;
```
2025-01-22 21:28:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:28:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:28:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:28:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-22 21:28:45 - snowflake.connector.connection - INFO - closed
2025-01-22 21:28:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:30:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:30:11 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100;
Results:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
SAMSUNG SDI CO LTD,1
BOTVID SETTERGREN ANDERS GOSTA,1
KUBOTA KK,1
GERBER HUBERT,1
MARTIN DOMINIC R,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
KUHN SA,1
WANG XUEDONG,1
SAMSUNG KWANGJU ELECTRONICS CO,1
FISHER VAN E,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHONGQING TIANJI IND CO LTD,1
GEORGE A KELLY PLOW COMPANY,1
WALTER ROWAN JAMES,1
UNIV CHUNG ANG IND,1
AUGUST SETTERGREN OTTO GORAN,1
MARTIN CHARLES H,1
QUINSTAR CORP,1
SOUTHERN PLOW COMPANY,1
DAEHO FARMING MACHINERY CO LTD,1
ZHANG LIJIN,1
JIM ALEX SMITH,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
ELEOS ROBOTICS INC,1
WALLNER KLAUS,1
SJOEHOLMS MEKANISKA AB,1
CHO SUNG GU,1
ALLEN SAMUEL L,1
CHRISTEN ARNE JENSEN,1
NEW ZEALAND INVENTIONS DEV,1
LG ELECTRONICS INC,1
BULLS CO LTD,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
INT HARVESTER GREAT BRITAIN,1
TWOSE OF TIVERTON LTD,1
WILLIAM DREFKE,1
RICHARD CO,1
RUDOLPH HASSON PAUL,1
ARTHUR BROOKS SPURR,1
LEINFELDER DIPL-LANDW HERMANN,1
CAMPBELL CLARENCE L,1
CHOATE STOREY NORMAN,1
KORSMEYER ERNEST H,1
GERBER MAURICE,1
EDWARDS JOHN W,1
EDMOND HEE,1
KIM JONG JIN,1
SALGE HENRY F,1
CHRISTOPHER H R WOODWARD,1
Liu Yueshang,1
SAPHIR MASCHB GMBH,1
KIM BYUNG SUB,1
SIGFRID ANDERSON ANDERS,1
LEIJENAAR SYTZE,1
CNH IND AMERICA LLC,1
TEXAS INDUSTRIES INC,1
UNIV JIANGSU,1
GUERBET FRANCOIS,1
HARRELL DANNY H,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
AGSOILWORKS TECH COMPANY LLC,1
LIM HEON HO,1
PREC PLANTING LLC,1
GLASIER HAROLD H,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
UNIV TONGJI,1
PATENT CONCERN NV,1
OTULAK PRZEMYSLAW PRO CNC,1
SHEPPARD RICHARD H,1
UNIV HEILONGJIANG SCI & TECH,1
HUBER FRANZ FERDINAND,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
BETEK GMBH & CO KG,1
UNIV SYDNEY,1
HOLGER LETH,1
WILLIAM HENRY HONY FROST,1
DAIYO TANGO CO LTD,1
LEMKEN GMBH & CO KG,1
TRECKER FRANCIS J,1
KIM JAE KEUN,1

2025-01-22 21:30:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:30:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:30:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:30:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-22 21:30:13 - snowflake.connector.connection - INFO - closed
2025-01-22 21:30:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:30:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:30:37 - root - INFO - ```sql
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value::STRING ILIKE '%A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100;
```
2025-01-22 21:30:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:30:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:30:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:30:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-22 21:30:39 - snowflake.connector.connection - INFO - closed
2025-01-22 21:30:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:31:33 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value::STRING ILIKE '%A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100;
Results:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
PREC PLANTING LLC,1
BOTVID SETTERGREN ANDERS GOSTA,1
SAMSUNG SDI CO LTD,1
CHONGQING TIANJI IND CO LTD,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
KIM JAE KEUN,1
TRECKER FRANCIS J,1
ZHANG LIJIN,1
UNIV CHUNG ANG IND,1
RUDOLPH HASSON PAUL,1
DAIYO TANGO CO LTD,1
SAMSUNG KWANGJU ELECTRONICS CO,1
GUERBET FRANCOIS,1
SHEPPARD RICHARD H,1
WILLIAM HENRY HONY FROST,1
SJOEHOLMS MEKANISKA AB,1
WALLNER KLAUS,1
ELEOS ROBOTICS INC,1
HUBER FRANZ FERDINAND,1
UNIV HEILONGJIANG SCI & TECH,1
SIGFRID ANDERSON ANDERS,1
LEMKEN GMBH & CO KG,1
KIM BYUNG SUB,1
AUGUST SETTERGREN OTTO GORAN,1
SAPHIR MASCHB GMBH,1
Liu Yueshang,1
GLASIER HAROLD H,1
CHO SUNG GU,1
CHRISTEN ARNE JENSEN,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
GERBER HUBERT,1
WANG XUEDONG,1
HARRELL DANNY H,1
UNIV SYDNEY,1
QUINSTAR CORP,1
DAEHO FARMING MACHINERY CO LTD,1
EDWARDS JOHN W,1
EDMOND HEE,1
RICHARD CO,1
GERBER MAURICE,1
CHOATE STOREY NORMAN,1
KORSMEYER ERNEST H,1
CAMPBELL CLARENCE L,1
ARTHUR BROOKS SPURR,1
LEINFELDER DIPL-LANDW HERMANN,1
SOUTHERN PLOW COMPANY,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
FISHER VAN E,1
KUBOTA KK,1
TEXAS INDUSTRIES INC,1
BULLS CO LTD,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
INT HARVESTER GREAT BRITAIN,1
TWOSE OF TIVERTON LTD,1
NEW ZEALAND INVENTIONS DEV,1
UNIV TONGJI,1
KIM JONG JIN,1
SALGE HENRY F,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
GEORGE A KELLY PLOW COMPANY,1
UNIV JIANGSU,1
CNH IND AMERICA LLC,1
LEIJENAAR SYTZE,1
LIM HEON HO,1
HOLGER LETH,1
CHRISTOPHER H R WOODWARD,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
ALLEN SAMUEL L,1
AGSOILWORKS TECH COMPANY LLC,1
WILLIAM DREFKE,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
BETEK GMBH & CO KG,1
OTULAK PRZEMYSLAW PRO CNC,1
MARTIN CHARLES H,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
PATENT CONCERN NV,1
LG ELECTRONICS INC,1
WALTER ROWAN JAMES,1
JIM ALEX SMITH,1
KUHN SA,1
MARTIN DOMINIC R,1

2025-01-22 21:31:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:31:35 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:35 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 3
Results:
assignee_name,total_applications
DEERE & CO,30
CNH IND AMERICA LLC,10
KUBOTA KK,8

2025-01-22 21:31:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:31:37 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:37 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "applications_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "assignee_name", "filing_year"
ORDER BY "assignee_name", "filing_year"
LIMIT 100
Results:
assignee_name,filing_year,applications_count
10691976 CANADA LTD,2019,1
AG CHEM EQUIPMENT CO,1995,1
AGCO CORP,2015,1
AGCO INT GMBH,2013,1
AGSOILWORKS TECH COMPANY LLC,2019,1
AGXEED HOLDING B V,2022,1
ALIG ENV SOLUTIONS LLC,2018,1
ALLEN SAMUEL L,1904,1
ALLIS CHALMERS,1973,1
AMAZONEN WERKE DREYER H,1972,1
AMAZONEN WERKE DREYER H,1979,2
AMAZONEN-WERKE H DREYER GMBH & CO KG,2015,1
ANDERSON HENNING G,1911,1
ANDREW MANSON LAU,2007,1
ARTHUR BROOKS SPURR,1951,1
ARWAC LTD,2020,1
AUGUST SETTERGREN OTTO GORAN,1948,1
AUTONOMOUS SOLUTIONS INC,2017,1
B F AVERY AND SONS,1919,1
BAILLARGEON RODRIGUE,1996,1
BASF AGRO TRADEMARKS GMBH,2017,1
BASF AGRO TRADEMARKS GMBH,2020,1
BAUR HERMANN,1978,1
BENNETT DAVID A,1953,1
BENNETT ROY E,1953,1
BERGER F & C,1994,1
BETEK GMBH & CO KG,2015,1
BINZHOU INST OF AGRICULTURAL MECH SCIENCES,2018,1
BLUE RIVER TECH INC,2021,1
BONATTO DALCHIOR ANTONIO,2015,1
BOSCH GMBH ROBERT,2019,1
BOTVID SETTERGREN ANDERS GOSTA,1948,1
BROWN TRACTORS LTD,1965,1
BUDD CO,1947,1
BULLS CO LTD,2012,1
BUSATIS GEB,1956,1
CAMPBELL CLARENCE L,1935,1
CARLUCCI JAMES J,1974,1
CCTEG BEIJING LAND CONSOLIDATION AND ECOLOGICAL RESTORATION TECH RESEARCH INSTITUTE CO LTD,2021,1
CCTEG ECOLOGICAL ENVIRONMENTAL TECH CO LTD,2021,1
CHENGDU RUOCHU AGRICULTURAL CO LTD,2018,1
CHINA NAT RICE RES INST,2022,1
CHINA NAT SALT INDUSTRY CORPORATION SALT GEOLOGICAL EXPLORATION BRIGADE,2019,1
CHIOCCO GREGORY D,2010,1
CHO SUNG GU,1997,1
CHOATE STOREY NORMAN,1934,1
CHONGQING TIANJI IND CO LTD,2015,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,1
CHRISTEN ARNE JENSEN,1926,1
CHRISTOPHER H R WOODWARD,1918,1
CHULLANAM DO,2002,1
CLAAS E SYSTEMS GMBH,2021,1
CLAAS SAULGAU GMBH,1999,2
CLAAS SAULGAU GMBH,2013,1
CLAAS SAULGAU GMBH,2014,1
CLAAS SAULGAU GMBH,2023,1
CLAAS SELBSTFAHRENDE ERNTEMASCHINEN GMBH,2021,1
CLARK PAUL G,2009,1
CLAUSSEN MARTIN,1913,1
CLIMATE CORP,2013,1
CLIMATE CORP,2016,1
CLIMATE CORP,2017,1
CLIMATE CORP,2018,1
CLIMATE CORP,2021,1
CNH AMERICA LLC,2007,1
CNH AMERICA LLC,2008,1
CNH AMERICA LLC,2013,1
CNH CANADA LTD,2013,1
CNH CHINA MAN CO LTD,2019,1
CNH IND AMERICA LLC,2013,1
CNH IND AMERICA LLC,2016,2
CNH IND AMERICA LLC,2017,2
CNH IND AMERICA LLC,2019,2
CNH IND AMERICA LLC,2020,1
CNH IND AMERICA LLC,2021,1
CNH IND AMERICA LLC,2022,1
CNH IND BELGIUM NV,2016,1
CNH IND BELGIUM NV,2019,1
CNH IND CANADA LTD,2013,1
CNH UK LTD,2000,1
COLUMBUS IRON WORKS COMPANY,1953,1
CRAMER KUPPLUNG GMBH & CO KG,1999,1
CREYKE CHARLES HENRY,1997,1
CUI JIAN,2020,1
DA ROS GREEN S R L,2021,1
DAEDONG IND CO LTD,2014,1
DAEHO FARMING MACHINERY CO LTD,2000,1
DAIYO TANGO CO LTD,1987,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2018,1
DANCEL IVAN TUMBOCON,2006,1
DAYSTROM INC,1962,1
DEERE & CO,1940,1
DEERE & CO,1945,1
DEERE & CO,1964,1
DEERE & CO,1979,2
DEERE & CO,1983,1
DEERE & CO,1985,1
DEERE & CO,1992,1
DEERE & CO,1993,1
DEERE & CO,2002,2

2025-01-22 21:31:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:31:39 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:39 - root - INFO - SQL:
SELECT DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       t."country_code",
       COUNT(DISTINCT t."application_number") AS "applications_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year", t."country_code"
ORDER BY "filing_year", "applications_count" DESC
LIMIT 100
Results:
filing_year,country_code,applications_count
1901,US,2
1902,US,1
1902,FR,1
1904,US,1
1905,US,1
1906,US,1
1908,US,1
1911,US,3
1912,US,1
1913,US,4
1916,US,1
1917,GB,1
1918,US,1
1918,FR,1
1918,DE,1
1919,US,1
1920,US,1
1922,US,1
1925,US,1
1926,DE,1
1926,US,1
1926,FR,1
1927,US,1
1931,US,1
1933,US,1
1934,US,2
1934,GB,1
1935,US,1
1936,US,1
1939,CH,1
1940,US,1
1941,US,4
1942,US,1
1944,US,2
1945,US,1
1947,US,3
1948,US,1
1948,SE,1
1949,US,1
1949,GB,1
1950,US,2
1950,DE,1
1951,GB,1
1951,US,1
1951,DE,1
1951,FR,1
1953,US,2
1954,DE,1
1954,US,1
1955,DE,1
1955,GB,1
1955,US,1
1956,GB,1
1956,FR,1
1957,FR,2
1959,DE,1
1959,FR,1
1960,US,2
1960,CH,1
1961,US,1
1962,DE,2
1962,GB,2
1962,FR,1
1964,DE,1
1964,GB,1
1965,FR,1
1965,DK,1
1966,US,1
1966,AT,1
1966,CH,1
1967,YU,1
1967,DE,1
1969,SE,1
1969,BE,1
1969,US,1
1970,BR,1
1972,FR,1
1972,US,1
1973,CA,2
1973,TR,1
1973,GB,1
1974,AU,3
1974,US,2
1974,NL,1
1975,FR,1
1975,AU,1
1975,BE,1
1975,NL,1
1976,AU,2
1976,IE,1
1976,US,1
1976,IT,1
1977,HU,1
1977,AU,1
1978,BE,1
1978,ZA,1
1978,CH,1
1978,JP,1
1978,AT,1
1979,GB,1

2025-01-22 21:31:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:31:41 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:41 - root - INFO - SQL:
SELECT DISTINCT f1.value:"name"::STRING AS "assignee_name", t."country_code"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
LIMIT 100
Results:
assignee_name,country_code
DOBSON DAVID A,CA
WILLIAM DREFKE,US
ZHANG QINGHUA,CN
DEERE & CO,CN
AG CHEM EQUIPMENT CO,US
UNIV TSINGHUA,CN
CLIMATE CORP,EP
CNH IND BELGIUM NV,WO
DEERE & CO,CA
PREC PLANTING LLC,CA
CHINA NAT RICE RES INST,CN
WEBBER CHARLES E,US
IDOUGH INVEST COMPANY,US
BOTVID SETTERGREN ANDERS GOSTA,US
HUBER FRANZ FERDINAND,DE
UNIV NORTHWESTERN,CN
KUBOTA KK,CN
RUDOLPH HASSON PAUL,US
WALTER ROWAN JAMES,US
WHITE CITY TEACHING UNIV,CN
SAMSUNG KWANGJU ELECTRONICS CO,CN
SAMSUNG SDI CO LTD,KR
FAEHSE & CO H,AT
PARK HYUNG GYU,KR
FLEXI COIL LTD,CA
UNIV TONGJI,CN
SJOEHOLMS MEKANISKA AB,NO
QINGDAO GUANZHONG ECOLOGY CO LTD,CN
SAPHIR MASCHB GMBH,EP
GEORGSCHWEIGER,IE
CHIOCCO GREGORY D,US
SLOOTSMID B V,NL
LIND B D C,AU
LS MTRON LTD,KR
WALTERSCHEID GMBH JEAN,NL
GERBER HUBERT,FR
KUBOTA KK,US
XINGGUANG AGRICULTURAL MACHINERY CO LTD,CN
CHRISTOPHER H R WOODWARD,US
COLUMBUS IRON WORKS COMPANY,US
KIM BYUNG SUB,KR
HARVEST INT INC,US
UNIV CHUNG ANG IND,KR
KNELS KENNETH JOHN,AU
GEORGE A KELLY PLOW COMPANY,US
LELY ENTPR AG,NL
SHANDONG INST POMOLOGY,CN
QINGDAO ACAD AGRICULTURAL SCIENCES,CN
NORVELL KARL A,US
DEERE & CO,AU
HILL JAMES B,US
JOHN HODGKINSON,GB
LIANYUNGANG ACAD AGRICULTURAL SCIENCES,CN
OLIVER CORP,US
FISHER VAN E,US
WABCO GMBH,US
UNIV IOWA STATE RES FOUND INC,BR
SEEDMASTER MFG LTD,BR
GLASIER HAROLD H,US
UNIV SYDNEY,AU
LEINFELDER DIPL-LANDW HERMANN,DE
BOSCH GMBH ROBERT,DE
BASF AGRO TRADEMARKS GMBH,CA
JOSEPH BAPTISTE ALFRED CHAPRON,GB
YANG YE,CN
VASSY AINE,FR
DEL MORINO SRL,IT
HENRIOD FRERES S A R L,CH
CLAAS SAULGAU GMBH,AT
DEERE & CO,US
SWINDALL SAMUEL L,US
BENNETT DAVID A,US
XIAMEN HAICHENG CONSTRUCTION ENG CO LTD,CN
WEIMAR KOMBINAT VEB,HU
UNIV CENTRAL SOUTH FORESTRY & TECHNOLOGY,CN
EMPR IMPORT EXPORT Y DISTRIB P,NO
UNIV DALIAN,CN
AGXEED HOLDING B V,WO
MAX BURG,GB
INT HARVESTER GREAT BRITAIN,GB
DAEDONG IND CO LTD,KR
FED GOSUDARSTVENNOE BJUDZHETNOE NAUCHNOE UCHREZHDENIE NAUCHNO-ISSLEDOVATELSKIJ INST SELSKOGO KHOZJAJ,RU
SHOTBOLT ENGINEERING LIMITED,GB
BERGER F & C,AT
WANG XUEDONG,CN
GUERBET FRANCOIS,CA
MCCORMICK PATRICK,GB
NAUD EXPL CHARRUES,AU
WATT ALLAN,US
KRONE BERNARD MASCHF GMBH,DE
MOMENTUS GOLF INC,US
GUYOT FONDEUR ET UNION CHARRUE,BR
MASSEY FERGUSON INC,YU
BASF AGRO TRADEMARKS GMBH,US
WANG YAN,AU
FORD MOTOR CO,JP
NINGXIA LYVFENGYUAN AGRICULTURAL TECH CO LTD,CN
OTICO,CA
TOPCON POSITIONING SYSTEMS INC,US
CHOATE STOREY NORMAN,US

2025-01-22 21:31:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:31:43 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:43 - root - INFO - SQL:
SELECT DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "total_applications" DESC
LIMIT 100
Results:
filing_year,total_applications
2018,36
2017,34
2019,28
2021,21
2022,20
2016,18
2020,18
2013,15
2015,14
2004,8
2008,7
1996,7
1999,7
2010,6
1985,6
2002,6
2014,6
1974,6
1962,5
2006,5
1993,5
1978,5
2012,5
2000,5
1976,5
1981,5
1973,4
1998,4
1997,4
1951,4
1913,4
2023,4
2003,4
1995,4
1979,4
1941,4
1975,4
1950,3
1987,3
1911,3
2001,3
1926,3
2009,3
1966,3
1992,3
1947,3
1934,3
1983,3
1918,3
2005,3
2007,3
1955,3
1969,3
1960,3
1902,2
1944,2
1964,2
1980,2
1954,2
1956,2
1984,2
1967,2
1948,2
1901,2
1957,2
1986,2
1953,2
1977,2
1989,2
1972,2
1991,2
1982,2
1994,2
1959,2
1965,2
1949,2
1925,1
1912,1
1906,1
1940,1
1945,1
1908,1
1935,1
1922,1
1939,1
1920,1
1919,1
1916,1
1905,1
1933,1
1990,1
1904,1
1936,1
1931,1
1942,1
1927,1
1970,1
1917,1
1961,1
2011,1

2025-01-22 21:31:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 34
2025-01-22 21:31:45 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:45 - root - INFO - SQL:
SELECT t."country_code",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
GROUP BY t."country_code"
ORDER BY "total_applications" DESC
LIMIT 100
Results:
country_code,total_applications
US,158
CN,87
KR,37
DE,36
CA,31
AU,19
GB,18
FR,17
EP,15
JP,11
WO,11
NL,10
BR,9
BE,8
RU,8
AT,8
IT,7
CH,5
NO,4
SE,4
HU,4
ZA,3
PL,2
MY,1
PE,1
YU,1
NZ,1
AR,1
IL,1
GR,1
IE,1
ES,1
DK,1
TR,1

2025-01-22 21:31:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:31:46 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:47 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       t."country_code",
       COUNT(DISTINCT t."application_number") AS "applications_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
GROUP BY "assignee_name", t."country_code"
ORDER BY "assignee_name", "applications_count" DESC
LIMIT 100
Results:
assignee_name,country_code,applications_count
10691976 CANADA LTD,WO,1
AG CHEM EQUIPMENT CO,US,1
AGCO CORP,US,1
AGCO INT GMBH,EP,1
AGSOILWORKS TECH COMPANY LLC,IL,1
AGXEED HOLDING B V,WO,1
ALIG ENV SOLUTIONS LLC,WO,1
ALLEN SAMUEL L,US,1
ALLIS CHALMERS,CA,1
AMAZONEN WERKE DREYER H,FR,1
AMAZONEN WERKE DREYER H,GB,1
AMAZONEN WERKE DREYER H,AT,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,CN,1
ANDERSON HENNING G,US,1
ANDREW MANSON LAU,NZ,1
ARTHUR BROOKS SPURR,GB,1
ARWAC LTD,GB,1
AUGUST SETTERGREN OTTO GORAN,US,1
AUTONOMOUS SOLUTIONS INC,CN,1
B F AVERY AND SONS,US,1
BAILLARGEON RODRIGUE,CA,1
BASF AGRO TRADEMARKS GMBH,CA,1
BASF AGRO TRADEMARKS GMBH,US,1
BAUR HERMANN,CH,1
BENNETT DAVID A,US,1
BENNETT ROY E,US,1
BERGER F & C,AT,1
BETEK GMBH & CO KG,CN,1
BINZHOU INST OF AGRICULTURAL MECH SCIENCES,CN,1
BLUE RIVER TECH INC,US,1
BONATTO DALCHIOR ANTONIO,BR,1
BOSCH GMBH ROBERT,DE,1
BOTVID SETTERGREN ANDERS GOSTA,US,1
BROWN TRACTORS LTD,DK,1
BUDD CO,US,1
BULLS CO LTD,KR,1
BUSATIS GEB,FR,1
CAMPBELL CLARENCE L,US,1
CARLUCCI JAMES J,US,1
CCTEG BEIJING LAND CONSOLIDATION AND ECOLOGICAL RESTORATION TECH RESEARCH INSTITUTE CO LTD,CN,1
CCTEG ECOLOGICAL ENVIRONMENTAL TECH CO LTD,CN,1
CHENGDU RUOCHU AGRICULTURAL CO LTD,CN,1
CHINA NAT RICE RES INST,CN,1
CHINA NAT SALT INDUSTRY CORPORATION SALT GEOLOGICAL EXPLORATION BRIGADE,CN,1
CHIOCCO GREGORY D,US,1
CHO SUNG GU,KR,1
CHOATE STOREY NORMAN,US,1
CHONGQING TIANJI IND CO LTD,CN,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,CN,1
CHRISTEN ARNE JENSEN,DE,1
CHRISTOPHER H R WOODWARD,US,1
CHULLANAM DO,KR,1
CLAAS E SYSTEMS GMBH,DE,1
CLAAS SAULGAU GMBH,EP,2
CLAAS SAULGAU GMBH,DE,2
CLAAS SAULGAU GMBH,AT,1
CLAAS SELBSTFAHRENDE ERNTEMASCHINEN GMBH,US,1
CLARK PAUL G,GB,1
CLAUSSEN MARTIN,US,1
CLIMATE CORP,CA,2
CLIMATE CORP,US,2
CLIMATE CORP,EP,1
CNH AMERICA LLC,US,2
CNH AMERICA LLC,CA,1
CNH CANADA LTD,US,1
CNH CHINA MAN CO LTD,WO,1
CNH IND AMERICA LLC,US,6
CNH IND AMERICA LLC,CA,2
CNH IND AMERICA LLC,CN,1
CNH IND AMERICA LLC,WO,1
CNH IND BELGIUM NV,WO,1
CNH IND BELGIUM NV,BE,1
CNH IND CANADA LTD,US,1
CNH UK LTD,EP,1
COLUMBUS IRON WORKS COMPANY,US,1
CRAMER KUPPLUNG GMBH & CO KG,DE,1
CREYKE CHARLES HENRY,GR,1
CUI JIAN,CN,1
DA ROS GREEN S R L,EP,1
DAEDONG IND CO LTD,KR,1
DAEHO FARMING MACHINERY CO LTD,KR,1
DAIYO TANGO CO LTD,KR,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,CN,1
DANCEL IVAN TUMBOCON,US,1
DAYSTROM INC,DE,1
DEERE & CO,US,6
DEERE & CO,CA,6
DEERE & CO,DE,5
DEERE & CO,EP,3
DEERE & CO,BR,3
DEERE & CO,AU,2
DEERE & CO,CN,2
DEERE & CO,ZA,1
DEERE & CO,FR,1
DEERE & CO,NL,1
DEGELMAN IND,CA,1
DEL MORINO SRL,IT,1
DIETRICH MFG INC,US,1
DMC CO LTD,KR,1
DO AMARAL ASSY JOSE ROBERTO,US,1

2025-01-22 21:31:47 - root - INFO - itercount: 0
2025-01-22 21:31:47 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `"PATENTS"."PATENTS"."PUBLICATIONS"`

**Columns and Potential Usage:**

1. **"assignee_harmonized"**: Contains information about assignee names in a VARIANT (JSON) format. *Potential usage*: Extract assignee names to identify and count applications per assignee.

2. **"cpc"**: Contains CPC classification codes in VARIANT format. *Potential usage*: Filter patents belonging to class "A01B3".

3. **"application_number"**: Unique identifier for each application. *Potential usage*: Count the total number of applications.

4. **"filing_date"**: Date when the patent application was filed, stored as a NUMBER (likely in 'YYYYMMDD' format). *Potential usage*: Extract the year to analyze applications by year.

5. **"country_code"**: Country code of the patent application. *Potential usage*: Determine the country with the most applications for a given assignee and year.

6. **"publication_date"**: Date when the patent was published. *Potential usage*: Alternate source to extract the year of publication.

**Conditions that May Be Used:**

- **Filter by CPC Code**: Use `ILIKE '%A01B3%'` on the "cpc" column to select patents in class "A01B3".
- **Extract Assignee Names**: Use JSON functions to parse "assignee_harmonized" and extract the "name" field.
- **Extract Year from Date**: Convert "filing_date" to a date format and extract the year.
- **Group and Aggregate Data**: Group by "assignee_name", "filing_year", or "country_code" to perform counts.

---

**SQL Queries:**

1. **Select distinct CPC codes to understand CPC data format:**

   ```sql
   SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f
   LIMIT 100;
   ```

2. **Retrieve application numbers for patents in class "A01B3":**

   ```sql
   SELECT t."application_number"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f
   WHERE f.value::STRING ILIKE '%A01B3%'
   LIMIT 100;
   ```

3. **Extract assignee names from "assignee_harmonized":**

   ```sql
   SELECT f.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f
   LIMIT 100;
   ```

4. **List application numbers and assignee names for class "A01B3":**

   ```sql
   SELECT t."application_number", f1.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f2,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
   WHERE f2.value::STRING ILIKE '%A01B3%'
   LIMIT 100;
   ```

5. **Extract filing year from "filing_date":**

   ```sql
   SELECT t."filing_date", DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
   ```

6. **Count total applications per assignee in class "A01B3":**

   ```sql
   SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "total_applications"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f2,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
   WHERE f2.value::STRING ILIKE '%A01B3%'
   GROUP BY "assignee_name"
   ORDER BY "total_applications" DESC
   LIMIT 100;
   ```

7. **Find the year with the most applications for a specific assignee:**

   ```sql
   SELECT DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."application_number") AS "applications_count"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1,
   LATERAL FLATTEN(INPUT => t."cpc") f2
   WHERE f1.value:"name"::STRING = 'Assignee Name'
     AND f2.value::STRING ILIKE '%A01B3%'
   GROUP BY "filing_year"
   ORDER BY "applications_count" DESC
   LIMIT 100;
   ```

8. **Determine the country with the most applications for an assignee in a specific year:**

   ```sql
   SELECT t."country_code", COUNT(DISTINCT t."application_number") AS "applications_count"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1,
   LATERAL FLATTEN(INPUT => t."cpc") f2
   WHERE f1.value:"name"::STRING = 'Assignee Name'
     AND DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) = 2021
     AND f2.value::STRING ILIKE '%A01B3%'
   GROUP BY t."country_code"
   ORDER BY "applications_count" DESC
   LIMIT 100;
   ```

9. **List top 3 assignees based on total applications in class "A01B3":**

   ```sql
   SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "total_applications"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f2,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
   WHERE f2.value::STRING ILIKE '%A01B3%'
   GROUP BY "assignee_name"
   ORDER BY "total_applications" DESC
   LIMIT 3;
   ```

10. **Count applications per year for each assignee in class "A01B3":**

    ```sql
    SELECT f1.value:"name"::STRING AS "assignee_name", DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(INPUT => t."cpc") f2,
    LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE f2.value::STRING ILIKE '%A01B3%'
    GROUP BY "assignee_name", "filing_year"
    ORDER BY "assignee_name", "filing_year"
    LIMIT 100;
    ```

11. **Identify the country with the most applications per year in class "A01B3":**

    ```sql
    SELECT DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", t."country_code", COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(INPUT => t."cpc") f
    WHERE f.value::STRING ILIKE '%A01B3%'
    GROUP BY "filing_year", t."country_code"
    ORDER BY "filing_year", "applications_count" DESC
    LIMIT 100;
    ```

12. **Fetch assignee names and corresponding country codes for class "A01B3":**

    ```sql
    SELECT DISTINCT f1.value:"name"::STRING AS "assignee_name", t."country_code"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(INPUT => t."cpc") f2,
    LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE f2.value::STRING ILIKE '%A01B3%'
    LIMIT 100;
    ```

13. **Determine the overall years with the most applications in class "A01B3":**

    ```sql
    SELECT DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(INPUT => t."cpc") f
    WHERE f.value::STRING ILIKE '%A01B3%'
    GROUP BY "filing_year"
    ORDER BY "total_applications" DESC
    LIMIT 100;
    ```

14. **Find the most common country codes for applications in class "A01B3":**

    ```sql
    SELECT t."country_code", COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(INPUT => t."cpc") f
    WHERE f.value::STRING ILIKE '%A01B3%'
    GROUP BY t."country_code"
    ORDER BY "total_applications" DESC
    LIMIT 100;
    ```

15. **List assignees along with the number of applications per country code in class "A01B3":**

    ```sql
    SELECT f1.value:"name"::STRING AS "assignee_name", t."country_code", COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(INPUT => t."cpc") f2,
    LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE f2.value::STRING ILIKE '%A01B3%'
    GROUP BY "assignee_name", t."country_code"
    ORDER BY "assignee_name", "applications_count" DESC
    LIMIT 100;
    ```

These queries help in exploring the relevant data needed for analyzing the top assignees in patent class "A01B3". By executing these queries, we can understand how the data is structured and retrieve the necessary information for further analysis.Query:
SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f
   LIMIT 100;
Answer:
Too long, hard cut:
cpc_code
"{""code"":""B29K2021/00"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03C7/3212"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D17/4012"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04Q1/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""E04B1/803"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G01N33/726"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C21B2100/22"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C08F8/42"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H03F2200/451"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H04L49/1515"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D04H1/54"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B32B27/325"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A46B1/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C12N5/0068"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61F9/027"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G03F7/2008"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G06F3/0638"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/6876"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C02F3/341"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F02K9/86"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06F9/45558"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L29/66136"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06V20/49"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04L9/3247"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65B65/08"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H10K71/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G01N2223/401"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03B15/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G03F7/70883"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B44B7/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C12P7/46"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65H15/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G11B2007/2432"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""E02D27/42"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L21/0242"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/04"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C04B2235/663"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01L21/78"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/3441"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01L24/97"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B23B2228/10"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H05K1/0284"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01F41/046"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G02B6/3526"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L2224/32225"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""D06F37/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D06F37/265"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04W72/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D307/33"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/150984"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2013/8497"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2005/3128"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""D06M14/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/744"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M16/024"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C09D11/54"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G09G2320/0257"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02F1/133528"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02B6/428"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01S13/765"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G01C21/3469"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01V5/0025"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07K14/7155"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/0406"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01F41/063"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E21B17/01""
Query:
SELECT t."application_number"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f
   WHERE f.value::STRING ILIKE '%A01B3%'
   LIMIT 100;
Answer:
application_number
US-1904197554-A
US-50994255-A
US-50994255-A
US-52103631-A
US-52103631-A
US-501724D-A
US-20046750-A
US-20046750-A
US-220177D-A
US-5528360-A
US-5528360-A
US-6966360-A
US-6966360-A
US-5637735-A
US-5637735-A
AU-7115874-A
GB-1095134-A
GB-1095134-A
GB-585551-A
IL-26862419-A
IL-26862419-A
BE-192096-A
BE-192096-A
BE-192096-A
KR-20180111810-A
KR-20180111810-A
US-130700D-A
FR-960102D-A
FR-960102D-A
US-231385D-A
KR-20050007441-U
AT-720679-A
BE-727862D-A
FR-0901549-A
KR-20000035371-A
BE-154048-A
BE-154048-A
US-530054D-A
US-25445318-A
US-25445318-A
US-290366D-A
EP-17737210-A
EP-17737210-A
DE-102017102683-A
KR-20000009753-U
US-51933174-A
US-51933174-A
US-51933174-A
US-51933174-A
KR-20180002946-U
US-1901066531-A
FR-508965D-A
FR-508965D-A
US-77255596-A
US-77255596-A
CN-201810758930-A
CN-201810758930-A
PL-44042622-A
PL-44042622-A
PL-44042622-A
PL-44042622-A
CN-202210179147-A
CN-202210179147-A
CN-202210179147-A
US-202217990129-A
US-202217990129-A
US-202217990129-A
CN-202111095366-A
CN-202111095366-A
KR-20000011273-A
CN-201580056876-A
CN-201580056876-A
CN-201580056876-A
CN-201710053605-A
KR-20120005914-A
KR-20150076822-A
CN-201510892651-A
CN-201510892651-A
CN-201811558564-A
CN-201811558564-A
KR-20110130418-A
KR-20010007666-A
AU-2016269849-A
AU-2016269849-A
CN-202210606325-A
CN-202210606325-A
NO-822521-A
DE-L0066972-D
US-72598847-A
US-72598847-A
US-72598847-A
US-72598847-A
HU-E16197432-A
KR-20130001424-U
US-71336434-A
US-71336434-A
US-1913771943-A
KR-20060032729-A
KR-20060032729-A
DE-102010019819-A
Query:
SELECT f.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f
   LIMIT 100;
Answer:
assignee_name
SKYWORKS SOLUTIONS INC
USNR LLC
KENNAMETAL INC
HONEYWELL FEDERAL MFG & TECH LLC
TROBOLOWITSCH FRIEDRICH
GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD
WERIDE CORP
ASCENSIA DIABETES CARE HOLDINGS AG
TYCO FIRE PRODUCTS LP
ELLIOTT DAVID LEAMON
IBM
WONG DAVID I KEONG
SPECTRASENSORS INC
HEWLETT PACKARD ENTPR DEV LP
TOYOTA MOTOR CO LTD
QUALCOMM INC
NXP USA INC
UNIV CALIFORNIA
TOYOTA MOTOR CO LTD
BRONNERT HERVE X
CISCO TECH INC
SKYWORKS SOLUTIONS INC
BOLB INC
BAXALTA INC
Baxalta GmbH
ATOMITE INC
RECKITT BENCKISER BRANDS LTD
MOBILE APPLIANCE INC
SCIVAX CORP
JXTG NIPPON OIL & ENERGY CORP
CHIYODA CORP
VOLPARA HEALTH TECH LIMITED
BIGBEN INTERACTIVE SA
BYD CO LTD
HEWLETT PACKARD DEVELOPMENT CO
NOON HOME INC
TOMOEGAWA CO LTD
AFI LICENSING LLC
ACETYLON PHARMACEUTICALS INC
MARTINEZ NANCY
CISCO TECH INC
NITTO DENKO CORP
COLGATE PALMOLIVE CO
FLUIDMASTER
CELLMIG BIOLABS INC
WISCONSIN ALUMNI RES FOUND
CROWDSTRIKE INC
TOYOTA ENG & MFG NORTH AMERICA
BASF SE
DELTA ELECTRONICS INC
OSCILLOSCAPE LLC
NUOVO PIGNONE TECNOLOGIE SRL
GOOGLE LLC
Infrrd Inc
CHIUN MAI COMMUNICATION SYSTEMS INC
VITRO FLAT GLASS LLC
EMC IP HOLDING CO LLC
YAMAHA MOTOR CO LTD
POWER SURVEY LLC
ELECTRONICS FOR IMAGING INC
WOERMANN BERND
UNIV BEIJING TECHNOLOGY
GOPC PTY LTD
EVONIK DEGUSSA GMBH
KS GLEITLAGER GMBH
LG ELECTRONICS INC
NICOMATIC
NIELSEN CO US LLC
CARGILL INC
EPIC TECH LLC
FUJIFILM CORP
MICRON TECHNOLOGY INC
PAX LABS INC
SENKO ADVANCED COMPONENTS INC
APPAREO SYSTEMS LLC
DETOXICATED INC
UNITED TECHNOLOGIES CORP
FUJI ELECTRIC CO LTD
PMG VENTURES INC
CUMMINS POWER GENERATION IP
SK SILTRON CO LTD
BIOSENSE WEBSTER ISRAEL LTD
R J REYNOLDS TOBACCO PRODUCTS
DGSHAPE CORP
GOOGLE LLC
ABBOTT LAB
TAIWAN SEMICONDUCTOR MFG CO LTD
SIEMENS HEALTHCARE GMBH
OREAL
SZ DJI TECHNOLOGY CO LTD
CONTEMPORARY AMPEREX TECHNOLOGY CO LTD
Baidu online network technology beijing co ltd
IBM
IBM
EBARA CORP
TORONTO DOMINION BANK
EMC IP HOLDING CO LLC
SNIPR TECH LTD
TOSHIBA KK
SAMSUNG ELECTRONICS CO LTD
Query:
SELECT t."application_number", f1.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(INPUT => t."cpc") f2,
   LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
   WHERE f2.value::STRING ILIKE '%A01B3%'
   LIMIT 100;
Answer:
application_number,assignee_name
US-50994255-A,JIM ALEX SMITH
US-50994255-A,JIM ALEX SMITH
US-52103631-A,GLASIER HAROLD H
US-52103631-A,GLASIER HAROLD H
CA-2543900-A,EDWARDS JOHN W
CA-2543900-A,EDWARDS JOHN W
US-1912673206-A,SOUTHERN PLOW COMPANY
GB-585551-A,ARTHUR BROOKS SPURR
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC
US-20046750-A,SHEPPARD RICHARD H
US-20046750-A,SHEPPARD RICHARD H
US-201715634192-A,MARTIN CHARLES H
US-201715634192-A,MARTIN DOMINIC R
US-201715634192-A,MARTIN CHARLES H
US-201715634192-A,MARTIN DOMINIC R
US-201715634192-A,MARTIN CHARLES H
US-201715634192-A,MARTIN DOMINIC R
US-5637735-A,CAMPBELL CLARENCE L
US-5637735-A,CAMPBELL CLARENCE L
AU-7115874-A,NEW ZEALAND INVENTIONS DEV
GB-1095134-A,WILLIAM HENRY HONY FROST
GB-1095134-A,WILLIAM HENRY HONY FROST
HU-E16197432-A,WALLNER KLAUS
DE-102010019819-A,LEMKEN GMBH & CO KG
US-202217990129-A,CNH IND AMERICA LLC
US-202217990129-A,CNH IND AMERICA LLC
US-202217990129-A,CNH IND AMERICA LLC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC
US-51933174-A,CARLUCCI JAMES J
US-51933174-A,CARLUCCI JAMES J
US-51933174-A,CARLUCCI JAMES J
US-51933174-A,CARLUCCI JAMES J
US-77445391-A,HARRELL DANNY H
US-77445391-A,HARRELL DANNY H
KR-20000035371-A,KIM JAE KEUN
US-1901066531-A,GEORGE A KELLY PLOW COMPANY
KR-20000011273-A,KUBOTA KK
CN-201510892651-A,CHONGQING TIANJI IND CO LTD
CN-201510892651-A,CHONGQING TIANJI IND CO LTD
AT-720679-A,AMAZONEN WERKE DREYER H
NL-7909063-A,DEERE & CO
KR-20010007666-A,KIM JONG JIN
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG
CN-201580056876-A,BETEK GMBH & CO KG
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG
CN-201580056876-A,BETEK GMBH & CO KG
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG
CN-201580056876-A,BETEK GMBH & CO KG
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
US-1913771943-A,SALGE HENRY F
KR-20060032729-A,SAMSUNG SDI CO LTD
KR-20060032729-A,SAMSUNG SDI CO LTD
CN-202210625064-A,WANG XUEDONG
CN-202210625064-A,WANG XUEDONG
GB-202013028-A,ARWAC LTD
GB-202013028-A,ARWAC LTD
GB-202013028-A,ARWAC LTD
CN-202111095366-A,ZHANG LIJIN
CN-202111095366-A,ZHANG LIJIN
DE-L0066972-D,HOLGER LETH
DE-L0066972-D,CHRISTEN ARNE JENSEN
NO-910950-A,EMPR IMPORT EXPORT Y DISTRIB P
CA-2945250-A,KUHN SA
CA-2945250-A,KUHN SA
EP-19182149-A,DEERE & CO
EP-19182149-A,DEERE & CO
US-71336434-A,CHOATE STOREY NORMAN
US-71336434-A,RUDOLPH HASSON PAUL
US-71336434-A,CHOATE STOREY NORMAN
US-71336434-A,RUDOLPH HASSON PAUL
US-9826126-A,WILLIAM DREFKE
US-9826126-A,WILLIAM DREFKE
US-72598847-A,WALTER ROWAN JAMES
US-72598847-A,WALTER ROWAN JAMES
US-72598847-A,WALTER ROWAN JAMES
US-72598847-A,WALTER ROWAN JAMES
CN-201710636376-A,UNIV TONGJI
CN-201710636376-A,UNIV TONGJI
KR-19960029894-A,KIM BYUNG SUB
KR-19960029894-A,KIM BYUNG SUB
KR-19970019112-U,CHO SUNG GU
AU-2016269849-A,UNIV SYDNEY
AU-2016269849-A,UNIV SYDNEY
US-38733520-A,KORSMEYER ERNEST H
US-38733520-A,KORSMEYER ERNEST H
CA-3089518-A,ELEOS ROBOTICS INC
KR-870011914-A,DAIYO TANGO CO LTD
ZA-808003-A,MCKAY RALPH LTD
ZA-808003-A,MCKAY RALPH LTD
ZA-808003-A,MCKAY RALPH LTD
Query:
SELECT t."filing_date",
          DATE_PART(year, TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
   LIMIT 100;
Answer:
filing_date,filing_year
20080425,2008
19950404,1995
19931103,1993
19990929,1999
19910125,1991
19920416,1992
19951018,1995
19960503,1996
19920325,1992
19991210,1999
19910204,1991
19911113,1991
19920625,1992
19950531,1995
19990607,1999
19910129,1991
19910725,1991
19920701,1992
19960919,1996
19961112,1996
19990910,1999
20121119,2012
20160610,2016
20171227,2017
20190724,2019
20201229,2020
19770131,1977
19780213,1978
19801003,1980
19820512,1982
19831018,1983
19831109,1983
19890718,1989
19891102,1989
19901229,1990
19931122,1993
19980526,1998
19970520,1997
19990119,1999
19991231,1999
20011003,2001
20031104,2003
20031211,2003
20030808,2003
20070716,2007
20070917,2007
20080430,2008
20111215,2011
20120706,2012
20140702,2014
20150629,2015
20180427,2018
20201006,2020
20050406,2005
20050408,2005
20050414,2005
20080422,2008
20050415,2005
20050414,2005
20050418,2005
20050421,2005
20080430,2008
20020327,2002
20020405,2002
20050503,2005
20080516,2008
20050506,2005
20050511,2005
20080603,2008
20050519,2005
20080611,2008
20020508,2002
20080619,2008
20020510,2002
20080623,2008
20050609,2005
20050620,2005
20050621,2005
20061212,2006
20020530,2002
20050729,2005
20020605,2002
20020604,2002
20080702,2008
20080702,2008
20050629,2005
20050708,2005
20010214,2001
20080730,2008
20050721,2005
20050722,2005
20080806,2008
20020703,2002
20020703,2002
20020702,2002
20050726,2005
20050728,2005
20080814,2008
20050729,2005
20050801,2005
Query:
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
LATERAL FLATTEN(INPUT => t."cpc") f2,
LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value::STRING ILIKE '%A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100
Answer:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
SAMSUNG SDI CO LTD,1
WILLIAM HENRY HONY FROST,1
SJOEHOLMS MEKANISKA AB,1
ELEOS ROBOTICS INC,1
WALLNER KLAUS,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
TRECKER FRANCIS J,1
GUERBET FRANCOIS,1
TEXAS INDUSTRIES INC,1
SHEPPARD RICHARD H,1
CAMPBELL CLARENCE L,1
LEINFELDER DIPL-LANDW HERMANN,1
CHOATE STOREY NORMAN,1
KORSMEYER ERNEST H,1
ARTHUR BROOKS SPURR,1
PREC PLANTING LLC,1
GERBER HUBERT,1
WANG XUEDONG,1
INT HARVESTER GREAT BRITAIN,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
SOUTHERN PLOW COMPANY,1
Liu Yueshang,1
TWOSE OF TIVERTON LTD,1
MARTIN CHARLES H,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
GLASIER HAROLD H,1
ZHANG LIJIN,1
SIGFRID ANDERSON ANDERS,1
WILLIAM DREFKE,1
KIM JONG JIN,1
SALGE HENRY F,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
LIM HEON HO,1
HOLGER LETH,1
CHONGQING TIANJI IND CO LTD,1
BULLS CO LTD,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
CHO SUNG GU,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHRISTEN ARNE JENSEN,1
UNIV JIANGSU,1
OTULAK PRZEMYSLAW PRO CNC,1
UNIV TONGJI,1
PATENT CONCERN NV,1
EDWARDS JOHN W,1
EDMOND HEE,1
RUDOLPH HASSON PAUL,1
MCKAY RALPH LTD,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
LG ELECTRONICS INC,1
LEMKEN GMBH & CO KG,1
DAIYO TANGO CO LTD,1
BOTVID SETTERGREN ANDERS GOSTA,1
SAMSUNG KWANGJU ELECTRONICS CO,1
GEORGE A KELLY PLOW COMPANY,1
KUBOTA KK,1
FISHER VAN E,1
HARRELL DANNY H,1
UNIV HEILONGJIANG SCI & TECH,1
HUBER FRANZ FERDINAND,1
ALLEN SAMUEL L,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
AGSOILWORKS TECH COMPANY LLC,1
WALTER ROWAN JAMES,1
UNIV CHUNG ANG IND,1
MARTIN DOMINIC R,1
AUGUST SETTERGREN OTTO GORAN,1
GERBER MAURICE,1
QUINSTAR CORP,1
DAEHO FARMING MACHINERY CO LTD,1
CHRISTOPHER H R WOODWARD,1
RICHARD CO,1
CNH IND AMERICA LLC,1
LEIJENAAR SYTZE,1
UNIV SYDNEY,1
BETEK GMBH & CO KG,1
JIM ALEX SMITH,1
NEW ZEALAND INVENTIONS DEV,1
KIM BYUNG SUB,1
SAPHIR MASCHB GMBH,1
KIM JAE KEUN,1
KUHN SA,1
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100;
Answer:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
SAMSUNG SDI CO LTD,1
BOTVID SETTERGREN ANDERS GOSTA,1
KUBOTA KK,1
GERBER HUBERT,1
MARTIN DOMINIC R,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
KUHN SA,1
WANG XUEDONG,1
SAMSUNG KWANGJU ELECTRONICS CO,1
FISHER VAN E,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHONGQING TIANJI IND CO LTD,1
GEORGE A KELLY PLOW COMPANY,1
WALTER ROWAN JAMES,1
UNIV CHUNG ANG IND,1
AUGUST SETTERGREN OTTO GORAN,1
MARTIN CHARLES H,1
QUINSTAR CORP,1
SOUTHERN PLOW COMPANY,1
DAEHO FARMING MACHINERY CO LTD,1
ZHANG LIJIN,1
JIM ALEX SMITH,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
ELEOS ROBOTICS INC,1
WALLNER KLAUS,1
SJOEHOLMS MEKANISKA AB,1
CHO SUNG GU,1
ALLEN SAMUEL L,1
CHRISTEN ARNE JENSEN,1
NEW ZEALAND INVENTIONS DEV,1
LG ELECTRONICS INC,1
BULLS CO LTD,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
INT HARVESTER GREAT BRITAIN,1
TWOSE OF TIVERTON LTD,1
WILLIAM DREFKE,1
RICHARD CO,1
RUDOLPH HASSON PAUL,1
ARTHUR BROOKS SPURR,1
LEINFELDER DIPL-LANDW HERMANN,1
CAMPBELL CLARENCE L,1
CHOATE STOREY NORMAN,1
KORSMEYER ERNEST H,1
GERBER MAURICE,1
EDWARDS JOHN W,1
EDMOND HEE,1
KIM JONG JIN,1
SALGE HENRY F,1
CHRISTOPHER H R WOODWARD,1
Liu Yueshang,1
SAPHIR MASCHB GMBH,1
KIM BYUNG SUB,1
SIGFRID ANDERSON ANDERS,1
LEIJENAAR SYTZE,1
CNH IND AMERICA LLC,1
TEXAS INDUSTRIES INC,1
UNIV JIANGSU,1
GUERBET FRANCOIS,1
HARRELL DANNY H,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
AGSOILWORKS TECH COMPANY LLC,1
LIM HEON HO,1
PREC PLANTING LLC,1
GLASIER HAROLD H,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
UNIV TONGJI,1
PATENT CONCERN NV,1
OTULAK PRZEMYSLAW PRO CNC,1
SHEPPARD RICHARD H,1
UNIV HEILONGJIANG SCI & TECH,1
HUBER FRANZ FERDINAND,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
BETEK GMBH & CO KG,1
UNIV SYDNEY,1
HOLGER LETH,1
WILLIAM HENRY HONY FROST,1
DAIYO TANGO CO LTD,1
LEMKEN GMBH & CO KG,1
TRECKER FRANCIS J,1
KIM JAE KEUN,1
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value::STRING ILIKE '%A01B3%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 100;
Answer:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
PREC PLANTING LLC,1
BOTVID SETTERGREN ANDERS GOSTA,1
SAMSUNG SDI CO LTD,1
CHONGQING TIANJI IND CO LTD,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
KIM JAE KEUN,1
TRECKER FRANCIS J,1
ZHANG LIJIN,1
UNIV CHUNG ANG IND,1
RUDOLPH HASSON PAUL,1
DAIYO TANGO CO LTD,1
SAMSUNG KWANGJU ELECTRONICS CO,1
GUERBET FRANCOIS,1
SHEPPARD RICHARD H,1
WILLIAM HENRY HONY FROST,1
SJOEHOLMS MEKANISKA AB,1
WALLNER KLAUS,1
ELEOS ROBOTICS INC,1
HUBER FRANZ FERDINAND,1
UNIV HEILONGJIANG SCI & TECH,1
SIGFRID ANDERSON ANDERS,1
LEMKEN GMBH & CO KG,1
KIM BYUNG SUB,1
AUGUST SETTERGREN OTTO GORAN,1
SAPHIR MASCHB GMBH,1
Liu Yueshang,1
GLASIER HAROLD H,1
CHO SUNG GU,1
CHRISTEN ARNE JENSEN,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
GERBER HUBERT,1
WANG XUEDONG,1
HARRELL DANNY H,1
UNIV SYDNEY,1
QUINSTAR CORP,1
DAEHO FARMING MACHINERY CO LTD,1
EDWARDS JOHN W,1
EDMOND HEE,1
RICHARD CO,1
GERBER MAURICE,1
CHOATE STOREY NORMAN,1
KORSMEYER ERNEST H,1
CAMPBELL CLARENCE L,1
ARTHUR BROOKS SPURR,1
LEINFELDER DIPL-LANDW HERMANN,1
SOUTHERN PLOW COMPANY,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
FISHER VAN E,1
KUBOTA KK,1
TEXAS INDUSTRIES INC,1
BULLS CO LTD,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
INT HARVESTER GREAT BRITAIN,1
TWOSE OF TIVERTON LTD,1
NEW ZEALAND INVENTIONS DEV,1
UNIV TONGJI,1
KIM JONG JIN,1
SALGE HENRY F,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
GEORGE A KELLY PLOW COMPANY,1
UNIV JIANGSU,1
CNH IND AMERICA LLC,1
LEIJENAAR SYTZE,1
LIM HEON HO,1
HOLGER LETH,1
CHRISTOPHER H R WOODWARD,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
ALLEN SAMUEL L,1
AGSOILWORKS TECH COMPANY LLC,1
WILLIAM DREFKE,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
BETEK GMBH & CO KG,1
OTULAK PRZEMYSLAW PRO CNC,1
MARTIN CHARLES H,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
PATENT CONCERN NV,1
LG ELECTRONICS INC,1
WALTER ROWAN JAMES,1
JIM ALEX SMITH,1
KUHN SA,1
MARTIN DOMINIC R,1
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
GROUP BY "assignee_name"
ORDER BY "total_applications" DESC
LIMIT 3
Answer:
assignee_name,total_applications
DEERE & CO,30
CNH IND AMERICA LLC,10
KUBOTA KK,8
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "applications_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "assignee_name", "filing_year"
ORDER BY "assignee_name", "filing_year"
LIMIT 100
Answer:
assignee_name,filing_year,applications_count
10691976 CANADA LTD,2019,1
AG CHEM EQUIPMENT CO,1995,1
AGCO CORP,2015,1
AGCO INT GMBH,2013,1
AGSOILWORKS TECH COMPANY LLC,2019,1
AGXEED HOLDING B V,2022,1
ALIG ENV SOLUTIONS LLC,2018,1
ALLEN SAMUEL L,1904,1
ALLIS CHALMERS,1973,1
AMAZONEN WERKE DREYER H,1972,1
AMAZONEN WERKE DREYER H,1979,2
AMAZONEN-WERKE H DREYER GMBH & CO KG,2015,1
ANDERSON HENNING G,1911,1
ANDREW MANSON LAU,2007,1
ARTHUR BROOKS SPURR,1951,1
ARWAC LTD,2020,1
AUGUST SETTERGREN OTTO GORAN,1948,1
AUTONOMOUS SOLUTIONS INC,2017,1
B F AVERY AND SONS,1919,1
BAILLARGEON RODRIGUE,1996,1
BASF AGRO TRADEMARKS GMBH,2017,1
BASF AGRO TRADEMARKS GMBH,2020,1
BAUR HERMANN,1978,1
BENNETT DAVID A,1953,1
BENNETT ROY E,1953,1
BERGER F & C,1994,1
BETEK GMBH & CO KG,2015,1
BINZHOU INST OF AGRICULTURAL MECH SCIENCES,2018,1
BLUE RIVER TECH INC,2021,1
BONATTO DALCHIOR ANTONIO,2015,1
BOSCH GMBH ROBERT,2019,1
BOTVID SETTERGREN ANDERS GOSTA,1948,1
BROWN TRACTORS LTD,1965,1
BUDD CO,1947,1
BULLS CO LTD,2012,1
BUSATIS GEB,1956,1
CAMPBELL CLARENCE L,1935,1
CARLUCCI JAMES J,1974,1
CCTEG BEIJING LAND CONSOLIDATION AND ECOLOGICAL RESTORATION TECH RESEARCH INSTITUTE CO LTD,2021,1
CCTEG ECOLOGICAL ENVIRONMENTAL TECH CO LTD,2021,1
CHENGDU RUOCHU AGRICULTURAL CO LTD,2018,1
CHINA NAT RICE RES INST,2022,1
CHINA NAT SALT INDUSTRY CORPORATION SALT GEOLOGICAL EXPLORATION BRIGADE,2019,1
CHIOCCO GREGORY D,2010,1
CHO SUNG GU,1997,1
CHOATE STOREY NORMAN,1934,1
CHONGQING TIANJI IND CO LTD,2015,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,1
CHRISTEN ARNE JENSEN,1926,1
CHRISTOPHER H R WOODWARD,1918,1
CHULLANAM DO,2002,1
CLAAS E SYSTEMS GMBH,2021,1
CLAAS SAULGAU GMBH,1999,2
CLAAS SAULGAU GMBH,2013,1
CLAAS SAULGAU GMBH,2014,1
CLAAS SAULGAU GMBH,2023,1
CLAAS SELBSTFAHRENDE ERNTEMASCHINEN GMBH,2021,1
CLARK PAUL G,2009,1
CLAUSSEN MARTIN,1913,1
CLIMATE CORP,2013,1
CLIMATE CORP,2016,1
CLIMATE CORP,2017,1
CLIMATE CORP,2018,1
CLIMATE CORP,2021,1
CNH AMERICA LLC,2007,1
CNH AMERICA LLC,2008,1
CNH AMERICA LLC,2013,1
CNH CANADA LTD,2013,1
CNH CHINA MAN CO LTD,2019,1
CNH IND AMERICA LLC,2013,1
CNH IND AMERICA LLC,2016,2
CNH IND AMERICA LLC,2017,2
CNH IND AMERICA LLC,2019,2
CNH IND AMERICA LLC,2020,1
CNH IND AMERICA LLC,2021,1
CNH IND AMERICA LLC,2022,1
CNH IND BELGIUM NV,2016,1
CNH IND BELGIUM NV,2019,1
CNH IND CANADA LTD,2013,1
CNH UK LTD,2000,1
COLUMBUS IRON WORKS COMPANY,1953,1
CRAMER KUPPLUNG GMBH & CO KG,1999,1
CREYKE CHARLES HENRY,1997,1
CUI JIAN,2020,1
DA ROS GREEN S R L,2021,1
DAEDONG IND CO LTD,2014,1
DAEHO FARMING MACHINERY CO LTD,2000,1
DAIYO TANGO CO LTD,1987,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2018,1
DANCEL IVAN TUMBOCON,2006,1
DAYSTROM INC,1962,1
DEERE & CO,1940,1
DEERE & CO,1945,1
DEERE & CO,1964,1
DEERE & CO,1979,2
DEERE & CO,1983,1
DEERE & CO,1985,1
DEERE & CO,1992,1
DEERE & CO,1993,1
DEERE & CO,2002,2
Query:
SELECT DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       t."country_code",
       COUNT(DISTINCT t."application_number") AS "applications_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year", t."country_code"
ORDER BY "filing_year", "applications_count" DESC
LIMIT 100
Answer:
filing_year,country_code,applications_count
1901,US,2
1902,US,1
1902,FR,1
1904,US,1
1905,US,1
1906,US,1
1908,US,1
1911,US,3
1912,US,1
1913,US,4
1916,US,1
1917,GB,1
1918,US,1
1918,FR,1
1918,DE,1
1919,US,1
1920,US,1
1922,US,1
1925,US,1
1926,DE,1
1926,US,1
1926,FR,1
1927,US,1
1931,US,1
1933,US,1
1934,US,2
1934,GB,1
1935,US,1
1936,US,1
1939,CH,1
1940,US,1
1941,US,4
1942,US,1
1944,US,2
1945,US,1
1947,US,3
1948,US,1
1948,SE,1
1949,US,1
1949,GB,1
1950,US,2
1950,DE,1
1951,GB,1
1951,US,1
1951,DE,1
1951,FR,1
1953,US,2
1954,DE,1
1954,US,1
1955,DE,1
1955,GB,1
1955,US,1
1956,GB,1
1956,FR,1
1957,FR,2
1959,DE,1
1959,FR,1
1960,US,2
1960,CH,1
1961,US,1
1962,DE,2
1962,GB,2
1962,FR,1
1964,DE,1
1964,GB,1
1965,FR,1
1965,DK,1
1966,US,1
1966,AT,1
1966,CH,1
1967,YU,1
1967,DE,1
1969,SE,1
1969,BE,1
1969,US,1
1970,BR,1
1972,FR,1
1972,US,1
1973,CA,2
1973,TR,1
1973,GB,1
1974,AU,3
1974,US,2
1974,NL,1
1975,FR,1
1975,AU,1
1975,BE,1
1975,NL,1
1976,AU,2
1976,IE,1
1976,US,1
1976,IT,1
1977,HU,1
1977,AU,1
1978,BE,1
1978,ZA,1
1978,CH,1
1978,JP,1
1978,AT,1
1979,GB,1
Query:
SELECT DISTINCT f1.value:"name"::STRING AS "assignee_name", t."country_code"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
LIMIT 100
Answer:
assignee_name,country_code
DOBSON DAVID A,CA
WILLIAM DREFKE,US
ZHANG QINGHUA,CN
DEERE & CO,CN
AG CHEM EQUIPMENT CO,US
UNIV TSINGHUA,CN
CLIMATE CORP,EP
CNH IND BELGIUM NV,WO
DEERE & CO,CA
PREC PLANTING LLC,CA
CHINA NAT RICE RES INST,CN
WEBBER CHARLES E,US
IDOUGH INVEST COMPANY,US
BOTVID SETTERGREN ANDERS GOSTA,US
HUBER FRANZ FERDINAND,DE
UNIV NORTHWESTERN,CN
KUBOTA KK,CN
RUDOLPH HASSON PAUL,US
WALTER ROWAN JAMES,US
WHITE CITY TEACHING UNIV,CN
SAMSUNG KWANGJU ELECTRONICS CO,CN
SAMSUNG SDI CO LTD,KR
FAEHSE & CO H,AT
PARK HYUNG GYU,KR
FLEXI COIL LTD,CA
UNIV TONGJI,CN
SJOEHOLMS MEKANISKA AB,NO
QINGDAO GUANZHONG ECOLOGY CO LTD,CN
SAPHIR MASCHB GMBH,EP
GEORGSCHWEIGER,IE
CHIOCCO GREGORY D,US
SLOOTSMID B V,NL
LIND B D C,AU
LS MTRON LTD,KR
WALTERSCHEID GMBH JEAN,NL
GERBER HUBERT,FR
KUBOTA KK,US
XINGGUANG AGRICULTURAL MACHINERY CO LTD,CN
CHRISTOPHER H R WOODWARD,US
COLUMBUS IRON WORKS COMPANY,US
KIM BYUNG SUB,KR
HARVEST INT INC,US
UNIV CHUNG ANG IND,KR
KNELS KENNETH JOHN,AU
GEORGE A KELLY PLOW COMPANY,US
LELY ENTPR AG,NL
SHANDONG INST POMOLOGY,CN
QINGDAO ACAD AGRICULTURAL SCIENCES,CN
NORVELL KARL A,US
DEERE & CO,AU
HILL JAMES B,US
JOHN HODGKINSON,GB
LIANYUNGANG ACAD AGRICULTURAL SCIENCES,CN
OLIVER CORP,US
FISHER VAN E,US
WABCO GMBH,US
UNIV IOWA STATE RES FOUND INC,BR
SEEDMASTER MFG LTD,BR
GLASIER HAROLD H,US
UNIV SYDNEY,AU
LEINFELDER DIPL-LANDW HERMANN,DE
BOSCH GMBH ROBERT,DE
BASF AGRO TRADEMARKS GMBH,CA
JOSEPH BAPTISTE ALFRED CHAPRON,GB
YANG YE,CN
VASSY AINE,FR
DEL MORINO SRL,IT
HENRIOD FRERES S A R L,CH
CLAAS SAULGAU GMBH,AT
DEERE & CO,US
SWINDALL SAMUEL L,US
BENNETT DAVID A,US
XIAMEN HAICHENG CONSTRUCTION ENG CO LTD,CN
WEIMAR KOMBINAT VEB,HU
UNIV CENTRAL SOUTH FORESTRY & TECHNOLOGY,CN
EMPR IMPORT EXPORT Y DISTRIB P,NO
UNIV DALIAN,CN
AGXEED HOLDING B V,WO
MAX BURG,GB
INT HARVESTER GREAT BRITAIN,GB
DAEDONG IND CO LTD,KR
FED GOSUDARSTVENNOE BJUDZHETNOE NAUCHNOE UCHREZHDENIE NAUCHNO-ISSLEDOVATELSKIJ INST SELSKOGO KHOZJAJ,RU
SHOTBOLT ENGINEERING LIMITED,GB
BERGER F & C,AT
WANG XUEDONG,CN
GUERBET FRANCOIS,CA
MCCORMICK PATRICK,GB
NAUD EXPL CHARRUES,AU
WATT ALLAN,US
KRONE BERNARD MASCHF GMBH,DE
MOMENTUS GOLF INC,US
GUYOT FONDEUR ET UNION CHARRUE,BR
MASSEY FERGUSON INC,YU
BASF AGRO TRADEMARKS GMBH,US
WANG YAN,AU
FORD MOTOR CO,JP
NINGXIA LYVFENGYUAN AGRICULTURAL TECH CO LTD,CN
OTICO,CA
TOPCON POSITIONING SYSTEMS INC,US
CHOATE STOREY NORMAN,US
Query:
SELECT DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "total_applications" DESC
LIMIT 100
Answer:
filing_year,total_applications
2018,36
2017,34
2019,28
2021,21
2022,20
2016,18
2020,18
2013,15
2015,14
2004,8
2008,7
1996,7
1999,7
2010,6
1985,6
2002,6
2014,6
1974,6
1962,5
2006,5
1993,5
1978,5
2012,5
2000,5
1976,5
1981,5
1973,4
1998,4
1997,4
1951,4
1913,4
2023,4
2003,4
1995,4
1979,4
1941,4
1975,4
1950,3
1987,3
1911,3
2001,3
1926,3
2009,3
1966,3
1992,3
1947,3
1934,3
1983,3
1918,3
2005,3
2007,3
1955,3
1969,3
1960,3
1902,2
1944,2
1964,2
1980,2
1954,2
1956,2
1984,2
1967,2
1948,2
1901,2
1957,2
1986,2
1953,2
1977,2
1989,2
1972,2
1991,2
1982,2
1994,2
1959,2
1965,2
1949,2
1925,1
1912,1
1906,1
1940,1
1945,1
1908,1
1935,1
1922,1
1939,1
1920,1
1919,1
1916,1
1905,1
1933,1
1990,1
1904,1
1936,1
1931,1
1942,1
1927,1
1970,1
1917,1
1961,1
2011,1
Query:
SELECT t."country_code",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
GROUP BY t."country_code"
ORDER BY "total_applications" DESC
LIMIT 100
Answer:
country_code,total_applications
US,158
CN,87
KR,37
DE,36
CA,31
AU,19
GB,18
FR,17
EP,15
JP,11
WO,11
NL,10
BR,9
BE,8
RU,8
AT,8
IT,7
CH,5
NO,4
SE,4
HU,4
ZA,3
PL,2
MY,1
PE,1
YU,1
NZ,1
AR,1
IL,1
GR,1
IE,1
ES,1
DK,1
TR,1
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       t."country_code",
       COUNT(DISTINCT t."application_number") AS "applications_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(INPUT => t."cpc") f2,
     LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
WHERE f2.value:"code"::STRING LIKE 'A01B%'
GROUP BY "assignee_name", t."country_code"
ORDER BY "assignee_name", "applications_count" DESC
LIMIT 100
Answer:
assignee_name,country_code,applications_count
10691976 CANADA LTD,WO,1
AG CHEM EQUIPMENT CO,US,1
AGCO CORP,US,1
AGCO INT GMBH,EP,1
AGSOILWORKS TECH COMPANY LLC,IL,1
AGXEED HOLDING B V,WO,1
ALIG ENV SOLUTIONS LLC,WO,1
ALLEN SAMUEL L,US,1
ALLIS CHALMERS,CA,1
AMAZONEN WERKE DREYER H,FR,1
AMAZONEN WERKE DREYER H,GB,1
AMAZONEN WERKE DREYER H,AT,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,CN,1
ANDERSON HENNING G,US,1
ANDREW MANSON LAU,NZ,1
ARTHUR BROOKS SPURR,GB,1
ARWAC LTD,GB,1
AUGUST SETTERGREN OTTO GORAN,US,1
AUTONOMOUS SOLUTIONS INC,CN,1
B F AVERY AND SONS,US,1
BAILLARGEON RODRIGUE,CA,1
BASF AGRO TRADEMARKS GMBH,CA,1
BASF AGRO TRADEMARKS GMBH,US,1
BAUR HERMANN,CH,1
BENNETT DAVID A,US,1
BENNETT ROY E,US,1
BERGER F & C,AT,1
BETEK GMBH & CO KG,CN,1
BINZHOU INST OF AGRICULTURAL MECH SCIENCES,CN,1
BLUE RIVER TECH INC,US,1
BONATTO DALCHIOR ANTONIO,BR,1
BOSCH GMBH ROBERT,DE,1
BOTVID SETTERGREN ANDERS GOSTA,US,1
BROWN TRACTORS LTD,DK,1
BUDD CO,US,1
BULLS CO LTD,KR,1
BUSATIS GEB,FR,1
CAMPBELL CLARENCE L,US,1
CARLUCCI JAMES J,US,1
CCTEG BEIJING LAND CONSOLIDATION AND ECOLOGICAL RESTORATION TECH RESEARCH INSTITUTE CO LTD,CN,1
CCTEG ECOLOGICAL ENVIRONMENTAL TECH CO LTD,CN,1
CHENGDU RUOCHU AGRICULTURAL CO LTD,CN,1
CHINA NAT RICE RES INST,CN,1
CHINA NAT SALT INDUSTRY CORPORATION SALT GEOLOGICAL EXPLORATION BRIGADE,CN,1
CHIOCCO GREGORY D,US,1
CHO SUNG GU,KR,1
CHOATE STOREY NORMAN,US,1
CHONGQING TIANJI IND CO LTD,CN,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,CN,1
CHRISTEN ARNE JENSEN,DE,1
CHRISTOPHER H R WOODWARD,US,1
CHULLANAM DO,KR,1
CLAAS E SYSTEMS GMBH,DE,1
CLAAS SAULGAU GMBH,EP,2
CLAAS SAULGAU GMBH,DE,2
CLAAS SAULGAU GMBH,AT,1
CLAAS SELBSTFAHRENDE ERNTEMASCHINEN GMBH,US,1
CLARK PAUL G,GB,1
CLAUSSEN MARTIN,US,1
CLIMATE CORP,CA,2
CLIMATE CORP,US,2
CLIMATE CORP,EP,1
CNH AMERICA LLC,US,2
CNH AMERICA LLC,CA,1
CNH CANADA LTD,US,1
CNH CHINA MAN CO LTD,WO,1
CNH IND AMERICA LLC,US,6
CNH IND AMERICA LLC,CA,2
CNH IND AMERICA LLC,CN,1
CNH IND AMERICA LLC,WO,1
CNH IND BELGIUM NV,WO,1
CNH IND BELGIUM NV,BE,1
CNH IND CANADA LTD,US,1
CNH UK LTD,EP,1
COLUMBUS IRON WORKS COMPANY,US,1
CRAMER KUPPLUNG GMBH & CO KG,DE,1
CREYKE CHARLES HENRY,GR,1
CUI JIAN,CN,1
DA ROS GREEN S R L,EP,1
DAEDONG IND CO LTD,KR,1
DAEHO FARMING MACHINERY CO LTD,KR,1
DAIYO TANGO CO LTD,KR,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,CN,1
DANCEL IVAN TUMBOCON,US,1
DAYSTROM INC,DE,1
DEERE & CO,US,6
DEERE & CO,CA,6
DEERE & CO,DE,5
DEERE & CO,EP,3
DEERE & CO,BR,3
DEERE & CO,AU,2
DEERE & CO,CN,2
DEERE & CO,ZA,1
DEERE & CO,FR,1
DEERE & CO,NL,1
DEGELMAN IND,CA,1
DEL MORINO SRL,IT,1
DIETRICH MFG INC,US,1
DMC CO LTD,KR,1
DO AMARAL ASSY JOSE ROBERTO,US,1
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
assignee1:str,total_applications1:int,year1:int,num_applications_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,num_applications_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,num_applications_year3:int,country_code3:str
```
(Attention: answer in three rows)

We analyzed the patent applications in class A01B3 and identified the top 3 assignees based on the total number of applications. For each assignee, we determined the year with the highest number of applications, the number of applications in that year, and the country code with the most applications during that year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-22 21:32:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:32:33 - root - INFO - ```sql
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING LIKE 'A01B%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rn
    FROM
        assignee_year_counts
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
    WHERE
        aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code"
        ) AS rn
    FROM
        assignee_year_country_counts aycc
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
```
2025-01-22 21:32:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:32:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:32:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:32:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:32:35 - snowflake.connector.connection - INFO - closed
2025-01-22 21:32:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:32:35 - root - INFO - itercount: 1
2025-01-22 21:32:35 - root - INFO - 0
2025-01-22 21:32:35 - root - INFO - results: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
DEERE & CO,30,2019,4,US
CNH IND AMERICA LLC,10,2016,2,CA
KUBOTA KK,8,1995,1,CN


2025-01-22 21:32:35 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
assignee1:str,total_applications1:int,year1:int,num_applications_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,num_applications_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,num_applications_year3:int,country_code3:str
```
(Attention: answer in three rows)

We analyzed the patent applications in class A01B3 and identified the top 3 assignees based on the total number of applications. For each assignee, we determined the year with the highest number of applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
DEERE & CO,30,2019,4,US
CNH IND AMERICA LLC,10,2016,2,CA
KUBOTA KK,8,1995,1,CN
Current sql:
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING LIKE 'A01B%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rn
    FROM
        assignee_year_counts
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
    WHERE
        aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code"
        ) AS rn
    FROM
        assignee_year_country_counts aycc
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
2025-01-22 21:33:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:33:05 - root - INFO - ```sql
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rn
    FROM
        assignee_year_counts
    WHERE
        "applications_in_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
            AND aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code"
        ) AS rn
    FROM
        assignee_year_country_counts aycc
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
```
2025-01-22 21:33:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:33:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:33:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:33:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:33:06 - snowflake.connector.connection - INFO - closed
2025-01-22 21:33:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:33:07 - root - INFO - itercount: 2
2025-01-22 21:33:07 - root - INFO - 0
2025-01-22 21:33:07 - root - INFO - results: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,AT


2025-01-22 21:33:07 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
assignee1:str,total_applications1:int,year1:int,num_applications_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,num_applications_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,num_applications_year3:int,country_code3:str
```
(Attention: answer in three rows)

We analyzed the patent applications in class A01B3 and identified the top 3 assignees based on the total number of applications. For each assignee, we determined the year with the highest number of applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,AT
Current sql:
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rn
    FROM
        assignee_year_counts
    WHERE
        "applications_in_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
            AND aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code"
        ) AS rn
    FROM
        assignee_year_country_counts aycc
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
2025-01-22 21:33:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:33:34 - root - INFO - ```sql
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING = 'A01B3'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rn
    FROM
        assignee_year_counts
    WHERE
        "applications_in_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
            AND aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code"
        ) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc."applications_in_country" IS NOT NULL
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
```
2025-01-22 21:33:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:33:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:33:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:33:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-22 21:33:36 - snowflake.connector.connection - INFO - closed
2025-01-22 21:33:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:33:36 - root - INFO - itercount: 3
2025-01-22 21:33:36 - root - INFO - No data found for the specified query.

2025-01-22 21:33:36 - root - INFO - Input sql:
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING = 'A01B3'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rn
    FROM
        assignee_year_counts
    WHERE
        "applications_in_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
            AND aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code"
        ) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc."applications_in_country" IS NOT NULL
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
The error information is:
 No data found for the specified query.

2025-01-22 21:34:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:34:07 - root - INFO - ```sql
WITH relevant_applications AS (
    SELECT
        t."application_number",
        f1.value:"name"::STRING AS "assignee_name",
        TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
        DATE_PART(year, TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
        t."country_code"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(INPUT => t."cpc") f2,
        LATERAL FLATTEN(INPUT => t."assignee_harmonized") f1
    WHERE
        f2.value:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_applications"
    FROM
        relevant_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        COUNT(DISTINCT ra."application_number") AS "applications_in_year"
    FROM
        relevant_applications ra
    INNER JOIN
        top_assignees ta ON ra."assignee_name" = ta."assignee_name"
    GROUP BY
        ra."assignee_name",
        ra."filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year" ASC
        ) AS rn
    FROM
        assignee_year_counts
    WHERE
        "applications_in_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        ra."assignee_name",
        ra."filing_year",
        ra."country_code",
        COUNT(DISTINCT ra."application_number") AS "applications_in_country"
    FROM
        relevant_applications ra
    INNER JOIN
        assignee_top_year aty ON
            ra."assignee_name" = aty."assignee_name"
            AND ra."filing_year" = aty."filing_year"
            AND aty.rn = 1
    WHERE
        aty.rn = 1
    GROUP BY
        ra."assignee_name",
        ra."filing_year",
        ra."country_code"
),
assignee_year_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code",
        aycc."applications_in_country",
        ROW_NUMBER() OVER (
            PARTITION BY aycc."assignee_name", aycc."filing_year"
            ORDER BY aycc."applications_in_country" DESC NULLS LAST, aycc."country_code" ASC
        ) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc."applications_in_country" IS NOT NULL
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Number_of_Applications",
    aty."filing_year" AS "Year_With_Most_Applications",
    aty."applications_in_year" AS "Number_of_Applications_in_that_Year",
    aytc."country_code" AS "Country_Code_With_Most_Applications_During_That_Year"
FROM
    top_assignees ta
INNER JOIN
    assignee_top_year aty ON
        ta."assignee_name" = aty."assignee_name"
        AND aty.rn = 1
INNER JOIN
    assignee_year_top_country aytc ON
        aytc."assignee_name" = aty."assignee_name"
        AND aytc."filing_year" = aty."filing_year"
        AND aytc.rn = 1
ORDER BY
    ta."total_applications" DESC NULLS LAST;
```
2025-01-22 21:34:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:34:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:34:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:34:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:34:09 - snowflake.connector.connection - INFO - closed
2025-01-22 21:34:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:34:09 - root - INFO - itercount: 4
2025-01-22 21:34:09 - root - INFO - 0
2025-01-22 21:34:09 - root - INFO - Total iteration counts: 4
