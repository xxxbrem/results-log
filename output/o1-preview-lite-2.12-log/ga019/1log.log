2025-01-29 23:52:37 - openai._base_client - INFO - Retrying request to /chat/completions in 0.460718 seconds
2025-01-29 23:54:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 23:54:14 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
Results:
user_pseudo_id
0AAAEC4E502388A6A087D2E70BDD2BEA
AFF1ED962C29150288A2946235923125
29D150D22AF86AA1AE6B56F5B9123D43
0F5D8942B1C96254F6B7E890DF1E614E
FF2D6D2366E710D0FBF8BF00D2081ADF
A329F671CAD036858EA863966B6F2BA3
35929D52C47DAC927FFFE0BA6F8343E4
4AEEE533D8FAED4AD0A9227618CD296B
71381569682468BBBB8936278290D669
1CDB183DBB7427164204AED3AEE70341
E9C87789BFFFA2A2D9E45C0CFADF855B
C63E044972BC46A8840F4CCB3174690B
81920DBA2D8AC5E4A905DC96D3DAFE18
C63823EADC246DD7B610933FF5854022
FACA9400A33297BBC5E72A568DE1286D
39E4645E037720D29EDE6A424C8B7AF7
D61EA31FE5CE8037DC5DC8FA6B7AEF9A
A31EFE1B3F5804E91783311C5C5831D2
BA3F0AE0F8CD45F6BC4A8419C8704656
2CB523AF7F30297524DAB2001FFE2EA1
C846380A33849DBF88BDD6A84F49F44C
0D849BD3241F4DF37ADEFA2A5CB36EC4
8EDDA1DF0A706C454685D6F1412A9A24
F9B1FEA75B896DA727BC733173B19D60
CD1D906FB130FF55A227F2DE79F0C15A
EEC7FA9B9E05990005FF736DCCADC24A
90E348A71BE256C926E1F8A86314D583
C1483F477709CE11455CE0E9E46E597A
8E9EB6DAEE98975E317428326DF60EC9
B42A29EB4F4474E9381491C9F6B920CF
EFBB2DE47B7E353F0B8C365BAC9E77F0
B0501218272494AE4F5752EA8A920AB9
525D2BA85EFE112B955CD3B19909E059
BFE99B51F316372640BDD14B9625C0F2
C7B4A196FEDE305ADF8ECAE47820A5C0
EAF6860751C9F9D380DBAFAE3F881210
8F09C3B476E71697EAE0CE7B4EA61606
8F9D2E21E1B2D41941545BAD0182F182
E806F12D29E9F873BE6EAA01CD1E1B4F
A6A77DA8F2C4102A83EED1D5216EB318
C6F7DDDF431DB0C8BA773498AE41010B
E325A12D5EBC55ACEC787D88E545A9F0
38C2C9FC38AC2F424C8D519FE7BF988B
BF228451A5AA3B510CAAAAEF62613063
D52AC9F2B6477D1CDBE5E32F96497937
A9A4D9ED654B50C55143A93AF35088FC
7F65261B59B6FE49C42DF93784F80307
A4FB4E20F1726B15A57A1AA1633BC77A
9828CB3573D3C40D63500CB1F9461C1F
51E3AEBCB31617B0A5EC1A48877E9A70
80B7E9D1DF9155BA2277817B7F1E06AE
49E983E1361F11F5205CDA4289B71003
E1735A9FB21570C20964C678C95CB784
411E2E77A63C8896D477258761988C66
1EC742C43B8616FAA9FFACED52B88095
484108EF9B01A8C8DD769B46C9B90EEF
C83492F3B2F1F6305F4923DA15EBA273
7F665CAECEC63F45013C99D81EC447CB
BB6882241BB572C3AF3E198490C83981
3C3AFC055916156465DC1A481D9E9D04
BF42A2AB482FBF15B10B48CD50B857AC
83100BA2D5053EBA42A0F7B1E790A194
BE543B16CE25C04DB2BA08E38B4243B4
58CAB99FE371CFE26EEFE32A9BEB9C96
8CD1C44A6F041A965C4645CC9DAB8797
BB4149A393D08C6B8F9EF3F89BA25552
376E71CB4C92528ABE7D6FDC9CBCDA09
77F90D0679B70659DCFBED317724FAD1
9153C9C8AAD9E53057C0869DECD75472
A16DE718D8908FFC01DD297FEA600583
CAF520AB0C23BCE70BA0854832368591
486D0900B48B18D315367260129BFFB6
BABFE5F6C9B660265BA92AFB8EF9FC8F
B35A6709200CA19C780383357D108577
1C3229D4D4A35F3B2CF55DDE509CA94A
3A5D4B43580D9631A7F35A64181A35C5
F81A7FACD9640F8169D8DE2E27D217E6
F953F00C82353F3591EC20DF652B68AE
A153C00220FEE4D83DF879F7D5A6CB07
B0B5FFB7FD2BC3637AA7F70832957458
4896DF08BAF68522FA05E3669EDD4528
17525F1BE9060CC23A8D0A2CC76C439C
A6E7F3C2692459390F24A912B447B433
7DC72A0249398C477779B804F1EA3454
222DA52480ED3CD33C632A351A40E8AD
52B07E869C01CE684AD503F8F9445125
2FDD16446C63750D95AAAC6F6B41CB37
786AAA96746C4084190340D4B8C4710E
88E99CE30B65345ED0B118869B6AD035
3C8C2110DC4556D3E28568CA68172047
9225A1F12C539431CD0217908688C4E2
B22F17D065D62FA2F622CF1B196F92E0
DF2FC56E807EAF16E852AEAB67E0127A

2025-01-29 23:54:18 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
Results:
user_pseudo_id,user_first_touch_timestamp
BFF00C0BEDC08F406D999413584797D5,1534390382577000
D85672E8322401603F6706560AAFACA7,1534359769094000
1C9927831BAA7A0569130EADD6320C69,1534365421765000
19B5E340A2D84666E5178E237F29A22B,1534359288922000
BC575A719C37E1C2237B79FE7FD3F7E1,1534332267576000
814700C58B117F7ABFFB1145B9C29D29,1534381476043000
AA287C3266DB6069B75DCBB51006D808,1534677751935000
ACDEFD8D3F601128F8B6B55256028E1C,1534715312915000
B16AA0715E1721E18F4B9316E4A0B3E1,1534663729009000
BD2A511409EB3EBC45D4CEB4F876ED49,1534698969233000
27951B102A564E3FF875726564A141FF,1534731248353000
B7F7B01204A87A92985FCEE1F9880681,1537611783445000
92BA07C5AF1103CDD804CDA9F7199B95,1537628269767000
7197BEF5542521683ED1B58EDB184770,1537627322862000
7EDFFF7CB9DB49F6C61708EEBA33A32D,1537643035618000
BEF5D5FFD58E3C06524EF00937AC7E5A,1537628880652000
7D87123EF025F4B3A92359C10CBD8039,1534486845129000
F108523E7DD7905608275CC84287B217,1534454476027000
71AAE70AC95236B7ADF665241789A2DB,1534415939503000
342C835CEA858EF92FA64D22B41FB031,1534480865986000
99102A5913030C7A0191F37F71BD00BC,1533217834826000
95234F012736091D256010A811C5A25A,1533219207305000
A8772128307051043124FE8443B1C326,1533256509394000
5835395BAE5D85478439107727B8EA99,1533256969947000
C0D247C7C087F68E0504E5B5E5BBFB11,1533203398797000
942E123C7E8C0B62935889D03D77BE8E,1533236443628000
7432B1A3C0CB18E6BA5E0F14F1105980,1533261856075000
0AAAEC4E502388A6A087D2E70BDD2BEA,1536857936138000
AFF1ED962C29150288A2946235923125,1536862632351000
42FE551121362B71E141D291CC7AA4E9,1536840086036000
65F8E2B80A986C0FDF372EF08A031483,1536894048713000
596FCBD95E3C6C24EC450B4BB7F12D18,1536855961339000
AC14AD9D158A2A5449E120A33D5B55BB,1536867225978000
8E150A8839C964819CC821BABA13E2A7,1536828111139000
819D386099AA9B435B3F4B261D3553F9,1536900346679000
E9C87789BFFFA2A2D9E45C0CFADF855B,1536846941782000
1C261CF14E530870D1889225A434B8EE,1534822950496000
DE860F06A62F2D530580702B72BC40F9,1534817168565000
F28C2C5AAE32E559874444F7F957B297,1534764356362000
C4E5C52AE26E9B3FB89B260C983DE73C,1534808712414000
BA6AC3E59787946CFE7804B39352E10F,1534803941628000
467746D404740C181366195C8CFB829E,1534779021606000
D03DB5B7CD510FC8309C5681588A7C8B,1534791823769000
18B75DE6050B93995ECCC72794B3BD38,1534749364195000
25777661D3D36C3E3656E98F29441CD8,1534787985825000
234995B94F9D6393EC3DF219345100F7,1533994739840000
35D099424972413F3E46BFCA86C15295,1533993955264000
9B0D690097928C177E91E2724871BEFF,1534007975166000
FD7785BC8C792D50EFCFC8BA128FDFF8,1534007311741000
469473B2E1C330A74286BA52BA3CACF5,1534056552701000

2025-01-29 23:54:22 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) <= TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id
8F75FAE8C9129A7B666A7DBA014898E4
D8B8615DDE319FEBE0A2AC1364E2C2EC
7E74A2BB6BBF4746DEE15F957B315401
50D529BFD3EFEB1C8216DF9A321A552A
74EFDBFCB53D83E8725D95130BA74879
7EB0099C021CF1B2C0688CB1C9D42ED0
8B38AE00504B75A9ABAA20843DF4976A
DC19D85E54278EC4524A1C057042FE2A
8BB6E580D7771BBBE04D3953EA43F640
59C79351BA65506A00F8F940CC9EB337
44E92076C1E351471915CC98615610DA
280A7B998E88ABACD33E131F24B43203
AF06A87FD3FD797F7FA3A44DFC445701
C1CBEBB972ADB547F2B4B9F3FBB44E38
C3E3CDDD1E35362AA59854F8FA511BB0
45CB5196EB384766A8EDEFEEF410CC23
A62611DA6D4B45AC3DB2450BF3A24C23
23FD6C65AB271F4DD5FC2FDEA888032D
0BF28246916A6D54E16290E925B16593
71B1D9279ABC5D66169F2937CFB9DA47
9FE14774A6A768A1C1BEBCE0DE0669A5
5F221A89D8CA4217F46AEF4C5D9C925E
F37600D4287F1C83A90F3A8CE687FAA3
A2BA4DC59DE828E7FA1A3D2746162D86
1440D2F8CDB64BFAA5621779B8C92571
C40F22701672A6B7AFF9F4F6FBC235EA
E98C2033935E43DBA50950F7039FF492
D17D42F01E95FAA1D5083EFE4D319503
3686DE7B4C85F5F0AF385348F03492C9
40F2087822D412D2D481AF043DC7DAB4
F37788083CD17FEF93F66A5A8CFA9BCD
A5C898B900B93A5FB59BDC3B712F3280
F36F1694CF053FD67EAB62D5E773AC03
1FF5408483DCCD0779F33A5808028D60
ADD0757874A418957AAA60903AA5F62D
4F09BB9CBF9E3C4A742B1D8B42D2E60A
03915D9B9DC76855CC63C18E94C93760
A0E4CBC39F80333CD04752389208DBCB
C5558CE95739F785A76DDC61DF770201
519E294A309B0BD4DCF5A5E2A2CF9F2B
AF7F48274AA5128EBCF3698F4FC8F61B
A098D049A2C05C32BF7B63298D23C663
334C732F58847B16D90BAEC2116B264E
18DDB34FFC32730E29506AA263F6A6C1
A0F4501358BD3CF59B5EC6A7C6A33774
32C8AD4EFA93405A282CF301BA211D7F
26F3A02677C6F21DFE2A00C213662D8D
B5D5EECC05D20983F8E3729AFD3295C6
C5AD1A3C5BA7749BBA184BC5138E6090
3307DD0AEFB45F2AFEE766A57E2EC357
383F4B98EC31DD2A915427D36A30354E
1608F85B710EC4AE0024BB8A1C339071
FDFBC68590B06B23FACCF2DE6A0FEAD7
2CCA4395A5281BAC61DD7C846837F50B
287443FC466C3CBF107AE8883DFD0883
4CC453DA57531954D7C053B93A20B5D0
5D95913421F680D074FABD099659B0ED
5C78931CECD78E8859AE89BC89C5E26E
CFA741BB81765E66DC761EBD78D41B96
8E10315E9B341E6371BE0055C7B29A68
359A34F575B808FEFE58BC5B40816F09
AFF1262CCD472757FC92B2A93C75CD81
63FEF9F33B5B4155C207095EBA23730A
72BC8187FDFCF6EF1EDE6613D01A20C5
D744C3C96CC0E370DB6994F28C1B03EC
0A7FCCDCB40A322AE53E43A0A0D099DB
BFAFDF13A67B045E96563CEB5B49E1BF
5A9A3E94580D662C817FD51B5C1D7E7E
27C88E1533471126F779ADE591D7915D
5B333FE2BC3875C6C3882279B51B8BAF
75711C3113A09A2976DAA5A0D8C3E84D
DD0C9E0425155960EA9EC58314A22431
2CE9034DB5A27398581F1EF3635AE813
21E8180ED9407AC6381243A802EE8F61
84F55D39B331B4D51467A32FECD5F0A5
36EB2A55E0FD24E93BE639443614DC49
45DF5BA054826C546308F865405709B3
9AFF07DCC4DC8276854BC916473FEDDA
6D65D0B8B0EFB8CD9C939252F2D9ED22
46940B869F002DCFDDA860189AF77F23
E15CC599FA923B9D51503DF30CC3A40F
814700C58B117F7ABFFB1145B9C29D29
EB18B2001B1A2D61AC02C803D66689A7
3BBBF9670FF8A13D25833DE6965F6555
F652FFF92DC543ACF621ACC7511B3822
0F9FA601689A8E3B9A218B35CDB6C219
DD9205509DA2F9DFA16544716C9E3C35
27951B102A564E3FF875726564A141FF
97759BD40B954E54A62EF85F077658BF
31C6D36C0D121E1F749FE645D7C7DCAA
8E68D3D802E39F996CD4B6CF78EC23C5
737A4B3FA732A68EB049B71E5CF15550
0C8B96426B5C39DCF5FC7B033270434A

2025-01-29 23:54:27 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id
023A2DB99CC3F70A4B71869C36952D74
0DB2864E7EC7D29DA4EC1540FFDC419A
8B025029A4D1695C7BB0AA8BCF15901B
CE14E78130328FCB4C3DA6790F5D3F7E
4BB019F8F6D1FE7BA78CA42A4698EF56
9F7B0D1BFB822F5E26E91E184E2E437C
706C748E6D1E0768BFEFE6362B5D3F67
E6FEE8B98E75EA5311FE004F98559A27
4AB0441290F6077849CBE9C74A828F0A
2F48607C41ECC4015FA296500F0A2C4B
CE56946091344ADC2D0AB88D49B83ED1
54B8D30BE1F3471830044059A37419F6
0CF1172485E8FC12110F04AB2374B308
07EFEBFA43A67BC7482DA6FDEDBDA2E2
40B224DCDBE486DBB2D13E81B285589A
3DEB0C12C49AD19D7ACE68FA59E7ACD6
307AC87B6D76A6A1A19AC2B11E3FA4B5
B71CB5D517BE99FEEED64A0F57842032
90315F3CE85BB427F960EF2F78972EA6
59454BAC415BB1F18517C6FD2C023E49
428FFFFCE9294F6707BE5D9DE31171FF
53866E32BA0ABFD846772D4B7B9B5921
03A9D32C44665A9E15CFCCEDC9F68EDB
2F2B5C88B72A5253AAF448B1E29333F5
988E20C1031C6FA5301C7D2FBD90A4BF
88AD03F6828BDD86AA72AA556D87387B
635808C1DDFBC662DC3015097E26E62A
C1BDCF7765C5EDD7643D476B84BD2B30
B5FA3B0588C19181222FCE3135DB3452
9A12E7E2B3CF644B8304DF8E1A9CE2D8
2C84CF723999D48F8F069AFFC184C4DC
645ADF1505EA560FF95D65650EAB212A
7E40E634997585B0C69B6F67C01C191B
D9AA0EC27AF47514DDB5C664A6EF758A
74456352647C13028F89D1EEFFB905F4
FA30269453141794E79B8F15EE0BA5B9
DB3B6E984B29883EA02F1A504A33730F
B63075B53A750A67A12F7F19ED5AA835
F1555004E0D95599AF2F2B8EA130A9C3
A9E807665E94FF89025596B115E09C5C
E989ADC3B80B10A564559A60763BA8D1
D79D77E3F2698B89279D7C35AB034992
91A06057C6272653B6006D7A8791DF81
757F371D73A59AA7B6FB5CF1E6483B33
361AC2578D8F5E3FFF597136111A94F4
D5F9D9AF22EF5073E10342973D48FB2C
5DE4C3F6AA9E3D2D91EE22CF1ED0B0F3
BB29F8B0FF330F326605FA421BB37BC1
2F72E1976C24D8DFEA138BBCFD304BAC
7D7B319DFFF03520EF50236B2C3FB008
E36C1A5299789BD1C3794ECBCC0BB2FC
328DC7FE55E8881B2EA668C9A2855BB7
5E09265F12D64B9FA85FF9427A0A7FB0
00B6295EC351DBFE0E31015296871E35
5B888A06EFF60B86B10367EEC3B44E85
064753F4DE400882CBF47644C9FCF8EE
8375B114AFAD8A31DE54283525108F75
8367316E48117FEBA6749BB268DCE349
F1F2C328BF34010DBA50842CA03956E2
BBDCBE2491658165B7F20540DE652E3A
86C4C88BB61CB464B3413875591AD4B3
FB49D03591104FB4CEC600157C3A2A0F
3D03A380687FE3369E93915D50C572CB
A6C87EE4B7B875BCAB0C650365236072
EEBCB25D5F056CCF59DDE654388ACD2B
E8E15D7E878B4D8030EE44695C006183
4FB9AD5448A1595338954689FD588301
A19F659EA9BA36A3595F088F30A6B7E7
709FCE78A03255D6EF6678E1D98783E7
487DE902636DD8A9844A2D61FE7BD568
E512079B53179DF9A608CF4ADE47DE9D
8D9D62A4402581BB1181D3AA73AD54E8
17934EF7C1BC1CF2C7D942401FDE84CE
94DCA111F00495D16D2D36CBB3879EEC
3C58946C3178392A69D292F2F5A862E3
2CA82928A35949DF7775D4BC04F0AEA1
620DA7A49F07368EBCB917DB113BCEDC
308452C7E6D227ADD8D3F0BC2F267D1F
4640585DB6878F93C3212012A2A03348
2E032EDF0BAA6AB7266FCB4FFA6ED543
937D215BDB6A9A3A2AD378DC9BBB23CB
B10AE521352392E4981BA07E0D86081C
BA3E7A5857FD7BE68F02E4D2F5744BE8
B3A9A38A561B3648D280614B8E2D8E07
C7E2273D8B11257FCCC915D27C1FCA24
5FED8FE4B11878AAFC4E53BDA3FBB56D
7A24963AB998AC045AF363D6DDE7F169
DCA93021D42484CF03D9BEE4C40C329A
93A7A5C31807490E878F4164A6418BFC
661DE248B0C158E25B5808B6661E6625
B8FE9AD137A133A89389656F7989B36C
2F0F260BD7B876C346B41977D0D03D62
CB04A70ABA1698F2554492072C199E39

2025-01-29 23:54:31 - root - INFO - SQL:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS total_installations
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
Results:
total_installations
2647

2025-01-29 23:54:35 - root - INFO - SQL:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS active_after_7_days
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
active_after_7_days
6615

2025-01-29 23:54:40 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
EXCEPT DISTINCT
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id
9635236AF20F767026F4974060D2F680
B27F6463047977351E76AEED8456E9FF
B175B187062693360BCBADC4160F8D88
4C8514033B25A1B49E85B8C0240C6C3F
6551148F681F9DF807FF3624EA5DEFA8
F76196A143B56B420C9EC1FE89220998
8D76B80E2CCAE0EDD0F2D50D1ABCC0B3
3309F4DE80E33A212A45B29D973EBC9C
B285B6DE14EFCE4E5F460B28881666A3
BDD854D198AD34410E91C75C2ED5F525
1F58AAA40540B7B531EF090A0669384E
66163D6663552C5C43D3DB1D98FCA9DA
F37D0945286059018632F1151EFE1AD3
2CCA4395A5281BAC61DD7C846837F50B
C30D1BE029EC04653434C68C708C73BA
8AE61BC30F02ECB3AFC1B6DB91FFDC4B
370631465168E174D7D2305DC0DB120B
B82ED5B2461E8E16AF0375FA754F6083
46AE1B2A500BC810A363BE6C9B56EFFA
C3E3CDDD1E35362AA59854F8FA511BB0
5F221A89D8CA4217F46AEF4C5D9C925E
C1CBEBB972ADB547F2B4B9F3FBB44E38
0BF28246916A6D54E16290E925B16593
71B1D9279ABC5D66169F2937CFB9DA47
DF580CA44730C9A892FBAB19B7358209
7AA56A17CAC37BF7E405CF6AF2AB52FD
B16AA0715E1721E18F4B9316E4A0B3E1
8BC5986635846F60ED5D0E9F67E52CC8
46126D2798E42A3DC3A0F1AF24BD2555
4E5647A455805C83E587D11EFC1EBAFE
5AE684C539DC4038371EDCBF649BFED1
5818B5DEE7C4EE35F531FF5ABE0475CC
4B44B78D8D8D507D918890F2B26E20E9
DCE678124B6F7B9F35BEAD1882180A68
CA9136455F325D81B4A1FC232A7CCE43
94B02BA3020E382B3456932FA88A03AC
83D42C0BEC5C0325916E5797073CEE9A
289D738E3B01C988983B957444571412
8C2CA6A4B27594E8E363819DC8A8F4D0
575CDA26268871E43230F53F87804994
78A7C7D9BC2138200C3B37E3C7CA8CE8
949DC369B1AB32FCB10B9D6E4B367DE7
2927A9F548849C44AF989FAAA4392517
E6D3C4CCBB6066217EE2A2A69FB25E7C
DCEB9A1F6C5B9B67F0994C7A7388A8C1
21E8180ED9407AC6381243A802EE8F61
B72C3DD50B9F81DBCED2EE06E08796CE
3CCC49DD05DF89B1B103E2C22366AA0C
5D3AC32A3431337AB937BDAF886D1782
D5E0BD50D8A6244443E08E2E71B3739D
1BA8A3FE9D6AD54C6C77BC8A350BF2DA
2CFE23AC4E3C6529D39BDADA1EF99C52
F811FA3ECC2BA9F049E5A216FAFA301B
26F3A02677C6F21DFE2A00C213662D8D
533E79DF88C5D3B27AB10A32F8185503
7C2F5BC71CBBC77D23A91859F437F5D4
C257F5C497C17E2661785F4AA970A532
DD9205509DA2F9DFA16544716C9E3C35
F183D1950EDA9E115C8C05A84E42EA62
25D990A548748C1167DF39EDD1A61019
1ECCA9BFA4F04D96DB287D32F05A6F6F
029EBD2B01A3857606BBCCC1AF8992D4
AFDD4D9A11CDD36BB20222F82D62123F
0CC5E5E794CB2FA570F8E6076A4022C1
5C97A22ED49A8C349246F6E2737D6384
44E92076C1E351471915CC98615610DA
D951647AC8133518776B4736475BF1D8
C175523CE4F5BB5E65A4EC3CF6B1345C
7C8D8B75790229C5B05F6D31E9BE6254
7814B0C31DD814CFAD6DA4E2B4C4EEDB
2BFEB4CBB17A39C8EF5E5CADD928D780
B871DE19EDBD041D11C5BEF3A616995E
C8F8D0690CE62FC1DEF00A5B121BE251
5835395BAE5D85478439107727B8EA99
1B448720A92D5A61CA428042BE55EE7B
BA68AFBA94C53DA2DE67AA683078AD2A
12D15CA29CFE3CBA400CE28F31CDFEFC
B8ABF06C01AC9AE51849B42460E2E560
9768367BE6132B5C5AD84DD63411E2E3
D864D058813F31B452BCE6743B0AF7F7
7BA1098EE744CDED1FA599098513BF43
9CD5898126E744A7614D790C2C67B052
CB206CA46FDD13AC2030F27E7DC54E26
E39D2DDDB7095CAB4D000D357B00117A
98001421668C25D7C0B41F550C53D949
86351452DC4746F0D4ED2A87D528D915
633843D8A31D2F78A27B35B77CDCF620
BF0BEAAEDA831B1E974A03E38CA63058
8235CEF88E270F8C33F9218633A421FD
C337446FADC0FB49C18BB3C9C86339B6
14811D9D29E86F3AD408F1AAD953DC60
F36F1694CF053FD67EAB62D5E773AC03
8BE102266AF2AEC727AE08D0A5241DE0

2025-01-29 23:54:44 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) <= TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id,event_name,event_timestamp
69541D4D4F182FBB46C3225DA0077DDD,level_up,1537368514185000
69541D4D4F182FBB46C3225DA0077DDD,level_complete,1537368459185000
69541D4D4F182FBB46C3225DA0077DDD,completed_5_levels,1537368476185001
69541D4D4F182FBB46C3225DA0077DDD,level_up,1537416941397033
69541D4D4F182FBB46C3225DA0077DDD,level_complete,1537416855397000
69541D4D4F182FBB46C3225DA0077DDD,post_score,1537368463185004
69541D4D4F182FBB46C3225DA0077DDD,post_score,1537416878398036
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537368399296012
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537368433185003
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537368514751008
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537368463818012
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537368532065011
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537368520065012
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537416675099012
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537416741746016
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537416735746017
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537416745752024
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537416722843028
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537416932397035
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537416891813040
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537416928909044
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537416988024007
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537416962024008
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537416995902018
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537417005005023
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537417066179034
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537417112179035
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537368408646003
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537368434997007
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537416626398003
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537416696762007
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537416661546003
69541D4D4F182FBB46C3225DA0077DDD,session_start,1537368397236000
69541D4D4F182FBB46C3225DA0077DDD,session_start,1537416707433000
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368402718004
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368375090008
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368501344007
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368477790009
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368527108002
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368516985008
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368570944015
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368578655019

2025-01-29 23:54:48 - root - INFO - SQL:
SELECT `user_pseudo_id`, COUNT(`event_name`) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `user_pseudo_id`
LIMIT 100;
Results:
user_pseudo_id,event_count
7153341A14B1253A46FD8D6DE5490EE4,3
C1648883A80997B611743D528CBFF926,672
E3FB1ADEE3426B8E0EFFE7CDCB73BF40,62
D5F25FE843F01514F448B1AA94028D2D,53
804FAFFD6840372D64162A82E288E872,15
654F30C1312F6C1A26DFDA9F076A62D8,406
45FB547C5857493104687C234EDCDE37,949
CA374E053CF35114C98D40A23CAFA777,22
0409A1CE83D1D4DC0F01E2DFA44ED555,389
5346C62F49BF2E6C1199456F16604B3C,65
B2F661E88136265632545A030F09A88A,1
7D613AF4DA0F508C7090E96FD73B7E6D,7773
DAB972641CDD57B498702CA343A4ABCF,1
3A4F5028A0CA512C0E2CCA1F36CE160D,440
E80C958E3C33898989A30B8F5A4514F0,2883
9DE7361ACCDEA6541AD5EA55D59B1C78,644
60603343AB8FEECD78B1009C957D193D,960
A0E93D033E25966AB516BE78D143DE7A,1117
5C351EE241AC7063F3B64F96F3A7AB3C,16
2B0D8BD127A58843F3B4F8C8FE50CD77,75
05FB3382D94C7E963B408FD6CC357D33,21334
CFA0F8C5E25A71062E573EF8E6BC9F76,4684
E1276C0BE9F4591AA1068726811F20F5,25
D45CF251C60626FDB4BB8D50ABB7BA46,594
959635567E419A061EECCCA478EDC718,62635
372D9BB5088C4E9000C65B06459B403A,7629
FEC0B30EED7870C4D46230D73032E5CA,1555
4F7CAE5C86F09A791C3F9FA77C10E833,249
86F19DAB73E484FB7DD2F805DDD7957D,10953
5E8B4AEF7E3373AA78408DB08E72E3B8,2312
4EF964D59282E5A2C8692D30F011256B,11054
818B7B94997904AAC3FAD9106425AF43,59
77D5FF20DF909CDD790ED52FC94AF7BD,167
396CD60DADAB9CBA7DDCAF239B477135,6496
0CAAA1B6F161BA4D363EB7A2DEF64A08,8647
D6F5820E5B2C721C1677E1BC873B074A,396
835765A97BEE13977198CB622AB23A8E,1
B5F3D00E28A57C9522F2DEE3CB903DD1,2319
4EF1041DB2A406750E4A46AFD78FB543,86
DC8912881CD30A0D8D5E2EB666D22901,162
7D47E668B7B94D57C9295BE5B78D26BB,15
0C777BD44F304574371C97674DCD0702,4586
BE74418BE7B7466F6FE2969CA79FA919,3522
CA04708DA02378999ECB402481FF1AE4,7239
8252847DECB3C31CAB9BDEE566F97BA2,860
56E8EC9522573BD1BAD8E18AD2E33C9A,3271
D47DCBB00B2B462C916A5A07DCFAB039,423
A0616D4E494DC3BCCB94B8B6E5B48380,4637
94501F48A0A231D442FAE2DBA258FD18,15
751F1516AC974AC343F62070D3BA39F5,1279
682A8CD0767A569DC68E7AA0201BFBA3,3109
D299D5763E03F1CC4DA8550AF1B4CEE4,1085
6A07135DA41B81E278341576A26672E4,178
9BF56DEE5166364944BDF61ED31E6F30,49
A1927ED722EA16A3B82E7EE0FA22FF4F,1314
058520E12010190322386C3E356AEE8F,1308
65F7D86346A4002519B78D2E405851E2,65
CE3148CA8DACC6B0D0C5D234186008BE,237
9ECE81C526D4A7F85115B8D9C398AFC2,149
C962AE7EF8A83B7013D2610349D7D36E,237
75120F32A68A6C4FB643349E125D8C31,7238
F580B62369D32FBDE8928279DF764711,981
F5DAD8DD17B689CF672D65A0A81CF4AC,6506
95BC3B2233ECAE0717CC70A45315365B,1096
7EA86ADA1763724469F41BFE017D43C4,1
018219C83A4E8873F1CD8BA8F041E8BB,10
82486A3B62D50DB914F1C6857733DAB2,481
3D1B58553D2E2D4DD5DFCF251D5E23B2,923

2025-01-29 23:54:52 - root - INFO - SQL:
SELECT `user_pseudo_id`, MAX(`event_timestamp`) AS last_event_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND `event_name` != 'first_open'
GROUP BY `user_pseudo_id`
LIMIT 100;
Results:
user_pseudo_id,last_event_timestamp
023A2DB99CC3F70A4B71869C36952D74,1536879053022028
0DB2864E7EC7D29DA4EC1540FFDC419A,1535590497449005
58230465C695B0FDDDAE08A481FAEECC,1535838864050007
B087A865A90AD52D1864A36482983BD2,1538609273624005
F3917138A3D4B03ADA1C2E77E3B84649,1538591342852016
186F51E5AACB37852E3650E7027E33B1,1538543065313007
04EB70477096F5CE71C59900BDC3EEC7,1535537740974065
F9D11CF4FB7EEF700D4B71A641E4EFA3,1535530855309000
2D2FD11BEC057DC5ED96DD8F0649A36B,1535547492054000
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1538623374135024
6A70F62D607470D466B836AE98E8E838,1535569000224003
920DB84FCC0F4421650B9E257E33180B,1538313567869018
757F371D73A59AA7B6FB5CF1E6483B33,1538608909982043
E2C73393E938B51088B200E971667B8A,1535544404814064
DAA3F353F320A717A0C418A8205292B2,1535544667037244
FF20E4EE129C3700FC1C6CEF188E17BB,1538376339028003
DC14701AE5C2808151BE7008898B13B8,1535828720527059
BF709EB51D61C3A7BF68C4CFD7F236BE,1535856976721001
03A9D32C44665A9E15CFCCEDC9F68EDB,1538315171619000
12C60B55FAED4052AB2825241E7770DE,1535571118746003
13AC12EF4C6A0EAF72795F720752AD98,1536005212069028
635808C1DDFBC662DC3015097E26E62A,1536397843606162
82EC0357F7A97115EB30AFC798B49EFA,1535608423523001
CE14813861706B30558A91E503E4CA4A,1535569776291003
E512079B53179DF9A608CF4ADE47DE9D,1538596335726009
0478941CDE0699903455E8A6A95546CD,1536075096373000
CF092C279C3407DD69A44008D7511A2E,1536205862933012
424C01CD3ACB4454BB6B2D2899511997,1538533914383002
C8512BCE348E996C81697F6BE81F8B98,1535594210630021
301AFECE7DEEE17ACC059F6C18017D80,1538246644552129
E42066B3F588F26AE64518AA41805F62,1535601460970000
CB3247B1C1CDA46A0F086191DB3FF5B2,1535871010760001
B7E1645D07FE202F218A6EECBE0FF16B,1535648626221000
53A5A4C271525BAA74298747E100C376,1536559837660001
E5A2CB7A471E740E758BE5E2E0C79BC2,1538560702824014
65BF56455C9B2CAFE68AB07D23A7EFF1,1535550068083007
74375465CD17299EBC7C75A1B4047EE0,1538625997917039
F0133C453901CA70C9101F0550E81AB3,1535575671245000
6A07135DA41B81E278341576A26672E4,1536944091914019
8CED53DF2E18FAB2FCD5297C0CC860AB,1536642234031000
85F571A8A9878C55EB15F93449EB5447,1535792746592007
D9FEC4E4418413FCE771B203FD7D48D2,1538567771698041
096C23E69254818F7EE03C1239005F2B,1538204172078002
7C7E71D0478D9A96AFEB74DD80521DF7,1538171865624005
A77FFAEE0FD822CD7F387ADA352EDB12,1535673532863016
A8D7DCCA39D8703F2928AD2D7BBB6BE9,1538617196272007
65D1701E5BA0070CCF15F0CB0E1CF750,1538121375591002
DF0E6C6C5E4F3F34FEC6EE54FD945B05,1538606651409102
4091F647A1B6367AC7945DA0917CDA7D,1535535106376001
A48E8402E01E93E43524A2746524FF73,1535778271789000
EFB696A82D093B3AFBE92FF526DD5CEA,1538620924186002
62DD70123C14207F97E6515DDE77D76D,1538596130735005
40B501E0460E254E289A776CFC31DCF2,1538618986315004

2025-01-29 23:54:52 - root - INFO - itercount: 0
2025-01-29 23:54:52 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - All `events_YYYYMMDD` tables from `20180801` to `20180930` in the `firebase-public-project.analytics_153293282` dataset.

- **Columns and Potential Usage:**

  - `user_pseudo_id`: Unique identifier for each user. Used to track user activity over time.
  
  - `event_name`: Name of the event. Used to identify specific events such as `'first_open'` (app installation) and user engagement events.
  
  - `event_timestamp`: Timestamp of the event. Used to determine when events occurred relative to the installation time.
  
  - `user_first_touch_timestamp`: Timestamp of the user's first interaction with the app. Indicates when the app was installed.
  
  - `event_date`: Date of the event in `'YYYYMMDD'` format. Used to filter events within specific dates.
  
  - `event_params`: Contains additional parameters for events. May be used to extract more detailed information if needed.
  
  - **Conditions that may be used:**
    - `event_name = 'first_open'`: To identify installation events.
    - `_TABLE_SUFFIX BETWEEN '20180801' AND '20180930'`: To filter events during August and September 2018.
    - Time calculations using `TIMESTAMP_MICROS` to find events within or beyond seven days of installation.
    - Comparing `event_timestamp` and `user_first_touch_timestamp` to determine user activity over time.

---

**Sample SQL Queries:**

1. **List distinct users who installed the app in August and September 2018:**

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
```

2. **Retrieve user installation timestamps during August and September 2018:**

```sql
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
```

3. **Find users with events within seven days after installation:**

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) <= TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

4. **Find users with events beyond seven days after installation:**

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

5. **Count total installations in August and September 2018:**

```sql
SELECT COUNT(DISTINCT `user_pseudo_id`) AS total_installations
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
```

6. **Count users active after seven days of installation:**

```sql
SELECT COUNT(DISTINCT `user_pseudo_id`) AS active_after_7_days
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

7. **Identify users who did not have any events after seven days (potential uninstalls):**

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
EXCEPT DISTINCT
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

8. **List events for users in the first seven days after installation:**

```sql
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) <= TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

9. **Calculate the number of events per user after seven days from installation:**

```sql
SELECT `user_pseudo_id`, COUNT(`event_name`) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `user_pseudo_id`
LIMIT 100;
```

10. **Retrieve the last event date for each user who installed during the target period:**

```sql
SELECT `user_pseudo_id`, MAX(`event_timestamp`) AS last_event_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND `event_name` != 'first_open'
GROUP BY `user_pseudo_id`
LIMIT 100;
```

---

These queries help in understanding user behavior regarding app uninstalls:

- **Queries 1 & 2:** Identify users who installed the app during August and September 2018 and get their installation timestamps.

- **Queries 3 & 4:** Determine whether users had events within or beyond seven days after installation.

- **Queries 5 & 6:** Count the total number of installations and users active after seven days.

- **Query 7:** Identify users who did not have any events after the first seven days, indicating potential uninstalls.

- **Queries 8 & 9:** Analyze user engagement within and after seven days to assess activity levels.

- **Query 10:** Find out the last interaction time for users to see if they remained active.

By running these queries and analyzing the results, we can calculate the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018.

---

Let me know if you need further assistance with these queries or additional information!Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
Answer:
user_pseudo_id
0AAAEC4E502388A6A087D2E70BDD2BEA
AFF1ED962C29150288A2946235923125
29D150D22AF86AA1AE6B56F5B9123D43
0F5D8942B1C96254F6B7E890DF1E614E
FF2D6D2366E710D0FBF8BF00D2081ADF
A329F671CAD036858EA863966B6F2BA3
35929D52C47DAC927FFFE0BA6F8343E4
4AEEE533D8FAED4AD0A9227618CD296B
71381569682468BBBB8936278290D669
1CDB183DBB7427164204AED3AEE70341
E9C87789BFFFA2A2D9E45C0CFADF855B
C63E044972BC46A8840F4CCB3174690B
81920DBA2D8AC5E4A905DC96D3DAFE18
C63823EADC246DD7B610933FF5854022
FACA9400A33297BBC5E72A568DE1286D
39E4645E037720D29EDE6A424C8B7AF7
D61EA31FE5CE8037DC5DC8FA6B7AEF9A
A31EFE1B3F5804E91783311C5C5831D2
BA3F0AE0F8CD45F6BC4A8419C8704656
2CB523AF7F30297524DAB2001FFE2EA1
C846380A33849DBF88BDD6A84F49F44C
0D849BD3241F4DF37ADEFA2A5CB36EC4
8EDDA1DF0A706C454685D6F1412A9A24
F9B1FEA75B896DA727BC733173B19D60
CD1D906FB130FF55A227F2DE79F0C15A
EEC7FA9B9E05990005FF736DCCADC24A
90E348A71BE256C926E1F8A86314D583
C1483F477709CE11455CE0E9E46E597A
8E9EB6DAEE98975E317428326DF60EC9
B42A29EB4F4474E9381491C9F6B920CF
EFBB2DE47B7E353F0B8C365BAC9E77F0
B0501218272494AE4F5752EA8A920AB9
525D2BA85EFE112B955CD3B19909E059
BFE99B51F316372640BDD14B9625C0F2
C7B4A196FEDE305ADF8ECAE47820A5C0
EAF6860751C9F9D380DBAFAE3F881210
8F09C3B476E71697EAE0CE7B4EA61606
8F9D2E21E1B2D41941545BAD0182F182
E806F12D29E9F873BE6EAA01CD1E1B4F
A6A77DA8F2C4102A83EED1D5216EB318
C6F7DDDF431DB0C8BA773498AE41010B
E325A12D5EBC55ACEC787D88E545A9F0
38C2C9FC38AC2F424C8D519FE7BF988B
BF228451A5AA3B510CAAAAEF62613063
D52AC9F2B6477D1CDBE5E32F96497937
A9A4D9ED654B50C55143A93AF35088FC
7F65261B59B6FE49C42DF93784F80307
A4FB4E20F1726B15A57A1AA1633BC77A
9828CB3573D3C40D63500CB1F9461C1F
51E3AEBCB31617B0A5EC1A48877E9A70
80B7E9D1DF9155BA2277817B7F1E06AE
49E983E1361F11F5205CDA4289B71003
E1735A9FB21570C20964C678C95CB784
411E2E77A63C8896D477258761988C66
1EC742C43B8616FAA9FFACED52B88095
484108EF9B01A8C8DD769B46C9B90EEF
C83492F3B2F1F6305F4923DA15EBA273
7F665CAECEC63F45013C99D81EC447CB
BB6882241BB572C3AF3E198490C83981
3C3AFC055916156465DC1A481D9E9D04
BF42A2AB482FBF15B10B48CD50B857AC
83100BA2D5053EBA42A0F7B1E790A194
BE543B16CE25C04DB2BA08E38B4243B4
58CAB99FE371CFE26EEFE32A9BEB9C96
8CD1C44A6F041A965C4645CC9DAB8797
BB4149A393D08C6B8F9EF3F89BA25552
376E71CB4C92528ABE7D6FDC9CBCDA09
77F90D0679B70659DCFBED317724FAD1
9153C9C8AAD9E53057C0869DECD75472
A16DE718D8908FFC01DD297FEA600583
CAF520AB0C23BCE70BA0854832368591
486D0900B48B18D315367260129BFFB6
BABFE5F6C9B660265BA92AFB8EF9FC8F
B35A6709200CA19C780383357D108577
1C3229D4D4A35F3B2CF55DDE509CA94A
3A5D4B43580D9631A7F35A64181A35C5
F81A7FACD9640F8169D8DE2E27D217E6
F953F00C82353F3591EC20DF652B68AE
A153C00220FEE4D83DF879F7D5A6CB07
B0B5FFB7FD2BC3637AA7F70832957458
4896DF08BAF68522FA05E3669EDD4528
17525F1BE9060CC23A8D0A2CC76C439C
A6E7F3C2692459390F24A912B447B433
7DC72A0249398C477779B804F1EA3454
222DA52480ED3CD33C632A351A40E8AD
52B07E869C01CE684AD503F8F9445125
2FDD16446C63750D95AAAC6F6B41CB37
786AAA96746C4084190340D4B8C4710E
88E99CE30B65345ED0B118869B6AD035
3C8C2110DC4556D3E28568CA68172047
9225A1F12C539431CD0217908688C4E2
B22F17D065D62FA2F622CF1B196F92E0
DF2FC56E807EAF16E852AEAB67E0127A
Query:
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
Answer:
user_pseudo_id,user_first_touch_timestamp
BFF00C0BEDC08F406D999413584797D5,1534390382577000
D85672E8322401603F6706560AAFACA7,1534359769094000
1C9927831BAA7A0569130EADD6320C69,1534365421765000
19B5E340A2D84666E5178E237F29A22B,1534359288922000
BC575A719C37E1C2237B79FE7FD3F7E1,1534332267576000
814700C58B117F7ABFFB1145B9C29D29,1534381476043000
AA287C3266DB6069B75DCBB51006D808,1534677751935000
ACDEFD8D3F601128F8B6B55256028E1C,1534715312915000
B16AA0715E1721E18F4B9316E4A0B3E1,1534663729009000
BD2A511409EB3EBC45D4CEB4F876ED49,1534698969233000
27951B102A564E3FF875726564A141FF,1534731248353000
B7F7B01204A87A92985FCEE1F9880681,1537611783445000
92BA07C5AF1103CDD804CDA9F7199B95,1537628269767000
7197BEF5542521683ED1B58EDB184770,1537627322862000
7EDFFF7CB9DB49F6C61708EEBA33A32D,1537643035618000
BEF5D5FFD58E3C06524EF00937AC7E5A,1537628880652000
7D87123EF025F4B3A92359C10CBD8039,1534486845129000
F108523E7DD7905608275CC84287B217,1534454476027000
71AAE70AC95236B7ADF665241789A2DB,1534415939503000
342C835CEA858EF92FA64D22B41FB031,1534480865986000
99102A5913030C7A0191F37F71BD00BC,1533217834826000
95234F012736091D256010A811C5A25A,1533219207305000
A8772128307051043124FE8443B1C326,1533256509394000
5835395BAE5D85478439107727B8EA99,1533256969947000
C0D247C7C087F68E0504E5B5E5BBFB11,1533203398797000
942E123C7E8C0B62935889D03D77BE8E,1533236443628000
7432B1A3C0CB18E6BA5E0F14F1105980,1533261856075000
0AAAEC4E502388A6A087D2E70BDD2BEA,1536857936138000
AFF1ED962C29150288A2946235923125,1536862632351000
42FE551121362B71E141D291CC7AA4E9,1536840086036000
65F8E2B80A986C0FDF372EF08A031483,1536894048713000
596FCBD95E3C6C24EC450B4BB7F12D18,1536855961339000
AC14AD9D158A2A5449E120A33D5B55BB,1536867225978000
8E150A8839C964819CC821BABA13E2A7,1536828111139000
819D386099AA9B435B3F4B261D3553F9,1536900346679000
E9C87789BFFFA2A2D9E45C0CFADF855B,1536846941782000
1C261CF14E530870D1889225A434B8EE,1534822950496000
DE860F06A62F2D530580702B72BC40F9,1534817168565000
F28C2C5AAE32E559874444F7F957B297,1534764356362000
C4E5C52AE26E9B3FB89B260C983DE73C,1534808712414000
BA6AC3E59787946CFE7804B39352E10F,1534803941628000
467746D404740C181366195C8CFB829E,1534779021606000
D03DB5B7CD510FC8309C5681588A7C8B,1534791823769000
18B75DE6050B93995ECCC72794B3BD38,1534749364195000
25777661D3D36C3E3656E98F29441CD8,1534787985825000
234995B94F9D6393EC3DF219345100F7,1533994739840000
35D099424972413F3E46BFCA86C15295,1533993955264000
9B0D690097928C177E91E2724871BEFF,1534007975166000
FD7785BC8C792D50EFCFC8BA128FDFF8,1534007311741000
469473B2E1C330A74286BA52BA3CACF5,1534056552701000
Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) <= TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id
8F75FAE8C9129A7B666A7DBA014898E4
D8B8615DDE319FEBE0A2AC1364E2C2EC
7E74A2BB6BBF4746DEE15F957B315401
50D529BFD3EFEB1C8216DF9A321A552A
74EFDBFCB53D83E8725D95130BA74879
7EB0099C021CF1B2C0688CB1C9D42ED0
8B38AE00504B75A9ABAA20843DF4976A
DC19D85E54278EC4524A1C057042FE2A
8BB6E580D7771BBBE04D3953EA43F640
59C79351BA65506A00F8F940CC9EB337
44E92076C1E351471915CC98615610DA
280A7B998E88ABACD33E131F24B43203
AF06A87FD3FD797F7FA3A44DFC445701
C1CBEBB972ADB547F2B4B9F3FBB44E38
C3E3CDDD1E35362AA59854F8FA511BB0
45CB5196EB384766A8EDEFEEF410CC23
A62611DA6D4B45AC3DB2450BF3A24C23
23FD6C65AB271F4DD5FC2FDEA888032D
0BF28246916A6D54E16290E925B16593
71B1D9279ABC5D66169F2937CFB9DA47
9FE14774A6A768A1C1BEBCE0DE0669A5
5F221A89D8CA4217F46AEF4C5D9C925E
F37600D4287F1C83A90F3A8CE687FAA3
A2BA4DC59DE828E7FA1A3D2746162D86
1440D2F8CDB64BFAA5621779B8C92571
C40F22701672A6B7AFF9F4F6FBC235EA
E98C2033935E43DBA50950F7039FF492
D17D42F01E95FAA1D5083EFE4D319503
3686DE7B4C85F5F0AF385348F03492C9
40F2087822D412D2D481AF043DC7DAB4
F37788083CD17FEF93F66A5A8CFA9BCD
A5C898B900B93A5FB59BDC3B712F3280
F36F1694CF053FD67EAB62D5E773AC03
1FF5408483DCCD0779F33A5808028D60
ADD0757874A418957AAA60903AA5F62D
4F09BB9CBF9E3C4A742B1D8B42D2E60A
03915D9B9DC76855CC63C18E94C93760
A0E4CBC39F80333CD04752389208DBCB
C5558CE95739F785A76DDC61DF770201
519E294A309B0BD4DCF5A5E2A2CF9F2B
AF7F48274AA5128EBCF3698F4FC8F61B
A098D049A2C05C32BF7B63298D23C663
334C732F58847B16D90BAEC2116B264E
18DDB34FFC32730E29506AA263F6A6C1
A0F4501358BD3CF59B5EC6A7C6A33774
32C8AD4EFA93405A282CF301BA211D7F
26F3A02677C6F21DFE2A00C213662D8D
B5D5EECC05D20983F8E3729AFD3295C6
C5AD1A3C5BA7749BBA184BC5138E6090
3307DD0AEFB45F2AFEE766A57E2EC357
383F4B98EC31DD2A915427D36A30354E
1608F85B710EC4AE0024BB8A1C339071
FDFBC68590B06B23FACCF2DE6A0FEAD7
2CCA4395A5281BAC61DD7C846837F50B
287443FC466C3CBF107AE8883DFD0883
4CC453DA57531954D7C053B93A20B5D0
5D95913421F680D074FABD099659B0ED
5C78931CECD78E8859AE89BC89C5E26E
CFA741BB81765E66DC761EBD78D41B96
8E10315E9B341E6371BE0055C7B29A68
359A34F575B808FEFE58BC5B40816F09
AFF1262CCD472757FC92B2A93C75CD81
63FEF9F33B5B4155C207095EBA23730A
72BC8187FDFCF6EF1EDE6613D01A20C5
D744C3C96CC0E370DB6994F28C1B03EC
0A7FCCDCB40A322AE53E43A0A0D099DB
BFAFDF13A67B045E96563CEB5B49E1BF
5A9A3E94580D662C817FD51B5C1D7E7E
27C88E1533471126F779ADE591D7915D
5B333FE2BC3875C6C3882279B51B8BAF
75711C3113A09A2976DAA5A0D8C3E84D
DD0C9E0425155960EA9EC58314A22431
2CE9034DB5A27398581F1EF3635AE813
21E8180ED9407AC6381243A802EE8F61
84F55D39B331B4D51467A32FECD5F0A5
36EB2A55E0FD24E93BE639443614DC49
45DF5BA054826C546308F865405709B3
9AFF07DCC4DC8276854BC916473FEDDA
6D65D0B8B0EFB8CD9C939252F2D9ED22
46940B869F002DCFDDA860189AF77F23
E15CC599FA923B9D51503DF30CC3A40F
814700C58B117F7ABFFB1145B9C29D29
EB18B2001B1A2D61AC02C803D66689A7
3BBBF9670FF8A13D25833DE6965F6555
F652FFF92DC543ACF621ACC7511B3822
0F9FA601689A8E3B9A218B35CDB6C219
DD9205509DA2F9DFA16544716C9E3C35
27951B102A564E3FF875726564A141FF
97759BD40B954E54A62EF85F077658BF
31C6D36C0D121E1F749FE645D7C7DCAA
8E68D3D802E39F996CD4B6CF78EC23C5
737A4B3FA732A68EB049B71E5CF15550
0C8B96426B5C39DCF5FC7B033270434A
Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id
023A2DB99CC3F70A4B71869C36952D74
0DB2864E7EC7D29DA4EC1540FFDC419A
8B025029A4D1695C7BB0AA8BCF15901B
CE14E78130328FCB4C3DA6790F5D3F7E
4BB019F8F6D1FE7BA78CA42A4698EF56
9F7B0D1BFB822F5E26E91E184E2E437C
706C748E6D1E0768BFEFE6362B5D3F67
E6FEE8B98E75EA5311FE004F98559A27
4AB0441290F6077849CBE9C74A828F0A
2F48607C41ECC4015FA296500F0A2C4B
CE56946091344ADC2D0AB88D49B83ED1
54B8D30BE1F3471830044059A37419F6
0CF1172485E8FC12110F04AB2374B308
07EFEBFA43A67BC7482DA6FDEDBDA2E2
40B224DCDBE486DBB2D13E81B285589A
3DEB0C12C49AD19D7ACE68FA59E7ACD6
307AC87B6D76A6A1A19AC2B11E3FA4B5
B71CB5D517BE99FEEED64A0F57842032
90315F3CE85BB427F960EF2F78972EA6
59454BAC415BB1F18517C6FD2C023E49
428FFFFCE9294F6707BE5D9DE31171FF
53866E32BA0ABFD846772D4B7B9B5921
03A9D32C44665A9E15CFCCEDC9F68EDB
2F2B5C88B72A5253AAF448B1E29333F5
988E20C1031C6FA5301C7D2FBD90A4BF
88AD03F6828BDD86AA72AA556D87387B
635808C1DDFBC662DC3015097E26E62A
C1BDCF7765C5EDD7643D476B84BD2B30
B5FA3B0588C19181222FCE3135DB3452
9A12E7E2B3CF644B8304DF8E1A9CE2D8
2C84CF723999D48F8F069AFFC184C4DC
645ADF1505EA560FF95D65650EAB212A
7E40E634997585B0C69B6F67C01C191B
D9AA0EC27AF47514DDB5C664A6EF758A
74456352647C13028F89D1EEFFB905F4
FA30269453141794E79B8F15EE0BA5B9
DB3B6E984B29883EA02F1A504A33730F
B63075B53A750A67A12F7F19ED5AA835
F1555004E0D95599AF2F2B8EA130A9C3
A9E807665E94FF89025596B115E09C5C
E989ADC3B80B10A564559A60763BA8D1
D79D77E3F2698B89279D7C35AB034992
91A06057C6272653B6006D7A8791DF81
757F371D73A59AA7B6FB5CF1E6483B33
361AC2578D8F5E3FFF597136111A94F4
D5F9D9AF22EF5073E10342973D48FB2C
5DE4C3F6AA9E3D2D91EE22CF1ED0B0F3
BB29F8B0FF330F326605FA421BB37BC1
2F72E1976C24D8DFEA138BBCFD304BAC
7D7B319DFFF03520EF50236B2C3FB008
E36C1A5299789BD1C3794ECBCC0BB2FC
328DC7FE55E8881B2EA668C9A2855BB7
5E09265F12D64B9FA85FF9427A0A7FB0
00B6295EC351DBFE0E31015296871E35
5B888A06EFF60B86B10367EEC3B44E85
064753F4DE400882CBF47644C9FCF8EE
8375B114AFAD8A31DE54283525108F75
8367316E48117FEBA6749BB268DCE349
F1F2C328BF34010DBA50842CA03956E2
BBDCBE2491658165B7F20540DE652E3A
86C4C88BB61CB464B3413875591AD4B3
FB49D03591104FB4CEC600157C3A2A0F
3D03A380687FE3369E93915D50C572CB
A6C87EE4B7B875BCAB0C650365236072
EEBCB25D5F056CCF59DDE654388ACD2B
E8E15D7E878B4D8030EE44695C006183
4FB9AD5448A1595338954689FD588301
A19F659EA9BA36A3595F088F30A6B7E7
709FCE78A03255D6EF6678E1D98783E7
487DE902636DD8A9844A2D61FE7BD568
E512079B53179DF9A608CF4ADE47DE9D
8D9D62A4402581BB1181D3AA73AD54E8
17934EF7C1BC1CF2C7D942401FDE84CE
94DCA111F00495D16D2D36CBB3879EEC
3C58946C3178392A69D292F2F5A862E3
2CA82928A35949DF7775D4BC04F0AEA1
620DA7A49F07368EBCB917DB113BCEDC
308452C7E6D227ADD8D3F0BC2F267D1F
4640585DB6878F93C3212012A2A03348
2E032EDF0BAA6AB7266FCB4FFA6ED543
937D215BDB6A9A3A2AD378DC9BBB23CB
B10AE521352392E4981BA07E0D86081C
BA3E7A5857FD7BE68F02E4D2F5744BE8
B3A9A38A561B3648D280614B8E2D8E07
C7E2273D8B11257FCCC915D27C1FCA24
5FED8FE4B11878AAFC4E53BDA3FBB56D
7A24963AB998AC045AF363D6DDE7F169
DCA93021D42484CF03D9BEE4C40C329A
93A7A5C31807490E878F4164A6418BFC
661DE248B0C158E25B5808B6661E6625
B8FE9AD137A133A89389656F7989B36C
2F0F260BD7B876C346B41977D0D03D62
CB04A70ABA1698F2554492072C199E39
Query:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS total_installations
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
LIMIT 100;
Answer:
total_installations
2647
Query:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS active_after_7_days
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
active_after_7_days
6615
Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND `event_name` = 'first_open'
EXCEPT DISTINCT
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id
9635236AF20F767026F4974060D2F680
B27F6463047977351E76AEED8456E9FF
B175B187062693360BCBADC4160F8D88
4C8514033B25A1B49E85B8C0240C6C3F
6551148F681F9DF807FF3624EA5DEFA8
F76196A143B56B420C9EC1FE89220998
8D76B80E2CCAE0EDD0F2D50D1ABCC0B3
3309F4DE80E33A212A45B29D973EBC9C
B285B6DE14EFCE4E5F460B28881666A3
BDD854D198AD34410E91C75C2ED5F525
1F58AAA40540B7B531EF090A0669384E
66163D6663552C5C43D3DB1D98FCA9DA
F37D0945286059018632F1151EFE1AD3
2CCA4395A5281BAC61DD7C846837F50B
C30D1BE029EC04653434C68C708C73BA
8AE61BC30F02ECB3AFC1B6DB91FFDC4B
370631465168E174D7D2305DC0DB120B
B82ED5B2461E8E16AF0375FA754F6083
46AE1B2A500BC810A363BE6C9B56EFFA
C3E3CDDD1E35362AA59854F8FA511BB0
5F221A89D8CA4217F46AEF4C5D9C925E
C1CBEBB972ADB547F2B4B9F3FBB44E38
0BF28246916A6D54E16290E925B16593
71B1D9279ABC5D66169F2937CFB9DA47
DF580CA44730C9A892FBAB19B7358209
7AA56A17CAC37BF7E405CF6AF2AB52FD
B16AA0715E1721E18F4B9316E4A0B3E1
8BC5986635846F60ED5D0E9F67E52CC8
46126D2798E42A3DC3A0F1AF24BD2555
4E5647A455805C83E587D11EFC1EBAFE
5AE684C539DC4038371EDCBF649BFED1
5818B5DEE7C4EE35F531FF5ABE0475CC
4B44B78D8D8D507D918890F2B26E20E9
DCE678124B6F7B9F35BEAD1882180A68
CA9136455F325D81B4A1FC232A7CCE43
94B02BA3020E382B3456932FA88A03AC
83D42C0BEC5C0325916E5797073CEE9A
289D738E3B01C988983B957444571412
8C2CA6A4B27594E8E363819DC8A8F4D0
575CDA26268871E43230F53F87804994
78A7C7D9BC2138200C3B37E3C7CA8CE8
949DC369B1AB32FCB10B9D6E4B367DE7
2927A9F548849C44AF989FAAA4392517
E6D3C4CCBB6066217EE2A2A69FB25E7C
DCEB9A1F6C5B9B67F0994C7A7388A8C1
21E8180ED9407AC6381243A802EE8F61
B72C3DD50B9F81DBCED2EE06E08796CE
3CCC49DD05DF89B1B103E2C22366AA0C
5D3AC32A3431337AB937BDAF886D1782
D5E0BD50D8A6244443E08E2E71B3739D
1BA8A3FE9D6AD54C6C77BC8A350BF2DA
2CFE23AC4E3C6529D39BDADA1EF99C52
F811FA3ECC2BA9F049E5A216FAFA301B
26F3A02677C6F21DFE2A00C213662D8D
533E79DF88C5D3B27AB10A32F8185503
7C2F5BC71CBBC77D23A91859F437F5D4
C257F5C497C17E2661785F4AA970A532
DD9205509DA2F9DFA16544716C9E3C35
F183D1950EDA9E115C8C05A84E42EA62
25D990A548748C1167DF39EDD1A61019
1ECCA9BFA4F04D96DB287D32F05A6F6F
029EBD2B01A3857606BBCCC1AF8992D4
AFDD4D9A11CDD36BB20222F82D62123F
0CC5E5E794CB2FA570F8E6076A4022C1
5C97A22ED49A8C349246F6E2737D6384
44E92076C1E351471915CC98615610DA
D951647AC8133518776B4736475BF1D8
C175523CE4F5BB5E65A4EC3CF6B1345C
7C8D8B75790229C5B05F6D31E9BE6254
7814B0C31DD814CFAD6DA4E2B4C4EEDB
2BFEB4CBB17A39C8EF5E5CADD928D780
B871DE19EDBD041D11C5BEF3A616995E
C8F8D0690CE62FC1DEF00A5B121BE251
5835395BAE5D85478439107727B8EA99
1B448720A92D5A61CA428042BE55EE7B
BA68AFBA94C53DA2DE67AA683078AD2A
12D15CA29CFE3CBA400CE28F31CDFEFC
B8ABF06C01AC9AE51849B42460E2E560
9768367BE6132B5C5AD84DD63411E2E3
D864D058813F31B452BCE6743B0AF7F7
7BA1098EE744CDED1FA599098513BF43
9CD5898126E744A7614D790C2C67B052
CB206CA46FDD13AC2030F27E7DC54E26
E39D2DDDB7095CAB4D000D357B00117A
98001421668C25D7C0B41F550C53D949
86351452DC4746F0D4ED2A87D528D915
633843D8A31D2F78A27B35B77CDCF620
BF0BEAAEDA831B1E974A03E38CA63058
8235CEF88E270F8C33F9218633A421FD
C337446FADC0FB49C18BB3C9C86339B6
14811D9D29E86F3AD408F1AAD953DC60
F36F1694CF053FD67EAB62D5E773AC03
8BE102266AF2AEC727AE08D0A5241DE0
Query:
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) <= TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id,event_name,event_timestamp
69541D4D4F182FBB46C3225DA0077DDD,level_up,1537368514185000
69541D4D4F182FBB46C3225DA0077DDD,level_complete,1537368459185000
69541D4D4F182FBB46C3225DA0077DDD,completed_5_levels,1537368476185001
69541D4D4F182FBB46C3225DA0077DDD,level_up,1537416941397033
69541D4D4F182FBB46C3225DA0077DDD,level_complete,1537416855397000
69541D4D4F182FBB46C3225DA0077DDD,post_score,1537368463185004
69541D4D4F182FBB46C3225DA0077DDD,post_score,1537416878398036
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537368399296012
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537368433185003
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537368514751008
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537368463818012
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537368532065011
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537368520065012
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537416675099012
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537416741746016
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537416735746017
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537416745752024
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537416722843028
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537416932397035
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537416891813040
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537416928909044
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537416988024007
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537416962024008
69541D4D4F182FBB46C3225DA0077DDD,level_retry,1537416995902018
69541D4D4F182FBB46C3225DA0077DDD,level_start,1537417005005023
69541D4D4F182FBB46C3225DA0077DDD,level_fail,1537417066179034
69541D4D4F182FBB46C3225DA0077DDD,level_end,1537417112179035
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537368408646003
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537368434997007
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537416626398003
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537416696762007
69541D4D4F182FBB46C3225DA0077DDD,select_content,1537416661546003
69541D4D4F182FBB46C3225DA0077DDD,session_start,1537368397236000
69541D4D4F182FBB46C3225DA0077DDD,session_start,1537416707433000
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368402718004
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368375090008
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368501344007
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368477790009
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368527108002
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368516985008
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368570944015
69541D4D4F182FBB46C3225DA0077DDD,user_engagement,1537368578655019
Query:
SELECT `user_pseudo_id`, COUNT(`event_name`) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180808' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `user_pseudo_id`
LIMIT 100;
Answer:
user_pseudo_id,event_count
7153341A14B1253A46FD8D6DE5490EE4,3
C1648883A80997B611743D528CBFF926,672
E3FB1ADEE3426B8E0EFFE7CDCB73BF40,62
D5F25FE843F01514F448B1AA94028D2D,53
804FAFFD6840372D64162A82E288E872,15
654F30C1312F6C1A26DFDA9F076A62D8,406
45FB547C5857493104687C234EDCDE37,949
CA374E053CF35114C98D40A23CAFA777,22
0409A1CE83D1D4DC0F01E2DFA44ED555,389
5346C62F49BF2E6C1199456F16604B3C,65
B2F661E88136265632545A030F09A88A,1
7D613AF4DA0F508C7090E96FD73B7E6D,7773
DAB972641CDD57B498702CA343A4ABCF,1
3A4F5028A0CA512C0E2CCA1F36CE160D,440
E80C958E3C33898989A30B8F5A4514F0,2883
9DE7361ACCDEA6541AD5EA55D59B1C78,644
60603343AB8FEECD78B1009C957D193D,960
A0E93D033E25966AB516BE78D143DE7A,1117
5C351EE241AC7063F3B64F96F3A7AB3C,16
2B0D8BD127A58843F3B4F8C8FE50CD77,75
05FB3382D94C7E963B408FD6CC357D33,21334
CFA0F8C5E25A71062E573EF8E6BC9F76,4684
E1276C0BE9F4591AA1068726811F20F5,25
D45CF251C60626FDB4BB8D50ABB7BA46,594
959635567E419A061EECCCA478EDC718,62635
372D9BB5088C4E9000C65B06459B403A,7629
FEC0B30EED7870C4D46230D73032E5CA,1555
4F7CAE5C86F09A791C3F9FA77C10E833,249
86F19DAB73E484FB7DD2F805DDD7957D,10953
5E8B4AEF7E3373AA78408DB08E72E3B8,2312
4EF964D59282E5A2C8692D30F011256B,11054
818B7B94997904AAC3FAD9106425AF43,59
77D5FF20DF909CDD790ED52FC94AF7BD,167
396CD60DADAB9CBA7DDCAF239B477135,6496
0CAAA1B6F161BA4D363EB7A2DEF64A08,8647
D6F5820E5B2C721C1677E1BC873B074A,396
835765A97BEE13977198CB622AB23A8E,1
B5F3D00E28A57C9522F2DEE3CB903DD1,2319
4EF1041DB2A406750E4A46AFD78FB543,86
DC8912881CD30A0D8D5E2EB666D22901,162
7D47E668B7B94D57C9295BE5B78D26BB,15
0C777BD44F304574371C97674DCD0702,4586
BE74418BE7B7466F6FE2969CA79FA919,3522
CA04708DA02378999ECB402481FF1AE4,7239
8252847DECB3C31CAB9BDEE566F97BA2,860
56E8EC9522573BD1BAD8E18AD2E33C9A,3271
D47DCBB00B2B462C916A5A07DCFAB039,423
A0616D4E494DC3BCCB94B8B6E5B48380,4637
94501F48A0A231D442FAE2DBA258FD18,15
751F1516AC974AC343F62070D3BA39F5,1279
682A8CD0767A569DC68E7AA0201BFBA3,3109
D299D5763E03F1CC4DA8550AF1B4CEE4,1085
6A07135DA41B81E278341576A26672E4,178
9BF56DEE5166364944BDF61ED31E6F30,49
A1927ED722EA16A3B82E7EE0FA22FF4F,1314
058520E12010190322386C3E356AEE8F,1308
65F7D86346A4002519B78D2E405851E2,65
CE3148CA8DACC6B0D0C5D234186008BE,237
9ECE81C526D4A7F85115B8D9C398AFC2,149
C962AE7EF8A83B7013D2610349D7D36E,237
75120F32A68A6C4FB643349E125D8C31,7238
F580B62369D32FBDE8928279DF764711,981
F5DAD8DD17B689CF672D65A0A81CF4AC,6506
95BC3B2233ECAE0717CC70A45315365B,1096
7EA86ADA1763724469F41BFE017D43C4,1
018219C83A4E8873F1CD8BA8F041E8BB,10
82486A3B62D50DB914F1C6857733DAB2,481
3D1B58553D2E2D4DD5DFCF251D5E23B2,923
Query:
SELECT `user_pseudo_id`, MAX(`event_timestamp`) AS last_event_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND `event_name` != 'first_open'
GROUP BY `user_pseudo_id`
LIMIT 100;
Answer:
user_pseudo_id,last_event_timestamp
023A2DB99CC3F70A4B71869C36952D74,1536879053022028
0DB2864E7EC7D29DA4EC1540FFDC419A,1535590497449005
58230465C695B0FDDDAE08A481FAEECC,1535838864050007
B087A865A90AD52D1864A36482983BD2,1538609273624005
F3917138A3D4B03ADA1C2E77E3B84649,1538591342852016
186F51E5AACB37852E3650E7027E33B1,1538543065313007
04EB70477096F5CE71C59900BDC3EEC7,1535537740974065
F9D11CF4FB7EEF700D4B71A641E4EFA3,1535530855309000
2D2FD11BEC057DC5ED96DD8F0649A36B,1535547492054000
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1538623374135024
6A70F62D607470D466B836AE98E8E838,1535569000224003
920DB84FCC0F4421650B9E257E33180B,1538313567869018
757F371D73A59AA7B6FB5CF1E6483B33,1538608909982043
E2C73393E938B51088B200E971667B8A,1535544404814064
DAA3F353F320A717A0C418A8205292B2,1535544667037244
FF20E4EE129C3700FC1C6CEF188E17BB,1538376339028003
DC14701AE5C2808151BE7008898B13B8,1535828720527059
BF709EB51D61C3A7BF68C4CFD7F236BE,1535856976721001
03A9D32C44665A9E15CFCCEDC9F68EDB,1538315171619000
12C60B55FAED4052AB2825241E7770DE,1535571118746003
13AC12EF4C6A0EAF72795F720752AD98,1536005212069028
635808C1DDFBC662DC3015097E26E62A,1536397843606162
82EC0357F7A97115EB30AFC798B49EFA,1535608423523001
CE14813861706B30558A91E503E4CA4A,1535569776291003
E512079B53179DF9A608CF4ADE47DE9D,1538596335726009
0478941CDE0699903455E8A6A95546CD,1536075096373000
CF092C279C3407DD69A44008D7511A2E,1536205862933012
424C01CD3ACB4454BB6B2D2899511997,1538533914383002
C8512BCE348E996C81697F6BE81F8B98,1535594210630021
301AFECE7DEEE17ACC059F6C18017D80,1538246644552129
E42066B3F588F26AE64518AA41805F62,1535601460970000
CB3247B1C1CDA46A0F086191DB3FF5B2,1535871010760001
B7E1645D07FE202F218A6EECBE0FF16B,1535648626221000
53A5A4C271525BAA74298747E100C376,1536559837660001
E5A2CB7A471E740E758BE5E2E0C79BC2,1538560702824014
65BF56455C9B2CAFE68AB07D23A7EFF1,1535550068083007
74375465CD17299EBC7C75A1B4047EE0,1538625997917039
F0133C453901CA70C9101F0550E81AB3,1535575671245000
6A07135DA41B81E278341576A26672E4,1536944091914019
8CED53DF2E18FAB2FCD5297C0CC860AB,1536642234031000
85F571A8A9878C55EB15F93449EB5447,1535792746592007
D9FEC4E4418413FCE771B203FD7D48D2,1538567771698041
096C23E69254818F7EE03C1239005F2B,1538204172078002
7C7E71D0478D9A96AFEB74DD80521DF7,1538171865624005
A77FFAEE0FD822CD7F387ADA352EDB12,1535673532863016
A8D7DCCA39D8703F2928AD2D7BBB6BE9,1538617196272007
65D1701E5BA0070CCF15F0CB0E1CF750,1538121375591002
DF0E6C6C5E4F3F34FEC6EE54FD945B05,1538606651409102
4091F647A1B6367AC7945DA0917CDA7D,1535535106376001
A48E8402E01E93E43524A2746524FF73,1535778271789000
EFB696A82D093B3AFBE92FF526DD5CEA,1538620924186002
62DD70123C14207F97E6515DDE77D76D,1538596130735005
40B501E0460E254E289A776CFC31DCF2,1538618986315004
End Exploring Related Columns
Task: Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Percentage_of_users
value:0<=float<=100
(Attention: answer in one row)
```

To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we would analyze the user activity data in the `events_YYYYMMDD` tables for those months. By identifying users who installed the app during that period and tracking their uninstall events within seven days, we can calculate the required percentage..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-29 23:58:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 23:58:04 - root - INFO - ```sql
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL
      -- Continue listing all event tables up to `events_20180930`
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL
      -- Continue listing all event tables up to `events_20181003`
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  (COUNT(DISTINCT active_users.user_pseudo_id) * 100.0) / COUNT(DISTINCT installs.user_pseudo_id) AS Percentage_of_users
FROM installs
```
2025-01-29 23:58:04 - root - INFO - itercount: 1
2025-01-29 23:58:04 - root - INFO - 400 Unrecognized name: active_users at [72:19]; reason: invalidQuery, location: query, message: Unrecognized name: active_users at [72:19]

Location: US
Job ID: 3b8eefd3-fc67-4778-8aab-14abe3284784

2025-01-29 23:58:04 - root - INFO - Input sql:
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL
      -- Continue listing all event tables up to `events_20180930`
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL
      -- Continue listing all event tables up to `events_20181003`
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  (COUNT(DISTINCT active_users.user_pseudo_id) * 100.0) / COUNT(DISTINCT installs.user_pseudo_id) AS Percentage_of_users
FROM installs
The error information is:
400 Unrecognized name: active_users at [72:19]; reason: invalidQuery, location: query, message: Unrecognized name: active_users at [72:19]

Location: US
Job ID: 3b8eefd3-fc67-4778-8aab-14abe3284784

Please correct it and output only 1 complete SQL query.When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}


2025-01-30 00:02:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:02:16 - root - INFO - ```sql
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180930`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181001`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181002`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181004`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181005`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181006`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181007`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  (SELECT COUNT(DISTINCT user_pseudo_id) FROM active_users) * 100.0 / (SELECT COUNT(DISTINCT user_pseudo_id) FROM installs) AS Percentage_of_users
```
2025-01-30 00:02:18 - root - INFO - itercount: 2
2025-01-30 00:02:18 - root - INFO - 404 Not found: Table firebase-public-project:analytics_153293282.events_20181004 was not found in location US; reason: notFound, message: Not found: Table firebase-public-project:analytics_153293282.events_20181004 was not found in location US

Location: US
Job ID: 4db5e381-d97f-49dd-b627-7f72f5d9e027

2025-01-30 00:02:18 - root - INFO - Input sql:
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180930`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181001`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181002`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181004`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181005`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181006`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181007`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  (SELECT COUNT(DISTINCT user_pseudo_id) FROM active_users) * 100.0 / (SELECT COUNT(DISTINCT user_pseudo_id) FROM installs) AS Percentage_of_users
The error information is:
404 Not found: Table firebase-public-project:analytics_153293282.events_20181004 was not found in location US; reason: notFound, message: Not found: Table firebase-public-project:analytics_153293282.events_20181004 was not found in location US

Location: US
Job ID: 4db5e381-d97f-49dd-b627-7f72f5d9e027

Please correct it and output only 1 complete SQL query.
2025-01-30 00:06:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:06:49 - root - INFO - ```sql
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180930`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181001`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181002`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    INNER JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  (SELECT COUNT(DISTINCT user_pseudo_id) FROM active_users) * 100.0 / (SELECT COUNT(DISTINCT user_pseudo_id) FROM installs) AS Percentage_of_users
```
2025-01-30 00:06:52 - root - INFO - itercount: 3
2025-01-30 00:06:52 - root - INFO - 0
2025-01-30 00:06:52 - root - INFO - results: 
Percentage_of_users
21.533811862485834


2025-01-30 00:06:52 - root - INFO - Please check the answer again by reviewing Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users
value:0<=float<=100
(Attention: answer in one row)
```

To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we would analyze the user activity data in the `events_YYYYMMDD` tables for those months. By identifying users who installed the app during that period and tracking their uninstall events within seven days, we can calculate the required percentage. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users
21.533811862485834
Current sql:
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180930`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181001`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181002`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    INNER JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  (SELECT COUNT(DISTINCT user_pseudo_id) FROM active_users) * 100.0 / (SELECT COUNT(DISTINCT user_pseudo_id) FROM installs) AS Percentage_of_users
2025-01-30 00:09:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:09:01 - root - INFO - ```sql
WITH
  installs AS (
    SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, user_first_touch_timestamp, event_name FROM `firebase-public-project.analytics_153293282.events_20180930`
    )
    WHERE event_name = 'first_open'
  ),
  events AS (
    SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp
    FROM (
      SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180801`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180802`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180803`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180804`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180805`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180806`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180807`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180808`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180809`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180810`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180811`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180812`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180813`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180814`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180815`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180816`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180817`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180818`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180819`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180820`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180821`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180822`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180823`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180824`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180825`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180826`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180827`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180828`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180829`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180830`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180831`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180901`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180902`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180903`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180904`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180905`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180906`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180907`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180908`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180909`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180910`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180911`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180912`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180913`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180914`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180915`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180916`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180917`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180918`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180919`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180920`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180921`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180922`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180923`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180924`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180925`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180926`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180927`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180928`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180929`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20180930`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181001`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181002`
      UNION ALL SELECT user_pseudo_id, event_timestamp, user_first_touch_timestamp FROM `firebase-public-project.analytics_153293282.events_20181003`
    )
  ),
  active_users AS (
    SELECT DISTINCT e.user_pseudo_id
    FROM events e
    INNER JOIN installs i ON e.user_pseudo_id = i.user_pseudo_id
    WHERE TIMESTAMP_MICROS(e.event_timestamp) > TIMESTAMP_MICROS(i.user_first_touch_timestamp) + INTERVAL 7 DAY
  )
SELECT
  ROUND(
    (SELECT COUNT(DISTINCT user_pseudo_id) FROM active_users) * 100.0 / (SELECT COUNT(DISTINCT user_pseudo_id) FROM installs),
    4
  ) AS Percentage_of_users
```
2025-01-30 00:09:05 - root - INFO - itercount: 4
2025-01-30 00:09:05 - root - INFO - 0
2025-01-30 00:09:05 - root - INFO - Total iteration counts: 4
