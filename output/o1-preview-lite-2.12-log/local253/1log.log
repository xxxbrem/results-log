2025-02-11 11:10:34 - openai._base_client - INFO - Retrying request to /chat/completions in 0.468863 seconds
2025-02-11 11:11:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:11:52 - root - INFO - SQL:
-- 1. List all distinct locations in the SalaryDataset
SELECT DISTINCT "Location"
FROM "SalaryDataset"
LIMIT 100
Results:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai

2025-02-11 11:11:52 - root - INFO - SQL:
-- 2. Show all distinct company names
SELECT DISTINCT "CompanyName"
FROM "SalaryDataset"
LIMIT 100
Results:
CompanyName
Mu Sigma
IBM
Tata Consultancy Services
Impact Analytics
Accenture
Infosys
Capgemini
Cognizant Technology Solutions
Anheuser-Busch InBev
Fractal
Embibe
Amazon
Google
Flipkart
HP Inc.
Wipro
Ericsson-Worldwide
MiQ
Deloitte
Microsoft
Genpact
Fresher
Société Générale
Flutura
Fuzzy Logix
DXC Technology
Jio
Honeywell
Affine
Philips
Bharat Light & Power
Antuit
Nielsen
[24]7.ai
Fidelity Investments
Myntra
First Student
Oracle
Ola
Walmart Global Tech
Tredence
Intel Corporation
Mercedes-Benz Research and Development India
SAP
Wipro Technologies
Thoucentric
Walmart
Brillio
Great Learning
Gramener
HCL Technologies
Happiest Minds Technologies
Hewlett Packard Enterprise | HPE
Noodle.ai
Cisco Systems
INSOFE
Optum
Adobe
ABB
EY
Swiggy
Subex
iNeuron
ZS Associates
Robert Bosch India
Scienaptic Systems
FlyNava Technologies
Nokia
UnitedHealth Group
Sigmoid Analytics
Idexcel
Citi
GE Healthcare
SigTuple
Dell Technologies
Ericsson IT Solutions & Services
Aptus Data Labs
UniQreate
LinkedIn
Apexon
Shadowfax Technologies
Bharti Airtel
Applied Materials
FICO
YouPlus
Mphasis
Target
Gojek
Blueocean Market Intelligence
CRED
Rolls-Royce
Curl Analytics
J.P. Morgan
Knowledge Lens
ascena
QuantZig
Baker Hughes
Everlytics
Siemens
ANZ Bank

2025-02-11 11:11:52 - root - INFO - SQL:
-- 3. Display raw salary values to understand the data format
SELECT "Salary"
FROM "SalaryDataset"
LIMIT 100
Results:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹10,09,436/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"

2025-02-11 11:11:52 - root - INFO - SQL:
-- 4. Select records for Mumbai
SELECT *
FROM "SalaryDataset"
WHERE "Location" = 'Mumbai'
LIMIT 100
Results:
Too long, hard cut:
index,CompanyName,JobTitle,SalariesReported,Location,Salary
1759,Fractal,Data Scientist,32.0,Mumbai,"₹16,43,351/yr"
1760,Tata Consultancy Services,Data Scientist,18.0,Mumbai,"₹5,66,756/yr"
1761,Accenture,Data Scientist,10.0,Mumbai,"₹9,00,000/yr"
1762,Capgemini,Data Scientist,10.0,Mumbai,"₹10,55,889/yr"
1763,Jio,Data Scientist,10.0,Mumbai,"₹10,37,441/yr"
1764,Reliance Industries,Data Scientist,9.0,Mumbai,"₹17,73,222/yr"
1765,Housing.com,Data Scientist,8.0,Mumbai,"₹23,83,368/yr"
1766,Quantiphi,Data Scientist,7.0,Mumbai,"₹9,19,025/yr"
1767,Axis Bank,Data Scientist,6.0,Mumbai,"₹11,93,674/yr"
1768,LTI,Data Scientist,5.0,Mumbai,"₹6,44,930/yr"
1769,HDFC Bank,Data Scientist,5.0,Mumbai,"₹10,70,583/yr"
1770,Vodafone Idea,Data Scientist,5.0,Mumbai,"₹20,09,767/yr"
1771,CASHe,Data Scientist,5.0,Mumbai,"₹10,98,034/yr"
1772,Infosys,Data Scientist,4.0,Mumbai,"₹11,02,095/yr"
1773,Cognizant Technology Solutions,Data Scientist,4.0,Mumbai,"₹8,30,959/yr"
1774,Deloitte,Data Scientist,4.0,Mumbai,"₹11,91,942/yr"
1775,First Student,Data Scientist,4.0,Mumbai,"₹12,10,857/yr"
1776,CitiusTech,Data Scientist,4.0,Mumbai,"₹2,94,111/yr"
1777,RBL Bank,Data Scientist,4.0,Mumbai,"₹11,80,704/yr"
1778,ZEE5,Data Scientist,4.0,Mumbai,"₹14,58,789/yr"
1779,Mahindra Integrated Business Solutions,Data Scientist,4.0,Mumbai,"₹9,74,832/yr"
1780,DataScientest,Data Scientist,4.0,Mumbai,"₹45,684/mo"
1781,Pentation Analytics,Data Scientist,4.0,Mumbai,"₹6,50,654/yr"
1782,NDS InfoServ,Data Scientist,4.0,Mumbai,"₹9,26,744/yr"
1783,Arya.ai,Data Scientist,4.0,Mumbai,"₹8,38,354/yr"
1784,Wipro,Data Scientist,3.0,Mumbai,"₹30,368/mo"
1785,Amazon,Data Scientist,3.0,Mumbai,"₹10,18,095/yr"
1786,IBM,Data Scientist,3.0,Mumbai,"₹11,93,120/yr"
1787,PwC,Data Scientist,3.0,Mumbai,"₹14,49,831/yr"
1788,Google,Data Scientist,3.0,Mumbai,"₹13,55,169/yr"
1789,Atos-Syntel,Data Scientist,3.0,Mumbai,"₹8,75,733/yr"
1790,Siemens,Data Scientist,3.0,Mumbai,"₹12,57,890/yr"
1791,Mahindra,Data Scientist,3.0,Mumbai,"₹10,22,850/yr"
1792,eClerx,Data Scientist,3.0,Mumbai,"₹7,33,769/yr"
1793,HERE Technologies,Data Scientist,3.0,Mumbai,"₹17,82,011/yr"
1794,HDFC Standard Life Insurance,Data Scientist,3.0,Mumbai,"₹12,21,714/yr"
1795,Morningstar,Data Scientist,3.0,Mumbai,"₹9,57,432/yr"
1796,L&T Financial Services,Data Scientist,3.0,Mumbai,"₹8,86,778/yr"
1797,Piramal Enterprises,Data Scientist,3.0,Mumbai,"₹72,216/mo"
1798,Piramal Enterprises,Data Scientist,3.0,Mumbai,"₹11,60,523/yr"
1799,Episource,Data Scientist,3.0,Mumbai,"₹8,94,949/yr"
1800,XPO Logistics,Data Scientist,3.0,Mumbai,"₹15,81,030/yr"
1801,Loylty Rewardz Mngt,Data Scientist,3.0,Mumbai,"₹12,23,523/yr"
1802,Karza Technologies,Data Scientist,3.0,Mumbai,"₹17,00,000/yr"
1803,Prudential plc,Data Scientist,3.0,Mumbai,"₹11,08,264/yr"
1804,Dure Technologies,Data Scientist,3.0,Mumbai,"₹12,89,859/yr"
1805,Tata Consultancy Services,Data Scientist,2.0,Mumbai,"₹18,737/mo"
1806,Tech Mahindra,Data Scientist,2.0,Mumbai,"₹8,85,892/yr"
1807,EY,Data Scientist,2.0,Mumbai,"₹10,25,737/yr"
1808,Fresher,Data Scientist,2.0,Mumbai,"₹50,367/mo"
1809,ICICI Bank,Data Scientist,2.0,Mumbai,"₹49,111/mo"
1810,Microsoft,Data Scientist,2.0,Mumbai,"₹2,16,685/mo"
1811,ABC,Data Scientist,2.0,Mumbai,"₹10,36,761/yr"
1812,Kotak Mahindra,Data Scientist,2.0,Mumbai,"₹66,648/mo"
1813,Freshworks,Data Scientist,2.0,Mumbai,"₹4,94,353/yr"
1814,NVIDIA,Data Scientist,2.0,Mumbai,"₹41,87,500/yr"
1815,HERE Technologies,Data Scientist,2.0,Mumbai,"₹41,940/mo"
1816,Fractal,Data Scientist,2.0,Mumbai,"₹39,822/mo"
1817,MAERSK,Data Scientist,2.0,Mumbai,"₹17,17,206/yr"
1818,Tata AIG General Insurance,Data Scientist,2.0,Mumbai,"₹14,06,673/yr"
1819,General Mills,Data Scientist,2.0,Mumbai,"₹17,34,062/yr"
1820,Motilal Oswal Securities,Data Scientist,2.0,Mumbai,"₹6,49,989/yr"
1821,Hdfc,Data Scientist,2.0,Mumbai,"₹64,952/mo"
1822,Tata Group,Data Scientist,2.0,Mumbai,"₹9,77,421/yr"
1823,PharmEasy,Data Scientist,2.0,Mumbai,"₹14,51,194/yr"
1824,Decimal Point Analytics,Data Scientist,2.0,Mumbai,"₹11,26,055/yr"
1825,People Group,Data Scientist,2.0,Mumbai,"₹13,14,654/yr"
1826,MiQ,Data Scientist,2.0,Mumbai,"₹12,40,055/yr"
1827,UPL,Data Scientist,2.0,Mumbai,"₹9,91,653/yr"
1828,Lead School (India),Data Scientist,2.0,Mumbai,"₹1,10,833/mo"
1829,LogiNext Solutions,Data Scientist,2.0,Mumbai,"₹4,65,001/yr"
1830,Bewakoof Brands,Data Scientist,2.0,Mumbai,"₹7,30,703/yr"
1831,Meru Mobility Tech,Data Scientist,2.0,Mumbai,"₹9,60,996/yr"
1832,Kissht,Data Scientist,2.0,Mumbai,"₹56,676/mo"
1833,Radhakrishna Foodland,Data Scientist,2.0,Mumbai,"₹3,04,060/yr"
1834,Tableau Software,Data Scientist,2.0,Mumbai,"₹28,65,536/yr"
1835,FlexiLoans Technologies,Data Scientist,2.0,Mumbai,"₹8,27,693/yr"
1836,Square Panda,Data Scientist,2.0,Mumbai,"₹6,76,720/yr"
1837,Think Analytics,Data Scientist,2.0,Mumbai,"₹6,06,168/yr"
1838,Locobuzz,Data Scientist,2.0,Mumbai,"₹8,35,493/yr"
1839,SMEcorner,Data Scientist,2.0,Mumbai,"₹40,725/mo"
1840,Quantsapp,Data Scientist,2.0,Mumbai,"₹18,926/mo"
1841,HDFC Developers,Data Scientist,2.0,Mumbai,"₹14,94,696/yr"

2025-02-11 11:11:52 - root - INFO - SQL:
-- 5. Select records for the specified cities
SELECT *
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
LIMIT 100
Results:
Too long, hard cut:
index,CompanyName,JobTitle,SalariesReported,Location,Salary
985,Tata Consultancy Services,Data Scientist,30.0,Pune,"₹7,17,331/yr"
986,Innoplexus,Data Scientist,17.0,Pune,"₹11,63,186/yr"
987,IBM,Data Scientist,11.0,Pune,"₹10,36,536/yr"
988,AlgoAnalytics Financial Consultancy,Data Scientist,11.0,Pune,"₹7,42,883/yr"
989,ZS Associates,Data Scientist,10.0,Pune,"₹12,94,039/yr"
990,Wolters Kluwer,Data Scientist,10.0,Pune,"₹11,54,579/yr"
991,Cognizant Technology Solutions,Data Scientist,8.0,Pune,"₹7,65,632/yr"
992,Accenture,Data Scientist,7.0,Pune,"₹6,02,937/yr"
993,Wipro,Data Scientist,7.0,Pune,"₹11,50,000/yr"
994,Zensar Technologies,Data Scientist,7.0,Pune,"₹8,54,957/yr"
995,Bajaj Finance,Data Scientist,7.0,Pune,"₹9,56,307/yr"
996,SG Analytics,Data Scientist,7.0,Pune,"₹8,16,946/yr"
997,ThinkBumblebee Analytics,Data Scientist,7.0,Pune,"₹10,70,536/yr"
998,Michelin,Data Scientist,6.0,Pune,"₹11,46,043/yr"
999,Tech Mahindra,Data Scientist,5.0,Pune,"₹11,14,163/yr"
1000,Schlumberger,Data Scientist,5.0,Pune,"₹20,54,972/yr"
1001,Merkle,Data Scientist,5.0,Pune,"₹11,34,768/yr"
1002,Infosys,Data Scientist,4.0,Pune,"₹8,78,252/yr"
1003,Capgemini,Data Scientist,4.0,Pune,"₹8,98,351/yr"
1004,LTI,Data Scientist,4.0,Pune,"₹8,14,017/yr"
1005,First Student,Data Scientist,4.0,Pune,"₹4,25,000/yr"
1006,Vodafone,Data Scientist,4.0,Pune,"₹9,40,423/yr"
1007,Eaton,Data Scientist,4.0,Pune,"₹11,21,845/yr"
1008,T-Systems,Data Scientist,4.0,Pune,"₹12,15,906/yr"
1009,Coupa Software Inc,Data Scientist,4.0,Pune,"₹10,55,811/yr"
1010,Aera Technology,Data Scientist,4.0,Pune,"₹16,22,612/yr"
1011,ABC,Data Scientist,3.0,Pune,"₹42,249/mo"
1012,Amdocs,Data Scientist,3.0,Pune,"₹7,18,534/yr"
1013,Atos-Syntel,Data Scientist,3.0,Pune,"₹4,23,422/yr"
1014,Barclays,Data Scientist,3.0,Pune,"₹17,33,746/yr"
1015,KPIT Technologies,Data Scientist,3.0,Pune,"₹16,55,120/yr"
1016,Credit Suisse,Data Scientist,3.0,Pune,"₹14,21,672/yr"
1017,Saama Technologies,Data Scientist,3.0,Pune,"₹9,34,857/yr"
1018,Exela Technologies,Data Scientist,3.0,Pune,"₹8,56,429/yr"
1019,Abzooba,Data Scientist,3.0,Pune,"₹18,00,000/yr"
1020,Linsyssoft Technologies,Data Scientist,3.0,Pune,"₹4,11,680/yr"
1021,HCL Technologies,Data Scientist,2.0,Pune,"₹61,248/mo"
1022,Fresher,Data Scientist,2.0,Pune,"₹51,920/mo"
1023,Axis Bank,Data Scientist,2.0,Pune,"₹2,32,796/mo"
1024,Freelancer,Data Scientist,2.0,Pune,"₹10,01,630/yr"
1025,Citi,Data Scientist,2.0,Pune,"₹15,77,759/yr"
1026,ADP,Data Scientist,2.0,Pune,"₹52,491/mo"
1027,Birlasoft,Data Scientist,2.0,Pune,"₹52,16,933/yr"
1028,John Deere,Data Scientist,2.0,Pune,"₹14,63,658/yr"
1029,Xoriant,Data Scientist,2.0,Pune,"₹17,72,001/yr"
1030,GS Lab,Data Scientist,2.0,Pune,"₹8,34,387/yr"
1031,Searce,Data Scientist,2.0,Pune,"₹8,28,221/yr"
1032,Globant,Data Scientist,2.0,Pune,"₹1,00,275/mo"
1033,e-Zest Solutions,Data Scientist,2.0,Pune,"₹9,32,104/yr"
1034,Datametica,Data Scientist,2.0,Pune,"₹9,83,550/yr"
1035,Vyom Labs,Data Scientist,2.0,Pune,"₹25,446/mo"
1036,Vishwakarma Institute of Technology,Data Scientist,2.0,Pune,₹602/hr
1037,Knorex,Data Scientist,2.0,Pune,"₹53,475/mo"
1038,CanWill Technologies,Data Scientist,2.0,Pune,"₹11,61,602/yr"
1039,ThinkBridge,Data Scientist,2.0,Pune,"₹63,058/mo"
1040,Coditation Systems,Data Scientist,2.0,Pune,"₹46,977/mo"
1041,MindBowser Info Solutions,Data Scientist,2.0,Pune,"₹2,83,914/yr"
1042,Climate Connect,Data Scientist,2.0,Pune,"₹7,31,758/yr"
1043,Tech9,Data Scientist,2.0,Pune,"₹16,87,208/yr"
1044,Eagle TK Infotech,Data Scientist,2.0,Pune,"₹7,13,466/yr"
1045,Fusion Practices,Data Scientist,2.0,Pune,"₹56,250/mo"
1046,Xeco,Data Scientist,2.0,Pune,"₹4,99,961/yr"
1047,DeepTek Medical Imaging,Data Scientist,2.0,Pune,"₹8,95,000/yr"
1048,vElement,Data Scientist,2.0,Pune,"₹2,53,851/yr"
1049,Asquared IoT,Data Scientist,2.0,Pune,"₹6,37,645/yr"
1050,HiLabs (MD),Data Scientist,2.0,Pune,"₹19,54,650/yr"
1051,Jash Data Sciences,Data Scientist,2.0,Pune,"₹6,69,083/yr"
1052,HiLabs,Data Scientist,2.0,Pune,"₹18,33,778/yr"
1053,Tata Consultancy Services,Data Scientist,1.0,Pune,"₹25,000/mo"
1054,Tata Consultancy Services,Data Scientist,1.0,Pune,"£7,03,427/yr"
1055,Amazon,Data Scientist,1.0,Pune,"₹1,15,884/yr"
1056,Amazon,Data Scientist,1.0,Pune,"₹6,19,069/yr"
1057,Genpact,Data Scientist,1.0,Pune,"₹16,00,000/yr"
1058,Fresher,Data Scientist,1.0,Pune,"₹30,147/mo"
1059,DXC Technology,Data Scientist,1.0,Pune,"₹4,00,000/yr"
1060,KPMG,Data Scientist,1.0,Pune,"₹6,42,322/yr"
1061,ABC,Data Scientist,1.0,Pune,"₹1,01,398/mo"
1062,Larsen & Toubro,Data Scientist,1.0,Pune,"₹30,000/mo"
1063,Concentrix,Data Scientist,1.0,Pune,"₹2,89,045/mo"
1064,Google,Data Scientist,1.0,Pune,"₹75,71,032/yr"
1065,Honeywell,Data Scientist,1.0,Pune,"₹14,38,481/yr"
1066,Persistent Systems,Data Scientist,1.0,Pune,"₹2,141/hr"
1067,DONE by NONE,Data Scientist,1.0,Pune,"₹1,00,000/mo"
1068,DONE by NONE,Data Scientist,1.0,Pune,"₹44,44,315/yr"
1069,DONE by NONE,Data Scientist,1.0,Pune,"₹3,01,469/yr"
1070,WNS,Data Scientist,1.0,Pune,"£2,05,049/yr"
1071,Siemens,Data Scientist,1.0,Pune,"₹70,000/m

2025-02-11 11:11:52 - root - INFO - SQL:
-- 6. Attempt to clean the Salary column by removing non-numeric characters
SELECT "Salary", 
       REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS "CleanedSalary"
FROM "SalaryDataset"
LIMIT 100
Results:
Salary,CleanedSalary
"₹6,48,573/yr",648573/yr
"₹11,91,950/yr",1191950/yr
"₹8,36,874/yr",836874/yr
"₹6,69,578/yr",669578/yr
"₹9,44,110/yr",944110/yr
"₹9,08,764/yr",908764/yr
"₹9,26,124/yr",926124/yr
"₹7,36,708/yr",736708/yr
"₹16,46,721/yr",1646721/yr
"₹13,92,960/yr",1392960/yr
"₹14,04,773/yr",1404773/yr
"₹15,07,343/yr",1507343/yr
"₹15,58,095/yr",1558095/yr
"₹25,57,843/yr",2557843/yr
"₹15,10,081/yr",1510081/yr
"₹7,32,821/yr",732821/yr
"₹12,21,750/yr",1221750/yr
"₹17,39,484/yr",1739484/yr
"₹11,24,939/yr",1124939/yr
"₹16,30,396/yr",1630396/yr
"₹10,09,436/yr",1009436/yr
"₹5,50,980/yr",550980/yr
"₹18,70,000/yr",1870000/yr
"₹7,58,376/yr",758376/yr
"₹15,56,575/yr",1556575/yr
"₹11,94,327/yr",1194327/yr
"₹14,70,000/yr",1470000/yr
"₹15,49,942/yr",1549942/yr
"₹10,09,436/yr",1009436/yr
"₹15,41,572/yr",1541572/yr
"₹8,11,182/yr",811182/yr
"₹12,05,874/yr",1205874/yr
"₹7,27,111/yr",727111/yr
"₹19,23,257/yr",1923257/yr
"₹21,43,501/yr",2143501/yr
"₹19,26,965/yr",1926965/yr
"₹41,271/mo",41271/mo
"₹12,94,984/yr",1294984/yr
"₹23,34,960/yr",2334960/yr
"₹22,67,616/yr",2267616/yr
"₹13,66,992/yr",1366992/yr
"₹14,53,427/yr",1453427/yr
"₹14,58,032/yr",1458032/yr
"₹17,30,166/yr",1730166/yr
"₹6,58,109/yr",658109/yr
"₹7,94,460/yr",794460/yr
"₹25,67,381/yr",2567381/yr
"₹16,37,231/yr",1637231/yr
"₹9,00,000/yr",900000/yr
"₹9,02,935/yr",902935/yr
"₹9,70,782/yr",970782/yr
"₹10,50,000/yr",1050000/yr
"₹21,19,584/yr",2119584/yr
"₹16,87,111/yr",1687111/yr
"₹14,65,641/yr",1465641/yr
"₹6,00,000/yr",600000/yr
"₹18,05,869/yr",1805869/yr
"₹26,24,063/yr",2624063/yr
"₹9,55,297/yr",955297/yr
"₹7,61,478/yr",761478/yr
"₹28,05,476/yr",2805476/yr
"₹9,69,112/yr",969112/yr
"₹4,50,979/yr",450979/yr
"₹13,38,795/yr",1338795/yr
"₹10,40,493/yr",1040493/yr
"₹12,91,549/yr",1291549/yr
"₹49,928/mo",49928/mo
"₹16,63,189/yr",1663189/yr
"₹13,23,387/yr",1323387/yr
"₹12,46,266/yr",1246266/yr
"₹4,94,147/yr",494147/yr
"₹18,92,758/yr",1892758/yr
"₹15,72,054/yr",1572054/yr
"₹20,24,533/yr",2024533/yr
"₹19,27,564/yr",1927564/yr
"₹8,00,000/yr",800000/yr
"₹20,09,790/yr",2009790/yr
"₹8,31,462/yr",831462/yr
"₹5,16,323/yr",516323/yr
"₹23,33,241/yr",2333241/yr
"₹12,00,000/yr",1200000/yr
"₹20,06,522/yr",2006522/yr
"₹21,60,000/yr",2160000/yr
"₹13,41,316/yr",1341316/yr
"₹16,34,105/yr",1634105/yr
"₹13,89,256/yr",1389256/yr
"₹10,00,000/yr",1000000/yr
"₹12,31,116/yr",1231116/yr
"₹23,52,941/yr",2352941/yr
"₹7,44,551/yr",744551/yr
"₹30,14,686/yr",3014686/yr
"₹13,57,204/yr",1357204/yr
"₹10,53,196/yr",1053196/yr
"₹13,37,606/yr",1337606/yr
"₹48,825/mo",48825/mo
"₹32,953/mo",32953/mo
"₹16,49,930/yr",1649930/yr
"₹11,38,060/yr",1138060/yr
"₹16,12,744/yr",1612744/yr
"₹4,32,776/yr",432776/yr

2025-02-11 11:11:52 - root - INFO - SQL:
-- 7. Convert the cleaned Salary to a numeric value
SELECT CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL) AS "SalaryNumeric"
FROM "SalaryDataset"
LIMIT 100
Results:
SalaryNumeric
648573.0
1191950.0
836874.0
669578.0
944110.0
908764.0
926124.0
736708.0
1646721.0
1392960.0
1404773.0
1507343.0
1558095.0
2557843.0
1510081.0
732821.0
1221750.0
1739484.0
1124939.0
1630396.0
1009436.0
550980.0
1870000.0
758376.0
1556575.0
1194327.0
1470000.0
1549942.0
1009436.0
1541572.0
811182.0
1205874.0
727111.0
1923257.0
2143501.0
1926965.0
41271.0
1294984.0
2334960.0
2267616.0
1366992.0
1453427.0
1458032.0
1730166.0
658109.0
794460.0
2567381.0
1637231.0
900000.0
902935.0
970782.0
1050000.0
2119584.0
1687111.0
1465641.0
600000.0
1805869.0
2624063.0
955297.0
761478.0
2805476.0
969112.0
450979.0
1338795.0
1040493.0
1291549.0
49928.0
1663189.0
1323387.0
1246266.0
494147.0
1892758.0
1572054.0
2024533.0
1927564.0
800000.0
2009790.0
831462.0
516323.0
2333241.0
1200000.0
2006522.0
2160000.0
1341316.0
1634105.0
1389256.0
1000000.0
1231116.0
2352941.0
744551.0
3014686.0
1357204.0
1053196.0
1337606.0
48825.0
32953.0
1649930.0
1138060.0
1612744.0
432776.0

2025-02-11 11:11:52 - root - INFO - SQL:
-- 8. Calculate average salary per company in Mumbai
SELECT "CompanyName",
       AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryMumbai"
FROM "SalaryDataset"
WHERE "Location" = 'Mumbai'
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AvgSalaryMumbai
20K Group,42892.0
72 Dragons,23043.0
AB Innovative Software,35568.0
ABC,571300.25
AGS Transact Technologies,35257.0
AIG,1187386.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
AXIS MY INDIA,374059.0
Aays Analytics,894346.0
Accenture,611859.8
Accion Labs,33879.0
Acuris Global,12060.0
Adani Group,95700.0
Aditya Birla Group,461882.5
Advisory Board,414388.0
Aegis,302200.0
Agape Marketing Agency,564654.0
Airpay,892152.0
Ajay bharti,401953.0
Algo Engines,1200000.0
Alpha Alternatives,15617.0
Amazon,1010146.5
American Automobile Association (AAA),1139568.0
AmyGB,40684.0
Anand Rathi,1095095.0
Angel One,527662.6666666666
Anonymous,48676.5
Anonymous Content,520597.0
Apical Solutions,1008975.0
Arohi Operations,30834.0
Arya.ai,838354.0
Ascent Health & Wellness Solutions,322465.0
At,1016376.0
AthenasOwl,778355.3333333334
Atos-Syntel,596458.0
Aureus Analytics,1028702.0
AxionConnect Infosolutions,5024.0
Axis Bank,736602.3333333334
B&B Analytics,5647.0
BDO,790515.0
BYJU'S,1000000.0
Bahar Infotech,15189.0
Bajaj Finance,25685.0
Bank of America,928488.0
Bank of America Merrill Lynch,1232857.0
Barclays,1040054.0
Bewakoof Brands,831538.5
Bharat Petroleum,2121545.0
Bharti Airtel,0.0
Biosense Technologies,26792.0
Bizongo,2597406.0
Bloomberg L.P.,139072.0
Blue Dart Express,1296967.0
Blue Ocean,12422.0
Bookmyshow,897278.5
Brandscapes Worldwide,245202.0
BridgeLabz Solutions,22304.0
Bristlecone,18273.0
CASHe,1098034.0
CMC,15124.0
CRG Solutions,521474.0
CRISIL,194054.0
Candere.com,504107.0
Capgemini,789216.0
Capgemini Engineering,45172.0
Capital One,33794.0
Career Launcher,5374.0
Cartesian Consulting,530781.0
Celebal Technologies,463374.0
Celusion Technologies,11293.0
Cere Labs,302507.0
Challenger Technologies,9034.0
Christian College of Engineering & Technology (CCET),123286.0
Cimpress,790515.0
Cipla,1088000.0
Cisco Systems,10880.0
Citi,1322737.0
CitiusTech,955754.6666666666
CloudFronts Technologies,74078.0
Clover Infotech,655953.0
Club 24,80718.0
Cogencis Information Services,143277.5
Cognizant Technology Solutions,702609.0
Cogoport,2000000.0
Colgate-Palmolive,385915.5
Collinson,1181308.0
Concerto Software,10749.0
Course5 Intelligence,386533.5
Craftsvilla.com,162802.0
Credit Suisse,105868.0
Crimson Interactive,1843745.0
Cuddle,1961487.0
Cuelogic Technologies,1100000.0
DAT Engineering,46854.0
DONE by NONE,117608.6
DT-Trak Consulting,600000.0
DXC Technology,731418.0
Danpal,322077.0
Data Axle,1000000.0

2025-02-11 11:11:52 - root - INFO - SQL:
-- 9. Calculate overall average salary per company nationwide
SELECT "CompanyName",
       AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryNationwide"
FROM "SalaryDataset"
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AvgSalaryNationwide
,900189.6666666666
& Other Stories,722247.0
---,10000.0
159 Solutions,828777.0
1mg,991426.0
20K Group,32260.0
2COMS,467574.0
360DigiTMG,359620.0
3K Technologies,798116.0
3LOQ Labs,778644.0
3i Infotech,734390.0
4CRisk.ai,700000.0
54y4,100000.0
5x,450000.0
6sense,42995.0
72 Dragons,23043.0
91springboard,750000.0
AAKASH,50163.0
AAP,321161.0
AB Innovative Software,35568.0
ABB,955297.0
ABC,713195.15
ABC Consultants,4282144.0
ABC Supply Co.,524121.0
ABC Tech,61068.0
ABC do ABC,513743.0
ABCDEF,1643757.75
ABSAS Solutions,22283.0
ACD Communications,866307.0
ACS Solutions,992754.0
ADHOC Services,563464.0
ADP,896210.0
AFFINSYS AI,1450359.0
AGS Health,413352.0
AGS Transact Technologies,35257.0
AI Touch,15135.0
AIEnterprise,712525.0
AIG,922211.5
AIR Worldwide,398975.0
AIndra Labs,25349.0
AJIO,15000.0
ALBOT,600000.0
ALL IT Services,75366.0
ALTEN,1461604.0
AMCORE Financial,1800000.0
AMPROVIT TECHNOLOGIES,67517.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
ANZ Bank,1111352.0
AON,198811.0
AROHA TECHNOLOGIES,51799.0
ASD,196999.0
ASSAD,517986.0
ATS Services (India),34370.0
AXA,585774.0
AXA GO Business Operations,1344055.0
AXA XL,731213.0
AXIS MY INDIA,374059.0
Aashish sharma,1225579.0
Aays Analytics,894346.0
Abbott,1124740.0
Abhijeet Group,18570.0
Abhinav Immigration Services Pvt. Ltd.,1324539.0
Absolutdata,558121.0
Abzooba,1176621.1666666667
Acalvio,2442736.0
Accentue,1041548.5
Accenture,658121.1
Accion Labs,33879.0
Acclivis Technologies,1003261.0
Accretive Wiz@work Consultants,1300000.0
Accurence,102323.0
Acies,415492.0
Actiknow,363669.0
Activa (CA),1490685.0
Acuity Knowledge Partners,508899.0
Acuris Global,12060.0
AdWyze,31734.0
Adani Group,95700.0
Adappt Intelligence,360000.0
Add Innovations,310791.0
Adda 247,10653.0
Adecco,1349689.0
Adglobal360,345719.5
Aditi Software,469326.0
Aditya Birla Group,852989.0
Admit.me,1973587.0
Adobe,850445.625
Advanced Infrastructure Engineering,30269.0
Advisory Board,414388.0
Aegis,331210.0
Aegon,2508152.0
Aera Technology,1038643.25
Aera Technology Associate,1007334.0
Aeries Technology,1410268.0
Affine,784572.0
AffinityAnswers,735014.0
AffinityX,16147.0
Affle,933286.0
AgEye Technologies,518492.0

2025-02-11 11:11:52 - root - INFO - SQL:
-- 10. Compare each company's average salary in Mumbai to the national average
SELECT m."CompanyName",
       m."AvgSalaryMumbai",
       n."AvgSalaryNationwide"
FROM (
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryMumbai"
    FROM "SalaryDataset"
    WHERE "Location" = 'Mumbai'
    GROUP BY "CompanyName"
    ORDER BY "AvgSalaryMumbai" DESC
    LIMIT 5
) m
JOIN (
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryNationwide"
    FROM "SalaryDataset"
    GROUP BY "CompanyName"
) n ON m."CompanyName" = n."CompanyName"
LIMIT 100
Results:
CompanyName,AvgSalaryMumbai,AvgSalaryNationwide
Rahul Industries,6044006.0,3037137.5
NVIDIA,4187500.0,1541363.3333333333
VINAYA KUMAR,4029337.0,2414668.5
Goldman Sachs,3977066.0,1903402.6
Zee Entertainment Enterprises Ltd.,3531413.0,3531413.0

2025-02-11 11:11:52 - root - INFO - itercount: 0
2025-02-11 11:11:52 - root - INFO - Table: hardware_dim_customerDDL:
CREATE TABLE "hardware_dim_customer" (
"customer_code" INTEGER,
  "customer" TEXT,
  "platform" TEXT,
  "channel" TEXT,
  "market" TEXT,
  "sub_zone" TEXT,
  "region" TEXT
)
Table: hardware_fact_pre_invoice_deductionsDDL:
CREATE TABLE "hardware_fact_pre_invoice_deductions" (
"customer_code" INTEGER,
  "fiscal_year" INTEGER,
  "pre_invoice_discount_pct" REAL
)
Table: web_sales_repsDDL:
CREATE TABLE "web_sales_reps" (
"id" INTEGER,
  "name" TEXT,
  "region_id" INTEGER
)
Table: hardware_dim_productDDL:
CREATE TABLE "hardware_dim_product" (
"product_code" TEXT,
  "division" TEXT,
  "segment" TEXT,
  "category" TEXT,
  "product" TEXT,
  "variant" TEXT
)
Table: web_ordersDDL:
CREATE TABLE "web_orders" (
"id" INTEGER,
  "account_id" INTEGER,
  "occurred_at" TEXT,
  "standard_qty" INTEGER,
  "gloss_qty" INTEGER,
  "poster_qty" INTEGER,
  "total" INTEGER,
  "standard_amt_usd" REAL,
  "gloss_amt_usd" REAL,
  "poster_amt_usd" REAL,
  "total_amt_usd" REAL
)
Table: StaffHoursDDL:
CREATE TABLE "StaffHours" (
"StaffMember" TEXT,
  "EventDate" TEXT,
  "EventTime" TEXT,
  "EventType" TEXT
)
Table: university_enrollmentDDL:
CREATE TABLE "university_enrollment" (
"OfferNo" INTEGER,
  "StdNo" INTEGER,
  "EnrGrade" REAL
)
Table: university_facultyDDL:
CREATE TABLE "university_faculty" (
"FacNo" INTEGER,
  "FacFirstName" TEXT,
  "FacLastName" TEXT,
  "FacCity" TEXT,
  "FacState" TEXT,
  "FacDept" TEXT,
  "FacRank" TEXT,
  "FacSalary" INTEGER,
  "FacSupervisor" REAL,
  "FacHireDate" TEXT,
  "FacZipCode" TEXT
)
Table: university_studentDDL:
CREATE TABLE "university_student" (
"StdNo" INTEGER,
  "StdFirstName" TEXT,
  "StdLastName" TEXT,
  "StdCity" TEXT,
  "StdState" TEXT,
  "StdZip" TEXT,
  "StdMajor" TEXT,
  "StdClass" TEXT,
  "StdGPA" REAL
)
Table: university_offeringDDL:
CREATE TABLE "university_offering" (
"OfferNo" INTEGER,
  "CourseNo" TEXT,
  "OffTerm" TEXT,
  "OffYear" INTEGER,
  "OffLocation" TEXT,
  "OffTime" TEXT,
  "FacNo" REAL,
  "OffDays" TEXT
)
Table: web_accountsDDL:
CREATE TABLE "web_accounts" (
"id" INTEGER,
  "name" TEXT,
  "website" TEXT,
  "lat" REAL,
  "long" REAL,
  "primary_poc" TEXT,
  "sales_rep_id" INTEGER
)
Table: web_eventsDDL:
CREATE TABLE "web_events" (
"id" INTEGER,
  "account_id" INTEGER,
  "occurred_at" TEXT,
  "channel" TEXT
)
Table: SalaryDatasetDDL:
CREATE TABLE "SalaryDataset" (
"index" INTEGER,
  "CompanyName" TEXT,
  "JobTitle" TEXT,
  "SalariesReported" REAL,
  "Location" TEXT,
  "Salary" TEXT
)
Table: web_regionDDL:
CREATE TABLE "web_region" (
"id" INTEGER,
  "name" TEXT
)
Table: hardware_fact_gross_priceDDL:
CREATE TABLE "hardware_fact_gross_price" (
"product_code" TEXT,
  "fiscal_year" INTEGER,
  "gross_price" REAL
)
Table: hardware_fact_manufacturing_costDDL:
CREATE TABLE "hardware_fact_manufacturing_cost" (
"product_code" TEXT,
  "cost_year" INTEGER,
  "manufacturing_cost" REAL
)
Table: university_courseDDL:
CREATE TABLE "university_course" (
"CourseNo" TEXT,
  "CrsDesc" TEXT,
  "CrsUnits" INTEGER
)
Table: hardware_fact_sales_monthlyDDL:
CREATE TABLE "hardware_fact_sales_monthly" (
"date" TEXT,
  "product_code" TEXT,
  "customer_code" INTEGER,
  "sold_quantity" INTEGER,
  "fiscal_year" INTEGER
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['hardware_dim_customer', 'hardware_fact_pre_invoice_deductions', 'web_sales_reps', 'hardware_dim_product', 'web_orders', 'StaffHours', 'university_enrollment', 'university_faculty', 'university_student', 'university_offering', 'web_accounts', 'web_events', 'SalaryDataset', 'web_region', 'hardware_fact_gross_price', 'hardware_fact_manufacturing_cost', 'university_course', 'hardware_fact_sales_monthly']
Begin Exploring Related Columns
**Relevant Table:**
- **SalaryDataset**

**Relevant Columns and Their Potential Usage:**

- `"CompanyName"`: Used to group salaries by company.
- `"Location"`: Used to filter records for the specified cities (Mumbai, Pune, New Delhi, Hyderabad).
- `"Salary"`: Needs to be cleaned by removing non-numeric characters and converted to a numeric type; used to calculate average salaries.

**Conditions That May Be Used:**

- Filter records where `"Location"` is one of the specified cities.
- Remove non-numeric characters from `"Salary"` and convert it to a numeric type.
- Calculate average salary per company in each specified city.
- Calculate overall national average salary per company.
- Limit results to the top 5 companies by average salary in each city.

**SQL Queries to Understand the Data:**

```sql
-- 1. List all distinct locations in the SalaryDataset
SELECT DISTINCT "Location"
FROM "SalaryDataset"
LIMIT 100;

-- 2. Show all distinct company names
SELECT DISTINCT "CompanyName"
FROM "SalaryDataset"
LIMIT 100;

-- 3. Display raw salary values to understand the data format
SELECT "Salary"
FROM "SalaryDataset"
LIMIT 100;

-- 4. Select records for Mumbai
SELECT *
FROM "SalaryDataset"
WHERE "Location" = 'Mumbai'
LIMIT 100;

-- 5. Select records for the specified cities
SELECT *
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
LIMIT 100;

-- 6. Attempt to clean the Salary column by removing non-numeric characters
SELECT "Salary", 
       REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS "CleanedSalary"
FROM "SalaryDataset"
LIMIT 100;

-- 7. Convert the cleaned Salary to a numeric value
SELECT CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL) AS "SalaryNumeric"
FROM "SalaryDataset"
LIMIT 100;

-- 8. Calculate average salary per company in Mumbai
SELECT "CompanyName",
       AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryMumbai"
FROM "SalaryDataset"
WHERE "Location" = 'Mumbai'
GROUP BY "CompanyName"
LIMIT 100;

-- 9. Calculate overall average salary per company nationwide
SELECT "CompanyName",
       AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryNationwide"
FROM "SalaryDataset"
GROUP BY "CompanyName"
LIMIT 100;

-- 10. Compare each company's average salary in Mumbai to the national average
SELECT m."CompanyName",
       m."AvgSalaryMumbai",
       n."AvgSalaryNationwide"
FROM (
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryMumbai"
    FROM "SalaryDataset"
    WHERE "Location" = 'Mumbai'
    GROUP BY "CompanyName"
    ORDER BY "AvgSalaryMumbai" DESC
    LIMIT 5
) m
JOIN (
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryNationwide"
    FROM "SalaryDataset"
    GROUP BY "CompanyName"
) n ON m."CompanyName" = n."CompanyName"
LIMIT 100;
```

This series of SQL queries progressively explores and processes the data:

1. Lists all unique locations to verify the cities present in the dataset.
2. Lists all unique company names to understand the range of companies.
3. Displays raw salary values to inspect the format and necessary cleaning steps.
4. Selects records specific to Mumbai to begin focusing on the desired data subset.
5. Selects records for all specified cities (Mumbai, Pune, New Delhi, Hyderabad).
6. Attempts to clean the `"Salary"` column by removing currency symbols, commas, and converting abbreviations like 'k' or 'K' to '000'.
7. Converts the cleaned salary strings to numeric values (REAL type) for calculation.
8. Calculates the average salary per company in Mumbai.
9. Calculates the overall average salary per company across all locations (nationwide).
10. Compares each company's average salary in Mumbai to their national average, focusing on the top 5 companies by average salary in Mumbai.

By performing these queries, we gain an understanding of the data structure and prepare the dataset for the final analysis required by the task.Query:
-- 1. List all distinct locations in the SalaryDataset
SELECT DISTINCT "Location"
FROM "SalaryDataset"
LIMIT 100
Answer:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai
Query:
-- 2. Show all distinct company names
SELECT DISTINCT "CompanyName"
FROM "SalaryDataset"
LIMIT 100
Answer:
CompanyName
Mu Sigma
IBM
Tata Consultancy Services
Impact Analytics
Accenture
Infosys
Capgemini
Cognizant Technology Solutions
Anheuser-Busch InBev
Fractal
Embibe
Amazon
Google
Flipkart
HP Inc.
Wipro
Ericsson-Worldwide
MiQ
Deloitte
Microsoft
Genpact
Fresher
Société Générale
Flutura
Fuzzy Logix
DXC Technology
Jio
Honeywell
Affine
Philips
Bharat Light & Power
Antuit
Nielsen
[24]7.ai
Fidelity Investments
Myntra
First Student
Oracle
Ola
Walmart Global Tech
Tredence
Intel Corporation
Mercedes-Benz Research and Development India
SAP
Wipro Technologies
Thoucentric
Walmart
Brillio
Great Learning
Gramener
HCL Technologies
Happiest Minds Technologies
Hewlett Packard Enterprise | HPE
Noodle.ai
Cisco Systems
INSOFE
Optum
Adobe
ABB
EY
Swiggy
Subex
iNeuron
ZS Associates
Robert Bosch India
Scienaptic Systems
FlyNava Technologies
Nokia
UnitedHealth Group
Sigmoid Analytics
Idexcel
Citi
GE Healthcare
SigTuple
Dell Technologies
Ericsson IT Solutions & Services
Aptus Data Labs
UniQreate
LinkedIn
Apexon
Shadowfax Technologies
Bharti Airtel
Applied Materials
FICO
YouPlus
Mphasis
Target
Gojek
Blueocean Market Intelligence
CRED
Rolls-Royce
Curl Analytics
J.P. Morgan
Knowledge Lens
ascena
QuantZig
Baker Hughes
Everlytics
Siemens
ANZ Bank
Query:
-- 3. Display raw salary values to understand the data format
SELECT "Salary"
FROM "SalaryDataset"
LIMIT 100
Answer:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹10,09,436/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"
Query:
-- 4. Select records for Mumbai
SELECT *
FROM "SalaryDataset"
WHERE "Location" = 'Mumbai'
LIMIT 100
Answer:
Too long, hard cut:
index,CompanyName,JobTitle,SalariesReported,Location,Salary
1759,Fractal,Data Scientist,32.0,Mumbai,"₹16,43,351/yr"
1760,Tata Consultancy Services,Data Scientist,18.0,Mumbai,"₹5,66,756/yr"
1761,Accenture,Data Scientist,10.0,Mumbai,"₹9,00,000/yr"
1762,Capgemini,Data Scientist,10.0,Mumbai,"₹10,55,889/yr"
1763,Jio,Data Scientist,10.0,Mumbai,"₹10,37,441/yr"
1764,Reliance Industries,Data Scientist,9.0,Mumbai,"₹17,73,222/yr"
1765,Housing.com,Data Scientist,8.0,Mumbai,"₹23,83,368/yr"
1766,Quantiphi,Data Scientist,7.0,Mumbai,"₹9,19,025/yr"
1767,Axis Bank,Data Scientist,6.0,Mumbai,"₹11,93,674/yr"
1768,LTI,Data Scientist,5.0,Mumbai,"₹6,44,930/yr"
1769,HDFC Bank,Data Scientist,5.0,Mumbai,"₹10,70,583/yr"
1770,Vodafone Idea,Data Scientist,5.0,Mumbai,"₹20,09,767/yr"
1771,CASHe,Data Scientist,5.0,Mumbai,"₹10,98,034/yr"
1772,Infosys,Data Scientist,4.0,Mumbai,"₹11,02,095/yr"
1773,Cognizant Technology Solutions,Data Scientist,4.0,Mumbai,"₹8,30,959/yr"
1774,Deloitte,Data Scientist,4.0,Mumbai,"₹11,91,942/yr"
1775,First Student,Data Scientist,4.0,Mumbai,"₹12,10,857/yr"
1776,CitiusTech,Data Scientist,4.0,Mumbai,"₹2,94,111/yr"
1777,RBL Bank,Data Scientist,4.0,Mumbai,"₹11,80,704/yr"
1778,ZEE5,Data Scientist,4.0,Mumbai,"₹14,58,789/yr"
1779,Mahindra Integrated Business Solutions,Data Scientist,4.0,Mumbai,"₹9,74,832/yr"
1780,DataScientest,Data Scientist,4.0,Mumbai,"₹45,684/mo"
1781,Pentation Analytics,Data Scientist,4.0,Mumbai,"₹6,50,654/yr"
1782,NDS InfoServ,Data Scientist,4.0,Mumbai,"₹9,26,744/yr"
1783,Arya.ai,Data Scientist,4.0,Mumbai,"₹8,38,354/yr"
1784,Wipro,Data Scientist,3.0,Mumbai,"₹30,368/mo"
1785,Amazon,Data Scientist,3.0,Mumbai,"₹10,18,095/yr"
1786,IBM,Data Scientist,3.0,Mumbai,"₹11,93,120/yr"
1787,PwC,Data Scientist,3.0,Mumbai,"₹14,49,831/yr"
1788,Google,Data Scientist,3.0,Mumbai,"₹13,55,169/yr"
1789,Atos-Syntel,Data Scientist,3.0,Mumbai,"₹8,75,733/yr"
1790,Siemens,Data Scientist,3.0,Mumbai,"₹12,57,890/yr"
1791,Mahindra,Data Scientist,3.0,Mumbai,"₹10,22,850/yr"
1792,eClerx,Data Scientist,3.0,Mumbai,"₹7,33,769/yr"
1793,HERE Technologies,Data Scientist,3.0,Mumbai,"₹17,82,011/yr"
1794,HDFC Standard Life Insurance,Data Scientist,3.0,Mumbai,"₹12,21,714/yr"
1795,Morningstar,Data Scientist,3.0,Mumbai,"₹9,57,432/yr"
1796,L&T Financial Services,Data Scientist,3.0,Mumbai,"₹8,86,778/yr"
1797,Piramal Enterprises,Data Scientist,3.0,Mumbai,"₹72,216/mo"
1798,Piramal Enterprises,Data Scientist,3.0,Mumbai,"₹11,60,523/yr"
1799,Episource,Data Scientist,3.0,Mumbai,"₹8,94,949/yr"
1800,XPO Logistics,Data Scientist,3.0,Mumbai,"₹15,81,030/yr"
1801,Loylty Rewardz Mngt,Data Scientist,3.0,Mumbai,"₹12,23,523/yr"
1802,Karza Technologies,Data Scientist,3.0,Mumbai,"₹17,00,000/yr"
1803,Prudential plc,Data Scientist,3.0,Mumbai,"₹11,08,264/yr"
1804,Dure Technologies,Data Scientist,3.0,Mumbai,"₹12,89,859/yr"
1805,Tata Consultancy Services,Data Scientist,2.0,Mumbai,"₹18,737/mo"
1806,Tech Mahindra,Data Scientist,2.0,Mumbai,"₹8,85,892/yr"
1807,EY,Data Scientist,2.0,Mumbai,"₹10,25,737/yr"
1808,Fresher,Data Scientist,2.0,Mumbai,"₹50,367/mo"
1809,ICICI Bank,Data Scientist,2.0,Mumbai,"₹49,111/mo"
1810,Microsoft,Data Scientist,2.0,Mumbai,"₹2,16,685/mo"
1811,ABC,Data Scientist,2.0,Mumbai,"₹10,36,761/yr"
1812,Kotak Mahindra,Data Scientist,2.0,Mumbai,"₹66,648/mo"
1813,Freshworks,Data Scientist,2.0,Mumbai,"₹4,94,353/yr"
1814,NVIDIA,Data Scientist,2.0,Mumbai,"₹41,87,500/yr"
1815,HERE Technologies,Data Scientist,2.0,Mumbai,"₹41,940/mo"
1816,Fractal,Data Scientist,2.0,Mumbai,"₹39,822/mo"
1817,MAERSK,Data Scientist,2.0,Mumbai,"₹17,17,206/yr"
1818,Tata AIG General Insurance,Data Scientist,2.0,Mumbai,"₹14,06,673/yr"
1819,General Mills,Data Scientist,2.0,Mumbai,"₹17,34,062/yr"
1820,Motilal Oswal Securities,Data Scientist,2.0,Mumbai,"₹6,49,989/yr"
1821,Hdfc,Data Scientist,2.0,Mumbai,"₹64,952/mo"
1822,Tata Group,Data Scientist,2.0,Mumbai,"₹9,77,421/yr"
1823,PharmEasy,Data Scientist,2.0,Mumbai,"₹14,51,194/yr"
1824,Decimal Point Analytics,Data Scientist,2.0,Mumbai,"₹11,26,055/yr"
1825,People Group,Data Scientist,2.0,Mumbai,"₹13,14,654/yr"
1826,MiQ,Data Scientist,2.0,Mumbai,"₹12,40,055/yr"
1827,UPL,Data Scientist,2.0,Mumbai,"₹9,91,653/yr"
1828,Lead School (India),Data Scientist,2.0,Mumbai,"₹1,10,833/mo"
1829,LogiNext Solutions,Data Scientist,2.0,Mumbai,"₹4,65,001/yr"
1830,Bewakoof Brands,Data Scientist,2.0,Mumbai,"₹7,30,703/yr"
1831,Meru Mobility Tech,Data Scientist,2.0,Mumbai,"₹9,60,996/yr"
1832,Kissht,Data Scientist,2.0,Mumbai,"₹56,676/mo"
1833,Radhakrishna Foodland,Data Scientist,2.0,Mumbai,"₹3,04,060/yr"
1834,Tableau Software,Data Scientist,2.0,Mumbai,"₹28,65,536/yr"
1835,FlexiLoans Technologies,Data Scientist,2.0,Mumbai,"₹8,27,693/yr"
1836,Square Panda,Data Scientist,2.0,Mumbai,"₹6,76,720/yr"
1837,Think Analytics,Data Scientist,2.0,Mumbai,"₹6,06,168/yr"
1838,Locobuzz,Data Scientist,2.0,Mumbai,"₹8,35,493/yr"
1839,SMEcorner,Data Scientist,2.0,Mumbai,"₹40,725/mo"
1840,Quantsapp,Data Scientist,2.0,Mumbai,"₹18,926/mo"
1841,HDFC Developers,Data Scientist,2.0,Mumbai,"₹14,94,696/yr"
Query:
-- 5. Select records for the specified cities
SELECT *
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
LIMIT 100
Answer:
Too long, hard cut:
index,CompanyName,JobTitle,SalariesReported,Location,Salary
985,Tata Consultancy Services,Data Scientist,30.0,Pune,"₹7,17,331/yr"
986,Innoplexus,Data Scientist,17.0,Pune,"₹11,63,186/yr"
987,IBM,Data Scientist,11.0,Pune,"₹10,36,536/yr"
988,AlgoAnalytics Financial Consultancy,Data Scientist,11.0,Pune,"₹7,42,883/yr"
989,ZS Associates,Data Scientist,10.0,Pune,"₹12,94,039/yr"
990,Wolters Kluwer,Data Scientist,10.0,Pune,"₹11,54,579/yr"
991,Cognizant Technology Solutions,Data Scientist,8.0,Pune,"₹7,65,632/yr"
992,Accenture,Data Scientist,7.0,Pune,"₹6,02,937/yr"
993,Wipro,Data Scientist,7.0,Pune,"₹11,50,000/yr"
994,Zensar Technologies,Data Scientist,7.0,Pune,"₹8,54,957/yr"
995,Bajaj Finance,Data Scientist,7.0,Pune,"₹9,56,307/yr"
996,SG Analytics,Data Scientist,7.0,Pune,"₹8,16,946/yr"
997,ThinkBumblebee Analytics,Data Scientist,7.0,Pune,"₹10,70,536/yr"
998,Michelin,Data Scientist,6.0,Pune,"₹11,46,043/yr"
999,Tech Mahindra,Data Scientist,5.0,Pune,"₹11,14,163/yr"
1000,Schlumberger,Data Scientist,5.0,Pune,"₹20,54,972/yr"
1001,Merkle,Data Scientist,5.0,Pune,"₹11,34,768/yr"
1002,Infosys,Data Scientist,4.0,Pune,"₹8,78,252/yr"
1003,Capgemini,Data Scientist,4.0,Pune,"₹8,98,351/yr"
1004,LTI,Data Scientist,4.0,Pune,"₹8,14,017/yr"
1005,First Student,Data Scientist,4.0,Pune,"₹4,25,000/yr"
1006,Vodafone,Data Scientist,4.0,Pune,"₹9,40,423/yr"
1007,Eaton,Data Scientist,4.0,Pune,"₹11,21,845/yr"
1008,T-Systems,Data Scientist,4.0,Pune,"₹12,15,906/yr"
1009,Coupa Software Inc,Data Scientist,4.0,Pune,"₹10,55,811/yr"
1010,Aera Technology,Data Scientist,4.0,Pune,"₹16,22,612/yr"
1011,ABC,Data Scientist,3.0,Pune,"₹42,249/mo"
1012,Amdocs,Data Scientist,3.0,Pune,"₹7,18,534/yr"
1013,Atos-Syntel,Data Scientist,3.0,Pune,"₹4,23,422/yr"
1014,Barclays,Data Scientist,3.0,Pune,"₹17,33,746/yr"
1015,KPIT Technologies,Data Scientist,3.0,Pune,"₹16,55,120/yr"
1016,Credit Suisse,Data Scientist,3.0,Pune,"₹14,21,672/yr"
1017,Saama Technologies,Data Scientist,3.0,Pune,"₹9,34,857/yr"
1018,Exela Technologies,Data Scientist,3.0,Pune,"₹8,56,429/yr"
1019,Abzooba,Data Scientist,3.0,Pune,"₹18,00,000/yr"
1020,Linsyssoft Technologies,Data Scientist,3.0,Pune,"₹4,11,680/yr"
1021,HCL Technologies,Data Scientist,2.0,Pune,"₹61,248/mo"
1022,Fresher,Data Scientist,2.0,Pune,"₹51,920/mo"
1023,Axis Bank,Data Scientist,2.0,Pune,"₹2,32,796/mo"
1024,Freelancer,Data Scientist,2.0,Pune,"₹10,01,630/yr"
1025,Citi,Data Scientist,2.0,Pune,"₹15,77,759/yr"
1026,ADP,Data Scientist,2.0,Pune,"₹52,491/mo"
1027,Birlasoft,Data Scientist,2.0,Pune,"₹52,16,933/yr"
1028,John Deere,Data Scientist,2.0,Pune,"₹14,63,658/yr"
1029,Xoriant,Data Scientist,2.0,Pune,"₹17,72,001/yr"
1030,GS Lab,Data Scientist,2.0,Pune,"₹8,34,387/yr"
1031,Searce,Data Scientist,2.0,Pune,"₹8,28,221/yr"
1032,Globant,Data Scientist,2.0,Pune,"₹1,00,275/mo"
1033,e-Zest Solutions,Data Scientist,2.0,Pune,"₹9,32,104/yr"
1034,Datametica,Data Scientist,2.0,Pune,"₹9,83,550/yr"
1035,Vyom Labs,Data Scientist,2.0,Pune,"₹25,446/mo"
1036,Vishwakarma Institute of Technology,Data Scientist,2.0,Pune,₹602/hr
1037,Knorex,Data Scientist,2.0,Pune,"₹53,475/mo"
1038,CanWill Technologies,Data Scientist,2.0,Pune,"₹11,61,602/yr"
1039,ThinkBridge,Data Scientist,2.0,Pune,"₹63,058/mo"
1040,Coditation Systems,Data Scientist,2.0,Pune,"₹46,977/mo"
1041,MindBowser Info Solutions,Data Scientist,2.0,Pune,"₹2,83,914/yr"
1042,Climate Connect,Data Scientist,2.0,Pune,"₹7,31,758/yr"
1043,Tech9,Data Scientist,2.0,Pune,"₹16,87,208/yr"
1044,Eagle TK Infotech,Data Scientist,2.0,Pune,"₹7,13,466/yr"
1045,Fusion Practices,Data Scientist,2.0,Pune,"₹56,250/mo"
1046,Xeco,Data Scientist,2.0,Pune,"₹4,99,961/yr"
1047,DeepTek Medical Imaging,Data Scientist,2.0,Pune,"₹8,95,000/yr"
1048,vElement,Data Scientist,2.0,Pune,"₹2,53,851/yr"
1049,Asquared IoT,Data Scientist,2.0,Pune,"₹6,37,645/yr"
1050,HiLabs (MD),Data Scientist,2.0,Pune,"₹19,54,650/yr"
1051,Jash Data Sciences,Data Scientist,2.0,Pune,"₹6,69,083/yr"
1052,HiLabs,Data Scientist,2.0,Pune,"₹18,33,778/yr"
1053,Tata Consultancy Services,Data Scientist,1.0,Pune,"₹25,000/mo"
1054,Tata Consultancy Services,Data Scientist,1.0,Pune,"£7,03,427/yr"
1055,Amazon,Data Scientist,1.0,Pune,"₹1,15,884/yr"
1056,Amazon,Data Scientist,1.0,Pune,"₹6,19,069/yr"
1057,Genpact,Data Scientist,1.0,Pune,"₹16,00,000/yr"
1058,Fresher,Data Scientist,1.0,Pune,"₹30,147/mo"
1059,DXC Technology,Data Scientist,1.0,Pune,"₹4,00,000/yr"
1060,KPMG,Data Scientist,1.0,Pune,"₹6,42,322/yr"
1061,ABC,Data Scientist,1.0,Pune,"₹1,01,398/mo"
1062,Larsen & Toubro,Data Scientist,1.0,Pune,"₹30,000/mo"
1063,Concentrix,Data Scientist,1.0,Pune,"₹2,89,045/mo"
1064,Google,Data Scientist,1.0,Pune,"₹75,71,032/yr"
1065,Honeywell,Data Scientist,1.0,Pune,"₹14,38,481/yr"
1066,Persistent Systems,Data Scientist,1.0,Pune,"₹2,141/hr"
1067,DONE by NONE,Data Scientist,1.0,Pune,"₹1,00,000/mo"
1068,DONE by NONE,Data Scientist,1.0,Pune,"₹44,44,315/yr"
1069,DONE by NONE,Data Scientist,1.0,Pune,"₹3,01,469/yr"
1070,WNS,Data Scientist,1.0,Pune,"£2,05,049/yr"
1071,Siemens,Data Scientist,1.0,Pune,"₹70,000/m
Query:
-- 6. Attempt to clean the Salary column by removing non-numeric characters
SELECT "Salary", 
       REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS "CleanedSalary"
FROM "SalaryDataset"
LIMIT 100
Answer:
Salary,CleanedSalary
"₹6,48,573/yr",648573/yr
"₹11,91,950/yr",1191950/yr
"₹8,36,874/yr",836874/yr
"₹6,69,578/yr",669578/yr
"₹9,44,110/yr",944110/yr
"₹9,08,764/yr",908764/yr
"₹9,26,124/yr",926124/yr
"₹7,36,708/yr",736708/yr
"₹16,46,721/yr",1646721/yr
"₹13,92,960/yr",1392960/yr
"₹14,04,773/yr",1404773/yr
"₹15,07,343/yr",1507343/yr
"₹15,58,095/yr",1558095/yr
"₹25,57,843/yr",2557843/yr
"₹15,10,081/yr",1510081/yr
"₹7,32,821/yr",732821/yr
"₹12,21,750/yr",1221750/yr
"₹17,39,484/yr",1739484/yr
"₹11,24,939/yr",1124939/yr
"₹16,30,396/yr",1630396/yr
"₹10,09,436/yr",1009436/yr
"₹5,50,980/yr",550980/yr
"₹18,70,000/yr",1870000/yr
"₹7,58,376/yr",758376/yr
"₹15,56,575/yr",1556575/yr
"₹11,94,327/yr",1194327/yr
"₹14,70,000/yr",1470000/yr
"₹15,49,942/yr",1549942/yr
"₹10,09,436/yr",1009436/yr
"₹15,41,572/yr",1541572/yr
"₹8,11,182/yr",811182/yr
"₹12,05,874/yr",1205874/yr
"₹7,27,111/yr",727111/yr
"₹19,23,257/yr",1923257/yr
"₹21,43,501/yr",2143501/yr
"₹19,26,965/yr",1926965/yr
"₹41,271/mo",41271/mo
"₹12,94,984/yr",1294984/yr
"₹23,34,960/yr",2334960/yr
"₹22,67,616/yr",2267616/yr
"₹13,66,992/yr",1366992/yr
"₹14,53,427/yr",1453427/yr
"₹14,58,032/yr",1458032/yr
"₹17,30,166/yr",1730166/yr
"₹6,58,109/yr",658109/yr
"₹7,94,460/yr",794460/yr
"₹25,67,381/yr",2567381/yr
"₹16,37,231/yr",1637231/yr
"₹9,00,000/yr",900000/yr
"₹9,02,935/yr",902935/yr
"₹9,70,782/yr",970782/yr
"₹10,50,000/yr",1050000/yr
"₹21,19,584/yr",2119584/yr
"₹16,87,111/yr",1687111/yr
"₹14,65,641/yr",1465641/yr
"₹6,00,000/yr",600000/yr
"₹18,05,869/yr",1805869/yr
"₹26,24,063/yr",2624063/yr
"₹9,55,297/yr",955297/yr
"₹7,61,478/yr",761478/yr
"₹28,05,476/yr",2805476/yr
"₹9,69,112/yr",969112/yr
"₹4,50,979/yr",450979/yr
"₹13,38,795/yr",1338795/yr
"₹10,40,493/yr",1040493/yr
"₹12,91,549/yr",1291549/yr
"₹49,928/mo",49928/mo
"₹16,63,189/yr",1663189/yr
"₹13,23,387/yr",1323387/yr
"₹12,46,266/yr",1246266/yr
"₹4,94,147/yr",494147/yr
"₹18,92,758/yr",1892758/yr
"₹15,72,054/yr",1572054/yr
"₹20,24,533/yr",2024533/yr
"₹19,27,564/yr",1927564/yr
"₹8,00,000/yr",800000/yr
"₹20,09,790/yr",2009790/yr
"₹8,31,462/yr",831462/yr
"₹5,16,323/yr",516323/yr
"₹23,33,241/yr",2333241/yr
"₹12,00,000/yr",1200000/yr
"₹20,06,522/yr",2006522/yr
"₹21,60,000/yr",2160000/yr
"₹13,41,316/yr",1341316/yr
"₹16,34,105/yr",1634105/yr
"₹13,89,256/yr",1389256/yr
"₹10,00,000/yr",1000000/yr
"₹12,31,116/yr",1231116/yr
"₹23,52,941/yr",2352941/yr
"₹7,44,551/yr",744551/yr
"₹30,14,686/yr",3014686/yr
"₹13,57,204/yr",1357204/yr
"₹10,53,196/yr",1053196/yr
"₹13,37,606/yr",1337606/yr
"₹48,825/mo",48825/mo
"₹32,953/mo",32953/mo
"₹16,49,930/yr",1649930/yr
"₹11,38,060/yr",1138060/yr
"₹16,12,744/yr",1612744/yr
"₹4,32,776/yr",432776/yr
Query:
-- 7. Convert the cleaned Salary to a numeric value
SELECT CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL) AS "SalaryNumeric"
FROM "SalaryDataset"
LIMIT 100
Answer:
SalaryNumeric
648573.0
1191950.0
836874.0
669578.0
944110.0
908764.0
926124.0
736708.0
1646721.0
1392960.0
1404773.0
1507343.0
1558095.0
2557843.0
1510081.0
732821.0
1221750.0
1739484.0
1124939.0
1630396.0
1009436.0
550980.0
1870000.0
758376.0
1556575.0
1194327.0
1470000.0
1549942.0
1009436.0
1541572.0
811182.0
1205874.0
727111.0
1923257.0
2143501.0
1926965.0
41271.0
1294984.0
2334960.0
2267616.0
1366992.0
1453427.0
1458032.0
1730166.0
658109.0
794460.0
2567381.0
1637231.0
900000.0
902935.0
970782.0
1050000.0
2119584.0
1687111.0
1465641.0
600000.0
1805869.0
2624063.0
955297.0
761478.0
2805476.0
969112.0
450979.0
1338795.0
1040493.0
1291549.0
49928.0
1663189.0
1323387.0
1246266.0
494147.0
1892758.0
1572054.0
2024533.0
1927564.0
800000.0
2009790.0
831462.0
516323.0
2333241.0
1200000.0
2006522.0
2160000.0
1341316.0
1634105.0
1389256.0
1000000.0
1231116.0
2352941.0
744551.0
3014686.0
1357204.0
1053196.0
1337606.0
48825.0
32953.0
1649930.0
1138060.0
1612744.0
432776.0
Query:
-- 8. Calculate average salary per company in Mumbai
SELECT "CompanyName",
       AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryMumbai"
FROM "SalaryDataset"
WHERE "Location" = 'Mumbai'
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AvgSalaryMumbai
20K Group,42892.0
72 Dragons,23043.0
AB Innovative Software,35568.0
ABC,571300.25
AGS Transact Technologies,35257.0
AIG,1187386.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
AXIS MY INDIA,374059.0
Aays Analytics,894346.0
Accenture,611859.8
Accion Labs,33879.0
Acuris Global,12060.0
Adani Group,95700.0
Aditya Birla Group,461882.5
Advisory Board,414388.0
Aegis,302200.0
Agape Marketing Agency,564654.0
Airpay,892152.0
Ajay bharti,401953.0
Algo Engines,1200000.0
Alpha Alternatives,15617.0
Amazon,1010146.5
American Automobile Association (AAA),1139568.0
AmyGB,40684.0
Anand Rathi,1095095.0
Angel One,527662.6666666666
Anonymous,48676.5
Anonymous Content,520597.0
Apical Solutions,1008975.0
Arohi Operations,30834.0
Arya.ai,838354.0
Ascent Health & Wellness Solutions,322465.0
At,1016376.0
AthenasOwl,778355.3333333334
Atos-Syntel,596458.0
Aureus Analytics,1028702.0
AxionConnect Infosolutions,5024.0
Axis Bank,736602.3333333334
B&B Analytics,5647.0
BDO,790515.0
BYJU'S,1000000.0
Bahar Infotech,15189.0
Bajaj Finance,25685.0
Bank of America,928488.0
Bank of America Merrill Lynch,1232857.0
Barclays,1040054.0
Bewakoof Brands,831538.5
Bharat Petroleum,2121545.0
Bharti Airtel,0.0
Biosense Technologies,26792.0
Bizongo,2597406.0
Bloomberg L.P.,139072.0
Blue Dart Express,1296967.0
Blue Ocean,12422.0
Bookmyshow,897278.5
Brandscapes Worldwide,245202.0
BridgeLabz Solutions,22304.0
Bristlecone,18273.0
CASHe,1098034.0
CMC,15124.0
CRG Solutions,521474.0
CRISIL,194054.0
Candere.com,504107.0
Capgemini,789216.0
Capgemini Engineering,45172.0
Capital One,33794.0
Career Launcher,5374.0
Cartesian Consulting,530781.0
Celebal Technologies,463374.0
Celusion Technologies,11293.0
Cere Labs,302507.0
Challenger Technologies,9034.0
Christian College of Engineering & Technology (CCET),123286.0
Cimpress,790515.0
Cipla,1088000.0
Cisco Systems,10880.0
Citi,1322737.0
CitiusTech,955754.6666666666
CloudFronts Technologies,74078.0
Clover Infotech,655953.0
Club 24,80718.0
Cogencis Information Services,143277.5
Cognizant Technology Solutions,702609.0
Cogoport,2000000.0
Colgate-Palmolive,385915.5
Collinson,1181308.0
Concerto Software,10749.0
Course5 Intelligence,386533.5
Craftsvilla.com,162802.0
Credit Suisse,105868.0
Crimson Interactive,1843745.0
Cuddle,1961487.0
Cuelogic Technologies,1100000.0
DAT Engineering,46854.0
DONE by NONE,117608.6
DT-Trak Consulting,600000.0
DXC Technology,731418.0
Danpal,322077.0
Data Axle,1000000.0
Query:
-- 9. Calculate overall average salary per company nationwide
SELECT "CompanyName",
       AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryNationwide"
FROM "SalaryDataset"
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AvgSalaryNationwide
,900189.6666666666
& Other Stories,722247.0
---,10000.0
159 Solutions,828777.0
1mg,991426.0
20K Group,32260.0
2COMS,467574.0
360DigiTMG,359620.0
3K Technologies,798116.0
3LOQ Labs,778644.0
3i Infotech,734390.0
4CRisk.ai,700000.0
54y4,100000.0
5x,450000.0
6sense,42995.0
72 Dragons,23043.0
91springboard,750000.0
AAKASH,50163.0
AAP,321161.0
AB Innovative Software,35568.0
ABB,955297.0
ABC,713195.15
ABC Consultants,4282144.0
ABC Supply Co.,524121.0
ABC Tech,61068.0
ABC do ABC,513743.0
ABCDEF,1643757.75
ABSAS Solutions,22283.0
ACD Communications,866307.0
ACS Solutions,992754.0
ADHOC Services,563464.0
ADP,896210.0
AFFINSYS AI,1450359.0
AGS Health,413352.0
AGS Transact Technologies,35257.0
AI Touch,15135.0
AIEnterprise,712525.0
AIG,922211.5
AIR Worldwide,398975.0
AIndra Labs,25349.0
AJIO,15000.0
ALBOT,600000.0
ALL IT Services,75366.0
ALTEN,1461604.0
AMCORE Financial,1800000.0
AMPROVIT TECHNOLOGIES,67517.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
ANZ Bank,1111352.0
AON,198811.0
AROHA TECHNOLOGIES,51799.0
ASD,196999.0
ASSAD,517986.0
ATS Services (India),34370.0
AXA,585774.0
AXA GO Business Operations,1344055.0
AXA XL,731213.0
AXIS MY INDIA,374059.0
Aashish sharma,1225579.0
Aays Analytics,894346.0
Abbott,1124740.0
Abhijeet Group,18570.0
Abhinav Immigration Services Pvt. Ltd.,1324539.0
Absolutdata,558121.0
Abzooba,1176621.1666666667
Acalvio,2442736.0
Accentue,1041548.5
Accenture,658121.1
Accion Labs,33879.0
Acclivis Technologies,1003261.0
Accretive Wiz@work Consultants,1300000.0
Accurence,102323.0
Acies,415492.0
Actiknow,363669.0
Activa (CA),1490685.0
Acuity Knowledge Partners,508899.0
Acuris Global,12060.0
AdWyze,31734.0
Adani Group,95700.0
Adappt Intelligence,360000.0
Add Innovations,310791.0
Adda 247,10653.0
Adecco,1349689.0
Adglobal360,345719.5
Aditi Software,469326.0
Aditya Birla Group,852989.0
Admit.me,1973587.0
Adobe,850445.625
Advanced Infrastructure Engineering,30269.0
Advisory Board,414388.0
Aegis,331210.0
Aegon,2508152.0
Aera Technology,1038643.25
Aera Technology Associate,1007334.0
Aeries Technology,1410268.0
Affine,784572.0
AffinityAnswers,735014.0
AffinityX,16147.0
Affle,933286.0
AgEye Technologies,518492.0
Query:
-- 10. Compare each company's average salary in Mumbai to the national average
SELECT m."CompanyName",
       m."AvgSalaryMumbai",
       n."AvgSalaryNationwide"
FROM (
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryMumbai"
    FROM "SalaryDataset"
    WHERE "Location" = 'Mumbai'
    GROUP BY "CompanyName"
    ORDER BY "AvgSalaryMumbai" DESC
    LIMIT 5
) m
JOIN (
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), 'k', '000'), 'K', '000'), ' ', '') AS REAL)) AS "AvgSalaryNationwide"
    FROM "SalaryDataset"
    GROUP BY "CompanyName"
) n ON m."CompanyName" = n."CompanyName"
LIMIT 100
Answer:
CompanyName,AvgSalaryMumbai,AvgSalaryNationwide
Rahul Industries,6044006.0,3037137.5
NVIDIA,4187500.0,1541363.3333333333
VINAYA KUMAR,4029337.0,2414668.5
Goldman Sachs,3977066.0,1903402.6
Zee Entertainment Enterprises Ltd.,3531413.0,3531413.0
End Exploring Related Columns
Task: Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations.

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, we first clean the salary data by removing any non-numeric characters and converting the values to a numeric type. We then calculate the average salary for each company in each specified location and compare it to the overall national average salary.

The final result is structured as follows:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,Company1:str,AvgSalaryState1:float,AvgSalaryCountry1:float
Mumbai,Company2:str,AvgSalaryState2:float,AvgSalaryCountry2:float
...
(Attention: Listing top 5 companies by average salary in each specified location)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is (table names): 
['hardware_dim_customer', 'hardware_fact_pre_invoice_deductions', 'web_sales_reps', 'hardware_dim_product', 'web_orders', 'StaffHours', 'university_enrollment', 'university_faculty', 'university_student', 'university_offering', 'web_accounts', 'web_events', 'SalaryDataset', 'web_region', 'hardware_fact_gross_price', 'hardware_fact_manufacturing_cost', 'university_course', 'hardware_fact_sales_monthly']

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 11:13:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:13:18 - root - INFO - To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, we first clean the salary data by removing any non-numeric characters and converting the values to a numeric type. We then calculate the average salary for each company in each specified location and compare it to the overall national average salary.

The final result is structured as follows:

```sql
WITH CleanedSalaryDataset AS (
  SELECT *,
    -- Remove currency symbols, commas, 'k', 'K', spaces, and '/yr' suffixes from Salary
    REPLACE(
      REPLACE(
        REPLACE(
          REPLACE(
            REPLACE(
              REPLACE("Salary", '₹', ''),
              ',',
              ''
            ),
            'k',
            '000'
          ),
          'K',
          '000'
        ),
        ' ',
        ''
      ),
      '/yr',
      ''
    ) AS "SalaryNoSuffix",
    -- Identify if the salary is monthly or yearly
    CASE
      WHEN "Salary" LIKE '%/mo%' THEN 'mo'
      WHEN "Salary" LIKE '%/yr%' THEN 'yr'
      ELSE NULL
    END AS "Period"
  FROM "SalaryDataset"
  WHERE "Salary" IS NOT NULL AND "Salary" != ''
),
ProcessedSalaryDataset AS (
  SELECT *,
    -- Convert the cleaned salary to a numeric value
    CAST("SalaryNoSuffix" AS REAL) AS "SalaryNumeric",
    -- Calculate the annual salary based on the period
    CASE
      WHEN "Period" = 'yr' THEN CAST("SalaryNoSuffix" AS REAL)
      WHEN "Period" = 'mo' THEN CAST("SalaryNoSuffix" AS REAL) * 12
      ELSE NULL
    END AS "AnnualSalary"
  FROM CleanedSalaryDataset
),
CompanyLocationAvg AS (
  -- Calculate average salary per company per specified location
  SELECT "CompanyName", "Location",
    AVG("AnnualSalary") AS "AvgSalaryState"
  FROM ProcessedSalaryDataset
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalAvg AS (
  -- Calculate average salary per company nationwide
  SELECT "CompanyName",
    AVG("AnnualSalary") AS "AvgSalaryCountry"
  FROM ProcessedSalaryDataset
  GROUP BY "CompanyName"
),
RankedCompanies AS (
  -- Rank companies by average salary within each location
  SELECT
    "CompanyName",
    "Location",
    "AvgSalaryState",
    ROW_NUMBER() OVER (PARTITION BY "Location" ORDER BY "AvgSalaryState" DESC) AS "Rank"
  FROM CompanyLocationAvg
)
-- Select top 5 companies per location and compare with national average
SELECT
  r."Location",
  r."CompanyName",
  r."AvgSalaryState",
  c."AvgSalaryCountry"
FROM
  RankedCompanies r
JOIN
  CompanyNationalAvg c ON r."CompanyName" = c."CompanyName"
WHERE
  r."Rank" <= 5
ORDER BY
  r."Location",
  r."AvgSalaryState" DESC;
```
2025-02-11 11:13:18 - root - INFO - itercount: 1
2025-02-11 11:13:18 - root - INFO - 0
2025-02-11 11:13:18 - root - INFO - results: 
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Hyderabad,SetuServ,4949704.0,4949704.0
Hyderabad,Enrich IBS,3773676.0,3773676.0
Hyderabad,Nassau Re,3773676.0,3773676.0
Hyderabad,Government of India,3748296.0,2309622.0
Mumbai,Rahul Industries,6044006.0,3203617.0
Mumbai,NVIDIA,4187500.0,1651506.3333333333
Mumbai,VINAYA KUMAR,4029337.0,2414668.5
Mumbai,Goldman Sachs,3977066.0,2172104.0
Mumbai,Aegis,3626400.0,1993310.0
New Delhi,Super Highway Labs,3665141.0,3665141.0
New Delhi,Flip Robo,3204288.0,1044723.0
New Delhi,Greenlight Planet,2876666.0,1918288.5
New Delhi,Wipro Technologies,2848511.0,1122077.0
New Delhi,Boston Scientific,2707106.0,2707106.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Pune,Google,5025572.0,1349261.3076923077
Pune,RAKESH GROUP,5016304.0,5016304.0
Pune,The City Bank,5000000.0,5000000.0


2025-02-11 11:13:18 - root - INFO - Please check the answer again by reviewing Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, we first clean the salary data by removing any non-numeric characters and converting the values to a numeric type. We then calculate the average salary for each company in each specified location and compare it to the overall national average salary.

The final result is structured as follows:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,Company1:str,AvgSalaryState1:float,AvgSalaryCountry1:float
Mumbai,Company2:str,AvgSalaryState2:float,AvgSalaryCountry2:float
...
(Attention: Listing top 5 companies by average salary in each specified location)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Hyderabad,SetuServ,4949704.0,4949704.0
Hyderabad,Enrich IBS,3773676.0,3773676.0
Hyderabad,Nassau Re,3773676.0,3773676.0
Hyderabad,Government of India,3748296.0,2309622.0
Mumbai,Rahul Industries,6044006.0,3203617.0
Mumbai,NVIDIA,4187500.0,1651506.3333333333
Mumbai,VINAYA KUMAR,4029337.0,2414668.5
Mumbai,Goldman Sachs,3977066.0,2172104.0
Mumbai,Aegis,3626400.0,1993310.0
New Delhi,Super Highway Labs,3665141.0,3665141.0
New Delhi,Flip Robo,3204288.0,1044723.0
New Delhi,Greenlight Planet,2876666.0,1918288.5
New Delhi,Wipro Technologies,2848511.0,1122077.0
New Delhi,Boston Scientific,2707106.0,2707106.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Pune,Google,5025572.0,1349261.3076923077
Pune,RAKESH GROUP,5016304.0,5016304.0
Pune,The City Bank,5000000.0,5000000.0
Current sql:
WITH CleanedSalaryDataset AS (
  SELECT *,
    -- Remove currency symbols, commas, 'k', 'K', spaces, and '/yr' suffixes from Salary
    REPLACE(
      REPLACE(
        REPLACE(
          REPLACE(
            REPLACE(
              REPLACE("Salary", '₹', ''),
              ',',
              ''
            ),
            'k',
            '000'
          ),
          'K',
          '000'
        ),
        ' ',
        ''
      ),
      '/yr',
      ''
    ) AS "SalaryNoSuffix",
    -- Identify if the salary is monthly or yearly
    CASE
      WHEN "Salary" LIKE '%/mo%' THEN 'mo'
      WHEN "Salary" LIKE '%/yr%' THEN 'yr'
      ELSE NULL
    END AS "Period"
  FROM "SalaryDataset"
  WHERE "Salary" IS NOT NULL AND "Salary" != ''
),
ProcessedSalaryDataset AS (
  SELECT *,
    -- Convert the cleaned salary to a numeric value
    CAST("SalaryNoSuffix" AS REAL) AS "SalaryNumeric",
    -- Calculate the annual salary based on the period
    CASE
      WHEN "Period" = 'yr' THEN CAST("SalaryNoSuffix" AS REAL)
      WHEN "Period" = 'mo' THEN CAST("SalaryNoSuffix" AS REAL) * 12
      ELSE NULL
    END AS "AnnualSalary"
  FROM CleanedSalaryDataset
),
CompanyLocationAvg AS (
  -- Calculate average salary per company per specified location
  SELECT "CompanyName", "Location",
    AVG("AnnualSalary") AS "AvgSalaryState"
  FROM ProcessedSalaryDataset
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalAvg AS (
  -- Calculate average salary per company nationwide
  SELECT "CompanyName",
    AVG("AnnualSalary") AS "AvgSalaryCountry"
  FROM ProcessedSalaryDataset
  GROUP BY "CompanyName"
),
RankedCompanies AS (
  -- Rank companies by average salary within each location
  SELECT
    "CompanyName",
    "Location",
    "AvgSalaryState",
    ROW_NUMBER() OVER (PARTITION BY "Location" ORDER BY "AvgSalaryState" DESC) AS "Rank"
  FROM CompanyLocationAvg
)
-- Select top 5 companies per location and compare with national average
SELECT
  r."Location",
  r."CompanyName",
  r."AvgSalaryState",
  c."AvgSalaryCountry"
FROM
  RankedCompanies r
JOIN
  CompanyNationalAvg c ON r."CompanyName" = c."CompanyName"
WHERE
  r."Rank" <= 5
ORDER BY
  r."Location",
  r."AvgSalaryState" DESC;
2025-02-11 11:14:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:14:08 - root - INFO - To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, we first clean the salary data by removing any non-numeric characters and converting the values to a numeric type. We then calculate the average salary for each company in each specified location and compare it to the overall national average salary.

The final result is structured as follows:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,Company1:str,AvgSalaryState1:float,AvgSalaryCountry1:float
Mumbai,Company2:str,AvgSalaryState2:float,AvgSalaryCountry2:float
...
(Attention: Listing top 5 companies by average salary in each specified location)
```

Here is the SQL query to achieve this:

```sql
WITH CleanedSalaryDataset AS (
  SELECT *,
    REPLACE(
      REPLACE(
        REPLACE(
          REPLACE(
            REPLACE(
              REPLACE(
                REPLACE("Salary", '₹', ''),
                ',',
                ''
              ),
              'k',
              '000'
            ),
            'K',
            '000'
          ),
          ' ',
          ''
        ),
        '/yr',
        ''
      ),
      '/mo',
      ''
    ) AS "SalaryNoSuffix",
    CASE
      WHEN "Salary" LIKE '%/mo%' THEN 'mo'
      WHEN "Salary" LIKE '%/yr%' THEN 'yr'
      ELSE NULL
    END AS "Period"
  FROM "SalaryDataset"
  WHERE "Salary" IS NOT NULL AND "Salary" != ''
),
ProcessedSalaryDataset AS (
  SELECT *,
    CAST("SalaryNoSuffix" AS REAL) AS "SalaryNumeric",
    CASE
      WHEN "Period" = 'yr' THEN CAST("SalaryNoSuffix" AS REAL)
      WHEN "Period" = 'mo' THEN CAST("SalaryNoSuffix" AS REAL) * 12
      ELSE NULL
    END AS "AnnualSalary"
  FROM CleanedSalaryDataset
  WHERE "Period" IS NOT NULL
),
CompanyLocationAvg AS (
  SELECT "CompanyName", "Location",
    AVG("AnnualSalary") AS "AvgSalaryState"
  FROM ProcessedSalaryDataset
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalAvg AS (
  SELECT "CompanyName",
    AVG("AnnualSalary") AS "AvgSalaryCountry"
  FROM ProcessedSalaryDataset
  GROUP BY "CompanyName"
),
RankedCompanies AS (
  SELECT
    "CompanyName",
    "Location",
    "AvgSalaryState",
    ROW_NUMBER() OVER (PARTITION BY "Location" ORDER BY "AvgSalaryState" DESC) AS "Rank"
  FROM CompanyLocationAvg
)
SELECT
  r."Location",
  r."CompanyName",
  ROUND(r."AvgSalaryState", 4) AS "Average Salary in State",
  ROUND(c."AvgSalaryCountry", 4) AS "Average Salary in Country"
FROM
  RankedCompanies r
JOIN
  CompanyNationalAvg c ON r."CompanyName" = c."CompanyName"
WHERE
  r."Rank" <= 5
ORDER BY
  r."Location",
  r."AvgSalaryState" DESC;
```
2025-02-11 11:14:09 - root - INFO - itercount: 2
2025-02-11 11:14:09 - root - INFO - 0
2025-02-11 11:14:09 - root - INFO - results: 
Location,CompanyName,Average Salary in State,Average Salary in Country
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Hyderabad,SetuServ,4949704.0,4949704.0
Hyderabad,Enrich IBS,3773676.0,3773676.0
Hyderabad,Nassau Re,3773676.0,3773676.0
Hyderabad,Government of India,3748296.0,2309622.0
Mumbai,Rahul Industries,6044006.0,3203617.0
Mumbai,NVIDIA,4187500.0,1651506.3333
Mumbai,VINAYA KUMAR,4029337.0,2414668.5
Mumbai,Goldman Sachs,3977066.0,2172104.0
Mumbai,Aegis,3626400.0,1993310.0
New Delhi,Super Highway Labs,3665141.0,3665141.0
New Delhi,Flip Robo,3204288.0,1044723.0
New Delhi,Greenlight Planet,2876666.0,1918288.5
New Delhi,Wipro Technologies,2848511.0,1122077.0
New Delhi,Boston Scientific,2707106.0,2707106.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Pune,Google,5025572.0,1349261.3077
Pune,RAKESH GROUP,5016304.0,5016304.0
Pune,The City Bank,5000000.0,5000000.0


2025-02-11 11:14:09 - root - INFO - Please check the answer again by reviewing Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, we first clean the salary data by removing any non-numeric characters and converting the values to a numeric type. We then calculate the average salary for each company in each specified location and compare it to the overall national average salary.

The final result is structured as follows:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,Company1:str,AvgSalaryState1:float,AvgSalaryCountry1:float
Mumbai,Company2:str,AvgSalaryState2:float,AvgSalaryCountry2:float
...
(Attention: Listing top 5 companies by average salary in each specified location)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Location,CompanyName,Average Salary in State,Average Salary in Country
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Hyderabad,SetuServ,4949704.0,4949704.0
Hyderabad,Enrich IBS,3773676.0,3773676.0
Hyderabad,Nassau Re,3773676.0,3773676.0
Hyderabad,Government of India,3748296.0,2309622.0
Mumbai,Rahul Industries,6044006.0,3203617.0
Mumbai,NVIDIA,4187500.0,1651506.3333
Mumbai,VINAYA KUMAR,4029337.0,2414668.5
Mumbai,Goldman Sachs,3977066.0,2172104.0
Mumbai,Aegis,3626400.0,1993310.0
New Delhi,Super Highway Labs,3665141.0,3665141.0
New Delhi,Flip Robo,3204288.0,1044723.0
New Delhi,Greenlight Planet,2876666.0,1918288.5
New Delhi,Wipro Technologies,2848511.0,1122077.0
New Delhi,Boston Scientific,2707106.0,2707106.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Pune,Google,5025572.0,1349261.3077
Pune,RAKESH GROUP,5016304.0,5016304.0
Pune,The City Bank,5000000.0,5000000.0
Current sql:
WITH CleanedSalaryDataset AS (
  SELECT *,
    REPLACE(
      REPLACE(
        REPLACE(
          REPLACE(
            REPLACE(
              REPLACE(
                REPLACE("Salary", '₹', ''),
                ',',
                ''
              ),
              'k',
              '000'
            ),
            'K',
            '000'
          ),
          ' ',
          ''
        ),
        '/yr',
        ''
      ),
      '/mo',
      ''
    ) AS "SalaryNoSuffix",
    CASE
      WHEN "Salary" LIKE '%/mo%' THEN 'mo'
      WHEN "Salary" LIKE '%/yr%' THEN 'yr'
      ELSE NULL
    END AS "Period"
  FROM "SalaryDataset"
  WHERE "Salary" IS NOT NULL AND "Salary" != ''
),
ProcessedSalaryDataset AS (
  SELECT *,
    CAST("SalaryNoSuffix" AS REAL) AS "SalaryNumeric",
    CASE
      WHEN "Period" = 'yr' THEN CAST("SalaryNoSuffix" AS REAL)
      WHEN "Period" = 'mo' THEN CAST("SalaryNoSuffix" AS REAL) * 12
      ELSE NULL
    END AS "AnnualSalary"
  FROM CleanedSalaryDataset
  WHERE "Period" IS NOT NULL
),
CompanyLocationAvg AS (
  SELECT "CompanyName", "Location",
    AVG("AnnualSalary") AS "AvgSalaryState"
  FROM ProcessedSalaryDataset
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalAvg AS (
  SELECT "CompanyName",
    AVG("AnnualSalary") AS "AvgSalaryCountry"
  FROM ProcessedSalaryDataset
  GROUP BY "CompanyName"
),
RankedCompanies AS (
  SELECT
    "CompanyName",
    "Location",
    "AvgSalaryState",
    ROW_NUMBER() OVER (PARTITION BY "Location" ORDER BY "AvgSalaryState" DESC) AS "Rank"
  FROM CompanyLocationAvg
)
SELECT
  r."Location",
  r."CompanyName",
  ROUND(r."AvgSalaryState", 4) AS "Average Salary in State",
  ROUND(c."AvgSalaryCountry", 4) AS "Average Salary in Country"
FROM
  RankedCompanies r
JOIN
  CompanyNationalAvg c ON r."CompanyName" = c."CompanyName"
WHERE
  r."Rank" <= 5
ORDER BY
  r."Location",
  r."AvgSalaryState" DESC;
2025-02-11 11:14:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:14:46 - root - INFO - To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, we first clean the salary data by removing any non-numeric characters and converting them to a numeric type. We then calculate the average salary for each company in each specified location and compare it to the overall national average salary.

The final result is structured as follows:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,Company1:str,AvgSalaryState1:float,AvgSalaryCountry1:float
Mumbai,Company2:str,AvgSalaryState2:float,AvgSalaryCountry2:float
...
(Attention: Listing top 5 companies by average salary in each specified location)
```

Here is the SQL query to achieve this:

```sql
WITH CleanedSalaryDataset AS (
  SELECT *,
    REPLACE(
      REPLACE(
        REPLACE(
          REPLACE(
            REPLACE(
              REPLACE(
                REPLACE("Salary", '₹', ''),
                ',',
                ''
              ),
              'k',
              '000'
            ),
            'K',
            '000'
          ),
          ' ',
          ''
        ),
        '/yr',
        ''
      ),
      '/mo',
      ''
    ) AS "SalaryNoSuffix",
    CASE
      WHEN "Salary" LIKE '%/mo%' THEN 'mo'
      WHEN "Salary" LIKE '%/yr%' THEN 'yr'
      ELSE NULL
    END AS "Period"
  FROM "SalaryDataset"
  WHERE "Salary" IS NOT NULL AND "Salary" != ''
),
ProcessedSalaryDataset AS (
  SELECT *,
    CAST("SalaryNoSuffix" AS REAL) AS "SalaryNumeric",
    CASE
      WHEN "Period" = 'yr' THEN CAST("SalaryNoSuffix" AS REAL)
      WHEN "Period" = 'mo' THEN CAST("SalaryNoSuffix" AS REAL) * 12
      ELSE NULL
    END AS "AnnualSalary"
  FROM CleanedSalaryDataset
  WHERE "Period" IS NOT NULL
),
CompanyLocationAvg AS (
  SELECT "CompanyName", "Location",
    AVG("AnnualSalary") AS "AvgSalaryState"
  FROM ProcessedSalaryDataset
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalAvg AS (
  SELECT "CompanyName",
    AVG("AnnualSalary") AS "AvgSalaryCountry"
  FROM ProcessedSalaryDataset
  GROUP BY "CompanyName"
),
RankedCompanies AS (
  SELECT
    "CompanyName",
    "Location",
    "AvgSalaryState",
    ROW_NUMBER() OVER (PARTITION BY "Location" ORDER BY "AvgSalaryState" DESC) AS "Rank"
  FROM CompanyLocationAvg
)
SELECT
  r."Location",
  r."CompanyName" AS "Company Name",
  ROUND(r."AvgSalaryState", 4) AS "Average Salary in State",
  ROUND(c."AvgSalaryCountry", 4) AS "Average Salary in Country"
FROM
  RankedCompanies r
JOIN
  CompanyNationalAvg c ON r."CompanyName" = c."CompanyName"
WHERE
  r."Rank" <= 5
ORDER BY
  r."Location",
  r."AvgSalaryState" DESC;
```
2025-02-11 11:14:46 - root - INFO - itercount: 3
2025-02-11 11:14:46 - root - INFO - 0
2025-02-11 11:14:46 - root - INFO - Total iteration counts: 3
