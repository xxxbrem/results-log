2025-02-11 15:27:14 - openai._base_client - INFO - Retrying request to /chat/completions in 0.496152 seconds
2025-02-11 15:28:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:28:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:16 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:16 - root - INFO - SQL:
SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Results:
category,category_name
1011700.0,CORN WHISKIES
1012300.0,SINGLE MALT SCOTCH
1701200.0,HOLIDAY VAP
1012100.0,CANADIAN WHISKIES
1022100.0,TEQUILA
1081300.0,AMERICAN CORDIALS & LIQUEURS
1081335.0,RASPBERRY SCHNAPPS
1081250.0,WHITE CREME DE MENTHE
1091400.0,IOWA DISTILLERIES
1011500.0,STRAIGHT RYE WHISKIES
1081500.0,ROCK & RYE
1082200.0,IMPORTED SCHNAPPS
1052100.0,IMPORTED BRANDIES
1062200.0,WHITE RUM
1062100.0,GOLD RUM
1031100.0,100 PROOF VODKA
1062300.0,AGED DARK RUM
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1081015.0,IMPORTED AMARETTO
1032200.0,IMPORTED VODKA - MISC
1011300.0,SINGLE BARREL BOURBON WHISKIES
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1901000.0,SPECIAL ORDER ITEMS
1081240.0,GREEN CREME DE MENTHE
1701100.0,DECANTERS & SPECIALTY PACKAGES
1071000.0,COCKTAILS/RTD
1091200.0,NEUTRAL GRAIN SPIRITS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1051010.0,AMERICAN GRAPE BRANDIES
1081370.0,WATERMELON SCHNAPPS
1090000.0,DISTILLED SPIRITS SPECIALTY
1081600.0,WHISKEY LIQUEUR
1051100.0,APRICOT BRANDIES
1012400.0,JAPANESE WHISKY
1031200.0,VODKA FLAVORED
1031000.0,AMERICAN VODKAS
1101100.0,AMERICAN ALCOHOL
1052010.0,IMPORTED GRAPE BRANDIES
1012400.0,IRISH WHISKIES
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1032100.0,
1032080.0,IMPORTED VODKAS
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1011800.0,IOWA DISTILLERY WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1012300.0,IRISH WHISKIES
1062050.0,BARBADOS RUM
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1081400.0,AMERICAN SCHNAPPS
1081210.0,CREME DE ALMOND
1081500.0,TRIPLE SEC
1062400.0,
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1031080.0,VODKA 80 PROOF
1011700.0,
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1041200.0,AMERICAN SLOE GINS
1081317.0,GRAPE SCHNAPPS
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM
1901200.0,SPECIAL ORDER ITEMS
1031110.0,LOW PROOF VODKA
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1031200.0,AMERICAN FLAVORED VODKA
1081220.0,DARK CREME DE CACAO
1011600.0,CORN WHISKIES
1070000.0,COCKTAILS/RTD
1082000.0,IMPORTED CORDIALS & LIQUEURS
1081300.0,PEPPERMINT SCHNAPPS
1081312.0,BUTTERSCOTCH SCHNAPPS
1012210.0,SINGLE MALT SCOTCH
1082100.0,IMPORTED CORDIALS & LIQUEURS
1042100.0,IMPORTED DRY GINS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1062300.0,FLAVORED RUM
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1081390.0,IMPORTED SCHNAPPS
1031100.0,AMERICAN VODKAS
1011400.0,BOTTLED IN BOND BOURBON
1032000.0,IMPORTED VODKAS
1091100.0,
1051140.0,PEACH BRANDIES
1081000.0,AMERICAN CORDIALS & LIQUEURS
1051150.0,MISCELLANEOUS  BRANDIES
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES

2025-02-11 15:28:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:17 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:18 - root - INFO - SQL:
SELECT "date", "category", "category_name", "bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   LIMIT 100;
Results:
date,category,category_name,bottles_sold
2022-12-01,1051100.0,AMERICAN BRANDIES,3
2022-09-14,1051100.0,AMERICAN BRANDIES,3
2023-11-09,1051100.0,AMERICAN BRANDIES,3
2023-11-08,1051100.0,AMERICAN BRANDIES,3
2024-09-26,1051100.0,AMERICAN BRANDIES,3
2024-02-02,1051100.0,AMERICAN BRANDIES,3
2024-04-25,1051100.0,AMERICAN BRANDIES,3
2022-01-14,1012200.0,SCOTCH WHISKIES,3
2022-07-01,1012200.0,SCOTCH WHISKIES,3
2024-08-29,1012200.0,SCOTCH WHISKIES,3
2023-04-20,1012200.0,SCOTCH WHISKIES,3
2023-02-14,1012200.0,SCOTCH WHISKIES,3
2022-01-27,1051100.0,AMERICAN BRANDIES,3
2023-11-16,1051100.0,AMERICAN BRANDIES,3
2023-06-09,1051100.0,AMERICAN BRANDIES,6
2023-09-27,1051100.0,AMERICAN BRANDIES,6
2022-09-09,1051100.0,AMERICAN BRANDIES,6
2024-06-26,1051100.0,AMERICAN BRANDIES,3
2022-03-23,1012200.0,SCOTCH WHISKIES,3
2022-03-02,1012200.0,SCOTCH WHISKIES,3
2024-07-02,1012200.0,SCOTCH WHISKIES,3
2023-12-12,1012200.0,SCOTCH WHISKIES,3
2024-06-11,1012200.0,SCOTCH WHISKIES,3
2023-08-10,1012200.0,SCOTCH WHISKIES,3
2024-01-10,1012200.0,SCOTCH WHISKIES,3
2022-01-07,1012200.0,SCOTCH WHISKIES,3
2022-01-18,1012200.0,SCOTCH WHISKIES,6
2024-03-13,1012200.0,SCOTCH WHISKIES,3
2022-02-21,1012200.0,SCOTCH WHISKIES,3
2022-01-07,1012200.0,SCOTCH WHISKIES,3
2022-11-16,1012200.0,SCOTCH WHISKIES,3
2023-09-18,1012200.0,SCOTCH WHISKIES,3
2024-03-10,1012200.0,SCOTCH WHISKIES,3
2023-01-23,1012200.0,SCOTCH WHISKIES,3
2023-12-19,1012200.0,SCOTCH WHISKIES,3
2022-10-20,1012200.0,SCOTCH WHISKIES,3
2022-09-29,1012200.0,SCOTCH WHISKIES,3
2024-01-05,1012200.0,SCOTCH WHISKIES,3
2024-01-05,1012200.0,SCOTCH WHISKIES,3
2023-07-07,1012200.0,SCOTCH WHISKIES,3
2022-08-30,1012300.0,SINGLE MALT SCOTCH,3
2023-11-22,1051100.0,AMERICAN BRANDIES,3
2022-12-06,1051100.0,AMERICAN BRANDIES,3
2023-01-23,1051100.0,AMERICAN BRANDIES,3
2022-04-29,1051100.0,AMERICAN BRANDIES,3
2022-02-08,1051100.0,AMERICAN BRANDIES,3
2023-05-04,1051100.0,AMERICAN BRANDIES,3
2022-11-15,1051100.0,AMERICAN BRANDIES,3
2022-02-02,1051100.0,AMERICAN BRANDIES,3
2024-05-28,1051100.0,AMERICAN BRANDIES,3
2022-10-27,1051100.0,AMERICAN BRANDIES,3
2022-08-02,1022200.0,100% AGAVE TEQUILA,3
2022-02-18,1082200.0,IMPORTED SCHNAPPS,3
2023-05-10,1082200.0,IMPORTED SCHNAPPS,3
2024-07-22,1082200.0,IMPORTED SCHNAPPS,3
2023-02-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-02-06,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-10-31,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-08-07,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2023-06-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-04-08,1081200.0,CREAM LIQUEURS,3
2023-05-30,1081200.0,CREAM LIQUEURS,3
2022-09-30,1081200.0,CREAM LIQUEURS,3
2023-03-13,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2023-09-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2024-08-23,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2024-08-19,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2022-11-04,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2022-04-19,1082000.0,IMPORTED CORDIALS & LIQUEURS,6
2023-11-22,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-08-06,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-03-06,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-04-06,1082000.0,IMPORTED CORDIALS & LIQUEURS,3
2024-07-02,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-05-31,1082000.0,IMPORTED CORDIALS & LIQUEURS,3
2024-07-24,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-01-09,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-04-26,1012400.0,IRISH WHISKIES,3
2023-09-09,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-08-02,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-07-16,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-03-20,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-12-27,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-06-13,1082000.0,IMPORTED CORDIALS & LIQUEURS,3
2022-12-05,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-04-03,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-05-14,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-04-25,1022200.0,100% AGAVE TEQUILA,-96
2023-11-30,1032100.0,IMPORTED VODKAS,-24
2023-01-11,1032200.0,IMPORTED FLAVORED VODKA,-18
2022-09-09,1031100.0,AMERICAN VODKAS,-18
2023-12-11,1071000.0,COCKTAILS/RTD,-36
2023-12-11,1081400.0,AMERICAN SCHNAPPS,-12
2023-11-14,1031100.0,AMERICAN VODKAS,-6
2024-08-30,1062400.0,SPICED RUM,-6
2022-12-30,1071000.0,COCKTAILS/RTD,-6
2023-05-30,1011200.0,STRAIGHT BOURBON WHISKIES,-12
2023-02-27,1011200.0,STRAIGHT BOURBON WHISKIES,-12
2023-06-26,1011300.0,SINGLE BARREL BOURBON WHISKIES,-12
2022-11-14,1031100.0,AMERICAN VODKAS,-24

2025-02-11 15:28:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:19 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:19 - root - INFO - SQL:
SELECT "category", "category_name", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category", "category_name"
   LIMIT 100;
Results:
category,category_name,total_bottles_sold
1022300.0,MEZCAL,78238
1081030.0,COFFEE LIQUEURS,517472
1081230.0,WHITE CREME DE CACAO,35292
1062500.0,,1674
1501100.0,HIGH PROOF BEER - AMERICAN,54
1071000.0,COCKTAILS/RTD,1470706
1701100.0,DECANTERS & SPECIALTY PACKAGES,620739
1091200.0,NEUTRAL GRAIN SPIRITS,379715
1900000.0,DELISTED / SPECIAL ORDER ITEMS,12
1091400.0,IOWA DISTILLERIES,16185
1041200.0,AMERICAN SLOE GINS,32610
1701200.0,HOLIDAY VAP,133
1082000.0,IMPORTED CORDIALS & LIQUEURS,2474168
1081200.0,CREAM LIQUEURS,4994560
1070100.0,TEMPORARY & SPECIALTY PACKAGES,177
1081500.0,ROCK & RYE,12167
1011700.0,CORN WHISKIES,78388
1081315.0,CINNAMON SCHNAPPS,179177
1041200.0,FLAVORED GIN,163044
1081100.0,,40
1052100.0,IMPORTED BRANDIES,5038278
1062200.0,WHITE RUM,4435551
1082200.0,IMPORTED SCHNAPPS,2671890
1011200.0,STRAIGHT BOURBON WHISKIES,15545048
1032100.0,IMPORTED VODKAS,6669509
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,1852
1081020.0,ANISETTE,5430
1011000.0,AMERICAN WHISKIES,66
1052010.0,IMPORTED GRAPE BRANDIES,1576061
1089290.0,,6
1032080.0,IMPORTED VODKAS,3776162
1082010.0,AMARETTO - IMPORTED,1509
1042000.0,IMPORTED GINS,312
1101100.0,AMERICAN ALCOHOL,228224
1031200.0,VODKA FLAVORED,3693136
1031000.0,AMERICAN VODKAS,16469
1081400.0,AMERICAN SCHNAPPS,6013697
1081500.0,TRIPLE SEC,1583487
1081210.0,CREME DE ALMOND,6620
1062400.0,,2941
1022300.0,,30
1081240.0,GREEN CREME DE MENTHE,45726
1011400.0,TENNESSEE WHISKIES,5515922
1011600.0,STRAIGHT RYE WHISKIES,995348
1031080.0,VODKA 80 PROOF,18124615
1081400.0,TRIPLE SEC,820517
1011700.0,,189
1071100.0,AMERICAN COCKTAILS,2120834
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,1754
1082390.0,SCHNAPPS - IMPORTED,560
1011800.0,IOWA DISTILLERY WHISKIES,9938
1051010.0,AMERICAN GRAPE BRANDIES,2630010
1081370.0,WATERMELON SCHNAPPS,156548
1090000.0,DISTILLED SPIRITS SPECIALTY,2132
1051140.0,PEACH BRANDIES,118174
1081000.0,AMERICAN CORDIALS & LIQUEURS,16130
1091300.0,,370
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,1877575
1031100.0,AMERICAN VODKAS,47420904
1081390.0,IMPORTED SCHNAPPS,1365246
1701100.0,TEMPORARY & SPECIALTY PACKAGES,2716488
101220.0,,21
1041100.0,AMERICAN DRY GINS,5836741
1051110.0,BLACKBERRY BRANDIES,425294
1081380.0,MISCELLANEOUS SCHNAPPS,179899
1081340.0,ROOT BEER SCHNAPPS,97720
1011500.0,STRAIGHT RYE WHISKIES,562264
1062250.0,,168
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,746695
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,960761
1081700.0,DISTILLED SPIRITS SPECIALTY,828898
1081355.0,STRAWBERRY SCHNAPPS,72278
1012400.0,IRISH WHISKIES,2590193
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,426480
1032100.0,,12755
1082015.0,IMPORTED AMARETTO,287
1052100.0,,26854
1081350.0,SPEARMINT SCHNAPPS,18912
1062300.0,AGED DARK RUM,341733
1012200.0,SCOTCH WHISKIES,2845134
1081330.0,PEACH SCHNAPPS,567257
1022100.0,MIXTO TEQUILA,5867690
1062500.0,FLAVORED RUM,4388156
1062310.0,SPICED RUM,6633940
1901100.0,DELISTED ITEMS,149
1012100.0,CANADIAN WHISKIES,35030612
1022100.0,TEQUILA,4079513
1081300.0,AMERICAN CORDIALS & LIQUEURS,4926464
1081335.0,RASPBERRY SCHNAPPS,71526
1022200.0,100% AGAVE TEQUILA,5852587
1051120.0,CHERRY BRANDIES,79465
1081300.0,PEPPERMINT SCHNAPPS,878339
1032230.0,IMPORTED VODKA - CHERRY,222
1901200.0,SPECIAL ORDER ITEMS,637511
1031110.0,LOW PROOF VODKA,8608
1012000.0,IMPORTED WHISKIES,72
1011500.0,BOTTLED IN BOND BOURBON,179697
1071100.0,COCKTAILS/RTD,3592940
1081010.0,AMERICAN AMARETTO,447099
1700000.0,TEMPORARY & SPECIALTY PACKAGES,182192

2025-02-11 15:28:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:28:20 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:21 - root - INFO - SQL:
SELECT "category", "category_name", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   LIMIT 100;
Results:
category,category_name,total_bottles_sold
1011700.0,CORN WHISKIES,27851
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,700
1062300.0,AGED DARK RUM,124723
1041300.0,AMERICAN SLOE GINS,8617
1031000.0,AMERICAN VODKAS,289
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,232261
1012400.0,IRISH WHISKIES,956732
1062200.0,WHITE RUM,1362966
1082200.0,IMPORTED SCHNAPPS,957833
1052100.0,IMPORTED BRANDIES,1354991
1081600.0,WHISKEY LIQUEUR,11967870
1081400.0,AMERICAN SCHNAPPS,2531079
1081500.0,TRIPLE SEC,561286
1011200.0,STRAIGHT BOURBON WHISKIES,4596736
1032100.0,IMPORTED VODKAS,1946590
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,198
1031100.0,AMERICAN VODKAS,17547955
1701100.0,TEMPORARY & SPECIALTY PACKAGES,1175307
1012300.0,SINGLE MALT SCOTCH,212487
1081000.0,AMERICAN CORDIALS & LIQUEURS,2044
1032200.0,IMPORTED FLAVORED VODKA,749291
1032000.0,IMPORTED VODKAS,2404
1901000.0,SPECIAL ORDER ITEMS,209270
1700000.0,TEMPORARY & SPECIALTY PACKAGES,16242
1071000.0,COCKTAILS/RTD,1470706
1091200.0,NEUTRAL GRAIN SPIRITS,116228
1022100.0,MIXTO TEQUILA,2176287
1062500.0,FLAVORED RUM,1463377
1042000.0,IMPORTED GINS,72
1082000.0,IMPORTED CORDIALS & LIQUEURS,260140
1011100.0,BLENDED WHISKIES,2316625
1012200.0,SCOTCH WHISKIES,533417
1041100.0,AMERICAN DRY GINS,972021
1011400.0,TENNESSEE WHISKIES,1981355
1011600.0,STRAIGHT RYE WHISKIES,365308
1012100.0,CANADIAN WHISKIES,8173740
1081300.0,AMERICAN CORDIALS & LIQUEURS,1217234
1022200.0,100% AGAVE TEQUILA,2921968
1081200.0,CREAM LIQUEURS,1046003
1082100.0,IMPORTED CORDIALS & LIQUEURS,1170433
1042100.0,IMPORTED DRY GINS,572572
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,885389
1071100.0,COCKTAILS/RTD,399626
1011500.0,BOTTLED IN BOND BOURBON,108448
1090000.0,DISTILLED SPIRITS SPECIALTY,100
1062100.0,GOLD RUM,206689
1022300.0,MEZCAL,41970
1011300.0,SINGLE BARREL BOURBON WHISKIES,127435
1041200.0,FLAVORED GIN,101892
1062400.0,SPICED RUM,3852972
1051100.0,AMERICAN BRANDIES,1969307
1901200.0,SPECIAL ORDER ITEMS,67123
1012000.0,IMPORTED WHISKIES,12
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,532612
1031200.0,AMERICAN FLAVORED VODKA,2851618
1070000.0,COCKTAILS/RTD,24
1081100.0,COFFEE LIQUEURS,274028

2025-02-11 15:28:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-02-11 15:28:22 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:22 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
Results:
month,total_bottles_sold
2022-01-01,2062829
2022-02-01,2094442
2022-03-01,2190674
2022-04-01,2560073
2022-05-01,2610732
2022-06-01,2783728
2022-07-01,2408078
2022-08-01,2885003
2022-09-01,2626119
2022-10-01,2728062
2022-11-01,2599143
2022-12-01,2883140
2023-01-01,2356148
2023-02-01,2287773
2023-03-01,2630242
2023-04-01,2391391
2023-05-01,2783716
2023-06-01,2910130
2023-07-01,2489992
2023-08-01,2777255
2023-09-01,2487699
2023-10-01,2741885
2023-11-01,2663993
2023-12-01,2743642
2024-01-01,2377520
2024-02-01,2439060
2024-03-01,2419405
2024-04-01,2639657
2024-05-01,2760679
2024-06-01,2629980
2024-07-01,2670785
2024-08-01,2628250
2024-09-01,2461228

2025-02-11 15:28:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:23 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:24 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month", "category", "category_name"
   ORDER BY "month", "category"
   LIMIT 100;
Results:
month,category,category_name,monthly_bottles_sold
2022-01-01,1011100.0,BLENDED WHISKIES,66930
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,116880
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2010
2022-01-01,1011400.0,TENNESSEE WHISKIES,44026
2022-01-01,1011500.0,BOTTLED IN BOND BOURBON,1871
2022-01-01,1011600.0,STRAIGHT RYE WHISKIES,9832
2022-01-01,1011700.0,CORN WHISKIES,473
2022-01-01,1012100.0,CANADIAN WHISKIES,197568
2022-01-01,1012200.0,SCOTCH WHISKIES,22925
2022-01-01,1012300.0,SINGLE MALT SCOTCH,7128
2022-01-01,1012400.0,IRISH WHISKIES,23482
2022-01-01,1022100.0,MIXTO TEQUILA,43337
2022-01-01,1022200.0,100% AGAVE TEQUILA,50549
2022-01-01,1022300.0,MEZCAL,735
2022-01-01,1031000.0,AMERICAN VODKAS,199
2022-01-01,1031100.0,AMERICAN VODKAS,429940
2022-01-01,1031200.0,AMERICAN FLAVORED VODKA,63611
2022-01-01,1032000.0,IMPORTED VODKAS,6
2022-01-01,1032100.0,IMPORTED VODKAS,45554
2022-01-01,1032200.0,IMPORTED FLAVORED VODKA,20464
2022-01-01,1041100.0,AMERICAN DRY GINS,20425
2022-01-01,1041200.0,FLAVORED GIN,946
2022-01-01,1041300.0,AMERICAN SLOE GINS,274
2022-01-01,1042000.0,IMPORTED GINS,24
2022-01-01,1042100.0,IMPORTED DRY GINS,12359
2022-01-01,1051100.0,AMERICAN BRANDIES,61714
2022-01-01,1052100.0,IMPORTED BRANDIES,31601
2022-01-01,1062100.0,GOLD RUM,5479
2022-01-01,1062200.0,WHITE RUM,36600
2022-01-01,1062300.0,AGED DARK RUM,3840
2022-01-01,1062400.0,SPICED RUM,98154
2022-01-01,1062500.0,FLAVORED RUM,34669
2022-01-01,1070000.0,COCKTAILS/RTD,12
2022-01-01,1071100.0,COCKTAILS/RTD,34083
2022-01-01,1081100.0,COFFEE LIQUEURS,7441
2022-01-01,1081200.0,CREAM LIQUEURS,34245
2022-01-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,35966
2022-01-01,1081400.0,AMERICAN SCHNAPPS,55064
2022-01-01,1081500.0,TRIPLE SEC,10285
2022-01-01,1081600.0,WHISKEY LIQUEUR,303738
2022-01-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,26373
2022-01-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3351
2022-01-01,1082200.0,IMPORTED SCHNAPPS,28081
2022-01-01,1090000.0,DISTILLED SPIRITS SPECIALTY,62
2022-01-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,48
2022-01-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4855
2022-01-01,1091200.0,NEUTRAL GRAIN SPIRITS,2744
2022-01-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,7517
2022-01-01,1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,6
2022-01-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,12576
2022-01-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,1932
2022-01-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,32591
2022-01-01,1901200.0,SPECIAL ORDER ITEMS,8254
2022-02-01,1011100.0,BLENDED WHISKIES,68355
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,115614
2022-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3120
2022-02-01,1011400.0,TENNESSEE WHISKIES,44865
2022-02-01,1011500.0,BOTTLED IN BOND BOURBON,2224
2022-02-01,1011600.0,STRAIGHT RYE WHISKIES,10326
2022-02-01,1011700.0,CORN WHISKIES,497
2022-02-01,1012000.0,IMPORTED WHISKIES,12
2022-02-01,1012100.0,CANADIAN WHISKIES,213188
2022-02-01,1012200.0,SCOTCH WHISKIES,14629
2022-02-01,1012300.0,SINGLE MALT SCOTCH,7036
2022-02-01,1012400.0,IRISH WHISKIES,37939
2022-02-01,1022100.0,MIXTO TEQUILA,61030
2022-02-01,1022200.0,100% AGAVE TEQUILA,63393
2022-02-01,1022300.0,MEZCAL,1366
2022-02-01,1031000.0,AMERICAN VODKAS,90
2022-02-01,1031100.0,AMERICAN VODKAS,415899
2022-02-01,1031200.0,AMERICAN FLAVORED VODKA,66843
2022-02-01,1032100.0,IMPORTED VODKAS,47501
2022-02-01,1032200.0,IMPORTED FLAVORED VODKA,19898
2022-02-01,1041100.0,AMERICAN DRY GINS,20154
2022-02-01,1041200.0,FLAVORED GIN,880
2022-02-01,1041300.0,AMERICAN SLOE GINS,215
2022-02-01,1042100.0,IMPORTED DRY GINS,15703
2022-02-01,1051100.0,AMERICAN BRANDIES,57151
2022-02-01,1052100.0,IMPORTED BRANDIES,36951
2022-02-01,1062100.0,GOLD RUM,5976
2022-02-01,1062200.0,WHITE RUM,39023
2022-02-01,1062300.0,AGED DARK RUM,3312
2022-02-01,1062400.0,SPICED RUM,89388
2022-02-01,1062500.0,FLAVORED RUM,37238
2022-02-01,1071100.0,COCKTAILS/RTD,44098
2022-02-01,1081000.0,AMERICAN CORDIALS & LIQUEURS,84
2022-02-01,1081100.0,COFFEE LIQUEURS,7757
2022-02-01,1081200.0,CREAM LIQUEURS,31105
2022-02-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,31386
2022-02-01,1081400.0,AMERICAN SCHNAPPS,50838
2022-02-01,1081500.0,TRIPLE SEC,12612
2022-02-01,1081600.0,WHISKEY LIQUEUR,284186
2022-02-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,41967
2022-02-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3837
2022-02-01,1082200.0,IMPORTED SCHNAPPS,29182
2022-02-01,1090000.0,DISTILLED SPIRITS SPECIALTY,36
2022-02-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,24
2022-02-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4341
2022-02-01,1091200.0,NEUTRAL GRAIN SPIRITS,3495
2022-02-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,7857

2025-02-11 15:28:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:25 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:25 - root - INFO - SQL:
SELECT "category", "category_name", COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "months_with_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category", "category_name"
   HAVING COUNT(DISTINCT DATE_TRUNC('month', "date")) >= 24
   LIMIT 100;
Results:
category,category_name,months_with_sales
1091400.0,IOWA DISTILLERIES,25
1081240.0,GREEN CREME DE MENTHE,56
1081600.0,WHISKEY LIQUEUR,153
1051100.0,APRICOT BRANDIES,56
1901000.0,SPECIAL ORDER ITEMS,27
1700000.0,TEMPORARY & SPECIALTY PACKAGES,33
1041150.0,FLAVORED GINS,56
1071100.0,COCKTAILS/RTD,71
1011500.0,BOTTLED IN BOND BOURBON,98
1081010.0,AMERICAN AMARETTO,56
1051140.0,PEACH BRANDIES,56
1081000.0,AMERICAN CORDIALS & LIQUEURS,82
1062300.0,AGED DARK RUM,98
1041200.0,AMERICAN SLOE GINS,56
1051010.0,AMERICAN GRAPE BRANDIES,56
1081380.0,MISCELLANEOUS SCHNAPPS,56
1041100.0,AMERICAN DRY GINS,153
1051110.0,BLACKBERRY BRANDIES,56
1081340.0,ROOT BEER SCHNAPPS,56
1022200.0,,54
1011300.0,TENNESSEE WHISKIES,56
1012100.0,CANADIAN WHISKIES,153
1081335.0,RASPBERRY SCHNAPPS,56
1081300.0,AMERICAN CORDIALS & LIQUEURS,97
1022100.0,TEQUILA,56
1081250.0,WHITE CREME DE MENTHE,49
1012210.0,SINGLE MALT SCOTCH,56
1081312.0,BUTTERSCOTCH SCHNAPPS,56
1091200.0,NEUTRAL GRAIN SPIRITS,98
1701100.0,DECANTERS & SPECIALTY PACKAGES,56
1071000.0,COCKTAILS/RTD,27
1062500.0,FLAVORED RUM,98
1022100.0,MIXTO TEQUILA,98
1062310.0,SPICED RUM,56
1012300.0,SINGLE MALT SCOTCH,98
1011800.0,IOWA DISTILLERY WHISKIES,24
1031000.0,AMERICAN VODKAS,56
1101100.0,AMERICAN ALCOHOL,56
1031200.0,VODKA FLAVORED,56
1081370.0,WATERMELON SCHNAPPS,56
1032080.0,IMPORTED VODKAS,56
1082010.0,AMARETTO - IMPORTED,37
1011500.0,STRAIGHT RYE WHISKIES,56
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,67
1071100.0,AMERICAN COCKTAILS,56
1081300.0,PEPPERMINT SCHNAPPS,56
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,56
1081317.0,GRAPE SCHNAPPS,56
1081030.0,COFFEE LIQUEURS,56
1081230.0,WHITE CREME DE CACAO,56
1081330.0,PEACH SCHNAPPS,56
1012200.0,SCOTCH WHISKIES,153
1081400.0,AMERICAN SCHNAPPS,98
1081500.0,TRIPLE SEC,98
1081210.0,CREME DE ALMOND,54
1062100.0,GOLD RUM,98
1031100.0,100 PROOF VODKA,56
1082000.0,IMPORTED CORDIALS & LIQUEURS,92
1051120.0,CHERRY BRANDIES,56
1022200.0,100% AGAVE TEQUILA,98
1062050.0,BARBADOS RUM,56
1012300.0,IRISH WHISKIES,56
1081500.0,ROCK & RYE,56
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,56
1081700.0,DISTILLED SPIRITS SPECIALTY,56
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,98
1081355.0,STRAWBERRY SCHNAPPS,56
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,97
1012400.0,IRISH WHISKIES,98
1082015.0,IMPORTED AMARETTO,25
1032100.0,,30
1011700.0,CORN WHISKIES,98
1032100.0,IMPORTED VODKAS,97
1011200.0,STRAIGHT BOURBON WHISKIES,153
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,54
1081020.0,ANISETTE,55
1051150.0,MISCELLANEOUS  BRANDIES,56
1901200.0,SPECIAL ORDER ITEMS,72
1031110.0,LOW PROOF VODKA,43
1052010.0,IMPORTED GRAPE BRANDIES,56
1011400.0,TENNESSEE WHISKIES,98
1031080.0,VODKA 80 PROOF,56
1011600.0,STRAIGHT RYE WHISKIES,98
1081400.0,TRIPLE SEC,56
1022300.0,MEZCAL,98
1062200.0,WHITE RUM,98
1052100.0,IMPORTED BRANDIES,98
1082200.0,IMPORTED SCHNAPPS,98
1041200.0,FLAVORED GIN,98
1081315.0,CINNAMON SCHNAPPS,56
1051100.0,AMERICAN BRANDIES,98
1062400.0,SPICED RUM,98
1081365.0,TROPICAL FRUIT SCHNAPPS,56
1042100.0,IMPORTED DRY GINS,153
1082100.0,IMPORTED CORDIALS & LIQUEURS,96
1062300.0,FLAVORED RUM,56
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,97
1081390.0,IMPORTED SCHNAPPS,56
1031100.0,AMERICAN VODKAS,97
1701100.0,TEMPORARY & SPECIALTY PACKAGES,97

2025-02-11 15:28:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:26 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:27 - root - INFO - SQL:
SELECT "category", "category_name", AVG("monthly_bottles_sold") AS "average_monthly_sales"
   FROM (
     SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     GROUP BY "month", "category", "category_name"
   ) AS monthly_sales
   GROUP BY "category", "category_name"
   ORDER BY "average_monthly_sales" DESC
   LIMIT 100;
Results:
category,category_name,average_monthly_sales
1031100.0,AMERICAN VODKAS,488875.298969
1031080.0,VODKA 80 PROOF,323653.839286
1012100.0,CANADIAN WHISKIES,228958.248366
1081600.0,WHISKEY LIQUEUR,191712.209150
1062400.0,SPICED RUM,119439.540816
1062310.0,SPICED RUM,118463.214286
1011200.0,STRAIGHT BOURBON WHISKIES,101601.620915
1031200.0,AMERICAN FLAVORED VODKA,80022.744898
1011100.0,BLENDED WHISKIES,74317.065359
1022100.0,TEQUILA,72848.446429
1032100.0,IMPORTED VODKAS,68757.824742
1032080.0,IMPORTED VODKAS,67431.464286
1031200.0,VODKA FLAVORED,65948.857143
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,64561.107143
1051100.0,AMERICAN BRANDIES,63389.897959
1081400.0,AMERICAN SCHNAPPS,61364.255102
1022100.0,MIXTO TEQUILA,59874.387755
1022200.0,100% AGAVE TEQUILA,59720.275510
1011400.0,TENNESSEE WHISKIES,56284.918367
1071000.0,COCKTAILS/RTD,54470.592593
1052100.0,IMPORTED BRANDIES,51411.000000
1081300.0,AMERICAN CORDIALS & LIQUEURS,50788.288660
1071100.0,COCKTAILS/RTD,50604.788732
1051010.0,AMERICAN GRAPE BRANDIES,46964.464286
1011300.0,TENNESSEE WHISKIES,46429.964286
1062200.0,WHITE RUM,45260.724490
1062500.0,FLAVORED RUM,44777.102041
1041100.0,AMERICAN DRY GINS,38148.633987
1071100.0,AMERICAN COCKTAILS,37872.035714
1062300.0,FLAVORED RUM,37375.017857
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,33528.125000
1081200.0,CREAM LIQUEURS,32644.183007
1032200.0,IMPORTED VODKA - MISC,31647.910714
1052010.0,IMPORTED GRAPE BRANDIES,28143.946429
1701100.0,TEMPORARY & SPECIALTY PACKAGES,28005.030928
1032200.0,IMPORTED FLAVORED VODKA,27462.377551
1082200.0,IMPORTED SCHNAPPS,27264.183673
1082000.0,IMPORTED CORDIALS & LIQUEURS,26893.130435
1012400.0,IRISH WHISKIES,26430.540816
1081390.0,IMPORTED SCHNAPPS,24379.392857
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,20049.969072
1012200.0,SCOTCH WHISKIES,18595.647059
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,17156.446429
1081500.0,TRIPLE SEC,16158.030612
1031100.0,100 PROOF VODKA,15884.125000
1042100.0,IMPORTED DRY GINS,15775.398693
1081300.0,PEPPERMINT SCHNAPPS,15684.625000
1081700.0,DISTILLED SPIRITS SPECIALTY,14801.750000
1081400.0,TRIPLE SEC,14652.089286
1012300.0,IRISH WHISKIES,13342.428571
1082100.0,IMPORTED CORDIALS & LIQUEURS,12721.604167
1701100.0,DECANTERS & SPECIALTY PACKAGES,11084.625000
1011600.0,STRAIGHT RYE WHISKIES,10156.612245
1081330.0,PEACH SCHNAPPS,10129.589286
1011500.0,STRAIGHT RYE WHISKIES,10040.428571
1081030.0,COFFEE LIQUEURS,9240.571429
1901200.0,SPECIAL ORDER ITEMS,8854.319444
1081100.0,COFFEE LIQUEURS,8790.938776
1081010.0,AMERICAN AMARETTO,7983.910714
1901000.0,SPECIAL ORDER ITEMS,7750.740741
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,7619.336735
1051110.0,BLACKBERRY BRANDIES,7594.535714
1062100.0,GOLD RUM,7484.224490
1012300.0,SINGLE MALT SCOTCH,6952.826531
1700000.0,TEMPORARY & SPECIALTY PACKAGES,5520.969697
1012210.0,SINGLE MALT SCOTCH,5315.946429
1051100.0,APRICOT BRANDIES,4588.071429
1081305.0,APPLE SCHNAPPS,4503.589286
1052100.0,,4475.666667
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4396.701031
1101100.0,AMERICAN ALCOHOL,4075.428571
1081312.0,BUTTERSCOTCH SCHNAPPS,3961.928571
1091200.0,NEUTRAL GRAIN SPIRITS,3874.642857
1062300.0,AGED DARK RUM,3487.071429
1081380.0,MISCELLANEOUS SCHNAPPS,3212.482143
1081315.0,CINNAMON SCHNAPPS,3199.589286
1081370.0,WATERMELON SCHNAPPS,2795.500000
1081317.0,GRAPE SCHNAPPS,2496.125000
1011300.0,SINGLE BARREL BOURBON WHISKIES,2392.428571
,,2241.674699
1051140.0,PEACH BRANDIES,2110.250000
1011500.0,BOTTLED IN BOND BOURBON,1833.642857
1081015.0,IMPORTED AMARETTO,1754.040816
1081340.0,ROOT BEER SCHNAPPS,1745.000000
1041200.0,FLAVORED GIN,1663.714286
1051120.0,CHERRY BRANDIES,1419.017857
1062100.0,JAMAICA RUM,1405.000000
1081355.0,STRAWBERRY SCHNAPPS,1290.678571
1081335.0,RASPBERRY SCHNAPPS,1277.250000
1041150.0,FLAVORED GINS,1079.982143
1081365.0,TROPICAL FRUIT SCHNAPPS,1072.535714
1062050.0,BARBADOS RUM,1056.928571
1032000.0,IMPORTED VODKAS,975.954545
1081240.0,GREEN CREME DE MENTHE,816.535714
1011700.0,CORN WHISKIES,799.877551
1022300.0,MEZCAL,798.346939
1062400.0,,735.250000
1011250.0,SINGLE BARREL BOURBON WHISKIES,660.035714
1091400.0,IOWA DISTILLERIES,647.400000
1081230.0,WHITE CREME DE CACAO,630.214286

2025-02-11 15:28:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:28:28 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:28 - root - INFO - SQL:
SELECT "category", "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   LIMIT 100;
Results:
category,category_name,total_volume_liters
1011700.0,CORN WHISKIES,19992.15000000001
1062300.0,AGED DARK RUM,101947.19999999998
1011200.0,STRAIGHT BOURBON WHISKIES,3661763.7800000007
1032100.0,IMPORTED VODKAS,1964598.22
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,148.5
1062200.0,WHITE RUM,1415858.47
1082200.0,IMPORTED SCHNAPPS,852297.6999999997
1052100.0,IMPORTED BRANDIES,627738.05
1031000.0,AMERICAN VODKAS,211.15
1022200.0,100% AGAVE TEQUILA,2033489.7700000005
1081600.0,WHISKEY LIQUEUR,2996627.1100000003
1071100.0,COCKTAILS/RTD,570111.73
1011500.0,BOTTLED IN BOND BOURBON,93243.55000000002
1082000.0,IMPORTED CORDIALS & LIQUEURS,176152.63
1012200.0,SCOTCH WHISKIES,570816.37
1012100.0,CANADIAN WHISKIES,7888910.249999997
1081300.0,AMERICAN CORDIALS & LIQUEURS,548097.4499999998
1041100.0,AMERICAN DRY GINS,808267.2699999999
1081400.0,AMERICAN SCHNAPPS,1268049.66
1081500.0,TRIPLE SEC,553115.75
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,165376.97999999998
1012400.0,IRISH WHISKIES,801182.6199999999
1041300.0,AMERICAN SLOE GINS,8552.0
1081000.0,AMERICAN CORDIALS & LIQUEURS,1277.1000000000001
1071000.0,COCKTAILS/RTD,1976413.39
1091200.0,NEUTRAL GRAIN SPIRITS,88530.09999999996
1042000.0,IMPORTED GINS,54.0
1032000.0,IMPORTED VODKAS,2049.5000000000005
1011300.0,SINGLE BARREL BOURBON WHISKIES,95634.75
1901200.0,SPECIAL ORDER ITEMS,104864.21999999999
1012000.0,IMPORTED WHISKIES,9.0
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,275923.69999999995
1031200.0,AMERICAN FLAVORED VODKA,2000078.3900000008
1070000.0,COCKTAILS/RTD,24.0
1062100.0,GOLD RUM,226745.01
1012300.0,SINGLE MALT SCOTCH,164171.05000000005
1901000.0,SPECIAL ORDER ITEMS,295926.9400000002
1700000.0,TEMPORARY & SPECIALTY PACKAGES,21210.420000000002
1081200.0,CREAM LIQUEURS,892286.9799999999
1011100.0,BLENDED WHISKIES,1924959.8899999997
1032200.0,IMPORTED FLAVORED VODKA,583466.47
1062500.0,FLAVORED RUM,1348587.12
1022100.0,MIXTO TEQUILA,1673871.4999999998
1011400.0,TENNESSEE WHISKIES,1408056.1700000002
1011600.0,STRAIGHT RYE WHISKIES,281479.3
1022300.0,MEZCAL,31551.199999999997
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,373.9999999999999
1041200.0,FLAVORED GIN,76149.0
1062400.0,SPICED RUM,3769932.240000001
1051100.0,AMERICAN BRANDIES,1014426.1400000001
1082100.0,IMPORTED CORDIALS & LIQUEURS,851256.7600000002
1042100.0,IMPORTED DRY GINS,546013.9799999999
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,801322.54
1031100.0,AMERICAN VODKAS,15645738.36
1701100.0,TEMPORARY & SPECIALTY PACKAGES,894384.3699999998
1090000.0,DISTILLED SPIRITS SPECIALTY,75.0
1081100.0,COFFEE LIQUEURS,232840.93

2025-02-11 15:28:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:30 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:30 - root - INFO - SQL:
SELECT
      category_monthly."month",
      category_monthly."category",
      category_monthly."category_name",
      (category_monthly."monthly_bottles_sold" / total_monthly."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM (
      SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
      FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
      WHERE "date" >= '2022-01-01'
      GROUP BY "month", "category", "category_name"
    ) AS category_monthly
    JOIN (
      SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
      FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
      WHERE "date" >= '2022-01-01'
      GROUP BY "month"
    ) AS total_monthly
    ON category_monthly."month" = total_monthly."month"
    ORDER BY category_monthly."month", "percentage_contribution" DESC
    LIMIT 100;
Results:
Too long, hard cut:
month,category,category_name,percentage_contribution
2022-01-01,1031100.0,AMERICAN VODKAS,20.842300
2022-01-01,1081600.0,WHISKEY LIQUEUR,14.724300
2022-01-01,1012100.0,CANADIAN WHISKIES,9.577500
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.666000
2022-01-01,1062400.0,SPICED RUM,4.758200
2022-01-01,1011100.0,BLENDED WHISKIES,3.244600
2022-01-01,1031200.0,AMERICAN FLAVORED VODKA,3.083700
2022-01-01,1051100.0,AMERICAN BRANDIES,2.991700
2022-01-01,1081400.0,AMERICAN SCHNAPPS,2.669300
2022-01-01,1022200.0,100% AGAVE TEQUILA,2.450500
2022-01-01,1032100.0,IMPORTED VODKAS,2.208300
2022-01-01,1011400.0,TENNESSEE WHISKIES,2.134300
2022-01-01,1022100.0,MIXTO TEQUILA,2.100900
2022-01-01,1062200.0,WHITE RUM,1.774300
2022-01-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,1.743500
2022-01-01,1062500.0,FLAVORED RUM,1.680700
2022-01-01,1081200.0,CREAM LIQUEURS,1.660100
2022-01-01,1071100.0,COCKTAILS/RTD,1.652200
2022-01-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,1.579900
2022-01-01,1052100.0,IMPORTED BRANDIES,1.531900
2022-01-01,1082200.0,IMPORTED SCHNAPPS,1.361300
2022-01-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,1.278500
2022-01-01,1012400.0,IRISH WHISKIES,1.138300
2022-01-01,1012200.0,SCOTCH WHISKIES,1.111300
2022-01-01,1032200.0,IMPORTED FLAVORED VODKA,0.992000
2022-01-01,1041100.0,AMERICAN DRY GINS,0.990100
2022-01-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.609600
2022-01-01,1042100.0,IMPORTED DRY GINS,0.599100
2022-01-01,1081500.0,TRIPLE SEC,0.498600
2022-01-01,1011600.0,STRAIGHT RYE WHISKIES,0.476600
2022-01-01,1901200.0,SPECIAL ORDER ITEMS,0.400100
2022-01-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,0.364400
2022-01-01,1081100.0,COFFEE LIQUEURS,0.360700
2022-01-01,1012300.0,SINGLE MALT SCOTCH,0.345500
2022-01-01,1062100.0,GOLD RUM,0.265600
2022-01-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.235400
2022-01-01,1062300.0,AGED DARK RUM,0.186200
2022-01-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,0.162400
2022-01-01,1091200.0,NEUTRAL GRAIN SPIRITS,0.133000
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,0.097400
2022-01-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,0.093700
2022-01-01,1011500.0,BOTTLED IN BOND BOURBON,0.090700
2022-01-01,1041200.0,FLAVORED GIN,0.045900
2022-01-01,1022300.0,MEZCAL,0.035600
2022-01-01,1011700.0,CORN WHISKIES,0.022900
2022-01-01,1041300.0,AMERICAN SLOE GINS,0.013300
2022-01-01,1031000.0,AMERICAN VODKAS,0.009600
2022-01-01,1090000.0,DISTILLED SPIRITS SPECIALTY,0.003000
2022-01-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.002300
2022-01-01,1042000.0,IMPORTED GINS,0.001200
2022-01-01,1070000.0,COCKTAILS/RTD,0.000600
2022-01-01,1032000.0,IMPORTED VODKAS,0.000300
2022-01-01,1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.000300
2022-02-01,1031100.0,AMERICAN VODKAS,19.857300
2022-02-01,1081600.0,WHISKEY LIQUEUR,13.568600
2022-02-01,1012100.0,CANADIAN WHISKIES,10.178700
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.520000
2022-02-01,1062400.0,SPICED RUM,4.267900
2022-02-01,1011100.0,BLENDED WHISKIES,3.263600
2022-02-01,1031200.0,AMERICAN FLAVORED VODKA,3.191400
2022-02-01,1022200.0,100% AGAVE TEQUILA,3.026700
2022-02-01,1022100.0,MIXTO TEQUILA,2.913900
2022-02-01,1051100.0,AMERICAN BRANDIES,2.728700
2022-02-01,1081400.0,AMERICAN SCHNAPPS,2.427300
2022-02-01,1032100.0,IMPORTED VODKAS,2.268000
2022-02-01,1011400.0,TENNESSEE WHISKIES,2.142100
2022-02-01,1071100.0,COCKTAILS/RTD,2.105500
2022-02-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,2.003700
2022-02-01,1062200.0,WHITE RUM,1.863200
2022-02-01,1012400.0,IRISH WHISKIES,1.811400
2022-02-01,1062500.0,FLAVORED RUM,1.777900
2022-02-01,1052100.0,IMPORTED BRANDIES,1.764200
2022-02-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,1.498500
2022-02-01,1081200.0,CREAM LIQUEURS,1.485100
2022-02-01,1082200.0,IMPORTED SCHNAPPS,1.393300
2022-02-01,1041100.0,AMERICAN DRY GINS,0.962300
2022-02-01,1032200.0,IMPORTED FLAVORED VODKA,0.950000
2022-02-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.941300
2022-02-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,0.894800
2022-02-01,1042100.0,IMPORTED DRY GINS,0.749700
2022-02-01,1012200.0,SCOTCH WHISKIES,0.698500
2022-02-01,1081500.0,TRIPLE SEC,0.602200
2022-02-01,1011600.0,STRAIGHT RYE WHISKIES,0.493000
2022-02-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,0.375100
2022-02-01,1081100.0,COFFEE LIQUEURS,0.370400
2022-02-01,1012300.0,SINGLE MALT SCOTCH,0.335900
2022-02-01,1062100.0,GOLD RUM,0.285300
2022-02-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.207300
2022-02-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,0.183200
2022-02-01,1091200.0,NEUTRAL GRAIN SPIRITS,0.166900
2022-02-01,1062300.0,AGED DARK RUM,0.158100
2022-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,0.149000
2022-02-01,1901200.0,SPECIAL ORDER ITEMS,0.126100
2022-02-01,1011500.0,BOTTLED IN BOND BOURBON,0.106200
2022-02-01,1022300.0,MEZCAL,0.065200
2022-02-01,1041200.0,FLAVORED GIN,0.042000
2022-02-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,0.034600
2022-02-01,1011700.0,CORN WHISKIES,0.023700
2022-02-01,1041300.0,AMERICAN SLOE GINS,0.01030

2025-02-11 15:28:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 41
2025-02-11 15:28:31 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:32 - root - INFO - SQL:
SELECT
      "category",
      "category_name",
      AVG("percentage_contribution") AS "average_percentage"
    FROM (
      SELECT
        category_monthly."month",
        category_monthly."category",
        category_monthly."category_name",
        (category_monthly."monthly_bottles_sold" / total_monthly."total_bottles_sold") * 100 AS "percentage_contribution"
      FROM (
        SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "month", "category", "category_name"
      ) AS category_monthly
      JOIN (
        SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "month"
      ) AS total_monthly
      ON category_monthly."month" = total_monthly."month"
    ) AS percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1
    ORDER BY "average_percentage" DESC
    LIMIT 100;
Results:
category,category_name,average_percentage
1031100.0,AMERICAN VODKAS,20.656546391753
1031080.0,VODKA 80 PROOF,18.781676785714
1012100.0,CANADIAN WHISKIES,10.832516339869
1081600.0,WHISKEY LIQUEUR,8.226410457516
1062310.0,SPICED RUM,6.880446428571
1062400.0,SPICED RUM,5.092378571429
1011200.0,STRAIGHT BOURBON WHISKIES,4.654230718954
1022100.0,TEQUILA,4.236514285714
1032080.0,IMPORTED VODKAS,3.909978571429
1031200.0,VODKA FLAVORED,3.809821428571
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,3.766185714286
1011100.0,BLENDED WHISKIES,3.594673856209
1031200.0,AMERICAN FLAVORED VODKA,3.385392857143
1032100.0,IMPORTED VODKAS,2.947568041237
1051010.0,AMERICAN GRAPE BRANDIES,2.740301785714
1051100.0,AMERICAN BRANDIES,2.721236734694
1011300.0,TENNESSEE WHISKIES,2.679389285714
1081400.0,AMERICAN SCHNAPPS,2.568816326531
1022100.0,MIXTO TEQUILA,2.522961224490
1022200.0,100% AGAVE TEQUILA,2.440875510204
1011400.0,TENNESSEE WHISKIES,2.372113265306
1081300.0,AMERICAN CORDIALS & LIQUEURS,2.264376288660
1071100.0,AMERICAN COCKTAILS,2.213758928571
1052100.0,IMPORTED BRANDIES,2.185643877551
1062300.0,FLAVORED RUM,2.177719642857
1071100.0,COCKTAILS/RTD,2.173704225352
1071000.0,COCKTAILS/RTD,2.087070370370
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,1.959696428571
1062200.0,WHITE RUM,1.936488775510
1062500.0,FLAVORED RUM,1.890605102041
1041100.0,AMERICAN DRY GINS,1.885422875817
1032200.0,IMPORTED VODKA - MISC,1.837689285714
1052010.0,IMPORTED GRAPE BRANDIES,1.629339285714
1081200.0,CREAM LIQUEURS,1.559086928105
1081390.0,IMPORTED SCHNAPPS,1.432871428571
1082000.0,IMPORTED CORDIALS & LIQUEURS,1.178930434783
1032200.0,IMPORTED FLAVORED VODKA,1.177040816327
1082200.0,IMPORTED SCHNAPPS,1.152865306122
1701100.0,TEMPORARY & SPECIALTY PACKAGES,1.137604123711
1012400.0,IRISH WHISKIES,1.115817346939
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,1.004814285714

2025-02-11 15:28:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 15:28:33 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:33 - root - INFO - SQL:
SELECT MIN("date") AS "earliest_date", MAX("date") AS "latest_date"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
Results:
earliest_date,latest_date
2012-01-03,2024-09-30

2025-02-11 15:28:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:28:34 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:35 - root - INFO - SQL:
SELECT "category", "category_name", COUNT(*) AS "transaction_count"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "transaction_count" DESC
    LIMIT 100;
Results:
category,category_name,transaction_count
1031100.0,AMERICAN VODKAS,1104081
1012100.0,CANADIAN WHISKIES,666318
1011200.0,STRAIGHT BOURBON WHISKIES,543268
1081600.0,WHISKEY LIQUEUR,441995
1031200.0,AMERICAN FLAVORED VODKA,344363
1022200.0,100% AGAVE TEQUILA,336695
1062400.0,SPICED RUM,278027
1011100.0,BLENDED WHISKIES,254160
1081400.0,AMERICAN SCHNAPPS,233360
1011400.0,TENNESSEE WHISKIES,205903
1071000.0,COCKTAILS/RTD,178100
1081300.0,AMERICAN CORDIALS & LIQUEURS,174863
1701100.0,TEMPORARY & SPECIALTY PACKAGES,170787
1032100.0,IMPORTED VODKAS,164326
1051100.0,AMERICAN BRANDIES,161832
1022100.0,MIXTO TEQUILA,155529
1062500.0,FLAVORED RUM,144729
1081200.0,CREAM LIQUEURS,136266
1082100.0,IMPORTED CORDIALS & LIQUEURS,131408
1062200.0,WHITE RUM,125845
1052100.0,IMPORTED BRANDIES,116122
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,103903
1082200.0,IMPORTED SCHNAPPS,96318
1032200.0,IMPORTED FLAVORED VODKA,91096
1041100.0,AMERICAN DRY GINS,90794
1012400.0,IRISH WHISKIES,87878
1012200.0,SCOTCH WHISKIES,86207
1042100.0,IMPORTED DRY GINS,67665
1011600.0,STRAIGHT RYE WHISKIES,58244
1012300.0,SINGLE MALT SCOTCH,46590
1071100.0,COCKTAILS/RTD,43076
1081100.0,COFFEE LIQUEURS,31192
1062100.0,GOLD RUM,30695
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,27461
1082000.0,IMPORTED CORDIALS & LIQUEURS,27442
1011500.0,BOTTLED IN BOND BOURBON,24655
1081500.0,TRIPLE SEC,22645
1062300.0,AGED DARK RUM,21252
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,18658
1011300.0,SINGLE BARREL BOURBON WHISKIES,17584
1091200.0,NEUTRAL GRAIN SPIRITS,13662
1041200.0,FLAVORED GIN,11887
1022300.0,MEZCAL,8208
1901000.0,SPECIAL ORDER ITEMS,5398
1011700.0,CORN WHISKIES,3918
1041300.0,AMERICAN SLOE GINS,1671
1700000.0,TEMPORARY & SPECIALTY PACKAGES,1560
1901200.0,SPECIAL ORDER ITEMS,1173
1032000.0,IMPORTED VODKAS,446
1081000.0,AMERICAN CORDIALS & LIQUEURS,322
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,90
1090000.0,DISTILLED SPIRITS SPECIALTY,28
1031000.0,AMERICAN VODKAS,27
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,21
1042000.0,IMPORTED GINS,5
1070000.0,COCKTAILS/RTD,2
1012000.0,IMPORTED WHISKIES,2

2025-02-11 15:28:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:28:36 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:36 - root - INFO - SQL:
SELECT "category", "category_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 100;
Results:
category,category_name,total_sales_dollars
1031100.0,AMERICAN VODKAS,179745485.11999997
1012100.0,CANADIAN WHISKIES,132576922.83000004
1011200.0,STRAIGHT BOURBON WHISKIES,103185787.80999999
1022200.0,100% AGAVE TEQUILA,85464658.22999999
1081600.0,WHISKEY LIQUEUR,71569310.74999997
1062400.0,SPICED RUM,59913495.67000002
1011400.0,TENNESSEE WHISKIES,45330463.41999999
1701100.0,TEMPORARY & SPECIALTY PACKAGES,32814181.099999994
1032100.0,IMPORTED VODKAS,32765618.36
1031200.0,AMERICAN FLAVORED VODKA,31694810.599999987
1052100.0,IMPORTED BRANDIES,31684334.119999994
1022100.0,MIXTO TEQUILA,30429267.880000003
1011100.0,BLENDED WHISKIES,30342065.090000004
1082100.0,IMPORTED CORDIALS & LIQUEURS,27530417.860000003
1012400.0,IRISH WHISKIES,26380132.700000003
1062500.0,FLAVORED RUM,22205501.160000004
1081200.0,CREAM LIQUEURS,21264617.720000006
1081400.0,AMERICAN SCHNAPPS,19310104.479999993
1071000.0,COCKTAILS/RTD,17644569.080000002
1082200.0,IMPORTED SCHNAPPS,16681896.27
1062200.0,WHITE RUM,16297569.899999999
1012200.0,SCOTCH WHISKIES,15375997.159999995
1042100.0,IMPORTED DRY GINS,14614520.299999999
1051100.0,AMERICAN BRANDIES,12865521.059999997
1032200.0,IMPORTED FLAVORED VODKA,12776975.35
1081300.0,AMERICAN CORDIALS & LIQUEURS,12094166.240000004
1011600.0,STRAIGHT RYE WHISKIES,11784044.480000002
1012300.0,SINGLE MALT SCOTCH,11106384.069999998
1041100.0,AMERICAN DRY GINS,9053573.949999997
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,8884569.170000002
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,6926818.62
1082000.0,IMPORTED CORDIALS & LIQUEURS,5784856.680000001
1081100.0,COFFEE LIQUEURS,5692498.209999999
1011300.0,SINGLE BARREL BOURBON WHISKIES,5053306.64
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4818672.410000002
1071100.0,COCKTAILS/RTD,4719380.419999998
1011500.0,BOTTLED IN BOND BOURBON,3221046.4500000007
1062100.0,GOLD RUM,2786861.62
1062300.0,AGED DARK RUM,2721742.480000001
1901000.0,SPECIAL ORDER ITEMS,2676237.7900000005
1041200.0,FLAVORED GIN,2561542.519999999
1081500.0,TRIPLE SEC,2300558.4899999998
1091200.0,NEUTRAL GRAIN SPIRITS,1683406.0400000005
1022300.0,MEZCAL,1397584.3299999998
1901200.0,SPECIAL ORDER ITEMS,900703.3999999997
1011700.0,CORN WHISKIES,773907.4899999999
1700000.0,TEMPORARY & SPECIALTY PACKAGES,470194.36
1041300.0,AMERICAN SLOE GINS,71906.98000000001
1032000.0,IMPORTED VODKAS,55869.18999999999
1081000.0,AMERICAN CORDIALS & LIQUEURS,51066.24000000001
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,32717.340000000004
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,8467.68
1031000.0,AMERICAN VODKAS,4124.32
1090000.0,DISTILLED SPIRITS SPECIALTY,3564.98
1042000.0,IMPORTED GINS,1593.36
1012000.0,IMPORTED WHISKIES,1150.56
1070000.0,COCKTAILS/RTD,414.0

2025-02-11 15:28:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:28:37 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:38 - root - INFO - SQL:
SELECT "category", "category_name", AVG("bottles_sold") AS "average_bottles_per_transaction"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "category", "category_name"
    ORDER BY "average_bottles_per_transaction" DESC
    LIMIT 100;
Results:
category,category_name,average_bottles_per_transaction
1011800.0,IOWA DISTILLERY WHISKIES,80.145161
1011000.0,AMERICAN WHISKIES,66.000000
1082300.0,SCHNAPPS - IMPORTED,60.000000
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,54.833850
1901000.0,SPECIAL ORDER ITEMS,38.768062
1082390.0,SCHNAPPS - IMPORTED,35.000000
1032000.0,IMPORTED VODKAS,32.319619
1901200.0,SPECIAL ORDER ITEMS,22.731717
1081500.0,TRIPLE SEC,22.114814
1081600.0,WHISKEY LIQUEUR,20.541112
1042000.0,IMPORTED GINS,18.352941
1081400.0,TRIPLE SEC,16.879940
1032230.0,IMPORTED VODKA - CHERRY,15.857143
1031100.0,AMERICAN VODKAS,15.536702
1701100.0,DECANTERS & SPECIALTY PACKAGES,15.307613
1082010.0,AMARETTO - IMPORTED,14.794118
1031080.0,VODKA 80 PROOF,14.316736
1081700.0,DISTILLED SPIRITS SPECIALTY,13.762669
1091200.0,,13.500000
1022100.0,MIXTO TEQUILA,13.433602
1052100.0,IMPORTED BRANDIES,13.006237
1062400.0,SPICED RUM,12.955386
1062250.0,,12.923077
1062310.0,SPICED RUM,12.509244
1012100.0,CANADIAN WHISKIES,12.166085
1900000.0,DELISTED / SPECIAL ORDER ITEMS,12.000000
1052100.0,,11.600000
1032100.0,IMPORTED VODKAS,11.063224
,,10.961412
1051100.0,AMERICAN BRANDIES,10.887612
1051010.0,AMERICAN GRAPE BRANDIES,10.816677
1081317.0,GRAPE SCHNAPPS,10.716268
1011300.0,TENNESSEE WHISKIES,10.605551
1012400.0,IRISH WHISKIES,10.370105
1062200.0,WHITE RUM,10.241945
1032100.0,,10.236758
1081300.0,AMERICAN CORDIALS & LIQUEURS,10.176017
1700000.0,TEMPORARY & SPECIALTY PACKAGES,10.153366
1052010.0,IMPORTED GRAPE BRANDIES,10.123202
1011400.0,TENNESSEE WHISKIES,9.767258
1041100.0,AMERICAN DRY GINS,9.662087
1011500.0,STRAIGHT RYE WHISKIES,9.391572
1101100.0,AMERICAN ALCOHOL,9.372264
1022100.0,TEQUILA,9.371771
1032080.0,IMPORTED VODKAS,9.345825
1062500.0,FLAVORED RUM,9.280111
1081400.0,AMERICAN SCHNAPPS,9.144875
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,9.144263
1011100.0,BLENDED WHISKIES,9.087082
1031100.0,100 PROOF VODKA,8.973720
1081330.0,PEACH SCHNAPPS,8.947271
1091200.0,NEUTRAL GRAIN SPIRITS,8.926699
1082200.0,IMPORTED SCHNAPPS,8.910131
1082100.0,IMPORTED CORDIALS & LIQUEURS,8.813472
1081370.0,WATERMELON SCHNAPPS,8.773145
1091100.0,,8.703883
1071100.0,COCKTAILS/RTD,8.617837
1012300.0,IRISH WHISKIES,8.453269
1081010.0,AMERICAN AMARETTO,8.369976
1071000.0,COCKTAILS/RTD,8.257754
1022200.0,100% AGAVE TEQUILA,8.210170
1701100.0,TEMPORARY & SPECIALTY PACKAGES,8.193199
1081390.0,IMPORTED SCHNAPPS,8.066780
1011200.0,STRAIGHT BOURBON WHISKIES,8.002422
1031200.0,AMERICAN FLAVORED VODKA,7.988832
1082015.0,IMPORTED AMARETTO,7.972222
1051140.0,PEACH BRANDIES,7.841672
1081100.0,COFFEE LIQUEURS,7.834563
1081200.0,CREAM LIQUEURS,7.813621
1032200.0,IMPORTED FLAVORED VODKA,7.774968
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,7.749814
1062400.0,,7.678851
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,7.659389
1082000.0,IMPORTED CORDIALS & LIQUEURS,7.640849
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,7.629689
1081305.0,APPLE SCHNAPPS,7.619596
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,7.562427
1062300.0,FLAVORED RUM,7.518855
1042100.0,IMPORTED DRY GINS,7.501262
1041200.0,FLAVORED GIN,7.498000
1071100.0,AMERICAN COCKTAILS,7.449495
1031200.0,VODKA FLAVORED,7.344949
1081300.0,PEPPERMINT SCHNAPPS,7.288878
1081340.0,ROOT BEER SCHNAPPS,7.177378
1051110.0,BLACKBERRY BRANDIES,7.122182
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,6.936330
1032200.0,IMPORTED VODKA - MISC,6.916469
1081030.0,COFFEE LIQUEURS,6.853480
1011600.0,CORN WHISKIES,6.832447
1081015.0,IMPORTED AMARETTO,6.739434
1051100.0,APRICOT BRANDIES,6.671999
1081100.0,,6.666667
1090000.0,DISTILLED SPIRITS SPECIALTY,6.641745
1091300.0,,6.607143
1081312.0,BUTTERSCOTCH SCHNAPPS,6.551543
1062100.0,GOLD RUM,6.537140
1011600.0,STRAIGHT RYE WHISKIES,6.517086
1081350.0,SPEARMINT SCHNAPPS,6.459016
1011300.0,SINGLE BARREL BOURBON WHISKIES,6.411211
1051150.0,MISCELLANEOUS  BRANDIES,6.355244

2025-02-11 15:28:38 - root - INFO - itercount: 0
2025-02-11 15:28:38 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **"date"**: Used to filter records within the specified date range (from January 1, 2022, onwards) and to group sales data by month.
- **"category"**: Used to group the sales data by liquor category code.
- **"category_name"**: Provides the names of the liquor categories for better readability.
- **"bottles_sold"**: Used to calculate the sales volume for each category and month.
- **"volume_sold_liters"**: Alternative to "bottles_sold" for calculating sales volume in liters.

**Conditions that may be used:**

- Filter records where **"date"** is greater than or equal to `'2022-01-01'`.
- Group data by **"category"**, **"category_name"**, and by month using `DATE_TRUNC('month', "date")`.
- Aggregate sales volume using **SUM("bottles_sold")** or **SUM("volume_sold_liters")**.
- Calculate average monthly percentage contribution over at least 24 months.
- Identify categories contributing an average of at least 1% to the monthly sales volume.

---

**SQL Queries:**

1. **List all distinct liquor categories and their names:**
   ```sql
   SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
   ```

2. **Retrieve sales records from January 1, 2022, onwards:**
   ```sql
   SELECT "date", "category", "category_name", "bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   LIMIT 100;
   ```

3. **Get total bottles sold per category:**
   ```sql
   SELECT "category", "category_name", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category", "category_name"
   LIMIT 100;
   ```

4. **Get total bottles sold per category since January 1, 2022:**
   ```sql
   SELECT "category", "category_name", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   LIMIT 100;
   ```

5. **Calculate total bottles sold per month since January 1, 2022:**
   ```sql
   SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
   ```

6. **Calculate monthly bottles sold per category since January 1, 2022:**
   ```sql
   SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month", "category", "category_name"
   ORDER BY "month", "category"
   LIMIT 100;
   ```

7. **List categories with sales data in at least 24 months:**
   ```sql
   SELECT "category", "category_name", COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "months_with_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category", "category_name"
   HAVING COUNT(DISTINCT DATE_TRUNC('month', "date")) >= 24
   LIMIT 100;
   ```

8. **Calculate the average monthly bottles sold per category:**
   ```sql
   SELECT "category", "category_name", AVG("monthly_bottles_sold") AS "average_monthly_sales"
   FROM (
     SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     GROUP BY "month", "category", "category_name"
   ) AS monthly_sales
   GROUP BY "category", "category_name"
   ORDER BY "average_monthly_sales" DESC
   LIMIT 100;
   ```

9. **Find total sales volume per category in liters since January 1, 2022:**
   ```sql
   SELECT "category", "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   LIMIT 100;
   ```

10. **Calculate the percentage contribution of each category per month:**
    ```sql
    SELECT
      category_monthly."month",
      category_monthly."category",
      category_monthly."category_name",
      (category_monthly."monthly_bottles_sold" / total_monthly."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM (
      SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
      FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
      WHERE "date" >= '2022-01-01'
      GROUP BY "month", "category", "category_name"
    ) AS category_monthly
    JOIN (
      SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
      FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
      WHERE "date" >= '2022-01-01'
      GROUP BY "month"
    ) AS total_monthly
    ON category_monthly."month" = total_monthly."month"
    ORDER BY category_monthly."month", "percentage_contribution" DESC
    LIMIT 100;
    ```

11. **Identify categories contributing an average of at least 1% to monthly sales volume:**
    ```sql
    SELECT
      "category",
      "category_name",
      AVG("percentage_contribution") AS "average_percentage"
    FROM (
      SELECT
        category_monthly."month",
        category_monthly."category",
        category_monthly."category_name",
        (category_monthly."monthly_bottles_sold" / total_monthly."total_bottles_sold") * 100 AS "percentage_contribution"
      FROM (
        SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "month", "category", "category_name"
      ) AS category_monthly
      JOIN (
        SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "month"
      ) AS total_monthly
      ON category_monthly."month" = total_monthly."month"
    ) AS percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1
    ORDER BY "average_percentage" DESC
    LIMIT 100;
    ```

12. **Retrieve the earliest and latest sale dates in the dataset:**
    ```sql
    SELECT MIN("date") AS "earliest_date", MAX("date") AS "latest_date"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
    ```

13. **Count the number of sales transactions per category since January 1, 2022:**
    ```sql
    SELECT "category", "category_name", COUNT(*) AS "transaction_count"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "transaction_count" DESC
    LIMIT 100;
    ```

14. **List the top 100 categories by total sales dollars since January 1, 2022:**
    ```sql
    SELECT "category", "category_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 100;
    ```

15. **Find the average number of bottles sold per transaction for each category:**
    ```sql
    SELECT "category", "category_name", AVG("bottles_sold") AS "average_bottles_per_transaction"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "category", "category_name"
    ORDER BY "average_bottles_per_transaction" DESC
    LIMIT 100;
    ```

---

These queries explore various aspects of the dataset, such as distinct categories, sales over specific periods, monthly sales trends, percentage contributions, and sales volume metrics, which are relevant to understanding and analyzing the data required for the task.Query:
SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Answer:
category,category_name
1011700.0,CORN WHISKIES
1012300.0,SINGLE MALT SCOTCH
1701200.0,HOLIDAY VAP
1012100.0,CANADIAN WHISKIES
1022100.0,TEQUILA
1081300.0,AMERICAN CORDIALS & LIQUEURS
1081335.0,RASPBERRY SCHNAPPS
1081250.0,WHITE CREME DE MENTHE
1091400.0,IOWA DISTILLERIES
1011500.0,STRAIGHT RYE WHISKIES
1081500.0,ROCK & RYE
1082200.0,IMPORTED SCHNAPPS
1052100.0,IMPORTED BRANDIES
1062200.0,WHITE RUM
1062100.0,GOLD RUM
1031100.0,100 PROOF VODKA
1062300.0,AGED DARK RUM
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1081015.0,IMPORTED AMARETTO
1032200.0,IMPORTED VODKA - MISC
1011300.0,SINGLE BARREL BOURBON WHISKIES
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1901000.0,SPECIAL ORDER ITEMS
1081240.0,GREEN CREME DE MENTHE
1701100.0,DECANTERS & SPECIALTY PACKAGES
1071000.0,COCKTAILS/RTD
1091200.0,NEUTRAL GRAIN SPIRITS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1051010.0,AMERICAN GRAPE BRANDIES
1081370.0,WATERMELON SCHNAPPS
1090000.0,DISTILLED SPIRITS SPECIALTY
1081600.0,WHISKEY LIQUEUR
1051100.0,APRICOT BRANDIES
1012400.0,JAPANESE WHISKY
1031200.0,VODKA FLAVORED
1031000.0,AMERICAN VODKAS
1101100.0,AMERICAN ALCOHOL
1052010.0,IMPORTED GRAPE BRANDIES
1012400.0,IRISH WHISKIES
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1032100.0,
1032080.0,IMPORTED VODKAS
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1011800.0,IOWA DISTILLERY WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1012300.0,IRISH WHISKIES
1062050.0,BARBADOS RUM
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1081400.0,AMERICAN SCHNAPPS
1081210.0,CREME DE ALMOND
1081500.0,TRIPLE SEC
1062400.0,
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1031080.0,VODKA 80 PROOF
1011700.0,
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1041200.0,AMERICAN SLOE GINS
1081317.0,GRAPE SCHNAPPS
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM
1901200.0,SPECIAL ORDER ITEMS
1031110.0,LOW PROOF VODKA
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1031200.0,AMERICAN FLAVORED VODKA
1081220.0,DARK CREME DE CACAO
1011600.0,CORN WHISKIES
1070000.0,COCKTAILS/RTD
1082000.0,IMPORTED CORDIALS & LIQUEURS
1081300.0,PEPPERMINT SCHNAPPS
1081312.0,BUTTERSCOTCH SCHNAPPS
1012210.0,SINGLE MALT SCOTCH
1082100.0,IMPORTED CORDIALS & LIQUEURS
1042100.0,IMPORTED DRY GINS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1062300.0,FLAVORED RUM
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1081390.0,IMPORTED SCHNAPPS
1031100.0,AMERICAN VODKAS
1011400.0,BOTTLED IN BOND BOURBON
1032000.0,IMPORTED VODKAS
1091100.0,
1051140.0,PEACH BRANDIES
1081000.0,AMERICAN CORDIALS & LIQUEURS
1051150.0,MISCELLANEOUS  BRANDIES
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES
Query:
SELECT "date", "category", "category_name", "bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   LIMIT 100;
Answer:
date,category,category_name,bottles_sold
2022-12-01,1051100.0,AMERICAN BRANDIES,3
2022-09-14,1051100.0,AMERICAN BRANDIES,3
2023-11-09,1051100.0,AMERICAN BRANDIES,3
2023-11-08,1051100.0,AMERICAN BRANDIES,3
2024-09-26,1051100.0,AMERICAN BRANDIES,3
2024-02-02,1051100.0,AMERICAN BRANDIES,3
2024-04-25,1051100.0,AMERICAN BRANDIES,3
2022-01-14,1012200.0,SCOTCH WHISKIES,3
2022-07-01,1012200.0,SCOTCH WHISKIES,3
2024-08-29,1012200.0,SCOTCH WHISKIES,3
2023-04-20,1012200.0,SCOTCH WHISKIES,3
2023-02-14,1012200.0,SCOTCH WHISKIES,3
2022-01-27,1051100.0,AMERICAN BRANDIES,3
2023-11-16,1051100.0,AMERICAN BRANDIES,3
2023-06-09,1051100.0,AMERICAN BRANDIES,6
2023-09-27,1051100.0,AMERICAN BRANDIES,6
2022-09-09,1051100.0,AMERICAN BRANDIES,6
2024-06-26,1051100.0,AMERICAN BRANDIES,3
2022-03-23,1012200.0,SCOTCH WHISKIES,3
2022-03-02,1012200.0,SCOTCH WHISKIES,3
2024-07-02,1012200.0,SCOTCH WHISKIES,3
2023-12-12,1012200.0,SCOTCH WHISKIES,3
2024-06-11,1012200.0,SCOTCH WHISKIES,3
2023-08-10,1012200.0,SCOTCH WHISKIES,3
2024-01-10,1012200.0,SCOTCH WHISKIES,3
2022-01-07,1012200.0,SCOTCH WHISKIES,3
2022-01-18,1012200.0,SCOTCH WHISKIES,6
2024-03-13,1012200.0,SCOTCH WHISKIES,3
2022-02-21,1012200.0,SCOTCH WHISKIES,3
2022-01-07,1012200.0,SCOTCH WHISKIES,3
2022-11-16,1012200.0,SCOTCH WHISKIES,3
2023-09-18,1012200.0,SCOTCH WHISKIES,3
2024-03-10,1012200.0,SCOTCH WHISKIES,3
2023-01-23,1012200.0,SCOTCH WHISKIES,3
2023-12-19,1012200.0,SCOTCH WHISKIES,3
2022-10-20,1012200.0,SCOTCH WHISKIES,3
2022-09-29,1012200.0,SCOTCH WHISKIES,3
2024-01-05,1012200.0,SCOTCH WHISKIES,3
2024-01-05,1012200.0,SCOTCH WHISKIES,3
2023-07-07,1012200.0,SCOTCH WHISKIES,3
2022-08-30,1012300.0,SINGLE MALT SCOTCH,3
2023-11-22,1051100.0,AMERICAN BRANDIES,3
2022-12-06,1051100.0,AMERICAN BRANDIES,3
2023-01-23,1051100.0,AMERICAN BRANDIES,3
2022-04-29,1051100.0,AMERICAN BRANDIES,3
2022-02-08,1051100.0,AMERICAN BRANDIES,3
2023-05-04,1051100.0,AMERICAN BRANDIES,3
2022-11-15,1051100.0,AMERICAN BRANDIES,3
2022-02-02,1051100.0,AMERICAN BRANDIES,3
2024-05-28,1051100.0,AMERICAN BRANDIES,3
2022-10-27,1051100.0,AMERICAN BRANDIES,3
2022-08-02,1022200.0,100% AGAVE TEQUILA,3
2022-02-18,1082200.0,IMPORTED SCHNAPPS,3
2023-05-10,1082200.0,IMPORTED SCHNAPPS,3
2024-07-22,1082200.0,IMPORTED SCHNAPPS,3
2023-02-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-02-06,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-10-31,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-08-07,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2023-06-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-04-08,1081200.0,CREAM LIQUEURS,3
2023-05-30,1081200.0,CREAM LIQUEURS,3
2022-09-30,1081200.0,CREAM LIQUEURS,3
2023-03-13,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2023-09-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2024-08-23,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2024-08-19,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2022-11-04,1082100.0,IMPORTED CORDIALS & LIQUEURS,6
2022-04-19,1082000.0,IMPORTED CORDIALS & LIQUEURS,6
2023-11-22,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-08-06,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-03-06,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-04-06,1082000.0,IMPORTED CORDIALS & LIQUEURS,3
2024-07-02,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-05-31,1082000.0,IMPORTED CORDIALS & LIQUEURS,3
2024-07-24,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-01-09,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-04-26,1012400.0,IRISH WHISKIES,3
2023-09-09,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-08-02,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-07-16,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-03-20,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-12-27,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2022-06-13,1082000.0,IMPORTED CORDIALS & LIQUEURS,3
2022-12-05,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-04-03,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2024-05-14,1082100.0,IMPORTED CORDIALS & LIQUEURS,3
2023-04-25,1022200.0,100% AGAVE TEQUILA,-96
2023-11-30,1032100.0,IMPORTED VODKAS,-24
2023-01-11,1032200.0,IMPORTED FLAVORED VODKA,-18
2022-09-09,1031100.0,AMERICAN VODKAS,-18
2023-12-11,1071000.0,COCKTAILS/RTD,-36
2023-12-11,1081400.0,AMERICAN SCHNAPPS,-12
2023-11-14,1031100.0,AMERICAN VODKAS,-6
2024-08-30,1062400.0,SPICED RUM,-6
2022-12-30,1071000.0,COCKTAILS/RTD,-6
2023-05-30,1011200.0,STRAIGHT BOURBON WHISKIES,-12
2023-02-27,1011200.0,STRAIGHT BOURBON WHISKIES,-12
2023-06-26,1011300.0,SINGLE BARREL BOURBON WHISKIES,-12
2022-11-14,1031100.0,AMERICAN VODKAS,-24
Query:
SELECT "category", "category_name", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category", "category_name"
   LIMIT 100;
Answer:
category,category_name,total_bottles_sold
1022300.0,MEZCAL,78238
1081030.0,COFFEE LIQUEURS,517472
1081230.0,WHITE CREME DE CACAO,35292
1062500.0,,1674
1501100.0,HIGH PROOF BEER - AMERICAN,54
1071000.0,COCKTAILS/RTD,1470706
1701100.0,DECANTERS & SPECIALTY PACKAGES,620739
1091200.0,NEUTRAL GRAIN SPIRITS,379715
1900000.0,DELISTED / SPECIAL ORDER ITEMS,12
1091400.0,IOWA DISTILLERIES,16185
1041200.0,AMERICAN SLOE GINS,32610
1701200.0,HOLIDAY VAP,133
1082000.0,IMPORTED CORDIALS & LIQUEURS,2474168
1081200.0,CREAM LIQUEURS,4994560
1070100.0,TEMPORARY & SPECIALTY PACKAGES,177
1081500.0,ROCK & RYE,12167
1011700.0,CORN WHISKIES,78388
1081315.0,CINNAMON SCHNAPPS,179177
1041200.0,FLAVORED GIN,163044
1081100.0,,40
1052100.0,IMPORTED BRANDIES,5038278
1062200.0,WHITE RUM,4435551
1082200.0,IMPORTED SCHNAPPS,2671890
1011200.0,STRAIGHT BOURBON WHISKIES,15545048
1032100.0,IMPORTED VODKAS,6669509
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,1852
1081020.0,ANISETTE,5430
1011000.0,AMERICAN WHISKIES,66
1052010.0,IMPORTED GRAPE BRANDIES,1576061
1089290.0,,6
1032080.0,IMPORTED VODKAS,3776162
1082010.0,AMARETTO - IMPORTED,1509
1042000.0,IMPORTED GINS,312
1101100.0,AMERICAN ALCOHOL,228224
1031200.0,VODKA FLAVORED,3693136
1031000.0,AMERICAN VODKAS,16469
1081400.0,AMERICAN SCHNAPPS,6013697
1081500.0,TRIPLE SEC,1583487
1081210.0,CREME DE ALMOND,6620
1062400.0,,2941
1022300.0,,30
1081240.0,GREEN CREME DE MENTHE,45726
1011400.0,TENNESSEE WHISKIES,5515922
1011600.0,STRAIGHT RYE WHISKIES,995348
1031080.0,VODKA 80 PROOF,18124615
1081400.0,TRIPLE SEC,820517
1011700.0,,189
1071100.0,AMERICAN COCKTAILS,2120834
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,1754
1082390.0,SCHNAPPS - IMPORTED,560
1011800.0,IOWA DISTILLERY WHISKIES,9938
1051010.0,AMERICAN GRAPE BRANDIES,2630010
1081370.0,WATERMELON SCHNAPPS,156548
1090000.0,DISTILLED SPIRITS SPECIALTY,2132
1051140.0,PEACH BRANDIES,118174
1081000.0,AMERICAN CORDIALS & LIQUEURS,16130
1091300.0,,370
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,1877575
1031100.0,AMERICAN VODKAS,47420904
1081390.0,IMPORTED SCHNAPPS,1365246
1701100.0,TEMPORARY & SPECIALTY PACKAGES,2716488
101220.0,,21
1041100.0,AMERICAN DRY GINS,5836741
1051110.0,BLACKBERRY BRANDIES,425294
1081380.0,MISCELLANEOUS SCHNAPPS,179899
1081340.0,ROOT BEER SCHNAPPS,97720
1011500.0,STRAIGHT RYE WHISKIES,562264
1062250.0,,168
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,746695
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,960761
1081700.0,DISTILLED SPIRITS SPECIALTY,828898
1081355.0,STRAWBERRY SCHNAPPS,72278
1012400.0,IRISH WHISKIES,2590193
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,426480
1032100.0,,12755
1082015.0,IMPORTED AMARETTO,287
1052100.0,,26854
1081350.0,SPEARMINT SCHNAPPS,18912
1062300.0,AGED DARK RUM,341733
1012200.0,SCOTCH WHISKIES,2845134
1081330.0,PEACH SCHNAPPS,567257
1022100.0,MIXTO TEQUILA,5867690
1062500.0,FLAVORED RUM,4388156
1062310.0,SPICED RUM,6633940
1901100.0,DELISTED ITEMS,149
1012100.0,CANADIAN WHISKIES,35030612
1022100.0,TEQUILA,4079513
1081300.0,AMERICAN CORDIALS & LIQUEURS,4926464
1081335.0,RASPBERRY SCHNAPPS,71526
1022200.0,100% AGAVE TEQUILA,5852587
1051120.0,CHERRY BRANDIES,79465
1081300.0,PEPPERMINT SCHNAPPS,878339
1032230.0,IMPORTED VODKA - CHERRY,222
1901200.0,SPECIAL ORDER ITEMS,637511
1031110.0,LOW PROOF VODKA,8608
1012000.0,IMPORTED WHISKIES,72
1011500.0,BOTTLED IN BOND BOURBON,179697
1071100.0,COCKTAILS/RTD,3592940
1081010.0,AMERICAN AMARETTO,447099
1700000.0,TEMPORARY & SPECIALTY PACKAGES,182192
Query:
SELECT "category", "category_name", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   LIMIT 100;
Answer:
category,category_name,total_bottles_sold
1011700.0,CORN WHISKIES,27851
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,700
1062300.0,AGED DARK RUM,124723
1041300.0,AMERICAN SLOE GINS,8617
1031000.0,AMERICAN VODKAS,289
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,232261
1012400.0,IRISH WHISKIES,956732
1062200.0,WHITE RUM,1362966
1082200.0,IMPORTED SCHNAPPS,957833
1052100.0,IMPORTED BRANDIES,1354991
1081600.0,WHISKEY LIQUEUR,11967870
1081400.0,AMERICAN SCHNAPPS,2531079
1081500.0,TRIPLE SEC,561286
1011200.0,STRAIGHT BOURBON WHISKIES,4596736
1032100.0,IMPORTED VODKAS,1946590
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,198
1031100.0,AMERICAN VODKAS,17547955
1701100.0,TEMPORARY & SPECIALTY PACKAGES,1175307
1012300.0,SINGLE MALT SCOTCH,212487
1081000.0,AMERICAN CORDIALS & LIQUEURS,2044
1032200.0,IMPORTED FLAVORED VODKA,749291
1032000.0,IMPORTED VODKAS,2404
1901000.0,SPECIAL ORDER ITEMS,209270
1700000.0,TEMPORARY & SPECIALTY PACKAGES,16242
1071000.0,COCKTAILS/RTD,1470706
1091200.0,NEUTRAL GRAIN SPIRITS,116228
1022100.0,MIXTO TEQUILA,2176287
1062500.0,FLAVORED RUM,1463377
1042000.0,IMPORTED GINS,72
1082000.0,IMPORTED CORDIALS & LIQUEURS,260140
1011100.0,BLENDED WHISKIES,2316625
1012200.0,SCOTCH WHISKIES,533417
1041100.0,AMERICAN DRY GINS,972021
1011400.0,TENNESSEE WHISKIES,1981355
1011600.0,STRAIGHT RYE WHISKIES,365308
1012100.0,CANADIAN WHISKIES,8173740
1081300.0,AMERICAN CORDIALS & LIQUEURS,1217234
1022200.0,100% AGAVE TEQUILA,2921968
1081200.0,CREAM LIQUEURS,1046003
1082100.0,IMPORTED CORDIALS & LIQUEURS,1170433
1042100.0,IMPORTED DRY GINS,572572
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,885389
1071100.0,COCKTAILS/RTD,399626
1011500.0,BOTTLED IN BOND BOURBON,108448
1090000.0,DISTILLED SPIRITS SPECIALTY,100
1062100.0,GOLD RUM,206689
1022300.0,MEZCAL,41970
1011300.0,SINGLE BARREL BOURBON WHISKIES,127435
1041200.0,FLAVORED GIN,101892
1062400.0,SPICED RUM,3852972
1051100.0,AMERICAN BRANDIES,1969307
1901200.0,SPECIAL ORDER ITEMS,67123
1012000.0,IMPORTED WHISKIES,12
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,532612
1031200.0,AMERICAN FLAVORED VODKA,2851618
1070000.0,COCKTAILS/RTD,24
1081100.0,COFFEE LIQUEURS,274028
Query:
SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
Answer:
month,total_bottles_sold
2022-01-01,2062829
2022-02-01,2094442
2022-03-01,2190674
2022-04-01,2560073
2022-05-01,2610732
2022-06-01,2783728
2022-07-01,2408078
2022-08-01,2885003
2022-09-01,2626119
2022-10-01,2728062
2022-11-01,2599143
2022-12-01,2883140
2023-01-01,2356148
2023-02-01,2287773
2023-03-01,2630242
2023-04-01,2391391
2023-05-01,2783716
2023-06-01,2910130
2023-07-01,2489992
2023-08-01,2777255
2023-09-01,2487699
2023-10-01,2741885
2023-11-01,2663993
2023-12-01,2743642
2024-01-01,2377520
2024-02-01,2439060
2024-03-01,2419405
2024-04-01,2639657
2024-05-01,2760679
2024-06-01,2629980
2024-07-01,2670785
2024-08-01,2628250
2024-09-01,2461228
Query:
SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month", "category", "category_name"
   ORDER BY "month", "category"
   LIMIT 100;
Answer:
month,category,category_name,monthly_bottles_sold
2022-01-01,1011100.0,BLENDED WHISKIES,66930
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,116880
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2010
2022-01-01,1011400.0,TENNESSEE WHISKIES,44026
2022-01-01,1011500.0,BOTTLED IN BOND BOURBON,1871
2022-01-01,1011600.0,STRAIGHT RYE WHISKIES,9832
2022-01-01,1011700.0,CORN WHISKIES,473
2022-01-01,1012100.0,CANADIAN WHISKIES,197568
2022-01-01,1012200.0,SCOTCH WHISKIES,22925
2022-01-01,1012300.0,SINGLE MALT SCOTCH,7128
2022-01-01,1012400.0,IRISH WHISKIES,23482
2022-01-01,1022100.0,MIXTO TEQUILA,43337
2022-01-01,1022200.0,100% AGAVE TEQUILA,50549
2022-01-01,1022300.0,MEZCAL,735
2022-01-01,1031000.0,AMERICAN VODKAS,199
2022-01-01,1031100.0,AMERICAN VODKAS,429940
2022-01-01,1031200.0,AMERICAN FLAVORED VODKA,63611
2022-01-01,1032000.0,IMPORTED VODKAS,6
2022-01-01,1032100.0,IMPORTED VODKAS,45554
2022-01-01,1032200.0,IMPORTED FLAVORED VODKA,20464
2022-01-01,1041100.0,AMERICAN DRY GINS,20425
2022-01-01,1041200.0,FLAVORED GIN,946
2022-01-01,1041300.0,AMERICAN SLOE GINS,274
2022-01-01,1042000.0,IMPORTED GINS,24
2022-01-01,1042100.0,IMPORTED DRY GINS,12359
2022-01-01,1051100.0,AMERICAN BRANDIES,61714
2022-01-01,1052100.0,IMPORTED BRANDIES,31601
2022-01-01,1062100.0,GOLD RUM,5479
2022-01-01,1062200.0,WHITE RUM,36600
2022-01-01,1062300.0,AGED DARK RUM,3840
2022-01-01,1062400.0,SPICED RUM,98154
2022-01-01,1062500.0,FLAVORED RUM,34669
2022-01-01,1070000.0,COCKTAILS/RTD,12
2022-01-01,1071100.0,COCKTAILS/RTD,34083
2022-01-01,1081100.0,COFFEE LIQUEURS,7441
2022-01-01,1081200.0,CREAM LIQUEURS,34245
2022-01-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,35966
2022-01-01,1081400.0,AMERICAN SCHNAPPS,55064
2022-01-01,1081500.0,TRIPLE SEC,10285
2022-01-01,1081600.0,WHISKEY LIQUEUR,303738
2022-01-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,26373
2022-01-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3351
2022-01-01,1082200.0,IMPORTED SCHNAPPS,28081
2022-01-01,1090000.0,DISTILLED SPIRITS SPECIALTY,62
2022-01-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,48
2022-01-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4855
2022-01-01,1091200.0,NEUTRAL GRAIN SPIRITS,2744
2022-01-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,7517
2022-01-01,1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,6
2022-01-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,12576
2022-01-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,1932
2022-01-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,32591
2022-01-01,1901200.0,SPECIAL ORDER ITEMS,8254
2022-02-01,1011100.0,BLENDED WHISKIES,68355
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,115614
2022-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3120
2022-02-01,1011400.0,TENNESSEE WHISKIES,44865
2022-02-01,1011500.0,BOTTLED IN BOND BOURBON,2224
2022-02-01,1011600.0,STRAIGHT RYE WHISKIES,10326
2022-02-01,1011700.0,CORN WHISKIES,497
2022-02-01,1012000.0,IMPORTED WHISKIES,12
2022-02-01,1012100.0,CANADIAN WHISKIES,213188
2022-02-01,1012200.0,SCOTCH WHISKIES,14629
2022-02-01,1012300.0,SINGLE MALT SCOTCH,7036
2022-02-01,1012400.0,IRISH WHISKIES,37939
2022-02-01,1022100.0,MIXTO TEQUILA,61030
2022-02-01,1022200.0,100% AGAVE TEQUILA,63393
2022-02-01,1022300.0,MEZCAL,1366
2022-02-01,1031000.0,AMERICAN VODKAS,90
2022-02-01,1031100.0,AMERICAN VODKAS,415899
2022-02-01,1031200.0,AMERICAN FLAVORED VODKA,66843
2022-02-01,1032100.0,IMPORTED VODKAS,47501
2022-02-01,1032200.0,IMPORTED FLAVORED VODKA,19898
2022-02-01,1041100.0,AMERICAN DRY GINS,20154
2022-02-01,1041200.0,FLAVORED GIN,880
2022-02-01,1041300.0,AMERICAN SLOE GINS,215
2022-02-01,1042100.0,IMPORTED DRY GINS,15703
2022-02-01,1051100.0,AMERICAN BRANDIES,57151
2022-02-01,1052100.0,IMPORTED BRANDIES,36951
2022-02-01,1062100.0,GOLD RUM,5976
2022-02-01,1062200.0,WHITE RUM,39023
2022-02-01,1062300.0,AGED DARK RUM,3312
2022-02-01,1062400.0,SPICED RUM,89388
2022-02-01,1062500.0,FLAVORED RUM,37238
2022-02-01,1071100.0,COCKTAILS/RTD,44098
2022-02-01,1081000.0,AMERICAN CORDIALS & LIQUEURS,84
2022-02-01,1081100.0,COFFEE LIQUEURS,7757
2022-02-01,1081200.0,CREAM LIQUEURS,31105
2022-02-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,31386
2022-02-01,1081400.0,AMERICAN SCHNAPPS,50838
2022-02-01,1081500.0,TRIPLE SEC,12612
2022-02-01,1081600.0,WHISKEY LIQUEUR,284186
2022-02-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,41967
2022-02-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,3837
2022-02-01,1082200.0,IMPORTED SCHNAPPS,29182
2022-02-01,1090000.0,DISTILLED SPIRITS SPECIALTY,36
2022-02-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,24
2022-02-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4341
2022-02-01,1091200.0,NEUTRAL GRAIN SPIRITS,3495
2022-02-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,7857
Query:
SELECT "category", "category_name", COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "months_with_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category", "category_name"
   HAVING COUNT(DISTINCT DATE_TRUNC('month', "date")) >= 24
   LIMIT 100;
Answer:
category,category_name,months_with_sales
1091400.0,IOWA DISTILLERIES,25
1081240.0,GREEN CREME DE MENTHE,56
1081600.0,WHISKEY LIQUEUR,153
1051100.0,APRICOT BRANDIES,56
1901000.0,SPECIAL ORDER ITEMS,27
1700000.0,TEMPORARY & SPECIALTY PACKAGES,33
1041150.0,FLAVORED GINS,56
1071100.0,COCKTAILS/RTD,71
1011500.0,BOTTLED IN BOND BOURBON,98
1081010.0,AMERICAN AMARETTO,56
1051140.0,PEACH BRANDIES,56
1081000.0,AMERICAN CORDIALS & LIQUEURS,82
1062300.0,AGED DARK RUM,98
1041200.0,AMERICAN SLOE GINS,56
1051010.0,AMERICAN GRAPE BRANDIES,56
1081380.0,MISCELLANEOUS SCHNAPPS,56
1041100.0,AMERICAN DRY GINS,153
1051110.0,BLACKBERRY BRANDIES,56
1081340.0,ROOT BEER SCHNAPPS,56
1022200.0,,54
1011300.0,TENNESSEE WHISKIES,56
1012100.0,CANADIAN WHISKIES,153
1081335.0,RASPBERRY SCHNAPPS,56
1081300.0,AMERICAN CORDIALS & LIQUEURS,97
1022100.0,TEQUILA,56
1081250.0,WHITE CREME DE MENTHE,49
1012210.0,SINGLE MALT SCOTCH,56
1081312.0,BUTTERSCOTCH SCHNAPPS,56
1091200.0,NEUTRAL GRAIN SPIRITS,98
1701100.0,DECANTERS & SPECIALTY PACKAGES,56
1071000.0,COCKTAILS/RTD,27
1062500.0,FLAVORED RUM,98
1022100.0,MIXTO TEQUILA,98
1062310.0,SPICED RUM,56
1012300.0,SINGLE MALT SCOTCH,98
1011800.0,IOWA DISTILLERY WHISKIES,24
1031000.0,AMERICAN VODKAS,56
1101100.0,AMERICAN ALCOHOL,56
1031200.0,VODKA FLAVORED,56
1081370.0,WATERMELON SCHNAPPS,56
1032080.0,IMPORTED VODKAS,56
1082010.0,AMARETTO - IMPORTED,37
1011500.0,STRAIGHT RYE WHISKIES,56
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,67
1071100.0,AMERICAN COCKTAILS,56
1081300.0,PEPPERMINT SCHNAPPS,56
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,56
1081317.0,GRAPE SCHNAPPS,56
1081030.0,COFFEE LIQUEURS,56
1081230.0,WHITE CREME DE CACAO,56
1081330.0,PEACH SCHNAPPS,56
1012200.0,SCOTCH WHISKIES,153
1081400.0,AMERICAN SCHNAPPS,98
1081500.0,TRIPLE SEC,98
1081210.0,CREME DE ALMOND,54
1062100.0,GOLD RUM,98
1031100.0,100 PROOF VODKA,56
1082000.0,IMPORTED CORDIALS & LIQUEURS,92
1051120.0,CHERRY BRANDIES,56
1022200.0,100% AGAVE TEQUILA,98
1062050.0,BARBADOS RUM,56
1012300.0,IRISH WHISKIES,56
1081500.0,ROCK & RYE,56
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,56
1081700.0,DISTILLED SPIRITS SPECIALTY,56
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,98
1081355.0,STRAWBERRY SCHNAPPS,56
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,97
1012400.0,IRISH WHISKIES,98
1082015.0,IMPORTED AMARETTO,25
1032100.0,,30
1011700.0,CORN WHISKIES,98
1032100.0,IMPORTED VODKAS,97
1011200.0,STRAIGHT BOURBON WHISKIES,153
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,54
1081020.0,ANISETTE,55
1051150.0,MISCELLANEOUS  BRANDIES,56
1901200.0,SPECIAL ORDER ITEMS,72
1031110.0,LOW PROOF VODKA,43
1052010.0,IMPORTED GRAPE BRANDIES,56
1011400.0,TENNESSEE WHISKIES,98
1031080.0,VODKA 80 PROOF,56
1011600.0,STRAIGHT RYE WHISKIES,98
1081400.0,TRIPLE SEC,56
1022300.0,MEZCAL,98
1062200.0,WHITE RUM,98
1052100.0,IMPORTED BRANDIES,98
1082200.0,IMPORTED SCHNAPPS,98
1041200.0,FLAVORED GIN,98
1081315.0,CINNAMON SCHNAPPS,56
1051100.0,AMERICAN BRANDIES,98
1062400.0,SPICED RUM,98
1081365.0,TROPICAL FRUIT SCHNAPPS,56
1042100.0,IMPORTED DRY GINS,153
1082100.0,IMPORTED CORDIALS & LIQUEURS,96
1062300.0,FLAVORED RUM,56
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,97
1081390.0,IMPORTED SCHNAPPS,56
1031100.0,AMERICAN VODKAS,97
1701100.0,TEMPORARY & SPECIALTY PACKAGES,97
Query:
SELECT "category", "category_name", AVG("monthly_bottles_sold") AS "average_monthly_sales"
   FROM (
     SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     GROUP BY "month", "category", "category_name"
   ) AS monthly_sales
   GROUP BY "category", "category_name"
   ORDER BY "average_monthly_sales" DESC
   LIMIT 100;
Answer:
category,category_name,average_monthly_sales
1031100.0,AMERICAN VODKAS,488875.298969
1031080.0,VODKA 80 PROOF,323653.839286
1012100.0,CANADIAN WHISKIES,228958.248366
1081600.0,WHISKEY LIQUEUR,191712.209150
1062400.0,SPICED RUM,119439.540816
1062310.0,SPICED RUM,118463.214286
1011200.0,STRAIGHT BOURBON WHISKIES,101601.620915
1031200.0,AMERICAN FLAVORED VODKA,80022.744898
1011100.0,BLENDED WHISKIES,74317.065359
1022100.0,TEQUILA,72848.446429
1032100.0,IMPORTED VODKAS,68757.824742
1032080.0,IMPORTED VODKAS,67431.464286
1031200.0,VODKA FLAVORED,65948.857143
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,64561.107143
1051100.0,AMERICAN BRANDIES,63389.897959
1081400.0,AMERICAN SCHNAPPS,61364.255102
1022100.0,MIXTO TEQUILA,59874.387755
1022200.0,100% AGAVE TEQUILA,59720.275510
1011400.0,TENNESSEE WHISKIES,56284.918367
1071000.0,COCKTAILS/RTD,54470.592593
1052100.0,IMPORTED BRANDIES,51411.000000
1081300.0,AMERICAN CORDIALS & LIQUEURS,50788.288660
1071100.0,COCKTAILS/RTD,50604.788732
1051010.0,AMERICAN GRAPE BRANDIES,46964.464286
1011300.0,TENNESSEE WHISKIES,46429.964286
1062200.0,WHITE RUM,45260.724490
1062500.0,FLAVORED RUM,44777.102041
1041100.0,AMERICAN DRY GINS,38148.633987
1071100.0,AMERICAN COCKTAILS,37872.035714
1062300.0,FLAVORED RUM,37375.017857
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,33528.125000
1081200.0,CREAM LIQUEURS,32644.183007
1032200.0,IMPORTED VODKA - MISC,31647.910714
1052010.0,IMPORTED GRAPE BRANDIES,28143.946429
1701100.0,TEMPORARY & SPECIALTY PACKAGES,28005.030928
1032200.0,IMPORTED FLAVORED VODKA,27462.377551
1082200.0,IMPORTED SCHNAPPS,27264.183673
1082000.0,IMPORTED CORDIALS & LIQUEURS,26893.130435
1012400.0,IRISH WHISKIES,26430.540816
1081390.0,IMPORTED SCHNAPPS,24379.392857
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,20049.969072
1012200.0,SCOTCH WHISKIES,18595.647059
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,17156.446429
1081500.0,TRIPLE SEC,16158.030612
1031100.0,100 PROOF VODKA,15884.125000
1042100.0,IMPORTED DRY GINS,15775.398693
1081300.0,PEPPERMINT SCHNAPPS,15684.625000
1081700.0,DISTILLED SPIRITS SPECIALTY,14801.750000
1081400.0,TRIPLE SEC,14652.089286
1012300.0,IRISH WHISKIES,13342.428571
1082100.0,IMPORTED CORDIALS & LIQUEURS,12721.604167
1701100.0,DECANTERS & SPECIALTY PACKAGES,11084.625000
1011600.0,STRAIGHT RYE WHISKIES,10156.612245
1081330.0,PEACH SCHNAPPS,10129.589286
1011500.0,STRAIGHT RYE WHISKIES,10040.428571
1081030.0,COFFEE LIQUEURS,9240.571429
1901200.0,SPECIAL ORDER ITEMS,8854.319444
1081100.0,COFFEE LIQUEURS,8790.938776
1081010.0,AMERICAN AMARETTO,7983.910714
1901000.0,SPECIAL ORDER ITEMS,7750.740741
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,7619.336735
1051110.0,BLACKBERRY BRANDIES,7594.535714
1062100.0,GOLD RUM,7484.224490
1012300.0,SINGLE MALT SCOTCH,6952.826531
1700000.0,TEMPORARY & SPECIALTY PACKAGES,5520.969697
1012210.0,SINGLE MALT SCOTCH,5315.946429
1051100.0,APRICOT BRANDIES,4588.071429
1081305.0,APPLE SCHNAPPS,4503.589286
1052100.0,,4475.666667
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4396.701031
1101100.0,AMERICAN ALCOHOL,4075.428571
1081312.0,BUTTERSCOTCH SCHNAPPS,3961.928571
1091200.0,NEUTRAL GRAIN SPIRITS,3874.642857
1062300.0,AGED DARK RUM,3487.071429
1081380.0,MISCELLANEOUS SCHNAPPS,3212.482143
1081315.0,CINNAMON SCHNAPPS,3199.589286
1081370.0,WATERMELON SCHNAPPS,2795.500000
1081317.0,GRAPE SCHNAPPS,2496.125000
1011300.0,SINGLE BARREL BOURBON WHISKIES,2392.428571
,,2241.674699
1051140.0,PEACH BRANDIES,2110.250000
1011500.0,BOTTLED IN BOND BOURBON,1833.642857
1081015.0,IMPORTED AMARETTO,1754.040816
1081340.0,ROOT BEER SCHNAPPS,1745.000000
1041200.0,FLAVORED GIN,1663.714286
1051120.0,CHERRY BRANDIES,1419.017857
1062100.0,JAMAICA RUM,1405.000000
1081355.0,STRAWBERRY SCHNAPPS,1290.678571
1081335.0,RASPBERRY SCHNAPPS,1277.250000
1041150.0,FLAVORED GINS,1079.982143
1081365.0,TROPICAL FRUIT SCHNAPPS,1072.535714
1062050.0,BARBADOS RUM,1056.928571
1032000.0,IMPORTED VODKAS,975.954545
1081240.0,GREEN CREME DE MENTHE,816.535714
1011700.0,CORN WHISKIES,799.877551
1022300.0,MEZCAL,798.346939
1062400.0,,735.250000
1011250.0,SINGLE BARREL BOURBON WHISKIES,660.035714
1091400.0,IOWA DISTILLERIES,647.400000
1081230.0,WHITE CREME DE CACAO,630.214286
Query:
SELECT "category", "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   LIMIT 100;
Answer:
category,category_name,total_volume_liters
1011700.0,CORN WHISKIES,19992.15000000001
1062300.0,AGED DARK RUM,101947.19999999998
1011200.0,STRAIGHT BOURBON WHISKIES,3661763.7800000007
1032100.0,IMPORTED VODKAS,1964598.22
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,148.5
1062200.0,WHITE RUM,1415858.47
1082200.0,IMPORTED SCHNAPPS,852297.6999999997
1052100.0,IMPORTED BRANDIES,627738.05
1031000.0,AMERICAN VODKAS,211.15
1022200.0,100% AGAVE TEQUILA,2033489.7700000005
1081600.0,WHISKEY LIQUEUR,2996627.1100000003
1071100.0,COCKTAILS/RTD,570111.73
1011500.0,BOTTLED IN BOND BOURBON,93243.55000000002
1082000.0,IMPORTED CORDIALS & LIQUEURS,176152.63
1012200.0,SCOTCH WHISKIES,570816.37
1012100.0,CANADIAN WHISKIES,7888910.249999997
1081300.0,AMERICAN CORDIALS & LIQUEURS,548097.4499999998
1041100.0,AMERICAN DRY GINS,808267.2699999999
1081400.0,AMERICAN SCHNAPPS,1268049.66
1081500.0,TRIPLE SEC,553115.75
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,165376.97999999998
1012400.0,IRISH WHISKIES,801182.6199999999
1041300.0,AMERICAN SLOE GINS,8552.0
1081000.0,AMERICAN CORDIALS & LIQUEURS,1277.1000000000001
1071000.0,COCKTAILS/RTD,1976413.39
1091200.0,NEUTRAL GRAIN SPIRITS,88530.09999999996
1042000.0,IMPORTED GINS,54.0
1032000.0,IMPORTED VODKAS,2049.5000000000005
1011300.0,SINGLE BARREL BOURBON WHISKIES,95634.75
1901200.0,SPECIAL ORDER ITEMS,104864.21999999999
1012000.0,IMPORTED WHISKIES,9.0
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,275923.69999999995
1031200.0,AMERICAN FLAVORED VODKA,2000078.3900000008
1070000.0,COCKTAILS/RTD,24.0
1062100.0,GOLD RUM,226745.01
1012300.0,SINGLE MALT SCOTCH,164171.05000000005
1901000.0,SPECIAL ORDER ITEMS,295926.9400000002
1700000.0,TEMPORARY & SPECIALTY PACKAGES,21210.420000000002
1081200.0,CREAM LIQUEURS,892286.9799999999
1011100.0,BLENDED WHISKIES,1924959.8899999997
1032200.0,IMPORTED FLAVORED VODKA,583466.47
1062500.0,FLAVORED RUM,1348587.12
1022100.0,MIXTO TEQUILA,1673871.4999999998
1011400.0,TENNESSEE WHISKIES,1408056.1700000002
1011600.0,STRAIGHT RYE WHISKIES,281479.3
1022300.0,MEZCAL,31551.199999999997
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,373.9999999999999
1041200.0,FLAVORED GIN,76149.0
1062400.0,SPICED RUM,3769932.240000001
1051100.0,AMERICAN BRANDIES,1014426.1400000001
1082100.0,IMPORTED CORDIALS & LIQUEURS,851256.7600000002
1042100.0,IMPORTED DRY GINS,546013.9799999999
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,801322.54
1031100.0,AMERICAN VODKAS,15645738.36
1701100.0,TEMPORARY & SPECIALTY PACKAGES,894384.3699999998
1090000.0,DISTILLED SPIRITS SPECIALTY,75.0
1081100.0,COFFEE LIQUEURS,232840.93
Query:
SELECT
      category_monthly."month",
      category_monthly."category",
      category_monthly."category_name",
      (category_monthly."monthly_bottles_sold" / total_monthly."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM (
      SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
      FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
      WHERE "date" >= '2022-01-01'
      GROUP BY "month", "category", "category_name"
    ) AS category_monthly
    JOIN (
      SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
      FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
      WHERE "date" >= '2022-01-01'
      GROUP BY "month"
    ) AS total_monthly
    ON category_monthly."month" = total_monthly."month"
    ORDER BY category_monthly."month", "percentage_contribution" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
month,category,category_name,percentage_contribution
2022-01-01,1031100.0,AMERICAN VODKAS,20.842300
2022-01-01,1081600.0,WHISKEY LIQUEUR,14.724300
2022-01-01,1012100.0,CANADIAN WHISKIES,9.577500
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.666000
2022-01-01,1062400.0,SPICED RUM,4.758200
2022-01-01,1011100.0,BLENDED WHISKIES,3.244600
2022-01-01,1031200.0,AMERICAN FLAVORED VODKA,3.083700
2022-01-01,1051100.0,AMERICAN BRANDIES,2.991700
2022-01-01,1081400.0,AMERICAN SCHNAPPS,2.669300
2022-01-01,1022200.0,100% AGAVE TEQUILA,2.450500
2022-01-01,1032100.0,IMPORTED VODKAS,2.208300
2022-01-01,1011400.0,TENNESSEE WHISKIES,2.134300
2022-01-01,1022100.0,MIXTO TEQUILA,2.100900
2022-01-01,1062200.0,WHITE RUM,1.774300
2022-01-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,1.743500
2022-01-01,1062500.0,FLAVORED RUM,1.680700
2022-01-01,1081200.0,CREAM LIQUEURS,1.660100
2022-01-01,1071100.0,COCKTAILS/RTD,1.652200
2022-01-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,1.579900
2022-01-01,1052100.0,IMPORTED BRANDIES,1.531900
2022-01-01,1082200.0,IMPORTED SCHNAPPS,1.361300
2022-01-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,1.278500
2022-01-01,1012400.0,IRISH WHISKIES,1.138300
2022-01-01,1012200.0,SCOTCH WHISKIES,1.111300
2022-01-01,1032200.0,IMPORTED FLAVORED VODKA,0.992000
2022-01-01,1041100.0,AMERICAN DRY GINS,0.990100
2022-01-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.609600
2022-01-01,1042100.0,IMPORTED DRY GINS,0.599100
2022-01-01,1081500.0,TRIPLE SEC,0.498600
2022-01-01,1011600.0,STRAIGHT RYE WHISKIES,0.476600
2022-01-01,1901200.0,SPECIAL ORDER ITEMS,0.400100
2022-01-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,0.364400
2022-01-01,1081100.0,COFFEE LIQUEURS,0.360700
2022-01-01,1012300.0,SINGLE MALT SCOTCH,0.345500
2022-01-01,1062100.0,GOLD RUM,0.265600
2022-01-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.235400
2022-01-01,1062300.0,AGED DARK RUM,0.186200
2022-01-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,0.162400
2022-01-01,1091200.0,NEUTRAL GRAIN SPIRITS,0.133000
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,0.097400
2022-01-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,0.093700
2022-01-01,1011500.0,BOTTLED IN BOND BOURBON,0.090700
2022-01-01,1041200.0,FLAVORED GIN,0.045900
2022-01-01,1022300.0,MEZCAL,0.035600
2022-01-01,1011700.0,CORN WHISKIES,0.022900
2022-01-01,1041300.0,AMERICAN SLOE GINS,0.013300
2022-01-01,1031000.0,AMERICAN VODKAS,0.009600
2022-01-01,1090000.0,DISTILLED SPIRITS SPECIALTY,0.003000
2022-01-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.002300
2022-01-01,1042000.0,IMPORTED GINS,0.001200
2022-01-01,1070000.0,COCKTAILS/RTD,0.000600
2022-01-01,1032000.0,IMPORTED VODKAS,0.000300
2022-01-01,1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.000300
2022-02-01,1031100.0,AMERICAN VODKAS,19.857300
2022-02-01,1081600.0,WHISKEY LIQUEUR,13.568600
2022-02-01,1012100.0,CANADIAN WHISKIES,10.178700
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.520000
2022-02-01,1062400.0,SPICED RUM,4.267900
2022-02-01,1011100.0,BLENDED WHISKIES,3.263600
2022-02-01,1031200.0,AMERICAN FLAVORED VODKA,3.191400
2022-02-01,1022200.0,100% AGAVE TEQUILA,3.026700
2022-02-01,1022100.0,MIXTO TEQUILA,2.913900
2022-02-01,1051100.0,AMERICAN BRANDIES,2.728700
2022-02-01,1081400.0,AMERICAN SCHNAPPS,2.427300
2022-02-01,1032100.0,IMPORTED VODKAS,2.268000
2022-02-01,1011400.0,TENNESSEE WHISKIES,2.142100
2022-02-01,1071100.0,COCKTAILS/RTD,2.105500
2022-02-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,2.003700
2022-02-01,1062200.0,WHITE RUM,1.863200
2022-02-01,1012400.0,IRISH WHISKIES,1.811400
2022-02-01,1062500.0,FLAVORED RUM,1.777900
2022-02-01,1052100.0,IMPORTED BRANDIES,1.764200
2022-02-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,1.498500
2022-02-01,1081200.0,CREAM LIQUEURS,1.485100
2022-02-01,1082200.0,IMPORTED SCHNAPPS,1.393300
2022-02-01,1041100.0,AMERICAN DRY GINS,0.962300
2022-02-01,1032200.0,IMPORTED FLAVORED VODKA,0.950000
2022-02-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.941300
2022-02-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,0.894800
2022-02-01,1042100.0,IMPORTED DRY GINS,0.749700
2022-02-01,1012200.0,SCOTCH WHISKIES,0.698500
2022-02-01,1081500.0,TRIPLE SEC,0.602200
2022-02-01,1011600.0,STRAIGHT RYE WHISKIES,0.493000
2022-02-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,0.375100
2022-02-01,1081100.0,COFFEE LIQUEURS,0.370400
2022-02-01,1012300.0,SINGLE MALT SCOTCH,0.335900
2022-02-01,1062100.0,GOLD RUM,0.285300
2022-02-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.207300
2022-02-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,0.183200
2022-02-01,1091200.0,NEUTRAL GRAIN SPIRITS,0.166900
2022-02-01,1062300.0,AGED DARK RUM,0.158100
2022-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,0.149000
2022-02-01,1901200.0,SPECIAL ORDER ITEMS,0.126100
2022-02-01,1011500.0,BOTTLED IN BOND BOURBON,0.106200
2022-02-01,1022300.0,MEZCAL,0.065200
2022-02-01,1041200.0,FLAVORED GIN,0.042000
2022-02-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,0.034600
2022-02-01,1011700.0,CORN WHISKIES,0.023700
2022-02-01,1041300.0,AMERICAN SLOE GINS,0.01030
Query:
SELECT
      "category",
      "category_name",
      AVG("percentage_contribution") AS "average_percentage"
    FROM (
      SELECT
        category_monthly."month",
        category_monthly."category",
        category_monthly."category_name",
        (category_monthly."monthly_bottles_sold" / total_monthly."total_bottles_sold") * 100 AS "percentage_contribution"
      FROM (
        SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("bottles_sold") AS "monthly_bottles_sold"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "month", "category", "category_name"
      ) AS category_monthly
      JOIN (
        SELECT DATE_TRUNC('month', "date") AS "month", SUM("bottles_sold") AS "total_bottles_sold"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "month"
      ) AS total_monthly
      ON category_monthly."month" = total_monthly."month"
    ) AS percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1
    ORDER BY "average_percentage" DESC
    LIMIT 100;
Answer:
category,category_name,average_percentage
1031100.0,AMERICAN VODKAS,20.656546391753
1031080.0,VODKA 80 PROOF,18.781676785714
1012100.0,CANADIAN WHISKIES,10.832516339869
1081600.0,WHISKEY LIQUEUR,8.226410457516
1062310.0,SPICED RUM,6.880446428571
1062400.0,SPICED RUM,5.092378571429
1011200.0,STRAIGHT BOURBON WHISKIES,4.654230718954
1022100.0,TEQUILA,4.236514285714
1032080.0,IMPORTED VODKAS,3.909978571429
1031200.0,VODKA FLAVORED,3.809821428571
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,3.766185714286
1011100.0,BLENDED WHISKIES,3.594673856209
1031200.0,AMERICAN FLAVORED VODKA,3.385392857143
1032100.0,IMPORTED VODKAS,2.947568041237
1051010.0,AMERICAN GRAPE BRANDIES,2.740301785714
1051100.0,AMERICAN BRANDIES,2.721236734694
1011300.0,TENNESSEE WHISKIES,2.679389285714
1081400.0,AMERICAN SCHNAPPS,2.568816326531
1022100.0,MIXTO TEQUILA,2.522961224490
1022200.0,100% AGAVE TEQUILA,2.440875510204
1011400.0,TENNESSEE WHISKIES,2.372113265306
1081300.0,AMERICAN CORDIALS & LIQUEURS,2.264376288660
1071100.0,AMERICAN COCKTAILS,2.213758928571
1052100.0,IMPORTED BRANDIES,2.185643877551
1062300.0,FLAVORED RUM,2.177719642857
1071100.0,COCKTAILS/RTD,2.173704225352
1071000.0,COCKTAILS/RTD,2.087070370370
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,1.959696428571
1062200.0,WHITE RUM,1.936488775510
1062500.0,FLAVORED RUM,1.890605102041
1041100.0,AMERICAN DRY GINS,1.885422875817
1032200.0,IMPORTED VODKA - MISC,1.837689285714
1052010.0,IMPORTED GRAPE BRANDIES,1.629339285714
1081200.0,CREAM LIQUEURS,1.559086928105
1081390.0,IMPORTED SCHNAPPS,1.432871428571
1082000.0,IMPORTED CORDIALS & LIQUEURS,1.178930434783
1032200.0,IMPORTED FLAVORED VODKA,1.177040816327
1082200.0,IMPORTED SCHNAPPS,1.152865306122
1701100.0,TEMPORARY & SPECIALTY PACKAGES,1.137604123711
1012400.0,IRISH WHISKIES,1.115817346939
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,1.004814285714
Query:
SELECT MIN("date") AS "earliest_date", MAX("date") AS "latest_date"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
Answer:
earliest_date,latest_date
2012-01-03,2024-09-30
Query:
SELECT "category", "category_name", COUNT(*) AS "transaction_count"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "transaction_count" DESC
    LIMIT 100;
Answer:
category,category_name,transaction_count
1031100.0,AMERICAN VODKAS,1104081
1012100.0,CANADIAN WHISKIES,666318
1011200.0,STRAIGHT BOURBON WHISKIES,543268
1081600.0,WHISKEY LIQUEUR,441995
1031200.0,AMERICAN FLAVORED VODKA,344363
1022200.0,100% AGAVE TEQUILA,336695
1062400.0,SPICED RUM,278027
1011100.0,BLENDED WHISKIES,254160
1081400.0,AMERICAN SCHNAPPS,233360
1011400.0,TENNESSEE WHISKIES,205903
1071000.0,COCKTAILS/RTD,178100
1081300.0,AMERICAN CORDIALS & LIQUEURS,174863
1701100.0,TEMPORARY & SPECIALTY PACKAGES,170787
1032100.0,IMPORTED VODKAS,164326
1051100.0,AMERICAN BRANDIES,161832
1022100.0,MIXTO TEQUILA,155529
1062500.0,FLAVORED RUM,144729
1081200.0,CREAM LIQUEURS,136266
1082100.0,IMPORTED CORDIALS & LIQUEURS,131408
1062200.0,WHITE RUM,125845
1052100.0,IMPORTED BRANDIES,116122
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,103903
1082200.0,IMPORTED SCHNAPPS,96318
1032200.0,IMPORTED FLAVORED VODKA,91096
1041100.0,AMERICAN DRY GINS,90794
1012400.0,IRISH WHISKIES,87878
1012200.0,SCOTCH WHISKIES,86207
1042100.0,IMPORTED DRY GINS,67665
1011600.0,STRAIGHT RYE WHISKIES,58244
1012300.0,SINGLE MALT SCOTCH,46590
1071100.0,COCKTAILS/RTD,43076
1081100.0,COFFEE LIQUEURS,31192
1062100.0,GOLD RUM,30695
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,27461
1082000.0,IMPORTED CORDIALS & LIQUEURS,27442
1011500.0,BOTTLED IN BOND BOURBON,24655
1081500.0,TRIPLE SEC,22645
1062300.0,AGED DARK RUM,21252
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,18658
1011300.0,SINGLE BARREL BOURBON WHISKIES,17584
1091200.0,NEUTRAL GRAIN SPIRITS,13662
1041200.0,FLAVORED GIN,11887
1022300.0,MEZCAL,8208
1901000.0,SPECIAL ORDER ITEMS,5398
1011700.0,CORN WHISKIES,3918
1041300.0,AMERICAN SLOE GINS,1671
1700000.0,TEMPORARY & SPECIALTY PACKAGES,1560
1901200.0,SPECIAL ORDER ITEMS,1173
1032000.0,IMPORTED VODKAS,446
1081000.0,AMERICAN CORDIALS & LIQUEURS,322
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,90
1090000.0,DISTILLED SPIRITS SPECIALTY,28
1031000.0,AMERICAN VODKAS,27
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,21
1042000.0,IMPORTED GINS,5
1070000.0,COCKTAILS/RTD,2
1012000.0,IMPORTED WHISKIES,2
Query:
SELECT "category", "category_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 100;
Answer:
category,category_name,total_sales_dollars
1031100.0,AMERICAN VODKAS,179745485.11999997
1012100.0,CANADIAN WHISKIES,132576922.83000004
1011200.0,STRAIGHT BOURBON WHISKIES,103185787.80999999
1022200.0,100% AGAVE TEQUILA,85464658.22999999
1081600.0,WHISKEY LIQUEUR,71569310.74999997
1062400.0,SPICED RUM,59913495.67000002
1011400.0,TENNESSEE WHISKIES,45330463.41999999
1701100.0,TEMPORARY & SPECIALTY PACKAGES,32814181.099999994
1032100.0,IMPORTED VODKAS,32765618.36
1031200.0,AMERICAN FLAVORED VODKA,31694810.599999987
1052100.0,IMPORTED BRANDIES,31684334.119999994
1022100.0,MIXTO TEQUILA,30429267.880000003
1011100.0,BLENDED WHISKIES,30342065.090000004
1082100.0,IMPORTED CORDIALS & LIQUEURS,27530417.860000003
1012400.0,IRISH WHISKIES,26380132.700000003
1062500.0,FLAVORED RUM,22205501.160000004
1081200.0,CREAM LIQUEURS,21264617.720000006
1081400.0,AMERICAN SCHNAPPS,19310104.479999993
1071000.0,COCKTAILS/RTD,17644569.080000002
1082200.0,IMPORTED SCHNAPPS,16681896.27
1062200.0,WHITE RUM,16297569.899999999
1012200.0,SCOTCH WHISKIES,15375997.159999995
1042100.0,IMPORTED DRY GINS,14614520.299999999
1051100.0,AMERICAN BRANDIES,12865521.059999997
1032200.0,IMPORTED FLAVORED VODKA,12776975.35
1081300.0,AMERICAN CORDIALS & LIQUEURS,12094166.240000004
1011600.0,STRAIGHT RYE WHISKIES,11784044.480000002
1012300.0,SINGLE MALT SCOTCH,11106384.069999998
1041100.0,AMERICAN DRY GINS,9053573.949999997
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,8884569.170000002
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,6926818.62
1082000.0,IMPORTED CORDIALS & LIQUEURS,5784856.680000001
1081100.0,COFFEE LIQUEURS,5692498.209999999
1011300.0,SINGLE BARREL BOURBON WHISKIES,5053306.64
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,4818672.410000002
1071100.0,COCKTAILS/RTD,4719380.419999998
1011500.0,BOTTLED IN BOND BOURBON,3221046.4500000007
1062100.0,GOLD RUM,2786861.62
1062300.0,AGED DARK RUM,2721742.480000001
1901000.0,SPECIAL ORDER ITEMS,2676237.7900000005
1041200.0,FLAVORED GIN,2561542.519999999
1081500.0,TRIPLE SEC,2300558.4899999998
1091200.0,NEUTRAL GRAIN SPIRITS,1683406.0400000005
1022300.0,MEZCAL,1397584.3299999998
1901200.0,SPECIAL ORDER ITEMS,900703.3999999997
1011700.0,CORN WHISKIES,773907.4899999999
1700000.0,TEMPORARY & SPECIALTY PACKAGES,470194.36
1041300.0,AMERICAN SLOE GINS,71906.98000000001
1032000.0,IMPORTED VODKAS,55869.18999999999
1081000.0,AMERICAN CORDIALS & LIQUEURS,51066.24000000001
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,32717.340000000004
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,8467.68
1031000.0,AMERICAN VODKAS,4124.32
1090000.0,DISTILLED SPIRITS SPECIALTY,3564.98
1042000.0,IMPORTED GINS,1593.36
1012000.0,IMPORTED WHISKIES,1150.56
1070000.0,COCKTAILS/RTD,414.0
Query:
SELECT "category", "category_name", AVG("bottles_sold") AS "average_bottles_per_transaction"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "category", "category_name"
    ORDER BY "average_bottles_per_transaction" DESC
    LIMIT 100;
Answer:
category,category_name,average_bottles_per_transaction
1011800.0,IOWA DISTILLERY WHISKIES,80.145161
1011000.0,AMERICAN WHISKIES,66.000000
1082300.0,SCHNAPPS - IMPORTED,60.000000
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,54.833850
1901000.0,SPECIAL ORDER ITEMS,38.768062
1082390.0,SCHNAPPS - IMPORTED,35.000000
1032000.0,IMPORTED VODKAS,32.319619
1901200.0,SPECIAL ORDER ITEMS,22.731717
1081500.0,TRIPLE SEC,22.114814
1081600.0,WHISKEY LIQUEUR,20.541112
1042000.0,IMPORTED GINS,18.352941
1081400.0,TRIPLE SEC,16.879940
1032230.0,IMPORTED VODKA - CHERRY,15.857143
1031100.0,AMERICAN VODKAS,15.536702
1701100.0,DECANTERS & SPECIALTY PACKAGES,15.307613
1082010.0,AMARETTO - IMPORTED,14.794118
1031080.0,VODKA 80 PROOF,14.316736
1081700.0,DISTILLED SPIRITS SPECIALTY,13.762669
1091200.0,,13.500000
1022100.0,MIXTO TEQUILA,13.433602
1052100.0,IMPORTED BRANDIES,13.006237
1062400.0,SPICED RUM,12.955386
1062250.0,,12.923077
1062310.0,SPICED RUM,12.509244
1012100.0,CANADIAN WHISKIES,12.166085
1900000.0,DELISTED / SPECIAL ORDER ITEMS,12.000000
1052100.0,,11.600000
1032100.0,IMPORTED VODKAS,11.063224
,,10.961412
1051100.0,AMERICAN BRANDIES,10.887612
1051010.0,AMERICAN GRAPE BRANDIES,10.816677
1081317.0,GRAPE SCHNAPPS,10.716268
1011300.0,TENNESSEE WHISKIES,10.605551
1012400.0,IRISH WHISKIES,10.370105
1062200.0,WHITE RUM,10.241945
1032100.0,,10.236758
1081300.0,AMERICAN CORDIALS & LIQUEURS,10.176017
1700000.0,TEMPORARY & SPECIALTY PACKAGES,10.153366
1052010.0,IMPORTED GRAPE BRANDIES,10.123202
1011400.0,TENNESSEE WHISKIES,9.767258
1041100.0,AMERICAN DRY GINS,9.662087
1011500.0,STRAIGHT RYE WHISKIES,9.391572
1101100.0,AMERICAN ALCOHOL,9.372264
1022100.0,TEQUILA,9.371771
1032080.0,IMPORTED VODKAS,9.345825
1062500.0,FLAVORED RUM,9.280111
1081400.0,AMERICAN SCHNAPPS,9.144875
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,9.144263
1011100.0,BLENDED WHISKIES,9.087082
1031100.0,100 PROOF VODKA,8.973720
1081330.0,PEACH SCHNAPPS,8.947271
1091200.0,NEUTRAL GRAIN SPIRITS,8.926699
1082200.0,IMPORTED SCHNAPPS,8.910131
1082100.0,IMPORTED CORDIALS & LIQUEURS,8.813472
1081370.0,WATERMELON SCHNAPPS,8.773145
1091100.0,,8.703883
1071100.0,COCKTAILS/RTD,8.617837
1012300.0,IRISH WHISKIES,8.453269
1081010.0,AMERICAN AMARETTO,8.369976
1071000.0,COCKTAILS/RTD,8.257754
1022200.0,100% AGAVE TEQUILA,8.210170
1701100.0,TEMPORARY & SPECIALTY PACKAGES,8.193199
1081390.0,IMPORTED SCHNAPPS,8.066780
1011200.0,STRAIGHT BOURBON WHISKIES,8.002422
1031200.0,AMERICAN FLAVORED VODKA,7.988832
1082015.0,IMPORTED AMARETTO,7.972222
1051140.0,PEACH BRANDIES,7.841672
1081100.0,COFFEE LIQUEURS,7.834563
1081200.0,CREAM LIQUEURS,7.813621
1032200.0,IMPORTED FLAVORED VODKA,7.774968
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,7.749814
1062400.0,,7.678851
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,7.659389
1082000.0,IMPORTED CORDIALS & LIQUEURS,7.640849
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS,7.629689
1081305.0,APPLE SCHNAPPS,7.619596
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS,7.562427
1062300.0,FLAVORED RUM,7.518855
1042100.0,IMPORTED DRY GINS,7.501262
1041200.0,FLAVORED GIN,7.498000
1071100.0,AMERICAN COCKTAILS,7.449495
1031200.0,VODKA FLAVORED,7.344949
1081300.0,PEPPERMINT SCHNAPPS,7.288878
1081340.0,ROOT BEER SCHNAPPS,7.177378
1051110.0,BLACKBERRY BRANDIES,7.122182
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,6.936330
1032200.0,IMPORTED VODKA - MISC,6.916469
1081030.0,COFFEE LIQUEURS,6.853480
1011600.0,CORN WHISKIES,6.832447
1081015.0,IMPORTED AMARETTO,6.739434
1051100.0,APRICOT BRANDIES,6.671999
1081100.0,,6.666667
1090000.0,DISTILLED SPIRITS SPECIALTY,6.641745
1091300.0,,6.607143
1081312.0,BUTTERSCOTCH SCHNAPPS,6.551543
1062100.0,GOLD RUM,6.537140
1011600.0,STRAIGHT RYE WHISKIES,6.517086
1081350.0,SPEARMINT SCHNAPPS,6.459016
1011300.0,SINGLE BARREL BOURBON WHISKIES,6.411211
1051150.0,MISCELLANEOUS  BRANDIES,6.355244
End Exploring Related Columns
Task: In the Iowa Liquor Sales dataset, starting from January 1, 2022 through the last fully completed month, which two liquor categories, each contributing an average of at least 1% to the monthly sales volume over at least 24 months of available data, have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales across those months, and what are their names?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Category1,Category2
Brandy,Tequila
```

Brandy and Tequila are the two liquor categories that each contributed an average of at least 1% to the monthly sales volume over at least 24 months. They have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales from January 1, 2022 through the last fully completed month..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 15:29:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:29:59 - root - INFO - ```sql
WITH months AS (
    SELECT DATE_TRUNC('month', DATEADD(month, seq4.seq4 - 1, '2022-01-01'::DATE)) AS "month"
    FROM TABLE(
      GENERATOR(
        ROWCOUNT => DATEDIFF(
          month, '2022-01-01', DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE()))
        ) + 1
      )
    ) seq4
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATEADD(month, 0, DATE_TRUNC('month', CURRENT_DATE()))
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATEADD(month, 0, DATE_TRUNC('month', CURRENT_DATE()))
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
pairwise_data AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        c1."month",
        c1."percentage_contribution" AS "pc1",
        c2."percentage_contribution" AS "pc2"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
),
correlation_data AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        COUNT(*) AS N,
        SUM(pc1) AS sum_x,
        SUM(pc2) AS sum_y,
        SUM(pc1 * pc1) AS sum_x2,
        SUM(pc2 * pc2) AS sum_y2,
        SUM(pc1 * pc2) AS sum_xy
    FROM pairwise_data
    GROUP BY "category1", "category_name1", "category2", "category_name2"
),
correlations AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        CASE
            WHEN (N * sum_x2 - sum_x * sum_x) = 0 OR (N * sum_y2 - sum_y * sum_y) = 0 THEN NULL
            ELSE (N * sum_xy - sum_x * sum_y) / SQRT( (N * sum_x2 - sum_x * sum_x) * (N * sum_y2 - sum_y * sum_y) )
        END AS "correlation_coefficient"
    FROM correlation_data
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC
LIMIT 1;
```
2025-02-11 15:29:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:29:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:29:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:00 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:01 - root - INFO - itercount: 1
2025-02-11 15:30:01 - root - INFO - 000904 (42000): 01ba52e2-0004-9b03-0001-11c3010dd182: SQL compilation error: error line 2 at position 46
invalid identifier 'SEQ4.SEQ4'
2025-02-11 15:30:01 - root - INFO - Input sql:
WITH months AS (
    SELECT DATE_TRUNC('month', DATEADD(month, seq4.seq4 - 1, '2022-01-01'::DATE)) AS "month"
    FROM TABLE(
      GENERATOR(
        ROWCOUNT => DATEDIFF(
          month, '2022-01-01', DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE()))
        ) + 1
      )
    ) seq4
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATEADD(month, 0, DATE_TRUNC('month', CURRENT_DATE()))
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATEADD(month, 0, DATE_TRUNC('month', CURRENT_DATE()))
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
pairwise_data AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        c1."month",
        c1."percentage_contribution" AS "pc1",
        c2."percentage_contribution" AS "pc2"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
),
correlation_data AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        COUNT(*) AS N,
        SUM(pc1) AS sum_x,
        SUM(pc2) AS sum_y,
        SUM(pc1 * pc1) AS sum_x2,
        SUM(pc2 * pc2) AS sum_y2,
        SUM(pc1 * pc2) AS sum_xy
    FROM pairwise_data
    GROUP BY "category1", "category_name1", "category2", "category_name2"
),
correlations AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        CASE
            WHEN (N * sum_x2 - sum_x * sum_x) = 0 OR (N * sum_y2 - sum_y * sum_y) = 0 THEN NULL
            ELSE (N * sum_xy - sum_x * sum_y) / SQRT( (N * sum_x2 - sum_x * sum_x) * (N * sum_y2 - sum_y * sum_y) )
        END AS "correlation_coefficient"
    FROM correlation_data
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC
LIMIT 1;
The error information is:
000904 (42000): 01ba52e2-0004-9b03-0001-11c3010dd182: SQL compilation error: error line 2 at position 46
invalid identifier 'SEQ4.SEQ4'
Please correct it and output only 1 complete SQL query.Be careful of using GENERATOR. Don't use seq4(), use ROW_NUMBER().

2025-02-11 15:30:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:30:41 - root - INFO - ```sql
WITH months AS (
    SELECT DATE_TRUNC('month', DATEADD(month, ROW_NUMBER() OVER (ORDER BY NULL) - 1, '2022-01-01'::DATE)) AS "month"
    FROM TABLE(
      GENERATOR(
        ROWCOUNT => DATEDIFF(
          month, '2022-01-01', DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE()))
        ) + 1
      )
    )
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
pairwise_data AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        c1."month",
        c1."percentage_contribution" AS "pc1",
        c2."percentage_contribution" AS "pc2"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
),
correlation_data AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        COUNT(*) AS N,
        SUM(pc1) AS sum_x,
        SUM(pc2) AS sum_y,
        SUM(pc1 * pc1) AS sum_x2,
        SUM(pc2 * pc2) AS sum_y2,
        SUM(pc1 * pc2) AS sum_xy
    FROM pairwise_data
    GROUP BY "category1", "category_name1", "category2", "category_name2"
),
correlations AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        CASE
            WHEN (N * sum_x2 - sum_x * sum_x) = 0 OR (N * sum_y2 - sum_y * sum_y) = 0 THEN NULL
            ELSE (N * sum_xy - sum_x * sum_y) / SQRT( (N * sum_x2 - sum_x * sum_x) * (N * sum_y2 - sum_y * sum_y) )
        END AS "correlation_coefficient"
    FROM correlation_data
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC
LIMIT 1;
```
2025-02-11 15:30:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:30:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:30:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:43 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:43 - root - INFO - itercount: 2
2025-02-11 15:30:43 - root - INFO - 000904 (42000): 01ba52e2-0004-9b03-0001-11c3010dd18a: SQL compilation error: error line 76 at position 12
invalid identifier 'PC1'
2025-02-11 15:30:43 - root - INFO - Input sql:
WITH months AS (
    SELECT DATE_TRUNC('month', DATEADD(month, ROW_NUMBER() OVER (ORDER BY NULL) - 1, '2022-01-01'::DATE)) AS "month"
    FROM TABLE(
      GENERATOR(
        ROWCOUNT => DATEDIFF(
          month, '2022-01-01', DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE()))
        ) + 1
      )
    )
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
pairwise_data AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        c1."month",
        c1."percentage_contribution" AS "pc1",
        c2."percentage_contribution" AS "pc2"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
),
correlation_data AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        COUNT(*) AS N,
        SUM(pc1) AS sum_x,
        SUM(pc2) AS sum_y,
        SUM(pc1 * pc1) AS sum_x2,
        SUM(pc2 * pc2) AS sum_y2,
        SUM(pc1 * pc2) AS sum_xy
    FROM pairwise_data
    GROUP BY "category1", "category_name1", "category2", "category_name2"
),
correlations AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        CASE
            WHEN (N * sum_x2 - sum_x * sum_x) = 0 OR (N * sum_y2 - sum_y * sum_y) = 0 THEN NULL
            ELSE (N * sum_xy - sum_x * sum_y) / SQRT( (N * sum_x2 - sum_x * sum_x) * (N * sum_y2 - sum_y * sum_y) )
        END AS "correlation_coefficient"
    FROM correlation_data
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC
LIMIT 1;
The error information is:
000904 (42000): 01ba52e2-0004-9b03-0001-11c3010dd18a: SQL compilation error: error line 76 at position 12
invalid identifier 'PC1'
Please correct it and output only 1 complete SQL query.Be careful of using GENERATOR. Don't use seq4(), use ROW_NUMBER().

2025-02-11 15:31:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:31:40 - root - INFO - ```sql
WITH months AS (
    SELECT DATE_TRUNC('month', DATEADD(month, ROW_NUMBER() OVER (ORDER BY null) - 1, '2022-01-01'::DATE)) AS "month"
    FROM TABLE(
        GENERATOR(
            ROWCOUNT => DATEDIFF(
                month, '2022-01-01', DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE()))
            ) + 1
        )
    )
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
pairwise_data AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        c1."month",
        c1."percentage_contribution" AS "pc1",
        c2."percentage_contribution" AS "pc2"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
),
correlation_data AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        COUNT(*) AS "N",
        SUM("pc1") AS "sum_x",
        SUM("pc2") AS "sum_y",
        SUM("pc1" * "pc1") AS "sum_x2",
        SUM("pc2" * "pc2") AS "sum_y2",
        SUM("pc1" * "pc2") AS "sum_xy"
    FROM pairwise_data
    GROUP BY "category1", "category_name1", "category2", "category_name2"
),
correlations AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        CASE
            WHEN ("N" * "sum_x2" - "sum_x" * "sum_x") = 0 OR ("N" * "sum_y2" - "sum_y" * "sum_y") = 0 THEN NULL
            ELSE ("N" * "sum_xy" - "sum_x" * "sum_y") / SQRT( ("N" * "sum_x2" - "sum_x" * "sum_x") * ("N" * "sum_y2" - "sum_y" * "sum_y") )
        END AS "correlation_coefficient"
    FROM correlation_data
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC NULLS LAST
LIMIT 1;
```
2025-02-11 15:31:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:31:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:31:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:31:41 - snowflake.connector.connection - INFO - closed
2025-02-11 15:31:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:31:41 - root - INFO - itercount: 3
2025-02-11 15:31:41 - root - INFO - 001015 (22023): 01ba52e3-0004-9ba6-0001-11c3010db952: SQL compilation error:
argument 1 to function GENERATOR needs to be constant, found '(CAST(DATE_DIFFDATEINMONTHS('2022-01-01', '2025-01-01') AS NUMBER(9,0))) + 1'
2025-02-11 15:31:41 - root - INFO - Input sql:
WITH months AS (
    SELECT DATE_TRUNC('month', DATEADD(month, ROW_NUMBER() OVER (ORDER BY null) - 1, '2022-01-01'::DATE)) AS "month"
    FROM TABLE(
        GENERATOR(
            ROWCOUNT => DATEDIFF(
                month, '2022-01-01', DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE()))
            ) + 1
        )
    )
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
pairwise_data AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        c1."month",
        c1."percentage_contribution" AS "pc1",
        c2."percentage_contribution" AS "pc2"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
),
correlation_data AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        COUNT(*) AS "N",
        SUM("pc1") AS "sum_x",
        SUM("pc2") AS "sum_y",
        SUM("pc1" * "pc1") AS "sum_x2",
        SUM("pc2" * "pc2") AS "sum_y2",
        SUM("pc1" * "pc2") AS "sum_xy"
    FROM pairwise_data
    GROUP BY "category1", "category_name1", "category2", "category_name2"
),
correlations AS (
    SELECT
        "category1",
        "category_name1",
        "category2",
        "category_name2",
        CASE
            WHEN ("N" * "sum_x2" - "sum_x" * "sum_x") = 0 OR ("N" * "sum_y2" - "sum_y" * "sum_y") = 0 THEN NULL
            ELSE ("N" * "sum_xy" - "sum_x" * "sum_y") / SQRT( ("N" * "sum_x2" - "sum_x" * "sum_x") * ("N" * "sum_y2" - "sum_y" * "sum_y") )
        END AS "correlation_coefficient"
    FROM correlation_data
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC NULLS LAST
LIMIT 1;
The error information is:
001015 (22023): 01ba52e3-0004-9ba6-0001-11c3010db952: SQL compilation error:
argument 1 to function GENERATOR needs to be constant, found '(CAST(DATE_DIFFDATEINMONTHS('2022-01-01', '2025-01-01') AS NUMBER(9,0))) + 1'
Please correct it and output only 1 complete SQL query.Be careful of using GENERATOR. Don't use seq4(), use ROW_NUMBER().

2025-02-11 15:32:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:32:21 - root - INFO - ```sql
WITH months AS (
    SELECT DISTINCT DATE_TRUNC('month', "date") AS "month"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
correlations AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        CORR(c1."percentage_contribution", c2."percentage_contribution") AS "correlation_coefficient"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
    GROUP BY c1."category", c1."category_name", c2."category", c2."category_name"
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC NULLS LAST
LIMIT 1;
```
2025-02-11 15:32:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:32:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:32:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:32:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 15:32:23 - snowflake.connector.connection - INFO - closed
2025-02-11 15:32:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:32:23 - root - INFO - itercount: 4
2025-02-11 15:32:23 - root - INFO - 0
2025-02-11 15:32:23 - root - INFO - results: 
Category1,Category2
AMERICAN VODKAS,AMERICAN SCHNAPPS


2025-02-11 15:32:23 - root - INFO - Please check the answer again by reviewing In the Iowa Liquor Sales dataset, starting from January 1, 2022 through the last fully completed month, which two liquor categories, each contributing an average of at least 1% to the monthly sales volume over at least 24 months of available data, have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales across those months, and what are their names?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Category1,Category2
Brandy,Tequila
```

Brandy and Tequila are the two liquor categories that each contributed an average of at least 1% to the monthly sales volume over at least 24 months. They have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales from January 1, 2022 through the last fully completed month. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category1,Category2
AMERICAN VODKAS,AMERICAN SCHNAPPS
Current sql:
WITH months AS (
    SELECT DISTINCT DATE_TRUNC('month', "date") AS "month"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
correlations AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        CORR(c1."percentage_contribution", c2."percentage_contribution") AS "correlation_coefficient"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
    GROUP BY c1."category", c1."category_name", c2."category", c2."category_name"
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC NULLS LAST
LIMIT 1;
2025-02-11 15:32:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:32:55 - root - INFO - ```sql
WITH months AS (
    SELECT DISTINCT DATE_TRUNC('month', "date") AS "month"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
),
total_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("bottles_sold") AS "total_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month"
),
category_monthly AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("bottles_sold") AS "monthly_bottles_sold"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE())
    GROUP BY "month", "category", "category_name"
),
percentage_data AS (
    SELECT
        cm."month",
        cm."category",
        cm."category_name",
        (cm."monthly_bottles_sold" / tm."total_bottles_sold") * 100 AS "percentage_contribution"
    FROM category_monthly cm
    JOIN total_monthly tm ON cm."month" = tm."month"
),
qualifying_categories AS (
    SELECT
        "category",
        "category_name",
        AVG("percentage_contribution") AS "average_percentage",
        COUNT(DISTINCT "month") AS "months_with_sales"
    FROM percentage_data
    GROUP BY "category", "category_name"
    HAVING AVG("percentage_contribution") >= 1 AND COUNT(DISTINCT "month") >= 24
),
category_month_matrix AS (
    SELECT
        m."month",
        qc."category",
        qc."category_name",
        COALESCE(pd."percentage_contribution", 0) AS "percentage_contribution"
    FROM months m
    CROSS JOIN qualifying_categories qc
    LEFT JOIN percentage_data pd ON pd."month" = m."month" AND pd."category" = qc."category"
),
correlations AS (
    SELECT
        c1."category" AS "category1",
        c1."category_name" AS "category_name1",
        c2."category" AS "category2",
        c2."category_name" AS "category_name2",
        CORR(c1."percentage_contribution", c2."percentage_contribution") AS "correlation_coefficient"
    FROM category_month_matrix c1
    JOIN category_month_matrix c2
        ON c1."month" = c2."month" AND c1."category" < c2."category"
    GROUP BY c1."category", c1."category_name", c2."category", c2."category_name"
)
SELECT
    "category_name1" AS "Category1",
    "category_name2" AS "Category2"
FROM correlations
ORDER BY ABS("correlation_coefficient") ASC NULLS LAST
LIMIT 1;
```
2025-02-11 15:32:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:32:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:32:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:32:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 15:32:56 - snowflake.connector.connection - INFO - closed
2025-02-11 15:32:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:32:57 - root - INFO - itercount: 5
2025-02-11 15:32:57 - root - INFO - 0
2025-02-11 15:32:57 - root - INFO - Total iteration counts: 5
