SELECT
  COALESCE(m."STATE_ABBREVIATION", d."STATE_ABBREVIATION") AS "State",
  COALESCE(m."Num_Entities_Mar_1_2020", 0) AS "Num_Entities_Mar_1_2020",
  COALESCE(d."Num_Entities_Dec_31_2021", 0) AS "Num_Entities_Dec_31_2021",
  ROUND(
    CASE 
      WHEN COALESCE(m."Num_Entities_Mar_1_2020", 0) = 0 THEN NULL
      ELSE ((COALESCE(d."Num_Entities_Dec_31_2021", 0) - m."Num_Entities_Mar_1_2020")::FLOAT / m."Num_Entities_Mar_1_2020") * 100
    END, 4
  ) AS "Percentage_Change"
FROM
  (SELECT "STATE_ABBREVIATION", COUNT(*) AS "Num_Entities_Mar_1_2020"
   FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_BRANCH_ENTITIES"
   WHERE "START_DATE" <= '2020-03-01'
     AND ("END_DATE" IS NULL OR "END_DATE" >= '2020-03-01')
     AND "STATE_ABBREVIATION" IS NOT NULL AND "STATE_ABBREVIATION" <> ''
   GROUP BY "STATE_ABBREVIATION") m
FULL OUTER JOIN
  (SELECT "STATE_ABBREVIATION", COUNT(*) AS "Num_Entities_Dec_31_2021"
   FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_BRANCH_ENTITIES"
   WHERE "START_DATE" <= '2021-12-31'
     AND ("END_DATE" IS NULL OR "END_DATE" >= '2021-12-31')
     AND "STATE_ABBREVIATION" IS NOT NULL AND "STATE_ABBREVIATION" <> ''
   GROUP BY "STATE_ABBREVIATION") d
ON m."STATE_ABBREVIATION" = d."STATE_ABBREVIATION"
ORDER BY "State";