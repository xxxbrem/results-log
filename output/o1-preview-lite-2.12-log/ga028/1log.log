2025-02-11 13:00:40 - openai._base_client - INFO - Retrying request to /chat/completions in 0.460996 seconds
2025-02-11 13:01:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 13:01:41 - root - INFO - SQL:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
Results:
event_name
ad_reward
session_start
select_content
level_complete_quickplay
os_update
in_app_purchase
level_end_quickplay
app_update
level_reset_quickplay
dynamic_link_app_open
notification_foreground
user_engagement
level_fail_quickplay
completed_5_levels
post_score
level_up
no_more_extra_steps
level_retry
screen_view
level_start_quickplay
level_fail
app_exception
error
use_extra_steps
level_retry_quickplay
app_remove
app_clear_data
dynamic_link_first_open
level_start
level_end
challenge_a_friend
level_complete
level_reset
firebase_campaign
challenge_accepted
spend_virtual_currency
first_open

2025-02-11 13:01:45 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
Results:
user_pseudo_id
72B0A7CF704348BBF6061BC012F84B99
F94E005EB49AFB8DA0A78030D4ABB44B
1A5536C27AB27C3E4588908D345C37F5
B94838D0FE62AC63327CCE2B6B799319
B745605203DEDE5CB888F723828ECF5B
43504D72996A7D69E96BFC94905856BE
1756558602A5C14A5DD2AD4B696D2191
47CEECC477E37BBFF85825843B6FEAB1
6135D8D8F7CE4ED79A903F15A5DFB6AA
4515CFE284B0622651F14BBC2E8EF808
3D4E673690596D1710930116C2D99E8E
667A8D0FDB2FA1BA819DAB6C0F5C7BC4
D7D1BA6ED11F3F862998ED8B8DB94249
88874FDE50373C3FF63C6F7D53A49F72
7DD3C849CB4C42B461AAB36972767FE6
3FC8ECFC8F2976C5B56D0D782F36BD7F
6D24F421B34B2CFDCF3A9983CF63D647
EFB696A82D093B3AFBE92FF526DD5CEA
CF129022E8FA7FFDEB69DDE1570938DA
F976F87FDD7C7B98696A93BC62C57610
7657E94F33F780A1D896FBC9237E5ECC
410456004F702B7F96B3B39BCC44051D
8D36DAECEFE7AE72CB36D9E7A4BE1F5F
30DA335301915FFBD0A384553805EA15
43A83473824B5860784FD7866EA79CE5
A79463D6757978B36380C173D1CA7B2E
D09FF4F523DC97E4F53E6E36E027DE25
825D36CBE9A65B6D3BBFACE4C8C3EE60
D4F52F2C7C2482724A6FCCF02E1AF71D
E98AFA6BD0908A7BDF0FE75396B204DD
184E0C5BE68810D42AF613DF5375530E
3875A92B5F5C2BBA1355CED06A986079
7EDFFF7CB9DB49F6C61708EEBA33A32D
0C055BCFFB1D6F32420A250893009019
3C6A83811DD50E0CFDBD876259FA6D6E
74D4934C305412C92635FC134C437621
C2D17D9066EE1EB9FAE1C8A521BFD4E5
0025BB13501E0221E71E293140C85C01
6D544296013D3F7E5FF708DFE81C3C18
8CFCCD1BCABB1E4C2B70E374EAD03092
CAC4EB6A7DC80207923995F4BE2129DF
B6D597BF7179FCD9CB698FABB4E22817
B5435B0939303B08E468B992DD11CECF
205AE83B43BB3A54E25E55E605AF6431
BBA117EBB63C7CC6E3C9D836C4CE16F7
FB038B1647754ED4E3E7CFEABFC553A4
E2DA3DCB59050A788451A4B3B46D5CFD
F0B84ECACD578E9B52D68AA288A5F2ED
69599C9ED33015D6A6AEE16414074147
62402042F391117D481A9A618E54F84A
9B433955494B47F08BC80C98DA77B460
DBCA64144E263291E94297193210F051
56B9CBB6CB58106DCCF3CAD660232CB2
2285B614DADA95160FF67FD9CBA35778
E80BA7D1EA17162D60C76F8A20B9C45B
B458770ED6E295374FEEB3A68902CC28
90CC0C53AB8C20C6ACD31C2049FF1C03
159002C6F393752AD79B3C2E8C7104C7
E14015A0F7887245A27434A1477B6214
C6D97C0D6DA580A6FDB44BB2C3015A85
091F09F594F7507A1D6D34D006A49CD9
F87F402C12E96886D1E20F34A2632EAC
EF500E0CF578004836D1D38C8901862B
328DC7FE55E8881B2EA668C9A2855BB7
AFF1262CCD472757FC92B2A93C75CD81
F8D02828AA1A4E28F9612CB41DB8BC16
B7603B7B3324056CAF6E576ED8EE284D
0D9DE32D08364277A3406C8107F5763F
E0664E9E7883956A6E3084FD68AA274B
B529E84EE03C578C7E92CE5836AB1C1D
FB49D03591104FB4CEC600157C3A2A0F
CA32F6CB294613C0C6BFCE75C0E684D2
EAA7ACA4BBC7BEC62DDF65BC2A528F48
78CEA7AA04666D7924A253A4AA4C1F4C
45028CA4ED6D9709B55F50CF82E88B3C
7FA1A5B3B4CFDA6EE43060AEE7DDD9B9
2DB65B29C41328FF8AB9AC27B7C05537
B63075B53A750A67A12F7F19ED5AA835
75120F32A68A6C4FB643349E125D8C31
B56E67847E1AE8D6411A5ECCA26585CA
EE502024B7AC261CE1956BB599E020DE
2059AEAA14DF8A5C9B884598E5178572
0CAAA1B6F161BA4D363EB7A2DEF64A08
8252847DECB3C31CAB9BDEE566F97BA2
A0616D4E494DC3BCCB94B8B6E5B48380
5B874F7994400F6943C134F21CA452A7
81F5705397CE9F0236B2B672AE113154
7AA6572327B5C45D273CCD8868760033
74375465CD17299EBC7C75A1B4047EE0
86C65934EDF946EBA8153BF74F0D55CE
59483477E9365F4C9A834CD88B37BA41
06984AB55E6069C42FE61F3510F1522B
9F7B0D1BFB822F5E26E91E184E2E437C

2025-02-11 13:01:51 - root - INFO - SQL:
SELECT `event_name`, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 100
Results:
event_name,event_count
screen_view,2247623
user_engagement,1358958
level_start_quickplay,523430
level_end_quickplay,349729
post_score,242051
level_complete_quickplay,191088
level_fail_quickplay,137035
level_reset_quickplay,122278
select_content,105139
level_start,74417
session_start,74353
level_end,54582
level_retry,43345
level_up,35666
level_complete,33986
level_retry_quickplay,29939
level_fail,17353
spend_virtual_currency,9363
use_extra_steps,8945
level_reset,8535
firebase_campaign,5411
app_exception,5156
first_open,4322
os_update,3290
no_more_extra_steps,2792
app_remove,2639
app_update,2473
ad_reward,1912
completed_5_levels,1867
error,1714
challenge_a_friend,524
in_app_purchase,27
dynamic_link_app_open,19
app_clear_data,17
dynamic_link_first_open,16
challenge_accepted,5
notification_foreground,1

2025-02-11 13:01:56 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
   LIMIT 100
Results:
user_pseudo_id,event_timestamp,event_date
5F7B72E1099BF42C515AC62ADBBB3D7E,1538228903294000,20180929
5F7B72E1099BF42C515AC62ADBBB3D7E,1538288838127000,20180929
D50D60807F5347EB64EF0CD5A3D4C4CD,1538228457559000,20180929
D50D60807F5347EB64EF0CD5A3D4C4CD,1538251568612000,20180929
89E4F685DF983A177EAE221134468F95,1538265962616000,20180929
102CC7D8CD5D3E861EACE1BAB97E61EC,1538230182569000,20180929
A976A39B8E08829A5BC5CD3827C942A2,1538246591894000,20180929
A976A39B8E08829A5BC5CD3827C942A2,1538265771227000,20180929
A976A39B8E08829A5BC5CD3827C942A2,1538276195002000,20180929
B8FE9AD137A133A89389656F7989B36C,1538267476456000,20180929
295D9E24D8DE65A010313E667131EF19,1538209667349000,20180929
295D9E24D8DE65A010313E667131EF19,1538220485921000,20180929
2E650E616327F836FC153592608AED98,1538252110259000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538234052957000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538243913933000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538250969411000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538259038357000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538270949934000,20180929
2F0F260BD7B876C346B41977D0D03D62,1538279742360000,20180929
713C00D8E2137116438668D9A7D90A13,1538233396644000,20180929
A482C98206489AD9E3735688E9F9A978,1538231342297000,20180929
B2D359D114428D8DD085DFAFF11195CE,1538278614140000,20180929
8E2CA56C1FD81A095DECAEDE6F2ED626,1538206909457000,20180929
BE2B55BEAA4A435D8CB9FE792C9CB605,1538266504392000,20180929
7E74A2BB6BBF4746DEE15F957B315401,1538238824495000,20180929
2F2B5C88B72A5253AAF448B1E29333F5,1538232387982000,20180929
946C999569F67A5A013C92E4EFAAAB66,1538231929598000,20180929
5C5A0787542CD24F1E19F9EB778BA766,1538211066365000,20180929
4BF98D09CA8359FC59ADAF56D00338F8,1538258160035000,20180929
4BF98D09CA8359FC59ADAF56D00338F8,1538261500887000,20180929
9DE7361ACCDEA6541AD5EA55D59B1C78,1538238025769000,20180929
906490EA8F6D8BBA578F7CC150DF731D,1538245358989000,20180929
0446949CDEB27AEA0A1151792973D6FB,1538256566603000,20180929
AF29F61BFA8D9AE276EDAE6316EB30AB,1538240900420000,20180929
F3917138A3D4B03ADA1C2E77E3B84649,1538241075581000,20180929
F3917138A3D4B03ADA1C2E77E3B84649,1538243558356000,20180929
3983B79EE1ECAC145E3688021745D894,1538213632156000,20180929
3983B79EE1ECAC145E3688021745D894,1538225377957000,20180929
3983B79EE1ECAC145E3688021745D894,1538229953946000,20180929
3983B79EE1ECAC145E3688021745D894,1538243027879000,20180929
3983B79EE1ECAC145E3688021745D894,1538247182408000,20180929
3983B79EE1ECAC145E3688021745D894,1538273463353000,20180929
3983B79EE1ECAC145E3688021745D894,1538283055245000,20180929

2025-02-11 13:02:01 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
     AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
   LIMIT 100
Results:
user_pseudo_id,user_first_touch_timestamp
06E0067018E618AA31E60BB0F81B50AE,1530849275359000
71FD091EA0D28740B33A8CE935E9F960,1531051674822000
8BE7BF90C971453A34C1FF6FF2A0ACAE,1531082409656000
AD4F00389084ECC4B5362689C228EB0F,1531080354479000
79D9329B7A6FAC4662CCA563CEA8BDF9,1530650297534000
B7684E7147F9608E1B0F0526FF0315A2,1530602371806000
EAA452C246E3CCD96ACAE0634C16443E,1530649116157000
BA92BB1BDDB2B8C151B517B5C7B2795E,1530621468819000
F9F8CB47B2F3AB134BEE169B4BFFE6CD,1530580053083000
54CA0B1CD95413DE6A18F9096B63FE1F,1530642246761000
B10A33E817460B2DA481ADE27C6397C0,1530673110663000
47055E61DA0D1DF28229E1096D48492A,1530586477187000
08F14F3BCA030F81B447161BA8653B44,1531017304885000
4481436304506E0159F4CC6470B259B4,1530828465042000
97ACFC6B43AACA39819731BF51D0848B,1530770670849000
719D9B4C227C6191B8419D7193CCCBB6,1530806403845000
172B72644467779696BD486F28D198EB,1531032091897000
D8A3FB65349D7DC9D73D39B1E473782F,1531032581115000
D027AFF0661BEA2E7489622F24AD0AC0,1531032439610000
32B7138CEF081FCD4CBAF89F26F58A23,1530793941059000
DDAE59D1F0DCF18D15A1BA723158614C,1530573184490000
2153C36F9ABADBC957F8403899AE4B0B,1530572148244000
23FE2E728CBE5ECDAE567700B4021340,1530565617533000
F7C5554230CF0B6DF75093EDF9DF0CA8,1530902967632000
CB0FC6133C39392B5DE1AA13FCF272C6,1530644054901000
08EF81A14E7B20C40AD1C6778DE79D37,1530996145411000
09CAEE95CE99F27D00EA630EEDBCECA2,1530724846263000
017FFA0093F5423E930694F9D80CF61D,1530650927756000
7B73765AA5218F8FA76E3016DB48744F,1530491359661000
EFC4A3D8A0C002EF7E5A8B117655DA49,1531080841422000
65E1F08C08DE2A775D714901FAB9BA96,1530759995559000
FFA9AE78B23263835F8AAED57713EBE9,1530544624770000
E2CD12EE286D97AF7174B8AB91391200,1530598381079000
48D0C822ACA6BD0B5FBA8ECD27CBB247,1530627114539000
724DEDBFE6C39B53BC4B1E222F9BCF31,1530642227632000
4193343164266373A13B35D5D04053E2,1530661006836000
6FC11768E2D8132D0EBD54B823E26DC4,1530648370621000
1E745A3377797A387552386F37AF323D,1530996770850000
74C5538FA4F9984289F0088723F7B694,1530512282790000
94AAC3126541777AC4894F1A54065EF5,1530858674940000
60A18C651D23E2866F761919F140EFBD,1530563231267000
DFE4C6B9CC592603B2CB9B374B258544,1531091114463000
23698E66074685F88DD298C82FE92943,1530930782908000
9FC8C8D89843323CBE3DCE4961C4EC39,1530731526996000
416393D1443B6F0E64C6FD61CD148C03,1530752198167000
00971FE08D31E17AFA5C02BF8C064F47,1530716067947000
E3D9F7190DC8430B3DEE9D5A123646AF,1530500064626000
C8B04CC9FD3A093D9053010A50077ACE,1530510826265000
722002C7F7994CBFEDB4B8B7221CDA65,1530499952312000
A47B378A0FB79A091239B715515F9003,1530773204828000

2025-02-11 13:02:06 - root - INFO - SQL:
SELECT DISTINCT `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
   ORDER BY `event_date`
   LIMIT 100
Results:
event_date
20180612
20180613
20180614
20180615
20180616
20180617
20180618
20180619
20180620
20180621
20180622
20180623
20180624
20180625
20180626
20180627
20180628
20180629
20180630
20180701
20180702
20180703
20180704
20180705
20180706
20180707
20180708
20180709
20180710
20180711
20180712
20180713
20180714
20180715
20180716
20180717
20180718
20180719
20180720
20180721
20180722
20180723
20180724
20180725
20180726
20180727
20180728
20180729
20180730
20180731
20180801
20180802
20180803
20180804
20180805
20180806
20180807
20180808
20180809
20180810
20180811
20180812
20180813
20180814
20180815
20180816
20180817
20180818
20180819
20180820
20180821
20180822
20180823
20180824
20180825
20180826
20180827
20180828
20180829
20180830
20180831
20180901
20180902
20180903
20180904
20180905
20180906
20180907
20180908
20180909
20180910
20180911
20180912
20180913
20180914
20180915
20180916
20180917
20180918
20180919

2025-02-11 13:02:11 - root - INFO - SQL:
SELECT `event_date`, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
Results:
event_date,event_count
20180612,50000
20180613,50000
20180614,50000
20180615,50000
20180616,50000
20180617,50000
20180618,50000
20180619,50000
20180620,50000
20180621,50000
20180622,50000
20180623,50000
20180624,50000
20180625,50000
20180626,50000
20180627,50000
20180628,50000
20180629,50000
20180630,50000
20180701,50000
20180702,50000
20180703,50000
20180704,50000
20180705,50000
20180706,50000
20180707,50000
20180708,50000
20180709,50000
20180710,50000
20180711,50000
20180712,50000
20180713,50000
20180714,50000
20180715,50000
20180716,50000
20180717,50000
20180718,50000
20180719,50000
20180720,50000
20180721,50000
20180722,50000
20180723,50000
20180724,50000
20180725,50000
20180726,50000
20180727,50000
20180728,50000
20180729,50000
20180730,50000
20180731,50000
20180801,50000
20180802,50000
20180803,50000
20180804,50000
20180805,50000
20180806,50000
20180807,50000
20180808,50000
20180809,50000
20180810,50000
20180811,50000
20180812,50000
20180813,50000
20180814,50000
20180815,50000
20180816,50000
20180817,50000
20180818,50000
20180819,50000
20180820,50000
20180821,50000
20180822,50000
20180823,50000
20180824,50000
20180825,50000
20180826,50000
20180827,50000
20180828,50000
20180829,50000
20180830,50000
20180831,50000
20180901,50000
20180902,50000
20180903,50000
20180904,50000
20180905,50000
20180906,50000
20180907,50000
20180908,50000
20180909,50000
20180910,50000
20180911,50000
20180912,50000
20180913,50000
20180914,50000
20180915,50000
20180916,50000
20180917,50000
20180918,50000
20180919,50000

2025-02-11 13:02:16 - root - INFO - SQL:
SELECT DISTINCT ep.key
   FROM `firebase-public-project.analytics_153293282.events_*`,
   UNNEST(event_params) AS ep
   WHERE `event_name` = 'session_start'
   LIMIT 100
Results:
key
firebase_screen_class
firebase_screen_id
firebase_event_origin
firebase_screen
firebase_conversion

2025-02-11 13:03:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 13:03:15 - root - INFO - ```sql
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
LIMIT 100
```
2025-02-11 13:05:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 13:05:02 - root - INFO - SQL:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
LIMIT 100
Results:
key
firebase_screen_class
level
update_with_analytics
product_id
campaign
firebase_error
dynamic_link_link_id
validated
virtual_currency_name
gclid
error_value
system_app
term
content
firebase_screen_id
timestamp
previous_app_version
quantity
message_name
value
firebase_conversion
type
click_timestamp
product_name
item_id
board
firebase_previous_class
message_id
time
firebase_previous_id
item_name
previous_os_version
firebase_screen
source
medium
dynamic_link_accept_time
ad_event_id
previous_first_open_count
price
fatal
engagement_time_msec
firebase_previous_screen
system_app_update
message_time
content_type
ad_unit_code
currency
message_device_time
firebase_event_origin
level_name
score
dynamic_link_link_name

2025-02-11 13:05:08 - root - INFO - SQL:
SELECT DISTINCT up.key
    FROM `firebase-public-project.analytics_153293282.events_*`,
    UNNEST(user_properties) AS up
    LIMIT 100
Results:
key
firebase_exp_4
_ltv_USD
_ltv_SEK
_ltv_PKR
ad_frequency
_ltv_CHF
first_open_time
firebase_exp_5
_ltv_JPY
_ltv_MXN
plays_progressive
_ltv_DKK
initial_extra_steps
plays_quickplay
firebase_exp_1
_ltv_TWD
_ltv_AED
_ltv_EUR
num_levels_available
firebase_last_notification
firebase_exp_7
firebase_exp_3
_ltv_AUD
_ltv_GBP
_ltv_RON

2025-02-11 13:05:13 - root - INFO - SQL:
SELECT `platform`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    GROUP BY `platform`
    LIMIT 100
Results:
platform,user_count
IOS,7765
ANDROID,7410

2025-02-11 13:05:18 - root - INFO - SQL:
SELECT device.mobile_brand_name, device.mobile_model_name, device.operating_system
    FROM `firebase-public-project.analytics_153293282.events_*`
    LIMIT 100
Results:
mobile_brand_name,mobile_model_name,operating_system
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID

2025-02-11 13:05:24 - root - INFO - SQL:
SELECT DISTINCT e.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` AS e
    WHERE TIMESTAMP_MICROS(e.`event_timestamp`) >= TIMESTAMP('2018-07-09')
      AND TIMESTAMP_MICROS(e.`event_timestamp`) < TIMESTAMP('2018-07-16')
      AND e.`user_pseudo_id` IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
          AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
      )
    LIMIT 100
Results:
user_pseudo_id
08F14F3BCA030F81B447161BA8653B44
DA534A42414330FBADC1AE6777F86EB5
8BE7BF90C971453A34C1FF6FF2A0ACAE
48D0C822ACA6BD0B5FBA8ECD27CBB247
FA5EFC7F0862BE935CF3C0BCCE5C38F1
807CEC0A6E124029C0885B53E1AE9F03
A51128E8CFDD686155CB07E35B410A57
A0D023B78197471C25961C29691BEF85
FD9223BA1689E43F814C545A5FEBA7F4
159002C6F393752AD79B3C2E8C7104C7
610FCF5C8AB235AF2678F174A08FEC53
EFC4A3D8A0C002EF7E5A8B117655DA49
3E8023DB1D342304C2D6BD56705C4687
48FEAB5E27D804CA5A51958469130938
7537C0AA6291AC7B99DC4D2D695EEF1D
CF06C47EAD622F909BFCC83FF4D0ECE8
FB581F2AC74E08CD38CCAAA9A99F0217
B179C315ED033642C37F45179C9E0B13
75C683C1AE98FC6CCE6EA156C9E90A35
78B5D31EFEA7F4689CEB2CF7A9E4C4E5
AD4F00389084ECC4B5362689C228EB0F
F92B2FB00F381010F8895FDFB47A8331
28E44B5D5095EF494073AC47353F64C9
0F6B3E2D4643FA73ECC466DA7BF5662B
4A81FE8E75C780C97EEE73A7574F0B4F
09CAEE95CE99F27D00EA630EEDBCECA2
C74B58C4CD2770A1E97D6DC13D42CCAC
5256B2B115955E80DDB7449775D92325
A8102043D44752FD7A7421E254423956
E2372AFD5CBA85F1395201FB687AEC46
9B27F8491DC5DA23D369F31250BD8D65
88E6D3D4433BA2B424A6D5D23A871B97
051F80A715267A0035D626F7EB86ABBD
FCA08F9B0DCB6E33A74F672CE7F73BE3
669EC0276AC761CB67555E361C534C6A
4BF45CB17DDBF06D87F4002632E0A1BC
FAC23931821B151AD13B4E7B3CA3987B
D7D49CC32C4A23AD56E8DEAE6878EC7B
FFA9AE78B23263835F8AAED57713EBE9
295D9E24D8DE65A010313E667131EF19
0160043392B1572A375E5C3BE1BB0C31
07A6B44E67F46615D8569A26774E5C33
9D14184754E84D38F3D87E8B439DB052
9E47E3D31296D18CA70D6364906977EA
6B7F85DBAABE78A99689D49CAE22072E
4109514A07FD2A10C61DA26ED8F826CA
077BC7302275F4E34731C2780C166C02
FBFD9C7791438F40A3DB0159559920C0
0D6A346C85BF606BE12F9A70FC20A7B7
3FFB1DF94D148994075041E8643DD788
E8755950FCC0CDF1F62E9024153DD624
E4C074EBC3729FB45CFA48D9F6EA4DFD
D35CA7CBB149B94C34D98A2D304D9AE7
22DC6A6AE86C0AA33EBB8C3164A26925
2920B9D90561E521425DE4849FAAD1D7
E9B5EC78F1F4D6F90B5AFB34D09697F2
370CDFEE49990E4A9A1FBC0DC5C31C1C
9FEE80E475ED50AAF174B4F17563C16D
461EEAF2B9223AE1D44C0E8DCE64876C
E09BE20A9F0680A1E1EB51633DF0D0AD
B0A7E817DBB034C475EADF54BBFE04EB
83C946045F057E90A71CACBE15BC6C00
0A0A977572E0A1355CCC54EB04360606
52EF42933AD38302C75702C3D38BFFAE
172B72644467779696BD486F28D198EB
7ED4165854463C38F1D739A2014001D9
50D8D0C89D69EDAE2F04E43E90DB59C1
6DC90DD09DF860E7C60C00BF36906CB3
3D01D6221D54D40DC42C3D6FBCCEC926

2025-02-11 13:05:30 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`, `event_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `user_pseudo_id` IN (
      SELECT DISTINCT `user_pseudo_id`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
        AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
    )
      AND PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
    LIMIT 100
Results:
user_pseudo_id,event_name,event_timestamp,event_date
295D9E24D8DE65A010313E667131EF19,level_fail,1538221068395181,20180929
295D9E24D8DE65A010313E667131EF19,level_complete_quickplay,1538209760197000,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209617142014,20180929
295D9E24D8DE65A010313E667131EF19,level_end_quickplay,1538209749198001,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209750960008,20180929
295D9E24D8DE65A010313E667131EF19,level_fail_quickplay,1538209776654019,20180929
295D9E24D8DE65A010313E667131EF19,level_end_quickplay,1538209762654020,20180929
295D9E24D8DE65A010313E667131EF19,level_retry_quickplay,1538209781902026,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209755941029,20180929
295D9E24D8DE65A010313E667131EF19,level_fail_quickplay,1538209785087041,20180929
295D9E24D8DE65A010313E667131EF19,level_end_quickplay,1538209779087042,20180929
295D9E24D8DE65A010313E667131EF19,level_retry_quickplay,1538209818000048,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209774037051,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209791061071,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209884629077,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209888498083,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209880540086,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209895141002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209922274009,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209839315011,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209953424003,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209938998008,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209967045011,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209919903002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209916854008,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209919124022,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538210048477002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209971475007,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209972524010,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538210050423003,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538210027423008,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538210069460011,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538210101844002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538210074962009,20180929

2025-02-11 13:05:36 - root - INFO - SQL:
SELECT
      EXTRACT(ISOWEEK FROM TIMESTAMP_MICROS(`event_timestamp`)) AS iso_week,
      COUNT(*) AS event_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `user_pseudo_id` IN (
      SELECT DISTINCT `user_pseudo_id`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
        AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
    )
      AND PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
    GROUP BY iso_week
    ORDER BY iso_week
    LIMIT 100
Results:
iso_week,event_count
27,40306
28,25114
29,15628
30,12045
31,9969
32,2780
33,4071
34,1926
35,1010
36,1146
37,1276
38,2064
39,1479
40,367

2025-02-11 13:05:36 - root - INFO - itercount: 0
2025-02-11 13:05:36 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: [table name]}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180801', 'events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table(s)**: `firebase-public-project.analytics_153293282.events_*`  
  The wildcard `*` allows us to query multiple daily tables spanning the required date range.

- **Columns and Potential Usage:**

  - `event_name`:  
    *Potential Usage*: To identify 'session_start' events, which indicate the start of a user session.  
    *Condition*: `event_name = 'session_start'`

  - `user_pseudo_id`:  
    *Potential Usage*: An anonymous unique identifier for each user. Used to track users across events and sessions.

  - `user_first_touch_timestamp`:  
    *Potential Usage*: The timestamp when the user first engaged with the app. Used to identify new users in Week 0.  
    *Condition*: Users whose `user_first_touch_timestamp` falls between July 2, 2018, and July 8, 2018.

  - `event_timestamp`:  
    *Potential Usage*: Timestamp of the event. Useful for filtering events within specific date ranges up to October 2, 2018.

  - `event_date`:  
    *Potential Usage*: String representation of the event date in 'YYYYMMDD' format. Used for date filtering and grouping.

  - `event_params`:  
    *Potential Usage*: An array of key-value pairs with additional event information. Can be unpacked to extract specific parameters if needed.

  - `user_properties`:  
    *Potential Usage*: An array of key-value pairs representing user properties. May contain properties relevant to retention analysis.

**Conditions that May Be Used:**

- Filter events to those occurring up to October 2, 2018:  
  `PARSE_DATE('%Y%m%d', event_date) <= DATE '2018-10-02'`

- Identify new users in Week 0 (July 2 - July 8, 2018):  
  `TIMESTAMP_MICROS(user_first_touch_timestamp) >= TIMESTAMP('2018-07-02')`  
  `TIMESTAMP_MICROS(user_first_touch_timestamp) < TIMESTAMP('2018-07-09')`

- Filter for 'session_start' events:  
  `event_name = 'session_start'`

---

**Sample BigQuery SQL Queries:**

1. **Retrieve distinct event names:**

   ```sql
   SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
   ```

2. **List sample user_pseudo_ids:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
   ```

3. **Get count of events per event_name:**

   ```sql
   SELECT `event_name`, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 100
   ```

4. **Retrieve session_start events with timestamps and user IDs:**

   ```sql
   SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
   LIMIT 100
   ```

5. **Identify users who first used the app in Week 0 (July 2 - July 8, 2018):**

   ```sql
   SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
     AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
   LIMIT 100
   ```

6. **List event dates up to October 2, 2018:**

   ```sql
   SELECT DISTINCT `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
   ORDER BY `event_date`
   LIMIT 100
   ```

7. **Count of events per day up to October 2, 2018:**

   ```sql
   SELECT `event_date`, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
   ```

8. **Extract event_params keys for 'session_start' events:**

   ```sql
   SELECT DISTINCT ep.key
   FROM `firebase-public-project.analytics_153293282.events_*`,
   UNNEST(event_params) AS ep
   WHERE `event_name` = 'session_start'
   LIMIT 100
   ```

9. **Get values of a specific event_param key (e.g., 'ga_session_id'):**

   ```sql
   SELECT ep.key, ep.value.int_value AS session_id
   FROM `firebase-public-project.analytics_153293282.events_*`,
   UNNEST(event_params) AS ep
   WHERE ep.key = 'ga_session_id'
   LIMIT 100
   ```

10. **List user_properties keys:**

    ```sql
    SELECT DISTINCT up.key
    FROM `firebase-public-project.analytics_153293282.events_*`,
    UNNEST(user_properties) AS up
    LIMIT 100
    ```

11. **Count number of users per platform:**

    ```sql
    SELECT `platform`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    GROUP BY `platform`
    LIMIT 100
    ```

12. **Retrieve device information:**

    ```sql
    SELECT device.mobile_brand_name, device.mobile_model_name, device.operating_system
    FROM `firebase-public-project.analytics_153293282.events_*`
    LIMIT 100
    ```

13. **Get users who returned in Week 1 (July 9 - July 15, 2018):**

    ```sql
    SELECT DISTINCT e.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` AS e
    WHERE TIMESTAMP_MICROS(e.`event_timestamp`) >= TIMESTAMP('2018-07-09')
      AND TIMESTAMP_MICROS(e.`event_timestamp`) < TIMESTAMP('2018-07-16')
      AND e.`user_pseudo_id` IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
          AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
      )
    LIMIT 100
    ```

14. **Retrieve events for users from Week 0 up to October 2, 2018:**

    ```sql
    SELECT `user_pseudo_id`, `event_name`, `event_timestamp`, `event_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `user_pseudo_id` IN (
      SELECT DISTINCT `user_pseudo_id`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
        AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
    )
      AND PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
    LIMIT 100
    ```

15. **Count of events per week for Week 0 users:**

    ```sql
    SELECT
      EXTRACT(ISOWEEK FROM TIMESTAMP_MICROS(`event_timestamp`)) AS iso_week,
      COUNT(*) AS event_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `user_pseudo_id` IN (
      SELECT DISTINCT `user_pseudo_id`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
        AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
    )
      AND PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
    GROUP BY iso_week
    ORDER BY iso_week
    LIMIT 100
    ```

**Note:** Each of these queries serves a different purpose to help understand the data relevant to performing the 7-day retention analysis. By exploring the data using these queries, you can gain insights into user behaviors, event distribution, and how to structure the final retention calculation.

---

**Explanation:**

- **Queries 1-3**: Provide an overview of event types and their frequency.
- **Queries 4-5**: Focus on session starts and identifying new users in Week 0.
- **Queries 6-7**: Offer insights into the event dates and volume up to the cutoff date.
- **Queries 8-10**: Explore the structure of nested `event_params` and `user_properties`.
- **Query 11**: Understand user distribution across different platforms.
- **Query 12**: Examine device information of the users.
- **Queries 13-15**: Begin to delve into user retention by identifying users who returned in subsequent weeks.

Using these queries, you can familiarize yourself with the dataset and prepare for performing the retention analysis as per the task requirements.Query:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
Answer:
event_name
ad_reward
session_start
select_content
level_complete_quickplay
os_update
in_app_purchase
level_end_quickplay
app_update
level_reset_quickplay
dynamic_link_app_open
notification_foreground
user_engagement
level_fail_quickplay
completed_5_levels
post_score
level_up
no_more_extra_steps
level_retry
screen_view
level_start_quickplay
level_fail
app_exception
error
use_extra_steps
level_retry_quickplay
app_remove
app_clear_data
dynamic_link_first_open
level_start
level_end
challenge_a_friend
level_complete
level_reset
firebase_campaign
challenge_accepted
spend_virtual_currency
first_open
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
Answer:
user_pseudo_id
72B0A7CF704348BBF6061BC012F84B99
F94E005EB49AFB8DA0A78030D4ABB44B
1A5536C27AB27C3E4588908D345C37F5
B94838D0FE62AC63327CCE2B6B799319
B745605203DEDE5CB888F723828ECF5B
43504D72996A7D69E96BFC94905856BE
1756558602A5C14A5DD2AD4B696D2191
47CEECC477E37BBFF85825843B6FEAB1
6135D8D8F7CE4ED79A903F15A5DFB6AA
4515CFE284B0622651F14BBC2E8EF808
3D4E673690596D1710930116C2D99E8E
667A8D0FDB2FA1BA819DAB6C0F5C7BC4
D7D1BA6ED11F3F862998ED8B8DB94249
88874FDE50373C3FF63C6F7D53A49F72
7DD3C849CB4C42B461AAB36972767FE6
3FC8ECFC8F2976C5B56D0D782F36BD7F
6D24F421B34B2CFDCF3A9983CF63D647
EFB696A82D093B3AFBE92FF526DD5CEA
CF129022E8FA7FFDEB69DDE1570938DA
F976F87FDD7C7B98696A93BC62C57610
7657E94F33F780A1D896FBC9237E5ECC
410456004F702B7F96B3B39BCC44051D
8D36DAECEFE7AE72CB36D9E7A4BE1F5F
30DA335301915FFBD0A384553805EA15
43A83473824B5860784FD7866EA79CE5
A79463D6757978B36380C173D1CA7B2E
D09FF4F523DC97E4F53E6E36E027DE25
825D36CBE9A65B6D3BBFACE4C8C3EE60
D4F52F2C7C2482724A6FCCF02E1AF71D
E98AFA6BD0908A7BDF0FE75396B204DD
184E0C5BE68810D42AF613DF5375530E
3875A92B5F5C2BBA1355CED06A986079
7EDFFF7CB9DB49F6C61708EEBA33A32D
0C055BCFFB1D6F32420A250893009019
3C6A83811DD50E0CFDBD876259FA6D6E
74D4934C305412C92635FC134C437621
C2D17D9066EE1EB9FAE1C8A521BFD4E5
0025BB13501E0221E71E293140C85C01
6D544296013D3F7E5FF708DFE81C3C18
8CFCCD1BCABB1E4C2B70E374EAD03092
CAC4EB6A7DC80207923995F4BE2129DF
B6D597BF7179FCD9CB698FABB4E22817
B5435B0939303B08E468B992DD11CECF
205AE83B43BB3A54E25E55E605AF6431
BBA117EBB63C7CC6E3C9D836C4CE16F7
FB038B1647754ED4E3E7CFEABFC553A4
E2DA3DCB59050A788451A4B3B46D5CFD
F0B84ECACD578E9B52D68AA288A5F2ED
69599C9ED33015D6A6AEE16414074147
62402042F391117D481A9A618E54F84A
9B433955494B47F08BC80C98DA77B460
DBCA64144E263291E94297193210F051
56B9CBB6CB58106DCCF3CAD660232CB2
2285B614DADA95160FF67FD9CBA35778
E80BA7D1EA17162D60C76F8A20B9C45B
B458770ED6E295374FEEB3A68902CC28
90CC0C53AB8C20C6ACD31C2049FF1C03
159002C6F393752AD79B3C2E8C7104C7
E14015A0F7887245A27434A1477B6214
C6D97C0D6DA580A6FDB44BB2C3015A85
091F09F594F7507A1D6D34D006A49CD9
F87F402C12E96886D1E20F34A2632EAC
EF500E0CF578004836D1D38C8901862B
328DC7FE55E8881B2EA668C9A2855BB7
AFF1262CCD472757FC92B2A93C75CD81
F8D02828AA1A4E28F9612CB41DB8BC16
B7603B7B3324056CAF6E576ED8EE284D
0D9DE32D08364277A3406C8107F5763F
E0664E9E7883956A6E3084FD68AA274B
B529E84EE03C578C7E92CE5836AB1C1D
FB49D03591104FB4CEC600157C3A2A0F
CA32F6CB294613C0C6BFCE75C0E684D2
EAA7ACA4BBC7BEC62DDF65BC2A528F48
78CEA7AA04666D7924A253A4AA4C1F4C
45028CA4ED6D9709B55F50CF82E88B3C
7FA1A5B3B4CFDA6EE43060AEE7DDD9B9
2DB65B29C41328FF8AB9AC27B7C05537
B63075B53A750A67A12F7F19ED5AA835
75120F32A68A6C4FB643349E125D8C31
B56E67847E1AE8D6411A5ECCA26585CA
EE502024B7AC261CE1956BB599E020DE
2059AEAA14DF8A5C9B884598E5178572
0CAAA1B6F161BA4D363EB7A2DEF64A08
8252847DECB3C31CAB9BDEE566F97BA2
A0616D4E494DC3BCCB94B8B6E5B48380
5B874F7994400F6943C134F21CA452A7
81F5705397CE9F0236B2B672AE113154
7AA6572327B5C45D273CCD8868760033
74375465CD17299EBC7C75A1B4047EE0
86C65934EDF946EBA8153BF74F0D55CE
59483477E9365F4C9A834CD88B37BA41
06984AB55E6069C42FE61F3510F1522B
9F7B0D1BFB822F5E26E91E184E2E437C
Query:
SELECT `event_name`, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 100
Answer:
event_name,event_count
screen_view,2247623
user_engagement,1358958
level_start_quickplay,523430
level_end_quickplay,349729
post_score,242051
level_complete_quickplay,191088
level_fail_quickplay,137035
level_reset_quickplay,122278
select_content,105139
level_start,74417
session_start,74353
level_end,54582
level_retry,43345
level_up,35666
level_complete,33986
level_retry_quickplay,29939
level_fail,17353
spend_virtual_currency,9363
use_extra_steps,8945
level_reset,8535
firebase_campaign,5411
app_exception,5156
first_open,4322
os_update,3290
no_more_extra_steps,2792
app_remove,2639
app_update,2473
ad_reward,1912
completed_5_levels,1867
error,1714
challenge_a_friend,524
in_app_purchase,27
dynamic_link_app_open,19
app_clear_data,17
dynamic_link_first_open,16
challenge_accepted,5
notification_foreground,1
Query:
SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
   LIMIT 100
Answer:
user_pseudo_id,event_timestamp,event_date
5F7B72E1099BF42C515AC62ADBBB3D7E,1538228903294000,20180929
5F7B72E1099BF42C515AC62ADBBB3D7E,1538288838127000,20180929
D50D60807F5347EB64EF0CD5A3D4C4CD,1538228457559000,20180929
D50D60807F5347EB64EF0CD5A3D4C4CD,1538251568612000,20180929
89E4F685DF983A177EAE221134468F95,1538265962616000,20180929
102CC7D8CD5D3E861EACE1BAB97E61EC,1538230182569000,20180929
A976A39B8E08829A5BC5CD3827C942A2,1538246591894000,20180929
A976A39B8E08829A5BC5CD3827C942A2,1538265771227000,20180929
A976A39B8E08829A5BC5CD3827C942A2,1538276195002000,20180929
B8FE9AD137A133A89389656F7989B36C,1538267476456000,20180929
295D9E24D8DE65A010313E667131EF19,1538209667349000,20180929
295D9E24D8DE65A010313E667131EF19,1538220485921000,20180929
2E650E616327F836FC153592608AED98,1538252110259000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538234052957000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538243913933000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538250969411000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538259038357000,20180929
487DE902636DD8A9844A2D61FE7BD568,1538270949934000,20180929
2F0F260BD7B876C346B41977D0D03D62,1538279742360000,20180929
713C00D8E2137116438668D9A7D90A13,1538233396644000,20180929
A482C98206489AD9E3735688E9F9A978,1538231342297000,20180929
B2D359D114428D8DD085DFAFF11195CE,1538278614140000,20180929
8E2CA56C1FD81A095DECAEDE6F2ED626,1538206909457000,20180929
BE2B55BEAA4A435D8CB9FE792C9CB605,1538266504392000,20180929
7E74A2BB6BBF4746DEE15F957B315401,1538238824495000,20180929
2F2B5C88B72A5253AAF448B1E29333F5,1538232387982000,20180929
946C999569F67A5A013C92E4EFAAAB66,1538231929598000,20180929
5C5A0787542CD24F1E19F9EB778BA766,1538211066365000,20180929
4BF98D09CA8359FC59ADAF56D00338F8,1538258160035000,20180929
4BF98D09CA8359FC59ADAF56D00338F8,1538261500887000,20180929
9DE7361ACCDEA6541AD5EA55D59B1C78,1538238025769000,20180929
906490EA8F6D8BBA578F7CC150DF731D,1538245358989000,20180929
0446949CDEB27AEA0A1151792973D6FB,1538256566603000,20180929
AF29F61BFA8D9AE276EDAE6316EB30AB,1538240900420000,20180929
F3917138A3D4B03ADA1C2E77E3B84649,1538241075581000,20180929
F3917138A3D4B03ADA1C2E77E3B84649,1538243558356000,20180929
3983B79EE1ECAC145E3688021745D894,1538213632156000,20180929
3983B79EE1ECAC145E3688021745D894,1538225377957000,20180929
3983B79EE1ECAC145E3688021745D894,1538229953946000,20180929
3983B79EE1ECAC145E3688021745D894,1538243027879000,20180929
3983B79EE1ECAC145E3688021745D894,1538247182408000,20180929
3983B79EE1ECAC145E3688021745D894,1538273463353000,20180929
3983B79EE1ECAC145E3688021745D894,1538283055245000,20180929
Query:
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
     AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
   LIMIT 100
Answer:
user_pseudo_id,user_first_touch_timestamp
06E0067018E618AA31E60BB0F81B50AE,1530849275359000
71FD091EA0D28740B33A8CE935E9F960,1531051674822000
8BE7BF90C971453A34C1FF6FF2A0ACAE,1531082409656000
AD4F00389084ECC4B5362689C228EB0F,1531080354479000
79D9329B7A6FAC4662CCA563CEA8BDF9,1530650297534000
B7684E7147F9608E1B0F0526FF0315A2,1530602371806000
EAA452C246E3CCD96ACAE0634C16443E,1530649116157000
BA92BB1BDDB2B8C151B517B5C7B2795E,1530621468819000
F9F8CB47B2F3AB134BEE169B4BFFE6CD,1530580053083000
54CA0B1CD95413DE6A18F9096B63FE1F,1530642246761000
B10A33E817460B2DA481ADE27C6397C0,1530673110663000
47055E61DA0D1DF28229E1096D48492A,1530586477187000
08F14F3BCA030F81B447161BA8653B44,1531017304885000
4481436304506E0159F4CC6470B259B4,1530828465042000
97ACFC6B43AACA39819731BF51D0848B,1530770670849000
719D9B4C227C6191B8419D7193CCCBB6,1530806403845000
172B72644467779696BD486F28D198EB,1531032091897000
D8A3FB65349D7DC9D73D39B1E473782F,1531032581115000
D027AFF0661BEA2E7489622F24AD0AC0,1531032439610000
32B7138CEF081FCD4CBAF89F26F58A23,1530793941059000
DDAE59D1F0DCF18D15A1BA723158614C,1530573184490000
2153C36F9ABADBC957F8403899AE4B0B,1530572148244000
23FE2E728CBE5ECDAE567700B4021340,1530565617533000
F7C5554230CF0B6DF75093EDF9DF0CA8,1530902967632000
CB0FC6133C39392B5DE1AA13FCF272C6,1530644054901000
08EF81A14E7B20C40AD1C6778DE79D37,1530996145411000
09CAEE95CE99F27D00EA630EEDBCECA2,1530724846263000
017FFA0093F5423E930694F9D80CF61D,1530650927756000
7B73765AA5218F8FA76E3016DB48744F,1530491359661000
EFC4A3D8A0C002EF7E5A8B117655DA49,1531080841422000
65E1F08C08DE2A775D714901FAB9BA96,1530759995559000
FFA9AE78B23263835F8AAED57713EBE9,1530544624770000
E2CD12EE286D97AF7174B8AB91391200,1530598381079000
48D0C822ACA6BD0B5FBA8ECD27CBB247,1530627114539000
724DEDBFE6C39B53BC4B1E222F9BCF31,1530642227632000
4193343164266373A13B35D5D04053E2,1530661006836000
6FC11768E2D8132D0EBD54B823E26DC4,1530648370621000
1E745A3377797A387552386F37AF323D,1530996770850000
74C5538FA4F9984289F0088723F7B694,1530512282790000
94AAC3126541777AC4894F1A54065EF5,1530858674940000
60A18C651D23E2866F761919F140EFBD,1530563231267000
DFE4C6B9CC592603B2CB9B374B258544,1531091114463000
23698E66074685F88DD298C82FE92943,1530930782908000
9FC8C8D89843323CBE3DCE4961C4EC39,1530731526996000
416393D1443B6F0E64C6FD61CD148C03,1530752198167000
00971FE08D31E17AFA5C02BF8C064F47,1530716067947000
E3D9F7190DC8430B3DEE9D5A123646AF,1530500064626000
C8B04CC9FD3A093D9053010A50077ACE,1530510826265000
722002C7F7994CBFEDB4B8B7221CDA65,1530499952312000
A47B378A0FB79A091239B715515F9003,1530773204828000
Query:
SELECT DISTINCT `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
   ORDER BY `event_date`
   LIMIT 100
Answer:
event_date
20180612
20180613
20180614
20180615
20180616
20180617
20180618
20180619
20180620
20180621
20180622
20180623
20180624
20180625
20180626
20180627
20180628
20180629
20180630
20180701
20180702
20180703
20180704
20180705
20180706
20180707
20180708
20180709
20180710
20180711
20180712
20180713
20180714
20180715
20180716
20180717
20180718
20180719
20180720
20180721
20180722
20180723
20180724
20180725
20180726
20180727
20180728
20180729
20180730
20180731
20180801
20180802
20180803
20180804
20180805
20180806
20180807
20180808
20180809
20180810
20180811
20180812
20180813
20180814
20180815
20180816
20180817
20180818
20180819
20180820
20180821
20180822
20180823
20180824
20180825
20180826
20180827
20180828
20180829
20180830
20180831
20180901
20180902
20180903
20180904
20180905
20180906
20180907
20180908
20180909
20180910
20180911
20180912
20180913
20180914
20180915
20180916
20180917
20180918
20180919
Query:
SELECT `event_date`, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
Answer:
event_date,event_count
20180612,50000
20180613,50000
20180614,50000
20180615,50000
20180616,50000
20180617,50000
20180618,50000
20180619,50000
20180620,50000
20180621,50000
20180622,50000
20180623,50000
20180624,50000
20180625,50000
20180626,50000
20180627,50000
20180628,50000
20180629,50000
20180630,50000
20180701,50000
20180702,50000
20180703,50000
20180704,50000
20180705,50000
20180706,50000
20180707,50000
20180708,50000
20180709,50000
20180710,50000
20180711,50000
20180712,50000
20180713,50000
20180714,50000
20180715,50000
20180716,50000
20180717,50000
20180718,50000
20180719,50000
20180720,50000
20180721,50000
20180722,50000
20180723,50000
20180724,50000
20180725,50000
20180726,50000
20180727,50000
20180728,50000
20180729,50000
20180730,50000
20180731,50000
20180801,50000
20180802,50000
20180803,50000
20180804,50000
20180805,50000
20180806,50000
20180807,50000
20180808,50000
20180809,50000
20180810,50000
20180811,50000
20180812,50000
20180813,50000
20180814,50000
20180815,50000
20180816,50000
20180817,50000
20180818,50000
20180819,50000
20180820,50000
20180821,50000
20180822,50000
20180823,50000
20180824,50000
20180825,50000
20180826,50000
20180827,50000
20180828,50000
20180829,50000
20180830,50000
20180831,50000
20180901,50000
20180902,50000
20180903,50000
20180904,50000
20180905,50000
20180906,50000
20180907,50000
20180908,50000
20180909,50000
20180910,50000
20180911,50000
20180912,50000
20180913,50000
20180914,50000
20180915,50000
20180916,50000
20180917,50000
20180918,50000
20180919,50000
Query:
SELECT DISTINCT ep.key
   FROM `firebase-public-project.analytics_153293282.events_*`,
   UNNEST(event_params) AS ep
   WHERE `event_name` = 'session_start'
   LIMIT 100
Answer:
key
firebase_screen_class
firebase_screen_id
firebase_event_origin
firebase_screen
firebase_conversion
Query:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
LIMIT 100
Answer:
key
firebase_screen_class
level
update_with_analytics
product_id
campaign
firebase_error
dynamic_link_link_id
validated
virtual_currency_name
gclid
error_value
system_app
term
content
firebase_screen_id
timestamp
previous_app_version
quantity
message_name
value
firebase_conversion
type
click_timestamp
product_name
item_id
board
firebase_previous_class
message_id
time
firebase_previous_id
item_name
previous_os_version
firebase_screen
source
medium
dynamic_link_accept_time
ad_event_id
previous_first_open_count
price
fatal
engagement_time_msec
firebase_previous_screen
system_app_update
message_time
content_type
ad_unit_code
currency
message_device_time
firebase_event_origin
level_name
score
dynamic_link_link_name
Query:
SELECT DISTINCT up.key
    FROM `firebase-public-project.analytics_153293282.events_*`,
    UNNEST(user_properties) AS up
    LIMIT 100
Answer:
key
firebase_exp_4
_ltv_USD
_ltv_SEK
_ltv_PKR
ad_frequency
_ltv_CHF
first_open_time
firebase_exp_5
_ltv_JPY
_ltv_MXN
plays_progressive
_ltv_DKK
initial_extra_steps
plays_quickplay
firebase_exp_1
_ltv_TWD
_ltv_AED
_ltv_EUR
num_levels_available
firebase_last_notification
firebase_exp_7
firebase_exp_3
_ltv_AUD
_ltv_GBP
_ltv_RON
Query:
SELECT `platform`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    GROUP BY `platform`
    LIMIT 100
Answer:
platform,user_count
IOS,7765
ANDROID,7410
Query:
SELECT device.mobile_brand_name, device.mobile_model_name, device.operating_system
    FROM `firebase-public-project.analytics_153293282.events_*`
    LIMIT 100
Answer:
mobile_brand_name,mobile_model_name,operating_system
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
not available in demo dataset,not available in demo dataset,ANDROID
Query:
SELECT DISTINCT e.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` AS e
    WHERE TIMESTAMP_MICROS(e.`event_timestamp`) >= TIMESTAMP('2018-07-09')
      AND TIMESTAMP_MICROS(e.`event_timestamp`) < TIMESTAMP('2018-07-16')
      AND e.`user_pseudo_id` IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
          AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
      )
    LIMIT 100
Answer:
user_pseudo_id
08F14F3BCA030F81B447161BA8653B44
DA534A42414330FBADC1AE6777F86EB5
8BE7BF90C971453A34C1FF6FF2A0ACAE
48D0C822ACA6BD0B5FBA8ECD27CBB247
FA5EFC7F0862BE935CF3C0BCCE5C38F1
807CEC0A6E124029C0885B53E1AE9F03
A51128E8CFDD686155CB07E35B410A57
A0D023B78197471C25961C29691BEF85
FD9223BA1689E43F814C545A5FEBA7F4
159002C6F393752AD79B3C2E8C7104C7
610FCF5C8AB235AF2678F174A08FEC53
EFC4A3D8A0C002EF7E5A8B117655DA49
3E8023DB1D342304C2D6BD56705C4687
48FEAB5E27D804CA5A51958469130938
7537C0AA6291AC7B99DC4D2D695EEF1D
CF06C47EAD622F909BFCC83FF4D0ECE8
FB581F2AC74E08CD38CCAAA9A99F0217
B179C315ED033642C37F45179C9E0B13
75C683C1AE98FC6CCE6EA156C9E90A35
78B5D31EFEA7F4689CEB2CF7A9E4C4E5
AD4F00389084ECC4B5362689C228EB0F
F92B2FB00F381010F8895FDFB47A8331
28E44B5D5095EF494073AC47353F64C9
0F6B3E2D4643FA73ECC466DA7BF5662B
4A81FE8E75C780C97EEE73A7574F0B4F
09CAEE95CE99F27D00EA630EEDBCECA2
C74B58C4CD2770A1E97D6DC13D42CCAC
5256B2B115955E80DDB7449775D92325
A8102043D44752FD7A7421E254423956
E2372AFD5CBA85F1395201FB687AEC46
9B27F8491DC5DA23D369F31250BD8D65
88E6D3D4433BA2B424A6D5D23A871B97
051F80A715267A0035D626F7EB86ABBD
FCA08F9B0DCB6E33A74F672CE7F73BE3
669EC0276AC761CB67555E361C534C6A
4BF45CB17DDBF06D87F4002632E0A1BC
FAC23931821B151AD13B4E7B3CA3987B
D7D49CC32C4A23AD56E8DEAE6878EC7B
FFA9AE78B23263835F8AAED57713EBE9
295D9E24D8DE65A010313E667131EF19
0160043392B1572A375E5C3BE1BB0C31
07A6B44E67F46615D8569A26774E5C33
9D14184754E84D38F3D87E8B439DB052
9E47E3D31296D18CA70D6364906977EA
6B7F85DBAABE78A99689D49CAE22072E
4109514A07FD2A10C61DA26ED8F826CA
077BC7302275F4E34731C2780C166C02
FBFD9C7791438F40A3DB0159559920C0
0D6A346C85BF606BE12F9A70FC20A7B7
3FFB1DF94D148994075041E8643DD788
E8755950FCC0CDF1F62E9024153DD624
E4C074EBC3729FB45CFA48D9F6EA4DFD
D35CA7CBB149B94C34D98A2D304D9AE7
22DC6A6AE86C0AA33EBB8C3164A26925
2920B9D90561E521425DE4849FAAD1D7
E9B5EC78F1F4D6F90B5AFB34D09697F2
370CDFEE49990E4A9A1FBC0DC5C31C1C
9FEE80E475ED50AAF174B4F17563C16D
461EEAF2B9223AE1D44C0E8DCE64876C
E09BE20A9F0680A1E1EB51633DF0D0AD
B0A7E817DBB034C475EADF54BBFE04EB
83C946045F057E90A71CACBE15BC6C00
0A0A977572E0A1355CCC54EB04360606
52EF42933AD38302C75702C3D38BFFAE
172B72644467779696BD486F28D198EB
7ED4165854463C38F1D739A2014001D9
50D8D0C89D69EDAE2F04E43E90DB59C1
6DC90DD09DF860E7C60C00BF36906CB3
3D01D6221D54D40DC42C3D6FBCCEC926
Query:
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`, `event_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `user_pseudo_id` IN (
      SELECT DISTINCT `user_pseudo_id`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
        AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
    )
      AND PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
    LIMIT 100
Answer:
user_pseudo_id,event_name,event_timestamp,event_date
295D9E24D8DE65A010313E667131EF19,level_fail,1538221068395181,20180929
295D9E24D8DE65A010313E667131EF19,level_complete_quickplay,1538209760197000,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209617142014,20180929
295D9E24D8DE65A010313E667131EF19,level_end_quickplay,1538209749198001,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209750960008,20180929
295D9E24D8DE65A010313E667131EF19,level_fail_quickplay,1538209776654019,20180929
295D9E24D8DE65A010313E667131EF19,level_end_quickplay,1538209762654020,20180929
295D9E24D8DE65A010313E667131EF19,level_retry_quickplay,1538209781902026,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209755941029,20180929
295D9E24D8DE65A010313E667131EF19,level_fail_quickplay,1538209785087041,20180929
295D9E24D8DE65A010313E667131EF19,level_end_quickplay,1538209779087042,20180929
295D9E24D8DE65A010313E667131EF19,level_retry_quickplay,1538209818000048,20180929
295D9E24D8DE65A010313E667131EF19,level_start_quickplay,1538209774037051,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209791061071,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209884629077,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209888498083,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209880540086,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209895141002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209922274009,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209839315011,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209953424003,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209938998008,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209967045011,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538209919903002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209916854008,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209919124022,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538210048477002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538209971475007,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538209972524010,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538210050423003,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538210027423008,20180929
295D9E24D8DE65A010313E667131EF19,level_start,1538210069460011,20180929
295D9E24D8DE65A010313E667131EF19,level_end,1538210101844002,20180929
295D9E24D8DE65A010313E667131EF19,level_retry,1538210074962009,20180929
Query:
SELECT
      EXTRACT(ISOWEEK FROM TIMESTAMP_MICROS(`event_timestamp`)) AS iso_week,
      COUNT(*) AS event_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `user_pseudo_id` IN (
      SELECT DISTINCT `user_pseudo_id`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-02')
        AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) < TIMESTAMP('2018-07-09')
    )
      AND PARSE_DATE('%Y%m%d', `event_date`) <= DATE '2018-10-02'
    GROUP BY iso_week
    ORDER BY iso_week
    LIMIT 100
Answer:
iso_week,event_count
27,40306
28,25114
29,15628
30,12045
31,9969
32,2780
33,4071
34,1926
35,1010
36,1146
37,1276
38,2064
39,1479
40,367
End Exploring Related Columns
Task: Please perform a 7-day retention analysis for users who first session start the app during the week starting on July 2, 2018. For each week from Week 0 (the week of their first session) to Week 4, provide the total number of new users in Week 0 and the number of retained users for each subsequent week. Ensuring that you only count events up to October 2, 2018, and group dates by Monday-based weeks

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Week,Number_of_users
Week 0,total_new_users:int
Week 1,retained_users_week1:int
Week 2,retained_users_week2:int
Week 3,retained_users_week3:int
Week 4,retained_users_week4:int
```

This table presents the 7-day retention analysis for users who started their first session during the week beginning on July 2, 2018 (Week 0). The **Number_of_users** column represents:

- **Week 0**: The total number of new users who initiated their first session in Week 0.
- **Weeks 1 to 4**: The number of these users who returned to the app in each subsequent week.

The analysis only includes events up to October 2, 2018, and all dates are grouped into Monday-based weeks..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180801', 'events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 13:07:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 13:07:25 - root - INFO - ```sql
WITH new_users AS (
  SELECT DISTINCT user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) >= DATE '2018-07-02'
    AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) < DATE '2018-07-09'
),

user_events AS (
  SELECT DISTINCT user_pseudo_id,
    FLOOR(DATE_DIFF(
      DATE(TIMESTAMP_MICROS(event_timestamp)),
      DATE '2018-07-02',
      WEEK(MONDAY)
    )) AS Week_num
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    user_pseudo_id IN (SELECT user_pseudo_id FROM new_users)
    AND DATE(TIMESTAMP_MICROS(event_timestamp)) >= DATE '2018-07-02'
    AND DATE(TIMESTAMP_MICROS(event_timestamp)) <= DATE '2018-10-02'
)

SELECT Week, Number_of_users
FROM (
  SELECT 'Week 0' AS Week, COUNT(DISTINCT user_pseudo_id) AS Number_of_users, 0 AS Week_num
  FROM new_users
  UNION ALL
  SELECT
    CONCAT('Week ', CAST(Week_num AS STRING)) AS Week,
    COUNT(DISTINCT user_pseudo_id) AS Number_of_users,
    Week_num
  FROM user_events
  WHERE Week_num BETWEEN 1 AND 4
  GROUP BY Week_num
)
ORDER BY Week_num;
```
2025-02-11 13:07:31 - root - INFO - itercount: 1
2025-02-11 13:07:31 - root - INFO - 0
2025-02-11 13:07:31 - root - INFO - results: 
Week,Number_of_users
Week 0,297
Week 1,69
Week 2,41
Week 3,39
Week 4,19


2025-02-11 13:07:31 - root - INFO - Please check the answer again by reviewing Please perform a 7-day retention analysis for users who first session start the app during the week starting on July 2, 2018. For each week from Week 0 (the week of their first session) to Week 4, provide the total number of new users in Week 0 and the number of retained users for each subsequent week. Ensuring that you only count events up to October 2, 2018, and group dates by Monday-based weeks, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Week,Number_of_users
Week 0,total_new_users:int
Week 1,retained_users_week1:int
Week 2,retained_users_week2:int
Week 3,retained_users_week3:int
Week 4,retained_users_week4:int
```

This table presents the 7-day retention analysis for users who started their first session during the week beginning on July 2, 2018 (Week 0). The **Number_of_users** column represents:

- **Week 0**: The total number of new users who initiated their first session in Week 0.
- **Weeks 1 to 4**: The number of these users who returned to the app in each subsequent week.

The analysis only includes events up to October 2, 2018, and all dates are grouped into Monday-based weeks. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Number_of_users
Week 0,297
Week 1,69
Week 2,41
Week 3,39
Week 4,19
Current sql:
WITH new_users AS (
  SELECT DISTINCT user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) >= DATE '2018-07-02'
    AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) < DATE '2018-07-09'
),

user_events AS (
  SELECT DISTINCT user_pseudo_id,
    FLOOR(DATE_DIFF(
      DATE(TIMESTAMP_MICROS(event_timestamp)),
      DATE '2018-07-02',
      WEEK(MONDAY)
    )) AS Week_num
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    user_pseudo_id IN (SELECT user_pseudo_id FROM new_users)
    AND DATE(TIMESTAMP_MICROS(event_timestamp)) >= DATE '2018-07-02'
    AND DATE(TIMESTAMP_MICROS(event_timestamp)) <= DATE '2018-10-02'
)

SELECT Week, Number_of_users
FROM (
  SELECT 'Week 0' AS Week, COUNT(DISTINCT user_pseudo_id) AS Number_of_users, 0 AS Week_num
  FROM new_users
  UNION ALL
  SELECT
    CONCAT('Week ', CAST(Week_num AS STRING)) AS Week,
    COUNT(DISTINCT user_pseudo_id) AS Number_of_users,
    Week_num
  FROM user_events
  WHERE Week_num BETWEEN 1 AND 4
  GROUP BY Week_num
)
ORDER BY Week_num;
2025-02-11 13:08:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 13:08:05 - root - INFO - ```sql
WITH new_users AS (
  SELECT DISTINCT user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) >= DATE '2018-07-02'
    AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) < DATE '2018-07-09'
),

user_events AS (
  SELECT DISTINCT user_pseudo_id,
    FLOOR(DATE_DIFF(
      DATE(TIMESTAMP_MICROS(event_timestamp)),
      DATE '2018-07-02',
      WEEK(MONDAY)
    )) AS Week_num
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    user_pseudo_id IN (SELECT user_pseudo_id FROM new_users)
    AND DATE(TIMESTAMP_MICROS(event_timestamp)) >= DATE '2018-07-02'
    AND DATE(TIMESTAMP_MICROS(event_timestamp)) <= DATE '2018-10-02'
)

SELECT Week, Number_of_users
FROM (
  SELECT 'Week 0' AS Week, COUNT(DISTINCT user_pseudo_id) AS Number_of_users, 0 AS Week_num
  FROM new_users
  UNION ALL
  SELECT
    CONCAT('Week ', CAST(Week_num AS STRING)) AS Week,
    COUNT(DISTINCT user_pseudo_id) AS Number_of_users,
    Week_num
  FROM user_events
  WHERE Week_num BETWEEN 1 AND 4
  GROUP BY Week_num
)
ORDER BY Week_num;
```
2025-02-11 13:08:10 - root - INFO - itercount: 2
2025-02-11 13:08:10 - root - INFO - 0
2025-02-11 13:08:10 - root - INFO - Total iteration counts: 2
