2025-01-27 01:30:31 - openai._base_client - INFO - Retrying request to /chat/completions in 0.493547 seconds
2025-01-27 01:31:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:31:27 - root - INFO - SQL:
SELECT DISTINCT period
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   LIMIT 100;
Results:
period
Joseon dynasty (1392–1910)
Qing dynasty (1644–1911)
Yuan dynasty (1271–1368)
Southern Song dynasty (1127–1279)
Ming dynasty (1368–1644)
Yuan dynasty (1271–1368) (?)
Northern Song dynasty (960–1127)
Ming (1368–1644) or Qing (1644–1911) dynasty
Ming (1368–1644) or Qing dynasty (1644–1911)
Tang dynasty (618–907)
Song dynasty (960–1279)
"late Qing dynasty (1644–1911, early Republic period"
Yuan (1271–1368)
Jin dynasty (1115–1234)
Ming Dinasty (1368–1644)
Yuan dynasty  (1271–1368)
late Ming dynasty (1368–1644)
late Yuan dynasty (1271–1368)
Ming (1368–1644)–Qing (1644–1911) dynasty
Yuan (1271–1368) or Ming (1368–1644) dynasty
"Qing dynasty (1644–1911), Qianlong period (1736–95)"
late Ming (1368–1644)–early Qing (1644–1911) dynasty
late Yuan (1271–1368)–early Ming (1368–1644) dynasty
Ming dynasty (?) (1368–1644)
"Qing dynasty (1644–1911), Kangxi period (1662–1722)"
Ming dynasty (1368–1644) (?)
Qing dynasty (?) (1644–1911)
Song (960–1279) or Qing (1644–1911) dynasty (?)
late Ming (1368–1644)– early Qing (1644–1911) dynasty
20th century
Song dynasty (?) (960–1279)
Yuan dynasty (?) (1271–1368)
late Qing dynasty (1644–1911)
early Ming dynasty (1368–1644)
Song dynasty (960–1279) or later
Ming dynasty (1368–1644) or later
Ming dynasty (1368–1644) or earlier
Song (960–1279)–Ming (1368–1644) dynasty
probably mid- to late Ming dynasty (1368–1644)
Song (960–1279) or Yuan (1271–1368) dynasty (?)
Northern Song (960–1127) or Jin (1115–1234) dynasty
Five Dynasties (907–960)–early Song (906–1279) dynasty
Edo period (1615–1868)
Meiji period (1868–1912)
Muromachi period (1392–1573)
Momoyama period (1573–1615)
Ming dynasty (1368-1644)
Kamakura period (1185–1333)
Edo (1615–1868)–Meiji period (1868–1912)
Heian period (794–1185)
Taishō period (1912–26)
Nanbokuchō period (1336–92)
late Edo (1615–1868)–early Meiji (1868–1912) period
Momoyama (1573–1615)
Muromachi (1392–1573)
late Heian period (794–1185)
late Heian period (ca. 900–1185)
Momoyama (1573–1615)–Edo (1615–1868) period
Edo (1615–1868)
Meiji period (1868-1912)
Shōwa period (1926–89)
Meiji  period (1868–1912)
Edo period (1615–1868) 1845.
Edo period (1615–1868) Kihei.
Edo period (1615–1868Meiji period (1868–1912)
Momoyama (1573–1615)– Edo (1615–1868) period
late Edo (1615–1868) or Meiji (1868–1912) period
Edo period (1615–1868) or Meiji period (1868–1912)
Edo period (1615–1868) Osaka. 1837. Publishers: Eirakuya Tōshirō
Meiji (1868–1912)–Taishō (1912–26) period
Meiji (1868–1912) or Taishō (1912–26) period
Meiji (1868–1912)–Taishō  (1912–26) period
Late Edo (1615–1868) or Meiji (1868–1912) period
late Edo period (1615–1868)–early Meiji period (1868–1912) ?
late Edo period (1615–1868)
Meiji period (1866–1912)
Nanbokuchō (1336–92)–Muromachi (1392–1573) period
Edo period (1615–1868
Meiji period (1869–1912)
Edo (1615–1868) or Meiji period (1868–1912)
Imperial
Ming Dynasty
New Kingdom
"New Kingdom, Ramesside"
Second Intermediate Period–Early New Kingdom
Modern
Twentieth Century; original New Kingdom
20th century; original New Kingdom
Twentieth Century; original Early New Kingdom
Late Period
Middle Kingdom
early Republic period (late 19th–early 20th century)
Shang (ca. 1600–1046 B.C.)–Western Zhou (1046–771 B.C.) dynasty
Qing dynasty (1644–1911
Pala period
early Malla period
Goryeo dynasty (918–1392)
Early Rajput-Chaurapanchasika style
Early Rajput -Chaurapanchasika style
Hoysala period

2025-01-27 01:31:28 - root - INFO - SQL:
SELECT object_id, period
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   LIMIT 100;
Results:
object_id,period
646996,Joseon dynasty (1392–1910)
40445,Joseon dynasty (1392–1910)
45063,Joseon dynasty (1392–1910)
40069,Joseon dynasty (1392–1910)
40070,Joseon dynasty (1392–1910)
54912,Joseon dynasty (1392–1910)
40429,Joseon dynasty (1392–1910)
40432,Joseon dynasty (1392–1910)
73188,Joseon dynasty (1392–1910)
36145,Qing dynasty (1644–1911)
36130,Qing dynasty (1644–1911)
36435,Qing dynasty (1644–1911)
36036,Qing dynasty (1644–1911)
36072,Qing dynasty (1644–1911)
49133,Qing dynasty (1644–1911)
65620,Qing dynasty (1644–1911)
40021,Qing dynasty (1644–1911)
49453,Qing dynasty (1644–1911)
49134,Qing dynasty (1644–1911)
65075,Qing dynasty (1644–1911)
41468,Yuan dynasty (1271–1368)
40507,Yuan dynasty (1271–1368)
40052,Southern Song dynasty (1127–1279)
35995,Ming dynasty (1368–1644)
35999,Ming dynasty (1368–1644)
36003,Ming dynasty (1368–1644)
45786,Ming dynasty (1368–1644)
73669,Qing dynasty (1644–1911)
49179,Qing dynasty (1644–1911)
49226,Qing dynasty (1644–1911)
51727,Yuan dynasty (1271–1368) (?)
51705,Northern Song dynasty (960–1127)
51528,Ming (1368–1644) or Qing (1644–1911) dynasty
51656,Ming (1368–1644) or Qing dynasty (1644–1911)
51644,Ming (1368–1644) or Qing dynasty (1644–1911)
36129,Qing dynasty (1644–1911)
36439,Tang dynasty (618–907)
40285,Song dynasty (960–1279)
40107,Song dynasty (960–1279)
40180,Song dynasty (960–1279)
40194,Song dynasty (960–1279)
40060,Song dynasty (960–1279)
40058,Song dynasty (960–1279)
45684,Ming dynasty (1368–1644)
45746,Ming dynasty (1368–1644)
39766,Ming dynasty (1368–1644)
45749,Ming dynasty (1368–1644)
44574,Ming dynasty (1368–1644)
45775,Ming dynasty (1368–1644)
45780,Ming dynasty (1368–1644)
51865,Ming dynasty (1368–1644)
77914,Ming dynasty (1368–1644)
48875,Ming dynasty (1368–1644)
48955,Ming dynasty (1368–1644)
48954,Ming dynasty (1368–1644)
49025,Ming dynasty (1368–1644)
49029,Ming dynasty (1368–1644)
56553,Ming dynasty (1368–1644)
41780,Ming dynasty (1368–1644)
39625,Ming dynasty (1368–1644)
48931,Ming dynasty (1368–1644)
48928,Ming dynasty (1368–1644)
48959,Qing dynasty (1644–1911)
49129,Qing dynasty (1644–1911)
49146,Qing dynasty (1644–1911)
49147,Qing dynasty (1644–1911)
49163,Qing dynasty (1644–1911)
51894,Qing dynasty (1644–1911)
36132,Qing dynasty (1644–1911)
51900,Qing dynasty (1644–1911)
75814,Qing dynasty (1644–1911)
54308,Qing dynasty (1644–1911)
55495,Qing dynasty (1644–1911)
49473,Qing dynasty (1644–1911)
35987,Qing dynasty (1644–1911)
44570,Qing dynasty (1644–1911)
40105,Yuan dynasty (1271–1368)
40509,Yuan dynasty (1271–1368)
42329,Yuan dynasty (1271–1368)
39918,Northern Song dynasty (960–1127)
39919,Northern Song dynasty (960–1127)
40103,Southern Song dynasty (1127–1279)
40104,Southern Song dynasty (1127–1279)
41777,"late Qing dynasty (1644–1911, early Republic period"

2025-01-27 01:31:30 - root - INFO - SQL:
SELECT period, COUNT(*) AS artwork_count
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   GROUP BY period
   ORDER BY artwork_count DESC
   LIMIT 100;
Results:
period,artwork_count
Edo period (1615–1868),8060
Qing dynasty (1644–1911),3029
New Kingdom,3028
Middle Kingdom,2823
Archaic,1511
Classical,1160
"Qing dynasty (1644–1911), Qianlong period (1736–95)",945
Sasanian,906
Early Imperial,892
Hellenistic,846
Ming dynasty (1368–1644),845
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",786
Meiji period (1868–1912),702
"New Kingdom, Ramesside",668
Third Intermediate Period,635
"New Kingdom, Amarna Period",576
Han dynasty (206 B.C.–A.D. 220),564
Imperial,546
Iron Age II,494
Late Period–Ptolemaic Period,484
Neo-Assyrian,456
Late Classical,438
Late Imperial,431
"Late Period, Saite",384
Late Period,372
Tang dynasty (618–907),371
Central Javanese period,332
Edo (1615–1868),314
Mid Imperial,305
Neo-Babylonian,303
Roman Period,303
Old Kingdom,294
Ptolemaic Period,260
Iron Age III,260
Middle Kingdom–Early New Kingdom,255
Predynastic Period,254
Iron Age,245
Song dynasty (960–1279),239
Bronze Age,231
Yuan dynasty (1271–1368),219
Geometric,217
Bronze and Iron Age period,213
Goryeo dynasty (918–1392),205
Early Bronze Age,196
Late Bronze Age,178
Second Intermediate Period–Early New Kingdom,175
Cypro-Archaic II,170
Middle Bronze Age–Old Assyrian Trading Colony,167
Achaemenid,161
Parthian,160
Muromachi period (1392–1573),158
Early Dynastic Period,157
Joseon dynasty (1392–1910),155
Eastern Javanese period,139
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",136
"Early Imperial, Julio-Claudian",133
Old Babylonian,130
Early Minoan III,129
Ptolemaic or Roman Period,123
Ptolemaic Period–Roman Period,117
Final Jōmon period (ca. 1000–300 B.C.),117
Neolithic,113
Pala period,113
Early Hellenistic,112
Edo (1615–1868) or Meiji period (1868–1912),112
Old Kingdom–First Intermediate Period,112
Late Archaic,108
Momoyama period (1573–1615),107
Chalcolithic,105
Pre-Columbian,105
Middle Kingdom–Second Intermediate Period,104
Late Hellenistic,104
Early to Mid Imperial,98
Late Middle Kingdom–Second Intermediate Period,97
Classical or Hellenistic,97
Late period,95
Second Intermediate Period,90
"Qing dynasty (1644–1911), Kangxi mark and period (1662–1722)",88
Old Syrian,86
Kamakura period (1185–1333),84
Late Classical or Hellenistic,84
Shang dynasty (ca. 1600–1046 B.C.),84
Late Republican or Imperial,84
Sasanian–early Islamic,83
Chalcolithic–Early Bronze Age,82
Middle Bronze Age,80
Early Minoan II,80

2025-01-27 01:31:32 - root - INFO - SQL:
SELECT object_id, label.description
   FROM `bigquery-public-data.the_met.vision_api_data`,
   UNNEST(labelAnnotations) AS label
   LIMIT 100;
Results:
object_id,description
327565,product
696600,horn
213991,fashion accessory
504181,product
317279,material
565419,rock
689784,lighting
324455,product
314210,material
23420,weapon
196399,trophy
206354,product
75140,label
244393,product
29415,hand
25282,brass
322795,material
7526,automotive exterior
40355,box
559100,lighting
323405,material
545608,horn
465560,weapon
463732,sculpture
321787,art
249603,blue
560453,pattern
33401,brown
242696,fashion accessory
323595,drawing
326466,jewellery
60074,product
423535,sketch
40268,material
34932,dishware
550029,material
467247,material
450064,hand
58648,tapestry
326774,ice
62409,silver
447208,art
474443,wood
325782,organ
41787,technology
450081,fashion accessory
252096,organ
53076,weapon
570790,material
694403,horn
695312,material
244241,product
198082,lighting
700973,passive circuit component
210040,product
501743,product
228380,label
324355,material
645352,picture frame
326819,silver
323429,drawing
213810,weapon
465374,material
251327,wood
32778,gun barrel
548860,material
545332,wood
648483,sketch
466492,leaf
23777,lighting
60234,fashion accessory
546398,stele
317174,material
203686,lighting
324247,weapon
468795,iron
545597,horn
62215,product
323327,drawing
501097,material
23070,weapon
479238,wood
58289,weapon
549409,material
250595,product
326769,branch
326467,circle
57934,weapon
557131,jewellery
408009,sketch
326661,wheel
561808,wood
456195,material
249668,hand
560403,silver
464101,material
51326,horn
479351,horn
307593,shape
317154,material

2025-01-27 01:31:34 - root - INFO - SQL:
SELECT o.object_id, o.period, label.description
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   LIMIT 100;
Results:
object_id,period,description
62455,,spark plug
229720,,bottle
325108,,metal
249982,Classical,bottle
471714,,material
505157,,lighting
287951,,sketch
218789,,textile
189588,,brass
694343,,horn
468842,,brass
204067,,brand
2100,,monochrome photography
187267,,man made object
321506,,fashion accessory
326403,Bronze Age,rock
322000,Neo-Babylonian,material
3657,,product
253220,"Neolithic, second period",wood
257246,Early Imperial,fashion accessory
466532,,clothing
190652,,dishware
41826,"late Qing dynasty (1644–1911, early Republic period",iron
565416,Middle Kingdom,drawing
241827,,material
38049,,drawing
246351,,brass
546400,Late Middle Kingdom–Second Intermediate Period,material
60235,Meiji period (1868–1912),fashion accessory
244063,,ceramic
358944,,wood
551766,New Kingdom,wood
468875,,product
58816,Edo period (1615–1868),art
25286,,brass
252205,,shape
323981,Iron Age III,arm
324790,Neo-Assyrian,drawing
687730,,tool
504833,,weapon
213905,,grass family
65680,Qing dynasty (1644–1911),christmas decoration
588371,Late Period–Ptolemaic Period,material
228544,,pattern
193991,,picture frame
326211,Iron Age II,material
25654,,tool
224881,,textile
548094,"Late Period, Saite",material
321947,Achaemenid,drawing
560391,Middle Kingdom,pattern
74890,Pala period,brown
244259,,tool
717467,,text
325856,Middle Bronze Age–Old Assyrian Trading Colony,wood
472111,,fashion accessory
190740,,locket
565384,Middle Kingdom,hand
196690,,dishware
246454,,product
324734,,tooth
60611,,tool
308782,,metal
221081,,font
43289,,organ
465997,,invertebrate
309268,,tool
59423,Edo (1615–1868) or Meiji period (1868–1912),brass
559147,New Kingdom,jewellery
689831,Late Ptolemaic or Roman Period,tool
552333,Roman Period,product
502233,,horn

2025-01-27 01:31:35 - root - INFO - SQL:
SELECT o.period, label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period IS NOT NULL
   GROUP BY o.period, label.description
   ORDER BY label_count DESC
   LIMIT 100;
Results:
period,description,label_count
Edo period (1615–1868),art,5314
Edo period (1615–1868),sketch,3124
Edo period (1615–1868),drawing,2351
Edo period (1615–1868),pattern,2026
Edo period (1615–1868),painting,1755
Edo period (1615–1868),illustration,1664
Qing dynasty (1644–1911),art,1606
New Kingdom,fashion accessory,1010
Edo period (1615–1868),cartoon,971
Edo period (1615–1868),poster,959
New Kingdom,jewellery,951
Middle Kingdom,art,945
Edo period (1615–1868),textile,898
Qing dynasty (1644–1911),pattern,870
Archaic,art,867
Edo period (1615–1868),modern art,797
Qing dynasty (1644–1911),black and white,783
Middle Kingdom,material,750
Edo period (1615–1868),woman,735
Edo period (1615–1868),black and white,735
New Kingdom,art,734
Edo period (1615–1868),tapestry,714
New Kingdom,turquoise,708
Edo period (1615–1868),flooring,702
Qing dynasty (1644–1911),drawing,637
Edo period (1615–1868),ceramic,631
Classical,art,589
Edo period (1615–1868),design,575
Middle Kingdom,sculpture,563
Middle Kingdom,rock,554
Qing dynasty (1644–1911),sketch,537
Meiji period (1868–1912),art,533
Third Intermediate Period,art,513
Ming dynasty (1368–1644),art,509
Middle Kingdom,wood,508
Qing dynasty (1644–1911),ceramic,507
Archaic,sculpture,488
Archaic,ceramic,486
Middle Kingdom,drawing,478
Third Intermediate Period,sculpture,476
Edo period (1615–1868),wood,471
Edo period (1615–1868),blue and white porcelain,469
Middle Kingdom,fashion accessory,466
Qing dynasty (1644–1911),vase,455
Edo period (1615–1868),mural,446
"Qing dynasty (1644–1911), Qianlong period (1736–95)",art,442
Hellenistic,art,433
Third Intermediate Period,statue,426
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",art,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",vase,424
New Kingdom,wood,420
Classical,ceramic,417
Edo period (1615–1868),vase,407
Edo period (1615–1868),costume design,398
Edo period (1615–1868),ancient history,392
Classical,vase,388
Edo period (1615–1868),person,381
Qing dynasty (1644–1911),blue and white porcelain,369
Qing dynasty (1644–1911),textile,368
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",blue and white porcelain,366
Edo period (1615–1868),material,361
Early Imperial,fashion accessory,360

2025-01-27 01:31:37 - root - INFO - SQL:
SELECT o.period, label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period IS NOT NULL
   GROUP BY o.period, label.description
   HAVING COUNT(*) >= 50
   LIMIT 100;
Results:
period,description,label_count
New Kingdom,wood,420
Meiji period (1868–1912),pattern,98
Middle Kingdom,brass,53
Middle Kingdom,material,750
Edo period (1615–1868),product,122
Archaic,horn,58
"Late Period, Saite",material,130
Neo-Babylonian,silver,60
Middle Kingdom,drawing,478
Edo period (1615–1868),glass,70
Early Bronze Age,material,60
Middle Kingdom,rock,554
Classical,wood,104
Middle Kingdom,lighting,99
New Kingdom,rock,184
Middle Kingdom,wood,508
"New Kingdom, Ramesside",fashion accessory,140
New Kingdom,material,327
Sasanian,shape,88
Sasanian,silver,192
Iron Age II,material,101
Archaic,lighting,142
Han dynasty (206 B.C.–A.D. 220),shape,177
Edo period (1615–1868),art,5314
Early Minoan III,material,58
Late Middle Kingdom–Second Intermediate Period,stele,58
Edo period (1615–1868),box,92
"New Kingdom, Amarna Period",material,277
New Kingdom,horn,116
Imperial,brass,89
Iron Age III,fashion accessory,53
New Kingdom,product,130
Neo-Babylonian,stone carving,90
Sasanian,drawing,205
Neo-Assyrian,material,79
Late Period–Ptolemaic Period,material,50
Middle Kingdom,horn,84
Ptolemaic Period–Roman Period,art,64
Late Period,jewellery,58
Early Minoan III,shape,57
Sasanian,art,275
Middle Kingdom,art,945
New Kingdom,fashion accessory,1010
Qing dynasty (1644–1911),drawing,637
Bronze and Iron Age period,brass,64
Neo-Babylonian,art,94
Neo-Assyrian,silver,51
Edo period (1615–1868),ceramic,631
"New Kingdom, Amarna Period",stone carving,193
Meiji period (1868–1912),art,533
Neo-Babylonian,material,108
Edo period (1615–1868),fashion accessory,258
Edo period (1615–1868),vehicle,69
Iron Age II,jewellery,103
Archaic,brass,105
Classical,man made object,215
Middle Kingdom,pattern,289
New Kingdom,man made object,104
Iron Age II,fashion accessory,124
"New Kingdom, Amarna Period",mineral,101
Early Imperial,fashion accessory,360
Early Imperial,shape,133
New Kingdom,pattern,113
Late Middle Kingdom–Second Intermediate Period,rock,52
Late Middle Kingdom–Second Intermediate Period,material,72

2025-01-27 01:31:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:31:49 - root - INFO - ```sql
SELECT o.period, label.description, COUNT(*) AS label_count
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY o.period, label.description
ORDER BY label_count DESC
LIMIT 100;
```
2025-01-27 01:33:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:33:15 - root - INFO - SQL:
SELECT o.period, label.description, COUNT(*) AS label_count
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY o.period, label.description
ORDER BY label_count DESC
LIMIT 100;
Results:
period,description,label_count
Edo period (1615–1868),art,5314
Edo period (1615–1868),sketch,3124
Edo period (1615–1868),drawing,2351
Edo period (1615–1868),pattern,2026
Edo period (1615–1868),painting,1755
Edo period (1615–1868),illustration,1664
Qing dynasty (1644–1911),art,1606
New Kingdom,fashion accessory,1010
Edo period (1615–1868),cartoon,971
Edo period (1615–1868),poster,959
New Kingdom,jewellery,951
Middle Kingdom,art,945
Edo period (1615–1868),textile,898
Qing dynasty (1644–1911),pattern,870
Archaic,art,867
Edo period (1615–1868),modern art,797
Qing dynasty (1644–1911),black and white,783
Middle Kingdom,material,750
Edo period (1615–1868),black and white,735
Edo period (1615–1868),woman,735
New Kingdom,art,734
Edo period (1615–1868),tapestry,714
New Kingdom,turquoise,708
Edo period (1615–1868),flooring,702
Qing dynasty (1644–1911),drawing,637
Edo period (1615–1868),ceramic,631
Classical,art,589
Edo period (1615–1868),design,575
Middle Kingdom,sculpture,563
Middle Kingdom,rock,554
Qing dynasty (1644–1911),sketch,537
Meiji period (1868–1912),art,533
Third Intermediate Period,art,513
Ming dynasty (1368–1644),art,509
Middle Kingdom,wood,508
Qing dynasty (1644–1911),ceramic,507
Archaic,sculpture,488
Archaic,ceramic,486
Middle Kingdom,drawing,478
Third Intermediate Period,sculpture,476
Edo period (1615–1868),wood,471
Edo period (1615–1868),blue and white porcelain,469
Middle Kingdom,fashion accessory,466
Qing dynasty (1644–1911),vase,455
Edo period (1615–1868),mural,446
"Qing dynasty (1644–1911), Qianlong period (1736–95)",art,442
Hellenistic,art,433
Third Intermediate Period,statue,426
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",vase,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",art,424
New Kingdom,wood,420
Classical,ceramic,417
Edo period (1615–1868),vase,407
Edo period (1615–1868),costume design,398
Edo period (1615–1868),ancient history,392
Classical,vase,388
Edo period (1615–1868),person,381
Qing dynasty (1644–1911),blue and white porcelain,369
Qing dynasty (1644–1911),textile,368
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",blue and white porcelain,366
Edo period (1615–1868),material,361
Early Imperial,fashion accessory,360

2025-01-27 01:33:17 - root - INFO - SQL:
SELECT label.description, label.score
FROM `bigquery-public-data.the_met.vision_api_data`,
UNNEST(labelAnnotations) AS label
LIMIT 100
Results:
description,score
spark plug,0.6382611393928528
bottle,0.5313543677330017
metal,0.5386295318603516
bottle,0.5041088461875916
material,0.5339352488517761
lighting,0.6573033332824707
sketch,0.564201295375824
textile,0.5862242579460144
brass,0.6346170902252197
horn,0.7221972346305847
brass,0.6329494714736938
brand,0.596916675567627
monochrome photography,0.5306386351585388
man made object,0.9216219186782837
fashion accessory,0.6620733737945557
rock,0.6995851993560791
material,0.5378533005714417
product,0.7340088486671448
wood,0.5981280207633972
fashion accessory,0.6377023458480835
clothing,0.9017379283905029
dishware,0.5471827983856201
iron,0.7568996548652649
drawing,0.5147865414619446
material,0.5267785787582397
drawing,0.5567029118537903
brass,0.5438459515571594
material,0.5404350757598877
fashion accessory,0.626270592212677
ceramic,0.5019612908363342
wood,0.6085013747215271
wood,0.5975653529167175
product,0.735457718372345
art,0.7379064559936523
brass,0.6450731158256531
shape,0.5883374810218811
arm,0.6705746650695801
drawing,0.5139475464820862
tool,0.6272326707839966
weapon,0.5195496678352356
grass family,0.5479329228401184
christmas decoration,0.649424135684967
material,0.5585384368896484
pattern,0.5095349550247192
picture frame,0.8941380977630615
material,0.5218632221221924
tool,0.5688906908035278
textile,0.5325451493263245
material,0.5242740511894226
drawing,0.5175843238830566
pattern,0.6123761534690857
brown,0.816507875919342
tool,0.5622634291648865
text,0.9326171875
wood,0.6097862124443054
fashion accessory,0.6297428011894226
locket,0.7189846634864807
hand,0.5557277202606201
dishware,0.5472484230995178
product,0.7371984720230103
tooth,0.5240021347999573
tool,0.5035712122917175
metal,0.5160228610038757
font,0.7580641508102417
organ,0.6603940725326538
invertebrate,0.5211217999458313
tool,0.514660120010376
brass,0.5901290774345398
jewellery,0.5728819370269775
tool,0.5738584995269775
product,0.7606844305992126
horn,0.6470463275909424
material,0.5489948987960815
product,0.7809261679649353
horn,0.5658637285232544
product,0.7648868560791016
weapon,0.5041947960853577
silver,0.6460575461387634
plastic wrap,0.5153576731681824
pattern,0.5203388333320618
chain,0.5661110877990723
drawing,0.538819432258606
material,0.553455114364624
text,0.9381742477416992
mustang horse,0.7440498471260071
hand,0.5536729693412781
jewellery,0.6383907198905945
sculpture,0.5433937311172485
material,0.5457663536071777
horn,0.5247842073440552
material,0.5179493427276611

2025-01-27 01:33:18 - root - INFO - SQL:
SELECT label.description, COUNT(*) AS artwork_count
FROM `bigquery-public-data.the_met.vision_api_data`,
UNNEST(labelAnnotations) AS label
GROUP BY label.description
ORDER BY artwork_count DESC
LIMIT 100
Results:
description,artwork_count
art,84720
sketch,51375
drawing,48182
pattern,30846
painting,26915
fashion accessory,21343
black and white,20366
sculpture,20266
ancient history,18208
illustration,16346
ceramic,15838
textile,15551
wood,15179
jewellery,14163
relief,14040
material,13941
picture frame,12690
vase,11181
clothing,10133
design,9398
statue,9352
modern art,9343
stone carving,9095
lighting,8891
flooring,8598
figure drawing,8324
silver,7745
product,7625
carving,7497
brass,7483
porcelain,7334
shape,7251
tapestry,6934
poster,6240
cartoon,6196
furniture,6084
blue and white porcelain,6072
metal,6047
monochrome photography,6028
tableware,4947
currency,4886
money,4807
circle,4683
photograph,4614
image,4414
text,4200
dishware,4140
monochrome,3899
man made object,3876
white,3785
portrait,3781
bowl,3768
bronze,3707
monument,3698
wall,3668
saucer,3663
pottery,3652
black,3564
tablecloth,3399
head,3381
rock,3149
horn,3121
green,3060
organ,3011
glass,2983
cup,2975
font,2882
drinkware,2833
plate,2822
classical sculpture,2781
dress,2739
coin,2704
hand,2703
blue,2557
weapon,2511
iron,2436
brown,2350
gemstone,2290
figurine,2267
bronze sculpture,2219
rectangle,2184
floor,2126
still life photography,2056
locket,2021
structure,2016
mug,1965
platter,1943
lace,1943
table,1908
sleeve,1903
bottle,1826
gown,1757
leaf,1726
pendant,1725
teapot,1683
footwear,1654
outerwear,1650
award,1633
interior design,1616
calligraphy,1606

2025-01-27 01:33:20 - root - INFO - SQL:
SELECT *
FROM (
  SELECT
    o.period,
    label.description AS label_description,
    COUNT(*) AS label_count,
    ROW_NUMBER() OVER (PARTITION BY o.period ORDER BY COUNT(*) DESC) AS row_num
  FROM `bigquery-public-data.the_met.objects` AS o
  INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
    ON o.object_id = v.object_id
  CROSS JOIN UNNEST(v.labelAnnotations) AS label
  WHERE o.period IS NOT NULL
  GROUP BY o.period, label.description
)
WHERE row_num <= 3
  AND label_count >= 50
LIMIT 100
Results:
period,label_description,label_count,row_num
Bronze and Iron Age period,art,83,1
Bronze and Iron Age period,brass,64,2
Edo period (1615–1868),art,5314,1
Edo period (1615–1868),sketch,3124,2
Edo period (1615–1868),drawing,2351,3
Late Period,art,192,1
Late Period,sculpture,177,2
Late Period,statue,123,3
Middle Kingdom,art,945,1
Middle Kingdom,material,750,2
Middle Kingdom,sculpture,563,3
Qing dynasty (1644–1911),art,1606,1
Qing dynasty (1644–1911),pattern,870,2
Qing dynasty (1644–1911),black and white,783,3
Yuan dynasty (1271–1368),art,124,1
Yuan dynasty (1271–1368),sketch,62,2
Yuan dynasty (1271–1368),ceramic,57,3
Period of Tibetan Empire,fashion accessory,65,1
Period of Tibetan Empire,jewellery,63,2
Iron Age,art,108,1
Iron Age,sculpture,96,2
Song dynasty (960–1279),art,138,1
Song dynasty (960–1279),ceramic,88,2
Song dynasty (960–1279),bowl,63,3
Hellenistic,art,433,1
Hellenistic,sculpture,317,2
Hellenistic,ceramic,218,3
Middle Bronze Age–Old Assyrian Trading Colony,art,62,1
Momoyama period (1573–1615),art,58,1
Classical,art,589,1
Classical,ceramic,417,2
Classical,vase,388,3
Joseon dynasty (1392–1910),art,92,1
Early Minoan II,wood,53,1
Middle Kingdom–Second Intermediate Period,fashion accessory,57,1
Ptolemaic Period,art,133,1
Ptolemaic Period,sculpture,124,2
Ptolemaic Period,statue,70,3
"New Kingdom, Ramesside",art,191,1
"New Kingdom, Ramesside",fashion accessory,140,2
"New Kingdom, Ramesside",wood,128,3
Classical or Hellenistic,fashion accessory,84,1
Classical or Hellenistic,jewellery,84,2
Middle Kingdom–Early New Kingdom,fashion accessory,139,1
Middle Kingdom–Early New Kingdom,jewellery,126,2
Middle Kingdom–Early New Kingdom,art,64,3
Late Imperial,ceramic,227,1
Late Imperial,art,225,2
Late Imperial,vase,199,3
New Kingdom,fashion accessory,1010,1
New Kingdom,jewellery,951,2

2025-01-27 01:33:22 - root - INFO - SQL:
SELECT period, COUNT(*) AS total_artworks
FROM `bigquery-public-data.the_met.objects`
WHERE period IS NOT NULL
GROUP BY period
ORDER BY total_artworks DESC
LIMIT 100
Results:
period,total_artworks
Edo period (1615–1868),8060
Qing dynasty (1644–1911),3029
New Kingdom,3028
Middle Kingdom,2823
Archaic,1511
Classical,1160
"Qing dynasty (1644–1911), Qianlong period (1736–95)",945
Sasanian,906
Early Imperial,892
Hellenistic,846
Ming dynasty (1368–1644),845
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",786
Meiji period (1868–1912),702
"New Kingdom, Ramesside",668
Third Intermediate Period,635
"New Kingdom, Amarna Period",576
Han dynasty (206 B.C.–A.D. 220),564
Imperial,546
Iron Age II,494
Late Period–Ptolemaic Period,484
Neo-Assyrian,456
Late Classical,438
Late Imperial,431
"Late Period, Saite",384
Late Period,372
Tang dynasty (618–907),371
Central Javanese period,332
Edo (1615–1868),314
Mid Imperial,305
Neo-Babylonian,303
Roman Period,303
Old Kingdom,294
Ptolemaic Period,260
Iron Age III,260
Middle Kingdom–Early New Kingdom,255
Predynastic Period,254
Iron Age,245
Song dynasty (960–1279),239
Bronze Age,231
Yuan dynasty (1271–1368),219
Geometric,217
Bronze and Iron Age period,213
Goryeo dynasty (918–1392),205
Early Bronze Age,196
Late Bronze Age,178
Second Intermediate Period–Early New Kingdom,175
Cypro-Archaic II,170
Middle Bronze Age–Old Assyrian Trading Colony,167
Achaemenid,161
Parthian,160
Muromachi period (1392–1573),158
Early Dynastic Period,157
Joseon dynasty (1392–1910),155
Eastern Javanese period,139
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",136
"Early Imperial, Julio-Claudian",133
Old Babylonian,130
Early Minoan III,129
Ptolemaic or Roman Period,123
Ptolemaic Period–Roman Period,117
Final Jōmon period (ca. 1000–300 B.C.),117
Neolithic,113
Pala period,113
Early Hellenistic,112
Edo (1615–1868) or Meiji period (1868–1912),112
Old Kingdom–First Intermediate Period,112
Late Archaic,108
Momoyama period (1573–1615),107
Chalcolithic,105
Pre-Columbian,105
Middle Kingdom–Second Intermediate Period,104
Late Hellenistic,104
Early to Mid Imperial,98
Late Middle Kingdom–Second Intermediate Period,97
Classical or Hellenistic,97
Late period,95
Second Intermediate Period,90
"Qing dynasty (1644–1911), Kangxi mark and period (1662–1722)",88
Old Syrian,86
Kamakura period (1185–1333),84
Late Classical or Hellenistic,84
Shang dynasty (ca. 1600–1046 B.C.),84
Late Republican or Imperial,84
Sasanian–early Islamic,83
Chalcolithic–Early Bronze Age,82
Middle Bronze Age,80

2025-01-27 01:33:23 - root - INFO - SQL:
SELECT v.object_id, label.description
FROM `bigquery-public-data.the_met.vision_api_data` AS v
CROSS JOIN UNNEST(v.labelAnnotations) AS label
LIMIT 100
Results:
object_id,description
251746,wing
417179,ancient history
3061,lighting
575413,wood
213609,grass family
252143,shape
228470,pattern
503199,tap
60333,pattern
560881,brass
546828,product
644915,picture frame
323425,nut
556604,fashion accessory
210045,cosmetics
213909,fashion accessory
562723,material
251295,wood
61352,horn
53437,product
414551,poster
225001,grass family
546323,money
69702,christmas decoration
251698,horn
29707,brass
467324,shape
501509,automotive engine part
249027,green
642488,window
23587,wing
214078,fashion accessory
317269,eye
192688,weapon
457110,money
6954,tool
548118,material
40319,box
552600,art
504525,weapon
322252,silver
547351,fashion accessory
214042,hair accessory
244282,material
444839,product
468813,chain
214987,blue
463506,shape
546310,tool
315650,weapon
552317,food
242697,fashion accessory
53018,circle
309424,jewellery
8768,chain
412010,sketch
555095,hand
326399,snow
249033,weapon
560411,drawing
246364,brass
250381,carving
317630,rectangle
470893,wood
323099,product
213822,grass family
58695,glass
315806,tool
62206,chain
325262,material
28236,brass
250634,horn
247045,line
549234,lighting
26609,hand
565415,rock
26867,brass
29925,label
250601,line
323987,material
244210,wood
309954,metal
193134,relief
362430,advertising
546717,electrical wiring
241839,jewellery
35046,brass
567652,furniture
686538,jewellery
326598,pendant
645254,poster
315662,green
249791,hand
7568,fashion accessory
58552,suitcase
546497,food
268393,place of worship
559517,lighting
195333,weapon
477763,fashion accessory

2025-01-27 01:33:25 - root - INFO - SQL:
SELECT o.period, COUNT(DISTINCT label.description) AS unique_labels
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
  ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY o.period
ORDER BY unique_labels DESC
LIMIT 100
Results:
period,unique_labels
Edo period (1615–1868),519
New Kingdom,427
Qing dynasty (1644–1911),407
Middle Kingdom,401
Archaic,268
"New Kingdom, Ramesside",266
Ming dynasty (1368–1644),259
Meiji period (1868–1912),257
Classical,246
"Qing dynasty (1644–1911), Qianlong period (1736–95)",244
Sasanian,227
Hellenistic,221
Early Imperial,216
Roman Period,190
Neo-Assyrian,190
Late Period,189
Imperial,188
Iron Age II,188
Tang dynasty (618–907),176
Late Classical,173
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",168
"New Kingdom, Amarna Period",165
Third Intermediate Period,161
Ptolemaic Period,157
Han dynasty (206 B.C.–A.D. 220),157
Late Imperial,154
Iron Age III,151
Iron Age,151
Early Bronze Age,149
Old Kingdom,145
Late Period–Ptolemaic Period,140
Song dynasty (960–1279),139
Middle Kingdom–Early New Kingdom,137
Neo-Babylonian,129
Second Intermediate Period–Early New Kingdom,129
Predynastic Period,129
Ptolemaic or Roman Period,127
Geometric,127
Late Bronze Age,126
Yuan dynasty (1271–1368),126
"Late Period, Saite",124
Parthian,122
Bronze Age,121
Goryeo dynasty (918–1392),120
Early Dynastic Period,119
Muromachi period (1392–1573),117
Achaemenid,114
"Early Imperial, Julio-Claudian",113
Momoyama period (1573–1615),111
Joseon dynasty (1392–1910),111
Middle Bronze Age–Old Assyrian Trading Colony,110
Second Intermediate Period,108
Bronze and Iron Age period,107
Mid Imperial,97
Central Javanese period,96
Eastern Javanese period,94
Chalcolithic,93
Late Classical or Hellenistic,92
Late Archaic,91
Sasanian–early Islamic,91
Middle Kingdom–Second Intermediate Period,90
Kamakura period (1185–1333),85
Ptolemaic Period–Roman Period,85
Late Hellenistic,84
Neolithic,84
Shang dynasty (ca. 1600–1046 B.C.),80
Eastern Han dynasty (25–220),79
"Early Imperial, Augustan",78
Middle Bronze Age,78
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",77
Heian period (794–1185),77
Edo (1615–1868),76
Western Han dynasty (206 B.C.–A.D. 9),75
Early Dynastic IIIa,75
Kofun period (ca. 300–710),74
Edo (1615–1868) or Meiji period (1868–1912),74
Southern Song dynasty (1127–1279),74
Chalcolithic–Early Bronze Age,73
Pala period,73
"Eastern Zhou dynasty, Warring States period (475–221 B.C.)",73
Final Jōmon period (ca. 1000–300 B.C.),72
Northern Song dynasty (960–1127),69
Pre-Columbian,68
Western Zhou dynasty (1046–771 B.C.),67
Old Babylonian,67
Jin dynasty (1115–1234),66
Early Hellenistic,65

2025-01-27 01:33:27 - root - INFO - SQL:
SELECT o.object_id, o.period
FROM `bigquery-public-data.the_met.objects` AS o
LEFT JOIN `bigquery-public-data.the_met.vision_api_data` AS v
  ON o.object_id = v.object_id
WHERE v.object_id IS NULL
LIMIT 100
Results:
object_id,period
48968,Ming dynasty (1368–1644)
52009,Edo period (1615–1868)
56235,Edo period (1615–1868)
734140,
384014,
670272,
670275,
670274,
190636,
45663,Ming dynasty (1368–1644)
307433,
207150,
344292,
41691,"Qing dynasty (1644–1911), Yongzheng period (1723–35)"
61663,Han dynasty (206 B.C.–A.D. 220)
42137,Qing dynasty (1644–1911)
717704,
25600,
734136,
35717,
248691,Hellenistic
243783,
248040,Early Imperial
501131,
187742,
187743,
218045,
212357,
571887,Third Intermediate Period or later
571894,Third Intermediate Period or later
568299,"New Kingdom, Ramesside"
568300,"New Kingdom, Ramesside"
568301,"New Kingdom, Ramesside"
574433,Middle Kingdom
545501,Middle Kingdom
544192,Middle Kingdom
545381,Middle Kingdom
545384,Middle Kingdom
565784,Middle Kingdom
556748,Middle Kingdom
454567,
471194,
471860,
470828,
442861,
444979,
564801,Middle Kingdom
564802,Middle Kingdom
545727,Middle Kingdom
645469,
645471,
645481,
645482,
645485,
645486,
645487,
645488,
645489,
645497,
645498,
645500,
645501,
645502,
645505,

2025-01-27 01:33:28 - root - INFO - SQL:
SELECT label.description, COUNT(DISTINCT o.period) AS period_count
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
  ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY label.description
ORDER BY period_count DESC
LIMIT 100
Results:
description,period_count
art,1044
sculpture,717
ceramic,614
vase,490
wood,467
statue,455
material,448
fashion accessory,437
stone carving,423
black and white,416
jewellery,386
carving,344
drawing,309
metal,305
shape,301
brass,301
lighting,299
pottery,297
silver,283
monument,281
product,272
ancient history,267
sketch,266
head,260
man made object,235
bowl,234
bronze,231
organ,230
pattern,222
classical sculpture,221
porcelain,217
horn,214
blue and white porcelain,212
circle,212
relief,211
hand,196
bronze sculpture,195
monochrome photography,189
money,188
furniture,187
currency,182
rock,181
clothing,173
tableware,168
dishware,168
black,163
monochrome,157
green,155
textile,151
white,134
structure,133
gemstone,132
leaf,132
weapon,131
food,131
produce,129
iron,129
rectangle,128
drinkware,128
still life photography,126
font,126
stele,123
coin,120
figurine,119
cup,119
mineral,116
painting,113
design,112
wheel,111
teapot,111
bead,111
footwear,109
blue,109
bottle,103
wing,103
jug,102
table,100
wall,99
arm,93
human positions,92
saucer,92
modern art,87
sink,87
chain,87
text,86
bracelet,86
earrings,85
ring,80
picture frame,79
leather,79
brown,78
flooring,78
pendant,78
locket,78
column,78
cobalt blue,77
human body,77
yellow,77
glass bottle,75
necklace,75

2025-01-27 01:33:30 - root - INFO - SQL:
SELECT o.period, AVG(label_counts.num_labels) AS avg_labels_per_artwork
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN (
  SELECT object_id, COUNT(*) AS num_labels
  FROM `bigquery-public-data.the_met.vision_api_data`,
  UNNEST(labelAnnotations) AS label
  GROUP BY object_id
) AS label_counts
  ON o.object_id = label_counts.object_id
WHERE o.period IS NOT NULL
GROUP BY o.period
ORDER BY avg_labels_per_artwork DESC
LIMIT 100
Results:
period,avg_labels_per_artwork
"Ming dynasty (1368–1644), Zhengde period (1506–21)",5.0
Cypro-Classical II–Early Hellenistic,5.0
Kushan or Islamic,5.0
Late Naqada III or early Dynasty 1,5.0
late Zhou (1046–256 B.C.)–early Han (206 B.C.–A.D. 220) dynasty,5.0
late Momoyama (1573–1615)–early Edo (1615–1868) period,5.0
Ly (1009–1225)–Tran (1225–1400) dynasty,5.0
Middle Minoan IIIA-B,5.0
late Tang (618–907)–early Song (960–1279) dynasty,5.0
"Mid Imperial, Severan",5.0
Late Cypro-Archaic II,5.0
Nanbokuchō (1336–92)–early Muromachi period (1392–1573),5.0
"Predynastic, Late Naqada III–Early Dynastic Period",5.0
"Republic period (1912–49), Hongxian mark and period (1915–16)",5.0
Tang dynasty (618–907) (?),5.0
late Goryeo dynasty (918–1392)–early Joseon dynasty (1392–1910),5.0
Late Cypro-Classical I–Early Cypro-Classical I,5.0
Unified Silla dynasty (676–935),5.0
"Ming dynasty (1368–1644), Wanli mark and period (1573–1620)",5.0
Post-Akkadian,5.0
"Qing dynasty (1644–1911), Kangxi period (1622–1722)",5.0
Early Roman (?),5.0
Late Corinthian,5.0
Northern Wei dynasty (386–534),5.0
Late Cypriot II or III,5.0
late Edo period (1615–1868),5.0
late Northern Song dynasty (960–1127),5.0
Middle Cypriot III,5.0
Anuradhapura period,5.0
"Qing dynasty (1644–1911), Kangxi period (1662–1722",5.0
Ming dynasty (1368–1644) (?),5.0
"Qing dynasty (1644–1911), Xianfeng mark and period (1851–61)",5.0
Late Dynastic or Hellenistic,5.0
Neolithic period,5.0
Villanovian/Orientalizing,5.0
Mauryan period,5.0
New Kingdom to 3rd Intermediate Period,5.0
Ubaid–Early Uruk,5.0
Yayoi period (ca. 300 B.C.–ca. A.D. 300),5.0
"Predynastic, Naqada III–Early Dynastic Period",5.0
Song dynasty (960–1279) or later,5.0
late Ming dynasty ? (1368-1644),5.0
Song (960–1279)–Yuan (1271–1368) dynasty,5.0
Cypro-Classical II,5.0
"New Kingdom, early",5.0
"Cypro-Classical, probably",5.0
"Ming dynasty (1368–1644), late Wanli period (1573–1620)",5.0
Southern Song (1127–1279) to Yuan (1271–1368) dynasty,5.0
Early Dynastic Period–Old Kingdom,5.0
Jin (1115–1234)–Yuan (1271–1368) dynasty,5.0
probably late Ming dynasty (1368–1644),5.0
early Ming dynasty (1368–1644),5.0
Northern Dynasties (386–581),5.0
Modern (?),5.0
Momoyama period (1573–1615) or Edo period (1615–1868),5.0
Old Elamite (?),5.0
Cypro-Archaic II (?),5.0
Mid  to Late Imperial,5.0
Neo-Babylonian–Achaemenid,5.0
Late Villanovian,5.0
"Qing dynasty (1644–1911), Tongzhi period (1862–74)",5.0
Macedonian–Ptolemaic Period,5.0
Middle Bronze Age II,5.0
Late Imperial or Early Byzantine,5.0

2025-01-27 01:33:30 - root - INFO - itercount: 0
2025-01-27 01:33:30 - root - INFO - Database Name: bigquery-public-data
Schema Name: the_met
DDL describes table information.
,0
table_name,images
ddl,"CREATE TABLE `bigquery-public-data.the_met.images`
(
  object_id INT64,
  public_caption STRING,
  title STRING,
  original_image_url STRING,
  caption STRING,
  is_oasc BOOL,
  gcs_url STRING
);"

,1
table_name,objects
ddl,"CREATE TABLE `bigquery-public-data.the_met.objects`
(
  object_number STRING,
  is_highlight BOOL,
  is_public_domain BOOL,
  object_id INT64,
  department STRING,
  object_name STRING,
  title STRING,
  culture STRING,
  period STRING,
  dynasty STRING,
  reign STRING,
  portfolio STRING,
  artist_role STRING,
  artist_prefix STRING,
  artist_display_name STRING,
  artist_display_bio STRING,
  artist_suffix STRING,
  artist_alpha_sort STRING,
  artist_nationality STRING,
  artist_begin_date STRING,
  artist_end_date STRING,
  object_date STRING,
  object_begin_date INT64,
  object_end_date INT64,
  medium STRING,
  dimensions STRING,
  credit_line STRING,
  geography_type STRING,
  city STRING,
  state STRING,
  county STRING,
  country STRING,
  region STRING,
  subregion STRING,
  locale STRING,
  locus STRING,
  excavation STRING,
  river STRING,
  classification STRING,
  rights_and_reproduction STRING,
  link_resource STRING,
  metadata_date TIMESTAMP,
  repository STRING
);"

,2
table_name,vision_api_data
ddl,"CREATE TABLE `bigquery-public-data.the_met.vision_api_data`
(
  object_id INT64,
  faceAnnotations ARRAY<STRUCT<headwearLikelihood STRING, underExposedLikelihood STRING, surpriseLikelihood STRING, boundingPoly STRUCT<vertices ARRAY<STRUCT<y INT64, x INT64>>>, fdBoundingPoly STRUCT<vertices ARRAY<STRUCT<y INT64, x INT64>>>, rollAngle FLOAT64, sorrowLikelihood STRING, panAngle FLOAT64, blurredLikelihood STRING, landmarks ARRAY<STRUCT<position STRUCT<z FLOAT64, y FLOAT64, x FLOAT64>, type STRING>>, detectionConfidence FLOAT64, angerLikelihood STRING, landmarkingConfidence FLOAT64, tiltAngle FLOAT64, joyLikelihood STRING>>,
  landmarkAnnotations ARRAY<STRUCT<properties ARRAY<STRING>, locations ARRAY<STRUCT<latLng STRUCT<longitude FLOAT64, latitude FLOAT64>>>, boundingPoly STRUCT<vertices ARRAY<STRUCT<y INT64, x INT64>>>, topicality INT64, confidence INT64, score FLOAT64, description STRING, locale STRING, mid STRING>>,
  cropHintsAnnotation STRUCT<cropHints ARRAY<STRUCT<importanceFraction FLOAT64, confidence FLOAT64, boundingPoly STRUCT<vertices ARRAY<STRUCT<y INT64, x INT64>>>>>>,
  logoAnnotations ARRAY<STRING>,
  labelAnnotations ARRAY<STRUCT<properties ARRAY<STRING>, locations ARRAY<STRING>, boundingPoly STRING, topicality INT64, confidence INT64, score FLOAT64, description STRING, locale STRING, mid STRING>>,
  textAnnotations ARRAY<STRING>,
  fullTextAnnotation STRING,
  imagePropertiesAnnotation STRUCT<dominantColors STRUCT<colors ARRAY<STRUCT<pixelFraction FLOAT64, score FLOAT64, color STRUCT<alpha STRING, blue INT64, green INT64, red INT64>>>>>,
  safeSearchAnnotation STRING,
  webDetection STRUCT<partialMatchingImages ARRAY<STRUCT<score INT64, url STRING>>, pagesWithMatchingImages ARRAY<STRUCT<score INT64, url STRING>>, fullMatchingImages ARRAY<STRUCT<score INT64, url STRING>>, webEntities ARRAY<STRUCT<description STRING, score FLOAT64, entityId STRING>>>
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'the_met': ['images', 'objects', 'vision_api_data']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

To answer the task, we need to consider the following tables and columns:

1. **Table:** `bigquery-public-data.the_met.objects`
   - **Columns:**
     - `object_id`: Used to join with `vision_api_data` to associate artworks.
     - `period`: The historical period of each artwork. Used to group artworks by period.

2. **Table:** `bigquery-public-data.the_met.vision_api_data`
   - **Columns:**
     - `object_id`: Used to join with `objects` to associate artworks.
     - `labelAnnotations`: An array of labels (nested JSON) associated with each artwork. Each element includes:
       - `description`: The label description (e.g., "Bronze", "Painting").
       - Other fields like `score`, `topicality`, etc.

**Potential Usage of Columns:**
- **`object_id`**: Primary key to join both tables.
- **`period`**: Used to group and filter artworks by their historical period.
- **`labelAnnotations.description`**: Used to identify and count labels associated with artworks.

**Conditions That May Be Used:**
- **Joining Conditions**: Joining `objects` and `vision_api_data` on `object_id`.
- **Filtering Conditions**: Only include labels linked to 50 or more artworks.
- **Grouping Conditions**: Grouping by `period` and `labelAnnotations.description` to count occurrences.
- **Ordering Conditions**: Ordering counts in descending order to find the top labels.

---

**Sample BigQuery SQL Queries:**

1. **List Distinct Historical Periods:**

   ```sql
   SELECT DISTINCT period
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   LIMIT 100;
   ```

2. **Preview Object IDs with Their Periods:**

   ```sql
   SELECT object_id, period
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   LIMIT 100;
   ```

3. **Count of Artworks per Period:**

   ```sql
   SELECT period, COUNT(*) AS artwork_count
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   GROUP BY period
   ORDER BY artwork_count DESC
   LIMIT 100;
   ```

4. **Extract Labels from `labelAnnotations`:**

   ```sql
   SELECT object_id, label.description
   FROM `bigquery-public-data.the_met.vision_api_data`,
   UNNEST(labelAnnotations) AS label
   LIMIT 100;
   ```

5. **Join Artworks with Labels:**

   ```sql
   SELECT o.object_id, o.period, label.description
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   LIMIT 100;
   ```

6. **Count Label Occurrences Per Period:**

   ```sql
   SELECT o.period, label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period IS NOT NULL
   GROUP BY o.period, label.description
   ORDER BY label_count DESC
   LIMIT 100;
   ```

7. **Filter Labels Linked to 50 or More Artworks:**

   ```sql
   SELECT o.period, label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period IS NOT NULL
   GROUP BY o.period, label.description
   HAVING COUNT(*) >= 50
   LIMIT 100;
   ```

8. **Get Top Labels for a Specific Period:**

   ```sql
   SELECT label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period = 'Renaissance'
   GROUP BY label.description
   HAVING COUNT(*) >= 50
   ORDER BY label_count DESC
   LIMIT 3;
   ```

9. **List All Labels with Their Descriptions and Scores:**

   ```sql
   SELECT label.description, label.score
   FROM `bigquery-public-data.the_met.vision_api_data`,
   UNNEST(labelAnnotations) AS label
   LIMIT 100;
   ```

10. **Count of Artworks for Each Label Across All Periods:**

    ```sql
    SELECT label.description, COUNT(*) AS artwork_count
    FROM `bigquery-public-data.the_met.vision_api_data`,
    UNNEST(labelAnnotations) AS label
    GROUP BY label.description
    ORDER BY artwork_count DESC
    LIMIT 100;
    ```

11. **Top Three Labels per Period (Without CTEs):**

    ```sql
    SELECT *
    FROM (
      SELECT
        o.period,
        label.description AS label_description,
        COUNT(*) AS label_count,
        ROW_NUMBER() OVER (PARTITION BY o.period ORDER BY COUNT(*) DESC) AS row_num
      FROM `bigquery-public-data.the_met.objects` AS o
      INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
      ON o.object_id = v.object_id
      CROSS JOIN UNNEST(v.labelAnnotations) AS label
      WHERE o.period IS NOT NULL
      GROUP BY o.period, label.description
      HAVING COUNT(*) >= 50
    )
    WHERE row_num <= 3
    LIMIT 100;
    ```

12. **Total Artworks per Period:**

    ```sql
    SELECT period, COUNT(*) AS total_artworks
    FROM `bigquery-public-data.the_met.objects`
    WHERE period IS NOT NULL
    GROUP BY period
    ORDER BY total_artworks DESC
    LIMIT 100;
    ```

13. **Labels Associated with a Specific Artwork:**

    ```sql
    SELECT v.object_id, label.description
    FROM `bigquery-public-data.the_met.vision_api_data` AS v
    CROSS JOIN UNNEST(v.labelAnnotations) AS label
    WHERE v.object_id = 123456  -- Replace with actual object_id
    LIMIT 100;
    ```

14. **Periods with the Most Diverse Labels:**

    ```sql
    SELECT o.period, COUNT(DISTINCT label.description) AS unique_labels
    FROM `bigquery-public-data.the_met.objects` AS o
    INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
    ON o.object_id = v.object_id
    CROSS JOIN UNNEST(v.labelAnnotations) AS label
    WHERE o.period IS NOT NULL
    GROUP BY o.period
    ORDER BY unique_labels DESC
    LIMIT 100;
    ```

15. **Artworks Lacking Labels:**

    ```sql
    SELECT o.object_id, o.period
    FROM `bigquery-public-data.the_met.objects` AS o
    LEFT JOIN `bigquery-public-data.the_met.vision_api_data` AS v
    ON o.object_id = v.object_id
    WHERE v.object_id IS NULL
    LIMIT 100;
    ```

16. **Labels Associated with Multiple Periods:**

    ```sql
    SELECT label.description, COUNT(DISTINCT o.period) AS period_count
    FROM `bigquery-public-data.the_met.objects` AS o
    INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
    ON o.object_id = v.object_id
    CROSS JOIN UNNEST(v.labelAnnotations) AS label
    WHERE o.period IS NOT NULL
    GROUP BY label.description
    ORDER BY period_count DESC
    LIMIT 100;
    ```

17. **Average Label Count per Artwork per Period:**

    ```sql
    SELECT o.period, AVG(label_counts.num_labels) AS avg_labels_per_artwork
    FROM `bigquery-public-data.the_met.objects` AS o
    INNER JOIN (
      SELECT object_id, COUNT(*) AS num_labels
      FROM `bigquery-public-data.the_met.vision_api_data`,
      UNNEST(labelAnnotations) AS label
      GROUP BY object_id
    ) AS label_counts
    ON o.object_id = label_counts.object_id
    WHERE o.period IS NOT NULL
    GROUP BY o.period
    ORDER BY avg_labels_per_artwork DESC
    LIMIT 100;
    ```

---

These queries progressively explore the data, helping to understand the relationships between artworks, their periods, and associated labels. By examining the outputs of these queries, we can gain insights needed to answer the original task.Query:
SELECT DISTINCT period
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   LIMIT 100;
Answer:
period
Joseon dynasty (1392–1910)
Qing dynasty (1644–1911)
Yuan dynasty (1271–1368)
Southern Song dynasty (1127–1279)
Ming dynasty (1368–1644)
Yuan dynasty (1271–1368) (?)
Northern Song dynasty (960–1127)
Ming (1368–1644) or Qing (1644–1911) dynasty
Ming (1368–1644) or Qing dynasty (1644–1911)
Tang dynasty (618–907)
Song dynasty (960–1279)
"late Qing dynasty (1644–1911, early Republic period"
Yuan (1271–1368)
Jin dynasty (1115–1234)
Ming Dinasty (1368–1644)
Yuan dynasty  (1271–1368)
late Ming dynasty (1368–1644)
late Yuan dynasty (1271–1368)
Ming (1368–1644)–Qing (1644–1911) dynasty
Yuan (1271–1368) or Ming (1368–1644) dynasty
"Qing dynasty (1644–1911), Qianlong period (1736–95)"
late Ming (1368–1644)–early Qing (1644–1911) dynasty
late Yuan (1271–1368)–early Ming (1368–1644) dynasty
Ming dynasty (?) (1368–1644)
"Qing dynasty (1644–1911), Kangxi period (1662–1722)"
Ming dynasty (1368–1644) (?)
Qing dynasty (?) (1644–1911)
Song (960–1279) or Qing (1644–1911) dynasty (?)
late Ming (1368–1644)– early Qing (1644–1911) dynasty
20th century
Song dynasty (?) (960–1279)
Yuan dynasty (?) (1271–1368)
late Qing dynasty (1644–1911)
early Ming dynasty (1368–1644)
Song dynasty (960–1279) or later
Ming dynasty (1368–1644) or later
Ming dynasty (1368–1644) or earlier
Song (960–1279)–Ming (1368–1644) dynasty
probably mid- to late Ming dynasty (1368–1644)
Song (960–1279) or Yuan (1271–1368) dynasty (?)
Northern Song (960–1127) or Jin (1115–1234) dynasty
Five Dynasties (907–960)–early Song (906–1279) dynasty
Edo period (1615–1868)
Meiji period (1868–1912)
Muromachi period (1392–1573)
Momoyama period (1573–1615)
Ming dynasty (1368-1644)
Kamakura period (1185–1333)
Edo (1615–1868)–Meiji period (1868–1912)
Heian period (794–1185)
Taishō period (1912–26)
Nanbokuchō period (1336–92)
late Edo (1615–1868)–early Meiji (1868–1912) period
Momoyama (1573–1615)
Muromachi (1392–1573)
late Heian period (794–1185)
late Heian period (ca. 900–1185)
Momoyama (1573–1615)–Edo (1615–1868) period
Edo (1615–1868)
Meiji period (1868-1912)
Shōwa period (1926–89)
Meiji  period (1868–1912)
Edo period (1615–1868) 1845.
Edo period (1615–1868) Kihei.
Edo period (1615–1868Meiji period (1868–1912)
Momoyama (1573–1615)– Edo (1615–1868) period
late Edo (1615–1868) or Meiji (1868–1912) period
Edo period (1615–1868) or Meiji period (1868–1912)
Edo period (1615–1868) Osaka. 1837. Publishers: Eirakuya Tōshirō
Meiji (1868–1912)–Taishō (1912–26) period
Meiji (1868–1912) or Taishō (1912–26) period
Meiji (1868–1912)–Taishō  (1912–26) period
Late Edo (1615–1868) or Meiji (1868–1912) period
late Edo period (1615–1868)–early Meiji period (1868–1912) ?
late Edo period (1615–1868)
Meiji period (1866–1912)
Nanbokuchō (1336–92)–Muromachi (1392–1573) period
Edo period (1615–1868
Meiji period (1869–1912)
Edo (1615–1868) or Meiji period (1868–1912)
Imperial
Ming Dynasty
New Kingdom
"New Kingdom, Ramesside"
Second Intermediate Period–Early New Kingdom
Modern
Twentieth Century; original New Kingdom
20th century; original New Kingdom
Twentieth Century; original Early New Kingdom
Late Period
Middle Kingdom
early Republic period (late 19th–early 20th century)
Shang (ca. 1600–1046 B.C.)–Western Zhou (1046–771 B.C.) dynasty
Qing dynasty (1644–1911
Pala period
early Malla period
Goryeo dynasty (918–1392)
Early Rajput-Chaurapanchasika style
Early Rajput -Chaurapanchasika style
Hoysala period
Query:
SELECT object_id, period
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   LIMIT 100;
Answer:
object_id,period
646996,Joseon dynasty (1392–1910)
40445,Joseon dynasty (1392–1910)
45063,Joseon dynasty (1392–1910)
40069,Joseon dynasty (1392–1910)
40070,Joseon dynasty (1392–1910)
54912,Joseon dynasty (1392–1910)
40429,Joseon dynasty (1392–1910)
40432,Joseon dynasty (1392–1910)
73188,Joseon dynasty (1392–1910)
36145,Qing dynasty (1644–1911)
36130,Qing dynasty (1644–1911)
36435,Qing dynasty (1644–1911)
36036,Qing dynasty (1644–1911)
36072,Qing dynasty (1644–1911)
49133,Qing dynasty (1644–1911)
65620,Qing dynasty (1644–1911)
40021,Qing dynasty (1644–1911)
49453,Qing dynasty (1644–1911)
49134,Qing dynasty (1644–1911)
65075,Qing dynasty (1644–1911)
41468,Yuan dynasty (1271–1368)
40507,Yuan dynasty (1271–1368)
40052,Southern Song dynasty (1127–1279)
35995,Ming dynasty (1368–1644)
35999,Ming dynasty (1368–1644)
36003,Ming dynasty (1368–1644)
45786,Ming dynasty (1368–1644)
73669,Qing dynasty (1644–1911)
49179,Qing dynasty (1644–1911)
49226,Qing dynasty (1644–1911)
51727,Yuan dynasty (1271–1368) (?)
51705,Northern Song dynasty (960–1127)
51528,Ming (1368–1644) or Qing (1644–1911) dynasty
51656,Ming (1368–1644) or Qing dynasty (1644–1911)
51644,Ming (1368–1644) or Qing dynasty (1644–1911)
36129,Qing dynasty (1644–1911)
36439,Tang dynasty (618–907)
40285,Song dynasty (960–1279)
40107,Song dynasty (960–1279)
40180,Song dynasty (960–1279)
40194,Song dynasty (960–1279)
40060,Song dynasty (960–1279)
40058,Song dynasty (960–1279)
45684,Ming dynasty (1368–1644)
45746,Ming dynasty (1368–1644)
39766,Ming dynasty (1368–1644)
45749,Ming dynasty (1368–1644)
44574,Ming dynasty (1368–1644)
45775,Ming dynasty (1368–1644)
45780,Ming dynasty (1368–1644)
51865,Ming dynasty (1368–1644)
77914,Ming dynasty (1368–1644)
48875,Ming dynasty (1368–1644)
48955,Ming dynasty (1368–1644)
48954,Ming dynasty (1368–1644)
49025,Ming dynasty (1368–1644)
49029,Ming dynasty (1368–1644)
56553,Ming dynasty (1368–1644)
41780,Ming dynasty (1368–1644)
39625,Ming dynasty (1368–1644)
48931,Ming dynasty (1368–1644)
48928,Ming dynasty (1368–1644)
48959,Qing dynasty (1644–1911)
49129,Qing dynasty (1644–1911)
49146,Qing dynasty (1644–1911)
49147,Qing dynasty (1644–1911)
49163,Qing dynasty (1644–1911)
51894,Qing dynasty (1644–1911)
36132,Qing dynasty (1644–1911)
51900,Qing dynasty (1644–1911)
75814,Qing dynasty (1644–1911)
54308,Qing dynasty (1644–1911)
55495,Qing dynasty (1644–1911)
49473,Qing dynasty (1644–1911)
35987,Qing dynasty (1644–1911)
44570,Qing dynasty (1644–1911)
40105,Yuan dynasty (1271–1368)
40509,Yuan dynasty (1271–1368)
42329,Yuan dynasty (1271–1368)
39918,Northern Song dynasty (960–1127)
39919,Northern Song dynasty (960–1127)
40103,Southern Song dynasty (1127–1279)
40104,Southern Song dynasty (1127–1279)
41777,"late Qing dynasty (1644–1911, early Republic period"
Query:
SELECT period, COUNT(*) AS artwork_count
   FROM `bigquery-public-data.the_met.objects`
   WHERE period IS NOT NULL
   GROUP BY period
   ORDER BY artwork_count DESC
   LIMIT 100;
Answer:
period,artwork_count
Edo period (1615–1868),8060
Qing dynasty (1644–1911),3029
New Kingdom,3028
Middle Kingdom,2823
Archaic,1511
Classical,1160
"Qing dynasty (1644–1911), Qianlong period (1736–95)",945
Sasanian,906
Early Imperial,892
Hellenistic,846
Ming dynasty (1368–1644),845
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",786
Meiji period (1868–1912),702
"New Kingdom, Ramesside",668
Third Intermediate Period,635
"New Kingdom, Amarna Period",576
Han dynasty (206 B.C.–A.D. 220),564
Imperial,546
Iron Age II,494
Late Period–Ptolemaic Period,484
Neo-Assyrian,456
Late Classical,438
Late Imperial,431
"Late Period, Saite",384
Late Period,372
Tang dynasty (618–907),371
Central Javanese period,332
Edo (1615–1868),314
Mid Imperial,305
Neo-Babylonian,303
Roman Period,303
Old Kingdom,294
Ptolemaic Period,260
Iron Age III,260
Middle Kingdom–Early New Kingdom,255
Predynastic Period,254
Iron Age,245
Song dynasty (960–1279),239
Bronze Age,231
Yuan dynasty (1271–1368),219
Geometric,217
Bronze and Iron Age period,213
Goryeo dynasty (918–1392),205
Early Bronze Age,196
Late Bronze Age,178
Second Intermediate Period–Early New Kingdom,175
Cypro-Archaic II,170
Middle Bronze Age–Old Assyrian Trading Colony,167
Achaemenid,161
Parthian,160
Muromachi period (1392–1573),158
Early Dynastic Period,157
Joseon dynasty (1392–1910),155
Eastern Javanese period,139
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",136
"Early Imperial, Julio-Claudian",133
Old Babylonian,130
Early Minoan III,129
Ptolemaic or Roman Period,123
Ptolemaic Period–Roman Period,117
Final Jōmon period (ca. 1000–300 B.C.),117
Neolithic,113
Pala period,113
Early Hellenistic,112
Edo (1615–1868) or Meiji period (1868–1912),112
Old Kingdom–First Intermediate Period,112
Late Archaic,108
Momoyama period (1573–1615),107
Chalcolithic,105
Pre-Columbian,105
Middle Kingdom–Second Intermediate Period,104
Late Hellenistic,104
Early to Mid Imperial,98
Late Middle Kingdom–Second Intermediate Period,97
Classical or Hellenistic,97
Late period,95
Second Intermediate Period,90
"Qing dynasty (1644–1911), Kangxi mark and period (1662–1722)",88
Old Syrian,86
Kamakura period (1185–1333),84
Late Classical or Hellenistic,84
Shang dynasty (ca. 1600–1046 B.C.),84
Late Republican or Imperial,84
Sasanian–early Islamic,83
Chalcolithic–Early Bronze Age,82
Middle Bronze Age,80
Early Minoan II,80
Query:
SELECT object_id, label.description
   FROM `bigquery-public-data.the_met.vision_api_data`,
   UNNEST(labelAnnotations) AS label
   LIMIT 100;
Answer:
object_id,description
327565,product
696600,horn
213991,fashion accessory
504181,product
317279,material
565419,rock
689784,lighting
324455,product
314210,material
23420,weapon
196399,trophy
206354,product
75140,label
244393,product
29415,hand
25282,brass
322795,material
7526,automotive exterior
40355,box
559100,lighting
323405,material
545608,horn
465560,weapon
463732,sculpture
321787,art
249603,blue
560453,pattern
33401,brown
242696,fashion accessory
323595,drawing
326466,jewellery
60074,product
423535,sketch
40268,material
34932,dishware
550029,material
467247,material
450064,hand
58648,tapestry
326774,ice
62409,silver
447208,art
474443,wood
325782,organ
41787,technology
450081,fashion accessory
252096,organ
53076,weapon
570790,material
694403,horn
695312,material
244241,product
198082,lighting
700973,passive circuit component
210040,product
501743,product
228380,label
324355,material
645352,picture frame
326819,silver
323429,drawing
213810,weapon
465374,material
251327,wood
32778,gun barrel
548860,material
545332,wood
648483,sketch
466492,leaf
23777,lighting
60234,fashion accessory
546398,stele
317174,material
203686,lighting
324247,weapon
468795,iron
545597,horn
62215,product
323327,drawing
501097,material
23070,weapon
479238,wood
58289,weapon
549409,material
250595,product
326769,branch
326467,circle
57934,weapon
557131,jewellery
408009,sketch
326661,wheel
561808,wood
456195,material
249668,hand
560403,silver
464101,material
51326,horn
479351,horn
307593,shape
317154,material
Query:
SELECT o.object_id, o.period, label.description
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   LIMIT 100;
Answer:
object_id,period,description
62455,,spark plug
229720,,bottle
325108,,metal
249982,Classical,bottle
471714,,material
505157,,lighting
287951,,sketch
218789,,textile
189588,,brass
694343,,horn
468842,,brass
204067,,brand
2100,,monochrome photography
187267,,man made object
321506,,fashion accessory
326403,Bronze Age,rock
322000,Neo-Babylonian,material
3657,,product
253220,"Neolithic, second period",wood
257246,Early Imperial,fashion accessory
466532,,clothing
190652,,dishware
41826,"late Qing dynasty (1644–1911, early Republic period",iron
565416,Middle Kingdom,drawing
241827,,material
38049,,drawing
246351,,brass
546400,Late Middle Kingdom–Second Intermediate Period,material
60235,Meiji period (1868–1912),fashion accessory
244063,,ceramic
358944,,wood
551766,New Kingdom,wood
468875,,product
58816,Edo period (1615–1868),art
25286,,brass
252205,,shape
323981,Iron Age III,arm
324790,Neo-Assyrian,drawing
687730,,tool
504833,,weapon
213905,,grass family
65680,Qing dynasty (1644–1911),christmas decoration
588371,Late Period–Ptolemaic Period,material
228544,,pattern
193991,,picture frame
326211,Iron Age II,material
25654,,tool
224881,,textile
548094,"Late Period, Saite",material
321947,Achaemenid,drawing
560391,Middle Kingdom,pattern
74890,Pala period,brown
244259,,tool
717467,,text
325856,Middle Bronze Age–Old Assyrian Trading Colony,wood
472111,,fashion accessory
190740,,locket
565384,Middle Kingdom,hand
196690,,dishware
246454,,product
324734,,tooth
60611,,tool
308782,,metal
221081,,font
43289,,organ
465997,,invertebrate
309268,,tool
59423,Edo (1615–1868) or Meiji period (1868–1912),brass
559147,New Kingdom,jewellery
689831,Late Ptolemaic or Roman Period,tool
552333,Roman Period,product
502233,,horn
Query:
SELECT o.period, label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period IS NOT NULL
   GROUP BY o.period, label.description
   ORDER BY label_count DESC
   LIMIT 100;
Answer:
period,description,label_count
Edo period (1615–1868),art,5314
Edo period (1615–1868),sketch,3124
Edo period (1615–1868),drawing,2351
Edo period (1615–1868),pattern,2026
Edo period (1615–1868),painting,1755
Edo period (1615–1868),illustration,1664
Qing dynasty (1644–1911),art,1606
New Kingdom,fashion accessory,1010
Edo period (1615–1868),cartoon,971
Edo period (1615–1868),poster,959
New Kingdom,jewellery,951
Middle Kingdom,art,945
Edo period (1615–1868),textile,898
Qing dynasty (1644–1911),pattern,870
Archaic,art,867
Edo period (1615–1868),modern art,797
Qing dynasty (1644–1911),black and white,783
Middle Kingdom,material,750
Edo period (1615–1868),woman,735
Edo period (1615–1868),black and white,735
New Kingdom,art,734
Edo period (1615–1868),tapestry,714
New Kingdom,turquoise,708
Edo period (1615–1868),flooring,702
Qing dynasty (1644–1911),drawing,637
Edo period (1615–1868),ceramic,631
Classical,art,589
Edo period (1615–1868),design,575
Middle Kingdom,sculpture,563
Middle Kingdom,rock,554
Qing dynasty (1644–1911),sketch,537
Meiji period (1868–1912),art,533
Third Intermediate Period,art,513
Ming dynasty (1368–1644),art,509
Middle Kingdom,wood,508
Qing dynasty (1644–1911),ceramic,507
Archaic,sculpture,488
Archaic,ceramic,486
Middle Kingdom,drawing,478
Third Intermediate Period,sculpture,476
Edo period (1615–1868),wood,471
Edo period (1615–1868),blue and white porcelain,469
Middle Kingdom,fashion accessory,466
Qing dynasty (1644–1911),vase,455
Edo period (1615–1868),mural,446
"Qing dynasty (1644–1911), Qianlong period (1736–95)",art,442
Hellenistic,art,433
Third Intermediate Period,statue,426
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",art,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",vase,424
New Kingdom,wood,420
Classical,ceramic,417
Edo period (1615–1868),vase,407
Edo period (1615–1868),costume design,398
Edo period (1615–1868),ancient history,392
Classical,vase,388
Edo period (1615–1868),person,381
Qing dynasty (1644–1911),blue and white porcelain,369
Qing dynasty (1644–1911),textile,368
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",blue and white porcelain,366
Edo period (1615–1868),material,361
Early Imperial,fashion accessory,360
Query:
SELECT o.period, label.description, COUNT(*) AS label_count
   FROM `bigquery-public-data.the_met.objects` AS o
   INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
   ON o.object_id = v.object_id
   CROSS JOIN UNNEST(v.labelAnnotations) AS label
   WHERE o.period IS NOT NULL
   GROUP BY o.period, label.description
   HAVING COUNT(*) >= 50
   LIMIT 100;
Answer:
period,description,label_count
New Kingdom,wood,420
Meiji period (1868–1912),pattern,98
Middle Kingdom,brass,53
Middle Kingdom,material,750
Edo period (1615–1868),product,122
Archaic,horn,58
"Late Period, Saite",material,130
Neo-Babylonian,silver,60
Middle Kingdom,drawing,478
Edo period (1615–1868),glass,70
Early Bronze Age,material,60
Middle Kingdom,rock,554
Classical,wood,104
Middle Kingdom,lighting,99
New Kingdom,rock,184
Middle Kingdom,wood,508
"New Kingdom, Ramesside",fashion accessory,140
New Kingdom,material,327
Sasanian,shape,88
Sasanian,silver,192
Iron Age II,material,101
Archaic,lighting,142
Han dynasty (206 B.C.–A.D. 220),shape,177
Edo period (1615–1868),art,5314
Early Minoan III,material,58
Late Middle Kingdom–Second Intermediate Period,stele,58
Edo period (1615–1868),box,92
"New Kingdom, Amarna Period",material,277
New Kingdom,horn,116
Imperial,brass,89
Iron Age III,fashion accessory,53
New Kingdom,product,130
Neo-Babylonian,stone carving,90
Sasanian,drawing,205
Neo-Assyrian,material,79
Late Period–Ptolemaic Period,material,50
Middle Kingdom,horn,84
Ptolemaic Period–Roman Period,art,64
Late Period,jewellery,58
Early Minoan III,shape,57
Sasanian,art,275
Middle Kingdom,art,945
New Kingdom,fashion accessory,1010
Qing dynasty (1644–1911),drawing,637
Bronze and Iron Age period,brass,64
Neo-Babylonian,art,94
Neo-Assyrian,silver,51
Edo period (1615–1868),ceramic,631
"New Kingdom, Amarna Period",stone carving,193
Meiji period (1868–1912),art,533
Neo-Babylonian,material,108
Edo period (1615–1868),fashion accessory,258
Edo period (1615–1868),vehicle,69
Iron Age II,jewellery,103
Archaic,brass,105
Classical,man made object,215
Middle Kingdom,pattern,289
New Kingdom,man made object,104
Iron Age II,fashion accessory,124
"New Kingdom, Amarna Period",mineral,101
Early Imperial,fashion accessory,360
Early Imperial,shape,133
New Kingdom,pattern,113
Late Middle Kingdom–Second Intermediate Period,rock,52
Late Middle Kingdom–Second Intermediate Period,material,72
Query:
SELECT o.period, label.description, COUNT(*) AS label_count
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY o.period, label.description
ORDER BY label_count DESC
LIMIT 100;
Answer:
period,description,label_count
Edo period (1615–1868),art,5314
Edo period (1615–1868),sketch,3124
Edo period (1615–1868),drawing,2351
Edo period (1615–1868),pattern,2026
Edo period (1615–1868),painting,1755
Edo period (1615–1868),illustration,1664
Qing dynasty (1644–1911),art,1606
New Kingdom,fashion accessory,1010
Edo period (1615–1868),cartoon,971
Edo period (1615–1868),poster,959
New Kingdom,jewellery,951
Middle Kingdom,art,945
Edo period (1615–1868),textile,898
Qing dynasty (1644–1911),pattern,870
Archaic,art,867
Edo period (1615–1868),modern art,797
Qing dynasty (1644–1911),black and white,783
Middle Kingdom,material,750
Edo period (1615–1868),black and white,735
Edo period (1615–1868),woman,735
New Kingdom,art,734
Edo period (1615–1868),tapestry,714
New Kingdom,turquoise,708
Edo period (1615–1868),flooring,702
Qing dynasty (1644–1911),drawing,637
Edo period (1615–1868),ceramic,631
Classical,art,589
Edo period (1615–1868),design,575
Middle Kingdom,sculpture,563
Middle Kingdom,rock,554
Qing dynasty (1644–1911),sketch,537
Meiji period (1868–1912),art,533
Third Intermediate Period,art,513
Ming dynasty (1368–1644),art,509
Middle Kingdom,wood,508
Qing dynasty (1644–1911),ceramic,507
Archaic,sculpture,488
Archaic,ceramic,486
Middle Kingdom,drawing,478
Third Intermediate Period,sculpture,476
Edo period (1615–1868),wood,471
Edo period (1615–1868),blue and white porcelain,469
Middle Kingdom,fashion accessory,466
Qing dynasty (1644–1911),vase,455
Edo period (1615–1868),mural,446
"Qing dynasty (1644–1911), Qianlong period (1736–95)",art,442
Hellenistic,art,433
Third Intermediate Period,statue,426
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",vase,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",art,424
New Kingdom,wood,420
Classical,ceramic,417
Edo period (1615–1868),vase,407
Edo period (1615–1868),costume design,398
Edo period (1615–1868),ancient history,392
Classical,vase,388
Edo period (1615–1868),person,381
Qing dynasty (1644–1911),blue and white porcelain,369
Qing dynasty (1644–1911),textile,368
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",blue and white porcelain,366
Edo period (1615–1868),material,361
Early Imperial,fashion accessory,360
Query:
SELECT label.description, label.score
FROM `bigquery-public-data.the_met.vision_api_data`,
UNNEST(labelAnnotations) AS label
LIMIT 100
Answer:
description,score
spark plug,0.6382611393928528
bottle,0.5313543677330017
metal,0.5386295318603516
bottle,0.5041088461875916
material,0.5339352488517761
lighting,0.6573033332824707
sketch,0.564201295375824
textile,0.5862242579460144
brass,0.6346170902252197
horn,0.7221972346305847
brass,0.6329494714736938
brand,0.596916675567627
monochrome photography,0.5306386351585388
man made object,0.9216219186782837
fashion accessory,0.6620733737945557
rock,0.6995851993560791
material,0.5378533005714417
product,0.7340088486671448
wood,0.5981280207633972
fashion accessory,0.6377023458480835
clothing,0.9017379283905029
dishware,0.5471827983856201
iron,0.7568996548652649
drawing,0.5147865414619446
material,0.5267785787582397
drawing,0.5567029118537903
brass,0.5438459515571594
material,0.5404350757598877
fashion accessory,0.626270592212677
ceramic,0.5019612908363342
wood,0.6085013747215271
wood,0.5975653529167175
product,0.735457718372345
art,0.7379064559936523
brass,0.6450731158256531
shape,0.5883374810218811
arm,0.6705746650695801
drawing,0.5139475464820862
tool,0.6272326707839966
weapon,0.5195496678352356
grass family,0.5479329228401184
christmas decoration,0.649424135684967
material,0.5585384368896484
pattern,0.5095349550247192
picture frame,0.8941380977630615
material,0.5218632221221924
tool,0.5688906908035278
textile,0.5325451493263245
material,0.5242740511894226
drawing,0.5175843238830566
pattern,0.6123761534690857
brown,0.816507875919342
tool,0.5622634291648865
text,0.9326171875
wood,0.6097862124443054
fashion accessory,0.6297428011894226
locket,0.7189846634864807
hand,0.5557277202606201
dishware,0.5472484230995178
product,0.7371984720230103
tooth,0.5240021347999573
tool,0.5035712122917175
metal,0.5160228610038757
font,0.7580641508102417
organ,0.6603940725326538
invertebrate,0.5211217999458313
tool,0.514660120010376
brass,0.5901290774345398
jewellery,0.5728819370269775
tool,0.5738584995269775
product,0.7606844305992126
horn,0.6470463275909424
material,0.5489948987960815
product,0.7809261679649353
horn,0.5658637285232544
product,0.7648868560791016
weapon,0.5041947960853577
silver,0.6460575461387634
plastic wrap,0.5153576731681824
pattern,0.5203388333320618
chain,0.5661110877990723
drawing,0.538819432258606
material,0.553455114364624
text,0.9381742477416992
mustang horse,0.7440498471260071
hand,0.5536729693412781
jewellery,0.6383907198905945
sculpture,0.5433937311172485
material,0.5457663536071777
horn,0.5247842073440552
material,0.5179493427276611
Query:
SELECT label.description, COUNT(*) AS artwork_count
FROM `bigquery-public-data.the_met.vision_api_data`,
UNNEST(labelAnnotations) AS label
GROUP BY label.description
ORDER BY artwork_count DESC
LIMIT 100
Answer:
description,artwork_count
art,84720
sketch,51375
drawing,48182
pattern,30846
painting,26915
fashion accessory,21343
black and white,20366
sculpture,20266
ancient history,18208
illustration,16346
ceramic,15838
textile,15551
wood,15179
jewellery,14163
relief,14040
material,13941
picture frame,12690
vase,11181
clothing,10133
design,9398
statue,9352
modern art,9343
stone carving,9095
lighting,8891
flooring,8598
figure drawing,8324
silver,7745
product,7625
carving,7497
brass,7483
porcelain,7334
shape,7251
tapestry,6934
poster,6240
cartoon,6196
furniture,6084
blue and white porcelain,6072
metal,6047
monochrome photography,6028
tableware,4947
currency,4886
money,4807
circle,4683
photograph,4614
image,4414
text,4200
dishware,4140
monochrome,3899
man made object,3876
white,3785
portrait,3781
bowl,3768
bronze,3707
monument,3698
wall,3668
saucer,3663
pottery,3652
black,3564
tablecloth,3399
head,3381
rock,3149
horn,3121
green,3060
organ,3011
glass,2983
cup,2975
font,2882
drinkware,2833
plate,2822
classical sculpture,2781
dress,2739
coin,2704
hand,2703
blue,2557
weapon,2511
iron,2436
brown,2350
gemstone,2290
figurine,2267
bronze sculpture,2219
rectangle,2184
floor,2126
still life photography,2056
locket,2021
structure,2016
mug,1965
platter,1943
lace,1943
table,1908
sleeve,1903
bottle,1826
gown,1757
leaf,1726
pendant,1725
teapot,1683
footwear,1654
outerwear,1650
award,1633
interior design,1616
calligraphy,1606
Query:
SELECT *
FROM (
  SELECT
    o.period,
    label.description AS label_description,
    COUNT(*) AS label_count,
    ROW_NUMBER() OVER (PARTITION BY o.period ORDER BY COUNT(*) DESC) AS row_num
  FROM `bigquery-public-data.the_met.objects` AS o
  INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
    ON o.object_id = v.object_id
  CROSS JOIN UNNEST(v.labelAnnotations) AS label
  WHERE o.period IS NOT NULL
  GROUP BY o.period, label.description
)
WHERE row_num <= 3
  AND label_count >= 50
LIMIT 100
Answer:
period,label_description,label_count,row_num
Bronze and Iron Age period,art,83,1
Bronze and Iron Age period,brass,64,2
Edo period (1615–1868),art,5314,1
Edo period (1615–1868),sketch,3124,2
Edo period (1615–1868),drawing,2351,3
Late Period,art,192,1
Late Period,sculpture,177,2
Late Period,statue,123,3
Middle Kingdom,art,945,1
Middle Kingdom,material,750,2
Middle Kingdom,sculpture,563,3
Qing dynasty (1644–1911),art,1606,1
Qing dynasty (1644–1911),pattern,870,2
Qing dynasty (1644–1911),black and white,783,3
Yuan dynasty (1271–1368),art,124,1
Yuan dynasty (1271–1368),sketch,62,2
Yuan dynasty (1271–1368),ceramic,57,3
Period of Tibetan Empire,fashion accessory,65,1
Period of Tibetan Empire,jewellery,63,2
Iron Age,art,108,1
Iron Age,sculpture,96,2
Song dynasty (960–1279),art,138,1
Song dynasty (960–1279),ceramic,88,2
Song dynasty (960–1279),bowl,63,3
Hellenistic,art,433,1
Hellenistic,sculpture,317,2
Hellenistic,ceramic,218,3
Middle Bronze Age–Old Assyrian Trading Colony,art,62,1
Momoyama period (1573–1615),art,58,1
Classical,art,589,1
Classical,ceramic,417,2
Classical,vase,388,3
Joseon dynasty (1392–1910),art,92,1
Early Minoan II,wood,53,1
Middle Kingdom–Second Intermediate Period,fashion accessory,57,1
Ptolemaic Period,art,133,1
Ptolemaic Period,sculpture,124,2
Ptolemaic Period,statue,70,3
"New Kingdom, Ramesside",art,191,1
"New Kingdom, Ramesside",fashion accessory,140,2
"New Kingdom, Ramesside",wood,128,3
Classical or Hellenistic,fashion accessory,84,1
Classical or Hellenistic,jewellery,84,2
Middle Kingdom–Early New Kingdom,fashion accessory,139,1
Middle Kingdom–Early New Kingdom,jewellery,126,2
Middle Kingdom–Early New Kingdom,art,64,3
Late Imperial,ceramic,227,1
Late Imperial,art,225,2
Late Imperial,vase,199,3
New Kingdom,fashion accessory,1010,1
New Kingdom,jewellery,951,2
Query:
SELECT period, COUNT(*) AS total_artworks
FROM `bigquery-public-data.the_met.objects`
WHERE period IS NOT NULL
GROUP BY period
ORDER BY total_artworks DESC
LIMIT 100
Answer:
period,total_artworks
Edo period (1615–1868),8060
Qing dynasty (1644–1911),3029
New Kingdom,3028
Middle Kingdom,2823
Archaic,1511
Classical,1160
"Qing dynasty (1644–1911), Qianlong period (1736–95)",945
Sasanian,906
Early Imperial,892
Hellenistic,846
Ming dynasty (1368–1644),845
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",786
Meiji period (1868–1912),702
"New Kingdom, Ramesside",668
Third Intermediate Period,635
"New Kingdom, Amarna Period",576
Han dynasty (206 B.C.–A.D. 220),564
Imperial,546
Iron Age II,494
Late Period–Ptolemaic Period,484
Neo-Assyrian,456
Late Classical,438
Late Imperial,431
"Late Period, Saite",384
Late Period,372
Tang dynasty (618–907),371
Central Javanese period,332
Edo (1615–1868),314
Mid Imperial,305
Neo-Babylonian,303
Roman Period,303
Old Kingdom,294
Ptolemaic Period,260
Iron Age III,260
Middle Kingdom–Early New Kingdom,255
Predynastic Period,254
Iron Age,245
Song dynasty (960–1279),239
Bronze Age,231
Yuan dynasty (1271–1368),219
Geometric,217
Bronze and Iron Age period,213
Goryeo dynasty (918–1392),205
Early Bronze Age,196
Late Bronze Age,178
Second Intermediate Period–Early New Kingdom,175
Cypro-Archaic II,170
Middle Bronze Age–Old Assyrian Trading Colony,167
Achaemenid,161
Parthian,160
Muromachi period (1392–1573),158
Early Dynastic Period,157
Joseon dynasty (1392–1910),155
Eastern Javanese period,139
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",136
"Early Imperial, Julio-Claudian",133
Old Babylonian,130
Early Minoan III,129
Ptolemaic or Roman Period,123
Ptolemaic Period–Roman Period,117
Final Jōmon period (ca. 1000–300 B.C.),117
Neolithic,113
Pala period,113
Early Hellenistic,112
Edo (1615–1868) or Meiji period (1868–1912),112
Old Kingdom–First Intermediate Period,112
Late Archaic,108
Momoyama period (1573–1615),107
Chalcolithic,105
Pre-Columbian,105
Middle Kingdom–Second Intermediate Period,104
Late Hellenistic,104
Early to Mid Imperial,98
Late Middle Kingdom–Second Intermediate Period,97
Classical or Hellenistic,97
Late period,95
Second Intermediate Period,90
"Qing dynasty (1644–1911), Kangxi mark and period (1662–1722)",88
Old Syrian,86
Kamakura period (1185–1333),84
Late Classical or Hellenistic,84
Shang dynasty (ca. 1600–1046 B.C.),84
Late Republican or Imperial,84
Sasanian–early Islamic,83
Chalcolithic–Early Bronze Age,82
Middle Bronze Age,80
Query:
SELECT v.object_id, label.description
FROM `bigquery-public-data.the_met.vision_api_data` AS v
CROSS JOIN UNNEST(v.labelAnnotations) AS label
LIMIT 100
Answer:
object_id,description
251746,wing
417179,ancient history
3061,lighting
575413,wood
213609,grass family
252143,shape
228470,pattern
503199,tap
60333,pattern
560881,brass
546828,product
644915,picture frame
323425,nut
556604,fashion accessory
210045,cosmetics
213909,fashion accessory
562723,material
251295,wood
61352,horn
53437,product
414551,poster
225001,grass family
546323,money
69702,christmas decoration
251698,horn
29707,brass
467324,shape
501509,automotive engine part
249027,green
642488,window
23587,wing
214078,fashion accessory
317269,eye
192688,weapon
457110,money
6954,tool
548118,material
40319,box
552600,art
504525,weapon
322252,silver
547351,fashion accessory
214042,hair accessory
244282,material
444839,product
468813,chain
214987,blue
463506,shape
546310,tool
315650,weapon
552317,food
242697,fashion accessory
53018,circle
309424,jewellery
8768,chain
412010,sketch
555095,hand
326399,snow
249033,weapon
560411,drawing
246364,brass
250381,carving
317630,rectangle
470893,wood
323099,product
213822,grass family
58695,glass
315806,tool
62206,chain
325262,material
28236,brass
250634,horn
247045,line
549234,lighting
26609,hand
565415,rock
26867,brass
29925,label
250601,line
323987,material
244210,wood
309954,metal
193134,relief
362430,advertising
546717,electrical wiring
241839,jewellery
35046,brass
567652,furniture
686538,jewellery
326598,pendant
645254,poster
315662,green
249791,hand
7568,fashion accessory
58552,suitcase
546497,food
268393,place of worship
559517,lighting
195333,weapon
477763,fashion accessory
Query:
SELECT o.period, COUNT(DISTINCT label.description) AS unique_labels
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
  ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY o.period
ORDER BY unique_labels DESC
LIMIT 100
Answer:
period,unique_labels
Edo period (1615–1868),519
New Kingdom,427
Qing dynasty (1644–1911),407
Middle Kingdom,401
Archaic,268
"New Kingdom, Ramesside",266
Ming dynasty (1368–1644),259
Meiji period (1868–1912),257
Classical,246
"Qing dynasty (1644–1911), Qianlong period (1736–95)",244
Sasanian,227
Hellenistic,221
Early Imperial,216
Roman Period,190
Neo-Assyrian,190
Late Period,189
Imperial,188
Iron Age II,188
Tang dynasty (618–907),176
Late Classical,173
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",168
"New Kingdom, Amarna Period",165
Third Intermediate Period,161
Ptolemaic Period,157
Han dynasty (206 B.C.–A.D. 220),157
Late Imperial,154
Iron Age III,151
Iron Age,151
Early Bronze Age,149
Old Kingdom,145
Late Period–Ptolemaic Period,140
Song dynasty (960–1279),139
Middle Kingdom–Early New Kingdom,137
Neo-Babylonian,129
Second Intermediate Period–Early New Kingdom,129
Predynastic Period,129
Ptolemaic or Roman Period,127
Geometric,127
Late Bronze Age,126
Yuan dynasty (1271–1368),126
"Late Period, Saite",124
Parthian,122
Bronze Age,121
Goryeo dynasty (918–1392),120
Early Dynastic Period,119
Muromachi period (1392–1573),117
Achaemenid,114
"Early Imperial, Julio-Claudian",113
Momoyama period (1573–1615),111
Joseon dynasty (1392–1910),111
Middle Bronze Age–Old Assyrian Trading Colony,110
Second Intermediate Period,108
Bronze and Iron Age period,107
Mid Imperial,97
Central Javanese period,96
Eastern Javanese period,94
Chalcolithic,93
Late Classical or Hellenistic,92
Late Archaic,91
Sasanian–early Islamic,91
Middle Kingdom–Second Intermediate Period,90
Kamakura period (1185–1333),85
Ptolemaic Period–Roman Period,85
Late Hellenistic,84
Neolithic,84
Shang dynasty (ca. 1600–1046 B.C.),80
Eastern Han dynasty (25–220),79
"Early Imperial, Augustan",78
Middle Bronze Age,78
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",77
Heian period (794–1185),77
Edo (1615–1868),76
Western Han dynasty (206 B.C.–A.D. 9),75
Early Dynastic IIIa,75
Kofun period (ca. 300–710),74
Edo (1615–1868) or Meiji period (1868–1912),74
Southern Song dynasty (1127–1279),74
Chalcolithic–Early Bronze Age,73
Pala period,73
"Eastern Zhou dynasty, Warring States period (475–221 B.C.)",73
Final Jōmon period (ca. 1000–300 B.C.),72
Northern Song dynasty (960–1127),69
Pre-Columbian,68
Western Zhou dynasty (1046–771 B.C.),67
Old Babylonian,67
Jin dynasty (1115–1234),66
Early Hellenistic,65
Query:
SELECT o.object_id, o.period
FROM `bigquery-public-data.the_met.objects` AS o
LEFT JOIN `bigquery-public-data.the_met.vision_api_data` AS v
  ON o.object_id = v.object_id
WHERE v.object_id IS NULL
LIMIT 100
Answer:
object_id,period
48968,Ming dynasty (1368–1644)
52009,Edo period (1615–1868)
56235,Edo period (1615–1868)
734140,
384014,
670272,
670275,
670274,
190636,
45663,Ming dynasty (1368–1644)
307433,
207150,
344292,
41691,"Qing dynasty (1644–1911), Yongzheng period (1723–35)"
61663,Han dynasty (206 B.C.–A.D. 220)
42137,Qing dynasty (1644–1911)
717704,
25600,
734136,
35717,
248691,Hellenistic
243783,
248040,Early Imperial
501131,
187742,
187743,
218045,
212357,
571887,Third Intermediate Period or later
571894,Third Intermediate Period or later
568299,"New Kingdom, Ramesside"
568300,"New Kingdom, Ramesside"
568301,"New Kingdom, Ramesside"
574433,Middle Kingdom
545501,Middle Kingdom
544192,Middle Kingdom
545381,Middle Kingdom
545384,Middle Kingdom
565784,Middle Kingdom
556748,Middle Kingdom
454567,
471194,
471860,
470828,
442861,
444979,
564801,Middle Kingdom
564802,Middle Kingdom
545727,Middle Kingdom
645469,
645471,
645481,
645482,
645485,
645486,
645487,
645488,
645489,
645497,
645498,
645500,
645501,
645502,
645505,
Query:
SELECT label.description, COUNT(DISTINCT o.period) AS period_count
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN `bigquery-public-data.the_met.vision_api_data` AS v
  ON o.object_id = v.object_id
CROSS JOIN UNNEST(v.labelAnnotations) AS label
WHERE o.period IS NOT NULL
GROUP BY label.description
ORDER BY period_count DESC
LIMIT 100
Answer:
description,period_count
art,1044
sculpture,717
ceramic,614
vase,490
wood,467
statue,455
material,448
fashion accessory,437
stone carving,423
black and white,416
jewellery,386
carving,344
drawing,309
metal,305
shape,301
brass,301
lighting,299
pottery,297
silver,283
monument,281
product,272
ancient history,267
sketch,266
head,260
man made object,235
bowl,234
bronze,231
organ,230
pattern,222
classical sculpture,221
porcelain,217
horn,214
blue and white porcelain,212
circle,212
relief,211
hand,196
bronze sculpture,195
monochrome photography,189
money,188
furniture,187
currency,182
rock,181
clothing,173
tableware,168
dishware,168
black,163
monochrome,157
green,155
textile,151
white,134
structure,133
gemstone,132
leaf,132
weapon,131
food,131
produce,129
iron,129
rectangle,128
drinkware,128
still life photography,126
font,126
stele,123
coin,120
figurine,119
cup,119
mineral,116
painting,113
design,112
wheel,111
teapot,111
bead,111
footwear,109
blue,109
bottle,103
wing,103
jug,102
table,100
wall,99
arm,93
human positions,92
saucer,92
modern art,87
sink,87
chain,87
text,86
bracelet,86
earrings,85
ring,80
picture frame,79
leather,79
brown,78
flooring,78
pendant,78
locket,78
column,78
cobalt blue,77
human body,77
yellow,77
glass bottle,75
necklace,75
Query:
SELECT o.period, AVG(label_counts.num_labels) AS avg_labels_per_artwork
FROM `bigquery-public-data.the_met.objects` AS o
INNER JOIN (
  SELECT object_id, COUNT(*) AS num_labels
  FROM `bigquery-public-data.the_met.vision_api_data`,
  UNNEST(labelAnnotations) AS label
  GROUP BY object_id
) AS label_counts
  ON o.object_id = label_counts.object_id
WHERE o.period IS NOT NULL
GROUP BY o.period
ORDER BY avg_labels_per_artwork DESC
LIMIT 100
Answer:
period,avg_labels_per_artwork
"Ming dynasty (1368–1644), Zhengde period (1506–21)",5.0
Cypro-Classical II–Early Hellenistic,5.0
Kushan or Islamic,5.0
Late Naqada III or early Dynasty 1,5.0
late Zhou (1046–256 B.C.)–early Han (206 B.C.–A.D. 220) dynasty,5.0
late Momoyama (1573–1615)–early Edo (1615–1868) period,5.0
Ly (1009–1225)–Tran (1225–1400) dynasty,5.0
Middle Minoan IIIA-B,5.0
late Tang (618–907)–early Song (960–1279) dynasty,5.0
"Mid Imperial, Severan",5.0
Late Cypro-Archaic II,5.0
Nanbokuchō (1336–92)–early Muromachi period (1392–1573),5.0
"Predynastic, Late Naqada III–Early Dynastic Period",5.0
"Republic period (1912–49), Hongxian mark and period (1915–16)",5.0
Tang dynasty (618–907) (?),5.0
late Goryeo dynasty (918–1392)–early Joseon dynasty (1392–1910),5.0
Late Cypro-Classical I–Early Cypro-Classical I,5.0
Unified Silla dynasty (676–935),5.0
"Ming dynasty (1368–1644), Wanli mark and period (1573–1620)",5.0
Post-Akkadian,5.0
"Qing dynasty (1644–1911), Kangxi period (1622–1722)",5.0
Early Roman (?),5.0
Late Corinthian,5.0
Northern Wei dynasty (386–534),5.0
Late Cypriot II or III,5.0
late Edo period (1615–1868),5.0
late Northern Song dynasty (960–1127),5.0
Middle Cypriot III,5.0
Anuradhapura period,5.0
"Qing dynasty (1644–1911), Kangxi period (1662–1722",5.0
Ming dynasty (1368–1644) (?),5.0
"Qing dynasty (1644–1911), Xianfeng mark and period (1851–61)",5.0
Late Dynastic or Hellenistic,5.0
Neolithic period,5.0
Villanovian/Orientalizing,5.0
Mauryan period,5.0
New Kingdom to 3rd Intermediate Period,5.0
Ubaid–Early Uruk,5.0
Yayoi period (ca. 300 B.C.–ca. A.D. 300),5.0
"Predynastic, Naqada III–Early Dynastic Period",5.0
Song dynasty (960–1279) or later,5.0
late Ming dynasty ? (1368-1644),5.0
Song (960–1279)–Yuan (1271–1368) dynasty,5.0
Cypro-Classical II,5.0
"New Kingdom, early",5.0
"Cypro-Classical, probably",5.0
"Ming dynasty (1368–1644), late Wanli period (1573–1620)",5.0
Southern Song (1127–1279) to Yuan (1271–1368) dynasty,5.0
Early Dynastic Period–Old Kingdom,5.0
Jin (1115–1234)–Yuan (1271–1368) dynasty,5.0
probably late Ming dynasty (1368–1644),5.0
early Ming dynasty (1368–1644),5.0
Northern Dynasties (386–581),5.0
Modern (?),5.0
Momoyama period (1573–1615) or Edo period (1615–1868),5.0
Old Elamite (?),5.0
Cypro-Archaic II (?),5.0
Mid  to Late Imperial,5.0
Neo-Babylonian–Achaemenid,5.0
Late Villanovian,5.0
"Qing dynasty (1644–1911), Tongzhi period (1862–74)",5.0
Macedonian–Ptolemaic Period,5.0
Middle Bronze Age II,5.0
Late Imperial or Early Byzantine,5.0
End Exploring Related Columns
Task: What are the top three most frequently associated labels with artworks from each historical period in The Met's collection, only considering labels linked to 50 or more artworks? Provide me with the period, label, and the associated count.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: To determine the top three most frequently associated labels with artworks from each historical period in The Met's collection, considering only labels linked to 50 or more artworks, we combined data from the `objects` and `vision_api_data` tables using the `object_id`. We extracted labels from the `labelAnnotations` field, counted their occurrences for each period, filtered out labels associated with fewer than 50 artworks, and then selected the top three labels for each period based on the count.

Here is the result in CSV format:

```csv
Period,Label,Count
period1:str,label1:str,count1:int
period1:str,label2:str,count2:int
period1:str,label3:str,count3:int
period2:str,label1:str,count1:int
period2:str,label2:str,count2:int
period2:str,label3:str,count3:int
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'the_met': ['images', 'objects', 'vision_api_data']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 01:33:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:33:54 - root - INFO - ```sql
SELECT period, label_description, label_count
FROM (
    SELECT
        o.period,
        label.description AS label_description,
        COUNT(*) AS label_count,
        ROW_NUMBER() OVER (PARTITION BY o.period ORDER BY COUNT(*) DESC) AS rank_in_period
    FROM
        `bigquery-public-data.the_met.objects` AS o
    INNER JOIN
        `bigquery-public-data.the_met.vision_api_data` AS v
    ON
        o.object_id = v.object_id
    CROSS JOIN
        UNNEST(v.labelAnnotations) AS label
    WHERE
        o.period IS NOT NULL
    GROUP BY
        o.period, label.description
    HAVING
        COUNT(*) >= 50
)
WHERE rank_in_period <= 3
ORDER BY period, rank_in_period;
```
2025-01-27 01:33:56 - root - INFO - itercount: 1
2025-01-27 01:33:56 - root - INFO - 0
2025-01-27 01:33:56 - root - INFO - results: 
period,label_description,label_count
Achaemenid,art,54
Archaic,art,867
Archaic,sculpture,488
Archaic,ceramic,486
Bronze Age,silver,83
Bronze Age,drawing,71
Bronze and Iron Age period,art,83
Bronze and Iron Age period,brass,64
Central Javanese period,jewellery,259
Central Javanese period,fashion accessory,255
Central Javanese period,brass,171
Classical,art,589
Classical,ceramic,417
Classical,vase,388
Classical or Hellenistic,fashion accessory,84
Classical or Hellenistic,jewellery,84
Cypro-Archaic I,art,57
Cypro-Archaic II,art,156
Cypro-Archaic II,sculpture,154
Cypro-Archaic II,stone carving,118
Early Bronze Age,art,66
Early Bronze Age,material,60
Early Dynastic Period,art,59
Early Dynastic Period,wood,57
Early Hellenistic,art,85
Early Hellenistic,sculpture,84
Early Hellenistic,stone carving,60
Early Imperial,fashion accessory,360
Early Imperial,jewellery,341
Early Imperial,art,329
"Early Imperial, Julio-Claudian",art,57
Early Minoan II,wood,53
Early Minoan III,wood,73
Early Minoan III,material,58
Early Minoan III,shape,57
Early to Mid Imperial,vase,78
Early to Mid Imperial,ceramic,74
Eastern Javanese period,art,62
Eastern Javanese period,sculpture,57
Eastern Javanese period,fashion accessory,54
Edo (1615–1868),pattern,282
Edo (1615–1868),art,251
Edo (1615–1868),flooring,194
Edo (1615–1868) or Meiji period (1868–1912),art,77
Edo (1615–1868) or Meiji period (1868–1912),pattern,70
Edo (1615–1868) or Meiji period (1868–1912),flooring,58
Edo period (1615–1868),art,5314
Edo period (1615–1868),sketch,3124
Edo period (1615–1868),drawing,2351
Final Jōmon period (ca. 1000–300 B.C.),wood,77
Final Jōmon period (ca. 1000–300 B.C.),horn,60
Final Jōmon period (ca. 1000–300 B.C.),hand,58
Geometric,art,92
Geometric,ceramic,71
Geometric,jewellery,67
Goryeo dynasty (918–1392),art,95
Goryeo dynasty (918–1392),ceramic,81
Goryeo dynasty (918–1392),bowl,51
Han dynasty (206 B.C.–A.D. 220),art,237
Han dynasty (206 B.C.–A.D. 220),sculpture,187
Han dynasty (206 B.C.–A.D. 220),shape,177
Hellenistic,art,433
Hellenistic,sculpture,317
Hellenistic,ceramic,218
Imperial,art,260
Imperial,sculpture,213
Imperial,fashion accessory,150
Iron Age,art,108
Iron Age,sculpture,96
Iron Age II,art,219
Iron Age II,sculpture,152
Iron Age II,fashion accessory,124
Iron Age III,sculpture,84
Iron Age III,art,83
Iron Age III,fashion accessory,53
Joseon dynasty (1392–1910),art,92
Kamakura period (1185–1333),art,64
Late Archaic,art,60
Late Bronze Age,jewellery,62
Late Bronze Age,fashion accessory,61
Late Bronze Age,brass,53
Late Classical,art,265
Late Classical,ceramic,190
Late Classical,sculpture,149
Late Hellenistic,art,63
Late Hellenistic,sculpture,53
Late Imperial,ceramic,227
Late Imperial,art,225
Late Imperial,vase,199
Late Middle Kingdom–Second Intermediate Period,material,72
Late Middle Kingdom–Second Intermediate Period,stele,58
Late Middle Kingdom–Second Intermediate Period,rock,52
Late Period,art,192
Late Period,sculpture,177
Late Period,statue,123
"Late Period, Saite",drawing,144
"Late Period, Saite",rock,139
"Late Period, Saite",material,130
Late Period–Ptolemaic Period,art,303
Late Period–Ptolemaic Period,sculpture,303
Late Period–Ptolemaic Period,statue,215
Late period,jewellery,59
Meiji period (1868–1912),art,533
Meiji period (1868–1912),painting,258
Meiji period (1868–1912),sketch,232
Mid Imperial,vase,203
Mid Imperial,ceramic,198
Mid Imperial,art,162
Middle Bronze Age–Old Assyrian Trading Colony,art,62
Middle Kingdom,art,945
Middle Kingdom,material,750
Middle Kingdom,sculpture,563
Middle Kingdom–Early New Kingdom,fashion accessory,139
Middle Kingdom–Early New Kingdom,jewellery,126
Middle Kingdom–Early New Kingdom,art,64
Middle Kingdom–Second Intermediate Period,fashion accessory,57
Ming dynasty (1368–1644),art,509
Ming dynasty (1368–1644),pattern,132
Ming dynasty (1368–1644),ceramic,130
Momoyama period (1573–1615),art,58
Muromachi period (1392–1573),art,105
Muromachi period (1392–1573),painting,56
Neo-Assyrian,art,195
Neo-Assyrian,relief,156
Neo-Assyrian,stone carving,152
Neo-Babylonian,material,108
Neo-Babylonian,art,94
Neo-Babylonian,stone carving,90
Neolithic,material,50
New Kingdom,fashion accessory,1010
New Kingdom,jewellery,951
New Kingdom,art,734
"New Kingdom, Amarna Period",material,277
"New Kingdom, Amarna Period",rock,204
"New Kingdom, Amarna Period",stone carving,193
"New Kingdom, Ramesside",art,191
"New Kingdom, Ramesside",fashion accessory,140
"New Kingdom, Ramesside",wood,128
Old Babylonian,relief,89
Old Babylonian,stone carving,85
Old Babylonian,black and white,51
Old Kingdom,ceramic,108
Old Kingdom,art,99
Old Kingdom,hand,74
Old Kingdom–First Intermediate Period,rock,73
Old Kingdom–First Intermediate Period,wood,69
Old Kingdom–First Intermediate Period,art,51
Old Syrian,relief,65
Old Syrian,stone carving,62
Pala period,art,64
Parthian,art,61
Period of Tibetan Empire,fashion accessory,65
Period of Tibetan Empire,jewellery,63
Pre-Columbian,sculpture,73
Pre-Columbian,art,72
Predynastic Period,ceramic,116
Predynastic Period,art,112
Predynastic Period,vase,95
Ptolemaic Period,art,133
Ptolemaic Period,sculpture,124
Ptolemaic Period,statue,70
Ptolemaic Period–Roman Period,fashion accessory,79
Ptolemaic Period–Roman Period,art,64
Ptolemaic Period–Roman Period,jewellery,61
Ptolemaic or Roman Period,fashion accessory,53
Qing dynasty (1644–1911),art,1606
Qing dynasty (1644–1911),pattern,870
Qing dynasty (1644–1911),black and white,783
"Qing dynasty (1644–1911), Kangxi mark and period (1662–1722)",ceramic,51
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",vase,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",art,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",blue and white porcelain,366
"Qing dynasty (1644–1911), Qianlong period (1736–95)",art,442
"Qing dynasty (1644–1911), Qianlong period (1736–95)",black and white,350
"Qing dynasty (1644–1911), Qianlong period (1736–95)",vase,310
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",vase,78
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",art,64
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",ceramic,58
Roman Period,art,120
Roman Period,fashion accessory,103
Roman Period,jewellery,92
Sasanian,art,275
Sasanian,organ,246
Sasanian,drawing,205
Second Intermediate Period–Early New Kingdom,fashion accessory,77
Second Intermediate Period–Early New Kingdom,jewellery,75
Song dynasty (960–1279),art,138
Song dynasty (960–1279),ceramic,88
Song dynasty (960–1279),bowl,63
Tang dynasty (618–907),art,197
Tang dynasty (618–907),sculpture,160
Tang dynasty (618–907),statue,122
Third Intermediate Period,art,513
Third Intermediate Period,sculpture,476
Third Intermediate Period,statue,426
Yuan dynasty (1271–1368),art,124
Yuan dynasty (1271–1368),sketch,62
Yuan dynasty (1271–1368),ceramic,57
late Central Javanese period,fashion accessory,65
late Central Javanese period,jewellery,62
late Central Javanese period,brass,61


2025-01-27 01:33:56 - root - INFO - Please check the answer again by reviewing What are the top three most frequently associated labels with artworks from each historical period in The Met's collection, only considering labels linked to 50 or more artworks? Provide me with the period, label, and the associated count., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To determine the top three most frequently associated labels with artworks from each historical period in The Met's collection, considering only labels linked to 50 or more artworks, we combined data from the `objects` and `vision_api_data` tables using the `object_id`. We extracted labels from the `labelAnnotations` field, counted their occurrences for each period, filtered out labels associated with fewer than 50 artworks, and then selected the top three labels for each period based on the count.

Here is the result in CSV format:

```csv
Period,Label,Count
period1:str,label1:str,count1:int
period1:str,label2:str,count2:int
period1:str,label3:str,count3:int
period2:str,label1:str,count1:int
period2:str,label2:str,count2:int
period2:str,label3:str,count3:int
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
period,label_description,label_count
Achaemenid,art,54
Archaic,art,867
Archaic,sculpture,488
Archaic,ceramic,486
Bronze Age,silver,83
Bronze Age,drawing,71
Bronze and Iron Age period,art,83
Bronze and Iron Age period,brass,64
Central Javanese period,jewellery,259
Central Javanese period,fashion accessory,255
Central Javanese period,brass,171
Classical,art,589
Classical,ceramic,417
Classical,vase,388
Classical or Hellenistic,fashion accessory,84
Classical or Hellenistic,jewellery,84
Cypro-Archaic I,art,57
Cypro-Archaic II,art,156
Cypro-Archaic II,sculpture,154
Cypro-Archaic II,stone carving,118
Early Bronze Age,art,66
Early Bronze Age,material,60
Early Dynastic Period,art,59
Early Dynastic Period,wood,57
Early Hellenistic,art,85
Early Hellenistic,sculpture,84
Early Hellenistic,stone carving,60
Early Imperial,fashion accessory,360
Early Imperial,jewellery,341
Early Imperial,art,329
"Early Imperial, Julio-Claudian",art,57
Early Minoan II,wood,53
Early Minoan III,wood,73
Early Minoan III,material,58
Early Minoan III,shape,57
Early to Mid Imperial,vase,78
Early to Mid Imperial,ceramic,74
Eastern Javanese period,art,62
Eastern Javanese period,sculpture,57
Eastern Javanese period,fashion accessory,54
Edo (1615–1868),pattern,282
Edo (1615–1868),art,251
Edo (1615–1868),flooring,194
Edo (1615–1868) or Meiji period (1868–1912),art,77
Edo (1615–1868) or Meiji period (1868–1912),pattern,70
Edo (1615–1868) or Meiji period (1868–1912),flooring,58
Edo period (1615–1868),art,5314
Edo period (1615–1868),sketch,3124
Edo period (1615–1868),drawing,2351
Final Jōmon period (ca. 1000–300 B.C.),wood,77
Final Jōmon period (ca. 1000–300 B.C.),horn,60
Final Jōmon period (ca. 1000–300 B.C.),hand,58
Geometric,art,92
Geometric,ceramic,71
Geometric,jewellery,67
Goryeo dynasty (918–1392),art,95
Goryeo dynasty (918–1392),ceramic,81
Goryeo dynasty (918–1392),bowl,51
Han dynasty (206 B.C.–A.D. 220),art,237
Han dynasty (206 B.C.–A.D. 220),sculpture,187
Han dynasty (206 B.C.–A.D. 220),shape,177
Hellenistic,art,433
Hellenistic,sculpture,317
Hellenistic,ceramic,218
Imperial,art,260
Imperial,sculpture,213
Imperial,fashion accessory,150
Iron Age,art,108
Iron Age,sculpture,96
Iron Age II,art,219
Iron Age II,sculpture,152
Iron Age II,fashion accessory,124
Iron Age III,sculpture,84
Iron Age III,art,83
Iron Age III,fashion accessory,53
Joseon dynasty (1392–1910),art,92
Kamakura period (1185–1333),art,64
Late Archaic,art,60
Late Bronze Age,jewellery,62
Late Bronze Age,fashion accessory,61
Late Bronze Age,brass,53
Late Classical,art,265
Late Classical,ceramic,190
Late Classical,sculpture,149
Late Hellenistic,art,63
Late Hellenistic,sculpture,53
Late Imperial,ceramic,227
Late Imperial,art,225
Late Imperial,vase,199
Late Middle Kingdom–Second Intermediate Period,material,72
Late Middle Kingdom–Second Intermediate Period,stele,58
Late Middle Kingdom–Second Intermediate Period,rock,52
Late Period,art,192
Late Period,sculpture,177
Late Period,statue,123
"Late Period, Saite",drawing,144
"Late Period, Saite",rock,139
"Late Period, Saite",material,130
Late Period–Ptolemaic Period,art,303
Late Period–Ptolemaic Period,sculpture,303
Late Period–Ptolemaic Period,statue,215
Late period,jewellery,59
Meiji period (1868–1912),art,533
Meiji period (1868–1912),painting,258
Meiji period (1868–1912),sketch,232
Mid Imperial,vase,203
Mid Imperial,ceramic,198
Mid Imperial,art,162
Middle Bronze Age–Old Assyrian Trading Colony,art,62
Middle Kingdom,art,945
Middle Kingdom,material,750
Middle Kingdom,sculpture,563
Middle Kingdom–Early New Kingdom,fashion accessory,139
Middle Kingdom–Early New Kingdom,jewellery,126
Middle Kingdom–Early New Kingdom,art,64
Middle Kingdom–Second Intermediate Period,fashion accessory,57
Ming dynasty (1368–1644),art,509
Ming dynasty (1368–1644),pattern,132
Ming dynasty (1368–1644),ceramic,130
Momoyama period (1573–1615),art,58
Muromachi period (1392–1573),art,105
Muromachi period (1392–1573),painting,56
Neo-Assyrian,art,195
Neo-Assyrian,relief,156
Neo-Assyrian,stone carving,152
Neo-Babylonian,material,108
Neo-Babylonian,art,94
Neo-Babylonian,stone carving,90
Neolithic,material,50
New Kingdom,fashion accessory,1010
New Kingdom,jewellery,951
New Kingdom,art,734
"New Kingdom, Amarna Period",material,277
"New Kingdom, Amarna Period",rock,204
"New Kingdom, Amarna Period",stone carving,193
"New Kingdom, Ramesside",art,191
"New Kingdom, Ramesside",fashion accessory,140
"New Kingdom, Ramesside",wood,128
Old Babylonian,relief,89
Old Babylonian,stone carving,85
Old Babylonian,black and white,51
Old Kingdom,ceramic,108
Old Kingdom,art,99
Old Kingdom,hand,74
Old Kingdom–First Intermediate Period,rock,73
Old Kingdom–First Intermediate Period,wood,69
Old Kingdom–First Intermediate Period,art,51
Old Syrian,relief,65
Old Syrian,stone carving,62
Pala period,art,64
Parthian,art,61
Period of Tibetan Empire,fashion accessory,65
Period of Tibetan Empire,jewellery,63
Pre-Columbian,sculpture,73
Pre-Columbian,art,72
Predynastic Period,ceramic,116
Predynastic Period,art,112
Predynastic Period,vase,95
Ptolemaic Period,art,133
Ptolemaic Period,sculpture,124
Ptolemaic Period,statue,70
Ptolemaic Period–Roman Period,fashion accessory,79
Ptolemaic Period–Roman Period,art,64
Ptolemaic Period–Roman Period,jewellery,61
Ptolemaic or Roman Period,fashion accessory,53
Qing dynasty (1644–1911),art,1606
Qing dynasty (1644–1911),pattern,870
Qing dynasty (1644–1911),black and white,783
"Qing dynasty (1644–1911), Kangxi mark and period (1662–1722)",ceramic,51
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",vase,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",art,424
"Qing dynasty (1644–1911), Kangxi period (1662–1722)",blue and white porcelain,366
"Qing dynasty (1644–1911), Qianlong period (1736–95)",art,442
"Qing dynasty (1644–1911), Qianlong period (1736–95)",black and white,350
"Qing dynasty (1644–1911), Qianlong period (1736–95)",vase,310
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",vase,78
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",art,64
"Qing dynasty (1644–1911), Yongzheng period (1723–35)",ceramic,58
Roman Period,art,120
Roman Period,fashion accessory,103
Roman Period,jewellery,92
Sasanian,art,275
Sasanian,organ,246
Sasanian,drawing,205
Second Intermediate Period–Early New Kingdom,fashion accessory,77
Second Intermediate Period–Early New Kingdom,jewellery,75
Song dynasty (960–1279),art,138
Song dynasty (960–1279),ceramic,88
Song dynasty (960–1279),bowl,63
Tang dynasty (618–907),art,197
Tang dynasty (618–907),sculpture,160
Tang dynasty (618–907),statue,122
Third Intermediate Period,art,513
Third Intermediate Period,sculpture,476
Third Intermediate Period,statue,426
Yuan dynasty (1271–1368),art,124
Yuan dynasty (1271–1368),sketch,62
Yuan dynasty (1271–1368),ceramic,57
late Central Javanese period,fashion accessory,65
late Central Javanese period,jewellery,62
late Central Javanese period,brass,61
Current sql:
SELECT period, label_description, label_count
FROM (
    SELECT
        o.period,
        label.description AS label_description,
        COUNT(*) AS label_count,
        ROW_NUMBER() OVER (PARTITION BY o.period ORDER BY COUNT(*) DESC) AS rank_in_period
    FROM
        `bigquery-public-data.the_met.objects` AS o
    INNER JOIN
        `bigquery-public-data.the_met.vision_api_data` AS v
    ON
        o.object_id = v.object_id
    CROSS JOIN
        UNNEST(v.labelAnnotations) AS label
    WHERE
        o.period IS NOT NULL
    GROUP BY
        o.period, label.description
    HAVING
        COUNT(*) >= 50
)
WHERE rank_in_period <= 3
ORDER BY period, rank_in_period;
2025-01-27 01:34:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:34:31 - root - INFO - ```sql
SELECT period, label_description, label_count
FROM (
    SELECT
        o.period,
        label.description AS label_description,
        COUNT(*) AS label_count,
        ROW_NUMBER() OVER (PARTITION BY o.period ORDER BY COUNT(*) DESC) AS rank_in_period
    FROM
        `bigquery-public-data.the_met.objects` AS o
    INNER JOIN
        `bigquery-public-data.the_met.vision_api_data` AS v
    ON
        o.object_id = v.object_id
    CROSS JOIN
        UNNEST(v.labelAnnotations) AS label
    WHERE
        o.period IS NOT NULL
    GROUP BY
        o.period, label.description
    HAVING
        COUNT(*) >= 50
)
WHERE rank_in_period <= 3
ORDER BY period, rank_in_period;
```
2025-01-27 01:34:33 - root - INFO - itercount: 2
2025-01-27 01:34:33 - root - INFO - 0
2025-01-27 01:34:33 - root - INFO - Total iteration counts: 2
