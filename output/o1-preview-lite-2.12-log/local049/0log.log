2025-01-24 07:55:38 - openai._base_client - INFO - Retrying request to /chat/completions in 0.482213 seconds
2025-01-24 07:56:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:56:54 - root - INFO - SQL:
SELECT DISTINCT "valuation"
   FROM "companies_funding"
   LIMIT 100;
Results:
valuation
2000000000
1000000000
10000000000
4000000000
8000000000
3000000000
38000000000
5000000000
7000000000
9000000000
12000000000
11000000000
6000000000
25000000000
33000000000
40000000000
95000000000
32000000000
100000000000
13000000000
15000000000
39000000000
18000000000
14000000000
22000000000
27000000000
17000000000
46000000000
20000000000
180000000000

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT DISTINCT "date_joined"
   FROM "companies_dates"
   LIMIT 100;
Results:
date_joined
2020-09-08T00:00:00.000
2019-05-16T00:00:00.000
2019-07-11T00:00:00.000
2018-10-17T00:00:00.000
2021-06-02T00:00:00.000
2021-04-17T00:00:00.000
2018-03-27T00:00:00.000
2021-01-27T00:00:00.000
2021-06-01T00:00:00.000
2018-05-30T00:00:00.000
2019-02-14T00:00:00.000
2017-06-24T00:00:00.000
2022-02-15T00:00:00.000
2021-11-17T00:00:00.000
2021-10-21T00:00:00.000
2021-09-24T00:00:00.000
2019-02-01T00:00:00.000
2022-01-27T00:00:00.000
2021-06-10T00:00:00.000
2015-01-23T00:00:00.000
2019-08-22T00:00:00.000
2022-01-25T00:00:00.000
2021-07-07T00:00:00.000
2021-12-06T00:00:00.000
2021-08-10T00:00:00.000
2020-12-24T00:00:00.000
2021-01-24T00:00:00.000
2021-10-05T00:00:00.000
2021-12-07T00:00:00.000
2021-12-28T00:00:00.000
2021-09-22T00:00:00.000
2015-01-16T00:00:00.000
2021-09-08T00:00:00.000
2022-01-31T00:00:00.000
2019-06-25T00:00:00.000
2021-10-15T00:00:00.000
2021-11-16T00:00:00.000
2017-04-14T00:00:00.000
2021-06-16T00:00:00.000
2021-04-21T00:00:00.000
2021-08-31T00:00:00.000
2021-03-18T00:00:00.000
2021-06-29T00:00:00.000
2021-05-19T00:00:00.000
2021-11-18T00:00:00.000
2022-01-26T00:00:00.000
2021-02-18T00:00:00.000
2021-09-14T00:00:00.000
2020-03-17T00:00:00.000
2021-05-18T00:00:00.000
2021-11-08T00:00:00.000
2021-12-20T00:00:00.000
2022-01-11T00:00:00.000
2022-02-16T00:00:00.000
2021-03-30T00:00:00.000
2021-05-24T00:00:00.000
2015-03-06T00:00:00.000
2021-11-10T00:00:00.000
2015-04-21T00:00:00.000
2019-10-21T00:00:00.000
2019-05-21T00:00:00.000
2021-07-22T00:00:00.000
2021-08-09T00:00:00.000
2016-04-14T00:00:00.000
2022-02-22T00:00:00.000
2018-07-09T00:00:00.000
2018-10-18T00:00:00.000
2020-01-29T00:00:00.000
2021-09-02T00:00:00.000
2022-03-31T00:00:00.000
2020-09-21T00:00:00.000
2021-12-02T00:00:00.000
2021-12-14T00:00:00.000
2021-03-19T00:00:00.000
2022-03-30T00:00:00.000
2020-01-28T00:00:00.000
2021-11-02T00:00:00.000
2017-07-20T00:00:00.000
2018-05-17T00:00:00.000
2022-04-05T00:00:00.000
2021-09-28T00:00:00.000
2021-12-21T00:00:00.000
2021-06-15T00:00:00.000
2017-12-20T00:00:00.000
2020-11-17T00:00:00.000
2021-09-27T00:00:00.000
2021-02-16T00:00:00.000
2021-09-16T00:00:00.000
2022-03-17T00:00:00.000
2021-01-07T00:00:00.000
2021-12-31T00:00:00.000
2017-10-17T00:00:00.000
2022-03-21T00:00:00.000
2020-11-16T00:00:00.000
2021-07-03T00:00:00.000
2016-05-11T00:00:00.000
2021-01-25T00:00:00.000
2021-09-30T00:00:00.000
2021-04-22T00:00:00.000
2021-12-22T00:00:00.000

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT DISTINCT SUBSTR("date_joined", 1, 4) AS "year_joined"
   FROM "companies_dates"
   LIMIT 100;
Results:
year_joined
2020
2019
2018
2021
2017
2022
2015
2016
2014
2011
2012
2013
2007

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT DISTINCT "industry"
   FROM "companies_industries"
   LIMIT 100;
Results:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT "company_id", "valuation"
   FROM "companies_funding"
   WHERE "valuation" >= 1000000000
   LIMIT 100;
Results:
company_id,valuation
548,2000000000
645,1000000000
615,1000000000
51,10000000000
680,1000000000
457,2000000000
429,2000000000
933,1000000000
568,2000000000
478,2000000000
881,1000000000
189,4000000000
848,1000000000
556,2000000000
999,1000000000
396,2000000000
931,1000000000
364,2000000000
732,1000000000
906,1000000000
72,8000000000
983,1000000000
898,1000000000
844,1000000000
894,1000000000
813,1000000000
743,1000000000
226,4000000000
963,1000000000
764,1000000000
839,1000000000
1033,1000000000
725,1000000000
549,2000000000
667,1000000000
755,1000000000
782,1000000000
175,4000000000
398,2000000000
814,1000000000
436,2000000000
1046,1000000000
565,2000000000
781,1000000000
997,1000000000
194,4000000000
249,3000000000
434,2000000000
1035,1000000000
969,1000000000
1018,1000000000
355,2000000000
934,1000000000
1054,1000000000
901,1000000000
173,4000000000
738,1000000000
422,2000000000
830,1000000000
1004,1000000000
951,1000000000
734,1000000000
1063,1000000000
623,1000000000
846,1000000000
823,1000000000
944,1000000000
1030,1000000000
824,1000000000
930,1000000000
370,2000000000
618,1000000000
456,2000000000
893,1000000000
812,1000000000
1001,1000000000
703,1000000000
884,1000000000
404,2000000000
952,1000000000
625,1000000000
971,1000000000
796,1000000000
909,1000000000
587,2000000000
273,3000000000
771,1000000000
1005,1000000000
758,1000000000
652,1000000000
8,38000000000
760,1000000000
394,2000000000
393,2000000000
870,1000000000
804,1000000000
1041,1000000000
443,2000000000
978,1000000000
612,1000000000

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT cf."company_id", cf."valuation", cd."date_joined"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   WHERE cf."valuation" >= 1000000000
   LIMIT 100;
Results:
company_id,valuation,date_joined
548,2000000000,2015-09-16T00:00:00.000
645,1000000000,2021-05-06T00:00:00.000
615,1000000000,2018-12-20T00:00:00.000
51,10000000000,2021-10-28T00:00:00.000
680,1000000000,2019-06-03T00:00:00.000
457,2000000000,2022-02-01T00:00:00.000
429,2000000000,2021-05-24T00:00:00.000
933,1000000000,2018-05-21T00:00:00.000
568,2000000000,2021-06-15T00:00:00.000
478,2000000000,2018-02-16T00:00:00.000
881,1000000000,2020-12-16T00:00:00.000
189,4000000000,2017-06-24T00:00:00.000
848,1000000000,2021-06-01T00:00:00.000
556,2000000000,2022-02-15T00:00:00.000
999,1000000000,2021-11-17T00:00:00.000
396,2000000000,2021-10-21T00:00:00.000
931,1000000000,2021-09-24T00:00:00.000
364,2000000000,2019-02-01T00:00:00.000
732,1000000000,2022-01-27T00:00:00.000
906,1000000000,2021-06-10T00:00:00.000
72,8000000000,2015-01-23T00:00:00.000
983,1000000000,2019-08-22T00:00:00.000
898,1000000000,2022-01-25T00:00:00.000
844,1000000000,2021-07-07T00:00:00.000
894,1000000000,2021-12-06T00:00:00.000
813,1000000000,2021-08-10T00:00:00.000
743,1000000000,2020-12-24T00:00:00.000
226,4000000000,2021-01-24T00:00:00.000
963,1000000000,2021-10-05T00:00:00.000
764,1000000000,2021-12-07T00:00:00.000
839,1000000000,2021-12-28T00:00:00.000
1033,1000000000,2021-01-27T00:00:00.000
725,1000000000,2022-01-25T00:00:00.000
549,2000000000,2021-09-22T00:00:00.000
667,1000000000,2015-01-16T00:00:00.000
755,1000000000,2021-09-08T00:00:00.000
782,1000000000,2022-01-31T00:00:00.000
175,4000000000,2019-06-25T00:00:00.000
398,2000000000,2021-10-15T00:00:00.000
814,1000000000,2021-11-16T00:00:00.000
436,2000000000,2017-04-14T00:00:00.000
1046,1000000000,2021-06-16T00:00:00.000
565,2000000000,2021-04-21T00:00:00.000
781,1000000000,2021-08-31T00:00:00.000
997,1000000000,2021-12-06T00:00:00.000
194,4000000000,2021-03-18T00:00:00.000
249,3000000000,2021-06-29T00:00:00.000
434,2000000000,2021-05-19T00:00:00.000
1035,1000000000,2021-11-18T00:00:00.000
969,1000000000,2022-01-26T00:00:00.000
1018,1000000000,2021-02-18T00:00:00.000
355,2000000000,2021-09-14T00:00:00.000
934,1000000000,2020-03-17T00:00:00.000
1054,1000000000,2021-05-18T00:00:00.000
901,1000000000,2021-11-08T00:00:00.000
173,4000000000,2021-12-20T00:00:00.000
738,1000000000,2022-01-11T00:00:00.000
422,2000000000,2022-02-16T00:00:00.000
830,1000000000,2021-03-30T00:00:00.000
1004,1000000000,2021-05-24T00:00:00.000
951,1000000000,2015-03-06T00:00:00.000
734,1000000000,2022-01-27T00:00:00.000
1063,1000000000,2021-11-10T00:00:00.000
623,1000000000,2015-04-21T00:00:00.000
846,1000000000,2019-10-21T00:00:00.000
823,1000000000,2019-05-21T00:00:00.000
944,1000000000,2021-07-22T00:00:00.000
1030,1000000000,2021-08-09T00:00:00.000
824,1000000000,2016-04-14T00:00:00.000
930,1000000000,2022-02-22T00:00:00.000
370,2000000000,2018-07-09T00:00:00.000
618,1000000000,2018-10-18T00:00:00.000
456,2000000000,2020-01-29T00:00:00.000
893,1000000000,2021-09-02T00:00:00.000
812,1000000000,2022-03-31T00:00:00.000
1001,1000000000,2020-09-21T00:00:00.000
703,1000000000,2021-12-02T00:00:00.000
884,1000000000,2021-12-14T00:00:00.000
404,2000000000,2021-03-19T00:00:00.000
952,1000000000,2022-03-30T00:00:00.000
625,1000000000,2020-01-28T00:00:00.000
971,1000000000,2021-11-02T00:00:00.000
796,1000000000,2017-07-20T00:00:00.000
909,1000000000,2022-01-27T00:00:00.000
587,2000000000,2018-05-17T00:00:00.000
273,3000000000,2022-04-05T00:00:00.000
771,1000000000,2021-09-28T00:00:00.000
1005,1000000000,2021-01-07T00:00:00.000
758,1000000000,2021-12-21T00:00:00.000
652,1000000000,2021-06-15T00:00:00.000
8,38000000000,2017-12-20T00:00:00.000
760,1000000000,2020-11-17T00:00:00.000
394,2000000000,2022-01-31T00:00:00.000
393,2000000000,2021-09-27T00:00:00.000
870,1000000000,2021-02-16T00:00:00.000
804,1000000000,2021-09-16T00:00:00.000
1041,1000000000,2021-11-02T00:00:00.000
443,2000000000,2022-03-17T00:00:00.000
978,1000000000,2021-01-07T00:00:00.000
612,1000000000,2021-12-31T00:00:00.000

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT cf."company_id", ci."industry", cf."valuation"
   FROM "companies_funding" AS cf
   JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
   WHERE cf."valuation" >= 1000000000
   LIMIT 100;
Results:
company_id,industry,valuation
548,Auto & transportation,2000000000
645,Health,1000000000
615,Auto & transportation,1000000000
51,Fintech,10000000000
680,Auto & transportation,1000000000
457,Fintech,2000000000
429,Fintech,2000000000
933,Mobile & telecommunications,1000000000
568,Internet software & services,2000000000
478,Consumer & retail,2000000000
881,Other,1000000000
189,Health,4000000000
848,Fintech,1000000000
556,Internet software & services,2000000000
556,Internet software & services,2000000000
999,Internet software & services,1000000000
396,Fintech,2000000000
931,Consumer & retail,1000000000
364,E-commerce & direct-to-consumer,2000000000
732,Fintech,1000000000
906,Hardware,1000000000
72,Hardware,8000000000
983,Fintech,1000000000
983,Fintech,1000000000
898,Internet software & services,1000000000
844,Fintech,1000000000
894,Fintech,1000000000
813,Fintech,1000000000
743,Other,1000000000
226,Mobile & telecommunications,4000000000
963,Fintech,1000000000
764,Fintech,1000000000
839,E-commerce & direct-to-consumer,1000000000
1033,Internet software & services,1000000000
725,Health,1000000000
549,Artificial intelligence,2000000000
667,Mobile & telecommunications,1000000000
755,Fintech,1000000000
782,Fintech,1000000000
175,Fintech,4000000000
398,Fintech,2000000000
814,E-commerce & direct-to-consumer,1000000000
436,Artificial intelligence,2000000000
1046,Artificial intelligence,1000000000
565,Artificial intelligence,2000000000
781,Internet software & services,1000000000
997,E-commerce & direct-to-consumer,1000000000
194,Internet software & services,4000000000
249,Fintech,3000000000
434,Auto & transportation,2000000000
1035,Cybersecurity,1000000000
969,Data management & analytics,1000000000
1018,Other,1000000000
355,Internet software & services,2000000000
934,E-commerce & direct-to-consumer,1000000000
1054,Fintech,1000000000
901,Cybersecurity,1000000000
173,Internet software & services,4000000000
738,Fintech,1000000000
422,Internet software & services,2000000000
830,Health,1000000000
1004,Other,1000000000
951,E-commerce & direct-to-consumer,1000000000
951,E-commerce & direct-to-consumer,1000000000
734,Internet software & services,1000000000
1063,Fintech,1000000000
623,Fintech,1000000000
846,Data management & analytics,1000000000
823,Fintech,1000000000
944,Fintech,1000000000
1030,Artificial intelligence,1000000000
824,E-commerce & direct-to-consumer,1000000000
930,Internet software & services,1000000000
370,Data management & analytics,2000000000
618,E-commerce & direct-to-consumer,1000000000
456,Cybersecurity,2000000000
893,E-commerce & direct-to-consumer,1000000000
812,Other,1000000000
1001,Other,1000000000
703,Cybersecurity,1000000000
884,Health,1000000000
404,Cybersecurity,2000000000
952,Internet software & services,1000000000
625,Internet software & services,1000000000
971,Internet software & services,1000000000
796,Edtech,1000000000
909,Fintech,1000000000
587,Artificial intelligence,2000000000
273,Health,3000000000
771,Internet software & services,1000000000
1005,Data management & analytics,1000000000
758,Internet software & services,1000000000
652,Internet software & services,1000000000
8,Consumer & retail,38000000000
760,Mobile & telecommunications,1000000000
394,Health,2000000000
393,Fintech,2000000000
870,Other,1000000000
804,Artificial intelligence,1000000000
1041,Internet software & services,1000000000

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT cf."company_id", cf."valuation", cd."date_joined"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   WHERE cf."valuation" >= 1000000000
     AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
   LIMIT 100;
Results:
company_id,valuation,date_joined
645,1000000000,2021-05-06T00:00:00.000
51,10000000000,2021-10-28T00:00:00.000
680,1000000000,2019-06-03T00:00:00.000
429,2000000000,2021-05-24T00:00:00.000
568,2000000000,2021-06-15T00:00:00.000
881,1000000000,2020-12-16T00:00:00.000
848,1000000000,2021-06-01T00:00:00.000
999,1000000000,2021-11-17T00:00:00.000
396,2000000000,2021-10-21T00:00:00.000
931,1000000000,2021-09-24T00:00:00.000
364,2000000000,2019-02-01T00:00:00.000
906,1000000000,2021-06-10T00:00:00.000
983,1000000000,2019-08-22T00:00:00.000
844,1000000000,2021-07-07T00:00:00.000
894,1000000000,2021-12-06T00:00:00.000
813,1000000000,2021-08-10T00:00:00.000
743,1000000000,2020-12-24T00:00:00.000
226,4000000000,2021-01-24T00:00:00.000
963,1000000000,2021-10-05T00:00:00.000
764,1000000000,2021-12-07T00:00:00.000
839,1000000000,2021-12-28T00:00:00.000
1033,1000000000,2021-01-27T00:00:00.000
549,2000000000,2021-09-22T00:00:00.000
755,1000000000,2021-09-08T00:00:00.000
175,4000000000,2019-06-25T00:00:00.000
398,2000000000,2021-10-15T00:00:00.000
814,1000000000,2021-11-16T00:00:00.000
1046,1000000000,2021-06-16T00:00:00.000
565,2000000000,2021-04-21T00:00:00.000
781,1000000000,2021-08-31T00:00:00.000
997,1000000000,2021-12-06T00:00:00.000
194,4000000000,2021-03-18T00:00:00.000
249,3000000000,2021-06-29T00:00:00.000
434,2000000000,2021-05-19T00:00:00.000
1035,1000000000,2021-11-18T00:00:00.000
1018,1000000000,2021-02-18T00:00:00.000
355,2000000000,2021-09-14T00:00:00.000
934,1000000000,2020-03-17T00:00:00.000
1054,1000000000,2021-05-18T00:00:00.000
901,1000000000,2021-11-08T00:00:00.000
173,4000000000,2021-12-20T00:00:00.000
830,1000000000,2021-03-30T00:00:00.000
1004,1000000000,2021-05-24T00:00:00.000
1063,1000000000,2021-11-10T00:00:00.000
846,1000000000,2019-10-21T00:00:00.000
823,1000000000,2019-05-21T00:00:00.000
944,1000000000,2021-07-22T00:00:00.000
1030,1000000000,2021-08-09T00:00:00.000
456,2000000000,2020-01-29T00:00:00.000
893,1000000000,2021-09-02T00:00:00.000
1001,1000000000,2020-09-21T00:00:00.000
703,1000000000,2021-12-02T00:00:00.000
884,1000000000,2021-12-14T00:00:00.000
404,2000000000,2021-03-19T00:00:00.000
625,1000000000,2020-01-28T00:00:00.000
971,1000000000,2021-11-02T00:00:00.000
771,1000000000,2021-09-28T00:00:00.000
1005,1000000000,2021-01-07T00:00:00.000
758,1000000000,2021-12-21T00:00:00.000
652,1000000000,2021-06-15T00:00:00.000
760,1000000000,2020-11-17T00:00:00.000
393,2000000000,2021-09-27T00:00:00.000
870,1000000000,2021-02-16T00:00:00.000
804,1000000000,2021-09-16T00:00:00.000
1041,1000000000,2021-11-02T00:00:00.000
978,1000000000,2021-01-07T00:00:00.000
612,1000000000,2021-12-31T00:00:00.000
421,2000000000,2020-11-16T00:00:00.000
449,2000000000,2021-07-03T00:00:00.000
1022,1000000000,2021-06-02T00:00:00.000
1022,1000000000,2021-06-02T00:00:00.000
644,1000000000,2021-01-25T00:00:00.000
718,1000000000,2021-09-30T00:00:00.000
920,1000000000,2021-08-10T00:00:00.000
1048,1000000000,2021-09-30T00:00:00.000
1024,1000000000,2021-04-22T00:00:00.000
929,1000000000,2021-12-22T00:00:00.000
863,1000000000,2021-12-07T00:00:00.000
662,1000000000,2020-12-21T00:00:00.000
1027,1000000000,2021-06-24T00:00:00.000
783,1000000000,2021-03-26T00:00:00.000
592,2000000000,2021-11-17T00:00:00.000
1023,1000000000,2021-01-26T00:00:00.000
1051,1000000000,2021-11-03T00:00:00.000
633,1000000000,2021-04-07T00:00:00.000
635,1000000000,2021-06-02T00:00:00.000
697,1000000000,2021-12-20T00:00:00.000
886,1000000000,2021-03-30T00:00:00.000
798,1000000000,2021-02-11T00:00:00.000
1008,1000000000,2021-11-08T00:00:00.000
701,1000000000,2020-12-31T00:00:00.000
825,1000000000,2021-10-13T00:00:00.000
344,3000000000,2021-06-29T00:00:00.000
643,1000000000,2021-12-15T00:00:00.000
509,2000000000,2021-08-04T00:00:00.000
979,1000000000,2021-02-25T00:00:00.000
1031,1000000000,2021-10-07T00:00:00.000
817,1000000000,2021-05-04T00:00:00.000
943,1000000000,2019-03-22T00:00:00.000
975,1000000000,2021-04-30T00:00:00.000

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT ci."industry", COUNT(*) AS "num_unicorns"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
   WHERE cf."valuation" >= 1000000000
     AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
   GROUP BY ci."industry"
   ORDER BY "num_unicorns" DESC
   LIMIT 100;
Results:
industry,num_unicorns
Fintech,181
Internet software & services,157
E-commerce & direct-to-consumer,76
Health,53
Artificial intelligence,53
Other,44
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Auto & transportation,16
Hardware,15
Consumer & retail,11
Travel,7

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT ci."industry", COUNT(*) AS "num_unicorns"
    FROM "companies_funding" AS cf
    JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
    JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
    WHERE cf."valuation" >= 1000000000
      AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
    GROUP BY ci."industry"
    ORDER BY "num_unicorns" DESC
    LIMIT 1;
Results:
industry,num_unicorns
Fintech,181

2025-01-24 07:56:54 - root - INFO - SQL:
SELECT AVG("yearly_count") AS "average_new_unicorns_per_year"
    FROM (
      SELECT SUBSTR(cd."date_joined", 1, 4) AS "year", COUNT(*) AS "yearly_count"
      FROM "companies_funding" AS cf
      JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
      JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
      WHERE cf."valuation" >= 1000000000
        AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
        AND ci."industry" = 'Fintech'  -- Replace 'Fintech' with the actual top industry
      GROUP BY "year"
    )
    LIMIT 100;
Results:
average_new_unicorns_per_year
60.333333333333336

2025-01-24 07:56:54 - root - INFO - itercount: 0
2025-01-24 07:56:54 - root - INFO - Table: pizza_namesDDL:
CREATE TABLE "pizza_names" (
"pizza_id" INTEGER,
  "pizza_name" TEXT
)
Table: companies_fundingDDL:
CREATE TABLE "companies_funding" (
"company_id" INTEGER,
  "valuation" INTEGER,
  "funding" INTEGER,
  "select_investors" TEXT
)
Table: pizza_customer_ordersDDL:
CREATE TABLE "pizza_customer_orders" (
"order_id" INTEGER,
  "customer_id" INTEGER,
  "pizza_id" INTEGER,
  "exclusions" TEXT,
  "extras" TEXT,
  "order_time" TEXT
)
Table: pizza_toppingsDDL:
CREATE TABLE "pizza_toppings" (
"topping_id" INTEGER,
  "topping_name" TEXT
)
Table: treesDDL:
CREATE TABLE "trees" (
"idx" INTEGER,
  "tree_id" INTEGER,
  "tree_dbh" INTEGER,
  "stump_diam" INTEGER,
  "status" TEXT,
  "health" TEXT,
  "spc_latin" TEXT,
  "spc_common" TEXT,
  "address" TEXT,
  "zipcode" INTEGER,
  "borocode" INTEGER,
  "boroname" TEXT,
  "nta_name" TEXT,
  "state" TEXT,
  "latitude" REAL,
  "longitude" REAL
)
Table: pizza_recipesDDL:
CREATE TABLE "pizza_recipes" (
"pizza_id" INTEGER,
  "toppings" TEXT
)
Table: statisticsDDL:
CREATE TABLE "statistics" (
"date" TEXT,
  "state" TEXT,
  "total_cases" INTEGER,
  "total_deaths" INTEGER
)
Table: income_treesDDL:
CREATE TABLE "income_trees" (
"zipcode" INTEGER,
  "Estimate_Total" INTEGER,
  "Margin_of_Error_Total" INTEGER,
  "Estimate_Median_income" INTEGER,
  "Margin_of_Error_Median_income" INTEGER,
  "Estimate_Mean_income" INTEGER,
  "Margin_of_Error_Mean_income" INTEGER
)
Table: pizza_clean_runner_ordersDDL:
CREATE TABLE "pizza_clean_runner_orders" (
"order_id" INTEGER,
  "runner_id" INTEGER,
  "pickup_time" TEXT,
  "distance" REAL,
  "duration" REAL,
  "cancellation" TEXT
)
Table: pizza_runner_ordersDDL:
CREATE TABLE "pizza_runner_orders" (
"order_id" INTEGER,
  "runner_id" INTEGER,
  "pickup_time" TEXT,
  "distance" TEXT,
  "duration" TEXT,
  "cancellation" TEXT
)
Table: word_listDDL:
CREATE TABLE "word_list" (
"words" TEXT
)
Table: companies_datesDDL:
CREATE TABLE "companies_dates" (
"company_id" INTEGER,
  "date_joined" TEXT,
  "year_founded" INTEGER
)
Table: pizza_get_extrasDDL:
CREATE TABLE "pizza_get_extras" (
"row_id" INTEGER,
  "order_id" INTEGER,
  "extras" INTEGER,
  "extras_count" INTEGER
)
Table: pizza_get_exclusionsDDL:
CREATE TABLE "pizza_get_exclusions" (
"row_id" INTEGER,
  "order_id" INTEGER,
  "exclusions" INTEGER,
  "total_exclusions" INTEGER
)
Table: pizza_clean_customer_ordersDDL:
CREATE TABLE "pizza_clean_customer_orders" (
"order_id" INTEGER,
  "customer_id" INTEGER,
  "pizza_id" INTEGER,
  "exclusions" TEXT,
  "extras" TEXT,
  "order_time" TEXT
)
Table: companies_industriesDDL:
CREATE TABLE "companies_industries" (
"company_id" INTEGER,
  "industry" TEXT
)
Table: pizza_runnersDDL:
CREATE TABLE "pizza_runners" (
"runner_id" INTEGER,
  "registration_date" TEXT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['pizza_names', 'companies_funding', 'pizza_customer_orders', 'pizza_toppings', 'trees', 'pizza_recipes', 'statistics', 'income_trees', 'pizza_clean_runner_orders', 'pizza_runner_orders', 'word_list', 'companies_dates', 'pizza_get_extras', 'pizza_get_exclusions', 'pizza_clean_customer_orders', 'companies_industries', 'pizza_runners']
Begin Exploring Related Columns
First, let's consider which tables and columns are relevant to the task:

- **Table:** `"companies_funding"`
  - **`"company_id"`**: Used to uniquely identify each company and join with other tables.
  - **`"valuation"`**: Potential usage to determine if a company is a unicorn (e.g., valuation â‰¥ 1,000,000,000).
  
- **Table:** `"companies_dates"`
  - **`"company_id"`**: Used to join with other tables.
  - **`"date_joined"`**: Potential usage to determine when the company achieved unicorn status.
  - **`"year_founded"`**: Potential usage to determine the founding year of the company.
  
- **Table:** `"companies_industries"`
  - **`"company_id"`**: Used to join with other tables.
  - **`"industry"`**: Potential usage to determine the industry of each company.

**Conditions that may be used:**

- `WHERE "valuation" >= 1000000000` to identify unicorn companies.
- `WHERE "date_joined"` between '2019-01-01' and '2021-12-31' to focus on the specified time period.
- Grouping by `"industry"` to find the top industry by number of new unicorns.

---

Here are 10 SQLite SQL queries to explore the data:

1. **Get distinct valuations to understand valuation ranges:**

   ```sql
   SELECT DISTINCT "valuation"
   FROM "companies_funding"
   LIMIT 100;
   ```

2. **Get distinct dates when companies joined to see the date formats:**

   ```sql
   SELECT DISTINCT "date_joined"
   FROM "companies_dates"
   LIMIT 100;
   ```

3. **Extract years from `"date_joined"` to see which years are present:**

   ```sql
   SELECT DISTINCT SUBSTR("date_joined", 1, 4) AS "year_joined"
   FROM "companies_dates"
   LIMIT 100;
   ```

4. **Get distinct industries to see what industries are present:**

   ```sql
   SELECT DISTINCT "industry"
   FROM "companies_industries"
   LIMIT 100;
   ```

5. **List companies with valuations equal to or exceeding $1,000,000,000 (potential unicorns):**

   ```sql
   SELECT "company_id", "valuation"
   FROM "companies_funding"
   WHERE "valuation" >= 1000000000
   LIMIT 100;
   ```

6. **List potential unicorn companies along with their join dates:**

   ```sql
   SELECT cf."company_id", cf."valuation", cd."date_joined"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   WHERE cf."valuation" >= 1000000000
   LIMIT 100;
   ```

7. **List industries of potential unicorn companies:**

   ```sql
   SELECT cf."company_id", ci."industry", cf."valuation"
   FROM "companies_funding" AS cf
   JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
   WHERE cf."valuation" >= 1000000000
   LIMIT 100;
   ```

8. **List unicorn companies that became unicorns between 2019 and 2021:**

   ```sql
   SELECT cf."company_id", cf."valuation", cd."date_joined"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   WHERE cf."valuation" >= 1000000000
     AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
   LIMIT 100;
   ```

9. **Count the number of new unicorns per industry between 2019 and 2021:**

   ```sql
   SELECT ci."industry", COUNT(*) AS "num_unicorns"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
   WHERE cf."valuation" >= 1000000000
     AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
   GROUP BY ci."industry"
   ORDER BY "num_unicorns" DESC
   LIMIT 100;
   ```

10. **Calculate the average number of new unicorns per year in the top industry:**

    First, identify the top industry:

    ```sql
    SELECT ci."industry", COUNT(*) AS "num_unicorns"
    FROM "companies_funding" AS cf
    JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
    JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
    WHERE cf."valuation" >= 1000000000
      AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
    GROUP BY ci."industry"
    ORDER BY "num_unicorns" DESC
    LIMIT 1;
    ```

    Assuming the top industry is identified (e.g., **`"Fintech"`**), calculate the average number of new unicorns per year in that industry:

    ```sql
    SELECT AVG("yearly_count") AS "average_new_unicorns_per_year"
    FROM (
      SELECT SUBSTR(cd."date_joined", 1, 4) AS "year", COUNT(*) AS "yearly_count"
      FROM "companies_funding" AS cf
      JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
      JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
      WHERE cf."valuation" >= 1000000000
        AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
        AND ci."industry" = 'Fintech'  -- Replace 'Fintech' with the actual top industry
      GROUP BY "year"
    )
    LIMIT 100;
    ```

These queries will help understand the data and calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021.Query:
SELECT DISTINCT "valuation"
   FROM "companies_funding"
   LIMIT 100;
Answer:
valuation
2000000000
1000000000
10000000000
4000000000
8000000000
3000000000
38000000000
5000000000
7000000000
9000000000
12000000000
11000000000
6000000000
25000000000
33000000000
40000000000
95000000000
32000000000
100000000000
13000000000
15000000000
39000000000
18000000000
14000000000
22000000000
27000000000
17000000000
46000000000
20000000000
180000000000
Query:
SELECT DISTINCT "date_joined"
   FROM "companies_dates"
   LIMIT 100;
Answer:
date_joined
2020-09-08T00:00:00.000
2019-05-16T00:00:00.000
2019-07-11T00:00:00.000
2018-10-17T00:00:00.000
2021-06-02T00:00:00.000
2021-04-17T00:00:00.000
2018-03-27T00:00:00.000
2021-01-27T00:00:00.000
2021-06-01T00:00:00.000
2018-05-30T00:00:00.000
2019-02-14T00:00:00.000
2017-06-24T00:00:00.000
2022-02-15T00:00:00.000
2021-11-17T00:00:00.000
2021-10-21T00:00:00.000
2021-09-24T00:00:00.000
2019-02-01T00:00:00.000
2022-01-27T00:00:00.000
2021-06-10T00:00:00.000
2015-01-23T00:00:00.000
2019-08-22T00:00:00.000
2022-01-25T00:00:00.000
2021-07-07T00:00:00.000
2021-12-06T00:00:00.000
2021-08-10T00:00:00.000
2020-12-24T00:00:00.000
2021-01-24T00:00:00.000
2021-10-05T00:00:00.000
2021-12-07T00:00:00.000
2021-12-28T00:00:00.000
2021-09-22T00:00:00.000
2015-01-16T00:00:00.000
2021-09-08T00:00:00.000
2022-01-31T00:00:00.000
2019-06-25T00:00:00.000
2021-10-15T00:00:00.000
2021-11-16T00:00:00.000
2017-04-14T00:00:00.000
2021-06-16T00:00:00.000
2021-04-21T00:00:00.000
2021-08-31T00:00:00.000
2021-03-18T00:00:00.000
2021-06-29T00:00:00.000
2021-05-19T00:00:00.000
2021-11-18T00:00:00.000
2022-01-26T00:00:00.000
2021-02-18T00:00:00.000
2021-09-14T00:00:00.000
2020-03-17T00:00:00.000
2021-05-18T00:00:00.000
2021-11-08T00:00:00.000
2021-12-20T00:00:00.000
2022-01-11T00:00:00.000
2022-02-16T00:00:00.000
2021-03-30T00:00:00.000
2021-05-24T00:00:00.000
2015-03-06T00:00:00.000
2021-11-10T00:00:00.000
2015-04-21T00:00:00.000
2019-10-21T00:00:00.000
2019-05-21T00:00:00.000
2021-07-22T00:00:00.000
2021-08-09T00:00:00.000
2016-04-14T00:00:00.000
2022-02-22T00:00:00.000
2018-07-09T00:00:00.000
2018-10-18T00:00:00.000
2020-01-29T00:00:00.000
2021-09-02T00:00:00.000
2022-03-31T00:00:00.000
2020-09-21T00:00:00.000
2021-12-02T00:00:00.000
2021-12-14T00:00:00.000
2021-03-19T00:00:00.000
2022-03-30T00:00:00.000
2020-01-28T00:00:00.000
2021-11-02T00:00:00.000
2017-07-20T00:00:00.000
2018-05-17T00:00:00.000
2022-04-05T00:00:00.000
2021-09-28T00:00:00.000
2021-12-21T00:00:00.000
2021-06-15T00:00:00.000
2017-12-20T00:00:00.000
2020-11-17T00:00:00.000
2021-09-27T00:00:00.000
2021-02-16T00:00:00.000
2021-09-16T00:00:00.000
2022-03-17T00:00:00.000
2021-01-07T00:00:00.000
2021-12-31T00:00:00.000
2017-10-17T00:00:00.000
2022-03-21T00:00:00.000
2020-11-16T00:00:00.000
2021-07-03T00:00:00.000
2016-05-11T00:00:00.000
2021-01-25T00:00:00.000
2021-09-30T00:00:00.000
2021-04-22T00:00:00.000
2021-12-22T00:00:00.000
Query:
SELECT DISTINCT SUBSTR("date_joined", 1, 4) AS "year_joined"
   FROM "companies_dates"
   LIMIT 100;
Answer:
year_joined
2020
2019
2018
2021
2017
2022
2015
2016
2014
2011
2012
2013
2007
Query:
SELECT DISTINCT "industry"
   FROM "companies_industries"
   LIMIT 100;
Answer:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel
Query:
SELECT "company_id", "valuation"
   FROM "companies_funding"
   WHERE "valuation" >= 1000000000
   LIMIT 100;
Answer:
company_id,valuation
548,2000000000
645,1000000000
615,1000000000
51,10000000000
680,1000000000
457,2000000000
429,2000000000
933,1000000000
568,2000000000
478,2000000000
881,1000000000
189,4000000000
848,1000000000
556,2000000000
999,1000000000
396,2000000000
931,1000000000
364,2000000000
732,1000000000
906,1000000000
72,8000000000
983,1000000000
898,1000000000
844,1000000000
894,1000000000
813,1000000000
743,1000000000
226,4000000000
963,1000000000
764,1000000000
839,1000000000
1033,1000000000
725,1000000000
549,2000000000
667,1000000000
755,1000000000
782,1000000000
175,4000000000
398,2000000000
814,1000000000
436,2000000000
1046,1000000000
565,2000000000
781,1000000000
997,1000000000
194,4000000000
249,3000000000
434,2000000000
1035,1000000000
969,1000000000
1018,1000000000
355,2000000000
934,1000000000
1054,1000000000
901,1000000000
173,4000000000
738,1000000000
422,2000000000
830,1000000000
1004,1000000000
951,1000000000
734,1000000000
1063,1000000000
623,1000000000
846,1000000000
823,1000000000
944,1000000000
1030,1000000000
824,1000000000
930,1000000000
370,2000000000
618,1000000000
456,2000000000
893,1000000000
812,1000000000
1001,1000000000
703,1000000000
884,1000000000
404,2000000000
952,1000000000
625,1000000000
971,1000000000
796,1000000000
909,1000000000
587,2000000000
273,3000000000
771,1000000000
1005,1000000000
758,1000000000
652,1000000000
8,38000000000
760,1000000000
394,2000000000
393,2000000000
870,1000000000
804,1000000000
1041,1000000000
443,2000000000
978,1000000000
612,1000000000
Query:
SELECT cf."company_id", cf."valuation", cd."date_joined"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   WHERE cf."valuation" >= 1000000000
   LIMIT 100;
Answer:
company_id,valuation,date_joined
548,2000000000,2015-09-16T00:00:00.000
645,1000000000,2021-05-06T00:00:00.000
615,1000000000,2018-12-20T00:00:00.000
51,10000000000,2021-10-28T00:00:00.000
680,1000000000,2019-06-03T00:00:00.000
457,2000000000,2022-02-01T00:00:00.000
429,2000000000,2021-05-24T00:00:00.000
933,1000000000,2018-05-21T00:00:00.000
568,2000000000,2021-06-15T00:00:00.000
478,2000000000,2018-02-16T00:00:00.000
881,1000000000,2020-12-16T00:00:00.000
189,4000000000,2017-06-24T00:00:00.000
848,1000000000,2021-06-01T00:00:00.000
556,2000000000,2022-02-15T00:00:00.000
999,1000000000,2021-11-17T00:00:00.000
396,2000000000,2021-10-21T00:00:00.000
931,1000000000,2021-09-24T00:00:00.000
364,2000000000,2019-02-01T00:00:00.000
732,1000000000,2022-01-27T00:00:00.000
906,1000000000,2021-06-10T00:00:00.000
72,8000000000,2015-01-23T00:00:00.000
983,1000000000,2019-08-22T00:00:00.000
898,1000000000,2022-01-25T00:00:00.000
844,1000000000,2021-07-07T00:00:00.000
894,1000000000,2021-12-06T00:00:00.000
813,1000000000,2021-08-10T00:00:00.000
743,1000000000,2020-12-24T00:00:00.000
226,4000000000,2021-01-24T00:00:00.000
963,1000000000,2021-10-05T00:00:00.000
764,1000000000,2021-12-07T00:00:00.000
839,1000000000,2021-12-28T00:00:00.000
1033,1000000000,2021-01-27T00:00:00.000
725,1000000000,2022-01-25T00:00:00.000
549,2000000000,2021-09-22T00:00:00.000
667,1000000000,2015-01-16T00:00:00.000
755,1000000000,2021-09-08T00:00:00.000
782,1000000000,2022-01-31T00:00:00.000
175,4000000000,2019-06-25T00:00:00.000
398,2000000000,2021-10-15T00:00:00.000
814,1000000000,2021-11-16T00:00:00.000
436,2000000000,2017-04-14T00:00:00.000
1046,1000000000,2021-06-16T00:00:00.000
565,2000000000,2021-04-21T00:00:00.000
781,1000000000,2021-08-31T00:00:00.000
997,1000000000,2021-12-06T00:00:00.000
194,4000000000,2021-03-18T00:00:00.000
249,3000000000,2021-06-29T00:00:00.000
434,2000000000,2021-05-19T00:00:00.000
1035,1000000000,2021-11-18T00:00:00.000
969,1000000000,2022-01-26T00:00:00.000
1018,1000000000,2021-02-18T00:00:00.000
355,2000000000,2021-09-14T00:00:00.000
934,1000000000,2020-03-17T00:00:00.000
1054,1000000000,2021-05-18T00:00:00.000
901,1000000000,2021-11-08T00:00:00.000
173,4000000000,2021-12-20T00:00:00.000
738,1000000000,2022-01-11T00:00:00.000
422,2000000000,2022-02-16T00:00:00.000
830,1000000000,2021-03-30T00:00:00.000
1004,1000000000,2021-05-24T00:00:00.000
951,1000000000,2015-03-06T00:00:00.000
734,1000000000,2022-01-27T00:00:00.000
1063,1000000000,2021-11-10T00:00:00.000
623,1000000000,2015-04-21T00:00:00.000
846,1000000000,2019-10-21T00:00:00.000
823,1000000000,2019-05-21T00:00:00.000
944,1000000000,2021-07-22T00:00:00.000
1030,1000000000,2021-08-09T00:00:00.000
824,1000000000,2016-04-14T00:00:00.000
930,1000000000,2022-02-22T00:00:00.000
370,2000000000,2018-07-09T00:00:00.000
618,1000000000,2018-10-18T00:00:00.000
456,2000000000,2020-01-29T00:00:00.000
893,1000000000,2021-09-02T00:00:00.000
812,1000000000,2022-03-31T00:00:00.000
1001,1000000000,2020-09-21T00:00:00.000
703,1000000000,2021-12-02T00:00:00.000
884,1000000000,2021-12-14T00:00:00.000
404,2000000000,2021-03-19T00:00:00.000
952,1000000000,2022-03-30T00:00:00.000
625,1000000000,2020-01-28T00:00:00.000
971,1000000000,2021-11-02T00:00:00.000
796,1000000000,2017-07-20T00:00:00.000
909,1000000000,2022-01-27T00:00:00.000
587,2000000000,2018-05-17T00:00:00.000
273,3000000000,2022-04-05T00:00:00.000
771,1000000000,2021-09-28T00:00:00.000
1005,1000000000,2021-01-07T00:00:00.000
758,1000000000,2021-12-21T00:00:00.000
652,1000000000,2021-06-15T00:00:00.000
8,38000000000,2017-12-20T00:00:00.000
760,1000000000,2020-11-17T00:00:00.000
394,2000000000,2022-01-31T00:00:00.000
393,2000000000,2021-09-27T00:00:00.000
870,1000000000,2021-02-16T00:00:00.000
804,1000000000,2021-09-16T00:00:00.000
1041,1000000000,2021-11-02T00:00:00.000
443,2000000000,2022-03-17T00:00:00.000
978,1000000000,2021-01-07T00:00:00.000
612,1000000000,2021-12-31T00:00:00.000
Query:
SELECT cf."company_id", ci."industry", cf."valuation"
   FROM "companies_funding" AS cf
   JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
   WHERE cf."valuation" >= 1000000000
   LIMIT 100;
Answer:
company_id,industry,valuation
548,Auto & transportation,2000000000
645,Health,1000000000
615,Auto & transportation,1000000000
51,Fintech,10000000000
680,Auto & transportation,1000000000
457,Fintech,2000000000
429,Fintech,2000000000
933,Mobile & telecommunications,1000000000
568,Internet software & services,2000000000
478,Consumer & retail,2000000000
881,Other,1000000000
189,Health,4000000000
848,Fintech,1000000000
556,Internet software & services,2000000000
556,Internet software & services,2000000000
999,Internet software & services,1000000000
396,Fintech,2000000000
931,Consumer & retail,1000000000
364,E-commerce & direct-to-consumer,2000000000
732,Fintech,1000000000
906,Hardware,1000000000
72,Hardware,8000000000
983,Fintech,1000000000
983,Fintech,1000000000
898,Internet software & services,1000000000
844,Fintech,1000000000
894,Fintech,1000000000
813,Fintech,1000000000
743,Other,1000000000
226,Mobile & telecommunications,4000000000
963,Fintech,1000000000
764,Fintech,1000000000
839,E-commerce & direct-to-consumer,1000000000
1033,Internet software & services,1000000000
725,Health,1000000000
549,Artificial intelligence,2000000000
667,Mobile & telecommunications,1000000000
755,Fintech,1000000000
782,Fintech,1000000000
175,Fintech,4000000000
398,Fintech,2000000000
814,E-commerce & direct-to-consumer,1000000000
436,Artificial intelligence,2000000000
1046,Artificial intelligence,1000000000
565,Artificial intelligence,2000000000
781,Internet software & services,1000000000
997,E-commerce & direct-to-consumer,1000000000
194,Internet software & services,4000000000
249,Fintech,3000000000
434,Auto & transportation,2000000000
1035,Cybersecurity,1000000000
969,Data management & analytics,1000000000
1018,Other,1000000000
355,Internet software & services,2000000000
934,E-commerce & direct-to-consumer,1000000000
1054,Fintech,1000000000
901,Cybersecurity,1000000000
173,Internet software & services,4000000000
738,Fintech,1000000000
422,Internet software & services,2000000000
830,Health,1000000000
1004,Other,1000000000
951,E-commerce & direct-to-consumer,1000000000
951,E-commerce & direct-to-consumer,1000000000
734,Internet software & services,1000000000
1063,Fintech,1000000000
623,Fintech,1000000000
846,Data management & analytics,1000000000
823,Fintech,1000000000
944,Fintech,1000000000
1030,Artificial intelligence,1000000000
824,E-commerce & direct-to-consumer,1000000000
930,Internet software & services,1000000000
370,Data management & analytics,2000000000
618,E-commerce & direct-to-consumer,1000000000
456,Cybersecurity,2000000000
893,E-commerce & direct-to-consumer,1000000000
812,Other,1000000000
1001,Other,1000000000
703,Cybersecurity,1000000000
884,Health,1000000000
404,Cybersecurity,2000000000
952,Internet software & services,1000000000
625,Internet software & services,1000000000
971,Internet software & services,1000000000
796,Edtech,1000000000
909,Fintech,1000000000
587,Artificial intelligence,2000000000
273,Health,3000000000
771,Internet software & services,1000000000
1005,Data management & analytics,1000000000
758,Internet software & services,1000000000
652,Internet software & services,1000000000
8,Consumer & retail,38000000000
760,Mobile & telecommunications,1000000000
394,Health,2000000000
393,Fintech,2000000000
870,Other,1000000000
804,Artificial intelligence,1000000000
1041,Internet software & services,1000000000
Query:
SELECT cf."company_id", cf."valuation", cd."date_joined"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   WHERE cf."valuation" >= 1000000000
     AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
   LIMIT 100;
Answer:
company_id,valuation,date_joined
645,1000000000,2021-05-06T00:00:00.000
51,10000000000,2021-10-28T00:00:00.000
680,1000000000,2019-06-03T00:00:00.000
429,2000000000,2021-05-24T00:00:00.000
568,2000000000,2021-06-15T00:00:00.000
881,1000000000,2020-12-16T00:00:00.000
848,1000000000,2021-06-01T00:00:00.000
999,1000000000,2021-11-17T00:00:00.000
396,2000000000,2021-10-21T00:00:00.000
931,1000000000,2021-09-24T00:00:00.000
364,2000000000,2019-02-01T00:00:00.000
906,1000000000,2021-06-10T00:00:00.000
983,1000000000,2019-08-22T00:00:00.000
844,1000000000,2021-07-07T00:00:00.000
894,1000000000,2021-12-06T00:00:00.000
813,1000000000,2021-08-10T00:00:00.000
743,1000000000,2020-12-24T00:00:00.000
226,4000000000,2021-01-24T00:00:00.000
963,1000000000,2021-10-05T00:00:00.000
764,1000000000,2021-12-07T00:00:00.000
839,1000000000,2021-12-28T00:00:00.000
1033,1000000000,2021-01-27T00:00:00.000
549,2000000000,2021-09-22T00:00:00.000
755,1000000000,2021-09-08T00:00:00.000
175,4000000000,2019-06-25T00:00:00.000
398,2000000000,2021-10-15T00:00:00.000
814,1000000000,2021-11-16T00:00:00.000
1046,1000000000,2021-06-16T00:00:00.000
565,2000000000,2021-04-21T00:00:00.000
781,1000000000,2021-08-31T00:00:00.000
997,1000000000,2021-12-06T00:00:00.000
194,4000000000,2021-03-18T00:00:00.000
249,3000000000,2021-06-29T00:00:00.000
434,2000000000,2021-05-19T00:00:00.000
1035,1000000000,2021-11-18T00:00:00.000
1018,1000000000,2021-02-18T00:00:00.000
355,2000000000,2021-09-14T00:00:00.000
934,1000000000,2020-03-17T00:00:00.000
1054,1000000000,2021-05-18T00:00:00.000
901,1000000000,2021-11-08T00:00:00.000
173,4000000000,2021-12-20T00:00:00.000
830,1000000000,2021-03-30T00:00:00.000
1004,1000000000,2021-05-24T00:00:00.000
1063,1000000000,2021-11-10T00:00:00.000
846,1000000000,2019-10-21T00:00:00.000
823,1000000000,2019-05-21T00:00:00.000
944,1000000000,2021-07-22T00:00:00.000
1030,1000000000,2021-08-09T00:00:00.000
456,2000000000,2020-01-29T00:00:00.000
893,1000000000,2021-09-02T00:00:00.000
1001,1000000000,2020-09-21T00:00:00.000
703,1000000000,2021-12-02T00:00:00.000
884,1000000000,2021-12-14T00:00:00.000
404,2000000000,2021-03-19T00:00:00.000
625,1000000000,2020-01-28T00:00:00.000
971,1000000000,2021-11-02T00:00:00.000
771,1000000000,2021-09-28T00:00:00.000
1005,1000000000,2021-01-07T00:00:00.000
758,1000000000,2021-12-21T00:00:00.000
652,1000000000,2021-06-15T00:00:00.000
760,1000000000,2020-11-17T00:00:00.000
393,2000000000,2021-09-27T00:00:00.000
870,1000000000,2021-02-16T00:00:00.000
804,1000000000,2021-09-16T00:00:00.000
1041,1000000000,2021-11-02T00:00:00.000
978,1000000000,2021-01-07T00:00:00.000
612,1000000000,2021-12-31T00:00:00.000
421,2000000000,2020-11-16T00:00:00.000
449,2000000000,2021-07-03T00:00:00.000
1022,1000000000,2021-06-02T00:00:00.000
1022,1000000000,2021-06-02T00:00:00.000
644,1000000000,2021-01-25T00:00:00.000
718,1000000000,2021-09-30T00:00:00.000
920,1000000000,2021-08-10T00:00:00.000
1048,1000000000,2021-09-30T00:00:00.000
1024,1000000000,2021-04-22T00:00:00.000
929,1000000000,2021-12-22T00:00:00.000
863,1000000000,2021-12-07T00:00:00.000
662,1000000000,2020-12-21T00:00:00.000
1027,1000000000,2021-06-24T00:00:00.000
783,1000000000,2021-03-26T00:00:00.000
592,2000000000,2021-11-17T00:00:00.000
1023,1000000000,2021-01-26T00:00:00.000
1051,1000000000,2021-11-03T00:00:00.000
633,1000000000,2021-04-07T00:00:00.000
635,1000000000,2021-06-02T00:00:00.000
697,1000000000,2021-12-20T00:00:00.000
886,1000000000,2021-03-30T00:00:00.000
798,1000000000,2021-02-11T00:00:00.000
1008,1000000000,2021-11-08T00:00:00.000
701,1000000000,2020-12-31T00:00:00.000
825,1000000000,2021-10-13T00:00:00.000
344,3000000000,2021-06-29T00:00:00.000
643,1000000000,2021-12-15T00:00:00.000
509,2000000000,2021-08-04T00:00:00.000
979,1000000000,2021-02-25T00:00:00.000
1031,1000000000,2021-10-07T00:00:00.000
817,1000000000,2021-05-04T00:00:00.000
943,1000000000,2019-03-22T00:00:00.000
975,1000000000,2021-04-30T00:00:00.000
Query:
SELECT ci."industry", COUNT(*) AS "num_unicorns"
   FROM "companies_funding" AS cf
   JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
   JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
   WHERE cf."valuation" >= 1000000000
     AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
   GROUP BY ci."industry"
   ORDER BY "num_unicorns" DESC
   LIMIT 100;
Answer:
industry,num_unicorns
Fintech,181
Internet software & services,157
E-commerce & direct-to-consumer,76
Health,53
Artificial intelligence,53
Other,44
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Auto & transportation,16
Hardware,15
Consumer & retail,11
Travel,7
Query:
SELECT ci."industry", COUNT(*) AS "num_unicorns"
    FROM "companies_funding" AS cf
    JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
    JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
    WHERE cf."valuation" >= 1000000000
      AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
    GROUP BY ci."industry"
    ORDER BY "num_unicorns" DESC
    LIMIT 1;
Answer:
industry,num_unicorns
Fintech,181
Query:
SELECT AVG("yearly_count") AS "average_new_unicorns_per_year"
    FROM (
      SELECT SUBSTR(cd."date_joined", 1, 4) AS "year", COUNT(*) AS "yearly_count"
      FROM "companies_funding" AS cf
      JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
      JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
      WHERE cf."valuation" >= 1000000000
        AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
        AND ci."industry" = 'Fintech'  -- Replace 'Fintech' with the actual top industry
      GROUP BY "year"
    )
    LIMIT 100;
Answer:
average_new_unicorns_per_year
60.333333333333336
End Exploring Related Columns
Task: Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: ```csv
average_number_of_new_unicorns_per_year
1
(Attention: answer in one row)
```

Explanation:
From 2019 to 2021, the top industry with the highest number of new unicorn companies is Fintech. Over these three years, there were a total of 3 new unicorn companies in the Fintech industry, resulting in an average of 1 new unicorn company per year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 07:57:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:57:24 - root - INFO - ```sql
SELECT AVG("yearly_count") AS "average_number_of_new_unicorns_per_year"
FROM (
  SELECT SUBSTR(cd."date_joined", 1, 4) AS "year", COUNT(*) AS "yearly_count"
  FROM "companies_funding" AS cf
  JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
  JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
  WHERE cf."valuation" >= 1000000000
    AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
    AND ci."industry" = 'Fintech'
  GROUP BY "year"
);
```

```csv
average_number_of_new_unicorns_per_year
60.333333333333336
```
2025-01-24 07:57:24 - root - INFO - itercount: 1
2025-01-24 07:57:24 - root - INFO - 0
2025-01-24 07:57:24 - root - INFO - results: 
average_number_of_new_unicorns_per_year
60.333333333333336


2025-01-24 07:57:24 - root - INFO - Please check the answer again by reviewing Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
average_number_of_new_unicorns_per_year
1
(Attention: answer in one row)
```

Explanation:
From 2019 to 2021, the top industry with the highest number of new unicorn companies is Fintech. Over these three years, there were a total of 3 new unicorn companies in the Fintech industry, resulting in an average of 1 new unicorn company per year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
average_number_of_new_unicorns_per_year
60.333333333333336
Current sql:
SELECT AVG("yearly_count") AS "average_number_of_new_unicorns_per_year"
FROM (
  SELECT SUBSTR(cd."date_joined", 1, 4) AS "year", COUNT(*) AS "yearly_count"
  FROM "companies_funding" AS cf
  JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
  JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
  WHERE cf."valuation" >= 1000000000
    AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
    AND ci."industry" = 'Fintech'
  GROUP BY "year"
);
2025-01-24 07:58:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:58:02 - root - INFO - ```sql
SELECT ROUND(AVG("yearly_count"), 4) AS "average_number_of_new_unicorns_per_year"
FROM (
  SELECT SUBSTR(cd."date_joined", 1, 4) AS "year", COUNT(*) AS "yearly_count"
  FROM "companies_funding" AS cf
  JOIN "companies_dates" AS cd ON cf."company_id" = cd."company_id"
  JOIN "companies_industries" AS ci ON cf."company_id" = ci."company_id"
  WHERE cf."valuation" >= 1000000000
    AND SUBSTR(cd."date_joined", 1, 4) BETWEEN '2019' AND '2021'
    AND ci."industry" = 'Fintech'
  GROUP BY "year"
);
```

```csv
average_number_of_new_unicorns_per_year
60.3333
```
2025-01-24 07:58:02 - root - INFO - itercount: 2
2025-01-24 07:58:02 - root - INFO - 0
2025-01-24 07:58:02 - root - INFO - Total iteration counts: 2
