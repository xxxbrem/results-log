SELECT
    s."DATE",
    s."ASIN",
    s."PROGRAM",
    s."PERIOD",
    s."DISTRIBUTOR_VIEW",
    s."ORDERED_UNITS" AS "TOTAL_ORDERED_UNITS",
    s."ORDERED_REVENUE" AS "ORDERED_REVENUE",
    ROUND((s."ORDERED_REVENUE" / NULLIF(s."ORDERED_UNITS", 0)), 4) AS "AVERAGE_SELLING_PRICE",
    t."GLANCE_VIEWS" AS "GLANCE_VIEWS",
    ROUND((s."ORDERED_UNITS" / NULLIF(t."GLANCE_VIEWS", 0)), 4) AS "CONVERSION_RATE",
    s."SHIPPED_UNITS" AS "SHIPPED_UNITS",
    s."SHIPPED_REVENUE" AS "SHIPPED_REVENUE",
    ROUND(n."NET_PPM", 4) AS "AVERAGE_NET_PPM",
    ROUND(i."PROCURABLE_PRODUCT_OOS", 4) AS "AVERAGE_PROCURABLE_PRODUCT_OOS",
    i."SELLABLE_ON_HAND_UNITS" AS "TOTAL_ON_HAND_UNITS",
    i."SELLABLE_ON_HAND_INVENTORY" AS "TOTAL_ON_HAND_VALUE",
    i."NET_RECEIVED_UNITS" AS "NET_RECEIVED_UNITS",
    i."NET_RECEIVED" AS "NET_RECEIVED_VALUE",
    i."OPEN_PURCHASE_ORDER_QUANTITY" AS "OPEN_PURCHASE_ORDER_QUANTITIES",
    i."UNFILLED_CUSTOMER_ORDERED_UNITS" AS "UNFILLED_CUSTOMER_ORDERED_UNITS",
    ROUND(i."VENDOR_CONFIRMATION_RATE", 4) AS "AVERAGE_VENDOR_CONFIRMATION_RATE",
    ROUND(i."RECEIVE_FILL_RATE", 4) AS "RECEIVE_FILL_RATE",
    ROUND(i."SELL_THROUGH_RATE", 4) AS "SELL_THROUGH_RATE",
    ROUND(i."OVERALL_VENDOR_LEAD_TIME_DAYS", 4) AS "VENDOR_LEAD_TIME"
FROM
    "AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET"."PUBLIC"."RETAIL_ANALYTICS_SALES" s
LEFT JOIN
    "AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET"."PUBLIC"."RETAIL_ANALYTICS_TRAFFIC" t
    ON s."DATE" = t."DATE"
    AND s."ASIN" = t."ASIN"
    AND s."DISTRIBUTOR_VIEW" = t."DISTRIBUTOR_VIEW"
LEFT JOIN
    "AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET"."PUBLIC"."RETAIL_ANALYTICS_INVENTORY" i
    ON s."DATE" = i."DATE"
    AND s."ASIN" = i."ASIN"
    AND s."DISTRIBUTOR_VIEW" = i."DISTRIBUTOR_VIEW"
LEFT JOIN
    "AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET"."PUBLIC"."RETAIL_ANALYTICS_NET_PPM" n
    ON s."DATE" = n."DATE"
    AND s."ASIN" = n."ASIN"
    AND s."DISTRIBUTOR_VIEW" = n."DISTRIBUTOR_VIEW"
WHERE
    s."DISTRIBUTOR_VIEW" = 'Manufacturing'
    AND s."DATE" BETWEEN TO_DATE('2022-01-07', 'YYYY-MM-DD') AND TO_DATE('2022-02-06', 'YYYY-MM-DD')
ORDER BY
    s."DATE" DESC NULLS LAST,
    s."ASIN" NULLS LAST;