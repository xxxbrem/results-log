2025-02-11 07:24:08 - openai._base_client - INFO - Retrying request to /chat/completions in 0.402562 seconds
2025-02-11 07:25:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 07:25:15 - root - INFO - SQL:
SELECT DISTINCT `driver_distracted_by_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015`
   LIMIT 100
Results:
driver_distracted_by_name
Not Distracted
Looked But Did Not See
By Other Occupant(s)
By a Moving Object in Vehicle
While Talking or Listening to Cellular Phone
While Manipulating Cellular Phone
While Adjusting Audio or Climate Controls
While Using Other Component/Controls Integral to Vehicle
While Using or Reaching For Device/Object Brought Into Vehicle
"Distracted by Outside Person, Object or Event"
Eating or Drinking
Smoking Related
Other Cellular Phone Related
No Driver Present/Unknown if Driver Present
Distraction/Inattention
Distraction/Careless
Careless/Inattentive
"Distraction (Distracted), Details Unknown"
"Inattention (Inattentive), Details Unknown"
Not Reported
Lost In Thought/Day Dreaming
Other Distraction
Unknown if Distracted

2025-02-11 07:25:16 - root - INFO - SQL:
SELECT `state_number`, COUNT(DISTINCT `consecutive_number`) AS accident_count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
   GROUP BY `state_number`
   LIMIT 100
Results:
state_number,accident_count
30,204
39,1029
49,258
48,3190
41,411
42,1102
34,521
53,499
20,322
8,507
51,712
29,803
26,896
1,784
10,127
27,375
35,269
56,129
19,282
55,523
12,2699
36,1061
13,1329
18,752
17,914
21,694
6,3123
37,1275
45,911
32,297
40,590
2,60
4,811
47,888
5,491
28,604
9,257
24,479
54,246
22,698
38,111
25,327
23,144
46,116
31,218
50,50
44,41
33,103
11,23
16,198
15,85

2025-02-11 07:25:17 - root - INFO - SQL:
SELECT `driver_distracted_by_name`, COUNT(*) AS count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015`
   GROUP BY `driver_distracted_by_name`
   LIMIT 100
Results:
driver_distracted_by_name,count
Not Distracted,33688
Looked But Did Not See,401
By Other Occupant(s),165
By a Moving Object in Vehicle,10
While Talking or Listening to Cellular Phone,116
While Manipulating Cellular Phone,154
While Adjusting Audio or Climate Controls,43
While Using Other Component/Controls Integral to Vehicle,35
While Using or Reaching For Device/Object Brought Into Vehicle,75
"Distracted by Outside Person, Object or Event",196
Eating or Drinking,48
Smoking Related,14
Other Cellular Phone Related,205
No Driver Present/Unknown if Driver Present,273
Distraction/Inattention,425
Distraction/Careless,7
Careless/Inattentive,48
"Distraction (Distracted), Details Unknown",256
"Inattention (Inattentive), Details Unknown",1223
Not Reported,4750
Lost In Thought/Day Dreaming,15
Other Distraction,324
Unknown if Distracted,7049

2025-02-11 07:25:18 - root - INFO - SQL:
SELECT a.`state_number`, a.`consecutive_number`, d.`driver_distracted_by_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
     ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
   LIMIT 100
Results:
state_number,consecutive_number,driver_distracted_by_name
30,300019,Not Distracted
30,300019,Not Distracted
30,300019,Not Distracted
30,300019,Not Distracted
30,300019,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Unknown if Distracted
49,490123,Unknown if Distracted
48,481184,Not Distracted
48,481184,Not Distracted
48,481184,Not Distracted
48,481184,Not Distracted
48,481184,Not Distracted
41,410333,Not Distracted
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted

2025-02-11 07:25:19 - root - INFO - SQL:
SELECT `zipcode`, `population`
   FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
   LIMIT 100
Results:
zipcode,population
25647,768
49336,4352
72106,5376
74074,29184
1960,50944
13776,513
62379,2049
79322,2049
50833,2305
31778,2562
16150,7426
34436,7938
12483,259
40052,515
29686,1027
94619,23299
8353,516
12965,516
44048,2565
39638,3333
78956,5381
97914,19205
10952,38917
59639,1286
7606,2310
36009,2566
93536,70918
3220,7430
74468,263
4740,1287
30808,4615
8648,32263
1436,3336
55374,13576
89169,23304
51004,1033
8535,5385
97038,15113
29710,29449
61701,36105
5488,7690
78717,22538
48906,26634
21856,1035
4981,2316
29667,269
74735,1549
38117,26125
12071,270
30822,526
36875,4622
48201,12814
40175,13070
42332,271
24272,527
46371,3599
84310,4111
31648,1040
16929,2320
37144,3344
14586,10256
2188,14608
44106,26896
20901,34832
52362,1041
52659,1553
12143,5137
78069,5137
60477,38161
65025,786
72079,786
8348,275
80812,275
19312,11539
10456,86547
42453,532
80480,1300
70080,1556
2667,2580
45107,9236
5744,533
1029,789
47648,4373
83702,22293
10305,41749
23126,534
55089,1814
39553,17174
90230,31766
61817,2583
66508,4375
98359,4887
46550,12311
14846,792
54135,3096
55040,12568
70072,56344
39556,7705
93610,23833
32404,38425

2025-02-11 07:25:21 - root - INFO - SQL:
SELECT `state_fips_code`, `state_name`, `state_abbreviation`
   FROM `bigquery-public-data.utility_us.us_states_area`
   LIMIT 100
Results:
state_fips_code,state_name,state_abbreviation
78,United States Virgin Islands,VI
69,Commonwealth of the Northern Mariana Islands,MP
66,Guam,GU
60,American Samoa,AS
72,Puerto Rico,PR
44,Rhode Island,RI
33,New Hampshire,NH
50,Vermont,VT
09,Connecticut,CT
23,Maine,ME
25,Massachusetts,MA
34,New Jersey,NJ
42,Pennsylvania,PA
36,New York,NY
17,Illinois,IL
55,Wisconsin,WI
39,Ohio,OH
26,Michigan,MI
18,Indiana,IN
27,Minnesota,MN
31,Nebraska,NE
38,North Dakota,ND
29,Missouri,MO
20,Kansas,KS
46,South Dakota,SD
19,Iowa,IA
54,West Virginia,WV
12,Florida,FL
24,Maryland,MD
37,North Carolina,NC
10,Delaware,DE
13,Georgia,GA
45,South Carolina,SC
51,Virginia,VA
11,District of Columbia,DC
01,Alabama,AL
47,Tennessee,TN
21,Kentucky,KY
28,Mississippi,MS
22,Louisiana,LA
48,Texas,TX
40,Oklahoma,OK
05,Arkansas,AR
16,Idaho,ID
35,New Mexico,NM
49,Utah,UT
08,Colorado,CO
56,Wyoming,WY
32,Nevada,NV
30,Montana,MT
04,Arizona,AZ
06,California,CA
41,Oregon,OR
53,Washington,WA
15,Hawaii,HI
02,Alaska,AK

2025-02-11 07:25:22 - root - INFO - SQL:
SELECT DISTINCT a.`state_number`, s.`state_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.utility_us.us_states_area` AS s
     ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
   LIMIT 100
Results:
state_number,state_name
30,Montana
39,Ohio
49,Utah
48,Texas
41,Oregon
42,Pennsylvania
34,New Jersey
53,Washington
20,Kansas
51,Virginia
29,Missouri
26,Michigan
10,Delaware
27,Minnesota
35,New Mexico
56,Wyoming
19,Iowa
55,Wisconsin
12,Florida
36,New York
13,Georgia
18,Indiana
17,Illinois
21,Kentucky
37,North Carolina
45,South Carolina
32,Nevada
40,Oklahoma
47,Tennessee
28,Mississippi
24,Maryland
54,West Virginia
22,Louisiana
38,North Dakota
25,Massachusetts
23,Maine
46,South Dakota
31,Nebraska
50,Vermont
44,Rhode Island
33,New Hampshire
11,District of Columbia
16,Idaho
15,Hawaii

2025-02-11 07:25:23 - root - INFO - SQL:
SELECT a.`state_number`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
     ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
   WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
   GROUP BY a.`state_number`
   LIMIT 100
Results:
state_number,accident_count
39,59
51,129
49,32
53,158
10,15
26,67
35,124
56,15
48,441
21,200
6,206
45,67
41,12
1,57
47,112
42,72
4,118
37,157
24,104
29,97
54,8
12,235
5,35
34,146
36,163
18,56
20,73
22,154
25,65
30,39
31,16
40,54
27,60
55,102
17,52
2,12
23,14
28,7
13,76
15,17
8,70
50,5
16,35
19,31
9,14
46,14
32,16
38,2
33,18
44,1

2025-02-11 07:25:25 - root - INFO - SQL:
SELECT z.`state_name`, SUM(p.`population`) AS state_population
   FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
   JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
     ON p.`zipcode` = z.`zipcode`
   GROUP BY z.`state_name`
   LIMIT 100
Results:
state_name,state_population
Alabama,14338764
Utah,8285430
Virginia,24003717
Washington (state),809694
Pennsylvania,38107125
Ohio,34609542
Maryland,17320683
Oregon,11490705
Tennessee,19003095
Montana,2965035
Mississippi,9200223
Minnesota,15904047
North Carolina,28606431
Nebraska,5480298
New York,58133523
Florida,56403678
Illinois,38491743
Oklahoma,11249850
Iowa,9131034
Arizona,19127649
Georgia,28280514
Texas,75434313
Missouri,17961405
Washington,19240062
Idaho,4702578
Wisconsin,17061036
Colorado,15088122
Nevada,8099424
Arkansas,8733537
California,111748626
Kentucky,12977133
Michigan,29650836
New Mexico,6161043
North Dakota,2015343
South Carolina,13876092
Louisiana,13598490
Alaska,2129790
South Dakota,2434629
Kansas,8551884
West Virginia,5558322
"Washington, D.C.",24681
Indiana,19451376
Hawaii,4080903
Wyoming,1683354
Georgia (U.S. state),456018
District of Columbia,1780488
"Iowa, Minnesota",5130
Delaware,2693775
"Oregon, Washington",123168
"Arkansas, Louisiana",7785
"Colorado, Wyoming",300
"Arizona, New Mexico",41208
"Alabama, Mississippi",28347
"Kentucky, Tennessee",76242
"Oklahoma, Texas",5064
"Idaho, Oregon",1923
"Arkansas, Missouri",12783
"Kansas, Oklahoma",7674
"Arizona, Utah",17115
"Minnesota, South Dakota",3246
"Montana, North Dakota",4974
"Arizona, New Mexico, Utah",9951
"North Dakota, South Dakota",5763
"Idaho, Wyoming",1413
"Nebraska, Wyoming",4818
"California, Nevada",4251
"Iowa, Missouri",9801
"California, Oregon",867
"Idaho, Washington",963

2025-02-11 07:25:26 - root - INFO - SQL:
SELECT s.`state_name`, a.`consecutive_number`, d.`driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    JOIN `bigquery-public-data.utility_us.us_states_area` AS s
      ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
    WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    LIMIT 100
Results:
state_name,consecutive_number,driver_distracted_by_name
Ohio,390126,No Driver Present/Unknown if Driver Present
Ohio,390126,No Driver Present/Unknown if Driver Present
Virginia,510171,Other Distraction
Virginia,510171,Other Distraction
Utah,490011,Other Distraction
Washington,530505,"Inattention (Inattentive), Details Unknown"
Delaware,100079,No Driver Present/Unknown if Driver Present
Michigan,260911,Other Distraction
New Mexico,350271,"Distraction (Distracted), Details Unknown"
Wyoming,560031,No Driver Present/Unknown if Driver Present
Texas,480751,No Driver Present/Unknown if Driver Present
Texas,482369,Distraction/Inattention
Kentucky,210199,While Manipulating Cellular Phone
Kentucky,210302,"Inattention (Inattentive), Details Unknown"
Kentucky,210210,"Inattention (Inattentive), Details Unknown"
New Mexico,350272,"Inattention (Inattentive), Details Unknown"
New Mexico,350072,"Inattention (Inattentive), Details Unknown"
South Carolina,450155,Distraction/Inattention
Texas,480879,"Inattention (Inattentive), Details Unknown"
Texas,482254,Other Cellular Phone Related
Texas,482162,"Inattention (Inattentive), Details Unknown"
Oregon,410053,"Distracted by Outside Person, Object or Event"
Michigan,260561,While Manipulating Cellular Phone
Tennessee,470389,Other Distraction
Pennsylvania,420710,"Distraction (Distracted), Details Unknown"
Michigan,260461,While Using or Reaching For Device/Object Brought Into Vehicle
Michigan,260461,Eating or Drinking
Michigan,260894,Eating or Drinking
New Mexico,350031,"Inattention (Inattentive), Details Unknown"
New Mexico,350090,"Inattention (Inattentive), Details Unknown"
New Mexico,350090,"Inattention (Inattentive), Details Unknown"
North Carolina,370920,"Inattention (Inattentive), Details Unknown"
Maryland,240232,"Inattention (Inattentive), Details Unknown"
Missouri,290152,Distraction/Inattention
Maryland,240129,Looked But Did Not See
Tennessee,470109,"Distraction (Distracted), Details Unknown"
West Virginia,540135,Other Distraction
Tennessee,470316,Other Distraction
Texas,481729,Looked But Did Not See
Florida,120838,"Inattention (Inattentive), Details Unknown"
Florida,121101,By Other Occupant(s)

2025-02-11 07:25:27 - root - INFO - SQL:
SELECT a.`state_number`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    GROUP BY a.`state_number`
    LIMIT 100
Results:
state_number,accident_count
6,227
47,132
35,147
31,13
19,40
17,68
38,11
13,88
53,147
48,389
29,80
40,55
21,192
22,143
18,48
20,95
34,193
27,37
49,25
12,233
39,68
51,141
1,57
4,102
16,51
26,61
30,20
37,157
45,52
46,10
56,14
23,3
36,143
55,117
44,3
5,23
8,77
10,16
15,19
24,67
32,8
41,11
42,62
54,5
25,47
33,6
2,1
9,13
50,4
28,3
11,1

2025-02-11 07:25:28 - root - INFO - SQL:
SELECT DISTINCT `state_number`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
    LIMIT 100
Results:
state_number
30
39
49
48
41
42
34
53
20
8
51
29
26
1
10
27
35
56
19
55
12
36
13
18
17
21
6
37
45
32
40
2
4
47
5
28
9
24
54
22
38
25
23
46
31
50
44
33
11
16
15

2025-02-11 07:26:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 07:26:30 - root - INFO - I see that you're encountering an error with the following query:

```sql
SELECT `state_name`, `population`
    FROM `bigquery-public-data.utility_us.us_states_area`
    LIMIT 100
```

**Error message:**
```
400 Unrecognized name: population at [1:22]; reason: invalidQuery, location: query, message: Unrecognized name: population at [1:22]
```

---

**Explanation:**

The error occurs because the `population` column does not exist in the `us_states_area` table. The `us_states_area` table contains geographic information about U.S. states, such as:

- `state_fips_code`
- `state_name`
- `state_abbreviation`
- `area_land_meters`
- `area_water_meters`
- `state_geom`

But it does **not** include a `population` column.

---

**Solution:**

To obtain the 2010 census population data for each U.S. state, we need to use a table that includes population figures. Unfortunately, the `bigquery-public-data.utility_us.us_states_area` table does not have this data.

However, we can calculate state populations by aggregating the population data from ZIP codes using the `bigquery-public-data.census_bureau_usa.population_by_zip_2010` table and join it with the `bigquery-public-data.utility_us.zipcode_area` table to map ZIP codes to states.

Here’s how you can do it:

---

**Step 1: Calculate State Populations**

```sql
SELECT
  z.state_name,
  SUM(p.population) AS state_population
FROM
  `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
JOIN
  (SELECT DISTINCT zipcode, state_name
   FROM `bigquery-public-data.utility_us.zipcode_area`) AS z
ON
  p.zipcode = z.zipcode
GROUP BY
  z.state_name
ORDER BY
  state_population DESC
LIMIT 100
```

**Explanation:**

- We join the `population_by_zip_2010` table (which contains population by ZIP code) with the `zipcode_area` table (which maps ZIP codes to state names).
- We aggregate the population by summing up the populations of all ZIP codes within each state.

---

**Step 2: Verify State Population Data**

Run the above query to get the population of each state. Please note that aggregating population data from ZIP codes may not be perfectly accurate due to:

- ZIP codes crossing state boundaries.
- PO Boxes or unique ZIP codes that may not be linked to a specific geographic area.
- Data inconsistencies or missing ZIP codes.

If the population figures seem inaccurate, consider using a more reliable dataset for state populations.

---

**Alternative Method: Use American Community Survey Data**

The `bigquery-public-data.census_bureau_acs` dataset contains American Community Survey (ACS) data, which includes population estimates.

**Example Query to Get State Populations from ACS:**

```sql
SELECT
  geo_id,
  geo_display_label AS state_name,
  population
FROM
  `bigquery-public-data.census_bureau_acs.population_by_state_2010`
```

**Note:** Ensure that the table `population_by_state_2010` exists in the dataset, and adjust the table name and column names as necessary.

---

**Step 3: Calculate Accidents Caused by Driver Distraction**

Now, calculate the number of traffic accidents caused by driver distraction in each state for 2015 and 2016, excluding cases where the driver’s distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported.'

**Example Query for 2015:**

```sql
-- Calculate distracted driving accidents per state for 2015
WITH distracted_accidents_2015 AS (
  SELECT
    a.state_number,
    COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM
    `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN
    `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
  ON
    a.state_number = d.state_number
    AND a.consecutive_number = d.consecutive_number
  WHERE
    d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY
    a.state_number
)

-- Map state_number to state_name using FIPS codes
SELECT
  s.state_name,
  da.accident_count
FROM
  distracted_accidents_2015 AS da
JOIN
  `bigquery-public-data.utility_us.us_states_area` AS s
ON
  CAST(da.state_number AS STRING) = s.state_fips_code
ORDER BY
  da.accident_count DESC
LIMIT 5  -- Top 5 states for 2015
```

**Repeat the process for 2016** by replacing the table names accordingly.

---

**Step 4: Calculate Accidents per 100,000 People**

Now, combine the accident data with the state population data to calculate accidents per 100,000 people.

**Example Query for 2015:**

```sql
-- State populations (from Step 1 or Alternative Method)
WITH state_populations AS (
  SELECT
    z.state_name,
    SUM(p.population) AS state_population
  FROM
    `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
  JOIN
    (SELECT DISTINCT zipcode, state_name
     FROM `bigquery-public-data.utility_us.zipcode_area`) AS z
  ON
    p.zipcode = z.zipcode
  GROUP BY
    z.state_name
),

-- Distracted driving accidents per state for 2015 (from previous step)
distracted_accidents_2015 AS (
  SELECT
    a.state_number,
    COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM
    `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN
    `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
  ON
    a.state_number = d.state_number
    AND a.consecutive_number = d.consecutive_number
  WHERE
    d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY
    a.state_number
)

-- Combine accident data with state populations
SELECT
  s.state_name,
  da.accident_count,
  sp.state_population,
  ROUND((da.accident_count / sp.state_population) * 100000, 2) AS accidents_per_100k
FROM
  distracted_accidents_2015 AS da
JOIN
  `bigquery-public-data.utility_us.us_states_area` AS s
ON
  CAST(da.state_number AS STRING) = s.state_fips_code
JOIN
  state_populations AS sp
ON
  s.state_name = sp.state_name
ORDER BY
  accidents_per_100k DESC
LIMIT 5  -- Top 5 states for 2015
```

**Notes:**

- Replace the population data source with a more accurate dataset if available.
- Ensure that the state names match between datasets. Occasionally, state names might be formatted differently (e.g., 'Washington' vs. 'Washington State').

---

**Conclusion:**

- The error occurred because the `population` column does not exist in the `us_states_area` table.
- To resolve this, we calculated state populations by aggregating population data from ZIP codes.
- We then calculated the number of accidents caused by driver distraction for each state.
- Finally, we combined the data to determine accidents per 100,000 people and identified the top five states for each year.

**Let me know if you need further assistance or clarification on any of the steps.**
2025-02-11 07:27:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 07:27:21 - root - INFO - I see that you're encountering an error with your query:

```sql
SELECT `state_name`, `population`
FROM `bigquery-public-data.utility_us.us_states_area`
LIMIT 100
```

**Error message:**
```
400 Unrecognized name: population at [1:22]; reason: invalidQuery, location: query, message: Unrecognized name: population at [1:22]
```

---

**Explanation:**

The error occurs because the `population` column does not exist in the `us_states_area` table. The `us_states_area` table contains geographic information about U.S. states, including:

- `state_fips_code`
- `state_name`
- `state_abbreviation`
- `area_land_meters`
- `area_water_meters`
- `state_geom`

But it does **not** include a `population` column.

---

**Solution:**

To obtain the 2010 census population data for each U.S. state, we need to use a table that includes population figures. Based on the tables available, one way to get state-level population data is to aggregate the populations from the `population_by_zip_2010` table by mapping ZIP codes to states.

Here’s how you can do it:

---

**1. Aggregate State Population from ZIP Code Level Data**

We can join the `population_by_zip_2010` table (which contains population data for each ZIP code) with the `zipcode_area` table (which maps ZIP codes to states) to calculate the total population for each state.

```sql
SELECT
  z.state_name,
  SUM(p.population) AS state_population
FROM
  `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
JOIN
  `bigquery-public-data.utility_us.zipcode_area` AS z
ON
  p.zipcode = z.zipcode
GROUP BY
  z.state_name
ORDER BY
  state_population DESC
LIMIT 100
```

This query will give you the estimated population for each state by summing the populations of all ZIP codes within the state.

---

**2. Verify State Population Data**

Please note that aggregating population data from ZIP codes may not provide perfectly accurate state population figures due to:

- ZIP codes sometimes crossing state boundaries.
- Some ZIP codes not being associated with geographic areas (e.g., PO Boxes).
- Potential discrepancies or missing data in the ZIP code datasets.

For more accurate state population data, you might consider using official census tables that provide state-level populations. However, based on the list you provided, we may not have direct access to such a table.

---

**3. Calculate Accidents Caused by Driver Distraction**

Using the accident and driver distraction data for 2015 and 2016, we can calculate the number of accidents caused by driver distraction in each state. Here's how to proceed:

**Calculate Distracted Driving Accidents per State for 2015**

```sql
WITH distracted_accidents_2015 AS (
  SELECT
    a.state_number,
    COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM
    `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN
    `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
  ON
    a.state_number = d.state_number
    AND a.consecutive_number = d.consecutive_number
  WHERE
    d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY
    a.state_number
)
```

**Calculate Distracted Driving Accidents per State for 2016**

```sql
WITH distracted_accidents_2016 AS (
  SELECT
    a.state_number,
    COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM
    `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
  JOIN
    `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
  ON
    a.state_number = d.state_number
    AND a.consecutive_number = d.consecutive_number
  WHERE
    d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY
    a.state_number
)
```

---

**4. Map State Codes to State Names**

We need to map the `state_number` from the accident data to the `state_name` for readability. We can use the `us_states_area` table for this purpose.

```sql
-- State code to name mapping
SELECT
  s.state_fips_code AS state_number,
  s.state_name
FROM
  `bigquery-public-data.utility_us.us_states_area` AS s
```

Note: Ensure that the `state_number` is cast to the appropriate data type for joining.

---

**5. Combine Accident Data with State Population Data**

Now, we can combine the accident data with the state population data to calculate the number of accidents per 100,000 people.

**Example for 2015:**

```sql
WITH
  -- Step 1: Calculate distracted driving accidents per state for 2015
  distracted_accidents AS (
    SELECT
      a.state_number,
      COUNT(DISTINCT a.consecutive_number) AS accident_count
    FROM
      `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN
      `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
    ON
      a.state_number = d.state_number
      AND a.consecutive_number = d.consecutive_number
    WHERE
      d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    GROUP BY
      a.state_number
  ),

  -- Step 2: Aggregate state populations from ZIP code data
  state_populations AS (
    SELECT
      z.state_name,
      SUM(p.population) AS state_population
    FROM
      `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
    JOIN
      `bigquery-public-data.utility_us.zipcode_area` AS z
    ON
      p.zipcode = z.zipcode
    GROUP BY
      z.state_name
  ),

  -- Step 3: Map state numbers to state names
  state_mappings AS (
    SELECT
      s.state_fips_code AS state_number_str,
      s.state_name
    FROM
      `bigquery-public-data.utility_us.us_states_area` AS s
  )

-- Step 4: Calculate accidents per 100,000 people
SELECT
  sm.state_name AS State,
  da.accident_count AS Accidents,
  sp.state_population AS Population,
  ROUND((da.accident_count / sp.state_population) * 100000, 2) AS Accidents_per_100k
FROM
  distracted_accidents AS da
JOIN
  state_mappings AS sm
ON
  CAST(da.state_number AS STRING) = sm.state_number_str
JOIN
  state_populations AS sp
ON
  sm.state_name = sp.state_name
ORDER BY
  Accidents_per_100k DESC
LIMIT 5  -- Top 5 states for 2015
```

**Repeat the process for 2016** by adjusting the table names in the `distracted_accidents` CTE.

---

**6. Final Answer**

Based on your request, here are the top five states each year with the highest rates of traffic accidents caused by driver distraction per 100,000 people:

```csv
Year,State,Accidents_per_100k
2015,State1:str,rate1:float
2015,State2:str,rate2:float
2015,State3:str,rate3:float
2015,State4:str,rate4:float
2015,State5:str,rate5:float
2016,State1:str,rate1:float
2016,State2:str,rate2:float
2016,State3:str,rate3:float
2016,State4:str,rate4:float
2016,State5:str,rate5:float
(Attention: answer in ten rows)
```

- **Year**: The year (2015 or 2016).
- **State**: The name of the U.S. state.
- **Accidents_per_100k**: The number of traffic accidents caused by driver distraction per 100,000 people in that state for the given year.

---

**Note:**

Since we cannot retrieve actual data here, please run the provided queries in your BigQuery environment to get the specific states and rates.

**Let me know if you have any questions or need further assistance!**
2025-02-11 07:28:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 07:28:14 - root - INFO - I understand that you're encountering an error with your query:

```sql
SELECT `state_name`, `population`
    FROM `bigquery-public-data.utility_us.us_states_area`
    LIMIT 100
```

**Error message:**

```
400 Unrecognized name: population at [1:22]; reason: invalidQuery, location: query, message: Unrecognized name: population at [1:22]
```

---

**Explanation:**

The error occurs because the `population` column does not exist in the `us_states_area` table. The `us_states_area` table includes the following columns:

- `region_code`
- `division_code`
- `state_fips_code`
- `state_gnis_code`
- `state_geo_id`
- `state_abbreviation`
- `state_name`
- `legal_area_code`
- `feature_class_code`
- `functional_status_code`
- `area_land_meters`
- `area_water_meters`
- `internal_point_lat`
- `internal_point_lon`
- `state_geom`

But it does **not** include a `population` column.

---

**Solution:**

To obtain the 2010 census population data for each U.S. state, we can aggregate the population data from ZIP codes using the `population_by_zip_2010` table and map ZIP codes to states using the `zipcode_area` table.

Here's how you can do it using the available tables:

---

**Step 1: Calculate State Populations**

```sql
SELECT
  z.state_abbreviation,
  SUM(p.population) AS state_population
FROM
  `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
JOIN
  `bigquery-public-data.utility_us.zipcode_area` AS z
ON
  p.zipcode = z.zipcode
GROUP BY
  z.state_abbreviation
ORDER BY
  state_population DESC
```

**Explanation:**

- We join the `population_by_zip_2010` table (which contains population by ZIP code) with the `zipcode_area` table (which maps ZIP codes to state abbreviations).
- We aggregate the population by summing up the populations of all ZIP codes within each state.
- The `state_abbreviation` column is used to group the data by state.

---

**Step 2: Calculate Distracted Driving Accidents per State**

For **2015**:

```sql
-- Accidents involving distracted drivers in 2015
SELECT
  a.state_number,
  COUNT(DISTINCT a.consecutive_number) AS accident_count
FROM
  `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
JOIN
  `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
ON
  a.state_number = d.state_number
  AND a.consecutive_number = d.consecutive_number
WHERE
  d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
GROUP BY
  a.state_number
```

For **2016**, replace the table names with `accident_2016` and `distract_2016`.

---

**Step 3: Map State Numbers to State Abbreviations and Names**

```sql
SELECT
  state_fips_code,
  state_abbreviation,
  state_name
FROM
  `bigquery-public-data.utility_us.us_states_area`
```

**Note:** Ensure that the `state_fips_code` matches the `state_number` from the accidents data.

---

**Step 4: Combine Data to Calculate Accidents per 100,000 People**

For **2015**:

```sql
WITH state_population AS (
  SELECT
    z.state_abbreviation,
    SUM(p.population) AS population
  FROM
    `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
  JOIN
    `bigquery-public-data.utility_us.zipcode_area` AS z
  ON
    p.zipcode = z.zipcode
  GROUP BY
    z.state_abbreviation
),
distracted_accidents AS (
  SELECT
    a.state_number,
    COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM
    `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN
    `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
  ON
    a.state_number = d.state_number
    AND a.consecutive_number = d.consecutive_number
  WHERE
    d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY
    a.state_number
),
state_info AS (
  SELECT
    CAST(state_fips_code AS INT64) AS state_number,
    state_abbreviation,
    state_name
  FROM
    `bigquery-public-data.utility_us.us_states_area`
)
SELECT
  s.state_name AS State,
  d.accident_count AS Accidents,
  sp.population AS Population,
  ROUND((d.accident_count / sp.population) * 100000, 2) AS Accidents_per_100k
FROM
  distracted_accidents AS d
JOIN
  state_info AS s
ON
  d.state_number = s.state_number
JOIN
  state_population AS sp
ON
  s.state_abbreviation = sp.state_abbreviation
ORDER BY
  Accidents_per_100k DESC
LIMIT 5  -- Top 5 states for 2015
```

**For 2016**, replace the accidents data in the `distracted_accidents` CTE with data from `accident_2016` and `distract_2016`.

---

**Final Answer:**

Based on the calculations, the top five states each year with the highest rates of traffic accidents caused by driver distraction per 100,000 people are:

```csv
Year,State,Accidents_per_100k
2015,State1:str,rate1:float
2015,State2:str,rate2:float
2015,State3:str,rate3:float
2015,State4:str,rate4:float
2015,State5:str,rate5:float
2016,State1:str,rate1:float
2016,State2:str,rate2:float
2016,State3:str,rate3:float
2016,State4:str,rate4:float
2016,State5:str,rate5:float
(Attention: answer in ten rows)
```

- **Year**: 2015 or 2016.
- **State**: Name of the U.S. state.
- **Accidents_per_100k**: Number of traffic accidents caused by driver distraction per 100,000 people in that state for the given year.

**Note:** Since we cannot execute queries here to get actual data, please run the provided SQL code in your BigQuery environment to obtain the exact values for each state.

---

**Summary:**

- The `population` column does not exist in the `us_states_area` table, which caused the error.
- We calculated state populations by aggregating ZIP code population data from the `population_by_zip_2010` and `zipcode_area` tables.
- We mapped `state_number` to state names using the `us_states_area` table.
- We calculated accidents per 100,000 people for each state and identified the top five states for each year.

---

I hope this resolves the issue and helps you complete your analysis. Let me know if you need further assistance!
2025-02-11 07:28:15 - root - INFO - SQL:
SELECT `state_name`, `population`
    FROM `bigquery-public-data.utility_us.us_states_area`
    LIMIT 100
Results:
400 Unrecognized name: population at [1:22]; reason: invalidQuery, location: query, message: Unrecognized name: population at [1:22]

Location: US
Job ID: e35e115d-aa97-4773-a84d-0b0cfd5c1664

2025-02-11 07:28:16 - root - INFO - SQL:
SELECT a.`state_number`, a.`consecutive_number`, d.`driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    LIMIT 100
Results:
state_number,consecutive_number,driver_distracted_by_name
16,160065,Not Distracted
24,240021,Not Distracted
31,310185,Not Distracted
37,370035,Not Distracted
39,391029,Not Distracted
37,370037,Not Distracted
37,370037,Not Distracted
6,62039,Not Distracted
6,61450,Not Distracted
6,62299,Other Distraction
6,62095,Not Distracted
20,200075,Unknown if Distracted
35,350086,Not Distracted
49,490052,Unknown if Distracted
29,290444,Not Reported
23,230004,Unknown if Distracted
29,290747,Not Reported
35,350055,Not Distracted
18,180061,Not Distracted
16,160222,Not Distracted
19,190341,Unknown if Distracted
5,50265,Unknown if Distracted
17,170432,Not Distracted
27,270200,Unknown if Distracted
37,370781,Not Reported
5,50168,Unknown if Distracted
13,131254,Not Distracted
35,350246,Not Distracted
47,470082,Unknown if Distracted
47,470083,Other Cellular Phone Related
4,40032,Not Distracted
4,40032,Not Distracted
18,180160,Not Distracted
20,200074,Unknown if Distracted
35,350114,"Inattention (Inattentive), Details Unknown"
37,370876,Not Reported
22,220711,Unknown if Distracted
29,290838,Not Reported
31,310003,Not Distracted
31,310003,Not Distracted
29,290827,Not Reported
29,290827,Not Reported
5,50022,Unknown if Distracted
50,500051,Not Distracted
50,500051,Not Distracted
50,500051,Not Distracted
1,10424,Unknown if Distracted
5,50318,Unknown if Distracted
29,290324,Not Reported
30,300113,Unknown if Distracted
40,400127,Unknown if Distracted

2025-02-11 07:28:17 - root - INFO - SQL:
SELECT `state_number`, COUNT(DISTINCT `consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016`
    GROUP BY `state_number`
    LIMIT 100
Results:
state_number,accident_count
16,232
24,484
31,194
37,1348
39,1053
6,3540
20,381
35,361
49,259
29,872
23,150
18,776
19,355
5,504
17,1000
27,357
13,1424
47,962
4,856
22,704
50,57
1,979
30,171
40,628
53,504
34,570
55,544
8,558
36,981
41,448
42,1088
54,250
45,941
2,78
51,722
12,2935
9,292
48,3427
38,102
21,763
46,103
28,625
15,109
25,356
11,26
26,981
32,304
33,130
44,48
56,100
10,116

2025-02-11 07:28:18 - root - INFO - SQL:
SELECT DISTINCT a.`state_number`, s.`state_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.utility_us.us_states_area` AS s
      ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
    LIMIT 100
Results:
state_number,state_name
16,Idaho
24,Maryland
31,Nebraska
37,North Carolina
39,Ohio
20,Kansas
35,New Mexico
49,Utah
29,Missouri
23,Maine
18,Indiana
19,Iowa
17,Illinois
27,Minnesota
13,Georgia
47,Tennessee
22,Louisiana
50,Vermont
30,Montana
40,Oklahoma
53,Washington
34,New Jersey
55,Wisconsin
36,New York
41,Oregon
42,Pennsylvania
54,West Virginia
45,South Carolina
51,Virginia
12,Florida
48,Texas
38,North Dakota
21,Kentucky
46,South Dakota
28,Mississippi
15,Hawaii
25,Massachusetts
11,District of Columbia
26,Michigan
32,Nevada
33,New Hampshire
44,Rhode Island
56,Wyoming
10,Delaware

2025-02-11 07:28:19 - root - INFO - SQL:
SELECT DISTINCT `driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016`
    LIMIT 100
Results:
driver_distracted_by_name
Not Distracted
Looked But Did Not See
By Other Occupant(s)
By a Moving Object in Vehicle
While Talking or Listening to Cellular Phone
While Manipulating Cellular Phone
While Adjusting Audio or Climate Controls
While Using Other Component/Controls Integral to Vehicle
While Using or Reaching For Device/Object Brought Into Vehicle
"Distracted by Outside Person, Object or Event"
Eating or Drinking
Smoking Related
Other Cellular Phone Related
No Driver Present/Unknown if Driver Present
Distraction/Inattention
Distraction/Careless
Careless/Inattentive
"Distraction (Distracted), Details Unknown"
"Inattention (Inattentive), Details Unknown"
Not Reported
Lost In Thought/Day Dreaming
Other Distraction
Unknown if Distracted

2025-02-11 07:28:21 - root - INFO - SQL:
SELECT DISTINCT `zipcode`, `state_name`
    FROM `bigquery-public-data.utility_us.zipcode_area`
    LIMIT 100
Results:
zipcode,state_name
96915,Guam
96928,Guam
96917,Guam
96916,Guam
50023,Iowa
50327,Iowa
52405,Iowa
51237,Iowa
50212,Iowa
50161,Iowa
50677,Iowa
50119,Iowa
51010,Iowa
50277,Iowa
52069,Iowa
50532,Iowa
50247,Iowa
51347,Iowa
51532,Iowa
52621,Iowa
51109,Iowa
52402,Iowa
52320,Iowa
50014,Iowa
50622,Iowa
50107,Iowa
50050,Iowa
50219,Iowa
51051,Iowa
50166,Iowa
51449,Iowa
50447,Iowa
50835,Iowa
52593,Iowa
50482,Iowa
51521,Iowa
50561,Iowa
50131,Iowa
51054,Iowa
51020,Iowa
50578,Iowa
52345,Iowa
50642,Iowa
50028,Iowa
52563,Iowa
52531,Iowa
50586,Iowa
51436,Iowa
52729,Iowa
52730,Iowa
52750,Iowa
50655,Iowa
51012,Iowa
51564,Iowa
50133,Iowa
50515,Iowa
52573,Iowa
50703,Iowa
50315,Iowa
52658,Iowa
51638,Iowa
52342,Iowa
52216,Iowa
52362,Iowa
50068,Iowa
52746,Iowa
50167,Iowa
52231,Iowa
50136,Iowa
52653,Iowa
52738,Iowa
51063,Iowa
50262,Iowa
51649,Iowa
51528,Iowa
52050,Iowa
50461,Iowa
52154,Iowa
51342,Iowa
50510,Iowa
50217,Iowa
50601,Iowa
52035,Iowa
50325,Iowa
50567,Iowa
51466,Iowa
52202,Iowa
52401,Iowa
52758,Iowa
51247,Iowa
52332,Iowa
50676,Iowa
50232,Iowa
50438,Iowa
51232,Iowa
50246,Iowa
51545,Iowa
51579,Iowa
52151,Iowa
51510,Iowa

2025-02-11 07:28:22 - root - INFO - SQL:
SELECT z.`state_code`, SUM(p.`population`) AS state_population
    FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
    JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
      ON p.`zipcode` = z.`zipcode`
    GROUP BY z.`state_code`
    LIMIT 100
Results:
state_code,state_population
AL,14338764
UT,8285430
VA,24003717
WA,20049756
PA,38107125
OH,34609542
MD,17320683
OR,11490705
TN,19003095
MT,2965035
MS,8873622
MN,15904047
NC,28606431
NE,5480298
NY,58133523
FL,56403678
IL,38491743
OK,11249850
IA,9131034
AZ,19127649
GA,29063133
TX,75434313
MO,17961405
ID,4700946
WI,17061036
CO,15088122
NV,8099424
AR,8733537
CA,111748626
KY,12977133
MI,29650836
NM,6161043
ND,2015343
SC,13876092
LA,13598490
AK,2129790
SD,2434629
KS,8551884
WV,5558322
DC,1805169
IN,19451376
HI,4080903
WY,1684986
"IA, MN",5130
DE,2693775
"OR, WA",123168
"AR, LA",7785
"CO, WY",300
"AZ, NM",41208
"AL, MS",28347
"KY, TN",76242
"OK, TX",5064
"ID, OR",1923
"AR, MO",12783
"KS, OK",7674
"AZ, UT",17115
"MN, SD",3246
"MT, ND",4974
"AZ, NM, UT",9951
"ND, SD",5763
"ID, WY",1413
"NE, WY",4818
"CA, NV",4251
"IA, MO",9801
"CA, OR",867
"ID, WA",963

2025-02-11 07:28:23 - root - INFO - SQL:
SELECT d.`driver_distracted_by_name`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    GROUP BY d.`driver_distracted_by_name`
    LIMIT 100
Results:
driver_distracted_by_name,accident_count
Not Distracted,23269
Unknown if Distracted,6372
Not Reported,3677
No Driver Present/Unknown if Driver Present,256
Other Distraction,314
"Inattention (Inattentive), Details Unknown",1207
"Distraction (Distracted), Details Unknown",251
Distraction/Inattention,421
While Manipulating Cellular Phone,154
Other Cellular Phone Related,190
"Distracted by Outside Person, Object or Event",186
While Using or Reaching For Device/Object Brought Into Vehicle,75
Eating or Drinking,48
Looked But Did Not See,389
While Talking or Listening to Cellular Phone,116
By Other Occupant(s),164
While Adjusting Audio or Climate Controls,43
Careless/Inattentive,48
Lost In Thought/Day Dreaming,15
By a Moving Object in Vehicle,10
Smoking Related,14
While Using Other Component/Controls Integral to Vehicle,35
Distraction/Careless,7

2025-02-11 07:28:23 - root - INFO - itercount: 0
2025-02-11 07:28:23 - root - INFO - Database Name: bigquery-public-data
Schema Name: census_bureau_usa
,0
table_name,population_by_zip_2010
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
(
  geo_id STRING ,
  zipcode STRING NOT NULL ,
  population INT64 ,
  minimum_age INT64 ,
  maximum_age INT64  or the row is a total of the male, female, or overall population.""),
  gender STRING 
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

Some other tables have the similar structure: ['population_by_zip_2010', 'population_by_zip_2000']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,0
table_name, factor_2018
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. factor_2018`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  contributing_circumstances_motor_vehicle INT64 ,
  contributing_circumstances_motor_vehicle_name STRING 
);"

Some other tables have the similar structure: [' factor_2018', ' factor_2016', ' factor_2020', ' factor_2015', ' factor_2019', ' factor_2017']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,1
table_name,maneuver_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.maneuver_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  driver_maneuvered_to_avoid INT64  this driver attempted to avoid while the vehicle was on the road portion of the trafficway, just prior to the first harmful event for this vehicle. For more info on the codes, please look at <PC15 Driver Maneuvered to Avoid> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  driver_maneuvered_to_avoid_name STRING  this driver attempted to avoid while the vehicle was on the road portion of the trafficway, just prior to the first harmful event for this vehicle."")
);"

Some other tables have the similar structure: ['maneuver_2016', 'maneuver_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,2
table_name,vsoe_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.vsoe_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  vehicle_event_number INT64 ,
  sequence_of_events INT64 ,
  sequence_of_events_name STRING ,
  area_of_Impact_associated_with_the_event INT64 ,
  area_of_Impact_associated_with_the_event_name STRING 
);"

Some other tables have the similar structure: ['vsoe_2016', 'vsoe_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,3
table_name,safetyeq_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.safetyeq_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  non_motorist_safety_equipment_use STRING  3 Reflective Clothing (Jacket, Backpack, etc.) 4 Protective Pads (Elbows, Knees, Shins, etc.) 5 Lighting 7 Other Safety Equipment 8 Not Reported 9 Unknown if Used"")
);"

Some other tables have the similar structure: ['safetyeq_2016', 'safetyeq_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,4
table_name, drimpair_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. drimpair_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  condition_impairment_at_time_of_crash_driver INT64  at Time of Crash- Driver> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  condition_impairment_at_time_of_crash_driver_name STRING 
);"

Some other tables have the similar structure: [' drimpair_2016', ' drimpair_2015', ' drimpair_2019', ' drimpair_2017', ' drimpair_2020', ' drimpair_2018']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,5
table_name, safetyeq_2017
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. safetyeq_2017`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  nm_helmet STRING ,
  nm_helmet_name STRING ,
  nm_propad STRING  from injury.""),
  nm_propad_name STRING  from injury.""),
  nm_othpro STRING .""),
  nm_othpro_name STRING .""),
  nm_refclo STRING .""),
  nm_refclo_name STRING .""),
  nm_light STRING ,
  nm_light_name STRING ,
  nm_othpre STRING .""),
  nm_othpre_name STRING ."")
);"

Some other tables have the similar structure: [' safetyeq_2017', ' safetyeq_2020', ' safetyeq_2015', ' safetyeq_2016', ' safetyeq_2019', ' safetyeq_2018']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,6
table_name,nmcrash_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.nmcrash_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  non_motorist_contributing_circumstances INT64  and/or circumstances of this non-motorist that law enforcement indicated may have contributed to the crash. For more info on the codes, please look at <NM12 Non-Motorist Contributing Circumstances> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  non_motorist_contributing_circumstances_name STRING  and/or circumstances of this non-motorist that law enforcement indicated may have contributed to the crash."")
)
OPTIONS(
  description=""This data file contains information about any contributing\ncircumstances or improper actions of people who are not occupants of motor vehicles\n(e.g., pedestrians and bicyclists) noted on the PAR. There is one record per action and\nthere is at least one record for each person who is not an occupant of a motor vehicle.""
);"

Some other tables have the similar structure: ['nmcrash_2015', 'nmcrash_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,7
table_name, maneuver_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. maneuver_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  driver_maneuvered_to_avoid INT64  this driver attempted to avoid while the vehicle was on the road portion of the trafficway, just prior to the first harmful event for this vehicle. For more info on the codes, please look at <PC15 Driver Maneuvered to Avoid> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  driver_maneuvered_to_avoid_name STRING  this driver attempted to avoid while the vehicle was on the road portion of the trafficway, just prior to the first harmful event for this vehicle."")
);"

Some other tables have the similar structure: [' maneuver_2015', ' maneuver_2020', ' maneuver_2018', ' maneuver_2016', ' maneuver_2019', ' maneuver_2017']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,8
table_name,drimpair_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.drimpair_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  condition_impairment_at_time_of_crash_driver INT64  at Time of Crash- Driver> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  condition_impairment_at_time_of_crash_driver_name STRING 
);"

Some other tables have the similar structure: ['drimpair_2016', 'drimpair_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,9
table_name, vsoe_2017
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. vsoe_2017`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  vehicle_event_number INT64 ,
  sequence_of_events INT64 ,
  sequence_of_events_name STRING ,
  area_of_Impact_associated_with_the_event INT64 ,
  area_of_Impact_associated_with_the_event_name STRING 
);"

Some other tables have the similar structure: [' vsoe_2017', ' vsoe_2015', ' vsoe_2016', ' vsoe_2018', ' vsoe_2020', ' vsoe_2019']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,10
table_name, damage_2017
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. damage_2017`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  damaged_areas INT64 ,
  damaged_areas_name STRING 
);"

Some other tables have the similar structure: [' damage_2017', ' damage_2020', ' damage_2019', ' damage_2015', ' damage_2018', ' damage_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,11
table_name, accident_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. accident_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  number_of_vehicle_forms_submitted_all INT64 ,
  number_of_motor_vehicles_in_transport_mvit INT64 ,
  number_of_parked_working_vehicles INT64 ,
  number_of_forms_submitted_for_persons_not_in_motor_vehicles INT64  that are applicable to this case (i.e., non-occupants). 00-99 Number of Persons Not in Motor Vehicles""),
  number_of_forms_submitted_for_persons_in_motor_vehicles INT64  Forms that are applicable to this case (i.e., occupants). 000-999 Number of Person Forms""),
  number_of_persons_in_motor_vehicles_in_transport_mvit INT64 ,
  number_of_persons_not_in_motor_vehicles_in_transport_mvit INT64 , or an other non-motorist (e.g., person outside a trafficway, person in a house). 0-98 Number of Persons Not in Motor Vehicles in Transport""),
  county INT64  publication of worldwide Geographic Location Codes (GLC). 000 Not Applicable 001-996 Use GSA Geographical Codes 997 Other 998 Not Reported 999 Unknown""),
  county_name STRING  publication of worldwide Geographic Location Codes (GLC). 000 Not Applicable 001-996 Use GSA Geographical Codes 997 Other 998 Not Reported 999 Unknown""),
  city INT64  publication of worldwide Geographic Location Codes (GLC). 0000 Not Applicable 0001-9996 GSA Geographical Codes 9997 Other 9898 Not Reported 9999 Unknown""),
  city_name STRING  publication of worldwide Geographic Location Codes (GLC). 0000 Not Applicable 0001-9996 GSA Geographical Codes 9997 Other 9898 Not Reported 9999 Unknown""),
  day_of_crash INT64 ,
  day_name STRING ,
  month_of_crash INT64 ,
  month_of_crash_name STRING ,
  year_of_crash INT64 ,
  day_of_week INT64 ,
  day_of_week_name STRING ,
  hour_of_crash INT64 ,
  hour_of_crash_name STRING ,
  minute_of_crash INT64 ,
  minute_of_crash_name STRING ,
  national_highway_system INT64 ,
  national_highway_system_name STRING ,
  route_signing INT64  8 Other 9 Unknown""),
  route_signing_name STRING ,
  trafficway_identifier STRING  999999999999999999999999999999 Unknown""),
  trafficway_identifier_2 STRING  999999999999999999999999999999 Unknown""),
  land_use INT64 , 2 (Urban), 6 (Trafficway Not in State Inventory), 8 (Not Reported) and 9 (Unknown).""),
  land_use_name STRING , 2 (Urban), 6 (Trafficway Not in State Inventory), 8 (Not Reported) and 9 (Unknown).""),
  functional_system INT64 , 02 (Principal Arterial – Other Freeways and Expressways), 03 (Principal Arterial – Other), 04 (Minor Arterial), 05 (Major Collector), 06 (Minor Collector), 07 (Local), 96 (Trafficway Not in State Inventory), 98 (Not Reported), and 99 (Unknown).""),
  functional_system_name STRING , 02 (Principal Arterial – Other Freeways and Expressways), 03 (Principal Arterial – Other), 04 (Minor Arterial), 05 (Major Collector), 06 (Minor Collector), 07 (Local), 96 (Trafficway Not in State Inventory), 98 (Not Reported), and 99 (Unknown).""),
  ownership INT64 ,
  ownership_name STRING ,
  milepoint INT64  99998 Not Reported 99999 Unknown""),
  milepoint_name STRING  99998 Not Reported 99999 Unknown""),
  latitude FLOAT64  DD.DDDD Actual Degrees 77.7777 Not Reported 88.8888 Not Available (If State Exempt) 99.9999 Unknown""),
  latitude_name STRING  DD.DDDD Actual Degrees 77.7777 Not Reported 88.8888 Not Available (If State Exempt) 99.9999 Unknown""),
  longitude FLOAT64  DDD.DDDD Actual Degrees 777.7777 Not Reported 888.8888 Not Available (If State Exempt) 999.9999 Unknown""),
  longitude_name STRING  DDD.DDDD Actual Degrees 777.7777 Not Reported 888.8888 Not Available (If State Exempt) 999.9999 Unknown""),
  special_jurisdiction INT64 . 0 No Special Jurisdiction (Includes National Forests Since 2008) 1 National Park Service 2 Military 3 Indian Reservation 4 College/University Campus 5 Other Federal Properties (Since 1977) 8 Other (Since 1976) 9 Unknown""),
  special_jurisdiction_name STRING .""),
  first_harmful_event INT64 ,
  first_harmful_event_name STRING ,
  manner_of_collision INT64 ,
  manner_of_collision_name STRING ,
  relation_to_junction_within_interchange_area INT64  and is based on the location of the “First Harmful Event” of the crash. 0 No 1 Yes 8 Not Reported 9 Unknown""),
  relation_to_junction_within_interchange_area_name STRING  and is based on the location of the “First Harmful Event” of the crash. 0 No 1 Yes 8 Not Reported 9 Unknown""),
  relation_to_junction_specific_location INT64  and is based on the location of the “First Harmful Event” of the crash. For more info on the codes, please look at <C21B Relation to Junction- Specific Location> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  relation_to_junction_specific_location_name STRING  and is based on the location of the “First Harmful Event” of the crash.""),
  type_of_intersection INT64 ,
  type_of_intersection_name STRING ,
  work_zone INT64 ,
  work_zone_name STRING ,
  relation_to_trafficway INT64 ,
  relation_to_trafficway_name STRING ,
  light_condition INT64 ,
  light_condition_name STRING ,
  atmospheric_conditions_1 INT64 ,
  atmospheric_conditions_1_name STRING ,
  atmospheric_conditions_2 INT64 ,
  atmospheric_conditions_2_name STRING ,
  atmospheric_conditions INT64 ,
  atmospheric_conditions_name STRING ,
  school_bus_related INT64 ,
  school_bus_related_name STRING ,
  rail_grade_crossing_identifier STRING ,
  rail_grade_crossing_identifier_name STRING ,
  hour_of_notification INT64  88 Not Applicable or Not Notified 99 Unknown Hour 99 Unknown if Notified (when NOT_MIN = 98)""),
  hour_of_notification_name STRING  88 Not Applicable or Not Notified 99 Unknown Hour 99 Unknown if Notified (when NOT_MIN = 98)""),
  minute_of_notification INT64  88 Not Applicable or Not Notified 98 Unknown if Notified 99 Unknown Minutes""),
  minute_of_notification_name STRING  88 Not Applicable or Not Notified 98 Unknown if Notified 99 Unknown Minutes""),
  hour_of_arrival_at_scene INT64  -- Not Notified (when ARR_MIN = 00) 88 Not Applicable or Not Notified 99 Unknown Hour 99 Officially Cancelled (when ARR_MIN = 97) 99 Unknown if Arrived (when ARR_MIN = 98)""),
  hour_of_arrival_at_scene_name STRING  -- Not Notified (when ARR_MIN = 00) 88 Not Applicable or Not Notified 99 Unknown Hour 99 Officially Cancelled (when ARR_MIN = 97) 99 Unknown if Arrived (when ARR_MIN = 98)""),
  minute_of_arrival_at_scene INT64  -- Not Notified (when ARR_HOUR = 00) 88 Not Applicable or Not Notified 97 Officially Cancelled 98 Unknown if Arrived 99 Unknown Minutes""),
  minute_of_arrival_at_scene_name STRING  -- Not Notified (when ARR_HOUR = 00) 88 Not Applicable or Not Notified 97 Officially Cancelled 98 Unknown if Arrived 99 Unknown Minutes""),
  hour_of_ems_arrival_at_hospital INT64  -- Not Notified or Not Transported (when HOSP_MIN = 00) 88 Not Applicable or Not Notified 99 Unknown Hour 99 Officially Cancelled (when HOSP_MIN = 97) 99 Unknown if Transported (when HOSP_MIN = 98)""),
  hour_of_ems_arrival_at_hospital_name STRING  -- Not Notified or Not Transported (when HOSP_MIN = 00) 88 Not Applicable or Not Notified 99 Unknown Hour 99 Officially Cancelled (when HOSP_MIN = 97) 99 Unknown if Transported (when HOSP_MIN = 98)""),
  minute_of_ems_arrival_at_hospital INT64  -- Not Notified or Not Transported (when HOSP_HR = 00) 88 Not Applicable or Not Notified 96 Terminated Transport 97 Officially Cancelled 98 Unknown if Transported 99 Unknown Minutes""),
  minute_of_ems_arrival_at_hospital_name STRING  -- Not Notified or Not Transported (when HOSP_HR = 00) 88 Not Applicable or Not Notified 96 Terminated Transport 97 Officially Cancelled 98 Unknown if Transported 99 Unknown Minutes""),
  related_factors_crash_level_1 INT64 ,
  related_factors_crash_level_1_name STRING ,
  related_factors_crash_level_2 INT64 ,
  related_factors_crash_level_2_name STRING ,
  related_factors_crash_level_3 INT64 ,
  related_factors_crash_level_3_name STRING ,
  number_of_fatalities INT64 ,
  number_of_drunk_drivers INT64 ,
  timestamp_of_crash TIMESTAMP 
);"

Some other tables have the similar structure: [' accident_2016', ' accident_2020', ' accident_2015', ' accident_2017', ' accident_2018', ' accident_2019']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,12
table_name, pbtype_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. pbtype_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  person_type INT64 ,
  person_type_name STRING ,
  age INT64 ,
  age_name STRING ,
  sex STRING ,
  sex_name STRING ,
  marked_crosswalk_present STRING ,
  marked_crosswalk_present_name STRING ,
  sidewalk_present STRING ,
  sidewalk_present_name STRING ,
  school_zone STRING ,
  school_zone_name STRING ,
  crash_type_pedestrian INT64 ,
  crash_type_pedestrian_name STRING ,
  crash_type_bicycle INT64 ,
  crash_type_bicycle_name STRING ,
  crash_location_pedestrian STRING ,
  crash_location_pedestrian_name STRING ,
  crash_location_bicycle STRING ,
  crash_location_bicycle_name STRING ,
  pedestrian_position STRING ,
  pedestrian_position_name STRING ,
  bicyclist_position STRING ,
  bicyclist_position_name STRING ,
  pedestrian_initial_direction_of_travel STRING ,
  pedestrian_initial_direction_of_travel_name STRING ,
  bicyclist_initial_direction_of_travel STRING ,
  bicyclist_initial_direction_of_travel_name STRING ,
  motorist_initial_direction_of_travel STRING ,
  motorist_initial_direction_of_travel_name STRING ,
  motorist_maneuver STRING ,
  motorist_maneuver_name STRING ,
  intersection_leg STRING ,
  intersection_leg_name STRING ,
  pedestrian_scenario STRING ,
  pedestrian_scenario_name STRING ,
  crash_group_pedestrian INT64 ,
  crash_group_pedestrian_name STRING ,
  crash_group_bicycle INT64 ,
  crash_group_bicycle_name STRING 
);"

Some other tables have the similar structure: [' pbtype_2015', ' pbtype_2020', ' pbtype_2017', ' pbtype_2016', ' pbtype_2018', ' pbtype_2019']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,13
table_name,distract_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  driver_distracted_by INT64  which best describe this driver’s attention to driving prior to the driver’s realization of an impending critical event or just prior to impact if realization of an impending critical event does not occur. For more info on the codes, please look at <PC16 Driver Distracted By> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  driver_distracted_by_name STRING  which best describe this driver’s attention to driving prior to the driver’s realization of an impending critical event or just prior to impact if realization of an impending critical event does not occur."")
);"

Some other tables have the similar structure: ['distract_2016', 'distract_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,14
table_name, violatn_2017
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. violatn_2017`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  violations_charged STRING ,
  violations_charged_name STRING 
);"

Some other tables have the similar structure: [' violatn_2017', ' violatn_2018', ' violatn_2020', ' violatn_2016', ' violatn_2019', ' violatn_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,15
table_name, nmcrash_2018
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. nmcrash_2018`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  non_motorist_contributing_circumstances INT64  and/or circumstances of this non-motorist that law enforcement indicated may have contributed to the crash. For more info on the codes, please look at <NM12 Non-Motorist Contributing Circumstances> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  non_motorist_contributing_circumstances_name STRING  and/or circumstances of this non-motorist that law enforcement indicated may have contributed to the crash."")
);"

Some other tables have the similar structure: [' nmcrash_2018', ' nmcrash_2019', ' nmcrash_2017', ' nmcrash_2016', ' nmcrash_2020', ' nmcrash_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,16
table_name,person_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.person_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  number_of_motor_vehicles_in_transport_mvit INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  number_of_motor_vehicle_striking_non_motorist INT64  of the in-transport vehicle that made contact with this non-motorist. 000 Occupant of a Motor Vehicle 001-998 Vehicle Number of Striking Vehicle 999 Unknown""),
  county INT64  publication of worldwide Geographic Location Codes (GLC). 000 Not Applicable 001-996 Use GSA Geographical Codes 997 Other 998 Not Reported 999 Unknown""),
  day_of_crash INT64 ,
  month_of_crash INT64 ,
  hour_of_crash INT64 ,
  minute_of_crash INT64 ,
  land_use STRING , 2 (Urban), 6 (Trafficway Not in State Inventory), 8 (Not Reported) and 9 (Unknown).""),
  land_use_name STRING , 2 (Urban), 6 (Trafficway Not in State Inventory), 8 (Not Reported) and 9 (Unknown).""),
  functional_system STRING , 02 (Principal Arterial – Other Freeways and Expressways), 03 (Principal Arterial – Other), 04 (Minor Arterial), 05 (Major Collector), 06 (Minor Collector), 07 (Local), 96 (Trafficway Not in State Inventory), 98 (Not Reported), and 99 (Unknown).""),
  functional_system_name STRING , 02 (Principal Arterial – Other Freeways and Expressways), 03 (Principal Arterial – Other), 04 (Minor Arterial), 05 (Major Collector), 06 (Minor Collector), 07 (Local), 96 (Trafficway Not in State Inventory), 98 (Not Reported), and 99 (Unknown).""),
  first_harmful_event INT64 ,
  first_harmful_event_name STRING ,
  manner_of_collision INT64 ,
  manner_of_collision_name STRING ,
  school_bus_related STRING ,
  vehicle_make INT64  of this vehicle. For more info on the codes, please look at <V9 Vehicle Make> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  vehicle_make_name STRING  of this vehicle.""),
  make_model_combined INT64  followed by the 3-digit “Vehicle Model” code (MODEL). See the current FARS/NASS GES Coding and Validation Manual for vehicle make and model codes.""),
  body_type INT64 ,
  body_type_name STRING ,
  vehicle_trailing STRING ,
  special_use INT64 ,
  special_use_name STRING ,
  emergency_motor_vehicle_use STRING ,
  rollover STRING ,
  initial_contact_point INT64 ,
  initial_contact_point_name STRING ,
  fire_occurrence STRING ,
  age INT64 ,
  sex STRING ,
  person_type INT64 ,
  person_type_name STRING ,
  injury_severity INT64 ,
  injury_severity_name STRING ,
  seating_position INT64 ,
  seating_position_name STRING ,
  restraint_system_helmet_use INT64 ,
  restraint_system_helmet_use_name STRING ,
  indication_of_misuse_of_restraint_system_helmet STRING ,
  air_bag_deployed INT64 ,
  air_bag_deployed_name STRING ,
  ejection INT64  7 Not Reported 8 Not Applicable -- Unknown (2007-2008) 9 Unknown if Ejected (Since 2009)""),
  ejection_name STRING ,
  ejection_path INT64 ,
  ejection_path_name STRING ,
  extrication STRING ,
  police_reported_alcohol_involvement STRING  1 Yes (Alcohol Involved) 8 Not Reported 9 Unknown (Police Reported)""),
  method_of_alcohol_determination_by_police STRING  2 Preliminary Breath Test (PBT) 3 Behavioral 4 Passive Alcohol Sensor (PAS) 5 Observed 8 Other (e.g., Saliva Test) 9 Not Reported""),
  alcohol_test_status1 STRING ,
  alcohol_test_status2 STRING ,
  alcohol_test_status3 STRING   Test Refused (1991-2008) 995 Not Reported 996 None Given 997 AC Test Performed, Results Unknown 998 PBT Positive Reading with No Actual Value (Since 2004) -- Unknown if Tested/Not Reported 999 Unknown if Tested""),
  alcohol_test_status3_name STRING   Test Refused (1991-2008) 995 Not Reported 996 None Given 997 AC Test Performed, Results Unknown 998 PBT Positive Reading with No Actual Value (Since 2004) -- Unknown if Tested/Not Reported 999 Unknown if Tested""),
  police_reported_drug_involvement STRING  1 Yes (Drugs Involved) 8 Not Reported 9 Unknown (Police Reported)""),
  method_of_drug_determination_by_police STRING  2 Drug Recognition Technician (DRT) Determination 3 Behavioral 7 Other 8 Not Reported""),
  drug_test_status STRING ,
  drug_test_type1 STRING ,
  drug_test_type2 STRING ,
  drug_test_type3 STRING ,
  drug_test_type4 INT64 ,
  drug_test_type4_name STRING ,
  drug_test_type5 INT64 ,
  drug_test_type5_name STRING ,
  drug_test_type6 INT64 ,
  drug_test_type6_name STRING ,
  transported_to_first_treatment_facility INT64 ,
  transported_to_first_treatment_facility_name STRING ,
  died_at_scene_en_route STRING ,
  day_of_death INT64  01-31 Day of the Month of the Death 99 Unknown (Since 2008)""),
  month_of_death INT64 ,
  year_of_death INT64  xxxx Year of the Death 9999 Unknown""),
  hour_of_death INT64 ,
  minute_of_death INT64 ,
  death_time INT64  9999 Unknown""),
  lag_hours INT64 ,
  lag_minutes INT64 , between the time of the crash and this person’s time of death. 00-59 Minutes 99 Unknown""),
  related_factors_person_level1 INT64 ,
  related_factors_person_level2 INT64 ,
  related_factors_person_level3 INT64 ,
  fatal_injury_at_work STRING  1 Yes (The Injury Was At Work) 8 Not Applicable (Not A Fatality) 9 Unknown""),
  hispanic_origin INT64 ,
  hispanic_origin_name STRING ,
  race INT64 ,
  race_name STRING ,
  non_motorist_location_at_time_of_crash INT64 ,
  non_motorist_location_at_time_of_crash_name STRING ,
  timestamp_of_crash TIMESTAMP 
)
OPTIONS(
  description=""This data file contains information describing all persons\ninvolved in the crash including motorists (i.e., drivers and passengers of in-transport\nmotor vehicles) and non-motorists (e.g., pedestrians and pedalcyclists). It provides\ninformation such as age, sex, vehicle occupant restraint use, and injury severity. There\nis one record per person.""
);"

Some other tables have the similar structure: ['person_2015', 'person_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,17
table_name,factor_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.factor_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  contributing_circumstances_motor_vehicle INT64 ,
  contributing_circumstances_motor_vehicle_name STRING 
);"

Some other tables have the similar structure: ['factor_2016', 'factor_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,18
table_name,damage_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.damage_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  damaged_areas INT64 ,
  damaged_areas_name STRING 
);"

Some other tables have the similar structure: ['damage_2016', 'damage_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,19
table_name,accident_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  number_of_vehicle_forms_submitted_all INT64 ,
  number_of_motor_vehicles_in_transport_mvit INT64 ,
  number_of_parked_working_vehicles INT64 ,
  number_of_forms_submitted_for_persons_not_in_motor_vehicles INT64  that are applicable to this case (i.e., non-occupants). 00-99 Number of Persons Not in Motor Vehicles""),
  number_of_persons_not_in_motor_vehicles_in_transport_mvit INT64 , or an other non-motorist (e.g., person outside a trafficway, person in a house). 0-98 Number of Persons Not in Motor Vehicles in Transport""),
  number_of_persons_in_motor_vehicles_in_transport_mvit INT64 ,
  number_of_forms_submitted_for_persons_in_motor_vehicles INT64  Forms that are applicable to this case (i.e., occupants). 000-999 Number of Person Forms""),
  county INT64  publication of worldwide Geographic Location Codes (GLC). 000 Not Applicable 001-996 Use GSA Geographical Codes 997 Other 998 Not Reported 999 Unknown""),
  city INT64  publication of worldwide Geographic Location Codes (GLC). 0000 Not Applicable 0001-9996 GSA Geographical Codes 9997 Other 9898 Not Reported 9999 Unknown""),
  day_of_crash INT64 ,
  month_of_crash INT64 ,
  year_of_crash INT64 ,
  day_of_week INT64 ,
  hour_of_crash INT64 ,
  minute_of_crash INT64 ,
  national_highway_system INT64 ,
  land_use INT64 , 2 (Urban), 6 (Trafficway Not in State Inventory), 8 (Not Reported) and 9 (Unknown).""),
  land_use_name STRING , 2 (Urban), 6 (Trafficway Not in State Inventory), 8 (Not Reported) and 9 (Unknown).""),
  functional_system INT64 , 02 (Principal Arterial – Other Freeways and Expressways), 03 (Principal Arterial – Other), 04 (Minor Arterial), 05 (Major Collector), 06 (Minor Collector), 07 (Local), 96 (Trafficway Not in State Inventory), 98 (Not Reported), and 99 (Unknown).""),
  functional_system_name STRING , 02 (Principal Arterial – Other Freeways and Expressways), 03 (Principal Arterial – Other), 04 (Minor Arterial), 05 (Major Collector), 06 (Minor Collector), 07 (Local), 96 (Trafficway Not in State Inventory), 98 (Not Reported), and 99 (Unknown).""),
  ownership INT64 ,
  ownership_name STRING ,
  route_signing INT64  8 Other 9 Unknown""),
  route_signing_name STRING ,
  trafficway_identifier STRING  999999999999999999999999999999 Unknown""),
  trafficway_identifier_2 STRING  999999999999999999999999999999 Unknown""),
  milepoint INT64  99998 Not Reported 99999 Unknown""),
  latitude FLOAT64  DD.DDDD Actual Degrees 77.7777 Not Reported 88.8888 Not Available (If State Exempt) 99.9999 Unknown""),
  longitude FLOAT64  DDD.DDDD Actual Degrees 777.7777 Not Reported 888.8888 Not Available (If State Exempt) 999.9999 Unknown""),
  special_jurisdiction INT64 . 0 No Special Jurisdiction (Includes National Forests Since 2008) 1 National Park Service 2 Military 3 Indian Reservation 4 College/University Campus 5 Other Federal Properties (Since 1977) 8 Other (Since 1976) 9 Unknown""),
  special_jurisdiction_name STRING .""),
  first_harmful_event INT64 ,
  first_harmful_event_name STRING ,
  manner_of_collision INT64 ,
  manner_of_collision_name STRING ,
  relation_to_junction_within_interchange_area STRING  and is based on the location of the “First Harmful Event” of the crash. 0 No 1 Yes 8 Not Reported 9 Unknown""),
  relation_to_junction_specific_location INT64  and is based on the location of the “First Harmful Event” of the crash. For more info on the codes, please look at <C21B Relation to Junction- Specific Location> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  relation_to_junction_specific_location_name STRING  and is based on the location of the “First Harmful Event” of the crash.""),
  type_of_intersection STRING ,
  work_zone STRING ,
  relation_to_trafficway INT64 ,
  relation_to_trafficway_name STRING ,
  light_condition INT64 ,
  light_condition_name STRING ,
  atmospheric_conditions_1 INT64 ,
  atmospheric_conditions_1_name STRING ,
  atmospheric_conditions_2 INT64 ,
  atmospheric_conditions_2_name STRING ,
  atmospheric_conditions INT64 ,
  atmospheric_conditions_name STRING ,
  school_bus_related STRING ,
  rail_grade_crossing_identifier STRING ,
  hour_of_notification INT64  88 Not Applicable or Not Notified 99 Unknown Hour 99 Unknown if Notified (when NOT_MIN = 98)""),
  minute_of_notification INT64  88 Not Applicable or Not Notified 98 Unknown if Notified 99 Unknown Minutes""),
  hour_of_arrival_at_scene INT64  -- Not Notified (when ARR_MIN = 00) 88 Not Applicable or Not Notified 99 Unknown Hour 99 Officially Cancelled (when ARR_MIN = 97) 99 Unknown if Arrived (when ARR_MIN = 98)""),
  minute_of_arrival_at_scene INT64  -- Not Notified (when ARR_HOUR = 00) 88 Not Applicable or Not Notified 97 Officially Cancelled 98 Unknown if Arrived 99 Unknown Minutes""),
  hour_of_ems_arrival_at_hospital INT64  -- Not Notified or Not Transported (when HOSP_MIN = 00) 88 Not Applicable or Not Notified 99 Unknown Hour 99 Officially Cancelled (when HOSP_MIN = 97) 99 Unknown if Transported (when HOSP_MIN = 98)""),
  minute_of_ems_arrival_at_hospital INT64  -- Not Notified or Not Transported (when HOSP_HR = 00) 88 Not Applicable or Not Notified 96 Terminated Transport 97 Officially Cancelled 98 Unknown if Transported 99 Unknown Minutes""),
  related_factors_crash_level_1 INT64 ,
  related_factors_crash_level_1_name STRING ,
  related_factors_crash_level_2 INT64 ,
  related_factors_crash_level_2_name STRING ,
  related_factors_crash_level_3 INT64 ,
  related_factors_crash_level_3_name STRING ,
  number_of_fatalities INT64 ,
  number_of_drunk_drivers INT64 ,
  timestamp_of_crash TIMESTAMP 
);"

Some other tables have the similar structure: ['accident_2016', 'accident_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,20
table_name, cevent_2019
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. cevent_2019`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  event_number INT64 ,
  vehicle_number_this_vehicle INT64  of this in-transport motor vehicle described in this event. 1-999 Vehicle Number""),
  area_of_impact_this_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_this_vehicle_name STRING ,
  sequence_of_events INT64 ,
  sequence_of_events_name STRING ,
  vehicle_number_other_vehicle INT64  of the other motor vehicle, if any, in this event. 1-999 Vehicle Number 5555 Non-Harmful Event 9999 Not a Motor Vehicle""),
  vehicle_number_other_vehicle_name STRING  of the other motor vehicle, if any, in this event. 1-999 Vehicle Number 5555 Non-Harmful Event 9999 Not a Motor Vehicle""),
  area_of_impact_other_vehicle STRING > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_other_vehicle_name STRING 
);"

Some other tables have the similar structure: [' cevent_2019', ' cevent_2017', ' cevent_2016', ' cevent_2020', ' cevent_2018', ' cevent_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,21
table_name, distract_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. distract_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  driver_distracted_by INT64  which best describe this driver’s attention to driving prior to the driver’s realization of an impending critical event or just prior to impact if realization of an impending critical event does not occur. For more info on the codes, please look at <PC16 Driver Distracted By> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  driver_distracted_by_name STRING  which best describe this driver’s attention to driving prior to the driver’s realization of an impending critical event or just prior to impact if realization of an impending critical event does not occur."")
);"

Some other tables have the similar structure: [' distract_2015', ' distract_2017', ' distract_2018', ' distract_2016', ' distract_2019', ' distract_2020']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,22
table_name, nmimpair_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. nmimpair_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  condition_impairment_at_time_of_crash_non_motorist INT64  at Time of Crash- Non-Motorist> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  condition_impairment_at_time_of_crash_non_motorist_name STRING 
);"

Some other tables have the similar structure: [' nmimpair_2016', ' nmimpair_2015', ' nmimpair_2018', ' nmimpair_2019', ' nmimpair_2017', ' nmimpair_2020']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,23
table_name,pbtype_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.pbtype_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  person_type INT64 ,
  person_type_name STRING ,
  age INT64 ,
  sex STRING ,
  marked_crosswalk_present STRING ,
  sidewalk_present STRING ,
  school_zone STRING ,
  crash_type_pedestrian INT64 ,
  crash_type_pedestrian_name STRING ,
  crash_type_bicycle INT64 ,
  crash_type_bicycle_name STRING ,
  crash_location_pedestrian STRING ,
  crash_location_bicycle STRING ,
  pedestrian_position STRING ,
  bicyclist_position STRING ,
  pedestrian_initial_direction_of_travel STRING ,
  bicyclist_initial_direction_of_travel STRING ,
  motorist_initial_direction_of_travel STRING ,
  motorist_maneuver STRING ,
  intersection_leg STRING ,
  pedestrian_scenario STRING ,
  pedestrian_scenario_name STRING ,
  crash_group_pedestrian INT64 ,
  crash_group_pedestrian_name STRING ,
  crash_group_bicycle INT64 ,
  crash_group_bicycle_name STRING 
)
OPTIONS(
  description=""This data file contains information about crashes between\nmotor vehicles and pedestrians, people on personal conveyances and bicyclists. Data\nfrom the crash are enter into the Pedestrian and Bicycle Crash Analysis Tool (PBCAT).\nThe output fields from PBCAT, including the pre-crash actions of the parties involved\n(crash type), are included in this data set. There is one record for each pedestrian,\nbicyclist or person on a personal conveyance.""
);"

Some other tables have the similar structure: ['pbtype_2015', 'pbtype_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,24
table_name, nmprior_2018
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. nmprior_2018`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  non_motorist_action_circumstances INT64  of the non-motorist immediately prior to their involvement in the crash. For more info on the codes, please look at <NM11 Non-Motorist Action/Circumstances> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  non_motorist_action_circumstances_name STRING  of the non-motorist immediately prior to their involvement in the crash."")
);"

Some other tables have the similar structure: [' nmprior_2018', ' nmprior_2019', ' nmprior_2020', ' nmprior_2015', ' nmprior_2017', ' nmprior_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,25
table_name, vevent_2019
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. vevent_2019`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  event_number INT64 ,
  vehicle_number INT64 ,
  vehicle_event_number STRING ,
  vehicle_number_this_vehicle INT64  of this in-transport motor vehicle described in this event. 1-999 Vehicle Number""),
  area_of_impact_this_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_this_vehicle_name STRING > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  sequence_of_events INT64 ,
  sequence_of_events_name STRING ,
  vehicle_number_other_vehicle INT64  of the other motor vehicle, if any, in this event. 1-999 Vehicle Number 5555 Non-Harmful Event 9999 Not a Motor Vehicle""),
  vehicle_number_other_vehicle_name STRING  of the other motor vehicle, if any, in this event. 1-999 Vehicle Number 5555 Non-Harmful Event 9999 Not a Motor Vehicle""),
  area_of_impact_other_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_other_vehicle_name STRING > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315"")
);"

Some other tables have the similar structure: [' vevent_2019', ' vevent_2017', ' vevent_2016', ' vevent_2018', ' vevent_2020', ' vevent_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,26
table_name,violatn_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.violatn_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  violations_charged STRING ,
  violations_charged_name STRING 
);"

Some other tables have the similar structure: ['violatn_2016', 'violatn_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,27
table_name, parkwork_2019
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. parkwork_2019`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  number_of_motor_vehicles_in_transport_mvit INT64 ,
  number_of_occupants INT64 ,
  number_of_occupants_name STRING ,
  day_of_crash INT64 ,
  day_of_crash_name STRING ,
  month_of_crash INT64 ,
  month_of_crash_name STRING ,
  hour_of_crash INT64 ,
  hour_of_crash_name STRING ,
  minute_of_crash INT64 ,
  minute_of_crash_name STRING ,
  first_harmful_event INT64 ,
  first_harmful_event_name STRING ,
  manner_of_collision INT64 ,
  manner_of_collision_name STRING ,
  unit_type INT64 ""),
  unit_type_name STRING ""),
  hit_and_run INT64 . Hit and run is coded when a motor vehicle in-transport, or its driver, departs from the scene; vehicles not intransport are excluded. It does not matter whether the hit-and-run vehicle was striking or struck. 0 No / No Hit-and-Run -- Hit Motor Vehicle in Transport 1 Yes -- Hit Pedestrian or Non-Motorist -- Hit Parked Vehicle (Working Vehicle, Since 2004) or Object -- Other Involved Person, not a driver, left Scene (2005-2006) -- Hit-and-Run, Other Involved Person Left Scene (2007-2008) -- Not Reported 9 Unknown""),
  hit_and_run_name STRING . Hit and run is coded when a motor vehicle in-transport, or its driver, departs from the scene; vehicles not intransport are excluded. It does not matter whether the hit-and-run vehicle was striking or struck. 0 No / No Hit-and-Run -- Hit Motor Vehicle in Transport 1 Yes -- Hit Pedestrian or Non-Motorist -- Hit Parked Vehicle (Working Vehicle, Since 2004) or Object -- Other Involved Person, not a driver, left Scene (2005-2006) -- Hit-and-Run, Other Involved Person Left Scene (2007-2008) -- Not Reported 9 Unknown""),
  registration_state INT64 ,
  registration_state_name STRING ,
  registered_vehicle_owner INT64  Was Registered Owner 2 Driver (of This Vehicle) Not Registered Owner (Other Private Owner) 3 Vehicle Registered as Business/Company/Government Vehicle 4 Vehicle Registered as Rental Vehicle 5 Vehicle Was Stolen (Reported By Police) -- Driverless Vehicle 6 Driverless/Motor Vehicle Parked/Stopped Off Roadway 9 Unknown""),
  registered_vehicle_owner_name STRING ,
  vehicle_make INT64  of this vehicle.For more info on the codes, please look at <V9 Vehicle Make> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  vehicle_make_name STRING  of this vehicle.""),
  vehicle_model INT64 ,
  make_model_combined STRING  followed by the 3-digit “Vehicle Model” code (MODEL).See the current FARS/NASS GES Coding and Validation Manual for vehicle make and model codes.""),
  body_type INT64 ,
  body_type_name STRING ,
  vehicle_model_year INT64 ,
  vehicle_model_year_name STRING ,
  vehicle_identification_number_vin STRING  of this vehicle assigned by the vehicle manufacturer. The VIN contains information on the vehicle such as: manufacturer, model year, model, body type, restraint type, etc.-- First 10 Characters xxxxxxxxxxxx First 12 Characters 000000000000 No VIN Required 888888888888 Not Reported 999999999999 Unknown""),
  vehicle_identification_number_vin_name STRING  of this vehicle assigned by the vehicle manufacturer. The VIN contains information on the vehicle such as: manufacturer, model year, model, body type, restraint type, etc.-- First 10 Characters xxxxxxxxxxxx First 12 Characters 000000000000 No VIN Required 888888888888 Not Reported 999999999999 Unknown""),
  vin_character_1 STRING ,
  vin_character_2 STRING ,
  vin_character_3 STRING ,
  vin_character_4 STRING ,
  vin_character_5 STRING ,
  vin_character_6 STRING ,
  vin_character_7 STRING ,
  vin_character_8 STRING ,
  vin_character_9 STRING ,
  vin_character_10 STRING ,
  vin_character_11 STRING ,
  vin_character_12 STRING ,
  vehicle_trailing INT64 ,
  vehicle_trailing_name STRING ,
  mcid_issuing_authority INT64  77 Not Reported 88 None 95 Canada 96 Mexico 99 Unknown""),
  mcid_issuing_authority_name STRING  77 Not Reported 88 None 95 Canada 96 Mexico 99 Unknown""),
  mcid_identification_number STRING ,
  mcid_identification_number_name STRING ,
  motor_carrier_identification_number STRING ,
  motor_carrier_identification_number_name STRING ,
  gross_vehicle_weight_rating INT64 ,
  gross_vehicle_weight_rating_name STRING ,
  vehicle_configuration INT64 ,
  vehicle_configuration_name STRING ,
  cargo_body_type INT64 ,
  cargo_body_type_name STRING ,
  hazardous_material_involvement INT64 ,
  hazardous_material_involvement_name STRING ,
  hazardous_material_placard INT64 ,
  hazardous_material_placard_name STRING ,
  hazardous_material_identification_number INT64 ,
  hazardous_material_identification_number_name STRING ,
  hazardous_material_class_number INT64 ,
  hazardous_material_class_number_name STRING ,
  release_of_hazardous_material_from_the_cargo_compartment INT64 ,
  release_of_hazardous_material_from_the_cargo_compartment_name STRING ,
  bus_use INT64 ,
  bus_use_name STRING ,
  special_use INT64 ,
  special_use_name STRING ,
  emergency_motor_vehicle_use INT64 ,
  emergency_motor_vehicle_use_name STRING ,
  underride_override INT64 ,
  underride_override_name STRING ,
  initial_contact_point INT64 ,
  initial_contact_point_name STRING ,
  extent_of_damage INT64 ,
  extent_of_damage_name STRING ,
  vehicle_removal INT64 ,
  vehicle_removal_name STRING ,
  most_harmful_event INT64 ,
  most_harmful_event_name STRING ,
  related_factors_vehicle_level1 INT64 ,
  related_factors_vehicle_level1_name STRING ,
  related_factors_vehicle_level2 INT64 ,
  related_factors_vehicle_level2_name STRING ,
  fire_occurrence INT64 ,
  fire_occurrence_name STRING ,
  fatalities_in_vehicle INT64 ,
  ptrlr1vin STRING  of any trailing units of a combination vehicle.""),
  ptrlr1vinname STRING  of any trailing units of a combination vehicle.""),
  ptrlr2vin STRING  of any trailing units of a combination vehicle.""),
  ptrlr2vinname STRING  of any trailing units of a combination vehicle.""),
  ptrlr3vin STRING  of any trailing units of a combination vehicle.""),
  ptrlr3vinname STRING  of any trailing units of a combination vehicle."")
);"

Some other tables have the similar structure: [' parkwork_2019', ' parkwork_2018', ' parkwork_2016', ' parkwork_2015', ' parkwork_2020', ' parkwork_2017']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,28
table_name,vision_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.vision_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  drivers_vision_obscured_by INT64 ,
  drivers_vision_obscured_by_name STRING 
)
OPTIONS(
  description=""This data file contains information about circumstances which\nmay have obscured the driver’s vision. There is at least one record per in-transport\nmotor vehicle. Each obstruction is a separate record.""
);"

Some other tables have the similar structure: ['vision_2015', 'vision_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,29
table_name, vision_2019
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. vision_2019`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  drivers_vision_obscured_by INT64 ,
  drivers_vision_obscured_by_name STRING 
);"

Some other tables have the similar structure: [' vision_2019', ' vision_2020', ' vision_2017', ' vision_2018', ' vision_2016', ' vision_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,30
table_name, vindecode_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities. vindecode_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  state_name STRING  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  vehicle_make STRING ,
  marketing_year INT64 ,
  vehicle_type_code STRING ,
  vehicle_type STRING ,
  make_name STRING  Full name of the make (i.e. Chevrolet)""),
  model_code STRING  description""),
  vehicle_trim STRING ,
  vehicle_trim_1 STRING ,
  vehicle_trim_2 STRING ,
  vehicle_trim_3 STRING ,
  vehicle_trim_4 STRING ,
  body_style_code STRING ,
  body_style STRING ,
  num_of_doors INT64 ,
  number_of_wheels INT64 ,
  num_of_wheels_by_power_train INT64 ,
  vehicle_manufacturer_code STRING  Standard abbreviation of the name of the vehicle manufacturer, i.e. General Motors, as defined by the National Crime Information Center""),
  vehicle_manufacturer_name STRING  The name of the vehicle manufacturer, i.e. General Motors, as defined by the National Crime Information Center""),
  displacement_cid INT64  displacement in cubic inches. This is a rounded, marketing value, like 302 cubic inches, instead of 4967 cc.""),
  displacement_cc INT64  displacement in cubic centimeters. We intend to use this as the definitive, exact displacement value, i.e. 4967 cc.""),
  cylinder_count_code STRING ,
  cycle_count INT64  Refers to the cycle or stroke of an engine. 2-strokes are lightweight and simpler, but they burn oil, by design. Few cars on the road in North America are two-strokes, the last one offered was a 1967 Saab.""),
  fuel_code STRING  What an internal combustion burns to move a piston in a cylinder""),
  fuel STRING  description""),
  type_of_fuel_code STRING ,
  type_of_fuel STRING ,
  carburetion_types_code STRING ,
  carburetion_types STRING ,
  num_of_barrels STRING ,
  gross_vehicle_weights_range_code INT64 ,
  gross_vehicle_weights_range STRING  for trucks. This rating may or may not equal the actual GVW.""),
  distance_between_axles_for_base_model FLOAT64 ,
  distance_between_axles_for_particular_series STRING ,
  front_tire INT64  More specific tire description (ex. Michelin Eagle P245/40ZR)""),
  front_tire_pressure INT64  Vehicle Mfr. recommendation for tire pressure, in pounds/sq. in.""),
  front_tire_size_code STRING ,
  front_tire_size STRING  As in '17R245'""),
  rear_tire INT64  More specific tire description (ex. Michelin Eagle P245/40ZR)""),
  rear_tire_pressure INT64  Vehicle Mfr. recommendation for tire pressure, in pounds/sq. in.""),
  rear_tire_size_code STRING ,
  rear_tire_size STRING  As in '17R245'""),
  tonnage_rating STRING  description""),
  shipping_weight STRING ""),
  base_price STRING ,
  drive_type_1 STRING  This element describes type of driving configuration for cars and trucks such as FWD, AWD, RWD.""),
  drive_type_2 STRING  description""),
  country_sold_code STRING  Country where the vehicle is planned to be sold (may have different emissions standards).""),
  country_sold STRING  description""),
  brakes_abs_code STRING  A code that describes whether a vehicle has or does not have anti-lock brakes, and what kind of brakes they are. (Not coded for heavy truck). This is based on the series code that is assigned the vehicle from VINA.""),
  brakes_abs_description STRING  description""),
  security_type_code STRING  Describes the security system (if any) installed on this model.""),
  security_type STRING  description""),
  daytime_running_lights_1 STRING A Polk assigned code that identifies whether or not the vehicle has daytime running lights.""),
  daytime_running_lights_2 STRING  description""),
  restraint_type_code STRING  A Polk assigned code that identifies the type of restraints that a vehicle has based on VIN.""),
  restraint_type STRING  description""),
  cab_configuration_code STRING  Cab Type describes the physical configuration of a truck's cabin.""),
  cab_configuration STRING  medium description""),
  axle_type_front_axle_code STRING  The location of the front axle of a truck tractor. Set forward increases stability on the highway, Setback increases maneuverability in tight spaces.""),
  axle_type_front_axle STRING  short description""),
  axle_type_rear_axle_code STRING  Represents rear axle configuration on a truck tractor. Tandem axles increase load bearing capability.""),
  axle_type_rear_axle STRING  short description""),
  brake_type_code STRING  The type of brakes on the Vehicle (currently commercial truck only). Truck VIN determines this currently""),
  brake_type STRING  description""),
  engine_manufacture_code STRING  A Polk assigned code given to the original equipment manufacture of the within a vehicle""),
  engine_manufacture STRING  description""),
  engine_model STRING  description""),
  duty_type_code STRING  A Polk assigned code that represents the duty type of a truck engine, based on manufacturer information.""),
  duty_type STRING  medium description""),
  bed_length_code STRING  Code representing the manufacturer's description of the relative size of the cargo area of a pickup truck or van. A 'long' Ford Ranger bed (compact pickup) may well be shorter than a 'short' bed on an F350 (large industrial pickup).""),
  bed_length STRING  description""),
  standard_segmentation_code STRING ,
  standard_segmentation STRING ,
  plant_code STRING  Plant code where vehicle was manufactured.""),
  plant_country STRING  This is the country where the plant is located. Example values are USA, Canada and Japan.""),
  plant_city STRING  This is the city where the plant is located.""),
  plant_country_code STRING ,
  plant_state_code STRING ,
  plant_state STRING  This is the state or province (Canada) location of the plant.""),
  origin_code STRING  A code that indicates the origin of a vehicle.""),
  origin STRING  description""),
  displacement_liters FLOAT64  displacement in rounded Liters, where 1,000 cubic centimeters = 1 liter. Even domestic makes will advertise displacement in terms of liters (e.g. 5.0 liter mustang, which equates to a 302 CID or 4967 cc displacement).""),
  block_type STRING  Description""),
  head_configuration_1 STRING  Describes the cylinder head's camshaft/valve configuration.""),
  head_configuration_2 STRING  description""),
  valves_per_cylinder INT64  Number of intake/exhaust valves per cylinder.""),
  valves_total INT64  Total number of intake/exhaust valves.""),
  engine_code STRING  Code derived from the VIN (not the secondary VIN for a motorcycle). Usually a single character, some manufactures give full positions 4-8 and engine information from that; they do not break it down any further.""),
  is_incomplete STRING ""),
  battery_type_code STRING ,
  battery_type STRING ,
  total_battery_power STRING ,
  battery_voltage STRING ,
  supercharge_flag STRING ,
  supercharge_flag_description STRING ,
  turbocharger_flag STRING ,
  turbocharger_flag_description STRING ,
  variable_valve_timing_flag STRING ,
  motorcycles_body_style_code STRING ,
  motorcycles_body_style STRING 
);"

Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,31
table_name,vevent_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.vevent_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  event_number INT64 ,
  vehicle_number INT64 ,
  vehicle_event_number INT64 ,
  vehicle_number_this_vehicle INT64  of this in-transport motor vehicle described in this event. 1-999 Vehicle Number""),
  area_of_impact_this_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_this_vehicle_name STRING > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  sequence_of_events INT64 ,
  sequence_of_events_name STRING ,
  vehicle_number_other_vehicle INT64  of the other motor vehicle, if any, in this event. 1-999 Vehicle Number 5555 Non-Harmful Event 9999 Not a Motor Vehicle""),
  area_of_impact_other_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_other_vehicle_name STRING > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315"")
)
OPTIONS(
  description=""This data file contains the sequence of events for each intransport\nmotor vehicle involved in the crash. This data file has the same data elements\nas the Cevent data file. In addition, this data file has a data element that records the\nsequential event number for each vehicle (VEVENTNUM). There is one record for each\nevent for each in-transport motor vehicle.""
);"

Some other tables have the similar structure: ['vevent_2015', 'vevent_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,32
table_name,vindecode_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.vindecode_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC).""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  vehicle_make STRING ,
  marketing_year INT64 ,
  vehicle_type_code STRING ,
  vehicle_type STRING ,
  make_name STRING  Full name of the make (i.e. Chevrolet)""),
  model_code STRING  description""),
  vehicle_trim STRING ,
  vehicle_trim_1 STRING ,
  vehicle_trim_2 STRING ,
  vehicle_trim_3 STRING ,
  vehicle_trim_4 STRING ,
  body_style_code STRING ,
  body_style STRING ,
  num_of_doors INT64 ,
  number_of_wheels INT64 ,
  num_of_wheels_by_power_train INT64 ,
  vehicle_manufacturer_code STRING  Standard abbreviation of the name of the vehicle manufacturer, i.e. General Motors, as defined by the National Crime Information Center""),
  vehicle_manufacturer_name STRING  The name of the vehicle manufacturer, i.e. General Motors, as defined by the National Crime Information Center""),
  displacement_cid INT64  displacement in cubic inches. This is a rounded, marketing value, like 302 cubic inches, instead of 4967 cc.""),
  displacement_cc INT64  displacement in cubic centimeters. We intend to use this as the definitive, exact displacement value, i.e. 4967 cc.""),
  cylinder_count_code STRING ,
  cycle_count INT64  Refers to the cycle or stroke of an engine. 2-strokes are lightweight and simpler, but they burn oil, by design. Few cars on the road in North America are two-strokes, the last one offered was a 1967 Saab.""),
  fuel_code STRING  What an internal combustion burns to move a piston in a cylinder""),
  fuel STRING  description""),
  type_of_fuel_code STRING ,
  type_of_fuel STRING ,
  carburetion_types_code STRING ,
  carburetion_types STRING ,
  num_of_barrels STRING ,
  gross_vehicle_weights_range_code INT64 ,
  gross_vehicle_weights_range STRING  for trucks. This rating may or may not equal the actual GVW.""),
  distance_between_axles_for_base_model FLOAT64 ,
  distance_between_axles_for_particular_series STRING ,
  front_tire INT64  More specific tire description (ex. Michelin Eagle P245/40ZR)""),
  front_tire_pressure INT64  Vehicle Mfr. recommendation for tire pressure, in pounds/sq. in.""),
  front_tire_size_code STRING ,
  front_tire_size STRING  As in \""17R245\""""),
  rear_tire INT64  More specific tire description (ex. Michelin Eagle P245/40ZR)""),
  rear_tire_pressure INT64  Vehicle Mfr. recommendation for tire pressure, in pounds/sq. in.""),
  rear_tire_size_code STRING ,
  rear_tire_size STRING  As in \""17R245\""""),
  tonnage_rating STRING  description""),
  shipping_weight INT64 ""),
  base_price STRING ,
  drive_type_1 STRING  This element describes type of driving configuration for cars and trucks such as FWD, AWD, RWD.""),
  drive_type_2 STRING  description""),
  country_sold_code STRING  Country where the vehicle is planned to be sold (may have different emissions standards).""),
  country_sold STRING  description""),
  brakes_abs_code STRING  A code that describes whether a vehicle has or does not have anti-lock brakes, and what kind of brakes they are. (Not coded for heavy truck). This is based on the series code that is assigned the vehicle from VINA.""),
  brakes_abs_description STRING  description""),
  security_type_code STRING  Describes the security system (if any) installed on this model.""),
  security_type STRING  description""),
  daytime_running_lights_1 STRING A Polk assigned code that identifies whether or not the vehicle has daytime running lights.""),
  daytime_running_lights_2 STRING  description""),
  restraint_type_code STRING  A Polk assigned code that identifies the type of restraints that a vehicle has based on VIN.""),
  restraint_type STRING  description""),
  cab_configuration_code STRING  Cab Type describes the physical configuration of a truck's cabin.""),
  cab_configuration STRING  medium description""),
  axle_type_front_axle_code STRING  The location of the front axle of a truck tractor. Set forward increases stability on the highway, Setback increases maneuverability in tight spaces.""),
  axle_type_front_axle STRING  short description""),
  axle_type_rear_axle_code STRING  Represents rear axle configuration on a truck tractor. Tandem axles increase load bearing capability.""),
  axle_type_rear_axle STRING  short description""),
  brake_type_code STRING  The type of brakes on the Vehicle (currently commercial truck only). Truck VIN determines this currently""),
  brake_type STRING  description""),
  engine_manufacture_code STRING  A Polk assigned code given to the original equipment manufacture of the within a vehicle""),
  engine_manufacture STRING  description""),
  engine_model STRING  description""),
  duty_type_code STRING  A Polk assigned code that represents the duty type of a truck engine, based on manufacturer information.""),
  duty_type STRING  medium description""),
  bed_length_code STRING  Code representing the manufacturer's description of the relative size of the cargo area of a pickup truck or van. A \""long\"" Ford Ranger bed (compact pickup) may well be shorter than a \""short\"" bed on an F350 (large industrial pickup).""),
  bed_length STRING  description""),
  standard_segmentation_code STRING ,
  standard_segmentation STRING ,
  plant_code STRING  Plant code where vehicle was manufactured.""),
  plant_country STRING  This is the country where the plant is located. Example values are USA, Canada and Japan.""),
  plant_city STRING  This is the city where the plant is located.""),
  plant_country_code STRING ,
  plant_state_code STRING ,
  plant_state STRING  This is the state or province (Canada) location of the plant.""),
  origin_code STRING  A code that indicates the origin of a vehicle.""),
  origin STRING  description""),
  displacement_liters FLOAT64  displacement in rounded Liters, where 1,000 cubic centimeters = 1 liter. Even domestic makes will advertise displacement in terms of liters (e.g. 5.0 liter mustang, which equates to a 302 CID or 4967 cc displacement).""),
  block_type STRING  Description""),
  head_configuration_1 STRING  Describes the cylinder head's camshaft/valve configuration.""),
  head_configuration_2 STRING  description""),
  valves_per_cylinder INT64  Number of intake/exhaust valves per cylinder.""),
  valves_total INT64  Total number of intake/exhaust valves.""),
  engine_code STRING  Code derived from the VIN (not the secondary VIN for a motorcycle). Usually a single character, some manufactures give full positions 4-8 and engine information from that; they do not break it down any further.""),
  is_incomplete STRING ""),
  battery_type_code STRING ,
  battery_type STRING ,
  total_battery_power STRING ,
  battery_voltage STRING ,
  supercharge_flag STRING ,
  supercharge_flag_description STRING ,
  turbocharger_flag STRING ,
  turbocharger_flag_description STRING ,
  variable_valve_timing_flag STRING ,
  motorcycles_body_style_code STRING ,
  motorcycles_body_style STRING 
);"

Some other tables have the similar structure: ['vindecode_2016', 'vindecode_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,33
table_name,parkwork_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.parkwork_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  number_of_motor_vehicles_in_transport_mvit INT64 ,
  number_of_occupants INT64 ,
  day_of_crash INT64 ,
  month_of_crash INT64 ,
  hour_of_crash INT64 ,
  minute_of_crash INT64 ,
  first_harmful_event INT64 ,
  first_harmful_event_name STRING ,
  manner_of_collision INT64 ,
  manner_of_collision_name STRING ,
  unit_type STRING ""),
  hit_and_run STRING . Hit and run is coded when a motor vehicle in-transport, or its driver, departs from the scene; vehicles not intransport are excluded. It does not matter whether the hit-and-run vehicle was striking or struck. 0  No / No Hit-and-Run -- Hit Motor Vehicle in Transport 1  Yes -- Hit Pedestrian or Non-Motorist -- Hit Parked Vehicle (Working Vehicle, Since 2004) or Object -- Other Involved Person, not a driver, left Scene (2005-2006) -- Hit-and-Run, Other Involved Person Left Scene (2007-2008) -- Not Reported 9  Unknown""),
  registration_state INT64 ,
  registration_state_name STRING ,
  registered_vehicle_owner INT64  Was Registered Owner 2  Driver (of This Vehicle) Not Registered Owner (Other Private Owner) 3  Vehicle Registered as Business/Company/Government Vehicle 4  Vehicle Registered as Rental Vehicle 5  Vehicle Was Stolen (Reported By Police) -- Driverless Vehicle 6  Driverless/Motor Vehicle Parked/Stopped Off Roadway 9  Unknown""),
  registered_vehicle_owner_name STRING ,
  vehicle_make INT64  of this vehicle.For more info on the codes, please look at <V9 Vehicle Make> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  vehicle_make_name STRING  of this vehicle.""),
  vehicle_model INT64 ,
  make_model_combined INT64  followed by the 3-digit “Vehicle Model” code (MODEL).See the current FARS/NASS GES Coding and Validation Manual for vehicle make and model codes.""),
  body_type INT64 ,
  body_type_name STRING ,
  vehicle_model_year INT64 ,
  vehicle_identification_number_vin STRING  of this vehicle assigned by the vehicle manufacturer. The VIN contains information on the vehicle such as: manufacturer, model year, model, body type, restraint type, etc.-- First 10 Characters xxxxxxxxxxxx First 12 Characters 000000000000 No VIN Required 888888888888 Not Reported 999999999999 Unknown""),
  vin_character_1 STRING ,
  vin_character_2 STRING ,
  vin_character_3 STRING ,
  vin_character_4 STRING ,
  vin_character_5 STRING ,
  vin_character_6 STRING ,
  vin_character_7 STRING ,
  vin_character_8 STRING ,
  vin_character_9 STRING ,
  vin_character_10 STRING ,
  vin_character_11 STRING ,
  vin_character_12 STRING ,
  vehicle_trailing STRING ,
  mcid_issuing_authority INT64  77 Not Reported 88 None 95 Canada 96 Mexico 99 Unknown""),
  mcid_issuing_authority_name STRING  77 Not Reported 88 None 95 Canada 96 Mexico 99 Unknown""),
  mcid_identification_number STRING ,
  motor_carrier_identification_number STRING ,
  gross_vehicle_weight_rating INT64 ,
  vehicle_configuration INT64 ,
  cargo_body_type INT64 ,
  hazardous_material_involvement STRING ,
  hazardous_material_placard STRING ,
  hazardous_material_identification_number INT64 ,
  hazardous_material_class_number INT64 ,
  release_of_hazardous_material_from_the_cargo_compartment STRING ,
  bus_use STRING ,
  special_use INT64 ,
  special_use_name STRING ,
  emergency_motor_vehicle_use STRING ,
  underride_override INT64 ,
  underride_override_name STRING ,
  initial_contact_point INT64 ,
  extent_of_damage STRING ,
  vehicle_removal STRING ,
  most_harmful_event INT64 ,
  related_factors_vehicle_level1 INT64 ,
  related_factors_vehicle_level2 INT64 ,
  fire_occurrence STRING ,
  fatalities_in_vehicle INT64 
)
OPTIONS(
  description=""This data file contains information about parked and working\nvehicles that were involved in FARS crashes. A parked vehicle is a motor vehicle which\nis stopped off the roadway. A working vehicle is used to indicate that this is a motor\nvehicle that was in the act of performing highway construction, maintenance or utility\nwork related to the trafficway when it became an involved in the crash. Data users are\nstrongly advised to consult the annual FARS/NASS GES Coding and Validation Manuals\nfor a detailed description. There is one record per parked/working vehicle.""
);"

Some other tables have the similar structure: ['parkwork_2015', 'parkwork_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,34
table_name,nmimpair_2016
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.nmimpair_2016`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  condition_impairment_at_time_of_crash_non_motorist INT64  at Time of Crash- Non-Motorist> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  condition_impairment_at_time_of_crash_non_motorist_name STRING 
);"

Some other tables have the similar structure: ['nmimpair_2016', 'nmimpair_2015']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,35
table_name,nmprior_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.nmprior_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  person_number INT64 . This data element appears on each person level data file and is used in conjunction with the ST_CASE data element (and sometimes the VEH_NO data element) to merge information from person level data files. 001-999 Assigned Person Number""),
  non_motorist_action_circumstances INT64  of the non-motorist immediately prior to their involvement in the crash. For more info on the codes, please look at <NM11 Non-Motorist Action/Circumstances> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  non_motorist_action_circumstances_name STRING  of the non-motorist immediately prior to their involvement in the crash."")
)
OPTIONS(
  description=""This data file contains information about the actions of people\nwho are not occupants of motor vehicles (e.g., pedestrians and bicyclists) at the time of\ntheir involvement in the crash. There is one record per action and there is at least one\nrecord for each person who is not an occupant of a motor vehicle.""
);"

Some other tables have the similar structure: ['nmprior_2015', 'nmprior_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,36
table_name,vehicle_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.vehicle_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  vehicle_number INT64 ,
  number_of_motor_vehicles_in_transport_mvit INT64 ,
  number_of_occupants INT64  99 Unknown""),
  day_of_crash INT64 ,
  month_of_crash INT64 ,
  hour_of_crash INT64 ,
  minute_of_crash INT64 ,
  first_harmful_event INT64 ,
  first_harmful_event_name STRING ,
  manner_of_collision INT64 ,
  unit_type STRING ""),
  hit_and_run STRING . Hit and run is coded when a motor vehicle in-transport, or its driver, departs from the scene; vehicles not intransport are excluded. It does not matter whether the hit-and-run vehicle was striking or struck. 0 No 1 Yes -- Not Reported 9 Unknown""),
  registration_state INT64 ,
  registration_state_name STRING ,
  registered_vehicle_owner INT64  Was Registered Owner 2 Driver (of This Vehicle) Not Registered Owner (Other Private Owner) 3 Vehicle Registered as Business/Company/Government Vehicle 4 Vehicle Registered as Rental Vehicle 5 Vehicle Was Stolen (Reported By Police) -- Driverless Vehicle 6 Driverless/Motor Vehicle Parked/Stopped Off Roadway 9 Unknown""),
  registered_vehicle_owner_name STRING ,
  vehicle_make INT64  of this vehicle. For more info on the codes, please look at V9 Vehicle Make section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  vehicle_make_name STRING  of this vehicle""),
  vehicle_model INT64 ,
  make_model_combined INT64  followed by the 3-digit “Vehicle Model” code (MODEL). For more info on the codes, please look at V100 Make Model Combined section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  body_type INT64 ,
  body_type_name STRING ,
  vehicle_model_year INT64 ,
  vehicle_identification_number_vin STRING  of this vehicle assigned by the vehicle manufacturer. The VIN contains information on the vehicle such as: manufacturer, model year, model, body type, restraint type, etc. -- First 10 Characters xxxxxxxxxxxx  First 12 Characters 000000000000 No VIN Required 888888888888 Not Reported 999999999999 Unknown""),
  vin_character_1 STRING ,
  vin_character_2 STRING ,
  vin_character_3 STRING ,
  vin_character_4 STRING ,
  vin_character_5 STRING ,
  vin_character_6 STRING ,
  vin_character_7 STRING ,
  vin_character_8 STRING ,
  vin_character_9 STRING ,
  vin_character_10 STRING ,
  vin_character_11 STRING ,
  vin_character_12 STRING ,
  vehicle_trailing STRING ,
  jackknife STRING ,
  mcid_issuing_authority INT64  77 Not Reported 88 None 95 Canada 96 Mexico 99 Unknown""),
  mcid_identification_number STRING ,
  motor_carrier_identification_number_mcid STRING ,
  gross_vehicle_weight_rating STRING ,
  vehicle_configuration INT64 ,
  vehicle_configuration_name STRING ,
  cargo_body_type INT64 ,
  cargo_body_type_name STRING ,
  hazardous_material_involvement STRING ,
  hazardous_material_placard INT64 ,
  hazardous_material_identification_number INT64 ,
  hazardous_material_class_number INT64 ,
  release_of_hazardous_material_from_the_cargo_compartment STRING ,
  bus_use STRING ,
  special_use INT64 ,
  special_use_name STRING ,
  emergency_motor_vehicle_use STRING ,
  travel_speed INT64 ,
  underride_override INT64 ,
  rollover STRING ,
  location_of_rollover STRING ,
  initial_contact_point INT64 ,
  extent_of_damage STRING ,
  vehicle_removal STRING ,
  most_harmful_event INT64 ,
  related_factors_vehicle_level_1 INT64 ,
  related_factors_vehicle_level_2 INT64 ,
  fire_occurrence STRING ,
  driver_presence STRING  -- Driver Left Scene -- Motor Vehicle not In-Transport (Parked/Stopped Off Roadway/ Working Motor Vehicle/In Motion Outside Trafficway, 2008 Only) -- Motor Vehicle not In-Transport (Parked/Stopped Off Roadway/Working/ In Motion Outside Trafficway, 2005-2007) 9 Unknown""),
  drivers_license_state INT64 ,
  drivers_zip_code INT64 ,
  non_cdl_license_status INT64 ,
  non_cdl_license_type STRING ,
  commercial_motor_vehicle_license_status INT64  if applicable. For more info on the codes, please look at D8 Commercial Motor Vehicle License Status section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  compliance_with_cdl_endorsements STRING  on a Commercial Driver’s License (CDL) and whether this driver was complying with the CDL endorsements. 0 No Endorsements Required For This Vehicle 1 Endorsement(s) Required, Complied With 2 Endorsement(s) Required, Not Complied With 3 Endorsement(s) Required, Compliance Unknown -- 7 No Driver Present/Unknown if Driver Present -- Not Reported 9 Unknown, if Required""),
  license_compliance_with_class_of_vehicle STRING ,
  compliance_with_license_restrictions INT64 ,
  driver_height INT64 . 24-107 Actual Height in Inches 998 No Driver Present/Unknown if Driver Present 999 Unknown""),
  driver_weight INT64 . 40-700 Actual Weight in Pounds 997 No Driver Present/Unknown if Driver Present 998 Other 999 Unknown""),
  previous_recorded_crashes INT64 ,
  previous_recorded_suspensions_and_revocations INT64 ,
  previous_dwi_convictions INT64 ,
  previous_speeding_convictions INT64 ,
  previous_other_moving_violation_convictions INT64 ,
  month_of_first_crash_suspension_or_conviction INT64 ,
  year_of_first_crash_suspension_or_conviction INT64 ,
  month_of_last_crash_suspension_or_conviction INT64 ,
  year_of_last_crash_suspension_or_conviction INT64 ,
  speeding_related STRING ,
  related_factors_driver_level_1 INT64 ,
  related_factors_driver_level_2 INT64 ,
  related_factors_driver_level_3 INT64 ,
  related_factors_driver_level_4 INT64 ,
  trafficway_description STRING  Median 3 Two-Way, Divided, Positive Median Barrier 4 One-Way Trafficway 5 Two-Way, Not Divided With a Continuous Left-Turn Lane 6 Entrance/Exit Ramp 8 Not Reported 9 Unknown""),
  total_lanes_in_roadway INT64 ,
  speed_limit INT64  5-80 Speed Limit (5 mph Increments) 98 Not Reported 99 Unknown""),
  roadway_alignment STRING ,
  roadway_grade STRING  5 Uphill 6 Downhill 8 Not Reported 9 Unknown""),
  roadway_surface_type STRING ,
  roadway_surface_condition INT64 ,
  roadway_surface_condition_name STRING ,
  traffic_control_device INT64 ,
  traffic_control_device_functioning STRING ,
  pre_event_movement_prior_to_recognition_of_critical_event INT64  section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  critical_event_precrash INT64 . For more info on the codes, please look at PC19 Critical Event- Precrash section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  critical_event_precrash_name STRING .""),
  attempted_avoidance_maneuver INT64 ,
  attempted_avoidance_maneuver_name STRING ,
  pre_impact_stability STRING ,
  pre_impact_location INT64 ,
  crash_type INT64 ,
  crash_type_name STRING ,
  fatalities_in_vehicle INT64 ,
  driver_drinking STRING ,
  timestamp_of_crash TIMESTAMP 
)
OPTIONS(
  description=""This data file contains information describing the in-transport\nmotor vehicles and the drivers of in-transport motor vehicle who are involved in the\ncrash. There is one record per in-transport motor vehicle. Parked and working vehicle\ninformation is in the Parkwork data file""
);"

Some other tables have the similar structure: ['vehicle_2015', 'vehicle_2016']
Database Name: bigquery-public-data
Schema Name: nhtsa_traffic_fatalities
,37
table_name,cevent_2015
ddl,"CREATE TABLE `bigquery-public-data.nhtsa_traffic_fatalities.cevent_2015`
(
  state_number INT64  publication of worldwide Geographic Location Codes (GLC). For more info on the codes, please look at <C1/V1/D1/PC1/P1/NM1 State Number> section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  consecutive_number INT64 ,
  event_number INT64 ,
  vehicle_number_this_vehicle INT64  of this in-transport motor vehicle described in this event. 1-999 Vehicle Number""),
  area_of_impact_this_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_this_vehicle_name STRING ,
  sequence_of_events INT64 ,
  sequence_of_events_name STRING ,
  vehicle_number_other_vehicle INT64  of the other motor vehicle, if any, in this event. 1-999 Vehicle Number 5555 Non-Harmful Event 9999 Not a Motor Vehicle""),
  area_of_impact_other_vehicle INT64 > section in the pdf: https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812315""),
  area_of_impact_other_vehicle_name STRING 
)
OPTIONS(
  description=""This data file contains information for all of the qualifying events (i.e., both harmful and non-harmful involving in-transport motor vehicles) which occurred in the crash. It details the chronological sequence of events resulting from an unstabilized situation that constitutes a motor vehicle traffic crash. There is one record per event. Included in each record is a description of the event or object contacted (e.g.,\nran off road-right, crossed center line, guardrail, parked motor vehicle), the vehicles involved, and the vehicles’ area of impact""
);"

Some other tables have the similar structure: ['cevent_2015', 'cevent_2016']
Database Name: bigquery-public-data
Schema Name: utility_us
,0
table_name,us_states_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_states_area`
(
  region_code STRING ,
  division_code STRING ,
  state_fips_code STRING ,
  state_gnis_code STRING ,
  state_geo_id STRING ,
  state_abbreviation STRING ,
  state_name STRING ,
  legal_area_code STRING ,
  feature_class_code STRING ,
  functional_status_code STRING ,
  area_land_meters INT64 ,
  area_water_meters INT64 ,
  internal_point_lat STRING ,
  internal_point_lon STRING ,
  state_geom GEOGRAPHY 
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,1
table_name,us_border_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_border_area`
(
  name STRING,
  geo_id STRING,
  aff_geo_id STRING,
  us_border_geom GEOGRAPHY
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,2
table_name,us_msa_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_msa_area`
(
  csa_code STRING  code of the CSA that contains the metropolitan statistical area/micropolitan statistical area (MSA)""),
  msa_code STRING  code""),
  geo_code STRING ,
  name STRING ,
  lsad_name STRING ,
  lsad_code STRING  code for a given MSA.\n\nM1 indicates a \""metro area (suffix)\""\nM2 indicates a \""micro area (suffix)\""""),
  status_indicator STRING ,
  feature_class_code STRING ,
  area_land_meters NUMERIC ,
  area_water_meters NUMERIC ,
  int_point_lat STRING ,
  int_point_lon STRING ,
  msa_geom GEOGRAPHY 
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,3
table_name,us_cities_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_cities_area`
(
  urban_area_code STRING ,
  geo_code STRING ,
  name STRING ,
  lsad_name STRING ,
  lsad_code STRING  code for a given urban area. \n\n75 indicates an \""urbanized area\""\n76 indicates an \""urban cluster\""""),
  feature_class_code STRING ,
  area_type STRING ,
  functional_status STRING ,
  area_land_meters NUMERIC ,
  area_water_meters NUMERIC ,
  int_point_lat STRING ,
  int_point_lon STRING ,
  city_geom GEOGRAPHY 
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,4
table_name,zipcode_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.zipcode_area`
(
  zipcode STRING NOT NULL ,
  area_land_meters INT64  - Created for statistical purposes only""),
  area_water_meters INT64  - Created for statistical purposes only""),
  area_land_miles FLOAT64  - Created for statistical purposes only""),
  area_water_miles FLOAT64  - Created for statistical purposes only""),
  latitude FLOAT64  First character is blank or \""-\"" denoting North or South latitude respectively""),
  longitude FLOAT64  First character is blank or \""-\"" denoting East or West longitude respectively""),
  state_code STRING ,
  state_name STRING ,
  city STRING ,
  county STRING ,
  state_fips STRING ,
  zipcode_geom STRING  ZIP Codes as polygons"")
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.\n\nCombining a variety of sources, mainly from the Census Bureau (such as National Places: https://www2.census.gov/geo/docs/reference/codes/files/national_places.txt), we've derived a useful US zipcode and general geographic table.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,5
table_name,country_code_iso
ddl,"CREATE TABLE `bigquery-public-data.utility_us.country_code_iso`
(
  country_name STRING NOT NULL ,
  fips_code STRING ,
  alpha_2_code STRING ,
  alpha_3_code STRING ,
  numeric_code STRING ,
  stanag_code STRING ,
  cctlds STRING ,
  continent_code STRING ,
  continent_name STRING ,
  sub_continent_name STRING 
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,6
table_name,num_999999
ddl,"CREATE TABLE `bigquery-public-data.utility_us.num_999999`
(
  num INT64 
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,7
table_name,time
ddl,"CREATE TABLE `bigquery-public-data.utility_us.time`
(
  time TIME ""),
  hour INT64 ,
  minute INT64 ,
  second INT64 ,
  second_in_day INT64 ,
  hour_ampm INT64 ,
  is_pm BOOL 
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,8
table_name,date_greg
ddl,"CREATE TABLE `bigquery-public-data.utility_us.date_greg`
(
  date DATE ; [1582-10-15, 2199-12-31]""),
  date_str STRING ,
  date_int INT64 ,
  date_dash STRING ,
  date_slash STRING ,
  day INT64 ,
  day_abbr STRING ,
  dow_mon17 INT64 ""),
  dow_mon06 INT64 ,
  dow_sun17 INT64 ,
  dow_sun06 INT64 ,
  week_mon INT64 ,
  week_sun INT64 ,
  week_iso INT64  - [0, 53] ; https://en.wikipedia.org/wiki/ISO_week_date""),
  month INT64 ,
  month_abbr STRING ,
  month_first_day DATE ,
  quarter INT64 ,
  quarter_first_day DATE ,
  half INT64 ,
  half_first_day DATE ,
  year INT64 ,
  year_iso INT64 ,
  year_first_day DATE 
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,9
table_name,us_coastline_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_coastline_area`
(
  name STRING,
  coastline_geom GEOGRAPHY
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,10
table_name,us_county_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_county_area`
(
  state_fips_code STRING ,
  county_fips_code STRING ,
  county_gnis_code STRING . GNIS database contains information about physical and cultural geographic features of all types in the United States, associated areas, and Antarctica, current and historical, but not including roads and highways. The database holds the Federally recognized name of each feature and defines the feature location by state, county, USGS topographic map, and geographic coordinates. Other attributes include names or spellings other than the official name, feature designations, feature classification, historical and descriptive information, and for some categories the geometric boundaries.""),
  aff_geo_code STRING ,
  geo_id STRING ,
  county_name STRING ,
  legal_area_code STRING ,
  area_land_meters INT64 ,
  area_water_meters INT64 ,
  county_geom GEOGRAPHY 
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

Database Name: bigquery-public-data
Schema Name: utility_us
,11
table_name,us_csa_area
ddl,"CREATE TABLE `bigquery-public-data.utility_us.us_csa_area`
(
  csa_code STRING  code""),
  aff_geo_code STRING ,
  geo_code STRING ,
  name STRING ,
  lsad_code STRING  code for a given CSA.\n\nM0 indicates \""CSA (suffix)\"".  A full list of LSAD codes can be found here: https://www.census.gov/geo/reference/lsad.html""),
  area_land_meters INT64 ,
  area_water_meters INT64 ,
  csa_geom GEOGRAPHY 
)
OPTIONS(
  description=""This dataset has moved!\n\nYou can find all of the datasets that define the polygons of US political and statistical boundaries, including this one, in the new bigquery-public-data:geo_us_boundaries dataset.""
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'bigquery-public-data': {'census_bureau_usa': ['population_by_zip_2010', 'population_by_zip_2010', 'population_by_zip_2000'], 'nhtsa_traffic_fatalities': [' factor_2018', ' factor_2018', ' factor_2016', ' factor_2020', ' factor_2015', ' factor_2019', ' factor_2017', 'maneuver_2016', 'maneuver_2016', 'maneuver_2015', 'vsoe_2016', 'vsoe_2016', 'vsoe_2015', 'safetyeq_2016', 'safetyeq_2016', 'safetyeq_2015', ' drimpair_2016', ' drimpair_2016', ' drimpair_2015', ' drimpair_2019', ' drimpair_2017', ' drimpair_2020', ' drimpair_2018', ' safetyeq_2017', ' safetyeq_2017', ' safetyeq_2020', ' safetyeq_2015', ' safetyeq_2016', ' safetyeq_2019', ' safetyeq_2018', 'nmcrash_2015', 'nmcrash_2015', 'nmcrash_2016', ' maneuver_2015', ' maneuver_2015', ' maneuver_2020', ' maneuver_2018', ' maneuver_2016', ' maneuver_2019', ' maneuver_2017', 'drimpair_2016', 'drimpair_2016', 'drimpair_2015', ' vsoe_2017', ' vsoe_2017', ' vsoe_2015', ' vsoe_2016', ' vsoe_2018', ' vsoe_2020', ' vsoe_2019', ' damage_2017', ' damage_2017', ' damage_2020', ' damage_2019', ' damage_2015', ' damage_2018', ' damage_2016', ' accident_2016', ' accident_2016', ' accident_2020', ' accident_2015', ' accident_2017', ' accident_2018', ' accident_2019', ' pbtype_2015', ' pbtype_2015', ' pbtype_2020', ' pbtype_2017', ' pbtype_2016', ' pbtype_2018', ' pbtype_2019', 'distract_2016', 'distract_2016', 'distract_2015', ' violatn_2017', ' violatn_2017', ' violatn_2018', ' violatn_2020', ' violatn_2016', ' violatn_2019', ' violatn_2015', ' nmcrash_2018', ' nmcrash_2018', ' nmcrash_2019', ' nmcrash_2017', ' nmcrash_2016', ' nmcrash_2020', ' nmcrash_2015', 'person_2015', 'person_2015', 'person_2016', 'factor_2016', 'factor_2016', 'factor_2015', 'damage_2016', 'damage_2016', 'damage_2015', 'accident_2016', 'accident_2016', 'accident_2015', ' cevent_2019', ' cevent_2019', ' cevent_2017', ' cevent_2016', ' cevent_2020', ' cevent_2018', ' cevent_2015', ' distract_2015', ' distract_2015', ' distract_2017', ' distract_2018', ' distract_2016', ' distract_2019', ' distract_2020', ' nmimpair_2016', ' nmimpair_2016', ' nmimpair_2015', ' nmimpair_2018', ' nmimpair_2019', ' nmimpair_2017', ' nmimpair_2020', 'pbtype_2015', 'pbtype_2015', 'pbtype_2016', ' nmprior_2018', ' nmprior_2018', ' nmprior_2019', ' nmprior_2020', ' nmprior_2015', ' nmprior_2017', ' nmprior_2016', ' vevent_2019', ' vevent_2019', ' vevent_2017', ' vevent_2016', ' vevent_2018', ' vevent_2020', ' vevent_2015', 'violatn_2016', 'violatn_2016', 'violatn_2015', ' parkwork_2019', ' parkwork_2019', ' parkwork_2018', ' parkwork_2016', ' parkwork_2015', ' parkwork_2020', ' parkwork_2017', 'vision_2015', 'vision_2015', 'vision_2016', ' vision_2019', ' vision_2019', ' vision_2020', ' vision_2017', ' vision_2018', ' vision_2016', ' vision_2015', ' vindecode_2015', 'vevent_2015', 'vevent_2015', 'vevent_2016', 'vindecode_2016', 'vindecode_2016', 'vindecode_2015', 'parkwork_2015', 'parkwork_2015', 'parkwork_2016', 'nmimpair_2016', 'nmimpair_2016', 'nmimpair_2015', 'nmprior_2015', 'nmprior_2015', 'nmprior_2016', 'vehicle_2015', 'vehicle_2015', 'vehicle_2016', 'cevent_2015', 'cevent_2015', 'cevent_2016'], 'utility_us': ['us_states_area', 'us_border_area', 'us_msa_area', 'us_cities_area', 'zipcode_area', 'country_code_iso', 'num_999999', 'time', 'date_greg', 'us_coastline_area', 'us_county_area', 'us_csa_area']}}
Begin Exploring Related Columns
**Relevant tables and columns:**

1. **Accident Data Tables** (`bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` and `accident_2016`)
   - `state_number`: Identifies the state where the accident occurred.
   - `consecutive_number`: Unique identifier for each accident case.

2. **Driver Distraction Data Tables** (`bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` and `distract_2016`)
   - `state_number`: State code.
   - `consecutive_number`: Unique identifier for each accident case (links to `accident` tables).
   - `driver_distracted_by_name`: Description of the driver's distraction status.

3. **State Information Table** (`bigquery-public-data.utility_us.us_states_area`)
   - `state_fips_code`: State FIPS code (matches `state_number` in accident data).
   - `state_name`: Name of the state.
   - `state_abbreviation`: Abbreviation of the state name.

4. **Population Data by ZIP Code** (`bigquery-public-data.census_bureau_usa.population_by_zip_2010`)
   - `zipcode`: ZIP code.
   - `population`: Population of the ZIP code area.

5. **ZIP Code to State Mapping** (`bigquery-public-data.utility_us.zipcode_area`)
   - `zipcode`: ZIP code.
   - `state_code`: State abbreviation.
   - `state_name`: Name of the state.

**Potential Conditions:**

- Exclude records where `driver_distracted_by_name` is 'Not Distracted', 'Unknown if Distracted', or 'Not Reported'.
- Filter data for years 2015 and 2016.
- Join tables on `state_number` and `consecutive_number` to combine accident and distraction data.
- Map `state_number` to `state_name` using `state_fips_code`.
- Aggregate population data to get total population per state for 2010.

---

**SQL Queries:**

1. **List distinct driver distraction statuses in 2015:**
   ```sql
   SELECT DISTINCT `driver_distracted_by_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015`
   LIMIT 100
   ```

2. **Count total accidents per state in 2015:**
   ```sql
   SELECT `state_number`, COUNT(DISTINCT `consecutive_number`) AS accident_count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
   GROUP BY `state_number`
   LIMIT 100
   ```

3. **List distraction statuses and their counts in 2015:**
   ```sql
   SELECT `driver_distracted_by_name`, COUNT(*) AS count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015`
   GROUP BY `driver_distracted_by_name`
   LIMIT 100
   ```

4. **Join accident and distraction data for 2015:**
   ```sql
   SELECT a.`state_number`, a.`consecutive_number`, d.`driver_distracted_by_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
     ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
   LIMIT 100
   ```

5. **List population by ZIP code from the 2010 census:**
   ```sql
   SELECT `zipcode`, `population`
   FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
   LIMIT 100
   ```

6. **Retrieve state names and FIPS codes:**
   ```sql
   SELECT `state_fips_code`, `state_name`, `state_abbreviation`
   FROM `bigquery-public-data.utility_us.us_states_area`
   LIMIT 100
   ```

7. **Map `state_number` to `state_name` using FIPS codes (2015 data):**
   ```sql
   SELECT DISTINCT a.`state_number`, s.`state_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.utility_us.us_states_area` AS s
     ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
   LIMIT 100
   ```

8. **Count accidents involving distracted drivers per state in 2015:**
   ```sql
   SELECT a.`state_number`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
     ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
   WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
   GROUP BY a.`state_number`
   LIMIT 100
   ```

9. **Aggregate total population per state from ZIP codes:**
   ```sql
   SELECT z.`state_name`, SUM(p.`population`) AS state_population
   FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
   JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
     ON p.`zipcode` = z.`zipcode`
   GROUP BY z.`state_name`
   LIMIT 100
   ```

10. **List accidents with distraction details and state names for 2015:**
    ```sql
    SELECT s.`state_name`, a.`consecutive_number`, d.`driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    JOIN `bigquery-public-data.utility_us.us_states_area` AS s
      ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
    WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    LIMIT 100
    ```

11. **Count total accidents involving distracted drivers per state in 2016:**
    ```sql
    SELECT a.`state_number`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    GROUP BY a.`state_number`
    LIMIT 100
    ```

12. **List distinct `state_number` codes from the accident data (2015):**
    ```sql
    SELECT DISTINCT `state_number`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
    LIMIT 100
    ```

13. **Retrieve state populations from the utility table (if available):**
    *(Note: If population data is available in another table, use that table here.)*

    ```sql
    SELECT `state_name`, `population`
    FROM `bigquery-public-data.utility_us.us_states_area`
    LIMIT 100
    ```

14. **List accidents with distraction status for 2016:**
    ```sql
    SELECT a.`state_number`, a.`consecutive_number`, d.`driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    LIMIT 100
    ```

15. **Count total accidents per state in 2016:**
    ```sql
    SELECT `state_number`, COUNT(DISTINCT `consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016`
    GROUP BY `state_number`
    LIMIT 100
    ```

16. **Map `state_number` to `state_name` using FIPS codes (2016 data):**
    ```sql
    SELECT DISTINCT a.`state_number`, s.`state_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.utility_us.us_states_area` AS s
      ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
    LIMIT 100
    ```

17. **List distinct `driver_distracted_by_name` in 2016:**
    ```sql
    SELECT DISTINCT `driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016`
    LIMIT 100
    ```

18. **Retrieve ZIP codes and their corresponding states:**
    ```sql
    SELECT DISTINCT `zipcode`, `state_name`
    FROM `bigquery-public-data.utility_us.zipcode_area`
    LIMIT 100
    ```

19. **Aggregate total population per state from ZIP codes and show state codes:**
    ```sql
    SELECT z.`state_code`, SUM(p.`population`) AS state_population
    FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
    JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
      ON p.`zipcode` = z.`zipcode`
    GROUP BY z.`state_code`
    LIMIT 100
    ```

20. **Count total accidents involving distracted drivers per `driver_distracted_by_name` in 2015:**
    ```sql
    SELECT d.`driver_distracted_by_name`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    GROUP BY d.`driver_distracted_by_name`
    LIMIT 100
    ```

These queries explore the relevant data needed to calculate the number of traffic accidents per 100,000 people caused by driver distraction in each U.S. state for 2015 and 2016. They help in understanding the data distribution, mapping state codes to state names, filtering out unwanted distraction statuses, and aggregating accident counts and population data necessary for the analysis.Query:
SELECT DISTINCT `driver_distracted_by_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015`
   LIMIT 100
Answer:
driver_distracted_by_name
Not Distracted
Looked But Did Not See
By Other Occupant(s)
By a Moving Object in Vehicle
While Talking or Listening to Cellular Phone
While Manipulating Cellular Phone
While Adjusting Audio or Climate Controls
While Using Other Component/Controls Integral to Vehicle
While Using or Reaching For Device/Object Brought Into Vehicle
"Distracted by Outside Person, Object or Event"
Eating or Drinking
Smoking Related
Other Cellular Phone Related
No Driver Present/Unknown if Driver Present
Distraction/Inattention
Distraction/Careless
Careless/Inattentive
"Distraction (Distracted), Details Unknown"
"Inattention (Inattentive), Details Unknown"
Not Reported
Lost In Thought/Day Dreaming
Other Distraction
Unknown if Distracted
Query:
SELECT `state_number`, COUNT(DISTINCT `consecutive_number`) AS accident_count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
   GROUP BY `state_number`
   LIMIT 100
Answer:
state_number,accident_count
30,204
39,1029
49,258
48,3190
41,411
42,1102
34,521
53,499
20,322
8,507
51,712
29,803
26,896
1,784
10,127
27,375
35,269
56,129
19,282
55,523
12,2699
36,1061
13,1329
18,752
17,914
21,694
6,3123
37,1275
45,911
32,297
40,590
2,60
4,811
47,888
5,491
28,604
9,257
24,479
54,246
22,698
38,111
25,327
23,144
46,116
31,218
50,50
44,41
33,103
11,23
16,198
15,85
Query:
SELECT `driver_distracted_by_name`, COUNT(*) AS count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015`
   GROUP BY `driver_distracted_by_name`
   LIMIT 100
Answer:
driver_distracted_by_name,count
Not Distracted,33688
Looked But Did Not See,401
By Other Occupant(s),165
By a Moving Object in Vehicle,10
While Talking or Listening to Cellular Phone,116
While Manipulating Cellular Phone,154
While Adjusting Audio or Climate Controls,43
While Using Other Component/Controls Integral to Vehicle,35
While Using or Reaching For Device/Object Brought Into Vehicle,75
"Distracted by Outside Person, Object or Event",196
Eating or Drinking,48
Smoking Related,14
Other Cellular Phone Related,205
No Driver Present/Unknown if Driver Present,273
Distraction/Inattention,425
Distraction/Careless,7
Careless/Inattentive,48
"Distraction (Distracted), Details Unknown",256
"Inattention (Inattentive), Details Unknown",1223
Not Reported,4750
Lost In Thought/Day Dreaming,15
Other Distraction,324
Unknown if Distracted,7049
Query:
SELECT a.`state_number`, a.`consecutive_number`, d.`driver_distracted_by_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
     ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
   LIMIT 100
Answer:
state_number,consecutive_number,driver_distracted_by_name
30,300019,Not Distracted
30,300019,Not Distracted
30,300019,Not Distracted
30,300019,Not Distracted
30,300019,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
39,390099,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Not Distracted
49,490123,Unknown if Distracted
49,490123,Unknown if Distracted
48,481184,Not Distracted
48,481184,Not Distracted
48,481184,Not Distracted
48,481184,Not Distracted
48,481184,Not Distracted
41,410333,Not Distracted
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
41,410333,Not Reported
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
39,390088,Not Distracted
Query:
SELECT `zipcode`, `population`
   FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
   LIMIT 100
Answer:
zipcode,population
25647,768
49336,4352
72106,5376
74074,29184
1960,50944
13776,513
62379,2049
79322,2049
50833,2305
31778,2562
16150,7426
34436,7938
12483,259
40052,515
29686,1027
94619,23299
8353,516
12965,516
44048,2565
39638,3333
78956,5381
97914,19205
10952,38917
59639,1286
7606,2310
36009,2566
93536,70918
3220,7430
74468,263
4740,1287
30808,4615
8648,32263
1436,3336
55374,13576
89169,23304
51004,1033
8535,5385
97038,15113
29710,29449
61701,36105
5488,7690
78717,22538
48906,26634
21856,1035
4981,2316
29667,269
74735,1549
38117,26125
12071,270
30822,526
36875,4622
48201,12814
40175,13070
42332,271
24272,527
46371,3599
84310,4111
31648,1040
16929,2320
37144,3344
14586,10256
2188,14608
44106,26896
20901,34832
52362,1041
52659,1553
12143,5137
78069,5137
60477,38161
65025,786
72079,786
8348,275
80812,275
19312,11539
10456,86547
42453,532
80480,1300
70080,1556
2667,2580
45107,9236
5744,533
1029,789
47648,4373
83702,22293
10305,41749
23126,534
55089,1814
39553,17174
90230,31766
61817,2583
66508,4375
98359,4887
46550,12311
14846,792
54135,3096
55040,12568
70072,56344
39556,7705
93610,23833
32404,38425
Query:
SELECT `state_fips_code`, `state_name`, `state_abbreviation`
   FROM `bigquery-public-data.utility_us.us_states_area`
   LIMIT 100
Answer:
state_fips_code,state_name,state_abbreviation
78,United States Virgin Islands,VI
69,Commonwealth of the Northern Mariana Islands,MP
66,Guam,GU
60,American Samoa,AS
72,Puerto Rico,PR
44,Rhode Island,RI
33,New Hampshire,NH
50,Vermont,VT
09,Connecticut,CT
23,Maine,ME
25,Massachusetts,MA
34,New Jersey,NJ
42,Pennsylvania,PA
36,New York,NY
17,Illinois,IL
55,Wisconsin,WI
39,Ohio,OH
26,Michigan,MI
18,Indiana,IN
27,Minnesota,MN
31,Nebraska,NE
38,North Dakota,ND
29,Missouri,MO
20,Kansas,KS
46,South Dakota,SD
19,Iowa,IA
54,West Virginia,WV
12,Florida,FL
24,Maryland,MD
37,North Carolina,NC
10,Delaware,DE
13,Georgia,GA
45,South Carolina,SC
51,Virginia,VA
11,District of Columbia,DC
01,Alabama,AL
47,Tennessee,TN
21,Kentucky,KY
28,Mississippi,MS
22,Louisiana,LA
48,Texas,TX
40,Oklahoma,OK
05,Arkansas,AR
16,Idaho,ID
35,New Mexico,NM
49,Utah,UT
08,Colorado,CO
56,Wyoming,WY
32,Nevada,NV
30,Montana,MT
04,Arizona,AZ
06,California,CA
41,Oregon,OR
53,Washington,WA
15,Hawaii,HI
02,Alaska,AK
Query:
SELECT DISTINCT a.`state_number`, s.`state_name`
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.utility_us.us_states_area` AS s
     ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
   LIMIT 100
Answer:
state_number,state_name
30,Montana
39,Ohio
49,Utah
48,Texas
41,Oregon
42,Pennsylvania
34,New Jersey
53,Washington
20,Kansas
51,Virginia
29,Missouri
26,Michigan
10,Delaware
27,Minnesota
35,New Mexico
56,Wyoming
19,Iowa
55,Wisconsin
12,Florida
36,New York
13,Georgia
18,Indiana
17,Illinois
21,Kentucky
37,North Carolina
45,South Carolina
32,Nevada
40,Oklahoma
47,Tennessee
28,Mississippi
24,Maryland
54,West Virginia
22,Louisiana
38,North Dakota
25,Massachusetts
23,Maine
46,South Dakota
31,Nebraska
50,Vermont
44,Rhode Island
33,New Hampshire
11,District of Columbia
16,Idaho
15,Hawaii
Query:
SELECT a.`state_number`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
   FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
   JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
     ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
   WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
   GROUP BY a.`state_number`
   LIMIT 100
Answer:
state_number,accident_count
39,59
51,129
49,32
53,158
10,15
26,67
35,124
56,15
48,441
21,200
6,206
45,67
41,12
1,57
47,112
42,72
4,118
37,157
24,104
29,97
54,8
12,235
5,35
34,146
36,163
18,56
20,73
22,154
25,65
30,39
31,16
40,54
27,60
55,102
17,52
2,12
23,14
28,7
13,76
15,17
8,70
50,5
16,35
19,31
9,14
46,14
32,16
38,2
33,18
44,1
Query:
SELECT z.`state_name`, SUM(p.`population`) AS state_population
   FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
   JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
     ON p.`zipcode` = z.`zipcode`
   GROUP BY z.`state_name`
   LIMIT 100
Answer:
state_name,state_population
Alabama,14338764
Utah,8285430
Virginia,24003717
Washington (state),809694
Pennsylvania,38107125
Ohio,34609542
Maryland,17320683
Oregon,11490705
Tennessee,19003095
Montana,2965035
Mississippi,9200223
Minnesota,15904047
North Carolina,28606431
Nebraska,5480298
New York,58133523
Florida,56403678
Illinois,38491743
Oklahoma,11249850
Iowa,9131034
Arizona,19127649
Georgia,28280514
Texas,75434313
Missouri,17961405
Washington,19240062
Idaho,4702578
Wisconsin,17061036
Colorado,15088122
Nevada,8099424
Arkansas,8733537
California,111748626
Kentucky,12977133
Michigan,29650836
New Mexico,6161043
North Dakota,2015343
South Carolina,13876092
Louisiana,13598490
Alaska,2129790
South Dakota,2434629
Kansas,8551884
West Virginia,5558322
"Washington, D.C.",24681
Indiana,19451376
Hawaii,4080903
Wyoming,1683354
Georgia (U.S. state),456018
District of Columbia,1780488
"Iowa, Minnesota",5130
Delaware,2693775
"Oregon, Washington",123168
"Arkansas, Louisiana",7785
"Colorado, Wyoming",300
"Arizona, New Mexico",41208
"Alabama, Mississippi",28347
"Kentucky, Tennessee",76242
"Oklahoma, Texas",5064
"Idaho, Oregon",1923
"Arkansas, Missouri",12783
"Kansas, Oklahoma",7674
"Arizona, Utah",17115
"Minnesota, South Dakota",3246
"Montana, North Dakota",4974
"Arizona, New Mexico, Utah",9951
"North Dakota, South Dakota",5763
"Idaho, Wyoming",1413
"Nebraska, Wyoming",4818
"California, Nevada",4251
"Iowa, Missouri",9801
"California, Oregon",867
"Idaho, Washington",963
Query:
SELECT s.`state_name`, a.`consecutive_number`, d.`driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    JOIN `bigquery-public-data.utility_us.us_states_area` AS s
      ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
    WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    LIMIT 100
Answer:
state_name,consecutive_number,driver_distracted_by_name
Ohio,390126,No Driver Present/Unknown if Driver Present
Ohio,390126,No Driver Present/Unknown if Driver Present
Virginia,510171,Other Distraction
Virginia,510171,Other Distraction
Utah,490011,Other Distraction
Washington,530505,"Inattention (Inattentive), Details Unknown"
Delaware,100079,No Driver Present/Unknown if Driver Present
Michigan,260911,Other Distraction
New Mexico,350271,"Distraction (Distracted), Details Unknown"
Wyoming,560031,No Driver Present/Unknown if Driver Present
Texas,480751,No Driver Present/Unknown if Driver Present
Texas,482369,Distraction/Inattention
Kentucky,210199,While Manipulating Cellular Phone
Kentucky,210302,"Inattention (Inattentive), Details Unknown"
Kentucky,210210,"Inattention (Inattentive), Details Unknown"
New Mexico,350272,"Inattention (Inattentive), Details Unknown"
New Mexico,350072,"Inattention (Inattentive), Details Unknown"
South Carolina,450155,Distraction/Inattention
Texas,480879,"Inattention (Inattentive), Details Unknown"
Texas,482254,Other Cellular Phone Related
Texas,482162,"Inattention (Inattentive), Details Unknown"
Oregon,410053,"Distracted by Outside Person, Object or Event"
Michigan,260561,While Manipulating Cellular Phone
Tennessee,470389,Other Distraction
Pennsylvania,420710,"Distraction (Distracted), Details Unknown"
Michigan,260461,While Using or Reaching For Device/Object Brought Into Vehicle
Michigan,260461,Eating or Drinking
Michigan,260894,Eating or Drinking
New Mexico,350031,"Inattention (Inattentive), Details Unknown"
New Mexico,350090,"Inattention (Inattentive), Details Unknown"
New Mexico,350090,"Inattention (Inattentive), Details Unknown"
North Carolina,370920,"Inattention (Inattentive), Details Unknown"
Maryland,240232,"Inattention (Inattentive), Details Unknown"
Missouri,290152,Distraction/Inattention
Maryland,240129,Looked But Did Not See
Tennessee,470109,"Distraction (Distracted), Details Unknown"
West Virginia,540135,Other Distraction
Tennessee,470316,Other Distraction
Texas,481729,Looked But Did Not See
Florida,120838,"Inattention (Inattentive), Details Unknown"
Florida,121101,By Other Occupant(s)
Query:
SELECT a.`state_number`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    WHERE d.`driver_distracted_by_name` NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
    GROUP BY a.`state_number`
    LIMIT 100
Answer:
state_number,accident_count
6,227
47,132
35,147
31,13
19,40
17,68
38,11
13,88
53,147
48,389
29,80
40,55
21,192
22,143
18,48
20,95
34,193
27,37
49,25
12,233
39,68
51,141
1,57
4,102
16,51
26,61
30,20
37,157
45,52
46,10
56,14
23,3
36,143
55,117
44,3
5,23
8,77
10,16
15,19
24,67
32,8
41,11
42,62
54,5
25,47
33,6
2,1
9,13
50,4
28,3
11,1
Query:
SELECT DISTINCT `state_number`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
    LIMIT 100
Answer:
state_number
30
39
49
48
41
42
34
53
20
8
51
29
26
1
10
27
35
56
19
55
12
36
13
18
17
21
6
37
45
32
40
2
4
47
5
28
9
24
54
22
38
25
23
46
31
50
44
33
11
16
15
Query:
SELECT `state_name`, `population`
    FROM `bigquery-public-data.utility_us.us_states_area`
    LIMIT 100
Answer:
400 Unrecognized name: population at [1:22]; reason: invalidQuery, location: query, message: Unrecognized name: population at [1:22]

Location: US
Job ID: e35e115d-aa97-4773-a84d-0b0cfd5c1664
Query:
SELECT a.`state_number`, a.`consecutive_number`, d.`driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    LIMIT 100
Answer:
state_number,consecutive_number,driver_distracted_by_name
16,160065,Not Distracted
24,240021,Not Distracted
31,310185,Not Distracted
37,370035,Not Distracted
39,391029,Not Distracted
37,370037,Not Distracted
37,370037,Not Distracted
6,62039,Not Distracted
6,61450,Not Distracted
6,62299,Other Distraction
6,62095,Not Distracted
20,200075,Unknown if Distracted
35,350086,Not Distracted
49,490052,Unknown if Distracted
29,290444,Not Reported
23,230004,Unknown if Distracted
29,290747,Not Reported
35,350055,Not Distracted
18,180061,Not Distracted
16,160222,Not Distracted
19,190341,Unknown if Distracted
5,50265,Unknown if Distracted
17,170432,Not Distracted
27,270200,Unknown if Distracted
37,370781,Not Reported
5,50168,Unknown if Distracted
13,131254,Not Distracted
35,350246,Not Distracted
47,470082,Unknown if Distracted
47,470083,Other Cellular Phone Related
4,40032,Not Distracted
4,40032,Not Distracted
18,180160,Not Distracted
20,200074,Unknown if Distracted
35,350114,"Inattention (Inattentive), Details Unknown"
37,370876,Not Reported
22,220711,Unknown if Distracted
29,290838,Not Reported
31,310003,Not Distracted
31,310003,Not Distracted
29,290827,Not Reported
29,290827,Not Reported
5,50022,Unknown if Distracted
50,500051,Not Distracted
50,500051,Not Distracted
50,500051,Not Distracted
1,10424,Unknown if Distracted
5,50318,Unknown if Distracted
29,290324,Not Reported
30,300113,Unknown if Distracted
40,400127,Unknown if Distracted
Query:
SELECT `state_number`, COUNT(DISTINCT `consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016`
    GROUP BY `state_number`
    LIMIT 100
Answer:
state_number,accident_count
16,232
24,484
31,194
37,1348
39,1053
6,3540
20,381
35,361
49,259
29,872
23,150
18,776
19,355
5,504
17,1000
27,357
13,1424
47,962
4,856
22,704
50,57
1,979
30,171
40,628
53,504
34,570
55,544
8,558
36,981
41,448
42,1088
54,250
45,941
2,78
51,722
12,2935
9,292
48,3427
38,102
21,763
46,103
28,625
15,109
25,356
11,26
26,981
32,304
33,130
44,48
56,100
10,116
Query:
SELECT DISTINCT a.`state_number`, s.`state_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
    JOIN `bigquery-public-data.utility_us.us_states_area` AS s
      ON CAST(a.`state_number` AS STRING) = s.`state_fips_code`
    LIMIT 100
Answer:
state_number,state_name
16,Idaho
24,Maryland
31,Nebraska
37,North Carolina
39,Ohio
20,Kansas
35,New Mexico
49,Utah
29,Missouri
23,Maine
18,Indiana
19,Iowa
17,Illinois
27,Minnesota
13,Georgia
47,Tennessee
22,Louisiana
50,Vermont
30,Montana
40,Oklahoma
53,Washington
34,New Jersey
55,Wisconsin
36,New York
41,Oregon
42,Pennsylvania
54,West Virginia
45,South Carolina
51,Virginia
12,Florida
48,Texas
38,North Dakota
21,Kentucky
46,South Dakota
28,Mississippi
15,Hawaii
25,Massachusetts
11,District of Columbia
26,Michigan
32,Nevada
33,New Hampshire
44,Rhode Island
56,Wyoming
10,Delaware
Query:
SELECT DISTINCT `driver_distracted_by_name`
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016`
    LIMIT 100
Answer:
driver_distracted_by_name
Not Distracted
Looked But Did Not See
By Other Occupant(s)
By a Moving Object in Vehicle
While Talking or Listening to Cellular Phone
While Manipulating Cellular Phone
While Adjusting Audio or Climate Controls
While Using Other Component/Controls Integral to Vehicle
While Using or Reaching For Device/Object Brought Into Vehicle
"Distracted by Outside Person, Object or Event"
Eating or Drinking
Smoking Related
Other Cellular Phone Related
No Driver Present/Unknown if Driver Present
Distraction/Inattention
Distraction/Careless
Careless/Inattentive
"Distraction (Distracted), Details Unknown"
"Inattention (Inattentive), Details Unknown"
Not Reported
Lost In Thought/Day Dreaming
Other Distraction
Unknown if Distracted
Query:
SELECT DISTINCT `zipcode`, `state_name`
    FROM `bigquery-public-data.utility_us.zipcode_area`
    LIMIT 100
Answer:
zipcode,state_name
96915,Guam
96928,Guam
96917,Guam
96916,Guam
50023,Iowa
50327,Iowa
52405,Iowa
51237,Iowa
50212,Iowa
50161,Iowa
50677,Iowa
50119,Iowa
51010,Iowa
50277,Iowa
52069,Iowa
50532,Iowa
50247,Iowa
51347,Iowa
51532,Iowa
52621,Iowa
51109,Iowa
52402,Iowa
52320,Iowa
50014,Iowa
50622,Iowa
50107,Iowa
50050,Iowa
50219,Iowa
51051,Iowa
50166,Iowa
51449,Iowa
50447,Iowa
50835,Iowa
52593,Iowa
50482,Iowa
51521,Iowa
50561,Iowa
50131,Iowa
51054,Iowa
51020,Iowa
50578,Iowa
52345,Iowa
50642,Iowa
50028,Iowa
52563,Iowa
52531,Iowa
50586,Iowa
51436,Iowa
52729,Iowa
52730,Iowa
52750,Iowa
50655,Iowa
51012,Iowa
51564,Iowa
50133,Iowa
50515,Iowa
52573,Iowa
50703,Iowa
50315,Iowa
52658,Iowa
51638,Iowa
52342,Iowa
52216,Iowa
52362,Iowa
50068,Iowa
52746,Iowa
50167,Iowa
52231,Iowa
50136,Iowa
52653,Iowa
52738,Iowa
51063,Iowa
50262,Iowa
51649,Iowa
51528,Iowa
52050,Iowa
50461,Iowa
52154,Iowa
51342,Iowa
50510,Iowa
50217,Iowa
50601,Iowa
52035,Iowa
50325,Iowa
50567,Iowa
51466,Iowa
52202,Iowa
52401,Iowa
52758,Iowa
51247,Iowa
52332,Iowa
50676,Iowa
50232,Iowa
50438,Iowa
51232,Iowa
50246,Iowa
51545,Iowa
51579,Iowa
52151,Iowa
51510,Iowa
Query:
SELECT z.`state_code`, SUM(p.`population`) AS state_population
    FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
    JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
      ON p.`zipcode` = z.`zipcode`
    GROUP BY z.`state_code`
    LIMIT 100
Answer:
state_code,state_population
AL,14338764
UT,8285430
VA,24003717
WA,20049756
PA,38107125
OH,34609542
MD,17320683
OR,11490705
TN,19003095
MT,2965035
MS,8873622
MN,15904047
NC,28606431
NE,5480298
NY,58133523
FL,56403678
IL,38491743
OK,11249850
IA,9131034
AZ,19127649
GA,29063133
TX,75434313
MO,17961405
ID,4700946
WI,17061036
CO,15088122
NV,8099424
AR,8733537
CA,111748626
KY,12977133
MI,29650836
NM,6161043
ND,2015343
SC,13876092
LA,13598490
AK,2129790
SD,2434629
KS,8551884
WV,5558322
DC,1805169
IN,19451376
HI,4080903
WY,1684986
"IA, MN",5130
DE,2693775
"OR, WA",123168
"AR, LA",7785
"CO, WY",300
"AZ, NM",41208
"AL, MS",28347
"KY, TN",76242
"OK, TX",5064
"ID, OR",1923
"AR, MO",12783
"KS, OK",7674
"AZ, UT",17115
"MN, SD",3246
"MT, ND",4974
"AZ, NM, UT",9951
"ND, SD",5763
"ID, WY",1413
"NE, WY",4818
"CA, NV",4251
"IA, MO",9801
"CA, OR",867
"ID, WA",963
Query:
SELECT d.`driver_distracted_by_name`, COUNT(DISTINCT a.`consecutive_number`) AS accident_count
    FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
    JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
      ON a.`state_number` = d.`state_number` AND a.`consecutive_number` = d.`consecutive_number`
    GROUP BY d.`driver_distracted_by_name`
    LIMIT 100
Answer:
driver_distracted_by_name,accident_count
Not Distracted,23269
Unknown if Distracted,6372
Not Reported,3677
No Driver Present/Unknown if Driver Present,256
Other Distraction,314
"Inattention (Inattentive), Details Unknown",1207
"Distraction (Distracted), Details Unknown",251
Distraction/Inattention,421
While Manipulating Cellular Phone,154
Other Cellular Phone Related,190
"Distracted by Outside Person, Object or Event",186
While Using or Reaching For Device/Object Brought Into Vehicle,75
Eating or Drinking,48
Looked But Did Not See,389
While Talking or Listening to Cellular Phone,116
By Other Occupant(s),164
While Adjusting Audio or Climate Controls,43
Careless/Inattentive,48
Lost In Thought/Day Dreaming,15
By a Moving Object in Vehicle,10
Smoking Related,14
While Using Other Component/Controls Integral to Vehicle,35
Distraction/Careless,7
End Exploring Related Columns
Task: According to the 2015 and 2016 accident and driver distraction, and excluding cases where the driver’s distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported,' how many traffic accidents per 100,000 people were caused by driver distraction in each U.S. state for those two years, based on 2010 census population data, and which five states each year had the highest rates?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: Based on the 2010 census population data, for the years 2015 and 2016, the top five U.S. states with the highest rates of traffic accidents caused by driver distraction (excluding cases where the driver’s distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported') per 100,000 people are as follows:

```csv
Year,State,Accidents_per_100k
2015,State1:str,rate1:float
2015,State2:str,rate2:float
2015,State3:str,rate3:float
2015,State4:str,rate4:float
2015,State5:str,rate5:float
2016,State1:str,rate1:float
2016,State2:str,rate2:float
2016,State3:str,rate3:float
2016,State4:str,rate4:float
2016,State5:str,rate5:float
(Attention: answer in ten rows)
```

In this table:
- **Year** indicates the year (2015 or 2016).
- **State** is the name of the U.S. state (string).
- **Accidents_per_100k** is the number of traffic accidents caused by driver distraction per 100,000 people in that state for the given year (float)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'bigquery-public-data': {'census_bureau_usa': ['population_by_zip_2010', 'population_by_zip_2010', 'population_by_zip_2000'], 'nhtsa_traffic_fatalities': [' factor_2018', ' factor_2018', ' factor_2016', ' factor_2020', ' factor_2015', ' factor_2019', ' factor_2017', 'maneuver_2016', 'maneuver_2016', 'maneuver_2015', 'vsoe_2016', 'vsoe_2016', 'vsoe_2015', 'safetyeq_2016', 'safetyeq_2016', 'safetyeq_2015', ' drimpair_2016', ' drimpair_2016', ' drimpair_2015', ' drimpair_2019', ' drimpair_2017', ' drimpair_2020', ' drimpair_2018', ' safetyeq_2017', ' safetyeq_2017', ' safetyeq_2020', ' safetyeq_2015', ' safetyeq_2016', ' safetyeq_2019', ' safetyeq_2018', 'nmcrash_2015', 'nmcrash_2015', 'nmcrash_2016', ' maneuver_2015', ' maneuver_2015', ' maneuver_2020', ' maneuver_2018', ' maneuver_2016', ' maneuver_2019', ' maneuver_2017', 'drimpair_2016', 'drimpair_2016', 'drimpair_2015', ' vsoe_2017', ' vsoe_2017', ' vsoe_2015', ' vsoe_2016', ' vsoe_2018', ' vsoe_2020', ' vsoe_2019', ' damage_2017', ' damage_2017', ' damage_2020', ' damage_2019', ' damage_2015', ' damage_2018', ' damage_2016', ' accident_2016', ' accident_2016', ' accident_2020', ' accident_2015', ' accident_2017', ' accident_2018', ' accident_2019', ' pbtype_2015', ' pbtype_2015', ' pbtype_2020', ' pbtype_2017', ' pbtype_2016', ' pbtype_2018', ' pbtype_2019', 'distract_2016', 'distract_2016', 'distract_2015', ' violatn_2017', ' violatn_2017', ' violatn_2018', ' violatn_2020', ' violatn_2016', ' violatn_2019', ' violatn_2015', ' nmcrash_2018', ' nmcrash_2018', ' nmcrash_2019', ' nmcrash_2017', ' nmcrash_2016', ' nmcrash_2020', ' nmcrash_2015', 'person_2015', 'person_2015', 'person_2016', 'factor_2016', 'factor_2016', 'factor_2015', 'damage_2016', 'damage_2016', 'damage_2015', 'accident_2016', 'accident_2016', 'accident_2015', ' cevent_2019', ' cevent_2019', ' cevent_2017', ' cevent_2016', ' cevent_2020', ' cevent_2018', ' cevent_2015', ' distract_2015', ' distract_2015', ' distract_2017', ' distract_2018', ' distract_2016', ' distract_2019', ' distract_2020', ' nmimpair_2016', ' nmimpair_2016', ' nmimpair_2015', ' nmimpair_2018', ' nmimpair_2019', ' nmimpair_2017', ' nmimpair_2020', 'pbtype_2015', 'pbtype_2015', 'pbtype_2016', ' nmprior_2018', ' nmprior_2018', ' nmprior_2019', ' nmprior_2020', ' nmprior_2015', ' nmprior_2017', ' nmprior_2016', ' vevent_2019', ' vevent_2019', ' vevent_2017', ' vevent_2016', ' vevent_2018', ' vevent_2020', ' vevent_2015', 'violatn_2016', 'violatn_2016', 'violatn_2015', ' parkwork_2019', ' parkwork_2019', ' parkwork_2018', ' parkwork_2016', ' parkwork_2015', ' parkwork_2020', ' parkwork_2017', 'vision_2015', 'vision_2015', 'vision_2016', ' vision_2019', ' vision_2019', ' vision_2020', ' vision_2017', ' vision_2018', ' vision_2016', ' vision_2015', ' vindecode_2015', 'vevent_2015', 'vevent_2015', 'vevent_2016', 'vindecode_2016', 'vindecode_2016', 'vindecode_2015', 'parkwork_2015', 'parkwork_2015', 'parkwork_2016', 'nmimpair_2016', 'nmimpair_2016', 'nmimpair_2015', 'nmprior_2015', 'nmprior_2015', 'nmprior_2016', 'vehicle_2015', 'vehicle_2015', 'vehicle_2016', 'cevent_2015', 'cevent_2015', 'cevent_2016'], 'utility_us': ['us_states_area', 'us_border_area', 'us_msa_area', 'us_cities_area', 'zipcode_area', 'country_code_iso', 'num_999999', 'time', 'date_greg', 'us_coastline_area', 'us_county_area', 'us_csa_area']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 07:29:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 07:29:50 - root - INFO - ```sql
WITH state_populations AS (
  SELECT z.state_code, SUM(p.population) AS state_population
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
  JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
    ON p.zipcode = z.zipcode
  GROUP BY z.state_code
),
accidents_2015 AS (
  SELECT a.state_number, s.state_name, s.state_abbreviation, COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
    ON a.state_number = d.state_number AND a.consecutive_number = d.consecutive_number
  JOIN `bigquery-public-data.utility_us.us_states_area` AS s
    ON CAST(a.state_number AS STRING) = s.state_fips_code
  WHERE d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY a.state_number, s.state_name, s.state_abbreviation
),
accidents_2016 AS (
  SELECT a.state_number, s.state_name, s.state_abbreviation, COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
  JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
    ON a.state_number = d.state_number AND a.consecutive_number = d.consecutive_number
  JOIN `bigquery-public-data.utility_us.us_states_area` AS s
    ON CAST(a.state_number AS STRING) = s.state_fips_code
  WHERE d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY a.state_number, s.state_name, s.state_abbreviation
),
accidents AS (
  SELECT '2015' AS year, state_abbreviation, state_name, accident_count FROM accidents_2015
  UNION ALL
  SELECT '2016' AS year, state_abbreviation, state_name, accident_count FROM accidents_2016
),
accidents_with_population AS (
  SELECT
    a.year,
    a.state_name AS State,
    a.accident_count,
    p.state_population,
    ROUND(a.accident_count / (p.state_population / 100000), 4) AS Accidents_per_100k
  FROM accidents AS a
  JOIN state_populations AS p
    ON a.state_abbreviation = p.state_code
)
SELECT year, State, Accidents_per_100k
FROM (
  SELECT *,
    ROW_NUMBER() OVER(PARTITION BY year ORDER BY Accidents_per_100k DESC) AS rn
  FROM accidents_with_population
)
WHERE rn <= 5
ORDER BY year, Accidents_per_100k DESC
```
2025-02-11 07:29:52 - root - INFO - itercount: 1
2025-02-11 07:29:52 - root - INFO - 0
2025-02-11 07:29:52 - root - INFO - results: 
year,State,Accidents_per_100k
2015,New Mexico,2.0126
2015,Kentucky,1.5412
2015,Montana,1.3153
2015,Louisiana,1.1325
2015,Wyoming,0.8902
2016,New Mexico,2.386
2016,Kentucky,1.4795
2016,Kansas,1.1109
2016,Idaho,1.0849
2016,Louisiana,1.0516


2025-02-11 07:29:52 - root - INFO - Please check the answer again by reviewing According to the 2015 and 2016 accident and driver distraction, and excluding cases where the driver’s distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported,' how many traffic accidents per 100,000 people were caused by driver distraction in each U.S. state for those two years, based on 2010 census population data, and which five states each year had the highest rates?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Based on the 2010 census population data, for the years 2015 and 2016, the top five U.S. states with the highest rates of traffic accidents caused by driver distraction (excluding cases where the driver’s distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported') per 100,000 people are as follows:

```csv
Year,State,Accidents_per_100k
2015,State1:str,rate1:float
2015,State2:str,rate2:float
2015,State3:str,rate3:float
2015,State4:str,rate4:float
2015,State5:str,rate5:float
2016,State1:str,rate1:float
2016,State2:str,rate2:float
2016,State3:str,rate3:float
2016,State4:str,rate4:float
2016,State5:str,rate5:float
(Attention: answer in ten rows)
```

In this table:
- **Year** indicates the year (2015 or 2016).
- **State** is the name of the U.S. state (string).
- **Accidents_per_100k** is the number of traffic accidents caused by driver distraction per 100,000 people in that state for the given year (float). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
year,State,Accidents_per_100k
2015,New Mexico,2.0126
2015,Kentucky,1.5412
2015,Montana,1.3153
2015,Louisiana,1.1325
2015,Wyoming,0.8902
2016,New Mexico,2.386
2016,Kentucky,1.4795
2016,Kansas,1.1109
2016,Idaho,1.0849
2016,Louisiana,1.0516
Current sql:
WITH state_populations AS (
  SELECT z.state_code, SUM(p.population) AS state_population
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
  JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
    ON p.zipcode = z.zipcode
  GROUP BY z.state_code
),
accidents_2015 AS (
  SELECT a.state_number, s.state_name, s.state_abbreviation, COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
    ON a.state_number = d.state_number AND a.consecutive_number = d.consecutive_number
  JOIN `bigquery-public-data.utility_us.us_states_area` AS s
    ON CAST(a.state_number AS STRING) = s.state_fips_code
  WHERE d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY a.state_number, s.state_name, s.state_abbreviation
),
accidents_2016 AS (
  SELECT a.state_number, s.state_name, s.state_abbreviation, COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
  JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
    ON a.state_number = d.state_number AND a.consecutive_number = d.consecutive_number
  JOIN `bigquery-public-data.utility_us.us_states_area` AS s
    ON CAST(a.state_number AS STRING) = s.state_fips_code
  WHERE d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY a.state_number, s.state_name, s.state_abbreviation
),
accidents AS (
  SELECT '2015' AS year, state_abbreviation, state_name, accident_count FROM accidents_2015
  UNION ALL
  SELECT '2016' AS year, state_abbreviation, state_name, accident_count FROM accidents_2016
),
accidents_with_population AS (
  SELECT
    a.year,
    a.state_name AS State,
    a.accident_count,
    p.state_population,
    ROUND(a.accident_count / (p.state_population / 100000), 4) AS Accidents_per_100k
  FROM accidents AS a
  JOIN state_populations AS p
    ON a.state_abbreviation = p.state_code
)
SELECT year, State, Accidents_per_100k
FROM (
  SELECT *,
    ROW_NUMBER() OVER(PARTITION BY year ORDER BY Accidents_per_100k DESC) AS rn
  FROM accidents_with_population
)
WHERE rn <= 5
ORDER BY year, Accidents_per_100k DESC
2025-02-11 07:30:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 07:30:46 - root - INFO - Based on the 2010 census population data, for the years 2015 and 2016, the top five U.S. states with the highest rates of traffic accidents caused by driver distraction (excluding cases where the driver's distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported') per 100,000 people are as follows:

```csv
Year,State,Accidents_per_100k
2015,New Mexico,2.0126
2015,Kentucky,1.5412
2015,Montana,1.3153
2015,Louisiana,1.1325
2015,Wyoming,0.8902
2016,New Mexico,2.3860
2016,Kentucky,1.4795
2016,Kansas,1.1109
2016,Idaho,1.0849
2016,Louisiana,1.0516
```

```sql
WITH state_populations AS (
  SELECT z.state_code, SUM(p.population) AS state_population
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS p
  JOIN `bigquery-public-data.utility_us.zipcode_area` AS z
    ON p.zipcode = z.zipcode
  GROUP BY z.state_code
),
accidents_2015 AS (
  SELECT a.state_number, s.state_name, s.state_abbreviation, COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015` AS a
  JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2015` AS d
    ON a.state_number = d.state_number AND a.consecutive_number = d.consecutive_number
  JOIN `bigquery-public-data.utility_us.us_states_area` AS s
    ON CAST(a.state_number AS STRING) = s.state_fips_code
  WHERE d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY a.state_number, s.state_name, s.state_abbreviation
),
accidents_2016 AS (
  SELECT a.state_number, s.state_name, s.state_abbreviation, COUNT(DISTINCT a.consecutive_number) AS accident_count
  FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2016` AS a
  JOIN `bigquery-public-data.nhtsa_traffic_fatalities.distract_2016` AS d
    ON a.state_number = d.state_number AND a.consecutive_number = d.consecutive_number
  JOIN `bigquery-public-data.utility_us.us_states_area` AS s
    ON CAST(a.state_number AS STRING) = s.state_fips_code
  WHERE d.driver_distracted_by_name NOT IN ('Not Distracted', 'Unknown if Distracted', 'Not Reported')
  GROUP BY a.state_number, s.state_name, s.state_abbreviation
),
accidents AS (
  SELECT '2015' AS year, state_abbreviation, state_name, accident_count FROM accidents_2015
  UNION ALL
  SELECT '2016' AS year, state_abbreviation, state_name, accident_count FROM accidents_2016
),
accidents_with_population AS (
  SELECT
    a.year,
    a.state_name AS State,
    a.accident_count,
    p.state_population,
    ROUND(a.accident_count / (p.state_population / 100000), 4) AS Accidents_per_100k
  FROM accidents AS a
  JOIN state_populations AS p
    ON a.state_abbreviation = p.state_code
)
SELECT year, State, Accidents_per_100k
FROM (
  SELECT *,
    ROW_NUMBER() OVER(PARTITION BY year ORDER BY Accidents_per_100k DESC) AS rn
  FROM accidents_with_population
)
WHERE rn <= 5
ORDER BY year, Accidents_per_100k DESC;
```
2025-02-11 07:30:48 - root - INFO - itercount: 2
2025-02-11 07:30:48 - root - INFO - 0
2025-02-11 07:30:48 - root - INFO - Total iteration counts: 2
