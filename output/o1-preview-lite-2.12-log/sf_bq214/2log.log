2025-01-20 05:59:10 - openai._base_client - INFO - Retrying request to /chat/completions in 0.479679 seconds
2025-01-20 06:00:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:00:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-01-20 06:00:16 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:16 - root - INFO - SQL:
SELECT DISTINCT "country_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
Results:
country_code
JP
DE
US
DK
FI
GB
EP
KR
WO
NL
ES
RU
BE
LU
CA
CN
FR

2025-01-20 06:00:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-20 06:00:18 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:18 - root - INFO - SQL:
SELECT DISTINCT "kind_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
Results:
kind_code
B
Y1
I1
T9
U9
B8
R1
H
T3
D1
U4
K4
Z1
A5
B3
T4
P1
R2
P
A4
T5
A8
I5
I2
V0
B1
S
D2
U8
Y2
T2
H1
T7
L
A0
B9
T1
Y4
R
K1
U
F
C1
T0
T8
U0
U1
A6
Y
A1
S1
M
U3
C9
C2
B4
C5
H3
A3
K5
E
D0
A2
I4
C
A
P3
P2
T
B2
A9
E1
C3
A7

2025-01-20 06:00:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:20 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:20 - root - INFO - SQL:
SELECT "publication_number", "country_code", "kind_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   WHERE "country_code" = 'US' 
     AND "kind_code" LIKE '%B2%' 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,country_code,kind_code
US-9109382-B2,US,B2
US-7902031-B2,US,B2
US-7608693-B2,US,B2
US-7464329-B2,US,B2
US-8296413-B2,US,B2
US-7970723-B2,US,B2
US-7780352-B2,US,B2
US-7658953-B2,US,B2
US-8852551-B2,US,B2
US-8212546-B2,US,B2
US-9485551-B2,US,B2
US-9496971-B2,US,B2
US-8194623-B2,US,B2
US-9760693-B2,US,B2
US-9243005-B2,US,B2
US-8981106-B2,US,B2
US-9312564-B2,US,B2
US-7645905-B2,US,B2
US-9712468-B2,US,B2
US-7490938-B2,US,B2
US-9739035-B2,US,B2
US-8501582-B2,US,B2
US-7445319-B2,US,B2
US-9216785-B2,US,B2
US-7017954-B2,US,B2
US-8306451-B2,US,B2
US-8524754-B2,US,B2
US-9066419-B2,US,B2
US-7053968-B2,US,B2
US-7826077-B2,US,B2
US-9395583-B2,US,B2
US-7472525-B2,US,B2
US-7803900-B2,US,B2
US-7554825-B2,US,B2
US-7143442-B2,US,B2
US-8223042-B2,US,B2
US-8951425-B2,US,B2
US-6854387-B2,US,B2
US-8300397-B2,US,B2
US-8167650-B2,US,B2
US-8995704-B2,US,B2
US-7913981-B2,US,B2
US-7321997-B2,US,B2
US-8747035-B2,US,B2
US-8575784-B2,US,B2
US-8459339-B2,US,B2
US-8941380-B2,US,B2
US-8810355-B2,US,B2
US-9615444-B2,US,B2
US-7320405-B2,US,B2
US-8582628-B2,US,B2
US-7378205-B2,US,B2
US-9261937-B2,US,B2
US-7282643-B2,US,B2
US-7918885-B2,US,B2
US-8726218-B2,US,B2
US-9548776-B2,US,B2
US-7337078-B2,US,B2
US-9500832-B2,US,B2
US-9391842-B2,US,B2
US-7536379-B2,US,B2
US-8688093-B2,US,B2
US-8251160-B2,US,B2
US-8379331-B2,US,B2
US-9252981-B2,US,B2
US-8850126-B2,US,B2
US-7315403-B2,US,B2
US-9731828-B2,US,B2
US-7180411-B2,US,B2
US-6588853-B2,US,B2
US-6827197-B2,US,B2
US-8335385-B2,US,B2
US-8568510-B2,US,B2
US-7563000-B2,US,B2
US-9648021-B2,US,B2
US-6908210-B2,US,B2
US-9656260-B2,US,B2
US-8974678-B2,US,B2
US-7188744-B2,US,B2
US-9184335-B2,US,B2
US-8863077-B2,US,B2
US-7430521-B2,US,B2
US-7711335-B2,US,B2
US-9541929-B2,US,B2
US-7701148-B2,US,B2
US-7517642-B2,US,B2
US-8949421-B2,US,B2
US-9656235-B2,US,B2
US-8782666-B2,US,B2
US-9528062-B2,US,B2
US-9717817-B2,US,B2
US-9018530-B2,US,B2
US-6998932-B2,US,B2
US-8537297-B2,US,B2
US-8415158-B2,US,B2
US-7005916-B2,US,B2
US-9174852-B2,US,B2
US-6836411-B2,US,B2
US-8886915-B2,US,B2
US-8598100-B2,US,B2
US-9349623-B2,US,B2
US-8763130-B2,US,B2
US-7102141-B2,US,B2
US-9438853-B2,US,B2
US-9606890-B2,US,B2
US-8101464-B2,US,B2
US-7561428-B2,US,B2
US-9472889-B2,US,B2
US-6529468-B2,US,B2
US-6842228-B2,US,B2
US-6833837-B2,US,B2
US-9258484-B2,US,B2
US-7976829-B2,US,B2
US-9401154-B2,US,B2
US-6784243-B2,US,B2
US-8101065-B2,US,B2
US-7552453-B2,US,B2
US-7813075-B2,US,B2
US-8139265-B2,US,B2
US-9440302-B2,US,B2
US-6487435-B2,US,B2
US-7082505-B2,US,B2
US-8421795-B2,US,B2
US-7425525-B2,US,B2
US-9560058-B2,US,B2
US-8660733-B2,US,B2
US-8339969-B2,US,B2
US-7855036-B2,US,B2
US-8515371-B2,US,B2
US-8168876-B2,US,B2
US-7520949-B2,US,B2
US-7113442-B2,US,B2
US-8475829-B2,US,B2
US-7934793-B2,US,B2
US-8176066-B2,US,B2
US-6980337-B2,US,B2
US-8869161-B2,US,B2
US-8358332-B2,US,B2
US-8029183-B2,US,B2
US-8707142-B2,US,B2
US-8734016-B2,US,B2
US-9333656-B2,US,B2
US-9272619-B2,US,B2
US-8493359-B2,US,B2
US-9067967-B2,US,B2
US-7011160-B2,US,B2
US-8165511-B2,US,B2
US-8021977-B2,US,B2
US-9576392-B2,US,B2
US-8972875-B2,US,B2
US-9480338-B2,US,B2
US-8612291-B2,US,B2
US-7619849-B2,US,B2
US-7140871-B2,US,B2
US-7937298-B2,US,B2
US-8360515-B2,US,B2
US-8885764-B2,US,B2
US-8362624-B2,US,B2
US-9268484-B2,US,B2
US-8243251-B2,US,B2
US-9670412-B2,US,B2
US-6985112-B2,US,B2
US-7820445-B2,US,B2
US-7176602-B2,US,B2
US-9143862-B2,US,B2
US-8053171-B2,US,B2
US-8544057-B2,US,B2
US-7676993-B2,US,B2
US-7531430-B2,US,B2
US-7830193-B2,US,B2
US-9197661-B2,US,B2
US-8281593-B2,US,B2
US-7179349-B2,US,B2
US-8059949-B2,US,B2
US-7033261-B2,US,B2
US-8269458-B2,US,B2
US-8522557-B2,US,B2
US-8362855-B2,US,B2
US-7708492-B2,US,B2
US-7808201-B2,US,B2
US-6852425-B2,US,B2
US-8202745-B2,US,B2
US-6808587-B2,US,B2
US-8593015-B2,US,B2
US-6908096-B2,US,B2
US-7137747-B2,US,B2
US-8127992-B2,US,B2
US-8290010-B2,US,B2
US-6708776-B2,US,B2
US-7057340-B2,US,B2
US-7498861-B2,US,B2
US-9473501-B2,US,B2
US-9086293-B2,US,B2
US-7643385-B2,US,B2
US-8456858-B2,US,B2
US-7066032-B2,US,B2
US-7054764-B2,US,B2
US-6925769-B2,US,B2
US-7522374-B2,US,B2
US-7545887-B2,US,B2
US-9651655-B2,US,B2
US-9030947-B2,US,B2
US-6340064-B2,US,B2
US-6952573-B2,US,B2
US-8353954-B2,US,B2
US-8661972-B2,US,B2
US-6978773-B2,US,B2
US-7322681-B2,US,B2
US-7165803-B2,US,B2
US-7609310-B2,US,B2
US-9304360-B2,US,B2
US-8338529-B2,US,B2
US-6999381-B2,US,B2
US-7238470-B2,US,B2
US-6924366-B2,US,B2
US-7820001-B2,US,B2
US-8080515-B2,US,B2
US-7127557-B2,US,B2
US-8954232-B2,US,B2
US-6866631-B2,US,B2
US-8254317-B2,US,B2
US-8461930-B2,US,B2
US-7480060-B2,US,B2
US-6966100-B2,US,B2
US-6695145-B2,US,B2
US-9076653-B2,US,B2
US-9387827-B2,US,B2
US-8076519-B2,US,B2
US-7555234-B2,US,B2
US-8615281-B2,US,B2
US-8147470-B2,US,B2
US-8148575-B2,US,B2
US-9047435-B2,US,B2
US-8153074-B2,US,B2
US-9333719-B2,US,B2
US-8919830-B2,US,B2
US-9743211-B2,US,B2
US-6917653-B2,US,B2
US-7939921-B2,US,B2
US-6666152-B2,US,B2
US-6914921-B2,US,B2
US-6817384-B2,US,B2
US-7421051-B2,US,B2
US-8777490-B2,US,B2
US-9160846-B2,US,B2
US-8216528-B2,US,B2
US-8373784-B2,US,B2
US-7695394-B2,US,B

2025-01-20 06:00:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:21 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:22 - root - INFO - SQL:
SELECT "publication_number", "grant_date" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   WHERE "grant_date" BETWEEN 20100101 AND 20141231 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,grant_date
EP-2409946-B1,20140507
JP-5036281-B2,20120926
GB-201008313-D0,20100707
JP-5065641-B2,20121107
CN-202476678-U,20121010
JP-5008058-B2,20120822
JP-5439596-B2,20140312
CN-201875846-U,20110622
CN-202377459-U,20120815
CN-202386491-U,20120822
CN-203879581-U,20141015
EP-1775720-B1,20111109
CN-201778352-U,20110330
CN-202008336-U,20111012
CN-202751797-U,20130227
CN-201482889-U,20100526
JP-5551640-B2,20140716
CN-201750912-U,20110223
CN-202788073-U,20130313
CA-2533614-C,20110503
CN-102392153-B,20140115
EP-1832160-B1,20110223
CN-102221073-B,20130327
US-8768622-B2,20140701
CN-103146534-B,20140319
KR-101284644-B1,20130711
KR-101356112-B1,20140129
US-7727119-B2,20100601
RU-2499633-C1,20131127
CN-102123931-B,20130515
CN-101421795-B,20130306
CN-101983201-B,20140423
CN-101546982-B,20110413
CN-102035046-B,20130612
KR-101248374-B1,20130401
CN-102838039-B,20140903
CN-1989298-B,20101117
CN-102001537-B,20130327
CN-102507392-B,20130814
CN-101753397-B,20121114
CN-100594022-C,20100317
CN-102372790-B,20130410
RU-2449358-C1,20120427
US-8591484-B2,20131126
CN-203550037-U,20140416
JP-4712713-B2,20110629
DE-202011052218-U1,20130109
JP-4538960-B2,20100908
RU-2465397-C1,20121027
US-8894929-B2,20141125
JP-4591505-B2,20101201
GB-2475537-B,20120125
CN-102170665-B,20130807
CN-102168881-B,20130619
KR-100994778-B1,20101117
CN-100591970-C,20100224
US-8550498-B2,20131008
CN-102108427-B,20120530
DE-102008053495-B4,20130103
CN-102449429-B,20140423
CN-101719181-B,20120704
CN-103634577-B,20141231
CN-102020446-B,20131023
US-8084696-B2,20111227
CN-101204742-B,20100526
US-8719990-B2,20140513
CN-101539009-B,20111005
CN-101576374-B,20110525
KR-101220417-B1,20130110
CN-101229787-B,20100901
CN-102017578-B,20141210
US-8719514-B2,20140506
US-8324898-B2,20121204
JP-4678032-B2,20110427
KR-101326001-B1,20131120
DE-102010036823-B8,20110818
US-7746011-B2,20100629
EP-1498629-B2,20131016
KR-101211327-B1,20121211
KR-101222043-B1,20130115
JP-4739062-B2,20110803
KR-100989724-B1,20101026
CN-102267494-B,20130123
US-8613206-B2,20131224
KR-101357430-B1,20140206
CN-1614956-B,20100505
US-7819758-B2,20101026
KR-101414981-B1,20140704
CN-101932380-B,20140319
NL-1037900-C,20111021
CN-101259887-B,20101013
CN-101847042-B,20111228
CN-101180839-B,20120215
CN-102234769-B,20141105
CN-101459378-B,20110309
CN-101302157-B,20110427
KR-101297073-B1,20130814
US-8729750-B2,20140520
US-7990739-B2,20110802
US-8824115-B2,20140902
CN-101253079-B,20101103
CN-100587710-C,20100203
DE-10308893-B4,20130919
KR-101009365-B1,20110119
CN-102064876-B,20130807
KR-101453731-B1,20141023
CN-101444011-B,20130220
US-8518784-B2,20130827
RU-2457643-C2,20120810
JP-4750889-B2,20110817
CN-101550011-B,20111005
CN-101549190-B,20120208
CN-101330719-B,20110810
KR-101379971-B1,20140410
CN-102158275-B,20131218
US-8141404-B2,20120327
US-7912686-B2,20110322
US-7904645-B2,20110308
CN-101586954-B,20120725
CN-103115813-B,20141022
CN-102688095-B,20140827
KR-100977469-B1,20100823
US-8073568-B2,20111206
US-8792886-B2,20140729
US-8528838-B2,20130910
CN-1986652-B,20101117
DE-10242257-B4,20131219
CN-1965694-B,20100414
CN-102526592-B,20130925
US-8023832-B2,20110920
RU-2511820-C2,20140410
CN-101890356-B,20130123
CN-1876659-B,20101222
GB-2451060-B,20130109
CN-101977996-B,20130102
CN-101820209-B,20121107
KR-100957377-B1,20100511
DE-102011006417-B3,20120830
KR-101155542-B1,20120618
CN-101552453-B,20120111
KR-101249589-B1,20130401
DE-102011016802-B4,20130221
CN-101029336-B,20101103
US-7786464-B2,20100831
KR-100970215-B1,20100716
US-7831404-B2,20101109
US-8508659-B2,20130813
CN-102036066-B,20130619
CN-102653256-B,20141105
CN-101510138-B,20120711
US-8073622-B2,20111206
US-8288748-B2,20121016
CN-101906454-B,20120815
US-8167061-B2,20120501
US-D620166-S,20100720
CN-102690433-B,20140716
CN-102113186-B,20140625
KR-101154296-B1,20120613
US-8218633-B2,20120710
CN-101811426-B,20121226
CN-102697304-B,20140402
CN-102249729-B,20130320
DE-10302601-B4,20100114
CN-103184225-B,20140813
RU-2500182-C1,20131210
CN-1889342-B,20100421
CN-101379515-B,20130102
CN-101243270-B,20110706
CN-102391195-B,20140507
JP-4600012-B2,20101215
CN-101937150-B,20120104
US-8154416-B1,20120410
US-8924594-B2,20141230
CN-102542858-B,20140611
US-8100264-B2,20120124
JP-5044395-B2,20121010
GB-2480765-B,20120801
KR-101147917-B1,20120525
CN-101592546-B,20121024
CN-101065445-B,20110511
JP-4925317-B2,20120425
CN-203099880-U,20130731
CN-203203414-U,20130918
RU-2397920-C2,20100827
CN-203705655-U,20140709
EP-2060396-B1,20100929
JP-5094281-B2,20121212
CN-202309349-U,20120704
ES-2399998-T3,20130404
CN-203953961-U,20141126
EP-2384771-B1,20130123
JP-5400994-B2,20140129
KR-101161137-B1,20120702
CN-201770958-U,20110323
US-8058883-B2,20111115
CN-203557466-U,20140423
EP-1979895-B1,20131009
CN-202344020-U,20120725
CN-203920796-U,20141105
CN-203265043-U,20131106
CN-203348719-U,20131218
CN-201534006-U,20100728
CN-201662302-U,20101201
JP-4787078-B2,20111005
JP-5142712-B2,20130213
CN-203999256-U,20141210
US-8548365-B2,20131001
CN-202833828-U,20130327
EP-1627846-B1,20100203
GB-

2025-01-20 06:00:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:23 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:24 - root - INFO - SQL:
SELECT "publication_number", "filing_date" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-

2025-01-20 06:00:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:25 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:26 - root - INFO - SQL:
SELECT "publication_number", "cited_by" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cited_by
CA-27-A,[]
ES-81-Y,[]
DE-303-C,[]
ES-866-Y,[]
FI-150-A,[]
FI-250-A,[]
FR-336-E,[]
NL-284-C,[]
NL-947-C,[]
BE-107-T1,[]
CA-1911-A,[]
CA-4005-A,[]
CA-4106-A,[]
CA-4698-A,[]
CA-4801-A,[]
CA-5943-A,[]
CA-6183-A,[]
CA-6207-A,[]
CA-6390-A,[]
CA-6969-A,[]
CA-8931-S,[]
CA-9897-A,[]
DE-3129-C,[]
DE-3301-C,[]
DE-3884-C,[]
DE-3983-C,[]
DE-5976-C,[]
DK-2807-C,[]
DK-3080-C,[]
DK-3107-C,[]
DK-3184-C,[]
DK-3510-C,[]
DK-5867-C,[]
DK-5921-C,[]
DK-6491-A,[]
DK-7210-C,[]
DK-8069-C,[]
DK-8466-C,[]
DK-9281-C,[]
DK-9359-C,[]
ES-1062-U,[]
ES-1498-U,[]
ES-1524-Y,[]
ES-1872-U,[]
ES-2542-Y,[]
ES-2819-Y,[]
ES-2960-U,[]
ES-3045-U,[]
ES-4483-Y,[]
ES-4723-Y,[]
ES-4858-U,[]
ES-5089-Y,[]
ES-5219-Y,[]
ES-5716-U,[]
ES-5975-Y,[]
ES-6454-U,[]
ES-6552-Y,[]
ES-6928-Y,[]
ES-6962-Y,[]
ES-7086-Y,[]
ES-7407-Y,[]
ES-7489-Y,[]
ES-7516-U,[]
ES-7538-U,[]
ES-764-H3,[]
ES-8269-Y,[]
FI-1825-A,[]
FI-291-U1,[]
FI-3021-A,[]
FI-4211-A,[]
FI-4543-A,[]
FI-8034-A,[]
FI-8619-A,[]
FI-8985-A,[]
FI-902-U1,[]
FR-1186-E,[]
FR-1382-E,[]
FR-1550-M,[]
FR-2064-E,[]
FR-2510-M,[]
FR-2578-M,[]
FR-2635-E,[]
FR-3293-M,[]
FR-5174-E,[]
FR-5770-E,[]
FR-7085-M,[]
FR-7747-E,[]
FR-8053-M,[]
FR-8143-M,[]
NL-3613-C,[]
NL-4187-C,[]
NL-5034-C,[]
NL-9752-C,[]
NL-9761-C,[]
RU-815-U1,[]
US-1260-A,[]
US-1844-A,[]
US-3704-A,[]
US-4174-P,[]
US-4340-A,[]
US-4449-P,[]
US-4570-P,[]
US-5293-P,[]
US-5333-A,[]
US-5618-A,[]
US-6399-A,[]
US-6501-P,[]
US-7090-A,[]
US-7624-A,[]
US-7703-P,[]
US-7765-P,[]
US-8162-P,[]
US-8923-P,[]
US-9153-A,[]
US-9563-A,[]
US-H817-H,[]
CA-10240-A,[]
CA-10445-A,[]
CA-11856-A,[]
CA-12085-A,[]
CA-12299-A,[]
CA-12359-A,[]
CA-12986-A,[]
CA-14364-A,[]
CA-15108-A,[]
CA-15467-A,[]
CA-16464-A,[]
CA-16944-A,[]
CA-17107-A,[]
CA-18535-S,[]
CA-19006-S,[]
CA-21676-A,[]
CA-21706-A,[]
CA-21979-A,[]
CA-22497-S,[]
CA-22705-A,[]
CA-23044-A,[]
CA-25240-S,[]
CA-25587-A,[]
CA-26172-A,[]
CA-27810-A,[]
CA-29171-S,[]
CA-29565-A,[]
CA-30563-S,[]
CA-30747-A,[]
CA-31066-A,[]
CA-31656-A,[]
CA-34117-A,[]
CA-34328-A,[]
CA-35530-A,[]
CA-36126-A,[]
CA-37060-A,[]
CA-37412-A,[]
CA-38186-A,[]
CA-38290-A,[]
CA-38566-A,[]
CA-39941-A,[]
CA-41986-A,[]
CA-42957-A,[]
CA-43582-A,[]
CA-43613-A,[]
CA-43665-A,[]
CA-44103-A,[]
CA-44675-A,[]
CA-45114-S,[]
CA-45162-A,[]
CA-46041-S,[]
CA-46346-S,[]
CA-46414-S,[]
CA-46650-A,[]
CA-47228-S,[]
CA-47556-A,[]
CA-47943-A,[]
CA-48005-S,[]
CA-50059-A,[]
CA-51084-S,[]
CA-51448-A,[]
CA-53020-A,[]
CA-53342-A,[]
CA-53679-A,[]
CA-54019-A,[]
CA-56199-S,[]
CA-57871-A,[]
CA-58112-A,[]
CA-59658-S,[]
CA-62116-A,[]
CA-63512-A,[]
CA-64348-A,[]
CA-64895-A,[]
CA-64959-A,[]
CA-65051-A,[]
CA-65468-A,[]
CA-66408-A,[]
CA-67027-A,[]
CA-67256-A,[]
CA-68355-A,[]
CA-68561-A,[]
CA-69952-A,[]
CA-69969-A,[]
CA-70837-S,[]
CA-71352-A,[]
CA-72557-S,[]
CA-73229-S,[]
CA-73434-A,[]
CA-73648-A,[]
CA-75054-A,[]
CA-75833-A,[]
CA-75940-A,[]
CA-76442-A,[]
CA-77673-S,[]
CA-78154-A,[]
CA-78848-A,[]
CA-80485-S,[]
CA-81879-A,[]
CA-82735-A,[]
CA-83640-A,[]
CA-84428-S,[]
CA-84611-A,[]
CA-85458-S,[]
CA-87085-A,[]
CA-87655-A,[]
CA-88869-A,[]
CA-89598-S,[]
CA-90451-A,[]
CA-90703-A,[]
CA-91407-A,[]
CA-91839-A,[]
CA-92136-S,[]
CA-92671-S,[]
CA-93153-A,[]
CA-93847-S,[]
CA-94404-A,[]
CA-94834-A,[]
CA-95812-A,[]
CA-96813-A,[]
CA-97691-A,[]
CA-97784-A,[]
CA-98415-S,[]
CA-98613-A,[]
CA-98742-A,[]
CA-99391-S,[]
CA-99529-A,[]
DE-10599-C,[]
DE-10678-C,[]
DE-10717-C,[]
DE-12268-C,[]
DE-16453-C,[]
DE-17382-C,[]
DE-17635-C,[]
DE-18657-C,[]
DE-21533-C,[]
DE-21800-C,[]
DE-22191-C,[]
DE-24092-C,[]
DE-24550-C,[]
DE-26040-C,[]
DE-26251-C,[]
DE-26645-C,[]
DE-27162-C,[]
DE-28245-C,[]
DE-28664-C,[]
DE-29317-C,[]
DE-29580-C,[]
DE-29751-C,[]
DE-29873-C,[]
DE-34701-C,[]
DE-35759-C,[]
DE-36143-C,[]
DE-36572-C,[]
DE-36880-C,[]
DE-37006-C,[]
DE-39978-C,[]
DE-41212-C,[]
DE-41909-C,[]
DE-43016-C,[]
DE-43252-C,[]
DE-43745-C,[]
DE-44221-C,[]
DE-44490-C,[]
DE-46714-C,[]
DE-46729-C,[]
DE-46866-C,[]
DE-47512-C,[]
DE-48016-C,[]
DE-48200-C,[]
DE-48281-C,[]
DE-48415-C,[]
DE-48624-C,[]
DE-48946-C,[]
DE-55522-C,[]
DE-57100-C,[]
DE-59206-C,[]
DE-62156-C,[]
DE-62668-C,[]
DE-64182-C,[]
DE-64466-C,[]
DE-68843-C,[]
DE-69224-C,[]
DE-69735-C,[]
DE-70329-C,[]
DE-70421-C,[]
DE-70605-C,[]
DE-71525-C,[]
DE-72135-C,[]
DE-72417-C,[]
DE-73920-C,[]
DE-75006-C,[]
DE-75333-C,[]
DE-78770-C,[]
DE-82929-C,[]
DE-83658-C,[]
DE-83966-C,[]
DE-84792-C,[]
DE-87929-C,[]
DE-90760-C,[]
DE-91921-C,[]
DE-92960-C,[]
DE-93320-C,[]
DE-93611-C,[]
DE-94567-C,[]
DE-96265-C,[]
DE-97461-C,[]
DE-98822-C,[]
DK-10751-C,[]
DK-11017-C,[]
DK-11274-A,[]
DK-11549-C,[]
DK-13429-C,[]
DK-14113-C,[]
DK-15486-A,[]
DK-15672-C,[]
DK-16003-C,[]
DK-16200-C,[]
DK-16721-C,[]
DK-17077-C,[]
DK-17891-C,[]
DK-18174-A,[]
DK-18287-C,[]
DK-18953-C,[]
DK-19067-C,[]
DK-20848-C,[]
DK-21534-C,[]
DK-21593-C,[]
DK-24093-C,[]
DK-24122-C,[]
DK-24560-C,[]
DK-24764-C,[]
DK-25033-C,[]
DK-26002-C,[]
DK-28460-C,[]
DK-30663-C,[]
DK-31338-C,[]
DK-32802-C,[]
DK-32923-C,[]
DK-32960-C,[]
DK-33342-C,[]
DK-33585-C,[]
DK-34417-C,[]
DK-34475-A,[]
DK-34847-C,[]
DK-3485-D0,[]
DK-35287-A,[]
DK-35387-A,[]
DK-36818-C,[]
DK-

2025-01-20 06:00:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 768
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:28 - root - INFO - SQL:
SELECT 
     t."publication_number", 
     f.value::STRING AS "cited_by_publication_number" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
        LATERAL FLATTEN(input => t."cited_by") f 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cited_by_publication_number
US-875395-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3131514-A"",""type"":""""}"
DE-460919-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-968296-C"",""type"":""""}"
DE-752022-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3346037-A"",""type"":""""}"
DE-957646-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-1181637-B"",""type"":""""}"
US-2063551-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4945253-A"",""type"":""""}"
US-1671917-A,"{""application_number"":"""",""category"":""PRS"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2011293380-A1"",""type"":""""}"
US-2334161-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2667284-A"",""type"":""""}"
US-1246221-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3762528-A"",""type"":""""}"
US-768727-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4168809-A"",""type"":""""}"
DE-963253-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-1134440-B"",""type"":""""}"
US-192092-A,"{""application_number"":"""",""category"":""PRS"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2007030943-A1"",""type"":""""}"
US-3544242-A,"{""application_number"":"""",""category"":""ISR"",""filing_date"":0,""npl_text"":"""",""publication_number"":""WO-2017133281-A1"",""type"":""X""}"
US-1536267-A,"{""application_number"":"""",""category"":""APP"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-7140148-B1"",""type"":""""}"
DE-201246-C,"{""application_number"":"""",""category"":""APP"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-6899907-B1"",""type"":""""}"
US-1375598-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4502500-A"",""type"":""""}"
US-3370936-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3849112-A"",""type"":""""}"
CA-534930-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3322118-A"",""type"":""""}"
US-1448365-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2789086-A"",""type"":""""}"
US-1030907-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3509618-A"",""type"":""""}"
US-1831357-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-1235541-B"",""type"":""""}"
US-2762081-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3021255-A"",""type"":""""}"
US-815363-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4632761-A"",""type"":""""}"
US-257973-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4611716-A"",""type"":""""}"
US-3538157-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4401780-A"",""type"":""""}"
CA-671728-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3298363-A"",""type"":""""}"
US-2132921-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3289126-A"",""type"":""""}"
US-910084-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2728987-A"",""type"":""""}"
DE-254654-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3414359-A"",""type"":""""}"
US-1454341-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2720211-A"",""type"":""""}"
US-1041006-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3355783-A"",""type"":""""}"
US-1044437-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2596910-A"",""type"":""""}"
DE-258831-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_numb

2025-01-20 06:00:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 81
2025-01-20 06:00:32 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:32 - root - INFO - SQL:
SELECT "publication_number", "embedding_v1" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 

2025-01-20 06:00:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 81
2025-01-20 06:00:36 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:36 - root - INFO - SQL:
SELECT 
     p."publication_number", 
     p."filing_date", 
     a."embedding_v1" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
     ON p."publication_number" = a."publication_number" 
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,filing_date,embedding_v1
CA-27-A,0,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,19291217,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,0,[]
ES-866-Y,19320407,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.64

2025-01-20 06:00:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-20 06:00:40 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:40 - root - INFO - SQL:
SELECT 
      p."publication_number", 
      p."filing_date", 
      a."embedding_v1" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
      ON p."publication_number" = a."publication_number" 
    WHERE p."filing_date" BETWEEN 20120101 AND 20121231 
    LIMIT 1000;
Results:
Too long, hard cut:
publication_number,filing_date,embedding_v1
US-D686406-S,20120510,"[
  -1.503766800000000e-02,
  -3.119330000000000e-01,
  -2.149303400000000e-01,
  -2.103819400000000e-01,
  -1.376698600000000e-01,
  -2.563466700000000e-01,
  -1.458266000000000e-01,
  -8.732291000000000e-02,
  4.466908000000000e-02,
  -3.271143000000000e-01,
  -3.157764000000000e-03,
  3.386559300000000e-02,
  2.447655600000000e-01,
  5.202678000000000e-02,
  -7.615336000000000e-02,
  4.359198000000000e-02,
  1.269905300000000e-01,
  -1.272555700000000e-01,
  -8.923966400000000e-02,
  7.447965400000000e-03,
  -2.062326000000000e-02,
  2.237342500000000e-02,
  -3.331764400000000e-02,
  8.527288600000001e-02,
  6.122692300000000e-02,
  4.627490000000000e-02,
  7.641771999999999e-02,
  3.524680800000000e-02,
  1.193518640000000e-01,
  9.382409999999999e-02,
  -2.004328000000000e-02,
  1.994392100000000e-01,
  6.403068500000000e-02,
  -2.204417600000000e-01,
  -1.119889100000000e-01,
  -2.197366800000000e-01,
  5.287633000000000e-03,
  -9.199329000000001e-02,
  6.896515000000000e-02,
  9.779547000000000e-02,
  -8.363107000000000e-02,
  -6.480062000000000e-02,
  1.260861500000000e-01,
  -5.653400300000000e-02,
  -7.196350400000000e-02,
  -9.437039500000000e-02,
  5.502897000000000e-02,
  -6.934184000000000e-02,
  -4.768358000000000e-02,
  -1.524096100000000e-01,
  -1.562575700000000e-01,
  -5.917117400000000e-02,
  -7.497550500000000e-02,
  7.109153000000000e-02,
  -1.263489600000000e-01,
  6.490047000000000e-03,
  -1.872070100000000e-01,
  5.158940000000000e-03,
  9.782600000000000e-02,
  1.385354800000000e-01,
  -1.205637300000000e-01,
  2.094933000000000e-01,
  2.909245700000000e-02,
  1.990190500000000e-02
]"
US-D695024-S,20120711,"[
  -1.181458900000000e-02,
  -2.965099500000000e-01,
  -1.497571900000000e-01,
  -1.599657500000000e-01,
  -1.652039400000000e-01,
  -1.967024700000000e-01,
  -1.396702500000000e-01,
  -1.772636900000000e-01,
  1.620531800000000e-02,
  -3.568597700000000e-01,
  8.072954000000000e-03,
  -2.753459700000000e-02,
  1.688586300000000e-01,
  2.002250800000000e-02,
  -3.473421000000000e-02,
  -5.449174300000000e-02,
  9.312547000000000e-02,
  -1.535499200000000e-01,
  -1.446259900000000e-01,
  4.944423200000000e-02,
  1.645438700000000e-02,
  -3.902551000000000e-02,
  -2.109913700000000e-02,
  3.467744600000000e-02,
  1.380163300000000e-01,
  7.252678000000000e-02,
  1.563998000000000e-01,
  -4.075078000000000e-02,
  2.129636100000000e-01,
  5.509719300000000e-02,
  1.617461800000000e-02,
  1.331511100000000e-01,
  1.001959400000000e-02,
  -2.382915500000000e-01,
  -6.539947500000000e-02,
  -2.138463900000000e-01,
  -5.861050600000000e-02,
  -7.940677000000000e-02,
  3.237951000000000e-02,
  4.353514700000000e-02,
  -7.473980000000000e-02,
  4.390830000000000e-02,
  3.142716400000000e-02,
  1.276574900000000e-02,
  -9.929346999999999e-02,
  -1.107905900000000e-01,
  5.035261800000000e-02,
  -1.593732100000000e-01,
  -5.078559700000000e-02,
  -1.152881000000000e-01,
  -1.421779800000000e-01,
  -1.494841700000000e-01,
  -1.289417400000000e-01,
  6.673875000000000e-02,
  -8.723056000000000e-02,
  -6.973574000000000e-02,
  -1.821464900000000e-01,
  -1.326980800000000e-02,
  1.325164000000000e-01,
  1.573602300000000e-01,
  -1.021444000000000e-01,
  2.297445000000000e-01,
  -1.452806400000000e-02,
  -1.513769100000000e-02
]"
CN-102582151-A,20120210,"[
  9.935207000000000e-02,
  -2.965937200000000e-02,
  -1.872762300000000e-01,
  1.974629300000000e-01,
  -1.530134200000000e-01,
  6.411367000000000e-02,
  -1.513790500000000e-01,
  1.382584000000000e-01,
  1.641116900000000e-01,
  -1.735723300000000e-01,
  1.020542800000000e-01,
  2.067769200000000e-01,
  1.092429700000000e-01,
  -6.159592800000000e-02,
  -7.489670000000000e-02,
  1.190694650000000e-01,
  -2.554188000000000e-02,
  -1.270228900000000e-02,
  7.363427000000000e-02,
  1.050589000000000e-01,
  2.071593700000000e-01,
  1.005639000000000e-01,
  -6.270960000000000e-02,
  4.955024000000000e-02,
  5.463313000000000e-02,
  -1.420007200000000e-02,
  1.344795000000000e-01,
  -4.051733800000000e-02,
  3.570080000000000e-02,
  -1.717809600000000e-02,
  1.012267000000000e-01,
  1.322158000000000e-01,
  8.259886000000000e-02,
  -1.950780300000000e-01,
  7.556661000000001e-02,
  -6.371056999999999e-02,
  -1.966576700000000e-02,
  -1.961409400000000e-01,
  -1.390397400000000e-01,
  2.124205500000000e-01,
  8.897847000000000e-02,
  4.978589700000000e-02,
  2.016462700000000e-01,
  1.474400900000000e-01,
  -3.813900400000000e-02,
  -1.799577000000000e-02,
  3.592952000000000e-02,
  -1.303800000000000e-01,
  -6.684045499999999e-02,
  -1.421922600000000e-01,
  -3.330913500000000e-01,
  -1.023436150000000e-02,
  -3.134109000000000e-02,
  -1.009312400000000e-01,
  -2.746858800000000e-02,
  -1.277605300000000e-01,
  -1.264122900000000e-01,
  5.226337500000000e-02,
  2.309033900000000e-01,
  2.671812500000000e-01,
  2.717423800000000e-02,
  1.520399700000000e-02,
  6.670042599999999e-04

2025-01-20 06:00:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:42 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:42 - root - INFO - SQL:
SELECT 
      "publication_number", 
      "country_code", 
      "kind_code", 
      "grant_date" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
    WHERE "country_code" = 'US' 
      AND "kind_code" LIKE '%B2%' 
      AND "grant_date" BETWEEN 20100101 AND 20141231 
    LIMIT 1000;
Results:
Too long, hard cut:
publication_number,country_code,kind_code,grant_date
US-8898436-B2,US,B2,20141125
US-7647288-B2,US,B2,20100112
US-7827217-B2,US,B2,20101102
US-8793381-B2,US,B2,20140729
US-8306362-B2,US,B2,20121106
US-8886182-B2,US,B2,20141111
US-8761223-B2,US,B2,20140624
US-8363444-B2,US,B2,20130129
US-8017772-B2,US,B2,20110913
US-8068772-B2,US,B2,20111129
US-8272705-B2,US,B2,20120925
US-8755917-B2,US,B2,20140617
US-8702115-B2,US,B2,20140422
US-7941073-B2,US,B2,20110510
US-8614881-B2,US,B2,20131224
US-8514326-B2,US,B2,20130820
US-8656204-B2,US,B2,20140218
US-8222155-B2,US,B2,20120717
US-8098275-B2,US,B2,20120117
US-8853374-B2,US,B2,20141007
US-8263057-B2,US,B2,20120911
US-8457657-B2,US,B2,20130604
US-8858390-B2,US,B2,20141014
US-8902701-B2,US,B2,20141202
US-8836621-B2,US,B2,20140916
US-8130625-B2,US,B2,20120306
US-8846234-B2,US,B2,20140930
US-7846394-B2,US,B2,20101207
US-8087045-B2,US,B2,20111227
US-8684320-B2,US,B2,20140401
US-8639874-B2,US,B2,20140128
US-8527303-B2,US,B2,20130903
US-8697506-B2,US,B2,20140415
US-8779491-B2,US,B2,20140715
US-8622869-B2,US,B2,20140107
US-8194070-B2,US,B2,20120605
US-8618832-B2,US,B2,20131231
US-8303190-B2,US,B2,20121106
US-7869016-B2,US,B2,20110111
US-8609823-B2,US,B2,20131217
US-8717022-B2,US,B2,20140506
US-8843939-B2,US,B2,20140923
US-8144627-B2,US,B2,20120327
US-8631198-B2,US,B2,20140114
US-8764962-B2,US,B2,20140701
US-8563362-B2,US,B2,20131022
US-7836829-B2,US,B2,20101123
US-8503430-B2,US,B2,20130806
US-7813884-B2,US,B2,20101012
US-8539588-B2,US,B2,20130917
US-8898576-B2,US,B2,20141125
US-8694495-B2,US,B2,20140408
US-8479056-B2,US,B2,20130702
US-8450859-B2,US,B2,20130528
US-8021293-B2,US,B2,20110920
US-8436539-B2,US,B2,20130507
US-8899209-B2,US,B2,20141202
US-8499502-B2,US,B2,20130806
US-8207994-B2,US,B2,20120626
US-7932928-B2,US,B2,20110426
US-8768937-B2,US,B2,20140701
US-8527172-B2,US,B2,20130903
US-7916232-B2,US,B2,20110329
US-8179406-B2,US,B2,20120515
US-8512590-B2,US,B2,20130820
US-8597297-B2,US,B2,20131203
US-8195593-B2,US,B2,20120605
US-8043863-B2,US,B2,20111025
US-8298048-B2,US,B2,20121030
US-8468999-B2,US,B2,20130625
US-8563604-B2,US,B2,20131022
US-8388547-B2,US,B2,20130305
US-7919127-B2,US,B2,20110405
US-7960124-B2,US,B2,20110614
US-8360677-B2,US,B2,20130129
US-8120188-B2,US,B2,20120221
US-8510585-B2,US,B2,20130813
US-7972997-B2,US,B2,20110705
US-8345648-B2,US,B2,20130101
US-8907742-B2,US,B2,20141209
US-8358913-B2,US,B2,20130122
US-8715559-B2,US,B2,20140506
US-8255820-B2,US,B2,20120828
US-8921814-B2,US,B2,20141230
US-8734946-B2,US,B2,20140527
US-8817655-B2,US,B2,20140826
US-8470068-B2,US,B2,20130625
US-7719769-B2,US,B2,20100518
US-8796427-B2,US,B2,20140805
US-8123887-B2,US,B2,20120228
US-8753121-B2,US,B2,20140617
US-8024580-B2,US,B2,20110920
US-8010597-B2,US,B2,20110830
US-7682634-B2,US,B2,20100323
US-8809215-B2,US,B2,20140819
US-8731448-B2,US,B2,20140520
US-8366022-B2,US,B2,20130205
US-8508915-B2,US,B2,20130813
US-8230022-B2,US,B2,20120724
US-8668263-B2,US,B2,20140311
US-8400201-B2,US,B2,20130319
US-8909532-B2,US,B2,20141209
US-7904392-B2,US,B2,20110308
US-8429213-B2,US,B2,20130423
US-7703739-B2,US,B2,20100427
US-8516790-B2,US,B2,20130827
US-7902735-B2,US,B2,20110308
US-8257311-B2,US,B2,20120904
US-8818475-B2,US,B2,20140826
US-8816690-B2,US,B2,20140826
US-7800202-B2,US,B2,20100921
US-7937342-B2,US,B2,20110503
US-8595433-B2,US,B2,20131126
US-8834913-B2,US,B2,20140916
US-7947532-B2,US,B2,20110524
US-8018507-B2,US,B2,20110913
US-8436157-B2,US,B2,20130507
US-8277945-B2,US,B2,20121002
US-7928235-B2,US,B2,20110419
US-8099028-B2,US,B2,20120117
US-8372978-B2,US,B2,20130212
US-7998666-B2,US,B2,20110816
US-8064292-B2,US,B2,20111122
US-8206740-B2,US,B2,20120626
US-8537082-B2,US,B2,20130917
US-8058876-B2,US,B2,20111115
US-8257841-B2,US,B2,20120904
US-8246978-B2,US,B2,20120821
US-8616292-B2,US,B2,20131231
US-8815476-B2,US,B2,20140826
US-8726198-B2,US,B2,20140513
US-8277534-B2,US,B2,20121002
US-8862262-B2,US,B2,20141014
US-7756270-B2,US,B2,20100713
US-8313878-B2,US,B2,20121120
US-7824486-B2,US,B2,20101102
US-8687170-B2,US,B2,20140401
US-8563509-B2,US,B2,20131022
US-7989172-B2,US,B2,20110802
US-8136703-B2,US,B2,20120320
US-7852716-B2,US,B2,20101214
US-7818987-B2,US,B2,20101026
US-7885873-B2,US,B2,20110208
US-8043372-B2,US,B2,20111025
US-8146530-B2,US,B2,20120403
US-7755655-B2,US,B2,20100713
US-8518710-B2,US,B2,20130827
US-7871625-B2,US,B2,20110118
US-7701466-B2,US,B2,20100420
US-7854621-B2,US,B2,20101221
US-8246536-B2,US,B2,20120821
US-7746216-B2,US,B2,20100629
US-8907126-B2,US,B2,20141209
US-7831285-B2,US,B2,20101109
US-8912169-B2,US,B2,20141216
US-8865633-B2,US,B2,20141021
US-8725194-B2,US,B2,20140513
US-8049207-B2,US,B2,20111101
US-8784346-B2,US,B2,20140722
US-8543120-B2,US,B2,20130924
US-8052184-B2,US,B2,20111108
US-8267507-B2,US,B2,20120918
US-7904039-B2,US,B2,20110308
US-7997500-B2,US,B2,20110816
US-7691593-B2,US,B2,20100406
US-7661757-B2,US,B2,20100216
US-8051283-B2,US,B2,20111101
US-7989978-B2,US,B2,20110802
US-8003821-B2,US,B2,20110823
US-7796108-B2,US,B2,20100914
US-8691516-B2,US,

2025-01-20 06:00:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:44 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:44 - root - INFO - SQL:
SELECT 
      t."publication_number", 
      COUNT(f.value) AS "forward_citation_count" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
         LATERAL FLATTEN(input => t."cited_by") f 
    GROUP BY t."publication_number" 
    LIMIT 1000;
Results:
Too long, hard cut:
publication_number,forward_citation_count
DE-945915-C,1
US-5439656-A,1
US-2206400-A,1
US-506043-A,1
US-2056199-A,1
US-2873084-A,1
US-3394764-A,1
US-2126477-A,1
US-3781392-A,1
US-4868125-A,1
US-931503-A,1
US-1996199-A,1
US-1099037-A,1
US-1537450-A,1
US-2268951-A,1
CA-550117-A,1
US-2581468-A,1
US-1937996-A,1
US-476288-A,1
US-1961124-A,1
US-D351659-S,1
BE-649204-A,1
RU-2418591-C1,1
KR-101217759-B1,1
US-1029876-A,1
US-2920596-A,1
US-2124257-A,1
US-1126741-A,1
US-224442-A,1
DE-1219056-B,1
DE-1064432-B,1
EP-0123387-B1,1
DE-8716925-U1,1
DE-9217169-U1,1
DE-7912838-U1,1
DE-202011100575-U1,1
RU-2123191-C1,1
RU-2107675-C1,1
RU-2524343-C1,1
KR-101420653-B1,1
CN-201054068-Y,1
CN-2362707-Y,1
CN-2817382-Y,1
CN-105306690-A,1
CN-103007240-A,1
US-1339421-A,1
CN-2346747-Y,1
CN-2425568-Y,1
CN-102277763-A,1
CN-104068564-A,1
CN-102785781-A,1
CN-205062267-U,1
CN-204842658-U,1
CN-2040391-U,1
GB-239694-A,1
DE-102006053790-A1,1
DE-102007034869-A1,1
US-2002066794-A1,1
DE-2339054-A1,1
DE-2202230-A1,1
JP-3057649-U,1
US-1143324-A,1
US-2548486-A,1
EP-0178266-B1,1
US-156615-A,1
US-703221-A,1
US-1798870-A,1
US-613890-A,1
US-D716943-S,1
EP-1328765-B1,1
DE-1998138-U,1
DE-20318902-U1,1
DE-7630389-U1,1
BE-650914-A,1
RU-2127243-C1,1
KR-100491972-B1,1
CN-201022948-Y,1
CN-201341831-Y,1
CN-201358972-Y,1
CN-2548135-Y,1
CN-2147063-Y,1
CN-2927615-Y,1
CN-2709914-Y,1
CN-201141832-Y,1
CN-101837299-A,1
CN-101648993-A,1
CN-101456654-A,1
CN-1895970-A,1
CN-1137862-A,1
CN-102475360-A,1
CN-1619371-A,1
CN-1112590-C,1
DE-1729657-U,1
CN-2880879-Y,1
CN-2247439-Y,1
CN-2484753-Y,1
CN-101549911-A,1
CN-102205823-A,1
CN-1880126-A,1
CN-101256704-A,1
CN-101535972-A,1
CN-102296209-A,1
CN-102153381-A,1
CN-1745327-A,1
CN-102299015-A,1
CN-202298015-U,1
CN-203633195-U,1
CN-205322386-U,1
CN-205551308-U,1
CN-205645531-U,1
CN-201967517-U,1
CN-203621208-U,1
CN-201484197-U,1
CN-204532283-U,1
CN-204608791-U,1
DE-19653542-B4,1
GB-1033129-A,1
GB-1510831-A,1
GB-546559-A,1
GB-255980-A,1
RU-70352-U1,1
DE-102007061055-A1,1
US-2002028791-A1,1
US-2014181912-A1,1
US-2008311426-A1,1
US-2008130636-A1,1
US-2005187909-A1,1
US-2006036497-A1,1
DE-1703147-A1,1
DE-2133395-B2,1
DE-2262986-B2,1
JP-2657655-B2,1
JP-4839468-B2,1
JP-S62197712-A,1
JP-S57174251-A,1
JP-S61102443-A,1
JP-S5186027-A,1
JP-2012189912-A,1
CN-204886188-U,1
GB-583850-A,1
GB-1451185-A,1
GB-1222720-A,1
US-2013028550-A1,1
US-2015180101-A1,1
JP-S4729986-B1,1
JP-4537542-B2,1
JP-2003055950-A,1
GB-2005615-A,1
DE-3829797-A1,1
JP-H09308374-A,1
DE-4740-C,1
EP-0441071-B1,1
KR-101079975-B1,1
CN-2774155-Y,1
CN-104354672-A,1
CN-105569753-A,1
CN-103471065-A,1
CN-103216961-A,1
KR-101299989-B1,1
GB-191018027-A,1
DE-69724110-T2,1
CN-102971091-A,1
CN-105335995-A,1
CN-102426736-A,1
CN-103273758-A,1
CN-105733273-A,1
CN-102351105-A,1
CN-202868560-U,1
CN-206086230-U,1
CN-203580038-U,1
CN-204286983-U,1
CN-202179681-U,1
CN-202984967-U,1
CN-204126822-U,1
CN-203797583-U,1
CN-203499363-U,1
CN-204577491-U,1
CN-202127805-U,1
CN-203570169-U,1
KR-200454619-Y1,1
CA-2839491-A1,1
GB-165248-A,1
GB-1111206-A,1
GB-231863-A,1
GB-1446873-A,1
GB-519477-A,1
GB-2169790-A,1
GB-1289971-A,1
DE-102004017673-A1,1
DE-102007030019-A1,1
US-2015344942-A1,1
US-2013011751-A1,1
US-2005151924-A1,1
US-2013256445-A1,1
US-2010175681-A1,1
US-2014335325-A1,1
US-2009208764-A1,1
DE-19957935-A1,1
DE-10223377-A1,1
DE-3706768-A1,1
DE-2545805-A1,1
DE-19929530-A1,1
JP-3078187-U,1
EP-0344365-A3,1
JP-S4923923-B1,1
JP-4088937-B2,1
JP-3432192-B2,1
JP-5774212-B2,1
JP-3399933-B2,1
JP-2010216504-A,1
JP-S4976311-A,1
JP-S4969834-A,1
JP-H05150642-A,1
JP-S56155277-A,1
JP-2007321082-A,1
JP-H0456152-A,1
CN-203216544-U,1
KR-200185653-Y1,1
GB-2227336-A,1
GB-321895-A,1
US-2016180398-A1,1
DE-10042858-A1,1
DE-3306410-A1,1
DE-2547936-B2,1
JP-3709815-B2,1
JP-2007107079-A,1
DE-102006001188-A1,1
US-2015200574-A1,1
JP-4242401-B2,1
JP-2001106996-A,1
CN-104542391-A,1
KR-100805224-B1,1
CN-205058653-U,1
CN-201910127-U,1
CN-202853205-U,1
CN-203977157-U,1
DE-2251304-A1,1
JP-S5047506-A,1
JP-2015014690-A,1
JP-H1020280-A,1
US-2013286506-A1,1
JP-H07166071-A,1
CN-202490201-U,1
US-20054-A,1
CA-620630-A,1
BE-528196-A,1
CA-981169-A,1
DE-510279-C,1
DE-585723-C,1
DE-964911-C,1
NL-10194-C,1
DE-512603-C,1
DE-597097-C,1
FR-540984-A,1
FR-818236-A,1
FR-871186-A,1
DE-878032-C,1
DE-963589-C,1
FR-432355-A,1
FR-969445-A,1
GB-103963-A,1
GB-144874-A,1
GB-155610-A,1
GB-181570-A,1
US-242414-A,1
US-348920-A,1
US-387794-A,1
US-479920-A,1
US-693633-A,1
US-694059-A,1
US-710492-A,1
CA-1038554-A,1
CA-1047561-A,1
CN-1843834-A,1
CN-1908517-A,1
CN-2153721-Y,1
CN-2286398-Y,1
CN-2499532-Y,1
CN-2526917-Y,1
CN-2775531-Y,1
US-750861-A,1
CA-1073895-A,1
CN-1452773-A,1
CN-1883154-A,1
CN-2130062-Y,1
CN-2543480-Y,1
DE-1030049-B,1
DE-1713760-U,1
DE-1825216-U,1
DE-1839439-U,1
DE-6753005-U,1
FR-1368396-A,1
FR-1397525-A,1
FR-1521166-A,1
FR-1584610-A,1
GB-1577711-A,1
GB-1583165-A,1
GB-2003691-A,1
GB-2259184-B,1
GB-2353013-B,1
GB-2428358-B,1
GB-2452058-A,1
GB-2519587-A,1
JP-3137031-U,1
JP-S605098-A,1
US-1097840-A,1
US-1195015-A,1
US-1274451-A,1
US-1394436-A,1
US-1558588-A,

2025-01-20 06:00:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:45 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:02:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:02:07 - root - INFO - The error you're encountering is due to the way Snowflake handles `LATERAL` joins, specifically with `LEFT JOIN`. In Snowflake, `LATERAL` joins cannot include an `ON` clause when used with `LEFT JOIN` or `RIGHT JOIN`. Here's the relevant part of the error message:

```
Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'
```

To fix this error, you need to adjust your SQL query by removing the `ON TRUE` clause when performing a `LEFT JOIN LATERAL`. Here's how you can modify your query:

```sql
SELECT 
    p."publication_number", 
    p."filing_date", 
    COUNT(f.value) AS "forward_citation_count" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
GROUP BY p."publication_number", p."filing_date" 
LIMIT 1000;
```

By removing the `ON TRUE` clause, the query should now conform to Snowflake's syntax requirements for `LATERAL` joins.

**Explanation:**

- **Issue with `ON` Clause:** In your original query, the `ON TRUE` clause is not supported when using `LEFT JOIN LATERAL` in Snowflake. Unlike standard joins, `LATERAL` joins cannot have an `ON` clause in this context.
  
- **Correction:** Removing the `ON TRUE` clause allows the `LEFT JOIN LATERAL` to function correctly, as it no longer includes an unsupported predicate.

**Additional Suggestions:**

If you still encounter issues or if you prefer an alternative approach, you can consider the following methods:

1. **Use `ARRAY_SIZE` Function:**

   If you simply need the count of citations, you can use the `ARRAY_SIZE` function to count the number of elements in the `cited_by` array without flattening it:

   ```sql
   SELECT 
       p."publication_number", 
       p."filing_date",
       COALESCE(ARRAY_SIZE(a."cited_by"), 0) AS "forward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
       ON p."publication_number" = a."publication_number"
   LIMIT 1000;
   ```

   - **Note:** This method is efficient and avoids the need to unnest the array, but it won't allow you to filter citations based on dates within the array elements.

2. **Use a Subquery with `FLATTEN`:**

   If you need to work with the individual elements of the `cited_by` array (e.g., filter citations within a certain time frame), you can use a subquery:

   ```sql
   SELECT 
       p."publication_number", 
       p."filing_date",
       COALESCE(fc."forward_citation_count", 0) AS "forward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
       ON p."publication_number" = a."publication_number"
   LEFT JOIN (
       SELECT 
           a_sub."publication_number",
           COUNT(*) AS "forward_citation_count"
       FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a_sub,
       LATERAL FLATTEN(input => a_sub."cited_by") f_sub
       GROUP BY a_sub."publication_number"
   ) fc ON a."publication_number" = fc."publication_number"
   LIMIT 1000;
   ```

   - **Explanation:** This subquery flattens the `cited_by` array and counts the citations per publication. Then, we left join this count back to the main query.
   - **Advantage:** Allows for more complex operations on the `cited_by` elements, such as filtering based on properties within each citation.

**Addressing the Original Task:**

To solve your original task:

> **For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type.**

Here's how you can approach it:

1. **Filter Relevant Patents:**

   - Select patents from the `PUBLICATIONS` table where:
     - `"country_code"` = 'US'
     - `"kind_code"` LIKE '%B2%'
     - `"grant_date"` BETWEEN 20100101 AND 20141231

2. **Count Forward Citations Within One Month of Filing Date:**

   - Unnest the `cited_by` array using `FLATTEN`.
   - For each citation, join back to the `PUBLICATIONS` table to get the filing date of the citing patent.
   - Calculate the difference in filing dates.
   - Count citations where the citing patent's filing date is within one month after the original patent's filing date.

3. **Find Patent with Most Such Citations:**

   - Aggregate the counts and identify the patent with the highest number.

4. **Find the Most Similar Patent Filed in the Same Year:**

   - Use the `embedding_v1` column from the `ABS_AND_EMB` table to compute similarity.
   - Calculate the cosine similarity or dot product between the embeddings.
   - Find the patent with the highest similarity score filed in the same year.

**Sample Query to Count Forward Citations Within One Month of Filing Date:**

```sql
WITH relevant_patents AS (
    SELECT 
        p."publication_number", 
        p."filing_date"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    WHERE p."country_code" = 'US'
      AND p."kind_code" LIKE '%B2%'
      AND p."grant_date" BETWEEN 20100101 AND 20141231
),

citations AS (
    SELECT 
        rp."publication_number" AS original_pub_num,
        rp."filing_date" AS original_filing_date,
        cb.value:"publication_number"::STRING AS citing_pub_num
    FROM relevant_patents rp
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
        ON rp."publication_number" = a."publication_number"
    , LATERAL FLATTEN(input => a."cited_by") cb
),

citing_filings AS (
    SELECT 
        c.original_pub_num,
        c.original_filing_date,
        p_citing."publication_number" AS citing_pub_num,
        p_citing."filing_date" AS citing_filing_date,
        DATEDIFF('day', c.original_filing_date::DATE, p_citing."filing_date"::DATE) AS days_diff
    FROM citations c
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p_citing
        ON c.citing_pub_num = p_citing."publication_number"
)

SELECT 
    original_pub_num,
    original_filing_date,
    COUNT(*) AS citation_count_within_one_month
FROM citing_filings
WHERE days_diff BETWEEN 0 AND 30
GROUP BY original_pub_num, original_filing_date
ORDER BY citation_count_within_one_month DESC
LIMIT 1;
```

**Note:**

- This query assumes that the `filing_date` fields are valid dates and can be cast to `DATE` type.
- The `DATEDIFF` function calculates the number of days between the original and citing filing dates.
- Replace `DATEDIFF('day', c.original_filing_date::DATE, p_citing."filing_date"::DATE)` with appropriate date arithmetic if necessary.

**Finding the Most Similar Patent:**

After identifying the patent with the most forward citations (`original_pub_num`), you can find the most similar patent filed in the same year:

```sql
WITH original_embedding AS (
    SELECT 
        p."publication_number", 
        p."filing_date", 
        a."embedding_v1"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
        ON p."publication_number" = a."publication_number"
    WHERE p."publication_number" = 'original_pub_num'  -- Replace with actual publication number
),

same_year_patents AS (
    SELECT 
        p."publication_number", 
        p."filing_date", 
        a."embedding_v1"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
        ON p."publication_number" = a."publication_number"
    WHERE YEAR(p."filing_date") = YEAR((SELECT "filing_date" FROM original_embedding))
      AND p."publication_number" != 'original_pub_num'
),

similarities AS (
    SELECT 
        syp."publication_number",
        -- Compute the dot product or cosine similarity between embeddings
        -- This is a placeholder as actual computation may require UDFs or additional processing
        DOT_PRODUCT(
            ARRAY_CONSTRUCT_FROM_TEXT((SELECT "embedding_v1" FROM original_embedding)),
            ARRAY_CONSTRUCT_FROM_TEXT(syp."embedding_v1")
        ) AS similarity_score
    FROM same_year_patents syp
)

SELECT 
    "publication_number" AS most_similar_publication_number,
    similarity_score
FROM similarities
ORDER BY similarity_score DESC
LIMIT 1;
```

**Important:**

- Computing the similarity between embeddings may require parsing the `embedding_v1` array and implementing a function to compute the dot product or cosine similarity. This might involve creating a User-Defined Function (UDF) in Snowflake.
- Ensure that the `embedding_v1` arrays are properly parsed and converted to a format suitable for mathematical operations.

**Final Output:**

Following your specified format, the final result would be:

```csv
publication_number,most_similar_publication_number,similarity
US-XXXXXXX-B2,US-YYYYYYY-**,similarity_value(Attention: answer in one row)
```

- Replace `US-XXXXXXX-B2` with the publication number of the patent with the most forward citations within a month of its filing date.
- Replace `US-YYYYYYY-**` with the publication number of the most similar patent from the same filing year.
- Replace `similarity_value` with the computed similarity score.

**Summary:**

- The error in your original SQL query is due to the unsupported `ON` clause with `LEFT JOIN LATERAL` in Snowflake.
- By adjusting the query to remove the `ON TRUE` clause or by using alternative methods like `ARRAY_SIZE` or subqueries, you can achieve the desired results without errors.
- For the original task, you need to perform additional steps to filter and process the data, and computing similarities might require advanced functions or processing.
2025-01-20 06:02:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:02:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:02:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:02:09 - snowflake.connector.connection - INFO - closed
2025-01-20 06:02:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:02:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:02:55 - root - INFO - The error message you're encountering:

```
Function EXTRACT does not support NUMBER(38,0) argument type
```

indicates that a date or time function is being applied to a column of type `NUMBER(38,0)`, which represents a numeric value rather than a date or timestamp. In your query, this issue arises because the `"filing_date"` column in the `PUBLICATIONS` table and potentially the `"filing_date"` within the `cited_by` field are stored as numbers in the format `YYYYMMDD`.

To resolve this error, you need to convert these numeric date fields to actual `DATE` data types before applying any date functions or aggregations. Here's how you can modify your query:

1. **Convert Numeric Dates to DATE Data Type:**

   Use the `TO_DATE` function to convert the numeric date fields to `DATE`:

   ```sql
   TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date
   ```

   Do the same for any other numeric date fields, such as `"grant_date"` or `"filing_date"` within the `cited_by` entries.

2. **Modify Your Query:**

   Here's the corrected query with the necessary conversions:

   ```sql
   SELECT 
       p."publication_number", 
       TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
       COUNT(f.value) AS "forward_citation_count" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
       ON p."publication_number" = a."publication_number" 
   LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
   GROUP BY p."publication_number", "filing_date"
   LIMIT 1000;
   ```

   **Note:** In the `GROUP BY` clause, ensure you're referencing the alias `"filing_date"` after conversion.

3. **Explanation:**

   - **Converting Filing Date:**
     
     By converting `p."filing_date"` from a `NUMBER` to a `DATE`, you're allowing any date functions or aggregations to operate correctly. The `TO_DATE` function converts a string into a date based on the specified format `'YYYYMMDD'`.

   - **No Need for `ON TRUE` Clause:**
     
     As previously mentioned, the `LEFT JOIN LATERAL` does not support an `ON` clause in Snowflake, so it should be removed.

4. **Additional Conversion for Cited By Entries:**

   If you need to work with the `"filing_date"` from the `cited_by` entries, you must also convert it accordingly. Here's how you can include it:

   ```sql
   SELECT 
       p."publication_number", 
       TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
       COUNT(f.value) AS "forward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
       ON p."publication_number" = a."publication_number" 
   LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
   LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p_citing
       ON f.value:"publication_number"::STRING = p_citing."publication_number"
   GROUP BY p."publication_number", "filing_date"
   LIMIT 1000;
   ```

   Then, if you need to calculate differences between dates, ensure all date fields are converted:

   ```sql
   TO_DATE(p_citing."filing_date"::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
   ```

5. **Example with Date Difference Calculation:**

   If your goal is to count forward citations within one month of the filing date, you can expand the query as follows:

   ```sql
   SELECT 
       p."publication_number", 
       TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date",
       COUNT(f.value) AS "forward_citation_count_within_one_month"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
       ON p."publication_number" = a."publication_number" 
   LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
   LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p_citing
       ON f.value:"publication_number"::STRING = p_citing."publication_number"
   WHERE TO_DATE(p_citing."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN 
         TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AND 
         DATEADD('month', 1, TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'))
   GROUP BY p."publication_number", "filing_date"
   ORDER BY "forward_citation_count_within_one_month" DESC
   LIMIT 1000;
   ```

   **Explanation:**

   - **Conversion of Citing Filing Date:**
     
     Converting `p_citing."filing_date"` allows for accurate date comparisons.

   - **Date Range Filtering:**
     
     The `WHERE` clause filters citations to those filed within one month after the original patent's filing date.

6. **Ensure Consistent Data Types:**

   Always ensure that any date or time functions are applied to columns of type `DATE` or `TIMESTAMP`. Converting numeric date representations to proper `DATE` types prevents errors and ensures correct calculations.

7. **Summary:**

   - Convert numeric date fields to `DATE` data types using `TO_DATE`.
   - Remove unsupported clauses such as `ON TRUE` with `LEFT JOIN LATERAL`.
   - Ensure all date functions and comparisons are performed on `DATE`-typed columns.

**Final Remarks:**

By adjusting your query to include these conversions, you should resolve the error and successfully execute your query to retrieve the desired results.
2025-01-20 06:02:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:02:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:02:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:02:56 - snowflake.connector.connection - INFO - closed
2025-01-20 06:02:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:03:39 - root - INFO - The error message:

```
SQL compilation error:
ambiguous column name 'filing_date'
```

occurs because the column name `"filing_date"` is ambiguous in your query. This means that the SQL parser finds more than one column named `"filing_date"` in your query and cannot determine which one you are referring to.

Here's why this happens:

1. **Multiple Columns Named `filing_date`**: Both the `PUBLICATIONS` table (aliased as `p`) and possibly other elements in your query (such as an alias in the `SELECT` clause) have a column named `"filing_date"`.

2. **Column Aliases in `SELECT` Clause**: If you have aliased a column in your `SELECT` clause using the same name (`"filing_date"`), it can cause ambiguity when that name is used elsewhere in the query, such as in the `GROUP BY` clause.

3. **Use of Unqualified Column Names**: If you refer to `"filing_date"` without specifying the table alias, the SQL parser cannot determine which `"filing_date"` you mean.

To fix this issue, you should:

- **Fully Qualify Column Names**: Always use table aliases when referring to columns that might be ambiguous.

- **Use Unique Aliases for Calculated Columns**: When you create a new column in the `SELECT` clause (like converting the date), give it a unique alias that doesn't conflict with existing column names.

- **Reference Columns Properly in `GROUP BY`**: Remember that you cannot use column aliases defined in the `SELECT` clause within the `GROUP BY` clause by their alias names, unless they are simple column references.

**Revised Query:**

Heres how you can modify your query to resolve the ambiguity:

```sql
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    COUNT(f.value) AS "forward_citation_count" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
GROUP BY p."publication_number", "filing_date_converted"
LIMIT 1000;
```

**Explanation:**

- **Convert and Alias `filing_date`**: Convert the numeric `"filing_date"` to a `DATE` type and alias it as `"filing_date_converted"`. This new alias distinguishes it from the original `"filing_date"` column.

  ```sql
  TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted"
  ```

- **Use the Alias in `GROUP BY`**: In the `GROUP BY` clause, reference the new alias `"filing_date_converted"` instead of the ambiguous `"filing_date"`.

  ```sql
  GROUP BY p."publication_number", "filing_date_converted"
  ```

- **Ensure All Column References Are Qualified**: Verify that all other references to `"filing_date"` in your query are fully qualified with their table aliases.

**Additional Notes:**

- **Column Aliases in `GROUP BY`**: In SQL, you can use column aliases defined in the `SELECT` clause in the `GROUP BY` clause if they are simple expressions or calculations. Aliased expressions can be used directly in `GROUP BY`.

- **Avoid Ambiguity**: By aliasing the converted date as `"filing_date_converted"`, you eliminate ambiguity between the original `"filing_date"` column and the converted date.

**Summary:**

The error arises because the SQL parser cannot determine which `"filing_date"` column you are referring to in your query. By carefully aliasing your columns and ensuring that all references are unambiguous, you can resolve the error and execute your query successfully.

**Revised Query Without Ambiguity:**

```sql
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    COUNT(f.value) AS "forward_citation_count" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
GROUP BY p."publication_number", "filing_date_converted"
LIMIT 1000;
```

By making these changes, your query should run without the ambiguous column name error.
2025-01-20 06:03:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:46 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:46 - root - INFO - SQL:
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    COUNT(f.value) AS "forward_citation_count" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
GROUP BY p."publication_number", "filing_date_converted"
LIMIT 1000;
Results:
100097 (22007): 01b9d4eb-0004-7b17-0001-11c300f0746e: Can't parse '0' as date with format 'YYYYMMDD'
2025-01-20 06:03:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:03:48 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:48 - root - INFO - SQL:
SELECT "publication_number", "country", "publication_description" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
    LIMIT 1000;
Results:
Too long, hard cut:
publication_number,country,publication_description
CA-27-A,CANADA,Patent
ES-81-Y,SPAIN,Utility model
DE-303-C,FEDERAL REPUBLIC GERMANY,Patent
ES-866-Y,SPAIN,Utility model
FI-150-A,FINLAND,Unexamined applic. Open to public Inspect
FI-250-A,FINLAND,Unexamined applic. Open to public Inspect
FR-336-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
NL-284-C,NETHERLANDS,Patent (third level of publication)
NL-947-C,NETHERLANDS,Patent (third level of publication)
BE-107-T1,BELGIUM,Patent of invention from EP in French [grant]
CA-1911-A,CANADA,Patent
CA-4005-A,CANADA,Patent
CA-4106-A,CANADA,Patent
CA-4698-A,CANADA,Patent
CA-4801-A,CANADA,Patent
CA-5943-A,CANADA,Patent
CA-6183-A,CANADA,Patent
CA-6207-A,CANADA,Patent
CA-6390-A,CANADA,Patent
CA-6969-A,CANADA,Patent
CA-8931-S,CANADA,Registered design
CA-9897-A,CANADA,Patent
DE-3129-C,FEDERAL REPUBLIC GERMANY,Patent
DE-3301-C,FEDERAL REPUBLIC GERMANY,Patent
DE-3884-C,FEDERAL REPUBLIC GERMANY,Patent
DE-3983-C,FEDERAL REPUBLIC GERMANY,Patent
DE-5976-C,FEDERAL REPUBLIC GERMANY,Patent
DK-2807-C,DENMARK,"Granted patent, first level"
DK-3080-C,DENMARK,"Granted patent, first level"
DK-3107-C,DENMARK,"Granted patent, first level"
DK-3184-C,DENMARK,"Granted patent, first level"
DK-3510-C,DENMARK,"Granted patent, first level"
DK-5867-C,DENMARK,"Granted patent, first level"
DK-5921-C,DENMARK,"Granted patent, first level"
DK-6491-A,DENMARK,"Patent application made available to the public, first level "
DK-7210-C,DENMARK,"Granted patent, first level"
DK-8069-C,DENMARK,"Granted patent, first level"
DK-8466-C,DENMARK,"Granted patent, first level"
DK-9281-C,DENMARK,"Granted patent, first level"
DK-9359-C,DENMARK,"Granted patent, first level"
ES-1062-U,SPAIN,Utility model application
ES-1498-U,SPAIN,Utility model application
ES-1524-Y,SPAIN,Utility model
ES-1872-U,SPAIN,Utility model application
ES-2542-Y,SPAIN,Utility model
ES-2819-Y,SPAIN,Utility model
ES-2960-U,SPAIN,Utility model application
ES-3045-U,SPAIN,Utility model application
ES-4483-Y,SPAIN,Utility model
ES-4723-Y,SPAIN,Utility model
ES-4858-U,SPAIN,Utility model application
ES-5089-Y,SPAIN,Utility model
ES-5219-Y,SPAIN,Utility model
ES-5716-U,SPAIN,Utility model application
ES-5975-Y,SPAIN,Utility model
ES-6454-U,SPAIN,Utility model application
ES-6552-Y,SPAIN,Utility model
ES-6928-Y,SPAIN,Utility model
ES-6962-Y,SPAIN,Utility model
ES-7086-Y,SPAIN,Utility model
ES-7407-Y,SPAIN,Utility model
ES-7489-Y,SPAIN,Utility model
ES-7516-U,SPAIN,Utility model application
ES-7538-U,SPAIN,Utility model application
ES-764-H3,SPAIN,Privilege of importation
ES-8269-Y,SPAIN,Utility model
FI-1825-A,FINLAND,Unexamined applic. Open to public Inspect
FI-291-U1,FINLAND,Granted utility model 
FI-3021-A,FINLAND,Unexamined applic. Open to public Inspect
FI-4211-A,FINLAND,Unexamined applic. Open to public Inspect
FI-4543-A,FINLAND,Unexamined applic. Open to public Inspect
FI-8034-A,FINLAND,Unexamined applic. Open to public Inspect
FI-8619-A,FINLAND,Unexamined applic. Open to public Inspect
FI-8985-A,FINLAND,Unexamined applic. Open to public Inspect
FI-902-U1,FINLAND,Granted utility model 
FR-1186-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-1382-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-1550-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-2064-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-2510-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-2578-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-2635-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-3293-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-5174-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-5770-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-7085-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-7747-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-8053-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-8143-M,FRANCE,Special patent for medicament ( Fisrt publication)
NL-3613-C,NETHERLANDS,Patent (third level of publication)
NL-4187-C,NETHERLANDS,Patent (third level of publication)
NL-5034-C,NETHERLANDS,Patent (third level of publication)
NL-9752-C,NETHERLANDS,Patent (third level of publication)
NL-9761-C,NETHERLANDS,Patent (third level of publication)
RU-815-U1,RUSSIAN FEDERATION,Certificate for utility model
US-1260-A,USA,Patent
US-1844-A,USA,Patent
US-3704-A,USA,Patent
US-4174-P,USA,Plant patent
US-4340-A,USA,Patent
US-4449-P,USA,Plant patent
US-4570-P,USA,Plant patent
US-5293-P,USA,Plant patent
US-5333-A,USA,Patent
US-5618-A,USA,Patent
US-6399-A,USA,Patent
US-6501-P,USA,Plant patent
US-7090-A,USA,Patent
US-7624-A,USA,Patent
US-7703-P,USA,Plant patent
US-7765-P,USA,Plant patent
US-8162-P,USA,Plant patent
US-8923-P,USA,Plant patent
U

2025-01-20 06:03:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:49 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:04:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:04:42 - root - INFO - The error you're encountering:

```
SQL compilation error: error line 8 at position 35
invalid identifier 'SPECIFIC_YEAR_START'
```

is due to the use of placeholders `[specific_year_start]` and `[specific_year_end]` in your SQL query. SQL does not recognize these placeholders as valid identifiers. Instead, you need to replace them with actual date values.

Here's how you can fix the error:

**1. Replace Placeholders with Actual Date Values**

If you have specific dates in mind, replace `[specific_year_start]` and `[specific_year_end]` with actual dates in the format your database expects. For example, if you're interested in patents filed in the year 2012, you can write:

```sql
SELECT 
    p."publication_number", 
    p."filing_date", 
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
WHERE p."filing_date" BETWEEN 20120101 AND 20121231
LIMIT 1000;
```

**2. Convert Numeric Dates to DATE Data Type**

Since `filing_date` is stored as a numeric value in the format `YYYYMMDD`, it's often helpful to convert it to a `DATE` data type for date operations:

```sql
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
WHERE TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN TO_DATE('20120101', 'YYYYMMDD') AND TO_DATE('20121231', 'YYYYMMDD')
LIMIT 1000;
```

**3. Extract the Filing Year Dynamically**

If you need to select patents filed in the same year as a specific patent, you can first extract the filing year of that patent and then use it in your query:

```sql
-- Replace 'SPECIFIC_PUBLICATION_NUMBER' with the actual publication number of the patent
WITH specific_patent_year AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    WHERE p."publication_number" = 'SPECIFIC_PUBLICATION_NUMBER'
)
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
WHERE EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year" FROM specific_patent_year)
LIMIT 1000;
```

**4. Ensure Date Formats Match**

Make sure that date formats in your `TO_DATE` functions match the format of your date strings. If `filing_date` is stored as a number like `20120115` (for January 15, 2012), you should use `'YYYYMMDD'` as the format string.

**Summary:**

- **Invalid Identifiers:** Placeholders in square brackets (e.g., `[specific_year_start]`) are not valid in SQL and need to be replaced with actual values.
- **Date Conversion:** Convert numeric date fields to `DATE` data types using `TO_DATE` to perform date comparisons or extractions.
- **Extracting Year:** Use the `EXTRACT` function to get the filing year from the date.
- **Variable Replacement:** If you need to use variables, define them before your query or use a programming language to substitute them into your query.

**Example with Fixed Dates:**

```sql
-- Selecting patents filed in 2012
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
WHERE EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = 2012
LIMIT 1000;
```

**Note:** Always ensure that your date formats and data types are consistent throughout your query to avoid errors.

**I hope this helps you resolve the error and successfully execute your query. If you have any more questions or need further assistance, feel free to ask!**
2025-01-20 06:04:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:04:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:04:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:04:43 - snowflake.connector.connection - INFO - closed
2025-01-20 06:04:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:05:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:05:46 - root - INFO - The error message you're encountering:

```
100097 (22007): ... Can't parse '0' as date with format 'YYYYMMDD'
```

indicates that the SQL engine is attempting to convert a value of `'0'` in the `"filing_date"` column into a date using the format `'YYYYMMDD'`, but `'0'` is not a valid date in that format.

**Explanation of the Issue:**

- **Invalid Filing Dates:** In your `PUBLICATIONS` table, some records have a `"filing_date"` value of `0` or possibly other invalid values that cannot be parsed as dates.
- **Date Conversion Failure:** When you use `TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')`, the SQL engine tries to convert every `"filing_date"` value into a date. If it encounters an invalid value like `'0'`, it throws an error because `'0'` doesn't match the `'YYYYMMDD'` date format.

**Solution:**

To resolve this error, you need to handle records with invalid `"filing_date"` values. You can do this by:

1. **Excluding Records with Invalid Dates:** Filter out records where `"filing_date"` is `0` or not in the expected format before attempting to convert them to dates.
2. **Using `TRY_TO_DATE()` Function:** Use `TRY_TO_DATE()` instead of `TO_DATE()`. This function attempts to convert a string to a date and returns `NULL` if it fails, preventing the error.

**Revised Query:**

Here's how you can modify your query to handle the issue:

```sql
SELECT 
    p."publication_number", 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
WHERE TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
  AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN TO_DATE('20120101', 'YYYYMMDD') AND TO_DATE('20121231', 'YYYYMMDD')
LIMIT 1000;
```

**Key Changes and Explanations:**

1. **Use `TRY_TO_DATE()`:**
   - Replaced `TO_DATE()` with `TRY_TO_DATE()`. This function attempts to parse the date and returns `NULL` if it fails, instead of throwing an error.
   - Syntax: `TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted"`
   
2. **Filter Out `NULL` Dates:**
   - Added a condition in the `WHERE` clause to exclude records where the date conversion failed:
     ```sql
     WHERE TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
     ```
     
3. **Date Range Filtering:**
   - Applied the date range condition using the converted date:
     ```sql
     AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN TO_DATE('20120101', 'YYYYMMDD') AND TO_DATE('20121231', 'YYYYMMDD')
     ```
   - Replace `'20120101'` and `'20121231'` with the actual start and end dates for your specific year range.

**Alternative Option: Exclude Records Where `filing_date` is `0`:**

If you know that the invalid dates are specifically `0`, you can exclude them directly:

```sql
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
WHERE p."filing_date" != 0
  AND TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN TO_DATE('20120101', 'YYYYMMDD') AND TO_DATE('20121231', 'YYYYMMDD')
LIMIT 1000;
```

**Handling Placeholders `[specific_year_start]` and `[specific_year_end]`:**

- Replace `[specific_year_start]` and `[specific_year_end]` with actual date strings in `'YYYYMMDD'` format.
  - For example, for the year 2012:
    - `TO_DATE('20120101', 'YYYYMMDD')` for January 1, 2012.
    - `TO_DATE('20121231', 'YYYYMMDD')` for December 31, 2012.

**Example Query with Actual Dates:**

Suppose you want to select patents filed in the year **2012**:

```sql
SELECT 
    p."publication_number", 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
WHERE TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
  AND EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = 2012
LIMIT 1000;
```

**Summary:**

- **Issue:** The error occurs because of invalid date values (`'0'`) in the `"filing_date"` column.
- **Solution:** Use `TRY_TO_DATE()` to safely attempt date conversion and exclude `NULL` results.
- **Action Steps:**
  - Modify your query to use `TRY_TO_DATE()`.
  - Filter out records where date conversion fails.
  - Replace placeholders with actual dates.
  
**Additional Tips:**

- **Check for Other Invalid Dates:** If there are other invalid date values besides `'0'`, using `TRY_TO_DATE()` is safer as it catches any unparsable values.
- **Data Cleansing:** If possible, consider cleaning the data to handle invalid date entries, ensuring that all date values are valid or appropriately marked as missing.

---

I hope this helps you resolve the error and successfully execute your query. Let me know if you need further assistance!
2025-01-20 06:05:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:05:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:05:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:05:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 71
2025-01-20 06:05:49 - snowflake.connector.connection - INFO - closed
2025-01-20 06:05:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:06:40 - root - INFO - SQL:
SELECT 
    p."publication_number", 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
WHERE TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
  AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN TO_DATE('20120101', 'YYYYMMDD') AND TO_DATE('20121231', 'YYYYMMDD')
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,filing_date_converted,embedding_v1
US-8976583-B2,2012-09-06,"[
  -1.059306560000000e-01,
  -1.262364500000000e-01,
  -1.222046000000000e-01,
  -5.713473000000000e-03,
  -3.112821600000000e-01,
  -9.113502499999999e-02,
  1.252987000000000e-01,
  -1.311189100000000e-01,
  5.866532400000000e-02,
  -1.042737960000000e-01,
  -9.591958500000001e-03,
  1.277630800000000e-01,
  -5.473983000000000e-03,
  4.258953800000000e-02,
  -1.794493600000000e-01,
  -6.368514000000000e-02,
  2.016306200000000e-01,
  -9.080313000000000e-03,
  -1.207415400000000e-01,
  9.736188000000000e-02,
  2.105227400000000e-01,
  -6.499009000000000e-02,
  -1.577425300000000e-01,
  -5.875627700000000e-02,
  4.438163000000000e-02,
  -6.790697000000000e-02,
  2.805841300000000e-01,
  4.398754000000000e-02,
  7.193668000000000e-02,
  5.187504000000000e-02,
  -6.012163300000000e-02,
  -7.575588000000000e-02,
  4.254520700000000e-02,
  2.264518100000000e-02,
  -1.813370900000000e-01,
  -1.035830500000000e-01,
  1.200569900000000e-01,
  -2.413551400000000e-01,
  3.464020800000000e-02,
  2.453696400000000e-02,
  4.662365000000000e-02,
  -8.345770000000000e-02,
  3.225671000000000e-01,
  -7.194141000000000e-02,
  -1.982019700000000e-01,
  -6.159182600000000e-02,
  -1.336521800000000e-01,
  2.218222800000000e-01,
  1.134497300000000e-01,
  4.595112400000000e-02,
  -6.320264000000000e-02,
  9.381630000000001e-02,
  -1.904578100000000e-02,
  1.447700100000000e-01,
  6.917448000000000e-02,
  4.715478400000000e-02,
  6.647333499999999e-02,
  8.223928000000000e-03,
  -1.777091800000000e-01,
  2.004187900000000e-01,
  -4.368481000000000e-02,
  5.694804300000000e-02,
  1.655298300000000e-02,
  1.346571600000000e-01
]"
US-9128520-B2,2012-03-30,"[
  1.227834200000000e-01,
  -2.426595200000000e-01,
  1.407350000000000e-02,
  -2.969862100000000e-02,
  -1.245159500000000e-01,
  -6.332870600000000e-02,
  1.743330500000000e-01,
  3.009014800000000e-03,
  -2.149020900000000e-02,
  -8.626582500000000e-02,
  -1.139349700000000e-01,
  1.567300300000000e-01,
  1.731329600000000e-01,
  -1.227776260000000e-01,
  2.332043800000000e-03,
  1.982767400000000e-01,
  8.593608400000000e-02,
  3.854343300000000e-02,
  8.584078400000000e-02,
  1.287092300000000e-01,
  2.332509600000000e-01,
  1.956272900000000e-01,
  -1.039483700000000e-01,
  1.385736900000000e-01,
  1.535393300000000e-02,
  1.597823000000000e-02,
  2.255859700000000e-01,
  1.722682400000000e-01,
  2.410831900000000e-01,
  4.360464000000000e-02,
  1.923091000000000e-01,
  9.115708600000000e-02,
  -3.588060000000000e-02,
  1.874331200000000e-02,
  -1.539471900000000e-01,
  -1.922122200000000e-01,
  1.448280500000000e-01,
  -2.016079300000000e-01,
  -1.188004900000000e-01,
  4.086014000000000e-02,
  -1.526096500000000e-02,
  -7.925937000000000e-02,
  1.119586600000000e-01,
  1.437844600000000e-01,
  3.327048000000000e-02,
  -6.261936600000000e-02,
  2.153731400000000e-03,
  -1.443680500000000e-01,
  -2.487351600000000e-02,
  -1.389095800000000e-01,
  -9.440161000000000e-02,
  -1.634257000000000e-01,
  -3.107209300000000e-02,
  8.936854499999999e-02,
  -1.729532200000000e-01,
  1.060924800000000e-02,
  3.789154000000000e-02,
  7.221468000000000e-02,
  -1.170248500000000e-01,
  1.561160900000000e-02,
  -1.548781400000000e-02,
  2.585560700000000e-01,
  -9.488660000000000e-02,
  8.297217000000000e-02
]"
CN-102554192-A,2012-01-11,"[
  9.729161000000000e-02,
  -6.921700000000000e-02,
  1.321549000000000e-01,
  -5.172685500000000e-02,
  -8.973230400000000e-02,
  4.841761700000000e-02,
  -2.031060000000000e-02,
  2.436021500000000e-02,
  1.345232900000000e-01,
  7.950996600000000e-02,
  2.134805200000000e-01,
  -3.715940000000000e-02,
  7.307076999999999e-02,
  1.692644000000000e-01,
  -1.649943600000000e-01,
  -5.144033200000000e-02,
  4.260391700000000e-02,
  2.592668900000000e-02,
  5.061075000000000e-02,
  6.859679500000000e-02,
  -9.576303000000000e-02,
  3.218616000000000e-02,
  -1.945237700000000e-01,
  6.599735499999999e-02,
  -6.393476400000000e-03,
  -1.391660100000000e-01,
  1.489451000000000e-01,
  -4.562806000000000e-02,
  -3.905249800000000e-02,
  -8.654120600000000e-02,
  6.924638000000000e-02,
  1.509529000000000e-01,
  4.277788500000000e-02,
  -1.320579000000000e-01,
  1.402084700000000e-01,
  -2.132544700000000e-01,
  -1.303522400000000e-01,
  -1.163601350000000e-01,
  -7.662843000000000e-02,
  5.896943800000000e-02,
  -1.919887600000000e-02,
  -1.426459700000000e-01,
  7.312961000000000e-02,
  -1.889067700000000e-02,
  -1.253868800000000e-01,
  1.339132800000000e-01,
  1.435031400000000e-01,
  1.025413300000000e-01,
  -1.605322700000000e-01,
  -2.127045200000000e-01,
  -4.517932200000000e-01,
  3.785774500000000e-02,
  -4.968652500000000e-02,
  3.466812000000000e-03,
  1.520178600000000e-01,
  -1.054720400000000e-01,
  -1.557718200000000e-01,
  3.055583900000000e-02,
  1.057283200000000e-01,
  9.590116000000000e-02,
  4.408434400000000e-02,
  2.355160600000000e-01,
  -6.13968200000000

2025-01-20 06:06:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:06:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:06:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:06:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:06:42 - snowflake.connector.connection - INFO - closed
2025-01-20 06:06:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:42 - root - INFO - SQL:
-- Corrected SQL for Query 1:
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
     LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000
Results:
Too long, hard cut:
cpc_code
H04L5/001
H04L47/11
H04L47/10
G06F9/5038
G06F11/30
H01L2924/19041
B62D21/00
C07K16/32
E03D3/12
E04B1/24
F02F1/4214
E05C9/08
H04L2012/5616
G01N2021/8864
Y10S707/99934
G06F2201/86
B41J2202/21
H02H3/025
F02C7/05
D06F95/006
B61D7/20
Y10T137/87475
F02F1/242
H03H9/14505
B65D43/0212
C03C17/3649
C07D409/12
H05K2201/0209
C10G21/20
Y02B70/16
A01K5/0114
H01Q13/10
G01S3/8083
G06F12/1441
B01J20/08
B01J20/041
E21B41/005
A63B2071/024
G01S7/521
G06F11/348
C25D17/06
H05K2203/0207
A01N59/12
E21B10/20
H05K1/0243
G12B11/02
H02M3/33523
E21B10/22
B60W2520/10
H04N1/00612
H04M2250/02
C09K8/032
E21B37/04
G01D5/2497
A61L27/3641
H04B2203/5466
C09B44/101
H01F7/123
H04L1/1854
H01L29/42372
G01R22/066
H04L12/5885
H03L7/0814
G11C2029/5002
A61C5/70
H01L29/66666
H01L29/0649
Y10T428/24818
B23Q11/0042
F16H57/0478
A61B5/022
E04F15/105
B24D11/02
G11C11/5621
G06F2221/0737
B41J13/106
H01L51/0095
H01L51/006
H04N21/235
E06B2009/2622
B29C65/18
Y02W30/526
Y10S521/902
H01L29/42324
H04L1/0009
C11D3/10
B28B11/046
A23K50/15
H05B7/005
H05B2213/02
A01C7/20
B23K9/038
C07D213/12
C10M3/00
C10M2215/066
B60N2/449
H03F1/542
D06M7/00
B63H3/082
B65G19/22
H01J7/18
C10M2227/062
Y10S165/524
G02B6/3882
C08G2/16
C08B11/00
B67D9/02
C10M2219/022
C05C5/005
A61F13/266
B27K3/52
G01F3/36
F16C32/06
A01M7/0092
Y02W30/648
Y10T70/7881
B08B9/0936
B41B27/04
H01J25/10
Y10S505/702
A61F2002/30604
A61F2/44
B01D39/14
B29C55/00
H01J29/80
H04L5/12
B29C45/2737
C07C45/28
B01J2/00
F16D65/092
H01L2224/4569
H03M3/474
C23C14/06
G06F17/30247
Y02T10/44
H01M4/626
A63F13/80
B22F2003/185
H04L5/0035
H03H5/006
G01R31/2608
F02P5/1502
C09B67/00
B65G1/0435
B01J35/10
B23K2201/125
Y10S264/48
H01L21/28194
H04N21/4331
A61B2018/00886
H01L33/22
E04B2/46
B60N2/44
Y10S366/605
B31B2100/00
C11D1/65
C07D487/06
H04Q11/04
G02B6/3893
H04N1/41
A47L11/33
C07D213/82
H04N9/12
A61C3/06
G05D1/0883
H04N9/68
G01N15/1468
H01F41/041
C08K5/0066
H04N19/152
H04N1/64
H04M2250/12
Y02E20/12
G05D16/0683
Y10T137/7794
A63B2053/0491
Y10T70/5004
A23K20/00
Y10S514/908
G01N21/3563
B65G2201/0205
A01N65/44
C07D333/66
H04N1/00137
B65H59/28
F04B27/1054
B42C19/02
H01L31/02366
A61M1/1031
Y10T428/265
F23D14/78
C12N15/70
B42D2033/32
F01N3/2892
H01M10/6568
F24F2011/0063
B42P2261/04
G01F15/066
G10K2210/112
Y10T428/30
B42D25/455
B25J13/003
F15B13/0403
Y10S423/14
G03G15/087
F21V15/01
Y10T483/115
C08G59/245
Y02T10/7275
B60L2240/421
G06F9/5016
B60L11/1892
H04R2225/43
G06F9/542
Y02P20/124
Y02T50/62
Y02W10/18
B60B33/00
B60B37/10
B05B1/3046
Y02P10/265
H04L2209/08
H02K35/00
C08J2367/02
H04W72/042
A23C9/1512
A23V2002/00
Y10T156/13
C12M47/06
B21B1/463
C07C67/52
A63B2022/0094
A63B21/008
Y02P30/20
C07C37/08
B60R19/48
Y02T90/125
B60R16/03
E05B81/54
A61K9/1617
B23B2270/54
A61C17/02
C10M2207/289
C01P2004/61
H01L24/10
B62D55/30
C08J2207/04
A61F13/15747
H04L5/0055
A61M2207/00
A63B2220/40
E05B85/02
G05B2219/21119
G02B27/0994
B24D5/14
A61F2/1654
C02F1/26
A61C13/0004
H02G15/184
E04B2/7438
B22F3/105
A63B51/02
B23Q1/28
G11B7/08505
A61K8/0229
A61F2/0811
A61F2310/00299
B29C2045/2783
G01S13/70
C02F1/001
B29C65/564
F23D2700/033
F23D5/18
B01J2219/00554
C07D401/06
E06B9/68
C08F4/61912
C04B14/38
G11B21/083
B01J35/1047
H04W48/14
H02M7/08
A61F2310/00023
F05C2225/00
Y10T156/1095
B60Q1/085
A61F2002/30883
A47K3/40
E04C2/36
A61Q19/002
C07K1/047
Y10T428/162
G03G7/004
B29C43/46
B29C55/30
B65D83/228
D03D47/34
H02K49/046
B29C65/203
B60N2/3011
H04N1/4058
C22C14/00
B01J23/96
C07D211/46
C07K1/023
G11C16/32
B65G17/345
A01C17/008
D06F58/10
D04B35/02
B29L2030/007
H02K11/21
B60G15/068
C04B2111/00284
G03G15/0921
D21F5/021
F16F15/161
G01S1/026
C07C59/265
A61F13/476
C07K14/4726
G11C8/18
C23C28/42
F16D2065/785
G01C21/20
B27B27/08
G03G2221/1657
H04N5/4448
G11C11/161
H04W4/16
G05B19/41875
A01K2217/05
C10M2215/082
H04B7/12
B65G23/22
C07D473/00
G01L7/00
H01L23/49
H01L23/3735
A61B6/08
A61B6/547
A61B5/0555
G01S7/4816
A01K63/003
B42D1/007
F01L2009/0436
B62J17/08
C01B33/18
F02M39/02
F16H2059/467
B01D53/323
C08J2309/00
Y10T407/191
A61G2210/50
G06F1/185
H05B2203/011
B60Q3/44
G06F12/0888
B60Q9/007
G09G5/00
B62D35/008
C07C213/10
H01J2235/18
F17C2223/036
H02B5/00
B42D15/08
B01J2540/32
B01J35/002
A44C21/00
F41A19/47
B63H23/321
B24B53/14
E04G1/15
B32B27/36
F04B9/1115
A61M39/221
B01J2219/32483
G01S17/32
G09F1/10
H05B3/16
C08L2205/16
C09K2200/065
B60J10/15
Y02B70/3241
H05K1/0228
F21V7/005
C07C229/62
H04L67/14
C12N2501/23
C12N2501/22
F25B9/02
C04B2103/46
C08F290/062
B01J20/3204
G06K9/6878
A61K8/0241
C02F3/20
H01M4/0404
B65H63/082
G03F7/70258
B29C51/46
Y10T477/623
G01N21/51
B23K35/40
A61D3/00
B41F23/08
H04W28/14
C08F8/42
G09G2310/0237
G02B26/008
G09F3/0335
C07C15/38
G02F2001/136295
H01L2221/1089
A47F5/0037
A61K2236/33
H01L29/78606
G06F17/30
H01M8/04216
C03C2218/328
C07K14/43595
A61K47/56
G06K19/083
G06K19/18
H04L63/126
C04B35/119
H04L12/40045
H04L29/12396
C22F1/10
A01N25/26
C04B35/63416
Y10S422/90
C12R1/01
A61B18/1233
A61N1/36017
C08F2800/10
C23C2/006
D06M23/08
A61H2201/1621
Y10T428/249958
C01B11/023
G11B20/10527
F02M35/09
A63H11/00
G01C25/00
A61F2002/30158
B01D71/48
F02D41/0055
F16L19/075
C07F3/02
C09J7/028

2025-01-20 06:06:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:06:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:06:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:06:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:06:44 - snowflake.connector.connection - INFO - closed
2025-01-20 06:06:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:45 - root - INFO - SQL:
-- Corrected SQL for Query 2 (no changes needed):
SELECT "publication_number", "title", "abstract"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,title,abstract
CA-27-A,Improvement on spinning wheel,
ES-81-Y,Improvements heels for footwear.,
DE-303-C,,
ES-866-Y,Improvements gravestones tombs and funerary niches.,
FI-150-A,"The monitor method for preparing dubbelugnar for the preparation af tjra, lysolja, terpentin mm.  ur furustubbar Science Notter",
FI-250-A,Sjelflggningsapparat to the skrdemaskiner,
FR-336-E,Improvements in the processing of cotton and cotton goods to make them nonflammable,
NL-284-C,,
NL-947-C,,
BE-107-T1,Bouches fire.,
CA-1911-A,A ralway track clearer,
CA-4005-A,Leather scouring machine,
CA-4106-A,Automatic car-coupling,
CA-4698-A,Ladies&#39; work table,
CA-4801-A,Washing machine,
CA-5943-A,Improvement on bed bottoms,
CA-6183-A,Improvements in wood planing machines,
CA-6207-A,Improvements in lamps,
CA-6390-A,Reversible plough,
CA-6969-A,Machine for making spirally formed tubes,
CA-8931-S,Bottle,
CA-9897-A,Improvements on fare registers,
DE-3129-C,,
DE-3301-C,,
DE-3884-C,,
DE-3983-C,,
DE-5976-C,,
DK-2807-C,Process for the preparation of soluble salts of barium.,
DK-3080-C,Devices in trays for packing eggs.,
DK-3107-C,The production method for Smedejrns Finned with continuous helical rib.,
DK-3184-C,Water Pitcher.,
DK-3510-C,Device at the apparatus for the production of acetylene.,
DK-5867-C,Automatic oiler Snkker and Snkkehjul in centrifuges.,
DK-5921-C,Ankerbevikling with open coils for generators or motors with one-way Power.,
DK-6491-A,Cable mounting of the guard device for a telecommunications cable,
DK-7210-C,"Alloy of nickel, aluminum, copper and iron.",
DK-8069-C,"Receiver means for rotating steam, gas or combustion products and the like that is also useful as a gas compressor.",
DK-8466-C,Method and apparatus for extracting sulfur and Cyanides in the purification of from Belysningsgas.,
DK-9281-C,Method for Preparation of an image bearer of photosensitive papers.,
DK-9359-C,Device at Telephone exchange.,
ES-1062-U,Truck for transport of concrete and mortar tilting download and auto-return to the loading position.,
ES-1498-U,Razor.,
ES-1524-Y,Device cuvette for containing papers.,
ES-1872-U,Packing box for rolls of raw rubber.,
ES-2542-Y,Purse fastening system.,
ES-2819-Y,"Burning stove liquids, essentially diesel fuel.",
ES-2960-U,Tong for sewing straps.,
ES-3045-U,Sliding adjuster for clothing,
ES-4483-Y,Improved sealing tap water.,
ES-4723-Y,Pocket electric lamp.,
ES-4858-U,A simplified shaving machine,
ES-5089-Y,Breastplate of interposition between the foot and the shoe.,
ES-5219-Y,Cigarette paper sheet.,
ES-5716-U,A protective cardboard disc to facilitate changes retaining therein a stamp,the arrangement of the protective shield consists of two discs glued cardboard between one ai coated by transparent paper and preserving inside a stamp which can not be removed without destruction of the protective shield claimed.
ES-5975-Y,Bottle or container with inner compartments that allow contain different kinds of liquids.,
ES-6454-U,Fonmularios game combined with carbon paper for use in typewriters.,Formset for use in typewriters characterized in that a multiple number of forms of varying sizes together with sheets of carbon paper interleaved between them are joined by one of its ends by way of booklet by glue seam or other means carrying the various forms a drill or drilling by the joint portion of the booklet and another distance from the end attached while sheets of carbon paper lacking drilling are somewhat shorter than the forms to write at the free end opposite the junction of the booklet.
ES-6552-Y,protection against low temperatures shirt.,
ES-6928-Y,Clamping device straps to the handles of wristwatches.,
ES-6962-Y,Provided cork extraction medium.,
ES-7086-Y,Device in gas carbide drive motors.,
ES-7407-Y,Folding bike reduced rate.,
ES-7489-Y,Cover or wrapper to protect the crowns of rayon.,
ES-7516-U,Plywood floors for shoemaking.,Plywood floors for manufacturing footwear characterized by being formed of two or more templates wooden board with its meshes intersecting cross and longitudinal direction alternately linked together by a material of high adhesiveness to which will be given by molding most convenient form and the foot changes depending on the model and type of footwear that these floors want manufacture obtained by the plywood formed great flexibility and ease of movement.
ES-7538-U,"Simile, girdle, bra and panty.",Simil belt bra panty be snapped to a side it characterized in that it comprises duly interconnected parts which replace Soste the belt and the panty.
ES-764-H3,Machine to raise water called fast ferris wheel,
ES-8269-Y,Shuttering elements or molded or reinforced concrete floors lighten parts.,
FI-1825-A,The process of at verkstllande Evaporation at high the temperaturer Science To this was apparat,
FI-291-U1,Utloppsfoerbindning in a substitutionsluftinslaeppningsventil,
FI-3021-A,Frbttring  formmaskiner for cementrr med-regulating device for formldans of skakningrrel

2025-01-20 06:06:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:06:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:06:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:06:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:06:46 - snowflake.connector.connection - INFO - closed
2025-01-20 06:06:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:47 - root - INFO - SQL:
-- Corrected SQL for Query 3:
SELECT
  "publication_number",
  TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
  TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') AS "grant_date_converted"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
  AND "filing_date" != 0
  AND "grant_date" != 0
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date_converted,grant_date_converted
US-2571835-A,1946-03-21,1951-10-16
US-3009706-A,1958-03-12,1961-11-21
US-4306624-A,1979-12-11,1981-12-22
US-6057931-A,1996-03-22,2000-05-02
US-6215672-B1,1999-10-01,2001-04-10
US-8817671-B2,2011-12-14,2014-08-26
US-3400629-A,1965-03-29,1968-09-10
US-7198698-B1,2003-08-18,2007-04-03
US-5664492-A,1996-04-29,1997-09-09
US-4413017-A,1981-06-11,1983-11-01
US-6062941-A,1999-02-04,2000-05-16
US-4443740-A,1982-04-09,1984-04-17
US-6882533-B2,2001-12-14,2005-04-19
US-D444852-S,1998-11-27,2001-07-10
US-8363726-B2,2008-07-31,2013-01-29
US-9627067-B2,2016-03-28,2017-04-18
US-8772304-B2,2011-10-26,2014-07-08
US-7545425-B2,2005-04-06,2009-06-09
US-8879320-B2,2012-09-12,2014-11-04
US-8798724-B2,2012-03-28,2014-08-05
US-8285445-B2,2010-04-22,2012-10-09
US-8281614-B2,2007-06-18,2012-10-09
US-8120996-B2,2007-04-04,2012-02-21
US-7604427-B2,2007-06-21,2009-10-20
US-6611791-B1,2000-05-18,2003-08-26
US-6839968-B2,2002-05-09,2005-01-11
US-5079435-A,1989-12-14,1992-01-07
US-6517181-B2,2001-12-12,2003-02-11
US-9005374-B2,2011-03-28,2015-04-14
US-3383999-A,1967-07-03,1968-05-21
US-5594833-A,1993-05-31,1997-01-14
US-3233386-A,1963-02-18,1966-02-08
US-8701310-B1,2010-08-17,2014-04-22
US-3930935-A,1973-11-29,1976-01-06
US-7352315-B2,2006-07-24,2008-04-01
US-8239955-B2,2008-03-31,2012-08-07
US-RE33774-E,1990-07-19,1991-12-24
US-3696167-A,1970-03-30,1972-10-03
US-7520543-B2,2006-08-23,2009-04-21
US-7411179-B2,2007-02-08,2008-08-12
US-2184471-A,1937-10-12,1939-12-26
US-6979985-B2,2003-06-03,2005-12-27
US-8632537-B2,2012-02-16,2014-01-21
US-8863523-B2,2013-07-09,2014-10-21
US-9179797-B2,2011-05-27,2015-11-10
US-2168433-A,1937-02-13,1939-08-08
US-2271160-A,1939-05-19,1942-01-27
US-1445253-A,1919-09-22,1923-02-13
US-6660669-B2,2001-08-14,2003-12-09
US-6821807-B2,2001-08-30,2004-11-23
US-990457-A,1910-04-21,1911-04-25
US-6314104-B1,1996-10-04,2001-11-06
US-1602212-A,1925-01-28,1926-10-05
US-1920889-A,1929-07-18,1933-08-01
US-2522968-A,1947-11-28,1950-09-19
US-5393704-A,1993-12-13,1995-02-28
US-5858460-A,1991-07-01,1999-01-12
US-7283229-B2,2002-01-25,2007-10-16
US-8912443-B2,2009-04-01,2014-12-16
US-6685909-B2,2003-05-01,2004-02-03
US-3545919-A,1968-05-15,1970-12-08
US-3095615-A,1961-08-22,1963-07-02
US-5808948-A,1996-12-18,1998-09-15
US-4509955-A,1984-06-21,1985-04-09
US-D769840-S,2014-07-23,2016-10-25
US-6075855-A,1998-02-09,2000-06-13
US-5081862-A,1990-03-12,1992-01-21
US-9032298-B2,2008-05-28,2015-05-12
US-5417822-A,1993-12-30,1995-05-23
US-3278865-A,1963-05-31,1966-10-11
US-2797576-A,1953-11-23,1957-07-02
US-3853351-A,1974-03-29,1974-12-10
US-5000811-A,1989-11-22,1991-03-19
US-2739605-A,1952-10-08,1956-03-27
US-7616943-B2,2006-06-27,2009-11-10
US-3343772-A,1965-10-24,1967-09-26
US-3105875-A,1957-12-09,1963-10-01
US-4556213-A,1983-09-09,1985-12-03
US-6700363-B2,2002-09-12,2004-03-02
US-7424976-B2,2005-07-29,2008-09-16
US-7856707-B2,2003-04-11,2010-12-28
US-6816564-B2,2001-11-08,2004-11-09
US-9634057-B2,2014-11-04,2017-04-25
US-7984324-B2,2008-03-27,2011-07-19
US-7738870-B2,2007-01-24,2010-06-15
US-6333684-B1,1998-12-31,2001-12-25
US-7906388-B2,2006-04-12,2011-03-15
US-6536416-B1,2000-08-21,2003-03-25
US-8486040-B2,2009-01-16,2013-07-16
US-4128643-A,1977-05-26,1978-12-05
US-5195442-A,1991-08-29,1993-03-23
US-8265309-B2,2009-09-26,2012-09-11
US-6872196-B1,2002-10-09,2005-03-29
US-4586891-A,1984-09-05,1986-05-06
US-8703043-B2,2012-01-04,2014-04-22
US-4625265-A,1985-05-20,1986-11-25
US-2581468-A,1947-12-10,1952-01-08
US-D453642-S,2000-09-15,2002-02-19
US-5983180-A,1998-02-27,1999-11-09
US-3384050-A,1967-08-01,1968-05-21
US-8450020-B2,2011-04-26,2013-05-28
US-2826667-A,1956-04-23,1958-03-11
US-8315550-B2,2010-03-31,2012-11-20
US-6439304-B2,2001-05-23,2002-08-27
US-5789800-A,1997-01-17,1998-08-04
US-9274229-B2,2011-12-06,2016-03-01
US-9550645-B2,2013-07-05,2017-01-24
US-7793226-B2,2006-08-14,2010-09-07
US-7985341-B2,2007-07-23,2011-07-26
US-8579823-B2,2010-06-07,2013-11-12
US-7169877-B2,2001-09-26,2007-01-30
US-7150775-B2,2004-01-14,2006-12-19
US-2552476-A,1950-02-07,1951-05-08
US-8697468-B2,2012-04-10,2014-04-15
US-8259250-B2,2007-09-26,2012-09-04
US-9671763-B2,2012-12-28,2017-06-06
US-8999831-B2,2012-11-19,2015-04-07
US-6720520-B1,2000-02-15,2004-04-13
US-3223957-A,1963-07-22,1965-12-14
US-8705958-B2,2011-03-11,2014-04-22
US-2499712-A,1947-02-21,1950-03-07
US-7845006-B2,2007-01-23,2010-11-30
US-6908243-B1,2003-12-30,2005-06-21
US-3899265-A,1973-12-27,1975-08-12
US-6700831-B2,2002-01-22,2004-03-02
US-7097163-B2,2005-03-02,2006-08-29
US-3087812-A,1960-05-11,1963-04-30
US-4449002-A,1982-04-14,1984-05-15
US-4494530-A,1983-03-15,1985-01-22
US-D281457-S,1983-02-04,1985-11-26
US-4013557-A,1975-06-06,1977-03-22
US-D747730-S,2015-03-20,2016-01-19
US-6154669-A,1998-11-06,2000-11-28
US-3463983-A,1967-01-19,1969-08-26
US-4441841-A,1982-02-02,1984-04-10
US-4446729-A,1981-10-23,1984-05-08
US-4797651-A,1986-05-27,1989-01-10
US-8170854-B2,2005-01-14,2012-05-01
US-6203078-B1,1998-08-28,2001-03-20
US-

2025-01-20 06:06:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:06:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:06:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:06:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:06:49 - snowflake.connector.connection - INFO - closed
2025-01-20 06:06:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:49 - root - INFO - SQL:
-- Corrected SQL for Query 4 (no changes needed):
SELECT "publication_number", "family_id"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Results:
Too long, hard cut:
publication_number,family_id
JP-1810118-C,16434890
JP-1203714-C,4349252
FR-1500580-A,24014930
ES-8501233-A1,9279533
CA-2165155-A1,22129167
FR-2409943-B1,5992449
GB-1086860-A,23786306
JP-S54117658-A,12139126
JP-H0710178-Y2,31250411
JP-3172057-B2,27427283
US-136580-A,2205996
US-272220-A,2341452
US-599187-A,2667828
CN-1062411-C,22249834
DE-1479218-U,784747
EP-2512367-B1,43857857
ES-2312527-T3,9927123
FR-1000748-A,9560654
FR-1573809-A,7621232
JP-S5066757-U,28364915
JP-S5845249-Y2,28646482
US-2103405-A,24126880
GB-201114438-D0,44800659
JP-5707248-B2,47671111
JP-2016211567-A,57179285
KR-20040075216-A,33516334
CN-1954806-A,38062481
CN-201399214-Y,41101653
JP-1368881-C,12213842
JP-1444589-C,13384729
FR-1497898-A,26173968
DE-2707796-A1,11991139
DE-2962208-D1,26733043
FR-2233137-A1,11216692
GB-2224027-B,10644989
JP-S5911756-Y2,28825063
JP-2000218515-A,12213511
JP-S56169301-A,13496200
US-2002102047-A1,24588049
CN-1467804-A,34147716
EP-0988417-B1,7831228
JP-H04334685-A,14380644
JP-S6359143-U,31071756
JP-H0685910-B2,17707992
JP-H0350567-B2,20351149
JP-5108773-B2,37856792
CN-2768052-Y,36130065
CN-1940157-B,36569966
CN-202318915-U,46430910
CN-203200362-U,49144490
JP-897785-C,12752978
JP-1789132-C,6338354
JP-S62113530-U,30777987
CA-118661-S,48949441
FI-882364-A0,8526484
CA-810158-A,24064892
DE-2335240-A1,5886563
DE-7610943-U1,6664079
JP-H0673947-U,11841145
JP-S54153049-A,13166352
JP-S5716116-U,29449694
US-548167-A,2616910
CN-1055840-A,6404037
JP-S6020713-A,15000093
JP-S6234024-A,15962328
JP-H0995081-A,17278302
JP-H1088758-A,17435637
GB-189709494-A,32353776
JP-2001195445-A,22609045
JP-2010101160-A,42054814
CN-101746294-A,42134179
CN-104170353-A,51912370
CN-206056613-U,58376396
JP-1032657-C,12309338
JP-1654837-C,14760871
DK-146223-C,22548755
CA-564325-A,35736825
GB-0802422-D0,39247394
JP-S53139175-U,28919719
JP-H01150349-U,31274164
JP-2600796-Y2,13664723
JP-S591896-U,30228404
JP-S4922438-B1,25119541
US-419959-A,2488878
DE-69331528-D1,25543828
DE-69430885-T2,20390510
EP-1474362-B1,27732378
JP-2000346423-A,15528532
JP-2765752-B2,17296431
KR-900003183-Y1,19262397
JP-2003229053-A,27746793
JP-2007241524-A,38587026
JP-5129599-B2,40113333
KR-100547071-B1,29243804
KR-20070020426-A,34861538
KR-20130050682-A,48660984
CN-204556165-U,53831260
ES-66185-Y,52730815
CA-1331409-C,25671081
FI-891492-A0,22640016
GB-1348507-A,27273208
JP-S60179587-U,30603266
US-332138-A,2401238
CN-1112492-C,4579511
DE-566539-C,7242183
DE-845109-C,7292640
JP-S63125649-A,25353670
JP-S6423693-U,31363076
JP-S5243021-U,28610623
JP-S5566205-U,29134624
JP-H0825023-B2,15797928
JP-2003215980-A,27670225
JP-4255884-B2,35587884
KR-100295305-B1,12367105
CN-101547005-A,41193935
CN-101988676-A,43745355
CN-203259375-U,49471928
CN-205932945-U,57947562
DE-202006018912-U1,37776401
FR-2828332-A1,8851730
GB-1375879-A,10135648
JP-S53161674-U,28969941
US-2053075-A,21966233
CN-2484753-Y,33654909
CN-1212523-A,17153001
FI-20010786-A,8560995
JP-S6359144-U,31070978
JP-2799203-B2,23060287
JP-H08143121-A,17994142
US-1837725-A,23553531
US-2304134-A,23563184
US-1864623-A,24014353
JP-5991128-B2,50746206
JP-2016105749-A,51658201
RU-2191214-C2,20244718
RU-2008140707-A,46274907
CN-103265598-B,49009270
CN-203928708-U,51824510
CN-204557664-U,53832749
CN-206326242-U,59285711
CN-104559893-B,53076991
CN-106856628-A,59012672
US-6778773-B2,19122213
JP-H00985753-A,17101171
JP-1512007-C,13603320
NL-28211-C,1793235
CA-2184504-C,24131977
FR-877274-A,6818008
JP-S60218905-A,24343079
JP-H04326774-A,14195785
JP-S5125160-A,14210931
FR-1012104-A,9570537
JP-S5944363-A,6170220
JP-H081564-A,15634830
US-1233474-A,3301305
US-2002011230-A1,18656494
JP-2003169856-A,19181781
US-811638-A,2880117
KR-200338652-Y1,49342250
KR-20070041890-A,37962650
CN-1816294-A,36778618
CN-2858160-Y,37611019
CN-201276086-Y,40893666
CN-201816145-U,43914113
CN-102907994-A,47606753
JP-1573454-C,12299270
JP-1721868-C,16956632
JP-2100371-C,16847464
DK-358583-D0,23885229
ES-146285-Y,8328146
GB-478690-A,6542289
DE-2649618-B2,5991995
DE-3766112-D1,25468864
DE-8007402-U1,6713907
FR-390089-A,1435653
FR-638126-A,10160478
FR-2638622-B1,9371569
JP-H0584037-U,12173208
JP-S4739450-Y1,33221751
JP-H0642846-U,13718656
NL-296405-A,1877312
NL-7211943-A,19816839
EP-2781788-B1,50289541
JP-S5072414-U,28386197
JP-S5846920-U,29935188
JP-S5874811-U,29962816
JP-S5687776-U,29682033
US-D279853-S,-1
KR-920008597-Y1,19279218
JP-2004313014-A,33469263
JP-6137070-B2,55225833
RU-2008132286-A,42123530
US-754320-A,2822813
CN-105823611-A,56524943
CN-106739164-A,58922392
CN-205558012-U,56821657
BE-512467-A,150911
CA-2244766-A1,29418207
DE-1803332-A1,25756273
DE-2149141-A1,5821241
GB-2089320-A,15972930
JP-S62164685-U,30876254
JP-H066780-Y2,31585658
DE-69322442-T2,25419972
EP-1933436-B1,38221653
EP-0782478-B1,10760989
EP-0993180-B1,17716909
JP-S5128923-U,28309915
JP-S5153284-U,28385065
JP-S5376919-A,15554809
JP-3340813-B2,17034833
JP-2000192758-A,18492249
JP-H11193667-A,18492499
RU-17326-U1,36050112
KR-20110049427-A,44360569
CN-101531763-A,41102637
CN-201900010-U,44270612
CN-202142

2025-01-20 06:06:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:06:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:06:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:06:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:06:51 - snowflake.connector.connection - INFO - closed
2025-01-20 06:06:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:51 - root - INFO - SQL:
-- Corrected SQL for Query 5 (no changes needed):
SELECT "publication_number", "application_kind"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
LIMIT 1000
Results:
Too long, hard cut:
publication_number,application_kind
US-3386882-A,A
US-3027501-A,A
US-3942098-A,A
US-4976319-A,A
US-9109382-B2,A
US-4771043-A,A
US-2005230705-A1,A
US-2013130462-A1,A
US-9053107-B1,A
US-7902031-B2,A
US-2016075808-A1,A
US-7608693-B2,A
US-2014003741-A1,A
US-2013140361-A1,A
US-2016298023-A1,A
US-2003171248-A1,A
US-2004162313-A1,A
US-D652666-S,F
US-2006099337-A1,A
US-2016154172-A1,A
US-2004174607-A1,A
US-2013153308-A1,A
US-2015247786-A1,A
US-2008224789-A1,A
US-2008258624-A1,A
US-7464329-B2,A
US-5635185-A,A
US-8296413-B2,A
US-2012150653-A1,A
US-2012129580-A1,A
US-2011047323-A1,A
US-2017013192-A1,A
US-2012248360-A1,A
US-2005262396-A1,A
US-2012227290-A1,A
US-2009147073-A1,A
US-7970723-B2,A
US-2012045534-A1,A
US-5114354-A,A
US-7780352-B2,A
US-2015369567-A1,A
US-2009315655-A1,A
US-2013205270-A1,A
US-2013098332-A1,A
US-2015152998-A1,A
US-2005230479-A1,A
US-2010260546-A1,A
US-2010189222-A1,A
US-2011226486-A1,A
US-7658953-B2,A
US-2014305686-A1,A
US-2006195675-A1,A
US-2009069867-A1,A
US-2016024760-A1,A
US-2008215603-A1,A
US-2014036748-A1,A
US-2014064040-A1,A
US-8852551-B2,A
US-2010129969-A1,A
US-2010033722-A1,A
US-2009194945-A1,A
US-8212546-B2,A
US-3304279-A,A
US-3458087-A,A
US-8619482-B1,A
US-D787348-S,F
US-5714952-A,A
US-9485551-B2,A
US-4322320-A,A
US-7421499-B1,A
US-2004054491-A1,A
US-2016308783-A1,A
US-9496971-B2,A
US-7544531-B1,A
US-8194623-B2,A
US-2017210626-A1,A
US-550395-A,A
US-2090148-A,A
US-1563811-A,A
US-1690978-A,A
US-1080290-A,A
US-874054-A,A
US-1432386-A,A
US-2005140913-A1,A
US-1273171-A,A
US-1976605-A,A
US-1288533-A,A
US-2002005139-A1,A
US-90191-A,A
US-1500903-A,A
US-884660-A,A
US-3836637-A,A
US-3733363-A,A
US-7672572-B2,A
US-8288771-B2,A
US-7703166-B2,A
US-8250336-B2,A
US-2017243441-A1,A
US-7749437-B2,A
US-1841439-A,A
US-685549-A,A
US-717097-A,A
US-9605080-B2,A
US-1281510-A,A
US-D688470-S,F
US-70658-A,A
US-1587649-A,A
US-6979145-B2,A
US-2013281696-A1,A
US-8423345-B1,A
US-9660318-B2,A
US-7992317-B1,A
US-8836743-B2,A
US-7688039-B2,A
US-310097-A,A
US-1394605-A,A
US-9074796-B2,A
US-9508612-B2,A
US-168508-A,A
US-1745690-A,A
US-3773788-A,A
US-D573796-S,F
US-1987353-A,A
US-936398-A,A
US-140875-A,A
US-112757-A,A
US-2002009718-A1,A
US-841786-A,A
US-1693320-A,A
US-833877-A,A
US-8124531-B2,A
US-98273-A,A
US-4429194-A,A
US-2042253-A,A
US-471774-A,A
US-3773875-A,A
US-835298-A,A
US-1099037-A,A
US-1124387-A,A
US-2006511-A,A
US-2008254519-A1,A
US-759553-A,A
US-2017096779-A1,A
US-8712-A,A
US-107767-A,A
US-197619-A,A
US-564915-A,A
US-1229662-A,A
US-1792297-A,A
US-190377-A,A
US-976587-A,A
US-86003-A,A
US-962341-A,A
US-1271973-A,A
US-1085585-A,A
US-1002337-A,A
US-2015288243-A1,A
US-8102405-B2,A
US-8680289-B2,A
US-6569947-B1,A
US-2017136437-A1,A
US-1842177-A,A
US-2003017456-A1,A
US-851137-A,A
US-2013077094-A1,A
US-D680201-S,F
US-1367640-A,A
US-2013236121-A1,A
US-9503167-B2,A
US-8229017-B1,A
US-2017227103-A1,A
US-8986264-B2,A
US-7455034-B2,A
US-9170329-B2,A
US-1397607-A,A
US-6292031-B1,A
US-8869288-B2,A
US-8379632-B2,A
US-9467135-B2,A
US-7529447-B2,A
US-6472395-B1,A
US-2013153072-A1,A
US-9241999-B2,A
US-7221067-B2,A
US-2005192304-A1,A
US-2015356128-A1,A
US-8986671-B2,A
US-2008123158-A1,A
US-2007028923-A1,A
US-2015347052-A1,A
US-2012186608-A1,A
US-2012178568-A1,A
US-2007109861-A1,A
US-7670605-B2,A
US-2015029573-A1,A
US-2005286734-A1,A
US-2009091461-A1,A
US-2010249953-A1,A
US-2006231296-A1,A
US-2011302498-A1,A
US-2014202949-A1,A
US-2008198759-A1,A
US-2011033008-A1,A
US-2015325318-A1,A
US-2015173385-A1,A
US-2011229577-A1,A
US-6755925-B1,A
US-2007243416-A1,A
US-2005189265-A1,A
US-2007228790-A1,A
US-2725688-A,A
US-2006204068-A1,A
US-2007157737-A1,A
US-2735723-A,A
US-4057975-A,A
US-6549780-B2,A
US-D739811-S,F
US-2008169557-A1,A
US-7755045-B2,A
US-3896888-A,A
US-3177255-A,A
US-6115795-A,A
US-4183330-A,A
US-6857996-B2,A
US-3910051-A,A
US-9035606-B2,A
US-2015179981-A1,A
US-2006221438-A1,A
US-2528705-A,A
US-4572880-A,A
US-9653764-B2,A
US-4339741-A,A
US-6656997-B2,A
US-6939208-B2,A
US-7090520-B2,A
US-2013286506-A1,A
US-4818164-A,A
US-3511826-A,A
US-4636440-A,A
US-2013027085-A1,A
US-2004041961-A1,A
US-2011030536-A1,A
US-3893135-A,A
US-2647163-A,A
US-5382299-A,A
US-2014194333-A1,A
US-2011075502-A1,A
US-6665912-B2,A
US-5336305-A,A
US-8959636-B2,A
US-4697425-A,A
US-2772956-A,A
US-2007232991-A1,A
US-5675433-A,A
US-2009320748-A1,A
US-2011273843-A1,A
US-4480163-A,A
US-4990376-A,A
US-2015380450-A1,A
US-2004068344-A1,A
US-7432507-B2,A
US-2011197582-A1,A
US-2005092756-A1,A
US-7838326-B2,A
US-6427991-B1,A
US-5277812-A,A
US-3104687-A,A
US-5551026-A,A
US-3028435-A,A
US-3245421-A,A
US-3192494-A,A
US-4226665-A,A
US-4722684-A,A
US-7075253-B2,A
US-5399043-A,A
US-4905604-A,A
US-8490255-B1,A
US-D377277-S,F
US-2014337972-A1,A
US-8536324-B2,A
US-2010238701-A1,A
US-8840251-B2,A
US-7254741-B1,A
US-2014070802-A1,A
US-9113312-B2,A
US-6876359-B2,A
US-9349497-B2,A
US-2015101196-A1,A
US-2009078178-A1,A
US-9192990-B2,A
US-6260651-B1,A
US-2014088986-A1,A
US-2012290266-A1,A
US-2004026123-A1,A
US-2014108983-A1,A
US-2008265331-A1,A
US-6167745-B1,A
US-2009194732-A1,A
US-2

2025-01-20 06:06:51 - root - INFO - itercount: 0
2025-01-20 06:06:51 - root - INFO - Database Name: PATENTS_GOOGLE
Schema Name: PATENTS_GOOGLE
DDL describes table information.
,0
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

,1
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,2
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""description_localized"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""citation"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,3
table_name,ABS_AND_EMB
description,
DDL,"create or replace TABLE ABS_AND_EMB (
	""publication_number"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""title_translated"" BOOLEAN,
	""abstract"" VARCHAR(16777216),
	""abstract_translated"" BOOLEAN,
	""cpc"" VARIANT,
	""cpc_low"" VARIANT,
	""cpc_inventive_low"" VARIANT,
	""top_terms"" VARIANT,
	""similar"" VARIANT,
	""url"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""publication_description"" VARCHAR(16777216),
	""cited_by"" VARIANT,
	""embedding_v1"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

1. **From `PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS` table:**

   - `"publication_number"`: Used to identify each patent uniquely.
   - `"country_code"`: To filter patents from the United States (`'US'`).
   - `"kind_code"`: To identify utility patents under the B2 classification.
   - `"grant_date"`: To select patents granted between 2010 and 2014.
   - `"filing_date"`: Needed to determine the filing year and calculate time differences.
   - `"application_number"`: May be useful for additional patent identification.
   - `"application_kind"`: Could be used to filter utility patents.
   - `"family_id"`: For grouping related patents.

2. **From `PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB` table:**

   - `"publication_number"`: For joining with the `PUBLICATIONS` table.
   - `"country"`: To filter patents from the United States (`'US'`).
   - `"cited_by"`: Contains forward citations; used to count the number of citations.
   - `"embedding_v1"`: Contains embeddings used to compute similarity between patents.
   - `"abstract"`: May be used for additional text analysis if needed.
   - `"title"`: For identifying patents or additional filtering.

**Conditions That May Be Used:**

- Filter patents where `"country_code"` or `"country"` equals `'US'`.
- Select patents with `"kind_code"` containing `'B2'` to identify utility patents.
- Filter `"grant_date"` between `20100101` and `20141231` for patents granted between 2010 and 2014.
- Use `"cited_by"` to count forward citations within a specific time frame.
- Match `"publication_number"` between the two tables for joins.
- Select patents filed in the same year for similarity comparison.

**SQL Queries:**

1. **Retrieve distinct country codes from the `PUBLICATIONS` table:**

   ```sql
   SELECT DISTINCT "country_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
   ```

2. **Retrieve distinct kind codes from the `PUBLICATIONS` table:**

   ```sql
   SELECT DISTINCT "kind_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
   ```

3. **Select publication numbers of US patents with kind code containing 'B2':**

   ```sql
   SELECT "publication_number", "country_code", "kind_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   WHERE "country_code" = 'US' 
     AND "kind_code" LIKE '%B2%' 
   LIMIT 1000;
   ```

4. **Retrieve grant dates between 2010 and 2014 from the `PUBLICATIONS` table:**

   ```sql
   SELECT "publication_number", "grant_date" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   WHERE "grant_date" BETWEEN 20100101 AND 20141231 
   LIMIT 1000;
   ```

5. **Select filing dates from the `PUBLICATIONS` table:**

   ```sql
   SELECT "publication_number", "filing_date" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
   ```

6. **Retrieve 'cited_by' data from the `ABS_AND_EMB` table:**

   ```sql
   SELECT "publication_number", "cited_by" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
   LIMIT 1000;
   ```

7. **Unnest 'cited_by' to get citing publication numbers:**

   ```sql
   SELECT 
     t."publication_number", 
     f.value::STRING AS "cited_by_publication_number" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
        LATERAL FLATTEN(input => t."cited_by") f 
   LIMIT 1000;
   ```

8. **Retrieve embeddings from the `ABS_AND_EMB` table:**

   ```sql
   SELECT "publication_number", "embedding_v1" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
   LIMIT 1000;
   ```

9. **Select patents with their filing date and embeddings by joining two tables:**

   ```sql
   SELECT 
     p."publication_number", 
     p."filing_date", 
     a."embedding_v1" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
     ON p."publication_number" = a."publication_number" 
   LIMIT 1000;
   ```

10. **Retrieve patents filed in 2012 with their embeddings:**

    ```sql
    SELECT 
      p."publication_number", 
      p."filing_date", 
      a."embedding_v1" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
      ON p."publication_number" = a."publication_number" 
    WHERE p."filing_date" BETWEEN 20120101 AND 20121231 
    LIMIT 1000;
    ```

11. **Select US patents under B2 classification with grant dates between 2010 and 2014:**

    ```sql
    SELECT 
      "publication_number", 
      "country_code", 
      "kind_code", 
      "grant_date" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
    WHERE "country_code" = 'US' 
      AND "kind_code" LIKE '%B2%' 
      AND "grant_date" BETWEEN 20100101 AND 20141231 
    LIMIT 1000;
    ```

12. **Retrieve the number of forward citations for each patent:**

    ```sql
    SELECT 
      t."publication_number", 
      COUNT(f.value) AS "forward_citation_count" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
         LATERAL FLATTEN(input => t."cited_by") f 
    GROUP BY t."publication_number" 
    LIMIT 1000;
    ```

13. **Select patents along with their filing dates and the number of forward citations:**

    ```sql
    SELECT 
      p."publication_number", 
      p."filing_date", 
      COUNT(f.value) AS "forward_citation_count" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
      ON p."publication_number" = a."publication_number" 
    LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f 
      ON TRUE 
    GROUP BY p."publication_number", p."filing_date" 
    LIMIT 1000;
    ```

14. **Retrieve patents with their country and kind code from the `ABS_AND_EMB` table:**

    ```sql
    SELECT "publication_number", "country", "publication_description" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
    LIMIT 1000;
    ```

15. **Select embeddings for patents filed in the same year as a specific patent:**

    ```sql
    SELECT 
      p."publication_number", 
      p."filing_date", 
      a."embedding_v1" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
      ON p."publication_number" = a."publication_number" 
    WHERE p."filing_date" BETWEEN [specific_year_start] AND [specific_year_end] 
    LIMIT 1000;
    ```

    *(Replace `[specific_year_start]` and `[specific_year_end]` with actual dates.)*

16. **Retrieve the list of CPC codes from the `ABS_AND_EMB` table:**

    ```sql
    SELECT DISTINCT f.value::STRING AS "cpc_code" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
         LATERAL FLATTEN(input => t."cpc") f 
    LIMIT 1000;
    ```

17. **Select patents with their titles and abstracts:**

    ```sql
    SELECT "publication_number", "title", "abstract" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
    LIMIT 1000;
    ```

18. **Retrieve filing dates and grant dates for US patents:**

    ```sql
    SELECT 
      "publication_number", 
      "filing_date", 
      "grant_date" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
    WHERE "country_code" = 'US' 
    LIMIT 1000;
    ```

19. **Select patents with their family ID from the `PUBLICATIONS` table:**

    ```sql
    SELECT "publication_number", "family_id" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
    LIMIT 1000;
    ```

20. **Retrieve the application kind for US patents:**

    ```sql
    SELECT "publication_number", "application_kind" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
    WHERE "country_code" = 'US' 
    LIMIT 1000;
    ```

These queries will help in understanding the data distribution and values in the relevant columns, which is essential for formulating the final SQL query to solve the original task.Query:
SELECT DISTINCT "country_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
Answer:
country_code
JP
DE
US
DK
FI
GB
EP
KR
WO
NL
ES
RU
BE
LU
CA
CN
FR
Query:
SELECT DISTINCT "kind_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
Answer:
kind_code
B
Y1
I1
T9
U9
B8
R1
H
T3
D1
U4
K4
Z1
A5
B3
T4
P1
R2
P
A4
T5
A8
I5
I2
V0
B1
S
D2
U8
Y2
T2
H1
T7
L
A0
B9
T1
Y4
R
K1
U
F
C1
T0
T8
U0
U1
A6
Y
A1
S1
M
U3
C9
C2
B4
C5
H3
A3
K5
E
D0
A2
I4
C
A
P3
P2
T
B2
A9
E1
C3
A7
Query:
SELECT "publication_number", "country_code", "kind_code" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   WHERE "country_code" = 'US' 
     AND "kind_code" LIKE '%B2%' 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,country_code,kind_code
US-9109382-B2,US,B2
US-7902031-B2,US,B2
US-7608693-B2,US,B2
US-7464329-B2,US,B2
US-8296413-B2,US,B2
US-7970723-B2,US,B2
US-7780352-B2,US,B2
US-7658953-B2,US,B2
US-8852551-B2,US,B2
US-8212546-B2,US,B2
US-9485551-B2,US,B2
US-9496971-B2,US,B2
US-8194623-B2,US,B2
US-9760693-B2,US,B2
US-9243005-B2,US,B2
US-8981106-B2,US,B2
US-9312564-B2,US,B2
US-7645905-B2,US,B2
US-9712468-B2,US,B2
US-7490938-B2,US,B2
US-9739035-B2,US,B2
US-8501582-B2,US,B2
US-7445319-B2,US,B2
US-9216785-B2,US,B2
US-7017954-B2,US,B2
US-8306451-B2,US,B2
US-8524754-B2,US,B2
US-9066419-B2,US,B2
US-7053968-B2,US,B2
US-7826077-B2,US,B2
US-9395583-B2,US,B2
US-7472525-B2,US,B2
US-7803900-B2,US,B2
US-7554825-B2,US,B2
US-7143442-B2,US,B2
US-8223042-B2,US,B2
US-8951425-B2,US,B2
US-6854387-B2,US,B2
US-8300397-B2,US,B2
US-8167650-B2,US,B2
US-8995704-B2,US,B2
US-7913981-B2,US,B2
US-7321997-B2,US,B2
US-8747035-B2,US,B2
US-8575784-B2,US,B2
US-8459339-B2,US,B2
US-8941380-B2,US,B2
US-8810355-B2,US,B2
US-9615444-B2,US,B2
US-7320405-B2,US,B2
US-8582628-B2,US,B2
US-7378205-B2,US,B2
US-9261937-B2,US,B2
US-7282643-B2,US,B2
US-7918885-B2,US,B2
US-8726218-B2,US,B2
US-9548776-B2,US,B2
US-7337078-B2,US,B2
US-9500832-B2,US,B2
US-9391842-B2,US,B2
US-7536379-B2,US,B2
US-8688093-B2,US,B2
US-8251160-B2,US,B2
US-8379331-B2,US,B2
US-9252981-B2,US,B2
US-8850126-B2,US,B2
US-7315403-B2,US,B2
US-9731828-B2,US,B2
US-7180411-B2,US,B2
US-6588853-B2,US,B2
US-6827197-B2,US,B2
US-8335385-B2,US,B2
US-8568510-B2,US,B2
US-7563000-B2,US,B2
US-9648021-B2,US,B2
US-6908210-B2,US,B2
US-9656260-B2,US,B2
US-8974678-B2,US,B2
US-7188744-B2,US,B2
US-9184335-B2,US,B2
US-8863077-B2,US,B2
US-7430521-B2,US,B2
US-7711335-B2,US,B2
US-9541929-B2,US,B2
US-7701148-B2,US,B2
US-7517642-B2,US,B2
US-8949421-B2,US,B2
US-9656235-B2,US,B2
US-8782666-B2,US,B2
US-9528062-B2,US,B2
US-9717817-B2,US,B2
US-9018530-B2,US,B2
US-6998932-B2,US,B2
US-8537297-B2,US,B2
US-8415158-B2,US,B2
US-7005916-B2,US,B2
US-9174852-B2,US,B2
US-6836411-B2,US,B2
US-8886915-B2,US,B2
US-8598100-B2,US,B2
US-9349623-B2,US,B2
US-8763130-B2,US,B2
US-7102141-B2,US,B2
US-9438853-B2,US,B2
US-9606890-B2,US,B2
US-8101464-B2,US,B2
US-7561428-B2,US,B2
US-9472889-B2,US,B2
US-6529468-B2,US,B2
US-6842228-B2,US,B2
US-6833837-B2,US,B2
US-9258484-B2,US,B2
US-7976829-B2,US,B2
US-9401154-B2,US,B2
US-6784243-B2,US,B2
US-8101065-B2,US,B2
US-7552453-B2,US,B2
US-7813075-B2,US,B2
US-8139265-B2,US,B2
US-9440302-B2,US,B2
US-6487435-B2,US,B2
US-7082505-B2,US,B2
US-8421795-B2,US,B2
US-7425525-B2,US,B2
US-9560058-B2,US,B2
US-8660733-B2,US,B2
US-8339969-B2,US,B2
US-7855036-B2,US,B2
US-8515371-B2,US,B2
US-8168876-B2,US,B2
US-7520949-B2,US,B2
US-7113442-B2,US,B2
US-8475829-B2,US,B2
US-7934793-B2,US,B2
US-8176066-B2,US,B2
US-6980337-B2,US,B2
US-8869161-B2,US,B2
US-8358332-B2,US,B2
US-8029183-B2,US,B2
US-8707142-B2,US,B2
US-8734016-B2,US,B2
US-9333656-B2,US,B2
US-9272619-B2,US,B2
US-8493359-B2,US,B2
US-9067967-B2,US,B2
US-7011160-B2,US,B2
US-8165511-B2,US,B2
US-8021977-B2,US,B2
US-9576392-B2,US,B2
US-8972875-B2,US,B2
US-9480338-B2,US,B2
US-8612291-B2,US,B2
US-7619849-B2,US,B2
US-7140871-B2,US,B2
US-7937298-B2,US,B2
US-8360515-B2,US,B2
US-8885764-B2,US,B2
US-8362624-B2,US,B2
US-9268484-B2,US,B2
US-8243251-B2,US,B2
US-9670412-B2,US,B2
US-6985112-B2,US,B2
US-7820445-B2,US,B2
US-7176602-B2,US,B2
US-9143862-B2,US,B2
US-8053171-B2,US,B2
US-8544057-B2,US,B2
US-7676993-B2,US,B2
US-7531430-B2,US,B2
US-7830193-B2,US,B2
US-9197661-B2,US,B2
US-8281593-B2,US,B2
US-7179349-B2,US,B2
US-8059949-B2,US,B2
US-7033261-B2,US,B2
US-8269458-B2,US,B2
US-8522557-B2,US,B2
US-8362855-B2,US,B2
US-7708492-B2,US,B2
US-7808201-B2,US,B2
US-6852425-B2,US,B2
US-8202745-B2,US,B2
US-6808587-B2,US,B2
US-8593015-B2,US,B2
US-6908096-B2,US,B2
US-7137747-B2,US,B2
US-8127992-B2,US,B2
US-8290010-B2,US,B2
US-6708776-B2,US,B2
US-7057340-B2,US,B2
US-7498861-B2,US,B2
US-9473501-B2,US,B2
US-9086293-B2,US,B2
US-7643385-B2,US,B2
US-8456858-B2,US,B2
US-7066032-B2,US,B2
US-7054764-B2,US,B2
US-6925769-B2,US,B2
US-7522374-B2,US,B2
US-7545887-B2,US,B2
US-9651655-B2,US,B2
US-9030947-B2,US,B2
US-6340064-B2,US,B2
US-6952573-B2,US,B2
US-8353954-B2,US,B2
US-8661972-B2,US,B2
US-6978773-B2,US,B2
US-7322681-B2,US,B2
US-7165803-B2,US,B2
US-7609310-B2,US,B2
US-9304360-B2,US,B2
US-8338529-B2,US,B2
US-6999381-B2,US,B2
US-7238470-B2,US,B2
US-6924366-B2,US,B2
US-7820001-B2,US,B2
US-8080515-B2,US,B2
US-7127557-B2,US,B2
US-8954232-B2,US,B2
US-6866631-B2,US,B2
US-8254317-B2,US,B2
US-8461930-B2,US,B2
US-7480060-B2,US,B2
US-6966100-B2,US,B2
US-6695145-B2,US,B2
US-9076653-B2,US,B2
US-9387827-B2,US,B2
US-8076519-B2,US,B2
US-7555234-B2,US,B2
US-8615281-B2,US,B2
US-8147470-B2,US,B2
US-8148575-B2,US,B2
US-9047435-B2,US,B2
US-8153074-B2,US,B2
US-9333719-B2,US,B2
US-8919830-B2,US,B2
US-9743211-B2,US,B2
US-6917653-B2,US,B2
US-7939921-B2,US,B2
US-6666152-B2,US,B2
US-6914921-B2,US,B2
US-6817384-B2,US,B2
US-7421051-B2,US,B2
US-8777490-B2,US,B2
US-9160846-B2,US,B2
US-8216528-B2,US,B2
US-8373784-B2,US,B2
US-7695394-B2,US,B
Query:
SELECT "publication_number", "grant_date" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   WHERE "grant_date" BETWEEN 20100101 AND 20141231 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,grant_date
EP-2409946-B1,20140507
JP-5036281-B2,20120926
GB-201008313-D0,20100707
JP-5065641-B2,20121107
CN-202476678-U,20121010
JP-5008058-B2,20120822
JP-5439596-B2,20140312
CN-201875846-U,20110622
CN-202377459-U,20120815
CN-202386491-U,20120822
CN-203879581-U,20141015
EP-1775720-B1,20111109
CN-201778352-U,20110330
CN-202008336-U,20111012
CN-202751797-U,20130227
CN-201482889-U,20100526
JP-5551640-B2,20140716
CN-201750912-U,20110223
CN-202788073-U,20130313
CA-2533614-C,20110503
CN-102392153-B,20140115
EP-1832160-B1,20110223
CN-102221073-B,20130327
US-8768622-B2,20140701
CN-103146534-B,20140319
KR-101284644-B1,20130711
KR-101356112-B1,20140129
US-7727119-B2,20100601
RU-2499633-C1,20131127
CN-102123931-B,20130515
CN-101421795-B,20130306
CN-101983201-B,20140423
CN-101546982-B,20110413
CN-102035046-B,20130612
KR-101248374-B1,20130401
CN-102838039-B,20140903
CN-1989298-B,20101117
CN-102001537-B,20130327
CN-102507392-B,20130814
CN-101753397-B,20121114
CN-100594022-C,20100317
CN-102372790-B,20130410
RU-2449358-C1,20120427
US-8591484-B2,20131126
CN-203550037-U,20140416
JP-4712713-B2,20110629
DE-202011052218-U1,20130109
JP-4538960-B2,20100908
RU-2465397-C1,20121027
US-8894929-B2,20141125
JP-4591505-B2,20101201
GB-2475537-B,20120125
CN-102170665-B,20130807
CN-102168881-B,20130619
KR-100994778-B1,20101117
CN-100591970-C,20100224
US-8550498-B2,20131008
CN-102108427-B,20120530
DE-102008053495-B4,20130103
CN-102449429-B,20140423
CN-101719181-B,20120704
CN-103634577-B,20141231
CN-102020446-B,20131023
US-8084696-B2,20111227
CN-101204742-B,20100526
US-8719990-B2,20140513
CN-101539009-B,20111005
CN-101576374-B,20110525
KR-101220417-B1,20130110
CN-101229787-B,20100901
CN-102017578-B,20141210
US-8719514-B2,20140506
US-8324898-B2,20121204
JP-4678032-B2,20110427
KR-101326001-B1,20131120
DE-102010036823-B8,20110818
US-7746011-B2,20100629
EP-1498629-B2,20131016
KR-101211327-B1,20121211
KR-101222043-B1,20130115
JP-4739062-B2,20110803
KR-100989724-B1,20101026
CN-102267494-B,20130123
US-8613206-B2,20131224
KR-101357430-B1,20140206
CN-1614956-B,20100505
US-7819758-B2,20101026
KR-101414981-B1,20140704
CN-101932380-B,20140319
NL-1037900-C,20111021
CN-101259887-B,20101013
CN-101847042-B,20111228
CN-101180839-B,20120215
CN-102234769-B,20141105
CN-101459378-B,20110309
CN-101302157-B,20110427
KR-101297073-B1,20130814
US-8729750-B2,20140520
US-7990739-B2,20110802
US-8824115-B2,20140902
CN-101253079-B,20101103
CN-100587710-C,20100203
DE-10308893-B4,20130919
KR-101009365-B1,20110119
CN-102064876-B,20130807
KR-101453731-B1,20141023
CN-101444011-B,20130220
US-8518784-B2,20130827
RU-2457643-C2,20120810
JP-4750889-B2,20110817
CN-101550011-B,20111005
CN-101549190-B,20120208
CN-101330719-B,20110810
KR-101379971-B1,20140410
CN-102158275-B,20131218
US-8141404-B2,20120327
US-7912686-B2,20110322
US-7904645-B2,20110308
CN-101586954-B,20120725
CN-103115813-B,20141022
CN-102688095-B,20140827
KR-100977469-B1,20100823
US-8073568-B2,20111206
US-8792886-B2,20140729
US-8528838-B2,20130910
CN-1986652-B,20101117
DE-10242257-B4,20131219
CN-1965694-B,20100414
CN-102526592-B,20130925
US-8023832-B2,20110920
RU-2511820-C2,20140410
CN-101890356-B,20130123
CN-1876659-B,20101222
GB-2451060-B,20130109
CN-101977996-B,20130102
CN-101820209-B,20121107
KR-100957377-B1,20100511
DE-102011006417-B3,20120830
KR-101155542-B1,20120618
CN-101552453-B,20120111
KR-101249589-B1,20130401
DE-102011016802-B4,20130221
CN-101029336-B,20101103
US-7786464-B2,20100831
KR-100970215-B1,20100716
US-7831404-B2,20101109
US-8508659-B2,20130813
CN-102036066-B,20130619
CN-102653256-B,20141105
CN-101510138-B,20120711
US-8073622-B2,20111206
US-8288748-B2,20121016
CN-101906454-B,20120815
US-8167061-B2,20120501
US-D620166-S,20100720
CN-102690433-B,20140716
CN-102113186-B,20140625
KR-101154296-B1,20120613
US-8218633-B2,20120710
CN-101811426-B,20121226
CN-102697304-B,20140402
CN-102249729-B,20130320
DE-10302601-B4,20100114
CN-103184225-B,20140813
RU-2500182-C1,20131210
CN-1889342-B,20100421
CN-101379515-B,20130102
CN-101243270-B,20110706
CN-102391195-B,20140507
JP-4600012-B2,20101215
CN-101937150-B,20120104
US-8154416-B1,20120410
US-8924594-B2,20141230
CN-102542858-B,20140611
US-8100264-B2,20120124
JP-5044395-B2,20121010
GB-2480765-B,20120801
KR-101147917-B1,20120525
CN-101592546-B,20121024
CN-101065445-B,20110511
JP-4925317-B2,20120425
CN-203099880-U,20130731
CN-203203414-U,20130918
RU-2397920-C2,20100827
CN-203705655-U,20140709
EP-2060396-B1,20100929
JP-5094281-B2,20121212
CN-202309349-U,20120704
ES-2399998-T3,20130404
CN-203953961-U,20141126
EP-2384771-B1,20130123
JP-5400994-B2,20140129
KR-101161137-B1,20120702
CN-201770958-U,20110323
US-8058883-B2,20111115
CN-203557466-U,20140423
EP-1979895-B1,20131009
CN-202344020-U,20120725
CN-203920796-U,20141105
CN-203265043-U,20131106
CN-203348719-U,20131218
CN-201534006-U,20100728
CN-201662302-U,20101201
JP-4787078-B2,20111005
JP-5142712-B2,20130213
CN-203999256-U,20141210
US-8548365-B2,20131001
CN-202833828-U,20130327
EP-1627846-B1,20100203
GB-
Query:
SELECT "publication_number", "filing_date" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-
Query:
SELECT "publication_number", "cited_by" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cited_by
CA-27-A,[]
ES-81-Y,[]
DE-303-C,[]
ES-866-Y,[]
FI-150-A,[]
FI-250-A,[]
FR-336-E,[]
NL-284-C,[]
NL-947-C,[]
BE-107-T1,[]
CA-1911-A,[]
CA-4005-A,[]
CA-4106-A,[]
CA-4698-A,[]
CA-4801-A,[]
CA-5943-A,[]
CA-6183-A,[]
CA-6207-A,[]
CA-6390-A,[]
CA-6969-A,[]
CA-8931-S,[]
CA-9897-A,[]
DE-3129-C,[]
DE-3301-C,[]
DE-3884-C,[]
DE-3983-C,[]
DE-5976-C,[]
DK-2807-C,[]
DK-3080-C,[]
DK-3107-C,[]
DK-3184-C,[]
DK-3510-C,[]
DK-5867-C,[]
DK-5921-C,[]
DK-6491-A,[]
DK-7210-C,[]
DK-8069-C,[]
DK-8466-C,[]
DK-9281-C,[]
DK-9359-C,[]
ES-1062-U,[]
ES-1498-U,[]
ES-1524-Y,[]
ES-1872-U,[]
ES-2542-Y,[]
ES-2819-Y,[]
ES-2960-U,[]
ES-3045-U,[]
ES-4483-Y,[]
ES-4723-Y,[]
ES-4858-U,[]
ES-5089-Y,[]
ES-5219-Y,[]
ES-5716-U,[]
ES-5975-Y,[]
ES-6454-U,[]
ES-6552-Y,[]
ES-6928-Y,[]
ES-6962-Y,[]
ES-7086-Y,[]
ES-7407-Y,[]
ES-7489-Y,[]
ES-7516-U,[]
ES-7538-U,[]
ES-764-H3,[]
ES-8269-Y,[]
FI-1825-A,[]
FI-291-U1,[]
FI-3021-A,[]
FI-4211-A,[]
FI-4543-A,[]
FI-8034-A,[]
FI-8619-A,[]
FI-8985-A,[]
FI-902-U1,[]
FR-1186-E,[]
FR-1382-E,[]
FR-1550-M,[]
FR-2064-E,[]
FR-2510-M,[]
FR-2578-M,[]
FR-2635-E,[]
FR-3293-M,[]
FR-5174-E,[]
FR-5770-E,[]
FR-7085-M,[]
FR-7747-E,[]
FR-8053-M,[]
FR-8143-M,[]
NL-3613-C,[]
NL-4187-C,[]
NL-5034-C,[]
NL-9752-C,[]
NL-9761-C,[]
RU-815-U1,[]
US-1260-A,[]
US-1844-A,[]
US-3704-A,[]
US-4174-P,[]
US-4340-A,[]
US-4449-P,[]
US-4570-P,[]
US-5293-P,[]
US-5333-A,[]
US-5618-A,[]
US-6399-A,[]
US-6501-P,[]
US-7090-A,[]
US-7624-A,[]
US-7703-P,[]
US-7765-P,[]
US-8162-P,[]
US-8923-P,[]
US-9153-A,[]
US-9563-A,[]
US-H817-H,[]
CA-10240-A,[]
CA-10445-A,[]
CA-11856-A,[]
CA-12085-A,[]
CA-12299-A,[]
CA-12359-A,[]
CA-12986-A,[]
CA-14364-A,[]
CA-15108-A,[]
CA-15467-A,[]
CA-16464-A,[]
CA-16944-A,[]
CA-17107-A,[]
CA-18535-S,[]
CA-19006-S,[]
CA-21676-A,[]
CA-21706-A,[]
CA-21979-A,[]
CA-22497-S,[]
CA-22705-A,[]
CA-23044-A,[]
CA-25240-S,[]
CA-25587-A,[]
CA-26172-A,[]
CA-27810-A,[]
CA-29171-S,[]
CA-29565-A,[]
CA-30563-S,[]
CA-30747-A,[]
CA-31066-A,[]
CA-31656-A,[]
CA-34117-A,[]
CA-34328-A,[]
CA-35530-A,[]
CA-36126-A,[]
CA-37060-A,[]
CA-37412-A,[]
CA-38186-A,[]
CA-38290-A,[]
CA-38566-A,[]
CA-39941-A,[]
CA-41986-A,[]
CA-42957-A,[]
CA-43582-A,[]
CA-43613-A,[]
CA-43665-A,[]
CA-44103-A,[]
CA-44675-A,[]
CA-45114-S,[]
CA-45162-A,[]
CA-46041-S,[]
CA-46346-S,[]
CA-46414-S,[]
CA-46650-A,[]
CA-47228-S,[]
CA-47556-A,[]
CA-47943-A,[]
CA-48005-S,[]
CA-50059-A,[]
CA-51084-S,[]
CA-51448-A,[]
CA-53020-A,[]
CA-53342-A,[]
CA-53679-A,[]
CA-54019-A,[]
CA-56199-S,[]
CA-57871-A,[]
CA-58112-A,[]
CA-59658-S,[]
CA-62116-A,[]
CA-63512-A,[]
CA-64348-A,[]
CA-64895-A,[]
CA-64959-A,[]
CA-65051-A,[]
CA-65468-A,[]
CA-66408-A,[]
CA-67027-A,[]
CA-67256-A,[]
CA-68355-A,[]
CA-68561-A,[]
CA-69952-A,[]
CA-69969-A,[]
CA-70837-S,[]
CA-71352-A,[]
CA-72557-S,[]
CA-73229-S,[]
CA-73434-A,[]
CA-73648-A,[]
CA-75054-A,[]
CA-75833-A,[]
CA-75940-A,[]
CA-76442-A,[]
CA-77673-S,[]
CA-78154-A,[]
CA-78848-A,[]
CA-80485-S,[]
CA-81879-A,[]
CA-82735-A,[]
CA-83640-A,[]
CA-84428-S,[]
CA-84611-A,[]
CA-85458-S,[]
CA-87085-A,[]
CA-87655-A,[]
CA-88869-A,[]
CA-89598-S,[]
CA-90451-A,[]
CA-90703-A,[]
CA-91407-A,[]
CA-91839-A,[]
CA-92136-S,[]
CA-92671-S,[]
CA-93153-A,[]
CA-93847-S,[]
CA-94404-A,[]
CA-94834-A,[]
CA-95812-A,[]
CA-96813-A,[]
CA-97691-A,[]
CA-97784-A,[]
CA-98415-S,[]
CA-98613-A,[]
CA-98742-A,[]
CA-99391-S,[]
CA-99529-A,[]
DE-10599-C,[]
DE-10678-C,[]
DE-10717-C,[]
DE-12268-C,[]
DE-16453-C,[]
DE-17382-C,[]
DE-17635-C,[]
DE-18657-C,[]
DE-21533-C,[]
DE-21800-C,[]
DE-22191-C,[]
DE-24092-C,[]
DE-24550-C,[]
DE-26040-C,[]
DE-26251-C,[]
DE-26645-C,[]
DE-27162-C,[]
DE-28245-C,[]
DE-28664-C,[]
DE-29317-C,[]
DE-29580-C,[]
DE-29751-C,[]
DE-29873-C,[]
DE-34701-C,[]
DE-35759-C,[]
DE-36143-C,[]
DE-36572-C,[]
DE-36880-C,[]
DE-37006-C,[]
DE-39978-C,[]
DE-41212-C,[]
DE-41909-C,[]
DE-43016-C,[]
DE-43252-C,[]
DE-43745-C,[]
DE-44221-C,[]
DE-44490-C,[]
DE-46714-C,[]
DE-46729-C,[]
DE-46866-C,[]
DE-47512-C,[]
DE-48016-C,[]
DE-48200-C,[]
DE-48281-C,[]
DE-48415-C,[]
DE-48624-C,[]
DE-48946-C,[]
DE-55522-C,[]
DE-57100-C,[]
DE-59206-C,[]
DE-62156-C,[]
DE-62668-C,[]
DE-64182-C,[]
DE-64466-C,[]
DE-68843-C,[]
DE-69224-C,[]
DE-69735-C,[]
DE-70329-C,[]
DE-70421-C,[]
DE-70605-C,[]
DE-71525-C,[]
DE-72135-C,[]
DE-72417-C,[]
DE-73920-C,[]
DE-75006-C,[]
DE-75333-C,[]
DE-78770-C,[]
DE-82929-C,[]
DE-83658-C,[]
DE-83966-C,[]
DE-84792-C,[]
DE-87929-C,[]
DE-90760-C,[]
DE-91921-C,[]
DE-92960-C,[]
DE-93320-C,[]
DE-93611-C,[]
DE-94567-C,[]
DE-96265-C,[]
DE-97461-C,[]
DE-98822-C,[]
DK-10751-C,[]
DK-11017-C,[]
DK-11274-A,[]
DK-11549-C,[]
DK-13429-C,[]
DK-14113-C,[]
DK-15486-A,[]
DK-15672-C,[]
DK-16003-C,[]
DK-16200-C,[]
DK-16721-C,[]
DK-17077-C,[]
DK-17891-C,[]
DK-18174-A,[]
DK-18287-C,[]
DK-18953-C,[]
DK-19067-C,[]
DK-20848-C,[]
DK-21534-C,[]
DK-21593-C,[]
DK-24093-C,[]
DK-24122-C,[]
DK-24560-C,[]
DK-24764-C,[]
DK-25033-C,[]
DK-26002-C,[]
DK-28460-C,[]
DK-30663-C,[]
DK-31338-C,[]
DK-32802-C,[]
DK-32923-C,[]
DK-32960-C,[]
DK-33342-C,[]
DK-33585-C,[]
DK-34417-C,[]
DK-34475-A,[]
DK-34847-C,[]
DK-3485-D0,[]
DK-35287-A,[]
DK-35387-A,[]
DK-36818-C,[]
DK-
Query:
SELECT 
     t."publication_number", 
     f.value::STRING AS "cited_by_publication_number" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
        LATERAL FLATTEN(input => t."cited_by") f 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cited_by_publication_number
US-875395-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3131514-A"",""type"":""""}"
DE-460919-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-968296-C"",""type"":""""}"
DE-752022-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3346037-A"",""type"":""""}"
DE-957646-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-1181637-B"",""type"":""""}"
US-2063551-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4945253-A"",""type"":""""}"
US-1671917-A,"{""application_number"":"""",""category"":""PRS"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2011293380-A1"",""type"":""""}"
US-2334161-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2667284-A"",""type"":""""}"
US-1246221-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3762528-A"",""type"":""""}"
US-768727-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4168809-A"",""type"":""""}"
DE-963253-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-1134440-B"",""type"":""""}"
US-192092-A,"{""application_number"":"""",""category"":""PRS"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2007030943-A1"",""type"":""""}"
US-3544242-A,"{""application_number"":"""",""category"":""ISR"",""filing_date"":0,""npl_text"":"""",""publication_number"":""WO-2017133281-A1"",""type"":""X""}"
US-1536267-A,"{""application_number"":"""",""category"":""APP"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-7140148-B1"",""type"":""""}"
DE-201246-C,"{""application_number"":"""",""category"":""APP"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-6899907-B1"",""type"":""""}"
US-1375598-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4502500-A"",""type"":""""}"
US-3370936-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3849112-A"",""type"":""""}"
CA-534930-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3322118-A"",""type"":""""}"
US-1448365-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2789086-A"",""type"":""""}"
US-1030907-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3509618-A"",""type"":""""}"
US-1831357-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""DE-1235541-B"",""type"":""""}"
US-2762081-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3021255-A"",""type"":""""}"
US-815363-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4632761-A"",""type"":""""}"
US-257973-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4611716-A"",""type"":""""}"
US-3538157-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-4401780-A"",""type"":""""}"
CA-671728-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3298363-A"",""type"":""""}"
US-2132921-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3289126-A"",""type"":""""}"
US-910084-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2728987-A"",""type"":""""}"
DE-254654-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3414359-A"",""type"":""""}"
US-1454341-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2720211-A"",""type"":""""}"
US-1041006-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-3355783-A"",""type"":""""}"
US-1044437-A,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_number"":""US-2596910-A"",""type"":""""}"
DE-258831-C,"{""application_number"":"""",""category"":""SEA"",""filing_date"":0,""npl_text"":"""",""publication_numb
Query:
SELECT "publication_number", "embedding_v1" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 
Query:
SELECT 
     p."publication_number", 
     p."filing_date", 
     a."embedding_v1" 
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
   INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
     ON p."publication_number" = a."publication_number" 
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date,embedding_v1
CA-27-A,0,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,19291217,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,0,[]
ES-866-Y,19320407,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.64
Query:
SELECT 
      p."publication_number", 
      p."filing_date", 
      a."embedding_v1" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
    INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
      ON p."publication_number" = a."publication_number" 
    WHERE p."filing_date" BETWEEN 20120101 AND 20121231 
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date,embedding_v1
US-D686406-S,20120510,"[
  -1.503766800000000e-02,
  -3.119330000000000e-01,
  -2.149303400000000e-01,
  -2.103819400000000e-01,
  -1.376698600000000e-01,
  -2.563466700000000e-01,
  -1.458266000000000e-01,
  -8.732291000000000e-02,
  4.466908000000000e-02,
  -3.271143000000000e-01,
  -3.157764000000000e-03,
  3.386559300000000e-02,
  2.447655600000000e-01,
  5.202678000000000e-02,
  -7.615336000000000e-02,
  4.359198000000000e-02,
  1.269905300000000e-01,
  -1.272555700000000e-01,
  -8.923966400000000e-02,
  7.447965400000000e-03,
  -2.062326000000000e-02,
  2.237342500000000e-02,
  -3.331764400000000e-02,
  8.527288600000001e-02,
  6.122692300000000e-02,
  4.627490000000000e-02,
  7.641771999999999e-02,
  3.524680800000000e-02,
  1.193518640000000e-01,
  9.382409999999999e-02,
  -2.004328000000000e-02,
  1.994392100000000e-01,
  6.403068500000000e-02,
  -2.204417600000000e-01,
  -1.119889100000000e-01,
  -2.197366800000000e-01,
  5.287633000000000e-03,
  -9.199329000000001e-02,
  6.896515000000000e-02,
  9.779547000000000e-02,
  -8.363107000000000e-02,
  -6.480062000000000e-02,
  1.260861500000000e-01,
  -5.653400300000000e-02,
  -7.196350400000000e-02,
  -9.437039500000000e-02,
  5.502897000000000e-02,
  -6.934184000000000e-02,
  -4.768358000000000e-02,
  -1.524096100000000e-01,
  -1.562575700000000e-01,
  -5.917117400000000e-02,
  -7.497550500000000e-02,
  7.109153000000000e-02,
  -1.263489600000000e-01,
  6.490047000000000e-03,
  -1.872070100000000e-01,
  5.158940000000000e-03,
  9.782600000000000e-02,
  1.385354800000000e-01,
  -1.205637300000000e-01,
  2.094933000000000e-01,
  2.909245700000000e-02,
  1.990190500000000e-02
]"
US-D695024-S,20120711,"[
  -1.181458900000000e-02,
  -2.965099500000000e-01,
  -1.497571900000000e-01,
  -1.599657500000000e-01,
  -1.652039400000000e-01,
  -1.967024700000000e-01,
  -1.396702500000000e-01,
  -1.772636900000000e-01,
  1.620531800000000e-02,
  -3.568597700000000e-01,
  8.072954000000000e-03,
  -2.753459700000000e-02,
  1.688586300000000e-01,
  2.002250800000000e-02,
  -3.473421000000000e-02,
  -5.449174300000000e-02,
  9.312547000000000e-02,
  -1.535499200000000e-01,
  -1.446259900000000e-01,
  4.944423200000000e-02,
  1.645438700000000e-02,
  -3.902551000000000e-02,
  -2.109913700000000e-02,
  3.467744600000000e-02,
  1.380163300000000e-01,
  7.252678000000000e-02,
  1.563998000000000e-01,
  -4.075078000000000e-02,
  2.129636100000000e-01,
  5.509719300000000e-02,
  1.617461800000000e-02,
  1.331511100000000e-01,
  1.001959400000000e-02,
  -2.382915500000000e-01,
  -6.539947500000000e-02,
  -2.138463900000000e-01,
  -5.861050600000000e-02,
  -7.940677000000000e-02,
  3.237951000000000e-02,
  4.353514700000000e-02,
  -7.473980000000000e-02,
  4.390830000000000e-02,
  3.142716400000000e-02,
  1.276574900000000e-02,
  -9.929346999999999e-02,
  -1.107905900000000e-01,
  5.035261800000000e-02,
  -1.593732100000000e-01,
  -5.078559700000000e-02,
  -1.152881000000000e-01,
  -1.421779800000000e-01,
  -1.494841700000000e-01,
  -1.289417400000000e-01,
  6.673875000000000e-02,
  -8.723056000000000e-02,
  -6.973574000000000e-02,
  -1.821464900000000e-01,
  -1.326980800000000e-02,
  1.325164000000000e-01,
  1.573602300000000e-01,
  -1.021444000000000e-01,
  2.297445000000000e-01,
  -1.452806400000000e-02,
  -1.513769100000000e-02
]"
CN-102582151-A,20120210,"[
  9.935207000000000e-02,
  -2.965937200000000e-02,
  -1.872762300000000e-01,
  1.974629300000000e-01,
  -1.530134200000000e-01,
  6.411367000000000e-02,
  -1.513790500000000e-01,
  1.382584000000000e-01,
  1.641116900000000e-01,
  -1.735723300000000e-01,
  1.020542800000000e-01,
  2.067769200000000e-01,
  1.092429700000000e-01,
  -6.159592800000000e-02,
  -7.489670000000000e-02,
  1.190694650000000e-01,
  -2.554188000000000e-02,
  -1.270228900000000e-02,
  7.363427000000000e-02,
  1.050589000000000e-01,
  2.071593700000000e-01,
  1.005639000000000e-01,
  -6.270960000000000e-02,
  4.955024000000000e-02,
  5.463313000000000e-02,
  -1.420007200000000e-02,
  1.344795000000000e-01,
  -4.051733800000000e-02,
  3.570080000000000e-02,
  -1.717809600000000e-02,
  1.012267000000000e-01,
  1.322158000000000e-01,
  8.259886000000000e-02,
  -1.950780300000000e-01,
  7.556661000000001e-02,
  -6.371056999999999e-02,
  -1.966576700000000e-02,
  -1.961409400000000e-01,
  -1.390397400000000e-01,
  2.124205500000000e-01,
  8.897847000000000e-02,
  4.978589700000000e-02,
  2.016462700000000e-01,
  1.474400900000000e-01,
  -3.813900400000000e-02,
  -1.799577000000000e-02,
  3.592952000000000e-02,
  -1.303800000000000e-01,
  -6.684045499999999e-02,
  -1.421922600000000e-01,
  -3.330913500000000e-01,
  -1.023436150000000e-02,
  -3.134109000000000e-02,
  -1.009312400000000e-01,
  -2.746858800000000e-02,
  -1.277605300000000e-01,
  -1.264122900000000e-01,
  5.226337500000000e-02,
  2.309033900000000e-01,
  2.671812500000000e-01,
  2.717423800000000e-02,
  1.520399700000000e-02,
  6.670042599999999e-04
Query:
SELECT 
      "publication_number", 
      "country_code", 
      "kind_code", 
      "grant_date" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS 
    WHERE "country_code" = 'US' 
      AND "kind_code" LIKE '%B2%' 
      AND "grant_date" BETWEEN 20100101 AND 20141231 
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,country_code,kind_code,grant_date
US-8898436-B2,US,B2,20141125
US-7647288-B2,US,B2,20100112
US-7827217-B2,US,B2,20101102
US-8793381-B2,US,B2,20140729
US-8306362-B2,US,B2,20121106
US-8886182-B2,US,B2,20141111
US-8761223-B2,US,B2,20140624
US-8363444-B2,US,B2,20130129
US-8017772-B2,US,B2,20110913
US-8068772-B2,US,B2,20111129
US-8272705-B2,US,B2,20120925
US-8755917-B2,US,B2,20140617
US-8702115-B2,US,B2,20140422
US-7941073-B2,US,B2,20110510
US-8614881-B2,US,B2,20131224
US-8514326-B2,US,B2,20130820
US-8656204-B2,US,B2,20140218
US-8222155-B2,US,B2,20120717
US-8098275-B2,US,B2,20120117
US-8853374-B2,US,B2,20141007
US-8263057-B2,US,B2,20120911
US-8457657-B2,US,B2,20130604
US-8858390-B2,US,B2,20141014
US-8902701-B2,US,B2,20141202
US-8836621-B2,US,B2,20140916
US-8130625-B2,US,B2,20120306
US-8846234-B2,US,B2,20140930
US-7846394-B2,US,B2,20101207
US-8087045-B2,US,B2,20111227
US-8684320-B2,US,B2,20140401
US-8639874-B2,US,B2,20140128
US-8527303-B2,US,B2,20130903
US-8697506-B2,US,B2,20140415
US-8779491-B2,US,B2,20140715
US-8622869-B2,US,B2,20140107
US-8194070-B2,US,B2,20120605
US-8618832-B2,US,B2,20131231
US-8303190-B2,US,B2,20121106
US-7869016-B2,US,B2,20110111
US-8609823-B2,US,B2,20131217
US-8717022-B2,US,B2,20140506
US-8843939-B2,US,B2,20140923
US-8144627-B2,US,B2,20120327
US-8631198-B2,US,B2,20140114
US-8764962-B2,US,B2,20140701
US-8563362-B2,US,B2,20131022
US-7836829-B2,US,B2,20101123
US-8503430-B2,US,B2,20130806
US-7813884-B2,US,B2,20101012
US-8539588-B2,US,B2,20130917
US-8898576-B2,US,B2,20141125
US-8694495-B2,US,B2,20140408
US-8479056-B2,US,B2,20130702
US-8450859-B2,US,B2,20130528
US-8021293-B2,US,B2,20110920
US-8436539-B2,US,B2,20130507
US-8899209-B2,US,B2,20141202
US-8499502-B2,US,B2,20130806
US-8207994-B2,US,B2,20120626
US-7932928-B2,US,B2,20110426
US-8768937-B2,US,B2,20140701
US-8527172-B2,US,B2,20130903
US-7916232-B2,US,B2,20110329
US-8179406-B2,US,B2,20120515
US-8512590-B2,US,B2,20130820
US-8597297-B2,US,B2,20131203
US-8195593-B2,US,B2,20120605
US-8043863-B2,US,B2,20111025
US-8298048-B2,US,B2,20121030
US-8468999-B2,US,B2,20130625
US-8563604-B2,US,B2,20131022
US-8388547-B2,US,B2,20130305
US-7919127-B2,US,B2,20110405
US-7960124-B2,US,B2,20110614
US-8360677-B2,US,B2,20130129
US-8120188-B2,US,B2,20120221
US-8510585-B2,US,B2,20130813
US-7972997-B2,US,B2,20110705
US-8345648-B2,US,B2,20130101
US-8907742-B2,US,B2,20141209
US-8358913-B2,US,B2,20130122
US-8715559-B2,US,B2,20140506
US-8255820-B2,US,B2,20120828
US-8921814-B2,US,B2,20141230
US-8734946-B2,US,B2,20140527
US-8817655-B2,US,B2,20140826
US-8470068-B2,US,B2,20130625
US-7719769-B2,US,B2,20100518
US-8796427-B2,US,B2,20140805
US-8123887-B2,US,B2,20120228
US-8753121-B2,US,B2,20140617
US-8024580-B2,US,B2,20110920
US-8010597-B2,US,B2,20110830
US-7682634-B2,US,B2,20100323
US-8809215-B2,US,B2,20140819
US-8731448-B2,US,B2,20140520
US-8366022-B2,US,B2,20130205
US-8508915-B2,US,B2,20130813
US-8230022-B2,US,B2,20120724
US-8668263-B2,US,B2,20140311
US-8400201-B2,US,B2,20130319
US-8909532-B2,US,B2,20141209
US-7904392-B2,US,B2,20110308
US-8429213-B2,US,B2,20130423
US-7703739-B2,US,B2,20100427
US-8516790-B2,US,B2,20130827
US-7902735-B2,US,B2,20110308
US-8257311-B2,US,B2,20120904
US-8818475-B2,US,B2,20140826
US-8816690-B2,US,B2,20140826
US-7800202-B2,US,B2,20100921
US-7937342-B2,US,B2,20110503
US-8595433-B2,US,B2,20131126
US-8834913-B2,US,B2,20140916
US-7947532-B2,US,B2,20110524
US-8018507-B2,US,B2,20110913
US-8436157-B2,US,B2,20130507
US-8277945-B2,US,B2,20121002
US-7928235-B2,US,B2,20110419
US-8099028-B2,US,B2,20120117
US-8372978-B2,US,B2,20130212
US-7998666-B2,US,B2,20110816
US-8064292-B2,US,B2,20111122
US-8206740-B2,US,B2,20120626
US-8537082-B2,US,B2,20130917
US-8058876-B2,US,B2,20111115
US-8257841-B2,US,B2,20120904
US-8246978-B2,US,B2,20120821
US-8616292-B2,US,B2,20131231
US-8815476-B2,US,B2,20140826
US-8726198-B2,US,B2,20140513
US-8277534-B2,US,B2,20121002
US-8862262-B2,US,B2,20141014
US-7756270-B2,US,B2,20100713
US-8313878-B2,US,B2,20121120
US-7824486-B2,US,B2,20101102
US-8687170-B2,US,B2,20140401
US-8563509-B2,US,B2,20131022
US-7989172-B2,US,B2,20110802
US-8136703-B2,US,B2,20120320
US-7852716-B2,US,B2,20101214
US-7818987-B2,US,B2,20101026
US-7885873-B2,US,B2,20110208
US-8043372-B2,US,B2,20111025
US-8146530-B2,US,B2,20120403
US-7755655-B2,US,B2,20100713
US-8518710-B2,US,B2,20130827
US-7871625-B2,US,B2,20110118
US-7701466-B2,US,B2,20100420
US-7854621-B2,US,B2,20101221
US-8246536-B2,US,B2,20120821
US-7746216-B2,US,B2,20100629
US-8907126-B2,US,B2,20141209
US-7831285-B2,US,B2,20101109
US-8912169-B2,US,B2,20141216
US-8865633-B2,US,B2,20141021
US-8725194-B2,US,B2,20140513
US-8049207-B2,US,B2,20111101
US-8784346-B2,US,B2,20140722
US-8543120-B2,US,B2,20130924
US-8052184-B2,US,B2,20111108
US-8267507-B2,US,B2,20120918
US-7904039-B2,US,B2,20110308
US-7997500-B2,US,B2,20110816
US-7691593-B2,US,B2,20100406
US-7661757-B2,US,B2,20100216
US-8051283-B2,US,B2,20111101
US-7989978-B2,US,B2,20110802
US-8003821-B2,US,B2,20110823
US-7796108-B2,US,B2,20100914
US-8691516-B2,US,
Query:
SELECT 
      t."publication_number", 
      COUNT(f.value) AS "forward_citation_count" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t, 
         LATERAL FLATTEN(input => t."cited_by") f 
    GROUP BY t."publication_number" 
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,forward_citation_count
DE-945915-C,1
US-5439656-A,1
US-2206400-A,1
US-506043-A,1
US-2056199-A,1
US-2873084-A,1
US-3394764-A,1
US-2126477-A,1
US-3781392-A,1
US-4868125-A,1
US-931503-A,1
US-1996199-A,1
US-1099037-A,1
US-1537450-A,1
US-2268951-A,1
CA-550117-A,1
US-2581468-A,1
US-1937996-A,1
US-476288-A,1
US-1961124-A,1
US-D351659-S,1
BE-649204-A,1
RU-2418591-C1,1
KR-101217759-B1,1
US-1029876-A,1
US-2920596-A,1
US-2124257-A,1
US-1126741-A,1
US-224442-A,1
DE-1219056-B,1
DE-1064432-B,1
EP-0123387-B1,1
DE-8716925-U1,1
DE-9217169-U1,1
DE-7912838-U1,1
DE-202011100575-U1,1
RU-2123191-C1,1
RU-2107675-C1,1
RU-2524343-C1,1
KR-101420653-B1,1
CN-201054068-Y,1
CN-2362707-Y,1
CN-2817382-Y,1
CN-105306690-A,1
CN-103007240-A,1
US-1339421-A,1
CN-2346747-Y,1
CN-2425568-Y,1
CN-102277763-A,1
CN-104068564-A,1
CN-102785781-A,1
CN-205062267-U,1
CN-204842658-U,1
CN-2040391-U,1
GB-239694-A,1
DE-102006053790-A1,1
DE-102007034869-A1,1
US-2002066794-A1,1
DE-2339054-A1,1
DE-2202230-A1,1
JP-3057649-U,1
US-1143324-A,1
US-2548486-A,1
EP-0178266-B1,1
US-156615-A,1
US-703221-A,1
US-1798870-A,1
US-613890-A,1
US-D716943-S,1
EP-1328765-B1,1
DE-1998138-U,1
DE-20318902-U1,1
DE-7630389-U1,1
BE-650914-A,1
RU-2127243-C1,1
KR-100491972-B1,1
CN-201022948-Y,1
CN-201341831-Y,1
CN-201358972-Y,1
CN-2548135-Y,1
CN-2147063-Y,1
CN-2927615-Y,1
CN-2709914-Y,1
CN-201141832-Y,1
CN-101837299-A,1
CN-101648993-A,1
CN-101456654-A,1
CN-1895970-A,1
CN-1137862-A,1
CN-102475360-A,1
CN-1619371-A,1
CN-1112590-C,1
DE-1729657-U,1
CN-2880879-Y,1
CN-2247439-Y,1
CN-2484753-Y,1
CN-101549911-A,1
CN-102205823-A,1
CN-1880126-A,1
CN-101256704-A,1
CN-101535972-A,1
CN-102296209-A,1
CN-102153381-A,1
CN-1745327-A,1
CN-102299015-A,1
CN-202298015-U,1
CN-203633195-U,1
CN-205322386-U,1
CN-205551308-U,1
CN-205645531-U,1
CN-201967517-U,1
CN-203621208-U,1
CN-201484197-U,1
CN-204532283-U,1
CN-204608791-U,1
DE-19653542-B4,1
GB-1033129-A,1
GB-1510831-A,1
GB-546559-A,1
GB-255980-A,1
RU-70352-U1,1
DE-102007061055-A1,1
US-2002028791-A1,1
US-2014181912-A1,1
US-2008311426-A1,1
US-2008130636-A1,1
US-2005187909-A1,1
US-2006036497-A1,1
DE-1703147-A1,1
DE-2133395-B2,1
DE-2262986-B2,1
JP-2657655-B2,1
JP-4839468-B2,1
JP-S62197712-A,1
JP-S57174251-A,1
JP-S61102443-A,1
JP-S5186027-A,1
JP-2012189912-A,1
CN-204886188-U,1
GB-583850-A,1
GB-1451185-A,1
GB-1222720-A,1
US-2013028550-A1,1
US-2015180101-A1,1
JP-S4729986-B1,1
JP-4537542-B2,1
JP-2003055950-A,1
GB-2005615-A,1
DE-3829797-A1,1
JP-H09308374-A,1
DE-4740-C,1
EP-0441071-B1,1
KR-101079975-B1,1
CN-2774155-Y,1
CN-104354672-A,1
CN-105569753-A,1
CN-103471065-A,1
CN-103216961-A,1
KR-101299989-B1,1
GB-191018027-A,1
DE-69724110-T2,1
CN-102971091-A,1
CN-105335995-A,1
CN-102426736-A,1
CN-103273758-A,1
CN-105733273-A,1
CN-102351105-A,1
CN-202868560-U,1
CN-206086230-U,1
CN-203580038-U,1
CN-204286983-U,1
CN-202179681-U,1
CN-202984967-U,1
CN-204126822-U,1
CN-203797583-U,1
CN-203499363-U,1
CN-204577491-U,1
CN-202127805-U,1
CN-203570169-U,1
KR-200454619-Y1,1
CA-2839491-A1,1
GB-165248-A,1
GB-1111206-A,1
GB-231863-A,1
GB-1446873-A,1
GB-519477-A,1
GB-2169790-A,1
GB-1289971-A,1
DE-102004017673-A1,1
DE-102007030019-A1,1
US-2015344942-A1,1
US-2013011751-A1,1
US-2005151924-A1,1
US-2013256445-A1,1
US-2010175681-A1,1
US-2014335325-A1,1
US-2009208764-A1,1
DE-19957935-A1,1
DE-10223377-A1,1
DE-3706768-A1,1
DE-2545805-A1,1
DE-19929530-A1,1
JP-3078187-U,1
EP-0344365-A3,1
JP-S4923923-B1,1
JP-4088937-B2,1
JP-3432192-B2,1
JP-5774212-B2,1
JP-3399933-B2,1
JP-2010216504-A,1
JP-S4976311-A,1
JP-S4969834-A,1
JP-H05150642-A,1
JP-S56155277-A,1
JP-2007321082-A,1
JP-H0456152-A,1
CN-203216544-U,1
KR-200185653-Y1,1
GB-2227336-A,1
GB-321895-A,1
US-2016180398-A1,1
DE-10042858-A1,1
DE-3306410-A1,1
DE-2547936-B2,1
JP-3709815-B2,1
JP-2007107079-A,1
DE-102006001188-A1,1
US-2015200574-A1,1
JP-4242401-B2,1
JP-2001106996-A,1
CN-104542391-A,1
KR-100805224-B1,1
CN-205058653-U,1
CN-201910127-U,1
CN-202853205-U,1
CN-203977157-U,1
DE-2251304-A1,1
JP-S5047506-A,1
JP-2015014690-A,1
JP-H1020280-A,1
US-2013286506-A1,1
JP-H07166071-A,1
CN-202490201-U,1
US-20054-A,1
CA-620630-A,1
BE-528196-A,1
CA-981169-A,1
DE-510279-C,1
DE-585723-C,1
DE-964911-C,1
NL-10194-C,1
DE-512603-C,1
DE-597097-C,1
FR-540984-A,1
FR-818236-A,1
FR-871186-A,1
DE-878032-C,1
DE-963589-C,1
FR-432355-A,1
FR-969445-A,1
GB-103963-A,1
GB-144874-A,1
GB-155610-A,1
GB-181570-A,1
US-242414-A,1
US-348920-A,1
US-387794-A,1
US-479920-A,1
US-693633-A,1
US-694059-A,1
US-710492-A,1
CA-1038554-A,1
CA-1047561-A,1
CN-1843834-A,1
CN-1908517-A,1
CN-2153721-Y,1
CN-2286398-Y,1
CN-2499532-Y,1
CN-2526917-Y,1
CN-2775531-Y,1
US-750861-A,1
CA-1073895-A,1
CN-1452773-A,1
CN-1883154-A,1
CN-2130062-Y,1
CN-2543480-Y,1
DE-1030049-B,1
DE-1713760-U,1
DE-1825216-U,1
DE-1839439-U,1
DE-6753005-U,1
FR-1368396-A,1
FR-1397525-A,1
FR-1521166-A,1
FR-1584610-A,1
GB-1577711-A,1
GB-1583165-A,1
GB-2003691-A,1
GB-2259184-B,1
GB-2353013-B,1
GB-2428358-B,1
GB-2452058-A,1
GB-2519587-A,1
JP-3137031-U,1
JP-S605098-A,1
US-1097840-A,1
US-1195015-A,1
US-1274451-A,1
US-1394436-A,1
US-1558588-A,
Query:
SELECT 
    p."publication_number", 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    COUNT(f.value) AS "forward_citation_count" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
GROUP BY p."publication_number", "filing_date_converted"
LIMIT 1000;
Answer:
100097 (22007): 01b9d4eb-0004-7b17-0001-11c300f0746e: Can't parse '0' as date with format 'YYYYMMDD'Query:
SELECT "publication_number", "country", "publication_description" 
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB 
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,country,publication_description
CA-27-A,CANADA,Patent
ES-81-Y,SPAIN,Utility model
DE-303-C,FEDERAL REPUBLIC GERMANY,Patent
ES-866-Y,SPAIN,Utility model
FI-150-A,FINLAND,Unexamined applic. Open to public Inspect
FI-250-A,FINLAND,Unexamined applic. Open to public Inspect
FR-336-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
NL-284-C,NETHERLANDS,Patent (third level of publication)
NL-947-C,NETHERLANDS,Patent (third level of publication)
BE-107-T1,BELGIUM,Patent of invention from EP in French [grant]
CA-1911-A,CANADA,Patent
CA-4005-A,CANADA,Patent
CA-4106-A,CANADA,Patent
CA-4698-A,CANADA,Patent
CA-4801-A,CANADA,Patent
CA-5943-A,CANADA,Patent
CA-6183-A,CANADA,Patent
CA-6207-A,CANADA,Patent
CA-6390-A,CANADA,Patent
CA-6969-A,CANADA,Patent
CA-8931-S,CANADA,Registered design
CA-9897-A,CANADA,Patent
DE-3129-C,FEDERAL REPUBLIC GERMANY,Patent
DE-3301-C,FEDERAL REPUBLIC GERMANY,Patent
DE-3884-C,FEDERAL REPUBLIC GERMANY,Patent
DE-3983-C,FEDERAL REPUBLIC GERMANY,Patent
DE-5976-C,FEDERAL REPUBLIC GERMANY,Patent
DK-2807-C,DENMARK,"Granted patent, first level"
DK-3080-C,DENMARK,"Granted patent, first level"
DK-3107-C,DENMARK,"Granted patent, first level"
DK-3184-C,DENMARK,"Granted patent, first level"
DK-3510-C,DENMARK,"Granted patent, first level"
DK-5867-C,DENMARK,"Granted patent, first level"
DK-5921-C,DENMARK,"Granted patent, first level"
DK-6491-A,DENMARK,"Patent application made available to the public, first level "
DK-7210-C,DENMARK,"Granted patent, first level"
DK-8069-C,DENMARK,"Granted patent, first level"
DK-8466-C,DENMARK,"Granted patent, first level"
DK-9281-C,DENMARK,"Granted patent, first level"
DK-9359-C,DENMARK,"Granted patent, first level"
ES-1062-U,SPAIN,Utility model application
ES-1498-U,SPAIN,Utility model application
ES-1524-Y,SPAIN,Utility model
ES-1872-U,SPAIN,Utility model application
ES-2542-Y,SPAIN,Utility model
ES-2819-Y,SPAIN,Utility model
ES-2960-U,SPAIN,Utility model application
ES-3045-U,SPAIN,Utility model application
ES-4483-Y,SPAIN,Utility model
ES-4723-Y,SPAIN,Utility model
ES-4858-U,SPAIN,Utility model application
ES-5089-Y,SPAIN,Utility model
ES-5219-Y,SPAIN,Utility model
ES-5716-U,SPAIN,Utility model application
ES-5975-Y,SPAIN,Utility model
ES-6454-U,SPAIN,Utility model application
ES-6552-Y,SPAIN,Utility model
ES-6928-Y,SPAIN,Utility model
ES-6962-Y,SPAIN,Utility model
ES-7086-Y,SPAIN,Utility model
ES-7407-Y,SPAIN,Utility model
ES-7489-Y,SPAIN,Utility model
ES-7516-U,SPAIN,Utility model application
ES-7538-U,SPAIN,Utility model application
ES-764-H3,SPAIN,Privilege of importation
ES-8269-Y,SPAIN,Utility model
FI-1825-A,FINLAND,Unexamined applic. Open to public Inspect
FI-291-U1,FINLAND,Granted utility model 
FI-3021-A,FINLAND,Unexamined applic. Open to public Inspect
FI-4211-A,FINLAND,Unexamined applic. Open to public Inspect
FI-4543-A,FINLAND,Unexamined applic. Open to public Inspect
FI-8034-A,FINLAND,Unexamined applic. Open to public Inspect
FI-8619-A,FINLAND,Unexamined applic. Open to public Inspect
FI-8985-A,FINLAND,Unexamined applic. Open to public Inspect
FI-902-U1,FINLAND,Granted utility model 
FR-1186-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-1382-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-1550-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-2064-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-2510-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-2578-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-2635-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-3293-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-5174-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-5770-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-7085-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-7747-E,FRANCE,Certificate of addition to a patent of invention ( First publication)
FR-8053-M,FRANCE,Special patent for medicament ( Fisrt publication)
FR-8143-M,FRANCE,Special patent for medicament ( Fisrt publication)
NL-3613-C,NETHERLANDS,Patent (third level of publication)
NL-4187-C,NETHERLANDS,Patent (third level of publication)
NL-5034-C,NETHERLANDS,Patent (third level of publication)
NL-9752-C,NETHERLANDS,Patent (third level of publication)
NL-9761-C,NETHERLANDS,Patent (third level of publication)
RU-815-U1,RUSSIAN FEDERATION,Certificate for utility model
US-1260-A,USA,Patent
US-1844-A,USA,Patent
US-3704-A,USA,Patent
US-4174-P,USA,Plant patent
US-4340-A,USA,Patent
US-4449-P,USA,Plant patent
US-4570-P,USA,Plant patent
US-5293-P,USA,Plant patent
US-5333-A,USA,Patent
US-5618-A,USA,Patent
US-6399-A,USA,Patent
US-6501-P,USA,Plant patent
US-7090-A,USA,Patent
US-7624-A,USA,Patent
US-7703-P,USA,Plant patent
US-7765-P,USA,Plant patent
US-8162-P,USA,Plant patent
US-8923-P,USA,Plant patent
U
Query:
SELECT 
    p."publication_number", 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
    a."embedding_v1" 
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p 
INNER JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a 
    ON p."publication_number" = a."publication_number" 
WHERE TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
  AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') BETWEEN TO_DATE('20120101', 'YYYYMMDD') AND TO_DATE('20121231', 'YYYYMMDD')
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date_converted,embedding_v1
US-8976583-B2,2012-09-06,"[
  -1.059306560000000e-01,
  -1.262364500000000e-01,
  -1.222046000000000e-01,
  -5.713473000000000e-03,
  -3.112821600000000e-01,
  -9.113502499999999e-02,
  1.252987000000000e-01,
  -1.311189100000000e-01,
  5.866532400000000e-02,
  -1.042737960000000e-01,
  -9.591958500000001e-03,
  1.277630800000000e-01,
  -5.473983000000000e-03,
  4.258953800000000e-02,
  -1.794493600000000e-01,
  -6.368514000000000e-02,
  2.016306200000000e-01,
  -9.080313000000000e-03,
  -1.207415400000000e-01,
  9.736188000000000e-02,
  2.105227400000000e-01,
  -6.499009000000000e-02,
  -1.577425300000000e-01,
  -5.875627700000000e-02,
  4.438163000000000e-02,
  -6.790697000000000e-02,
  2.805841300000000e-01,
  4.398754000000000e-02,
  7.193668000000000e-02,
  5.187504000000000e-02,
  -6.012163300000000e-02,
  -7.575588000000000e-02,
  4.254520700000000e-02,
  2.264518100000000e-02,
  -1.813370900000000e-01,
  -1.035830500000000e-01,
  1.200569900000000e-01,
  -2.413551400000000e-01,
  3.464020800000000e-02,
  2.453696400000000e-02,
  4.662365000000000e-02,
  -8.345770000000000e-02,
  3.225671000000000e-01,
  -7.194141000000000e-02,
  -1.982019700000000e-01,
  -6.159182600000000e-02,
  -1.336521800000000e-01,
  2.218222800000000e-01,
  1.134497300000000e-01,
  4.595112400000000e-02,
  -6.320264000000000e-02,
  9.381630000000001e-02,
  -1.904578100000000e-02,
  1.447700100000000e-01,
  6.917448000000000e-02,
  4.715478400000000e-02,
  6.647333499999999e-02,
  8.223928000000000e-03,
  -1.777091800000000e-01,
  2.004187900000000e-01,
  -4.368481000000000e-02,
  5.694804300000000e-02,
  1.655298300000000e-02,
  1.346571600000000e-01
]"
US-9128520-B2,2012-03-30,"[
  1.227834200000000e-01,
  -2.426595200000000e-01,
  1.407350000000000e-02,
  -2.969862100000000e-02,
  -1.245159500000000e-01,
  -6.332870600000000e-02,
  1.743330500000000e-01,
  3.009014800000000e-03,
  -2.149020900000000e-02,
  -8.626582500000000e-02,
  -1.139349700000000e-01,
  1.567300300000000e-01,
  1.731329600000000e-01,
  -1.227776260000000e-01,
  2.332043800000000e-03,
  1.982767400000000e-01,
  8.593608400000000e-02,
  3.854343300000000e-02,
  8.584078400000000e-02,
  1.287092300000000e-01,
  2.332509600000000e-01,
  1.956272900000000e-01,
  -1.039483700000000e-01,
  1.385736900000000e-01,
  1.535393300000000e-02,
  1.597823000000000e-02,
  2.255859700000000e-01,
  1.722682400000000e-01,
  2.410831900000000e-01,
  4.360464000000000e-02,
  1.923091000000000e-01,
  9.115708600000000e-02,
  -3.588060000000000e-02,
  1.874331200000000e-02,
  -1.539471900000000e-01,
  -1.922122200000000e-01,
  1.448280500000000e-01,
  -2.016079300000000e-01,
  -1.188004900000000e-01,
  4.086014000000000e-02,
  -1.526096500000000e-02,
  -7.925937000000000e-02,
  1.119586600000000e-01,
  1.437844600000000e-01,
  3.327048000000000e-02,
  -6.261936600000000e-02,
  2.153731400000000e-03,
  -1.443680500000000e-01,
  -2.487351600000000e-02,
  -1.389095800000000e-01,
  -9.440161000000000e-02,
  -1.634257000000000e-01,
  -3.107209300000000e-02,
  8.936854499999999e-02,
  -1.729532200000000e-01,
  1.060924800000000e-02,
  3.789154000000000e-02,
  7.221468000000000e-02,
  -1.170248500000000e-01,
  1.561160900000000e-02,
  -1.548781400000000e-02,
  2.585560700000000e-01,
  -9.488660000000000e-02,
  8.297217000000000e-02
]"
CN-102554192-A,2012-01-11,"[
  9.729161000000000e-02,
  -6.921700000000000e-02,
  1.321549000000000e-01,
  -5.172685500000000e-02,
  -8.973230400000000e-02,
  4.841761700000000e-02,
  -2.031060000000000e-02,
  2.436021500000000e-02,
  1.345232900000000e-01,
  7.950996600000000e-02,
  2.134805200000000e-01,
  -3.715940000000000e-02,
  7.307076999999999e-02,
  1.692644000000000e-01,
  -1.649943600000000e-01,
  -5.144033200000000e-02,
  4.260391700000000e-02,
  2.592668900000000e-02,
  5.061075000000000e-02,
  6.859679500000000e-02,
  -9.576303000000000e-02,
  3.218616000000000e-02,
  -1.945237700000000e-01,
  6.599735499999999e-02,
  -6.393476400000000e-03,
  -1.391660100000000e-01,
  1.489451000000000e-01,
  -4.562806000000000e-02,
  -3.905249800000000e-02,
  -8.654120600000000e-02,
  6.924638000000000e-02,
  1.509529000000000e-01,
  4.277788500000000e-02,
  -1.320579000000000e-01,
  1.402084700000000e-01,
  -2.132544700000000e-01,
  -1.303522400000000e-01,
  -1.163601350000000e-01,
  -7.662843000000000e-02,
  5.896943800000000e-02,
  -1.919887600000000e-02,
  -1.426459700000000e-01,
  7.312961000000000e-02,
  -1.889067700000000e-02,
  -1.253868800000000e-01,
  1.339132800000000e-01,
  1.435031400000000e-01,
  1.025413300000000e-01,
  -1.605322700000000e-01,
  -2.127045200000000e-01,
  -4.517932200000000e-01,
  3.785774500000000e-02,
  -4.968652500000000e-02,
  3.466812000000000e-03,
  1.520178600000000e-01,
  -1.054720400000000e-01,
  -1.557718200000000e-01,
  3.055583900000000e-02,
  1.057283200000000e-01,
  9.590116000000000e-02,
  4.408434400000000e-02,
  2.355160600000000e-01,
  -6.13968200000000
Query:
-- Corrected SQL for Query 1:
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
     LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000
Answer:
Too long, hard cut:
cpc_code
H04L5/001
H04L47/11
H04L47/10
G06F9/5038
G06F11/30
H01L2924/19041
B62D21/00
C07K16/32
E03D3/12
E04B1/24
F02F1/4214
E05C9/08
H04L2012/5616
G01N2021/8864
Y10S707/99934
G06F2201/86
B41J2202/21
H02H3/025
F02C7/05
D06F95/006
B61D7/20
Y10T137/87475
F02F1/242
H03H9/14505
B65D43/0212
C03C17/3649
C07D409/12
H05K2201/0209
C10G21/20
Y02B70/16
A01K5/0114
H01Q13/10
G01S3/8083
G06F12/1441
B01J20/08
B01J20/041
E21B41/005
A63B2071/024
G01S7/521
G06F11/348
C25D17/06
H05K2203/0207
A01N59/12
E21B10/20
H05K1/0243
G12B11/02
H02M3/33523
E21B10/22
B60W2520/10
H04N1/00612
H04M2250/02
C09K8/032
E21B37/04
G01D5/2497
A61L27/3641
H04B2203/5466
C09B44/101
H01F7/123
H04L1/1854
H01L29/42372
G01R22/066
H04L12/5885
H03L7/0814
G11C2029/5002
A61C5/70
H01L29/66666
H01L29/0649
Y10T428/24818
B23Q11/0042
F16H57/0478
A61B5/022
E04F15/105
B24D11/02
G11C11/5621
G06F2221/0737
B41J13/106
H01L51/0095
H01L51/006
H04N21/235
E06B2009/2622
B29C65/18
Y02W30/526
Y10S521/902
H01L29/42324
H04L1/0009
C11D3/10
B28B11/046
A23K50/15
H05B7/005
H05B2213/02
A01C7/20
B23K9/038
C07D213/12
C10M3/00
C10M2215/066
B60N2/449
H03F1/542
D06M7/00
B63H3/082
B65G19/22
H01J7/18
C10M2227/062
Y10S165/524
G02B6/3882
C08G2/16
C08B11/00
B67D9/02
C10M2219/022
C05C5/005
A61F13/266
B27K3/52
G01F3/36
F16C32/06
A01M7/0092
Y02W30/648
Y10T70/7881
B08B9/0936
B41B27/04
H01J25/10
Y10S505/702
A61F2002/30604
A61F2/44
B01D39/14
B29C55/00
H01J29/80
H04L5/12
B29C45/2737
C07C45/28
B01J2/00
F16D65/092
H01L2224/4569
H03M3/474
C23C14/06
G06F17/30247
Y02T10/44
H01M4/626
A63F13/80
B22F2003/185
H04L5/0035
H03H5/006
G01R31/2608
F02P5/1502
C09B67/00
B65G1/0435
B01J35/10
B23K2201/125
Y10S264/48
H01L21/28194
H04N21/4331
A61B2018/00886
H01L33/22
E04B2/46
B60N2/44
Y10S366/605
B31B2100/00
C11D1/65
C07D487/06
H04Q11/04
G02B6/3893
H04N1/41
A47L11/33
C07D213/82
H04N9/12
A61C3/06
G05D1/0883
H04N9/68
G01N15/1468
H01F41/041
C08K5/0066
H04N19/152
H04N1/64
H04M2250/12
Y02E20/12
G05D16/0683
Y10T137/7794
A63B2053/0491
Y10T70/5004
A23K20/00
Y10S514/908
G01N21/3563
B65G2201/0205
A01N65/44
C07D333/66
H04N1/00137
B65H59/28
F04B27/1054
B42C19/02
H01L31/02366
A61M1/1031
Y10T428/265
F23D14/78
C12N15/70
B42D2033/32
F01N3/2892
H01M10/6568
F24F2011/0063
B42P2261/04
G01F15/066
G10K2210/112
Y10T428/30
B42D25/455
B25J13/003
F15B13/0403
Y10S423/14
G03G15/087
F21V15/01
Y10T483/115
C08G59/245
Y02T10/7275
B60L2240/421
G06F9/5016
B60L11/1892
H04R2225/43
G06F9/542
Y02P20/124
Y02T50/62
Y02W10/18
B60B33/00
B60B37/10
B05B1/3046
Y02P10/265
H04L2209/08
H02K35/00
C08J2367/02
H04W72/042
A23C9/1512
A23V2002/00
Y10T156/13
C12M47/06
B21B1/463
C07C67/52
A63B2022/0094
A63B21/008
Y02P30/20
C07C37/08
B60R19/48
Y02T90/125
B60R16/03
E05B81/54
A61K9/1617
B23B2270/54
A61C17/02
C10M2207/289
C01P2004/61
H01L24/10
B62D55/30
C08J2207/04
A61F13/15747
H04L5/0055
A61M2207/00
A63B2220/40
E05B85/02
G05B2219/21119
G02B27/0994
B24D5/14
A61F2/1654
C02F1/26
A61C13/0004
H02G15/184
E04B2/7438
B22F3/105
A63B51/02
B23Q1/28
G11B7/08505
A61K8/0229
A61F2/0811
A61F2310/00299
B29C2045/2783
G01S13/70
C02F1/001
B29C65/564
F23D2700/033
F23D5/18
B01J2219/00554
C07D401/06
E06B9/68
C08F4/61912
C04B14/38
G11B21/083
B01J35/1047
H04W48/14
H02M7/08
A61F2310/00023
F05C2225/00
Y10T156/1095
B60Q1/085
A61F2002/30883
A47K3/40
E04C2/36
A61Q19/002
C07K1/047
Y10T428/162
G03G7/004
B29C43/46
B29C55/30
B65D83/228
D03D47/34
H02K49/046
B29C65/203
B60N2/3011
H04N1/4058
C22C14/00
B01J23/96
C07D211/46
C07K1/023
G11C16/32
B65G17/345
A01C17/008
D06F58/10
D04B35/02
B29L2030/007
H02K11/21
B60G15/068
C04B2111/00284
G03G15/0921
D21F5/021
F16F15/161
G01S1/026
C07C59/265
A61F13/476
C07K14/4726
G11C8/18
C23C28/42
F16D2065/785
G01C21/20
B27B27/08
G03G2221/1657
H04N5/4448
G11C11/161
H04W4/16
G05B19/41875
A01K2217/05
C10M2215/082
H04B7/12
B65G23/22
C07D473/00
G01L7/00
H01L23/49
H01L23/3735
A61B6/08
A61B6/547
A61B5/0555
G01S7/4816
A01K63/003
B42D1/007
F01L2009/0436
B62J17/08
C01B33/18
F02M39/02
F16H2059/467
B01D53/323
C08J2309/00
Y10T407/191
A61G2210/50
G06F1/185
H05B2203/011
B60Q3/44
G06F12/0888
B60Q9/007
G09G5/00
B62D35/008
C07C213/10
H01J2235/18
F17C2223/036
H02B5/00
B42D15/08
B01J2540/32
B01J35/002
A44C21/00
F41A19/47
B63H23/321
B24B53/14
E04G1/15
B32B27/36
F04B9/1115
A61M39/221
B01J2219/32483
G01S17/32
G09F1/10
H05B3/16
C08L2205/16
C09K2200/065
B60J10/15
Y02B70/3241
H05K1/0228
F21V7/005
C07C229/62
H04L67/14
C12N2501/23
C12N2501/22
F25B9/02
C04B2103/46
C08F290/062
B01J20/3204
G06K9/6878
A61K8/0241
C02F3/20
H01M4/0404
B65H63/082
G03F7/70258
B29C51/46
Y10T477/623
G01N21/51
B23K35/40
A61D3/00
B41F23/08
H04W28/14
C08F8/42
G09G2310/0237
G02B26/008
G09F3/0335
C07C15/38
G02F2001/136295
H01L2221/1089
A47F5/0037
A61K2236/33
H01L29/78606
G06F17/30
H01M8/04216
C03C2218/328
C07K14/43595
A61K47/56
G06K19/083
G06K19/18
H04L63/126
C04B35/119
H04L12/40045
H04L29/12396
C22F1/10
A01N25/26
C04B35/63416
Y10S422/90
C12R1/01
A61B18/1233
A61N1/36017
C08F2800/10
C23C2/006
D06M23/08
A61H2201/1621
Y10T428/249958
C01B11/023
G11B20/10527
F02M35/09
A63H11/00
G01C25/00
A61F2002/30158
B01D71/48
F02D41/0055
F16L19/075
C07F3/02
C09J7/028
Query:
-- Corrected SQL for Query 2 (no changes needed):
SELECT "publication_number", "title", "abstract"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,title,abstract
CA-27-A,Improvement on spinning wheel,
ES-81-Y,Improvements heels for footwear.,
DE-303-C,,
ES-866-Y,Improvements gravestones tombs and funerary niches.,
FI-150-A,"The monitor method for preparing dubbelugnar for the preparation af tjra, lysolja, terpentin mm.  ur furustubbar Science Notter",
FI-250-A,Sjelflggningsapparat to the skrdemaskiner,
FR-336-E,Improvements in the processing of cotton and cotton goods to make them nonflammable,
NL-284-C,,
NL-947-C,,
BE-107-T1,Bouches fire.,
CA-1911-A,A ralway track clearer,
CA-4005-A,Leather scouring machine,
CA-4106-A,Automatic car-coupling,
CA-4698-A,Ladies&#39; work table,
CA-4801-A,Washing machine,
CA-5943-A,Improvement on bed bottoms,
CA-6183-A,Improvements in wood planing machines,
CA-6207-A,Improvements in lamps,
CA-6390-A,Reversible plough,
CA-6969-A,Machine for making spirally formed tubes,
CA-8931-S,Bottle,
CA-9897-A,Improvements on fare registers,
DE-3129-C,,
DE-3301-C,,
DE-3884-C,,
DE-3983-C,,
DE-5976-C,,
DK-2807-C,Process for the preparation of soluble salts of barium.,
DK-3080-C,Devices in trays for packing eggs.,
DK-3107-C,The production method for Smedejrns Finned with continuous helical rib.,
DK-3184-C,Water Pitcher.,
DK-3510-C,Device at the apparatus for the production of acetylene.,
DK-5867-C,Automatic oiler Snkker and Snkkehjul in centrifuges.,
DK-5921-C,Ankerbevikling with open coils for generators or motors with one-way Power.,
DK-6491-A,Cable mounting of the guard device for a telecommunications cable,
DK-7210-C,"Alloy of nickel, aluminum, copper and iron.",
DK-8069-C,"Receiver means for rotating steam, gas or combustion products and the like that is also useful as a gas compressor.",
DK-8466-C,Method and apparatus for extracting sulfur and Cyanides in the purification of from Belysningsgas.,
DK-9281-C,Method for Preparation of an image bearer of photosensitive papers.,
DK-9359-C,Device at Telephone exchange.,
ES-1062-U,Truck for transport of concrete and mortar tilting download and auto-return to the loading position.,
ES-1498-U,Razor.,
ES-1524-Y,Device cuvette for containing papers.,
ES-1872-U,Packing box for rolls of raw rubber.,
ES-2542-Y,Purse fastening system.,
ES-2819-Y,"Burning stove liquids, essentially diesel fuel.",
ES-2960-U,Tong for sewing straps.,
ES-3045-U,Sliding adjuster for clothing,
ES-4483-Y,Improved sealing tap water.,
ES-4723-Y,Pocket electric lamp.,
ES-4858-U,A simplified shaving machine,
ES-5089-Y,Breastplate of interposition between the foot and the shoe.,
ES-5219-Y,Cigarette paper sheet.,
ES-5716-U,A protective cardboard disc to facilitate changes retaining therein a stamp,the arrangement of the protective shield consists of two discs glued cardboard between one ai coated by transparent paper and preserving inside a stamp which can not be removed without destruction of the protective shield claimed.
ES-5975-Y,Bottle or container with inner compartments that allow contain different kinds of liquids.,
ES-6454-U,Fonmularios game combined with carbon paper for use in typewriters.,Formset for use in typewriters characterized in that a multiple number of forms of varying sizes together with sheets of carbon paper interleaved between them are joined by one of its ends by way of booklet by glue seam or other means carrying the various forms a drill or drilling by the joint portion of the booklet and another distance from the end attached while sheets of carbon paper lacking drilling are somewhat shorter than the forms to write at the free end opposite the junction of the booklet.
ES-6552-Y,protection against low temperatures shirt.,
ES-6928-Y,Clamping device straps to the handles of wristwatches.,
ES-6962-Y,Provided cork extraction medium.,
ES-7086-Y,Device in gas carbide drive motors.,
ES-7407-Y,Folding bike reduced rate.,
ES-7489-Y,Cover or wrapper to protect the crowns of rayon.,
ES-7516-U,Plywood floors for shoemaking.,Plywood floors for manufacturing footwear characterized by being formed of two or more templates wooden board with its meshes intersecting cross and longitudinal direction alternately linked together by a material of high adhesiveness to which will be given by molding most convenient form and the foot changes depending on the model and type of footwear that these floors want manufacture obtained by the plywood formed great flexibility and ease of movement.
ES-7538-U,"Simile, girdle, bra and panty.",Simil belt bra panty be snapped to a side it characterized in that it comprises duly interconnected parts which replace Soste the belt and the panty.
ES-764-H3,Machine to raise water called fast ferris wheel,
ES-8269-Y,Shuttering elements or molded or reinforced concrete floors lighten parts.,
FI-1825-A,The process of at verkstllande Evaporation at high the temperaturer Science To this was apparat,
FI-291-U1,Utloppsfoerbindning in a substitutionsluftinslaeppningsventil,
FI-3021-A,Frbttring  formmaskiner for cementrr med-regulating device for formldans of skakningrrel
Query:
-- Corrected SQL for Query 3:
SELECT
  "publication_number",
  TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_converted",
  TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') AS "grant_date_converted"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
  AND "filing_date" != 0
  AND "grant_date" != 0
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date_converted,grant_date_converted
US-2571835-A,1946-03-21,1951-10-16
US-3009706-A,1958-03-12,1961-11-21
US-4306624-A,1979-12-11,1981-12-22
US-6057931-A,1996-03-22,2000-05-02
US-6215672-B1,1999-10-01,2001-04-10
US-8817671-B2,2011-12-14,2014-08-26
US-3400629-A,1965-03-29,1968-09-10
US-7198698-B1,2003-08-18,2007-04-03
US-5664492-A,1996-04-29,1997-09-09
US-4413017-A,1981-06-11,1983-11-01
US-6062941-A,1999-02-04,2000-05-16
US-4443740-A,1982-04-09,1984-04-17
US-6882533-B2,2001-12-14,2005-04-19
US-D444852-S,1998-11-27,2001-07-10
US-8363726-B2,2008-07-31,2013-01-29
US-9627067-B2,2016-03-28,2017-04-18
US-8772304-B2,2011-10-26,2014-07-08
US-7545425-B2,2005-04-06,2009-06-09
US-8879320-B2,2012-09-12,2014-11-04
US-8798724-B2,2012-03-28,2014-08-05
US-8285445-B2,2010-04-22,2012-10-09
US-8281614-B2,2007-06-18,2012-10-09
US-8120996-B2,2007-04-04,2012-02-21
US-7604427-B2,2007-06-21,2009-10-20
US-6611791-B1,2000-05-18,2003-08-26
US-6839968-B2,2002-05-09,2005-01-11
US-5079435-A,1989-12-14,1992-01-07
US-6517181-B2,2001-12-12,2003-02-11
US-9005374-B2,2011-03-28,2015-04-14
US-3383999-A,1967-07-03,1968-05-21
US-5594833-A,1993-05-31,1997-01-14
US-3233386-A,1963-02-18,1966-02-08
US-8701310-B1,2010-08-17,2014-04-22
US-3930935-A,1973-11-29,1976-01-06
US-7352315-B2,2006-07-24,2008-04-01
US-8239955-B2,2008-03-31,2012-08-07
US-RE33774-E,1990-07-19,1991-12-24
US-3696167-A,1970-03-30,1972-10-03
US-7520543-B2,2006-08-23,2009-04-21
US-7411179-B2,2007-02-08,2008-08-12
US-2184471-A,1937-10-12,1939-12-26
US-6979985-B2,2003-06-03,2005-12-27
US-8632537-B2,2012-02-16,2014-01-21
US-8863523-B2,2013-07-09,2014-10-21
US-9179797-B2,2011-05-27,2015-11-10
US-2168433-A,1937-02-13,1939-08-08
US-2271160-A,1939-05-19,1942-01-27
US-1445253-A,1919-09-22,1923-02-13
US-6660669-B2,2001-08-14,2003-12-09
US-6821807-B2,2001-08-30,2004-11-23
US-990457-A,1910-04-21,1911-04-25
US-6314104-B1,1996-10-04,2001-11-06
US-1602212-A,1925-01-28,1926-10-05
US-1920889-A,1929-07-18,1933-08-01
US-2522968-A,1947-11-28,1950-09-19
US-5393704-A,1993-12-13,1995-02-28
US-5858460-A,1991-07-01,1999-01-12
US-7283229-B2,2002-01-25,2007-10-16
US-8912443-B2,2009-04-01,2014-12-16
US-6685909-B2,2003-05-01,2004-02-03
US-3545919-A,1968-05-15,1970-12-08
US-3095615-A,1961-08-22,1963-07-02
US-5808948-A,1996-12-18,1998-09-15
US-4509955-A,1984-06-21,1985-04-09
US-D769840-S,2014-07-23,2016-10-25
US-6075855-A,1998-02-09,2000-06-13
US-5081862-A,1990-03-12,1992-01-21
US-9032298-B2,2008-05-28,2015-05-12
US-5417822-A,1993-12-30,1995-05-23
US-3278865-A,1963-05-31,1966-10-11
US-2797576-A,1953-11-23,1957-07-02
US-3853351-A,1974-03-29,1974-12-10
US-5000811-A,1989-11-22,1991-03-19
US-2739605-A,1952-10-08,1956-03-27
US-7616943-B2,2006-06-27,2009-11-10
US-3343772-A,1965-10-24,1967-09-26
US-3105875-A,1957-12-09,1963-10-01
US-4556213-A,1983-09-09,1985-12-03
US-6700363-B2,2002-09-12,2004-03-02
US-7424976-B2,2005-07-29,2008-09-16
US-7856707-B2,2003-04-11,2010-12-28
US-6816564-B2,2001-11-08,2004-11-09
US-9634057-B2,2014-11-04,2017-04-25
US-7984324-B2,2008-03-27,2011-07-19
US-7738870-B2,2007-01-24,2010-06-15
US-6333684-B1,1998-12-31,2001-12-25
US-7906388-B2,2006-04-12,2011-03-15
US-6536416-B1,2000-08-21,2003-03-25
US-8486040-B2,2009-01-16,2013-07-16
US-4128643-A,1977-05-26,1978-12-05
US-5195442-A,1991-08-29,1993-03-23
US-8265309-B2,2009-09-26,2012-09-11
US-6872196-B1,2002-10-09,2005-03-29
US-4586891-A,1984-09-05,1986-05-06
US-8703043-B2,2012-01-04,2014-04-22
US-4625265-A,1985-05-20,1986-11-25
US-2581468-A,1947-12-10,1952-01-08
US-D453642-S,2000-09-15,2002-02-19
US-5983180-A,1998-02-27,1999-11-09
US-3384050-A,1967-08-01,1968-05-21
US-8450020-B2,2011-04-26,2013-05-28
US-2826667-A,1956-04-23,1958-03-11
US-8315550-B2,2010-03-31,2012-11-20
US-6439304-B2,2001-05-23,2002-08-27
US-5789800-A,1997-01-17,1998-08-04
US-9274229-B2,2011-12-06,2016-03-01
US-9550645-B2,2013-07-05,2017-01-24
US-7793226-B2,2006-08-14,2010-09-07
US-7985341-B2,2007-07-23,2011-07-26
US-8579823-B2,2010-06-07,2013-11-12
US-7169877-B2,2001-09-26,2007-01-30
US-7150775-B2,2004-01-14,2006-12-19
US-2552476-A,1950-02-07,1951-05-08
US-8697468-B2,2012-04-10,2014-04-15
US-8259250-B2,2007-09-26,2012-09-04
US-9671763-B2,2012-12-28,2017-06-06
US-8999831-B2,2012-11-19,2015-04-07
US-6720520-B1,2000-02-15,2004-04-13
US-3223957-A,1963-07-22,1965-12-14
US-8705958-B2,2011-03-11,2014-04-22
US-2499712-A,1947-02-21,1950-03-07
US-7845006-B2,2007-01-23,2010-11-30
US-6908243-B1,2003-12-30,2005-06-21
US-3899265-A,1973-12-27,1975-08-12
US-6700831-B2,2002-01-22,2004-03-02
US-7097163-B2,2005-03-02,2006-08-29
US-3087812-A,1960-05-11,1963-04-30
US-4449002-A,1982-04-14,1984-05-15
US-4494530-A,1983-03-15,1985-01-22
US-D281457-S,1983-02-04,1985-11-26
US-4013557-A,1975-06-06,1977-03-22
US-D747730-S,2015-03-20,2016-01-19
US-6154669-A,1998-11-06,2000-11-28
US-3463983-A,1967-01-19,1969-08-26
US-4441841-A,1982-02-02,1984-04-10
US-4446729-A,1981-10-23,1984-05-08
US-4797651-A,1986-05-27,1989-01-10
US-8170854-B2,2005-01-14,2012-05-01
US-6203078-B1,1998-08-28,2001-03-20
US-
Query:
-- Corrected SQL for Query 4 (no changes needed):
SELECT "publication_number", "family_id"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,family_id
JP-1810118-C,16434890
JP-1203714-C,4349252
FR-1500580-A,24014930
ES-8501233-A1,9279533
CA-2165155-A1,22129167
FR-2409943-B1,5992449
GB-1086860-A,23786306
JP-S54117658-A,12139126
JP-H0710178-Y2,31250411
JP-3172057-B2,27427283
US-136580-A,2205996
US-272220-A,2341452
US-599187-A,2667828
CN-1062411-C,22249834
DE-1479218-U,784747
EP-2512367-B1,43857857
ES-2312527-T3,9927123
FR-1000748-A,9560654
FR-1573809-A,7621232
JP-S5066757-U,28364915
JP-S5845249-Y2,28646482
US-2103405-A,24126880
GB-201114438-D0,44800659
JP-5707248-B2,47671111
JP-2016211567-A,57179285
KR-20040075216-A,33516334
CN-1954806-A,38062481
CN-201399214-Y,41101653
JP-1368881-C,12213842
JP-1444589-C,13384729
FR-1497898-A,26173968
DE-2707796-A1,11991139
DE-2962208-D1,26733043
FR-2233137-A1,11216692
GB-2224027-B,10644989
JP-S5911756-Y2,28825063
JP-2000218515-A,12213511
JP-S56169301-A,13496200
US-2002102047-A1,24588049
CN-1467804-A,34147716
EP-0988417-B1,7831228
JP-H04334685-A,14380644
JP-S6359143-U,31071756
JP-H0685910-B2,17707992
JP-H0350567-B2,20351149
JP-5108773-B2,37856792
CN-2768052-Y,36130065
CN-1940157-B,36569966
CN-202318915-U,46430910
CN-203200362-U,49144490
JP-897785-C,12752978
JP-1789132-C,6338354
JP-S62113530-U,30777987
CA-118661-S,48949441
FI-882364-A0,8526484
CA-810158-A,24064892
DE-2335240-A1,5886563
DE-7610943-U1,6664079
JP-H0673947-U,11841145
JP-S54153049-A,13166352
JP-S5716116-U,29449694
US-548167-A,2616910
CN-1055840-A,6404037
JP-S6020713-A,15000093
JP-S6234024-A,15962328
JP-H0995081-A,17278302
JP-H1088758-A,17435637
GB-189709494-A,32353776
JP-2001195445-A,22609045
JP-2010101160-A,42054814
CN-101746294-A,42134179
CN-104170353-A,51912370
CN-206056613-U,58376396
JP-1032657-C,12309338
JP-1654837-C,14760871
DK-146223-C,22548755
CA-564325-A,35736825
GB-0802422-D0,39247394
JP-S53139175-U,28919719
JP-H01150349-U,31274164
JP-2600796-Y2,13664723
JP-S591896-U,30228404
JP-S4922438-B1,25119541
US-419959-A,2488878
DE-69331528-D1,25543828
DE-69430885-T2,20390510
EP-1474362-B1,27732378
JP-2000346423-A,15528532
JP-2765752-B2,17296431
KR-900003183-Y1,19262397
JP-2003229053-A,27746793
JP-2007241524-A,38587026
JP-5129599-B2,40113333
KR-100547071-B1,29243804
KR-20070020426-A,34861538
KR-20130050682-A,48660984
CN-204556165-U,53831260
ES-66185-Y,52730815
CA-1331409-C,25671081
FI-891492-A0,22640016
GB-1348507-A,27273208
JP-S60179587-U,30603266
US-332138-A,2401238
CN-1112492-C,4579511
DE-566539-C,7242183
DE-845109-C,7292640
JP-S63125649-A,25353670
JP-S6423693-U,31363076
JP-S5243021-U,28610623
JP-S5566205-U,29134624
JP-H0825023-B2,15797928
JP-2003215980-A,27670225
JP-4255884-B2,35587884
KR-100295305-B1,12367105
CN-101547005-A,41193935
CN-101988676-A,43745355
CN-203259375-U,49471928
CN-205932945-U,57947562
DE-202006018912-U1,37776401
FR-2828332-A1,8851730
GB-1375879-A,10135648
JP-S53161674-U,28969941
US-2053075-A,21966233
CN-2484753-Y,33654909
CN-1212523-A,17153001
FI-20010786-A,8560995
JP-S6359144-U,31070978
JP-2799203-B2,23060287
JP-H08143121-A,17994142
US-1837725-A,23553531
US-2304134-A,23563184
US-1864623-A,24014353
JP-5991128-B2,50746206
JP-2016105749-A,51658201
RU-2191214-C2,20244718
RU-2008140707-A,46274907
CN-103265598-B,49009270
CN-203928708-U,51824510
CN-204557664-U,53832749
CN-206326242-U,59285711
CN-104559893-B,53076991
CN-106856628-A,59012672
US-6778773-B2,19122213
JP-H00985753-A,17101171
JP-1512007-C,13603320
NL-28211-C,1793235
CA-2184504-C,24131977
FR-877274-A,6818008
JP-S60218905-A,24343079
JP-H04326774-A,14195785
JP-S5125160-A,14210931
FR-1012104-A,9570537
JP-S5944363-A,6170220
JP-H081564-A,15634830
US-1233474-A,3301305
US-2002011230-A1,18656494
JP-2003169856-A,19181781
US-811638-A,2880117
KR-200338652-Y1,49342250
KR-20070041890-A,37962650
CN-1816294-A,36778618
CN-2858160-Y,37611019
CN-201276086-Y,40893666
CN-201816145-U,43914113
CN-102907994-A,47606753
JP-1573454-C,12299270
JP-1721868-C,16956632
JP-2100371-C,16847464
DK-358583-D0,23885229
ES-146285-Y,8328146
GB-478690-A,6542289
DE-2649618-B2,5991995
DE-3766112-D1,25468864
DE-8007402-U1,6713907
FR-390089-A,1435653
FR-638126-A,10160478
FR-2638622-B1,9371569
JP-H0584037-U,12173208
JP-S4739450-Y1,33221751
JP-H0642846-U,13718656
NL-296405-A,1877312
NL-7211943-A,19816839
EP-2781788-B1,50289541
JP-S5072414-U,28386197
JP-S5846920-U,29935188
JP-S5874811-U,29962816
JP-S5687776-U,29682033
US-D279853-S,-1
KR-920008597-Y1,19279218
JP-2004313014-A,33469263
JP-6137070-B2,55225833
RU-2008132286-A,42123530
US-754320-A,2822813
CN-105823611-A,56524943
CN-106739164-A,58922392
CN-205558012-U,56821657
BE-512467-A,150911
CA-2244766-A1,29418207
DE-1803332-A1,25756273
DE-2149141-A1,5821241
GB-2089320-A,15972930
JP-S62164685-U,30876254
JP-H066780-Y2,31585658
DE-69322442-T2,25419972
EP-1933436-B1,38221653
EP-0782478-B1,10760989
EP-0993180-B1,17716909
JP-S5128923-U,28309915
JP-S5153284-U,28385065
JP-S5376919-A,15554809
JP-3340813-B2,17034833
JP-2000192758-A,18492249
JP-H11193667-A,18492499
RU-17326-U1,36050112
KR-20110049427-A,44360569
CN-101531763-A,41102637
CN-201900010-U,44270612
CN-202142
Query:
-- Corrected SQL for Query 5 (no changes needed):
SELECT "publication_number", "application_kind"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "country_code" = 'US'
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,application_kind
US-3386882-A,A
US-3027501-A,A
US-3942098-A,A
US-4976319-A,A
US-9109382-B2,A
US-4771043-A,A
US-2005230705-A1,A
US-2013130462-A1,A
US-9053107-B1,A
US-7902031-B2,A
US-2016075808-A1,A
US-7608693-B2,A
US-2014003741-A1,A
US-2013140361-A1,A
US-2016298023-A1,A
US-2003171248-A1,A
US-2004162313-A1,A
US-D652666-S,F
US-2006099337-A1,A
US-2016154172-A1,A
US-2004174607-A1,A
US-2013153308-A1,A
US-2015247786-A1,A
US-2008224789-A1,A
US-2008258624-A1,A
US-7464329-B2,A
US-5635185-A,A
US-8296413-B2,A
US-2012150653-A1,A
US-2012129580-A1,A
US-2011047323-A1,A
US-2017013192-A1,A
US-2012248360-A1,A
US-2005262396-A1,A
US-2012227290-A1,A
US-2009147073-A1,A
US-7970723-B2,A
US-2012045534-A1,A
US-5114354-A,A
US-7780352-B2,A
US-2015369567-A1,A
US-2009315655-A1,A
US-2013205270-A1,A
US-2013098332-A1,A
US-2015152998-A1,A
US-2005230479-A1,A
US-2010260546-A1,A
US-2010189222-A1,A
US-2011226486-A1,A
US-7658953-B2,A
US-2014305686-A1,A
US-2006195675-A1,A
US-2009069867-A1,A
US-2016024760-A1,A
US-2008215603-A1,A
US-2014036748-A1,A
US-2014064040-A1,A
US-8852551-B2,A
US-2010129969-A1,A
US-2010033722-A1,A
US-2009194945-A1,A
US-8212546-B2,A
US-3304279-A,A
US-3458087-A,A
US-8619482-B1,A
US-D787348-S,F
US-5714952-A,A
US-9485551-B2,A
US-4322320-A,A
US-7421499-B1,A
US-2004054491-A1,A
US-2016308783-A1,A
US-9496971-B2,A
US-7544531-B1,A
US-8194623-B2,A
US-2017210626-A1,A
US-550395-A,A
US-2090148-A,A
US-1563811-A,A
US-1690978-A,A
US-1080290-A,A
US-874054-A,A
US-1432386-A,A
US-2005140913-A1,A
US-1273171-A,A
US-1976605-A,A
US-1288533-A,A
US-2002005139-A1,A
US-90191-A,A
US-1500903-A,A
US-884660-A,A
US-3836637-A,A
US-3733363-A,A
US-7672572-B2,A
US-8288771-B2,A
US-7703166-B2,A
US-8250336-B2,A
US-2017243441-A1,A
US-7749437-B2,A
US-1841439-A,A
US-685549-A,A
US-717097-A,A
US-9605080-B2,A
US-1281510-A,A
US-D688470-S,F
US-70658-A,A
US-1587649-A,A
US-6979145-B2,A
US-2013281696-A1,A
US-8423345-B1,A
US-9660318-B2,A
US-7992317-B1,A
US-8836743-B2,A
US-7688039-B2,A
US-310097-A,A
US-1394605-A,A
US-9074796-B2,A
US-9508612-B2,A
US-168508-A,A
US-1745690-A,A
US-3773788-A,A
US-D573796-S,F
US-1987353-A,A
US-936398-A,A
US-140875-A,A
US-112757-A,A
US-2002009718-A1,A
US-841786-A,A
US-1693320-A,A
US-833877-A,A
US-8124531-B2,A
US-98273-A,A
US-4429194-A,A
US-2042253-A,A
US-471774-A,A
US-3773875-A,A
US-835298-A,A
US-1099037-A,A
US-1124387-A,A
US-2006511-A,A
US-2008254519-A1,A
US-759553-A,A
US-2017096779-A1,A
US-8712-A,A
US-107767-A,A
US-197619-A,A
US-564915-A,A
US-1229662-A,A
US-1792297-A,A
US-190377-A,A
US-976587-A,A
US-86003-A,A
US-962341-A,A
US-1271973-A,A
US-1085585-A,A
US-1002337-A,A
US-2015288243-A1,A
US-8102405-B2,A
US-8680289-B2,A
US-6569947-B1,A
US-2017136437-A1,A
US-1842177-A,A
US-2003017456-A1,A
US-851137-A,A
US-2013077094-A1,A
US-D680201-S,F
US-1367640-A,A
US-2013236121-A1,A
US-9503167-B2,A
US-8229017-B1,A
US-2017227103-A1,A
US-8986264-B2,A
US-7455034-B2,A
US-9170329-B2,A
US-1397607-A,A
US-6292031-B1,A
US-8869288-B2,A
US-8379632-B2,A
US-9467135-B2,A
US-7529447-B2,A
US-6472395-B1,A
US-2013153072-A1,A
US-9241999-B2,A
US-7221067-B2,A
US-2005192304-A1,A
US-2015356128-A1,A
US-8986671-B2,A
US-2008123158-A1,A
US-2007028923-A1,A
US-2015347052-A1,A
US-2012186608-A1,A
US-2012178568-A1,A
US-2007109861-A1,A
US-7670605-B2,A
US-2015029573-A1,A
US-2005286734-A1,A
US-2009091461-A1,A
US-2010249953-A1,A
US-2006231296-A1,A
US-2011302498-A1,A
US-2014202949-A1,A
US-2008198759-A1,A
US-2011033008-A1,A
US-2015325318-A1,A
US-2015173385-A1,A
US-2011229577-A1,A
US-6755925-B1,A
US-2007243416-A1,A
US-2005189265-A1,A
US-2007228790-A1,A
US-2725688-A,A
US-2006204068-A1,A
US-2007157737-A1,A
US-2735723-A,A
US-4057975-A,A
US-6549780-B2,A
US-D739811-S,F
US-2008169557-A1,A
US-7755045-B2,A
US-3896888-A,A
US-3177255-A,A
US-6115795-A,A
US-4183330-A,A
US-6857996-B2,A
US-3910051-A,A
US-9035606-B2,A
US-2015179981-A1,A
US-2006221438-A1,A
US-2528705-A,A
US-4572880-A,A
US-9653764-B2,A
US-4339741-A,A
US-6656997-B2,A
US-6939208-B2,A
US-7090520-B2,A
US-2013286506-A1,A
US-4818164-A,A
US-3511826-A,A
US-4636440-A,A
US-2013027085-A1,A
US-2004041961-A1,A
US-2011030536-A1,A
US-3893135-A,A
US-2647163-A,A
US-5382299-A,A
US-2014194333-A1,A
US-2011075502-A1,A
US-6665912-B2,A
US-5336305-A,A
US-8959636-B2,A
US-4697425-A,A
US-2772956-A,A
US-2007232991-A1,A
US-5675433-A,A
US-2009320748-A1,A
US-2011273843-A1,A
US-4480163-A,A
US-4990376-A,A
US-2015380450-A1,A
US-2004068344-A1,A
US-7432507-B2,A
US-2011197582-A1,A
US-2005092756-A1,A
US-7838326-B2,A
US-6427991-B1,A
US-5277812-A,A
US-3104687-A,A
US-5551026-A,A
US-3028435-A,A
US-3245421-A,A
US-3192494-A,A
US-4226665-A,A
US-4722684-A,A
US-7075253-B2,A
US-5399043-A,A
US-4905604-A,A
US-8490255-B1,A
US-D377277-S,F
US-2014337972-A1,A
US-8536324-B2,A
US-2010238701-A1,A
US-8840251-B2,A
US-7254741-B1,A
US-2014070802-A1,A
US-9113312-B2,A
US-6876359-B2,A
US-9349497-B2,A
US-2015101196-A1,A
US-2009078178-A1,A
US-9192990-B2,A
US-6260651-B1,A
US-2014088986-A1,A
US-2012290266-A1,A
US-2004026123-A1,A
US-2014108983-A1,A
US-2008265331-A1,A
US-6167745-B1,A
US-2009194732-A1,A
US-2
End Exploring Related Columns
Task: For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
publication_number,most_similar_publication_number,similarity
pub_num1:str,pub_num2:str,similarity:float(Attention: answer in one row)
```

The patent `pub_num1` is the United States utility patent under the B2 classification, granted between 2010 and 2014, that received the most forward citations within a month of its filing date. The most similar patent to `pub_num1`, filed in the same year regardless of its type, is `pub_num2`, with a similarity score of `similarity`..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 06:09:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:09:04 - root - INFO - ```sql
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND p."filing_date" IS NOT NULL
    AND p2."filing_date" IS NOT NULL
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM((ae.value[0]::FLOAT * ae.value[1]::FLOAT)), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s,
  LATERAL FLATTEN(input => ARRAY_ZIP(b.embedding1, s.embedding2)) ae
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
```
2025-01-20 06:09:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:09:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:09:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:09:05 - snowflake.connector.connection - INFO - closed
2025-01-20 06:09:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:09:06 - root - INFO - itercount: 1
2025-01-20 06:09:06 - root - INFO - 002140 (42601): 01b9d4f1-0004-7b17-0001-11c300f0749a: SQL compilation error:
Unknown function ARRAY_ZIP
2025-01-20 06:09:06 - root - INFO - Input sql:
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND p."filing_date" IS NOT NULL
    AND p2."filing_date" IS NOT NULL
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM((ae.value[0]::FLOAT * ae.value[1]::FLOAT)), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s,
  LATERAL FLATTEN(input => ARRAY_ZIP(b.embedding1, s.embedding2)) ae
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
The error information is:
002140 (42601): 01b9d4f1-0004-7b17-0001-11c300f0749a: SQL compilation error:
Unknown function ARRAY_ZIP
Please correct it and output only 1 complete SQL query.Usage of ST_INTERSECTS: ST_INTERSECTS(geometry1, ST_GEOGFROMWKB(geometry2)) This function checks if the two geometries intersect. The first argument, geometry1, is compared with the second argument, geometry2, which is converted from its WKB (Well-Known Binary) representation to a geography type using ST_GEOGFROMWKB. If the two geometries share any portion of space, the function returns TRUE; otherwise, it returns FALSE. Usage of ST_CONTAINS: ST_CONTAINS(r1.geometry, r2.geometry) This function checks if the geometry r1.geometry completely contains the geometry r2.geometry. It returns TRUE if all points of r2.geometry are within r1.geometry and FALSE otherwise. This is useful for spatial containment queries, such as verifying whether one region is entirely within another. ARRAY_INTERSECTION(nodes1, nodes2): This function computes the intersection of the two arrays, returning a new array containing only the elements that are present in both nodes1 and nodes2. ARRAY_SIZE(...): This function then determines the size (or number of elements) in the resulting array from the intersection.

2025-01-20 06:09:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:09:58 - root - INFO - ```sql
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND p."filing_date" IS NOT NULL
    AND p2."filing_date" IS NOT NULL
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.value::FLOAT * s_emb.value::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  LATERAL FLATTEN(input => b.embedding1) b_emb
  INNER JOIN LATERAL FLATTEN(input => s.embedding2) s_emb
    ON b_emb.INDEX = s_emb.INDEX
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
```
2025-01-20 06:09:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:09:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:09:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:10:00 - snowflake.connector.connection - INFO - closed
2025-01-20 06:10:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:10:00 - root - INFO - itercount: 2
2025-01-20 06:10:00 - root - INFO - 001003 (42000): 01b9d4f1-0004-7d02-0001-11c300f067e6: SQL compilation error:
syntax error line 83 at position 2 unexpected 'LATERAL'.
2025-01-20 06:10:00 - root - INFO - Input sql:
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND p."filing_date" IS NOT NULL
    AND p2."filing_date" IS NOT NULL
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.value::FLOAT * s_emb.value::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  LATERAL FLATTEN(input => b.embedding1) b_emb
  INNER JOIN LATERAL FLATTEN(input => s.embedding2) s_emb
    ON b_emb.INDEX = s_emb.INDEX
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
The error information is:
001003 (42000): 01b9d4f1-0004-7d02-0001-11c300f067e6: SQL compilation error:
syntax error line 83 at position 2 unexpected 'LATERAL'.
Please correct it and output only 1 complete SQL query.
2025-01-20 06:11:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:11:11 - root - INFO - ```sql
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.VALUE::FLOAT * s_emb.VALUE::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  CROSS JOIN TABLE(FLATTEN(input => b.embedding1)) AS b_emb
  CROSS JOIN TABLE(FLATTEN(input => s.embedding2)) AS s_emb
WHERE
  b_emb.INDEX = s_emb.INDEX
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
```
2025-01-20 06:11:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:11:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:11:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:11:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 06:11:28 - snowflake.connector.connection - INFO - closed
2025-01-20 06:11:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:11:28 - root - INFO - itercount: 3
2025-01-20 06:11:28 - root - INFO - 0
2025-01-20 06:11:28 - root - INFO - results: 
PUBLICATION_NUMBER,MOST_SIMILAR_PUBLICATION_NUMBER,SIMILARITY
US-7877798-B2,US-2009209314-A1,0.8447


2025-01-20 06:11:28 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
publication_number,most_similar_publication_number,similarity
pub_num1:str,pub_num2:str,similarity:float(Attention: answer in one row)
```

The patent `pub_num1` is the United States utility patent under the B2 classification, granted between 2010 and 2014, that received the most forward citations within a month of its filing date. The most similar patent to `pub_num1`, filed in the same year regardless of its type, is `pub_num2`, with a similarity score of `similarity`. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
PUBLICATION_NUMBER,MOST_SIMILAR_PUBLICATION_NUMBER,SIMILARITY
US-7877798-B2,US-2009209314-A1,0.8447
Current sql:
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.VALUE::FLOAT * s_emb.VALUE::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  CROSS JOIN TABLE(FLATTEN(input => b.embedding1)) AS b_emb
  CROSS JOIN TABLE(FLATTEN(input => s.embedding2)) AS s_emb
WHERE
  b_emb.INDEX = s_emb.INDEX
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
2025-01-20 06:12:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:12:18 - root - INFO - ```sql
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.VALUE::FLOAT * s_emb.VALUE::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  CROSS JOIN TABLE(FLATTEN(input => b.embedding1)) AS b_emb
  CROSS JOIN TABLE(FLATTEN(input => s.embedding2)) AS s_emb
WHERE
  b_emb.SEQ = s_emb.SEQ
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
```
2025-01-20 06:12:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:12:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:12:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:12:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 06:12:34 - snowflake.connector.connection - INFO - closed
2025-01-20 06:12:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:12:34 - root - INFO - itercount: 4
2025-01-20 06:12:34 - root - INFO - 0
2025-01-20 06:12:34 - root - INFO - results: 
PUBLICATION_NUMBER,MOST_SIMILAR_PUBLICATION_NUMBER,SIMILARITY
US-7877798-B2,WO-2009125495-A1,0.0244


2025-01-20 06:12:34 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
publication_number,most_similar_publication_number,similarity
pub_num1:str,pub_num2:str,similarity:float(Attention: answer in one row)
```

The patent `pub_num1` is the United States utility patent under the B2 classification, granted between 2010 and 2014, that received the most forward citations within a month of its filing date. The most similar patent to `pub_num1`, filed in the same year regardless of its type, is `pub_num2`, with a similarity score of `similarity`. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
PUBLICATION_NUMBER,MOST_SIMILAR_PUBLICATION_NUMBER,SIMILARITY
US-7877798-B2,WO-2009125495-A1,0.0244
Current sql:
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.VALUE::FLOAT * s_emb.VALUE::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  CROSS JOIN TABLE(FLATTEN(input => b.embedding1)) AS b_emb
  CROSS JOIN TABLE(FLATTEN(input => s.embedding2)) AS s_emb
WHERE
  b_emb.SEQ = s_emb.SEQ
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
2025-01-20 06:13:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:13:25 - root - INFO - ```sql
WITH
citations_within_month AS (
  SELECT
    p."publication_number" AS pub_num1,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date1,
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS citation_count
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae ON p."publication_number" = ae."publication_number",
    LATERAL FLATTEN(input => ae."cited_by") f
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p2 ON p2."publication_number" = f.value:"publication_number"::STRING
  WHERE
    p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2%'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF(
      'day',
      TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'),
      TRY_TO_DATE(p2."filing_date"::VARCHAR, 'YYYYMMDD')
    ) BETWEEN 0 AND 30
  GROUP BY
    p."publication_number",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')
),
max_citation_patent AS (
  SELECT
    pub_num1 AS publication_number,
    filing_date1,
    citation_count
  FROM
    citations_within_month
  ORDER BY
    citation_count DESC NULLS LAST
  LIMIT
    1
),
base_patent AS (
  SELECT
    m.publication_number,
    m.filing_date1,
    m.citation_count,
    ae1."embedding_v1" AS embedding1,
    YEAR(m.filing_date1) AS filing_year
  FROM
    max_citation_patent m
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae1 ON m.publication_number = ae1."publication_number"
),
same_year_patents AS (
  SELECT
    p."publication_number" AS pub_num2,
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS filing_date2,
    ae2."embedding_v1" AS embedding2
  FROM
    PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB ae2 ON p."publication_number" = ae2."publication_number"
  WHERE
    YEAR(TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (
      SELECT
        filing_year
      FROM
        base_patent
    )
    AND p."publication_number" != (
      SELECT
        publication_number
      FROM
        base_patent
    )
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND ae2."embedding_v1" IS NOT NULL
)
SELECT
  b.publication_number,
  s.pub_num2 AS most_similar_publication_number,
  ROUND(SUM(b_emb.VALUE::FLOAT * s_emb.VALUE::FLOAT), 4) AS similarity
FROM
  base_patent b
  CROSS JOIN same_year_patents s
  CROSS JOIN TABLE(FLATTEN(input => b.embedding1)) AS b_emb
  CROSS JOIN TABLE(FLATTEN(input => s.embedding2)) AS s_emb
WHERE
  b_emb.SEQ = s_emb.SEQ
GROUP BY
  b.publication_number,
  s.pub_num2
ORDER BY
  similarity DESC NULLS LAST
LIMIT
  1;
```
2025-01-20 06:13:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:13:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:13:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:13:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 06:13:26 - snowflake.connector.connection - INFO - closed
2025-01-20 06:13:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:13:27 - root - INFO - itercount: 5
2025-01-20 06:13:27 - root - INFO - 0
2025-01-20 06:13:27 - root - INFO - Total iteration counts: 5
