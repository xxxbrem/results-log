2025-01-30 01:15:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.446496 seconds
2025-01-30 01:16:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:16:11 - root - INFO - SQL:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   LIMIT 100;
Results:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
select_content
user_engagement
level_up
level_complete
level_fail
level_end
level_start
level_retry
completed_5_levels
ad_reward
no_more_extra_steps
use_extra_steps
spend_virtual_currency
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
challenge_a_friend
app_clear_data
app_update
firebase_campaign
error
first_open

2025-01-30 01:16:13 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   LIMIT 100;
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
92B0B6F48ECE132C7E502F94798FE205
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
05407E04B9FA64CB63D8FA1D966AD6A2
3A58859E074B02E8FB1CAEA291636112
5CDFC86835249BE3DB5E9F6778E344AD
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
3EF8FC940E379D53BBD3FEFDAF626BB2
DE4912FBC5F915C027000A8A6FF44F85
E6FEE8B98E75EA5311FE004F98559A27
E2D6E7FE36B7CDD0789CC8F03CC747E0
48AB910A8DE8485D4C34238EA61F782C
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
7AE4084BAA29B1987E51BF2964646805
2F8E2DBB938D2E43C2D171AF5F35EEF8
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
92BF054A90804B6D65F11D7CDFCDDEFC
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
A74EFE8BDAC26101B308D57A18B746CF
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
037DAC225F0C1E54657770CD201CDDA7
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
936906C2CB90CE437DBFC01BBD96BA39
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
27859DA5E38F4C681DA4FBF0CFB9F306
E451D416F972019604F1456533FF3858
60CFF65B640769B6FD3BC9593EDF7C1D
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
53866E32BA0ABFD846772D4B7B9B5921
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
60FAC27D8495BF33C2AE5283A7B07005
84D135997D8A4D9CB35D4ECA46EF6861
EBFE0623EF1109A89B392B9DF4375951
11A8D6037368A4C4508B11ADB4353BC4
CA04708DA02378999ECB402481FF1AE4
664F913ED3B54941B5F0886D94E01623
C87CDC0C4F86B10B7467281D516929B5
2F5BBABE9DD0271DCD62E501F76DA736
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
4DA8863CD8D2C860F6BB73579BC6F5C9
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
D3F06F9B7BD9D7FC8758BF78BF0705E9
8040FC9C0479C3B9A74ED298DD8F357D

2025-01-30 01:16:15 - root - INFO - SQL:
SELECT `event_name`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   WHERE `event_name` = 'session_start'
   LIMIT 100;
Results:
event_name,event_timestamp
session_start,1530589584539000
session_start,1530590823432000
session_start,1530575628990000
session_start,1530595690133000
session_start,1530524762026000
session_start,1530595547364000
session_start,1530537348131000
session_start,1530550116579000
session_start,1530527267502000
session_start,1530584690607000
session_start,1530527937271000
session_start,1530564905869000
session_start,1530567894551000
session_start,1530563931057000
session_start,1530553493162000
session_start,1530575777085000
session_start,1530567601322000
session_start,1530537253189000
session_start,1530540080873000
session_start,1530527811685000
session_start,1530536479885000
session_start,1530540083391000
session_start,1530541445557000
session_start,1530528802060000
session_start,1530558005449000
session_start,1530586060233000
session_start,1530588965822000
session_start,1530527685143000
session_start,1530539663424000
session_start,1530586744627000
session_start,1530577484922000
session_start,1530563463601000
session_start,1530574711375000
session_start,1530548915072000
session_start,1530537413324000
session_start,1530596935376000
session_start,1530568813625000
session_start,1530565337475000
session_start,1530584757404000
session_start,1530587985490001
session_start,1530524384702000
session_start,1530547011146000
session_start,1530560217753000
session_start,1530563006435000
session_start,1530589220695000
session_start,1530532340438000
session_start,1530524108918000
session_start,1530589138516000
session_start,1530565789539000
session_start,1530556394682000
session_start,1530524344568000
session_start,1530550472281000
session_start,1530560463979000
session_start,1530580351942000
session_start,1530597509240000
session_start,1530546017408000
session_start,1530551283625000
session_start,1530590236764000
session_start,1530553455244000
session_start,1530532887187000
session_start,1530538428708000
session_start,1530590501707000
session_start,1530596266195000
session_start,1530571454948000
session_start,1530575522023000
session_start,1530579695045000
session_start,1530576858767000
session_start,1530575390678000
session_start,1530522847898000
session_start,1530583403357001
session_start,1530588660683000
session_start,1530552986895000
session_start,1530518575006000
session_start,1530547394015000

2025-01-30 01:16:20 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
     AND _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   LIMIT 100;
Results:
user_pseudo_id,event_date
8065F8E98407106A65D35195984B2258,20180725
24D41A78A6BB1244608DB32351B0658B,20180725
CD896265D2278DDEEDA74C938150F20E,20180725
B458770ED6E295374FEEB3A68902CC28,20180725
B458770ED6E295374FEEB3A68902CC28,20180725
04311C56F5F87F352C135466C7087618,20180725
04311C56F5F87F352C135466C7087618,20180725
F7440C5660BC904383AFC518162113D0,20180725
B4653EE7AA5AB38E47F66AAE2F708BD9,20180725
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180725
F2ACDC8D64D4218BA63EB8732C110BA5,20180725
0CF7B8BCFC9CB9C51C6AA0438139D8E7,20180725
7410C5CC4FA11D31DB5F9B1D8ECD6BD0,20180725
73C04DD8207C972A09AAD26150EFBA84,20180725
77658D260DF82B3BB7B9DF495293BBF8,20180725
706C748E6D1E0768BFEFE6362B5D3F67,20180725
706C748E6D1E0768BFEFE6362B5D3F67,20180725
76DAA41DEAAA63479A9678E31B05A24B,20180725
D9AA0EC27AF47514DDB5C664A6EF758A,20180725
3EF8FC940E379D53BBD3FEFDAF626BB2,20180725
3EF8FC940E379D53BBD3FEFDAF626BB2,20180725
22ED306F6D149A2663ABEADED234C8DC,20180725
508DBEBFA1177CC5FA7CC5ECCEE8D0B2,20180725
508DBEBFA1177CC5FA7CC5ECCEE8D0B2,20180725
55BFC405FFA33C0781DE73101011E45B,20180725
90C9C09D72EA28C4450E48E748E1EF35,20180725
7DC8212A263404ECD48D5FFE3F2218AF,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
A043FFA09EE96E8FFE94BD16CF8D64CA,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
150372F747C719DC8DCC28EC8CBCD93E,20180725
EFB696A82D093B3AFBE92FF526DD5CEA,20180725
EFB696A82D093B3AFBE92FF526DD5CEA,20180725
EFB696A82D093B3AFBE92FF526DD5CEA,20180725
5E624075FDFE3003C34E1138546B2450,20180725
4D38AF508E466CDF5FF6FD9F93892F1E,20180725
DAC0EAB11F253D2173A6FAA79AF5DCAB,20180725
7FDDC95340BC25D0D2BD52328DCADD7E,20180725
74456352647C13028F89D1EEFFB905F4,20180725
938611E83B897B6F877992BF30D3E1FE,20180725
ED211F1428A518B0517E6DF406E70579,20180725
898B790ACC7834117A9B2C98A8B6F1F5,20180725
7919E77A6FB786831A0B13C69F1EF6C5,20180725
7919E77A6FB786831A0B13C69F1EF6C5,20180725
A516E6C57DEA6B0DB1D53021C406FD30,20180725
8B58F1ED945C2F35BD09EE96B688E460,20180725
8B58F1ED945C2F35BD09EE96B688E460,20180725
8B58F1ED945C2F35BD09EE96B688E460,20180725
648F91A3D0D868FC410FC4614FF11811,20180725
648F91A3D0D868FC410FC4614FF11811,20180725
8E6F7A428C907165D78A2377ABEB7315,20180725
051BB6E9EC8D2B13A70DB57A132B1A2F,20180725
051BB6E9EC8D2B13A70DB57A132B1A2F,20180725
E4C6FF8288DD4BFCDE93E2218E20643B,20180725
B1D1ED35873581A23E48C4CD03DDFF81,20180725
DD923792212D7FB98EA909BDEBBC206C,20180725

2025-01-30 01:16:25 - root - INFO - SQL:
SELECT DISTINCT `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   LIMIT 100;
Results:
event_date
20180815
20180816
20180910
20180731
20180812
20180706
20180820
20180929
20180817
20180722
20180917
20180905
20180920
20180925
20180919
20181002
20180906
20180803
20180830
20180813
20180710
20180831
20180808
20180915
20180802
20180913
20180822
20180804
20180927
20180720
20180702
20180827
20180823
20180718
20180819
20180810
20180724
20180911
20180811
20180907
20180814
20180730
20180916
20180826
20180908
20180807
20180705
20180707
20180708
20180709
20180729
20180704
20180921
20180721
20180926
20180715
20180828
20180924
20180930
20181001
20180716
20180825
20180703
20180728
20180805
20180801
20180719
20180717
20180904
20180712
20180829
20180806
20181003
20180928
20180901
20180902
20180723
20180914
20180909
20180923
20180711
20180818
20180727
20180714
20180918
20180903
20180824
20180821
20180912
20180809
20180725
20180922
20180726
20180713

2025-01-30 01:16:27 - root - INFO - SQL:
SELECT DISTINCT ep.key
   FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
   UNNEST(t.event_params) AS ep
   LIMIT 100;
Results:
key
value
firebase_screen_class
firebase_event_origin
firebase_screen_id
board
firebase_conversion
firebase_previous_id
firebase_previous_class
level
time
score
level_name
content_type
item_id
engagement_time_msec
type
ad_event_id
ad_unit_code
item_name
virtual_currency_name
fatal
timestamp
previous_os_version
previous_app_version
firebase_screen
firebase_previous_screen
gclid
click_timestamp
source
medium
error_value
firebase_error
term
system_app_update
update_with_analytics
previous_first_open_count
system_app

2025-01-30 01:16:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:16:59 - root - INFO - ```sql
SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.event_params) AS ep
LIMIT 100;
```

This query retrieves the `user_pseudo_id` along with keys and string values from the `event_params` column without any filtering conditions, ensuring that data is returned. It simplifies the previous query by removing specific conditions that may have led to no data being found.
2025-01-30 01:17:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:17:44 - root - INFO - SQL:
SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.event_params) AS ep
LIMIT 100;
Results:
user_pseudo_id,key,string_value
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,firebase_conversion,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,main_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,GameFinishedActivity

2025-01-30 01:17:51 - root - INFO - SQL:
-- Corrected SQL for Query 1:
SELECT `event_name`, COUNT(*) AS count
FROM `firebase-public-project.analytics_153293282.events_*`
GROUP BY `event_name`
ORDER BY count DESC
LIMIT 100
Results:
event_name,count
screen_view,2247623
user_engagement,1358958
level_start_quickplay,523430
level_end_quickplay,349729
post_score,242051
level_complete_quickplay,191088
level_fail_quickplay,137035
level_reset_quickplay,122278
select_content,105139
level_start,74417
session_start,74353
level_end,54582
level_retry,43345
level_up,35666
level_complete,33986
level_retry_quickplay,29939
level_fail,17353
spend_virtual_currency,9363
use_extra_steps,8945
level_reset,8535
firebase_campaign,5411
app_exception,5156
first_open,4322
os_update,3290
no_more_extra_steps,2792
app_remove,2639
app_update,2473
ad_reward,1912
completed_5_levels,1867
error,1714
challenge_a_friend,524
in_app_purchase,27
dynamic_link_app_open,19
app_clear_data,17
dynamic_link_first_open,16
challenge_accepted,5
notification_foreground,1

2025-01-30 01:17:52 - root - INFO - SQL:
-- Corrected SQL for Query 2:
SELECT `user_pseudo_id`, TIMESTAMP_MICROS(`event_timestamp`) AS `event_timestamp`, `event_name`
FROM `firebase-public-project.analytics_153293282.events_20180702`
ORDER BY `user_pseudo_id`, `event_timestamp`
LIMIT 100
Results:
user_pseudo_id,event_timestamp,event_name
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:10.567006+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:16.343005+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:19.017003+00:00,select_content
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:22.343008+00:00,level_start_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:40.099004+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:41.008006+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:51.075003+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:53.125004+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:53.640001+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:08.780001+00:00,level_end_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:23.095000+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:32.780002+00:00,post_score
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:35.622000+00:00,session_start
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:48.839024+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:49.848007+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:51.780000+00:00,level_complete_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:55.123021+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:59.987018+00:00,level_complete_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:03.987020+00:00,post_score
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:11.495013+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:17.814008+00:00,level_start_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:24.288023+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:25.987019+00:00,level_end_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:27.260022+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:28.733045+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:28.834025+00:00,level_start_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:30.428036+00:00,screen_view

2025-01-30 01:17:59 - root - INFO - SQL:
-- Corrected SQL for Query 3:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'session_start'
GROUP BY `event_date`
ORDER BY `event_date`
LIMIT 100
Results:
event_date,user_count
20180612,400
20180613,466
20180614,443
20180615,438
20180616,391
20180617,402
20180618,463
20180619,476
20180620,341
20180621,352
20180622,388
20180623,411
20180624,348
20180625,778
20180626,734
20180627,366
20180628,757
20180629,442
20180630,778
20180701,753
20180702,408
20180703,386
20180704,368
20180705,383
20180706,370
20180707,409
20180708,305
20180709,380
20180710,405
20180711,390
20180712,403
20180713,422
20180714,358
20180715,360
20180716,352
20180717,324
20180718,344
20180719,309
20180720,385
20180721,439
20180722,372
20180723,389
20180724,389
20180725,361
20180726,369
20180727,419
20180728,418
20180729,444
20180730,433
20180731,392
20180801,393
20180802,450
20180803,489
20180804,474
20180805,450
20180806,439
20180807,426
20180808,450
20180809,416
20180810,326
20180811,406
20180812,415
20180813,455
20180814,395
20180815,368
20180816,404
20180817,411
20180818,438
20180819,410
20180820,420
20180821,424
20180822,406
20180823,376
20180824,440
20180825,443
20180826,416
20180827,438
20180828,422
20180829,447
20180830,443
20180831,412
20180901,406
20180902,444
20180903,428
20180904,420
20180905,477
20180906,461
20180907,488
20180908,476
20180909,501
20180910,483
20180911,424
20180912,500
20180913,452
20180914,434
20180915,389
20180916,417
20180917,424
20180918,450
20180919,481

2025-01-30 01:18:01 - root - INFO - SQL:
-- Corrected SQL for Query 4:
SELECT t.`user_pseudo_id`, up.key, up.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.user_properties) AS up
LIMIT 100
Results:
user_pseudo_id,key,string_value
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true

2025-01-30 01:18:02 - root - INFO - SQL:
-- Corrected SQL for Query 5:
SELECT `event_timestamp`, TIMESTAMP_MICROS(`event_timestamp`) AS event_datetime
FROM `firebase-public-project.analytics_153293282.events_20180702`
LIMIT 100
Results:
event_timestamp,event_datetime
1530590034397045,2018-07-03 03:53:54.397045+00:00
1530592878437030,2018-07-03 04:41:18.437030+00:00
1530593467343003,2018-07-03 04:51:07.343003+00:00
1530589584539000,2018-07-03 03:46:24.539000+00:00
1530589632251002,2018-07-03 03:47:12.251002+00:00
1530589621295003,2018-07-03 03:47:01.295003+00:00
1530589675882001,2018-07-03 03:47:55.882001+00:00
1530589645899002,2018-07-03 03:47:25.899002+00:00
1530589700545007,2018-07-03 03:48:20.545007+00:00
1530589717674010,2018-07-03 03:48:37.674010+00:00
1530589696738011,2018-07-03 03:48:16.738011+00:00
1530589706400014,2018-07-03 03:48:26.400014+00:00
1530589836110019,2018-07-03 03:50:36.110019+00:00
1530589847132020,2018-07-03 03:50:47.132020+00:00
1530589838235024,2018-07-03 03:50:38.235024+00:00
1530589814532029,2018-07-03 03:50:14.532029+00:00
1530589844144032,2018-07-03 03:50:44.144032+00:00
1530589814394036,2018-07-03 03:50:14.394036+00:00
1530589876455037,2018-07-03 03:51:16.455037+00:00
1530589830110041,2018-07-03 03:50:30.110041+00:00
1530590080491048,2018-07-03 03:54:40.491048+00:00
1530590065505049,2018-07-03 03:54:25.505049+00:00
1530590096070052,2018-07-03 03:54:56.070052+00:00
1530592287744001,2018-07-03 04:31:27.744001+00:00
1530592270898005,2018-07-03 04:31:10.898005+00:00
1530592316934006,2018-07-03 04:31:56.934006+00:00
1530592322992011,2018-07-03 04:32:02.992011+00:00
1530592373007012,2018-07-03 04:32:53.007012+00:00
1530592377282017,2018-07-03 04:32:57.282017+00:00
1530592353412019,2018-07-03 04:32:33.412019+00:00
1530592366448020,2018-07-03 04:32:46.448020+00:00
1530592339807023,2018-07-03 04:32:19.807023+00:00
1530592933554034,2018-07-03 04:42:13.554034+00:00
1530592938568035,2018-07-03 04:42:18.568035+00:00
1530592921111037,2018-07-03 04:42:01.111037+00:00
1530592998341042,2018-07-03 04:43:18.341042+00:00
1530592957361043,2018-07-03 04:42:37.361043+00:00
1530592915792046,2018-07-03 04:41:55.792046+00:00

2025-01-30 01:18:04 - root - INFO - SQL:
-- Corrected SQL for Query 6:
SELECT device.category AS device_category, COUNT(*) AS count
FROM `firebase-public-project.analytics_153293282.events_20180702`
WHERE device.category IS NOT NULL
GROUP BY device_category
ORDER BY count DESC
LIMIT 100
Results:
device_category,count
mobile,38292
tablet,11708

2025-01-30 01:18:05 - root - INFO - SQL:
-- Corrected SQL for Query 7:
SELECT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180702`
LIMIT 100
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8

2025-01-30 01:18:07 - root - INFO - SQL:
-- Corrected SQL for Query 8:
SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.event_params) AS ep
LIMIT 100
Results:
user_pseudo_id,key,string_value
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,firebase_conversion,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,main_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,GameFinishedActivity

2025-01-30 01:18:07 - root - INFO - itercount: 0
2025-01-30 01:18:07 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- `user_pseudo_id`: Uniquely identifies users; used to group events by user.
- `event_name`: Used to identify 'session_start' events.
- `event_timestamp`: Timestamp of the event; used to determine when events occurred.
- `event_date`: Date of the event in 'YYYYMMDD' format; used to group events by date.
- `_TABLE_SUFFIX`: Suffix of the table name; used to query multiple date-partitioned tables.
- `event_params`: Contains additional parameters of events; can extract specific event details.

**Possible Conditions:**

- `event_name = 'session_start'`: To filter for session start events.
- `_TABLE_SUFFIX BETWEEN '20180702' AND '20181003'`: To limit the date range from July 2, 2018, to October 3, 2018.
- Using `DISTINCT` to get unique values.

**SQL Queries:**

1. **Get distinct event names from a specific date:**
   ```sql
   SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   LIMIT 100;
   ```

2. **Get distinct user pseudonymous IDs from a specific date:**
   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   LIMIT 100;
   ```

3. **Get event names and timestamps for 'session_start' events on a specific date:**
   ```sql
   SELECT `event_name`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   WHERE `event_name` = 'session_start'
   LIMIT 100;
   ```

4. **Get user pseudonymous IDs and event dates for 'session_start' events across multiple dates:**
   ```sql
   SELECT `user_pseudo_id`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
     AND _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   LIMIT 100;
   ```

5. **Get distinct event dates within a date range:**
   ```sql
   SELECT DISTINCT `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   LIMIT 100;
   ```

6. **Extract keys from the nested `event_params` column on a specific date:**
   ```sql
   SELECT DISTINCT ep.key
   FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
   UNNEST(t.event_params) AS ep
   LIMIT 100;
   ```

7. **Get user pseudonymous IDs and specific event parameter values:**
   ```sql
   SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
   FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
   UNNEST(t.event_params) AS ep
   WHERE ep.key = 'parameter_key'
   LIMIT 100;
   ```

8. **Get event names and their occurrence counts across multiple dates:**
   ```sql
   SELECT `event_name`, COUNT(*) AS count
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   GROUP BY `event_name`
   ORDER BY count DESC
   LIMIT 100;
   ```

9. **Get user pseudonymous IDs and event timestamps ordered by user and time:**
   ```sql
   SELECT `user_pseudo_id`, `event_timestamp`, `event_name`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   ORDER BY `user_pseudo_id`, `event_timestamp`
   LIMIT 100;
   ```

10. **Get counts of unique users per day based on 'session_start' events:**
    ```sql
    SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start'
      AND _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
    GROUP BY `event_date`
    ORDER BY `event_date`
    LIMIT 100;
    ```

11. **Extract values from the nested `user_properties` column:**
    ```sql
    SELECT t.`user_pseudo_id`, up.key, up.value.string_value
    FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
    UNNEST(t.user_properties) AS up
    LIMIT 100;
    ```

12. **Convert event timestamps to readable dates:**
    ```sql
    SELECT `event_timestamp`, TIMESTAMP_MICROS(`event_timestamp`) AS event_datetime
    FROM `firebase-public-project.analytics_153293282.events_20180702`
    LIMIT 100;
    ```

13. **Get device categories and their occurrence counts:**
    ```sql
    SELECT `device`.`category` AS device_category, COUNT(*) AS count
    FROM `firebase-public-project.analytics_153293282.events_20180702`
    GROUP BY `device_category`
    ORDER BY count DESC
    LIMIT 100;
    ```

14. **Get user IDs and pseudonymous IDs:**
    ```sql
    SELECT `user_id`, `user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_20180702`
    LIMIT 100;
    ```

15. **Get event parameters for 'session_start' events:**
    ```sql
    SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
    FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
    UNNEST(t.event_params) AS ep
    WHERE t.`event_name` = 'session_start'
    LIMIT 100;
    ```

These queries help in understanding the structure and content of the relevant columns necessary to calculate user retention by grouping users by the week of their first session start and identifying cohorts with the highest retention rates.Query:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   LIMIT 100;
Answer:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
select_content
user_engagement
level_up
level_complete
level_fail
level_end
level_start
level_retry
completed_5_levels
ad_reward
no_more_extra_steps
use_extra_steps
spend_virtual_currency
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
challenge_a_friend
app_clear_data
app_update
firebase_campaign
error
first_open
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   LIMIT 100;
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
92B0B6F48ECE132C7E502F94798FE205
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
05407E04B9FA64CB63D8FA1D966AD6A2
3A58859E074B02E8FB1CAEA291636112
5CDFC86835249BE3DB5E9F6778E344AD
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
3EF8FC940E379D53BBD3FEFDAF626BB2
DE4912FBC5F915C027000A8A6FF44F85
E6FEE8B98E75EA5311FE004F98559A27
E2D6E7FE36B7CDD0789CC8F03CC747E0
48AB910A8DE8485D4C34238EA61F782C
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
7AE4084BAA29B1987E51BF2964646805
2F8E2DBB938D2E43C2D171AF5F35EEF8
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
92BF054A90804B6D65F11D7CDFCDDEFC
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
A74EFE8BDAC26101B308D57A18B746CF
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
037DAC225F0C1E54657770CD201CDDA7
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
936906C2CB90CE437DBFC01BBD96BA39
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
27859DA5E38F4C681DA4FBF0CFB9F306
E451D416F972019604F1456533FF3858
60CFF65B640769B6FD3BC9593EDF7C1D
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
53866E32BA0ABFD846772D4B7B9B5921
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
60FAC27D8495BF33C2AE5283A7B07005
84D135997D8A4D9CB35D4ECA46EF6861
EBFE0623EF1109A89B392B9DF4375951
11A8D6037368A4C4508B11ADB4353BC4
CA04708DA02378999ECB402481FF1AE4
664F913ED3B54941B5F0886D94E01623
C87CDC0C4F86B10B7467281D516929B5
2F5BBABE9DD0271DCD62E501F76DA736
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
4DA8863CD8D2C860F6BB73579BC6F5C9
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
D3F06F9B7BD9D7FC8758BF78BF0705E9
8040FC9C0479C3B9A74ED298DD8F357D
Query:
SELECT `event_name`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_20180702`
   WHERE `event_name` = 'session_start'
   LIMIT 100;
Answer:
event_name,event_timestamp
session_start,1530589584539000
session_start,1530590823432000
session_start,1530575628990000
session_start,1530595690133000
session_start,1530524762026000
session_start,1530595547364000
session_start,1530537348131000
session_start,1530550116579000
session_start,1530527267502000
session_start,1530584690607000
session_start,1530527937271000
session_start,1530564905869000
session_start,1530567894551000
session_start,1530563931057000
session_start,1530553493162000
session_start,1530575777085000
session_start,1530567601322000
session_start,1530537253189000
session_start,1530540080873000
session_start,1530527811685000
session_start,1530536479885000
session_start,1530540083391000
session_start,1530541445557000
session_start,1530528802060000
session_start,1530558005449000
session_start,1530586060233000
session_start,1530588965822000
session_start,1530527685143000
session_start,1530539663424000
session_start,1530586744627000
session_start,1530577484922000
session_start,1530563463601000
session_start,1530574711375000
session_start,1530548915072000
session_start,1530537413324000
session_start,1530596935376000
session_start,1530568813625000
session_start,1530565337475000
session_start,1530584757404000
session_start,1530587985490001
session_start,1530524384702000
session_start,1530547011146000
session_start,1530560217753000
session_start,1530563006435000
session_start,1530589220695000
session_start,1530532340438000
session_start,1530524108918000
session_start,1530589138516000
session_start,1530565789539000
session_start,1530556394682000
session_start,1530524344568000
session_start,1530550472281000
session_start,1530560463979000
session_start,1530580351942000
session_start,1530597509240000
session_start,1530546017408000
session_start,1530551283625000
session_start,1530590236764000
session_start,1530553455244000
session_start,1530532887187000
session_start,1530538428708000
session_start,1530590501707000
session_start,1530596266195000
session_start,1530571454948000
session_start,1530575522023000
session_start,1530579695045000
session_start,1530576858767000
session_start,1530575390678000
session_start,1530522847898000
session_start,1530583403357001
session_start,1530588660683000
session_start,1530552986895000
session_start,1530518575006000
session_start,1530547394015000
Query:
SELECT `user_pseudo_id`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
     AND _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   LIMIT 100;
Answer:
user_pseudo_id,event_date
8065F8E98407106A65D35195984B2258,20180725
24D41A78A6BB1244608DB32351B0658B,20180725
CD896265D2278DDEEDA74C938150F20E,20180725
B458770ED6E295374FEEB3A68902CC28,20180725
B458770ED6E295374FEEB3A68902CC28,20180725
04311C56F5F87F352C135466C7087618,20180725
04311C56F5F87F352C135466C7087618,20180725
F7440C5660BC904383AFC518162113D0,20180725
B4653EE7AA5AB38E47F66AAE2F708BD9,20180725
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180725
F2ACDC8D64D4218BA63EB8732C110BA5,20180725
0CF7B8BCFC9CB9C51C6AA0438139D8E7,20180725
7410C5CC4FA11D31DB5F9B1D8ECD6BD0,20180725
73C04DD8207C972A09AAD26150EFBA84,20180725
77658D260DF82B3BB7B9DF495293BBF8,20180725
706C748E6D1E0768BFEFE6362B5D3F67,20180725
706C748E6D1E0768BFEFE6362B5D3F67,20180725
76DAA41DEAAA63479A9678E31B05A24B,20180725
D9AA0EC27AF47514DDB5C664A6EF758A,20180725
3EF8FC940E379D53BBD3FEFDAF626BB2,20180725
3EF8FC940E379D53BBD3FEFDAF626BB2,20180725
22ED306F6D149A2663ABEADED234C8DC,20180725
508DBEBFA1177CC5FA7CC5ECCEE8D0B2,20180725
508DBEBFA1177CC5FA7CC5ECCEE8D0B2,20180725
55BFC405FFA33C0781DE73101011E45B,20180725
90C9C09D72EA28C4450E48E748E1EF35,20180725
7DC8212A263404ECD48D5FFE3F2218AF,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
CFA0F8C5E25A71062E573EF8E6BC9F76,20180725
A043FFA09EE96E8FFE94BD16CF8D64CA,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
DA48D36D07835B1918BDF831AF83B5EF,20180725
150372F747C719DC8DCC28EC8CBCD93E,20180725
EFB696A82D093B3AFBE92FF526DD5CEA,20180725
EFB696A82D093B3AFBE92FF526DD5CEA,20180725
EFB696A82D093B3AFBE92FF526DD5CEA,20180725
5E624075FDFE3003C34E1138546B2450,20180725
4D38AF508E466CDF5FF6FD9F93892F1E,20180725
DAC0EAB11F253D2173A6FAA79AF5DCAB,20180725
7FDDC95340BC25D0D2BD52328DCADD7E,20180725
74456352647C13028F89D1EEFFB905F4,20180725
938611E83B897B6F877992BF30D3E1FE,20180725
ED211F1428A518B0517E6DF406E70579,20180725
898B790ACC7834117A9B2C98A8B6F1F5,20180725
7919E77A6FB786831A0B13C69F1EF6C5,20180725
7919E77A6FB786831A0B13C69F1EF6C5,20180725
A516E6C57DEA6B0DB1D53021C406FD30,20180725
8B58F1ED945C2F35BD09EE96B688E460,20180725
8B58F1ED945C2F35BD09EE96B688E460,20180725
8B58F1ED945C2F35BD09EE96B688E460,20180725
648F91A3D0D868FC410FC4614FF11811,20180725
648F91A3D0D868FC410FC4614FF11811,20180725
8E6F7A428C907165D78A2377ABEB7315,20180725
051BB6E9EC8D2B13A70DB57A132B1A2F,20180725
051BB6E9EC8D2B13A70DB57A132B1A2F,20180725
E4C6FF8288DD4BFCDE93E2218E20643B,20180725
B1D1ED35873581A23E48C4CD03DDFF81,20180725
DD923792212D7FB98EA909BDEBBC206C,20180725
Query:
SELECT DISTINCT `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
   LIMIT 100;
Answer:
event_date
20180815
20180816
20180910
20180731
20180812
20180706
20180820
20180929
20180817
20180722
20180917
20180905
20180920
20180925
20180919
20181002
20180906
20180803
20180830
20180813
20180710
20180831
20180808
20180915
20180802
20180913
20180822
20180804
20180927
20180720
20180702
20180827
20180823
20180718
20180819
20180810
20180724
20180911
20180811
20180907
20180814
20180730
20180916
20180826
20180908
20180807
20180705
20180707
20180708
20180709
20180729
20180704
20180921
20180721
20180926
20180715
20180828
20180924
20180930
20181001
20180716
20180825
20180703
20180728
20180805
20180801
20180719
20180717
20180904
20180712
20180829
20180806
20181003
20180928
20180901
20180902
20180723
20180914
20180909
20180923
20180711
20180818
20180727
20180714
20180918
20180903
20180824
20180821
20180912
20180809
20180725
20180922
20180726
20180713
Query:
SELECT DISTINCT ep.key
   FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
   UNNEST(t.event_params) AS ep
   LIMIT 100;
Answer:
key
value
firebase_screen_class
firebase_event_origin
firebase_screen_id
board
firebase_conversion
firebase_previous_id
firebase_previous_class
level
time
score
level_name
content_type
item_id
engagement_time_msec
type
ad_event_id
ad_unit_code
item_name
virtual_currency_name
fatal
timestamp
previous_os_version
previous_app_version
firebase_screen
firebase_previous_screen
gclid
click_timestamp
source
medium
error_value
firebase_error
term
system_app_update
update_with_analytics
previous_first_open_count
system_app
Query:
SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.event_params) AS ep
LIMIT 100;
Answer:
user_pseudo_id,key,string_value
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,firebase_conversion,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,main_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,GameFinishedActivity
Query:
-- Corrected SQL for Query 1:
SELECT `event_name`, COUNT(*) AS count
FROM `firebase-public-project.analytics_153293282.events_*`
GROUP BY `event_name`
ORDER BY count DESC
LIMIT 100
Answer:
event_name,count
screen_view,2247623
user_engagement,1358958
level_start_quickplay,523430
level_end_quickplay,349729
post_score,242051
level_complete_quickplay,191088
level_fail_quickplay,137035
level_reset_quickplay,122278
select_content,105139
level_start,74417
session_start,74353
level_end,54582
level_retry,43345
level_up,35666
level_complete,33986
level_retry_quickplay,29939
level_fail,17353
spend_virtual_currency,9363
use_extra_steps,8945
level_reset,8535
firebase_campaign,5411
app_exception,5156
first_open,4322
os_update,3290
no_more_extra_steps,2792
app_remove,2639
app_update,2473
ad_reward,1912
completed_5_levels,1867
error,1714
challenge_a_friend,524
in_app_purchase,27
dynamic_link_app_open,19
app_clear_data,17
dynamic_link_first_open,16
challenge_accepted,5
notification_foreground,1
Query:
-- Corrected SQL for Query 2:
SELECT `user_pseudo_id`, TIMESTAMP_MICROS(`event_timestamp`) AS `event_timestamp`, `event_name`
FROM `firebase-public-project.analytics_153293282.events_20180702`
ORDER BY `user_pseudo_id`, `event_timestamp`
LIMIT 100
Answer:
user_pseudo_id,event_timestamp,event_name
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:10.567006+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:16.343005+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:19.017003+00:00,select_content
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:22.343008+00:00,level_start_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:40.099004+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:41.008006+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:51.075003+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:53.125004+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:25:53.640001+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:08.780001+00:00,level_end_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:23.095000+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:32.780002+00:00,post_score
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:35.622000+00:00,session_start
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:48.839024+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:49.848007+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:51.780000+00:00,level_complete_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:55.123021+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:26:59.987018+00:00,level_complete_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:03.987020+00:00,post_score
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:11.495013+00:00,user_engagement
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:17.814008+00:00,level_start_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:24.288023+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:25.987019+00:00,level_end_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:27.260022+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:28.733045+00:00,screen_view
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:28.834025+00:00,level_start_quickplay
004D2DFEB866BFB00427DB2F530C1F3D,2018-07-02 18:27:30.428036+00:00,screen_view
Query:
-- Corrected SQL for Query 3:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'session_start'
GROUP BY `event_date`
ORDER BY `event_date`
LIMIT 100
Answer:
event_date,user_count
20180612,400
20180613,466
20180614,443
20180615,438
20180616,391
20180617,402
20180618,463
20180619,476
20180620,341
20180621,352
20180622,388
20180623,411
20180624,348
20180625,778
20180626,734
20180627,366
20180628,757
20180629,442
20180630,778
20180701,753
20180702,408
20180703,386
20180704,368
20180705,383
20180706,370
20180707,409
20180708,305
20180709,380
20180710,405
20180711,390
20180712,403
20180713,422
20180714,358
20180715,360
20180716,352
20180717,324
20180718,344
20180719,309
20180720,385
20180721,439
20180722,372
20180723,389
20180724,389
20180725,361
20180726,369
20180727,419
20180728,418
20180729,444
20180730,433
20180731,392
20180801,393
20180802,450
20180803,489
20180804,474
20180805,450
20180806,439
20180807,426
20180808,450
20180809,416
20180810,326
20180811,406
20180812,415
20180813,455
20180814,395
20180815,368
20180816,404
20180817,411
20180818,438
20180819,410
20180820,420
20180821,424
20180822,406
20180823,376
20180824,440
20180825,443
20180826,416
20180827,438
20180828,422
20180829,447
20180830,443
20180831,412
20180901,406
20180902,444
20180903,428
20180904,420
20180905,477
20180906,461
20180907,488
20180908,476
20180909,501
20180910,483
20180911,424
20180912,500
20180913,452
20180914,434
20180915,389
20180916,417
20180917,424
20180918,450
20180919,481
Query:
-- Corrected SQL for Query 4:
SELECT t.`user_pseudo_id`, up.key, up.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.user_properties) AS up
LIMIT 100
Answer:
user_pseudo_id,key,string_value
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
Query:
-- Corrected SQL for Query 5:
SELECT `event_timestamp`, TIMESTAMP_MICROS(`event_timestamp`) AS event_datetime
FROM `firebase-public-project.analytics_153293282.events_20180702`
LIMIT 100
Answer:
event_timestamp,event_datetime
1530590034397045,2018-07-03 03:53:54.397045+00:00
1530592878437030,2018-07-03 04:41:18.437030+00:00
1530593467343003,2018-07-03 04:51:07.343003+00:00
1530589584539000,2018-07-03 03:46:24.539000+00:00
1530589632251002,2018-07-03 03:47:12.251002+00:00
1530589621295003,2018-07-03 03:47:01.295003+00:00
1530589675882001,2018-07-03 03:47:55.882001+00:00
1530589645899002,2018-07-03 03:47:25.899002+00:00
1530589700545007,2018-07-03 03:48:20.545007+00:00
1530589717674010,2018-07-03 03:48:37.674010+00:00
1530589696738011,2018-07-03 03:48:16.738011+00:00
1530589706400014,2018-07-03 03:48:26.400014+00:00
1530589836110019,2018-07-03 03:50:36.110019+00:00
1530589847132020,2018-07-03 03:50:47.132020+00:00
1530589838235024,2018-07-03 03:50:38.235024+00:00
1530589814532029,2018-07-03 03:50:14.532029+00:00
1530589844144032,2018-07-03 03:50:44.144032+00:00
1530589814394036,2018-07-03 03:50:14.394036+00:00
1530589876455037,2018-07-03 03:51:16.455037+00:00
1530589830110041,2018-07-03 03:50:30.110041+00:00
1530590080491048,2018-07-03 03:54:40.491048+00:00
1530590065505049,2018-07-03 03:54:25.505049+00:00
1530590096070052,2018-07-03 03:54:56.070052+00:00
1530592287744001,2018-07-03 04:31:27.744001+00:00
1530592270898005,2018-07-03 04:31:10.898005+00:00
1530592316934006,2018-07-03 04:31:56.934006+00:00
1530592322992011,2018-07-03 04:32:02.992011+00:00
1530592373007012,2018-07-03 04:32:53.007012+00:00
1530592377282017,2018-07-03 04:32:57.282017+00:00
1530592353412019,2018-07-03 04:32:33.412019+00:00
1530592366448020,2018-07-03 04:32:46.448020+00:00
1530592339807023,2018-07-03 04:32:19.807023+00:00
1530592933554034,2018-07-03 04:42:13.554034+00:00
1530592938568035,2018-07-03 04:42:18.568035+00:00
1530592921111037,2018-07-03 04:42:01.111037+00:00
1530592998341042,2018-07-03 04:43:18.341042+00:00
1530592957361043,2018-07-03 04:42:37.361043+00:00
1530592915792046,2018-07-03 04:41:55.792046+00:00
Query:
-- Corrected SQL for Query 6:
SELECT device.category AS device_category, COUNT(*) AS count
FROM `firebase-public-project.analytics_153293282.events_20180702`
WHERE device.category IS NOT NULL
GROUP BY device_category
ORDER BY count DESC
LIMIT 100
Answer:
device_category,count
mobile,38292
tablet,11708
Query:
-- Corrected SQL for Query 7:
SELECT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180702`
LIMIT 100
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
654F30C1312F6C1A26DFDA9F076A62D8
Query:
-- Corrected SQL for Query 8:
SELECT t.`user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180702` AS t,
UNNEST(t.event_params) AS ep
LIMIT 100
Answer:
user_pseudo_id,key,string_value
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,value,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,app+gtm
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,board,S
654F30C1312F6C1A26DFDA9F076A62D8,firebase_conversion,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,main_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,FloodItActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,ExtraStepsActivity
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,game_board
654F30C1312F6C1A26DFDA9F076A62D8,firebase_event_origin,auto
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_class,shop_menu
654F30C1312F6C1A26DFDA9F076A62D8,firebase_previous_id,
654F30C1312F6C1A26DFDA9F076A62D8,firebase_screen_class,GameFinishedActivity
End Exploring Related Columns
Task: Can you group users by the week of their first session start, starting from July 2, 2018? For each group, calculate the retention rate in the fourth week (i.e., the percentage of users from the original group who returned in the fourth week after their first session). Please identify the cohort with the highest retention rate in the fourth week, and name the group by the Monday date of the cohort's first session week. Return the result in the format "YYYY-MM-DD".

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
YYYY-MM-DD
2018-07-16
(Attention: answer in one row)
```

**Explanation:**
By grouping users by the week of their first session starting from July 2, 2018, and calculating the retention rate in the fourth week for each cohort, we find that the cohort starting on **2018-07-16** had the highest retention rate in the fourth week. This means that a higher percentage of users who started their first session during the week of July 16, 2018, returned in their fourth week compared to cohorts from other weeks..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-30 01:18:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:18:47 - root - INFO - ```sql
WITH user_first_sessions AS (
  SELECT
    user_pseudo_id,
    MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_session_date
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
    AND event_name = 'session_start'
  GROUP BY
    user_pseudo_id
),

user_cohorts AS (
  SELECT
    user_pseudo_id,
    first_session_date,
    DATE_TRUNC(first_session_date, WEEK(MONDAY)) AS first_session_week
  FROM user_first_sessions
),

user_events AS (
  SELECT
    user_pseudo_id,
    PARSE_DATE('%Y%m%d', event_date) AS event_date
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20181031'
),

user_retention AS (
  SELECT
    uc.user_pseudo_id,
    uc.first_session_week,
    MAX(CASE WHEN ue.event_date BETWEEN DATE_ADD(uc.first_session_week, INTERVAL 21 DAY) AND DATE_ADD(uc.first_session_week, INTERVAL 27 DAY) THEN 1 ELSE 0 END) AS returned_in_fourth_week
  FROM
    user_cohorts uc
  LEFT JOIN
    user_events ue
  ON
    uc.user_pseudo_id = ue.user_pseudo_id
  GROUP BY
    uc.user_pseudo_id, uc.first_session_week
),

cohort_retention AS (
  SELECT
    first_session_week,
    COUNT(*) AS total_users,
    SUM(returned_in_fourth_week) AS users_returned_in_fourth_week,
    SAFE_DIVIDE(SUM(returned_in_fourth_week), COUNT(*)) AS retention_rate
  FROM
    user_retention
  GROUP BY
    first_session_week
)

SELECT
  FORMAT_DATE('%Y-%m-%d', first_session_week) AS cohort_week_start
FROM
  cohort_retention
ORDER BY
  retention_rate DESC, first_session_week
LIMIT 1
```
2025-01-30 01:18:53 - root - INFO - itercount: 1
2025-01-30 01:18:53 - root - INFO - 0
2025-01-30 01:18:53 - root - INFO - results: 
cohort_week_start
2018-07-02


2025-01-30 01:18:53 - root - INFO - Please check the answer again by reviewing Can you group users by the week of their first session start, starting from July 2, 2018? For each group, calculate the retention rate in the fourth week (i.e., the percentage of users from the original group who returned in the fourth week after their first session). Please identify the cohort with the highest retention rate in the fourth week, and name the group by the Monday date of the cohort's first session week. Return the result in the format "YYYY-MM-DD"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
YYYY-MM-DD
2018-07-16
(Attention: answer in one row)
```

**Explanation:**
By grouping users by the week of their first session starting from July 2, 2018, and calculating the retention rate in the fourth week for each cohort, we find that the cohort starting on **2018-07-16** had the highest retention rate in the fourth week. This means that a higher percentage of users who started their first session during the week of July 16, 2018, returned in their fourth week compared to cohorts from other weeks. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
cohort_week_start
2018-07-02
Current sql:
WITH user_first_sessions AS (
  SELECT
    user_pseudo_id,
    MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_session_date
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
    AND event_name = 'session_start'
  GROUP BY
    user_pseudo_id
),

user_cohorts AS (
  SELECT
    user_pseudo_id,
    first_session_date,
    DATE_TRUNC(first_session_date, WEEK(MONDAY)) AS first_session_week
  FROM user_first_sessions
),

user_events AS (
  SELECT
    user_pseudo_id,
    PARSE_DATE('%Y%m%d', event_date) AS event_date
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20181031'
),

user_retention AS (
  SELECT
    uc.user_pseudo_id,
    uc.first_session_week,
    MAX(CASE WHEN ue.event_date BETWEEN DATE_ADD(uc.first_session_week, INTERVAL 21 DAY) AND DATE_ADD(uc.first_session_week, INTERVAL 27 DAY) THEN 1 ELSE 0 END) AS returned_in_fourth_week
  FROM
    user_cohorts uc
  LEFT JOIN
    user_events ue
  ON
    uc.user_pseudo_id = ue.user_pseudo_id
  GROUP BY
    uc.user_pseudo_id, uc.first_session_week
),

cohort_retention AS (
  SELECT
    first_session_week,
    COUNT(*) AS total_users,
    SUM(returned_in_fourth_week) AS users_returned_in_fourth_week,
    SAFE_DIVIDE(SUM(returned_in_fourth_week), COUNT(*)) AS retention_rate
  FROM
    user_retention
  GROUP BY
    first_session_week
)

SELECT
  FORMAT_DATE('%Y-%m-%d', first_session_week) AS cohort_week_start
FROM
  cohort_retention
ORDER BY
  retention_rate DESC, first_session_week
LIMIT 1
2025-01-30 01:19:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:19:41 - root - INFO - ```sql
WITH user_first_sessions AS (
  SELECT
    user_pseudo_id,
    MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_session_date
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20181003'
    AND event_name = 'session_start'
  GROUP BY
    user_pseudo_id
),

user_cohorts AS (
  SELECT
    user_pseudo_id,
    first_session_date,
    DATE_TRUNC(first_session_date, WEEK(MONDAY)) AS first_session_week
  FROM user_first_sessions
),

user_events AS (
  SELECT
    user_pseudo_id,
    PARSE_DATE('%Y%m%d', event_date) AS event_date
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20181031'
),

user_retention AS (
  SELECT
    uc.user_pseudo_id,
    uc.first_session_week,
    MAX(CASE WHEN ue.event_date BETWEEN DATE_ADD(uc.first_session_week, INTERVAL 21 DAY) AND DATE_ADD(uc.first_session_week, INTERVAL 27 DAY) THEN 1 ELSE 0 END) AS returned_in_fourth_week
  FROM
    user_cohorts uc
  LEFT JOIN
    user_events ue
  ON
    uc.user_pseudo_id = ue.user_pseudo_id
  GROUP BY
    uc.user_pseudo_id, uc.first_session_week
),

cohort_retention AS (
  SELECT
    first_session_week,
    COUNT(*) AS total_users,
    SUM(returned_in_fourth_week) AS users_returned_in_fourth_week,
    SAFE_DIVIDE(SUM(returned_in_fourth_week), COUNT(*)) AS retention_rate
  FROM
    user_retention
  GROUP BY
    first_session_week
)

SELECT
  FORMAT_DATE('%Y-%m-%d', first_session_week) AS cohort_week_start
FROM
  cohort_retention
ORDER BY
  retention_rate DESC, first_session_week
LIMIT 1
```
2025-01-30 01:19:46 - root - INFO - itercount: 2
2025-01-30 01:19:46 - root - INFO - 0
2025-01-30 01:19:46 - root - INFO - Total iteration counts: 2
