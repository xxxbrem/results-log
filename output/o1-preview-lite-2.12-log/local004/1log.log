2025-02-10 13:45:12 - openai._base_client - INFO - Retrying request to /chat/completions in 0.442953 seconds
2025-02-10 13:46:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:46:27 - root - INFO - SQL:
SELECT DISTINCT "customer_id"
   FROM "customers"
   LIMIT 100;
Results:
customer_id
06b8999e2fba1a1fbc88172c00ba8bc7
18955e83d337fd6b2def6b18a428ac77
4e7b3e00288586ebd08712fdd0374a03
b2b6027bc5c5109e529d4dc6358b12c3
4f2d8ab171c80ec8364f7c12e35b23ad
879864dab9bc3047522c92c82e1212b8
fd826e7cf63160e536e0908c76c3f441
5e274e7a0c3809e14aba7ad5aae0d407
5adf08e34b2e993982a47070956c5c65
4b7139f34592b3a31687243a302fa75b
9fb35e4ed6f0a14a4977cd9aea4042bb
5aa9e4fdd4dfd20959cad2d772509598
b2d1536598b73a9abd18e0d75d92f0a3
eabebad39a88bb6f5b52376faec28612
1f1c7bf1c9b041b292af6c1c4470b753
206f3129c0e4d7d0b9550426023f0a08
a7c125a0a07b75146167b7f04a7f8e98
c5c61596a3b6bd0cee5766992c48a9a1
9b8ce803689b3562defaad4613ef426f
49d0ea0986edde72da777f15456a0ee0
154c4ded6991bdfa3cd249d11abf4130
690172ab319622688d3b4df42f676898
2938121a40a20953c43caa8c98787fcb
237098a64674ae89babdc426746260fc
cb721d7b4f271fd87011c4c83462c076
f681356046d9fde60e70c73a18d65ea2
167bd30a409e3e4127df5a9408ebd394
6e359a57a91f84095cc64e1b351aef8c
e0eea8f69a457b3f1fa246e44c9ebefd
e3109970a3fe8021d5ff82c577ce5606
261cb4f92498ca05d5bd1a327a261d9c
6f92779347724b67e44e3224f3b4cffd
2d5831cb2dff7cdefba62e950ae3dc7b
b2bed119388167a954382cca36c4777f
469634941c27cd844170935a3cf60b95
df0aa5b8586495e0ddf6b601122e43a1
41c8f4b570869791379a925899a6af8a
54f755c3fd2709231f9964a1430c5218
4c06b42fbf7b97ab10779cda5549cd1c
b6368ca0f56d4632f44d58ca431487b2
4a0e66fd30684aa1409cd1b66fec77cc
c168abb9077b7821adae01dc1f0886c5
a3b0fda37bae14cf754877bed475e80c
0ccd415657ae8a6cd1c71b00155a019e
c532a74a3ebf1bacce2e2bcce3783317
19cecb194f54e614b70d971306a9931b
f34a6e874087ec1f0e3dab9fdf659c5d
c132855c926907970dcf6f2bf0b33a24
df85b96ba2ce3e49bde101b1614f52ac
4d27341acd30a36bca39008ee9bb9050
d3b6830d18c7de943d1e707d1f061d40
79de53946db384e2d7a9bd131792ad17
a562ab1e728449e3461829dfe2e36f73
b64ed91eab98972150bdaf77ca921934
8247b5583327ab8be19f96e1fb82f77b
8fcaa9368903f3a9a28aeaff28c14638
a9b0d1c26105279e1b8edc63d06bd668
aa9f03ecd3728c9bd12e6d962c66c7cb
230c0d740401730c7197d16376893525
a905baa530258422594f1b05615bd225
4fa19f7da692e6bf9602aaad3c372eda
03f846ad03437d864a8d2a22976dcafe
de4e13fd7d6469c5ada77d0843c55e42
8276de07ef25225d412b8462d73f8664
cc32707d2e2f7c92ab449f9b28154809
a02f66c3af7b16eec19ddcd98b645fe3
26acee41e2f75689a5615892f06ea0bd
f64cdee66599119324ce57a97e43700d
7ab7a537b678b6dd73d825ff6ee7be9d
7300450cedf7e4c35c243c4a03c1e8a6
4c7241af24b5344cb01fe687643de4fe
97e126f19a6f04b3462619f36862bcd2
6d27a9361e591da38c87a5e70253f3f2
6810c3dc47f641181fcc7f73275c3d19
b514422efcf14bef34858a0829bef189
0aae2862f8eac77f10a34f44860720ac
6c9a5923526346cbc0bd7bbd92269c01
1b2cb35b19b40b61f953d32ea157b337
12d1b4294fef21016c9614eb31e55e15
f6529ffebe6b3440d45d89604a4239ac
8264e3518163dd09211870b24a5d741d
8392e3d4cfeec63f2a8bfea68bf1f91f
38d1cd89306128348ffdf4cc23f3a50a
91ec76836092bba85d11761078ed7bb5
f9dfa0a2934ffbb22e66924952548be8
5a3260cfde2a918b597dada7ddd247bb
ee3a81b2771fec5f9e982cdb1b3a4804
784c407781aa34749a388c9283782b56
3f6ede29d4c69cd3316d2035b6cec1fb
6bed27564bd99d78d09c1fac13da56fd
670254dd2e886ffe621b3831afb47d7d
f7cb015ff73be957ee6a30e2577742c5
ea2196dc456ba36fe4f6b81dca4867d4
09241c552e9fe2420997a6c535e9d408
e50a30de3c32f9406a7185f40ce6874d
f89c1a6b9c966869e441e55bc14acddc
23e96758fd640560e9b1fbcda90abfc4
369708cabd9831ea6fde670a3b602a92
5f8b4882b5a4ec7bf6d2107e6cd0cf29
ad6891a1937cb8723a2c08ba1ae59873

2025-02-10 13:46:27 - root - INFO - SQL:
SELECT "customer_id", "order_id"
   FROM "orders"
   LIMIT 100;
Results:
Too long, hard cut:
customer_id,order_id
9ef432eb6251297304e76186b10a928d,e481f51cbdc54678b7cc49136f2d6af7
b0830fb4747a6c6d20dea0b8c802d7ef,53cdb2fc8bc7dce0b6741e2150273451
41ce2a54c0b03bf3443c3d931a367089,47770eb9100c2d0c44946d9cf07ec65d
f88197465ea7920adcdbec7375364d82,949d5b44dbf5de918fe9c16f97b45f8a
8ab97904e6daea8866dbdbc4fb7aad2c,ad21c59c0840e6cb83a9ceb5573f8159
503740e9ca751ccdda7ba28e9ab8f608,a4591c265e18cb1dcee52889e2d8acc3
ed0271e0b7da060a393796590e7b737a,136cce7faa42fdb2cefd53fdc79a6098
9bdf08b4b3b52b5526ff42d37d47f222,6514b8ad8028c9f2cc2374ded245783f
f54a9f0e6b351c431402b8461ea51999,76c6e866289321a7c93b82b54852dc33
31ad1d1b63eb9962463f764d4e6e0c9d,e69bfb5eb88e0ed6a785585b27e16dbf
494dded5b201313c64ed7f100595b95c,e6ce16cb79ec1d90b1da9085a6118aeb
7711cf624183d843aafe81855097bc37,34513ce0c4fab462a55830c0989c7edb
d3e3b74c766bc6214e0c830b17ee2341,82566a660a982b15fb86e904c8d32918
19402a48fe860416adf93348aba37740,5ff96c15d0b717ac6ad1f3d77225a350
3df704f53d3f1d4818840b34ec672a9f,432aaf21d85167c2c86ec9448c4e42cc
3b6828a50ffe546942b7a473d70ac0fc,dcb36b511fcac050b97cd5c05de84dc3
738b086814c6fcc74b8cc583f8516ee3,403b97836b0c04a622354cf531062e5f
3187789bec990987628d7a9beb4dd6ac,116f0b09343b49556bbad5f35bee0cdf
059f7fc5719c7da6cbafe370971a8d70,85ce859fd6dc634de8d2f1e290444043
7f8c8b9c2ae27bf3300f670c3d478be8,83018ec114eee8641c97e08f7b4e926f
d2b091571da224a1b36412c18bc3bbfe,203096f03d82e0dffbc41ebc2e2bcfb7
4fa1cd166fa598be6de80fa84eaade43,f848643eec1d69395095eb3840d2051e
72ae281627a6102d9b3718528b420f8a,2807d0e504d6d4894d41672727bc139f
a166da34890074091a942054b36e4265,95266dbfb7e20354baba07964dac78d5
62b423aab58096ca514ba6aa06be2f98,f3e7c359154d965827355f39d6b1fdac
3a874b4d4c4b6543206ff5d89287f0c3,fbf9ac61453ac646ce8ad9783d7d0af6
7e20bf5ca92da68200643bda76c504c6,acce194856392f074dbf9dada14d8d82
8b212b9525f9e74e85e37ed6df37693e,dd78f560c270f1909639c11b925620ea
cce89a605105b148387c52e286ac8335,91b2a010e1e45e6ba3d133fa997597be
761df82feda9778854c6dafdaeb567e4,ecab90c9933c58908d3d6add7c6f5ae3
456dc10730fbdba34615447ea195d643,f70a0aff17df5a6cdd9a7196128bd354
52142aa69d8d0e1247ab0cada0f76023,1790eea0b567cf50911c057cf20f90f9
816f8653d5361cbf94e58c33f2502a5c,989225ba6d0ebd5873335f7e01de2ae7
d9ef95f98d8da3b492bb8c0447910498,d887b52c6516beb39e8cd44a5f8b60f7
cf8ffeddf027932e51e4eae73b384059,b276e4f8c0fb86bd82fce576f21713e0
5f16605299d698660e0606f7eae2d2f9,8563039e855156e48fccee4d611a3196
f5458ddc3545711efa883dd7ae7c4497,60550084e6b4c0cb89a87df1f3e5ebd9
295ae9b35379e077273387ff64354b6f,5acce57f8d9dfd55fa48e212a641a69d
2a1dfb647f32f4390e7b857c67458536,434d158e96bdd6972ad6e6d73ddcfd22
3391c4bc11a817e7973e498b0b023158,7206b86ea789983f7a273ea7fa0bc2a8
ddaff536587109b89777e0353215e150,1e7aff52cdbb2451ace09d0f848c3699
c7340080e394356141681bd4c9b8fe31,6ea2f835b4556291ffdc53fa0b3b95e8
8644be24d48806bc3a88fd59fb47ceb1,948097deef559c742e7ce321e5e58919
756fb9391752dad934e0fe3733378e57,d22e9fa5731b9e30e8b27afcdc2f8563
caded193e8e47b8362864762a83db3c5,ee64d42b8cf066f35eac1cf57de1aa85
4f28355e5c17a4a42d3ce2439a1d4501,6ebaec694d7025e2ad4a05dba887c032
569cf68214806a39acc0f39344aea67f,d17dc4a904426827ca80f2ccb3a6be56
12fd2740039676063a874b9567dfa651,25f4376934e13d3508486352e11a5db0
2b56e94c2f66f2d97cfa63356f69cee8,5820a1100976432c7968a52da59e9364
7f2178c5d771e17f507d3c1637339298,2ce1ad82022c1ba30c2079502ac725aa
9b18f3fc296990b97854e351334a32f6,138849fd84dff2fb4ca70a0a34c4aa1c
148348ff65384b4249b762579532e248,47aa4816b27ba60ec948cd019cc1afc1
79183cd650e2bb0d475b0067d45946ac,9faeb9b2746b9d7526aef5acb08e2aa0
f5afca14dfa9dc64251cf2b45c54c363,641fb0752bf5b5940c376b3a8bb9dc52
f178c1827f67a8467b0385b7378d951a,e425680f760cbc130be3e53a9773c584
67407057a7d5ee17d1cd09523f484d13,40c5e18f7d112b59b3e5113a59a905b3
2932d241d1f31e6df6c701d52370ae02,734e7d1bbaeb2ff82521ca0fe6fb6f79
684fa6da5134b9e4dab731e00011712d,66e4624ae69e7dc89bd50222b59f581f
911e4c37f5cafe1604fe6767034bf1ae,a685d016c8a26f71a0bb67821070e398
241e78de29b3090cfa1b5d73a8130c72,2edfd6d1f0b4cd0db4bf37b1b224d855
4632eb5a8f175f6fe020520ae0c678f3,68873cf91053cd11e6b49a766db5af1a
dd5095632e3953fc0947b8ab5176b0be,f346ad4ee8f630e5e4ddaf862a34e6dd
9916715c2ab6ee1710c9c32f0a534ad2,8f06cc6465925031568537b815f1198d
c77ee2d8ba1614a4d489a44166894938,ccbabeb0b02433bd0fcbac46e70339f2
81e08b08e5ed4472008030d70327c71f,688052146432ef8253587b930b01a06d
5dda11942d4f77bee3a46d71e442aec4,f271576bed568e896f99eb710cd3a6f8
74805bc388861fa350ed2fade8444e0b,686541986ecfb7d9296eb67719973bf0
4afc1dcca5fe8926fc97d60a4497f8ab,68e48e68da1f50f7c5838ea75e3a20dd
be8c14c16a4d47194ccdfe10f1fc5b1a,b52cc4919de82b4d696a4380d10804a3
a9d37ddc8ba4d9f6dbac7d8ec378cc95,fdf128b3630c21adc9ca4fb8a51b68ec
bb2f5e670f7155dc622c57e4b31d0a69,a6aeb116d2cb5013eb8a94585b71ffef
55e6b290205c84ddd23ddf5eb134efd4,fa516182d28f96f5f5c651026b0749ee
f5618502bee8eafdee72fb6955e2ebdf,6abaad69b8b349c3a529b4b91ce18e46
a90391a47de936d56c66a5366cba1462,974c1993ab8024d3ed16229183c2308d
388025bec8128ff20ec1a316ed4dcf02,82bce245b1c9148f8d19a55b9ff70644
afb19a4b667cb708caab312757ec3

2025-02-10 13:46:27 - root - INFO - SQL:
SELECT "order_id", "order_purchase_timestamp"
   FROM "orders"
   LIMIT 100;
Results:
Too long, hard cut:
order_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,2018-03-09 14:50:15
a685d016c8a26f71a0bb67821070e398,2017-03-13 18:14:36
2edfd6d1f0b4cd0db4bf37b1b224d855,2017-06-13 21:11:26
68873cf91053cd11e6b49a766db5af1a,2017-11-30 22:02:15
f346ad4ee8f630e5e4ddaf862a34e6dd,2018-08-05 13:09:48
8f06cc6465925031568537b815f1198d,2017-11-15 11:31:41
ccbabeb0b02433bd0fcbac46e70339f2,2018-02-19 20:31:09
688052146432ef8253587b930b01a06d,2018-04-22 08:48:13
f271576bed568e896f99eb710cd3a6f8,2018-01-07 21:44:54
686541986ecfb7d9296eb67719973bf0,2018-02-10 13:26:59
68e48e68da1f50f7c5838ea75e3a20dd,2018-06-18 16:02:23
b52cc4919de82b4d696a4380d10804a3,2018-06-13 13:47:39
fdf128b3630c21adc9ca4fb8a51b68ec,2018-07-15 08:33:19
a6aeb116d2cb5013eb8a94585b71ffef,2017-09-13 14:27:11
fa516182d28f96f5f5c651026b0749ee,2018-04-13 08:44:17
6abaad69b8b349c3a529b4b91ce18e46,2018-02-15 10:33:30
974c1993ab8024d3ed16229183c2308d,2017-02-20 11:45:39
82bce245b1c9148f8d19a55b9ff70644,2017-04-20 17:15:46
a910f58086d58b3ae6f37aa712d377b9,2017-09-15 09:19:48
bd4bd0194d6d29f83b8557d4b89b572a,2018-07-28 16:52:55
634e8f4c0f6744a626f77f39770ac6aa,2017-08-09 18:32:47
6d25592267349b322799e2beb687871e,2018-08-26 22:04:34
b8801cccd8068de30112e4f49903d74a,2017-07-30 03:06:35
2711a938db643b3f0b62ee2c8a2784aa,2017-12-22 00:17:37
3bc77ce8be27211bac313c2daa402d1a,2017-04-06 22:39:29
10c320f977c6a18f91b2d14be13128c6,2017-05-09 20:48:59
0a4a2fccb27bd83a892fa503987a595b,2017-04-20 20:42:44
e4de6d53ecff736bc68804b0b6e9f635,2017-10-16 14:56:50
6b860b35691d486e45dc98e3514ec5f6,2017-12-08 09:42:43
ec341c54a5ebf8ee0a67a8632aa7579b,2017-08-26 16:53:30
cadbb3657dac2dbbd5b84b12e7b78aad,2018-02-27 12:55:42
9defaf92cff22420e4e8ef7784815a55,2018-05-11 13:10:51
20e0101b20700188cadb288126949685,2018-01-22 19:22:22
0e782c3705510e717d28907746cbda82,2018-05-01 08:12:37
d3d6788577c9592da441752e8a1dd5e3,2017-09-19 22:17:15
86f21bf63784876b9fd6d35f46581d72,2018-04-11 22:32:31
8447ff843b2616c50c0ced28ab1dae03,2017

2025-02-10 13:46:27 - root - INFO - SQL:
SELECT "order_id", "payment_value"
   FROM "order_payments"
   LIMIT 100;
Results:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27

2025-02-10 13:46:27 - root - INFO - SQL:
SELECT o."customer_id", op."payment_value"
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   LIMIT 100;
Results:
customer_id,payment_value
9ef432eb6251297304e76186b10a928d,2.0
9ef432eb6251297304e76186b10a928d,18.12
9ef432eb6251297304e76186b10a928d,18.59
b0830fb4747a6c6d20dea0b8c802d7ef,141.46
41ce2a54c0b03bf3443c3d931a367089,179.12
f88197465ea7920adcdbec7375364d82,72.2
8ab97904e6daea8866dbdbc4fb7aad2c,28.62
503740e9ca751ccdda7ba28e9ab8f608,175.26
ed0271e0b7da060a393796590e7b737a,65.95
9bdf08b4b3b52b5526ff42d37d47f222,75.16
f54a9f0e6b351c431402b8461ea51999,35.95
31ad1d1b63eb9962463f764d4e6e0c9d,8.34
31ad1d1b63eb9962463f764d4e6e0c9d,161.42
494dded5b201313c64ed7f100595b95c,259.06
7711cf624183d843aafe81855097bc37,114.13
d3e3b74c766bc6214e0c830b17ee2341,50.13
19402a48fe860416adf93348aba37740,32.7
3df704f53d3f1d4818840b34ec672a9f,54.36
3b6828a50ffe546942b7a473d70ac0fc,146.45
738b086814c6fcc74b8cc583f8516ee3,1376.45
3187789bec990987628d7a9beb4dd6ac,43.09
059f7fc5719c7da6cbafe370971a8d70,29.75
7f8c8b9c2ae27bf3300f670c3d478be8,5.96
7f8c8b9c2ae27bf3300f670c3d478be8,24.86
7f8c8b9c2ae27bf3300f670c3d478be8,62.15
d2b091571da224a1b36412c18bc3bbfe,118.86
4fa1cd166fa598be6de80fa84eaade43,88.9
72ae281627a6102d9b3718528b420f8a,17.28
a166da34890074091a942054b36e4265,187.57
62b423aab58096ca514ba6aa06be2f98,104.11
3a874b4d4c4b6543206ff5d89287f0c3,125.43
7e20bf5ca92da68200643bda76c504c6,227.68
8b212b9525f9e74e85e37ed6df37693e,60.69
cce89a605105b148387c52e286ac8335,192.68
761df82feda9778854c6dafdaeb567e4,63.34
456dc10730fbdba34615447ea195d643,313.19
52142aa69d8d0e1247ab0cada0f76023,224.9
816f8653d5361cbf94e58c33f2502a5c,63.1
d9ef95f98d8da3b492bb8c0447910498,100.25
cf8ffeddf027932e51e4eae73b384059,188.41
5f16605299d698660e0606f7eae2d2f9,106.95
f5458ddc3545711efa883dd7ae7c4497,66.79
295ae9b35379e077273387ff64354b6f,43.0
2a1dfb647f32f4390e7b857c67458536,508.17
3391c4bc11a817e7973e498b0b023158,49.69
ddaff536587109b89777e0353215e150,154.19
c7340080e394356141681bd4c9b8fe31,356.12
8644be24d48806bc3a88fd59fb47ceb1,95.67
756fb9391752dad934e0fe3733378e57,121.62
caded193e8e47b8362864762a83db3c5,22.36
4f28355e5c17a4a42d3ce2439a1d4501,153.72
569cf68214806a39acc0f39344aea67f,54.82
12fd2740039676063a874b9567dfa651,82.33
2b56e94c2f66f2d97cfa63356f69cee8,52.24
7f2178c5d771e17f507d3c1637339298,130.56
9b18f3fc296990b97854e351334a32f6,52.84
148348ff65384b4249b762579532e248,71.91
79183cd650e2bb0d475b0067d45946ac,151.04
f5afca14dfa9dc64251cf2b45c54c363,386.33
f178c1827f67a8467b0385b7378d951a,50.25
67407057a7d5ee17d1cd09523f484d13,128.68
2932d241d1f31e6df6c701d52370ae02,43.46
684fa6da5134b9e4dab731e00011712d,91.68
911e4c37f5cafe1604fe6767034bf1ae,99.26
241e78de29b3090cfa1b5d73a8130c72,141.15
4632eb5a8f175f6fe020520ae0c678f3,91.66
dd5095632e3953fc0947b8ab5176b0be,53.66
9916715c2ab6ee1710c9c32f0a534ad2,317.34
c77ee2d8ba1614a4d489a44166894938,43.0
81e08b08e5ed4472008030d70327c71f,346.09
5dda11942d4f77bee3a46d71e442aec4,824.76
74805bc388861fa350ed2fade8444e0b,39.99
4afc1dcca5fe8926fc97d60a4497f8ab,392.6
be8c14c16a4d47194ccdfe10f1fc5b1a,55.02
a9d37ddc8ba4d9f6dbac7d8ec378cc95,46.2
bb2f5e670f7155dc622c57e4b31d0a69,59.34
55e6b290205c84ddd23ddf5eb134efd4,209.41
f5618502bee8eafdee72fb6955e2ebdf,57.0
a90391a47de936d56c66a5366cba1462,84.56
388025bec8128ff20ec1a316ed4dcf02,267.8
afb19a4b667cb708caab312757ec3d3f,145.66
636e15840ab051faa13d3f781b6e4233,37.83
05e996469a2bf9559c7122b87e156724,7.08
05e996469a2bf9559c7122b87e156724,227.2
5bb39c890c91b1d26801aa19a9336eac,201.82
f26a435864aebedff7f7c84f82ee229f,27.77
29cb486c739f9774c8eb542e07b56cd2,59.1
bf141bf67fbe428d558bcf0e018eab60,66.98
b673f0597cb0c4d12778f731045f361a,132.26
6772a0a230a2667d16c3620f000e1348,63.34
9f6618c17568ac301465fe7ad056c674,231.12
fee181bf648906d1c57f84f216976286,574.36
df9b032b2ad0fd6bf37dfb48e5f83845,29.92
93ada7a24817edda9f4ab998fa823d16,409.79
64fb950e760ec8b0db79154a1fa9c1bf,62.69
48558a50a7ba1aab61891936d2ca7681,105.56
3a897024068ed42a183de61d5727d866,37.38
8628fac2267e8c8804525da99c10ed0e,76.65
332df68ccac2f2f7d9e11299188f8bce,120.84
e28dd4261bed9c7ba89ecaf411b88f7c,238.69

2025-02-10 13:46:28 - root - INFO - SQL:
SELECT o."customer_id", SUM(op."payment_value") AS total_payment
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,total_payment
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,106.23
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,65.2
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49

2025-02-10 13:46:28 - root - INFO - SQL:
SELECT "customer_id", COUNT("order_id") AS num_orders
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
Results:
customer_id,num_orders
00012a2ce6f8dcda20d059ce98491703,1
000161a058600d5901f007fab4c27140,1
0001fd6190edaaf884bcaf3d49edf079,1
0002414f95344307404f0ace7a26f1d5,1
000379cdec625522490c315e70c7a9fb,1
0004164d20a9e969af783496f3408652,1
000419c5494106c306a97b5635748086,1
00046a560d407e99b969756e0b10f282,1
00050bf6e01e69d5c0fd612f1bcfb69c,1
000598caf2ef4117407665ac33275130,1
0005aefbb696d34b3424dccd0a0e9fd0,1
00062b33cb9f6fe976afdcff967ea74d,1
00066ccbe787a588c52bd5ff404590e3,1
00072d033fe2e59061ae5c3aff1a2be5,1
0009a69b72033b2d0ec8c69fc70ef768,1
000bf8121c3412d3057d32371c5d3395,1
000e943451fc2788ca6ac98a682f2f49,1
000f17e290c26b28549908a04cfe36c1,1
000fd45d6fedae68fc6676036610f879,1
0010068a73b7c56da5758c3f9e5c7375,1
001028b78fd413e19704b3867c369d3a,1
00104a47c29da701ce41ee52077587d9,1
001051abfcfdbed9f87b4266213a5df1,1
00114026c1b7b52ab1773f317ef4880b,1
001226b2341ef620415ce7bbafcfac28,1
0012a5c13793cf51e253f096a7e740dd,1
0013280441d86a4f7a8006efdaf1b0fe,1
0013cd8e350a7cc76873441e431dd5ee,1
001450ebb4a77efb3d68be5f7887cb1e,1
00146ad30454993879adaa91c518f68c,1
00155f0530cc7b2bf73cc3f81cb01c52,1
001574cd5824c0b1ea90dd4f4ba6d5b8,1
0015bc9fd2d5395446143e8b215d7c75,1
0015f7887e2fde13ddaa7b8e385af919,1
0017a0b4c1f1bdb9c395fa0ac517109c,1
0018c09f333634ca9c80d9ff46e43e9c,1
0018f7fde63ca77254dbc47f4ea358b2,1
0019c9aaad15b043c48f0a1180f22ce8,1
001a57041f56400917a187dd74e6cbc1,1
001b4e9b73aa98a6276b241bfd496822,1
001c7f05398c45b42eee0d5a77783bca,1
001df1ee5c36767aa607001ab1a13a06,1
001f150aebb5d897f2059b0460c38449,1
001f35d9f262c558fd065346fbf5801d,1
001f6f1a5e902ad14e1f709a7215de11,1
00205ad9ba1ef4340cef86583294cf82,1
002236c4f333bc8df6a5939749eb7869,1
002348c1099e3229276c8ad7d4ddc702,1
002408f390f729598bbac1ef9421c6ae,1
002450e9ea44cb90b8a07ba0b197e149,1
002554bdf9eb99618d8189c3a89fdd52,1
0026955706fd4e2fa997f3f4c18d485a,1
0026d252429f669d454d726e5e956aa1,1
002834b4d901534f48d9e9a72047b288,1
0028ff36263a86bf679df7c863a0a0ba,1
002905287304e28c0218389269b4759b,1
002937abdae13680e17dccd3868b4825,1
0029cdf064769cabdf3186b54d068c99,1
002a10e899b62a460b0116e0b68697ad,1
002b24cb2cd0c3e575040dbd278885e3,1
002b5342c72978cf0aba6aae1f5d5293,1
002c625393dfa194828b462a6ef8cb0b,1
002ce108ccf0356ef5c8b1dce3c0ae29,1
002d358e2462f87678443706cbf2eb21,1
002d597546b2cf44428232c9f237f873,1
002ebb669a34b9e79c88efc755e95322,1
002ef7e55600d44ead53f7c1644e5222,1
002f067b028a3643ad3a0969c7a0f3dc,1
002f90a6eb386bc43bc9ba200db31a89,1
002fb8fc5ce64f8422fa2fe79986c783,1
002ff70a5285669011090c077ef929af,1
00302a0b99783c3d1d1e81c616e321e8,1
0030aded3a67b29946a128ee8468388e,1
0030fbb95fbe7e61f798a80edb01a8e9,1
00314f95a054231742e3c5396b333b88,1
003177b3eeca50af17750f53802c9a09,1
0031abfb953b66e998f67b09e7b11375,1
0031c1062edf836ef7a7a7ea758b137b,1
00330644cccc5db0276fa836976306fe,1
00331de1659c7f4fb660c8810e6de3f5,1
0033823ee55671ac5317d423291333c2,1
0034f7933de3ead6bd9ba49afe95f119,1
003536ce5e18f1d12b9bf76932f8a6b1,1
0035b30e58c620fa2bd30275ddd4f7ef,1
0036875772a8eeb391b8cd7226283fdd,1
0037d14e53af1d555a582504a4058f4c,1
00380c010de38d578d02117f6d0b88e7,1
0039b3e41ac6615814a0b44a8992bff5,1
003a75d228dc67cb2918e40c2aacc4bf,1
003b595c764773e20e0949b6fba7b1dc,1
003bc8d06ebed9d146eb9f100d0a89ae,1
003bdf7fd8312f9d14a4b979f3747334,1
003c7cadba4f182b9f22d7d5ea7a5003,1
003cb2c7ce25d8af8556fb456f903546,1
003cbe6a43560a8b6fd2c07531257c2d,1
003e45472805afa1ee701d83284fa22b,1
003eab528664e1bd677218ef4be086ac,1
003ec17a1389fa302f3a0423dddd8650,1
003f7d92ac63c512bb6584219806f8df,1
0040a8417928d0d5abd5169cd7877181,1

2025-02-10 13:46:28 - root - INFO - SQL:
SELECT "customer_id", MIN("order_purchase_timestamp") AS first_purchase, MAX("order_purchase_timestamp") AS last_purchase
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
Results:
Too long, hard cut:
customer_id,first_purchase,last_purchase
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13,2017-05-14 23:55:13
001574cd5824c0b1ea90dd4f4ba6d5b8,2017-11-26 02:13:57,2017-11-26 02:13:57
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33,2018-01-22 20:16:33
002348c1099e3229276c8ad7d4ddc702,2018-01-10 12:28:22,2018-01-10 12:28:22
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45,2018-08-20 11:23:45
0026d252429f669d454d726e5e956aa1,2017-11-09 16:08:41,2017-11-09 16:08:41
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32,2018-05-21 23:17:32
002b5342c72978cf0aba6aae1f5d5293,2018-09-10 17:51:25,2018-09-10 17:51:25
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12,2017-10-19 09:3

2025-02-10 13:46:28 - root - INFO - SQL:
SELECT o."customer_id", AVG(op."payment_value") AS avg_payment_per_order
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,avg_payment_per_order
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,26.5575
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,21.733333333333334
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49

2025-02-10 13:47:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:47:09 - root - INFO - ```sql
SELECT
    customer_stats."customer_id",
    customer_stats.num_orders,
    customer_stats.avg_payment_per_order,
    customer_stats.lifespan_weeks
FROM (
    SELECT
        o."customer_id",
        COUNT(DISTINCT o."order_id") AS num_orders,
        AVG(op_total.order_total_payment) AS avg_payment_per_order,
        CASE
            WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
            THEN 1.0
            ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
        END AS lifespan_weeks
    FROM "orders" AS o
    JOIN (
        SELECT "order_id", SUM("payment_value") AS order_total_payment
        FROM "order_payments"
        GROUP BY "order_id"
    ) AS op_total ON o."order_id" = op_total."order_id"
    GROUP BY o."customer_id"
) AS customer_stats
ORDER BY customer_stats.avg_payment_per_order DESC
LIMIT 3;
```

This SQL query calculates the number of orders, average payment per order, and customer lifespan in weeks for the top 3 customers with the highest average payment per order.

**Explanation:**

- **Calculating Total Payment per Order:**
  - The subquery `(SELECT "order_id", SUM("payment_value") AS order_total_payment FROM "order_payments" GROUP BY "order_id")` calculates the total payment for each order. This handles orders with multiple payment installments.

- **Calculating Metrics per Customer:**
  - We join the orders table `o` with the total payments per order `op_total` on `"order_id"`.
  - For each customer, we calculate:
    - `num_orders` as the count of distinct orders.
    - `avg_payment_per_order` as the average of the total payments for their orders.
    - `lifespan_weeks` by:
      - Calculating the difference in days between the latest and earliest purchase dates using `JULIANDAY`.
      - If the difference is less than 7 days, we set `lifespan_weeks` to `1.0`.
      - Otherwise, we divide the difference by `7.0` to get the lifespan in weeks.

- **Selecting Top 3 Customers:**
  - We order the results by `avg_payment_per_order` in descending order to identify the top 3 customers.
  - The final `LIMIT 3` ensures only the top 3 customers are returned.

**Note:** This query accounts for any potential empty or null values in the `order_purchase_timestamp` column by using aggregate functions that inherently handle nulls. Ensure that the timestamps are in a compatible format for the `JULIANDAY` function. If there are orders without purchase timestamps, those records might need to be filtered out or handled appropriately.
2025-02-10 13:48:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:48:40 - root - INFO - SQL:
SELECT
    customer_stats."customer_id",
    customer_stats.num_orders,
    customer_stats.avg_payment_per_order,
    customer_stats.lifespan_weeks
FROM (
    SELECT
        o."customer_id",
        COUNT(DISTINCT o."order_id") AS num_orders,
        AVG(op_total.order_total_payment) AS avg_payment_per_order,
        CASE
            WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
            THEN 1.0
            ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
        END AS lifespan_weeks
    FROM "orders" AS o
    JOIN (
        SELECT "order_id", SUM("payment_value") AS order_total_payment
        FROM "order_payments"
        GROUP BY "order_id"
    ) AS op_total ON o."order_id" = op_total."order_id"
    GROUP BY o."customer_id"
) AS customer_stats
ORDER BY customer_stats.avg_payment_per_order DESC
LIMIT 3;
Results:
customer_id,num_orders,avg_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0

2025-02-10 13:48:40 - root - INFO - SQL:
SELECT "customer_id",
       CASE
         WHEN (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) < 7.0
         THEN 1.0
         ELSE (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0
       END AS lifespan_weeks
FROM "orders"
GROUP BY "customer_id"
LIMIT 100
Results:
customer_id,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1.0
000161a058600d5901f007fab4c27140,1.0
0001fd6190edaaf884bcaf3d49edf079,1.0
0002414f95344307404f0ace7a26f1d5,1.0
000379cdec625522490c315e70c7a9fb,1.0
0004164d20a9e969af783496f3408652,1.0
000419c5494106c306a97b5635748086,1.0
00046a560d407e99b969756e0b10f282,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1.0
000598caf2ef4117407665ac33275130,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1.0
00062b33cb9f6fe976afdcff967ea74d,1.0
00066ccbe787a588c52bd5ff404590e3,1.0
00072d033fe2e59061ae5c3aff1a2be5,1.0
0009a69b72033b2d0ec8c69fc70ef768,1.0
000bf8121c3412d3057d32371c5d3395,1.0
000e943451fc2788ca6ac98a682f2f49,1.0
000f17e290c26b28549908a04cfe36c1,1.0
000fd45d6fedae68fc6676036610f879,1.0
0010068a73b7c56da5758c3f9e5c7375,1.0
001028b78fd413e19704b3867c369d3a,1.0
00104a47c29da701ce41ee52077587d9,1.0
001051abfcfdbed9f87b4266213a5df1,1.0
00114026c1b7b52ab1773f317ef4880b,1.0
001226b2341ef620415ce7bbafcfac28,1.0
0012a5c13793cf51e253f096a7e740dd,1.0
0013280441d86a4f7a8006efdaf1b0fe,1.0
0013cd8e350a7cc76873441e431dd5ee,1.0
001450ebb4a77efb3d68be5f7887cb1e,1.0
00146ad30454993879adaa91c518f68c,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1.0
0015bc9fd2d5395446143e8b215d7c75,1.0
0015f7887e2fde13ddaa7b8e385af919,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1.0
0018c09f333634ca9c80d9ff46e43e9c,1.0
0018f7fde63ca77254dbc47f4ea358b2,1.0
0019c9aaad15b043c48f0a1180f22ce8,1.0
001a57041f56400917a187dd74e6cbc1,1.0
001b4e9b73aa98a6276b241bfd496822,1.0
001c7f05398c45b42eee0d5a77783bca,1.0
001df1ee5c36767aa607001ab1a13a06,1.0
001f150aebb5d897f2059b0460c38449,1.0
001f35d9f262c558fd065346fbf5801d,1.0
001f6f1a5e902ad14e1f709a7215de11,1.0
00205ad9ba1ef4340cef86583294cf82,1.0
002236c4f333bc8df6a5939749eb7869,1.0
002348c1099e3229276c8ad7d4ddc702,1.0
002408f390f729598bbac1ef9421c6ae,1.0
002450e9ea44cb90b8a07ba0b197e149,1.0
002554bdf9eb99618d8189c3a89fdd52,1.0
0026955706fd4e2fa997f3f4c18d485a,1.0
0026d252429f669d454d726e5e956aa1,1.0
002834b4d901534f48d9e9a72047b288,1.0
0028ff36263a86bf679df7c863a0a0ba,1.0
002905287304e28c0218389269b4759b,1.0
002937abdae13680e17dccd3868b4825,1.0
0029cdf064769cabdf3186b54d068c99,1.0
002a10e899b62a460b0116e0b68697ad,1.0
002b24cb2cd0c3e575040dbd278885e3,1.0
002b5342c72978cf0aba6aae1f5d5293,1.0
002c625393dfa194828b462a6ef8cb0b,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1.0
002d358e2462f87678443706cbf2eb21,1.0
002d597546b2cf44428232c9f237f873,1.0
002ebb669a34b9e79c88efc755e95322,1.0
002ef7e55600d44ead53f7c1644e5222,1.0
002f067b028a3643ad3a0969c7a0f3dc,1.0
002f90a6eb386bc43bc9ba200db31a89,1.0
002fb8fc5ce64f8422fa2fe79986c783,1.0
002ff70a5285669011090c077ef929af,1.0
00302a0b99783c3d1d1e81c616e321e8,1.0
0030aded3a67b29946a128ee8468388e,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1.0
00314f95a054231742e3c5396b333b88,1.0
003177b3eeca50af17750f53802c9a09,1.0
0031abfb953b66e998f67b09e7b11375,1.0
0031c1062edf836ef7a7a7ea758b137b,1.0
00330644cccc5db0276fa836976306fe,1.0
00331de1659c7f4fb660c8810e6de3f5,1.0
0033823ee55671ac5317d423291333c2,1.0
0034f7933de3ead6bd9ba49afe95f119,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1.0
0036875772a8eeb391b8cd7226283fdd,1.0
0037d14e53af1d555a582504a4058f4c,1.0
00380c010de38d578d02117f6d0b88e7,1.0
0039b3e41ac6615814a0b44a8992bff5,1.0
003a75d228dc67cb2918e40c2aacc4bf,1.0
003b595c764773e20e0949b6fba7b1dc,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1.0
003bdf7fd8312f9d14a4b979f3747334,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1.0
003cb2c7ce25d8af8556fb456f903546,1.0
003cbe6a43560a8b6fd2c07531257c2d,1.0
003e45472805afa1ee701d83284fa22b,1.0
003eab528664e1bd677218ef4be086ac,1.0
003ec17a1389fa302f3a0423dddd8650,1.0
003f7d92ac63c512bb6584219806f8df,1.0
0040a8417928d0d5abd5169cd7877181,1.0

2025-02-10 13:48:41 - root - INFO - SQL:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS num_orders,
       AVG(op_total.order_total_payment) AS avg_payment_per_order
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
LIMIT 100
Results:
customer_id,num_orders,avg_payment_per_order
00012a2ce6f8dcda20d059ce98491703,1,114.74
000161a058600d5901f007fab4c27140,1,67.41
0001fd6190edaaf884bcaf3d49edf079,1,195.42
0002414f95344307404f0ace7a26f1d5,1,179.35
000379cdec625522490c315e70c7a9fb,1,107.01
0004164d20a9e969af783496f3408652,1,71.8
000419c5494106c306a97b5635748086,1,49.4
00046a560d407e99b969756e0b10f282,1,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,1,85.23
000598caf2ef4117407665ac33275130,1,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,1,147.33
00062b33cb9f6fe976afdcff967ea74d,1,58.95
00066ccbe787a588c52bd5ff404590e3,1,270.0
00072d033fe2e59061ae5c3aff1a2be5,1,106.97
0009a69b72033b2d0ec8c69fc70ef768,1,173.6
000bf8121c3412d3057d32371c5d3395,1,45.56
000e943451fc2788ca6ac98a682f2f49,1,106.23
000f17e290c26b28549908a04cfe36c1,1,139.52
000fd45d6fedae68fc6676036610f879,1,66.81
0010068a73b7c56da5758c3f9e5c7375,1,54.83
001028b78fd413e19704b3867c369d3a,1,37.61
00104a47c29da701ce41ee52077587d9,1,100.34
001051abfcfdbed9f87b4266213a5df1,1,65.2
00114026c1b7b52ab1773f317ef4880b,1,66.01
001226b2341ef620415ce7bbafcfac28,1,47.53
0012a5c13793cf51e253f096a7e740dd,1,369.92
0013280441d86a4f7a8006efdaf1b0fe,1,162.15
0013cd8e350a7cc76873441e431dd5ee,1,92.6
001450ebb4a77efb3d68be5f7887cb1e,1,61.33
00146ad30454993879adaa91c518f68c,1,221.79
00155f0530cc7b2bf73cc3f81cb01c52,1,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,1,184.94
0015bc9fd2d5395446143e8b215d7c75,1,132.19
0015f7887e2fde13ddaa7b8e385af919,1,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,1,50.01
0018c09f333634ca9c80d9ff46e43e9c,1,56.87
0018f7fde63ca77254dbc47f4ea358b2,1,51.27
0019c9aaad15b043c48f0a1180f22ce8,1,112.83
001a57041f56400917a187dd74e6cbc1,1,53.72
001b4e9b73aa98a6276b241bfd496822,1,82.87
001c7f05398c45b42eee0d5a77783bca,1,21.94
001df1ee5c36767aa607001ab1a13a06,1,42.86
001f150aebb5d897f2059b0460c38449,1,125.97
001f35d9f262c558fd065346fbf5801d,1,46.53
001f6f1a5e902ad14e1f709a7215de11,1,34.86
00205ad9ba1ef4340cef86583294cf82,1,928.7
002236c4f333bc8df6a5939749eb7869,1,69.84
002348c1099e3229276c8ad7d4ddc702,1,249.56
002408f390f729598bbac1ef9421c6ae,1,258.01
002450e9ea44cb90b8a07ba0b197e149,1,40.0
002554bdf9eb99618d8189c3a89fdd52,1,244.08
0026955706fd4e2fa997f3f4c18d485a,1,121.9
0026d252429f669d454d726e5e956aa1,1,139.15
002834b4d901534f48d9e9a72047b288,1,214.14
0028ff36263a86bf679df7c863a0a0ba,1,74.94
002905287304e28c0218389269b4759b,1,31.7
002937abdae13680e17dccd3868b4825,1,43.55
0029cdf064769cabdf3186b54d068c99,1,483.7
002a10e899b62a460b0116e0b68697ad,1,92.81
002b24cb2cd0c3e575040dbd278885e3,1,40.22
002b5342c72978cf0aba6aae1f5d5293,1,51.17
002c625393dfa194828b462a6ef8cb0b,1,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,1,185.6
002d358e2462f87678443706cbf2eb21,1,45.61
002d597546b2cf44428232c9f237f873,1,117.74
002ebb669a34b9e79c88efc755e95322,1,133.57
002ef7e55600d44ead53f7c1644e5222,1,199.02
002f067b028a3643ad3a0969c7a0f3dc,1,107.84
002f90a6eb386bc43bc9ba200db31a89,1,153.51
002fb8fc5ce64f8422fa2fe79986c783,1,67.68
002ff70a5285669011090c077ef929af,1,81.14
00302a0b99783c3d1d1e81c616e321e8,1,159.48
0030aded3a67b29946a128ee8468388e,1,58.59
0030fbb95fbe7e61f798a80edb01a8e9,1,26.85
00314f95a054231742e3c5396b333b88,1,59.34
003177b3eeca50af17750f53802c9a09,1,133.81
0031abfb953b66e998f67b09e7b11375,1,671.85
0031c1062edf836ef7a7a7ea758b137b,1,81.0
00330644cccc5db0276fa836976306fe,1,55.1
00331de1659c7f4fb660c8810e6de3f5,1,243.69
0033823ee55671ac5317d423291333c2,1,79.48
0034f7933de3ead6bd9ba49afe95f119,1,84.24
003536ce5e18f1d12b9bf76932f8a6b1,1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,1,78.2
0036875772a8eeb391b8cd7226283fdd,1,61.85
0037d14e53af1d555a582504a4058f4c,1,603.4
00380c010de38d578d02117f6d0b88e7,1,64.1
0039b3e41ac6615814a0b44a8992bff5,1,34.59
003a75d228dc67cb2918e40c2aacc4bf,1,79.28
003b595c764773e20e0949b6fba7b1dc,1,25.46
003bc8d06ebed9d146eb9f100d0a89ae,1,600.04
003bdf7fd8312f9d14a4b979f3747334,1,43.68
003c7cadba4f182b9f22d7d5ea7a5003,1,128.25
003cb2c7ce25d8af8556fb456f903546,1,420.94
003cbe6a43560a8b6fd2c07531257c2d,1,27.75
003e45472805afa1ee701d83284fa22b,1,30.6
003eab528664e1bd677218ef4be086ac,1,77.1
003ec17a1389fa302f3a0423dddd8650,1,17.77
003f7d92ac63c512bb6584219806f8df,1,84.91
0040a8417928d0d5abd5169cd7877181,1,219.49

2025-02-10 13:48:41 - root - INFO - SQL:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS num_orders,
       AVG(op_total.order_total_payment) AS avg_payment_per_order,
       CASE
         WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
         THEN 1.0
         ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
       END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
LIMIT 100
Results:
customer_id,num_orders,avg_payment_per_order,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1,114.74,1.0
000161a058600d5901f007fab4c27140,1,67.41,1.0
0001fd6190edaaf884bcaf3d49edf079,1,195.42,1.0
0002414f95344307404f0ace7a26f1d5,1,179.35,1.0
000379cdec625522490c315e70c7a9fb,1,107.01,1.0
0004164d20a9e969af783496f3408652,1,71.8,1.0
000419c5494106c306a97b5635748086,1,49.4,1.0
00046a560d407e99b969756e0b10f282,1,166.59,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1,85.23,1.0
000598caf2ef4117407665ac33275130,1,1255.71,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1,147.33,1.0
00062b33cb9f6fe976afdcff967ea74d,1,58.95,1.0
00066ccbe787a588c52bd5ff404590e3,1,270.0,1.0
00072d033fe2e59061ae5c3aff1a2be5,1,106.97,1.0
0009a69b72033b2d0ec8c69fc70ef768,1,173.6,1.0
000bf8121c3412d3057d32371c5d3395,1,45.56,1.0
000e943451fc2788ca6ac98a682f2f49,1,106.23,1.0
000f17e290c26b28549908a04cfe36c1,1,139.52,1.0
000fd45d6fedae68fc6676036610f879,1,66.81,1.0
0010068a73b7c56da5758c3f9e5c7375,1,54.83,1.0
001028b78fd413e19704b3867c369d3a,1,37.61,1.0
00104a47c29da701ce41ee52077587d9,1,100.34,1.0
001051abfcfdbed9f87b4266213a5df1,1,65.2,1.0
00114026c1b7b52ab1773f317ef4880b,1,66.01,1.0
001226b2341ef620415ce7bbafcfac28,1,47.53,1.0
0012a5c13793cf51e253f096a7e740dd,1,369.92,1.0
0013280441d86a4f7a8006efdaf1b0fe,1,162.15,1.0
0013cd8e350a7cc76873441e431dd5ee,1,92.6,1.0
001450ebb4a77efb3d68be5f7887cb1e,1,61.33,1.0
00146ad30454993879adaa91c518f68c,1,221.79,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1,40.75,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1,184.94,1.0
0015bc9fd2d5395446143e8b215d7c75,1,132.19,1.0
0015f7887e2fde13ddaa7b8e385af919,1,186.74,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1,50.01,1.0
0018c09f333634ca9c80d9ff46e43e9c,1,56.87,1.0
0018f7fde63ca77254dbc47f4ea358b2,1,51.27,1.0
0019c9aaad15b043c48f0a1180f22ce8,1,112.83,1.0
001a57041f56400917a187dd74e6cbc1,1,53.72,1.0
001b4e9b73aa98a6276b241bfd496822,1,82.87,1.0
001c7f05398c45b42eee0d5a77783bca,1,21.94,1.0
001df1ee5c36767aa607001ab1a13a06,1,42.86,1.0
001f150aebb5d897f2059b0460c38449,1,125.97,1.0
001f35d9f262c558fd065346fbf5801d,1,46.53,1.0
001f6f1a5e902ad14e1f709a7215de11,1,34.86,1.0
00205ad9ba1ef4340cef86583294cf82,1,928.7,1.0
002236c4f333bc8df6a5939749eb7869,1,69.84,1.0
002348c1099e3229276c8ad7d4ddc702,1,249.56,1.0
002408f390f729598bbac1ef9421c6ae,1,258.01,1.0
002450e9ea44cb90b8a07ba0b197e149,1,40.0,1.0
002554bdf9eb99618d8189c3a89fdd52,1,244.08,1.0
0026955706fd4e2fa997f3f4c18d485a,1,121.9,1.0
0026d252429f669d454d726e5e956aa1,1,139.15,1.0
002834b4d901534f48d9e9a72047b288,1,214.14,1.0
0028ff36263a86bf679df7c863a0a0ba,1,74.94,1.0
002905287304e28c0218389269b4759b,1,31.7,1.0
002937abdae13680e17dccd3868b4825,1,43.55,1.0
0029cdf064769cabdf3186b54d068c99,1,483.7,1.0
002a10e899b62a460b0116e0b68697ad,1,92.81,1.0
002b24cb2cd0c3e575040dbd278885e3,1,40.22,1.0
002b5342c72978cf0aba6aae1f5d5293,1,51.17,1.0
002c625393dfa194828b462a6ef8cb0b,1,371.87,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1,185.6,1.0
002d358e2462f87678443706cbf2eb21,1,45.61,1.0
002d597546b2cf44428232c9f237f873,1,117.74,1.0
002ebb669a34b9e79c88efc755e95322,1,133.57,1.0
002ef7e55600d44ead53f7c1644e5222,1,199.02,1.0
002f067b028a3643ad3a0969c7a0f3dc,1,107.84,1.0
002f90a6eb386bc43bc9ba200db31a89,1,153.51,1.0
002fb8fc5ce64f8422fa2fe79986c783,1,67.68,1.0
002ff70a5285669011090c077ef929af,1,81.14,1.0
00302a0b99783c3d1d1e81c616e321e8,1,159.48,1.0
0030aded3a67b29946a128ee8468388e,1,58.59,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1,26.85,1.0
00314f95a054231742e3c5396b333b88,1,59.34,1.0
003177b3eeca50af17750f53802c9a09,1,133.81,1.0
0031abfb953b66e998f67b09e7b11375,1,671.85,1.0
0031c1062edf836ef7a7a7ea758b137b,1,81.0,1.0
00330644cccc5db0276fa836976306fe,1,55.1,1.0
00331de1659c7f4fb660c8810e6de3f5,1,243.69,1.0
0033823ee55671ac5317d423291333c2,1,79.48,1.0
0034f7933de3ead6bd9ba49afe95f119,1,84.24,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1,53.33,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1,78.2,1.0
0036875772a8eeb391b8cd7226283fdd,1,61.85,1.0
0037d14e53af1d555a582504a4058f4c,1,603.4,1.0
00380c010de38d578d02117f6d0b88e7,1,64.1,1.0
0039b3e41ac6615814a0b44a8992bff5,1,34.59,1.0
003a75d228dc67cb2918e40c2aacc4bf,1,79.28,1.0
003b595c764773e20e0949b6fba7b1dc,1,25.46,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1,600.04,1.0
003bdf7fd8312f9d14a4b979f3747334,1,43.68,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1,128.25,1.0
003cb2c7ce25d8af8556fb456f903546,1,420.94,1.0
003cbe6a43560a8b6fd2c07531257c2d,1,27.75,1.0
003e45472805afa1ee701d83284fa22b,1,30.6,1.0
003eab528664e1bd677218ef4be086ac,1,77.1,1.0
003ec17a1389fa302f3a0423dddd8650,1,17.77,1.0
003f7d92ac63c512bb6584219806f8df,1,84.91,1.0
0040a8417928d0d5abd5169cd7877181,1,219.49,1.0

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT customer_stats."customer_id", customer_stats.num_orders, customer_stats.avg_payment_per_order, customer_stats.lifespan_weeks
FROM (
  SELECT o."customer_id",
         COUNT(DISTINCT o."order_id") AS num_orders,
         AVG(op_total.order_total_payment) AS avg_payment_per_order,
         CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
         END AS lifespan_weeks
  FROM "orders" AS o
  JOIN (
      SELECT "order_id", SUM("payment_value") AS order_total_payment
      FROM "order_payments"
      GROUP BY "order_id"
  ) AS op_total ON o."order_id" = op_total."order_id"
  GROUP BY o."customer_id"
  ORDER BY avg_payment_per_order DESC
  LIMIT 3
) AS customer_stats
LIMIT 100
Results:
customer_id,num_orders,avg_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT o."customer_id",
       SUM(op_total.order_total_payment) AS total_payment,
       COUNT(DISTINCT o."order_id") AS num_orders,
       CASE
         WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
         THEN 1.0
         ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
       END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
LIMIT 100
Results:
customer_id,total_payment,num_orders,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,114.74,1,1.0
000161a058600d5901f007fab4c27140,67.41,1,1.0
0001fd6190edaaf884bcaf3d49edf079,195.42,1,1.0
0002414f95344307404f0ace7a26f1d5,179.35,1,1.0
000379cdec625522490c315e70c7a9fb,107.01,1,1.0
0004164d20a9e969af783496f3408652,71.8,1,1.0
000419c5494106c306a97b5635748086,49.4,1,1.0
00046a560d407e99b969756e0b10f282,166.59,1,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,85.23,1,1.0
000598caf2ef4117407665ac33275130,1255.71,1,1.0
0005aefbb696d34b3424dccd0a0e9fd0,147.33,1,1.0
00062b33cb9f6fe976afdcff967ea74d,58.95,1,1.0
00066ccbe787a588c52bd5ff404590e3,270.0,1,1.0
00072d033fe2e59061ae5c3aff1a2be5,106.97,1,1.0
0009a69b72033b2d0ec8c69fc70ef768,173.6,1,1.0
000bf8121c3412d3057d32371c5d3395,45.56,1,1.0
000e943451fc2788ca6ac98a682f2f49,106.23,1,1.0
000f17e290c26b28549908a04cfe36c1,139.52,1,1.0
000fd45d6fedae68fc6676036610f879,66.81,1,1.0
0010068a73b7c56da5758c3f9e5c7375,54.83,1,1.0
001028b78fd413e19704b3867c369d3a,37.61,1,1.0
00104a47c29da701ce41ee52077587d9,100.34,1,1.0
001051abfcfdbed9f87b4266213a5df1,65.2,1,1.0
00114026c1b7b52ab1773f317ef4880b,66.01,1,1.0
001226b2341ef620415ce7bbafcfac28,47.53,1,1.0
0012a5c13793cf51e253f096a7e740dd,369.92,1,1.0
0013280441d86a4f7a8006efdaf1b0fe,162.15,1,1.0
0013cd8e350a7cc76873441e431dd5ee,92.6,1,1.0
001450ebb4a77efb3d68be5f7887cb1e,61.33,1,1.0
00146ad30454993879adaa91c518f68c,221.79,1,1.0
00155f0530cc7b2bf73cc3f81cb01c52,40.75,1,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94,1,1.0
0015bc9fd2d5395446143e8b215d7c75,132.19,1,1.0
0015f7887e2fde13ddaa7b8e385af919,186.74,1,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,50.01,1,1.0
0018c09f333634ca9c80d9ff46e43e9c,56.87,1,1.0
0018f7fde63ca77254dbc47f4ea358b2,51.27,1,1.0
0019c9aaad15b043c48f0a1180f22ce8,112.83,1,1.0
001a57041f56400917a187dd74e6cbc1,53.72,1,1.0
001b4e9b73aa98a6276b241bfd496822,82.87,1,1.0
001c7f05398c45b42eee0d5a77783bca,21.94,1,1.0
001df1ee5c36767aa607001ab1a13a06,42.86,1,1.0
001f150aebb5d897f2059b0460c38449,125.97,1,1.0
001f35d9f262c558fd065346fbf5801d,46.53,1,1.0
001f6f1a5e902ad14e1f709a7215de11,34.86,1,1.0
00205ad9ba1ef4340cef86583294cf82,928.7,1,1.0
002236c4f333bc8df6a5939749eb7869,69.84,1,1.0
002348c1099e3229276c8ad7d4ddc702,249.56,1,1.0
002408f390f729598bbac1ef9421c6ae,258.01,1,1.0
002450e9ea44cb90b8a07ba0b197e149,40.0,1,1.0
002554bdf9eb99618d8189c3a89fdd52,244.08,1,1.0
0026955706fd4e2fa997f3f4c18d485a,121.9,1,1.0
0026d252429f669d454d726e5e956aa1,139.15,1,1.0
002834b4d901534f48d9e9a72047b288,214.14,1,1.0
0028ff36263a86bf679df7c863a0a0ba,74.94,1,1.0
002905287304e28c0218389269b4759b,31.7,1,1.0
002937abdae13680e17dccd3868b4825,43.55,1,1.0
0029cdf064769cabdf3186b54d068c99,483.7,1,1.0
002a10e899b62a460b0116e0b68697ad,92.81,1,1.0
002b24cb2cd0c3e575040dbd278885e3,40.22,1,1.0
002b5342c72978cf0aba6aae1f5d5293,51.17,1,1.0
002c625393dfa194828b462a6ef8cb0b,371.87,1,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,185.6,1,1.0
002d358e2462f87678443706cbf2eb21,45.61,1,1.0
002d597546b2cf44428232c9f237f873,117.74,1,1.0
002ebb669a34b9e79c88efc755e95322,133.57,1,1.0
002ef7e55600d44ead53f7c1644e5222,199.02,1,1.0
002f067b028a3643ad3a0969c7a0f3dc,107.84,1,1.0
002f90a6eb386bc43bc9ba200db31a89,153.51,1,1.0
002fb8fc5ce64f8422fa2fe79986c783,67.68,1,1.0
002ff70a5285669011090c077ef929af,81.14,1,1.0
00302a0b99783c3d1d1e81c616e321e8,159.48,1,1.0
0030aded3a67b29946a128ee8468388e,58.59,1,1.0
0030fbb95fbe7e61f798a80edb01a8e9,26.85,1,1.0
00314f95a054231742e3c5396b333b88,59.34,1,1.0
003177b3eeca50af17750f53802c9a09,133.81,1,1.0
0031abfb953b66e998f67b09e7b11375,671.85,1,1.0
0031c1062edf836ef7a7a7ea758b137b,81.0,1,1.0
00330644cccc5db0276fa836976306fe,55.1,1,1.0
00331de1659c7f4fb660c8810e6de3f5,243.69,1,1.0
0033823ee55671ac5317d423291333c2,79.48,1,1.0
0034f7933de3ead6bd9ba49afe95f119,84.24,1,1.0
003536ce5e18f1d12b9bf76932f8a6b1,53.33,1,1.0
0035b30e58c620fa2bd30275ddd4f7ef,78.2,1,1.0
0036875772a8eeb391b8cd7226283fdd,61.85,1,1.0
0037d14e53af1d555a582504a4058f4c,603.4,1,1.0
00380c010de38d578d02117f6d0b88e7,64.1,1,1.0
0039b3e41ac6615814a0b44a8992bff5,34.59,1,1.0
003a75d228dc67cb2918e40c2aacc4bf,79.28,1,1.0
003b595c764773e20e0949b6fba7b1dc,25.46,1,1.0
003bc8d06ebed9d146eb9f100d0a89ae,600.04,1,1.0
003bdf7fd8312f9d14a4b979f3747334,43.68,1,1.0
003c7cadba4f182b9f22d7d5ea7a5003,128.25,1,1.0
003cb2c7ce25d8af8556fb456f903546,420.94,1,1.0
003cbe6a43560a8b6fd2c07531257c2d,27.75,1,1.0
003e45472805afa1ee701d83284fa22b,30.6,1,1.0
003eab528664e1bd677218ef4be086ac,77.1,1,1.0
003ec17a1389fa302f3a0423dddd8650,17.77,1,1.0
003f7d92ac63c512bb6584219806f8df,84.91,1,1.0
0040a8417928d0d5abd5169cd7877181,219.49,1,1.0

2025-02-10 13:48:42 - root - INFO - itercount: 0
2025-02-10 13:48:42 - root - INFO - Table: product_category_name_translationDDL:
CREATE TABLE "product_category_name_translation" (
"product_category_name" TEXT,
  "product_category_name_english" TEXT
)
Table: sellersDDL:
CREATE TABLE "sellers" (
"seller_id" TEXT,
  "seller_zip_code_prefix" INTEGER,
  "seller_city" TEXT,
  "seller_state" TEXT
)
Table: customersDDL:
CREATE TABLE "customers" (
"customer_id" TEXT,
  "customer_unique_id" TEXT,
  "customer_zip_code_prefix" INTEGER,
  "customer_city" TEXT,
  "customer_state" TEXT
)
Table: geolocationDDL:
CREATE TABLE "geolocation" (
"geolocation_zip_code_prefix" INTEGER,
  "geolocation_lat" REAL,
  "geolocation_lng" REAL,
  "geolocation_city" TEXT,
  "geolocation_state" TEXT
)
Table: order_itemsDDL:
CREATE TABLE "order_items" (
"order_id" TEXT,
  "order_item_id" INTEGER,
  "product_id" TEXT,
  "seller_id" TEXT,
  "shipping_limit_date" TEXT,
  "price" REAL,
  "freight_value" REAL
)
Table: order_paymentsDDL:
CREATE TABLE "order_payments" (
"order_id" TEXT,
  "payment_sequential" INTEGER,
  "payment_type" TEXT,
  "payment_installments" INTEGER,
  "payment_value" REAL
)
Table: order_reviewsDDL:
CREATE TABLE "order_reviews" (
"review_id" TEXT,
  "order_id" TEXT,
  "review_score" INTEGER,
  "review_comment_title" TEXT,
  "review_comment_message" TEXT,
  "review_creation_date" TEXT,
  "review_answer_timestamp" TEXT
)
Table: ordersDDL:
CREATE TABLE "orders" (
"order_id" TEXT,
  "customer_id" TEXT,
  "order_status" TEXT,
  "order_purchase_timestamp" TEXT,
  "order_approved_at" TEXT,
  "order_delivered_carrier_date" TEXT,
  "order_delivered_customer_date" TEXT,
  "order_estimated_delivery_date" TEXT
)
Table: productsDDL:
CREATE TABLE "products" (
"product_id" TEXT,
  "product_category_name" TEXT,
  "product_name_lenght" REAL,
  "product_description_lenght" REAL,
  "product_photos_qty" REAL,
  "product_weight_g" REAL,
  "product_length_cm" REAL,
  "product_height_cm" REAL,
  "product_width_cm" REAL
)
Table: leads_qualifiedDDL:
CREATE TABLE "leads_qualified" (
"mql_id" TEXT,
  "first_contact_date" TEXT,
  "landing_page_id" TEXT,
  "origin" TEXT
)
Table: leads_closedDDL:
CREATE TABLE "leads_closed" (
"mql_id" TEXT,
  "seller_id" TEXT,
  "sdr_id" TEXT,
  "sr_id" TEXT,
  "won_date" TEXT,
  "business_segment" TEXT,
  "lead_type" TEXT,
  "lead_behaviour_profile" TEXT,
  "has_company" INTEGER,
  "has_gtin" INTEGER,
  "average_stock" TEXT,
  "business_type" TEXT,
  "declared_product_catalog_size" REAL,
  "declared_monthly_revenue" REAL
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['product_category_name_translation', 'sellers', 'customers', 'geolocation', 'order_items', 'order_payments', 'order_reviews', 'orders', 'products', 'leads_qualified', 'leads_closed']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **customers**
  - `"customer_id"`: Used to uniquely identify each customer and link to orders.

- **orders**
  - `"order_id"`: Used to link to order payments.
  - `"customer_id"`: Used to associate orders with customers.
  - `"order_purchase_timestamp"`: Used to determine purchase dates for calculating customer lifespan.

- **order_payments**
  - `"order_id"`: Used to link payments to orders.
  - `"payment_value"`: Used to calculate the total and average payment per order.

**Potential Conditions:**

- Join `orders` and `order_payments` on `"order_id"` to associate payments with orders.
- Join `orders` and `customers` on `"customer_id"` to associate orders with customers.
- Use `GROUP BY "customer_id"` to calculate metrics per customer.
- Use aggregate functions like `COUNT`, `SUM`, `AVG`, `MIN`, and `MAX` to compute required statistics.
- Order results by average payment per order in descending order to find the top 3 customers.
- Calculate lifespan in weeks using purchase timestamps.

**SQL Queries:**

1. **Select distinct customer IDs from the customers table.**

   ```sql
   SELECT DISTINCT "customer_id"
   FROM "customers"
   LIMIT 100;
   ```

2. **Retrieve customer IDs and their associated order IDs from the orders table.**

   ```sql
   SELECT "customer_id", "order_id"
   FROM "orders"
   LIMIT 100;
   ```

3. **List order IDs with their purchase timestamps from the orders table.**

   ```sql
   SELECT "order_id", "order_purchase_timestamp"
   FROM "orders"
   LIMIT 100;
   ```

4. **Get order IDs and their payment values from the order_payments table.**

   ```sql
   SELECT "order_id", "payment_value"
   FROM "order_payments"
   LIMIT 100;
   ```

5. **Join orders and payments to get payment values per customer.**

   ```sql
   SELECT o."customer_id", op."payment_value"
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   LIMIT 100;
   ```

6. **Calculate total payment per customer.**

   ```sql
   SELECT o."customer_id", SUM(op."payment_value") AS total_payment
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

7. **Count the number of orders per customer.**

   ```sql
   SELECT "customer_id", COUNT("order_id") AS num_orders
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
   ```

8. **Find the earliest and latest purchase dates for each customer.**

   ```sql
   SELECT "customer_id", MIN("order_purchase_timestamp") AS first_purchase, MAX("order_purchase_timestamp") AS last_purchase
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
   ```

9. **Compute the average payment per order for each customer.**

   ```sql
   SELECT o."customer_id", AVG(op."payment_value") AS avg_payment_per_order
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

10. **Identify customers and calculate their lifespan in days.**

    ```sql
    SELECT "customer_id", 
           JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp")) AS lifespan_days
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
    ```

11. **Calculate lifespan in weeks for each customer, applying the minimum of 1.0 week if less than 7 days.**

    ```sql
    SELECT "customer_id", 
           CASE 
             WHEN (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0 < 1.0
             THEN 1.0
             ELSE (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0
           END AS lifespan_weeks
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
    ```

12. **Combine number of orders and average payment per order for each customer.**

    ```sql
    SELECT o."customer_id", COUNT(DISTINCT o."order_id") AS num_orders, AVG(op."payment_value") AS avg_payment_per_order
    FROM "orders" AS o
    JOIN "order_payments" AS op ON o."order_id" = op."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

13. **Retrieve the number of orders, average payment per order, and lifespan in weeks for each customer.**

    ```sql
    SELECT o."customer_id",
           COUNT(DISTINCT o."order_id") AS num_orders,
           AVG(op."payment_value") AS avg_payment_per_order,
           CASE 
             WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0 < 1.0
             THEN 1.0
             ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
           END AS lifespan_weeks
    FROM "orders" AS o
    JOIN "order_payments" AS op ON o."order_id" = op."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

14. **Identify the top 3 customers with the highest average payment per order, including their number of orders and lifespan in weeks.**

    ```sql
    SELECT customer_stats."customer_id", customer_stats.num_orders, customer_stats.avg_payment_per_order, customer_stats.lifespan_weeks
    FROM (
      SELECT o."customer_id",
             COUNT(DISTINCT o."order_id") AS num_orders,
             AVG(op."payment_value") AS avg_payment_per_order,
             CASE 
               WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0 < 1.0
               THEN 1.0
               ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
             END AS lifespan_weeks
      FROM "orders" AS o
      JOIN "order_payments" AS op ON o."order_id" = op."order_id"
      GROUP BY o."customer_id"
      ORDER BY avg_payment_per_order DESC
      LIMIT 3
    ) AS customer_stats
    LIMIT 100;
    ```

15. **List all customers with their total payment, number of orders, and lifespan in weeks for further analysis.**

    ```sql
    SELECT o."customer_id",
           SUM(op."payment_value") AS total_payment,
           COUNT(DISTINCT o."order_id") AS num_orders,
           CASE 
             WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0 < 1.0
             THEN 1.0
             ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
           END AS lifespan_weeks
    FROM "orders" AS o
    JOIN "order_payments" AS op ON o."order_id" = op."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

These queries progressively build upon each other to help understand the data relevant to the task. By executing these queries, you can explore the relationships between customers, their orders, payments, and calculate the required metrics to identify the top 3 customers based on the highest average payment per order.Query:
SELECT DISTINCT "customer_id"
   FROM "customers"
   LIMIT 100;
Answer:
customer_id
06b8999e2fba1a1fbc88172c00ba8bc7
18955e83d337fd6b2def6b18a428ac77
4e7b3e00288586ebd08712fdd0374a03
b2b6027bc5c5109e529d4dc6358b12c3
4f2d8ab171c80ec8364f7c12e35b23ad
879864dab9bc3047522c92c82e1212b8
fd826e7cf63160e536e0908c76c3f441
5e274e7a0c3809e14aba7ad5aae0d407
5adf08e34b2e993982a47070956c5c65
4b7139f34592b3a31687243a302fa75b
9fb35e4ed6f0a14a4977cd9aea4042bb
5aa9e4fdd4dfd20959cad2d772509598
b2d1536598b73a9abd18e0d75d92f0a3
eabebad39a88bb6f5b52376faec28612
1f1c7bf1c9b041b292af6c1c4470b753
206f3129c0e4d7d0b9550426023f0a08
a7c125a0a07b75146167b7f04a7f8e98
c5c61596a3b6bd0cee5766992c48a9a1
9b8ce803689b3562defaad4613ef426f
49d0ea0986edde72da777f15456a0ee0
154c4ded6991bdfa3cd249d11abf4130
690172ab319622688d3b4df42f676898
2938121a40a20953c43caa8c98787fcb
237098a64674ae89babdc426746260fc
cb721d7b4f271fd87011c4c83462c076
f681356046d9fde60e70c73a18d65ea2
167bd30a409e3e4127df5a9408ebd394
6e359a57a91f84095cc64e1b351aef8c
e0eea8f69a457b3f1fa246e44c9ebefd
e3109970a3fe8021d5ff82c577ce5606
261cb4f92498ca05d5bd1a327a261d9c
6f92779347724b67e44e3224f3b4cffd
2d5831cb2dff7cdefba62e950ae3dc7b
b2bed119388167a954382cca36c4777f
469634941c27cd844170935a3cf60b95
df0aa5b8586495e0ddf6b601122e43a1
41c8f4b570869791379a925899a6af8a
54f755c3fd2709231f9964a1430c5218
4c06b42fbf7b97ab10779cda5549cd1c
b6368ca0f56d4632f44d58ca431487b2
4a0e66fd30684aa1409cd1b66fec77cc
c168abb9077b7821adae01dc1f0886c5
a3b0fda37bae14cf754877bed475e80c
0ccd415657ae8a6cd1c71b00155a019e
c532a74a3ebf1bacce2e2bcce3783317
19cecb194f54e614b70d971306a9931b
f34a6e874087ec1f0e3dab9fdf659c5d
c132855c926907970dcf6f2bf0b33a24
df85b96ba2ce3e49bde101b1614f52ac
4d27341acd30a36bca39008ee9bb9050
d3b6830d18c7de943d1e707d1f061d40
79de53946db384e2d7a9bd131792ad17
a562ab1e728449e3461829dfe2e36f73
b64ed91eab98972150bdaf77ca921934
8247b5583327ab8be19f96e1fb82f77b
8fcaa9368903f3a9a28aeaff28c14638
a9b0d1c26105279e1b8edc63d06bd668
aa9f03ecd3728c9bd12e6d962c66c7cb
230c0d740401730c7197d16376893525
a905baa530258422594f1b05615bd225
4fa19f7da692e6bf9602aaad3c372eda
03f846ad03437d864a8d2a22976dcafe
de4e13fd7d6469c5ada77d0843c55e42
8276de07ef25225d412b8462d73f8664
cc32707d2e2f7c92ab449f9b28154809
a02f66c3af7b16eec19ddcd98b645fe3
26acee41e2f75689a5615892f06ea0bd
f64cdee66599119324ce57a97e43700d
7ab7a537b678b6dd73d825ff6ee7be9d
7300450cedf7e4c35c243c4a03c1e8a6
4c7241af24b5344cb01fe687643de4fe
97e126f19a6f04b3462619f36862bcd2
6d27a9361e591da38c87a5e70253f3f2
6810c3dc47f641181fcc7f73275c3d19
b514422efcf14bef34858a0829bef189
0aae2862f8eac77f10a34f44860720ac
6c9a5923526346cbc0bd7bbd92269c01
1b2cb35b19b40b61f953d32ea157b337
12d1b4294fef21016c9614eb31e55e15
f6529ffebe6b3440d45d89604a4239ac
8264e3518163dd09211870b24a5d741d
8392e3d4cfeec63f2a8bfea68bf1f91f
38d1cd89306128348ffdf4cc23f3a50a
91ec76836092bba85d11761078ed7bb5
f9dfa0a2934ffbb22e66924952548be8
5a3260cfde2a918b597dada7ddd247bb
ee3a81b2771fec5f9e982cdb1b3a4804
784c407781aa34749a388c9283782b56
3f6ede29d4c69cd3316d2035b6cec1fb
6bed27564bd99d78d09c1fac13da56fd
670254dd2e886ffe621b3831afb47d7d
f7cb015ff73be957ee6a30e2577742c5
ea2196dc456ba36fe4f6b81dca4867d4
09241c552e9fe2420997a6c535e9d408
e50a30de3c32f9406a7185f40ce6874d
f89c1a6b9c966869e441e55bc14acddc
23e96758fd640560e9b1fbcda90abfc4
369708cabd9831ea6fde670a3b602a92
5f8b4882b5a4ec7bf6d2107e6cd0cf29
ad6891a1937cb8723a2c08ba1ae59873
Query:
SELECT "customer_id", "order_id"
   FROM "orders"
   LIMIT 100;
Answer:
Too long, hard cut:
customer_id,order_id
9ef432eb6251297304e76186b10a928d,e481f51cbdc54678b7cc49136f2d6af7
b0830fb4747a6c6d20dea0b8c802d7ef,53cdb2fc8bc7dce0b6741e2150273451
41ce2a54c0b03bf3443c3d931a367089,47770eb9100c2d0c44946d9cf07ec65d
f88197465ea7920adcdbec7375364d82,949d5b44dbf5de918fe9c16f97b45f8a
8ab97904e6daea8866dbdbc4fb7aad2c,ad21c59c0840e6cb83a9ceb5573f8159
503740e9ca751ccdda7ba28e9ab8f608,a4591c265e18cb1dcee52889e2d8acc3
ed0271e0b7da060a393796590e7b737a,136cce7faa42fdb2cefd53fdc79a6098
9bdf08b4b3b52b5526ff42d37d47f222,6514b8ad8028c9f2cc2374ded245783f
f54a9f0e6b351c431402b8461ea51999,76c6e866289321a7c93b82b54852dc33
31ad1d1b63eb9962463f764d4e6e0c9d,e69bfb5eb88e0ed6a785585b27e16dbf
494dded5b201313c64ed7f100595b95c,e6ce16cb79ec1d90b1da9085a6118aeb
7711cf624183d843aafe81855097bc37,34513ce0c4fab462a55830c0989c7edb
d3e3b74c766bc6214e0c830b17ee2341,82566a660a982b15fb86e904c8d32918
19402a48fe860416adf93348aba37740,5ff96c15d0b717ac6ad1f3d77225a350
3df704f53d3f1d4818840b34ec672a9f,432aaf21d85167c2c86ec9448c4e42cc
3b6828a50ffe546942b7a473d70ac0fc,dcb36b511fcac050b97cd5c05de84dc3
738b086814c6fcc74b8cc583f8516ee3,403b97836b0c04a622354cf531062e5f
3187789bec990987628d7a9beb4dd6ac,116f0b09343b49556bbad5f35bee0cdf
059f7fc5719c7da6cbafe370971a8d70,85ce859fd6dc634de8d2f1e290444043
7f8c8b9c2ae27bf3300f670c3d478be8,83018ec114eee8641c97e08f7b4e926f
d2b091571da224a1b36412c18bc3bbfe,203096f03d82e0dffbc41ebc2e2bcfb7
4fa1cd166fa598be6de80fa84eaade43,f848643eec1d69395095eb3840d2051e
72ae281627a6102d9b3718528b420f8a,2807d0e504d6d4894d41672727bc139f
a166da34890074091a942054b36e4265,95266dbfb7e20354baba07964dac78d5
62b423aab58096ca514ba6aa06be2f98,f3e7c359154d965827355f39d6b1fdac
3a874b4d4c4b6543206ff5d89287f0c3,fbf9ac61453ac646ce8ad9783d7d0af6
7e20bf5ca92da68200643bda76c504c6,acce194856392f074dbf9dada14d8d82
8b212b9525f9e74e85e37ed6df37693e,dd78f560c270f1909639c11b925620ea
cce89a605105b148387c52e286ac8335,91b2a010e1e45e6ba3d133fa997597be
761df82feda9778854c6dafdaeb567e4,ecab90c9933c58908d3d6add7c6f5ae3
456dc10730fbdba34615447ea195d643,f70a0aff17df5a6cdd9a7196128bd354
52142aa69d8d0e1247ab0cada0f76023,1790eea0b567cf50911c057cf20f90f9
816f8653d5361cbf94e58c33f2502a5c,989225ba6d0ebd5873335f7e01de2ae7
d9ef95f98d8da3b492bb8c0447910498,d887b52c6516beb39e8cd44a5f8b60f7
cf8ffeddf027932e51e4eae73b384059,b276e4f8c0fb86bd82fce576f21713e0
5f16605299d698660e0606f7eae2d2f9,8563039e855156e48fccee4d611a3196
f5458ddc3545711efa883dd7ae7c4497,60550084e6b4c0cb89a87df1f3e5ebd9
295ae9b35379e077273387ff64354b6f,5acce57f8d9dfd55fa48e212a641a69d
2a1dfb647f32f4390e7b857c67458536,434d158e96bdd6972ad6e6d73ddcfd22
3391c4bc11a817e7973e498b0b023158,7206b86ea789983f7a273ea7fa0bc2a8
ddaff536587109b89777e0353215e150,1e7aff52cdbb2451ace09d0f848c3699
c7340080e394356141681bd4c9b8fe31,6ea2f835b4556291ffdc53fa0b3b95e8
8644be24d48806bc3a88fd59fb47ceb1,948097deef559c742e7ce321e5e58919
756fb9391752dad934e0fe3733378e57,d22e9fa5731b9e30e8b27afcdc2f8563
caded193e8e47b8362864762a83db3c5,ee64d42b8cf066f35eac1cf57de1aa85
4f28355e5c17a4a42d3ce2439a1d4501,6ebaec694d7025e2ad4a05dba887c032
569cf68214806a39acc0f39344aea67f,d17dc4a904426827ca80f2ccb3a6be56
12fd2740039676063a874b9567dfa651,25f4376934e13d3508486352e11a5db0
2b56e94c2f66f2d97cfa63356f69cee8,5820a1100976432c7968a52da59e9364
7f2178c5d771e17f507d3c1637339298,2ce1ad82022c1ba30c2079502ac725aa
9b18f3fc296990b97854e351334a32f6,138849fd84dff2fb4ca70a0a34c4aa1c
148348ff65384b4249b762579532e248,47aa4816b27ba60ec948cd019cc1afc1
79183cd650e2bb0d475b0067d45946ac,9faeb9b2746b9d7526aef5acb08e2aa0
f5afca14dfa9dc64251cf2b45c54c363,641fb0752bf5b5940c376b3a8bb9dc52
f178c1827f67a8467b0385b7378d951a,e425680f760cbc130be3e53a9773c584
67407057a7d5ee17d1cd09523f484d13,40c5e18f7d112b59b3e5113a59a905b3
2932d241d1f31e6df6c701d52370ae02,734e7d1bbaeb2ff82521ca0fe6fb6f79
684fa6da5134b9e4dab731e00011712d,66e4624ae69e7dc89bd50222b59f581f
911e4c37f5cafe1604fe6767034bf1ae,a685d016c8a26f71a0bb67821070e398
241e78de29b3090cfa1b5d73a8130c72,2edfd6d1f0b4cd0db4bf37b1b224d855
4632eb5a8f175f6fe020520ae0c678f3,68873cf91053cd11e6b49a766db5af1a
dd5095632e3953fc0947b8ab5176b0be,f346ad4ee8f630e5e4ddaf862a34e6dd
9916715c2ab6ee1710c9c32f0a534ad2,8f06cc6465925031568537b815f1198d
c77ee2d8ba1614a4d489a44166894938,ccbabeb0b02433bd0fcbac46e70339f2
81e08b08e5ed4472008030d70327c71f,688052146432ef8253587b930b01a06d
5dda11942d4f77bee3a46d71e442aec4,f271576bed568e896f99eb710cd3a6f8
74805bc388861fa350ed2fade8444e0b,686541986ecfb7d9296eb67719973bf0
4afc1dcca5fe8926fc97d60a4497f8ab,68e48e68da1f50f7c5838ea75e3a20dd
be8c14c16a4d47194ccdfe10f1fc5b1a,b52cc4919de82b4d696a4380d10804a3
a9d37ddc8ba4d9f6dbac7d8ec378cc95,fdf128b3630c21adc9ca4fb8a51b68ec
bb2f5e670f7155dc622c57e4b31d0a69,a6aeb116d2cb5013eb8a94585b71ffef
55e6b290205c84ddd23ddf5eb134efd4,fa516182d28f96f5f5c651026b0749ee
f5618502bee8eafdee72fb6955e2ebdf,6abaad69b8b349c3a529b4b91ce18e46
a90391a47de936d56c66a5366cba1462,974c1993ab8024d3ed16229183c2308d
388025bec8128ff20ec1a316ed4dcf02,82bce245b1c9148f8d19a55b9ff70644
afb19a4b667cb708caab312757ec3
Query:
SELECT "order_id", "order_purchase_timestamp"
   FROM "orders"
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,2018-03-09 14:50:15
a685d016c8a26f71a0bb67821070e398,2017-03-13 18:14:36
2edfd6d1f0b4cd0db4bf37b1b224d855,2017-06-13 21:11:26
68873cf91053cd11e6b49a766db5af1a,2017-11-30 22:02:15
f346ad4ee8f630e5e4ddaf862a34e6dd,2018-08-05 13:09:48
8f06cc6465925031568537b815f1198d,2017-11-15 11:31:41
ccbabeb0b02433bd0fcbac46e70339f2,2018-02-19 20:31:09
688052146432ef8253587b930b01a06d,2018-04-22 08:48:13
f271576bed568e896f99eb710cd3a6f8,2018-01-07 21:44:54
686541986ecfb7d9296eb67719973bf0,2018-02-10 13:26:59
68e48e68da1f50f7c5838ea75e3a20dd,2018-06-18 16:02:23
b52cc4919de82b4d696a4380d10804a3,2018-06-13 13:47:39
fdf128b3630c21adc9ca4fb8a51b68ec,2018-07-15 08:33:19
a6aeb116d2cb5013eb8a94585b71ffef,2017-09-13 14:27:11
fa516182d28f96f5f5c651026b0749ee,2018-04-13 08:44:17
6abaad69b8b349c3a529b4b91ce18e46,2018-02-15 10:33:30
974c1993ab8024d3ed16229183c2308d,2017-02-20 11:45:39
82bce245b1c9148f8d19a55b9ff70644,2017-04-20 17:15:46
a910f58086d58b3ae6f37aa712d377b9,2017-09-15 09:19:48
bd4bd0194d6d29f83b8557d4b89b572a,2018-07-28 16:52:55
634e8f4c0f6744a626f77f39770ac6aa,2017-08-09 18:32:47
6d25592267349b322799e2beb687871e,2018-08-26 22:04:34
b8801cccd8068de30112e4f49903d74a,2017-07-30 03:06:35
2711a938db643b3f0b62ee2c8a2784aa,2017-12-22 00:17:37
3bc77ce8be27211bac313c2daa402d1a,2017-04-06 22:39:29
10c320f977c6a18f91b2d14be13128c6,2017-05-09 20:48:59
0a4a2fccb27bd83a892fa503987a595b,2017-04-20 20:42:44
e4de6d53ecff736bc68804b0b6e9f635,2017-10-16 14:56:50
6b860b35691d486e45dc98e3514ec5f6,2017-12-08 09:42:43
ec341c54a5ebf8ee0a67a8632aa7579b,2017-08-26 16:53:30
cadbb3657dac2dbbd5b84b12e7b78aad,2018-02-27 12:55:42
9defaf92cff22420e4e8ef7784815a55,2018-05-11 13:10:51
20e0101b20700188cadb288126949685,2018-01-22 19:22:22
0e782c3705510e717d28907746cbda82,2018-05-01 08:12:37
d3d6788577c9592da441752e8a1dd5e3,2017-09-19 22:17:15
86f21bf63784876b9fd6d35f46581d72,2018-04-11 22:32:31
8447ff843b2616c50c0ced28ab1dae03,2017
Query:
SELECT "order_id", "payment_value"
   FROM "order_payments"
   LIMIT 100;
Answer:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27
Query:
SELECT o."customer_id", op."payment_value"
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   LIMIT 100;
Answer:
customer_id,payment_value
9ef432eb6251297304e76186b10a928d,2.0
9ef432eb6251297304e76186b10a928d,18.12
9ef432eb6251297304e76186b10a928d,18.59
b0830fb4747a6c6d20dea0b8c802d7ef,141.46
41ce2a54c0b03bf3443c3d931a367089,179.12
f88197465ea7920adcdbec7375364d82,72.2
8ab97904e6daea8866dbdbc4fb7aad2c,28.62
503740e9ca751ccdda7ba28e9ab8f608,175.26
ed0271e0b7da060a393796590e7b737a,65.95
9bdf08b4b3b52b5526ff42d37d47f222,75.16
f54a9f0e6b351c431402b8461ea51999,35.95
31ad1d1b63eb9962463f764d4e6e0c9d,8.34
31ad1d1b63eb9962463f764d4e6e0c9d,161.42
494dded5b201313c64ed7f100595b95c,259.06
7711cf624183d843aafe81855097bc37,114.13
d3e3b74c766bc6214e0c830b17ee2341,50.13
19402a48fe860416adf93348aba37740,32.7
3df704f53d3f1d4818840b34ec672a9f,54.36
3b6828a50ffe546942b7a473d70ac0fc,146.45
738b086814c6fcc74b8cc583f8516ee3,1376.45
3187789bec990987628d7a9beb4dd6ac,43.09
059f7fc5719c7da6cbafe370971a8d70,29.75
7f8c8b9c2ae27bf3300f670c3d478be8,5.96
7f8c8b9c2ae27bf3300f670c3d478be8,24.86
7f8c8b9c2ae27bf3300f670c3d478be8,62.15
d2b091571da224a1b36412c18bc3bbfe,118.86
4fa1cd166fa598be6de80fa84eaade43,88.9
72ae281627a6102d9b3718528b420f8a,17.28
a166da34890074091a942054b36e4265,187.57
62b423aab58096ca514ba6aa06be2f98,104.11
3a874b4d4c4b6543206ff5d89287f0c3,125.43
7e20bf5ca92da68200643bda76c504c6,227.68
8b212b9525f9e74e85e37ed6df37693e,60.69
cce89a605105b148387c52e286ac8335,192.68
761df82feda9778854c6dafdaeb567e4,63.34
456dc10730fbdba34615447ea195d643,313.19
52142aa69d8d0e1247ab0cada0f76023,224.9
816f8653d5361cbf94e58c33f2502a5c,63.1
d9ef95f98d8da3b492bb8c0447910498,100.25
cf8ffeddf027932e51e4eae73b384059,188.41
5f16605299d698660e0606f7eae2d2f9,106.95
f5458ddc3545711efa883dd7ae7c4497,66.79
295ae9b35379e077273387ff64354b6f,43.0
2a1dfb647f32f4390e7b857c67458536,508.17
3391c4bc11a817e7973e498b0b023158,49.69
ddaff536587109b89777e0353215e150,154.19
c7340080e394356141681bd4c9b8fe31,356.12
8644be24d48806bc3a88fd59fb47ceb1,95.67
756fb9391752dad934e0fe3733378e57,121.62
caded193e8e47b8362864762a83db3c5,22.36
4f28355e5c17a4a42d3ce2439a1d4501,153.72
569cf68214806a39acc0f39344aea67f,54.82
12fd2740039676063a874b9567dfa651,82.33
2b56e94c2f66f2d97cfa63356f69cee8,52.24
7f2178c5d771e17f507d3c1637339298,130.56
9b18f3fc296990b97854e351334a32f6,52.84
148348ff65384b4249b762579532e248,71.91
79183cd650e2bb0d475b0067d45946ac,151.04
f5afca14dfa9dc64251cf2b45c54c363,386.33
f178c1827f67a8467b0385b7378d951a,50.25
67407057a7d5ee17d1cd09523f484d13,128.68
2932d241d1f31e6df6c701d52370ae02,43.46
684fa6da5134b9e4dab731e00011712d,91.68
911e4c37f5cafe1604fe6767034bf1ae,99.26
241e78de29b3090cfa1b5d73a8130c72,141.15
4632eb5a8f175f6fe020520ae0c678f3,91.66
dd5095632e3953fc0947b8ab5176b0be,53.66
9916715c2ab6ee1710c9c32f0a534ad2,317.34
c77ee2d8ba1614a4d489a44166894938,43.0
81e08b08e5ed4472008030d70327c71f,346.09
5dda11942d4f77bee3a46d71e442aec4,824.76
74805bc388861fa350ed2fade8444e0b,39.99
4afc1dcca5fe8926fc97d60a4497f8ab,392.6
be8c14c16a4d47194ccdfe10f1fc5b1a,55.02
a9d37ddc8ba4d9f6dbac7d8ec378cc95,46.2
bb2f5e670f7155dc622c57e4b31d0a69,59.34
55e6b290205c84ddd23ddf5eb134efd4,209.41
f5618502bee8eafdee72fb6955e2ebdf,57.0
a90391a47de936d56c66a5366cba1462,84.56
388025bec8128ff20ec1a316ed4dcf02,267.8
afb19a4b667cb708caab312757ec3d3f,145.66
636e15840ab051faa13d3f781b6e4233,37.83
05e996469a2bf9559c7122b87e156724,7.08
05e996469a2bf9559c7122b87e156724,227.2
5bb39c890c91b1d26801aa19a9336eac,201.82
f26a435864aebedff7f7c84f82ee229f,27.77
29cb486c739f9774c8eb542e07b56cd2,59.1
bf141bf67fbe428d558bcf0e018eab60,66.98
b673f0597cb0c4d12778f731045f361a,132.26
6772a0a230a2667d16c3620f000e1348,63.34
9f6618c17568ac301465fe7ad056c674,231.12
fee181bf648906d1c57f84f216976286,574.36
df9b032b2ad0fd6bf37dfb48e5f83845,29.92
93ada7a24817edda9f4ab998fa823d16,409.79
64fb950e760ec8b0db79154a1fa9c1bf,62.69
48558a50a7ba1aab61891936d2ca7681,105.56
3a897024068ed42a183de61d5727d866,37.38
8628fac2267e8c8804525da99c10ed0e,76.65
332df68ccac2f2f7d9e11299188f8bce,120.84
e28dd4261bed9c7ba89ecaf411b88f7c,238.69
Query:
SELECT o."customer_id", SUM(op."payment_value") AS total_payment
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,total_payment
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,106.23
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,65.2
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49
Query:
SELECT "customer_id", COUNT("order_id") AS num_orders
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
customer_id,num_orders
00012a2ce6f8dcda20d059ce98491703,1
000161a058600d5901f007fab4c27140,1
0001fd6190edaaf884bcaf3d49edf079,1
0002414f95344307404f0ace7a26f1d5,1
000379cdec625522490c315e70c7a9fb,1
0004164d20a9e969af783496f3408652,1
000419c5494106c306a97b5635748086,1
00046a560d407e99b969756e0b10f282,1
00050bf6e01e69d5c0fd612f1bcfb69c,1
000598caf2ef4117407665ac33275130,1
0005aefbb696d34b3424dccd0a0e9fd0,1
00062b33cb9f6fe976afdcff967ea74d,1
00066ccbe787a588c52bd5ff404590e3,1
00072d033fe2e59061ae5c3aff1a2be5,1
0009a69b72033b2d0ec8c69fc70ef768,1
000bf8121c3412d3057d32371c5d3395,1
000e943451fc2788ca6ac98a682f2f49,1
000f17e290c26b28549908a04cfe36c1,1
000fd45d6fedae68fc6676036610f879,1
0010068a73b7c56da5758c3f9e5c7375,1
001028b78fd413e19704b3867c369d3a,1
00104a47c29da701ce41ee52077587d9,1
001051abfcfdbed9f87b4266213a5df1,1
00114026c1b7b52ab1773f317ef4880b,1
001226b2341ef620415ce7bbafcfac28,1
0012a5c13793cf51e253f096a7e740dd,1
0013280441d86a4f7a8006efdaf1b0fe,1
0013cd8e350a7cc76873441e431dd5ee,1
001450ebb4a77efb3d68be5f7887cb1e,1
00146ad30454993879adaa91c518f68c,1
00155f0530cc7b2bf73cc3f81cb01c52,1
001574cd5824c0b1ea90dd4f4ba6d5b8,1
0015bc9fd2d5395446143e8b215d7c75,1
0015f7887e2fde13ddaa7b8e385af919,1
0017a0b4c1f1bdb9c395fa0ac517109c,1
0018c09f333634ca9c80d9ff46e43e9c,1
0018f7fde63ca77254dbc47f4ea358b2,1
0019c9aaad15b043c48f0a1180f22ce8,1
001a57041f56400917a187dd74e6cbc1,1
001b4e9b73aa98a6276b241bfd496822,1
001c7f05398c45b42eee0d5a77783bca,1
001df1ee5c36767aa607001ab1a13a06,1
001f150aebb5d897f2059b0460c38449,1
001f35d9f262c558fd065346fbf5801d,1
001f6f1a5e902ad14e1f709a7215de11,1
00205ad9ba1ef4340cef86583294cf82,1
002236c4f333bc8df6a5939749eb7869,1
002348c1099e3229276c8ad7d4ddc702,1
002408f390f729598bbac1ef9421c6ae,1
002450e9ea44cb90b8a07ba0b197e149,1
002554bdf9eb99618d8189c3a89fdd52,1
0026955706fd4e2fa997f3f4c18d485a,1
0026d252429f669d454d726e5e956aa1,1
002834b4d901534f48d9e9a72047b288,1
0028ff36263a86bf679df7c863a0a0ba,1
002905287304e28c0218389269b4759b,1
002937abdae13680e17dccd3868b4825,1
0029cdf064769cabdf3186b54d068c99,1
002a10e899b62a460b0116e0b68697ad,1
002b24cb2cd0c3e575040dbd278885e3,1
002b5342c72978cf0aba6aae1f5d5293,1
002c625393dfa194828b462a6ef8cb0b,1
002ce108ccf0356ef5c8b1dce3c0ae29,1
002d358e2462f87678443706cbf2eb21,1
002d597546b2cf44428232c9f237f873,1
002ebb669a34b9e79c88efc755e95322,1
002ef7e55600d44ead53f7c1644e5222,1
002f067b028a3643ad3a0969c7a0f3dc,1
002f90a6eb386bc43bc9ba200db31a89,1
002fb8fc5ce64f8422fa2fe79986c783,1
002ff70a5285669011090c077ef929af,1
00302a0b99783c3d1d1e81c616e321e8,1
0030aded3a67b29946a128ee8468388e,1
0030fbb95fbe7e61f798a80edb01a8e9,1
00314f95a054231742e3c5396b333b88,1
003177b3eeca50af17750f53802c9a09,1
0031abfb953b66e998f67b09e7b11375,1
0031c1062edf836ef7a7a7ea758b137b,1
00330644cccc5db0276fa836976306fe,1
00331de1659c7f4fb660c8810e6de3f5,1
0033823ee55671ac5317d423291333c2,1
0034f7933de3ead6bd9ba49afe95f119,1
003536ce5e18f1d12b9bf76932f8a6b1,1
0035b30e58c620fa2bd30275ddd4f7ef,1
0036875772a8eeb391b8cd7226283fdd,1
0037d14e53af1d555a582504a4058f4c,1
00380c010de38d578d02117f6d0b88e7,1
0039b3e41ac6615814a0b44a8992bff5,1
003a75d228dc67cb2918e40c2aacc4bf,1
003b595c764773e20e0949b6fba7b1dc,1
003bc8d06ebed9d146eb9f100d0a89ae,1
003bdf7fd8312f9d14a4b979f3747334,1
003c7cadba4f182b9f22d7d5ea7a5003,1
003cb2c7ce25d8af8556fb456f903546,1
003cbe6a43560a8b6fd2c07531257c2d,1
003e45472805afa1ee701d83284fa22b,1
003eab528664e1bd677218ef4be086ac,1
003ec17a1389fa302f3a0423dddd8650,1
003f7d92ac63c512bb6584219806f8df,1
0040a8417928d0d5abd5169cd7877181,1
Query:
SELECT "customer_id", MIN("order_purchase_timestamp") AS first_purchase, MAX("order_purchase_timestamp") AS last_purchase
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
Too long, hard cut:
customer_id,first_purchase,last_purchase
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13,2017-05-14 23:55:13
001574cd5824c0b1ea90dd4f4ba6d5b8,2017-11-26 02:13:57,2017-11-26 02:13:57
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33,2018-01-22 20:16:33
002348c1099e3229276c8ad7d4ddc702,2018-01-10 12:28:22,2018-01-10 12:28:22
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45,2018-08-20 11:23:45
0026d252429f669d454d726e5e956aa1,2017-11-09 16:08:41,2017-11-09 16:08:41
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32,2018-05-21 23:17:32
002b5342c72978cf0aba6aae1f5d5293,2018-09-10 17:51:25,2018-09-10 17:51:25
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12,2017-10-19 09:3
Query:
SELECT o."customer_id", AVG(op."payment_value") AS avg_payment_per_order
   FROM "orders" AS o
   JOIN "order_payments" AS op ON o."order_id" = op."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,avg_payment_per_order
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,26.5575
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,21.733333333333334
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49
Query:
SELECT
    customer_stats."customer_id",
    customer_stats.num_orders,
    customer_stats.avg_payment_per_order,
    customer_stats.lifespan_weeks
FROM (
    SELECT
        o."customer_id",
        COUNT(DISTINCT o."order_id") AS num_orders,
        AVG(op_total.order_total_payment) AS avg_payment_per_order,
        CASE
            WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
            THEN 1.0
            ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
        END AS lifespan_weeks
    FROM "orders" AS o
    JOIN (
        SELECT "order_id", SUM("payment_value") AS order_total_payment
        FROM "order_payments"
        GROUP BY "order_id"
    ) AS op_total ON o."order_id" = op_total."order_id"
    GROUP BY o."customer_id"
) AS customer_stats
ORDER BY customer_stats.avg_payment_per_order DESC
LIMIT 3;
Answer:
customer_id,num_orders,avg_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0
Query:
SELECT "customer_id",
       CASE
         WHEN (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) < 7.0
         THEN 1.0
         ELSE (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0
       END AS lifespan_weeks
FROM "orders"
GROUP BY "customer_id"
LIMIT 100
Answer:
customer_id,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1.0
000161a058600d5901f007fab4c27140,1.0
0001fd6190edaaf884bcaf3d49edf079,1.0
0002414f95344307404f0ace7a26f1d5,1.0
000379cdec625522490c315e70c7a9fb,1.0
0004164d20a9e969af783496f3408652,1.0
000419c5494106c306a97b5635748086,1.0
00046a560d407e99b969756e0b10f282,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1.0
000598caf2ef4117407665ac33275130,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1.0
00062b33cb9f6fe976afdcff967ea74d,1.0
00066ccbe787a588c52bd5ff404590e3,1.0
00072d033fe2e59061ae5c3aff1a2be5,1.0
0009a69b72033b2d0ec8c69fc70ef768,1.0
000bf8121c3412d3057d32371c5d3395,1.0
000e943451fc2788ca6ac98a682f2f49,1.0
000f17e290c26b28549908a04cfe36c1,1.0
000fd45d6fedae68fc6676036610f879,1.0
0010068a73b7c56da5758c3f9e5c7375,1.0
001028b78fd413e19704b3867c369d3a,1.0
00104a47c29da701ce41ee52077587d9,1.0
001051abfcfdbed9f87b4266213a5df1,1.0
00114026c1b7b52ab1773f317ef4880b,1.0
001226b2341ef620415ce7bbafcfac28,1.0
0012a5c13793cf51e253f096a7e740dd,1.0
0013280441d86a4f7a8006efdaf1b0fe,1.0
0013cd8e350a7cc76873441e431dd5ee,1.0
001450ebb4a77efb3d68be5f7887cb1e,1.0
00146ad30454993879adaa91c518f68c,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1.0
0015bc9fd2d5395446143e8b215d7c75,1.0
0015f7887e2fde13ddaa7b8e385af919,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1.0
0018c09f333634ca9c80d9ff46e43e9c,1.0
0018f7fde63ca77254dbc47f4ea358b2,1.0
0019c9aaad15b043c48f0a1180f22ce8,1.0
001a57041f56400917a187dd74e6cbc1,1.0
001b4e9b73aa98a6276b241bfd496822,1.0
001c7f05398c45b42eee0d5a77783bca,1.0
001df1ee5c36767aa607001ab1a13a06,1.0
001f150aebb5d897f2059b0460c38449,1.0
001f35d9f262c558fd065346fbf5801d,1.0
001f6f1a5e902ad14e1f709a7215de11,1.0
00205ad9ba1ef4340cef86583294cf82,1.0
002236c4f333bc8df6a5939749eb7869,1.0
002348c1099e3229276c8ad7d4ddc702,1.0
002408f390f729598bbac1ef9421c6ae,1.0
002450e9ea44cb90b8a07ba0b197e149,1.0
002554bdf9eb99618d8189c3a89fdd52,1.0
0026955706fd4e2fa997f3f4c18d485a,1.0
0026d252429f669d454d726e5e956aa1,1.0
002834b4d901534f48d9e9a72047b288,1.0
0028ff36263a86bf679df7c863a0a0ba,1.0
002905287304e28c0218389269b4759b,1.0
002937abdae13680e17dccd3868b4825,1.0
0029cdf064769cabdf3186b54d068c99,1.0
002a10e899b62a460b0116e0b68697ad,1.0
002b24cb2cd0c3e575040dbd278885e3,1.0
002b5342c72978cf0aba6aae1f5d5293,1.0
002c625393dfa194828b462a6ef8cb0b,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1.0
002d358e2462f87678443706cbf2eb21,1.0
002d597546b2cf44428232c9f237f873,1.0
002ebb669a34b9e79c88efc755e95322,1.0
002ef7e55600d44ead53f7c1644e5222,1.0
002f067b028a3643ad3a0969c7a0f3dc,1.0
002f90a6eb386bc43bc9ba200db31a89,1.0
002fb8fc5ce64f8422fa2fe79986c783,1.0
002ff70a5285669011090c077ef929af,1.0
00302a0b99783c3d1d1e81c616e321e8,1.0
0030aded3a67b29946a128ee8468388e,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1.0
00314f95a054231742e3c5396b333b88,1.0
003177b3eeca50af17750f53802c9a09,1.0
0031abfb953b66e998f67b09e7b11375,1.0
0031c1062edf836ef7a7a7ea758b137b,1.0
00330644cccc5db0276fa836976306fe,1.0
00331de1659c7f4fb660c8810e6de3f5,1.0
0033823ee55671ac5317d423291333c2,1.0
0034f7933de3ead6bd9ba49afe95f119,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1.0
0036875772a8eeb391b8cd7226283fdd,1.0
0037d14e53af1d555a582504a4058f4c,1.0
00380c010de38d578d02117f6d0b88e7,1.0
0039b3e41ac6615814a0b44a8992bff5,1.0
003a75d228dc67cb2918e40c2aacc4bf,1.0
003b595c764773e20e0949b6fba7b1dc,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1.0
003bdf7fd8312f9d14a4b979f3747334,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1.0
003cb2c7ce25d8af8556fb456f903546,1.0
003cbe6a43560a8b6fd2c07531257c2d,1.0
003e45472805afa1ee701d83284fa22b,1.0
003eab528664e1bd677218ef4be086ac,1.0
003ec17a1389fa302f3a0423dddd8650,1.0
003f7d92ac63c512bb6584219806f8df,1.0
0040a8417928d0d5abd5169cd7877181,1.0
Query:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS num_orders,
       AVG(op_total.order_total_payment) AS avg_payment_per_order
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
LIMIT 100
Answer:
customer_id,num_orders,avg_payment_per_order
00012a2ce6f8dcda20d059ce98491703,1,114.74
000161a058600d5901f007fab4c27140,1,67.41
0001fd6190edaaf884bcaf3d49edf079,1,195.42
0002414f95344307404f0ace7a26f1d5,1,179.35
000379cdec625522490c315e70c7a9fb,1,107.01
0004164d20a9e969af783496f3408652,1,71.8
000419c5494106c306a97b5635748086,1,49.4
00046a560d407e99b969756e0b10f282,1,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,1,85.23
000598caf2ef4117407665ac33275130,1,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,1,147.33
00062b33cb9f6fe976afdcff967ea74d,1,58.95
00066ccbe787a588c52bd5ff404590e3,1,270.0
00072d033fe2e59061ae5c3aff1a2be5,1,106.97
0009a69b72033b2d0ec8c69fc70ef768,1,173.6
000bf8121c3412d3057d32371c5d3395,1,45.56
000e943451fc2788ca6ac98a682f2f49,1,106.23
000f17e290c26b28549908a04cfe36c1,1,139.52
000fd45d6fedae68fc6676036610f879,1,66.81
0010068a73b7c56da5758c3f9e5c7375,1,54.83
001028b78fd413e19704b3867c369d3a,1,37.61
00104a47c29da701ce41ee52077587d9,1,100.34
001051abfcfdbed9f87b4266213a5df1,1,65.2
00114026c1b7b52ab1773f317ef4880b,1,66.01
001226b2341ef620415ce7bbafcfac28,1,47.53
0012a5c13793cf51e253f096a7e740dd,1,369.92
0013280441d86a4f7a8006efdaf1b0fe,1,162.15
0013cd8e350a7cc76873441e431dd5ee,1,92.6
001450ebb4a77efb3d68be5f7887cb1e,1,61.33
00146ad30454993879adaa91c518f68c,1,221.79
00155f0530cc7b2bf73cc3f81cb01c52,1,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,1,184.94
0015bc9fd2d5395446143e8b215d7c75,1,132.19
0015f7887e2fde13ddaa7b8e385af919,1,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,1,50.01
0018c09f333634ca9c80d9ff46e43e9c,1,56.87
0018f7fde63ca77254dbc47f4ea358b2,1,51.27
0019c9aaad15b043c48f0a1180f22ce8,1,112.83
001a57041f56400917a187dd74e6cbc1,1,53.72
001b4e9b73aa98a6276b241bfd496822,1,82.87
001c7f05398c45b42eee0d5a77783bca,1,21.94
001df1ee5c36767aa607001ab1a13a06,1,42.86
001f150aebb5d897f2059b0460c38449,1,125.97
001f35d9f262c558fd065346fbf5801d,1,46.53
001f6f1a5e902ad14e1f709a7215de11,1,34.86
00205ad9ba1ef4340cef86583294cf82,1,928.7
002236c4f333bc8df6a5939749eb7869,1,69.84
002348c1099e3229276c8ad7d4ddc702,1,249.56
002408f390f729598bbac1ef9421c6ae,1,258.01
002450e9ea44cb90b8a07ba0b197e149,1,40.0
002554bdf9eb99618d8189c3a89fdd52,1,244.08
0026955706fd4e2fa997f3f4c18d485a,1,121.9
0026d252429f669d454d726e5e956aa1,1,139.15
002834b4d901534f48d9e9a72047b288,1,214.14
0028ff36263a86bf679df7c863a0a0ba,1,74.94
002905287304e28c0218389269b4759b,1,31.7
002937abdae13680e17dccd3868b4825,1,43.55
0029cdf064769cabdf3186b54d068c99,1,483.7
002a10e899b62a460b0116e0b68697ad,1,92.81
002b24cb2cd0c3e575040dbd278885e3,1,40.22
002b5342c72978cf0aba6aae1f5d5293,1,51.17
002c625393dfa194828b462a6ef8cb0b,1,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,1,185.6
002d358e2462f87678443706cbf2eb21,1,45.61
002d597546b2cf44428232c9f237f873,1,117.74
002ebb669a34b9e79c88efc755e95322,1,133.57
002ef7e55600d44ead53f7c1644e5222,1,199.02
002f067b028a3643ad3a0969c7a0f3dc,1,107.84
002f90a6eb386bc43bc9ba200db31a89,1,153.51
002fb8fc5ce64f8422fa2fe79986c783,1,67.68
002ff70a5285669011090c077ef929af,1,81.14
00302a0b99783c3d1d1e81c616e321e8,1,159.48
0030aded3a67b29946a128ee8468388e,1,58.59
0030fbb95fbe7e61f798a80edb01a8e9,1,26.85
00314f95a054231742e3c5396b333b88,1,59.34
003177b3eeca50af17750f53802c9a09,1,133.81
0031abfb953b66e998f67b09e7b11375,1,671.85
0031c1062edf836ef7a7a7ea758b137b,1,81.0
00330644cccc5db0276fa836976306fe,1,55.1
00331de1659c7f4fb660c8810e6de3f5,1,243.69
0033823ee55671ac5317d423291333c2,1,79.48
0034f7933de3ead6bd9ba49afe95f119,1,84.24
003536ce5e18f1d12b9bf76932f8a6b1,1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,1,78.2
0036875772a8eeb391b8cd7226283fdd,1,61.85
0037d14e53af1d555a582504a4058f4c,1,603.4
00380c010de38d578d02117f6d0b88e7,1,64.1
0039b3e41ac6615814a0b44a8992bff5,1,34.59
003a75d228dc67cb2918e40c2aacc4bf,1,79.28
003b595c764773e20e0949b6fba7b1dc,1,25.46
003bc8d06ebed9d146eb9f100d0a89ae,1,600.04
003bdf7fd8312f9d14a4b979f3747334,1,43.68
003c7cadba4f182b9f22d7d5ea7a5003,1,128.25
003cb2c7ce25d8af8556fb456f903546,1,420.94
003cbe6a43560a8b6fd2c07531257c2d,1,27.75
003e45472805afa1ee701d83284fa22b,1,30.6
003eab528664e1bd677218ef4be086ac,1,77.1
003ec17a1389fa302f3a0423dddd8650,1,17.77
003f7d92ac63c512bb6584219806f8df,1,84.91
0040a8417928d0d5abd5169cd7877181,1,219.49
Query:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS num_orders,
       AVG(op_total.order_total_payment) AS avg_payment_per_order,
       CASE
         WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
         THEN 1.0
         ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
       END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
LIMIT 100
Answer:
customer_id,num_orders,avg_payment_per_order,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1,114.74,1.0
000161a058600d5901f007fab4c27140,1,67.41,1.0
0001fd6190edaaf884bcaf3d49edf079,1,195.42,1.0
0002414f95344307404f0ace7a26f1d5,1,179.35,1.0
000379cdec625522490c315e70c7a9fb,1,107.01,1.0
0004164d20a9e969af783496f3408652,1,71.8,1.0
000419c5494106c306a97b5635748086,1,49.4,1.0
00046a560d407e99b969756e0b10f282,1,166.59,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1,85.23,1.0
000598caf2ef4117407665ac33275130,1,1255.71,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1,147.33,1.0
00062b33cb9f6fe976afdcff967ea74d,1,58.95,1.0
00066ccbe787a588c52bd5ff404590e3,1,270.0,1.0
00072d033fe2e59061ae5c3aff1a2be5,1,106.97,1.0
0009a69b72033b2d0ec8c69fc70ef768,1,173.6,1.0
000bf8121c3412d3057d32371c5d3395,1,45.56,1.0
000e943451fc2788ca6ac98a682f2f49,1,106.23,1.0
000f17e290c26b28549908a04cfe36c1,1,139.52,1.0
000fd45d6fedae68fc6676036610f879,1,66.81,1.0
0010068a73b7c56da5758c3f9e5c7375,1,54.83,1.0
001028b78fd413e19704b3867c369d3a,1,37.61,1.0
00104a47c29da701ce41ee52077587d9,1,100.34,1.0
001051abfcfdbed9f87b4266213a5df1,1,65.2,1.0
00114026c1b7b52ab1773f317ef4880b,1,66.01,1.0
001226b2341ef620415ce7bbafcfac28,1,47.53,1.0
0012a5c13793cf51e253f096a7e740dd,1,369.92,1.0
0013280441d86a4f7a8006efdaf1b0fe,1,162.15,1.0
0013cd8e350a7cc76873441e431dd5ee,1,92.6,1.0
001450ebb4a77efb3d68be5f7887cb1e,1,61.33,1.0
00146ad30454993879adaa91c518f68c,1,221.79,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1,40.75,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1,184.94,1.0
0015bc9fd2d5395446143e8b215d7c75,1,132.19,1.0
0015f7887e2fde13ddaa7b8e385af919,1,186.74,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1,50.01,1.0
0018c09f333634ca9c80d9ff46e43e9c,1,56.87,1.0
0018f7fde63ca77254dbc47f4ea358b2,1,51.27,1.0
0019c9aaad15b043c48f0a1180f22ce8,1,112.83,1.0
001a57041f56400917a187dd74e6cbc1,1,53.72,1.0
001b4e9b73aa98a6276b241bfd496822,1,82.87,1.0
001c7f05398c45b42eee0d5a77783bca,1,21.94,1.0
001df1ee5c36767aa607001ab1a13a06,1,42.86,1.0
001f150aebb5d897f2059b0460c38449,1,125.97,1.0
001f35d9f262c558fd065346fbf5801d,1,46.53,1.0
001f6f1a5e902ad14e1f709a7215de11,1,34.86,1.0
00205ad9ba1ef4340cef86583294cf82,1,928.7,1.0
002236c4f333bc8df6a5939749eb7869,1,69.84,1.0
002348c1099e3229276c8ad7d4ddc702,1,249.56,1.0
002408f390f729598bbac1ef9421c6ae,1,258.01,1.0
002450e9ea44cb90b8a07ba0b197e149,1,40.0,1.0
002554bdf9eb99618d8189c3a89fdd52,1,244.08,1.0
0026955706fd4e2fa997f3f4c18d485a,1,121.9,1.0
0026d252429f669d454d726e5e956aa1,1,139.15,1.0
002834b4d901534f48d9e9a72047b288,1,214.14,1.0
0028ff36263a86bf679df7c863a0a0ba,1,74.94,1.0
002905287304e28c0218389269b4759b,1,31.7,1.0
002937abdae13680e17dccd3868b4825,1,43.55,1.0
0029cdf064769cabdf3186b54d068c99,1,483.7,1.0
002a10e899b62a460b0116e0b68697ad,1,92.81,1.0
002b24cb2cd0c3e575040dbd278885e3,1,40.22,1.0
002b5342c72978cf0aba6aae1f5d5293,1,51.17,1.0
002c625393dfa194828b462a6ef8cb0b,1,371.87,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1,185.6,1.0
002d358e2462f87678443706cbf2eb21,1,45.61,1.0
002d597546b2cf44428232c9f237f873,1,117.74,1.0
002ebb669a34b9e79c88efc755e95322,1,133.57,1.0
002ef7e55600d44ead53f7c1644e5222,1,199.02,1.0
002f067b028a3643ad3a0969c7a0f3dc,1,107.84,1.0
002f90a6eb386bc43bc9ba200db31a89,1,153.51,1.0
002fb8fc5ce64f8422fa2fe79986c783,1,67.68,1.0
002ff70a5285669011090c077ef929af,1,81.14,1.0
00302a0b99783c3d1d1e81c616e321e8,1,159.48,1.0
0030aded3a67b29946a128ee8468388e,1,58.59,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1,26.85,1.0
00314f95a054231742e3c5396b333b88,1,59.34,1.0
003177b3eeca50af17750f53802c9a09,1,133.81,1.0
0031abfb953b66e998f67b09e7b11375,1,671.85,1.0
0031c1062edf836ef7a7a7ea758b137b,1,81.0,1.0
00330644cccc5db0276fa836976306fe,1,55.1,1.0
00331de1659c7f4fb660c8810e6de3f5,1,243.69,1.0
0033823ee55671ac5317d423291333c2,1,79.48,1.0
0034f7933de3ead6bd9ba49afe95f119,1,84.24,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1,53.33,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1,78.2,1.0
0036875772a8eeb391b8cd7226283fdd,1,61.85,1.0
0037d14e53af1d555a582504a4058f4c,1,603.4,1.0
00380c010de38d578d02117f6d0b88e7,1,64.1,1.0
0039b3e41ac6615814a0b44a8992bff5,1,34.59,1.0
003a75d228dc67cb2918e40c2aacc4bf,1,79.28,1.0
003b595c764773e20e0949b6fba7b1dc,1,25.46,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1,600.04,1.0
003bdf7fd8312f9d14a4b979f3747334,1,43.68,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1,128.25,1.0
003cb2c7ce25d8af8556fb456f903546,1,420.94,1.0
003cbe6a43560a8b6fd2c07531257c2d,1,27.75,1.0
003e45472805afa1ee701d83284fa22b,1,30.6,1.0
003eab528664e1bd677218ef4be086ac,1,77.1,1.0
003ec17a1389fa302f3a0423dddd8650,1,17.77,1.0
003f7d92ac63c512bb6584219806f8df,1,84.91,1.0
0040a8417928d0d5abd5169cd7877181,1,219.49,1.0
Query:
SELECT customer_stats."customer_id", customer_stats.num_orders, customer_stats.avg_payment_per_order, customer_stats.lifespan_weeks
FROM (
  SELECT o."customer_id",
         COUNT(DISTINCT o."order_id") AS num_orders,
         AVG(op_total.order_total_payment) AS avg_payment_per_order,
         CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
         END AS lifespan_weeks
  FROM "orders" AS o
  JOIN (
      SELECT "order_id", SUM("payment_value") AS order_total_payment
      FROM "order_payments"
      GROUP BY "order_id"
  ) AS op_total ON o."order_id" = op_total."order_id"
  GROUP BY o."customer_id"
  ORDER BY avg_payment_per_order DESC
  LIMIT 3
) AS customer_stats
LIMIT 100
Answer:
customer_id,num_orders,avg_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0
Query:
SELECT o."customer_id",
       SUM(op_total.order_total_payment) AS total_payment,
       COUNT(DISTINCT o."order_id") AS num_orders,
       CASE
         WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
         THEN 1.0
         ELSE (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0
       END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
LIMIT 100
Answer:
customer_id,total_payment,num_orders,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,114.74,1,1.0
000161a058600d5901f007fab4c27140,67.41,1,1.0
0001fd6190edaaf884bcaf3d49edf079,195.42,1,1.0
0002414f95344307404f0ace7a26f1d5,179.35,1,1.0
000379cdec625522490c315e70c7a9fb,107.01,1,1.0
0004164d20a9e969af783496f3408652,71.8,1,1.0
000419c5494106c306a97b5635748086,49.4,1,1.0
00046a560d407e99b969756e0b10f282,166.59,1,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,85.23,1,1.0
000598caf2ef4117407665ac33275130,1255.71,1,1.0
0005aefbb696d34b3424dccd0a0e9fd0,147.33,1,1.0
00062b33cb9f6fe976afdcff967ea74d,58.95,1,1.0
00066ccbe787a588c52bd5ff404590e3,270.0,1,1.0
00072d033fe2e59061ae5c3aff1a2be5,106.97,1,1.0
0009a69b72033b2d0ec8c69fc70ef768,173.6,1,1.0
000bf8121c3412d3057d32371c5d3395,45.56,1,1.0
000e943451fc2788ca6ac98a682f2f49,106.23,1,1.0
000f17e290c26b28549908a04cfe36c1,139.52,1,1.0
000fd45d6fedae68fc6676036610f879,66.81,1,1.0
0010068a73b7c56da5758c3f9e5c7375,54.83,1,1.0
001028b78fd413e19704b3867c369d3a,37.61,1,1.0
00104a47c29da701ce41ee52077587d9,100.34,1,1.0
001051abfcfdbed9f87b4266213a5df1,65.2,1,1.0
00114026c1b7b52ab1773f317ef4880b,66.01,1,1.0
001226b2341ef620415ce7bbafcfac28,47.53,1,1.0
0012a5c13793cf51e253f096a7e740dd,369.92,1,1.0
0013280441d86a4f7a8006efdaf1b0fe,162.15,1,1.0
0013cd8e350a7cc76873441e431dd5ee,92.6,1,1.0
001450ebb4a77efb3d68be5f7887cb1e,61.33,1,1.0
00146ad30454993879adaa91c518f68c,221.79,1,1.0
00155f0530cc7b2bf73cc3f81cb01c52,40.75,1,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94,1,1.0
0015bc9fd2d5395446143e8b215d7c75,132.19,1,1.0
0015f7887e2fde13ddaa7b8e385af919,186.74,1,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,50.01,1,1.0
0018c09f333634ca9c80d9ff46e43e9c,56.87,1,1.0
0018f7fde63ca77254dbc47f4ea358b2,51.27,1,1.0
0019c9aaad15b043c48f0a1180f22ce8,112.83,1,1.0
001a57041f56400917a187dd74e6cbc1,53.72,1,1.0
001b4e9b73aa98a6276b241bfd496822,82.87,1,1.0
001c7f05398c45b42eee0d5a77783bca,21.94,1,1.0
001df1ee5c36767aa607001ab1a13a06,42.86,1,1.0
001f150aebb5d897f2059b0460c38449,125.97,1,1.0
001f35d9f262c558fd065346fbf5801d,46.53,1,1.0
001f6f1a5e902ad14e1f709a7215de11,34.86,1,1.0
00205ad9ba1ef4340cef86583294cf82,928.7,1,1.0
002236c4f333bc8df6a5939749eb7869,69.84,1,1.0
002348c1099e3229276c8ad7d4ddc702,249.56,1,1.0
002408f390f729598bbac1ef9421c6ae,258.01,1,1.0
002450e9ea44cb90b8a07ba0b197e149,40.0,1,1.0
002554bdf9eb99618d8189c3a89fdd52,244.08,1,1.0
0026955706fd4e2fa997f3f4c18d485a,121.9,1,1.0
0026d252429f669d454d726e5e956aa1,139.15,1,1.0
002834b4d901534f48d9e9a72047b288,214.14,1,1.0
0028ff36263a86bf679df7c863a0a0ba,74.94,1,1.0
002905287304e28c0218389269b4759b,31.7,1,1.0
002937abdae13680e17dccd3868b4825,43.55,1,1.0
0029cdf064769cabdf3186b54d068c99,483.7,1,1.0
002a10e899b62a460b0116e0b68697ad,92.81,1,1.0
002b24cb2cd0c3e575040dbd278885e3,40.22,1,1.0
002b5342c72978cf0aba6aae1f5d5293,51.17,1,1.0
002c625393dfa194828b462a6ef8cb0b,371.87,1,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,185.6,1,1.0
002d358e2462f87678443706cbf2eb21,45.61,1,1.0
002d597546b2cf44428232c9f237f873,117.74,1,1.0
002ebb669a34b9e79c88efc755e95322,133.57,1,1.0
002ef7e55600d44ead53f7c1644e5222,199.02,1,1.0
002f067b028a3643ad3a0969c7a0f3dc,107.84,1,1.0
002f90a6eb386bc43bc9ba200db31a89,153.51,1,1.0
002fb8fc5ce64f8422fa2fe79986c783,67.68,1,1.0
002ff70a5285669011090c077ef929af,81.14,1,1.0
00302a0b99783c3d1d1e81c616e321e8,159.48,1,1.0
0030aded3a67b29946a128ee8468388e,58.59,1,1.0
0030fbb95fbe7e61f798a80edb01a8e9,26.85,1,1.0
00314f95a054231742e3c5396b333b88,59.34,1,1.0
003177b3eeca50af17750f53802c9a09,133.81,1,1.0
0031abfb953b66e998f67b09e7b11375,671.85,1,1.0
0031c1062edf836ef7a7a7ea758b137b,81.0,1,1.0
00330644cccc5db0276fa836976306fe,55.1,1,1.0
00331de1659c7f4fb660c8810e6de3f5,243.69,1,1.0
0033823ee55671ac5317d423291333c2,79.48,1,1.0
0034f7933de3ead6bd9ba49afe95f119,84.24,1,1.0
003536ce5e18f1d12b9bf76932f8a6b1,53.33,1,1.0
0035b30e58c620fa2bd30275ddd4f7ef,78.2,1,1.0
0036875772a8eeb391b8cd7226283fdd,61.85,1,1.0
0037d14e53af1d555a582504a4058f4c,603.4,1,1.0
00380c010de38d578d02117f6d0b88e7,64.1,1,1.0
0039b3e41ac6615814a0b44a8992bff5,34.59,1,1.0
003a75d228dc67cb2918e40c2aacc4bf,79.28,1,1.0
003b595c764773e20e0949b6fba7b1dc,25.46,1,1.0
003bc8d06ebed9d146eb9f100d0a89ae,600.04,1,1.0
003bdf7fd8312f9d14a4b979f3747334,43.68,1,1.0
003c7cadba4f182b9f22d7d5ea7a5003,128.25,1,1.0
003cb2c7ce25d8af8556fb456f903546,420.94,1,1.0
003cbe6a43560a8b6fd2c07531257c2d,27.75,1,1.0
003e45472805afa1ee701d83284fa22b,30.6,1,1.0
003eab528664e1bd677218ef4be086ac,77.1,1,1.0
003ec17a1389fa302f3a0423dddd8650,17.77,1,1.0
003f7d92ac63c512bb6584219806f8df,84.91,1,1.0
0040a8417928d0d5abd5169cd7877181,219.49,1,1.0
End Exploring Related Columns
Task: Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: ```csv
number_of_orders,average_payment_per_order,lifespan_weeks
num_orders1:int,average_payment1:float,lifespan1:float
num_orders2:int,average_payment2:float,lifespan2:float
num_orders3:int,average_payment3:float,lifespan3:float
(Attention: answer in three rows)
```

**Explanation:**

The table displays the number of orders, average payment per order, and the customer lifespan in weeks for the top 3 customers with the highest average payment per order. The lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than one, setting it to 1.0..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is (table names): 
['product_category_name_translation', 'sellers', 'customers', 'geolocation', 'order_items', 'order_payments', 'order_reviews', 'orders', 'products', 'leads_qualified', 'leads_closed']

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 13:49:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:49:29 - root - INFO - ```sql
SELECT
    COUNT(DISTINCT o."order_id") AS number_of_orders,
    ROUND(AVG(op_total.order_total_payment), 4) AS average_payment_per_order,
    CASE
        WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0 THEN 1.0
        ELSE ROUND((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0, 4)
    END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
ORDER BY average_payment_per_order DESC
LIMIT 3;
```
2025-02-10 13:49:30 - root - INFO - itercount: 1
2025-02-10 13:49:30 - root - INFO - 0
2025-02-10 13:49:30 - root - INFO - results: 
number_of_orders,average_payment_per_order,lifespan_weeks
1,13664.08,1.0
1,7274.88,1.0
1,6929.31,1.0


2025-02-10 13:49:30 - root - INFO - Please check the answer again by reviewing Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
number_of_orders,average_payment_per_order,lifespan_weeks
num_orders1:int,average_payment1:float,lifespan1:float
num_orders2:int,average_payment2:float,lifespan2:float
num_orders3:int,average_payment3:float,lifespan3:float
(Attention: answer in three rows)
```

**Explanation:**

The table displays the number of orders, average payment per order, and the customer lifespan in weeks for the top 3 customers with the highest average payment per order. The lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than one, setting it to 1.0. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_orders,average_payment_per_order,lifespan_weeks
1,13664.08,1.0
1,7274.88,1.0
1,6929.31,1.0
Current sql:
SELECT
    COUNT(DISTINCT o."order_id") AS number_of_orders,
    ROUND(AVG(op_total.order_total_payment), 4) AS average_payment_per_order,
    CASE
        WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0 THEN 1.0
        ELSE ROUND((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0, 4)
    END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
ORDER BY average_payment_per_order DESC
LIMIT 3;
2025-02-10 13:50:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:50:24 - root - INFO - ```sql
SELECT
    COUNT(DISTINCT o."order_id") AS number_of_orders,
    ROUND(AVG(op_total.order_total_payment), 4) AS average_payment_per_order,
    CASE
        WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0 THEN 1.0
        ELSE ROUND(((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0), 4)
    END AS lifespan_weeks
FROM "orders" AS o
JOIN (
    SELECT "order_id", SUM("payment_value") AS order_total_payment
    FROM "order_payments"
    GROUP BY "order_id"
) AS op_total ON o."order_id" = op_total."order_id"
GROUP BY o."customer_id"
ORDER BY average_payment_per_order DESC
LIMIT 3;
```
2025-02-10 13:50:25 - root - INFO - itercount: 2
2025-02-10 13:50:25 - root - INFO - 0
2025-02-10 13:50:25 - root - INFO - Total iteration counts: 2
