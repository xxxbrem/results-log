2025-02-10 13:45:12 - openai._base_client - INFO - Retrying request to /chat/completions in 0.417267 seconds
2025-02-10 13:46:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:46:21 - root - INFO - SQL:
SELECT DISTINCT "customer_id"
   FROM "orders"
   LIMIT 100;
Results:
customer_id
9ef432eb6251297304e76186b10a928d
b0830fb4747a6c6d20dea0b8c802d7ef
41ce2a54c0b03bf3443c3d931a367089
f88197465ea7920adcdbec7375364d82
8ab97904e6daea8866dbdbc4fb7aad2c
503740e9ca751ccdda7ba28e9ab8f608
ed0271e0b7da060a393796590e7b737a
9bdf08b4b3b52b5526ff42d37d47f222
f54a9f0e6b351c431402b8461ea51999
31ad1d1b63eb9962463f764d4e6e0c9d
494dded5b201313c64ed7f100595b95c
7711cf624183d843aafe81855097bc37
d3e3b74c766bc6214e0c830b17ee2341
19402a48fe860416adf93348aba37740
3df704f53d3f1d4818840b34ec672a9f
3b6828a50ffe546942b7a473d70ac0fc
738b086814c6fcc74b8cc583f8516ee3
3187789bec990987628d7a9beb4dd6ac
059f7fc5719c7da6cbafe370971a8d70
7f8c8b9c2ae27bf3300f670c3d478be8
d2b091571da224a1b36412c18bc3bbfe
4fa1cd166fa598be6de80fa84eaade43
72ae281627a6102d9b3718528b420f8a
a166da34890074091a942054b36e4265
62b423aab58096ca514ba6aa06be2f98
3a874b4d4c4b6543206ff5d89287f0c3
7e20bf5ca92da68200643bda76c504c6
8b212b9525f9e74e85e37ed6df37693e
cce89a605105b148387c52e286ac8335
761df82feda9778854c6dafdaeb567e4
456dc10730fbdba34615447ea195d643
52142aa69d8d0e1247ab0cada0f76023
816f8653d5361cbf94e58c33f2502a5c
d9ef95f98d8da3b492bb8c0447910498
cf8ffeddf027932e51e4eae73b384059
5f16605299d698660e0606f7eae2d2f9
f5458ddc3545711efa883dd7ae7c4497
295ae9b35379e077273387ff64354b6f
2a1dfb647f32f4390e7b857c67458536
3391c4bc11a817e7973e498b0b023158
ddaff536587109b89777e0353215e150
c7340080e394356141681bd4c9b8fe31
8644be24d48806bc3a88fd59fb47ceb1
756fb9391752dad934e0fe3733378e57
caded193e8e47b8362864762a83db3c5
4f28355e5c17a4a42d3ce2439a1d4501
569cf68214806a39acc0f39344aea67f
12fd2740039676063a874b9567dfa651
2b56e94c2f66f2d97cfa63356f69cee8
7f2178c5d771e17f507d3c1637339298
9b18f3fc296990b97854e351334a32f6
148348ff65384b4249b762579532e248
79183cd650e2bb0d475b0067d45946ac
f5afca14dfa9dc64251cf2b45c54c363
f178c1827f67a8467b0385b7378d951a
67407057a7d5ee17d1cd09523f484d13
2932d241d1f31e6df6c701d52370ae02
684fa6da5134b9e4dab731e00011712d
911e4c37f5cafe1604fe6767034bf1ae
241e78de29b3090cfa1b5d73a8130c72
4632eb5a8f175f6fe020520ae0c678f3
dd5095632e3953fc0947b8ab5176b0be
9916715c2ab6ee1710c9c32f0a534ad2
c77ee2d8ba1614a4d489a44166894938
81e08b08e5ed4472008030d70327c71f
5dda11942d4f77bee3a46d71e442aec4
74805bc388861fa350ed2fade8444e0b
4afc1dcca5fe8926fc97d60a4497f8ab
be8c14c16a4d47194ccdfe10f1fc5b1a
a9d37ddc8ba4d9f6dbac7d8ec378cc95
bb2f5e670f7155dc622c57e4b31d0a69
55e6b290205c84ddd23ddf5eb134efd4
f5618502bee8eafdee72fb6955e2ebdf
a90391a47de936d56c66a5366cba1462
388025bec8128ff20ec1a316ed4dcf02
afb19a4b667cb708caab312757ec3d3f
636e15840ab051faa13d3f781b6e4233
05e996469a2bf9559c7122b87e156724
5bb39c890c91b1d26801aa19a9336eac
f26a435864aebedff7f7c84f82ee229f
29cb486c739f9774c8eb542e07b56cd2
bf141bf67fbe428d558bcf0e018eab60
b673f0597cb0c4d12778f731045f361a
6772a0a230a2667d16c3620f000e1348
9f6618c17568ac301465fe7ad056c674
fee181bf648906d1c57f84f216976286
df9b032b2ad0fd6bf37dfb48e5f83845
93ada7a24817edda9f4ab998fa823d16
64fb950e760ec8b0db79154a1fa9c1bf
48558a50a7ba1aab61891936d2ca7681
3a897024068ed42a183de61d5727d866
8628fac2267e8c8804525da99c10ed0e
332df68ccac2f2f7d9e11299188f8bce
e28dd4261bed9c7ba89ecaf411b88f7c
82f0b75bb50fcb30711e5277e36b3983
3135962ee745ef39b85576df7ddbaa99
1833a0540067becaf59368fe4cd4303a
68451b39b1314302c08c65a29f1140fc
0bf19317b1830a69e55b40710576aa7a
c622b892a190735ef81c0087973fa16d

2025-02-10 13:46:21 - root - INFO - SQL:
SELECT *
   FROM "customers"
   LIMIT 100;
Results:
Too long, hard cut:
customer_id,customer_unique_id,customer_zip_code_prefix,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,14409,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,9790,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,1151,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,8775,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,13056,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,89254,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,4534,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,35182,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,81560,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,30575,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,39400,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,20231,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,18682,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,5704,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,95110,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,13412,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,22750,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,7124,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,5416,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,68485,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,88034,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,74914,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,5713,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,82820,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,8225,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,9121,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,74310,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,4571,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,29311,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,5528,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,12235,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,18130,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,42800,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,27525,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,81750,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,13175,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,7170,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,93415,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,65075,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,88104,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,7176,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,35960,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,5727,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,7053,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,14026,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,30320,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,38300,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,18740,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,83085,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,89254,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,5351,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,39406,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,14860,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,21310,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,23970,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,79804,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3a

2025-02-10 13:46:21 - root - INFO - SQL:
SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM "orders"
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab

2025-02-10 13:46:21 - root - INFO - SQL:
SELECT "order_id", "payment_sequential", "payment_type", "payment_value"
   FROM "order_payments"
   LIMIT 100;
Results:
Too long, hard cut:
order_id,payment_sequential,payment_type,payment_value
b81ef226f3fe1789b1e8b2acac839d17,1,credit_card,99.33
a9810da82917af2d9aefd1278f1dcfa0,1,credit_card,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,1,credit_card,65.71
ba78997921bbcdc1373bb41e913ab953,1,credit_card,107.78
42fdf880ba16b47b59251dd489d4441a,1,credit_card,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,1,credit_card,96.12
771ee386b001f06208a7419e4fc1bbd7,1,credit_card,81.16
3d7239c394a212faae122962df514ac7,1,credit_card,51.84
1f78449c87a54faf9e96e88ba1491fa9,1,credit_card,341.09
0573b5e23cbd798006520e1d5b4c6714,1,boleto,51.95
d88e0d5fa41661ce03cf6cf336527646,1,credit_card,188.73
2480f727e869fdeb397244a21b721b67,1,credit_card,141.9
616105c9352a9668c38303ad44e056cd,1,credit_card,75.78
cf95215a722f3ebf29e6bbab87a29e61,1,credit_card,102.66
769214176682788a92801d8907fa1b40,1,credit_card,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,1,credit_card,157.45
61059985a6fc0ad64e95d9944caacdad,1,credit_card,132.04
79da3f5fe31ad1e454f06f95dc032ad5,1,credit_card,98.94
8ac09207f415d55acff302df7d6a895c,1,credit_card,244.15
b2349a3f20dfbeef62e7b31baa22f84b,1,credit_card,136.71
5a1f6d22f7dfb061ef29216b9af687a1,1,credit_card,47.69
4214cda550ece8ee66441f459dc33a8c,1,credit_card,170.57
adfbf6c2a620196f9a3ec747491c72b7,1,credit_card,67.5
4d680edbaa7d3d9bed69532957368a03,1,credit_card,353.09
8cd68144cdb62dc0d60848cf8616d2a4,1,boleto,330.66
5cfd514482e22bc992e7693f0e3e8df7,2,voucher,45.17
d0a945f85ba1074b60aac97ade7e240e,1,credit_card,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,1,credit_card,139.22
5d9c5817e278892b7498d90bfa28ade8,1,credit_card,290.16
b69b9260e79a0da00e15f48de1bd2524,1,boleto,283.34
f45074ae38f2e01d9b854ec8d40362ff,1,credit_card,13.78
81cedc4d2132eb6f512354166e51b187,1,credit_card,30.28
595f598849d89203c28d05d0fbf3f92e,1,credit_card,26.58
f9d0ec2fa088ac583e1ccd15b6686073,1,credit_card,89.68
e647bf617de735448a4ba54f8910393c,1,credit_card,65.09
b2bb080b6bc860118a246fd9b6fad6da,1,credit_card,173.84
23f10f509600c30cf2852f9dbdf28fc3,1,credit_card,103.49
f86f6472fa9f395d8d9a6751ca118afb,1,credit_card,64.03
1dcf0c8cd36ffaf57784fbdc90079310,1,credit_card,157.15
00d8d65b666158b633f96054d31af43b,1,boleto,130.88
cf30fe76d1505192acee1c6dccb15545,1,credit_card,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,1,credit_card,117.74
32b1d8f3789a57f1f752e20ac7404b4c,1,boleto,56.6
c10d412026c4077b8e83acf0fea04eee,1,credit_card,266.16
56c3277583e16009c925fdf116df420f,1,boleto,31.38
0e0441786430b7cfcd0d91f822ea4c99,1,credit_card,121.49
6ffb3f1686bceae3466facf7e02ce3fb,1,credit_card,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,1,credit_card,153.41
c0db7d31ace61fc360a3eaa34dd3457c,1,credit_card,65.71
d574338f566ca28dd67820f48ec1f1d8,1,credit_card,278.22
1807cc736321f14baa58ef39cf6e5989,1,credit_card,91.66
e8977f709bbb0367f51b589e6325f991,1,credit_card,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,1,credit_card,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,1,boleto,166.04
95442deb81a5d91c97c0df96b431634a,1,boleto,368.98
10af96a0689260134307879127ac1952,1,credit_card,113.2
85eef2d342b0de363c45c1bc324729c5,1,credit_card,99.43
aa964845f1de8125410aea8b73e9e1ec,1,credit_card,27.35
343348b1e29e9fa9e7b6ab1027f9177d,1,credit_card,43.77
ad4098a257676ea4d394fb3bbbf36ca3,1,credit_card,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,1,credit_card,105.53
3ab4eea6776259ae8dfbabaeffece352,1,credit_card,387.8
10d9871bed9fb8d0887d3b9022edd1ff,1,boleto,84.14
c108072ab31ec90a754129c171577f5f,1,credit_card,210.82
fc662bafa52d2ef16078f6f6141009d6,1,boleto,90.05
4217849b1ff18a9270fe048eabc4dc45,1,credit_card,67.88
795c16acb4e3c30dfa5b6827727ef488,1,credit_card,37.58
55e2d723733c45033e71cb4d44690234,1,boleto,89.63
947e9c6bfd83a06953c420ef92d3da6e,1,voucher,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,1,credit_card,78.3
e3e9e3295f4e1512167c232a0aaae8a5,1,voucher,50.8
460d57443ffdcaeba240360239747cf7,1,credit_card,34.0
4cb51127f19f7254b320efe1718477dd,1,boleto,77.1
110d9355d6338eab0a65a0cacdde5434,1,credit_card,566.4
42f5954cda381bd032934ee38c453711,1,credit_card,402.42
3689194c14ad4e2e7361ebd1df0e77b0,2,voucher,57.53
97c111c4f22dfa1089a9c0b5338dcc79,1,credit_card,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,1,credit_card,187.51
e1b4ee0e390fbac1dec439d72b45a115,1,credit_card,77.7
fee72a68ce935ebf2939fe72f27d3d9b,1,credit_card,48.68
4d3bfdf4c7d6578ea445d588371ae10e,1,credit_card,77.29
4c2e1a95586c815795a324d1599e7b5a,1,credit_card,117.71
c9f23db8a1cb725df9bdb3383bd72b38,1,credit_card,169.34
8e47a04b25d7a7075064e8e0bd2e0318,1,credit_card,37.61
723e462ce1ee50e024887c0b403130f3,1,credit_card,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,1,debit_card,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,1,credit_card,34.78
198298d54f269d8c5fe89e85a859af61,1,credit_card,342.56
b19ca559688b49e8cf7f88c1aa3f0009,1,credit_card,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,1,credit_card,117.85
4a02e985c7239d866a632f07ed20d9c0,1,credit_card,48.62
3e17eef8a8bd0131c7aed90d7508799e,1,credit_card,53.99
f8d323a2702fed37f0229965f7e9f8b3,1,credit_card,51.14
de4090fd9b7900d46323b0c7c36b7128,1,credit_card,121.45
17e5131fe1

2025-02-10 13:46:21 - root - INFO - SQL:
SELECT "order_id", SUM("payment_value") AS "total_payment"
   FROM "order_payments"
   GROUP BY "order_id"
   LIMIT 100;
Results:
order_id,total_payment
00010242fe8c5a6d1ba2dd792cb16214,72.19
00018f77f2f0320c557190d7a144bdd3,259.83
000229ec398224ef6ca0657da4fc703e,216.87
00024acbcdf0a6daa1e931b038114c75,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,34.59
00054e8431b9d7675808bcb819fb4a32,31.75
000576fe39319847cbb9d288c5617fa6,880.75
0005a1a1728c9d785b8e2b08b904576c,157.6
0005f50442cb953dcd1d21e1fb923495,65.39
00061f2a7bc09da83e415a52dc8a4af1,68.87
00063b381e2406b52ad429470734ebd5,57.98
0006ec9db01a64e59a68b2c340bf65a7,97.32
0008288aa423d2a3f00fcb17cd7d8719,126.54
0009792311464db532ff765bf7b182ae,127.55
0009c9a17f916a706d71784483a5d643,650.34
000aed2e25dbad2f9ddb70584c5a2ded,152.77
000c3e6612759851cc3cbb4b83257986,112.71
000e562887b1f2006d75e0be9558292e,41.11
000e63d38ae8c00bbcb5a30573b99628,56.78
000e906b789b55f64edcb1f84030f90d,33.84
000f25f4d72195062c040b12dce9a18a,164.39
001021efaa8636c29475e7734483457d,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,65.5
0010dedd556712d7bb69a19cb7bbd37a,111.12
00119ff934e539cf26f92b9ef0cdfed8,236.88
0011d82c4b53e22e84023405fb467e57,315.33
00125cb692d04887809806618a2a145f,135.41
00130c0eee84a3d909e75bc08c5c3ca1,35.84
0013503b13da1eac686219390b7d641b,137.22
00137e170939bba5a3134e2386413108,421.65
001427c0ec99cf8af737bd88e92fd444,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,109.29
0014ae671de39511f7575066200733b7,30.6
0015ebb40fb17286bea51d4607c4733c,37.0
00169e31ef4b29deaae414f9a5e95929,55.11
0016dfedd97fc2950e388d2971d718c7,70.55000000000001
0017afd5076e074a48f1f1a4c7bac9c5,853.39
001862358bf858722e1e2ae000cfed8b,113.71
0019c29108428acffd089c36103c9440,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,127.56
001ac194d4a326a6fa99b581e9a3d963,62.54
001b76dd48a5b1eee3e87778daa40df8,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,53.54
001daeb0eddc45b999bad0801ad9d273,55.12
001dbc16dc51075e987543d23a0507c7,87.9
001e7ba991be1b19605ca0316e7130f9,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,51.1
0020262c8a370bd5a174ea6a2a267321,100.55
0020a222f55eb79a372d0efee3cca688,45.09
002175704e8b209f61b9ad5cfd92b60e,123.11
00229e4e43f7a7e0b9dd819ad43268d3,91.39
0025081dcf9330f9a5052ae82c6ce396,33.18
00254baeb6c932b0a8aeead91fbd02b5,193.01
00259a44fcad3fc0474329e925d14fc3,34.09
0025c5d1a8ca53a240ec2634bb4492ea,419.39
002611a77fe03d076285fd4ca95db77c,156.75
002691433f09002ac9ca0c4e8dbb8ead,120.43
0026a368634b6e6f34f33b1499773a30,164.8
00275bce676303c3bfd7292aefdfa223,293.36
00276d5c3491fbf55305e26891040df9,68.12
002834535f7a609a5c68266f173fa59e,57.17
0028de0ca693a1bb26448916a81105cc,45.3
002955b0acc63d04f6724a31967e82bd,135.59
0029c5db35ef291ce99d1262012e7daa,514.37
0029f17cf0e7640c5cb6825af681303f,113.44
002af7fa9eb99d1456bceb6a13d6fc0b,109.45
002b430ff89b3a24c31a1170acbbedea,265.55
002b4e6fa42cd4a22cc86abc18fe9c05,119.57
002c9def9c9b951b1bec6d50753c9891,173.8
002d040018d12a3853c059f7f23ab5b1,169.84
002f16b7bc4530031b7d90f791b12d8a,284.13
002f19a65a2ddd70a090297872e6d64e,77.28999999999999
002f98c0f7efd42638ed6100ca699b42,93.62
0030d783f979fbc5981e75613b057344,78.27
0030ff924c38549807645976adeef2c0,292.24
00310b0c75bb13015ec4d82d341865a4,55.28
00324b3eda39ba5ecce3945823e3594c,110.07
0032d07457ae9c806c79368d7d9ce96b,186.19
003324c70b19a16798817b2b3640e721,234.7
00335b686d693c7d72deeb12f8e89227,80.79
00335f75ea6a4455b524a8dd177067f5,177.01
00337fe25a3780b3424d9ad7c5a4b35e,139.68
003423b755b562962a6225a8de40d12e,261.33
00345f338696283410b7977d2e3efc89,67.34
0035246a40f520710769010f752e7507,99.11
0035c0b07126fe9c24a325216fb96064,150.44
0035e6b7ade84b3f5b86bd49814793df,34.0
0036757472ece3dde52fd4bfd929c90e,203.03
0036887767dea4bd43b1a88cd0d9477a,423.63
00378c6c981f234634c0b9d6128df6dd,52.85
003822434f91204da0a51fe4cf2aba18,175.16
0039500db36d50d7d0bfaf23723550f3,203.23
003a7f59d7e08a9c61d9e2881fe6459c,134.28
003a94f778ef8cfd50247c8c1b582257,57.98
003cc6161d7a2593f2525cce0c330d32,97.9
003d0634280ff3d1d3a54459349a6899,228.89
003d804eef0e1b856881cd18e0cc0d4c,312.74
003d9fc84ad902adf2265248b5ffe1a4,94.74

2025-02-10 13:46:21 - root - INFO - SQL:
SELECT o."order_id", o."customer_id", p."payment_value"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,payment_value
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2.0
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,18.12
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,18.59
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,141.46
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,179.12
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,72.2
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,28.62
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,175.26
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,65.95
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,75.16
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,35.95
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,8.34
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,161.42
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,259.06
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,114.13
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,50.13
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,32.7
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,54.36
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,146.45
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,1376.45
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,43.09
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,29.75
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,5.96
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,24.86
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,62.15
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,118.86
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,88.9
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,17.28
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,187.57
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,104.11
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,125.43
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,227.68
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,60.69
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,192.68
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,63.34
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,313.19
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,224.9
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,63.1
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,100.25
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,188.41
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,106.95
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,66.79
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,43.0
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,508.17
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,49.69
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,154.19
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,356.12
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,95.67
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,121.62
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,22.36
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,153.72
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,54.82
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,82.33
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,52.24
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,130.56
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,52.84
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,71.91
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,151.04
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,386.33
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,50.25
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,128.68
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,43.46
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,91.68
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,99.26
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,141.15
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,91.66
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,53.66
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,317.34
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a

2025-02-10 13:46:22 - root - INFO - SQL:
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
Results:
customer_id,number_of_orders
00012a2ce6f8dcda20d059ce98491703,1
000161a058600d5901f007fab4c27140,1
0001fd6190edaaf884bcaf3d49edf079,1
0002414f95344307404f0ace7a26f1d5,1
000379cdec625522490c315e70c7a9fb,1
0004164d20a9e969af783496f3408652,1
000419c5494106c306a97b5635748086,1
00046a560d407e99b969756e0b10f282,1
00050bf6e01e69d5c0fd612f1bcfb69c,1
000598caf2ef4117407665ac33275130,1
0005aefbb696d34b3424dccd0a0e9fd0,1
00062b33cb9f6fe976afdcff967ea74d,1
00066ccbe787a588c52bd5ff404590e3,1
00072d033fe2e59061ae5c3aff1a2be5,1
0009a69b72033b2d0ec8c69fc70ef768,1
000bf8121c3412d3057d32371c5d3395,1
000e943451fc2788ca6ac98a682f2f49,1
000f17e290c26b28549908a04cfe36c1,1
000fd45d6fedae68fc6676036610f879,1
0010068a73b7c56da5758c3f9e5c7375,1
001028b78fd413e19704b3867c369d3a,1
00104a47c29da701ce41ee52077587d9,1
001051abfcfdbed9f87b4266213a5df1,1
00114026c1b7b52ab1773f317ef4880b,1
001226b2341ef620415ce7bbafcfac28,1
0012a5c13793cf51e253f096a7e740dd,1
0013280441d86a4f7a8006efdaf1b0fe,1
0013cd8e350a7cc76873441e431dd5ee,1
001450ebb4a77efb3d68be5f7887cb1e,1
00146ad30454993879adaa91c518f68c,1
00155f0530cc7b2bf73cc3f81cb01c52,1
001574cd5824c0b1ea90dd4f4ba6d5b8,1
0015bc9fd2d5395446143e8b215d7c75,1
0015f7887e2fde13ddaa7b8e385af919,1
0017a0b4c1f1bdb9c395fa0ac517109c,1
0018c09f333634ca9c80d9ff46e43e9c,1
0018f7fde63ca77254dbc47f4ea358b2,1
0019c9aaad15b043c48f0a1180f22ce8,1
001a57041f56400917a187dd74e6cbc1,1
001b4e9b73aa98a6276b241bfd496822,1
001c7f05398c45b42eee0d5a77783bca,1
001df1ee5c36767aa607001ab1a13a06,1
001f150aebb5d897f2059b0460c38449,1
001f35d9f262c558fd065346fbf5801d,1
001f6f1a5e902ad14e1f709a7215de11,1
00205ad9ba1ef4340cef86583294cf82,1
002236c4f333bc8df6a5939749eb7869,1
002348c1099e3229276c8ad7d4ddc702,1
002408f390f729598bbac1ef9421c6ae,1
002450e9ea44cb90b8a07ba0b197e149,1
002554bdf9eb99618d8189c3a89fdd52,1
0026955706fd4e2fa997f3f4c18d485a,1
0026d252429f669d454d726e5e956aa1,1
002834b4d901534f48d9e9a72047b288,1
0028ff36263a86bf679df7c863a0a0ba,1
002905287304e28c0218389269b4759b,1
002937abdae13680e17dccd3868b4825,1
0029cdf064769cabdf3186b54d068c99,1
002a10e899b62a460b0116e0b68697ad,1
002b24cb2cd0c3e575040dbd278885e3,1
002b5342c72978cf0aba6aae1f5d5293,1
002c625393dfa194828b462a6ef8cb0b,1
002ce108ccf0356ef5c8b1dce3c0ae29,1
002d358e2462f87678443706cbf2eb21,1
002d597546b2cf44428232c9f237f873,1
002ebb669a34b9e79c88efc755e95322,1
002ef7e55600d44ead53f7c1644e5222,1
002f067b028a3643ad3a0969c7a0f3dc,1
002f90a6eb386bc43bc9ba200db31a89,1
002fb8fc5ce64f8422fa2fe79986c783,1
002ff70a5285669011090c077ef929af,1
00302a0b99783c3d1d1e81c616e321e8,1
0030aded3a67b29946a128ee8468388e,1
0030fbb95fbe7e61f798a80edb01a8e9,1
00314f95a054231742e3c5396b333b88,1
003177b3eeca50af17750f53802c9a09,1
0031abfb953b66e998f67b09e7b11375,1
0031c1062edf836ef7a7a7ea758b137b,1
00330644cccc5db0276fa836976306fe,1
00331de1659c7f4fb660c8810e6de3f5,1
0033823ee55671ac5317d423291333c2,1
0034f7933de3ead6bd9ba49afe95f119,1
003536ce5e18f1d12b9bf76932f8a6b1,1
0035b30e58c620fa2bd30275ddd4f7ef,1
0036875772a8eeb391b8cd7226283fdd,1
0037d14e53af1d555a582504a4058f4c,1
00380c010de38d578d02117f6d0b88e7,1
0039b3e41ac6615814a0b44a8992bff5,1
003a75d228dc67cb2918e40c2aacc4bf,1
003b595c764773e20e0949b6fba7b1dc,1
003bc8d06ebed9d146eb9f100d0a89ae,1
003bdf7fd8312f9d14a4b979f3747334,1
003c7cadba4f182b9f22d7d5ea7a5003,1
003cb2c7ce25d8af8556fb456f903546,1
003cbe6a43560a8b6fd2c07531257c2d,1
003e45472805afa1ee701d83284fa22b,1
003eab528664e1bd677218ef4be086ac,1
003ec17a1389fa302f3a0423dddd8650,1
003f7d92ac63c512bb6584219806f8df,1
0040a8417928d0d5abd5169cd7877181,1

2025-02-10 13:46:22 - root - INFO - SQL:
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,total_payment
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,106.23
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,65.2
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49

2025-02-10 13:46:23 - root - INFO - SQL:
SELECT o."customer_id", AVG(p."payment_value") AS "average_payment_per_order"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,average_payment_per_order
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,26.5575
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,21.733333333333334
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49

2025-02-10 13:46:23 - root - INFO - SQL:
SELECT "customer_id", 
           MIN("order_purchase_timestamp") AS "first_purchase", 
           MAX("order_purchase_timestamp") AS "last_purchase"
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
Results:
Too long, hard cut:
customer_id,first_purchase,last_purchase
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13,2017-05-14 23:55:13
001574cd5824c0b1ea90dd4f4ba6d5b8,2017-11-26 02:13:57,2017-11-26 02:13:57
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33,2018-01-22 20:16:33
002348c1099e3229276c8ad7d4ddc702,2018-01-10 12:28:22,2018-01-10 12:28:22
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45,2018-08-20 11:23:45
0026d252429f669d454d726e5e956aa1,2017-11-09 16:08:41,2017-11-09 16:08:41
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32,2018-05-21 23:17:32
002b5342c72978cf0aba6aae1f5d5293,2018-09-10 17:51:25,2018-09-10 17:51:25
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12,2017-10-19 09:3

2025-02-10 13:47:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:47:22 - root - INFO - ```sql
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3;
```

The above SQL query calculates the number of orders, average payment per order, and customer lifespan in weeks for each customer. It then selects the top 3 customers with the highest average payment per order.

**Explanation of Corrections:**

- **Lifespan Calculation Correction:**
  - Previously, the lifespan calculation was using the condition after dividing by 7, which caused all lifespan values to be 1.0 or less.
  - The corrected calculation checks if the difference in days is less than 7 before dividing by 7. If the difference is less than 7 days, the lifespan is set to 1.0 week.
  - The corrected CASE statement is:
    ```sql
    CASE
        WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
        THEN 1.0
        ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
    END AS "lifespan_weeks"
    ```
  
- **Query Structure:**
  - Joins the **orders** and **order_payments** tables on **order_id** to associate payments with orders.
  - Groups the data by **customer_id** to compute aggregates for each customer.
  - Calculates:
    - **number_of_orders**: Total distinct orders per customer.
    - **average_payment_per_order**: Average payment value per order for each customer.
    - **lifespan_weeks**: Customer lifespan in weeks as per the corrected calculation.
  - Orders the results by **average_payment_per_order** in descending order to find the top 3 customers.
  - Limits the output to the top 3 customers using `LIMIT 3`.

By running this query, you will obtain the required information for the top 3 customers with the highest average payment per order, with the corrected lifespan calculation.
2025-02-10 13:48:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:48:41 - root - INFO - SQL:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3;
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT "customer_id",
       CASE
           WHEN (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders"
GROUP BY "customer_id"
LIMIT 100
Results:
customer_id,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1.0
000161a058600d5901f007fab4c27140,1.0
0001fd6190edaaf884bcaf3d49edf079,1.0
0002414f95344307404f0ace7a26f1d5,1.0
000379cdec625522490c315e70c7a9fb,1.0
0004164d20a9e969af783496f3408652,1.0
000419c5494106c306a97b5635748086,1.0
00046a560d407e99b969756e0b10f282,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1.0
000598caf2ef4117407665ac33275130,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1.0
00062b33cb9f6fe976afdcff967ea74d,1.0
00066ccbe787a588c52bd5ff404590e3,1.0
00072d033fe2e59061ae5c3aff1a2be5,1.0
0009a69b72033b2d0ec8c69fc70ef768,1.0
000bf8121c3412d3057d32371c5d3395,1.0
000e943451fc2788ca6ac98a682f2f49,1.0
000f17e290c26b28549908a04cfe36c1,1.0
000fd45d6fedae68fc6676036610f879,1.0
0010068a73b7c56da5758c3f9e5c7375,1.0
001028b78fd413e19704b3867c369d3a,1.0
00104a47c29da701ce41ee52077587d9,1.0
001051abfcfdbed9f87b4266213a5df1,1.0
00114026c1b7b52ab1773f317ef4880b,1.0
001226b2341ef620415ce7bbafcfac28,1.0
0012a5c13793cf51e253f096a7e740dd,1.0
0013280441d86a4f7a8006efdaf1b0fe,1.0
0013cd8e350a7cc76873441e431dd5ee,1.0
001450ebb4a77efb3d68be5f7887cb1e,1.0
00146ad30454993879adaa91c518f68c,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1.0
0015bc9fd2d5395446143e8b215d7c75,1.0
0015f7887e2fde13ddaa7b8e385af919,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1.0
0018c09f333634ca9c80d9ff46e43e9c,1.0
0018f7fde63ca77254dbc47f4ea358b2,1.0
0019c9aaad15b043c48f0a1180f22ce8,1.0
001a57041f56400917a187dd74e6cbc1,1.0
001b4e9b73aa98a6276b241bfd496822,1.0
001c7f05398c45b42eee0d5a77783bca,1.0
001df1ee5c36767aa607001ab1a13a06,1.0
001f150aebb5d897f2059b0460c38449,1.0
001f35d9f262c558fd065346fbf5801d,1.0
001f6f1a5e902ad14e1f709a7215de11,1.0
00205ad9ba1ef4340cef86583294cf82,1.0
002236c4f333bc8df6a5939749eb7869,1.0
002348c1099e3229276c8ad7d4ddc702,1.0
002408f390f729598bbac1ef9421c6ae,1.0
002450e9ea44cb90b8a07ba0b197e149,1.0
002554bdf9eb99618d8189c3a89fdd52,1.0
0026955706fd4e2fa997f3f4c18d485a,1.0
0026d252429f669d454d726e5e956aa1,1.0
002834b4d901534f48d9e9a72047b288,1.0
0028ff36263a86bf679df7c863a0a0ba,1.0
002905287304e28c0218389269b4759b,1.0
002937abdae13680e17dccd3868b4825,1.0
0029cdf064769cabdf3186b54d068c99,1.0
002a10e899b62a460b0116e0b68697ad,1.0
002b24cb2cd0c3e575040dbd278885e3,1.0
002b5342c72978cf0aba6aae1f5d5293,1.0
002c625393dfa194828b462a6ef8cb0b,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1.0
002d358e2462f87678443706cbf2eb21,1.0
002d597546b2cf44428232c9f237f873,1.0
002ebb669a34b9e79c88efc755e95322,1.0
002ef7e55600d44ead53f7c1644e5222,1.0
002f067b028a3643ad3a0969c7a0f3dc,1.0
002f90a6eb386bc43bc9ba200db31a89,1.0
002fb8fc5ce64f8422fa2fe79986c783,1.0
002ff70a5285669011090c077ef929af,1.0
00302a0b99783c3d1d1e81c616e321e8,1.0
0030aded3a67b29946a128ee8468388e,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1.0
00314f95a054231742e3c5396b333b88,1.0
003177b3eeca50af17750f53802c9a09,1.0
0031abfb953b66e998f67b09e7b11375,1.0
0031c1062edf836ef7a7a7ea758b137b,1.0
00330644cccc5db0276fa836976306fe,1.0
00331de1659c7f4fb660c8810e6de3f5,1.0
0033823ee55671ac5317d423291333c2,1.0
0034f7933de3ead6bd9ba49afe95f119,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1.0
0036875772a8eeb391b8cd7226283fdd,1.0
0037d14e53af1d555a582504a4058f4c,1.0
00380c010de38d578d02117f6d0b88e7,1.0
0039b3e41ac6615814a0b44a8992bff5,1.0
003a75d228dc67cb2918e40c2aacc4bf,1.0
003b595c764773e20e0949b6fba7b1dc,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1.0
003bdf7fd8312f9d14a4b979f3747334,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1.0
003cb2c7ce25d8af8556fb456f903546,1.0
003cbe6a43560a8b6fd2c07531257c2d,1.0
003e45472805afa1ee701d83284fa22b,1.0
003eab528664e1bd677218ef4be086ac,1.0
003ec17a1389fa302f3a0423dddd8650,1.0
003f7d92ac63c512bb6584219806f8df,1.0
0040a8417928d0d5abd5169cd7877181,1.0

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1,114.74,1.0
000161a058600d5901f007fab4c27140,1,67.41,1.0
0001fd6190edaaf884bcaf3d49edf079,1,195.42,1.0
0002414f95344307404f0ace7a26f1d5,1,179.35,1.0
000379cdec625522490c315e70c7a9fb,1,107.01,1.0
0004164d20a9e969af783496f3408652,1,71.8,1.0
000419c5494106c306a97b5635748086,1,49.4,1.0
00046a560d407e99b969756e0b10f282,1,166.59,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1,85.23,1.0
000598caf2ef4117407665ac33275130,1,1255.71,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1,147.33,1.0
00062b33cb9f6fe976afdcff967ea74d,1,58.95,1.0
00066ccbe787a588c52bd5ff404590e3,1,270.0,1.0
00072d033fe2e59061ae5c3aff1a2be5,1,106.97,1.0
0009a69b72033b2d0ec8c69fc70ef768,1,173.6,1.0
000bf8121c3412d3057d32371c5d3395,1,45.56,1.0
000e943451fc2788ca6ac98a682f2f49,1,26.5575,1.0
000f17e290c26b28549908a04cfe36c1,1,139.52,1.0
000fd45d6fedae68fc6676036610f879,1,66.81,1.0
0010068a73b7c56da5758c3f9e5c7375,1,54.83,1.0
001028b78fd413e19704b3867c369d3a,1,37.61,1.0
00104a47c29da701ce41ee52077587d9,1,100.34,1.0
001051abfcfdbed9f87b4266213a5df1,1,21.733333333333334,1.0
00114026c1b7b52ab1773f317ef4880b,1,66.01,1.0
001226b2341ef620415ce7bbafcfac28,1,47.53,1.0
0012a5c13793cf51e253f096a7e740dd,1,369.92,1.0
0013280441d86a4f7a8006efdaf1b0fe,1,162.15,1.0
0013cd8e350a7cc76873441e431dd5ee,1,92.6,1.0
001450ebb4a77efb3d68be5f7887cb1e,1,61.33,1.0
00146ad30454993879adaa91c518f68c,1,221.79,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1,40.75,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1,184.94,1.0
0015bc9fd2d5395446143e8b215d7c75,1,132.19,1.0
0015f7887e2fde13ddaa7b8e385af919,1,186.74,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1,50.01,1.0
0018c09f333634ca9c80d9ff46e43e9c,1,56.87,1.0
0018f7fde63ca77254dbc47f4ea358b2,1,51.27,1.0
0019c9aaad15b043c48f0a1180f22ce8,1,112.83,1.0
001a57041f56400917a187dd74e6cbc1,1,53.72,1.0
001b4e9b73aa98a6276b241bfd496822,1,82.87,1.0
001c7f05398c45b42eee0d5a77783bca,1,21.94,1.0
001df1ee5c36767aa607001ab1a13a06,1,42.86,1.0
001f150aebb5d897f2059b0460c38449,1,125.97,1.0
001f35d9f262c558fd065346fbf5801d,1,46.53,1.0
001f6f1a5e902ad14e1f709a7215de11,1,34.86,1.0
00205ad9ba1ef4340cef86583294cf82,1,928.7,1.0
002236c4f333bc8df6a5939749eb7869,1,69.84,1.0
002348c1099e3229276c8ad7d4ddc702,1,249.56,1.0
002408f390f729598bbac1ef9421c6ae,1,258.01,1.0
002450e9ea44cb90b8a07ba0b197e149,1,40.0,1.0
002554bdf9eb99618d8189c3a89fdd52,1,244.08,1.0
0026955706fd4e2fa997f3f4c18d485a,1,121.9,1.0
0026d252429f669d454d726e5e956aa1,1,139.15,1.0
002834b4d901534f48d9e9a72047b288,1,214.14,1.0
0028ff36263a86bf679df7c863a0a0ba,1,74.94,1.0
002905287304e28c0218389269b4759b,1,31.7,1.0
002937abdae13680e17dccd3868b4825,1,43.55,1.0
0029cdf064769cabdf3186b54d068c99,1,483.7,1.0
002a10e899b62a460b0116e0b68697ad,1,92.81,1.0
002b24cb2cd0c3e575040dbd278885e3,1,40.22,1.0
002b5342c72978cf0aba6aae1f5d5293,1,51.17,1.0
002c625393dfa194828b462a6ef8cb0b,1,371.87,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1,185.6,1.0
002d358e2462f87678443706cbf2eb21,1,45.61,1.0
002d597546b2cf44428232c9f237f873,1,117.74,1.0
002ebb669a34b9e79c88efc755e95322,1,133.57,1.0
002ef7e55600d44ead53f7c1644e5222,1,199.02,1.0
002f067b028a3643ad3a0969c7a0f3dc,1,107.84,1.0
002f90a6eb386bc43bc9ba200db31a89,1,153.51,1.0
002fb8fc5ce64f8422fa2fe79986c783,1,67.68,1.0
002ff70a5285669011090c077ef929af,1,81.14,1.0
00302a0b99783c3d1d1e81c616e321e8,1,159.48,1.0
0030aded3a67b29946a128ee8468388e,1,58.59,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1,26.85,1.0
00314f95a054231742e3c5396b333b88,1,59.34,1.0
003177b3eeca50af17750f53802c9a09,1,133.81,1.0
0031abfb953b66e998f67b09e7b11375,1,671.85,1.0
0031c1062edf836ef7a7a7ea758b137b,1,81.0,1.0
00330644cccc5db0276fa836976306fe,1,55.1,1.0
00331de1659c7f4fb660c8810e6de3f5,1,243.69,1.0
0033823ee55671ac5317d423291333c2,1,79.48,1.0
0034f7933de3ead6bd9ba49afe95f119,1,84.24,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1,53.33,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1,78.2,1.0
0036875772a8eeb391b8cd7226283fdd,1,61.85,1.0
0037d14e53af1d555a582504a4058f4c,1,603.4,1.0
00380c010de38d578d02117f6d0b88e7,1,64.1,1.0
0039b3e41ac6615814a0b44a8992bff5,1,34.59,1.0
003a75d228dc67cb2918e40c2aacc4bf,1,79.28,1.0
003b595c764773e20e0949b6fba7b1dc,1,25.46,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1,600.04,1.0
003bdf7fd8312f9d14a4b979f3747334,1,43.68,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1,128.25,1.0
003cb2c7ce25d8af8556fb456f903546,1,420.94,1.0
003cbe6a43560a8b6fd2c07531257c2d,1,27.75,1.0
003e45472805afa1ee701d83284fa22b,1,30.6,1.0
003eab528664e1bd677218ef4be086ac,1,77.1,1.0
003ec17a1389fa302f3a0423dddd8650,1,17.77,1.0
003f7d92ac63c512bb6584219806f8df,1,84.91,1.0
0040a8417928d0d5abd5169cd7877181,1,219.49,1.0

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT DISTINCT "payment_type"
FROM "order_payments"
LIMIT 100
Results:
payment_type
credit_card
boleto
voucher
debit_card
not_defined

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT "customer_id", "customer_unique_id", "customer_city"
FROM "customers"
LIMIT 100
Results:
Too long, hard cut:
customer_id,customer_unique_id,customer_city
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia
03f846ad03437d864a8d2a22976dcafe,7677c213007e9a6ec9267ea50b5ce5bc,sao paulo
de4e13fd7d6469c5ada77d0843c55e42,0c17f9ac28cbd7323f0f4043e9db5907,pelotas
8276de07ef25225d412b8462d73f8664,332cf4e83e16004ba7dca932ce

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT "order_id", COUNT(*) AS "number_of_payments"
FROM "order_payments"
GROUP BY "order_id"
LIMIT 100
Results:
order_id,number_of_payments
00010242fe8c5a6d1ba2dd792cb16214,1
00018f77f2f0320c557190d7a144bdd3,1
000229ec398224ef6ca0657da4fc703e,1
00024acbcdf0a6daa1e931b038114c75,1
00042b26cf59d7ce69dfabb4e55b4fd9,1
00048cc3ae777c65dbb7d2a0634bc1ea,1
00054e8431b9d7675808bcb819fb4a32,1
000576fe39319847cbb9d288c5617fa6,1
0005a1a1728c9d785b8e2b08b904576c,1
0005f50442cb953dcd1d21e1fb923495,1
00061f2a7bc09da83e415a52dc8a4af1,1
00063b381e2406b52ad429470734ebd5,1
0006ec9db01a64e59a68b2c340bf65a7,1
0008288aa423d2a3f00fcb17cd7d8719,1
0009792311464db532ff765bf7b182ae,1
0009c9a17f916a706d71784483a5d643,1
000aed2e25dbad2f9ddb70584c5a2ded,1
000c3e6612759851cc3cbb4b83257986,1
000e562887b1f2006d75e0be9558292e,1
000e63d38ae8c00bbcb5a30573b99628,1
000e906b789b55f64edcb1f84030f90d,1
000f25f4d72195062c040b12dce9a18a,1
001021efaa8636c29475e7734483457d,1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,1
0010dedd556712d7bb69a19cb7bbd37a,1
00119ff934e539cf26f92b9ef0cdfed8,1
0011d82c4b53e22e84023405fb467e57,1
00125cb692d04887809806618a2a145f,1
00130c0eee84a3d909e75bc08c5c3ca1,1
0013503b13da1eac686219390b7d641b,1
00137e170939bba5a3134e2386413108,1
001427c0ec99cf8af737bd88e92fd444,1
00143d0f86d6fbd9f9b38ab440ac16f5,1
0014ae671de39511f7575066200733b7,1
0015ebb40fb17286bea51d4607c4733c,1
00169e31ef4b29deaae414f9a5e95929,1
0016dfedd97fc2950e388d2971d718c7,2
0017afd5076e074a48f1f1a4c7bac9c5,1
001862358bf858722e1e2ae000cfed8b,1
0019c29108428acffd089c36103c9440,1
001ab0a7578dd66cd4b0a71f5b6e1e41,1
001ac194d4a326a6fa99b581e9a3d963,1
001b76dd48a5b1eee3e87778daa40df8,1
001c85b5f68d2be0cb0797afc9e8ce9a,1
001d8f0e34a38c37f7dba2a37d4eba8b,1
001daeb0eddc45b999bad0801ad9d273,1
001dbc16dc51075e987543d23a0507c7,1
001e7ba991be1b19605ca0316e7130f9,1
001e7cf2ad6bef3ade12ebc56ceaf0f3,1
0020262c8a370bd5a174ea6a2a267321,1
0020a222f55eb79a372d0efee3cca688,1
002175704e8b209f61b9ad5cfd92b60e,1
00229e4e43f7a7e0b9dd819ad43268d3,1
0025081dcf9330f9a5052ae82c6ce396,1
00254baeb6c932b0a8aeead91fbd02b5,1
00259a44fcad3fc0474329e925d14fc3,1
0025c5d1a8ca53a240ec2634bb4492ea,1
002611a77fe03d076285fd4ca95db77c,1
002691433f09002ac9ca0c4e8dbb8ead,1
0026a368634b6e6f34f33b1499773a30,1
00275bce676303c3bfd7292aefdfa223,1
00276d5c3491fbf55305e26891040df9,1
002834535f7a609a5c68266f173fa59e,1
0028de0ca693a1bb26448916a81105cc,1
002955b0acc63d04f6724a31967e82bd,1
0029c5db35ef291ce99d1262012e7daa,1
0029f17cf0e7640c5cb6825af681303f,1
002af7fa9eb99d1456bceb6a13d6fc0b,1
002b430ff89b3a24c31a1170acbbedea,1
002b4e6fa42cd4a22cc86abc18fe9c05,1
002c9def9c9b951b1bec6d50753c9891,1
002d040018d12a3853c059f7f23ab5b1,1
002f16b7bc4530031b7d90f791b12d8a,1
002f19a65a2ddd70a090297872e6d64e,2
002f98c0f7efd42638ed6100ca699b42,1
0030d783f979fbc5981e75613b057344,1
0030ff924c38549807645976adeef2c0,1
00310b0c75bb13015ec4d82d341865a4,1
00324b3eda39ba5ecce3945823e3594c,1
0032d07457ae9c806c79368d7d9ce96b,1
003324c70b19a16798817b2b3640e721,1
00335b686d693c7d72deeb12f8e89227,1
00335f75ea6a4455b524a8dd177067f5,1
00337fe25a3780b3424d9ad7c5a4b35e,1
003423b755b562962a6225a8de40d12e,1
00345f338696283410b7977d2e3efc89,1
0035246a40f520710769010f752e7507,1
0035c0b07126fe9c24a325216fb96064,1
0035e6b7ade84b3f5b86bd49814793df,1
0036757472ece3dde52fd4bfd929c90e,1
0036887767dea4bd43b1a88cd0d9477a,1
00378c6c981f234634c0b9d6128df6dd,1
003822434f91204da0a51fe4cf2aba18,1
0039500db36d50d7d0bfaf23723550f3,1
003a7f59d7e08a9c61d9e2881fe6459c,1
003a94f778ef8cfd50247c8c1b582257,1
003cc6161d7a2593f2525cce0c330d32,1
003d0634280ff3d1d3a54459349a6899,1
003d804eef0e1b856881cd18e0cc0d4c,1
003d9fc84ad902adf2265248b5ffe1a4,1

2025-02-10 13:48:42 - root - INFO - SQL:
SELECT "order_id", "payment_installments", "payment_value"
FROM "order_payments"
WHERE "payment_installments" > 1
LIMIT 100
Results:
order_id,payment_installments,payment_value
b81ef226f3fe1789b1e8b2acac839d17,8,99.33
ba78997921bbcdc1373bb41e913ab953,8,107.78
42fdf880ba16b47b59251dd489d4441a,2,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,2,96.12
3d7239c394a212faae122962df514ac7,3,51.84
1f78449c87a54faf9e96e88ba1491fa9,6,341.09
d88e0d5fa41661ce03cf6cf336527646,8,188.73
cf95215a722f3ebf29e6bbab87a29e61,5,102.66
769214176682788a92801d8907fa1b40,4,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,10,157.45
8ac09207f415d55acff302df7d6a895c,4,244.15
b2349a3f20dfbeef62e7b31baa22f84b,3,136.71
5a1f6d22f7dfb061ef29216b9af687a1,4,47.69
4214cda550ece8ee66441f459dc33a8c,2,170.57
adfbf6c2a620196f9a3ec747491c72b7,4,67.5
4d680edbaa7d3d9bed69532957368a03,10,353.09
d0a945f85ba1074b60aac97ade7e240e,2,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,2,139.22
5d9c5817e278892b7498d90bfa28ade8,2,290.16
1dcf0c8cd36ffaf57784fbdc90079310,3,157.15
cf30fe76d1505192acee1c6dccb15545,2,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,8,117.74
afef48d3c8a0b1b7c9b7f8f922fb5674,5,153.41
c0db7d31ace61fc360a3eaa34dd3457c,5,65.71
d574338f566ca28dd67820f48ec1f1d8,4,278.22
1807cc736321f14baa58ef39cf6e5989,4,91.66
2e2c60b99754ae1e4d8b18846cfec9f2,4,542.66
10af96a0689260134307879127ac1952,2,113.2
85eef2d342b0de363c45c1bc324729c5,3,99.43
aa964845f1de8125410aea8b73e9e1ec,2,27.35
343348b1e29e9fa9e7b6ab1027f9177d,4,43.77
ad4098a257676ea4d394fb3bbbf36ca3,2,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,2,105.53
3ab4eea6776259ae8dfbabaeffece352,8,387.8
c108072ab31ec90a754129c171577f5f,4,210.82
795c16acb4e3c30dfa5b6827727ef488,2,37.58
60e43c5f5ba559d9dd19357ed72cb2f2,2,78.3
110d9355d6338eab0a65a0cacdde5434,5,566.4
42f5954cda381bd032934ee38c453711,8,402.42
97c111c4f22dfa1089a9c0b5338dcc79,3,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,3,187.51
e1b4ee0e390fbac1dec439d72b45a115,3,77.7
4c2e1a95586c815795a324d1599e7b5a,8,117.71
c9f23db8a1cb725df9bdb3383bd72b38,3,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,3,34.78
198298d54f269d8c5fe89e85a859af61,10,342.56
b19ca559688b49e8cf7f88c1aa3f0009,7,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,4,117.85
de4090fd9b7900d46323b0c7c36b7128,2,121.45
20f136d890c31a62486c809f91a5b098,10,117.68
d60a89ab9bc1e68834465ae630c3343e,2,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,6,60.07
f9d5bfb53147f381e81b89a848e26b16,3,195.71
85a4fbdba48c815924115fb82330071c,3,34.09
46ee6eaca194413758f200a6974b7e4d,3,71.99
9acd1ccfbc6445c0cad9ee9ddb48054c,3,81.78
83f24bbc4f76a2730ba9c9cfa32e6d07,3,231.45
0b65284a1a74114ea029b7676fdc1ba3,7,144.2
243312dbb316253ab77bb0140d94803c,10,285.79
8973a53fcad22a79e0ff315e7f9a0fd9,2,176.7
f090de1b2ed9f4e251662cb31e3c7127,2,27.63
2ccde1e4676c20b9444e2bcbed36334c,8,134.56
0f4b5614da144989e2acc5291af24357,4,96.98
1d92d2ce1ae2e0510b5ce50c5be578c6,2,110.03
c51dcdd98e1c413f3d394ffcb4656ed1,4,110.11
8f936fb77c720ab9ccd618af38c885cc,4,46.63
cdaa116d3c2521b4b6976043508d0943,2,61.77
9184724aacd6a7da5bcf4c08c2c674a8,3,57.53
8bdc559b124e47eb71b5d1be8d6675e4,7,76.02
859980aae511377b7230f72d90bfc580,10,106.77
0c99132c4ff916416ba8f74c378f1cbc,4,135.93
db43c1a570e28fe9da60a444e3616a2b,7,186.72
f75666bf6c9e09f6b3f4bcd797b57a3c,4,97.28
4f99d1a7b0d2308edf45baa6997ac961,6,125.53
ca8f94a99a8120c559e416275a535066,5,92.76
9bdcb4559b75d21a22fcd868d9e5dfec,8,348.02
96cc8c42014ddb42a775da9a45ae3f76,2,203.3
87f003dca70d4d22518366caf041e845,3,44.35
f244841f5a461472de8de82f023b1371,10,116.05
242e24b7eaa9f48cde9d679f8591124d,4,236.66
18259631aab7299bf25f83f5eac4c8d1,4,220.3
845af9472cc76e66fbf445931b511755,5,123.41
953b6636ab2347a8ba37a16770db47f9,10,379.07
886b114d034f4ac1d39d964c1b2a8182,10,2027.16
0a9716da94d89975e6637874280aadad,10,165.96
62d9b911d7c56cf455f660eecb8ddd3a,10,1002.73
e6ed38386107802a72ec8197195f79a7,2,240.52
4a4ed9ed7922304a569ed850baba99c6,3,33.13
1594012ccc1b0770373ce691d697e5ae,8,362.17
2fe14af1d4563c0e76f382bc63c9a245,2,88.72
bc3d816db1aa7215dbde5b1b00d3d32b,2,46.85
b545ba7b0bd67a3128185c7214704319,8,340.08
9e59025992bd64bc26551391ed44a450,3,67.01
7327c30a5230ce07bc2c7a695d553a00,4,40.27
3b9e43d6eba694f8a29c11ee67a04f2c,8,242.1
57e4fc8f20507381b3f7abbe4e2ccda3,2,215.56
e1b6234c322ab01a32771bf57c597043,8,156.09
03afb3c10af52ddfa3c33b9881bf43f8,2,131.5
66f249e4d7ab2f3872de7bd6d74719dd,8,348.77
648b4f683ccf074ebe65a73c8096dd18,4,139.87

2025-02-10 13:48:42 - root - INFO - itercount: 0
2025-02-10 13:48:42 - root - INFO - Table: product_category_name_translationDDL:
CREATE TABLE "product_category_name_translation" (
"product_category_name" TEXT,
  "product_category_name_english" TEXT
)
Table: sellersDDL:
CREATE TABLE "sellers" (
"seller_id" TEXT,
  "seller_zip_code_prefix" INTEGER,
  "seller_city" TEXT,
  "seller_state" TEXT
)
Table: customersDDL:
CREATE TABLE "customers" (
"customer_id" TEXT,
  "customer_unique_id" TEXT,
  "customer_zip_code_prefix" INTEGER,
  "customer_city" TEXT,
  "customer_state" TEXT
)
Table: geolocationDDL:
CREATE TABLE "geolocation" (
"geolocation_zip_code_prefix" INTEGER,
  "geolocation_lat" REAL,
  "geolocation_lng" REAL,
  "geolocation_city" TEXT,
  "geolocation_state" TEXT
)
Table: order_itemsDDL:
CREATE TABLE "order_items" (
"order_id" TEXT,
  "order_item_id" INTEGER,
  "product_id" TEXT,
  "seller_id" TEXT,
  "shipping_limit_date" TEXT,
  "price" REAL,
  "freight_value" REAL
)
Table: order_paymentsDDL:
CREATE TABLE "order_payments" (
"order_id" TEXT,
  "payment_sequential" INTEGER,
  "payment_type" TEXT,
  "payment_installments" INTEGER,
  "payment_value" REAL
)
Table: order_reviewsDDL:
CREATE TABLE "order_reviews" (
"review_id" TEXT,
  "order_id" TEXT,
  "review_score" INTEGER,
  "review_comment_title" TEXT,
  "review_comment_message" TEXT,
  "review_creation_date" TEXT,
  "review_answer_timestamp" TEXT
)
Table: ordersDDL:
CREATE TABLE "orders" (
"order_id" TEXT,
  "customer_id" TEXT,
  "order_status" TEXT,
  "order_purchase_timestamp" TEXT,
  "order_approved_at" TEXT,
  "order_delivered_carrier_date" TEXT,
  "order_delivered_customer_date" TEXT,
  "order_estimated_delivery_date" TEXT
)
Table: productsDDL:
CREATE TABLE "products" (
"product_id" TEXT,
  "product_category_name" TEXT,
  "product_name_lenght" REAL,
  "product_description_lenght" REAL,
  "product_photos_qty" REAL,
  "product_weight_g" REAL,
  "product_length_cm" REAL,
  "product_height_cm" REAL,
  "product_width_cm" REAL
)
Table: leads_qualifiedDDL:
CREATE TABLE "leads_qualified" (
"mql_id" TEXT,
  "first_contact_date" TEXT,
  "landing_page_id" TEXT,
  "origin" TEXT
)
Table: leads_closedDDL:
CREATE TABLE "leads_closed" (
"mql_id" TEXT,
  "seller_id" TEXT,
  "sdr_id" TEXT,
  "sr_id" TEXT,
  "won_date" TEXT,
  "business_segment" TEXT,
  "lead_type" TEXT,
  "lead_behaviour_profile" TEXT,
  "has_company" INTEGER,
  "has_gtin" INTEGER,
  "average_stock" TEXT,
  "business_type" TEXT,
  "declared_product_catalog_size" REAL,
  "declared_monthly_revenue" REAL
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['product_category_name_translation', 'sellers', 'customers', 'geolocation', 'order_items', 'order_payments', 'order_reviews', 'orders', 'products', 'leads_qualified', 'leads_closed']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **customers**

   - **customer_id**: Unique identifier for each customer; used to link with the orders table.
   - *Potential Usage*: Identify customers and link them to their orders.

2. **orders**

   - **order_id**: Unique identifier for each order.
   - **customer_id**: Foreign key linking to the customers table.
   - **order_purchase_timestamp**: Timestamp of when the order was purchased.
   - *Potential Usage*: Determine the number of orders per customer and the purchase dates for lifespan calculation.

3. **order_payments**

   - **order_id**: Foreign key linking to the orders table.
   - **payment_value**: Payment amount for the order.
   - *Potential Usage*: Calculate the total and average payment per order for each customer.

**Conditions that may be used:**

- Joining **orders** and **order_payments** on **order_id** to associate payments with orders.
- Grouping data by **customer_id** to compute aggregates per customer.
- Calculating lifespan by finding the earliest and latest **order_purchase_timestamp** per customer.
- Selecting the top 3 customers with the highest average payment per order.

---

**SQLite SQL Queries:**

1. **Retrieve distinct customer IDs from the orders table:**

   ```sql
   SELECT DISTINCT "customer_id"
   FROM "orders"
   LIMIT 100;
   ```

2. **Preview the first 100 entries from the customers table:**

   ```sql
   SELECT *
   FROM "customers"
   LIMIT 100;
   ```

3. **List all orders with their purchase timestamps:**

   ```sql
   SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM "orders"
   LIMIT 100;
   ```

4. **Get payment details for orders:**

   ```sql
   SELECT "order_id", "payment_sequential", "payment_type", "payment_value"
   FROM "order_payments"
   LIMIT 100;
   ```

5. **Find total payment amount per order:**

   ```sql
   SELECT "order_id", SUM("payment_value") AS "total_payment"
   FROM "order_payments"
   GROUP BY "order_id"
   LIMIT 100;
   ```

6. **Join orders with payments to view payment per order:**

   ```sql
   SELECT o."order_id", o."customer_id", p."payment_value"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   LIMIT 100;
   ```

7. **Calculate the total number of orders per customer:**

   ```sql
   SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
   ```

8. **Compute the total payment per customer:**

   ```sql
   SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

9. **Calculate the average payment per order for each customer:**

   ```sql
   SELECT o."customer_id", AVG(p."payment_value") AS "average_payment_per_order"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

10. **Find the first and last purchase dates for each customer:**

    ```sql
    SELECT "customer_id", 
           MIN("order_purchase_timestamp") AS "first_purchase", 
           MAX("order_purchase_timestamp") AS "last_purchase"
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
    ```

11. **Calculate the lifespan in weeks for each customer:**

    ```sql
    SELECT "customer_id",
           (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0 AS "lifespan_weeks"
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
    ```

12. **Ensure lifespan is at least 1.0 week for each customer:**

    ```sql
    SELECT "customer_id",
           CASE
               WHEN ((JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0) < 1.0
               THEN 1.0
               ELSE ((JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0)
           END AS "lifespan_weeks"
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
    ```

13. **Combine orders and payments to get number of orders, average payment, and lifespan per customer:**

    ```sql
    SELECT o."customer_id",
           COUNT(DISTINCT o."order_id") AS "number_of_orders",
           AVG(p."payment_value") AS "average_payment_per_order",
           CASE
               WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0
               THEN 1.0
               ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
           END AS "lifespan_weeks"
    FROM "orders" AS o
    JOIN "order_payments" AS p ON o."order_id" = p."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

14. **Select the top 3 customers with the highest average payment per order:**

    ```sql
    SELECT o."customer_id",
           COUNT(DISTINCT o."order_id") AS "number_of_orders",
           AVG(p."payment_value") AS "average_payment_per_order",
           CASE
               WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0
               THEN 1.0
               ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
           END AS "lifespan_weeks"
    FROM "orders" AS o
    JOIN "order_payments" AS p ON o."order_id" = p."order_id"
    GROUP BY o."customer_id"
    ORDER BY "average_payment_per_order" DESC
    LIMIT 3;
    ```

15. **Check the payment types used by customers:**

    ```sql
    SELECT DISTINCT "payment_type"
    FROM "order_payments"
    LIMIT 100;
    ```

16. **List customers with their unique IDs and cities:**

    ```sql
    SELECT "customer_id", "customer_unique_id", "customer_city"
    FROM "customers"
    LIMIT 100;
    ```

17. **Determine the number of payments per order:**

    ```sql
    SELECT "order_id", COUNT(*) AS "number_of_payments"
    FROM "order_payments"
    GROUP BY "order_id"
    LIMIT 100;
    ```

18. **Find orders with multiple payment installments:**

    ```sql
    SELECT "order_id", "payment_installments", "payment_value"
    FROM "order_payments"
    WHERE "payment_installments" > 1
    LIMIT 100;
    ```

These queries help in understanding the data and preparing to compute the number of orders, average payment per order, and customer lifespan in weeks for the top 3 customers with the highest average payment per order.Query:
SELECT DISTINCT "customer_id"
   FROM "orders"
   LIMIT 100;
Answer:
customer_id
9ef432eb6251297304e76186b10a928d
b0830fb4747a6c6d20dea0b8c802d7ef
41ce2a54c0b03bf3443c3d931a367089
f88197465ea7920adcdbec7375364d82
8ab97904e6daea8866dbdbc4fb7aad2c
503740e9ca751ccdda7ba28e9ab8f608
ed0271e0b7da060a393796590e7b737a
9bdf08b4b3b52b5526ff42d37d47f222
f54a9f0e6b351c431402b8461ea51999
31ad1d1b63eb9962463f764d4e6e0c9d
494dded5b201313c64ed7f100595b95c
7711cf624183d843aafe81855097bc37
d3e3b74c766bc6214e0c830b17ee2341
19402a48fe860416adf93348aba37740
3df704f53d3f1d4818840b34ec672a9f
3b6828a50ffe546942b7a473d70ac0fc
738b086814c6fcc74b8cc583f8516ee3
3187789bec990987628d7a9beb4dd6ac
059f7fc5719c7da6cbafe370971a8d70
7f8c8b9c2ae27bf3300f670c3d478be8
d2b091571da224a1b36412c18bc3bbfe
4fa1cd166fa598be6de80fa84eaade43
72ae281627a6102d9b3718528b420f8a
a166da34890074091a942054b36e4265
62b423aab58096ca514ba6aa06be2f98
3a874b4d4c4b6543206ff5d89287f0c3
7e20bf5ca92da68200643bda76c504c6
8b212b9525f9e74e85e37ed6df37693e
cce89a605105b148387c52e286ac8335
761df82feda9778854c6dafdaeb567e4
456dc10730fbdba34615447ea195d643
52142aa69d8d0e1247ab0cada0f76023
816f8653d5361cbf94e58c33f2502a5c
d9ef95f98d8da3b492bb8c0447910498
cf8ffeddf027932e51e4eae73b384059
5f16605299d698660e0606f7eae2d2f9
f5458ddc3545711efa883dd7ae7c4497
295ae9b35379e077273387ff64354b6f
2a1dfb647f32f4390e7b857c67458536
3391c4bc11a817e7973e498b0b023158
ddaff536587109b89777e0353215e150
c7340080e394356141681bd4c9b8fe31
8644be24d48806bc3a88fd59fb47ceb1
756fb9391752dad934e0fe3733378e57
caded193e8e47b8362864762a83db3c5
4f28355e5c17a4a42d3ce2439a1d4501
569cf68214806a39acc0f39344aea67f
12fd2740039676063a874b9567dfa651
2b56e94c2f66f2d97cfa63356f69cee8
7f2178c5d771e17f507d3c1637339298
9b18f3fc296990b97854e351334a32f6
148348ff65384b4249b762579532e248
79183cd650e2bb0d475b0067d45946ac
f5afca14dfa9dc64251cf2b45c54c363
f178c1827f67a8467b0385b7378d951a
67407057a7d5ee17d1cd09523f484d13
2932d241d1f31e6df6c701d52370ae02
684fa6da5134b9e4dab731e00011712d
911e4c37f5cafe1604fe6767034bf1ae
241e78de29b3090cfa1b5d73a8130c72
4632eb5a8f175f6fe020520ae0c678f3
dd5095632e3953fc0947b8ab5176b0be
9916715c2ab6ee1710c9c32f0a534ad2
c77ee2d8ba1614a4d489a44166894938
81e08b08e5ed4472008030d70327c71f
5dda11942d4f77bee3a46d71e442aec4
74805bc388861fa350ed2fade8444e0b
4afc1dcca5fe8926fc97d60a4497f8ab
be8c14c16a4d47194ccdfe10f1fc5b1a
a9d37ddc8ba4d9f6dbac7d8ec378cc95
bb2f5e670f7155dc622c57e4b31d0a69
55e6b290205c84ddd23ddf5eb134efd4
f5618502bee8eafdee72fb6955e2ebdf
a90391a47de936d56c66a5366cba1462
388025bec8128ff20ec1a316ed4dcf02
afb19a4b667cb708caab312757ec3d3f
636e15840ab051faa13d3f781b6e4233
05e996469a2bf9559c7122b87e156724
5bb39c890c91b1d26801aa19a9336eac
f26a435864aebedff7f7c84f82ee229f
29cb486c739f9774c8eb542e07b56cd2
bf141bf67fbe428d558bcf0e018eab60
b673f0597cb0c4d12778f731045f361a
6772a0a230a2667d16c3620f000e1348
9f6618c17568ac301465fe7ad056c674
fee181bf648906d1c57f84f216976286
df9b032b2ad0fd6bf37dfb48e5f83845
93ada7a24817edda9f4ab998fa823d16
64fb950e760ec8b0db79154a1fa9c1bf
48558a50a7ba1aab61891936d2ca7681
3a897024068ed42a183de61d5727d866
8628fac2267e8c8804525da99c10ed0e
332df68ccac2f2f7d9e11299188f8bce
e28dd4261bed9c7ba89ecaf411b88f7c
82f0b75bb50fcb30711e5277e36b3983
3135962ee745ef39b85576df7ddbaa99
1833a0540067becaf59368fe4cd4303a
68451b39b1314302c08c65a29f1140fc
0bf19317b1830a69e55b40710576aa7a
c622b892a190735ef81c0087973fa16d
Query:
SELECT *
   FROM "customers"
   LIMIT 100;
Answer:
Too long, hard cut:
customer_id,customer_unique_id,customer_zip_code_prefix,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,14409,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,9790,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,1151,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,8775,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,13056,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,89254,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,4534,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,35182,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,81560,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,30575,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,39400,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,20231,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,18682,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,5704,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,95110,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,13412,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,22750,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,7124,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,5416,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,68485,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,88034,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,74914,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,5713,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,82820,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,8225,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,9121,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,74310,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,4571,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,29311,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,5528,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,12235,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,18130,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,42800,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,27525,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,81750,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,13175,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,7170,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,93415,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,65075,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,88104,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,7176,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,35960,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,5727,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,7053,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,14026,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,30320,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,38300,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,18740,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,83085,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,89254,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,5351,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,39406,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,14860,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,21310,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,23970,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,79804,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3a
Query:
SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM "orders"
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab
Query:
SELECT "order_id", "payment_sequential", "payment_type", "payment_value"
   FROM "order_payments"
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,payment_sequential,payment_type,payment_value
b81ef226f3fe1789b1e8b2acac839d17,1,credit_card,99.33
a9810da82917af2d9aefd1278f1dcfa0,1,credit_card,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,1,credit_card,65.71
ba78997921bbcdc1373bb41e913ab953,1,credit_card,107.78
42fdf880ba16b47b59251dd489d4441a,1,credit_card,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,1,credit_card,96.12
771ee386b001f06208a7419e4fc1bbd7,1,credit_card,81.16
3d7239c394a212faae122962df514ac7,1,credit_card,51.84
1f78449c87a54faf9e96e88ba1491fa9,1,credit_card,341.09
0573b5e23cbd798006520e1d5b4c6714,1,boleto,51.95
d88e0d5fa41661ce03cf6cf336527646,1,credit_card,188.73
2480f727e869fdeb397244a21b721b67,1,credit_card,141.9
616105c9352a9668c38303ad44e056cd,1,credit_card,75.78
cf95215a722f3ebf29e6bbab87a29e61,1,credit_card,102.66
769214176682788a92801d8907fa1b40,1,credit_card,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,1,credit_card,157.45
61059985a6fc0ad64e95d9944caacdad,1,credit_card,132.04
79da3f5fe31ad1e454f06f95dc032ad5,1,credit_card,98.94
8ac09207f415d55acff302df7d6a895c,1,credit_card,244.15
b2349a3f20dfbeef62e7b31baa22f84b,1,credit_card,136.71
5a1f6d22f7dfb061ef29216b9af687a1,1,credit_card,47.69
4214cda550ece8ee66441f459dc33a8c,1,credit_card,170.57
adfbf6c2a620196f9a3ec747491c72b7,1,credit_card,67.5
4d680edbaa7d3d9bed69532957368a03,1,credit_card,353.09
8cd68144cdb62dc0d60848cf8616d2a4,1,boleto,330.66
5cfd514482e22bc992e7693f0e3e8df7,2,voucher,45.17
d0a945f85ba1074b60aac97ade7e240e,1,credit_card,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,1,credit_card,139.22
5d9c5817e278892b7498d90bfa28ade8,1,credit_card,290.16
b69b9260e79a0da00e15f48de1bd2524,1,boleto,283.34
f45074ae38f2e01d9b854ec8d40362ff,1,credit_card,13.78
81cedc4d2132eb6f512354166e51b187,1,credit_card,30.28
595f598849d89203c28d05d0fbf3f92e,1,credit_card,26.58
f9d0ec2fa088ac583e1ccd15b6686073,1,credit_card,89.68
e647bf617de735448a4ba54f8910393c,1,credit_card,65.09
b2bb080b6bc860118a246fd9b6fad6da,1,credit_card,173.84
23f10f509600c30cf2852f9dbdf28fc3,1,credit_card,103.49
f86f6472fa9f395d8d9a6751ca118afb,1,credit_card,64.03
1dcf0c8cd36ffaf57784fbdc90079310,1,credit_card,157.15
00d8d65b666158b633f96054d31af43b,1,boleto,130.88
cf30fe76d1505192acee1c6dccb15545,1,credit_card,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,1,credit_card,117.74
32b1d8f3789a57f1f752e20ac7404b4c,1,boleto,56.6
c10d412026c4077b8e83acf0fea04eee,1,credit_card,266.16
56c3277583e16009c925fdf116df420f,1,boleto,31.38
0e0441786430b7cfcd0d91f822ea4c99,1,credit_card,121.49
6ffb3f1686bceae3466facf7e02ce3fb,1,credit_card,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,1,credit_card,153.41
c0db7d31ace61fc360a3eaa34dd3457c,1,credit_card,65.71
d574338f566ca28dd67820f48ec1f1d8,1,credit_card,278.22
1807cc736321f14baa58ef39cf6e5989,1,credit_card,91.66
e8977f709bbb0367f51b589e6325f991,1,credit_card,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,1,credit_card,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,1,boleto,166.04
95442deb81a5d91c97c0df96b431634a,1,boleto,368.98
10af96a0689260134307879127ac1952,1,credit_card,113.2
85eef2d342b0de363c45c1bc324729c5,1,credit_card,99.43
aa964845f1de8125410aea8b73e9e1ec,1,credit_card,27.35
343348b1e29e9fa9e7b6ab1027f9177d,1,credit_card,43.77
ad4098a257676ea4d394fb3bbbf36ca3,1,credit_card,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,1,credit_card,105.53
3ab4eea6776259ae8dfbabaeffece352,1,credit_card,387.8
10d9871bed9fb8d0887d3b9022edd1ff,1,boleto,84.14
c108072ab31ec90a754129c171577f5f,1,credit_card,210.82
fc662bafa52d2ef16078f6f6141009d6,1,boleto,90.05
4217849b1ff18a9270fe048eabc4dc45,1,credit_card,67.88
795c16acb4e3c30dfa5b6827727ef488,1,credit_card,37.58
55e2d723733c45033e71cb4d44690234,1,boleto,89.63
947e9c6bfd83a06953c420ef92d3da6e,1,voucher,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,1,credit_card,78.3
e3e9e3295f4e1512167c232a0aaae8a5,1,voucher,50.8
460d57443ffdcaeba240360239747cf7,1,credit_card,34.0
4cb51127f19f7254b320efe1718477dd,1,boleto,77.1
110d9355d6338eab0a65a0cacdde5434,1,credit_card,566.4
42f5954cda381bd032934ee38c453711,1,credit_card,402.42
3689194c14ad4e2e7361ebd1df0e77b0,2,voucher,57.53
97c111c4f22dfa1089a9c0b5338dcc79,1,credit_card,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,1,credit_card,187.51
e1b4ee0e390fbac1dec439d72b45a115,1,credit_card,77.7
fee72a68ce935ebf2939fe72f27d3d9b,1,credit_card,48.68
4d3bfdf4c7d6578ea445d588371ae10e,1,credit_card,77.29
4c2e1a95586c815795a324d1599e7b5a,1,credit_card,117.71
c9f23db8a1cb725df9bdb3383bd72b38,1,credit_card,169.34
8e47a04b25d7a7075064e8e0bd2e0318,1,credit_card,37.61
723e462ce1ee50e024887c0b403130f3,1,credit_card,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,1,debit_card,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,1,credit_card,34.78
198298d54f269d8c5fe89e85a859af61,1,credit_card,342.56
b19ca559688b49e8cf7f88c1aa3f0009,1,credit_card,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,1,credit_card,117.85
4a02e985c7239d866a632f07ed20d9c0,1,credit_card,48.62
3e17eef8a8bd0131c7aed90d7508799e,1,credit_card,53.99
f8d323a2702fed37f0229965f7e9f8b3,1,credit_card,51.14
de4090fd9b7900d46323b0c7c36b7128,1,credit_card,121.45
17e5131fe1
Query:
SELECT "order_id", SUM("payment_value") AS "total_payment"
   FROM "order_payments"
   GROUP BY "order_id"
   LIMIT 100;
Answer:
order_id,total_payment
00010242fe8c5a6d1ba2dd792cb16214,72.19
00018f77f2f0320c557190d7a144bdd3,259.83
000229ec398224ef6ca0657da4fc703e,216.87
00024acbcdf0a6daa1e931b038114c75,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,34.59
00054e8431b9d7675808bcb819fb4a32,31.75
000576fe39319847cbb9d288c5617fa6,880.75
0005a1a1728c9d785b8e2b08b904576c,157.6
0005f50442cb953dcd1d21e1fb923495,65.39
00061f2a7bc09da83e415a52dc8a4af1,68.87
00063b381e2406b52ad429470734ebd5,57.98
0006ec9db01a64e59a68b2c340bf65a7,97.32
0008288aa423d2a3f00fcb17cd7d8719,126.54
0009792311464db532ff765bf7b182ae,127.55
0009c9a17f916a706d71784483a5d643,650.34
000aed2e25dbad2f9ddb70584c5a2ded,152.77
000c3e6612759851cc3cbb4b83257986,112.71
000e562887b1f2006d75e0be9558292e,41.11
000e63d38ae8c00bbcb5a30573b99628,56.78
000e906b789b55f64edcb1f84030f90d,33.84
000f25f4d72195062c040b12dce9a18a,164.39
001021efaa8636c29475e7734483457d,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,65.5
0010dedd556712d7bb69a19cb7bbd37a,111.12
00119ff934e539cf26f92b9ef0cdfed8,236.88
0011d82c4b53e22e84023405fb467e57,315.33
00125cb692d04887809806618a2a145f,135.41
00130c0eee84a3d909e75bc08c5c3ca1,35.84
0013503b13da1eac686219390b7d641b,137.22
00137e170939bba5a3134e2386413108,421.65
001427c0ec99cf8af737bd88e92fd444,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,109.29
0014ae671de39511f7575066200733b7,30.6
0015ebb40fb17286bea51d4607c4733c,37.0
00169e31ef4b29deaae414f9a5e95929,55.11
0016dfedd97fc2950e388d2971d718c7,70.55000000000001
0017afd5076e074a48f1f1a4c7bac9c5,853.39
001862358bf858722e1e2ae000cfed8b,113.71
0019c29108428acffd089c36103c9440,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,127.56
001ac194d4a326a6fa99b581e9a3d963,62.54
001b76dd48a5b1eee3e87778daa40df8,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,53.54
001daeb0eddc45b999bad0801ad9d273,55.12
001dbc16dc51075e987543d23a0507c7,87.9
001e7ba991be1b19605ca0316e7130f9,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,51.1
0020262c8a370bd5a174ea6a2a267321,100.55
0020a222f55eb79a372d0efee3cca688,45.09
002175704e8b209f61b9ad5cfd92b60e,123.11
00229e4e43f7a7e0b9dd819ad43268d3,91.39
0025081dcf9330f9a5052ae82c6ce396,33.18
00254baeb6c932b0a8aeead91fbd02b5,193.01
00259a44fcad3fc0474329e925d14fc3,34.09
0025c5d1a8ca53a240ec2634bb4492ea,419.39
002611a77fe03d076285fd4ca95db77c,156.75
002691433f09002ac9ca0c4e8dbb8ead,120.43
0026a368634b6e6f34f33b1499773a30,164.8
00275bce676303c3bfd7292aefdfa223,293.36
00276d5c3491fbf55305e26891040df9,68.12
002834535f7a609a5c68266f173fa59e,57.17
0028de0ca693a1bb26448916a81105cc,45.3
002955b0acc63d04f6724a31967e82bd,135.59
0029c5db35ef291ce99d1262012e7daa,514.37
0029f17cf0e7640c5cb6825af681303f,113.44
002af7fa9eb99d1456bceb6a13d6fc0b,109.45
002b430ff89b3a24c31a1170acbbedea,265.55
002b4e6fa42cd4a22cc86abc18fe9c05,119.57
002c9def9c9b951b1bec6d50753c9891,173.8
002d040018d12a3853c059f7f23ab5b1,169.84
002f16b7bc4530031b7d90f791b12d8a,284.13
002f19a65a2ddd70a090297872e6d64e,77.28999999999999
002f98c0f7efd42638ed6100ca699b42,93.62
0030d783f979fbc5981e75613b057344,78.27
0030ff924c38549807645976adeef2c0,292.24
00310b0c75bb13015ec4d82d341865a4,55.28
00324b3eda39ba5ecce3945823e3594c,110.07
0032d07457ae9c806c79368d7d9ce96b,186.19
003324c70b19a16798817b2b3640e721,234.7
00335b686d693c7d72deeb12f8e89227,80.79
00335f75ea6a4455b524a8dd177067f5,177.01
00337fe25a3780b3424d9ad7c5a4b35e,139.68
003423b755b562962a6225a8de40d12e,261.33
00345f338696283410b7977d2e3efc89,67.34
0035246a40f520710769010f752e7507,99.11
0035c0b07126fe9c24a325216fb96064,150.44
0035e6b7ade84b3f5b86bd49814793df,34.0
0036757472ece3dde52fd4bfd929c90e,203.03
0036887767dea4bd43b1a88cd0d9477a,423.63
00378c6c981f234634c0b9d6128df6dd,52.85
003822434f91204da0a51fe4cf2aba18,175.16
0039500db36d50d7d0bfaf23723550f3,203.23
003a7f59d7e08a9c61d9e2881fe6459c,134.28
003a94f778ef8cfd50247c8c1b582257,57.98
003cc6161d7a2593f2525cce0c330d32,97.9
003d0634280ff3d1d3a54459349a6899,228.89
003d804eef0e1b856881cd18e0cc0d4c,312.74
003d9fc84ad902adf2265248b5ffe1a4,94.74
Query:
SELECT o."order_id", o."customer_id", p."payment_value"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,payment_value
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2.0
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,18.12
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,18.59
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,141.46
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,179.12
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,72.2
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,28.62
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,175.26
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,65.95
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,75.16
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,35.95
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,8.34
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,161.42
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,259.06
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,114.13
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,50.13
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,32.7
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,54.36
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,146.45
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,1376.45
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,43.09
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,29.75
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,5.96
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,24.86
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,62.15
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,118.86
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,88.9
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,17.28
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,187.57
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,104.11
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,125.43
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,227.68
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,60.69
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,192.68
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,63.34
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,313.19
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,224.9
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,63.1
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,100.25
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,188.41
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,106.95
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,66.79
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,43.0
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,508.17
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,49.69
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,154.19
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,356.12
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,95.67
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,121.62
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,22.36
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,153.72
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,54.82
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,82.33
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,52.24
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,130.56
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,52.84
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,71.91
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,151.04
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,386.33
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,50.25
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,128.68
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,43.46
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,91.68
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,99.26
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,141.15
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,91.66
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,53.66
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,317.34
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a
Query:
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
   FROM "orders"
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
customer_id,number_of_orders
00012a2ce6f8dcda20d059ce98491703,1
000161a058600d5901f007fab4c27140,1
0001fd6190edaaf884bcaf3d49edf079,1
0002414f95344307404f0ace7a26f1d5,1
000379cdec625522490c315e70c7a9fb,1
0004164d20a9e969af783496f3408652,1
000419c5494106c306a97b5635748086,1
00046a560d407e99b969756e0b10f282,1
00050bf6e01e69d5c0fd612f1bcfb69c,1
000598caf2ef4117407665ac33275130,1
0005aefbb696d34b3424dccd0a0e9fd0,1
00062b33cb9f6fe976afdcff967ea74d,1
00066ccbe787a588c52bd5ff404590e3,1
00072d033fe2e59061ae5c3aff1a2be5,1
0009a69b72033b2d0ec8c69fc70ef768,1
000bf8121c3412d3057d32371c5d3395,1
000e943451fc2788ca6ac98a682f2f49,1
000f17e290c26b28549908a04cfe36c1,1
000fd45d6fedae68fc6676036610f879,1
0010068a73b7c56da5758c3f9e5c7375,1
001028b78fd413e19704b3867c369d3a,1
00104a47c29da701ce41ee52077587d9,1
001051abfcfdbed9f87b4266213a5df1,1
00114026c1b7b52ab1773f317ef4880b,1
001226b2341ef620415ce7bbafcfac28,1
0012a5c13793cf51e253f096a7e740dd,1
0013280441d86a4f7a8006efdaf1b0fe,1
0013cd8e350a7cc76873441e431dd5ee,1
001450ebb4a77efb3d68be5f7887cb1e,1
00146ad30454993879adaa91c518f68c,1
00155f0530cc7b2bf73cc3f81cb01c52,1
001574cd5824c0b1ea90dd4f4ba6d5b8,1
0015bc9fd2d5395446143e8b215d7c75,1
0015f7887e2fde13ddaa7b8e385af919,1
0017a0b4c1f1bdb9c395fa0ac517109c,1
0018c09f333634ca9c80d9ff46e43e9c,1
0018f7fde63ca77254dbc47f4ea358b2,1
0019c9aaad15b043c48f0a1180f22ce8,1
001a57041f56400917a187dd74e6cbc1,1
001b4e9b73aa98a6276b241bfd496822,1
001c7f05398c45b42eee0d5a77783bca,1
001df1ee5c36767aa607001ab1a13a06,1
001f150aebb5d897f2059b0460c38449,1
001f35d9f262c558fd065346fbf5801d,1
001f6f1a5e902ad14e1f709a7215de11,1
00205ad9ba1ef4340cef86583294cf82,1
002236c4f333bc8df6a5939749eb7869,1
002348c1099e3229276c8ad7d4ddc702,1
002408f390f729598bbac1ef9421c6ae,1
002450e9ea44cb90b8a07ba0b197e149,1
002554bdf9eb99618d8189c3a89fdd52,1
0026955706fd4e2fa997f3f4c18d485a,1
0026d252429f669d454d726e5e956aa1,1
002834b4d901534f48d9e9a72047b288,1
0028ff36263a86bf679df7c863a0a0ba,1
002905287304e28c0218389269b4759b,1
002937abdae13680e17dccd3868b4825,1
0029cdf064769cabdf3186b54d068c99,1
002a10e899b62a460b0116e0b68697ad,1
002b24cb2cd0c3e575040dbd278885e3,1
002b5342c72978cf0aba6aae1f5d5293,1
002c625393dfa194828b462a6ef8cb0b,1
002ce108ccf0356ef5c8b1dce3c0ae29,1
002d358e2462f87678443706cbf2eb21,1
002d597546b2cf44428232c9f237f873,1
002ebb669a34b9e79c88efc755e95322,1
002ef7e55600d44ead53f7c1644e5222,1
002f067b028a3643ad3a0969c7a0f3dc,1
002f90a6eb386bc43bc9ba200db31a89,1
002fb8fc5ce64f8422fa2fe79986c783,1
002ff70a5285669011090c077ef929af,1
00302a0b99783c3d1d1e81c616e321e8,1
0030aded3a67b29946a128ee8468388e,1
0030fbb95fbe7e61f798a80edb01a8e9,1
00314f95a054231742e3c5396b333b88,1
003177b3eeca50af17750f53802c9a09,1
0031abfb953b66e998f67b09e7b11375,1
0031c1062edf836ef7a7a7ea758b137b,1
00330644cccc5db0276fa836976306fe,1
00331de1659c7f4fb660c8810e6de3f5,1
0033823ee55671ac5317d423291333c2,1
0034f7933de3ead6bd9ba49afe95f119,1
003536ce5e18f1d12b9bf76932f8a6b1,1
0035b30e58c620fa2bd30275ddd4f7ef,1
0036875772a8eeb391b8cd7226283fdd,1
0037d14e53af1d555a582504a4058f4c,1
00380c010de38d578d02117f6d0b88e7,1
0039b3e41ac6615814a0b44a8992bff5,1
003a75d228dc67cb2918e40c2aacc4bf,1
003b595c764773e20e0949b6fba7b1dc,1
003bc8d06ebed9d146eb9f100d0a89ae,1
003bdf7fd8312f9d14a4b979f3747334,1
003c7cadba4f182b9f22d7d5ea7a5003,1
003cb2c7ce25d8af8556fb456f903546,1
003cbe6a43560a8b6fd2c07531257c2d,1
003e45472805afa1ee701d83284fa22b,1
003eab528664e1bd677218ef4be086ac,1
003ec17a1389fa302f3a0423dddd8650,1
003f7d92ac63c512bb6584219806f8df,1
0040a8417928d0d5abd5169cd7877181,1
Query:
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,total_payment
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,106.23
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,65.2
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49
Query:
SELECT o."customer_id", AVG(p."payment_value") AS "average_payment_per_order"
   FROM "orders" AS o
   JOIN "order_payments" AS p ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,average_payment_per_order
00012a2ce6f8dcda20d059ce98491703,114.74
000161a058600d5901f007fab4c27140,67.41
0001fd6190edaaf884bcaf3d49edf079,195.42
0002414f95344307404f0ace7a26f1d5,179.35
000379cdec625522490c315e70c7a9fb,107.01
0004164d20a9e969af783496f3408652,71.8
000419c5494106c306a97b5635748086,49.4
00046a560d407e99b969756e0b10f282,166.59
00050bf6e01e69d5c0fd612f1bcfb69c,85.23
000598caf2ef4117407665ac33275130,1255.71
0005aefbb696d34b3424dccd0a0e9fd0,147.33
00062b33cb9f6fe976afdcff967ea74d,58.95
00066ccbe787a588c52bd5ff404590e3,270.0
00072d033fe2e59061ae5c3aff1a2be5,106.97
0009a69b72033b2d0ec8c69fc70ef768,173.6
000bf8121c3412d3057d32371c5d3395,45.56
000e943451fc2788ca6ac98a682f2f49,26.5575
000f17e290c26b28549908a04cfe36c1,139.52
000fd45d6fedae68fc6676036610f879,66.81
0010068a73b7c56da5758c3f9e5c7375,54.83
001028b78fd413e19704b3867c369d3a,37.61
00104a47c29da701ce41ee52077587d9,100.34
001051abfcfdbed9f87b4266213a5df1,21.733333333333334
00114026c1b7b52ab1773f317ef4880b,66.01
001226b2341ef620415ce7bbafcfac28,47.53
0012a5c13793cf51e253f096a7e740dd,369.92
0013280441d86a4f7a8006efdaf1b0fe,162.15
0013cd8e350a7cc76873441e431dd5ee,92.6
001450ebb4a77efb3d68be5f7887cb1e,61.33
00146ad30454993879adaa91c518f68c,221.79
00155f0530cc7b2bf73cc3f81cb01c52,40.75
001574cd5824c0b1ea90dd4f4ba6d5b8,184.94
0015bc9fd2d5395446143e8b215d7c75,132.19
0015f7887e2fde13ddaa7b8e385af919,186.74
0017a0b4c1f1bdb9c395fa0ac517109c,50.01
0018c09f333634ca9c80d9ff46e43e9c,56.87
0018f7fde63ca77254dbc47f4ea358b2,51.27
0019c9aaad15b043c48f0a1180f22ce8,112.83
001a57041f56400917a187dd74e6cbc1,53.72
001b4e9b73aa98a6276b241bfd496822,82.87
001c7f05398c45b42eee0d5a77783bca,21.94
001df1ee5c36767aa607001ab1a13a06,42.86
001f150aebb5d897f2059b0460c38449,125.97
001f35d9f262c558fd065346fbf5801d,46.53
001f6f1a5e902ad14e1f709a7215de11,34.86
00205ad9ba1ef4340cef86583294cf82,928.7
002236c4f333bc8df6a5939749eb7869,69.84
002348c1099e3229276c8ad7d4ddc702,249.56
002408f390f729598bbac1ef9421c6ae,258.01
002450e9ea44cb90b8a07ba0b197e149,40.0
002554bdf9eb99618d8189c3a89fdd52,244.08
0026955706fd4e2fa997f3f4c18d485a,121.9
0026d252429f669d454d726e5e956aa1,139.15
002834b4d901534f48d9e9a72047b288,214.14
0028ff36263a86bf679df7c863a0a0ba,74.94
002905287304e28c0218389269b4759b,31.7
002937abdae13680e17dccd3868b4825,43.55
0029cdf064769cabdf3186b54d068c99,483.7
002a10e899b62a460b0116e0b68697ad,92.81
002b24cb2cd0c3e575040dbd278885e3,40.22
002b5342c72978cf0aba6aae1f5d5293,51.17
002c625393dfa194828b462a6ef8cb0b,371.87
002ce108ccf0356ef5c8b1dce3c0ae29,185.6
002d358e2462f87678443706cbf2eb21,45.61
002d597546b2cf44428232c9f237f873,117.74
002ebb669a34b9e79c88efc755e95322,133.57
002ef7e55600d44ead53f7c1644e5222,199.02
002f067b028a3643ad3a0969c7a0f3dc,107.84
002f90a6eb386bc43bc9ba200db31a89,153.51
002fb8fc5ce64f8422fa2fe79986c783,67.68
002ff70a5285669011090c077ef929af,81.14
00302a0b99783c3d1d1e81c616e321e8,159.48
0030aded3a67b29946a128ee8468388e,58.59
0030fbb95fbe7e61f798a80edb01a8e9,26.85
00314f95a054231742e3c5396b333b88,59.34
003177b3eeca50af17750f53802c9a09,133.81
0031abfb953b66e998f67b09e7b11375,671.85
0031c1062edf836ef7a7a7ea758b137b,81.0
00330644cccc5db0276fa836976306fe,55.1
00331de1659c7f4fb660c8810e6de3f5,243.69
0033823ee55671ac5317d423291333c2,79.48
0034f7933de3ead6bd9ba49afe95f119,84.24
003536ce5e18f1d12b9bf76932f8a6b1,53.33
0035b30e58c620fa2bd30275ddd4f7ef,78.2
0036875772a8eeb391b8cd7226283fdd,61.85
0037d14e53af1d555a582504a4058f4c,603.4
00380c010de38d578d02117f6d0b88e7,64.1
0039b3e41ac6615814a0b44a8992bff5,34.59
003a75d228dc67cb2918e40c2aacc4bf,79.28
003b595c764773e20e0949b6fba7b1dc,25.46
003bc8d06ebed9d146eb9f100d0a89ae,600.04
003bdf7fd8312f9d14a4b979f3747334,43.68
003c7cadba4f182b9f22d7d5ea7a5003,128.25
003cb2c7ce25d8af8556fb456f903546,420.94
003cbe6a43560a8b6fd2c07531257c2d,27.75
003e45472805afa1ee701d83284fa22b,30.6
003eab528664e1bd677218ef4be086ac,77.1
003ec17a1389fa302f3a0423dddd8650,17.77
003f7d92ac63c512bb6584219806f8df,84.91
0040a8417928d0d5abd5169cd7877181,219.49
Query:
SELECT "customer_id", 
           MIN("order_purchase_timestamp") AS "first_purchase", 
           MAX("order_purchase_timestamp") AS "last_purchase"
    FROM "orders"
    GROUP BY "customer_id"
    LIMIT 100;
Answer:
Too long, hard cut:
customer_id,first_purchase,last_purchase
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13,2017-05-14 23:55:13
001574cd5824c0b1ea90dd4f4ba6d5b8,2017-11-26 02:13:57,2017-11-26 02:13:57
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33,2018-01-22 20:16:33
002348c1099e3229276c8ad7d4ddc702,2018-01-10 12:28:22,2018-01-10 12:28:22
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45,2018-08-20 11:23:45
0026d252429f669d454d726e5e956aa1,2017-11-09 16:08:41,2017-11-09 16:08:41
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32,2018-05-21 23:17:32
002b5342c72978cf0aba6aae1f5d5293,2018-09-10 17:51:25,2018-09-10 17:51:25
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12,2017-10-19 09:3
Query:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3;
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0
Query:
SELECT "customer_id",
       CASE
           WHEN (JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX("order_purchase_timestamp")) - JULIANDAY(MIN("order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders"
GROUP BY "customer_id"
LIMIT 100
Answer:
customer_id,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1.0
000161a058600d5901f007fab4c27140,1.0
0001fd6190edaaf884bcaf3d49edf079,1.0
0002414f95344307404f0ace7a26f1d5,1.0
000379cdec625522490c315e70c7a9fb,1.0
0004164d20a9e969af783496f3408652,1.0
000419c5494106c306a97b5635748086,1.0
00046a560d407e99b969756e0b10f282,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1.0
000598caf2ef4117407665ac33275130,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1.0
00062b33cb9f6fe976afdcff967ea74d,1.0
00066ccbe787a588c52bd5ff404590e3,1.0
00072d033fe2e59061ae5c3aff1a2be5,1.0
0009a69b72033b2d0ec8c69fc70ef768,1.0
000bf8121c3412d3057d32371c5d3395,1.0
000e943451fc2788ca6ac98a682f2f49,1.0
000f17e290c26b28549908a04cfe36c1,1.0
000fd45d6fedae68fc6676036610f879,1.0
0010068a73b7c56da5758c3f9e5c7375,1.0
001028b78fd413e19704b3867c369d3a,1.0
00104a47c29da701ce41ee52077587d9,1.0
001051abfcfdbed9f87b4266213a5df1,1.0
00114026c1b7b52ab1773f317ef4880b,1.0
001226b2341ef620415ce7bbafcfac28,1.0
0012a5c13793cf51e253f096a7e740dd,1.0
0013280441d86a4f7a8006efdaf1b0fe,1.0
0013cd8e350a7cc76873441e431dd5ee,1.0
001450ebb4a77efb3d68be5f7887cb1e,1.0
00146ad30454993879adaa91c518f68c,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1.0
0015bc9fd2d5395446143e8b215d7c75,1.0
0015f7887e2fde13ddaa7b8e385af919,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1.0
0018c09f333634ca9c80d9ff46e43e9c,1.0
0018f7fde63ca77254dbc47f4ea358b2,1.0
0019c9aaad15b043c48f0a1180f22ce8,1.0
001a57041f56400917a187dd74e6cbc1,1.0
001b4e9b73aa98a6276b241bfd496822,1.0
001c7f05398c45b42eee0d5a77783bca,1.0
001df1ee5c36767aa607001ab1a13a06,1.0
001f150aebb5d897f2059b0460c38449,1.0
001f35d9f262c558fd065346fbf5801d,1.0
001f6f1a5e902ad14e1f709a7215de11,1.0
00205ad9ba1ef4340cef86583294cf82,1.0
002236c4f333bc8df6a5939749eb7869,1.0
002348c1099e3229276c8ad7d4ddc702,1.0
002408f390f729598bbac1ef9421c6ae,1.0
002450e9ea44cb90b8a07ba0b197e149,1.0
002554bdf9eb99618d8189c3a89fdd52,1.0
0026955706fd4e2fa997f3f4c18d485a,1.0
0026d252429f669d454d726e5e956aa1,1.0
002834b4d901534f48d9e9a72047b288,1.0
0028ff36263a86bf679df7c863a0a0ba,1.0
002905287304e28c0218389269b4759b,1.0
002937abdae13680e17dccd3868b4825,1.0
0029cdf064769cabdf3186b54d068c99,1.0
002a10e899b62a460b0116e0b68697ad,1.0
002b24cb2cd0c3e575040dbd278885e3,1.0
002b5342c72978cf0aba6aae1f5d5293,1.0
002c625393dfa194828b462a6ef8cb0b,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1.0
002d358e2462f87678443706cbf2eb21,1.0
002d597546b2cf44428232c9f237f873,1.0
002ebb669a34b9e79c88efc755e95322,1.0
002ef7e55600d44ead53f7c1644e5222,1.0
002f067b028a3643ad3a0969c7a0f3dc,1.0
002f90a6eb386bc43bc9ba200db31a89,1.0
002fb8fc5ce64f8422fa2fe79986c783,1.0
002ff70a5285669011090c077ef929af,1.0
00302a0b99783c3d1d1e81c616e321e8,1.0
0030aded3a67b29946a128ee8468388e,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1.0
00314f95a054231742e3c5396b333b88,1.0
003177b3eeca50af17750f53802c9a09,1.0
0031abfb953b66e998f67b09e7b11375,1.0
0031c1062edf836ef7a7a7ea758b137b,1.0
00330644cccc5db0276fa836976306fe,1.0
00331de1659c7f4fb660c8810e6de3f5,1.0
0033823ee55671ac5317d423291333c2,1.0
0034f7933de3ead6bd9ba49afe95f119,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1.0
0036875772a8eeb391b8cd7226283fdd,1.0
0037d14e53af1d555a582504a4058f4c,1.0
00380c010de38d578d02117f6d0b88e7,1.0
0039b3e41ac6615814a0b44a8992bff5,1.0
003a75d228dc67cb2918e40c2aacc4bf,1.0
003b595c764773e20e0949b6fba7b1dc,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1.0
003bdf7fd8312f9d14a4b979f3747334,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1.0
003cb2c7ce25d8af8556fb456f903546,1.0
003cbe6a43560a8b6fd2c07531257c2d,1.0
003e45472805afa1ee701d83284fa22b,1.0
003eab528664e1bd677218ef4be086ac,1.0
003ec17a1389fa302f3a0423dddd8650,1.0
003f7d92ac63c512bb6584219806f8df,1.0
0040a8417928d0d5abd5169cd7877181,1.0
Query:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
00012a2ce6f8dcda20d059ce98491703,1,114.74,1.0
000161a058600d5901f007fab4c27140,1,67.41,1.0
0001fd6190edaaf884bcaf3d49edf079,1,195.42,1.0
0002414f95344307404f0ace7a26f1d5,1,179.35,1.0
000379cdec625522490c315e70c7a9fb,1,107.01,1.0
0004164d20a9e969af783496f3408652,1,71.8,1.0
000419c5494106c306a97b5635748086,1,49.4,1.0
00046a560d407e99b969756e0b10f282,1,166.59,1.0
00050bf6e01e69d5c0fd612f1bcfb69c,1,85.23,1.0
000598caf2ef4117407665ac33275130,1,1255.71,1.0
0005aefbb696d34b3424dccd0a0e9fd0,1,147.33,1.0
00062b33cb9f6fe976afdcff967ea74d,1,58.95,1.0
00066ccbe787a588c52bd5ff404590e3,1,270.0,1.0
00072d033fe2e59061ae5c3aff1a2be5,1,106.97,1.0
0009a69b72033b2d0ec8c69fc70ef768,1,173.6,1.0
000bf8121c3412d3057d32371c5d3395,1,45.56,1.0
000e943451fc2788ca6ac98a682f2f49,1,26.5575,1.0
000f17e290c26b28549908a04cfe36c1,1,139.52,1.0
000fd45d6fedae68fc6676036610f879,1,66.81,1.0
0010068a73b7c56da5758c3f9e5c7375,1,54.83,1.0
001028b78fd413e19704b3867c369d3a,1,37.61,1.0
00104a47c29da701ce41ee52077587d9,1,100.34,1.0
001051abfcfdbed9f87b4266213a5df1,1,21.733333333333334,1.0
00114026c1b7b52ab1773f317ef4880b,1,66.01,1.0
001226b2341ef620415ce7bbafcfac28,1,47.53,1.0
0012a5c13793cf51e253f096a7e740dd,1,369.92,1.0
0013280441d86a4f7a8006efdaf1b0fe,1,162.15,1.0
0013cd8e350a7cc76873441e431dd5ee,1,92.6,1.0
001450ebb4a77efb3d68be5f7887cb1e,1,61.33,1.0
00146ad30454993879adaa91c518f68c,1,221.79,1.0
00155f0530cc7b2bf73cc3f81cb01c52,1,40.75,1.0
001574cd5824c0b1ea90dd4f4ba6d5b8,1,184.94,1.0
0015bc9fd2d5395446143e8b215d7c75,1,132.19,1.0
0015f7887e2fde13ddaa7b8e385af919,1,186.74,1.0
0017a0b4c1f1bdb9c395fa0ac517109c,1,50.01,1.0
0018c09f333634ca9c80d9ff46e43e9c,1,56.87,1.0
0018f7fde63ca77254dbc47f4ea358b2,1,51.27,1.0
0019c9aaad15b043c48f0a1180f22ce8,1,112.83,1.0
001a57041f56400917a187dd74e6cbc1,1,53.72,1.0
001b4e9b73aa98a6276b241bfd496822,1,82.87,1.0
001c7f05398c45b42eee0d5a77783bca,1,21.94,1.0
001df1ee5c36767aa607001ab1a13a06,1,42.86,1.0
001f150aebb5d897f2059b0460c38449,1,125.97,1.0
001f35d9f262c558fd065346fbf5801d,1,46.53,1.0
001f6f1a5e902ad14e1f709a7215de11,1,34.86,1.0
00205ad9ba1ef4340cef86583294cf82,1,928.7,1.0
002236c4f333bc8df6a5939749eb7869,1,69.84,1.0
002348c1099e3229276c8ad7d4ddc702,1,249.56,1.0
002408f390f729598bbac1ef9421c6ae,1,258.01,1.0
002450e9ea44cb90b8a07ba0b197e149,1,40.0,1.0
002554bdf9eb99618d8189c3a89fdd52,1,244.08,1.0
0026955706fd4e2fa997f3f4c18d485a,1,121.9,1.0
0026d252429f669d454d726e5e956aa1,1,139.15,1.0
002834b4d901534f48d9e9a72047b288,1,214.14,1.0
0028ff36263a86bf679df7c863a0a0ba,1,74.94,1.0
002905287304e28c0218389269b4759b,1,31.7,1.0
002937abdae13680e17dccd3868b4825,1,43.55,1.0
0029cdf064769cabdf3186b54d068c99,1,483.7,1.0
002a10e899b62a460b0116e0b68697ad,1,92.81,1.0
002b24cb2cd0c3e575040dbd278885e3,1,40.22,1.0
002b5342c72978cf0aba6aae1f5d5293,1,51.17,1.0
002c625393dfa194828b462a6ef8cb0b,1,371.87,1.0
002ce108ccf0356ef5c8b1dce3c0ae29,1,185.6,1.0
002d358e2462f87678443706cbf2eb21,1,45.61,1.0
002d597546b2cf44428232c9f237f873,1,117.74,1.0
002ebb669a34b9e79c88efc755e95322,1,133.57,1.0
002ef7e55600d44ead53f7c1644e5222,1,199.02,1.0
002f067b028a3643ad3a0969c7a0f3dc,1,107.84,1.0
002f90a6eb386bc43bc9ba200db31a89,1,153.51,1.0
002fb8fc5ce64f8422fa2fe79986c783,1,67.68,1.0
002ff70a5285669011090c077ef929af,1,81.14,1.0
00302a0b99783c3d1d1e81c616e321e8,1,159.48,1.0
0030aded3a67b29946a128ee8468388e,1,58.59,1.0
0030fbb95fbe7e61f798a80edb01a8e9,1,26.85,1.0
00314f95a054231742e3c5396b333b88,1,59.34,1.0
003177b3eeca50af17750f53802c9a09,1,133.81,1.0
0031abfb953b66e998f67b09e7b11375,1,671.85,1.0
0031c1062edf836ef7a7a7ea758b137b,1,81.0,1.0
00330644cccc5db0276fa836976306fe,1,55.1,1.0
00331de1659c7f4fb660c8810e6de3f5,1,243.69,1.0
0033823ee55671ac5317d423291333c2,1,79.48,1.0
0034f7933de3ead6bd9ba49afe95f119,1,84.24,1.0
003536ce5e18f1d12b9bf76932f8a6b1,1,53.33,1.0
0035b30e58c620fa2bd30275ddd4f7ef,1,78.2,1.0
0036875772a8eeb391b8cd7226283fdd,1,61.85,1.0
0037d14e53af1d555a582504a4058f4c,1,603.4,1.0
00380c010de38d578d02117f6d0b88e7,1,64.1,1.0
0039b3e41ac6615814a0b44a8992bff5,1,34.59,1.0
003a75d228dc67cb2918e40c2aacc4bf,1,79.28,1.0
003b595c764773e20e0949b6fba7b1dc,1,25.46,1.0
003bc8d06ebed9d146eb9f100d0a89ae,1,600.04,1.0
003bdf7fd8312f9d14a4b979f3747334,1,43.68,1.0
003c7cadba4f182b9f22d7d5ea7a5003,1,128.25,1.0
003cb2c7ce25d8af8556fb456f903546,1,420.94,1.0
003cbe6a43560a8b6fd2c07531257c2d,1,27.75,1.0
003e45472805afa1ee701d83284fa22b,1,30.6,1.0
003eab528664e1bd677218ef4be086ac,1,77.1,1.0
003ec17a1389fa302f3a0423dddd8650,1,17.77,1.0
003f7d92ac63c512bb6584219806f8df,1,84.91,1.0
0040a8417928d0d5abd5169cd7877181,1,219.49,1.0
Query:
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order",
       CASE
           WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7.0
           THEN 1.0
           ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
       END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0
Query:
SELECT DISTINCT "payment_type"
FROM "order_payments"
LIMIT 100
Answer:
payment_type
credit_card
boleto
voucher
debit_card
not_defined
Query:
SELECT "customer_id", "customer_unique_id", "customer_city"
FROM "customers"
LIMIT 100
Answer:
Too long, hard cut:
customer_id,customer_unique_id,customer_city
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia
03f846ad03437d864a8d2a22976dcafe,7677c213007e9a6ec9267ea50b5ce5bc,sao paulo
de4e13fd7d6469c5ada77d0843c55e42,0c17f9ac28cbd7323f0f4043e9db5907,pelotas
8276de07ef25225d412b8462d73f8664,332cf4e83e16004ba7dca932ce
Query:
SELECT "order_id", COUNT(*) AS "number_of_payments"
FROM "order_payments"
GROUP BY "order_id"
LIMIT 100
Answer:
order_id,number_of_payments
00010242fe8c5a6d1ba2dd792cb16214,1
00018f77f2f0320c557190d7a144bdd3,1
000229ec398224ef6ca0657da4fc703e,1
00024acbcdf0a6daa1e931b038114c75,1
00042b26cf59d7ce69dfabb4e55b4fd9,1
00048cc3ae777c65dbb7d2a0634bc1ea,1
00054e8431b9d7675808bcb819fb4a32,1
000576fe39319847cbb9d288c5617fa6,1
0005a1a1728c9d785b8e2b08b904576c,1
0005f50442cb953dcd1d21e1fb923495,1
00061f2a7bc09da83e415a52dc8a4af1,1
00063b381e2406b52ad429470734ebd5,1
0006ec9db01a64e59a68b2c340bf65a7,1
0008288aa423d2a3f00fcb17cd7d8719,1
0009792311464db532ff765bf7b182ae,1
0009c9a17f916a706d71784483a5d643,1
000aed2e25dbad2f9ddb70584c5a2ded,1
000c3e6612759851cc3cbb4b83257986,1
000e562887b1f2006d75e0be9558292e,1
000e63d38ae8c00bbcb5a30573b99628,1
000e906b789b55f64edcb1f84030f90d,1
000f25f4d72195062c040b12dce9a18a,1
001021efaa8636c29475e7734483457d,1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,1
0010dedd556712d7bb69a19cb7bbd37a,1
00119ff934e539cf26f92b9ef0cdfed8,1
0011d82c4b53e22e84023405fb467e57,1
00125cb692d04887809806618a2a145f,1
00130c0eee84a3d909e75bc08c5c3ca1,1
0013503b13da1eac686219390b7d641b,1
00137e170939bba5a3134e2386413108,1
001427c0ec99cf8af737bd88e92fd444,1
00143d0f86d6fbd9f9b38ab440ac16f5,1
0014ae671de39511f7575066200733b7,1
0015ebb40fb17286bea51d4607c4733c,1
00169e31ef4b29deaae414f9a5e95929,1
0016dfedd97fc2950e388d2971d718c7,2
0017afd5076e074a48f1f1a4c7bac9c5,1
001862358bf858722e1e2ae000cfed8b,1
0019c29108428acffd089c36103c9440,1
001ab0a7578dd66cd4b0a71f5b6e1e41,1
001ac194d4a326a6fa99b581e9a3d963,1
001b76dd48a5b1eee3e87778daa40df8,1
001c85b5f68d2be0cb0797afc9e8ce9a,1
001d8f0e34a38c37f7dba2a37d4eba8b,1
001daeb0eddc45b999bad0801ad9d273,1
001dbc16dc51075e987543d23a0507c7,1
001e7ba991be1b19605ca0316e7130f9,1
001e7cf2ad6bef3ade12ebc56ceaf0f3,1
0020262c8a370bd5a174ea6a2a267321,1
0020a222f55eb79a372d0efee3cca688,1
002175704e8b209f61b9ad5cfd92b60e,1
00229e4e43f7a7e0b9dd819ad43268d3,1
0025081dcf9330f9a5052ae82c6ce396,1
00254baeb6c932b0a8aeead91fbd02b5,1
00259a44fcad3fc0474329e925d14fc3,1
0025c5d1a8ca53a240ec2634bb4492ea,1
002611a77fe03d076285fd4ca95db77c,1
002691433f09002ac9ca0c4e8dbb8ead,1
0026a368634b6e6f34f33b1499773a30,1
00275bce676303c3bfd7292aefdfa223,1
00276d5c3491fbf55305e26891040df9,1
002834535f7a609a5c68266f173fa59e,1
0028de0ca693a1bb26448916a81105cc,1
002955b0acc63d04f6724a31967e82bd,1
0029c5db35ef291ce99d1262012e7daa,1
0029f17cf0e7640c5cb6825af681303f,1
002af7fa9eb99d1456bceb6a13d6fc0b,1
002b430ff89b3a24c31a1170acbbedea,1
002b4e6fa42cd4a22cc86abc18fe9c05,1
002c9def9c9b951b1bec6d50753c9891,1
002d040018d12a3853c059f7f23ab5b1,1
002f16b7bc4530031b7d90f791b12d8a,1
002f19a65a2ddd70a090297872e6d64e,2
002f98c0f7efd42638ed6100ca699b42,1
0030d783f979fbc5981e75613b057344,1
0030ff924c38549807645976adeef2c0,1
00310b0c75bb13015ec4d82d341865a4,1
00324b3eda39ba5ecce3945823e3594c,1
0032d07457ae9c806c79368d7d9ce96b,1
003324c70b19a16798817b2b3640e721,1
00335b686d693c7d72deeb12f8e89227,1
00335f75ea6a4455b524a8dd177067f5,1
00337fe25a3780b3424d9ad7c5a4b35e,1
003423b755b562962a6225a8de40d12e,1
00345f338696283410b7977d2e3efc89,1
0035246a40f520710769010f752e7507,1
0035c0b07126fe9c24a325216fb96064,1
0035e6b7ade84b3f5b86bd49814793df,1
0036757472ece3dde52fd4bfd929c90e,1
0036887767dea4bd43b1a88cd0d9477a,1
00378c6c981f234634c0b9d6128df6dd,1
003822434f91204da0a51fe4cf2aba18,1
0039500db36d50d7d0bfaf23723550f3,1
003a7f59d7e08a9c61d9e2881fe6459c,1
003a94f778ef8cfd50247c8c1b582257,1
003cc6161d7a2593f2525cce0c330d32,1
003d0634280ff3d1d3a54459349a6899,1
003d804eef0e1b856881cd18e0cc0d4c,1
003d9fc84ad902adf2265248b5ffe1a4,1
Query:
SELECT "order_id", "payment_installments", "payment_value"
FROM "order_payments"
WHERE "payment_installments" > 1
LIMIT 100
Answer:
order_id,payment_installments,payment_value
b81ef226f3fe1789b1e8b2acac839d17,8,99.33
ba78997921bbcdc1373bb41e913ab953,8,107.78
42fdf880ba16b47b59251dd489d4441a,2,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,2,96.12
3d7239c394a212faae122962df514ac7,3,51.84
1f78449c87a54faf9e96e88ba1491fa9,6,341.09
d88e0d5fa41661ce03cf6cf336527646,8,188.73
cf95215a722f3ebf29e6bbab87a29e61,5,102.66
769214176682788a92801d8907fa1b40,4,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,10,157.45
8ac09207f415d55acff302df7d6a895c,4,244.15
b2349a3f20dfbeef62e7b31baa22f84b,3,136.71
5a1f6d22f7dfb061ef29216b9af687a1,4,47.69
4214cda550ece8ee66441f459dc33a8c,2,170.57
adfbf6c2a620196f9a3ec747491c72b7,4,67.5
4d680edbaa7d3d9bed69532957368a03,10,353.09
d0a945f85ba1074b60aac97ade7e240e,2,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,2,139.22
5d9c5817e278892b7498d90bfa28ade8,2,290.16
1dcf0c8cd36ffaf57784fbdc90079310,3,157.15
cf30fe76d1505192acee1c6dccb15545,2,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,8,117.74
afef48d3c8a0b1b7c9b7f8f922fb5674,5,153.41
c0db7d31ace61fc360a3eaa34dd3457c,5,65.71
d574338f566ca28dd67820f48ec1f1d8,4,278.22
1807cc736321f14baa58ef39cf6e5989,4,91.66
2e2c60b99754ae1e4d8b18846cfec9f2,4,542.66
10af96a0689260134307879127ac1952,2,113.2
85eef2d342b0de363c45c1bc324729c5,3,99.43
aa964845f1de8125410aea8b73e9e1ec,2,27.35
343348b1e29e9fa9e7b6ab1027f9177d,4,43.77
ad4098a257676ea4d394fb3bbbf36ca3,2,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,2,105.53
3ab4eea6776259ae8dfbabaeffece352,8,387.8
c108072ab31ec90a754129c171577f5f,4,210.82
795c16acb4e3c30dfa5b6827727ef488,2,37.58
60e43c5f5ba559d9dd19357ed72cb2f2,2,78.3
110d9355d6338eab0a65a0cacdde5434,5,566.4
42f5954cda381bd032934ee38c453711,8,402.42
97c111c4f22dfa1089a9c0b5338dcc79,3,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,3,187.51
e1b4ee0e390fbac1dec439d72b45a115,3,77.7
4c2e1a95586c815795a324d1599e7b5a,8,117.71
c9f23db8a1cb725df9bdb3383bd72b38,3,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,3,34.78
198298d54f269d8c5fe89e85a859af61,10,342.56
b19ca559688b49e8cf7f88c1aa3f0009,7,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,4,117.85
de4090fd9b7900d46323b0c7c36b7128,2,121.45
20f136d890c31a62486c809f91a5b098,10,117.68
d60a89ab9bc1e68834465ae630c3343e,2,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,6,60.07
f9d5bfb53147f381e81b89a848e26b16,3,195.71
85a4fbdba48c815924115fb82330071c,3,34.09
46ee6eaca194413758f200a6974b7e4d,3,71.99
9acd1ccfbc6445c0cad9ee9ddb48054c,3,81.78
83f24bbc4f76a2730ba9c9cfa32e6d07,3,231.45
0b65284a1a74114ea029b7676fdc1ba3,7,144.2
243312dbb316253ab77bb0140d94803c,10,285.79
8973a53fcad22a79e0ff315e7f9a0fd9,2,176.7
f090de1b2ed9f4e251662cb31e3c7127,2,27.63
2ccde1e4676c20b9444e2bcbed36334c,8,134.56
0f4b5614da144989e2acc5291af24357,4,96.98
1d92d2ce1ae2e0510b5ce50c5be578c6,2,110.03
c51dcdd98e1c413f3d394ffcb4656ed1,4,110.11
8f936fb77c720ab9ccd618af38c885cc,4,46.63
cdaa116d3c2521b4b6976043508d0943,2,61.77
9184724aacd6a7da5bcf4c08c2c674a8,3,57.53
8bdc559b124e47eb71b5d1be8d6675e4,7,76.02
859980aae511377b7230f72d90bfc580,10,106.77
0c99132c4ff916416ba8f74c378f1cbc,4,135.93
db43c1a570e28fe9da60a444e3616a2b,7,186.72
f75666bf6c9e09f6b3f4bcd797b57a3c,4,97.28
4f99d1a7b0d2308edf45baa6997ac961,6,125.53
ca8f94a99a8120c559e416275a535066,5,92.76
9bdcb4559b75d21a22fcd868d9e5dfec,8,348.02
96cc8c42014ddb42a775da9a45ae3f76,2,203.3
87f003dca70d4d22518366caf041e845,3,44.35
f244841f5a461472de8de82f023b1371,10,116.05
242e24b7eaa9f48cde9d679f8591124d,4,236.66
18259631aab7299bf25f83f5eac4c8d1,4,220.3
845af9472cc76e66fbf445931b511755,5,123.41
953b6636ab2347a8ba37a16770db47f9,10,379.07
886b114d034f4ac1d39d964c1b2a8182,10,2027.16
0a9716da94d89975e6637874280aadad,10,165.96
62d9b911d7c56cf455f660eecb8ddd3a,10,1002.73
e6ed38386107802a72ec8197195f79a7,2,240.52
4a4ed9ed7922304a569ed850baba99c6,3,33.13
1594012ccc1b0770373ce691d697e5ae,8,362.17
2fe14af1d4563c0e76f382bc63c9a245,2,88.72
bc3d816db1aa7215dbde5b1b00d3d32b,2,46.85
b545ba7b0bd67a3128185c7214704319,8,340.08
9e59025992bd64bc26551391ed44a450,3,67.01
7327c30a5230ce07bc2c7a695d553a00,4,40.27
3b9e43d6eba694f8a29c11ee67a04f2c,8,242.1
57e4fc8f20507381b3f7abbe4e2ccda3,2,215.56
e1b6234c322ab01a32771bf57c597043,8,156.09
03afb3c10af52ddfa3c33b9881bf43f8,2,131.5
66f249e4d7ab2f3872de7bd6d74719dd,8,348.77
648b4f683ccf074ebe65a73c8096dd18,4,139.87
End Exploring Related Columns
Task: Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: ```csv
number_of_orders,average_payment_per_order,lifespan_weeks
num_orders1:int,average_payment1:float,lifespan1:float
num_orders2:int,average_payment2:float,lifespan2:float
num_orders3:int,average_payment3:float,lifespan3:float
(Attention: answer in three rows)
```

**Explanation:**

The table displays the number of orders, average payment per order, and the customer lifespan in weeks for the top 3 customers with the highest average payment per order. The lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than one, setting it to 1.0..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is (table names): 
['product_category_name_translation', 'sellers', 'customers', 'geolocation', 'order_items', 'order_payments', 'order_reviews', 'orders', 'products', 'leads_qualified', 'leads_closed']

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 13:49:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:49:07 - root - INFO - ```sql
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0
        THEN 1.0
        ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
    END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3;
```
2025-02-10 13:49:08 - root - INFO - itercount: 1
2025-02-10 13:49:08 - root - INFO - 0
2025-02-10 13:49:08 - root - INFO - results: 
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0


2025-02-10 13:49:08 - root - INFO - Please check the answer again by reviewing Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
number_of_orders,average_payment_per_order,lifespan_weeks
num_orders1:int,average_payment1:float,lifespan1:float
num_orders2:int,average_payment2:float,lifespan2:float
num_orders3:int,average_payment3:float,lifespan3:float
(Attention: answer in three rows)
```

**Explanation:**

The table displays the number of orders, average payment per order, and the customer lifespan in weeks for the top 3 customers with the highest average payment per order. The lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than one, setting it to 1.0. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
customer_id,number_of_orders,average_payment_per_order,lifespan_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0
Current sql:
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0
        THEN 1.0
        ELSE ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
    END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3;
2025-02-10 13:51:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:51:10 - root - INFO - ```sql
SELECT
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    printf('%.4f', AVG(p."payment_value")) AS "average_payment_per_order",
    CASE
        WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0
        THEN 1.0
        ELSE printf('%.4f', ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0))
    END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY AVG(p."payment_value") DESC
LIMIT 3;
```

```csv
number_of_orders,average_payment_per_order,lifespan_weeks
1,13664.0800,1.0
1,7274.8800,1.0
1,6929.3100,1.0
```
2025-02-10 13:51:11 - root - INFO - itercount: 2
2025-02-10 13:51:11 - root - INFO - 0
2025-02-10 13:51:11 - root - INFO - results: 
number_of_orders,average_payment_per_order,lifespan_weeks
1,13664.0800,1.0
1,7274.8800,1.0
1,6929.3100,1.0


2025-02-10 13:51:11 - root - INFO - Please check the answer again by reviewing Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
number_of_orders,average_payment_per_order,lifespan_weeks
num_orders1:int,average_payment1:float,lifespan1:float
num_orders2:int,average_payment2:float,lifespan2:float
num_orders3:int,average_payment3:float,lifespan3:float
(Attention: answer in three rows)
```

**Explanation:**

The table displays the number of orders, average payment per order, and the customer lifespan in weeks for the top 3 customers with the highest average payment per order. The lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than one, setting it to 1.0. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_orders,average_payment_per_order,lifespan_weeks
1,13664.0800,1.0
1,7274.8800,1.0
1,6929.3100,1.0
Current sql:
SELECT
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    printf('%.4f', AVG(p."payment_value")) AS "average_payment_per_order",
    CASE
        WHEN ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0) < 1.0
        THEN 1.0
        ELSE printf('%.4f', ((JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0))
    END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY AVG(p."payment_value") DESC
LIMIT 3;
2025-02-10 13:51:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 13:51:45 - root - INFO - ```sql
SELECT
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    printf('%.4f', AVG(p."payment_value")) AS "average_payment_per_order",
    CASE
        WHEN (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) < 7
        THEN 1.0
        ELSE printf('%.4f', (JULIANDAY(MAX(o."order_purchase_timestamp")) - JULIANDAY(MIN(o."order_purchase_timestamp"))) / 7.0)
    END AS "lifespan_weeks"
FROM "orders" AS o
JOIN "order_payments" AS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY AVG(p."payment_value") DESC
LIMIT 3;
```

```csv
number_of_orders,average_payment_per_order,lifespan_weeks
1,13664.0800,1.0
1,7274.8800,1.0
1,6929.3100,1.0
```
2025-02-10 13:51:45 - root - INFO - itercount: 3
2025-02-10 13:51:45 - root - INFO - 0
2025-02-10 13:51:45 - root - INFO - Total iteration counts: 3
