2025-02-11 11:23:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:23:15 - root - INFO - SQL:
SELECT DISTINCT "ticker" FROM "bitcoin_prices" LIMIT 100;
Results:
ticker
ETH
BTC

2025-02-11 11:23:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:23:57 - root - INFO - ```sql
SELECT
  current."ticker",
  current."market_date",
  current."volume" AS "current_volume",
  previous."volume" AS "previous_volume"
FROM "bitcoin_prices" AS current
JOIN "bitcoin_prices" AS previous
  ON current."ticker" = previous."ticker"
  AND previous."market_date" = date(current."market_date", '-1 day')
WHERE current."market_date" BETWEEN '2021-08-02' AND '2021-08-10'
ORDER BY current."ticker", current."market_date"
LIMIT 100;
```
2025-02-11 11:24:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:24:28 - root - INFO - ```sql
SELECT
  "ticker",
  "market_date",
  CASE
    WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
    WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
    WHEN "volume" = '-' THEN 0
    ELSE CAST("volume" AS REAL)
  END AS "volume_numeric"
FROM "bitcoin_prices"
ORDER BY "ticker", "market_date"
LIMIT 100;
```
2025-02-11 11:25:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:25:55 - root - INFO - SQL:
SELECT
  "ticker",
  "market_date",
  CASE
    WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
    WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
    WHEN "volume" = '-' THEN 0
    ELSE CAST("volume" AS REAL)
  END AS "volume_numeric"
FROM "bitcoin_prices"
ORDER BY "ticker", "market_date"
LIMIT 100;
Results:
ticker,market_date,volume_numeric
BTC,01-01-2017,41150.0
BTC,01-01-2018,78430.0
BTC,01-01-2019,469110.0
BTC,01-01-2020,420280.0
BTC,01-01-2021,100900.0
BTC,01-02-2017,45220.0
BTC,01-02-2018,358400.0
BTC,01-02-2019,481580.0
BTC,01-02-2020,458420.0
BTC,01-02-2021,126320.0
BTC,01-03-2017,51150.0
BTC,01-03-2018,188770.0
BTC,01-03-2019,1740000.0
BTC,01-03-2020,784050.0
BTC,01-03-2021,137520.0
BTC,01-04-2017,50660.0
BTC,01-04-2018,257529.99999999997
BTC,01-04-2019,3220000.0
BTC,01-04-2020,1400000.0
BTC,01-04-2021,69040.0
BTC,01-05-2017,100440.0
BTC,01-05-2018,173350.0
BTC,01-05-2019,623640.0
BTC,01-05-2020,1110000.0
BTC,01-05-2021,63410.0
BTC,01-06-2017,122700.0
BTC,01-06-2018,135920.0
BTC,01-06-2019,686750.0
BTC,01-06-2020,796680.0
BTC,01-06-2021,113480.0
BTC,01-07-2017,66320.0
BTC,01-07-2018,128509.99999999999
BTC,01-07-2019,1040000.0
BTC,01-07-2020,366780.0
BTC,01-07-2021,27410.0
BTC,01-08-2017,123170.0
BTC,01-08-2018,237690.0
BTC,01-08-2019,608370.0
BTC,01-08-2020,611470.0
BTC,01-08-2021,80330.0
BTC,01-09-2017,102010.0
BTC,01-09-2018,3520000.0
BTC,01-09-2019,322660.0
BTC,01-09-2020,580690.0
BTC,01-10-2017,60580.0
BTC,01-10-2018,9190000.0
BTC,01-10-2019,533950.0
BTC,01-10-2020,95330.0
BTC,01-11-2017,133190.0
BTC,01-11-2018,124160.0
BTC,01-11-2019,689650.0
BTC,01-11-2020,51710.0
BTC,01-12-2017,131920.0
BTC,01-12-2018,316300.0
BTC,01-12-2019,777000.0
BTC,01-12-2020,208720.0
BTC,02-01-2017,64950.0
BTC,02-01-2018,137730.0
BTC,02-01-2019,554470.0
BTC,02-01-2020,632780.0
BTC,02-01-2021,240870.0
BTC,02-02-2017,50860.0
BTC,02-02-2018,519400.0
BTC,02-02-2019,443600.0
BTC,02-02-2020,683370.0
BTC,02-02-2021,120850.0
BTC,02-03-2017,78490.0
BTC,02-03-2018,201690.0
BTC,02-03-2019,1610000.0
BTC,02-03-2020,1020000.0
BTC,02-03-2021,102100.0
BTC,02-04-2017,70980.0
BTC,02-04-2018,199310.0
BTC,02-04-2019,14770000.0
BTC,02-04-2020,1740000.0
BTC,02-04-2021,72370.0
BTC,02-05-2017,70010.0
BTC,02-05-2018,137480.0
BTC,02-05-2019,722230.0
BTC,02-05-2020,890340.0
BTC,02-05-2021,53610.0
BTC,02-06-2017,83030.0
BTC,02-06-2018,121180.0
BTC,02-06-2019,614540.0
BTC,02-06-2020,1060000.0
BTC,02-06-2021,96890.0
BTC,02-07-2017,67760.0
BTC,02-07-2018,179920.0
BTC,02-07-2019,1120000.0
BTC,02-07-2020,483100.0
BTC,02-07-2021,78930.0
BTC,02-08-2017,81820.0
BTC,02-08-2018,216340.0
BTC,02-08-2019,578290.0
BTC,02-08-2020,647950.0
BTC,02-08-2021,74810.0
BTC,02-09-2017,160770.0
BTC,02-09-2018,3900000.0
BTC,02-09-2019,542790.0
BTC,02-09-2020,20260000.0

2025-02-11 11:25:55 - root - INFO - SQL:
SELECT DISTINCT "volume" FROM "bitcoin_prices" LIMIT 100;
Results:
volume
582.04K
466.21K
839.54K
118.44K
923.13K
988.82K
1.09M
747.65K
768.74K
739.32K
844.13K
750.74K
1.06M
859.09K
782.81K
658.60K
795.54K
965.63K
950.12K
1.12M
1.44M
1.25M
64.84K
1.65M
1.23M
158.45K
970.67K
1.20M
507.08K
1.03M
642.75K
968.94K
1.89M
786.94K
907.11K
961.67K
1.02M
1.51M
802.78K
829.77K
623.52K
619.62K
645.06K
1.05M
717.85K
540.10K
724.84K
929.32K
1.42M
1.82M
1.32M
1.78M
822.95K
1.39M
1.28M
1.71M
1.90M
898.06K
2.19M
1.87M
1.99M
1.64M
1.77M
2.84M
2.69M
1.08M
778.79K
1.37M
1.95M
1.79M
1.62M
1.80M
587.18K
1.29M
2.32M
75.18K
3.01M
756.36K
2.55M
2.47M
2.60M
2.45M
2.83M
2.80M
2.94M
3.26M
2.39M
2.66M
3.28M
3.24M
3.52M
2.82M
4.23M
4.33M
6.42M
2.30M
2.85M
2.28M
1.94M
2.06M

2025-02-11 11:26:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:26:32 - root - INFO - ```sql
SELECT
    current.ticker,
    current.market_date,
    ((current.volume_numeric - previous.volume_numeric) * 100.0 / previous.volume_numeric) AS percentage_change_in_volume
FROM (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS current
JOIN (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS previous
ON current.ticker = previous.ticker
   AND current.date_formatted = date(previous.date_formatted, '+1 day')
WHERE current.date_formatted BETWEEN '2021-08-02' AND '2021-08-10'
  AND previous.volume_numeric > 0
ORDER BY current.ticker, current.date_formatted
LIMIT 100;
```
2025-02-11 11:27:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:27:13 - root - INFO - SQL:
SELECT
    current.ticker,
    current.market_date,
    ((current.volume_numeric - previous.volume_numeric) * 100.0 / previous.volume_numeric) AS percentage_change_in_volume
FROM (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS current
JOIN (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS previous
ON current.ticker = previous.ticker
   AND current.date_formatted = date(previous.date_formatted, '+1 day')
WHERE current.date_formatted BETWEEN '2021-08-02' AND '2021-08-10'
  AND previous.volume_numeric > 0
ORDER BY current.ticker, current.date_formatted
LIMIT 100;
Results:
ticker,market_date,percentage_change_in_volume
BTC,02-08-2021,-6.8716544254948335
BTC,03-08-2021,-99.65245288063093
BTC,04-08-2021,30369.23076923077
BTC,05-08-2021,64.85735925271396
BTC,06-08-2021,-14.295558958652373
BTC,07-08-2021,0.8130081300813008
BTC,08-08-2021,-6.726338177951082
BTC,09-08-2021,11.239904988123515
BTC,10-08-2021,-31.20088828151691
ETH,02-08-2021,-19.110833333333332
ETH,03-08-2021,-83.6762236393419
ETH,04-08-2021,676.2701167560745
ETH,05-08-2021,34.146341463414636
ETH,06-08-2021,-35.75757575757576
ETH,07-08-2021,-93.88301886792453
ETH,08-08-2021,1827.8223318938926
ETH,09-08-2021,15.2
ETH,10-08-2021,-22.22222222222222

2025-02-11 11:27:13 - root - INFO - SQL:
SELECT DISTINCT "volume" FROM "bitcoin_prices"
   WHERE "volume" LIKE '%K' OR "volume" LIKE '%M'
   LIMIT 100;
Results:
volume
582.04K
466.21K
839.54K
118.44K
923.13K
988.82K
1.09M
747.65K
768.74K
739.32K
844.13K
750.74K
1.06M
859.09K
782.81K
658.60K
795.54K
965.63K
950.12K
1.12M
1.44M
1.25M
64.84K
1.65M
1.23M
158.45K
970.67K
1.20M
507.08K
1.03M
642.75K
968.94K
1.89M
786.94K
907.11K
961.67K
1.02M
1.51M
802.78K
829.77K
623.52K
619.62K
645.06K
1.05M
717.85K
540.10K
724.84K
929.32K
1.42M
1.82M
1.32M
1.78M
822.95K
1.39M
1.28M
1.71M
1.90M
898.06K
2.19M
1.87M
1.99M
1.64M
1.77M
2.84M
2.69M
1.08M
778.79K
1.37M
1.95M
1.79M
1.62M
1.80M
587.18K
1.29M
2.32M
75.18K
3.01M
756.36K
2.55M
2.47M
2.60M
2.45M
2.83M
2.80M
2.94M
3.26M
2.39M
2.66M
3.28M
3.24M
3.52M
2.82M
4.23M
4.33M
6.42M
2.30M
2.85M
2.28M
1.94M
2.06M

2025-02-11 11:27:13 - root - INFO - SQL:
SELECT * FROM "bitcoin_prices"
   WHERE "volume" = '-'
   LIMIT 100;
Results:
ticker,market_date,price,open,high,low,volume,change
ETH,26-11-2017,464.0,464.0,464.0,464.0,-,0.00%

2025-02-11 11:28:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:28:30 - root - INFO - ```sql
SELECT DISTINCT volume
FROM bitcoin_prices
LIMIT 100;
```
2025-02-11 11:29:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:29:16 - root - INFO - SQL:
SELECT DISTINCT volume
FROM bitcoin_prices
LIMIT 100;
Results:
volume
582.04K
466.21K
839.54K
118.44K
923.13K
988.82K
1.09M
747.65K
768.74K
739.32K
844.13K
750.74K
1.06M
859.09K
782.81K
658.60K
795.54K
965.63K
950.12K
1.12M
1.44M
1.25M
64.84K
1.65M
1.23M
158.45K
970.67K
1.20M
507.08K
1.03M
642.75K
968.94K
1.89M
786.94K
907.11K
961.67K
1.02M
1.51M
802.78K
829.77K
623.52K
619.62K
645.06K
1.05M
717.85K
540.10K
724.84K
929.32K
1.42M
1.82M
1.32M
1.78M
822.95K
1.39M
1.28M
1.71M
1.90M
898.06K
2.19M
1.87M
1.99M
1.64M
1.77M
2.84M
2.69M
1.08M
778.79K
1.37M
1.95M
1.79M
1.62M
1.80M
587.18K
1.29M
2.32M
75.18K
3.01M
756.36K
2.55M
2.47M
2.60M
2.45M
2.83M
2.80M
2.94M
3.26M
2.39M
2.66M
3.28M
3.24M
3.52M
2.82M
4.23M
4.33M
6.42M
2.30M
2.85M
2.28M
1.94M
2.06M

2025-02-11 11:29:16 - root - INFO - SQL:
SELECT "volume",
     CASE
       WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
       WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
       WHEN "volume" = '-' THEN 0
       ELSE CAST("volume" AS REAL)
     END AS "volume_numeric"
   FROM "bitcoin_prices"
   LIMIT 100;
Results:
volume,volume_numeric
582.04K,582040.0
466.21K,466210.0
839.54K,839540.0
118.44K,118440.0
923.13K,923130.0
988.82K,988820.0
1.09M,1090000.0
747.65K,747650.0
768.74K,768740.0
739.32K,739320.0
844.13K,844130.0
750.74K,750740.0
1.06M,1060000.0
859.09K,859090.0
782.81K,782810.0
658.60K,658600.0
795.54K,795540.0
965.63K,965630.0
950.12K,950120.0
1.12M,1120000.0
1.44M,1440000.0
1.25M,1250000.0
64.84K,64840.0
1.06M,1060000.0
1.65M,1650000.0
1.23M,1230000.0
158.45K,158450.0
970.67K,970670.0
1.20M,1200000.0
507.08K,507080.0
1.03M,1030000.0
642.75K,642750.0
968.94K,968940.0
1.25M,1250000.0
1.89M,1890000.0
786.94K,786940.0
907.11K,907110.0
961.67K,961670.0
1.02M,1020000.0
1.51M,1510000.0
1.20M,1200000.0
802.78K,802780.0
829.77K,829770.0
623.52K,623520.0
619.62K,619620.0
645.06K,645060.0
1.05M,1050000.0
717.85K,717850.0
540.10K,540100.0
724.84K,724840.0
929.32K,929320.0
1.42M,1420000.0
1.82M,1820000.0
1.32M,1320000.0
1.78M,1780000.0
822.95K,822950.0
1.39M,1390000.0
1.28M,1280000.0
1.39M,1390000.0
1.71M,1710000.0
1.90M,1900000.0
898.06K,898060.0
2.19M,2190000.0
1.87M,1870000.0
1.99M,1990000.0
1.65M,1650000.0
1.64M,1640000.0
1.77M,1770000.0
2.84M,2840000.0
2.69M,2690000.0
1.42M,1420000.0
1.08M,1080000.0
778.79K,778790.0
1.06M,1060000.0
1.37M,1370000.0
1.95M,1950000.0
1.79M,1790000.0
1.62M,1620000.0
1.80M,1800000.0
587.18K,587180.0
1.29M,1290000.0
2.32M,2320000.0
75.18K,75180.0
3.01M,3010000.0
756.36K,756360.0
2.55M,2550000.0
2.47M,2470000.0
1.09M,1090000.0
2.60M,2600000.0
2.45M,2450000.0
2.83M,2830000.0
2.80M,2800000.0
2.94M,2940000.0
3.26M,3260000.0
2.39M,2390000.0
2.66M,2660000.0
3.28M,3280000.0
3.24M,3240000.0
3.52M,3520000.0
2.82M,2820000.0

2025-02-11 11:30:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:30:15 - root - INFO - ```sql
SELECT
    current.ticker,
    current.market_date,
    ((current.volume_numeric - previous.volume_numeric) * 100.0 / previous.volume_numeric) AS percentage_change_in_volume
FROM (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS current
JOIN (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS previous
ON current.ticker = previous.ticker
   AND current.date_formatted = date(previous.date_formatted, '+1 day')
WHERE previous.volume_numeric > 0
ORDER BY current.ticker, current.date_formatted
LIMIT 100;
```
2025-02-11 11:30:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:30:52 - root - INFO - SQL:
SELECT
    current.ticker,
    current.market_date,
    ((current.volume_numeric - previous.volume_numeric) * 100.0 / previous.volume_numeric) AS percentage_change_in_volume
FROM (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS current
JOIN (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS previous
ON current.ticker = previous.ticker
   AND current.date_formatted = date(previous.date_formatted, '+1 day')
WHERE previous.volume_numeric > 0
ORDER BY current.ticker, current.date_formatted
LIMIT 100;
Results:
ticker,market_date,percentage_change_in_volume
BTC,02-01-2017,57.837181044957475
BTC,03-01-2017,-15.642802155504233
BTC,04-01-2017,185.21628034312832
BTC,05-01-2017,53.586740897165164
BTC,06-01-2017,-19.049206283071538
BTC,07-01-2017,-32.75001286736322
BTC,08-01-2017,-41.13730292361855
BTC,09-01-2017,-18.63216746846964
BTC,10-01-2017,-14.173857462448067
BTC,11-01-2017,262.01824613665985
BTC,12-01-2017,-38.16087224850854
BTC,13-01-2017,-25.266134397870925
BTC,14-01-2017,-50.80124638326285
BTC,15-01-2017,-44.80886677222348
BTC,16-01-2017,36.14754098360656
BTC,17-01-2017,147.47140276941602
BTC,18-01-2017,-15.752341564286583
BTC,19-01-2017,-15.62229280970257
BTC,20-01-2017,-33.48733744010951
BTC,21-01-2017,3.884744018523283
BTC,22-01-2017,18.697374938088164
BTC,23-01-2017,-31.692050907573535
BTC,24-01-2017,79.81062919975562
BTC,25-01-2017,-35.62085952097843
BTC,26-01-2017,-10.817941952506596
BTC,27-01-2017,-8.372781065088757
BTC,28-01-2017,-53.7939941879238
BTC,29-01-2017,-22.78127183787561
BTC,30-01-2017,72.48868778280543
BTC,31-01-2017,186.83105981112277
BTC,01-02-2017,-17.285531370038413
BTC,02-02-2017,12.472357363998231
BTC,03-02-2017,21.25442390876917
BTC,04-02-2017,-36.014269498946
BTC,05-02-2017,-21.287379624936644
BTC,06-02-2017,3.090792015453972
BTC,07-02-2017,23.51655215490317
BTC,08-02-2017,64.7281921618205
BTC,09-02-2017,125.24942440521872
BTC,10-02-2017,-57.66269165247019
BTC,11-02-2017,-54.41815548044423
BTC,12-02-2017,-47.916666666666664
BTC,13-02-2017,123.11864406779661
BTC,14-02-2017,20.14585232452142
BTC,15-02-2017,-40.92058674759737
BTC,16-02-2017,63.013698630136986
BTC,17-02-2017,20.03676470588235
BTC,18-02-2017,-44.51979873113105
BTC,19-02-2017,-29.2192429022082
BTC,20-02-2017,72.75766016713092
BTC,21-02-2017,83.97291196388262
BTC,22-02-2017,-16.02103418054338
BTC,23-02-2017,37.215612606971405
BTC,24-02-2017,64.5421356860359
BTC,25-02-2017,-57.60377184062124
BTC,26-02-2017,-32.90449193196685
BTC,27-02-2017,15.274618134546637
BTC,28-02-2017,42.599379757541584
BTC,01-03-2017,1.1269276393831553
BTC,02-03-2017,53.45063538611926
BTC,03-03-2017,-14.282074149573194
BTC,04-03-2017,-42.89536266349584
BTC,05-03-2017,-33.810515356585114
BTC,06-03-2017,22.021234762092018
BTC,07-03-2017,182.694166935224
BTC,08-03-2017,11.582307341541268
BTC,09-03-2017,-38.84348181446669
BTC,10-03-2017,218.19244904777815
BTC,11-03-2017,-62.855042788890636
BTC,12-03-2017,-37.22968197879859
BTC,13-03-2017,36.14050889439316
BTC,14-03-2017,-25.339067151835923
BTC,15-03-2017,-3.433761630482942
BTC,16-03-2017,204.58820830465703
BTC,17-03-2017,23.326052572117195
BTC,18-03-2017,28.508611212898497
BTC,19-03-2017,-49.41070240471438
BTC,20-03-2017,-42.2921559417567
BTC,21-03-2017,50.72440175809865
BTC,22-03-2017,24.51668646722108
BTC,23-03-2017,-50.975800156128024
BTC,24-03-2017,134.6072186836518
BTC,25-03-2017,-4.1855203619909505
BTC,26-03-2017,-32.837465564738295
BTC,27-03-2017,6.949490214461503
BTC,28-03-2017,-12.338373876835416
BTC,29-03-2017,-13.9375
BTC,30-03-2017,8.917937545388526
BTC,31-03-2017,21.336178157087613
BTC,01-04-2017,-44.32355203868557
BTC,02-04-2017,40.11054086063956
BTC,03-04-2017,38.77148492533108
BTC,04-04-2017,-27.918781725888326
BTC,05-04-2017,-2.1549295774647885
BTC,06-04-2017,32.94947459334965
BTC,07-04-2017,-35.30749242096145
BTC,08-04-2017,-44.46861924686193
BTC,09-04-2017,36.678722121760096
BTC,10-04-2017,-11.775082690187432
BTC,11-04-2017,-6.523369157710572

2025-02-11 11:30:52 - root - INFO - SQL:
SELECT * FROM "bitcoin_prices"
    WHERE "volume" != '-' AND "volume" != '0' AND "volume" IS NOT NULL
    LIMIT 100;
Results:
Too long, hard cut:
ticker,market_date,price,open,high,low,volume,change
ETH,29-08-2021,3177.84,3243.96,3282.21,3162.79,582.04K,-2.04%
ETH,28-08-2021,3243.9,3273.78,3284.58,3212.24,466.21K,-0.91%
ETH,27-08-2021,3273.58,3093.78,3279.93,3063.37,839.54K,5.82%
ETH,26-08-2021,3093.54,3228.03,3249.62,3057.48,118.44K,-4.17%
ETH,25-08-2021,3228.15,3172.12,3247.43,3080.7,923.13K,1.73%
ETH,24-08-2021,3173.26,3322.6,3357.99,3150.75,988.82K,-4.41%
ETH,23-08-2021,3319.49,3238.41,3375.42,3231.96,1.09M,2.49%
ETH,22-08-2021,3238.7,3224.17,3271.94,3128.98,747.65K,0.46%
ETH,21-08-2021,3223.96,3285.12,3307.33,3200.19,768.74K,-1.83%
ETH,20-08-2021,3284.21,3184.83,3300.36,3179.18,739.32K,3.12%
ETH,19-08-2021,3184.82,3016.92,3185.51,2962.04,844.13K,5.57%
ETH,18-08-2021,3016.91,3012.62,3124.51,2951.04,750.74K,0.08%
ETH,17-08-2021,3014.58,3147.67,3290.03,2993.63,1.06M,-4.23%
ETH,16-08-2021,3147.65,3307.96,3334.22,3138.37,859.09K,-4.87%
ETH,15-08-2021,3308.87,3264.56,3318.61,3115.34,782.81K,1.35%
ETH,14-08-2021,3264.69,3322.25,3328.38,3209.45,658.60K,-1.74%
ETH,13-08-2021,3322.43,3043.2,3324.53,3035.52,795.54K,9.16%
ETH,12-08-2021,3043.61,3160.17,3236.28,2981.35,965.63K,-3.79%
ETH,11-08-2021,3163.66,3140.86,3269.7,3122.67,950.12K,0.73%
ETH,10-08-2021,3140.71,3162.81,3232.02,3057.84,1.12M,-0.70%
ETH,09-08-2021,3162.93,3011.88,3184.84,2899.24,1.44M,5.01%
ETH,08-08-2021,3012.07,3158.3,3188.49,2949.66,1.25M,-4.62%
ETH,07-08-2021,3158.0,2889.58,3169.74,2867.58,64.84K,9.29%
ETH,06-08-2021,2889.43,2827.23,2946.62,2726.04,1.06M,2.20%
ETH,05-08-2021,2827.21,2725.28,2842.95,2533.51,1.65M,3.74%
ETH,04-08-2021,2725.29,2506.5,2766.46,2462.32,1.23M,8.72%
ETH,03-08-2021,2506.65,2608.01,2631.43,2445.49,158.45K,-3.89%
ETH,02-08-2021,2608.04,2556.07,2664.73,2513.51,970.67K,2.03%
ETH,01-08-2021,2556.23,2530.94,2696.38,2515.26,1.20M,0.95%
ETH,31-07-2021,2532.19,2461.08,2551.68,2421.7,507.08K,2.89%
ETH,30-07-2021,2460.95,2380.59,2467.4,2320.8,1.03M,3.36%
ETH,29-07-2021,2380.93,2299.46,2397.71,2269.15,642.75K,3.56%
ETH,28-07-2021,2299.11,2300.21,2343.49,2246.23,968.94K,-0.05%
ETH,27-07-2021,2300.22,2230.24,2318.68,2152.92,1.25M,3.17%
ETH,26-07-2021,2229.53,2189.74,2430.01,2174.44,1.89M,1.81%
ETH,25-07-2021,2189.79,2166.98,2195.03,2108.74,786.94K,1.76%
ETH,24-07-2021,2151.85,2124.0,2162.29,2106.71,907.11K,1.33%
ETH,23-07-2021,2123.61,2024.51,2129.66,2000.27,961.67K,4.89%
ETH,22-07-2021,2024.58,1994.61,2043.26,1952.31,1.02M,1.51%
ETH,21-07-2021,1994.49,1786.18,2029.51,1758.64,1.51M,11.67%
ETH,20-07-2021,1786.07,1818.07,1840.36,1720.7,1.20M,-1.76%
ETH,19-07-2021,1818.07,1891.43,1915.15,1807.19,802.78K,-3.93%
ETH,18-07-2021,1892.42,1898.01,1988.24,1881.6,829.77K,-0.29%
ETH,17-07-2021,1897.98,1877.0,1917.8,1851.97,623.52K,1.05%
ETH,16-07-2021,1878.2,1917.21,1960.21,1852.42,619.62K,-2.03%
ETH,15-07-2021,1917.21,1994.73,2038.91,1884.81,645.06K,-3.88%
ETH,14-07-2021,1994.64,1940.48,2017.99,1868.45,1.05M,2.78%
ETH,13-07-2021,1940.72,2035.09,2042.61,1920.62,717.85K,-4.64%
ETH,12-07-2021,2035.09,2139.44,2167.6,2008.66,540.10K,-4.87%
ETH,11-07-2021,2139.35,2110.9,2173.34,2081.62,724.84K,1.34%
ETH,10-07-2021,2111.12,2146.15,2191.3,2078.43,929.32K,-1.62%
ETH,09-07-2021,2145.89,2120.05,2185.62,2066.09,1.42M,1.21%
ETH,08-07-2021,2120.22,2316.21,2322.47,2095.92,1.82M,-8.48%
ETH,07-07-2021,2316.57,2322.74,2402.68,2296.43,1.32M,-0.26%
ETH,06-07-2021,2322.72,2196.25,2347.47,2194.2,1.78M,5.76%
ETH,05-07-2021,2196.16,2322.6,2322.6,2163.09,822.95K,-5.47%
ETH,04-07-2021,2323.22,2224.7,2386.2,2222.95,1.39M,4.43%
ETH,03-07-2021,2224.7,2154.53,2236.97,2115.8,1.28M,3.25%
ETH,02-07-2021,2154.78,2108.58,2158.7,2019.75,1.39M,2.17%
ETH,01-07-2021,2109.11,2274.5,2274.63,2077.56,1.71M,-7.24%
ETH,30-06-2021,2273.84,2158.32,2281.55,2090.61,1.90M,5.33%
ETH,29-06-2021,2158.71,2083.48,2241.86,2076.17,898.06K,3.63%
ETH,28-06-2021,2083.09,1981.24,2142.84,1962.89,2.19M,5.21%
ETH,27-06-2021,1979.88,1830.42,1980.7,1808.59,1.87M,8.15%
ETH,26-06-2021,1830.62,1810.53,1850.4,1719.32,1.99M,1.11%
ETH,25-06-2021,1810.57,1989.77,2017.47,1793.47,1.65M,-8.98%
ETH,24-06-2021,1989.14,1968.76,2033.96,1886.74,1.64M,1.05%
ETH,23-06-2021,1968.39,1877.28,2043.1,1823.57,1.77M,4.89%
ETH,22-06-2021,1876.66,1890.95,1994.32,1707.24,2.84M,-0.77%
ETH,21-06-2021,1891.18,2244.25,2257.86,1868.32,2.69M,-15.72%
ETH,20-06-2021,2243.86,2166.3,2276.83,2045.03,1.42M,3.55%
ETH,19-06-2021,2166.91,2229.53,2276.7,2164.14,1.08M,-2.81%
ETH,18-06-2021,2229.53,2372.1,2376.62,2142.74,778.79K,-5.99%
ETH,17-06-2021,2371.62,2367.78,2459.11,2309.08,1.06M,0.18%
ETH,16-06-2021,2367.28,2544.35,2552.12,2353.24,1.37M,-6.94%
ETH,15-06-2021,2543.83,2581.42,2637.9,2512.39,1.95M,-1.46%
ETH,14-06-2021,2581.48,2508.49,2606.91,2467.61,1.79M,2.92%
ETH,13-06-2021,2508.27,2368.68,2547.9,2311.96,1.62M,5.90%
ETH,12-06-2021,2368.47,2351.45,2448.04,2260.8,1.80M,0.72%
ETH,11-06-2021,2351.45,2470.04,2493.48,2324.21,587.18K,-4.80%
ETH,10-06-2021,2469.97,2607.45,2615.46,2432.41,1.29M,-5.23%
ETH,09-06-2021,2606.23,2507.86,2620.74,2408.37,2.32M,3.81%
ETH,08-06-2021,2510.65,2592.12,2618

2025-02-11 11:31:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:31:23 - root - INFO - ```sql
SELECT * FROM bitcoin_prices
LIMIT 100;
```
2025-02-11 11:31:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:31:38 - root - INFO - SQL:
SELECT * FROM bitcoin_prices
LIMIT 100;
Results:
Too long, hard cut:
ticker,market_date,price,open,high,low,volume,change
ETH,29-08-2021,3177.84,3243.96,3282.21,3162.79,582.04K,-2.04%
ETH,28-08-2021,3243.9,3273.78,3284.58,3212.24,466.21K,-0.91%
ETH,27-08-2021,3273.58,3093.78,3279.93,3063.37,839.54K,5.82%
ETH,26-08-2021,3093.54,3228.03,3249.62,3057.48,118.44K,-4.17%
ETH,25-08-2021,3228.15,3172.12,3247.43,3080.7,923.13K,1.73%
ETH,24-08-2021,3173.26,3322.6,3357.99,3150.75,988.82K,-4.41%
ETH,23-08-2021,3319.49,3238.41,3375.42,3231.96,1.09M,2.49%
ETH,22-08-2021,3238.7,3224.17,3271.94,3128.98,747.65K,0.46%
ETH,21-08-2021,3223.96,3285.12,3307.33,3200.19,768.74K,-1.83%
ETH,20-08-2021,3284.21,3184.83,3300.36,3179.18,739.32K,3.12%
ETH,19-08-2021,3184.82,3016.92,3185.51,2962.04,844.13K,5.57%
ETH,18-08-2021,3016.91,3012.62,3124.51,2951.04,750.74K,0.08%
ETH,17-08-2021,3014.58,3147.67,3290.03,2993.63,1.06M,-4.23%
ETH,16-08-2021,3147.65,3307.96,3334.22,3138.37,859.09K,-4.87%
ETH,15-08-2021,3308.87,3264.56,3318.61,3115.34,782.81K,1.35%
ETH,14-08-2021,3264.69,3322.25,3328.38,3209.45,658.60K,-1.74%
ETH,13-08-2021,3322.43,3043.2,3324.53,3035.52,795.54K,9.16%
ETH,12-08-2021,3043.61,3160.17,3236.28,2981.35,965.63K,-3.79%
ETH,11-08-2021,3163.66,3140.86,3269.7,3122.67,950.12K,0.73%
ETH,10-08-2021,3140.71,3162.81,3232.02,3057.84,1.12M,-0.70%
ETH,09-08-2021,3162.93,3011.88,3184.84,2899.24,1.44M,5.01%
ETH,08-08-2021,3012.07,3158.3,3188.49,2949.66,1.25M,-4.62%
ETH,07-08-2021,3158.0,2889.58,3169.74,2867.58,64.84K,9.29%
ETH,06-08-2021,2889.43,2827.23,2946.62,2726.04,1.06M,2.20%
ETH,05-08-2021,2827.21,2725.28,2842.95,2533.51,1.65M,3.74%
ETH,04-08-2021,2725.29,2506.5,2766.46,2462.32,1.23M,8.72%
ETH,03-08-2021,2506.65,2608.01,2631.43,2445.49,158.45K,-3.89%
ETH,02-08-2021,2608.04,2556.07,2664.73,2513.51,970.67K,2.03%
ETH,01-08-2021,2556.23,2530.94,2696.38,2515.26,1.20M,0.95%
ETH,31-07-2021,2532.19,2461.08,2551.68,2421.7,507.08K,2.89%
ETH,30-07-2021,2460.95,2380.59,2467.4,2320.8,1.03M,3.36%
ETH,29-07-2021,2380.93,2299.46,2397.71,2269.15,642.75K,3.56%
ETH,28-07-2021,2299.11,2300.21,2343.49,2246.23,968.94K,-0.05%
ETH,27-07-2021,2300.22,2230.24,2318.68,2152.92,1.25M,3.17%
ETH,26-07-2021,2229.53,2189.74,2430.01,2174.44,1.89M,1.81%
ETH,25-07-2021,2189.79,2166.98,2195.03,2108.74,786.94K,1.76%
ETH,24-07-2021,2151.85,2124.0,2162.29,2106.71,907.11K,1.33%
ETH,23-07-2021,2123.61,2024.51,2129.66,2000.27,961.67K,4.89%
ETH,22-07-2021,2024.58,1994.61,2043.26,1952.31,1.02M,1.51%
ETH,21-07-2021,1994.49,1786.18,2029.51,1758.64,1.51M,11.67%
ETH,20-07-2021,1786.07,1818.07,1840.36,1720.7,1.20M,-1.76%
ETH,19-07-2021,1818.07,1891.43,1915.15,1807.19,802.78K,-3.93%
ETH,18-07-2021,1892.42,1898.01,1988.24,1881.6,829.77K,-0.29%
ETH,17-07-2021,1897.98,1877.0,1917.8,1851.97,623.52K,1.05%
ETH,16-07-2021,1878.2,1917.21,1960.21,1852.42,619.62K,-2.03%
ETH,15-07-2021,1917.21,1994.73,2038.91,1884.81,645.06K,-3.88%
ETH,14-07-2021,1994.64,1940.48,2017.99,1868.45,1.05M,2.78%
ETH,13-07-2021,1940.72,2035.09,2042.61,1920.62,717.85K,-4.64%
ETH,12-07-2021,2035.09,2139.44,2167.6,2008.66,540.10K,-4.87%
ETH,11-07-2021,2139.35,2110.9,2173.34,2081.62,724.84K,1.34%
ETH,10-07-2021,2111.12,2146.15,2191.3,2078.43,929.32K,-1.62%
ETH,09-07-2021,2145.89,2120.05,2185.62,2066.09,1.42M,1.21%
ETH,08-07-2021,2120.22,2316.21,2322.47,2095.92,1.82M,-8.48%
ETH,07-07-2021,2316.57,2322.74,2402.68,2296.43,1.32M,-0.26%
ETH,06-07-2021,2322.72,2196.25,2347.47,2194.2,1.78M,5.76%
ETH,05-07-2021,2196.16,2322.6,2322.6,2163.09,822.95K,-5.47%
ETH,04-07-2021,2323.22,2224.7,2386.2,2222.95,1.39M,4.43%
ETH,03-07-2021,2224.7,2154.53,2236.97,2115.8,1.28M,3.25%
ETH,02-07-2021,2154.78,2108.58,2158.7,2019.75,1.39M,2.17%
ETH,01-07-2021,2109.11,2274.5,2274.63,2077.56,1.71M,-7.24%
ETH,30-06-2021,2273.84,2158.32,2281.55,2090.61,1.90M,5.33%
ETH,29-06-2021,2158.71,2083.48,2241.86,2076.17,898.06K,3.63%
ETH,28-06-2021,2083.09,1981.24,2142.84,1962.89,2.19M,5.21%
ETH,27-06-2021,1979.88,1830.42,1980.7,1808.59,1.87M,8.15%
ETH,26-06-2021,1830.62,1810.53,1850.4,1719.32,1.99M,1.11%
ETH,25-06-2021,1810.57,1989.77,2017.47,1793.47,1.65M,-8.98%
ETH,24-06-2021,1989.14,1968.76,2033.96,1886.74,1.64M,1.05%
ETH,23-06-2021,1968.39,1877.28,2043.1,1823.57,1.77M,4.89%
ETH,22-06-2021,1876.66,1890.95,1994.32,1707.24,2.84M,-0.77%
ETH,21-06-2021,1891.18,2244.25,2257.86,1868.32,2.69M,-15.72%
ETH,20-06-2021,2243.86,2166.3,2276.83,2045.03,1.42M,3.55%
ETH,19-06-2021,2166.91,2229.53,2276.7,2164.14,1.08M,-2.81%
ETH,18-06-2021,2229.53,2372.1,2376.62,2142.74,778.79K,-5.99%
ETH,17-06-2021,2371.62,2367.78,2459.11,2309.08,1.06M,0.18%
ETH,16-06-2021,2367.28,2544.35,2552.12,2353.24,1.37M,-6.94%
ETH,15-06-2021,2543.83,2581.42,2637.9,2512.39,1.95M,-1.46%
ETH,14-06-2021,2581.48,2508.49,2606.91,2467.61,1.79M,2.92%
ETH,13-06-2021,2508.27,2368.68,2547.9,2311.96,1.62M,5.90%
ETH,12-06-2021,2368.47,2351.45,2448.04,2260.8,1.80M,0.72%
ETH,11-06-2021,2351.45,2470.04,2493.48,2324.21,587.18K,-4.80%
ETH,10-06-2021,2469.97,2607.45,2615.46,2432.41,1.29M,-5.23%
ETH,09-06-2021,2606.23,2507.86,2620.74,2408.37,2.32M,3.81%
ETH,08-06-2021,2510.65,2592.12,2618

2025-02-11 11:31:38 - root - INFO - SQL:
SELECT "market_date",
      substr("market_date", 1, 4) AS "year",
      substr("market_date", 6, 2) AS "month",
      substr("market_date", 9, 2) AS "day"
    FROM "bitcoin_prices"
    LIMIT 100;
Results:
market_date,year,month,day
29-08-2021,29-0,-2,21
28-08-2021,28-0,-2,21
27-08-2021,27-0,-2,21
26-08-2021,26-0,-2,21
25-08-2021,25-0,-2,21
24-08-2021,24-0,-2,21
23-08-2021,23-0,-2,21
22-08-2021,22-0,-2,21
21-08-2021,21-0,-2,21
20-08-2021,20-0,-2,21
19-08-2021,19-0,-2,21
18-08-2021,18-0,-2,21
17-08-2021,17-0,-2,21
16-08-2021,16-0,-2,21
15-08-2021,15-0,-2,21
14-08-2021,14-0,-2,21
13-08-2021,13-0,-2,21
12-08-2021,12-0,-2,21
11-08-2021,11-0,-2,21
10-08-2021,10-0,-2,21
09-08-2021,09-0,-2,21
08-08-2021,08-0,-2,21
07-08-2021,07-0,-2,21
06-08-2021,06-0,-2,21
05-08-2021,05-0,-2,21
04-08-2021,04-0,-2,21
03-08-2021,03-0,-2,21
02-08-2021,02-0,-2,21
01-08-2021,01-0,-2,21
31-07-2021,31-0,-2,21
30-07-2021,30-0,-2,21
29-07-2021,29-0,-2,21
28-07-2021,28-0,-2,21
27-07-2021,27-0,-2,21
26-07-2021,26-0,-2,21
25-07-2021,25-0,-2,21
24-07-2021,24-0,-2,21
23-07-2021,23-0,-2,21
22-07-2021,22-0,-2,21
21-07-2021,21-0,-2,21
20-07-2021,20-0,-2,21
19-07-2021,19-0,-2,21
18-07-2021,18-0,-2,21
17-07-2021,17-0,-2,21
16-07-2021,16-0,-2,21
15-07-2021,15-0,-2,21
14-07-2021,14-0,-2,21
13-07-2021,13-0,-2,21
12-07-2021,12-0,-2,21
11-07-2021,11-0,-2,21
10-07-2021,10-0,-2,21
09-07-2021,09-0,-2,21
08-07-2021,08-0,-2,21
07-07-2021,07-0,-2,21
06-07-2021,06-0,-2,21
05-07-2021,05-0,-2,21
04-07-2021,04-0,-2,21
03-07-2021,03-0,-2,21
02-07-2021,02-0,-2,21
01-07-2021,01-0,-2,21
30-06-2021,30-0,-2,21
29-06-2021,29-0,-2,21
28-06-2021,28-0,-2,21
27-06-2021,27-0,-2,21
26-06-2021,26-0,-2,21
25-06-2021,25-0,-2,21
24-06-2021,24-0,-2,21
23-06-2021,23-0,-2,21
22-06-2021,22-0,-2,21
21-06-2021,21-0,-2,21
20-06-2021,20-0,-2,21
19-06-2021,19-0,-2,21
18-06-2021,18-0,-2,21
17-06-2021,17-0,-2,21
16-06-2021,16-0,-2,21
15-06-2021,15-0,-2,21
14-06-2021,14-0,-2,21
13-06-2021,13-0,-2,21
12-06-2021,12-0,-2,21
11-06-2021,11-0,-2,21
10-06-2021,10-0,-2,21
09-06-2021,09-0,-2,21
08-06-2021,08-0,-2,21
07-06-2021,07-0,-2,21
06-06-2021,06-0,-2,21
05-06-2021,05-0,-2,21
04-06-2021,04-0,-2,21
03-06-2021,03-0,-2,21
02-06-2021,02-0,-2,21
01-06-2021,01-0,-2,21
31-05-2021,31-0,-2,21
30-05-2021,30-0,-2,21
29-05-2021,29-0,-2,21
28-05-2021,28-0,-2,21
27-05-2021,27-0,-2,21
26-05-2021,26-0,-2,21
25-05-2021,25-0,-2,21
24-05-2021,24-0,-2,21
23-05-2021,23-0,-2,21
22-05-2021,22-0,-2,21

2025-02-11 11:31:38 - root - INFO - itercount: 0
2025-02-11 11:31:38 - root - INFO - Table: weekly_salesDDL:
CREATE TABLE "weekly_sales" (
"week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER
)
Table: shopping_cart_usersDDL:
CREATE TABLE "shopping_cart_users" (
"user_id" INTEGER,
  "cookie_id" TEXT,
  "start_date" TEXT
)
Table: bitcoin_membersDDL:
CREATE TABLE "bitcoin_members" (
"member_id" TEXT,
  "first_name" TEXT,
  "region" TEXT
)
Table: interest_metricsDDL:
CREATE TABLE "interest_metrics" (
"_month" REAL,
  "_year" REAL,
  "month_year" TEXT,
  "interest_id" REAL,
  "composition" REAL,
  "index_value" REAL,
  "ranking" INTEGER,
  "percentile_ranking" REAL
)
Table: customer_regionsDDL:
CREATE TABLE "customer_regions" (
"region_id" INTEGER,
  "region_name" TEXT
)
Table: customer_transactionsDDL:
CREATE TABLE "customer_transactions" (
"customer_id" INTEGER,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "txn_amount" INTEGER
)
Table: bitcoin_transactionsDDL:
CREATE TABLE "bitcoin_transactions" (
"txn_id" INTEGER,
  "member_id" TEXT,
  "ticker" TEXT,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "quantity" REAL,
  "percentage_fee" REAL,
  "txn_time" TEXT
)
Table: customer_nodesDDL:
CREATE TABLE "customer_nodes" (
"customer_id" INTEGER,
  "region_id" INTEGER,
  "node_id" INTEGER,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: cleaned_weekly_salesDDL:
CREATE TABLE "cleaned_weekly_sales" (
"week_date_formatted" TEXT,
  "week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER,
  "week_number" INTEGER,
  "month_number" INTEGER,
  "calendar_year" INTEGER,
  "age_band" TEXT,
  "demographic" TEXT,
  "avg_transaction" REAL
)
Table: veg_txn_dfDDL:
CREATE TABLE "veg_txn_df" (
"index" INTEGER,
  "txn_date" TEXT,
  "txn_time" TEXT,
  "item_code" INTEGER,
  "qty_sold(kg)" REAL,
  "unit_selling_px_rmb/kg" REAL,
  "sale/return" TEXT,
  "discount(%)" INTEGER,
  "day_of_week" TEXT
)
Table: shopping_cart_eventsDDL:
CREATE TABLE "shopping_cart_events" (
"visit_id" TEXT,
  "cookie_id" TEXT,
  "page_id" INTEGER,
  "event_type" INTEGER,
  "sequence_number" INTEGER,
  "event_time" TEXT
)
Table: shopping_cart_page_hierarchyDDL:
CREATE TABLE "shopping_cart_page_hierarchy" (
"page_id" INTEGER,
  "page_name" TEXT,
  "product_category" TEXT,
  "product_id" REAL
)
Table: bitcoin_pricesDDL:
CREATE TABLE "bitcoin_prices" (
"ticker" TEXT,
  "market_date" TEXT,
  "price" REAL,
  "open" REAL,
  "high" REAL,
  "low" REAL,
  "volume" TEXT,
  "change" TEXT
)
Table: interest_mapDDL:
CREATE TABLE "interest_map" (
"id" INTEGER,
  "interest_name" TEXT,
  "interest_summary" TEXT,
  "created_at" TEXT,
  "last_modified" TEXT
)
Table: veg_loss_rate_dfDDL:
CREATE TABLE "veg_loss_rate_df" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "loss_rate_%" REAL
)
Table: shopping_cart_campaign_identifierDDL:
CREATE TABLE "shopping_cart_campaign_identifier" (
"campaign_id" INTEGER,
  "products" TEXT,
  "campaign_name" TEXT,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: veg_catDDL:
CREATE TABLE "veg_cat" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "category_code" INTEGER,
  "category_name" TEXT
)
Table: veg_whsle_dfDDL:
CREATE TABLE "veg_whsle_df" (
"index" INTEGER,
  "whsle_date" TEXT,
  "item_code" INTEGER,
  "whsle_px_rmb-kg" REAL
)
Table: shopping_cart_event_identifierDDL:
CREATE TABLE "shopping_cart_event_identifier" (
"event_type" INTEGER,
  "event_name" TEXT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['weekly_sales', 'shopping_cart_users', 'bitcoin_members', 'interest_metrics', 'customer_regions', 'customer_transactions', 'bitcoin_transactions', 'customer_nodes', 'cleaned_weekly_sales', 'veg_txn_df', 'shopping_cart_events', 'shopping_cart_page_hierarchy', 'bitcoin_prices', 'interest_map', 'veg_loss_rate_df', 'shopping_cart_campaign_identifier', 'veg_cat', 'veg_whsle_df', 'shopping_cart_event_identifier']
Begin Exploring Related Columns
**Relevant Table and Columns:**

- **Table:** `bitcoin_prices`

- **Columns and Potential Usage:**
  - **`"ticker"`**: The cryptocurrency ticker symbol. *Used to group data by each cryptocurrency.*
  - **`"market_date"`**: The date of the market data. *Used to filter records between August 1 and August 10, 2021, and to order results by ticker and date.*
  - **`"volume"`**: The trading volume for each ticker on each date. *Used to calculate daily percentage changes in trading volume.*
  - **`"price"`, `"open"`, `"high"`, `"low"`**: Price data. *Not directly relevant to the volume change calculation.*

- **Conditions that may be used:**
  - Filter records where `"market_date"` is between '2021-08-01' and '2021-08-10'.
  - Handle `"volume"` values ending with "K" or "M" by converting them to numerical values (thousands or millions).
  - Treat any `"volume"` values of "-" as zero.
  - Use only non-zero `"volume"` values to determine the previous day's volume.
  - Order results by `"ticker"` and `"market_date"`.

---

**SQL Queries to Explore the Data:**

1. **List all distinct tickers in the `bitcoin_prices` table:**

   ```sql
   SELECT DISTINCT "ticker" FROM "bitcoin_prices" LIMIT 100;
   ```

2. **Preview records between August 1 and August 10, 2021:**

   ```sql
   SELECT * FROM "bitcoin_prices"
   WHERE "market_date" BETWEEN '2021-08-01' AND '2021-08-10'
   LIMIT 100;
   ```

3. **List distinct volume values to understand the format:**

   ```sql
   SELECT DISTINCT "volume" FROM "bitcoin_prices" LIMIT 100;
   ```

4. **List distinct volume values between August 1 and August 10, 2021:**

   ```sql
   SELECT DISTINCT "volume" FROM "bitcoin_prices"
   WHERE "market_date" BETWEEN '2021-08-01' AND '2021-08-10'
   LIMIT 100;
   ```

5. **Find volumes ending with 'K' (thousands) or 'M' (millions):**

   ```sql
   SELECT DISTINCT "volume" FROM "bitcoin_prices"
   WHERE "volume" LIKE '%K' OR "volume" LIKE '%M'
   LIMIT 100;
   ```

6. **Select records where volume is '-', which should be treated as zero:**

   ```sql
   SELECT * FROM "bitcoin_prices"
   WHERE "volume" = '-'
   LIMIT 100;
   ```

7. **Identify tickers and dates with zero or missing volumes between August 1 and August 10, 2021:**

   ```sql
   SELECT "ticker", "market_date", "volume" FROM "bitcoin_prices"
   WHERE ("volume" = '-' OR "volume" IS NULL)
   AND "market_date" BETWEEN '2021-08-01' AND '2021-08-10'
   LIMIT 100;
   ```

8. **Extract numeric volume values after converting 'K' and 'M' suffixes:**

   ```sql
   SELECT "volume",
     CASE
       WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
       WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
       WHEN "volume" = '-' THEN 0
       ELSE CAST("volume" AS REAL)
     END AS "volume_numeric"
   FROM "bitcoin_prices"
   LIMIT 100;
   ```

9. **Select tickers, dates, and numeric volumes between August 1 and August 10, 2021:**

   ```sql
   SELECT "ticker", "market_date",
     CASE
       WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
       WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
       WHEN "volume" = '-' THEN 0
       ELSE CAST("volume" AS REAL)
     END AS "volume_numeric"
   FROM "bitcoin_prices"
   WHERE "market_date" BETWEEN '2021-08-01' AND '2021-08-10'
   ORDER BY "ticker", "market_date"
   LIMIT 100;
   ```

10. **Find non-zero volumes to be used for calculating previous day's volume:**

    ```sql
    SELECT * FROM "bitcoin_prices"
    WHERE "volume" != '-' AND "volume" != '0' AND "volume" IS NOT NULL
    LIMIT 100;
    ```

11. **Attempt to compute previous day's volume for each ticker and date (joining on previous date):**

    ```sql
    SELECT
      current."ticker",
      current."market_date",
      current."volume" AS "current_volume",
      previous."volume" AS "previous_volume"
    FROM "bitcoin_prices" AS current
    JOIN "bitcoin_prices" AS previous
      ON current."ticker" = previous."ticker"
      AND date(previous."market_date", '+1 day') = date(current."market_date")
    WHERE current."market_date" BETWEEN '2021-08-01' AND '2021-08-10'
    ORDER BY current."ticker", current."market_date"
    LIMIT 100;
    ```

12. **Check the date format and extract year, month, and day parts:**

    ```sql
    SELECT "market_date",
      substr("market_date", 1, 4) AS "year",
      substr("market_date", 6, 2) AS "month",
      substr("market_date", 9, 2) AS "day"
    FROM "bitcoin_prices"
    LIMIT 100;
    ```

---

These SQL queries help us understand the structure and content of the `bitcoin_prices` table, particularly focusing on the `"volume"` column and how it can be manipulated to calculate the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021. By exploring the data formats, handling special cases like volumes ending with 'K' or 'M', and identifying non-zero volumes, we can prepare the data for the required calculations.Query:
SELECT DISTINCT "ticker" FROM "bitcoin_prices" LIMIT 100;
Answer:
ticker
ETH
BTC
Query:
SELECT
  "ticker",
  "market_date",
  CASE
    WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
    WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
    WHEN "volume" = '-' THEN 0
    ELSE CAST("volume" AS REAL)
  END AS "volume_numeric"
FROM "bitcoin_prices"
ORDER BY "ticker", "market_date"
LIMIT 100;
Answer:
ticker,market_date,volume_numeric
BTC,01-01-2017,41150.0
BTC,01-01-2018,78430.0
BTC,01-01-2019,469110.0
BTC,01-01-2020,420280.0
BTC,01-01-2021,100900.0
BTC,01-02-2017,45220.0
BTC,01-02-2018,358400.0
BTC,01-02-2019,481580.0
BTC,01-02-2020,458420.0
BTC,01-02-2021,126320.0
BTC,01-03-2017,51150.0
BTC,01-03-2018,188770.0
BTC,01-03-2019,1740000.0
BTC,01-03-2020,784050.0
BTC,01-03-2021,137520.0
BTC,01-04-2017,50660.0
BTC,01-04-2018,257529.99999999997
BTC,01-04-2019,3220000.0
BTC,01-04-2020,1400000.0
BTC,01-04-2021,69040.0
BTC,01-05-2017,100440.0
BTC,01-05-2018,173350.0
BTC,01-05-2019,623640.0
BTC,01-05-2020,1110000.0
BTC,01-05-2021,63410.0
BTC,01-06-2017,122700.0
BTC,01-06-2018,135920.0
BTC,01-06-2019,686750.0
BTC,01-06-2020,796680.0
BTC,01-06-2021,113480.0
BTC,01-07-2017,66320.0
BTC,01-07-2018,128509.99999999999
BTC,01-07-2019,1040000.0
BTC,01-07-2020,366780.0
BTC,01-07-2021,27410.0
BTC,01-08-2017,123170.0
BTC,01-08-2018,237690.0
BTC,01-08-2019,608370.0
BTC,01-08-2020,611470.0
BTC,01-08-2021,80330.0
BTC,01-09-2017,102010.0
BTC,01-09-2018,3520000.0
BTC,01-09-2019,322660.0
BTC,01-09-2020,580690.0
BTC,01-10-2017,60580.0
BTC,01-10-2018,9190000.0
BTC,01-10-2019,533950.0
BTC,01-10-2020,95330.0
BTC,01-11-2017,133190.0
BTC,01-11-2018,124160.0
BTC,01-11-2019,689650.0
BTC,01-11-2020,51710.0
BTC,01-12-2017,131920.0
BTC,01-12-2018,316300.0
BTC,01-12-2019,777000.0
BTC,01-12-2020,208720.0
BTC,02-01-2017,64950.0
BTC,02-01-2018,137730.0
BTC,02-01-2019,554470.0
BTC,02-01-2020,632780.0
BTC,02-01-2021,240870.0
BTC,02-02-2017,50860.0
BTC,02-02-2018,519400.0
BTC,02-02-2019,443600.0
BTC,02-02-2020,683370.0
BTC,02-02-2021,120850.0
BTC,02-03-2017,78490.0
BTC,02-03-2018,201690.0
BTC,02-03-2019,1610000.0
BTC,02-03-2020,1020000.0
BTC,02-03-2021,102100.0
BTC,02-04-2017,70980.0
BTC,02-04-2018,199310.0
BTC,02-04-2019,14770000.0
BTC,02-04-2020,1740000.0
BTC,02-04-2021,72370.0
BTC,02-05-2017,70010.0
BTC,02-05-2018,137480.0
BTC,02-05-2019,722230.0
BTC,02-05-2020,890340.0
BTC,02-05-2021,53610.0
BTC,02-06-2017,83030.0
BTC,02-06-2018,121180.0
BTC,02-06-2019,614540.0
BTC,02-06-2020,1060000.0
BTC,02-06-2021,96890.0
BTC,02-07-2017,67760.0
BTC,02-07-2018,179920.0
BTC,02-07-2019,1120000.0
BTC,02-07-2020,483100.0
BTC,02-07-2021,78930.0
BTC,02-08-2017,81820.0
BTC,02-08-2018,216340.0
BTC,02-08-2019,578290.0
BTC,02-08-2020,647950.0
BTC,02-08-2021,74810.0
BTC,02-09-2017,160770.0
BTC,02-09-2018,3900000.0
BTC,02-09-2019,542790.0
BTC,02-09-2020,20260000.0
Query:
SELECT DISTINCT "volume" FROM "bitcoin_prices" LIMIT 100;
Answer:
volume
582.04K
466.21K
839.54K
118.44K
923.13K
988.82K
1.09M
747.65K
768.74K
739.32K
844.13K
750.74K
1.06M
859.09K
782.81K
658.60K
795.54K
965.63K
950.12K
1.12M
1.44M
1.25M
64.84K
1.65M
1.23M
158.45K
970.67K
1.20M
507.08K
1.03M
642.75K
968.94K
1.89M
786.94K
907.11K
961.67K
1.02M
1.51M
802.78K
829.77K
623.52K
619.62K
645.06K
1.05M
717.85K
540.10K
724.84K
929.32K
1.42M
1.82M
1.32M
1.78M
822.95K
1.39M
1.28M
1.71M
1.90M
898.06K
2.19M
1.87M
1.99M
1.64M
1.77M
2.84M
2.69M
1.08M
778.79K
1.37M
1.95M
1.79M
1.62M
1.80M
587.18K
1.29M
2.32M
75.18K
3.01M
756.36K
2.55M
2.47M
2.60M
2.45M
2.83M
2.80M
2.94M
3.26M
2.39M
2.66M
3.28M
3.24M
3.52M
2.82M
4.23M
4.33M
6.42M
2.30M
2.85M
2.28M
1.94M
2.06M
Query:
SELECT
    current.ticker,
    current.market_date,
    ((current.volume_numeric - previous.volume_numeric) * 100.0 / previous.volume_numeric) AS percentage_change_in_volume
FROM (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS current
JOIN (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS previous
ON current.ticker = previous.ticker
   AND current.date_formatted = date(previous.date_formatted, '+1 day')
WHERE current.date_formatted BETWEEN '2021-08-02' AND '2021-08-10'
  AND previous.volume_numeric > 0
ORDER BY current.ticker, current.date_formatted
LIMIT 100;
Answer:
ticker,market_date,percentage_change_in_volume
BTC,02-08-2021,-6.8716544254948335
BTC,03-08-2021,-99.65245288063093
BTC,04-08-2021,30369.23076923077
BTC,05-08-2021,64.85735925271396
BTC,06-08-2021,-14.295558958652373
BTC,07-08-2021,0.8130081300813008
BTC,08-08-2021,-6.726338177951082
BTC,09-08-2021,11.239904988123515
BTC,10-08-2021,-31.20088828151691
ETH,02-08-2021,-19.110833333333332
ETH,03-08-2021,-83.6762236393419
ETH,04-08-2021,676.2701167560745
ETH,05-08-2021,34.146341463414636
ETH,06-08-2021,-35.75757575757576
ETH,07-08-2021,-93.88301886792453
ETH,08-08-2021,1827.8223318938926
ETH,09-08-2021,15.2
ETH,10-08-2021,-22.22222222222222
Query:
SELECT DISTINCT "volume" FROM "bitcoin_prices"
   WHERE "volume" LIKE '%K' OR "volume" LIKE '%M'
   LIMIT 100;
Answer:
volume
582.04K
466.21K
839.54K
118.44K
923.13K
988.82K
1.09M
747.65K
768.74K
739.32K
844.13K
750.74K
1.06M
859.09K
782.81K
658.60K
795.54K
965.63K
950.12K
1.12M
1.44M
1.25M
64.84K
1.65M
1.23M
158.45K
970.67K
1.20M
507.08K
1.03M
642.75K
968.94K
1.89M
786.94K
907.11K
961.67K
1.02M
1.51M
802.78K
829.77K
623.52K
619.62K
645.06K
1.05M
717.85K
540.10K
724.84K
929.32K
1.42M
1.82M
1.32M
1.78M
822.95K
1.39M
1.28M
1.71M
1.90M
898.06K
2.19M
1.87M
1.99M
1.64M
1.77M
2.84M
2.69M
1.08M
778.79K
1.37M
1.95M
1.79M
1.62M
1.80M
587.18K
1.29M
2.32M
75.18K
3.01M
756.36K
2.55M
2.47M
2.60M
2.45M
2.83M
2.80M
2.94M
3.26M
2.39M
2.66M
3.28M
3.24M
3.52M
2.82M
4.23M
4.33M
6.42M
2.30M
2.85M
2.28M
1.94M
2.06M
Query:
SELECT * FROM "bitcoin_prices"
   WHERE "volume" = '-'
   LIMIT 100;
Answer:
ticker,market_date,price,open,high,low,volume,change
ETH,26-11-2017,464.0,464.0,464.0,464.0,-,0.00%
Query:
SELECT DISTINCT volume
FROM bitcoin_prices
LIMIT 100;
Answer:
volume
582.04K
466.21K
839.54K
118.44K
923.13K
988.82K
1.09M
747.65K
768.74K
739.32K
844.13K
750.74K
1.06M
859.09K
782.81K
658.60K
795.54K
965.63K
950.12K
1.12M
1.44M
1.25M
64.84K
1.65M
1.23M
158.45K
970.67K
1.20M
507.08K
1.03M
642.75K
968.94K
1.89M
786.94K
907.11K
961.67K
1.02M
1.51M
802.78K
829.77K
623.52K
619.62K
645.06K
1.05M
717.85K
540.10K
724.84K
929.32K
1.42M
1.82M
1.32M
1.78M
822.95K
1.39M
1.28M
1.71M
1.90M
898.06K
2.19M
1.87M
1.99M
1.64M
1.77M
2.84M
2.69M
1.08M
778.79K
1.37M
1.95M
1.79M
1.62M
1.80M
587.18K
1.29M
2.32M
75.18K
3.01M
756.36K
2.55M
2.47M
2.60M
2.45M
2.83M
2.80M
2.94M
3.26M
2.39M
2.66M
3.28M
3.24M
3.52M
2.82M
4.23M
4.33M
6.42M
2.30M
2.85M
2.28M
1.94M
2.06M
Query:
SELECT "volume",
     CASE
       WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
       WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
       WHEN "volume" = '-' THEN 0
       ELSE CAST("volume" AS REAL)
     END AS "volume_numeric"
   FROM "bitcoin_prices"
   LIMIT 100;
Answer:
volume,volume_numeric
582.04K,582040.0
466.21K,466210.0
839.54K,839540.0
118.44K,118440.0
923.13K,923130.0
988.82K,988820.0
1.09M,1090000.0
747.65K,747650.0
768.74K,768740.0
739.32K,739320.0
844.13K,844130.0
750.74K,750740.0
1.06M,1060000.0
859.09K,859090.0
782.81K,782810.0
658.60K,658600.0
795.54K,795540.0
965.63K,965630.0
950.12K,950120.0
1.12M,1120000.0
1.44M,1440000.0
1.25M,1250000.0
64.84K,64840.0
1.06M,1060000.0
1.65M,1650000.0
1.23M,1230000.0
158.45K,158450.0
970.67K,970670.0
1.20M,1200000.0
507.08K,507080.0
1.03M,1030000.0
642.75K,642750.0
968.94K,968940.0
1.25M,1250000.0
1.89M,1890000.0
786.94K,786940.0
907.11K,907110.0
961.67K,961670.0
1.02M,1020000.0
1.51M,1510000.0
1.20M,1200000.0
802.78K,802780.0
829.77K,829770.0
623.52K,623520.0
619.62K,619620.0
645.06K,645060.0
1.05M,1050000.0
717.85K,717850.0
540.10K,540100.0
724.84K,724840.0
929.32K,929320.0
1.42M,1420000.0
1.82M,1820000.0
1.32M,1320000.0
1.78M,1780000.0
822.95K,822950.0
1.39M,1390000.0
1.28M,1280000.0
1.39M,1390000.0
1.71M,1710000.0
1.90M,1900000.0
898.06K,898060.0
2.19M,2190000.0
1.87M,1870000.0
1.99M,1990000.0
1.65M,1650000.0
1.64M,1640000.0
1.77M,1770000.0
2.84M,2840000.0
2.69M,2690000.0
1.42M,1420000.0
1.08M,1080000.0
778.79K,778790.0
1.06M,1060000.0
1.37M,1370000.0
1.95M,1950000.0
1.79M,1790000.0
1.62M,1620000.0
1.80M,1800000.0
587.18K,587180.0
1.29M,1290000.0
2.32M,2320000.0
75.18K,75180.0
3.01M,3010000.0
756.36K,756360.0
2.55M,2550000.0
2.47M,2470000.0
1.09M,1090000.0
2.60M,2600000.0
2.45M,2450000.0
2.83M,2830000.0
2.80M,2800000.0
2.94M,2940000.0
3.26M,3260000.0
2.39M,2390000.0
2.66M,2660000.0
3.28M,3280000.0
3.24M,3240000.0
3.52M,3520000.0
2.82M,2820000.0
Query:
SELECT
    current.ticker,
    current.market_date,
    ((current.volume_numeric - previous.volume_numeric) * 100.0 / previous.volume_numeric) AS percentage_change_in_volume
FROM (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS current
JOIN (
    SELECT
        ticker,
        market_date,
        date(substr(market_date, 7, 4) || '-' || substr(market_date, 4, 2) || '-' || substr(market_date, 1, 2)) AS date_formatted,
        CASE
            WHEN volume LIKE '%K' THEN CAST(REPLACE(volume, 'K', '') AS REAL) * 1000
            WHEN volume LIKE '%M' THEN CAST(REPLACE(volume, 'M', '') AS REAL) * 1000000
            WHEN volume = '-' THEN 0
            ELSE CAST(volume AS REAL)
        END AS volume_numeric
    FROM bitcoin_prices
) AS previous
ON current.ticker = previous.ticker
   AND current.date_formatted = date(previous.date_formatted, '+1 day')
WHERE previous.volume_numeric > 0
ORDER BY current.ticker, current.date_formatted
LIMIT 100;
Answer:
ticker,market_date,percentage_change_in_volume
BTC,02-01-2017,57.837181044957475
BTC,03-01-2017,-15.642802155504233
BTC,04-01-2017,185.21628034312832
BTC,05-01-2017,53.586740897165164
BTC,06-01-2017,-19.049206283071538
BTC,07-01-2017,-32.75001286736322
BTC,08-01-2017,-41.13730292361855
BTC,09-01-2017,-18.63216746846964
BTC,10-01-2017,-14.173857462448067
BTC,11-01-2017,262.01824613665985
BTC,12-01-2017,-38.16087224850854
BTC,13-01-2017,-25.266134397870925
BTC,14-01-2017,-50.80124638326285
BTC,15-01-2017,-44.80886677222348
BTC,16-01-2017,36.14754098360656
BTC,17-01-2017,147.47140276941602
BTC,18-01-2017,-15.752341564286583
BTC,19-01-2017,-15.62229280970257
BTC,20-01-2017,-33.48733744010951
BTC,21-01-2017,3.884744018523283
BTC,22-01-2017,18.697374938088164
BTC,23-01-2017,-31.692050907573535
BTC,24-01-2017,79.81062919975562
BTC,25-01-2017,-35.62085952097843
BTC,26-01-2017,-10.817941952506596
BTC,27-01-2017,-8.372781065088757
BTC,28-01-2017,-53.7939941879238
BTC,29-01-2017,-22.78127183787561
BTC,30-01-2017,72.48868778280543
BTC,31-01-2017,186.83105981112277
BTC,01-02-2017,-17.285531370038413
BTC,02-02-2017,12.472357363998231
BTC,03-02-2017,21.25442390876917
BTC,04-02-2017,-36.014269498946
BTC,05-02-2017,-21.287379624936644
BTC,06-02-2017,3.090792015453972
BTC,07-02-2017,23.51655215490317
BTC,08-02-2017,64.7281921618205
BTC,09-02-2017,125.24942440521872
BTC,10-02-2017,-57.66269165247019
BTC,11-02-2017,-54.41815548044423
BTC,12-02-2017,-47.916666666666664
BTC,13-02-2017,123.11864406779661
BTC,14-02-2017,20.14585232452142
BTC,15-02-2017,-40.92058674759737
BTC,16-02-2017,63.013698630136986
BTC,17-02-2017,20.03676470588235
BTC,18-02-2017,-44.51979873113105
BTC,19-02-2017,-29.2192429022082
BTC,20-02-2017,72.75766016713092
BTC,21-02-2017,83.97291196388262
BTC,22-02-2017,-16.02103418054338
BTC,23-02-2017,37.215612606971405
BTC,24-02-2017,64.5421356860359
BTC,25-02-2017,-57.60377184062124
BTC,26-02-2017,-32.90449193196685
BTC,27-02-2017,15.274618134546637
BTC,28-02-2017,42.599379757541584
BTC,01-03-2017,1.1269276393831553
BTC,02-03-2017,53.45063538611926
BTC,03-03-2017,-14.282074149573194
BTC,04-03-2017,-42.89536266349584
BTC,05-03-2017,-33.810515356585114
BTC,06-03-2017,22.021234762092018
BTC,07-03-2017,182.694166935224
BTC,08-03-2017,11.582307341541268
BTC,09-03-2017,-38.84348181446669
BTC,10-03-2017,218.19244904777815
BTC,11-03-2017,-62.855042788890636
BTC,12-03-2017,-37.22968197879859
BTC,13-03-2017,36.14050889439316
BTC,14-03-2017,-25.339067151835923
BTC,15-03-2017,-3.433761630482942
BTC,16-03-2017,204.58820830465703
BTC,17-03-2017,23.326052572117195
BTC,18-03-2017,28.508611212898497
BTC,19-03-2017,-49.41070240471438
BTC,20-03-2017,-42.2921559417567
BTC,21-03-2017,50.72440175809865
BTC,22-03-2017,24.51668646722108
BTC,23-03-2017,-50.975800156128024
BTC,24-03-2017,134.6072186836518
BTC,25-03-2017,-4.1855203619909505
BTC,26-03-2017,-32.837465564738295
BTC,27-03-2017,6.949490214461503
BTC,28-03-2017,-12.338373876835416
BTC,29-03-2017,-13.9375
BTC,30-03-2017,8.917937545388526
BTC,31-03-2017,21.336178157087613
BTC,01-04-2017,-44.32355203868557
BTC,02-04-2017,40.11054086063956
BTC,03-04-2017,38.77148492533108
BTC,04-04-2017,-27.918781725888326
BTC,05-04-2017,-2.1549295774647885
BTC,06-04-2017,32.94947459334965
BTC,07-04-2017,-35.30749242096145
BTC,08-04-2017,-44.46861924686193
BTC,09-04-2017,36.678722121760096
BTC,10-04-2017,-11.775082690187432
BTC,11-04-2017,-6.523369157710572
Query:
SELECT * FROM "bitcoin_prices"
    WHERE "volume" != '-' AND "volume" != '0' AND "volume" IS NOT NULL
    LIMIT 100;
Answer:
Too long, hard cut:
ticker,market_date,price,open,high,low,volume,change
ETH,29-08-2021,3177.84,3243.96,3282.21,3162.79,582.04K,-2.04%
ETH,28-08-2021,3243.9,3273.78,3284.58,3212.24,466.21K,-0.91%
ETH,27-08-2021,3273.58,3093.78,3279.93,3063.37,839.54K,5.82%
ETH,26-08-2021,3093.54,3228.03,3249.62,3057.48,118.44K,-4.17%
ETH,25-08-2021,3228.15,3172.12,3247.43,3080.7,923.13K,1.73%
ETH,24-08-2021,3173.26,3322.6,3357.99,3150.75,988.82K,-4.41%
ETH,23-08-2021,3319.49,3238.41,3375.42,3231.96,1.09M,2.49%
ETH,22-08-2021,3238.7,3224.17,3271.94,3128.98,747.65K,0.46%
ETH,21-08-2021,3223.96,3285.12,3307.33,3200.19,768.74K,-1.83%
ETH,20-08-2021,3284.21,3184.83,3300.36,3179.18,739.32K,3.12%
ETH,19-08-2021,3184.82,3016.92,3185.51,2962.04,844.13K,5.57%
ETH,18-08-2021,3016.91,3012.62,3124.51,2951.04,750.74K,0.08%
ETH,17-08-2021,3014.58,3147.67,3290.03,2993.63,1.06M,-4.23%
ETH,16-08-2021,3147.65,3307.96,3334.22,3138.37,859.09K,-4.87%
ETH,15-08-2021,3308.87,3264.56,3318.61,3115.34,782.81K,1.35%
ETH,14-08-2021,3264.69,3322.25,3328.38,3209.45,658.60K,-1.74%
ETH,13-08-2021,3322.43,3043.2,3324.53,3035.52,795.54K,9.16%
ETH,12-08-2021,3043.61,3160.17,3236.28,2981.35,965.63K,-3.79%
ETH,11-08-2021,3163.66,3140.86,3269.7,3122.67,950.12K,0.73%
ETH,10-08-2021,3140.71,3162.81,3232.02,3057.84,1.12M,-0.70%
ETH,09-08-2021,3162.93,3011.88,3184.84,2899.24,1.44M,5.01%
ETH,08-08-2021,3012.07,3158.3,3188.49,2949.66,1.25M,-4.62%
ETH,07-08-2021,3158.0,2889.58,3169.74,2867.58,64.84K,9.29%
ETH,06-08-2021,2889.43,2827.23,2946.62,2726.04,1.06M,2.20%
ETH,05-08-2021,2827.21,2725.28,2842.95,2533.51,1.65M,3.74%
ETH,04-08-2021,2725.29,2506.5,2766.46,2462.32,1.23M,8.72%
ETH,03-08-2021,2506.65,2608.01,2631.43,2445.49,158.45K,-3.89%
ETH,02-08-2021,2608.04,2556.07,2664.73,2513.51,970.67K,2.03%
ETH,01-08-2021,2556.23,2530.94,2696.38,2515.26,1.20M,0.95%
ETH,31-07-2021,2532.19,2461.08,2551.68,2421.7,507.08K,2.89%
ETH,30-07-2021,2460.95,2380.59,2467.4,2320.8,1.03M,3.36%
ETH,29-07-2021,2380.93,2299.46,2397.71,2269.15,642.75K,3.56%
ETH,28-07-2021,2299.11,2300.21,2343.49,2246.23,968.94K,-0.05%
ETH,27-07-2021,2300.22,2230.24,2318.68,2152.92,1.25M,3.17%
ETH,26-07-2021,2229.53,2189.74,2430.01,2174.44,1.89M,1.81%
ETH,25-07-2021,2189.79,2166.98,2195.03,2108.74,786.94K,1.76%
ETH,24-07-2021,2151.85,2124.0,2162.29,2106.71,907.11K,1.33%
ETH,23-07-2021,2123.61,2024.51,2129.66,2000.27,961.67K,4.89%
ETH,22-07-2021,2024.58,1994.61,2043.26,1952.31,1.02M,1.51%
ETH,21-07-2021,1994.49,1786.18,2029.51,1758.64,1.51M,11.67%
ETH,20-07-2021,1786.07,1818.07,1840.36,1720.7,1.20M,-1.76%
ETH,19-07-2021,1818.07,1891.43,1915.15,1807.19,802.78K,-3.93%
ETH,18-07-2021,1892.42,1898.01,1988.24,1881.6,829.77K,-0.29%
ETH,17-07-2021,1897.98,1877.0,1917.8,1851.97,623.52K,1.05%
ETH,16-07-2021,1878.2,1917.21,1960.21,1852.42,619.62K,-2.03%
ETH,15-07-2021,1917.21,1994.73,2038.91,1884.81,645.06K,-3.88%
ETH,14-07-2021,1994.64,1940.48,2017.99,1868.45,1.05M,2.78%
ETH,13-07-2021,1940.72,2035.09,2042.61,1920.62,717.85K,-4.64%
ETH,12-07-2021,2035.09,2139.44,2167.6,2008.66,540.10K,-4.87%
ETH,11-07-2021,2139.35,2110.9,2173.34,2081.62,724.84K,1.34%
ETH,10-07-2021,2111.12,2146.15,2191.3,2078.43,929.32K,-1.62%
ETH,09-07-2021,2145.89,2120.05,2185.62,2066.09,1.42M,1.21%
ETH,08-07-2021,2120.22,2316.21,2322.47,2095.92,1.82M,-8.48%
ETH,07-07-2021,2316.57,2322.74,2402.68,2296.43,1.32M,-0.26%
ETH,06-07-2021,2322.72,2196.25,2347.47,2194.2,1.78M,5.76%
ETH,05-07-2021,2196.16,2322.6,2322.6,2163.09,822.95K,-5.47%
ETH,04-07-2021,2323.22,2224.7,2386.2,2222.95,1.39M,4.43%
ETH,03-07-2021,2224.7,2154.53,2236.97,2115.8,1.28M,3.25%
ETH,02-07-2021,2154.78,2108.58,2158.7,2019.75,1.39M,2.17%
ETH,01-07-2021,2109.11,2274.5,2274.63,2077.56,1.71M,-7.24%
ETH,30-06-2021,2273.84,2158.32,2281.55,2090.61,1.90M,5.33%
ETH,29-06-2021,2158.71,2083.48,2241.86,2076.17,898.06K,3.63%
ETH,28-06-2021,2083.09,1981.24,2142.84,1962.89,2.19M,5.21%
ETH,27-06-2021,1979.88,1830.42,1980.7,1808.59,1.87M,8.15%
ETH,26-06-2021,1830.62,1810.53,1850.4,1719.32,1.99M,1.11%
ETH,25-06-2021,1810.57,1989.77,2017.47,1793.47,1.65M,-8.98%
ETH,24-06-2021,1989.14,1968.76,2033.96,1886.74,1.64M,1.05%
ETH,23-06-2021,1968.39,1877.28,2043.1,1823.57,1.77M,4.89%
ETH,22-06-2021,1876.66,1890.95,1994.32,1707.24,2.84M,-0.77%
ETH,21-06-2021,1891.18,2244.25,2257.86,1868.32,2.69M,-15.72%
ETH,20-06-2021,2243.86,2166.3,2276.83,2045.03,1.42M,3.55%
ETH,19-06-2021,2166.91,2229.53,2276.7,2164.14,1.08M,-2.81%
ETH,18-06-2021,2229.53,2372.1,2376.62,2142.74,778.79K,-5.99%
ETH,17-06-2021,2371.62,2367.78,2459.11,2309.08,1.06M,0.18%
ETH,16-06-2021,2367.28,2544.35,2552.12,2353.24,1.37M,-6.94%
ETH,15-06-2021,2543.83,2581.42,2637.9,2512.39,1.95M,-1.46%
ETH,14-06-2021,2581.48,2508.49,2606.91,2467.61,1.79M,2.92%
ETH,13-06-2021,2508.27,2368.68,2547.9,2311.96,1.62M,5.90%
ETH,12-06-2021,2368.47,2351.45,2448.04,2260.8,1.80M,0.72%
ETH,11-06-2021,2351.45,2470.04,2493.48,2324.21,587.18K,-4.80%
ETH,10-06-2021,2469.97,2607.45,2615.46,2432.41,1.29M,-5.23%
ETH,09-06-2021,2606.23,2507.86,2620.74,2408.37,2.32M,3.81%
ETH,08-06-2021,2510.65,2592.12,2618
Query:
SELECT * FROM bitcoin_prices
LIMIT 100;
Answer:
Too long, hard cut:
ticker,market_date,price,open,high,low,volume,change
ETH,29-08-2021,3177.84,3243.96,3282.21,3162.79,582.04K,-2.04%
ETH,28-08-2021,3243.9,3273.78,3284.58,3212.24,466.21K,-0.91%
ETH,27-08-2021,3273.58,3093.78,3279.93,3063.37,839.54K,5.82%
ETH,26-08-2021,3093.54,3228.03,3249.62,3057.48,118.44K,-4.17%
ETH,25-08-2021,3228.15,3172.12,3247.43,3080.7,923.13K,1.73%
ETH,24-08-2021,3173.26,3322.6,3357.99,3150.75,988.82K,-4.41%
ETH,23-08-2021,3319.49,3238.41,3375.42,3231.96,1.09M,2.49%
ETH,22-08-2021,3238.7,3224.17,3271.94,3128.98,747.65K,0.46%
ETH,21-08-2021,3223.96,3285.12,3307.33,3200.19,768.74K,-1.83%
ETH,20-08-2021,3284.21,3184.83,3300.36,3179.18,739.32K,3.12%
ETH,19-08-2021,3184.82,3016.92,3185.51,2962.04,844.13K,5.57%
ETH,18-08-2021,3016.91,3012.62,3124.51,2951.04,750.74K,0.08%
ETH,17-08-2021,3014.58,3147.67,3290.03,2993.63,1.06M,-4.23%
ETH,16-08-2021,3147.65,3307.96,3334.22,3138.37,859.09K,-4.87%
ETH,15-08-2021,3308.87,3264.56,3318.61,3115.34,782.81K,1.35%
ETH,14-08-2021,3264.69,3322.25,3328.38,3209.45,658.60K,-1.74%
ETH,13-08-2021,3322.43,3043.2,3324.53,3035.52,795.54K,9.16%
ETH,12-08-2021,3043.61,3160.17,3236.28,2981.35,965.63K,-3.79%
ETH,11-08-2021,3163.66,3140.86,3269.7,3122.67,950.12K,0.73%
ETH,10-08-2021,3140.71,3162.81,3232.02,3057.84,1.12M,-0.70%
ETH,09-08-2021,3162.93,3011.88,3184.84,2899.24,1.44M,5.01%
ETH,08-08-2021,3012.07,3158.3,3188.49,2949.66,1.25M,-4.62%
ETH,07-08-2021,3158.0,2889.58,3169.74,2867.58,64.84K,9.29%
ETH,06-08-2021,2889.43,2827.23,2946.62,2726.04,1.06M,2.20%
ETH,05-08-2021,2827.21,2725.28,2842.95,2533.51,1.65M,3.74%
ETH,04-08-2021,2725.29,2506.5,2766.46,2462.32,1.23M,8.72%
ETH,03-08-2021,2506.65,2608.01,2631.43,2445.49,158.45K,-3.89%
ETH,02-08-2021,2608.04,2556.07,2664.73,2513.51,970.67K,2.03%
ETH,01-08-2021,2556.23,2530.94,2696.38,2515.26,1.20M,0.95%
ETH,31-07-2021,2532.19,2461.08,2551.68,2421.7,507.08K,2.89%
ETH,30-07-2021,2460.95,2380.59,2467.4,2320.8,1.03M,3.36%
ETH,29-07-2021,2380.93,2299.46,2397.71,2269.15,642.75K,3.56%
ETH,28-07-2021,2299.11,2300.21,2343.49,2246.23,968.94K,-0.05%
ETH,27-07-2021,2300.22,2230.24,2318.68,2152.92,1.25M,3.17%
ETH,26-07-2021,2229.53,2189.74,2430.01,2174.44,1.89M,1.81%
ETH,25-07-2021,2189.79,2166.98,2195.03,2108.74,786.94K,1.76%
ETH,24-07-2021,2151.85,2124.0,2162.29,2106.71,907.11K,1.33%
ETH,23-07-2021,2123.61,2024.51,2129.66,2000.27,961.67K,4.89%
ETH,22-07-2021,2024.58,1994.61,2043.26,1952.31,1.02M,1.51%
ETH,21-07-2021,1994.49,1786.18,2029.51,1758.64,1.51M,11.67%
ETH,20-07-2021,1786.07,1818.07,1840.36,1720.7,1.20M,-1.76%
ETH,19-07-2021,1818.07,1891.43,1915.15,1807.19,802.78K,-3.93%
ETH,18-07-2021,1892.42,1898.01,1988.24,1881.6,829.77K,-0.29%
ETH,17-07-2021,1897.98,1877.0,1917.8,1851.97,623.52K,1.05%
ETH,16-07-2021,1878.2,1917.21,1960.21,1852.42,619.62K,-2.03%
ETH,15-07-2021,1917.21,1994.73,2038.91,1884.81,645.06K,-3.88%
ETH,14-07-2021,1994.64,1940.48,2017.99,1868.45,1.05M,2.78%
ETH,13-07-2021,1940.72,2035.09,2042.61,1920.62,717.85K,-4.64%
ETH,12-07-2021,2035.09,2139.44,2167.6,2008.66,540.10K,-4.87%
ETH,11-07-2021,2139.35,2110.9,2173.34,2081.62,724.84K,1.34%
ETH,10-07-2021,2111.12,2146.15,2191.3,2078.43,929.32K,-1.62%
ETH,09-07-2021,2145.89,2120.05,2185.62,2066.09,1.42M,1.21%
ETH,08-07-2021,2120.22,2316.21,2322.47,2095.92,1.82M,-8.48%
ETH,07-07-2021,2316.57,2322.74,2402.68,2296.43,1.32M,-0.26%
ETH,06-07-2021,2322.72,2196.25,2347.47,2194.2,1.78M,5.76%
ETH,05-07-2021,2196.16,2322.6,2322.6,2163.09,822.95K,-5.47%
ETH,04-07-2021,2323.22,2224.7,2386.2,2222.95,1.39M,4.43%
ETH,03-07-2021,2224.7,2154.53,2236.97,2115.8,1.28M,3.25%
ETH,02-07-2021,2154.78,2108.58,2158.7,2019.75,1.39M,2.17%
ETH,01-07-2021,2109.11,2274.5,2274.63,2077.56,1.71M,-7.24%
ETH,30-06-2021,2273.84,2158.32,2281.55,2090.61,1.90M,5.33%
ETH,29-06-2021,2158.71,2083.48,2241.86,2076.17,898.06K,3.63%
ETH,28-06-2021,2083.09,1981.24,2142.84,1962.89,2.19M,5.21%
ETH,27-06-2021,1979.88,1830.42,1980.7,1808.59,1.87M,8.15%
ETH,26-06-2021,1830.62,1810.53,1850.4,1719.32,1.99M,1.11%
ETH,25-06-2021,1810.57,1989.77,2017.47,1793.47,1.65M,-8.98%
ETH,24-06-2021,1989.14,1968.76,2033.96,1886.74,1.64M,1.05%
ETH,23-06-2021,1968.39,1877.28,2043.1,1823.57,1.77M,4.89%
ETH,22-06-2021,1876.66,1890.95,1994.32,1707.24,2.84M,-0.77%
ETH,21-06-2021,1891.18,2244.25,2257.86,1868.32,2.69M,-15.72%
ETH,20-06-2021,2243.86,2166.3,2276.83,2045.03,1.42M,3.55%
ETH,19-06-2021,2166.91,2229.53,2276.7,2164.14,1.08M,-2.81%
ETH,18-06-2021,2229.53,2372.1,2376.62,2142.74,778.79K,-5.99%
ETH,17-06-2021,2371.62,2367.78,2459.11,2309.08,1.06M,0.18%
ETH,16-06-2021,2367.28,2544.35,2552.12,2353.24,1.37M,-6.94%
ETH,15-06-2021,2543.83,2581.42,2637.9,2512.39,1.95M,-1.46%
ETH,14-06-2021,2581.48,2508.49,2606.91,2467.61,1.79M,2.92%
ETH,13-06-2021,2508.27,2368.68,2547.9,2311.96,1.62M,5.90%
ETH,12-06-2021,2368.47,2351.45,2448.04,2260.8,1.80M,0.72%
ETH,11-06-2021,2351.45,2470.04,2493.48,2324.21,587.18K,-4.80%
ETH,10-06-2021,2469.97,2607.45,2615.46,2432.41,1.29M,-5.23%
ETH,09-06-2021,2606.23,2507.86,2620.74,2408.37,2.32M,3.81%
ETH,08-06-2021,2510.65,2592.12,2618
Query:
SELECT "market_date",
      substr("market_date", 1, 4) AS "year",
      substr("market_date", 6, 2) AS "month",
      substr("market_date", 9, 2) AS "day"
    FROM "bitcoin_prices"
    LIMIT 100;
Answer:
market_date,year,month,day
29-08-2021,29-0,-2,21
28-08-2021,28-0,-2,21
27-08-2021,27-0,-2,21
26-08-2021,26-0,-2,21
25-08-2021,25-0,-2,21
24-08-2021,24-0,-2,21
23-08-2021,23-0,-2,21
22-08-2021,22-0,-2,21
21-08-2021,21-0,-2,21
20-08-2021,20-0,-2,21
19-08-2021,19-0,-2,21
18-08-2021,18-0,-2,21
17-08-2021,17-0,-2,21
16-08-2021,16-0,-2,21
15-08-2021,15-0,-2,21
14-08-2021,14-0,-2,21
13-08-2021,13-0,-2,21
12-08-2021,12-0,-2,21
11-08-2021,11-0,-2,21
10-08-2021,10-0,-2,21
09-08-2021,09-0,-2,21
08-08-2021,08-0,-2,21
07-08-2021,07-0,-2,21
06-08-2021,06-0,-2,21
05-08-2021,05-0,-2,21
04-08-2021,04-0,-2,21
03-08-2021,03-0,-2,21
02-08-2021,02-0,-2,21
01-08-2021,01-0,-2,21
31-07-2021,31-0,-2,21
30-07-2021,30-0,-2,21
29-07-2021,29-0,-2,21
28-07-2021,28-0,-2,21
27-07-2021,27-0,-2,21
26-07-2021,26-0,-2,21
25-07-2021,25-0,-2,21
24-07-2021,24-0,-2,21
23-07-2021,23-0,-2,21
22-07-2021,22-0,-2,21
21-07-2021,21-0,-2,21
20-07-2021,20-0,-2,21
19-07-2021,19-0,-2,21
18-07-2021,18-0,-2,21
17-07-2021,17-0,-2,21
16-07-2021,16-0,-2,21
15-07-2021,15-0,-2,21
14-07-2021,14-0,-2,21
13-07-2021,13-0,-2,21
12-07-2021,12-0,-2,21
11-07-2021,11-0,-2,21
10-07-2021,10-0,-2,21
09-07-2021,09-0,-2,21
08-07-2021,08-0,-2,21
07-07-2021,07-0,-2,21
06-07-2021,06-0,-2,21
05-07-2021,05-0,-2,21
04-07-2021,04-0,-2,21
03-07-2021,03-0,-2,21
02-07-2021,02-0,-2,21
01-07-2021,01-0,-2,21
30-06-2021,30-0,-2,21
29-06-2021,29-0,-2,21
28-06-2021,28-0,-2,21
27-06-2021,27-0,-2,21
26-06-2021,26-0,-2,21
25-06-2021,25-0,-2,21
24-06-2021,24-0,-2,21
23-06-2021,23-0,-2,21
22-06-2021,22-0,-2,21
21-06-2021,21-0,-2,21
20-06-2021,20-0,-2,21
19-06-2021,19-0,-2,21
18-06-2021,18-0,-2,21
17-06-2021,17-0,-2,21
16-06-2021,16-0,-2,21
15-06-2021,15-0,-2,21
14-06-2021,14-0,-2,21
13-06-2021,13-0,-2,21
12-06-2021,12-0,-2,21
11-06-2021,11-0,-2,21
10-06-2021,10-0,-2,21
09-06-2021,09-0,-2,21
08-06-2021,08-0,-2,21
07-06-2021,07-0,-2,21
06-06-2021,06-0,-2,21
05-06-2021,05-0,-2,21
04-06-2021,04-0,-2,21
03-06-2021,03-0,-2,21
02-06-2021,02-0,-2,21
01-06-2021,01-0,-2,21
31-05-2021,31-0,-2,21
30-05-2021,30-0,-2,21
29-05-2021,29-0,-2,21
28-05-2021,28-0,-2,21
27-05-2021,27-0,-2,21
26-05-2021,26-0,-2,21
25-05-2021,25-0,-2,21
24-05-2021,24-0,-2,21
23-05-2021,23-0,-2,21
22-05-2021,22-0,-2,21
End Exploring Related Columns
Task: Using the "bitcoin_prices" table, please calculate the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021, ensuring that any volume ending in "K" or "M" is accurately converted to thousands or millions, any "-" volume is treated as zero, only non-zero volumes are used to determine the previous day's volume, and the results are ordered by ticker and date.

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: ```csv
ticker,market_date,percentage_change_in_volume
ticker1:str,date1:str,change1:float
ticker1:str,date2:str,change2:float
...
```

**Explanation:**

The table above displays the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021. In calculating the percentage changes, volumes ending with "K" or "M" have been accurately converted to thousands or millions. Any volumes denoted as "-" have been treated as zero. Only non-zero volumes were used to determine the previous day's volume for the percentage change calculation. The results are ordered by ticker and date as requested..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is (table names): 
['weekly_sales', 'shopping_cart_users', 'bitcoin_members', 'interest_metrics', 'customer_regions', 'customer_transactions', 'bitcoin_transactions', 'customer_nodes', 'cleaned_weekly_sales', 'veg_txn_df', 'shopping_cart_events', 'shopping_cart_page_hierarchy', 'bitcoin_prices', 'interest_map', 'veg_loss_rate_df', 'shopping_cart_campaign_identifier', 'veg_cat', 'veg_whsle_df', 'shopping_cart_event_identifier']

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 11:32:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:32:08 - root - INFO - ```sql
SELECT
    current."ticker",
    current."market_date",
    ((current."volume_numeric" - previous."volume_numeric") * 100.0 / previous."volume_numeric") AS "percentage_change_in_volume"
FROM (
    SELECT
        "ticker",
        "market_date",
        date(substr("market_date", 7, 4) || '-' || substr("market_date", 4, 2) || '-' || substr("market_date", 1, 2)) AS "date_formatted",
        CASE
            WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
            WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
            WHEN "volume" = '-' THEN 0
            ELSE CAST("volume" AS REAL)
        END AS "volume_numeric"
    FROM "bitcoin_prices"
) AS current
JOIN (
    SELECT
        "ticker",
        "market_date",
        date(substr("market_date", 7, 4) || '-' || substr("market_date", 4, 2) || '-' || substr("market_date", 1, 2)) AS "date_formatted",
        CASE
            WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
            WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
            WHEN "volume" = '-' THEN 0
            ELSE CAST("volume" AS REAL)
        END AS "volume_numeric"
    FROM "bitcoin_prices"
) AS previous
ON current."ticker" = previous."ticker"
   AND current."date_formatted" = date(previous."date_formatted", '+1 day')
WHERE current."date_formatted" BETWEEN '2021-08-01' AND '2021-08-10'
  AND previous."volume_numeric" > 0
ORDER BY current."ticker", current."date_formatted";
```
2025-02-11 11:32:08 - root - INFO - itercount: 1
2025-02-11 11:32:08 - root - INFO - 0
2025-02-11 11:32:09 - root - INFO - results: 
ticker,market_date,percentage_change_in_volume
BTC,01-08-2021,79.91041433370661
BTC,02-08-2021,-6.8716544254948335
BTC,03-08-2021,-99.65245288063093
BTC,04-08-2021,30369.23076923077
BTC,05-08-2021,64.85735925271396
BTC,06-08-2021,-14.295558958652373
BTC,07-08-2021,0.8130081300813008
BTC,08-08-2021,-6.726338177951082
BTC,09-08-2021,11.239904988123515
BTC,10-08-2021,-31.20088828151691
ETH,01-08-2021,136.64904945965134
ETH,02-08-2021,-19.110833333333332
ETH,03-08-2021,-83.6762236393419
ETH,04-08-2021,676.2701167560745
ETH,05-08-2021,34.146341463414636
ETH,06-08-2021,-35.75757575757576
ETH,07-08-2021,-93.88301886792453
ETH,08-08-2021,1827.8223318938926
ETH,09-08-2021,15.2
ETH,10-08-2021,-22.22222222222222


2025-02-11 11:32:09 - root - INFO - Please check the answer again by reviewing Using the "bitcoin_prices" table, please calculate the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021, ensuring that any volume ending in "K" or "M" is accurately converted to thousands or millions, any "-" volume is treated as zero, only non-zero volumes are used to determine the previous day's volume, and the results are ordered by ticker and date., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
ticker,market_date,percentage_change_in_volume
ticker1:str,date1:str,change1:float
ticker1:str,date2:str,change2:float
...
```

**Explanation:**

The table above displays the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021. In calculating the percentage changes, volumes ending with "K" or "M" have been accurately converted to thousands or millions. Any volumes denoted as "-" have been treated as zero. Only non-zero volumes were used to determine the previous day's volume for the percentage change calculation. The results are ordered by ticker and date as requested. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
ticker,market_date,percentage_change_in_volume
BTC,01-08-2021,79.91041433370661
BTC,02-08-2021,-6.8716544254948335
BTC,03-08-2021,-99.65245288063093
BTC,04-08-2021,30369.23076923077
BTC,05-08-2021,64.85735925271396
BTC,06-08-2021,-14.295558958652373
BTC,07-08-2021,0.8130081300813008
BTC,08-08-2021,-6.726338177951082
BTC,09-08-2021,11.239904988123515
BTC,10-08-2021,-31.20088828151691
ETH,01-08-2021,136.64904945965134
ETH,02-08-2021,-19.110833333333332
ETH,03-08-2021,-83.6762236393419
ETH,04-08-2021,676.2701167560745
ETH,05-08-2021,34.146341463414636
ETH,06-08-2021,-35.75757575757576
ETH,07-08-2021,-93.88301886792453
ETH,08-08-2021,1827.8223318938926
ETH,09-08-2021,15.2
ETH,10-08-2021,-22.22222222222222
Current sql:
SELECT
    current."ticker",
    current."market_date",
    ((current."volume_numeric" - previous."volume_numeric") * 100.0 / previous."volume_numeric") AS "percentage_change_in_volume"
FROM (
    SELECT
        "ticker",
        "market_date",
        date(substr("market_date", 7, 4) || '-' || substr("market_date", 4, 2) || '-' || substr("market_date", 1, 2)) AS "date_formatted",
        CASE
            WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
            WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
            WHEN "volume" = '-' THEN 0
            ELSE CAST("volume" AS REAL)
        END AS "volume_numeric"
    FROM "bitcoin_prices"
) AS current
JOIN (
    SELECT
        "ticker",
        "market_date",
        date(substr("market_date", 7, 4) || '-' || substr("market_date", 4, 2) || '-' || substr("market_date", 1, 2)) AS "date_formatted",
        CASE
            WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
            WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
            WHEN "volume" = '-' THEN 0
            ELSE CAST("volume" AS REAL)
        END AS "volume_numeric"
    FROM "bitcoin_prices"
) AS previous
ON current."ticker" = previous."ticker"
   AND current."date_formatted" = date(previous."date_formatted", '+1 day')
WHERE current."date_formatted" BETWEEN '2021-08-01' AND '2021-08-10'
  AND previous."volume_numeric" > 0
ORDER BY current."ticker", current."date_formatted";
2025-02-11 11:32:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 11:32:56 - root - INFO - ```sql
SELECT
    current."ticker",
    current."market_date",
    ROUND(((current."volume_numeric" - previous."volume_numeric") * 100.0 / previous."volume_numeric"), 4) AS "percentage_change_in_volume"
FROM (
    SELECT
        "ticker",
        "market_date",
        date(substr("market_date", 7, 4) || '-' || substr("market_date", 4, 2) || '-' || substr("market_date", 1, 2)) AS "date_formatted",
        CASE
            WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
            WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
            WHEN "volume" = '-' THEN 0
            ELSE CAST("volume" AS REAL)
        END AS "volume_numeric"
    FROM "bitcoin_prices"
) AS current
JOIN (
    SELECT
        "ticker",
        "market_date",
        date(substr("market_date", 7, 4) || '-' || substr("market_date", 4, 2) || '-' || substr("market_date", 1, 2)) AS "date_formatted",
        CASE
            WHEN "volume" LIKE '%K' THEN CAST(REPLACE("volume", 'K', '') AS REAL) * 1000
            WHEN "volume" LIKE '%M' THEN CAST(REPLACE("volume", 'M', '') AS REAL) * 1000000
            WHEN "volume" = '-' THEN 0
            ELSE CAST("volume" AS REAL)
        END AS "volume_numeric"
    FROM "bitcoin_prices"
) AS previous
ON current."ticker" = previous."ticker"
   AND current."date_formatted" = date(previous."date_formatted", '+1 day')
WHERE current."date_formatted" BETWEEN '2021-08-01' AND '2021-08-10'
  AND previous."volume_numeric" > 0
ORDER BY current."ticker", current."date_formatted";
```
2025-02-11 11:32:56 - root - INFO - itercount: 2
2025-02-11 11:32:56 - root - INFO - 0
2025-02-11 11:32:56 - root - INFO - Total iteration counts: 2
