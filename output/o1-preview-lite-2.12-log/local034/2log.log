2025-01-25 10:12:05 - openai._base_client - INFO - Retrying request to /chat/completions in 0.461708 seconds
2025-01-25 10:12:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:12:58 - root - INFO - SQL:
SELECT DISTINCT "product_category_name"
   FROM "olist_products"
   LIMIT 100;
Results:
product_category_name
perfumaria
artes
esporte_lazer
bebes
utilidades_domesticas
instrumentos_musicais
cool_stuff
moveis_decoracao
eletrodomesticos
brinquedos
cama_mesa_banho
construcao_ferramentas_seguranca
informatica_acessorios
beleza_saude
malas_acessorios
ferramentas_jardim
moveis_escritorio
automotivo
eletronicos
fashion_calcados
telefonia
papelaria
fashion_bolsas_e_acessorios
pcs
casa_construcao
relogios_presentes
construcao_ferramentas_construcao
pet_shop
eletroportateis
agro_industria_e_comercio
""
moveis_sala
sinalizacao_e_seguranca
climatizacao
consoles_games
livros_interesse_geral
construcao_ferramentas_ferramentas
fashion_underwear_e_moda_praia
fashion_roupa_masculina
moveis_cozinha_area_de_servico_jantar_e_jardim
industria_comercio_e_negocios
telefonia_fixa
construcao_ferramentas_iluminacao
livros_tecnicos
eletrodomesticos_2
artigos_de_festas
bebidas
market_place
la_cuisine
construcao_ferramentas_jardim
fashion_roupa_feminina
casa_conforto
audio
alimentos_bebidas
musica
alimentos
tablets_impressao_imagem
livros_importados
portateis_casa_forno_e_cafe
fashion_esporte
artigos_de_natal
fashion_roupa_infanto_juvenil
dvds_blu_ray
artes_e_artesanato
pc_gamer
moveis_quarto
cine_foto
fraldas_higiene
flores
casa_conforto_2
portateis_cozinha_e_preparadores_de_alimentos
seguros_e_servicos
moveis_colchao_e_estofado
cds_dvds_musicais

2025-01-25 10:12:58 - root - INFO - SQL:
SELECT DISTINCT "product_category_name_english"
   FROM "product_category_name_translation"
   LIMIT 100;
Results:
product_category_name_english
health_beauty
computers_accessories
auto
bed_bath_table
furniture_decor
sports_leisure
perfumery
housewares
telephony
watches_gifts
food_drink
baby
stationery
tablets_printing_image
toys
fixed_telephony
garden_tools
fashion_bags_accessories
small_appliances
consoles_games
audio
fashion_shoes
cool_stuff
luggage_accessories
air_conditioning
construction_tools_construction
kitchen_dining_laundry_garden_furniture
costruction_tools_garden
fashion_male_clothing
pet_shop
office_furniture
market_place
electronics
home_appliances
party_supplies
home_confort
costruction_tools_tools
agro_industry_and_commerce
furniture_mattress_and_upholstery
books_technical
home_construction
musical_instruments
furniture_living_room
construction_tools_lights
industry_commerce_and_business
food
art
furniture_bedroom
books_general_interest
construction_tools_safety
fashion_underwear_beach
fashion_sport
signaling_and_security
computers
christmas_supplies
fashio_female_clothing
home_appliances_2
books_imported
drinks
cine_photo
la_cuisine
music
home_comfort_2
small_appliances_home_oven_and_coffee
cds_dvds_musicals
dvds_blu_ray
flowers
arts_and_craftmanship
diapers_and_hygiene
fashion_childrens_clothes
security_and_services

2025-01-25 10:12:58 - root - INFO - SQL:
SELECT "product_category_name", "product_category_name_english"
   FROM "product_category_name_translation"
   LIMIT 100;
Results:
product_category_name,product_category_name_english
beleza_saude,health_beauty
informatica_acessorios,computers_accessories
automotivo,auto
cama_mesa_banho,bed_bath_table
moveis_decoracao,furniture_decor
esporte_lazer,sports_leisure
perfumaria,perfumery
utilidades_domesticas,housewares
telefonia,telephony
relogios_presentes,watches_gifts
alimentos_bebidas,food_drink
bebes,baby
papelaria,stationery
tablets_impressao_imagem,tablets_printing_image
brinquedos,toys
telefonia_fixa,fixed_telephony
ferramentas_jardim,garden_tools
fashion_bolsas_e_acessorios,fashion_bags_accessories
eletroportateis,small_appliances
consoles_games,consoles_games
audio,audio
fashion_calcados,fashion_shoes
cool_stuff,cool_stuff
malas_acessorios,luggage_accessories
climatizacao,air_conditioning
construcao_ferramentas_construcao,construction_tools_construction
moveis_cozinha_area_de_servico_jantar_e_jardim,kitchen_dining_laundry_garden_furniture
construcao_ferramentas_jardim,costruction_tools_garden
fashion_roupa_masculina,fashion_male_clothing
pet_shop,pet_shop
moveis_escritorio,office_furniture
market_place,market_place
eletronicos,electronics
eletrodomesticos,home_appliances
artigos_de_festas,party_supplies
casa_conforto,home_confort
construcao_ferramentas_ferramentas,costruction_tools_tools
agro_industria_e_comercio,agro_industry_and_commerce
moveis_colchao_e_estofado,furniture_mattress_and_upholstery
livros_tecnicos,books_technical
casa_construcao,home_construction
instrumentos_musicais,musical_instruments
moveis_sala,furniture_living_room
construcao_ferramentas_iluminacao,construction_tools_lights
industria_comercio_e_negocios,industry_commerce_and_business
alimentos,food
artes,art
moveis_quarto,furniture_bedroom
livros_interesse_geral,books_general_interest
construcao_ferramentas_seguranca,construction_tools_safety
fashion_underwear_e_moda_praia,fashion_underwear_beach
fashion_esporte,fashion_sport
sinalizacao_e_seguranca,signaling_and_security
pcs,computers
artigos_de_natal,christmas_supplies
fashion_roupa_feminina,fashio_female_clothing
eletrodomesticos_2,home_appliances_2
livros_importados,books_imported
bebidas,drinks
cine_foto,cine_photo
la_cuisine,la_cuisine
musica,music
casa_conforto_2,home_comfort_2
portateis_casa_forno_e_cafe,small_appliances_home_oven_and_coffee
cds_dvds_musicais,cds_dvds_musicals
dvds_blu_ray,dvds_blu_ray
flores,flowers
artes_e_artesanato,arts_and_craftmanship
fraldas_higiene,diapers_and_hygiene
fashion_roupa_infanto_juvenil,fashion_childrens_clothes
seguros_e_servicos,security_and_services

2025-01-25 10:12:58 - root - INFO - SQL:
SELECT DISTINCT "payment_type"
   FROM "olist_order_payments"
   LIMIT 100;
Results:
payment_type
credit_card
boleto
voucher
debit_card
not_defined

2025-01-25 10:12:58 - root - INFO - SQL:
SELECT "payment_type", COUNT(*) AS "payment_count"
   FROM "olist_order_payments"
   GROUP BY "payment_type"
   ORDER BY "payment_count" DESC
   LIMIT 100;
Results:
payment_type,payment_count
credit_card,76795
boleto,19784
voucher,5775
debit_card,1529
not_defined,3

2025-01-25 10:12:58 - root - INFO - SQL:
SELECT "order_id", COUNT(*) AS "payment_count"
   FROM "olist_order_payments"
   GROUP BY "order_id"
   LIMIT 100;
Results:
order_id,payment_count
00010242fe8c5a6d1ba2dd792cb16214,1
00018f77f2f0320c557190d7a144bdd3,1
000229ec398224ef6ca0657da4fc703e,1
00024acbcdf0a6daa1e931b038114c75,1
00042b26cf59d7ce69dfabb4e55b4fd9,1
00048cc3ae777c65dbb7d2a0634bc1ea,1
00054e8431b9d7675808bcb819fb4a32,1
000576fe39319847cbb9d288c5617fa6,1
0005a1a1728c9d785b8e2b08b904576c,1
0005f50442cb953dcd1d21e1fb923495,1
00061f2a7bc09da83e415a52dc8a4af1,1
00063b381e2406b52ad429470734ebd5,1
0006ec9db01a64e59a68b2c340bf65a7,1
0008288aa423d2a3f00fcb17cd7d8719,1
0009792311464db532ff765bf7b182ae,1
0009c9a17f916a706d71784483a5d643,1
000aed2e25dbad2f9ddb70584c5a2ded,1
000c3e6612759851cc3cbb4b83257986,1
000e562887b1f2006d75e0be9558292e,1
000e63d38ae8c00bbcb5a30573b99628,1
000e906b789b55f64edcb1f84030f90d,1
000f25f4d72195062c040b12dce9a18a,1
001021efaa8636c29475e7734483457d,1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,1
0010dedd556712d7bb69a19cb7bbd37a,1
00119ff934e539cf26f92b9ef0cdfed8,1
0011d82c4b53e22e84023405fb467e57,1
00125cb692d04887809806618a2a145f,1
00130c0eee84a3d909e75bc08c5c3ca1,1
0013503b13da1eac686219390b7d641b,1
00137e170939bba5a3134e2386413108,1
001427c0ec99cf8af737bd88e92fd444,1
00143d0f86d6fbd9f9b38ab440ac16f5,1
0014ae671de39511f7575066200733b7,1
0015ebb40fb17286bea51d4607c4733c,1
00169e31ef4b29deaae414f9a5e95929,1
0016dfedd97fc2950e388d2971d718c7,2
0017afd5076e074a48f1f1a4c7bac9c5,1
001862358bf858722e1e2ae000cfed8b,1
0019c29108428acffd089c36103c9440,1
001ab0a7578dd66cd4b0a71f5b6e1e41,1
001ac194d4a326a6fa99b581e9a3d963,1
001b76dd48a5b1eee3e87778daa40df8,1
001c85b5f68d2be0cb0797afc9e8ce9a,1
001d8f0e34a38c37f7dba2a37d4eba8b,1
001daeb0eddc45b999bad0801ad9d273,1
001dbc16dc51075e987543d23a0507c7,1
001e7ba991be1b19605ca0316e7130f9,1
001e7cf2ad6bef3ade12ebc56ceaf0f3,1
0020262c8a370bd5a174ea6a2a267321,1
0020a222f55eb79a372d0efee3cca688,1
002175704e8b209f61b9ad5cfd92b60e,1
00229e4e43f7a7e0b9dd819ad43268d3,1
0025081dcf9330f9a5052ae82c6ce396,1
00254baeb6c932b0a8aeead91fbd02b5,1
00259a44fcad3fc0474329e925d14fc3,1
0025c5d1a8ca53a240ec2634bb4492ea,1
002611a77fe03d076285fd4ca95db77c,1
002691433f09002ac9ca0c4e8dbb8ead,1
0026a368634b6e6f34f33b1499773a30,1
00275bce676303c3bfd7292aefdfa223,1
00276d5c3491fbf55305e26891040df9,1
002834535f7a609a5c68266f173fa59e,1
0028de0ca693a1bb26448916a81105cc,1
002955b0acc63d04f6724a31967e82bd,1
0029c5db35ef291ce99d1262012e7daa,1
0029f17cf0e7640c5cb6825af681303f,1
002af7fa9eb99d1456bceb6a13d6fc0b,1
002b430ff89b3a24c31a1170acbbedea,1
002b4e6fa42cd4a22cc86abc18fe9c05,1
002c9def9c9b951b1bec6d50753c9891,1
002d040018d12a3853c059f7f23ab5b1,1
002f16b7bc4530031b7d90f791b12d8a,1
002f19a65a2ddd70a090297872e6d64e,2
002f98c0f7efd42638ed6100ca699b42,1
0030d783f979fbc5981e75613b057344,1
0030ff924c38549807645976adeef2c0,1
00310b0c75bb13015ec4d82d341865a4,1
00324b3eda39ba5ecce3945823e3594c,1
0032d07457ae9c806c79368d7d9ce96b,1
003324c70b19a16798817b2b3640e721,1
00335b686d693c7d72deeb12f8e89227,1
00335f75ea6a4455b524a8dd177067f5,1
00337fe25a3780b3424d9ad7c5a4b35e,1
003423b755b562962a6225a8de40d12e,1
00345f338696283410b7977d2e3efc89,1
0035246a40f520710769010f752e7507,1
0035c0b07126fe9c24a325216fb96064,1
0035e6b7ade84b3f5b86bd49814793df,1
0036757472ece3dde52fd4bfd929c90e,1
0036887767dea4bd43b1a88cd0d9477a,1
00378c6c981f234634c0b9d6128df6dd,1
003822434f91204da0a51fe4cf2aba18,1
0039500db36d50d7d0bfaf23723550f3,1
003a7f59d7e08a9c61d9e2881fe6459c,1
003a94f778ef8cfd50247c8c1b582257,1
003cc6161d7a2593f2525cce0c330d32,1
003d0634280ff3d1d3a54459349a6899,1
003d804eef0e1b856881cd18e0cc0d4c,1
003d9fc84ad902adf2265248b5ffe1a4,1

2025-01-25 10:12:59 - root - INFO - SQL:
SELECT "order_id", SUM("payment_value") AS "total_payment_value"
   FROM "olist_order_payments"
   GROUP BY "order_id"
   LIMIT 100;
Results:
order_id,total_payment_value
00010242fe8c5a6d1ba2dd792cb16214,72.19
00018f77f2f0320c557190d7a144bdd3,259.83
000229ec398224ef6ca0657da4fc703e,216.87
00024acbcdf0a6daa1e931b038114c75,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,34.59
00054e8431b9d7675808bcb819fb4a32,31.75
000576fe39319847cbb9d288c5617fa6,880.75
0005a1a1728c9d785b8e2b08b904576c,157.6
0005f50442cb953dcd1d21e1fb923495,65.39
00061f2a7bc09da83e415a52dc8a4af1,68.87
00063b381e2406b52ad429470734ebd5,57.98
0006ec9db01a64e59a68b2c340bf65a7,97.32
0008288aa423d2a3f00fcb17cd7d8719,126.54
0009792311464db532ff765bf7b182ae,127.55
0009c9a17f916a706d71784483a5d643,650.34
000aed2e25dbad2f9ddb70584c5a2ded,152.77
000c3e6612759851cc3cbb4b83257986,112.71
000e562887b1f2006d75e0be9558292e,41.11
000e63d38ae8c00bbcb5a30573b99628,56.78
000e906b789b55f64edcb1f84030f90d,33.84
000f25f4d72195062c040b12dce9a18a,164.39
001021efaa8636c29475e7734483457d,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,65.5
0010dedd556712d7bb69a19cb7bbd37a,111.12
00119ff934e539cf26f92b9ef0cdfed8,236.88
0011d82c4b53e22e84023405fb467e57,315.33
00125cb692d04887809806618a2a145f,135.41
00130c0eee84a3d909e75bc08c5c3ca1,35.84
0013503b13da1eac686219390b7d641b,137.22
00137e170939bba5a3134e2386413108,421.65
001427c0ec99cf8af737bd88e92fd444,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,109.29
0014ae671de39511f7575066200733b7,30.6
0015ebb40fb17286bea51d4607c4733c,37.0
00169e31ef4b29deaae414f9a5e95929,55.11
0016dfedd97fc2950e388d2971d718c7,70.55000000000001
0017afd5076e074a48f1f1a4c7bac9c5,853.39
001862358bf858722e1e2ae000cfed8b,113.71
0019c29108428acffd089c36103c9440,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,127.56
001ac194d4a326a6fa99b581e9a3d963,62.54
001b76dd48a5b1eee3e87778daa40df8,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,53.54
001daeb0eddc45b999bad0801ad9d273,55.12
001dbc16dc51075e987543d23a0507c7,87.9
001e7ba991be1b19605ca0316e7130f9,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,51.1
0020262c8a370bd5a174ea6a2a267321,100.55
0020a222f55eb79a372d0efee3cca688,45.09
002175704e8b209f61b9ad5cfd92b60e,123.11
00229e4e43f7a7e0b9dd819ad43268d3,91.39
0025081dcf9330f9a5052ae82c6ce396,33.18
00254baeb6c932b0a8aeead91fbd02b5,193.01
00259a44fcad3fc0474329e925d14fc3,34.09
0025c5d1a8ca53a240ec2634bb4492ea,419.39
002611a77fe03d076285fd4ca95db77c,156.75
002691433f09002ac9ca0c4e8dbb8ead,120.43
0026a368634b6e6f34f33b1499773a30,164.8
00275bce676303c3bfd7292aefdfa223,293.36
00276d5c3491fbf55305e26891040df9,68.12
002834535f7a609a5c68266f173fa59e,57.17
0028de0ca693a1bb26448916a81105cc,45.3
002955b0acc63d04f6724a31967e82bd,135.59
0029c5db35ef291ce99d1262012e7daa,514.37
0029f17cf0e7640c5cb6825af681303f,113.44
002af7fa9eb99d1456bceb6a13d6fc0b,109.45
002b430ff89b3a24c31a1170acbbedea,265.55
002b4e6fa42cd4a22cc86abc18fe9c05,119.57
002c9def9c9b951b1bec6d50753c9891,173.8
002d040018d12a3853c059f7f23ab5b1,169.84
002f16b7bc4530031b7d90f791b12d8a,284.13
002f19a65a2ddd70a090297872e6d64e,77.28999999999999
002f98c0f7efd42638ed6100ca699b42,93.62
0030d783f979fbc5981e75613b057344,78.27
0030ff924c38549807645976adeef2c0,292.24
00310b0c75bb13015ec4d82d341865a4,55.28
00324b3eda39ba5ecce3945823e3594c,110.07
0032d07457ae9c806c79368d7d9ce96b,186.19
003324c70b19a16798817b2b3640e721,234.7
00335b686d693c7d72deeb12f8e89227,80.79
00335f75ea6a4455b524a8dd177067f5,177.01
00337fe25a3780b3424d9ad7c5a4b35e,139.68
003423b755b562962a6225a8de40d12e,261.33
00345f338696283410b7977d2e3efc89,67.34
0035246a40f520710769010f752e7507,99.11
0035c0b07126fe9c24a325216fb96064,150.44
0035e6b7ade84b3f5b86bd49814793df,34.0
0036757472ece3dde52fd4bfd929c90e,203.03
0036887767dea4bd43b1a88cd0d9477a,423.63
00378c6c981f234634c0b9d6128df6dd,52.85
003822434f91204da0a51fe4cf2aba18,175.16
0039500db36d50d7d0bfaf23723550f3,203.23
003a7f59d7e08a9c61d9e2881fe6459c,134.28
003a94f778ef8cfd50247c8c1b582257,57.98
003cc6161d7a2593f2525cce0c330d32,97.9
003d0634280ff3d1d3a54459349a6899,228.89
003d804eef0e1b856881cd18e0cc0d4c,312.74
003d9fc84ad902adf2265248b5ffe1a4,94.74

2025-01-25 10:12:59 - root - INFO - SQL:
SELECT "payment_type", AVG("payment_installments") AS "average_installments"
   FROM "olist_order_payments"
   GROUP BY "payment_type"
   LIMIT 100;
Results:
payment_type,average_installments
boleto,1.0
credit_card,3.507155413763917
debit_card,1.0
not_defined,1.0
voucher,1.0

2025-01-25 10:12:59 - root - INFO - SQL:
SELECT "product_id", "product_category_name"
   FROM "olist_products"
   LIMIT 100;
Results:
product_id,product_category_name
1e9e8ef04dbcff4541ed26657ea517e5,perfumaria
3aa071139cb16b67ca9e5dea641aaa2f,artes
96bd76ec8810374ed1b65e291975717f,esporte_lazer
cef67bcfe19066a932b7673e239eb23d,bebes
9dc1a7de274444849c219cff195d0b71,utilidades_domesticas
41d3672d4792049fa1779bb35283ed13,instrumentos_musicais
732bd381ad09e530fe0a5f457d81becb,cool_stuff
2548af3e6e77a690cf3eb6368e9ab61e,moveis_decoracao
37cc742be07708b53a98702e77a21a02,eletrodomesticos
8c92109888e8cdf9d66dc7e463025574,brinquedos
14aa47b7fe5c25522b47b4b29c98dcb9,cama_mesa_banho
03b63c5fc16691530586ae020c345514,bebes
cf55509ea8edaaac1d28fdb16e48fc22,instrumentos_musicais
7bb6f29c2be57716194f96496660c7c2,moveis_decoracao
eb31436580a610f202c859463d8c7415,construcao_ferramentas_seguranca
3bb7f144022e6732727d8d838a7b13b3,esporte_lazer
6a2fb4dd53d2cdb88e0432f1284a004c,perfumaria
a1b71017a84f92fd8da4aeefba108a24,informatica_acessorios
a0736b92e52f6cead290e30b578413b6,moveis_decoracao
f53103a77d9cf245e579ea37e5ec51f0,cama_mesa_banho
1c1890ba1779090cd54008a3c3302921,moveis_decoracao
518ef5de2c2b3a255e326a4594ba15d9,cama_mesa_banho
e3e020af31d4d89d2602272b315c3f6e,beleza_saude
8b41fbc2b984a12030090112324d1bc4,bebes
d03bd02af9fff4b98f1c972315e5e9ef,moveis_decoracao
8ba4f2a4ae695d26e5626c1bf710975e,utilidades_domesticas
f6574524b07d5bb753bab6f35abe2d06,malas_acessorios
c78b767da00efb70c1bcccab87c28cd5,informatica_acessorios
a0253d43394dd4da9a5d7b1f546f1a32,informatica_acessorios
051b9ff13dd55c0a6655a15ff296f80d,esporte_lazer
47859fca9dd7485cbd93c3e8993bb74f,cama_mesa_banho
e1d1d22e9f8122a4ec1533b032c12562,ferramentas_jardim
20e37962088a4061d3578def47a8648b,moveis_decoracao
1eba879220bd0981a0e2fbab499ed4e1,moveis_escritorio
ce5b91848b91118daffb3af53b747475,esporte_lazer
5370b82a213393979691c98074265584,bebes
b8dac5113b06a97e64943234522572b9,automotivo
750cf819d127191920eda79a4b6fb479,eletronicos
e6af694343b45b56304ad91974a110b9,utilidades_domesticas
680874c570dad71c0a2844cfbf417054,moveis_decoracao
8b3a9476f74f5297f7ff0ec6d95fe1ea,moveis_decoracao
1c6fb703c624b381a20f21f757694866,brinquedos
db46052aed7dff59ba38cf2fe29b87f9,cama_mesa_banho
b864b103180d5a6a3f830e67f93e8735,bebes
7a8dac4aaa16bc642e4df33adcf03303,cool_stuff
83b9bc6aae6f527ff6aafb9e01d6cbf3,brinquedos
5f504b3a1c75b73d6151be81eb05bdc9,cool_stuff
bbf920aa6ac72007a726e6f419156f8f,moveis_decoracao
c3b7e4d83e530c27a8e6368296aece48,moveis_decoracao
c5d8079278e912d7e3b6beb48ecb56e8,beleza_saude
5eaa343860dc445b3fd43d1b682809fd,esporte_lazer
b5cfb1d3c5e435a7a52227e08f220ee7,cool_stuff
334479e94cba98064050db1c9636e244,automotivo
3fcd8dfe610c62edfb51de2630cd9ef4,bebes
4c8056caed5757810b9a68b83c3759e6,malas_acessorios
30e77af9e7759bbaa0305d2fbc605dc4,fashion_calcados
92bf5d2084dfbcb57d9db7838bac5cd0,telefonia
fdeb34a9f03fea7c3937dd62d1d0287e,cool_stuff
1065dbb6b0bf03daaedab1236979e296,papelaria
0d826eba8e0a2ae3bca9e3a947dd756d,brinquedos
f8f6fd145cc00519283cf3100477b2b3,esporte_lazer
4e04ffb7dd3739ecfc37de8927dd586c,papelaria
36555a2f528d7b2a255c504191445d39,beleza_saude
22937a73f92a33040ab4e2540355a5d8,fashion_bolsas_e_acessorios
dc21247da0290904ffbbcd5953c76f95,papelaria
9020ce7adcc384b2899ae87ddc54767b,papelaria
bfc1d1c62b1f7f401d8d9dda962bb870,esporte_lazer
6fef6d87bb6c2eb11d57a967209219a8,ferramentas_jardim
1e5428c428e0f783acd6e3d94ba4ee2a,pcs
94080f9219044d897195e2be145945dc,automotivo
d0389f20b3d11de54e1e4561df147683,casa_construcao
3e9b58f1436820c248d3f98d7229bb14,relogios_presentes
575c38b4c88fc7b35ef22fc8312bfe1b,cool_stuff
556702ebb73d3786a852ad3d5a8ad268,construcao_ferramentas_construcao
a3a03c131926ec14d4c9f3ef03016b24,pet_shop
e586ebb6022265ae1eea38f46ffe3ead,beleza_saude
278b3c6462e86b4556b99989513ddf73,eletroportateis
0d009643171aee696f4733340bc2fdd0,perfumaria
be1be330cf34043d1c40d6114cbd11b5,relogios_presentes
07f01b6fcacc1b187a71e5074199db2d,agro_industria_e_comercio
75b4372e69a42f8ae1d908c076f547b2,beleza_saude
3569d4374a919941a50f57371b1dc93d,beleza_saude
a3c95dc653d9a279b160bc0179385ed1,cama_mesa_banho
0992c6cba95a13bfa68ea7d5e22d478b,ferramentas_jardim
b1eae565a61935e0011ee7682fef9dc9,perfumaria
2734390ee304b0f4817b3c233094fc16,instrumentos_musicais
32ee3f4e2493045726807808d7abbab6,cama_mesa_banho
c2367eda4f9623d0355dc5d7796d857a,cama_mesa_banho
7f34b85142d1ef9e077a0da9ada27385,moveis_decoracao
c478b1bbf9ec8c5691f37ccb83187386,informatica_acessorios
f9ecf420c38b90a8af8e7f70fd789264,esporte_lazer
3a6a0247ced9dcb444b46caafdcdd368,beleza_saude
adf591c625cb265c12bc6749d3a2f757,beleza_saude
3e0f398b664b26e3224c79dbf435191f,esporte_lazer
64c8f1a52b407d92518a1f8b79240a70,telefonia
af16005fca813272caf59c432153949e,moveis_decoracao
e6a1ff3552ba3305c1cf0a4dde50347f,automotivo
d8a405c732027a2af3187b031890933d,automotivo
ce94e3c41145e28428cdae952a1fd7f2,relogios_presentes
3f0f8de616df6efb39a48f3c64eea974,cama_mesa_banho

2025-01-25 10:12:59 - root - INFO - SQL:
SELECT "order_id", "product_id"
    FROM "olist_order_items"
    LIMIT 100;
Results:
Too long, hard cut:
order_id,product_id
00010242fe8c5a6d1ba2dd792cb16214,4244733e06e7ecb4970a6e2683c13e61
00018f77f2f0320c557190d7a144bdd3,e5f2d52b802189ee658865ca93d83a8f
000229ec398224ef6ca0657da4fc703e,c777355d18b72b67abbeef9df44fd0fd
00024acbcdf0a6daa1e931b038114c75,7634da152a4610f1595efa32f14722fc
00042b26cf59d7ce69dfabb4e55b4fd9,ac6c3623068f30de03045865e4e10089
00048cc3ae777c65dbb7d2a0634bc1ea,ef92defde845ab8450f9d70c526ef70f
00054e8431b9d7675808bcb819fb4a32,8d4f2bb7e93e6710a28f34fa83ee7d28
000576fe39319847cbb9d288c5617fa6,557d850972a7d6f792fd18ae1400d9b6
0005a1a1728c9d785b8e2b08b904576c,310ae3c140ff94b03219ad0adc3c778f
0005f50442cb953dcd1d21e1fb923495,4535b0e1091c278dfd193e5a1d63b39f
00061f2a7bc09da83e415a52dc8a4af1,d63c1011f49d98b976c352955b1c4bea
00063b381e2406b52ad429470734ebd5,f177554ea93259a5b282f24e33f65ab6
0006ec9db01a64e59a68b2c340bf65a7,99a4788cb24856965c36a24e339b6058
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db
0009792311464db532ff765bf7b182ae,8cab8abac59158715e0d70a36c807415
0009c9a17f916a706d71784483a5d643,3f27ac8e699df3d300ec4a5d8c5cf0b2
000aed2e25dbad2f9ddb70584c5a2ded,4fa33915031a8cde03dd0d3e8fb27f01
000c3e6612759851cc3cbb4b83257986,b50c950aba0dcead2c48032a690ce817
000e562887b1f2006d75e0be9558292e,5ed9eaf534f6936b51d0b6c5e4d5c2e9
000e63d38ae8c00bbcb5a30573b99628,553e0e7590d3116a072507a3635d2877
000e906b789b55f64edcb1f84030f90d,57d79905de06d8897872c551bfd09358
000f25f4d72195062c040b12dce9a18a,1c05e0964302b6cf68ca0d15f326c6ba
001021efaa8636c29475e7734483457d,5d7c23067ed3fc8c6e699b9373d5890b
0010b2e5201cc5f1ae7e9c6cc8f5bd00,5a419dbf24a8c9718fe522b81c69f61a
00119ff934e539cf26f92b9ef0cdfed8,21b1c2f67a9aafb5af0eb06c13b9dbda
0011d82c4b53e22e84023405fb467e57,c389f712c4b4510bc997cee93e8b1a28
00125cb692d04887809806618a2a145f,1c0c0093a48f13ba70d0c6b0a9157cb7
00130c0eee84a3d909e75bc08c5c3ca1,89321f94e35fc6d7903d36f74e351d40
0013503b13da1eac686219390b7d641b,38afdf723b95d455b418a0f57d623c6b
00137e170939bba5a3134e2386413108,672e757f331900b9deea127a2a7b79fd
001427c0ec99cf8af737bd88e92fd444,28b4eced95a52d9c437a4caf9d311b95
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a
0014ae671de39511f7575066200733b7,23365beed316535b4105bd800c46670e
0015ebb40fb17286bea51d4607c4733c,50fd2b788dc166edd20512370dac54df
00169e31ef4b29deaae414f9a5e95929,b10eba910a974df70b8a12d0665cdb9e
0016dfedd97fc2950e388d2971d718c7,4089861a1bd4685da70bddd6b4f974f1
0017afd5076e074a48f1f1a4c7bac9c5,fe59a1e006df3ac42bf0ceb876d70969
001862358bf858722e1e2ae000cfed8b,c6dd917a0be2a704582055949915ab32
0019c29108428acffd089c36103c9440,28b4eced95a52d9c437a4caf9d311b95
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2
001ac194d4a326a6fa99b581e9a3d963,dbaee28f4ee64465838a229582d77520
001b76dd48a5b1eee3e87778daa40df8,dbb67791e405873b259e4656bf971246
001c85b5f68d2be0cb0797afc9e8ce9a,84f456958365164420cfc80fbe4c7fab
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c
001daeb0eddc45b999bad0801ad9d273,30c01cc81c9eb80469371743813789cc
001dbc16dc51075e987543d23a0507c7,777d2e438a1b645f3aec9bd57e92672c
001e7ba991be1b19605ca0316e7130f9,884fa3cd42986ba480ea2f8ae4e25ff7
001e7cf2ad6bef3ade12ebc56ceaf0f3,bdcf6a834e8faa30dac3886c7a58e92e
0020262c8a370bd5a174ea6a2a267321,a5341e3f8155dbb3e62323d3ea289729
0020a222f55eb79a372d0efee3cca688,e19ddcc85537b41f22116c8d5425ef46
002175704e8b209f61b9ad5cfd92b60e,e6b6e13cf71449a457269f425b89dc74
00229e4e43f7a7e0b9dd819ad43268d3,13fcfc313dfb2217e5ee3000a702f9ef
0025081dcf9330f9a5052ae82c6ce396,4e3f399366b0047a572b6682f9bb166e
00254baeb6c932b0a8aeead91fbd02b5,18901878788fec7ddc55e64d1ace8187
00259a44fcad3fc0474329e925d14fc3,0c4d0a08f95c7b7dc5dc7402bfdafd4c
0025c5d1a8ca53a240ec2634bb4492ea,35537536ed2b4c561b4018bf3abf54e0
002611a77fe03d076285fd4ca95db77c,fe077ec80df6b4ee60bb4498d5ab1962
002691433f09002ac9ca0c4e8dbb8ead,430d215740da7fdda91cc938f8fd92f6
0026a368634b6e6f34f33b1499773a30,892832da5b05b0f54578e1f14f193c22
00275bce676303c3bfd7292aefdfa223,6490b9f63b0b595e1c1402b46b0f50ad
00276d5c3491fbf55305e26891040df9,71c89e9d8fa274b017279aa322cd0e19
002834535f7a609a5c68266f173fa59e,df3655ac9aa8c6cbfa63bdd8d3b09c50
0028de0ca693a1bb26448916a81105cc,059344baebbeaa42fa9f2bbe11b1583e
002955b0acc63d04f6724a31967e82bd,d9bdf643d95cb89844c0da1a0df1d16e
0029c5db35ef291ce99d1262012e7daa,7614c62b86a81021243e438cfde78ccc
0029f17cf0e7640c5cb6825af681303f,01c666c82f414c762ad21bffa56e8b49
002af7fa9eb99d1456bceb6a13d6fc0b,c2ece64199af7a53793ed9612a89a8cd
002b430ff89b3a24c31a1170acbbedea,cc47c0863559499f01b4cad750929d10
002b4e6fa42cd4a22cc86abc18fe9c05,a6f449f6257f26e556013151cee46b4b
002c9def9c9b951b1bec6d50753c98

2025-01-25 10:13:04 - root - INFO - SQL:
SELECT ooi."order_id", ooi."product_id", oop."payment_type", oop."payment_value"
    FROM "olist_order_items" AS ooi
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    LIMIT 100;
Results:
Too long, hard cut:
order_id,product_id,payment_type,payment_value
00010242fe8c5a6d1ba2dd792cb16214,4244733e06e7ecb4970a6e2683c13e61,credit_card,72.19
00018f77f2f0320c557190d7a144bdd3,e5f2d52b802189ee658865ca93d83a8f,credit_card,259.83
000229ec398224ef6ca0657da4fc703e,c777355d18b72b67abbeef9df44fd0fd,credit_card,216.87
00024acbcdf0a6daa1e931b038114c75,7634da152a4610f1595efa32f14722fc,credit_card,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,ac6c3623068f30de03045865e4e10089,credit_card,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,ef92defde845ab8450f9d70c526ef70f,boleto,34.59
00054e8431b9d7675808bcb819fb4a32,8d4f2bb7e93e6710a28f34fa83ee7d28,credit_card,31.75
000576fe39319847cbb9d288c5617fa6,557d850972a7d6f792fd18ae1400d9b6,credit_card,880.75
0005a1a1728c9d785b8e2b08b904576c,310ae3c140ff94b03219ad0adc3c778f,credit_card,157.6
0005f50442cb953dcd1d21e1fb923495,4535b0e1091c278dfd193e5a1d63b39f,credit_card,65.39
00061f2a7bc09da83e415a52dc8a4af1,d63c1011f49d98b976c352955b1c4bea,credit_card,68.87
00063b381e2406b52ad429470734ebd5,f177554ea93259a5b282f24e33f65ab6,credit_card,57.98
0006ec9db01a64e59a68b2c340bf65a7,99a4788cb24856965c36a24e339b6058,credit_card,97.32
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db,boleto,126.54
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db,boleto,126.54
0009792311464db532ff765bf7b182ae,8cab8abac59158715e0d70a36c807415,boleto,127.55
0009c9a17f916a706d71784483a5d643,3f27ac8e699df3d300ec4a5d8c5cf0b2,credit_card,650.34
000aed2e25dbad2f9ddb70584c5a2ded,4fa33915031a8cde03dd0d3e8fb27f01,credit_card,152.77
000c3e6612759851cc3cbb4b83257986,b50c950aba0dcead2c48032a690ce817,boleto,112.71
000e562887b1f2006d75e0be9558292e,5ed9eaf534f6936b51d0b6c5e4d5c2e9,credit_card,41.11
000e63d38ae8c00bbcb5a30573b99628,553e0e7590d3116a072507a3635d2877,credit_card,56.78
000e906b789b55f64edcb1f84030f90d,57d79905de06d8897872c551bfd09358,credit_card,33.84
000f25f4d72195062c040b12dce9a18a,1c05e0964302b6cf68ca0d15f326c6ba,credit_card,164.39
001021efaa8636c29475e7734483457d,5d7c23067ed3fc8c6e699b9373d5890b,credit_card,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,5a419dbf24a8c9718fe522b81c69f61a,credit_card,65.5
00119ff934e539cf26f92b9ef0cdfed8,21b1c2f67a9aafb5af0eb06c13b9dbda,credit_card,236.88
0011d82c4b53e22e84023405fb467e57,c389f712c4b4510bc997cee93e8b1a28,credit_card,315.33
00125cb692d04887809806618a2a145f,1c0c0093a48f13ba70d0c6b0a9157cb7,credit_card,135.41
00130c0eee84a3d909e75bc08c5c3ca1,89321f94e35fc6d7903d36f74e351d40,boleto,35.84
0013503b13da1eac686219390b7d641b,38afdf723b95d455b418a0f57d623c6b,boleto,137.22
00137e170939bba5a3134e2386413108,672e757f331900b9deea127a2a7b79fd,boleto,421.65
001427c0ec99cf8af737bd88e92fd444,28b4eced95a52d9c437a4caf9d311b95,credit_card,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a,credit_card,109.29
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a,credit_card,109.29
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a,credit_card,109.29
0014ae671de39511f7575066200733b7,23365beed316535b4105bd800c46670e,boleto,30.6
0015ebb40fb17286bea51d4607c4733c,50fd2b788dc166edd20512370dac54df,credit_card,37.0
00169e31ef4b29deaae414f9a5e95929,b10eba910a974df70b8a12d0665cdb9e,boleto,55.11
0016dfedd97fc2950e388d2971d718c7,4089861a1bd4685da70bddd6b4f974f1,credit_card,52.63
0016dfedd97fc2950e388d2971d718c7,4089861a1bd4685da70bddd6b4f974f1,voucher,17.92
0017afd5076e074a48f1f1a4c7bac9c5,fe59a1e006df3ac42bf0ceb876d70969,credit_card,853.39
001862358bf858722e1e2ae000cfed8b,c6dd917a0be2a704582055949915ab32,credit_card,113.71
0019c29108428acffd089c36103c9440,28b4eced95a52d9c437a4caf9d311b95,credit_card,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2,boleto,127.56
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2,boleto,127.56
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2,boleto,127.56
001ac194d4a326a6fa99b581e9a3d963,dbaee28f4ee64465838a229582d77520,boleto,62.54
001b76dd48a5b1eee3e87778daa40df8,dbb67791e405873b259e4656bf971246,credit_card,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,84f456958365164420cfc80fbe4c7fab,credit_card,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c,credit_card,53.54
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c,credit_card,53.54
001daeb0eddc45b999bad0801ad9d273,30c01cc81c9eb80469371743813789cc,boleto,55.12
001dbc16dc51075e987543d23a0507c7,777d2e438a1b645f3aec9bd57e92672c,credit_card,87.9
001e7ba991be1b19605ca0316e7130f9,884fa3cd42986ba480ea2f8ae4e25ff7,credit_card,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,bdcf6a834e8faa30dac3886c7a58e92e,credit_card,51.1
0020262c8a370bd5a174ea6a2a267321,a5341e3f8155dbb3e62323d3ea289729,credit_card,100.55
0020a222f55eb79a372d0efee3cca688,e19ddcc85537b41f22116c8d5425ef46,credit_card,45.09
002175704e8b209f61b9ad5cfd92b60e,e6b6e13cf71449a457269f425b89dc74,credit_card,123.11
00229e4e43f7a7e0b9dd819ad43268d3,13fcfc313dfb2217e5ee3000a702f9ef,credit_card,91.39
0025081dcf9330f9a5052ae82c6ce396,4e3f399366b0047a572b66

2025-01-25 10:13:08 - root - INFO - SQL:
SELECT pt."product_category_name_english", oop."payment_type"
    FROM "olist_order_items" AS ooi
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    LIMIT 100;
Results:
product_category_name_english,payment_type
cool_stuff,credit_card
pet_shop,credit_card
furniture_decor,credit_card
perfumery,credit_card
garden_tools,credit_card
housewares,boleto
telephony,credit_card
garden_tools,credit_card
health_beauty,credit_card
books_technical,credit_card
health_beauty,credit_card
fashion_bags_accessories,credit_card
bed_bath_table,credit_card
garden_tools,boleto
garden_tools,boleto
sports_leisure,boleto
consoles_games,credit_card
perfumery,credit_card
sports_leisure,boleto
cool_stuff,credit_card
bed_bath_table,credit_card
telephony,credit_card
office_furniture,credit_card
fashion_bags_accessories,credit_card
cool_stuff,credit_card
sports_leisure,credit_card
luggage_accessories,credit_card
furniture_decor,credit_card
food,boleto
furniture_decor,boleto
agro_industry_and_commerce,boleto
furniture_decor,credit_card
sports_leisure,credit_card
sports_leisure,credit_card
sports_leisure,credit_card
telephony,boleto
electronics,credit_card
bed_bath_table,boleto
garden_tools,credit_card
garden_tools,voucher
computers_accessories,credit_card
cool_stuff,credit_card
furniture_decor,credit_card
electronics,boleto
electronics,boleto
electronics,boleto
construction_tools_construction,boleto
computers_accessories,credit_card
bed_bath_table,credit_card
health_beauty,credit_card
health_beauty,credit_card
pet_shop,boleto
bed_bath_table,credit_card
computers_accessories,credit_card
health_beauty,credit_card
furniture_decor,credit_card
furniture_decor,credit_card
audio,credit_card
sports_leisure,credit_card
books_technical,credit_card
baby,credit_card
computers_accessories,credit_card
sports_leisure,credit_card
computers_accessories,boleto
telephony,credit_card
cool_stuff,credit_card
telephony,boleto
furniture_decor,credit_card
telephony,boleto
construction_tools_lights,boleto
perfumery,credit_card
health_beauty,boleto
toys,credit_card
furniture_decor,credit_card
cool_stuff,credit_card
stationery,credit_card
housewares,credit_card
housewares,credit_card
perfumery,boleto
furniture_decor,debit_card
bed_bath_table,voucher
bed_bath_table,voucher
consoles_games,credit_card
toys,credit_card
housewares,credit_card
baby,credit_card
housewares,credit_card
industry_commerce_and_business,boleto
housewares,credit_card
luggage_accessories,credit_card
luggage_accessories,credit_card
toys,boleto
pet_shop,credit_card
bed_bath_table,credit_card
bed_bath_table,credit_card
garden_tools,boleto
health_beauty,credit_card
bed_bath_table,credit_card
cool_stuff,credit_card
furniture_decor,credit_card

2025-01-25 10:13:13 - root - INFO - SQL:
SELECT pt."product_category_name_english", oop."payment_type", COUNT(*) AS "payment_count"
    FROM "olist_order_items" AS ooi
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    GROUP BY pt."product_category_name_english", oop."payment_type"
    ORDER BY "payment_count" DESC
    LIMIT 100;
Results:
product_category_name_english,payment_type,payment_count
bed_bath_table,credit_card,8959
health_beauty,credit_card,7566
sports_leisure,credit_card,6635
furniture_decor,credit_card,6379
computers_accessories,credit_card,5436
housewares,credit_card,5411
watches_gifts,credit_card,4858
telephony,credit_card,3400
toys,credit_card,3294
auto,credit_card,3277
garden_tools,credit_card,3206
cool_stuff,credit_card,2977
perfumery,credit_card,2706
baby,credit_card,2426
computers_accessories,boleto,2158
electronics,credit_card,2023
stationery,credit_card,1978
bed_bath_table,boleto,1875
health_beauty,boleto,1860
sports_leisure,boleto,1772
furniture_decor,boleto,1735
fashion_bags_accessories,credit_card,1529
pet_shop,credit_card,1526
housewares,boleto,1326
office_furniture,credit_card,1194
garden_tools,boleto,1032
watches_gifts,boleto,1025
telephony,boleto,1022
luggage_accessories,credit_card,890
consoles_games,credit_card,869
bed_bath_table,voucher,847
auto,boleto,840
toys,boleto,735
cool_stuff,boleto,731
construction_tools_construction,credit_card,729
electronics,boleto,652
home_appliances,credit_card,617
perfumery,boleto,591
baby,boleto,554
small_appliances,credit_card,538
furniture_decor,voucher,530
musical_instruments,credit_card,506
housewares,voucher,505
home_construction,credit_card,484
office_furniture,boleto,482
stationery,boleto,466
fashion_bags_accessories,boleto,422
sports_leisure,voucher,411
books_general_interest,credit_card,410
furniture_living_room,credit_card,399
health_beauty,voucher,389
food,credit_card,381
pet_shop,boleto,366
home_confort,credit_card,346
computers_accessories,voucher,340
drinks,credit_card,300
garden_tools,voucher,267
audio,credit_card,263
watches_gifts,voucher,255
consoles_games,boleto,243
cool_stuff,voucher,240
air_conditioning,credit_card,222
market_place,credit_card,222
kitchen_dining_laundry_garden_furniture,credit_card,219
telephony,voucher,219
fashion_shoes,credit_card,215
perfumery,voucher,215
construction_tools_lights,credit_card,214
industry_commerce_and_business,credit_card,205
toys,voucher,199
books_technical,credit_card,196
food_drink,credit_card,194
costruction_tools_garden,credit_card,191
auto,voucher,190
fixed_telephony,credit_card,186
home_appliances_2,credit_card,185
construction_tools_construction,boleto,181
computers,credit_card,174
baby,voucher,172
fashion_bags_accessories,voucher,170
luggage_accessories,boleto,166
health_beauty,debit_card,157
art,credit_card,153
musical_instruments,boleto,152
computers_accessories,debit_card,148
agro_industry_and_commerce,credit_card,145
construction_tools_safety,credit_card,145
bed_bath_table,debit_card,142
home_appliances,boleto,136
stationery,voucher,135
signaling_and_security,credit_card,131
books_general_interest,boleto,130
small_appliances,boleto,127
sports_leisure,debit_card,127
christmas_supplies,credit_card,120
housewares,debit_card,113
home_construction,boleto,111
food,boleto,106
fashion_male_clothing,credit_card,104
pet_shop,voucher,102

2025-01-25 10:13:18 - root - INFO - SQL:
SELECT pt."product_category_name_english", oop."payment_type", AVG(payment_counts."payment_count") AS "average_payment_count"
    FROM (
      SELECT "order_id", COUNT(*) AS "payment_count"
      FROM "olist_order_payments"
      GROUP BY "order_id"
    ) AS payment_counts
    JOIN "olist_order_items" AS ooi ON payment_counts."order_id" = ooi."order_id"
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    GROUP BY pt."product_category_name_english", oop."payment_type"
    LIMIT 100;
Results:
product_category_name_english,payment_type,average_payment_count
agro_industry_and_commerce,boleto,1.0
agro_industry_and_commerce,credit_card,1.1793103448275861
agro_industry_and_commerce,debit_card,1.0
agro_industry_and_commerce,voucher,11.904761904761905
air_conditioning,boleto,1.0
air_conditioning,credit_card,1.027027027027027
air_conditioning,debit_card,1.0
air_conditioning,voucher,1.5
art,boleto,1.0
art,credit_card,1.0588235294117647
art,debit_card,1.0
art,voucher,2.1538461538461537
arts_and_craftmanship,boleto,1.0
arts_and_craftmanship,credit_card,1.0
arts_and_craftmanship,debit_card,1.0
audio,boleto,1.0
audio,credit_card,1.0570342205323193
audio,debit_card,1.0
audio,voucher,2.0
auto,boleto,1.0
auto,credit_card,1.0384498016478487
auto,debit_card,1.0
auto,voucher,2.3473684210526318
baby,boleto,1.0
baby,credit_card,1.0511129431162407
baby,debit_card,1.0
baby,voucher,2.7093023255813953
bed_bath_table,boleto,1.0
bed_bath_table,credit_card,1.059939725415783
bed_bath_table,debit_card,1.0
bed_bath_table,voucher,5.242030696576151
books_general_interest,boleto,1.0
books_general_interest,credit_card,1.0365853658536586
books_general_interest,debit_card,1.0
books_general_interest,voucher,1.7647058823529411
books_imported,boleto,1.0
books_imported,credit_card,1.0434782608695652
books_imported,voucher,2.0
books_technical,boleto,1.0
books_technical,credit_card,1.0204081632653061
books_technical,debit_card,1.0
books_technical,voucher,1.6666666666666667
cds_dvds_musicals,boleto,1.0
cds_dvds_musicals,credit_card,1.0
christmas_supplies,boleto,1.0
christmas_supplies,credit_card,1.0166666666666666
christmas_supplies,debit_card,1.0
christmas_supplies,voucher,2.0
cine_photo,boleto,1.0
cine_photo,credit_card,1.0222222222222221
cine_photo,debit_card,1.0
cine_photo,voucher,1.5
computers,boleto,1.0
computers,credit_card,1.1264367816091954
computers,voucher,3.8333333333333335
computers_accessories,boleto,1.0
computers_accessories,credit_card,1.0382634289919057
computers_accessories,debit_card,1.0
computers_accessories,voucher,2.8058823529411763
consoles_games,boleto,1.0
consoles_games,credit_card,1.0655926352128884
consoles_games,debit_card,1.0
consoles_games,voucher,2.19672131147541
construction_tools_construction,boleto,1.0
construction_tools_construction,credit_card,1.0315500685871055
construction_tools_construction,debit_card,1.0
construction_tools_construction,voucher,2.4
construction_tools_lights,boleto,1.0
construction_tools_lights,credit_card,1.0327102803738317
construction_tools_lights,debit_card,1.0
construction_tools_lights,voucher,2.0833333333333335
construction_tools_safety,boleto,1.0
construction_tools_safety,credit_card,1.0344827586206897
construction_tools_safety,debit_card,1.0
construction_tools_safety,voucher,1.8333333333333333
cool_stuff,boleto,1.0
cool_stuff,credit_card,1.0557608330534094
cool_stuff,debit_card,1.0
cool_stuff,voucher,3.4833333333333334
costruction_tools_garden,boleto,1.0
costruction_tools_garden,credit_card,1.036649214659686
costruction_tools_garden,debit_card,1.0
costruction_tools_garden,voucher,2.2857142857142856
costruction_tools_tools,boleto,1.0
costruction_tools_tools,credit_card,1.0256410256410255
costruction_tools_tools,debit_card,1.0
costruction_tools_tools,voucher,1.6666666666666667
diapers_and_hygiene,boleto,1.0
diapers_and_hygiene,credit_card,1.0
drinks,boleto,1.0
drinks,credit_card,1.0233333333333334
drinks,debit_card,1.0
drinks,voucher,2.0
dvds_blu_ray,boleto,1.0
dvds_blu_ray,credit_card,1.0416666666666667
dvds_blu_ray,voucher,5.0
electronics,boleto,1.0
electronics,credit_card,1.037073652990608
electronics,debit_card,1.0
electronics,voucher,6.242424242424242

2025-01-25 10:13:23 - root - INFO - SQL:
SELECT category_payment."product_category_name_english", category_payment."payment_type", MAX(category_payment."payment_count") AS "max_payment_count"
    FROM (
      SELECT pt."product_category_name_english", oop."payment_type", COUNT(*) AS "payment_count"
      FROM "olist_order_items" AS ooi
      JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
      JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
      JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
      GROUP BY pt."product_category_name_english", oop."payment_type"
    ) AS category_payment
    GROUP BY category_payment."product_category_name_english"
    ORDER BY "max_payment_count" DESC
    LIMIT 100;
Results:
product_category_name_english,payment_type,max_payment_count
bed_bath_table,credit_card,8959
health_beauty,credit_card,7566
sports_leisure,credit_card,6635
furniture_decor,credit_card,6379
computers_accessories,credit_card,5436
housewares,credit_card,5411
watches_gifts,credit_card,4858
telephony,credit_card,3400
toys,credit_card,3294
auto,credit_card,3277
garden_tools,credit_card,3206
cool_stuff,credit_card,2977
perfumery,credit_card,2706
baby,credit_card,2426
electronics,credit_card,2023
stationery,credit_card,1978
fashion_bags_accessories,credit_card,1529
pet_shop,credit_card,1526
office_furniture,credit_card,1194
luggage_accessories,credit_card,890
consoles_games,credit_card,869
construction_tools_construction,credit_card,729
home_appliances,credit_card,617
small_appliances,credit_card,538
musical_instruments,credit_card,506
home_construction,credit_card,484
books_general_interest,credit_card,410
furniture_living_room,credit_card,399
food,credit_card,381
home_confort,credit_card,346
drinks,credit_card,300
audio,credit_card,263
market_place,credit_card,222
air_conditioning,credit_card,222
kitchen_dining_laundry_garden_furniture,credit_card,219
fashion_shoes,credit_card,215
construction_tools_lights,credit_card,214
industry_commerce_and_business,credit_card,205
books_technical,credit_card,196
food_drink,credit_card,194
costruction_tools_garden,credit_card,191
fixed_telephony,credit_card,186
home_appliances_2,credit_card,185
computers,credit_card,174
art,credit_card,153
construction_tools_safety,credit_card,145
agro_industry_and_commerce,credit_card,145
signaling_and_security,credit_card,131
christmas_supplies,credit_card,120
fashion_male_clothing,credit_card,104
fashion_underwear_beach,credit_card,101
costruction_tools_tools,credit_card,78
furniture_bedroom,credit_card,76
tablets_printing_image,credit_card,65
small_appliances_home_oven_and_coffee,credit_card,65
dvds_blu_ray,credit_card,48
books_imported,credit_card,46
cine_photo,credit_card,45
fashio_female_clothing,credit_card,35
furniture_mattress_and_upholstery,credit_card,33
diapers_and_hygiene,credit_card,32
party_supplies,credit_card,30
music,credit_card,28
flowers,credit_card,26
home_comfort_2,credit_card,23
fashion_sport,credit_card,17
arts_and_craftmanship,credit_card,14
la_cuisine,credit_card,13
cds_dvds_musicals,credit_card,9
fashion_childrens_clothes,credit_card,5
security_and_services,boleto,1

2025-01-25 10:13:23 - root - INFO - itercount: 0
2025-01-25 10:13:23 - root - INFO - Table: olist_customersDDL:
CREATE TABLE olist_customers (
	customer_id TEXT, 
	customer_unique_id TEXT, 
	customer_zip_code_prefix BIGINT, 
	customer_city TEXT, 
	customer_state TEXT
)
Table: olist_sellersDDL:
CREATE TABLE olist_sellers (
	seller_id TEXT, 
	seller_zip_code_prefix BIGINT, 
	seller_city TEXT, 
	seller_state TEXT
)
Table: olist_order_reviewsDDL:
CREATE TABLE olist_order_reviews (
	review_id TEXT, 
	order_id TEXT, 
	review_score BIGINT, 
	review_comment_title TEXT, 
	review_comment_message TEXT, 
	review_creation_date TEXT, 
	review_answer_timestamp TEXT
)
Table: olist_order_itemsDDL:
CREATE TABLE olist_order_items (
	order_id TEXT, 
	order_item_id BIGINT, 
	product_id TEXT, 
	seller_id TEXT, 
	shipping_limit_date TEXT, 
	price FLOAT, 
	freight_value FLOAT
)
Table: olist_productsDDL:
CREATE TABLE olist_products (
	product_id TEXT, 
	product_category_name TEXT, 
	product_name_lenght FLOAT, 
	product_description_lenght FLOAT, 
	product_photos_qty FLOAT, 
	product_weight_g FLOAT, 
	product_length_cm FLOAT, 
	product_height_cm FLOAT, 
	product_width_cm FLOAT
)
Table: olist_geolocationDDL:
CREATE TABLE olist_geolocation (
	geolocation_zip_code_prefix BIGINT, 
	geolocation_lat FLOAT, 
	geolocation_lng FLOAT, 
	geolocation_city TEXT, 
	geolocation_state TEXT
)
Table: product_category_name_translationDDL:
CREATE TABLE product_category_name_translation (
	product_category_name TEXT, 
	product_category_name_english TEXT
)
Table: olist_ordersDDL:
CREATE TABLE olist_orders (
	order_id TEXT, 
	customer_id TEXT, 
	order_status TEXT, 
	order_purchase_timestamp TEXT, 
	order_approved_at TEXT, 
	order_delivered_carrier_date TEXT, 
	order_delivered_customer_date TEXT, 
	order_estimated_delivery_date TEXT
)
Table: olist_order_paymentsDDL:
CREATE TABLE olist_order_payments (
	order_id TEXT, 
	payment_sequential BIGINT, 
	payment_type TEXT, 
	payment_installments BIGINT, 
	payment_value FLOAT
)
Table: olist_products_datasetDDL:
CREATE TABLE olist_products_dataset (
	"index" BIGINT, 
	product_id TEXT, 
	product_category_name TEXT, 
	product_name_lenght FLOAT, 
	product_description_lenght FLOAT, 
	product_photos_qty FLOAT, 
	product_weight_g FLOAT, 
	product_length_cm FLOAT, 
	product_height_cm FLOAT, 
	product_width_cm FLOAT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['olist_customers', 'olist_sellers', 'olist_order_reviews', 'olist_order_items', 'olist_products', 'olist_geolocation', 'product_category_name_translation', 'olist_orders', 'olist_order_payments', 'olist_products_dataset']
Begin Exploring Related Columns
Sure! Let's identify the relevant tables, columns, and potential conditions to address the task:

**Relevant Tables and Columns:**

1. **`olist_products`**
   - `product_id`: Identifies each product.
   - `product_category_name`: Product category in Portuguese.

2. **`product_category_name_translation`**
   - `product_category_name`: Product category in Portuguese.
   - `product_category_name_english`: Corresponding product category in English.

3. **`olist_order_items`**
   - `order_id`: Identifies each order.
   - `product_id`: Links products to orders.

4. **`olist_orders`**
   - `order_id`: Identifies each order.

5. **`olist_order_payments`**
   - `order_id`: Links payments to orders.
   - `payment_type`: Type of payment method used.
   - `payment_value`: Amount paid.
   - `payment_sequential`: Sequence of payments for an order.

**Potential Usage and Conditions:**

- **Joins:**
  - Join `olist_order_items` and `olist_products` on `product_id` to link products with their categories.
  - Join `olist_order_items` (or `olist_orders`) with `olist_order_payments` on `order_id` to associate payments with products.
  - Join `product_category_name_translation` to translate category names to English.

- **Conditions:**
  - Group data by `product_category_name_english` and `payment_type` to determine the most preferred payment method for each category.
  - Use aggregate functions like `COUNT(*)` and `AVG()` to calculate total payment counts and averages.

---

Here are SQL queries to explore the data and understand the values in related columns:

1. **Get distinct product categories in Portuguese:**

   ```sql
   SELECT DISTINCT "product_category_name"
   FROM "olist_products"
   LIMIT 100;
   ```

2. **Get distinct product categories in English:**

   ```sql
   SELECT DISTINCT "product_category_name_english"
   FROM "product_category_name_translation"
   LIMIT 100;
   ```

3. **Map product categories from Portuguese to English:**

   ```sql
   SELECT "product_category_name", "product_category_name_english"
   FROM "product_category_name_translation"
   LIMIT 100;
   ```

4. **Get distinct payment types:**

   ```sql
   SELECT DISTINCT "payment_type"
   FROM "olist_order_payments"
   LIMIT 100;
   ```

5. **Count of payment types:**

   ```sql
   SELECT "payment_type", COUNT(*) AS "payment_count"
   FROM "olist_order_payments"
   GROUP BY "payment_type"
   ORDER BY "payment_count" DESC
   LIMIT 100;
   ```

6. **Number of payments per order:**

   ```sql
   SELECT "order_id", COUNT(*) AS "payment_count"
   FROM "olist_order_payments"
   GROUP BY "order_id"
   LIMIT 100;
   ```

7. **Total payment value per order:**

   ```sql
   SELECT "order_id", SUM("payment_value") AS "total_payment_value"
   FROM "olist_order_payments"
   GROUP BY "order_id"
   LIMIT 100;
   ```

8. **Average number of installments per payment type:**

   ```sql
   SELECT "payment_type", AVG("payment_installments") AS "average_installments"
   FROM "olist_order_payments"
   GROUP BY "payment_type"
   LIMIT 100;
   ```

9. **List of products with their categories (in Portuguese):**

   ```sql
   SELECT "product_id", "product_category_name"
   FROM "olist_products"
   LIMIT 100;
   ```

10. **List of orders with their associated products:**

    ```sql
    SELECT "order_id", "product_id"
    FROM "olist_order_items"
    LIMIT 100;
    ```

11. **Payment information linked with order items:**

    ```sql
    SELECT ooi."order_id", ooi."product_id", oop."payment_type", oop."payment_value"
    FROM "olist_order_items" AS ooi
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    LIMIT 100;
    ```

12. **Product categories (English) with payment types:**

    ```sql
    SELECT pt."product_category_name_english", oop."payment_type"
    FROM "olist_order_items" AS ooi
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    LIMIT 100;
    ```

13. **Count of payments per product category and payment type:**

    ```sql
    SELECT pt."product_category_name_english", oop."payment_type", COUNT(*) AS "payment_count"
    FROM "olist_order_items" AS ooi
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    GROUP BY pt."product_category_name_english", oop."payment_type"
    ORDER BY "payment_count" DESC
    LIMIT 100;
    ```

14. **Average payment count for each payment type within each product category:**

    ```sql
    SELECT pt."product_category_name_english", oop."payment_type", AVG(payment_counts."payment_count") AS "average_payment_count"
    FROM (
      SELECT "order_id", COUNT(*) AS "payment_count"
      FROM "olist_order_payments"
      GROUP BY "order_id"
    ) AS payment_counts
    JOIN "olist_order_items" AS ooi ON payment_counts."order_id" = ooi."order_id"
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    GROUP BY pt."product_category_name_english", oop."payment_type"
    LIMIT 100;
    ```

15. **Most preferred payment method for each product category:**

    ```sql
    SELECT category_payment."product_category_name_english", category_payment."payment_type", MAX(category_payment."payment_count") AS "max_payment_count"
    FROM (
      SELECT pt."product_category_name_english", oop."payment_type", COUNT(*) AS "payment_count"
      FROM "olist_order_items" AS ooi
      JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
      JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
      JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
      GROUP BY pt."product_category_name_english", oop."payment_type"
    ) AS category_payment
    GROUP BY category_payment."product_category_name_english"
    ORDER BY "max_payment_count" DESC
    LIMIT 100;
    ```

These queries will help in understanding the relationships between product categories and payment methods, as well as calculating the average total payment counts for the most preferred payment methods in each product category.Query:
SELECT DISTINCT "product_category_name"
   FROM "olist_products"
   LIMIT 100;
Answer:
product_category_name
perfumaria
artes
esporte_lazer
bebes
utilidades_domesticas
instrumentos_musicais
cool_stuff
moveis_decoracao
eletrodomesticos
brinquedos
cama_mesa_banho
construcao_ferramentas_seguranca
informatica_acessorios
beleza_saude
malas_acessorios
ferramentas_jardim
moveis_escritorio
automotivo
eletronicos
fashion_calcados
telefonia
papelaria
fashion_bolsas_e_acessorios
pcs
casa_construcao
relogios_presentes
construcao_ferramentas_construcao
pet_shop
eletroportateis
agro_industria_e_comercio
""
moveis_sala
sinalizacao_e_seguranca
climatizacao
consoles_games
livros_interesse_geral
construcao_ferramentas_ferramentas
fashion_underwear_e_moda_praia
fashion_roupa_masculina
moveis_cozinha_area_de_servico_jantar_e_jardim
industria_comercio_e_negocios
telefonia_fixa
construcao_ferramentas_iluminacao
livros_tecnicos
eletrodomesticos_2
artigos_de_festas
bebidas
market_place
la_cuisine
construcao_ferramentas_jardim
fashion_roupa_feminina
casa_conforto
audio
alimentos_bebidas
musica
alimentos
tablets_impressao_imagem
livros_importados
portateis_casa_forno_e_cafe
fashion_esporte
artigos_de_natal
fashion_roupa_infanto_juvenil
dvds_blu_ray
artes_e_artesanato
pc_gamer
moveis_quarto
cine_foto
fraldas_higiene
flores
casa_conforto_2
portateis_cozinha_e_preparadores_de_alimentos
seguros_e_servicos
moveis_colchao_e_estofado
cds_dvds_musicais
Query:
SELECT DISTINCT "product_category_name_english"
   FROM "product_category_name_translation"
   LIMIT 100;
Answer:
product_category_name_english
health_beauty
computers_accessories
auto
bed_bath_table
furniture_decor
sports_leisure
perfumery
housewares
telephony
watches_gifts
food_drink
baby
stationery
tablets_printing_image
toys
fixed_telephony
garden_tools
fashion_bags_accessories
small_appliances
consoles_games
audio
fashion_shoes
cool_stuff
luggage_accessories
air_conditioning
construction_tools_construction
kitchen_dining_laundry_garden_furniture
costruction_tools_garden
fashion_male_clothing
pet_shop
office_furniture
market_place
electronics
home_appliances
party_supplies
home_confort
costruction_tools_tools
agro_industry_and_commerce
furniture_mattress_and_upholstery
books_technical
home_construction
musical_instruments
furniture_living_room
construction_tools_lights
industry_commerce_and_business
food
art
furniture_bedroom
books_general_interest
construction_tools_safety
fashion_underwear_beach
fashion_sport
signaling_and_security
computers
christmas_supplies
fashio_female_clothing
home_appliances_2
books_imported
drinks
cine_photo
la_cuisine
music
home_comfort_2
small_appliances_home_oven_and_coffee
cds_dvds_musicals
dvds_blu_ray
flowers
arts_and_craftmanship
diapers_and_hygiene
fashion_childrens_clothes
security_and_services
Query:
SELECT "product_category_name", "product_category_name_english"
   FROM "product_category_name_translation"
   LIMIT 100;
Answer:
product_category_name,product_category_name_english
beleza_saude,health_beauty
informatica_acessorios,computers_accessories
automotivo,auto
cama_mesa_banho,bed_bath_table
moveis_decoracao,furniture_decor
esporte_lazer,sports_leisure
perfumaria,perfumery
utilidades_domesticas,housewares
telefonia,telephony
relogios_presentes,watches_gifts
alimentos_bebidas,food_drink
bebes,baby
papelaria,stationery
tablets_impressao_imagem,tablets_printing_image
brinquedos,toys
telefonia_fixa,fixed_telephony
ferramentas_jardim,garden_tools
fashion_bolsas_e_acessorios,fashion_bags_accessories
eletroportateis,small_appliances
consoles_games,consoles_games
audio,audio
fashion_calcados,fashion_shoes
cool_stuff,cool_stuff
malas_acessorios,luggage_accessories
climatizacao,air_conditioning
construcao_ferramentas_construcao,construction_tools_construction
moveis_cozinha_area_de_servico_jantar_e_jardim,kitchen_dining_laundry_garden_furniture
construcao_ferramentas_jardim,costruction_tools_garden
fashion_roupa_masculina,fashion_male_clothing
pet_shop,pet_shop
moveis_escritorio,office_furniture
market_place,market_place
eletronicos,electronics
eletrodomesticos,home_appliances
artigos_de_festas,party_supplies
casa_conforto,home_confort
construcao_ferramentas_ferramentas,costruction_tools_tools
agro_industria_e_comercio,agro_industry_and_commerce
moveis_colchao_e_estofado,furniture_mattress_and_upholstery
livros_tecnicos,books_technical
casa_construcao,home_construction
instrumentos_musicais,musical_instruments
moveis_sala,furniture_living_room
construcao_ferramentas_iluminacao,construction_tools_lights
industria_comercio_e_negocios,industry_commerce_and_business
alimentos,food
artes,art
moveis_quarto,furniture_bedroom
livros_interesse_geral,books_general_interest
construcao_ferramentas_seguranca,construction_tools_safety
fashion_underwear_e_moda_praia,fashion_underwear_beach
fashion_esporte,fashion_sport
sinalizacao_e_seguranca,signaling_and_security
pcs,computers
artigos_de_natal,christmas_supplies
fashion_roupa_feminina,fashio_female_clothing
eletrodomesticos_2,home_appliances_2
livros_importados,books_imported
bebidas,drinks
cine_foto,cine_photo
la_cuisine,la_cuisine
musica,music
casa_conforto_2,home_comfort_2
portateis_casa_forno_e_cafe,small_appliances_home_oven_and_coffee
cds_dvds_musicais,cds_dvds_musicals
dvds_blu_ray,dvds_blu_ray
flores,flowers
artes_e_artesanato,arts_and_craftmanship
fraldas_higiene,diapers_and_hygiene
fashion_roupa_infanto_juvenil,fashion_childrens_clothes
seguros_e_servicos,security_and_services
Query:
SELECT DISTINCT "payment_type"
   FROM "olist_order_payments"
   LIMIT 100;
Answer:
payment_type
credit_card
boleto
voucher
debit_card
not_defined
Query:
SELECT "payment_type", COUNT(*) AS "payment_count"
   FROM "olist_order_payments"
   GROUP BY "payment_type"
   ORDER BY "payment_count" DESC
   LIMIT 100;
Answer:
payment_type,payment_count
credit_card,76795
boleto,19784
voucher,5775
debit_card,1529
not_defined,3
Query:
SELECT "order_id", COUNT(*) AS "payment_count"
   FROM "olist_order_payments"
   GROUP BY "order_id"
   LIMIT 100;
Answer:
order_id,payment_count
00010242fe8c5a6d1ba2dd792cb16214,1
00018f77f2f0320c557190d7a144bdd3,1
000229ec398224ef6ca0657da4fc703e,1
00024acbcdf0a6daa1e931b038114c75,1
00042b26cf59d7ce69dfabb4e55b4fd9,1
00048cc3ae777c65dbb7d2a0634bc1ea,1
00054e8431b9d7675808bcb819fb4a32,1
000576fe39319847cbb9d288c5617fa6,1
0005a1a1728c9d785b8e2b08b904576c,1
0005f50442cb953dcd1d21e1fb923495,1
00061f2a7bc09da83e415a52dc8a4af1,1
00063b381e2406b52ad429470734ebd5,1
0006ec9db01a64e59a68b2c340bf65a7,1
0008288aa423d2a3f00fcb17cd7d8719,1
0009792311464db532ff765bf7b182ae,1
0009c9a17f916a706d71784483a5d643,1
000aed2e25dbad2f9ddb70584c5a2ded,1
000c3e6612759851cc3cbb4b83257986,1
000e562887b1f2006d75e0be9558292e,1
000e63d38ae8c00bbcb5a30573b99628,1
000e906b789b55f64edcb1f84030f90d,1
000f25f4d72195062c040b12dce9a18a,1
001021efaa8636c29475e7734483457d,1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,1
0010dedd556712d7bb69a19cb7bbd37a,1
00119ff934e539cf26f92b9ef0cdfed8,1
0011d82c4b53e22e84023405fb467e57,1
00125cb692d04887809806618a2a145f,1
00130c0eee84a3d909e75bc08c5c3ca1,1
0013503b13da1eac686219390b7d641b,1
00137e170939bba5a3134e2386413108,1
001427c0ec99cf8af737bd88e92fd444,1
00143d0f86d6fbd9f9b38ab440ac16f5,1
0014ae671de39511f7575066200733b7,1
0015ebb40fb17286bea51d4607c4733c,1
00169e31ef4b29deaae414f9a5e95929,1
0016dfedd97fc2950e388d2971d718c7,2
0017afd5076e074a48f1f1a4c7bac9c5,1
001862358bf858722e1e2ae000cfed8b,1
0019c29108428acffd089c36103c9440,1
001ab0a7578dd66cd4b0a71f5b6e1e41,1
001ac194d4a326a6fa99b581e9a3d963,1
001b76dd48a5b1eee3e87778daa40df8,1
001c85b5f68d2be0cb0797afc9e8ce9a,1
001d8f0e34a38c37f7dba2a37d4eba8b,1
001daeb0eddc45b999bad0801ad9d273,1
001dbc16dc51075e987543d23a0507c7,1
001e7ba991be1b19605ca0316e7130f9,1
001e7cf2ad6bef3ade12ebc56ceaf0f3,1
0020262c8a370bd5a174ea6a2a267321,1
0020a222f55eb79a372d0efee3cca688,1
002175704e8b209f61b9ad5cfd92b60e,1
00229e4e43f7a7e0b9dd819ad43268d3,1
0025081dcf9330f9a5052ae82c6ce396,1
00254baeb6c932b0a8aeead91fbd02b5,1
00259a44fcad3fc0474329e925d14fc3,1
0025c5d1a8ca53a240ec2634bb4492ea,1
002611a77fe03d076285fd4ca95db77c,1
002691433f09002ac9ca0c4e8dbb8ead,1
0026a368634b6e6f34f33b1499773a30,1
00275bce676303c3bfd7292aefdfa223,1
00276d5c3491fbf55305e26891040df9,1
002834535f7a609a5c68266f173fa59e,1
0028de0ca693a1bb26448916a81105cc,1
002955b0acc63d04f6724a31967e82bd,1
0029c5db35ef291ce99d1262012e7daa,1
0029f17cf0e7640c5cb6825af681303f,1
002af7fa9eb99d1456bceb6a13d6fc0b,1
002b430ff89b3a24c31a1170acbbedea,1
002b4e6fa42cd4a22cc86abc18fe9c05,1
002c9def9c9b951b1bec6d50753c9891,1
002d040018d12a3853c059f7f23ab5b1,1
002f16b7bc4530031b7d90f791b12d8a,1
002f19a65a2ddd70a090297872e6d64e,2
002f98c0f7efd42638ed6100ca699b42,1
0030d783f979fbc5981e75613b057344,1
0030ff924c38549807645976adeef2c0,1
00310b0c75bb13015ec4d82d341865a4,1
00324b3eda39ba5ecce3945823e3594c,1
0032d07457ae9c806c79368d7d9ce96b,1
003324c70b19a16798817b2b3640e721,1
00335b686d693c7d72deeb12f8e89227,1
00335f75ea6a4455b524a8dd177067f5,1
00337fe25a3780b3424d9ad7c5a4b35e,1
003423b755b562962a6225a8de40d12e,1
00345f338696283410b7977d2e3efc89,1
0035246a40f520710769010f752e7507,1
0035c0b07126fe9c24a325216fb96064,1
0035e6b7ade84b3f5b86bd49814793df,1
0036757472ece3dde52fd4bfd929c90e,1
0036887767dea4bd43b1a88cd0d9477a,1
00378c6c981f234634c0b9d6128df6dd,1
003822434f91204da0a51fe4cf2aba18,1
0039500db36d50d7d0bfaf23723550f3,1
003a7f59d7e08a9c61d9e2881fe6459c,1
003a94f778ef8cfd50247c8c1b582257,1
003cc6161d7a2593f2525cce0c330d32,1
003d0634280ff3d1d3a54459349a6899,1
003d804eef0e1b856881cd18e0cc0d4c,1
003d9fc84ad902adf2265248b5ffe1a4,1
Query:
SELECT "order_id", SUM("payment_value") AS "total_payment_value"
   FROM "olist_order_payments"
   GROUP BY "order_id"
   LIMIT 100;
Answer:
order_id,total_payment_value
00010242fe8c5a6d1ba2dd792cb16214,72.19
00018f77f2f0320c557190d7a144bdd3,259.83
000229ec398224ef6ca0657da4fc703e,216.87
00024acbcdf0a6daa1e931b038114c75,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,34.59
00054e8431b9d7675808bcb819fb4a32,31.75
000576fe39319847cbb9d288c5617fa6,880.75
0005a1a1728c9d785b8e2b08b904576c,157.6
0005f50442cb953dcd1d21e1fb923495,65.39
00061f2a7bc09da83e415a52dc8a4af1,68.87
00063b381e2406b52ad429470734ebd5,57.98
0006ec9db01a64e59a68b2c340bf65a7,97.32
0008288aa423d2a3f00fcb17cd7d8719,126.54
0009792311464db532ff765bf7b182ae,127.55
0009c9a17f916a706d71784483a5d643,650.34
000aed2e25dbad2f9ddb70584c5a2ded,152.77
000c3e6612759851cc3cbb4b83257986,112.71
000e562887b1f2006d75e0be9558292e,41.11
000e63d38ae8c00bbcb5a30573b99628,56.78
000e906b789b55f64edcb1f84030f90d,33.84
000f25f4d72195062c040b12dce9a18a,164.39
001021efaa8636c29475e7734483457d,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,65.5
0010dedd556712d7bb69a19cb7bbd37a,111.12
00119ff934e539cf26f92b9ef0cdfed8,236.88
0011d82c4b53e22e84023405fb467e57,315.33
00125cb692d04887809806618a2a145f,135.41
00130c0eee84a3d909e75bc08c5c3ca1,35.84
0013503b13da1eac686219390b7d641b,137.22
00137e170939bba5a3134e2386413108,421.65
001427c0ec99cf8af737bd88e92fd444,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,109.29
0014ae671de39511f7575066200733b7,30.6
0015ebb40fb17286bea51d4607c4733c,37.0
00169e31ef4b29deaae414f9a5e95929,55.11
0016dfedd97fc2950e388d2971d718c7,70.55000000000001
0017afd5076e074a48f1f1a4c7bac9c5,853.39
001862358bf858722e1e2ae000cfed8b,113.71
0019c29108428acffd089c36103c9440,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,127.56
001ac194d4a326a6fa99b581e9a3d963,62.54
001b76dd48a5b1eee3e87778daa40df8,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,53.54
001daeb0eddc45b999bad0801ad9d273,55.12
001dbc16dc51075e987543d23a0507c7,87.9
001e7ba991be1b19605ca0316e7130f9,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,51.1
0020262c8a370bd5a174ea6a2a267321,100.55
0020a222f55eb79a372d0efee3cca688,45.09
002175704e8b209f61b9ad5cfd92b60e,123.11
00229e4e43f7a7e0b9dd819ad43268d3,91.39
0025081dcf9330f9a5052ae82c6ce396,33.18
00254baeb6c932b0a8aeead91fbd02b5,193.01
00259a44fcad3fc0474329e925d14fc3,34.09
0025c5d1a8ca53a240ec2634bb4492ea,419.39
002611a77fe03d076285fd4ca95db77c,156.75
002691433f09002ac9ca0c4e8dbb8ead,120.43
0026a368634b6e6f34f33b1499773a30,164.8
00275bce676303c3bfd7292aefdfa223,293.36
00276d5c3491fbf55305e26891040df9,68.12
002834535f7a609a5c68266f173fa59e,57.17
0028de0ca693a1bb26448916a81105cc,45.3
002955b0acc63d04f6724a31967e82bd,135.59
0029c5db35ef291ce99d1262012e7daa,514.37
0029f17cf0e7640c5cb6825af681303f,113.44
002af7fa9eb99d1456bceb6a13d6fc0b,109.45
002b430ff89b3a24c31a1170acbbedea,265.55
002b4e6fa42cd4a22cc86abc18fe9c05,119.57
002c9def9c9b951b1bec6d50753c9891,173.8
002d040018d12a3853c059f7f23ab5b1,169.84
002f16b7bc4530031b7d90f791b12d8a,284.13
002f19a65a2ddd70a090297872e6d64e,77.28999999999999
002f98c0f7efd42638ed6100ca699b42,93.62
0030d783f979fbc5981e75613b057344,78.27
0030ff924c38549807645976adeef2c0,292.24
00310b0c75bb13015ec4d82d341865a4,55.28
00324b3eda39ba5ecce3945823e3594c,110.07
0032d07457ae9c806c79368d7d9ce96b,186.19
003324c70b19a16798817b2b3640e721,234.7
00335b686d693c7d72deeb12f8e89227,80.79
00335f75ea6a4455b524a8dd177067f5,177.01
00337fe25a3780b3424d9ad7c5a4b35e,139.68
003423b755b562962a6225a8de40d12e,261.33
00345f338696283410b7977d2e3efc89,67.34
0035246a40f520710769010f752e7507,99.11
0035c0b07126fe9c24a325216fb96064,150.44
0035e6b7ade84b3f5b86bd49814793df,34.0
0036757472ece3dde52fd4bfd929c90e,203.03
0036887767dea4bd43b1a88cd0d9477a,423.63
00378c6c981f234634c0b9d6128df6dd,52.85
003822434f91204da0a51fe4cf2aba18,175.16
0039500db36d50d7d0bfaf23723550f3,203.23
003a7f59d7e08a9c61d9e2881fe6459c,134.28
003a94f778ef8cfd50247c8c1b582257,57.98
003cc6161d7a2593f2525cce0c330d32,97.9
003d0634280ff3d1d3a54459349a6899,228.89
003d804eef0e1b856881cd18e0cc0d4c,312.74
003d9fc84ad902adf2265248b5ffe1a4,94.74
Query:
SELECT "payment_type", AVG("payment_installments") AS "average_installments"
   FROM "olist_order_payments"
   GROUP BY "payment_type"
   LIMIT 100;
Answer:
payment_type,average_installments
boleto,1.0
credit_card,3.507155413763917
debit_card,1.0
not_defined,1.0
voucher,1.0
Query:
SELECT "product_id", "product_category_name"
   FROM "olist_products"
   LIMIT 100;
Answer:
product_id,product_category_name
1e9e8ef04dbcff4541ed26657ea517e5,perfumaria
3aa071139cb16b67ca9e5dea641aaa2f,artes
96bd76ec8810374ed1b65e291975717f,esporte_lazer
cef67bcfe19066a932b7673e239eb23d,bebes
9dc1a7de274444849c219cff195d0b71,utilidades_domesticas
41d3672d4792049fa1779bb35283ed13,instrumentos_musicais
732bd381ad09e530fe0a5f457d81becb,cool_stuff
2548af3e6e77a690cf3eb6368e9ab61e,moveis_decoracao
37cc742be07708b53a98702e77a21a02,eletrodomesticos
8c92109888e8cdf9d66dc7e463025574,brinquedos
14aa47b7fe5c25522b47b4b29c98dcb9,cama_mesa_banho
03b63c5fc16691530586ae020c345514,bebes
cf55509ea8edaaac1d28fdb16e48fc22,instrumentos_musicais
7bb6f29c2be57716194f96496660c7c2,moveis_decoracao
eb31436580a610f202c859463d8c7415,construcao_ferramentas_seguranca
3bb7f144022e6732727d8d838a7b13b3,esporte_lazer
6a2fb4dd53d2cdb88e0432f1284a004c,perfumaria
a1b71017a84f92fd8da4aeefba108a24,informatica_acessorios
a0736b92e52f6cead290e30b578413b6,moveis_decoracao
f53103a77d9cf245e579ea37e5ec51f0,cama_mesa_banho
1c1890ba1779090cd54008a3c3302921,moveis_decoracao
518ef5de2c2b3a255e326a4594ba15d9,cama_mesa_banho
e3e020af31d4d89d2602272b315c3f6e,beleza_saude
8b41fbc2b984a12030090112324d1bc4,bebes
d03bd02af9fff4b98f1c972315e5e9ef,moveis_decoracao
8ba4f2a4ae695d26e5626c1bf710975e,utilidades_domesticas
f6574524b07d5bb753bab6f35abe2d06,malas_acessorios
c78b767da00efb70c1bcccab87c28cd5,informatica_acessorios
a0253d43394dd4da9a5d7b1f546f1a32,informatica_acessorios
051b9ff13dd55c0a6655a15ff296f80d,esporte_lazer
47859fca9dd7485cbd93c3e8993bb74f,cama_mesa_banho
e1d1d22e9f8122a4ec1533b032c12562,ferramentas_jardim
20e37962088a4061d3578def47a8648b,moveis_decoracao
1eba879220bd0981a0e2fbab499ed4e1,moveis_escritorio
ce5b91848b91118daffb3af53b747475,esporte_lazer
5370b82a213393979691c98074265584,bebes
b8dac5113b06a97e64943234522572b9,automotivo
750cf819d127191920eda79a4b6fb479,eletronicos
e6af694343b45b56304ad91974a110b9,utilidades_domesticas
680874c570dad71c0a2844cfbf417054,moveis_decoracao
8b3a9476f74f5297f7ff0ec6d95fe1ea,moveis_decoracao
1c6fb703c624b381a20f21f757694866,brinquedos
db46052aed7dff59ba38cf2fe29b87f9,cama_mesa_banho
b864b103180d5a6a3f830e67f93e8735,bebes
7a8dac4aaa16bc642e4df33adcf03303,cool_stuff
83b9bc6aae6f527ff6aafb9e01d6cbf3,brinquedos
5f504b3a1c75b73d6151be81eb05bdc9,cool_stuff
bbf920aa6ac72007a726e6f419156f8f,moveis_decoracao
c3b7e4d83e530c27a8e6368296aece48,moveis_decoracao
c5d8079278e912d7e3b6beb48ecb56e8,beleza_saude
5eaa343860dc445b3fd43d1b682809fd,esporte_lazer
b5cfb1d3c5e435a7a52227e08f220ee7,cool_stuff
334479e94cba98064050db1c9636e244,automotivo
3fcd8dfe610c62edfb51de2630cd9ef4,bebes
4c8056caed5757810b9a68b83c3759e6,malas_acessorios
30e77af9e7759bbaa0305d2fbc605dc4,fashion_calcados
92bf5d2084dfbcb57d9db7838bac5cd0,telefonia
fdeb34a9f03fea7c3937dd62d1d0287e,cool_stuff
1065dbb6b0bf03daaedab1236979e296,papelaria
0d826eba8e0a2ae3bca9e3a947dd756d,brinquedos
f8f6fd145cc00519283cf3100477b2b3,esporte_lazer
4e04ffb7dd3739ecfc37de8927dd586c,papelaria
36555a2f528d7b2a255c504191445d39,beleza_saude
22937a73f92a33040ab4e2540355a5d8,fashion_bolsas_e_acessorios
dc21247da0290904ffbbcd5953c76f95,papelaria
9020ce7adcc384b2899ae87ddc54767b,papelaria
bfc1d1c62b1f7f401d8d9dda962bb870,esporte_lazer
6fef6d87bb6c2eb11d57a967209219a8,ferramentas_jardim
1e5428c428e0f783acd6e3d94ba4ee2a,pcs
94080f9219044d897195e2be145945dc,automotivo
d0389f20b3d11de54e1e4561df147683,casa_construcao
3e9b58f1436820c248d3f98d7229bb14,relogios_presentes
575c38b4c88fc7b35ef22fc8312bfe1b,cool_stuff
556702ebb73d3786a852ad3d5a8ad268,construcao_ferramentas_construcao
a3a03c131926ec14d4c9f3ef03016b24,pet_shop
e586ebb6022265ae1eea38f46ffe3ead,beleza_saude
278b3c6462e86b4556b99989513ddf73,eletroportateis
0d009643171aee696f4733340bc2fdd0,perfumaria
be1be330cf34043d1c40d6114cbd11b5,relogios_presentes
07f01b6fcacc1b187a71e5074199db2d,agro_industria_e_comercio
75b4372e69a42f8ae1d908c076f547b2,beleza_saude
3569d4374a919941a50f57371b1dc93d,beleza_saude
a3c95dc653d9a279b160bc0179385ed1,cama_mesa_banho
0992c6cba95a13bfa68ea7d5e22d478b,ferramentas_jardim
b1eae565a61935e0011ee7682fef9dc9,perfumaria
2734390ee304b0f4817b3c233094fc16,instrumentos_musicais
32ee3f4e2493045726807808d7abbab6,cama_mesa_banho
c2367eda4f9623d0355dc5d7796d857a,cama_mesa_banho
7f34b85142d1ef9e077a0da9ada27385,moveis_decoracao
c478b1bbf9ec8c5691f37ccb83187386,informatica_acessorios
f9ecf420c38b90a8af8e7f70fd789264,esporte_lazer
3a6a0247ced9dcb444b46caafdcdd368,beleza_saude
adf591c625cb265c12bc6749d3a2f757,beleza_saude
3e0f398b664b26e3224c79dbf435191f,esporte_lazer
64c8f1a52b407d92518a1f8b79240a70,telefonia
af16005fca813272caf59c432153949e,moveis_decoracao
e6a1ff3552ba3305c1cf0a4dde50347f,automotivo
d8a405c732027a2af3187b031890933d,automotivo
ce94e3c41145e28428cdae952a1fd7f2,relogios_presentes
3f0f8de616df6efb39a48f3c64eea974,cama_mesa_banho
Query:
SELECT "order_id", "product_id"
    FROM "olist_order_items"
    LIMIT 100;
Answer:
Too long, hard cut:
order_id,product_id
00010242fe8c5a6d1ba2dd792cb16214,4244733e06e7ecb4970a6e2683c13e61
00018f77f2f0320c557190d7a144bdd3,e5f2d52b802189ee658865ca93d83a8f
000229ec398224ef6ca0657da4fc703e,c777355d18b72b67abbeef9df44fd0fd
00024acbcdf0a6daa1e931b038114c75,7634da152a4610f1595efa32f14722fc
00042b26cf59d7ce69dfabb4e55b4fd9,ac6c3623068f30de03045865e4e10089
00048cc3ae777c65dbb7d2a0634bc1ea,ef92defde845ab8450f9d70c526ef70f
00054e8431b9d7675808bcb819fb4a32,8d4f2bb7e93e6710a28f34fa83ee7d28
000576fe39319847cbb9d288c5617fa6,557d850972a7d6f792fd18ae1400d9b6
0005a1a1728c9d785b8e2b08b904576c,310ae3c140ff94b03219ad0adc3c778f
0005f50442cb953dcd1d21e1fb923495,4535b0e1091c278dfd193e5a1d63b39f
00061f2a7bc09da83e415a52dc8a4af1,d63c1011f49d98b976c352955b1c4bea
00063b381e2406b52ad429470734ebd5,f177554ea93259a5b282f24e33f65ab6
0006ec9db01a64e59a68b2c340bf65a7,99a4788cb24856965c36a24e339b6058
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db
0009792311464db532ff765bf7b182ae,8cab8abac59158715e0d70a36c807415
0009c9a17f916a706d71784483a5d643,3f27ac8e699df3d300ec4a5d8c5cf0b2
000aed2e25dbad2f9ddb70584c5a2ded,4fa33915031a8cde03dd0d3e8fb27f01
000c3e6612759851cc3cbb4b83257986,b50c950aba0dcead2c48032a690ce817
000e562887b1f2006d75e0be9558292e,5ed9eaf534f6936b51d0b6c5e4d5c2e9
000e63d38ae8c00bbcb5a30573b99628,553e0e7590d3116a072507a3635d2877
000e906b789b55f64edcb1f84030f90d,57d79905de06d8897872c551bfd09358
000f25f4d72195062c040b12dce9a18a,1c05e0964302b6cf68ca0d15f326c6ba
001021efaa8636c29475e7734483457d,5d7c23067ed3fc8c6e699b9373d5890b
0010b2e5201cc5f1ae7e9c6cc8f5bd00,5a419dbf24a8c9718fe522b81c69f61a
00119ff934e539cf26f92b9ef0cdfed8,21b1c2f67a9aafb5af0eb06c13b9dbda
0011d82c4b53e22e84023405fb467e57,c389f712c4b4510bc997cee93e8b1a28
00125cb692d04887809806618a2a145f,1c0c0093a48f13ba70d0c6b0a9157cb7
00130c0eee84a3d909e75bc08c5c3ca1,89321f94e35fc6d7903d36f74e351d40
0013503b13da1eac686219390b7d641b,38afdf723b95d455b418a0f57d623c6b
00137e170939bba5a3134e2386413108,672e757f331900b9deea127a2a7b79fd
001427c0ec99cf8af737bd88e92fd444,28b4eced95a52d9c437a4caf9d311b95
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a
0014ae671de39511f7575066200733b7,23365beed316535b4105bd800c46670e
0015ebb40fb17286bea51d4607c4733c,50fd2b788dc166edd20512370dac54df
00169e31ef4b29deaae414f9a5e95929,b10eba910a974df70b8a12d0665cdb9e
0016dfedd97fc2950e388d2971d718c7,4089861a1bd4685da70bddd6b4f974f1
0017afd5076e074a48f1f1a4c7bac9c5,fe59a1e006df3ac42bf0ceb876d70969
001862358bf858722e1e2ae000cfed8b,c6dd917a0be2a704582055949915ab32
0019c29108428acffd089c36103c9440,28b4eced95a52d9c437a4caf9d311b95
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2
001ac194d4a326a6fa99b581e9a3d963,dbaee28f4ee64465838a229582d77520
001b76dd48a5b1eee3e87778daa40df8,dbb67791e405873b259e4656bf971246
001c85b5f68d2be0cb0797afc9e8ce9a,84f456958365164420cfc80fbe4c7fab
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c
001daeb0eddc45b999bad0801ad9d273,30c01cc81c9eb80469371743813789cc
001dbc16dc51075e987543d23a0507c7,777d2e438a1b645f3aec9bd57e92672c
001e7ba991be1b19605ca0316e7130f9,884fa3cd42986ba480ea2f8ae4e25ff7
001e7cf2ad6bef3ade12ebc56ceaf0f3,bdcf6a834e8faa30dac3886c7a58e92e
0020262c8a370bd5a174ea6a2a267321,a5341e3f8155dbb3e62323d3ea289729
0020a222f55eb79a372d0efee3cca688,e19ddcc85537b41f22116c8d5425ef46
002175704e8b209f61b9ad5cfd92b60e,e6b6e13cf71449a457269f425b89dc74
00229e4e43f7a7e0b9dd819ad43268d3,13fcfc313dfb2217e5ee3000a702f9ef
0025081dcf9330f9a5052ae82c6ce396,4e3f399366b0047a572b6682f9bb166e
00254baeb6c932b0a8aeead91fbd02b5,18901878788fec7ddc55e64d1ace8187
00259a44fcad3fc0474329e925d14fc3,0c4d0a08f95c7b7dc5dc7402bfdafd4c
0025c5d1a8ca53a240ec2634bb4492ea,35537536ed2b4c561b4018bf3abf54e0
002611a77fe03d076285fd4ca95db77c,fe077ec80df6b4ee60bb4498d5ab1962
002691433f09002ac9ca0c4e8dbb8ead,430d215740da7fdda91cc938f8fd92f6
0026a368634b6e6f34f33b1499773a30,892832da5b05b0f54578e1f14f193c22
00275bce676303c3bfd7292aefdfa223,6490b9f63b0b595e1c1402b46b0f50ad
00276d5c3491fbf55305e26891040df9,71c89e9d8fa274b017279aa322cd0e19
002834535f7a609a5c68266f173fa59e,df3655ac9aa8c6cbfa63bdd8d3b09c50
0028de0ca693a1bb26448916a81105cc,059344baebbeaa42fa9f2bbe11b1583e
002955b0acc63d04f6724a31967e82bd,d9bdf643d95cb89844c0da1a0df1d16e
0029c5db35ef291ce99d1262012e7daa,7614c62b86a81021243e438cfde78ccc
0029f17cf0e7640c5cb6825af681303f,01c666c82f414c762ad21bffa56e8b49
002af7fa9eb99d1456bceb6a13d6fc0b,c2ece64199af7a53793ed9612a89a8cd
002b430ff89b3a24c31a1170acbbedea,cc47c0863559499f01b4cad750929d10
002b4e6fa42cd4a22cc86abc18fe9c05,a6f449f6257f26e556013151cee46b4b
002c9def9c9b951b1bec6d50753c98
Query:
SELECT ooi."order_id", ooi."product_id", oop."payment_type", oop."payment_value"
    FROM "olist_order_items" AS ooi
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    LIMIT 100;
Answer:
Too long, hard cut:
order_id,product_id,payment_type,payment_value
00010242fe8c5a6d1ba2dd792cb16214,4244733e06e7ecb4970a6e2683c13e61,credit_card,72.19
00018f77f2f0320c557190d7a144bdd3,e5f2d52b802189ee658865ca93d83a8f,credit_card,259.83
000229ec398224ef6ca0657da4fc703e,c777355d18b72b67abbeef9df44fd0fd,credit_card,216.87
00024acbcdf0a6daa1e931b038114c75,7634da152a4610f1595efa32f14722fc,credit_card,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,ac6c3623068f30de03045865e4e10089,credit_card,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,ef92defde845ab8450f9d70c526ef70f,boleto,34.59
00054e8431b9d7675808bcb819fb4a32,8d4f2bb7e93e6710a28f34fa83ee7d28,credit_card,31.75
000576fe39319847cbb9d288c5617fa6,557d850972a7d6f792fd18ae1400d9b6,credit_card,880.75
0005a1a1728c9d785b8e2b08b904576c,310ae3c140ff94b03219ad0adc3c778f,credit_card,157.6
0005f50442cb953dcd1d21e1fb923495,4535b0e1091c278dfd193e5a1d63b39f,credit_card,65.39
00061f2a7bc09da83e415a52dc8a4af1,d63c1011f49d98b976c352955b1c4bea,credit_card,68.87
00063b381e2406b52ad429470734ebd5,f177554ea93259a5b282f24e33f65ab6,credit_card,57.98
0006ec9db01a64e59a68b2c340bf65a7,99a4788cb24856965c36a24e339b6058,credit_card,97.32
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db,boleto,126.54
0008288aa423d2a3f00fcb17cd7d8719,368c6c730842d78016ad823897a372db,boleto,126.54
0009792311464db532ff765bf7b182ae,8cab8abac59158715e0d70a36c807415,boleto,127.55
0009c9a17f916a706d71784483a5d643,3f27ac8e699df3d300ec4a5d8c5cf0b2,credit_card,650.34
000aed2e25dbad2f9ddb70584c5a2ded,4fa33915031a8cde03dd0d3e8fb27f01,credit_card,152.77
000c3e6612759851cc3cbb4b83257986,b50c950aba0dcead2c48032a690ce817,boleto,112.71
000e562887b1f2006d75e0be9558292e,5ed9eaf534f6936b51d0b6c5e4d5c2e9,credit_card,41.11
000e63d38ae8c00bbcb5a30573b99628,553e0e7590d3116a072507a3635d2877,credit_card,56.78
000e906b789b55f64edcb1f84030f90d,57d79905de06d8897872c551bfd09358,credit_card,33.84
000f25f4d72195062c040b12dce9a18a,1c05e0964302b6cf68ca0d15f326c6ba,credit_card,164.39
001021efaa8636c29475e7734483457d,5d7c23067ed3fc8c6e699b9373d5890b,credit_card,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,5a419dbf24a8c9718fe522b81c69f61a,credit_card,65.5
00119ff934e539cf26f92b9ef0cdfed8,21b1c2f67a9aafb5af0eb06c13b9dbda,credit_card,236.88
0011d82c4b53e22e84023405fb467e57,c389f712c4b4510bc997cee93e8b1a28,credit_card,315.33
00125cb692d04887809806618a2a145f,1c0c0093a48f13ba70d0c6b0a9157cb7,credit_card,135.41
00130c0eee84a3d909e75bc08c5c3ca1,89321f94e35fc6d7903d36f74e351d40,boleto,35.84
0013503b13da1eac686219390b7d641b,38afdf723b95d455b418a0f57d623c6b,boleto,137.22
00137e170939bba5a3134e2386413108,672e757f331900b9deea127a2a7b79fd,boleto,421.65
001427c0ec99cf8af737bd88e92fd444,28b4eced95a52d9c437a4caf9d311b95,credit_card,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a,credit_card,109.29
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a,credit_card,109.29
00143d0f86d6fbd9f9b38ab440ac16f5,e95ee6822b66ac6058e2e4aff656071a,credit_card,109.29
0014ae671de39511f7575066200733b7,23365beed316535b4105bd800c46670e,boleto,30.6
0015ebb40fb17286bea51d4607c4733c,50fd2b788dc166edd20512370dac54df,credit_card,37.0
00169e31ef4b29deaae414f9a5e95929,b10eba910a974df70b8a12d0665cdb9e,boleto,55.11
0016dfedd97fc2950e388d2971d718c7,4089861a1bd4685da70bddd6b4f974f1,credit_card,52.63
0016dfedd97fc2950e388d2971d718c7,4089861a1bd4685da70bddd6b4f974f1,voucher,17.92
0017afd5076e074a48f1f1a4c7bac9c5,fe59a1e006df3ac42bf0ceb876d70969,credit_card,853.39
001862358bf858722e1e2ae000cfed8b,c6dd917a0be2a704582055949915ab32,credit_card,113.71
0019c29108428acffd089c36103c9440,28b4eced95a52d9c437a4caf9d311b95,credit_card,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2,boleto,127.56
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2,boleto,127.56
001ab0a7578dd66cd4b0a71f5b6e1e41,0b0172eb0fd18479d29c3bc122c058c2,boleto,127.56
001ac194d4a326a6fa99b581e9a3d963,dbaee28f4ee64465838a229582d77520,boleto,62.54
001b76dd48a5b1eee3e87778daa40df8,dbb67791e405873b259e4656bf971246,credit_card,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,84f456958365164420cfc80fbe4c7fab,credit_card,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c,credit_card,53.54
001d8f0e34a38c37f7dba2a37d4eba8b,e67307ff0f15ade43fcb6e670be7a74c,credit_card,53.54
001daeb0eddc45b999bad0801ad9d273,30c01cc81c9eb80469371743813789cc,boleto,55.12
001dbc16dc51075e987543d23a0507c7,777d2e438a1b645f3aec9bd57e92672c,credit_card,87.9
001e7ba991be1b19605ca0316e7130f9,884fa3cd42986ba480ea2f8ae4e25ff7,credit_card,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,bdcf6a834e8faa30dac3886c7a58e92e,credit_card,51.1
0020262c8a370bd5a174ea6a2a267321,a5341e3f8155dbb3e62323d3ea289729,credit_card,100.55
0020a222f55eb79a372d0efee3cca688,e19ddcc85537b41f22116c8d5425ef46,credit_card,45.09
002175704e8b209f61b9ad5cfd92b60e,e6b6e13cf71449a457269f425b89dc74,credit_card,123.11
00229e4e43f7a7e0b9dd819ad43268d3,13fcfc313dfb2217e5ee3000a702f9ef,credit_card,91.39
0025081dcf9330f9a5052ae82c6ce396,4e3f399366b0047a572b66
Query:
SELECT pt."product_category_name_english", oop."payment_type"
    FROM "olist_order_items" AS ooi
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    LIMIT 100;
Answer:
product_category_name_english,payment_type
cool_stuff,credit_card
pet_shop,credit_card
furniture_decor,credit_card
perfumery,credit_card
garden_tools,credit_card
housewares,boleto
telephony,credit_card
garden_tools,credit_card
health_beauty,credit_card
books_technical,credit_card
health_beauty,credit_card
fashion_bags_accessories,credit_card
bed_bath_table,credit_card
garden_tools,boleto
garden_tools,boleto
sports_leisure,boleto
consoles_games,credit_card
perfumery,credit_card
sports_leisure,boleto
cool_stuff,credit_card
bed_bath_table,credit_card
telephony,credit_card
office_furniture,credit_card
fashion_bags_accessories,credit_card
cool_stuff,credit_card
sports_leisure,credit_card
luggage_accessories,credit_card
furniture_decor,credit_card
food,boleto
furniture_decor,boleto
agro_industry_and_commerce,boleto
furniture_decor,credit_card
sports_leisure,credit_card
sports_leisure,credit_card
sports_leisure,credit_card
telephony,boleto
electronics,credit_card
bed_bath_table,boleto
garden_tools,credit_card
garden_tools,voucher
computers_accessories,credit_card
cool_stuff,credit_card
furniture_decor,credit_card
electronics,boleto
electronics,boleto
electronics,boleto
construction_tools_construction,boleto
computers_accessories,credit_card
bed_bath_table,credit_card
health_beauty,credit_card
health_beauty,credit_card
pet_shop,boleto
bed_bath_table,credit_card
computers_accessories,credit_card
health_beauty,credit_card
furniture_decor,credit_card
furniture_decor,credit_card
audio,credit_card
sports_leisure,credit_card
books_technical,credit_card
baby,credit_card
computers_accessories,credit_card
sports_leisure,credit_card
computers_accessories,boleto
telephony,credit_card
cool_stuff,credit_card
telephony,boleto
furniture_decor,credit_card
telephony,boleto
construction_tools_lights,boleto
perfumery,credit_card
health_beauty,boleto
toys,credit_card
furniture_decor,credit_card
cool_stuff,credit_card
stationery,credit_card
housewares,credit_card
housewares,credit_card
perfumery,boleto
furniture_decor,debit_card
bed_bath_table,voucher
bed_bath_table,voucher
consoles_games,credit_card
toys,credit_card
housewares,credit_card
baby,credit_card
housewares,credit_card
industry_commerce_and_business,boleto
housewares,credit_card
luggage_accessories,credit_card
luggage_accessories,credit_card
toys,boleto
pet_shop,credit_card
bed_bath_table,credit_card
bed_bath_table,credit_card
garden_tools,boleto
health_beauty,credit_card
bed_bath_table,credit_card
cool_stuff,credit_card
furniture_decor,credit_card
Query:
SELECT pt."product_category_name_english", oop."payment_type", COUNT(*) AS "payment_count"
    FROM "olist_order_items" AS ooi
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    GROUP BY pt."product_category_name_english", oop."payment_type"
    ORDER BY "payment_count" DESC
    LIMIT 100;
Answer:
product_category_name_english,payment_type,payment_count
bed_bath_table,credit_card,8959
health_beauty,credit_card,7566
sports_leisure,credit_card,6635
furniture_decor,credit_card,6379
computers_accessories,credit_card,5436
housewares,credit_card,5411
watches_gifts,credit_card,4858
telephony,credit_card,3400
toys,credit_card,3294
auto,credit_card,3277
garden_tools,credit_card,3206
cool_stuff,credit_card,2977
perfumery,credit_card,2706
baby,credit_card,2426
computers_accessories,boleto,2158
electronics,credit_card,2023
stationery,credit_card,1978
bed_bath_table,boleto,1875
health_beauty,boleto,1860
sports_leisure,boleto,1772
furniture_decor,boleto,1735
fashion_bags_accessories,credit_card,1529
pet_shop,credit_card,1526
housewares,boleto,1326
office_furniture,credit_card,1194
garden_tools,boleto,1032
watches_gifts,boleto,1025
telephony,boleto,1022
luggage_accessories,credit_card,890
consoles_games,credit_card,869
bed_bath_table,voucher,847
auto,boleto,840
toys,boleto,735
cool_stuff,boleto,731
construction_tools_construction,credit_card,729
electronics,boleto,652
home_appliances,credit_card,617
perfumery,boleto,591
baby,boleto,554
small_appliances,credit_card,538
furniture_decor,voucher,530
musical_instruments,credit_card,506
housewares,voucher,505
home_construction,credit_card,484
office_furniture,boleto,482
stationery,boleto,466
fashion_bags_accessories,boleto,422
sports_leisure,voucher,411
books_general_interest,credit_card,410
furniture_living_room,credit_card,399
health_beauty,voucher,389
food,credit_card,381
pet_shop,boleto,366
home_confort,credit_card,346
computers_accessories,voucher,340
drinks,credit_card,300
garden_tools,voucher,267
audio,credit_card,263
watches_gifts,voucher,255
consoles_games,boleto,243
cool_stuff,voucher,240
air_conditioning,credit_card,222
market_place,credit_card,222
kitchen_dining_laundry_garden_furniture,credit_card,219
telephony,voucher,219
fashion_shoes,credit_card,215
perfumery,voucher,215
construction_tools_lights,credit_card,214
industry_commerce_and_business,credit_card,205
toys,voucher,199
books_technical,credit_card,196
food_drink,credit_card,194
costruction_tools_garden,credit_card,191
auto,voucher,190
fixed_telephony,credit_card,186
home_appliances_2,credit_card,185
construction_tools_construction,boleto,181
computers,credit_card,174
baby,voucher,172
fashion_bags_accessories,voucher,170
luggage_accessories,boleto,166
health_beauty,debit_card,157
art,credit_card,153
musical_instruments,boleto,152
computers_accessories,debit_card,148
agro_industry_and_commerce,credit_card,145
construction_tools_safety,credit_card,145
bed_bath_table,debit_card,142
home_appliances,boleto,136
stationery,voucher,135
signaling_and_security,credit_card,131
books_general_interest,boleto,130
small_appliances,boleto,127
sports_leisure,debit_card,127
christmas_supplies,credit_card,120
housewares,debit_card,113
home_construction,boleto,111
food,boleto,106
fashion_male_clothing,credit_card,104
pet_shop,voucher,102
Query:
SELECT pt."product_category_name_english", oop."payment_type", AVG(payment_counts."payment_count") AS "average_payment_count"
    FROM (
      SELECT "order_id", COUNT(*) AS "payment_count"
      FROM "olist_order_payments"
      GROUP BY "order_id"
    ) AS payment_counts
    JOIN "olist_order_items" AS ooi ON payment_counts."order_id" = ooi."order_id"
    JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
    JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
    JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
    GROUP BY pt."product_category_name_english", oop."payment_type"
    LIMIT 100;
Answer:
product_category_name_english,payment_type,average_payment_count
agro_industry_and_commerce,boleto,1.0
agro_industry_and_commerce,credit_card,1.1793103448275861
agro_industry_and_commerce,debit_card,1.0
agro_industry_and_commerce,voucher,11.904761904761905
air_conditioning,boleto,1.0
air_conditioning,credit_card,1.027027027027027
air_conditioning,debit_card,1.0
air_conditioning,voucher,1.5
art,boleto,1.0
art,credit_card,1.0588235294117647
art,debit_card,1.0
art,voucher,2.1538461538461537
arts_and_craftmanship,boleto,1.0
arts_and_craftmanship,credit_card,1.0
arts_and_craftmanship,debit_card,1.0
audio,boleto,1.0
audio,credit_card,1.0570342205323193
audio,debit_card,1.0
audio,voucher,2.0
auto,boleto,1.0
auto,credit_card,1.0384498016478487
auto,debit_card,1.0
auto,voucher,2.3473684210526318
baby,boleto,1.0
baby,credit_card,1.0511129431162407
baby,debit_card,1.0
baby,voucher,2.7093023255813953
bed_bath_table,boleto,1.0
bed_bath_table,credit_card,1.059939725415783
bed_bath_table,debit_card,1.0
bed_bath_table,voucher,5.242030696576151
books_general_interest,boleto,1.0
books_general_interest,credit_card,1.0365853658536586
books_general_interest,debit_card,1.0
books_general_interest,voucher,1.7647058823529411
books_imported,boleto,1.0
books_imported,credit_card,1.0434782608695652
books_imported,voucher,2.0
books_technical,boleto,1.0
books_technical,credit_card,1.0204081632653061
books_technical,debit_card,1.0
books_technical,voucher,1.6666666666666667
cds_dvds_musicals,boleto,1.0
cds_dvds_musicals,credit_card,1.0
christmas_supplies,boleto,1.0
christmas_supplies,credit_card,1.0166666666666666
christmas_supplies,debit_card,1.0
christmas_supplies,voucher,2.0
cine_photo,boleto,1.0
cine_photo,credit_card,1.0222222222222221
cine_photo,debit_card,1.0
cine_photo,voucher,1.5
computers,boleto,1.0
computers,credit_card,1.1264367816091954
computers,voucher,3.8333333333333335
computers_accessories,boleto,1.0
computers_accessories,credit_card,1.0382634289919057
computers_accessories,debit_card,1.0
computers_accessories,voucher,2.8058823529411763
consoles_games,boleto,1.0
consoles_games,credit_card,1.0655926352128884
consoles_games,debit_card,1.0
consoles_games,voucher,2.19672131147541
construction_tools_construction,boleto,1.0
construction_tools_construction,credit_card,1.0315500685871055
construction_tools_construction,debit_card,1.0
construction_tools_construction,voucher,2.4
construction_tools_lights,boleto,1.0
construction_tools_lights,credit_card,1.0327102803738317
construction_tools_lights,debit_card,1.0
construction_tools_lights,voucher,2.0833333333333335
construction_tools_safety,boleto,1.0
construction_tools_safety,credit_card,1.0344827586206897
construction_tools_safety,debit_card,1.0
construction_tools_safety,voucher,1.8333333333333333
cool_stuff,boleto,1.0
cool_stuff,credit_card,1.0557608330534094
cool_stuff,debit_card,1.0
cool_stuff,voucher,3.4833333333333334
costruction_tools_garden,boleto,1.0
costruction_tools_garden,credit_card,1.036649214659686
costruction_tools_garden,debit_card,1.0
costruction_tools_garden,voucher,2.2857142857142856
costruction_tools_tools,boleto,1.0
costruction_tools_tools,credit_card,1.0256410256410255
costruction_tools_tools,debit_card,1.0
costruction_tools_tools,voucher,1.6666666666666667
diapers_and_hygiene,boleto,1.0
diapers_and_hygiene,credit_card,1.0
drinks,boleto,1.0
drinks,credit_card,1.0233333333333334
drinks,debit_card,1.0
drinks,voucher,2.0
dvds_blu_ray,boleto,1.0
dvds_blu_ray,credit_card,1.0416666666666667
dvds_blu_ray,voucher,5.0
electronics,boleto,1.0
electronics,credit_card,1.037073652990608
electronics,debit_card,1.0
electronics,voucher,6.242424242424242
Query:
SELECT category_payment."product_category_name_english", category_payment."payment_type", MAX(category_payment."payment_count") AS "max_payment_count"
    FROM (
      SELECT pt."product_category_name_english", oop."payment_type", COUNT(*) AS "payment_count"
      FROM "olist_order_items" AS ooi
      JOIN "olist_products" AS p ON ooi."product_id" = p."product_id"
      JOIN "product_category_name_translation" AS pt ON p."product_category_name" = pt."product_category_name"
      JOIN "olist_order_payments" AS oop ON ooi."order_id" = oop."order_id"
      GROUP BY pt."product_category_name_english", oop."payment_type"
    ) AS category_payment
    GROUP BY category_payment."product_category_name_english"
    ORDER BY "max_payment_count" DESC
    LIMIT 100;
Answer:
product_category_name_english,payment_type,max_payment_count
bed_bath_table,credit_card,8959
health_beauty,credit_card,7566
sports_leisure,credit_card,6635
furniture_decor,credit_card,6379
computers_accessories,credit_card,5436
housewares,credit_card,5411
watches_gifts,credit_card,4858
telephony,credit_card,3400
toys,credit_card,3294
auto,credit_card,3277
garden_tools,credit_card,3206
cool_stuff,credit_card,2977
perfumery,credit_card,2706
baby,credit_card,2426
electronics,credit_card,2023
stationery,credit_card,1978
fashion_bags_accessories,credit_card,1529
pet_shop,credit_card,1526
office_furniture,credit_card,1194
luggage_accessories,credit_card,890
consoles_games,credit_card,869
construction_tools_construction,credit_card,729
home_appliances,credit_card,617
small_appliances,credit_card,538
musical_instruments,credit_card,506
home_construction,credit_card,484
books_general_interest,credit_card,410
furniture_living_room,credit_card,399
food,credit_card,381
home_confort,credit_card,346
drinks,credit_card,300
audio,credit_card,263
market_place,credit_card,222
air_conditioning,credit_card,222
kitchen_dining_laundry_garden_furniture,credit_card,219
fashion_shoes,credit_card,215
construction_tools_lights,credit_card,214
industry_commerce_and_business,credit_card,205
books_technical,credit_card,196
food_drink,credit_card,194
costruction_tools_garden,credit_card,191
fixed_telephony,credit_card,186
home_appliances_2,credit_card,185
computers,credit_card,174
art,credit_card,153
construction_tools_safety,credit_card,145
agro_industry_and_commerce,credit_card,145
signaling_and_security,credit_card,131
christmas_supplies,credit_card,120
fashion_male_clothing,credit_card,104
fashion_underwear_beach,credit_card,101
costruction_tools_tools,credit_card,78
furniture_bedroom,credit_card,76
tablets_printing_image,credit_card,65
small_appliances_home_oven_and_coffee,credit_card,65
dvds_blu_ray,credit_card,48
books_imported,credit_card,46
cine_photo,credit_card,45
fashio_female_clothing,credit_card,35
furniture_mattress_and_upholstery,credit_card,33
diapers_and_hygiene,credit_card,32
party_supplies,credit_card,30
music,credit_card,28
flowers,credit_card,26
home_comfort_2,credit_card,23
fashion_sport,credit_card,17
arts_and_craftmanship,credit_card,14
la_cuisine,credit_card,13
cds_dvds_musicals,credit_card,9
fashion_childrens_clothes,credit_card,5
security_and_services,boleto,1
End Exploring Related Columns
Task: Could you help me calculate the average of the total payment count for the most preferred payment method in each product category?

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: I'm sorry, but I cannot calculate the average of the total payment count for the most preferred payment method in each product category, as I do not have access to the actual data in the provided tables..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 10:14:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:14:22 - root - INFO - ```sql
WITH
    category_payment_counts AS (
        SELECT
            pt.product_category_name_english AS category,
            oop.payment_type,
            COUNT(*) AS payment_count
        FROM
            olist_order_items AS ooi
            JOIN olist_products AS p ON ooi.product_id = p.product_id
            JOIN product_category_name_translation AS pt ON p.product_category_name = pt.product_category_name
            JOIN olist_order_payments AS oop ON ooi.order_id = oop.order_id
        GROUP BY
            pt.product_category_name_english,
            oop.payment_type
    ),
    most_preferred_payment_methods AS (
        SELECT
            category,
            payment_type
        FROM (
            SELECT
                category,
                payment_type,
                payment_count,
                RANK() OVER (PARTITION BY category ORDER BY payment_count DESC) AS rk
            FROM category_payment_counts
        )
        WHERE rk = 1
    ),
    order_payment_counts AS (
        SELECT
            order_id,
            COUNT(*) AS total_payment_count
        FROM
            olist_order_payments
        GROUP BY
            order_id
    ),
    order_categories AS (
        SELECT DISTINCT
            ooi.order_id,
            pt.product_category_name_english AS category,
            oop.payment_type
        FROM
            olist_order_items AS ooi
            JOIN olist_products AS p ON ooi.product_id = p.product_id
            JOIN product_category_name_translation AS pt ON p.product_category_name = pt.product_category_name
            JOIN olist_order_payments AS oop ON ooi.order_id = oop.order_id
    ),
    orders_with_preferred_payment_method AS (
        SELECT
            oc.order_id,
            oc.category
        FROM
            order_categories AS oc
            JOIN most_preferred_payment_methods AS mppm ON
                oc.category = mppm.category AND
                oc.payment_type = mppm.payment_type
    ),
    category_order_payments AS (
        SELECT
            owppm.category,
            owppm.order_id,
            opc.total_payment_count
        FROM
            orders_with_preferred_payment_method AS owppm
            JOIN order_payment_counts AS opc ON owppm.order_id = opc.order_id
    )
SELECT
    category,
    AVG(total_payment_count) AS average_total_payment_count
FROM
    category_order_payments
GROUP BY
    category
ORDER BY
    average_total_payment_count DESC;
```
2025-01-25 10:14:32 - root - INFO - itercount: 1
2025-01-25 10:14:32 - root - INFO - 0
2025-01-25 10:14:32 - root - INFO - results: 
category,average_total_payment_count
la_cuisine,1.1666666666666667
fashion_underwear_beach,1.141304347826087
agro_industry_and_commerce,1.12
fashion_male_clothing,1.1123595505617978
party_supplies,1.1111111111111112
computers,1.105263157894737
furniture_mattress_and_upholstery,1.09375
home_appliances_2,1.0934065934065933
furniture_bedroom,1.0909090909090908
market_place,1.0757575757575757
fashion_bags_accessories,1.0689655172413792
office_furniture,1.0680044593088072
tablets_printing_image,1.064516129032258
musical_instruments,1.0643776824034334
art,1.0612244897959184
home_construction,1.0604534005037782
consoles_games,1.0595533498759304
audio,1.0590551181102361
bed_bath_table,1.0588859416445624
home_comfort_2,1.0588235294117647
garden_tools,1.0553207837111025
housewares,1.053544331237806
cool_stuff,1.0528341497550735
furniture_living_room,1.0515151515151515
luggage_accessories,1.0502392344497609
furniture_decor,1.0491969912583858
kitchen_dining_laundry_garden_furniture,1.0473684210526315
baby,1.0467657342657342
dvds_blu_ray,1.0454545454545454
home_confort,1.0438871473354232
pet_shop,1.0432190760059612
food_drink,1.0426829268292683
stationery,1.0420995079278295
telephony,1.0418275418275418
construction_tools_safety,1.04
sports_leisure,1.0394647696476964
toys,1.039291465378422
costruction_tools_garden,1.038709677419355
computers_accessories,1.0371543170783195
fixed_telephony,1.037037037037037
electronics,1.0361771058315334
fashion_shoes,1.035897435897436
music,1.0357142857142858
watches_gifts,1.0345884413309983
auto,1.034136546184739
perfumery,1.033186725309876
health_beauty,1.033022985161478
books_general_interest,1.0315789473684212
small_appliances,1.0285132382892057
home_appliances,1.0278688524590165
construction_tools_lights,1.0276243093922652
costruction_tools_tools,1.027027027027027
construction_tools_construction,1.0257731958762886
food,1.024390243902439
books_imported,1.024390243902439
cine_photo,1.0238095238095237
drinks,1.0213675213675213
air_conditioning,1.0208333333333333
christmas_supplies,1.0204081632653061
industry_commerce_and_business,1.0164835164835164
books_technical,1.0157894736842106
small_appliances_home_oven_and_coffee,1.0
signaling_and_security,1.0
security_and_services,1.0
flowers,1.0
fashion_sport,1.0
fashion_childrens_clothes,1.0
fashio_female_clothing,1.0
diapers_and_hygiene,1.0
cds_dvds_musicals,1.0
arts_and_craftmanship,1.0


2025-01-25 10:14:32 - root - INFO - Please check the answer again by reviewing Could you help me calculate the average of the total payment count for the most preferred payment method in each product category?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: I'm sorry, but I cannot calculate the average of the total payment count for the most preferred payment method in each product category, as I do not have access to the actual data in the provided tables. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
category,average_total_payment_count
la_cuisine,1.1666666666666667
fashion_underwear_beach,1.141304347826087
agro_industry_and_commerce,1.12
fashion_male_clothing,1.1123595505617978
party_supplies,1.1111111111111112
computers,1.105263157894737
furniture_mattress_and_upholstery,1.09375
home_appliances_2,1.0934065934065933
furniture_bedroom,1.0909090909090908
market_place,1.0757575757575757
fashion_bags_accessories,1.0689655172413792
office_furniture,1.0680044593088072
tablets_printing_image,1.064516129032258
musical_instruments,1.0643776824034334
art,1.0612244897959184
home_construction,1.0604534005037782
consoles_games,1.0595533498759304
audio,1.0590551181102361
bed_bath_table,1.0588859416445624
home_comfort_2,1.0588235294117647
garden_tools,1.0553207837111025
housewares,1.053544331237806
cool_stuff,1.0528341497550735
furniture_living_room,1.0515151515151515
luggage_accessories,1.0502392344497609
furniture_decor,1.0491969912583858
kitchen_dining_laundry_garden_furniture,1.0473684210526315
baby,1.0467657342657342
dvds_blu_ray,1.0454545454545454
home_confort,1.0438871473354232
pet_shop,1.0432190760059612
food_drink,1.0426829268292683
stationery,1.0420995079278295
telephony,1.0418275418275418
construction_tools_safety,1.04
sports_leisure,1.0394647696476964
toys,1.039291465378422
costruction_tools_garden,1.038709677419355
computers_accessories,1.0371543170783195
fixed_telephony,1.037037037037037
electronics,1.0361771058315334
fashion_shoes,1.035897435897436
music,1.0357142857142858
watches_gifts,1.0345884413309983
auto,1.034136546184739
perfumery,1.033186725309876
health_beauty,1.033022985161478
books_general_interest,1.0315789473684212
small_appliances,1.0285132382892057
home_appliances,1.0278688524590165
construction_tools_lights,1.0276243093922652
costruction_tools_tools,1.027027027027027
construction_tools_construction,1.0257731958762886
food,1.024390243902439
books_imported,1.024390243902439
cine_photo,1.0238095238095237
drinks,1.0213675213675213
air_conditioning,1.0208333333333333
christmas_supplies,1.0204081632653061
industry_commerce_and_business,1.0164835164835164
books_technical,1.0157894736842106
small_appliances_home_oven_and_coffee,1.0
signaling_and_security,1.0
security_and_services,1.0
flowers,1.0
fashion_sport,1.0
fashion_childrens_clothes,1.0
fashio_female_clothing,1.0
diapers_and_hygiene,1.0
cds_dvds_musicals,1.0
arts_and_craftmanship,1.0
Current sql:
WITH
    category_payment_counts AS (
        SELECT
            pt.product_category_name_english AS category,
            oop.payment_type,
            COUNT(*) AS payment_count
        FROM
            olist_order_items AS ooi
            JOIN olist_products AS p ON ooi.product_id = p.product_id
            JOIN product_category_name_translation AS pt ON p.product_category_name = pt.product_category_name
            JOIN olist_order_payments AS oop ON ooi.order_id = oop.order_id
        GROUP BY
            pt.product_category_name_english,
            oop.payment_type
    ),
    most_preferred_payment_methods AS (
        SELECT
            category,
            payment_type
        FROM (
            SELECT
                category,
                payment_type,
                payment_count,
                RANK() OVER (PARTITION BY category ORDER BY payment_count DESC) AS rk
            FROM category_payment_counts
        )
        WHERE rk = 1
    ),
    order_payment_counts AS (
        SELECT
            order_id,
            COUNT(*) AS total_payment_count
        FROM
            olist_order_payments
        GROUP BY
            order_id
    ),
    order_categories AS (
        SELECT DISTINCT
            ooi.order_id,
            pt.product_category_name_english AS category,
            oop.payment_type
        FROM
            olist_order_items AS ooi
            JOIN olist_products AS p ON ooi.product_id = p.product_id
            JOIN product_category_name_translation AS pt ON p.product_category_name = pt.product_category_name
            JOIN olist_order_payments AS oop ON ooi.order_id = oop.order_id
    ),
    orders_with_preferred_payment_method AS (
        SELECT
            oc.order_id,
            oc.category
        FROM
            order_categories AS oc
            JOIN most_preferred_payment_methods AS mppm ON
                oc.category = mppm.category AND
                oc.payment_type = mppm.payment_type
    ),
    category_order_payments AS (
        SELECT
            owppm.category,
            owppm.order_id,
            opc.total_payment_count
        FROM
            orders_with_preferred_payment_method AS owppm
            JOIN order_payment_counts AS opc ON owppm.order_id = opc.order_id
    )
SELECT
    category,
    AVG(total_payment_count) AS average_total_payment_count
FROM
    category_order_payments
GROUP BY
    category
ORDER BY
    average_total_payment_count DESC;
2025-01-25 10:15:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:15:18 - root - INFO - ```sql
WITH
    category_payment_counts AS (
        SELECT
            pt.product_category_name_english AS category,
            oop.payment_type,
            COUNT(*) AS payment_count
        FROM
            olist_order_items AS ooi
            JOIN olist_products AS p ON ooi.product_id = p.product_id
            JOIN product_category_name_translation AS pt ON p.product_category_name = pt.product_category_name
            JOIN olist_order_payments AS oop ON ooi.order_id = oop.order_id
        GROUP BY
            pt.product_category_name_english,
            oop.payment_type
    ),
    most_preferred_payment_methods AS (
        SELECT
            category,
            payment_type
        FROM (
            SELECT
                category,
                payment_type,
                payment_count,
                RANK() OVER (PARTITION BY category ORDER BY payment_count DESC) AS rk
            FROM category_payment_counts
        )
        WHERE rk = 1
    ),
    order_payment_counts AS (
        SELECT
            order_id,
            COUNT(*) AS total_payment_count
        FROM
            olist_order_payments
        GROUP BY
            order_id
    ),
    order_categories AS (
        SELECT DISTINCT
            ooi.order_id,
            pt.product_category_name_english AS category,
            oop.payment_type
        FROM
            olist_order_items AS ooi
            JOIN olist_products AS p ON ooi.product_id = p.product_id
            JOIN product_category_name_translation AS pt ON p.product_category_name = pt.product_category_name
            JOIN olist_order_payments AS oop ON ooi.order_id = oop.order_id
    ),
    orders_with_preferred_payment_method AS (
        SELECT
            oc.order_id,
            oc.category
        FROM
            order_categories AS oc
            JOIN most_preferred_payment_methods AS mppm ON
                oc.category = mppm.category AND
                oc.payment_type = mppm.payment_type
    ),
    category_order_payments AS (
        SELECT
            owppm.category,
            owppm.order_id,
            opc.total_payment_count
        FROM
            orders_with_preferred_payment_method AS owppm
            JOIN order_payment_counts AS opc ON owppm.order_id = opc.order_id
    )
SELECT
    category,
    ROUND(AVG(total_payment_count), 4) AS average_total_payment_count
FROM
    category_order_payments
GROUP BY
    category
ORDER BY
    average_total_payment_count DESC;
```
2025-01-25 10:15:29 - root - INFO - itercount: 2
2025-01-25 10:15:29 - root - INFO - 0
2025-01-25 10:15:29 - root - INFO - Total iteration counts: 2
