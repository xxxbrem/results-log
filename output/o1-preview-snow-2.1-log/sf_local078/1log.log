2025-01-20 19:05:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.491541 seconds
2025-01-20 19:07:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:07:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:07 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:08 - root - INFO - SQL:
-- Query 1: Select all data from INTEREST_METRICS
SELECT * 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000
Results:
Too long, hard cut:
_month,_year,month_year,interest_id,composition,index_value,ranking,percentile_ranking
7.0,2018.0,07-2018,32486.0,11.89,6.19,1,99.86
7.0,2018.0,07-2018,6106.0,9.93,5.31,2,99.73
7.0,2018.0,07-2018,18923.0,10.85,5.29,3,99.59
7.0,2018.0,07-2018,6344.0,10.32,5.1,4,99.45
7.0,2018.0,07-2018,100.0,10.77,5.04,5,99.31
7.0,2018.0,07-2018,69.0,10.82,5.03,6,99.18
7.0,2018.0,07-2018,79.0,11.21,4.97,7,99.04
7.0,2018.0,07-2018,6111.0,10.71,4.83,8,98.9
7.0,2018.0,07-2018,6214.0,9.71,4.83,8,98.9
7.0,2018.0,07-2018,19422.0,10.11,4.81,10,98.63
7.0,2018.0,07-2018,6110.0,11.57,4.79,11,98.49
7.0,2018.0,07-2018,4895.0,9.47,4.67,12,98.35
7.0,2018.0,07-2018,6217.0,10.8,4.62,13,98.22
7.0,2018.0,07-2018,4.0,13.97,4.53,14,98.08
7.0,2018.0,07-2018,6218.0,9.29,4.5,15,97.94
7.0,2018.0,07-2018,6123.0,9.49,4.49,16,97.81
7.0,2018.0,07-2018,171.0,14.91,4.47,17,97.67
7.0,2018.0,07-2018,19613.0,12.62,4.38,18,97.53
7.0,2018.0,07-2018,17.0,7.89,4.15,19,97.39
7.0,2018.0,07-2018,6.0,11.99,4.08,20,97.26
7.0,2018.0,07-2018,6013.0,9.35,3.99,21,97.12
7.0,2018.0,07-2018,4870.0,10.29,3.95,22,96.98
7.0,2018.0,07-2018,19423.0,12.22,3.92,23,96.84
7.0,2018.0,07-2018,6089.0,6.97,3.84,24,96.71
7.0,2018.0,07-2018,161.0,11.48,3.82,25,96.57
7.0,2018.0,07-2018,6286.0,14.1,3.82,25,96.57
7.0,2018.0,07-2018,5991.0,11.04,3.81,27,96.3
7.0,2018.0,07-2018,92.0,9.77,3.77,28,96.16
7.0,2018.0,07-2018,6184.0,13.35,3.75,29,96.02
7.0,2018.0,07-2018,19621.0,11.61,3.74,30,95.88
7.0,2018.0,07-2018,63.0,9.37,3.73,31,95.75
7.0,2018.0,07-2018,103.0,6.61,3.69,32,95.61
7.0,2018.0,07-2018,38.0,9.48,3.66,33,95.47
7.0,2018.0,07-2018,17786.0,13.67,3.65,34,95.34
7.0,2018.0,07-2018,6232.0,9.97,3.64,35,95.2
7.0,2018.0,07-2018,165.0,6.05,3.59,36,95.06
7.0,2018.0,07-2018,18351.0,6.09,3.58,37,94.92
7.0,2018.0,07-2018,15.0,6.9,3.56,38,94.79
,,,,6.12,2.85,43,96.4
7.0,2018.0,07-2018,17314.0,10.43,3.55,39,94.65
7.0,2018.0,07-2018,6151.0,6.83,3.55,39,94.65
7.0,2018.0,07-2018,4914.0,7.42,3.55,39,94.65
7.0,2018.0,07-2018,115.0,11.68,3.53,42,94.24
7.0,2018.0,07-2018,5968.0,12.87,3.53,42,94.24
7.0,2018.0,07-2018,36.0,9.27,3.51,44,93.96
7.0,2018.0,07-2018,5943.0,6.37,3.48,45,93.83
7.0,2018.0,07-2018,133.0,10.91,3.44,46,93.69
7.0,2018.0,07-2018,1.0,7.02,3.44,46,93.69
7.0,2018.0,07-2018,114.0,6.25,3.41,48,93.42
7.0,2018.0,07-2018,6107.0,8.84,3.39,49,93.28
7.0,2018.0,07-2018,150.0,5.3,3.39,49,93.28
7.0,2018.0,07-2018,60.0,6.71,3.36,51,93.0
7.0,2018.0,07-2018,96.0,7.21,3.35,52,92.87
7.0,2018.0,07-2018,22403.0,12.27,3.33,53,92.73
7.0,2018.0,07-2018,40.0,10.86,3.32,54,92.59
7.0,2018.0,07-2018,19758.0,6.28,3.32,54,92.59
7.0,2018.0,07-2018,17730.0,11.38,3.3,56,92.32
7.0,2018.0,07-2018,5938.0,11.63,3.29,57,92.18
7.0,2018.0,07-2018,4869.0,6.47,3.29,57,92.18
7.0,2018.0,07-2018,4897.0,12.93,3.27,59,91.91
7.0,2018.0,07-2018,6029.0,8.72,3.26,60,91.77
7.0,2018.0,07-2018,31.0,7.9,3.26,60,91.77
7.0,2018.0,07-2018,16137.0,9.65,3.24,62,91.5
7.0,2018.0,07-2018,6330.0,6.82,3.22,63,91.36
7.0,2018.0,07-2018,6334.0,11.63,3.22,63,91.36
7.0,2018.0,07-2018,6315.0,8.14,3.22,63,91.36
7.0,2018.0,07-2018,4852.0,6.77,3.2,66,90.95
7.0,2018.0,07-2018,16.0,6.24,3.2,66,90.95
7.0,2018.0,07-2018,6108.0,6.65,3.17,68,90.67
7.0,2018.0,07-2018,6206.0,10.76,3.17,68,90.67
7.0,2018.0,07-2018,6006.0,6.26,3.15,70,90.4
7.0,2018.0,07-2018,6228.0,10.22,3.15,70,90.4
7.0,2018.0,07-2018,20768.0,6.53,3.15,70,90.4
7.0,2018.0,07-2018,4902.0,8.17,3.12,73,89.99
7.0,2018.0,07-2018,6277.0,11.72,3.1,74,89.85
7.0,2018.0,07-2018,19757.0,10.95,3.08,75,89.71
7.0,2018.0,07-2018,4911.0,6.87,3.08,75,89.71
,,,,7.13,2.84,45,96.23
7.0,2018.0,07-2018,4910.0,6.09,3.07,77,89.44
7.0,2018.0,07-2018,6285.0,9.97,3.04,78,89.3
7.0,2018.0,07-2018,11974.0,7.19,3.02,79,89.16
7.0,2018.0,07-2018,6219.0,6.37,3.02,79,89.16
7.0,2018.0,07-2018,10250.0,11.4,3.01,81,88.89
7.0,2018.0,07-2018,6128.0,6.28,2.98,82,88.75
7.0,2018.0,07-2018,5946.0,5.99,2.97,83,88.61
7.0,2018.0,07-2018,158.0,7.46,2.97,83,88.61
7.0,2018.0,07-2018,15935.0,9.13,2.96,85,88.34
7.0,2018.0,07-2018,4855.0,5.99,2.95,86,88.2
7.0,2018.0,07-2018,149.0,6.88,2.95,86,88.2
7.0,2018.0,07-2018,16197.0,6.13,2.94,88,87.93
7.0,2018.0,07-2018,11067.0,5.14,2.93,89,87.79
7.0,2018.0,07-2018,17674.0,6.25,2.92,90,87.65
7.0,2018.0,07-2018,4913.0,6.76,2.92,90,87.65
7.0,2018.0,07-2018,56.0,7.09,2.91,92,87.38
7.0,2018.0,07-2018,6341.0,5.68,2.91,92,87.38
7.0,2018.0,07-2018,6316.0,6.52,2.91,92,87.38
7.0,2018.0,07-2018,18647.0,6.45,2.91,92,87.38
7.0,2018.0,07-2018,17803.0,6.21,2.91,92,87.38
7.0,2018.0,07-2018,23.0,5.41,2.89,97,86.69
7.0,2018.0,07-2018,132.0,7.48,2.88,98,86.56
7.0,2018.0,07-2018,6365.0,6.45,2.88,98,86.56
7.0,2018.0,07-2018,6378.0,9.64,2.87,100,86.28
7.0,2018.0,07-2018,17673.0,8.07,2.86,101,86.15
7.0,2018.0,07-2018,97.0,6.41,2.86,101,86.15
7.0,2018.0,07-2018,7537.0,7.82,2.86,101,86.15
7.0,2018.0,07-2018,20764.0,5.85,2.86,101,86.15
7.0,2018.0,07-2018,44.0,6.11,2.85,105,85.6
7.0,2018.0,07-2018,5.0,10.82,2.85,105,85.6
7.0,2018.0,07-2018,6227.0,6.07,2.85,105,85.6
7.0,2018.0,07-2018,19.0,6.57,2.84,108,85.19
7.0,2018.0,07-2018,93.0,7.08,2.8

2025-01-20 19:07:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:09 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:10 - root - INFO - SQL:
-- Query 2: Get distinct interest IDs from INTEREST_METRICS
SELECT DISTINCT "interest_id" 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000
Results:
Too long, hard cut:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
6111.0
19422.0
6110.0
6217.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
6286.0
19621.0
63.0
165.0
18351.0
""
17314.0
4914.0
6107.0
40.0
5938.0
16137.0
6330.0
6006.0
6228.0
4902.0
97.0
20764.0
5.0
19610.0
4940.0
10838.0
6255.0
69.0
79.0
4895.0
5991.0
114.0
96.0
19758.0
6029.0
6334.0
6315.0
6206.0
20768.0
4855.0
56.0
23.0
98.0
18646.0
6162.0
128.0
6308.0
148.0
18347.0
4910.0
32703.0
6214.0
4.0
6218.0
161.0
92.0
6184.0
6232.0
36.0
150.0
17730.0
4869.0
31.0
19757.0
4911.0
5946.0
6378.0
6172.0
169.0
6299.0
6304.0
6123.0
103.0
38.0
17786.0
15.0
115.0
22403.0
4852.0
6108.0
6219.0
10250.0
149.0
16197.0
11067.0
4913.0
6316.0
17803.0
44.0
19.0
4873.0
86.0
24.0
12133.0
6141.0
4943.0
18996.0
85.0
19587.0
135.0
19588.0
77.0
4944.0
111.0
151.0
7461.0
17785.0
6318.0
7605.0
12.0
70.0
19579.0
18490.0
147.0
6062.0
19760.0
6115.0
6265.0
18350.0
6148.0
6340.0
109.0
12027.0
18784.0
34.0
102.0
6323.0
5896.0
6301.0
22411.0
6321.0
62.0
6222.0
6341.0
17673.0
6112.0
20753.0
125.0
17269.0
6284.0
7557.0
117.0
33.0
17320.0
18202.0
10008.0
10976.0
21242.0
21293.0
6278.0
64.0
88.0
5921.0
21057.0
6133.0
22096.0
18622.0
19294.0
5963.0
10988.0
116.0
21061.0
5984.0
45.0
21058.0
4857.0
6024.0
157.0
143.0
14901.0
6320.0
19604.0
7536.0
16196.0
18203.0
38360.0
36864.0
37876.0
10954.0
133.0
11974.0
15935.0
18647.0
5968.0
5943.0
16.0
6277.0
6285.0
6128.0
17674.0
93.0
22502.0
20750.0
6087.0
104.0
39.0
5952.0
164.0
5989.0
138.0
12277.0
61.0
6211.0
5972.0
6023.0
5960.0
90.0
6144.0
49.0
75.0
18781.0
4848.0
5930.0
13496.0
4920.0
163.0
33191.0
5918.0
13421.0
12025.0
19297.0
10870.0
19606.0
170.0
6151.0
1.0
60.0
158.0
132.0
6365.0
7537.0
6227.0
6085.0
11975.0
13.0
89.0
37.0
6084.0
8.0
4909.0
6127.0
66.0
7453.0
6171.0
131.0
10839.0
67.0
4861.0
19630.0
5970.0
4907.0
20767.0
10837.0
130.0
27.0
19879.0
4915.0
6250.0
6237.0
6302.0
22425.0
6207.0
141.0
6181.0
6298.0
6145.0
22.0
4918.0
17671.0
5906.0
35.0
21292.0
19250.0
82.0
13498.0
4925.0
6319.0
10365.0
6366.0
4898.0
7425.0
16119.0
65.0
5898.0
6051.0
5901.0
4866.0
6095.0
6229.0
20814.0
4904.0
7527.0
20963.0
6221.0
6210.0
139.0
19603.0
126.0
5920.0
7529.0
41.0
10972.0
22424.0
19338.0
19578.0
6263.0
10980.0
6267.0
119.0
4859.0
155.0
12031.0
107.0
17318.0
21060.0
5961.0
18997.0
6142.0
87.0
22423.0
21236.0
21238.0
80.0
6208.0
23778.0
18204.0
19628.0
19590.0
22095.0
145.0
20815.0
6305.0
6328.0
30.0
4928.0
59.0
55.0
18619.0
6030.0
10284.0
6209.0
6169.0
142.0
6194.0
153.0
10832.0
6088.0
11065.0
22093.0
6393.0
50.0
20755.0
12821.0
14800.0
6300.0
10009.0
18807.0
32705.0
6335.0
108.0
6149.0
10364.0
6367.0
4903.0
110.0
20816.0
4867.0
20730.0
7546.0
18924.0
4908.0
19593.0
6230.0
6317.0
5936.0
18783.0
7597.0
7545.0
6345.0
17729.0
4906.0
10970.0
22401.0
10836.0
4933.0
6215.0
6156.0
5945.0
112.0
6339.0
6122.0
19594.0
4931.0
6034.0
22398.0
72.0
19609.0
6332.0
21248.0
58.0
10971.0
7598.0
19626.0
19631.0
6047.0
21244.0
34462.0
34082.0
34461.0
34077.0
34084.0
34079.0
34460.0
33534.0
21245.0
34651.0
34643.0
34647.0
34650.0
34638.0
34646.0
36343.0
37411.0
37423.0
37874.0
37420.0
36876.0
38355.0
37414.0
38362.0
38351.0
37887.0
37166.0
38365.0
37165.0
37878.0
37416.0
38358.0
38989.0
39190.0
39192.0
39770.0
39651.0
39199.0
39659.0
41854.0
41191.0
41192.0
42238.0
42237.0
41554.0
40692.0
40687.0
40427.0
40694.0
42964.0
44470.0
44476.0
44479.0
44456.0
45524.0
44379.0
45669.0
45668.0
46567.0
49979.0
10011.0
22427.0
16138.0
18621.0
6329.0
6076.0
5914.0
6337.0
10977.0
12132.0
5911.0
6260.0
4917.0
5907.0
4924.0
95.0
5942.0
10978.0
19627.0
83.0
17672.0
6234.0
6322.0
28.0
19633.0
5909.0
10872.0
6324.0
6134.0
6253.0
6174.0
6212.0
6391.0
6159.0
19878.0
7543.0
10834.0
25.0
5934.0
6257.0
22400.0
4935.0
5929.0
22417.0
10975.0
6098.0
12032.0
6385.0
6124.0
32702.0
19612.0
10974.0
10010.0
6049.0
19634.0
166.0
5971.0
19624.0
21249.0
6236.0
121.0
10955.0
19615.0
5900.0
21251.0
15884.0
17274.0
11977.0
20752.0
2.0
19596.0
33474.0
34574.0
34088.0
34468.0
33972.0
33962.0
33958.0
35953.0
35169.0
34637.0
34644.0
34649.0
34642.0
37413.0
37877.0
36869.0
38284.0
37418.0
38361.0
37417.0
37412.0
38990.0
40183.0
40685.0
40683.0
39196.0
39649.0
40697.0
40691.0
40688.0
39643.0
40195.0
39547.0
39645.0
39658.0
39331.0
39338.0
39654.0
41856.0
41190.0
41855.0
41078.0
41079.0
41066.0
41059.0
40695.0
40526.0
44453.0
44587.0
45670.0
44473.0
44466.0
44484.0
45519.0
45675.0
45679.0
45673.0
44483.0
44589.0
44471.0
44458.0
44467.0
44384.0
45528.0
43551.0
39655.0
44580.0
42008.0
49972.0
51678.0
49975.0
84.0
13428.0
19635.0
19595.0
35742.0
37875.0
36873.0
36863.0
40525.0
40187.0
40699.0
41067.0
41075.0
43550.0
44486.0
45672.0
14802.0
44459.0
7540.0
12490.0
21237.0
4897.0
101.0
137.0
20731.0
6182.0
3.0
6336.0
15877.0
5951.0
6143.0
6173.0
12820.0
19295.0
6045.0
4894.0
5999.0
6220.0
6264.0
5895.0
5944.0
14.0
99.0
74.0
5924.0
21059.0
162.0
22413.0
26.0
6266.0
5910.0
18352.0
6183.0
6081.0
21239.0
7535.0
5958.0
4930.0
19617.0
5956.0
168.0
134.0
17271.0
18.0
4936.0
32701.0
10833.0
81.0
7464.0
71.0
19607.0
10251.0
4937.0
6303.0
1

2025-01-20 19:07:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-20 19:07:11 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:11 - root - INFO - SQL:
-- Query 3: Get composition values over time for interest_id = 1
SELECT "month_year", "composition" 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "interest_id" = 1 
LIMIT 1000
Results:
month_year,composition
07-2018,7.02
08-2018,3.44
09-2018,2.44
10-2018,3.71
11-2018,2.79
12-2018,2.94
01-2019,2.38
02-2019,2.55
03-2019,2.76
04-2019,2.28
05-2019,1.68
08-2019,2.64

2025-01-20 19:07:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:13 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:13 - root - INFO - SQL:
-- Query 4: Get maximum composition value for each interest_id
SELECT "interest_id", MAX("composition") AS "max_composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000
Results:
Too long, hard cut:
interest_id,max_composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
6111.0,10.71
19422.0,10.11
6110.0,11.57
6217.0,10.8
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,12.56
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
6286.0,14.1
19621.0,11.61
63.0,9.37
165.0,6.05
18351.0,6.09
,9.66
17314.0,10.43
4914.0,7.42
6107.0,8.84
40.0,10.86
5938.0,11.63
16137.0,9.65
6330.0,6.82
6006.0,6.26
6228.0,10.22
4902.0,8.17
97.0,6.41
20764.0,5.85
5.0,10.82
19610.0,7.56
4940.0,5.89
10838.0,6.8
6255.0,7.55
69.0,10.82
79.0,11.21
4895.0,9.47
5991.0,11.04
114.0,6.25
96.0,7.21
19758.0,6.28
6029.0,10.05
6334.0,11.63
6315.0,8.14
6206.0,10.76
20768.0,6.53
4855.0,5.99
56.0,7.09
23.0,5.41
98.0,7.64
18646.0,6.85
6162.0,6.32
128.0,6.5
6308.0,9.33
148.0,5.49
18347.0,7.8
4910.0,6.09
32703.0,5.69
6214.0,9.71
4.0,13.97
6218.0,9.29
161.0,11.48
92.0,9.77
6184.0,13.35
6232.0,9.97
36.0,9.27
150.0,5.3
17730.0,11.38
4869.0,6.47
31.0,7.9
19757.0,10.95
4911.0,6.87
5946.0,5.99
6378.0,9.64
6172.0,6.1
169.0,6.1
6299.0,5.71
6304.0,8.31
6123.0,9.49
103.0,6.61
38.0,9.48
17786.0,13.67
15.0,6.9
115.0,11.68
22403.0,12.27
4852.0,6.77
6108.0,6.65
6219.0,6.37
10250.0,11.4
149.0,6.88
16197.0,6.13
11067.0,7.93
4913.0,6.76
6316.0,6.52
17803.0,6.21
44.0,6.11
19.0,6.57
4873.0,5.57
86.0,6.13
24.0,6.54
12133.0,15.15
6141.0,6.34
4943.0,10.7
18996.0,7.84
85.0,6.46
19587.0,5.85
135.0,7.01
19588.0,5.87
77.0,17.19
4944.0,9.46
111.0,7.42
151.0,7.97
7461.0,7.0
17785.0,7.66
6318.0,6.65
7605.0,6.82
12.0,7.23
70.0,6.96
19579.0,6.24
18490.0,7.09
147.0,6.17
6062.0,7.33
19760.0,5.36
6115.0,6.67
6265.0,7.31
18350.0,6.85
6148.0,7.13
6340.0,7.44
109.0,6.75
12027.0,8.32
18784.0,7.47
34.0,11.23
102.0,7.74
6323.0,6.28
5896.0,6.09
6301.0,5.58
22411.0,5.22
6321.0,4.97
62.0,4.15
6222.0,3.49
6341.0,5.68
17673.0,8.07
6112.0,9.22
20753.0,5.79
125.0,6.38
17269.0,8.64
6284.0,18.82
7557.0,8.17
117.0,6.49
33.0,7.6
17320.0,3.98
18202.0,8.23
10008.0,9.46
10976.0,8.16
21242.0,7.36
21293.0,7.28
6278.0,6.18
64.0,12.41
88.0,4.99
5921.0,7.37
21057.0,21.2
6133.0,3.82
22096.0,6.56
18622.0,7.44
19294.0,7.22
5963.0,5.36
10988.0,8.17
116.0,6.31
21061.0,8.97
5984.0,4.9
45.0,6.29
21058.0,8.5
4857.0,6.56
6024.0,4.7
157.0,4.94
143.0,4.68
14901.0,4.15
6320.0,4.72
19604.0,5.82
7536.0,5.84
16196.0,4.59
18203.0,2.9
38360.0,3.48
36864.0,3.35
37876.0,2.26
10954.0,1.88
133.0,10.91
11974.0,7.19
15935.0,9.13
18647.0,6.45
5968.0,12.87
5943.0,6.37
16.0,6.24
6277.0,11.72
6285.0,9.97
6128.0,6.28
17674.0,7.88
93.0,7.08
22502.0,8.24
20750.0,5.87
6087.0,5.41
104.0,5.42
39.0,17.44
5952.0,7.11
164.0,6.14
5989.0,5.57
138.0,7.3
12277.0,6.2
61.0,6.59
6211.0,8.09
5972.0,6.6
6023.0,8.02
5960.0,10.61
90.0,5.91
6144.0,6.61
49.0,5.09
75.0,7.23
18781.0,6.56
4848.0,6.49
5930.0,6.17
13496.0,6.78
4920.0,5.93
163.0,6.4
33191.0,4.39
5918.0,6.8
13421.0,7.15
12025.0,8.45
19297.0,4.26
10870.0,3.29
19606.0,4.42
170.0,4.76
6151.0,6.83
1.0,7.02
60.0,8.66
158.0,11.97
132.0,7.48
6365.0,6.45
7537.0,7.82
6227.0,6.45
6085.0,7.08
11975.0,7.81
13.0,6.72
89.0,10.14
37.0,7.82
6084.0,6.97
8.0,6.67
4909.0,7.01
6127.0,5.96
66.0,6.51
7453.0,6.45
6171.0,8.19
131.0,5.09
10839.0,5.59
67.0,6.76
4861.0,5.29
19630.0,7.15
5970.0,9.21
4907.0,6.26
20767.0,7.73
10837.0,7.48
130.0,7.66
27.0,6.81
19879.0,6.95
4915.0,6.28
6250.0,5.54
6237.0,7.7
6302.0,7.41
22425.0,6.41
6207.0,7.81
141.0,9.46
6181.0,6.11
6298.0,5.38
6145.0,6.1
22.0,6.26
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
21292.0,7.19
19250.0,7.7
82.0,9.99
13498.0,6.42
4925.0,6.4
6319.0,7.39
10365.0,5.21
6366.0,6.6
4898.0,14.23
7425.0,8.54
16119.0,7.93
65.0,5.94
5898.0,7.85
6051.0,5.31
5901.0,6.79
4866.0,6.33
6095.0,7.5
6229.0,7.2
20814.0,5.78
4904.0,6.28
7527.0,5.97
20963.0,5.78
6221.0,5.94
6210.0,6.09
139.0,6.87
19603.0,6.05
126.0,6.67
5920.0,6.07
7529.0,6.5
41.0,6.96
10972.0,7.35
22424.0,6.05
19338.0,7.68
19578.0,4.14
6263.0,5.14
10980.0,6.14
6267.0,6.88
119.0,6.31
4859.0,6.48
155.0,4.97
12031.0,7.08
107.0,8.32
17318.0,4.93
21060.0,8.58
5961.0,7.12
18997.0,6.05
6142.0,6.25
87.0,5.01
22423.0,5.33
21236.0,6.64
21238.0,5.15
80.0,4.47
6208.0,9.67
23778.0,5.52
18204.0,6.51
19628.0,4.66
19590.0,4.59
22095.0,4.54
145.0,4.89
20815.0,3.03
6305.0,6.2
6328.0,5.43
30.0,8.56
4928.0,4.78
59.0,3.97
55.0,7.67
18619.0,9.15
6030.0,3.85
10284.0,5.02
6209.0,4.45
6169.0,3.8
142.0,4.73
6194.0,4.39
153.0,5.08
10832.0,4.4
6088.0,4.28
11065.0,4.22
22093.0,4.34
6393.0,3.17
50.0,3.86
20755.0,4.77
12821.0,5.18
14800.0,4.11
6300.0,4.91
10009.0,8.95
18807.0,4.1
32705.0,4.69
6335.0,4.41
108.0,4.24
6149.0,4.1
10364.0,3.29
6367.0,3.78
4903.0,3.67
110.0,5.78
20816.0,2.79
4867.0,5.44
20730.0,4.0
7546.0,4.72
18924.0,4.61
4908.0,3.29
19593.0,6.18
6230.0,4.39
6317.0,4.67
5936.0,3.78
18783.0,9.83
7597.0,3.18
7545.0,4.19
6345.0,3.94
17729.0,6.7
4906.0,3.09
10970.0,4.04
22401.0,3.62
10836.0,4.18
4933.0,3.46
6215.0,3.81
6156.0,2.99
5945.0,4.87
112.0,2.95
6339.0,3.79
6122.0,3.05
19594.0,2.48
4931.0,4.05
6034.0,4.69
22398.0,3.52
72.0,3.63
19609.0,3.17
6332.0,2.65
21248.0,2.88
58.0,2.18
10971.0,2.67
7598.0,2.82
19626.0,1.99
19631.0,2.

2025-01-20 19:07:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:15 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:15 - root - INFO - SQL:
-- Query 5: Join INTEREST_METRICS and INTEREST_MAP to get interest names
SELECT im."interest_name", m."interest_id", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
LIMIT 1000
Results:
Too long, hard cut:
interest_name,interest_id,composition,month_year
Vacation Rental Accommodation Researchers,32486.0,11.89,07-2018
Luxury Second Home Owners,6106.0,9.93,07-2018
Online Home Decor Shoppers,18923.0,10.85,07-2018
Hair Care Shoppers,6344.0,10.32,07-2018
Nutrition Conscious Eaters,100.0,10.77,07-2018
Healthy Eaters,69.0,10.82,07-2018
Luxury Travel Researchers,79.0,11.21,07-2018
Wine Lovers,6111.0,10.71,07-2018
Home Remodelers,6214.0,9.71,07-2018
Home Design and Living Publication Readers,19422.0,10.11,07-2018
Apartment Furniture Shoppers,6110.0,11.57,07-2018
Mature Parents,4895.0,9.47,07-2018
Weight Loss Researchers,6217.0,10.8,07-2018
Luxury Retail Researchers,4.0,13.97,07-2018
Running Enthusiasts,6218.0,9.29,07-2018
Misc-Deal Seekers or Coupon Shoppers,6123.0,9.49,07-2018
Shoe Shoppers,171.0,14.91,07-2018
Land Rover Shoppers,19613.0,12.62,07-2018
MLB Fans,17.0,7.89,07-2018
Vacation Planners,6.0,11.99,07-2018
Competitive Sports Participants,6013.0,9.35,07-2018
Tech-Savvy Moms,4870.0,10.29,07-2018
Kitchen Appliance Shoppers,19423.0,12.22,07-2018
Mens Fitness Publication Readers,6089.0,6.97,07-2018
Travel Reward Points Enthusiasts,161.0,11.48,07-2018
Luxury Hotel Guests,6286.0,14.1,07-2018
Gluten-Free Recipe Researchers,5991.0,11.04,07-2018
Parents with Kids,92.0,9.77,07-2018
Reusable Drinkware Shoppers,6184.0,13.35,07-2018
Portugal Trip Planners,19621.0,11.61,07-2018
New & Expecting Parents,63.0,9.37,07-2018
Live Concert Fans,103.0,6.61,07-2018
Sporting Goods Shoppers,38.0,9.48,07-2018
Womens Fashion Brands Shoppers,17786.0,13.67,07-2018
Golf Enthusiasts,6232.0,9.97,07-2018
Liberal News Readers,165.0,6.05,07-2018
Drama Show Watchers,18351.0,6.09,07-2018
NBA Fans,15.0,6.9,07-2018
Lobbyists,17314.0,10.43,07-2018
Wedding Registrants,6151.0,6.83,07-2018
Mens Health Researchers,4914.0,7.42,07-2018
Mens Shoe Shoppers,115.0,11.68,07-2018
Luxury Kitchen Goods Shoppers,5968.0,12.87,07-2018
Baby Products Buyers,36.0,9.27,07-2018
Financial News Readers,5943.0,6.37,07-2018
High End Camera Shoppers - Dupe,133.0,10.91,07-2018
Fitness Enthusiasts,1.0,7.02,07-2018
Womens Fashion Magazine Readers,114.0,6.25,07-2018
Ski House Second Home Owners,6107.0,8.84,07-2018
TV Junkies,150.0,5.3,07-2018
Online Health Researchers,60.0,6.71,07-2018
Exercise and Gym Researchers,96.0,7.21,07-2018
Pandora Jewelry Shoppers,22403.0,12.27,07-2018
Bed & Bath Shoppers,40.0,10.86,07-2018
Dog Lovers,19758.0,6.28,07-2018
Luxury Department Store Shoppers,17730.0,11.38,07-2018
Costa Rica Trip Planners,5938.0,11.63,07-2018
Womens Fitness Enthusiasts,4869.0,6.47,07-2018
Parents of Teenagers Going to College,4897.0,12.93,07-2018
Indoor Cycling & Spinning Enthusiasts,6029.0,8.72,07-2018
Home Decor Shoppers,31.0,7.9,07-2018
Olympics Fans,16137.0,9.65,07-2018
Pet Store Goers,6330.0,6.82,07-2018
Supermarket Shoppers,6334.0,11.63,07-2018
Boston Trip Planners,6315.0,8.14,07-2018
Health & Fitness,4852.0,6.77,07-2018
NCAA Fans,16.0,6.24,07-2018
Beach House Second Home Owners,6108.0,6.65,07-2018
Preppy Clothing Shoppers,6206.0,10.76,07-2018
Breast Cancer Fund Raisers,6006.0,6.26,07-2018
Paleo Eaters,6228.0,10.22,07-2018
Beer Aficionados,20768.0,6.53,07-2018
Yogis,4902.0,8.17,07-2018
Harry Potter Fans,6277.0,11.72,07-2018
Natural Pet Food Shoppers,19757.0,10.95,07-2018
Dieters,4911.0,6.87,07-2018
Cholesterol Researchers,4910.0,6.09,07-2018
Competitive Tri-Athletes,6285.0,9.97,07-2018
Price Conscious Home Shoppers,11974.0,7.19,07-2018
Cycling Enthusiasts,6219.0,6.37,07-2018
Halloween Costume Shoppers,10250.0,11.4,07-2018
Realtors & Real Estate Researchers,6128.0,6.28,07-2018
Readers of Filipinos Content,5946.0,5.99,07-2018
Flight and Hotel Shoppers,158.0,7.46,07-2018
Pregnancy Resources Researchers,15935.0,9.13,07-2018
Entertainment & Tabloid Magazine Readers,4855.0,5.99,07-2018
Streaming Radio Listeners,149.0,6.88,07-2018
Financial Business Intelligence Researchers,16197.0,6.13,07-2018
NCAA Football Fans,11067.0,5.14,07-2018
Medical Advice Researchers,17674.0,6.25,07-2018
Womens Health Researchers,4913.0,6.76,07-2018
Discount Device Shoppers,56.0,7.09,07-2018
Pharmacy Shoppers,6341.0,5.68,07-2018
Philadelphia Trip Planners,6316.0,6.52,07-2018
Gourmet Food & Wine Researchers,18647.0,6.45,07-2018
TV Advertising Professionals,17803.0,6.21,07-2018
Techies,23.0,5.41,07-2018
Apple Fans,132.0,7.48,07-2018
Executive and C-Suite,6365.0,6.45,07-2018
Luggage Shoppers,6378.0,9.64,07-2018
Coffee Chain Shoppers,17673.0,8.07,07-2018
Home Kitchen Chefs,97.0,6.41,07-2018
Ecommerce Platform Researchers,7537.0,7.82,07-2018
Entertainment Industry Decision Makers,20764.0,5.85,07-2018
Home Buyers,44.0,6.11,07-2018
Brides & Wedding Planners,5.0,10.82,07-2018
Personal Stock Portfolio Managers,6227.0,6.07,07-2018
Eco-Conscious Consumers,19.0,6.57,07-2018
Young Boomers,93.0,7.08,07-2018
Discount Womens Shoes Shoppers,6085.0,7.08,07-2018
Olympic Sports Enthusiasts,6112.0,9.22,07-2018
TV Game Show Fans,4873.0,5.45,07-2018
Landscape Architects,11975.0,7.81,07-2018
Lacrosse Enthusiasts,22502.0,8.24,

2025-01-20 19:07:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-20 19:07:16 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:17 - root - INFO - SQL:
-- Query 6: Get top 10 composition values across all interest categories
SELECT im."interest_name", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
ORDER BY m."composition" DESC 
LIMIT 10
Results:
interest_name,composition,month_year
Work Comes First Travelers,21.2,12-2018
Work Comes First Travelers,20.28,10-2018
Work Comes First Travelers,19.45,11-2018
Work Comes First Travelers,18.99,01-2019
Gym Equipment Owners,18.82,07-2018
Work Comes First Travelers,18.39,02-2019
Work Comes First Travelers,18.18,09-2018
Furniture Shoppers,17.44,07-2018
Luxury Retail Shoppers,17.19,07-2018
Luxury Boutique Hotel Researchers,15.15,10-2018

2025-01-20 19:07:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-20 19:07:18 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:18 - root - INFO - SQL:
-- Query 7: Get bottom 10 composition values across all interest categories
SELECT im."interest_name", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
ORDER BY m."composition" ASC 
LIMIT 10
Results:
interest_name,composition,month_year
Mowing Equipment Shoppers,1.51,05-2019
Readers of Jamaican Content,1.52,08-2018
New York Giants Fans,1.52,06-2019
Philadelphia 76ers Fans,1.52,05-2019
Minnesota Vikings Fans,1.52,04-2019
Beer Aficionados,1.52,05-2019
United Nations Donors,1.52,04-2019
Disney Fans,1.52,06-2019
World of Warcraft Enthusiasts,1.52,03-2019
Gastrointestinal Researchers,1.52,05-2019

2025-01-20 19:07:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:20 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:20 - root - INFO - SQL:
-- Query 8: Count the number of records per interest_id
SELECT "interest_id", COUNT(*) AS "record_count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000
Results:
Too long, hard cut:
interest_id,record_count
32486.0,14
6106.0,13
18923.0,14
6344.0,10
100.0,14
6111.0,12
19422.0,12
6110.0,14
6217.0,14
171.0,14
19613.0,14
17.0,14
6.0,14
6013.0,14
4870.0,14
19423.0,14
6089.0,11
6286.0,14
19621.0,14
63.0,12
165.0,10
18351.0,12
,1193
17314.0,14
4914.0,14
6107.0,14
40.0,14
5938.0,14
16137.0,14
6330.0,11
6006.0,12
6228.0,12
4902.0,14
97.0,11
20764.0,6
5.0,14
19610.0,14
4940.0,14
10838.0,14
6255.0,14
69.0,13
79.0,14
4895.0,12
5991.0,14
114.0,10
96.0,14
19758.0,13
6029.0,14
6334.0,14
6315.0,14
6206.0,14
20768.0,14
4855.0,8
56.0,14
23.0,6
98.0,14
18646.0,12
6162.0,13
128.0,13
6308.0,14
148.0,8
18347.0,14
4910.0,14
32703.0,14
6214.0,12
4.0,14
6218.0,14
161.0,14
92.0,13
6184.0,14
6232.0,14
36.0,12
150.0,5
17730.0,14
4869.0,11
31.0,14
19757.0,14
4911.0,14
5946.0,10
6378.0,14
6172.0,13
169.0,11
6299.0,9
6304.0,14
6123.0,11
103.0,12
38.0,14
17786.0,14
15.0,14
115.0,14
22403.0,14
4852.0,12
6108.0,14
6219.0,14
10250.0,14
149.0,11
16197.0,11
11067.0,14
4913.0,12
6316.0,14
17803.0,10
44.0,14
19.0,10
4873.0,12
86.0,14
24.0,12
12133.0,14
6141.0,13
4943.0,14
18996.0,14
85.0,14
19587.0,11
135.0,14
19588.0,14
77.0,14
4944.0,14
111.0,14
151.0,14
7461.0,14
17785.0,14
6318.0,14
7605.0,14
12.0,14
70.0,14
19579.0,14
18490.0,14
147.0,14
6062.0,14
19760.0,9
6115.0,14
6265.0,14
18350.0,14
6148.0,14
6340.0,14
109.0,14
12027.0,14
18784.0,14
34.0,14
102.0,14
6323.0,14
5896.0,14
6301.0,14
22411.0,14
6321.0,14
62.0,13
6222.0,11
6341.0,11
17673.0,14
6112.0,14
20753.0,11
125.0,13
17269.0,14
6284.0,14
7557.0,14
117.0,14
33.0,14
17320.0,14
18202.0,14
10008.0,14
10976.0,14
21242.0,14
21293.0,14
6278.0,10
64.0,14
88.0,14
5921.0,14
21057.0,8
6133.0,14
22096.0,14
18622.0,14
19294.0,14
5963.0,14
10988.0,14
116.0,13
21061.0,8
5984.0,3
45.0,14
21058.0,8
4857.0,14
6024.0,14
157.0,14
143.0,14
14901.0,14
6320.0,14
19604.0,14
7536.0,14
16196.0,14
18203.0,13
38360.0,11
36864.0,11
37876.0,8
10954.0,1
133.0,2
11974.0,14
15935.0,11
18647.0,12
5968.0,14
5943.0,11
16.0,14
6277.0,14
6285.0,14
6128.0,14
17674.0,14
93.0,11
22502.0,14
20750.0,13
6087.0,11
104.0,10
39.0,14
5952.0,14
164.0,9
5989.0,10
138.0,13
12277.0,12
61.0,14
6211.0,14
5972.0,14
6023.0,14
5960.0,14
90.0,11
6144.0,14
49.0,14
75.0,14
18781.0,14
4848.0,12
5930.0,13
13496.0,14
4920.0,10
163.0,14
33191.0,14
5918.0,14
13421.0,14
12025.0,14
19297.0,14
10870.0,12
19606.0,13
170.0,13
6151.0,10
1.0,12
60.0,14
158.0,14
132.0,14
6365.0,13
7537.0,14
6227.0,13
6085.0,14
11975.0,14
13.0,13
89.0,14
37.0,14
6084.0,13
8.0,13
4909.0,14
6127.0,12
66.0,10
7453.0,13
6171.0,14
131.0,5
10839.0,6
67.0,14
4861.0,10
19630.0,14
5970.0,14
4907.0,13
20767.0,14
10837.0,14
130.0,14
27.0,14
19879.0,13
4915.0,13
6250.0,14
6237.0,14
6302.0,14
22425.0,13
6207.0,14
141.0,14
6181.0,9
6298.0,6
6145.0,10
22.0,13
4918.0,12
17671.0,13
5906.0,14
35.0,14
21292.0,14
19250.0,14
82.0,14
13498.0,14
4925.0,14
6319.0,14
10365.0,1
6366.0,14
4898.0,14
7425.0,14
16119.0,14
65.0,14
5898.0,14
6051.0,14
5901.0,14
4866.0,14
6095.0,14
6229.0,14
20814.0,14
4904.0,12
7527.0,14
20963.0,11
6221.0,12
6210.0,14
139.0,14
19603.0,14
126.0,14
5920.0,12
7529.0,14
41.0,14
10972.0,14
22424.0,11
19338.0,14
19578.0,14
6263.0,14
10980.0,14
6267.0,14
119.0,14
4859.0,14
155.0,14
12031.0,14
107.0,14
17318.0,14
21060.0,8
5961.0,14
18997.0,14
6142.0,14
87.0,14
22423.0,14
21236.0,14
21238.0,14
80.0,14
6208.0,14
23778.0,14
18204.0,14
19628.0,14
19590.0,14
22095.0,14
145.0,14
20815.0,9
6305.0,14
6328.0,14
30.0,14
4928.0,14
59.0,13
55.0,14
18619.0,14
6030.0,14
10284.0,14
6209.0,14
6169.0,14
142.0,13
6194.0,12
153.0,14
10832.0,14
6088.0,14
11065.0,14
22093.0,14
6393.0,14
50.0,14
20755.0,14
12821.0,14
14800.0,11
6300.0,14
10009.0,14
18807.0,14
32705.0,14
6335.0,14
108.0,14
6149.0,14
10364.0,13
6367.0,14
4903.0,14
110.0,14
20816.0,12
4867.0,13
20730.0,14
7546.0,14
18924.0,14
4908.0,14
19593.0,14
6230.0,14
6317.0,14
5936.0,14
18783.0,14
7597.0,11
7545.0,14
6345.0,14
17729.0,14
4906.0,11
10970.0,14
22401.0,13
10836.0,14
4933.0,11
6215.0,14
6156.0,13
5945.0,14
112.0,13
6339.0,14
6122.0,12
19594.0,11
4931.0,14
6034.0,12
22398.0,14
72.0,14
19609.0,13
6332.0,14
21248.0,10
58.0,10
10971.0,11
7598.0,11
19626.0,1
19631.0,14
6047.0,12
21244.0,10
34462.0,13
34082.0,13
34461.0,13
34077.0,13
34084.0,11
34079.0,10
34460.0,10
33534.0,1
21245.0,10
34651.0,9
34643.0,10
34647.0,10
34650.0,9
34638.0,11
34646.0,9
36343.0,8
37411.0,11
37423.0,11
37874.0,11
37420.0,11
36876.0,11
38355.0,11
37414.0,11
38362.0,11
38351.0,11
37887.0,11
37166.0,8
38365.0,9
37165.0,8
37878.0,10
37416.0,8
38358.0,8
38989.0,10
39190.0,8
39192.0,7
39770.0,8
39651.0,7
39199.0,7
39659.0,8
41854.0,9
41191.0,9
41192.0,9
42238.0,9
42237.0,9
41554.0,8
40692.0,9
40687.0,5
40427.0,6
40694.0,3
42964.0,8
44470.0,7
44476.0,7
44479.0,7
44456.0,7
45524.0,6
44379.0,6
45669.0,6
45668.0,4
46567.0,2
49979.0,5
10011.0,1
22427.0,14
16138.0,14
18621.0,14
6329.0,14
6076.0,13
5914.0,14
6337.0,14
10977.0,14
12132.0,14
5911.0,14
6260.0,2
4917.0,12
5907.0,14
4924.0,14
95.0,14
5942.0,12
10978.0,14
19627.0,13
83.0,14
17672.0,14
6234.0,14

2025-01-20 19:07:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-20 19:07:21 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:22 - root - INFO - SQL:
-- Query 9: Get all unique month-year combinations
SELECT DISTINCT "month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000
Results:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019

2025-01-20 19:07:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:23 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:24 - root - INFO - SQL:
-- Query 10: List all interest names from INTEREST_MAP
SELECT "id", "interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" 
LIMIT 1000
Results:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
110,Pain Management Researchers
111,Retirement Planners
112,Auto Repair Researchers
113,Avid Readers
114,Womens Fashion Magazine Readers
115,Mens Shoe Shoppers
116,Home Security Shoppers
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
121,Coders & Developers
123,Military Servicemembers & Veterans
124,Healthcare Discount Shoppers
125,Postal Employees
126,Soccer Fans
128,Kitchen & Bathroom Remodelers
129,Aftermarket Accessories Shoppers
130,Automotive Safety Researchers
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
134,Home Printer Shoppers
135,Major Appliance Shoppers
136,Tablet Researchers
137,Online Alcohol Shoppers
138,Home Kitchen Bakers
139,Makeup Researchers
140,Pet Owners
141,Skin Care Researchers
142,Credit Card Researchers
143,Health Insurance Researchers
145,Property Insurance Researchers
146,Audio Equipment Researchers
147,Broadway Fans
148,Celebrity Gossip Fans
149,Streaming Radio Listeners
150,TV Junkies
151,Big & Tall Men
153,Phone Accessory Shoppers
154,Prepaid Smartphone Shoppers
155,Business Travelers
157,Car Rental Shoppers
158,Flight and Hotel Shoppers
160,Sightseeing Travelers
161,Travel Reward Points Enthusiasts
162,Retirees
163,Federal Employees
164,Conservative News Readers
165,Liberal News Readers
166,Doves
168,Social Conservatives
169,Social Liberals
170,Voters
171,Shoe Shoppers
4847,Readers of Hispanic Content
4848,Working Parents
4852,Health & Fitness
4855,Entertainment & Tabloid Magazine Readers
4857,Business Accounting Software Researchers
4858,Business Filing Researchers
4859,Business Logistics Managers
4861,IT Decision Makers
4866,Small Business Employees
4867,Sweepstakes Enthusiasts
4869,Womens Fitness Enthusiasts
4870,Tech-Savvy Moms
4872,Readers of Mexican Content
4873,TV Game Show Fans
4894,Credit Union Researchers
4895,Mature Parents
4896,Streaming Music Enthusiasts
4897,Parents of Teenagers Going to College
4898,Cosmetics and Beauty Shoppers
4899,Readers of Japanese Content
4902,Yogis
4903,Asthma Sufferers
4904,Adult Acne Sufferers
4905,Heartburn Sufferers
4906,Sinus Researchers
4907,Headache and Migraine Sufferers
4908,Back Pain Sufferers
4909,First Aid Researchers
4910,Cholesterol Researchers
4911,Dieters
4912,Vitamin Shoppers
4913,Womens Health Researchers
4914,Mens Health Researchers
4915,Food Allergies Researchers
4916,Arthritis Sufferers
4917,Teen Content Readers
4918,Gastrointestinal Researchers
4919,Military Families
4920,LGBT Activists
4921,Tire Shoppers
4924,Surfers
4925,Gun Control Advocates
4926,Gun Rights Advocates
4927,Immigration Rights Advocates
4928,Immigration Control Advocates
4929,Right Wing Radicals
4930,Occupy Movement Supporters
4931,Marijua

2025-01-20 19:07:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:25 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:25 - root - INFO - SQL:
-- Query 11: Get average composition value per interest_id
SELECT "interest_id", AVG("composition") AS "avg_composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000
Results:
Too long, hard cut:
interest_id,avg_composition
32486.0,5.0249999999999995
6106.0,2.9676923076923076
18923.0,3.807142857142857
6344.0,2.9829999999999997
100.0,3.2728571428571427
69.0,3.281538461538461
79.0,3.957142857142857
6214.0,4.875
19422.0,4.9575000000000005
6110.0,4.651428571428572
6123.0,2.752727272727273
171.0,6.344285714285713
19613.0,4.900714285714286
6.0,8.330714285714285
6013.0,4.616428571428571
19423.0,4.965714285714285
6089.0,2.612727272727273
5991.0,3.6592857142857143
63.0,4.615833333333334
103.0,2.6733333333333333
6232.0,4.771428571428571
,3.937384744341995
6151.0,2.925
4914.0,3.0421428571428573
133.0,7.605
6107.0,4.337857142857143
150.0,2.6
60.0,4.938571428571429
40.0,3.9664285714285716
19758.0,2.573076923076923
4897.0,6.028571428571429
4911.0,3.2399999999999998
132.0,3.3192857142857144
6227.0,4.179230769230769
19.0,2.664
19610.0,3.470714285714286
20750.0,2.4884615384615385
18996.0,4.4314285714285715
39.0,9.507857142857144
19298.0,9.51142857142857
22427.0,4.077142857142857
5989.0,2.349
6304.0,4.708571428571429
18490.0,3.2935714285714286
161.0,3.6042857142857145
1.0,3.0524999999999998
96.0,2.9114285714285715
22403.0,5.434285714285714
20768.0,2.6107142857142853
19757.0,5.588571428571428
4910.0,2.4528571428571433
10250.0,7.578571428571429
4855.0,2.42625
169.0,2.407272727272727
164.0,2.4844444444444442
19587.0,2.4054545454545457
18202.0,5.967142857142858
21293.0,3.587857142857143
6143.0,3.267857142857143
22096.0,3.0207142857142855
6260.0,3.55
20764.0,2.605
16119.0,3.9385714285714286
160.0,4.027857142857143
4895.0,4.496666666666667
6217.0,5.1414285714285715
6218.0,4.442142857142857
92.0,3.123076923076923
165.0,2.423
18351.0,2.5033333333333334
115.0,6.9192857142857145
6029.0,6.303571428571429
16137.0,4.940714285714286
6334.0,3.9042857142857144
4852.0,2.975
6219.0,4.097857142857142
7537.0,3.7621428571428575
86.0,2.5207142857142855
4943.0,7.461428571428572
20731.0,2.3722222222222222
5972.0,4.517857142857143
6111.0,5.181666666666667
4870.0,3.3085714285714287
6184.0,5.425
38.0,4.864285714285714
17314.0,3.29
5968.0,5.8149999999999995
36.0,4.4975
4869.0,2.5745454545454547
31.0,4.242142857142857
6315.0,3.220714285714286
16.0,3.65
6108.0,2.9585714285714286
6206.0,6.723571428571428
4902.0,3.7464285714285714
6277.0,4.3549999999999995
6285.0,6.445
6128.0,2.858571428571429
158.0,7.320714285714286
56.0,3.545714285714286
6316.0,2.5949999999999998
17803.0,2.456
6365.0,2.5999999999999996
97.0,2.7636363636363637
6085.0,3.39
98.0,3.672857142857143
125.0,4.303076923076923
101.0,3.7821428571428575
6087.0,2.826363636363636
37.0,3.842142857142857
12277.0,2.5433333333333334
4944.0,6.75
10008.0,5.562857142857142
10838.0,2.6164285714285715
66.0,2.585
151.0,5.405714285714285
128.0,2.9661538461538464
17785.0,4.978571428571429
6318.0,2.670714285714286
5960.0,7.62
18621.0,3.2707142857142855
19630.0,3.0828571428571427
6076.0,2.6223076923076927
20767.0,3.6900000000000004
147.0,3.8328571428571427
130.0,3.3242857142857143
5914.0,2.5100000000000002
6250.0,3.3049999999999997
5930.0,2.4538461538461536
4920.0,2.3920000000000003
22425.0,2.721538461538462
6340.0,4.277857142857143
19294.0,3.7721428571428572
5901.0,3.245
34.0,7.39
14.0,2.1966666666666668
5913.0,4.0564285714285715
6142.0,4.410714285714286
6164.0,2.312727272727273
21238.0,3.8485714285714288
55.0,4.76
168.0,2.408333333333333
22406.0,1.987142857142857
19621.0,7.999285714285714
114.0,2.3259999999999996
6006.0,2.6341666666666668
11974.0,3.507142857142857
18647.0,2.8991666666666664
23.0,2.435
6378.0,5.212142857142857
22502.0,5.928571428571429
6172.0,4.059230769230769
5969.0,11.093571428571428
117.0,2.5907142857142857
6171.0,3.920714285714286
4905.0,4.235833333333333
12.0,3.1735714285714285
5921.0,3.233571428571429
15877.0,2.467142857142857
6237.0,5.359285714285714
10977.0,8.622142857142858
35.0,3.2950000000000004
163.0,2.7035714285714287
6319.0,4.036428571428571
10365.0,5.21
5999.0,5.14
5898.0,3.715
6220.0,3.9185714285714286
5918.0,3.287857142857143
7527.0,3.8835714285714285
19603.0,4.012142857142857
22413.0,2.6738461538461538
21237.0,6.857142857142857
43.0,3.1757142857142857
32703.0,4.466428571428572
18997.0,3.82
18352.0,3.86
23778.0,3.940714285714286
18204.0,4.510714285714285
22095.0,2.712142857142857
6301.0,3.6585714285714284
6067.0,2.9364285714285714
20756.0,2.428
5916.0,3.9892857142857143
81.0,2.1408333333333336
4937.0,2.6464285714285714
5967.0,2.82
4931.0,2.5892857142857144
6138.0,2.0963636363636367
6225.0,2.216666666666667
15.0,2.8021428571428575
5938.0,4.667857142857143
7557.0,3.823571428571429
4.0,6.172857142857143
17.0,3.190714285714286
6286.0,9.36357142857143
5943.0,2.5500000000000003
17730.0,5.515
6228.0,3.2808333333333337
15935.0,2.852727272727273
16197.0,2.463636363636364
17673.0,3.9050000000000002
44.0,3.205714285714286
11975.0,3.5892857142857144
12133.0,10.433571428571428
13.0,2.626923076923077
6284.0,10.486428571428572
135.0,3.3721428571428573
19588.0,2.462142857142857
18648.0,3.259230769230769
6127.0,2.6308333333333334
6211.0,3.3278571428571424
21242.0,4.784285714285715
16138.0,

2025-01-20 19:07:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-20 19:07:27 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:27 - root - INFO - SQL:
-- Query 12: Get composition and percentile ranking for interest_id = 1
SELECT "month_year", "composition", "percentile_ranking"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "interest_id" = 1 
ORDER BY "month_year" 
LIMIT 1000
Results:
month_year,composition,percentile_ranking
01-2019,2.38,81.81
02-2019,2.55,55.84
03-2019,2.76,78.52
04-2019,2.28,75.16
05-2019,1.68,56.01
07-2018,7.02,93.69
08-2018,3.44,85.53
08-2019,2.64,65.71
09-2018,2.44,74.1
10-2018,3.71,86.23
11-2018,2.79,86.64
12-2018,2.94,85.93

2025-01-20 19:07:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:28 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:29 - root - INFO - SQL:
-- Query 13: Find months with highest composition values for each interest_id
SELECT "interest_id", "month_year", "composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "composition" = (
  SELECT MAX("composition") 
  FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS sub 
  WHERE sub."interest_id" = "INTEREST_METRICS"."interest_id"
)
LIMIT 1000
Results:
Too long, hard cut:
interest_id,month_year,composition
32486.0,07-2018,11.89
6106.0,07-2018,9.93
18923.0,07-2018,10.85
6344.0,07-2018,10.32
100.0,07-2018,10.77
69.0,07-2018,10.82
79.0,07-2018,11.21
6111.0,07-2018,10.71
6214.0,07-2018,9.71
19422.0,07-2018,10.11
6110.0,07-2018,11.57
4895.0,07-2018,9.47
6217.0,07-2018,10.8
4.0,07-2018,13.97
6218.0,07-2018,9.29
6123.0,07-2018,9.49
171.0,07-2018,14.91
19613.0,07-2018,12.62
17.0,07-2018,7.89
6013.0,07-2018,9.35
4870.0,07-2018,10.29
19423.0,07-2018,12.22
6089.0,07-2018,6.97
161.0,07-2018,11.48
6286.0,07-2018,14.1
5991.0,07-2018,11.04
92.0,07-2018,9.77
6184.0,07-2018,13.35
19621.0,07-2018,11.61
63.0,07-2018,9.37
103.0,07-2018,6.61
38.0,07-2018,9.48
17786.0,07-2018,13.67
6232.0,07-2018,9.97
165.0,07-2018,6.05
18351.0,07-2018,6.09
15.0,07-2018,6.9
17314.0,07-2018,10.43
6151.0,07-2018,6.83
4914.0,07-2018,7.42
115.0,07-2018,11.68
5968.0,07-2018,12.87
36.0,07-2018,9.27
5943.0,07-2018,6.37
133.0,07-2018,10.91
1.0,07-2018,7.02
114.0,07-2018,6.25
6107.0,07-2018,8.84
150.0,07-2018,5.3
96.0,07-2018,7.21
22403.0,07-2018,12.27
40.0,07-2018,10.86
19758.0,07-2018,6.28
17730.0,07-2018,11.38
5938.0,07-2018,11.63
4869.0,07-2018,6.47
4897.0,07-2018,12.93
31.0,07-2018,7.9
16137.0,07-2018,9.65
6330.0,07-2018,6.82
6334.0,07-2018,11.63
6315.0,07-2018,8.14
4852.0,07-2018,6.77
16.0,07-2018,6.24
6108.0,07-2018,6.65
6206.0,07-2018,10.76
6006.0,07-2018,6.26
6228.0,07-2018,10.22
20768.0,07-2018,6.53
4902.0,07-2018,8.17
6277.0,07-2018,11.72
19757.0,07-2018,10.95
4911.0,07-2018,6.87
4910.0,07-2018,6.09
6285.0,07-2018,9.97
11974.0,07-2018,7.19
6219.0,07-2018,6.37
10250.0,07-2018,11.4
6128.0,07-2018,6.28
5946.0,07-2018,5.99
15935.0,07-2018,9.13
4855.0,07-2018,5.99
149.0,07-2018,6.88
16197.0,07-2018,6.13
4913.0,07-2018,6.76
56.0,07-2018,7.09
6341.0,07-2018,5.68
6316.0,07-2018,6.52
18647.0,07-2018,6.45
17803.0,07-2018,6.21
23.0,07-2018,5.41
132.0,07-2018,7.48
6365.0,07-2018,6.45
6378.0,07-2018,9.64
17673.0,07-2018,8.07
97.0,07-2018,6.41
7537.0,07-2018,7.82
20764.0,07-2018,5.85
44.0,07-2018,6.11
5.0,07-2018,10.82
19.0,07-2018,6.57
93.0,07-2018,7.08
6085.0,07-2018,7.08
6112.0,07-2018,9.22
11975.0,07-2018,7.81
22502.0,07-2018,8.24
86.0,07-2018,6.13
19610.0,07-2018,7.56
20753.0,07-2018,5.79
24.0,07-2018,6.54
20750.0,07-2018,5.87
6141.0,07-2018,6.34
98.0,07-2018,7.64
125.0,07-2018,6.38
17269.0,07-2018,8.64
18996.0,07-2018,7.84
13.0,07-2018,6.72
169.0,07-2018,6.1
101.0,07-2018,7.38
6087.0,07-2018,5.41
104.0,07-2018,5.42
6284.0,07-2018,18.82
7557.0,07-2018,8.17
37.0,07-2018,7.82
6084.0,07-2018,6.97
8.0,07-2018,6.67
39.0,07-2018,17.44
117.0,07-2018,6.49
22427.0,07-2018,8.04
85.0,07-2018,6.46
5952.0,07-2018,7.11
164.0,07-2018,6.14
19587.0,07-2018,5.85
33.0,07-2018,7.6
135.0,07-2018,7.01
19588.0,07-2018,5.87
17320.0,07-2018,3.98
77.0,07-2018,17.19
18648.0,07-2018,7.1
5989.0,07-2018,5.57
138.0,07-2018,7.3
137.0,07-2018,7.94
4940.0,07-2018,5.89
12277.0,07-2018,6.2
4909.0,07-2018,7.01
10008.0,07-2018,9.46
6299.0,07-2018,5.71
20731.0,07-2018,5.86
10838.0,07-2018,6.8
111.0,07-2018,7.42
6127.0,07-2018,5.96
6304.0,07-2018,8.31
61.0,07-2018,6.59
6211.0,07-2018,8.09
66.0,07-2018,6.51
6182.0,07-2018,6.57
151.0,07-2018,7.97
3.0,07-2018,6.14
10976.0,07-2018,8.16
18646.0,07-2018,6.85
21242.0,07-2018,7.36
7453.0,07-2018,6.45
6162.0,07-2018,6.32
128.0,07-2018,6.5
6171.0,07-2018,8.19
131.0,07-2018,5.09
21293.0,07-2018,7.28
7461.0,07-2018,7.0
17785.0,07-2018,7.66
10839.0,07-2018,5.59
4912.0,07-2018,7.77
6318.0,07-2018,6.65
7605.0,07-2018,6.82
4905.0,07-2018,5.66
6023.0,07-2018,8.02
16138.0,07-2018,8.81
18621.0,07-2018,7.31
4861.0,07-2018,5.29
12.0,07-2018,7.23
90.0,07-2018,5.91
19630.0,07-2018,7.15
6278.0,07-2018,6.18
70.0,07-2018,6.96
19579.0,07-2018,6.24
6329.0,07-2018,7.63
5970.0,07-2018,9.21
4907.0,07-2018,6.26
6076.0,07-2018,5.75
18490.0,07-2018,7.09
20767.0,07-2018,7.73
147.0,07-2018,6.17
10837.0,07-2018,7.48
130.0,07-2018,7.66
5914.0,07-2018,6.4
6144.0,07-2018,6.61
88.0,07-2018,4.99
6255.0,07-2018,7.55
27.0,07-2018,6.81
6336.0,07-2018,8.5
5921.0,07-2018,7.37
19879.0,07-2018,6.95
15877.0,07-2018,5.77
148.0,07-2018,5.49
32704.0,07-2018,8.04
6062.0,07-2018,7.33
4915.0,07-2018,6.28
6133.0,07-2018,3.82
6250.0,07-2018,5.54
6143.0,07-2018,5.47
49.0,07-2018,5.09
6173.0,07-2018,7.66
75.0,07-2018,7.23
19614.0,07-2018,5.57
18781.0,07-2018,6.56
4848.0,07-2018,6.49
6237.0,07-2018,7.7
19760.0,07-2018,5.36
5930.0,07-2018,6.17
6302.0,07-2018,7.41
13496.0,07-2018,6.78
4920.0,07-2018,5.93
6115.0,07-2018,6.67
22425.0,07-2018,6.41
73.0,07-2018,7.06
22096.0,07-2018,6.56
6337.0,07-2018,7.02
6265.0,07-2018,7.31
19295.0,07-2018,8.44
18347.0,07-2018,7.8
6207.0,07-2018,7.81
18350.0,07-2018,6.85
6064.0,07-2018,7.02
18622.0,07-2018,7.44
6181.0,07-2018,6.11
6148.0,07-2018,7.13
6045.0,07-2018,7.42
6298.0,07-2018,5.38
6145.0,07-2018,6.1
22.0,07-2018,6.26
12132.0,07-2018,7.12
4918.0,07-2018,6.29
17671.0,07-2018,5.65
5906.0,07-2018,7.69
35.0,07-2018,5.25
6340.0,07-2018,7.44
21292.0,07-2018,7.19
19294.0,07-2018,7.22
163.0,07-2018,6.4
82.0,07-2018,9.99
13498.0,07-2018,6.4

2025-01-20 19:07:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 19:07:30 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:07:45 - root - INFO - ```sql
SELECT "interest_id", "month_year", "composition"
FROM (
    SELECT "interest_id", "month_year", "composition",
        RANK() OVER (PARTITION BY "interest_id" ORDER BY "composition" DESC) AS comp_rank
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS"
) sub
WHERE comp_rank = 1
LIMIT 1000;
```
2025-01-20 19:07:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:07:46 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:08:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:08:42 - root - INFO - SQL:
SELECT "interest_id", "month_year", "composition"
FROM (
    SELECT "interest_id", "month_year", "composition",
        RANK() OVER (PARTITION BY "interest_id" ORDER BY "composition" DESC) AS comp_rank
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS"
) sub
WHERE comp_rank = 1
LIMIT 1000;
Results:
Too long, hard cut:
interest_id,month_year,composition
6345.0,07-2018,3.94
39642.0,08-2019,2.99
38992.0,02-2019,4.55
43547.0,02-2019,2.79
18807.0,07-2018,4.1
19578.0,07-2018,4.14
6006.0,07-2018,6.26
4917.0,07-2018,6.1
45669.0,08-2019,2.56
142.0,07-2018,4.73
7483.0,07-2018,3.4
7546.0,07-2018,4.72
46134.0,03-2019,3.09
153.0,07-2018,5.08
10351.0,08-2018,5.87
5926.0,10-2018,4.3
12821.0,08-2018,5.18
42399.0,03-2019,2.27
40434.0,02-2019,3.48
6215.0,10-2018,3.81
6145.0,07-2018,6.1
6389.0,07-2018,3.39
44491.0,02-2019,2.8
51678.0,08-2019,2.26
6210.0,07-2018,6.09
170.0,07-2018,4.76
34639.0,08-2019,2.49
44449.0,02-2019,2.68
5960.0,10-2018,10.61
7543.0,07-2018,4.12
147.0,07-2018,6.17
22093.0,07-2018,4.34
43546.0,02-2019,3.5
18997.0,10-2018,6.05
6010.0,07-2018,2.76
83.0,10-2018,4.64
20816.0,07-2018,2.79
18621.0,07-2018,7.31
6051.0,07-2018,5.31
4859.0,07-2018,6.48
13421.0,07-2018,7.15
51120.0,08-2019,3.45
39652.0,02-2019,3.33
5907.0,07-2018,7.12
95.0,07-2018,7.15
5910.0,07-2018,5.22
5910.0,10-2018,5.22
4943.0,10-2018,10.7
37.0,07-2018,7.82
41853.0,02-2019,2.95
39648.0,08-2019,2.97
6303.0,10-2018,7.13
6081.0,07-2018,5.92
4872.0,10-2018,2.61
64.0,12-2018,12.41
46132.0,03-2019,2.57
37165.0,03-2019,2.65
7535.0,02-2019,7.4
80.0,07-2018,4.47
44390.0,08-2019,2.61
17730.0,07-2018,11.38
45662.0,02-2019,3.66
51.0,07-2018,2.67
74.0,07-2018,7.37
34951.0,09-2018,1.61
37412.0,10-2018,1.94
7541.0,02-2019,9.98
43540.0,02-2019,3.08
19622.0,07-2018,2.97
6183.0,07-2018,6.71
49502.0,08-2019,2.71
19628.0,07-2018,4.66
41062.0,08-2019,2.54
4906.0,07-2018,3.09
6141.0,07-2018,6.34
44378.0,03-2019,3.67
6.0,10-2018,12.56
6156.0,07-2018,2.99
85.0,07-2018,6.46
116.0,07-2018,6.31
135.0,07-2018,7.01
92.0,07-2018,9.77
39195.0,12-2018,2.35
44479.0,02-2019,3.5
12032.0,07-2018,3.77
24.0,07-2018,6.54
40194.0,08-2019,2.48
48022.0,08-2019,2.16
38991.0,02-2019,3.12
6250.0,07-2018,5.54
10974.0,11-2018,5.5
6285.0,07-2018,9.97
37879.0,10-2018,4.25
37423.0,10-2018,6.7
97.0,07-2018,6.41
125.0,07-2018,6.38
148.0,07-2018,5.49
4930.0,07-2018,4.37
18351.0,07-2018,6.09
45673.0,08-2019,3.54
133.0,07-2018,10.91
36871.0,10-2018,3.73
56.0,07-2018,7.09
5906.0,07-2018,7.69
6084.0,07-2018,6.97
6164.0,07-2018,5.37
41079.0,02-2019,3.15
7464.0,07-2018,3.52
6134.0,07-2018,5.08
20755.0,07-2018,4.77
40183.0,12-2018,5.06
44386.0,02-2019,2.56
44386.0,08-2019,2.56
7557.0,07-2018,8.17
41054.0,08-2019,2.95
41194.0,08-2019,2.33
17669.0,08-2018,4.09
39330.0,08-2019,2.58
19618.0,08-2018,3.13
46566.0,03-2019,2.79
7540.0,03-2019,7.8
6265.0,07-2018,7.31
108.0,07-2018,4.24
36883.0,02-2019,3.27
19624.0,10-2018,3.15
40694.0,02-2019,2.06
10010.0,08-2019,3.26
138.0,07-2018,7.3
6064.0,07-2018,7.02
21243.0,10-2018,3.67
44584.0,02-2019,3.26
16138.0,07-2018,8.81
49978.0,08-2019,2.63
40692.0,03-2019,3.08
44485.0,02-2019,2.59
17.0,07-2018,7.89
44478.0,02-2019,3.67
6133.0,07-2018,3.82
102.0,07-2018,7.74
53.0,07-2018,3.03
4896.0,08-2018,3.47
37883.0,11-2018,4.19
35.0,07-2018,5.25
4916.0,07-2018,4.29
44467.0,08-2019,2.4
33191.0,10-2018,4.39
6237.0,07-2018,7.7
6277.0,07-2018,11.72
45677.0,02-2019,4.52
4935.0,07-2018,4.46
39658.0,03-2019,2.99
49975.0,08-2019,2.83
19632.0,08-2019,2.22
19617.0,02-2019,8.09
40698.0,03-2019,3.57
37419.0,10-2018,3.7
104.0,07-2018,5.42
19599.0,03-2019,1.97
34461.0,02-2019,3.52
22425.0,07-2018,6.41
38995.0,12-2018,5.59
49974.0,08-2019,2.76
6220.0,07-2018,7.59
10251.0,07-2018,3.21
6048.0,07-2018,2.49
33970.0,08-2019,2.47
18783.0,10-2018,9.83
10326.0,10-2018,6.45
40688.0,12-2018,3.19
6098.0,07-2018,3.99
44472.0,03-2019,3.26
6255.0,07-2018,7.55
19759.0,07-2018,3.23
17269.0,07-2018,8.64
126.0,10-2018,6.67
41055.0,02-2019,3.91
5945.0,07-2018,4.87
5946.0,07-2018,5.99
42401.0,08-2019,1.66
40687.0,08-2019,2.25
6149.0,07-2018,4.1
22424.0,07-2018,6.05
41059.0,08-2019,2.59
45670.0,02-2019,5.04
15877.0,07-2018,5.77
19.0,07-2018,6.57
86.0,07-2018,6.13
6315.0,07-2018,8.14
41.0,07-2018,6.96
21238.0,10-2018,5.15
40702.0,08-2019,2.61
12820.0,10-2018,6.26
10007.0,07-2018,2.45
22406.0,07-2018,3.38
6189.0,07-2018,3.03
6214.0,07-2018,9.71
18646.0,07-2018,6.85
3.0,07-2018,6.14
6364.0,08-2018,3.09
33474.0,08-2018,4.01
22398.0,07-2018,3.52
41066.0,02-2019,2.83
34077.0,08-2018,4.52
128.0,07-2018,6.5
10249.0,07-2018,4.48
41065.0,02-2019,2.87
6122.0,11-2018,3.05
7461.0,07-2018,7.0
20750.0,07-2018,5.87
42237.0,03-2019,3.02
42237.0,08-2019,3.02
36860.0,10-2018,5.17
18350.0,07-2018,6.85
44483.0,02-2019,2.29
40192.0,11-2018,3.04
40192.0,03-2019,3.04
40192.0,08-2019,3.04
36881.0,10-2018,2.33
6089.0,07-2018,6.97
19758.0,07-2018,6.28
39190.0,11-2018,2.54
21326.0,07-2018,4.3
34081.0,08-2019,2.48
22401.0,07-2018,3.62
7536.0,02-2019,5.84
6229.0,07-2018,7.2
6173.0,07-2018,7.66
5925.0,10-2018,7.67
41083.0,03-2019,3.57
4869.0,07-2018,6.47
39193.0,02-2019,3.5
6112.0,07-2018,9.22
44384.0,02-2019,2.55
36020.0,10-2018,5.83
5971.0,10-2018,2.58
6259.0,07-2018,2.51
34465.0,08-2018,3.34
139.0,07-2018,6.87
39331.0,08-2019,2.69
33958.0,08-2018,1.88
44468.0,02-2019,4.02
141.0,10-2018,9.46
4940.0,07-2018,5.89
12025.0,07-2018,8.45
23778.0,08-2018,5.52
1

2025-01-20 19:08:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:08:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:08:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:08:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:08:44 - snowflake.connector.connection - INFO - closed
2025-01-20 19:08:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:08:44 - root - INFO - SQL:
-- Corrected Query 15: List interest categories with their summaries
SELECT "id", "interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP"
LIMIT 1000
Results:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
110,Pain Management Researchers
111,Retirement Planners
112,Auto Repair Researchers
113,Avid Readers
114,Womens Fashion Magazine Readers
115,Mens Shoe Shoppers
116,Home Security Shoppers
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
121,Coders & Developers
123,Military Servicemembers & Veterans
124,Healthcare Discount Shoppers
125,Postal Employees
126,Soccer Fans
128,Kitchen & Bathroom Remodelers
129,Aftermarket Accessories Shoppers
130,Automotive Safety Researchers
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
134,Home Printer Shoppers
135,Major Appliance Shoppers
136,Tablet Researchers
137,Online Alcohol Shoppers
138,Home Kitchen Bakers
139,Makeup Researchers
140,Pet Owners
141,Skin Care Researchers
142,Credit Card Researchers
143,Health Insurance Researchers
145,Property Insurance Researchers
146,Audio Equipment Researchers
147,Broadway Fans
148,Celebrity Gossip Fans
149,Streaming Radio Listeners
150,TV Junkies
151,Big & Tall Men
153,Phone Accessory Shoppers
154,Prepaid Smartphone Shoppers
155,Business Travelers
157,Car Rental Shoppers
158,Flight and Hotel Shoppers
160,Sightseeing Travelers
161,Travel Reward Points Enthusiasts
162,Retirees
163,Federal Employees
164,Conservative News Readers
165,Liberal News Readers
166,Doves
168,Social Conservatives
169,Social Liberals
170,Voters
171,Shoe Shoppers
4847,Readers of Hispanic Content
4848,Working Parents
4852,Health & Fitness
4855,Entertainment & Tabloid Magazine Readers
4857,Business Accounting Software Researchers
4858,Business Filing Researchers
4859,Business Logistics Managers
4861,IT Decision Makers
4866,Small Business Employees
4867,Sweepstakes Enthusiasts
4869,Womens Fitness Enthusiasts
4870,Tech-Savvy Moms
4872,Readers of Mexican Content
4873,TV Game Show Fans
4894,Credit Union Researchers
4895,Mature Parents
4896,Streaming Music Enthusiasts
4897,Parents of Teenagers Going to College
4898,Cosmetics and Beauty Shoppers
4899,Readers of Japanese Content
4902,Yogis
4903,Asthma Sufferers
4904,Adult Acne Sufferers
4905,Heartburn Sufferers
4906,Sinus Researchers
4907,Headache and Migraine Sufferers
4908,Back Pain Sufferers
4909,First Aid Researchers
4910,Cholesterol Researchers
4911,Dieters
4912,Vitamin Shoppers
4913,Womens Health Researchers
4914,Mens Health Researchers
4915,Food Allergies Researchers
4916,Arthritis Sufferers
4917,Teen Content Readers
4918,Gastrointestinal Researchers
4919,Military Families
4920,LGBT Activists
4921,Tire Shoppers
4924,Surfers
4925,Gun Control Advocates
4926,Gun Rights Advocates
4927,Immigration Rights Advocates
4928,Immigration Control Advocates
4929,Right Wing Radicals
4930,Occupy Movement Supporters
4931,Marijua

2025-01-20 19:08:44 - root - INFO - itercount: 0
2025-01-20 19:08:44 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table: INTEREST_METRICS**

   - `"interest_id"`: Potential usage - Used to identify the interest category.
   - `"composition"`: Potential usage - Composition values for each interest category.
   - `"month_year"`: Potential usage - Time in 'MM-YYYY' format.
   - `"_month"`: Potential usage - Month number.
   - `"_year"`: Potential usage - Year.

2. **Table: INTEREST_MAP**

   - `"id"`: Potential usage - Corresponds to `"interest_id"` in `INTEREST_METRICS`.
   - `"interest_name"`: Potential usage - Name of the interest category.
   - `"interest_summary"`: Potential usage - Summary of the interest category.

**Conditions that may be used:**

- Join `INTEREST_METRICS` and `INTEREST_MAP` on `INTEREST_METRICS"."interest_id" = INTEREST_MAP"."id"`.
- Filter to find the highest composition value per interest category.
- Order by `"composition"` to identify top 10 and bottom 10 interest categories.

**SQL Queries:**

```sql
-- Query 1: Select all data from INTEREST_METRICS
SELECT * 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000;

-- Query 2: Get distinct interest IDs from INTEREST_METRICS
SELECT DISTINCT "interest_id" 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000;

-- Query 3: Get composition values over time for interest_id = 1
SELECT "month_year", "composition" 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "interest_id" = 1 
LIMIT 1000;

-- Query 4: Get maximum composition value for each interest_id
SELECT "interest_id", MAX("composition") AS "max_composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000;

-- Query 5: Join INTEREST_METRICS and INTEREST_MAP to get interest names
SELECT im."interest_name", m."interest_id", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
LIMIT 1000;

-- Query 6: Get top 10 composition values across all interest categories
SELECT im."interest_name", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
ORDER BY m."composition" DESC 
LIMIT 10;

-- Query 7: Get bottom 10 composition values across all interest categories
SELECT im."interest_name", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
ORDER BY m."composition" ASC 
LIMIT 10;

-- Query 8: Count the number of records per interest_id
SELECT "interest_id", COUNT(*) AS "record_count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000;

-- Query 9: Get all unique month-year combinations
SELECT DISTINCT "month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000;

-- Query 10: List all interest names from INTEREST_MAP
SELECT "id", "interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" 
LIMIT 1000;

-- Query 11: Get average composition value per interest_id
SELECT "interest_id", AVG("composition") AS "avg_composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000;

-- Query 12: Get composition and percentile ranking for interest_id = 1
SELECT "month_year", "composition", "percentile_ranking"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "interest_id" = 1 
ORDER BY "month_year" 
LIMIT 1000;

-- Query 13: Find months with highest composition values for each interest_id
SELECT "interest_id", "month_year", "composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "composition" = (
  SELECT MAX("composition") 
  FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS sub 
  WHERE sub."interest_id" = "INTEREST_METRICS"."interest_id"
)
LIMIT 1000;

-- Query 14: Get records where composition is greater than 90
SELECT "interest_id", "composition", "month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "composition" > 90 
LIMIT 1000;

-- Query 15: List interest categories with their summaries
SELECT "interest_name", "interest_summary"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" 
LIMIT 1000;
```Query:
-- Query 1: Select all data from INTEREST_METRICS
SELECT * 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000
Answer:
Too long, hard cut:
_month,_year,month_year,interest_id,composition,index_value,ranking,percentile_ranking
7.0,2018.0,07-2018,32486.0,11.89,6.19,1,99.86
7.0,2018.0,07-2018,6106.0,9.93,5.31,2,99.73
7.0,2018.0,07-2018,18923.0,10.85,5.29,3,99.59
7.0,2018.0,07-2018,6344.0,10.32,5.1,4,99.45
7.0,2018.0,07-2018,100.0,10.77,5.04,5,99.31
7.0,2018.0,07-2018,69.0,10.82,5.03,6,99.18
7.0,2018.0,07-2018,79.0,11.21,4.97,7,99.04
7.0,2018.0,07-2018,6111.0,10.71,4.83,8,98.9
7.0,2018.0,07-2018,6214.0,9.71,4.83,8,98.9
7.0,2018.0,07-2018,19422.0,10.11,4.81,10,98.63
7.0,2018.0,07-2018,6110.0,11.57,4.79,11,98.49
7.0,2018.0,07-2018,4895.0,9.47,4.67,12,98.35
7.0,2018.0,07-2018,6217.0,10.8,4.62,13,98.22
7.0,2018.0,07-2018,4.0,13.97,4.53,14,98.08
7.0,2018.0,07-2018,6218.0,9.29,4.5,15,97.94
7.0,2018.0,07-2018,6123.0,9.49,4.49,16,97.81
7.0,2018.0,07-2018,171.0,14.91,4.47,17,97.67
7.0,2018.0,07-2018,19613.0,12.62,4.38,18,97.53
7.0,2018.0,07-2018,17.0,7.89,4.15,19,97.39
7.0,2018.0,07-2018,6.0,11.99,4.08,20,97.26
7.0,2018.0,07-2018,6013.0,9.35,3.99,21,97.12
7.0,2018.0,07-2018,4870.0,10.29,3.95,22,96.98
7.0,2018.0,07-2018,19423.0,12.22,3.92,23,96.84
7.0,2018.0,07-2018,6089.0,6.97,3.84,24,96.71
7.0,2018.0,07-2018,161.0,11.48,3.82,25,96.57
7.0,2018.0,07-2018,6286.0,14.1,3.82,25,96.57
7.0,2018.0,07-2018,5991.0,11.04,3.81,27,96.3
7.0,2018.0,07-2018,92.0,9.77,3.77,28,96.16
7.0,2018.0,07-2018,6184.0,13.35,3.75,29,96.02
7.0,2018.0,07-2018,19621.0,11.61,3.74,30,95.88
7.0,2018.0,07-2018,63.0,9.37,3.73,31,95.75
7.0,2018.0,07-2018,103.0,6.61,3.69,32,95.61
7.0,2018.0,07-2018,38.0,9.48,3.66,33,95.47
7.0,2018.0,07-2018,17786.0,13.67,3.65,34,95.34
7.0,2018.0,07-2018,6232.0,9.97,3.64,35,95.2
7.0,2018.0,07-2018,165.0,6.05,3.59,36,95.06
7.0,2018.0,07-2018,18351.0,6.09,3.58,37,94.92
7.0,2018.0,07-2018,15.0,6.9,3.56,38,94.79
,,,,6.12,2.85,43,96.4
7.0,2018.0,07-2018,17314.0,10.43,3.55,39,94.65
7.0,2018.0,07-2018,6151.0,6.83,3.55,39,94.65
7.0,2018.0,07-2018,4914.0,7.42,3.55,39,94.65
7.0,2018.0,07-2018,115.0,11.68,3.53,42,94.24
7.0,2018.0,07-2018,5968.0,12.87,3.53,42,94.24
7.0,2018.0,07-2018,36.0,9.27,3.51,44,93.96
7.0,2018.0,07-2018,5943.0,6.37,3.48,45,93.83
7.0,2018.0,07-2018,133.0,10.91,3.44,46,93.69
7.0,2018.0,07-2018,1.0,7.02,3.44,46,93.69
7.0,2018.0,07-2018,114.0,6.25,3.41,48,93.42
7.0,2018.0,07-2018,6107.0,8.84,3.39,49,93.28
7.0,2018.0,07-2018,150.0,5.3,3.39,49,93.28
7.0,2018.0,07-2018,60.0,6.71,3.36,51,93.0
7.0,2018.0,07-2018,96.0,7.21,3.35,52,92.87
7.0,2018.0,07-2018,22403.0,12.27,3.33,53,92.73
7.0,2018.0,07-2018,40.0,10.86,3.32,54,92.59
7.0,2018.0,07-2018,19758.0,6.28,3.32,54,92.59
7.0,2018.0,07-2018,17730.0,11.38,3.3,56,92.32
7.0,2018.0,07-2018,5938.0,11.63,3.29,57,92.18
7.0,2018.0,07-2018,4869.0,6.47,3.29,57,92.18
7.0,2018.0,07-2018,4897.0,12.93,3.27,59,91.91
7.0,2018.0,07-2018,6029.0,8.72,3.26,60,91.77
7.0,2018.0,07-2018,31.0,7.9,3.26,60,91.77
7.0,2018.0,07-2018,16137.0,9.65,3.24,62,91.5
7.0,2018.0,07-2018,6330.0,6.82,3.22,63,91.36
7.0,2018.0,07-2018,6334.0,11.63,3.22,63,91.36
7.0,2018.0,07-2018,6315.0,8.14,3.22,63,91.36
7.0,2018.0,07-2018,4852.0,6.77,3.2,66,90.95
7.0,2018.0,07-2018,16.0,6.24,3.2,66,90.95
7.0,2018.0,07-2018,6108.0,6.65,3.17,68,90.67
7.0,2018.0,07-2018,6206.0,10.76,3.17,68,90.67
7.0,2018.0,07-2018,6006.0,6.26,3.15,70,90.4
7.0,2018.0,07-2018,6228.0,10.22,3.15,70,90.4
7.0,2018.0,07-2018,20768.0,6.53,3.15,70,90.4
7.0,2018.0,07-2018,4902.0,8.17,3.12,73,89.99
7.0,2018.0,07-2018,6277.0,11.72,3.1,74,89.85
7.0,2018.0,07-2018,19757.0,10.95,3.08,75,89.71
7.0,2018.0,07-2018,4911.0,6.87,3.08,75,89.71
,,,,7.13,2.84,45,96.23
7.0,2018.0,07-2018,4910.0,6.09,3.07,77,89.44
7.0,2018.0,07-2018,6285.0,9.97,3.04,78,89.3
7.0,2018.0,07-2018,11974.0,7.19,3.02,79,89.16
7.0,2018.0,07-2018,6219.0,6.37,3.02,79,89.16
7.0,2018.0,07-2018,10250.0,11.4,3.01,81,88.89
7.0,2018.0,07-2018,6128.0,6.28,2.98,82,88.75
7.0,2018.0,07-2018,5946.0,5.99,2.97,83,88.61
7.0,2018.0,07-2018,158.0,7.46,2.97,83,88.61
7.0,2018.0,07-2018,15935.0,9.13,2.96,85,88.34
7.0,2018.0,07-2018,4855.0,5.99,2.95,86,88.2
7.0,2018.0,07-2018,149.0,6.88,2.95,86,88.2
7.0,2018.0,07-2018,16197.0,6.13,2.94,88,87.93
7.0,2018.0,07-2018,11067.0,5.14,2.93,89,87.79
7.0,2018.0,07-2018,17674.0,6.25,2.92,90,87.65
7.0,2018.0,07-2018,4913.0,6.76,2.92,90,87.65
7.0,2018.0,07-2018,56.0,7.09,2.91,92,87.38
7.0,2018.0,07-2018,6341.0,5.68,2.91,92,87.38
7.0,2018.0,07-2018,6316.0,6.52,2.91,92,87.38
7.0,2018.0,07-2018,18647.0,6.45,2.91,92,87.38
7.0,2018.0,07-2018,17803.0,6.21,2.91,92,87.38
7.0,2018.0,07-2018,23.0,5.41,2.89,97,86.69
7.0,2018.0,07-2018,132.0,7.48,2.88,98,86.56
7.0,2018.0,07-2018,6365.0,6.45,2.88,98,86.56
7.0,2018.0,07-2018,6378.0,9.64,2.87,100,86.28
7.0,2018.0,07-2018,17673.0,8.07,2.86,101,86.15
7.0,2018.0,07-2018,97.0,6.41,2.86,101,86.15
7.0,2018.0,07-2018,7537.0,7.82,2.86,101,86.15
7.0,2018.0,07-2018,20764.0,5.85,2.86,101,86.15
7.0,2018.0,07-2018,44.0,6.11,2.85,105,85.6
7.0,2018.0,07-2018,5.0,10.82,2.85,105,85.6
7.0,2018.0,07-2018,6227.0,6.07,2.85,105,85.6
7.0,2018.0,07-2018,19.0,6.57,2.84,108,85.19
7.0,2018.0,07-2018,93.0,7.08,2.8
Query:
-- Query 2: Get distinct interest IDs from INTEREST_METRICS
SELECT DISTINCT "interest_id" 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000
Answer:
Too long, hard cut:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
6111.0
19422.0
6110.0
6217.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
6286.0
19621.0
63.0
165.0
18351.0
""
17314.0
4914.0
6107.0
40.0
5938.0
16137.0
6330.0
6006.0
6228.0
4902.0
97.0
20764.0
5.0
19610.0
4940.0
10838.0
6255.0
69.0
79.0
4895.0
5991.0
114.0
96.0
19758.0
6029.0
6334.0
6315.0
6206.0
20768.0
4855.0
56.0
23.0
98.0
18646.0
6162.0
128.0
6308.0
148.0
18347.0
4910.0
32703.0
6214.0
4.0
6218.0
161.0
92.0
6184.0
6232.0
36.0
150.0
17730.0
4869.0
31.0
19757.0
4911.0
5946.0
6378.0
6172.0
169.0
6299.0
6304.0
6123.0
103.0
38.0
17786.0
15.0
115.0
22403.0
4852.0
6108.0
6219.0
10250.0
149.0
16197.0
11067.0
4913.0
6316.0
17803.0
44.0
19.0
4873.0
86.0
24.0
12133.0
6141.0
4943.0
18996.0
85.0
19587.0
135.0
19588.0
77.0
4944.0
111.0
151.0
7461.0
17785.0
6318.0
7605.0
12.0
70.0
19579.0
18490.0
147.0
6062.0
19760.0
6115.0
6265.0
18350.0
6148.0
6340.0
109.0
12027.0
18784.0
34.0
102.0
6323.0
5896.0
6301.0
22411.0
6321.0
62.0
6222.0
6341.0
17673.0
6112.0
20753.0
125.0
17269.0
6284.0
7557.0
117.0
33.0
17320.0
18202.0
10008.0
10976.0
21242.0
21293.0
6278.0
64.0
88.0
5921.0
21057.0
6133.0
22096.0
18622.0
19294.0
5963.0
10988.0
116.0
21061.0
5984.0
45.0
21058.0
4857.0
6024.0
157.0
143.0
14901.0
6320.0
19604.0
7536.0
16196.0
18203.0
38360.0
36864.0
37876.0
10954.0
133.0
11974.0
15935.0
18647.0
5968.0
5943.0
16.0
6277.0
6285.0
6128.0
17674.0
93.0
22502.0
20750.0
6087.0
104.0
39.0
5952.0
164.0
5989.0
138.0
12277.0
61.0
6211.0
5972.0
6023.0
5960.0
90.0
6144.0
49.0
75.0
18781.0
4848.0
5930.0
13496.0
4920.0
163.0
33191.0
5918.0
13421.0
12025.0
19297.0
10870.0
19606.0
170.0
6151.0
1.0
60.0
158.0
132.0
6365.0
7537.0
6227.0
6085.0
11975.0
13.0
89.0
37.0
6084.0
8.0
4909.0
6127.0
66.0
7453.0
6171.0
131.0
10839.0
67.0
4861.0
19630.0
5970.0
4907.0
20767.0
10837.0
130.0
27.0
19879.0
4915.0
6250.0
6237.0
6302.0
22425.0
6207.0
141.0
6181.0
6298.0
6145.0
22.0
4918.0
17671.0
5906.0
35.0
21292.0
19250.0
82.0
13498.0
4925.0
6319.0
10365.0
6366.0
4898.0
7425.0
16119.0
65.0
5898.0
6051.0
5901.0
4866.0
6095.0
6229.0
20814.0
4904.0
7527.0
20963.0
6221.0
6210.0
139.0
19603.0
126.0
5920.0
7529.0
41.0
10972.0
22424.0
19338.0
19578.0
6263.0
10980.0
6267.0
119.0
4859.0
155.0
12031.0
107.0
17318.0
21060.0
5961.0
18997.0
6142.0
87.0
22423.0
21236.0
21238.0
80.0
6208.0
23778.0
18204.0
19628.0
19590.0
22095.0
145.0
20815.0
6305.0
6328.0
30.0
4928.0
59.0
55.0
18619.0
6030.0
10284.0
6209.0
6169.0
142.0
6194.0
153.0
10832.0
6088.0
11065.0
22093.0
6393.0
50.0
20755.0
12821.0
14800.0
6300.0
10009.0
18807.0
32705.0
6335.0
108.0
6149.0
10364.0
6367.0
4903.0
110.0
20816.0
4867.0
20730.0
7546.0
18924.0
4908.0
19593.0
6230.0
6317.0
5936.0
18783.0
7597.0
7545.0
6345.0
17729.0
4906.0
10970.0
22401.0
10836.0
4933.0
6215.0
6156.0
5945.0
112.0
6339.0
6122.0
19594.0
4931.0
6034.0
22398.0
72.0
19609.0
6332.0
21248.0
58.0
10971.0
7598.0
19626.0
19631.0
6047.0
21244.0
34462.0
34082.0
34461.0
34077.0
34084.0
34079.0
34460.0
33534.0
21245.0
34651.0
34643.0
34647.0
34650.0
34638.0
34646.0
36343.0
37411.0
37423.0
37874.0
37420.0
36876.0
38355.0
37414.0
38362.0
38351.0
37887.0
37166.0
38365.0
37165.0
37878.0
37416.0
38358.0
38989.0
39190.0
39192.0
39770.0
39651.0
39199.0
39659.0
41854.0
41191.0
41192.0
42238.0
42237.0
41554.0
40692.0
40687.0
40427.0
40694.0
42964.0
44470.0
44476.0
44479.0
44456.0
45524.0
44379.0
45669.0
45668.0
46567.0
49979.0
10011.0
22427.0
16138.0
18621.0
6329.0
6076.0
5914.0
6337.0
10977.0
12132.0
5911.0
6260.0
4917.0
5907.0
4924.0
95.0
5942.0
10978.0
19627.0
83.0
17672.0
6234.0
6322.0
28.0
19633.0
5909.0
10872.0
6324.0
6134.0
6253.0
6174.0
6212.0
6391.0
6159.0
19878.0
7543.0
10834.0
25.0
5934.0
6257.0
22400.0
4935.0
5929.0
22417.0
10975.0
6098.0
12032.0
6385.0
6124.0
32702.0
19612.0
10974.0
10010.0
6049.0
19634.0
166.0
5971.0
19624.0
21249.0
6236.0
121.0
10955.0
19615.0
5900.0
21251.0
15884.0
17274.0
11977.0
20752.0
2.0
19596.0
33474.0
34574.0
34088.0
34468.0
33972.0
33962.0
33958.0
35953.0
35169.0
34637.0
34644.0
34649.0
34642.0
37413.0
37877.0
36869.0
38284.0
37418.0
38361.0
37417.0
37412.0
38990.0
40183.0
40685.0
40683.0
39196.0
39649.0
40697.0
40691.0
40688.0
39643.0
40195.0
39547.0
39645.0
39658.0
39331.0
39338.0
39654.0
41856.0
41190.0
41855.0
41078.0
41079.0
41066.0
41059.0
40695.0
40526.0
44453.0
44587.0
45670.0
44473.0
44466.0
44484.0
45519.0
45675.0
45679.0
45673.0
44483.0
44589.0
44471.0
44458.0
44467.0
44384.0
45528.0
43551.0
39655.0
44580.0
42008.0
49972.0
51678.0
49975.0
84.0
13428.0
19635.0
19595.0
35742.0
37875.0
36873.0
36863.0
40525.0
40187.0
40699.0
41067.0
41075.0
43550.0
44486.0
45672.0
14802.0
44459.0
7540.0
12490.0
21237.0
4897.0
101.0
137.0
20731.0
6182.0
3.0
6336.0
15877.0
5951.0
6143.0
6173.0
12820.0
19295.0
6045.0
4894.0
5999.0
6220.0
6264.0
5895.0
5944.0
14.0
99.0
74.0
5924.0
21059.0
162.0
22413.0
26.0
6266.0
5910.0
18352.0
6183.0
6081.0
21239.0
7535.0
5958.0
4930.0
19617.0
5956.0
168.0
134.0
17271.0
18.0
4936.0
32701.0
10833.0
81.0
7464.0
71.0
19607.0
10251.0
4937.0
6303.0
1
Query:
-- Query 3: Get composition values over time for interest_id = 1
SELECT "month_year", "composition" 
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "interest_id" = 1 
LIMIT 1000
Answer:
month_year,composition
07-2018,7.02
08-2018,3.44
09-2018,2.44
10-2018,3.71
11-2018,2.79
12-2018,2.94
01-2019,2.38
02-2019,2.55
03-2019,2.76
04-2019,2.28
05-2019,1.68
08-2019,2.64
Query:
-- Query 4: Get maximum composition value for each interest_id
SELECT "interest_id", MAX("composition") AS "max_composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,max_composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
6111.0,10.71
19422.0,10.11
6110.0,11.57
6217.0,10.8
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,12.56
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
6286.0,14.1
19621.0,11.61
63.0,9.37
165.0,6.05
18351.0,6.09
,9.66
17314.0,10.43
4914.0,7.42
6107.0,8.84
40.0,10.86
5938.0,11.63
16137.0,9.65
6330.0,6.82
6006.0,6.26
6228.0,10.22
4902.0,8.17
97.0,6.41
20764.0,5.85
5.0,10.82
19610.0,7.56
4940.0,5.89
10838.0,6.8
6255.0,7.55
69.0,10.82
79.0,11.21
4895.0,9.47
5991.0,11.04
114.0,6.25
96.0,7.21
19758.0,6.28
6029.0,10.05
6334.0,11.63
6315.0,8.14
6206.0,10.76
20768.0,6.53
4855.0,5.99
56.0,7.09
23.0,5.41
98.0,7.64
18646.0,6.85
6162.0,6.32
128.0,6.5
6308.0,9.33
148.0,5.49
18347.0,7.8
4910.0,6.09
32703.0,5.69
6214.0,9.71
4.0,13.97
6218.0,9.29
161.0,11.48
92.0,9.77
6184.0,13.35
6232.0,9.97
36.0,9.27
150.0,5.3
17730.0,11.38
4869.0,6.47
31.0,7.9
19757.0,10.95
4911.0,6.87
5946.0,5.99
6378.0,9.64
6172.0,6.1
169.0,6.1
6299.0,5.71
6304.0,8.31
6123.0,9.49
103.0,6.61
38.0,9.48
17786.0,13.67
15.0,6.9
115.0,11.68
22403.0,12.27
4852.0,6.77
6108.0,6.65
6219.0,6.37
10250.0,11.4
149.0,6.88
16197.0,6.13
11067.0,7.93
4913.0,6.76
6316.0,6.52
17803.0,6.21
44.0,6.11
19.0,6.57
4873.0,5.57
86.0,6.13
24.0,6.54
12133.0,15.15
6141.0,6.34
4943.0,10.7
18996.0,7.84
85.0,6.46
19587.0,5.85
135.0,7.01
19588.0,5.87
77.0,17.19
4944.0,9.46
111.0,7.42
151.0,7.97
7461.0,7.0
17785.0,7.66
6318.0,6.65
7605.0,6.82
12.0,7.23
70.0,6.96
19579.0,6.24
18490.0,7.09
147.0,6.17
6062.0,7.33
19760.0,5.36
6115.0,6.67
6265.0,7.31
18350.0,6.85
6148.0,7.13
6340.0,7.44
109.0,6.75
12027.0,8.32
18784.0,7.47
34.0,11.23
102.0,7.74
6323.0,6.28
5896.0,6.09
6301.0,5.58
22411.0,5.22
6321.0,4.97
62.0,4.15
6222.0,3.49
6341.0,5.68
17673.0,8.07
6112.0,9.22
20753.0,5.79
125.0,6.38
17269.0,8.64
6284.0,18.82
7557.0,8.17
117.0,6.49
33.0,7.6
17320.0,3.98
18202.0,8.23
10008.0,9.46
10976.0,8.16
21242.0,7.36
21293.0,7.28
6278.0,6.18
64.0,12.41
88.0,4.99
5921.0,7.37
21057.0,21.2
6133.0,3.82
22096.0,6.56
18622.0,7.44
19294.0,7.22
5963.0,5.36
10988.0,8.17
116.0,6.31
21061.0,8.97
5984.0,4.9
45.0,6.29
21058.0,8.5
4857.0,6.56
6024.0,4.7
157.0,4.94
143.0,4.68
14901.0,4.15
6320.0,4.72
19604.0,5.82
7536.0,5.84
16196.0,4.59
18203.0,2.9
38360.0,3.48
36864.0,3.35
37876.0,2.26
10954.0,1.88
133.0,10.91
11974.0,7.19
15935.0,9.13
18647.0,6.45
5968.0,12.87
5943.0,6.37
16.0,6.24
6277.0,11.72
6285.0,9.97
6128.0,6.28
17674.0,7.88
93.0,7.08
22502.0,8.24
20750.0,5.87
6087.0,5.41
104.0,5.42
39.0,17.44
5952.0,7.11
164.0,6.14
5989.0,5.57
138.0,7.3
12277.0,6.2
61.0,6.59
6211.0,8.09
5972.0,6.6
6023.0,8.02
5960.0,10.61
90.0,5.91
6144.0,6.61
49.0,5.09
75.0,7.23
18781.0,6.56
4848.0,6.49
5930.0,6.17
13496.0,6.78
4920.0,5.93
163.0,6.4
33191.0,4.39
5918.0,6.8
13421.0,7.15
12025.0,8.45
19297.0,4.26
10870.0,3.29
19606.0,4.42
170.0,4.76
6151.0,6.83
1.0,7.02
60.0,8.66
158.0,11.97
132.0,7.48
6365.0,6.45
7537.0,7.82
6227.0,6.45
6085.0,7.08
11975.0,7.81
13.0,6.72
89.0,10.14
37.0,7.82
6084.0,6.97
8.0,6.67
4909.0,7.01
6127.0,5.96
66.0,6.51
7453.0,6.45
6171.0,8.19
131.0,5.09
10839.0,5.59
67.0,6.76
4861.0,5.29
19630.0,7.15
5970.0,9.21
4907.0,6.26
20767.0,7.73
10837.0,7.48
130.0,7.66
27.0,6.81
19879.0,6.95
4915.0,6.28
6250.0,5.54
6237.0,7.7
6302.0,7.41
22425.0,6.41
6207.0,7.81
141.0,9.46
6181.0,6.11
6298.0,5.38
6145.0,6.1
22.0,6.26
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
21292.0,7.19
19250.0,7.7
82.0,9.99
13498.0,6.42
4925.0,6.4
6319.0,7.39
10365.0,5.21
6366.0,6.6
4898.0,14.23
7425.0,8.54
16119.0,7.93
65.0,5.94
5898.0,7.85
6051.0,5.31
5901.0,6.79
4866.0,6.33
6095.0,7.5
6229.0,7.2
20814.0,5.78
4904.0,6.28
7527.0,5.97
20963.0,5.78
6221.0,5.94
6210.0,6.09
139.0,6.87
19603.0,6.05
126.0,6.67
5920.0,6.07
7529.0,6.5
41.0,6.96
10972.0,7.35
22424.0,6.05
19338.0,7.68
19578.0,4.14
6263.0,5.14
10980.0,6.14
6267.0,6.88
119.0,6.31
4859.0,6.48
155.0,4.97
12031.0,7.08
107.0,8.32
17318.0,4.93
21060.0,8.58
5961.0,7.12
18997.0,6.05
6142.0,6.25
87.0,5.01
22423.0,5.33
21236.0,6.64
21238.0,5.15
80.0,4.47
6208.0,9.67
23778.0,5.52
18204.0,6.51
19628.0,4.66
19590.0,4.59
22095.0,4.54
145.0,4.89
20815.0,3.03
6305.0,6.2
6328.0,5.43
30.0,8.56
4928.0,4.78
59.0,3.97
55.0,7.67
18619.0,9.15
6030.0,3.85
10284.0,5.02
6209.0,4.45
6169.0,3.8
142.0,4.73
6194.0,4.39
153.0,5.08
10832.0,4.4
6088.0,4.28
11065.0,4.22
22093.0,4.34
6393.0,3.17
50.0,3.86
20755.0,4.77
12821.0,5.18
14800.0,4.11
6300.0,4.91
10009.0,8.95
18807.0,4.1
32705.0,4.69
6335.0,4.41
108.0,4.24
6149.0,4.1
10364.0,3.29
6367.0,3.78
4903.0,3.67
110.0,5.78
20816.0,2.79
4867.0,5.44
20730.0,4.0
7546.0,4.72
18924.0,4.61
4908.0,3.29
19593.0,6.18
6230.0,4.39
6317.0,4.67
5936.0,3.78
18783.0,9.83
7597.0,3.18
7545.0,4.19
6345.0,3.94
17729.0,6.7
4906.0,3.09
10970.0,4.04
22401.0,3.62
10836.0,4.18
4933.0,3.46
6215.0,3.81
6156.0,2.99
5945.0,4.87
112.0,2.95
6339.0,3.79
6122.0,3.05
19594.0,2.48
4931.0,4.05
6034.0,4.69
22398.0,3.52
72.0,3.63
19609.0,3.17
6332.0,2.65
21248.0,2.88
58.0,2.18
10971.0,2.67
7598.0,2.82
19626.0,1.99
19631.0,2.
Query:
-- Query 5: Join INTEREST_METRICS and INTEREST_MAP to get interest names
SELECT im."interest_name", m."interest_id", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,interest_id,composition,month_year
Vacation Rental Accommodation Researchers,32486.0,11.89,07-2018
Luxury Second Home Owners,6106.0,9.93,07-2018
Online Home Decor Shoppers,18923.0,10.85,07-2018
Hair Care Shoppers,6344.0,10.32,07-2018
Nutrition Conscious Eaters,100.0,10.77,07-2018
Healthy Eaters,69.0,10.82,07-2018
Luxury Travel Researchers,79.0,11.21,07-2018
Wine Lovers,6111.0,10.71,07-2018
Home Remodelers,6214.0,9.71,07-2018
Home Design and Living Publication Readers,19422.0,10.11,07-2018
Apartment Furniture Shoppers,6110.0,11.57,07-2018
Mature Parents,4895.0,9.47,07-2018
Weight Loss Researchers,6217.0,10.8,07-2018
Luxury Retail Researchers,4.0,13.97,07-2018
Running Enthusiasts,6218.0,9.29,07-2018
Misc-Deal Seekers or Coupon Shoppers,6123.0,9.49,07-2018
Shoe Shoppers,171.0,14.91,07-2018
Land Rover Shoppers,19613.0,12.62,07-2018
MLB Fans,17.0,7.89,07-2018
Vacation Planners,6.0,11.99,07-2018
Competitive Sports Participants,6013.0,9.35,07-2018
Tech-Savvy Moms,4870.0,10.29,07-2018
Kitchen Appliance Shoppers,19423.0,12.22,07-2018
Mens Fitness Publication Readers,6089.0,6.97,07-2018
Travel Reward Points Enthusiasts,161.0,11.48,07-2018
Luxury Hotel Guests,6286.0,14.1,07-2018
Gluten-Free Recipe Researchers,5991.0,11.04,07-2018
Parents with Kids,92.0,9.77,07-2018
Reusable Drinkware Shoppers,6184.0,13.35,07-2018
Portugal Trip Planners,19621.0,11.61,07-2018
New & Expecting Parents,63.0,9.37,07-2018
Live Concert Fans,103.0,6.61,07-2018
Sporting Goods Shoppers,38.0,9.48,07-2018
Womens Fashion Brands Shoppers,17786.0,13.67,07-2018
Golf Enthusiasts,6232.0,9.97,07-2018
Liberal News Readers,165.0,6.05,07-2018
Drama Show Watchers,18351.0,6.09,07-2018
NBA Fans,15.0,6.9,07-2018
Lobbyists,17314.0,10.43,07-2018
Wedding Registrants,6151.0,6.83,07-2018
Mens Health Researchers,4914.0,7.42,07-2018
Mens Shoe Shoppers,115.0,11.68,07-2018
Luxury Kitchen Goods Shoppers,5968.0,12.87,07-2018
Baby Products Buyers,36.0,9.27,07-2018
Financial News Readers,5943.0,6.37,07-2018
High End Camera Shoppers - Dupe,133.0,10.91,07-2018
Fitness Enthusiasts,1.0,7.02,07-2018
Womens Fashion Magazine Readers,114.0,6.25,07-2018
Ski House Second Home Owners,6107.0,8.84,07-2018
TV Junkies,150.0,5.3,07-2018
Online Health Researchers,60.0,6.71,07-2018
Exercise and Gym Researchers,96.0,7.21,07-2018
Pandora Jewelry Shoppers,22403.0,12.27,07-2018
Bed & Bath Shoppers,40.0,10.86,07-2018
Dog Lovers,19758.0,6.28,07-2018
Luxury Department Store Shoppers,17730.0,11.38,07-2018
Costa Rica Trip Planners,5938.0,11.63,07-2018
Womens Fitness Enthusiasts,4869.0,6.47,07-2018
Parents of Teenagers Going to College,4897.0,12.93,07-2018
Indoor Cycling & Spinning Enthusiasts,6029.0,8.72,07-2018
Home Decor Shoppers,31.0,7.9,07-2018
Olympics Fans,16137.0,9.65,07-2018
Pet Store Goers,6330.0,6.82,07-2018
Supermarket Shoppers,6334.0,11.63,07-2018
Boston Trip Planners,6315.0,8.14,07-2018
Health & Fitness,4852.0,6.77,07-2018
NCAA Fans,16.0,6.24,07-2018
Beach House Second Home Owners,6108.0,6.65,07-2018
Preppy Clothing Shoppers,6206.0,10.76,07-2018
Breast Cancer Fund Raisers,6006.0,6.26,07-2018
Paleo Eaters,6228.0,10.22,07-2018
Beer Aficionados,20768.0,6.53,07-2018
Yogis,4902.0,8.17,07-2018
Harry Potter Fans,6277.0,11.72,07-2018
Natural Pet Food Shoppers,19757.0,10.95,07-2018
Dieters,4911.0,6.87,07-2018
Cholesterol Researchers,4910.0,6.09,07-2018
Competitive Tri-Athletes,6285.0,9.97,07-2018
Price Conscious Home Shoppers,11974.0,7.19,07-2018
Cycling Enthusiasts,6219.0,6.37,07-2018
Halloween Costume Shoppers,10250.0,11.4,07-2018
Realtors & Real Estate Researchers,6128.0,6.28,07-2018
Readers of Filipinos Content,5946.0,5.99,07-2018
Flight and Hotel Shoppers,158.0,7.46,07-2018
Pregnancy Resources Researchers,15935.0,9.13,07-2018
Entertainment & Tabloid Magazine Readers,4855.0,5.99,07-2018
Streaming Radio Listeners,149.0,6.88,07-2018
Financial Business Intelligence Researchers,16197.0,6.13,07-2018
NCAA Football Fans,11067.0,5.14,07-2018
Medical Advice Researchers,17674.0,6.25,07-2018
Womens Health Researchers,4913.0,6.76,07-2018
Discount Device Shoppers,56.0,7.09,07-2018
Pharmacy Shoppers,6341.0,5.68,07-2018
Philadelphia Trip Planners,6316.0,6.52,07-2018
Gourmet Food & Wine Researchers,18647.0,6.45,07-2018
TV Advertising Professionals,17803.0,6.21,07-2018
Techies,23.0,5.41,07-2018
Apple Fans,132.0,7.48,07-2018
Executive and C-Suite,6365.0,6.45,07-2018
Luggage Shoppers,6378.0,9.64,07-2018
Coffee Chain Shoppers,17673.0,8.07,07-2018
Home Kitchen Chefs,97.0,6.41,07-2018
Ecommerce Platform Researchers,7537.0,7.82,07-2018
Entertainment Industry Decision Makers,20764.0,5.85,07-2018
Home Buyers,44.0,6.11,07-2018
Brides & Wedding Planners,5.0,10.82,07-2018
Personal Stock Portfolio Managers,6227.0,6.07,07-2018
Eco-Conscious Consumers,19.0,6.57,07-2018
Young Boomers,93.0,7.08,07-2018
Discount Womens Shoes Shoppers,6085.0,7.08,07-2018
Olympic Sports Enthusiasts,6112.0,9.22,07-2018
TV Game Show Fans,4873.0,5.45,07-2018
Landscape Architects,11975.0,7.81,07-2018
Lacrosse Enthusiasts,22502.0,8.24,
Query:
-- Query 6: Get top 10 composition values across all interest categories
SELECT im."interest_name", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
ORDER BY m."composition" DESC 
LIMIT 10
Answer:
interest_name,composition,month_year
Work Comes First Travelers,21.2,12-2018
Work Comes First Travelers,20.28,10-2018
Work Comes First Travelers,19.45,11-2018
Work Comes First Travelers,18.99,01-2019
Gym Equipment Owners,18.82,07-2018
Work Comes First Travelers,18.39,02-2019
Work Comes First Travelers,18.18,09-2018
Furniture Shoppers,17.44,07-2018
Luxury Retail Shoppers,17.19,07-2018
Luxury Boutique Hotel Researchers,15.15,10-2018
Query:
-- Query 7: Get bottom 10 composition values across all interest categories
SELECT im."interest_name", m."composition", m."month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
ON im."id" = m."interest_id" 
ORDER BY m."composition" ASC 
LIMIT 10
Answer:
interest_name,composition,month_year
Mowing Equipment Shoppers,1.51,05-2019
Readers of Jamaican Content,1.52,08-2018
New York Giants Fans,1.52,06-2019
Philadelphia 76ers Fans,1.52,05-2019
Minnesota Vikings Fans,1.52,04-2019
Beer Aficionados,1.52,05-2019
United Nations Donors,1.52,04-2019
Disney Fans,1.52,06-2019
World of Warcraft Enthusiasts,1.52,03-2019
Gastrointestinal Researchers,1.52,05-2019
Query:
-- Query 8: Count the number of records per interest_id
SELECT "interest_id", COUNT(*) AS "record_count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,record_count
32486.0,14
6106.0,13
18923.0,14
6344.0,10
100.0,14
6111.0,12
19422.0,12
6110.0,14
6217.0,14
171.0,14
19613.0,14
17.0,14
6.0,14
6013.0,14
4870.0,14
19423.0,14
6089.0,11
6286.0,14
19621.0,14
63.0,12
165.0,10
18351.0,12
,1193
17314.0,14
4914.0,14
6107.0,14
40.0,14
5938.0,14
16137.0,14
6330.0,11
6006.0,12
6228.0,12
4902.0,14
97.0,11
20764.0,6
5.0,14
19610.0,14
4940.0,14
10838.0,14
6255.0,14
69.0,13
79.0,14
4895.0,12
5991.0,14
114.0,10
96.0,14
19758.0,13
6029.0,14
6334.0,14
6315.0,14
6206.0,14
20768.0,14
4855.0,8
56.0,14
23.0,6
98.0,14
18646.0,12
6162.0,13
128.0,13
6308.0,14
148.0,8
18347.0,14
4910.0,14
32703.0,14
6214.0,12
4.0,14
6218.0,14
161.0,14
92.0,13
6184.0,14
6232.0,14
36.0,12
150.0,5
17730.0,14
4869.0,11
31.0,14
19757.0,14
4911.0,14
5946.0,10
6378.0,14
6172.0,13
169.0,11
6299.0,9
6304.0,14
6123.0,11
103.0,12
38.0,14
17786.0,14
15.0,14
115.0,14
22403.0,14
4852.0,12
6108.0,14
6219.0,14
10250.0,14
149.0,11
16197.0,11
11067.0,14
4913.0,12
6316.0,14
17803.0,10
44.0,14
19.0,10
4873.0,12
86.0,14
24.0,12
12133.0,14
6141.0,13
4943.0,14
18996.0,14
85.0,14
19587.0,11
135.0,14
19588.0,14
77.0,14
4944.0,14
111.0,14
151.0,14
7461.0,14
17785.0,14
6318.0,14
7605.0,14
12.0,14
70.0,14
19579.0,14
18490.0,14
147.0,14
6062.0,14
19760.0,9
6115.0,14
6265.0,14
18350.0,14
6148.0,14
6340.0,14
109.0,14
12027.0,14
18784.0,14
34.0,14
102.0,14
6323.0,14
5896.0,14
6301.0,14
22411.0,14
6321.0,14
62.0,13
6222.0,11
6341.0,11
17673.0,14
6112.0,14
20753.0,11
125.0,13
17269.0,14
6284.0,14
7557.0,14
117.0,14
33.0,14
17320.0,14
18202.0,14
10008.0,14
10976.0,14
21242.0,14
21293.0,14
6278.0,10
64.0,14
88.0,14
5921.0,14
21057.0,8
6133.0,14
22096.0,14
18622.0,14
19294.0,14
5963.0,14
10988.0,14
116.0,13
21061.0,8
5984.0,3
45.0,14
21058.0,8
4857.0,14
6024.0,14
157.0,14
143.0,14
14901.0,14
6320.0,14
19604.0,14
7536.0,14
16196.0,14
18203.0,13
38360.0,11
36864.0,11
37876.0,8
10954.0,1
133.0,2
11974.0,14
15935.0,11
18647.0,12
5968.0,14
5943.0,11
16.0,14
6277.0,14
6285.0,14
6128.0,14
17674.0,14
93.0,11
22502.0,14
20750.0,13
6087.0,11
104.0,10
39.0,14
5952.0,14
164.0,9
5989.0,10
138.0,13
12277.0,12
61.0,14
6211.0,14
5972.0,14
6023.0,14
5960.0,14
90.0,11
6144.0,14
49.0,14
75.0,14
18781.0,14
4848.0,12
5930.0,13
13496.0,14
4920.0,10
163.0,14
33191.0,14
5918.0,14
13421.0,14
12025.0,14
19297.0,14
10870.0,12
19606.0,13
170.0,13
6151.0,10
1.0,12
60.0,14
158.0,14
132.0,14
6365.0,13
7537.0,14
6227.0,13
6085.0,14
11975.0,14
13.0,13
89.0,14
37.0,14
6084.0,13
8.0,13
4909.0,14
6127.0,12
66.0,10
7453.0,13
6171.0,14
131.0,5
10839.0,6
67.0,14
4861.0,10
19630.0,14
5970.0,14
4907.0,13
20767.0,14
10837.0,14
130.0,14
27.0,14
19879.0,13
4915.0,13
6250.0,14
6237.0,14
6302.0,14
22425.0,13
6207.0,14
141.0,14
6181.0,9
6298.0,6
6145.0,10
22.0,13
4918.0,12
17671.0,13
5906.0,14
35.0,14
21292.0,14
19250.0,14
82.0,14
13498.0,14
4925.0,14
6319.0,14
10365.0,1
6366.0,14
4898.0,14
7425.0,14
16119.0,14
65.0,14
5898.0,14
6051.0,14
5901.0,14
4866.0,14
6095.0,14
6229.0,14
20814.0,14
4904.0,12
7527.0,14
20963.0,11
6221.0,12
6210.0,14
139.0,14
19603.0,14
126.0,14
5920.0,12
7529.0,14
41.0,14
10972.0,14
22424.0,11
19338.0,14
19578.0,14
6263.0,14
10980.0,14
6267.0,14
119.0,14
4859.0,14
155.0,14
12031.0,14
107.0,14
17318.0,14
21060.0,8
5961.0,14
18997.0,14
6142.0,14
87.0,14
22423.0,14
21236.0,14
21238.0,14
80.0,14
6208.0,14
23778.0,14
18204.0,14
19628.0,14
19590.0,14
22095.0,14
145.0,14
20815.0,9
6305.0,14
6328.0,14
30.0,14
4928.0,14
59.0,13
55.0,14
18619.0,14
6030.0,14
10284.0,14
6209.0,14
6169.0,14
142.0,13
6194.0,12
153.0,14
10832.0,14
6088.0,14
11065.0,14
22093.0,14
6393.0,14
50.0,14
20755.0,14
12821.0,14
14800.0,11
6300.0,14
10009.0,14
18807.0,14
32705.0,14
6335.0,14
108.0,14
6149.0,14
10364.0,13
6367.0,14
4903.0,14
110.0,14
20816.0,12
4867.0,13
20730.0,14
7546.0,14
18924.0,14
4908.0,14
19593.0,14
6230.0,14
6317.0,14
5936.0,14
18783.0,14
7597.0,11
7545.0,14
6345.0,14
17729.0,14
4906.0,11
10970.0,14
22401.0,13
10836.0,14
4933.0,11
6215.0,14
6156.0,13
5945.0,14
112.0,13
6339.0,14
6122.0,12
19594.0,11
4931.0,14
6034.0,12
22398.0,14
72.0,14
19609.0,13
6332.0,14
21248.0,10
58.0,10
10971.0,11
7598.0,11
19626.0,1
19631.0,14
6047.0,12
21244.0,10
34462.0,13
34082.0,13
34461.0,13
34077.0,13
34084.0,11
34079.0,10
34460.0,10
33534.0,1
21245.0,10
34651.0,9
34643.0,10
34647.0,10
34650.0,9
34638.0,11
34646.0,9
36343.0,8
37411.0,11
37423.0,11
37874.0,11
37420.0,11
36876.0,11
38355.0,11
37414.0,11
38362.0,11
38351.0,11
37887.0,11
37166.0,8
38365.0,9
37165.0,8
37878.0,10
37416.0,8
38358.0,8
38989.0,10
39190.0,8
39192.0,7
39770.0,8
39651.0,7
39199.0,7
39659.0,8
41854.0,9
41191.0,9
41192.0,9
42238.0,9
42237.0,9
41554.0,8
40692.0,9
40687.0,5
40427.0,6
40694.0,3
42964.0,8
44470.0,7
44476.0,7
44479.0,7
44456.0,7
45524.0,6
44379.0,6
45669.0,6
45668.0,4
46567.0,2
49979.0,5
10011.0,1
22427.0,14
16138.0,14
18621.0,14
6329.0,14
6076.0,13
5914.0,14
6337.0,14
10977.0,14
12132.0,14
5911.0,14
6260.0,2
4917.0,12
5907.0,14
4924.0,14
95.0,14
5942.0,12
10978.0,14
19627.0,13
83.0,14
17672.0,14
6234.0,14
Query:
-- Query 9: Get all unique month-year combinations
SELECT DISTINCT "month_year"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
LIMIT 1000
Answer:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019
Query:
-- Query 10: List all interest names from INTEREST_MAP
SELECT "id", "interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" 
LIMIT 1000
Answer:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
110,Pain Management Researchers
111,Retirement Planners
112,Auto Repair Researchers
113,Avid Readers
114,Womens Fashion Magazine Readers
115,Mens Shoe Shoppers
116,Home Security Shoppers
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
121,Coders & Developers
123,Military Servicemembers & Veterans
124,Healthcare Discount Shoppers
125,Postal Employees
126,Soccer Fans
128,Kitchen & Bathroom Remodelers
129,Aftermarket Accessories Shoppers
130,Automotive Safety Researchers
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
134,Home Printer Shoppers
135,Major Appliance Shoppers
136,Tablet Researchers
137,Online Alcohol Shoppers
138,Home Kitchen Bakers
139,Makeup Researchers
140,Pet Owners
141,Skin Care Researchers
142,Credit Card Researchers
143,Health Insurance Researchers
145,Property Insurance Researchers
146,Audio Equipment Researchers
147,Broadway Fans
148,Celebrity Gossip Fans
149,Streaming Radio Listeners
150,TV Junkies
151,Big & Tall Men
153,Phone Accessory Shoppers
154,Prepaid Smartphone Shoppers
155,Business Travelers
157,Car Rental Shoppers
158,Flight and Hotel Shoppers
160,Sightseeing Travelers
161,Travel Reward Points Enthusiasts
162,Retirees
163,Federal Employees
164,Conservative News Readers
165,Liberal News Readers
166,Doves
168,Social Conservatives
169,Social Liberals
170,Voters
171,Shoe Shoppers
4847,Readers of Hispanic Content
4848,Working Parents
4852,Health & Fitness
4855,Entertainment & Tabloid Magazine Readers
4857,Business Accounting Software Researchers
4858,Business Filing Researchers
4859,Business Logistics Managers
4861,IT Decision Makers
4866,Small Business Employees
4867,Sweepstakes Enthusiasts
4869,Womens Fitness Enthusiasts
4870,Tech-Savvy Moms
4872,Readers of Mexican Content
4873,TV Game Show Fans
4894,Credit Union Researchers
4895,Mature Parents
4896,Streaming Music Enthusiasts
4897,Parents of Teenagers Going to College
4898,Cosmetics and Beauty Shoppers
4899,Readers of Japanese Content
4902,Yogis
4903,Asthma Sufferers
4904,Adult Acne Sufferers
4905,Heartburn Sufferers
4906,Sinus Researchers
4907,Headache and Migraine Sufferers
4908,Back Pain Sufferers
4909,First Aid Researchers
4910,Cholesterol Researchers
4911,Dieters
4912,Vitamin Shoppers
4913,Womens Health Researchers
4914,Mens Health Researchers
4915,Food Allergies Researchers
4916,Arthritis Sufferers
4917,Teen Content Readers
4918,Gastrointestinal Researchers
4919,Military Families
4920,LGBT Activists
4921,Tire Shoppers
4924,Surfers
4925,Gun Control Advocates
4926,Gun Rights Advocates
4927,Immigration Rights Advocates
4928,Immigration Control Advocates
4929,Right Wing Radicals
4930,Occupy Movement Supporters
4931,Marijua
Query:
-- Query 11: Get average composition value per interest_id
SELECT "interest_id", AVG("composition") AS "avg_composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
GROUP BY "interest_id" 
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,avg_composition
32486.0,5.0249999999999995
6106.0,2.9676923076923076
18923.0,3.807142857142857
6344.0,2.9829999999999997
100.0,3.2728571428571427
69.0,3.281538461538461
79.0,3.957142857142857
6214.0,4.875
19422.0,4.9575000000000005
6110.0,4.651428571428572
6123.0,2.752727272727273
171.0,6.344285714285713
19613.0,4.900714285714286
6.0,8.330714285714285
6013.0,4.616428571428571
19423.0,4.965714285714285
6089.0,2.612727272727273
5991.0,3.6592857142857143
63.0,4.615833333333334
103.0,2.6733333333333333
6232.0,4.771428571428571
,3.937384744341995
6151.0,2.925
4914.0,3.0421428571428573
133.0,7.605
6107.0,4.337857142857143
150.0,2.6
60.0,4.938571428571429
40.0,3.9664285714285716
19758.0,2.573076923076923
4897.0,6.028571428571429
4911.0,3.2399999999999998
132.0,3.3192857142857144
6227.0,4.179230769230769
19.0,2.664
19610.0,3.470714285714286
20750.0,2.4884615384615385
18996.0,4.4314285714285715
39.0,9.507857142857144
19298.0,9.51142857142857
22427.0,4.077142857142857
5989.0,2.349
6304.0,4.708571428571429
18490.0,3.2935714285714286
161.0,3.6042857142857145
1.0,3.0524999999999998
96.0,2.9114285714285715
22403.0,5.434285714285714
20768.0,2.6107142857142853
19757.0,5.588571428571428
4910.0,2.4528571428571433
10250.0,7.578571428571429
4855.0,2.42625
169.0,2.407272727272727
164.0,2.4844444444444442
19587.0,2.4054545454545457
18202.0,5.967142857142858
21293.0,3.587857142857143
6143.0,3.267857142857143
22096.0,3.0207142857142855
6260.0,3.55
20764.0,2.605
16119.0,3.9385714285714286
160.0,4.027857142857143
4895.0,4.496666666666667
6217.0,5.1414285714285715
6218.0,4.442142857142857
92.0,3.123076923076923
165.0,2.423
18351.0,2.5033333333333334
115.0,6.9192857142857145
6029.0,6.303571428571429
16137.0,4.940714285714286
6334.0,3.9042857142857144
4852.0,2.975
6219.0,4.097857142857142
7537.0,3.7621428571428575
86.0,2.5207142857142855
4943.0,7.461428571428572
20731.0,2.3722222222222222
5972.0,4.517857142857143
6111.0,5.181666666666667
4870.0,3.3085714285714287
6184.0,5.425
38.0,4.864285714285714
17314.0,3.29
5968.0,5.8149999999999995
36.0,4.4975
4869.0,2.5745454545454547
31.0,4.242142857142857
6315.0,3.220714285714286
16.0,3.65
6108.0,2.9585714285714286
6206.0,6.723571428571428
4902.0,3.7464285714285714
6277.0,4.3549999999999995
6285.0,6.445
6128.0,2.858571428571429
158.0,7.320714285714286
56.0,3.545714285714286
6316.0,2.5949999999999998
17803.0,2.456
6365.0,2.5999999999999996
97.0,2.7636363636363637
6085.0,3.39
98.0,3.672857142857143
125.0,4.303076923076923
101.0,3.7821428571428575
6087.0,2.826363636363636
37.0,3.842142857142857
12277.0,2.5433333333333334
4944.0,6.75
10008.0,5.562857142857142
10838.0,2.6164285714285715
66.0,2.585
151.0,5.405714285714285
128.0,2.9661538461538464
17785.0,4.978571428571429
6318.0,2.670714285714286
5960.0,7.62
18621.0,3.2707142857142855
19630.0,3.0828571428571427
6076.0,2.6223076923076927
20767.0,3.6900000000000004
147.0,3.8328571428571427
130.0,3.3242857142857143
5914.0,2.5100000000000002
6250.0,3.3049999999999997
5930.0,2.4538461538461536
4920.0,2.3920000000000003
22425.0,2.721538461538462
6340.0,4.277857142857143
19294.0,3.7721428571428572
5901.0,3.245
34.0,7.39
14.0,2.1966666666666668
5913.0,4.0564285714285715
6142.0,4.410714285714286
6164.0,2.312727272727273
21238.0,3.8485714285714288
55.0,4.76
168.0,2.408333333333333
22406.0,1.987142857142857
19621.0,7.999285714285714
114.0,2.3259999999999996
6006.0,2.6341666666666668
11974.0,3.507142857142857
18647.0,2.8991666666666664
23.0,2.435
6378.0,5.212142857142857
22502.0,5.928571428571429
6172.0,4.059230769230769
5969.0,11.093571428571428
117.0,2.5907142857142857
6171.0,3.920714285714286
4905.0,4.235833333333333
12.0,3.1735714285714285
5921.0,3.233571428571429
15877.0,2.467142857142857
6237.0,5.359285714285714
10977.0,8.622142857142858
35.0,3.2950000000000004
163.0,2.7035714285714287
6319.0,4.036428571428571
10365.0,5.21
5999.0,5.14
5898.0,3.715
6220.0,3.9185714285714286
5918.0,3.287857142857143
7527.0,3.8835714285714285
19603.0,4.012142857142857
22413.0,2.6738461538461538
21237.0,6.857142857142857
43.0,3.1757142857142857
32703.0,4.466428571428572
18997.0,3.82
18352.0,3.86
23778.0,3.940714285714286
18204.0,4.510714285714285
22095.0,2.712142857142857
6301.0,3.6585714285714284
6067.0,2.9364285714285714
20756.0,2.428
5916.0,3.9892857142857143
81.0,2.1408333333333336
4937.0,2.6464285714285714
5967.0,2.82
4931.0,2.5892857142857144
6138.0,2.0963636363636367
6225.0,2.216666666666667
15.0,2.8021428571428575
5938.0,4.667857142857143
7557.0,3.823571428571429
4.0,6.172857142857143
17.0,3.190714285714286
6286.0,9.36357142857143
5943.0,2.5500000000000003
17730.0,5.515
6228.0,3.2808333333333337
15935.0,2.852727272727273
16197.0,2.463636363636364
17673.0,3.9050000000000002
44.0,3.205714285714286
11975.0,3.5892857142857144
12133.0,10.433571428571428
13.0,2.626923076923077
6284.0,10.486428571428572
135.0,3.3721428571428573
19588.0,2.462142857142857
18648.0,3.259230769230769
6127.0,2.6308333333333334
6211.0,3.3278571428571424
21242.0,4.784285714285715
16138.0,
Query:
-- Query 12: Get composition and percentile ranking for interest_id = 1
SELECT "month_year", "composition", "percentile_ranking"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "interest_id" = 1 
ORDER BY "month_year" 
LIMIT 1000
Answer:
month_year,composition,percentile_ranking
01-2019,2.38,81.81
02-2019,2.55,55.84
03-2019,2.76,78.52
04-2019,2.28,75.16
05-2019,1.68,56.01
07-2018,7.02,93.69
08-2018,3.44,85.53
08-2019,2.64,65.71
09-2018,2.44,74.1
10-2018,3.71,86.23
11-2018,2.79,86.64
12-2018,2.94,85.93
Query:
-- Query 13: Find months with highest composition values for each interest_id
SELECT "interest_id", "month_year", "composition"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" 
WHERE "composition" = (
  SELECT MAX("composition") 
  FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS sub 
  WHERE sub."interest_id" = "INTEREST_METRICS"."interest_id"
)
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,month_year,composition
32486.0,07-2018,11.89
6106.0,07-2018,9.93
18923.0,07-2018,10.85
6344.0,07-2018,10.32
100.0,07-2018,10.77
69.0,07-2018,10.82
79.0,07-2018,11.21
6111.0,07-2018,10.71
6214.0,07-2018,9.71
19422.0,07-2018,10.11
6110.0,07-2018,11.57
4895.0,07-2018,9.47
6217.0,07-2018,10.8
4.0,07-2018,13.97
6218.0,07-2018,9.29
6123.0,07-2018,9.49
171.0,07-2018,14.91
19613.0,07-2018,12.62
17.0,07-2018,7.89
6013.0,07-2018,9.35
4870.0,07-2018,10.29
19423.0,07-2018,12.22
6089.0,07-2018,6.97
161.0,07-2018,11.48
6286.0,07-2018,14.1
5991.0,07-2018,11.04
92.0,07-2018,9.77
6184.0,07-2018,13.35
19621.0,07-2018,11.61
63.0,07-2018,9.37
103.0,07-2018,6.61
38.0,07-2018,9.48
17786.0,07-2018,13.67
6232.0,07-2018,9.97
165.0,07-2018,6.05
18351.0,07-2018,6.09
15.0,07-2018,6.9
17314.0,07-2018,10.43
6151.0,07-2018,6.83
4914.0,07-2018,7.42
115.0,07-2018,11.68
5968.0,07-2018,12.87
36.0,07-2018,9.27
5943.0,07-2018,6.37
133.0,07-2018,10.91
1.0,07-2018,7.02
114.0,07-2018,6.25
6107.0,07-2018,8.84
150.0,07-2018,5.3
96.0,07-2018,7.21
22403.0,07-2018,12.27
40.0,07-2018,10.86
19758.0,07-2018,6.28
17730.0,07-2018,11.38
5938.0,07-2018,11.63
4869.0,07-2018,6.47
4897.0,07-2018,12.93
31.0,07-2018,7.9
16137.0,07-2018,9.65
6330.0,07-2018,6.82
6334.0,07-2018,11.63
6315.0,07-2018,8.14
4852.0,07-2018,6.77
16.0,07-2018,6.24
6108.0,07-2018,6.65
6206.0,07-2018,10.76
6006.0,07-2018,6.26
6228.0,07-2018,10.22
20768.0,07-2018,6.53
4902.0,07-2018,8.17
6277.0,07-2018,11.72
19757.0,07-2018,10.95
4911.0,07-2018,6.87
4910.0,07-2018,6.09
6285.0,07-2018,9.97
11974.0,07-2018,7.19
6219.0,07-2018,6.37
10250.0,07-2018,11.4
6128.0,07-2018,6.28
5946.0,07-2018,5.99
15935.0,07-2018,9.13
4855.0,07-2018,5.99
149.0,07-2018,6.88
16197.0,07-2018,6.13
4913.0,07-2018,6.76
56.0,07-2018,7.09
6341.0,07-2018,5.68
6316.0,07-2018,6.52
18647.0,07-2018,6.45
17803.0,07-2018,6.21
23.0,07-2018,5.41
132.0,07-2018,7.48
6365.0,07-2018,6.45
6378.0,07-2018,9.64
17673.0,07-2018,8.07
97.0,07-2018,6.41
7537.0,07-2018,7.82
20764.0,07-2018,5.85
44.0,07-2018,6.11
5.0,07-2018,10.82
19.0,07-2018,6.57
93.0,07-2018,7.08
6085.0,07-2018,7.08
6112.0,07-2018,9.22
11975.0,07-2018,7.81
22502.0,07-2018,8.24
86.0,07-2018,6.13
19610.0,07-2018,7.56
20753.0,07-2018,5.79
24.0,07-2018,6.54
20750.0,07-2018,5.87
6141.0,07-2018,6.34
98.0,07-2018,7.64
125.0,07-2018,6.38
17269.0,07-2018,8.64
18996.0,07-2018,7.84
13.0,07-2018,6.72
169.0,07-2018,6.1
101.0,07-2018,7.38
6087.0,07-2018,5.41
104.0,07-2018,5.42
6284.0,07-2018,18.82
7557.0,07-2018,8.17
37.0,07-2018,7.82
6084.0,07-2018,6.97
8.0,07-2018,6.67
39.0,07-2018,17.44
117.0,07-2018,6.49
22427.0,07-2018,8.04
85.0,07-2018,6.46
5952.0,07-2018,7.11
164.0,07-2018,6.14
19587.0,07-2018,5.85
33.0,07-2018,7.6
135.0,07-2018,7.01
19588.0,07-2018,5.87
17320.0,07-2018,3.98
77.0,07-2018,17.19
18648.0,07-2018,7.1
5989.0,07-2018,5.57
138.0,07-2018,7.3
137.0,07-2018,7.94
4940.0,07-2018,5.89
12277.0,07-2018,6.2
4909.0,07-2018,7.01
10008.0,07-2018,9.46
6299.0,07-2018,5.71
20731.0,07-2018,5.86
10838.0,07-2018,6.8
111.0,07-2018,7.42
6127.0,07-2018,5.96
6304.0,07-2018,8.31
61.0,07-2018,6.59
6211.0,07-2018,8.09
66.0,07-2018,6.51
6182.0,07-2018,6.57
151.0,07-2018,7.97
3.0,07-2018,6.14
10976.0,07-2018,8.16
18646.0,07-2018,6.85
21242.0,07-2018,7.36
7453.0,07-2018,6.45
6162.0,07-2018,6.32
128.0,07-2018,6.5
6171.0,07-2018,8.19
131.0,07-2018,5.09
21293.0,07-2018,7.28
7461.0,07-2018,7.0
17785.0,07-2018,7.66
10839.0,07-2018,5.59
4912.0,07-2018,7.77
6318.0,07-2018,6.65
7605.0,07-2018,6.82
4905.0,07-2018,5.66
6023.0,07-2018,8.02
16138.0,07-2018,8.81
18621.0,07-2018,7.31
4861.0,07-2018,5.29
12.0,07-2018,7.23
90.0,07-2018,5.91
19630.0,07-2018,7.15
6278.0,07-2018,6.18
70.0,07-2018,6.96
19579.0,07-2018,6.24
6329.0,07-2018,7.63
5970.0,07-2018,9.21
4907.0,07-2018,6.26
6076.0,07-2018,5.75
18490.0,07-2018,7.09
20767.0,07-2018,7.73
147.0,07-2018,6.17
10837.0,07-2018,7.48
130.0,07-2018,7.66
5914.0,07-2018,6.4
6144.0,07-2018,6.61
88.0,07-2018,4.99
6255.0,07-2018,7.55
27.0,07-2018,6.81
6336.0,07-2018,8.5
5921.0,07-2018,7.37
19879.0,07-2018,6.95
15877.0,07-2018,5.77
148.0,07-2018,5.49
32704.0,07-2018,8.04
6062.0,07-2018,7.33
4915.0,07-2018,6.28
6133.0,07-2018,3.82
6250.0,07-2018,5.54
6143.0,07-2018,5.47
49.0,07-2018,5.09
6173.0,07-2018,7.66
75.0,07-2018,7.23
19614.0,07-2018,5.57
18781.0,07-2018,6.56
4848.0,07-2018,6.49
6237.0,07-2018,7.7
19760.0,07-2018,5.36
5930.0,07-2018,6.17
6302.0,07-2018,7.41
13496.0,07-2018,6.78
4920.0,07-2018,5.93
6115.0,07-2018,6.67
22425.0,07-2018,6.41
73.0,07-2018,7.06
22096.0,07-2018,6.56
6337.0,07-2018,7.02
6265.0,07-2018,7.31
19295.0,07-2018,8.44
18347.0,07-2018,7.8
6207.0,07-2018,7.81
18350.0,07-2018,6.85
6064.0,07-2018,7.02
18622.0,07-2018,7.44
6181.0,07-2018,6.11
6148.0,07-2018,7.13
6045.0,07-2018,7.42
6298.0,07-2018,5.38
6145.0,07-2018,6.1
22.0,07-2018,6.26
12132.0,07-2018,7.12
4918.0,07-2018,6.29
17671.0,07-2018,5.65
5906.0,07-2018,7.69
35.0,07-2018,5.25
6340.0,07-2018,7.44
21292.0,07-2018,7.19
19294.0,07-2018,7.22
163.0,07-2018,6.4
82.0,07-2018,9.99
13498.0,07-2018,6.4
Query:
SELECT "interest_id", "month_year", "composition"
FROM (
    SELECT "interest_id", "month_year", "composition",
        RANK() OVER (PARTITION BY "interest_id" ORDER BY "composition" DESC) AS comp_rank
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS"
) sub
WHERE comp_rank = 1
LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,month_year,composition
6345.0,07-2018,3.94
39642.0,08-2019,2.99
38992.0,02-2019,4.55
43547.0,02-2019,2.79
18807.0,07-2018,4.1
19578.0,07-2018,4.14
6006.0,07-2018,6.26
4917.0,07-2018,6.1
45669.0,08-2019,2.56
142.0,07-2018,4.73
7483.0,07-2018,3.4
7546.0,07-2018,4.72
46134.0,03-2019,3.09
153.0,07-2018,5.08
10351.0,08-2018,5.87
5926.0,10-2018,4.3
12821.0,08-2018,5.18
42399.0,03-2019,2.27
40434.0,02-2019,3.48
6215.0,10-2018,3.81
6145.0,07-2018,6.1
6389.0,07-2018,3.39
44491.0,02-2019,2.8
51678.0,08-2019,2.26
6210.0,07-2018,6.09
170.0,07-2018,4.76
34639.0,08-2019,2.49
44449.0,02-2019,2.68
5960.0,10-2018,10.61
7543.0,07-2018,4.12
147.0,07-2018,6.17
22093.0,07-2018,4.34
43546.0,02-2019,3.5
18997.0,10-2018,6.05
6010.0,07-2018,2.76
83.0,10-2018,4.64
20816.0,07-2018,2.79
18621.0,07-2018,7.31
6051.0,07-2018,5.31
4859.0,07-2018,6.48
13421.0,07-2018,7.15
51120.0,08-2019,3.45
39652.0,02-2019,3.33
5907.0,07-2018,7.12
95.0,07-2018,7.15
5910.0,07-2018,5.22
5910.0,10-2018,5.22
4943.0,10-2018,10.7
37.0,07-2018,7.82
41853.0,02-2019,2.95
39648.0,08-2019,2.97
6303.0,10-2018,7.13
6081.0,07-2018,5.92
4872.0,10-2018,2.61
64.0,12-2018,12.41
46132.0,03-2019,2.57
37165.0,03-2019,2.65
7535.0,02-2019,7.4
80.0,07-2018,4.47
44390.0,08-2019,2.61
17730.0,07-2018,11.38
45662.0,02-2019,3.66
51.0,07-2018,2.67
74.0,07-2018,7.37
34951.0,09-2018,1.61
37412.0,10-2018,1.94
7541.0,02-2019,9.98
43540.0,02-2019,3.08
19622.0,07-2018,2.97
6183.0,07-2018,6.71
49502.0,08-2019,2.71
19628.0,07-2018,4.66
41062.0,08-2019,2.54
4906.0,07-2018,3.09
6141.0,07-2018,6.34
44378.0,03-2019,3.67
6.0,10-2018,12.56
6156.0,07-2018,2.99
85.0,07-2018,6.46
116.0,07-2018,6.31
135.0,07-2018,7.01
92.0,07-2018,9.77
39195.0,12-2018,2.35
44479.0,02-2019,3.5
12032.0,07-2018,3.77
24.0,07-2018,6.54
40194.0,08-2019,2.48
48022.0,08-2019,2.16
38991.0,02-2019,3.12
6250.0,07-2018,5.54
10974.0,11-2018,5.5
6285.0,07-2018,9.97
37879.0,10-2018,4.25
37423.0,10-2018,6.7
97.0,07-2018,6.41
125.0,07-2018,6.38
148.0,07-2018,5.49
4930.0,07-2018,4.37
18351.0,07-2018,6.09
45673.0,08-2019,3.54
133.0,07-2018,10.91
36871.0,10-2018,3.73
56.0,07-2018,7.09
5906.0,07-2018,7.69
6084.0,07-2018,6.97
6164.0,07-2018,5.37
41079.0,02-2019,3.15
7464.0,07-2018,3.52
6134.0,07-2018,5.08
20755.0,07-2018,4.77
40183.0,12-2018,5.06
44386.0,02-2019,2.56
44386.0,08-2019,2.56
7557.0,07-2018,8.17
41054.0,08-2019,2.95
41194.0,08-2019,2.33
17669.0,08-2018,4.09
39330.0,08-2019,2.58
19618.0,08-2018,3.13
46566.0,03-2019,2.79
7540.0,03-2019,7.8
6265.0,07-2018,7.31
108.0,07-2018,4.24
36883.0,02-2019,3.27
19624.0,10-2018,3.15
40694.0,02-2019,2.06
10010.0,08-2019,3.26
138.0,07-2018,7.3
6064.0,07-2018,7.02
21243.0,10-2018,3.67
44584.0,02-2019,3.26
16138.0,07-2018,8.81
49978.0,08-2019,2.63
40692.0,03-2019,3.08
44485.0,02-2019,2.59
17.0,07-2018,7.89
44478.0,02-2019,3.67
6133.0,07-2018,3.82
102.0,07-2018,7.74
53.0,07-2018,3.03
4896.0,08-2018,3.47
37883.0,11-2018,4.19
35.0,07-2018,5.25
4916.0,07-2018,4.29
44467.0,08-2019,2.4
33191.0,10-2018,4.39
6237.0,07-2018,7.7
6277.0,07-2018,11.72
45677.0,02-2019,4.52
4935.0,07-2018,4.46
39658.0,03-2019,2.99
49975.0,08-2019,2.83
19632.0,08-2019,2.22
19617.0,02-2019,8.09
40698.0,03-2019,3.57
37419.0,10-2018,3.7
104.0,07-2018,5.42
19599.0,03-2019,1.97
34461.0,02-2019,3.52
22425.0,07-2018,6.41
38995.0,12-2018,5.59
49974.0,08-2019,2.76
6220.0,07-2018,7.59
10251.0,07-2018,3.21
6048.0,07-2018,2.49
33970.0,08-2019,2.47
18783.0,10-2018,9.83
10326.0,10-2018,6.45
40688.0,12-2018,3.19
6098.0,07-2018,3.99
44472.0,03-2019,3.26
6255.0,07-2018,7.55
19759.0,07-2018,3.23
17269.0,07-2018,8.64
126.0,10-2018,6.67
41055.0,02-2019,3.91
5945.0,07-2018,4.87
5946.0,07-2018,5.99
42401.0,08-2019,1.66
40687.0,08-2019,2.25
6149.0,07-2018,4.1
22424.0,07-2018,6.05
41059.0,08-2019,2.59
45670.0,02-2019,5.04
15877.0,07-2018,5.77
19.0,07-2018,6.57
86.0,07-2018,6.13
6315.0,07-2018,8.14
41.0,07-2018,6.96
21238.0,10-2018,5.15
40702.0,08-2019,2.61
12820.0,10-2018,6.26
10007.0,07-2018,2.45
22406.0,07-2018,3.38
6189.0,07-2018,3.03
6214.0,07-2018,9.71
18646.0,07-2018,6.85
3.0,07-2018,6.14
6364.0,08-2018,3.09
33474.0,08-2018,4.01
22398.0,07-2018,3.52
41066.0,02-2019,2.83
34077.0,08-2018,4.52
128.0,07-2018,6.5
10249.0,07-2018,4.48
41065.0,02-2019,2.87
6122.0,11-2018,3.05
7461.0,07-2018,7.0
20750.0,07-2018,5.87
42237.0,03-2019,3.02
42237.0,08-2019,3.02
36860.0,10-2018,5.17
18350.0,07-2018,6.85
44483.0,02-2019,2.29
40192.0,11-2018,3.04
40192.0,03-2019,3.04
40192.0,08-2019,3.04
36881.0,10-2018,2.33
6089.0,07-2018,6.97
19758.0,07-2018,6.28
39190.0,11-2018,2.54
21326.0,07-2018,4.3
34081.0,08-2019,2.48
22401.0,07-2018,3.62
7536.0,02-2019,5.84
6229.0,07-2018,7.2
6173.0,07-2018,7.66
5925.0,10-2018,7.67
41083.0,03-2019,3.57
4869.0,07-2018,6.47
39193.0,02-2019,3.5
6112.0,07-2018,9.22
44384.0,02-2019,2.55
36020.0,10-2018,5.83
5971.0,10-2018,2.58
6259.0,07-2018,2.51
34465.0,08-2018,3.34
139.0,07-2018,6.87
39331.0,08-2019,2.69
33958.0,08-2018,1.88
44468.0,02-2019,4.02
141.0,10-2018,9.46
4940.0,07-2018,5.89
12025.0,07-2018,8.45
23778.0,08-2018,5.52
1
Query:
-- Corrected Query 15: List interest categories with their summaries
SELECT "id", "interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP"
LIMIT 1000
Answer:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
110,Pain Management Researchers
111,Retirement Planners
112,Auto Repair Researchers
113,Avid Readers
114,Womens Fashion Magazine Readers
115,Mens Shoe Shoppers
116,Home Security Shoppers
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
121,Coders & Developers
123,Military Servicemembers & Veterans
124,Healthcare Discount Shoppers
125,Postal Employees
126,Soccer Fans
128,Kitchen & Bathroom Remodelers
129,Aftermarket Accessories Shoppers
130,Automotive Safety Researchers
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
134,Home Printer Shoppers
135,Major Appliance Shoppers
136,Tablet Researchers
137,Online Alcohol Shoppers
138,Home Kitchen Bakers
139,Makeup Researchers
140,Pet Owners
141,Skin Care Researchers
142,Credit Card Researchers
143,Health Insurance Researchers
145,Property Insurance Researchers
146,Audio Equipment Researchers
147,Broadway Fans
148,Celebrity Gossip Fans
149,Streaming Radio Listeners
150,TV Junkies
151,Big & Tall Men
153,Phone Accessory Shoppers
154,Prepaid Smartphone Shoppers
155,Business Travelers
157,Car Rental Shoppers
158,Flight and Hotel Shoppers
160,Sightseeing Travelers
161,Travel Reward Points Enthusiasts
162,Retirees
163,Federal Employees
164,Conservative News Readers
165,Liberal News Readers
166,Doves
168,Social Conservatives
169,Social Liberals
170,Voters
171,Shoe Shoppers
4847,Readers of Hispanic Content
4848,Working Parents
4852,Health & Fitness
4855,Entertainment & Tabloid Magazine Readers
4857,Business Accounting Software Researchers
4858,Business Filing Researchers
4859,Business Logistics Managers
4861,IT Decision Makers
4866,Small Business Employees
4867,Sweepstakes Enthusiasts
4869,Womens Fitness Enthusiasts
4870,Tech-Savvy Moms
4872,Readers of Mexican Content
4873,TV Game Show Fans
4894,Credit Union Researchers
4895,Mature Parents
4896,Streaming Music Enthusiasts
4897,Parents of Teenagers Going to College
4898,Cosmetics and Beauty Shoppers
4899,Readers of Japanese Content
4902,Yogis
4903,Asthma Sufferers
4904,Adult Acne Sufferers
4905,Heartburn Sufferers
4906,Sinus Researchers
4907,Headache and Migraine Sufferers
4908,Back Pain Sufferers
4909,First Aid Researchers
4910,Cholesterol Researchers
4911,Dieters
4912,Vitamin Shoppers
4913,Womens Health Researchers
4914,Mens Health Researchers
4915,Food Allergies Researchers
4916,Arthritis Sufferers
4917,Teen Content Readers
4918,Gastrointestinal Researchers
4919,Military Families
4920,LGBT Activists
4921,Tire Shoppers
4924,Surfers
4925,Gun Control Advocates
4926,Gun Rights Advocates
4927,Immigration Rights Advocates
4928,Immigration Control Advocates
4929,Right Wing Radicals
4930,Occupy Movement Supporters
4931,Marijua
End Exploring Related Columns
Task: Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Time,Interest Name,Composition Value
MM-YYYY:str,interest_name:str,value:float
...
```

To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would:

1. **Determine the Maximum Composition for Each Interest Category**: For each `interest_id` in the `INTEREST_METRICS` table, find the record with the highest `composition` value and note the corresponding `month_year`.

2. **Associate Interest Names**: Join these records with the `INTEREST_MAP` table on `interest_id` (from `INTEREST_METRICS`) and `id` (from `INTEREST_MAP`) to retrieve the `interest_name`.

3. **Select Top and Bottom Categories**: Order the results by the maximum `composition` value in descending order to identify the top 10 categories and in ascending order for the bottom 10 categories.

4. **Compile the Results**: For each of these categories, display the `Time` (in `MM-YYYY` format from `month_year`), `Interest Name`, and `Composition Value`.

**Note**: Without actual data, we list the expected column names and data types. The `...` indicates additional rows for the remaining categories..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 19:09:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:09:29 - root - INFO - ```sql
WITH MaxComposition AS (
    SELECT im."interest_name", m."interest_id", m."composition", m."month_year",
           RANK() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS comp_rank
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
    ON im."id" = m."interest_id"
),
MaxCompPerInterest AS (
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM MaxComposition
    WHERE comp_rank = 1
),
Combined AS (
    SELECT "interest_id", "interest_name", "composition", "month_year",
           ROW_NUMBER() OVER (ORDER BY "composition" DESC, "interest_id") AS rn_desc,
           ROW_NUMBER() OVER (ORDER BY "composition" ASC, "interest_id") AS rn_asc
    FROM MaxCompPerInterest
),
TopBottom10 AS (
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM Combined
    WHERE rn_desc <= 10
    UNION ALL
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM Combined
    WHERE rn_asc <= 10
)
SELECT "month_year" AS "Time", 
       "interest_name" AS "Interest Name", 
       "composition" AS "Composition Value"
FROM TopBottom10
ORDER BY "Composition Value" DESC, "Interest Name";
```
2025-01-20 19:09:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:09:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:09:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:09:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:09:30 - snowflake.connector.connection - INFO - closed
2025-01-20 19:09:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:09:31 - root - INFO - itercount: 1
2025-01-20 19:09:31 - root - INFO - 0
2025-01-20 19:09:31 - root - INFO - results: 
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57


2025-01-20 19:09:31 - root - INFO - Please check the answer again by reviewing Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Time,Interest Name,Composition Value
MM-YYYY:str,interest_name:str,value:float
...
```

To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would:

1. **Determine the Maximum Composition for Each Interest Category**: For each `interest_id` in the `INTEREST_METRICS` table, find the record with the highest `composition` value and note the corresponding `month_year`.

2. **Associate Interest Names**: Join these records with the `INTEREST_MAP` table on `interest_id` (from `INTEREST_METRICS`) and `id` (from `INTEREST_MAP`) to retrieve the `interest_name`.

3. **Select Top and Bottom Categories**: Order the results by the maximum `composition` value in descending order to identify the top 10 categories and in ascending order for the bottom 10 categories.

4. **Compile the Results**: For each of these categories, display the `Time` (in `MM-YYYY` format from `month_year`), `Interest Name`, and `Composition Value`.

**Note**: Without actual data, we list the expected column names and data types. The `...` indicates additional rows for the remaining categories. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Current sql:
WITH MaxComposition AS (
    SELECT im."interest_name", m."interest_id", m."composition", m."month_year",
           RANK() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS comp_rank
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
    ON im."id" = m."interest_id"
),
MaxCompPerInterest AS (
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM MaxComposition
    WHERE comp_rank = 1
),
Combined AS (
    SELECT "interest_id", "interest_name", "composition", "month_year",
           ROW_NUMBER() OVER (ORDER BY "composition" DESC, "interest_id") AS rn_desc,
           ROW_NUMBER() OVER (ORDER BY "composition" ASC, "interest_id") AS rn_asc
    FROM MaxCompPerInterest
),
TopBottom10 AS (
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM Combined
    WHERE rn_desc <= 10
    UNION ALL
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM Combined
    WHERE rn_asc <= 10
)
SELECT "month_year" AS "Time", 
       "interest_name" AS "Interest Name", 
       "composition" AS "Composition Value"
FROM TopBottom10
ORDER BY "Composition Value" DESC, "Interest Name";For tasks asking fullname or name, you may combine first name and last name into one column called name.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-20 19:10:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:10:08 - root - INFO - ```sql
WITH MaxComposition AS (
    SELECT im."interest_name", m."interest_id", m."composition", m."month_year",
           RANK() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS comp_rank
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" AS im
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" AS m
    ON im."id" = m."interest_id"
),
MaxCompPerInterest AS (
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM MaxComposition
    WHERE comp_rank = 1
),
Combined AS (
    SELECT "interest_id", "interest_name", "composition", "month_year",
           ROW_NUMBER() OVER (ORDER BY "composition" DESC NULLS LAST, "interest_id") AS rn_desc,
           ROW_NUMBER() OVER (ORDER BY "composition" ASC NULLS LAST, "interest_id") AS rn_asc
    FROM MaxCompPerInterest
),
TopBottom10 AS (
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM Combined
    WHERE rn_desc <= 10
    UNION ALL
    SELECT "interest_id", "interest_name", "composition", "month_year"
    FROM Combined
    WHERE rn_asc <= 10
)
SELECT "month_year" AS "Time", 
       "interest_name" AS "Interest Name", 
       ROUND("composition", 4) AS "Composition Value"
FROM TopBottom10
ORDER BY "Composition Value" DESC NULLS LAST, "Interest Name";
```
2025-01-20 19:10:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:10:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:10:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:10:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:10:09 - snowflake.connector.connection - INFO - closed
2025-01-20 19:10:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:10:10 - root - INFO - itercount: 2
2025-01-20 19:10:10 - root - INFO - 0
2025-01-20 19:10:10 - root - INFO - Total iteration counts: 2
