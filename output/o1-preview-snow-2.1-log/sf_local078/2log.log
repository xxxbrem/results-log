2025-01-20 19:05:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.410669 seconds
2025-01-20 19:06:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:06:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:44 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:44 - root - INFO - SQL:
SELECT DISTINCT im."id", im."interest_name"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
    LIMIT 1000;
Results:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
15,NBA Fans
16,NCAA Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
29,College Students
35,Mens Clothing Shoppers
42,Fast Fashion Shoppers
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
53,Hip Hop Fans
81,Republicans
90,Coupon Researchers
101,Flower & Gift Basket Shoppers
113,Avid Readers
126,Soccer Fans
163,Federal Employees
4852,Health & Fitness
4937,Evangelical Christians
5943,Financial News Readers
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
54,Online Investors
55,Seasonal Allergy Sufferers
60,Online Health Researchers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
71,Lawn & Garden Enthusiasts
79,Luxury Travel Researchers
80,Democrats
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
93,Young Boomers
102,Plus Size Women
103,Live Concert Fans
107,Cruise Travel Intenders
109,Joint Pain Sufferers
114,Womens Fashion Magazine Readers
123,Military Servicemembers & Veterans
138,Home Kitchen Bakers
4911,Dieters
106,Comedy Fans
136,Tablet Researchers
4859,Business Logistics Managers
4919,Military Families
5936,Fishing Enthusiasts
6214,Home Remodelers
17,MLB Fans
21,DIYers
22,Grill Masters
28,Teachers
36,Baby Products Buyers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
43,Apartment Hunters
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
61,Beauty & Skincare Buyers
85,Online Movie Downloaders
92,Parents with Kids
104,Country Music Fans
110,Pain Management Researchers
121,Coders & Developers
155,Business Travelers
164,Conservative News Readers
168,Social Conservatives
4896,Streaming Music Enthusiasts
34,Teen Girl Clothing Shoppers
50,Discount Big Box Shoppers
56,Discount Device Shoppers
65,Hands-On Parents
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
72,Nurses
74,Office Supply Shoppers
83,Hardware Shoppers
86,Sale Seekers
87,Theme Park Researchers
95,Stay-at-Home Parents
97,Home Kitchen Chefs
100,Nutrition Conscious Eaters
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
124,Healthcare Discount Shoppers
125,Postal Employees
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
139,Makeup Researchers
140,Pet Owners
143,Health Insurance Researchers
146,Audio Equipment Researchers
154,Prepaid Smartphone Shoppers
162,Retirees
4847,Readers of Hispanic Content
4861,IT Decision Makers
4897,Parents of Teenagers Going to College
4899,Readers of Japanese Content
4903,Asthma Sufferers
4909,First Aid Researchers
4912,Vitamin Shoppers
4914,Mens Health Researchers
5916,Shared Work Space Researchers
5924,Cloud Security Researchers
5926,Readers of Data Scientist blogs
5958,Flooring Shoppers
37,Jewelry & Watch Shoppers
48,Charitable Donors
77,Luxury Retail Shoppers
82,HDTV Researchers
116,Home Security Shoppers
134,Home Printer Shoppers
141,Skin Care Researchers
145,Property Insurance Researchers
148,Celebrity Gossip Fans
151,Big & Tall Men
165,Liberal News Readers
166,Doves
4848,Working Parents
4858,Business Filing Researchers
4898,Cosmetics and Beauty Shoppers
4902,Yogis
4906,Sinus Researchers
4920,LGBT Activists
4930,Occupy Movement Supporters
4931,Marijuana Legalization Advocates
5896,Orthopedic Health Researchers
5909,Web Design Researchers
5911,Credit Score Researchers
5917,Caribbean Trip Planners
5918,Enterprise Field Services Researchers
5922,Software Directory Researchers
5938,Costa Rica Trip Planners
5944,Financial Advisors
5946,Readers of Filipinos Content
5956,Recreational Sports Participants
5957,Online Education Intenders
5960,New Zealand Trip Planners
4867,Sweepstakes Enthusiasts
4921,Tire Shoppers
4936,Liberal Think Tank Readers
5929,Employee Management & HR Researchers
5972,Financial Investors
5984,Readers of Indian Content
5999,Readers of African American Content
6029,Indoor Cycling & Spinning Enthusiasts
6045,Engagement Ring Shoppers
6051,Readers of Italian Content
6081,Hawaii Trip Planners
6089,Mens Fitness Publication Readers
6095,Nursing Students
6107,Ski House Second Home Owners
6110,Apartment Furniture Shoppers
6120,Readers of Puerto Rican Content
6127,LED Lighting Shoppers
6149,Readers of Jewish News
6164,Microsoft Friendly Developers
6230,Vegans
6237,Non-Profit Volunteers
6298,Readers of Russian Content
6341,Pharmacy Shoppers
6386,Powerboat Purchasers
7453,Pilots
7598,Readers of South American Content
10839,Tampa and St Petersburg Trip Planners
13498,Restaurant News Readers
16197,Financial Business Intelligence Researchers
49,NHL Fans
66,Fantasy & Comic Fans
73,Mailing & Shipping Shoppers
115,Mens Shoe Shoppers
4935,Conservative Think Tank Readers
14,NFL Fans
27,Auto In

2025-01-20 19:06:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:45 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:46 - root - INFO - SQL:
SELECT m."interest_id", m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.

2025-01-20 19:06:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-20 19:06:47 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:48 - root - INFO - SQL:
SELECT DISTINCT m."month_year"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    LIMIT 1000;
Results:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019

2025-01-20 19:06:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:49 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:50 - root - INFO - SQL:
SELECT m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    ORDER BY m."composition" DESC
    LIMIT 1000;
Results:
Too long, hard cut:
composition
21.2
20.28
19.45
18.99
18.82
18.39
18.18
17.44
17.19
15.15
15.05
14.92
14.92
14.91
14.39
14.29
14.23
14.15
14.1
13.97
13.9
13.81
13.67
13.64
13.35
13.03
12.93
12.87
12.85
12.8
12.73
12.68
12.64
12.64
12.62
12.62
12.56
12.47
12.42
12.41
12.41
12.33
12.3
12.27
12.26
12.22
12.16
12.03
11.99
11.97
11.93
11.93
11.89
11.75
11.74
11.74
11.73
11.72
11.71
11.68
11.63
11.63
11.61
11.57
11.57
11.5
11.48
11.4
11.38
11.27
11.23
11.21
11.18
11.15
11.14
11.1
11.08
11.06
11.06
11.04
11.03
11.01
11.0
10.99
10.99
10.96
10.95
10.95
10.91
10.91
10.89
10.88
10.86
10.85
10.85
10.82
10.82
10.8
10.79
10.77
10.76
10.71
10.7
10.69
10.62
10.61
10.61
10.61
10.57
10.54
10.52
10.52
10.51
10.5
10.48
10.46
10.43
10.43
10.42
10.4
10.38
10.36
10.32
10.31
10.3
10.29
10.28
10.27
10.26
10.24
10.23
10.22
10.15
10.14
10.12
10.11
10.09
10.08
10.07
10.06
10.05
10.05
10.04
10.0
9.99
9.99
9.98
9.97
9.97
9.97
9.96
9.95
9.93
9.93
9.91
9.91
9.88
9.86
9.85
9.85
9.83
9.82
9.81
9.79
9.77
9.76
9.72
9.71
9.7
9.67
9.66
9.65
9.65
9.65
9.64
9.63
9.62
9.61
9.6
9.6
9.57
9.57
9.55
9.51
9.49
9.48
9.48
9.47
9.46
9.46
9.46
9.46
9.43
9.43
9.43
9.37
9.35
9.34
9.33
9.33
9.31
9.31
9.3
9.3
9.29
9.27
9.25
9.25
9.24
9.23
9.23
9.23
9.22
9.21
9.2
9.19
9.18
9.18
9.15
9.13
9.13
9.12
9.11
9.1
9.1
9.08
9.08
9.06
9.06
9.06
9.04
9.04
9.03
8.98
8.98
8.97
8.96
8.96
8.95
8.94
8.91
8.9
8.87
8.85
8.84
8.84
8.82
8.81
8.81
8.8
8.77
8.72
8.7
8.69
8.69
8.67
8.66
8.66
8.65
8.64
8.62
8.62
8.59
8.59
8.58
8.56
8.55
8.54
8.51
8.5
8.5
8.5
8.49
8.48
8.48
8.47
8.46
8.46
8.46
8.45
8.45
8.44
8.44
8.44
8.43
8.43
8.43
8.41
8.41
8.38
8.37
8.36
8.35
8.32
8.32
8.32
8.31
8.31
8.31
8.3
8.29
8.29
8.28
8.28
8.28
8.27
8.26
8.25
8.25
8.25
8.24
8.23
8.23
8.22
8.21
8.19
8.17
8.17
8.17
8.17
8.16
8.15
8.14
8.14
8.12
8.12
8.1
8.1
8.09
8.09
8.07
8.04
8.04
8.02
8.02
7.99
7.98
7.97
7.95
7.94
7.94
7.93
7.93
7.93
7.92
7.92
7.9
7.9
7.9
7.9
7.89
7.89
7.88
7.88
7.88
7.87
7.87
7.86
7.85
7.85
7.85
7.84
7.83
7.82
7.82
7.81
7.81
7.81
7.8
7.8
7.8
7.79
7.77
7.77
7.76
7.74
7.74
7.74
7.73
7.73
7.73
7.73
7.72
7.72
7.7
7.7
7.7
7.69
7.69
7.69
7.68
7.68
7.68
7.68
7.67
7.67
7.67
7.66
7.66
7.66
7.66
7.65
7.64
7.64
7.64
7.64
7.63
7.63
7.61
7.6
7.6
7.6
7.59
7.56
7.56
7.56
7.56
7.55
7.54
7.53
7.51
7.51
7.5
7.5
7.49
7.49
7.49
7.48
7.48
7.48
7.47
7.47
7.46
7.46
7.46
7.45
7.45
7.45
7.45
7.45
7.44
7.44
7.43
7.43
7.43
7.42
7.42
7.42
7.42
7.41
7.41
7.41
7.4
7.4
7.39
7.39
7.38
7.38
7.38
7.37
7.37
7.37
7.36
7.36
7.35
7.34
7.34
7.33
7.33
7.32
7.31
7.31
7.31
7.3
7.3
7.3
7.29
7.28
7.28
7.28
7.28
7.27
7.26
7.26
7.26
7.26
7.25
7.25
7.25
7.24
7.24
7.23
7.23
7.23
7.23
7.23
7.23
7.22
7.22
7.21
7.21
7.21
7.21
7.21
7.2
7.2
7.19
7.19
7.19
7.19
7.19
7.19
7.18
7.18
7.18
7.17
7.17
7.16
7.16
7.15
7.15
7.15
7.15
7.15
7.13
7.13
7.13
7.13
7.13
7.12
7.12
7.12
7.12
7.11
7.11
7.11
7.1
7.1
7.1
7.09
7.09
7.09
7.08
7.08
7.08
7.08
7.07
7.07
7.06
7.06
7.06
7.06
7.05
7.05
7.04
7.04
7.04
7.04
7.03
7.02
7.02
7.02
7.02
7.02
7.01
7.01
7.01
7.01
7.01
7.0
7.0
7.0
7.0
7.0
6.99
6.99
6.99
6.97
6.97
6.97
6.96
6.96
6.96
6.96
6.96
6.95
6.95
6.95
6.95
6.95
6.94
6.94
6.93
6.93
6.93
6.92
6.92
6.92
6.92
6.92
6.9
6.9
6.88
6.88
6.88
6.88
6.88
6.88
6.88
6.87
6.87
6.86
6.86
6.86
6.85
6.85
6.85
6.85
6.85
6.84
6.84
6.83
6.83
6.83
6.82
6.82
6.82
6.82
6.81
6.81
6.81
6.8
6.8
6.8
6.8
6.8
6.8
6.79
6.79
6.78
6.77
6.77
6.77
6.77
6.77
6.76
6.76
6.76
6.76
6.76
6.76
6.75
6.75
6.75
6.75
6.73
6.73
6.73
6.73
6.72
6.72
6.72
6.71
6.71
6.71
6.71
6.71
6.7
6.7
6.7
6.7
6.7
6.7
6.7
6.69
6.69
6.69
6.68
6.68
6.67
6.67
6.67
6.67
6.67
6.67
6.67
6.67
6.66
6.66
6.66
6.66
6.66
6.65
6.65
6.65
6.65
6.64
6.64
6.64
6.64
6.64
6.63
6.63
6.63
6.63
6.62
6.62
6.62
6.62
6.61
6.61
6.61
6.61
6.61
6.61
6.61
6.61
6.6
6.6
6.6
6.6
6.59
6.59
6.59
6.59
6.59
6.59
6.59
6.59
6.59
6.58
6.58
6.58
6.58
6.58
6.57
6.57
6.57
6.57
6.57
6.57
6.56
6.56
6.56
6.56
6.56
6.56
6.55
6.55
6.55
6.55
6.54
6.54
6.54
6.54
6.53
6.53
6.53
6.53
6.52
6.52
6.52
6.52
6.52
6.52
6.51
6.51
6.51
6.51
6.51
6.5
6.5
6.5
6.5
6.49
6.49
6.49
6.49
6.49
6.49
6.49
6.48
6.48
6.48
6.48
6.48
6.47
6.47
6.47
6.46
6.46
6.46
6.45
6.45
6.45
6.45
6.45
6.45
6.44
6.44
6.44
6.44
6.43
6.43
6.43
6.43
6.42
6.41
6.41
6.41
6.41
6.41
6.41
6.41
6.4
6.4
6.4
6.4
6.4
6.39
6.39
6.39
6.39
6.39
6.39
6.38
6.37
6.37
6.37
6.37
6.37
6.36
6.36
6.36
6.35
6.35
6.34
6.34
6.34
6.34
6.33
6.33
6.33
6.33
6.33
6.33
6.32
6.32
6.31
6.31
6.31
6.31
6.31
6.31
6.3
6.3
6.3
6.3
6.29
6.29
6.29
6.29
6.28
6.28
6.28
6.28
6.28
6.28
6.28
6.28
6.28
6.27
6.27
6.26
6.26
6.26
6.26
6.26
6.26
6.26
6.26
6.25
6.25
6.25
6.25
6.25
6.25
6.25
6.25
6.24
6.24
6.24
6.24
6.24
6.24
6.24
6.23
6.23
6.23
6.23
6.23
6.23
6.23
6.22
6.22
6.22
6.22
6.21
6.21
6.2
6.2
6.2
6.19
6.19
6.19
6.18
6.18
6.18
6.18
6.18
6.17
6.17
6.17
6.17
6.17
6.17
6.17
6.16
6.16
6.16
6.15
6.15
6.15
6.15
6.15
6.15
6.15
6.15
6.15
6.14
6.14
6.14
6.14
6.14
6.14
6.14
6.13
6.13
6.13
6.13
6.12
6.12
6.12
6.11
6.11
6.11
6.11
6.11
6.11
6.11
6.11
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.08
6.08
6.08
6.07
6.07
6.07
6.07
6

2025-01-20 19:06:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:51 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:52 - root - INFO - SQL:
SELECT im."interest_name", MAX(m."composition") AS "max_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
Results:
Too long, hard cut:
interest_name,max_composition
Online Home Decor Shoppers,10.85
Luxury Travel Researchers,11.21
Home Remodelers,9.71
Tech-Savvy Moms,10.29
Travel Reward Points Enthusiasts,11.48
Sporting Goods Shoppers,9.48
Drama Show Watchers,6.09
Womens Fashion Magazine Readers,6.25
Online Health Researchers,8.66
Pandora Jewelry Shoppers,12.27
Womens Fitness Enthusiasts,6.47
Pet Store Goers,6.82
Beach House Second Home Owners,6.65
Breast Cancer Fund Raisers,6.26
Discount Womens Shoes Shoppers,7.08
Travel Researchers,10.14
Luxury Retail Researchers,13.97
MLB Fans,7.89
Mens Shoe Shoppers,11.68
Baby Products Buyers,9.27
Gourmet Food & Wine Researchers,6.45
Retirees,5.16
Microsoft Friendly Developers,5.37
Cosplay Enthusiasts,6.05
Weight Loss Researchers,10.8
Philadelphia Trip Planners,6.52
Young Boomers,7.08
Real Estate Decision Makers,8.23
Mens Health Researchers,7.42
Dog Lovers,6.28
Entertainment & Tabloid Magazine Readers,5.99
Online Grocery Shoppers,10.7
Auto-Looking for New Car Purchase or Lease,5.89
Italian Food Enthusiasts,7.31
Toyota Vehicle Shopper,7.15
Horse Owners,5.75
Arizona Trip Planners,7.37
Law Enforcement Officers,6.14
Ink & Toner Shoppers,7.23
Business Logistics Managers,6.48
Discount Device Shoppers,7.09
Online Alcohol Shoppers,7.94
Recipe Researchers,6.85
World Cup Apparel Shoppers,7.36
Engagement Ring Shoppers,7.42
Natural and Holistic Health Researchers,5.78
Competitive Car Brand Shoppers,6.7
Readers of Panamanian Content,2.88
Home Kitchen Chefs,6.41
Luxury Department Store Shoppers,11.38
Lacrosse Enthusiasts,8.24
Organic Food Buyers,6.82
Gastrointestinal Researchers,6.29
Cigars Shoppers,5.08
Used Car Shoppers,3.44
Kitchen & Bathroom Remodelers,6.5
Tampa and St Petersburg Trip Planners,5.59
Weight Lifting Enthusiasts,5.36
Gastroenterologists,7.7
China Trip Planners,6.26
Avid Readers,5.53
The Walking Dead Fans,5.29
Healthcare Discount Shoppers,7.56
Caribbean Trip Planners,4.32
Running Enthusiasts,9.29
Cholesterol Researchers,6.09
New & Expecting Parents,9.37
Womens Fashion Brands Shoppers,13.67
Wedding Registrants,6.83
Home Decor Shoppers,7.9
North Carolina Football Fans,6.61
Property Insurance Researchers,4.89
Shoe Shoppers,14.91
Fitness Enthusiasts,7.02
TV Junkies,5.3
Yogis,8.17
Streaming Radio Listeners,6.88
Medical Advice Researchers,7.88
Home Design Enthusiasts,6.54
Country Music Fans,5.42
Financial Investors,6.6
San Francisco Trip Planners,7.39
Hands-On Parents,5.94
Diabetes,6.79
Soccer Fans,6.67
Tax Policy Researchers,6.29
Nissan Vehicle Shoppers,8.09
TV Advertising Professionals,6.21
Tesla Enthusiasts,5.79
Architecture Enthusiasts,7.1
Fantasy & Comic Fans,6.51
Android Fans,5.09
High-End Kids Furniture and Clothes Shoppers,12.41
Solar Energy Solution Shoppers,7.02
Teen Content Readers,6.1
Gourmet Food Purchasers,6.85
Apartment Hunters,5.98
UFC and MMA Fans,3.17
Eye Health Researchers,3.17
Las Vegas Trip Planners,10.3
Reusable Drinkware Shoppers,13.35
Big & Tall Men,7.97
Harry Potter Fans,11.72
Postal Employees,6.38
New York Trip Planners,8.31
Italian Chain Restaurant Eaters,7.33
Las Vegas Nightlife Researchers,7.44
Gun Control Advocates,6.4
Los Angeles Mass Transit Commuters,7.15
Online Directory Searchers,3.77
Outdoors Enthusiasts,4.41
Olympics Fans,9.65
Techies,5.41
Entertainment Industry Decision Makers,5.85
BMW Vehicle Shoppers,5.87
Jewelry & Watch Shoppers,7.82
Audi Vehicle Shoppers,5.87
Beauty & Skincare Buyers,6.59
Healthy Snacks Shoppers,6.32
Luxury Womens Brands Shoppers,7.66
Food Safety Decision Makers,9.33
Environmental Activists,7.55
Gastroenterology Journal Researchers,6.56
Non-Profit Volunteers,7.7
Cat Lovers,5.36
Affordable Hotel Bookers,7.8
Restaurant News Readers,6.42
Joint Pain Sufferers,6.75
Horror Movie Fans,5.21
Rideshare App Users,6.6
Eyeglasses & Contact Lens Buyers,7.59
Teen Girl Clothing Shoppers,11.23
Order-in Eaters,6.79
Office Supply Shoppers,7.37
Orthopedic Health Researchers,6.09
Sailing Enthusiasts,4.67
Cruise Travel Intenders,8.32
Vacuum Shoppers,7.25
Ducati Motorcycle Shoppers,5.21
Investment Management Professionals,4.12
Charitable Donors,5.55
Restaurant Supply Shoppers,9.03
Seattle Trip Planners,5.67
Home Printer Shoppers,5.28
Sony Fans,4.32
Bodybuilding Enthusiasts,3.78
Lawn & Garden Enthusiasts,3.43
United Arab Emirates Trip Planners,4.45
Senior Caregivers,3.94
Ancestry Researchers,2.99
Building Service Contractors,3.69
Satellite TV Buyers,3.26
New Homeowners,3.13
Tire Researchers,2.65
Readers of Costa Rican Content,3.67
Fireworks Enthusiasts,2.97
Tractor Shoppers,2.75
Kansas City Chiefs Fans,2.47
Luxury Watch Shoppers,3.87
Washington Nationals Fans,2.84
Auburn Tigers Fans,3.26
Palm Beach Trip Planners,3.0
Meal Kit Delivery Researchers,4.41
Spy Gadgets Shoppers,3.2
Electric Vehicle Shoppers,2.29
NHL Fans,5.09
Hanukkah Decorations Shoppers,6.14
Social Conservatives,3.75
New Years Eve Party Ticket Purchasers,10.62
Nascar Fans,3.18
Marijuana Legalization Advocates,4.05
Texas Trip Planners,3.85
Action Figure and Collectibles Shoppers,2.55
Veterinarians,2.71
Off the G

2025-01-20 19:06:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:53 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:53 - root - INFO - SQL:
SELECT im."interest_name", AVG(m."composition") AS "average_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
Results:
Too long, hard cut:
interest_name,average_composition
Vacation Rental Accommodation Researchers,5.0249999999999995
Luxury Second Home Owners,2.9676923076923076
Hair Care Shoppers,2.9829999999999997
Nutrition Conscious Eaters,3.2728571428571427
Healthy Eaters,3.281538461538461
Wine Lovers,5.181666666666667
Home Design and Living Publication Readers,4.9575000000000005
Apartment Furniture Shoppers,4.651428571428572
Mature Parents,4.496666666666667
Misc-Deal Seekers or Coupon Shoppers,2.752727272727273
Vacation Planners,8.330714285714285
Competitive Sports Participants,4.616428571428571
Mens Fitness Publication Readers,2.612727272727273
Gluten-Free Recipe Researchers,3.6592857142857143
Parents with Kids,3.123076923076923
Golf Enthusiasts,4.771428571428571
NBA Fans,2.8021428571428575
Lobbyists,3.29
Luxury Kitchen Goods Shoppers,5.8149999999999995
Financial News Readers,2.5500000000000003
Exercise and Gym Researchers,2.9114285714285715
Preppy Clothing Shoppers,6.723571428571428
Paleo Eaters,3.2808333333333337
Halloween Costume Shoppers,7.578571428571429
Flight and Hotel Shoppers,7.320714285714286
Pregnancy Resources Researchers,2.852727272727273
Jaguar Vehicle Shoppers,3.470714285714286
Beach Supplies Shoppers,9.51142857142857
Luxury Retail Shoppers,9.762142857142859
Land Rover Shoppers,4.900714285714286
Luxury Hotel Guests,9.36357142857143
High End Camera Shoppers - Dupe,7.605
Ski House Second Home Owners,4.337857142857143
Bed & Bath Shoppers,3.9664285714285716
Costa Rica Trip Planners,4.667857142857143
Supermarket Shoppers,3.9042857142857144
Health & Fitness,2.975
Cycling Enthusiasts,4.097857142857142
Readers of Filipinos Content,2.2920000000000003
Financial Business Intelligence Researchers,2.463636363636364
Coffee Chain Shoppers,3.9050000000000002
Brides & Wedding Planners,3.6814285714285715
Sale Seekers,2.5207142857142855
Restaurant Researchers,3.672857142857143
Kids Clothing Shoppers,5.041428571428571
Sports Medicine Health Care Professionals,5.595
Thrift Store Shoppers,3.1735714285714285
Rugby Fans,3.112142857142857
NCAA Fans,3.65
Natural Pet Food Shoppers,5.588571428571428
Luxury Bedding Shoppers,11.093571428571428
Food Industry Professionals,4.966428571428572
Work Comes First Travelers,17.482499999999998
Major Airline Customers,5.055714285714286
Mazda Vehicle Shoppers,3.8808333333333334
Los Angeles Trip Planners,3.637857142857143
Photo Memory Makers,3.475
Skin Care Researchers,6.993571428571428
Kosher Recipe Researchers,3.3778571428571427
Credit Score Researchers,5.557857142857143
San Diego Trip Planners,3.9385714285714286
Cleveland Cavaliers Fans,2.091111111111111
Medicare Provider Researchers,5.0649999999999995
Motorcycle Purchasers,2.3642857142857143
Portugal Trip Planners,7.999285714285714
Parents of Teenagers Going to College,6.028571428571429
Price Conscious Home Shoppers,3.507142857142857
Gym Equipment Owners,10.486428571428572
High-End Camera Shoppers,3.920714285714286
Live Concert Fans,2.6733333333333333
Liberal News Readers,2.423
Boston Trip Planners,3.220714285714286
Dieters,3.2399999999999998
Competitive Tri-Athletes,6.445
Realtors & Real Estate Researchers,2.858571428571429
Womens Health Researchers,4.661666666666666
Pharmacy Shoppers,2.5872727272727274
Luggage Shoppers,5.212142857142857
Personal Stock Portfolio Managers,4.179230769230769
Investment Banking Professionals,4.4314285714285715
Social Liberals,2.407272727272727
Metal and Rock Music Fans,2.826363636363636
Tailgaters,3.823571428571429
Furniture Shoppers,9.507857142857144
Yale University Fans,4.077142857142857
Conservative News Readers,2.4844444444444442
Tech News Enthusiasts,2.349
Retirement Planners,3.6214285714285714
Charitable Organization Researchers,3.3278571428571424
Personal Investment Researchers,2.7992307692307694
Commercial Contractors & Designers,4.256428571428571
Patio Furniture Shoppers,7.9799999999999995
Executive and C-Suite,2.5999999999999996
Landscape Architects,3.5892857142857144
Major Appliance Shoppers,3.3721428571428573
March Madness Enthusiasts,2.9785714285714286
Home Kitchen Bakers,3.3592307692307695
Pre-Measured Grocery Shoppers,6.75
Home Wifi Researchers,3.587857142857143
Phoenix Trip Planners,2.670714285714286
Special Olympics Fans,4.590714285714285
New Zealand Trip Planners,7.62
Coupon Researchers,2.347272727272727
Junk Food Lovers,2.4850000000000003
Drug Store Shoppers,3.065
Luxury Home Fixture Shoppers,6.7542857142857144
Beer Lovers,3.6900000000000004
Denver Trip Planners,3.626428571428572
Mid-Range Grocery Shoppers,3.942142857142857
Readers of Pakistani Content,2.467142857142857
Food Allergies Researchers,2.8884615384615384
Fantasy Football Enthusiasts,2.5942857142857143
Pharmacists,3.285
Fishing Equipment Shoppers,5.497142857142857
Business News Readers,2.746923076923077
Readers of South Asian Content,2.3722222222222222
Tax Filers,2.4538461538461536
BBQ Recipe Researchers,2.721538461538462
Eco-Conscious Consumers,2.664
Christmas Celebration Researchers,8.622142857142858
Fast Food Lovers,2.305
Grill Masters,2.906153846153

2025-01-20 19:06:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 19:06:55 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:07:54 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        MAX(m."composition") AS "Composition Value",
        FIRST_VALUE(m."month_year") OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS "Time"
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    GROUP BY
        m."interest_id"
),
ranked_compositions AS (
    SELECT
        mc.*,
        RANK() OVER (ORDER BY mc."Composition Value" DESC) AS rank_desc,
        RANK() OVER (ORDER BY mc."Composition Value" ASC) AS rank_asc
    FROM
        max_compositions mc
)
SELECT
    rc."Time",
    im."interest_name" AS "Interest Name",
    rc."Composition Value"
FROM
    ranked_compositions rc
JOIN
    BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
        ON rc."interest_id" = im."id"
WHERE
    rc.rank_desc <= 10 OR rc.rank_asc <= 10
ORDER BY
    rc.rank_desc;
```
2025-01-20 19:07:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:56 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:08:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:08:56 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        m."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
            ON m."interest_id" = im."id"
)
SELECT
    "Time",
    "Interest Name",
    "Composition Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" ASC) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) ranked
WHERE
    rank_desc <= 10 OR rank_asc <= 10
ORDER BY
    rank_desc;
```
2025-01-20 19:08:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:08:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:08:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:08:57 - snowflake.connector.connection - INFO - closed
2025-01-20 19:08:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:09:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:09:59 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        m."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
        JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
            ON m."interest_id" = im."id"
)
SELECT
    mc."Time",
    mc."interest_name",
    mc."Composition_Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition_Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition_Value" ASC) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) mc
WHERE
    mc.rank_desc <= 10 OR mc.rank_asc <= 10
ORDER BY
    mc.rank_desc;
```
2025-01-20 19:09:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:09:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:09:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:10:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:10:00 - snowflake.connector.connection - INFO - closed
2025-01-20 19:10:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:11:15 - root - INFO - SQL:
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        m."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
        JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
            ON m."interest_id" = im."id"
)
SELECT
    mc."Time",
    mc."interest_name",
    mc."Composition_Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition_Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition_Value" ASC) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) mc
WHERE
    mc.rank_desc <= 10 OR mc.rank_asc <= 10
ORDER BY
    mc.rank_desc;
Results:
Time,interest_name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-20 19:11:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-01-20 19:11:16 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:16 - root - INFO - SQL:
-- Corrected Query 1
SELECT im."interest_name", m."composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
WHERE m."composition" > 15
LIMIT 1000
Results:
interest_name,composition
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Work Comes First Travelers,18.18
Luxury Boutique Hotel Researchers,15.15
Work Comes First Travelers,20.28
Work Comes First Travelers,19.45
Work Comes First Travelers,21.2
Luxury Bedding Shoppers,15.05
Work Comes First Travelers,18.99
Work Comes First Travelers,18.39

2025-01-20 19:11:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:18 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:18 - root - INFO - SQL:
-- Corrected Query 2
SELECT im."interest_name", COUNT(*) AS "record_count"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
GROUP BY im."interest_name"
LIMIT 1000
Results:
Too long, hard cut:
interest_name,record_count
Vacation Rental Accommodation Researchers,14
Luxury Second Home Owners,13
Hair Care Shoppers,10
Nutrition Conscious Eaters,14
Healthy Eaters,13
Wine Lovers,12
Home Design and Living Publication Readers,12
Misc-Deal Seekers or Coupon Shoppers,11
Gluten-Free Recipe Researchers,14
Parents with Kids,13
Exercise and Gym Researchers,14
Parents of Teenagers Going to College,14
Indoor Cycling & Spinning Enthusiasts,14
Health & Fitness,12
Preppy Clothing Shoppers,14
Eco-Conscious Consumers,10
Restaurant Researchers,14
Online Movie Downloaders,14
Apartment Furniture Shoppers,14
Competitive Sports Participants,14
NCAA Fans,14
Camera Review Readers,13
Beer Lovers,14
Denver Trip Planners,14
Readers of Filipinos Content,10
Conservative News Readers,9
Vacation Planners,14
Kitchen Appliance Shoppers,14
Mens Fitness Publication Readers,11
Luxury Hotel Guests,14
Portugal Trip Planners,14
Luxury Kitchen Goods Shoppers,14
Costa Rica Trip Planners,14
Financial Business Intelligence Researchers,11
Jaguar Vehicle Shoppers,14
Yale University Fans,14
Thrift Store Shoppers,14
Junk Food Lovers,10
Luxury Home Fixture Shoppers,14
College Football Fans,14
Sweet Tooths,14
Competitive Tri-Athletes,14
Realtors & Real Estate Researchers,14
March Madness Enthusiasts,14
Professional Chefs,14
Readers of Italian Content,14
Commercial Vehicles Shoppers,14
Metal and Rock Music Fans,11
Gym Equipment Owners,14
Tech News Enthusiasts,10
Work Comes First Travelers,8
Fast Food Lovers,10
New Orleans Trip Planners,14
Chelsea Fans,14
Ski House Second Home Owners,14
Readers of South Asian Content,9
Rugby Fans,14
Executive Travelers,8
Halloween Thrill Seekers,14
Recently Retired Individuals,14
Arthritis Sufferers,14
Star Wars Fans,4
Reality TV Show Watchers,5
Pharmacists,14
Boston Trip Planners,14
Beer Aficionados,14
Executive and C-Suite,13
Golf Enthusiasts,14
Natural Pet Food Shoppers,14
Personal Stock Portfolio Managers,13
Flight and Hotel Shoppers,14
Luxury Boutique Hotel Researchers,14
Tailgaters,14
Golden State Warriors Fans,13
Mature Parents,12
Land Rover Shoppers,14
NBA Fans,14
Lobbyists,14
Halloween Costume Shoppers,14
Pharmacy Shoppers,11
Business News Readers,13
Luxury Bedding Shoppers,14
Furniture Shoppers,14
Home Kitchen Bakers,13
Mazda Vehicle Shoppers,12
Family Medical Practice Journal Researchers,14
Physicians,14
European Trip Planners,14
Cycling Enthusiasts,14
Beach Supplies Shoppers,14
Sports Medicine Health Care Professionals,14
Coupon Researchers,11
Drug Store Shoppers,14
Tax Filers,13
Cloud Security Researchers,10
Foreman and Construction Managers,14
North Carolina Travel Researchers,14
Pregnancy Resources Researchers,11
Dieters,14
Home Buyers,14
Investment Banking Professionals,14
High-End Camera Shoppers,14
HDTV Researchers,14
Cosmetics and Beauty Shoppers,14
Adult Acne Sufferers,12
College Aspirants,14
Democrats,14
Austin Trip Planners,14
Readers of Jewish News,14
Readers of Mexican Content,10
Online Calculator Users,9
High End Camera Shoppers - Dupe,2
Landscape Architects,14
Kids Clothing Shoppers,14
Luxury Retail Shoppers,14
Retirement Planners,14
Charitable Organization Researchers,14
Heartburn Sufferers,12
Special Olympics Fans,14
Personal Investment Researchers,13
Los Angeles Trip Planners,14
Commercial Contractors & Designers,14
LGBT Activists,10
BBQ Recipe Researchers,13
Skin Care Researchers,14
Kosher Recipe Researchers,14
Patriotic Party Decoration Shoppers,14
Online Shoppers,14
Blockbuster Movie Fans,2
Budget Small Business Researchers,14
Home Security Shoppers,13
Military Families,14
"Work Hard, Play Hard Travelers",8
RC Helicopters and Drones Hobbyists,12
France Trip Planners,14
Readers of Hispanic Content,7
Readers of Indian Content,3
Neurologists,14
Indie Coffee Shoppers,14
Occupy Movement Supporters,13
Phone Accessory Shoppers,14
Liberal Think Tank Readers,14
Atlanta Falcons Fans,12
Discount Big Box Shoppers,14
Dallas Trip Planners,14
Photography Enthusiasts,14
Getting Off the Grid Travelers,8
Food Safety QA Professionals,14
Pain Management Researchers,14
Classic Car Shoppers,14
Family Halloween Party Planners,14
Loan Comparison Researchers,14
Deodorant Shoppers,11
Readers of Arabic Content,10
Readers of Puerto Rican Content,12
Colombia Trip Planners,9
Readers of Belizean Content,10
Truck Shoppers,9
Beard Care Shoppers,14
Jacksonville Jaguars Fans,10
Los Angeles Rams Fans,10
Embroidery Enthusiasts,11
Paintball Enthusiasts,7
Louisiana State University Tigers Fans,9
Cattle Industry New Readers,4
Christmas Celebration Researchers,14
Jeep Vehicle Shoppers,14
Thanksgiving Entertaining Researchers,14
Prepaid Smartphone Shoppers,11
Jazz Music Fans,13
Hard Rock Hotel & Casino Trip Planners,13
Myrtle Beach Trip Planners,8
Civil War History Buff,7
Nature and Outdoors Book Readers,8
Kitchen Stove Shoppers,7
Tutoring Resources Researchers,7
Godiva Chocolate Fans,9
Arsenal Fans,14
Asthma Sufferers,14
Clinic & Lab Immunologist Professionals,14
Denver Nuggets Fans,9
Bed & Bath Shoppers,14
Harvard University

2025-01-20 19:11:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:20 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:20 - root - INFO - SQL:
-- Corrected Query 3
SELECT im."interest_name",
       MIN(m."composition") AS "min_composition",
       MAX(m."composition") AS "max_composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
GROUP BY im."interest_name"
LIMIT 1000
Results:
Too long, hard cut:
interest_name,min_composition,max_composition
Vacation Rental Accommodation Researchers,2.42,11.89
Luxury Second Home Owners,1.61,9.93
Hair Care Shoppers,1.77,10.32
Healthy Eaters,1.64,10.82
Home Design and Living Publication Readers,2.26,10.11
Apartment Furniture Shoppers,2.48,11.57
Mature Parents,2.64,9.47
Misc-Deal Seekers or Coupon Shoppers,1.65,9.49
Land Rover Shoppers,2.69,12.62
Vacation Planners,2.87,12.56
Luxury Hotel Guests,3.84,14.1
Gluten-Free Recipe Researchers,1.92,11.04
Liberal News Readers,1.55,6.05
NBA Fans,1.86,6.9
Natural Pet Food Shoppers,1.92,10.95
Apple Fans,1.98,7.48
Metal and Rock Music Fans,1.82,5.41
Kids Clothing Shoppers,3.08,7.6
Lobbyists,1.86,10.43
Preppy Clothing Shoppers,4.22,10.76
Competitive Tri-Athletes,3.85,9.97
Pregnancy Resources Researchers,1.71,9.13
Coffee Chain Shoppers,2.37,8.07
Luxury Boutique Hotel Researchers,4.21,15.15
Plus Size Women,2.79,7.74
Canada Trip Planners,2.41,4.22
Wine Lovers,2.36,10.71
Kitchen Appliance Shoppers,2.97,12.22
Price Conscious Home Shoppers,2.13,7.19
Readers of Filipinos Content,1.67,5.99
Eco-Conscious Consumers,1.79,6.57
Nutrition Conscious Eaters,1.63,10.77
High End Camera Shoppers - Dupe,4.3,10.91
Costa Rica Trip Planners,2.73,11.63
Supermarket Shoppers,1.88,11.63
NCAA Fans,2.29,6.24
Paleo Eaters,1.55,10.22
Conservative News Readers,1.58,6.14
March Madness Enthusiasts,2.3,3.98
Retirement Planners,2.43,7.42
Sports Medicine Health Care Professionals,3.62,8.02
Special Olympics Fans,2.62,8.81
Drug Store Shoppers,1.79,6.96
Hematologists,1.65,6.24
Countdown to the Beach Travelers,4.13,8.5
Job Seekers,1.65,3.4
Luxury Bedding Shoppers,4.63,15.05
Car Enthusiasts,1.73,6.14
Thrift Store Shoppers,1.99,7.23
France Trip Planners,2.61,6.05
Stay-at-Home Parents,2.26,7.15
Halloween Thrill Seekers,2.46,7.35
Green Bay Packers Fans,1.61,3.38
Diesel Vehicle Shoppers,2.11,4.86
Utility Workwear Shoppers,3.16,5.88
Auto Insurance Shoppers,1.58,6.81
Aftermarket Accessories Shoppers,1.88,3.62
Financial Business Intelligence Researchers,1.59,6.13
Personal Investment Researchers,1.69,6.95
BBQ Enthusiasts,1.58,6.66
Foreman and Construction Managers,1.85,6.5
Sports Gamblers,1.89,4.14
Evangelical Christians,1.6,3.77
Washington Redskins Fans,1.72,2.39
Competitive Sports Participants,2.45,9.35
Portugal Trip Planners,3.11,11.61
Live Concert Fans,1.74,6.61
Luxury Kitchen Goods Shoppers,3.24,12.87
Boston Trip Planners,1.8,8.14
Brides & Wedding Planners,1.78,10.82
Ski House Second Home Owners,2.62,8.84
Phoenix Trip Planners,1.76,6.65
Bed & Bath Shoppers,2.34,10.86
Advertising Professionals,1.56,6.72
Market Intelligence Researchers,1.62,6.2
Golf Enthusiasts,2.99,9.97
Indoor Cycling & Spinning Enthusiasts,2.27,10.05
Dieters,2.07,6.87
Gym Equipment Owners,6.94,18.82
Food Allergies Researchers,1.83,6.28
Mazda Vehicle Shoppers,2.34,5.57
Rugby Fans,1.85,6.67
Fast Food Lovers,1.61,6.1
Health & Fitness,1.59,6.77
Landscape Architects,1.99,7.81
Sale Seekers,1.63,6.13
Social Liberals,1.57,6.1
Furniture Shoppers,6.03,17.44
Beach Supplies Shoppers,3.71,13.03
Major Appliance Shoppers,2.07,7.01
New Zealand Trip Planners,3.12,10.61
Fantasy Football Enthusiasts,1.87,3.82
BBQ Recipe Researchers,1.74,6.41
Streaming Video Fans,1.77,6.01
Urban Skateboarding Sneaker Shoppers,4.39,8.45
Sightseeing Travelers,2.36,5.92
Hiking Enthusiasts,1.58,4.54
Cleveland Cavaliers Fans,1.59,3.03
Flooring Shoppers,2.29,4.27
Videographers,1.57,3.8
Powerboat Purchasers,1.9,3.73
Financial News Readers,1.64,6.37
Womens Health Researchers,2.66,6.76
Parents of Teenagers Going to College,3.66,12.93
Cycling Enthusiasts,2.61,6.37
Executive and C-Suite,1.55,6.45
Online Shoppers,2.13,4.39
Military Families,1.76,6.52
Realtors & Real Estate Researchers,1.83,6.28
Luggage Shoppers,3.52,9.64
Restaurant Researchers,2.26,7.64
Online Movie Downloaders,1.9,6.46
Home Kitchen Bakers,1.76,7.3
Readers of South Asian Content,1.65,5.86
Coupon Researchers,1.68,5.91
Junk Food Lovers,1.68,6.18
College Football Fans,2.03,5.47
Professional Chefs,1.81,6.78
LGBT Activists,1.56,5.93
Skin Care Researchers,3.12,9.46
Christmas Celebration Researchers,3.24,12.16
Crypto Market Investors,1.66,5.65
Patriotic Party Decoration Shoppers,2.24,7.22
Readers of Italian Content,2.36,5.31
Cardio Health Researchers,2.2,7.89
Family Medical Practice Journal Researchers,1.71,7.15
Home Security Shoppers,1.67,6.31
Sweet Tooths,1.88,7.2
NFL Fans,1.56,3.53
College Aspirants,2.36,6.09
Executive Travelers,4.87,6.88
North Carolina Travel Researchers,1.97,7.8
Chelsea Fans,3.16,10.36
Pediatricians,1.74,6.88
Moving Services Shoppers,1.77,6.29
Mexican Food Enthusiasts,1.54,6.16
Hardware Shoppers,1.89,4.64
European Trip Planners,2.75,6.25
FC Barcelona Fans,1.67,3.52
Seattle Seahawks Fans,1.71,5.0
Readers of Greek Content,1.91,4.39
Phone Accessory Shoppers,2.23,5.08
Dentists,2.16,5.08
Rapid City Trip Planners,1.94,4.11
Online Daters,1.83,4.13
Coin Collectors,1.67,3.35
Farmers,1.63,4.38
Classic Car Shoppers,1.65,6.18
Texas Energy Providers,1.85,3.03
In-Market Car Shoppers,2.12,3.5

2025-01-20 19:11:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:22 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:22 - root - INFO - SQL:
-- Corrected Query 4
SELECT im."interest_name", m."percentile_ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
WHERE m."_year" = 2019
LIMIT 1000
Results:
Too long, hard cut:
interest_name,percentile_ranking
Winter Apparel Shoppers,99.9
Mens Shoe Shoppers,99.79
Fitness Activity Tracker Users,99.69
Luxury Retail Researchers,99.59
Competitive Tri-Athletes,99.49
Preppy Clothing Shoppers,99.38
Luxury Home Fixture Shoppers,99.28
Shoe Shoppers,99.18
Running Enthusiasts,99.08
Work Comes First Travelers,98.97
Family Adventures Travelers,98.87
Womens Fashion Brands Shoppers,98.77
Apartment Furniture Shoppers,98.77
World Cup Enthusiasts,98.77
"Work Hard, Play Hard Travelers",98.46
Beach Supplies Shoppers,98.36
At-Home Gym Intenders,98.25
Aspen Skiers and Snowboarders,98.25
Kids Clothing Shoppers,98.05
Luxury Boutique Hotel Researchers,97.94
Parents of Teenagers Going to College,97.84
Competitive Sports Participants,97.74
Luxury Bedding Shoppers,97.64
Vacation Planners,97.64
Trendy Denim Shoppers,97.43
Ski and Snowboard Apparel Shoppers,97.33
Luxury Retail Shoppers,97.23
Luxury Kitchen Goods Shoppers,97.23
Big & Tall Men,97.23
Swimming Enthusiasts,96.92
Home Decor Shoppers,96.81
High-End Kids Furniture and Clothes Shoppers,96.71
Colorado Skiers and Snowboarders,96.61
Lacrosse Enthusiasts,96.61
Urban Skateboarding Sneaker Shoppers,96.4
Furniture Shoppers,96.4
Cycling Enthusiasts,96.4
Reusable Drinkware Shoppers,96.4
Vacation Rental Accommodation Researchers,95.99
Olympics Fans,95.89
Golf Enthusiasts,95.89
Japanese Luxury Car Enthusiasts,95.89
Luggage Shoppers,95.89
Vermont Trip Planners,95.48
Fishing Equipment Shoppers,95.38
Luxury Hotel Guests,95.27
Sporting Goods Shoppers,95.27
Gym Equipment Owners,95.07
World Cup Apparel Shoppers,95.07
Western Canada Skiers and Snowboarders,94.86
Kitchen Appliance Shoppers,94.76
Sports Medicine Health Care Professionals,94.66
Getting Off the Grid Travelers,94.66
Luxury Womens Brands Shoppers,94.45
Pandora Jewelry Shoppers,94.35
Flight and Hotel Shoppers,94.24
European Trip Planners,94.14
Hanukkah Decorations Shoppers,94.04
Utility Workwear Shoppers,94.04
Ski House Second Home Owners,94.04
Sports Memorabilia Shoppers,93.73
Luxury Department Store Shoppers,93.63
Leather Goods Shoppers,93.53
Big East Fans,93.53
Discount Womens Shoes Shoppers,93.53
Identity Theft Protection Researchers,93.22
Luxury Travel Researchers,93.22
Christmas Celebration Researchers,93.22
Affordable Hotel Bookers,92.91
Costa Rica Trip Planners,92.91
Major Airline Customers,92.7
Price Conscious Home Shoppers,92.7
North Carolina Football Fans,92.5
Online Home Decor Shoppers,92.39
Jewelry & Watch Shoppers,92.39
Indoor Cycling & Spinning Enthusiasts,92.19
Sun Protection Shoppers,92.09
Kitchen and Home Goods Shoppers,92.09
Special Olympics Fans,92.09
NCAA Fans,91.78
New York Trip Planners,91.68
Broadway Fans,91.68
Soap Shoppers,91.47
Countdown to the Beach Travelers,91.47
Neurologists,91.47
Online Grocery Shoppers,91.47
Jazz Festival Enthusiasts,91.47
Canoeing and Kayaking Enthusiasts,91.47
Chandelier and Lamp Shoppers,91.47
Halloween Costume Shoppers,90.75
Embroidery Enthusiasts,90.75
Patio Furniture Shoppers,90.75
NCAA Football Fans,90.75
Land Rover Shoppers,90.34
Bed & Bath Shoppers,90.24
Hawaii Trip Planners,90.24
Military Personal Finance Researchers,90.24
New Zealand Trip Planners,90.24
Mattress Researchers,89.83
Investment Banking Professionals,89.72
Dance Clothing Shoppers,89.72
Travel Researchers,89.72
Pre-Measured Grocery Shoppers,89.72
Flower & Gift Basket Shoppers,89.72
March Madness Enthusiasts,89.21
Summer Activities Researchers,89.21
Sightseeing Travelers,89.21
Spa Goers,88.9
Blender Shoppers,88.8
Online Alcohol Shoppers,88.8
Godiva Chocolate Fans,88.59
Dieters,88.59
Health & Fitness,88.59
Waterfront Vacationers,88.28
Chocolate Lovers,88.28
Cardio Health Researchers,88.28
Italian Chain Restaurant Eaters,88.28
Yogis,88.28
NHL Fans,87.77
Promotional Products Purchasers,87.77
Billiards Enthusiasts,87.77
Retirement Planners,87.77
Gen Z Apparel Shoppers,87.77
Meal Kit Delivery Researchers,87.26
Houston Trip Planners,87.15
Scuba Diving Enthusiasts,87.15
Portugal Trip Planners,87.15
Surfers,87.15
Teen Girl Clothing Shoppers,87.15
Discount Device Shoppers,86.64
Chelsea Fans,86.64
Sunglasses Shoppers,86.64
Little Rock Trip Planners,86.64
Supply Chain Professionals,86.64
Long Beach California Trip Planners,86.64
Executive Travelers,86.64
Skin Care Researchers,86.64
Clemson Tigers Fans,86.64
Financial Advisors,85.71
Commercial Healthcare Hospitality & Retail Designers,85.71
Kitchen and Bath Professionals,85.51
Austin Trip Planners,85.51
Readers of Italian Content,85.51
Restaurant Researchers,85.51
MLB Fans,85.51
Christmas Decorations Shoppers,85.51
Avid Readers,84.89
Health and Fitness Book Readers,84.89
Manchester United Fans,84.89
Department Store Shoppers,84.89
Online Shoppers,84.89
Beauty & Skincare Buyers,84.89
Duke Blue Devils Fans,84.28
Pediatric Provider Researchers,84.28
Tea Drinkers,84.28
Canada Trip Planners,84.28
Orthopedic Health Researchers,84.28
School Supply Shoppers,84.28
Ski and Snowboard Enthusiasts,84.28
Flooring Shoppers,83.56
Venture Capitalists,83.56
Car Rental S

2025-01-20 19:11:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:24 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:24 - root - INFO - SQL:
-- Corrected Query 5
SELECT im."interest_name", m."index_value"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
LIMIT 1000
Results:
Too long, hard cut:
interest_name,index_value
Vacation Rental Accommodation Researchers,6.19
Luxury Second Home Owners,5.31
Online Home Decor Shoppers,5.29
Hair Care Shoppers,5.1
Nutrition Conscious Eaters,5.04
Healthy Eaters,5.03
Luxury Travel Researchers,4.97
Wine Lovers,4.83
Home Remodelers,4.83
Home Design and Living Publication Readers,4.81
Apartment Furniture Shoppers,4.79
Mature Parents,4.67
Weight Loss Researchers,4.62
Luxury Retail Researchers,4.53
Running Enthusiasts,4.5
Misc-Deal Seekers or Coupon Shoppers,4.49
Shoe Shoppers,4.47
Land Rover Shoppers,4.38
MLB Fans,4.15
Vacation Planners,4.08
Competitive Sports Participants,3.99
Tech-Savvy Moms,3.95
Kitchen Appliance Shoppers,3.92
Mens Fitness Publication Readers,3.84
Travel Reward Points Enthusiasts,3.82
Luxury Hotel Guests,3.82
Gluten-Free Recipe Researchers,3.81
Parents with Kids,3.77
Reusable Drinkware Shoppers,3.75
Portugal Trip Planners,3.74
New & Expecting Parents,3.73
Live Concert Fans,3.69
Sporting Goods Shoppers,3.66
Womens Fashion Brands Shoppers,3.65
Golf Enthusiasts,3.64
Liberal News Readers,3.59
Drama Show Watchers,3.58
NBA Fans,3.56
Lobbyists,3.55
Wedding Registrants,3.55
Mens Health Researchers,3.55
Mens Shoe Shoppers,3.53
Luxury Kitchen Goods Shoppers,3.53
Baby Products Buyers,3.51
Financial News Readers,3.48
High End Camera Shoppers - Dupe,3.44
Fitness Enthusiasts,3.44
Womens Fashion Magazine Readers,3.41
Ski House Second Home Owners,3.39
TV Junkies,3.39
Online Health Researchers,3.36
Exercise and Gym Researchers,3.35
Pandora Jewelry Shoppers,3.33
Bed & Bath Shoppers,3.32
Dog Lovers,3.32
Luxury Department Store Shoppers,3.3
Costa Rica Trip Planners,3.29
Womens Fitness Enthusiasts,3.29
Parents of Teenagers Going to College,3.27
Indoor Cycling & Spinning Enthusiasts,3.26
Home Decor Shoppers,3.26
Olympics Fans,3.24
Pet Store Goers,3.22
Supermarket Shoppers,3.22
Boston Trip Planners,3.22
Health & Fitness,3.2
NCAA Fans,3.2
Beach House Second Home Owners,3.17
Preppy Clothing Shoppers,3.17
Breast Cancer Fund Raisers,3.15
Paleo Eaters,3.15
Beer Aficionados,3.15
Yogis,3.12
Harry Potter Fans,3.1
Natural Pet Food Shoppers,3.08
Dieters,3.08
Cholesterol Researchers,3.07
Competitive Tri-Athletes,3.04
Price Conscious Home Shoppers,3.02
Cycling Enthusiasts,3.02
Halloween Costume Shoppers,3.01
Realtors & Real Estate Researchers,2.98
Readers of Filipinos Content,2.97
Flight and Hotel Shoppers,2.97
Pregnancy Resources Researchers,2.96
Entertainment & Tabloid Magazine Readers,2.95
Streaming Radio Listeners,2.95
Financial Business Intelligence Researchers,2.94
NCAA Football Fans,2.93
Medical Advice Researchers,2.92
Womens Health Researchers,2.92
Discount Device Shoppers,2.91
Pharmacy Shoppers,2.91
Philadelphia Trip Planners,2.91
Gourmet Food & Wine Researchers,2.91
TV Advertising Professionals,2.91
Techies,2.89
Apple Fans,2.88
Executive and C-Suite,2.88
Luggage Shoppers,2.87
Coffee Chain Shoppers,2.86
Home Kitchen Chefs,2.86
Ecommerce Platform Researchers,2.86
Entertainment Industry Decision Makers,2.86
Home Buyers,2.85
Brides & Wedding Planners,2.85
Personal Stock Portfolio Managers,2.85
Eco-Conscious Consumers,2.84
Young Boomers,2.84
Discount Womens Shoes Shoppers,2.83
Olympic Sports Enthusiasts,2.82
TV Game Show Fans,2.81
Landscape Architects,2.8
Lacrosse Enthusiasts,2.79
Sale Seekers,2.79
Jaguar Vehicle Shoppers,2.77
Tesla Enthusiasts,2.76
Home Design Enthusiasts,2.76
BMW Vehicle Shoppers,2.76
Luxury Boutique Hotel Researchers,2.76
Entrepreneurs,2.75
Camera Review Readers,2.75
Restaurant Researchers,2.75
Postal Employees,2.74
At-Home Gym Intenders,2.74
Online Grocery Shoppers,2.73
Investment Banking Professionals,2.73
Advertising Professionals,2.73
Travel Researchers,2.73
Social Liberals,2.72
Flower & Gift Basket Shoppers,2.72
Metal and Rock Music Fans,2.71
Country Music Fans,2.71
Gym Equipment Owners,2.71
Tailgaters,2.71
Jewelry & Watch Shoppers,2.71
Media Buying Professionals,2.69
Business News Readers,2.68
Luxury Bedding Shoppers,2.68
Furniture Shoppers,2.68
Boxing Fans,2.67
Beach Supplies Shoppers,2.66
Yale University Fans,2.66
Online Movie Downloaders,2.63
Australia Trip Planners,2.63
Conservative News Readers,2.63
Acura Vehicle Shoppers,2.62
Kids Clothing Shoppers,2.62
Major Appliance Shoppers,2.61
Audi Vehicle Shoppers,2.6
March Madness Enthusiasts,2.6
Luxury Retail Shoppers,2.6
Architecture Enthusiasts,2.59
Tech News Enthusiasts,2.57
Home Kitchen Bakers,2.55
Real Estate Decision Makers,2.55
Online Alcohol Shoppers,2.54
Auto-Looking for New Car Purchase or Lease,2.53
Market Intelligence Researchers,2.53
First Aid Researchers,2.53
Pre-Measured Grocery Shoppers,2.53
Japanese Luxury Car Enthusiasts,2.52
Readers of Bengali Content,2.51
Readers of South Asian Content,2.51
Detroit Trip Planners,2.51
Retirement Planners,2.51
LED Lighting Shoppers,2.5
New York Trip Planners,2.5
Beauty & Skincare Buyers,2.5
Charitable Organization Researchers,2.49
Fantasy & Comic Fans,2.49
Finance Continuing Education Researchers,2.49
Big & Tall Men,2.49
Car Enthusiasts,2.47
Christmas 

2025-01-20 19:11:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 14
2025-01-20 19:11:25 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:26 - root - INFO - SQL:
-- Corrected Query 6
SELECT m."month_year", m."composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
WHERE m."interest_id" = 5
ORDER BY m."_year", m."_month"
LIMIT 1000
Results:
month_year,composition
07-2018,10.82
08-2018,4.0
09-2018,3.47
10-2018,4.07
11-2018,3.67
12-2018,3.93
01-2019,3.64
02-2019,3.75
03-2019,3.16
04-2019,2.44
05-2019,1.78
06-2019,1.83
07-2019,2.17
08-2019,2.81

2025-01-20 19:11:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:27 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:28 - root - INFO - SQL:
-- Corrected Query 7
SELECT DISTINCT im."interest_summary"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
LIMIT 1000
Results:
Too long, hard cut:
interest_summary
Consumers using fitness tracking apps and websites.
Consumers researching game reviews and cheat codes.
Readers of automotive news and car reviews.
Consumers researching luxury product reviews and gift ideas.
People researching wedding ideas and vendors.
Consumers reading reviews of vacation destinations and accommodations.
Readers of motorcycle news and reviews.
Readers of online business news content.
Consumers shopping online for clothing at thrift stores and researching locations.
People reading articles and websites about football and the NFL.
People reading articles and websites about basketball and the NBA.
People reading articles and websites about college sports and the NCAA.
Consumers researching box office listings and buying movie tickets.
Consumers researching DIY projects.
Grill owners researching new recipes.
Readers of tech news and gadget reviews.
Consumers shopping for auto insurance.
Consumers in-market for clothing for teenage girls.
Consumers researching high-end watch and jewelry brands.
People researching job boards.
People researching major charitable organizations.
Consumers shopping at big box retailers.
People reading about hip hop music and hip hop stars.
Consumers shopping for discounted electronics.
People researching menopause symptoms.
Consumers shopping for connected TV products.
Consumers of online comics and fantasy novels.
People reading legal journals and industry publications.
Consumers reseraching lawn and garden maintenance techniques.
Individuals in-market for office supplies.
People reading contractor trade publications.
People reading about child raising advice and activities.
People researching voter registration options.
Consumers reading content about diet and weight loss.
People reading content online related to conservative think tanks.
People visiting sites related to liberal think tanks.
People reading articles and websites about baseball and the MLB.
Consumers researching home design styles and trends.
Consumers streaming feature length movies and TV shows.
People reading education industry publications and teaching advice websites.
"Consumers shopping for home design, art and accessories."
Consumers shopping for sporting goods and activewear apparel.
Consumers with an active online trading account.
People shopping at high end childrens clothing and toy retailers.
"People reading about family cooking, parenting advice and childrens activities."
People researching healthy eating options.
Consumers shopping online or searching for a local drug store.
Consumers shopping for high end fashion apparel and accessories.
Consumers reading online reviews of luxury travel options.
Consumers shopping for a new TV.
People researching daycare options.
People researching gyms and health clubs.
People reading articles and websites about the sport of boxing.
Consumers shopping for car maintenance products.
People reading anti-war publications
People reading right-leaning social issues websites.
Parents who had children later in life.
People researching asthma trends and treatment options.
Consumers researching alternative mobile phones and wireless plans.
People searching for and watching TV game shows online.
People visiting sites advocating LGBT rights.
"People researching attractions and accommodations in Costa Rica. These consumers are more likely to spend money on flights, hotels, and local attractions."
People researching academic programs and resources for high schoolers.
People researching climate change and sustainable living.
People reading medical journals and using online prescribing services.
People visiting university websites.
Consumes shopping at multi-category department stores.
Consumers shopping for apparel that mimics current runway trends.
People reading real estate sales listings.
Consumers who are shopping for moving services.
People reading articles and websites about hockey and the NHL.
People reading websites about nursing lifestyle and career advice.
People reading Democratic party advocacy websites.
Consumers downloading feature length movies and TV shows.
Consumers reading online reviews of theme parks and accommodations.
People visiting websites about military benefits.
Consumers shopping for a printer.
Consumers making online rental car bookings.
""
Avid readers of online content about the entertainment industry.
People visiting sites advocating the legalization of marijuana.
People reading news and advice on preventing and treating orthopedic health issues.
People researching career development and advancement.
People who read advertising industry news.
People reading articles and websites about nascar.
Consumers shopping for childrens apparel.
Consumers shopping for bed and bath products.
Consumers shopping for lingerie.
People reading real estate rental listings.
People researching pregnancy issues and baby names.
Consumers shopping for printer ink.
People reading Republican party advocacy websites.
Consumers researching sa

2025-01-20 19:11:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 995
2025-01-20 19:11:29 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:30 - root - INFO - SQL:
-- Corrected Query 8
SELECT im."interest_name", m."ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
WHERE m."month_year" = '12-2018'
LIMIT 1000
Results:
Too long, hard cut:
interest_name,ranking
Fitness Enthusiasts,140
Gamers,991
Car Enthusiasts,890
Luxury Retail Researchers,5
Brides & Wedding Planners,315
Vacation Planners,25
Motorcycle Enthusiasts,910
Business News Readers,602
Thrift Store Shoppers,347
Advertising Professionals,487
NFL Fans,737
NBA Fans,410
NCAA Fans,56
MLB Fans,147
Nascar Fans,669
Eco-Conscious Consumers,619
Moviegoers,523
DIYers,558
Grill Masters,424
Home Design Enthusiasts,453
Doctors,322
Streaming Video Fans,927
Auto Insurance Shoppers,400
Teachers,536
College Students,692
Department Store Shoppers,136
Home Decor Shoppers,38
Kids Clothing Shoppers,28
Teen Girl Clothing Shoppers,171
Mens Clothing Shoppers,220
Baby Products Buyers,765
Jewelry & Watch Shoppers,98
Sporting Goods Shoppers,12
Furniture Shoppers,52
Bed & Bath Shoppers,158
Intimates Shoppers,592
Fast Fashion Shoppers,400
Apartment Hunters,472
Home Buyers,122
Moving Services Shoppers,511
Job Seekers,886
Charitable Donors,281
NHL Fans,104
Discount Big Box Shoppers,243
Black Friday Deal Shoppers,922
Hip Hop Fans,978
Online Investors,643
Seasonal Allergy Sufferers,231
Discount Device Shoppers,211
Mobile Phone Comparison Shoppers,855
Budget Wireless Shoppers,910
Menopause Researchers,354
Online Health Researchers,168
Beauty & Skincare Buyers,186
Streaming Device Shoppers,558
New & Expecting Parents,712
High-End Kids Furniture and Clothes Shoppers,57
Hands-On Parents,523
Fantasy & Comic Fans,868
Lawyers,536
Healthy Eaters,101
Drug Store Shoppers,415
Lawn & Garden Enthusiasts,375
Nurses,657
Mailing & Shipping Shoppers,415
Office Supply Shoppers,271
Ink & Toner Shoppers,571
Luxury Retail Shoppers,39
Contractors & Construction Professionals,657
Luxury Travel Researchers,64
Democrats,330
Republicans,843
HDTV Researchers,255
Hardware Shoppers,181
Reggaeton Fans,765
Online Movie Downloaders,822
Sale Seekers,487
Theme Park Researchers,211
Ski and Snowboard Enthusiasts,65
Travel Researchers,92
Coupon Researchers,712
Parents with Toddlers,831
Parents with Kids,440
Young Boomers,536
Day Care Users,765
Stay-at-Home Parents,255
Exercise and Gym Researchers,211
Home Kitchen Chefs,255
Restaurant Researchers,111
Order-in Eaters,302
Nutrition Conscious Eaters,98
Flower & Gift Basket Shoppers,92
Plus Size Women,388
Live Concert Fans,545
Country Music Fans,737
Cruise Travel Intenders,330
Pain Medication Users,375
Joint Pain Sufferers,511
Pain Management Researchers,855
Retirement Planners,137
Auto Repair Researchers,831
Avid Readers,129
Womens Fashion Magazine Readers,681
Mens Shoe Shoppers,5
Home Security Shoppers,799
Boxing Fans,609
Sleep Disorder Researchers,784
Mortgage Researchers,592
Coders & Developers,955
Military Servicemembers & Veterans,922
Healthcare Discount Shoppers,400
Postal Employees,487
Soccer Fans,366
Kitchen & Bathroom Remodelers,199
Aftermarket Accessories Shoppers,472
Automotive Safety Researchers,472
Apple Fans,388
Home Printer Shoppers,255
Major Appliance Shoppers,147
Online Alcohol Shoppers,137
Home Kitchen Bakers,208
Makeup Researchers,602
Pet Owners,706
Skin Care Researchers,211
Credit Card Researchers,799
Health Insurance Researchers,271
Property Insurance Researchers,337
Audio Equipment Researchers,697
Broadway Fans,82
Celebrity Gossip Fans,855
Streaming Radio Listeners,453
TV Junkies,619
Big & Tall Men,41
Phone Accessory Shoppers,354
Prepaid Smartphone Shoppers,950
Business Travelers,164
Car Rental Shoppers,158
Flight and Hotel Shoppers,55
Sightseeing Travelers,86
Travel Reward Points Enthusiasts,192
Retirees,453
Federal Employees,681
Conservative News Readers,848
Liberal News Readers,681
Doves,895
Social Conservatives,692
Social Liberals,831
Voters,751
Shoe Shoppers,8
Readers of Hispanic Content,955
Working Parents,619
Health & Fitness,108
Business Accounting Software Researchers,415
Business Filing Researchers,523
Business Logistics Managers,487
IT Decision Makers,886
Small Business Employees,633
Sweepstakes Enthusiasts,602
Womens Fitness Enthusiasts,302
Tech-Savvy Moms,375
Readers of Mexican Content,987
TV Game Show Fans,511
Credit Union Researchers,424
Mature Parents,453
Streaming Music Enthusiasts,927
Parents of Teenagers Going to College,28
Cosmetics and Beauty Shoppers,487
Readers of Japanese Content,814
Yogis,81
Asthma Sufferers,281
Adult Acne Sufferers,712
Heartburn Sufferers,487
Sinus Researchers,511
Headache and Migraine Sufferers,231
Back Pain Sufferers,388
First Aid Researchers,265
Cholesterol Researchers,501
Dieters,76
Vitamin Shoppers,122
Womens Health Researchers,424
Mens Health Researchers,181
Food Allergies Researchers,388
Arthritis Sufferers,192
Teen Content Readers,784
Gastrointestinal Researchers,487
Military Families,751
LGBT Activists,895
Tire Shoppers,886
Surfers,122
Gun Control Advocates,799
Gun Rights Advocates,895
Immigration Rights Advocates,880
Immigration Control Advocates,424
Right Wing Radicals,877
Occupy Movement Supporters,545
Marijuana Legalization Advocates,907
Marijuana Prohibition Advocates,784
Family Values Advocates,799
Conservative Think Tank Reader

2025-01-20 19:11:30 - root - INFO - itercount: 0
2025-01-20 19:11:30 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

**1. INTEREST_METRICS**
- `"interest_id"`: Used to identify interest categories; crucial for joining with `INTEREST_MAP`.
- `"composition"`: Key metric needed to determine the highest and lowest composition values.
- `"month_year"`: Provides the time in `MM-YYYY` format; necessary for the final output.
- `"_month"` and `"_year"`: May be used to filter or aggregate data by month or year.
- `"index_value"`: May offer additional insights but is not directly needed for this task.
- `"ranking"` and `"percentile_ranking"`: Could be used to understand the position of interest categories but not essential here.

**2. INTEREST_MAP**
- `"id"`: Unique identifier for each interest category; used to join with `INTEREST_METRICS`.
- `"interest_name"`: Provides the names of interest categories; required for the output.
- `"interest_summary"`: Offers descriptions but not immediately relevant.
- `"created_at"` and `"last_modified"`: Timestamps that might be useful for data currency checks.

**Conditions That May Be Used:**
- **Joining Tables**: On `"interest_id"` from `INTEREST_METRICS` and `"id"` from `INTEREST_MAP` to associate metrics with names.
- **Ordering**: By `"composition"` in descending order to find top values and ascending order for bottom values.
- **Grouping**: By `"interest_id"` or `"interest_name"` to aggregate or filter data.
- **Filtering**: Using `"month_year"` to select data from specific times if needed.
- **Limiting Results**: Using `LIMIT` to constrain the number of records retrieved.

---

**SQL Queries:**

1. **Retrieve all distinct interest categories and their names:**

    ```sql
    SELECT DISTINCT im."id", im."interest_name"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
    LIMIT 1000;
    ```

2. **List all composition values for each interest category:**

    ```sql
    SELECT m."interest_id", m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    LIMIT 1000;
    ```

3. **Find the distinct months and years available:**

    ```sql
    SELECT DISTINCT m."month_year"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    LIMIT 1000;
    ```

4. **Get the top 100 composition values across all interest categories:**

    ```sql
    SELECT m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    ORDER BY m."composition" DESC
    LIMIT 1000;
    ```

5. **Retrieve the interest names and their maximum composition values:**

    ```sql
    SELECT im."interest_name", MAX(m."composition") AS "max_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
    ```

6. **Show the average composition value for each interest category:**

    ```sql
    SELECT im."interest_name", AVG(m."composition") AS "average_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
    ```

7. **List all interest categories with their composition in a specific month (e.g., January 2023):**

    ```sql
    SELECT im."interest_name", m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    WHERE m."month_year" = '01-2023'
    LIMIT 1000;
    ```

8. **Find interest categories with composition values above 90:**

    ```sql
    SELECT im."interest_name", m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    WHERE m."composition" > 90
    LIMIT 1000;
    ```

9. **Retrieve the count of records per interest category:**

    ```sql
    SELECT im."interest_name", COUNT(*) AS "record_count"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
    ```

10. **List the minimum and maximum composition values for each interest category:**

    ```sql
    SELECT im."interest_name",
           MIN(m."composition") AS "min_composition",
           MAX(m."composition") AS "max_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
    ```

11. **Get the percentile rankings for interest categories in a specific year (e.g., 2023):**

    ```sql
    SELECT im."interest_name", m."percentile_ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    WHERE m."_year" = 2023
    LIMIT 1000;
    ```

12. **Show all interest categories and their index values:**

    ```sql
    SELECT im."interest_name", m."index_value"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    LIMIT 1000;
    ```

13. **Find the composition values for a specific interest category over time:**

    ```sql
    SELECT m."month_year", m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    WHERE m."interest_id" = 5
    ORDER BY m."_year", m."_month"
    LIMIT 1000;
    ```

14. **List all unique interest summaries from `INTEREST_MAP`:**

    ```sql
    SELECT DISTINCT im."interest_summary"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
    LIMIT 1000;
    ```

15. **Retrieve interest categories with their rankings in a specific month:**

    ```sql
    SELECT im."interest_name", m."ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    WHERE m."month_year" = '12-2022'
    LIMIT 1000;
    ```

---

These queries facilitate an understanding of the data in the relevant tables and columns, helping to explore:

- The distribution of composition values across interest categories.
- How composition values change over time.
- The relationships between interest categories and their metrics.
- The identification of potential outliers or trends in the data.

This foundational exploration is essential for addressing the original task effectively.Query:
SELECT DISTINCT im."id", im."interest_name"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
    LIMIT 1000;
Answer:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
15,NBA Fans
16,NCAA Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
29,College Students
35,Mens Clothing Shoppers
42,Fast Fashion Shoppers
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
53,Hip Hop Fans
81,Republicans
90,Coupon Researchers
101,Flower & Gift Basket Shoppers
113,Avid Readers
126,Soccer Fans
163,Federal Employees
4852,Health & Fitness
4937,Evangelical Christians
5943,Financial News Readers
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
54,Online Investors
55,Seasonal Allergy Sufferers
60,Online Health Researchers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
71,Lawn & Garden Enthusiasts
79,Luxury Travel Researchers
80,Democrats
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
93,Young Boomers
102,Plus Size Women
103,Live Concert Fans
107,Cruise Travel Intenders
109,Joint Pain Sufferers
114,Womens Fashion Magazine Readers
123,Military Servicemembers & Veterans
138,Home Kitchen Bakers
4911,Dieters
106,Comedy Fans
136,Tablet Researchers
4859,Business Logistics Managers
4919,Military Families
5936,Fishing Enthusiasts
6214,Home Remodelers
17,MLB Fans
21,DIYers
22,Grill Masters
28,Teachers
36,Baby Products Buyers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
43,Apartment Hunters
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
61,Beauty & Skincare Buyers
85,Online Movie Downloaders
92,Parents with Kids
104,Country Music Fans
110,Pain Management Researchers
121,Coders & Developers
155,Business Travelers
164,Conservative News Readers
168,Social Conservatives
4896,Streaming Music Enthusiasts
34,Teen Girl Clothing Shoppers
50,Discount Big Box Shoppers
56,Discount Device Shoppers
65,Hands-On Parents
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
72,Nurses
74,Office Supply Shoppers
83,Hardware Shoppers
86,Sale Seekers
87,Theme Park Researchers
95,Stay-at-Home Parents
97,Home Kitchen Chefs
100,Nutrition Conscious Eaters
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
124,Healthcare Discount Shoppers
125,Postal Employees
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
139,Makeup Researchers
140,Pet Owners
143,Health Insurance Researchers
146,Audio Equipment Researchers
154,Prepaid Smartphone Shoppers
162,Retirees
4847,Readers of Hispanic Content
4861,IT Decision Makers
4897,Parents of Teenagers Going to College
4899,Readers of Japanese Content
4903,Asthma Sufferers
4909,First Aid Researchers
4912,Vitamin Shoppers
4914,Mens Health Researchers
5916,Shared Work Space Researchers
5924,Cloud Security Researchers
5926,Readers of Data Scientist blogs
5958,Flooring Shoppers
37,Jewelry & Watch Shoppers
48,Charitable Donors
77,Luxury Retail Shoppers
82,HDTV Researchers
116,Home Security Shoppers
134,Home Printer Shoppers
141,Skin Care Researchers
145,Property Insurance Researchers
148,Celebrity Gossip Fans
151,Big & Tall Men
165,Liberal News Readers
166,Doves
4848,Working Parents
4858,Business Filing Researchers
4898,Cosmetics and Beauty Shoppers
4902,Yogis
4906,Sinus Researchers
4920,LGBT Activists
4930,Occupy Movement Supporters
4931,Marijuana Legalization Advocates
5896,Orthopedic Health Researchers
5909,Web Design Researchers
5911,Credit Score Researchers
5917,Caribbean Trip Planners
5918,Enterprise Field Services Researchers
5922,Software Directory Researchers
5938,Costa Rica Trip Planners
5944,Financial Advisors
5946,Readers of Filipinos Content
5956,Recreational Sports Participants
5957,Online Education Intenders
5960,New Zealand Trip Planners
4867,Sweepstakes Enthusiasts
4921,Tire Shoppers
4936,Liberal Think Tank Readers
5929,Employee Management & HR Researchers
5972,Financial Investors
5984,Readers of Indian Content
5999,Readers of African American Content
6029,Indoor Cycling & Spinning Enthusiasts
6045,Engagement Ring Shoppers
6051,Readers of Italian Content
6081,Hawaii Trip Planners
6089,Mens Fitness Publication Readers
6095,Nursing Students
6107,Ski House Second Home Owners
6110,Apartment Furniture Shoppers
6120,Readers of Puerto Rican Content
6127,LED Lighting Shoppers
6149,Readers of Jewish News
6164,Microsoft Friendly Developers
6230,Vegans
6237,Non-Profit Volunteers
6298,Readers of Russian Content
6341,Pharmacy Shoppers
6386,Powerboat Purchasers
7453,Pilots
7598,Readers of South American Content
10839,Tampa and St Petersburg Trip Planners
13498,Restaurant News Readers
16197,Financial Business Intelligence Researchers
49,NHL Fans
66,Fantasy & Comic Fans
73,Mailing & Shipping Shoppers
115,Mens Shoe Shoppers
4935,Conservative Think Tank Readers
14,NFL Fans
27,Auto In
Query:
SELECT m."interest_id", m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.
Query:
SELECT DISTINCT m."month_year"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    LIMIT 1000;
Answer:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019
Query:
SELECT m."composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    ORDER BY m."composition" DESC
    LIMIT 1000;
Answer:
Too long, hard cut:
composition
21.2
20.28
19.45
18.99
18.82
18.39
18.18
17.44
17.19
15.15
15.05
14.92
14.92
14.91
14.39
14.29
14.23
14.15
14.1
13.97
13.9
13.81
13.67
13.64
13.35
13.03
12.93
12.87
12.85
12.8
12.73
12.68
12.64
12.64
12.62
12.62
12.56
12.47
12.42
12.41
12.41
12.33
12.3
12.27
12.26
12.22
12.16
12.03
11.99
11.97
11.93
11.93
11.89
11.75
11.74
11.74
11.73
11.72
11.71
11.68
11.63
11.63
11.61
11.57
11.57
11.5
11.48
11.4
11.38
11.27
11.23
11.21
11.18
11.15
11.14
11.1
11.08
11.06
11.06
11.04
11.03
11.01
11.0
10.99
10.99
10.96
10.95
10.95
10.91
10.91
10.89
10.88
10.86
10.85
10.85
10.82
10.82
10.8
10.79
10.77
10.76
10.71
10.7
10.69
10.62
10.61
10.61
10.61
10.57
10.54
10.52
10.52
10.51
10.5
10.48
10.46
10.43
10.43
10.42
10.4
10.38
10.36
10.32
10.31
10.3
10.29
10.28
10.27
10.26
10.24
10.23
10.22
10.15
10.14
10.12
10.11
10.09
10.08
10.07
10.06
10.05
10.05
10.04
10.0
9.99
9.99
9.98
9.97
9.97
9.97
9.96
9.95
9.93
9.93
9.91
9.91
9.88
9.86
9.85
9.85
9.83
9.82
9.81
9.79
9.77
9.76
9.72
9.71
9.7
9.67
9.66
9.65
9.65
9.65
9.64
9.63
9.62
9.61
9.6
9.6
9.57
9.57
9.55
9.51
9.49
9.48
9.48
9.47
9.46
9.46
9.46
9.46
9.43
9.43
9.43
9.37
9.35
9.34
9.33
9.33
9.31
9.31
9.3
9.3
9.29
9.27
9.25
9.25
9.24
9.23
9.23
9.23
9.22
9.21
9.2
9.19
9.18
9.18
9.15
9.13
9.13
9.12
9.11
9.1
9.1
9.08
9.08
9.06
9.06
9.06
9.04
9.04
9.03
8.98
8.98
8.97
8.96
8.96
8.95
8.94
8.91
8.9
8.87
8.85
8.84
8.84
8.82
8.81
8.81
8.8
8.77
8.72
8.7
8.69
8.69
8.67
8.66
8.66
8.65
8.64
8.62
8.62
8.59
8.59
8.58
8.56
8.55
8.54
8.51
8.5
8.5
8.5
8.49
8.48
8.48
8.47
8.46
8.46
8.46
8.45
8.45
8.44
8.44
8.44
8.43
8.43
8.43
8.41
8.41
8.38
8.37
8.36
8.35
8.32
8.32
8.32
8.31
8.31
8.31
8.3
8.29
8.29
8.28
8.28
8.28
8.27
8.26
8.25
8.25
8.25
8.24
8.23
8.23
8.22
8.21
8.19
8.17
8.17
8.17
8.17
8.16
8.15
8.14
8.14
8.12
8.12
8.1
8.1
8.09
8.09
8.07
8.04
8.04
8.02
8.02
7.99
7.98
7.97
7.95
7.94
7.94
7.93
7.93
7.93
7.92
7.92
7.9
7.9
7.9
7.9
7.89
7.89
7.88
7.88
7.88
7.87
7.87
7.86
7.85
7.85
7.85
7.84
7.83
7.82
7.82
7.81
7.81
7.81
7.8
7.8
7.8
7.79
7.77
7.77
7.76
7.74
7.74
7.74
7.73
7.73
7.73
7.73
7.72
7.72
7.7
7.7
7.7
7.69
7.69
7.69
7.68
7.68
7.68
7.68
7.67
7.67
7.67
7.66
7.66
7.66
7.66
7.65
7.64
7.64
7.64
7.64
7.63
7.63
7.61
7.6
7.6
7.6
7.59
7.56
7.56
7.56
7.56
7.55
7.54
7.53
7.51
7.51
7.5
7.5
7.49
7.49
7.49
7.48
7.48
7.48
7.47
7.47
7.46
7.46
7.46
7.45
7.45
7.45
7.45
7.45
7.44
7.44
7.43
7.43
7.43
7.42
7.42
7.42
7.42
7.41
7.41
7.41
7.4
7.4
7.39
7.39
7.38
7.38
7.38
7.37
7.37
7.37
7.36
7.36
7.35
7.34
7.34
7.33
7.33
7.32
7.31
7.31
7.31
7.3
7.3
7.3
7.29
7.28
7.28
7.28
7.28
7.27
7.26
7.26
7.26
7.26
7.25
7.25
7.25
7.24
7.24
7.23
7.23
7.23
7.23
7.23
7.23
7.22
7.22
7.21
7.21
7.21
7.21
7.21
7.2
7.2
7.19
7.19
7.19
7.19
7.19
7.19
7.18
7.18
7.18
7.17
7.17
7.16
7.16
7.15
7.15
7.15
7.15
7.15
7.13
7.13
7.13
7.13
7.13
7.12
7.12
7.12
7.12
7.11
7.11
7.11
7.1
7.1
7.1
7.09
7.09
7.09
7.08
7.08
7.08
7.08
7.07
7.07
7.06
7.06
7.06
7.06
7.05
7.05
7.04
7.04
7.04
7.04
7.03
7.02
7.02
7.02
7.02
7.02
7.01
7.01
7.01
7.01
7.01
7.0
7.0
7.0
7.0
7.0
6.99
6.99
6.99
6.97
6.97
6.97
6.96
6.96
6.96
6.96
6.96
6.95
6.95
6.95
6.95
6.95
6.94
6.94
6.93
6.93
6.93
6.92
6.92
6.92
6.92
6.92
6.9
6.9
6.88
6.88
6.88
6.88
6.88
6.88
6.88
6.87
6.87
6.86
6.86
6.86
6.85
6.85
6.85
6.85
6.85
6.84
6.84
6.83
6.83
6.83
6.82
6.82
6.82
6.82
6.81
6.81
6.81
6.8
6.8
6.8
6.8
6.8
6.8
6.79
6.79
6.78
6.77
6.77
6.77
6.77
6.77
6.76
6.76
6.76
6.76
6.76
6.76
6.75
6.75
6.75
6.75
6.73
6.73
6.73
6.73
6.72
6.72
6.72
6.71
6.71
6.71
6.71
6.71
6.7
6.7
6.7
6.7
6.7
6.7
6.7
6.69
6.69
6.69
6.68
6.68
6.67
6.67
6.67
6.67
6.67
6.67
6.67
6.67
6.66
6.66
6.66
6.66
6.66
6.65
6.65
6.65
6.65
6.64
6.64
6.64
6.64
6.64
6.63
6.63
6.63
6.63
6.62
6.62
6.62
6.62
6.61
6.61
6.61
6.61
6.61
6.61
6.61
6.61
6.6
6.6
6.6
6.6
6.59
6.59
6.59
6.59
6.59
6.59
6.59
6.59
6.59
6.58
6.58
6.58
6.58
6.58
6.57
6.57
6.57
6.57
6.57
6.57
6.56
6.56
6.56
6.56
6.56
6.56
6.55
6.55
6.55
6.55
6.54
6.54
6.54
6.54
6.53
6.53
6.53
6.53
6.52
6.52
6.52
6.52
6.52
6.52
6.51
6.51
6.51
6.51
6.51
6.5
6.5
6.5
6.5
6.49
6.49
6.49
6.49
6.49
6.49
6.49
6.48
6.48
6.48
6.48
6.48
6.47
6.47
6.47
6.46
6.46
6.46
6.45
6.45
6.45
6.45
6.45
6.45
6.44
6.44
6.44
6.44
6.43
6.43
6.43
6.43
6.42
6.41
6.41
6.41
6.41
6.41
6.41
6.41
6.4
6.4
6.4
6.4
6.4
6.39
6.39
6.39
6.39
6.39
6.39
6.38
6.37
6.37
6.37
6.37
6.37
6.36
6.36
6.36
6.35
6.35
6.34
6.34
6.34
6.34
6.33
6.33
6.33
6.33
6.33
6.33
6.32
6.32
6.31
6.31
6.31
6.31
6.31
6.31
6.3
6.3
6.3
6.3
6.29
6.29
6.29
6.29
6.28
6.28
6.28
6.28
6.28
6.28
6.28
6.28
6.28
6.27
6.27
6.26
6.26
6.26
6.26
6.26
6.26
6.26
6.26
6.25
6.25
6.25
6.25
6.25
6.25
6.25
6.25
6.24
6.24
6.24
6.24
6.24
6.24
6.24
6.23
6.23
6.23
6.23
6.23
6.23
6.23
6.22
6.22
6.22
6.22
6.21
6.21
6.2
6.2
6.2
6.19
6.19
6.19
6.18
6.18
6.18
6.18
6.18
6.17
6.17
6.17
6.17
6.17
6.17
6.17
6.16
6.16
6.16
6.15
6.15
6.15
6.15
6.15
6.15
6.15
6.15
6.15
6.14
6.14
6.14
6.14
6.14
6.14
6.14
6.13
6.13
6.13
6.13
6.12
6.12
6.12
6.11
6.11
6.11
6.11
6.11
6.11
6.11
6.11
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.1
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.09
6.08
6.08
6.08
6.07
6.07
6.07
6.07
6
Query:
SELECT im."interest_name", MAX(m."composition") AS "max_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_name,max_composition
Online Home Decor Shoppers,10.85
Luxury Travel Researchers,11.21
Home Remodelers,9.71
Tech-Savvy Moms,10.29
Travel Reward Points Enthusiasts,11.48
Sporting Goods Shoppers,9.48
Drama Show Watchers,6.09
Womens Fashion Magazine Readers,6.25
Online Health Researchers,8.66
Pandora Jewelry Shoppers,12.27
Womens Fitness Enthusiasts,6.47
Pet Store Goers,6.82
Beach House Second Home Owners,6.65
Breast Cancer Fund Raisers,6.26
Discount Womens Shoes Shoppers,7.08
Travel Researchers,10.14
Luxury Retail Researchers,13.97
MLB Fans,7.89
Mens Shoe Shoppers,11.68
Baby Products Buyers,9.27
Gourmet Food & Wine Researchers,6.45
Retirees,5.16
Microsoft Friendly Developers,5.37
Cosplay Enthusiasts,6.05
Weight Loss Researchers,10.8
Philadelphia Trip Planners,6.52
Young Boomers,7.08
Real Estate Decision Makers,8.23
Mens Health Researchers,7.42
Dog Lovers,6.28
Entertainment & Tabloid Magazine Readers,5.99
Online Grocery Shoppers,10.7
Auto-Looking for New Car Purchase or Lease,5.89
Italian Food Enthusiasts,7.31
Toyota Vehicle Shopper,7.15
Horse Owners,5.75
Arizona Trip Planners,7.37
Law Enforcement Officers,6.14
Ink & Toner Shoppers,7.23
Business Logistics Managers,6.48
Discount Device Shoppers,7.09
Online Alcohol Shoppers,7.94
Recipe Researchers,6.85
World Cup Apparel Shoppers,7.36
Engagement Ring Shoppers,7.42
Natural and Holistic Health Researchers,5.78
Competitive Car Brand Shoppers,6.7
Readers of Panamanian Content,2.88
Home Kitchen Chefs,6.41
Luxury Department Store Shoppers,11.38
Lacrosse Enthusiasts,8.24
Organic Food Buyers,6.82
Gastrointestinal Researchers,6.29
Cigars Shoppers,5.08
Used Car Shoppers,3.44
Kitchen & Bathroom Remodelers,6.5
Tampa and St Petersburg Trip Planners,5.59
Weight Lifting Enthusiasts,5.36
Gastroenterologists,7.7
China Trip Planners,6.26
Avid Readers,5.53
The Walking Dead Fans,5.29
Healthcare Discount Shoppers,7.56
Caribbean Trip Planners,4.32
Running Enthusiasts,9.29
Cholesterol Researchers,6.09
New & Expecting Parents,9.37
Womens Fashion Brands Shoppers,13.67
Wedding Registrants,6.83
Home Decor Shoppers,7.9
North Carolina Football Fans,6.61
Property Insurance Researchers,4.89
Shoe Shoppers,14.91
Fitness Enthusiasts,7.02
TV Junkies,5.3
Yogis,8.17
Streaming Radio Listeners,6.88
Medical Advice Researchers,7.88
Home Design Enthusiasts,6.54
Country Music Fans,5.42
Financial Investors,6.6
San Francisco Trip Planners,7.39
Hands-On Parents,5.94
Diabetes,6.79
Soccer Fans,6.67
Tax Policy Researchers,6.29
Nissan Vehicle Shoppers,8.09
TV Advertising Professionals,6.21
Tesla Enthusiasts,5.79
Architecture Enthusiasts,7.1
Fantasy & Comic Fans,6.51
Android Fans,5.09
High-End Kids Furniture and Clothes Shoppers,12.41
Solar Energy Solution Shoppers,7.02
Teen Content Readers,6.1
Gourmet Food Purchasers,6.85
Apartment Hunters,5.98
UFC and MMA Fans,3.17
Eye Health Researchers,3.17
Las Vegas Trip Planners,10.3
Reusable Drinkware Shoppers,13.35
Big & Tall Men,7.97
Harry Potter Fans,11.72
Postal Employees,6.38
New York Trip Planners,8.31
Italian Chain Restaurant Eaters,7.33
Las Vegas Nightlife Researchers,7.44
Gun Control Advocates,6.4
Los Angeles Mass Transit Commuters,7.15
Online Directory Searchers,3.77
Outdoors Enthusiasts,4.41
Olympics Fans,9.65
Techies,5.41
Entertainment Industry Decision Makers,5.85
BMW Vehicle Shoppers,5.87
Jewelry & Watch Shoppers,7.82
Audi Vehicle Shoppers,5.87
Beauty & Skincare Buyers,6.59
Healthy Snacks Shoppers,6.32
Luxury Womens Brands Shoppers,7.66
Food Safety Decision Makers,9.33
Environmental Activists,7.55
Gastroenterology Journal Researchers,6.56
Non-Profit Volunteers,7.7
Cat Lovers,5.36
Affordable Hotel Bookers,7.8
Restaurant News Readers,6.42
Joint Pain Sufferers,6.75
Horror Movie Fans,5.21
Rideshare App Users,6.6
Eyeglasses & Contact Lens Buyers,7.59
Teen Girl Clothing Shoppers,11.23
Order-in Eaters,6.79
Office Supply Shoppers,7.37
Orthopedic Health Researchers,6.09
Sailing Enthusiasts,4.67
Cruise Travel Intenders,8.32
Vacuum Shoppers,7.25
Ducati Motorcycle Shoppers,5.21
Investment Management Professionals,4.12
Charitable Donors,5.55
Restaurant Supply Shoppers,9.03
Seattle Trip Planners,5.67
Home Printer Shoppers,5.28
Sony Fans,4.32
Bodybuilding Enthusiasts,3.78
Lawn & Garden Enthusiasts,3.43
United Arab Emirates Trip Planners,4.45
Senior Caregivers,3.94
Ancestry Researchers,2.99
Building Service Contractors,3.69
Satellite TV Buyers,3.26
New Homeowners,3.13
Tire Researchers,2.65
Readers of Costa Rican Content,3.67
Fireworks Enthusiasts,2.97
Tractor Shoppers,2.75
Kansas City Chiefs Fans,2.47
Luxury Watch Shoppers,3.87
Washington Nationals Fans,2.84
Auburn Tigers Fans,3.26
Palm Beach Trip Planners,3.0
Meal Kit Delivery Researchers,4.41
Spy Gadgets Shoppers,3.2
Electric Vehicle Shoppers,2.29
NHL Fans,5.09
Hanukkah Decorations Shoppers,6.14
Social Conservatives,3.75
New Years Eve Party Ticket Purchasers,10.62
Nascar Fans,3.18
Marijuana Legalization Advocates,4.05
Texas Trip Planners,3.85
Action Figure and Collectibles Shoppers,2.55
Veterinarians,2.71
Off the G
Query:
SELECT im."interest_name", AVG(m."composition") AS "average_composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
      ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 1000;
Answer:
Too long, hard cut:
interest_name,average_composition
Vacation Rental Accommodation Researchers,5.0249999999999995
Luxury Second Home Owners,2.9676923076923076
Hair Care Shoppers,2.9829999999999997
Nutrition Conscious Eaters,3.2728571428571427
Healthy Eaters,3.281538461538461
Wine Lovers,5.181666666666667
Home Design and Living Publication Readers,4.9575000000000005
Apartment Furniture Shoppers,4.651428571428572
Mature Parents,4.496666666666667
Misc-Deal Seekers or Coupon Shoppers,2.752727272727273
Vacation Planners,8.330714285714285
Competitive Sports Participants,4.616428571428571
Mens Fitness Publication Readers,2.612727272727273
Gluten-Free Recipe Researchers,3.6592857142857143
Parents with Kids,3.123076923076923
Golf Enthusiasts,4.771428571428571
NBA Fans,2.8021428571428575
Lobbyists,3.29
Luxury Kitchen Goods Shoppers,5.8149999999999995
Financial News Readers,2.5500000000000003
Exercise and Gym Researchers,2.9114285714285715
Preppy Clothing Shoppers,6.723571428571428
Paleo Eaters,3.2808333333333337
Halloween Costume Shoppers,7.578571428571429
Flight and Hotel Shoppers,7.320714285714286
Pregnancy Resources Researchers,2.852727272727273
Jaguar Vehicle Shoppers,3.470714285714286
Beach Supplies Shoppers,9.51142857142857
Luxury Retail Shoppers,9.762142857142859
Land Rover Shoppers,4.900714285714286
Luxury Hotel Guests,9.36357142857143
High End Camera Shoppers - Dupe,7.605
Ski House Second Home Owners,4.337857142857143
Bed & Bath Shoppers,3.9664285714285716
Costa Rica Trip Planners,4.667857142857143
Supermarket Shoppers,3.9042857142857144
Health & Fitness,2.975
Cycling Enthusiasts,4.097857142857142
Readers of Filipinos Content,2.2920000000000003
Financial Business Intelligence Researchers,2.463636363636364
Coffee Chain Shoppers,3.9050000000000002
Brides & Wedding Planners,3.6814285714285715
Sale Seekers,2.5207142857142855
Restaurant Researchers,3.672857142857143
Kids Clothing Shoppers,5.041428571428571
Sports Medicine Health Care Professionals,5.595
Thrift Store Shoppers,3.1735714285714285
Rugby Fans,3.112142857142857
NCAA Fans,3.65
Natural Pet Food Shoppers,5.588571428571428
Luxury Bedding Shoppers,11.093571428571428
Food Industry Professionals,4.966428571428572
Work Comes First Travelers,17.482499999999998
Major Airline Customers,5.055714285714286
Mazda Vehicle Shoppers,3.8808333333333334
Los Angeles Trip Planners,3.637857142857143
Photo Memory Makers,3.475
Skin Care Researchers,6.993571428571428
Kosher Recipe Researchers,3.3778571428571427
Credit Score Researchers,5.557857142857143
San Diego Trip Planners,3.9385714285714286
Cleveland Cavaliers Fans,2.091111111111111
Medicare Provider Researchers,5.0649999999999995
Motorcycle Purchasers,2.3642857142857143
Portugal Trip Planners,7.999285714285714
Parents of Teenagers Going to College,6.028571428571429
Price Conscious Home Shoppers,3.507142857142857
Gym Equipment Owners,10.486428571428572
High-End Camera Shoppers,3.920714285714286
Live Concert Fans,2.6733333333333333
Liberal News Readers,2.423
Boston Trip Planners,3.220714285714286
Dieters,3.2399999999999998
Competitive Tri-Athletes,6.445
Realtors & Real Estate Researchers,2.858571428571429
Womens Health Researchers,4.661666666666666
Pharmacy Shoppers,2.5872727272727274
Luggage Shoppers,5.212142857142857
Personal Stock Portfolio Managers,4.179230769230769
Investment Banking Professionals,4.4314285714285715
Social Liberals,2.407272727272727
Metal and Rock Music Fans,2.826363636363636
Tailgaters,3.823571428571429
Furniture Shoppers,9.507857142857144
Yale University Fans,4.077142857142857
Conservative News Readers,2.4844444444444442
Tech News Enthusiasts,2.349
Retirement Planners,3.6214285714285714
Charitable Organization Researchers,3.3278571428571424
Personal Investment Researchers,2.7992307692307694
Commercial Contractors & Designers,4.256428571428571
Patio Furniture Shoppers,7.9799999999999995
Executive and C-Suite,2.5999999999999996
Landscape Architects,3.5892857142857144
Major Appliance Shoppers,3.3721428571428573
March Madness Enthusiasts,2.9785714285714286
Home Kitchen Bakers,3.3592307692307695
Pre-Measured Grocery Shoppers,6.75
Home Wifi Researchers,3.587857142857143
Phoenix Trip Planners,2.670714285714286
Special Olympics Fans,4.590714285714285
New Zealand Trip Planners,7.62
Coupon Researchers,2.347272727272727
Junk Food Lovers,2.4850000000000003
Drug Store Shoppers,3.065
Luxury Home Fixture Shoppers,6.7542857142857144
Beer Lovers,3.6900000000000004
Denver Trip Planners,3.626428571428572
Mid-Range Grocery Shoppers,3.942142857142857
Readers of Pakistani Content,2.467142857142857
Food Allergies Researchers,2.8884615384615384
Fantasy Football Enthusiasts,2.5942857142857143
Pharmacists,3.285
Fishing Equipment Shoppers,5.497142857142857
Business News Readers,2.746923076923077
Readers of South Asian Content,2.3722222222222222
Tax Filers,2.4538461538461536
BBQ Recipe Researchers,2.721538461538462
Eco-Conscious Consumers,2.664
Christmas Celebration Researchers,8.622142857142858
Fast Food Lovers,2.305
Grill Masters,2.906153846153
Query:
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        m."composition" AS "Composition_Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
        JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
            ON m."interest_id" = im."id"
)
SELECT
    mc."Time",
    mc."interest_name",
    mc."Composition_Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition_Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition_Value" ASC) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) mc
WHERE
    mc.rank_desc <= 10 OR mc.rank_asc <= 10
ORDER BY
    mc.rank_desc;
Answer:
Time,interest_name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Query:
-- Corrected Query 1
SELECT im."interest_name", m."composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
WHERE m."composition" > 15
LIMIT 1000
Answer:
interest_name,composition
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Work Comes First Travelers,18.18
Luxury Boutique Hotel Researchers,15.15
Work Comes First Travelers,20.28
Work Comes First Travelers,19.45
Work Comes First Travelers,21.2
Luxury Bedding Shoppers,15.05
Work Comes First Travelers,18.99
Work Comes First Travelers,18.39
Query:
-- Corrected Query 2
SELECT im."interest_name", COUNT(*) AS "record_count"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
GROUP BY im."interest_name"
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,record_count
Vacation Rental Accommodation Researchers,14
Luxury Second Home Owners,13
Hair Care Shoppers,10
Nutrition Conscious Eaters,14
Healthy Eaters,13
Wine Lovers,12
Home Design and Living Publication Readers,12
Misc-Deal Seekers or Coupon Shoppers,11
Gluten-Free Recipe Researchers,14
Parents with Kids,13
Exercise and Gym Researchers,14
Parents of Teenagers Going to College,14
Indoor Cycling & Spinning Enthusiasts,14
Health & Fitness,12
Preppy Clothing Shoppers,14
Eco-Conscious Consumers,10
Restaurant Researchers,14
Online Movie Downloaders,14
Apartment Furniture Shoppers,14
Competitive Sports Participants,14
NCAA Fans,14
Camera Review Readers,13
Beer Lovers,14
Denver Trip Planners,14
Readers of Filipinos Content,10
Conservative News Readers,9
Vacation Planners,14
Kitchen Appliance Shoppers,14
Mens Fitness Publication Readers,11
Luxury Hotel Guests,14
Portugal Trip Planners,14
Luxury Kitchen Goods Shoppers,14
Costa Rica Trip Planners,14
Financial Business Intelligence Researchers,11
Jaguar Vehicle Shoppers,14
Yale University Fans,14
Thrift Store Shoppers,14
Junk Food Lovers,10
Luxury Home Fixture Shoppers,14
College Football Fans,14
Sweet Tooths,14
Competitive Tri-Athletes,14
Realtors & Real Estate Researchers,14
March Madness Enthusiasts,14
Professional Chefs,14
Readers of Italian Content,14
Commercial Vehicles Shoppers,14
Metal and Rock Music Fans,11
Gym Equipment Owners,14
Tech News Enthusiasts,10
Work Comes First Travelers,8
Fast Food Lovers,10
New Orleans Trip Planners,14
Chelsea Fans,14
Ski House Second Home Owners,14
Readers of South Asian Content,9
Rugby Fans,14
Executive Travelers,8
Halloween Thrill Seekers,14
Recently Retired Individuals,14
Arthritis Sufferers,14
Star Wars Fans,4
Reality TV Show Watchers,5
Pharmacists,14
Boston Trip Planners,14
Beer Aficionados,14
Executive and C-Suite,13
Golf Enthusiasts,14
Natural Pet Food Shoppers,14
Personal Stock Portfolio Managers,13
Flight and Hotel Shoppers,14
Luxury Boutique Hotel Researchers,14
Tailgaters,14
Golden State Warriors Fans,13
Mature Parents,12
Land Rover Shoppers,14
NBA Fans,14
Lobbyists,14
Halloween Costume Shoppers,14
Pharmacy Shoppers,11
Business News Readers,13
Luxury Bedding Shoppers,14
Furniture Shoppers,14
Home Kitchen Bakers,13
Mazda Vehicle Shoppers,12
Family Medical Practice Journal Researchers,14
Physicians,14
European Trip Planners,14
Cycling Enthusiasts,14
Beach Supplies Shoppers,14
Sports Medicine Health Care Professionals,14
Coupon Researchers,11
Drug Store Shoppers,14
Tax Filers,13
Cloud Security Researchers,10
Foreman and Construction Managers,14
North Carolina Travel Researchers,14
Pregnancy Resources Researchers,11
Dieters,14
Home Buyers,14
Investment Banking Professionals,14
High-End Camera Shoppers,14
HDTV Researchers,14
Cosmetics and Beauty Shoppers,14
Adult Acne Sufferers,12
College Aspirants,14
Democrats,14
Austin Trip Planners,14
Readers of Jewish News,14
Readers of Mexican Content,10
Online Calculator Users,9
High End Camera Shoppers - Dupe,2
Landscape Architects,14
Kids Clothing Shoppers,14
Luxury Retail Shoppers,14
Retirement Planners,14
Charitable Organization Researchers,14
Heartburn Sufferers,12
Special Olympics Fans,14
Personal Investment Researchers,13
Los Angeles Trip Planners,14
Commercial Contractors & Designers,14
LGBT Activists,10
BBQ Recipe Researchers,13
Skin Care Researchers,14
Kosher Recipe Researchers,14
Patriotic Party Decoration Shoppers,14
Online Shoppers,14
Blockbuster Movie Fans,2
Budget Small Business Researchers,14
Home Security Shoppers,13
Military Families,14
"Work Hard, Play Hard Travelers",8
RC Helicopters and Drones Hobbyists,12
France Trip Planners,14
Readers of Hispanic Content,7
Readers of Indian Content,3
Neurologists,14
Indie Coffee Shoppers,14
Occupy Movement Supporters,13
Phone Accessory Shoppers,14
Liberal Think Tank Readers,14
Atlanta Falcons Fans,12
Discount Big Box Shoppers,14
Dallas Trip Planners,14
Photography Enthusiasts,14
Getting Off the Grid Travelers,8
Food Safety QA Professionals,14
Pain Management Researchers,14
Classic Car Shoppers,14
Family Halloween Party Planners,14
Loan Comparison Researchers,14
Deodorant Shoppers,11
Readers of Arabic Content,10
Readers of Puerto Rican Content,12
Colombia Trip Planners,9
Readers of Belizean Content,10
Truck Shoppers,9
Beard Care Shoppers,14
Jacksonville Jaguars Fans,10
Los Angeles Rams Fans,10
Embroidery Enthusiasts,11
Paintball Enthusiasts,7
Louisiana State University Tigers Fans,9
Cattle Industry New Readers,4
Christmas Celebration Researchers,14
Jeep Vehicle Shoppers,14
Thanksgiving Entertaining Researchers,14
Prepaid Smartphone Shoppers,11
Jazz Music Fans,13
Hard Rock Hotel & Casino Trip Planners,13
Myrtle Beach Trip Planners,8
Civil War History Buff,7
Nature and Outdoors Book Readers,8
Kitchen Stove Shoppers,7
Tutoring Resources Researchers,7
Godiva Chocolate Fans,9
Arsenal Fans,14
Asthma Sufferers,14
Clinic & Lab Immunologist Professionals,14
Denver Nuggets Fans,9
Bed & Bath Shoppers,14
Harvard University
Query:
-- Corrected Query 3
SELECT im."interest_name",
       MIN(m."composition") AS "min_composition",
       MAX(m."composition") AS "max_composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
GROUP BY im."interest_name"
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,min_composition,max_composition
Vacation Rental Accommodation Researchers,2.42,11.89
Luxury Second Home Owners,1.61,9.93
Hair Care Shoppers,1.77,10.32
Healthy Eaters,1.64,10.82
Home Design and Living Publication Readers,2.26,10.11
Apartment Furniture Shoppers,2.48,11.57
Mature Parents,2.64,9.47
Misc-Deal Seekers or Coupon Shoppers,1.65,9.49
Land Rover Shoppers,2.69,12.62
Vacation Planners,2.87,12.56
Luxury Hotel Guests,3.84,14.1
Gluten-Free Recipe Researchers,1.92,11.04
Liberal News Readers,1.55,6.05
NBA Fans,1.86,6.9
Natural Pet Food Shoppers,1.92,10.95
Apple Fans,1.98,7.48
Metal and Rock Music Fans,1.82,5.41
Kids Clothing Shoppers,3.08,7.6
Lobbyists,1.86,10.43
Preppy Clothing Shoppers,4.22,10.76
Competitive Tri-Athletes,3.85,9.97
Pregnancy Resources Researchers,1.71,9.13
Coffee Chain Shoppers,2.37,8.07
Luxury Boutique Hotel Researchers,4.21,15.15
Plus Size Women,2.79,7.74
Canada Trip Planners,2.41,4.22
Wine Lovers,2.36,10.71
Kitchen Appliance Shoppers,2.97,12.22
Price Conscious Home Shoppers,2.13,7.19
Readers of Filipinos Content,1.67,5.99
Eco-Conscious Consumers,1.79,6.57
Nutrition Conscious Eaters,1.63,10.77
High End Camera Shoppers - Dupe,4.3,10.91
Costa Rica Trip Planners,2.73,11.63
Supermarket Shoppers,1.88,11.63
NCAA Fans,2.29,6.24
Paleo Eaters,1.55,10.22
Conservative News Readers,1.58,6.14
March Madness Enthusiasts,2.3,3.98
Retirement Planners,2.43,7.42
Sports Medicine Health Care Professionals,3.62,8.02
Special Olympics Fans,2.62,8.81
Drug Store Shoppers,1.79,6.96
Hematologists,1.65,6.24
Countdown to the Beach Travelers,4.13,8.5
Job Seekers,1.65,3.4
Luxury Bedding Shoppers,4.63,15.05
Car Enthusiasts,1.73,6.14
Thrift Store Shoppers,1.99,7.23
France Trip Planners,2.61,6.05
Stay-at-Home Parents,2.26,7.15
Halloween Thrill Seekers,2.46,7.35
Green Bay Packers Fans,1.61,3.38
Diesel Vehicle Shoppers,2.11,4.86
Utility Workwear Shoppers,3.16,5.88
Auto Insurance Shoppers,1.58,6.81
Aftermarket Accessories Shoppers,1.88,3.62
Financial Business Intelligence Researchers,1.59,6.13
Personal Investment Researchers,1.69,6.95
BBQ Enthusiasts,1.58,6.66
Foreman and Construction Managers,1.85,6.5
Sports Gamblers,1.89,4.14
Evangelical Christians,1.6,3.77
Washington Redskins Fans,1.72,2.39
Competitive Sports Participants,2.45,9.35
Portugal Trip Planners,3.11,11.61
Live Concert Fans,1.74,6.61
Luxury Kitchen Goods Shoppers,3.24,12.87
Boston Trip Planners,1.8,8.14
Brides & Wedding Planners,1.78,10.82
Ski House Second Home Owners,2.62,8.84
Phoenix Trip Planners,1.76,6.65
Bed & Bath Shoppers,2.34,10.86
Advertising Professionals,1.56,6.72
Market Intelligence Researchers,1.62,6.2
Golf Enthusiasts,2.99,9.97
Indoor Cycling & Spinning Enthusiasts,2.27,10.05
Dieters,2.07,6.87
Gym Equipment Owners,6.94,18.82
Food Allergies Researchers,1.83,6.28
Mazda Vehicle Shoppers,2.34,5.57
Rugby Fans,1.85,6.67
Fast Food Lovers,1.61,6.1
Health & Fitness,1.59,6.77
Landscape Architects,1.99,7.81
Sale Seekers,1.63,6.13
Social Liberals,1.57,6.1
Furniture Shoppers,6.03,17.44
Beach Supplies Shoppers,3.71,13.03
Major Appliance Shoppers,2.07,7.01
New Zealand Trip Planners,3.12,10.61
Fantasy Football Enthusiasts,1.87,3.82
BBQ Recipe Researchers,1.74,6.41
Streaming Video Fans,1.77,6.01
Urban Skateboarding Sneaker Shoppers,4.39,8.45
Sightseeing Travelers,2.36,5.92
Hiking Enthusiasts,1.58,4.54
Cleveland Cavaliers Fans,1.59,3.03
Flooring Shoppers,2.29,4.27
Videographers,1.57,3.8
Powerboat Purchasers,1.9,3.73
Financial News Readers,1.64,6.37
Womens Health Researchers,2.66,6.76
Parents of Teenagers Going to College,3.66,12.93
Cycling Enthusiasts,2.61,6.37
Executive and C-Suite,1.55,6.45
Online Shoppers,2.13,4.39
Military Families,1.76,6.52
Realtors & Real Estate Researchers,1.83,6.28
Luggage Shoppers,3.52,9.64
Restaurant Researchers,2.26,7.64
Online Movie Downloaders,1.9,6.46
Home Kitchen Bakers,1.76,7.3
Readers of South Asian Content,1.65,5.86
Coupon Researchers,1.68,5.91
Junk Food Lovers,1.68,6.18
College Football Fans,2.03,5.47
Professional Chefs,1.81,6.78
LGBT Activists,1.56,5.93
Skin Care Researchers,3.12,9.46
Christmas Celebration Researchers,3.24,12.16
Crypto Market Investors,1.66,5.65
Patriotic Party Decoration Shoppers,2.24,7.22
Readers of Italian Content,2.36,5.31
Cardio Health Researchers,2.2,7.89
Family Medical Practice Journal Researchers,1.71,7.15
Home Security Shoppers,1.67,6.31
Sweet Tooths,1.88,7.2
NFL Fans,1.56,3.53
College Aspirants,2.36,6.09
Executive Travelers,4.87,6.88
North Carolina Travel Researchers,1.97,7.8
Chelsea Fans,3.16,10.36
Pediatricians,1.74,6.88
Moving Services Shoppers,1.77,6.29
Mexican Food Enthusiasts,1.54,6.16
Hardware Shoppers,1.89,4.64
European Trip Planners,2.75,6.25
FC Barcelona Fans,1.67,3.52
Seattle Seahawks Fans,1.71,5.0
Readers of Greek Content,1.91,4.39
Phone Accessory Shoppers,2.23,5.08
Dentists,2.16,5.08
Rapid City Trip Planners,1.94,4.11
Online Daters,1.83,4.13
Coin Collectors,1.67,3.35
Farmers,1.63,4.38
Classic Car Shoppers,1.65,6.18
Texas Energy Providers,1.85,3.03
In-Market Car Shoppers,2.12,3.5
Query:
-- Corrected Query 4
SELECT im."interest_name", m."percentile_ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
WHERE m."_year" = 2019
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,percentile_ranking
Winter Apparel Shoppers,99.9
Mens Shoe Shoppers,99.79
Fitness Activity Tracker Users,99.69
Luxury Retail Researchers,99.59
Competitive Tri-Athletes,99.49
Preppy Clothing Shoppers,99.38
Luxury Home Fixture Shoppers,99.28
Shoe Shoppers,99.18
Running Enthusiasts,99.08
Work Comes First Travelers,98.97
Family Adventures Travelers,98.87
Womens Fashion Brands Shoppers,98.77
Apartment Furniture Shoppers,98.77
World Cup Enthusiasts,98.77
"Work Hard, Play Hard Travelers",98.46
Beach Supplies Shoppers,98.36
At-Home Gym Intenders,98.25
Aspen Skiers and Snowboarders,98.25
Kids Clothing Shoppers,98.05
Luxury Boutique Hotel Researchers,97.94
Parents of Teenagers Going to College,97.84
Competitive Sports Participants,97.74
Luxury Bedding Shoppers,97.64
Vacation Planners,97.64
Trendy Denim Shoppers,97.43
Ski and Snowboard Apparel Shoppers,97.33
Luxury Retail Shoppers,97.23
Luxury Kitchen Goods Shoppers,97.23
Big & Tall Men,97.23
Swimming Enthusiasts,96.92
Home Decor Shoppers,96.81
High-End Kids Furniture and Clothes Shoppers,96.71
Colorado Skiers and Snowboarders,96.61
Lacrosse Enthusiasts,96.61
Urban Skateboarding Sneaker Shoppers,96.4
Furniture Shoppers,96.4
Cycling Enthusiasts,96.4
Reusable Drinkware Shoppers,96.4
Vacation Rental Accommodation Researchers,95.99
Olympics Fans,95.89
Golf Enthusiasts,95.89
Japanese Luxury Car Enthusiasts,95.89
Luggage Shoppers,95.89
Vermont Trip Planners,95.48
Fishing Equipment Shoppers,95.38
Luxury Hotel Guests,95.27
Sporting Goods Shoppers,95.27
Gym Equipment Owners,95.07
World Cup Apparel Shoppers,95.07
Western Canada Skiers and Snowboarders,94.86
Kitchen Appliance Shoppers,94.76
Sports Medicine Health Care Professionals,94.66
Getting Off the Grid Travelers,94.66
Luxury Womens Brands Shoppers,94.45
Pandora Jewelry Shoppers,94.35
Flight and Hotel Shoppers,94.24
European Trip Planners,94.14
Hanukkah Decorations Shoppers,94.04
Utility Workwear Shoppers,94.04
Ski House Second Home Owners,94.04
Sports Memorabilia Shoppers,93.73
Luxury Department Store Shoppers,93.63
Leather Goods Shoppers,93.53
Big East Fans,93.53
Discount Womens Shoes Shoppers,93.53
Identity Theft Protection Researchers,93.22
Luxury Travel Researchers,93.22
Christmas Celebration Researchers,93.22
Affordable Hotel Bookers,92.91
Costa Rica Trip Planners,92.91
Major Airline Customers,92.7
Price Conscious Home Shoppers,92.7
North Carolina Football Fans,92.5
Online Home Decor Shoppers,92.39
Jewelry & Watch Shoppers,92.39
Indoor Cycling & Spinning Enthusiasts,92.19
Sun Protection Shoppers,92.09
Kitchen and Home Goods Shoppers,92.09
Special Olympics Fans,92.09
NCAA Fans,91.78
New York Trip Planners,91.68
Broadway Fans,91.68
Soap Shoppers,91.47
Countdown to the Beach Travelers,91.47
Neurologists,91.47
Online Grocery Shoppers,91.47
Jazz Festival Enthusiasts,91.47
Canoeing and Kayaking Enthusiasts,91.47
Chandelier and Lamp Shoppers,91.47
Halloween Costume Shoppers,90.75
Embroidery Enthusiasts,90.75
Patio Furniture Shoppers,90.75
NCAA Football Fans,90.75
Land Rover Shoppers,90.34
Bed & Bath Shoppers,90.24
Hawaii Trip Planners,90.24
Military Personal Finance Researchers,90.24
New Zealand Trip Planners,90.24
Mattress Researchers,89.83
Investment Banking Professionals,89.72
Dance Clothing Shoppers,89.72
Travel Researchers,89.72
Pre-Measured Grocery Shoppers,89.72
Flower & Gift Basket Shoppers,89.72
March Madness Enthusiasts,89.21
Summer Activities Researchers,89.21
Sightseeing Travelers,89.21
Spa Goers,88.9
Blender Shoppers,88.8
Online Alcohol Shoppers,88.8
Godiva Chocolate Fans,88.59
Dieters,88.59
Health & Fitness,88.59
Waterfront Vacationers,88.28
Chocolate Lovers,88.28
Cardio Health Researchers,88.28
Italian Chain Restaurant Eaters,88.28
Yogis,88.28
NHL Fans,87.77
Promotional Products Purchasers,87.77
Billiards Enthusiasts,87.77
Retirement Planners,87.77
Gen Z Apparel Shoppers,87.77
Meal Kit Delivery Researchers,87.26
Houston Trip Planners,87.15
Scuba Diving Enthusiasts,87.15
Portugal Trip Planners,87.15
Surfers,87.15
Teen Girl Clothing Shoppers,87.15
Discount Device Shoppers,86.64
Chelsea Fans,86.64
Sunglasses Shoppers,86.64
Little Rock Trip Planners,86.64
Supply Chain Professionals,86.64
Long Beach California Trip Planners,86.64
Executive Travelers,86.64
Skin Care Researchers,86.64
Clemson Tigers Fans,86.64
Financial Advisors,85.71
Commercial Healthcare Hospitality & Retail Designers,85.71
Kitchen and Bath Professionals,85.51
Austin Trip Planners,85.51
Readers of Italian Content,85.51
Restaurant Researchers,85.51
MLB Fans,85.51
Christmas Decorations Shoppers,85.51
Avid Readers,84.89
Health and Fitness Book Readers,84.89
Manchester United Fans,84.89
Department Store Shoppers,84.89
Online Shoppers,84.89
Beauty & Skincare Buyers,84.89
Duke Blue Devils Fans,84.28
Pediatric Provider Researchers,84.28
Tea Drinkers,84.28
Canada Trip Planners,84.28
Orthopedic Health Researchers,84.28
School Supply Shoppers,84.28
Ski and Snowboard Enthusiasts,84.28
Flooring Shoppers,83.56
Venture Capitalists,83.56
Car Rental S
Query:
-- Corrected Query 5
SELECT im."interest_name", m."index_value"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,index_value
Vacation Rental Accommodation Researchers,6.19
Luxury Second Home Owners,5.31
Online Home Decor Shoppers,5.29
Hair Care Shoppers,5.1
Nutrition Conscious Eaters,5.04
Healthy Eaters,5.03
Luxury Travel Researchers,4.97
Wine Lovers,4.83
Home Remodelers,4.83
Home Design and Living Publication Readers,4.81
Apartment Furniture Shoppers,4.79
Mature Parents,4.67
Weight Loss Researchers,4.62
Luxury Retail Researchers,4.53
Running Enthusiasts,4.5
Misc-Deal Seekers or Coupon Shoppers,4.49
Shoe Shoppers,4.47
Land Rover Shoppers,4.38
MLB Fans,4.15
Vacation Planners,4.08
Competitive Sports Participants,3.99
Tech-Savvy Moms,3.95
Kitchen Appliance Shoppers,3.92
Mens Fitness Publication Readers,3.84
Travel Reward Points Enthusiasts,3.82
Luxury Hotel Guests,3.82
Gluten-Free Recipe Researchers,3.81
Parents with Kids,3.77
Reusable Drinkware Shoppers,3.75
Portugal Trip Planners,3.74
New & Expecting Parents,3.73
Live Concert Fans,3.69
Sporting Goods Shoppers,3.66
Womens Fashion Brands Shoppers,3.65
Golf Enthusiasts,3.64
Liberal News Readers,3.59
Drama Show Watchers,3.58
NBA Fans,3.56
Lobbyists,3.55
Wedding Registrants,3.55
Mens Health Researchers,3.55
Mens Shoe Shoppers,3.53
Luxury Kitchen Goods Shoppers,3.53
Baby Products Buyers,3.51
Financial News Readers,3.48
High End Camera Shoppers - Dupe,3.44
Fitness Enthusiasts,3.44
Womens Fashion Magazine Readers,3.41
Ski House Second Home Owners,3.39
TV Junkies,3.39
Online Health Researchers,3.36
Exercise and Gym Researchers,3.35
Pandora Jewelry Shoppers,3.33
Bed & Bath Shoppers,3.32
Dog Lovers,3.32
Luxury Department Store Shoppers,3.3
Costa Rica Trip Planners,3.29
Womens Fitness Enthusiasts,3.29
Parents of Teenagers Going to College,3.27
Indoor Cycling & Spinning Enthusiasts,3.26
Home Decor Shoppers,3.26
Olympics Fans,3.24
Pet Store Goers,3.22
Supermarket Shoppers,3.22
Boston Trip Planners,3.22
Health & Fitness,3.2
NCAA Fans,3.2
Beach House Second Home Owners,3.17
Preppy Clothing Shoppers,3.17
Breast Cancer Fund Raisers,3.15
Paleo Eaters,3.15
Beer Aficionados,3.15
Yogis,3.12
Harry Potter Fans,3.1
Natural Pet Food Shoppers,3.08
Dieters,3.08
Cholesterol Researchers,3.07
Competitive Tri-Athletes,3.04
Price Conscious Home Shoppers,3.02
Cycling Enthusiasts,3.02
Halloween Costume Shoppers,3.01
Realtors & Real Estate Researchers,2.98
Readers of Filipinos Content,2.97
Flight and Hotel Shoppers,2.97
Pregnancy Resources Researchers,2.96
Entertainment & Tabloid Magazine Readers,2.95
Streaming Radio Listeners,2.95
Financial Business Intelligence Researchers,2.94
NCAA Football Fans,2.93
Medical Advice Researchers,2.92
Womens Health Researchers,2.92
Discount Device Shoppers,2.91
Pharmacy Shoppers,2.91
Philadelphia Trip Planners,2.91
Gourmet Food & Wine Researchers,2.91
TV Advertising Professionals,2.91
Techies,2.89
Apple Fans,2.88
Executive and C-Suite,2.88
Luggage Shoppers,2.87
Coffee Chain Shoppers,2.86
Home Kitchen Chefs,2.86
Ecommerce Platform Researchers,2.86
Entertainment Industry Decision Makers,2.86
Home Buyers,2.85
Brides & Wedding Planners,2.85
Personal Stock Portfolio Managers,2.85
Eco-Conscious Consumers,2.84
Young Boomers,2.84
Discount Womens Shoes Shoppers,2.83
Olympic Sports Enthusiasts,2.82
TV Game Show Fans,2.81
Landscape Architects,2.8
Lacrosse Enthusiasts,2.79
Sale Seekers,2.79
Jaguar Vehicle Shoppers,2.77
Tesla Enthusiasts,2.76
Home Design Enthusiasts,2.76
BMW Vehicle Shoppers,2.76
Luxury Boutique Hotel Researchers,2.76
Entrepreneurs,2.75
Camera Review Readers,2.75
Restaurant Researchers,2.75
Postal Employees,2.74
At-Home Gym Intenders,2.74
Online Grocery Shoppers,2.73
Investment Banking Professionals,2.73
Advertising Professionals,2.73
Travel Researchers,2.73
Social Liberals,2.72
Flower & Gift Basket Shoppers,2.72
Metal and Rock Music Fans,2.71
Country Music Fans,2.71
Gym Equipment Owners,2.71
Tailgaters,2.71
Jewelry & Watch Shoppers,2.71
Media Buying Professionals,2.69
Business News Readers,2.68
Luxury Bedding Shoppers,2.68
Furniture Shoppers,2.68
Boxing Fans,2.67
Beach Supplies Shoppers,2.66
Yale University Fans,2.66
Online Movie Downloaders,2.63
Australia Trip Planners,2.63
Conservative News Readers,2.63
Acura Vehicle Shoppers,2.62
Kids Clothing Shoppers,2.62
Major Appliance Shoppers,2.61
Audi Vehicle Shoppers,2.6
March Madness Enthusiasts,2.6
Luxury Retail Shoppers,2.6
Architecture Enthusiasts,2.59
Tech News Enthusiasts,2.57
Home Kitchen Bakers,2.55
Real Estate Decision Makers,2.55
Online Alcohol Shoppers,2.54
Auto-Looking for New Car Purchase or Lease,2.53
Market Intelligence Researchers,2.53
First Aid Researchers,2.53
Pre-Measured Grocery Shoppers,2.53
Japanese Luxury Car Enthusiasts,2.52
Readers of Bengali Content,2.51
Readers of South Asian Content,2.51
Detroit Trip Planners,2.51
Retirement Planners,2.51
LED Lighting Shoppers,2.5
New York Trip Planners,2.5
Beauty & Skincare Buyers,2.5
Charitable Organization Researchers,2.49
Fantasy & Comic Fans,2.49
Finance Continuing Education Researchers,2.49
Big & Tall Men,2.49
Car Enthusiasts,2.47
Christmas 
Query:
-- Corrected Query 6
SELECT m."month_year", m."composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
WHERE m."interest_id" = 5
ORDER BY m."_year", m."_month"
LIMIT 1000
Answer:
month_year,composition
07-2018,10.82
08-2018,4.0
09-2018,3.47
10-2018,4.07
11-2018,3.67
12-2018,3.93
01-2019,3.64
02-2019,3.75
03-2019,3.16
04-2019,2.44
05-2019,1.78
06-2019,1.83
07-2019,2.17
08-2019,2.81
Query:
-- Corrected Query 7
SELECT DISTINCT im."interest_summary"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
LIMIT 1000
Answer:
Too long, hard cut:
interest_summary
Consumers using fitness tracking apps and websites.
Consumers researching game reviews and cheat codes.
Readers of automotive news and car reviews.
Consumers researching luxury product reviews and gift ideas.
People researching wedding ideas and vendors.
Consumers reading reviews of vacation destinations and accommodations.
Readers of motorcycle news and reviews.
Readers of online business news content.
Consumers shopping online for clothing at thrift stores and researching locations.
People reading articles and websites about football and the NFL.
People reading articles and websites about basketball and the NBA.
People reading articles and websites about college sports and the NCAA.
Consumers researching box office listings and buying movie tickets.
Consumers researching DIY projects.
Grill owners researching new recipes.
Readers of tech news and gadget reviews.
Consumers shopping for auto insurance.
Consumers in-market for clothing for teenage girls.
Consumers researching high-end watch and jewelry brands.
People researching job boards.
People researching major charitable organizations.
Consumers shopping at big box retailers.
People reading about hip hop music and hip hop stars.
Consumers shopping for discounted electronics.
People researching menopause symptoms.
Consumers shopping for connected TV products.
Consumers of online comics and fantasy novels.
People reading legal journals and industry publications.
Consumers reseraching lawn and garden maintenance techniques.
Individuals in-market for office supplies.
People reading contractor trade publications.
People reading about child raising advice and activities.
People researching voter registration options.
Consumers reading content about diet and weight loss.
People reading content online related to conservative think tanks.
People visiting sites related to liberal think tanks.
People reading articles and websites about baseball and the MLB.
Consumers researching home design styles and trends.
Consumers streaming feature length movies and TV shows.
People reading education industry publications and teaching advice websites.
"Consumers shopping for home design, art and accessories."
Consumers shopping for sporting goods and activewear apparel.
Consumers with an active online trading account.
People shopping at high end childrens clothing and toy retailers.
"People reading about family cooking, parenting advice and childrens activities."
People researching healthy eating options.
Consumers shopping online or searching for a local drug store.
Consumers shopping for high end fashion apparel and accessories.
Consumers reading online reviews of luxury travel options.
Consumers shopping for a new TV.
People researching daycare options.
People researching gyms and health clubs.
People reading articles and websites about the sport of boxing.
Consumers shopping for car maintenance products.
People reading anti-war publications
People reading right-leaning social issues websites.
Parents who had children later in life.
People researching asthma trends and treatment options.
Consumers researching alternative mobile phones and wireless plans.
People searching for and watching TV game shows online.
People visiting sites advocating LGBT rights.
"People researching attractions and accommodations in Costa Rica. These consumers are more likely to spend money on flights, hotels, and local attractions."
People researching academic programs and resources for high schoolers.
People researching climate change and sustainable living.
People reading medical journals and using online prescribing services.
People visiting university websites.
Consumes shopping at multi-category department stores.
Consumers shopping for apparel that mimics current runway trends.
People reading real estate sales listings.
Consumers who are shopping for moving services.
People reading articles and websites about hockey and the NHL.
People reading websites about nursing lifestyle and career advice.
People reading Democratic party advocacy websites.
Consumers downloading feature length movies and TV shows.
Consumers reading online reviews of theme parks and accommodations.
People visiting websites about military benefits.
Consumers shopping for a printer.
Consumers making online rental car bookings.
""
Avid readers of online content about the entertainment industry.
People visiting sites advocating the legalization of marijuana.
People reading news and advice on preventing and treating orthopedic health issues.
People researching career development and advancement.
People who read advertising industry news.
People reading articles and websites about nascar.
Consumers shopping for childrens apparel.
Consumers shopping for bed and bath products.
Consumers shopping for lingerie.
People reading real estate rental listings.
People researching pregnancy issues and baby names.
Consumers shopping for printer ink.
People reading Republican party advocacy websites.
Consumers researching sa
Query:
-- Corrected Query 8
SELECT im."interest_name", m."ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
  ON m."interest_id" = im."id"
WHERE m."month_year" = '12-2018'
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,ranking
Fitness Enthusiasts,140
Gamers,991
Car Enthusiasts,890
Luxury Retail Researchers,5
Brides & Wedding Planners,315
Vacation Planners,25
Motorcycle Enthusiasts,910
Business News Readers,602
Thrift Store Shoppers,347
Advertising Professionals,487
NFL Fans,737
NBA Fans,410
NCAA Fans,56
MLB Fans,147
Nascar Fans,669
Eco-Conscious Consumers,619
Moviegoers,523
DIYers,558
Grill Masters,424
Home Design Enthusiasts,453
Doctors,322
Streaming Video Fans,927
Auto Insurance Shoppers,400
Teachers,536
College Students,692
Department Store Shoppers,136
Home Decor Shoppers,38
Kids Clothing Shoppers,28
Teen Girl Clothing Shoppers,171
Mens Clothing Shoppers,220
Baby Products Buyers,765
Jewelry & Watch Shoppers,98
Sporting Goods Shoppers,12
Furniture Shoppers,52
Bed & Bath Shoppers,158
Intimates Shoppers,592
Fast Fashion Shoppers,400
Apartment Hunters,472
Home Buyers,122
Moving Services Shoppers,511
Job Seekers,886
Charitable Donors,281
NHL Fans,104
Discount Big Box Shoppers,243
Black Friday Deal Shoppers,922
Hip Hop Fans,978
Online Investors,643
Seasonal Allergy Sufferers,231
Discount Device Shoppers,211
Mobile Phone Comparison Shoppers,855
Budget Wireless Shoppers,910
Menopause Researchers,354
Online Health Researchers,168
Beauty & Skincare Buyers,186
Streaming Device Shoppers,558
New & Expecting Parents,712
High-End Kids Furniture and Clothes Shoppers,57
Hands-On Parents,523
Fantasy & Comic Fans,868
Lawyers,536
Healthy Eaters,101
Drug Store Shoppers,415
Lawn & Garden Enthusiasts,375
Nurses,657
Mailing & Shipping Shoppers,415
Office Supply Shoppers,271
Ink & Toner Shoppers,571
Luxury Retail Shoppers,39
Contractors & Construction Professionals,657
Luxury Travel Researchers,64
Democrats,330
Republicans,843
HDTV Researchers,255
Hardware Shoppers,181
Reggaeton Fans,765
Online Movie Downloaders,822
Sale Seekers,487
Theme Park Researchers,211
Ski and Snowboard Enthusiasts,65
Travel Researchers,92
Coupon Researchers,712
Parents with Toddlers,831
Parents with Kids,440
Young Boomers,536
Day Care Users,765
Stay-at-Home Parents,255
Exercise and Gym Researchers,211
Home Kitchen Chefs,255
Restaurant Researchers,111
Order-in Eaters,302
Nutrition Conscious Eaters,98
Flower & Gift Basket Shoppers,92
Plus Size Women,388
Live Concert Fans,545
Country Music Fans,737
Cruise Travel Intenders,330
Pain Medication Users,375
Joint Pain Sufferers,511
Pain Management Researchers,855
Retirement Planners,137
Auto Repair Researchers,831
Avid Readers,129
Womens Fashion Magazine Readers,681
Mens Shoe Shoppers,5
Home Security Shoppers,799
Boxing Fans,609
Sleep Disorder Researchers,784
Mortgage Researchers,592
Coders & Developers,955
Military Servicemembers & Veterans,922
Healthcare Discount Shoppers,400
Postal Employees,487
Soccer Fans,366
Kitchen & Bathroom Remodelers,199
Aftermarket Accessories Shoppers,472
Automotive Safety Researchers,472
Apple Fans,388
Home Printer Shoppers,255
Major Appliance Shoppers,147
Online Alcohol Shoppers,137
Home Kitchen Bakers,208
Makeup Researchers,602
Pet Owners,706
Skin Care Researchers,211
Credit Card Researchers,799
Health Insurance Researchers,271
Property Insurance Researchers,337
Audio Equipment Researchers,697
Broadway Fans,82
Celebrity Gossip Fans,855
Streaming Radio Listeners,453
TV Junkies,619
Big & Tall Men,41
Phone Accessory Shoppers,354
Prepaid Smartphone Shoppers,950
Business Travelers,164
Car Rental Shoppers,158
Flight and Hotel Shoppers,55
Sightseeing Travelers,86
Travel Reward Points Enthusiasts,192
Retirees,453
Federal Employees,681
Conservative News Readers,848
Liberal News Readers,681
Doves,895
Social Conservatives,692
Social Liberals,831
Voters,751
Shoe Shoppers,8
Readers of Hispanic Content,955
Working Parents,619
Health & Fitness,108
Business Accounting Software Researchers,415
Business Filing Researchers,523
Business Logistics Managers,487
IT Decision Makers,886
Small Business Employees,633
Sweepstakes Enthusiasts,602
Womens Fitness Enthusiasts,302
Tech-Savvy Moms,375
Readers of Mexican Content,987
TV Game Show Fans,511
Credit Union Researchers,424
Mature Parents,453
Streaming Music Enthusiasts,927
Parents of Teenagers Going to College,28
Cosmetics and Beauty Shoppers,487
Readers of Japanese Content,814
Yogis,81
Asthma Sufferers,281
Adult Acne Sufferers,712
Heartburn Sufferers,487
Sinus Researchers,511
Headache and Migraine Sufferers,231
Back Pain Sufferers,388
First Aid Researchers,265
Cholesterol Researchers,501
Dieters,76
Vitamin Shoppers,122
Womens Health Researchers,424
Mens Health Researchers,181
Food Allergies Researchers,388
Arthritis Sufferers,192
Teen Content Readers,784
Gastrointestinal Researchers,487
Military Families,751
LGBT Activists,895
Tire Shoppers,886
Surfers,122
Gun Control Advocates,799
Gun Rights Advocates,895
Immigration Rights Advocates,880
Immigration Control Advocates,424
Right Wing Radicals,877
Occupy Movement Supporters,545
Marijuana Legalization Advocates,907
Marijuana Prohibition Advocates,784
Family Values Advocates,799
Conservative Think Tank Reader
End Exploring Related Columns
Task: Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Time,Interest Name,Composition Value
MM-YYYY:str,interest_name:str,value:float
...
```

To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would:

1. **Determine the Maximum Composition for Each Interest Category**: For each `interest_id` in the `INTEREST_METRICS` table, find the record with the highest `composition` value and note the corresponding `month_year`.

2. **Associate Interest Names**: Join these records with the `INTEREST_MAP` table on `interest_id` (from `INTEREST_METRICS`) and `id` (from `INTEREST_MAP`) to retrieve the `interest_name`.

3. **Select Top and Bottom Categories**: Order the results by the maximum `composition` value in descending order to identify the top 10 categories and in ascending order for the bottom 10 categories.

4. **Compile the Results**: For each of these categories, display the `Time` (in `MM-YYYY` format from `month_year`), `Interest Name`, and `Composition Value`.

**Note**: Without actual data, we list the expected column names and data types. The `...` indicates additional rows for the remaining categories..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 19:11:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:11:57 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        m."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC NULLS LAST) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
        ON m."interest_id" = im."id"
)
SELECT
    mc."Time",
    mc."interest_name" AS "Interest Name",
    mc."Composition Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" DESC NULLS LAST) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" ASC NULLS LAST) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) mc
WHERE
    mc.rank_desc <= 10 OR mc.rank_asc <= 10
ORDER BY
    mc.rank_desc;
```

```csv
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
03-2019,The Sims Video Game Fans,1.57
09-2018,Action Movie and TV Enthusiasts,1.59
09-2018,Scifi Movie and TV Enthusiasts,1.61
08-2019,Hearthstone Video Game Fans,1.66
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2018,Miami Heat Fans,1.81
08-2019,World of Warcraft Enthusiasts,1.82
07-2018,Comedy Fans,1.83
02-2019,Automotive News Readers,1.84
07-2018,Readers of Jamaican Content,1.86
```
2025-01-20 19:11:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:11:58 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:59 - root - INFO - itercount: 1
2025-01-20 19:11:59 - root - INFO - 0
2025-01-20 19:11:59 - root - INFO - results: 
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57


2025-01-20 19:11:59 - root - INFO - Please check the answer again by reviewing Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Time,Interest Name,Composition Value
MM-YYYY:str,interest_name:str,value:float
...
```

To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would:

1. **Determine the Maximum Composition for Each Interest Category**: For each `interest_id` in the `INTEREST_METRICS` table, find the record with the highest `composition` value and note the corresponding `month_year`.

2. **Associate Interest Names**: Join these records with the `INTEREST_MAP` table on `interest_id` (from `INTEREST_METRICS`) and `id` (from `INTEREST_MAP`) to retrieve the `interest_name`.

3. **Select Top and Bottom Categories**: Order the results by the maximum `composition` value in descending order to identify the top 10 categories and in ascending order for the bottom 10 categories.

4. **Compile the Results**: For each of these categories, display the `Time` (in `MM-YYYY` format from `month_year`), `Interest Name`, and `Composition Value`.

**Note**: Without actual data, we list the expected column names and data types. The `...` indicates additional rows for the remaining categories. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Current sql:
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        m."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC NULLS LAST) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
        ON m."interest_id" = im."id"
)
SELECT
    mc."Time",
    mc."interest_name" AS "Interest Name",
    mc."Composition Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" DESC NULLS LAST) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" ASC NULLS LAST) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) mc
WHERE
    mc.rank_desc <= 10 OR mc.rank_asc <= 10
ORDER BY
    mc.rank_desc;For tasks asking fullname or name, you may combine first name and last name into one column called name.

2025-01-20 19:12:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:12:53 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year" AS "Time",
        ROUND(m."composition", 4) AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC NULLS LAST) AS rn
    FROM
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_METRICS" m
    JOIN
        BANK_SALES_TRADING.BANK_SALES_TRADING."INTEREST_MAP" im
        ON m."interest_id" = im."id"
)
SELECT
    mc."Time",
    mc."interest_name" AS "Interest Name",
    mc."Composition Value"
FROM (
    SELECT
        mc.*,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" DESC NULLS LAST) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY mc."Composition Value" ASC NULLS LAST) AS rank_asc
    FROM
        max_compositions mc
    WHERE
        mc.rn = 1
) mc
WHERE
    mc.rank_desc <= 10 OR mc.rank_asc <= 10
ORDER BY
    mc.rank_desc;
```

```csv
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2000
07-2018,Gym Equipment Owners,18.8200
07-2018,Furniture Shoppers,17.4400
07-2018,Luxury Retail Shoppers,17.1900
10-2018,Luxury Boutique Hotel Researchers,15.1500
12-2018,Luxury Bedding Shoppers,15.0500
07-2018,Shoe Shoppers,14.9100
07-2018,Cosmetics and Beauty Shoppers,14.2300
07-2018,Luxury Hotel Guests,14.1000
07-2018,Luxury Retail Researchers,13.9700
03-2019,The Sims Video Game Fans,1.5700
09-2018,Action Movie and TV Enthusiasts,1.5900
09-2018,Scifi Movie and TV Enthusiasts,1.6100
08-2019,Hearthstone Video Game Fans,1.6600
07-2018,Online Role Playing Game Enthusiasts,1.7300
08-2018,Miami Heat Fans,1.8100
08-2019,World of Warcraft Enthusiasts,1.8200
07-2018,Comedy Fans,1.8300
02-2019,Automotive News Readers,1.8400
07-2018,Readers of Jamaican Content,1.8600
```
2025-01-20 19:12:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:12:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:12:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:12:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:12:55 - snowflake.connector.connection - INFO - closed
2025-01-20 19:12:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:12:55 - root - INFO - itercount: 2
2025-01-20 19:12:55 - root - INFO - 0
2025-01-20 19:12:55 - root - INFO - Total iteration counts: 2
