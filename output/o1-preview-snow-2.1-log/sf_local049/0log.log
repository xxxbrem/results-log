2025-01-21 14:56:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.402598 seconds
2025-01-21 14:57:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:57:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:57:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:57:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:57:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:57:47 - snowflake.connector.connection - INFO - closed
2025-01-21 14:57:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:57:47 - root - INFO - SQL:
SELECT "c"."company_id", "c"."date_joined", "i"."industry"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   LIMIT 100;
Results:
company_id,date_joined,industry
109,2020-09-08T00:00:00.000,Fintech
821,2019-05-16T00:00:00.000,Travel
153,2019-07-11T00:00:00.000,Internet software & services
972,2018-10-17T00:00:00.000,Artificial intelligence
1022,2021-06-02T00:00:00.000,"""Supply chain, logistics, & delivery"""
433,2021-04-17T00:00:00.000,Other
747,2018-03-27T00:00:00.000,Internet software & services
902,2021-01-27T00:00:00.000,Internet software & services
1065,2021-06-01T00:00:00.000,Internet software & services
388,2018-05-30T00:00:00.000,Fintech
748,2019-02-14T00:00:00.000,Other
189,2017-06-24T00:00:00.000,Health
848,2021-06-01T00:00:00.000,Fintech
556,2022-02-15T00:00:00.000,Internet software & services
556,2022-02-15T00:00:00.000,Internet software & services
999,2021-11-17T00:00:00.000,Internet software & services
396,2021-10-21T00:00:00.000,Fintech
931,2021-09-24T00:00:00.000,Consumer & retail
364,2019-02-01T00:00:00.000,E-commerce & direct-to-consumer
732,2022-01-27T00:00:00.000,Fintech
906,2021-06-10T00:00:00.000,Hardware
72,2015-01-23T00:00:00.000,Hardware
983,2019-08-22T00:00:00.000,Fintech
983,2019-08-22T00:00:00.000,Fintech
898,2022-01-25T00:00:00.000,Internet software & services
844,2021-07-07T00:00:00.000,Fintech
894,2021-12-06T00:00:00.000,Fintech
813,2021-08-10T00:00:00.000,Fintech
743,2020-12-24T00:00:00.000,Other
226,2021-01-24T00:00:00.000,Mobile & telecommunications
963,2021-10-05T00:00:00.000,Fintech
764,2021-12-07T00:00:00.000,Fintech
839,2021-12-28T00:00:00.000,E-commerce & direct-to-consumer
1033,2021-01-27T00:00:00.000,Internet software & services
725,2022-01-25T00:00:00.000,Health
549,2021-09-22T00:00:00.000,Artificial intelligence
667,2015-01-16T00:00:00.000,Mobile & telecommunications
755,2021-09-08T00:00:00.000,Fintech
782,2022-01-31T00:00:00.000,Fintech
175,2019-06-25T00:00:00.000,Fintech
398,2021-10-15T00:00:00.000,Fintech
814,2021-11-16T00:00:00.000,E-commerce & direct-to-consumer
436,2017-04-14T00:00:00.000,Artificial intelligence
1046,2021-06-16T00:00:00.000,Artificial intelligence
565,2021-04-21T00:00:00.000,Artificial intelligence
781,2021-08-31T00:00:00.000,Internet software & services
997,2021-12-06T00:00:00.000,E-commerce & direct-to-consumer
194,2021-03-18T00:00:00.000,Internet software & services
249,2021-06-29T00:00:00.000,Fintech
434,2021-05-19T00:00:00.000,Auto & transportation
1035,2021-11-18T00:00:00.000,Cybersecurity
969,2022-01-26T00:00:00.000,Data management & analytics
1018,2021-02-18T00:00:00.000,Other
355,2021-09-14T00:00:00.000,Internet software & services
934,2020-03-17T00:00:00.000,E-commerce & direct-to-consumer
1054,2021-05-18T00:00:00.000,Fintech
901,2021-11-08T00:00:00.000,Cybersecurity
173,2021-12-20T00:00:00.000,Internet software & services
738,2022-01-11T00:00:00.000,Fintech
422,2022-02-16T00:00:00.000,Internet software & services
830,2021-03-30T00:00:00.000,Health
1004,2021-05-24T00:00:00.000,Other
951,2015-03-06T00:00:00.000,E-commerce & direct-to-consumer
951,2015-03-06T00:00:00.000,E-commerce & direct-to-consumer
734,2022-01-27T00:00:00.000,Internet software & services
1063,2021-11-10T00:00:00.000,Fintech
623,2015-04-21T00:00:00.000,Fintech
846,2019-10-21T00:00:00.000,Data management & analytics
823,2019-05-21T00:00:00.000,Fintech
944,2021-07-22T00:00:00.000,Fintech
1030,2021-08-09T00:00:00.000,Artificial intelligence
824,2016-04-14T00:00:00.000,E-commerce & direct-to-consumer
930,2022-02-22T00:00:00.000,Internet software & services
370,2018-07-09T00:00:00.000,Data management & analytics
618,2018-10-18T00:00:00.000,E-commerce & direct-to-consumer
456,2020-01-29T00:00:00.000,Cybersecurity
893,2021-09-02T00:00:00.000,E-commerce & direct-to-consumer
812,2022-03-31T00:00:00.000,Other
1001,2020-09-21T00:00:00.000,Other
703,2021-12-02T00:00:00.000,Cybersecurity
884,2021-12-14T00:00:00.000,Health
404,2021-03-19T00:00:00.000,Cybersecurity
952,2022-03-30T00:00:00.000,Internet software & services
625,2020-01-28T00:00:00.000,Internet software & services
971,2021-11-02T00:00:00.000,Internet software & services
796,2017-07-20T00:00:00.000,Edtech
909,2022-01-27T00:00:00.000,Fintech
587,2018-05-17T00:00:00.000,Artificial intelligence
273,2022-04-05T00:00:00.000,Health
771,2021-09-28T00:00:00.000,Internet software & services
758,2021-12-21T00:00:00.000,Internet software & services
652,2021-06-15T00:00:00.000,Internet software & services
8,2017-12-20T00:00:00.000,Consumer & retail
760,2020-11-17T00:00:00.000,Mobile & telecommunications
394,2022-01-31T00:00:00.000,Health
393,2021-09-27T00:00:00.000,Fintech
870,2021-02-16T00:00:00.000,Other
804,2021-09-16T00:00:00.000,Artificial intelligence
1041,2021-11-02T00:00:00.000,Internet software & services
443,2022-03-17T00:00:00.000,Artificial intelligence

2025-01-21 14:57:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:57:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:57:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:57:49 - snowflake.connector.connection - INFO - closed
2025-01-21 14:57:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:58:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:58:19 - root - INFO - The error you're encountering is due to a mismatch between the format of the `"date_joined"` column data and the date format string provided to the `TO_DATE` function. The `TO_DATE` function expects the input string to match the specified format exactly.

**Issue Explanation:**

- **Data Format:** The `"date_joined"` column contains strings like `'2020-09-08T00:00:00.000'`.
- **Specified Format:** `'YYYY-MM-DD'` does not account for the `'T'` separator and the time component.

**Solution:**

1. **Adjust the Date Format String:**

   You need to provide a format string that matches the exact format of your date strings. The correct format for `'2020-09-08T00:00:00.000'` is `'YYYY-MM-DD"T"HH24:MI:SS.FF3'`.

2. **Use `TO_TIMESTAMP` Instead of `TO_DATE`:**

   Since your date strings include time components, it's appropriate to use `TO_TIMESTAMP` or `TO_TIMESTAMP_NTZ` (Non-Time-Zone) function.

**Corrected SQL Queries:**

1. **Using `TO_TIMESTAMP` with Format String:**

   ```sql
   SELECT "date_joined", EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
   LIMIT 100;
   ```
   
   - **Explanation:** This query correctly parses the `"date_joined"` strings by matching the format, including the `'T'` separator and fractional seconds (`FF3`).

2. **Using `TO_TIMESTAMP_NTZ` Without Specifying Format:**

   If the default timestamp format is compatible, you can use `TO_TIMESTAMP_NTZ`:

   ```sql
   SELECT "date_joined", EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("date_joined")) AS "year_joined"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
   LIMIT 100;
   ```

   - **Explanation:** `TO_TIMESTAMP_NTZ` attempts to parse the string as a timestamp without time zone, using the default formats. This works if the format of `"date_joined"` matches one of the default formats recognized by Snowflake.

**Test of Corrected Query:**

Running the corrected query should produce results similar to:

```csv
date_joined,year_joined
2020-09-08T00:00:00.000,2020
2019-05-16T00:00:00.000,2019
2019-07-11T00:00:00.000,2019
2018-10-17T00:00:00.000,2018
2021-06-02T00:00:00.000,2021
2021-04-17T00:00:00.000,2021
... (additional rows)
```

**Why This Works:**

- The format string `'YYYY-MM-DD"T"HH24:MI:SS.FF3'` matches the pattern of your data:
  - `'YYYY-MM-DD'`: Date part.
  - `'T'`: Literal `'T'` character.
  - `'HH24:MI:SS'`: Time in 24-hour format.
  - `'.FF3'`: Fractional seconds with 3 digits.

**Additional Notes:**

- Ensure that all double quotation marks around column names and alias names are properly closed.
- Remember to adjust the `LIMIT` as needed based on your data volume.
- If there are any null or improperly formatted dates in the `"date_joined"` column, consider adding error handling or data cleansing steps.

**Next Steps:**

Now that the date conversion issue is resolved, you can proceed with the rest of your queries to calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021.

**Example Query to Find the Top Industry and Calculate the Average:**

```sql
-- Step 1: Identify the top industry
WITH unicorns_2019_2021 AS (
  SELECT
    "c"."company_id",
    "i"."industry",
    EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
  FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
  JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
    ON "c"."company_id" = "i"."company_id"
  WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
)

SELECT
  "industry",
  COUNT(*) AS "unicorn_count"
FROM unicorns_2019_2021
GROUP BY "industry"
ORDER BY "unicorn_count" DESC
LIMIT 1;
```

This will give you the top industry between 2019 and 2021. Suppose the top industry is `'Fintech'`.

**Calculate the Average Number of New Unicorns per Year in the Top Industry:**

```sql
WITH unicorns_top_industry AS (
  SELECT
    EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
  FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
  JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
    ON "c"."company_id" = "i"."company_id"
  WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
    AND "i"."industry" = 'Fintech'
)

SELECT
  ROUND(COUNT(*) / 3.0, 2) AS "average_new_unicorns_per_year"
FROM unicorns_top_industry;
```

- **Explanation:** Divides the total number of new unicorns in the top industry by 3 (years 2019, 2020, and 2021) to get the average per year.

**Final Result:**

```csv
Average_new_unicorn_companies_per_year_in_top_industry
average:int
(Attention: answer in one row)
```

**Note:**

- Replace `'Fintech'` with the actual top industry found from the data.
- Replace `3.0` with the actual number of years if your data spans a different range.
- Ensure that the division is done using floating-point arithmetic (e.g., dividing by `3.0` instead of `3`) to get a precise average.
2025-01-21 14:58:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:58:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:58:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:58:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:58:21 - snowflake.connector.connection - INFO - closed
2025-01-21 14:58:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:59:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:59:09 - root - INFO - SQL:
SELECT "date_joined", EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
   LIMIT 100;
Results:
date_joined,year_joined
2020-09-08T00:00:00.000,2020
2019-05-16T00:00:00.000,2019
2019-07-11T00:00:00.000,2019
2018-10-17T00:00:00.000,2018
2021-06-02T00:00:00.000,2021
2021-04-17T00:00:00.000,2021
2018-03-27T00:00:00.000,2018
2021-01-27T00:00:00.000,2021
2021-06-01T00:00:00.000,2021
2018-05-30T00:00:00.000,2018
2019-02-14T00:00:00.000,2019
2017-06-24T00:00:00.000,2017
2021-06-01T00:00:00.000,2021
2022-02-15T00:00:00.000,2022
2021-11-17T00:00:00.000,2021
2021-10-21T00:00:00.000,2021
2021-09-24T00:00:00.000,2021
2019-02-01T00:00:00.000,2019
2022-01-27T00:00:00.000,2022
2021-06-10T00:00:00.000,2021
2015-01-23T00:00:00.000,2015
2019-08-22T00:00:00.000,2019
2022-01-25T00:00:00.000,2022
2021-07-07T00:00:00.000,2021
2021-12-06T00:00:00.000,2021
2021-08-10T00:00:00.000,2021
2020-12-24T00:00:00.000,2020
2021-01-24T00:00:00.000,2021
2021-10-05T00:00:00.000,2021
2021-12-07T00:00:00.000,2021
2021-12-28T00:00:00.000,2021
2021-01-27T00:00:00.000,2021
2022-01-25T00:00:00.000,2022
2021-09-22T00:00:00.000,2021
2015-01-16T00:00:00.000,2015
2021-09-08T00:00:00.000,2021
2022-01-31T00:00:00.000,2022
2019-06-25T00:00:00.000,2019
2021-10-15T00:00:00.000,2021
2021-11-16T00:00:00.000,2021
2017-04-14T00:00:00.000,2017
2021-06-16T00:00:00.000,2021
2021-04-21T00:00:00.000,2021
2021-08-31T00:00:00.000,2021
2021-12-06T00:00:00.000,2021
2021-03-18T00:00:00.000,2021
2021-06-29T00:00:00.000,2021
2021-05-19T00:00:00.000,2021
2021-11-18T00:00:00.000,2021
2022-01-26T00:00:00.000,2022
2021-02-18T00:00:00.000,2021
2021-09-14T00:00:00.000,2021
2020-03-17T00:00:00.000,2020
2021-05-18T00:00:00.000,2021
2021-11-08T00:00:00.000,2021
2021-12-20T00:00:00.000,2021
2022-01-11T00:00:00.000,2022
2022-02-16T00:00:00.000,2022
2021-03-30T00:00:00.000,2021
2021-05-24T00:00:00.000,2021
2015-03-06T00:00:00.000,2015
2022-01-27T00:00:00.000,2022
2021-11-10T00:00:00.000,2021
2015-04-21T00:00:00.000,2015
2019-10-21T00:00:00.000,2019
2019-05-21T00:00:00.000,2019
2021-07-22T00:00:00.000,2021
2021-08-09T00:00:00.000,2021
2016-04-14T00:00:00.000,2016
2022-02-22T00:00:00.000,2022
2018-07-09T00:00:00.000,2018
2018-10-18T00:00:00.000,2018
2020-01-29T00:00:00.000,2020
2021-09-02T00:00:00.000,2021
2022-03-31T00:00:00.000,2022
2020-09-21T00:00:00.000,2020
2021-12-02T00:00:00.000,2021
2021-12-14T00:00:00.000,2021
2021-03-19T00:00:00.000,2021
2022-03-30T00:00:00.000,2022
2020-01-28T00:00:00.000,2020
2021-11-02T00:00:00.000,2021
2017-07-20T00:00:00.000,2017
2022-01-27T00:00:00.000,2022
2018-05-17T00:00:00.000,2018
2022-04-05T00:00:00.000,2022
2021-09-28T00:00:00.000,2021
2021-12-21T00:00:00.000,2021
2021-06-15T00:00:00.000,2021
2017-12-20T00:00:00.000,2017
2020-11-17T00:00:00.000,2020
2022-01-31T00:00:00.000,2022
2021-09-27T00:00:00.000,2021
2021-02-16T00:00:00.000,2021
2021-09-16T00:00:00.000,2021
2021-11-02T00:00:00.000,2021
2022-03-17T00:00:00.000,2022
2021-01-07T00:00:00.000,2021
2021-12-31T00:00:00.000,2021
2017-10-17T00:00:00.000,2017

2025-01-21 14:59:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:59:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:59:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:59:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:59:10 - snowflake.connector.connection - INFO - closed
2025-01-21 14:59:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:59:11 - root - INFO - SQL:
SELECT "company_id", "date_joined"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
LIMIT 100
Results:
company_id,date_joined
109,2020-09-08T00:00:00.000
821,2019-05-16T00:00:00.000
153,2019-07-11T00:00:00.000
1022,2021-06-02T00:00:00.000
433,2021-04-17T00:00:00.000
902,2021-01-27T00:00:00.000
1065,2021-06-01T00:00:00.000
748,2019-02-14T00:00:00.000
848,2021-06-01T00:00:00.000
999,2021-11-17T00:00:00.000
396,2021-10-21T00:00:00.000
931,2021-09-24T00:00:00.000
364,2019-02-01T00:00:00.000
906,2021-06-10T00:00:00.000
983,2019-08-22T00:00:00.000
844,2021-07-07T00:00:00.000
894,2021-12-06T00:00:00.000
813,2021-08-10T00:00:00.000
743,2020-12-24T00:00:00.000
226,2021-01-24T00:00:00.000
963,2021-10-05T00:00:00.000
764,2021-12-07T00:00:00.000
839,2021-12-28T00:00:00.000
1033,2021-01-27T00:00:00.000
549,2021-09-22T00:00:00.000
755,2021-09-08T00:00:00.000
175,2019-06-25T00:00:00.000
398,2021-10-15T00:00:00.000
814,2021-11-16T00:00:00.000
1046,2021-06-16T00:00:00.000
565,2021-04-21T00:00:00.000
781,2021-08-31T00:00:00.000
997,2021-12-06T00:00:00.000
194,2021-03-18T00:00:00.000
249,2021-06-29T00:00:00.000
434,2021-05-19T00:00:00.000
1035,2021-11-18T00:00:00.000
1018,2021-02-18T00:00:00.000
355,2021-09-14T00:00:00.000
934,2020-03-17T00:00:00.000
1054,2021-05-18T00:00:00.000
901,2021-11-08T00:00:00.000
173,2021-12-20T00:00:00.000
830,2021-03-30T00:00:00.000
1004,2021-05-24T00:00:00.000
1063,2021-11-10T00:00:00.000
846,2019-10-21T00:00:00.000
823,2019-05-21T00:00:00.000
944,2021-07-22T00:00:00.000
1030,2021-08-09T00:00:00.000
456,2020-01-29T00:00:00.000
893,2021-09-02T00:00:00.000
1001,2020-09-21T00:00:00.000
703,2021-12-02T00:00:00.000
884,2021-12-14T00:00:00.000
404,2021-03-19T00:00:00.000
625,2020-01-28T00:00:00.000
971,2021-11-02T00:00:00.000
771,2021-09-28T00:00:00.000
758,2021-12-21T00:00:00.000
652,2021-06-15T00:00:00.000
760,2020-11-17T00:00:00.000
393,2021-09-27T00:00:00.000
870,2021-02-16T00:00:00.000
804,2021-09-16T00:00:00.000
1041,2021-11-02T00:00:00.000
978,2021-01-07T00:00:00.000
612,2021-12-31T00:00:00.000
421,2020-11-16T00:00:00.000
449,2021-07-03T00:00:00.000
1022,2021-06-02T00:00:00.000
644,2021-01-25T00:00:00.000
718,2021-09-30T00:00:00.000
920,2021-08-10T00:00:00.000
1048,2021-09-30T00:00:00.000
1024,2021-04-22T00:00:00.000
929,2021-12-22T00:00:00.000
863,2021-12-07T00:00:00.000
662,2020-12-21T00:00:00.000
1027,2021-06-24T00:00:00.000
783,2021-03-26T00:00:00.000
592,2021-11-17T00:00:00.000
1023,2021-01-26T00:00:00.000
1051,2021-11-03T00:00:00.000
633,2021-04-07T00:00:00.000
635,2021-06-02T00:00:00.000
697,2021-12-20T00:00:00.000
886,2021-03-30T00:00:00.000
798,2021-02-11T00:00:00.000
1008,2021-11-08T00:00:00.000
701,2020-12-31T00:00:00.000
825,2021-10-13T00:00:00.000
344,2021-06-29T00:00:00.000
643,2021-12-15T00:00:00.000
509,2021-08-04T00:00:00.000
979,2021-02-25T00:00:00.000
1031,2021-10-07T00:00:00.000
817,2021-05-04T00:00:00.000
943,2019-03-22T00:00:00.000
975,2021-04-30T00:00:00.000

2025-01-21 14:59:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:59:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:59:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:59:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-21 14:59:12 - snowflake.connector.connection - INFO - closed
2025-01-21 14:59:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:59:12 - root - INFO - SQL:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 100
Results:
industry,unicorn_count
Fintech,179
Internet software & services,156
E-commerce & direct-to-consumer,76
Artificial intelligence,53
Health,52
Other,43
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Hardware,15
Auto & transportation,15
Consumer & retail,11
Travel,7

2025-01-21 14:59:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:59:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:59:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:59:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 14:59:14 - snowflake.connector.connection - INFO - closed
2025-01-21 14:59:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:59:14 - root - INFO - SQL:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1
Results:
industry,unicorn_count
Fintech,179

2025-01-21 14:59:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:59:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:59:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:59:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-21 14:59:16 - snowflake.connector.connection - INFO - closed
2025-01-21 14:59:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:00:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 15:00:50 - root - INFO - ```sql
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1;
```
2025-01-21 15:00:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:00:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:00:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:00:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:00:51 - snowflake.connector.connection - INFO - closed
2025-01-21 15:00:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 15:02:01 - root - INFO - SQL:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1;
Results:
industry,unicorn_count
Fintech,232

2025-01-21 15:02:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 15:02:02 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:03 - root - INFO - SQL:
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined",
       COUNT(*) AS "unicorns_per_year"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
GROUP BY "year_joined"
ORDER BY "year_joined"
LIMIT 100
Results:
year_joined,unicorns_per_year
2019,21
2020,18
2021,140

2025-01-21 15:02:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-21 15:02:04 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:05 - root - INFO - SQL:
SELECT DISTINCT "industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES"
LIMIT 100
Results:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel

2025-01-21 15:02:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:02:06 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:07 - root - INFO - SQL:
SELECT COUNT(*) AS "total_unicorns"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
LIMIT 100
Results:
total_unicorns
179

2025-01-21 15:02:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 15:02:08 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:09 - root - INFO - SQL:
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined",
       COUNT(*) AS "unicorns_per_year"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "year_joined"
ORDER BY "year_joined"
LIMIT 100
Results:
year_joined,unicorns_per_year
2019,107
2020,109
2021,524

2025-01-21 15:02:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 15:02:10 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:10 - root - INFO - SQL:
SELECT "c"."company_id", "i"."industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) = 2020
LIMIT 100
Results:
company_id,industry
109,Fintech
743,Other
934,E-commerce & direct-to-consumer
456,Cybersecurity
1001,Other
625,Internet software & services
760,Mobile & telecommunications
421,Internet software & services
662,Fintech
701,Internet software & services
647,Cybersecurity
129,Other
989,Health
78,Internet software & services
212,Other
65,Cybersecurity
252,Mobile & telecommunications
287,E-commerce & direct-to-consumer
191,Auto & transportation
101,Health
941,Mobile & telecommunications
614,E-commerce & direct-to-consumer
881,Other
749,Cybersecurity
683,E-commerce & direct-to-consumer
203,Data management & analytics
170,Mobile & telecommunications
832,Data management & analytics
490,Other
908,Other
468,Hardware
545,Mobile & telecommunications
84,Fintech
561,Internet software & services
66,E-commerce & direct-to-consumer
60,Other
155,Fintech
475,"""Supply chain, logistics, & delivery"""
289,Health
428,Internet software & services
54,Internet software & services
57,Internet software & services
786,Data management & analytics
192,Data management & analytics
589,Data management & analytics
596,Fintech
208,Fintech
598,Health
659,Auto & transportation
524,Internet software & services
23,E-commerce & direct-to-consumer
105,Auto & transportation
502,Internet software & services
195,E-commerce & direct-to-consumer
125,Fintech
843,Auto & transportation
233,Internet software & services
291,Artificial intelligence
371,Fintech
346,Internet software & services
159,Mobile & telecommunications
112,Internet software & services
829,E-commerce & direct-to-consumer
188,Internet software & services
525,E-commerce & direct-to-consumer
90,Internet software & services
318,Fintech
318,Fintech
193,Edtech
302,Edtech
197,E-commerce & direct-to-consumer
196,Cybersecurity
469,Other
859,Health
337,Cybersecurity
259,Cybersecurity
225,Internet software & services
77,Fintech
487,Fintech
95,Artificial intelligence
38,E-commerce & direct-to-consumer
571,Mobile & telecommunications
1073,E-commerce & direct-to-consumer
1006,Edtech
736,Health
544,Other
977,E-commerce & direct-to-consumer
661,Fintech
68,Internet software & services
367,Artificial intelligence
22,Consumer & retail
111,Data management & analytics
74,Fintech
294,Auto & transportation
319,E-commerce & direct-to-consumer
274,Edtech
152,Fintech
232,Internet software & services
88,Mobile & telecommunications
128,Internet software & services

2025-01-21 15:02:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:02:12 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:12 - root - INFO - SQL:
SELECT AVG("f"."valuation") AS "average_valuation"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
LIMIT 100
Results:
average_valuation
3386740331.491713

2025-01-21 15:02:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-21 15:02:14 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:14 - root - INFO - SQL:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 5
Results:
industry,unicorn_count
Fintech,179
Internet software & services,156
E-commerce & direct-to-consumer,76
Artificial intelligence,53
Health,52

2025-01-21 15:02:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-21 15:02:16 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:16 - root - INFO - SQL:
SELECT DISTINCT EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
ORDER BY "year_joined"
LIMIT 100
Results:
year_joined
2007
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022

2025-01-21 15:02:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 15:02:17 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:18 - root - INFO - SQL:
SELECT "company_id", "year_founded", "date_joined"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
WHERE "year_founded" > 2010
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
LIMIT 100
Results:
company_id,year_founded,date_joined
153,2016,2019-07-11T00:00:00.000
1022,2013,2021-06-02T00:00:00.000
433,2013,2021-04-17T00:00:00.000
902,2015,2021-01-27T00:00:00.000
1065,2015,2021-06-01T00:00:00.000
848,2019,2021-06-01T00:00:00.000
999,2020,2021-11-17T00:00:00.000
396,2021,2021-10-21T00:00:00.000
931,2020,2021-09-24T00:00:00.000
364,2015,2019-02-01T00:00:00.000
906,2017,2021-06-10T00:00:00.000
844,2018,2021-07-07T00:00:00.000
894,2020,2021-12-06T00:00:00.000
813,2017,2021-08-10T00:00:00.000
743,2015,2020-12-24T00:00:00.000
226,2020,2021-01-24T00:00:00.000
963,2017,2021-10-05T00:00:00.000
764,2018,2021-12-07T00:00:00.000
839,2016,2021-12-28T00:00:00.000
549,2016,2021-09-22T00:00:00.000
755,2017,2021-09-08T00:00:00.000
175,2011,2019-06-25T00:00:00.000
398,2017,2021-10-15T00:00:00.000
814,2014,2021-11-16T00:00:00.000
1046,2014,2021-06-16T00:00:00.000
565,2013,2021-04-21T00:00:00.000
781,2018,2021-08-31T00:00:00.000
997,2011,2021-12-06T00:00:00.000
249,2019,2021-06-29T00:00:00.000
434,2014,2021-05-19T00:00:00.000
1035,2020,2021-11-18T00:00:00.000
1018,2011,2021-02-18T00:00:00.000
355,2017,2021-09-14T00:00:00.000
934,2011,2020-03-17T00:00:00.000
1054,2016,2021-05-18T00:00:00.000
901,2020,2021-11-08T00:00:00.000
173,2018,2021-12-20T00:00:00.000
830,2017,2021-03-30T00:00:00.000
1004,2016,2021-05-24T00:00:00.000
1063,2018,2021-11-10T00:00:00.000
846,2015,2019-10-21T00:00:00.000
1030,2019,2021-08-09T00:00:00.000
456,2016,2020-01-29T00:00:00.000
893,2020,2021-09-02T00:00:00.000
1001,2020,2020-09-21T00:00:00.000
703,2018,2021-12-02T00:00:00.000
884,2020,2021-12-14T00:00:00.000
625,2012,2020-01-28T00:00:00.000
971,2015,2021-11-02T00:00:00.000
771,2017,2021-09-28T00:00:00.000
758,2016,2021-12-21T00:00:00.000
652,2015,2021-06-15T00:00:00.000
760,2016,2020-11-17T00:00:00.000
393,2013,2021-09-27T00:00:00.000
870,2016,2021-02-16T00:00:00.000
804,2019,2021-09-16T00:00:00.000
1041,2015,2021-11-02T00:00:00.000
978,2015,2021-01-07T00:00:00.000
612,2016,2021-12-31T00:00:00.000
449,2019,2021-07-03T00:00:00.000
1022,2013,2021-06-02T00:00:00.000
644,2016,2021-01-25T00:00:00.000
718,2015,2021-09-30T00:00:00.000
1048,2014,2021-09-30T00:00:00.000
1024,2011,2021-04-22T00:00:00.000
929,2019,2021-12-22T00:00:00.000
863,2019,2021-12-07T00:00:00.000
662,2015,2020-12-21T00:00:00.000
1027,2012,2021-06-24T00:00:00.000
783,2016,2021-03-26T00:00:00.000
592,2018,2021-11-17T00:00:00.000
1023,2018,2021-01-26T00:00:00.000
633,2011,2021-04-07T00:00:00.000
635,2011,2021-06-02T00:00:00.000
697,2018,2021-12-20T00:00:00.000
886,2016,2021-03-30T00:00:00.000
798,2017,2021-02-11T00:00:00.000
1008,2020,2021-11-08T00:00:00.000
825,2014,2021-10-13T00:00:00.000
643,2016,2021-12-15T00:00:00.000
509,2014,2021-08-04T00:00:00.000
979,2013,2021-02-25T00:00:00.000
1031,2017,2021-10-07T00:00:00.000
817,2014,2021-05-04T00:00:00.000
943,2014,2019-03-22T00:00:00.000
975,2015,2021-04-30T00:00:00.000
705,2018,2021-12-07T00:00:00.000
942,2018,2021-04-20T00:00:00.000
354,2011,2019-12-05T00:00:00.000
688,2015,2019-05-15T00:00:00.000
391,2020,2021-12-17T00:00:00.000
579,2018,2021-10-06T00:00:00.000
686,2014,2021-07-28T00:00:00.000
822,2021,2021-12-28T00:00:00.000
882,2013,2021-06-16T00:00:00.000
369,2015,2021-03-01T00:00:00.000
1058,2012,2019-05-07T00:00:00.000
862,2016,2021-07-13T00:00:00.000
603,2013,2021-01-25T00:00:00.000
645,2015,2021-05-06T00:00:00.000

2025-01-21 15:02:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-21 15:02:19 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:19 - root - INFO - SQL:
SELECT "i"."industry", AVG("f"."funding") AS "average_funding"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "average_funding" DESC
LIMIT 100
Results:
industry,average_funding
Auto & transportation,1002812500.000000
Travel,788142857.142857
E-commerce & direct-to-consumer,632000000.000000
"""Supply chain, logistics, & delivery""",579750000.000000
Other,497477272.727273
Consumer & retail,495454545.454545
Artificial intelligence,474584905.660377
Edtech,472764705.882353
Fintech,456226519.337017
Cybersecurity,455789473.684211
Data management & analytics,451580645.161290
Health,409150943.396226
Mobile & telecommunications,388111111.111111
Internet software & services,353834394.904459
Hardware,344666666.666667

2025-01-21 15:02:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 15:02:21 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:21 - root - INFO - SQL:
SELECT "c"."company_id", "f"."select_investors"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
LIMIT 100
Results:
Too long, hard cut:
company_id,select_investors
109,Technology Crossover Ventures
821,"""Spark Capital, Highland Europe, Sunstone Capital"""
153,Insight Partners
972,"""Sinovation Ventures, Tencent Holdings, Sequoia Capital China"""
1022,"""Version One Ventures, Uncork Capital, Bessemer Venture Partners"""
433,"""Sequoia Capital China, Warburg Pincus, IDG Capital"""
747,"""FirstMark Capital, Tiger Global Management"""
902,"""Bessemer Venture Partners, Pitango Venture Capital, D1 Capital Partners"""
1065,"""Eastern Bell Capital, Danhua Capital, MSA Capital"""
388,"""Notion Capital, Scentan Ventures, Kite Ventures"""
748,"""Mitsubishi Corporation, Mayfair Equity Partners"""
189,EQT Partners
848,"""Dragonfly Captial, Qiming Venture Partners, DST Global"""
556,"""Blackstone, Bessemer Venture Partners"""
999,"""Goldman Sachs Asset Management, 3L"""
396,"""Insight Partners, Softbank Group, Connect Ventures"""
931,"""Tencent Holdings, Hillhouse Capital Management"""
364,"""K2VC, Lightspeed China Partners, Sky9 Capital"""
732,"""Initialized Capital, General Catalyst, Kraken Ventures"""
906,"""Delian Capital, China International Capital Corporation, Sequoia Capital China"""
72,"""Accel Partners, Sequoia Capital"""
983,"""Investment Corporation of Dubai, Centralway"""
898,"""Lightspeed India Partners, Sequoia Capital India, Endiya Partners"""
844,"""General Catalyst, Future Ventures, AU21"""
894,"""DST Global, General Catalyst, Monashees+"""
813,"""Polychain Capital, Coinbase Ventures, Jump Capital"""
743,"""Coatue Management, H Capital, Capital Today"""
226,"""Andreessen Horowitz, TQ Ventures"""
963,"""Left Lane Capital, Galaxy Interactive, Tru Arrow Partners"""
764,"""Craft Ventures, Caffeinated Capital, Operator Collective"""
839,"""Fireside Ventures, Sequoia Capital India, Stellaris Venture Partners"""
1033,"""Storm Ventures, DFJ DragonFund, New Enterprise Associates"""
725,"""SC.Holdings, Not Boring Capital, Bolt Ventures"""
549,"""Northern Light Venture Capital, Xiaomi, FutureX Capital"""
667,"""Redpoint Ventures, QiMing Venture Partners, Chengwei Capital"""
755,"""Passion Capital, Hedosophia, Outrun Ventures"""
782,"""Paradigm, Andreessen Horowitz, Jump Capital"""
175,"""Bnk To The Future, Trammell Ventures, SBI Investment"""
398,"""Accomplice, Polychain Capital, GoldenTree Asset Management"""
814,"""M13, Lightspeed Venture Partners, Lone Pine Capital"""
436,GAM Holding
1046,"""Insight Partners, Ignition Partners, Georgian Partners"""
565,"""Tomales Bay Capital, Bain & Company, General Catalyst"""
781,"""Pantera Capital, Polychain Capital, Lightspeed Venture Partners"""
997,"""Prysm Capital, Baillie Gifford & Co., TDM Growth Partners"""
194,"""Silver Lake, ICONIQ Capital"""
249,"""Day One Ventures, Coinbase Ventures, Andreessen Horowitz"""
434,"""Shunwei Capital Partners, China Media Group, Guangzhou Huiyin Aofeng Equity Investment Fund"""
1035,"""Index Ventures, Benchmark, Thrive Capital"""
969,"""General Catalyst, Nexus Venture Partners, Dell Technologies Capital"""
1018,"""New Enterprise Associates, Accel, Bond"""
355,"""VGames, Lakestar, Galaxy Interactive"""
934,"""Technology Crossover Ventures, Alkeon Capital Management, General Atlantic"""
1054,"""Sequoia Capital, Founders Fund, Bling Capital"""
901,"""Cowboy Ventures, Leaders Fund, GGV Capital"""
173,"""Foundation Capital, Frontier Ventures, AltaIR Capital"""
738,"""Left Lane Capital, Walden Venture Capital"""
422,"""Amplify Partners, Addition, Madrona Venture Group"""
830,"""Thrive Capital, Khosla Ventures, Tiger Global Management"""
1004,Bregal Sagemount
951,"""5Y Capital, Matrix Partners China, K2VC"""
734,"""Zeev Ventures, GSV Ventures"""
1063,"""Equal Ventures, Uncork Capital, Andreessen Horowitz"""
623,"""Matrix Partners China, Ventech China, Shunwei Capital Partners"""
846,"""New Enterprise Associates, Greylock Partners, Andreessen Horowitz"""
823,"""Ardian, Tiger Global Management, KKR"""
944,"""Kleiner Perkins Caufield & Byers, NightDragon Security, Venrock"""
1030,"""Greylock Partners, Google Ventures, BlackRock"""
824,"""Tiantu Capital, SAIF Partners China, Newsion Venture Capital"""
930,"""Nexus Venture Partners, Vertex Ventures, STRIVE"""
370,"""Boxin Capital, DT Capital Partners, IDG Capital"""
618,"""U.S.-China Green Fund, Founder H Fund, Richland Equities"""
456,"""next47, First Round Capital, Sequoia Capital"""
893,"""Andreessen Horowitz, DST Global, IDG Capital"""
812,"""General Catalyst, Inspired Capital, Flybridge Capital Partners"""
1001,"""Sozo Ventures, Caffeinated Capital, Sequoia Capital"""
703,"""Innovation Endeavors, s28 Capital, Lightspeed Venture Partners"""
884,"""Thrive Capital, General Catalyst, Coatue Management"""
404,"""Moonshots Capital, BoxGroup, Blu Venture Investors"""
952,"""Andreessen Horowitz, FTX Ventures, Tiger Global Management"""
625,"""Index Ventures, Thrive Capital, Bain Capital Ventures"""
971,"""GGV Capital, GSR Ventures, FreesFund"""
796,"""Sequoia Capital China, Qiming Venture Partners, Tencent Holdings"""
909,"""Next Pl

2025-01-21 15:02:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:02:23 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:23 - root - INFO - SQL:
SELECT SUM("f"."funding") AS "total_funding"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
LIMIT 100
Results:
total_funding
82577000000

2025-01-21 15:02:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:02:24 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:25 - root - INFO - SQL:
SELECT AVG("industry_count") AS "average_unicorns_per_industry"
FROM (
  SELECT "i"."industry", COUNT(*) AS "industry_count"
  FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
  JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
    ON "c"."company_id" = "i"."company_id"
  WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  GROUP BY "i"."industry"
) AS "sub"
LIMIT 100
Results:
average_unicorns_per_industry
49.800000

2025-01-21 15:02:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 15:02:26 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:26 - root - INFO - SQL:
SELECT "c"."company_id", "f"."valuation"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) = 2021
ORDER BY "f"."valuation" DESC
LIMIT 100
Results:
company_id,valuation
12,32000000000
16,20000000000
24,14000000000
27,13000000000
37,12000000000
34,12000000000
42,11000000000
44,11000000000
39,11000000000
53,10000000000
51,10000000000
51,10000000000
61,9000000000
75,8000000000
80,8000000000
76,8000000000
82,8000000000
79,8000000000
99,7000000000
100,7000000000
97,7000000000
87,7000000000
108,6000000000
127,6000000000
102,6000000000
122,6000000000
119,6000000000
113,6000000000
116,6000000000
124,6000000000
126,6000000000
107,6000000000
144,5000000000
151,5000000000
135,5000000000
146,5000000000
130,5000000000
160,5000000000
157,5000000000
164,5000000000
156,5000000000
147,5000000000
145,5000000000
138,5000000000
142,5000000000
150,5000000000
167,5000000000
182,4000000000
202,4000000000
198,4000000000
239,4000000000
236,4000000000
184,4000000000
194,4000000000
226,4000000000
205,4000000000
201,4000000000
221,4000000000
209,4000000000
200,4000000000
177,4000000000
199,4000000000
216,4000000000
173,4000000000
180,4000000000
168,4000000000
230,4000000000
204,4000000000
181,4000000000
237,4000000000
178,4000000000
179,4000000000
215,4000000000
206,4000000000
183,4000000000
218,4000000000
234,4000000000
223,4000000000
187,4000000000
338,3000000000
303,3000000000
260,3000000000
244,3000000000
313,3000000000
286,3000000000
261,3000000000
344,3000000000
276,3000000000
347,3000000000
326,3000000000
283,3000000000
329,3000000000
349,3000000000
266,3000000000
298,3000000000
265,3000000000
300,3000000000
242,3000000000
336,3000000000
272,3000000000

2025-01-21 15:02:26 - root - INFO - itercount: 0
2025-01-21 15:02:26 - root - INFO - Database Name: MODERN_DATA
Schema Name: MODERN_DATA
DDL describes table information.
,0
table_name,PIZZA_NAMES
description,
DDL,"create or replace TABLE PIZZA_NAMES (
	""pizza_id"" NUMBER(38,0),
	""pizza_name"" VARCHAR(16777216)
);"

,1
table_name,COMPANIES_DATES
description,
DDL,"create or replace TABLE COMPANIES_DATES (
	""company_id"" NUMBER(38,0),
	""date_joined"" VARCHAR(16777216),
	""year_founded"" NUMBER(38,0)
);"

,2
table_name,COMPANIES_INDUSTRIES
description,
DDL,"create or replace TABLE COMPANIES_INDUSTRIES (
	""company_id"" NUMBER(38,0),
	""industry"" VARCHAR(16777216)
);"

,3
table_name,PIZZA_CLEAN_RUNNER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_CLEAN_RUNNER_ORDERS (
	""order_id"" NUMBER(38,0),
	""runner_id"" NUMBER(38,0),
	""pickup_time"" VARCHAR(16777216),
	""distance"" FLOAT,
	""duration"" FLOAT,
	""cancellation"" VARCHAR(16777216)
);"

,4
table_name,PIZZA_GET_EXCLUSIONS
description,
DDL,"create or replace TABLE PIZZA_GET_EXCLUSIONS (
	""row_id"" NUMBER(38,0),
	""order_id"" NUMBER(38,0),
	""exclusions"" NUMBER(38,0),
	""total_exclusions"" NUMBER(38,0)
);"

,5
table_name,PIZZA_RECIPES
description,
DDL,"create or replace TABLE PIZZA_RECIPES (
	""pizza_id"" NUMBER(38,0),
	""toppings"" VARCHAR(16777216)
);"

,6
table_name,WORD_LIST
description,
DDL,"create or replace TABLE WORD_LIST (
	""words"" VARCHAR(16777216)
);"

,7
table_name,COMPANIES_FUNDING
description,
DDL,"create or replace TABLE COMPANIES_FUNDING (
	""company_id"" NUMBER(38,0),
	""valuation"" NUMBER(38,0),
	""funding"" NUMBER(38,0),
	""select_investors"" VARCHAR(16777216)
);"

,8
table_name,INCOME_TREES
description,
DDL,"create or replace TABLE INCOME_TREES (
	""zipcode"" NUMBER(38,0),
	""Estimate_Total"" NUMBER(38,0),
	""Margin_of_Error_Total"" NUMBER(38,0),
	""Estimate_Median_income"" NUMBER(38,0),
	""Margin_of_Error_Median_income"" NUMBER(38,0),
	""Estimate_Mean_income"" NUMBER(38,0),
	""Margin_of_Error_Mean_income"" NUMBER(38,0)
);"

,9
table_name,PIZZA_CLEAN_CUSTOMER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_CLEAN_CUSTOMER_ORDERS (
	""order_id"" NUMBER(38,0),
	""customer_id"" NUMBER(38,0),
	""pizza_id"" NUMBER(38,0),
	""exclusions"" VARCHAR(16777216),
	""extras"" VARCHAR(16777216),
	""order_time"" VARCHAR(16777216)
);"

,10
table_name,PIZZA_CUSTOMER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_CUSTOMER_ORDERS (
	""order_id"" NUMBER(38,0),
	""customer_id"" NUMBER(38,0),
	""pizza_id"" NUMBER(38,0),
	""exclusions"" VARCHAR(16777216),
	""extras"" VARCHAR(16777216),
	""order_time"" VARCHAR(16777216)
);"

,11
table_name,PIZZA_RUNNERS
description,
DDL,"create or replace TABLE PIZZA_RUNNERS (
	""runner_id"" NUMBER(38,0),
	""registration_date"" VARCHAR(16777216)
);"

,12
table_name,PIZZA_RUNNER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_RUNNER_ORDERS (
	""order_id"" NUMBER(38,0),
	""runner_id"" NUMBER(38,0),
	""pickup_time"" VARCHAR(16777216),
	""distance"" VARCHAR(16777216),
	""duration"" VARCHAR(16777216),
	""cancellation"" VARCHAR(16777216)
);"

,13
table_name,PIZZA_GET_EXTRAS
description,
DDL,"create or replace TABLE PIZZA_GET_EXTRAS (
	""row_id"" NUMBER(38,0),
	""order_id"" NUMBER(38,0),
	""extras"" NUMBER(38,0),
	""extras_count"" NUMBER(38,0)
);"

,14
table_name,PIZZA_TOPPINGS
description,
DDL,"create or replace TABLE PIZZA_TOPPINGS (
	""topping_id"" NUMBER(38,0),
	""topping_name"" VARCHAR(16777216)
);"

,15
table_name,STATISTICS
description,
DDL,"create or replace TABLE STATISTICS (
	""date"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""total_cases"" NUMBER(38,0),
	""total_deaths"" NUMBER(38,0)
);"

,16
table_name,TREES
description,
DDL,"create or replace TABLE TREES (
	""idx"" NUMBER(38,0),
	""tree_id"" NUMBER(38,0),
	""tree_dbh"" NUMBER(38,0),
	""stump_diam"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""health"" VARCHAR(16777216),
	""spc_latin"" VARCHAR(16777216),
	""spc_common"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""zipcode"" NUMBER(38,0),
	""borocode"" NUMBER(38,0),
	""boroname"" VARCHAR(16777216),
	""nta_name"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'MODERN_DATA': {'MODERN_DATA': ['COMPANIES_DATES', 'COMPANIES_FUNDING', 'COMPANIES_INDUSTRIES', 'INCOME_TREES', 'PIZZA_CLEAN_CUSTOMER_ORDERS', 'PIZZA_CLEAN_RUNNER_ORDERS', 'PIZZA_CUSTOMER_ORDERS', 'PIZZA_GET_EXCLUSIONS', 'PIZZA_GET_EXTRAS', 'PIZZA_NAMES', 'PIZZA_RECIPES', 'PIZZA_RUNNERS', 'PIZZA_RUNNER_ORDERS', 'PIZZA_TOPPINGS', 'STATISTICS', 'TREES', 'WORD_LIST']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **MODERN_DATA.MODERN_DATA.COMPANIES_DATES**
   - `"company_id"`: Used to join with other tables.
   - `"date_joined"`: Date when the company became a unicorn; we'll extract the year from this column.
   - `"year_founded"`: Year the company was founded (may be less relevant for this task).

2. **MODERN_DATA.MODERN_DATA.COMPANIES_INDUSTRIES**
   - `"company_id"`: Used to join with `COMPANIES_DATES`.
   - `"industry"`: The industry of the company; used to identify the top industry.

**Potential Conditions:**

- Filter companies that became unicorns between 2019 and 2021 by extracting the year from `"date_joined"`.
- Group by `"industry"` to find the industry with the highest number of unicorn companies.
- Join tables on `"company_id"` to combine industry and date information.

**SQL Queries:**

1. **List all companies with their date joined and industry:**

   ```sql
   SELECT "c"."company_id", "c"."date_joined", "i"."industry"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   LIMIT 100;
   ```

2. **Extract the year from "date_joined":**

   ```sql
   SELECT "date_joined", EXTRACT(YEAR FROM TO_DATE("date_joined", 'YYYY-MM-DD')) AS "year_joined"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
   LIMIT 100;
   ```

3. **List companies that became unicorns between 2019 and 2021:**

   ```sql
   SELECT "company_id", "date_joined"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
   WHERE EXTRACT(YEAR FROM TO_DATE("date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
   LIMIT 100;
   ```

4. **Count the number of unicorns per industry between 2019 and 2021:**

   ```sql
   SELECT "i"."industry", COUNT(*) AS "unicorn_count"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
   GROUP BY "i"."industry"
   ORDER BY "unicorn_count" DESC
   LIMIT 100;
   ```

5. **Identify the top industry with the most unicorns between 2019 and 2021:**

   ```sql
   SELECT "i"."industry", COUNT(*) AS "unicorn_count"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
   GROUP BY "i"."industry"
   ORDER BY "unicorn_count" DESC
   LIMIT 1;
   ```

6. **List companies in the top industry between 2019 and 2021:**

   ```sql
   SELECT "c"."company_id", "c"."date_joined", "i"."industry"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
     AND "i"."industry" = '[TOP_INDUSTRY]'
   LIMIT 100;
   ```
   *Note:* Replace `[TOP_INDUSTRY]` with the industry identified in Query 5.

7. **Count the number of unicorns per year in the top industry:**

   ```sql
   SELECT EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) AS "year_joined",
          COUNT(*) AS "unicorns_per_year"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
     AND "i"."industry" = '[TOP_INDUSTRY]'
   GROUP BY "year_joined"
   ORDER BY "year_joined"
   LIMIT 100;
   ```

8. **List all distinct industries:**

   ```sql
   SELECT DISTINCT "industry"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES"
   LIMIT 100;
   ```

9. **Total number of unicorns in the top industry from 2019 to 2021:**

   ```sql
   SELECT COUNT(*) AS "total_unicorns"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
     AND "i"."industry" = '[TOP_INDUSTRY]'
   LIMIT 100;
   ```

10. **Number of unicorns per year across all industries:**

    ```sql
    SELECT EXTRACT(YEAR FROM TO_DATE("date_joined", 'YYYY-MM-DD')) AS "year_joined",
           COUNT(*) AS "unicorns_per_year"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
    WHERE EXTRACT(YEAR FROM TO_DATE("date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
    GROUP BY "year_joined"
    ORDER BY "year_joined"
    LIMIT 100;
    ```

11. **List company IDs and industries for unicorns in 2020:**

    ```sql
    SELECT "c"."company_id", "i"."industry"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
      ON "c"."company_id" = "i"."company_id"
    WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) = 2020
    LIMIT 100;
    ```

12. **Average valuation of unicorns in the top industry between 2019 and 2021:**

    ```sql
    SELECT AVG("f"."valuation") AS "average_valuation"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
      ON "c"."company_id" = "i"."company_id"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
      ON "c"."company_id" = "f"."company_id"
    WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
      AND "i"."industry" = '[TOP_INDUSTRY]'
    LIMIT 100;
    ```

13. **List the top 5 industries by number of unicorns between 2019 and 2021:**

    ```sql
    SELECT "i"."industry", COUNT(*) AS "unicorn_count"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
      ON "c"."company_id" = "i"."company_id"
    WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
    GROUP BY "i"."industry"
    ORDER BY "unicorn_count" DESC
    LIMIT 5;
    ```

14. **List the years when companies became unicorns:**

    ```sql
    SELECT DISTINCT EXTRACT(YEAR FROM TO_DATE("date_joined", 'YYYY-MM-DD')) AS "year_joined"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
    ORDER BY "year_joined"
    LIMIT 100;
    ```

15. **Companies founded after 2010 that became unicorns between 2019 and 2021:**

    ```sql
    SELECT "company_id", "year_founded", "date_joined"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
    WHERE "year_founded" > 2010
      AND EXTRACT(YEAR FROM TO_DATE("date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
    LIMIT 100;
    ```

16. **Industries with the average funding amount between 2019 and 2021:**

    ```sql
    SELECT "i"."industry", AVG("f"."funding") AS "average_funding"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
      ON "c"."company_id" = "i"."company_id"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
      ON "c"."company_id" = "f"."company_id"
    WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
    GROUP BY "i"."industry"
    ORDER BY "average_funding" DESC
    LIMIT 100;
    ```

17. **List companies along with selected investors:**

    ```sql
    SELECT "c"."company_id", "f"."select_investors"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
      ON "c"."company_id" = "f"."company_id"
    LIMIT 100;
    ```

18. **Total funding amount for the top industry between 2019 and 2021:**

    ```sql
    SELECT SUM("f"."funding") AS "total_funding"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
      ON "c"."company_id" = "i"."company_id"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
      ON "c"."company_id" = "f"."company_id"
    WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
      AND "i"."industry" = '[TOP_INDUSTRY]'
    LIMIT 100;
    ```

19. **Average number of unicorns per industry between 2019 and 2021:**

    ```sql
    SELECT AVG("industry_count") AS "average_unicorns_per_industry"
    FROM (
      SELECT "i"."industry", COUNT(*) AS "industry_count"
      FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
      JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
        ON "c"."company_id" = "i"."company_id"
      WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) BETWEEN 2019 AND 2021
      GROUP BY "i"."industry"
    ) AS "sub"
    LIMIT 100;
    ```

20. **Companies with highest valuations in 2021:**

    ```sql
    SELECT "c"."company_id", "f"."valuation"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
      ON "c"."company_id" = "f"."company_id"
    WHERE EXTRACT(YEAR FROM TO_DATE("c"."date_joined", 'YYYY-MM-DD')) = 2021
    ORDER BY "f"."valuation" DESC
    LIMIT 100;
    ```

*Note:* In the queries where `[TOP_INDUSTRY]` is mentioned, replace it with the actual industry name identified in Query 5. These queries help explore the data and understand the relevant columns and values needed to calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021.Query:
SELECT "c"."company_id", "c"."date_joined", "i"."industry"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
   JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
     ON "c"."company_id" = "i"."company_id"
   LIMIT 100;
Answer:
company_id,date_joined,industry
109,2020-09-08T00:00:00.000,Fintech
821,2019-05-16T00:00:00.000,Travel
153,2019-07-11T00:00:00.000,Internet software & services
972,2018-10-17T00:00:00.000,Artificial intelligence
1022,2021-06-02T00:00:00.000,"""Supply chain, logistics, & delivery"""
433,2021-04-17T00:00:00.000,Other
747,2018-03-27T00:00:00.000,Internet software & services
902,2021-01-27T00:00:00.000,Internet software & services
1065,2021-06-01T00:00:00.000,Internet software & services
388,2018-05-30T00:00:00.000,Fintech
748,2019-02-14T00:00:00.000,Other
189,2017-06-24T00:00:00.000,Health
848,2021-06-01T00:00:00.000,Fintech
556,2022-02-15T00:00:00.000,Internet software & services
556,2022-02-15T00:00:00.000,Internet software & services
999,2021-11-17T00:00:00.000,Internet software & services
396,2021-10-21T00:00:00.000,Fintech
931,2021-09-24T00:00:00.000,Consumer & retail
364,2019-02-01T00:00:00.000,E-commerce & direct-to-consumer
732,2022-01-27T00:00:00.000,Fintech
906,2021-06-10T00:00:00.000,Hardware
72,2015-01-23T00:00:00.000,Hardware
983,2019-08-22T00:00:00.000,Fintech
983,2019-08-22T00:00:00.000,Fintech
898,2022-01-25T00:00:00.000,Internet software & services
844,2021-07-07T00:00:00.000,Fintech
894,2021-12-06T00:00:00.000,Fintech
813,2021-08-10T00:00:00.000,Fintech
743,2020-12-24T00:00:00.000,Other
226,2021-01-24T00:00:00.000,Mobile & telecommunications
963,2021-10-05T00:00:00.000,Fintech
764,2021-12-07T00:00:00.000,Fintech
839,2021-12-28T00:00:00.000,E-commerce & direct-to-consumer
1033,2021-01-27T00:00:00.000,Internet software & services
725,2022-01-25T00:00:00.000,Health
549,2021-09-22T00:00:00.000,Artificial intelligence
667,2015-01-16T00:00:00.000,Mobile & telecommunications
755,2021-09-08T00:00:00.000,Fintech
782,2022-01-31T00:00:00.000,Fintech
175,2019-06-25T00:00:00.000,Fintech
398,2021-10-15T00:00:00.000,Fintech
814,2021-11-16T00:00:00.000,E-commerce & direct-to-consumer
436,2017-04-14T00:00:00.000,Artificial intelligence
1046,2021-06-16T00:00:00.000,Artificial intelligence
565,2021-04-21T00:00:00.000,Artificial intelligence
781,2021-08-31T00:00:00.000,Internet software & services
997,2021-12-06T00:00:00.000,E-commerce & direct-to-consumer
194,2021-03-18T00:00:00.000,Internet software & services
249,2021-06-29T00:00:00.000,Fintech
434,2021-05-19T00:00:00.000,Auto & transportation
1035,2021-11-18T00:00:00.000,Cybersecurity
969,2022-01-26T00:00:00.000,Data management & analytics
1018,2021-02-18T00:00:00.000,Other
355,2021-09-14T00:00:00.000,Internet software & services
934,2020-03-17T00:00:00.000,E-commerce & direct-to-consumer
1054,2021-05-18T00:00:00.000,Fintech
901,2021-11-08T00:00:00.000,Cybersecurity
173,2021-12-20T00:00:00.000,Internet software & services
738,2022-01-11T00:00:00.000,Fintech
422,2022-02-16T00:00:00.000,Internet software & services
830,2021-03-30T00:00:00.000,Health
1004,2021-05-24T00:00:00.000,Other
951,2015-03-06T00:00:00.000,E-commerce & direct-to-consumer
951,2015-03-06T00:00:00.000,E-commerce & direct-to-consumer
734,2022-01-27T00:00:00.000,Internet software & services
1063,2021-11-10T00:00:00.000,Fintech
623,2015-04-21T00:00:00.000,Fintech
846,2019-10-21T00:00:00.000,Data management & analytics
823,2019-05-21T00:00:00.000,Fintech
944,2021-07-22T00:00:00.000,Fintech
1030,2021-08-09T00:00:00.000,Artificial intelligence
824,2016-04-14T00:00:00.000,E-commerce & direct-to-consumer
930,2022-02-22T00:00:00.000,Internet software & services
370,2018-07-09T00:00:00.000,Data management & analytics
618,2018-10-18T00:00:00.000,E-commerce & direct-to-consumer
456,2020-01-29T00:00:00.000,Cybersecurity
893,2021-09-02T00:00:00.000,E-commerce & direct-to-consumer
812,2022-03-31T00:00:00.000,Other
1001,2020-09-21T00:00:00.000,Other
703,2021-12-02T00:00:00.000,Cybersecurity
884,2021-12-14T00:00:00.000,Health
404,2021-03-19T00:00:00.000,Cybersecurity
952,2022-03-30T00:00:00.000,Internet software & services
625,2020-01-28T00:00:00.000,Internet software & services
971,2021-11-02T00:00:00.000,Internet software & services
796,2017-07-20T00:00:00.000,Edtech
909,2022-01-27T00:00:00.000,Fintech
587,2018-05-17T00:00:00.000,Artificial intelligence
273,2022-04-05T00:00:00.000,Health
771,2021-09-28T00:00:00.000,Internet software & services
758,2021-12-21T00:00:00.000,Internet software & services
652,2021-06-15T00:00:00.000,Internet software & services
8,2017-12-20T00:00:00.000,Consumer & retail
760,2020-11-17T00:00:00.000,Mobile & telecommunications
394,2022-01-31T00:00:00.000,Health
393,2021-09-27T00:00:00.000,Fintech
870,2021-02-16T00:00:00.000,Other
804,2021-09-16T00:00:00.000,Artificial intelligence
1041,2021-11-02T00:00:00.000,Internet software & services
443,2022-03-17T00:00:00.000,Artificial intelligence
Query:
SELECT "date_joined", EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
   FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
   LIMIT 100;
Answer:
date_joined,year_joined
2020-09-08T00:00:00.000,2020
2019-05-16T00:00:00.000,2019
2019-07-11T00:00:00.000,2019
2018-10-17T00:00:00.000,2018
2021-06-02T00:00:00.000,2021
2021-04-17T00:00:00.000,2021
2018-03-27T00:00:00.000,2018
2021-01-27T00:00:00.000,2021
2021-06-01T00:00:00.000,2021
2018-05-30T00:00:00.000,2018
2019-02-14T00:00:00.000,2019
2017-06-24T00:00:00.000,2017
2021-06-01T00:00:00.000,2021
2022-02-15T00:00:00.000,2022
2021-11-17T00:00:00.000,2021
2021-10-21T00:00:00.000,2021
2021-09-24T00:00:00.000,2021
2019-02-01T00:00:00.000,2019
2022-01-27T00:00:00.000,2022
2021-06-10T00:00:00.000,2021
2015-01-23T00:00:00.000,2015
2019-08-22T00:00:00.000,2019
2022-01-25T00:00:00.000,2022
2021-07-07T00:00:00.000,2021
2021-12-06T00:00:00.000,2021
2021-08-10T00:00:00.000,2021
2020-12-24T00:00:00.000,2020
2021-01-24T00:00:00.000,2021
2021-10-05T00:00:00.000,2021
2021-12-07T00:00:00.000,2021
2021-12-28T00:00:00.000,2021
2021-01-27T00:00:00.000,2021
2022-01-25T00:00:00.000,2022
2021-09-22T00:00:00.000,2021
2015-01-16T00:00:00.000,2015
2021-09-08T00:00:00.000,2021
2022-01-31T00:00:00.000,2022
2019-06-25T00:00:00.000,2019
2021-10-15T00:00:00.000,2021
2021-11-16T00:00:00.000,2021
2017-04-14T00:00:00.000,2017
2021-06-16T00:00:00.000,2021
2021-04-21T00:00:00.000,2021
2021-08-31T00:00:00.000,2021
2021-12-06T00:00:00.000,2021
2021-03-18T00:00:00.000,2021
2021-06-29T00:00:00.000,2021
2021-05-19T00:00:00.000,2021
2021-11-18T00:00:00.000,2021
2022-01-26T00:00:00.000,2022
2021-02-18T00:00:00.000,2021
2021-09-14T00:00:00.000,2021
2020-03-17T00:00:00.000,2020
2021-05-18T00:00:00.000,2021
2021-11-08T00:00:00.000,2021
2021-12-20T00:00:00.000,2021
2022-01-11T00:00:00.000,2022
2022-02-16T00:00:00.000,2022
2021-03-30T00:00:00.000,2021
2021-05-24T00:00:00.000,2021
2015-03-06T00:00:00.000,2015
2022-01-27T00:00:00.000,2022
2021-11-10T00:00:00.000,2021
2015-04-21T00:00:00.000,2015
2019-10-21T00:00:00.000,2019
2019-05-21T00:00:00.000,2019
2021-07-22T00:00:00.000,2021
2021-08-09T00:00:00.000,2021
2016-04-14T00:00:00.000,2016
2022-02-22T00:00:00.000,2022
2018-07-09T00:00:00.000,2018
2018-10-18T00:00:00.000,2018
2020-01-29T00:00:00.000,2020
2021-09-02T00:00:00.000,2021
2022-03-31T00:00:00.000,2022
2020-09-21T00:00:00.000,2020
2021-12-02T00:00:00.000,2021
2021-12-14T00:00:00.000,2021
2021-03-19T00:00:00.000,2021
2022-03-30T00:00:00.000,2022
2020-01-28T00:00:00.000,2020
2021-11-02T00:00:00.000,2021
2017-07-20T00:00:00.000,2017
2022-01-27T00:00:00.000,2022
2018-05-17T00:00:00.000,2018
2022-04-05T00:00:00.000,2022
2021-09-28T00:00:00.000,2021
2021-12-21T00:00:00.000,2021
2021-06-15T00:00:00.000,2021
2017-12-20T00:00:00.000,2017
2020-11-17T00:00:00.000,2020
2022-01-31T00:00:00.000,2022
2021-09-27T00:00:00.000,2021
2021-02-16T00:00:00.000,2021
2021-09-16T00:00:00.000,2021
2021-11-02T00:00:00.000,2021
2022-03-17T00:00:00.000,2022
2021-01-07T00:00:00.000,2021
2021-12-31T00:00:00.000,2021
2017-10-17T00:00:00.000,2017
Query:
SELECT "company_id", "date_joined"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
LIMIT 100
Answer:
company_id,date_joined
109,2020-09-08T00:00:00.000
821,2019-05-16T00:00:00.000
153,2019-07-11T00:00:00.000
1022,2021-06-02T00:00:00.000
433,2021-04-17T00:00:00.000
902,2021-01-27T00:00:00.000
1065,2021-06-01T00:00:00.000
748,2019-02-14T00:00:00.000
848,2021-06-01T00:00:00.000
999,2021-11-17T00:00:00.000
396,2021-10-21T00:00:00.000
931,2021-09-24T00:00:00.000
364,2019-02-01T00:00:00.000
906,2021-06-10T00:00:00.000
983,2019-08-22T00:00:00.000
844,2021-07-07T00:00:00.000
894,2021-12-06T00:00:00.000
813,2021-08-10T00:00:00.000
743,2020-12-24T00:00:00.000
226,2021-01-24T00:00:00.000
963,2021-10-05T00:00:00.000
764,2021-12-07T00:00:00.000
839,2021-12-28T00:00:00.000
1033,2021-01-27T00:00:00.000
549,2021-09-22T00:00:00.000
755,2021-09-08T00:00:00.000
175,2019-06-25T00:00:00.000
398,2021-10-15T00:00:00.000
814,2021-11-16T00:00:00.000
1046,2021-06-16T00:00:00.000
565,2021-04-21T00:00:00.000
781,2021-08-31T00:00:00.000
997,2021-12-06T00:00:00.000
194,2021-03-18T00:00:00.000
249,2021-06-29T00:00:00.000
434,2021-05-19T00:00:00.000
1035,2021-11-18T00:00:00.000
1018,2021-02-18T00:00:00.000
355,2021-09-14T00:00:00.000
934,2020-03-17T00:00:00.000
1054,2021-05-18T00:00:00.000
901,2021-11-08T00:00:00.000
173,2021-12-20T00:00:00.000
830,2021-03-30T00:00:00.000
1004,2021-05-24T00:00:00.000
1063,2021-11-10T00:00:00.000
846,2019-10-21T00:00:00.000
823,2019-05-21T00:00:00.000
944,2021-07-22T00:00:00.000
1030,2021-08-09T00:00:00.000
456,2020-01-29T00:00:00.000
893,2021-09-02T00:00:00.000
1001,2020-09-21T00:00:00.000
703,2021-12-02T00:00:00.000
884,2021-12-14T00:00:00.000
404,2021-03-19T00:00:00.000
625,2020-01-28T00:00:00.000
971,2021-11-02T00:00:00.000
771,2021-09-28T00:00:00.000
758,2021-12-21T00:00:00.000
652,2021-06-15T00:00:00.000
760,2020-11-17T00:00:00.000
393,2021-09-27T00:00:00.000
870,2021-02-16T00:00:00.000
804,2021-09-16T00:00:00.000
1041,2021-11-02T00:00:00.000
978,2021-01-07T00:00:00.000
612,2021-12-31T00:00:00.000
421,2020-11-16T00:00:00.000
449,2021-07-03T00:00:00.000
1022,2021-06-02T00:00:00.000
644,2021-01-25T00:00:00.000
718,2021-09-30T00:00:00.000
920,2021-08-10T00:00:00.000
1048,2021-09-30T00:00:00.000
1024,2021-04-22T00:00:00.000
929,2021-12-22T00:00:00.000
863,2021-12-07T00:00:00.000
662,2020-12-21T00:00:00.000
1027,2021-06-24T00:00:00.000
783,2021-03-26T00:00:00.000
592,2021-11-17T00:00:00.000
1023,2021-01-26T00:00:00.000
1051,2021-11-03T00:00:00.000
633,2021-04-07T00:00:00.000
635,2021-06-02T00:00:00.000
697,2021-12-20T00:00:00.000
886,2021-03-30T00:00:00.000
798,2021-02-11T00:00:00.000
1008,2021-11-08T00:00:00.000
701,2020-12-31T00:00:00.000
825,2021-10-13T00:00:00.000
344,2021-06-29T00:00:00.000
643,2021-12-15T00:00:00.000
509,2021-08-04T00:00:00.000
979,2021-02-25T00:00:00.000
1031,2021-10-07T00:00:00.000
817,2021-05-04T00:00:00.000
943,2019-03-22T00:00:00.000
975,2021-04-30T00:00:00.000
Query:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 100
Answer:
industry,unicorn_count
Fintech,179
Internet software & services,156
E-commerce & direct-to-consumer,76
Artificial intelligence,53
Health,52
Other,43
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Hardware,15
Auto & transportation,15
Consumer & retail,11
Travel,7
Query:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1
Answer:
industry,unicorn_count
Fintech,179
Query:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1;
Answer:
industry,unicorn_count
Fintech,232
Query:
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined",
       COUNT(*) AS "unicorns_per_year"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
GROUP BY "year_joined"
ORDER BY "year_joined"
LIMIT 100
Answer:
year_joined,unicorns_per_year
2019,21
2020,18
2021,140
Query:
SELECT DISTINCT "industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES"
LIMIT 100
Answer:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel
Query:
SELECT COUNT(*) AS "total_unicorns"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
LIMIT 100
Answer:
total_unicorns
179
Query:
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined",
       COUNT(*) AS "unicorns_per_year"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "year_joined"
ORDER BY "year_joined"
LIMIT 100
Answer:
year_joined,unicorns_per_year
2019,107
2020,109
2021,524
Query:
SELECT "c"."company_id", "i"."industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) = 2020
LIMIT 100
Answer:
company_id,industry
109,Fintech
743,Other
934,E-commerce & direct-to-consumer
456,Cybersecurity
1001,Other
625,Internet software & services
760,Mobile & telecommunications
421,Internet software & services
662,Fintech
701,Internet software & services
647,Cybersecurity
129,Other
989,Health
78,Internet software & services
212,Other
65,Cybersecurity
252,Mobile & telecommunications
287,E-commerce & direct-to-consumer
191,Auto & transportation
101,Health
941,Mobile & telecommunications
614,E-commerce & direct-to-consumer
881,Other
749,Cybersecurity
683,E-commerce & direct-to-consumer
203,Data management & analytics
170,Mobile & telecommunications
832,Data management & analytics
490,Other
908,Other
468,Hardware
545,Mobile & telecommunications
84,Fintech
561,Internet software & services
66,E-commerce & direct-to-consumer
60,Other
155,Fintech
475,"""Supply chain, logistics, & delivery"""
289,Health
428,Internet software & services
54,Internet software & services
57,Internet software & services
786,Data management & analytics
192,Data management & analytics
589,Data management & analytics
596,Fintech
208,Fintech
598,Health
659,Auto & transportation
524,Internet software & services
23,E-commerce & direct-to-consumer
105,Auto & transportation
502,Internet software & services
195,E-commerce & direct-to-consumer
125,Fintech
843,Auto & transportation
233,Internet software & services
291,Artificial intelligence
371,Fintech
346,Internet software & services
159,Mobile & telecommunications
112,Internet software & services
829,E-commerce & direct-to-consumer
188,Internet software & services
525,E-commerce & direct-to-consumer
90,Internet software & services
318,Fintech
318,Fintech
193,Edtech
302,Edtech
197,E-commerce & direct-to-consumer
196,Cybersecurity
469,Other
859,Health
337,Cybersecurity
259,Cybersecurity
225,Internet software & services
77,Fintech
487,Fintech
95,Artificial intelligence
38,E-commerce & direct-to-consumer
571,Mobile & telecommunications
1073,E-commerce & direct-to-consumer
1006,Edtech
736,Health
544,Other
977,E-commerce & direct-to-consumer
661,Fintech
68,Internet software & services
367,Artificial intelligence
22,Consumer & retail
111,Data management & analytics
74,Fintech
294,Auto & transportation
319,E-commerce & direct-to-consumer
274,Edtech
152,Fintech
232,Internet software & services
88,Mobile & telecommunications
128,Internet software & services
Query:
SELECT AVG("f"."valuation") AS "average_valuation"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
LIMIT 100
Answer:
average_valuation
3386740331.491713
Query:
SELECT "i"."industry", COUNT(*) AS "unicorn_count"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "unicorn_count" DESC
LIMIT 5
Answer:
industry,unicorn_count
Fintech,179
Internet software & services,156
E-commerce & direct-to-consumer,76
Artificial intelligence,53
Health,52
Query:
SELECT DISTINCT EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year_joined"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
ORDER BY "year_joined"
LIMIT 100
Answer:
year_joined
2007
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
Query:
SELECT "company_id", "year_founded", "date_joined"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES"
WHERE "year_founded" > 2010
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
LIMIT 100
Answer:
company_id,year_founded,date_joined
153,2016,2019-07-11T00:00:00.000
1022,2013,2021-06-02T00:00:00.000
433,2013,2021-04-17T00:00:00.000
902,2015,2021-01-27T00:00:00.000
1065,2015,2021-06-01T00:00:00.000
848,2019,2021-06-01T00:00:00.000
999,2020,2021-11-17T00:00:00.000
396,2021,2021-10-21T00:00:00.000
931,2020,2021-09-24T00:00:00.000
364,2015,2019-02-01T00:00:00.000
906,2017,2021-06-10T00:00:00.000
844,2018,2021-07-07T00:00:00.000
894,2020,2021-12-06T00:00:00.000
813,2017,2021-08-10T00:00:00.000
743,2015,2020-12-24T00:00:00.000
226,2020,2021-01-24T00:00:00.000
963,2017,2021-10-05T00:00:00.000
764,2018,2021-12-07T00:00:00.000
839,2016,2021-12-28T00:00:00.000
549,2016,2021-09-22T00:00:00.000
755,2017,2021-09-08T00:00:00.000
175,2011,2019-06-25T00:00:00.000
398,2017,2021-10-15T00:00:00.000
814,2014,2021-11-16T00:00:00.000
1046,2014,2021-06-16T00:00:00.000
565,2013,2021-04-21T00:00:00.000
781,2018,2021-08-31T00:00:00.000
997,2011,2021-12-06T00:00:00.000
249,2019,2021-06-29T00:00:00.000
434,2014,2021-05-19T00:00:00.000
1035,2020,2021-11-18T00:00:00.000
1018,2011,2021-02-18T00:00:00.000
355,2017,2021-09-14T00:00:00.000
934,2011,2020-03-17T00:00:00.000
1054,2016,2021-05-18T00:00:00.000
901,2020,2021-11-08T00:00:00.000
173,2018,2021-12-20T00:00:00.000
830,2017,2021-03-30T00:00:00.000
1004,2016,2021-05-24T00:00:00.000
1063,2018,2021-11-10T00:00:00.000
846,2015,2019-10-21T00:00:00.000
1030,2019,2021-08-09T00:00:00.000
456,2016,2020-01-29T00:00:00.000
893,2020,2021-09-02T00:00:00.000
1001,2020,2020-09-21T00:00:00.000
703,2018,2021-12-02T00:00:00.000
884,2020,2021-12-14T00:00:00.000
625,2012,2020-01-28T00:00:00.000
971,2015,2021-11-02T00:00:00.000
771,2017,2021-09-28T00:00:00.000
758,2016,2021-12-21T00:00:00.000
652,2015,2021-06-15T00:00:00.000
760,2016,2020-11-17T00:00:00.000
393,2013,2021-09-27T00:00:00.000
870,2016,2021-02-16T00:00:00.000
804,2019,2021-09-16T00:00:00.000
1041,2015,2021-11-02T00:00:00.000
978,2015,2021-01-07T00:00:00.000
612,2016,2021-12-31T00:00:00.000
449,2019,2021-07-03T00:00:00.000
1022,2013,2021-06-02T00:00:00.000
644,2016,2021-01-25T00:00:00.000
718,2015,2021-09-30T00:00:00.000
1048,2014,2021-09-30T00:00:00.000
1024,2011,2021-04-22T00:00:00.000
929,2019,2021-12-22T00:00:00.000
863,2019,2021-12-07T00:00:00.000
662,2015,2020-12-21T00:00:00.000
1027,2012,2021-06-24T00:00:00.000
783,2016,2021-03-26T00:00:00.000
592,2018,2021-11-17T00:00:00.000
1023,2018,2021-01-26T00:00:00.000
633,2011,2021-04-07T00:00:00.000
635,2011,2021-06-02T00:00:00.000
697,2018,2021-12-20T00:00:00.000
886,2016,2021-03-30T00:00:00.000
798,2017,2021-02-11T00:00:00.000
1008,2020,2021-11-08T00:00:00.000
825,2014,2021-10-13T00:00:00.000
643,2016,2021-12-15T00:00:00.000
509,2014,2021-08-04T00:00:00.000
979,2013,2021-02-25T00:00:00.000
1031,2017,2021-10-07T00:00:00.000
817,2014,2021-05-04T00:00:00.000
943,2014,2019-03-22T00:00:00.000
975,2015,2021-04-30T00:00:00.000
705,2018,2021-12-07T00:00:00.000
942,2018,2021-04-20T00:00:00.000
354,2011,2019-12-05T00:00:00.000
688,2015,2019-05-15T00:00:00.000
391,2020,2021-12-17T00:00:00.000
579,2018,2021-10-06T00:00:00.000
686,2014,2021-07-28T00:00:00.000
822,2021,2021-12-28T00:00:00.000
882,2013,2021-06-16T00:00:00.000
369,2015,2021-03-01T00:00:00.000
1058,2012,2019-05-07T00:00:00.000
862,2016,2021-07-13T00:00:00.000
603,2013,2021-01-25T00:00:00.000
645,2015,2021-05-06T00:00:00.000
Query:
SELECT "i"."industry", AVG("f"."funding") AS "average_funding"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "i"."industry"
ORDER BY "average_funding" DESC
LIMIT 100
Answer:
industry,average_funding
Auto & transportation,1002812500.000000
Travel,788142857.142857
E-commerce & direct-to-consumer,632000000.000000
"""Supply chain, logistics, & delivery""",579750000.000000
Other,497477272.727273
Consumer & retail,495454545.454545
Artificial intelligence,474584905.660377
Edtech,472764705.882353
Fintech,456226519.337017
Cybersecurity,455789473.684211
Data management & analytics,451580645.161290
Health,409150943.396226
Mobile & telecommunications,388111111.111111
Internet software & services,353834394.904459
Hardware,344666666.666667
Query:
SELECT "c"."company_id", "f"."select_investors"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
LIMIT 100
Answer:
Too long, hard cut:
company_id,select_investors
109,Technology Crossover Ventures
821,"""Spark Capital, Highland Europe, Sunstone Capital"""
153,Insight Partners
972,"""Sinovation Ventures, Tencent Holdings, Sequoia Capital China"""
1022,"""Version One Ventures, Uncork Capital, Bessemer Venture Partners"""
433,"""Sequoia Capital China, Warburg Pincus, IDG Capital"""
747,"""FirstMark Capital, Tiger Global Management"""
902,"""Bessemer Venture Partners, Pitango Venture Capital, D1 Capital Partners"""
1065,"""Eastern Bell Capital, Danhua Capital, MSA Capital"""
388,"""Notion Capital, Scentan Ventures, Kite Ventures"""
748,"""Mitsubishi Corporation, Mayfair Equity Partners"""
189,EQT Partners
848,"""Dragonfly Captial, Qiming Venture Partners, DST Global"""
556,"""Blackstone, Bessemer Venture Partners"""
999,"""Goldman Sachs Asset Management, 3L"""
396,"""Insight Partners, Softbank Group, Connect Ventures"""
931,"""Tencent Holdings, Hillhouse Capital Management"""
364,"""K2VC, Lightspeed China Partners, Sky9 Capital"""
732,"""Initialized Capital, General Catalyst, Kraken Ventures"""
906,"""Delian Capital, China International Capital Corporation, Sequoia Capital China"""
72,"""Accel Partners, Sequoia Capital"""
983,"""Investment Corporation of Dubai, Centralway"""
898,"""Lightspeed India Partners, Sequoia Capital India, Endiya Partners"""
844,"""General Catalyst, Future Ventures, AU21"""
894,"""DST Global, General Catalyst, Monashees+"""
813,"""Polychain Capital, Coinbase Ventures, Jump Capital"""
743,"""Coatue Management, H Capital, Capital Today"""
226,"""Andreessen Horowitz, TQ Ventures"""
963,"""Left Lane Capital, Galaxy Interactive, Tru Arrow Partners"""
764,"""Craft Ventures, Caffeinated Capital, Operator Collective"""
839,"""Fireside Ventures, Sequoia Capital India, Stellaris Venture Partners"""
1033,"""Storm Ventures, DFJ DragonFund, New Enterprise Associates"""
725,"""SC.Holdings, Not Boring Capital, Bolt Ventures"""
549,"""Northern Light Venture Capital, Xiaomi, FutureX Capital"""
667,"""Redpoint Ventures, QiMing Venture Partners, Chengwei Capital"""
755,"""Passion Capital, Hedosophia, Outrun Ventures"""
782,"""Paradigm, Andreessen Horowitz, Jump Capital"""
175,"""Bnk To The Future, Trammell Ventures, SBI Investment"""
398,"""Accomplice, Polychain Capital, GoldenTree Asset Management"""
814,"""M13, Lightspeed Venture Partners, Lone Pine Capital"""
436,GAM Holding
1046,"""Insight Partners, Ignition Partners, Georgian Partners"""
565,"""Tomales Bay Capital, Bain & Company, General Catalyst"""
781,"""Pantera Capital, Polychain Capital, Lightspeed Venture Partners"""
997,"""Prysm Capital, Baillie Gifford & Co., TDM Growth Partners"""
194,"""Silver Lake, ICONIQ Capital"""
249,"""Day One Ventures, Coinbase Ventures, Andreessen Horowitz"""
434,"""Shunwei Capital Partners, China Media Group, Guangzhou Huiyin Aofeng Equity Investment Fund"""
1035,"""Index Ventures, Benchmark, Thrive Capital"""
969,"""General Catalyst, Nexus Venture Partners, Dell Technologies Capital"""
1018,"""New Enterprise Associates, Accel, Bond"""
355,"""VGames, Lakestar, Galaxy Interactive"""
934,"""Technology Crossover Ventures, Alkeon Capital Management, General Atlantic"""
1054,"""Sequoia Capital, Founders Fund, Bling Capital"""
901,"""Cowboy Ventures, Leaders Fund, GGV Capital"""
173,"""Foundation Capital, Frontier Ventures, AltaIR Capital"""
738,"""Left Lane Capital, Walden Venture Capital"""
422,"""Amplify Partners, Addition, Madrona Venture Group"""
830,"""Thrive Capital, Khosla Ventures, Tiger Global Management"""
1004,Bregal Sagemount
951,"""5Y Capital, Matrix Partners China, K2VC"""
734,"""Zeev Ventures, GSV Ventures"""
1063,"""Equal Ventures, Uncork Capital, Andreessen Horowitz"""
623,"""Matrix Partners China, Ventech China, Shunwei Capital Partners"""
846,"""New Enterprise Associates, Greylock Partners, Andreessen Horowitz"""
823,"""Ardian, Tiger Global Management, KKR"""
944,"""Kleiner Perkins Caufield & Byers, NightDragon Security, Venrock"""
1030,"""Greylock Partners, Google Ventures, BlackRock"""
824,"""Tiantu Capital, SAIF Partners China, Newsion Venture Capital"""
930,"""Nexus Venture Partners, Vertex Ventures, STRIVE"""
370,"""Boxin Capital, DT Capital Partners, IDG Capital"""
618,"""U.S.-China Green Fund, Founder H Fund, Richland Equities"""
456,"""next47, First Round Capital, Sequoia Capital"""
893,"""Andreessen Horowitz, DST Global, IDG Capital"""
812,"""General Catalyst, Inspired Capital, Flybridge Capital Partners"""
1001,"""Sozo Ventures, Caffeinated Capital, Sequoia Capital"""
703,"""Innovation Endeavors, s28 Capital, Lightspeed Venture Partners"""
884,"""Thrive Capital, General Catalyst, Coatue Management"""
404,"""Moonshots Capital, BoxGroup, Blu Venture Investors"""
952,"""Andreessen Horowitz, FTX Ventures, Tiger Global Management"""
625,"""Index Ventures, Thrive Capital, Bain Capital Ventures"""
971,"""GGV Capital, GSR Ventures, FreesFund"""
796,"""Sequoia Capital China, Qiming Venture Partners, Tencent Holdings"""
909,"""Next Pl
Query:
SELECT SUM("f"."funding") AS "total_funding"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
  ON "c"."company_id" = "i"."company_id"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND "i"."industry" = 'Fintech'
LIMIT 100
Answer:
total_funding
82577000000
Query:
SELECT AVG("industry_count") AS "average_unicorns_per_industry"
FROM (
  SELECT "i"."industry", COUNT(*) AS "industry_count"
  FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
  JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS "i"
    ON "c"."company_id" = "i"."company_id"
  WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  GROUP BY "i"."industry"
) AS "sub"
LIMIT 100
Answer:
average_unicorns_per_industry
49.800000
Query:
SELECT "c"."company_id", "f"."valuation"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS "c"
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_FUNDING" AS "f"
  ON "c"."company_id" = "f"."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP("c"."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) = 2021
ORDER BY "f"."valuation" DESC
LIMIT 100
Answer:
company_id,valuation
12,32000000000
16,20000000000
24,14000000000
27,13000000000
37,12000000000
34,12000000000
42,11000000000
44,11000000000
39,11000000000
53,10000000000
51,10000000000
51,10000000000
61,9000000000
75,8000000000
80,8000000000
76,8000000000
82,8000000000
79,8000000000
99,7000000000
100,7000000000
97,7000000000
87,7000000000
108,6000000000
127,6000000000
102,6000000000
122,6000000000
119,6000000000
113,6000000000
116,6000000000
124,6000000000
126,6000000000
107,6000000000
144,5000000000
151,5000000000
135,5000000000
146,5000000000
130,5000000000
160,5000000000
157,5000000000
164,5000000000
156,5000000000
147,5000000000
145,5000000000
138,5000000000
142,5000000000
150,5000000000
167,5000000000
182,4000000000
202,4000000000
198,4000000000
239,4000000000
236,4000000000
184,4000000000
194,4000000000
226,4000000000
205,4000000000
201,4000000000
221,4000000000
209,4000000000
200,4000000000
177,4000000000
199,4000000000
216,4000000000
173,4000000000
180,4000000000
168,4000000000
230,4000000000
204,4000000000
181,4000000000
237,4000000000
178,4000000000
179,4000000000
215,4000000000
206,4000000000
183,4000000000
218,4000000000
234,4000000000
223,4000000000
187,4000000000
338,3000000000
303,3000000000
260,3000000000
244,3000000000
313,3000000000
286,3000000000
261,3000000000
344,3000000000
276,3000000000
347,3000000000
326,3000000000
283,3000000000
329,3000000000
349,3000000000
266,3000000000
298,3000000000
265,3000000000
300,3000000000
242,3000000000
336,3000000000
272,3000000000
End Exploring Related Columns
Task: Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Average_new_unicorn_companies_per_year_in_top_industry
average:int
(Attention: answer in one row)
```

To calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021, we first identified the industry with the highest number of new unicorns during that period. We then counted the total number of new unicorn companies in that industry from 2019 to 2021 and divided it by the number of years (3) to find the average..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'MODERN_DATA': {'MODERN_DATA': ['COMPANIES_DATES', 'COMPANIES_FUNDING', 'COMPANIES_INDUSTRIES', 'INCOME_TREES', 'PIZZA_CLEAN_CUSTOMER_ORDERS', 'PIZZA_CLEAN_RUNNER_ORDERS', 'PIZZA_CUSTOMER_ORDERS', 'PIZZA_GET_EXCLUSIONS', 'PIZZA_GET_EXTRAS', 'PIZZA_NAMES', 'PIZZA_RECIPES', 'PIZZA_RUNNERS', 'PIZZA_RUNNER_ORDERS', 'PIZZA_TOPPINGS', 'STATISTICS', 'TREES', 'WORD_LIST']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-21 15:02:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 15:02:52 - root - INFO - ```sql
SELECT
  ROUND(COUNT(*) / 3.0, 4) AS "Average_new_unicorn_companies_per_year_in_top_industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS c
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS i
  ON c."company_id" = i."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP(c."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND i."industry" = (
    SELECT i2."industry"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS c2
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS i2
      ON c2."company_id" = i2."company_id"
    WHERE EXTRACT(YEAR FROM TO_TIMESTAMP(c2."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
    GROUP BY i2."industry"
    ORDER BY COUNT(*) DESC
    LIMIT 1
  );
```
2025-01-21 15:02:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:02:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:02:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:02:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:02:54 - snowflake.connector.connection - INFO - closed
2025-01-21 15:02:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:02:54 - root - INFO - itercount: 1
2025-01-21 15:02:54 - root - INFO - 0
2025-01-21 15:02:54 - root - INFO - results: 
Average_new_unicorn_companies_per_year_in_top_industry
59.6667


2025-01-21 15:02:54 - root - INFO - Please check the answer again by reviewing Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Average_new_unicorn_companies_per_year_in_top_industry
average:int
(Attention: answer in one row)
```

To calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021, we first identified the industry with the highest number of new unicorns during that period. We then counted the total number of new unicorn companies in that industry from 2019 to 2021 and divided it by the number of years (3) to find the average. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Average_new_unicorn_companies_per_year_in_top_industry
59.6667
Current sql:
SELECT
  ROUND(COUNT(*) / 3.0, 4) AS "Average_new_unicorn_companies_per_year_in_top_industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS c
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS i
  ON c."company_id" = i."company_id"
WHERE EXTRACT(YEAR FROM TO_TIMESTAMP(c."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
  AND i."industry" = (
    SELECT i2."industry"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS c2
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS i2
      ON c2."company_id" = i2."company_id"
    WHERE EXTRACT(YEAR FROM TO_TIMESTAMP(c2."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
    GROUP BY i2."industry"
    ORDER BY COUNT(*) DESC
    LIMIT 1
  );When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-21 15:03:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 15:03:19 - root - INFO - ```csv
Average_new_unicorn_companies_per_year_in_top_industry
59.6667
```

```sql
SELECT
  ROUND(COUNT(*) / 3.0, 4) AS "Average_new_unicorn_companies_per_year_in_top_industry"
FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS c
JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS i
  ON c."company_id" = i."company_id"
WHERE EXTRACT(
        YEAR FROM TO_TIMESTAMP(c."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')
      ) BETWEEN 2019 AND 2021
  AND i."industry" = (
    SELECT i2."industry"
    FROM MODERN_DATA.MODERN_DATA."COMPANIES_DATES" AS c2
    JOIN MODERN_DATA.MODERN_DATA."COMPANIES_INDUSTRIES" AS i2
      ON c2."company_id" = i2."company_id"
    WHERE EXTRACT(
            YEAR FROM TO_TIMESTAMP(c2."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')
          ) BETWEEN 2019 AND 2021
    GROUP BY i2."industry"
    ORDER BY COUNT(*) DESC NULLS LAST
    LIMIT 1
  );
```
2025-01-21 15:03:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 15:03:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 15:03:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 15:03:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 15:03:21 - snowflake.connector.connection - INFO - closed
2025-01-21 15:03:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 15:03:21 - root - INFO - itercount: 2
2025-01-21 15:03:21 - root - INFO - 0
2025-01-21 15:03:21 - root - INFO - Total iteration counts: 2
