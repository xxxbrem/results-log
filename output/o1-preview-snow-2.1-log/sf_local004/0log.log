2025-01-21 14:39:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.455120 seconds
2025-01-21 14:40:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:40:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:40:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:40:57 - snowflake.connector.connection - INFO - closed
2025-01-21 14:40:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:40:58 - root - INFO - SQL:
SELECT "customer_id"
   FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
   LIMIT 100;
Results:
customer_id
06b8999e2fba1a1fbc88172c00ba8bc7
18955e83d337fd6b2def6b18a428ac77
4e7b3e00288586ebd08712fdd0374a03
b2b6027bc5c5109e529d4dc6358b12c3
4f2d8ab171c80ec8364f7c12e35b23ad
879864dab9bc3047522c92c82e1212b8
fd826e7cf63160e536e0908c76c3f441
5e274e7a0c3809e14aba7ad5aae0d407
5adf08e34b2e993982a47070956c5c65
4b7139f34592b3a31687243a302fa75b
9fb35e4ed6f0a14a4977cd9aea4042bb
5aa9e4fdd4dfd20959cad2d772509598
b2d1536598b73a9abd18e0d75d92f0a3
eabebad39a88bb6f5b52376faec28612
1f1c7bf1c9b041b292af6c1c4470b753
206f3129c0e4d7d0b9550426023f0a08
a7c125a0a07b75146167b7f04a7f8e98
c5c61596a3b6bd0cee5766992c48a9a1
9b8ce803689b3562defaad4613ef426f
49d0ea0986edde72da777f15456a0ee0
154c4ded6991bdfa3cd249d11abf4130
690172ab319622688d3b4df42f676898
2938121a40a20953c43caa8c98787fcb
237098a64674ae89babdc426746260fc
cb721d7b4f271fd87011c4c83462c076
f681356046d9fde60e70c73a18d65ea2
167bd30a409e3e4127df5a9408ebd394
6e359a57a91f84095cc64e1b351aef8c
e0eea8f69a457b3f1fa246e44c9ebefd
e3109970a3fe8021d5ff82c577ce5606
261cb4f92498ca05d5bd1a327a261d9c
6f92779347724b67e44e3224f3b4cffd
2d5831cb2dff7cdefba62e950ae3dc7b
b2bed119388167a954382cca36c4777f
469634941c27cd844170935a3cf60b95
df0aa5b8586495e0ddf6b601122e43a1
41c8f4b570869791379a925899a6af8a
54f755c3fd2709231f9964a1430c5218
4c06b42fbf7b97ab10779cda5549cd1c
b6368ca0f56d4632f44d58ca431487b2
4a0e66fd30684aa1409cd1b66fec77cc
c168abb9077b7821adae01dc1f0886c5
a3b0fda37bae14cf754877bed475e80c
0ccd415657ae8a6cd1c71b00155a019e
c532a74a3ebf1bacce2e2bcce3783317
19cecb194f54e614b70d971306a9931b
f34a6e874087ec1f0e3dab9fdf659c5d
c132855c926907970dcf6f2bf0b33a24
df85b96ba2ce3e49bde101b1614f52ac
4d27341acd30a36bca39008ee9bb9050
d3b6830d18c7de943d1e707d1f061d40
79de53946db384e2d7a9bd131792ad17
a562ab1e728449e3461829dfe2e36f73
b64ed91eab98972150bdaf77ca921934
8247b5583327ab8be19f96e1fb82f77b
8fcaa9368903f3a9a28aeaff28c14638
a9b0d1c26105279e1b8edc63d06bd668
aa9f03ecd3728c9bd12e6d962c66c7cb
230c0d740401730c7197d16376893525
a905baa530258422594f1b05615bd225
4fa19f7da692e6bf9602aaad3c372eda
03f846ad03437d864a8d2a22976dcafe
de4e13fd7d6469c5ada77d0843c55e42
8276de07ef25225d412b8462d73f8664
cc32707d2e2f7c92ab449f9b28154809
a02f66c3af7b16eec19ddcd98b645fe3
26acee41e2f75689a5615892f06ea0bd
f64cdee66599119324ce57a97e43700d
7ab7a537b678b6dd73d825ff6ee7be9d
7300450cedf7e4c35c243c4a03c1e8a6
4c7241af24b5344cb01fe687643de4fe
97e126f19a6f04b3462619f36862bcd2
6d27a9361e591da38c87a5e70253f3f2
6810c3dc47f641181fcc7f73275c3d19
b514422efcf14bef34858a0829bef189
0aae2862f8eac77f10a34f44860720ac
6c9a5923526346cbc0bd7bbd92269c01
1b2cb35b19b40b61f953d32ea157b337
12d1b4294fef21016c9614eb31e55e15
f6529ffebe6b3440d45d89604a4239ac
8264e3518163dd09211870b24a5d741d
8392e3d4cfeec63f2a8bfea68bf1f91f
38d1cd89306128348ffdf4cc23f3a50a
91ec76836092bba85d11761078ed7bb5
f9dfa0a2934ffbb22e66924952548be8
5a3260cfde2a918b597dada7ddd247bb
ee3a81b2771fec5f9e982cdb1b3a4804
784c407781aa34749a388c9283782b56
3f6ede29d4c69cd3316d2035b6cec1fb
6bed27564bd99d78d09c1fac13da56fd
670254dd2e886ffe621b3831afb47d7d
f7cb015ff73be957ee6a30e2577742c5
ea2196dc456ba36fe4f6b81dca4867d4
09241c552e9fe2420997a6c535e9d408
e50a30de3c32f9406a7185f40ce6874d
f89c1a6b9c966869e441e55bc14acddc
23e96758fd640560e9b1fbcda90abfc4
369708cabd9831ea6fde670a3b602a92
5f8b4882b5a4ec7bf6d2107e6cd0cf29
ad6891a1937cb8723a2c08ba1ae59873

2025-01-21 14:40:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:40:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:40:59 - snowflake.connector.connection - INFO - closed
2025-01-21 14:40:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:40:59 - root - INFO - SQL:
SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab

2025-01-21 14:40:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:00 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:01 - root - INFO - SQL:
SELECT "order_id", "payment_value"
   FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
   LIMIT 100;
Results:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27

2025-01-21 14:41:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:02 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:03 - root - INFO - SQL:
SELECT o."order_id", c."customer_id", o."order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.CUSTOMERS c
     ON o."customer_id" = c."customer_id"
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
00e7ee1b050b8499577073aeb2a297a1,06b8999e2fba1a1fbc88172c00ba8bc7,2017-05-16 15:05:35
29150127e6685892b6eab3eec79f59c7,18955e83d337fd6b2def6b18a428ac77,2018-01-12 20:48:24
b2059ed67ce144a36e2aa97d2c9e9ad2,4e7b3e00288586ebd08712fdd0374a03,2018-05-19 16:07:45
951670f92359f4fe4a63112aa7306eba,b2b6027bc5c5109e529d4dc6358b12c3,2018-03-13 16:06:38
6b7d50bd145f6fc7f33cebabd7e49d0f,4f2d8ab171c80ec8364f7c12e35b23ad,2018-07-29 09:51:30
5741ea1f91b5fbab2bd2dc653a5b5099,879864dab9bc3047522c92c82e1212b8,2017-09-14 18:14:31
36e694cf4cbc2a4803200c35e84abdc4,fd826e7cf63160e536e0908c76c3f441,2018-02-19 14:38:35
1093c8304c7a003280dd34598194913d,5e274e7a0c3809e14aba7ad5aae0d407,2017-11-16 19:29:02
1ebeea841c590e86a14a0d7a48e7d062,5adf08e34b2e993982a47070956c5c65,2018-01-18 12:35:44
7433cbcc783205509d66a5260da5b574,4b7139f34592b3a31687243a302fa75b,2018-01-08 11:22:34
8428e578bb1cf839ae26a6b7615502b9,9fb35e4ed6f0a14a4977cd9aea4042bb,2017-11-27 17:23:20
f86c5ed7048ac10eb88ec21c00f71892,5aa9e4fdd4dfd20959cad2d772509598,2018-02-07 11:36:42
83d8f70418eefd96f37b483dff430305,b2d1536598b73a9abd18e0d75d92f0a3,2017-09-09 09:54:57
852d2f4d37773bcbc21c8e09a05a4ea5,eabebad39a88bb6f5b52376faec28612,2018-03-07 15:57:14
6c949e670b5d33dc8fb8ad25b6da4860,1f1c7bf1c9b041b292af6c1c4470b753,2018-04-01 18:59:31
eac76692452422620996fe5e1a7f8bb0,206f3129c0e4d7d0b9550426023f0a08,2018-01-29 20:32:08
72bab69c50432c6f94d8b50a5f84b69a,a7c125a0a07b75146167b7f04a7f8e98,2018-08-13 23:45:05
ec28553b12bef4b538e5d7454464a1c6,c5c61596a3b6bd0cee5766992c48a9a1,2018-06-18 13:34:21
17825f24877a9289214c301ae0c9424b,9b8ce803689b3562defaad4613ef426f,2017-05-11 13:48:47
ab797176e01c2fa3d13aa1fe3e63d9ee,49d0ea0986edde72da777f15456a0ee0,2017-11-01 21:54:10
830d8b3e6875ef6165ffc33219ab4fea,154c4ded6991bdfa3cd249d11abf4130,2017-08-13 10:03:36
aaff8afa47c8426e414a6d908a97713c,690172ab319622688d3b4df42f676898,2017-10-15 11:08:48
0198c71148c2e08c7c52b860f640fa4e,2938121a40a20953c43caa8c98787fcb,2018-05-08 06:34:07
eac4ffbe456464bdc3ce5f001b6439c5,237098a64674ae89babdc426746260fc,2017-04-14 11:24:56
6cdc131d3c28253cd03cd0fbc3d5f938,cb721d7b4f271fd87011c4c83462c076,2018-05-16 13:04:22
daf946e879dab6e7e6b3f968297c3fe3,f681356046d9fde60e70c73a18d65ea2,2018-02-09 13:46:04
d10eafa208521dc30796e6a26099b6a6,167bd30a409e3e4127df5a9408ebd394,2018-07-14 10:53:11
a8f5a2b22f55e0af45b300929d1fdc7d,6e359a57a91f84095cc64e1b351aef8c,2017-05-15 17:58:25
3a6d41a4fe7a8e841b7c8e4b77d4e301,e0eea8f69a457b3f1fa246e44c9ebefd,2017-11-24 11:29:52
0330631bdb2ec8c341f487ed9c22fc8b,e3109970a3fe8021d5ff82c577ce5606,2018-05-25 12:02:08
2904d3ae0064e840ffb4798ba4a12ae3,261cb4f92498ca05d5bd1a327a261d9c,2017-09-12 08:00:03
f3b96845efd71daecf6b331fb3a9f537,6f92779347724b67e44e3224f3b4cffd,2017-11-26 20:59:24
19c0c76962278b152cc44fc63ffd5e48,2d5831cb2dff7cdefba62e950ae3dc7b,2018-04-18 09:42:53
77b062be7c5bd21712905feb8e1cfeed,b2bed119388167a954382cca36c4777f,2017-06-14 18:31:54
a9119eb77d6200811953803a7b6539e1,469634941c27cd844170935a3cf60b95,2018-03-12 13:07:03
72bd19ef4fa285334b95bda01a3718c7,df0aa5b8586495e0ddf6b601122e43a1,2018-05-09 13:01:24
4ca8a781d1f4b13e966bf35cdc333f56,41c8f4b570869791379a925899a6af8a,2017-10-13 10:04:59
d4668cd8ef48b78df597195703c95da2,54f755c3fd2709231f9964a1430c5218,2017-08-10 13:01:54
997fd4b37386d10b57d4ac8cdec011a6,4c06b42fbf7b97ab10779cda5549cd1c,2018-07-08 09:59:19
47cb08d5bac6105ae32587814fca96ca,b6368ca0f56d4632f44d58ca431487b2,2018-02-11 14:07:45
42cebac003b40e6aa0b3e37b99d83c2f,4a0e66fd30684aa1409cd1b66fec77cc,2018-07-06 14:29:57
1bae3477022e0394ab9af1d25a242fd0,c168abb9077b7821adae01dc1f0886c5,2017-12-18 08:52:09
2dd604f5ec1bd2f58c14e9908c7df826,a3b0fda37bae14cf754877bed475e80c,2018-01-31 16:43:23
a74869096437cef33d04006e8480e0db,0ccd415657ae8a6cd1c71b00155a019e,2017-10-09 21:01:08
04a92860751dfe7ae41f71e1228ffd18,c532a74a3ebf1bacce2e2bcce3783317,2018-05-14 13:30:21
14282bc70be9bdda515182fb1ce62af4,19cecb194f54e614b70d971306a9931b,2018-04-18 14:18:09
6e98de3a85c84ead6689189b825d35b5,f34a6e874087ec1f0e3dab9fdf659c5d,2018-03-15 10:07:02
b5172d4a722c0ebb34c29bbbb7a3cb42,c132855c926907970dcf6f2bf0b33a24,2018-04-17 13:14:13
d13130a0433949ba242b2f0632fd49a2,df85b96ba2ce3e49bde101b1614f52ac,2017-11-26 11:43:57
38e2829123a2bd1cbe111564824d0abb,4d27341acd30a36bca39008ee9bb9050,2017-01-26 11:14:58
6b1fc7db81c9636bc79ef40baf9e8b29,d3b6830d18c7de943d1e707d1f061d40,2018-04-14 18:29:29
b95cae4001dc3efdaa739478cf9c92e4,79de53946db384e2d7a9bd131792ad17,2018-05-22 01:43:18
f13b9cfd03f5555ece664b0bec8d2bf8,a562ab1e728449e3461829dfe2e36f73,2018-01-29 21:53:47
d5691ee416fbe1f2d1b061319de61570,b64ed91eab98972150bdaf77ca921934,2018-05-11 06:47:44
a6917b5d71e0e9bc434e9228db8daeb2,8247b5583327ab8be19f96e1fb82f77b,2017-06-09 15:46:17
1a463c49e93ce429845e1d959122285d,8fcaa9368903f3a9a28aeaff28c14638,2018-02-03 08:14:02
c6ab8a5c6fbd3bf57e9ad8407d950cc6,a9b0d1c26105279e1b8edc63d06bd668,2018-01-29 11:04:44
07429f7601b56a66d1854c79a2f5c9e5,aa9f03ecd3728c9bd12

2025-01-21 14:41:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:04 - root - INFO - SQL:
SELECT o."order_id", o."customer_id", p."payment_value"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     ON o."order_id" = p."order_id"
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,0a8556ac6be836b46b3e89920d59291c,99.33
a9810da82917af2d9aefd1278f1dcfa0,f2c7fc58a9de810828715166c672f10a,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,25b14b69de0b6e184ae6fe2755e478f9,65.71
ba78997921bbcdc1373bb41e913ab953,7a5d8efaaa1081f800628c30d2b0728f,107.78
42fdf880ba16b47b59251dd489d4441a,15fd6fb8f8312dbb4674e4518d6fa3b3,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,a24e6f72471e9dbafcb292bc318f4859,96.12
771ee386b001f06208a7419e4fc1bbd7,206c0fcc717333d169ff95933fb47341,81.16
3d7239c394a212faae122962df514ac7,4d7a9b8bba459dce09d1b8fa637a0cba,51.84
1f78449c87a54faf9e96e88ba1491fa9,68c9dafdf193586c290b19c71541357a,341.09
0573b5e23cbd798006520e1d5b4c6714,c4e17eff78176dfe3401f03db0346f85,51.95
d88e0d5fa41661ce03cf6cf336527646,fe0c5425832ac53c3be5cb4aea25b60f,188.73
2480f727e869fdeb397244a21b721b67,94967f1e8a9ea8ec6c7129f098f32155,141.9
616105c9352a9668c38303ad44e056cd,8c0b2ef9efb43af92d5c0afff70d33d9,75.78
cf95215a722f3ebf29e6bbab87a29e61,e2a8d07201639004b090670ce5efe355,102.66
769214176682788a92801d8907fa1b40,2b01b5fb8141bbb9fcdc853a0e26da83,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,041cd6848abb3d3ca45e83dc971488fd,157.45
61059985a6fc0ad64e95d9944caacdad,89bca1b7e71b59a7d206d9d1da65c1f6,132.04
79da3f5fe31ad1e454f06f95dc032ad5,7eefe1898dff66fa3b252fda68ff2ff2,98.94
8ac09207f415d55acff302df7d6a895c,2d8bf5f6862af587af2e0b085a04bf0d,244.15
b2349a3f20dfbeef62e7b31baa22f84b,0ff24a24edd69d8774270ac863c8e230,136.71
5a1f6d22f7dfb061ef29216b9af687a1,4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
4214cda550ece8ee66441f459dc33a8c,be4ecdb7c9401fd98ed01456634cfcb2,170.57
adfbf6c2a620196f9a3ec747491c72b7,5b670130533827957619dfe306899fdd,67.5
4d680edbaa7d3d9bed69532957368a03,1444f701e835b7d189637c10f5287e76,353.09
8cd68144cdb62dc0d60848cf8616d2a4,c03b40c7971bc52b3d018247891270c5,330.66
5cfd514482e22bc992e7693f0e3e8df7,519a8af813fe88578029697625439e8b,45.17
d0a945f85ba1074b60aac97ade7e240e,4a44c8f258b8780e1da133c1f1c39854,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,0dac2ac6dcbbda827846734c0dc2dde6,139.22
5d9c5817e278892b7498d90bfa28ade8,b583a7efe4522c8ce8942bd47f33d487,290.16
b69b9260e79a0da00e15f48de1bd2524,0b34456a261dcc179512d6652e8cb276,283.34
f45074ae38f2e01d9b854ec8d40362ff,d036487ffd91aa5b2f21e17f2bb83543,13.78
81cedc4d2132eb6f512354166e51b187,a8f6bb35d78515a1762eb626d52b6352,30.28
595f598849d89203c28d05d0fbf3f92e,cefab390926b6fc3de3ca94c82ebb1ba,26.58
f9d0ec2fa088ac583e1ccd15b6686073,2b9c9e251dbb2a2a768fd48fbf151e4c,89.68
e647bf617de735448a4ba54f8910393c,11440840f5653ebba13e919285c71389,65.09
b2bb080b6bc860118a246fd9b6fad6da,023042a5cd5724a563a100acb1cf89c9,173.84
23f10f509600c30cf2852f9dbdf28fc3,934b4fa2791f6e1db380d989180d20cc,103.49
f86f6472fa9f395d8d9a6751ca118afb,ce6d32fa00bbae809e07c14126e5fa6e,64.03
1dcf0c8cd36ffaf57784fbdc90079310,34955e04695a861e22cfc5600244118d,157.15
00d8d65b666158b633f96054d31af43b,5e98d1f8f0534c460557d71961a7f10a,130.88
cf30fe76d1505192acee1c6dccb15545,3692097ced25d93525a447a4276fcf2f,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,54845a8b81a2d3e5b77fa702300da942,117.74
32b1d8f3789a57f1f752e20ac7404b4c,ae12a474c8de7dd68097a884fa9049b4,56.6
c10d412026c4077b8e83acf0fea04eee,4e2311c6a3b9c353851097a679ede20a,266.16
56c3277583e16009c925fdf116df420f,c3d06eb8905fc0c39966b0a57ee7244c,31.38
0e0441786430b7cfcd0d91f822ea4c99,f1220b145cc86460b4276b9b3e23e57d,121.49
6ffb3f1686bceae3466facf7e02ce3fb,0bb18eb234e80c2f203cac31f9b03078,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,65f09de0b77ca07963fde8601c6be1fb,153.41
c0db7d31ace61fc360a3eaa34dd3457c,80c0276f1c674e7b026d5a39799afaa4,65.71
d574338f566ca28dd67820f48ec1f1d8,d0715495890791e60e858ffc2b414cf9,278.22
1807cc736321f14baa58ef39cf6e5989,381aee1e9f4b0395a780330fab335b03,91.66
e8977f709bbb0367f51b589e6325f991,b7f69471fed8a036911323fca290a2c2,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,b9d460d12c9b6c5c3a0d73541e11e5f5,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,15e65458c1de2332a93656f2272c808e,166.04
95442deb81a5d91c97c0df96b431634a,daddb546b42f656e57ba8a3cf71a309f,368.98
10af96a0689260134307879127ac1952,c06d0ca3bead2fb2c60abf7864f427c4,113.2
85eef2d342b0de363c45c1bc324729c5,e67261dd807f298949d63fa4b1262eb8,99.43
aa964845f1de8125410aea8b73e9e1ec,d990663a73af8129834fca277b4743ca,27.35
343348b1e29e9fa9e7b6ab1027f9177d,017395cf7b4c0be4fa72650f0a8184ed,43.77
ad4098a257676ea4d394fb3bbbf36ca3,878b45ad0fa20acbb5198b2e979fb442,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,fcc4ed69deb551648926eab09355a9c5,105.53
3ab4eea6776259ae8dfbabaeffece352,24d46169d90daaa687cbf122c3243df8,387.8
10d9871bed9fb8d0887d3b9022edd1ff,778d30bc8e6a57dac20217ae0838b95a,84.14
c108072ab31ec90a754129c171577f5f,a979b3cbd898fd8be91a290a667fd0d4,210.82
fc662bafa52d2ef16078f6f6141009d6,f3ab9ca7b6a450eaa47bdcb67175ee74,90.05
4217849b1ff18a9270fe048eabc4dc45,b64f25449ad728c879f193819537d54c,67.88
795c16acb4e3c30dfa5b6827727ef488,d2727dd889fb74cc0b8d40cfaba7a696,37.58
55e2d723733c45033e71cb4d44690234,32a68880c3edfc878276ca3ffb8c084d,89.63
947e9c6bfd83a06953c420ef92d3da6e,27372118

2025-01-21 14:41:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:06 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:06 - root - INFO - SQL:
SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
   GROUP BY p."order_id"
   LIMIT 100;
Results:
order_id,total_payment_per_order
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
769214176682788a92801d8907fa1b40,105.28
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
4d680edbaa7d3d9bed69532957368a03,353.09
5d9c5817e278892b7498d90bfa28ade8,290.16
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
f9d0ec2fa088ac583e1ccd15b6686073,89.68
23f10f509600c30cf2852f9dbdf28fc3,103.49
cf30fe76d1505192acee1c6dccb15545,47.72
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
1807cc736321f14baa58ef39cf6e5989,91.66
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
795c16acb4e3c30dfa5b6827727ef488,37.58
e3e9e3295f4e1512167c232a0aaae8a5,50.8
42f5954cda381bd032934ee38c453711,402.42
c9f23db8a1cb725df9bdb3383bd72b38,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
b19ca559688b49e8cf7f88c1aa3f0009,73.34
4a02e985c7239d866a632f07ed20d9c0,48.62
46ee6eaca194413758f200a6974b7e4d,71.99
a490a5d59a9bf4ef3334bfd7cf1dbdfc,17.78
c1b770015e27aaf2b475026989d04fe0,137.73
d087b8e096ca051f548e29b324272834,72.05
5cfd514482e22bc992e7693f0e3e8df7,710.5799999999999
f86f6472fa9f395d8d9a6751ca118afb,64.03
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
56c3277583e16009c925fdf116df420f,31.38
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
343348b1e29e9fa9e7b6ab1027f9177d,43.77
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
f8d323a2702fed37f0229965f7e9f8b3,51.14
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
96de2b7f7f3c401fbee3eef068376da6,32.15
f090de1b2ed9f4e251662cb31e3c7127,27.63
2ccde1e4676c20b9444e2bcbed36334c,134.56
68d7420c86be23f313c81a554320f986,121.88
a5f860aaf6a3c35399495aefe92d363f,75.75
55779fa8fe072d9f8c92d672154558f2,233.66
845af9472cc76e66fbf445931b511755,123.41
67c8c2016ddabf0059783eb44e921f99,68.54
332c6742772f2df936696b6512b10edb,143.25
27a7ac440630f9de788e4d66e72c6424,186.39
e6670c9089973cc68e5b90b7d1f4fec4,88.49
aa7c35fd606f4275e267e859c6a84d0f,26.68
3d7239c394a212faae122962df514ac7,51.84
cf95215a722f3ebf29e6bbab87a29e61,102.66
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
8cd68144cdb62dc0d60848cf8616d2a4,330.66
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
e647bf617de735448a4ba54f8910393c,65.09
aa964845f1de8125410aea8b73e9e1ec,27.35
ad4098a257676ea4d394fb3bbbf36ca3,68.49
4217849b1ff18a9270fe048eabc4dc45,67.88
55e2d723733c45033e71cb4d44690234,89.63
4c2e1a95586c815795a324d1599e7b5a,117.71
723e462ce1ee50e024887c0b403130f3,113.8
198298d54f269d8c5fe89e85a859af61,342.56
20f136d890c31a62486c809f91a5b098,117.68
cf61ad2218e5c14397e7c0ba7a6a50f9,35.14
99bc267f49d76932cd195bfb2a94dd03,163.08
aa600269bffea363cca75ad2d1908903,93.26
57e4fc8f20507381b3f7abbe4e2ccda3,215.56
ae1126b6891f58552443772c80b1f562,133.81
42fdf880ba16b47b59251dd489d4441a,128.45
adfbf6c2a620196f9a3ec747491c72b7,67.5
d0a945f85ba1074b60aac97ade7e240e,541.0
595f598849d89203c28d05d0fbf3f92e,26.58
b2bb080b6bc860118a246fd9b6fad6da,197.92000000000002
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
e8977f709bbb0367f51b589e6325f991,132.51
95442deb81a5d91c97c0df96b431634a,368.98
fc662bafa52d2ef16078f6f6141009d6,90.05
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
460d57443ffdcaeba240360239747cf7,34.0
4d3bfdf4c7d6578ea445d588371ae10e,77.29
8e47a04b25d7a7075064e8e0bd2e0318,37.61

2025-01-21 14:41:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:07 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:08 - root - INFO - SQL:
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,total_payment
0a8556ac6be836b46b3e89920d59291c,99.33
f2c7fc58a9de810828715166c672f10a,24.39
a24e6f72471e9dbafcb292bc318f4859,96.12
c4e17eff78176dfe3401f03db0346f85,51.95
94967f1e8a9ea8ec6c7129f098f32155,141.9
8c0b2ef9efb43af92d5c0afff70d33d9,75.78
2b01b5fb8141bbb9fcdc853a0e26da83,105.28
4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
be4ecdb7c9401fd98ed01456634cfcb2,170.57
5b670130533827957619dfe306899fdd,67.5
1444f701e835b7d189637c10f5287e76,353.09
c03b40c7971bc52b3d018247891270c5,330.66
d036487ffd91aa5b2f21e17f2bb83543,13.78
a8f6bb35d78515a1762eb626d52b6352,30.28
ce6d32fa00bbae809e07c14126e5fa6e,64.03
c3d06eb8905fc0c39966b0a57ee7244c,31.38
f1220b145cc86460b4276b9b3e23e57d,121.49
d990663a73af8129834fca277b4743ca,27.35
73e4f0d08b9eaf4009d3218057343b5a,78.3
31f9366e8fbe2412ddbae2d9c49d8adf,77.7
7badbcce7da90b7920997ddbac3187b5,77.29
b5d838521379fbc2a2e8c3f360f57e01,227.12
ff93b4413884cd9b2d851e9133d8c1ab,34.09
6de980369453bc98c75da669412a0e85,348.02
fe0c5425832ac53c3be5cb4aea25b60f,188.73
0ff24a24edd69d8774270ac863c8e230,136.71
b583a7efe4522c8ce8942bd47f33d487,290.16
11440840f5653ebba13e919285c71389,65.09
34955e04695a861e22cfc5600244118d,157.15
4e2311c6a3b9c353851097a679ede20a,266.16
15e65458c1de2332a93656f2272c808e,166.04
daddb546b42f656e57ba8a3cf71a309f,368.98
2737211835d5ea370af15ee145f7840c,69.46
2514a33b1704c36bdfbe51840e105cde,34.0
2d1276417ffab1c174139789098cecc3,77.1
2346308634084083a80df78332c411dc,48.68
8d4fd10d20cdc0fa3589cfdee2b1cb07,342.56
a97f15194f6fc81433e550a34dec906a,53.99
b78f37cd0654fbbf35c5277b24936535,56.77
eec30b788184a6d93954fd5e82c48add,32.15
e2bea5774e2c8aa227075fc4d2c3ba39,40.99
27a2735706788ec6d39d0de52ce2457b,71.99
0f687ed7edef79545319e147f39a290a,47.0
d49bac4ac7d77b956f2b185ab700fbf1,231.45
84e14521bff8cbb289a87be1961d3d08,144.2
ab2b94cec822788e131f15e0033544cf,27.63
a10c24a3a00d939852f086c7162e564d,134.56
a3343433090af3beb34febb7899bf0ee,96.98
b8fc2edd015cea8b8cd1f308c30541fd,267.05
54efba24ef631ff2c2088f8320499ea5,48.61
55d6fe64c9ff321e925f284f7e0d69d8,125.53
d50a8dc7e28e47e8119560e53b1c7deb,44.35
61260c512475ab1d7519b332199e8c1d,213.9
e957d597f76d275f40a848397fb6c7c3,362.17
ad5eaed951a10f80d09e7f473a8fd08e,103.79
4068269eb194e5957c5b2abce6939ee4,49.7
680e38a70d371582570f41cc47dc2791,285.79
b0c22a057e308ffdd32ce03e1734aa62,404.88
bf0b4acdb6eb69084a7714bf7cc748f0,54.85
3d3e7494fc24a4f50a6bff232428f8fe,44.83
f5025a3893cbcdd251b06c0b3f7451da,52.529999999999994
ae6a20cbef31289987c08cdc617a19ac,256.37
047c4f9e8ca120c41c8d4a61df722ea2,102.26
79bdc6288517cb7f94c86be6c97b7ba7,127.53
381aee1e9f4b0395a780330fab335b03,91.66
017395cf7b4c0be4fa72650f0a8184ed,43.77
1353b6db7e448ecfad1a4cd13b95f832,113.8
92f70647283582ec50ca1bb5794f6c90,107.72
58d45cf285d3d5bdd45609c696e00b9e,46.63
90cf9029b6b6b9469c7f0f9c82a59da3,52.21
519a8af813fe88578029697625439e8b,710.5799999999999
4a44c8f258b8780e1da133c1f1c39854,541.0
f9bdbea246da607ab4641959ba6aa32f,34.78
e46db370a98dec564da620109436f09a,117.68
bdbf22817eb36add4815586f4957adb1,88.49
8e5b95cc9167186235d12c22e7d79015,81.78
1387e2d23533abc24be58c9b3a1f06b9,17.78
c7ada2a2ca6ff94ccc7bbd16af1dec55,61.77
b7d2c0ccf5e66c2d1c496d6a8250eae4,31.0
58b3208913cae35dadfac41929721901,116.05
79e2cae59c2216c721c54ff9c53ad657,85.14
7ac0cc6086ab6987cb2bf47141b2288a,180.55
bf372d35de99f49cb07c1a238d7db256,26.08
12ea47b284521261ac272de65bbb3506,375.74
4ed6dff46316b8f7e80d1972f27ca39f,33.13
b755c5f04fe5e214d68445fb210d512a,142.04000000000002
810923268bc2be268d447dd5c892a5ce,348.77
ffc2f51857cae8a61ec9f9a15c7861c8,77.77
8978d77f12a2fc5b1890c49b39dd288a,26.68
4304f16b63cae276cb72b52baeb978cf,50.09
d4fcd56a6eb869293c5da42565707dd9,89.88
9a6fb2784ae4acd6acca8b15eae329e3,48.22
ee2de94f683ada4fc7ff42ddc0482a08,67.58
bbf02c631b2d633a8532316e697e71b4,69.33
f68313aa890cb1f32ea402439c6f1c4d,106.96
b7f69471fed8a036911323fca290a2c2,132.51
76382f6496effe36685eb200ef95b3ac,50.8
7c6a9e2bdbb00e3007395f1ce3bda802,402.42
ef82ec18f684c8b9f44339a739570043,57.53
a086fa78ca272b05a6404f91bb04928c,186.72

2025-01-21 14:41:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:09 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:10 - root - INFO - SQL:
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   LIMIT 100;
Results:
customer_id,number_of_orders
9ef432eb6251297304e76186b10a928d,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
41ce2a54c0b03bf3443c3d931a367089,1
f88197465ea7920adcdbec7375364d82,1
8ab97904e6daea8866dbdbc4fb7aad2c,1
503740e9ca751ccdda7ba28e9ab8f608,1
ed0271e0b7da060a393796590e7b737a,1
9bdf08b4b3b52b5526ff42d37d47f222,1
f54a9f0e6b351c431402b8461ea51999,1
31ad1d1b63eb9962463f764d4e6e0c9d,1
494dded5b201313c64ed7f100595b95c,1
7711cf624183d843aafe81855097bc37,1
d3e3b74c766bc6214e0c830b17ee2341,1
19402a48fe860416adf93348aba37740,1
3b6828a50ffe546942b7a473d70ac0fc,1
3187789bec990987628d7a9beb4dd6ac,1
059f7fc5719c7da6cbafe370971a8d70,1
d2b091571da224a1b36412c18bc3bbfe,1
4fa1cd166fa598be6de80fa84eaade43,1
72ae281627a6102d9b3718528b420f8a,1
a166da34890074091a942054b36e4265,1
8b212b9525f9e74e85e37ed6df37693e,1
52142aa69d8d0e1247ab0cada0f76023,1
816f8653d5361cbf94e58c33f2502a5c,1
cf8ffeddf027932e51e4eae73b384059,1
f5458ddc3545711efa883dd7ae7c4497,1
295ae9b35379e077273387ff64354b6f,1
2a1dfb647f32f4390e7b857c67458536,1
3391c4bc11a817e7973e498b0b023158,1
8644be24d48806bc3a88fd59fb47ceb1,1
caded193e8e47b8362864762a83db3c5,1
12fd2740039676063a874b9567dfa651,1
9b18f3fc296990b97854e351334a32f6,1
67407057a7d5ee17d1cd09523f484d13,1
81e08b08e5ed4472008030d70327c71f,1
be8c14c16a4d47194ccdfe10f1fc5b1a,1
55e6b290205c84ddd23ddf5eb134efd4,1
636e15840ab051faa13d3f781b6e4233,1
9f6618c17568ac301465fe7ad056c674,1
df9b032b2ad0fd6bf37dfb48e5f83845,1
48558a50a7ba1aab61891936d2ca7681,1
2e068340b3037f667ce3224bd59260af,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
e42998ccffc48dc87bf70b37e2d61f33,1
3a017955f82b5bf61bb51aec865a01ca,1
64d181ef52b1829800c598942459061b,1
738b086814c6fcc74b8cc583f8516ee3,1
3a874b4d4c4b6543206ff5d89287f0c3,1
7e20bf5ca92da68200643bda76c504c6,1
79183cd650e2bb0d475b0067d45946ac,1
684fa6da5134b9e4dab731e00011712d,1
b673f0597cb0c4d12778f731045f361a,1
82f0b75bb50fcb30711e5277e36b3983,1
167b9485947ed0a354a3f8dad04eb199,1
5883f965ac70043c2e908c3657c5d548,1
4dafe3c841d2d6cc8a8b6d25b35704b9,1
c1ddb7521d14db9071dccad0a94305c2,1
0dd5a932b1e29daa12845dbf696cbb54,1
8458f7ae02bda5950ce48c01a720559a,1
c178d6d544925594fafab0ba493cd645,1
9a80c8377644236e27f59e83862f1ae2,1
15bea20cd005ed59d34db54c6b32ec98,1
d0e6cb83a3fc27f56be011b2941f54c6,1
c40c7807639289e3f1308ac6e5bc104f,1
3df704f53d3f1d4818840b34ec672a9f,1
cce89a605105b148387c52e286ac8335,1
148348ff65384b4249b762579532e248,1
f5afca14dfa9dc64251cf2b45c54c363,1
241e78de29b3090cfa1b5d73a8130c72,1
4632eb5a8f175f6fe020520ae0c678f3,1
c77ee2d8ba1614a4d489a44166894938,1
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1
a90391a47de936d56c66a5366cba1462,1
05e996469a2bf9559c7122b87e156724,1
f26a435864aebedff7f7c84f82ee229f,1
bf141bf67fbe428d558bcf0e018eab60,1
3a897024068ed42a183de61d5727d866,1
332df68ccac2f2f7d9e11299188f8bce,1
d4faa220408c20e53595d2950f361f3b,1
65ee4aa816cda8ad41e05c75e1cb691e,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
62b423aab58096ca514ba6aa06be2f98,1
456dc10730fbdba34615447ea195d643,1
d9ef95f98d8da3b492bb8c0447910498,1
5f16605299d698660e0606f7eae2d2f9,1
ddaff536587109b89777e0353215e150,1
c7340080e394356141681bd4c9b8fe31,1
756fb9391752dad934e0fe3733378e57,1
4f28355e5c17a4a42d3ce2439a1d4501,1
7f2178c5d771e17f507d3c1637339298,1
f178c1827f67a8467b0385b7378d951a,1
2932d241d1f31e6df6c701d52370ae02,1
911e4c37f5cafe1604fe6767034bf1ae,1
9916715c2ab6ee1710c9c32f0a534ad2,1
afb19a4b667cb708caab312757ec3d3f,1
fee181bf648906d1c57f84f216976286,1
93ada7a24817edda9f4ab998fa823d16,1
64fb950e760ec8b0db79154a1fa9c1bf,1
8628fac2267e8c8804525da99c10ed0e,1
3135962ee745ef39b85576df7ddbaa99,1

2025-01-21 14:41:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:11 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:12 - root - INFO - SQL:
SELECT o."customer_id", AVG(t."total_payment_per_order") AS "average_payment_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN (
     SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
     FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     GROUP BY p."order_id"
   ) t ON o."order_id" = t."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,average_payment_per_order
b0830fb4747a6c6d20dea0b8c802d7ef,141.46
8ab97904e6daea8866dbdbc4fb7aad2c,28.62
ed0271e0b7da060a393796590e7b737a,65.95
f54a9f0e6b351c431402b8461ea51999,35.95
494dded5b201313c64ed7f100595b95c,259.06
d3e3b74c766bc6214e0c830b17ee2341,50.13
19402a48fe860416adf93348aba37740,32.7
3b6828a50ffe546942b7a473d70ac0fc,146.45
62b423aab58096ca514ba6aa06be2f98,104.11
3a874b4d4c4b6543206ff5d89287f0c3,125.43
456dc10730fbdba34615447ea195d643,313.19
816f8653d5361cbf94e58c33f2502a5c,63.1
c622b892a190735ef81c0087973fa16d,117.77
dd854e24b40e3bc2b306946dee252015,253.4
0a11cb0fb65032da800b780afcc1a1b7,180.95
059f7fc5719c7da6cbafe370971a8d70,29.75
c7340080e394356141681bd4c9b8fe31,356.12
f26a435864aebedff7f7c84f82ee229f,27.77
0489975a325480c9e385e9f135bb13c3,170.43
5883f965ac70043c2e908c3657c5d548,67.5
819b0aa9b717f6d78c0f72211bafebe3,109.35
aa3d8c9eec8e52e90b117efe5e97a560,74.16
2528510465c7572dedee4431a7d52e08,110.89
738b086814c6fcc74b8cc583f8516ee3,1376.45
d9ef95f98d8da3b492bb8c0447910498,100.25
81e08b08e5ed4472008030d70327c71f,346.09
bf141bf67fbe428d558bcf0e018eab60,66.98
86ff82570097f39b2193254f540e4a69,161.3
52142aa69d8d0e1247ab0cada0f76023,224.9
569cf68214806a39acc0f39344aea67f,54.82
fee181bf648906d1c57f84f216976286,574.36
d2a79636084590b7465af8ab374a8cf5,50.35
2d8748fb35d51c2fd273ee67fff78b7a,75.18
684fa6da5134b9e4dab731e00011712d,91.68
df9b032b2ad0fd6bf37dfb48e5f83845,29.92
f3f0e613e0bdb9c7cee75504f0f90679,138.28
9e3a06f863456c3934b9d26037c119cd,59.85
0fc25a3451d81cfe409466e229afdbb0,103.55
cae507afa38570ca8b08ae0cbcadd5d5,403.32
0385c03f2b10a0a50ee72d8e3649a4b3,143.32
1224a9f43655b57c469ab096e6ba5dc2,241.74
69d8d9775287ba592a957eba2211d351,198.12
957f8e082185574de25992dc659ebbc0,299.84
eec909ab0da04f0d3e92f898c6994d37,109.31
500f22fc596ab5a23d2e5ce64ee64859,378.83
6772a0a230a2667d16c3620f000e1348,63.34
d19f254a07da73a055409256e9bfe40a,314.34
aa601b3c45980c0918042d5ca7a25054,58.28
f5618502bee8eafdee72fb6955e2ebdf,57.0
4c9c7c2b6de6ee2568681b5599bb7495,84.57
5e320e6a4f03e2e74bc22e1158237fbe,305.7
caecab08cac2be52d89f87462765b4f4,216.93
271f76c70ce217ee656713b99097eaef,75.1
a9c6cd6cf9583fa5820d55c21238f78e,55.56
3cc640f13134a74f3bc34b9b0094d412,116.34
5d6e19aed6284c2fcb4b1a0eba6820de,143.94
e20e5dab42cf2fc3a11d1c89e087122b,96.02
3c14bd3e2287a1b895bc9af622d3f79a,137.38
e20b5cad78dd8fc3006244b5397d5a0f,67.6
e8515276707fdd0900308f2cbde32131,110.42
ab4e4f11610404b4184fb812e47bb0ed,112.77
9438adb7579bb0133f0173f39f85ae01,31.75
355971cbe54e13e55beb25fab74f6988,59.1
0005aefbb696d34b3424dccd0a0e9fd0,147.33
d2b091571da224a1b36412c18bc3bbfe,118.86
f5afca14dfa9dc64251cf2b45c54c363,386.33
a166da34890074091a942054b36e4265,187.57
f5458ddc3545711efa883dd7ae7c4497,66.79
148ecba880f508ca2d5b6744b6a7b6c5,165.4
65ee4aa816cda8ad41e05c75e1cb691e,26.44
df5c9e02596851fcbfc98804e4108bbd,106.38
c77ee2d8ba1614a4d489a44166894938,43.0
b896b244963dc7543d400ad82d6710e0,28.62
2e068340b3037f667ce3224bd59260af,95.52
cf9e2b07f78cce347089900f49fb4746,98.16
cce89a605105b148387c52e286ac8335,192.68
caded193e8e47b8362864762a83db3c5,22.36
79183cd650e2bb0d475b0067d45946ac,151.04
241e78de29b3090cfa1b5d73a8130c72,141.15
dd5095632e3953fc0947b8ab5176b0be,53.66
9a4900710ff76d73cb3a0d152e73adf0,554.4
15bea20cd005ed59d34db54c6b32ec98,117.45
13fd7ce9f08449dec2533119379a2527,393.46
3f7d26944f7f68bd2ac23b5e8b500ab0,89.88
5232c22d7ed2b631db6b2cab74b2c5f2,83.05
5a771152dd93d31af819d708942afec6,121.68
6dbe3c4683c66130a8e242bf4bb218d9,46.0
5cff2efe34e8e604619520cc86201235,59.47
79c102ed4db4e20845856cd68660f8f6,91.18
d4c5a2a1316f738e72e179d6bb3b6d8f,102.56
abbfa19a38ba17ff02883ba523a9d42f,30.96
86acfb656743da0c113d176832c9d535,132.05
3e8da88b70b67f67a05f66a138bd7f14,56.78
4d493a5e3a53373d3bc26a01575a71dc,150.21
6b74fa3521fe75edbeff9948022f13d1,110.98
6ca4c791dfb84fbc05cbe68d7d7a95be,155.29
b80feb27fb4955a21bca55fdb039af17,89.88
85aa7dc7ea24c96b5ac7864f13922495,141.06
c572fd6cdd98e87ea2bc433b6da21078,64.74
f7398fc942c8fa80e5419ae52e49f7fb,56.86

2025-01-21 14:41:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:13 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:14 - root - INFO - SQL:
SELECT o."customer_id",
      CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
        ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
      END AS "lifespan_in_weeks"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    GROUP BY o."customer_id"
    LIMIT 100;
Results:
customer_id,lifespan_in_weeks
9ef432eb6251297304e76186b10a928d,1.0
b0830fb4747a6c6d20dea0b8c802d7ef,1.0
41ce2a54c0b03bf3443c3d931a367089,1.0
f88197465ea7920adcdbec7375364d82,1.0
8ab97904e6daea8866dbdbc4fb7aad2c,1.0
503740e9ca751ccdda7ba28e9ab8f608,1.0
ed0271e0b7da060a393796590e7b737a,1.0
9bdf08b4b3b52b5526ff42d37d47f222,1.0
f54a9f0e6b351c431402b8461ea51999,1.0
31ad1d1b63eb9962463f764d4e6e0c9d,1.0
494dded5b201313c64ed7f100595b95c,1.0
7711cf624183d843aafe81855097bc37,1.0
d3e3b74c766bc6214e0c830b17ee2341,1.0
19402a48fe860416adf93348aba37740,1.0
3b6828a50ffe546942b7a473d70ac0fc,1.0
3187789bec990987628d7a9beb4dd6ac,1.0
059f7fc5719c7da6cbafe370971a8d70,1.0
d2b091571da224a1b36412c18bc3bbfe,1.0
4fa1cd166fa598be6de80fa84eaade43,1.0
72ae281627a6102d9b3718528b420f8a,1.0
a166da34890074091a942054b36e4265,1.0
8b212b9525f9e74e85e37ed6df37693e,1.0
52142aa69d8d0e1247ab0cada0f76023,1.0
816f8653d5361cbf94e58c33f2502a5c,1.0
cf8ffeddf027932e51e4eae73b384059,1.0
f5458ddc3545711efa883dd7ae7c4497,1.0
295ae9b35379e077273387ff64354b6f,1.0
2a1dfb647f32f4390e7b857c67458536,1.0
3391c4bc11a817e7973e498b0b023158,1.0
8644be24d48806bc3a88fd59fb47ceb1,1.0
caded193e8e47b8362864762a83db3c5,1.0
12fd2740039676063a874b9567dfa651,1.0
9b18f3fc296990b97854e351334a32f6,1.0
67407057a7d5ee17d1cd09523f484d13,1.0
81e08b08e5ed4472008030d70327c71f,1.0
be8c14c16a4d47194ccdfe10f1fc5b1a,1.0
55e6b290205c84ddd23ddf5eb134efd4,1.0
636e15840ab051faa13d3f781b6e4233,1.0
9f6618c17568ac301465fe7ad056c674,1.0
df9b032b2ad0fd6bf37dfb48e5f83845,1.0
48558a50a7ba1aab61891936d2ca7681,1.0
2e068340b3037f667ce3224bd59260af,1.0
6feea03756fd7ef4fb37d8f7e44aaeb9,1.0
e42998ccffc48dc87bf70b37e2d61f33,1.0
3a017955f82b5bf61bb51aec865a01ca,1.0
64d181ef52b1829800c598942459061b,1.0
738b086814c6fcc74b8cc583f8516ee3,1.0
3a874b4d4c4b6543206ff5d89287f0c3,1.0
7e20bf5ca92da68200643bda76c504c6,1.0
79183cd650e2bb0d475b0067d45946ac,1.0
684fa6da5134b9e4dab731e00011712d,1.0
b673f0597cb0c4d12778f731045f361a,1.0
82f0b75bb50fcb30711e5277e36b3983,1.0
167b9485947ed0a354a3f8dad04eb199,1.0
5883f965ac70043c2e908c3657c5d548,1.0
4dafe3c841d2d6cc8a8b6d25b35704b9,1.0
c1ddb7521d14db9071dccad0a94305c2,1.0
0dd5a932b1e29daa12845dbf696cbb54,1.0
8458f7ae02bda5950ce48c01a720559a,1.0
c178d6d544925594fafab0ba493cd645,1.0
9a80c8377644236e27f59e83862f1ae2,1.0
15bea20cd005ed59d34db54c6b32ec98,1.0
d0e6cb83a3fc27f56be011b2941f54c6,1.0
3df704f53d3f1d4818840b34ec672a9f,1.0
cce89a605105b148387c52e286ac8335,1.0
148348ff65384b4249b762579532e248,1.0
f5afca14dfa9dc64251cf2b45c54c363,1.0
241e78de29b3090cfa1b5d73a8130c72,1.0
4632eb5a8f175f6fe020520ae0c678f3,1.0
c77ee2d8ba1614a4d489a44166894938,1.0
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1.0
a90391a47de936d56c66a5366cba1462,1.0
05e996469a2bf9559c7122b87e156724,1.0
f26a435864aebedff7f7c84f82ee229f,1.0
bf141bf67fbe428d558bcf0e018eab60,1.0
3a897024068ed42a183de61d5727d866,1.0
332df68ccac2f2f7d9e11299188f8bce,1.0
d4faa220408c20e53595d2950f361f3b,1.0
65ee4aa816cda8ad41e05c75e1cb691e,1.0
7f8c8b9c2ae27bf3300f670c3d478be8,1.0
62b423aab58096ca514ba6aa06be2f98,1.0
456dc10730fbdba34615447ea195d643,1.0
d9ef95f98d8da3b492bb8c0447910498,1.0
5f16605299d698660e0606f7eae2d2f9,1.0
ddaff536587109b89777e0353215e150,1.0
c7340080e394356141681bd4c9b8fe31,1.0
756fb9391752dad934e0fe3733378e57,1.0
4f28355e5c17a4a42d3ce2439a1d4501,1.0
7f2178c5d771e17f507d3c1637339298,1.0
f178c1827f67a8467b0385b7378d951a,1.0
2932d241d1f31e6df6c701d52370ae02,1.0
911e4c37f5cafe1604fe6767034bf1ae,1.0
9916715c2ab6ee1710c9c32f0a534ad2,1.0
afb19a4b667cb708caab312757ec3d3f,1.0
fee181bf648906d1c57f84f216976286,1.0
93ada7a24817edda9f4ab998fa823d16,1.0
64fb950e760ec8b0db79154a1fa9c1bf,1.0
8628fac2267e8c8804525da99c10ed0e,1.0
3135962ee745ef39b85576df7ddbaa99,1.0
1833a0540067becaf59368fe4cd4303a,1.0

2025-01-21 14:41:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:15 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:15 - root - INFO - SQL:
SELECT o."customer_id",
      COUNT(DISTINCT o."order_id") AS "number_of_orders",
      AVG(t."total_payment_per_order") AS "average_payment_per_order",
      CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
        ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
      END AS "lifespan_in_weeks"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
19402a48fe860416adf93348aba37740,1,32.7,1.0
059f7fc5719c7da6cbafe370971a8d70,1,29.75,1.0
569cf68214806a39acc0f39344aea67f,1,54.82,1.0
684fa6da5134b9e4dab731e00011712d,1,91.68,1.0
241e78de29b3090cfa1b5d73a8130c72,1,141.15,1.0
a166da34890074091a942054b36e4265,1,187.57,1.0
62b423aab58096ca514ba6aa06be2f98,1,104.11,1.0
3a874b4d4c4b6543206ff5d89287f0c3,1,125.43,1.0
52142aa69d8d0e1247ab0cada0f76023,1,224.9,1.0
816f8653d5361cbf94e58c33f2502a5c,1,63.1,1.0
a90391a47de936d56c66a5366cba1462,1,84.56,1.0
05e996469a2bf9559c7122b87e156724,1,234.28,1.0
f3f0e613e0bdb9c7cee75504f0f90679,1,138.28,1.0
d19f254a07da73a055409256e9bfe40a,1,314.34,1.0
a207382f0f563c1f430ef732ade9d9ff,1,139.17,1.0
bf141bf67fbe428d558bcf0e018eab60,1,66.98,1.0
a78b75a2ad06180de06b82857ca442b3,1,66.02,1.0
2528510465c7572dedee4431a7d52e08,1,110.89,1.0
9e5ce657315b2bdb94033a494041ac25,1,139.8,1.0
f5618502bee8eafdee72fb6955e2ebdf,1,57.0,1.0
4fd75fb5ef1f01c7585bf746092a1544,1,51.79,1.0
977275bd3cd425aa9926a3388658f485,1,363.96,1.0
a8f76d9cb0f8db57cbbfe8d67b257893,1,72.05,1.0
2569d6c5ed547bf0feaf37e32677fdaa,1,1727.67,1.0
d7c4d8b45b0a33ff6df7a3950800d4e8,1,140.67,1.0
3b6828a50ffe546942b7a473d70ac0fc,1,146.45,1.0
d2b091571da224a1b36412c18bc3bbfe,1,118.86,1.0
9e3a06f863456c3934b9d26037c119cd,1,59.85,1.0
22eb8142d6313bab19fa6c657170ae6b,1,145.5,1.0
3a897024068ed42a183de61d5727d866,1,37.38,1.0
f5458ddc3545711efa883dd7ae7c4497,1,66.79,1.0
df9b032b2ad0fd6bf37dfb48e5f83845,1,29.92,1.0
df5c9e02596851fcbfc98804e4108bbd,1,106.38,1.0
79c102ed4db4e20845856cd68660f8f6,1,91.18,1.0
caecab08cac2be52d89f87462765b4f4,1,216.93,1.0
69d8d9775287ba592a957eba2211d351,1,198.12,1.0
0fc25a3451d81cfe409466e229afdbb0,1,103.55,1.0
58ffe52cbd8077e75af00321bd152ce2,1,419.12,1.0
24c63a7108d652ad0ed85589c4575297,1,52.92,1.0
2f9902d85fcd930227f711cf47012bdf,1,301.3,1.0
7c5f8c2e42af586aa1b1cc8d6bc40732,1,88.37,1.0
8563b07a84656ff32968702daa37c468,1,42.1,1.0
da82d24c21654f951fedc813df8a5dc6,1,137.04,1.0
c5827b73d67d474d76a268f0dda54396,1,54.33,1.0
355971cbe54e13e55beb25fab74f6988,1,59.1,1.0
a2f475be29f915fa902863f62308df8f,1,85.24,1.0
1bc91f030639254f22bf57fba7c51376,1,73.79,1.0
b8db3ed2d28a258de61b1db21e042868,1,38.09,1.0
cf9e2b07f78cce347089900f49fb4746,1,98.16,1.0
45c9fcdb0cd88a5630cb4405c4d2e4a7,1,338.0,1.0
cae507afa38570ca8b08ae0cbcadd5d5,1,403.32,1.0
05535d34af5324aaf6988e1d890a0d6e,1,76.67,1.0
19c6be9e0d7588d54ad848d44abeae95,1,34.0,1.0
18ad705482141f60ad05945506ef2b9e,1,90.88,1.0
be64f74b2773efd8d765f8417b65d276,1,172.42,1.0
f3223fd3b2517fa73ebb06dd5f1b0e99,1,44.1,1.0
aa0a85e355a784775696142c2f29aa48,1,48.79,1.0
940526d0df4938d234d0a900268106c4,1,138.03,1.0
0473034ec8cbbdc1db543b6c3615c625,1,183.89,1.0
b2859fd419788314d84da3852630e56a,1,72.25,1.0
0308cb020fb67d56a42bf1296f77dfce,1,128.09,1.0
59e64c4606d914bfa86bcf280f16bfeb,1,210.29,1.0
aff70ffc7417c17ae1c223c119d2a4d7,1,63.42,1.0
0f0603d577f299ca129f39109268c546,1,157.99,1.0
81e08b08e5ed4472008030d70327c71f,1,346.09,1.0
65ee4aa816cda8ad41e05c75e1cb691e,1,26.44,1.0
c77ee2d8ba1614a4d489a44166894938,1,43.0,1.0
0a11cb0fb65032da800b780afcc1a1b7,1,180.95,1.0
032f25110f17bb0d65268257b10738bc,1,32.69,1.0
a9c6cd6cf9583fa5820d55c21238f78e,1,55.56,1.0
6729078b4efa4371e61e6ec7df327846,1,73.34,1.0
5e320e6a4f03e2e74bc22e1158237fbe,1,305.7,1.0
0385c03f2b10a0a50ee72d8e3649a4b3,1,143.32,1.0
229c98245e2b6995b67be1e1921e62d1,1,27.98,1.0
dd854e24b40e3bc2b306946dee252015,1,253.4,1.0
0489975a325480c9e385e9f135bb13c3,1,170.43,1.0
d9ef95f98d8da3b492bb8c0447910498,1,100.25,1.0
c572fd6cdd98e87ea2bc433b6da21078,1,64.74,1.0
6dbe3c4683c66130a8e242bf4bb218d9,1,46.0,1.0
5a771152dd93d31af819d708942afec6,1,121.68,1.0
7203eb38fea2b4a15dd6c39575314aa4,1,320.18,1.0
4d493a5e3a53373d3bc26a01575a71dc,1,150.21,1.0
f31eb05ebdef1ede72cebeba759e7c92,1,189.34,1.0
6b74fa3521fe75edbeff9948022f13d1,1,110.98,1.0
5ad934ace4646e3dad70148a823eb138,1,50.86,1.0
4a00f00d951c167739888a1f16c56e8e,1,49.239999999999995,1.0
18c934f4cdc994cd04eb13bce3f47a18,1,188.94,1.0
77dccd21b005b20fc1f1418c979ca354,1,112.86,1.0
19bacb562bd43bd4eaf05b6c0a59dad0,1,73.25,1.0
9ea999ddb251e229b1c8b4925884743e,1,42.69,1.0
cb633030180d869d7bb76aa783a78b6d,1,220.04,1.0
147f69d3f50f2d2bc3797f20fe452ab2,1,37.54,1.0
2fdffca8dcdf01547529d45f7f4e8e8f,1,122.42,1.0
0324667bb97f2048e83f77d282a75fb4,1,139.69,1.0
6c347ef65dd574fb9c2d654c3650fc43,1,223.54,1.0
a13d2d3b615e7782205484d9c603cbe7,1,92.64,1.0
2ca8b7b3830f1551de4a0e4ea27a5e39,1,69.41,1.0
d43f72374abc7601531c7c806e7af444,1,38.96,1.0
7181fcde3f0ce4dc47a9d1c64ed15b3b,1,158.51,1.0
5b79686b44ff3de0d593d16b9e98484e,1,29.83,1.0

2025-01-21 14:41:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:17 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:18 - root - INFO - SQL:
SELECT o."customer_id",
      AVG(t."total_payment_per_order") AS "average_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    GROUP BY o."customer_id"
    ORDER BY "average_payment_per_order" DESC
    LIMIT 100;
Results:
customer_id,average_payment_per_order
1617b1357756262bfa56ab541c47bc16,13664.08
ec5b2ba62e574342386871631fafd3fc,7274.88
c6e2731c5b391845f6800c97401a43a9,6929.31
f48d464a0baaea338cb25f816991ab1f,6922.21
3fd6777bbce08a352fddd04e4a7cc8f6,6726.66
05455dfa7cd02f13d132aa7a6a9729c6,6081.54
df55c14d1476a9a3467f131269c2477f,4950.34
e0a2412720e9ea4f26c1ac985f6a7358,4809.44
24bbf5fd2f2e1b359ee7de94defc4a15,4764.34
3d979689f636322c62418b6346b1c6d2,4681.78
1afc82cd60e303ef09b4ef9837c9505c,4513.32
cc803a2c412833101651d3f90ca7de24,4445.5
926b6a6fb8b6081e00b335edaf578d35,4194.76
35a413c7ca3c69756cb75867d6311c0d,4175.26
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4163.51
3be2c536886b2ea4668eced3a80dd0bb,4042.74
eb7a157e8da9c488cd4ddc48711f1097,4034.44
c6695e3b1e48680db36b487419fb0398,4016.91
31e83c01fce824d0ff786fcd48dad009,3979.55
addc91fdf9c2b3045497b57fc710e820,3826.8
19b32919fa1198aefc0773ee2e46e693,3792.59
58acc4e2788bf6fc445fddcce9c1db03,3782.19
66657bf1753d82d0a76f2c4719ab8b85,3736.22
7d03bf20fa96e80468bbf678eebbcb3f,3666.42
39d6658037b1b5a07d0a24d423f0bd19,3602.47
e7c905bf4bb13543e8df947af4f3d9e9,3526.46
3c7c62e8d38fb18a33a45db8021f2d69,3406.47
0b16ce67087d02bf833c807e82b1992b,3358.24
803cd9b04f9cd252c6a83a2ecdbc22c3,3351.35
46bb3c0b1a65c8399d0363cefbcc4f37,3297.3999999999996
a7ea318cbe9df2ec79ab37cd7ca2135d,3256.14
f7622098214b4634b7fe7eee269b5426,3242.84
7e7d2271d6f55b03b0bd4615c5f2de6e,3209.72
71901689c5f3e5adc27b1dd16b33f0b8,3195.73
c26acf0451e0f8ec1f5218731b9a51cf,3184.55
040d94f8ba8ca26014bd6f7e8a6e0c0d,3184.34
25dbbf0c477fd4ae0880aaffbb12e8b3,3184.34
26dcb450c4b5b390e79e6d5d0f2c6535,3184.34
a95f4bbcf95262b073e4afa481b59ff8,3155.82
0a209a88c2e3dc2981c79ad85c558059,3126.5
10a86619816f9d2afce3f45b04aabc71,3126.5
6152fbfc8a92ee25fd821740bd33b089,3122.72
c03dfaf5db49d8583edbb5627f92058d,3076.13
4312e816d88fa8bdb6246878f61cdad5,3048.27
3a4e4932f3e6976dd966f1d3c044d49e,3044.12
d7c94e22bfd332eb29b0f5badc3ce103,3042.36
8dd4c93bfbebe2a77657d46ef959a7ac,3041.73
fd78e5e3abdc375368456fe738694c00,3024.08
1ff773612ab8934db89fd5afa8afe506,3018.6
101c8d91278c4de9001566d27033f673,3016.01
9d4ba8752b5b737f45da0544b669552a,3009.53
a8f345f82667eb421151dc7626147636,3005.06
a5c69c3bf293d341b6a56a4b7307c529,2960.05
a244afc7a1ec53f1aad296d1cd6e91ba,2938.17
f41666558f4e35056a445c27c2ac3d8b,2913.47
ed583a2a1eaf0dedc33af816153e8b8c,2844.96
9f9717a71bd8f6e5600b4faad20c20fb,2838.22
55fd5d10a5036383fe19af015d2e5a80,2828.42
1be0dd2f660a5a04ee20d608075f1b83,2827.0
fced842c7dad61e8ce47b49229659718,2818.74
8e2c57611e09e143ec4ab76e38033bef,2794.5
97dd9c6923b3237b650f1f4f3f2145ad,2787.87
8401401a8752eb431189e021b8009e37,2784.16
e5df9583ddbe3f4f3857d9b667dfa609,2759.95
5f87c05477db2d22c63b718299c9c03e,2759.88
3f083b9f62e687be8d84684c7d54c8db,2751.24
08dc68ad9ab343289844fa36f6963b8f,2734.66
19365ad6a18ccf1baf6eb71c30651096,2734.11
695476b5848d64ba0875324c88390206,2733.63
2e0339ff984d6f41f11dfdbc7c93dcda,2732.06
f2c743697f9b2ff2902df23a16582d80,2713.36
f08306b95370e8d5f0d97b71229284b6,2713.36
3690e975641f01bd07ad635f03dbb894,2692.82
b177ef267a4377b77e0620d1a7f08dce,2681.29
b1c28f9b72d07054b64d09e487b5021c,2681.29
279ca766397588e704abddd56d2dc131,2647.76
7e95832184f874c220b8ebffa750837d,2638.64
1ca6f90a61cf75c002a0d690261a0e4c,2627.09
0c5292f5e3690805390efddf53935915,2626.07
349509b216bd5ec11c5fae929fd13595,2621.29
1fb8ff22dad231d26fc7ecde2e2dc27a,2616.0
53e644c7c57416bdaf0409e656ee8b0a,2607.09
e9859fbdff7d26c36c228cf60796e844,2606.01
9c5d7103954595e173781530b10d02e4,2590.61
35698a7b9ae42369b9f45a53000f85f3,2574.38
03a6f3a3935165f5d26f4797ba6039bb,2566.9
9537f2addba8448428a3fd1a1add0656,2564.65
3696afd6fae4a1f36fcbc3db8f3d6640,2512.53
cb3724d7cb7db46b65cfd1e7c16c0df5,2487.24
6361b9f3b85d41860bfa28292e052bde,2480.58
233d97d412c7f4bb8d857ec922c0317f,2467.33
b9da524b08224eaff1bf76ef4d4299ac,2467.17
68f692d1f39843a16d9319a7306b6b10,2457.44
548692bdcbd6e3683ff306ac9d8418d6,2455.12
cdecc5d1f7fc375b1138e8b5f496fd69,2452.12
177ba55869da8001fcca079af0b85832,2438.51
b76816b61d8043a98db57875437da6b5,2429.68
2b7ae7a532ff538ce88f6bfdd2cb564c,2419.2
30ab7e538292e6130a456c371778d595,2416.0
d791834a0555c0062e98d735083f4373,2404.72

2025-01-21 14:41:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:19 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:19 - root - INFO - SQL:
SELECT o."customer_id",
      MIN(TO_TIMESTAMP(o."order_purchase_timestamp")) AS "first_order_date",
      MAX(TO_TIMESTAMP(o."order_purchase_timestamp")) AS "last_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    GROUP BY o."customer_id"
    LIMIT 100;
Results:
Too long, hard cut:
customer_id,first_order_date,last_order_date
9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,2017-10-02 10:56:33
b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,2018-07-24 20:41:37
41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,2018-08-08 08:38:49
f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,2017-11-18 19:28:06
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,2017-04-11 12:22:08
9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,2017-05-16 13:10:30
f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,2017-01-23 18:29:09
31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,2017-07-29 11:55:02
494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,2017-05-16 19:41:10
7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11,2017-07-13 19:58:11
d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,2018-06-07 10:06:19
19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,2018-07-25 17:44:10
3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,2018-06-07 19:03:12
3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,2017-12-26 23:41:31
059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,2017-11-21 00:03:41
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,2017-09-18 14:31:30
4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,2018-03-15 08:52:40
72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,2018-02-03 20:37:35
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26,2018-03-12 01:50:26
52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39,2018-04-16 21:15:39
816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,2017-12-12 13:56:04
cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,2018-07-29 23:34:51
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12,2018-02-21 18:15:12
295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,2017-07-31 21:37:10
2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13,2018-06-01 12:23:13
3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,2018-03-26 17:12:18
8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,2017-08-04 17:10:39
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,2018-05-17 16:59:11
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52,2018-06-11 10:25:52
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
55e6b290205c84ddd23ddf5eb134efd4,2018-04-13 08:44:17,2018-04-13 08:44:17
636e15840ab051faa13d3f781b6e4233,2018-07-28 16:52:55,2018-07-28 16:52:55
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50,2017-10-16 14:56:50
df9b032b2ad0fd6bf37dfb48e5f83845,2017-08-26 16:53:30,2017-08-26 16:53:30
48558a50a7ba1aab61891936d2ca7681,2018-01-22 19:22:22,2018-01-22 19:22:22
2e068340b3037f667ce3224bd59260af,2017-10-19 15:08:48,2017-10-19 15:08:48
6feea03756fd7ef4fb37d8f7e44aaeb9,2018-02-06 18:25:39,2018-02-06 18:25:39
e42998ccffc48dc87bf70b37e2d61f33,2018-06-08 12:19:58,2018-06-08 12:19:58
3a017955f82b5bf61bb51aec865a01ca,2018-06-01 11:26:06,2018-06-01 11:26:06
64d181ef52b1829800c598942459061b,2018-05-09 14:32:09,2018-05-09 14:32:09
738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,2018-01-02 19:00:43
3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53,2018-02-20 23:46:53
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59,2018-07-26 14:39:59
684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15,2018-03-09 14:50:15
b673f0597cb0c4d12778f731045f361a,2017-05-09 20:48:59,2017-05-09 20:48:59
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18,2018-04-22 23:23:18
167b9485947ed0a354a3f8dad04eb199,2018-07-05 18:40:47,2018-07-05 18:40:47
5883f965ac70043c2e908c3657c5d548,2017-12-21 17:43:41,2017-12-21 17:43:41
4dafe3c841d2d6cc8a8b6d25b35704b9,2017-05-09 11:48:37,2017-05-09 11:48:37
c1ddb7521d14db9071dccad0a94305c2,2018-07-15 12:37:12,2018-07-15 12:37:12
0dd5a932b1e29daa12845dbf696cbb54,2018-06-03 18:24:33,2018-06-03 18:24:33
8458f7ae02bda5950ce48c01a720559a,2018-05-23 16:37:35,2018-05-23 16:37:35
c178d6d544925594fafab0ba493cd645,2018-08-08 21:11:25,2018-08-08 21:11:25
9a80c8377644236e27f59e83862f1ae2,2017-07-10 12:23:05,2017-07-10 12:23:05
15bea20cd005ed59d34db54c6b32ec98,2018-07-23 18:27:07,2018-07-23 18:27:07
d0e6cb83a3fc27f56be011b2941f54c6,2018-05-30 22:33:08,2018-05-30 22:33:08
3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,2018-03-01 14:14:28
cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38,2018-05-02 11:45:38
148348ff65384b4249b762579532e248,2018-06-26 13:42:52,2018-06-26 13:42:52
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26,2017-06-13 

2025-01-21 14:41:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 14:41:21 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:21 - root - INFO - SQL:
SELECT COUNT(DISTINCT "customer_id") AS "total_customers"
    FROM E_COMMERCE.E_COMMERCE.CUSTOMERS;
Results:
total_customers
99441

2025-01-21 14:41:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:22 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:23 - root - INFO - SQL:
SELECT o."order_id", t."total_payment_per_order", o."order_purchase_timestamp"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    LIMIT 100;
Results:
Too long, hard cut:
order_id,total_payment_per_order,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,38.71,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,141.46,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,179.12,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,72.2,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,28.62,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,175.26,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,65.95,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,75.16,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,35.95,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,169.76,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,259.06,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,114.13,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,50.13,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,32.7,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,54.36,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,146.45,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,1376.45,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,43.09,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,29.75,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,92.97,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,118.86,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,88.9,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,17.28,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,187.57,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,104.11,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,125.43,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,227.68,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,60.69,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,192.68,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,63.34,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,313.19,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,224.9,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,63.1,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,100.25,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,188.41,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,106.95,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,66.79,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,43.0,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,508.17,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,49.69,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,154.19,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,356.12,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,95.67,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,121.62,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,22.36,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,153.72,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,54.82,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,82.33,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,52.24,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,130.56,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,52.84,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,71.91,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,151.04,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,386.33,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,50.25,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,128.68,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,43.46,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,91.68,2018-03-09 14:50:15
a685d016c8a26f71a0bb67821070e398,99.26,2017-03-13 18:14:36
2edfd6d1f0b4cd0db4bf37b1b224d855,141.15,2017-06-13 21:11:26
68873cf91053cd11e6b49a766db5af1a,91.66,2017-11-30 22:02:15
f346ad4ee8f630e5e4ddaf862a34e6dd,53.66,2018-08-05 13:09:48
8f06cc6465925031568537b815f1198d,317.34,2017-11-15 11:31:41
ccbabeb0b02433bd0fcbac46e70339f2,43.0,2018-02-19 20:31:09
688052146432ef8253587b930b01a06d,346.09,2018-04-22 08:48:13
f271576bed568e896f99eb710cd3a6f8,824.76,2018-01-07 21:44:54
686541986ecfb7d9296eb67719973bf0,39.99,2018-02-10 13:26:59
68e48e68da1f50f7c5838ea75e3a20dd,392.6,2018-06-18 16:02:23
b52cc4919de82b4d696a4380d10804a3,55.02,2018-06-13 13:47:39
fdf128b3630c21adc9ca4fb8a51b68ec,46.2,2018-07-15 08:33:19
a6aeb116d2cb5013eb8a94585b71ffef,59.34,2017-09-13 14:27:11
fa516182d28f96f5f5c651026b0749ee,209.41,2018-04-13 08:44:17
6abaad69b8b349c3a529b4b91ce18e46,57.0,2018-02-15 10:33:30
974c1993ab8024d3ed16229183c2308d,84.56,2017-02-20 11:45:39
82bce245b1c9148f8d19a55b9ff70644,267.8,2017-04-20 17:15:46
a910f58086d58b3ae6f37aa712d377b9,145.66,2017-09-15 09:19:48
bd4bd0194d6d29f83b8557d4b89b572a,37.83,2018-07-28 16:52:55
634e8f4c0f6744a626f77f39770ac6aa,234.28,2017-08-09 18:32:47
6d25592267349b322799e2beb687871e,201.82,2018-08-26 22:04:34
b8801cccd8068de30112e4f49903d74a,27.77,2017-07-30 03:06:35
2711a938db643b3f0b62ee2c8a2784aa,59.1,2017-12-22 00:17:37
3bc77ce8be27211bac313c2daa402d1a,66.98,2017-04-06 22:39:29
10c320f977c6a18f91b2d14be13128c6,132.26,2017-05-09 20:48:59
0a4a2fccb27bd83a8

2025-01-21 14:41:23 - root - INFO - itercount: 0
2025-01-21 14:41:23 - root - INFO - Database Name: E_COMMERCE
Schema Name: E_COMMERCE
DDL describes table information.
,0
table_name,LEADS_QUALIFIED
description,
DDL,"create or replace TABLE LEADS_QUALIFIED (
	""mql_id"" VARCHAR(16777216),
	""first_contact_date"" VARCHAR(16777216),
	""landing_page_id"" VARCHAR(16777216),
	""origin"" VARCHAR(16777216)
);"

,1
table_name,GEOLOCATION
description,
DDL,"create or replace TABLE GEOLOCATION (
	""geolocation_zip_code_prefix"" NUMBER(38,0),
	""geolocation_lat"" FLOAT,
	""geolocation_lng"" FLOAT,
	""geolocation_city"" VARCHAR(16777216),
	""geolocation_state"" VARCHAR(16777216)
);"

,2
table_name,LEADS_CLOSED
description,
DDL,"create or replace TABLE LEADS_CLOSED (
	""mql_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""sdr_id"" VARCHAR(16777216),
	""sr_id"" VARCHAR(16777216),
	""won_date"" VARCHAR(16777216),
	""business_segment"" VARCHAR(16777216),
	""lead_type"" VARCHAR(16777216),
	""lead_behaviour_profile"" VARCHAR(16777216),
	""has_company"" FLOAT,
	""has_gtin"" FLOAT,
	""average_stock"" VARCHAR(16777216),
	""business_type"" VARCHAR(16777216),
	""declared_product_catalog_size"" FLOAT,
	""declared_monthly_revenue"" FLOAT
);"

,3
table_name,ORDER_ITEMS
description,
DDL,"create or replace TABLE ORDER_ITEMS (
	""order_id"" VARCHAR(16777216),
	""order_item_id"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""shipping_limit_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""freight_value"" FLOAT
);"

,4
table_name,SELLERS
description,
DDL,"create or replace TABLE SELLERS (
	""seller_id"" VARCHAR(16777216),
	""seller_zip_code_prefix"" NUMBER(38,0),
	""seller_city"" VARCHAR(16777216),
	""seller_state"" VARCHAR(16777216)
);"

,5
table_name,CUSTOMERS
description,
DDL,"create or replace TABLE CUSTOMERS (
	""customer_id"" VARCHAR(16777216),
	""customer_unique_id"" VARCHAR(16777216),
	""customer_zip_code_prefix"" NUMBER(38,0),
	""customer_city"" VARCHAR(16777216),
	""customer_state"" VARCHAR(16777216)
);"

,6
table_name,ORDER_REVIEWS
description,
DDL,"create or replace TABLE ORDER_REVIEWS (
	""review_id"" VARCHAR(16777216),
	""order_id"" VARCHAR(16777216),
	""review_score"" NUMBER(38,0),
	""review_comment_title"" VARCHAR(16777216),
	""review_comment_message"" VARCHAR(16777216),
	""review_creation_date"" VARCHAR(16777216),
	""review_answer_timestamp"" VARCHAR(16777216)
);"

,7
table_name,PRODUCTS
description,
DDL,"create or replace TABLE PRODUCTS (
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

,8
table_name,PRODUCT_CATEGORY_NAME_TRANSLATION
description,
DDL,"create or replace TABLE PRODUCT_CATEGORY_NAME_TRANSLATION (
	""product_category_name"" VARCHAR(16777216),
	""product_category_name_english"" VARCHAR(16777216)
);"

,9
table_name,ORDERS
description,
DDL,"create or replace TABLE ORDERS (
	""order_id"" VARCHAR(16777216),
	""customer_id"" VARCHAR(16777216),
	""order_status"" VARCHAR(16777216),
	""order_purchase_timestamp"" VARCHAR(16777216),
	""order_approved_at"" VARCHAR(16777216),
	""order_delivered_carrier_date"" VARCHAR(16777216),
	""order_delivered_customer_date"" VARCHAR(16777216),
	""order_estimated_delivery_date"" VARCHAR(16777216)
);"

,10
table_name,ORDER_PAYMENTS
description,
DDL,"create or replace TABLE ORDER_PAYMENTS (
	""order_id"" VARCHAR(16777216),
	""payment_sequential"" NUMBER(38,0),
	""payment_type"" VARCHAR(16777216),
	""payment_installments"" NUMBER(38,0),
	""payment_value"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'E_COMMERCE': {'E_COMMERCE': ['CUSTOMERS', 'GEOLOCATION', 'LEADS_CLOSED', 'LEADS_QUALIFIED', 'ORDERS', 'ORDER_ITEMS', 'ORDER_PAYMENTS', 'ORDER_REVIEWS', 'PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION', 'SELLERS']}}
Begin Exploring Related Columns
**Relevant tables and columns:**

- **Table:** `CUSTOMERS`
  - `"customer_id"`: Used to uniquely identify a customer and link to orders.

- **Table:** `ORDERS`
  - `"order_id"`: Unique identifier for each order.
  - `"customer_id"`: Associates orders with customers.
  - `"order_purchase_timestamp"`: Timestamp of when the order was purchased; used to calculate customer lifespan.

- **Table:** `ORDER_PAYMENTS`
  - `"order_id"`: Links payments to orders.
  - `"payment_value"`: Monetary value of each payment; used to calculate total and average payments.

**Conditions and operations that may be used:**

- **Joins:**
  - Join `ORDERS` and `CUSTOMERS` on `"customer_id"` to associate orders with customers.
  - Join `ORDERS` and `ORDER_PAYMENTS` on `"order_id"` to associate payments with orders.

- **Aggregations:**
  - **COUNT** the number of orders per customer.
  - **SUM** and **AVG** of `"payment_value"` to calculate total and average payments per customer.
  - **MIN** and **MAX** of `"order_purchase_timestamp"` to calculate the lifespan of customers.

- **Date Calculations:**
  - Convert `"order_purchase_timestamp"` from `VARCHAR` to `TIMESTAMP`.
  - Calculate the difference in weeks between the earliest and latest orders per customer.
  - Set lifespan to `1.0` if it is less than one week.

**SQL Queries:**

1. **Select all customer IDs:**

   ```sql
   SELECT "customer_id"
   FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
   LIMIT 100;
   ```

2. **Select all orders with their purchase timestamps:**

   ```sql
   SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   LIMIT 100;
   ```

3. **Select all payment records:**

   ```sql
   SELECT "order_id", "payment_value"
   FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
   LIMIT 100;
   ```

4. **Join orders with customers to get customer details for each order:**

   ```sql
   SELECT o."order_id", c."customer_id", o."order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.CUSTOMERS c
     ON o."customer_id" = c."customer_id"
   LIMIT 100;
   ```

5. **Join orders with payments to get payment details for each order:**

   ```sql
   SELECT o."order_id", o."customer_id", p."payment_value"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     ON o."order_id" = p."order_id"
   LIMIT 100;
   ```

6. **Calculate total payment per order:**

   ```sql
   SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
   GROUP BY p."order_id"
   LIMIT 100;
   ```

7. **Calculate total payment per customer:**

   ```sql
   SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

8. **Calculate the number of orders per customer:**

   ```sql
   SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   LIMIT 100;
   ```

9. **Calculate the average payment per order for each customer:**

   ```sql
   SELECT o."customer_id", AVG(t."total_payment_per_order") AS "average_payment_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN (
     SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
     FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     GROUP BY p."order_id"
   ) t ON o."order_id" = t."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

10. **Calculate the lifespan in weeks for each customer (minimum 1.0):**

    ```sql
    SELECT o."customer_id",
      CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
        ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
      END AS "lifespan_in_weeks"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

11. **Combine number of orders, average payment, and lifespan for each customer:**

    ```sql
    SELECT o."customer_id",
      COUNT(DISTINCT o."order_id") AS "number_of_orders",
      AVG(t."total_payment_per_order") AS "average_payment_per_order",
      CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
        ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
      END AS "lifespan_in_weeks"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

12. **Find the top customers by average payment per order:**

    ```sql
    SELECT o."customer_id",
      AVG(t."total_payment_per_order") AS "average_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    GROUP BY o."customer_id"
    ORDER BY "average_payment_per_order" DESC
    LIMIT 100;
    ```

13. **List customers with their first and last order dates:**

    ```sql
    SELECT o."customer_id",
      MIN(TO_TIMESTAMP(o."order_purchase_timestamp")) AS "first_order_date",
      MAX(TO_TIMESTAMP(o."order_purchase_timestamp")) AS "last_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

14. **Calculate the total number of unique customers:**

    ```sql
    SELECT COUNT(DISTINCT "customer_id") AS "total_customers"
    FROM E_COMMERCE.E_COMMERCE.CUSTOMERS;
    ```

15. **Display orders with their total payment and order date:**

    ```sql
    SELECT o."order_id", t."total_payment_per_order", o."order_purchase_timestamp"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    LIMIT 100;
    ```

These queries explore the necessary data to determine the number of orders, average payment per order, and customer lifespan in weeks. By analyzing these results, you can identify the top three customers with the highest average payment per order.Query:
SELECT "customer_id"
   FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
   LIMIT 100;
Answer:
customer_id
06b8999e2fba1a1fbc88172c00ba8bc7
18955e83d337fd6b2def6b18a428ac77
4e7b3e00288586ebd08712fdd0374a03
b2b6027bc5c5109e529d4dc6358b12c3
4f2d8ab171c80ec8364f7c12e35b23ad
879864dab9bc3047522c92c82e1212b8
fd826e7cf63160e536e0908c76c3f441
5e274e7a0c3809e14aba7ad5aae0d407
5adf08e34b2e993982a47070956c5c65
4b7139f34592b3a31687243a302fa75b
9fb35e4ed6f0a14a4977cd9aea4042bb
5aa9e4fdd4dfd20959cad2d772509598
b2d1536598b73a9abd18e0d75d92f0a3
eabebad39a88bb6f5b52376faec28612
1f1c7bf1c9b041b292af6c1c4470b753
206f3129c0e4d7d0b9550426023f0a08
a7c125a0a07b75146167b7f04a7f8e98
c5c61596a3b6bd0cee5766992c48a9a1
9b8ce803689b3562defaad4613ef426f
49d0ea0986edde72da777f15456a0ee0
154c4ded6991bdfa3cd249d11abf4130
690172ab319622688d3b4df42f676898
2938121a40a20953c43caa8c98787fcb
237098a64674ae89babdc426746260fc
cb721d7b4f271fd87011c4c83462c076
f681356046d9fde60e70c73a18d65ea2
167bd30a409e3e4127df5a9408ebd394
6e359a57a91f84095cc64e1b351aef8c
e0eea8f69a457b3f1fa246e44c9ebefd
e3109970a3fe8021d5ff82c577ce5606
261cb4f92498ca05d5bd1a327a261d9c
6f92779347724b67e44e3224f3b4cffd
2d5831cb2dff7cdefba62e950ae3dc7b
b2bed119388167a954382cca36c4777f
469634941c27cd844170935a3cf60b95
df0aa5b8586495e0ddf6b601122e43a1
41c8f4b570869791379a925899a6af8a
54f755c3fd2709231f9964a1430c5218
4c06b42fbf7b97ab10779cda5549cd1c
b6368ca0f56d4632f44d58ca431487b2
4a0e66fd30684aa1409cd1b66fec77cc
c168abb9077b7821adae01dc1f0886c5
a3b0fda37bae14cf754877bed475e80c
0ccd415657ae8a6cd1c71b00155a019e
c532a74a3ebf1bacce2e2bcce3783317
19cecb194f54e614b70d971306a9931b
f34a6e874087ec1f0e3dab9fdf659c5d
c132855c926907970dcf6f2bf0b33a24
df85b96ba2ce3e49bde101b1614f52ac
4d27341acd30a36bca39008ee9bb9050
d3b6830d18c7de943d1e707d1f061d40
79de53946db384e2d7a9bd131792ad17
a562ab1e728449e3461829dfe2e36f73
b64ed91eab98972150bdaf77ca921934
8247b5583327ab8be19f96e1fb82f77b
8fcaa9368903f3a9a28aeaff28c14638
a9b0d1c26105279e1b8edc63d06bd668
aa9f03ecd3728c9bd12e6d962c66c7cb
230c0d740401730c7197d16376893525
a905baa530258422594f1b05615bd225
4fa19f7da692e6bf9602aaad3c372eda
03f846ad03437d864a8d2a22976dcafe
de4e13fd7d6469c5ada77d0843c55e42
8276de07ef25225d412b8462d73f8664
cc32707d2e2f7c92ab449f9b28154809
a02f66c3af7b16eec19ddcd98b645fe3
26acee41e2f75689a5615892f06ea0bd
f64cdee66599119324ce57a97e43700d
7ab7a537b678b6dd73d825ff6ee7be9d
7300450cedf7e4c35c243c4a03c1e8a6
4c7241af24b5344cb01fe687643de4fe
97e126f19a6f04b3462619f36862bcd2
6d27a9361e591da38c87a5e70253f3f2
6810c3dc47f641181fcc7f73275c3d19
b514422efcf14bef34858a0829bef189
0aae2862f8eac77f10a34f44860720ac
6c9a5923526346cbc0bd7bbd92269c01
1b2cb35b19b40b61f953d32ea157b337
12d1b4294fef21016c9614eb31e55e15
f6529ffebe6b3440d45d89604a4239ac
8264e3518163dd09211870b24a5d741d
8392e3d4cfeec63f2a8bfea68bf1f91f
38d1cd89306128348ffdf4cc23f3a50a
91ec76836092bba85d11761078ed7bb5
f9dfa0a2934ffbb22e66924952548be8
5a3260cfde2a918b597dada7ddd247bb
ee3a81b2771fec5f9e982cdb1b3a4804
784c407781aa34749a388c9283782b56
3f6ede29d4c69cd3316d2035b6cec1fb
6bed27564bd99d78d09c1fac13da56fd
670254dd2e886ffe621b3831afb47d7d
f7cb015ff73be957ee6a30e2577742c5
ea2196dc456ba36fe4f6b81dca4867d4
09241c552e9fe2420997a6c535e9d408
e50a30de3c32f9406a7185f40ce6874d
f89c1a6b9c966869e441e55bc14acddc
23e96758fd640560e9b1fbcda90abfc4
369708cabd9831ea6fde670a3b602a92
5f8b4882b5a4ec7bf6d2107e6cd0cf29
ad6891a1937cb8723a2c08ba1ae59873
Query:
SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab
Query:
SELECT "order_id", "payment_value"
   FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
   LIMIT 100;
Answer:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27
Query:
SELECT o."order_id", c."customer_id", o."order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.CUSTOMERS c
     ON o."customer_id" = c."customer_id"
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
00e7ee1b050b8499577073aeb2a297a1,06b8999e2fba1a1fbc88172c00ba8bc7,2017-05-16 15:05:35
29150127e6685892b6eab3eec79f59c7,18955e83d337fd6b2def6b18a428ac77,2018-01-12 20:48:24
b2059ed67ce144a36e2aa97d2c9e9ad2,4e7b3e00288586ebd08712fdd0374a03,2018-05-19 16:07:45
951670f92359f4fe4a63112aa7306eba,b2b6027bc5c5109e529d4dc6358b12c3,2018-03-13 16:06:38
6b7d50bd145f6fc7f33cebabd7e49d0f,4f2d8ab171c80ec8364f7c12e35b23ad,2018-07-29 09:51:30
5741ea1f91b5fbab2bd2dc653a5b5099,879864dab9bc3047522c92c82e1212b8,2017-09-14 18:14:31
36e694cf4cbc2a4803200c35e84abdc4,fd826e7cf63160e536e0908c76c3f441,2018-02-19 14:38:35
1093c8304c7a003280dd34598194913d,5e274e7a0c3809e14aba7ad5aae0d407,2017-11-16 19:29:02
1ebeea841c590e86a14a0d7a48e7d062,5adf08e34b2e993982a47070956c5c65,2018-01-18 12:35:44
7433cbcc783205509d66a5260da5b574,4b7139f34592b3a31687243a302fa75b,2018-01-08 11:22:34
8428e578bb1cf839ae26a6b7615502b9,9fb35e4ed6f0a14a4977cd9aea4042bb,2017-11-27 17:23:20
f86c5ed7048ac10eb88ec21c00f71892,5aa9e4fdd4dfd20959cad2d772509598,2018-02-07 11:36:42
83d8f70418eefd96f37b483dff430305,b2d1536598b73a9abd18e0d75d92f0a3,2017-09-09 09:54:57
852d2f4d37773bcbc21c8e09a05a4ea5,eabebad39a88bb6f5b52376faec28612,2018-03-07 15:57:14
6c949e670b5d33dc8fb8ad25b6da4860,1f1c7bf1c9b041b292af6c1c4470b753,2018-04-01 18:59:31
eac76692452422620996fe5e1a7f8bb0,206f3129c0e4d7d0b9550426023f0a08,2018-01-29 20:32:08
72bab69c50432c6f94d8b50a5f84b69a,a7c125a0a07b75146167b7f04a7f8e98,2018-08-13 23:45:05
ec28553b12bef4b538e5d7454464a1c6,c5c61596a3b6bd0cee5766992c48a9a1,2018-06-18 13:34:21
17825f24877a9289214c301ae0c9424b,9b8ce803689b3562defaad4613ef426f,2017-05-11 13:48:47
ab797176e01c2fa3d13aa1fe3e63d9ee,49d0ea0986edde72da777f15456a0ee0,2017-11-01 21:54:10
830d8b3e6875ef6165ffc33219ab4fea,154c4ded6991bdfa3cd249d11abf4130,2017-08-13 10:03:36
aaff8afa47c8426e414a6d908a97713c,690172ab319622688d3b4df42f676898,2017-10-15 11:08:48
0198c71148c2e08c7c52b860f640fa4e,2938121a40a20953c43caa8c98787fcb,2018-05-08 06:34:07
eac4ffbe456464bdc3ce5f001b6439c5,237098a64674ae89babdc426746260fc,2017-04-14 11:24:56
6cdc131d3c28253cd03cd0fbc3d5f938,cb721d7b4f271fd87011c4c83462c076,2018-05-16 13:04:22
daf946e879dab6e7e6b3f968297c3fe3,f681356046d9fde60e70c73a18d65ea2,2018-02-09 13:46:04
d10eafa208521dc30796e6a26099b6a6,167bd30a409e3e4127df5a9408ebd394,2018-07-14 10:53:11
a8f5a2b22f55e0af45b300929d1fdc7d,6e359a57a91f84095cc64e1b351aef8c,2017-05-15 17:58:25
3a6d41a4fe7a8e841b7c8e4b77d4e301,e0eea8f69a457b3f1fa246e44c9ebefd,2017-11-24 11:29:52
0330631bdb2ec8c341f487ed9c22fc8b,e3109970a3fe8021d5ff82c577ce5606,2018-05-25 12:02:08
2904d3ae0064e840ffb4798ba4a12ae3,261cb4f92498ca05d5bd1a327a261d9c,2017-09-12 08:00:03
f3b96845efd71daecf6b331fb3a9f537,6f92779347724b67e44e3224f3b4cffd,2017-11-26 20:59:24
19c0c76962278b152cc44fc63ffd5e48,2d5831cb2dff7cdefba62e950ae3dc7b,2018-04-18 09:42:53
77b062be7c5bd21712905feb8e1cfeed,b2bed119388167a954382cca36c4777f,2017-06-14 18:31:54
a9119eb77d6200811953803a7b6539e1,469634941c27cd844170935a3cf60b95,2018-03-12 13:07:03
72bd19ef4fa285334b95bda01a3718c7,df0aa5b8586495e0ddf6b601122e43a1,2018-05-09 13:01:24
4ca8a781d1f4b13e966bf35cdc333f56,41c8f4b570869791379a925899a6af8a,2017-10-13 10:04:59
d4668cd8ef48b78df597195703c95da2,54f755c3fd2709231f9964a1430c5218,2017-08-10 13:01:54
997fd4b37386d10b57d4ac8cdec011a6,4c06b42fbf7b97ab10779cda5549cd1c,2018-07-08 09:59:19
47cb08d5bac6105ae32587814fca96ca,b6368ca0f56d4632f44d58ca431487b2,2018-02-11 14:07:45
42cebac003b40e6aa0b3e37b99d83c2f,4a0e66fd30684aa1409cd1b66fec77cc,2018-07-06 14:29:57
1bae3477022e0394ab9af1d25a242fd0,c168abb9077b7821adae01dc1f0886c5,2017-12-18 08:52:09
2dd604f5ec1bd2f58c14e9908c7df826,a3b0fda37bae14cf754877bed475e80c,2018-01-31 16:43:23
a74869096437cef33d04006e8480e0db,0ccd415657ae8a6cd1c71b00155a019e,2017-10-09 21:01:08
04a92860751dfe7ae41f71e1228ffd18,c532a74a3ebf1bacce2e2bcce3783317,2018-05-14 13:30:21
14282bc70be9bdda515182fb1ce62af4,19cecb194f54e614b70d971306a9931b,2018-04-18 14:18:09
6e98de3a85c84ead6689189b825d35b5,f34a6e874087ec1f0e3dab9fdf659c5d,2018-03-15 10:07:02
b5172d4a722c0ebb34c29bbbb7a3cb42,c132855c926907970dcf6f2bf0b33a24,2018-04-17 13:14:13
d13130a0433949ba242b2f0632fd49a2,df85b96ba2ce3e49bde101b1614f52ac,2017-11-26 11:43:57
38e2829123a2bd1cbe111564824d0abb,4d27341acd30a36bca39008ee9bb9050,2017-01-26 11:14:58
6b1fc7db81c9636bc79ef40baf9e8b29,d3b6830d18c7de943d1e707d1f061d40,2018-04-14 18:29:29
b95cae4001dc3efdaa739478cf9c92e4,79de53946db384e2d7a9bd131792ad17,2018-05-22 01:43:18
f13b9cfd03f5555ece664b0bec8d2bf8,a562ab1e728449e3461829dfe2e36f73,2018-01-29 21:53:47
d5691ee416fbe1f2d1b061319de61570,b64ed91eab98972150bdaf77ca921934,2018-05-11 06:47:44
a6917b5d71e0e9bc434e9228db8daeb2,8247b5583327ab8be19f96e1fb82f77b,2017-06-09 15:46:17
1a463c49e93ce429845e1d959122285d,8fcaa9368903f3a9a28aeaff28c14638,2018-02-03 08:14:02
c6ab8a5c6fbd3bf57e9ad8407d950cc6,a9b0d1c26105279e1b8edc63d06bd668,2018-01-29 11:04:44
07429f7601b56a66d1854c79a2f5c9e5,aa9f03ecd3728c9bd12
Query:
SELECT o."order_id", o."customer_id", p."payment_value"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     ON o."order_id" = p."order_id"
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,0a8556ac6be836b46b3e89920d59291c,99.33
a9810da82917af2d9aefd1278f1dcfa0,f2c7fc58a9de810828715166c672f10a,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,25b14b69de0b6e184ae6fe2755e478f9,65.71
ba78997921bbcdc1373bb41e913ab953,7a5d8efaaa1081f800628c30d2b0728f,107.78
42fdf880ba16b47b59251dd489d4441a,15fd6fb8f8312dbb4674e4518d6fa3b3,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,a24e6f72471e9dbafcb292bc318f4859,96.12
771ee386b001f06208a7419e4fc1bbd7,206c0fcc717333d169ff95933fb47341,81.16
3d7239c394a212faae122962df514ac7,4d7a9b8bba459dce09d1b8fa637a0cba,51.84
1f78449c87a54faf9e96e88ba1491fa9,68c9dafdf193586c290b19c71541357a,341.09
0573b5e23cbd798006520e1d5b4c6714,c4e17eff78176dfe3401f03db0346f85,51.95
d88e0d5fa41661ce03cf6cf336527646,fe0c5425832ac53c3be5cb4aea25b60f,188.73
2480f727e869fdeb397244a21b721b67,94967f1e8a9ea8ec6c7129f098f32155,141.9
616105c9352a9668c38303ad44e056cd,8c0b2ef9efb43af92d5c0afff70d33d9,75.78
cf95215a722f3ebf29e6bbab87a29e61,e2a8d07201639004b090670ce5efe355,102.66
769214176682788a92801d8907fa1b40,2b01b5fb8141bbb9fcdc853a0e26da83,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,041cd6848abb3d3ca45e83dc971488fd,157.45
61059985a6fc0ad64e95d9944caacdad,89bca1b7e71b59a7d206d9d1da65c1f6,132.04
79da3f5fe31ad1e454f06f95dc032ad5,7eefe1898dff66fa3b252fda68ff2ff2,98.94
8ac09207f415d55acff302df7d6a895c,2d8bf5f6862af587af2e0b085a04bf0d,244.15
b2349a3f20dfbeef62e7b31baa22f84b,0ff24a24edd69d8774270ac863c8e230,136.71
5a1f6d22f7dfb061ef29216b9af687a1,4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
4214cda550ece8ee66441f459dc33a8c,be4ecdb7c9401fd98ed01456634cfcb2,170.57
adfbf6c2a620196f9a3ec747491c72b7,5b670130533827957619dfe306899fdd,67.5
4d680edbaa7d3d9bed69532957368a03,1444f701e835b7d189637c10f5287e76,353.09
8cd68144cdb62dc0d60848cf8616d2a4,c03b40c7971bc52b3d018247891270c5,330.66
5cfd514482e22bc992e7693f0e3e8df7,519a8af813fe88578029697625439e8b,45.17
d0a945f85ba1074b60aac97ade7e240e,4a44c8f258b8780e1da133c1f1c39854,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,0dac2ac6dcbbda827846734c0dc2dde6,139.22
5d9c5817e278892b7498d90bfa28ade8,b583a7efe4522c8ce8942bd47f33d487,290.16
b69b9260e79a0da00e15f48de1bd2524,0b34456a261dcc179512d6652e8cb276,283.34
f45074ae38f2e01d9b854ec8d40362ff,d036487ffd91aa5b2f21e17f2bb83543,13.78
81cedc4d2132eb6f512354166e51b187,a8f6bb35d78515a1762eb626d52b6352,30.28
595f598849d89203c28d05d0fbf3f92e,cefab390926b6fc3de3ca94c82ebb1ba,26.58
f9d0ec2fa088ac583e1ccd15b6686073,2b9c9e251dbb2a2a768fd48fbf151e4c,89.68
e647bf617de735448a4ba54f8910393c,11440840f5653ebba13e919285c71389,65.09
b2bb080b6bc860118a246fd9b6fad6da,023042a5cd5724a563a100acb1cf89c9,173.84
23f10f509600c30cf2852f9dbdf28fc3,934b4fa2791f6e1db380d989180d20cc,103.49
f86f6472fa9f395d8d9a6751ca118afb,ce6d32fa00bbae809e07c14126e5fa6e,64.03
1dcf0c8cd36ffaf57784fbdc90079310,34955e04695a861e22cfc5600244118d,157.15
00d8d65b666158b633f96054d31af43b,5e98d1f8f0534c460557d71961a7f10a,130.88
cf30fe76d1505192acee1c6dccb15545,3692097ced25d93525a447a4276fcf2f,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,54845a8b81a2d3e5b77fa702300da942,117.74
32b1d8f3789a57f1f752e20ac7404b4c,ae12a474c8de7dd68097a884fa9049b4,56.6
c10d412026c4077b8e83acf0fea04eee,4e2311c6a3b9c353851097a679ede20a,266.16
56c3277583e16009c925fdf116df420f,c3d06eb8905fc0c39966b0a57ee7244c,31.38
0e0441786430b7cfcd0d91f822ea4c99,f1220b145cc86460b4276b9b3e23e57d,121.49
6ffb3f1686bceae3466facf7e02ce3fb,0bb18eb234e80c2f203cac31f9b03078,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,65f09de0b77ca07963fde8601c6be1fb,153.41
c0db7d31ace61fc360a3eaa34dd3457c,80c0276f1c674e7b026d5a39799afaa4,65.71
d574338f566ca28dd67820f48ec1f1d8,d0715495890791e60e858ffc2b414cf9,278.22
1807cc736321f14baa58ef39cf6e5989,381aee1e9f4b0395a780330fab335b03,91.66
e8977f709bbb0367f51b589e6325f991,b7f69471fed8a036911323fca290a2c2,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,b9d460d12c9b6c5c3a0d73541e11e5f5,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,15e65458c1de2332a93656f2272c808e,166.04
95442deb81a5d91c97c0df96b431634a,daddb546b42f656e57ba8a3cf71a309f,368.98
10af96a0689260134307879127ac1952,c06d0ca3bead2fb2c60abf7864f427c4,113.2
85eef2d342b0de363c45c1bc324729c5,e67261dd807f298949d63fa4b1262eb8,99.43
aa964845f1de8125410aea8b73e9e1ec,d990663a73af8129834fca277b4743ca,27.35
343348b1e29e9fa9e7b6ab1027f9177d,017395cf7b4c0be4fa72650f0a8184ed,43.77
ad4098a257676ea4d394fb3bbbf36ca3,878b45ad0fa20acbb5198b2e979fb442,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,fcc4ed69deb551648926eab09355a9c5,105.53
3ab4eea6776259ae8dfbabaeffece352,24d46169d90daaa687cbf122c3243df8,387.8
10d9871bed9fb8d0887d3b9022edd1ff,778d30bc8e6a57dac20217ae0838b95a,84.14
c108072ab31ec90a754129c171577f5f,a979b3cbd898fd8be91a290a667fd0d4,210.82
fc662bafa52d2ef16078f6f6141009d6,f3ab9ca7b6a450eaa47bdcb67175ee74,90.05
4217849b1ff18a9270fe048eabc4dc45,b64f25449ad728c879f193819537d54c,67.88
795c16acb4e3c30dfa5b6827727ef488,d2727dd889fb74cc0b8d40cfaba7a696,37.58
55e2d723733c45033e71cb4d44690234,32a68880c3edfc878276ca3ffb8c084d,89.63
947e9c6bfd83a06953c420ef92d3da6e,27372118
Query:
SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
   GROUP BY p."order_id"
   LIMIT 100;
Answer:
order_id,total_payment_per_order
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
769214176682788a92801d8907fa1b40,105.28
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
4d680edbaa7d3d9bed69532957368a03,353.09
5d9c5817e278892b7498d90bfa28ade8,290.16
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
f9d0ec2fa088ac583e1ccd15b6686073,89.68
23f10f509600c30cf2852f9dbdf28fc3,103.49
cf30fe76d1505192acee1c6dccb15545,47.72
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
1807cc736321f14baa58ef39cf6e5989,91.66
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
795c16acb4e3c30dfa5b6827727ef488,37.58
e3e9e3295f4e1512167c232a0aaae8a5,50.8
42f5954cda381bd032934ee38c453711,402.42
c9f23db8a1cb725df9bdb3383bd72b38,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
b19ca559688b49e8cf7f88c1aa3f0009,73.34
4a02e985c7239d866a632f07ed20d9c0,48.62
46ee6eaca194413758f200a6974b7e4d,71.99
a490a5d59a9bf4ef3334bfd7cf1dbdfc,17.78
c1b770015e27aaf2b475026989d04fe0,137.73
d087b8e096ca051f548e29b324272834,72.05
5cfd514482e22bc992e7693f0e3e8df7,710.5799999999999
f86f6472fa9f395d8d9a6751ca118afb,64.03
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
56c3277583e16009c925fdf116df420f,31.38
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
343348b1e29e9fa9e7b6ab1027f9177d,43.77
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
f8d323a2702fed37f0229965f7e9f8b3,51.14
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
96de2b7f7f3c401fbee3eef068376da6,32.15
f090de1b2ed9f4e251662cb31e3c7127,27.63
2ccde1e4676c20b9444e2bcbed36334c,134.56
68d7420c86be23f313c81a554320f986,121.88
a5f860aaf6a3c35399495aefe92d363f,75.75
55779fa8fe072d9f8c92d672154558f2,233.66
845af9472cc76e66fbf445931b511755,123.41
67c8c2016ddabf0059783eb44e921f99,68.54
332c6742772f2df936696b6512b10edb,143.25
27a7ac440630f9de788e4d66e72c6424,186.39
e6670c9089973cc68e5b90b7d1f4fec4,88.49
aa7c35fd606f4275e267e859c6a84d0f,26.68
3d7239c394a212faae122962df514ac7,51.84
cf95215a722f3ebf29e6bbab87a29e61,102.66
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
8cd68144cdb62dc0d60848cf8616d2a4,330.66
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
e647bf617de735448a4ba54f8910393c,65.09
aa964845f1de8125410aea8b73e9e1ec,27.35
ad4098a257676ea4d394fb3bbbf36ca3,68.49
4217849b1ff18a9270fe048eabc4dc45,67.88
55e2d723733c45033e71cb4d44690234,89.63
4c2e1a95586c815795a324d1599e7b5a,117.71
723e462ce1ee50e024887c0b403130f3,113.8
198298d54f269d8c5fe89e85a859af61,342.56
20f136d890c31a62486c809f91a5b098,117.68
cf61ad2218e5c14397e7c0ba7a6a50f9,35.14
99bc267f49d76932cd195bfb2a94dd03,163.08
aa600269bffea363cca75ad2d1908903,93.26
57e4fc8f20507381b3f7abbe4e2ccda3,215.56
ae1126b6891f58552443772c80b1f562,133.81
42fdf880ba16b47b59251dd489d4441a,128.45
adfbf6c2a620196f9a3ec747491c72b7,67.5
d0a945f85ba1074b60aac97ade7e240e,541.0
595f598849d89203c28d05d0fbf3f92e,26.58
b2bb080b6bc860118a246fd9b6fad6da,197.92000000000002
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
e8977f709bbb0367f51b589e6325f991,132.51
95442deb81a5d91c97c0df96b431634a,368.98
fc662bafa52d2ef16078f6f6141009d6,90.05
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
460d57443ffdcaeba240360239747cf7,34.0
4d3bfdf4c7d6578ea445d588371ae10e,77.29
8e47a04b25d7a7075064e8e0bd2e0318,37.61
Query:
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     ON o."order_id" = p."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,total_payment
0a8556ac6be836b46b3e89920d59291c,99.33
f2c7fc58a9de810828715166c672f10a,24.39
a24e6f72471e9dbafcb292bc318f4859,96.12
c4e17eff78176dfe3401f03db0346f85,51.95
94967f1e8a9ea8ec6c7129f098f32155,141.9
8c0b2ef9efb43af92d5c0afff70d33d9,75.78
2b01b5fb8141bbb9fcdc853a0e26da83,105.28
4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
be4ecdb7c9401fd98ed01456634cfcb2,170.57
5b670130533827957619dfe306899fdd,67.5
1444f701e835b7d189637c10f5287e76,353.09
c03b40c7971bc52b3d018247891270c5,330.66
d036487ffd91aa5b2f21e17f2bb83543,13.78
a8f6bb35d78515a1762eb626d52b6352,30.28
ce6d32fa00bbae809e07c14126e5fa6e,64.03
c3d06eb8905fc0c39966b0a57ee7244c,31.38
f1220b145cc86460b4276b9b3e23e57d,121.49
d990663a73af8129834fca277b4743ca,27.35
73e4f0d08b9eaf4009d3218057343b5a,78.3
31f9366e8fbe2412ddbae2d9c49d8adf,77.7
7badbcce7da90b7920997ddbac3187b5,77.29
b5d838521379fbc2a2e8c3f360f57e01,227.12
ff93b4413884cd9b2d851e9133d8c1ab,34.09
6de980369453bc98c75da669412a0e85,348.02
fe0c5425832ac53c3be5cb4aea25b60f,188.73
0ff24a24edd69d8774270ac863c8e230,136.71
b583a7efe4522c8ce8942bd47f33d487,290.16
11440840f5653ebba13e919285c71389,65.09
34955e04695a861e22cfc5600244118d,157.15
4e2311c6a3b9c353851097a679ede20a,266.16
15e65458c1de2332a93656f2272c808e,166.04
daddb546b42f656e57ba8a3cf71a309f,368.98
2737211835d5ea370af15ee145f7840c,69.46
2514a33b1704c36bdfbe51840e105cde,34.0
2d1276417ffab1c174139789098cecc3,77.1
2346308634084083a80df78332c411dc,48.68
8d4fd10d20cdc0fa3589cfdee2b1cb07,342.56
a97f15194f6fc81433e550a34dec906a,53.99
b78f37cd0654fbbf35c5277b24936535,56.77
eec30b788184a6d93954fd5e82c48add,32.15
e2bea5774e2c8aa227075fc4d2c3ba39,40.99
27a2735706788ec6d39d0de52ce2457b,71.99
0f687ed7edef79545319e147f39a290a,47.0
d49bac4ac7d77b956f2b185ab700fbf1,231.45
84e14521bff8cbb289a87be1961d3d08,144.2
ab2b94cec822788e131f15e0033544cf,27.63
a10c24a3a00d939852f086c7162e564d,134.56
a3343433090af3beb34febb7899bf0ee,96.98
b8fc2edd015cea8b8cd1f308c30541fd,267.05
54efba24ef631ff2c2088f8320499ea5,48.61
55d6fe64c9ff321e925f284f7e0d69d8,125.53
d50a8dc7e28e47e8119560e53b1c7deb,44.35
61260c512475ab1d7519b332199e8c1d,213.9
e957d597f76d275f40a848397fb6c7c3,362.17
ad5eaed951a10f80d09e7f473a8fd08e,103.79
4068269eb194e5957c5b2abce6939ee4,49.7
680e38a70d371582570f41cc47dc2791,285.79
b0c22a057e308ffdd32ce03e1734aa62,404.88
bf0b4acdb6eb69084a7714bf7cc748f0,54.85
3d3e7494fc24a4f50a6bff232428f8fe,44.83
f5025a3893cbcdd251b06c0b3f7451da,52.529999999999994
ae6a20cbef31289987c08cdc617a19ac,256.37
047c4f9e8ca120c41c8d4a61df722ea2,102.26
79bdc6288517cb7f94c86be6c97b7ba7,127.53
381aee1e9f4b0395a780330fab335b03,91.66
017395cf7b4c0be4fa72650f0a8184ed,43.77
1353b6db7e448ecfad1a4cd13b95f832,113.8
92f70647283582ec50ca1bb5794f6c90,107.72
58d45cf285d3d5bdd45609c696e00b9e,46.63
90cf9029b6b6b9469c7f0f9c82a59da3,52.21
519a8af813fe88578029697625439e8b,710.5799999999999
4a44c8f258b8780e1da133c1f1c39854,541.0
f9bdbea246da607ab4641959ba6aa32f,34.78
e46db370a98dec564da620109436f09a,117.68
bdbf22817eb36add4815586f4957adb1,88.49
8e5b95cc9167186235d12c22e7d79015,81.78
1387e2d23533abc24be58c9b3a1f06b9,17.78
c7ada2a2ca6ff94ccc7bbd16af1dec55,61.77
b7d2c0ccf5e66c2d1c496d6a8250eae4,31.0
58b3208913cae35dadfac41929721901,116.05
79e2cae59c2216c721c54ff9c53ad657,85.14
7ac0cc6086ab6987cb2bf47141b2288a,180.55
bf372d35de99f49cb07c1a238d7db256,26.08
12ea47b284521261ac272de65bbb3506,375.74
4ed6dff46316b8f7e80d1972f27ca39f,33.13
b755c5f04fe5e214d68445fb210d512a,142.04000000000002
810923268bc2be268d447dd5c892a5ce,348.77
ffc2f51857cae8a61ec9f9a15c7861c8,77.77
8978d77f12a2fc5b1890c49b39dd288a,26.68
4304f16b63cae276cb72b52baeb978cf,50.09
d4fcd56a6eb869293c5da42565707dd9,89.88
9a6fb2784ae4acd6acca8b15eae329e3,48.22
ee2de94f683ada4fc7ff42ddc0482a08,67.58
bbf02c631b2d633a8532316e697e71b4,69.33
f68313aa890cb1f32ea402439c6f1c4d,106.96
b7f69471fed8a036911323fca290a2c2,132.51
76382f6496effe36685eb200ef95b3ac,50.8
7c6a9e2bdbb00e3007395f1ce3bda802,402.42
ef82ec18f684c8b9f44339a739570043,57.53
a086fa78ca272b05a6404f91bb04928c,186.72
Query:
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
customer_id,number_of_orders
9ef432eb6251297304e76186b10a928d,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
41ce2a54c0b03bf3443c3d931a367089,1
f88197465ea7920adcdbec7375364d82,1
8ab97904e6daea8866dbdbc4fb7aad2c,1
503740e9ca751ccdda7ba28e9ab8f608,1
ed0271e0b7da060a393796590e7b737a,1
9bdf08b4b3b52b5526ff42d37d47f222,1
f54a9f0e6b351c431402b8461ea51999,1
31ad1d1b63eb9962463f764d4e6e0c9d,1
494dded5b201313c64ed7f100595b95c,1
7711cf624183d843aafe81855097bc37,1
d3e3b74c766bc6214e0c830b17ee2341,1
19402a48fe860416adf93348aba37740,1
3b6828a50ffe546942b7a473d70ac0fc,1
3187789bec990987628d7a9beb4dd6ac,1
059f7fc5719c7da6cbafe370971a8d70,1
d2b091571da224a1b36412c18bc3bbfe,1
4fa1cd166fa598be6de80fa84eaade43,1
72ae281627a6102d9b3718528b420f8a,1
a166da34890074091a942054b36e4265,1
8b212b9525f9e74e85e37ed6df37693e,1
52142aa69d8d0e1247ab0cada0f76023,1
816f8653d5361cbf94e58c33f2502a5c,1
cf8ffeddf027932e51e4eae73b384059,1
f5458ddc3545711efa883dd7ae7c4497,1
295ae9b35379e077273387ff64354b6f,1
2a1dfb647f32f4390e7b857c67458536,1
3391c4bc11a817e7973e498b0b023158,1
8644be24d48806bc3a88fd59fb47ceb1,1
caded193e8e47b8362864762a83db3c5,1
12fd2740039676063a874b9567dfa651,1
9b18f3fc296990b97854e351334a32f6,1
67407057a7d5ee17d1cd09523f484d13,1
81e08b08e5ed4472008030d70327c71f,1
be8c14c16a4d47194ccdfe10f1fc5b1a,1
55e6b290205c84ddd23ddf5eb134efd4,1
636e15840ab051faa13d3f781b6e4233,1
9f6618c17568ac301465fe7ad056c674,1
df9b032b2ad0fd6bf37dfb48e5f83845,1
48558a50a7ba1aab61891936d2ca7681,1
2e068340b3037f667ce3224bd59260af,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
e42998ccffc48dc87bf70b37e2d61f33,1
3a017955f82b5bf61bb51aec865a01ca,1
64d181ef52b1829800c598942459061b,1
738b086814c6fcc74b8cc583f8516ee3,1
3a874b4d4c4b6543206ff5d89287f0c3,1
7e20bf5ca92da68200643bda76c504c6,1
79183cd650e2bb0d475b0067d45946ac,1
684fa6da5134b9e4dab731e00011712d,1
b673f0597cb0c4d12778f731045f361a,1
82f0b75bb50fcb30711e5277e36b3983,1
167b9485947ed0a354a3f8dad04eb199,1
5883f965ac70043c2e908c3657c5d548,1
4dafe3c841d2d6cc8a8b6d25b35704b9,1
c1ddb7521d14db9071dccad0a94305c2,1
0dd5a932b1e29daa12845dbf696cbb54,1
8458f7ae02bda5950ce48c01a720559a,1
c178d6d544925594fafab0ba493cd645,1
9a80c8377644236e27f59e83862f1ae2,1
15bea20cd005ed59d34db54c6b32ec98,1
d0e6cb83a3fc27f56be011b2941f54c6,1
c40c7807639289e3f1308ac6e5bc104f,1
3df704f53d3f1d4818840b34ec672a9f,1
cce89a605105b148387c52e286ac8335,1
148348ff65384b4249b762579532e248,1
f5afca14dfa9dc64251cf2b45c54c363,1
241e78de29b3090cfa1b5d73a8130c72,1
4632eb5a8f175f6fe020520ae0c678f3,1
c77ee2d8ba1614a4d489a44166894938,1
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1
a90391a47de936d56c66a5366cba1462,1
05e996469a2bf9559c7122b87e156724,1
f26a435864aebedff7f7c84f82ee229f,1
bf141bf67fbe428d558bcf0e018eab60,1
3a897024068ed42a183de61d5727d866,1
332df68ccac2f2f7d9e11299188f8bce,1
d4faa220408c20e53595d2950f361f3b,1
65ee4aa816cda8ad41e05c75e1cb691e,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
62b423aab58096ca514ba6aa06be2f98,1
456dc10730fbdba34615447ea195d643,1
d9ef95f98d8da3b492bb8c0447910498,1
5f16605299d698660e0606f7eae2d2f9,1
ddaff536587109b89777e0353215e150,1
c7340080e394356141681bd4c9b8fe31,1
756fb9391752dad934e0fe3733378e57,1
4f28355e5c17a4a42d3ce2439a1d4501,1
7f2178c5d771e17f507d3c1637339298,1
f178c1827f67a8467b0385b7378d951a,1
2932d241d1f31e6df6c701d52370ae02,1
911e4c37f5cafe1604fe6767034bf1ae,1
9916715c2ab6ee1710c9c32f0a534ad2,1
afb19a4b667cb708caab312757ec3d3f,1
fee181bf648906d1c57f84f216976286,1
93ada7a24817edda9f4ab998fa823d16,1
64fb950e760ec8b0db79154a1fa9c1bf,1
8628fac2267e8c8804525da99c10ed0e,1
3135962ee745ef39b85576df7ddbaa99,1
Query:
SELECT o."customer_id", AVG(t."total_payment_per_order") AS "average_payment_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN (
     SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
     FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
     GROUP BY p."order_id"
   ) t ON o."order_id" = t."order_id"
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,average_payment_per_order
b0830fb4747a6c6d20dea0b8c802d7ef,141.46
8ab97904e6daea8866dbdbc4fb7aad2c,28.62
ed0271e0b7da060a393796590e7b737a,65.95
f54a9f0e6b351c431402b8461ea51999,35.95
494dded5b201313c64ed7f100595b95c,259.06
d3e3b74c766bc6214e0c830b17ee2341,50.13
19402a48fe860416adf93348aba37740,32.7
3b6828a50ffe546942b7a473d70ac0fc,146.45
62b423aab58096ca514ba6aa06be2f98,104.11
3a874b4d4c4b6543206ff5d89287f0c3,125.43
456dc10730fbdba34615447ea195d643,313.19
816f8653d5361cbf94e58c33f2502a5c,63.1
c622b892a190735ef81c0087973fa16d,117.77
dd854e24b40e3bc2b306946dee252015,253.4
0a11cb0fb65032da800b780afcc1a1b7,180.95
059f7fc5719c7da6cbafe370971a8d70,29.75
c7340080e394356141681bd4c9b8fe31,356.12
f26a435864aebedff7f7c84f82ee229f,27.77
0489975a325480c9e385e9f135bb13c3,170.43
5883f965ac70043c2e908c3657c5d548,67.5
819b0aa9b717f6d78c0f72211bafebe3,109.35
aa3d8c9eec8e52e90b117efe5e97a560,74.16
2528510465c7572dedee4431a7d52e08,110.89
738b086814c6fcc74b8cc583f8516ee3,1376.45
d9ef95f98d8da3b492bb8c0447910498,100.25
81e08b08e5ed4472008030d70327c71f,346.09
bf141bf67fbe428d558bcf0e018eab60,66.98
86ff82570097f39b2193254f540e4a69,161.3
52142aa69d8d0e1247ab0cada0f76023,224.9
569cf68214806a39acc0f39344aea67f,54.82
fee181bf648906d1c57f84f216976286,574.36
d2a79636084590b7465af8ab374a8cf5,50.35
2d8748fb35d51c2fd273ee67fff78b7a,75.18
684fa6da5134b9e4dab731e00011712d,91.68
df9b032b2ad0fd6bf37dfb48e5f83845,29.92
f3f0e613e0bdb9c7cee75504f0f90679,138.28
9e3a06f863456c3934b9d26037c119cd,59.85
0fc25a3451d81cfe409466e229afdbb0,103.55
cae507afa38570ca8b08ae0cbcadd5d5,403.32
0385c03f2b10a0a50ee72d8e3649a4b3,143.32
1224a9f43655b57c469ab096e6ba5dc2,241.74
69d8d9775287ba592a957eba2211d351,198.12
957f8e082185574de25992dc659ebbc0,299.84
eec909ab0da04f0d3e92f898c6994d37,109.31
500f22fc596ab5a23d2e5ce64ee64859,378.83
6772a0a230a2667d16c3620f000e1348,63.34
d19f254a07da73a055409256e9bfe40a,314.34
aa601b3c45980c0918042d5ca7a25054,58.28
f5618502bee8eafdee72fb6955e2ebdf,57.0
4c9c7c2b6de6ee2568681b5599bb7495,84.57
5e320e6a4f03e2e74bc22e1158237fbe,305.7
caecab08cac2be52d89f87462765b4f4,216.93
271f76c70ce217ee656713b99097eaef,75.1
a9c6cd6cf9583fa5820d55c21238f78e,55.56
3cc640f13134a74f3bc34b9b0094d412,116.34
5d6e19aed6284c2fcb4b1a0eba6820de,143.94
e20e5dab42cf2fc3a11d1c89e087122b,96.02
3c14bd3e2287a1b895bc9af622d3f79a,137.38
e20b5cad78dd8fc3006244b5397d5a0f,67.6
e8515276707fdd0900308f2cbde32131,110.42
ab4e4f11610404b4184fb812e47bb0ed,112.77
9438adb7579bb0133f0173f39f85ae01,31.75
355971cbe54e13e55beb25fab74f6988,59.1
0005aefbb696d34b3424dccd0a0e9fd0,147.33
d2b091571da224a1b36412c18bc3bbfe,118.86
f5afca14dfa9dc64251cf2b45c54c363,386.33
a166da34890074091a942054b36e4265,187.57
f5458ddc3545711efa883dd7ae7c4497,66.79
148ecba880f508ca2d5b6744b6a7b6c5,165.4
65ee4aa816cda8ad41e05c75e1cb691e,26.44
df5c9e02596851fcbfc98804e4108bbd,106.38
c77ee2d8ba1614a4d489a44166894938,43.0
b896b244963dc7543d400ad82d6710e0,28.62
2e068340b3037f667ce3224bd59260af,95.52
cf9e2b07f78cce347089900f49fb4746,98.16
cce89a605105b148387c52e286ac8335,192.68
caded193e8e47b8362864762a83db3c5,22.36
79183cd650e2bb0d475b0067d45946ac,151.04
241e78de29b3090cfa1b5d73a8130c72,141.15
dd5095632e3953fc0947b8ab5176b0be,53.66
9a4900710ff76d73cb3a0d152e73adf0,554.4
15bea20cd005ed59d34db54c6b32ec98,117.45
13fd7ce9f08449dec2533119379a2527,393.46
3f7d26944f7f68bd2ac23b5e8b500ab0,89.88
5232c22d7ed2b631db6b2cab74b2c5f2,83.05
5a771152dd93d31af819d708942afec6,121.68
6dbe3c4683c66130a8e242bf4bb218d9,46.0
5cff2efe34e8e604619520cc86201235,59.47
79c102ed4db4e20845856cd68660f8f6,91.18
d4c5a2a1316f738e72e179d6bb3b6d8f,102.56
abbfa19a38ba17ff02883ba523a9d42f,30.96
86acfb656743da0c113d176832c9d535,132.05
3e8da88b70b67f67a05f66a138bd7f14,56.78
4d493a5e3a53373d3bc26a01575a71dc,150.21
6b74fa3521fe75edbeff9948022f13d1,110.98
6ca4c791dfb84fbc05cbe68d7d7a95be,155.29
b80feb27fb4955a21bca55fdb039af17,89.88
85aa7dc7ea24c96b5ac7864f13922495,141.06
c572fd6cdd98e87ea2bc433b6da21078,64.74
f7398fc942c8fa80e5419ae52e49f7fb,56.86
Query:
SELECT o."customer_id",
      CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
        ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
      END AS "lifespan_in_weeks"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    GROUP BY o."customer_id"
    LIMIT 100;
Answer:
customer_id,lifespan_in_weeks
9ef432eb6251297304e76186b10a928d,1.0
b0830fb4747a6c6d20dea0b8c802d7ef,1.0
41ce2a54c0b03bf3443c3d931a367089,1.0
f88197465ea7920adcdbec7375364d82,1.0
8ab97904e6daea8866dbdbc4fb7aad2c,1.0
503740e9ca751ccdda7ba28e9ab8f608,1.0
ed0271e0b7da060a393796590e7b737a,1.0
9bdf08b4b3b52b5526ff42d37d47f222,1.0
f54a9f0e6b351c431402b8461ea51999,1.0
31ad1d1b63eb9962463f764d4e6e0c9d,1.0
494dded5b201313c64ed7f100595b95c,1.0
7711cf624183d843aafe81855097bc37,1.0
d3e3b74c766bc6214e0c830b17ee2341,1.0
19402a48fe860416adf93348aba37740,1.0
3b6828a50ffe546942b7a473d70ac0fc,1.0
3187789bec990987628d7a9beb4dd6ac,1.0
059f7fc5719c7da6cbafe370971a8d70,1.0
d2b091571da224a1b36412c18bc3bbfe,1.0
4fa1cd166fa598be6de80fa84eaade43,1.0
72ae281627a6102d9b3718528b420f8a,1.0
a166da34890074091a942054b36e4265,1.0
8b212b9525f9e74e85e37ed6df37693e,1.0
52142aa69d8d0e1247ab0cada0f76023,1.0
816f8653d5361cbf94e58c33f2502a5c,1.0
cf8ffeddf027932e51e4eae73b384059,1.0
f5458ddc3545711efa883dd7ae7c4497,1.0
295ae9b35379e077273387ff64354b6f,1.0
2a1dfb647f32f4390e7b857c67458536,1.0
3391c4bc11a817e7973e498b0b023158,1.0
8644be24d48806bc3a88fd59fb47ceb1,1.0
caded193e8e47b8362864762a83db3c5,1.0
12fd2740039676063a874b9567dfa651,1.0
9b18f3fc296990b97854e351334a32f6,1.0
67407057a7d5ee17d1cd09523f484d13,1.0
81e08b08e5ed4472008030d70327c71f,1.0
be8c14c16a4d47194ccdfe10f1fc5b1a,1.0
55e6b290205c84ddd23ddf5eb134efd4,1.0
636e15840ab051faa13d3f781b6e4233,1.0
9f6618c17568ac301465fe7ad056c674,1.0
df9b032b2ad0fd6bf37dfb48e5f83845,1.0
48558a50a7ba1aab61891936d2ca7681,1.0
2e068340b3037f667ce3224bd59260af,1.0
6feea03756fd7ef4fb37d8f7e44aaeb9,1.0
e42998ccffc48dc87bf70b37e2d61f33,1.0
3a017955f82b5bf61bb51aec865a01ca,1.0
64d181ef52b1829800c598942459061b,1.0
738b086814c6fcc74b8cc583f8516ee3,1.0
3a874b4d4c4b6543206ff5d89287f0c3,1.0
7e20bf5ca92da68200643bda76c504c6,1.0
79183cd650e2bb0d475b0067d45946ac,1.0
684fa6da5134b9e4dab731e00011712d,1.0
b673f0597cb0c4d12778f731045f361a,1.0
82f0b75bb50fcb30711e5277e36b3983,1.0
167b9485947ed0a354a3f8dad04eb199,1.0
5883f965ac70043c2e908c3657c5d548,1.0
4dafe3c841d2d6cc8a8b6d25b35704b9,1.0
c1ddb7521d14db9071dccad0a94305c2,1.0
0dd5a932b1e29daa12845dbf696cbb54,1.0
8458f7ae02bda5950ce48c01a720559a,1.0
c178d6d544925594fafab0ba493cd645,1.0
9a80c8377644236e27f59e83862f1ae2,1.0
15bea20cd005ed59d34db54c6b32ec98,1.0
d0e6cb83a3fc27f56be011b2941f54c6,1.0
3df704f53d3f1d4818840b34ec672a9f,1.0
cce89a605105b148387c52e286ac8335,1.0
148348ff65384b4249b762579532e248,1.0
f5afca14dfa9dc64251cf2b45c54c363,1.0
241e78de29b3090cfa1b5d73a8130c72,1.0
4632eb5a8f175f6fe020520ae0c678f3,1.0
c77ee2d8ba1614a4d489a44166894938,1.0
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1.0
a90391a47de936d56c66a5366cba1462,1.0
05e996469a2bf9559c7122b87e156724,1.0
f26a435864aebedff7f7c84f82ee229f,1.0
bf141bf67fbe428d558bcf0e018eab60,1.0
3a897024068ed42a183de61d5727d866,1.0
332df68ccac2f2f7d9e11299188f8bce,1.0
d4faa220408c20e53595d2950f361f3b,1.0
65ee4aa816cda8ad41e05c75e1cb691e,1.0
7f8c8b9c2ae27bf3300f670c3d478be8,1.0
62b423aab58096ca514ba6aa06be2f98,1.0
456dc10730fbdba34615447ea195d643,1.0
d9ef95f98d8da3b492bb8c0447910498,1.0
5f16605299d698660e0606f7eae2d2f9,1.0
ddaff536587109b89777e0353215e150,1.0
c7340080e394356141681bd4c9b8fe31,1.0
756fb9391752dad934e0fe3733378e57,1.0
4f28355e5c17a4a42d3ce2439a1d4501,1.0
7f2178c5d771e17f507d3c1637339298,1.0
f178c1827f67a8467b0385b7378d951a,1.0
2932d241d1f31e6df6c701d52370ae02,1.0
911e4c37f5cafe1604fe6767034bf1ae,1.0
9916715c2ab6ee1710c9c32f0a534ad2,1.0
afb19a4b667cb708caab312757ec3d3f,1.0
fee181bf648906d1c57f84f216976286,1.0
93ada7a24817edda9f4ab998fa823d16,1.0
64fb950e760ec8b0db79154a1fa9c1bf,1.0
8628fac2267e8c8804525da99c10ed0e,1.0
3135962ee745ef39b85576df7ddbaa99,1.0
1833a0540067becaf59368fe4cd4303a,1.0
Query:
SELECT o."customer_id",
      COUNT(DISTINCT o."order_id") AS "number_of_orders",
      AVG(t."total_payment_per_order") AS "average_payment_per_order",
      CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
        ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
      END AS "lifespan_in_weeks"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    GROUP BY o."customer_id"
    LIMIT 100;
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
19402a48fe860416adf93348aba37740,1,32.7,1.0
059f7fc5719c7da6cbafe370971a8d70,1,29.75,1.0
569cf68214806a39acc0f39344aea67f,1,54.82,1.0
684fa6da5134b9e4dab731e00011712d,1,91.68,1.0
241e78de29b3090cfa1b5d73a8130c72,1,141.15,1.0
a166da34890074091a942054b36e4265,1,187.57,1.0
62b423aab58096ca514ba6aa06be2f98,1,104.11,1.0
3a874b4d4c4b6543206ff5d89287f0c3,1,125.43,1.0
52142aa69d8d0e1247ab0cada0f76023,1,224.9,1.0
816f8653d5361cbf94e58c33f2502a5c,1,63.1,1.0
a90391a47de936d56c66a5366cba1462,1,84.56,1.0
05e996469a2bf9559c7122b87e156724,1,234.28,1.0
f3f0e613e0bdb9c7cee75504f0f90679,1,138.28,1.0
d19f254a07da73a055409256e9bfe40a,1,314.34,1.0
a207382f0f563c1f430ef732ade9d9ff,1,139.17,1.0
bf141bf67fbe428d558bcf0e018eab60,1,66.98,1.0
a78b75a2ad06180de06b82857ca442b3,1,66.02,1.0
2528510465c7572dedee4431a7d52e08,1,110.89,1.0
9e5ce657315b2bdb94033a494041ac25,1,139.8,1.0
f5618502bee8eafdee72fb6955e2ebdf,1,57.0,1.0
4fd75fb5ef1f01c7585bf746092a1544,1,51.79,1.0
977275bd3cd425aa9926a3388658f485,1,363.96,1.0
a8f76d9cb0f8db57cbbfe8d67b257893,1,72.05,1.0
2569d6c5ed547bf0feaf37e32677fdaa,1,1727.67,1.0
d7c4d8b45b0a33ff6df7a3950800d4e8,1,140.67,1.0
3b6828a50ffe546942b7a473d70ac0fc,1,146.45,1.0
d2b091571da224a1b36412c18bc3bbfe,1,118.86,1.0
9e3a06f863456c3934b9d26037c119cd,1,59.85,1.0
22eb8142d6313bab19fa6c657170ae6b,1,145.5,1.0
3a897024068ed42a183de61d5727d866,1,37.38,1.0
f5458ddc3545711efa883dd7ae7c4497,1,66.79,1.0
df9b032b2ad0fd6bf37dfb48e5f83845,1,29.92,1.0
df5c9e02596851fcbfc98804e4108bbd,1,106.38,1.0
79c102ed4db4e20845856cd68660f8f6,1,91.18,1.0
caecab08cac2be52d89f87462765b4f4,1,216.93,1.0
69d8d9775287ba592a957eba2211d351,1,198.12,1.0
0fc25a3451d81cfe409466e229afdbb0,1,103.55,1.0
58ffe52cbd8077e75af00321bd152ce2,1,419.12,1.0
24c63a7108d652ad0ed85589c4575297,1,52.92,1.0
2f9902d85fcd930227f711cf47012bdf,1,301.3,1.0
7c5f8c2e42af586aa1b1cc8d6bc40732,1,88.37,1.0
8563b07a84656ff32968702daa37c468,1,42.1,1.0
da82d24c21654f951fedc813df8a5dc6,1,137.04,1.0
c5827b73d67d474d76a268f0dda54396,1,54.33,1.0
355971cbe54e13e55beb25fab74f6988,1,59.1,1.0
a2f475be29f915fa902863f62308df8f,1,85.24,1.0
1bc91f030639254f22bf57fba7c51376,1,73.79,1.0
b8db3ed2d28a258de61b1db21e042868,1,38.09,1.0
cf9e2b07f78cce347089900f49fb4746,1,98.16,1.0
45c9fcdb0cd88a5630cb4405c4d2e4a7,1,338.0,1.0
cae507afa38570ca8b08ae0cbcadd5d5,1,403.32,1.0
05535d34af5324aaf6988e1d890a0d6e,1,76.67,1.0
19c6be9e0d7588d54ad848d44abeae95,1,34.0,1.0
18ad705482141f60ad05945506ef2b9e,1,90.88,1.0
be64f74b2773efd8d765f8417b65d276,1,172.42,1.0
f3223fd3b2517fa73ebb06dd5f1b0e99,1,44.1,1.0
aa0a85e355a784775696142c2f29aa48,1,48.79,1.0
940526d0df4938d234d0a900268106c4,1,138.03,1.0
0473034ec8cbbdc1db543b6c3615c625,1,183.89,1.0
b2859fd419788314d84da3852630e56a,1,72.25,1.0
0308cb020fb67d56a42bf1296f77dfce,1,128.09,1.0
59e64c4606d914bfa86bcf280f16bfeb,1,210.29,1.0
aff70ffc7417c17ae1c223c119d2a4d7,1,63.42,1.0
0f0603d577f299ca129f39109268c546,1,157.99,1.0
81e08b08e5ed4472008030d70327c71f,1,346.09,1.0
65ee4aa816cda8ad41e05c75e1cb691e,1,26.44,1.0
c77ee2d8ba1614a4d489a44166894938,1,43.0,1.0
0a11cb0fb65032da800b780afcc1a1b7,1,180.95,1.0
032f25110f17bb0d65268257b10738bc,1,32.69,1.0
a9c6cd6cf9583fa5820d55c21238f78e,1,55.56,1.0
6729078b4efa4371e61e6ec7df327846,1,73.34,1.0
5e320e6a4f03e2e74bc22e1158237fbe,1,305.7,1.0
0385c03f2b10a0a50ee72d8e3649a4b3,1,143.32,1.0
229c98245e2b6995b67be1e1921e62d1,1,27.98,1.0
dd854e24b40e3bc2b306946dee252015,1,253.4,1.0
0489975a325480c9e385e9f135bb13c3,1,170.43,1.0
d9ef95f98d8da3b492bb8c0447910498,1,100.25,1.0
c572fd6cdd98e87ea2bc433b6da21078,1,64.74,1.0
6dbe3c4683c66130a8e242bf4bb218d9,1,46.0,1.0
5a771152dd93d31af819d708942afec6,1,121.68,1.0
7203eb38fea2b4a15dd6c39575314aa4,1,320.18,1.0
4d493a5e3a53373d3bc26a01575a71dc,1,150.21,1.0
f31eb05ebdef1ede72cebeba759e7c92,1,189.34,1.0
6b74fa3521fe75edbeff9948022f13d1,1,110.98,1.0
5ad934ace4646e3dad70148a823eb138,1,50.86,1.0
4a00f00d951c167739888a1f16c56e8e,1,49.239999999999995,1.0
18c934f4cdc994cd04eb13bce3f47a18,1,188.94,1.0
77dccd21b005b20fc1f1418c979ca354,1,112.86,1.0
19bacb562bd43bd4eaf05b6c0a59dad0,1,73.25,1.0
9ea999ddb251e229b1c8b4925884743e,1,42.69,1.0
cb633030180d869d7bb76aa783a78b6d,1,220.04,1.0
147f69d3f50f2d2bc3797f20fe452ab2,1,37.54,1.0
2fdffca8dcdf01547529d45f7f4e8e8f,1,122.42,1.0
0324667bb97f2048e83f77d282a75fb4,1,139.69,1.0
6c347ef65dd574fb9c2d654c3650fc43,1,223.54,1.0
a13d2d3b615e7782205484d9c603cbe7,1,92.64,1.0
2ca8b7b3830f1551de4a0e4ea27a5e39,1,69.41,1.0
d43f72374abc7601531c7c806e7af444,1,38.96,1.0
7181fcde3f0ce4dc47a9d1c64ed15b3b,1,158.51,1.0
5b79686b44ff3de0d593d16b9e98484e,1,29.83,1.0
Query:
SELECT o."customer_id",
      AVG(t."total_payment_per_order") AS "average_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    GROUP BY o."customer_id"
    ORDER BY "average_payment_per_order" DESC
    LIMIT 100;
Answer:
customer_id,average_payment_per_order
1617b1357756262bfa56ab541c47bc16,13664.08
ec5b2ba62e574342386871631fafd3fc,7274.88
c6e2731c5b391845f6800c97401a43a9,6929.31
f48d464a0baaea338cb25f816991ab1f,6922.21
3fd6777bbce08a352fddd04e4a7cc8f6,6726.66
05455dfa7cd02f13d132aa7a6a9729c6,6081.54
df55c14d1476a9a3467f131269c2477f,4950.34
e0a2412720e9ea4f26c1ac985f6a7358,4809.44
24bbf5fd2f2e1b359ee7de94defc4a15,4764.34
3d979689f636322c62418b6346b1c6d2,4681.78
1afc82cd60e303ef09b4ef9837c9505c,4513.32
cc803a2c412833101651d3f90ca7de24,4445.5
926b6a6fb8b6081e00b335edaf578d35,4194.76
35a413c7ca3c69756cb75867d6311c0d,4175.26
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4163.51
3be2c536886b2ea4668eced3a80dd0bb,4042.74
eb7a157e8da9c488cd4ddc48711f1097,4034.44
c6695e3b1e48680db36b487419fb0398,4016.91
31e83c01fce824d0ff786fcd48dad009,3979.55
addc91fdf9c2b3045497b57fc710e820,3826.8
19b32919fa1198aefc0773ee2e46e693,3792.59
58acc4e2788bf6fc445fddcce9c1db03,3782.19
66657bf1753d82d0a76f2c4719ab8b85,3736.22
7d03bf20fa96e80468bbf678eebbcb3f,3666.42
39d6658037b1b5a07d0a24d423f0bd19,3602.47
e7c905bf4bb13543e8df947af4f3d9e9,3526.46
3c7c62e8d38fb18a33a45db8021f2d69,3406.47
0b16ce67087d02bf833c807e82b1992b,3358.24
803cd9b04f9cd252c6a83a2ecdbc22c3,3351.35
46bb3c0b1a65c8399d0363cefbcc4f37,3297.3999999999996
a7ea318cbe9df2ec79ab37cd7ca2135d,3256.14
f7622098214b4634b7fe7eee269b5426,3242.84
7e7d2271d6f55b03b0bd4615c5f2de6e,3209.72
71901689c5f3e5adc27b1dd16b33f0b8,3195.73
c26acf0451e0f8ec1f5218731b9a51cf,3184.55
040d94f8ba8ca26014bd6f7e8a6e0c0d,3184.34
25dbbf0c477fd4ae0880aaffbb12e8b3,3184.34
26dcb450c4b5b390e79e6d5d0f2c6535,3184.34
a95f4bbcf95262b073e4afa481b59ff8,3155.82
0a209a88c2e3dc2981c79ad85c558059,3126.5
10a86619816f9d2afce3f45b04aabc71,3126.5
6152fbfc8a92ee25fd821740bd33b089,3122.72
c03dfaf5db49d8583edbb5627f92058d,3076.13
4312e816d88fa8bdb6246878f61cdad5,3048.27
3a4e4932f3e6976dd966f1d3c044d49e,3044.12
d7c94e22bfd332eb29b0f5badc3ce103,3042.36
8dd4c93bfbebe2a77657d46ef959a7ac,3041.73
fd78e5e3abdc375368456fe738694c00,3024.08
1ff773612ab8934db89fd5afa8afe506,3018.6
101c8d91278c4de9001566d27033f673,3016.01
9d4ba8752b5b737f45da0544b669552a,3009.53
a8f345f82667eb421151dc7626147636,3005.06
a5c69c3bf293d341b6a56a4b7307c529,2960.05
a244afc7a1ec53f1aad296d1cd6e91ba,2938.17
f41666558f4e35056a445c27c2ac3d8b,2913.47
ed583a2a1eaf0dedc33af816153e8b8c,2844.96
9f9717a71bd8f6e5600b4faad20c20fb,2838.22
55fd5d10a5036383fe19af015d2e5a80,2828.42
1be0dd2f660a5a04ee20d608075f1b83,2827.0
fced842c7dad61e8ce47b49229659718,2818.74
8e2c57611e09e143ec4ab76e38033bef,2794.5
97dd9c6923b3237b650f1f4f3f2145ad,2787.87
8401401a8752eb431189e021b8009e37,2784.16
e5df9583ddbe3f4f3857d9b667dfa609,2759.95
5f87c05477db2d22c63b718299c9c03e,2759.88
3f083b9f62e687be8d84684c7d54c8db,2751.24
08dc68ad9ab343289844fa36f6963b8f,2734.66
19365ad6a18ccf1baf6eb71c30651096,2734.11
695476b5848d64ba0875324c88390206,2733.63
2e0339ff984d6f41f11dfdbc7c93dcda,2732.06
f2c743697f9b2ff2902df23a16582d80,2713.36
f08306b95370e8d5f0d97b71229284b6,2713.36
3690e975641f01bd07ad635f03dbb894,2692.82
b177ef267a4377b77e0620d1a7f08dce,2681.29
b1c28f9b72d07054b64d09e487b5021c,2681.29
279ca766397588e704abddd56d2dc131,2647.76
7e95832184f874c220b8ebffa750837d,2638.64
1ca6f90a61cf75c002a0d690261a0e4c,2627.09
0c5292f5e3690805390efddf53935915,2626.07
349509b216bd5ec11c5fae929fd13595,2621.29
1fb8ff22dad231d26fc7ecde2e2dc27a,2616.0
53e644c7c57416bdaf0409e656ee8b0a,2607.09
e9859fbdff7d26c36c228cf60796e844,2606.01
9c5d7103954595e173781530b10d02e4,2590.61
35698a7b9ae42369b9f45a53000f85f3,2574.38
03a6f3a3935165f5d26f4797ba6039bb,2566.9
9537f2addba8448428a3fd1a1add0656,2564.65
3696afd6fae4a1f36fcbc3db8f3d6640,2512.53
cb3724d7cb7db46b65cfd1e7c16c0df5,2487.24
6361b9f3b85d41860bfa28292e052bde,2480.58
233d97d412c7f4bb8d857ec922c0317f,2467.33
b9da524b08224eaff1bf76ef4d4299ac,2467.17
68f692d1f39843a16d9319a7306b6b10,2457.44
548692bdcbd6e3683ff306ac9d8418d6,2455.12
cdecc5d1f7fc375b1138e8b5f496fd69,2452.12
177ba55869da8001fcca079af0b85832,2438.51
b76816b61d8043a98db57875437da6b5,2429.68
2b7ae7a532ff538ce88f6bfdd2cb564c,2419.2
30ab7e538292e6130a456c371778d595,2416.0
d791834a0555c0062e98d735083f4373,2404.72
Query:
SELECT o."customer_id",
      MIN(TO_TIMESTAMP(o."order_purchase_timestamp")) AS "first_order_date",
      MAX(TO_TIMESTAMP(o."order_purchase_timestamp")) AS "last_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    GROUP BY o."customer_id"
    LIMIT 100;
Answer:
Too long, hard cut:
customer_id,first_order_date,last_order_date
9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,2017-10-02 10:56:33
b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,2018-07-24 20:41:37
41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,2018-08-08 08:38:49
f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,2017-11-18 19:28:06
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,2017-04-11 12:22:08
9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,2017-05-16 13:10:30
f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,2017-01-23 18:29:09
31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,2017-07-29 11:55:02
494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,2017-05-16 19:41:10
7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11,2017-07-13 19:58:11
d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,2018-06-07 10:06:19
19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,2018-07-25 17:44:10
3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,2018-06-07 19:03:12
3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,2017-12-26 23:41:31
059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,2017-11-21 00:03:41
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,2017-09-18 14:31:30
4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,2018-03-15 08:52:40
72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,2018-02-03 20:37:35
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26,2018-03-12 01:50:26
52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39,2018-04-16 21:15:39
816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,2017-12-12 13:56:04
cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,2018-07-29 23:34:51
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12,2018-02-21 18:15:12
295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,2017-07-31 21:37:10
2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13,2018-06-01 12:23:13
3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,2018-03-26 17:12:18
8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,2017-08-04 17:10:39
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,2018-05-17 16:59:11
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52,2018-06-11 10:25:52
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
55e6b290205c84ddd23ddf5eb134efd4,2018-04-13 08:44:17,2018-04-13 08:44:17
636e15840ab051faa13d3f781b6e4233,2018-07-28 16:52:55,2018-07-28 16:52:55
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50,2017-10-16 14:56:50
df9b032b2ad0fd6bf37dfb48e5f83845,2017-08-26 16:53:30,2017-08-26 16:53:30
48558a50a7ba1aab61891936d2ca7681,2018-01-22 19:22:22,2018-01-22 19:22:22
2e068340b3037f667ce3224bd59260af,2017-10-19 15:08:48,2017-10-19 15:08:48
6feea03756fd7ef4fb37d8f7e44aaeb9,2018-02-06 18:25:39,2018-02-06 18:25:39
e42998ccffc48dc87bf70b37e2d61f33,2018-06-08 12:19:58,2018-06-08 12:19:58
3a017955f82b5bf61bb51aec865a01ca,2018-06-01 11:26:06,2018-06-01 11:26:06
64d181ef52b1829800c598942459061b,2018-05-09 14:32:09,2018-05-09 14:32:09
738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,2018-01-02 19:00:43
3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53,2018-02-20 23:46:53
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59,2018-07-26 14:39:59
684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15,2018-03-09 14:50:15
b673f0597cb0c4d12778f731045f361a,2017-05-09 20:48:59,2017-05-09 20:48:59
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18,2018-04-22 23:23:18
167b9485947ed0a354a3f8dad04eb199,2018-07-05 18:40:47,2018-07-05 18:40:47
5883f965ac70043c2e908c3657c5d548,2017-12-21 17:43:41,2017-12-21 17:43:41
4dafe3c841d2d6cc8a8b6d25b35704b9,2017-05-09 11:48:37,2017-05-09 11:48:37
c1ddb7521d14db9071dccad0a94305c2,2018-07-15 12:37:12,2018-07-15 12:37:12
0dd5a932b1e29daa12845dbf696cbb54,2018-06-03 18:24:33,2018-06-03 18:24:33
8458f7ae02bda5950ce48c01a720559a,2018-05-23 16:37:35,2018-05-23 16:37:35
c178d6d544925594fafab0ba493cd645,2018-08-08 21:11:25,2018-08-08 21:11:25
9a80c8377644236e27f59e83862f1ae2,2017-07-10 12:23:05,2017-07-10 12:23:05
15bea20cd005ed59d34db54c6b32ec98,2018-07-23 18:27:07,2018-07-23 18:27:07
d0e6cb83a3fc27f56be011b2941f54c6,2018-05-30 22:33:08,2018-05-30 22:33:08
3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,2018-03-01 14:14:28
cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38,2018-05-02 11:45:38
148348ff65384b4249b762579532e248,2018-06-26 13:42:52,2018-06-26 13:42:52
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26,2017-06-13 
Query:
SELECT COUNT(DISTINCT "customer_id") AS "total_customers"
    FROM E_COMMERCE.E_COMMERCE.CUSTOMERS;
Answer:
total_customers
99441
Query:
SELECT o."order_id", t."total_payment_per_order", o."order_purchase_timestamp"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN (
      SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
      FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
      GROUP BY p."order_id"
    ) t ON o."order_id" = t."order_id"
    LIMIT 100;
Answer:
Too long, hard cut:
order_id,total_payment_per_order,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,38.71,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,141.46,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,179.12,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,72.2,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,28.62,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,175.26,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,65.95,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,75.16,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,35.95,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,169.76,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,259.06,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,114.13,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,50.13,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,32.7,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,54.36,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,146.45,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,1376.45,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,43.09,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,29.75,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,92.97,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,118.86,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,88.9,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,17.28,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,187.57,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,104.11,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,125.43,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,227.68,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,60.69,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,192.68,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,63.34,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,313.19,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,224.9,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,63.1,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,100.25,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,188.41,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,106.95,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,66.79,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,43.0,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,508.17,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,49.69,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,154.19,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,356.12,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,95.67,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,121.62,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,22.36,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,153.72,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,54.82,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,82.33,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,52.24,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,130.56,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,52.84,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,71.91,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,151.04,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,386.33,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,50.25,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,128.68,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,43.46,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,91.68,2018-03-09 14:50:15
a685d016c8a26f71a0bb67821070e398,99.26,2017-03-13 18:14:36
2edfd6d1f0b4cd0db4bf37b1b224d855,141.15,2017-06-13 21:11:26
68873cf91053cd11e6b49a766db5af1a,91.66,2017-11-30 22:02:15
f346ad4ee8f630e5e4ddaf862a34e6dd,53.66,2018-08-05 13:09:48
8f06cc6465925031568537b815f1198d,317.34,2017-11-15 11:31:41
ccbabeb0b02433bd0fcbac46e70339f2,43.0,2018-02-19 20:31:09
688052146432ef8253587b930b01a06d,346.09,2018-04-22 08:48:13
f271576bed568e896f99eb710cd3a6f8,824.76,2018-01-07 21:44:54
686541986ecfb7d9296eb67719973bf0,39.99,2018-02-10 13:26:59
68e48e68da1f50f7c5838ea75e3a20dd,392.6,2018-06-18 16:02:23
b52cc4919de82b4d696a4380d10804a3,55.02,2018-06-13 13:47:39
fdf128b3630c21adc9ca4fb8a51b68ec,46.2,2018-07-15 08:33:19
a6aeb116d2cb5013eb8a94585b71ffef,59.34,2017-09-13 14:27:11
fa516182d28f96f5f5c651026b0749ee,209.41,2018-04-13 08:44:17
6abaad69b8b349c3a529b4b91ce18e46,57.0,2018-02-15 10:33:30
974c1993ab8024d3ed16229183c2308d,84.56,2017-02-20 11:45:39
82bce245b1c9148f8d19a55b9ff70644,267.8,2017-04-20 17:15:46
a910f58086d58b3ae6f37aa712d377b9,145.66,2017-09-15 09:19:48
bd4bd0194d6d29f83b8557d4b89b572a,37.83,2018-07-28 16:52:55
634e8f4c0f6744a626f77f39770ac6aa,234.28,2017-08-09 18:32:47
6d25592267349b322799e2beb687871e,201.82,2018-08-26 22:04:34
b8801cccd8068de30112e4f49903d74a,27.77,2017-07-30 03:06:35
2711a938db643b3f0b62ee2c8a2784aa,59.1,2017-12-22 00:17:37
3bc77ce8be27211bac313c2daa402d1a,66.98,2017-04-06 22:39:29
10c320f977c6a18f91b2d14be13128c6,132.26,2017-05-09 20:48:59
0a4a2fccb27bd83a8
End Exploring Related Columns
Task: Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order. Attention: I want the lifespan in float number if it's longer than one week, otherwise set it to be 1.0.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
customer_id1:str,number_of_orders1:int,average_payment_per_order1:float,lifespan_in_weeks1:float
customer_id2:str,number_of_orders2:int,average_payment_per_order2:float,lifespan_in_weeks2:float
customer_id3:str,number_of_orders3:int,average_payment_per_order3:float,lifespan_in_weeks3:float
(Attention: Answer in three rows)
```

This table displays the number of orders, average payment per order, and customer lifespan in weeks for the top three customers who have the highest average payment per order. If a customer's lifespan is less than one week, it is set to 1.0 as per the requirement..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'E_COMMERCE': {'E_COMMERCE': ['CUSTOMERS', 'GEOLOCATION', 'LEADS_CLOSED', 'LEADS_QUALIFIED', 'ORDERS', 'ORDER_ITEMS', 'ORDER_PAYMENTS', 'ORDER_REVIEWS', 'PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION', 'SELLERS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-21 14:41:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:41:51 - root - INFO - ```sql
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(t."total_payment_per_order") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1
            THEN 1.0
        ELSE
            DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
    END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
    GROUP BY p."order_id"
) t ON o."order_id" = t."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC NULLS LAST
LIMIT 3;
```
2025-01-21 14:41:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:41:52 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:53 - root - INFO - itercount: 1
2025-01-21 14:41:53 - root - INFO - 0
2025-01-21 14:41:53 - root - INFO - results: 
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0


2025-01-21 14:41:53 - root - INFO - Please check the answer again by reviewing Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order. Attention: I want the lifespan in float number if it's longer than one week, otherwise set it to be 1.0., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
customer_id1:str,number_of_orders1:int,average_payment_per_order1:float,lifespan_in_weeks1:float
customer_id2:str,number_of_orders2:int,average_payment_per_order2:float,lifespan_in_weeks2:float
customer_id3:str,number_of_orders3:int,average_payment_per_order3:float,lifespan_in_weeks3:float
(Attention: Answer in three rows)
```

This table displays the number of orders, average payment per order, and customer lifespan in weeks for the top three customers who have the highest average payment per order. If a customer's lifespan is less than one week, it is set to 1.0 as per the requirement. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.0
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.0
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.0
Current sql:
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(t."total_payment_per_order") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1
            THEN 1.0
        ELSE
            DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))::FLOAT
    END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
    GROUP BY p."order_id"
) t ON o."order_id" = t."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC NULLS LAST
LIMIT 3;
2025-01-21 14:42:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:42:18 - root - INFO - ```sql
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    ROUND(AVG(t."total_payment_per_order"), 4) AS "average_payment_per_order",
    ROUND(
        CASE
            WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
            ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))
        END,
        4
    ) AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
    GROUP BY p."order_id"
) t ON o."order_id" = t."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC NULLS LAST
LIMIT 3;
```
2025-01-21 14:42:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:42:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:42:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:42:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:42:20 - snowflake.connector.connection - INFO - closed
2025-01-21 14:42:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:42:20 - root - INFO - itercount: 2
2025-01-21 14:42:20 - root - INFO - 0
2025-01-21 14:42:20 - root - INFO - results: 
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1


2025-01-21 14:42:20 - root - INFO - Please check the answer again by reviewing Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order. Attention: I want the lifespan in float number if it's longer than one week, otherwise set it to be 1.0., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
customer_id1:str,number_of_orders1:int,average_payment_per_order1:float,lifespan_in_weeks1:float
customer_id2:str,number_of_orders2:int,average_payment_per_order2:float,lifespan_in_weeks2:float
customer_id3:str,number_of_orders3:int,average_payment_per_order3:float,lifespan_in_weeks3:float
(Attention: Answer in three rows)
```

This table displays the number of orders, average payment per order, and customer lifespan in weeks for the top three customers who have the highest average payment per order. If a customer's lifespan is less than one week, it is set to 1.0 as per the requirement. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1
Current sql:
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    ROUND(AVG(t."total_payment_per_order"), 4) AS "average_payment_per_order",
    ROUND(
        CASE
            WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
            ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))
        END,
        4
    ) AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
    GROUP BY p."order_id"
) t ON o."order_id" = t."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC NULLS LAST
LIMIT 3;
2025-01-21 14:42:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:42:42 - root - INFO - ```sql
SELECT
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    ROUND(AVG(t."total_payment_per_order"), 4) AS "average_payment_per_order",
    ROUND(
        CASE
            WHEN DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp"))) < 1 THEN 1.0
            ELSE DATEDIFF('week', MIN(TO_TIMESTAMP(o."order_purchase_timestamp")), MAX(TO_TIMESTAMP(o."order_purchase_timestamp")))
        END,
        4
    ) AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT p."order_id", SUM(p."payment_value") AS "total_payment_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p
    GROUP BY p."order_id"
) t ON o."order_id" = t."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC NULLS LAST
LIMIT 3;
```
2025-01-21 14:42:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:42:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:42:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:42:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:42:43 - snowflake.connector.connection - INFO - closed
2025-01-21 14:42:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:42:44 - root - INFO - itercount: 3
2025-01-21 14:42:44 - root - INFO - 0
2025-01-21 14:42:44 - root - INFO - Total iteration counts: 3
