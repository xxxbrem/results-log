2025-01-20 21:41:27 - openai._base_client - INFO - Retrying request to /chat/completions in 0.383539 seconds
2025-01-20 21:42:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:42:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:42:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:42:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:42:11 - snowflake.connector.connection - INFO - closed
2025-01-20 21:42:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:42:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:42:39 - root - INFO - It appears that the error is due to a mismatch between the actual format of the dates in the `"week_date"` column and the date format specified in the `TO_DATE` function. The error message indicates that the date `'31/8/20'` cannot be parsed using the format `'YYYY-MM-DD'`. This suggests that the dates in the `"week_date"` column are in the format `'DD/MM/YY'`.

**Here's how to address the issue:**

1. **Identify the Correct Date Format:**

   Since the date `'31/8/20'` corresponds to August 31, 2020, and is represented as `'DD/MM/YY'`, we need to adjust the date format in the `TO_DATE` function accordingly.

2. **Modify the SQL Query with the Correct Date Format:**

   Update the date format in the `TO_DATE` function to match the actual format of the data.

   ```sql
   SELECT DISTINCT EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) AS "year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   LIMIT 1000;
   ```

3. **Test the Adjusted Query:**

   Running the adjusted query should now correctly extract the years from the `"week_date"` column without encountering parsing errors.

---

**Explanation:**

- **Original Error:**

  ```
  100097 (22007): 01b9d896-0004-7ed2-0001-11c300f2ce0a: Can't parse '31/8/20' as date with format 'YYYY-MM-DD'
  ```

  This error indicates that `'31/8/20'` doesn't match the specified date format `'YYYY-MM-DD'`.

- **Correcting the Date Format:**

  The date `'31/8/20'` is in the format `'DD/MM/YY'`, where:

  - `DD` = Day (31)
  - `MM` = Month (8)
  - `YY` = Year (20)

  Therefore, we need to use `'DD/MM/YY'` as the date format in the `TO_DATE` function.

---

**Adjusting Other Queries:**

Given that the date format in the `"week_date"` column is `'DD/MM/YY'`, we need to update all other queries that use `TO_DATE` accordingly.

Here are the adjusted queries:

1. **List all "week_date" values around mid-June for the specified years:**

   ```sql
   SELECT "week_date"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
   ```

2. **Retrieve total sales for each "week_date":**

   ```sql
   SELECT "week_date", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
   ```

3. **Select sales data for four weeks before and after June 15, 2018:**

   ```sql
   SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '18/05/18' AND '13/07/18'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
   ```

   Note: Adjust the comparison dates to match the `'DD/MM/YY'` format.

4. **Select sales data for four weeks before and after June 15, 2019:**

   ```sql
   SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '17/05/19' AND '12/07/19'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
   ```

5. **Select sales data for four weeks before and after June 15, 2020:**

   ```sql
   SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '15/05/20' AND '10/07/20'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
   ```

6. **Get total sales by "region" for June 2020:**

   ```sql
   SELECT "region", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020
     AND EXTRACT(MONTH FROM TO_DATE("week_date", 'DD/MM/YY')) = 6
   GROUP BY "region"
   LIMIT 1000;
   ```

7. **Analyze average sales per transaction around mid-June 2020:**

   ```sql
   SELECT "week_date", AVG("sales" / NULLIF("transactions", 0)) AS "avg_sale_per_transaction"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '15/05/20' AND '10/07/20'
   GROUP BY "week_date"
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
   ```

---

**Additional Steps:**

- **Verify the Date Formats in the Data:**

  It may be helpful to retrieve a sample of the `"week_date"` values to confirm the date format.

  ```sql
  SELECT DISTINCT "week_date"
  FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
  ORDER BY "week_date"
  LIMIT 1000;
  ```

- **Check for Consistency in Date Formats:**

  If there are inconsistencies in the date formats within the `"week_date"` column, additional data cleaning may be required.

---

**Summary:**

- The error was caused by an incorrect date format specification in the `TO_DATE` function.
- Adjusting the date format to `'DD/MM/YY'` resolves the issue.
- All queries involving date parsing should use the correct date format to avoid errors.
- Always verify the actual data formats in the columns when working with date and time functions.

---

Feel free to run the adjusted queries, and let me know if you encounter any further issues!
2025-01-20 21:42:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:42:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:42:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:42:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 21:42:40 - snowflake.connector.connection - INFO - closed
2025-01-20 21:42:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:43:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:43:52 - root - INFO - SQL:
SELECT "week_date"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
Results:
Too long, hard cut:
week_date
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4

2025-01-20 21:43:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:43:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:43:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:43:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 21:43:54 - snowflake.connector.connection - INFO - closed
2025-01-20 21:43:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:43:54 - root - INFO - SQL:
SELECT "week_date"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Results:
Too long, hard cut:
week_date
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4

2025-01-20 21:43:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:43:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:43:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:43:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 72
2025-01-20 21:43:56 - snowflake.connector.connection - INFO - closed
2025-01-20 21:43:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:43:56 - root - INFO - SQL:
SELECT "week_date", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Results:
week_date,total_sales
26/3/18,536755452
2/4/18,541167115
9/4/18,529574544
16/4/18,526355503
23/4/18,536075195
30/4/18,539632290
7/5/18,534072854
14/5/18,527788555
21/5/18,522377362
28/5/18,544417653
4/6/18,525086015
11/6/18,533259779
18/6/18,524368733
25/6/18,525737676
2/7/18,532366710
9/7/18,546769795
16/7/18,541086855
23/7/18,547653578
30/7/18,539321534
6/8/18,549636536
13/8/18,543535235
20/8/18,544330787
27/8/18,553039709
3/9/18,552971362
25/3/19,581317054
1/4/19,592780894
8/4/19,604578468
15/4/19,549169512
22/4/19,574707247
29/4/19,578911200
6/5/19,580698026
13/5/19,571234200
20/5/19,561098180
27/5/19,564501406
3/6/19,561091415
10/6/19,563298795
17/6/19,559088818
24/6/19,555374893
1/7/19,559413335
8/7/19,578449344
15/7/19,571261970
22/7/19,578808584
29/7/19,573703558
5/8/19,575209431
12/8/19,573749878
19/8/19,576006984
26/8/19,580274015
2/9/19,581305293
23/3/20,638197506
30/3/20,600898723
6/4/20,585551930
13/4/20,606143272
20/4/20,571874343
27/4/20,589783021
4/5/20,601398593
11/5/20,586547402
18/5/20,585008090
25/5/20,589120804
1/6/20,585466073
8/6/20,586283390
15/6/20,570025348
22/6/20,583242828
29/6/20,575390599
6/7/20,590335394
13/7/20,585936402
20/7/20,580874115
27/7/20,576349635
3/8/20,565709853
10/8/20,580024393
17/8/20,581075406
24/8/20,593379892
31/8/20,591603888

2025-01-20 21:43:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:43:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:43:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:43:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 72
2025-01-20 21:43:57 - snowflake.connector.connection - INFO - closed
2025-01-20 21:43:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:43:58 - root - INFO - SQL:
SELECT "week_date", SUM("transactions") AS "total_transactions"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Results:
week_date,total_transactions
26/3/18,14467968
2/4/18,14461826
9/4/18,14335920
16/4/18,13764983
23/4/18,14264852
30/4/18,14804758
7/5/18,14433880
14/5/18,14402634
21/5/18,14300704
28/5/18,14334709
4/6/18,14191769
11/6/18,14301607
18/6/18,14239928
25/6/18,14276206
2/7/18,14254080
9/7/18,14433509
16/7/18,14423378
23/7/18,14630429
30/7/18,14517411
6/8/18,14664250
13/8/18,14650155
20/8/18,14630533
27/8/18,14866086
3/9/18,14754885
25/3/19,15599753
1/4/19,15718438
8/4/19,14400139
15/4/19,14348926
22/4/19,15173759
29/4/19,15338880
6/5/19,15619179
13/5/19,15236869
20/5/19,15168724
27/5/19,15118746
3/6/19,14969739
10/6/19,15184213
17/6/19,15188595
24/6/19,15053941
1/7/19,15119644
8/7/19,15268352
15/7/19,15221658
22/7/19,15351786
29/7/19,15287256
5/8/19,15333509
12/8/19,15341256
19/8/19,15427601
26/8/19,15627105
2/9/19,15541217
23/3/20,15178626
30/3/20,16071484
6/4/20,15805256
13/4/20,16204763
20/4/20,15011474
27/4/20,15652491
4/5/20,16242601
11/5/20,15781030
18/5/20,15762846
25/5/20,15685376
1/6/20,15558889
8/6/20,15577446
15/6/20,15535593
22/6/20,15643201
29/6/20,15618916
6/7/20,15662181
13/7/20,15580840
20/7/20,15618702
27/7/20,15579960
3/8/20,15118406
10/8/20,15619562
17/8/20,15643949
24/8/20,15829512
31/8/20,15830547

2025-01-20 21:43:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:43:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:43:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:43:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 21:43:59 - snowflake.connector.connection - INFO - closed
2025-01-20 21:43:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:43:59 - root - INFO - SQL:
SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Results:
Too long, hard cut:
week_date,sales
21/5/18,30578
21/5/18,8194
21/5/18,66910
21/5/18,22258
21/5/18,22503
21/5/18,30899
21/5/18,4624567
21/5/18,1053586
21/5/18,3147089
21/5/18,989314
21/5/18,50422
21/5/18,9952
21/5/18,15823156
21/5/18,469536
21/5/18,208
21/5/18,2172498
21/5/18,56322
21/5/18,5758040
21/5/18,2919
21/5/18,305373
21/5/18,10714
21/5/18,4987285
21/5/18,68428
21/5/18,380245
21/5/18,128
21/5/18,56913
21/5/18,12902
21/5/18,3678765
21/5/18,2430418
21/5/18,21068
21/5/18,108399
21/5/18,22031
21/5/18,311368
21/5/18,8835
21/5/18,31963
21/5/18,4289215
21/5/18,2199
21/5/18,178002
21/5/18,2490585
21/5/18,3832060
21/5/18,31573
21/5/18,630759
21/5/18,60857
21/5/18,188138
21/5/18,12337
21/5/18,3867192
21/5/18,25019
21/5/18,32938
21/5/18,64370
21/5/18,1362599
21/5/18,1042819
21/5/18,20596
21/5/18,93234
21/5/18,161280
21/5/18,2491437
21/5/18,396
21/5/18,399064
21/5/18,1631475
21/5/18,9100851
21/5/18,3580630
21/5/18,1851
21/5/18,40530
21/5/18,17267796
21/5/18,27477
21/5/18,3016196
21/5/18,14807
21/5/18,61201495
21/5/18,924826
21/5/18,133107
21/5/18,2303519
21/5/18,3440414
21/5/18,41139
21/5/18,67916
21/5/18,575772
21/5/18,7410092
21/5/18,19333
21/5/18,134079
21/5/18,2159936
21/5/18,14001
21/5/18,372903
21/5/18,327279
21/5/18,2144631
21/5/18,43782
21/5/18,4658478
21/5/18,54304
21/5/18,105674
21/5/18,62492
21/5/18,20920
21/5/18,46473593
21/5/18,2652286
21/5/18,735845
21/5/18,1440638
21/5/18,218928
21/5/18,305004
21/5/18,274179
21/5/18,6606
21/5/18,462670
21/5/18,3645951
21/5/18,160714
21/5/18,5932781
21/5/18,68159
21/5/18,927931
21/5/18,3637
21/5/18,24854
21/5/18,19220
21/5/18,2309
21/5/18,5261
21/5/18,1628991
21/5/18,25121884
21/5/18,533422
21/5/18,3588849
21/5/18,6351481
21/5/18,1146
21/5/18,266997
21/5/18,8524
21/5/18,894408
21/5/18,12438
21/5/18,8713
21/5/18,390234
21/5/18,267586
21/5/18,1225
21/5/18,94247
21/5/18,1953405
21/5/18,39546
21/5/18,110858
21/5/18,23435
21/5/18,38115
21/5/18,820002
21/5/18,760233
21/5/18,451
21/5/18,432398
21/5/18,1583716
21/5/18,1133844
21/5/18,4415258
21/5/18,3284958
21/5/18,8566788
21/5/18,37171
21/5/18,13251767
21/5/18,72944
21/5/18,41562
21/5/18,2891882
21/5/18,19049028
21/5/18,285117
21/5/18,211545
21/5/18,815811
21/5/18,15947
21/5/18,3241
21/5/18,178776
21/5/18,42666
21/5/18,15907
21/5/18,8014
21/5/18,5072090
21/5/18,971075
21/5/18,40773
21/5/18,179574
21/5/18,3130
21/5/18,141719
21/5/18,11454192
21/5/18,20306
21/5/18,1803724
21/5/18,18770
21/5/18,67817
21/5/18,1082258
21/5/18,24811
21/5/18,28470
21/5/18,37955
21/5/18,3630092
21/5/18,16578
21/5/18,8842
21/5/18,211345
21/5/18,7781097
21/5/18,2419
21/5/18,10170
21/5/18,7490
21/5/18,2264303
21/5/18,2149075
21/5/18,611755
21/5/18,34346
21/5/18,169166
21/5/18,17997
21/5/18,27476
21/5/18,796546
21/5/18,72545
21/5/18,448723
21/5/18,7668
21/5/18,1220141
21/5/18,3394
21/5/18,1235
21/5/18,372575
21/5/18,256678
21/5/18,7948
21/5/18,810850
21/5/18,939230
21/5/18,856064
21/5/18,13395441
21/5/18,37301
21/5/18,615671
21/5/18,2366617
21/5/18,66796
21/5/18,1586
21/5/18,25427
21/5/18,4631
21/5/18,16486757
21/5/18,5391
21/5/18,927659
21/5/18,30725
21/5/18,933
21/5/18,14961019
21/5/18,44818650
21/5/18,30662
21/5/18,3210
21/5/18,3980
21/5/18,196339
21/5/18,16556
21/5/18,71897
21/5/18,194622
21/5/18,2050
21/5/18,31371
21/5/18,1637482
21/5/18,11637390
21/5/18,9989
21/5/18,4549120
21/5/18,2053556
21/5/18,660500
21/5/18,22992
21/5/18,6577
21/5/18,1398357
21/5/18,2423606
21/5/18,1347670
21/5/18,523208
21/5/18,302861
21/5/18,5211031
21/5/18,497388
21/5/18,539286
21/5/18,8815
21/5/18,2048
21/5/18,4527
28/5/18,1693322
28/5/18,76060
28/5/18,38039
28/5/18,1148273
28/5/18,5170653
28/5/18,529834
28/5/18,44086
28/5/18,2231123
28/5/18,69503
28/5/18,1438
28/5/18,32827
28/5/18,601405
28/5/18,10187
28/5/18,149134
28/5/18,4152648
28/5/18,402822
28/5/18,3754776
28/5/18,656497
28/5/18,3959951
28/5/18,25524
28/5/18,737
28/5/18,365
28/5/18,27200
28/5/18,10454
28/5/18,2326746
28/5/18,30909
28/5/18,830383
28/5/18,53804
28/5/18,81985
28/5/18,332124
28/5/18,8126
28/5/18,26995
28/5/18,46899443
28/5/18,13702321
28/5/18,572145
28/5/18,1096227
28/5/18,2198177
28/5/18,577899
28/5/18,33395
28/5/18,26449
28/5/18,18235
28/5/18,4581513
28/5/18,315994
28/5/18,1867
28/5/18,1698018
28/5/18,46741
28/5/18,11976
28/5/18,1998
28/5/18,16177
28/5/18,2544642
28/5/18,3071
28/5/18,2475
28/5/18,5601
28/5/18,1457927
28/5/18,674759
28/5/18,3841
28/5/18,835812
28/5/18,5062331
28/5/18,463544
28/5/18,322146
28/5/18,79663
28/5/18,7460
28/5/18,91863
28/5/18,36997
28/5/18,606987
28/5/18,190814
28/5/18,4759954
28/5/18,24015
28/5/18,4137
28/5/18,8866637
28/5/18,67708
28/5/18,64986
28/5/18,32948
28/5/18,3001
28/5/18,285777
28/5/18,566401
28/5/18,2326315
28/5/18,10163
28/5/18,3278109
28/5/18,4490779
28/5/18,15432
28/5/18,3500242
28/5/18,2551781
28/5/18,7897
28/5/18,425238
28/5/18,429109
28/5/18,72543
28/5/18,17808
28/5/18,311280
28/5/18,1731029
28/5/18,83148
28/5/18,37566
28/5/18,25654
28/5/18,7583169
28/5/18,110972
28/5/18,228815
28/5/18,18529
28/5/18,1644
28/5/18,1651
28/5/18,4732694
28/5/18,318004
28/5/18,12146474
28/5/18,9

2025-01-20 21:43:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:43:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:43:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 21:44:01 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:01 - root - INFO - SQL:
SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Results:
Too long, hard cut:
week_date,sales
20/5/19,14580487
20/5/19,958524
20/5/19,4152692
20/5/19,295055
20/5/19,373005
20/5/19,243650
20/5/19,30802
20/5/19,80231
20/5/19,2496378
20/5/19,13276
20/5/19,58469
20/5/19,15086
20/5/19,17472257
20/5/19,458961
20/5/19,3012349
20/5/19,486684
20/5/19,2494603
20/5/19,61148
20/5/19,1856
20/5/19,13368941
20/5/19,1559525
20/5/19,7317748
20/5/19,29399
20/5/19,8077600
20/5/19,39987
20/5/19,10984
20/5/19,31358
20/5/19,12016285
20/5/19,1069622
20/5/19,1983386
20/5/19,2959326
20/5/19,463480
20/5/19,2508520
20/5/19,18562180
20/5/19,34406
20/5/19,24486
20/5/19,13361
20/5/19,2307851
20/5/19,2689
20/5/19,7986
20/5/19,69959
20/5/19,439283
20/5/19,333331
20/5/19,822276
20/5/19,5198620
20/5/19,2322501
20/5/19,2158907
20/5/19,1921370
20/5/19,24363
20/5/19,614901
20/5/19,263569
20/5/19,21089
20/5/19,240721
20/5/19,9091
20/5/19,5708
20/5/19,3499613
20/5/19,9940
20/5/19,30466
20/5/19,2303175
20/5/19,35109
20/5/19,603618
20/5/19,102942
20/5/19,3927
20/5/19,21095771
20/5/19,96341
20/5/19,762
20/5/19,264828
20/5/19,1480
20/5/19,693
20/5/19,2115562
20/5/19,7272
20/5/19,364278
20/5/19,26801
20/5/19,3260782
20/5/19,40857
20/5/19,1550810
20/5/19,82669
20/5/19,2457
20/5/19,10807
20/5/19,11091
20/5/19,429
20/5/19,48464
20/5/19,51195
20/5/19,28404
20/5/19,11704
20/5/19,386810
20/5/19,1375604
20/5/19,3213361
20/5/19,40418
20/5/19,1067703
20/5/19,746891
20/5/19,5471678
20/5/19,3341829
20/5/19,361462
20/5/19,1054545
20/5/19,3906
20/5/19,119971
20/5/19,15202
20/5/19,632337
20/5/19,9967
20/5/19,667358
20/5/19,996172
20/5/19,233025
20/5/19,1301934
20/5/19,1219
20/5/19,114339
20/5/19,25805
20/5/19,877361
20/5/19,9509
20/5/19,1309540
20/5/19,761
20/5/19,21801
20/5/19,31382
20/5/19,4909455
20/5/19,1377196
20/5/19,28207017
20/5/19,1547401
20/5/19,25075
20/5/19,48837957
20/5/19,4249
20/5/19,163287
20/5/19,4454659
20/5/19,415923
20/5/19,15443
20/5/19,805348
20/5/19,15808311
20/5/19,6715
20/5/19,15430
20/5/19,64241
20/5/19,835598
20/5/19,19830
20/5/19,322146
20/5/19,147156
20/5/19,85920
20/5/19,4515254
20/5/19,339159
20/5/19,6350295
20/5/19,2215666
20/5/19,1283
20/5/19,898738
20/5/19,44912
20/5/19,52824
20/5/19,32460
20/5/19,2718
20/5/19,1150
20/5/19,39819
20/5/19,5498455
20/5/19,13395
20/5/19,8342
20/5/19,11623
20/5/19,376681
20/5/19,91623
20/5/19,193618
20/5/19,12225
20/5/19,605674
20/5/19,5613
20/5/19,80512
20/5/19,31843
20/5/19,342282
20/5/19,102535
20/5/19,49927
20/5/19,1685866
20/5/19,2204
20/5/19,25173
20/5/19,763224
20/5/19,6976999
20/5/19,1220796
20/5/19,21980
20/5/19,4325275
20/5/19,5522407
20/5/19,271159
20/5/19,654684
20/5/19,24874
20/5/19,3208119
20/5/19,133111
20/5/19,68001
20/5/19,2668
20/5/19,939368
20/5/19,154009
20/5/19,115386
20/5/19,38939
20/5/19,12411
20/5/19,15329192
20/5/19,927631
20/5/19,27759
20/5/19,45260
20/5/19,1313097
20/5/19,10162950
20/5/19,64340543
20/5/19,145957
20/5/19,17348953
20/5/19,191196
20/5/19,614999
20/5/19,235493
20/5/19,1936014
20/5/19,9754
20/5/19,298931
20/5/19,8517612
20/5/19,23187
20/5/19,1130692
20/5/19,965579
20/5/19,173246
20/5/19,45355725
20/5/19,5296763
20/5/19,2083
20/5/19,1069
20/5/19,14219
20/5/19,541797
20/5/19,10323635
20/5/19,17406
20/5/19,564051
20/5/19,35286
20/5/19,4413002
20/5/19,560410
20/5/19,667340
20/5/19,611
20/5/19,21172
20/5/19,37461
20/5/19,218
20/5/19,32303
20/5/19,35539
20/5/19,52872
20/5/19,2188303
20/5/19,4030
20/5/19,47769
20/5/19,4574
20/5/19,3173771
20/5/19,57682
20/5/19,3295143
20/5/19,38388
20/5/19,30252
20/5/19,227255
20/5/19,5873495
20/5/19,213308
20/5/19,2293459
20/5/19,98467
20/5/19,2390065
20/5/19,83117
27/5/19,1343869
27/5/19,1131882
27/5/19,2664099
27/5/19,209191
27/5/19,10429
27/5/19,10133729
27/5/19,965719
27/5/19,30095
27/5/19,19743
27/5/19,23095
27/5/19,3404361
27/5/19,3210013
27/5/19,323889
27/5/19,17553
27/5/19,102369
27/5/19,11908
27/5/19,129910
27/5/19,666626
27/5/19,938078
27/5/19,8196299
27/5/19,5526
27/5/19,1106037
27/5/19,39410
27/5/19,2362584
27/5/19,11341
27/5/19,110605
27/5/19,47061
27/5/19,3014466
27/5/19,21477926
27/5/19,23205
27/5/19,59846
27/5/19,351038
27/5/19,2699
27/5/19,15061
27/5/19,3357654
27/5/19,246592
27/5/19,47258
27/5/19,1143743
27/5/19,28766028
27/5/19,7960
27/5/19,342157
27/5/19,53135
27/5/19,44367
27/5/19,45373
27/5/19,480
27/5/19,404818
27/5/19,747297
27/5/19,13176
27/5/19,1579930
27/5/19,23017
27/5/19,1059
27/5/19,15565079
27/5/19,8358
27/5/19,12302
27/5/19,5466006
27/5/19,19961
27/5/19,72329
27/5/19,2860
27/5/19,68404
27/5/19,1898654
27/5/19,24469
27/5/19,13461
27/5/19,234798
27/5/19,1956247
27/5/19,2098106
27/5/19,877272
27/5/19,916053
27/5/19,537728
27/5/19,10731
27/5/19,820896
27/5/19,39207
27/5/19,261402
27/5/19,73836
27/5/19,20327
27/5/19,4516588
27/5/19,270440
27/5/19,257014
27/5/19,1368641
27/5/19,1717
27/5/19,360861
27/5/19,5104
27/5/19,15446
27/5/19,2248577
27/5/19,780923
27/5/19,1363770
27/5/19,89293
27/5/19,858756
27/5/19,1593860
27/5/19,44008
27/5/19,28467
27/5/19,462638
27/5/19,22389
27/5/19,11200
27/5/19,176135
27/5/19,11186
27/5/19,3769
27/5/19,4281816
27/5/19,5815
27/5/19,3473394
27/5/19,39030
27/5

2025-01-20 21:44:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 21:44:03 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:03 - root - INFO - SQL:
SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Results:
Too long, hard cut:
week_date,sales
18/5/20,13502
18/5/20,31967
18/5/20,907257
18/5/20,27642
18/5/20,802055
18/5/20,1303250
18/5/20,13996
18/5/20,2006122
18/5/20,5918845
18/5/20,47653
18/5/20,32220
18/5/20,747640
18/5/20,13412
18/5/20,2137229
18/5/20,939066
18/5/20,789634
18/5/20,408215
18/5/20,11595
18/5/20,3624839
18/5/20,34101
18/5/20,8614840
18/5/20,26133
18/5/20,7531190
18/5/20,18360291
18/5/20,4618567
18/5/20,480498
18/5/20,407517
18/5/20,30045
18/5/20,6723137
18/5/20,3181673
18/5/20,16097
18/5/20,20396901
18/5/20,863512
18/5/20,47270
18/5/20,2599
18/5/20,39477
18/5/20,1258891
18/5/20,1602793
18/5/20,2100027
18/5/20,1758894
18/5/20,383797
18/5/20,3334217
18/5/20,21419
18/5/20,1306
18/5/20,282150
18/5/20,2210786
18/5/20,88372
18/5/20,11017216
18/5/20,1447820
18/5/20,254131
18/5/20,54615
18/5/20,2763891
18/5/20,2666444
18/5/20,11298
18/5/20,49309503
18/5/20,20031
18/5/20,190616
18/5/20,1011014
18/5/20,634015
18/5/20,16718027
18/5/20,269246
18/5/20,2851231
18/5/20,5577831
18/5/20,793
18/5/20,1109858
18/5/20,49090
18/5/20,11043793
18/5/20,915413
18/5/20,42638
18/5/20,293977
18/5/20,1986987
18/5/20,446036
18/5/20,76494
18/5/20,33872
18/5/20,155355
18/5/20,897722
18/5/20,16652063
18/5/20,4801310
18/5/20,405243
18/5/20,270980
18/5/20,518467
18/5/20,954785
18/5/20,3887
18/5/20,1280896
18/5/20,4956551
18/5/20,23920
18/5/20,361882
18/5/20,858130
18/5/20,1041064
18/5/20,33079
18/5/20,4559208
18/5/20,465393
18/5/20,27544
18/5/20,44786
18/5/20,55710
18/5/20,12427
18/5/20,2143224
18/5/20,3358384
18/5/20,12524
18/5/20,52738
18/5/20,3247033
18/5/20,39618
18/5/20,4394
18/5/20,935950
18/5/20,16562
18/5/20,1834416
18/5/20,359051
18/5/20,4052
18/5/20,758167
18/5/20,14498529
18/5/20,1765
18/5/20,39994
18/5/20,22785
18/5/20,2588654
18/5/20,123920
18/5/20,2146858
18/5/20,535805
18/5/20,1172060
18/5/20,87706
18/5/20,2342
18/5/20,109364
18/5/20,8066
18/5/20,258708
18/5/20,77180
18/5/20,19294
18/5/20,14592
18/5/20,5354
18/5/20,1330104
18/5/20,7445
18/5/20,53463
18/5/20,30940
18/5/20,2502063
18/5/20,34920
18/5/20,9204042
18/5/20,616473
18/5/20,243183
18/5/20,7584111
18/5/20,15037298
18/5/20,5161179
18/5/20,10807
18/5/20,5062985
18/5/20,854624
18/5/20,98181
18/5/20,465648
18/5/20,25609
18/5/20,30026087
18/5/20,6165599
18/5/20,3566897
18/5/20,119937
18/5/20,266727
18/5/20,19672
18/5/20,3352
18/5/20,29915
18/5/20,119530
18/5/20,141441
18/5/20,9188
18/5/20,44493573
18/5/20,4719
18/5/20,835929
18/5/20,1671
18/5/20,1685671
18/5/20,64211904
18/5/20,6931
18/5/20,124572
18/5/20,3900
18/5/20,53175
18/5/20,214428
18/5/20,22377941
18/5/20,130015
18/5/20,1952
18/5/20,66634
18/5/20,522563
18/5/20,811341
18/5/20,5342
18/5/20,1268
18/5/20,600119
18/5/20,34915
18/5/20,64714
18/5/20,73718
18/5/20,6517112
18/5/20,5180
18/5/20,395124
18/5/20,5376453
18/5/20,262445
18/5/20,12755
18/5/20,364412
18/5/20,2272218
18/5/20,2667
18/5/20,46560
18/5/20,52205
18/5/20,3036
18/5/20,27920
18/5/20,101218
18/5/20,33358
18/5/20,553428
18/5/20,152602
18/5/20,3474692
18/5/20,446379
18/5/20,6485
18/5/20,429979
18/5/20,617637
18/5/20,49587
18/5/20,4193
18/5/20,8518
18/5/20,40431
18/5/20,7421
18/5/20,2181810
18/5/20,16232292
18/5/20,991
18/5/20,993855
18/5/20,42583
18/5/20,2390319
18/5/20,1448578
18/5/20,845405
18/5/20,461278
18/5/20,1429280
18/5/20,62387
18/5/20,19570
18/5/20,15073
18/5/20,218
18/5/20,44550
18/5/20,2284891
18/5/20,14872
18/5/20,66849
18/5/20,11704
18/5/20,27513
18/5/20,62635
18/5/20,2397635
18/5/20,1704710
18/5/20,1919
18/5/20,36469
18/5/20,11356688
18/5/20,451976
18/5/20,5879139
18/5/20,66955
18/5/20,96732
18/5/20,127924
18/5/20,20850
25/5/20,971467
25/5/20,5892963
25/5/20,27475
25/5/20,50861380
25/5/20,8488121
25/5/20,1669
25/5/20,52847
25/5/20,6593576
25/5/20,13595
25/5/20,435734
25/5/20,127974
25/5/20,30110314
25/5/20,35632
25/5/20,273334
25/5/20,5001925
25/5/20,44026
25/5/20,30990
25/5/20,135954
25/5/20,53119
25/5/20,44266
25/5/20,803263
25/5/20,45385
25/5/20,58215
25/5/20,46409881
25/5/20,137901
25/5/20,320
25/5/20,6730
25/5/20,2058255
25/5/20,92035
25/5/20,2596974
25/5/20,2559410
25/5/20,108432
25/5/20,49873
25/5/20,140241
25/5/20,26409
25/5/20,2081122
25/5/20,1444579
25/5/20,125540
25/5/20,572226
25/5/20,1734583
25/5/20,1884396
25/5/20,128601
25/5/20,536321
25/5/20,3324021
25/5/20,7530875
25/5/20,2001324
25/5/20,27436
25/5/20,724522
25/5/20,2188678
25/5/20,625019
25/5/20,5745300
25/5/20,3459907
25/5/20,31126
25/5/20,857113
25/5/20,452686
25/5/20,524469
25/5/20,313931
25/5/20,270446
25/5/20,407944
25/5/20,59847
25/5/20,142137
25/5/20,57340
25/5/20,17471175
25/5/20,866297
25/5/20,257137
25/5/20,2095617
25/5/20,15046
25/5/20,12923
25/5/20,605686
25/5/20,1812967
25/5/20,507294
25/5/20,43451
25/5/20,44069
25/5/20,846554
25/5/20,2289378
25/5/20,1467
25/5/20,114907
25/5/20,29908
25/5/20,1414121
25/5/20,5827
25/5/20,12345
25/5/20,638483
25/5/20,5195267
25/5/20,1133335
25/5/20,22248935
25/5/20,21550
25/5/20,878454
25/5/20,9356
25/5/20,6381581
25/5/20,2055441
25/5/20,270166
25/5/20,402203
25/5/20,650
25/5/20,30541
25/5/20,1457714
25/5/20,482176
25/5/20,7185403
25/5/20,2548

2025-01-20 21:44:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-20 21:44:04 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:05 - root - INFO - SQL:
SELECT DISTINCT "region"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   LIMIT 1000
Results:
region
ASIA
USA
EUROPE
AFRICA
CANADA
SOUTH AMERICA
OCEANIA

2025-01-20 21:44:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-20 21:44:06 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:06 - root - INFO - SQL:
SELECT "region", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020
     AND EXTRACT(MONTH FROM TO_DATE("week_date", 'DD/MM/YY')) = 6
   GROUP BY "region"
   LIMIT 1000
Results:
region,total_sales
OCEANIA,951984238
USA,277763625
SOUTH AMERICA,87360985
EUROPE,47351180
ASIA,658863091
CANADA,174745093
AFRICA,702340026

2025-01-20 21:44:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 21:44:08 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:08 - root - INFO - SQL:
SELECT DISTINCT "platform"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2020-07-10'
   LIMIT 1000
Results:
platform
Shopify
Retail

2025-01-20 21:44:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 21:44:10 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:10 - root - INFO - SQL:
SELECT "customer_type", SUM("sales") AS "total_sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
    GROUP BY "customer_type"
    LIMIT 1000
Results:
customer_type,total_sales
Existing,2244717300
New,572303089
Guest,1685295797

2025-01-20 21:44:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-01-20 21:44:11 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:12 - root - INFO - SQL:
SELECT DISTINCT "segment"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    LIMIT 1000
Results:
segment
C3
F1
""
C1
C2
F3
C4
F2

2025-01-20 21:44:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-01-20 21:44:13 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:13 - root - INFO - SQL:
SELECT "week_date", AVG("sales" / NULLIF("transactions", 0)) AS "avg_sale_per_transaction"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
    GROUP BY "week_date"
    ORDER BY TO_DATE("week_date", 'DD/MM/YY')
    LIMIT 1000
Results:
week_date,avg_sale_per_transaction
18/5/20,100.394368815126
25/5/20,101.589432205882
1/6/20,100.081979781513
8/6/20,106.493251983193
15/6/20,106.978040394958
22/6/20,111.207363684874
29/6/20,108.803958336134
6/7/20,113.065789176471

2025-01-20 21:44:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 21:44:15 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:15 - root - INFO - SQL:
SELECT "week_date", "sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    ORDER BY TO_DATE("week_date", 'DD/MM/YY')
    LIMIT 1000
Results:
Too long, hard cut:
week_date,sales
26/3/18,29626
26/3/18,5108834
26/3/18,7485775
26/3/18,124933
26/3/18,708935
26/3/18,5422
26/3/18,906090
26/3/18,5472
26/3/18,8019043
26/3/18,21366
26/3/18,7672
26/3/18,17610630
26/3/18,63275082
26/3/18,614397
26/3/18,243347
26/3/18,16207
26/3/18,12440
26/3/18,96481
26/3/18,2673553
26/3/18,661150
26/3/18,8967057
26/3/18,12931
26/3/18,30367
26/3/18,1040046
26/3/18,6020419
26/3/18,985673
26/3/18,299943
26/3/18,1864
26/3/18,6622
26/3/18,105791
26/3/18,8662
26/3/18,21902
26/3/18,172745
26/3/18,56134
26/3/18,2567272
26/3/18,44597
26/3/18,28717
26/3/18,3558
26/3/18,64646
26/3/18,18647
26/3/18,350417
26/3/18,2602065
26/3/18,3725387
26/3/18,25388649
26/3/18,273302
26/3/18,40430
26/3/18,2640811
26/3/18,68811
26/3/18,2219869
26/3/18,103774
26/3/18,16007398
26/3/18,3700047
26/3/18,3890763
26/3/18,3886146
26/3/18,23524
26/3/18,183903
26/3/18,1617709
26/3/18,16153
26/3/18,12966045
26/3/18,32217
26/3/18,45998717
26/3/18,1011432
26/3/18,20746
26/3/18,433400
26/3/18,695014
26/3/18,4050
26/3/18,336688
26/3/18,2257802
26/3/18,15517900
26/3/18,195225
26/3/18,18631509
26/3/18,3587
26/3/18,3179568
26/3/18,39900
26/3/18,5116495
26/3/18,4641508
26/3/18,2247059
26/3/18,24767
26/3/18,70305
26/3/18,5453458
26/3/18,2682773
26/3/18,310853
26/3/18,29525
26/3/18,4158055
26/3/18,55808
26/3/18,2072
26/3/18,25673
26/3/18,571887
26/3/18,873
26/3/18,66813
26/3/18,172470
26/3/18,168817
26/3/18,190895
26/3/18,1878628
26/3/18,677
26/3/18,12133134
26/3/18,66505
26/3/18,60871
26/3/18,463292
26/3/18,4724108
26/3/18,2326726
26/3/18,4478715
26/3/18,999080
26/3/18,48209562
26/3/18,2316915
26/3/18,185209
26/3/18,1122918
26/3/18,300
26/3/18,16993
26/3/18,51682
26/3/18,105019
26/3/18,20877
26/3/18,9124
26/3/18,763772
26/3/18,24476
26/3/18,1692383
26/3/18,260211
26/3/18,2183
26/3/18,69581
26/3/18,8839
26/3/18,303272
26/3/18,811158
26/3/18,2729
26/3/18,2428945
26/3/18,41866
26/3/18,168280
26/3/18,6864699
26/3/18,787254
26/3/18,403
26/3/18,523000
26/3/18,6850
26/3/18,47294
26/3/18,27552
26/3/18,8694
26/3/18,496666
26/3/18,244860
26/3/18,57800
26/3/18,77934
26/3/18,1440641
26/3/18,44269
26/3/18,1154
26/3/18,59690
26/3/18,16487477
26/3/18,3417717
26/3/18,8726454
26/3/18,356973
26/3/18,8653
26/3/18,156505
26/3/18,3661289
26/3/18,6070949
26/3/18,15446
26/3/18,33404
26/3/18,166020
26/3/18,24809
26/3/18,5715
26/3/18,16790
26/3/18,72975
26/3/18,24512
26/3/18,997407
26/3/18,3064219
26/3/18,34604
26/3/18,1064172
26/3/18,9329
26/3/18,782
26/3/18,1673032
26/3/18,3488521
26/3/18,4468
26/3/18,12457
26/3/18,3706066
26/3/18,22819
26/3/18,949673
26/3/18,2065417
26/3/18,138612
26/3/18,2388435
26/3/18,14300
26/3/18,1172
26/3/18,18197
26/3/18,833006
26/3/18,20603
26/3/18,3036
26/3/18,7470
26/3/18,15877
26/3/18,144031
26/3/18,5026054
26/3/18,4230
26/3/18,56407
26/3/18,1402
26/3/18,1701846
26/3/18,277453
26/3/18,22017
26/3/18,2008197
26/3/18,486568
26/3/18,1772385
26/3/18,12083475
26/3/18,18246
26/3/18,199685
26/3/18,12635
26/3/18,510178
26/3/18,110402
26/3/18,905823
26/3/18,632396
26/3/18,2784
26/3/18,7086
26/3/18,730
26/3/18,407389
26/3/18,59234
26/3/18,3616
26/3/18,281080
26/3/18,1219
26/3/18,28212
26/3/18,457257
26/3/18,414466
26/3/18,6752
26/3/18,1431441
26/3/18,18195
26/3/18,66706
26/3/18,26394
26/3/18,507428
26/3/18,5419
26/3/18,29999
26/3/18,1340918
26/3/18,13862433
26/3/18,1424560
26/3/18,25142
26/3/18,1126811
26/3/18,138247
26/3/18,4672749
26/3/18,1329773
26/3/18,16693
26/3/18,100
26/3/18,23223
26/3/18,43220
26/3/18,3308024
26/3/18,924513
26/3/18,373224
26/3/18,33523
26/3/18,30198
2/4/18,575
2/4/18,2422668
2/4/18,1072260
2/4/18,54212
2/4/18,2864
2/4/18,390376
2/4/18,22878
2/4/18,114382
2/4/18,73740
2/4/18,286425
2/4/18,26906
2/4/18,1906747
2/4/18,6100023
2/4/18,17366
2/4/18,40221
2/4/18,3649176
2/4/18,72788
2/4/18,205837
2/4/18,2412566
2/4/18,9385
2/4/18,6133828
2/4/18,895138
2/4/18,12145
2/4/18,33977
2/4/18,166578
2/4/18,18333
2/4/18,38
2/4/18,439401
2/4/18,23222
2/4/18,16986
2/4/18,17722
2/4/18,18064
2/4/18,57229
2/4/18,290503
2/4/18,15379
2/4/18,3826
2/4/18,101964
2/4/18,8645
2/4/18,415793
2/4/18,954070
2/4/18,72125
2/4/18,102363
2/4/18,1017516
2/4/18,5052772
2/4/18,3314440
2/4/18,25087
2/4/18,1742
2/4/18,20513
2/4/18,42010
2/4/18,4436
2/4/18,73185
2/4/18,28949
2/4/18,474217
2/4/18,44170
2/4/18,245952
2/4/18,119192
2/4/18,1763
2/4/18,1711148
2/4/18,24547
2/4/18,7935120
2/4/18,7595569
2/4/18,640147
2/4/18,1038
2/4/18,48838577
2/4/18,2600697
2/4/18,196
2/4/18,55056
2/4/18,1001736
2/4/18,6989
2/4/18,54063
2/4/18,11944
2/4/18,6711538
2/4/18,1209215
2/4/18,10217
2/4/18,174563
2/4/18,1254239
2/4/18,689404
2/4/18,3437827
2/4/18,393080
2/4/18,4437032
2/4/18,19105
2/4/18,17699
2/4/18,69919
2/4/18,323257
2/4/18,99236
2/4/18,244203
2/4/18,8979
2/4/18,422184
2/4/18,4871
2/4/18,22319
2/4/18,25894
2/4/18,2453624
2/4/18,1302
2/4/18,696799
2/4/18,40439
2/4/18,1412965
2/4/18,16035
2/4/18,156919
2/4/18,7303
2/4/18,2776646
2/4/18,1728988
2/4/18,1968500
2/4/18,2731
2/4/18,520040
2/4/18,2212662
2/4/18,15521788
2/4/18,138575
2/4/18,40851
2/4/18,371998
2/4/18,20721
2/4/18

2025-01-20 21:44:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:44:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:44:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:44:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 21:44:16 - snowflake.connector.connection - INFO - closed
2025-01-20 21:44:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:44:17 - root - INFO - SQL:
SELECT MAX("sales") AS "max_sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    LIMIT 1000
Results:
max_sales
69763805

2025-01-20 21:44:17 - root - INFO - itercount: 0
2025-01-20 21:44:17 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `WEEKLY_SALES`

  - **"week_date"**: Used to filter data around mid-June for the years 2018, 2019, and 2020.
  - **"sales"**: Used to calculate total sales amounts for the specified periods.
  - **"transactions"**: Could be used to analyze the number of transactions during the periods.
  - **"region"**: May be used to compare sales performance across different regions.
  - **"platform"**: Could be utilized to examine sales on various platforms.
  - **"segment"**: Useful for analyzing sales by customer segment.
  - **"customer_type"**: Helps in differentiating sales between new and returning customers.

**Conditions that may be used:**

- Filtering "week_date" to include four weeks before and after June 15 for each year.
- Extracting the year from "week_date" to focus on 2018, 2019, and 2020.
- Converting "week_date" from string to date format using `TO_DATE` if necessary.

---

**SQL Queries:**

1. **Get distinct years from the "week_date" column:**

   ```sql
   SELECT DISTINCT EXTRACT(YEAR FROM TO_DATE("week_date", 'YYYY-MM-DD')) AS "year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   LIMIT 1000;
   ```

2. **List all "week_date" values around mid-June for the specified years:**

   ```sql
   SELECT "week_date"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-05-18' AND '2018-07-13'
      OR TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2019-05-17' AND '2019-07-12'
      OR TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY "week_date"
   LIMIT 1000;
   ```

3. **Retrieve total sales for each "week_date":**

   ```sql
   SELECT "week_date", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY "week_date"
   LIMIT 1000;
   ```

4. **Get total transactions for each "week_date":**

   ```sql
   SELECT "week_date", SUM("transactions") AS "total_transactions"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY "week_date"
   LIMIT 1000;
   ```

5. **Select sales data for four weeks before and after June 15, 2018:**

   ```sql
   SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-05-18' AND '2018-07-13'
   ORDER BY "week_date"
   LIMIT 1000;
   ```

6. **Select sales data for four weeks before and after June 15, 2019:**

   ```sql
   SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2019-05-17' AND '2019-07-12'
   ORDER BY "week_date"
   LIMIT 1000;
   ```

7. **Select sales data for four weeks before and after June 15, 2020:**

   ```sql
   SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY "week_date"
   LIMIT 1000;
   ```

8. **List distinct "region" values:**

   ```sql
   SELECT DISTINCT "region"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   LIMIT 1000;
   ```

9. **Get total sales by "region" for June 2020:**

   ```sql
   SELECT "region", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'YYYY-MM-DD')) = 2020
     AND EXTRACT(MONTH FROM TO_DATE("week_date", 'YYYY-MM-DD')) = 6
   GROUP BY "region"
   LIMIT 1000;
   ```

10. **Retrieve "platform" usage during the specified periods:**

    ```sql
    SELECT DISTINCT "platform"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2018-05-18' AND '2020-07-10'
    LIMIT 1000;
    ```

11. **Get total sales by "customer_type" for weeks around mid-June 2019:**

    ```sql
    SELECT "customer_type", SUM("sales") AS "total_sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2019-05-17' AND '2019-07-12'
    GROUP BY "customer_type"
    LIMIT 1000;
    ```

12. **Check "segment" distribution in the sales data:**

    ```sql
    SELECT DISTINCT "segment"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    LIMIT 1000;
    ```

13. **Analyze average sales per transaction around mid-June 2020:**

    ```sql
    SELECT "week_date", AVG("sales" / NULLIF("transactions", 0)) AS "avg_sale_per_transaction"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'YYYY-MM-DD') BETWEEN '2020-05-15' AND '2020-07-10'
    GROUP BY "week_date"
    ORDER BY "week_date"
    LIMIT 1000;
    ```

14. **List "week_date" and corresponding "sales" for all data:**

    ```sql
    SELECT "week_date", "sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    ORDER BY "week_date"
    LIMIT 1000;
    ```

15. **Find the maximum "sales" value in the dataset:**

    ```sql
    SELECT MAX("sales") AS "max_sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    LIMIT 1000;
    ```

---

These queries help in understanding the data within the `WEEKLY_SALES` table, specifically focusing on sales performance around mid-June for the years 2018, 2019, and 2020. The queries explore various aspects such as date formats, sales figures, regional data, customer segments, and platforms used.Query:
SELECT "week_date"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000;
Answer:
Too long, hard cut:
week_date
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4
Query:
SELECT "week_date"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
      OR TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Answer:
Too long, hard cut:
week_date
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
21/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
28/5/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4/6/18
4
Query:
SELECT "week_date", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Answer:
week_date,total_sales
26/3/18,536755452
2/4/18,541167115
9/4/18,529574544
16/4/18,526355503
23/4/18,536075195
30/4/18,539632290
7/5/18,534072854
14/5/18,527788555
21/5/18,522377362
28/5/18,544417653
4/6/18,525086015
11/6/18,533259779
18/6/18,524368733
25/6/18,525737676
2/7/18,532366710
9/7/18,546769795
16/7/18,541086855
23/7/18,547653578
30/7/18,539321534
6/8/18,549636536
13/8/18,543535235
20/8/18,544330787
27/8/18,553039709
3/9/18,552971362
25/3/19,581317054
1/4/19,592780894
8/4/19,604578468
15/4/19,549169512
22/4/19,574707247
29/4/19,578911200
6/5/19,580698026
13/5/19,571234200
20/5/19,561098180
27/5/19,564501406
3/6/19,561091415
10/6/19,563298795
17/6/19,559088818
24/6/19,555374893
1/7/19,559413335
8/7/19,578449344
15/7/19,571261970
22/7/19,578808584
29/7/19,573703558
5/8/19,575209431
12/8/19,573749878
19/8/19,576006984
26/8/19,580274015
2/9/19,581305293
23/3/20,638197506
30/3/20,600898723
6/4/20,585551930
13/4/20,606143272
20/4/20,571874343
27/4/20,589783021
4/5/20,601398593
11/5/20,586547402
18/5/20,585008090
25/5/20,589120804
1/6/20,585466073
8/6/20,586283390
15/6/20,570025348
22/6/20,583242828
29/6/20,575390599
6/7/20,590335394
13/7/20,585936402
20/7/20,580874115
27/7/20,576349635
3/8/20,565709853
10/8/20,580024393
17/8/20,581075406
24/8/20,593379892
31/8/20,591603888
Query:
SELECT "week_date", SUM("transactions") AS "total_transactions"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   GROUP BY "week_date"
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Answer:
week_date,total_transactions
26/3/18,14467968
2/4/18,14461826
9/4/18,14335920
16/4/18,13764983
23/4/18,14264852
30/4/18,14804758
7/5/18,14433880
14/5/18,14402634
21/5/18,14300704
28/5/18,14334709
4/6/18,14191769
11/6/18,14301607
18/6/18,14239928
25/6/18,14276206
2/7/18,14254080
9/7/18,14433509
16/7/18,14423378
23/7/18,14630429
30/7/18,14517411
6/8/18,14664250
13/8/18,14650155
20/8/18,14630533
27/8/18,14866086
3/9/18,14754885
25/3/19,15599753
1/4/19,15718438
8/4/19,14400139
15/4/19,14348926
22/4/19,15173759
29/4/19,15338880
6/5/19,15619179
13/5/19,15236869
20/5/19,15168724
27/5/19,15118746
3/6/19,14969739
10/6/19,15184213
17/6/19,15188595
24/6/19,15053941
1/7/19,15119644
8/7/19,15268352
15/7/19,15221658
22/7/19,15351786
29/7/19,15287256
5/8/19,15333509
12/8/19,15341256
19/8/19,15427601
26/8/19,15627105
2/9/19,15541217
23/3/20,15178626
30/3/20,16071484
6/4/20,15805256
13/4/20,16204763
20/4/20,15011474
27/4/20,15652491
4/5/20,16242601
11/5/20,15781030
18/5/20,15762846
25/5/20,15685376
1/6/20,15558889
8/6/20,15577446
15/6/20,15535593
22/6/20,15643201
29/6/20,15618916
6/7/20,15662181
13/7/20,15580840
20/7/20,15618702
27/7/20,15579960
3/8/20,15118406
10/8/20,15619562
17/8/20,15643949
24/8/20,15829512
31/8/20,15830547
Query:
SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2018-07-13'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Answer:
Too long, hard cut:
week_date,sales
21/5/18,30578
21/5/18,8194
21/5/18,66910
21/5/18,22258
21/5/18,22503
21/5/18,30899
21/5/18,4624567
21/5/18,1053586
21/5/18,3147089
21/5/18,989314
21/5/18,50422
21/5/18,9952
21/5/18,15823156
21/5/18,469536
21/5/18,208
21/5/18,2172498
21/5/18,56322
21/5/18,5758040
21/5/18,2919
21/5/18,305373
21/5/18,10714
21/5/18,4987285
21/5/18,68428
21/5/18,380245
21/5/18,128
21/5/18,56913
21/5/18,12902
21/5/18,3678765
21/5/18,2430418
21/5/18,21068
21/5/18,108399
21/5/18,22031
21/5/18,311368
21/5/18,8835
21/5/18,31963
21/5/18,4289215
21/5/18,2199
21/5/18,178002
21/5/18,2490585
21/5/18,3832060
21/5/18,31573
21/5/18,630759
21/5/18,60857
21/5/18,188138
21/5/18,12337
21/5/18,3867192
21/5/18,25019
21/5/18,32938
21/5/18,64370
21/5/18,1362599
21/5/18,1042819
21/5/18,20596
21/5/18,93234
21/5/18,161280
21/5/18,2491437
21/5/18,396
21/5/18,399064
21/5/18,1631475
21/5/18,9100851
21/5/18,3580630
21/5/18,1851
21/5/18,40530
21/5/18,17267796
21/5/18,27477
21/5/18,3016196
21/5/18,14807
21/5/18,61201495
21/5/18,924826
21/5/18,133107
21/5/18,2303519
21/5/18,3440414
21/5/18,41139
21/5/18,67916
21/5/18,575772
21/5/18,7410092
21/5/18,19333
21/5/18,134079
21/5/18,2159936
21/5/18,14001
21/5/18,372903
21/5/18,327279
21/5/18,2144631
21/5/18,43782
21/5/18,4658478
21/5/18,54304
21/5/18,105674
21/5/18,62492
21/5/18,20920
21/5/18,46473593
21/5/18,2652286
21/5/18,735845
21/5/18,1440638
21/5/18,218928
21/5/18,305004
21/5/18,274179
21/5/18,6606
21/5/18,462670
21/5/18,3645951
21/5/18,160714
21/5/18,5932781
21/5/18,68159
21/5/18,927931
21/5/18,3637
21/5/18,24854
21/5/18,19220
21/5/18,2309
21/5/18,5261
21/5/18,1628991
21/5/18,25121884
21/5/18,533422
21/5/18,3588849
21/5/18,6351481
21/5/18,1146
21/5/18,266997
21/5/18,8524
21/5/18,894408
21/5/18,12438
21/5/18,8713
21/5/18,390234
21/5/18,267586
21/5/18,1225
21/5/18,94247
21/5/18,1953405
21/5/18,39546
21/5/18,110858
21/5/18,23435
21/5/18,38115
21/5/18,820002
21/5/18,760233
21/5/18,451
21/5/18,432398
21/5/18,1583716
21/5/18,1133844
21/5/18,4415258
21/5/18,3284958
21/5/18,8566788
21/5/18,37171
21/5/18,13251767
21/5/18,72944
21/5/18,41562
21/5/18,2891882
21/5/18,19049028
21/5/18,285117
21/5/18,211545
21/5/18,815811
21/5/18,15947
21/5/18,3241
21/5/18,178776
21/5/18,42666
21/5/18,15907
21/5/18,8014
21/5/18,5072090
21/5/18,971075
21/5/18,40773
21/5/18,179574
21/5/18,3130
21/5/18,141719
21/5/18,11454192
21/5/18,20306
21/5/18,1803724
21/5/18,18770
21/5/18,67817
21/5/18,1082258
21/5/18,24811
21/5/18,28470
21/5/18,37955
21/5/18,3630092
21/5/18,16578
21/5/18,8842
21/5/18,211345
21/5/18,7781097
21/5/18,2419
21/5/18,10170
21/5/18,7490
21/5/18,2264303
21/5/18,2149075
21/5/18,611755
21/5/18,34346
21/5/18,169166
21/5/18,17997
21/5/18,27476
21/5/18,796546
21/5/18,72545
21/5/18,448723
21/5/18,7668
21/5/18,1220141
21/5/18,3394
21/5/18,1235
21/5/18,372575
21/5/18,256678
21/5/18,7948
21/5/18,810850
21/5/18,939230
21/5/18,856064
21/5/18,13395441
21/5/18,37301
21/5/18,615671
21/5/18,2366617
21/5/18,66796
21/5/18,1586
21/5/18,25427
21/5/18,4631
21/5/18,16486757
21/5/18,5391
21/5/18,927659
21/5/18,30725
21/5/18,933
21/5/18,14961019
21/5/18,44818650
21/5/18,30662
21/5/18,3210
21/5/18,3980
21/5/18,196339
21/5/18,16556
21/5/18,71897
21/5/18,194622
21/5/18,2050
21/5/18,31371
21/5/18,1637482
21/5/18,11637390
21/5/18,9989
21/5/18,4549120
21/5/18,2053556
21/5/18,660500
21/5/18,22992
21/5/18,6577
21/5/18,1398357
21/5/18,2423606
21/5/18,1347670
21/5/18,523208
21/5/18,302861
21/5/18,5211031
21/5/18,497388
21/5/18,539286
21/5/18,8815
21/5/18,2048
21/5/18,4527
28/5/18,1693322
28/5/18,76060
28/5/18,38039
28/5/18,1148273
28/5/18,5170653
28/5/18,529834
28/5/18,44086
28/5/18,2231123
28/5/18,69503
28/5/18,1438
28/5/18,32827
28/5/18,601405
28/5/18,10187
28/5/18,149134
28/5/18,4152648
28/5/18,402822
28/5/18,3754776
28/5/18,656497
28/5/18,3959951
28/5/18,25524
28/5/18,737
28/5/18,365
28/5/18,27200
28/5/18,10454
28/5/18,2326746
28/5/18,30909
28/5/18,830383
28/5/18,53804
28/5/18,81985
28/5/18,332124
28/5/18,8126
28/5/18,26995
28/5/18,46899443
28/5/18,13702321
28/5/18,572145
28/5/18,1096227
28/5/18,2198177
28/5/18,577899
28/5/18,33395
28/5/18,26449
28/5/18,18235
28/5/18,4581513
28/5/18,315994
28/5/18,1867
28/5/18,1698018
28/5/18,46741
28/5/18,11976
28/5/18,1998
28/5/18,16177
28/5/18,2544642
28/5/18,3071
28/5/18,2475
28/5/18,5601
28/5/18,1457927
28/5/18,674759
28/5/18,3841
28/5/18,835812
28/5/18,5062331
28/5/18,463544
28/5/18,322146
28/5/18,79663
28/5/18,7460
28/5/18,91863
28/5/18,36997
28/5/18,606987
28/5/18,190814
28/5/18,4759954
28/5/18,24015
28/5/18,4137
28/5/18,8866637
28/5/18,67708
28/5/18,64986
28/5/18,32948
28/5/18,3001
28/5/18,285777
28/5/18,566401
28/5/18,2326315
28/5/18,10163
28/5/18,3278109
28/5/18,4490779
28/5/18,15432
28/5/18,3500242
28/5/18,2551781
28/5/18,7897
28/5/18,425238
28/5/18,429109
28/5/18,72543
28/5/18,17808
28/5/18,311280
28/5/18,1731029
28/5/18,83148
28/5/18,37566
28/5/18,25654
28/5/18,7583169
28/5/18,110972
28/5/18,228815
28/5/18,18529
28/5/18,1644
28/5/18,1651
28/5/18,4732694
28/5/18,318004
28/5/18,12146474
28/5/18,9
Query:
SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Answer:
Too long, hard cut:
week_date,sales
20/5/19,14580487
20/5/19,958524
20/5/19,4152692
20/5/19,295055
20/5/19,373005
20/5/19,243650
20/5/19,30802
20/5/19,80231
20/5/19,2496378
20/5/19,13276
20/5/19,58469
20/5/19,15086
20/5/19,17472257
20/5/19,458961
20/5/19,3012349
20/5/19,486684
20/5/19,2494603
20/5/19,61148
20/5/19,1856
20/5/19,13368941
20/5/19,1559525
20/5/19,7317748
20/5/19,29399
20/5/19,8077600
20/5/19,39987
20/5/19,10984
20/5/19,31358
20/5/19,12016285
20/5/19,1069622
20/5/19,1983386
20/5/19,2959326
20/5/19,463480
20/5/19,2508520
20/5/19,18562180
20/5/19,34406
20/5/19,24486
20/5/19,13361
20/5/19,2307851
20/5/19,2689
20/5/19,7986
20/5/19,69959
20/5/19,439283
20/5/19,333331
20/5/19,822276
20/5/19,5198620
20/5/19,2322501
20/5/19,2158907
20/5/19,1921370
20/5/19,24363
20/5/19,614901
20/5/19,263569
20/5/19,21089
20/5/19,240721
20/5/19,9091
20/5/19,5708
20/5/19,3499613
20/5/19,9940
20/5/19,30466
20/5/19,2303175
20/5/19,35109
20/5/19,603618
20/5/19,102942
20/5/19,3927
20/5/19,21095771
20/5/19,96341
20/5/19,762
20/5/19,264828
20/5/19,1480
20/5/19,693
20/5/19,2115562
20/5/19,7272
20/5/19,364278
20/5/19,26801
20/5/19,3260782
20/5/19,40857
20/5/19,1550810
20/5/19,82669
20/5/19,2457
20/5/19,10807
20/5/19,11091
20/5/19,429
20/5/19,48464
20/5/19,51195
20/5/19,28404
20/5/19,11704
20/5/19,386810
20/5/19,1375604
20/5/19,3213361
20/5/19,40418
20/5/19,1067703
20/5/19,746891
20/5/19,5471678
20/5/19,3341829
20/5/19,361462
20/5/19,1054545
20/5/19,3906
20/5/19,119971
20/5/19,15202
20/5/19,632337
20/5/19,9967
20/5/19,667358
20/5/19,996172
20/5/19,233025
20/5/19,1301934
20/5/19,1219
20/5/19,114339
20/5/19,25805
20/5/19,877361
20/5/19,9509
20/5/19,1309540
20/5/19,761
20/5/19,21801
20/5/19,31382
20/5/19,4909455
20/5/19,1377196
20/5/19,28207017
20/5/19,1547401
20/5/19,25075
20/5/19,48837957
20/5/19,4249
20/5/19,163287
20/5/19,4454659
20/5/19,415923
20/5/19,15443
20/5/19,805348
20/5/19,15808311
20/5/19,6715
20/5/19,15430
20/5/19,64241
20/5/19,835598
20/5/19,19830
20/5/19,322146
20/5/19,147156
20/5/19,85920
20/5/19,4515254
20/5/19,339159
20/5/19,6350295
20/5/19,2215666
20/5/19,1283
20/5/19,898738
20/5/19,44912
20/5/19,52824
20/5/19,32460
20/5/19,2718
20/5/19,1150
20/5/19,39819
20/5/19,5498455
20/5/19,13395
20/5/19,8342
20/5/19,11623
20/5/19,376681
20/5/19,91623
20/5/19,193618
20/5/19,12225
20/5/19,605674
20/5/19,5613
20/5/19,80512
20/5/19,31843
20/5/19,342282
20/5/19,102535
20/5/19,49927
20/5/19,1685866
20/5/19,2204
20/5/19,25173
20/5/19,763224
20/5/19,6976999
20/5/19,1220796
20/5/19,21980
20/5/19,4325275
20/5/19,5522407
20/5/19,271159
20/5/19,654684
20/5/19,24874
20/5/19,3208119
20/5/19,133111
20/5/19,68001
20/5/19,2668
20/5/19,939368
20/5/19,154009
20/5/19,115386
20/5/19,38939
20/5/19,12411
20/5/19,15329192
20/5/19,927631
20/5/19,27759
20/5/19,45260
20/5/19,1313097
20/5/19,10162950
20/5/19,64340543
20/5/19,145957
20/5/19,17348953
20/5/19,191196
20/5/19,614999
20/5/19,235493
20/5/19,1936014
20/5/19,9754
20/5/19,298931
20/5/19,8517612
20/5/19,23187
20/5/19,1130692
20/5/19,965579
20/5/19,173246
20/5/19,45355725
20/5/19,5296763
20/5/19,2083
20/5/19,1069
20/5/19,14219
20/5/19,541797
20/5/19,10323635
20/5/19,17406
20/5/19,564051
20/5/19,35286
20/5/19,4413002
20/5/19,560410
20/5/19,667340
20/5/19,611
20/5/19,21172
20/5/19,37461
20/5/19,218
20/5/19,32303
20/5/19,35539
20/5/19,52872
20/5/19,2188303
20/5/19,4030
20/5/19,47769
20/5/19,4574
20/5/19,3173771
20/5/19,57682
20/5/19,3295143
20/5/19,38388
20/5/19,30252
20/5/19,227255
20/5/19,5873495
20/5/19,213308
20/5/19,2293459
20/5/19,98467
20/5/19,2390065
20/5/19,83117
27/5/19,1343869
27/5/19,1131882
27/5/19,2664099
27/5/19,209191
27/5/19,10429
27/5/19,10133729
27/5/19,965719
27/5/19,30095
27/5/19,19743
27/5/19,23095
27/5/19,3404361
27/5/19,3210013
27/5/19,323889
27/5/19,17553
27/5/19,102369
27/5/19,11908
27/5/19,129910
27/5/19,666626
27/5/19,938078
27/5/19,8196299
27/5/19,5526
27/5/19,1106037
27/5/19,39410
27/5/19,2362584
27/5/19,11341
27/5/19,110605
27/5/19,47061
27/5/19,3014466
27/5/19,21477926
27/5/19,23205
27/5/19,59846
27/5/19,351038
27/5/19,2699
27/5/19,15061
27/5/19,3357654
27/5/19,246592
27/5/19,47258
27/5/19,1143743
27/5/19,28766028
27/5/19,7960
27/5/19,342157
27/5/19,53135
27/5/19,44367
27/5/19,45373
27/5/19,480
27/5/19,404818
27/5/19,747297
27/5/19,13176
27/5/19,1579930
27/5/19,23017
27/5/19,1059
27/5/19,15565079
27/5/19,8358
27/5/19,12302
27/5/19,5466006
27/5/19,19961
27/5/19,72329
27/5/19,2860
27/5/19,68404
27/5/19,1898654
27/5/19,24469
27/5/19,13461
27/5/19,234798
27/5/19,1956247
27/5/19,2098106
27/5/19,877272
27/5/19,916053
27/5/19,537728
27/5/19,10731
27/5/19,820896
27/5/19,39207
27/5/19,261402
27/5/19,73836
27/5/19,20327
27/5/19,4516588
27/5/19,270440
27/5/19,257014
27/5/19,1368641
27/5/19,1717
27/5/19,360861
27/5/19,5104
27/5/19,15446
27/5/19,2248577
27/5/19,780923
27/5/19,1363770
27/5/19,89293
27/5/19,858756
27/5/19,1593860
27/5/19,44008
27/5/19,28467
27/5/19,462638
27/5/19,22389
27/5/19,11200
27/5/19,176135
27/5/19,11186
27/5/19,3769
27/5/19,4281816
27/5/19,5815
27/5/19,3473394
27/5/19,39030
27/5
Query:
SELECT "week_date", "sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
   ORDER BY TO_DATE("week_date", 'DD/MM/YY')
   LIMIT 1000
Answer:
Too long, hard cut:
week_date,sales
18/5/20,13502
18/5/20,31967
18/5/20,907257
18/5/20,27642
18/5/20,802055
18/5/20,1303250
18/5/20,13996
18/5/20,2006122
18/5/20,5918845
18/5/20,47653
18/5/20,32220
18/5/20,747640
18/5/20,13412
18/5/20,2137229
18/5/20,939066
18/5/20,789634
18/5/20,408215
18/5/20,11595
18/5/20,3624839
18/5/20,34101
18/5/20,8614840
18/5/20,26133
18/5/20,7531190
18/5/20,18360291
18/5/20,4618567
18/5/20,480498
18/5/20,407517
18/5/20,30045
18/5/20,6723137
18/5/20,3181673
18/5/20,16097
18/5/20,20396901
18/5/20,863512
18/5/20,47270
18/5/20,2599
18/5/20,39477
18/5/20,1258891
18/5/20,1602793
18/5/20,2100027
18/5/20,1758894
18/5/20,383797
18/5/20,3334217
18/5/20,21419
18/5/20,1306
18/5/20,282150
18/5/20,2210786
18/5/20,88372
18/5/20,11017216
18/5/20,1447820
18/5/20,254131
18/5/20,54615
18/5/20,2763891
18/5/20,2666444
18/5/20,11298
18/5/20,49309503
18/5/20,20031
18/5/20,190616
18/5/20,1011014
18/5/20,634015
18/5/20,16718027
18/5/20,269246
18/5/20,2851231
18/5/20,5577831
18/5/20,793
18/5/20,1109858
18/5/20,49090
18/5/20,11043793
18/5/20,915413
18/5/20,42638
18/5/20,293977
18/5/20,1986987
18/5/20,446036
18/5/20,76494
18/5/20,33872
18/5/20,155355
18/5/20,897722
18/5/20,16652063
18/5/20,4801310
18/5/20,405243
18/5/20,270980
18/5/20,518467
18/5/20,954785
18/5/20,3887
18/5/20,1280896
18/5/20,4956551
18/5/20,23920
18/5/20,361882
18/5/20,858130
18/5/20,1041064
18/5/20,33079
18/5/20,4559208
18/5/20,465393
18/5/20,27544
18/5/20,44786
18/5/20,55710
18/5/20,12427
18/5/20,2143224
18/5/20,3358384
18/5/20,12524
18/5/20,52738
18/5/20,3247033
18/5/20,39618
18/5/20,4394
18/5/20,935950
18/5/20,16562
18/5/20,1834416
18/5/20,359051
18/5/20,4052
18/5/20,758167
18/5/20,14498529
18/5/20,1765
18/5/20,39994
18/5/20,22785
18/5/20,2588654
18/5/20,123920
18/5/20,2146858
18/5/20,535805
18/5/20,1172060
18/5/20,87706
18/5/20,2342
18/5/20,109364
18/5/20,8066
18/5/20,258708
18/5/20,77180
18/5/20,19294
18/5/20,14592
18/5/20,5354
18/5/20,1330104
18/5/20,7445
18/5/20,53463
18/5/20,30940
18/5/20,2502063
18/5/20,34920
18/5/20,9204042
18/5/20,616473
18/5/20,243183
18/5/20,7584111
18/5/20,15037298
18/5/20,5161179
18/5/20,10807
18/5/20,5062985
18/5/20,854624
18/5/20,98181
18/5/20,465648
18/5/20,25609
18/5/20,30026087
18/5/20,6165599
18/5/20,3566897
18/5/20,119937
18/5/20,266727
18/5/20,19672
18/5/20,3352
18/5/20,29915
18/5/20,119530
18/5/20,141441
18/5/20,9188
18/5/20,44493573
18/5/20,4719
18/5/20,835929
18/5/20,1671
18/5/20,1685671
18/5/20,64211904
18/5/20,6931
18/5/20,124572
18/5/20,3900
18/5/20,53175
18/5/20,214428
18/5/20,22377941
18/5/20,130015
18/5/20,1952
18/5/20,66634
18/5/20,522563
18/5/20,811341
18/5/20,5342
18/5/20,1268
18/5/20,600119
18/5/20,34915
18/5/20,64714
18/5/20,73718
18/5/20,6517112
18/5/20,5180
18/5/20,395124
18/5/20,5376453
18/5/20,262445
18/5/20,12755
18/5/20,364412
18/5/20,2272218
18/5/20,2667
18/5/20,46560
18/5/20,52205
18/5/20,3036
18/5/20,27920
18/5/20,101218
18/5/20,33358
18/5/20,553428
18/5/20,152602
18/5/20,3474692
18/5/20,446379
18/5/20,6485
18/5/20,429979
18/5/20,617637
18/5/20,49587
18/5/20,4193
18/5/20,8518
18/5/20,40431
18/5/20,7421
18/5/20,2181810
18/5/20,16232292
18/5/20,991
18/5/20,993855
18/5/20,42583
18/5/20,2390319
18/5/20,1448578
18/5/20,845405
18/5/20,461278
18/5/20,1429280
18/5/20,62387
18/5/20,19570
18/5/20,15073
18/5/20,218
18/5/20,44550
18/5/20,2284891
18/5/20,14872
18/5/20,66849
18/5/20,11704
18/5/20,27513
18/5/20,62635
18/5/20,2397635
18/5/20,1704710
18/5/20,1919
18/5/20,36469
18/5/20,11356688
18/5/20,451976
18/5/20,5879139
18/5/20,66955
18/5/20,96732
18/5/20,127924
18/5/20,20850
25/5/20,971467
25/5/20,5892963
25/5/20,27475
25/5/20,50861380
25/5/20,8488121
25/5/20,1669
25/5/20,52847
25/5/20,6593576
25/5/20,13595
25/5/20,435734
25/5/20,127974
25/5/20,30110314
25/5/20,35632
25/5/20,273334
25/5/20,5001925
25/5/20,44026
25/5/20,30990
25/5/20,135954
25/5/20,53119
25/5/20,44266
25/5/20,803263
25/5/20,45385
25/5/20,58215
25/5/20,46409881
25/5/20,137901
25/5/20,320
25/5/20,6730
25/5/20,2058255
25/5/20,92035
25/5/20,2596974
25/5/20,2559410
25/5/20,108432
25/5/20,49873
25/5/20,140241
25/5/20,26409
25/5/20,2081122
25/5/20,1444579
25/5/20,125540
25/5/20,572226
25/5/20,1734583
25/5/20,1884396
25/5/20,128601
25/5/20,536321
25/5/20,3324021
25/5/20,7530875
25/5/20,2001324
25/5/20,27436
25/5/20,724522
25/5/20,2188678
25/5/20,625019
25/5/20,5745300
25/5/20,3459907
25/5/20,31126
25/5/20,857113
25/5/20,452686
25/5/20,524469
25/5/20,313931
25/5/20,270446
25/5/20,407944
25/5/20,59847
25/5/20,142137
25/5/20,57340
25/5/20,17471175
25/5/20,866297
25/5/20,257137
25/5/20,2095617
25/5/20,15046
25/5/20,12923
25/5/20,605686
25/5/20,1812967
25/5/20,507294
25/5/20,43451
25/5/20,44069
25/5/20,846554
25/5/20,2289378
25/5/20,1467
25/5/20,114907
25/5/20,29908
25/5/20,1414121
25/5/20,5827
25/5/20,12345
25/5/20,638483
25/5/20,5195267
25/5/20,1133335
25/5/20,22248935
25/5/20,21550
25/5/20,878454
25/5/20,9356
25/5/20,6381581
25/5/20,2055441
25/5/20,270166
25/5/20,402203
25/5/20,650
25/5/20,30541
25/5/20,1457714
25/5/20,482176
25/5/20,7185403
25/5/20,2548
Query:
SELECT DISTINCT "region"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   LIMIT 1000
Answer:
region
ASIA
USA
EUROPE
AFRICA
CANADA
SOUTH AMERICA
OCEANIA
Query:
SELECT "region", SUM("sales") AS "total_sales"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020
     AND EXTRACT(MONTH FROM TO_DATE("week_date", 'DD/MM/YY')) = 6
   GROUP BY "region"
   LIMIT 1000
Answer:
region,total_sales
OCEANIA,951984238
USA,277763625
SOUTH AMERICA,87360985
EUROPE,47351180
ASIA,658863091
CANADA,174745093
AFRICA,702340026
Query:
SELECT DISTINCT "platform"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
   WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-18' AND '2020-07-10'
   LIMIT 1000
Answer:
platform
Shopify
Retail
Query:
SELECT "customer_type", SUM("sales") AS "total_sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-17' AND '2019-07-12'
    GROUP BY "customer_type"
    LIMIT 1000
Answer:
customer_type,total_sales
Existing,2244717300
New,572303089
Guest,1685295797
Query:
SELECT DISTINCT "segment"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    LIMIT 1000
Answer:
segment
C3
F1
""
C1
C2
F3
C4
F2
Query:
SELECT "week_date", AVG("sales" / NULLIF("transactions", 0)) AS "avg_sale_per_transaction"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    WHERE TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-15' AND '2020-07-10'
    GROUP BY "week_date"
    ORDER BY TO_DATE("week_date", 'DD/MM/YY')
    LIMIT 1000
Answer:
week_date,avg_sale_per_transaction
18/5/20,100.394368815126
25/5/20,101.589432205882
1/6/20,100.081979781513
8/6/20,106.493251983193
15/6/20,106.978040394958
22/6/20,111.207363684874
29/6/20,108.803958336134
6/7/20,113.065789176471
Query:
SELECT "week_date", "sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    ORDER BY TO_DATE("week_date", 'DD/MM/YY')
    LIMIT 1000
Answer:
Too long, hard cut:
week_date,sales
26/3/18,29626
26/3/18,5108834
26/3/18,7485775
26/3/18,124933
26/3/18,708935
26/3/18,5422
26/3/18,906090
26/3/18,5472
26/3/18,8019043
26/3/18,21366
26/3/18,7672
26/3/18,17610630
26/3/18,63275082
26/3/18,614397
26/3/18,243347
26/3/18,16207
26/3/18,12440
26/3/18,96481
26/3/18,2673553
26/3/18,661150
26/3/18,8967057
26/3/18,12931
26/3/18,30367
26/3/18,1040046
26/3/18,6020419
26/3/18,985673
26/3/18,299943
26/3/18,1864
26/3/18,6622
26/3/18,105791
26/3/18,8662
26/3/18,21902
26/3/18,172745
26/3/18,56134
26/3/18,2567272
26/3/18,44597
26/3/18,28717
26/3/18,3558
26/3/18,64646
26/3/18,18647
26/3/18,350417
26/3/18,2602065
26/3/18,3725387
26/3/18,25388649
26/3/18,273302
26/3/18,40430
26/3/18,2640811
26/3/18,68811
26/3/18,2219869
26/3/18,103774
26/3/18,16007398
26/3/18,3700047
26/3/18,3890763
26/3/18,3886146
26/3/18,23524
26/3/18,183903
26/3/18,1617709
26/3/18,16153
26/3/18,12966045
26/3/18,32217
26/3/18,45998717
26/3/18,1011432
26/3/18,20746
26/3/18,433400
26/3/18,695014
26/3/18,4050
26/3/18,336688
26/3/18,2257802
26/3/18,15517900
26/3/18,195225
26/3/18,18631509
26/3/18,3587
26/3/18,3179568
26/3/18,39900
26/3/18,5116495
26/3/18,4641508
26/3/18,2247059
26/3/18,24767
26/3/18,70305
26/3/18,5453458
26/3/18,2682773
26/3/18,310853
26/3/18,29525
26/3/18,4158055
26/3/18,55808
26/3/18,2072
26/3/18,25673
26/3/18,571887
26/3/18,873
26/3/18,66813
26/3/18,172470
26/3/18,168817
26/3/18,190895
26/3/18,1878628
26/3/18,677
26/3/18,12133134
26/3/18,66505
26/3/18,60871
26/3/18,463292
26/3/18,4724108
26/3/18,2326726
26/3/18,4478715
26/3/18,999080
26/3/18,48209562
26/3/18,2316915
26/3/18,185209
26/3/18,1122918
26/3/18,300
26/3/18,16993
26/3/18,51682
26/3/18,105019
26/3/18,20877
26/3/18,9124
26/3/18,763772
26/3/18,24476
26/3/18,1692383
26/3/18,260211
26/3/18,2183
26/3/18,69581
26/3/18,8839
26/3/18,303272
26/3/18,811158
26/3/18,2729
26/3/18,2428945
26/3/18,41866
26/3/18,168280
26/3/18,6864699
26/3/18,787254
26/3/18,403
26/3/18,523000
26/3/18,6850
26/3/18,47294
26/3/18,27552
26/3/18,8694
26/3/18,496666
26/3/18,244860
26/3/18,57800
26/3/18,77934
26/3/18,1440641
26/3/18,44269
26/3/18,1154
26/3/18,59690
26/3/18,16487477
26/3/18,3417717
26/3/18,8726454
26/3/18,356973
26/3/18,8653
26/3/18,156505
26/3/18,3661289
26/3/18,6070949
26/3/18,15446
26/3/18,33404
26/3/18,166020
26/3/18,24809
26/3/18,5715
26/3/18,16790
26/3/18,72975
26/3/18,24512
26/3/18,997407
26/3/18,3064219
26/3/18,34604
26/3/18,1064172
26/3/18,9329
26/3/18,782
26/3/18,1673032
26/3/18,3488521
26/3/18,4468
26/3/18,12457
26/3/18,3706066
26/3/18,22819
26/3/18,949673
26/3/18,2065417
26/3/18,138612
26/3/18,2388435
26/3/18,14300
26/3/18,1172
26/3/18,18197
26/3/18,833006
26/3/18,20603
26/3/18,3036
26/3/18,7470
26/3/18,15877
26/3/18,144031
26/3/18,5026054
26/3/18,4230
26/3/18,56407
26/3/18,1402
26/3/18,1701846
26/3/18,277453
26/3/18,22017
26/3/18,2008197
26/3/18,486568
26/3/18,1772385
26/3/18,12083475
26/3/18,18246
26/3/18,199685
26/3/18,12635
26/3/18,510178
26/3/18,110402
26/3/18,905823
26/3/18,632396
26/3/18,2784
26/3/18,7086
26/3/18,730
26/3/18,407389
26/3/18,59234
26/3/18,3616
26/3/18,281080
26/3/18,1219
26/3/18,28212
26/3/18,457257
26/3/18,414466
26/3/18,6752
26/3/18,1431441
26/3/18,18195
26/3/18,66706
26/3/18,26394
26/3/18,507428
26/3/18,5419
26/3/18,29999
26/3/18,1340918
26/3/18,13862433
26/3/18,1424560
26/3/18,25142
26/3/18,1126811
26/3/18,138247
26/3/18,4672749
26/3/18,1329773
26/3/18,16693
26/3/18,100
26/3/18,23223
26/3/18,43220
26/3/18,3308024
26/3/18,924513
26/3/18,373224
26/3/18,33523
26/3/18,30198
2/4/18,575
2/4/18,2422668
2/4/18,1072260
2/4/18,54212
2/4/18,2864
2/4/18,390376
2/4/18,22878
2/4/18,114382
2/4/18,73740
2/4/18,286425
2/4/18,26906
2/4/18,1906747
2/4/18,6100023
2/4/18,17366
2/4/18,40221
2/4/18,3649176
2/4/18,72788
2/4/18,205837
2/4/18,2412566
2/4/18,9385
2/4/18,6133828
2/4/18,895138
2/4/18,12145
2/4/18,33977
2/4/18,166578
2/4/18,18333
2/4/18,38
2/4/18,439401
2/4/18,23222
2/4/18,16986
2/4/18,17722
2/4/18,18064
2/4/18,57229
2/4/18,290503
2/4/18,15379
2/4/18,3826
2/4/18,101964
2/4/18,8645
2/4/18,415793
2/4/18,954070
2/4/18,72125
2/4/18,102363
2/4/18,1017516
2/4/18,5052772
2/4/18,3314440
2/4/18,25087
2/4/18,1742
2/4/18,20513
2/4/18,42010
2/4/18,4436
2/4/18,73185
2/4/18,28949
2/4/18,474217
2/4/18,44170
2/4/18,245952
2/4/18,119192
2/4/18,1763
2/4/18,1711148
2/4/18,24547
2/4/18,7935120
2/4/18,7595569
2/4/18,640147
2/4/18,1038
2/4/18,48838577
2/4/18,2600697
2/4/18,196
2/4/18,55056
2/4/18,1001736
2/4/18,6989
2/4/18,54063
2/4/18,11944
2/4/18,6711538
2/4/18,1209215
2/4/18,10217
2/4/18,174563
2/4/18,1254239
2/4/18,689404
2/4/18,3437827
2/4/18,393080
2/4/18,4437032
2/4/18,19105
2/4/18,17699
2/4/18,69919
2/4/18,323257
2/4/18,99236
2/4/18,244203
2/4/18,8979
2/4/18,422184
2/4/18,4871
2/4/18,22319
2/4/18,25894
2/4/18,2453624
2/4/18,1302
2/4/18,696799
2/4/18,40439
2/4/18,1412965
2/4/18,16035
2/4/18,156919
2/4/18,7303
2/4/18,2776646
2/4/18,1728988
2/4/18,1968500
2/4/18,2731
2/4/18,520040
2/4/18,2212662
2/4/18,15521788
2/4/18,138575
2/4/18,40851
2/4/18,371998
2/4/18,20721
2/4/18
Query:
SELECT MAX("sales") AS "max_sales"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
    LIMIT 1000
Answer:
max_sales
69763805
End Exploring Related Columns
Task: For weekly-sales data, I need an analysis of our sales performance around mid-June for the years 2018, 2019, and 2020. Specifically, calculate the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year,Percentage_Change
2018,percentage_change1:float
2019,percentage_change2:float
2020,percentage_change3:float
```

This table shows the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each of the years 2018, 2019, and 2020..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 21:45:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:45:32 - root - INFO - ```sql
WITH sales_data AS (
  SELECT
    TO_DATE("week_date", 'DD/MM/YY') AS "week_date",
    "sales",
    EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) AS "Year",
    CASE
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2018 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-21' AND '2018-06-11' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2018 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-06-18' AND '2018-07-09' THEN 'After'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2019 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-20' AND '2019-06-10' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2019 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-06-17' AND '2019-07-08' THEN 'After'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-18' AND '2020-06-08' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-06-15' AND '2020-07-06' THEN 'After'
      ELSE NULL
    END AS "Period"
  FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
  WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) IN (2018, 2019, 2020)
),
aggregated_sales AS (
  SELECT
    "Year",
    "Period",
    SUM("sales") AS "total_sales"
  FROM sales_data
  WHERE "Period" IS NOT NULL
  GROUP BY "Year", "Period"
),
sales_totals AS (
  SELECT
    "Year",
    SUM(CASE WHEN "Period" = 'Before' THEN "total_sales" ELSE 0 END) AS "before_sales",
    SUM(CASE WHEN "Period" = 'After' THEN "total_sales" ELSE 0 END) AS "after_sales"
  FROM aggregated_sales
  GROUP BY "Year"
)
SELECT
  "Year",
  ROUND((("after_sales" - "before_sales") / ("before_sales" * 1.0)) * 100, 4) AS "Percentage_Change"
FROM sales_totals
ORDER BY "Year";
```
2025-01-20 21:45:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:45:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:45:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:45:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 21:45:34 - snowflake.connector.connection - INFO - closed
2025-01-20 21:45:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:45:34 - root - INFO - itercount: 1
2025-01-20 21:45:34 - root - INFO - 0
2025-01-20 21:45:34 - root - INFO - results: 
Year,Percentage_Change
2018,0.1930
2019,0.1038
2020,-1.1460


2025-01-20 21:45:34 - root - INFO - Please check the answer again by reviewing For weekly-sales data, I need an analysis of our sales performance around mid-June for the years 2018, 2019, and 2020. Specifically, calculate the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year,Percentage_Change
2018,percentage_change1:float
2019,percentage_change2:float
2020,percentage_change3:float
```

This table shows the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each of the years 2018, 2019, and 2020. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Percentage_Change
2018,0.1930
2019,0.1038
2020,-1.1460
Current sql:
WITH sales_data AS (
  SELECT
    TO_DATE("week_date", 'DD/MM/YY') AS "week_date",
    "sales",
    EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) AS "Year",
    CASE
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2018 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-21' AND '2018-06-11' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2018 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-06-18' AND '2018-07-09' THEN 'After'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2019 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-20' AND '2019-06-10' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2019 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-06-17' AND '2019-07-08' THEN 'After'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-18' AND '2020-06-08' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-06-15' AND '2020-07-06' THEN 'After'
      ELSE NULL
    END AS "Period"
  FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
  WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) IN (2018, 2019, 2020)
),
aggregated_sales AS (
  SELECT
    "Year",
    "Period",
    SUM("sales") AS "total_sales"
  FROM sales_data
  WHERE "Period" IS NOT NULL
  GROUP BY "Year", "Period"
),
sales_totals AS (
  SELECT
    "Year",
    SUM(CASE WHEN "Period" = 'Before' THEN "total_sales" ELSE 0 END) AS "before_sales",
    SUM(CASE WHEN "Period" = 'After' THEN "total_sales" ELSE 0 END) AS "after_sales"
  FROM aggregated_sales
  GROUP BY "Year"
)
SELECT
  "Year",
  ROUND((("after_sales" - "before_sales") / ("before_sales" * 1.0)) * 100, 4) AS "Percentage_Change"
FROM sales_totals
ORDER BY "Year";
2025-01-20 21:45:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:45:56 - root - INFO - ```sql
WITH sales_data AS (
  SELECT
    TO_DATE("week_date", 'DD/MM/YY') AS "week_date",
    "sales",
    EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) AS "Year",
    CASE
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2018 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-05-21' AND '2018-06-11' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2018 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2018-06-18' AND '2018-07-09' THEN 'After'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2019 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-05-20' AND '2019-06-10' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2019 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2019-06-17' AND '2019-07-08' THEN 'After'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-05-18' AND '2020-06-08' THEN 'Before'
      WHEN EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) = 2020 AND TO_DATE("week_date", 'DD/MM/YY') BETWEEN '2020-06-15' AND '2020-07-06' THEN 'After'
      ELSE NULL
    END AS "Period"
  FROM BANK_SALES_TRADING.BANK_SALES_TRADING.WEEKLY_SALES
  WHERE EXTRACT(YEAR FROM TO_DATE("week_date", 'DD/MM/YY')) IN (2018, 2019, 2020)
),
aggregated_sales AS (
  SELECT
    "Year",
    "Period",
    SUM("sales") AS "total_sales"
  FROM sales_data
  WHERE "Period" IS NOT NULL
  GROUP BY "Year", "Period"
),
sales_totals AS (
  SELECT
    "Year",
    SUM(CASE WHEN "Period" = 'Before' THEN "total_sales" ELSE 0 END) AS "before_sales",
    SUM(CASE WHEN "Period" = 'After' THEN "total_sales" ELSE 0 END) AS "after_sales"
  FROM aggregated_sales
  GROUP BY "Year"
)
SELECT
  "Year",
  ROUND((("after_sales" - "before_sales") / ("before_sales" * 1.0)) * 100, 4) AS "Percentage_Change"
FROM sales_totals
ORDER BY "Year";
```
2025-01-20 21:45:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:45:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:45:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:45:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 21:45:58 - snowflake.connector.connection - INFO - closed
2025-01-20 21:45:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:45:58 - root - INFO - itercount: 2
2025-01-20 21:45:58 - root - INFO - 0
2025-01-20 21:45:58 - root - INFO - Total iteration counts: 2
