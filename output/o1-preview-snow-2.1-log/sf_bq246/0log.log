2025-01-25 02:07:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.407350 seconds
2025-01-25 02:08:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:08:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:32 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:32 - root - INFO - SQL:
SELECT "id", "country", "date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT
   LIMIT 100;
Results:
id,country,date
10344281,US,2019-07-09
9474645,US,2016-10-25
9479570,US,2016-10-25
9486813,US,2016-11-08
5057059,US,1991-10-15
5074671,US,1991-12-24
10656777,US,2020-05-19
10666644,US,2020-05-26
6234740,US,2001-05-22
7512243,US,2009-03-31
7164498,US,2007-01-16
7174122,US,2007-02-06
7186324,US,2007-03-06
8492017,US,2013-07-23
6553983,US,2003-04-29
4422278,US,1983-12-27
4425606,US,1984-01-10
4442535,US,1984-04-10
8134762,US,2012-03-13
8150953,US,2012-04-03
8151122,US,2012-04-03
8165443,US,2012-04-24
7808473,US,2010-10-05
7841634,US,2010-11-30
10030960,US,2018-07-24
5363127,US,1994-11-08
5373076,US,1994-12-13
5378413,US,1995-01-03
5653487,US,1997-08-05
5662141,US,1997-09-02
5668911,US,1997-09-16
4117719,US,1978-10-03
10378734,US,2019-08-13
9131017,US,2015-09-08
9158050,US,2015-10-13
9493487,US,2016-11-15
5985453,US,1999-11-16
5987826,US,1999-11-23
5078092,US,1992-01-07
5094861,US,1992-03-10
8850084,US,2014-09-30
8856870,US,2014-10-07
7523193,US,2009-04-21
7533418,US,2009-05-12
7543795,US,2009-06-09
7202787,US,2007-04-10
7206064,US,2007-04-17
7211120,US,2007-05-01
6282039,US,2001-08-28
6291847,US,2001-09-18
10703593,US,2020-07-07
10713772,US,2020-07-14
10716605,US,2020-07-21
7842768,US,2010-11-30
7854310,US,2010-12-21
5388421,US,1995-02-14
10426455,US,2019-10-01
9829476,US,2017-11-28
9163705,US,2015-10-20
6589870,US,2003-07-08
5700827,US,1997-12-23
11008739,US,2021-05-18
11021242,US,2021-06-01
9528527,US,2016-12-27
10051255,US,2018-08-14
5128176,US,1992-07-07
8867032,US,2014-10-21
8869218,US,2014-10-21
8877355,US,2014-11-04
10329695,US,2019-06-25
9461635,US,2016-10-04
6849840,US,2005-02-01
6856787,US,2005-02-15
6860217,US,2005-03-01
10655141,US,2020-05-19
10655672,US,2020-05-19
10655873,US,2020-05-19
5956560,US,1999-09-21
8795420,US,2014-08-05
8798165,US,2014-08-05
8805232,US,2014-08-12
8808524,US,2014-08-19
8808529,US,2014-08-19
7486780,US,2009-02-03
7512101,US,2009-03-31
7177726,US,2007-02-13
7187105,US,2007-03-06
8154397,US,2012-04-10
10009279,US,2018-06-26
10029417,US,2018-07-24
10992919,US,2021-04-27
5348645,US,1994-09-20
5649251,US,1997-07-15
5676831,US,1997-10-14
10372928,US,2019-08-06
9125191,US,2015-09-01
5975734,US,1999-11-02
5993050,US,1999-11-30
6000370,US,1999-12-14
6003851,US,1999-12-21

2025-01-25 02:08:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:34 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:34 - root - INFO - SQL:
SELECT "patent_id", "date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
   LIMIT 100;
Results:
patent_id,application_date
D405116,1990-07-23
D366645,1990-10-15
D378332,1991-03-13
D385355,1992-11-18
D389797,1993-01-05
D386167,1993-02-23
D385268,1993-03-02
D391736,1993-03-08
D385547,1993-04-30
D388563,1994-03-08
D386745,1994-06-20
D392380,1994-07-07
D394702,1994-09-02
D383997,1994-09-13
D395436,1994-09-14
D385561,1994-09-30
D400899,1994-11-07
D396186,1994-11-10
D395936,1994-12-02
D386174,1994-12-22
D389272,1994-12-29
D384746,1995-01-04
D390387,1995-01-19
D385156,1995-02-09
D392799,1995-02-17
D396101,1995-03-01
D387354,1995-03-14
D387923,1995-03-21
D388471,1995-03-24
D383965,1995-03-24
D402202,1995-03-27
D403421,1995-03-29
D388197,1995-03-31
D394721,1995-04-17
D386702,1995-04-18
D390028,1995-04-21
D386268,1995-05-03
D388095,1995-05-05
D393005,1995-05-08
D383911,1995-05-09
D384916,1995-05-15
D401924,1995-06-01
D387236,1995-06-07
D387143,1995-06-09
D394051,1995-06-12
D385386,1995-06-16
D389664,1995-06-16
D385951,1995-06-27
D401358,1995-06-29
D395253,1995-06-29
D402064,1995-06-30
D384415,1995-06-30
D395040,1995-07-07
D386555,1995-07-10
D391128,1995-07-11
D395923,1995-07-14
D397792,1995-07-26
D394704,1995-07-26
D388172,1995-07-27
D388987,1995-08-02
D384020,1995-08-03
D395446,1995-08-04
D385909,1995-08-04
D389144,1995-08-07
D391347,1995-08-11
D385507,1995-08-11
D386531,1995-08-14
D390339,1995-08-17
D384655,1995-08-18
D391383,1995-08-23
D392343,1995-08-24
D385074,1995-09-05
D395983,1995-09-08
D386377,1995-09-11
D394951,1995-09-11
D385598,1995-09-14
D399102,1995-09-21
D400545,1995-09-21
D384131,1995-09-22
D388880,1995-09-25
D383973,1995-09-27
D390767,1995-10-03
D384025,1995-10-03
D397663,1995-10-03
D384108,1995-10-06
D387903,1995-10-13
D386630,1995-10-16
D393397,1995-10-16
D387924,1995-10-17
D391451,1995-10-18
D389095,1995-10-20
D399235,1995-10-20
D388057,1995-10-20
D389094,1995-10-20
D391440,1995-10-23
D386732,1995-10-23
D384969,1995-10-24
D387034,1995-10-25
D387516,1995-10-26
D384441,1995-10-27

2025-01-25 02:08:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:36 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:36 - root - INFO - SQL:
SELECT p."id", p."country", a."date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT p
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
   WHERE p."country" = 'US'
   LIMIT 100;
Results:
id,country,application_date
D396456,US,1994-01-21
D394631,US,1994-08-02
D388775,US,1994-09-01
D391947,US,1995-05-05
D392963,US,1995-05-05
D384418,US,1995-05-19
D388136,US,1995-06-05
D385266,US,1995-09-08
D397064,US,1995-09-27
D394722,US,1995-12-13
D403435,US,1995-12-21
D388528,US,1996-01-22
D399212,US,1996-02-09
D391948,US,1996-02-14
D384439,US,1996-02-29
D386744,US,1996-03-01
D384435,US,1996-03-27
D386360,US,1996-04-23
D385353,US,1996-04-29
D389840,US,1996-04-30
D383936,US,1996-05-07
D388444,US,1996-05-23
D396284,US,1996-05-29
D386367,US,1996-05-31
D386870,US,1996-06-07
D384946,US,1996-07-09
D387926,US,1996-07-19
D387281,US,1996-07-19
D395202,US,1996-07-22
D385463,US,1996-08-16
D386325,US,1996-08-20
D391786,US,1996-08-21
D394093,US,1996-08-22
D394588,US,1996-08-26
D392007,US,1996-08-27
D403186,US,1996-08-29
D387007,US,1996-09-06
D386133,US,1996-09-11
D395364,US,1996-09-13
D392144,US,1996-09-18
D386818,US,1996-09-30
D391580,US,1996-10-16
D385862,US,1996-10-17
D401184,US,1996-10-22
D393522,US,1996-10-22
D389286,US,1996-10-25
D391656,US,1996-11-08
D401340,US,1996-11-12
D402384,US,1996-11-15
D388840,US,1996-11-18
D397862,US,1996-11-22
D395356,US,1996-11-27
D391516,US,1996-11-29
D393911,US,1996-12-05
D397095,US,1996-12-09
D386736,US,1996-12-17
D391687,US,1996-12-24
D394322,US,1997-01-06
D399997,US,1997-01-06
D400324,US,1997-01-10
D390986,US,1997-01-14
D392519,US,1997-01-15
D394561,US,1997-01-29
D388381,US,1997-02-12
D392303,US,1997-02-14
D403091,US,1997-02-18
D387763,US,1997-02-24
D392959,US,1997-02-26
D393899,US,1997-02-28
D393049,US,1994-08-18
D388460,US,1994-11-28
D392622,US,1995-03-28
D387207,US,1995-05-10
D397157,US,1995-08-04
D384021,US,1995-09-05
D383906,US,1995-10-11
D396755,US,1995-11-03
D394000,US,1995-11-20
D390967,US,1996-01-02
D384111,US,1996-01-04
D383891,US,1996-01-11
D397677,US,1996-01-29
D391215,US,1996-03-07
D393638,US,1996-03-08
D389526,US,1996-03-15
D384819,US,1996-03-22
D385531,US,1996-03-26
D384444,US,1996-04-08
D401861,US,1996-04-30
D394225,US,1996-05-06
D397167,US,1996-05-14
D385529,US,1996-05-15
D391542,US,1996-05-23
D402621,US,1996-05-24
D389444,US,1996-05-24
D386176,US,1996-05-31
D386509,US,1996-06-07
D387035,US,1996-06-10
D392711,US,1996-06-20
D388830,US,1996-06-25

2025-01-25 02:08:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:38 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:38 - root - INFO - SQL:
SELECT "patent_id", "citation_id"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   LIMIT 100;
Results:
patent_id,citation_id
4233808,524
5418423,H60
5445606,H71
4671363,1482
4295314,1887
5666885,1931
D283714,4174
5048848,7345
4612868,8164
5611671,8834
5009345,9837
D311841,D392
4815385,H162
5798553,H204
5561678,H275
4911487,H358
5221744,H531
5940597,H586
5211875,H724
6073962,H767
5349364,H880
5651474,H943
5224658,11368
5090897,13387
D316160,15211
D395737,17748
4588302,19413
4665741,21487
5514166,22080
D358251,22456
5920920,23335
5941231,24840
4568320,24874
5030203,25129
5794810,26188
5013461,26709
4729321,29995
5005259,31574
5239018,32136
5248309,32649
5060706,32693
D350403,34792
D377562,34991
4688727,35036
5479861,36773
5329869,37849
4101419,39150
6327797,39575
4239460,39974
5228705,40921
3962925,41574
D452982,43931
5714098,45178
5875785,45258
4669324,46056
5727698,46296
D441147,46579
4360315,50705
6113158,52010
D327304,53426
5429831,56217
4269417,56326
4702856,59724
5015399,61880
4437634,63383
5570971,64757
4678011,66631
5354077,68558
4967939,69485
6099490,70683
4146982,70849
4858867,70884
5141236,73006
4394803,74707
4488381,76755
4018394,77102
5067396,77884
6044570,79052
4676772,79436
D396895,81947
D405235,83973
4112838,86045
D404519,86101
5571229,87015
5667122,88505
4574977,90036
4096853,90217
4901645,90732
5383675,90837
D304074,92049
6344226,92640
4598447,94503
4867255,94854
5666885,95705
6164033,97316
D415547,98439
D266832,D2599
D365016,D3310
D394355,D3570
D390318,D4336

2025-01-25 02:08:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:41 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:41 - root - INFO - SQL:
SELECT c."patent_id", c."citation_id", cited_app."date" AS "cited_application_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   LIMIT 100;
Results:
patent_id,citation_id,cited_application_date
8620900,6976025,2002-04-01
11030408,6976031,2000-02-23
11080232,6976039,2001-05-25
9971784,6976039,2001-05-25
9507617,6976059,2000-07-20
10540159,6976079,2000-09-29
10116738,6976090,2001-02-16
9338523,6976090,2001-02-16
9986419,6976090,2001-02-16
8902915,6976095,1999-12-30
9032132,6976105,2002-12-11
9788215,6976160,2002-02-22
10285094,6976160,2002-02-22
9509682,6976164,2000-07-19
9641490,6976165,1999-09-07
9189392,6976190,2002-07-31
10459710,6976193,2001-09-20
9852205,6976210,2000-08-29
9256664,6976210,2000-08-29
8849850,6976210,2000-08-29
8739302,6976259,2000-09-29
9339074,6976321,2003-11-07
10865545,6976325,2003-11-25
10617227,6976348,2004-10-20
10113823,6976416,2003-01-22
10556720,6976438,2003-08-07
8447648,6976439,2003-01-16
10736304,6976452,2003-10-14
10087357,6976542,2003-10-03
D724696,6976543,2004-01-23
10286409,6976543,2004-01-23
10152624,6976626,2003-01-12
10002272,6976631,2003-05-21
8713829,6976660,2003-12-11
9169821,6976683,2003-08-25
8857387,6976683,2003-08-25
D704600,6976697,2003-05-15
9126417,6976753,2003-12-04
9954993,6976799,2003-03-12
10351229,6976829,2003-07-16
10213160,6976857,2005-07-14
10268014,6976867,2004-01-28
8648932,6976954,2002-06-28
9775529,6976958,2004-02-06
8499252,6976958,2004-02-06
9775567,6976965,2002-09-19
8936021,6976969,2002-01-14
9913776,6976969,2002-01-14
9339425,6976978,2002-01-25
9492315,6976982,2002-01-09
9687263,6976983,2003-06-12
10449330,6976987,2003-06-30
9050141,6976988,2002-08-19
10208468,6977005,2003-07-15
9670351,6977105,2000-09-22
10557691,6977140,2000-03-29
8815513,6977148,2001-10-15
9269648,6977188,2003-08-15
10472750,6977231,2000-01-21
11116717,6977250,2001-09-17
10799476,6977257,2002-04-24
8648197,6977265,2002-11-29
8791087,6977295,2000-04-21
9164099,6977305,2001-09-29
9126184,6977319,2004-03-12
8608889,6977324,2001-06-20
9554549,6977327,2004-01-30
11109546,6977351,2004-10-29
9904327,6977352,2005-03-01
10179730,6977468,2004-02-02
8882791,6977495,2004-01-16
10966744,6977495,2004-01-16
9872725,6977495,2004-01-16
9287075,6977569,2004-08-11
8367991,6977598,2003-08-29
9244157,6977608,2004-12-15
10595574,6977615,2004-03-04
9401025,6977630,2000-07-18
8515132,6977643,2002-08-22
9083830,6977685,2000-02-25
10937755,6977686,2001-03-07
8923564,6977687,1998-10-07
8760576,6977690,2001-11-07
10218848,6977740,2000-03-29
9053727,6977789,2002-01-31
9245555,6977790,2002-05-03
9153283,6977793,2004-03-16
10205395,6977824,2004-08-09
8612670,6977847,2002-11-18
8947382,6977868,2002-02-14
9453742,6977868,2002-02-14
9913289,6977888,2000-09-14
8789201,6977894,1999-05-19
8520688,6977896,2000-06-05
9262225,6977939,2001-01-26
8976280,6977985,2002-12-17
8995641,6977992,2004-09-27
9906651,6977992,2004-09-27
10757262,6978006,2000-10-12
10218515,6978017,1997-10-14

2025-01-25 02:08:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:43 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:44 - root - INFO - SQL:
SELECT c."citation_id", c."patent_id" AS "citing_patent_id", citing_app."date" AS "citing_application_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   LIMIT 100;
Results:
citation_id,citing_patent_id,citing_application_date
6976025,8620900,2009-02-09
6976031,11030408,2019-02-15
6976039,11080232,2018-04-20
6976039,9971784,2015-08-03
6976059,9507617,2013-12-02
6976079,10540159,2017-09-29
6976090,10116738,2015-11-30
6976090,9338523,2009-12-21
6976090,9986419,2017-05-26
6976095,8902915,2012-09-24
6976105,9032132,2012-06-28
6976160,9788215,2011-11-07
6976160,10285094,2017-04-20
6976164,9509682,2015-01-07
6976165,9641490,2016-01-05
6976190,9189392,2011-06-30
6976193,10459710,2017-09-01
6976210,9852205,2014-10-16
6976210,9256664,2014-07-03
6976210,8849850,2013-06-28
6976259,8739302,2012-02-24
6976321,9339074,2015-03-17
6976325,10865545,2020-05-28
6976348,10617227,2018-03-07
6976416,10113823,2016-12-20
6976438,10556720,2018-12-20
6976439,8447648,2009-07-22
6976452,10736304,2019-10-18
6976542,10087357,2014-08-01
6976543,D724696,2013-10-01
6976543,10286409,2014-10-28
6976626,10152624,2017-03-09
6976631,10002272,2016-08-23
6976660,8713829,2013-01-29
6976683,9169821,2014-05-08
6976683,8857387,2011-11-22
6976697,D704600,2012-12-21
6976753,9126417,2014-10-06
6976799,9954993,2015-12-30
6976829,10351229,2015-03-12
6976857,10213160,2017-08-22
6976867,10268014,2018-10-05
6976954,8648932,2009-08-13
6976958,9775529,2009-09-14
6976958,8499252,2010-07-27
6976965,9775567,2015-12-22
6976969,8936021,2008-10-06
6976969,9913776,2014-07-28
6976978,9339425,2013-11-04
6976982,9492315,2011-08-05
6976983,9687263,2014-05-29
6976987,10449330,2013-10-15
6976988,9050141,2009-02-02
6977005,10208468,2016-03-29
6977105,9670351,2015-08-05
6977140,10557691,2017-11-15
6977148,8815513,2007-10-31
6977188,9269648,2014-12-04
6977231,10472750,2017-01-30
6977250,11116717,2020-04-01
6977257,10799476,2020-05-26
6977265,8648197,2012-03-26
6977295,8791087,2010-08-20
6977305,9164099,2013-05-08
6977319,9126184,2009-12-16
6977324,8608889,2006-06-08
6977327,9554549,2016-03-03
6977351,11109546,2019-05-09
6977352,9904327,2014-03-25
6977468,10179730,2016-12-08
6977495,8882791,2007-07-27
6977495,10966744,2018-10-25
6977495,9872725,2015-04-29
6977569,9287075,2015-03-27
6977598,8367991,2010-05-12
6977608,9244157,2013-06-17
6977615,10595574,2018-05-17
6977630,9401025,2015-09-21
6977643,8515132,2012-08-01
6977685,9083830,2012-09-15
6977686,10937755,2018-06-29
6977687,8923564,2014-02-10
6977690,8760576,2013-04-12
6977740,10218848,2014-09-04
6977789,9053727,2014-06-02
6977790,9245555,2014-11-03
6977793,9153283,2014-09-30
6977824,10205395,2016-11-15
6977847,8612670,2011-11-06
6977868,8947382,2012-02-28
6977868,9453742,2015-01-16
6977888,9913289,2015-11-25
6977894,8789201,2013-03-12
6977896,8520688,2009-10-05
6977939,9262225,2012-12-27
6977985,8976280,2011-07-06
6977992,8995641,2014-01-17
6977992,9906651,2017-01-24
6978006,10757262,2019-09-19
6978017,10218515,2016-08-26

2025-01-25 02:08:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:08:45 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:08:46 - root - INFO - SQL:
SELECT "patent_id", COUNT(*) AS "total_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   GROUP BY "patent_id"
   ORDER BY "total_backward_citations" DESC
   LIMIT 100;
Results:
patent_id,total_backward_citations
8892495,5828
11103241,5769
11090045,5684
11051807,5617
9980729,5444
11000274,5379
10945729,5320
10779825,5196
11026680,5162
10881399,5156
10695058,5065
10888322,5038
10716565,5037
10835249,4941
10959722,4730
10537325,4688
10765425,4620
10575868,4476
9986419,4468
11051811,4445
10463384,4380
10433844,4322
10368867,4285
10368864,4266
10485541,4266
10293100,4262
10271849,4233
10842491,4218
10245032,4212
10335148,4151
10390841,4142
10448948,4127
10433918,4120
10238391,4101
10625137,3937
10278780,3749
10172616,3708
10687810,3223
D896380,3216
10517599,3054
10765424,2878
10172619,2867
10117652,2756
10052100,2755
10028743,2725
9999426,2723
9901345,2717
9962158,2714
9974538,2713
9788836,2696
9592053,2638
9693777,2620
9585663,2605
9775609,2586
9962486,2573
8758323,2502
11120372,2464
10449416,2442
9804618,2436
9662110,2425
9700317,2401
9408604,2397
9749790,2395
9649111,2319
10791176,2277
9433419,2271
11096752,2170
10952788,2140
9253616,2118
10898256,2109
9668024,2096
11006971,2096
10709469,2091
9031581,2085
10966744,2083
9966068,2031
10185542,2030
11069510,2008
D922229,1996
9721566,1966
9886953,1965
10101822,1965
10679605,1936
10553209,1930
10675035,1921
10241644,1905
9760559,1893
9966065,1887
10078631,1881
10555769,1879
9483461,1864
10446141,1864
10463421,1850
10376305,1844
10312567,1816
9865911,1807
8403864,1783
8202231,1777
8763875,1777
8430828,1771

2025-01-25 02:08:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:08:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:08:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:08:52 - snowflake.connector.connection - INFO - closed
2025-01-25 02:08:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:09:42 - root - INFO - **Explanation:**

The error you're encountering:

```
100035 (22007): 01b9f020-0004-8038-0001-11c300f9f3b6: Timestamp '1968-05-00' is not recognized
```

indicates that there's an invalid date format in one of the records in the `APPLICATION` table. Specifically, the date `'1968-05-00'` is invalid because `'00'` is not a valid day in a date. This causes the `DATEDIFF` function to fail when it tries to process this date.

**Solution:**

To fix this issue, we need to ensure that we're only working with valid dates. We can use the `TRY_TO_DATE` function in Snowflake, which attempts to convert a string to a date and returns `NULL` if it fails. This allows us to filter out any records with invalid dates before performing date calculations.

Here's the corrected query:

```sql
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND ABS(DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date"))) <= 365
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 100;
```

**Explanation of Changes:**

- **Using `TRY_TO_DATE`:** The `TRY_TO_DATE` function attempts to convert a string to a date. If the conversion fails (due to an invalid date), it returns `NULL` instead of throwing an error.
- **Filtering Invalid Dates:** By adding `TRY_TO_DATE(citing_app."date") IS NOT NULL` and `TRY_TO_DATE(cited_app."date") IS NOT NULL` to the `WHERE` clause, we exclude any records where the date conversion failed.
- **Date Difference Calculation:** We use `TRY_TO_DATE` within the `DATEDIFF` function to ensure that it only processes valid dates.

**Next Steps to Solve the Original Task:**

1. **Identify the Patent with the Most Backward Citations within 1 Year:**

   Run the corrected query above to get a list of patents along with the count of their backward citations within 1 year from their application date.

   ```sql
   -- This query gives you the patent IDs and their counts
   SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
     AND TRY_TO_DATE(cited_app."date") IS NOT NULL
     AND ABS(DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date"))) <= 365
   GROUP BY c."patent_id"
   ORDER BY "recent_backward_citations" DESC
   LIMIT 1; -- Get the patent with the most citations
   ```

   Let's assume the patent ID returned is `'MOST_CITED_PATENT_ID'`.

2. **Calculate the Number of Forward Citations within 1 Year for that Patent:**

   Now, we'll find out how many times this patent was cited within 1 year from its application date.

   ```sql
   SELECT COUNT(*) AS "recent_forward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   WHERE c."citation_id" = 'MOST_CITED_PATENT_ID'
     AND TRY_TO_DATE(citing_app."date") IS NOT NULL
     AND TRY_TO_DATE(cited_app."date") IS NOT NULL
     AND ABS(DATEDIFF(day, TRY_TO_DATE(citing_app."date"), TRY_TO_DATE(cited_app."date"))) <= 365;
   ```

   Replace `'MOST_CITED_PATENT_ID'` with the actual patent ID obtained from the previous query.

3. **Provide the Final Answer:**

   Once you have the number of forward citations within 1 year for that patent, you can present it as per the required format.

   ```csv
   Number_of_Forward_Citations_within_1_year
   num_forward:int
   (Attention: answer in one row)
   ```

**Final Notes:**

- Ensure that you replace placeholders with actual values obtained from the queries.
- The steps above guide you through obtaining the required information despite the initial error.
- Always handle data types carefully, especially when dealing with data that may contain invalid or unexpected formats.
2025-01-25 02:09:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:09:46 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:11:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:11:36 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND ABS(DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date"))) <= 365
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 100;
Results:
patent_id,recent_backward_citations
10835249,309
10433918,244
10888322,235
10433844,229
8149048,204
7410468,199
7589029,182
10945729,179
11000274,143
10595835,143
10537325,141
10575868,140
10271849,137
10881399,136
10335148,136
10517599,136
10919230,127
10779825,121
11026680,120
10959722,114
10695058,99
8065713,98
10485541,97
9433419,97
10687810,94
8344088,92
7172614,91
10729402,90
10463421,86
11051811,86
7178236,85
10368867,85
7547321,85
10448948,85
9649111,85
8672844,83
D930961,81
9137739,81
10245032,80
9775545,80
10172616,80
11099380,79
8758323,79
9563733,77
10172619,77
7400155,76
8333710,74
10716565,74
8816402,72
7240728,72
9782077,70
10853181,70
7476925,69
D750632,69
8669595,68
7524910,68
9579039,67
9780834,67
9685992,67
9125667,65
8771183,64
D893843,63
D928799,63
7487529,62
9189392,62
8162853,60
9755842,60
9283076,60
D853924,60
7425215,60
10238391,60
9700317,60
10504185,59
11090045,59
8984740,58
9775609,57
7033352,57
D893838,57
9100457,57
6994160,57
9445759,56
10188348,55
RE45426,55
7287271,55
10409629,55
11103241,55
9510779,55
10449416,54
11114195,54
7017661,54
6263387,54
6202111,54
6976990,54
6212585,54
8952634,53
10770336,52
D920309,52
7398832,52
9858548,52
10447728,51

2025-01-25 02:11:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:11:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:11:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:11:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:11:40 - snowflake.connector.connection - INFO - closed
2025-01-25 02:11:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:11:41 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND ABS(DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date"))) <= 365
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 1
Results:
patent_id,recent_backward_citations
10835249,309

2025-01-25 02:11:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:11:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:11:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:11:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 02:11:42 - snowflake.connector.connection - INFO - closed
2025-01-25 02:11:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:12:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:12:51 - root - INFO - ```sql
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 1;
```
2025-01-25 02:12:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:12:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:12:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:12:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:12:54 - snowflake.connector.connection - INFO - closed
2025-01-25 02:12:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:14:11 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 1;
Results:
patent_id,recent_backward_citations
10835249,1130

2025-01-25 02:14:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:14 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:14 - root - INFO - SQL:
SELECT c."citation_id" AS "cited_patent_id", COUNT(*) AS "recent_forward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."citation_id"
ORDER BY "recent_forward_citations" DESC
LIMIT 100
Results:
cited_patent_id,recent_forward_citations
7732819,95
8939344,73
9192380,72
8275836,70
9307986,68
8870050,66
8973804,65
7411209,65
8657178,64
8479969,63
8820605,62
8573465,61
9028494,61
8573461,60
8602288,60
9055944,60
8747238,59
5572643,59
9101385,59
8800838,59
9072536,59
9084601,59
9808246,59
9072515,58
9027817,58
9138225,58
9125662,58
8053184,58
9204879,58
8899465,57
9005230,57
8616431,57
9226751,57
9192384,57
8998058,56
D725001,56
8453914,56
9351726,56
9095339,56
9398911,56
9277922,56
8991677,56
9131940,56
9149325,56
8794497,56
8763875,56
8490853,55
8453912,55
9186143,55
9282966,54
8783541,54
8672206,54
9345481,54
9232945,54
9283054,54
8496156,54
8939343,54
9307988,53
9113874,53
9358005,53
D722533,53
D732430,53
9179911,53
D724510,53
9520482,53
9358003,53
8925788,53
8844789,53
9282962,53
9451958,53
9113873,53
9370364,53
8636766,52
8561873,52
8256654,52
9372206,52
9326768,52
D736451,52
9204878,52
D739306,52
D739317,52
8602287,52
8517244,52
9119657,52
9445813,52
9271799,52
9332987,52
9326767,52
8328063,52
8752749,52
D732429,52
D726591,51
9272406,51
D732431,51
D730776,51
D716696,51
9351727,51
9326770,51
D718189,51
9326769,51

2025-01-25 02:14:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:18 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:19 - root - INFO - SQL:
SELECT c1."patent_id", COUNT(DISTINCT c1."citation_id") AS "recent_backward_citations", COUNT(DISTINCT c2."patent_id") AS "recent_forward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c1
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app1 ON c1."patent_id" = citing_app1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app1 ON c1."citation_id" = cited_app1."patent_id"
LEFT JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c2 ON c1."patent_id" = c2."citation_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app2 ON c2."patent_id" = citing_app2."patent_id"
WHERE TRY_TO_DATE(citing_app1."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app1."date") IS NOT NULL
  AND TRY_TO_DATE(citing_app2."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app1."date"), TRY_TO_DATE(citing_app1."date")) BETWEEN 0 AND 1825
  AND DATEDIFF(day, TRY_TO_DATE(cited_app1."date"), TRY_TO_DATE(citing_app2."date")) BETWEEN 0 AND 1825
GROUP BY c1."patent_id"
LIMIT 100
Results:
patent_id,recent_backward_citations,recent_forward_citations
3996797,1,1
9256852,2,1
D764375,10,2
4080586,1,1
D689296,3,1
6597764,2,1
D832488,3,1
5619821,1,1
8469865,1,1
7575144,43,15
6061350,2,2
6996427,58,17
D746366,88,8
5777324,6,4
8763157,3,2
6988193,2,2
D676479,7,3
6197595,13,5
4249374,1,2
5865791,29,4
D523779,1,2
9761974,1,1
D556038,2,2
D825192,2,2
6682529,2,2
5894575,2,1
7030174,5,1
7948076,1,1
D736231,8,1
7149741,1,2
5461664,5,2
5690652,2,1
5458464,5,3
4726322,1,1
6633630,4,1
7233816,2,6
7335528,1,1
D863343,84,10
8475450,2,1
6282568,7,3
7841408,62,10
5326256,1,1
7149627,2,3
9896806,7,2
6982034,1,1
7262555,4,2
6274220,3,1
6310627,1,3
5594486,3,2
D852213,9,2
6071495,1,1
5121168,4,3
6947897,5,2
4120124,3,1
9201736,1,3
6501052,76,3
7221586,96,2
7941768,1,4
8686680,3,1
D315299,1,1
7329672,2,1
6068752,23,11
8393422,2,1
7246748,3,1
5038865,5,1
5390432,1,1
8244547,1,1
D734144,18,2
5341311,1,2
5690525,1,1
D844217,2,1
7024174,11,2
8270835,2,1
5499082,5,1
8182443,43,4
6374177,5,6
D534438,1,1
4453324,1,1
9557434,3,1
6496416,3,1
4564135,1,2
D643849,7,1
6175925,17,8
D548365,1,1
8409152,15,1
5919138,5,4
7708424,1,1
9725478,2,1
6459969,7,3
9990481,3,1
7042258,4,1
10373259,96,2
6135842,4,1
5351297,6,1
5576218,1,1
D664079,1,1
D732536,3,1
6302733,1,1
7989991,1,1
4522048,1,1

2025-01-25 02:14:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:21 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:22 - root - INFO - SQL:
SELECT DISTINCT c."citation_id", TRY_TO_DATE(cited_app."date") AS "cited_application_date"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(cited_app."date") IS NOT NULL
LIMIT 100
Results:
citation_id,cited_application_date
9922084,2015-01-30
9923062,2016-03-01
9987979,2017-02-28
D244471,1975-10-14
D245212,1975-10-09
D245689,1976-04-28
9963125,2016-04-27
D247333,1976-09-07
9966190,2017-03-22
D271817,1980-06-04
D272547,1982-01-27
D249099,1976-10-29
D327886,1991-04-12
D263678,1979-11-07
D249911,1976-07-12
D262686,1979-04-20
D276590,1982-06-16
D279617,1983-01-10
D279664,1983-12-29
D296579,1986-01-06
D302111,1986-01-27
D308537,1987-04-07
D311833,1987-06-02
D320782,1989-07-31
D324543,1991-06-27
D329744,1990-03-30
D343030,1992-01-28
D345590,1993-01-08
D351915,1992-02-07
D364682,1994-08-10
D366079,1994-03-24
D374399,1994-03-02
D282599,1983-06-16
D320102,1989-04-13
D322383,1989-07-20
D325372,1989-12-15
D329362,1990-04-23
D338797,1991-06-14
D340407,1992-02-11
D348758,1993-03-03
D349925,1993-11-12
D356261,1992-10-22
D365133,1995-02-08
D392248,1996-03-12
D397996,1996-09-30
D303402,1986-01-21
D356567,1993-07-22
D258540,1978-12-04
D345334,1992-02-25
D362524,1994-02-22
D377091,1995-05-12
D392534,1997-03-21
D411561,1998-09-04
D352540,1993-05-13
D363975,1995-01-25
D415236,1998-06-19
D432753,1999-03-24
D453177,2001-04-30
D475823,2002-06-24
D429424,1999-07-23
D453388,2001-02-26
D481228,2002-01-09
D501378,2004-02-13
D514607,2003-09-05
D245557,1976-03-29
D257165,1978-09-05
D274827,1981-08-05
D288803,1984-08-20
D328617,1990-01-12
D336683,1990-05-18
D354610,1993-06-21
D371356,1994-09-14
D372364,1995-04-04
D324326,1989-10-12
D354729,1993-11-18
D379623,1996-02-12
D381124,1993-10-29
D397247,1997-11-20
D401304,1997-08-22
D404159,1997-07-10
D281874,1983-03-28
D302346,1988-06-20
D323561,1989-08-28
D332653,1990-06-12
D358548,1994-01-25
D360450,1994-03-07
D288515,1984-05-24
D315161,1989-11-13
D340158,1991-08-07
D348172,1993-09-07
D353906,1994-03-24
D355792,1992-05-01
D361540,1994-04-26
D367199,1994-11-04
D369037,1995-05-15
D375741,1995-09-08
D379256,1995-07-18
D384441,1995-10-27
D386168,1993-04-30
D388772,1997-02-21

2025-01-25 02:14:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:14:24 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:24 - root - INFO - SQL:
SELECT MIN(TRY_TO_DATE(cited_app."date")) AS "earliest_cited_application_date"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(cited_app."date") IS NOT NULL
Results:
earliest_cited_application_date
0975-11-06

2025-01-25 02:14:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:14:27 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:28 - root - INFO - SQL:
SELECT AVG("recent_backward_citations") AS "average_recent_backward_citations"
FROM (
  SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
  WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(cited_app."date") IS NOT NULL
    AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
  GROUP BY c."patent_id"
) sub
Results:
average_recent_backward_citations
4.741901

2025-01-25 02:14:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:31 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:32 - root - INFO - SQL:
SELECT p."id"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
LEFT JOIN (
  SELECT DISTINCT c."patent_id"
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
  WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(cited_app."date") IS NOT NULL
    AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
) recent_citations ON p."id" = recent_citations."patent_id"
WHERE recent_citations."patent_id" IS NULL
LIMIT 100
Results:
id
4025826
8384383
10214103
10245640
3963012
3973466
3975379
9348472
D265113
10588367
10591172
9375163
10866274
10868210
3986413
8682413
D579697
8367044
10297682
9758339
9414811
8713066
8721808
8745632
8746179
D900648
4942174
5929114
10227649
D366622
D407320
10591438
7382205
9727817
8048906
10869884
4903638
3990158
4006345
6177593
6183855
6187232
D530487
D599314
9058959
9759801
9410478
10898576
7409792
4018074
4022739
6459355
6829973
8778276
9336408
10559155
10560832
10840749
8014769
4868855
7696878
3952944
9371026
8315645
8318301
10572848
10600363
9385806
8024581
8032241
10883749
D613251
8377256
10622806
10282521
7207326
9854256
11017604
11018603
11033209
4140774
4157684
10344332
9474333
10998569
4093148
10372095
10388557
9156055
9516501
7845946
10403467
10430458
9836579
11013690
11039518
4134645
9553268
10047181
5122594

2025-01-25 02:14:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:35 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:36 - root - INFO - SQL:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "recent_forward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."citation_id"
ORDER BY "recent_forward_citations" DESC
LIMIT 100
Results:
patent_id,recent_forward_citations
7732819,95
8939344,73
9192380,72
8275836,70
9307986,68
8870050,66
7411209,65
8973804,65
8657178,64
8479969,63
8820605,62
9028494,61
8573465,61
8602288,60
9055944,60
8573461,60
9808246,59
9101385,59
8747238,59
8800838,59
9072536,59
9084601,59
5572643,59
9138225,58
9125662,58
9204879,58
9072515,58
9027817,58
8053184,58
9005230,57
9226751,57
9192384,57
8899465,57
8616431,57
9277922,56
9131940,56
8991677,56
9398911,56
8794497,56
8763875,56
9149325,56
9351726,56
8998058,56
D725001,56
9095339,56
8453914,56
9186143,55
8490853,55
8453912,55
8939343,54
8496156,54
9232945,54
9283054,54
9345481,54
9282966,54
8672206,54
8783541,54
9358003,53
9451958,53
9370364,53
D724510,53
8844789,53
9282962,53
9307988,53
9113873,53
D732430,53
D722533,53
9520482,53
9113874,53
9179911,53
9358005,53
8925788,53
9332987,52
D732429,52
D736451,52
9271799,52
D739317,52
8517244,52
9204878,52
8636766,52
8256654,52
8752749,52
9326768,52
9119657,52
9372206,52
8328063,52
9445813,52
9326767,52
8561873,52
8602287,52
D739306,52
9232979,51
5794207,51
9332984,51
9393015,51
D732431,51
9272406,51
D716696,51
9351727,51
D730776,51

2025-01-25 02:14:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:37 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:38 - root - INFO - SQL:
SELECT c."citation_id", cited_patent."country"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.PATENT cited_patent ON c."citation_id" = cited_patent."id"
WHERE cited_patent."country" = 'US'
LIMIT 100
Results:
citation_id,country
7214750,US
7215213,US
7215479,US
7216217,US
7216217,US
7216491,US
7216671,US
7216671,US
7216738,US
7217292,US
7217426,US
7218736,US
7218914,US
7218964,US
7218964,US
7219107,US
7219107,US
7219527,US
7219729,US
7219777,US
7219841,US
7219841,US
7220141,US
7221763,US
7221763,US
7221810,US
7222084,US
7222393,US
7223173,US
7223256,US
7223256,US
7223288,US
7223540,US
7223649,US
7223969,US
7224000,US
7225156,US
7225448,US
7225959,US
7225964,US
7225964,US
7225964,US
7225964,US
7225964,US
7225964,US
7225983,US
7226230,US
7227129,US
7227494,US
7227576,US
7227695,US
7228264,US
7228878,US
7229404,US
7229976,US
7231069,US
7231100,US
7231384,US
7231427,US
7232613,US
7233137,US
7233137,US
7233264,US
7233607,US
7233816,US
7233864,US
7233907,US
7234242,US
7234281,US
7234550,US
7235063,US
7235073,US
7235073,US
7235089,US
7235089,US
7235089,US
7235089,US
7235089,US
7235089,US
7235302,US
7235302,US
7235302,US
7235420,US
7235583,US
7235583,US
7235592,US
7235649,US
7235980,US
7236155,US
7236738,US
7236742,US
7236772,US
7236847,US
7237036,US
7237137,US
7237201,US
7238195,US
7238195,US
7238195,US
7238203,US

2025-01-25 02:14:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:39 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:40 - root - INFO - SQL:
SELECT "patent_id", MAX(TRY_TO_DATE("date")) AS "recent_application_date"
FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
WHERE TRY_TO_DATE("date") IS NOT NULL
GROUP BY "patent_id"
ORDER BY "recent_application_date" DESC
LIMIT 100
Results:
patent_id,recent_application_date
4732727,9186-04-03
4474874,9183-03-11
4255928,9178-12-11
4135654,9177-04-11
4041523,9176-06-01
3969699,9175-04-11
4010353,9174-09-11
3964954,9173-05-31
4032532,9173-03-01
4469216,8198-04-05
4198308,7978-07-21
4739365,2987-05-28
4725260,2987-03-24
4709214,2986-04-28
4596904,2984-05-25
4542062,2982-01-20
D245522,2976-07-29
4020425,2976-03-26
3943504,2975-02-25
11125411,2021-07-19
D931411,2021-07-15
D931924,2021-07-02
D931695,2021-06-28
D931696,2021-06-28
11118753,2021-06-25
11129295,2021-06-23
D931884,2021-06-22
D930813,2021-06-17
D930814,2021-06-17
11130503,2021-06-14
11127382,2021-06-14
D930375,2021-06-11
11109170,2021-06-10
11115759,2021-06-09
D931628,2021-06-08
11128963,2021-06-08
11125171,2021-06-07
D929993,2021-06-02
11133641,2021-06-01
11122879,2021-05-28
11124019,2021-05-28
11131000,2021-05-28
D928327,2021-05-28
D927697,2021-05-28
11131599,2021-05-28
11131986,2021-05-27
11103770,2021-05-27
11130653,2021-05-27
11129589,2021-05-26
11129590,2021-05-26
D928608,2021-05-25
11132070,2021-05-25
D930459,2021-05-24
D931243,2021-05-21
11098910,2021-05-20
11120640,2021-05-20
11120276,2021-05-20
11114203,2021-05-19
11107581,2021-05-19
11120902,2021-05-19
11131110,2021-05-18
11130519,2021-05-18
11132022,2021-05-18
11122504,2021-05-17
D927430,2021-05-17
11124076,2021-05-17
11110384,2021-05-17
11125292,2021-05-17
11129502,2021-05-17
11084737,2021-05-16
11120710,2021-05-14
11130437,2021-05-14
11128636,2021-05-13
11125882,2021-05-13
D929616,2021-05-13
11110190,2021-05-13
11128468,2021-05-13
D929615,2021-05-13
D927230,2021-05-12
11133344,2021-05-12
11110448,2021-05-12
11130629,2021-05-12
11125299,2021-05-12
11116598,2021-05-11
11107490,2021-05-11
11130422,2021-05-11
D926253,2021-05-11
11081273,2021-05-11
D929378,2021-05-10
11131784,2021-05-10
D929819,2021-05-10
11112161,2021-05-07
11129797,2021-05-07
11096902,2021-05-07
11107129,2021-05-06
11132667,2021-05-06
11125489,2021-05-06
11131665,2021-05-05
11110488,2021-05-05
11097123,2021-05-05

2025-01-25 02:14:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:43 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:43 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."patent_id"
HAVING COUNT(*) > 10
LIMIT 100
Results:
patent_id,recent_backward_citations
D577026,42
D693350,22
D546747,16
D627408,14
D481119,16
D597266,19
D628778,14
D540850,28
D606044,11
D575035,22
D526990,25
D613484,15
D615986,16
D687405,15
D592335,11
D757459,23
D747924,11
D689088,13
D628178,25
D695744,54
D672908,11
D749149,12
D742676,27
D805454,51
D862443,43
D905122,11
D855394,17
D790159,13
D771011,21
D805064,26
10585247,13
D568879,24
D588150,13
D573970,12
D519757,17
D605438,13
D550768,11
D733698,13
D686589,19
D654490,16
D612850,13
D683297,16
D651204,20
D628369,25
D711906,12
D688638,19
D704673,11
D775225,27
D715318,13
D731718,11
D865611,31
D710390,11
D701178,17
D825073,26
D784259,14
D859501,21
D813838,26
D760206,31
D819380,11
D718778,19
D723535,15
D824712,14
D787003,25
D873727,24
D759311,20
D900920,37
D824810,142
D896257,51
D833470,11
D929517,15
D870783,13
D917140,14
D825427,16
D819198,14
11040610,46
D901502,29
D880477,11
D876944,16
8784318,11
8571335,18
9849216,22
8386002,20
9167946,106
D658641,14
D649866,18
D637605,11
D657684,14
D818647,16
D696274,11
D841620,12
D848285,13
D691144,21
D814599,19
D781104,11
D852985,17
D863107,22
D928740,49
D828993,20
D892006,22
D849848,11

2025-01-25 02:14:43 - root - INFO - itercount: 0
2025-01-25 02:14:43 - root - INFO - Database Name: PATENTSVIEW
Schema Name: PATENTSVIEW
DDL describes table information.
,0
table_name,BRF_SUM_TEXT
description,
DDL,"create or replace TABLE BRF_SUM_TEXT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216)
);"

,1
table_name,CLAIMS_2021
description,
DDL,"create or replace TABLE CLAIMS_2021 (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""dependent"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""num"" VARCHAR(16777216),
	""exemplary"" NUMBER(38,0)
);"

,2
table_name,FIGURES
description,
DDL,"create or replace TABLE FIGURES (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""num_figures"" NUMBER(38,0),
	""num_sheets"" NUMBER(38,0)
);"

,3
table_name,FOREIGNCITATION
description,
DDL,"create or replace TABLE FOREIGNCITATION (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,4
table_name,INVENTOR_GENDER
description,
DDL,"create or replace TABLE INVENTOR_GENDER (
	""disamb_inventor_id_20170808"" VARCHAR(16777216),
	""disamb_inventor_id_20181127"" VARCHAR(16777216),
	""disamb_inventor_id_20190312"" VARCHAR(16777216),
	""male"" VARCHAR(16777216)
);"

,5
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""id"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""county"" VARCHAR(16777216),
	""state_fips"" FLOAT,
	""county_fips"" VARCHAR(16777216)
);"

,6
table_name,OTHERREFERENCE
description,
DDL,"create or replace TABLE OTHERREFERENCE (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,7
table_name,PATENT
description,
DDL,"create or replace TABLE PATENT (
	""id"" VARCHAR(16777216),
	""type"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""abstract"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""num_claims"" NUMBER(38,0),
	""filename"" VARCHAR(16777216),
	""withdrawn"" NUMBER(38,0)
);"

,8
table_name,RAWLOCATION
description,
DDL,"create or replace TABLE RAWLOCATION (
	""id"" VARCHAR(16777216),
	""location_id"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""latlong"" VARCHAR(16777216)
);"

,9
table_name,USAPPLICATIONCITATION
description,
DDL,"create or replace TABLE USAPPLICATIONCITATION (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""application_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,10
table_name,USPC
description,
DDL,"create or replace TABLE USPC (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""mainclass_id"" VARCHAR(16777216),
	""subclass_id"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,11
table_name,NBER_SUBCATEGORY
description,
DDL,"create or replace TABLE NBER_SUBCATEGORY (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,12
table_name,NON_INVENTOR_APPLICANT
description,
DDL,"create or replace TABLE NON_INVENTOR_APPLICANT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""rawlocation_id"" VARCHAR(16777216),
	""lname"" VARCHAR(16777216),
	""fname"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""designation"" VARCHAR(16777216),
	""applicant_type"" VARCHAR(16777216)
);"

,13
table_name,PERSISTENT_ASSIGNEE_DISAMBIG
description,
DDL,"create or replace TABLE PERSISTENT_ASSIGNEE_DISAMBIG (
	""rawassignee_id"" VARCHAR(16777216),
	""disamb_assignee_id_20181127"" VARCHAR(16777216),
	""disamb_assignee_id_20190312"" VARCHAR(16777216),
	""disamb_assignee_id_20190820"" VARCHAR(16777216),
	""disamb_assignee_id_20191008"" VARCHAR(16777216),
	""disamb_assignee_id_20191231"" VARCHAR(16777216),
	""disamb_assignee_id_20200331"" VARCHAR(16777216),
	""disamb_assignee_id_20200630"" VARCHAR(16777216),
	""disamb_assignee_id_20200929"" VARCHAR(16777216)
);"

,14
table_name,SUBCLASS
description,
DDL,"create or replace TABLE SUBCLASS (
	""id"" VARCHAR(16777216)
);"

,15
table_name,US_TERM_OF_GRANT
description,
DDL,"create or replace TABLE US_TERM_OF_GRANT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""lapse_of_patent"" VARCHAR(16777216),
	""disclaimer_date"" VARCHAR(16777216),
	""term_disclaimer"" VARCHAR(16777216),
	""term_grant"" VARCHAR(16777216),
	""term_extension"" VARCHAR(16777216)
);"

,16
table_name,ASSIGNEE
description,
DDL,"create or replace TABLE ASSIGNEE (
	""id"" VARCHAR(16777216),
	""type"" FLOAT,
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216)
);"

,17
table_name,CLAIM
description,
DDL,"create or replace TABLE CLAIM (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""dependent"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216),
	""exemplary"" VARCHAR(16777216)
);"

,18
table_name,CPC_GROUP
description,
DDL,"create or replace TABLE CPC_GROUP (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,19
table_name,DRAW_DESC_TEXT_2021
description,
DDL,"create or replace TABLE DRAW_DESC_TEXT_2021 (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,20
table_name,INVENTOR
description,
DDL,"create or replace TABLE INVENTOR (
	""id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""male_flag"" FLOAT,
	""attribution_status"" NUMBER(38,0)
);"

,21
table_name,IPCR
description,
DDL,"create or replace TABLE IPCR (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""classification_level"" VARCHAR(16777216),
	""section"" VARCHAR(16777216),
	""ipc_class"" VARCHAR(16777216),
	""subclass"" VARCHAR(16777216),
	""main_group"" VARCHAR(16777216),
	""subgroup"" VARCHAR(16777216),
	""symbol_position"" VARCHAR(16777216),
	""classification_value"" VARCHAR(16777216),
	""classification_status"" VARCHAR(16777216),
	""classification_data_source"" VARCHAR(16777216),
	""action_date"" VARCHAR(16777216),
	""ipc_version_indicator"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,22
table_name,PATENT_LAWYER
description,
DDL,"create or replace TABLE PATENT_LAWYER (
	""patent_id"" VARCHAR(16777216),
	""lawyer_id"" VARCHAR(16777216)
);"

,23
table_name,RAWASSIGNEE
description,
DDL,"create or replace TABLE RAWASSIGNEE (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""assignee_id"" VARCHAR(16777216),
	""rawlocation_id"" VARCHAR(16777216),
	""type"" FLOAT,
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,24
table_name,DETAIL_DESC_TEXT_2021
description,
DDL,"create or replace TABLE DETAIL_DESC_TEXT_2021 (
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""length"" NUMBER(38,0)
);"

,25
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""patent_id"" VARCHAR(16777216),
	""publication_number"" VARCHAR(16777216)
);"

,26
table_name,USPATENTCITATION
description,
DDL,"create or replace TABLE USPATENTCITATION (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""citation_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,27
table_name,GOVERNMENT_ORGANIZATION
description,
DDL,"create or replace TABLE GOVERNMENT_ORGANIZATION (
	""organization_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""level_one"" VARCHAR(16777216),
	""level_two"" VARCHAR(16777216),
	""level_three"" VARCHAR(16777216)
);"

,28
table_name,WIPO_FIELD
description,
DDL,"create or replace TABLE WIPO_FIELD (
	""id"" VARCHAR(16777216),
	""sector_title"" VARCHAR(16777216),
	""field_title"" VARCHAR(16777216)
);"

,29
table_name,APPLICATION
description,
DDL,"create or replace TABLE APPLICATION (
	""id"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""date"" VARCHAR(16777216)
);"

,30
table_name,BOTANIC
description,
DDL,"create or replace TABLE BOTANIC (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""latin_name"" VARCHAR(16777216),
	""variety"" VARCHAR(16777216)
);"

,31
table_name,CPC_SUBSECTION
description,
DDL,"create or replace TABLE CPC_SUBSECTION (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,32
table_name,GOVERNMENT_INTEREST
description,
DDL,"create or replace TABLE GOVERNMENT_INTEREST (
	""patent_id"" VARCHAR(16777216),
	""gi_statement"" VARCHAR(16777216)
);"

,33
table_name,LAWYER
description,
DDL,"create or replace TABLE LAWYER (
	""id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""country"" VARCHAR(16777216)
);"

,34
table_name,PATENT_ASSIGNEE
description,
DDL,"create or replace TABLE PATENT_ASSIGNEE (
	""patent_id"" VARCHAR(16777216),
	""assignee_id"" VARCHAR(16777216),
	""location_id"" VARCHAR(16777216)
);"

,35
table_name,PATENT_GOVINTORG
description,
DDL,"create or replace TABLE PATENT_GOVINTORG (
	""patent_id"" VARCHAR(16777216),
	""organization_id"" NUMBER(38,0)
);"

,36
table_name,PERSISTENT_INVENTOR_DISAMB
description,
DDL,"create or replace TABLE PERSISTENT_INVENTOR_DISAMB (
	""rawinventor_id"" VARCHAR(16777216),
	""disamb_inventor_id_20170307"" VARCHAR(16777216),
	""disamb_inventor_id_20170808"" VARCHAR(16777216)
);"

,37
table_name,PATENT_INVENTOR
description,
DDL,"create or replace TABLE PATENT_INVENTOR (
	""patent_id"" VARCHAR(16777216),
	""inventor_id"" VARCHAR(16777216),
	""location_id"" VARCHAR(16777216)
);"

,38
table_name,PCT_DATA
description,
DDL,"create or replace TABLE PCT_DATA (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""rel_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""_371_date"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""doc_type"" VARCHAR(16777216),
	""_102_date"" VARCHAR(16777216)
);"

,39
table_name,PERSISTENT_INVENTOR_DISAMBIG
description,
DDL,"create or replace TABLE PERSISTENT_INVENTOR_DISAMBIG (
	""rawinventor_id"" VARCHAR(16777216),
	""disamb_inventor_id_20170808"" VARCHAR(16777216),
	""disamb_inventor_id_20171003"" VARCHAR(16777216),
	""disamb_inventor_id_20171226"" VARCHAR(16777216),
	""disamb_inventor_id_20180528"" VARCHAR(16777216),
	""disamb_inventor_id_20181127"" VARCHAR(16777216),
	""disamb_inventor_id_20190312"" VARCHAR(16777216),
	""disamb_inventor_id_20190820"" VARCHAR(16777216),
	""disamb_inventor_id_20191008"" VARCHAR(16777216),
	""disamb_inventor_id_20191231"" VARCHAR(16777216),
	""disamb_inventor_id_20200331"" VARCHAR(16777216),
	""disamb_inventor_id_20200630"" VARCHAR(16777216),
	""disamb_inventor_id_20200929"" VARCHAR(16777216),
	""disamb_inventor_id_20201229"" VARCHAR(16777216)
);"

,40
table_name,RAWLAWYER
description,
DDL,"create or replace TABLE RAWLAWYER (
	""uuid"" VARCHAR(16777216),
	""lawyer_id"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,41
table_name,WIPO
description,
DDL,"create or replace TABLE WIPO (
	""patent_id"" VARCHAR(16777216),
	""field_id"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216)
);"

,42
table_name,RAWINVENTOR
description,
DDL,"create or replace TABLE RAWINVENTOR (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""inventor_id"" VARCHAR(16777216),
	""rawlocation_id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""rule_47"" VARCHAR(16777216),
	""deceased"" VARCHAR(16777216)
);"

,43
table_name,CPC_CURRENT
description,
DDL,"create or replace TABLE CPC_CURRENT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""section_id"" VARCHAR(16777216),
	""subsection_id"" VARCHAR(16777216),
	""group_id"" VARCHAR(16777216),
	""subgroup_id"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,44
table_name,CPC_SUBGROUP
description,
DDL,"create or replace TABLE CPC_SUBGROUP (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,45
table_name,DRAW_DESC_TEXT
description,
DDL,"create or replace TABLE DRAW_DESC_TEXT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216)
);"

,46
table_name,LOCATION_ASSIGNEE
description,
DDL,"create or replace TABLE LOCATION_ASSIGNEE (
	""location_id"" VARCHAR(16777216),
	""assignee_id"" VARCHAR(16777216)
);"

,47
table_name,LOCATION_INVENTOR
description,
DDL,"create or replace TABLE LOCATION_INVENTOR (
	""location_id"" VARCHAR(16777216),
	""inventor_id"" VARCHAR(16777216)
);"

,48
table_name,MAINCLASS_CURRENT
description,
DDL,"create or replace TABLE MAINCLASS_CURRENT (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,49
table_name,NBER_CATEGORY
description,
DDL,"create or replace TABLE NBER_CATEGORY (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,50
table_name,PATENT_CONTRACTAWARDNUMBER
description,
DDL,"create or replace TABLE PATENT_CONTRACTAWARDNUMBER (
	""patent_id"" VARCHAR(16777216),
	""contract_award_number"" VARCHAR(16777216)
);"

,51
table_name,RAWEXAMINER
description,
DDL,"create or replace TABLE RAWEXAMINER (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""role"" VARCHAR(16777216),
	""group"" VARCHAR(16777216)
);"

,52
table_name,REL_APP_TEXT
description,
DDL,"create or replace TABLE REL_APP_TEXT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216)
);"

,53
table_name,SUBCLASS_CURRENT
description,
DDL,"create or replace TABLE SUBCLASS_CURRENT (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,54
table_name,USRELDOC
description,
DDL,"create or replace TABLE USRELDOC (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""doctype"" VARCHAR(16777216),
	""relkind"" VARCHAR(16777216),
	""reldocno"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216)
);"

,55
table_name,MAINCLASS
description,
DDL,"create or replace TABLE MAINCLASS (
	""id"" VARCHAR(16777216)
);"

,56
table_name,NBER
description,
DDL,"create or replace TABLE NBER (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""category_id"" VARCHAR(16777216),
	""subcategory_id"" VARCHAR(16777216)
);"

,57
table_name,FOREIGN_PRIORITY
description,
DDL,"create or replace TABLE FOREIGN_PRIORITY (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""kind"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""country_transformed"" VARCHAR(16777216)
);"

,58
table_name,USPC_CURRENT
description,
DDL,"create or replace TABLE USPC_CURRENT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""mainclass_id"" VARCHAR(16777216),
	""subclass_id"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTSVIEW': {'PATENTSVIEW': ['APPLICATION', 'ASSIGNEE', 'BOTANIC', 'BRF_SUM_TEXT', 'CLAIM', 'CLAIMS_2021', 'CPC_CURRENT', 'CPC_GROUP', 'CPC_SUBGROUP', 'CPC_SUBSECTION', 'DETAIL_DESC_TEXT_2021', 'DRAW_DESC_TEXT', 'DRAW_DESC_TEXT_2021', 'FIGURES', 'FOREIGNCITATION', 'FOREIGN_PRIORITY', 'GOVERNMENT_INTEREST', 'GOVERNMENT_ORGANIZATION', 'INVENTOR', 'INVENTOR_GENDER', 'IPCR', 'LAWYER', 'LOCATION', 'LOCATION_ASSIGNEE', 'LOCATION_INVENTOR', 'MAINCLASS', 'MAINCLASS_CURRENT', 'MATCH', 'NBER', 'NBER_CATEGORY', 'NBER_SUBCATEGORY', 'NON_INVENTOR_APPLICANT', 'OTHERREFERENCE', 'PATENT', 'PATENT_ASSIGNEE', 'PATENT_CONTRACTAWARDNUMBER', 'PATENT_GOVINTORG', 'PATENT_INVENTOR', 'PATENT_LAWYER', 'PCT_DATA', 'PERSISTENT_ASSIGNEE_DISAMBIG', 'PERSISTENT_INVENTOR_DISAMB', 'PERSISTENT_INVENTOR_DISAMBIG', 'RAWASSIGNEE', 'RAWEXAMINER', 'RAWINVENTOR', 'RAWLAWYER', 'RAWLOCATION', 'REL_APP_TEXT', 'SUBCLASS', 'SUBCLASS_CURRENT', 'USAPPLICATIONCITATION', 'USPATENTCITATION', 'USPC', 'USPC_CURRENT', 'USRELDOC', 'US_TERM_OF_GRANT', 'WIPO', 'WIPO_FIELD']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- **PATENTSVIEW.PATENTSVIEW.PATENT**
  - `"id"`: Unique identifier for each patent. Used to join with other tables.
  - `"country"`: Indicates the country of the patent. Used to filter only U.S. patents (`'US'`).
  
- **PATENTSVIEW.PATENTSVIEW.APPLICATION**
  - `"patent_id"`: References `"id"` in the PATENT table. Used to join and get application dates.
  - `"date"`: Application date of the patent. Used to calculate time differences.
  
- **PATENTSVIEW.PATENTSVIEW.USPATENTCITATION**
  - `"patent_id"`: The citing patent's ID.
  - `"citation_id"`: The cited patent's ID.
  
- **Use Cases:**
  - **Backward Citations**: Citations made by a patent (`"patent_id"`) to earlier patents (`"citation_id"`).
  - **Forward Citations**: Citations received by a patent (`"citation_id"`) from later patents (`"patent_id"`).
  - **Date Calculations**: Using `"date"` from the APPLICATION table to determine if citations are within 1 year of the application date.

---

**SQL Queries:**

1. **List basic patent information:**

   ```sql
   SELECT "id", "country", "date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT
   LIMIT 100;
   ```

2. **Retrieve application dates for patents:**

   ```sql
   SELECT "patent_id", "date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
   LIMIT 100;
   ```

3. **List U.S. patents with their application dates:**

   ```sql
   SELECT p."id", p."country", a."date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT p
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
   WHERE p."country" = 'US'
   LIMIT 100;
   ```

4. **Inspect citation relationships between patents:**

   ```sql
   SELECT "patent_id", "citation_id"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   LIMIT 100;
   ```

5. **Find backward citations with cited patents' application dates:**

   ```sql
   SELECT c."patent_id", c."citation_id", cited_app."date" AS "cited_application_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   LIMIT 100;
   ```

6. **Find forward citations with citing patents' application dates:**

   ```sql
   SELECT c."citation_id", c."patent_id" AS "citing_patent_id", citing_app."date" AS "citing_application_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   LIMIT 100;
   ```

7. **Count total backward citations per patent:**

   ```sql
   SELECT "patent_id", COUNT(*) AS "total_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   GROUP BY "patent_id"
   ORDER BY "total_backward_citations" DESC
   LIMIT 100;
   ```

8. **Count backward citations within 1 year from application date:**

   ```sql
   SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   WHERE ABS(DATEDIFF(day, cited_app."date", citing_app."date")) <= 365
   GROUP BY c."patent_id"
   ORDER BY "recent_backward_citations" DESC
   LIMIT 100;
   ```

9. **Identify the patent with the most backward citations within 1 year:**

   ```sql
   SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   WHERE ABS(DATEDIFF(day, cited_app."date", citing_app."date")) <= 365
   GROUP BY c."patent_id"
   ORDER BY "recent_backward_citations" DESC
   LIMIT 1;
   ```

10. **Find forward citations within 1 year for a specific patent:**

    ```sql
    SELECT c."patent_id" AS "citing_patent_id", c."citation_id", citing_app."date" AS "citing_application_date"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE c."citation_id" = 'SPECIFIC_PATENT_ID' AND ABS(DATEDIFF(day, citing_app."date", cited_app."date")) <= 365
    LIMIT 100;
    ```

11. **Count forward citations within 1 year for all patents:**

    ```sql
    SELECT c."citation_id" AS "cited_patent_id", COUNT(*) AS "recent_forward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE ABS(DATEDIFF(day, citing_app."date", cited_app."date")) <= 365
    GROUP BY c."citation_id"
    ORDER BY "recent_forward_citations" DESC
    LIMIT 100;
    ```

12. **List patents with both backward and forward citations within 1 year:**

    ```sql
    SELECT c1."patent_id", COUNT(DISTINCT c1."citation_id") AS "recent_backward_citations", COUNT(DISTINCT c2."patent_id") AS "recent_forward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c1
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app1 ON c1."patent_id" = citing_app1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app1 ON c1."citation_id" = cited_app1."patent_id"
    LEFT JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c2 ON c1."patent_id" = c2."citation_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app2 ON c2."patent_id" = citing_app2."patent_id"
    WHERE ABS(DATEDIFF(day, cited_app1."date", citing_app1."date")) <= 365
      AND ABS(DATEDIFF(day, citing_app2."date", cited_app1."date")) <= 365
    GROUP BY c1."patent_id"
    LIMIT 100;
    ```

13. **Retrieve application dates for cited patents:**

    ```sql
    SELECT DISTINCT c."citation_id", cited_app."date" AS "cited_application_date"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    LIMIT 100;
    ```

14. **Find the earliest application date among cited patents:**

    ```sql
    SELECT MIN(cited_app."date") AS "earliest_cited_application_date"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id";
    ```

15. **Determine the average number of backward citations within 1 year:**

    ```sql
    SELECT AVG("recent_backward_citations") AS "average_recent_backward_citations"
    FROM (
      SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
      FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
      WHERE ABS(DATEDIFF(day, cited_app."date", citing_app."date")) <= 365
      GROUP BY c."patent_id"
    ) sub;
    ```

16. **List patents without any backward citations within 1 year:**

    ```sql
    SELECT p."id"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    LEFT JOIN (
      SELECT DISTINCT "patent_id"
      FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
      WHERE ABS(DATEDIFF(day, cited_app."date", citing_app."date")) <= 365
    ) recent_citations ON p."id" = recent_citations."patent_id"
    WHERE recent_citations."patent_id" IS NULL
    LIMIT 100;
    ```

17. **Find patents with the highest number of forward citations within 1 year:**

    ```sql
    SELECT c."citation_id" AS "patent_id", COUNT(*) AS "recent_forward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE ABS(DATEDIFF(day, citing_app."date", cited_app."date")) <= 365
    GROUP BY c."citation_id"
    ORDER BY "recent_forward_citations" DESC
    LIMIT 100;
    ```

18. **Check the countries of cited patents to ensure they are U.S. patents:**

    ```sql
    SELECT c."citation_id", cited_patent."country"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT cited_patent ON c."citation_id" = cited_patent."id"
    WHERE cited_patent."country" = 'US'
    LIMIT 100;
    ```

19. **List the most recent application dates for patents:**

    ```sql
    SELECT "patent_id", MAX("date") AS "recent_application_date"
    FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
    GROUP BY "patent_id"
    ORDER BY "recent_application_date" DESC
    LIMIT 100;
    ```

20. **Find patents that cited more than 10 patents within 1 year from application:**

    ```sql
    SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE ABS(DATEDIFF(day, cited_app."date", citing_app."date")) <= 365
    GROUP BY c."patent_id"
    HAVING COUNT(*) > 10
    LIMIT 100;
    ```

---

These queries explore the relevant tables and columns to understand how to calculate the number of forward and backward citations within 1 year from the application date for U.S. patents, as required for the task.Query:
SELECT "id", "country", "date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT
   LIMIT 100;
Answer:
id,country,date
10344281,US,2019-07-09
9474645,US,2016-10-25
9479570,US,2016-10-25
9486813,US,2016-11-08
5057059,US,1991-10-15
5074671,US,1991-12-24
10656777,US,2020-05-19
10666644,US,2020-05-26
6234740,US,2001-05-22
7512243,US,2009-03-31
7164498,US,2007-01-16
7174122,US,2007-02-06
7186324,US,2007-03-06
8492017,US,2013-07-23
6553983,US,2003-04-29
4422278,US,1983-12-27
4425606,US,1984-01-10
4442535,US,1984-04-10
8134762,US,2012-03-13
8150953,US,2012-04-03
8151122,US,2012-04-03
8165443,US,2012-04-24
7808473,US,2010-10-05
7841634,US,2010-11-30
10030960,US,2018-07-24
5363127,US,1994-11-08
5373076,US,1994-12-13
5378413,US,1995-01-03
5653487,US,1997-08-05
5662141,US,1997-09-02
5668911,US,1997-09-16
4117719,US,1978-10-03
10378734,US,2019-08-13
9131017,US,2015-09-08
9158050,US,2015-10-13
9493487,US,2016-11-15
5985453,US,1999-11-16
5987826,US,1999-11-23
5078092,US,1992-01-07
5094861,US,1992-03-10
8850084,US,2014-09-30
8856870,US,2014-10-07
7523193,US,2009-04-21
7533418,US,2009-05-12
7543795,US,2009-06-09
7202787,US,2007-04-10
7206064,US,2007-04-17
7211120,US,2007-05-01
6282039,US,2001-08-28
6291847,US,2001-09-18
10703593,US,2020-07-07
10713772,US,2020-07-14
10716605,US,2020-07-21
7842768,US,2010-11-30
7854310,US,2010-12-21
5388421,US,1995-02-14
10426455,US,2019-10-01
9829476,US,2017-11-28
9163705,US,2015-10-20
6589870,US,2003-07-08
5700827,US,1997-12-23
11008739,US,2021-05-18
11021242,US,2021-06-01
9528527,US,2016-12-27
10051255,US,2018-08-14
5128176,US,1992-07-07
8867032,US,2014-10-21
8869218,US,2014-10-21
8877355,US,2014-11-04
10329695,US,2019-06-25
9461635,US,2016-10-04
6849840,US,2005-02-01
6856787,US,2005-02-15
6860217,US,2005-03-01
10655141,US,2020-05-19
10655672,US,2020-05-19
10655873,US,2020-05-19
5956560,US,1999-09-21
8795420,US,2014-08-05
8798165,US,2014-08-05
8805232,US,2014-08-12
8808524,US,2014-08-19
8808529,US,2014-08-19
7486780,US,2009-02-03
7512101,US,2009-03-31
7177726,US,2007-02-13
7187105,US,2007-03-06
8154397,US,2012-04-10
10009279,US,2018-06-26
10029417,US,2018-07-24
10992919,US,2021-04-27
5348645,US,1994-09-20
5649251,US,1997-07-15
5676831,US,1997-10-14
10372928,US,2019-08-06
9125191,US,2015-09-01
5975734,US,1999-11-02
5993050,US,1999-11-30
6000370,US,1999-12-14
6003851,US,1999-12-21
Query:
SELECT "patent_id", "date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
   LIMIT 100;
Answer:
patent_id,application_date
D405116,1990-07-23
D366645,1990-10-15
D378332,1991-03-13
D385355,1992-11-18
D389797,1993-01-05
D386167,1993-02-23
D385268,1993-03-02
D391736,1993-03-08
D385547,1993-04-30
D388563,1994-03-08
D386745,1994-06-20
D392380,1994-07-07
D394702,1994-09-02
D383997,1994-09-13
D395436,1994-09-14
D385561,1994-09-30
D400899,1994-11-07
D396186,1994-11-10
D395936,1994-12-02
D386174,1994-12-22
D389272,1994-12-29
D384746,1995-01-04
D390387,1995-01-19
D385156,1995-02-09
D392799,1995-02-17
D396101,1995-03-01
D387354,1995-03-14
D387923,1995-03-21
D388471,1995-03-24
D383965,1995-03-24
D402202,1995-03-27
D403421,1995-03-29
D388197,1995-03-31
D394721,1995-04-17
D386702,1995-04-18
D390028,1995-04-21
D386268,1995-05-03
D388095,1995-05-05
D393005,1995-05-08
D383911,1995-05-09
D384916,1995-05-15
D401924,1995-06-01
D387236,1995-06-07
D387143,1995-06-09
D394051,1995-06-12
D385386,1995-06-16
D389664,1995-06-16
D385951,1995-06-27
D401358,1995-06-29
D395253,1995-06-29
D402064,1995-06-30
D384415,1995-06-30
D395040,1995-07-07
D386555,1995-07-10
D391128,1995-07-11
D395923,1995-07-14
D397792,1995-07-26
D394704,1995-07-26
D388172,1995-07-27
D388987,1995-08-02
D384020,1995-08-03
D395446,1995-08-04
D385909,1995-08-04
D389144,1995-08-07
D391347,1995-08-11
D385507,1995-08-11
D386531,1995-08-14
D390339,1995-08-17
D384655,1995-08-18
D391383,1995-08-23
D392343,1995-08-24
D385074,1995-09-05
D395983,1995-09-08
D386377,1995-09-11
D394951,1995-09-11
D385598,1995-09-14
D399102,1995-09-21
D400545,1995-09-21
D384131,1995-09-22
D388880,1995-09-25
D383973,1995-09-27
D390767,1995-10-03
D384025,1995-10-03
D397663,1995-10-03
D384108,1995-10-06
D387903,1995-10-13
D386630,1995-10-16
D393397,1995-10-16
D387924,1995-10-17
D391451,1995-10-18
D389095,1995-10-20
D399235,1995-10-20
D388057,1995-10-20
D389094,1995-10-20
D391440,1995-10-23
D386732,1995-10-23
D384969,1995-10-24
D387034,1995-10-25
D387516,1995-10-26
D384441,1995-10-27
Query:
SELECT p."id", p."country", a."date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT p
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
   WHERE p."country" = 'US'
   LIMIT 100;
Answer:
id,country,application_date
D396456,US,1994-01-21
D394631,US,1994-08-02
D388775,US,1994-09-01
D391947,US,1995-05-05
D392963,US,1995-05-05
D384418,US,1995-05-19
D388136,US,1995-06-05
D385266,US,1995-09-08
D397064,US,1995-09-27
D394722,US,1995-12-13
D403435,US,1995-12-21
D388528,US,1996-01-22
D399212,US,1996-02-09
D391948,US,1996-02-14
D384439,US,1996-02-29
D386744,US,1996-03-01
D384435,US,1996-03-27
D386360,US,1996-04-23
D385353,US,1996-04-29
D389840,US,1996-04-30
D383936,US,1996-05-07
D388444,US,1996-05-23
D396284,US,1996-05-29
D386367,US,1996-05-31
D386870,US,1996-06-07
D384946,US,1996-07-09
D387926,US,1996-07-19
D387281,US,1996-07-19
D395202,US,1996-07-22
D385463,US,1996-08-16
D386325,US,1996-08-20
D391786,US,1996-08-21
D394093,US,1996-08-22
D394588,US,1996-08-26
D392007,US,1996-08-27
D403186,US,1996-08-29
D387007,US,1996-09-06
D386133,US,1996-09-11
D395364,US,1996-09-13
D392144,US,1996-09-18
D386818,US,1996-09-30
D391580,US,1996-10-16
D385862,US,1996-10-17
D401184,US,1996-10-22
D393522,US,1996-10-22
D389286,US,1996-10-25
D391656,US,1996-11-08
D401340,US,1996-11-12
D402384,US,1996-11-15
D388840,US,1996-11-18
D397862,US,1996-11-22
D395356,US,1996-11-27
D391516,US,1996-11-29
D393911,US,1996-12-05
D397095,US,1996-12-09
D386736,US,1996-12-17
D391687,US,1996-12-24
D394322,US,1997-01-06
D399997,US,1997-01-06
D400324,US,1997-01-10
D390986,US,1997-01-14
D392519,US,1997-01-15
D394561,US,1997-01-29
D388381,US,1997-02-12
D392303,US,1997-02-14
D403091,US,1997-02-18
D387763,US,1997-02-24
D392959,US,1997-02-26
D393899,US,1997-02-28
D393049,US,1994-08-18
D388460,US,1994-11-28
D392622,US,1995-03-28
D387207,US,1995-05-10
D397157,US,1995-08-04
D384021,US,1995-09-05
D383906,US,1995-10-11
D396755,US,1995-11-03
D394000,US,1995-11-20
D390967,US,1996-01-02
D384111,US,1996-01-04
D383891,US,1996-01-11
D397677,US,1996-01-29
D391215,US,1996-03-07
D393638,US,1996-03-08
D389526,US,1996-03-15
D384819,US,1996-03-22
D385531,US,1996-03-26
D384444,US,1996-04-08
D401861,US,1996-04-30
D394225,US,1996-05-06
D397167,US,1996-05-14
D385529,US,1996-05-15
D391542,US,1996-05-23
D402621,US,1996-05-24
D389444,US,1996-05-24
D386176,US,1996-05-31
D386509,US,1996-06-07
D387035,US,1996-06-10
D392711,US,1996-06-20
D388830,US,1996-06-25
Query:
SELECT "patent_id", "citation_id"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   LIMIT 100;
Answer:
patent_id,citation_id
4233808,524
5418423,H60
5445606,H71
4671363,1482
4295314,1887
5666885,1931
D283714,4174
5048848,7345
4612868,8164
5611671,8834
5009345,9837
D311841,D392
4815385,H162
5798553,H204
5561678,H275
4911487,H358
5221744,H531
5940597,H586
5211875,H724
6073962,H767
5349364,H880
5651474,H943
5224658,11368
5090897,13387
D316160,15211
D395737,17748
4588302,19413
4665741,21487
5514166,22080
D358251,22456
5920920,23335
5941231,24840
4568320,24874
5030203,25129
5794810,26188
5013461,26709
4729321,29995
5005259,31574
5239018,32136
5248309,32649
5060706,32693
D350403,34792
D377562,34991
4688727,35036
5479861,36773
5329869,37849
4101419,39150
6327797,39575
4239460,39974
5228705,40921
3962925,41574
D452982,43931
5714098,45178
5875785,45258
4669324,46056
5727698,46296
D441147,46579
4360315,50705
6113158,52010
D327304,53426
5429831,56217
4269417,56326
4702856,59724
5015399,61880
4437634,63383
5570971,64757
4678011,66631
5354077,68558
4967939,69485
6099490,70683
4146982,70849
4858867,70884
5141236,73006
4394803,74707
4488381,76755
4018394,77102
5067396,77884
6044570,79052
4676772,79436
D396895,81947
D405235,83973
4112838,86045
D404519,86101
5571229,87015
5667122,88505
4574977,90036
4096853,90217
4901645,90732
5383675,90837
D304074,92049
6344226,92640
4598447,94503
4867255,94854
5666885,95705
6164033,97316
D415547,98439
D266832,D2599
D365016,D3310
D394355,D3570
D390318,D4336
Query:
SELECT c."patent_id", c."citation_id", cited_app."date" AS "cited_application_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
   LIMIT 100;
Answer:
patent_id,citation_id,cited_application_date
8620900,6976025,2002-04-01
11030408,6976031,2000-02-23
11080232,6976039,2001-05-25
9971784,6976039,2001-05-25
9507617,6976059,2000-07-20
10540159,6976079,2000-09-29
10116738,6976090,2001-02-16
9338523,6976090,2001-02-16
9986419,6976090,2001-02-16
8902915,6976095,1999-12-30
9032132,6976105,2002-12-11
9788215,6976160,2002-02-22
10285094,6976160,2002-02-22
9509682,6976164,2000-07-19
9641490,6976165,1999-09-07
9189392,6976190,2002-07-31
10459710,6976193,2001-09-20
9852205,6976210,2000-08-29
9256664,6976210,2000-08-29
8849850,6976210,2000-08-29
8739302,6976259,2000-09-29
9339074,6976321,2003-11-07
10865545,6976325,2003-11-25
10617227,6976348,2004-10-20
10113823,6976416,2003-01-22
10556720,6976438,2003-08-07
8447648,6976439,2003-01-16
10736304,6976452,2003-10-14
10087357,6976542,2003-10-03
D724696,6976543,2004-01-23
10286409,6976543,2004-01-23
10152624,6976626,2003-01-12
10002272,6976631,2003-05-21
8713829,6976660,2003-12-11
9169821,6976683,2003-08-25
8857387,6976683,2003-08-25
D704600,6976697,2003-05-15
9126417,6976753,2003-12-04
9954993,6976799,2003-03-12
10351229,6976829,2003-07-16
10213160,6976857,2005-07-14
10268014,6976867,2004-01-28
8648932,6976954,2002-06-28
9775529,6976958,2004-02-06
8499252,6976958,2004-02-06
9775567,6976965,2002-09-19
8936021,6976969,2002-01-14
9913776,6976969,2002-01-14
9339425,6976978,2002-01-25
9492315,6976982,2002-01-09
9687263,6976983,2003-06-12
10449330,6976987,2003-06-30
9050141,6976988,2002-08-19
10208468,6977005,2003-07-15
9670351,6977105,2000-09-22
10557691,6977140,2000-03-29
8815513,6977148,2001-10-15
9269648,6977188,2003-08-15
10472750,6977231,2000-01-21
11116717,6977250,2001-09-17
10799476,6977257,2002-04-24
8648197,6977265,2002-11-29
8791087,6977295,2000-04-21
9164099,6977305,2001-09-29
9126184,6977319,2004-03-12
8608889,6977324,2001-06-20
9554549,6977327,2004-01-30
11109546,6977351,2004-10-29
9904327,6977352,2005-03-01
10179730,6977468,2004-02-02
8882791,6977495,2004-01-16
10966744,6977495,2004-01-16
9872725,6977495,2004-01-16
9287075,6977569,2004-08-11
8367991,6977598,2003-08-29
9244157,6977608,2004-12-15
10595574,6977615,2004-03-04
9401025,6977630,2000-07-18
8515132,6977643,2002-08-22
9083830,6977685,2000-02-25
10937755,6977686,2001-03-07
8923564,6977687,1998-10-07
8760576,6977690,2001-11-07
10218848,6977740,2000-03-29
9053727,6977789,2002-01-31
9245555,6977790,2002-05-03
9153283,6977793,2004-03-16
10205395,6977824,2004-08-09
8612670,6977847,2002-11-18
8947382,6977868,2002-02-14
9453742,6977868,2002-02-14
9913289,6977888,2000-09-14
8789201,6977894,1999-05-19
8520688,6977896,2000-06-05
9262225,6977939,2001-01-26
8976280,6977985,2002-12-17
8995641,6977992,2004-09-27
9906651,6977992,2004-09-27
10757262,6978006,2000-10-12
10218515,6978017,1997-10-14
Query:
SELECT c."citation_id", c."patent_id" AS "citing_patent_id", citing_app."date" AS "citing_application_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
   LIMIT 100;
Answer:
citation_id,citing_patent_id,citing_application_date
6976025,8620900,2009-02-09
6976031,11030408,2019-02-15
6976039,11080232,2018-04-20
6976039,9971784,2015-08-03
6976059,9507617,2013-12-02
6976079,10540159,2017-09-29
6976090,10116738,2015-11-30
6976090,9338523,2009-12-21
6976090,9986419,2017-05-26
6976095,8902915,2012-09-24
6976105,9032132,2012-06-28
6976160,9788215,2011-11-07
6976160,10285094,2017-04-20
6976164,9509682,2015-01-07
6976165,9641490,2016-01-05
6976190,9189392,2011-06-30
6976193,10459710,2017-09-01
6976210,9852205,2014-10-16
6976210,9256664,2014-07-03
6976210,8849850,2013-06-28
6976259,8739302,2012-02-24
6976321,9339074,2015-03-17
6976325,10865545,2020-05-28
6976348,10617227,2018-03-07
6976416,10113823,2016-12-20
6976438,10556720,2018-12-20
6976439,8447648,2009-07-22
6976452,10736304,2019-10-18
6976542,10087357,2014-08-01
6976543,D724696,2013-10-01
6976543,10286409,2014-10-28
6976626,10152624,2017-03-09
6976631,10002272,2016-08-23
6976660,8713829,2013-01-29
6976683,9169821,2014-05-08
6976683,8857387,2011-11-22
6976697,D704600,2012-12-21
6976753,9126417,2014-10-06
6976799,9954993,2015-12-30
6976829,10351229,2015-03-12
6976857,10213160,2017-08-22
6976867,10268014,2018-10-05
6976954,8648932,2009-08-13
6976958,9775529,2009-09-14
6976958,8499252,2010-07-27
6976965,9775567,2015-12-22
6976969,8936021,2008-10-06
6976969,9913776,2014-07-28
6976978,9339425,2013-11-04
6976982,9492315,2011-08-05
6976983,9687263,2014-05-29
6976987,10449330,2013-10-15
6976988,9050141,2009-02-02
6977005,10208468,2016-03-29
6977105,9670351,2015-08-05
6977140,10557691,2017-11-15
6977148,8815513,2007-10-31
6977188,9269648,2014-12-04
6977231,10472750,2017-01-30
6977250,11116717,2020-04-01
6977257,10799476,2020-05-26
6977265,8648197,2012-03-26
6977295,8791087,2010-08-20
6977305,9164099,2013-05-08
6977319,9126184,2009-12-16
6977324,8608889,2006-06-08
6977327,9554549,2016-03-03
6977351,11109546,2019-05-09
6977352,9904327,2014-03-25
6977468,10179730,2016-12-08
6977495,8882791,2007-07-27
6977495,10966744,2018-10-25
6977495,9872725,2015-04-29
6977569,9287075,2015-03-27
6977598,8367991,2010-05-12
6977608,9244157,2013-06-17
6977615,10595574,2018-05-17
6977630,9401025,2015-09-21
6977643,8515132,2012-08-01
6977685,9083830,2012-09-15
6977686,10937755,2018-06-29
6977687,8923564,2014-02-10
6977690,8760576,2013-04-12
6977740,10218848,2014-09-04
6977789,9053727,2014-06-02
6977790,9245555,2014-11-03
6977793,9153283,2014-09-30
6977824,10205395,2016-11-15
6977847,8612670,2011-11-06
6977868,8947382,2012-02-28
6977868,9453742,2015-01-16
6977888,9913289,2015-11-25
6977894,8789201,2013-03-12
6977896,8520688,2009-10-05
6977939,9262225,2012-12-27
6977985,8976280,2011-07-06
6977992,8995641,2014-01-17
6977992,9906651,2017-01-24
6978006,10757262,2019-09-19
6978017,10218515,2016-08-26
Query:
SELECT "patent_id", COUNT(*) AS "total_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   GROUP BY "patent_id"
   ORDER BY "total_backward_citations" DESC
   LIMIT 100;
Answer:
patent_id,total_backward_citations
8892495,5828
11103241,5769
11090045,5684
11051807,5617
9980729,5444
11000274,5379
10945729,5320
10779825,5196
11026680,5162
10881399,5156
10695058,5065
10888322,5038
10716565,5037
10835249,4941
10959722,4730
10537325,4688
10765425,4620
10575868,4476
9986419,4468
11051811,4445
10463384,4380
10433844,4322
10368867,4285
10368864,4266
10485541,4266
10293100,4262
10271849,4233
10842491,4218
10245032,4212
10335148,4151
10390841,4142
10448948,4127
10433918,4120
10238391,4101
10625137,3937
10278780,3749
10172616,3708
10687810,3223
D896380,3216
10517599,3054
10765424,2878
10172619,2867
10117652,2756
10052100,2755
10028743,2725
9999426,2723
9901345,2717
9962158,2714
9974538,2713
9788836,2696
9592053,2638
9693777,2620
9585663,2605
9775609,2586
9962486,2573
8758323,2502
11120372,2464
10449416,2442
9804618,2436
9662110,2425
9700317,2401
9408604,2397
9749790,2395
9649111,2319
10791176,2277
9433419,2271
11096752,2170
10952788,2140
9253616,2118
10898256,2109
9668024,2096
11006971,2096
10709469,2091
9031581,2085
10966744,2083
9966068,2031
10185542,2030
11069510,2008
D922229,1996
9721566,1966
9886953,1965
10101822,1965
10679605,1936
10553209,1930
10675035,1921
10241644,1905
9760559,1893
9966065,1887
10078631,1881
10555769,1879
9483461,1864
10446141,1864
10463421,1850
10376305,1844
10312567,1816
9865911,1807
8403864,1783
8202231,1777
8763875,1777
8430828,1771
Query:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND ABS(DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date"))) <= 365
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 100;
Answer:
patent_id,recent_backward_citations
10835249,309
10433918,244
10888322,235
10433844,229
8149048,204
7410468,199
7589029,182
10945729,179
11000274,143
10595835,143
10537325,141
10575868,140
10271849,137
10881399,136
10335148,136
10517599,136
10919230,127
10779825,121
11026680,120
10959722,114
10695058,99
8065713,98
10485541,97
9433419,97
10687810,94
8344088,92
7172614,91
10729402,90
10463421,86
11051811,86
7178236,85
10368867,85
7547321,85
10448948,85
9649111,85
8672844,83
D930961,81
9137739,81
10245032,80
9775545,80
10172616,80
11099380,79
8758323,79
9563733,77
10172619,77
7400155,76
8333710,74
10716565,74
8816402,72
7240728,72
9782077,70
10853181,70
7476925,69
D750632,69
8669595,68
7524910,68
9579039,67
9780834,67
9685992,67
9125667,65
8771183,64
D893843,63
D928799,63
7487529,62
9189392,62
8162853,60
9755842,60
9283076,60
D853924,60
7425215,60
10238391,60
9700317,60
10504185,59
11090045,59
8984740,58
9775609,57
7033352,57
D893838,57
9100457,57
6994160,57
9445759,56
10188348,55
RE45426,55
7287271,55
10409629,55
11103241,55
9510779,55
10449416,54
11114195,54
7017661,54
6263387,54
6202111,54
6976990,54
6212585,54
8952634,53
10770336,52
D920309,52
7398832,52
9858548,52
10447728,51
Query:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND ABS(DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date"))) <= 365
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 1
Answer:
patent_id,recent_backward_citations
10835249,309
Query:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."patent_id"
ORDER BY "recent_backward_citations" DESC
LIMIT 1;
Answer:
patent_id,recent_backward_citations
10835249,1130
Query:
SELECT c."citation_id" AS "cited_patent_id", COUNT(*) AS "recent_forward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."citation_id"
ORDER BY "recent_forward_citations" DESC
LIMIT 100
Answer:
cited_patent_id,recent_forward_citations
7732819,95
8939344,73
9192380,72
8275836,70
9307986,68
8870050,66
8973804,65
7411209,65
8657178,64
8479969,63
8820605,62
8573465,61
9028494,61
8573461,60
8602288,60
9055944,60
8747238,59
5572643,59
9101385,59
8800838,59
9072536,59
9084601,59
9808246,59
9072515,58
9027817,58
9138225,58
9125662,58
8053184,58
9204879,58
8899465,57
9005230,57
8616431,57
9226751,57
9192384,57
8998058,56
D725001,56
8453914,56
9351726,56
9095339,56
9398911,56
9277922,56
8991677,56
9131940,56
9149325,56
8794497,56
8763875,56
8490853,55
8453912,55
9186143,55
9282966,54
8783541,54
8672206,54
9345481,54
9232945,54
9283054,54
8496156,54
8939343,54
9307988,53
9113874,53
9358005,53
D722533,53
D732430,53
9179911,53
D724510,53
9520482,53
9358003,53
8925788,53
8844789,53
9282962,53
9451958,53
9113873,53
9370364,53
8636766,52
8561873,52
8256654,52
9372206,52
9326768,52
D736451,52
9204878,52
D739306,52
D739317,52
8602287,52
8517244,52
9119657,52
9445813,52
9271799,52
9332987,52
9326767,52
8328063,52
8752749,52
D732429,52
D726591,51
9272406,51
D732431,51
D730776,51
D716696,51
9351727,51
9326770,51
D718189,51
9326769,51
Query:
SELECT c1."patent_id", COUNT(DISTINCT c1."citation_id") AS "recent_backward_citations", COUNT(DISTINCT c2."patent_id") AS "recent_forward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c1
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app1 ON c1."patent_id" = citing_app1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app1 ON c1."citation_id" = cited_app1."patent_id"
LEFT JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c2 ON c1."patent_id" = c2."citation_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app2 ON c2."patent_id" = citing_app2."patent_id"
WHERE TRY_TO_DATE(citing_app1."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app1."date") IS NOT NULL
  AND TRY_TO_DATE(citing_app2."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app1."date"), TRY_TO_DATE(citing_app1."date")) BETWEEN 0 AND 1825
  AND DATEDIFF(day, TRY_TO_DATE(cited_app1."date"), TRY_TO_DATE(citing_app2."date")) BETWEEN 0 AND 1825
GROUP BY c1."patent_id"
LIMIT 100
Answer:
patent_id,recent_backward_citations,recent_forward_citations
3996797,1,1
9256852,2,1
D764375,10,2
4080586,1,1
D689296,3,1
6597764,2,1
D832488,3,1
5619821,1,1
8469865,1,1
7575144,43,15
6061350,2,2
6996427,58,17
D746366,88,8
5777324,6,4
8763157,3,2
6988193,2,2
D676479,7,3
6197595,13,5
4249374,1,2
5865791,29,4
D523779,1,2
9761974,1,1
D556038,2,2
D825192,2,2
6682529,2,2
5894575,2,1
7030174,5,1
7948076,1,1
D736231,8,1
7149741,1,2
5461664,5,2
5690652,2,1
5458464,5,3
4726322,1,1
6633630,4,1
7233816,2,6
7335528,1,1
D863343,84,10
8475450,2,1
6282568,7,3
7841408,62,10
5326256,1,1
7149627,2,3
9896806,7,2
6982034,1,1
7262555,4,2
6274220,3,1
6310627,1,3
5594486,3,2
D852213,9,2
6071495,1,1
5121168,4,3
6947897,5,2
4120124,3,1
9201736,1,3
6501052,76,3
7221586,96,2
7941768,1,4
8686680,3,1
D315299,1,1
7329672,2,1
6068752,23,11
8393422,2,1
7246748,3,1
5038865,5,1
5390432,1,1
8244547,1,1
D734144,18,2
5341311,1,2
5690525,1,1
D844217,2,1
7024174,11,2
8270835,2,1
5499082,5,1
8182443,43,4
6374177,5,6
D534438,1,1
4453324,1,1
9557434,3,1
6496416,3,1
4564135,1,2
D643849,7,1
6175925,17,8
D548365,1,1
8409152,15,1
5919138,5,4
7708424,1,1
9725478,2,1
6459969,7,3
9990481,3,1
7042258,4,1
10373259,96,2
6135842,4,1
5351297,6,1
5576218,1,1
D664079,1,1
D732536,3,1
6302733,1,1
7989991,1,1
4522048,1,1
Query:
SELECT DISTINCT c."citation_id", TRY_TO_DATE(cited_app."date") AS "cited_application_date"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(cited_app."date") IS NOT NULL
LIMIT 100
Answer:
citation_id,cited_application_date
9922084,2015-01-30
9923062,2016-03-01
9987979,2017-02-28
D244471,1975-10-14
D245212,1975-10-09
D245689,1976-04-28
9963125,2016-04-27
D247333,1976-09-07
9966190,2017-03-22
D271817,1980-06-04
D272547,1982-01-27
D249099,1976-10-29
D327886,1991-04-12
D263678,1979-11-07
D249911,1976-07-12
D262686,1979-04-20
D276590,1982-06-16
D279617,1983-01-10
D279664,1983-12-29
D296579,1986-01-06
D302111,1986-01-27
D308537,1987-04-07
D311833,1987-06-02
D320782,1989-07-31
D324543,1991-06-27
D329744,1990-03-30
D343030,1992-01-28
D345590,1993-01-08
D351915,1992-02-07
D364682,1994-08-10
D366079,1994-03-24
D374399,1994-03-02
D282599,1983-06-16
D320102,1989-04-13
D322383,1989-07-20
D325372,1989-12-15
D329362,1990-04-23
D338797,1991-06-14
D340407,1992-02-11
D348758,1993-03-03
D349925,1993-11-12
D356261,1992-10-22
D365133,1995-02-08
D392248,1996-03-12
D397996,1996-09-30
D303402,1986-01-21
D356567,1993-07-22
D258540,1978-12-04
D345334,1992-02-25
D362524,1994-02-22
D377091,1995-05-12
D392534,1997-03-21
D411561,1998-09-04
D352540,1993-05-13
D363975,1995-01-25
D415236,1998-06-19
D432753,1999-03-24
D453177,2001-04-30
D475823,2002-06-24
D429424,1999-07-23
D453388,2001-02-26
D481228,2002-01-09
D501378,2004-02-13
D514607,2003-09-05
D245557,1976-03-29
D257165,1978-09-05
D274827,1981-08-05
D288803,1984-08-20
D328617,1990-01-12
D336683,1990-05-18
D354610,1993-06-21
D371356,1994-09-14
D372364,1995-04-04
D324326,1989-10-12
D354729,1993-11-18
D379623,1996-02-12
D381124,1993-10-29
D397247,1997-11-20
D401304,1997-08-22
D404159,1997-07-10
D281874,1983-03-28
D302346,1988-06-20
D323561,1989-08-28
D332653,1990-06-12
D358548,1994-01-25
D360450,1994-03-07
D288515,1984-05-24
D315161,1989-11-13
D340158,1991-08-07
D348172,1993-09-07
D353906,1994-03-24
D355792,1992-05-01
D361540,1994-04-26
D367199,1994-11-04
D369037,1995-05-15
D375741,1995-09-08
D379256,1995-07-18
D384441,1995-10-27
D386168,1993-04-30
D388772,1997-02-21
Query:
SELECT MIN(TRY_TO_DATE(cited_app."date")) AS "earliest_cited_application_date"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(cited_app."date") IS NOT NULL
Answer:
earliest_cited_application_date
0975-11-06
Query:
SELECT AVG("recent_backward_citations") AS "average_recent_backward_citations"
FROM (
  SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
  WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(cited_app."date") IS NOT NULL
    AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
  GROUP BY c."patent_id"
) sub
Answer:
average_recent_backward_citations
4.741901
Query:
SELECT p."id"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
LEFT JOIN (
  SELECT DISTINCT c."patent_id"
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
  WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(cited_app."date") IS NOT NULL
    AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
) recent_citations ON p."id" = recent_citations."patent_id"
WHERE recent_citations."patent_id" IS NULL
LIMIT 100
Answer:
id
4025826
8384383
10214103
10245640
3963012
3973466
3975379
9348472
D265113
10588367
10591172
9375163
10866274
10868210
3986413
8682413
D579697
8367044
10297682
9758339
9414811
8713066
8721808
8745632
8746179
D900648
4942174
5929114
10227649
D366622
D407320
10591438
7382205
9727817
8048906
10869884
4903638
3990158
4006345
6177593
6183855
6187232
D530487
D599314
9058959
9759801
9410478
10898576
7409792
4018074
4022739
6459355
6829973
8778276
9336408
10559155
10560832
10840749
8014769
4868855
7696878
3952944
9371026
8315645
8318301
10572848
10600363
9385806
8024581
8032241
10883749
D613251
8377256
10622806
10282521
7207326
9854256
11017604
11018603
11033209
4140774
4157684
10344332
9474333
10998569
4093148
10372095
10388557
9156055
9516501
7845946
10403467
10430458
9836579
11013690
11039518
4134645
9553268
10047181
5122594
Query:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "recent_forward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."citation_id"
ORDER BY "recent_forward_citations" DESC
LIMIT 100
Answer:
patent_id,recent_forward_citations
7732819,95
8939344,73
9192380,72
8275836,70
9307986,68
8870050,66
7411209,65
8973804,65
8657178,64
8479969,63
8820605,62
9028494,61
8573465,61
8602288,60
9055944,60
8573461,60
9808246,59
9101385,59
8747238,59
8800838,59
9072536,59
9084601,59
5572643,59
9138225,58
9125662,58
9204879,58
9072515,58
9027817,58
8053184,58
9005230,57
9226751,57
9192384,57
8899465,57
8616431,57
9277922,56
9131940,56
8991677,56
9398911,56
8794497,56
8763875,56
9149325,56
9351726,56
8998058,56
D725001,56
9095339,56
8453914,56
9186143,55
8490853,55
8453912,55
8939343,54
8496156,54
9232945,54
9283054,54
9345481,54
9282966,54
8672206,54
8783541,54
9358003,53
9451958,53
9370364,53
D724510,53
8844789,53
9282962,53
9307988,53
9113873,53
D732430,53
D722533,53
9520482,53
9113874,53
9179911,53
9358005,53
8925788,53
9332987,52
D732429,52
D736451,52
9271799,52
D739317,52
8517244,52
9204878,52
8636766,52
8256654,52
8752749,52
9326768,52
9119657,52
9372206,52
8328063,52
9445813,52
9326767,52
8561873,52
8602287,52
D739306,52
9232979,51
5794207,51
9332984,51
9393015,51
D732431,51
9272406,51
D716696,51
9351727,51
D730776,51
Query:
SELECT c."citation_id", cited_patent."country"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.PATENT cited_patent ON c."citation_id" = cited_patent."id"
WHERE cited_patent."country" = 'US'
LIMIT 100
Answer:
citation_id,country
7214750,US
7215213,US
7215479,US
7216217,US
7216217,US
7216491,US
7216671,US
7216671,US
7216738,US
7217292,US
7217426,US
7218736,US
7218914,US
7218964,US
7218964,US
7219107,US
7219107,US
7219527,US
7219729,US
7219777,US
7219841,US
7219841,US
7220141,US
7221763,US
7221763,US
7221810,US
7222084,US
7222393,US
7223173,US
7223256,US
7223256,US
7223288,US
7223540,US
7223649,US
7223969,US
7224000,US
7225156,US
7225448,US
7225959,US
7225964,US
7225964,US
7225964,US
7225964,US
7225964,US
7225964,US
7225983,US
7226230,US
7227129,US
7227494,US
7227576,US
7227695,US
7228264,US
7228878,US
7229404,US
7229976,US
7231069,US
7231100,US
7231384,US
7231427,US
7232613,US
7233137,US
7233137,US
7233264,US
7233607,US
7233816,US
7233864,US
7233907,US
7234242,US
7234281,US
7234550,US
7235063,US
7235073,US
7235073,US
7235089,US
7235089,US
7235089,US
7235089,US
7235089,US
7235089,US
7235302,US
7235302,US
7235302,US
7235420,US
7235583,US
7235583,US
7235592,US
7235649,US
7235980,US
7236155,US
7236738,US
7236742,US
7236772,US
7236847,US
7237036,US
7237137,US
7237201,US
7238195,US
7238195,US
7238195,US
7238203,US
Query:
SELECT "patent_id", MAX(TRY_TO_DATE("date")) AS "recent_application_date"
FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
WHERE TRY_TO_DATE("date") IS NOT NULL
GROUP BY "patent_id"
ORDER BY "recent_application_date" DESC
LIMIT 100
Answer:
patent_id,recent_application_date
4732727,9186-04-03
4474874,9183-03-11
4255928,9178-12-11
4135654,9177-04-11
4041523,9176-06-01
3969699,9175-04-11
4010353,9174-09-11
3964954,9173-05-31
4032532,9173-03-01
4469216,8198-04-05
4198308,7978-07-21
4739365,2987-05-28
4725260,2987-03-24
4709214,2986-04-28
4596904,2984-05-25
4542062,2982-01-20
D245522,2976-07-29
4020425,2976-03-26
3943504,2975-02-25
11125411,2021-07-19
D931411,2021-07-15
D931924,2021-07-02
D931695,2021-06-28
D931696,2021-06-28
11118753,2021-06-25
11129295,2021-06-23
D931884,2021-06-22
D930813,2021-06-17
D930814,2021-06-17
11130503,2021-06-14
11127382,2021-06-14
D930375,2021-06-11
11109170,2021-06-10
11115759,2021-06-09
D931628,2021-06-08
11128963,2021-06-08
11125171,2021-06-07
D929993,2021-06-02
11133641,2021-06-01
11122879,2021-05-28
11124019,2021-05-28
11131000,2021-05-28
D928327,2021-05-28
D927697,2021-05-28
11131599,2021-05-28
11131986,2021-05-27
11103770,2021-05-27
11130653,2021-05-27
11129589,2021-05-26
11129590,2021-05-26
D928608,2021-05-25
11132070,2021-05-25
D930459,2021-05-24
D931243,2021-05-21
11098910,2021-05-20
11120640,2021-05-20
11120276,2021-05-20
11114203,2021-05-19
11107581,2021-05-19
11120902,2021-05-19
11131110,2021-05-18
11130519,2021-05-18
11132022,2021-05-18
11122504,2021-05-17
D927430,2021-05-17
11124076,2021-05-17
11110384,2021-05-17
11125292,2021-05-17
11129502,2021-05-17
11084737,2021-05-16
11120710,2021-05-14
11130437,2021-05-14
11128636,2021-05-13
11125882,2021-05-13
D929616,2021-05-13
11110190,2021-05-13
11128468,2021-05-13
D929615,2021-05-13
D927230,2021-05-12
11133344,2021-05-12
11110448,2021-05-12
11130629,2021-05-12
11125299,2021-05-12
11116598,2021-05-11
11107490,2021-05-11
11130422,2021-05-11
D926253,2021-05-11
11081273,2021-05-11
D929378,2021-05-10
11131784,2021-05-10
D929819,2021-05-10
11112161,2021-05-07
11129797,2021-05-07
11096902,2021-05-07
11107129,2021-05-06
11132667,2021-05-06
11125489,2021-05-06
11131665,2021-05-05
11110488,2021-05-05
11097123,2021-05-05
Query:
SELECT c."patent_id", COUNT(*) AS "recent_backward_citations"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
WHERE TRY_TO_DATE(citing_app."date") IS NOT NULL
  AND TRY_TO_DATE(cited_app."date") IS NOT NULL
  AND DATEDIFF(day, TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 1825
GROUP BY c."patent_id"
HAVING COUNT(*) > 10
LIMIT 100
Answer:
patent_id,recent_backward_citations
D577026,42
D693350,22
D546747,16
D627408,14
D481119,16
D597266,19
D628778,14
D540850,28
D606044,11
D575035,22
D526990,25
D613484,15
D615986,16
D687405,15
D592335,11
D757459,23
D747924,11
D689088,13
D628178,25
D695744,54
D672908,11
D749149,12
D742676,27
D805454,51
D862443,43
D905122,11
D855394,17
D790159,13
D771011,21
D805064,26
10585247,13
D568879,24
D588150,13
D573970,12
D519757,17
D605438,13
D550768,11
D733698,13
D686589,19
D654490,16
D612850,13
D683297,16
D651204,20
D628369,25
D711906,12
D688638,19
D704673,11
D775225,27
D715318,13
D731718,11
D865611,31
D710390,11
D701178,17
D825073,26
D784259,14
D859501,21
D813838,26
D760206,31
D819380,11
D718778,19
D723535,15
D824712,14
D787003,25
D873727,24
D759311,20
D900920,37
D824810,142
D896257,51
D833470,11
D929517,15
D870783,13
D917140,14
D825427,16
D819198,14
11040610,46
D901502,29
D880477,11
D876944,16
8784318,11
8571335,18
9849216,22
8386002,20
9167946,106
D658641,14
D649866,18
D637605,11
D657684,14
D818647,16
D696274,11
D841620,12
D848285,13
D691144,21
D814599,19
D781104,11
D852985,17
D863107,22
D928740,49
D828993,20
D892006,22
D849848,11
End Exploring Related Columns
Task: Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTSVIEW': {'PATENTSVIEW': ['APPLICATION', 'ASSIGNEE', 'BOTANIC', 'BRF_SUM_TEXT', 'CLAIM', 'CLAIMS_2021', 'CPC_CURRENT', 'CPC_GROUP', 'CPC_SUBGROUP', 'CPC_SUBSECTION', 'DETAIL_DESC_TEXT_2021', 'DRAW_DESC_TEXT', 'DRAW_DESC_TEXT_2021', 'FIGURES', 'FOREIGNCITATION', 'FOREIGN_PRIORITY', 'GOVERNMENT_INTEREST', 'GOVERNMENT_ORGANIZATION', 'INVENTOR', 'INVENTOR_GENDER', 'IPCR', 'LAWYER', 'LOCATION', 'LOCATION_ASSIGNEE', 'LOCATION_INVENTOR', 'MAINCLASS', 'MAINCLASS_CURRENT', 'MATCH', 'NBER', 'NBER_CATEGORY', 'NBER_SUBCATEGORY', 'NON_INVENTOR_APPLICANT', 'OTHERREFERENCE', 'PATENT', 'PATENT_ASSIGNEE', 'PATENT_CONTRACTAWARDNUMBER', 'PATENT_GOVINTORG', 'PATENT_INVENTOR', 'PATENT_LAWYER', 'PCT_DATA', 'PERSISTENT_ASSIGNEE_DISAMBIG', 'PERSISTENT_INVENTOR_DISAMB', 'PERSISTENT_INVENTOR_DISAMBIG', 'RAWASSIGNEE', 'RAWEXAMINER', 'RAWINVENTOR', 'RAWLAWYER', 'RAWLOCATION', 'REL_APP_TEXT', 'SUBCLASS', 'SUBCLASS_CURRENT', 'USAPPLICATIONCITATION', 'USPATENTCITATION', 'USPC', 'USPC_CURRENT', 'USRELDOC', 'US_TERM_OF_GRANT', 'WIPO', 'WIPO_FIELD']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 02:15:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:15:48 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date") IS NOT NULL
      AND TRY_TO_DATE(cited_app."date") IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION our_app ON c."citation_id" = our_app."patent_id"
WHERE
    c."citation_id" = (SELECT "patent_id" FROM max_backward)
    AND TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(our_app."date") IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(our_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365
```
2025-01-25 02:15:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:15:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:15:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:15:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:15:52 - snowflake.connector.connection - INFO - closed
2025-01-25 02:15:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:15:52 - root - INFO - itercount: 1
2025-01-25 02:15:52 - root - INFO - 0
2025-01-25 02:15:52 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:15:52 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date") IS NOT NULL
      AND TRY_TO_DATE(cited_app."date") IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION our_app ON c."citation_id" = our_app."patent_id"
WHERE
    c."citation_id" = (SELECT "patent_id" FROM max_backward)
    AND TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(our_app."date") IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(our_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:17:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:17:00 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date") IS NOT NULL
      AND TRY_TO_DATE(cited_app."date") IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT citing_patent ON c."patent_id" = citing_patent."id"
WHERE
    c."citation_id" = (SELECT "patent_id" FROM max_backward)
    AND citing_patent."country" = 'US'
    AND TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(our_app."date") IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(our_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365
```
2025-01-25 02:17:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:17:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:17:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:17:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:17:04 - snowflake.connector.connection - INFO - closed
2025-01-25 02:17:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:17:04 - root - INFO - itercount: 2
2025-01-25 02:17:04 - root - INFO - 0
2025-01-25 02:17:04 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:17:04 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date") IS NOT NULL
      AND TRY_TO_DATE(cited_app."date") IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT citing_patent ON c."patent_id" = citing_patent."id"
WHERE
    c."citation_id" = (SELECT "patent_id" FROM max_backward)
    AND citing_patent."country" = 'US'
    AND TRY_TO_DATE(citing_app."date") IS NOT NULL
    AND TRY_TO_DATE(our_app."date") IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(our_app."date"), TRY_TO_DATE(citing_app."date")) BETWEEN 0 AND 365Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:18:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:18:37 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC
    LIMIT 1
),
our_app AS (
    SELECT "patent_id", TRY_TO_DATE("date", 'YYYY-MM-DD') AS "date"
    FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward)
      AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT citing_patent ON c."patent_id" = citing_patent."id"
WHERE
    citing_patent."country" = 'US'
    AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', our_app."date", TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:18:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:18:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:18:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:18:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:18:41 - snowflake.connector.connection - INFO - closed
2025-01-25 02:18:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:18:42 - root - INFO - itercount: 3
2025-01-25 02:18:42 - root - INFO - 0
2025-01-25 02:18:42 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:18:42 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC
    LIMIT 1
),
our_app AS (
    SELECT "patent_id", TRY_TO_DATE("date", 'YYYY-MM-DD') AS "date"
    FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward)
      AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT citing_patent ON c."patent_id" = citing_patent."id"
WHERE
    citing_patent."country" = 'US'
    AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', our_app."date", TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-25 02:19:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:19:53 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') >= '1800-01-01'
      AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') >= '1800-01-01'
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_app AS (
    SELECT "patent_id", MIN(TRY_TO_DATE("date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward)
      AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE("date", 'YYYY-MM-DD') >= '1800-01-01'
    GROUP BY "patent_id"
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE
    p_citing."country" = 'US'
    AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') >= '1800-01-01'
    AND DATEDIFF('day', our_app."application_date", TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:19:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:19:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:19:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:19:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:19:57 - snowflake.connector.connection - INFO - closed
2025-01-25 02:19:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:19:57 - root - INFO - itercount: 4
2025-01-25 02:19:57 - root - INFO - 0
2025-01-25 02:19:57 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:19:57 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') >= '1800-01-01'
      AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') >= '1800-01-01'
      AND DATEDIFF('day', TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_app AS (
    SELECT "patent_id", MIN(TRY_TO_DATE("date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward)
      AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE("date", 'YYYY-MM-DD') >= '1800-01-01'
    GROUP BY "patent_id"
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON c."patent_id" = citing_app."patent_id"
JOIN
    our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE
    p_citing."country" = 'US'
    AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') >= '1800-01-01'
    AND DATEDIFF('day', our_app."application_date", TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:21:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:21:08 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT
        c."patent_id",
        COUNT(*) AS "num_backward_citations"
    FROM
        PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN
        PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE
        p."country" = 'US'
        AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
        AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') IS NOT NULL
        AND DATEDIFF('day', TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY
        c."patent_id"
    ORDER BY
        "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_app AS (
    SELECT
        "patent_id",
        MIN(TRY_TO_DATE("date", 'YYYY-MM-DD')) AS "application_date"
    FROM
        PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE
        "patent_id" = (SELECT "patent_id" FROM backward_citations)
        AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
    GROUP BY
        "patent_id"
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
WHERE
    p_citing."country" = 'US'
    AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', our_app."application_date", TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:21:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:21:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:21:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:21:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:21:12 - snowflake.connector.connection - INFO - closed
2025-01-25 02:21:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:21:12 - root - INFO - itercount: 5
2025-01-25 02:21:12 - root - INFO - 0
2025-01-25 02:21:12 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:21:12 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT
        c."patent_id",
        COUNT(*) AS "num_backward_citations"
    FROM
        PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN
        PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c ON p."id" = c."patent_id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION citing_app ON p."id" = citing_app."patent_id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION cited_app ON c."citation_id" = cited_app."patent_id"
    WHERE
        p."country" = 'US'
        AND TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD') IS NOT NULL
        AND TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD') IS NOT NULL
        AND DATEDIFF('day', TRY_TO_DATE(cited_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(citing_app."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY
        c."patent_id"
    ORDER BY
        "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_app AS (
    SELECT
        "patent_id",
        MIN(TRY_TO_DATE("date", 'YYYY-MM-DD')) AS "application_date"
    FROM
        PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE
        "patent_id" = (SELECT "patent_id" FROM backward_citations)
        AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
    GROUP BY
        "patent_id"
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    our_app ON c."citation_id" = our_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
WHERE
    p_citing."country" = 'US'
    AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', our_app."application_date", TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:22:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:22:45 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT
        c."patent_id",
        COUNT(*) AS "num_backward_citations"
    FROM
        PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN
        PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION app_cited ON c."citation_id" = app_cited."patent_id"
    WHERE
        p."country" = 'US'
        AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
        AND TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD') IS NOT NULL
        AND DATEDIFF('day', TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD'), TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY
        c."patent_id"
),
max_backward AS (
    SELECT
        "patent_id"
    FROM
        backward_citations
    ORDER BY
        "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_patent_app AS (
    SELECT
        "patent_id",
        MIN(TRY_TO_DATE("date", 'YYYY-MM-DD')) AS "application_date"
    FROM
        PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE
        "patent_id" = (SELECT "patent_id" FROM max_backward)
        AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
    GROUP BY
        "patent_id"
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
JOIN
    our_patent_app ON c."citation_id" = our_patent_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE
    p_citing."country" = 'US'
    AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', our_patent_app."application_date", TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:22:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:22:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:22:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:22:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:22:48 - snowflake.connector.connection - INFO - closed
2025-01-25 02:22:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:22:49 - root - INFO - itercount: 6
2025-01-25 02:22:49 - root - INFO - 0
2025-01-25 02:22:49 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:22:49 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT
        c."patent_id",
        COUNT(*) AS "num_backward_citations"
    FROM
        PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN
        PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
    JOIN
        PATENTSVIEW.PATENTSVIEW.APPLICATION app_cited ON c."citation_id" = app_cited."patent_id"
    WHERE
        p."country" = 'US'
        AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
        AND TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD') IS NOT NULL
        AND DATEDIFF('day', TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD'), TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY
        c."patent_id"
),
max_backward AS (
    SELECT
        "patent_id"
    FROM
        backward_citations
    ORDER BY
        "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_patent_app AS (
    SELECT
        "patent_id",
        MIN(TRY_TO_DATE("date", 'YYYY-MM-DD')) AS "application_date"
    FROM
        PATENTSVIEW.PATENTSVIEW.APPLICATION
    WHERE
        "patent_id" = (SELECT "patent_id" FROM max_backward)
        AND TRY_TO_DATE("date", 'YYYY-MM-DD') IS NOT NULL
    GROUP BY
        "patent_id"
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
JOIN
    our_patent_app ON c."citation_id" = our_patent_app."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE
    p_citing."country" = 'US'
    AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', our_patent_app."application_date", TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:23:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:23:40 - root - INFO - ```sql
WITH patent_applications AS (
    SELECT p."id" AS "patent_id", MIN(TRY_TO_DATE(a."date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
    WHERE p."country" = 'US' AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL
    GROUP BY p."id"
),
backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN patent_applications pa_citing ON c."patent_id" = pa_citing."patent_id"
    JOIN patent_applications pa_cited ON c."citation_id" = pa_cited."patent_id"
    WHERE DATEDIFF('day', pa_cited."application_date", pa_citing."application_date") BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_patent_app AS (
    SELECT "patent_id", "application_date"
    FROM patent_applications
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward)
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    patent_applications pa_citing ON c."patent_id" = pa_citing."patent_id"
JOIN
    our_patent_app opa ON c."citation_id" = opa."patent_id"
WHERE
    DATEDIFF('day', opa."application_date", pa_citing."application_date") BETWEEN 0 AND 365;
```
2025-01-25 02:23:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:23:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:23:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:23:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:23:42 - snowflake.connector.connection - INFO - closed
2025-01-25 02:23:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:23:43 - root - INFO - itercount: 7
2025-01-25 02:23:43 - root - INFO - 0
2025-01-25 02:23:43 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:23:43 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH patent_applications AS (
    SELECT p."id" AS "patent_id", MIN(TRY_TO_DATE(a."date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
    WHERE p."country" = 'US' AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL
    GROUP BY p."id"
),
backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN patent_applications pa_citing ON c."patent_id" = pa_citing."patent_id"
    JOIN patent_applications pa_cited ON c."citation_id" = pa_cited."patent_id"
    WHERE DATEDIFF('day', pa_cited."application_date", pa_citing."application_date") BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
),
our_patent_app AS (
    SELECT "patent_id", "application_date"
    FROM patent_applications
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward)
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    patent_applications pa_citing ON c."patent_id" = pa_citing."patent_id"
JOIN
    our_patent_app opa ON c."citation_id" = opa."patent_id"
WHERE
    DATEDIFF('day', opa."application_date", pa_citing."application_date") BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:25:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:25:21 - root - INFO - ```sql
WITH max_backward_citations AS (
    SELECT c."patent_id" AS "our_patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION app_cited ON c."citation_id" = app_cited."patent_id"
    WHERE p_citing."country" = 'US'
      AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD'), TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION our_app ON c."citation_id" = our_app."patent_id"
WHERE
    c."citation_id" = (SELECT "our_patent_id" FROM max_backward_citations)
    AND p_citing."country" = 'US'
    AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(our_app."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(our_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:25:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:25:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:25:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:25:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:25:24 - snowflake.connector.connection - INFO - closed
2025-01-25 02:25:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:25:24 - root - INFO - itercount: 8
2025-01-25 02:25:24 - root - INFO - 0
2025-01-25 02:25:24 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:25:24 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH max_backward_citations AS (
    SELECT c."patent_id" AS "our_patent_id", COUNT(*) AS "num_backward_citations"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION app_cited ON c."citation_id" = app_cited."patent_id"
    WHERE p_citing."country" = 'US'
      AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day', TRY_TO_DATE(app_cited."date", 'YYYY-MM-DD'), TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY "num_backward_citations" DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION app_citing ON c."patent_id" = app_citing."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.APPLICATION our_app ON c."citation_id" = our_app."patent_id"
WHERE
    c."citation_id" = (SELECT "our_patent_id" FROM max_backward_citations)
    AND p_citing."country" = 'US'
    AND TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(our_app."date", 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(our_app."date", 'YYYY-MM-DD'), TRY_TO_DATE(app_citing."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:26:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:26:27 - root - INFO - ```sql
WITH patent_application_dates AS (
    SELECT p."id" AS "patent_id", MIN(TRY_TO_DATE(a."date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
    WHERE p."country" = 'US' AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') >= '1800-01-01'
    GROUP BY p."id"
),
backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN patent_application_dates citing_pa ON c."patent_id" = citing_pa."patent_id"
    JOIN patent_application_dates cited_pa ON c."citation_id" = cited_pa."patent_id"
    WHERE DATEDIFF('day', cited_pa."application_date", citing_pa."application_date") BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_patent AS (
    SELECT "patent_id", num_backward_citations
    FROM backward_citations
    ORDER BY num_backward_citations DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    patent_application_dates citing_pa ON c."patent_id" = citing_pa."patent_id"
JOIN
    patent_application_dates our_pa ON c."citation_id" = our_pa."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE
    c."citation_id" = (SELECT "patent_id" FROM max_backward_patent)
    AND p_citing."country" = 'US'
    AND DATEDIFF('day', our_pa."application_date", citing_pa."application_date") BETWEEN 0 AND 365;
```
2025-01-25 02:26:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:26:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:26:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:26:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:26:29 - snowflake.connector.connection - INFO - closed
2025-01-25 02:26:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:26:30 - root - INFO - itercount: 9
2025-01-25 02:26:30 - root - INFO - 0
2025-01-25 02:26:30 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:26:30 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH patent_application_dates AS (
    SELECT p."id" AS "patent_id", MIN(TRY_TO_DATE(a."date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
    WHERE p."country" = 'US' AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') >= '1800-01-01'
    GROUP BY p."id"
),
backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN patent_application_dates citing_pa ON c."patent_id" = citing_pa."patent_id"
    JOIN patent_application_dates cited_pa ON c."citation_id" = cited_pa."patent_id"
    WHERE DATEDIFF('day', cited_pa."application_date", citing_pa."application_date") BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_patent AS (
    SELECT "patent_id", num_backward_citations
    FROM backward_citations
    ORDER BY num_backward_citations DESC NULLS LAST
    LIMIT 1
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM
    PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN
    patent_application_dates citing_pa ON c."patent_id" = citing_pa."patent_id"
JOIN
    patent_application_dates our_pa ON c."citation_id" = our_pa."patent_id"
JOIN
    PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE
    c."citation_id" = (SELECT "patent_id" FROM max_backward_patent)
    AND p_citing."country" = 'US'
    AND DATEDIFF('day', our_pa."application_date", citing_pa."application_date") BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:27:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:27:57 - root - INFO - ```sql
WITH patent_application_dates AS (
    SELECT p."id" AS "patent_id", MIN(TO_DATE(a."date", 'YYYY-MM-DD')) AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
    WHERE p."country" = 'US' AND a."date" IS NOT NULL
    GROUP BY p."id"
),
backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN patent_application_dates citing_pa ON c."patent_id" = citing_pa."patent_id"
    JOIN patent_application_dates cited_pa ON c."citation_id" = cited_pa."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p_cited ON c."citation_id" = p_cited."id"
    WHERE p_cited."country" = 'US'
      AND DATEDIFF('day', cited_pa."application_date", citing_pa."application_date") BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_patent AS (
    SELECT "patent_id", num_backward_citations
    FROM backward_citations
    ORDER BY num_backward_citations DESC NULLS LAST
    LIMIT 1
),
our_pa AS (
    SELECT "patent_id", "application_date"
    FROM patent_application_dates
    WHERE "patent_id" = (SELECT "patent_id" FROM max_backward_patent)
)
SELECT
    COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN patent_application_dates citing_pa ON c."patent_id" = citing_pa."patent_id"
JOIN our_pa ON c."citation_id" = our_pa."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.PATENT p_citing ON c."patent_id" = p_citing."id"
WHERE p_citing."country" = 'US'
  AND DATEDIFF('day', our_pa."application_date", citing_pa."application_date") BETWEEN 0 AND 365;
```
2025-01-25 02:27:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:27:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:27:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:27:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:27:59 - snowflake.connector.connection - INFO - closed
2025-01-25 02:27:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:27:59 - root - INFO - Total iteration counts: 10
