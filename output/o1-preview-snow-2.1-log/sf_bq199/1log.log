2025-01-26 00:00:35 - openai._base_client - INFO - Retrying request to /chat/completions in 0.398043 seconds
2025-01-26 00:01:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:01:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:01:18 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:18 - root - INFO - SQL:
SELECT DISTINCT "category_name"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
Results:
category_name
IMPORTED WHISKIES
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100 PROOF VODKA
WHITE CREME DE CACAO
COCKTAILS/RTD
LOW PROOF VODKA
MISC. AMERICAN CORDIALS & LIQUEURS
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
AMERICAN FLAVORED VODKA
DECANTERS & SPECIALTY PACKAGES
GOLD RUM
IMPORTED SCHNAPPS
IOWA DISTILLERY WHISKIES
AMARETTO - IMPORTED
PUERTO RICO & VIRGIN ISLANDS RUM
BOTTLED IN BOND BOURBON
SINGLE MALT SCOTCH
WHISKEY LIQUEUR
PEACH BRANDIES
JAPANESE WHISKY
SPICED RUM
AMERICAN DISTILLED SPIRITS SPECIALTY
PEPPERMINT SCHNAPPS
CORN WHISKIES
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
AMERICAN GRAPE BRANDIES
MEZCAL
IOWA DISTILLERIES
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
IMPORTED GINS
CINNAMON SCHNAPPS
""
AMERICAN SCHNAPPS
ROCK & RYE
AMERICAN VODKAS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
IMPORTED VODKA - CHERRY
AMERICAN AMARETTO
WHITE RUM
IMPORTED BRANDIES
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
FLAVORED GIN
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS
JAMAICA RUM
WHITE CREME DE MENTHE
CHERRY BRANDIES
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
SCOTCH WHISKIES
100% AGAVE TEQUILA
SINGLE BARREL BOURBON WHISKIES
ROOT BEER SCHNAPPS
SPEARMINT SCHNAPPS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
TROPICAL FRUIT SCHNAPPS
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
IMPORTED VODKAS
IMPORTED DRY GINS
BLACKBERRY BRANDIES
AMERICAN COCKTAILS
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AGED DARK RUM
MIXTO TEQUILA
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
APPLE SCHNAPPS
SPECIAL ORDER ITEMS
ANISETTE
IMPORTED CORDIALS & LIQUEURS
FLAVORED RUM
AMERICAN WHISKIES
CANADIAN WHISKIES
AMERICAN BRANDIES

2025-01-26 00:01:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:01:20 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:20 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021
   LIMIT 100;
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-06-09,IMPORTED SCHNAPPS,38.97,2.25
2021-11-24,IMPORTED SCHNAPPS,38.97,2.25
2021-03-08,IMPORTED SCHNAPPS,48.0,2.25
2021-06-25,IMPORTED SCHNAPPS,48.0,2.25
2021-03-08,IMPORTED SCHNAPPS,48.0,2.25
2021-08-17,IMPORTED SCHNAPPS,38.97,2.25
2021-03-11,IMPORTED SCHNAPPS,38.97,2.25
2021-08-12,IMPORTED SCHNAPPS,38.97,2.25
2021-10-04,IMPORTED SCHNAPPS,38.97,2.25
2021-04-16,IMPORTED SCHNAPPS,38.97,2.25
2021-12-17,IMPORTED SCHNAPPS,65.34,2.25
2021-11-05,IMPORTED SCHNAPPS,58.5,2.25
2021-07-09,COCKTAILS/RTD,54.0,2.25
2021-09-10,FLAVORED RUM,40.77,2.25
2021-03-02,FLAVORED RUM,40.77,2.25
2021-12-10,CREAM LIQUEURS,60.75,2.25
2021-09-16,CREAM LIQUEURS,60.75,2.25
2021-12-30,CREAM LIQUEURS,60.75,2.25
2021-03-29,CREAM LIQUEURS,60.75,2.25
2021-07-16,AMERICAN CORDIALS & LIQUEURS,60.75,2.25
2021-12-28,AMERICAN CORDIALS & LIQUEURS,60.75,2.25
2021-02-11,AMERICAN CORDIALS & LIQUEURS,58.5,2.25
2021-12-29,AMERICAN CORDIALS & LIQUEURS,60.75,2.25
2021-01-05,COFFEE LIQUEURS,22.38,2.25
2021-03-16,AMERICAN SCHNAPPS,29.25,2.25
2021-10-22,AMERICAN CORDIALS & LIQUEURS,36.0,2.25
2021-12-01,AMERICAN CORDIALS & LIQUEURS,36.0,2.25
2021-05-13,AMERICAN CORDIALS & LIQUEURS,36.0,2.25
2021-02-22,AMERICAN CORDIALS & LIQUEURS,27.0,2.25
2021-09-15,CREAM LIQUEURS,76.5,2.25
2021-08-17,TENNESSEE WHISKIES,70.08,2.25
2021-09-21,TENNESSEE WHISKIES,70.08,2.25
2021-11-17,TENNESSEE WHISKIES,70.08,2.25
2021-09-24,AMERICAN DISTILLED SPIRITS SPECIALTY,87.75,2.25
2021-12-22,AMERICAN DISTILLED SPIRITS SPECIALTY,87.75,2.25
2021-08-09,IMPORTED FLAVORED VODKA,51.0,2.25
2021-04-13,IMPORTED FLAVORED VODKA,51.0,2.25
2021-09-15,IMPORTED FLAVORED VODKA,51.0,2.25
2021-02-26,IMPORTED FLAVORED VODKA,51.0,2.25
2021-09-28,IMPORTED FLAVORED VODKA,51.0,2.25
2021-09-23,IMPORTED FLAVORED VODKA,51.0,2.25

2025-01-26 00:01:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:01:22 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:22 - root - INFO - SQL:
SELECT "sale_dollars", "volume_sold_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
Results:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05

2025-01-26 00:01:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:01:24 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:24 - root - INFO - SQL:
SELECT ("sale_dollars" / "volume_sold_liters") AS "price_per_liter"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE "volume_sold_liters" > 0
   LIMIT 100;
Results:
price_per_liter
39.82666666666667
40.0
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
31.959999999999997
30.919999999999998
33.0
31.959999999999997
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
26.026666666666667
31.0
31.0
29.0
29.0
26.026666666666667
31.0
29.0
29.0
29.0
27.0
29.0
31.0
29.0
29.0
29.0
29.0
27.0
43.013333333333335
26.10666666666667
28.0
26.0
26.0
25.506666666666668
24.986666666666665
26.0
27.0
25.506666666666668
25.506666666666668
25.506666666666668
25.506666666666668
27.0
25.506666666666668
39.97333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
46.626666666666665
46.61333333333333
45.0
46.626666666666665
46.61333333333333
46.626666666666665
46.0
46.61333333333333
46.61333333333333
45.0
46.61333333333333
46.61333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
21.0
21.0
23.653333333333332
28.0
24.0
19.666666666666668
19.653333333333332
19.666666666666668
19.986666666666665
19.666666666666668
18.32
19.653333333333332
19.666666666666668
20.693333333333335
19.653333333333332
20.0
18.32
19.666666666666668
19.986666666666665
18.333333333333332
18.986666666666665
19.986666666666665
19.986666666666665
18.986666666666665
18.666666666666668

2025-01-26 00:01:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:01:26 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:26 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021
   GROUP BY "category_name"
   LIMIT 100;
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
100% AGAVE TEQUILA,23915928.889999993
SCOTCH WHISKIES,5719870.569999998
SINGLE BARREL BOURBON WHISKIES,1066574.4600000002
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.049999997
IMPORTED SCHNAPPS,6637742.609999999
COFFEE LIQUEURS,2126049.5400000005
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000001
IMPORTED FLAVORED VODKA,5785184.289999998
WHISKEY LIQUEUR,24665650.71
BOTTLED IN BOND BOURBON,694701.2699999998
SINGLE MALT SCOTCH,4454879.359999999
COCKTAILS/RTD,8692059.71
AMERICAN FLAVORED VODKA,10537284.849999998
FLAVORED GIN,388056.5400000001
SPECIAL ORDER ITEMS,1523594.6000000003
IMPORTED GINS,3186.72
AGED DARK RUM,1073387.53
MIXTO TEQUILA,10668562.36
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999997
CREAM LIQUEURS,8860918.940000001
IMPORTED DRY GINS,5602434.380000001
IMPORTED VODKAS,14556785.38
FLAVORED RUM,9023511.589999998
IMPORTED CORDIALS & LIQUEURS,11206838.639999995
AMERICAN WHISKIES,1881.0
MEZCAL,430727.73
BLENDED WHISKIES,12635514.849999998
GOLD RUM,1162585.6700000002
IMPORTED BRANDIES,15995277.500000004
AMERICAN CORDIALS & LIQUEURS,4293640.07
AMERICAN SLOE GINS,31666.350000000006
WHITE RUM,6709359.589999998
AMERICAN SCHNAPPS,6561224.369999999
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.3799999997
CORN WHISKIES,442212.51999999996
AMERICAN DRY GINS,3712780.8
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
AMERICAN VODKAS,61440411.240000024
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.830000006
CANADIAN WHISKIES,47392655.67
AMERICAN BRANDIES,5216033.320000001
TEMPORARY & SPECIALTY PACKAGES,10174030.040000001

2025-01-26 00:01:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:01:27 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:28 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021 AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   LIMIT 100;
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
100% AGAVE TEQUILA,38.690348969834034
SCOTCH WHISKIES,24.254713885217736
SINGLE BARREL BOURBON WHISKIES,45.24511724094048
IMPORTED FLAVORED VODKA,21.643416192740222
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553686
COFFEE LIQUEURS,22.129367390670087
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.94450721689939
COCKTAILS/RTD,7.8800405248154375
IMPORTED GINS,29.506666666666664
CREAM LIQUEURS,23.566367164593295
IMPORTED SCHNAPPS,18.977555582907012
WHISKEY LIQUEUR,21.373583265167575
SINGLE MALT SCOTCH,60.885541103295026
BOTTLED IN BOND BOURBON,31.34650618175255
FLAVORED GIN,28.508519352480718
BLENDED WHISKIES,14.89798444555805
AMERICAN DRY GINS,10.659231884796098
MIXTO TEQUILA,16.6948587928507
AMERICAN FLAVORED VODKA,14.778221731089833
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN VODKAS,10.783467469100112
AGED DARK RUM,25.435000189568072
TRIPLE SEC,4.062804851178789
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766428
GOLD RUM,11.54485568355306
IMPORTED BRANDIES,48.258683719642995
SPECIAL ORDER ITEMS,12.158831483951698
IMPORTED DRY GINS,25.64094711101976
IMPORTED VODKAS,17.8491992271601
NEUTRAL GRAIN SPIRITS,16.93204748682005
DISTILLED SPIRITS SPECIALTY,46.666666666666664
STRAIGHT RYE WHISKIES,41.683642868782925
STRAIGHT BOURBON WHISKIES,25.70818919158894
FLAVORED RUM,15.466602183579408
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
AMERICAN WHISKIES,38.0
MEZCAL,43.15801006988802
AMERICAN CORDIALS & LIQUEURS,17.003420849153276
AMERICAN SLOE GINS,8.129999999999999
SPICED RUM,15.600406892036029
AMERICAN DISTILLED SPIRITS SPECIALTY,26.87902336877481
CORN WHISKIES,43.020967020138144
CANADIAN WHISKIES,15.64668188921957
AMERICAN BRANDIES,12.525057326504214
WHITE RUM,10.964751984850398
TEMPORARY & SPECIALTY PACKAGES,29.721942148779643

2025-01-26 00:01:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:01:29 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:30 - root - INFO - SQL:
SELECT 
     "category_name",
     YEAR("date") AS "year",
     (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
   GROUP BY "category_name", YEAR("date")
   LIMIT 100;
Results:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399702
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.13
CANADIAN WHISKIES,2020,14.945131655072625
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474596
BLENDED WHISKIES,2021,14.897984445558048
COFFEE LIQUEURS,2019,21.073586682369243
SPICED RUM,2020,15.345321660461218
COCKTAILS/RTD,2021,7.880040524815443
TENNESSEE WHISKIES,2021,30.944507216899392
CREAM LIQUEURS,2019,21.44355441784796
SPICED RUM,2021,15.600406892036023
IMPORTED VODKAS,2021,17.849199227160096
SPICED RUM,2019,15.426264276542772
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.88952876216467
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094048
AGED DARK RUM,2019,22.563808617147032
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DRY GINS,2019,9.715900992663789
IMPORTED BRANDIES,2020,44.210873670062206
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
AMERICAN FLAVORED VODKA,2021,14.778221731089825
IMPORTED SCHNAPPS,2021,18.977555582907016
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461906
AMERICAN VODKAS,2019,9.905176669185822
IMPORTED BRANDIES,2019,43.539679243138096
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.619786967633495
AMERICAN SLOE GINS,2021,8.13
100% AGAVE TEQUILA,2020,34.803301084015715
TRIPLE SEC,2020,4.148281073749889
AMERICAN VODKAS,2020,10.37159267048766
NEUTRAL GRAIN SPIRITS,2019,17.01644187052472
SINGLE MALT SCOTCH,2019,57.15989001475904
TEMPORARY & SPECIALTY PACKAGES,2021,29.72194214877965
SINGLE MALT SCOTCH,2021,60.88554110329501
MEZCAL,2021,43.15801006988803
IMPORTED DRY GINS,2020,25.539127017730863
WHISKEY LIQUEUR,2020,20.730351917360554
CANADIAN WHISKIES,2021,15.646681889219572
IMPORTED FLAVORED VODKA,2020,21.571944764231883
CREAM LIQUEURS,2021,23.566367164593306
IRISH WHISKIES,2020,30.62602456955368
CORN WHISKIES,2020,43.984085752070726
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553065
STRAIGHT BOURBON WHISKIES,2020,23.926092815813533
SPECIAL ORDER ITEMS,2020,11.042254060180483
NEUTRAL GRAIN SPIRITS,2020,15.882001897018917
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.844823153258522
IMPORTED WHISKIES,2021,122.63999999999999
IMPORTED FLAVORED VODKA,2021,21.64341619274022
AGED DARK RUM,2021,25.435000189568072
STRAIGHT BOURBON WHISKIES,2019,22.33825638967842
BOTTLED IN BOND BOURBON,2021,31.346506181752556
SINGLE BARREL BOURBON WHISKIES,2020,43.45435421500387
SPECIAL ORDER ITEMS,2021,12.158831483951698
IMPORTED DRY GINS,2019,25.14449714106277
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.857767776179166
FLAVORED RUM,2019,15.046644580058297
AMERICAN BRANDIES,2019,12.354296281418298
DISTILLED SPIRITS SPECIALTY,2020,41.00539396078036
AMERICAN CORDIALS & LIQUEURS,2021,17.00342084915327
CREAM LIQUEURS,2020,22.742294325622787
IMPORTED SCHNAPPS,2020,19.254555188977086
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638388
NEUTRAL GRAIN SPIRITS,2021,16.932047486820053
MEZCAL,2020,39.04244202822056
TENNESSEE WHISKIES,2020,30.66874081058491
AMERICAN BRANDIES,2020,12.511142937266236
TEMPORARY & SPECIALTY PACKAGES,2020,28.02001031400777
IMPORTED DRY GINS,2021,25.64094711101976
AMERICAN DRY GINS,2020,10.61701159020084
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840916
WHISKEY LIQUEUR,2019,17.79668226153553
AMERICAN FLAVORED VODKA,2020,14.375297199122384
AMERICAN BRANDIES,2021,12.525057326504212
IOWA DISTILLERY WHISKIES,2019,44.984125849124055
GOLD RUM,2020,11.352277433620902
WHITE RUM,2019,10.546667376514389
IMPORTED SCHNAPPS,2019,18.954484643888566
BOTTLED IN BOND BOURBON,2019,28.078917260273972
TRIPLE SEC,2019,4.085114256272668
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.879023368774806
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766426
AMERICAN SLOE GINS,2019,8.53209241499564
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842865
AMERICAN DRY GINS,2021,10.659231884796094
WHITE RUM,2021,10.964751984850398
MEZCAL,2019,39.29683802816901
SCOTCH WHISKIES,2019,21.45216209746601
MIXTO TEQUILA,2020,16.81811637478133
IMPORTED GINS,2021,29.506666666666664

2025-01-26 00:01:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:01:31 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:33 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021 AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   ORDER BY "avg_price_per_liter_2021" DESC
   LIMIT 10;
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.885541103295026
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094048
MEZCAL,43.15801006988803
CORN WHISKIES,43.02096702013814
STRAIGHT RYE WHISKIES,41.68364286878291
100% AGAVE TEQUILA,38.690348969834034
AMERICAN WHISKIES,38.0

2025-01-26 00:01:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 51
2025-01-26 00:01:35 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:01:35 - root - INFO - SQL:
SELECT
     "category_name",
     AVG(CASE WHEN YEAR("date") = 2019 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
     AVG(CASE WHEN YEAR("date") = 2020 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
     AVG(CASE WHEN YEAR("date") = 2021 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   LIMIT 100;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IMPORTED WHISKIES,,,122.63999999999999
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839592,67.04129026491188
SCOTCH WHISKIES,38.165624002982476,46.20837834035606,43.60865760092795
100% AGAVE TEQUILA,53.463127666314485,62.00248889783082,49.89756178988085
SINGLE BARREL BOURBON WHISKIES,39.53667861409796,47.00520962540312,49.255214507479536
COFFEE LIQUEURS,28.21844631804037,35.328731945040204,34.39183419198717
IMPORTED GINS,,29.506666666666668,29.506666666666664
WHISKEY LIQUEUR,87.97801137222733,194.19179627184778,174.76841460973736
SINGLE MALT SCOTCH,65.34125774002436,70.52012090655106,69.1125472066271
BOTTLED IN BOND BOURBON,30.578072162785823,38.27726377262402,39.58066886446885
COCKTAILS/RTD,8.212979654786865,9.772540043975074,11.735321999830356
IMPORTED FLAVORED VODKA,27.809870620861272,29.344069448880145,26.034077129118284
NEUTRAL GRAIN SPIRITS FLAVORED,42.571947275922675,57.50635858234885,93.9471378460607
IMPORTED DRY GINS,26.48205366726885,30.10448774673491,34.40948523840317
IMPORTED VODKAS,33.94282101537268,50.43275694766234,52.64830400519427
MIXTO TEQUILA,31.837582550848413,47.129571205397355,56.96746636137455
SPECIAL ORDER ITEMS,38.93629452760654,38.31677534424565,49.975782341659226
AMERICAN FLAVORED VODKA,19.359387465602904,26.18978392884919,29.025127878014096
IOWA DISTILLERY WHISKIES,56.853846153846135,53.18666666666667,
IRISH WHISKIES,43.27135576698969,51.40246272246467,41.48447550141956
TENNESSEE WHISKIES,51.967097550423084,81.42800903781644,97.68531463293048
AGED DARK RUM,24.951028244979067,27.08275132275132,28.470402364198655
FLAVORED GIN,14.612340966921114,16.77274280136652,87.1866108675435
MEZCAL,41.350583580613254,40.60712506486767,44.22890839041096
IMPORTED DISTILLED SPIRITS SPECIALTY,15.692297934779745,23.00392800514591,22.744303165271706
TRIPLE SEC,4.3579375470278405,4.449197714598516,4.342926065162907
CREAM LIQUEURS,34.84226262444941,53.696614152940676,58.35006208884961
,20.75208931165227,28.37729886358918,
FLAVORED RUM,19.31172430289187,25.591920869013798,23.266876296999577
IMPORTED CORDIALS & LIQUEURS,44.53190786892556,64.10986935241029,65.4116998219505
GOLD RUM,17.958248098089964,23.199210662534902,23.669004543525812
AMERICAN WHISKIES,,,38.0
SPICED RUM,21.188301231387907,27.88929072336502,29.534264387741956
AMERICAN DISTILLED SPIRITS SPECIALTY,25.724575320169613,65.16782744282742,35.820757744733584
CORN WHISKIES,31.184231678486984,35.13320881971466,40.0773285198556
IMPORTED BRANDIES,54.02600405472328,69.90961987353661,57.39853770766352
WHITE RUM,17.656370727725957,24.50097526606747,26.315446670851767
CANADIAN WHISKIES,28.623783191786266,42.08775328972834,40.79021499316633
AMERICAN BRANDIES,16.152836498476987,20.322498148126662,20.37991819810992
STRAIGHT RYE WHISKIES,40.49802776541434,58.88887511340513,63.68111754218403
STRAIGHT BOURBON WHISKIES,33.314401284573215,41.33540778972636,47.55587724596054
DELISTED / SPECIAL ORDER ITEMS,,37.0,
AMERICAN DRY GINS,14.10050937128047,19.476307783960365,19.691440523146266
TEMPORARY & SPECIALTY PACKAGES,42.15541112225676,74.73013356849815,139.81430923521975
AMERICAN CORDIALS & LIQUEURS,29.148327547171217,64.25759031021087,135.32257763155843
AMERICAN SLOE GINS,8.43911528150134,8.129999999999999,8.129999999999999
AMERICAN VODKAS,17.737137185778874,26.3801532250147,28.90835493634657
BLENDED WHISKIES,19.395395197045108,30.517439358916437,39.082210088048036
NEUTRAL GRAIN SPIRITS,17.47945926973662,16.480406118643636,17.14366921883205
DISTILLED SPIRITS SPECIALTY,,44.098628364389214,46.666666666666686
AMERICAN SCHNAPPS,23.146407887509646,53.74331643730583,60.283603807457176

2025-01-26 00:01:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:01:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:01:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:01:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 00:01:37 - snowflake.connector.connection - INFO - closed
2025-01-26 00:01:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:02:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:02:09 - root - INFO - ```sql
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:02:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:02:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:02:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:02:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:02:11 - snowflake.connector.connection - INFO - closed
2025-01-26 00:02:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:03:10 - root - INFO - SQL:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
,20.752089311652263,28.377298863589196,
IOWA DISTILLERY WHISKIES,56.853846153846135,53.18666666666667,
DELISTED / SPECIAL ORDER ITEMS,,37.0,
WHISKEY LIQUEUR,87.97801137222733,194.1917962718478,174.76841460973736
TEMPORARY & SPECIALTY PACKAGES,42.15541112225677,74.7301335684981,139.81430923521975
AMERICAN CORDIALS & LIQUEURS,29.14832754717122,64.25759031021087,135.32257763155843
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.9670975504231,81.42800903781644,97.6853146329305
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592266,57.50635858234885,93.9471378460607
FLAVORED GIN,14.612340966921114,16.772742801366523,87.1866108675435

2025-01-26 00:03:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:03:12 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:12 - root - INFO - SQL:
SELECT DISTINCT "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
MISC. AMERICAN CORDIALS & LIQUEURS
IMPORTED SCHNAPPS
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMARETTO - IMPORTED
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
IMPORTED VODKA - CHERRY
AMERICAN VODKAS
AMERICAN AMARETTO
CHERRY BRANDIES
IOWA DISTILLERIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
RASPBERRY SCHNAPPS
IMPORTED BRANDIES
DECANTERS & SPECIALTY PACKAGES
MIXTO TEQUILA
IOWA DISTILLERY WHISKIES
GOLD RUM
PUERTO RICO & VIRGIN ISLANDS RUM
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AMERICAN FLAVORED VODKA
AMERICAN WHISKIES
TROPICAL FRUIT SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
100 PROOF VODKA
WHITE CREME DE CACAO
""
AGED DARK RUM
IMPORTED AMARETTO
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
ANISETTE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN SCHNAPPS
ROCK & RYE
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
FLAVORED GIN
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS

2025-01-26 00:03:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:03:14 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:14 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
LIMIT 100
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-12-07,IMPORTED CORDIALS & LIQUEURS,65.31,2.25
2021-08-06,IMPORTED CORDIALS & LIQUEURS,65.25,2.25
2021-11-16,IMPORTED CORDIALS & LIQUEURS,78.75,2.25
2021-02-24,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-09-10,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-03-29,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-12-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-12-20,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-10-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-06-25,CREAM LIQUEURS,42.75,2.25
2021-07-29,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-08,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-22,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-07,IMPORTED FLAVORED VODKA,74.22,2.25
2021-08-31,IMPORTED CORDIALS & LIQUEURS,74.25,2.25
2021-04-29,IMPORTED CORDIALS & LIQUEURS,85.86,2.25
2021-01-05,IMPORTED FLAVORED VODKA,74.22,2.25
2021-09-14,IMPORTED CORDIALS & LIQUEURS,61.08,2.25
2021-04-27,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-11-08,WHISKEY LIQUEUR,48.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-07-07,WHISKEY LIQUEUR,48.0,2.25
2021-02-15,WHISKEY LIQUEUR,48.0,2.25
2021-10-13,WHISKEY LIQUEUR,40.41,2.25
2021-11-01,WHISKEY LIQUEUR,40.41,2.25
2021-02-03,WHISKEY LIQUEUR,40.41,2.25
2021-09-27,WHISKEY LIQUEUR,40.5,2.25
2021-08-17,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-24,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-30,IMPORTED SCHNAPPS,58.5,2.25
2021-12-21,IMPORTED SCHNAPPS,58.5,2.25
2021-08-04,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-18,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-19,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-29,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-25,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-02-01,IMPORTED CORDIALS & LIQUEURS,44.97,2.25
2021-04-23,CREAM LIQUEURS,51.75,2.25
2021-10-01,CREAM LIQUEURS,51.75,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.48,2.25

2025-01-26 00:03:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:03:15 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:16 - root - INFO - SQL:
SELECT "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05

2025-01-26 00:03:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:03:17 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:18 - root - INFO - SQL:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
LIMIT 100
Results:
price_per_liter
39.82666666666667
40.0
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
31.959999999999997
30.919999999999998
33.0
31.959999999999997
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
26.026666666666667
31.0
31.0
29.0
29.0
26.026666666666667
31.0
29.0
29.0
29.0
27.0
29.0
31.0
29.0
29.0
29.0
29.0
27.0
43.013333333333335
26.10666666666667
28.0
26.0
26.0
25.506666666666668
24.986666666666665
26.0
27.0
25.506666666666668
25.506666666666668
25.506666666666668
25.506666666666668
27.0
25.506666666666668
39.97333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
46.626666666666665
46.61333333333333
45.0
46.626666666666665
46.61333333333333
46.626666666666665
46.0
46.61333333333333
46.61333333333333
45.0
46.61333333333333
46.61333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
21.0
21.0
23.653333333333332
28.0
24.0
19.666666666666668
19.653333333333332
19.666666666666668
19.986666666666665
19.666666666666668
18.32
19.653333333333332
19.666666666666668
20.693333333333335
19.653333333333332
20.0
18.32
19.666666666666668
19.986666666666665
18.333333333333332
18.986666666666665
19.986666666666665
19.986666666666665
18.986666666666665
18.666666666666668

2025-01-26 00:03:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:03:19 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:19 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
COFFEE LIQUEURS,2126049.54
COCKTAILS/RTD,8692059.710000003
CREAM LIQUEURS,8860918.940000001
SPECIAL ORDER ITEMS,1523594.6
IMPORTED FLAVORED VODKA,5785184.290000003
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000004
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.889999986
SCOTCH WHISKIES,5719870.570000002
SINGLE BARREL BOURBON WHISKIES,1066574.4600000004
IMPORTED GINS,3186.72
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.379999999
AMERICAN FLAVORED VODKA,10537284.849999996
IMPORTED SCHNAPPS,6637742.610000001
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999999
MEZCAL,430727.7299999999
WHISKEY LIQUEUR,24665650.70999999
BOTTLED IN BOND BOURBON,694701.27
SINGLE MALT SCOTCH,4454879.36
FLAVORED GIN,388056.5400000001
MIXTO TEQUILA,10668562.36
BLENDED WHISKIES,12635514.850000001
AMERICAN SCHNAPPS,6561224.369999998
AGED DARK RUM,1073387.53
FLAVORED RUM,9023511.589999996
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
GOLD RUM,1162585.67
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
AMERICAN WHISKIES,1881.0
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.59
CANADIAN WHISKIES,47392655.66999997
AMERICAN BRANDIES,5216033.320000002
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.38
CORN WHISKIES,442212.52
AMERICAN VODKAS,61440411.240000024
IMPORTED BRANDIES,15995277.499999996
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.83
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
TEMPORARY & SPECIALTY PACKAGES,10174030.040000003

2025-01-26 00:03:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:03:21 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:21 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
COFFEE LIQUEURS,22.129367390670087
COCKTAILS/RTD,7.880040524815435
CREAM LIQUEURS,23.56636716459329
SPECIAL ORDER ITEMS,12.158831483951694
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.944507216899385
IMPORTED SCHNAPPS,18.977555582907012
100% AGAVE TEQUILA,38.69034896983403
SCOTCH WHISKIES,24.25471388521774
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
IMPORTED FLAVORED VODKA,21.64341619274021
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553682
IMPORTED GINS,29.506666666666664
BLENDED WHISKIES,14.897984445558052
WHISKEY LIQUEUR,21.373583265167568
BOTTLED IN BOND BOURBON,31.346506181752545
SINGLE MALT SCOTCH,60.88554110329504
FLAVORED GIN,28.50851935248073
AMERICAN WHISKIES,38.0
IMPORTED DRY GINS,25.640947111019777
IMPORTED VODKAS,17.849199227160096
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.129999999999999
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN FLAVORED VODKA,14.778221731089833
AGED DARK RUM,25.435000189568076
AMERICAN VODKAS,10.78346746910011
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766426
TRIPLE SEC,4.062804851178788
IMPORTED BRANDIES,48.258683719642995
GOLD RUM,11.54485568355305
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
FLAVORED RUM,15.46660218357941
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
MIXTO TEQUILA,16.694858792850702
STRAIGHT RYE WHISKIES,41.68364286878291
STRAIGHT BOURBON WHISKIES,25.70818919158892
MEZCAL,43.15801006988803
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.02096702013815
AMERICAN DRY GINS,10.659231884796096
WHITE RUM,10.964751984850395
NEUTRAL GRAIN SPIRITS,16.932047486820043
DISTILLED SPIRITS SPECIALTY,46.666666666666664
CANADIAN WHISKIES,15.646681889219566
AMERICAN BRANDIES,12.525057326504212

2025-01-26 00:03:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:03:23 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:23 - root - INFO - SQL:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Results:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675

2025-01-26 00:03:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:03:25 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:25 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.88554110329501
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094049
MEZCAL,43.158010069888036
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.683642868782925
100% AGAVE TEQUILA,38.69034896983402
AMERICAN WHISKIES,38.0

2025-01-26 00:03:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:03:27 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:03:27 - root - INFO - SQL:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IOWA DISTILLERY WHISKIES,56.853846153846156,53.18666666666667,
,20.752089311652266,28.37729886358918,
DELISTED / SPECIAL ORDER ITEMS,,37.0,
WHISKEY LIQUEUR,87.97801137222729,194.1917962718478,174.76841460973748
TEMPORARY & SPECIALTY PACKAGES,42.155411122256766,74.7301335684981,139.8143092352197
AMERICAN CORDIALS & LIQUEURS,29.148327547171228,64.25759031021087,135.3225776315584
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.967097550423105,81.42800903781644,97.68531463293048
NEUTRAL GRAIN SPIRITS FLAVORED,42.571947275922675,57.50635858234884,93.9471378460607
FLAVORED GIN,14.612340966921112,16.772742801366515,87.18661086754351

2025-01-26 00:03:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:03:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:03:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:03:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 00:03:28 - snowflake.connector.connection - INFO - closed
2025-01-26 00:03:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:04:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:04:02 - root - INFO - ```sql
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:04:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:04:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:04:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:04:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:04:04 - snowflake.connector.connection - INFO - closed
2025-01-26 00:04:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:05:10 - root - INFO - SQL:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
WHISKEY LIQUEUR,87.97801137222731,194.19179627184775,174.7684146097374
TEMPORARY & SPECIALTY PACKAGES,42.15541112225676,74.7301335684981,139.81430923521975
AMERICAN CORDIALS & LIQUEURS,29.14832754717123,64.25759031021087,135.32257763155843
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.96709755042309,81.42800903781645,97.68531463293048
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592265,57.50635858234885,93.9471378460607
FLAVORED GIN,14.612340966921117,16.772742801366523,87.1866108675435
SINGLE MALT SCOTCH,65.34125774002437,70.52012090655103,69.1125472066271
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839594,67.04129026491188
IMPORTED CORDIALS & LIQUEURS,44.53190786892557,64.10986935241031,65.4116998219505

2025-01-26 00:05:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:05:12 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:12 - root - INFO - SQL:
SELECT DISTINCT "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
MISC. AMERICAN CORDIALS & LIQUEURS
IMPORTED SCHNAPPS
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMARETTO - IMPORTED
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
IMPORTED VODKA - CHERRY
AMERICAN VODKAS
AMERICAN AMARETTO
CHERRY BRANDIES
IOWA DISTILLERIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
RASPBERRY SCHNAPPS
IMPORTED BRANDIES
DECANTERS & SPECIALTY PACKAGES
MIXTO TEQUILA
IOWA DISTILLERY WHISKIES
GOLD RUM
PUERTO RICO & VIRGIN ISLANDS RUM
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AMERICAN FLAVORED VODKA
AMERICAN WHISKIES
TROPICAL FRUIT SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
100 PROOF VODKA
WHITE CREME DE CACAO
""
AGED DARK RUM
IMPORTED AMARETTO
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
ANISETTE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN SCHNAPPS
ROCK & RYE
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
FLAVORED GIN
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS

2025-01-26 00:05:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:05:13 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:14 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
LIMIT 100
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-12-07,IMPORTED CORDIALS & LIQUEURS,65.31,2.25
2021-08-06,IMPORTED CORDIALS & LIQUEURS,65.25,2.25
2021-11-16,IMPORTED CORDIALS & LIQUEURS,78.75,2.25
2021-02-24,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-09-10,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-03-29,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-12-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-12-20,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-10-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-06-25,CREAM LIQUEURS,42.75,2.25
2021-07-29,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-08,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-22,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-07,IMPORTED FLAVORED VODKA,74.22,2.25
2021-08-31,IMPORTED CORDIALS & LIQUEURS,74.25,2.25
2021-04-29,IMPORTED CORDIALS & LIQUEURS,85.86,2.25
2021-01-05,IMPORTED FLAVORED VODKA,74.22,2.25
2021-09-14,IMPORTED CORDIALS & LIQUEURS,61.08,2.25
2021-04-27,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-11-08,WHISKEY LIQUEUR,48.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-07-07,WHISKEY LIQUEUR,48.0,2.25
2021-02-15,WHISKEY LIQUEUR,48.0,2.25
2021-10-13,WHISKEY LIQUEUR,40.41,2.25
2021-11-01,WHISKEY LIQUEUR,40.41,2.25
2021-02-03,WHISKEY LIQUEUR,40.41,2.25
2021-09-27,WHISKEY LIQUEUR,40.5,2.25
2021-08-17,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-24,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-30,IMPORTED SCHNAPPS,58.5,2.25
2021-12-21,IMPORTED SCHNAPPS,58.5,2.25
2021-08-04,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-18,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-19,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-29,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-25,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-02-01,IMPORTED CORDIALS & LIQUEURS,44.97,2.25
2021-04-23,CREAM LIQUEURS,51.75,2.25
2021-10-01,CREAM LIQUEURS,51.75,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.48,2.25

2025-01-26 00:05:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:05:15 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:16 - root - INFO - SQL:
SELECT "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05

2025-01-26 00:05:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:05:17 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:17 - root - INFO - SQL:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
LIMIT 100
Results:
price_per_liter
39.82666666666667
40.0
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
31.959999999999997
30.919999999999998
33.0
31.959999999999997
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
26.026666666666667
31.0
31.0
29.0
29.0
26.026666666666667
31.0
29.0
29.0
29.0
27.0
29.0
31.0
29.0
29.0
29.0
29.0
27.0
43.013333333333335
26.10666666666667
28.0
26.0
26.0
25.506666666666668
24.986666666666665
26.0
27.0
25.506666666666668
25.506666666666668
25.506666666666668
25.506666666666668
27.0
25.506666666666668
39.97333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
46.626666666666665
46.61333333333333
45.0
46.626666666666665
46.61333333333333
46.626666666666665
46.0
46.61333333333333
46.61333333333333
45.0
46.61333333333333
46.61333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
21.0
21.0
23.653333333333332
28.0
24.0
19.666666666666668
19.653333333333332
19.666666666666668
19.986666666666665
19.666666666666668
18.32
19.653333333333332
19.666666666666668
20.693333333333335
19.653333333333332
20.0
18.32
19.666666666666668
19.986666666666665
18.333333333333332
18.986666666666665
19.986666666666665
19.986666666666665
18.986666666666665
18.666666666666668

2025-01-26 00:05:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:05:19 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:19 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
COFFEE LIQUEURS,2126049.54
COCKTAILS/RTD,8692059.710000003
CREAM LIQUEURS,8860918.940000001
SPECIAL ORDER ITEMS,1523594.6
IMPORTED FLAVORED VODKA,5785184.290000003
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000004
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.889999986
SCOTCH WHISKIES,5719870.570000002
SINGLE BARREL BOURBON WHISKIES,1066574.4600000004
IMPORTED GINS,3186.72
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.379999999
AMERICAN FLAVORED VODKA,10537284.849999996
IMPORTED SCHNAPPS,6637742.610000001
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999999
MEZCAL,430727.7299999999
WHISKEY LIQUEUR,24665650.70999999
BOTTLED IN BOND BOURBON,694701.27
SINGLE MALT SCOTCH,4454879.36
FLAVORED GIN,388056.5400000001
MIXTO TEQUILA,10668562.36
BLENDED WHISKIES,12635514.850000001
AMERICAN SCHNAPPS,6561224.369999998
AGED DARK RUM,1073387.53
FLAVORED RUM,9023511.589999996
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
GOLD RUM,1162585.67
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
AMERICAN WHISKIES,1881.0
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.59
CANADIAN WHISKIES,47392655.66999997
AMERICAN BRANDIES,5216033.320000002
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.38
CORN WHISKIES,442212.52
AMERICAN VODKAS,61440411.240000024
IMPORTED BRANDIES,15995277.499999996
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.83
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
TEMPORARY & SPECIALTY PACKAGES,10174030.040000003

2025-01-26 00:05:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:05:20 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:21 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
COFFEE LIQUEURS,22.129367390670087
COCKTAILS/RTD,7.880040524815435
CREAM LIQUEURS,23.56636716459329
SPECIAL ORDER ITEMS,12.158831483951694
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.944507216899385
IMPORTED SCHNAPPS,18.977555582907012
100% AGAVE TEQUILA,38.69034896983403
SCOTCH WHISKIES,24.25471388521774
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
IMPORTED FLAVORED VODKA,21.64341619274021
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553682
IMPORTED GINS,29.506666666666664
BLENDED WHISKIES,14.897984445558052
WHISKEY LIQUEUR,21.373583265167568
BOTTLED IN BOND BOURBON,31.346506181752545
SINGLE MALT SCOTCH,60.88554110329504
FLAVORED GIN,28.50851935248073
AMERICAN WHISKIES,38.0
IMPORTED DRY GINS,25.640947111019777
IMPORTED VODKAS,17.849199227160096
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.129999999999999
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN FLAVORED VODKA,14.778221731089833
AGED DARK RUM,25.435000189568076
AMERICAN VODKAS,10.78346746910011
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766426
TRIPLE SEC,4.062804851178788
IMPORTED BRANDIES,48.258683719642995
GOLD RUM,11.54485568355305
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
FLAVORED RUM,15.46660218357941
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
MIXTO TEQUILA,16.694858792850702
STRAIGHT RYE WHISKIES,41.68364286878291
STRAIGHT BOURBON WHISKIES,25.70818919158892
MEZCAL,43.15801006988803
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.02096702013815
AMERICAN DRY GINS,10.659231884796096
WHITE RUM,10.964751984850395
NEUTRAL GRAIN SPIRITS,16.932047486820043
DISTILLED SPIRITS SPECIALTY,46.666666666666664
CANADIAN WHISKIES,15.646681889219566
AMERICAN BRANDIES,12.525057326504212

2025-01-26 00:05:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:05:22 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:23 - root - INFO - SQL:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Results:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675

2025-01-26 00:05:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:05:24 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:25 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.88554110329501
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094049
MEZCAL,43.158010069888036
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.683642868782925
100% AGAVE TEQUILA,38.69034896983402
AMERICAN WHISKIES,38.0

2025-01-26 00:05:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:05:26 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:05:27 - root - INFO - SQL:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING "avg_price_per_liter_2021" IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
WHISKEY LIQUEUR,87.97801137222731,194.19179627184778,174.76841460973742
TEMPORARY & SPECIALTY PACKAGES,42.155411122256766,74.73013356849812,139.81430923521972
AMERICAN CORDIALS & LIQUEURS,29.148327547171228,64.25759031021086,135.3225776315584
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.96709755042309,81.42800903781647,97.6853146329305
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592267,57.50635858234885,93.94713784606068
FLAVORED GIN,14.612340966921114,16.772742801366523,87.1866108675435
SINGLE MALT SCOTCH,65.34125774002437,70.52012090655106,69.1125472066271
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839592,67.0412902649119
IMPORTED CORDIALS & LIQUEURS,44.53190786892556,64.1098693524103,65.4116998219505

2025-01-26 00:05:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:05:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:05:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:05:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 00:05:28 - snowflake.connector.connection - INFO - closed
2025-01-26 00:05:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:06:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:06:04 - root - INFO - ```sql
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:06:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:06:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:06:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:06:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:06:05 - snowflake.connector.connection - INFO - closed
2025-01-26 00:06:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:07:14 - root - INFO - SQL:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
APPLE SCHNAPPS,,,
DARK CREME DE CACAO,,,
100 PROOF VODKA,,,
WATERMELON SCHNAPPS,,,
VODKA FLAVORED,,,
WHITE CREME DE CACAO,,,
CREME DE ALMOND,,,
HIGH PROOF BEER - AMERICAN,,,
LOW PROOF VODKA,,,
BUTTERSCOTCH SCHNAPPS,,,

2025-01-26 00:07:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:07:15 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:16 - root - INFO - SQL:
SELECT DISTINCT "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
MISC. AMERICAN CORDIALS & LIQUEURS
IMPORTED SCHNAPPS
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMARETTO - IMPORTED
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
IMPORTED VODKA - CHERRY
AMERICAN VODKAS
AMERICAN AMARETTO
CHERRY BRANDIES
IOWA DISTILLERIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
RASPBERRY SCHNAPPS
IMPORTED BRANDIES
DECANTERS & SPECIALTY PACKAGES
MIXTO TEQUILA
IOWA DISTILLERY WHISKIES
GOLD RUM
PUERTO RICO & VIRGIN ISLANDS RUM
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AMERICAN FLAVORED VODKA
AMERICAN WHISKIES
TROPICAL FRUIT SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
100 PROOF VODKA
WHITE CREME DE CACAO
""
AGED DARK RUM
IMPORTED AMARETTO
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
ANISETTE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN SCHNAPPS
ROCK & RYE
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
FLAVORED GIN
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS

2025-01-26 00:07:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:07:17 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:18 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
LIMIT 100
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-12-07,IMPORTED CORDIALS & LIQUEURS,65.31,2.25
2021-08-06,IMPORTED CORDIALS & LIQUEURS,65.25,2.25
2021-11-16,IMPORTED CORDIALS & LIQUEURS,78.75,2.25
2021-02-24,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-09-10,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-03-29,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-12-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-12-20,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-10-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-06-25,CREAM LIQUEURS,42.75,2.25
2021-07-29,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-08,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-22,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-07,IMPORTED FLAVORED VODKA,74.22,2.25
2021-08-31,IMPORTED CORDIALS & LIQUEURS,74.25,2.25
2021-04-29,IMPORTED CORDIALS & LIQUEURS,85.86,2.25
2021-01-05,IMPORTED FLAVORED VODKA,74.22,2.25
2021-09-14,IMPORTED CORDIALS & LIQUEURS,61.08,2.25
2021-04-27,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-11-08,WHISKEY LIQUEUR,48.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-07-07,WHISKEY LIQUEUR,48.0,2.25
2021-02-15,WHISKEY LIQUEUR,48.0,2.25
2021-10-13,WHISKEY LIQUEUR,40.41,2.25
2021-11-01,WHISKEY LIQUEUR,40.41,2.25
2021-02-03,WHISKEY LIQUEUR,40.41,2.25
2021-09-27,WHISKEY LIQUEUR,40.5,2.25
2021-08-17,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-24,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-30,IMPORTED SCHNAPPS,58.5,2.25
2021-12-21,IMPORTED SCHNAPPS,58.5,2.25
2021-08-04,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-18,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-19,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-29,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-25,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-02-01,IMPORTED CORDIALS & LIQUEURS,44.97,2.25
2021-04-23,CREAM LIQUEURS,51.75,2.25
2021-10-01,CREAM LIQUEURS,51.75,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.48,2.25

2025-01-26 00:07:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:07:19 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:19 - root - INFO - SQL:
SELECT "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05

2025-01-26 00:07:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:07:21 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:21 - root - INFO - SQL:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
LIMIT 100
Results:
price_per_liter
39.82666666666667
40.0
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
31.959999999999997
30.919999999999998
33.0
31.959999999999997
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
26.026666666666667
31.0
31.0
29.0
29.0
26.026666666666667
31.0
29.0
29.0
29.0
27.0
29.0
31.0
29.0
29.0
29.0
29.0
27.0
43.013333333333335
26.10666666666667
28.0
26.0
26.0
25.506666666666668
24.986666666666665
26.0
27.0
25.506666666666668
25.506666666666668
25.506666666666668
25.506666666666668
27.0
25.506666666666668
39.97333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
46.626666666666665
46.61333333333333
45.0
46.626666666666665
46.61333333333333
46.626666666666665
46.0
46.61333333333333
46.61333333333333
45.0
46.61333333333333
46.61333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
21.0
21.0
23.653333333333332
28.0
24.0
19.666666666666668
19.653333333333332
19.666666666666668
19.986666666666665
19.666666666666668
18.32
19.653333333333332
19.666666666666668
20.693333333333335
19.653333333333332
20.0
18.32
19.666666666666668
19.986666666666665
18.333333333333332
18.986666666666665
19.986666666666665
19.986666666666665
18.986666666666665
18.666666666666668

2025-01-26 00:07:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:07:23 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:23 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
COFFEE LIQUEURS,2126049.54
COCKTAILS/RTD,8692059.710000003
CREAM LIQUEURS,8860918.940000001
SPECIAL ORDER ITEMS,1523594.6
IMPORTED FLAVORED VODKA,5785184.290000003
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000004
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.889999986
SCOTCH WHISKIES,5719870.570000002
SINGLE BARREL BOURBON WHISKIES,1066574.4600000004
IMPORTED GINS,3186.72
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.379999999
AMERICAN FLAVORED VODKA,10537284.849999996
IMPORTED SCHNAPPS,6637742.610000001
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999999
MEZCAL,430727.7299999999
WHISKEY LIQUEUR,24665650.70999999
BOTTLED IN BOND BOURBON,694701.27
SINGLE MALT SCOTCH,4454879.36
FLAVORED GIN,388056.5400000001
MIXTO TEQUILA,10668562.36
BLENDED WHISKIES,12635514.850000001
AMERICAN SCHNAPPS,6561224.369999998
AGED DARK RUM,1073387.53
FLAVORED RUM,9023511.589999996
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
GOLD RUM,1162585.67
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
AMERICAN WHISKIES,1881.0
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.59
CANADIAN WHISKIES,47392655.66999997
AMERICAN BRANDIES,5216033.320000002
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.38
CORN WHISKIES,442212.52
AMERICAN VODKAS,61440411.240000024
IMPORTED BRANDIES,15995277.499999996
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.83
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
TEMPORARY & SPECIALTY PACKAGES,10174030.040000003

2025-01-26 00:07:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:07:24 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:25 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
COFFEE LIQUEURS,22.129367390670087
COCKTAILS/RTD,7.880040524815435
CREAM LIQUEURS,23.56636716459329
SPECIAL ORDER ITEMS,12.158831483951694
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.944507216899385
IMPORTED SCHNAPPS,18.977555582907012
100% AGAVE TEQUILA,38.69034896983403
SCOTCH WHISKIES,24.25471388521774
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
IMPORTED FLAVORED VODKA,21.64341619274021
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553682
IMPORTED GINS,29.506666666666664
BLENDED WHISKIES,14.897984445558052
WHISKEY LIQUEUR,21.373583265167568
BOTTLED IN BOND BOURBON,31.346506181752545
SINGLE MALT SCOTCH,60.88554110329504
FLAVORED GIN,28.50851935248073
AMERICAN WHISKIES,38.0
IMPORTED DRY GINS,25.640947111019777
IMPORTED VODKAS,17.849199227160096
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.129999999999999
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN FLAVORED VODKA,14.778221731089833
AGED DARK RUM,25.435000189568076
AMERICAN VODKAS,10.78346746910011
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766426
TRIPLE SEC,4.062804851178788
IMPORTED BRANDIES,48.258683719642995
GOLD RUM,11.54485568355305
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
FLAVORED RUM,15.46660218357941
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
MIXTO TEQUILA,16.694858792850702
STRAIGHT RYE WHISKIES,41.68364286878291
STRAIGHT BOURBON WHISKIES,25.70818919158892
MEZCAL,43.15801006988803
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.02096702013815
AMERICAN DRY GINS,10.659231884796096
WHITE RUM,10.964751984850395
NEUTRAL GRAIN SPIRITS,16.932047486820043
DISTILLED SPIRITS SPECIALTY,46.666666666666664
CANADIAN WHISKIES,15.646681889219566
AMERICAN BRANDIES,12.525057326504212

2025-01-26 00:07:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:07:26 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:26 - root - INFO - SQL:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Results:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675

2025-01-26 00:07:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:07:28 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:28 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.88554110329501
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094049
MEZCAL,43.158010069888036
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.683642868782925
100% AGAVE TEQUILA,38.69034896983402
AMERICAN WHISKIES,38.0

2025-01-26 00:07:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:07:29 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:07:30 - root - INFO - SQL:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
WHISKEY LIQUEUR,87.97801137222727,194.19179627184778,174.76841460973742
TEMPORARY & SPECIALTY PACKAGES,42.15541112225675,74.7301335684981,139.8143092352197
AMERICAN CORDIALS & LIQUEURS,29.148327547171228,64.25759031021089,135.3225776315584
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.96709755042308,81.42800903781644,97.6853146329305
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592266,57.50635858234885,93.94713784606068
FLAVORED GIN,14.612340966921117,16.772742801366523,87.18661086754348
SINGLE MALT SCOTCH,65.34125774002435,70.52012090655106,69.11254720662708
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839593,67.04129026491188
IMPORTED CORDIALS & LIQUEURS,44.53190786892556,64.10986935241031,65.4116998219505

2025-01-26 00:07:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:07:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:07:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:07:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 00:07:31 - snowflake.connector.connection - INFO - closed
2025-01-26 00:07:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:08:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:08:14 - root - INFO - ```sql
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:08:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:08:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:08:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:08:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:08:16 - snowflake.connector.connection - INFO - closed
2025-01-26 00:08:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:09:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:09:23 - root - INFO - SQL:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
BUTTERSCOTCH SCHNAPPS,,,
APPLE SCHNAPPS,,,
WHITE CREME DE CACAO,,,
WATERMELON SCHNAPPS,,,
LOW PROOF VODKA,,,
DARK CREME DE CACAO,,,
CREME DE ALMOND,,,
HIGH PROOF BEER - AMERICAN,,,
100 PROOF VODKA,,,
VODKA FLAVORED,,,

2025-01-26 00:09:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:09:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:09:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:09:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:09:25 - snowflake.connector.connection - INFO - closed
2025-01-26 00:09:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:09:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:09:51 - root - INFO - ```sql
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:09:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:09:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:09:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:09:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:09:53 - snowflake.connector.connection - INFO - closed
2025-01-26 00:09:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:11:02 - root - INFO - SQL:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IMPORTED WHISKIES,,,122.63999999999999
SINGLE MALT SCOTCH,57.159890014759014,60.72217496121816,60.88554110329504
IMPORTED BRANDIES,43.53967924313812,44.210873670062206,48.258683719642995
DISTILLED SPIRITS SPECIALTY,,41.00539396078035,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,39.25740658638388,43.45435421500387,45.24511724094048
MEZCAL,39.296838028169006,39.04244202822056,43.158010069888036
CORN WHISKIES,36.55578155302149,43.984085752070726,43.02096702013814
STRAIGHT RYE WHISKIES,37.4157134981119,39.89246488782911,41.68364286878291
100% AGAVE TEQUILA,34.867184567514734,34.80330108401571,38.69034896983405
AMERICAN WHISKIES,,,38.0

2025-01-26 00:11:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:11:04 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:04 - root - INFO - SQL:
SELECT DISTINCT "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
MISC. AMERICAN CORDIALS & LIQUEURS
IMPORTED SCHNAPPS
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMARETTO - IMPORTED
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
IMPORTED VODKA - CHERRY
AMERICAN VODKAS
AMERICAN AMARETTO
CHERRY BRANDIES
IOWA DISTILLERIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
RASPBERRY SCHNAPPS
IMPORTED BRANDIES
DECANTERS & SPECIALTY PACKAGES
MIXTO TEQUILA
IOWA DISTILLERY WHISKIES
GOLD RUM
PUERTO RICO & VIRGIN ISLANDS RUM
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AMERICAN FLAVORED VODKA
AMERICAN WHISKIES
TROPICAL FRUIT SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
100 PROOF VODKA
WHITE CREME DE CACAO
""
AGED DARK RUM
IMPORTED AMARETTO
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
ANISETTE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN SCHNAPPS
ROCK & RYE
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
FLAVORED GIN
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS

2025-01-26 00:11:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:11:06 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:06 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
LIMIT 100
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-12-07,IMPORTED CORDIALS & LIQUEURS,65.31,2.25
2021-08-06,IMPORTED CORDIALS & LIQUEURS,65.25,2.25
2021-11-16,IMPORTED CORDIALS & LIQUEURS,78.75,2.25
2021-02-24,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-09-10,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-03-29,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-12-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-12-20,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-10-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-06-25,CREAM LIQUEURS,42.75,2.25
2021-07-29,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-08,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-22,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-07,IMPORTED FLAVORED VODKA,74.22,2.25
2021-08-31,IMPORTED CORDIALS & LIQUEURS,74.25,2.25
2021-04-29,IMPORTED CORDIALS & LIQUEURS,85.86,2.25
2021-01-05,IMPORTED FLAVORED VODKA,74.22,2.25
2021-09-14,IMPORTED CORDIALS & LIQUEURS,61.08,2.25
2021-04-27,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-11-08,WHISKEY LIQUEUR,48.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-07-07,WHISKEY LIQUEUR,48.0,2.25
2021-02-15,WHISKEY LIQUEUR,48.0,2.25
2021-10-13,WHISKEY LIQUEUR,40.41,2.25
2021-11-01,WHISKEY LIQUEUR,40.41,2.25
2021-02-03,WHISKEY LIQUEUR,40.41,2.25
2021-09-27,WHISKEY LIQUEUR,40.5,2.25
2021-08-17,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-24,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-30,IMPORTED SCHNAPPS,58.5,2.25
2021-12-21,IMPORTED SCHNAPPS,58.5,2.25
2021-08-04,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-18,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-19,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-29,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-25,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-02-01,IMPORTED CORDIALS & LIQUEURS,44.97,2.25
2021-04-23,CREAM LIQUEURS,51.75,2.25
2021-10-01,CREAM LIQUEURS,51.75,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.48,2.25

2025-01-26 00:11:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:11:08 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:08 - root - INFO - SQL:
SELECT "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05

2025-01-26 00:11:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:11:09 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:10 - root - INFO - SQL:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
price_per_liter
6.428571428571429
11.479999999999999
5.88
19.49
18.75
27.689999999999998
11.25
18.428571428571427
7.491428571428571
8.605714285714285
12.645714285714286
27.250000000000004
37.346666666666664
7.279999999999999
7.359999999999999
16.0
10.44
11.0
11.653333333333334
32.51
15.0
100.0
23.0
17.0
42.0
26.0
7.502857142857144
9.0
16.0
16.506666666666668
47.6
16.07142857142857
6.38
22.400000000000002
8.506666666666666
193.34666666666666
72.98666666666666
129.00000000000003
129.00000000000003
225.0
176.99999999999997
514.8
370.0
422.49999999999994
370.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0

2025-01-26 00:11:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:11:11 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:11 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
COFFEE LIQUEURS,2126049.54
COCKTAILS/RTD,8692059.710000003
CREAM LIQUEURS,8860918.940000001
SPECIAL ORDER ITEMS,1523594.6
IMPORTED FLAVORED VODKA,5785184.290000003
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000004
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.889999986
SCOTCH WHISKIES,5719870.570000002
SINGLE BARREL BOURBON WHISKIES,1066574.4600000004
IMPORTED GINS,3186.72
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.379999999
AMERICAN FLAVORED VODKA,10537284.849999996
IMPORTED SCHNAPPS,6637742.610000001
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999999
MEZCAL,430727.7299999999
WHISKEY LIQUEUR,24665650.70999999
BOTTLED IN BOND BOURBON,694701.27
SINGLE MALT SCOTCH,4454879.36
FLAVORED GIN,388056.5400000001
MIXTO TEQUILA,10668562.36
BLENDED WHISKIES,12635514.850000001
AMERICAN SCHNAPPS,6561224.369999998
AGED DARK RUM,1073387.53
FLAVORED RUM,9023511.589999996
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
GOLD RUM,1162585.67
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
AMERICAN WHISKIES,1881.0
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.59
CANADIAN WHISKIES,47392655.66999997
AMERICAN BRANDIES,5216033.320000002
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.38
CORN WHISKIES,442212.52
AMERICAN VODKAS,61440411.240000024
IMPORTED BRANDIES,15995277.499999996
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.83
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
TEMPORARY & SPECIALTY PACKAGES,10174030.040000003

2025-01-26 00:11:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:11:13 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:13 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
COFFEE LIQUEURS,22.129367390670087
COCKTAILS/RTD,7.880040524815435
CREAM LIQUEURS,23.56636716459329
SPECIAL ORDER ITEMS,12.158831483951694
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.944507216899385
IMPORTED SCHNAPPS,18.977555582907012
100% AGAVE TEQUILA,38.69034896983403
SCOTCH WHISKIES,24.25471388521774
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
IMPORTED FLAVORED VODKA,21.64341619274021
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553682
IMPORTED GINS,29.506666666666664
BLENDED WHISKIES,14.897984445558052
WHISKEY LIQUEUR,21.373583265167568
BOTTLED IN BOND BOURBON,31.346506181752545
SINGLE MALT SCOTCH,60.88554110329504
FLAVORED GIN,28.50851935248073
AMERICAN WHISKIES,38.0
IMPORTED DRY GINS,25.640947111019777
IMPORTED VODKAS,17.849199227160096
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.129999999999999
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN FLAVORED VODKA,14.778221731089833
AGED DARK RUM,25.435000189568076
AMERICAN VODKAS,10.78346746910011
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766426
TRIPLE SEC,4.062804851178788
IMPORTED BRANDIES,48.258683719642995
GOLD RUM,11.54485568355305
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
FLAVORED RUM,15.46660218357941
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
MIXTO TEQUILA,16.694858792850702
STRAIGHT RYE WHISKIES,41.68364286878291
STRAIGHT BOURBON WHISKIES,25.70818919158892
MEZCAL,43.15801006988803
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.02096702013815
AMERICAN DRY GINS,10.659231884796096
WHITE RUM,10.964751984850395
NEUTRAL GRAIN SPIRITS,16.932047486820043
DISTILLED SPIRITS SPECIALTY,46.666666666666664
CANADIAN WHISKIES,15.646681889219566
AMERICAN BRANDIES,12.525057326504212

2025-01-26 00:11:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:11:14 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:15 - root - INFO - SQL:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Results:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675

2025-01-26 00:11:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:11:16 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:16 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.88554110329501
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094049
MEZCAL,43.158010069888036
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.683642868782925
100% AGAVE TEQUILA,38.69034896983402
AMERICAN WHISKIES,38.0

2025-01-26 00:11:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:11:18 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:18 - root - INFO - SQL:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IMPORTED WHISKIES,,,122.63999999999999
SINGLE MALT SCOTCH,57.159890014759014,60.72217496121817,60.885541103295026
IMPORTED BRANDIES,43.539679243138124,44.21087367006222,48.25868371964301
DISTILLED SPIRITS SPECIALTY,,41.00539396078036,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,39.257406586383894,43.45435421500387,45.24511724094048
MEZCAL,39.296838028169,39.042442028220556,43.158010069888036
CORN WHISKIES,36.55578155302148,43.98408575207072,43.02096702013815
STRAIGHT RYE WHISKIES,37.41571349811189,39.8924648878291,41.68364286878292
100% AGAVE TEQUILA,34.867184567514734,34.80330108401572,38.69034896983405
AMERICAN WHISKIES,,,38.0

2025-01-26 00:11:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 00:11:19 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:11:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:11:49 - root - INFO - ```sql
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:11:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:11:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:11:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:11:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:11:50 - snowflake.connector.connection - INFO - closed
2025-01-26 00:11:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:13:13 - root - INFO - SQL:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
BUTTERSCOTCH SCHNAPPS,,,
APPLE SCHNAPPS,,,
WHITE CREME DE CACAO,,,
WATERMELON SCHNAPPS,,,
LOW PROOF VODKA,,,
DARK CREME DE CACAO,,,
CREME DE ALMOND,,,
HIGH PROOF BEER - AMERICAN,,,
100 PROOF VODKA,,,
VODKA FLAVORED,,,

2025-01-26 00:13:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:13:15 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:15 - root - INFO - SQL:
SELECT DISTINCT "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
MISC. AMERICAN CORDIALS & LIQUEURS
IMPORTED SCHNAPPS
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMARETTO - IMPORTED
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
IMPORTED VODKA - CHERRY
AMERICAN VODKAS
AMERICAN AMARETTO
CHERRY BRANDIES
IOWA DISTILLERIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
RASPBERRY SCHNAPPS
IMPORTED BRANDIES
DECANTERS & SPECIALTY PACKAGES
MIXTO TEQUILA
IOWA DISTILLERY WHISKIES
GOLD RUM
PUERTO RICO & VIRGIN ISLANDS RUM
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AMERICAN FLAVORED VODKA
AMERICAN WHISKIES
TROPICAL FRUIT SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
100 PROOF VODKA
WHITE CREME DE CACAO
""
AGED DARK RUM
IMPORTED AMARETTO
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
ANISETTE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN SCHNAPPS
ROCK & RYE
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
FLAVORED GIN
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS

2025-01-26 00:13:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:13:17 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:17 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
LIMIT 100
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-12-07,IMPORTED CORDIALS & LIQUEURS,65.31,2.25
2021-08-06,IMPORTED CORDIALS & LIQUEURS,65.25,2.25
2021-11-16,IMPORTED CORDIALS & LIQUEURS,78.75,2.25
2021-02-24,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-09-10,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-03-29,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-12-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-12-20,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-10-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-06-25,CREAM LIQUEURS,42.75,2.25
2021-07-29,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-08,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-22,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-07,IMPORTED FLAVORED VODKA,74.22,2.25
2021-08-31,IMPORTED CORDIALS & LIQUEURS,74.25,2.25
2021-04-29,IMPORTED CORDIALS & LIQUEURS,85.86,2.25
2021-01-05,IMPORTED FLAVORED VODKA,74.22,2.25
2021-09-14,IMPORTED CORDIALS & LIQUEURS,61.08,2.25
2021-04-27,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-11-08,WHISKEY LIQUEUR,48.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-07-07,WHISKEY LIQUEUR,48.0,2.25
2021-02-15,WHISKEY LIQUEUR,48.0,2.25
2021-10-13,WHISKEY LIQUEUR,40.41,2.25
2021-11-01,WHISKEY LIQUEUR,40.41,2.25
2021-02-03,WHISKEY LIQUEUR,40.41,2.25
2021-09-27,WHISKEY LIQUEUR,40.5,2.25
2021-08-17,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-24,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-30,IMPORTED SCHNAPPS,58.5,2.25
2021-12-21,IMPORTED SCHNAPPS,58.5,2.25
2021-08-04,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-18,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-19,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-29,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-25,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-02-01,IMPORTED CORDIALS & LIQUEURS,44.97,2.25
2021-04-23,CREAM LIQUEURS,51.75,2.25
2021-10-01,CREAM LIQUEURS,51.75,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.48,2.25

2025-01-26 00:13:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:13:18 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:19 - root - INFO - SQL:
SELECT "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05

2025-01-26 00:13:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:13:20 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:21 - root - INFO - SQL:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
price_per_liter
6.428571428571429
11.479999999999999
5.88
19.49
18.75
27.689999999999998
11.25
18.428571428571427
7.491428571428571
8.605714285714285
12.645714285714286
27.250000000000004
37.346666666666664
7.279999999999999
7.359999999999999
16.0
10.44
11.0
11.653333333333334
32.51
15.0
100.0
23.0
17.0
42.0
26.0
7.502857142857144
9.0
16.0
16.506666666666668
47.6
16.07142857142857
6.38
22.400000000000002
8.506666666666666
193.34666666666666
72.98666666666666
129.00000000000003
129.00000000000003
225.0
176.99999999999997
514.8
370.0
422.49999999999994
370.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0

2025-01-26 00:13:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:13:22 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:23 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
COFFEE LIQUEURS,2126049.54
COCKTAILS/RTD,8692059.710000003
CREAM LIQUEURS,8860918.940000001
SPECIAL ORDER ITEMS,1523594.6
IMPORTED FLAVORED VODKA,5785184.290000003
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000004
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.889999986
SCOTCH WHISKIES,5719870.570000002
SINGLE BARREL BOURBON WHISKIES,1066574.4600000004
IMPORTED GINS,3186.72
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.379999999
AMERICAN FLAVORED VODKA,10537284.849999996
IMPORTED SCHNAPPS,6637742.610000001
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999999
MEZCAL,430727.7299999999
WHISKEY LIQUEUR,24665650.70999999
BOTTLED IN BOND BOURBON,694701.27
SINGLE MALT SCOTCH,4454879.36
FLAVORED GIN,388056.5400000001
MIXTO TEQUILA,10668562.36
BLENDED WHISKIES,12635514.850000001
AMERICAN SCHNAPPS,6561224.369999998
AGED DARK RUM,1073387.53
FLAVORED RUM,9023511.589999996
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
GOLD RUM,1162585.67
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
AMERICAN WHISKIES,1881.0
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.59
CANADIAN WHISKIES,47392655.66999997
AMERICAN BRANDIES,5216033.320000002
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.38
CORN WHISKIES,442212.52
AMERICAN VODKAS,61440411.240000024
IMPORTED BRANDIES,15995277.499999996
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.83
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
TEMPORARY & SPECIALTY PACKAGES,10174030.040000003

2025-01-26 00:13:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:13:24 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:24 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
COFFEE LIQUEURS,22.129367390670087
COCKTAILS/RTD,7.880040524815435
CREAM LIQUEURS,23.56636716459329
SPECIAL ORDER ITEMS,12.158831483951694
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.944507216899385
IMPORTED SCHNAPPS,18.977555582907012
100% AGAVE TEQUILA,38.69034896983403
SCOTCH WHISKIES,24.25471388521774
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
IMPORTED FLAVORED VODKA,21.64341619274021
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553682
IMPORTED GINS,29.506666666666664
BLENDED WHISKIES,14.897984445558052
WHISKEY LIQUEUR,21.373583265167568
BOTTLED IN BOND BOURBON,31.346506181752545
SINGLE MALT SCOTCH,60.88554110329504
FLAVORED GIN,28.50851935248073
AMERICAN WHISKIES,38.0
IMPORTED DRY GINS,25.640947111019777
IMPORTED VODKAS,17.849199227160096
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.129999999999999
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN FLAVORED VODKA,14.778221731089833
AGED DARK RUM,25.435000189568076
AMERICAN VODKAS,10.78346746910011
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766426
TRIPLE SEC,4.062804851178788
IMPORTED BRANDIES,48.258683719642995
GOLD RUM,11.54485568355305
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
FLAVORED RUM,15.46660218357941
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
MIXTO TEQUILA,16.694858792850702
STRAIGHT RYE WHISKIES,41.68364286878291
STRAIGHT BOURBON WHISKIES,25.70818919158892
MEZCAL,43.15801006988803
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.02096702013815
AMERICAN DRY GINS,10.659231884796096
WHITE RUM,10.964751984850395
NEUTRAL GRAIN SPIRITS,16.932047486820043
DISTILLED SPIRITS SPECIALTY,46.666666666666664
CANADIAN WHISKIES,15.646681889219566
AMERICAN BRANDIES,12.525057326504212

2025-01-26 00:13:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:13:26 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:26 - root - INFO - SQL:
SELECT
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Results:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675

2025-01-26 00:13:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:13:27 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:13:28 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.88554110329501
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094049
MEZCAL,43.158010069888036
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.683642868782925
100% AGAVE TEQUILA,38.69034896983402
AMERICAN WHISKIES,38.0

2025-01-26 00:13:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:13:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:13:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:13:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:13:29 - snowflake.connector.connection - INFO - closed
2025-01-26 00:13:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:14:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:14:09 - root - INFO - ```sql
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING 
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:14:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:14:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:14:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:14:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:14:11 - snowflake.connector.connection - INFO - closed
2025-01-26 00:14:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:15:24 - root - INFO - SQL:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING 
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
SINGLE MALT SCOTCH,57.15989001475901,60.72217496121816,60.88554110329504
IMPORTED BRANDIES,43.539679243138124,44.21087367006222,48.25868371964301
SINGLE BARREL BOURBON WHISKIES,39.257406586383894,43.45435421500387,45.24511724094047
MEZCAL,39.296838028169006,39.04244202822056,43.15801006988803
CORN WHISKIES,36.55578155302148,43.98408575207072,43.02096702013816
STRAIGHT RYE WHISKIES,37.415713498111884,39.8924648878291,41.683642868782904
100% AGAVE TEQUILA,34.86718456751472,34.80330108401573,38.690348969834034
BOTTLED IN BOND BOURBON,28.07891726027397,29.57572676385557,31.346506181752545
TENNESSEE WHISKIES,29.831194441458887,30.668740810584907,30.944507216899385
IMPORTED CORDIALS & LIQUEURS,28.179161606842865,30.195326536840906,30.810659844510468

2025-01-26 00:15:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:15:25 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:26 - root - INFO - SQL:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021 AND "category_name" IN ('IMPORTED WHISKIES', 'SINGLE MALT SCOTCH')
LIMIT 100
Results:
date,category_name,sale_dollars,volume_sold_liters
2021-10-12,SINGLE MALT SCOTCH,39.96,0.75
2021-04-20,SINGLE MALT SCOTCH,41.22,0.75
2021-07-15,SINGLE MALT SCOTCH,68.99,0.75
2021-07-07,SINGLE MALT SCOTCH,44.99,0.75
2021-03-03,SINGLE MALT SCOTCH,42.74,0.75
2021-06-07,SINGLE MALT SCOTCH,42.74,0.75
2021-04-14,SINGLE MALT SCOTCH,66.0,0.75
2021-04-08,SINGLE MALT SCOTCH,66.0,0.75
2021-03-19,SINGLE MALT SCOTCH,97.5,0.75
2021-10-05,SINGLE MALT SCOTCH,51.75,0.75
2021-04-21,SINGLE MALT SCOTCH,60.0,0.75
2021-04-15,SINGLE MALT SCOTCH,39.0,0.75
2021-12-06,SINGLE MALT SCOTCH,54.75,0.75
2021-05-05,SINGLE MALT SCOTCH,54.75,0.75
2021-06-14,SINGLE MALT SCOTCH,54.75,0.75
2021-06-18,SINGLE MALT SCOTCH,38.97,0.75
2021-02-12,SINGLE MALT SCOTCH,38.97,0.75
2021-01-27,SINGLE MALT SCOTCH,97.44,0.75
2021-07-29,SINGLE MALT SCOTCH,54.72,0.75
2021-05-06,SINGLE MALT SCOTCH,41.34,0.75
2021-01-21,SINGLE MALT SCOTCH,75.0,0.75
2021-06-21,SINGLE MALT SCOTCH,60.02,0.75
2021-08-26,SINGLE MALT SCOTCH,30.0,0.75
2021-09-21,SINGLE MALT SCOTCH,60.0,0.75
2021-04-09,SINGLE MALT SCOTCH,41.22,0.75
2021-03-26,SINGLE MALT SCOTCH,90.0,0.75
2021-08-19,SINGLE MALT SCOTCH,89.52,1.5
2021-05-05,SINGLE MALT SCOTCH,82.44,1.5
2021-12-01,SINGLE MALT SCOTCH,137.98,1.5
2021-08-11,SINGLE MALT SCOTCH,89.98,1.5
2021-05-11,SINGLE MALT SCOTCH,89.98,1.5
2021-03-29,SINGLE MALT SCOTCH,105.0,1.5
2021-08-11,SINGLE MALT SCOTCH,78.0,1.5
2021-01-21,SINGLE MALT SCOTCH,109.5,1.5
2021-07-28,SINGLE MALT SCOTCH,109.44,1.5
2021-03-26,SINGLE MALT SCOTCH,109.44,1.5
2021-04-15,SINGLE MALT SCOTCH,74.98,1.5
2021-04-06,SINGLE MALT SCOTCH,74.98,1.5
2021-11-05,SINGLE MALT SCOTCH,62.98,1.5
2021-11-24,SINGLE MALT SCOTCH,62.94,1.5
2021-12-30,SINGLE MALT SCOTCH,62.94,1.5
2021-01-20,SINGLE MALT SCOTCH,150.0,1.5
2021-08-17,SINGLE MALT SCOTCH,88.5,1.5
2021-06-29,SINGLE MALT SCOTCH,88.5,1.5
2021-07-27,SINGLE MALT SCOTCH,120.04,1.5
2021-10-18,SINGLE MALT SCOTCH,120.04,1.5
2021-10-29,SINGLE MALT SCOTCH,120.04,1.5
2021-07-27,SINGLE MALT SCOTCH,120.04,1.5
2021-07-09,SINGLE MALT SCOTCH,102.0,1.5
2021-11-09,SINGLE MALT SCOTCH,82.44,1.5
2021-01-12,SINGLE MALT SCOTCH,62.98,1.5
2021-08-16,SINGLE MALT SCOTCH,62.98,1.5
2021-12-16,SINGLE MALT SCOTCH,60.0,1.5
2021-01-20,SINGLE MALT SCOTCH,225.0,2.25
2021-10-04,SINGLE MALT SCOTCH,44.98,0.2
2021-08-10,SINGLE MALT SCOTCH,44.99,0.75
2021-09-22,SINGLE MALT SCOTCH,44.99,0.75
2021-11-09,SINGLE MALT SCOTCH,33.74,0.75
2021-12-17,SINGLE MALT SCOTCH,52.5,0.75
2021-05-03,SINGLE MALT SCOTCH,97.5,0.75
2021-04-01,SINGLE MALT SCOTCH,52.5,0.75
2021-05-22,SINGLE MALT SCOTCH,52.5,0.75
2021-04-27,SINGLE MALT SCOTCH,39.0,0.75
2021-09-14,SINGLE MALT SCOTCH,54.75,0.75
2021-07-29,SINGLE MALT SCOTCH,54.72,0.75
2021-12-09,SINGLE MALT SCOTCH,37.49,0.75
2021-08-17,SINGLE MALT SCOTCH,52.49,0.75
2021-07-06,SINGLE MALT SCOTCH,74.99,0.75
2021-04-06,SINGLE MALT SCOTCH,82.5,0.75
2021-08-25,SINGLE MALT SCOTCH,82.5,0.75
2021-04-12,SINGLE MALT SCOTCH,82.5,0.75
2021-08-16,SINGLE MALT SCOTCH,41.34,0.75
2021-05-13,SINGLE MALT SCOTCH,40.5,0.75
2021-09-17,SINGLE MALT SCOTCH,44.25,0.75
2021-10-01,SINGLE MALT SCOTCH,44.25,0.75
2021-10-20,SINGLE MALT SCOTCH,44.25,0.75
2021-06-17,SINGLE MALT SCOTCH,60.02,0.75
2021-09-22,SINGLE MALT SCOTCH,30.0,0.75
2021-11-10,SINGLE MALT SCOTCH,30.0,0.75
2021-12-08,SINGLE MALT SCOTCH,30.0,0.75
2021-06-22,SINGLE MALT SCOTCH,60.0,0.75
2021-03-29,SINGLE MALT SCOTCH,41.22,0.75
2021-12-30,SINGLE MALT SCOTCH,33.0,0.75
2021-04-22,SINGLE MALT SCOTCH,134.94,0.6
2021-07-07,SINGLE MALT SCOTCH,44.76,0.75
2021-03-19,SINGLE MALT SCOTCH,134.94,0.6
2021-12-17,SINGLE MALT SCOTCH,48.0,0.75
2021-12-06,SINGLE MALT SCOTCH,67.47,0.3
2021-11-10,SINGLE MALT SCOTCH,134.96,3.0
2021-04-07,SINGLE MALT SCOTCH,240.0,3.0
2021-01-25,SINGLE MALT SCOTCH,155.88,3.0
2021-11-18,SINGLE MALT SCOTCH,155.88,3.0
2021-10-01,SINGLE MALT SCOTCH,120.0,3.0
2021-11-09,SINGLE MALT SCOTCH,120.0,3.0
2021-02-10,SINGLE MALT SCOTCH,120.0,3.0
2021-05-12,SINGLE MALT SCOTCH,240.0,3.0
2021-04-26,SINGLE MALT SCOTCH,44.98,0.2
2021-10-01,SINGLE MALT SCOTCH,44.98,0.2
2021-11-08,SINGLE MALT SCOTCH,240.0,3.0
2021-04-28,SINGLE MALT SCOTCH,155.88,3.0

2025-01-26 00:15:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:15:27 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:28 - root - INFO - SQL:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" ELSE 0 END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" ELSE 0 END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING 
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
SINGLE MALT SCOTCH,57.15989001475902,60.72217496121817,60.885541103295026
IMPORTED BRANDIES,43.53967924313812,44.21087367006222,48.25868371964298
SINGLE BARREL BOURBON WHISKIES,39.25740658638388,43.45435421500387,45.24511724094047
MEZCAL,39.29683802816901,39.04244202822056,43.158010069888036
CORN WHISKIES,36.55578155302149,43.98408575207072,43.02096702013814
STRAIGHT RYE WHISKIES,37.41571349811188,39.8924648878291,41.68364286878291
100% AGAVE TEQUILA,34.86718456751473,34.80330108401572,38.69034896983402
BOTTLED IN BOND BOURBON,28.078917260273965,29.575726763855577,31.34650618175255
TENNESSEE WHISKIES,29.83119444145888,30.668740810584918,30.94450721689939
IMPORTED CORDIALS & LIQUEURS,28.17916160684286,30.195326536840906,30.81065984451047

2025-01-26 00:15:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:15:29 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:30 - root - INFO - SQL:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Results:
price_per_liter
6.428571428571429
11.479999999999999
5.88
19.49
18.75
27.689999999999998
11.25
18.428571428571427
7.491428571428571
8.605714285714285
12.645714285714286
27.250000000000004
37.346666666666664
7.279999999999999
7.359999999999999
16.0
10.44
11.0
11.653333333333334
32.51
15.0
100.0
23.0
17.0
42.0
26.0
7.502857142857144
9.0
16.0
16.506666666666668
47.6
16.07142857142857
6.38
22.400000000000002
8.506666666666666
193.34666666666666
72.98666666666666
129.00000000000003
129.00000000000003
225.0
176.99999999999997
514.8
370.0
422.49999999999994
370.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0

2025-01-26 00:15:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:15:31 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:32 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
HAVING SUM("volume_sold_liters") > 0
LIMIT 100
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
IMPORTED FLAVORED VODKA,21.64341619274023
NEUTRAL GRAIN SPIRITS FLAVORED,26.74990341755368
100% AGAVE TEQUILA,38.69034896983404
SCOTCH WHISKIES,24.254713885217747
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
COFFEE LIQUEURS,22.129367390670097
COCKTAILS/RTD,7.880040524815437
IMPORTED GINS,29.506666666666664
AMERICAN FLAVORED VODKA,14.778221731089836
CREAM LIQUEURS,23.566367164593295
IRISH WHISKIES,30.61429949064126
TENNESSEE WHISKIES,30.9445072168994
AGED DARK RUM,25.435000189568065
SPECIAL ORDER ITEMS,12.1588314839517
IMPORTED DRY GINS,25.64094711101976
IMPORTED VODKAS,17.84919922716009
IMPORTED SCHNAPPS,18.977555582907012
FLAVORED RUM,15.466602183579413
IMPORTED CORDIALS & LIQUEURS,30.81065984451046
WHISKEY LIQUEUR,21.373583265167575
BOTTLED IN BOND BOURBON,31.346506181752556
SINGLE MALT SCOTCH,60.885541103295026
FLAVORED GIN,28.50851935248073
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766425
TRIPLE SEC,4.062804851178789
MEZCAL,43.158010069888036
AMERICAN WHISKIES,38.0
GOLD RUM,11.544855683553058
MIXTO TEQUILA,16.69485879285069
IMPORTED BRANDIES,48.25868371964299
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.020967020138144
AMERICAN DRY GINS,10.659231884796098
WHITE RUM,10.9647519848504
BLENDED WHISKIES,14.897984445558052
AMERICAN SCHNAPPS,12.486547580045764
CANADIAN WHISKIES,15.646681889219572
AMERICAN BRANDIES,12.525057326504214
STRAIGHT BOURBON WHISKIES,25.708189191588932
STRAIGHT RYE WHISKIES,41.68364286878292
NEUTRAL GRAIN SPIRITS,16.932047486820053
DISTILLED SPIRITS SPECIALTY,46.666666666666664
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
AMERICAN VODKAS,10.783467469100108
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.13

2025-01-26 00:15:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:15:33 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:34 - root - INFO - SQL:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
HAVING SUM("volume_sold_liters") > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Results:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.885541103295026
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
MEZCAL,43.15801006988803
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.68364286878292
100% AGAVE TEQUILA,38.69034896983403
AMERICAN WHISKIES,38.0

2025-01-26 00:15:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 00:15:35 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:35 - root - INFO - SQL:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
HAVING SUM("volume_sold_liters") > 0
LIMIT 100
Results:
category_name,year,avg_price_per_liter
AMERICAN SCHNAPPS,2024,17.34836387727188
STRAIGHT BOURBON WHISKIES,2021,25.708189191588925
GOLD RUM,2019,10.931024921954133
SCOTCH WHISKIES,2020,22.53605727632424
BUTTERSCOTCH SCHNAPPS,2012,10.948664507997545
,2020,31.715929606403066
BUTTERSCOTCH SCHNAPPS,2016,11.66665185482822
BUTTERSCOTCH SCHNAPPS,2013,11.170515586673337
APPLE SCHNAPPS,2016,11.90626681428277
AMARETTO - IMPORTED,2015,62.26666666666667
ROCK & RYE,2012,9.857591397849463
HOLIDAY VAP,2017,41.31619047619048
SINGLE MALT SCOTCH,2015,54.3714983979572
IRISH WHISKIES,2020,30.62602456955369
COFFEE LIQUEURS,2018,20.702533921725408
TEMPORARY & SPECIALTY PACKAGES,2022,33.77457355123664
LOW PROOF VODKA,2012,21.810228721409818
WHITE CREME DE MENTHE,2013,9.283652627655608
AGED DARK RUM,2022,26.882500000000007
JAMAICA RUM,2016,19.455806993283286
CORN WHISKIES,2020,43.98408575207071
BARBADOS RUM,2012,18.47513359580727
SPEARMINT SCHNAPPS,2013,7.134429245283017
BLENDED WHISKIES,2020,14.1774188743997
AMERICAN FLAVORED VODKA,2022,15.520813901491099
WHITE RUM,2020,10.960256699665758
TEQUILA,2013,19.879169648026245
IMPORTED GRAPE BRANDIES,2016,41.03892168324284
PEPPERMINT SCHNAPPS,2012,7.311381155340737
CORN WHISKIES,2019,36.55578155302149
NEUTRAL GRAIN SPIRITS FLAVORED,2017,22.843756076759075
WHITE CREME DE CACAO,2015,9.386352548036758
AMERICAN SLOE GINS,2020,8.13
SINGLE MALT SCOTCH,2019,57.15989001475903
CANADIAN WHISKIES,2014,12.663644965810416
WHISKEY LIQUEUR,2023,24.144916932410457
TEQUILA,2012,19.478480900389044
AMERICAN CORDIALS & LIQUEURS,2023,22.911948113925508
STRAIGHT BOURBON WHISKIES,2012,15.696971197200488
PEPPERMINT SCHNAPPS,2013,7.314749489688745
BLENDED WHISKIES,2024,16.521967215298893
AMERICAN VODKAS,2020,10.37159267048766
IMPORTED DRY GINS,2016,24.310851311543
NEUTRAL GRAIN SPIRITS,2019,17.01644187052472
OTHER PROOF VODKA,2014,15.951264367816087
IMPORTED VODKA - CHERRY,2012,10.58
SPICED RUM,2020,15.345321660461218
100% AGAVE TEQUILA,2022,41.452877615661514
CANADIAN WHISKIES,2015,13.3967104401965
TENNESSEE WHISKIES,2012,25.40717411213621
MIXTO TEQUILA,2016,14.936155105203472
VODKA FLAVORED,2012,13.238240431821776
,2013,23.331493807737303
AMERICAN AMARETTO,2012,6.794743495020151
SPICED RUM,2024,16.24313168757013
BLENDED WHISKIES,2021,14.89798444555805
WHISKEY LIQUEUR,2024,25.303055581248
SCOTCH WHISKIES,2023,28.160736223082385
COFFEE LIQUEURS,2019,21.073586682369246
COCKTAILS/RTD,2018,7.089324865709722
IMPORTED DRY GINS,2014,23.612526634318638
VODKA 80 PROOF,2014,8.242535918819701
IMPORTED SCHNAPPS,2016,18.832618113770007
COFFEE LIQUEURS,2013,20.125561842958174
IMPORTED SCHNAPPS,2018,18.662637908157507
FLAVORED GINS,2016,13.104106880427517
BARBADOS RUM,2016,21.786758318390124
CANADIAN WHISKIES,2016,13.709439291625898
CINNAMON SCHNAPPS,2013,13.079283907955492
DISTILLED SPIRITS SPECIALTY,2012,9.684964606366012
PEACH SCHNAPPS,2013,10.797307206447044
AMERICAN COCKTAILS,2012,7.38121742978146
TENNESSEE WHISKIES,2020,30.66874081058491
AMERICAN DRY GINS,2024,11.566942328695319
TENNESSEE WHISKIES,2015,27.75578919109842
FLAVORED GIN,2024,34.349130018733916
BOTTLED IN BOND BOURBON,2012,42.24324829931972
FLAVORED GINS,2014,13.629728839393268
JAMAICA RUM,2012,17.780149318713217
IMPORTED AMARETTO,2013,26.89424454161594
WHITE CREME DE CACAO,2012,8.63146939077652
AMERICAN BRANDIES,2018,12.186265716396484
SCOTCH WHISKIES,2017,20.67654351421518
BLACKBERRY BRANDIES,2016,10.053921479768114
AMERICAN COCKTAILS,2013,7.181760294774377
WHISKEY LIQUEUR,2016,16.913044328979495
CREAM LIQUEURS,2012,22.48481989251298
CANADIAN WHISKIES,2012,12.284271022200707
AMERICAN SCHNAPPS,2018,10.76967230639107
PEACH SCHNAPPS,2012,10.551954702671644
IMPORTED VODKAS,2024,15.990142307439395
SPICED RUM,2013,15.200857166001235
AMERICAN DRY GINS,2014,9.000491027649897
STRAIGHT RYE WHISKIES,2024,39.45457844585347
COCKTAILS/RTD,2019,7.0314818841174995
DISTILLED SPIRITS SPECIALTY,2016,9.47208150533898
STRAIGHT BOURBON WHISKIES,2015,18.958994878380427
AMERICAN SLOE GINS,2012,7.179830890226341
CHERRY BRANDIES,2015,10.995459033980364
RASPBERRY SCHNAPPS,2013,9.766518976852108

2025-01-26 00:15:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:15:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:15:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:15:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-26 00:15:37 - snowflake.connector.connection - INFO - closed
2025-01-26 00:15:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:15:37 - root - INFO - SQL:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
HAVING SUM("sale_dollars") IS NOT NULL
LIMIT 100
Results:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
IRISH WHISKIES,9238465.830000002
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.88999999
SCOTCH WHISKIES,5719870.57
SINGLE BARREL BOURBON WHISKIES,1066574.46
IMPORTED SCHNAPPS,6637742.610000001
COCKTAILS/RTD,8692059.71
IMPORTED GINS,3186.72
WHISKEY LIQUEUR,24665650.71
SINGLE MALT SCOTCH,4454879.36
BOTTLED IN BOND BOURBON,694701.2699999999
COFFEE LIQUEURS,2126049.54
IMPORTED FLAVORED VODKA,5785184.289999999
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000001
AMERICAN FLAVORED VODKA,10537284.849999996
FLAVORED GIN,388056.5400000001
AMERICAN SCHNAPPS,6561224.369999998
BLENDED WHISKIES,12635514.849999996
MEZCAL,430727.72999999986
IMPORTED BRANDIES,15995277.500000002
AMERICAN VODKAS,61440411.24
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.07
TRIPLE SEC,848208.0200000001
NEUTRAL GRAIN SPIRITS,642212.9200000002
DISTILLED SPIRITS SPECIALTY,28070.0
SPECIAL ORDER ITEMS,1523594.5999999999
AGED DARK RUM,1073387.5299999998
MIXTO TEQUILA,10668562.360000001
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.3799999997
CORN WHISKIES,442212.51999999996
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
GOLD RUM,1162585.6700000002
TEMPORARY & SPECIALTY PACKAGES,10174030.04
CREAM LIQUEURS,8860918.940000003
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.38
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
FLAVORED RUM,9023511.589999998
AMERICAN WHISKIES,1881.0
CANADIAN WHISKIES,47392655.67
AMERICAN BRANDIES,5216033.320000001
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.589999999
STRAIGHT BOURBON WHISKIES,34498254.830000006
STRAIGHT RYE WHISKIES,4793496.380000001

2025-01-26 00:15:37 - root - INFO - itercount: 0
2025-01-26 00:15:37 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
DDL describes table information.
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
Sure, let's consider which tables and columns are relevant to the task.

### **Relevant Table:**

- **Table Name:** `SALES`
- **Database:** `IOWA_LIQUOR_SALES`
- **Schema:** `IOWA_LIQUOR_SALES`

### **Relevant Columns and Their Potential Usage:**

- **`"category_name"`**: To identify and group the liquor sales by category.
- **`"sale_dollars"`**: To calculate the total sales amount in dollars.
- **`"volume_sold_liters"`**: To compute the total volume sold in liters.
- **`"date"`**: To filter the sales data by specific years (2019, 2020, 2021).
- **`"category"`**: May be used alongside `"category_name"` for more precise identification.
- **`"bottles_sold"`**: To analyze the number of bottles sold per category.
- **`"bottle_volume_ml"`**: To understand the size of the bottles sold.
- **`"state_bottle_retail"`**: To know the retail price per bottle.
- **`"state_bottle_cost"`**: To know the cost per bottle.

### **Conditions That May Be Used:**

- **Date Filtering**: Extracting the year from the `"date"` column to filter records for 2019, 2020, and 2021.
- **Grouping**: Grouping data by `"category_name"` to calculate aggregate metrics per category.
- **Calculations**: Computing average price per liter using `"sale_dollars"` divided by `"volume_sold_liters"`.
- **Ordering**: Sorting the results to identify the top categories by average price per liter.
- **Limiting Results**: Using `LIMIT` to restrict the number of rows returned.

### **SQL Queries:**

Here are at least 10 different SQL queries to explore the data:

1. **Retrieve distinct category names:**

   ```sql
   SELECT DISTINCT "category_name"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
   ```

2. **Get sales records from the year 2021:**

   ```sql
   SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021
   LIMIT 100;
   ```

3. **Select total sales and volume sold for each transaction:**

   ```sql
   SELECT "sale_dollars", "volume_sold_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
   ```

4. **Calculate the price per liter for each sale:**

   ```sql
   SELECT ("sale_dollars" / "volume_sold_liters") AS "price_per_liter"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE "volume_sold_liters" > 0
   LIMIT 100;
   ```

5. **Get the total sales per category in 2021:**

   ```sql
   SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021
   GROUP BY "category_name"
   LIMIT 100;
   ```

6. **Compute average price per liter per category in 2021:**

   ```sql
   SELECT "category_name", (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021 AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   LIMIT 100;
   ```

7. **List categories and their average price per liter over the years:**

   ```sql
   SELECT 
     "category_name",
     YEAR("date") AS "year",
     (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
   GROUP BY "category_name", YEAR("date")
   LIMIT 100;
   ```

8. **Retrieve the top 10 categories by average price per liter in 2021:**

   ```sql
   SELECT "category_name", (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021 AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   ORDER BY "avg_price_per_liter_2021" DESC
   LIMIT 10;
   ```

9. **Get average prices per liter for top categories in 2019, 2020, and 2021:**

   ```sql
   SELECT
     "category_name",
     AVG(CASE WHEN YEAR("date") = 2019 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
     AVG(CASE WHEN YEAR("date") = 2020 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
     AVG(CASE WHEN YEAR("date") = 2021 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   LIMIT 100;
   ```

10. **Select sales data for specific categories in 2021:**

    ```sql
    SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE YEAR("date") = 2021 AND "category_name" IN ('Category1', 'Category2')
    LIMIT 100;
    ```

These queries help in understanding the data related to liquor sales in Iowa and are useful in identifying the top liquor categories by average price per liter over the specified years.Query:
SELECT DISTINCT "category_name"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
Answer:
category_name
IMPORTED WHISKIES
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100 PROOF VODKA
WHITE CREME DE CACAO
COCKTAILS/RTD
LOW PROOF VODKA
MISC. AMERICAN CORDIALS & LIQUEURS
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
AMERICAN FLAVORED VODKA
DECANTERS & SPECIALTY PACKAGES
GOLD RUM
IMPORTED SCHNAPPS
IOWA DISTILLERY WHISKIES
AMARETTO - IMPORTED
PUERTO RICO & VIRGIN ISLANDS RUM
BOTTLED IN BOND BOURBON
SINGLE MALT SCOTCH
WHISKEY LIQUEUR
PEACH BRANDIES
JAPANESE WHISKY
SPICED RUM
AMERICAN DISTILLED SPIRITS SPECIALTY
PEPPERMINT SCHNAPPS
CORN WHISKIES
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
AMERICAN GRAPE BRANDIES
MEZCAL
IOWA DISTILLERIES
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
IMPORTED GINS
CINNAMON SCHNAPPS
""
AMERICAN SCHNAPPS
ROCK & RYE
AMERICAN VODKAS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
IMPORTED VODKA - CHERRY
AMERICAN AMARETTO
WHITE RUM
IMPORTED BRANDIES
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
FLAVORED GIN
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS
JAMAICA RUM
WHITE CREME DE MENTHE
CHERRY BRANDIES
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
SCOTCH WHISKIES
100% AGAVE TEQUILA
SINGLE BARREL BOURBON WHISKIES
ROOT BEER SCHNAPPS
SPEARMINT SCHNAPPS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
TROPICAL FRUIT SCHNAPPS
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
IMPORTED VODKAS
IMPORTED DRY GINS
BLACKBERRY BRANDIES
AMERICAN COCKTAILS
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AGED DARK RUM
MIXTO TEQUILA
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
APPLE SCHNAPPS
SPECIAL ORDER ITEMS
ANISETTE
IMPORTED CORDIALS & LIQUEURS
FLAVORED RUM
AMERICAN WHISKIES
CANADIAN WHISKIES
AMERICAN BRANDIES
Query:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021
   LIMIT 100;
Answer:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-06-09,IMPORTED SCHNAPPS,38.97,2.25
2021-11-24,IMPORTED SCHNAPPS,38.97,2.25
2021-03-08,IMPORTED SCHNAPPS,48.0,2.25
2021-06-25,IMPORTED SCHNAPPS,48.0,2.25
2021-03-08,IMPORTED SCHNAPPS,48.0,2.25
2021-08-17,IMPORTED SCHNAPPS,38.97,2.25
2021-03-11,IMPORTED SCHNAPPS,38.97,2.25
2021-08-12,IMPORTED SCHNAPPS,38.97,2.25
2021-10-04,IMPORTED SCHNAPPS,38.97,2.25
2021-04-16,IMPORTED SCHNAPPS,38.97,2.25
2021-12-17,IMPORTED SCHNAPPS,65.34,2.25
2021-11-05,IMPORTED SCHNAPPS,58.5,2.25
2021-07-09,COCKTAILS/RTD,54.0,2.25
2021-09-10,FLAVORED RUM,40.77,2.25
2021-03-02,FLAVORED RUM,40.77,2.25
2021-12-10,CREAM LIQUEURS,60.75,2.25
2021-09-16,CREAM LIQUEURS,60.75,2.25
2021-12-30,CREAM LIQUEURS,60.75,2.25
2021-03-29,CREAM LIQUEURS,60.75,2.25
2021-07-16,AMERICAN CORDIALS & LIQUEURS,60.75,2.25
2021-12-28,AMERICAN CORDIALS & LIQUEURS,60.75,2.25
2021-02-11,AMERICAN CORDIALS & LIQUEURS,58.5,2.25
2021-12-29,AMERICAN CORDIALS & LIQUEURS,60.75,2.25
2021-01-05,COFFEE LIQUEURS,22.38,2.25
2021-03-16,AMERICAN SCHNAPPS,29.25,2.25
2021-10-22,AMERICAN CORDIALS & LIQUEURS,36.0,2.25
2021-12-01,AMERICAN CORDIALS & LIQUEURS,36.0,2.25
2021-05-13,AMERICAN CORDIALS & LIQUEURS,36.0,2.25
2021-02-22,AMERICAN CORDIALS & LIQUEURS,27.0,2.25
2021-09-15,CREAM LIQUEURS,76.5,2.25
2021-08-17,TENNESSEE WHISKIES,70.08,2.25
2021-09-21,TENNESSEE WHISKIES,70.08,2.25
2021-11-17,TENNESSEE WHISKIES,70.08,2.25
2021-09-24,AMERICAN DISTILLED SPIRITS SPECIALTY,87.75,2.25
2021-12-22,AMERICAN DISTILLED SPIRITS SPECIALTY,87.75,2.25
2021-08-09,IMPORTED FLAVORED VODKA,51.0,2.25
2021-04-13,IMPORTED FLAVORED VODKA,51.0,2.25
2021-09-15,IMPORTED FLAVORED VODKA,51.0,2.25
2021-02-26,IMPORTED FLAVORED VODKA,51.0,2.25
2021-09-28,IMPORTED FLAVORED VODKA,51.0,2.25
2021-09-23,IMPORTED FLAVORED VODKA,51.0,2.25
Query:
SELECT "sale_dollars", "volume_sold_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
Answer:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
Query:
SELECT ("sale_dollars" / "volume_sold_liters") AS "price_per_liter"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE "volume_sold_liters" > 0
   LIMIT 100;
Answer:
price_per_liter
39.82666666666667
40.0
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
31.959999999999997
30.919999999999998
33.0
31.959999999999997
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
26.026666666666667
31.0
31.0
29.0
29.0
26.026666666666667
31.0
29.0
29.0
29.0
27.0
29.0
31.0
29.0
29.0
29.0
29.0
27.0
43.013333333333335
26.10666666666667
28.0
26.0
26.0
25.506666666666668
24.986666666666665
26.0
27.0
25.506666666666668
25.506666666666668
25.506666666666668
25.506666666666668
27.0
25.506666666666668
39.97333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
46.626666666666665
46.61333333333333
45.0
46.626666666666665
46.61333333333333
46.626666666666665
46.0
46.61333333333333
46.61333333333333
45.0
46.61333333333333
46.61333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
21.0
21.0
23.653333333333332
28.0
24.0
19.666666666666668
19.653333333333332
19.666666666666668
19.986666666666665
19.666666666666668
18.32
19.653333333333332
19.666666666666668
20.693333333333335
19.653333333333332
20.0
18.32
19.666666666666668
19.986666666666665
18.333333333333332
18.986666666666665
19.986666666666665
19.986666666666665
18.986666666666665
18.666666666666668
Query:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021
   GROUP BY "category_name"
   LIMIT 100;
Answer:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
100% AGAVE TEQUILA,23915928.889999993
SCOTCH WHISKIES,5719870.569999998
SINGLE BARREL BOURBON WHISKIES,1066574.4600000002
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.049999997
IMPORTED SCHNAPPS,6637742.609999999
COFFEE LIQUEURS,2126049.5400000005
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000001
IMPORTED FLAVORED VODKA,5785184.289999998
WHISKEY LIQUEUR,24665650.71
BOTTLED IN BOND BOURBON,694701.2699999998
SINGLE MALT SCOTCH,4454879.359999999
COCKTAILS/RTD,8692059.71
AMERICAN FLAVORED VODKA,10537284.849999998
FLAVORED GIN,388056.5400000001
SPECIAL ORDER ITEMS,1523594.6000000003
IMPORTED GINS,3186.72
AGED DARK RUM,1073387.53
MIXTO TEQUILA,10668562.36
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999997
CREAM LIQUEURS,8860918.940000001
IMPORTED DRY GINS,5602434.380000001
IMPORTED VODKAS,14556785.38
FLAVORED RUM,9023511.589999998
IMPORTED CORDIALS & LIQUEURS,11206838.639999995
AMERICAN WHISKIES,1881.0
MEZCAL,430727.73
BLENDED WHISKIES,12635514.849999998
GOLD RUM,1162585.6700000002
IMPORTED BRANDIES,15995277.500000004
AMERICAN CORDIALS & LIQUEURS,4293640.07
AMERICAN SLOE GINS,31666.350000000006
WHITE RUM,6709359.589999998
AMERICAN SCHNAPPS,6561224.369999999
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.3799999997
CORN WHISKIES,442212.51999999996
AMERICAN DRY GINS,3712780.8
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
AMERICAN VODKAS,61440411.240000024
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.830000006
CANADIAN WHISKIES,47392655.67
AMERICAN BRANDIES,5216033.320000001
TEMPORARY & SPECIALTY PACKAGES,10174030.040000001
Query:
SELECT "category_name", (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021 AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   LIMIT 100;
Answer:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
100% AGAVE TEQUILA,38.690348969834034
SCOTCH WHISKIES,24.254713885217736
SINGLE BARREL BOURBON WHISKIES,45.24511724094048
IMPORTED FLAVORED VODKA,21.643416192740222
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553686
COFFEE LIQUEURS,22.129367390670087
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.94450721689939
COCKTAILS/RTD,7.8800405248154375
IMPORTED GINS,29.506666666666664
CREAM LIQUEURS,23.566367164593295
IMPORTED SCHNAPPS,18.977555582907012
WHISKEY LIQUEUR,21.373583265167575
SINGLE MALT SCOTCH,60.885541103295026
BOTTLED IN BOND BOURBON,31.34650618175255
FLAVORED GIN,28.508519352480718
BLENDED WHISKIES,14.89798444555805
AMERICAN DRY GINS,10.659231884796098
MIXTO TEQUILA,16.6948587928507
AMERICAN FLAVORED VODKA,14.778221731089833
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN VODKAS,10.783467469100112
AGED DARK RUM,25.435000189568072
TRIPLE SEC,4.062804851178789
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766428
GOLD RUM,11.54485568355306
IMPORTED BRANDIES,48.258683719642995
SPECIAL ORDER ITEMS,12.158831483951698
IMPORTED DRY GINS,25.64094711101976
IMPORTED VODKAS,17.8491992271601
NEUTRAL GRAIN SPIRITS,16.93204748682005
DISTILLED SPIRITS SPECIALTY,46.666666666666664
STRAIGHT RYE WHISKIES,41.683642868782925
STRAIGHT BOURBON WHISKIES,25.70818919158894
FLAVORED RUM,15.466602183579408
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
AMERICAN WHISKIES,38.0
MEZCAL,43.15801006988802
AMERICAN CORDIALS & LIQUEURS,17.003420849153276
AMERICAN SLOE GINS,8.129999999999999
SPICED RUM,15.600406892036029
AMERICAN DISTILLED SPIRITS SPECIALTY,26.87902336877481
CORN WHISKIES,43.020967020138144
CANADIAN WHISKIES,15.64668188921957
AMERICAN BRANDIES,12.525057326504214
WHITE RUM,10.964751984850398
TEMPORARY & SPECIALTY PACKAGES,29.721942148779643
Query:
SELECT 
     "category_name",
     YEAR("date") AS "year",
     (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
   GROUP BY "category_name", YEAR("date")
   LIMIT 100;
Answer:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399702
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.13
CANADIAN WHISKIES,2020,14.945131655072625
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474596
BLENDED WHISKIES,2021,14.897984445558048
COFFEE LIQUEURS,2019,21.073586682369243
SPICED RUM,2020,15.345321660461218
COCKTAILS/RTD,2021,7.880040524815443
TENNESSEE WHISKIES,2021,30.944507216899392
CREAM LIQUEURS,2019,21.44355441784796
SPICED RUM,2021,15.600406892036023
IMPORTED VODKAS,2021,17.849199227160096
SPICED RUM,2019,15.426264276542772
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.88952876216467
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094048
AGED DARK RUM,2019,22.563808617147032
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DRY GINS,2019,9.715900992663789
IMPORTED BRANDIES,2020,44.210873670062206
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
AMERICAN FLAVORED VODKA,2021,14.778221731089825
IMPORTED SCHNAPPS,2021,18.977555582907016
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461906
AMERICAN VODKAS,2019,9.905176669185822
IMPORTED BRANDIES,2019,43.539679243138096
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.619786967633495
AMERICAN SLOE GINS,2021,8.13
100% AGAVE TEQUILA,2020,34.803301084015715
TRIPLE SEC,2020,4.148281073749889
AMERICAN VODKAS,2020,10.37159267048766
NEUTRAL GRAIN SPIRITS,2019,17.01644187052472
SINGLE MALT SCOTCH,2019,57.15989001475904
TEMPORARY & SPECIALTY PACKAGES,2021,29.72194214877965
SINGLE MALT SCOTCH,2021,60.88554110329501
MEZCAL,2021,43.15801006988803
IMPORTED DRY GINS,2020,25.539127017730863
WHISKEY LIQUEUR,2020,20.730351917360554
CANADIAN WHISKIES,2021,15.646681889219572
IMPORTED FLAVORED VODKA,2020,21.571944764231883
CREAM LIQUEURS,2021,23.566367164593306
IRISH WHISKIES,2020,30.62602456955368
CORN WHISKIES,2020,43.984085752070726
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553065
STRAIGHT BOURBON WHISKIES,2020,23.926092815813533
SPECIAL ORDER ITEMS,2020,11.042254060180483
NEUTRAL GRAIN SPIRITS,2020,15.882001897018917
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.844823153258522
IMPORTED WHISKIES,2021,122.63999999999999
IMPORTED FLAVORED VODKA,2021,21.64341619274022
AGED DARK RUM,2021,25.435000189568072
STRAIGHT BOURBON WHISKIES,2019,22.33825638967842
BOTTLED IN BOND BOURBON,2021,31.346506181752556
SINGLE BARREL BOURBON WHISKIES,2020,43.45435421500387
SPECIAL ORDER ITEMS,2021,12.158831483951698
IMPORTED DRY GINS,2019,25.14449714106277
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.857767776179166
FLAVORED RUM,2019,15.046644580058297
AMERICAN BRANDIES,2019,12.354296281418298
DISTILLED SPIRITS SPECIALTY,2020,41.00539396078036
AMERICAN CORDIALS & LIQUEURS,2021,17.00342084915327
CREAM LIQUEURS,2020,22.742294325622787
IMPORTED SCHNAPPS,2020,19.254555188977086
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638388
NEUTRAL GRAIN SPIRITS,2021,16.932047486820053
MEZCAL,2020,39.04244202822056
TENNESSEE WHISKIES,2020,30.66874081058491
AMERICAN BRANDIES,2020,12.511142937266236
TEMPORARY & SPECIALTY PACKAGES,2020,28.02001031400777
IMPORTED DRY GINS,2021,25.64094711101976
AMERICAN DRY GINS,2020,10.61701159020084
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840916
WHISKEY LIQUEUR,2019,17.79668226153553
AMERICAN FLAVORED VODKA,2020,14.375297199122384
AMERICAN BRANDIES,2021,12.525057326504212
IOWA DISTILLERY WHISKIES,2019,44.984125849124055
GOLD RUM,2020,11.352277433620902
WHITE RUM,2019,10.546667376514389
IMPORTED SCHNAPPS,2019,18.954484643888566
BOTTLED IN BOND BOURBON,2019,28.078917260273972
TRIPLE SEC,2019,4.085114256272668
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.879023368774806
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766426
AMERICAN SLOE GINS,2019,8.53209241499564
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842865
AMERICAN DRY GINS,2021,10.659231884796094
WHITE RUM,2021,10.964751984850398
MEZCAL,2019,39.29683802816901
SCOTCH WHISKIES,2019,21.45216209746601
MIXTO TEQUILA,2020,16.81811637478133
IMPORTED GINS,2021,29.506666666666664
Query:
SELECT "category_name", (SUM("sale_dollars") / SUM("volume_sold_liters")) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") = 2021 AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   ORDER BY "avg_price_per_liter_2021" DESC
   LIMIT 10;
Answer:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.885541103295026
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094048
MEZCAL,43.15801006988803
CORN WHISKIES,43.02096702013814
STRAIGHT RYE WHISKIES,41.68364286878291
100% AGAVE TEQUILA,38.690348969834034
AMERICAN WHISKIES,38.0
Query:
SELECT
     "category_name",
     AVG(CASE WHEN YEAR("date") = 2019 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
     AVG(CASE WHEN YEAR("date") = 2020 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
     AVG(CASE WHEN YEAR("date") = 2021 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   WHERE YEAR("date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
   GROUP BY "category_name"
   LIMIT 100;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IMPORTED WHISKIES,,,122.63999999999999
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839592,67.04129026491188
SCOTCH WHISKIES,38.165624002982476,46.20837834035606,43.60865760092795
100% AGAVE TEQUILA,53.463127666314485,62.00248889783082,49.89756178988085
SINGLE BARREL BOURBON WHISKIES,39.53667861409796,47.00520962540312,49.255214507479536
COFFEE LIQUEURS,28.21844631804037,35.328731945040204,34.39183419198717
IMPORTED GINS,,29.506666666666668,29.506666666666664
WHISKEY LIQUEUR,87.97801137222733,194.19179627184778,174.76841460973736
SINGLE MALT SCOTCH,65.34125774002436,70.52012090655106,69.1125472066271
BOTTLED IN BOND BOURBON,30.578072162785823,38.27726377262402,39.58066886446885
COCKTAILS/RTD,8.212979654786865,9.772540043975074,11.735321999830356
IMPORTED FLAVORED VODKA,27.809870620861272,29.344069448880145,26.034077129118284
NEUTRAL GRAIN SPIRITS FLAVORED,42.571947275922675,57.50635858234885,93.9471378460607
IMPORTED DRY GINS,26.48205366726885,30.10448774673491,34.40948523840317
IMPORTED VODKAS,33.94282101537268,50.43275694766234,52.64830400519427
MIXTO TEQUILA,31.837582550848413,47.129571205397355,56.96746636137455
SPECIAL ORDER ITEMS,38.93629452760654,38.31677534424565,49.975782341659226
AMERICAN FLAVORED VODKA,19.359387465602904,26.18978392884919,29.025127878014096
IOWA DISTILLERY WHISKIES,56.853846153846135,53.18666666666667,
IRISH WHISKIES,43.27135576698969,51.40246272246467,41.48447550141956
TENNESSEE WHISKIES,51.967097550423084,81.42800903781644,97.68531463293048
AGED DARK RUM,24.951028244979067,27.08275132275132,28.470402364198655
FLAVORED GIN,14.612340966921114,16.77274280136652,87.1866108675435
MEZCAL,41.350583580613254,40.60712506486767,44.22890839041096
IMPORTED DISTILLED SPIRITS SPECIALTY,15.692297934779745,23.00392800514591,22.744303165271706
TRIPLE SEC,4.3579375470278405,4.449197714598516,4.342926065162907
CREAM LIQUEURS,34.84226262444941,53.696614152940676,58.35006208884961
,20.75208931165227,28.37729886358918,
FLAVORED RUM,19.31172430289187,25.591920869013798,23.266876296999577
IMPORTED CORDIALS & LIQUEURS,44.53190786892556,64.10986935241029,65.4116998219505
GOLD RUM,17.958248098089964,23.199210662534902,23.669004543525812
AMERICAN WHISKIES,,,38.0
SPICED RUM,21.188301231387907,27.88929072336502,29.534264387741956
AMERICAN DISTILLED SPIRITS SPECIALTY,25.724575320169613,65.16782744282742,35.820757744733584
CORN WHISKIES,31.184231678486984,35.13320881971466,40.0773285198556
IMPORTED BRANDIES,54.02600405472328,69.90961987353661,57.39853770766352
WHITE RUM,17.656370727725957,24.50097526606747,26.315446670851767
CANADIAN WHISKIES,28.623783191786266,42.08775328972834,40.79021499316633
AMERICAN BRANDIES,16.152836498476987,20.322498148126662,20.37991819810992
STRAIGHT RYE WHISKIES,40.49802776541434,58.88887511340513,63.68111754218403
STRAIGHT BOURBON WHISKIES,33.314401284573215,41.33540778972636,47.55587724596054
DELISTED / SPECIAL ORDER ITEMS,,37.0,
AMERICAN DRY GINS,14.10050937128047,19.476307783960365,19.691440523146266
TEMPORARY & SPECIALTY PACKAGES,42.15541112225676,74.73013356849815,139.81430923521975
AMERICAN CORDIALS & LIQUEURS,29.148327547171217,64.25759031021087,135.32257763155843
AMERICAN SLOE GINS,8.43911528150134,8.129999999999999,8.129999999999999
AMERICAN VODKAS,17.737137185778874,26.3801532250147,28.90835493634657
BLENDED WHISKIES,19.395395197045108,30.517439358916437,39.082210088048036
NEUTRAL GRAIN SPIRITS,17.47945926973662,16.480406118643636,17.14366921883205
DISTILLED SPIRITS SPECIALTY,,44.098628364389214,46.666666666666686
AMERICAN SCHNAPPS,23.146407887509646,53.74331643730583,60.283603807457176
Query:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021) AND "volume_sold_liters" > 0
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
,20.752089311652263,28.377298863589196,
IOWA DISTILLERY WHISKIES,56.853846153846135,53.18666666666667,
DELISTED / SPECIAL ORDER ITEMS,,37.0,
WHISKEY LIQUEUR,87.97801137222733,194.1917962718478,174.76841460973736
TEMPORARY & SPECIALTY PACKAGES,42.15541112225677,74.7301335684981,139.81430923521975
AMERICAN CORDIALS & LIQUEURS,29.14832754717122,64.25759031021087,135.32257763155843
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.9670975504231,81.42800903781644,97.6853146329305
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592266,57.50635858234885,93.9471378460607
FLAVORED GIN,14.612340966921114,16.772742801366523,87.1866108675435
Query:
SELECT DISTINCT "category_name"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Answer:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
MISC. AMERICAN CORDIALS & LIQUEURS
IMPORTED SCHNAPPS
PEACH SCHNAPPS
AMERICAN ALCOHOL
AMARETTO - IMPORTED
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
IMPORTED VODKA - CHERRY
AMERICAN VODKAS
AMERICAN AMARETTO
CHERRY BRANDIES
IOWA DISTILLERIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
RASPBERRY SCHNAPPS
IMPORTED BRANDIES
DECANTERS & SPECIALTY PACKAGES
MIXTO TEQUILA
IOWA DISTILLERY WHISKIES
GOLD RUM
PUERTO RICO & VIRGIN ISLANDS RUM
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
AMERICAN FLAVORED VODKA
AMERICAN WHISKIES
TROPICAL FRUIT SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
100 PROOF VODKA
WHITE CREME DE CACAO
""
AGED DARK RUM
IMPORTED AMARETTO
NEUTRAL GRAIN SPIRITS
DISTILLED SPIRITS SPECIALTY
HOLIDAY VAP
ANISETTE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN SCHNAPPS
ROCK & RYE
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
FLAVORED GIN
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS
Query:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
LIMIT 100
Answer:
date,category_name,sale_dollars,volume_sold_liters
2021-06-28,IMPORTED CORDIALS & LIQUEURS,89.97,2.25
2021-07-23,WHISKEY LIQUEUR,48.0,2.25
2021-08-23,WHISKEY LIQUEUR,48.0,2.25
2021-10-06,WHISKEY LIQUEUR,48.0,2.25
2021-01-21,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-02-04,WHISKEY LIQUEUR,48.0,2.25
2021-11-16,WHISKEY LIQUEUR,48.0,2.25
2021-01-22,WHISKEY LIQUEUR,40.5,2.25
2021-12-28,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-05-27,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-13,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-03,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-05-28,IMPORTED CORDIALS & LIQUEURS,104.91,2.25
2021-08-12,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-08,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-26,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-12-07,IMPORTED CORDIALS & LIQUEURS,65.31,2.25
2021-08-06,IMPORTED CORDIALS & LIQUEURS,65.25,2.25
2021-11-16,IMPORTED CORDIALS & LIQUEURS,78.75,2.25
2021-02-24,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-09-10,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-03-29,IMPORTED CORDIALS & LIQUEURS,87.75,2.25
2021-12-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-12-20,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-10-22,TEMPORARY & SPECIALTY PACKAGES,74.22,2.25
2021-06-25,CREAM LIQUEURS,42.75,2.25
2021-07-29,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-26,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-08,IMPORTED FLAVORED VODKA,74.22,2.25
2021-03-22,IMPORTED FLAVORED VODKA,74.22,2.25
2021-05-07,IMPORTED FLAVORED VODKA,74.22,2.25
2021-08-31,IMPORTED CORDIALS & LIQUEURS,74.25,2.25
2021-04-29,IMPORTED CORDIALS & LIQUEURS,85.86,2.25
2021-01-05,IMPORTED FLAVORED VODKA,74.22,2.25
2021-09-14,IMPORTED CORDIALS & LIQUEURS,61.08,2.25
2021-04-27,WHISKEY LIQUEUR,48.0,2.25
2021-11-03,WHISKEY LIQUEUR,48.0,2.25
2021-11-08,WHISKEY LIQUEUR,48.0,2.25
2021-04-05,CREAM LIQUEURS,51.75,2.25
2021-04-23,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-08-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-03-26,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-11-15,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-05-25,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
2021-09-24,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-09-15,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-11-04,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-07-08,IMPORTED CORDIALS & LIQUEURS,58.5,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-01-15,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-04-07,IMPORTED CORDIALS & LIQUEURS,63.45,2.25
2021-07-21,IMPORTED CORDIALS & LIQUEURS,146.25,2.25
2021-05-17,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-12-06,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-11-18,IMPORTED CORDIALS & LIQUEURS,48.3,2.25
2021-05-14,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-04-20,IMPORTED CORDIALS & LIQUEURS,56.22,2.25
2021-07-16,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-10-15,IMPORTED CORDIALS & LIQUEURS,90.0,2.25
2021-01-18,COFFEE LIQUEURS,58.44,2.25
2021-10-15,COFFEE LIQUEURS,60.66,2.25
2021-07-08,COFFEE LIQUEURS,58.47,2.25
2021-06-12,COFFEE LIQUEURS,58.47,2.25
2021-05-27,COFFEE LIQUEURS,58.47,2.25
2021-03-05,CREAM LIQUEURS,74.22,2.25
2021-07-19,CREAM LIQUEURS,74.22,2.25
2021-09-29,CREAM LIQUEURS,74.22,2.25
2021-04-02,CREAM LIQUEURS,74.22,2.25
2021-03-19,CREAM LIQUEURS,74.22,2.25
2021-01-04,CREAM LIQUEURS,76.44,2.25
2021-01-15,CREAM LIQUEURS,74.22,2.25
2021-03-03,CREAM LIQUEURS,74.22,2.25
2021-06-07,CREAM LIQUEURS,74.22,2.25
2021-04-15,CREAM LIQUEURS,74.22,2.25
2021-09-11,CREAM LIQUEURS,42.75,2.25
2021-05-24,CREAM LIQUEURS,42.75,2.25
2021-02-01,CREAM LIQUEURS,40.5,2.25
2021-11-16,CREAM LIQUEURS,40.5,2.25
2021-07-07,WHISKEY LIQUEUR,48.0,2.25
2021-02-15,WHISKEY LIQUEUR,48.0,2.25
2021-10-13,WHISKEY LIQUEUR,40.41,2.25
2021-11-01,WHISKEY LIQUEUR,40.41,2.25
2021-02-03,WHISKEY LIQUEUR,40.41,2.25
2021-09-27,WHISKEY LIQUEUR,40.5,2.25
2021-08-17,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-24,IMPORTED CORDIALS & LIQUEURS,103.5,2.25
2021-03-30,IMPORTED SCHNAPPS,58.5,2.25
2021-12-21,IMPORTED SCHNAPPS,58.5,2.25
2021-08-04,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-18,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-19,IMPORTED CORDIALS & LIQUEURS,101.25,2.25
2021-10-29,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-10-25,IMPORTED CORDIALS & LIQUEURS,45.0,2.25
2021-02-01,IMPORTED CORDIALS & LIQUEURS,44.97,2.25
2021-04-23,CREAM LIQUEURS,51.75,2.25
2021-10-01,CREAM LIQUEURS,51.75,2.25
2021-08-19,IMPORTED CORDIALS & LIQUEURS,63.48,2.25
Query:
SELECT "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Answer:
sale_dollars,volume_sold_liters
-135.0,-21.0
-206.64,-18.0
-70.56,-12.0
-233.88,-12.0
-225.0,-12.0
-332.28,-12.0
-135.0,-12.0
-193.5,-10.5
-78.66,-10.5
-90.36,-10.5
-132.78,-10.5
-261.6,-9.6
-336.12,-9.0
-65.52,-9.0
-66.24,-9.0
-144.0,-9.0
-93.96,-9.0
-99.0,-9.0
-87.4,-7.5
-195.06,-6.0
-72.0,-4.8
-450.0,-4.5
-103.5,-4.5
-51.0,-3.0
-94.5,-2.25
-58.5,-2.25
-13.13,-1.75
-13.5,-1.5
-24.0,-1.5
-24.76,-1.5
-71.4,-1.5
-18.0,-1.12
-6.38,-1.0
-16.8,-0.75
-6.38,-0.75
-145.01,-0.75
-54.74,-0.75
-77.4,-0.6
-77.4,-0.6
-11.25,-0.05
-8.85,-0.05
-25.74,-0.05
7.4,0.02
8.45,0.02
7.4,0.02
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
90.0,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
77.4,0.05
Query:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
LIMIT 100
Answer:
price_per_liter
39.82666666666667
40.0
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
31.959999999999997
30.919999999999998
33.0
31.959999999999997
36.986666666666665
36.986666666666665
36.986666666666665
32.986666666666665
36.986666666666665
26.026666666666667
31.0
31.0
29.0
29.0
26.026666666666667
31.0
29.0
29.0
29.0
27.0
29.0
31.0
29.0
29.0
29.0
29.0
27.0
43.013333333333335
26.10666666666667
28.0
26.0
26.0
25.506666666666668
24.986666666666665
26.0
27.0
25.506666666666668
25.506666666666668
25.506666666666668
25.506666666666668
27.0
25.506666666666668
39.97333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
46.626666666666665
46.61333333333333
45.0
46.626666666666665
46.61333333333333
46.626666666666665
46.0
46.61333333333333
46.61333333333333
45.0
46.61333333333333
46.61333333333333
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.626666666666665
46.0
21.0
21.0
23.653333333333332
28.0
24.0
19.666666666666668
19.653333333333332
19.666666666666668
19.986666666666665
19.666666666666668
18.32
19.653333333333332
19.666666666666668
20.693333333333335
19.653333333333332
20.0
18.32
19.666666666666668
19.986666666666665
18.333333333333332
18.986666666666665
19.986666666666665
19.986666666666665
18.986666666666665
18.666666666666668
Query:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Answer:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
COFFEE LIQUEURS,2126049.54
COCKTAILS/RTD,8692059.710000003
CREAM LIQUEURS,8860918.940000001
SPECIAL ORDER ITEMS,1523594.6
IMPORTED FLAVORED VODKA,5785184.290000003
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000004
IRISH WHISKIES,9238465.83
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.889999986
SCOTCH WHISKIES,5719870.570000002
SINGLE BARREL BOURBON WHISKIES,1066574.4600000004
IMPORTED GINS,3186.72
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.379999999
AMERICAN FLAVORED VODKA,10537284.849999996
IMPORTED SCHNAPPS,6637742.610000001
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.0700000003
TRIPLE SEC,848208.0199999999
MEZCAL,430727.7299999999
WHISKEY LIQUEUR,24665650.70999999
BOTTLED IN BOND BOURBON,694701.27
SINGLE MALT SCOTCH,4454879.36
FLAVORED GIN,388056.5400000001
MIXTO TEQUILA,10668562.36
BLENDED WHISKIES,12635514.850000001
AMERICAN SCHNAPPS,6561224.369999998
AGED DARK RUM,1073387.53
FLAVORED RUM,9023511.589999996
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
GOLD RUM,1162585.67
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
AMERICAN WHISKIES,1881.0
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.59
CANADIAN WHISKIES,47392655.66999997
AMERICAN BRANDIES,5216033.320000002
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.38
CORN WHISKIES,442212.52
AMERICAN VODKAS,61440411.240000024
IMPORTED BRANDIES,15995277.499999996
STRAIGHT RYE WHISKIES,4793496.380000001
STRAIGHT BOURBON WHISKIES,34498254.83
NEUTRAL GRAIN SPIRITS,642212.92
DISTILLED SPIRITS SPECIALTY,28070.0
TEMPORARY & SPECIALTY PACKAGES,10174030.040000003
Query:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
LIMIT 100
Answer:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
COFFEE LIQUEURS,22.129367390670087
COCKTAILS/RTD,7.880040524815435
CREAM LIQUEURS,23.56636716459329
SPECIAL ORDER ITEMS,12.158831483951694
IRISH WHISKIES,30.614299490641255
TENNESSEE WHISKIES,30.944507216899385
IMPORTED SCHNAPPS,18.977555582907012
100% AGAVE TEQUILA,38.69034896983403
SCOTCH WHISKIES,24.25471388521774
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
IMPORTED FLAVORED VODKA,21.64341619274021
NEUTRAL GRAIN SPIRITS FLAVORED,26.749903417553682
IMPORTED GINS,29.506666666666664
BLENDED WHISKIES,14.897984445558052
WHISKEY LIQUEUR,21.373583265167568
BOTTLED IN BOND BOURBON,31.346506181752545
SINGLE MALT SCOTCH,60.88554110329504
FLAVORED GIN,28.50851935248073
AMERICAN WHISKIES,38.0
IMPORTED DRY GINS,25.640947111019777
IMPORTED VODKAS,17.849199227160096
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.129999999999999
AMERICAN SCHNAPPS,12.48654758004576
AMERICAN FLAVORED VODKA,14.778221731089833
AGED DARK RUM,25.435000189568076
AMERICAN VODKAS,10.78346746910011
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766426
TRIPLE SEC,4.062804851178788
IMPORTED BRANDIES,48.258683719642995
GOLD RUM,11.54485568355305
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
FLAVORED RUM,15.46660218357941
IMPORTED CORDIALS & LIQUEURS,30.81065984451047
MIXTO TEQUILA,16.694858792850702
STRAIGHT RYE WHISKIES,41.68364286878291
STRAIGHT BOURBON WHISKIES,25.70818919158892
MEZCAL,43.15801006988803
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.02096702013815
AMERICAN DRY GINS,10.659231884796096
WHITE RUM,10.964751984850395
NEUTRAL GRAIN SPIRITS,16.932047486820043
DISTILLED SPIRITS SPECIALTY,46.666666666666664
CANADIAN WHISKIES,15.646681889219566
AMERICAN BRANDIES,12.525057326504212
Query:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Answer:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675
Query:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.88554110329501
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094049
MEZCAL,43.158010069888036
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.683642868782925
100% AGAVE TEQUILA,38.69034896983402
AMERICAN WHISKIES,38.0
Query:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IOWA DISTILLERY WHISKIES,56.853846153846156,53.18666666666667,
,20.752089311652266,28.37729886358918,
DELISTED / SPECIAL ORDER ITEMS,,37.0,
WHISKEY LIQUEUR,87.97801137222729,194.1917962718478,174.76841460973748
TEMPORARY & SPECIALTY PACKAGES,42.155411122256766,74.7301335684981,139.8143092352197
AMERICAN CORDIALS & LIQUEURS,29.148327547171228,64.25759031021087,135.3225776315584
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.967097550423105,81.42800903781644,97.68531463293048
NEUTRAL GRAIN SPIRITS FLAVORED,42.571947275922675,57.50635858234884,93.9471378460607
FLAVORED GIN,14.612340966921112,16.772742801366515,87.18661086754351
Query:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
WHISKEY LIQUEUR,87.97801137222731,194.19179627184775,174.7684146097374
TEMPORARY & SPECIALTY PACKAGES,42.15541112225676,74.7301335684981,139.81430923521975
AMERICAN CORDIALS & LIQUEURS,29.14832754717123,64.25759031021087,135.32257763155843
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.96709755042309,81.42800903781645,97.68531463293048
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592265,57.50635858234885,93.9471378460607
FLAVORED GIN,14.612340966921117,16.772742801366523,87.1866108675435
SINGLE MALT SCOTCH,65.34125774002437,70.52012090655103,69.1125472066271
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839594,67.04129026491188
IMPORTED CORDIALS & LIQUEURS,44.53190786892557,64.10986935241031,65.4116998219505
Query:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / NULLIF("volume_sold_liters", 0)) END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING "avg_price_per_liter_2021" IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
WHISKEY LIQUEUR,87.97801137222731,194.19179627184778,174.76841460973742
TEMPORARY & SPECIALTY PACKAGES,42.155411122256766,74.73013356849812,139.81430923521972
AMERICAN CORDIALS & LIQUEURS,29.148327547171228,64.25759031021086,135.3225776315584
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.96709755042309,81.42800903781647,97.6853146329305
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592267,57.50635858234885,93.94713784606068
FLAVORED GIN,14.612340966921114,16.772742801366523,87.1866108675435
SINGLE MALT SCOTCH,65.34125774002437,70.52012090655106,69.1125472066271
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839592,67.0412902649119
IMPORTED CORDIALS & LIQUEURS,44.53190786892556,64.1098693524103,65.4116998219505
Query:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE "volume_sold_liters" > 0
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
APPLE SCHNAPPS,,,
DARK CREME DE CACAO,,,
100 PROOF VODKA,,,
WATERMELON SCHNAPPS,,,
VODKA FLAVORED,,,
WHITE CREME DE CACAO,,,
CREME DE ALMOND,,,
HIGH PROOF BEER - AMERICAN,,,
LOW PROOF VODKA,,,
BUTTERSCOTCH SCHNAPPS,,,
Query:
SELECT
  "category_name",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2019",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2020",
  AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING AVG(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 AND "volume_sold_liters" > 0 THEN ("sale_dollars" / "volume_sold_liters") END) IS NOT NULL
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
WHISKEY LIQUEUR,87.97801137222727,194.19179627184778,174.76841460973742
TEMPORARY & SPECIALTY PACKAGES,42.15541112225675,74.7301335684981,139.8143092352197
AMERICAN CORDIALS & LIQUEURS,29.148327547171228,64.25759031021089,135.3225776315584
IMPORTED WHISKIES,,,122.63999999999999
TENNESSEE WHISKIES,51.96709755042308,81.42800903781644,97.6853146329305
NEUTRAL GRAIN SPIRITS FLAVORED,42.57194727592266,57.50635858234885,93.94713784606068
FLAVORED GIN,14.612340966921117,16.772742801366523,87.18661086754348
SINGLE MALT SCOTCH,65.34125774002435,70.52012090655106,69.11254720662708
IMPORTED SCHNAPPS,42.24854849903672,65.70965228839593,67.04129026491188
IMPORTED CORDIALS & LIQUEURS,44.53190786892556,64.10986935241031,65.4116998219505
Query:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
BUTTERSCOTCH SCHNAPPS,,,
APPLE SCHNAPPS,,,
WHITE CREME DE CACAO,,,
WATERMELON SCHNAPPS,,,
LOW PROOF VODKA,,,
DARK CREME DE CACAO,,,
CREME DE ALMOND,,,
HIGH PROOF BEER - AMERICAN,,,
100 PROOF VODKA,,,
VODKA FLAVORED,,,
Query:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IMPORTED WHISKIES,,,122.63999999999999
SINGLE MALT SCOTCH,57.159890014759014,60.72217496121816,60.88554110329504
IMPORTED BRANDIES,43.53967924313812,44.210873670062206,48.258683719642995
DISTILLED SPIRITS SPECIALTY,,41.00539396078035,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,39.25740658638388,43.45435421500387,45.24511724094048
MEZCAL,39.296838028169006,39.04244202822056,43.158010069888036
CORN WHISKIES,36.55578155302149,43.984085752070726,43.02096702013814
STRAIGHT RYE WHISKIES,37.4157134981119,39.89246488782911,41.68364286878291
100% AGAVE TEQUILA,34.867184567514734,34.80330108401571,38.69034896983405
AMERICAN WHISKIES,,,38.0
Query:
SELECT ("sale_dollars" / NULLIF("volume_sold_liters", 0)) AS "price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
LIMIT 100
Answer:
price_per_liter
6.428571428571429
11.479999999999999
5.88
19.49
18.75
27.689999999999998
11.25
18.428571428571427
7.491428571428571
8.605714285714285
12.645714285714286
27.250000000000004
37.346666666666664
7.279999999999999
7.359999999999999
16.0
10.44
11.0
11.653333333333334
32.51
15.0
100.0
23.0
17.0
42.0
26.0
7.502857142857144
9.0
16.0
16.506666666666668
47.6
16.07142857142857
6.38
22.400000000000002
8.506666666666666
193.34666666666666
72.98666666666666
129.00000000000003
129.00000000000003
225.0
176.99999999999997
514.8
370.0
422.49999999999994
370.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1800.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
1548.0
Query:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
IMPORTED WHISKIES,,,122.63999999999999
SINGLE MALT SCOTCH,57.159890014759014,60.72217496121817,60.885541103295026
IMPORTED BRANDIES,43.539679243138124,44.21087367006222,48.25868371964301
DISTILLED SPIRITS SPECIALTY,,41.00539396078036,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,39.257406586383894,43.45435421500387,45.24511724094048
MEZCAL,39.296838028169,39.042442028220556,43.158010069888036
CORN WHISKIES,36.55578155302148,43.98408575207072,43.02096702013815
STRAIGHT RYE WHISKIES,37.41571349811189,39.8924648878291,41.68364286878292
100% AGAVE TEQUILA,34.867184567514734,34.80330108401572,38.69034896983405
AMERICAN WHISKIES,,,38.0
Query:
SELECT
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") IN (2019, 2020, 2021)
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
LIMIT 100
Answer:
category_name,year,avg_price_per_liter
BLENDED WHISKIES,2020,14.177418874399706
WHITE RUM,2020,10.96025669966576
CORN WHISKIES,2019,36.55578155302149
AMERICAN SLOE GINS,2020,8.129999999999999
CREAM LIQUEURS,2019,21.44355441784797
COCKTAILS/RTD,2021,7.880040524815437
TENNESSEE WHISKIES,2021,30.944507216899385
STRAIGHT BOURBON WHISKIES,2021,25.708189191588918
GOLD RUM,2019,10.931024921954135
SCOTCH WHISKIES,2020,22.536057276324247
,2020,31.715929606403066
IMPORTED SCHNAPPS,2020,19.25455518897708
MEZCAL,2020,39.042442028220556
NEUTRAL GRAIN SPIRITS,2021,16.932047486820057
SINGLE BARREL BOURBON WHISKIES,2019,39.25740658638387
AGED DARK RUM,2020,23.969268299585405
IMPORTED DISTILLED SPIRITS SPECIALTY,2019,7.889528762164675
IMPORTED CORDIALS & LIQUEURS,2019,28.179161606842875
WHITE RUM,2021,10.964751984850396
AMERICAN DRY GINS,2021,10.659231884796094
TEMPORARY & SPECIALTY PACKAGES,2019,24.798664411728595
IMPORTED SCHNAPPS,2021,18.97755558290701
AMERICAN FLAVORED VODKA,2021,14.778221731089833
STRAIGHT RYE WHISKIES,2019,37.41571349811187
IMPORTED DISTILLED SPIRITS SPECIALTY,2020,8.222786847461908
AMERICAN VODKAS,2019,9.905176669185826
IMPORTED BRANDIES,2019,43.5396792431381
NEUTRAL GRAIN SPIRITS FLAVORED,2019,24.61978696763349
AMERICAN SLOE GINS,2021,8.13
COFFEE LIQUEURS,2019,21.073586682369253
BLENDED WHISKIES,2021,14.897984445558048
CREAM LIQUEURS,2020,22.74229432562278
AMERICAN DISTILLED SPIRITS SPECIALTY,2021,26.87902336877481
IMPORTED DISTILLED SPIRITS SPECIALTY,2021,8.292291652766425
AMERICAN SLOE GINS,2019,8.532092414995638
DELISTED / SPECIAL ORDER ITEMS,2020,37.0
IMPORTED CORDIALS & LIQUEURS,2021,30.810659844510454
NEUTRAL GRAIN SPIRITS FLAVORED,2021,26.749903417553693
MIXTO TEQUILA,2019,15.982155240059043
IRISH WHISKIES,2021,30.614299490641265
COFFEE LIQUEURS,2020,20.975750359383504
SPECIAL ORDER ITEMS,2019,11.334678132799594
COCKTAILS/RTD,2020,7.201814574552643
BOTTLED IN BOND BOURBON,2020,29.575726763855577
IMPORTED BRANDIES,2021,48.25868371964299
AMERICAN BRANDIES,2020,12.511142937266243
AGED DARK RUM,2019,22.56380861714703
SINGLE BARREL BOURBON WHISKIES,2021,45.24511724094046
IOWA DISTILLERY WHISKIES,2020,33.65622857142857
AMERICAN DISTILLED SPIRITS SPECIALTY,2020,26.451632087413714
AMERICAN DISTILLED SPIRITS SPECIALTY,2019,22.98135734079461
SCOTCH WHISKIES,2021,24.254713885217733
SINGLE MALT SCOTCH,2020,60.72217496121819
IMPORTED DRY GINS,2020,25.539127017730873
IMPORTED BRANDIES,2020,44.21087367006221
AMERICAN DRY GINS,2019,9.715900992663787
AMERICAN CORDIALS & LIQUEURS,2019,13.819081248522725
MIXTO TEQUILA,2021,16.694858792850695
FLAVORED RUM,2021,15.466602183579408
AMERICAN SCHNAPPS,2019,11.267867973133919
IMPORTED VODKAS,2020,16.91434492538817
,2019,23.2675189885877
SPICED RUM,2020,15.345321660461218
IMPORTED FLAVORED VODKA,2021,21.643416192740208
AGED DARK RUM,2021,25.43500018956807
NEUTRAL GRAIN SPIRITS,2020,15.882001897018913
IMPORTED GINS,2020,29.506666666666668
CANADIAN WHISKIES,2019,14.84482315325853
IMPORTED WHISKIES,2021,122.63999999999999
NEUTRAL GRAIN SPIRITS FLAVORED,2020,25.30305574003429
CORN WHISKIES,2021,43.02096702013815
WHISKEY LIQUEUR,2021,21.373583265167557
IMPORTED FLAVORED VODKA,2019,22.495889756550486
GOLD RUM,2021,11.544855683553058
IMPORTED CORDIALS & LIQUEURS,2020,30.195326536840906
WHISKEY LIQUEUR,2019,17.796682261535523
AMERICAN FLAVORED VODKA,2020,14.375297199122388
AMERICAN BRANDIES,2021,12.525057326504214
IOWA DISTILLERY WHISKIES,2019,44.98412584912404
TRIPLE SEC,2021,4.062804851178786
AMERICAN WHISKIES,2021,38.0
IMPORTED VODKAS,2021,17.849199227160092
SPICED RUM,2019,15.426264276542774
SPICED RUM,2021,15.600406892036023
COFFEE LIQUEURS,2021,22.12936739067009
FLAVORED RUM,2020,15.203710631474598
CANADIAN WHISKIES,2020,14.94513165507262
AMERICAN BRANDIES,2019,12.354296281418295
AMERICAN SCHNAPPS,2021,12.486547580045759
IMPORTED VODKAS,2019,17.85776777617917
FLAVORED RUM,2019,15.046644580058299
DISTILLED SPIRITS SPECIALTY,2020,41.005393960780346
AMERICAN CORDIALS & LIQUEURS,2020,15.93246725400037
AMERICAN SCHNAPPS,2020,12.309911189230476
100% AGAVE TEQUILA,2021,38.69034896983403
AMERICAN VODKAS,2021,10.78346746910011
STRAIGHT RYE WHISKIES,2021,41.68364286878291
FLAVORED GIN,2020,17.051308140589732
TENNESSEE WHISKIES,2019,29.831194441458898
IRISH WHISKIES,2020,30.626024569553675
Query:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING 
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10;
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
SINGLE MALT SCOTCH,57.15989001475901,60.72217496121816,60.88554110329504
IMPORTED BRANDIES,43.539679243138124,44.21087367006222,48.25868371964301
SINGLE BARREL BOURBON WHISKIES,39.257406586383894,43.45435421500387,45.24511724094047
MEZCAL,39.296838028169006,39.04244202822056,43.15801006988803
CORN WHISKIES,36.55578155302148,43.98408575207072,43.02096702013816
STRAIGHT RYE WHISKIES,37.415713498111884,39.8924648878291,41.683642868782904
100% AGAVE TEQUILA,34.86718456751472,34.80330108401573,38.690348969834034
BOTTLED IN BOND BOURBON,28.07891726027397,29.57572676385557,31.346506181752545
TENNESSEE WHISKIES,29.831194441458887,30.668740810584907,30.944507216899385
IMPORTED CORDIALS & LIQUEURS,28.179161606842865,30.195326536840906,30.810659844510468
Query:
SELECT "date", "category_name", "sale_dollars", "volume_sold_liters"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021 AND "category_name" IN ('IMPORTED WHISKIES', 'SINGLE MALT SCOTCH')
LIMIT 100
Answer:
date,category_name,sale_dollars,volume_sold_liters
2021-10-12,SINGLE MALT SCOTCH,39.96,0.75
2021-04-20,SINGLE MALT SCOTCH,41.22,0.75
2021-07-15,SINGLE MALT SCOTCH,68.99,0.75
2021-07-07,SINGLE MALT SCOTCH,44.99,0.75
2021-03-03,SINGLE MALT SCOTCH,42.74,0.75
2021-06-07,SINGLE MALT SCOTCH,42.74,0.75
2021-04-14,SINGLE MALT SCOTCH,66.0,0.75
2021-04-08,SINGLE MALT SCOTCH,66.0,0.75
2021-03-19,SINGLE MALT SCOTCH,97.5,0.75
2021-10-05,SINGLE MALT SCOTCH,51.75,0.75
2021-04-21,SINGLE MALT SCOTCH,60.0,0.75
2021-04-15,SINGLE MALT SCOTCH,39.0,0.75
2021-12-06,SINGLE MALT SCOTCH,54.75,0.75
2021-05-05,SINGLE MALT SCOTCH,54.75,0.75
2021-06-14,SINGLE MALT SCOTCH,54.75,0.75
2021-06-18,SINGLE MALT SCOTCH,38.97,0.75
2021-02-12,SINGLE MALT SCOTCH,38.97,0.75
2021-01-27,SINGLE MALT SCOTCH,97.44,0.75
2021-07-29,SINGLE MALT SCOTCH,54.72,0.75
2021-05-06,SINGLE MALT SCOTCH,41.34,0.75
2021-01-21,SINGLE MALT SCOTCH,75.0,0.75
2021-06-21,SINGLE MALT SCOTCH,60.02,0.75
2021-08-26,SINGLE MALT SCOTCH,30.0,0.75
2021-09-21,SINGLE MALT SCOTCH,60.0,0.75
2021-04-09,SINGLE MALT SCOTCH,41.22,0.75
2021-03-26,SINGLE MALT SCOTCH,90.0,0.75
2021-08-19,SINGLE MALT SCOTCH,89.52,1.5
2021-05-05,SINGLE MALT SCOTCH,82.44,1.5
2021-12-01,SINGLE MALT SCOTCH,137.98,1.5
2021-08-11,SINGLE MALT SCOTCH,89.98,1.5
2021-05-11,SINGLE MALT SCOTCH,89.98,1.5
2021-03-29,SINGLE MALT SCOTCH,105.0,1.5
2021-08-11,SINGLE MALT SCOTCH,78.0,1.5
2021-01-21,SINGLE MALT SCOTCH,109.5,1.5
2021-07-28,SINGLE MALT SCOTCH,109.44,1.5
2021-03-26,SINGLE MALT SCOTCH,109.44,1.5
2021-04-15,SINGLE MALT SCOTCH,74.98,1.5
2021-04-06,SINGLE MALT SCOTCH,74.98,1.5
2021-11-05,SINGLE MALT SCOTCH,62.98,1.5
2021-11-24,SINGLE MALT SCOTCH,62.94,1.5
2021-12-30,SINGLE MALT SCOTCH,62.94,1.5
2021-01-20,SINGLE MALT SCOTCH,150.0,1.5
2021-08-17,SINGLE MALT SCOTCH,88.5,1.5
2021-06-29,SINGLE MALT SCOTCH,88.5,1.5
2021-07-27,SINGLE MALT SCOTCH,120.04,1.5
2021-10-18,SINGLE MALT SCOTCH,120.04,1.5
2021-10-29,SINGLE MALT SCOTCH,120.04,1.5
2021-07-27,SINGLE MALT SCOTCH,120.04,1.5
2021-07-09,SINGLE MALT SCOTCH,102.0,1.5
2021-11-09,SINGLE MALT SCOTCH,82.44,1.5
2021-01-12,SINGLE MALT SCOTCH,62.98,1.5
2021-08-16,SINGLE MALT SCOTCH,62.98,1.5
2021-12-16,SINGLE MALT SCOTCH,60.0,1.5
2021-01-20,SINGLE MALT SCOTCH,225.0,2.25
2021-10-04,SINGLE MALT SCOTCH,44.98,0.2
2021-08-10,SINGLE MALT SCOTCH,44.99,0.75
2021-09-22,SINGLE MALT SCOTCH,44.99,0.75
2021-11-09,SINGLE MALT SCOTCH,33.74,0.75
2021-12-17,SINGLE MALT SCOTCH,52.5,0.75
2021-05-03,SINGLE MALT SCOTCH,97.5,0.75
2021-04-01,SINGLE MALT SCOTCH,52.5,0.75
2021-05-22,SINGLE MALT SCOTCH,52.5,0.75
2021-04-27,SINGLE MALT SCOTCH,39.0,0.75
2021-09-14,SINGLE MALT SCOTCH,54.75,0.75
2021-07-29,SINGLE MALT SCOTCH,54.72,0.75
2021-12-09,SINGLE MALT SCOTCH,37.49,0.75
2021-08-17,SINGLE MALT SCOTCH,52.49,0.75
2021-07-06,SINGLE MALT SCOTCH,74.99,0.75
2021-04-06,SINGLE MALT SCOTCH,82.5,0.75
2021-08-25,SINGLE MALT SCOTCH,82.5,0.75
2021-04-12,SINGLE MALT SCOTCH,82.5,0.75
2021-08-16,SINGLE MALT SCOTCH,41.34,0.75
2021-05-13,SINGLE MALT SCOTCH,40.5,0.75
2021-09-17,SINGLE MALT SCOTCH,44.25,0.75
2021-10-01,SINGLE MALT SCOTCH,44.25,0.75
2021-10-20,SINGLE MALT SCOTCH,44.25,0.75
2021-06-17,SINGLE MALT SCOTCH,60.02,0.75
2021-09-22,SINGLE MALT SCOTCH,30.0,0.75
2021-11-10,SINGLE MALT SCOTCH,30.0,0.75
2021-12-08,SINGLE MALT SCOTCH,30.0,0.75
2021-06-22,SINGLE MALT SCOTCH,60.0,0.75
2021-03-29,SINGLE MALT SCOTCH,41.22,0.75
2021-12-30,SINGLE MALT SCOTCH,33.0,0.75
2021-04-22,SINGLE MALT SCOTCH,134.94,0.6
2021-07-07,SINGLE MALT SCOTCH,44.76,0.75
2021-03-19,SINGLE MALT SCOTCH,134.94,0.6
2021-12-17,SINGLE MALT SCOTCH,48.0,0.75
2021-12-06,SINGLE MALT SCOTCH,67.47,0.3
2021-11-10,SINGLE MALT SCOTCH,134.96,3.0
2021-04-07,SINGLE MALT SCOTCH,240.0,3.0
2021-01-25,SINGLE MALT SCOTCH,155.88,3.0
2021-11-18,SINGLE MALT SCOTCH,155.88,3.0
2021-10-01,SINGLE MALT SCOTCH,120.0,3.0
2021-11-09,SINGLE MALT SCOTCH,120.0,3.0
2021-02-10,SINGLE MALT SCOTCH,120.0,3.0
2021-05-12,SINGLE MALT SCOTCH,240.0,3.0
2021-04-26,SINGLE MALT SCOTCH,44.98,0.2
2021-10-01,SINGLE MALT SCOTCH,44.98,0.2
2021-11-08,SINGLE MALT SCOTCH,240.0,3.0
2021-04-28,SINGLE MALT SCOTCH,155.88,3.0
Query:
SELECT
  "category_name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" ELSE 0 END), 0) AS "avg_price_per_liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" ELSE 0 END), 0) AS "avg_price_per_liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END), 0) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name"
HAVING 
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2019,avg_price_per_liter_2020,avg_price_per_liter_2021
SINGLE MALT SCOTCH,57.15989001475902,60.72217496121817,60.885541103295026
IMPORTED BRANDIES,43.53967924313812,44.21087367006222,48.25868371964298
SINGLE BARREL BOURBON WHISKIES,39.25740658638388,43.45435421500387,45.24511724094047
MEZCAL,39.29683802816901,39.04244202822056,43.158010069888036
CORN WHISKIES,36.55578155302149,43.98408575207072,43.02096702013814
STRAIGHT RYE WHISKIES,37.41571349811188,39.8924648878291,41.68364286878291
100% AGAVE TEQUILA,34.86718456751473,34.80330108401572,38.69034896983402
BOTTLED IN BOND BOURBON,28.078917260273965,29.575726763855577,31.34650618175255
TENNESSEE WHISKIES,29.83119444145888,30.668740810584918,30.94450721689939
IMPORTED CORDIALS & LIQUEURS,28.17916160684286,30.195326536840906,30.81065984451047
Query:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
HAVING SUM("volume_sold_liters") > 0
LIMIT 100
Answer:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
IMPORTED FLAVORED VODKA,21.64341619274023
NEUTRAL GRAIN SPIRITS FLAVORED,26.74990341755368
100% AGAVE TEQUILA,38.69034896983404
SCOTCH WHISKIES,24.254713885217747
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
COFFEE LIQUEURS,22.129367390670097
COCKTAILS/RTD,7.880040524815437
IMPORTED GINS,29.506666666666664
AMERICAN FLAVORED VODKA,14.778221731089836
CREAM LIQUEURS,23.566367164593295
IRISH WHISKIES,30.61429949064126
TENNESSEE WHISKIES,30.9445072168994
AGED DARK RUM,25.435000189568065
SPECIAL ORDER ITEMS,12.1588314839517
IMPORTED DRY GINS,25.64094711101976
IMPORTED VODKAS,17.84919922716009
IMPORTED SCHNAPPS,18.977555582907012
FLAVORED RUM,15.466602183579413
IMPORTED CORDIALS & LIQUEURS,30.81065984451046
WHISKEY LIQUEUR,21.373583265167575
BOTTLED IN BOND BOURBON,31.346506181752556
SINGLE MALT SCOTCH,60.885541103295026
FLAVORED GIN,28.50851935248073
IMPORTED DISTILLED SPIRITS SPECIALTY,8.292291652766425
TRIPLE SEC,4.062804851178789
MEZCAL,43.158010069888036
AMERICAN WHISKIES,38.0
GOLD RUM,11.544855683553058
MIXTO TEQUILA,16.69485879285069
IMPORTED BRANDIES,48.25868371964299
SPICED RUM,15.600406892036025
AMERICAN DISTILLED SPIRITS SPECIALTY,26.879023368774817
CORN WHISKIES,43.020967020138144
AMERICAN DRY GINS,10.659231884796098
WHITE RUM,10.9647519848504
BLENDED WHISKIES,14.897984445558052
AMERICAN SCHNAPPS,12.486547580045764
CANADIAN WHISKIES,15.646681889219572
AMERICAN BRANDIES,12.525057326504214
STRAIGHT BOURBON WHISKIES,25.708189191588932
STRAIGHT RYE WHISKIES,41.68364286878292
NEUTRAL GRAIN SPIRITS,16.932047486820053
DISTILLED SPIRITS SPECIALTY,46.666666666666664
TEMPORARY & SPECIALTY PACKAGES,29.72194214877965
AMERICAN VODKAS,10.783467469100108
AMERICAN CORDIALS & LIQUEURS,17.00342084915327
AMERICAN SLOE GINS,8.13
Query:
SELECT "category_name", (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
HAVING SUM("volume_sold_liters") > 0
ORDER BY "avg_price_per_liter_2021" DESC
LIMIT 10
Answer:
category_name,avg_price_per_liter_2021
IMPORTED WHISKIES,122.63999999999999
SINGLE MALT SCOTCH,60.885541103295026
IMPORTED BRANDIES,48.25868371964299
DISTILLED SPIRITS SPECIALTY,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,45.24511724094047
MEZCAL,43.15801006988803
CORN WHISKIES,43.020967020138144
STRAIGHT RYE WHISKIES,41.68364286878292
100% AGAVE TEQUILA,38.69034896983403
AMERICAN WHISKIES,38.0
Query:
SELECT 
  "category_name",
  EXTRACT(YEAR FROM "date") AS "year",
  (SUM("sale_dollars") / NULLIF(SUM("volume_sold_liters"), 0)) AS "avg_price_per_liter"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY "category_name", EXTRACT(YEAR FROM "date")
HAVING SUM("volume_sold_liters") > 0
LIMIT 100
Answer:
category_name,year,avg_price_per_liter
AMERICAN SCHNAPPS,2024,17.34836387727188
STRAIGHT BOURBON WHISKIES,2021,25.708189191588925
GOLD RUM,2019,10.931024921954133
SCOTCH WHISKIES,2020,22.53605727632424
BUTTERSCOTCH SCHNAPPS,2012,10.948664507997545
,2020,31.715929606403066
BUTTERSCOTCH SCHNAPPS,2016,11.66665185482822
BUTTERSCOTCH SCHNAPPS,2013,11.170515586673337
APPLE SCHNAPPS,2016,11.90626681428277
AMARETTO - IMPORTED,2015,62.26666666666667
ROCK & RYE,2012,9.857591397849463
HOLIDAY VAP,2017,41.31619047619048
SINGLE MALT SCOTCH,2015,54.3714983979572
IRISH WHISKIES,2020,30.62602456955369
COFFEE LIQUEURS,2018,20.702533921725408
TEMPORARY & SPECIALTY PACKAGES,2022,33.77457355123664
LOW PROOF VODKA,2012,21.810228721409818
WHITE CREME DE MENTHE,2013,9.283652627655608
AGED DARK RUM,2022,26.882500000000007
JAMAICA RUM,2016,19.455806993283286
CORN WHISKIES,2020,43.98408575207071
BARBADOS RUM,2012,18.47513359580727
SPEARMINT SCHNAPPS,2013,7.134429245283017
BLENDED WHISKIES,2020,14.1774188743997
AMERICAN FLAVORED VODKA,2022,15.520813901491099
WHITE RUM,2020,10.960256699665758
TEQUILA,2013,19.879169648026245
IMPORTED GRAPE BRANDIES,2016,41.03892168324284
PEPPERMINT SCHNAPPS,2012,7.311381155340737
CORN WHISKIES,2019,36.55578155302149
NEUTRAL GRAIN SPIRITS FLAVORED,2017,22.843756076759075
WHITE CREME DE CACAO,2015,9.386352548036758
AMERICAN SLOE GINS,2020,8.13
SINGLE MALT SCOTCH,2019,57.15989001475903
CANADIAN WHISKIES,2014,12.663644965810416
WHISKEY LIQUEUR,2023,24.144916932410457
TEQUILA,2012,19.478480900389044
AMERICAN CORDIALS & LIQUEURS,2023,22.911948113925508
STRAIGHT BOURBON WHISKIES,2012,15.696971197200488
PEPPERMINT SCHNAPPS,2013,7.314749489688745
BLENDED WHISKIES,2024,16.521967215298893
AMERICAN VODKAS,2020,10.37159267048766
IMPORTED DRY GINS,2016,24.310851311543
NEUTRAL GRAIN SPIRITS,2019,17.01644187052472
OTHER PROOF VODKA,2014,15.951264367816087
IMPORTED VODKA - CHERRY,2012,10.58
SPICED RUM,2020,15.345321660461218
100% AGAVE TEQUILA,2022,41.452877615661514
CANADIAN WHISKIES,2015,13.3967104401965
TENNESSEE WHISKIES,2012,25.40717411213621
MIXTO TEQUILA,2016,14.936155105203472
VODKA FLAVORED,2012,13.238240431821776
,2013,23.331493807737303
AMERICAN AMARETTO,2012,6.794743495020151
SPICED RUM,2024,16.24313168757013
BLENDED WHISKIES,2021,14.89798444555805
WHISKEY LIQUEUR,2024,25.303055581248
SCOTCH WHISKIES,2023,28.160736223082385
COFFEE LIQUEURS,2019,21.073586682369246
COCKTAILS/RTD,2018,7.089324865709722
IMPORTED DRY GINS,2014,23.612526634318638
VODKA 80 PROOF,2014,8.242535918819701
IMPORTED SCHNAPPS,2016,18.832618113770007
COFFEE LIQUEURS,2013,20.125561842958174
IMPORTED SCHNAPPS,2018,18.662637908157507
FLAVORED GINS,2016,13.104106880427517
BARBADOS RUM,2016,21.786758318390124
CANADIAN WHISKIES,2016,13.709439291625898
CINNAMON SCHNAPPS,2013,13.079283907955492
DISTILLED SPIRITS SPECIALTY,2012,9.684964606366012
PEACH SCHNAPPS,2013,10.797307206447044
AMERICAN COCKTAILS,2012,7.38121742978146
TENNESSEE WHISKIES,2020,30.66874081058491
AMERICAN DRY GINS,2024,11.566942328695319
TENNESSEE WHISKIES,2015,27.75578919109842
FLAVORED GIN,2024,34.349130018733916
BOTTLED IN BOND BOURBON,2012,42.24324829931972
FLAVORED GINS,2014,13.629728839393268
JAMAICA RUM,2012,17.780149318713217
IMPORTED AMARETTO,2013,26.89424454161594
WHITE CREME DE CACAO,2012,8.63146939077652
AMERICAN BRANDIES,2018,12.186265716396484
SCOTCH WHISKIES,2017,20.67654351421518
BLACKBERRY BRANDIES,2016,10.053921479768114
AMERICAN COCKTAILS,2013,7.181760294774377
WHISKEY LIQUEUR,2016,16.913044328979495
CREAM LIQUEURS,2012,22.48481989251298
CANADIAN WHISKIES,2012,12.284271022200707
AMERICAN SCHNAPPS,2018,10.76967230639107
PEACH SCHNAPPS,2012,10.551954702671644
IMPORTED VODKAS,2024,15.990142307439395
SPICED RUM,2013,15.200857166001235
AMERICAN DRY GINS,2014,9.000491027649897
STRAIGHT RYE WHISKIES,2024,39.45457844585347
COCKTAILS/RTD,2019,7.0314818841174995
DISTILLED SPIRITS SPECIALTY,2016,9.47208150533898
STRAIGHT BOURBON WHISKIES,2015,18.958994878380427
AMERICAN SLOE GINS,2012,7.179830890226341
CHERRY BRANDIES,2015,10.995459033980364
RASPBERRY SCHNAPPS,2013,9.766518976852108
Query:
SELECT "category_name", SUM("sale_dollars") AS "total_sales_2021"
FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
WHERE EXTRACT(YEAR FROM "date") = 2021
GROUP BY "category_name"
HAVING SUM("sale_dollars") IS NOT NULL
LIMIT 100
Answer:
category_name,total_sales_2021
IMPORTED WHISKIES,5518.799999999999
IRISH WHISKIES,9238465.830000002
TENNESSEE WHISKIES,16276000.05
100% AGAVE TEQUILA,23915928.88999999
SCOTCH WHISKIES,5719870.57
SINGLE BARREL BOURBON WHISKIES,1066574.46
IMPORTED SCHNAPPS,6637742.610000001
COCKTAILS/RTD,8692059.71
IMPORTED GINS,3186.72
WHISKEY LIQUEUR,24665650.71
SINGLE MALT SCOTCH,4454879.36
BOTTLED IN BOND BOURBON,694701.2699999999
COFFEE LIQUEURS,2126049.54
IMPORTED FLAVORED VODKA,5785184.289999999
NEUTRAL GRAIN SPIRITS FLAVORED,1570388.3900000001
AMERICAN FLAVORED VODKA,10537284.849999996
FLAVORED GIN,388056.5400000001
AMERICAN SCHNAPPS,6561224.369999998
BLENDED WHISKIES,12635514.849999996
MEZCAL,430727.72999999986
IMPORTED BRANDIES,15995277.500000002
AMERICAN VODKAS,61440411.24
IMPORTED DISTILLED SPIRITS SPECIALTY,2198562.07
TRIPLE SEC,848208.0200000001
NEUTRAL GRAIN SPIRITS,642212.9200000002
DISTILLED SPIRITS SPECIALTY,28070.0
SPECIAL ORDER ITEMS,1523594.5999999999
AGED DARK RUM,1073387.5299999998
MIXTO TEQUILA,10668562.360000001
SPICED RUM,23123177.07
AMERICAN DISTILLED SPIRITS SPECIALTY,1497977.3799999997
CORN WHISKIES,442212.51999999996
AMERICAN CORDIALS & LIQUEURS,4293640.069999999
AMERICAN SLOE GINS,31666.350000000002
GOLD RUM,1162585.6700000002
TEMPORARY & SPECIALTY PACKAGES,10174030.04
CREAM LIQUEURS,8860918.940000003
IMPORTED DRY GINS,5602434.38
IMPORTED VODKAS,14556785.38
IMPORTED CORDIALS & LIQUEURS,11206838.639999999
FLAVORED RUM,9023511.589999998
AMERICAN WHISKIES,1881.0
CANADIAN WHISKIES,47392655.67
AMERICAN BRANDIES,5216033.320000001
AMERICAN DRY GINS,3712780.799999999
WHITE RUM,6709359.589999999
STRAIGHT BOURBON WHISKIES,34498254.830000006
STRAIGHT RYE WHISKIES,4793496.380000001
End Exploring Related Columns
Task: Identify the top 10 liquor categories in Iowa by average price per liter in 2021, and provide their average prices per liter for 2019, 2020, and 2021.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Here are the top 10 liquor categories in Iowa ranked by their average price per liter in 2021, along with their average prices per liter for 2019, 2020, and 2021.

```csv
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
category1:str,price2019:float,price2020:float,price2021:float
category2:str,price2019:float,price2020:float,price2021:float
category3:str,price2019:float,price2020:float,price2021:float
category4:str,price2019:float,price2020:float,price2021:float
category5:str,price2019:float,price2020:float,price2021:float
category6:str,price2019:float,price2020:float,price2021:float
category7:str,price2019:float,price2020:float,price2021:float
category8:str,price2019:float,price2020:float,price2021:float
category9:str,price2019:float,price2020:float,price2021:float
category10:str,price2019:float,price2020:float,price2021:float
(Attention: answer in 10 rows)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 00:16:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:16:08 - root - INFO - ```sql
SELECT
  "category_name" AS "Category_Name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" ELSE 0 END), 0) AS "Avg_Price_Per_Liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" ELSE 0 END), 0) AS "Avg_Price_Per_Liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END), 0) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC
LIMIT 10;
```
2025-01-26 00:16:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:16:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:16:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:16:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:16:10 - snowflake.connector.connection - INFO - closed
2025-01-26 00:16:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:16:10 - root - INFO - itercount: 1
2025-01-26 00:16:10 - root - INFO - 0
2025-01-26 00:16:10 - root - INFO - results: 
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
IMPORTED WHISKIES,,,122.63999999999999
SINGLE MALT SCOTCH,57.15989001475901,60.72217496121817,60.885541103295054
IMPORTED BRANDIES,43.53967924313812,44.21087367006221,48.258683719642995
DISTILLED SPIRITS SPECIALTY,,41.00539396078036,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,39.25740658638388,43.45435421500387,45.24511724094047
MEZCAL,39.296838028169006,39.042442028220556,43.158010069888036
CORN WHISKIES,36.55578155302148,43.984085752070726,43.02096702013815
STRAIGHT RYE WHISKIES,37.41571349811187,39.89246488782909,41.68364286878292
100% AGAVE TEQUILA,34.86718456751474,34.80330108401572,38.690348969834034
AMERICAN WHISKIES,,,38.0


2025-01-26 00:16:10 - root - INFO - Please check the answer again by reviewing Identify the top 10 liquor categories in Iowa by average price per liter in 2021, and provide their average prices per liter for 2019, 2020, and 2021., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Here are the top 10 liquor categories in Iowa ranked by their average price per liter in 2021, along with their average prices per liter for 2019, 2020, and 2021.

```csv
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
category1:str,price2019:float,price2020:float,price2021:float
category2:str,price2019:float,price2020:float,price2021:float
category3:str,price2019:float,price2020:float,price2021:float
category4:str,price2019:float,price2020:float,price2021:float
category5:str,price2019:float,price2020:float,price2021:float
category6:str,price2019:float,price2020:float,price2021:float
category7:str,price2019:float,price2020:float,price2021:float
category8:str,price2019:float,price2020:float,price2021:float
category9:str,price2019:float,price2020:float,price2021:float
category10:str,price2019:float,price2020:float,price2021:float
(Attention: answer in 10 rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
IMPORTED WHISKIES,,,122.63999999999999
SINGLE MALT SCOTCH,57.15989001475901,60.72217496121817,60.885541103295054
IMPORTED BRANDIES,43.53967924313812,44.21087367006221,48.258683719642995
DISTILLED SPIRITS SPECIALTY,,41.00539396078036,46.666666666666664
SINGLE BARREL BOURBON WHISKIES,39.25740658638388,43.45435421500387,45.24511724094047
MEZCAL,39.296838028169006,39.042442028220556,43.158010069888036
CORN WHISKIES,36.55578155302148,43.984085752070726,43.02096702013815
STRAIGHT RYE WHISKIES,37.41571349811187,39.89246488782909,41.68364286878292
100% AGAVE TEQUILA,34.86718456751474,34.80330108401572,38.690348969834034
AMERICAN WHISKIES,,,38.0
Current sql:
SELECT
  "category_name" AS "Category_Name",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" ELSE 0 END), 0) AS "Avg_Price_Per_Liter_2019",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" ELSE 0 END), 0) AS "Avg_Price_Per_Liter_2020",
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END), 0) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC
LIMIT 10;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-26 00:16:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:16:53 - root - INFO - Here are the top 10 liquor categories in Iowa ranked by their average price per liter in 2021, along with their average prices per liter for 2019, 2020, and 2021.

```sql
SELECT
  "category_name" AS "Category_Name",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" ELSE 0 END), 0), 4) AS "Avg_Price_Per_Liter_2019",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" ELSE 0 END), 0), 4) AS "Avg_Price_Per_Liter_2020",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END), 0), 4) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC NULLS LAST
LIMIT 10;
```

```csv
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
IMPORTED WHISKIES,,,"122.6400"
SINGLE MALT SCOTCH,"57.1599","60.7222","60.8855"
IMPORTED BRANDIES,"43.5397","44.2109","48.2587"
DISTILLED SPIRITS SPECIALTY,,"41.0054","46.6667"
SINGLE BARREL BOURBON WHISKIES,"39.2574","43.4544","45.2451"
MEZCAL,"39.2968","39.0424","43.1580"
CORN WHISKIES,"36.5558","43.9841","43.0210"
STRAIGHT RYE WHISKIES,"37.4157","39.8925","41.6836"
100% AGAVE TEQUILA,"34.8672","34.8033","38.6903"
AMERICAN WHISKIES,,,"38.0000"
```
2025-01-26 00:16:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:16:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:16:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:16:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:16:55 - snowflake.connector.connection - INFO - closed
2025-01-26 00:16:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:16:55 - root - INFO - itercount: 2
2025-01-26 00:16:55 - root - INFO - 0
2025-01-26 00:16:55 - root - INFO - results: 
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
IMPORTED WHISKIES,,,122.64
SINGLE MALT SCOTCH,57.1599,60.7222,60.8855
IMPORTED BRANDIES,43.5397,44.2109,48.2587
DISTILLED SPIRITS SPECIALTY,,41.0054,46.6667
SINGLE BARREL BOURBON WHISKIES,39.2574,43.4544,45.2451
MEZCAL,39.2968,39.0424,43.158
CORN WHISKIES,36.5558,43.9841,43.021
STRAIGHT RYE WHISKIES,37.4157,39.8925,41.6836
100% AGAVE TEQUILA,34.8672,34.8033,38.6903
AMERICAN WHISKIES,,,38.0


2025-01-26 00:16:55 - root - INFO - Please check the answer again by reviewing Identify the top 10 liquor categories in Iowa by average price per liter in 2021, and provide their average prices per liter for 2019, 2020, and 2021., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Here are the top 10 liquor categories in Iowa ranked by their average price per liter in 2021, along with their average prices per liter for 2019, 2020, and 2021.

```csv
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
category1:str,price2019:float,price2020:float,price2021:float
category2:str,price2019:float,price2020:float,price2021:float
category3:str,price2019:float,price2020:float,price2021:float
category4:str,price2019:float,price2020:float,price2021:float
category5:str,price2019:float,price2020:float,price2021:float
category6:str,price2019:float,price2020:float,price2021:float
category7:str,price2019:float,price2020:float,price2021:float
category8:str,price2019:float,price2020:float,price2021:float
category9:str,price2019:float,price2020:float,price2021:float
category10:str,price2019:float,price2020:float,price2021:float
(Attention: answer in 10 rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
IMPORTED WHISKIES,,,122.64
SINGLE MALT SCOTCH,57.1599,60.7222,60.8855
IMPORTED BRANDIES,43.5397,44.2109,48.2587
DISTILLED SPIRITS SPECIALTY,,41.0054,46.6667
SINGLE BARREL BOURBON WHISKIES,39.2574,43.4544,45.2451
MEZCAL,39.2968,39.0424,43.158
CORN WHISKIES,36.5558,43.9841,43.021
STRAIGHT RYE WHISKIES,37.4157,39.8925,41.6836
100% AGAVE TEQUILA,34.8672,34.8033,38.6903
AMERICAN WHISKIES,,,38.0
Current sql:
SELECT
  "category_name" AS "Category_Name",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" ELSE 0 END), 0), 4) AS "Avg_Price_Per_Liter_2019",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" ELSE 0 END), 0), 4) AS "Avg_Price_Per_Liter_2020",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" ELSE 0 END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END), 0), 4) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" ELSE 0 END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC NULLS LAST
LIMIT 10;
2025-01-26 00:17:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:17:35 - root - INFO - Here are the top 10 liquor categories in Iowa ranked by their average price per liter in 2021, along with their average prices per liter for 2019, 2020, and 2021.

```sql
SELECT
  "category_name" AS "Category_Name",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2019",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2020",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC
LIMIT 10;
```

```csv
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
SINGLE MALT SCOTCH,57.1599,60.7222,60.8855
IMPORTED BRANDIES,43.5397,44.2109,48.2587
SINGLE BARREL BOURBON WHISKIES,39.2574,43.4544,45.2451
MEZCAL,39.2968,39.0424,43.1580
CORN WHISKIES,36.5558,43.9841,43.0210
STRAIGHT RYE WHISKIES,37.4157,39.8925,41.6836
100% AGAVE TEQUILA,34.8672,34.8033,38.6903
BOTTLED IN BOND BOURBON,28.0789,29.5757,31.3465
TENNESSEE WHISKIES,29.8312,30.6687,30.9445
IMPORTED CORDIALS & LIQUEURS,28.1792,30.1953,30.8107
```
2025-01-26 00:17:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:17:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:17:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:17:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:17:36 - snowflake.connector.connection - INFO - closed
2025-01-26 00:17:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:17:37 - root - INFO - itercount: 3
2025-01-26 00:17:37 - root - INFO - 0
2025-01-26 00:17:37 - root - INFO - results: 
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
SINGLE MALT SCOTCH,57.1599,60.7222,60.8855
IMPORTED BRANDIES,43.5397,44.2109,48.2587
SINGLE BARREL BOURBON WHISKIES,39.2574,43.4544,45.2451
MEZCAL,39.2968,39.0424,43.158
CORN WHISKIES,36.5558,43.9841,43.021
STRAIGHT RYE WHISKIES,37.4157,39.8925,41.6836
100% AGAVE TEQUILA,34.8672,34.8033,38.6903
BOTTLED IN BOND BOURBON,28.0789,29.5757,31.3465
TENNESSEE WHISKIES,29.8312,30.6687,30.9445
IMPORTED CORDIALS & LIQUEURS,28.1792,30.1953,30.8107


2025-01-26 00:17:37 - root - INFO - Please check the answer again by reviewing Identify the top 10 liquor categories in Iowa by average price per liter in 2021, and provide their average prices per liter for 2019, 2020, and 2021., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Here are the top 10 liquor categories in Iowa ranked by their average price per liter in 2021, along with their average prices per liter for 2019, 2020, and 2021.

```csv
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
category1:str,price2019:float,price2020:float,price2021:float
category2:str,price2019:float,price2020:float,price2021:float
category3:str,price2019:float,price2020:float,price2021:float
category4:str,price2019:float,price2020:float,price2021:float
category5:str,price2019:float,price2020:float,price2021:float
category6:str,price2019:float,price2020:float,price2021:float
category7:str,price2019:float,price2020:float,price2021:float
category8:str,price2019:float,price2020:float,price2021:float
category9:str,price2019:float,price2020:float,price2021:float
category10:str,price2019:float,price2020:float,price2021:float
(Attention: answer in 10 rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category_Name,Avg_Price_Per_Liter_2019,Avg_Price_Per_Liter_2020,Avg_Price_Per_Liter_2021
SINGLE MALT SCOTCH,57.1599,60.7222,60.8855
IMPORTED BRANDIES,43.5397,44.2109,48.2587
SINGLE BARREL BOURBON WHISKIES,39.2574,43.4544,45.2451
MEZCAL,39.2968,39.0424,43.158
CORN WHISKIES,36.5558,43.9841,43.021
STRAIGHT RYE WHISKIES,37.4157,39.8925,41.6836
100% AGAVE TEQUILA,34.8672,34.8033,38.6903
BOTTLED IN BOND BOURBON,28.0789,29.5757,31.3465
TENNESSEE WHISKIES,29.8312,30.6687,30.9445
IMPORTED CORDIALS & LIQUEURS,28.1792,30.1953,30.8107
Current sql:
SELECT
  "category_name" AS "Category_Name",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2019",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2020",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC
LIMIT 10;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-26 00:18:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 00:18:20 - root - INFO - ```sql
SELECT
  "category_name" AS "Category_Name",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2019",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2020",
  ROUND(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "sale_dollars" END) / NULLIF(SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END), 0), 4) AS "Avg_Price_Per_Liter_2021"
FROM
  IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
GROUP BY
  "category_name"
HAVING
  SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2019 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2020 THEN "volume_sold_liters" END) > 0
  AND SUM(CASE WHEN EXTRACT(YEAR FROM "date") = 2021 THEN "volume_sold_liters" END) > 0
ORDER BY
  "Avg_Price_Per_Liter_2021" DESC NULLS LAST
LIMIT 10;
```
2025-01-26 00:18:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 00:18:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 00:18:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 00:18:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 00:18:21 - snowflake.connector.connection - INFO - closed
2025-01-26 00:18:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 00:18:22 - root - INFO - itercount: 4
2025-01-26 00:18:22 - root - INFO - 0
2025-01-26 00:18:22 - root - INFO - Total iteration counts: 4
