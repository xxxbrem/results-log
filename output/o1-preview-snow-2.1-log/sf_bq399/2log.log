2025-01-20 13:17:21 - openai._base_client - INFO - Retrying request to /chat/completions in 0.493354 seconds
2025-01-20 13:18:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:18:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:18:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:18:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:18:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 13:18:54 - snowflake.connector.connection - INFO - closed
2025-01-20 13:18:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:18:54 - root - INFO - SQL:
-- 1. List all distinct income groups
SELECT DISTINCT "income_group"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000
Results:
income_group
""
High income
Low income
Upper middle income
Lower middle income

2025-01-20 13:18:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:18:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:18:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:18:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-01-20 13:18:55 - snowflake.connector.connection - INFO - closed
2025-01-20 13:18:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:18:56 - root - INFO - SQL:
-- 2. List all distinct regions
SELECT DISTINCT "region"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000
Results:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia

2025-01-20 13:18:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:18:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:18:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:18:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 80
2025-01-20 13:18:57 - snowflake.connector.connection - INFO - closed
2025-01-20 13:18:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:18:58 - root - INFO - SQL:
-- 3. Select high-income countries and their regions
SELECT "country_code", "short_name", "region"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
WHERE "income_group" = 'High income'
LIMIT 1000
Results:
country_code,short_name,region
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
NCL,New Caledonia,East Asia & Pacific
NRU,Nauru,East Asia & Pacific
NZL,New Zealand,East Asia & Pacific
PRI,Puerto Rico,Latin America & Caribbean
PYF,French Polynesia,East Asia & Pacific
SXM,Sint Maarten (Dutch part),Latin America & Caribbean
TCA,Turks and Caicos Islands,Latin America & Caribbean
VGB,British Virgin Islands,Latin America & Caribbean
VIR,Virgin Islands,Latin America & Caribbean
ABW,Aruba,Latin America & Caribbean
ARE,United Arab Emirates,Middle East & North Africa
ATG,Antigua and Barbuda,Latin America & Caribbean
BHR,Bahrain,Middle East & North Africa
BHS,The Bahamas,Latin America & Caribbean
BRB,Barbados,Latin America & Caribbean
BRN,Brunei,East Asia & Pacific
KNA,St. Kitts and Nevis,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MAC,"Macao SAR, China",East Asia & Pacific
OMN,Oman,Middle East & North Africa
PAN,Panama,Latin America & Caribbean
QAT,Qatar,Middle East & North Africa
SMR,San Marino,Europe & Central Asia
TTO,Trinidad and Tobago,Latin America & Caribbean
AUS,Australia,East Asia & Pacific
BEL,Belgium,Europe & Central Asia
CHE,Switzerland,Europe & Central Asia
CYP,Cyprus,Europe & Central Asia
EST,Estonia,Europe & Central Asia
GBR,United Kingdom,Europe & Central Asia
GRC,Greece,Europe & Central Asia
HKG,"Hong Kong SAR, China",East Asia & Pacific
HRV,Croatia,Europe & Central Asia
HUN,Hungary,Europe & Central Asia
IRL,Ireland,Europe & Central Asia
ISL,Iceland,Europe & Central Asia
ISR,Israel,Middle East & North Africa
KOR,Korea,East Asia & Pacific
MLT,Malta,Middle East & North Africa
NOR,Norway,Europe & Central Asia
POL,Poland,Europe & Central Asia
SAU,Saudi Arabia,Middle East & North Africa
SGP,Singapore,East Asia & Pacific
SYC,Seychelles,Sub-Saharan Africa
URY,Uruguay,Latin America & Caribbean
AUT,Austria,Europe & Central Asia
CAN,Canada,North America
CHL,Chile,Latin America & Caribbean
CZE,Czech Republic,Europe & Central Asia
DEU,Germany,Europe & Central Asia
DNK,Denmark,Europe & Central Asia
ESP,Spain,Europe & Central Asia
FIN,Finland,Europe & Central Asia
FRA,France,Europe & Central Asia
ITA,Italy,Europe & Central Asia
JPN,Japan,East Asia & Pacific
LTU,Lithuania,Europe & Central Asia
LUX,Luxembourg,Europe & Central Asia
LVA,Latvia,Europe & Central Asia
NLD,Netherlands,Europe & Central Asia
PRT,Portugal,Europe & Central Asia
ROU,Romania,Europe & Central Asia
SVK,Slovak Republic,Europe & Central Asia
SVN,Slovenia,Europe & Central Asia
SWE,Sweden,Europe & Central Asia
USA,United States,North America

2025-01-20 13:18:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:18:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:18:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:18:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 13:18:59 - snowflake.connector.connection - INFO - closed
2025-01-20 13:18:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:19:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:19:40 - root - INFO - ```sql
-- Corrected Query: Find indicator codes for indicators containing 'birth' in SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%birth%'
LIMIT 1000;
```
2025-01-20 13:19:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:19:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:19:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:19:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-20 13:19:42 - snowflake.connector.connection - INFO - closed
2025-01-20 13:19:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:21:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:21:00 - root - INFO - SQL:
-- Corrected Query: Find indicator codes for indicators containing 'birth' in SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%birth%'
LIMIT 1000;
Results:
series_code,indicator_name
SH.DYN.MORT,"Mortality rate, under-5 (per 1,000 live births)"
SH.DYN.MORT.FE,"Mortality rate, under-5, female (per 1,000 live births)"
SH.DYN.MORT.MA,"Mortality rate, under-5, male (per 1,000 live births)"
SH.DYN.NMRT,"Mortality rate, neonatal (per 1,000 live births)"
SH.STA.BRTC.ZS,Births attended by skilled health staff (% of total)
SH.STA.BRTW.ZS,Low-birthweight babies (% of births)
SH.STA.MMRT,"Maternal mortality ratio (modeled estimate, per 100,000 live births)"
SH.STA.MMRT.NE,"Maternal mortality ratio (national estimate, per 100,000 live births)"
SP.ADO.TFRT,"Adolescent fertility rate (births per 1,000 women ages 15-19)"
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
SP.DYN.IMRT.FE.IN,"Mortality rate, infant, female (per 1,000 live births)"
SP.DYN.IMRT.IN,"Mortality rate, infant (per 1,000 live births)"
SP.DYN.IMRT.MA.IN,"Mortality rate, infant, male (per 1,000 live births)"
SP.DYN.LE00.FE.IN,"Life expectancy at birth, female (years)"
SP.DYN.LE00.IN,"Life expectancy at birth, total (years)"
SP.DYN.LE00.MA.IN,"Life expectancy at birth, male (years)"
SP.DYN.TFRT.IN,"Fertility rate, total (births per woman)"
SP.DYN.WFRT,Wanted fertility rate (births per woman)
SP.POP.BRTH.MF,Sex ratio at birth (male births per female births)
SP.REG.BRTH.FE.ZS,"Completeness of birth registration, female (%)"
SP.REG.BRTH.MA.ZS,"Completeness of birth registration, male (%)"
SP.REG.BRTH.RU.ZS,"Completeness of birth registration, rural (%)"
SP.REG.BRTH.UR.ZS,"Completeness of birth registration, urban (%)"
SP.REG.BRTH.ZS,Completeness of birth registration (%)

2025-01-20 13:21:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:21:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:21:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:21:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 13:21:02 - snowflake.connector.connection - INFO - closed
2025-01-20 13:21:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:21:03 - root - INFO - SQL:
-- 5. Get distinct indicator codes where 'indicator_name' contains 'birth rate'
SELECT DISTINCT "indicator_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%birth rate%'
LIMIT 1000
Results:
indicator_code,indicator_name
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"

2025-01-20 13:21:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:21:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:21:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:21:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-20 13:21:04 - snowflake.connector.connection - INFO - closed
2025-01-20 13:21:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:21:05 - root - INFO - SQL:
-- 6. List all years between 1980 and 1989 in INDICATORS_DATA
SELECT DISTINCT "year"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "year" BETWEEN 1980 AND 1989
ORDER BY "year"
LIMIT 1000
Results:
year
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989

2025-01-20 13:21:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:21:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:21:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:21:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 13:21:06 - snowflake.connector.connection - INFO - closed
2025-01-20 13:21:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:21:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:21:58 - root - INFO - ```sql
SELECT "country_code", "indicator_code", "indicator_name", "year", "value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
LIMIT 1000;
```
2025-01-20 13:21:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:21:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:21:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:21:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:21:59 - snowflake.connector.connection - INFO - closed
2025-01-20 13:21:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:23:11 - root - INFO - SQL:
SELECT "country_code", "indicator_code", "indicator_name", "year", "value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
LIMIT 1000;
Results:
Too long, hard cut:
country_code,indicator_code,indicator_name,year,value
AZE,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,26.1
BHR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,32.122
KNA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,21.3
GEO,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,18.66
GRD,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,32.814
ISR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,23.7
ITA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,10.6
ITA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,10.1
ARE,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,29.537
VUT,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,37.843
PRK,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,21.19
MMR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,31.749
LDC,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,45.4862409097559
LTU,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,15.2
EAR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,34.8516947116678
WSM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,36.692
SYC,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,26.9
NGA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,45.375
PNG,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,37.428
TCD,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1982,49.954
CHN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,22.37
WLD,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,27.4871068047757
TMN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,36.0364618603991
FRO,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,15.4
FRO,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,18.4
FIN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1982,13.7
EMU,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1987,11.8582803023218
MWI,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,50.979
MDV,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,44.507
QAT,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,23.437
COG,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,39.38
HRV,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,12.8
CYP,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,19.62
SAS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,33.4974110618792
TON,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,34.329
BEN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,46.281
BIH,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,15.769
IRQ,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1982,39.24
ARE,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,30.343
USA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,15.6
VNM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,29.136
NIC,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,41.841
NER,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,55.799
BFA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,48.68
TLA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,32.6223652795471
LMY,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,30.722363924328
MEA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,40.8515238894317
LVA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,14.1
EAS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,21.4999215627016
EAS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1987,23.4378942878226
OSS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,33.9165223783321
PST,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,13.9576447422137
ERI,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,45.011
ECA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,20.6470030887601
MDV,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,42.92
MLI,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,48.857
ESP,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,10.8
GIN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,48.339
HKG,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,17.0
HUN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,12.1
SST,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,33.6025903430005
TSS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,44.7367184204369
TJK,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1987,42.753
FSM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,39.037
BWA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,36.828
IRN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,43.31
IRL,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,17.6
GBR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,12.8
VNM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,31.965
LA

2025-01-20 13:23:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 684
2025-01-20 13:23:12 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:13 - root - INFO - SQL:
-- 8. Select high-income countries with crude birth rate data in the 1980s
SELECT d."country_code", c."short_name", c."region", d."indicator_name", d."year", d."value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA d
JOIN WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY c
  ON d."country_code" = c."country_code"
WHERE c."income_group" = 'High income'
  AND d."indicator_code" = 'SP.DYN.CBRT.IN'
  AND d."year" BETWEEN 1980 AND 1989
LIMIT 1000
Results:
Too long, hard cut:
country_code,short_name,region,indicator_name,year,value
FRA,France,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,14.0
SVK,Slovak Republic,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,19.1
PRT,Portugal,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1983,14.5
GRC,Greece,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,11.7
GUM,Guam,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1986,27.044
JPN,Japan,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1985,11.9
LIE,Liechtenstein,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1983,13.2
CYM,Cayman Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1987,16.1
CHI,Channel Islands,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1986,11.932
EST,Estonia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1982,15.4
MLT,Malta,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1980,17.7
SGP,Singapore,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1987,16.6
ESP,Spain,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,11.0
HRV,Croatia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,14.8
HUN,Hungary,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1982,12.5
GUM,Guam,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1989,26.138
VIR,Virgin Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1980,25.8
VIR,Virgin Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1983,24.8
NCL,New Caledonia,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1989,23.6
LTU,Lithuania,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1989,15.1
HRV,Croatia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1989,11.7
AUS,Australia,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1981,15.7
CHE,Switzerland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,11.7
GUM,Guam,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1981,27.965
IRL,Ireland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,16.5
IMN,Isle of Man,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,11.5
JPN,Japan,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1988,10.8
NZL,New Zealand,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1982,15.8
ROU,Romania,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,16.7
HKG,"Hong Kong SAR, China",East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1982,16.4
HKG,"Hong Kong SAR, China",East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1986,13.0
BHS,The Bahamas,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1982,26.562
BHS,The Bahamas,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1984,26.261
OMN,Oman,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1986,44.949
ATG,Antigua and Barbuda,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1983,18.365
BRB,Barbados,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1985,17.079
DEU,Germany,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,11.1
KWT,Kuwait,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1984,33.637
CHI,Channel Islands,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,11.803
ATG,Antigua and Barbuda,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1982,18.228
FRO,Faroe Islands,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1986,17.2
SVK,Slovak Republic,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1984,17.7
PRT,Portugal,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,12.3
HUN,Hungary,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1984,11.8
GRL,Greenland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,21.7
LIE,Liechtenstein,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,13.9
EST,Estonia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,15.0
PRI,Puerto Rico,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1982,21.05
HUN,Hungary,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,13.9
BEL,Belgium,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,11.6
GRC,Greece,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1984,12.7
JPN,Japan,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1980,13.5
POL,Poland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1988,15.6
GBR,United Kingdom,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,13.4
VIR,Virgin Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1986,23.65
SAU,Saudi Arabia,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1989,36.82
FIN,Finland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1

2025-01-20 13:23:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 251
2025-01-20 13:23:14 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:15 - root - INFO - SQL:
-- 9. Get average crude birth rate per country in the 1980s
SELECT "country_code", AVG("value") AS "average_birth_rate"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
GROUP BY "country_code"
LIMIT 1000
Results:
country_code,average_birth_rate
ISR,23.38
ARE,29.427699999999998
LTU,15.89
WLD,27.30394341214759
TMN,38.90497580367376
MDV,46.5954
TLA,30.274786441933873
LMY,30.47884330858853
FRA,14.05
DZA,38.5718
MAF,24.299999999999997
KAZ,24.69
NER,56.311400000000006
PYF,30.2622
YEM,54.29299999999999
ARG,23.2518
CHL,22.8559
MEX,31.863400000000002
TUR,30.6812
SST,32.652219999619874
UGA,49.484399999999994
ARB,39.02714036733985
BRA,29.017500000000002
IDN,29.980700000000002
AFW,46.29796659677965
KWT,32.11409999999999
SSF,45.65776089930246
ETH,48.7467
FCS,43.25660731556301
GMB,46.9401
AUT,11.830000000000002
GUM,27.2331
JAM,27.540399999999998
UMC,23.211982801561838
LSO,39.406099999999995
BDI,51.30440000000001
CYM,16.84
SGP,17.080000000000002
KGZ,31.4
UZB,35.68
BHR,32.1662
ITA,10.39
LDC,44.39129228151326
PNG,37.19930000000001
FRO,16.970000000000002
HRV,13.440000000000001
SAS,35.74849630858226
TON,33.3527
BEN,46.951
VNM,30.669600000000003
PST,13.80738248928626
ECA,20.526808264901195
IRL,18.19
EUU,13.005198293055292
GHA,41.8787
MAR,34.3451
OED,16.51561037943345
MDG,45.004799999999996
VEN,31.026300000000003
LKA,24.162200000000002
NOR,12.709999999999999
SWE,11.99
IMN,11.625
PRE,46.44554769910849
UKR,14.873399999999998
DOM,31.914799999999996
IRQ,38.7932
BFA,48.4748
HKG,14.55
MOZ,45.614599999999996
SYR,41.164300000000004
HND,41.4403
PRY,35.8691
ESP,12.35
LAC,30.226092454799907
CSS,27.529797280576634
EST,15.669999999999998
MNE,17.9233
MIC,29.392565448048195
ECS,16.25379475365919
LCN,29.830225824200777
AGO,50.4971
KIR,37.016999999999996
NCL,25.310000000000002
DJI,40.5326
MHL,39.0
CEB,15.73545553397769
ARM,23.951500000000003
IDA,43.70671254230378
LTE,22.2850289920398
VUT,37.699200000000005
FIN,13.0
EMU,12.24149876183223
QAT,29.687800000000003
LVA,15.26
OSS,34.33788148381092
MLI,49.1053
FSM,37.4802
IRN,41.3344
EAP,23.77923550301364
RWA,51.66859999999999
ERI,44.6254
STP,40.81490000000001
SWZ,45.071799999999996
IND,34.4366
PHL,35.0643
TUN,31.4589
ZAF,34.525099999999995
TSA,35.74849630858227
KOR,17.93
SLV,34.2286
CYP,20.0695
MEA,38.592898761528076
CRI,29.453200000000002
NLD,12.42
JPN,11.99
ATG,18.393700000000003
MUS,21.419999999999998
NPL,40.4765
DNK,10.77
MDA,21.241099999999996
GRC,12.45
CHI,11.834700000000002
DMA,23.21666666666667
MNA,38.904975803673736
HIC,14.682259858909351
IBD,27.34765304308288
XKX,31.74444444444445
TTO,26.4283
TLS,40.305499999999995
LUX,11.72
BTN,41.9569
ABW,21.6191
LIC,45.81137988956912
GEO,18.5041
GRD,31.815499999999997
WSM,35.4043
NGA,45.7823
CHN,21.224
COG,39.8015
NIC,41.0991
TSS,45.65776089930246
BWA,40.443
BHS,25.6171
VCT,27.8353
CMR,46.0681
PAN,28.643700000000003
EAS,22.60836527876417
COD,46.1835
KHM,47.8442
COL,29.158800000000003
JOR,38.2401
PER,33.812200000000004
BRN,30.5327
EGY,37.4379
IDX,43.91645773871377
MKD,19.8519
SVN,13.74
SSA,45.66076138143743
BLR,16.4277
COM,45.10790000000001
URY,18.4291
MRT,42.0237
BLZ,38.8903
SOM,45.5933
IDB,43.279702821388575
CZE,13.309999999999999
MAC,20.7301
LMC,35.664393277040105
RUS,16.45
SLB,42.0083
IBT,30.387631580650208
KNA,24.45
PRK,20.860300000000002
EAR,35.44338867101696
SYC,25.78
TCD,50.2463
MWI,50.474399999999996
BIH,17.0399
GIN,48.5351
GBR,13.26
SUR,29.2968
PRI,20.199999999999996
BGR,13.52
BRB,17.0697
TZA,45.4015
GTM,41.4022
AND,11.75
TEA,23.81699023563197
SAU,41.028299999999994
GRL,20.659999999999997
KEN,47.096999999999994
AFG,49.750099999999996
SVK,17.33
LCA,32.271100000000004
SDN,43.438300000000005
LIE,14.09
AUS,15.35
ROU,16.16
NAM,40.1592
POL,17.880000000000003
TKM,36.3478
GNQ,43.03
CAN,14.9
CUB,16.8858
BEL,12.069999999999999
AZE,26.4591
MMR,32.0205
USA,15.830000000000002
MLT,16.499999999999996
BGD,39.874
AFE,45.22247374583799
ZWE,41.1371
HUN,12.31
TJK,42.083600000000004
GAB,38.1974
HPC,46.58286755898329
CIV,45.867599999999996
HTI,41.0126
CAF,42.3932
FJI,31.675699999999996
BOL,37.427299999999995
ECU,32.464
MYS,30.108299999999996
THA,22.7444
PAK,42.0969
SEN,46.0369
TGO,44.90410000000001
ISL,17.839999999999996
MNG,37.278800000000004
LAO,43.102199999999996
DEU,10.929999999999998
CHE,11.739999999999998
ZMB,46.7965
ALB,26.3149
GUY,29.821799999999996
PRT,13.75
VIR,24.009999999999998
NAC,15.73848700906143
NZL,16.380000000000003
GNB,48.9168
SLE,47.2539
OMN,45.9702
BMU,15.066666666666668
TEC,20.20019599289866
LBR,47.5794
LBY,35.24849999999999
SSD,47.773399999999995
PSS,35.116626998605135
CPV,42.1032
LBN,27.983600000000003

2025-01-20 13:23:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 744
2025-01-20 13:23:16 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:17 - root - INFO - SQL:
-- 10. List countries and regions with high crude birth rates in the 1980s
SELECT c."short_name", c."region", d."year", d."value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA d
JOIN WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY c
  ON d."country_code" = c."country_code"
WHERE d."indicator_code" = 'SP.DYN.CBRT.IN'
  AND d."year" BETWEEN 1980 AND 1989
  AND d."value" > 40
LIMIT 1000
Results:
Too long, hard cut:
short_name,region,year,value
Eritrea,Sub-Saharan Africa,1982,45.275
Guinea-Bissau,Sub-Saharan Africa,1982,49.703
Sub-Saharan Africa,,1980,46.6056041849774
IDA total,,1987,42.9886679824718
Ghana,Sub-Saharan Africa,1984,42.154
Chad,Sub-Saharan Africa,1988,50.683
Afghanistan,South Asia,1984,49.865
Mali,Sub-Saharan Africa,1985,48.966
Sudan,Sub-Saharan Africa,1984,43.512
Tajikistan,Europe & Central Asia,1984,42.681
Yemen,Middle East & North Africa,1986,54.329
Afghanistan,South Asia,1983,49.984
Algeria,Middle East & North Africa,1980,43.226
Mauritania,Sub-Saharan Africa,1986,41.6
Congo,Sub-Saharan Africa,1981,41.43
Congo,Sub-Saharan Africa,1983,40.33
Sudan,Sub-Saharan Africa,1981,44.895
Least developed countries: UN classification,,1989,42.7049562798149
Nigeria,Sub-Saharan Africa,1985,45.671
Central African Republic,Sub-Saharan Africa,1982,42.339
Eritrea,Sub-Saharan Africa,1984,45.188
Fragile and conflict affected situations,,1988,42.2264436739885
Congo,Sub-Saharan Africa,1982,40.871
Sub-Saharan Africa (IDA & IBRD),,1986,45.3649221687858
Africa Western and Central,,1986,45.9638810057394
Pre-demographic dividend,,1980,47.3217027778867
The Gambia,Sub-Saharan Africa,1985,46.844
Heavily indebted poor countries (HIPC),,1987,46.1024984231831
Arab World,,1983,40.1000697379661
Chad,Sub-Saharan Africa,1981,49.856
Dem. Rep. Congo,Sub-Saharan Africa,1985,46.163
Ethiopia,Sub-Saharan Africa,1981,49.086
South Sudan,Sub-Saharan Africa,1980,48.06
South Sudan,Sub-Saharan Africa,1983,47.686
Guinea,Sub-Saharan Africa,1986,48.743
Bangladesh,South Asia,1980,43.039
Burundi,Sub-Saharan Africa,1988,50.961
Middle East & North Africa (excluding high income),,1981,41.1889494231624
Oman,Middle East & North Africa,1985,46.163
Pre-demographic dividend,,1984,46.5906908668772
Mali,Sub-Saharan Africa,1988,48.746
Solomon Islands,East Asia & Pacific,1986,41.331
Haiti,Latin America & Caribbean,1981,42.401
Syrian Arab Republic,Middle East & North Africa,1981,44.064
Niger,Sub-Saharan Africa,1986,56.178
Liberia,Sub-Saharan Africa,1981,48.555
Fragile and conflict affected situations,,1981,44.1926831101688
Afghanistan,South Asia,1985,49.735
Tajikistan,Europe & Central Asia,1989,41.512
Namibia,Sub-Saharan Africa,1985,40.046
Nicaragua,Latin America & Caribbean,1980,44.639
Middle East & North Africa (excluding high income),,1983,40.4067761232568
Djibouti,Middle East & North Africa,1983,40.693
Lesotho,Sub-Saharan Africa,1983,40.661
Saudi Arabia,Middle East & North Africa,1984,41.892
Dem. Rep. Congo,Sub-Saharan Africa,1989,46.085
The Gambia,Sub-Saharan Africa,1989,47.111
Heavily indebted poor countries (HIPC),,1983,46.9442496573476
Malawi,Sub-Saharan Africa,1982,51.087
IDA blend,,1982,43.8050857210461
Equatorial Guinea,Sub-Saharan Africa,1984,43.256
Rwanda,Sub-Saharan Africa,1986,51.054
Afghanistan,South Asia,1986,49.586
Fragile and conflict affected situations,,1987,42.5554851023326
Sub-Saharan Africa (IDA & IBRD),,1987,45.0615156207329
Tanzania,Sub-Saharan Africa,1987,44.856
Cambodia,East Asia & Pacific,1986,48.756
Low income,,1987,45.5070894222259
Lesotho,Sub-Saharan Africa,1981,41.88
São Tomé and Principe,Sub-Saharan Africa,1983,41.023
Comoros,Sub-Saharan Africa,1985,45.372
Guinea,Sub-Saharan Africa,1982,48.505
Ghana,Sub-Saharan Africa,1985,41.951
Yemen,Middle East & North Africa,1985,54.477
Burundi,Sub-Saharan Africa,1981,51.279
Pre-demographic dividend,,1981,47.1602322981462
Pre-demographic dividend,,1989,45.4487350655703
Eswatini,Sub-Saharan Africa,1987,42.142
Heavily indebted poor countries (HIPC),,1986,46.3391400672485
Madagascar,Sub-Saharan Africa,1982,45.454
Mauritania,Sub-Saharan Africa,1987,41.273
Solomon Islands,East Asia & Pacific,1989,40.397
Kenya,Sub-Saharan Africa,1986,46.409
Burundi,Sub-Saharan Africa,1982,51.464
Middle East & North Africa,,1980,41.1026626953657
Madagascar,Sub-Saharan Africa,1985,44.689
Somalia,Sub-Saharan Africa,1986,46.149
Botswana,Sub-Saharan Africa,1981,43.719
Burkina Faso,Sub-Saharan Africa,1989,47.574
Least developed countries: UN classification,,1984,44.7160552119714
Saudi Arabia,Middle East & North Africa,1985,40.981
Ethiopia,Sub-Saharan Africa,1983,49.161
Heavily indebted poor countries (HIPC),,1988,45.8566079076504
Maldives,South Asia,1982,47.816
Maldives,South Asia,1986,46.974
Mali,Sub-Saharan Africa,1982,49.398
Mozambique,Sub-Saharan Africa,1985,45.399
Iran,Middle East & North Africa,1986,40.747
Pre-demographic dividend,,1986,46.1593066601153
Fragile and conflict affected situations,,1989,41.9067634165398
Malawi,Sub-Saharan Africa,1988,49.429
Nigeria,Sub-Saharan Africa,1984,45.962
Algeria,Middle East & North Africa,1981,42.34
Sub-Saharan Africa (excluding high income),,1987,45.0645252138829
Syrian Arab Republic,Middle East & North Africa,1985,41.011
Bhutan,South Asia,1980,44.303
Cabo Verde,Sub-Saharan Africa,1981,41.661
Cabo Verde,Sub-Saharan Africa,1983,42.282
São Tomé and Principe,Sub-Saharan Africa,1982,41.131
São Tomé and Principe,Sub-Saharan Africa,1985,40.79
Sierra Leone,Sub-Saharan Africa,1989,46.712
Mad

2025-01-20 13:23:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-20 13:23:18 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:18 - root - INFO - SQL:
-- 11. Count the number of high-income countries per region
SELECT "region", COUNT(*) AS "high_income_country_count"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
WHERE "income_group" = 'High income' AND "region" <> ''
GROUP BY "region"
ORDER BY "high_income_country_count" DESC
LIMIT 1000
Results:
region,high_income_country_count
Europe & Central Asia,38
Latin America & Caribbean,17
East Asia & Pacific,13
Middle East & North Africa,8
North America,3
Sub-Saharan Africa,1

2025-01-20 13:23:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-20 13:23:20 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:20 - root - INFO - SQL:
-- 12. Get distinct indicator names containing 'birth' from SERIES_SUMMARY
SELECT DISTINCT "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%birth%'
LIMIT 1000
Results:
indicator_name
"Mortality rate, under-5 (per 1,000 live births)"
"Mortality rate, under-5, female (per 1,000 live births)"
"Mortality rate, under-5, male (per 1,000 live births)"
"Mortality rate, neonatal (per 1,000 live births)"
Births attended by skilled health staff (% of total)
Low-birthweight babies (% of births)
"Maternal mortality ratio (modeled estimate, per 100,000 live births)"
"Maternal mortality ratio (national estimate, per 100,000 live births)"
"Birth rate, crude (per 1,000 people)"
"Mortality rate, infant, female (per 1,000 live births)"
"Mortality rate, infant (per 1,000 live births)"
"Mortality rate, infant, male (per 1,000 live births)"
"Life expectancy at birth, total (years)"
"Fertility rate, total (births per woman)"
"Completeness of birth registration, female (%)"
"Completeness of birth registration, male (%)"
"Completeness of birth registration, urban (%)"
Completeness of birth registration (%)
"Life expectancy at birth, female (years)"
"Life expectancy at birth, male (years)"
Wanted fertility rate (births per woman)
"Adolescent fertility rate (births per 1,000 women ages 15-19)"
"Completeness of birth registration, rural (%)"
Sex ratio at birth (male births per female births)

2025-01-20 13:23:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 265
2025-01-20 13:23:22 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:22 - root - INFO - SQL:
-- 13. Get country codes and names from COUNTRY_SUMMARY
SELECT "country_code", "short_name", "long_name"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000
Results:
Too long, hard cut:
country_code,short_name,long_name
AFE,Africa Eastern and Southern,Africa Eastern and Southern
AFW,Africa Western and Central,Africa Western and Central
ARB,Arab World,Arab World
CEB,Central Europe and the Baltics,Central Europe and the Baltics
CSS,Caribbean small states,Caribbean small states
EAP,East Asia & Pacific (excluding high income),East Asia & Pacific (excluding high income)
EAR,Early-demographic dividend,Early-demographic dividend
EAS,East Asia & Pacific,East Asia & Pacific
ECA,Europe & Central Asia (excluding high income),Europe & Central Asia (excluding high income)
ECS,Europe & Central Asia,Europe & Central Asia
EUU,European Union,European Union
FCS,Fragile and conflict affected situations,Fragile and conflict affected situations
HIC,High income,High income
HPC,Heavily indebted poor countries (HIPC),Heavily indebted poor countries (HIPC)
IBD,IBRD only,IBRD only
IBT,IDA & IBRD total,IDA & IBRD total
IDA,IDA total,IDA total
IDB,IDA blend,IDA blend
IDX,IDA only,IDA only
LAC,Latin America & Caribbean (excluding high income),Latin America & Caribbean (excluding high income)
LCN,Latin America & Caribbean,Latin America & Caribbean
LDC,Least developed countries: UN classification,Least developed countries: UN classification
LIC,Low income,Low income
LMC,Lower middle income,Lower middle income
LMY,Low & middle income,Low & middle income
LTE,Late-demographic dividend,Late-demographic dividend
MEA,Middle East & North Africa,Middle East & North Africa
MIC,Middle income,Middle income
MNA,Middle East & North Africa (excluding high income),Middle East & North Africa (excluding high income)
NAC,North America,North America
OED,OECD members,OECD members
OSS,Other small states,Other small states
PRE,Pre-demographic dividend,Pre-demographic dividend
PSS,Pacific island small states,Pacific island small states
PST,Post-demographic dividend,Post-demographic dividend
SAS,South Asia,South Asia
SSA,Sub-Saharan Africa (excluding high income),Sub-Saharan Africa (excluding high income)
SSF,Sub-Saharan Africa,Sub-Saharan Africa
SST,Small states,Small states
TEA,East Asia & Pacific (IDA & IBRD),East Asia & Pacific (IDA & IBRD)
TEC,Europe & Central Asia (IDA & IBRD),Europe & Central Asia (IDA & IBRD)
TLA,Latin America & Caribbean (IDA & IBRD),Latin America & Caribbean (IDA & IBRD)
TMN,Middle East & North Africa (IDA & IBRD),Middle East & North Africa (IDA & IBRD)
TSA,South Asia (IDA & IBRD),South Asia (IDA & IBRD)
TSS,Sub-Saharan Africa (IDA & IBRD),Sub-Saharan Africa (IDA & IBRD)
UMC,Upper middle income,Upper middle income
WLD,World,World
AND,Andorra,Principality of Andorra
BMU,Bermuda,The Bermudas
CHI,Channel Islands,Channel Islands
CUW,Curaçao,Curaçao
CYM,Cayman Islands,Cayman Islands
FRO,Faroe Islands,Faroe Islands
GIB,Gibraltar,Gibraltar
GRL,Greenland,Greenland
GUM,Guam,Guam
IMN,Isle of Man,Isle of Man
LIE,Liechtenstein,Principality of Liechtenstein
MAF,St. Martin (French part),St. Martin (French part)
MCO,Monaco,Principality of Monaco
MNP,Northern Mariana Islands,Commonwealth of the Northern Mariana Islands
NCL,New Caledonia,New Caledonia
NRU,Nauru,Republic of Nauru
NZL,New Zealand,New Zealand
PRI,Puerto Rico,Puerto Rico
PYF,French Polynesia,French Polynesia
SXM,Sint Maarten (Dutch part),Sint Maarten (Dutch part)
TCA,Turks and Caicos Islands,Turks and Caicos Islands
VGB,British Virgin Islands,British Virgin Islands
VIR,Virgin Islands,Virgin Islands of the United States
ERI,Eritrea,State of Eritrea
PRK,Dem. People's Rep. Korea,Democratic People's Republic of Korea
SOM,Somalia,Somali Democratic Republic
SSD,South Sudan,Republic of South Sudan
ASM,American Samoa,American Samoa
CUB,Cuba,Republic of Cuba
TKM,Turkmenistan,Turkmenistan
VEN,Venezuela,República Bolivariana de Venezuela
ABW,Aruba,Aruba
ARE,United Arab Emirates,United Arab Emirates
ATG,Antigua and Barbuda,Antigua and Barbuda
BHR,Bahrain,Kingdom of Bahrain
BHS,The Bahamas,Commonwealth of The Bahamas
BRB,Barbados,Barbados
BRN,Brunei,Brunei Darussalam
KNA,St. Kitts and Nevis,St. Kitts and Nevis
KWT,Kuwait,State of Kuwait
MAC,"Macao SAR, China",Macao Special Administrative Region of the People's Republic of China
OMN,Oman,Sultanate of Oman
PAN,Panama,Republic of Panama
QAT,Qatar,State of Qatar
SMR,San Marino,Republic of San Marino
TTO,Trinidad and Tobago,Republic of Trinidad and Tobago
AFG,Afghanistan,Islamic State of Afghanistan
BDI,Burundi,Republic of Burundi
BFA,Burkina Faso,Burkina Faso
CAF,Central African Republic,Central African Republic
COD,Dem. Rep. Congo,Democratic Republic of the Congo
ETH,Ethiopia,Federal Democratic Republic of Ethiopia
GIN,Guinea,Republic of Guinea
GMB,The Gambia,Republic of The Gambia
GNB,Guinea-Bissau,Republic of Guinea-Bissau
LBR,Liberia,Republic of Liberia
MDG,Madagascar,Republic of Madagascar
MLI,Mali,Republic of Mali
MOZ,Mozambique,Republic of Mozambique
MWI,Malawi,Republic of Malawi
NER,Niger,Republic of Niger
RWA,Rwanda,Republic of Rwanda
SDN,Sudan,Republic of the Sudan
SLE,Sierra Leone,Republic of Sierra Leone
SYR,Syrian Arab Repub

2025-01-20 13:23:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:23 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:23:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:23:52 - root - INFO - The error occurs because the column `"indicator_code"` does not exist in the `"SERIES_SUMMARY"` table. In the `"SERIES_SUMMARY"` table, the equivalent column is `"series_code"`.

Here's the corrected SQL query:

```sql
-- Corrected Query: Get the indicator code for 'Crude birth rate' from SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "series_code" = 'SP.DYN.CBRT.IN'
LIMIT 1000;
```

This query should retrieve the desired data without the compilation error.
2025-01-20 13:23:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:23:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:23:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:23:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 13:23:53 - snowflake.connector.connection - INFO - closed
2025-01-20 13:23:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:24:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:24:29 - root - INFO - SQL:
-- Corrected Query: Get the indicator code for 'Crude birth rate' from SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "series_code" = 'SP.DYN.CBRT.IN'
LIMIT 1000;
Results:
series_code,indicator_name
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"

2025-01-20 13:24:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:24:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:24:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:24:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-20 13:24:31 - snowflake.connector.connection - INFO - closed
2025-01-20 13:24:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:24:31 - root - INFO - SQL:
-- 15. List the top 10 countries with the highest average crude birth rate in the 1980s
SELECT "country_code", AVG("value") AS "average_birth_rate"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
GROUP BY "country_code"
ORDER BY "average_birth_rate" DESC
LIMIT 10
Results:
country_code,average_birth_rate
NER,56.311400000000006
YEM,54.29299999999999
RWA,51.66859999999999
BDI,51.30440000000001
AGO,50.4971
MWI,50.474399999999996
TCD,50.2463
AFG,49.750099999999996
UGA,49.48440000000001
MLI,49.1053

2025-01-20 13:24:31 - root - INFO - itercount: 0
2025-01-20 13:24:31 - root - INFO - Database Name: WORLD_BANK
Schema Name: WORLD_BANK_GLOBAL_POPULATION
DDL describes table information.
,0
table_name,POPULATION_BY_COUNTRY
description,
DDL,"create or replace TABLE POPULATION_BY_COUNTRY (
	""country"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""year_1960"" NUMBER(38,0),
	""year_1961"" NUMBER(38,0),
	""year_1962"" NUMBER(38,0),
	""year_1963"" NUMBER(38,0),
	""year_1964"" NUMBER(38,0),
	""year_1965"" NUMBER(38,0),
	""year_1966"" NUMBER(38,0),
	""year_1967"" NUMBER(38,0),
	""year_1968"" NUMBER(38,0),
	""year_1969"" NUMBER(38,0),
	""year_1970"" NUMBER(38,0),
	""year_1971"" NUMBER(38,0),
	""year_1972"" NUMBER(38,0),
	""year_1973"" NUMBER(38,0),
	""year_1974"" NUMBER(38,0),
	""year_1975"" NUMBER(38,0),
	""year_1976"" NUMBER(38,0),
	""year_1977"" NUMBER(38,0),
	""year_1978"" NUMBER(38,0),
	""year_1979"" NUMBER(38,0),
	""year_1980"" NUMBER(38,0),
	""year_1981"" NUMBER(38,0),
	""year_1982"" NUMBER(38,0),
	""year_1983"" NUMBER(38,0),
	""year_1984"" NUMBER(38,0),
	""year_1985"" NUMBER(38,0),
	""year_1986"" NUMBER(38,0),
	""year_1987"" NUMBER(38,0),
	""year_1988"" NUMBER(38,0),
	""year_1989"" NUMBER(38,0),
	""year_1990"" NUMBER(38,0),
	""year_1991"" NUMBER(38,0),
	""year_1992"" NUMBER(38,0),
	""year_1993"" NUMBER(38,0),
	""year_1994"" NUMBER(38,0),
	""year_1995"" NUMBER(38,0),
	""year_1996"" NUMBER(38,0),
	""year_1997"" NUMBER(38,0),
	""year_1998"" NUMBER(38,0),
	""year_1999"" NUMBER(38,0),
	""year_2000"" NUMBER(38,0),
	""year_2001"" NUMBER(38,0),
	""year_2002"" NUMBER(38,0),
	""year_2003"" NUMBER(38,0),
	""year_2004"" NUMBER(38,0),
	""year_2005"" NUMBER(38,0),
	""year_2006"" NUMBER(38,0),
	""year_2007"" NUMBER(38,0),
	""year_2008"" NUMBER(38,0),
	""year_2009"" NUMBER(38,0),
	""year_2010"" NUMBER(38,0),
	""year_2011"" NUMBER(38,0),
	""year_2012"" NUMBER(38,0),
	""year_2013"" NUMBER(38,0),
	""year_2014"" NUMBER(38,0),
	""year_2015"" NUMBER(38,0),
	""year_2016"" NUMBER(38,0),
	""year_2017"" NUMBER(38,0),
	""year_2018"" NUMBER(38,0),
	""year_2019"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
DDL describes table information.
,0
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

,1
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0)
);"

,2
table_name,HEALTH_NUTRITION_POPULATION
description,
DDL,"create or replace TABLE HEALTH_NUTRITION_POPULATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" NUMBER(38,0),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
DDL describes table information.
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_Income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

,1
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

,2
table_name,INTERNATIONAL_DEBT
description,
DDL,"create or replace TABLE INTERNATIONAL_DEBT (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
DDL describes table information.
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_two_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

,1
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

,2
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

,3
table_name,INTERNATIONAL_EDUCATION
description,
DDL,"create or replace TABLE INTERNATIONAL_EDUCATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
DDL describes table information.
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" VARCHAR(16777216),
	""latest_trade_data"" VARCHAR(16777216)
);"

,1
table_name,SERIES_TIME
description,
DDL,"create or replace TABLE SERIES_TIME (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

,2
table_name,INDICATORS_DATA
description,
DDL,"create or replace TABLE INDICATORS_DATA (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

,3
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

,4
table_name,FOOTNOTES
description,
DDL,"create or replace TABLE FOOTNOTES (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

,5
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'INTERNATIONAL_EDUCATION', 'SERIES_SUMMARY'], 'WORLD_BANK_WDI': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'FOOTNOTES', 'INDICATORS_DATA', 'SERIES_SUMMARY', 'SERIES_TIME']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

- `"country_code"` (from `COUNTRY_SUMMARY`): Used to join with `INDICATORS_DATA` to link country data.
- `"income_group"` (from `COUNTRY_SUMMARY`): To filter for high-income countries.
- `"region"` (from `COUNTRY_SUMMARY`): To identify the region of each country.
- `"indicator_name"` (from `INDICATORS_DATA`): To identify the 'Crude birth rate' indicator.
- `"indicator_code"` (from `INDICATORS_DATA`): To find the specific code associated with 'Crude birth rate'.
- `"value"` (from `INDICATORS_DATA`): Contains the crude birth rate values needed for averaging.
- `"year"` (from `INDICATORS_DATA`): To select data within the 1980s (1980-1989).
- `"series_code"` (from `SERIES_SUMMARY`): To find the indicator code for 'Crude birth rate'.
- `"indicator_name"` (from `SERIES_SUMMARY`): To find indicators related to 'Crude birth rate'.

**Conditions that may be used:**

- `"income_group"` = 'High income'
- `"indicator_name"` ILIKE '%crude birth rate%'
- `"year"` BETWEEN 1980 AND 1989

**SQL Queries:**

```sql
-- 1. List all distinct income groups
SELECT DISTINCT "income_group"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000;

-- 2. List all distinct regions
SELECT DISTINCT "region"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000;

-- 3. Select high-income countries and their regions
SELECT "country_code", "short_name", "region"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
WHERE "income_group" = 'High income'
LIMIT 1000;

-- 4. Find indicator codes for 'Crude birth rate' in SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%crude birth rate%'
LIMIT 1000;

-- 5. Get distinct indicator codes where 'indicator_name' contains 'birth rate'
SELECT DISTINCT "indicator_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%birth rate%'
LIMIT 1000;

-- 6. List all years between 1980 and 1989 in INDICATORS_DATA
SELECT DISTINCT "year"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "year" BETWEEN 1980 AND 1989
ORDER BY "year"
LIMIT 1000;

-- 7. Get crude birth rate data for the 1980s
SELECT "country_code", "indicator_code", "indicator_name", "year", "value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%crude birth rate%'
  AND "year" BETWEEN 1980 AND 1989
LIMIT 1000;

-- 8. Select high-income countries with crude birth rate data in the 1980s
SELECT d."country_code", c."short_name", d."indicator_name", d."year", d."value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA d
JOIN WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY c
  ON d."country_code" = c."country_code"
WHERE c."income_group" = 'High income'
  AND d."indicator_name" ILIKE '%crude birth rate%'
  AND d."year" BETWEEN 1980 AND 1989
LIMIT 1000;

-- 9. Get average crude birth rate per country in the 1980s
SELECT "country_code", AVG("value") AS "average_birth_rate"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%crude birth rate%'
  AND "year" BETWEEN 1980 AND 1989
GROUP BY "country_code"
LIMIT 1000;

-- 10. List countries and regions with high crude birth rates in the 1980s
SELECT c."short_name", c."region", d."year", d."value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA d
JOIN WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY c
  ON d."country_code" = c."country_code"
WHERE d."indicator_name" ILIKE '%crude birth rate%'
  AND d."year" BETWEEN 1980 AND 1989
  AND d."value" > 40
LIMIT 1000;

-- 11. Count the number of high-income countries per region
SELECT "region", COUNT(*) AS "high_income_country_count"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
WHERE "income_group" = 'High income'
GROUP BY "region"
LIMIT 1000;

-- 12. Get distinct indicator names containing 'birth'
SELECT DISTINCT "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%birth%'
LIMIT 1000;

-- 13. Get country codes and names from COUNTRY_SUMMARY
SELECT "country_code", "short_name", "long_name"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000;

-- 14. Get the indicator code for 'Crude birth rate' from SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%crude birth rate%'
LIMIT 1000;

-- 15. List the top 10 countries with the highest average crude birth rate in the 1980s
SELECT "country_code", AVG("value") AS "average_birth_rate"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%crude birth rate%'
  AND "year" BETWEEN 1980 AND 1989
GROUP BY "country_code"
ORDER BY "average_birth_rate" DESC
LIMIT 10;
```

These queries help in understanding the data and columns related to the task by:

- Identifying income groups and regions.
- Finding the specific indicator codes for crude birth rate.
- Extracting crude birth rate data for the 1980s.
- Filtering high-income countries.
- Calculating average crude birth rates.
- Exploring relationships between countries, regions, and birth rates.Query:
-- 1. List all distinct income groups
SELECT DISTINCT "income_group"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000
Answer:
income_group
""
High income
Low income
Upper middle income
Lower middle income
Query:
-- 2. List all distinct regions
SELECT DISTINCT "region"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000
Answer:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia
Query:
-- 3. Select high-income countries and their regions
SELECT "country_code", "short_name", "region"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
WHERE "income_group" = 'High income'
LIMIT 1000
Answer:
country_code,short_name,region
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
NCL,New Caledonia,East Asia & Pacific
NRU,Nauru,East Asia & Pacific
NZL,New Zealand,East Asia & Pacific
PRI,Puerto Rico,Latin America & Caribbean
PYF,French Polynesia,East Asia & Pacific
SXM,Sint Maarten (Dutch part),Latin America & Caribbean
TCA,Turks and Caicos Islands,Latin America & Caribbean
VGB,British Virgin Islands,Latin America & Caribbean
VIR,Virgin Islands,Latin America & Caribbean
ABW,Aruba,Latin America & Caribbean
ARE,United Arab Emirates,Middle East & North Africa
ATG,Antigua and Barbuda,Latin America & Caribbean
BHR,Bahrain,Middle East & North Africa
BHS,The Bahamas,Latin America & Caribbean
BRB,Barbados,Latin America & Caribbean
BRN,Brunei,East Asia & Pacific
KNA,St. Kitts and Nevis,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MAC,"Macao SAR, China",East Asia & Pacific
OMN,Oman,Middle East & North Africa
PAN,Panama,Latin America & Caribbean
QAT,Qatar,Middle East & North Africa
SMR,San Marino,Europe & Central Asia
TTO,Trinidad and Tobago,Latin America & Caribbean
AUS,Australia,East Asia & Pacific
BEL,Belgium,Europe & Central Asia
CHE,Switzerland,Europe & Central Asia
CYP,Cyprus,Europe & Central Asia
EST,Estonia,Europe & Central Asia
GBR,United Kingdom,Europe & Central Asia
GRC,Greece,Europe & Central Asia
HKG,"Hong Kong SAR, China",East Asia & Pacific
HRV,Croatia,Europe & Central Asia
HUN,Hungary,Europe & Central Asia
IRL,Ireland,Europe & Central Asia
ISL,Iceland,Europe & Central Asia
ISR,Israel,Middle East & North Africa
KOR,Korea,East Asia & Pacific
MLT,Malta,Middle East & North Africa
NOR,Norway,Europe & Central Asia
POL,Poland,Europe & Central Asia
SAU,Saudi Arabia,Middle East & North Africa
SGP,Singapore,East Asia & Pacific
SYC,Seychelles,Sub-Saharan Africa
URY,Uruguay,Latin America & Caribbean
AUT,Austria,Europe & Central Asia
CAN,Canada,North America
CHL,Chile,Latin America & Caribbean
CZE,Czech Republic,Europe & Central Asia
DEU,Germany,Europe & Central Asia
DNK,Denmark,Europe & Central Asia
ESP,Spain,Europe & Central Asia
FIN,Finland,Europe & Central Asia
FRA,France,Europe & Central Asia
ITA,Italy,Europe & Central Asia
JPN,Japan,East Asia & Pacific
LTU,Lithuania,Europe & Central Asia
LUX,Luxembourg,Europe & Central Asia
LVA,Latvia,Europe & Central Asia
NLD,Netherlands,Europe & Central Asia
PRT,Portugal,Europe & Central Asia
ROU,Romania,Europe & Central Asia
SVK,Slovak Republic,Europe & Central Asia
SVN,Slovenia,Europe & Central Asia
SWE,Sweden,Europe & Central Asia
USA,United States,North America
Query:
-- Corrected Query: Find indicator codes for indicators containing 'birth' in SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%birth%'
LIMIT 1000;
Answer:
series_code,indicator_name
SH.DYN.MORT,"Mortality rate, under-5 (per 1,000 live births)"
SH.DYN.MORT.FE,"Mortality rate, under-5, female (per 1,000 live births)"
SH.DYN.MORT.MA,"Mortality rate, under-5, male (per 1,000 live births)"
SH.DYN.NMRT,"Mortality rate, neonatal (per 1,000 live births)"
SH.STA.BRTC.ZS,Births attended by skilled health staff (% of total)
SH.STA.BRTW.ZS,Low-birthweight babies (% of births)
SH.STA.MMRT,"Maternal mortality ratio (modeled estimate, per 100,000 live births)"
SH.STA.MMRT.NE,"Maternal mortality ratio (national estimate, per 100,000 live births)"
SP.ADO.TFRT,"Adolescent fertility rate (births per 1,000 women ages 15-19)"
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
SP.DYN.IMRT.FE.IN,"Mortality rate, infant, female (per 1,000 live births)"
SP.DYN.IMRT.IN,"Mortality rate, infant (per 1,000 live births)"
SP.DYN.IMRT.MA.IN,"Mortality rate, infant, male (per 1,000 live births)"
SP.DYN.LE00.FE.IN,"Life expectancy at birth, female (years)"
SP.DYN.LE00.IN,"Life expectancy at birth, total (years)"
SP.DYN.LE00.MA.IN,"Life expectancy at birth, male (years)"
SP.DYN.TFRT.IN,"Fertility rate, total (births per woman)"
SP.DYN.WFRT,Wanted fertility rate (births per woman)
SP.POP.BRTH.MF,Sex ratio at birth (male births per female births)
SP.REG.BRTH.FE.ZS,"Completeness of birth registration, female (%)"
SP.REG.BRTH.MA.ZS,"Completeness of birth registration, male (%)"
SP.REG.BRTH.RU.ZS,"Completeness of birth registration, rural (%)"
SP.REG.BRTH.UR.ZS,"Completeness of birth registration, urban (%)"
SP.REG.BRTH.ZS,Completeness of birth registration (%)
Query:
-- 5. Get distinct indicator codes where 'indicator_name' contains 'birth rate'
SELECT DISTINCT "indicator_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_name" ILIKE '%birth rate%'
LIMIT 1000
Answer:
indicator_code,indicator_name
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
Query:
-- 6. List all years between 1980 and 1989 in INDICATORS_DATA
SELECT DISTINCT "year"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "year" BETWEEN 1980 AND 1989
ORDER BY "year"
LIMIT 1000
Answer:
year
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
Query:
SELECT "country_code", "indicator_code", "indicator_name", "year", "value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
LIMIT 1000;
Answer:
Too long, hard cut:
country_code,indicator_code,indicator_name,year,value
AZE,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,26.1
BHR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,32.122
KNA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,21.3
GEO,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,18.66
GRD,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,32.814
ISR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,23.7
ITA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,10.6
ITA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,10.1
ARE,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,29.537
VUT,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,37.843
PRK,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,21.19
MMR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,31.749
LDC,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,45.4862409097559
LTU,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,15.2
EAR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,34.8516947116678
WSM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,36.692
SYC,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,26.9
NGA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,45.375
PNG,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,37.428
TCD,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1982,49.954
CHN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,22.37
WLD,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,27.4871068047757
TMN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,36.0364618603991
FRO,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,15.4
FRO,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,18.4
FIN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1982,13.7
EMU,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1987,11.8582803023218
MWI,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,50.979
MDV,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,44.507
QAT,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,23.437
COG,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,39.38
HRV,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,12.8
CYP,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,19.62
SAS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,33.4974110618792
TON,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,34.329
BEN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,46.281
BIH,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,15.769
IRQ,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1982,39.24
ARE,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,30.343
USA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,15.6
VNM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,29.136
NIC,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,41.841
NER,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,55.799
BFA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,48.68
TLA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,32.6223652795471
LMY,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,30.722363924328
MEA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,40.8515238894317
LVA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,14.1
EAS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,21.4999215627016
EAS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1987,23.4378942878226
OSS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,33.9165223783321
PST,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,13.9576447422137
ERI,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,45.011
ECA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,20.6470030887601
MDV,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,42.92
MLI,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,48.857
ESP,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,10.8
GIN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1989,48.339
HKG,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,17.0
HUN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1986,12.1
SST,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,33.6025903430005
TSS,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,44.7367184204369
TJK,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1987,42.753
FSM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1981,39.037
BWA,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1988,36.828
IRN,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1984,43.31
IRL,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1985,17.6
GBR,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1983,12.8
VNM,SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)",1980,31.965
LA
Query:
-- 8. Select high-income countries with crude birth rate data in the 1980s
SELECT d."country_code", c."short_name", c."region", d."indicator_name", d."year", d."value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA d
JOIN WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY c
  ON d."country_code" = c."country_code"
WHERE c."income_group" = 'High income'
  AND d."indicator_code" = 'SP.DYN.CBRT.IN'
  AND d."year" BETWEEN 1980 AND 1989
LIMIT 1000
Answer:
Too long, hard cut:
country_code,short_name,region,indicator_name,year,value
FRA,France,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,14.0
SVK,Slovak Republic,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,19.1
PRT,Portugal,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1983,14.5
GRC,Greece,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,11.7
GUM,Guam,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1986,27.044
JPN,Japan,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1985,11.9
LIE,Liechtenstein,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1983,13.2
CYM,Cayman Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1987,16.1
CHI,Channel Islands,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1986,11.932
EST,Estonia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1982,15.4
MLT,Malta,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1980,17.7
SGP,Singapore,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1987,16.6
ESP,Spain,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,11.0
HRV,Croatia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,14.8
HUN,Hungary,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1982,12.5
GUM,Guam,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1989,26.138
VIR,Virgin Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1980,25.8
VIR,Virgin Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1983,24.8
NCL,New Caledonia,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1989,23.6
LTU,Lithuania,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1989,15.1
HRV,Croatia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1989,11.7
AUS,Australia,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1981,15.7
CHE,Switzerland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,11.7
GUM,Guam,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1981,27.965
IRL,Ireland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,16.5
IMN,Isle of Man,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,11.5
JPN,Japan,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1988,10.8
NZL,New Zealand,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1982,15.8
ROU,Romania,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,16.7
HKG,"Hong Kong SAR, China",East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1982,16.4
HKG,"Hong Kong SAR, China",East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1986,13.0
BHS,The Bahamas,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1982,26.562
BHS,The Bahamas,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1984,26.261
OMN,Oman,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1986,44.949
ATG,Antigua and Barbuda,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1983,18.365
BRB,Barbados,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1985,17.079
DEU,Germany,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,11.1
KWT,Kuwait,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1984,33.637
CHI,Channel Islands,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,11.803
ATG,Antigua and Barbuda,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1982,18.228
FRO,Faroe Islands,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1986,17.2
SVK,Slovak Republic,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1984,17.7
PRT,Portugal,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1987,12.3
HUN,Hungary,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1984,11.8
GRL,Greenland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,21.7
LIE,Liechtenstein,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,13.9
EST,Estonia,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,15.0
PRI,Puerto Rico,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1982,21.05
HUN,Hungary,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,13.9
BEL,Belgium,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1985,11.6
GRC,Greece,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1984,12.7
JPN,Japan,East Asia & Pacific,"Birth rate, crude (per 1,000 people)",1980,13.5
POL,Poland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1988,15.6
GBR,United Kingdom,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1980,13.4
VIR,Virgin Islands,Latin America & Caribbean,"Birth rate, crude (per 1,000 people)",1986,23.65
SAU,Saudi Arabia,Middle East & North Africa,"Birth rate, crude (per 1,000 people)",1989,36.82
FIN,Finland,Europe & Central Asia,"Birth rate, crude (per 1,000 people)",1
Query:
-- 9. Get average crude birth rate per country in the 1980s
SELECT "country_code", AVG("value") AS "average_birth_rate"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
GROUP BY "country_code"
LIMIT 1000
Answer:
country_code,average_birth_rate
ISR,23.38
ARE,29.427699999999998
LTU,15.89
WLD,27.30394341214759
TMN,38.90497580367376
MDV,46.5954
TLA,30.274786441933873
LMY,30.47884330858853
FRA,14.05
DZA,38.5718
MAF,24.299999999999997
KAZ,24.69
NER,56.311400000000006
PYF,30.2622
YEM,54.29299999999999
ARG,23.2518
CHL,22.8559
MEX,31.863400000000002
TUR,30.6812
SST,32.652219999619874
UGA,49.484399999999994
ARB,39.02714036733985
BRA,29.017500000000002
IDN,29.980700000000002
AFW,46.29796659677965
KWT,32.11409999999999
SSF,45.65776089930246
ETH,48.7467
FCS,43.25660731556301
GMB,46.9401
AUT,11.830000000000002
GUM,27.2331
JAM,27.540399999999998
UMC,23.211982801561838
LSO,39.406099999999995
BDI,51.30440000000001
CYM,16.84
SGP,17.080000000000002
KGZ,31.4
UZB,35.68
BHR,32.1662
ITA,10.39
LDC,44.39129228151326
PNG,37.19930000000001
FRO,16.970000000000002
HRV,13.440000000000001
SAS,35.74849630858226
TON,33.3527
BEN,46.951
VNM,30.669600000000003
PST,13.80738248928626
ECA,20.526808264901195
IRL,18.19
EUU,13.005198293055292
GHA,41.8787
MAR,34.3451
OED,16.51561037943345
MDG,45.004799999999996
VEN,31.026300000000003
LKA,24.162200000000002
NOR,12.709999999999999
SWE,11.99
IMN,11.625
PRE,46.44554769910849
UKR,14.873399999999998
DOM,31.914799999999996
IRQ,38.7932
BFA,48.4748
HKG,14.55
MOZ,45.614599999999996
SYR,41.164300000000004
HND,41.4403
PRY,35.8691
ESP,12.35
LAC,30.226092454799907
CSS,27.529797280576634
EST,15.669999999999998
MNE,17.9233
MIC,29.392565448048195
ECS,16.25379475365919
LCN,29.830225824200777
AGO,50.4971
KIR,37.016999999999996
NCL,25.310000000000002
DJI,40.5326
MHL,39.0
CEB,15.73545553397769
ARM,23.951500000000003
IDA,43.70671254230378
LTE,22.2850289920398
VUT,37.699200000000005
FIN,13.0
EMU,12.24149876183223
QAT,29.687800000000003
LVA,15.26
OSS,34.33788148381092
MLI,49.1053
FSM,37.4802
IRN,41.3344
EAP,23.77923550301364
RWA,51.66859999999999
ERI,44.6254
STP,40.81490000000001
SWZ,45.071799999999996
IND,34.4366
PHL,35.0643
TUN,31.4589
ZAF,34.525099999999995
TSA,35.74849630858227
KOR,17.93
SLV,34.2286
CYP,20.0695
MEA,38.592898761528076
CRI,29.453200000000002
NLD,12.42
JPN,11.99
ATG,18.393700000000003
MUS,21.419999999999998
NPL,40.4765
DNK,10.77
MDA,21.241099999999996
GRC,12.45
CHI,11.834700000000002
DMA,23.21666666666667
MNA,38.904975803673736
HIC,14.682259858909351
IBD,27.34765304308288
XKX,31.74444444444445
TTO,26.4283
TLS,40.305499999999995
LUX,11.72
BTN,41.9569
ABW,21.6191
LIC,45.81137988956912
GEO,18.5041
GRD,31.815499999999997
WSM,35.4043
NGA,45.7823
CHN,21.224
COG,39.8015
NIC,41.0991
TSS,45.65776089930246
BWA,40.443
BHS,25.6171
VCT,27.8353
CMR,46.0681
PAN,28.643700000000003
EAS,22.60836527876417
COD,46.1835
KHM,47.8442
COL,29.158800000000003
JOR,38.2401
PER,33.812200000000004
BRN,30.5327
EGY,37.4379
IDX,43.91645773871377
MKD,19.8519
SVN,13.74
SSA,45.66076138143743
BLR,16.4277
COM,45.10790000000001
URY,18.4291
MRT,42.0237
BLZ,38.8903
SOM,45.5933
IDB,43.279702821388575
CZE,13.309999999999999
MAC,20.7301
LMC,35.664393277040105
RUS,16.45
SLB,42.0083
IBT,30.387631580650208
KNA,24.45
PRK,20.860300000000002
EAR,35.44338867101696
SYC,25.78
TCD,50.2463
MWI,50.474399999999996
BIH,17.0399
GIN,48.5351
GBR,13.26
SUR,29.2968
PRI,20.199999999999996
BGR,13.52
BRB,17.0697
TZA,45.4015
GTM,41.4022
AND,11.75
TEA,23.81699023563197
SAU,41.028299999999994
GRL,20.659999999999997
KEN,47.096999999999994
AFG,49.750099999999996
SVK,17.33
LCA,32.271100000000004
SDN,43.438300000000005
LIE,14.09
AUS,15.35
ROU,16.16
NAM,40.1592
POL,17.880000000000003
TKM,36.3478
GNQ,43.03
CAN,14.9
CUB,16.8858
BEL,12.069999999999999
AZE,26.4591
MMR,32.0205
USA,15.830000000000002
MLT,16.499999999999996
BGD,39.874
AFE,45.22247374583799
ZWE,41.1371
HUN,12.31
TJK,42.083600000000004
GAB,38.1974
HPC,46.58286755898329
CIV,45.867599999999996
HTI,41.0126
CAF,42.3932
FJI,31.675699999999996
BOL,37.427299999999995
ECU,32.464
MYS,30.108299999999996
THA,22.7444
PAK,42.0969
SEN,46.0369
TGO,44.90410000000001
ISL,17.839999999999996
MNG,37.278800000000004
LAO,43.102199999999996
DEU,10.929999999999998
CHE,11.739999999999998
ZMB,46.7965
ALB,26.3149
GUY,29.821799999999996
PRT,13.75
VIR,24.009999999999998
NAC,15.73848700906143
NZL,16.380000000000003
GNB,48.9168
SLE,47.2539
OMN,45.9702
BMU,15.066666666666668
TEC,20.20019599289866
LBR,47.5794
LBY,35.24849999999999
SSD,47.773399999999995
PSS,35.116626998605135
CPV,42.1032
LBN,27.983600000000003
Query:
-- 10. List countries and regions with high crude birth rates in the 1980s
SELECT c."short_name", c."region", d."year", d."value"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA d
JOIN WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY c
  ON d."country_code" = c."country_code"
WHERE d."indicator_code" = 'SP.DYN.CBRT.IN'
  AND d."year" BETWEEN 1980 AND 1989
  AND d."value" > 40
LIMIT 1000
Answer:
Too long, hard cut:
short_name,region,year,value
Eritrea,Sub-Saharan Africa,1982,45.275
Guinea-Bissau,Sub-Saharan Africa,1982,49.703
Sub-Saharan Africa,,1980,46.6056041849774
IDA total,,1987,42.9886679824718
Ghana,Sub-Saharan Africa,1984,42.154
Chad,Sub-Saharan Africa,1988,50.683
Afghanistan,South Asia,1984,49.865
Mali,Sub-Saharan Africa,1985,48.966
Sudan,Sub-Saharan Africa,1984,43.512
Tajikistan,Europe & Central Asia,1984,42.681
Yemen,Middle East & North Africa,1986,54.329
Afghanistan,South Asia,1983,49.984
Algeria,Middle East & North Africa,1980,43.226
Mauritania,Sub-Saharan Africa,1986,41.6
Congo,Sub-Saharan Africa,1981,41.43
Congo,Sub-Saharan Africa,1983,40.33
Sudan,Sub-Saharan Africa,1981,44.895
Least developed countries: UN classification,,1989,42.7049562798149
Nigeria,Sub-Saharan Africa,1985,45.671
Central African Republic,Sub-Saharan Africa,1982,42.339
Eritrea,Sub-Saharan Africa,1984,45.188
Fragile and conflict affected situations,,1988,42.2264436739885
Congo,Sub-Saharan Africa,1982,40.871
Sub-Saharan Africa (IDA & IBRD),,1986,45.3649221687858
Africa Western and Central,,1986,45.9638810057394
Pre-demographic dividend,,1980,47.3217027778867
The Gambia,Sub-Saharan Africa,1985,46.844
Heavily indebted poor countries (HIPC),,1987,46.1024984231831
Arab World,,1983,40.1000697379661
Chad,Sub-Saharan Africa,1981,49.856
Dem. Rep. Congo,Sub-Saharan Africa,1985,46.163
Ethiopia,Sub-Saharan Africa,1981,49.086
South Sudan,Sub-Saharan Africa,1980,48.06
South Sudan,Sub-Saharan Africa,1983,47.686
Guinea,Sub-Saharan Africa,1986,48.743
Bangladesh,South Asia,1980,43.039
Burundi,Sub-Saharan Africa,1988,50.961
Middle East & North Africa (excluding high income),,1981,41.1889494231624
Oman,Middle East & North Africa,1985,46.163
Pre-demographic dividend,,1984,46.5906908668772
Mali,Sub-Saharan Africa,1988,48.746
Solomon Islands,East Asia & Pacific,1986,41.331
Haiti,Latin America & Caribbean,1981,42.401
Syrian Arab Republic,Middle East & North Africa,1981,44.064
Niger,Sub-Saharan Africa,1986,56.178
Liberia,Sub-Saharan Africa,1981,48.555
Fragile and conflict affected situations,,1981,44.1926831101688
Afghanistan,South Asia,1985,49.735
Tajikistan,Europe & Central Asia,1989,41.512
Namibia,Sub-Saharan Africa,1985,40.046
Nicaragua,Latin America & Caribbean,1980,44.639
Middle East & North Africa (excluding high income),,1983,40.4067761232568
Djibouti,Middle East & North Africa,1983,40.693
Lesotho,Sub-Saharan Africa,1983,40.661
Saudi Arabia,Middle East & North Africa,1984,41.892
Dem. Rep. Congo,Sub-Saharan Africa,1989,46.085
The Gambia,Sub-Saharan Africa,1989,47.111
Heavily indebted poor countries (HIPC),,1983,46.9442496573476
Malawi,Sub-Saharan Africa,1982,51.087
IDA blend,,1982,43.8050857210461
Equatorial Guinea,Sub-Saharan Africa,1984,43.256
Rwanda,Sub-Saharan Africa,1986,51.054
Afghanistan,South Asia,1986,49.586
Fragile and conflict affected situations,,1987,42.5554851023326
Sub-Saharan Africa (IDA & IBRD),,1987,45.0615156207329
Tanzania,Sub-Saharan Africa,1987,44.856
Cambodia,East Asia & Pacific,1986,48.756
Low income,,1987,45.5070894222259
Lesotho,Sub-Saharan Africa,1981,41.88
São Tomé and Principe,Sub-Saharan Africa,1983,41.023
Comoros,Sub-Saharan Africa,1985,45.372
Guinea,Sub-Saharan Africa,1982,48.505
Ghana,Sub-Saharan Africa,1985,41.951
Yemen,Middle East & North Africa,1985,54.477
Burundi,Sub-Saharan Africa,1981,51.279
Pre-demographic dividend,,1981,47.1602322981462
Pre-demographic dividend,,1989,45.4487350655703
Eswatini,Sub-Saharan Africa,1987,42.142
Heavily indebted poor countries (HIPC),,1986,46.3391400672485
Madagascar,Sub-Saharan Africa,1982,45.454
Mauritania,Sub-Saharan Africa,1987,41.273
Solomon Islands,East Asia & Pacific,1989,40.397
Kenya,Sub-Saharan Africa,1986,46.409
Burundi,Sub-Saharan Africa,1982,51.464
Middle East & North Africa,,1980,41.1026626953657
Madagascar,Sub-Saharan Africa,1985,44.689
Somalia,Sub-Saharan Africa,1986,46.149
Botswana,Sub-Saharan Africa,1981,43.719
Burkina Faso,Sub-Saharan Africa,1989,47.574
Least developed countries: UN classification,,1984,44.7160552119714
Saudi Arabia,Middle East & North Africa,1985,40.981
Ethiopia,Sub-Saharan Africa,1983,49.161
Heavily indebted poor countries (HIPC),,1988,45.8566079076504
Maldives,South Asia,1982,47.816
Maldives,South Asia,1986,46.974
Mali,Sub-Saharan Africa,1982,49.398
Mozambique,Sub-Saharan Africa,1985,45.399
Iran,Middle East & North Africa,1986,40.747
Pre-demographic dividend,,1986,46.1593066601153
Fragile and conflict affected situations,,1989,41.9067634165398
Malawi,Sub-Saharan Africa,1988,49.429
Nigeria,Sub-Saharan Africa,1984,45.962
Algeria,Middle East & North Africa,1981,42.34
Sub-Saharan Africa (excluding high income),,1987,45.0645252138829
Syrian Arab Republic,Middle East & North Africa,1985,41.011
Bhutan,South Asia,1980,44.303
Cabo Verde,Sub-Saharan Africa,1981,41.661
Cabo Verde,Sub-Saharan Africa,1983,42.282
São Tomé and Principe,Sub-Saharan Africa,1982,41.131
São Tomé and Principe,Sub-Saharan Africa,1985,40.79
Sierra Leone,Sub-Saharan Africa,1989,46.712
Mad
Query:
-- 11. Count the number of high-income countries per region
SELECT "region", COUNT(*) AS "high_income_country_count"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
WHERE "income_group" = 'High income' AND "region" <> ''
GROUP BY "region"
ORDER BY "high_income_country_count" DESC
LIMIT 1000
Answer:
region,high_income_country_count
Europe & Central Asia,38
Latin America & Caribbean,17
East Asia & Pacific,13
Middle East & North Africa,8
North America,3
Sub-Saharan Africa,1
Query:
-- 12. Get distinct indicator names containing 'birth' from SERIES_SUMMARY
SELECT DISTINCT "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "indicator_name" ILIKE '%birth%'
LIMIT 1000
Answer:
indicator_name
"Mortality rate, under-5 (per 1,000 live births)"
"Mortality rate, under-5, female (per 1,000 live births)"
"Mortality rate, under-5, male (per 1,000 live births)"
"Mortality rate, neonatal (per 1,000 live births)"
Births attended by skilled health staff (% of total)
Low-birthweight babies (% of births)
"Maternal mortality ratio (modeled estimate, per 100,000 live births)"
"Maternal mortality ratio (national estimate, per 100,000 live births)"
"Birth rate, crude (per 1,000 people)"
"Mortality rate, infant, female (per 1,000 live births)"
"Mortality rate, infant (per 1,000 live births)"
"Mortality rate, infant, male (per 1,000 live births)"
"Life expectancy at birth, total (years)"
"Fertility rate, total (births per woman)"
"Completeness of birth registration, female (%)"
"Completeness of birth registration, male (%)"
"Completeness of birth registration, urban (%)"
Completeness of birth registration (%)
"Life expectancy at birth, female (years)"
"Life expectancy at birth, male (years)"
Wanted fertility rate (births per woman)
"Adolescent fertility rate (births per 1,000 women ages 15-19)"
"Completeness of birth registration, rural (%)"
Sex ratio at birth (male births per female births)
Query:
-- 13. Get country codes and names from COUNTRY_SUMMARY
SELECT "country_code", "short_name", "long_name"
FROM WORLD_BANK.WORLD_BANK_WDI.COUNTRY_SUMMARY
LIMIT 1000
Answer:
Too long, hard cut:
country_code,short_name,long_name
AFE,Africa Eastern and Southern,Africa Eastern and Southern
AFW,Africa Western and Central,Africa Western and Central
ARB,Arab World,Arab World
CEB,Central Europe and the Baltics,Central Europe and the Baltics
CSS,Caribbean small states,Caribbean small states
EAP,East Asia & Pacific (excluding high income),East Asia & Pacific (excluding high income)
EAR,Early-demographic dividend,Early-demographic dividend
EAS,East Asia & Pacific,East Asia & Pacific
ECA,Europe & Central Asia (excluding high income),Europe & Central Asia (excluding high income)
ECS,Europe & Central Asia,Europe & Central Asia
EUU,European Union,European Union
FCS,Fragile and conflict affected situations,Fragile and conflict affected situations
HIC,High income,High income
HPC,Heavily indebted poor countries (HIPC),Heavily indebted poor countries (HIPC)
IBD,IBRD only,IBRD only
IBT,IDA & IBRD total,IDA & IBRD total
IDA,IDA total,IDA total
IDB,IDA blend,IDA blend
IDX,IDA only,IDA only
LAC,Latin America & Caribbean (excluding high income),Latin America & Caribbean (excluding high income)
LCN,Latin America & Caribbean,Latin America & Caribbean
LDC,Least developed countries: UN classification,Least developed countries: UN classification
LIC,Low income,Low income
LMC,Lower middle income,Lower middle income
LMY,Low & middle income,Low & middle income
LTE,Late-demographic dividend,Late-demographic dividend
MEA,Middle East & North Africa,Middle East & North Africa
MIC,Middle income,Middle income
MNA,Middle East & North Africa (excluding high income),Middle East & North Africa (excluding high income)
NAC,North America,North America
OED,OECD members,OECD members
OSS,Other small states,Other small states
PRE,Pre-demographic dividend,Pre-demographic dividend
PSS,Pacific island small states,Pacific island small states
PST,Post-demographic dividend,Post-demographic dividend
SAS,South Asia,South Asia
SSA,Sub-Saharan Africa (excluding high income),Sub-Saharan Africa (excluding high income)
SSF,Sub-Saharan Africa,Sub-Saharan Africa
SST,Small states,Small states
TEA,East Asia & Pacific (IDA & IBRD),East Asia & Pacific (IDA & IBRD)
TEC,Europe & Central Asia (IDA & IBRD),Europe & Central Asia (IDA & IBRD)
TLA,Latin America & Caribbean (IDA & IBRD),Latin America & Caribbean (IDA & IBRD)
TMN,Middle East & North Africa (IDA & IBRD),Middle East & North Africa (IDA & IBRD)
TSA,South Asia (IDA & IBRD),South Asia (IDA & IBRD)
TSS,Sub-Saharan Africa (IDA & IBRD),Sub-Saharan Africa (IDA & IBRD)
UMC,Upper middle income,Upper middle income
WLD,World,World
AND,Andorra,Principality of Andorra
BMU,Bermuda,The Bermudas
CHI,Channel Islands,Channel Islands
CUW,Curaçao,Curaçao
CYM,Cayman Islands,Cayman Islands
FRO,Faroe Islands,Faroe Islands
GIB,Gibraltar,Gibraltar
GRL,Greenland,Greenland
GUM,Guam,Guam
IMN,Isle of Man,Isle of Man
LIE,Liechtenstein,Principality of Liechtenstein
MAF,St. Martin (French part),St. Martin (French part)
MCO,Monaco,Principality of Monaco
MNP,Northern Mariana Islands,Commonwealth of the Northern Mariana Islands
NCL,New Caledonia,New Caledonia
NRU,Nauru,Republic of Nauru
NZL,New Zealand,New Zealand
PRI,Puerto Rico,Puerto Rico
PYF,French Polynesia,French Polynesia
SXM,Sint Maarten (Dutch part),Sint Maarten (Dutch part)
TCA,Turks and Caicos Islands,Turks and Caicos Islands
VGB,British Virgin Islands,British Virgin Islands
VIR,Virgin Islands,Virgin Islands of the United States
ERI,Eritrea,State of Eritrea
PRK,Dem. People's Rep. Korea,Democratic People's Republic of Korea
SOM,Somalia,Somali Democratic Republic
SSD,South Sudan,Republic of South Sudan
ASM,American Samoa,American Samoa
CUB,Cuba,Republic of Cuba
TKM,Turkmenistan,Turkmenistan
VEN,Venezuela,República Bolivariana de Venezuela
ABW,Aruba,Aruba
ARE,United Arab Emirates,United Arab Emirates
ATG,Antigua and Barbuda,Antigua and Barbuda
BHR,Bahrain,Kingdom of Bahrain
BHS,The Bahamas,Commonwealth of The Bahamas
BRB,Barbados,Barbados
BRN,Brunei,Brunei Darussalam
KNA,St. Kitts and Nevis,St. Kitts and Nevis
KWT,Kuwait,State of Kuwait
MAC,"Macao SAR, China",Macao Special Administrative Region of the People's Republic of China
OMN,Oman,Sultanate of Oman
PAN,Panama,Republic of Panama
QAT,Qatar,State of Qatar
SMR,San Marino,Republic of San Marino
TTO,Trinidad and Tobago,Republic of Trinidad and Tobago
AFG,Afghanistan,Islamic State of Afghanistan
BDI,Burundi,Republic of Burundi
BFA,Burkina Faso,Burkina Faso
CAF,Central African Republic,Central African Republic
COD,Dem. Rep. Congo,Democratic Republic of the Congo
ETH,Ethiopia,Federal Democratic Republic of Ethiopia
GIN,Guinea,Republic of Guinea
GMB,The Gambia,Republic of The Gambia
GNB,Guinea-Bissau,Republic of Guinea-Bissau
LBR,Liberia,Republic of Liberia
MDG,Madagascar,Republic of Madagascar
MLI,Mali,Republic of Mali
MOZ,Mozambique,Republic of Mozambique
MWI,Malawi,Republic of Malawi
NER,Niger,Republic of Niger
RWA,Rwanda,Republic of Rwanda
SDN,Sudan,Republic of the Sudan
SLE,Sierra Leone,Republic of Sierra Leone
SYR,Syrian Arab Repub
Query:
-- Corrected Query: Get the indicator code for 'Crude birth rate' from SERIES_SUMMARY
SELECT "series_code", "indicator_name"
FROM WORLD_BANK.WORLD_BANK_WDI.SERIES_SUMMARY
WHERE "series_code" = 'SP.DYN.CBRT.IN'
LIMIT 1000;
Answer:
series_code,indicator_name
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
Query:
-- 15. List the top 10 countries with the highest average crude birth rate in the 1980s
SELECT "country_code", AVG("value") AS "average_birth_rate"
FROM WORLD_BANK.WORLD_BANK_WDI.INDICATORS_DATA
WHERE "indicator_code" = 'SP.DYN.CBRT.IN'
  AND "year" BETWEEN 1980 AND 1989
GROUP BY "country_code"
ORDER BY "average_birth_rate" DESC
LIMIT 10
Answer:
country_code,average_birth_rate
NER,56.311400000000006
YEM,54.29299999999999
RWA,51.66859999999999
BDI,51.30440000000001
AGO,50.4971
MWI,50.474399999999996
TCD,50.2463
AFG,49.750099999999996
UGA,49.48440000000001
MLI,49.1053
End Exploring Related Columns
Task: Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Country,Region,Average Crude Birth Rate
country1:str,region1:str,rate1:float
country2:str,region2:str,rate2:float
...
```

To determine the high-income country with the highest average crude birth rate in each region during the 1980s, we:

1. **Identified High-Income Countries**: Selected countries from the `COUNTRY_SUMMARY` table where the `income_group` is `'High income'`, along with their corresponding `region`.

2. **Extracted Crude Birth Rate Data**: Retrieved crude birth rate data from the `INDICATORS_DATA` table where `indicator_name` corresponds to the crude birth rate indicator, focusing on the years from 1980 to 1989.

3. **Calculated Averages**: Calculated the average crude birth rate for each high-income country over the specified period.

4. **Selected Highest per Region**: For each region, identified the high-income country with the highest average crude birth rate during the 1980s..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'INTERNATIONAL_EDUCATION', 'SERIES_SUMMARY'], 'WORLD_BANK_WDI': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'FOOTNOTES', 'INDICATORS_DATA', 'SERIES_SUMMARY', 'SERIES_TIME']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 13:24:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:24:55 - root - INFO - ```sql
WITH high_income_birth_rates AS (
    SELECT 
        cs."country_code",
        cs."short_name" AS "Country",
        cs."region" AS "Region",
        AVG(id."value") AS "Average_Crude_Birth_Rate"
    FROM 
        WORLD_BANK.WORLD_BANK_WDI."INDICATORS_DATA" AS id
        JOIN WORLD_BANK.WORLD_BANK_WDI."COUNTRY_SUMMARY" AS cs
            ON id."country_code" = cs."country_code"
    WHERE 
        cs."income_group" = 'High income'
        AND id."indicator_code" = 'SP.DYN.CBRT.IN'
        AND id."year" BETWEEN 1980 AND 1989
        AND cs."region" <> ''
    GROUP BY 
        cs."country_code",
        cs."short_name",
        cs."region"
),
max_birth_rates AS (
    SELECT
        "Region",
        MAX("Average_Crude_Birth_Rate") AS "Max_Average_Crude_Birth_Rate"
    FROM 
        high_income_birth_rates
    GROUP BY
        "Region"
)
SELECT
    h."Country",
    h."Region",
    ROUND(h."Average_Crude_Birth_Rate", 4) AS "Average Crude Birth Rate"
FROM
    high_income_birth_rates h
    JOIN max_birth_rates m
        ON h."Region" = m."Region"
        AND h."Average_Crude_Birth_Rate" = m."Max_Average_Crude_Birth_Rate"
ORDER BY
    h."Region";
```
2025-01-20 13:24:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:24:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:24:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:24:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-20 13:24:57 - snowflake.connector.connection - INFO - closed
2025-01-20 13:24:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:24:57 - root - INFO - itercount: 1
2025-01-20 13:24:57 - root - INFO - 0
2025-01-20 13:24:57 - root - INFO - results: 
Country,Region,Average Crude Birth Rate
Brunei,East Asia & Pacific,30.5327
Greenland,Europe & Central Asia,20.66
Panama,Latin America & Caribbean,28.6437
Oman,Middle East & North Africa,45.9702
United States,North America,15.83
Seychelles,Sub-Saharan Africa,25.78


2025-01-20 13:24:57 - root - INFO - Please check the answer again by reviewing Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Country,Region,Average Crude Birth Rate
country1:str,region1:str,rate1:float
country2:str,region2:str,rate2:float
...
```

To determine the high-income country with the highest average crude birth rate in each region during the 1980s, we:

1. **Identified High-Income Countries**: Selected countries from the `COUNTRY_SUMMARY` table where the `income_group` is `'High income'`, along with their corresponding `region`.

2. **Extracted Crude Birth Rate Data**: Retrieved crude birth rate data from the `INDICATORS_DATA` table where `indicator_name` corresponds to the crude birth rate indicator, focusing on the years from 1980 to 1989.

3. **Calculated Averages**: Calculated the average crude birth rate for each high-income country over the specified period.

4. **Selected Highest per Region**: For each region, identified the high-income country with the highest average crude birth rate during the 1980s. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Country,Region,Average Crude Birth Rate
Brunei,East Asia & Pacific,30.5327
Greenland,Europe & Central Asia,20.66
Panama,Latin America & Caribbean,28.6437
Oman,Middle East & North Africa,45.9702
United States,North America,15.83
Seychelles,Sub-Saharan Africa,25.78
Current sql:
WITH high_income_birth_rates AS (
    SELECT 
        cs."country_code",
        cs."short_name" AS "Country",
        cs."region" AS "Region",
        AVG(id."value") AS "Average_Crude_Birth_Rate"
    FROM 
        WORLD_BANK.WORLD_BANK_WDI."INDICATORS_DATA" AS id
        JOIN WORLD_BANK.WORLD_BANK_WDI."COUNTRY_SUMMARY" AS cs
            ON id."country_code" = cs."country_code"
    WHERE 
        cs."income_group" = 'High income'
        AND id."indicator_code" = 'SP.DYN.CBRT.IN'
        AND id."year" BETWEEN 1980 AND 1989
        AND cs."region" <> ''
    GROUP BY 
        cs."country_code",
        cs."short_name",
        cs."region"
),
max_birth_rates AS (
    SELECT
        "Region",
        MAX("Average_Crude_Birth_Rate") AS "Max_Average_Crude_Birth_Rate"
    FROM 
        high_income_birth_rates
    GROUP BY
        "Region"
)
SELECT
    h."Country",
    h."Region",
    ROUND(h."Average_Crude_Birth_Rate", 4) AS "Average Crude Birth Rate"
FROM
    high_income_birth_rates h
    JOIN max_birth_rates m
        ON h."Region" = m."Region"
        AND h."Average_Crude_Birth_Rate" = m."Max_Average_Crude_Birth_Rate"
ORDER BY
    h."Region";
2025-01-20 13:25:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:25:29 - root - INFO - ```sql
WITH high_income_birth_rates AS (
    SELECT 
        cs."country_code",
        cs."short_name" AS "Country",
        cs."region" AS "Region",
        AVG(id."value") AS "Average_Crude_Birth_Rate"
    FROM 
        WORLD_BANK.WORLD_BANK_WDI."INDICATORS_DATA" AS id
        JOIN WORLD_BANK.WORLD_BANK_WDI."COUNTRY_SUMMARY" AS cs
            ON id."country_code" = cs."country_code"
    WHERE 
        cs."income_group" = 'High income'
        AND id."indicator_code" = 'SP.DYN.CBRT.IN'
        AND id."year" BETWEEN 1980 AND 1989
        AND cs."region" <> ''
    GROUP BY 
        cs."country_code",
        cs."short_name",
        cs."region"
),
max_birth_rates AS (
    SELECT
        "Region",
        MAX("Average_Crude_Birth_Rate") AS "Max_Average_Crude_Birth_Rate"
    FROM 
        high_income_birth_rates
    GROUP BY
        "Region"
)
SELECT
    h."Country",
    h."Region",
    ROUND(h."Average_Crude_Birth_Rate", 4) AS "Average Crude Birth Rate"
FROM
    high_income_birth_rates h
    JOIN max_birth_rates m
        ON h."Region" = m."Region"
        AND h."Average_Crude_Birth_Rate" = m."Max_Average_Crude_Birth_Rate"
ORDER BY
    h."Region";
```

```csv
Country,Region,Average Crude Birth Rate
Brunei,East Asia & Pacific,30.5327
Greenland,Europe & Central Asia,20.6600
Panama,Latin America & Caribbean,28.6437
Oman,Middle East & North Africa,45.9702
United States,North America,15.8300
Seychelles,Sub-Saharan Africa,25.7800
```
2025-01-20 13:25:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:25:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:25:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:25:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-20 13:25:30 - snowflake.connector.connection - INFO - closed
2025-01-20 13:25:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:25:31 - root - INFO - itercount: 2
2025-01-20 13:25:31 - root - INFO - 0
2025-01-20 13:25:31 - root - INFO - Total iteration counts: 2
