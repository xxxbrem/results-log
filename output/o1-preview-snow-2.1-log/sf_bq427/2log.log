2025-01-26 17:46:49 - openai._base_client - INFO - Retrying request to /chat/completions in 0.410566 seconds
2025-01-26 17:47:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:47:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:47:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:47:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:47:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 37
2025-01-26 17:47:39 - snowflake.connector.connection - INFO - closed
2025-01-26 17:47:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:47:39 - root - INFO - SQL:
SELECT DISTINCT "event_type"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   LIMIT 100;
Results:
event_type
freethrowmade
delay
offensivefoul
shootingfoul
kickball
technicalfoul
teamtimeout
deadball
officialtimeout
substitution
block
openinbound
twopointmiss
minortechnicalfoul
personalfoul
threepointmade
clearpathfoul
rebound
endperiod
twopointmade
opentip
assist
review
turnover
laneviolation
ejection
threepointmiss
flagrantone
freethrowmiss
possession
defensivethreeseconds
attemptblocked
flagranttwo
lineupchange
jumpball
tvtimeout
freethrow

2025-01-26 17:47:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:47:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:47:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:47:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 17:47:41 - snowflake.connector.connection - INFO - closed
2025-01-26 17:47:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:48:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:48:04 - root - INFO - ```sql
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100;
```
2025-01-26 17:48:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:48:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:48:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:48:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:48:06 - snowflake.connector.connection - INFO - closed
2025-01-26 17:48:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:49:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:49:48 - root - INFO - SQL:
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100;
Results:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:33,447,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,26ce70e0-395c-49dc-bc4c-a29c8f6e39bc,1522545300000000,Malik Newman misses two point layup,88.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:34,506,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,37617439-1421-47bb-ab37-9ef0f6b740b9,Marcus Garrett,0,b6e9792f-3623-421a-9508-a09846181106,1522545420000000,Marcus Garrett misses two point layup,99.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:06,534,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,6c25f209-bd61-4a1e-a239-f5996e77335b,Silvio De Sousa,22,c6b48e2d-5eee-48f3-9abd-603655af5174,1522545480000000,Silvio De Sousa misses two point layup,71.0,327.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,18:20,100,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,2783a8f1-e87e-41db-bd9e-495044d13d85,1522544400000000,Malik Newman misses two point jump shot,240.0,177.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:48,432,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,9b22a279-e1aa-4fbf-9db2-0123c78729ec,1522545300000000,Malik Newman misses two point jump shot,237.0,336.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,

2025-01-26 17:49:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:49:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:49:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:49:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-26 17:49:50 - snowflake.connector.connection - INFO - closed
2025-01-26 17:49:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:49:50 - root - INFO - SQL:
SELECT DISTINCT "shot_type"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Results:
shot_type
jump shot
layup
hook shot
dunk
""
tip shot

2025-01-26 17:49:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:49:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:49:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:49:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-26 17:49:52 - snowflake.connector.connection - INFO - closed
2025-01-26 17:49:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:49:52 - root - INFO - SQL:
SELECT "shot_type", COUNT(*) AS "attempts"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
GROUP BY "shot_type"
LIMIT 100
Results:
shot_type,attempts
dunk,41997
jump shot,680076
layup,337805
hook shot,11015
,194962
tip shot,6117

2025-01-26 17:49:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:49:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:49:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:49:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 17:49:54 - snowflake.connector.connection - INFO - closed
2025-01-26 17:49:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:49:54 - root - INFO - SQL:
SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Results:
avg_x,avg_y
563.7203539071614,288.3724201476133

2025-01-26 17:49:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:49:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:49:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:49:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:49:55 - snowflake.connector.connection - INFO - closed
2025-01-26 17:49:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:49:56 - root - INFO - SQL:
SELECT "team_id", COUNT(*) AS "successful_shots"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'threepointmade')
GROUP BY "team_id"
LIMIT 100
Results:
team_id,successful_shots
a41d5a05-4c11-4171-a57e-e7a1ea325a6d,4869
b06b63b0-20e6-4c78-bdcf-5feac3d7995e,189
c2245a52-8d2e-4aaa-b42f-f22e0d629227,59
c3a808e6-2c5d-415f-9cd5-334148961392,19
e48e3dd5-721c-4d96-8ff4-790fe2597bfd,268
fa416692-7e09-4f0a-9bcf-0cf7d5149a14,3790
fd245a76-7ab5-41d4-9dd4-76bb82bc47bd,18
31ac98c4-4517-41f9-b113-ae604bea5678,30
4fbebf0a-e117-4a0c-8f15-c247535a2a1b,3777
11a617d5-af03-4cce-bc8a-51114d9e41fe,1277
6bff595c-32cb-4028-837c-c7de2a2107e6,540
912671c7-19fd-451b-813e-885485427820,244
701ab32b-ac60-4106-97a7-cf70a0a053f7,19
78434f3d-9b05-480c-b79f-4f228a0a155b,35
c206712f-2298-4279-b76c-834ac42809b9,327
f7575278-12ec-494a-b544-427c1759d43d,169
10f450ce-143b-4e46-8bfe-52c644b68b07,489
9bb49515-c2c8-44f8-8adf-d86a5d3bde11,19
6b0359b5-10a1-486f-916d-41e109edadcf,20
2b861694-22f4-4392-bd2a-8d272cfd44eb,23
1da70895-f77f-44ef-b216-d63c02e696eb,4879
2920c5fa-1e86-4958-a7c4-1e97b8e201d8,2186
600aad0e-85e7-4db8-be0b-94ba02a08e55,293
2f4d21f8-6d5f-48a5-abca-52a30583871a,4899
90ec10eb-38a4-4a69-b072-ef71d294933b,456
a3fef707-e4fc-48a0-82f1-f4ef01b76f45,492
aacdc78d-b7fa-48f6-9686-2fdb8a95030e,3940
aed211c3-23a4-4188-ad70-22c6eba7d765,1615
aef5e386-d8e8-460c-8014-3a2f090fd988,4195
dc3bc3bd-c463-4726-a099-e624e239f47b,16
e0ef0587-bd03-4590-b92d-b95e1f9b615b,43
e6914f16-ca37-4d2e-ba26-a425910283e2,3712
f2d01b77-0f5d-4574-9e49-2a3eaf822e44,386
23426c0b-1705-4dfb-a0e2-efdbdd8fd6f6,556
484dfa62-cc8c-46ac-a4ca-2e2b48391ddd,57
9e99d5a6-3522-4ab1-8c69-1350227496b8,26
778ef9d5-039f-4f00-bbb4-38661ca4f56f,20
48c7f9f3-f7e4-4c4a-b429-7995f9ee78c4,26
45439cdb-af7a-4743-936c-dccc76b30877,476
70e2bedd-3a0a-479c-ac99-e3f58aa6824b,3815
e52c9644-717a-46f4-bf16-aeca000b3b44,4017
82c12e8d-7c6c-47d8-b100-3cbc190d268e,301
9c396fa7-c165-4599-8542-158bd0d9a199,377
d52c3640-069c-4554-982e-e6537c8044f1,2547
dba620d9-7282-4638-bf05-13caf48eeed1,368
b4b87d2c-9af2-455b-adc1-4e484c078912,18
22fbe5dc-c6db-4675-b3a3-2d8af7f5d313,465
31aedd91-a77e-46c1-8bdc-80e9860c159d,391
508f503f-dc57-4f4c-a01e-4f195e5c05c8,517
56913910-87f7-4ad7-ae3b-5cd9fb218fd9,4256
e19cfc47-f23f-4c64-ba29-2e6d12dc45b2,298
fe406882-9f22-495e-9df6-ef357a6803c6,524
87d88c93-29bc-4306-b0a6-87c6f6e80da1,445
61dadefa-76bf-4db4-8067-f88df540b9cd,399
0dadedb0-2bd3-45e7-91a3-93af6c4e87f2,373
52df1e19-b142-4a76-a439-ad68455d0581,4238
2da57857-b038-4ad3-8199-e3fb339f57d2,543
324ccccc-575b-4b82-acb0-fbb8e68da13b,3948
350271fa-d620-4398-822c-72857291199f,43
161354af-1f3e-4d58-88f7-e016ec74b7b6,545
8967c7ec-141e-491f-a79d-9b62f7905efb,27
949c3398-85e4-4c63-ba71-9a82e06ddea4,265
c31455b2-8a45-4248-aa8f-ce7eab1c6b02,3117
ef13a371-76ed-409c-9aa6-35135183e170,357
f7dea397-0b96-4e96-812f-e454226b5925,19
ad925b0b-8411-41de-81df-212482545581,17
b18d3456-8403-4101-987a-e1f887735478,22
38fa68fb-ac54-4e62-84cb-c3dafc34fe09,22
9febd5fa-982f-4f40-ad1d-8e49be96cf4f,458
5ef64f01-86ae-4553-9834-c79cc0859eaf,705
0a50907c-0141-4d40-81e7-d1652b307838,32
500d7223-ecff-494b-9539-28427156c783,501
683ab61f-546f-44da-b085-c3a5740554aa,4069
0c0608b3-f349-4f5e-9a10-7e6a744dd0d2,3490
e033de6e-06c8-4bf0-9470-1b1795becf56,24
eb157f98-0697-459c-9293-ddb162ceb28b,975
f8b1bf00-5b73-4ac4-98c0-ec554027ae32,3395
ad9fce12-6b1a-400c-bcbe-29d84d065fc0,513
1753768d-e46e-40b1-8d69-a8ae5cccec03,334
1dc13b18-f9b3-4bb9-b1cf-979fcd8c2b6f,353
63cad858-8654-4956-8438-8fe79cd1208a,539
4927ef8b-e680-4fb8-b10e-2ea3eff32eab,249
26eaeb27-2fc4-4c9f-93b2-27f6afe39071,16
61db8108-45f1-43e5-ade8-83278324bc7d,25
224e3b21-30e7-4a05-9e8c-62721d581db8,2089
56fe0ab2-e4f0-47b9-8726-9ce23ebcde20,649
68a3227f-677f-43b0-9a3a-cad79d0df9e2,2951
0113eea0-c943-4fff-9780-ae0fb099e7ef,270
0d8a328f-20ce-410b-bed1-15fc01308aaf,4745
6e8f97e0-911d-4fd1-b9da-7fd57ab26729,27
df3da9d7-2d2b-44e2-99e2-08c4945a203b,757
72971b77-1d35-40b3-bb63-4c5b29f3d22b,3557
175d34a7-3823-4e4f-9f11-2464f55360b8,447
532d3874-b4b3-4c5c-acc6-749a6db26c8f,3459
cb732075-23a5-4e71-9037-50a7a002bdb2,445
d3c8a767-b6fc-45d4-a5f2-18406f2993f1,4266
de46a033-8750-4828-90cc-b25350d0fb15,18
ef184799-d79b-49d9-a662-991eaf4044cd,4131
fe037cba-25d9-42f5-a461-61d7102c17de,356
5fe4a398-1699-4442-a364-305b2f0ac01e,606

2025-01-26 17:49:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:49:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:49:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:49:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:49:58 - snowflake.connector.connection - INFO - closed
2025-01-26 17:49:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:49:58 - root - INFO - SQL:
SELECT
  "game_id",
  "team_id",
  "elapsed_time_sec",
  SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "cumulative_points"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Results:
Too long, hard cut:
game_id,team_id,elapsed_time_sec,cumulative_points
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,855,12.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,542,8.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1477,24.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1584,26.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1216,22.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,900,15.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,531,8.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,301,2.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1830,34.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,756,11.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1797,42.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,585,11.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,812,14.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1829,42.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1429,30.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1919,46.0
f519a979-dada-49a1-a581-e85bdc2be8b0,c851131a-5ecd-4670-81bc-b40f4837dd65,2045,42.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1123,17.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,929,10.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1112,15.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1854,30.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,25,2.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1463,23.0
327cabf5-0e0a-4788-b6a1-79eda5cf7c41,c851131a-5ecd-4670-81bc-b40f4837dd65,882,21.0
327cabf5-0e0a-4788-b6a1-79eda5cf7c41,c851131a-5ecd-4670-81bc-b40f4837dd65,2595,62.0
327cabf5-0e0a-4788-b6a1-79eda5cf7c41,c851131a-5ecd-4670-81bc-b40f4837dd65,623,16.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,2010,43.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,106,5.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,2275,48.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,788,22.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,1092,24.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,135,7.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,50,
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,1966,43.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,347,9.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,965,20.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,1374,30.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,695,14.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,281,7.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,345,7.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,340,7.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,585,12.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,571,9.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,1322,35.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,195,4.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,1715,42.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,122,2.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,322,6.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,559,13.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,1047,20.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,496,10.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,2220,56.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,1466,31.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,2440,55.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,545,16.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,1976,42.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,380,10.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,1386,25.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,1242,25.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b9

2025-01-26 17:49:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:49:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:49:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:50:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:50:00 - snowflake.connector.connection - INFO - closed
2025-01-26 17:50:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:50:00 - root - INFO - SQL:
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
  AND "team_basket" = 'left' AND "event_coord_x" < 564
LIMIT 100
Results:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:33,447,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,26ce70e0-395c-49dc-bc4c-a29c8f6e39bc,1522545300000000,Malik Newman misses two point layup,88.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:34,506,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,37617439-1421-47bb-ab37-9ef0f6b740b9,Marcus Garrett,0,b6e9792f-3623-421a-9508-a09846181106,1522545420000000,Marcus Garrett misses two point layup,99.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:06,534,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,6c25f209-bd61-4a1e-a239-f5996e77335b,Silvio De Sousa,22,c6b48e2d-5eee-48f3-9abd-603655af5174,1522545480000000,Silvio De Sousa misses two point layup,71.0,327.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,18:20,100,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,2783a8f1-e87e-41db-bd9e-495044d13d85,1522544400000000,Malik Newman misses two point jump shot,240.0,177.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:48,432,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,9b22a279-e1aa-4fbf-9db2-0123c78729ec,1522545300000000,Malik Newman misses two point jump shot,237.0,336.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,

2025-01-26 17:50:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:50:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:50:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:50:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:50:02 - snowflake.connector.connection - INFO - closed
2025-01-26 17:50:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:50:02 - root - INFO - SQL:
SELECT
  "game_id",
  "elapsed_time_sec",
  "team_id",
  "points_scored",
  SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") -
  SUM("points_scored") OVER (PARTITION BY "game_id" ORDER BY "elapsed_time_sec") +
  SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "score_delta"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Results:
Too long, hard cut:
game_id,elapsed_time_sec,team_id,points_scored,score_delta
67324d29-0941-4ee8-8027-9bb2ecf82e36,770,2ed86226-3fff-4083-90fa-6b02307e6f73,,0.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,428,2ed86226-3fff-4083-90fa-6b02307e6f73,,-5.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,220,2ed86226-3fff-4083-90fa-6b02307e6f73,2.0,0.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,1059,2ed86226-3fff-4083-90fa-6b02307e6f73,,-13.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,1567,2ed86226-3fff-4083-90fa-6b02307e6f73,2.0,-5.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,154,2ed86226-3fff-4083-90fa-6b02307e6f73,,-2.0
67324d29-0941-4ee8-8027-9bb2ecf82e36,877,2ed86226-3fff-4083-90fa-6b02307e6f73,,-3.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,2003,2ed86226-3fff-4083-90fa-6b02307e6f73,,-10.0
67324d29-0941-4ee8-8027-9bb2ecf82e36,2173,2ed86226-3fff-4083-90fa-6b02307e6f73,,-21.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,2289,2ed86226-3fff-4083-90fa-6b02307e6f73,,-17.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,1656,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,10.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,424,c851131a-5ecd-4670-81bc-b40f4837dd65,,-2.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,1681,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,13.0
514440b9-f5f2-4dda-9a4c-92253176ba16,1717,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,-13.0
514440b9-f5f2-4dda-9a4c-92253176ba16,167,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,4.0
514440b9-f5f2-4dda-9a4c-92253176ba16,920,c851131a-5ecd-4670-81bc-b40f4837dd65,,4.0
514440b9-f5f2-4dda-9a4c-92253176ba16,421,c851131a-5ecd-4670-81bc-b40f4837dd65,,6.0
514440b9-f5f2-4dda-9a4c-92253176ba16,260,c851131a-5ecd-4670-81bc-b40f4837dd65,,2.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,1938,c851131a-5ecd-4670-81bc-b40f4837dd65,,15.0
514440b9-f5f2-4dda-9a4c-92253176ba16,1942,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-12.0
514440b9-f5f2-4dda-9a4c-92253176ba16,2094,c851131a-5ecd-4670-81bc-b40f4837dd65,,-16.0
514440b9-f5f2-4dda-9a4c-92253176ba16,804,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,4.0
d7656944-0406-42eb-9019-d40ad4f60121,2057,c851131a-5ecd-4670-81bc-b40f4837dd65,,12.0
d7656944-0406-42eb-9019-d40ad4f60121,533,c851131a-5ecd-4670-81bc-b40f4837dd65,,9.0
d7656944-0406-42eb-9019-d40ad4f60121,2055,c851131a-5ecd-4670-81bc-b40f4837dd65,,12.0
d7656944-0406-42eb-9019-d40ad4f60121,1672,c851131a-5ecd-4670-81bc-b40f4837dd65,,20.0
d7656944-0406-42eb-9019-d40ad4f60121,440,c851131a-5ecd-4670-81bc-b40f4837dd65,,11.0
d7656944-0406-42eb-9019-d40ad4f60121,1438,c851131a-5ecd-4670-81bc-b40f4837dd65,,20.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,919,c851131a-5ecd-4670-81bc-b40f4837dd65,,4.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,2332,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,17.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,1687,c851131a-5ecd-4670-81bc-b40f4837dd65,,8.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,2292,c851131a-5ecd-4670-81bc-b40f4837dd65,,14.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,1262,c851131a-5ecd-4670-81bc-b40f4837dd65,,-1.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,1323,c851131a-5ecd-4670-81bc-b40f4837dd65,,1.0
50d4f952-2417-4bc0-8069-7650b43d9e38,335,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,4.0
50d4f952-2417-4bc0-8069-7650b43d9e38,1818,c851131a-5ecd-4670-81bc-b40f4837dd65,,-12.0
50d4f952-2417-4bc0-8069-7650b43d9e38,2306,c851131a-5ecd-4670-81bc-b40f4837dd65,,-15.0
50d4f952-2417-4bc0-8069-7650b43d9e38,323,c851131a-5ecd-4670-81bc-b40f4837dd65,,2.0
50d4f952-2417-4bc0-8069-7650b43d9e38,1071,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,1.0
50d4f952-2417-4bc0-8069-7650b43d9e38,1949,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,-11.0
50d4f952-2417-4bc0-8069-7650b43d9e38,2387,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-15.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1887,c851131a-5ecd-4670-81bc-b40f4837dd65,,-31.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,31,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,0.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1724,c851131a-5ecd-4670-81bc-b40f4837dd65,,-26.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1820,c851131a-5ecd-4670-81bc-b40f4837dd65,,-29.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1645,c851131a-5ecd-4670-81bc-b40f4837dd65,,-24.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,913,c851131a-5ecd-4670-81bc-b40f4837dd65,,-12.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1258,c851131a-5ecd-4670-81bc-b40f4837dd65,,-18.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1765,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-26.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,351,c851131a-5ecd-4670-81bc-b40f4837dd65,,-9.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1358,c851131a-5ecd-4670-81bc-b40f4837dd65,,-20.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,97,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-1.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,929,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,-9.0
b24a7f15-764d-4cec-9384-b26222c1b983,1717,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-8.0
b24a7f15-764d-4cec-9384-b26222c1b983,752,c851131a-5ecd-4670-81bc-b40f4837dd65,,-10.0
b24a7f15-764d-4cec-9384-b26222c1b983,953,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-6.0
b24a7f15-764d-4cec-9384-b26222c1b983,2020,c851131a-5ecd-4670-81bc-b40f4837dd65,,-9.0
b24a7f15-764d-4cec-9384-b26222c1b983,875,c851131a-5ecd-4670

2025-01-26 17:50:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:50:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:50:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:50:04 - snowflake.connector.connection - INFO - closed
2025-01-26 17:50:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:51:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:51:36 - root - INFO - The error occurred because the column `"opponent_id"` does not exist in the `MBB_PBP_SR` table. To compute the score delta (difference in cumulative scores between a team and its opponent), we need to adjust the query to correctly reference the available data.

Here's a corrected SQL query that computes the score delta without using the non-existent `"opponent_id"` column:

```sql
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "shot_type",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
)

SELECT
  cs."game_id",
  cs."shot_type",
  cs."team_id",
  cs."elapsed_time_sec",
  cs."team_cumulative_points",
  cs."team_cumulative_points" - opponent."team_cumulative_points" AS "score_delta"
FROM cumulative_scores cs
JOIN (
  SELECT
    "game_id",
    "elapsed_time_sec",
    "team_id" AS "opponent_team_id",
    "team_cumulative_points"
  FROM cumulative_scores
) opponent
ON cs."game_id" = opponent."game_id"
  AND cs."elapsed_time_sec" = opponent."elapsed_time_sec"
  AND cs."team_id" <> opponent."opponent_team_id"
ORDER BY cs."game_id", cs."elapsed_time_sec", cs."team_id"
LIMIT 100;
```

**Explanation:**

- **Cumulative Scores (`cumulative_scores` CTE):**
  - We calculate the cumulative points for each team up to each event time using a window function.
  - The `COALESCE` function handles any `NULL` values in `"points_scored"` by treating them as zero.
  
- **Main Query:**
  - We join the `cumulative_scores` table with itself to get the opponent's cumulative points at the same game and elapsed time.
  - The join condition includes `cs."team_id" <> opponent."opponent_team_id"` to ensure we are matching against the opponent team.
  - The `score_delta` is calculated by subtracting the opponent's cumulative points from the team's cumulative points.

**Note:**

- This query assumes that both teams have events recorded at the same `"elapsed_time_sec"`. However, in reality, events for each team may not occur at the exact same times.
- To address this, we can modify the query to get the last known cumulative points of the opponent up to the current event time.

Here's an updated query that accounts for different event times using window functions:

```sql
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "shot_type",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
),
all_events AS (
  SELECT DISTINCT "game_id", "elapsed_time_sec"
  FROM cumulative_scores
),
team_scores AS (
  SELECT
    ae."game_id",
    ae."elapsed_time_sec",
    cs."team_id",
    cs."shot_type",
    LAST_VALUE(cs."team_cumulative_points") OVER (
      PARTITION BY cs."game_id", cs."team_id"
      ORDER BY cs."elapsed_time_sec"
      RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM all_events ae
  LEFT JOIN cumulative_scores cs
    ON ae."game_id" = cs."game_id" AND ae."elapsed_time_sec" = cs."elapsed_time_sec"
)
SELECT
  ts."game_id",
  ts."team_id",
  ts."shot_type",
  ts."elapsed_time_sec",
  ts."team_cumulative_points",
  opp."team_cumulative_points" AS "opponent_cumulative_points",
  ts."team_cumulative_points" - opp."team_cumulative_points" AS "score_delta"
FROM team_scores ts
JOIN team_scores opp
  ON ts."game_id" = opp."game_id"
  AND ts."elapsed_time_sec" = opp."elapsed_time_sec"
  AND ts."team_id" <> opp."team_id"
WHERE ts."team_cumulative_points" IS NOT NULL
ORDER BY ts."game_id", ts."elapsed_time_sec", ts."team_id"
LIMIT 100;
```

**Explanation of the Updated Query:**

- **`all_events` CTE:**
  - We create a list of all unique event times per game to ensure we consider every point in time where an event occurred.
  
- **`team_scores` CTE:**
  - For each game and elapsed time, we get the latest cumulative points for each team using the `LAST_VALUE` window function.
  - The `RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW` clause ensures we get the last known cumulative points up to the current event time.

- **Main Query:**
  - We join `team_scores` with itself to align each team's cumulative points with their opponent's cumulative points at each event time.
  - We calculate the `score_delta` as before.

**Calculating Averages for Score Delta Intervals:**

Now, we can use the computed `score_delta` to categorize into intervals and calculate the required averages:

```sql
WITH cumulative_scores AS (
  -- Same as before
),
all_events AS (
  -- Same as before
),
team_scores AS (
  -- Same as before
),
score_deltas AS (
  SELECT
    ts."game_id",
    ts."team_id",
    ts."shot_type",
    ts."elapsed_time_sec",
    ts."team_cumulative_points",
    opp."team_cumulative_points" AS "opponent_cumulative_points",
    ts."team_cumulative_points" - opp."team_cumulative_points" AS "score_delta"
  FROM team_scores ts
  JOIN team_scores opp
    ON ts."game_id" = opp."game_id"
    AND ts."elapsed_time_sec" = opp."elapsed_time_sec"
    AND ts."team_id" <> opp."team_id"
  WHERE ts."team_cumulative_points" IS NOT NULL
),
categorized_scores AS (
  SELECT
    "game_id",
    "team_id",
    "shot_type",
    "score_delta",
    CASE
      WHEN "score_delta" < -20 THEN '<-20'
      WHEN "score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN "score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN "score_delta" = 0 THEN '0'
      WHEN "score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN "score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN "score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM score_deltas
)
SELECT
  "shot_type",
  "score_delta_interval",
  AVG("event_coord_x") AS "avg_x",
  AVG("event_coord_y") AS "avg_y",
  COUNT(*) AS "attempts",
  SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
JOIN categorized_scores cs
  ON pbp."game_id" = cs."game_id"
  AND pbp."team_id" = cs."team_id"
  AND pbp."shot_type" = cs."shot_type"
WHERE pbp."event_type" IN (
    'twopointmade', 'twopointmiss',
    'threepointmade', 'threepointmiss'
  )
  AND pbp."scheduled_date" < '2018-03-15'
  AND (
    ("team_basket" = 'left' AND "event_coord_x" < 564) OR
    ("team_basket" = 'right' AND "event_coord_x" >= 564)
  )
GROUP BY "shot_type", "score_delta_interval"
ORDER BY "shot_type", "score_delta_interval"
LIMIT 100;
```

**Explanation:**

- **`categorized_scores` CTE:**
  - We categorize the `score_delta` into the specified intervals.

- **Main Query:**
  - We join the play-by-play table `MBB_PBP_SR` with the `categorized_scores` to associate each shot with its score delta interval.
  - We filter for events before March 15, 2018.
  - The condition for the correct side of the court ensures we're only considering shots taken on the correct basket side.
    - If the team's basket is 'left', we only consider shots where `"event_coord_x" < 564`.
    - If the team's basket is 'right', we consider shots where `"event_coord_x" >= 564`.
  - We calculate:
    - Average X and Y coordinates.
    - Total number of shot attempts (`COUNT(*)`).
    - Total number of successful shots (`SUM` with a condition on `"shot_made"`).

**Final Output:**

The query will produce a table with the following columns:

- **"shot_type"**: Type of the shot (e.g., 'jump shot', 'layup').
- **"score_delta_interval"**: Interval category of the score delta.
- **"avg_x"**: Average X coordinate of shots in this category.
- **"avg_y"**: Average Y coordinate of shots in this category.
- **"attempts"**: Average number of shot attempts.
- **"successful_shots"**: Average number of successful shots.

**Note:**

- Since we are grouping by `"shot_type"` and `"score_delta_interval"`, the query will compute the averages for each combination.
- The `LIMIT 100` ensures that we get up to 100 rows in the result.

---

**Summary:**

- We corrected the initial SQL by removing the invalid `"opponent_id"` reference.
- We used window functions and joins to compute the opponent's cumulative points.
- We categorized the score deltas into intervals.
- We calculated the average coordinates, number of attempts, and successful shots for each shot type and score delta interval.
  
This should fulfill the original task and provide the required analysis.
2025-01-26 17:51:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:51:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:51:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:51:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:51:37 - snowflake.connector.connection - INFO - closed
2025-01-26 17:51:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:52:43 - root - INFO - SQL:
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "shot_type",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
)

SELECT
  cs."game_id",
  cs."shot_type",
  cs."team_id",
  cs."elapsed_time_sec",
  cs."team_cumulative_points",
  cs."team_cumulative_points" - opponent."team_cumulative_points" AS "score_delta"
FROM cumulative_scores cs
JOIN (
  SELECT
    "game_id",
    "elapsed_time_sec",
    "team_id" AS "opponent_team_id",
    "team_cumulative_points"
  FROM cumulative_scores
) opponent
ON cs."game_id" = opponent."game_id"
  AND cs."elapsed_time_sec" = opponent."elapsed_time_sec"
  AND cs."team_id" <> opponent."opponent_team_id"
ORDER BY cs."game_id", cs."elapsed_time_sec", cs."team_id"
LIMIT 100;
Results:
Too long, hard cut:
game_id,shot_type,team_id,elapsed_time_sec,team_cumulative_points,score_delta
0013581b-1b6f-4851-9bd5-4a6f91294537,layup,2a997096-a381-469d-a7e9-9e031c8b071c,660,6.0,-19.0
0013581b-1b6f-4851-9bd5-4a6f91294537,jump shot,509aacc4-c121-46a2-800a-d5431ef181d2,660,25.0,19.0
00323329-7205-46c6-9add-26d1422d4b73,jump shot,8ab00d43-840a-4c96-bdee-bf88fa6e3f11,190,4.0,4.0
00323329-7205-46c6-9add-26d1422d4b73,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,190,0.0,-4.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,jump shot,5f9a90a2-3926-404e-8c8a-d9f22ad6907d,2050,32.0,-19.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,jump shot,d203f38a-a166-4258-bca2-e161b591ecfb,2050,51.0,19.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,668,12.0,-11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,668,23.0,11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,1908,38.0,-22.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,1908,60.0,22.0
005788bc-1e7a-421e-bda6-d5e97dcce486,jump shot,054c3e85-0552-4549-b123-7e84af6e7b6c,233,4.0,-4.0
005788bc-1e7a-421e-bda6-d5e97dcce486,layup,612f7f66-1de1-4d42-b842-9a508daab911,233,8.0,4.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,683ab61f-546f-44da-b085-c3a5740554aa,1346,25.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,683ab61f-546f-44da-b085-c3a5740554aa,1346,25.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,1346,40.0,15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,1346,40.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,jump shot,8736b67f-5924-400b-bf94-3bd804c36600,832,27.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,jump shot,c1f4aae1-aa16-4095-aeab-10e5c2a1236a,832,12.0,-15.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,layup,0d037a5d-827a-44dd-8b70-57603d671d5d,467,12.0,-1.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,jump shot,3a000455-de7c-4ca8-880e-abdce7f21da9,467,13.0,1.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,jump shot,68d2aa5b-714f-4652-96f3-b71e1752413f,2233,58.0,-6.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,tip shot,6ef40534-5fad-4755-84de-7dcbd645d1f0,2233,64.0,6.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,layup,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,170,6.0,4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,layup,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,170,6.0,2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,layup,faeb1160-5d15-4f26-99fc-c441cf21fc7f,170,4.0,-2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,jump shot,faeb1160-5d15-4f26-99fc-c441cf21fc7f,170,2.0,-4.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,jump shot,8598d1b6-106b-4083-a512-2e495729525a,256,0.0,-5.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,layup,a17dfc54-415f-49c3-a2e6-d6fa9db18b0a,256,5.0,5.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,,55af9c69-3675-4b9b-a882-96640b782fff,1271,30.0,0.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,,b03bb029-4499-4a2c-9074-5071ed360b21,1271,30.0,0.0
00c2cbda-77bb-472a-8985-479067ae9286,jump shot,4b7dedc0-7b48-49a4-aad6-8a94a33274d2,1019,32.0,20.0
00c2cbda-77bb-472a-8985-479067ae9286,tip shot,fa416692-7e09-4f0a-9bcf-0cf7d5149a14,1019,12.0,-20.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,1551b3a0-6d10-4ffa-8dfa-73b56f004553,116,4.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,116,0.0,-4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,1551b3a0-6d10-4ffa-8dfa-73b56f004553,1122,23.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,1122,19.0,-4.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,dunk,324ccccc-575b-4b82-acb0-fbb8e68da13b,1811,46.0,-7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,1811,53.0,7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,324ccccc-575b-4b82-acb0-fbb8e68da13b,2265,55.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,324ccccc-575b-4b82-acb0-fbb8e68da13b,2265,55.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,2265,60.0,5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,2265,60.0,5.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,jump shot,3a000455-de7c-4ca8-880e-abdce7f21da9,658,21.0,12.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,layup,532d3874-b4b3-4c5c-acc6-749a6db26c8f,658,9.0,-12.0
00ebfaac-f8b0-4aa1-9473-b2c492898739,jump shot,1f99a164-d593

2025-01-26 17:52:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-26 17:52:44 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:44 - root - INFO - SQL:
-- Corrected Query 1: No changes needed
SELECT DISTINCT "shot_type"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Results:
shot_type
jump shot
layup
hook shot
dunk
""
tip shot

2025-01-26 17:52:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-26 17:52:46 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:46 - root - INFO - SQL:
-- Corrected Query 2: No changes needed
SELECT "shot_type", COUNT(*) AS "attempts"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
GROUP BY "shot_type"
LIMIT 100
Results:
shot_type,attempts
dunk,41997
jump shot,680076
layup,337805
hook shot,11015
,194962
tip shot,6117

2025-01-26 17:52:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 17:52:47 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:48 - root - INFO - SQL:
-- Corrected Query 3: No changes needed
SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Results:
avg_x,avg_y
563.7203539071614,288.3724201476133

2025-01-26 17:52:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:52:49 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:50 - root - INFO - SQL:
-- Corrected Query 4: No changes needed
SELECT "team_id", COUNT(*) AS "successful_shots"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'threepointmade')
GROUP BY "team_id"
LIMIT 100
Results:
team_id,successful_shots
a41d5a05-4c11-4171-a57e-e7a1ea325a6d,4869
b06b63b0-20e6-4c78-bdcf-5feac3d7995e,189
c2245a52-8d2e-4aaa-b42f-f22e0d629227,59
c3a808e6-2c5d-415f-9cd5-334148961392,19
e48e3dd5-721c-4d96-8ff4-790fe2597bfd,268
fa416692-7e09-4f0a-9bcf-0cf7d5149a14,3790
fd245a76-7ab5-41d4-9dd4-76bb82bc47bd,18
31ac98c4-4517-41f9-b113-ae604bea5678,30
4fbebf0a-e117-4a0c-8f15-c247535a2a1b,3777
11a617d5-af03-4cce-bc8a-51114d9e41fe,1277
6bff595c-32cb-4028-837c-c7de2a2107e6,540
912671c7-19fd-451b-813e-885485427820,244
701ab32b-ac60-4106-97a7-cf70a0a053f7,19
78434f3d-9b05-480c-b79f-4f228a0a155b,35
c206712f-2298-4279-b76c-834ac42809b9,327
f7575278-12ec-494a-b544-427c1759d43d,169
10f450ce-143b-4e46-8bfe-52c644b68b07,489
9bb49515-c2c8-44f8-8adf-d86a5d3bde11,19
6b0359b5-10a1-486f-916d-41e109edadcf,20
2b861694-22f4-4392-bd2a-8d272cfd44eb,23
1da70895-f77f-44ef-b216-d63c02e696eb,4879
2920c5fa-1e86-4958-a7c4-1e97b8e201d8,2186
600aad0e-85e7-4db8-be0b-94ba02a08e55,293
2f4d21f8-6d5f-48a5-abca-52a30583871a,4899
90ec10eb-38a4-4a69-b072-ef71d294933b,456
a3fef707-e4fc-48a0-82f1-f4ef01b76f45,492
aacdc78d-b7fa-48f6-9686-2fdb8a95030e,3940
aed211c3-23a4-4188-ad70-22c6eba7d765,1615
aef5e386-d8e8-460c-8014-3a2f090fd988,4195
dc3bc3bd-c463-4726-a099-e624e239f47b,16
e0ef0587-bd03-4590-b92d-b95e1f9b615b,43
e6914f16-ca37-4d2e-ba26-a425910283e2,3712
f2d01b77-0f5d-4574-9e49-2a3eaf822e44,386
23426c0b-1705-4dfb-a0e2-efdbdd8fd6f6,556
484dfa62-cc8c-46ac-a4ca-2e2b48391ddd,57
9e99d5a6-3522-4ab1-8c69-1350227496b8,26
778ef9d5-039f-4f00-bbb4-38661ca4f56f,20
48c7f9f3-f7e4-4c4a-b429-7995f9ee78c4,26
45439cdb-af7a-4743-936c-dccc76b30877,476
70e2bedd-3a0a-479c-ac99-e3f58aa6824b,3815
e52c9644-717a-46f4-bf16-aeca000b3b44,4017
82c12e8d-7c6c-47d8-b100-3cbc190d268e,301
9c396fa7-c165-4599-8542-158bd0d9a199,377
d52c3640-069c-4554-982e-e6537c8044f1,2547
dba620d9-7282-4638-bf05-13caf48eeed1,368
b4b87d2c-9af2-455b-adc1-4e484c078912,18
22fbe5dc-c6db-4675-b3a3-2d8af7f5d313,465
31aedd91-a77e-46c1-8bdc-80e9860c159d,391
508f503f-dc57-4f4c-a01e-4f195e5c05c8,517
56913910-87f7-4ad7-ae3b-5cd9fb218fd9,4256
e19cfc47-f23f-4c64-ba29-2e6d12dc45b2,298
fe406882-9f22-495e-9df6-ef357a6803c6,524
87d88c93-29bc-4306-b0a6-87c6f6e80da1,445
61dadefa-76bf-4db4-8067-f88df540b9cd,399
0dadedb0-2bd3-45e7-91a3-93af6c4e87f2,373
52df1e19-b142-4a76-a439-ad68455d0581,4238
2da57857-b038-4ad3-8199-e3fb339f57d2,543
324ccccc-575b-4b82-acb0-fbb8e68da13b,3948
350271fa-d620-4398-822c-72857291199f,43
161354af-1f3e-4d58-88f7-e016ec74b7b6,545
8967c7ec-141e-491f-a79d-9b62f7905efb,27
949c3398-85e4-4c63-ba71-9a82e06ddea4,265
c31455b2-8a45-4248-aa8f-ce7eab1c6b02,3117
ef13a371-76ed-409c-9aa6-35135183e170,357
f7dea397-0b96-4e96-812f-e454226b5925,19
ad925b0b-8411-41de-81df-212482545581,17
b18d3456-8403-4101-987a-e1f887735478,22
38fa68fb-ac54-4e62-84cb-c3dafc34fe09,22
9febd5fa-982f-4f40-ad1d-8e49be96cf4f,458
5ef64f01-86ae-4553-9834-c79cc0859eaf,705
0a50907c-0141-4d40-81e7-d1652b307838,32
500d7223-ecff-494b-9539-28427156c783,501
683ab61f-546f-44da-b085-c3a5740554aa,4069
0c0608b3-f349-4f5e-9a10-7e6a744dd0d2,3490
e033de6e-06c8-4bf0-9470-1b1795becf56,24
eb157f98-0697-459c-9293-ddb162ceb28b,975
f8b1bf00-5b73-4ac4-98c0-ec554027ae32,3395
ad9fce12-6b1a-400c-bcbe-29d84d065fc0,513
1753768d-e46e-40b1-8d69-a8ae5cccec03,334
1dc13b18-f9b3-4bb9-b1cf-979fcd8c2b6f,353
63cad858-8654-4956-8438-8fe79cd1208a,539
4927ef8b-e680-4fb8-b10e-2ea3eff32eab,249
26eaeb27-2fc4-4c9f-93b2-27f6afe39071,16
61db8108-45f1-43e5-ade8-83278324bc7d,25
224e3b21-30e7-4a05-9e8c-62721d581db8,2089
56fe0ab2-e4f0-47b9-8726-9ce23ebcde20,649
68a3227f-677f-43b0-9a3a-cad79d0df9e2,2951
0113eea0-c943-4fff-9780-ae0fb099e7ef,270
0d8a328f-20ce-410b-bed1-15fc01308aaf,4745
6e8f97e0-911d-4fd1-b9da-7fd57ab26729,27
df3da9d7-2d2b-44e2-99e2-08c4945a203b,757
72971b77-1d35-40b3-bb63-4c5b29f3d22b,3557
175d34a7-3823-4e4f-9f11-2464f55360b8,447
532d3874-b4b3-4c5c-acc6-749a6db26c8f,3459
cb732075-23a5-4e71-9037-50a7a002bdb2,445
d3c8a767-b6fc-45d4-a5f2-18406f2993f1,4266
de46a033-8750-4828-90cc-b25350d0fb15,18
ef184799-d79b-49d9-a662-991eaf4044cd,4131
fe037cba-25d9-42f5-a461-61d7102c17de,356
5fe4a398-1699-4442-a364-305b2f0ac01e,606

2025-01-26 17:52:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:52:51 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:51 - root - INFO - SQL:
-- Corrected Query 5: Added COALESCE to handle NULL values in "points_scored"
SELECT
  "game_id",
  "team_id",
  "elapsed_time_sec",
  SUM(COALESCE("points_scored", 0)) OVER (
    PARTITION BY "game_id", "team_id"
    ORDER BY "elapsed_time_sec"
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  ) AS "cumulative_points"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN (
  'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
)
LIMIT 100
Results:
Too long, hard cut:
game_id,team_id,elapsed_time_sec,cumulative_points
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,19,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,76,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,127,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,154,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,190,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,257,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,276,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,319,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,363,5.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,411,5.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,428,5.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,433,7.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,527,9.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,550,9.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,554,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,596,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,645,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,724,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,757,13.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,788,13.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,809,16.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,854,18.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,895,21.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,951,24.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1001,24.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1025,26.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1063,29.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1103,29.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1110,32.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1196,32.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1224,35.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1306,35.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1336,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1358,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1361,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1398,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1411,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1446,40.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1476,43.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1501,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1539,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1557,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1588,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1606,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1611,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1649,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1685,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1698,47.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1833,49.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1893,49.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1909,51.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1933,53.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1972,55.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2004,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2090,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2123,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2174,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2215,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2333,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e

2025-01-26 17:52:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:52:53 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:53 - root - INFO - SQL:
-- Corrected Query 6: Adjusted condition to include both 'left' and 'right' baskets
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
  AND (
    ("team_basket" = 'left' AND "event_coord_x" < 564) OR
    ("team_basket" = 'right' AND "event_coord_x" >= 564)
  )
LIMIT 100
Results:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:33,447,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,26ce70e0-395c-49dc-bc4c-a29c8f6e39bc,1522545300000000,Malik Newman misses two point layup,88.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:34,506,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,37617439-1421-47bb-ab37-9ef0f6b740b9,Marcus Garrett,0,b6e9792f-3623-421a-9508-a09846181106,1522545420000000,Marcus Garrett misses two point layup,99.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:06,534,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,6c25f209-bd61-4a1e-a239-f5996e77335b,Silvio De Sousa,22,c6b48e2d-5eee-48f3-9abd-603655af5174,1522545480000000,Silvio De Sousa misses two point layup,71.0,327.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,18:20,100,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,2783a8f1-e87e-41db-bd9e-495044d13d85,1522544400000000,Malik Newman misses two point jump shot,240.0,177.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:48,432,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,9b22a279-e1aa-4fbf-9db2-0123c78729ec,1522545300000000,Malik Newman misses two point jump shot,237.0,336.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,

2025-01-26 17:52:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:52:55 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:52:55 - root - INFO - SQL:
-- Corrected Query 7: Addressed the "opponent_id" issue and calculated "score_delta" correctly
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."elapsed_time_sec",
    cs1."team_id",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
)
SELECT
  "game_id",
  "elapsed_time_sec",
  "team_id",
  "team_cumulative_points",
  "opponent_cumulative_points",
  "score_delta"
FROM opponent_scores
ORDER BY "game_id", "elapsed_time_sec", "team_id"
LIMIT 100
Results:
Too long, hard cut:
game_id,elapsed_time_sec,team_id,team_cumulative_points,opponent_cumulative_points,score_delta
0013581b-1b6f-4851-9bd5-4a6f91294537,660,2a997096-a381-469d-a7e9-9e031c8b071c,6.0,25.0,-19.0
0013581b-1b6f-4851-9bd5-4a6f91294537,660,509aacc4-c121-46a2-800a-d5431ef181d2,25.0,6.0,19.0
00323329-7205-46c6-9add-26d1422d4b73,190,8ab00d43-840a-4c96-bdee-bf88fa6e3f11,4.0,0.0,4.0
00323329-7205-46c6-9add-26d1422d4b73,190,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,0.0,4.0,-4.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,5f9a90a2-3926-404e-8c8a-d9f22ad6907d,32.0,51.0,-19.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,d203f38a-a166-4258-bca2-e161b591ecfb,51.0,32.0,19.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,12.0,23.0,-11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,23.0,12.0,11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,38.0,60.0,-22.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,38.0,22.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,054c3e85-0552-4549-b123-7e84af6e7b6c,4.0,8.0,-4.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,612f7f66-1de1-4d42-b842-9a508daab911,8.0,4.0,4.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,8736b67f-5924-400b-bf94-3bd804c36600,27.0,12.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,c1f4aae1-aa16-4095-aeab-10e5c2a1236a,12.0,27.0,-15.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,0d037a5d-827a-44dd-8b70-57603d671d5d,12.0,13.0,-1.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,3a000455-de7c-4ca8-880e-abdce7f21da9,13.0,12.0,1.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,68d2aa5b-714f-4652-96f3-b71e1752413f,58.0,64.0,-6.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,6ef40534-5fad-4755-84de-7dcbd645d1f0,64.0,58.0,6.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,4.0,2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,2.0,4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,4.0,6.0,-2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,2.0,6.0,-4.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,8598d1b6-106b-4083-a512-2e495729525a,0.0,5.0,-5.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,a17dfc54-415f-49c3-a2e6-d6fa9db18b0a,5.0,0.0,5.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,55af9c69-3675-4b9b-a882-96640b782fff,30.0,30.0,0.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,b03bb029-4499-4a2c-9074-5071ed360b21,30.0,30.0,0.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,4b7dedc0-7b48-49a4-aad6-8a94a33274d2,32.0,12.0,20.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,fa416692-7e09-4f0a-9bcf-0cf7d5149a14,12.0,32.0,-20.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,1551b3a0-6d10-4ffa-8dfa-73b56f004553,4.0,0.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,0.0,4.0,-4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,1551b3a0-6d10-4ffa-8dfa-73b56f004553,23.0,19.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,19.0,23.0,-4.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,324ccccc-575b-4b82-acb0-fbb8e68da13b,46.0,53.0,-7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,53.0,46.0,7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,3a000455-de7c-4ca8-880e-abdce7f21da9,21.0,9.0,12.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,532d3874-b4b3-4c5c-acc6-749a6db26c8f,9.0,21.0,-12.0
00ebfaac-f8b0-4aa1-9473-b2c492898739,860,1f99a164-d593-4d81-85d5-0d7889d6f486,24.0,21.0,3.0
00ebfaac

2025-01-26 17:52:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:52:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:52:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:52:56 - snowflake.connector.connection - INFO - closed
2025-01-26 17:52:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:53:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:53:35 - root - INFO - The error occurred because the `"scheduled_date"` column in the `MBB_PBP_SR` table is stored as a numeric value representing microseconds since the Unix epoch (January 1, 1970). In the original query, we attempted to compare this numeric value directly to the string `'2018-03-15'`, which led to a type mismatch and the resulting error:

```
Numeric value '2018-03-15' is not recognized
```

To fix this, we need to convert the numeric `"scheduled_date"` to a proper timestamp before making the comparison. In Snowflake, we can use the `TO_TIMESTAMP_LTZ` function to convert microseconds since epoch to a timestamp. The function accepts a scale parameter that indicates the precision of the numeric value:

- **Scale of 6**: For microseconds (since we have 6 digits in microseconds)
- **Scale of 3**: For milliseconds

Given that the `"scheduled_date"` values are in microseconds, we should use a scale of **6**.

Here is the corrected SQL query:

```sql
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."team_id",
    cs1."elapsed_time_sec",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
),
categorized_scores AS (
  SELECT
    os."game_id",
    os."team_id",
    os."elapsed_time_sec",
    os."score_delta",
    CASE
      WHEN os."score_delta" < -20 THEN '<-20'
      WHEN os."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN os."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN os."score_delta" = 0 THEN '0'
      WHEN os."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN os."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN os."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM opponent_scores os
),
filtered_shots AS (
  SELECT
    pbp."game_id",
    pbp."team_id",
    pbp."shot_type",
    pbp."event_coord_x",
    pbp."event_coord_y",
    pbp."shot_made",
    cs."score_delta_interval"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  JOIN categorized_scores cs
    ON pbp."game_id" = cs."game_id"
    AND pbp."team_id" = cs."team_id"
    AND pbp."elapsed_time_sec" = cs."elapsed_time_sec"
  WHERE
    pbp."event_type" IN (
      'twopointmade', 'twopointmiss',
      'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date", 6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
)
SELECT
  "shot_type",
  "score_delta_interval",
  AVG("event_coord_x") AS "avg_x",
  AVG("event_coord_y") AS "avg_y",
  COUNT(*) AS "attempts",
  SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
FROM filtered_shots
GROUP BY "shot_type", "score_delta_interval"
ORDER BY "shot_type", "score_delta_interval"
LIMIT 100;
```

**Explanation of Changes:**

- **Converted `"scheduled_date"` to TIMESTAMP:**

  - In both the `cumulative_scores` CTE and the `filtered_shots` CTE, we replaced:
  
    ```sql
    "scheduled_date" < '2018-03-15'
    ```
  
    with:
  
    ```sql
    TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
    ```
  
  - This converts the numeric `"scheduled_date"` from microseconds since epoch to a TIMESTAMP with local time zone, which can then be compared to the date `'2018-03-15'`.

- **Consistency in Date Comparison:**

  - Ensured that date comparisons are done using proper date types to avoid type mismatch errors.

- **Overall Logic Remains the Same:**

  - The rest of the query remains unchanged, maintaining the original logic to compute cumulative scores, calculate the score delta, categorize the intervals, and compute the required averages.

---

This corrected query should execute without errors and provide the desired results.
2025-01-26 17:53:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:53:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:53:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:53:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 39
2025-01-26 17:53:37 - snowflake.connector.connection - INFO - closed
2025-01-26 17:53:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:54:30 - root - INFO - SQL:
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."team_id",
    cs1."elapsed_time_sec",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
),
categorized_scores AS (
  SELECT
    os."game_id",
    os."team_id",
    os."elapsed_time_sec",
    os."score_delta",
    CASE
      WHEN os."score_delta" < -20 THEN '<-20'
      WHEN os."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN os."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN os."score_delta" = 0 THEN '0'
      WHEN os."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN os."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN os."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM opponent_scores os
),
filtered_shots AS (
  SELECT
    pbp."game_id",
    pbp."team_id",
    pbp."shot_type",
    pbp."event_coord_x",
    pbp."event_coord_y",
    pbp."shot_made",
    cs."score_delta_interval"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  JOIN categorized_scores cs
    ON pbp."game_id" = cs."game_id"
    AND pbp."team_id" = cs."team_id"
    AND pbp."elapsed_time_sec" = cs."elapsed_time_sec"
  WHERE
    pbp."event_type" IN (
      'twopointmade', 'twopointmiss',
      'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date", 6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
)
SELECT
  "shot_type",
  "score_delta_interval",
  AVG("event_coord_x") AS "avg_x",
  AVG("event_coord_y") AS "avg_y",
  COUNT(*) AS "attempts",
  SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
FROM filtered_shots
GROUP BY "shot_type", "score_delta_interval"
ORDER BY "shot_type", "score_delta_interval"
LIMIT 100;
Results:
shot_type,score_delta_interval,avg_x,avg_y,attempts,successful_shots
dunk,-10 — -1,500.03968253968253,288.12698412698415,126,100
dunk,-20 — -11,764.0,303.64,25,19
dunk,0,547.8709677419355,293.80645161290323,31,27
dunk,1 — 10,544.636815920398,298.7014925373134,201,167
dunk,11 — 20,639.9154929577464,287.6619718309859,71,65
dunk,<-20,757.3,296.6,10,7
dunk,>20,311.1363636363636,297.45454545454544,22,17
hook shot,-10 — -1,468.4,278.0,5,2
hook shot,1 — 10,707.6666666666666,312.6666666666667,6,5
hook shot,11 — 20,571.0,274.5,2,1
hook shot,>20,147.0,280.0,4,2
jump shot,-10 — -1,578.6933333333334,269.21666666666664,2400,492
jump shot,-20 — -11,552.4134615384615,264.55929487179486,624,145
jump shot,0,561.3392504930966,287.31163708086785,507,119
jump shot,1 — 10,522.1742685025818,264.0576592082616,2324,828
jump shot,11 — 20,582.1556350626119,280.5921288014311,559,204
jump shot,<-20,634.189090909091,283.4109090909091,275,57
jump shot,>20,474.1125,257.6791666666667,240,93
layup,-10 — -1,582.0603504218041,292.8020765736535,1541,543
layup,-20 — -11,580.0645994832041,288.312661498708,387,136
layup,0,557.0917721518987,293.0822784810127,316,116
layup,1 — 10,535.2733077905492,291.73116219667946,1566,766
layup,11 — 20,554.8384955752213,294.00221238938053,452,252
layup,<-20,599.8522727272727,292.14204545454544,176,79
layup,>20,589.9030303030303,292.1454545454545,165,92
tip shot,-10 — -1,769.7017543859649,286.56140350877195,57,17
tip shot,-20 — -11,440.3636363636364,297.0,11,3
tip shot,0,373.7142857142857,304.42857142857144,7,4
tip shot,1 — 10,650.03125,290.5,32,18
tip shot,11 — 20,516.5555555555555,282.22222222222223,9,5
tip shot,<-20,561.0,286.5,2,1
tip shot,>20,1022.75,294.25,4,4
,-10 — -1,540.2486956521739,283.9,1150,264
,-20 — -11,525.3072463768116,289.495652173913,345,66
,0,568.109756097561,282.849593495935,246,81
,1 — 10,601.8634020618557,271.5455326460481,1164,458
,11 — 20,616.1189189189189,289.31891891891894,370,148
,<-20,576.5098039215686,296.91503267973854,153,24
,>20,561.9206349206349,273.96031746031747,126,57

2025-01-26 17:54:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:54:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:54:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:54:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-26 17:54:31 - snowflake.connector.connection - INFO - closed
2025-01-26 17:54:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:32 - root - INFO - SQL:
-- Corrected Query 2: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
SELECT "shot_type", COUNT(*) AS "attempts"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
GROUP BY "shot_type"
LIMIT 100
Results:
shot_type,attempts
layup,335298
jump shot,675175
,194962
dunk,41638
hook shot,10822
tip shot,6012

2025-01-26 17:54:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:54:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:54:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:54:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 17:54:33 - snowflake.connector.connection - INFO - closed
2025-01-26 17:54:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:33 - root - INFO - SQL:
-- Corrected Query 3: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
LIMIT 100
Results:
avg_x,avg_y
563.6674177767826,288.375243589916

2025-01-26 17:54:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:54:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:54:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:54:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:54:35 - snowflake.connector.connection - INFO - closed
2025-01-26 17:54:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:35 - root - INFO - SQL:
-- Corrected Query 5: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
SELECT
  "game_id",
  "team_id",
  "elapsed_time_sec",
  SUM(COALESCE("points_scored", 0)) OVER (
    PARTITION BY "game_id", "team_id"
    ORDER BY "elapsed_time_sec"
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  ) AS "cumulative_points"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
LIMIT 100
Results:
Too long, hard cut:
game_id,team_id,elapsed_time_sec,cumulative_points
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,34,0.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,38,2.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,97,2.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,122,2.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,185,5.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,223,8.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,260,8.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,361,8.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,400,10.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,433,13.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,493,13.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,527,16.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,573,16.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,611,18.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,731,20.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,816,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,853,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,887,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,957,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,997,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1089,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1116,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1131,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1198,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1219,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1300,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1310,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1319,27.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1382,27.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1471,29.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1515,31.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1548,33.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1763,33.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1794,33.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1804,36.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1845,36.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1880,36.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1958,39.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2005,41.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2037,41.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2045,41.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2071,43.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2097,46.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2140,46.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2149,46.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2173,48.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2199,48.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2254,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2372,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2381,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2390,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2398,53.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,28,3.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,54,3.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,82,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,118,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,179,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,213,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,259,8.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778

2025-01-26 17:54:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:54:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:54:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:54:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:54:37 - snowflake.connector.connection - INFO - closed
2025-01-26 17:54:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:37 - root - INFO - SQL:
-- Corrected Query 6: Added TO_TIMESTAMP_LTZ if date filtering is needed
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'  -- Include if date filtering is required
  AND (
    ("team_basket" = 'left' AND "event_coord_x" < 564) OR
    ("team_basket" = 'right' AND "event_coord_x" >= 564)
  )
LIMIT 100
Results:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
c0e7cc4d-1174-486b-8e01-bc6012ca2134,1517496492093594,2013,closed,1384822800000000,a48ecb87-3324-4b79-846e-a51d1c16d423,Coleman Coliseum,Tuscaloosa,AL,323 Paul W Bryant Dr ,35487,USA,15383.0,9903,False,False,,,,,Stillman,Tigers,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,Alabama,Crimson Tide,c2104cdc-c83d-40d2-a3cd-df986e29f5d3,ALA,Southeastern,SEC,NCAA Division I,D1,NCAA MEN,2,2:09,2271,,Tigers,Stillman,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,left,,3f2841ac-176e-42db-b604-5b75d489e783,Justin Harris,12,4b23df72-ad8f-4e93-8857-29bf113eaf64,1384829359000000,Justin Harris misses three point shot,345.0,279.0,threepointmiss,fieldgoal,False,,,True,,,,
c0e7cc4d-1174-486b-8e01-bc6012ca2134,1517496492093594,2013,closed,1384822800000000,a48ecb87-3324-4b79-846e-a51d1c16d423,Coleman Coliseum,Tuscaloosa,AL,323 Paul W Bryant Dr ,35487,USA,15383.0,9903,False,False,,,,,Stillman,Tigers,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,Alabama,Crimson Tide,c2104cdc-c83d-40d2-a3cd-df986e29f5d3,ALA,Southeastern,SEC,NCAA Division I,D1,NCAA MEN,1,4:45,915,,Tigers,Stillman,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,right,c2104cdc-c83d-40d2-a3cd-df986e29f5d3,ed363926-f232-436f-a8ca-6b1dc7f9a999,Stanley Magee,22,f4a67a1b-0129-4500-9321-f7b1bfc2d30b,1384825214000000,Stanley Magee makes two point shot ,1020.0,288.0,twopointmade,fieldgoal,True,,,False,2.0,,,
7ffb3ec0-4268-469e-ad1a-340996ec5da5,1517496331930195,2014,closed,1425747600000000,5f1a51e1-bdd9-43a2-8743-c37f20265346,PNC Arena,Raleigh,NC,1400 Edward Mill Rd,27607,USA,19722.0,18659,,,,,,,Syracuse,Orange,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,North Carolina State,Wolfpack,52df1e19-b142-4a76-a439-ad68455d0581,NCST,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,2,2:30,2250,,Orange,Syracuse,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,left,,333cbd0d-159e-413f-b355-96a2a03f076f,Trevor Cooney,10,de951fbe-2c1f-4b3f-9c41-f6cd5f4f045e,1425754793000000,Trevor Cooney misses three point jump shot,261.0,125.0,threepointmiss,fieldgoal,False,jump shot,,True,,,,
1046ee1e-c20b-433c-a7e1-dc8361bcd92f,1517485986342728,2016,closed,1485993600000000,5f1a51e1-bdd9-43a2-8743-c37f20265346,PNC Arena,Raleigh,NC,1400 Edward Mill Rd,27607,USA,19722.0,16346,False,True,,,,,Syracuse,Orange,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,North Carolina State,Wolfpack,52df1e19-b142-4a76-a439-ad68455d0581,NCST,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,1,2:16,1064,52df1e19-b142-4a76-a439-ad68455d0581,Orange,Syracuse,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,right,52df1e19-b142-4a76-a439-ad68455d0581,1e6903f5-6490-4788-8dea-5fe8f1113f71,Tyler Lydon,20,56eb2304-767f-4e63-8739-b02f6c0b14bc,1485995985000000,Tyler Lydon makes three point jump shot,770.0,322.0,threepointmade,fieldgoal,True,jump shot,,True,3.0,,,
7ffb3ec0-4268-469e-ad1a-340996ec5da5,1517496331930195,2014,closed,1425747600000000,5f1a51e1-bdd9-43a2-8743-c37f20265346,PNC Arena,Raleigh,NC,1400 Edward Mill Rd,27607,USA,19722.0,18659,,,,,,,Syracuse,Orange,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,North Carolina State,Wolfpack,52df1e19-b142-4a76-a439-ad68455d0581,NCST,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,1,5:33,867,,Orange,Syracuse,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,right,,08d0ed3c-6068-40f4-9d80-07fa4404f862,Tyler Roberson,21,73532723-f534-4e2d-b4c5-0950e4321a9b,1425749940000000,Beejay Anya blocks Tyler Roberson's two point layup,1007.0,348.0,twopointmiss,fieldgoal,False,layup,,False,,,,
1046ee1e-c20b-433c-a7e1-dc8361bcd92f,1517485986342728,2016,closed,1485993600000

2025-01-26 17:54:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:54:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:54:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:54:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:54:39 - snowflake.connector.connection - INFO - closed
2025-01-26 17:54:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:40 - root - INFO - SQL:
-- Corrected Query 7: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."elapsed_time_sec",
    cs1."team_id",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
)
SELECT
  "game_id",
  "elapsed_time_sec",
  "team_id",
  "team_cumulative_points",
  "opponent_cumulative_points",
  "score_delta"
FROM opponent_scores
ORDER BY "game_id", "elapsed_time_sec", "team_id"
LIMIT 100
Results:
Too long, hard cut:
game_id,elapsed_time_sec,team_id,team_cumulative_points,opponent_cumulative_points,score_delta
0013581b-1b6f-4851-9bd5-4a6f91294537,660,2a997096-a381-469d-a7e9-9e031c8b071c,6.0,25.0,-19.0
0013581b-1b6f-4851-9bd5-4a6f91294537,660,509aacc4-c121-46a2-800a-d5431ef181d2,25.0,6.0,19.0
00323329-7205-46c6-9add-26d1422d4b73,190,8ab00d43-840a-4c96-bdee-bf88fa6e3f11,4.0,0.0,4.0
00323329-7205-46c6-9add-26d1422d4b73,190,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,0.0,4.0,-4.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,5f9a90a2-3926-404e-8c8a-d9f22ad6907d,32.0,51.0,-19.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,d203f38a-a166-4258-bca2-e161b591ecfb,51.0,32.0,19.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,12.0,23.0,-11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,23.0,12.0,11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,38.0,60.0,-22.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,38.0,22.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,054c3e85-0552-4549-b123-7e84af6e7b6c,4.0,8.0,-4.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,612f7f66-1de1-4d42-b842-9a508daab911,8.0,4.0,4.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,8736b67f-5924-400b-bf94-3bd804c36600,27.0,12.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,c1f4aae1-aa16-4095-aeab-10e5c2a1236a,12.0,27.0,-15.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,0d037a5d-827a-44dd-8b70-57603d671d5d,12.0,13.0,-1.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,3a000455-de7c-4ca8-880e-abdce7f21da9,13.0,12.0,1.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,68d2aa5b-714f-4652-96f3-b71e1752413f,58.0,64.0,-6.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,6ef40534-5fad-4755-84de-7dcbd645d1f0,64.0,58.0,6.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,4.0,2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,2.0,4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,2.0,6.0,-4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,4.0,6.0,-2.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,8598d1b6-106b-4083-a512-2e495729525a,0.0,5.0,-5.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,a17dfc54-415f-49c3-a2e6-d6fa9db18b0a,5.0,0.0,5.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,55af9c69-3675-4b9b-a882-96640b782fff,30.0,30.0,0.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,b03bb029-4499-4a2c-9074-5071ed360b21,30.0,30.0,0.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,4b7dedc0-7b48-49a4-aad6-8a94a33274d2,32.0,12.0,20.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,fa416692-7e09-4f0a-9bcf-0cf7d5149a14,12.0,32.0,-20.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,1551b3a0-6d10-4ffa-8dfa-73b56f004553,4.0,0.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,0.0,4.0,-4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,1551b3a0-6d10-4ffa-8dfa-73b56f004553,23.0,19.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,19.0,23.0,-4.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,324ccccc-575b-4b82-acb0-fbb8e68da13b,46.0,53.0,-7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,53.0,46.0,7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,3a000455-de7c-4ca8-880e-abdce7f21da9,21.0,9.0,12.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,532d3874-b4b3-4c5c-acc6-749a6db26c8f,9.0,21.0,-12.0
00ebfaac-f8b0-4aa1-9473-b2c492898739,860,1f99a164-d593-4d81-85d5-0d7889d6f486,24.0,21.0,3.0
00ebfaac

2025-01-26 17:54:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:54:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:54:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:54:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 39
2025-01-26 17:54:42 - snowflake.connector.connection - INFO - closed
2025-01-26 17:54:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:54:42 - root - INFO - SQL:
-- Corrected Query 8: Included the corrected date conversion
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."team_id",
    cs1."elapsed_time_sec",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
),
categorized_scores AS (
  SELECT
    os."game_id",
    os."team_id",
    os."elapsed_time_sec",
    os."score_delta",
    CASE
      WHEN os."score_delta" < -20 THEN '<-20'
      WHEN os."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN os."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN os."score_delta" = 0 THEN '0'
      WHEN os."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN os."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN os."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM opponent_scores os
),
filtered_shots AS (
  SELECT
    pbp."game_id",
    pbp."team_id",
    pbp."shot_type",
    pbp."event_coord_x",
    pbp."event_coord_y",
    pbp."shot_made",
    cs."score_delta_interval"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  JOIN categorized_scores cs
    ON pbp."game_id" = cs."game_id"
    AND pbp."team_id" = cs."team_id"
    AND pbp."elapsed_time_sec" = cs."elapsed_time_sec"
  WHERE
    pbp."event_type" IN (
      'twopointmade', 'twopointmiss',
      'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date", 6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
)
SELECT
  "shot_type",
  "score_delta_interval",
  AVG("event_coord_x") AS "avg_x",
  AVG("event_coord_y") AS "avg_y",
  COUNT(*) AS "attempts",
  SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
FROM filtered_shots
GROUP BY "shot_type", "score_delta_interval"
ORDER BY "shot_type", "score_delta_interval"
LIMIT 100
Results:
shot_type,score_delta_interval,avg_x,avg_y,attempts,successful_shots
dunk,-10 — -1,496.136,287.944,125,100
dunk,-20 — -11,764.0,303.64,25,19
dunk,0,562.6176470588235,295.29411764705884,34,29
dunk,1 — 10,548.7969543147208,298.56852791878174,197,163
dunk,11 — 20,625.1506849315068,288.0,73,67
dunk,<-20,757.3,296.6,10,7
dunk,>20,311.1363636363636,297.45454545454544,22,17
hook shot,-10 — -1,468.4,278.0,5,2
hook shot,1 — 10,707.6666666666666,312.6666666666667,6,5
hook shot,11 — 20,571.0,274.5,2,1
hook shot,>20,147.0,280.0,4,2
jump shot,-10 — -1,580.5336436732966,267.93694456199745,2363,483
jump shot,-20 — -11,555.180817610063,263.84591194968556,636,149
jump shot,0,568.7423076923077,294.2096153846154,520,114
jump shot,1 — 10,518.2226042114311,263.7645036527718,2327,831
jump shot,11 — 20,581.6302816901408,280.49295774647885,568,211
jump shot,<-20,634.9890909090909,283.6218181818182,275,58
jump shot,>20,474.09166666666664,258.95,240,92
layup,-10 — -1,588.4039087947883,292.5817589576547,1535,540
layup,-20 — -11,570.2342569269522,288.64987405541564,397,142
layup,0,580.4448051948052,293.41883116883116,308,115
layup,1 — 10,526.9187460012796,291.7613563659629,1563,760
layup,11 — 20,555.6017316017316,294.2294372294372,462,259
layup,<-20,595.1896551724138,291.9425287356322,174,77
layup,>20,592.859756097561,292.2256097560976,164,91
tip shot,-10 — -1,758.3103448275862,287.8103448275862,58,18
tip shot,-20 — -11,440.3636363636364,297.0,11,3
tip shot,0,417.8333333333333,295.3333333333333,6,3
tip shot,1 — 10,650.03125,290.5,32,18
tip shot,11 — 20,516.5555555555555,282.22222222222223,9,5
tip shot,<-20,561.0,286.5,2,1
tip shot,>20,1022.75,294.25,4,4
,-10 — -1,541.8217993079585,283.6643598615917,1156,264
,-20 — -11,525.163323782235,289.5587392550143,349,67
,0,552.7285067873303,286.7420814479638,221,77
,1 — 10,603.0256191289496,271.47566182749785,1171,457
,11 — 20,616.0873015873016,287.9074074074074,378,152
,<-20,576.5098039215686,296.91503267973854,153,24
,>20,561.9206349206349,273.96031746031747,126,57

2025-01-26 17:54:42 - root - INFO - itercount: 0
2025-01-26 17:54:42 - root - INFO - Database Name: NCAA_BASKETBALL
Schema Name: NCAA_BASKETBALL
DDL describes table information.
,0
table_name,MBB_GAMES_SR
description,
DDL,"create or replace TABLE MBB_GAMES_SR (
	""game_id"" VARCHAR(16777216),
	""season"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""coverage"" VARCHAR(16777216),
	""neutral_site"" BOOLEAN,
	""scheduled_date"" DATE,
	""gametime"" NUMBER(38,0),
	""conference_game"" BOOLEAN,
	""tournament"" VARCHAR(16777216),
	""tournament_type"" VARCHAR(16777216),
	""tournament_round"" VARCHAR(16777216),
	""tournament_game_no"" VARCHAR(16777216),
	""attendance"" NUMBER(38,0),
	""lead_changes"" NUMBER(38,0),
	""times_tied"" NUMBER(38,0),
	""periods"" NUMBER(38,0),
	""possession_arrow"" VARCHAR(16777216),
	""venue_id"" VARCHAR(16777216),
	""venue_city"" VARCHAR(16777216),
	""venue_state"" VARCHAR(16777216),
	""venue_address"" VARCHAR(16777216),
	""venue_zip"" VARCHAR(16777216),
	""venue_country"" VARCHAR(16777216),
	""venue_name"" VARCHAR(16777216),
	""venue_capacity"" NUMBER(38,0),
	""h_name"" VARCHAR(16777216),
	""h_market"" VARCHAR(16777216),
	""h_id"" VARCHAR(16777216),
	""h_alias"" VARCHAR(16777216),
	""h_league_id"" VARCHAR(16777216),
	""h_league_name"" VARCHAR(16777216),
	""h_league_alias"" VARCHAR(16777216),
	""h_conf_id"" VARCHAR(16777216),
	""h_conf_name"" VARCHAR(16777216),
	""h_conf_alias"" VARCHAR(16777216),
	""h_division_id"" VARCHAR(16777216),
	""h_division_name"" VARCHAR(16777216),
	""h_division_alias"" VARCHAR(16777216),
	""h_logo_large"" VARCHAR(16777216),
	""h_logo_medium"" VARCHAR(16777216),
	""h_logo_small"" VARCHAR(16777216),
	""h_points_game"" NUMBER(38,0),
	""h_rank"" NUMBER(38,0),
	""h_minutes"" VARCHAR(16777216),
	""h_field_goals_made"" NUMBER(38,0),
	""h_field_goals_att"" NUMBER(38,0),
	""h_field_goals_pct"" FLOAT,
	""h_three_points_made"" NUMBER(38,0),
	""h_three_points_att"" NUMBER(38,0),
	""h_three_points_pct"" FLOAT,
	""h_two_points_made"" NUMBER(38,0),
	""h_two_points_att"" NUMBER(38,0),
	""h_two_points_pct"" FLOAT,
	""h_blocked_att"" NUMBER(38,0),
	""h_free_throws_made"" NUMBER(38,0),
	""h_free_throws_att"" NUMBER(38,0),
	""h_free_throws_pct"" FLOAT,
	""h_offensive_rebounds"" NUMBER(38,0),
	""h_defensive_rebounds"" NUMBER(38,0),
	""h_rebounds"" NUMBER(38,0),
	""h_assists"" NUMBER(38,0),
	""h_turnovers"" NUMBER(38,0),
	""h_steals"" NUMBER(38,0),
	""h_blocks"" NUMBER(38,0),
	""h_assists_turnover_ratio"" FLOAT,
	""h_personal_fouls"" NUMBER(38,0),
	""h_ejections"" NUMBER(38,0),
	""h_foulouts"" NUMBER(38,0),
	""h_points"" NUMBER(38,0),
	""h_fast_break_pts"" NUMBER(38,0),
	""h_second_chance_pts"" NUMBER(38,0),
	""h_team_turnovers"" NUMBER(38,0),
	""h_points_off_turnovers"" NUMBER(38,0),
	""h_team_rebounds"" NUMBER(38,0),
	""h_flagrant_fouls"" NUMBER(38,0),
	""h_player_tech_fouls"" NUMBER(38,0),
	""h_team_tech_fouls"" NUMBER(38,0),
	""h_coach_tech_fouls"" NUMBER(38,0),
	""a_name"" VARCHAR(16777216),
	""a_market"" VARCHAR(16777216),
	""a_id"" VARCHAR(16777216),
	""a_alias"" VARCHAR(16777216),
	""a_league_id"" VARCHAR(16777216),
	""a_league_name"" VARCHAR(16777216),
	""a_league_alias"" VARCHAR(16777216),
	""a_conf_id"" VARCHAR(16777216),
	""a_conf_name"" VARCHAR(16777216),
	""a_conf_alias"" VARCHAR(16777216),
	""a_division_id"" VARCHAR(16777216),
	""a_division_name"" VARCHAR(16777216),
	""a_division_alias"" VARCHAR(16777216),
	""a_logo_large"" VARCHAR(16777216),
	""a_logo_medium"" VARCHAR(16777216),
	""a_logo_small"" VARCHAR(16777216),
	""a_points_game"" NUMBER(38,0),
	""a_rank"" NUMBER(38,0),
	""a_minutes"" VARCHAR(16777216),
	""a_field_goals_made"" NUMBER(38,0),
	""a_field_goals_att"" NUMBER(38,0),
	""a_field_goals_pct"" FLOAT,
	""a_three_points_made"" NUMBER(38,0),
	""a_three_points_att"" NUMBER(38,0),
	""a_three_points_pct"" FLOAT,
	""a_two_points_made"" NUMBER(38,0),
	""a_two_points_att"" NUMBER(38,0),
	""a_two_points_pct"" FLOAT,
	""a_blocked_att"" NUMBER(38,0),
	""a_free_throws_made"" NUMBER(38,0),
	""a_free_throws_att"" NUMBER(38,0),
	""a_free_throws_pct"" FLOAT,
	""a_offensive_rebounds"" NUMBER(38,0),
	""a_defensive_rebounds"" NUMBER(38,0),
	""a_rebounds"" NUMBER(38,0),
	""a_assists"" NUMBER(38,0),
	""a_turnovers"" NUMBER(38,0),
	""a_steals"" NUMBER(38,0),
	""a_blocks"" NUMBER(38,0),
	""a_assists_turnover_ratio"" FLOAT,
	""a_personal_fouls"" NUMBER(38,0),
	""a_ejections"" NUMBER(38,0),
	""a_foulouts"" NUMBER(38,0),
	""a_points"" NUMBER(38,0),
	""a_fast_break_pts"" NUMBER(38,0),
	""a_second_chance_pts"" NUMBER(38,0),
	""a_team_turnovers"" NUMBER(38,0),
	""a_points_off_turnovers"" NUMBER(38,0),
	""a_team_rebounds"" NUMBER(38,0),
	""a_flagrant_fouls"" NUMBER(38,0),
	""a_player_tech_fouls"" NUMBER(38,0),
	""a_team_tech_fouls"" NUMBER(38,0),
	""a_coach_tech_fouls"" NUMBER(38,0),
	""created"" NUMBER(38,0)
);"

,1
table_name,MBB_HISTORICAL_TOURNAMENT_GAMES
description,
DDL,"create or replace TABLE MBB_HISTORICAL_TOURNAMENT_GAMES (
	""season"" NUMBER(38,0),
	""round"" NUMBER(38,0),
	""days_from_epoch"" NUMBER(38,0),
	""game_date"" DATE,
	""day"" VARCHAR(16777216),
	""win_seed"" VARCHAR(16777216),
	""win_region"" VARCHAR(16777216),
	""win_market"" VARCHAR(16777216),
	""win_name"" VARCHAR(16777216),
	""win_alias"" VARCHAR(16777216),
	""win_team_id"" VARCHAR(16777216),
	""win_school_ncaa"" VARCHAR(16777216),
	""win_code_ncaa"" NUMBER(38,0),
	""win_kaggle_team_id"" NUMBER(38,0),
	""win_pts"" NUMBER(38,0),
	""lose_seed"" VARCHAR(16777216),
	""lose_region"" VARCHAR(16777216),
	""lose_market"" VARCHAR(16777216),
	""lose_name"" VARCHAR(16777216),
	""lose_alias"" VARCHAR(16777216),
	""lose_team_id"" VARCHAR(16777216),
	""lose_school_ncaa"" VARCHAR(16777216),
	""lose_code_ncaa"" NUMBER(38,0),
	""lose_kaggle_team_id"" NUMBER(38,0),
	""lose_pts"" NUMBER(38,0),
	""num_ot"" NUMBER(38,0),
	""academic_year"" NUMBER(38,0)
);"

,2
table_name,MBB_HISTORICAL_TEAMS_GAMES
description,
DDL,"create or replace TABLE MBB_HISTORICAL_TEAMS_GAMES (
	""season"" NUMBER(38,0),
	""scheduled_date"" VARCHAR(16777216),
	""attendance"" FLOAT,
	""market"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""team_code"" VARCHAR(16777216),
	""team_id"" VARCHAR(16777216),
	""alias"" VARCHAR(16777216),
	""current_division"" VARCHAR(16777216),
	""points_game"" NUMBER(38,0),
	""win"" BOOLEAN,
	""opp_market"" VARCHAR(16777216),
	""opp_name"" VARCHAR(16777216),
	""opp_code"" NUMBER(38,0),
	""opp_id"" VARCHAR(16777216),
	""opp_alias"" VARCHAR(16777216),
	""opp_current_division"" VARCHAR(16777216),
	""opp_points_game"" NUMBER(38,0)
);"

,3
table_name,MBB_PBP_SR
description,
DDL,"create or replace TABLE MBB_PBP_SR (
	""game_id"" VARCHAR(16777216),
	""load_timestamp"" NUMBER(38,0),
	""season"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""scheduled_date"" NUMBER(38,0),
	""venue_id"" VARCHAR(16777216),
	""venue_name"" VARCHAR(16777216),
	""venue_city"" VARCHAR(16777216),
	""venue_state"" VARCHAR(16777216),
	""venue_address"" VARCHAR(16777216),
	""venue_zip"" VARCHAR(16777216),
	""venue_country"" VARCHAR(16777216),
	""venue_capacity"" NUMBER(38,0),
	""attendance"" NUMBER(38,0),
	""neutral_site"" BOOLEAN,
	""conference_game"" BOOLEAN,
	""tournament"" VARCHAR(16777216),
	""tournament_type"" VARCHAR(16777216),
	""round"" VARCHAR(16777216),
	""game_no"" VARCHAR(16777216),
	""away_market"" VARCHAR(16777216),
	""away_name"" VARCHAR(16777216),
	""away_id"" VARCHAR(16777216),
	""away_alias"" VARCHAR(16777216),
	""away_conf_name"" VARCHAR(16777216),
	""away_conf_alias"" VARCHAR(16777216),
	""away_division_name"" VARCHAR(16777216),
	""away_division_alias"" VARCHAR(16777216),
	""away_league_name"" VARCHAR(16777216),
	""home_market"" VARCHAR(16777216),
	""home_name"" VARCHAR(16777216),
	""home_id"" VARCHAR(16777216),
	""home_alias"" VARCHAR(16777216),
	""home_conf_name"" VARCHAR(16777216),
	""home_conf_alias"" VARCHAR(16777216),
	""home_division_name"" VARCHAR(16777216),
	""home_division_alias"" VARCHAR(16777216),
	""home_league_name"" VARCHAR(16777216),
	""period"" NUMBER(38,0),
	""game_clock"" VARCHAR(16777216),
	""elapsed_time_sec"" NUMBER(38,0),
	""possession_arrow"" VARCHAR(16777216),
	""team_name"" VARCHAR(16777216),
	""team_market"" VARCHAR(16777216),
	""team_id"" VARCHAR(16777216),
	""team_alias"" VARCHAR(16777216),
	""team_conf_name"" VARCHAR(16777216),
	""team_conf_alias"" VARCHAR(16777216),
	""team_division_name"" VARCHAR(16777216),
	""team_division_alias"" VARCHAR(16777216),
	""team_league_name"" VARCHAR(16777216),
	""team_basket"" VARCHAR(16777216),
	""possession_team_id"" VARCHAR(16777216),
	""player_id"" VARCHAR(16777216),
	""player_full_name"" VARCHAR(16777216),
	""jersey_num"" NUMBER(38,0),
	""event_id"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""event_description"" VARCHAR(16777216),
	""event_coord_x"" FLOAT,
	""event_coord_y"" FLOAT,
	""event_type"" VARCHAR(16777216),
	""type"" VARCHAR(16777216),
	""shot_made"" BOOLEAN,
	""shot_type"" VARCHAR(16777216),
	""shot_subtype"" VARCHAR(16777216),
	""three_point_shot"" BOOLEAN,
	""points_scored"" FLOAT,
	""turnover_type"" VARCHAR(16777216),
	""rebound_type"" VARCHAR(16777216),
	""timeout_duration"" FLOAT
);"

,4
table_name,MBB_TEAMS
description,
DDL,"create or replace TABLE MBB_TEAMS (
	""market"" VARCHAR(16777216),
	""alias"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""id"" VARCHAR(16777216),
	""code_ncaa"" NUMBER(38,0),
	""kaggle_team_id"" NUMBER(38,0),
	""school_ncaa"" VARCHAR(16777216),
	""turner_name"" VARCHAR(16777216),
	""league_name"" VARCHAR(16777216),
	""league_alias"" VARCHAR(16777216),
	""league_id"" VARCHAR(16777216),
	""conf_name"" VARCHAR(16777216),
	""conf_alias"" VARCHAR(16777216),
	""conf_id"" VARCHAR(16777216),
	""division_name"" VARCHAR(16777216),
	""division_alias"" VARCHAR(16777216),
	""division_id"" VARCHAR(16777216),
	""venue_id"" VARCHAR(16777216),
	""venue_city"" VARCHAR(16777216),
	""venue_state"" VARCHAR(16777216),
	""venue_address"" VARCHAR(16777216),
	""venue_zip"" VARCHAR(16777216),
	""venue_country"" VARCHAR(16777216),
	""venue_name"" VARCHAR(16777216),
	""venue_capacity"" NUMBER(38,0),
	""logo_large"" VARCHAR(16777216),
	""logo_medium"" VARCHAR(16777216),
	""logo_small"" VARCHAR(16777216)
);"

,5
table_name,TEAM_COLORS
description,
DDL,"create or replace TABLE TEAM_COLORS (
	""market"" VARCHAR(16777216),
	""id"" VARCHAR(16777216),
	""code_ncaa"" NUMBER(38,0),
	""color"" VARCHAR(16777216)
);"

,6
table_name,MBB_PLAYERS_GAMES_SR
description,
DDL,"create or replace TABLE MBB_PLAYERS_GAMES_SR (
	""game_id"" VARCHAR(16777216),
	""season"" NUMBER(38,0),
	""neutral_site"" BOOLEAN,
	""scheduled_date"" DATE,
	""gametime"" NUMBER(38,0),
	""tournament"" VARCHAR(16777216),
	""tournament_type"" VARCHAR(16777216),
	""tournament_round"" VARCHAR(16777216),
	""tournament_game_no"" VARCHAR(16777216),
	""player_id"" VARCHAR(16777216),
	""last_name"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""full_name"" VARCHAR(16777216),
	""abbr_name"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""jersey_number"" NUMBER(38,0),
	""height"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""birth_place"" VARCHAR(16777216),
	""birthplace_city"" VARCHAR(16777216),
	""birthplace_state"" VARCHAR(16777216),
	""birthplace_country"" VARCHAR(16777216),
	""class"" VARCHAR(16777216),
	""team_name"" VARCHAR(16777216),
	""team_market"" VARCHAR(16777216),
	""team_id"" VARCHAR(16777216),
	""team_alias"" VARCHAR(16777216),
	""conf_name"" VARCHAR(16777216),
	""conf_alias"" VARCHAR(16777216),
	""division_name"" VARCHAR(16777216),
	""division_alias"" VARCHAR(16777216),
	""league_name"" VARCHAR(16777216),
	""home_team"" BOOLEAN,
	""active"" BOOLEAN,
	""played"" BOOLEAN,
	""starter"" BOOLEAN,
	""minutes"" VARCHAR(16777216),
	""minutes_int64"" NUMBER(38,0),
	""position"" VARCHAR(16777216),
	""primary_position"" VARCHAR(16777216),
	""field_goals_made"" NUMBER(38,0),
	""field_goals_att"" NUMBER(38,0),
	""field_goals_pct"" FLOAT,
	""three_points_made"" NUMBER(38,0),
	""three_points_att"" NUMBER(38,0),
	""three_points_pct"" FLOAT,
	""two_points_made"" NUMBER(38,0),
	""two_points_att"" NUMBER(38,0),
	""two_points_pct"" FLOAT,
	""blocked_att"" NUMBER(38,0),
	""free_throws_made"" NUMBER(38,0),
	""free_throws_att"" NUMBER(38,0),
	""free_throws_pct"" FLOAT,
	""offensive_rebounds"" NUMBER(38,0),
	""defensive_rebounds"" NUMBER(38,0),
	""rebounds"" NUMBER(38,0),
	""assists"" NUMBER(38,0),
	""turnovers"" NUMBER(38,0),
	""steals"" NUMBER(38,0),
	""blocks"" NUMBER(38,0),
	""assists_turnover_ratio"" FLOAT,
	""personal_fouls"" NUMBER(38,0),
	""tech_fouls"" NUMBER(38,0),
	""flagrant_fouls"" NUMBER(38,0),
	""points"" NUMBER(38,0),
	""sp_created"" NUMBER(38,0)
);"

,7
table_name,MASCOTS
description,
DDL,"create or replace TABLE MASCOTS (
	""id"" VARCHAR(16777216),
	""market"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""mascot"" VARCHAR(16777216),
	""mascot_name"" VARCHAR(16777216),
	""mascot_common_name"" VARCHAR(16777216),
	""tax_subspecies"" VARCHAR(16777216),
	""tax_species"" VARCHAR(16777216),
	""tax_genus"" VARCHAR(16777216),
	""tax_family"" VARCHAR(16777216),
	""tax_order"" VARCHAR(16777216),
	""tax_class"" VARCHAR(16777216),
	""tax_phylum"" VARCHAR(16777216),
	""tax_kingdom"" VARCHAR(16777216),
	""tax_domain"" VARCHAR(16777216),
	""non_tax_type"" VARCHAR(16777216)
);"

,8
table_name,MBB_HISTORICAL_TEAMS_SEASONS
description,
DDL,"create or replace TABLE MBB_HISTORICAL_TEAMS_SEASONS (
	""season"" NUMBER(38,0),
	""market"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""team_code"" NUMBER(38,0),
	""team_id"" VARCHAR(16777216),
	""alias"" VARCHAR(16777216),
	""division"" NUMBER(38,0),
	""current_division"" VARCHAR(16777216),
	""wins"" NUMBER(38,0),
	""losses"" NUMBER(38,0),
	""ties"" NUMBER(38,0)
);"

,9
table_name,MBB_TEAMS_GAMES_SR
description,
DDL,"create or replace TABLE MBB_TEAMS_GAMES_SR (
	""game_id"" VARCHAR(16777216),
	""season"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""coverage"" VARCHAR(16777216),
	""neutral_site"" BOOLEAN,
	""scheduled_date"" DATE,
	""gametime"" NUMBER(38,0),
	""conference_game"" BOOLEAN,
	""tournament"" VARCHAR(16777216),
	""tournament_type"" VARCHAR(16777216),
	""tournament_round"" VARCHAR(16777216),
	""tournament_game_no"" VARCHAR(16777216),
	""attendance"" NUMBER(38,0),
	""lead_changes"" NUMBER(38,0),
	""times_tied"" NUMBER(38,0),
	""periods"" NUMBER(38,0),
	""possession_arrow"" VARCHAR(16777216),
	""venue_id"" VARCHAR(16777216),
	""venue_city"" VARCHAR(16777216),
	""venue_state"" VARCHAR(16777216),
	""venue_address"" VARCHAR(16777216),
	""venue_zip"" VARCHAR(16777216),
	""venue_country"" VARCHAR(16777216),
	""venue_name"" VARCHAR(16777216),
	""venue_capacity"" NUMBER(38,0),
	""home_team"" BOOLEAN,
	""name"" VARCHAR(16777216),
	""market"" VARCHAR(16777216),
	""team_id"" VARCHAR(16777216),
	""alias"" VARCHAR(16777216),
	""league_id"" VARCHAR(16777216),
	""league_name"" VARCHAR(16777216),
	""league_alias"" VARCHAR(16777216),
	""conf_id"" VARCHAR(16777216),
	""conf_name"" VARCHAR(16777216),
	""conf_alias"" VARCHAR(16777216),
	""division_id"" VARCHAR(16777216),
	""division_name"" VARCHAR(16777216),
	""division_alias"" VARCHAR(16777216),
	""logo_large"" VARCHAR(16777216),
	""logo_medium"" VARCHAR(16777216),
	""logo_small"" VARCHAR(16777216),
	""opp_name"" VARCHAR(16777216),
	""opp_market"" VARCHAR(16777216),
	""opp_id"" VARCHAR(16777216),
	""opp_alias"" VARCHAR(16777216),
	""opp_league_id"" VARCHAR(16777216),
	""opp_league_name"" VARCHAR(16777216),
	""opp_league_alias"" VARCHAR(16777216),
	""opp_conf_id"" VARCHAR(16777216),
	""opp_conf_name"" VARCHAR(16777216),
	""opp_conf_alias"" VARCHAR(16777216),
	""opp_division_id"" VARCHAR(16777216),
	""opp_division_name"" VARCHAR(16777216),
	""opp_division_alias"" VARCHAR(16777216),
	""opp_logo_large"" VARCHAR(16777216),
	""opp_logo_medium"" VARCHAR(16777216),
	""opp_logo_small"" VARCHAR(16777216),
	""win"" BOOLEAN,
	""points_game"" NUMBER(38,0),
	""minutes"" VARCHAR(16777216),
	""field_goals_made"" NUMBER(38,0),
	""field_goals_att"" NUMBER(38,0),
	""field_goals_pct"" FLOAT,
	""three_points_made"" NUMBER(38,0),
	""three_points_att"" NUMBER(38,0),
	""three_points_pct"" FLOAT,
	""two_points_made"" NUMBER(38,0),
	""two_points_att"" NUMBER(38,0),
	""two_points_pct"" FLOAT,
	""blocked_att"" NUMBER(38,0),
	""free_throws_made"" NUMBER(38,0),
	""free_throws_att"" NUMBER(38,0),
	""free_throws_pct"" FLOAT,
	""offensive_rebounds"" NUMBER(38,0),
	""defensive_rebounds"" NUMBER(38,0),
	""rebounds"" NUMBER(38,0),
	""assists"" NUMBER(38,0),
	""turnovers"" NUMBER(38,0),
	""steals"" NUMBER(38,0),
	""blocks"" NUMBER(38,0),
	""assists_turnover_ratio"" FLOAT,
	""personal_fouls"" NUMBER(38,0),
	""ejections"" NUMBER(38,0),
	""foulouts"" NUMBER(38,0),
	""points"" NUMBER(38,0),
	""fast_break_pts"" NUMBER(38,0),
	""second_chance_pts"" NUMBER(38,0),
	""team_turnovers"" NUMBER(38,0),
	""points_off_turnovers"" NUMBER(38,0),
	""team_rebounds"" NUMBER(38,0),
	""flagrant_fouls"" NUMBER(38,0),
	""player_tech_fouls"" NUMBER(38,0),
	""team_tech_fouls"" NUMBER(38,0),
	""coach_tech_fouls"" NUMBER(38,0),
	""opp_points_game"" NUMBER(38,0),
	""opp_minutes"" VARCHAR(16777216),
	""opp_field_goals_made"" NUMBER(38,0),
	""opp_field_goals_att"" NUMBER(38,0),
	""opp_field_goals_pct"" FLOAT,
	""opp_three_points_made"" NUMBER(38,0),
	""opp_three_points_att"" NUMBER(38,0),
	""opp_three_points_pct"" FLOAT,
	""opp_two_points_made"" NUMBER(38,0),
	""opp_two_points_att"" NUMBER(38,0),
	""opp_two_points_pct"" FLOAT,
	""opp_blocked_att"" NUMBER(38,0),
	""opp_free_throws_made"" NUMBER(38,0),
	""opp_free_throws_att"" NUMBER(38,0),
	""opp_free_throws_pct"" FLOAT,
	""opp_offensive_rebounds"" NUMBER(38,0),
	""opp_defensive_rebounds"" NUMBER(38,0),
	""opp_rebounds"" NUMBER(38,0),
	""opp_assists"" NUMBER(38,0),
	""opp_turnovers"" NUMBER(38,0),
	""opp_steals"" NUMBER(38,0),
	""opp_blocks"" NUMBER(38,0),
	""opp_assists_turnover_ratio"" FLOAT,
	""opp_personal_fouls"" NUMBER(38,0),
	""opp_ejections"" NUMBER(38,0),
	""opp_foulouts"" NUMBER(38,0),
	""opp_points"" NUMBER(38,0),
	""opp_fast_break_pts"" NUMBER(38,0),
	""opp_second_chance_pts"" NUMBER(38,0),
	""opp_team_turnovers"" NUMBER(38,0),
	""opp_points_off_turnovers"" NUMBER(38,0),
	""opp_team_rebounds"" NUMBER(38,0),
	""opp_flagrant_fouls"" NUMBER(38,0),
	""opp_player_tech_fouls"" NUMBER(38,0),
	""opp_team_tech_fouls"" NUMBER(38,0),
	""opp_coach_tech_fouls"" NUMBER(38,0),
	""created"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
# Score Intervals and Coordinates Logic

## Score Delta Intervals

To categorize the score deltas into intervals, the following conditions are used:

- **<-20**: When `score_delta < -20`
- **-20 — -11**: When `score_delta` is between -20 (inclusive) and -10 (exclusive)
- **-10 — -1**: When `score_delta` is between -10 (inclusive) and 0 (exclusive)
- **0**: When `score_delta` equals 0
- **1 — 10**: When `score_delta` is between 1 (inclusive) and 10 (inclusive)
- **11 — 20**: When `score_delta` is between 11 (exclusive) and 20 (inclusive)
- **>20**: When `score_delta > 20`

These intervals help in analyzing the performance based on the difference in team scores.

## X and Y Coordinates Calculation

Coordinates are adjusted based on the `event_coord_x` and `event_coord_y` values as follows:

- **X Coordinate**: 
  - If `event_coord_x < 564`: Use `event_coord_x` directly.
  - Otherwise: Calculate as `1128 - event_coord_x`.

- **Y Coordinate**: 
  - If `event_coord_x < 564`: Calculate as `600 - event_coord_y`.
  - Otherwise: Use `event_coord_y` directly.

The table structure information is ({database name: {schema name: {table name}}}): 
{'NCAA_BASKETBALL': {'NCAA_BASKETBALL': ['MASCOTS', 'MBB_GAMES_SR', 'MBB_HISTORICAL_TEAMS_GAMES', 'MBB_HISTORICAL_TEAMS_SEASONS', 'MBB_HISTORICAL_TOURNAMENT_GAMES', 'MBB_PBP_SR', 'MBB_PLAYERS_GAMES_SR', 'MBB_TEAMS', 'MBB_TEAMS_GAMES_SR', 'TEAM_COLORS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR`
  
  - **"game_id"**: Identifies each game. Used to group events by game.
  - **"scheduled_date"**: Date of the game. Used to filter events before March 15, 2018.
  - **"event_type"**: Type of event (e.g., 'shot', 'free_throw'). Used to select shot attempts.
  - **"shot_made"**: Indicates if a shot was successful (`TRUE`) or not (`FALSE`).
  - **"event_coord_x"**, **"event_coord_y"**: X and Y coordinates of the event on the court. Used to calculate average coordinates.
  - **"team_id"**: Identifies the team involved in the event. Used to group events by team.
  - **"team_basket"**: Indicates which basket a team is shooting at (e.g., 'left', 'right'). Used to ensure shots are on the correct side of the court.
  - **"shot_type"**: General category of the shot (e.g., 'jump shot', 'layup'). Used to group by shot type.
  - **"shot_subtype"**: More specific description of the shot. May be used for deeper analysis.
  - **"elapsed_time_sec"**: Time elapsed in seconds since the start of the game. Used to order events chronologically.
  - **"points_scored"**: Points scored from the event. Used to calculate cumulative scores.
  - **"player_id"**: Identifies the player. Could be used to count shot attempts per player.

**Potential Conditions:**

- **Date Filter**: `"scheduled_date" < '2018-03-15'` to consider only shots taken before March 15, 2018.
- **Event Type**: `"event_type" = 'shot'` to select only shot attempts.
- **Correct Side of Court**: Comparing `"team_basket"` with `"event_coord_x"` and `"event_coord_y"` to ensure shots are on the correct side.
- **Score Delta Calculation**: Requires computing cumulative points per team up to each event to determine the score difference.
- **Grouping**: Group by `"shot_type"` to analyze each shot type separately.
  
**SQL Queries:**

1. **List Distinct Event Types**

   ```sql
   SELECT DISTINCT "event_type"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   LIMIT 100;
   ```

2. **Select Shots Before March 15, 2018**

   ```sql
   SELECT *
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "scheduled_date" < '2018-03-15' AND "event_type" = 'shot'
   LIMIT 100;
   ```

3. **List Distinct Shot Types**

   ```sql
   SELECT DISTINCT "shot_type"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   LIMIT 100;
   ```

4. **Count Shot Attempts per Shot Type**

   ```sql
   SELECT "shot_type", COUNT(*) AS "attempts"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "event_type" = 'shot' AND "scheduled_date" < '2018-03-15'
   GROUP BY "shot_type"
   LIMIT 100;
   ```

5. **Find Average Coordinates for Shots**

   ```sql
   SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "event_type" = 'shot'
   LIMIT 100;
   ```

6. **Count Successful Shots per Team**

   ```sql
   SELECT "team_id", COUNT(*) AS "successful_shots"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "event_type" = 'shot' AND "shot_made" = TRUE
   GROUP BY "team_id"
   LIMIT 100;
   ```

7. **Calculate Cumulative Points per Team in Each Game**

   ```sql
   SELECT
     "game_id",
     "team_id",
     "elapsed_time_sec",
     SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "cumulative_points"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "scheduled_date" < '2018-03-15'
   LIMIT 100;
   ```

8. **Determine Shot Attempts on Correct Side of the Court**

   ```sql
   SELECT *
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "event_type" = 'shot' AND "team_basket" = 'left' AND "event_coord_x" < 564
   LIMIT 100;
   ```

9. **Calculate Score Delta at Each Shot Event**

   ```sql
   SELECT
     "game_id",
     "elapsed_time_sec",
     "team_id",
     "points_scored",
     SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") -
     SUM("points_scored") OVER (PARTITION BY "game_id" ORDER BY "elapsed_time_sec") +
     SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "score_delta"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   WHERE "event_type" = 'shot' AND "scheduled_date" < '2018-03-15'
   LIMIT 100;
   ```

10. **Average Number of Shot Attempts per Score Delta Interval**

    ```sql
    SELECT "score_delta_interval", AVG("attempts") AS "avg_attempts"
    FROM (
      SELECT
        "game_id",
        "shot_type",
        CASE
          WHEN "score_delta" < -20 THEN '<-20'
          WHEN "score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
          WHEN "score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
          WHEN "score_delta" = 0 THEN '0'
          WHEN "score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
          WHEN "score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
          WHEN "score_delta" > 20 THEN '>20'
        END AS "score_delta_interval",
        COUNT(*) OVER (PARTITION BY "game_id", "score_delta_interval", "shot_type") AS "attempts"
      FROM (
        -- Subquery to calculate score_delta per event
        SELECT
          "game_id",
          "shot_type",
          "elapsed_time_sec",
          SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") -
          SUM("points_scored") OVER (PARTITION BY "game_id" ORDER BY "elapsed_time_sec") +
          SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "score_delta"
        FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
        WHERE "event_type" = 'shot' AND "scheduled_date" < '2018-03-15'
      ) sub
    ) main
    GROUP BY "score_delta_interval"
    LIMIT 100;
    ```

**Note:** The above queries are designed to explore the relevant data and understand how to approach the task. They incrementally build up from simple selections to more complex aggregations and calculations that would be needed to fulfill the original task. The queries aim to:

- Identify the types of events and shots available.
- Filter shots based on date and ensure they're taken from the correct side of the court.
- Calculate cumulative scores and score deltas.
- Group data by shot types and score delta intervals.
- Compute averages needed for further analysis.

These queries provide insights into the structure and content of the data, which is essential for performing the comprehensive analysis required by the task.Query:
SELECT DISTINCT "event_type"
   FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
   LIMIT 100;
Answer:
event_type
freethrowmade
delay
offensivefoul
shootingfoul
kickball
technicalfoul
teamtimeout
deadball
officialtimeout
substitution
block
openinbound
twopointmiss
minortechnicalfoul
personalfoul
threepointmade
clearpathfoul
rebound
endperiod
twopointmade
opentip
assist
review
turnover
laneviolation
ejection
threepointmiss
flagrantone
freethrowmiss
possession
defensivethreeseconds
attemptblocked
flagranttwo
lineupchange
jumpball
tvtimeout
freethrow
Query:
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100;
Answer:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:33,447,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,26ce70e0-395c-49dc-bc4c-a29c8f6e39bc,1522545300000000,Malik Newman misses two point layup,88.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:34,506,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,37617439-1421-47bb-ab37-9ef0f6b740b9,Marcus Garrett,0,b6e9792f-3623-421a-9508-a09846181106,1522545420000000,Marcus Garrett misses two point layup,99.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:06,534,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,6c25f209-bd61-4a1e-a239-f5996e77335b,Silvio De Sousa,22,c6b48e2d-5eee-48f3-9abd-603655af5174,1522545480000000,Silvio De Sousa misses two point layup,71.0,327.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,18:20,100,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,2783a8f1-e87e-41db-bd9e-495044d13d85,1522544400000000,Malik Newman misses two point jump shot,240.0,177.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:48,432,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,9b22a279-e1aa-4fbf-9db2-0123c78729ec,1522545300000000,Malik Newman misses two point jump shot,237.0,336.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,
Query:
SELECT DISTINCT "shot_type"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Answer:
shot_type
jump shot
layup
hook shot
dunk
""
tip shot
Query:
SELECT "shot_type", COUNT(*) AS "attempts"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
GROUP BY "shot_type"
LIMIT 100
Answer:
shot_type,attempts
dunk,41997
jump shot,680076
layup,337805
hook shot,11015
,194962
tip shot,6117
Query:
SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Answer:
avg_x,avg_y
563.7203539071614,288.3724201476133
Query:
SELECT "team_id", COUNT(*) AS "successful_shots"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'threepointmade')
GROUP BY "team_id"
LIMIT 100
Answer:
team_id,successful_shots
a41d5a05-4c11-4171-a57e-e7a1ea325a6d,4869
b06b63b0-20e6-4c78-bdcf-5feac3d7995e,189
c2245a52-8d2e-4aaa-b42f-f22e0d629227,59
c3a808e6-2c5d-415f-9cd5-334148961392,19
e48e3dd5-721c-4d96-8ff4-790fe2597bfd,268
fa416692-7e09-4f0a-9bcf-0cf7d5149a14,3790
fd245a76-7ab5-41d4-9dd4-76bb82bc47bd,18
31ac98c4-4517-41f9-b113-ae604bea5678,30
4fbebf0a-e117-4a0c-8f15-c247535a2a1b,3777
11a617d5-af03-4cce-bc8a-51114d9e41fe,1277
6bff595c-32cb-4028-837c-c7de2a2107e6,540
912671c7-19fd-451b-813e-885485427820,244
701ab32b-ac60-4106-97a7-cf70a0a053f7,19
78434f3d-9b05-480c-b79f-4f228a0a155b,35
c206712f-2298-4279-b76c-834ac42809b9,327
f7575278-12ec-494a-b544-427c1759d43d,169
10f450ce-143b-4e46-8bfe-52c644b68b07,489
9bb49515-c2c8-44f8-8adf-d86a5d3bde11,19
6b0359b5-10a1-486f-916d-41e109edadcf,20
2b861694-22f4-4392-bd2a-8d272cfd44eb,23
1da70895-f77f-44ef-b216-d63c02e696eb,4879
2920c5fa-1e86-4958-a7c4-1e97b8e201d8,2186
600aad0e-85e7-4db8-be0b-94ba02a08e55,293
2f4d21f8-6d5f-48a5-abca-52a30583871a,4899
90ec10eb-38a4-4a69-b072-ef71d294933b,456
a3fef707-e4fc-48a0-82f1-f4ef01b76f45,492
aacdc78d-b7fa-48f6-9686-2fdb8a95030e,3940
aed211c3-23a4-4188-ad70-22c6eba7d765,1615
aef5e386-d8e8-460c-8014-3a2f090fd988,4195
dc3bc3bd-c463-4726-a099-e624e239f47b,16
e0ef0587-bd03-4590-b92d-b95e1f9b615b,43
e6914f16-ca37-4d2e-ba26-a425910283e2,3712
f2d01b77-0f5d-4574-9e49-2a3eaf822e44,386
23426c0b-1705-4dfb-a0e2-efdbdd8fd6f6,556
484dfa62-cc8c-46ac-a4ca-2e2b48391ddd,57
9e99d5a6-3522-4ab1-8c69-1350227496b8,26
778ef9d5-039f-4f00-bbb4-38661ca4f56f,20
48c7f9f3-f7e4-4c4a-b429-7995f9ee78c4,26
45439cdb-af7a-4743-936c-dccc76b30877,476
70e2bedd-3a0a-479c-ac99-e3f58aa6824b,3815
e52c9644-717a-46f4-bf16-aeca000b3b44,4017
82c12e8d-7c6c-47d8-b100-3cbc190d268e,301
9c396fa7-c165-4599-8542-158bd0d9a199,377
d52c3640-069c-4554-982e-e6537c8044f1,2547
dba620d9-7282-4638-bf05-13caf48eeed1,368
b4b87d2c-9af2-455b-adc1-4e484c078912,18
22fbe5dc-c6db-4675-b3a3-2d8af7f5d313,465
31aedd91-a77e-46c1-8bdc-80e9860c159d,391
508f503f-dc57-4f4c-a01e-4f195e5c05c8,517
56913910-87f7-4ad7-ae3b-5cd9fb218fd9,4256
e19cfc47-f23f-4c64-ba29-2e6d12dc45b2,298
fe406882-9f22-495e-9df6-ef357a6803c6,524
87d88c93-29bc-4306-b0a6-87c6f6e80da1,445
61dadefa-76bf-4db4-8067-f88df540b9cd,399
0dadedb0-2bd3-45e7-91a3-93af6c4e87f2,373
52df1e19-b142-4a76-a439-ad68455d0581,4238
2da57857-b038-4ad3-8199-e3fb339f57d2,543
324ccccc-575b-4b82-acb0-fbb8e68da13b,3948
350271fa-d620-4398-822c-72857291199f,43
161354af-1f3e-4d58-88f7-e016ec74b7b6,545
8967c7ec-141e-491f-a79d-9b62f7905efb,27
949c3398-85e4-4c63-ba71-9a82e06ddea4,265
c31455b2-8a45-4248-aa8f-ce7eab1c6b02,3117
ef13a371-76ed-409c-9aa6-35135183e170,357
f7dea397-0b96-4e96-812f-e454226b5925,19
ad925b0b-8411-41de-81df-212482545581,17
b18d3456-8403-4101-987a-e1f887735478,22
38fa68fb-ac54-4e62-84cb-c3dafc34fe09,22
9febd5fa-982f-4f40-ad1d-8e49be96cf4f,458
5ef64f01-86ae-4553-9834-c79cc0859eaf,705
0a50907c-0141-4d40-81e7-d1652b307838,32
500d7223-ecff-494b-9539-28427156c783,501
683ab61f-546f-44da-b085-c3a5740554aa,4069
0c0608b3-f349-4f5e-9a10-7e6a744dd0d2,3490
e033de6e-06c8-4bf0-9470-1b1795becf56,24
eb157f98-0697-459c-9293-ddb162ceb28b,975
f8b1bf00-5b73-4ac4-98c0-ec554027ae32,3395
ad9fce12-6b1a-400c-bcbe-29d84d065fc0,513
1753768d-e46e-40b1-8d69-a8ae5cccec03,334
1dc13b18-f9b3-4bb9-b1cf-979fcd8c2b6f,353
63cad858-8654-4956-8438-8fe79cd1208a,539
4927ef8b-e680-4fb8-b10e-2ea3eff32eab,249
26eaeb27-2fc4-4c9f-93b2-27f6afe39071,16
61db8108-45f1-43e5-ade8-83278324bc7d,25
224e3b21-30e7-4a05-9e8c-62721d581db8,2089
56fe0ab2-e4f0-47b9-8726-9ce23ebcde20,649
68a3227f-677f-43b0-9a3a-cad79d0df9e2,2951
0113eea0-c943-4fff-9780-ae0fb099e7ef,270
0d8a328f-20ce-410b-bed1-15fc01308aaf,4745
6e8f97e0-911d-4fd1-b9da-7fd57ab26729,27
df3da9d7-2d2b-44e2-99e2-08c4945a203b,757
72971b77-1d35-40b3-bb63-4c5b29f3d22b,3557
175d34a7-3823-4e4f-9f11-2464f55360b8,447
532d3874-b4b3-4c5c-acc6-749a6db26c8f,3459
cb732075-23a5-4e71-9037-50a7a002bdb2,445
d3c8a767-b6fc-45d4-a5f2-18406f2993f1,4266
de46a033-8750-4828-90cc-b25350d0fb15,18
ef184799-d79b-49d9-a662-991eaf4044cd,4131
fe037cba-25d9-42f5-a461-61d7102c17de,356
5fe4a398-1699-4442-a364-305b2f0ac01e,606
Query:
SELECT
  "game_id",
  "team_id",
  "elapsed_time_sec",
  SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "cumulative_points"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Answer:
Too long, hard cut:
game_id,team_id,elapsed_time_sec,cumulative_points
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,855,12.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,542,8.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1477,24.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1584,26.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1216,22.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,900,15.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,531,8.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,301,2.0
50aa9365-fb09-437e-b785-59ee0f73f728,c851131a-5ecd-4670-81bc-b40f4837dd65,1830,34.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,756,11.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1797,42.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,585,11.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,812,14.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1829,42.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1429,30.0
7f167c26-7462-4111-88fa-3d6199c9a57d,c851131a-5ecd-4670-81bc-b40f4837dd65,1919,46.0
f519a979-dada-49a1-a581-e85bdc2be8b0,c851131a-5ecd-4670-81bc-b40f4837dd65,2045,42.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1123,17.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,929,10.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1112,15.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1854,30.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,25,2.0
8c4a1703-39d7-4539-88e3-30e456012364,c851131a-5ecd-4670-81bc-b40f4837dd65,1463,23.0
327cabf5-0e0a-4788-b6a1-79eda5cf7c41,c851131a-5ecd-4670-81bc-b40f4837dd65,882,21.0
327cabf5-0e0a-4788-b6a1-79eda5cf7c41,c851131a-5ecd-4670-81bc-b40f4837dd65,2595,62.0
327cabf5-0e0a-4788-b6a1-79eda5cf7c41,c851131a-5ecd-4670-81bc-b40f4837dd65,623,16.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,2010,43.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,106,5.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,2275,48.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,788,22.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,1092,24.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,135,7.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,50,
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,1966,43.0
fe4ab392-f3b8-42d8-aea2-811e546729ae,6b955b96-b736-475e-bffd-e4acf2054169,347,9.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,965,20.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,1374,30.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,695,14.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,281,7.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,345,7.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,340,7.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,585,12.0
5bba4562-7ce8-4c3c-af66-14bfc981a5f1,6b955b96-b736-475e-bffd-e4acf2054169,571,9.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,1322,35.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,195,4.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,1715,42.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,122,2.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,322,6.0
60119914-aa16-49da-9a49-c4e0dd420ed4,6b955b96-b736-475e-bffd-e4acf2054169,559,13.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,1047,20.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,496,10.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,2220,56.0
475907f5-177f-4b8a-8e58-1245b4455d60,6b955b96-b736-475e-bffd-e4acf2054169,1466,31.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,2440,55.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,545,16.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,1976,42.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,380,10.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,1386,25.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b96-b736-475e-bffd-e4acf2054169,1242,25.0
911ac720-938e-46df-964d-02d8849fcb32,6b955b9
Query:
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
  AND "team_basket" = 'left' AND "event_coord_x" < 564
LIMIT 100
Answer:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:33,447,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,26ce70e0-395c-49dc-bc4c-a29c8f6e39bc,1522545300000000,Malik Newman misses two point layup,88.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:34,506,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,37617439-1421-47bb-ab37-9ef0f6b740b9,Marcus Garrett,0,b6e9792f-3623-421a-9508-a09846181106,1522545420000000,Marcus Garrett misses two point layup,99.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:06,534,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,6c25f209-bd61-4a1e-a239-f5996e77335b,Silvio De Sousa,22,c6b48e2d-5eee-48f3-9abd-603655af5174,1522545480000000,Silvio De Sousa misses two point layup,71.0,327.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,18:20,100,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,2783a8f1-e87e-41db-bd9e-495044d13d85,1522544400000000,Malik Newman misses two point jump shot,240.0,177.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:48,432,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,9b22a279-e1aa-4fbf-9db2-0123c78729ec,1522545300000000,Malik Newman misses two point jump shot,237.0,336.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,
Query:
SELECT
  "game_id",
  "elapsed_time_sec",
  "team_id",
  "points_scored",
  SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") -
  SUM("points_scored") OVER (PARTITION BY "game_id" ORDER BY "elapsed_time_sec") +
  SUM("points_scored") OVER (PARTITION BY "game_id", "team_id" ORDER BY "elapsed_time_sec") AS "score_delta"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Answer:
Too long, hard cut:
game_id,elapsed_time_sec,team_id,points_scored,score_delta
67324d29-0941-4ee8-8027-9bb2ecf82e36,770,2ed86226-3fff-4083-90fa-6b02307e6f73,,0.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,428,2ed86226-3fff-4083-90fa-6b02307e6f73,,-5.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,220,2ed86226-3fff-4083-90fa-6b02307e6f73,2.0,0.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,1059,2ed86226-3fff-4083-90fa-6b02307e6f73,,-13.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,1567,2ed86226-3fff-4083-90fa-6b02307e6f73,2.0,-5.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,154,2ed86226-3fff-4083-90fa-6b02307e6f73,,-2.0
67324d29-0941-4ee8-8027-9bb2ecf82e36,877,2ed86226-3fff-4083-90fa-6b02307e6f73,,-3.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,2003,2ed86226-3fff-4083-90fa-6b02307e6f73,,-10.0
67324d29-0941-4ee8-8027-9bb2ecf82e36,2173,2ed86226-3fff-4083-90fa-6b02307e6f73,,-21.0
2ec20d21-91d0-4bce-b161-0cbb6181220b,2289,2ed86226-3fff-4083-90fa-6b02307e6f73,,-17.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,1656,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,10.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,424,c851131a-5ecd-4670-81bc-b40f4837dd65,,-2.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,1681,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,13.0
514440b9-f5f2-4dda-9a4c-92253176ba16,1717,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,-13.0
514440b9-f5f2-4dda-9a4c-92253176ba16,167,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,4.0
514440b9-f5f2-4dda-9a4c-92253176ba16,920,c851131a-5ecd-4670-81bc-b40f4837dd65,,4.0
514440b9-f5f2-4dda-9a4c-92253176ba16,421,c851131a-5ecd-4670-81bc-b40f4837dd65,,6.0
514440b9-f5f2-4dda-9a4c-92253176ba16,260,c851131a-5ecd-4670-81bc-b40f4837dd65,,2.0
b07b5c5a-341f-4270-972c-c2da8b4af9f3,1938,c851131a-5ecd-4670-81bc-b40f4837dd65,,15.0
514440b9-f5f2-4dda-9a4c-92253176ba16,1942,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-12.0
514440b9-f5f2-4dda-9a4c-92253176ba16,2094,c851131a-5ecd-4670-81bc-b40f4837dd65,,-16.0
514440b9-f5f2-4dda-9a4c-92253176ba16,804,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,4.0
d7656944-0406-42eb-9019-d40ad4f60121,2057,c851131a-5ecd-4670-81bc-b40f4837dd65,,12.0
d7656944-0406-42eb-9019-d40ad4f60121,533,c851131a-5ecd-4670-81bc-b40f4837dd65,,9.0
d7656944-0406-42eb-9019-d40ad4f60121,2055,c851131a-5ecd-4670-81bc-b40f4837dd65,,12.0
d7656944-0406-42eb-9019-d40ad4f60121,1672,c851131a-5ecd-4670-81bc-b40f4837dd65,,20.0
d7656944-0406-42eb-9019-d40ad4f60121,440,c851131a-5ecd-4670-81bc-b40f4837dd65,,11.0
d7656944-0406-42eb-9019-d40ad4f60121,1438,c851131a-5ecd-4670-81bc-b40f4837dd65,,20.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,919,c851131a-5ecd-4670-81bc-b40f4837dd65,,4.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,2332,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,17.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,1687,c851131a-5ecd-4670-81bc-b40f4837dd65,,8.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,2292,c851131a-5ecd-4670-81bc-b40f4837dd65,,14.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,1262,c851131a-5ecd-4670-81bc-b40f4837dd65,,-1.0
b5fa0495-a8e0-45d7-b677-7a75ad7a1a3e,1323,c851131a-5ecd-4670-81bc-b40f4837dd65,,1.0
50d4f952-2417-4bc0-8069-7650b43d9e38,335,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,4.0
50d4f952-2417-4bc0-8069-7650b43d9e38,1818,c851131a-5ecd-4670-81bc-b40f4837dd65,,-12.0
50d4f952-2417-4bc0-8069-7650b43d9e38,2306,c851131a-5ecd-4670-81bc-b40f4837dd65,,-15.0
50d4f952-2417-4bc0-8069-7650b43d9e38,323,c851131a-5ecd-4670-81bc-b40f4837dd65,,2.0
50d4f952-2417-4bc0-8069-7650b43d9e38,1071,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,1.0
50d4f952-2417-4bc0-8069-7650b43d9e38,1949,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,-11.0
50d4f952-2417-4bc0-8069-7650b43d9e38,2387,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-15.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1887,c851131a-5ecd-4670-81bc-b40f4837dd65,,-31.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,31,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,0.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1724,c851131a-5ecd-4670-81bc-b40f4837dd65,,-26.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1820,c851131a-5ecd-4670-81bc-b40f4837dd65,,-29.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1645,c851131a-5ecd-4670-81bc-b40f4837dd65,,-24.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,913,c851131a-5ecd-4670-81bc-b40f4837dd65,,-12.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1258,c851131a-5ecd-4670-81bc-b40f4837dd65,,-18.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1765,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-26.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,351,c851131a-5ecd-4670-81bc-b40f4837dd65,,-9.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,1358,c851131a-5ecd-4670-81bc-b40f4837dd65,,-20.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,97,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-1.0
30bbb84e-d758-4084-951b-ce2a17fd3a57,929,c851131a-5ecd-4670-81bc-b40f4837dd65,3.0,-9.0
b24a7f15-764d-4cec-9384-b26222c1b983,1717,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-8.0
b24a7f15-764d-4cec-9384-b26222c1b983,752,c851131a-5ecd-4670-81bc-b40f4837dd65,,-10.0
b24a7f15-764d-4cec-9384-b26222c1b983,953,c851131a-5ecd-4670-81bc-b40f4837dd65,2.0,-6.0
b24a7f15-764d-4cec-9384-b26222c1b983,2020,c851131a-5ecd-4670-81bc-b40f4837dd65,,-9.0
b24a7f15-764d-4cec-9384-b26222c1b983,875,c851131a-5ecd-4670
Query:
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "shot_type",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
)

SELECT
  cs."game_id",
  cs."shot_type",
  cs."team_id",
  cs."elapsed_time_sec",
  cs."team_cumulative_points",
  cs."team_cumulative_points" - opponent."team_cumulative_points" AS "score_delta"
FROM cumulative_scores cs
JOIN (
  SELECT
    "game_id",
    "elapsed_time_sec",
    "team_id" AS "opponent_team_id",
    "team_cumulative_points"
  FROM cumulative_scores
) opponent
ON cs."game_id" = opponent."game_id"
  AND cs."elapsed_time_sec" = opponent."elapsed_time_sec"
  AND cs."team_id" <> opponent."opponent_team_id"
ORDER BY cs."game_id", cs."elapsed_time_sec", cs."team_id"
LIMIT 100;
Answer:
Too long, hard cut:
game_id,shot_type,team_id,elapsed_time_sec,team_cumulative_points,score_delta
0013581b-1b6f-4851-9bd5-4a6f91294537,layup,2a997096-a381-469d-a7e9-9e031c8b071c,660,6.0,-19.0
0013581b-1b6f-4851-9bd5-4a6f91294537,jump shot,509aacc4-c121-46a2-800a-d5431ef181d2,660,25.0,19.0
00323329-7205-46c6-9add-26d1422d4b73,jump shot,8ab00d43-840a-4c96-bdee-bf88fa6e3f11,190,4.0,4.0
00323329-7205-46c6-9add-26d1422d4b73,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,190,0.0,-4.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,jump shot,5f9a90a2-3926-404e-8c8a-d9f22ad6907d,2050,32.0,-19.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,jump shot,d203f38a-a166-4258-bca2-e161b591ecfb,2050,51.0,19.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,237,4.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,237,5.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,668,12.0,-11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,668,23.0,11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,1908,38.0,-22.0
003dcde4-42ff-4722-ab9f-84b8802ee498,,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,1908,60.0,22.0
005788bc-1e7a-421e-bda6-d5e97dcce486,jump shot,054c3e85-0552-4549-b123-7e84af6e7b6c,233,4.0,-4.0
005788bc-1e7a-421e-bda6-d5e97dcce486,layup,612f7f66-1de1-4d42-b842-9a508daab911,233,8.0,4.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,683ab61f-546f-44da-b085-c3a5740554aa,1346,25.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,683ab61f-546f-44da-b085-c3a5740554aa,1346,25.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,1346,40.0,15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,1346,40.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,jump shot,8736b67f-5924-400b-bf94-3bd804c36600,832,27.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,jump shot,c1f4aae1-aa16-4095-aeab-10e5c2a1236a,832,12.0,-15.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,layup,0d037a5d-827a-44dd-8b70-57603d671d5d,467,12.0,-1.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,jump shot,3a000455-de7c-4ca8-880e-abdce7f21da9,467,13.0,1.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,jump shot,68d2aa5b-714f-4652-96f3-b71e1752413f,2233,58.0,-6.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,tip shot,6ef40534-5fad-4755-84de-7dcbd645d1f0,2233,64.0,6.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,layup,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,170,6.0,4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,layup,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,170,6.0,2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,layup,faeb1160-5d15-4f26-99fc-c441cf21fc7f,170,4.0,-2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,jump shot,faeb1160-5d15-4f26-99fc-c441cf21fc7f,170,2.0,-4.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,jump shot,8598d1b6-106b-4083-a512-2e495729525a,256,0.0,-5.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,layup,a17dfc54-415f-49c3-a2e6-d6fa9db18b0a,256,5.0,5.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,,55af9c69-3675-4b9b-a882-96640b782fff,1271,30.0,0.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,,b03bb029-4499-4a2c-9074-5071ed360b21,1271,30.0,0.0
00c2cbda-77bb-472a-8985-479067ae9286,jump shot,4b7dedc0-7b48-49a4-aad6-8a94a33274d2,1019,32.0,20.0
00c2cbda-77bb-472a-8985-479067ae9286,tip shot,fa416692-7e09-4f0a-9bcf-0cf7d5149a14,1019,12.0,-20.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,1551b3a0-6d10-4ffa-8dfa-73b56f004553,116,4.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,116,0.0,-4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,1551b3a0-6d10-4ffa-8dfa-73b56f004553,1122,23.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,jump shot,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,1122,19.0,-4.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,dunk,324ccccc-575b-4b82-acb0-fbb8e68da13b,1811,46.0,-7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,1811,53.0,7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,324ccccc-575b-4b82-acb0-fbb8e68da13b,2265,55.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,324ccccc-575b-4b82-acb0-fbb8e68da13b,2265,55.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,2265,60.0,5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,layup,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,2265,60.0,5.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,jump shot,3a000455-de7c-4ca8-880e-abdce7f21da9,658,21.0,12.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,layup,532d3874-b4b3-4c5c-acc6-749a6db26c8f,658,9.0,-12.0
00ebfaac-f8b0-4aa1-9473-b2c492898739,jump shot,1f99a164-d593
Query:
-- Corrected Query 1: No changes needed
SELECT DISTINCT "shot_type"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Answer:
shot_type
jump shot
layup
hook shot
dunk
""
tip shot
Query:
-- Corrected Query 2: No changes needed
SELECT "shot_type", COUNT(*) AS "attempts"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
GROUP BY "shot_type"
LIMIT 100
Answer:
shot_type,attempts
dunk,41997
jump shot,680076
layup,337805
hook shot,11015
,194962
tip shot,6117
Query:
-- Corrected Query 3: No changes needed
SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
LIMIT 100
Answer:
avg_x,avg_y
563.7203539071614,288.3724201476133
Query:
-- Corrected Query 4: No changes needed
SELECT "team_id", COUNT(*) AS "successful_shots"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN ('twopointmade', 'threepointmade')
GROUP BY "team_id"
LIMIT 100
Answer:
team_id,successful_shots
a41d5a05-4c11-4171-a57e-e7a1ea325a6d,4869
b06b63b0-20e6-4c78-bdcf-5feac3d7995e,189
c2245a52-8d2e-4aaa-b42f-f22e0d629227,59
c3a808e6-2c5d-415f-9cd5-334148961392,19
e48e3dd5-721c-4d96-8ff4-790fe2597bfd,268
fa416692-7e09-4f0a-9bcf-0cf7d5149a14,3790
fd245a76-7ab5-41d4-9dd4-76bb82bc47bd,18
31ac98c4-4517-41f9-b113-ae604bea5678,30
4fbebf0a-e117-4a0c-8f15-c247535a2a1b,3777
11a617d5-af03-4cce-bc8a-51114d9e41fe,1277
6bff595c-32cb-4028-837c-c7de2a2107e6,540
912671c7-19fd-451b-813e-885485427820,244
701ab32b-ac60-4106-97a7-cf70a0a053f7,19
78434f3d-9b05-480c-b79f-4f228a0a155b,35
c206712f-2298-4279-b76c-834ac42809b9,327
f7575278-12ec-494a-b544-427c1759d43d,169
10f450ce-143b-4e46-8bfe-52c644b68b07,489
9bb49515-c2c8-44f8-8adf-d86a5d3bde11,19
6b0359b5-10a1-486f-916d-41e109edadcf,20
2b861694-22f4-4392-bd2a-8d272cfd44eb,23
1da70895-f77f-44ef-b216-d63c02e696eb,4879
2920c5fa-1e86-4958-a7c4-1e97b8e201d8,2186
600aad0e-85e7-4db8-be0b-94ba02a08e55,293
2f4d21f8-6d5f-48a5-abca-52a30583871a,4899
90ec10eb-38a4-4a69-b072-ef71d294933b,456
a3fef707-e4fc-48a0-82f1-f4ef01b76f45,492
aacdc78d-b7fa-48f6-9686-2fdb8a95030e,3940
aed211c3-23a4-4188-ad70-22c6eba7d765,1615
aef5e386-d8e8-460c-8014-3a2f090fd988,4195
dc3bc3bd-c463-4726-a099-e624e239f47b,16
e0ef0587-bd03-4590-b92d-b95e1f9b615b,43
e6914f16-ca37-4d2e-ba26-a425910283e2,3712
f2d01b77-0f5d-4574-9e49-2a3eaf822e44,386
23426c0b-1705-4dfb-a0e2-efdbdd8fd6f6,556
484dfa62-cc8c-46ac-a4ca-2e2b48391ddd,57
9e99d5a6-3522-4ab1-8c69-1350227496b8,26
778ef9d5-039f-4f00-bbb4-38661ca4f56f,20
48c7f9f3-f7e4-4c4a-b429-7995f9ee78c4,26
45439cdb-af7a-4743-936c-dccc76b30877,476
70e2bedd-3a0a-479c-ac99-e3f58aa6824b,3815
e52c9644-717a-46f4-bf16-aeca000b3b44,4017
82c12e8d-7c6c-47d8-b100-3cbc190d268e,301
9c396fa7-c165-4599-8542-158bd0d9a199,377
d52c3640-069c-4554-982e-e6537c8044f1,2547
dba620d9-7282-4638-bf05-13caf48eeed1,368
b4b87d2c-9af2-455b-adc1-4e484c078912,18
22fbe5dc-c6db-4675-b3a3-2d8af7f5d313,465
31aedd91-a77e-46c1-8bdc-80e9860c159d,391
508f503f-dc57-4f4c-a01e-4f195e5c05c8,517
56913910-87f7-4ad7-ae3b-5cd9fb218fd9,4256
e19cfc47-f23f-4c64-ba29-2e6d12dc45b2,298
fe406882-9f22-495e-9df6-ef357a6803c6,524
87d88c93-29bc-4306-b0a6-87c6f6e80da1,445
61dadefa-76bf-4db4-8067-f88df540b9cd,399
0dadedb0-2bd3-45e7-91a3-93af6c4e87f2,373
52df1e19-b142-4a76-a439-ad68455d0581,4238
2da57857-b038-4ad3-8199-e3fb339f57d2,543
324ccccc-575b-4b82-acb0-fbb8e68da13b,3948
350271fa-d620-4398-822c-72857291199f,43
161354af-1f3e-4d58-88f7-e016ec74b7b6,545
8967c7ec-141e-491f-a79d-9b62f7905efb,27
949c3398-85e4-4c63-ba71-9a82e06ddea4,265
c31455b2-8a45-4248-aa8f-ce7eab1c6b02,3117
ef13a371-76ed-409c-9aa6-35135183e170,357
f7dea397-0b96-4e96-812f-e454226b5925,19
ad925b0b-8411-41de-81df-212482545581,17
b18d3456-8403-4101-987a-e1f887735478,22
38fa68fb-ac54-4e62-84cb-c3dafc34fe09,22
9febd5fa-982f-4f40-ad1d-8e49be96cf4f,458
5ef64f01-86ae-4553-9834-c79cc0859eaf,705
0a50907c-0141-4d40-81e7-d1652b307838,32
500d7223-ecff-494b-9539-28427156c783,501
683ab61f-546f-44da-b085-c3a5740554aa,4069
0c0608b3-f349-4f5e-9a10-7e6a744dd0d2,3490
e033de6e-06c8-4bf0-9470-1b1795becf56,24
eb157f98-0697-459c-9293-ddb162ceb28b,975
f8b1bf00-5b73-4ac4-98c0-ec554027ae32,3395
ad9fce12-6b1a-400c-bcbe-29d84d065fc0,513
1753768d-e46e-40b1-8d69-a8ae5cccec03,334
1dc13b18-f9b3-4bb9-b1cf-979fcd8c2b6f,353
63cad858-8654-4956-8438-8fe79cd1208a,539
4927ef8b-e680-4fb8-b10e-2ea3eff32eab,249
26eaeb27-2fc4-4c9f-93b2-27f6afe39071,16
61db8108-45f1-43e5-ade8-83278324bc7d,25
224e3b21-30e7-4a05-9e8c-62721d581db8,2089
56fe0ab2-e4f0-47b9-8726-9ce23ebcde20,649
68a3227f-677f-43b0-9a3a-cad79d0df9e2,2951
0113eea0-c943-4fff-9780-ae0fb099e7ef,270
0d8a328f-20ce-410b-bed1-15fc01308aaf,4745
6e8f97e0-911d-4fd1-b9da-7fd57ab26729,27
df3da9d7-2d2b-44e2-99e2-08c4945a203b,757
72971b77-1d35-40b3-bb63-4c5b29f3d22b,3557
175d34a7-3823-4e4f-9f11-2464f55360b8,447
532d3874-b4b3-4c5c-acc6-749a6db26c8f,3459
cb732075-23a5-4e71-9037-50a7a002bdb2,445
d3c8a767-b6fc-45d4-a5f2-18406f2993f1,4266
de46a033-8750-4828-90cc-b25350d0fb15,18
ef184799-d79b-49d9-a662-991eaf4044cd,4131
fe037cba-25d9-42f5-a461-61d7102c17de,356
5fe4a398-1699-4442-a364-305b2f0ac01e,606
Query:
-- Corrected Query 5: Added COALESCE to handle NULL values in "points_scored"
SELECT
  "game_id",
  "team_id",
  "elapsed_time_sec",
  SUM(COALESCE("points_scored", 0)) OVER (
    PARTITION BY "game_id", "team_id"
    ORDER BY "elapsed_time_sec"
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  ) AS "cumulative_points"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE "event_type" IN (
  'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
)
LIMIT 100
Answer:
Too long, hard cut:
game_id,team_id,elapsed_time_sec,cumulative_points
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,19,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,76,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,127,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,154,0.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,190,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,257,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,276,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,319,2.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,363,5.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,411,5.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,428,5.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,433,7.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,527,9.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,550,9.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,554,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,596,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,645,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,724,11.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,757,13.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,788,13.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,809,16.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,854,18.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,895,21.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,951,24.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1001,24.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1025,26.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1063,29.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1103,29.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1110,32.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1196,32.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1224,35.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1306,35.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1336,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1358,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1361,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1398,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1411,38.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1446,40.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1476,43.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1501,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1539,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1557,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1588,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1606,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1611,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1649,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1685,45.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1698,47.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1833,49.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1893,49.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1909,51.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1933,53.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,1972,55.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2004,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2090,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2123,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2174,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2215,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e7eb,b795ddbc-baab-4499-8803-52e8608520ab,2333,57.0
a7fb1c2a-9b92-469e-82b1-2c6a6050e
Query:
-- Corrected Query 6: Adjusted condition to include both 'left' and 'right' baskets
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
  AND (
    ("team_basket" = 'left' AND "event_coord_x" < 564) OR
    ("team_basket" = 'right' AND "event_coord_x" >= 564)
  )
LIMIT 100
Answer:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:33,447,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,26ce70e0-395c-49dc-bc4c-a29c8f6e39bc,1522545300000000,Malik Newman misses two point layup,88.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:34,506,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,37617439-1421-47bb-ab37-9ef0f6b740b9,Marcus Garrett,0,b6e9792f-3623-421a-9508-a09846181106,1522545420000000,Marcus Garrett misses two point layup,99.0,255.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,11:06,534,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,6c25f209-bd61-4a1e-a239-f5996e77335b,Silvio De Sousa,22,c6b48e2d-5eee-48f3-9abd-603655af5174,1522545480000000,Silvio De Sousa misses two point layup,71.0,327.0,twopointmiss,fieldgoal,False,layup,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,18:20,100,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,2783a8f1-e87e-41db-bd9e-495044d13d85,1522544400000000,Malik Newman misses two point jump shot,240.0,177.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,Alamodome,San Antonio,TX,100 Montana Street,78203,USA,39500,68257,True,False,NCAA,Final Four,Semifinals,Game 2,Kansas,Jayhawks,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,Villanova,Wildcats,4383eb6a-7fd8-4ff2-94c5-43c933121e88,VILL,Big East,BIGEAST,NCAA Division I,D1,NCAA MEN,1,12:48,432,4383eb6a-7fd8-4ff2-94c5-43c933121e88,Jayhawks,Kansas,fae4855b-1b64-4b40-a632-9ed345e1e952,KU,Big 12,BIG12,NCAA Division I,D1,NCAA MEN,left,,c2f761c4-c052-4c3d-a11c-a1e8e7e5f3f5,Malik Newman,14,9b22a279-e1aa-4fbf-9db2-0123c78729ec,1522545300000000,Malik Newman misses two point jump shot,237.0,336.0,twopointmiss,fieldgoal,False,jump shot,,False,,,,
d20765db-ba7f-4278-bad6-e1604c9bc0f0,1522553100000000,2017,closed,1522543740000000,290e189d-f189-4c81-b4d8-8bf3221d075b,
Query:
-- Corrected Query 7: Addressed the "opponent_id" issue and calculated "score_delta" correctly
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."elapsed_time_sec",
    cs1."team_id",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
)
SELECT
  "game_id",
  "elapsed_time_sec",
  "team_id",
  "team_cumulative_points",
  "opponent_cumulative_points",
  "score_delta"
FROM opponent_scores
ORDER BY "game_id", "elapsed_time_sec", "team_id"
LIMIT 100
Answer:
Too long, hard cut:
game_id,elapsed_time_sec,team_id,team_cumulative_points,opponent_cumulative_points,score_delta
0013581b-1b6f-4851-9bd5-4a6f91294537,660,2a997096-a381-469d-a7e9-9e031c8b071c,6.0,25.0,-19.0
0013581b-1b6f-4851-9bd5-4a6f91294537,660,509aacc4-c121-46a2-800a-d5431ef181d2,25.0,6.0,19.0
00323329-7205-46c6-9add-26d1422d4b73,190,8ab00d43-840a-4c96-bdee-bf88fa6e3f11,4.0,0.0,4.0
00323329-7205-46c6-9add-26d1422d4b73,190,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,0.0,4.0,-4.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,5f9a90a2-3926-404e-8c8a-d9f22ad6907d,32.0,51.0,-19.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,d203f38a-a166-4258-bca2-e161b591ecfb,51.0,32.0,19.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,12.0,23.0,-11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,23.0,12.0,11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,38.0,60.0,-22.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,38.0,22.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,054c3e85-0552-4549-b123-7e84af6e7b6c,4.0,8.0,-4.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,612f7f66-1de1-4d42-b842-9a508daab911,8.0,4.0,4.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,8736b67f-5924-400b-bf94-3bd804c36600,27.0,12.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,c1f4aae1-aa16-4095-aeab-10e5c2a1236a,12.0,27.0,-15.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,0d037a5d-827a-44dd-8b70-57603d671d5d,12.0,13.0,-1.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,3a000455-de7c-4ca8-880e-abdce7f21da9,13.0,12.0,1.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,68d2aa5b-714f-4652-96f3-b71e1752413f,58.0,64.0,-6.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,6ef40534-5fad-4755-84de-7dcbd645d1f0,64.0,58.0,6.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,4.0,2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,2.0,4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,4.0,6.0,-2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,2.0,6.0,-4.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,8598d1b6-106b-4083-a512-2e495729525a,0.0,5.0,-5.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,a17dfc54-415f-49c3-a2e6-d6fa9db18b0a,5.0,0.0,5.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,55af9c69-3675-4b9b-a882-96640b782fff,30.0,30.0,0.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,b03bb029-4499-4a2c-9074-5071ed360b21,30.0,30.0,0.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,4b7dedc0-7b48-49a4-aad6-8a94a33274d2,32.0,12.0,20.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,fa416692-7e09-4f0a-9bcf-0cf7d5149a14,12.0,32.0,-20.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,1551b3a0-6d10-4ffa-8dfa-73b56f004553,4.0,0.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,0.0,4.0,-4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,1551b3a0-6d10-4ffa-8dfa-73b56f004553,23.0,19.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,19.0,23.0,-4.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,324ccccc-575b-4b82-acb0-fbb8e68da13b,46.0,53.0,-7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,53.0,46.0,7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,3a000455-de7c-4ca8-880e-abdce7f21da9,21.0,9.0,12.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,532d3874-b4b3-4c5c-acc6-749a6db26c8f,9.0,21.0,-12.0
00ebfaac-f8b0-4aa1-9473-b2c492898739,860,1f99a164-d593-4d81-85d5-0d7889d6f486,24.0,21.0,3.0
00ebfaac
Query:
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."team_id",
    cs1."elapsed_time_sec",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
),
categorized_scores AS (
  SELECT
    os."game_id",
    os."team_id",
    os."elapsed_time_sec",
    os."score_delta",
    CASE
      WHEN os."score_delta" < -20 THEN '<-20'
      WHEN os."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN os."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN os."score_delta" = 0 THEN '0'
      WHEN os."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN os."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN os."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM opponent_scores os
),
filtered_shots AS (
  SELECT
    pbp."game_id",
    pbp."team_id",
    pbp."shot_type",
    pbp."event_coord_x",
    pbp."event_coord_y",
    pbp."shot_made",
    cs."score_delta_interval"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  JOIN categorized_scores cs
    ON pbp."game_id" = cs."game_id"
    AND pbp."team_id" = cs."team_id"
    AND pbp."elapsed_time_sec" = cs."elapsed_time_sec"
  WHERE
    pbp."event_type" IN (
      'twopointmade', 'twopointmiss',
      'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date", 6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
)
SELECT
  "shot_type",
  "score_delta_interval",
  AVG("event_coord_x") AS "avg_x",
  AVG("event_coord_y") AS "avg_y",
  COUNT(*) AS "attempts",
  SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
FROM filtered_shots
GROUP BY "shot_type", "score_delta_interval"
ORDER BY "shot_type", "score_delta_interval"
LIMIT 100;
Answer:
shot_type,score_delta_interval,avg_x,avg_y,attempts,successful_shots
dunk,-10 — -1,500.03968253968253,288.12698412698415,126,100
dunk,-20 — -11,764.0,303.64,25,19
dunk,0,547.8709677419355,293.80645161290323,31,27
dunk,1 — 10,544.636815920398,298.7014925373134,201,167
dunk,11 — 20,639.9154929577464,287.6619718309859,71,65
dunk,<-20,757.3,296.6,10,7
dunk,>20,311.1363636363636,297.45454545454544,22,17
hook shot,-10 — -1,468.4,278.0,5,2
hook shot,1 — 10,707.6666666666666,312.6666666666667,6,5
hook shot,11 — 20,571.0,274.5,2,1
hook shot,>20,147.0,280.0,4,2
jump shot,-10 — -1,578.6933333333334,269.21666666666664,2400,492
jump shot,-20 — -11,552.4134615384615,264.55929487179486,624,145
jump shot,0,561.3392504930966,287.31163708086785,507,119
jump shot,1 — 10,522.1742685025818,264.0576592082616,2324,828
jump shot,11 — 20,582.1556350626119,280.5921288014311,559,204
jump shot,<-20,634.189090909091,283.4109090909091,275,57
jump shot,>20,474.1125,257.6791666666667,240,93
layup,-10 — -1,582.0603504218041,292.8020765736535,1541,543
layup,-20 — -11,580.0645994832041,288.312661498708,387,136
layup,0,557.0917721518987,293.0822784810127,316,116
layup,1 — 10,535.2733077905492,291.73116219667946,1566,766
layup,11 — 20,554.8384955752213,294.00221238938053,452,252
layup,<-20,599.8522727272727,292.14204545454544,176,79
layup,>20,589.9030303030303,292.1454545454545,165,92
tip shot,-10 — -1,769.7017543859649,286.56140350877195,57,17
tip shot,-20 — -11,440.3636363636364,297.0,11,3
tip shot,0,373.7142857142857,304.42857142857144,7,4
tip shot,1 — 10,650.03125,290.5,32,18
tip shot,11 — 20,516.5555555555555,282.22222222222223,9,5
tip shot,<-20,561.0,286.5,2,1
tip shot,>20,1022.75,294.25,4,4
,-10 — -1,540.2486956521739,283.9,1150,264
,-20 — -11,525.3072463768116,289.495652173913,345,66
,0,568.109756097561,282.849593495935,246,81
,1 — 10,601.8634020618557,271.5455326460481,1164,458
,11 — 20,616.1189189189189,289.31891891891894,370,148
,<-20,576.5098039215686,296.91503267973854,153,24
,>20,561.9206349206349,273.96031746031747,126,57
Query:
-- Corrected Query 2: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
SELECT "shot_type", COUNT(*) AS "attempts"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
GROUP BY "shot_type"
LIMIT 100
Answer:
shot_type,attempts
layup,335298
jump shot,675175
,194962
dunk,41638
hook shot,10822
tip shot,6012
Query:
-- Corrected Query 3: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
SELECT AVG("event_coord_x") AS "avg_x", AVG("event_coord_y") AS "avg_y"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
LIMIT 100
Answer:
avg_x,avg_y
563.6674177767826,288.375243589916
Query:
-- Corrected Query 5: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
SELECT
  "game_id",
  "team_id",
  "elapsed_time_sec",
  SUM(COALESCE("points_scored", 0)) OVER (
    PARTITION BY "game_id", "team_id"
    ORDER BY "elapsed_time_sec"
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  ) AS "cumulative_points"
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
LIMIT 100
Answer:
Too long, hard cut:
game_id,team_id,elapsed_time_sec,cumulative_points
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,34,0.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,38,2.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,97,2.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,122,2.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,185,5.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,223,8.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,260,8.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,361,8.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,400,10.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,433,13.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,493,13.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,527,16.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,573,16.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,611,18.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,731,20.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,816,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,853,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,887,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,957,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,997,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1089,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1116,23.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1131,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1198,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1219,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1300,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1310,25.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1319,27.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1382,27.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1471,29.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1515,31.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1548,33.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1763,33.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1794,33.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1804,36.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1845,36.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1880,36.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,1958,39.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2005,41.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2037,41.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2045,41.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2071,43.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2097,46.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2140,46.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2149,46.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2173,48.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2199,48.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2254,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2372,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2381,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2390,50.0
78c4b02b-08d9-4198-bee6-65da1f414891,dfe0d93f-94a5-47fb-b7aa-f74786e09acb,2398,53.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,28,3.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,54,3.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,82,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,118,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,179,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,213,6.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778d005-cc14-4e58-9bf2-3fc37bffb62f,259,8.0
4c374ce9-2f7a-413d-bcd7-568ba432bc42,2778
Query:
-- Corrected Query 6: Added TO_TIMESTAMP_LTZ if date filtering is needed
SELECT *
FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
WHERE
  "event_type" IN (
    'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
  )
  AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'  -- Include if date filtering is required
  AND (
    ("team_basket" = 'left' AND "event_coord_x" < 564) OR
    ("team_basket" = 'right' AND "event_coord_x" >= 564)
  )
LIMIT 100
Answer:
Too long, hard cut:
game_id,load_timestamp,season,status,scheduled_date,venue_id,venue_name,venue_city,venue_state,venue_address,venue_zip,venue_country,venue_capacity,attendance,neutral_site,conference_game,tournament,tournament_type,round,game_no,away_market,away_name,away_id,away_alias,away_conf_name,away_conf_alias,away_division_name,away_division_alias,away_league_name,home_market,home_name,home_id,home_alias,home_conf_name,home_conf_alias,home_division_name,home_division_alias,home_league_name,period,game_clock,elapsed_time_sec,possession_arrow,team_name,team_market,team_id,team_alias,team_conf_name,team_conf_alias,team_division_name,team_division_alias,team_league_name,team_basket,possession_team_id,player_id,player_full_name,jersey_num,event_id,timestamp,event_description,event_coord_x,event_coord_y,event_type,type,shot_made,shot_type,shot_subtype,three_point_shot,points_scored,turnover_type,rebound_type,timeout_duration
c0e7cc4d-1174-486b-8e01-bc6012ca2134,1517496492093594,2013,closed,1384822800000000,a48ecb87-3324-4b79-846e-a51d1c16d423,Coleman Coliseum,Tuscaloosa,AL,323 Paul W Bryant Dr ,35487,USA,15383.0,9903,False,False,,,,,Stillman,Tigers,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,Alabama,Crimson Tide,c2104cdc-c83d-40d2-a3cd-df986e29f5d3,ALA,Southeastern,SEC,NCAA Division I,D1,NCAA MEN,2,2:09,2271,,Tigers,Stillman,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,left,,3f2841ac-176e-42db-b604-5b75d489e783,Justin Harris,12,4b23df72-ad8f-4e93-8857-29bf113eaf64,1384829359000000,Justin Harris misses three point shot,345.0,279.0,threepointmiss,fieldgoal,False,,,True,,,,
c0e7cc4d-1174-486b-8e01-bc6012ca2134,1517496492093594,2013,closed,1384822800000000,a48ecb87-3324-4b79-846e-a51d1c16d423,Coleman Coliseum,Tuscaloosa,AL,323 Paul W Bryant Dr ,35487,USA,15383.0,9903,False,False,,,,,Stillman,Tigers,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,Alabama,Crimson Tide,c2104cdc-c83d-40d2-a3cd-df986e29f5d3,ALA,Southeastern,SEC,NCAA Division I,D1,NCAA MEN,1,4:45,915,,Tigers,Stillman,4cf80361-fa24-4d49-ae45-1c4f044148e9,STIL,Southern Intercollegiate Athletic Conference,SIAC,NCAA Division II,D2,NCAA MEN,right,c2104cdc-c83d-40d2-a3cd-df986e29f5d3,ed363926-f232-436f-a8ca-6b1dc7f9a999,Stanley Magee,22,f4a67a1b-0129-4500-9321-f7b1bfc2d30b,1384825214000000,Stanley Magee makes two point shot ,1020.0,288.0,twopointmade,fieldgoal,True,,,False,2.0,,,
7ffb3ec0-4268-469e-ad1a-340996ec5da5,1517496331930195,2014,closed,1425747600000000,5f1a51e1-bdd9-43a2-8743-c37f20265346,PNC Arena,Raleigh,NC,1400 Edward Mill Rd,27607,USA,19722.0,18659,,,,,,,Syracuse,Orange,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,North Carolina State,Wolfpack,52df1e19-b142-4a76-a439-ad68455d0581,NCST,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,2,2:30,2250,,Orange,Syracuse,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,left,,333cbd0d-159e-413f-b355-96a2a03f076f,Trevor Cooney,10,de951fbe-2c1f-4b3f-9c41-f6cd5f4f045e,1425754793000000,Trevor Cooney misses three point jump shot,261.0,125.0,threepointmiss,fieldgoal,False,jump shot,,True,,,,
1046ee1e-c20b-433c-a7e1-dc8361bcd92f,1517485986342728,2016,closed,1485993600000000,5f1a51e1-bdd9-43a2-8743-c37f20265346,PNC Arena,Raleigh,NC,1400 Edward Mill Rd,27607,USA,19722.0,16346,False,True,,,,,Syracuse,Orange,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,North Carolina State,Wolfpack,52df1e19-b142-4a76-a439-ad68455d0581,NCST,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,1,2:16,1064,52df1e19-b142-4a76-a439-ad68455d0581,Orange,Syracuse,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,right,52df1e19-b142-4a76-a439-ad68455d0581,1e6903f5-6490-4788-8dea-5fe8f1113f71,Tyler Lydon,20,56eb2304-767f-4e63-8739-b02f6c0b14bc,1485995985000000,Tyler Lydon makes three point jump shot,770.0,322.0,threepointmade,fieldgoal,True,jump shot,,True,3.0,,,
7ffb3ec0-4268-469e-ad1a-340996ec5da5,1517496331930195,2014,closed,1425747600000000,5f1a51e1-bdd9-43a2-8743-c37f20265346,PNC Arena,Raleigh,NC,1400 Edward Mill Rd,27607,USA,19722.0,18659,,,,,,,Syracuse,Orange,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,North Carolina State,Wolfpack,52df1e19-b142-4a76-a439-ad68455d0581,NCST,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,1,5:33,867,,Orange,Syracuse,8cd24de1-2be8-4b77-bcfa-47be0495a5f4,SYR,Atlantic Coast,ACC,NCAA Division I,D1,NCAA MEN,right,,08d0ed3c-6068-40f4-9d80-07fa4404f862,Tyler Roberson,21,73532723-f534-4e2d-b4c5-0950e4321a9b,1425749940000000,Beejay Anya blocks Tyler Roberson's two point layup,1007.0,348.0,twopointmiss,fieldgoal,False,layup,,False,,,,
1046ee1e-c20b-433c-a7e1-dc8361bcd92f,1517485986342728,2016,closed,1485993600000
Query:
-- Corrected Query 7: Added TO_TIMESTAMP_LTZ to handle "scheduled_date" comparison
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."elapsed_time_sec",
    cs1."team_id",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
)
SELECT
  "game_id",
  "elapsed_time_sec",
  "team_id",
  "team_cumulative_points",
  "opponent_cumulative_points",
  "score_delta"
FROM opponent_scores
ORDER BY "game_id", "elapsed_time_sec", "team_id"
LIMIT 100
Answer:
Too long, hard cut:
game_id,elapsed_time_sec,team_id,team_cumulative_points,opponent_cumulative_points,score_delta
0013581b-1b6f-4851-9bd5-4a6f91294537,660,2a997096-a381-469d-a7e9-9e031c8b071c,6.0,25.0,-19.0
0013581b-1b6f-4851-9bd5-4a6f91294537,660,509aacc4-c121-46a2-800a-d5431ef181d2,25.0,6.0,19.0
00323329-7205-46c6-9add-26d1422d4b73,190,8ab00d43-840a-4c96-bdee-bf88fa6e3f11,4.0,0.0,4.0
00323329-7205-46c6-9add-26d1422d4b73,190,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,0.0,4.0,-4.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,5f9a90a2-3926-404e-8c8a-d9f22ad6907d,32.0,51.0,-19.0
003307ed-33a0-4ef5-8a53-cc65d2862a11,2050,d203f38a-a166-4258-bca2-e161b591ecfb,51.0,32.0,19.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,4.0,5.0,-1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,237,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,5.0,4.0,1.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,12.0,23.0,-11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,668,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,23.0,12.0,11.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,c1c1e6df-a383-4fbd-ba7b-32d4f9ef9518,38.0,60.0,-22.0
003dcde4-42ff-4722-ab9f-84b8802ee498,1908,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,38.0,22.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,054c3e85-0552-4549-b123-7e84af6e7b6c,4.0,8.0,-4.0
005788bc-1e7a-421e-bda6-d5e97dcce486,233,612f7f66-1de1-4d42-b842-9a508daab911,8.0,4.0,4.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,683ab61f-546f-44da-b085-c3a5740554aa,25.0,40.0,-15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
00715daf-38b6-4bd1-b39a-c9f88b277c0f,1346,ad4bc983-8d2e-4e6f-a8f9-80840a786c64,40.0,25.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,8736b67f-5924-400b-bf94-3bd804c36600,27.0,12.0,15.0
0093a91e-c7d4-4a2e-98aa-d1023e2b11af,832,c1f4aae1-aa16-4095-aeab-10e5c2a1236a,12.0,27.0,-15.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,0d037a5d-827a-44dd-8b70-57603d671d5d,12.0,13.0,-1.0
009ac481-7a9d-4bc5-aa0f-602dabb5317d,467,3a000455-de7c-4ca8-880e-abdce7f21da9,13.0,12.0,1.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,68d2aa5b-714f-4652-96f3-b71e1752413f,58.0,64.0,-6.0
00b5ee9d-f553-4971-bc8a-f62e5c04da70,2233,6ef40534-5fad-4755-84de-7dcbd645d1f0,64.0,58.0,6.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,4.0,2.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,e9ca48b2-00ba-41c0-a02b-6885a2da1ff1,6.0,2.0,4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,2.0,6.0,-4.0
00bb32d8-67a2-4c8a-a312-dae4d4f1d8a2,170,faeb1160-5d15-4f26-99fc-c441cf21fc7f,4.0,6.0,-2.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,8598d1b6-106b-4083-a512-2e495729525a,0.0,5.0,-5.0
00c0a5b6-eb54-4c6a-b493-3a84fe2c7874,256,a17dfc54-415f-49c3-a2e6-d6fa9db18b0a,5.0,0.0,5.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,55af9c69-3675-4b9b-a882-96640b782fff,30.0,30.0,0.0
00c1e71e-78fa-481c-a7f0-81a1c49da5a2,1271,b03bb029-4499-4a2c-9074-5071ed360b21,30.0,30.0,0.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,4b7dedc0-7b48-49a4-aad6-8a94a33274d2,32.0,12.0,20.0
00c2cbda-77bb-472a-8985-479067ae9286,1019,fa416692-7e09-4f0a-9bcf-0cf7d5149a14,12.0,32.0,-20.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,1551b3a0-6d10-4ffa-8dfa-73b56f004553,4.0,0.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,116,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,0.0,4.0,-4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,1551b3a0-6d10-4ffa-8dfa-73b56f004553,23.0,19.0,4.0
00c4c0af-4574-42bd-b15c-81a66165a64b,1122,399ad7fb-de60-45a6-a71f-d26e00f1a4ec,19.0,23.0,-4.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,324ccccc-575b-4b82-acb0-fbb8e68da13b,46.0,53.0,-7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,1811,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,53.0,46.0,7.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,324ccccc-575b-4b82-acb0-fbb8e68da13b,55.0,60.0,-5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00d5bbe5-1dcd-4aac-90f0-37d90d29b746,2265,d3c8a767-b6fc-45d4-a5f2-18406f2993f1,60.0,55.0,5.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,3a000455-de7c-4ca8-880e-abdce7f21da9,21.0,9.0,12.0
00e9c1ae-22d6-491f-89fc-1dcf7c98c9e1,658,532d3874-b4b3-4c5c-acc6-749a6db26c8f,9.0,21.0,-12.0
00ebfaac-f8b0-4aa1-9473-b2c492898739,860,1f99a164-d593-4d81-85d5-0d7889d6f486,24.0,21.0,3.0
00ebfaac
Query:
-- Corrected Query 8: Included the corrected date conversion
WITH cumulative_scores AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    SUM(COALESCE("points_scored", 0)) OVER (
      PARTITION BY "game_id", "team_id"
      ORDER BY "elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR
  WHERE
    "event_type" IN (
      'twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ("scheduled_date", 6) < DATE '2018-03-15'
),
opponent_scores AS (
  SELECT
    cs1."game_id",
    cs1."team_id",
    cs1."elapsed_time_sec",
    cs1."team_cumulative_points",
    cs2."team_cumulative_points" AS "opponent_cumulative_points",
    cs1."team_cumulative_points" - cs2."team_cumulative_points" AS "score_delta"
  FROM cumulative_scores cs1
  JOIN cumulative_scores cs2
    ON cs1."game_id" = cs2."game_id"
    AND cs1."elapsed_time_sec" = cs2."elapsed_time_sec"
    AND cs1."team_id" <> cs2."team_id"
),
categorized_scores AS (
  SELECT
    os."game_id",
    os."team_id",
    os."elapsed_time_sec",
    os."score_delta",
    CASE
      WHEN os."score_delta" < -20 THEN '<-20'
      WHEN os."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN os."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN os."score_delta" = 0 THEN '0'
      WHEN os."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN os."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN os."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM opponent_scores os
),
filtered_shots AS (
  SELECT
    pbp."game_id",
    pbp."team_id",
    pbp."shot_type",
    pbp."event_coord_x",
    pbp."event_coord_y",
    pbp."shot_made",
    cs."score_delta_interval"
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  JOIN categorized_scores cs
    ON pbp."game_id" = cs."game_id"
    AND pbp."team_id" = cs."team_id"
    AND pbp."elapsed_time_sec" = cs."elapsed_time_sec"
  WHERE
    pbp."event_type" IN (
      'twopointmade', 'twopointmiss',
      'threepointmade', 'threepointmiss'
    )
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date", 6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
)
SELECT
  "shot_type",
  "score_delta_interval",
  AVG("event_coord_x") AS "avg_x",
  AVG("event_coord_y") AS "avg_y",
  COUNT(*) AS "attempts",
  SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
FROM filtered_shots
GROUP BY "shot_type", "score_delta_interval"
ORDER BY "shot_type", "score_delta_interval"
LIMIT 100
Answer:
shot_type,score_delta_interval,avg_x,avg_y,attempts,successful_shots
dunk,-10 — -1,496.136,287.944,125,100
dunk,-20 — -11,764.0,303.64,25,19
dunk,0,562.6176470588235,295.29411764705884,34,29
dunk,1 — 10,548.7969543147208,298.56852791878174,197,163
dunk,11 — 20,625.1506849315068,288.0,73,67
dunk,<-20,757.3,296.6,10,7
dunk,>20,311.1363636363636,297.45454545454544,22,17
hook shot,-10 — -1,468.4,278.0,5,2
hook shot,1 — 10,707.6666666666666,312.6666666666667,6,5
hook shot,11 — 20,571.0,274.5,2,1
hook shot,>20,147.0,280.0,4,2
jump shot,-10 — -1,580.5336436732966,267.93694456199745,2363,483
jump shot,-20 — -11,555.180817610063,263.84591194968556,636,149
jump shot,0,568.7423076923077,294.2096153846154,520,114
jump shot,1 — 10,518.2226042114311,263.7645036527718,2327,831
jump shot,11 — 20,581.6302816901408,280.49295774647885,568,211
jump shot,<-20,634.9890909090909,283.6218181818182,275,58
jump shot,>20,474.09166666666664,258.95,240,92
layup,-10 — -1,588.4039087947883,292.5817589576547,1535,540
layup,-20 — -11,570.2342569269522,288.64987405541564,397,142
layup,0,580.4448051948052,293.41883116883116,308,115
layup,1 — 10,526.9187460012796,291.7613563659629,1563,760
layup,11 — 20,555.6017316017316,294.2294372294372,462,259
layup,<-20,595.1896551724138,291.9425287356322,174,77
layup,>20,592.859756097561,292.2256097560976,164,91
tip shot,-10 — -1,758.3103448275862,287.8103448275862,58,18
tip shot,-20 — -11,440.3636363636364,297.0,11,3
tip shot,0,417.8333333333333,295.3333333333333,6,3
tip shot,1 — 10,650.03125,290.5,32,18
tip shot,11 — 20,516.5555555555555,282.22222222222223,9,5
tip shot,<-20,561.0,286.5,2,1
tip shot,>20,1022.75,294.25,4,4
,-10 — -1,541.8217993079585,283.6643598615917,1156,264
,-20 — -11,525.163323782235,289.5587392550143,349,67
,0,552.7285067873303,286.7420814479638,221,77
,1 — 10,603.0256191289496,271.47566182749785,1171,457
,11 — 20,616.0873015873016,287.9074074074074,378,152
,<-20,576.5098039215686,296.91503267973854,153,24
,>20,561.9206349206349,273.96031746031747,126,57
End Exploring Related Columns
Task: Can you find the average x and y coordinates, the average number of shot attempts, and the average number of successful shots for the most frequent score delta interval in each shot type, considering only shots taken before March 15, 2018, and ensuring that the shots are on the correct side of the court based on the team's basket?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Unfortunately, the necessary data to compute the score delta intervals is not available in the provided tables. The `MBB_PBP_SR` table does not include the running scores needed to calculate the score difference (`score_delta`) at each shot attempt. Without this information, we cannot determine the most frequent score delta interval for each shot type, and therefore cannot compute the requested averages within those intervals.

As such, we are unable to fulfill your request with the given data..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NCAA_BASKETBALL': {'NCAA_BASKETBALL': ['MASCOTS', 'MBB_GAMES_SR', 'MBB_HISTORICAL_TEAMS_GAMES', 'MBB_HISTORICAL_TEAMS_SEASONS', 'MBB_HISTORICAL_TOURNAMENT_GAMES', 'MBB_PBP_SR', 'MBB_PLAYERS_GAMES_SR', 'MBB_TEAMS', 'MBB_TEAMS_GAMES_SR', 'TEAM_COLORS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 17:56:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:56:10 - root - INFO - ```sql
WITH CorrectShots AS (
  SELECT
    pbp.*
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  WHERE
    pbp."event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
    AND pbp."scheduled_date" < '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
),
GameElapsedTimes AS (
  SELECT DISTINCT "game_id", "elapsed_time_sec"
  FROM CorrectShots
),
TeamsPerGame AS (
  SELECT DISTINCT "game_id", "team_id"
  FROM CorrectShots
),
TimeTeamGrid AS (
  SELECT
    get."game_id",
    get."elapsed_time_sec",
    tpg."team_id"
  FROM GameElapsedTimes get
  JOIN TeamsPerGame tpg
    ON get."game_id" = tpg."game_id"
),
TeamEvents AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    COALESCE("points_scored", 0) AS "points_scored"
  FROM CorrectShots
),
TimeTeamPoints AS (
  SELECT
    ttg."game_id",
    ttg."team_id",
    ttg."elapsed_time_sec",
    COALESCE(SUM(te."points_scored"), 0) AS "points_scored"
  FROM TimeTeamGrid ttg
  LEFT JOIN TeamEvents te
    ON ttg."game_id" = te."game_id"
    AND ttg."team_id" = te."team_id"
    AND ttg."elapsed_time_sec" = te."elapsed_time_sec"
  GROUP BY ttg."game_id", ttg."team_id", ttg."elapsed_time_sec"
),
CumulativeTeamScores AS (
  SELECT
    ttp."game_id",
    ttp."team_id",
    ttp."elapsed_time_sec",
    SUM(ttp."points_scored") OVER (
      PARTITION BY ttp."game_id", ttp."team_id"
      ORDER BY ttp."elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM TimeTeamPoints ttp
),
CumulativeScoresWithOpponent AS (
  SELECT
    cts1."game_id",
    cts1."team_id",
    cts1."elapsed_time_sec",
    cts1."team_cumulative_points",
    cts2."team_cumulative_points" AS "opponent_cumulative_points",
    cts1."team_cumulative_points" - cts2."team_cumulative_points" AS "score_delta"
  FROM CumulativeTeamScores cts1
  JOIN CumulativeTeamScores cts2
    ON cts1."game_id" = cts2."game_id"
    AND cts1."elapsed_time_sec" = cts2."elapsed_time_sec"
    AND cts1."team_id" <> cts2."team_id"
),
CategorizedScores AS (
  SELECT
    cts.*,
    CASE
      WHEN cts."score_delta" < -20 THEN '<-20'
      WHEN cts."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN cts."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN cts."score_delta" = 0 THEN '0'
      WHEN cts."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN cts."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN cts."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM CumulativeScoresWithOpponent cts
),
ShotsWithDelta AS (
  SELECT
    csd."game_id",
    csd."team_id",
    csd."elapsed_time_sec",
    csd."score_delta_interval",
    csd."score_delta",
    cs."shot_type",
    cs."event_coord_x",
    cs."event_coord_y",
    cs."shot_made"
  FROM CategorizedScores csd
  JOIN CorrectShots cs
    ON csd."game_id" = cs."game_id"
    AND csd."team_id" = cs."team_id"
    AND csd."elapsed_time_sec" = cs."elapsed_time_sec"
),
ShotTypeIntervalCounts AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    COUNT(*) AS "attempts",
    SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
  FROM ShotsWithDelta
  GROUP BY "shot_type", "score_delta_interval"
),
MostFrequentIntervals AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    "attempts",
    ROW_NUMBER() OVER (PARTITION BY "shot_type" ORDER BY "attempts" DESC) AS "rn"
  FROM ShotTypeIntervalCounts
),
MostFrequentPerShotType AS (
  SELECT
    "shot_type",
    "score_delta_interval"
  FROM MostFrequentIntervals
  WHERE "rn" = 1
)
SELECT
  s."shot_type",
  s."score_delta_interval",
  AVG(s."event_coord_x") AS "avg_x",
  AVG(s."event_coord_y") AS "avg_y",
  COUNT(*) AS "avg_attempts",
  SUM(CASE WHEN s."shot_made" = TRUE THEN 1 ELSE 0 END) AS "avg_successful_shots"
FROM ShotsWithDelta s
JOIN MostFrequentPerShotType mf
  ON s."shot_type" = mf."shot_type" AND s."score_delta_interval" = mf."score_delta_interval"
GROUP BY s."shot_type", s."score_delta_interval"
ORDER BY s."shot_type"
;
```
2025-01-26 17:56:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:56:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:56:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:56:12 - snowflake.connector.connection - INFO - closed
2025-01-26 17:56:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:56:13 - root - INFO - itercount: 1
2025-01-26 17:56:13 - root - INFO - 100038 (22018): 01b9f974-0004-8343-0001-11c300fba4da: Numeric value '2018-03-15' is not recognized
2025-01-26 17:56:13 - root - INFO - Input sql:
WITH CorrectShots AS (
  SELECT
    pbp.*
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  WHERE
    pbp."event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
    AND pbp."scheduled_date" < '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
),
GameElapsedTimes AS (
  SELECT DISTINCT "game_id", "elapsed_time_sec"
  FROM CorrectShots
),
TeamsPerGame AS (
  SELECT DISTINCT "game_id", "team_id"
  FROM CorrectShots
),
TimeTeamGrid AS (
  SELECT
    get."game_id",
    get."elapsed_time_sec",
    tpg."team_id"
  FROM GameElapsedTimes get
  JOIN TeamsPerGame tpg
    ON get."game_id" = tpg."game_id"
),
TeamEvents AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    COALESCE("points_scored", 0) AS "points_scored"
  FROM CorrectShots
),
TimeTeamPoints AS (
  SELECT
    ttg."game_id",
    ttg."team_id",
    ttg."elapsed_time_sec",
    COALESCE(SUM(te."points_scored"), 0) AS "points_scored"
  FROM TimeTeamGrid ttg
  LEFT JOIN TeamEvents te
    ON ttg."game_id" = te."game_id"
    AND ttg."team_id" = te."team_id"
    AND ttg."elapsed_time_sec" = te."elapsed_time_sec"
  GROUP BY ttg."game_id", ttg."team_id", ttg."elapsed_time_sec"
),
CumulativeTeamScores AS (
  SELECT
    ttp."game_id",
    ttp."team_id",
    ttp."elapsed_time_sec",
    SUM(ttp."points_scored") OVER (
      PARTITION BY ttp."game_id", ttp."team_id"
      ORDER BY ttp."elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM TimeTeamPoints ttp
),
CumulativeScoresWithOpponent AS (
  SELECT
    cts1."game_id",
    cts1."team_id",
    cts1."elapsed_time_sec",
    cts1."team_cumulative_points",
    cts2."team_cumulative_points" AS "opponent_cumulative_points",
    cts1."team_cumulative_points" - cts2."team_cumulative_points" AS "score_delta"
  FROM CumulativeTeamScores cts1
  JOIN CumulativeTeamScores cts2
    ON cts1."game_id" = cts2."game_id"
    AND cts1."elapsed_time_sec" = cts2."elapsed_time_sec"
    AND cts1."team_id" <> cts2."team_id"
),
CategorizedScores AS (
  SELECT
    cts.*,
    CASE
      WHEN cts."score_delta" < -20 THEN '<-20'
      WHEN cts."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN cts."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN cts."score_delta" = 0 THEN '0'
      WHEN cts."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN cts."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN cts."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM CumulativeScoresWithOpponent cts
),
ShotsWithDelta AS (
  SELECT
    csd."game_id",
    csd."team_id",
    csd."elapsed_time_sec",
    csd."score_delta_interval",
    csd."score_delta",
    cs."shot_type",
    cs."event_coord_x",
    cs."event_coord_y",
    cs."shot_made"
  FROM CategorizedScores csd
  JOIN CorrectShots cs
    ON csd."game_id" = cs."game_id"
    AND csd."team_id" = cs."team_id"
    AND csd."elapsed_time_sec" = cs."elapsed_time_sec"
),
ShotTypeIntervalCounts AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    COUNT(*) AS "attempts",
    SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
  FROM ShotsWithDelta
  GROUP BY "shot_type", "score_delta_interval"
),
MostFrequentIntervals AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    "attempts",
    ROW_NUMBER() OVER (PARTITION BY "shot_type" ORDER BY "attempts" DESC) AS "rn"
  FROM ShotTypeIntervalCounts
),
MostFrequentPerShotType AS (
  SELECT
    "shot_type",
    "score_delta_interval"
  FROM MostFrequentIntervals
  WHERE "rn" = 1
)
SELECT
  s."shot_type",
  s."score_delta_interval",
  AVG(s."event_coord_x") AS "avg_x",
  AVG(s."event_coord_y") AS "avg_y",
  COUNT(*) AS "avg_attempts",
  SUM(CASE WHEN s."shot_made" = TRUE THEN 1 ELSE 0 END) AS "avg_successful_shots"
FROM ShotsWithDelta s
JOIN MostFrequentPerShotType mf
  ON s."shot_type" = mf."shot_type" AND s."score_delta_interval" = mf."score_delta_interval"
GROUP BY s."shot_type", s."score_delta_interval"
ORDER BY s."shot_type"
;
The error information is:
100038 (22018): 01b9f974-0004-8343-0001-11c300fba4da: Numeric value '2018-03-15' is not recognized
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-26 17:57:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:57:05 - root - INFO - ```sql
WITH CorrectShots AS (
  SELECT
    pbp.*
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  WHERE
    pbp."event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date" / 1e6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
),
GameElapsedTimes AS (
  SELECT DISTINCT "game_id", "elapsed_time_sec"
  FROM CorrectShots
),
TeamsPerGame AS (
  SELECT DISTINCT "game_id", "team_id"
  FROM CorrectShots
),
TimeTeamGrid AS (
  SELECT
    get."game_id",
    get."elapsed_time_sec",
    tpg."team_id"
  FROM GameElapsedTimes get
  JOIN TeamsPerGame tpg
    ON get."game_id" = tpg."game_id"
),
TeamEvents AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    COALESCE("points_scored", 0) AS "points_scored"
  FROM CorrectShots
),
TimeTeamPoints AS (
  SELECT
    ttg."game_id",
    ttg."team_id",
    ttg."elapsed_time_sec",
    COALESCE(SUM(te."points_scored"), 0) AS "points_scored"
  FROM TimeTeamGrid ttg
  LEFT JOIN TeamEvents te
    ON ttg."game_id" = te."game_id"
    AND ttg."team_id" = te."team_id"
    AND ttg."elapsed_time_sec" = te."elapsed_time_sec"
  GROUP BY ttg."game_id", ttg."team_id", ttg."elapsed_time_sec"
),
CumulativeTeamScores AS (
  SELECT
    ttp."game_id",
    ttp."team_id",
    ttp."elapsed_time_sec",
    SUM(ttp."points_scored") OVER (
      PARTITION BY ttp."game_id", ttp."team_id"
      ORDER BY ttp."elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM TimeTeamPoints ttp
),
CumulativeScoresWithOpponent AS (
  SELECT
    cts1."game_id",
    cts1."team_id",
    cts1."elapsed_time_sec",
    cts1."team_cumulative_points",
    cts2."team_cumulative_points" AS "opponent_cumulative_points",
    cts1."team_cumulative_points" - cts2."team_cumulative_points" AS "score_delta"
  FROM CumulativeTeamScores cts1
  JOIN CumulativeTeamScores cts2
    ON cts1."game_id" = cts2."game_id"
    AND cts1."elapsed_time_sec" = cts2."elapsed_time_sec"
    AND cts1."team_id" <> cts2."team_id"
),
CategorizedScores AS (
  SELECT
    cts.*,
    CASE
      WHEN cts."score_delta" < -20 THEN '<-20'
      WHEN cts."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN cts."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN cts."score_delta" = 0 THEN '0'
      WHEN cts."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN cts."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN cts."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM CumulativeScoresWithOpponent cts
),
ShotsWithDelta AS (
  SELECT
    csd."game_id",
    csd."team_id",
    csd."elapsed_time_sec",
    csd."score_delta_interval",
    csd."score_delta",
    cs."shot_type",
    cs."event_coord_x",
    cs."event_coord_y",
    cs."shot_made"
  FROM CategorizedScores csd
  JOIN CorrectShots cs
    ON csd."game_id" = cs."game_id"
    AND csd."team_id" = cs."team_id"
    AND csd."elapsed_time_sec" = cs."elapsed_time_sec"
),
ShotTypeIntervalCounts AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    COUNT(*) AS "attempts",
    SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
  FROM ShotsWithDelta
  GROUP BY "shot_type", "score_delta_interval"
),
MostFrequentIntervals AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    "attempts",
    ROW_NUMBER() OVER (PARTITION BY "shot_type" ORDER BY "attempts" DESC NULLS LAST) AS "rn"
  FROM ShotTypeIntervalCounts
),
MostFrequentPerShotType AS (
  SELECT
    "shot_type",
    "score_delta_interval"
  FROM MostFrequentIntervals
  WHERE "rn" = 1
)
SELECT
  s."shot_type",
  s."score_delta_interval",
  AVG(s."event_coord_x") AS "avg_x",
  AVG(s."event_coord_y") AS "avg_y",
  COUNT(*) AS "avg_attempts",
  SUM(CASE WHEN s."shot_made" = TRUE THEN 1 ELSE 0 END) AS "avg_successful_shots"
FROM ShotsWithDelta s
JOIN MostFrequentPerShotType mf
  ON s."shot_type" = mf."shot_type" AND s."score_delta_interval" = mf."score_delta_interval"
GROUP BY s."shot_type", s."score_delta_interval"
ORDER BY s."shot_type" NULLS LAST
;
```
2025-01-26 17:57:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:57:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:57:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:57:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-26 17:57:08 - snowflake.connector.connection - INFO - closed
2025-01-26 17:57:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:57:08 - root - INFO - itercount: 2
2025-01-26 17:57:08 - root - INFO - 0
2025-01-26 17:57:08 - root - INFO - results: 
shot_type,score_delta_interval,avg_x,avg_y,avg_attempts,avg_successful_shots
dunk,1 — 10,565.3303840361446,294.5206450803213,15936,14421
hook shot,1 — 10,546.3658102264055,287.3373187484101,3931,2117
jump shot,1 — 10,565.8052282545647,285.55762854199315,231014,95898
layup,1 — 10,568.0513569249965,294.0324674199362,115408,69966
tip shot,1 — 10,577.9232995658466,293.1167390255668,2073,1355


2025-01-26 17:57:08 - root - INFO - Please check the answer again by reviewing Can you find the average x and y coordinates, the average number of shot attempts, and the average number of successful shots for the most frequent score delta interval in each shot type, considering only shots taken before March 15, 2018, and ensuring that the shots are on the correct side of the court based on the team's basket?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Unfortunately, the necessary data to compute the score delta intervals is not available in the provided tables. The `MBB_PBP_SR` table does not include the running scores needed to calculate the score difference (`score_delta`) at each shot attempt. Without this information, we cannot determine the most frequent score delta interval for each shot type, and therefore cannot compute the requested averages within those intervals.

As such, we are unable to fulfill your request with the given data. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
shot_type,score_delta_interval,avg_x,avg_y,avg_attempts,avg_successful_shots
dunk,1 — 10,565.3303840361446,294.5206450803213,15936,14421
hook shot,1 — 10,546.3658102264055,287.3373187484101,3931,2117
jump shot,1 — 10,565.8052282545647,285.55762854199315,231014,95898
layup,1 — 10,568.0513569249965,294.0324674199362,115408,69966
tip shot,1 — 10,577.9232995658466,293.1167390255668,2073,1355
Current sql:
WITH CorrectShots AS (
  SELECT
    pbp.*
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  WHERE
    pbp."event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date" / 1e6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
),
GameElapsedTimes AS (
  SELECT DISTINCT "game_id", "elapsed_time_sec"
  FROM CorrectShots
),
TeamsPerGame AS (
  SELECT DISTINCT "game_id", "team_id"
  FROM CorrectShots
),
TimeTeamGrid AS (
  SELECT
    get."game_id",
    get."elapsed_time_sec",
    tpg."team_id"
  FROM GameElapsedTimes get
  JOIN TeamsPerGame tpg
    ON get."game_id" = tpg."game_id"
),
TeamEvents AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    COALESCE("points_scored", 0) AS "points_scored"
  FROM CorrectShots
),
TimeTeamPoints AS (
  SELECT
    ttg."game_id",
    ttg."team_id",
    ttg."elapsed_time_sec",
    COALESCE(SUM(te."points_scored"), 0) AS "points_scored"
  FROM TimeTeamGrid ttg
  LEFT JOIN TeamEvents te
    ON ttg."game_id" = te."game_id"
    AND ttg."team_id" = te."team_id"
    AND ttg."elapsed_time_sec" = te."elapsed_time_sec"
  GROUP BY ttg."game_id", ttg."team_id", ttg."elapsed_time_sec"
),
CumulativeTeamScores AS (
  SELECT
    ttp."game_id",
    ttp."team_id",
    ttp."elapsed_time_sec",
    SUM(ttp."points_scored") OVER (
      PARTITION BY ttp."game_id", ttp."team_id"
      ORDER BY ttp."elapsed_time_sec"
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM TimeTeamPoints ttp
),
CumulativeScoresWithOpponent AS (
  SELECT
    cts1."game_id",
    cts1."team_id",
    cts1."elapsed_time_sec",
    cts1."team_cumulative_points",
    cts2."team_cumulative_points" AS "opponent_cumulative_points",
    cts1."team_cumulative_points" - cts2."team_cumulative_points" AS "score_delta"
  FROM CumulativeTeamScores cts1
  JOIN CumulativeTeamScores cts2
    ON cts1."game_id" = cts2."game_id"
    AND cts1."elapsed_time_sec" = cts2."elapsed_time_sec"
    AND cts1."team_id" <> cts2."team_id"
),
CategorizedScores AS (
  SELECT
    cts.*,
    CASE
      WHEN cts."score_delta" < -20 THEN '<-20'
      WHEN cts."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN cts."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN cts."score_delta" = 0 THEN '0'
      WHEN cts."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN cts."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN cts."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM CumulativeScoresWithOpponent cts
),
ShotsWithDelta AS (
  SELECT
    csd."game_id",
    csd."team_id",
    csd."elapsed_time_sec",
    csd."score_delta_interval",
    csd."score_delta",
    cs."shot_type",
    cs."event_coord_x",
    cs."event_coord_y",
    cs."shot_made"
  FROM CategorizedScores csd
  JOIN CorrectShots cs
    ON csd."game_id" = cs."game_id"
    AND csd."team_id" = cs."team_id"
    AND csd."elapsed_time_sec" = cs."elapsed_time_sec"
),
ShotTypeIntervalCounts AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    COUNT(*) AS "attempts",
    SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
  FROM ShotsWithDelta
  GROUP BY "shot_type", "score_delta_interval"
),
MostFrequentIntervals AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    "attempts",
    ROW_NUMBER() OVER (PARTITION BY "shot_type" ORDER BY "attempts" DESC NULLS LAST) AS "rn"
  FROM ShotTypeIntervalCounts
),
MostFrequentPerShotType AS (
  SELECT
    "shot_type",
    "score_delta_interval"
  FROM MostFrequentIntervals
  WHERE "rn" = 1
)
SELECT
  s."shot_type",
  s."score_delta_interval",
  AVG(s."event_coord_x") AS "avg_x",
  AVG(s."event_coord_y") AS "avg_y",
  COUNT(*) AS "avg_attempts",
  SUM(CASE WHEN s."shot_made" = TRUE THEN 1 ELSE 0 END) AS "avg_successful_shots"
FROM ShotsWithDelta s
JOIN MostFrequentPerShotType mf
  ON s."shot_type" = mf."shot_type" AND s."score_delta_interval" = mf."score_delta_interval"
GROUP BY s."shot_type", s."score_delta_interval"
ORDER BY s."shot_type" NULLS LAST
;
2025-01-26 17:58:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:58:04 - root - INFO - ```sql
WITH CorrectShots AS (
  SELECT
    pbp.*
  FROM NCAA_BASKETBALL.NCAA_BASKETBALL.MBB_PBP_SR pbp
  WHERE
    pbp."event_type" IN ('twopointmade', 'twopointmiss', 'threepointmade', 'threepointmiss')
    AND TO_TIMESTAMP_LTZ(pbp."scheduled_date" / 1e6) < DATE '2018-03-15'
    AND (
      (pbp."team_basket" = 'left' AND pbp."event_coord_x" < 564) OR
      (pbp."team_basket" = 'right' AND pbp."event_coord_x" >= 564)
    )
),
GameElapsedTimes AS (
  SELECT DISTINCT "game_id", "elapsed_time_sec"
  FROM CorrectShots
),
TeamsPerGame AS (
  SELECT DISTINCT "game_id", "team_id"
  FROM CorrectShots
),
TimeTeamGrid AS (
  SELECT
    get."game_id",
    get."elapsed_time_sec",
    tpg."team_id"
  FROM GameElapsedTimes get
  JOIN TeamsPerGame tpg
    ON get."game_id" = tpg."game_id"
),
TeamEvents AS (
  SELECT
    "game_id",
    "team_id",
    "elapsed_time_sec",
    COALESCE("points_scored", 0) AS "points_scored"
  FROM CorrectShots
),
TimeTeamPoints AS (
  SELECT
    ttg."game_id",
    ttg."team_id",
    ttg."elapsed_time_sec",
    COALESCE(SUM(te."points_scored"), 0) AS "points_scored"
  FROM TimeTeamGrid ttg
  LEFT JOIN TeamEvents te
    ON ttg."game_id" = te."game_id"
    AND ttg."team_id" = te."team_id"
    AND ttg."elapsed_time_sec" = te."elapsed_time_sec"
  GROUP BY ttg."game_id", ttg."team_id", ttg."elapsed_time_sec"
),
CumulativeTeamScores AS (
  SELECT
    ttp."game_id",
    ttp."team_id",
    ttp."elapsed_time_sec",
    SUM(ttp."points_scored") OVER (
      PARTITION BY ttp."game_id", ttp."team_id"
      ORDER BY CAST(ttp."elapsed_time_sec" AS INT)
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS "team_cumulative_points"
  FROM TimeTeamPoints ttp
),
CumulativeScoresWithOpponent AS (
  SELECT
    cts1."game_id",
    cts1."team_id",
    cts1."elapsed_time_sec",
    cts1."team_cumulative_points",
    cts2."team_cumulative_points" AS "opponent_cumulative_points",
    cts1."team_cumulative_points" - cts2."team_cumulative_points" AS "score_delta"
  FROM CumulativeTeamScores cts1
  JOIN CumulativeTeamScores cts2
    ON cts1."game_id" = cts2."game_id"
    AND cts1."elapsed_time_sec" = cts2."elapsed_time_sec"
    AND cts1."team_id" <> cts2."team_id"
),
CategorizedScores AS (
  SELECT
    cts.*,
    CASE
      WHEN cts."score_delta" < -20 THEN '<-20'
      WHEN cts."score_delta" BETWEEN -20 AND -11 THEN '-20 — -11'
      WHEN cts."score_delta" BETWEEN -10 AND -1 THEN '-10 — -1'
      WHEN cts."score_delta" = 0 THEN '0'
      WHEN cts."score_delta" BETWEEN 1 AND 10 THEN '1 — 10'
      WHEN cts."score_delta" BETWEEN 11 AND 20 THEN '11 — 20'
      WHEN cts."score_delta" > 20 THEN '>20'
    END AS "score_delta_interval"
  FROM CumulativeScoresWithOpponent cts
),
ShotsWithDelta AS (
  SELECT
    csd."game_id",
    csd."team_id",
    csd."elapsed_time_sec",
    csd."score_delta_interval",
    csd."score_delta",
    cs."shot_type",
    cs."event_coord_x",
    cs."event_coord_y",
    cs."shot_made"
  FROM CategorizedScores csd
  JOIN CorrectShots cs
    ON csd."game_id" = cs."game_id"
    AND csd."team_id" = cs."team_id"
    AND csd."elapsed_time_sec" = cs."elapsed_time_sec"
),
ShotTypeIntervalCounts AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    COUNT(*) AS "attempts",
    SUM(CASE WHEN "shot_made" = TRUE THEN 1 ELSE 0 END) AS "successful_shots"
  FROM ShotsWithDelta
  GROUP BY "shot_type", "score_delta_interval"
),
MostFrequentIntervals AS (
  SELECT
    "shot_type",
    "score_delta_interval",
    "attempts",
    ROW_NUMBER() OVER (PARTITION BY "shot_type" ORDER BY "attempts" DESC NULLS LAST) AS "rn"
  FROM ShotTypeIntervalCounts
),
MostFrequentPerShotType AS (
  SELECT
    "shot_type",
    "score_delta_interval"
  FROM MostFrequentIntervals
  WHERE "rn" = 1
)
SELECT
  s."shot_type",
  s."score_delta_interval",
  ROUND(AVG(s."event_coord_x"), 4) AS "avg_x",
  ROUND(AVG(s."event_coord_y"), 4) AS "avg_y",
  COUNT(*) AS "avg_attempts",
  SUM(CASE WHEN s."shot_made" = TRUE THEN 1 ELSE 0 END) AS "avg_successful_shots"
FROM ShotsWithDelta s
JOIN MostFrequentPerShotType mf
  ON s."shot_type" = mf."shot_type" AND s."score_delta_interval" = mf."score_delta_interval"
GROUP BY s."shot_type", s."score_delta_interval"
ORDER BY s."shot_type" NULLS LAST
;
```
2025-01-26 17:58:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:58:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:58:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:58:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-26 17:58:06 - snowflake.connector.connection - INFO - closed
2025-01-26 17:58:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:58:07 - root - INFO - itercount: 3
2025-01-26 17:58:07 - root - INFO - 0
2025-01-26 17:58:07 - root - INFO - Total iteration counts: 3
