SELECT 
  "by" AS "ID",
  EXTRACT(MONTH FROM TO_TIMESTAMP(MAX("time"))) AS "Last_active_month"
FROM 
  HACKER_NEWS.HACKER_NEWS.FULL
WHERE 
  "time" <= DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('2023-09-10', 'YYYY-MM-DD'))
  AND ("deleted" IS NULL OR "deleted" = FALSE)
  AND ("dead" IS NULL OR "dead" = FALSE)
  AND "by" IS NOT NULL AND "by" != ''
GROUP BY 
  "by"
HAVING 
  MAX("time") < DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('2023-09-10', 'YYYY-MM-DD'))
ORDER BY 
  EXTRACT(MONTH FROM TO_TIMESTAMP(MAX("time"))) DESC NULLS LAST,
  MAX("time") DESC NULLS LAST
LIMIT 1;