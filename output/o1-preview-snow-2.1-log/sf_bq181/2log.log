2025-01-24 08:13:36 - openai._base_client - INFO - Retrying request to /chat/completions in 0.395877 seconds
2025-01-24 08:14:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:14:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:14:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:14:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:14:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:14:39 - snowflake.connector.connection - INFO - closed
2025-01-24 08:14:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:14:39 - root - INFO - SQL:
SELECT "stn", "wban", "year", "mo", "da", "temp"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   LIMIT 100;
Results:
stn,wban,year,mo,da,temp
010014,99999,2022,12,19,42.3
010070,99999,2022,10,25,15.7
010070,99999,2022,09,27,41.8
010280,99999,2022,11,27,34.6
010300,99999,2022,12,30,16.9
010300,99999,2022,11,05,34.9
010300,99999,2022,02,05,13.2
010360,99999,2022,01,28,15.7
010420,99999,2022,09,23,44.9
010620,99999,2022,03,30,12.9
010760,99999,2022,12,28,17.4
010780,99999,2022,03,13,35.2
011050,99999,2022,11,16,35.8
011070,99999,2022,01,09,33.8
011070,99999,2022,02,19,30.7
011080,99999,2022,10,03,51.0
011140,99999,2022,03,30,33.3
011160,99999,2022,04,30,40.5
011220,99999,2022,01,08,0.5
011240,99999,2022,02,05,31.6
011350,99999,2022,12,18,25.1
011390,99999,2022,07,29,54.1
011390,99999,2022,03,10,42.8
011390,99999,2022,04,19,42.8
011390,99999,2022,10,24,41.5
011390,99999,2022,12,27,41.0
011390,99999,2022,07,15,49.1
011390,99999,2022,08,23,52.2
011390,99999,2022,10,06,48.2
011390,99999,2022,10,11,48.2
011610,99999,2022,02,05,36.0
011690,99999,2022,12,05,27.7
012030,99999,2022,12,28,36.4
012120,99999,2022,09,07,54.4
012330,99999,2022,12,27,27.4
012450,99999,2022,07,05,52.5
012500,99999,2022,11,20,2.0
012530,99999,2022,01,28,29.9
012530,99999,2022,09,17,48.1
012540,99999,2022,02,17,24.0
012570,99999,2022,02,17,26.3
012590,99999,2022,02,17,30.2
012700,99999,2022,12,17,6.4
012810,99999,2022,07,14,49.3
012900,99999,2022,08,06,54.1
012900,99999,2022,07,09,55.0
012900,99999,2022,05,21,63.1
013005,99999,2022,11,05,55.8
013170,99999,2022,12,25,41.3
013200,99999,2022,01,22,36.5
013200,99999,2022,01,15,35.6
013210,99999,2022,01,26,35.1
013210,99999,2022,02,20,29.8
013270,99999,2022,12,27,28.9
013380,99999,2022,10,11,44.7
013380,99999,2022,12,16,26.2
013380,99999,2022,10,03,50.9
013380,99999,2022,10,26,46.7
013380,99999,2022,09,29,50.3
013550,99999,2022,02,17,34.4
013610,99999,2022,09,23,42.5
013800,99999,2022,11,12,42.7
013800,99999,2022,01,20,17.0
013870,99999,2022,10,19,33.4
013930,99999,2022,10,16,37.1
013930,99999,2022,01,05,11.6
013930,99999,2022,03,29,18.0
014120,99999,2022,10,04,55.2
014250,99999,2022,09,02,45.3
014310,99999,2022,08,19,50.9
014550,99999,2022,12,20,32.2
014703,99999,2022,06,19,61.2
014820,99999,2022,09,07,60.9
014900,99999,2022,12,04,22.1
014900,99999,2022,12,09,14.0
014920,99999,2022,02,26,26.3
014930,99999,2022,10,29,51.5
014930,99999,2022,12,16,13.6
014930,99999,2022,12,29,39.8
014930,99999,2022,09,24,54.7
014930,99999,2022,02,02,24.7
014930,99999,2022,02,26,33.8
014930,99999,2022,12,21,39.5
014930,99999,2022,11,08,45.7
020130,99999,2022,10,12,35.5
020130,99999,2022,10,22,33.5
020130,99999,2022,10,27,33.2
020130,99999,2022,10,09,37.9
020130,99999,2022,11,16,14.8
020130,99999,2022,10,11,40.1
020130,99999,2022,09,09,45.1
020130,99999,2022,12,12,5.0
020130,99999,2022,12,28,19.3
020220,99999,2022,10,19,38.4
020220,99999,2022,12,06,27.7
020220,99999,2022,12,28,20.1
020220,99999,2022,10,02,34.6
020220,99999,2022,12,04,15.2
020220,99999,2022,11,16,16.6
020220,99999,2022,10,31,32.5

2025-01-24 08:14:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:14:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:14:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:14:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:14:40 - snowflake.connector.connection - INFO - closed
2025-01-24 08:14:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:14:41 - root - INFO - SQL:
SELECT DISTINCT "stn", "wban"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   LIMIT 100;
Results:
stn,wban
818690,99999
829930,99999
835830,99999
825330,99999
833780,99999
854060,99999
822810,99999
866860,99999
868630,99999
869530,99999
817370,99999
869570,99999
784790,99999
788620,99999
801120,99999
816850,99999
788660,00399
022820,99999
023170,99999
013040,99999
014690,99999
010370,99999
012420,99999
819820,99999
819850,99999
818720,99999
819570,99999
839810,99999
867350,99999
867530,99999
866620,99999
868080,99999
868380,99999
868440,99999
868620,99999
868700,99999
800280,99999
785203,00398
789250,00404
804720,99999
867230,99999
020130,99999
020310,99999
013230,99999
014160,99999
021210,99999
021910,99999
024260,99999
012030,99999
014240,99999
026250,99999
013520,99999
013750,99999
014900,99999
011560,99999
829840,99999
852440,99999
866660,99999
817520,99999
819650,99999
819780,99999
820220,99999
866970,99999
852010,99999
867190,99999
867370,99999
868910,99999
010780,99999
014920,99999
020550,99999
024110,99999
024230,99999
024290,99999
025480,99999
013190,99999
026230,99999
013640,99999
012400,99999
010620,99999
011480,99999
825990,99999
837160,99999
838400,99999
833620,99999
865823,99999
867300,99999
867980,99999
868610,99999
866380,99999
867440,99999
867700,99999
869110,99999
818310,99999
819270,99999
819860,99999
825640,99999
817150,99999
010070,99999
010440,99999
011390,99999

2025-01-24 08:14:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:14:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:14:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:14:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:14:42 - snowflake.connector.connection - INFO - closed
2025-01-24 08:14:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:14:42 - root - INFO - SQL:
SELECT COUNT(DISTINCT "stn", "wban") AS "total_stations"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022";
Results:
total_stations
12319

2025-01-24 08:14:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:14:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:14:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:14:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:14:44 - snowflake.connector.connection - INFO - closed
2025-01-24 08:14:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:14:44 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT "da") AS "days_with_temp_data"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn", "wban"
   LIMIT 100;
Results:
stn,wban,days_with_temp_data
862850,99999,31
670200,99999,31
685820,99999,31
417800,99999,31
442660,99999,31
529960,99999,31
969370,99999,31
842260,99999,28
369530,99999,31
432960,99999,31
378710,99999,31
802220,99999,31
817740,99999,31
919290,99999,31
515420,99999,31
789580,00409,31
814050,99999,31
834240,99999,31
867590,99999,31
914130,40308,31
942880,99999,31
944050,99999,31
947820,99999,31
990200,99999,31
998429,99999,31
237480,99999,31
296020,99999,31
296380,99999,31
389740,99999,31
685800,99999,31
895710,99999,31
713880,99999,31
162320,99999,31
164800,99999,31
170220,99999,31
948920,99999,31
818880,99999,31
028340,99999,31
113620,99999,31
718410,99999,31
028490,99999,31
029840,99999,31
450110,99999,31
997255,99999,31
204710,99999,31
477900,99999,31
485320,99999,31
033463,99999,31
711580,99999,31
028250,99999,31
032380,99999,31
033130,99999,31
062830,99999,31
103150,99999,31
107750,99999,31
715510,99999,31
725405,54816,31
727970,94240,31
643830,99999,29
653760,99999,31
999999,03761,31
722820,03949,31
389540,99999,31
423430,99999,31
200870,99999,31
819150,99999,31
268940,99999,31
945750,99999,31
955430,99999,31
999999,00179,31
999999,13752,31
281160,99999,31
311020,99999,31
401550,99999,31
768556,99999,31
171190,99999,31
616990,99999,31
724390,93822,31
154931,99999,31
067050,99999,31
111120,99999,31
060560,99999,31
062570,99999,31
600050,99999,31
028310,99999,31
067940,99999,31
117300,99999,31
262330,99999,31
976000,99999,31
304050,99999,31
424980,99999,31
503530,99999,31
170200,99999,31
766850,99999,31
066390,99999,31
067340,99999,31
605490,99999,31
062770,99999,31
701195,26625,31
406700,99999,31

2025-01-24 08:14:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:14:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:14:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:14:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 08:14:46 - snowflake.connector.connection - INFO - closed
2025-01-24 08:14:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:15:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:15:15 - root - INFO - ```sql
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100;
```
2025-01-24 08:15:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:15:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:15:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:15:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:15:17 - snowflake.connector.connection - INFO - closed
2025-01-24 08:15:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:16:12 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100;
Results:
stn,wban,days_with_temp_data
867610,99999,255
957080,99999,365
879040,99999,365
941160,99999,343
994041,99999,358
967490,99999,365
997284,99999,359
997694,99999,359
998195,99999,358
953040,99999,365
998208,99999,365
113860,99999,85
481080,99999,360
604230,99999,365
786720,99999,228
237010,99999,360
526020,99999,362
941200,99999,365
997309,99999,359
606900,99999,298
135930,99999,269
434220,99999,265
623180,99999,364
356870,99999,363
506030,99999,362
382230,99999,364
999999,94645,365
999999,04236,365
999999,00430,334
683005,99999,362
218210,99999,365
263240,99999,361
301730,99999,365
315870,99999,365
338830,99999,365
364180,99999,365
412530,99999,345
425390,99999,364
432010,99999,365
524180,99999,362
545390,99999,362
010760,99999,21
483310,99999,365
606120,99999,365
997344,99999,305
646010,99999,308
517650,99999,363
977220,99999,364
160840,99999,365
786550,99999,350
154215,99999,336
474200,99999,365
997705,99999,359
023380,99999,357
066370,99999,363
710780,99999,365
713760,99999,364
717780,99999,305
720346,53991,365
722616,03032,365
703333,25518,218
726444,04963,351
563850,99999,362
030590,99999,365
958360,99999,346
537870,99999,361
304930,99999,361
765480,99999,332
999999,00423,331
854690,99999,359
249820,99999,365
412420,99999,343
423390,99999,359
442150,99999,365
470500,99999,365
577990,99999,362
686510,99999,241
687520,99999,336
688370,99999,360
961790,99999,363
703050,25623,353
408351,99999,365
763940,99999,365
144520,99999,365
712770,99999,361
039070,99999,364
124880,99999,365
268550,99999,314
085610,99999,365
242660,99999,359
484320,99999,365
915790,99999,359
874530,99999,365
408930,99999,365
175300,99999,365
411120,99999,365
476570,99999,359
789480,00406,365
672970,99999,347
637200,99999,363

2025-01-24 08:16:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:16:13 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:14 - root - INFO - SQL:
SELECT COUNT(*) AS "stations_with_90_percent_data"
FROM (
  SELECT "stn", "wban"
  FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  WHERE "temp" IS NOT NULL
  GROUP BY "stn", "wban"
  HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
) AS subquery
Results:
stations_with_90_percent_data
9795

2025-01-24 08:16:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:16:15 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:16 - root - INFO - SQL:
SELECT 
  (COUNT(*) * 100.0) / (
    SELECT COUNT(DISTINCT "stn", "wban")
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  ) AS "percentage_of_stations_with_90_percent_data"
FROM (
  SELECT "stn", "wban"
  FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  WHERE "temp" IS NOT NULL
  GROUP BY "stn", "wban"
  HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
) AS subquery
Results:
percentage_of_stations_with_90_percent_data
79.511324

2025-01-24 08:16:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:16:17 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:18 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) < 329
LIMIT 100
Results:
stn,wban,days_with_temp_data
423720,99999,320
476610,43321,311
654180,99999,277
532760,99999,312
817490,99999,269
869480,99999,192
654420,99999,245
819010,99999,269
945620,99999,275
406020,99999,140
969330,99999,170
671610,99999,318
652016,99999,24
014770,99999,29
818630,99999,156
111930,99999,86
869040,99999,319
165410,99999,248
997306,99999,261
600070,99999,320
830110,99999,101
831150,99999,200
417490,99999,324
837490,99999,197
418950,99999,78
082720,99999,308
891320,99999,137
761130,99999,153
242610,99999,271
888910,99999,316
330360,99999,277
634020,99999,150
999999,04141,324
419430,99999,135
683800,99999,275
689120,99999,326
345350,99999,145
999999,00170,310
322870,99999,258
710944,99999,319
284910,99999,168
670250,99999,35
266570,99999,226
865850,99999,307
703656,99999,250
489690,99999,15
713570,99999,301
043510,99999,273
011050,99999,63
720619,99999,317
999999,00459,184
113100,99999,219
026720,99999,291
654570,99999,75
672800,99999,163
999999,00378,233
279950,99999,115
687440,99999,202
841790,99999,16
419290,99999,68
339100,99999,1
816870,99999,81
013370,99999,209
725475,04953,140
013460,99999,124
031520,99999,285
682640,99999,242
023070,99999,261
113820,99999,219
720993,99999,126
347270,99999,151
817430,99999,193
014400,99999,27
720559,00172,325
720867,00293,302
720897,99999,302
718070,99999,162
722253,53992,130
722216,99999,320
722041,12993,208
720472,99999,274
722620,23055,303
318010,99999,173
719455,99999,292
332870,99999,11
866370,99999,18
489900,99999,5
486040,99999,47
419770,99999,25
617210,99999,1
344010,99999,3
489710,99999,2
013620,99999,3
014830,99999,1
014810,99999,1
265040,99999,238
689160,99999,326
603760,99999,317
135800,99999,239
427820,99999,324

2025-01-24 08:16:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:16:19 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:20 - root - INFO - SQL:
SELECT "stn", "wban"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) = 365
LIMIT 100
Results:
stn,wban
879040,99999
998208,99999
219210,99999
953040,99999
470460,99999
957180,99999
964410,99999
946310,99999
358490,99999
999999,04236
133690,99999
259040,99999
431890,99999
432010,99999
483840,99999
604230,99999
941200,99999
967490,99999
364180,99999
890550,99999
956580,99999
946000,99999
829170,99999
957080,99999
871480,99999
218210,99999
239860,99999
299370,99999
315870,99999
338830,99999
442150,99999
470500,99999
470600,99999
483860,99999
485200,99999
161970,99999
071340,99999
407290,99999
483310,99999
789480,00406
348610,99999
067450,99999
722011,92813
124880,99999
153000,99999
025103,99999
030590,99999
163320,99999
606120,99999
038940,99999
082210,99999
151680,99999
783670,11706
106870,99999
024640,99999
068065,99999
722616,03032
319811,99999
167490,99999
170340,99999
171240,99999
432790,99999
710780,99999
724676,93073
725314,03960
722362,93937
726810,24131
832480,99999
913340,40505
954870,99999
246430,99999
312530,99999
314780,99999
999999,94645
085610,99999
249820,99999
301730,99999
443470,99999
484320,99999
443040,99999
433690,99999
408351,99999
032270,99999
408930,99999
143240,99999
153150,99999
874530,99999
160840,99999
103480,99999
142580,99999
144520,99999
471040,99999
172320,99999
150830,99999
483040,99999
111710,99999
071530,99999
127720,99999
471210,99999
720439,99999

2025-01-24 08:16:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:16:21 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:22 - root - INFO - SQL:
SELECT AVG("days_with_temp_data") AS "average_days_with_temp_data"
FROM (
  SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
  FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  WHERE "temp" IS NOT NULL
  GROUP BY "stn", "wban"
) AS subquery
Results:
average_days_with_temp_data
324.271369

2025-01-24 08:16:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:16:23 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:23 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT CONCAT(LPAD("mo", 2, '0'))) AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100
Results:
stn,wban,months_with_temp_data
832480,99999,12
913340,40505,12
941160,99999,12
867610,99999,10
946000,99999,12
984330,99999,12
874530,99999,12
890550,99999,12
998195,99999,12
998208,99999,12
999999,00423,11
997694,99999,12
426180,99999,12
602750,99999,12
646010,99999,12
265390,99999,11
529080,99999,12
506580,99999,12
524180,99999,12
999999,04236,12
913480,99999,12
356870,99999,12
530830,99999,12
012340,99999,9
132950,99999,12
218210,99999,12
307640,99999,12
249820,99999,12
577990,99999,12
767730,99999,12
431890,99999,12
433690,99999,12
898070,99999,5
374700,99999,4
358490,99999,12
717780,99999,11
856820,99999,12
027080,99999,12
153000,99999,12
997344,99999,11
151680,99999,12
024640,99999,12
103480,99999,12
124880,99999,12
723407,03953,12
724276,53859,12
429730,99999,12
854690,99999,12
325090,99999,12
172320,99999,12
144520,99999,12
724096,14706,12
123260,99999,12
071340,99999,12
724676,93073,12
434220,99999,12
976980,99999,12
246430,99999,12
819880,99999,12
382230,99999,12
423390,99999,12
686490,99999,12
688370,99999,12
470600,99999,12
089380,99999,4
064765,99999,12
722073,03727,12
407807,99999,12
720464,99999,12
154200,99999,12
711530,99999,12
723080,13737,12
216080,99999,12
427680,99999,12
841320,99999,12
336210,99999,2
013650,99999,2
713760,99999,12
917840,99999,12
786550,99999,12
407290,99999,12
408930,99999,12
724467,13930,12
725314,03960,12
747750,13846,12
715860,99999,12
021860,99999,12
164160,99999,5
726815,24106,12
071530,99999,12
039070,99999,12
719450,99999,12
076430,99999,12
106870,99999,12
150830,99999,12
710940,99999,12
060170,99999,11
637200,99999,12
020360,99999,12
032270,99999,12

2025-01-24 08:16:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:16:25 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:25 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT CONCAT(LPAD("mo", 2, '0'))) AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT CONCAT(LPAD("mo", 2, '0'))) < 12
LIMIT 100
Results:
stn,wban,months_with_temp_data
819010,99999,9
111930,99999,8
891320,99999,7
837490,99999,9
014400,99999,6
654570,99999,11
284910,99999,7
043510,99999,11
831150,99999,9
817490,99999,9
682640,99999,10
026720,99999,11
720867,00293,11
720472,99999,11
011050,99999,8
817430,99999,7
761130,99999,11
345350,99999,6
722253,53992,5
720559,00172,11
725475,04953,5
713570,99999,11
722041,12993,10
013460,99999,9
687440,99999,8
023070,99999,9
689120,99999,11
670250,99999,3
031520,99999,10
865850,99999,11
242610,99999,11
999999,00459,10
720993,99999,6
945620,99999,10
423720,99999,11
347270,99999,5
332870,99999,2
830110,99999,5
816870,99999,5
703656,99999,11
014810,99999,1
013620,99999,3
718070,99999,6
113100,99999,9
419770,99999,3
997306,99999,9
419290,99999,4
419430,99999,8
013370,99999,9
999999,00378,9
279950,99999,5
869480,99999,8
318010,99999,7
418950,99999,5
339100,99999,1
720897,99999,11
818630,99999,6
841790,99999,1
014830,99999,1
652016,99999,3
113820,99999,9
014770,99999,3
866370,99999,2
617210,99999,1
489690,99999,2
486040,99999,2
489900,99999,2
344010,99999,1
489710,99999,1
867570,99999,6
990200,99999,10
819050,99999,5
014640,99999,9
013930,99999,9
842260,99999,10
013400,99999,5
238230,99999,9
846000,99999,5
038321,99999,10
113800,99999,9
260381,99999,11
652290,99999,7
277190,99999,10
647540,99999,11
012810,99999,6
471205,99999,6
325830,99999,10
680260,99999,9
081800,99999,4
281160,99999,9
945957,99999,11
010280,99999,8
034054,99999,11
013710,99999,9
113590,99999,9
345780,99999,7
674770,99999,6
230580,99999,3
835540,99999,5
345390,99999,2

2025-01-24 08:16:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 08:16:26 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:16:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:16:37 - root - INFO - ```sql
SELECT "stn", "wban", COUNT(DISTINCT "mo") AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT "mo") < 12
LIMIT 100;
```
2025-01-24 08:16:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:16:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:16:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:16:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:16:39 - snowflake.connector.connection - INFO - closed
2025-01-24 08:16:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:17:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:17:29 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT "mo") AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT "mo") < 12
LIMIT 100;
Results:
stn,wban,months_with_temp_data
013460,99999,9
761130,99999,11
111930,99999,8
419290,99999,4
722041,12993,10
654570,99999,11
113100,99999,9
869480,99999,8
865850,99999,11
113820,99999,9
014400,99999,6
713570,99999,11
043510,99999,11
242610,99999,11
831150,99999,9
689120,99999,11
999999,00459,10
031520,99999,10
720993,99999,6
703656,99999,11
830110,99999,5
014770,99999,3
279950,99999,5
997306,99999,9
687440,99999,8
720559,00172,11
486040,99999,2
318010,99999,7
026720,99999,11
011050,99999,8
013370,99999,9
345350,99999,6
819010,99999,9
419430,99999,8
682640,99999,10
725475,04953,5
418950,99999,5
023070,99999,9
720897,99999,11
720867,00293,11
999999,00378,9
489900,99999,2
344010,99999,1
423720,99999,11
945620,99999,10
837490,99999,9
722253,53992,5
718070,99999,6
332870,99999,2
891320,99999,7
818630,99999,6
817430,99999,7
720472,99999,11
817490,99999,9
652016,99999,3
816870,99999,5
284910,99999,7
339100,99999,1
419770,99999,3
489690,99999,2
347270,99999,5
014810,99999,1
013620,99999,3
670250,99999,3
489710,99999,1
866370,99999,2
617210,99999,1
841790,99999,1
014830,99999,1
818660,99999,9
624650,99999,9
661363,99999,5
346460,99999,4
012320,99999,7
623870,99999,10
863300,99999,11
410310,99999,7
034940,99999,10
111750,99999,9
162190,99999,10
720953,00331,8
703052,26652,11
471086,99999,6
335620,99999,3
816090,99999,3
702195,99999,11
489700,99999,1
999999,92821,11
614210,99999,8
042660,99999,6
341640,99999,4
719740,99999,6
419330,99999,4
869760,99999,11
714680,99999,6
867210,99999,11
860335,99999,7
123764,99999,2
379530,99999,7
337170,99999,1

2025-01-24 08:17:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:17:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:17:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:17:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:17:30 - snowflake.connector.connection - INFO - closed
2025-01-24 08:17:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:17:31 - root - INFO - SQL:
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE("year" || '-' || "mo" || '-' || "da", 'YYYY-MM-DD')) AS "total_temp_readings"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100
Results:
stn,wban,total_temp_readings
819010,99999,269
869770,99999,364
944570,99999,348
869620,99999,364
935970,99999,365
943670,99999,365
914080,40310,365
948270,99999,365
949600,99999,365
997364,99999,357
998271,99999,358
946280,99999,364
956460,99999,365
994045,99999,358
998409,99999,359
761130,99999,153
377920,99999,363
536980,99999,362
587310,99999,362
955650,99999,365
998177,99999,365
423720,99999,320
917530,99999,365
946100,99999,365
997264,99999,364
998218,99999,358
022470,99999,357
417640,99999,344
318730,99999,365
289930,99999,364
684790,99999,338
415980,99999,352
948750,99999,365
965650,99999,359
431210,99999,360
476610,43321,311
480310,99999,358
276270,99999,330
419430,99999,135
111930,99999,86
532760,99999,312
999999,00439,342
652016,99999,24
682710,99999,354
418950,99999,78
292530,99999,360
406020,99999,140
720897,99999,302
999999,63829,365
563740,99999,362
890030,99999,339
969330,99999,170
419780,99999,364
865850,99999,307
376750,99999,365
869040,99999,319
338850,99999,365
249510,99999,365
317070,99999,365
345350,99999,145
165410,99999,248
575160,99999,365
717130,99999,364
162530,99999,365
959850,99999,365
266570,99999,226
954580,99999,359
654180,99999,277
013370,99999,209
827980,99999,365
997779,99999,359
322870,99999,258
415300,99999,354
480800,99999,364
442190,99999,365
837490,99999,197
634020,99999,150
999999,94059,365
600070,99999,320
831150,99999,200
949290,99999,365
994979,99999,365
672800,99999,163
040770,99999,363
610170,99999,357
330360,99999,277
654420,99999,245
024410,99999,357
419290,99999,68
433710,99999,365
710944,99999,319
830110,99999,101
407010,99999,364
353610,99999,365
997386,99999,348
998425,99999,355
999999,00459,184
688130,99999,349
605200,99999,364
227780,99999,365

2025-01-24 08:17:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:17:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:17:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:17:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:17:32 - snowflake.connector.connection - INFO - closed
2025-01-24 08:17:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:17:33 - root - INFO - SQL:
SELECT "stn", "wban", 
  MIN(TO_DATE("year" || '-' || "mo" || '-' || "da", 'YYYY-MM-DD')) AS "first_record", 
  MAX(TO_DATE("year" || '-' || "mo" || '-' || "da", 'YYYY-MM-DD')) AS "last_record"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
GROUP BY "stn", "wban"
LIMIT 100
Results:
stn,wban,first_record,last_record
789480,00406,2022-01-01,2022-12-31
800010,99999,2022-01-01,2022-12-31
817030,99999,2022-04-01,2022-12-31
859212,99999,2022-01-01,2022-12-31
867770,99999,2022-01-01,2022-12-31
819880,99999,2022-01-01,2022-12-31
829170,99999,2022-01-01,2022-12-31
832480,99999,2022-01-01,2022-12-31
867610,99999,2022-01-04,2022-12-31
869500,99999,2022-01-01,2022-12-31
869710,99999,2022-01-01,2022-12-31
871480,99999,2022-01-01,2022-12-31
874530,99999,2022-01-01,2022-12-31
879040,99999,2022-01-01,2022-12-31
913340,40505,2022-01-01,2022-12-31
941200,99999,2022-01-01,2022-12-31
945890,99999,2022-01-01,2022-12-31
946000,99999,2022-01-01,2022-12-31
947100,99999,2022-01-01,2022-12-31
953040,99999,2022-01-01,2022-12-31
954870,99999,2022-01-01,2022-12-31
956580,99999,2022-01-01,2022-12-31
957080,99999,2022-01-01,2022-12-31
964410,99999,2022-01-01,2022-12-31
967490,99999,2022-01-01,2022-12-31
975600,99999,2022-01-01,2022-12-31
958360,99999,2022-01-01,2022-12-31
994008,99999,2022-01-01,2022-12-31
994070,99999,2022-01-01,2022-06-06
997301,99999,2022-01-01,2022-12-30
997694,99999,2022-01-01,2022-12-30
999999,94645,2022-01-01,2022-12-31
999999,04236,2022-01-01,2022-12-31
999999,00423,2022-01-01,2022-12-31
A00013,63847,2022-01-01,2022-12-31
866920,99999,2022-03-15,2022-12-31
890550,99999,2022-01-01,2022-12-31
931910,99999,2022-01-01,2022-12-31
941160,99999,2022-01-01,2022-12-16
941390,99999,2022-01-01,2022-12-31
946310,99999,2022-01-01,2022-12-31
957180,99999,2022-01-01,2022-12-31
994024,99999,2022-01-01,2022-12-29
994041,99999,2022-01-01,2022-12-30
997284,99999,2022-01-01,2022-12-30
997309,99999,2022-01-01,2022-12-30
997312,99999,2022-01-01,2022-12-30
997705,99999,2022-01-01,2022-12-30
998208,99999,2022-01-01,2022-12-31
999999,25522,2022-01-01,2022-12-31
999999,00430,2022-01-24,2022-12-31
997344,99999,2022-01-01,2022-11-27
998195,99999,2022-01-01,2022-12-30
998243,99999,2022-01-01,2022-12-30
866110,99999,2022-09-12,2022-12-31
866360,99999,2022-09-13,2022-11-26
010760,99999,2022-02-17,2022-12-31
013610,99999,2022-02-17,2022-12-31
020360,99999,2022-01-01,2022-12-31
023380,99999,2022-01-01,2022-12-31
263810,99999,2022-07-14,2022-07-15
265390,99999,2022-02-03,2022-12-31
268550,99999,2022-01-01,2022-12-31
412420,99999,2022-01-01,2022-12-31
419150,99999,2022-01-01,2022-12-31
427680,99999,2022-01-01,2022-12-31
480940,99999,2022-01-01,2022-12-31
526520,99999,2022-01-01,2022-12-31
604230,99999,2022-01-01,2022-12-31
610750,99999,2022-01-04,2022-12-31
506580,99999,2022-01-01,2022-12-31
602750,99999,2022-01-03,2022-12-31
606900,99999,2022-01-01,2022-12-31
434220,99999,2022-01-01,2022-12-31
646010,99999,2022-01-01,2022-12-31
686490,99999,2022-01-01,2022-12-27
687520,99999,2022-01-01,2022-12-31
688370,99999,2022-01-01,2022-12-31
722073,03727,2022-01-01,2022-12-31
765480,99999,2022-01-02,2022-12-31
767730,99999,2022-01-01,2022-12-30
786720,99999,2022-01-02,2022-12-30
834990,99999,2022-01-01,2022-12-31
841050,99999,2022-01-03,2022-12-30
841320,99999,2022-01-03,2022-12-30
870650,99999,2022-04-22,2022-12-31
913480,99999,2022-01-01,2022-12-31
917840,99999,2022-01-01,2022-12-31
976980,99999,2022-01-01,2022-12-31
984330,99999,2022-01-01,2022-12-31
135930,99999,2022-01-01,2022-12-31
229960,99999,2022-01-01,2022-12-31
237010,99999,2022-01-01,2022-12-31
266360,99999,2022-01-01,2022-12-31
289840,99999,2022-01-01,2022-12-31
382230,99999,2022-01-01,2022-12-31
433690,99999,2022-01-01,2022-12-31
011430,99999,2022-01-12,2022-12-31
412530,99999,2022-01-01,2022-12-31
477760,99999,2022-01-01,2022-12-31

2025-01-24 08:17:33 - root - INFO - itercount: 0
2025-01-24 08:17:33 - root - INFO - Database Name: NOAA_DATA
Schema Name: NOAA_GSOD
DDL describes table information.
,0
table_name,GSOD1933
description,
DDL,"create or replace TABLE GSOD1933 (
	""stn"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""mo"" VARCHAR(16777216),
	""da"" VARCHAR(16777216),
	""temp"" FLOAT,
	""count_temp"" NUMBER(38,0),
	""dewp"" FLOAT,
	""count_dewp"" NUMBER(38,0),
	""slp"" FLOAT,
	""count_slp"" NUMBER(38,0),
	""stp"" FLOAT,
	""count_stp"" NUMBER(38,0),
	""visib"" FLOAT,
	""count_visib"" NUMBER(38,0),
	""wdsp"" VARCHAR(16777216),
	""count_wdsp"" VARCHAR(16777216),
	""mxpsd"" VARCHAR(16777216),
	""gust"" FLOAT,
	""max"" FLOAT,
	""flag_max"" VARCHAR(16777216),
	""min"" FLOAT,
	""flag_min"" VARCHAR(16777216),
	""prcp"" FLOAT,
	""flag_prcp"" VARCHAR(16777216),
	""sndp"" FLOAT,
	""fog"" VARCHAR(16777216),
	""rain_drizzle"" VARCHAR(16777216),
	""snow_ice_pellets"" VARCHAR(16777216),
	""hail"" VARCHAR(16777216),
	""thunder"" VARCHAR(16777216),
	""tornado_funnel_cloud"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['GSOD1933', 'GSOD1934', 'GSOD1946', 'GSOD1955', 'GSOD1959', 'GSOD2002', 'GSOD2010', 'GSOD1949', 'GSOD1951', 'GSOD1974', 'GSOD1984', 'GSOD1985', 'GSOD1998', 'GSOD2006', 'GSOD2001', 'GSOD1961', 'GSOD1950', 'GSOD2020', 'GSOD1973', 'GSOD1990', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1938', 'GSOD1939', 'GSOD1941', 'GSOD1942', 'GSOD1962', 'GSOD1964', 'GSOD1967', 'GSOD1970', 'GSOD1979', 'GSOD1987', 'GSOD1997', 'GSOD2004', 'GSOD2024', 'GSOD1947', 'GSOD1948', 'GSOD1986', 'GSOD1991', 'GSOD1994', 'GSOD2013', 'GSOD2023', 'GSOD2018', 'GSOD1999', 'GSOD1956', 'GSOD1977', 'GSOD1993', 'GSOD1936', 'GSOD1937', 'GSOD1943', 'GSOD1945', 'GSOD1953', 'GSOD1968', 'GSOD1980', 'GSOD1981', 'GSOD1996', 'GSOD2021', 'GSOD1957', 'GSOD1972', 'GSOD1978', 'GSOD2016', 'GSOD2017', 'GSOD1954', 'GSOD1966', 'GSOD1988', 'GSOD1983', 'GSOD2022', 'GSOD1929', 'GSOD1940', 'GSOD1944', 'GSOD1952', 'GSOD1958', 'GSOD1969', 'GSOD1971', 'GSOD1975', 'GSOD1995', 'GSOD2008', 'GSOD2011', 'GSOD1963', 'GSOD1976', 'GSOD1989', 'GSOD1992', 'GSOD2000', 'GSOD2003', 'GSOD2005', 'GSOD2012', 'GSOD2014', 'GSOD2015', 'GSOD2019', 'GSOD1960', 'GSOD1982', 'GSOD1965', 'GSOD1935', 'GSOD2007', 'GSOD2009']
,1
table_name,STATIONS
description,
DDL,"create or replace TABLE STATIONS (
	""usaf"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""call"" VARCHAR(16777216),
	""lat"" FLOAT,
	""lon"" FLOAT,
	""elev"" VARCHAR(16777216),
	""begin"" VARCHAR(16777216),
	""end"" VARCHAR(16777216)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_HISTORIC_SEVERE_STORMS
DDL describes table information.
,0
table_name,STORMS_1951
description,
DDL,"create or replace TABLE STORMS_1951 (
	""episode_id"" VARCHAR(16777216),
	""event_id"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""cz_type"" VARCHAR(16777216),
	""cz_fips_code"" VARCHAR(16777216),
	""cz_name"" VARCHAR(16777216),
	""wfo"" VARCHAR(16777216),
	""event_begin_time"" NUMBER(38,0),
	""event_timezone"" VARCHAR(16777216),
	""event_end_time"" NUMBER(38,0),
	""injuries_direct"" NUMBER(38,0),
	""injuries_indirect"" NUMBER(38,0),
	""deaths_direct"" NUMBER(38,0),
	""deaths_indirect"" NUMBER(38,0),
	""damage_property"" NUMBER(38,0),
	""damage_crops"" NUMBER(38,0),
	""source"" VARCHAR(16777216),
	""magnitude"" FLOAT,
	""magnitude_type"" VARCHAR(16777216),
	""flood_cause"" VARCHAR(16777216),
	""tor_f_scale"" VARCHAR(16777216),
	""tor_length"" VARCHAR(16777216),
	""tor_width"" VARCHAR(16777216),
	""tor_other_wfo"" VARCHAR(16777216),
	""location_index"" VARCHAR(16777216),
	""event_range"" FLOAT,
	""event_azimuth"" VARCHAR(16777216),
	""reference_location"" VARCHAR(16777216),
	""event_latitude"" FLOAT,
	""event_longitude"" FLOAT,
	""event_point"" BINARY(8388608)
);"

Some other tables have the similar structure: ['STORMS_1951', 'STORMS_1953', 'STORMS_1955', 'STORMS_1957', 'STORMS_1963', 'STORMS_1968', 'STORMS_1969', 'STORMS_1978', 'STORMS_1979', 'STORMS_1982', 'STORMS_1984', 'STORMS_1990', 'STORMS_1992', 'STORMS_2022', 'STORMS_2023', 'STORMS_2017', 'STORMS_2001', 'STORMS_2020', 'STORMS_1977', 'STORMS_1954', 'STORMS_1956', 'STORMS_1962', 'STORMS_1966', 'STORMS_1971', 'STORMS_2014', 'STORMS_2018', 'STORMS_1975', 'STORMS_1995', 'STORMS_1997', 'STORMS_1998', 'STORMS_1999', 'STORMS_2003', 'STORMS_2011', 'STORMS_2015', 'STORMS_2024', 'STORMS_1973', 'STORMS_2016', 'STORMS_1959', 'STORMS_1960', 'STORMS_1961', 'STORMS_1976', 'STORMS_1980', 'STORMS_1986', 'STORMS_1989', 'STORMS_2008', 'STORMS_2019', 'STORMS_1952', 'STORMS_1965', 'STORMS_1972', 'STORMS_1981', 'STORMS_1983', 'STORMS_1987', 'STORMS_1993', 'STORMS_2002', 'STORMS_2004', 'STORMS_2006', 'STORMS_2009', 'STORMS_1991', 'STORMS_1958', 'STORMS_1964', 'STORMS_1967', 'STORMS_1970', 'STORMS_1988', 'STORMS_1994', 'STORMS_1996', 'STORMS_2000', 'STORMS_2010', 'STORMS_2013', 'STORMS_2021', 'STORMS_1950', 'STORMS_1985', 'STORMS_2005', 'STORMS_2007', 'STORMS_2012', 'STORMS_1974']
,1
table_name,NWS_FORECAST_REGIONS
description,
DDL,"create or replace TABLE NWS_FORECAST_REGIONS (
	""state"" VARCHAR(16777216),
	""cwa"" VARCHAR(16777216),
	""time_zone"" VARCHAR(16777216),
	""fe_area"" VARCHAR(16777216),
	""zone"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""state_zone"" VARCHAR(16777216),
	""lon"" FLOAT,
	""lat"" FLOAT,
	""shortname"" VARCHAR(16777216),
	""shape_geometry"" BINARY(8388608)
);"

,2
table_name,TORNADO_REPORTS
description,
DDL,"create or replace TABLE TORNADO_REPORTS (
	""timestamp"" NUMBER(38,0),
	""time"" VARCHAR(16777216),
	""f_scale"" VARCHAR(16777216),
	""location"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""comments"" VARCHAR(16777216),
	""report_point"" BINARY(8388608)
);"

,3
table_name,WIND_REPORTS
description,
DDL,"create or replace TABLE WIND_REPORTS (
	""timestamp"" NUMBER(38,0),
	""time"" VARCHAR(16777216),
	""speed"" NUMBER(38,0),
	""location"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""comments"" VARCHAR(16777216),
	""report_point"" BINARY(8388608)
);"

,4
table_name,HAIL_REPORTS
description,
DDL,"create or replace TABLE HAIL_REPORTS (
	""timestamp"" NUMBER(38,0),
	""time"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""location"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""comments"" VARCHAR(16777216),
	""report_point"" BINARY(8388608)
);"

,5
table_name,TORNADO_PATHS
description,
DDL,"create or replace TABLE TORNADO_PATHS (
	""storm_date"" DATE,
	""storm_time"" TIME(9),
	""time_zone_offset"" VARCHAR(16777216),
	""state_abbreviation"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""magnitude"" VARCHAR(16777216),
	""injured_count"" NUMBER(38,0),
	""fatality_count"" NUMBER(38,0),
	""property_loss"" VARCHAR(16777216),
	""crop_loss"" VARCHAR(16777216),
	""yearly_tornado_count"" VARCHAR(16777216),
	""start_lon"" FLOAT,
	""start_lat"" FLOAT,
	""end_long"" FLOAT,
	""end_lat"" FLOAT,
	""length"" FLOAT,
	""width"" FLOAT,
	""tornado_path_geom"" BINARY(8388608)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_HURRICANES
DDL describes table information.
,0
table_name,HURRICANES
description,
DDL,"create or replace TABLE HURRICANES (
	""sid"" VARCHAR(16777216),
	""season"" VARCHAR(16777216),
	""number"" NUMBER(38,0),
	""basin"" VARCHAR(16777216),
	""subbasin"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""iso_time"" NUMBER(38,0),
	""nature"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""wmo_wind"" NUMBER(38,0),
	""wmo_pressure"" NUMBER(38,0),
	""wmo_agency"" VARCHAR(16777216),
	""track_type"" VARCHAR(16777216),
	""dist2land"" NUMBER(38,0),
	""landfall"" NUMBER(38,0),
	""iflag"" VARCHAR(16777216),
	""usa_agency"" VARCHAR(16777216),
	""usa_latitude"" FLOAT,
	""usa_longitude"" FLOAT,
	""usa_record"" VARCHAR(16777216),
	""usa_status"" VARCHAR(16777216),
	""usa_wind"" NUMBER(38,0),
	""usa_pressure"" NUMBER(38,0),
	""usa_sshs"" NUMBER(38,0),
	""usa_r34_ne"" NUMBER(38,0),
	""usa_r34_se"" NUMBER(38,0),
	""usa_r34_sw"" NUMBER(38,0),
	""usa_r34_nw"" NUMBER(38,0),
	""usa_r50_ne"" NUMBER(38,0),
	""usa_r50_se"" NUMBER(38,0),
	""usa_r50_sw"" NUMBER(38,0),
	""usa_r50_nw"" NUMBER(38,0),
	""usa_r64_ne"" NUMBER(38,0),
	""usa_r64_se"" NUMBER(38,0),
	""usa_r64_sw"" NUMBER(38,0),
	""usa_r64_nw"" NUMBER(38,0),
	""usa_poci"" NUMBER(38,0),
	""usa_roci"" NUMBER(38,0),
	""usa_rmw"" NUMBER(38,0),
	""usa_eye"" VARCHAR(16777216),
	""tokyo_latitude"" FLOAT,
	""tokyo_longitude"" FLOAT,
	""tokyo_grade"" NUMBER(38,0),
	""tokyo_wind"" NUMBER(38,0),
	""tokyo_pressure"" NUMBER(38,0),
	""tokyo_r50_dir"" NUMBER(38,0),
	""tokyo_r50_longitude"" NUMBER(38,0),
	""tokyo_r50_short"" NUMBER(38,0),
	""tokyo_r30_dir"" NUMBER(38,0),
	""tokyo_r30_long"" NUMBER(38,0),
	""tokyo_r30_short"" NUMBER(38,0),
	""tokyo_land"" NUMBER(38,0),
	""cma_latitude"" FLOAT,
	""cma_longitude"" FLOAT,
	""cma_cat"" NUMBER(38,0),
	""cma_wind"" NUMBER(38,0),
	""cma_pressure"" NUMBER(38,0),
	""hko_latitude"" VARCHAR(16777216),
	""hko_longitude"" FLOAT,
	""hko_cat"" VARCHAR(16777216),
	""hko_wind"" NUMBER(38,0),
	""hko_pressure"" NUMBER(38,0),
	""newdelhi_latitude"" FLOAT,
	""newdelhi_longitude"" FLOAT,
	""newdelhi_grade"" VARCHAR(16777216),
	""newdelhi_wind"" NUMBER(38,0),
	""newdelhi_pressure"" NUMBER(38,0),
	""newdelhi_ci"" FLOAT,
	""newdelhi_dp"" NUMBER(38,0),
	""newdelhi_poci"" NUMBER(38,0),
	""reunion_latitude"" FLOAT,
	""reunion_longitude"" FLOAT,
	""reunion_type"" NUMBER(38,0),
	""reunion_wind"" NUMBER(38,0),
	""reunion_pressure"" NUMBER(38,0),
	""reunion_tnum"" FLOAT,
	""reunion_ci"" FLOAT,
	""reunion_rmw"" NUMBER(38,0),
	""reunion_r34_ne"" NUMBER(38,0),
	""reunion_r34_se"" NUMBER(38,0),
	""reunion_r34_sw"" NUMBER(38,0),
	""reunion_r34_nw"" NUMBER(38,0),
	""reunion_r50_ne"" NUMBER(38,0),
	""reunion_r50_se"" NUMBER(38,0),
	""reunion_r50_sw"" NUMBER(38,0),
	""reunion_r50_nw"" NUMBER(38,0),
	""reunion_r64_ne"" NUMBER(38,0),
	""reunion_r64_se"" NUMBER(38,0),
	""reunion_r64_sw"" NUMBER(38,0),
	""reunion_r64_nw"" NUMBER(38,0),
	""bom_latitude"" FLOAT,
	""bom_longitude"" FLOAT,
	""bom_type"" NUMBER(38,0),
	""bom_wind"" NUMBER(38,0),
	""bom_pressure"" NUMBER(38,0),
	""bom_tnum"" FLOAT,
	""bom_ci"" FLOAT,
	""bom_rmw"" NUMBER(38,0),
	""bom_r34_ne"" NUMBER(38,0),
	""bom_r34_se"" NUMBER(38,0),
	""bom_r34_sw"" NUMBER(38,0),
	""bom_r34_nw"" NUMBER(38,0),
	""bom_r50_ne"" NUMBER(38,0),
	""bom_r50_se"" NUMBER(38,0),
	""bom_r50_sw"" NUMBER(38,0),
	""bom_r50_nw"" NUMBER(38,0),
	""bom_r64_ne"" NUMBER(38,0),
	""bom_r64_se"" NUMBER(38,0),
	""bom_r64_sw"" NUMBER(38,0),
	""bom_r64_nw"" NUMBER(38,0),
	""bom_roci"" NUMBER(38,0),
	""bom_poci"" NUMBER(38,0),
	""bom_eye"" NUMBER(38,0),
	""bom_pos_method"" NUMBER(38,0),
	""bom_pressure_method"" NUMBER(38,0),
	""wellington_latitude"" FLOAT,
	""wellington_longitude"" FLOAT,
	""wellington_wind"" NUMBER(38,0),
	""wellington_pressure"" NUMBER(38,0),
	""nadi_latitude"" FLOAT,
	""nadi_longitude"" FLOAT,
	""nadi_cat"" NUMBER(38,0),
	""nadi_wind"" NUMBER(38,0),
	""nadi_pressure"" NUMBER(38,0),
	""ds824_latitude"" FLOAT,
	""ds824_longitude"" FLOAT,
	""ds824_stage"" VARCHAR(16777216),
	""ds824_wind"" NUMBER(38,0),
	""ds824_pressure"" NUMBER(38,0),
	""td9636_latitude"" FLOAT,
	""td9636_longitude"" FLOAT,
	""td9636_stage"" NUMBER(38,0),
	""td9636_wind"" NUMBER(38,0),
	""td9636_pressure"" NUMBER(38,0),
	""td9635_latitude"" FLOAT,
	""td9635_longitude"" FLOAT,
	""td9635_wind"" FLOAT,
	""td9635_pressure"" NUMBER(38,0),
	""td9635_roci"" NUMBER(38,0),
	""neumann_latitude"" FLOAT,
	""neumann_longitude"" FLOAT,
	""neumann_class"" VARCHAR(16777216),
	""neumann_wind"" NUMBER(38,0),
	""neumann_pressure"" NUMBER(38,0),
	""mlc_latitude"" FLOAT,
	""mlc_longitude"" FLOAT,
	""mlc_class"" VARCHAR(16777216),
	""mlc_wind"" NUMBER(38,0),
	""mlc_pressure"" NUMBER(38,0),
	""usa_atcf_id"" VARCHAR(16777216),
	""source_url"" VARCHAR(16777216),
	""etl_timestamp"" NUMBER(38,0)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_ICOADS
DDL describes table information.
,0
table_name,ICOADS_CORE_1662_2000
description,
DDL,"create or replace TABLE ICOADS_CORE_1662_2000 (
	""year"" NUMBER(38,0),
	""month"" NUMBER(38,0),
	""day"" NUMBER(38,0),
	""hour"" FLOAT,
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""imma_version"" NUMBER(38,0),
	""attm_count"" NUMBER(38,0),
	""time_indicator"" NUMBER(38,0),
	""latlong_indicator"" NUMBER(38,0),
	""ship_course"" NUMBER(38,0),
	""ship_speed"" NUMBER(38,0),
	""national_source_indicator"" NUMBER(38,0),
	""id_indicator"" NUMBER(38,0),
	""callsign"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""wind_direction_indicator"" NUMBER(38,0),
	""wind_direction_true"" NUMBER(38,0),
	""wind_speed_indicator"" NUMBER(38,0),
	""wind_speed"" FLOAT,
	""visibility_indicator"" NUMBER(38,0),
	""visibility"" NUMBER(38,0),
	""present_weather"" NUMBER(38,0),
	""past_weather"" NUMBER(38,0),
	""sea_level_pressure"" FLOAT,
	""characteristic_of_ppp"" NUMBER(38,0),
	""amt_pressure_tend"" FLOAT,
	""indicator_for_temp"" NUMBER(38,0),
	""air_temperature"" FLOAT,
	""wbt_indicator"" NUMBER(38,0),
	""wetbulb_temperature"" FLOAT,
	""dpt_indicator"" NUMBER(38,0),
	""dewpoint_temperature"" FLOAT,
	""sst_measurement_method"" NUMBER(38,0),
	""sea_surface_temp"" FLOAT,
	""total_cloud_amount"" NUMBER(38,0),
	""lower_cloud_amount"" NUMBER(38,0),
	""low_cloud_type"" VARCHAR(16777216),
	""cloud_height_indicator"" NUMBER(38,0),
	""cloud_height"" VARCHAR(16777216),
	""middle_cloud_type"" VARCHAR(16777216),
	""high_cloud_type"" VARCHAR(16777216),
	""wave_direction"" NUMBER(38,0),
	""wave_period"" NUMBER(38,0),
	""wave_height"" FLOAT,
	""swell_direction"" NUMBER(38,0),
	""swell_period"" NUMBER(38,0),
	""swell_height"" FLOAT,
	""box_system_indicator"" VARCHAR(16777216),
	""ten_degree_box_number"" NUMBER(38,0),
	""one_degree_box_number"" NUMBER(38,0),
	""deck"" NUMBER(38,0),
	""source_id"" NUMBER(38,0),
	""platform_type"" NUMBER(38,0),
	""dup_status"" NUMBER(38,0),
	""dup_check"" NUMBER(38,0),
	""track_check"" NUMBER(38,0),
	""pressure_bias"" NUMBER(38,0),
	""wave_period_indicator"" NUMBER(38,0),
	""swell_period_indicator"" NUMBER(38,0),
	""second_country_code"" NUMBER(38,0),
	""adaptive_qc_flags"" VARCHAR(16777216),
	""nightday_flag"" NUMBER(38,0),
	""trimming_flags"" VARCHAR(16777216),
	""ncdc_qc_flags"" VARCHAR(16777216),
	""external"" NUMBER(38,0),
	""landlocked_flag"" NUMBER(38,0),
	""source_exclusion_flags"" NUMBER(38,0),
	""unique_report_id"" VARCHAR(16777216),
	""release_no_primary"" NUMBER(38,0),
	""release_no_secondary"" NUMBER(38,0),
	""release_no_tertiary"" NUMBER(38,0),
	""release_status_indicator"" NUMBER(38,0),
	""intermediate_reject_flag"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['ICOADS_CORE_1662_2000', 'ICOADS_CORE_2001_2004']
,1
table_name,ICOADS_CORE_2014
description,
DDL,"create or replace TABLE ICOADS_CORE_2014 (
	""year"" NUMBER(38,0),
	""month"" NUMBER(38,0),
	""day"" NUMBER(38,0),
	""hour"" FLOAT,
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""imma_version"" NUMBER(38,0),
	""attm_count"" NUMBER(38,0),
	""time_indicator"" NUMBER(38,0),
	""latlong_indicator"" NUMBER(38,0),
	""ship_course"" NUMBER(38,0),
	""ship_speed"" NUMBER(38,0),
	""national_source_indicator"" NUMBER(38,0),
	""id_indicator"" NUMBER(38,0),
	""callsign"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""wind_direction_indicator"" NUMBER(38,0),
	""wind_direction_true"" NUMBER(38,0),
	""wind_speed_indicator"" NUMBER(38,0),
	""wind_speed"" FLOAT,
	""visibility_indicator"" NUMBER(38,0),
	""visibility"" NUMBER(38,0),
	""present_weather"" NUMBER(38,0),
	""past_weather"" NUMBER(38,0),
	""sea_level_pressure"" FLOAT,
	""characteristic_of_ppp"" NUMBER(38,0),
	""amt_pressure_tend"" FLOAT,
	""indicator_for_temp"" NUMBER(38,0),
	""air_temperature"" FLOAT,
	""wbt_indicator"" NUMBER(38,0),
	""wetbulb_temperature"" FLOAT,
	""dpt_indicator"" NUMBER(38,0),
	""dewpoint_temperature"" FLOAT,
	""sst_measurement_method"" NUMBER(38,0),
	""sea_surface_temp"" FLOAT,
	""total_cloud_amount"" NUMBER(38,0),
	""lower_cloud_amount"" NUMBER(38,0),
	""low_cloud_type"" VARCHAR(16777216),
	""cloud_height_indicator"" NUMBER(38,0),
	""cloud_height"" VARCHAR(16777216),
	""middle_cloud_type"" VARCHAR(16777216),
	""high_cloud_type"" VARCHAR(16777216),
	""wave_direction"" NUMBER(38,0),
	""wave_period"" NUMBER(38,0),
	""wave_height"" FLOAT,
	""swell_direction"" NUMBER(38,0),
	""swell_period"" NUMBER(38,0),
	""swell_height"" FLOAT,
	""box_system_indicator"" VARCHAR(16777216),
	""ten_degree_box_number"" NUMBER(38,0),
	""one_degree_box_number"" NUMBER(38,0),
	""deck"" NUMBER(38,0),
	""source_id"" NUMBER(38,0),
	""platform_type"" NUMBER(38,0),
	""dup_status"" NUMBER(38,0),
	""dup_check"" NUMBER(38,0),
	""track_check"" NUMBER(38,0),
	""pressure_bias"" NUMBER(38,0),
	""wave_period_indicator"" NUMBER(38,0),
	""swell_period_indicator"" NUMBER(38,0),
	""second_country_code"" NUMBER(38,0),
	""adaptive_qc_flags"" VARCHAR(16777216),
	""nightday_flag"" NUMBER(38,0),
	""trimming_flags"" VARCHAR(16777216),
	""ncdc_qc_flags"" VARCHAR(16777216),
	""external"" NUMBER(38,0),
	""landlocked_flag"" NUMBER(38,0),
	""source_exclusion_flags"" NUMBER(38,0),
	""unique_report_id"" VARCHAR(16777216),
	""release_no_primary"" NUMBER(38,0),
	""release_no_secondary"" NUMBER(38,0),
	""release_no_tertiary"" NUMBER(38,0),
	""release_status_indicator"" NUMBER(38,0),
	""intermediate_reject_flag"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['ICOADS_CORE_2014', 'ICOADS_CORE_2011', 'ICOADS_CORE_2012', 'ICOADS_CORE_2013', 'ICOADS_CORE_2015', 'ICOADS_CORE_2005', 'ICOADS_CORE_2008', 'ICOADS_CORE_2009', 'ICOADS_CORE_2017', 'ICOADS_CORE_2007', 'ICOADS_CORE_2006', 'ICOADS_CORE_2010', 'ICOADS_CORE_2016']
Database Name: NOAA_DATA
Schema Name: NOAA_PASSIVE_ACOUSTIC_INDEX
DDL describes table information.
,0
table_name,NRS_METADATA
description,
DDL,"create or replace TABLE NRS_METADATA (
	""file_name"" VARCHAR(16777216),
	""deployment_name"" VARCHAR(16777216),
	""start_date"" DATE,
	""start_time"" TIME(9),
	""source_organization"" VARCHAR(16777216),
	""funding_organization"" VARCHAR(16777216),
	""project_name"" VARCHAR(16777216),
	""sensor_depth"" NUMBER(38,0),
	""sample_rate"" NUMBER(38,0),
	""duration"" NUMBER(38,0),
	""platform_name"" VARCHAR(16777216),
	""lon"" FLOAT,
	""lat"" FLOAT,
	""point_geom"" BINARY(8388608),
	""file_link"" VARCHAR(16777216)
);"

,1
table_name,SANCTSOUND_METADATA
description,
DDL,"create or replace TABLE SANCTSOUND_METADATA (
	""file_name"" VARCHAR(16777216),
	""data_collection_name"" VARCHAR(16777216),
	""start_date"" DATE,
	""start_time"" TIME(9),
	""source_organization"" VARCHAR(16777216),
	""funding_organization"" VARCHAR(16777216),
	""project_name"" VARCHAR(16777216),
	""sensor_depth"" FLOAT,
	""sample_rate"" NUMBER(38,0),
	""recording_percent"" NUMBER(38,0),
	""platform_name"" VARCHAR(16777216),
	""longitude"" FLOAT,
	""latitude"" FLOAT,
	""file_link"" VARCHAR(16777216)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_PASSIVE_BIOACOUSTIC
DDL describes table information.
,0
table_name,NCEI_NRS_PAD_METADATA
description,
DDL,"create or replace TABLE NCEI_NRS_PAD_METADATA (
	""file_name"" VARCHAR(16777216),
	""deployment_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""start_time"" VARCHAR(16777216),
	""source_organization"" VARCHAR(16777216),
	""funding_organization"" VARCHAR(16777216),
	""project_name"" VARCHAR(16777216),
	""sensor_depth"" VARCHAR(16777216),
	""sample_rate_hz"" VARCHAR(16777216),
	""recording"" VARCHAR(16777216),
	""platform_name"" VARCHAR(16777216),
	""lon"" VARCHAR(16777216),
	""lat"" VARCHAR(16777216)
);"

,1
table_name,NCEI_NEFSC_PAD_METADATA
description,
DDL,"create or replace TABLE NCEI_NEFSC_PAD_METADATA (
	""cloud_path"" VARCHAR(16777216),
	""file_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""start_time"" VARCHAR(16777216),
	""data_collection_name"" VARCHAR(16777216),
	""source_organization"" VARCHAR(16777216),
	""funding_organization"" VARCHAR(16777216),
	""project_name"" VARCHAR(16777216),
	""sensor_depth"" VARCHAR(16777216),
	""sample_rate"" VARCHAR(16777216),
	""duration"" VARCHAR(16777216),
	""platform_name"" VARCHAR(16777216),
	""shape1"" VARCHAR(16777216),
	""shape2"" VARCHAR(16777216),
	""shape3"" VARCHAR(16777216),
	""shape4"" VARCHAR(16777216),
	""shape5"" VARCHAR(16777216),
	""shape6"" VARCHAR(16777216),
	""shape7"" VARCHAR(16777216),
	""shape8"" VARCHAR(16777216),
	""shape9"" VARCHAR(16777216),
	""shape10"" VARCHAR(16777216)
);"

,2
table_name,NCEI_SANCTSOUND_PAD_METADATA
description,
DDL,"create or replace TABLE NCEI_SANCTSOUND_PAD_METADATA (
	""file_name"" VARCHAR(16777216),
	""data_collection_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""start_time"" VARCHAR(16777216),
	""source_organization"" VARCHAR(16777216),
	""funding_organization"" VARCHAR(16777216),
	""project_name"" VARCHAR(16777216),
	""sensor_depth"" VARCHAR(16777216),
	""sample_rate_hz"" VARCHAR(16777216),
	""recording"" VARCHAR(16777216),
	""platform_name"" VARCHAR(16777216),
	""lon"" VARCHAR(16777216),
	""lat"" VARCHAR(16777216)
);"

,3
table_name,NCEI_AFSC_PAD_METADATA
description,
DDL,"create or replace TABLE NCEI_AFSC_PAD_METADATA (
	""cloud_path"" VARCHAR(16777216),
	""file_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""start_time"" VARCHAR(16777216),
	""data_collection_name"" VARCHAR(16777216),
	""source_organization"" VARCHAR(16777216),
	""funding_organization"" VARCHAR(16777216),
	""project_name"" VARCHAR(16777216),
	""sensor_depth"" VARCHAR(16777216),
	""sample_rate"" VARCHAR(16777216),
	""duration"" VARCHAR(16777216),
	""platform_name"" VARCHAR(16777216),
	""shape"" VARCHAR(16777216)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_PIFSC_METADATA
DDL describes table information.
,0
table_name,DCLDE_2020_DETECTION_README
description,
DDL,"create or replace TABLE DCLDE_2020_DETECTION_README (
	""table"" VARCHAR(16777216),
	""field"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

,1
table_name,DCLDE_2020_1705_ARRAY
description,
DDL,"create or replace TABLE DCLDE_2020_1705_ARRAY (
	""array_start_local"" NUMBER(38,0),
	""array_end_local"" NUMBER(38,0),
	""array_start_utc"" NUMBER(38,0),
	""array_end_utc"" NUMBER(38,0),
	""array1"" VARCHAR(16777216),
	""array2"" VARCHAR(16777216),
	""hp1_dist"" FLOAT,
	""hp1_ad"" NUMBER(38,0),
	""hp2_dist"" FLOAT,
	""hp2_ad"" NUMBER(38,0),
	""hp3_dist"" FLOAT,
	""hp3_ad"" NUMBER(38,0),
	""hp4_dist"" FLOAT,
	""hp4_ad"" NUMBER(38,0),
	""hp5_dist"" FLOAT,
	""hp5_ad"" NUMBER(38,0),
	""hp6_dist"" FLOAT,
	""hp6_ad"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['DCLDE_2020_1705_ARRAY', 'DCLDE_2020_1706_ARRAY']
,2
table_name,DCLDE_2020_1705_ODONTOCETE_DETECTIONS
description,
DDL,"create or replace TABLE DCLDE_2020_1705_ODONTOCETE_DETECTIONS (
	""detection_time_start_local"" NUMBER(38,0),
	""detection_time_start_utc"" NUMBER(38,0),
	""detection_time_end_utc"" NUMBER(38,0),
	""acoustic_detection_number"" VARCHAR(16777216),
	""sighting_number"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""point"" BINARY(8388608),
	""first_angle"" NUMBER(38,0),
	""first_distance"" NUMBER(38,0),
	""beam_distance"" NUMBER(38,0),
	""beam_time_utc"" NUMBER(38,0),
	""detection_distance"" NUMBER(38,0),
	""species1_id"" VARCHAR(16777216),
	""species2_id"" VARCHAR(16777216),
	""species3_id"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['DCLDE_2020_1705_ODONTOCETE_DETECTIONS', 'DCLDE_2020_1706_ODONTOCETE_DETECTIONS']
,3
table_name,DCLDE_2020_1705_VISUAL_SIGHTINGS
description,
DDL,"create or replace TABLE DCLDE_2020_1705_VISUAL_SIGHTINGS (
	""local_ship_date"" DATE,
	""sighting_local_time"" TIME(9),
	""sighting_number"" VARCHAR(16777216),
	""species_id"" VARCHAR(16777216),
	""effort"" VARCHAR(16777216),
	""effort_type"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""point"" BINARY(8388608),
	""bearing"" NUMBER(38,0),
	""distance"" FLOAT,
	""total_best"" FLOAT,
	""total_high"" NUMBER(38,0),
	""total_low"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['DCLDE_2020_1705_VISUAL_SIGHTINGS', 'DCLDE_2020_1706_VISUAL_SIGHTINGS']
,4
table_name,DCLDE_2020_1705_MINKE_DETECTIONS
description,
DDL,"create or replace TABLE DCLDE_2020_1705_MINKE_DETECTIONS (
	""detection_time_start_local"" NUMBER(38,0),
	""detection_time_start_utc"" NUMBER(38,0),
	""detection_time_end_utc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""point"" BINARY(8388608)
);"

,5
table_name,DCLDE_2020_SPECIES_LOOKUP
description,
DDL,"create or replace TABLE DCLDE_2020_SPECIES_LOOKUP (
	""code"" VARCHAR(16777216),
	""common_name"" VARCHAR(16777216),
	""species_name"" VARCHAR(16777216)
);"

,6
table_name,DCLDE_SETTE_ARRAY_DEPTH
description,
DDL,"create or replace TABLE DCLDE_SETTE_ARRAY_DEPTH (
	""utc_time"" NUMBER(38,0),
	""local_time"" NUMBER(38,0),
	""inline_depth"" FLOAT,
	""end_depth"" FLOAT
);"

,7
table_name,DCLDE_LASKER_ARRAY_DEPTH
description,
DDL,"create or replace TABLE DCLDE_LASKER_ARRAY_DEPTH (
	""utc_time"" NUMBER(38,0),
	""local_time"" NUMBER(38,0),
	""inline_depth"" FLOAT,
	""end_depth"" FLOAT
);"

,8
table_name,DCLDE_LASKER_GPS
description,
DDL,"create or replace TABLE DCLDE_LASKER_GPS (
	""utc_time"" NUMBER(38,0),
	""local_time"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""speed"" FLOAT,
	""effort"" NUMBER(38,0)
);"

,9
table_name,DCLDE_SETTE_GPS
description,
DDL,"create or replace TABLE DCLDE_SETTE_GPS (
	""utc_time"" NUMBER(38,0),
	""local_time"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""point"" BINARY(8388608),
	""speed"" FLOAT,
	""effort"" NUMBER(38,0)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_PRELIMINARY_SEVERE_STORMS
DDL describes table information.
,0
table_name,WIND_REPORTS
description,
DDL,"create or replace TABLE WIND_REPORTS (
	""timestamp"" NUMBER(38,0),
	""time"" VARCHAR(16777216),
	""speed"" NUMBER(38,0),
	""location"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""comments"" VARCHAR(16777216),
	""report_point"" BINARY(8388608)
);"

,1
table_name,HAIL_REPORTS
description,
DDL,"create or replace TABLE HAIL_REPORTS (
	""timestamp"" NUMBER(38,0),
	""time"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""location"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""comments"" VARCHAR(16777216),
	""report_point"" BINARY(8388608)
);"

,2
table_name,TORNADO_REPORTS
description,
DDL,"create or replace TABLE TORNADO_REPORTS (
	""timestamp"" NUMBER(38,0),
	""time"" VARCHAR(16777216),
	""f_scale"" VARCHAR(16777216),
	""location"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""comments"" VARCHAR(16777216),
	""report_point"" BINARY(8388608)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_SIGNIFICANT_EARTHQUAKES
DDL describes table information.
,0
table_name,EARTHQUAKES
description,
DDL,"create or replace TABLE EARTHQUAKES (
	""id"" NUMBER(38,0),
	""flag_tsunami"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""month"" NUMBER(38,0),
	""day"" NUMBER(38,0),
	""hour"" NUMBER(38,0),
	""minute"" NUMBER(38,0),
	""second"" FLOAT,
	""focal_depth"" NUMBER(38,0),
	""eq_primary"" FLOAT,
	""eq_mag_mw"" FLOAT,
	""eq_mag_ms"" FLOAT,
	""eq_mag_mb"" FLOAT,
	""eq_mag_ml"" FLOAT,
	""eq_mag_mfa"" FLOAT,
	""eq_mag_unk"" FLOAT,
	""intensity"" NUMBER(38,0),
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""location_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""region_code"" NUMBER(38,0),
	""deaths"" NUMBER(38,0),
	""deaths_description"" NUMBER(38,0),
	""missing"" NUMBER(38,0),
	""missing_description"" NUMBER(38,0),
	""injuries"" NUMBER(38,0),
	""injuries_description"" NUMBER(38,0),
	""damage_millions_dollars"" FLOAT,
	""damage_description"" NUMBER(38,0),
	""houses_destroyed"" NUMBER(38,0),
	""houses_destroyed_description"" NUMBER(38,0),
	""houses_damaged"" NUMBER(38,0),
	""houses_damaged_description"" NUMBER(38,0),
	""total_deaths"" NUMBER(38,0),
	""total_deaths_description"" NUMBER(38,0),
	""total_missing"" NUMBER(38,0),
	""total_missing_description"" NUMBER(38,0),
	""total_injuries"" NUMBER(38,0),
	""total_injuries_description"" NUMBER(38,0),
	""total_damage_millions_dollars"" FLOAT,
	""total_damage_description"" NUMBER(38,0),
	""total_houses_destroyed"" NUMBER(38,0),
	""total_houses_destroyed_description"" NUMBER(38,0),
	""total_houses_damaged"" NUMBER(38,0),
	""total_houses_damaged_description"" NUMBER(38,0)
);"

Database Name: NOAA_DATA
Schema Name: NOAA_TSUNAMI
DDL describes table information.
,0
table_name,HISTORICAL_SOURCE_EVENT
description,
DDL,"create or replace TABLE HISTORICAL_SOURCE_EVENT (
	""id"" NUMBER(38,0),
	""year"" NUMBER(38,0),
	""month"" NUMBER(38,0),
	""day"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0),
	""event_validity"" NUMBER(38,0),
	""cause_code"" NUMBER(38,0),
	""focal_depth"" NUMBER(38,0),
	""primary_magnitude"" FLOAT,
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""location_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""region_code"" NUMBER(38,0),
	""maximum_water_height"" FLOAT,
	""abe"" FLOAT,
	""iida"" FLOAT,
	""soloviev"" FLOAT,
	""warning_status"" NUMBER(38,0),
	""deaths"" NUMBER(38,0),
	""deaths_description"" NUMBER(38,0),
	""missing"" NUMBER(38,0),
	""missing_description"" NUMBER(38,0),
	""injuries"" NUMBER(38,0),
	""injuries_description"" NUMBER(38,0),
	""damage_millions_dollars"" FLOAT,
	""damage_description"" NUMBER(38,0),
	""houses_destroyed"" NUMBER(38,0),
	""houses_destroyed_description"" NUMBER(38,0),
	""houses_damaged"" NUMBER(38,0),
	""houses_damaged_description"" NUMBER(38,0),
	""total_deaths"" NUMBER(38,0),
	""total_deaths_description"" NUMBER(38,0),
	""total_missing"" NUMBER(38,0),
	""total_missing_description"" NUMBER(38,0),
	""total_injuries"" NUMBER(38,0),
	""total_injuries_description"" NUMBER(38,0),
	""total_damage_in_millions_dollars"" FLOAT,
	""total_damage_description"" NUMBER(38,0),
	""total_houses_destroyed"" NUMBER(38,0),
	""total_houses_destroyed_description"" NUMBER(38,0),
	""total_houses_damaged"" NUMBER(38,0),
	""total_houses_damaged_description"" NUMBER(38,0)
);"

,1
table_name,HISTORICAL_RUNUPS
description,
DDL,"create or replace TABLE HISTORICAL_RUNUPS (
	""id"" NUMBER(38,0),
	""tsevent_id"" NUMBER(38,0),
	""year"" NUMBER(38,0),
	""month"" NUMBER(38,0),
	""day"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0),
	""doubtful"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""location_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""region_code"" NUMBER(38,0),
	""distance_from_source"" NUMBER(38,0),
	""arr_day"" NUMBER(38,0),
	""arr_hour"" NUMBER(38,0),
	""arr_min"" NUMBER(38,0),
	""travel_time_hours"" NUMBER(38,0),
	""travel_time_minutes"" NUMBER(38,0),
	""water_ht"" FLOAT,
	""horizontal_inundation"" FLOAT,
	""type_measurement_id"" NUMBER(38,0),
	""period"" FLOAT,
	""first_motion"" VARCHAR(16777216),
	""deaths"" NUMBER(38,0),
	""deaths_description"" NUMBER(38,0),
	""injuries"" NUMBER(38,0),
	""injuries_description"" NUMBER(38,0),
	""damage_millions_dollars"" FLOAT,
	""damage_description"" NUMBER(38,0),
	""houses_damaged"" NUMBER(38,0),
	""houses_damaged_description"" NUMBER(38,0),
	""houses_destroyed"" NUMBER(38,0),
	""houses_destroyed_description"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'NOAA_DATA': {'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS'], 'NOAA_HISTORIC_SEVERE_STORMS': ['HAIL_REPORTS', 'NWS_FORECAST_REGIONS', 'STORMS_1950', 'STORMS_1951', 'STORMS_1952', 'STORMS_1953', 'STORMS_1954', 'STORMS_1955', 'STORMS_1956', 'STORMS_1957', 'STORMS_1958', 'STORMS_1959', 'STORMS_1960', 'STORMS_1961', 'STORMS_1962', 'STORMS_1963', 'STORMS_1964', 'STORMS_1965', 'STORMS_1966', 'STORMS_1967', 'STORMS_1968', 'STORMS_1969', 'STORMS_1970', 'STORMS_1971', 'STORMS_1972', 'STORMS_1973', 'STORMS_1974', 'STORMS_1975', 'STORMS_1976', 'STORMS_1977', 'STORMS_1978', 'STORMS_1979', 'STORMS_1980', 'STORMS_1981', 'STORMS_1982', 'STORMS_1983', 'STORMS_1984', 'STORMS_1985', 'STORMS_1986', 'STORMS_1987', 'STORMS_1988', 'STORMS_1989', 'STORMS_1990', 'STORMS_1991', 'STORMS_1992', 'STORMS_1993', 'STORMS_1994', 'STORMS_1995', 'STORMS_1996', 'STORMS_1997', 'STORMS_1998', 'STORMS_1999', 'STORMS_2000', 'STORMS_2001', 'STORMS_2002', 'STORMS_2003', 'STORMS_2004', 'STORMS_2005', 'STORMS_2006', 'STORMS_2007', 'STORMS_2008', 'STORMS_2009', 'STORMS_2010', 'STORMS_2011', 'STORMS_2012', 'STORMS_2013', 'STORMS_2014', 'STORMS_2015', 'STORMS_2016', 'STORMS_2017', 'STORMS_2018', 'STORMS_2019', 'STORMS_2020', 'STORMS_2021', 'STORMS_2022', 'STORMS_2023', 'STORMS_2024', 'TORNADO_PATHS', 'TORNADO_REPORTS', 'WIND_REPORTS'], 'NOAA_HURRICANES': ['HURRICANES'], 'NOAA_ICOADS': ['ICOADS_CORE_1662_2000', 'ICOADS_CORE_2001_2004', 'ICOADS_CORE_2005', 'ICOADS_CORE_2006', 'ICOADS_CORE_2007', 'ICOADS_CORE_2008', 'ICOADS_CORE_2009', 'ICOADS_CORE_2010', 'ICOADS_CORE_2011', 'ICOADS_CORE_2012', 'ICOADS_CORE_2013', 'ICOADS_CORE_2014', 'ICOADS_CORE_2015', 'ICOADS_CORE_2016', 'ICOADS_CORE_2017'], 'NOAA_PASSIVE_ACOUSTIC_INDEX': ['NRS_METADATA', 'SANCTSOUND_METADATA'], 'NOAA_PASSIVE_BIOACOUSTIC': ['NCEI_AFSC_PAD_METADATA', 'NCEI_NEFSC_PAD_METADATA', 'NCEI_NRS_PAD_METADATA', 'NCEI_SANCTSOUND_PAD_METADATA'], 'NOAA_PIFSC_METADATA': ['DCLDE_2020_1705_ARRAY', 'DCLDE_2020_1705_MINKE_DETECTIONS', 'DCLDE_2020_1705_ODONTOCETE_DETECTIONS', 'DCLDE_2020_1705_VISUAL_SIGHTINGS', 'DCLDE_2020_1706_ARRAY', 'DCLDE_2020_1706_ODONTOCETE_DETECTIONS', 'DCLDE_2020_1706_VISUAL_SIGHTINGS', 'DCLDE_2020_DETECTION_README', 'DCLDE_2020_SPECIES_LOOKUP', 'DCLDE_LASKER_ARRAY_DEPTH', 'DCLDE_LASKER_GPS', 'DCLDE_SETTE_ARRAY_DEPTH', 'DCLDE_SETTE_GPS'], 'NOAA_PRELIMINARY_SEVERE_STORMS': ['HAIL_REPORTS', 'TORNADO_REPORTS', 'WIND_REPORTS'], 'NOAA_SIGNIFICANT_EARTHQUAKES': ['EARTHQUAKES'], 'NOAA_TSUNAMI': ['HISTORICAL_RUNUPS', 'HISTORICAL_SOURCE_EVENT']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `"NOAA_DATA"."NOAA_GSOD"."GSOD2022"`

  - **"stn"**: Station identifier (potential usage: to uniquely identify weather stations)
  - **"wban"**: Station identifier (can be used along with "stn" to uniquely identify a station)
  - **"da"**: Day (potential usage: to count the number of days with temperature data per station)
  - **"temp"**: Temperature (potential usage: to check if temperature data is available for a given day)
  - **"year"**: Year (since we're using the `GSOD2022` table, this should be 2022)
  - **"mo"**: Month (may be used if needed for additional time-based analysis)

- **Conditions that may be used:**

  - **"temp" IS NOT NULL**: To ensure that temperature data exists for that day
  - **Grouping by "stn" and "wban"**: To aggregate data per station
  - **Counting days per station**: To determine how many days have temperature data
  - **HAVING COUNT(DISTINCT "da") >= 329**: To find stations that recorded temperature data for at least 90% of the days (90% of 365 days ≈ 329 days)

---

**SQL Queries:**

1. **Select sample data from the GSOD2022 table:**

   ```sql
   SELECT "stn", "wban", "year", "mo", "da", "temp"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   LIMIT 100;
   ```

2. **Retrieve distinct weather stations that reported data in 2022:**

   ```sql
   SELECT DISTINCT "stn", "wban"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   LIMIT 100;
   ```

3. **Count the total number of weather stations that reported any data in 2022:**

   ```sql
   SELECT COUNT(DISTINCT "stn", "wban") AS "total_stations"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022";
   ```

4. **Count the number of days with temperature data per station:**

   ```sql
   SELECT "stn", "wban", COUNT(DISTINCT "da") AS "days_with_temp_data"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn", "wban"
   LIMIT 100;
   ```

5. **List stations that have temperature data for at least 90% of the days in 2022:**

   ```sql
   SELECT "stn", "wban", COUNT(DISTINCT "da") AS "days_with_temp_data"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn", "wban"
   HAVING COUNT(DISTINCT "da") >= 329
   LIMIT 100;
   ```

6. **Count the number of stations with temperature data for at least 329 days:**

   ```sql
   SELECT COUNT(*) AS "stations_with_90_percent_data"
   FROM (
     SELECT "stn", "wban"
     FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
     WHERE "temp" IS NOT NULL
     GROUP BY "stn", "wban"
     HAVING COUNT(DISTINCT "da") >= 329
   ) AS subquery;
   ```

7. **Calculate the percentage of stations with at least 90% temperature data coverage:**

   ```sql
   SELECT 
     (COUNT(*) * 100.0) / (
       SELECT COUNT(DISTINCT "stn", "wban")
       FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
     ) AS "percentage_of_stations_with_90_percent_data"
   FROM (
     SELECT "stn", "wban"
     FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
     WHERE "temp" IS NOT NULL
     GROUP BY "stn", "wban"
     HAVING COUNT(DISTINCT "da") >= 329
   ) AS subquery;
   ```

8. **Identify stations with less than 90% of days reported:**

   ```sql
   SELECT "stn", "wban", COUNT(DISTINCT "da") AS "days_with_temp_data"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn", "wban"
   HAVING COUNT(DISTINCT "da") < 329
   LIMIT 100;
   ```

9. **Find stations with complete temperature data for all 365 days in 2022:**

   ```sql
   SELECT "stn", "wban"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn", "wban"
   HAVING COUNT(DISTINCT "da") = 365
   LIMIT 100;
   ```

10. **Calculate the average number of days with temperature data per station:**

    ```sql
    SELECT AVG("days_with_temp_data") AS "average_days_with_temp_data"
    FROM (
      SELECT "stn", "wban", COUNT(DISTINCT "da") AS "days_with_temp_data"
      FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
      WHERE "temp" IS NOT NULL
      GROUP BY "stn", "wban"
    ) AS subquery;
    ```

11. **List stations and the months for which they have temperature data:**

    ```sql
    SELECT "stn", "wban", COUNT(DISTINCT "mo") AS "months_with_temp_data"
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    WHERE "temp" IS NOT NULL
    GROUP BY "stn", "wban"
    LIMIT 100;
    ```

12. **Identify stations with missing months of temperature data:**

    ```sql
    SELECT "stn", "wban", COUNT(DISTINCT "mo") AS "months_with_temp_data"
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    WHERE "temp" IS NOT NULL
    GROUP BY "stn", "wban"
    HAVING COUNT(DISTINCT "mo") < 12
    LIMIT 100;
    ```

13. **Retrieve stations that have any days without temperature data recorded:**

    ```sql
    SELECT DISTINCT "stn", "wban"
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    WHERE "temp" IS NULL
    LIMIT 100;
    ```

14. **List all stations with the total number of temperature readings they have:**

    ```sql
    SELECT "stn", "wban", COUNT("temp") AS "total_temp_readings"
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    WHERE "temp" IS NOT NULL
    GROUP BY "stn", "wban"
    LIMIT 100;
    ```

15. **Find the earliest and latest dates of temperature data per station:**

    ```sql
    SELECT "stn", "wban", MIN("mo" || '-' || "da") AS "first_record", MAX("mo" || '-' || "da") AS "last_record"
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    GROUP BY "stn", "wban"
    LIMIT 100;
    ```

---

These queries progressively explore the data to understand which stations recorded temperature data in 2022, how many days they recorded data, and help determine the percentage of stations that recorded temperature data for at least 90% of the days in 2022.Query:
SELECT "stn", "wban", "year", "mo", "da", "temp"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   LIMIT 100;
Answer:
stn,wban,year,mo,da,temp
010014,99999,2022,12,19,42.3
010070,99999,2022,10,25,15.7
010070,99999,2022,09,27,41.8
010280,99999,2022,11,27,34.6
010300,99999,2022,12,30,16.9
010300,99999,2022,11,05,34.9
010300,99999,2022,02,05,13.2
010360,99999,2022,01,28,15.7
010420,99999,2022,09,23,44.9
010620,99999,2022,03,30,12.9
010760,99999,2022,12,28,17.4
010780,99999,2022,03,13,35.2
011050,99999,2022,11,16,35.8
011070,99999,2022,01,09,33.8
011070,99999,2022,02,19,30.7
011080,99999,2022,10,03,51.0
011140,99999,2022,03,30,33.3
011160,99999,2022,04,30,40.5
011220,99999,2022,01,08,0.5
011240,99999,2022,02,05,31.6
011350,99999,2022,12,18,25.1
011390,99999,2022,07,29,54.1
011390,99999,2022,03,10,42.8
011390,99999,2022,04,19,42.8
011390,99999,2022,10,24,41.5
011390,99999,2022,12,27,41.0
011390,99999,2022,07,15,49.1
011390,99999,2022,08,23,52.2
011390,99999,2022,10,06,48.2
011390,99999,2022,10,11,48.2
011610,99999,2022,02,05,36.0
011690,99999,2022,12,05,27.7
012030,99999,2022,12,28,36.4
012120,99999,2022,09,07,54.4
012330,99999,2022,12,27,27.4
012450,99999,2022,07,05,52.5
012500,99999,2022,11,20,2.0
012530,99999,2022,01,28,29.9
012530,99999,2022,09,17,48.1
012540,99999,2022,02,17,24.0
012570,99999,2022,02,17,26.3
012590,99999,2022,02,17,30.2
012700,99999,2022,12,17,6.4
012810,99999,2022,07,14,49.3
012900,99999,2022,08,06,54.1
012900,99999,2022,07,09,55.0
012900,99999,2022,05,21,63.1
013005,99999,2022,11,05,55.8
013170,99999,2022,12,25,41.3
013200,99999,2022,01,22,36.5
013200,99999,2022,01,15,35.6
013210,99999,2022,01,26,35.1
013210,99999,2022,02,20,29.8
013270,99999,2022,12,27,28.9
013380,99999,2022,10,11,44.7
013380,99999,2022,12,16,26.2
013380,99999,2022,10,03,50.9
013380,99999,2022,10,26,46.7
013380,99999,2022,09,29,50.3
013550,99999,2022,02,17,34.4
013610,99999,2022,09,23,42.5
013800,99999,2022,11,12,42.7
013800,99999,2022,01,20,17.0
013870,99999,2022,10,19,33.4
013930,99999,2022,10,16,37.1
013930,99999,2022,01,05,11.6
013930,99999,2022,03,29,18.0
014120,99999,2022,10,04,55.2
014250,99999,2022,09,02,45.3
014310,99999,2022,08,19,50.9
014550,99999,2022,12,20,32.2
014703,99999,2022,06,19,61.2
014820,99999,2022,09,07,60.9
014900,99999,2022,12,04,22.1
014900,99999,2022,12,09,14.0
014920,99999,2022,02,26,26.3
014930,99999,2022,10,29,51.5
014930,99999,2022,12,16,13.6
014930,99999,2022,12,29,39.8
014930,99999,2022,09,24,54.7
014930,99999,2022,02,02,24.7
014930,99999,2022,02,26,33.8
014930,99999,2022,12,21,39.5
014930,99999,2022,11,08,45.7
020130,99999,2022,10,12,35.5
020130,99999,2022,10,22,33.5
020130,99999,2022,10,27,33.2
020130,99999,2022,10,09,37.9
020130,99999,2022,11,16,14.8
020130,99999,2022,10,11,40.1
020130,99999,2022,09,09,45.1
020130,99999,2022,12,12,5.0
020130,99999,2022,12,28,19.3
020220,99999,2022,10,19,38.4
020220,99999,2022,12,06,27.7
020220,99999,2022,12,28,20.1
020220,99999,2022,10,02,34.6
020220,99999,2022,12,04,15.2
020220,99999,2022,11,16,16.6
020220,99999,2022,10,31,32.5
Query:
SELECT DISTINCT "stn", "wban"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   LIMIT 100;
Answer:
stn,wban
818690,99999
829930,99999
835830,99999
825330,99999
833780,99999
854060,99999
822810,99999
866860,99999
868630,99999
869530,99999
817370,99999
869570,99999
784790,99999
788620,99999
801120,99999
816850,99999
788660,00399
022820,99999
023170,99999
013040,99999
014690,99999
010370,99999
012420,99999
819820,99999
819850,99999
818720,99999
819570,99999
839810,99999
867350,99999
867530,99999
866620,99999
868080,99999
868380,99999
868440,99999
868620,99999
868700,99999
800280,99999
785203,00398
789250,00404
804720,99999
867230,99999
020130,99999
020310,99999
013230,99999
014160,99999
021210,99999
021910,99999
024260,99999
012030,99999
014240,99999
026250,99999
013520,99999
013750,99999
014900,99999
011560,99999
829840,99999
852440,99999
866660,99999
817520,99999
819650,99999
819780,99999
820220,99999
866970,99999
852010,99999
867190,99999
867370,99999
868910,99999
010780,99999
014920,99999
020550,99999
024110,99999
024230,99999
024290,99999
025480,99999
013190,99999
026230,99999
013640,99999
012400,99999
010620,99999
011480,99999
825990,99999
837160,99999
838400,99999
833620,99999
865823,99999
867300,99999
867980,99999
868610,99999
866380,99999
867440,99999
867700,99999
869110,99999
818310,99999
819270,99999
819860,99999
825640,99999
817150,99999
010070,99999
010440,99999
011390,99999
Query:
SELECT COUNT(DISTINCT "stn", "wban") AS "total_stations"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022";
Answer:
total_stations
12319
Query:
SELECT "stn", "wban", COUNT(DISTINCT "da") AS "days_with_temp_data"
   FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn", "wban"
   LIMIT 100;
Answer:
stn,wban,days_with_temp_data
862850,99999,31
670200,99999,31
685820,99999,31
417800,99999,31
442660,99999,31
529960,99999,31
969370,99999,31
842260,99999,28
369530,99999,31
432960,99999,31
378710,99999,31
802220,99999,31
817740,99999,31
919290,99999,31
515420,99999,31
789580,00409,31
814050,99999,31
834240,99999,31
867590,99999,31
914130,40308,31
942880,99999,31
944050,99999,31
947820,99999,31
990200,99999,31
998429,99999,31
237480,99999,31
296020,99999,31
296380,99999,31
389740,99999,31
685800,99999,31
895710,99999,31
713880,99999,31
162320,99999,31
164800,99999,31
170220,99999,31
948920,99999,31
818880,99999,31
028340,99999,31
113620,99999,31
718410,99999,31
028490,99999,31
029840,99999,31
450110,99999,31
997255,99999,31
204710,99999,31
477900,99999,31
485320,99999,31
033463,99999,31
711580,99999,31
028250,99999,31
032380,99999,31
033130,99999,31
062830,99999,31
103150,99999,31
107750,99999,31
715510,99999,31
725405,54816,31
727970,94240,31
643830,99999,29
653760,99999,31
999999,03761,31
722820,03949,31
389540,99999,31
423430,99999,31
200870,99999,31
819150,99999,31
268940,99999,31
945750,99999,31
955430,99999,31
999999,00179,31
999999,13752,31
281160,99999,31
311020,99999,31
401550,99999,31
768556,99999,31
171190,99999,31
616990,99999,31
724390,93822,31
154931,99999,31
067050,99999,31
111120,99999,31
060560,99999,31
062570,99999,31
600050,99999,31
028310,99999,31
067940,99999,31
117300,99999,31
262330,99999,31
976000,99999,31
304050,99999,31
424980,99999,31
503530,99999,31
170200,99999,31
766850,99999,31
066390,99999,31
067340,99999,31
605490,99999,31
062770,99999,31
701195,26625,31
406700,99999,31
Query:
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100;
Answer:
stn,wban,days_with_temp_data
867610,99999,255
957080,99999,365
879040,99999,365
941160,99999,343
994041,99999,358
967490,99999,365
997284,99999,359
997694,99999,359
998195,99999,358
953040,99999,365
998208,99999,365
113860,99999,85
481080,99999,360
604230,99999,365
786720,99999,228
237010,99999,360
526020,99999,362
941200,99999,365
997309,99999,359
606900,99999,298
135930,99999,269
434220,99999,265
623180,99999,364
356870,99999,363
506030,99999,362
382230,99999,364
999999,94645,365
999999,04236,365
999999,00430,334
683005,99999,362
218210,99999,365
263240,99999,361
301730,99999,365
315870,99999,365
338830,99999,365
364180,99999,365
412530,99999,345
425390,99999,364
432010,99999,365
524180,99999,362
545390,99999,362
010760,99999,21
483310,99999,365
606120,99999,365
997344,99999,305
646010,99999,308
517650,99999,363
977220,99999,364
160840,99999,365
786550,99999,350
154215,99999,336
474200,99999,365
997705,99999,359
023380,99999,357
066370,99999,363
710780,99999,365
713760,99999,364
717780,99999,305
720346,53991,365
722616,03032,365
703333,25518,218
726444,04963,351
563850,99999,362
030590,99999,365
958360,99999,346
537870,99999,361
304930,99999,361
765480,99999,332
999999,00423,331
854690,99999,359
249820,99999,365
412420,99999,343
423390,99999,359
442150,99999,365
470500,99999,365
577990,99999,362
686510,99999,241
687520,99999,336
688370,99999,360
961790,99999,363
703050,25623,353
408351,99999,365
763940,99999,365
144520,99999,365
712770,99999,361
039070,99999,364
124880,99999,365
268550,99999,314
085610,99999,365
242660,99999,359
484320,99999,365
915790,99999,359
874530,99999,365
408930,99999,365
175300,99999,365
411120,99999,365
476570,99999,359
789480,00406,365
672970,99999,347
637200,99999,363
Query:
SELECT COUNT(*) AS "stations_with_90_percent_data"
FROM (
  SELECT "stn", "wban"
  FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  WHERE "temp" IS NOT NULL
  GROUP BY "stn", "wban"
  HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
) AS subquery
Answer:
stations_with_90_percent_data
9795
Query:
SELECT 
  (COUNT(*) * 100.0) / (
    SELECT COUNT(DISTINCT "stn", "wban")
    FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  ) AS "percentage_of_stations_with_90_percent_data"
FROM (
  SELECT "stn", "wban"
  FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  WHERE "temp" IS NOT NULL
  GROUP BY "stn", "wban"
  HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
) AS subquery
Answer:
percentage_of_stations_with_90_percent_data
79.511324
Query:
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) < 329
LIMIT 100
Answer:
stn,wban,days_with_temp_data
423720,99999,320
476610,43321,311
654180,99999,277
532760,99999,312
817490,99999,269
869480,99999,192
654420,99999,245
819010,99999,269
945620,99999,275
406020,99999,140
969330,99999,170
671610,99999,318
652016,99999,24
014770,99999,29
818630,99999,156
111930,99999,86
869040,99999,319
165410,99999,248
997306,99999,261
600070,99999,320
830110,99999,101
831150,99999,200
417490,99999,324
837490,99999,197
418950,99999,78
082720,99999,308
891320,99999,137
761130,99999,153
242610,99999,271
888910,99999,316
330360,99999,277
634020,99999,150
999999,04141,324
419430,99999,135
683800,99999,275
689120,99999,326
345350,99999,145
999999,00170,310
322870,99999,258
710944,99999,319
284910,99999,168
670250,99999,35
266570,99999,226
865850,99999,307
703656,99999,250
489690,99999,15
713570,99999,301
043510,99999,273
011050,99999,63
720619,99999,317
999999,00459,184
113100,99999,219
026720,99999,291
654570,99999,75
672800,99999,163
999999,00378,233
279950,99999,115
687440,99999,202
841790,99999,16
419290,99999,68
339100,99999,1
816870,99999,81
013370,99999,209
725475,04953,140
013460,99999,124
031520,99999,285
682640,99999,242
023070,99999,261
113820,99999,219
720993,99999,126
347270,99999,151
817430,99999,193
014400,99999,27
720559,00172,325
720867,00293,302
720897,99999,302
718070,99999,162
722253,53992,130
722216,99999,320
722041,12993,208
720472,99999,274
722620,23055,303
318010,99999,173
719455,99999,292
332870,99999,11
866370,99999,18
489900,99999,5
486040,99999,47
419770,99999,25
617210,99999,1
344010,99999,3
489710,99999,2
013620,99999,3
014830,99999,1
014810,99999,1
265040,99999,238
689160,99999,326
603760,99999,317
135800,99999,239
427820,99999,324
Query:
SELECT "stn", "wban"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) = 365
LIMIT 100
Answer:
stn,wban
879040,99999
998208,99999
219210,99999
953040,99999
470460,99999
957180,99999
964410,99999
946310,99999
358490,99999
999999,04236
133690,99999
259040,99999
431890,99999
432010,99999
483840,99999
604230,99999
941200,99999
967490,99999
364180,99999
890550,99999
956580,99999
946000,99999
829170,99999
957080,99999
871480,99999
218210,99999
239860,99999
299370,99999
315870,99999
338830,99999
442150,99999
470500,99999
470600,99999
483860,99999
485200,99999
161970,99999
071340,99999
407290,99999
483310,99999
789480,00406
348610,99999
067450,99999
722011,92813
124880,99999
153000,99999
025103,99999
030590,99999
163320,99999
606120,99999
038940,99999
082210,99999
151680,99999
783670,11706
106870,99999
024640,99999
068065,99999
722616,03032
319811,99999
167490,99999
170340,99999
171240,99999
432790,99999
710780,99999
724676,93073
725314,03960
722362,93937
726810,24131
832480,99999
913340,40505
954870,99999
246430,99999
312530,99999
314780,99999
999999,94645
085610,99999
249820,99999
301730,99999
443470,99999
484320,99999
443040,99999
433690,99999
408351,99999
032270,99999
408930,99999
143240,99999
153150,99999
874530,99999
160840,99999
103480,99999
142580,99999
144520,99999
471040,99999
172320,99999
150830,99999
483040,99999
111710,99999
071530,99999
127720,99999
471210,99999
720439,99999
Query:
SELECT AVG("days_with_temp_data") AS "average_days_with_temp_data"
FROM (
  SELECT "stn", "wban", COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) AS "days_with_temp_data"
  FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
  WHERE "temp" IS NOT NULL
  GROUP BY "stn", "wban"
) AS subquery
Answer:
average_days_with_temp_data
324.271369
Query:
SELECT "stn", "wban", COUNT(DISTINCT CONCAT(LPAD("mo", 2, '0'))) AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100
Answer:
stn,wban,months_with_temp_data
832480,99999,12
913340,40505,12
941160,99999,12
867610,99999,10
946000,99999,12
984330,99999,12
874530,99999,12
890550,99999,12
998195,99999,12
998208,99999,12
999999,00423,11
997694,99999,12
426180,99999,12
602750,99999,12
646010,99999,12
265390,99999,11
529080,99999,12
506580,99999,12
524180,99999,12
999999,04236,12
913480,99999,12
356870,99999,12
530830,99999,12
012340,99999,9
132950,99999,12
218210,99999,12
307640,99999,12
249820,99999,12
577990,99999,12
767730,99999,12
431890,99999,12
433690,99999,12
898070,99999,5
374700,99999,4
358490,99999,12
717780,99999,11
856820,99999,12
027080,99999,12
153000,99999,12
997344,99999,11
151680,99999,12
024640,99999,12
103480,99999,12
124880,99999,12
723407,03953,12
724276,53859,12
429730,99999,12
854690,99999,12
325090,99999,12
172320,99999,12
144520,99999,12
724096,14706,12
123260,99999,12
071340,99999,12
724676,93073,12
434220,99999,12
976980,99999,12
246430,99999,12
819880,99999,12
382230,99999,12
423390,99999,12
686490,99999,12
688370,99999,12
470600,99999,12
089380,99999,4
064765,99999,12
722073,03727,12
407807,99999,12
720464,99999,12
154200,99999,12
711530,99999,12
723080,13737,12
216080,99999,12
427680,99999,12
841320,99999,12
336210,99999,2
013650,99999,2
713760,99999,12
917840,99999,12
786550,99999,12
407290,99999,12
408930,99999,12
724467,13930,12
725314,03960,12
747750,13846,12
715860,99999,12
021860,99999,12
164160,99999,5
726815,24106,12
071530,99999,12
039070,99999,12
719450,99999,12
076430,99999,12
106870,99999,12
150830,99999,12
710940,99999,12
060170,99999,11
637200,99999,12
020360,99999,12
032270,99999,12
Query:
SELECT "stn", "wban", COUNT(DISTINCT CONCAT(LPAD("mo", 2, '0'))) AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT CONCAT(LPAD("mo", 2, '0'))) < 12
LIMIT 100
Answer:
stn,wban,months_with_temp_data
819010,99999,9
111930,99999,8
891320,99999,7
837490,99999,9
014400,99999,6
654570,99999,11
284910,99999,7
043510,99999,11
831150,99999,9
817490,99999,9
682640,99999,10
026720,99999,11
720867,00293,11
720472,99999,11
011050,99999,8
817430,99999,7
761130,99999,11
345350,99999,6
722253,53992,5
720559,00172,11
725475,04953,5
713570,99999,11
722041,12993,10
013460,99999,9
687440,99999,8
023070,99999,9
689120,99999,11
670250,99999,3
031520,99999,10
865850,99999,11
242610,99999,11
999999,00459,10
720993,99999,6
945620,99999,10
423720,99999,11
347270,99999,5
332870,99999,2
830110,99999,5
816870,99999,5
703656,99999,11
014810,99999,1
013620,99999,3
718070,99999,6
113100,99999,9
419770,99999,3
997306,99999,9
419290,99999,4
419430,99999,8
013370,99999,9
999999,00378,9
279950,99999,5
869480,99999,8
318010,99999,7
418950,99999,5
339100,99999,1
720897,99999,11
818630,99999,6
841790,99999,1
014830,99999,1
652016,99999,3
113820,99999,9
014770,99999,3
866370,99999,2
617210,99999,1
489690,99999,2
486040,99999,2
489900,99999,2
344010,99999,1
489710,99999,1
867570,99999,6
990200,99999,10
819050,99999,5
014640,99999,9
013930,99999,9
842260,99999,10
013400,99999,5
238230,99999,9
846000,99999,5
038321,99999,10
113800,99999,9
260381,99999,11
652290,99999,7
277190,99999,10
647540,99999,11
012810,99999,6
471205,99999,6
325830,99999,10
680260,99999,9
081800,99999,4
281160,99999,9
945957,99999,11
010280,99999,8
034054,99999,11
013710,99999,9
113590,99999,9
345780,99999,7
674770,99999,6
230580,99999,3
835540,99999,5
345390,99999,2
Query:
SELECT "stn", "wban", COUNT(DISTINCT "mo") AS "months_with_temp_data"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
HAVING COUNT(DISTINCT "mo") < 12
LIMIT 100;
Answer:
stn,wban,months_with_temp_data
013460,99999,9
761130,99999,11
111930,99999,8
419290,99999,4
722041,12993,10
654570,99999,11
113100,99999,9
869480,99999,8
865850,99999,11
113820,99999,9
014400,99999,6
713570,99999,11
043510,99999,11
242610,99999,11
831150,99999,9
689120,99999,11
999999,00459,10
031520,99999,10
720993,99999,6
703656,99999,11
830110,99999,5
014770,99999,3
279950,99999,5
997306,99999,9
687440,99999,8
720559,00172,11
486040,99999,2
318010,99999,7
026720,99999,11
011050,99999,8
013370,99999,9
345350,99999,6
819010,99999,9
419430,99999,8
682640,99999,10
725475,04953,5
418950,99999,5
023070,99999,9
720897,99999,11
720867,00293,11
999999,00378,9
489900,99999,2
344010,99999,1
423720,99999,11
945620,99999,10
837490,99999,9
722253,53992,5
718070,99999,6
332870,99999,2
891320,99999,7
818630,99999,6
817430,99999,7
720472,99999,11
817490,99999,9
652016,99999,3
816870,99999,5
284910,99999,7
339100,99999,1
419770,99999,3
489690,99999,2
347270,99999,5
014810,99999,1
013620,99999,3
670250,99999,3
489710,99999,1
866370,99999,2
617210,99999,1
841790,99999,1
014830,99999,1
818660,99999,9
624650,99999,9
661363,99999,5
346460,99999,4
012320,99999,7
623870,99999,10
863300,99999,11
410310,99999,7
034940,99999,10
111750,99999,9
162190,99999,10
720953,00331,8
703052,26652,11
471086,99999,6
335620,99999,3
816090,99999,3
702195,99999,11
489700,99999,1
999999,92821,11
614210,99999,8
042660,99999,6
341640,99999,4
719740,99999,6
419330,99999,4
869760,99999,11
714680,99999,6
867210,99999,11
860335,99999,7
123764,99999,2
379530,99999,7
337170,99999,1
Query:
SELECT "stn", "wban", COUNT(DISTINCT TO_DATE("year" || '-' || "mo" || '-' || "da", 'YYYY-MM-DD')) AS "total_temp_readings"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
WHERE "temp" IS NOT NULL
GROUP BY "stn", "wban"
LIMIT 100
Answer:
stn,wban,total_temp_readings
819010,99999,269
869770,99999,364
944570,99999,348
869620,99999,364
935970,99999,365
943670,99999,365
914080,40310,365
948270,99999,365
949600,99999,365
997364,99999,357
998271,99999,358
946280,99999,364
956460,99999,365
994045,99999,358
998409,99999,359
761130,99999,153
377920,99999,363
536980,99999,362
587310,99999,362
955650,99999,365
998177,99999,365
423720,99999,320
917530,99999,365
946100,99999,365
997264,99999,364
998218,99999,358
022470,99999,357
417640,99999,344
318730,99999,365
289930,99999,364
684790,99999,338
415980,99999,352
948750,99999,365
965650,99999,359
431210,99999,360
476610,43321,311
480310,99999,358
276270,99999,330
419430,99999,135
111930,99999,86
532760,99999,312
999999,00439,342
652016,99999,24
682710,99999,354
418950,99999,78
292530,99999,360
406020,99999,140
720897,99999,302
999999,63829,365
563740,99999,362
890030,99999,339
969330,99999,170
419780,99999,364
865850,99999,307
376750,99999,365
869040,99999,319
338850,99999,365
249510,99999,365
317070,99999,365
345350,99999,145
165410,99999,248
575160,99999,365
717130,99999,364
162530,99999,365
959850,99999,365
266570,99999,226
954580,99999,359
654180,99999,277
013370,99999,209
827980,99999,365
997779,99999,359
322870,99999,258
415300,99999,354
480800,99999,364
442190,99999,365
837490,99999,197
634020,99999,150
999999,94059,365
600070,99999,320
831150,99999,200
949290,99999,365
994979,99999,365
672800,99999,163
040770,99999,363
610170,99999,357
330360,99999,277
654420,99999,245
024410,99999,357
419290,99999,68
433710,99999,365
710944,99999,319
830110,99999,101
407010,99999,364
353610,99999,365
997386,99999,348
998425,99999,355
999999,00459,184
688130,99999,349
605200,99999,364
227780,99999,365
Query:
SELECT "stn", "wban", 
  MIN(TO_DATE("year" || '-' || "mo" || '-' || "da", 'YYYY-MM-DD')) AS "first_record", 
  MAX(TO_DATE("year" || '-' || "mo" || '-' || "da", 'YYYY-MM-DD')) AS "last_record"
FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
GROUP BY "stn", "wban"
LIMIT 100
Answer:
stn,wban,first_record,last_record
789480,00406,2022-01-01,2022-12-31
800010,99999,2022-01-01,2022-12-31
817030,99999,2022-04-01,2022-12-31
859212,99999,2022-01-01,2022-12-31
867770,99999,2022-01-01,2022-12-31
819880,99999,2022-01-01,2022-12-31
829170,99999,2022-01-01,2022-12-31
832480,99999,2022-01-01,2022-12-31
867610,99999,2022-01-04,2022-12-31
869500,99999,2022-01-01,2022-12-31
869710,99999,2022-01-01,2022-12-31
871480,99999,2022-01-01,2022-12-31
874530,99999,2022-01-01,2022-12-31
879040,99999,2022-01-01,2022-12-31
913340,40505,2022-01-01,2022-12-31
941200,99999,2022-01-01,2022-12-31
945890,99999,2022-01-01,2022-12-31
946000,99999,2022-01-01,2022-12-31
947100,99999,2022-01-01,2022-12-31
953040,99999,2022-01-01,2022-12-31
954870,99999,2022-01-01,2022-12-31
956580,99999,2022-01-01,2022-12-31
957080,99999,2022-01-01,2022-12-31
964410,99999,2022-01-01,2022-12-31
967490,99999,2022-01-01,2022-12-31
975600,99999,2022-01-01,2022-12-31
958360,99999,2022-01-01,2022-12-31
994008,99999,2022-01-01,2022-12-31
994070,99999,2022-01-01,2022-06-06
997301,99999,2022-01-01,2022-12-30
997694,99999,2022-01-01,2022-12-30
999999,94645,2022-01-01,2022-12-31
999999,04236,2022-01-01,2022-12-31
999999,00423,2022-01-01,2022-12-31
A00013,63847,2022-01-01,2022-12-31
866920,99999,2022-03-15,2022-12-31
890550,99999,2022-01-01,2022-12-31
931910,99999,2022-01-01,2022-12-31
941160,99999,2022-01-01,2022-12-16
941390,99999,2022-01-01,2022-12-31
946310,99999,2022-01-01,2022-12-31
957180,99999,2022-01-01,2022-12-31
994024,99999,2022-01-01,2022-12-29
994041,99999,2022-01-01,2022-12-30
997284,99999,2022-01-01,2022-12-30
997309,99999,2022-01-01,2022-12-30
997312,99999,2022-01-01,2022-12-30
997705,99999,2022-01-01,2022-12-30
998208,99999,2022-01-01,2022-12-31
999999,25522,2022-01-01,2022-12-31
999999,00430,2022-01-24,2022-12-31
997344,99999,2022-01-01,2022-11-27
998195,99999,2022-01-01,2022-12-30
998243,99999,2022-01-01,2022-12-30
866110,99999,2022-09-12,2022-12-31
866360,99999,2022-09-13,2022-11-26
010760,99999,2022-02-17,2022-12-31
013610,99999,2022-02-17,2022-12-31
020360,99999,2022-01-01,2022-12-31
023380,99999,2022-01-01,2022-12-31
263810,99999,2022-07-14,2022-07-15
265390,99999,2022-02-03,2022-12-31
268550,99999,2022-01-01,2022-12-31
412420,99999,2022-01-01,2022-12-31
419150,99999,2022-01-01,2022-12-31
427680,99999,2022-01-01,2022-12-31
480940,99999,2022-01-01,2022-12-31
526520,99999,2022-01-01,2022-12-31
604230,99999,2022-01-01,2022-12-31
610750,99999,2022-01-04,2022-12-31
506580,99999,2022-01-01,2022-12-31
602750,99999,2022-01-03,2022-12-31
606900,99999,2022-01-01,2022-12-31
434220,99999,2022-01-01,2022-12-31
646010,99999,2022-01-01,2022-12-31
686490,99999,2022-01-01,2022-12-27
687520,99999,2022-01-01,2022-12-31
688370,99999,2022-01-01,2022-12-31
722073,03727,2022-01-01,2022-12-31
765480,99999,2022-01-02,2022-12-31
767730,99999,2022-01-01,2022-12-30
786720,99999,2022-01-02,2022-12-30
834990,99999,2022-01-01,2022-12-31
841050,99999,2022-01-03,2022-12-30
841320,99999,2022-01-03,2022-12-30
870650,99999,2022-04-22,2022-12-31
913480,99999,2022-01-01,2022-12-31
917840,99999,2022-01-01,2022-12-31
976980,99999,2022-01-01,2022-12-31
984330,99999,2022-01-01,2022-12-31
135930,99999,2022-01-01,2022-12-31
229960,99999,2022-01-01,2022-12-31
237010,99999,2022-01-01,2022-12-31
266360,99999,2022-01-01,2022-12-31
289840,99999,2022-01-01,2022-12-31
382230,99999,2022-01-01,2022-12-31
433690,99999,2022-01-01,2022-12-31
011430,99999,2022-01-12,2022-12-31
412530,99999,2022-01-01,2022-12-31
477760,99999,2022-01-01,2022-12-31
End Exploring Related Columns
Task: How much percentage of weather stations recorded temperature data for at least 90% of the days in 2022?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the percentage of weather stations that recorded temperature data for at least 90% of the days in 2022, we need to analyze the `GSOD2022` table in the `NOAA_GSOD` schema. This involves counting the number of stations that have temperature records for at least 328 days (which is 90% of 365 days in 2022) and calculating their proportion out of the total number of stations.

The result can be represented in the following format:

```csv
Percentage_of_Stations
percentage:float
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NOAA_DATA': {'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS'], 'NOAA_HISTORIC_SEVERE_STORMS': ['HAIL_REPORTS', 'NWS_FORECAST_REGIONS', 'STORMS_1950', 'STORMS_1951', 'STORMS_1952', 'STORMS_1953', 'STORMS_1954', 'STORMS_1955', 'STORMS_1956', 'STORMS_1957', 'STORMS_1958', 'STORMS_1959', 'STORMS_1960', 'STORMS_1961', 'STORMS_1962', 'STORMS_1963', 'STORMS_1964', 'STORMS_1965', 'STORMS_1966', 'STORMS_1967', 'STORMS_1968', 'STORMS_1969', 'STORMS_1970', 'STORMS_1971', 'STORMS_1972', 'STORMS_1973', 'STORMS_1974', 'STORMS_1975', 'STORMS_1976', 'STORMS_1977', 'STORMS_1978', 'STORMS_1979', 'STORMS_1980', 'STORMS_1981', 'STORMS_1982', 'STORMS_1983', 'STORMS_1984', 'STORMS_1985', 'STORMS_1986', 'STORMS_1987', 'STORMS_1988', 'STORMS_1989', 'STORMS_1990', 'STORMS_1991', 'STORMS_1992', 'STORMS_1993', 'STORMS_1994', 'STORMS_1995', 'STORMS_1996', 'STORMS_1997', 'STORMS_1998', 'STORMS_1999', 'STORMS_2000', 'STORMS_2001', 'STORMS_2002', 'STORMS_2003', 'STORMS_2004', 'STORMS_2005', 'STORMS_2006', 'STORMS_2007', 'STORMS_2008', 'STORMS_2009', 'STORMS_2010', 'STORMS_2011', 'STORMS_2012', 'STORMS_2013', 'STORMS_2014', 'STORMS_2015', 'STORMS_2016', 'STORMS_2017', 'STORMS_2018', 'STORMS_2019', 'STORMS_2020', 'STORMS_2021', 'STORMS_2022', 'STORMS_2023', 'STORMS_2024', 'TORNADO_PATHS', 'TORNADO_REPORTS', 'WIND_REPORTS'], 'NOAA_HURRICANES': ['HURRICANES'], 'NOAA_ICOADS': ['ICOADS_CORE_1662_2000', 'ICOADS_CORE_2001_2004', 'ICOADS_CORE_2005', 'ICOADS_CORE_2006', 'ICOADS_CORE_2007', 'ICOADS_CORE_2008', 'ICOADS_CORE_2009', 'ICOADS_CORE_2010', 'ICOADS_CORE_2011', 'ICOADS_CORE_2012', 'ICOADS_CORE_2013', 'ICOADS_CORE_2014', 'ICOADS_CORE_2015', 'ICOADS_CORE_2016', 'ICOADS_CORE_2017'], 'NOAA_PASSIVE_ACOUSTIC_INDEX': ['NRS_METADATA', 'SANCTSOUND_METADATA'], 'NOAA_PASSIVE_BIOACOUSTIC': ['NCEI_AFSC_PAD_METADATA', 'NCEI_NEFSC_PAD_METADATA', 'NCEI_NRS_PAD_METADATA', 'NCEI_SANCTSOUND_PAD_METADATA'], 'NOAA_PIFSC_METADATA': ['DCLDE_2020_1705_ARRAY', 'DCLDE_2020_1705_MINKE_DETECTIONS', 'DCLDE_2020_1705_ODONTOCETE_DETECTIONS', 'DCLDE_2020_1705_VISUAL_SIGHTINGS', 'DCLDE_2020_1706_ARRAY', 'DCLDE_2020_1706_ODONTOCETE_DETECTIONS', 'DCLDE_2020_1706_VISUAL_SIGHTINGS', 'DCLDE_2020_DETECTION_README', 'DCLDE_2020_SPECIES_LOOKUP', 'DCLDE_LASKER_ARRAY_DEPTH', 'DCLDE_LASKER_GPS', 'DCLDE_SETTE_ARRAY_DEPTH', 'DCLDE_SETTE_GPS'], 'NOAA_PRELIMINARY_SEVERE_STORMS': ['HAIL_REPORTS', 'TORNADO_REPORTS', 'WIND_REPORTS'], 'NOAA_SIGNIFICANT_EARTHQUAKES': ['EARTHQUAKES'], 'NOAA_TSUNAMI': ['HISTORICAL_RUNUPS', 'HISTORICAL_SOURCE_EVENT']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 08:17:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:17:56 - root - INFO - ```sql
SELECT 
  ROUND(
    (
      (
        SELECT COUNT(*) FROM (
          SELECT "stn", "wban"
          FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
          WHERE "temp" IS NOT NULL
          GROUP BY "stn", "wban"
          HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
        )
      ) * 100.0
    ) / 
    (
      SELECT COUNT(DISTINCT "stn", "wban")
      FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    )
  , 4
  ) AS "Percentage_of_Stations";
```
2025-01-24 08:17:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:17:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:17:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:17:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:17:58 - snowflake.connector.connection - INFO - closed
2025-01-24 08:17:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:17:58 - root - INFO - itercount: 1
2025-01-24 08:17:58 - root - INFO - 0
2025-01-24 08:17:59 - root - INFO - results: 
Percentage_of_Stations
79.5113


2025-01-24 08:17:59 - root - INFO - Please check the answer again by reviewing How much percentage of weather stations recorded temperature data for at least 90% of the days in 2022?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the percentage of weather stations that recorded temperature data for at least 90% of the days in 2022, we need to analyze the `GSOD2022` table in the `NOAA_GSOD` schema. This involves counting the number of stations that have temperature records for at least 328 days (which is 90% of 365 days in 2022) and calculating their proportion out of the total number of stations.

The result can be represented in the following format:

```csv
Percentage_of_Stations
percentage:float
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_Stations
79.5113
Current sql:
SELECT 
  ROUND(
    (
      (
        SELECT COUNT(*) FROM (
          SELECT "stn", "wban"
          FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
          WHERE "temp" IS NOT NULL
          GROUP BY "stn", "wban"
          HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
        )
      ) * 100.0
    ) / 
    (
      SELECT COUNT(DISTINCT "stn", "wban")
      FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    )
  , 4
  ) AS "Percentage_of_Stations";
2025-01-24 08:18:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:18:21 - root - INFO - ```sql
SELECT 
  ROUND(
    (
      (
        SELECT COUNT(*) FROM (
          SELECT "stn", "wban"
          FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
          WHERE "temp" IS NOT NULL
          GROUP BY "stn", "wban"
          HAVING COUNT(DISTINCT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0')), 'YYYY-MM-DD')) >= 329
        )
      ) * 100.0
    ) / 
    (
      SELECT COUNT(DISTINCT "stn", "wban")
      FROM "NOAA_DATA"."NOAA_GSOD"."GSOD2022"
    )
  , 4
  ) AS "Percentage_of_Stations";
```
2025-01-24 08:18:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:18:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:18:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:18:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:18:22 - snowflake.connector.connection - INFO - closed
2025-01-24 08:18:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:18:23 - root - INFO - itercount: 2
2025-01-24 08:18:23 - root - INFO - 0
2025-01-24 08:18:23 - root - INFO - Total iteration counts: 2
