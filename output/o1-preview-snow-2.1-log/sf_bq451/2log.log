2025-01-25 06:25:54 - openai._base_client - INFO - Retrying request to /chat/completions in 0.427905 seconds
2025-01-25 06:26:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:26:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 25
2025-01-25 06:26:40 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:40 - root - INFO - SQL:
-- 1. List distinct chromosomes available in the VARIANTS table
SELECT DISTINCT "reference_name"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
LIMIT 100
Results:
reference_name
22
17
4
14
19
8
11
10
Y
5
15
21
12
6
20
13
7
9
MT
1
16
2
18
X
3

2025-01-25 06:26:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:26:42 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:42 - root - INFO - SQL:
-- 2. Retrieve sample IDs from the SAMPLE_INFO table
SELECT DISTINCT "Sample"
FROM "_1000_GENOMES"."_1000_GENOMES"."SAMPLE_INFO"
LIMIT 100
Results:
Sample
HG03167
HG03310
HG02974
HG02938
HG02943
HG03123
HG03499
HG03119
HG03117
HG03159
HG03160
HG03105
HG03157
HG03266
HG02946
HG03163
HG03371
HG03190
HG03291
HG03374
HG02973
HG02968
HG03139
HG03293
HG03370
HG03200
HG02953
HG03309
HG03343
HG03202
HG03521
HG03125
HG03114
HG03339
HG03129
HG03099
HG03118
HG03269
HG03161
NA20822
HG03350
HG03295
HG03369
HG03198
HG03120
HG02923
HG03135
HG02948
HG03313
HG03126
HG03111
HG03312
HG03194
HG03517
HG03280
HG03189
NA20831
NA20802
HG03344
HG03107
HG03103
NA20763
NA20530
NA20582
HG02942
HG02945
HG03115
HG02941
HG03352
HG03127
HG03298
HG02980
HG03306
HG03195
HG03122
HG03137
HG03368
HG03124
HG03362
HG03516
HG03372
HG03272
HG03128
HG03168
NA20813
HG03158
HG03279
HG03173
HG03101
HG02970
HG03342
HG03104
HG03134
HG03109
HG03270
HG03300
HG03294
HG03166
HG03172
HG03518

2025-01-25 06:26:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 06:26:44 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:44 - root - INFO - SQL:
-- 3. Count the total number of variants on chromosome X
SELECT COUNT(*) AS "total_variants_chrX"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
Results:
total_variants_chrX
1373

2025-01-25 06:26:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 06:26:46 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:46 - root - INFO - SQL:
-- 4. Count the number of variants on chromosome X outside the excluded regions
SELECT COUNT(*) AS "variants_chrX_outside_regions"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
Results:
variants_chrX_outside_regions
1314

2025-01-25 06:26:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:26:48 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:48 - root - INFO - SQL:
-- 5. List variants on chromosome X with reference and alternate bases
SELECT "start", "reference_bases", "alternate_bases"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
LIMIT 100
Results:
start,reference_bases,alternate_bases
81086700,G,"[
  ""A""
]"
87882198,G,"[
  ""A""
]"
152099520,G,"[
  ""A""
]"
124006381,G,"[
  ""A""
]"
4348305,G,"[
  ""A""
]"
43612707,G,"[
  ""A""
]"
71257580,G,"[
  ""A""
]"
99774236,G,"[
  ""A""
]"
18545883,G,"[
  ""C""
]"
38211901,G,"[
  ""T""
]"
113047916,G,"[
  ""T""
]"
150844068,G,"[
  ""A""
]"
4760642,G,"[
  ""A""
]"
63617316,G,"[
  ""A""
]"
21087899,G,"[
  ""A""
]"
80013652,G,"[
  ""A""
]"
146652921,G,"[
  ""T""
]"
88135338,G,"[
  ""A""
]"
65582821,G,"[
  ""A""
]"
62525206,G,"[
  ""A""
]"
153920252,G,"[
  ""A""
]"
56677821,G,"[
  ""A""
]"
56980468,G,"[
  ""C""
]"
77817912,G,"[
  ""C""
]"
99373143,G,"[
  ""A""
]"
140556347,G,"[
  ""C""
]"
133844014,G,"[
  ""A""
]"
103661626,G,"[
  ""A""
]"
83342070,G,"[
  ""T""
]"
124643730,G,"[
  ""A""
]"
95038343,A,"[
  ""C""
]"
149773216,A,"[
  ""G""
]"
84659916,A,"[
  ""G""
]"
53827232,A,"[
  ""G""
]"
82413531,A,"[
  ""G""
]"
121043665,A,"[
  ""G""
]"
109104686,A,"[
  ""C""
]"
69663529,A,"[
  ""G""
]"
75900977,A,"[
  ""G""
]"
35237263,A,"[
  ""G""
]"
88740620,A,"[
  ""G""
]"
107834800,A,"[
  ""G""
]"
6479107,A,"[
  ""G""
]"
97836875,A,"[
  ""G""
]"
6500096,A,"[
  ""C""
]"
106143062,A,"[
  ""G""
]"
63101071,A,"[
  ""G""
]"
87720115,A,"[
  ""G""
]"
53580573,A,"[
  ""C""
]"
119843604,A,"[
  ""G""
]"
66459047,A,"[
  ""G""
]"
37339388,AAGAGAGAGAGAGGAAAAAG,"[
  ""A""
]"
90752774,AC,"[
  ""A""
]"
96143882,ATC,"[
  ""A""
]"
35425011,A,"[
  ""G""
]"
79075411,A,"[
  ""C""
]"
48909555,A,"[
  ""C""
]"
47125155,A,"[
  ""G""
]"
106950864,A,"[
  ""G""
]"
122604225,A,"[
  ""G""
]"
15327427,A,"[
  ""G""
]"
113613492,A,"[
  ""G""
]"
88240258,A,"[
  ""T""
]"
39315583,A,"[
  ""G""
]"
80844410,A,"[
  ""G""
]"
24780345,A,"[
  ""G""
]"
81337065,A,"[
  ""C""
]"
51860866,A,"[
  ""T""
]"
151562062,A,"[
  ""G""
]"
53387701,A,"[
  ""G""
]"
85628160,A,"[
  ""G""
]"
90040658,A,"[
  ""G""
]"
71484790,A,"[
  ""G""
]"
96168527,AT,"[
  ""A""
]"
103833253,CA,"[
  ""C""
]"
94048373,GA,"[
  ""G""
]"
82259613,TC,"[
  ""T""
]"
143504683,TG,"[
  ""T""
]"
9744777,ACT,"[
  ""A""
]"
110909355,TAAAGAAA,"[
  ""T""
]"
122554900,AT,"[
  ""A""
]"
127190536,GT,"[
  ""G""
]"
82818789,TGA,"[
  ""T""
]"
70449960,TACC,"[
  ""T""
]"
89369330,A,"[
  ""G""
]"
38735483,A,"[
  ""G""
]"
85079344,A,"[
  ""C""
]"
32715262,A,"[
  ""G""
]"
123919933,A,"[
  ""G""
]"
123863864,A,"[
  ""G""
]"
120660196,A,"[
  ""G""
]"
103285400,A,"[
  ""T""
]"
80917954,A,"[
  ""C""
]"
115889728,A,"[
  ""C""
]"
146570477,A,"[
  ""G""
]"
128558157,A,"[
  ""T""
]"
49793833,A,"[
  ""G""
]"
19770540,A,"[
  ""T""
]"
140056997,A,"[
  ""G""
]"
37011533,A,"[
  ""G""
]"

2025-01-25 06:26:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:26:49 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:50 - root - INFO - SQL:
-- 6. Retrieve variants where both reference and alternate bases are single nucleotides (SNPs)
SELECT "start", "reference_bases", "alternate_bases"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."alternate_bases") ab
WHERE "reference_name" = 'X'
  AND LENGTH("reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
LIMIT 100
Results:
start,reference_bases,alternate_bases
89369330,A,"[
  ""G""
]"
38735483,A,"[
  ""G""
]"
85079344,A,"[
  ""C""
]"
32715262,A,"[
  ""G""
]"
123919933,A,"[
  ""G""
]"
123863864,A,"[
  ""G""
]"
120660196,A,"[
  ""G""
]"
103285400,A,"[
  ""T""
]"
80917954,A,"[
  ""C""
]"
115889728,A,"[
  ""C""
]"
146570477,A,"[
  ""G""
]"
128558157,A,"[
  ""T""
]"
49793833,A,"[
  ""G""
]"
19770540,A,"[
  ""T""
]"
140056997,A,"[
  ""G""
]"
37011533,A,"[
  ""G""
]"
67635671,C,"[
  ""T""
]"
77094817,C,"[
  ""A""
]"
30923086,C,"[
  ""T""
]"
119253941,C,"[
  ""T""
]"
80949020,C,"[
  ""T""
]"
73871856,C,"[
  ""T""
]"
9432411,C,"[
  ""T""
]"
66401732,G,"[
  ""T""
]"
137348579,G,"[
  ""C""
]"
16418342,G,"[
  ""A""
]"
3058602,G,"[
  ""A""
]"
9584581,G,"[
  ""T""
]"
106420793,G,"[
  ""A""
]"
99055585,G,"[
  ""A""
]"
84099954,G,"[
  ""T""
]"
115185311,G,"[
  ""T""
]"
14813174,G,"[
  ""A""
]"
145629361,G,"[
  ""T""
]"
54050018,G,"[
  ""A""
]"
88853999,G,"[
  ""A""
]"
83254708,G,"[
  ""C""
]"
22026398,G,"[
  ""T""
]"
64094215,G,"[
  ""A""
]"
27798171,G,"[
  ""A""
]"
71834055,G,"[
  ""A""
]"
76405301,G,"[
  ""A""
]"
83162940,G,"[
  ""A""
]"
89149792,G,"[
  ""C""
]"
9972938,G,"[
  ""T""
]"
97707229,G,"[
  ""A""
]"
83873129,G,"[
  ""A""
]"
10083391,G,"[
  ""C""
]"
105960612,A,"[
  ""T""
]"
97675035,A,"[
  ""C""
]"
49697074,A,"[
  ""T""
]"
34719147,A,"[
  ""G""
]"
95804105,A,"[
  ""G""
]"
31472969,A,"[
  ""C""
]"
5638579,A,"[
  ""G""
]"
118700353,A,"[
  ""C""
]"
141661662,A,"[
  ""G""
]"
30740065,A,"[
  ""G""
]"
4137364,A,"[
  ""G""
]"
79596281,A,"[
  ""G""
]"
101433486,A,"[
  ""G""
]"
14776105,A,"[
  ""G""
]"
48152279,A,"[
  ""T""
]"
77527471,A,"[
  ""G""
]"
113925250,A,"[
  ""T""
]"
47278385,A,"[
  ""G""
]"
57334810,A,"[
  ""G""
]"
121114762,A,"[
  ""T""
]"
147989725,A,"[
  ""G""
]"
132216405,A,"[
  ""G""
]"
153392639,A,"[
  ""G""
]"
65267331,A,"[
  ""G""
]"
103779641,A,"[
  ""G""
]"
147769373,A,"[
  ""T""
]"
81192168,A,"[
  ""G""
]"
112265715,A,"[
  ""G""
]"
69025169,A,"[
  ""T""
]"
151208338,A,"[
  ""G""
]"
110157204,A,"[
  ""G""
]"
136459422,A,"[
  ""T""
]"
96784102,A,"[
  ""G""
]"
62315793,T,"[
  ""C""
]"
91175296,T,"[
  ""A""
]"
8210009,T,"[
  ""G""
]"
38238323,T,"[
  ""C""
]"
94409028,T,"[
  ""C""
]"
31885372,T,"[
  ""A""
]"
143497438,C,"[
  ""T""
]"
151902628,C,"[
  ""T""
]"
7349351,C,"[
  ""T""
]"
44737071,C,"[
  ""G""
]"
104800585,C,"[
  ""A""
]"
45268052,C,"[
  ""T""
]"
107852101,C,"[
  ""T""
]"
6533097,C,"[
  ""A""
]"
43652126,C,"[
  ""T""
]"
92332821,C,"[
  ""T""
]"
107834308,C,"[
  ""T""
]"
94111707,C,"[
  ""T""
]"
115841870,C,"[
  ""T""
]"

2025-01-25 06:26:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:26:51 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:51 - root - INFO - SQL:
-- 7. Explore the structure of the "call" column by flattening it
SELECT f.value
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-0"",
  ""call_set_name"": ""HG00261"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.500000000000000e+00,
    -2.100000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-1"",
  ""call_set_name"": ""HG00593"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.500000000000000e+00,
    -2.100000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-2"",
  ""call_set_name"": ""NA12749"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -3.000000000000000e-01,
    -3.200000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-3"",
  ""call_set_name"": ""HG00150"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.500000000000000e+00,
    -2.100000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-4"",
  ""call_set_name"": ""NA19675"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.200000000000000e+00,
    -1.680000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-5"",
  ""call_set_name"": ""NA19651"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.800000000000000e+00,
    -2.520000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-6"",
  ""call_set_name"": ""NA19393"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.260000000000000e+01
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-7"",
  ""call_set_name"": ""NA19207"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.120000000000000e+01
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-8"",
  ""call_set_name"": ""HG00342"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -8.400000000000000e+00
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-9"",
  ""call_set_name"": ""NA12546"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -3.000000000000000e+00
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-10"",
  ""call_set_name"": ""NA12843"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00,
    0.000000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-11"",
  ""call_set_name"": ""NA19063"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-12"",
  ""call_set_name"": ""NA19713"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.200000000000000e+00,
    -1.680000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-13"",
  ""call_set_name"": ""NA20517"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00,
    0.000000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-14"",
  ""call_set_name"": ""NA20533"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00,
    0.000000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-15"",
  ""call_set_name"": ""HG00534"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -3.000000000000000e-01,
    -4.200000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-16"",
  ""call_set_name"": ""NA12778"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -9.000000000000000e-01,
    -1.260000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": []

2025-01-25 06:26:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:26:53 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:26:53 - root - INFO - SQL:
-- 8. Extract sample IDs and genotypes from the "call" column
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  f.value:"genotype" AS "genotype"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
LIMIT 100
Results:
sample_id,genotype
HG00261,"[
  0,
  0
]"
HG00593,"[
  0,
  0
]"
NA12749,"[
  0,
  0
]"
HG00150,"[
  0,
  0
]"
NA19675,"[
  0,
  0
]"
NA19651,"[
  0,
  0
]"
NA19393,"[
  0
]"
NA19207,"[
  0
]"
HG00342,"[
  0
]"
NA12546,"[
  0
]"
NA12843,"[
  0,
  0
]"
NA19063,"[
  0
]"
NA19713,"[
  0,
  0
]"
NA20517,"[
  0,
  0
]"
NA20533,"[
  0,
  0
]"
HG00534,"[
  0,
  0
]"
NA12778,"[
  0,
  0
]"
NA18555,"[
  0,
  0
]"
NA18574,"[
  0,
  0
]"
NA19035,"[
  0
]"
NA19350,"[
  0
]"
NA11831,"[
  0
]"
HG00351,"[
  0
]"
HG00654,"[
  0,
  0
]"
HG00124,"[
  0,
  0
]"
HG00369,"[
  0
]"
NA12872,"[
  0
]"
NA18620,"[
  0
]"
NA19248,"[
  0
]"
NA20299,"[
  0,
  0
]"
HG00108,"[
  0
]"
NA18546,"[
  0
]"
NA19451,"[
  0
]"
HG00584,"[
  0,
  0
]"
HG01070,"[
  0,
  0
]"
NA19434,"[
  0,
  0
]"
NA19449,"[
  0,
  0
]"
NA19720,"[
  0
]"
NA19750,"[
  0
]"
HG00448,"[
  0
]"
NA18641,"[
  0,
  0
]"
NA18988,"[
  0
]"
NA19452,"[
  0
]"
HG01498,"[
  0,
  0
]"
HG01515,"[
  0
]"
NA12340,"[
  0
]"
NA18592,"[
  0,
  0
]"
NA18618,"[
  0,
  0
]"
HG01437,"[
  0
]"
NA18525,"[
  0,
  0
]"
NA19429,"[
  0
]"
HG01171,"[
  0,
  0
]"
NA18582,"[
  0,
  0
]"
NA19346,"[
  0
]"
NA19703,"[
  0
]"
NA12004,"[
  0,
  0
]"
NA19789,"[
  0
]"
HG00190,"[
  0
]"
HG01272,"[
  0,
  0
]"
NA18577,"[
  0,
  0
]"
NA18954,"[
  0,
  0
]"
NA19704,"[
  0,
  0
]"
HG00187,"[
  0
]"
HG00628,"[
  0
]"
HG00634,"[
  0
]"
HG01140,"[
  0,
  0
]"
NA18982,"[
  0
]"
NA20759,"[
  0
]"
HG00284,"[
  0
]"
HG00246,"[
  0
]"
NA12058,"[
  0,
  0
]"
NA19456,"[
  0,
  0
]"
NA20412,"[
  0,
  0
]"
NA20758,"[
  0
]"
HG00344,"[
  0,
  0
]"
NA11992,"[
  0
]"
NA12342,"[
  0
]"
NA19403,"[
  0,
  0
]"
HG00243,"[
  0
]"
NA07056,"[
  0,
  0
]"
NA19065,"[
  0,
  0
]"
NA19921,"[
  0,
  0
]"
HG00104,"[
  0,
  0
]"
NA18560,"[
  0,
  0
]"
NA18615,"[
  0,
  0
]"
HG00476,"[
  0,
  0
]"
NA12761,"[
  0,
  0
]"
NA19099,"[
  0,
  0
]"
NA19313,"[
  0,
  0
]"
NA19471,"[
  0,
  0
]"
NA19723,"[
  0
]"
NA19777,"[
  0
]"
HG00557,"[
  0,
  0
]"
NA19430,"[
  0
]"
NA19758,"[
  0,
  0
]"
NA19780,"[
  0
]"
NA19328,"[
  0,
  0
]"
NA12044,"[
  0,
  0
]"
NA19436,"[
  0,
  0
]"
NA19684,"[
  0,
  0
]"

2025-01-25 06:26:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:26:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:26:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:26:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 06:26:55 - snowflake.connector.connection - INFO - closed
2025-01-25 06:26:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:27:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:27:25 - root - INFO - ```sql
SELECT
  sample_id,
  SUM(homo_ref) AS homozygous_reference_alleles,
  SUM(homo_alt) AS homozygous_alternate_alleles,
  SUM(het_alt) AS heterozygous_alternate_alleles,
  COUNT(*) AS total_callable_sites,
  SUM(homo_alt + het_alt) AS total_SNVs,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN (SUM(het_alt) / SUM(homo_alt + het_alt)) * 100
    ELSE 0
  END AS percentage_heterozygous_alternate_alleles,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN (SUM(homo_alt) / SUM(homo_alt + het_alt)) * 100
    ELSE 0
  END AS percentage_homozygous_alternate_alleles
FROM (
  SELECT
    f.value:"call_set_name"::STRING AS sample_id,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_ref,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1] THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_alt,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] != f.value:"genotype"[1] AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL THEN 1
          ELSE 0
        END
      ELSE 0
    END AS het_alt
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
) sub
GROUP BY sample_id;
```
2025-01-25 06:27:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:27:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:27:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:27:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 822
2025-01-25 06:27:28 - snowflake.connector.connection - INFO - closed
2025-01-25 06:27:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:28:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:28:50 - root - INFO - SQL:
SELECT
  sample_id,
  SUM(homo_ref) AS homozygous_reference_alleles,
  SUM(homo_alt) AS homozygous_alternate_alleles,
  SUM(het_alt) AS heterozygous_alternate_alleles,
  COUNT(*) AS total_callable_sites,
  SUM(homo_alt + het_alt) AS total_SNVs,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN (SUM(het_alt) / SUM(homo_alt + het_alt)) * 100
    ELSE 0
  END AS percentage_heterozygous_alternate_alleles,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN (SUM(homo_alt) / SUM(homo_alt + het_alt)) * 100
    ELSE 0
  END AS percentage_homozygous_alternate_alleles
FROM (
  SELECT
    f.value:"call_set_name"::STRING AS sample_id,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_ref,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1] THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_alt,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] != f.value:"genotype"[1] AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL THEN 1
          ELSE 0
        END
      ELSE 0
    END AS het_alt
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
) sub
GROUP BY sample_id;
Results:
Too long, hard cut:
SAMPLE_ID,HOMOZYGOUS_REFERENCE_ALLELES,HOMOZYGOUS_ALTERNATE_ALLELES,HETEROZYGOUS_ALTERNATE_ALLELES,TOTAL_CALLABLE_SITES,TOTAL_SNVS,PERCENTAGE_HETEROZYGOUS_ALTERNATE_ALLELES,PERCENTAGE_HOMOZYGOUS_ALTERNATE_ALLELES
HG00351,1185,78,0,1263,78,0.000000,100.000000
NA19834,1173,90,0,1263,90,0.000000,100.000000
NA19087,1154,56,53,1263,109,48.623900,51.376100
NA18910,1157,106,0,1263,106,0.000000,100.000000
HG01148,1180,83,0,1263,83,0.000000,100.000000
HG00428,1150,51,62,1263,113,54.867300,45.132700
HG00640,1186,77,0,1263,77,0.000000,100.000000
NA20543,1193,70,0,1263,70,0.000000,100.000000
HG00110,1161,45,57,1263,102,55.882400,44.117600
NA18498,1158,105,0,1263,105,0.000000,100.000000
NA19080,1157,44,62,1263,106,58.490600,41.509400
NA19738,1178,85,0,1263,85,0.000000,100.000000
HG01174,1147,42,74,1263,116,63.793100,36.206900
NA12275,1161,42,60,1263,102,58.823500,41.176500
NA19434,1108,53,102,1263,155,65.806500,34.193500
NA20322,1112,49,102,1263,151,67.549700,32.450300
NA18561,1175,88,0,1263,88,0.000000,100.000000
NA18995,1197,66,0,1263,66,0.000000,100.000000
NA19719,1147,42,74,1263,116,63.793100,36.206900
HG01102,1152,44,67,1263,111,60.360400,39.639600
HG00183,1185,78,0,1263,78,0.000000,100.000000
NA20752,1186,77,0,1263,77,0.000000,100.000000
NA18567,1145,53,65,1263,118,55.084700,44.915300
NA19917,1100,61,102,1263,163,62.576700,37.423300
HG00650,1174,89,0,1263,89,0.000000,100.000000
NA18606,1191,72,0,1263,72,0.000000,100.000000
NA19391,1128,54,81,1263,135,60.000000,40.000000
NA20336,1119,44,100,1263,144,69.444400,30.555600
NA20755,1188,75,0,1263,75,0.000000,100.000000
NA19403,1120,51,92,1263,143,64.335700,35.664300
HG00557,1159,54,50,1263,104,48.076900,51.923100
NA20278,1156,107,0,1263,107,0.000000,100.000000
NA20522,1152,39,72,1263,111,64.864900,35.135100
NA19399,1099,62,102,1263,164,62.195100,37.804900
HG00705,1154,50,59,1263,109,54.128400,45.871600
NA19036,1114,57,92,1263,149,61.745000,38.255000
NA18868,1161,102,0,1263,102,0.000000,100.000000
NA18978,1159,37,67,1263,104,64.423100,35.576900
NA19377,1098,59,106,1263,165,64.242400,35.757600
NA11932,1193,70,0,1263,70,0.000000,100.000000
HG01491,1192,71,0,1263,71,0.000000,100.000000
NA11829,1197,66,0,1263,66,0.000000,100.000000
NA12347,1193,70,0,1263,70,0.000000,100.000000
HG00306,1164,36,63,1263,99,63.636400,36.363600
NA20503,1155,43,65,1263,108,60.185200,39.814800
NA18555,1144,52,67,1263,119,56.302500,43.697500
NA19720,1171,92,0,1263,92,0.000000,100.000000
NA19789,1171,92,0,1263,92,0.000000,100.000000
NA19740,1148,47,68,1263,115,59.130400,40.869600
NA19762,1186,77,0,1263,77,0.000000,100.000000
HG00451,1178,85,0,1263,85,0.000000,100.000000
NA19316,1094,55,114,1263,169,67.455600,32.544400
HG00358,1195,68,0,1263,68,0.000000,100.000000
NA20512,1192,71,0,1263,71,0.000000,100.000000
NA19682,1186,77,0,1263,77,0.000000,100.000000
HG01461,1172,91,0,1263,91,0.000000,100.000000
HG01108,1126,58,79,1263,137,57.664200,42.335800
NA18642,1162,43,58,1263,101,57.425700,42.574300
NA18946,1149,53,61,1263,114,53.508800,46.491200
NA18614,1147,57,59,1263,116,50.862100,49.137900
HG00345,1179,84,0,1263,84,0.000000,100.000000
HG00262,1171,45,47,1263,92,51.087000,48.913000
HG00446,1152,48,63,1263,111,56.756800,43.243200
HG00736,1195,68,0,1263,68,0.000000,100.000000
HG01107,1179,84,0,1263,84,0.000000,100.000000
HG00578,1141,45,77,1263,122,63.114800,36.885200
NA12716,1193,70,0,1263,70,0.000000,100.000000
NA18574,1149,51,63,1263,114,55.263200,44.736800
NA18945,1192,71,0,1263,71,0.000000,100.000000
NA18923,1157,106,0,1263,106,0.000000,100.000000
NA19185,1112,44,107,1263,151,70.860900,29.139100
NA20513,1191,72,0,1263,72,0.000000,100.000000
NA19785,1152,42,69,1263,111,62.162200,37.837800
HG00247,1145,43,75,1263,118,63.559300,36.440700
NA19310,1109,52,102,1263,154,66.233800,33.766200
NA19786,1185,78,0,1263,78,0.000000,100.000000
NA18908,1148,115,0,1263,115,0.000000,100.000000
NA20528,1185,78,0,1263,78,0.000000,100.000000
HG01124,1184,79,0,1263,79,0.000000,100.000000
HG01113,1160,40,63,1263,103,61.165000,38.835000
NA18602,1149,49,65,1263,114,57.017500,42.982500
HG00663,1158,54,51,1263,105,48.571400,51.428600
HG01095,1138,35,90,1263,125,72.000000,28.000000
NA12546,1187,76,0,1263,76,0.000000,100.000000
HG00312,1186,77,0,1263,77,0.000000,100.000000
NA20802,1149,34,80,1263,114,70.175400,29.824600
NA18610,1160,45,58,1263,103,56.310700,43.689300
NA20812,1188,75,0,1263,75,0.000000,100.000000
HG01488,1190,73,0,1263,73,0.000000,100.000000
NA18623,1179,84,0,1263,84,0.000000,100.000000
NA20317,1099,50,114,1263,164,69.512200,30.487800
NA12249,1170,48,45,1263,93,48.387100,51.612900
HG00121,1163,44,56,1263,100,56.000000,44.000000
NA19734,1155,53,55,1263,108,50.925900,49.074100
HG00111,1163,41,59,1263,100,59.000000,41.000000
NA18550,1154,54,55,1263,109,50.458700,49.541300
HG00382,1191,72,0,1263,72,0.000000,100.000000
HG01516,1157,48,58,1263,106,54.717000,45.283000
NA06989,1159,45,59,1263,104,56.730800,43.269200
HG00362,1175,43,45,1263,88,51.136400,48.863600
NA10847,1159,41,63,1263,104,60.576900,39.423100
NA18745,1180,

2025-01-25 06:28:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:28:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:28:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:28:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:28:52 - snowflake.connector.connection - INFO - closed
2025-01-25 06:28:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:28:52 - root - INFO - SQL:
-- 10. Get counts of different genotype types per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 1 THEN f.value:"genotype"[0] ELSE NULL END AS "allele1",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 2 THEN f.value:"genotype"[1] ELSE NULL END AS "allele2",
  COUNT(*) AS "count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id", "allele1", "allele2"
ORDER BY "sample_id", "count" DESC
LIMIT 100
Results:
sample_id,allele1,allele2,count
HG00096,0,,1228
HG00096,1,,86
HG00097,0,0,1196
HG00097,1,1,45
HG00097,1,0,40
HG00097,0,1,33
HG00099,0,0,1209
HG00099,1,1,54
HG00099,1,0,32
HG00099,0,1,19
HG00100,0,0,1206
HG00100,1,1,49
HG00100,0,1,35
HG00100,1,0,24
HG00101,0,,1233
HG00101,1,,81
HG00102,0,0,1207
HG00102,1,1,42
HG00102,1,0,34
HG00102,0,1,31
HG00103,0,,1224
HG00103,1,,90
HG00104,0,0,1203
HG00104,1,0,39
HG00104,0,1,36
HG00104,1,1,36
HG00106,0,0,1190
HG00106,1,1,50
HG00106,0,1,40
HG00106,1,0,34
HG00108,0,,1230
HG00108,1,,84
HG00109,0,,1234
HG00109,1,,80
HG00110,0,0,1201
HG00110,1,1,49
HG00110,1,0,43
HG00110,0,1,21
HG00111,0,0,1206
HG00111,1,1,45
HG00111,0,1,32
HG00111,1,0,31
HG00112,0,,1229
HG00112,1,,85
HG00113,0,,1237
HG00113,1,,77
HG00114,0,,1223
HG00114,1,,91
HG00116,0,,1231
HG00116,1,,83
HG00117,0,,1233
HG00117,1,,81
HG00118,0,0,1201
HG00118,1,1,49
HG00118,0,1,36
HG00118,1,0,28
HG00119,0,,1232
HG00119,1,,82
HG00120,0,0,1203
HG00120,1,1,49
HG00120,0,1,34
HG00120,1,0,28
HG00121,0,0,1206
HG00121,1,1,48
HG00121,1,0,33
HG00121,0,1,27
HG00122,0,0,1199
HG00122,1,1,45
HG00122,0,1,39
HG00122,1,0,31
HG00123,0,0,1200
HG00123,1,1,49
HG00123,1,0,35
HG00123,0,1,30
HG00124,0,0,1196
HG00124,1,1,55
HG00124,0,1,36
HG00124,1,0,27
HG00125,0,0,1194
HG00125,1,1,47
HG00125,1,0,43
HG00125,0,1,30
HG00126,0,,1227
HG00126,1,,87
HG00127,0,0,1189
HG00127,1,1,56
HG00127,0,1,35
HG00127,1,0,34
HG00128,0,0,1203
HG00128,1,1,46
HG00128,0,1,35
HG00128,1,0,30
HG00129,0,,1231
HG00129,1,,83
HG00130,0,0,1202
HG00130,1,1,46
HG00130,0,1,34
HG00130,1,0,32
HG00131,0,,1238
HG00131,1,,76

2025-01-25 06:28:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:28:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:28:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:28:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:28:54 - snowflake.connector.connection - INFO - closed
2025-01-25 06:28:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:28:54 - root - INFO - SQL:
-- 11. List samples with their total number of callable sites
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_callable_sites"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND f.value:"genotype" IS NOT NULL
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,total_callable_sites
NA19675,1314
NA19207,1314
NA18546,1314
NA18959,1314
HG00449,1314
HG00524,1314
HG01342,1314
NA07048,1314
NA20296,1314
NA18543,1314
HG00378,1314
NA19434,1314
NA20322,1314
NA18561,1314
NA18995,1314
NA19719,1314
HG01102,1314
HG00183,1314
NA20752,1314
NA18567,1314
NA19917,1314
NA20336,1314
NA20755,1314
HG00650,1314
NA18606,1314
NA19391,1314
NA18574,1314
NA18945,1314
NA18923,1314
NA20513,1314
NA19785,1314
HG00247,1314
NA19786,1314
NA18908,1314
NA20528,1314
HG01124,1314
NA18602,1314
HG00663,1314
HG01095,1314
NA19185,1314
NA19310,1314
HG01113,1314
HG00351,1314
NA19834,1314
NA19087,1314
NA18910,1314
HG01148,1314
HG00428,1314
HG00640,1314
NA20543,1314
HG00110,1314
NA18498,1314
NA19080,1314
NA19738,1314
HG01174,1314
NA12275,1314
NA12546,1314
HG00312,1314
NA20802,1314
NA18610,1314
NA20812,1314
NA20317,1314
NA12249,1314
HG00382,1314
HG00121,1314
NA19734,1314
HG00111,1314
NA18550,1314
HG01516,1314
HG01488,1314
NA18623,1314
NA19403,1314
HG00557,1314
NA20278,1314
NA20522,1314
NA19399,1314
HG00705,1314
HG00306,1314
NA19036,1314
NA18868,1314
NA18978,1314
NA11932,1314
NA19377,1314
HG01491,1314
NA11829,1314
NA12347,1314
NA20503,1314
HG00124,1314
HG00350,1314
NA19307,1314
HG00614,1314
NA20828,1314
NA19093,1314
NA11995,1314
NA19783,1314
NA18505,1314
HG00331,1314
HG00339,1314
NA20753,1314
NA18963,1314

2025-01-25 06:28:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:28:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:28:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:28:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:28:56 - snowflake.connector.connection - INFO - closed
2025-01-25 06:28:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:28:56 - root - INFO - SQL:
-- 12. Identify heterozygous genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "heterozygous_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND ARRAY_SIZE(f.value:"genotype") = 2
  AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL
  AND f.value:"genotype"[0] != f.value:"genotype"[1]
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,heterozygous_count
HG00110,64
NA12275,66
NA19080,70
HG01174,78
NA19087,61
HG00428,70
NA19403,97
NA20522,79
HG00306,69
NA19036,97
NA19377,116
NA19399,108
NA20503,69
NA18978,73
HG00705,64
HG00557,55
NA19185,115
NA19310,109
NA19785,75
HG00247,82
NA18574,69
HG01113,68
HG01095,99
NA18602,73
HG00663,57
NA19675,75
NA20296,113
HG00449,68
HG01342,120
HG00378,66
NA18867,123
NA18565,64
HG01171,84
NA19660,74
NA18627,58
NA12778,77
NA11993,76
HG00125,73
HG00353,65
NA18858,116
HG00268,61
HG01168,67
NA20773,66
HG01251,80
NA19064,54
NA20506,16
HG00690,70
NA12749,72
HG01188,107
HG00383,59
NA20541,74
HG00266,62
HG00231,70
NA11933,62
HG00346,59
NA18951,80
HG01149,68
NA18912,100
HG00235,78
HG00130,66
HG00276,69
NA19731,58
NA19463,127
NA19172,116
NA19776,78
NA20800,69
NA19712,120
HG01456,65
NA18949,57
NA19077,64
NA19332,12
NA20357,118
NA18924,98
NA12830,74
HG00272,74
NA19456,113
HG00699,61
NA20774,63
HG00479,61
HG00179,58
NA19355,115
NA20287,105
NA12004,70
HG00120,62
NA19681,91
NA18999,65
NA18630,73
NA12717,71
HG00437,75
HG00531,55
NA18597,56
HG00343,59
NA18626,68
NA20761,69
HG01351,71
HG00693,65
NA12815,64
NA19737,61
HG00106,74
HG01492,86

2025-01-25 06:28:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:28:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:28:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:28:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:28:58 - snowflake.connector.connection - INFO - closed
2025-01-25 06:28:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:28:58 - root - INFO - SQL:
-- 13. Compute total SNVs per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_SNVs"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f,
  LATERAL FLATTEN(input => t."alternate_bases") ab
WHERE t."reference_name" = 'X'
  AND LENGTH(t."reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,total_SNVs
HG00428,113
HG00351,78
NA19834,90
HG01148,83
HG00110,102
NA18498,105
HG00640,77
NA12275,102
NA19087,109
NA19080,106
NA19738,85
NA20543,70
HG01174,116
NA18910,106
NA18923,106
NA19185,151
NA19310,154
NA18908,115
NA18574,114
HG00247,118
HG01124,79
NA18602,114
NA20528,78
HG01113,103
HG01095,125
NA19785,111
HG00663,105
NA19786,78
NA20513,72
NA18945,71
NA19434,155
HG01102,111
NA18567,118
NA20336,144
NA19917,163
HG00183,78
NA20752,77
NA20322,151
NA20755,75
HG00650,89
NA19391,135
NA19719,116
NA18995,66
NA18561,88
NA18606,72
NA20802,114
NA20317,164
NA12249,93
HG00312,77
NA20812,75
HG01488,73
HG00382,72
HG00121,100
NA18550,109
HG01516,106
NA18623,84
NA19734,108
NA12546,76
NA18610,103
HG00111,100
HG01171,119
NA19660,115
HG00553,91
NA18867,157
NA20281,102
HG00338,72
NA19982,113
NA20356,94
HG00335,69
NA18565,103
NA18627,101
NA18544,91
HG00556,91
NA18548,86
NA18983,81
NA19067,76
HG00101,76
NA19776,117
NA20800,103
NA19712,158
HG01456,114
NA19332,115
NA19172,161
NA19463,170
NA19077,112
NA20815,74
HG00139,69
NA18949,98
NA19732,78
HG00109,73
NA12763,114
NA18871,103
NA18593,113
NA19315,163
NA19020,88
NA19379,160
NA12761,101
NA20588,73
HG01620,110
NA19661,84

2025-01-25 06:28:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:28:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:28:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:29:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:29:00 - snowflake.connector.connection - INFO - closed
2025-01-25 06:29:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:29:00 - root - INFO - SQL:
-- 14. List homozygous alternate genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "homozygous_alternate_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1]) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,homozygous_alternate_count
NA18910,120
NA19834,98
NA18498,113
HG01148,93
NA19738,93
NA19087,61
HG00428,55
HG00640,83
NA20543,76
NA19080,48
HG01174,46
HG00110,49
HG00351,84
NA12275,46
NA18908,128
NA18923,118
NA19185,50
NA19310,57
NA19785,46
NA20528,85
HG01124,88
HG00247,48
NA20513,77
NA19786,87
HG01113,46
NA18945,77
NA18602,57
NA18574,56
HG00663,59
HG01095,40
NA19207,119
NA20296,57
NA18546,93
HG00524,97
NA19675,45
NA18959,85
HG01342,50
NA07048,77
NA18543,87
HG00449,56
HG00378,44
NA19434,60
NA20322,59
NA19917,67
NA20336,49
NA19391,57
NA18561,95
NA19719,48
NA20752,84
HG00183,85
NA18995,75
HG01102,48
NA18567,60
NA20755,82
HG00650,95
NA18606,77
NA19403,59
NA20278,117
NA19399,70
NA19036,63
NA18868,111
NA19377,67
NA11829,74
NA11932,77
HG01491,78
HG00557,60
NA20522,43
HG00705,53
NA18978,41
NA12347,76
HG00306,40
NA20503,46
NA19904,108
NA19452,97
NA20126,114
NA18520,64
NA20344,57
NA18499,59
NA20127,46
HG00436,93
NA11894,51
NA19758,48
NA12718,53
NA20775,47
HG00657,56
NA18605,99
HG00261,51
NA20786,46
NA19375,124
NA19723,87
NA20761,48
NA19076,82
NA12815,43
HG00693,52
HG01389,79
HG01351,48
NA20805,82
NA19346,128
NA19923,42
NA19138,101

2025-01-25 06:29:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:29:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:29:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:29:01 - snowflake.connector.connection - INFO - closed
2025-01-25 06:29:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:29:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:29:47 - root - INFO - The error occurs because the identifier `sample_id` in the outer query does not match the case and quoting of the alias defined in the subquery. In Snowflake, identifiers are case-sensitive when double-quoted. To resolve the issue, ensure that you consistently reference the aliases with the correct casing and quoting.

Here's the corrected SQL query:

```sql
SELECT 
  "sample_id",
  ("heterozygous_count" / NULLIF("total_SNVs", 0)) * 100 AS "percentage_heterozygous"
FROM (
  SELECT 
    f.value:"call_set_name"::STRING AS "sample_id",
    SUM(CASE 
          WHEN ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] != f.value:"genotype"[1] THEN 1 
          ELSE 0 
        END) AS "heterozygous_count",
    SUM(CASE 
          WHEN (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR 
               (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0) THEN 1 
          ELSE 0 
        END) AS "total_SNVs"
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
  GROUP BY "sample_id"
) sub
LIMIT 100;
```

**Explanation:**

- In the subquery, `"sample_id"` is aliased with double quotes, preserving its case.
- In the outer query, reference `"sample_id"` with double quotes to match the alias from the subquery.
- Similarly, use double quotes for `"heterozygous_count"` and `"total_SNVs"` in the outer query.

This ensures that the identifiers are correctly recognized, and the query should execute without the `invalid identifier` error.
2025-01-25 06:29:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:29:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:29:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:29:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:29:49 - snowflake.connector.connection - INFO - closed
2025-01-25 06:29:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:31:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:31:29 - root - INFO - SQL:
SELECT 
  "sample_id",
  ("heterozygous_count" / NULLIF("total_SNVs", 0)) * 100 AS "percentage_heterozygous"
FROM (
  SELECT 
    f.value:"call_set_name"::STRING AS "sample_id",
    SUM(CASE 
          WHEN ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] != f.value:"genotype"[1] THEN 1 
          ELSE 0 
        END) AS "heterozygous_count",
    SUM(CASE 
          WHEN (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR 
               (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0) THEN 1 
          ELSE 0 
        END) AS "total_SNVs"
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
  GROUP BY "sample_id"
) sub
LIMIT 100;
Results:
sample_id,percentage_heterozygous
NA19434,65.806500
NA20322,67.549700
NA18561,0.000000
NA18995,0.000000
NA19719,63.793100
HG01102,60.360400
HG00183,0.000000
NA20752,0.000000
NA18567,55.084700
NA19917,62.576700
HG00650,0.000000
NA18606,0.000000
NA19391,60.000000
NA20336,69.444400
NA20755,0.000000
NA20819,62.608700
NA19318,0.000000
HG01521,0.000000
NA18942,49.557500
HG01082,0.000000
NA19235,69.182400
HG00445,0.000000
HG00160,0.000000
NA12045,0.000000
NA20517,56.363600
NA18977,0.000000
HG00500,0.000000
HG00128,58.000000
NA20792,0.000000
HG00464,55.172400
NA19468,64.625900
HG00458,53.921600
NA19676,0.000000
NA19657,55.454500
NA12489,54.368900
NA19059,51.818200
NA19317,0.000000
NA18564,51.376100
HG00275,57.943900
HG01051,0.000000
NA20334,66.438400
HG00124,54.205600
HG00350,55.319100
NA19307,0.000000
HG00614,50.442500
NA20828,55.963300
NA19093,64.102600
NA11995,55.000000
NA19783,0.000000
NA18505,67.664700
HG00339,61.764700
NA20753,51.818200
NA18963,48.543700
NA19701,72.142900
HG00331,50.526300
NA19063,0.000000
NA20757,51.456300
NA11931,58.653800
NA11930,0.000000
HG00478,0.000000
NA18516,0.000000
NA20536,0.000000
NA19331,0.000000
HG00257,55.140200
HG00254,59.000000
NA18535,55.855900
NA18984,0.000000
NA19060,0.000000
NA20524,0.000000
NA12043,0.000000
HG00174,59.482800
HG01069,0.000000
NA11830,51.041700
HG00131,0.000000
HG00129,0.000000
HG00320,58.653800
HG00376,58.415800
NA18974,0.000000
NA19117,0.000000
HG01623,58.490600
NA11994,0.000000
NA19222,68.553500
NA19197,65.217400
HG00096,0.000000
NA19747,0.000000
NA20298,0.000000
NA20516,0.000000
NA19038,71.604900
NA20754,0.000000
NA18603,0.000000
NA20816,0.000000
NA18861,62.987000
NA18534,0.000000
NA19770,63.392900
NA11892,61.165000
NA11831,0.000000
HG00448,0.000000
NA12004,56.756800
HG00437,55.263200
NA19355,69.871800

2025-01-25 06:31:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:31:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:31:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:31:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:31:31 - snowflake.connector.connection - INFO - closed
2025-01-25 06:31:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:31:31 - root - INFO - SQL:
-- 10. Get counts of different genotype types per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 1 THEN f.value:"genotype"[0] ELSE NULL END AS "allele1",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 2 THEN f.value:"genotype"[1] ELSE NULL END AS "allele2",
  COUNT(*) AS "count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id", "allele1", "allele2"
ORDER BY "sample_id", "count" DESC
LIMIT 100
Results:
sample_id,allele1,allele2,count
HG00096,0,,1228
HG00096,1,,86
HG00097,0,0,1196
HG00097,1,1,45
HG00097,1,0,40
HG00097,0,1,33
HG00099,0,0,1209
HG00099,1,1,54
HG00099,1,0,32
HG00099,0,1,19
HG00100,0,0,1206
HG00100,1,1,49
HG00100,0,1,35
HG00100,1,0,24
HG00101,0,,1233
HG00101,1,,81
HG00102,0,0,1207
HG00102,1,1,42
HG00102,1,0,34
HG00102,0,1,31
HG00103,0,,1224
HG00103,1,,90
HG00104,0,0,1203
HG00104,1,0,39
HG00104,1,1,36
HG00104,0,1,36
HG00106,0,0,1190
HG00106,1,1,50
HG00106,0,1,40
HG00106,1,0,34
HG00108,0,,1230
HG00108,1,,84
HG00109,0,,1234
HG00109,1,,80
HG00110,0,0,1201
HG00110,1,1,49
HG00110,1,0,43
HG00110,0,1,21
HG00111,0,0,1206
HG00111,1,1,45
HG00111,0,1,32
HG00111,1,0,31
HG00112,0,,1229
HG00112,1,,85
HG00113,0,,1237
HG00113,1,,77
HG00114,0,,1223
HG00114,1,,91
HG00116,0,,1231
HG00116,1,,83
HG00117,0,,1233
HG00117,1,,81
HG00118,0,0,1201
HG00118,1,1,49
HG00118,0,1,36
HG00118,1,0,28
HG00119,0,,1232
HG00119,1,,82
HG00120,0,0,1203
HG00120,1,1,49
HG00120,0,1,34
HG00120,1,0,28
HG00121,0,0,1206
HG00121,1,1,48
HG00121,1,0,33
HG00121,0,1,27
HG00122,0,0,1199
HG00122,1,1,45
HG00122,0,1,39
HG00122,1,0,31
HG00123,0,0,1200
HG00123,1,1,49
HG00123,1,0,35
HG00123,0,1,30
HG00124,0,0,1196
HG00124,1,1,55
HG00124,0,1,36
HG00124,1,0,27
HG00125,0,0,1194
HG00125,1,1,47
HG00125,1,0,43
HG00125,0,1,30
HG00126,0,,1227
HG00126,1,,87
HG00127,0,0,1189
HG00127,1,1,56
HG00127,0,1,35
HG00127,1,0,34
HG00128,0,0,1203
HG00128,1,1,46
HG00128,0,1,35
HG00128,1,0,30
HG00129,0,,1231
HG00129,1,,83
HG00130,0,0,1202
HG00130,1,1,46
HG00130,0,1,34
HG00130,1,0,32
HG00131,0,,1238
HG00131,1,,76

2025-01-25 06:31:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:31:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:31:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:31:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:31:33 - snowflake.connector.connection - INFO - closed
2025-01-25 06:31:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:31:33 - root - INFO - SQL:
-- 11. List samples with their total number of callable sites
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_callable_sites"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND f.value:"genotype" IS NOT NULL
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,total_callable_sites
NA12546,1314
HG00312,1314
NA20802,1314
NA18610,1314
NA20812,1314
NA20317,1314
NA12249,1314
HG00382,1314
HG00121,1314
NA19734,1314
HG00111,1314
NA18550,1314
HG01516,1314
HG01488,1314
NA18623,1314
HG00351,1314
NA19834,1314
NA19087,1314
NA18910,1314
HG01148,1314
HG00428,1314
HG00640,1314
NA20543,1314
HG00110,1314
NA18498,1314
NA19080,1314
NA19738,1314
HG01174,1314
NA12275,1314
NA06989,1314
HG00362,1314
NA10847,1314
HG00559,1314
NA18745,1314
HG00596,1314
HG01101,1314
NA12889,1314
NA19753,1314
HG00156,1314
HG00404,1314
HG00236,1314
HG00536,1314
NA19095,1314
HG00112,1314
NA19098,1314
HG00251,1314
NA18526,1314
NA19403,1314
HG00557,1314
NA20278,1314
NA20522,1314
NA19399,1314
HG00705,1314
HG00306,1314
NA19036,1314
NA18868,1314
NA18978,1314
NA11932,1314
NA19377,1314
HG01491,1314
NA11829,1314
NA12347,1314
NA20503,1314
HG00534,1314
NA19065,1314
HG00512,1314
HG00356,1314
NA20504,1314
NA19352,1314
HG00332,1314
NA18966,1314
HG01274,1314
NA18612,1314
HG00263,1314
NA18633,1314
HG00359,1314
HG00141,1314
NA19247,1314
NA19436,1314
HG01066,1314
NA12272,1314
NA20521,1314
NA20801,1314
NA18553,1314
HG00180,1314
HG01617,1314
HG00525,1314
NA19444,1314
NA19385,1314
NA19457,1314
NA20804,1314
NA18487,1314
NA19223,1314
NA07347,1314
NA18980,1314
NA19055,1314
NA20339,1314
NA18961,1314
HG01137,1314
NA19434,1314

2025-01-25 06:31:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:31:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:31:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:31:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:31:34 - snowflake.connector.connection - INFO - closed
2025-01-25 06:31:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:31:35 - root - INFO - SQL:
-- 12. Identify heterozygous genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "heterozygous_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND ARRAY_SIZE(f.value:"genotype") = 2
  AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL
  AND f.value:"genotype"[0] != f.value:"genotype"[1]
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,heterozygous_count
NA18614,65
NA19316,120
HG01108,83
NA18642,67
NA18555,76
NA18946,70
HG00446,70
HG00578,81
HG00262,58
NA19740,72
NA19087,61
HG00110,64
NA19080,70
NA12275,66
HG00428,70
HG01174,78
NA18567,69
NA19434,109
NA20336,113
NA19391,93
HG01102,72
NA19917,107
NA19719,82
NA20322,107
NA19675,75
NA20296,113
HG00449,68
HG01342,120
HG00378,66
NA18909,101
NA19204,112
NA19435,104
NA20585,68
HG00258,66
HG00593,66
HG00638,84
NA18617,67
HG00330,71
HG00590,69
NA18528,57
NA20504,70
HG00263,65
NA19247,99
HG00356,74
HG00359,70
HG00332,63
HG00534,56
NA19065,68
NA12749,72
HG01149,68
NA20541,74
HG01188,107
NA18951,80
HG00266,62
NA11933,62
HG00383,59
HG00690,70
HG00231,70
HG00346,59
NA20808,68
NA19470,116
NA19921,110
NA19440,102
NA18545,64
NA19728,60
HG01551,100
NA19328,112
NA18939,65
HG00240,67
NA20813,64
NA18525,60
NA18595,66
NA20282,100
NA19149,124
HG00654,55
NA18640,68
HG01618,72
HG00158,60
NA19190,111
NA12763,86
HG01198,83
NA19315,113
NA18593,63
NA12761,61
HG01384,87
HG01620,75
HG01441,70
NA18998,66
NA19379,124
NA18968,56
HG00171,73
NA18552,65
HG00684,79
NA19752,64
NA12873,68
HG00381,60
NA19114,120
NA18907,117
NA19835,119
HG00239,61

2025-01-25 06:31:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:31:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:31:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:31:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:31:36 - snowflake.connector.connection - INFO - closed
2025-01-25 06:31:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:31:37 - root - INFO - SQL:
-- 13. Compute total SNVs per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_SNVs"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f,
  LATERAL FLATTEN(input => t."alternate_bases") AS ab
WHERE t."reference_name" = 'X'
  AND LENGTH(t."reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,total_SNVs
HG00428,113
HG00351,78
NA19834,90
HG01148,83
HG00110,102
NA18498,105
HG00640,77
NA12275,102
NA19087,109
NA19080,106
NA20543,70
NA19738,85
HG01174,116
NA18910,106
HG00156,77
HG00236,112
HG00112,78
NA19098,101
HG00559,80
NA06989,104
HG00362,88
NA10847,104
NA12889,66
HG00404,104
HG00536,75
HG00251,81
NA18526,107
HG00596,115
HG01101,81
NA19095,144
NA18745,83
NA19753,80
NA19403,143
NA20522,111
HG00306,99
NA19036,149
NA19377,165
NA20503,108
NA19399,164
NA11932,70
HG00557,104
NA18868,102
NA20278,107
HG00705,109
NA12347,70
HG01491,71
NA18978,104
NA11829,66
HG01488,73
NA20317,164
HG00121,100
NA20812,75
NA18623,84
NA12249,93
NA20802,114
HG00382,72
NA19734,108
NA12546,76
NA18610,103
HG00111,100
NA18550,109
HG01516,106
HG00312,77
NA20761,107
HG01351,109
NA19375,114
NA19723,76
HG00693,105
HG01389,72
NA19076,73
NA12815,98
NA20805,75
NA18917,100
HG01170,90
NA12777,77
NA19371,101
NA18962,72
NA18909,154
NA20585,114
NA19204,159
NA19435,156
HG01518,79
HG00258,97
NA20525,72
HG00593,106
HG01625,79
HG00638,123
NA18617,108
NA18986,79
HG00590,111
HG00330,101
HG00375,84
NA12748,80
NA18528,106
HG00148,69
HG00113,71
NA19651,109
NA19096,98
NA20796,84
NA20769,95

2025-01-25 06:31:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:31:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:31:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:31:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 06:31:38 - snowflake.connector.connection - INFO - closed
2025-01-25 06:31:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:31:39 - root - INFO - SQL:
-- 14. List homozygous alternate genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "homozygous_alternate_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1]) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Results:
sample_id,homozygous_alternate_count
NA19207,119
NA19675,45
NA07048,77
NA18543,87
NA18546,93
NA18959,85
HG00524,97
HG01342,50
NA20296,57
HG00449,56
HG00378,44
NA18908,128
NA18923,118
HG00247,48
NA20528,85
NA20513,77
NA19785,46
NA19786,87
HG01124,88
HG01113,46
NA18945,77
NA18602,57
NA19185,50
NA19310,57
NA18574,56
HG00663,59
HG01095,40
NA18910,120
HG00351,84
NA19834,98
HG01148,93
NA18498,113
HG00640,83
NA19087,61
NA19738,93
HG00428,55
NA20543,76
NA19080,48
HG01174,46
HG00110,49
NA12275,46
NA19028,112
NA19119,117
NA18912,68
NA19756,96
HG00421,87
NA18943,76
HG00565,89
HG00235,35
HG00130,46
NA18940,93
HG00186,78
NA19731,57
HG00276,44
HG00500,91
NA20334,54
NA19317,107
NA19468,62
HG01051,113
HG00128,46
NA18977,93
HG00464,58
NA19676,95
NA20792,77
HG00458,52
NA19657,52
NA12489,50
NA19059,58
HG00275,50
NA20517,52
NA18564,57
NA19171,126
NA19041,121
HG00244,88
NA18858,59
NA12778,47
NA12282,80
NA20506,74
NA20770,80
NA18562,92
HG00457,79
HG00325,82
HG01136,90
NA18609,93
HG00140,86
HG01251,43
HG00125,47
NA19064,59
NA12872,71
HG01168,43
HG00268,43
HG00353,47
NA11993,39
NA20773,41
NA19711,105
NA18934,131
NA19467,63
HG00613,92
NA18916,60
NA20518,81

2025-01-25 06:31:39 - root - INFO - itercount: 0
2025-01-25 06:31:39 - root - INFO - Database Name: _1000_GENOMES
Schema Name: _1000_GENOMES
DDL describes table information.
,0
table_name,SAMPLE_INFO
description,
DDL,"create or replace TABLE SAMPLE_INFO (
	""Sample"" VARCHAR(16777216),
	""Family_ID"" VARCHAR(16777216),
	""Population"" VARCHAR(16777216),
	""Population_Description"" VARCHAR(16777216),
	""Gender"" VARCHAR(16777216),
	""Relationship"" VARCHAR(16777216),
	""Unexpected_Parent_Child"" VARCHAR(16777216),
	""Non_Paternity"" VARCHAR(16777216),
	""Siblings"" VARCHAR(16777216),
	""Grandparents"" VARCHAR(16777216),
	""Avuncular"" VARCHAR(16777216),
	""Half_Siblings"" VARCHAR(16777216),
	""Unknown_Second_Order"" VARCHAR(16777216),
	""Third_Order"" VARCHAR(16777216),
	""In_Low_Coverage_Pilot"" BOOLEAN,
	""LC_Pilot_Platforms"" VARCHAR(16777216),
	""LC_Pilot_Centers"" VARCHAR(16777216),
	""In_High_Coverage_Pilot"" BOOLEAN,
	""HC_Pilot_Platforms"" VARCHAR(16777216),
	""HC_Pilot_Centers"" VARCHAR(16777216),
	""In_Exon_Targetted_Pilot"" BOOLEAN,
	""ET_Pilot_Platforms"" VARCHAR(16777216),
	""ET_Pilot_Centers"" VARCHAR(16777216),
	""Has_Sequence_in_Phase1"" BOOLEAN,
	""Phase1_LC_Platform"" VARCHAR(16777216),
	""Phase1_LC_Centers"" VARCHAR(16777216),
	""Phase1_E_Platform"" VARCHAR(16777216),
	""Phase1_E_Centers"" VARCHAR(16777216),
	""In_Phase1_Integrated_Variant_Set"" BOOLEAN,
	""Has_Phase1_chrY_SNPS"" BOOLEAN,
	""Has_phase1_chrY_Deletions"" BOOLEAN,
	""Has_phase1_chrMT_SNPs"" BOOLEAN,
	""Main_project_LC_Centers"" VARCHAR(16777216),
	""Main_project_LC_platform"" VARCHAR(16777216),
	""Total_LC_Sequence"" FLOAT,
	""LC_Non_Duplicated_Aligned_Coverage"" FLOAT,
	""Main_Project_E_Centers"" VARCHAR(16777216),
	""Main_Project_E_Platform"" VARCHAR(16777216),
	""Total_Exome_Sequence"" FLOAT,
	""X_Targets_Covered_to_20x_or_greater"" FLOAT,
	""VerifyBam_E_Omni_Free"" FLOAT,
	""VerifyBam_E_Affy_Free"" FLOAT,
	""VerifyBam_E_Omni_Chip"" FLOAT,
	""VerifyBam_E_Affy_Chip"" FLOAT,
	""VerifyBam_LC_Omni_Free"" FLOAT,
	""VerifyBam_LC_Affy_Free"" FLOAT,
	""VerifyBam_LC_Omni_Chip"" FLOAT,
	""VerifyBam_LC_Affy_Chip"" FLOAT,
	""LC_Indel_Ratio"" FLOAT,
	""E_Indel_Ratio"" FLOAT,
	""LC_Passed_QC"" BOOLEAN,
	""E_Passed_QC"" BOOLEAN,
	""In_Final_Phase_Variant_Calling"" BOOLEAN,
	""Has_Omni_Genotypes"" BOOLEAN,
	""Has_Axiom_Genotypes"" BOOLEAN,
	""Has_Affy_6_0_Genotypes"" BOOLEAN,
	""Has_Exome_LOF_Genotypes"" BOOLEAN,
	""EBV_Coverage"" FLOAT,
	""DNA_Source_from_Coriell"" VARCHAR(16777216),
	""Has_Sequence_from_Blood_in_Index"" BOOLEAN,
	""Super_Population"" VARCHAR(16777216),
	""Super_Population_Description"" VARCHAR(16777216)
);"

,1
table_name,PEDIGREE
description,
DDL,"create or replace TABLE PEDIGREE (
	""Family_ID"" VARCHAR(16777216),
	""Individual_ID"" VARCHAR(16777216),
	""Paternal_ID"" VARCHAR(16777216),
	""Maternal_ID"" VARCHAR(16777216),
	""Gender"" NUMBER(38,0),
	""Phenotype"" NUMBER(38,0),
	""Population"" VARCHAR(16777216),
	""Relationship"" VARCHAR(16777216),
	""Siblings"" VARCHAR(16777216),
	""Second_Order"" VARCHAR(16777216),
	""Third_Order"" VARCHAR(16777216),
	""Other_Comments"" VARCHAR(16777216)
);"

,2
table_name,VARIANTS
description,
DDL,"create or replace TABLE VARIANTS (
	""reference_name"" VARCHAR(16777216),
	""start"" NUMBER(38,0),
	""end"" NUMBER(38,0),
	""reference_bases"" VARCHAR(16777216),
	""alternate_bases"" VARIANT,
	""quality"" FLOAT,
	""filter"" VARIANT,
	""names"" VARIANT,
	""call"" VARIANT,
	AA VARCHAR(16777216),
	AC VARIANT,
	AC1 NUMBER(38,0),
	AF FLOAT,
	AF1 FLOAT,
	AFR_AF FLOAT,
	AMR_AF FLOAT,
	AN NUMBER(38,0),
	ASN_AF FLOAT,
	AVGPOST FLOAT,
	CIEND VARIANT,
	CIPOS VARIANT,
	DP NUMBER(38,0),
	DP4 VARIANT,
	ERATE FLOAT,
	EUR_AF FLOAT,
	FQ FLOAT,
	G3 VARIANT,
	HOMLEN NUMBER(38,0),
	HOMSEQ VARCHAR(16777216),
	HWE FLOAT,
	LDAF FLOAT,
	MQ NUMBER(38,0),
	PV4 VARIANT,
	RSQ FLOAT,
	SNPSOURCE VARIANT,
	SOURCE VARIANT,
	SVLEN NUMBER(38,0),
	SVTYPE VARCHAR(16777216),
	THETA FLOAT,
	VT VARCHAR(16777216)
);"

External knowledge that might be helpful: 
# Explanation of Alleles Types

## homozygous reference alleles
- When both alleles are 0.

## homozygous alternate alleles
- When both alleles are identical and greater than 0.

## heterozygous alternate alleles
- When alleles are different or one is NULL with at least one greater than 0.

## callable sites
- Including homozygous reference, homozygous alternate, and heterozygous alleles.

## Single Nucleotide Variants (SNVs)
- Including homozygous and heterozygous alternate alleles.
The table structure information is ({database name: {schema name: {table name}}}): 
{'_1000_GENOMES': {'_1000_GENOMES': ['PEDIGREE', 'SAMPLE_INFO', 'VARIANTS']}}
Begin Exploring Related Columns
First, we consider the tables and columns relevant to the task:

- **Table:** `_1000_GENOMES._1000_GENOMES.VARIANTS`
  - `"reference_name"`: Used to filter variants on chromosome X.
  - `"start"`: Used to exclude variants within specified position ranges.
  - `"reference_bases"`: Reference base at the variant position.
  - `"alternate_bases"`: Alternate bases at the variant position.
  - `"call"`: Contains genotype calls per sample in VARIANT (nested) format.

- **Table:** `_1000_GENOMES._1000_GENOMES.SAMPLE_INFO`
  - `"Sample"`: Sample ID, which can be used to identify and link sample data.

**Conditions that may be used:**

- Filter for chromosome X:
  - `"reference_name" = 'X'`
- Exclude specific start positions:
  - `"start" NOT BETWEEN 60000 AND 2699519"`
  - `"start" NOT BETWEEN 154931042 AND 155260559"`
- Identify SNPs (Single Nucleotide Polymorphisms):
  - Variants where the length of `"reference_bases"` and all `"alternate_bases"` is 1.

---

Below are SQL queries to explore the data and understand the relevant columns:

```sql
-- 1. List distinct chromosomes available in the VARIANTS table
SELECT DISTINCT "reference_name"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
LIMIT 100;

-- 2. Retrieve sample IDs from the SAMPLE_INFO table
SELECT DISTINCT "Sample"
FROM "_1000_GENOMES"."_1000_GENOMES"."SAMPLE_INFO"
LIMIT 100;

-- 3. Count the total number of variants on chromosome X
SELECT COUNT(*) AS "total_variants_chrX"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X';

-- 4. Count the number of variants on chromosome X outside the excluded regions
SELECT COUNT(*) AS "variants_chrX_outside_regions"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559;

-- 5. List variants on chromosome X with reference and alternate bases
SELECT "start", "reference_bases", "alternate_bases"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
LIMIT 100;

-- 6. Retrieve variants where both reference and alternate bases are single nucleotides (SNPs)
SELECT "start", "reference_bases", "alternate_bases"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."alternate_bases") ab
WHERE "reference_name" = 'X'
  AND LENGTH("reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
LIMIT 100;

-- 7. Explore the structure of the "call" column by flattening it
SELECT f.value
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
LIMIT 100;

-- 8. Extract sample IDs and genotypes from the "call" column
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  f.value:"genotype" AS "genotype"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
LIMIT 100;

-- 9. Count the number of homozygous reference genotypes for a sample (e.g., sample 'NA12878')
SELECT COUNT(*) AS "homozygous_reference_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND f.value:"call_set_name"::STRING = 'NA12878'
  AND f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559;

-- 10. Get counts of different genotype types per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  f.value:"genotype"[0] AS "allele1",
  f.value:"genotype"[1] AS "allele2",
  COUNT(*) AS "count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id", "allele1", "allele2"
ORDER BY "sample_id", "count" DESC
LIMIT 100;

-- 11. List samples with their total number of callable sites
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_callable_sites"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100;

-- 12. Identify heterozygous genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "heterozygous_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND f.value:"genotype"[0] != f.value:"genotype"[1]
  AND f.value:"genotype"[0] IS NOT NULL
  AND f.value:"genotype"[1] IS NOT NULL
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100;

-- 13. Compute total SNVs per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_snvs"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f,
LATERAL FLATTEN(input => t."alternate_bases") ab
WHERE t."reference_name" = 'X'
  AND LENGTH(t."reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100;

-- 14. List homozygous alternate genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "homozygous_alternate_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0
  AND f.value:"genotype"[0] = f.value:"genotype"[1]
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100;

-- 15. Calculate percentage of heterozygous genotypes among SNVs for samples
SELECT 
  sample_id,
  (heterozygous_count / NULLIF(total_snvs, 0)) * 100 AS "percentage_heterozygous"
FROM (
  SELECT 
    f.value:"call_set_name"::STRING AS "sample_id",
    COUNT(CASE WHEN f.value:"genotype"[0] != f.value:"genotype"[1] THEN 1 END) AS "heterozygous_count",
    COUNT(*) AS "total_snvs"
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f,
  LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND "start" NOT BETWEEN 60000 AND 2699519
    AND "start" NOT BETWEEN 154931042 AND 155260559
  GROUP BY "sample_id"
) sub
LIMIT 100;
```

These queries help explore the data within the relevant tables and columns, providing insight into sample IDs, variant positions, genotypes, and counts necessary to understand the dataset before performing detailed analysis.Query:
-- 1. List distinct chromosomes available in the VARIANTS table
SELECT DISTINCT "reference_name"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
LIMIT 100
Answer:
reference_name
22
17
4
14
19
8
11
10
Y
5
15
21
12
6
20
13
7
9
MT
1
16
2
18
X
3
Query:
-- 2. Retrieve sample IDs from the SAMPLE_INFO table
SELECT DISTINCT "Sample"
FROM "_1000_GENOMES"."_1000_GENOMES"."SAMPLE_INFO"
LIMIT 100
Answer:
Sample
HG03167
HG03310
HG02974
HG02938
HG02943
HG03123
HG03499
HG03119
HG03117
HG03159
HG03160
HG03105
HG03157
HG03266
HG02946
HG03163
HG03371
HG03190
HG03291
HG03374
HG02973
HG02968
HG03139
HG03293
HG03370
HG03200
HG02953
HG03309
HG03343
HG03202
HG03521
HG03125
HG03114
HG03339
HG03129
HG03099
HG03118
HG03269
HG03161
NA20822
HG03350
HG03295
HG03369
HG03198
HG03120
HG02923
HG03135
HG02948
HG03313
HG03126
HG03111
HG03312
HG03194
HG03517
HG03280
HG03189
NA20831
NA20802
HG03344
HG03107
HG03103
NA20763
NA20530
NA20582
HG02942
HG02945
HG03115
HG02941
HG03352
HG03127
HG03298
HG02980
HG03306
HG03195
HG03122
HG03137
HG03368
HG03124
HG03362
HG03516
HG03372
HG03272
HG03128
HG03168
NA20813
HG03158
HG03279
HG03173
HG03101
HG02970
HG03342
HG03104
HG03134
HG03109
HG03270
HG03300
HG03294
HG03166
HG03172
HG03518
Query:
-- 3. Count the total number of variants on chromosome X
SELECT COUNT(*) AS "total_variants_chrX"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
Answer:
total_variants_chrX
1373
Query:
-- 4. Count the number of variants on chromosome X outside the excluded regions
SELECT COUNT(*) AS "variants_chrX_outside_regions"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
Answer:
variants_chrX_outside_regions
1314
Query:
-- 5. List variants on chromosome X with reference and alternate bases
SELECT "start", "reference_bases", "alternate_bases"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS"
WHERE "reference_name" = 'X'
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
LIMIT 100
Answer:
start,reference_bases,alternate_bases
81086700,G,"[
  ""A""
]"
87882198,G,"[
  ""A""
]"
152099520,G,"[
  ""A""
]"
124006381,G,"[
  ""A""
]"
4348305,G,"[
  ""A""
]"
43612707,G,"[
  ""A""
]"
71257580,G,"[
  ""A""
]"
99774236,G,"[
  ""A""
]"
18545883,G,"[
  ""C""
]"
38211901,G,"[
  ""T""
]"
113047916,G,"[
  ""T""
]"
150844068,G,"[
  ""A""
]"
4760642,G,"[
  ""A""
]"
63617316,G,"[
  ""A""
]"
21087899,G,"[
  ""A""
]"
80013652,G,"[
  ""A""
]"
146652921,G,"[
  ""T""
]"
88135338,G,"[
  ""A""
]"
65582821,G,"[
  ""A""
]"
62525206,G,"[
  ""A""
]"
153920252,G,"[
  ""A""
]"
56677821,G,"[
  ""A""
]"
56980468,G,"[
  ""C""
]"
77817912,G,"[
  ""C""
]"
99373143,G,"[
  ""A""
]"
140556347,G,"[
  ""C""
]"
133844014,G,"[
  ""A""
]"
103661626,G,"[
  ""A""
]"
83342070,G,"[
  ""T""
]"
124643730,G,"[
  ""A""
]"
95038343,A,"[
  ""C""
]"
149773216,A,"[
  ""G""
]"
84659916,A,"[
  ""G""
]"
53827232,A,"[
  ""G""
]"
82413531,A,"[
  ""G""
]"
121043665,A,"[
  ""G""
]"
109104686,A,"[
  ""C""
]"
69663529,A,"[
  ""G""
]"
75900977,A,"[
  ""G""
]"
35237263,A,"[
  ""G""
]"
88740620,A,"[
  ""G""
]"
107834800,A,"[
  ""G""
]"
6479107,A,"[
  ""G""
]"
97836875,A,"[
  ""G""
]"
6500096,A,"[
  ""C""
]"
106143062,A,"[
  ""G""
]"
63101071,A,"[
  ""G""
]"
87720115,A,"[
  ""G""
]"
53580573,A,"[
  ""C""
]"
119843604,A,"[
  ""G""
]"
66459047,A,"[
  ""G""
]"
37339388,AAGAGAGAGAGAGGAAAAAG,"[
  ""A""
]"
90752774,AC,"[
  ""A""
]"
96143882,ATC,"[
  ""A""
]"
35425011,A,"[
  ""G""
]"
79075411,A,"[
  ""C""
]"
48909555,A,"[
  ""C""
]"
47125155,A,"[
  ""G""
]"
106950864,A,"[
  ""G""
]"
122604225,A,"[
  ""G""
]"
15327427,A,"[
  ""G""
]"
113613492,A,"[
  ""G""
]"
88240258,A,"[
  ""T""
]"
39315583,A,"[
  ""G""
]"
80844410,A,"[
  ""G""
]"
24780345,A,"[
  ""G""
]"
81337065,A,"[
  ""C""
]"
51860866,A,"[
  ""T""
]"
151562062,A,"[
  ""G""
]"
53387701,A,"[
  ""G""
]"
85628160,A,"[
  ""G""
]"
90040658,A,"[
  ""G""
]"
71484790,A,"[
  ""G""
]"
96168527,AT,"[
  ""A""
]"
103833253,CA,"[
  ""C""
]"
94048373,GA,"[
  ""G""
]"
82259613,TC,"[
  ""T""
]"
143504683,TG,"[
  ""T""
]"
9744777,ACT,"[
  ""A""
]"
110909355,TAAAGAAA,"[
  ""T""
]"
122554900,AT,"[
  ""A""
]"
127190536,GT,"[
  ""G""
]"
82818789,TGA,"[
  ""T""
]"
70449960,TACC,"[
  ""T""
]"
89369330,A,"[
  ""G""
]"
38735483,A,"[
  ""G""
]"
85079344,A,"[
  ""C""
]"
32715262,A,"[
  ""G""
]"
123919933,A,"[
  ""G""
]"
123863864,A,"[
  ""G""
]"
120660196,A,"[
  ""G""
]"
103285400,A,"[
  ""T""
]"
80917954,A,"[
  ""C""
]"
115889728,A,"[
  ""C""
]"
146570477,A,"[
  ""G""
]"
128558157,A,"[
  ""T""
]"
49793833,A,"[
  ""G""
]"
19770540,A,"[
  ""T""
]"
140056997,A,"[
  ""G""
]"
37011533,A,"[
  ""G""
]"
Query:
-- 6. Retrieve variants where both reference and alternate bases are single nucleotides (SNPs)
SELECT "start", "reference_bases", "alternate_bases"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."alternate_bases") ab
WHERE "reference_name" = 'X'
  AND LENGTH("reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND "start" NOT BETWEEN 60000 AND 2699519
  AND "start" NOT BETWEEN 154931042 AND 155260559
LIMIT 100
Answer:
start,reference_bases,alternate_bases
89369330,A,"[
  ""G""
]"
38735483,A,"[
  ""G""
]"
85079344,A,"[
  ""C""
]"
32715262,A,"[
  ""G""
]"
123919933,A,"[
  ""G""
]"
123863864,A,"[
  ""G""
]"
120660196,A,"[
  ""G""
]"
103285400,A,"[
  ""T""
]"
80917954,A,"[
  ""C""
]"
115889728,A,"[
  ""C""
]"
146570477,A,"[
  ""G""
]"
128558157,A,"[
  ""T""
]"
49793833,A,"[
  ""G""
]"
19770540,A,"[
  ""T""
]"
140056997,A,"[
  ""G""
]"
37011533,A,"[
  ""G""
]"
67635671,C,"[
  ""T""
]"
77094817,C,"[
  ""A""
]"
30923086,C,"[
  ""T""
]"
119253941,C,"[
  ""T""
]"
80949020,C,"[
  ""T""
]"
73871856,C,"[
  ""T""
]"
9432411,C,"[
  ""T""
]"
66401732,G,"[
  ""T""
]"
137348579,G,"[
  ""C""
]"
16418342,G,"[
  ""A""
]"
3058602,G,"[
  ""A""
]"
9584581,G,"[
  ""T""
]"
106420793,G,"[
  ""A""
]"
99055585,G,"[
  ""A""
]"
84099954,G,"[
  ""T""
]"
115185311,G,"[
  ""T""
]"
14813174,G,"[
  ""A""
]"
145629361,G,"[
  ""T""
]"
54050018,G,"[
  ""A""
]"
88853999,G,"[
  ""A""
]"
83254708,G,"[
  ""C""
]"
22026398,G,"[
  ""T""
]"
64094215,G,"[
  ""A""
]"
27798171,G,"[
  ""A""
]"
71834055,G,"[
  ""A""
]"
76405301,G,"[
  ""A""
]"
83162940,G,"[
  ""A""
]"
89149792,G,"[
  ""C""
]"
9972938,G,"[
  ""T""
]"
97707229,G,"[
  ""A""
]"
83873129,G,"[
  ""A""
]"
10083391,G,"[
  ""C""
]"
105960612,A,"[
  ""T""
]"
97675035,A,"[
  ""C""
]"
49697074,A,"[
  ""T""
]"
34719147,A,"[
  ""G""
]"
95804105,A,"[
  ""G""
]"
31472969,A,"[
  ""C""
]"
5638579,A,"[
  ""G""
]"
118700353,A,"[
  ""C""
]"
141661662,A,"[
  ""G""
]"
30740065,A,"[
  ""G""
]"
4137364,A,"[
  ""G""
]"
79596281,A,"[
  ""G""
]"
101433486,A,"[
  ""G""
]"
14776105,A,"[
  ""G""
]"
48152279,A,"[
  ""T""
]"
77527471,A,"[
  ""G""
]"
113925250,A,"[
  ""T""
]"
47278385,A,"[
  ""G""
]"
57334810,A,"[
  ""G""
]"
121114762,A,"[
  ""T""
]"
147989725,A,"[
  ""G""
]"
132216405,A,"[
  ""G""
]"
153392639,A,"[
  ""G""
]"
65267331,A,"[
  ""G""
]"
103779641,A,"[
  ""G""
]"
147769373,A,"[
  ""T""
]"
81192168,A,"[
  ""G""
]"
112265715,A,"[
  ""G""
]"
69025169,A,"[
  ""T""
]"
151208338,A,"[
  ""G""
]"
110157204,A,"[
  ""G""
]"
136459422,A,"[
  ""T""
]"
96784102,A,"[
  ""G""
]"
62315793,T,"[
  ""C""
]"
91175296,T,"[
  ""A""
]"
8210009,T,"[
  ""G""
]"
38238323,T,"[
  ""C""
]"
94409028,T,"[
  ""C""
]"
31885372,T,"[
  ""A""
]"
143497438,C,"[
  ""T""
]"
151902628,C,"[
  ""T""
]"
7349351,C,"[
  ""T""
]"
44737071,C,"[
  ""G""
]"
104800585,C,"[
  ""A""
]"
45268052,C,"[
  ""T""
]"
107852101,C,"[
  ""T""
]"
6533097,C,"[
  ""A""
]"
43652126,C,"[
  ""T""
]"
92332821,C,"[
  ""T""
]"
107834308,C,"[
  ""T""
]"
94111707,C,"[
  ""T""
]"
115841870,C,"[
  ""T""
]"
Query:
-- 7. Explore the structure of the "call" column by flattening it
SELECT f.value
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-0"",
  ""call_set_name"": ""HG00261"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.500000000000000e+00,
    -2.100000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-1"",
  ""call_set_name"": ""HG00593"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.500000000000000e+00,
    -2.100000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-2"",
  ""call_set_name"": ""NA12749"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -3.000000000000000e-01,
    -3.200000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-3"",
  ""call_set_name"": ""HG00150"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.500000000000000e+00,
    -2.100000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-4"",
  ""call_set_name"": ""NA19675"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.200000000000000e+00,
    -1.680000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-5"",
  ""call_set_name"": ""NA19651"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.800000000000000e+00,
    -2.520000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-6"",
  ""call_set_name"": ""NA19393"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.260000000000000e+01
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-7"",
  ""call_set_name"": ""NA19207"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.120000000000000e+01
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-8"",
  ""call_set_name"": ""HG00342"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -8.400000000000000e+00
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-9"",
  ""call_set_name"": ""NA12546"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -3.000000000000000e+00
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-10"",
  ""call_set_name"": ""NA12843"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00,
    0.000000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-11"",
  ""call_set_name"": ""NA19063"",
  ""genotype"": [
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00
  ]
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-12"",
  ""call_set_name"": ""NA19713"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -1.200000000000000e+00,
    -1.680000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-13"",
  ""call_set_name"": ""NA20517"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00,
    0.000000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-14"",
  ""call_set_name"": ""NA20533"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    0.000000000000000e+00,
    0.000000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-15"",
  ""call_set_name"": ""HG00534"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -3.000000000000000e-01,
    -4.200000000000000e+00
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": [],
  ""call_set_id"": ""10473108253681171589-16"",
  ""call_set_name"": ""NA12778"",
  ""genotype"": [
    0,
    0
  ],
  ""genotype_likelihood"": [
    0.000000000000000e+00,
    -9.000000000000000e-01,
    -1.260000000000000e+01
  ],
  ""phaseset"": ""*""
}"
"{
  ""DS"": 0.000000000000000e+00,
  ""PL"": []
Query:
-- 8. Extract sample IDs and genotypes from the "call" column
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  f.value:"genotype" AS "genotype"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
LIMIT 100
Answer:
sample_id,genotype
HG00261,"[
  0,
  0
]"
HG00593,"[
  0,
  0
]"
NA12749,"[
  0,
  0
]"
HG00150,"[
  0,
  0
]"
NA19675,"[
  0,
  0
]"
NA19651,"[
  0,
  0
]"
NA19393,"[
  0
]"
NA19207,"[
  0
]"
HG00342,"[
  0
]"
NA12546,"[
  0
]"
NA12843,"[
  0,
  0
]"
NA19063,"[
  0
]"
NA19713,"[
  0,
  0
]"
NA20517,"[
  0,
  0
]"
NA20533,"[
  0,
  0
]"
HG00534,"[
  0,
  0
]"
NA12778,"[
  0,
  0
]"
NA18555,"[
  0,
  0
]"
NA18574,"[
  0,
  0
]"
NA19035,"[
  0
]"
NA19350,"[
  0
]"
NA11831,"[
  0
]"
HG00351,"[
  0
]"
HG00654,"[
  0,
  0
]"
HG00124,"[
  0,
  0
]"
HG00369,"[
  0
]"
NA12872,"[
  0
]"
NA18620,"[
  0
]"
NA19248,"[
  0
]"
NA20299,"[
  0,
  0
]"
HG00108,"[
  0
]"
NA18546,"[
  0
]"
NA19451,"[
  0
]"
HG00584,"[
  0,
  0
]"
HG01070,"[
  0,
  0
]"
NA19434,"[
  0,
  0
]"
NA19449,"[
  0,
  0
]"
NA19720,"[
  0
]"
NA19750,"[
  0
]"
HG00448,"[
  0
]"
NA18641,"[
  0,
  0
]"
NA18988,"[
  0
]"
NA19452,"[
  0
]"
HG01498,"[
  0,
  0
]"
HG01515,"[
  0
]"
NA12340,"[
  0
]"
NA18592,"[
  0,
  0
]"
NA18618,"[
  0,
  0
]"
HG01437,"[
  0
]"
NA18525,"[
  0,
  0
]"
NA19429,"[
  0
]"
HG01171,"[
  0,
  0
]"
NA18582,"[
  0,
  0
]"
NA19346,"[
  0
]"
NA19703,"[
  0
]"
NA12004,"[
  0,
  0
]"
NA19789,"[
  0
]"
HG00190,"[
  0
]"
HG01272,"[
  0,
  0
]"
NA18577,"[
  0,
  0
]"
NA18954,"[
  0,
  0
]"
NA19704,"[
  0,
  0
]"
HG00187,"[
  0
]"
HG00628,"[
  0
]"
HG00634,"[
  0
]"
HG01140,"[
  0,
  0
]"
NA18982,"[
  0
]"
NA20759,"[
  0
]"
HG00284,"[
  0
]"
HG00246,"[
  0
]"
NA12058,"[
  0,
  0
]"
NA19456,"[
  0,
  0
]"
NA20412,"[
  0,
  0
]"
NA20758,"[
  0
]"
HG00344,"[
  0,
  0
]"
NA11992,"[
  0
]"
NA12342,"[
  0
]"
NA19403,"[
  0,
  0
]"
HG00243,"[
  0
]"
NA07056,"[
  0,
  0
]"
NA19065,"[
  0,
  0
]"
NA19921,"[
  0,
  0
]"
HG00104,"[
  0,
  0
]"
NA18560,"[
  0,
  0
]"
NA18615,"[
  0,
  0
]"
HG00476,"[
  0,
  0
]"
NA12761,"[
  0,
  0
]"
NA19099,"[
  0,
  0
]"
NA19313,"[
  0,
  0
]"
NA19471,"[
  0,
  0
]"
NA19723,"[
  0
]"
NA19777,"[
  0
]"
HG00557,"[
  0,
  0
]"
NA19430,"[
  0
]"
NA19758,"[
  0,
  0
]"
NA19780,"[
  0
]"
NA19328,"[
  0,
  0
]"
NA12044,"[
  0,
  0
]"
NA19436,"[
  0,
  0
]"
NA19684,"[
  0,
  0
]"
Query:
SELECT
  sample_id,
  SUM(homo_ref) AS homozygous_reference_alleles,
  SUM(homo_alt) AS homozygous_alternate_alleles,
  SUM(het_alt) AS heterozygous_alternate_alleles,
  COUNT(*) AS total_callable_sites,
  SUM(homo_alt + het_alt) AS total_SNVs,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN (SUM(het_alt) / SUM(homo_alt + het_alt)) * 100
    ELSE 0
  END AS percentage_heterozygous_alternate_alleles,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN (SUM(homo_alt) / SUM(homo_alt + het_alt)) * 100
    ELSE 0
  END AS percentage_homozygous_alternate_alleles
FROM (
  SELECT
    f.value:"call_set_name"::STRING AS sample_id,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_ref,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1] THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_alt,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] != f.value:"genotype"[1] AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL THEN 1
          ELSE 0
        END
      ELSE 0
    END AS het_alt
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
) sub
GROUP BY sample_id;
Answer:
Too long, hard cut:
SAMPLE_ID,HOMOZYGOUS_REFERENCE_ALLELES,HOMOZYGOUS_ALTERNATE_ALLELES,HETEROZYGOUS_ALTERNATE_ALLELES,TOTAL_CALLABLE_SITES,TOTAL_SNVS,PERCENTAGE_HETEROZYGOUS_ALTERNATE_ALLELES,PERCENTAGE_HOMOZYGOUS_ALTERNATE_ALLELES
HG00351,1185,78,0,1263,78,0.000000,100.000000
NA19834,1173,90,0,1263,90,0.000000,100.000000
NA19087,1154,56,53,1263,109,48.623900,51.376100
NA18910,1157,106,0,1263,106,0.000000,100.000000
HG01148,1180,83,0,1263,83,0.000000,100.000000
HG00428,1150,51,62,1263,113,54.867300,45.132700
HG00640,1186,77,0,1263,77,0.000000,100.000000
NA20543,1193,70,0,1263,70,0.000000,100.000000
HG00110,1161,45,57,1263,102,55.882400,44.117600
NA18498,1158,105,0,1263,105,0.000000,100.000000
NA19080,1157,44,62,1263,106,58.490600,41.509400
NA19738,1178,85,0,1263,85,0.000000,100.000000
HG01174,1147,42,74,1263,116,63.793100,36.206900
NA12275,1161,42,60,1263,102,58.823500,41.176500
NA19434,1108,53,102,1263,155,65.806500,34.193500
NA20322,1112,49,102,1263,151,67.549700,32.450300
NA18561,1175,88,0,1263,88,0.000000,100.000000
NA18995,1197,66,0,1263,66,0.000000,100.000000
NA19719,1147,42,74,1263,116,63.793100,36.206900
HG01102,1152,44,67,1263,111,60.360400,39.639600
HG00183,1185,78,0,1263,78,0.000000,100.000000
NA20752,1186,77,0,1263,77,0.000000,100.000000
NA18567,1145,53,65,1263,118,55.084700,44.915300
NA19917,1100,61,102,1263,163,62.576700,37.423300
HG00650,1174,89,0,1263,89,0.000000,100.000000
NA18606,1191,72,0,1263,72,0.000000,100.000000
NA19391,1128,54,81,1263,135,60.000000,40.000000
NA20336,1119,44,100,1263,144,69.444400,30.555600
NA20755,1188,75,0,1263,75,0.000000,100.000000
NA19403,1120,51,92,1263,143,64.335700,35.664300
HG00557,1159,54,50,1263,104,48.076900,51.923100
NA20278,1156,107,0,1263,107,0.000000,100.000000
NA20522,1152,39,72,1263,111,64.864900,35.135100
NA19399,1099,62,102,1263,164,62.195100,37.804900
HG00705,1154,50,59,1263,109,54.128400,45.871600
NA19036,1114,57,92,1263,149,61.745000,38.255000
NA18868,1161,102,0,1263,102,0.000000,100.000000
NA18978,1159,37,67,1263,104,64.423100,35.576900
NA19377,1098,59,106,1263,165,64.242400,35.757600
NA11932,1193,70,0,1263,70,0.000000,100.000000
HG01491,1192,71,0,1263,71,0.000000,100.000000
NA11829,1197,66,0,1263,66,0.000000,100.000000
NA12347,1193,70,0,1263,70,0.000000,100.000000
HG00306,1164,36,63,1263,99,63.636400,36.363600
NA20503,1155,43,65,1263,108,60.185200,39.814800
NA18555,1144,52,67,1263,119,56.302500,43.697500
NA19720,1171,92,0,1263,92,0.000000,100.000000
NA19789,1171,92,0,1263,92,0.000000,100.000000
NA19740,1148,47,68,1263,115,59.130400,40.869600
NA19762,1186,77,0,1263,77,0.000000,100.000000
HG00451,1178,85,0,1263,85,0.000000,100.000000
NA19316,1094,55,114,1263,169,67.455600,32.544400
HG00358,1195,68,0,1263,68,0.000000,100.000000
NA20512,1192,71,0,1263,71,0.000000,100.000000
NA19682,1186,77,0,1263,77,0.000000,100.000000
HG01461,1172,91,0,1263,91,0.000000,100.000000
HG01108,1126,58,79,1263,137,57.664200,42.335800
NA18642,1162,43,58,1263,101,57.425700,42.574300
NA18946,1149,53,61,1263,114,53.508800,46.491200
NA18614,1147,57,59,1263,116,50.862100,49.137900
HG00345,1179,84,0,1263,84,0.000000,100.000000
HG00262,1171,45,47,1263,92,51.087000,48.913000
HG00446,1152,48,63,1263,111,56.756800,43.243200
HG00736,1195,68,0,1263,68,0.000000,100.000000
HG01107,1179,84,0,1263,84,0.000000,100.000000
HG00578,1141,45,77,1263,122,63.114800,36.885200
NA12716,1193,70,0,1263,70,0.000000,100.000000
NA18574,1149,51,63,1263,114,55.263200,44.736800
NA18945,1192,71,0,1263,71,0.000000,100.000000
NA18923,1157,106,0,1263,106,0.000000,100.000000
NA19185,1112,44,107,1263,151,70.860900,29.139100
NA20513,1191,72,0,1263,72,0.000000,100.000000
NA19785,1152,42,69,1263,111,62.162200,37.837800
HG00247,1145,43,75,1263,118,63.559300,36.440700
NA19310,1109,52,102,1263,154,66.233800,33.766200
NA19786,1185,78,0,1263,78,0.000000,100.000000
NA18908,1148,115,0,1263,115,0.000000,100.000000
NA20528,1185,78,0,1263,78,0.000000,100.000000
HG01124,1184,79,0,1263,79,0.000000,100.000000
HG01113,1160,40,63,1263,103,61.165000,38.835000
NA18602,1149,49,65,1263,114,57.017500,42.982500
HG00663,1158,54,51,1263,105,48.571400,51.428600
HG01095,1138,35,90,1263,125,72.000000,28.000000
NA12546,1187,76,0,1263,76,0.000000,100.000000
HG00312,1186,77,0,1263,77,0.000000,100.000000
NA20802,1149,34,80,1263,114,70.175400,29.824600
NA18610,1160,45,58,1263,103,56.310700,43.689300
NA20812,1188,75,0,1263,75,0.000000,100.000000
HG01488,1190,73,0,1263,73,0.000000,100.000000
NA18623,1179,84,0,1263,84,0.000000,100.000000
NA20317,1099,50,114,1263,164,69.512200,30.487800
NA12249,1170,48,45,1263,93,48.387100,51.612900
HG00121,1163,44,56,1263,100,56.000000,44.000000
NA19734,1155,53,55,1263,108,50.925900,49.074100
HG00111,1163,41,59,1263,100,59.000000,41.000000
NA18550,1154,54,55,1263,109,50.458700,49.541300
HG00382,1191,72,0,1263,72,0.000000,100.000000
HG01516,1157,48,58,1263,106,54.717000,45.283000
NA06989,1159,45,59,1263,104,56.730800,43.269200
HG00362,1175,43,45,1263,88,51.136400,48.863600
NA10847,1159,41,63,1263,104,60.576900,39.423100
NA18745,1180,
Query:
-- 10. Get counts of different genotype types per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 1 THEN f.value:"genotype"[0] ELSE NULL END AS "allele1",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 2 THEN f.value:"genotype"[1] ELSE NULL END AS "allele2",
  COUNT(*) AS "count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id", "allele1", "allele2"
ORDER BY "sample_id", "count" DESC
LIMIT 100
Answer:
sample_id,allele1,allele2,count
HG00096,0,,1228
HG00096,1,,86
HG00097,0,0,1196
HG00097,1,1,45
HG00097,1,0,40
HG00097,0,1,33
HG00099,0,0,1209
HG00099,1,1,54
HG00099,1,0,32
HG00099,0,1,19
HG00100,0,0,1206
HG00100,1,1,49
HG00100,0,1,35
HG00100,1,0,24
HG00101,0,,1233
HG00101,1,,81
HG00102,0,0,1207
HG00102,1,1,42
HG00102,1,0,34
HG00102,0,1,31
HG00103,0,,1224
HG00103,1,,90
HG00104,0,0,1203
HG00104,1,0,39
HG00104,0,1,36
HG00104,1,1,36
HG00106,0,0,1190
HG00106,1,1,50
HG00106,0,1,40
HG00106,1,0,34
HG00108,0,,1230
HG00108,1,,84
HG00109,0,,1234
HG00109,1,,80
HG00110,0,0,1201
HG00110,1,1,49
HG00110,1,0,43
HG00110,0,1,21
HG00111,0,0,1206
HG00111,1,1,45
HG00111,0,1,32
HG00111,1,0,31
HG00112,0,,1229
HG00112,1,,85
HG00113,0,,1237
HG00113,1,,77
HG00114,0,,1223
HG00114,1,,91
HG00116,0,,1231
HG00116,1,,83
HG00117,0,,1233
HG00117,1,,81
HG00118,0,0,1201
HG00118,1,1,49
HG00118,0,1,36
HG00118,1,0,28
HG00119,0,,1232
HG00119,1,,82
HG00120,0,0,1203
HG00120,1,1,49
HG00120,0,1,34
HG00120,1,0,28
HG00121,0,0,1206
HG00121,1,1,48
HG00121,1,0,33
HG00121,0,1,27
HG00122,0,0,1199
HG00122,1,1,45
HG00122,0,1,39
HG00122,1,0,31
HG00123,0,0,1200
HG00123,1,1,49
HG00123,1,0,35
HG00123,0,1,30
HG00124,0,0,1196
HG00124,1,1,55
HG00124,0,1,36
HG00124,1,0,27
HG00125,0,0,1194
HG00125,1,1,47
HG00125,1,0,43
HG00125,0,1,30
HG00126,0,,1227
HG00126,1,,87
HG00127,0,0,1189
HG00127,1,1,56
HG00127,0,1,35
HG00127,1,0,34
HG00128,0,0,1203
HG00128,1,1,46
HG00128,0,1,35
HG00128,1,0,30
HG00129,0,,1231
HG00129,1,,83
HG00130,0,0,1202
HG00130,1,1,46
HG00130,0,1,34
HG00130,1,0,32
HG00131,0,,1238
HG00131,1,,76
Query:
-- 11. List samples with their total number of callable sites
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_callable_sites"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND f.value:"genotype" IS NOT NULL
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,total_callable_sites
NA19675,1314
NA19207,1314
NA18546,1314
NA18959,1314
HG00449,1314
HG00524,1314
HG01342,1314
NA07048,1314
NA20296,1314
NA18543,1314
HG00378,1314
NA19434,1314
NA20322,1314
NA18561,1314
NA18995,1314
NA19719,1314
HG01102,1314
HG00183,1314
NA20752,1314
NA18567,1314
NA19917,1314
NA20336,1314
NA20755,1314
HG00650,1314
NA18606,1314
NA19391,1314
NA18574,1314
NA18945,1314
NA18923,1314
NA20513,1314
NA19785,1314
HG00247,1314
NA19786,1314
NA18908,1314
NA20528,1314
HG01124,1314
NA18602,1314
HG00663,1314
HG01095,1314
NA19185,1314
NA19310,1314
HG01113,1314
HG00351,1314
NA19834,1314
NA19087,1314
NA18910,1314
HG01148,1314
HG00428,1314
HG00640,1314
NA20543,1314
HG00110,1314
NA18498,1314
NA19080,1314
NA19738,1314
HG01174,1314
NA12275,1314
NA12546,1314
HG00312,1314
NA20802,1314
NA18610,1314
NA20812,1314
NA20317,1314
NA12249,1314
HG00382,1314
HG00121,1314
NA19734,1314
HG00111,1314
NA18550,1314
HG01516,1314
HG01488,1314
NA18623,1314
NA19403,1314
HG00557,1314
NA20278,1314
NA20522,1314
NA19399,1314
HG00705,1314
HG00306,1314
NA19036,1314
NA18868,1314
NA18978,1314
NA11932,1314
NA19377,1314
HG01491,1314
NA11829,1314
NA12347,1314
NA20503,1314
HG00124,1314
HG00350,1314
NA19307,1314
HG00614,1314
NA20828,1314
NA19093,1314
NA11995,1314
NA19783,1314
NA18505,1314
HG00331,1314
HG00339,1314
NA20753,1314
NA18963,1314
Query:
-- 12. Identify heterozygous genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "heterozygous_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND ARRAY_SIZE(f.value:"genotype") = 2
  AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL
  AND f.value:"genotype"[0] != f.value:"genotype"[1]
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,heterozygous_count
HG00110,64
NA12275,66
NA19080,70
HG01174,78
NA19087,61
HG00428,70
NA19403,97
NA20522,79
HG00306,69
NA19036,97
NA19377,116
NA19399,108
NA20503,69
NA18978,73
HG00705,64
HG00557,55
NA19185,115
NA19310,109
NA19785,75
HG00247,82
NA18574,69
HG01113,68
HG01095,99
NA18602,73
HG00663,57
NA19675,75
NA20296,113
HG00449,68
HG01342,120
HG00378,66
NA18867,123
NA18565,64
HG01171,84
NA19660,74
NA18627,58
NA12778,77
NA11993,76
HG00125,73
HG00353,65
NA18858,116
HG00268,61
HG01168,67
NA20773,66
HG01251,80
NA19064,54
NA20506,16
HG00690,70
NA12749,72
HG01188,107
HG00383,59
NA20541,74
HG00266,62
HG00231,70
NA11933,62
HG00346,59
NA18951,80
HG01149,68
NA18912,100
HG00235,78
HG00130,66
HG00276,69
NA19731,58
NA19463,127
NA19172,116
NA19776,78
NA20800,69
NA19712,120
HG01456,65
NA18949,57
NA19077,64
NA19332,12
NA20357,118
NA18924,98
NA12830,74
HG00272,74
NA19456,113
HG00699,61
NA20774,63
HG00479,61
HG00179,58
NA19355,115
NA20287,105
NA12004,70
HG00120,62
NA19681,91
NA18999,65
NA18630,73
NA12717,71
HG00437,75
HG00531,55
NA18597,56
HG00343,59
NA18626,68
NA20761,69
HG01351,71
HG00693,65
NA12815,64
NA19737,61
HG00106,74
HG01492,86
Query:
-- 13. Compute total SNVs per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_SNVs"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f,
  LATERAL FLATTEN(input => t."alternate_bases") ab
WHERE t."reference_name" = 'X'
  AND LENGTH(t."reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,total_SNVs
HG00428,113
HG00351,78
NA19834,90
HG01148,83
HG00110,102
NA18498,105
HG00640,77
NA12275,102
NA19087,109
NA19080,106
NA19738,85
NA20543,70
HG01174,116
NA18910,106
NA18923,106
NA19185,151
NA19310,154
NA18908,115
NA18574,114
HG00247,118
HG01124,79
NA18602,114
NA20528,78
HG01113,103
HG01095,125
NA19785,111
HG00663,105
NA19786,78
NA20513,72
NA18945,71
NA19434,155
HG01102,111
NA18567,118
NA20336,144
NA19917,163
HG00183,78
NA20752,77
NA20322,151
NA20755,75
HG00650,89
NA19391,135
NA19719,116
NA18995,66
NA18561,88
NA18606,72
NA20802,114
NA20317,164
NA12249,93
HG00312,77
NA20812,75
HG01488,73
HG00382,72
HG00121,100
NA18550,109
HG01516,106
NA18623,84
NA19734,108
NA12546,76
NA18610,103
HG00111,100
HG01171,119
NA19660,115
HG00553,91
NA18867,157
NA20281,102
HG00338,72
NA19982,113
NA20356,94
HG00335,69
NA18565,103
NA18627,101
NA18544,91
HG00556,91
NA18548,86
NA18983,81
NA19067,76
HG00101,76
NA19776,117
NA20800,103
NA19712,158
HG01456,114
NA19332,115
NA19172,161
NA19463,170
NA19077,112
NA20815,74
HG00139,69
NA18949,98
NA19732,78
HG00109,73
NA12763,114
NA18871,103
NA18593,113
NA19315,163
NA19020,88
NA19379,160
NA12761,101
NA20588,73
HG01620,110
NA19661,84
Query:
-- 14. List homozygous alternate genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "homozygous_alternate_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
  LATERAL FLATTEN(input => t."call") f
WHERE t."reference_name" = 'X'
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1]) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,homozygous_alternate_count
NA18910,120
NA19834,98
NA18498,113
HG01148,93
NA19738,93
NA19087,61
HG00428,55
HG00640,83
NA20543,76
NA19080,48
HG01174,46
HG00110,49
HG00351,84
NA12275,46
NA18908,128
NA18923,118
NA19185,50
NA19310,57
NA19785,46
NA20528,85
HG01124,88
HG00247,48
NA20513,77
NA19786,87
HG01113,46
NA18945,77
NA18602,57
NA18574,56
HG00663,59
HG01095,40
NA19207,119
NA20296,57
NA18546,93
HG00524,97
NA19675,45
NA18959,85
HG01342,50
NA07048,77
NA18543,87
HG00449,56
HG00378,44
NA19434,60
NA20322,59
NA19917,67
NA20336,49
NA19391,57
NA18561,95
NA19719,48
NA20752,84
HG00183,85
NA18995,75
HG01102,48
NA18567,60
NA20755,82
HG00650,95
NA18606,77
NA19403,59
NA20278,117
NA19399,70
NA19036,63
NA18868,111
NA19377,67
NA11829,74
NA11932,77
HG01491,78
HG00557,60
NA20522,43
HG00705,53
NA18978,41
NA12347,76
HG00306,40
NA20503,46
NA19904,108
NA19452,97
NA20126,114
NA18520,64
NA20344,57
NA18499,59
NA20127,46
HG00436,93
NA11894,51
NA19758,48
NA12718,53
NA20775,47
HG00657,56
NA18605,99
HG00261,51
NA20786,46
NA19375,124
NA19723,87
NA20761,48
NA19076,82
NA12815,43
HG00693,52
HG01389,79
HG01351,48
NA20805,82
NA19346,128
NA19923,42
NA19138,101
Query:
SELECT 
  "sample_id",
  ("heterozygous_count" / NULLIF("total_SNVs", 0)) * 100 AS "percentage_heterozygous"
FROM (
  SELECT 
    f.value:"call_set_name"::STRING AS "sample_id",
    SUM(CASE 
          WHEN ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] != f.value:"genotype"[1] THEN 1 
          ELSE 0 
        END) AS "heterozygous_count",
    SUM(CASE 
          WHEN (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR 
               (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0) THEN 1 
          ELSE 0 
        END) AS "total_SNVs"
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
  GROUP BY "sample_id"
) sub
LIMIT 100;
Answer:
sample_id,percentage_heterozygous
NA19434,65.806500
NA20322,67.549700
NA18561,0.000000
NA18995,0.000000
NA19719,63.793100
HG01102,60.360400
HG00183,0.000000
NA20752,0.000000
NA18567,55.084700
NA19917,62.576700
HG00650,0.000000
NA18606,0.000000
NA19391,60.000000
NA20336,69.444400
NA20755,0.000000
NA20819,62.608700
NA19318,0.000000
HG01521,0.000000
NA18942,49.557500
HG01082,0.000000
NA19235,69.182400
HG00445,0.000000
HG00160,0.000000
NA12045,0.000000
NA20517,56.363600
NA18977,0.000000
HG00500,0.000000
HG00128,58.000000
NA20792,0.000000
HG00464,55.172400
NA19468,64.625900
HG00458,53.921600
NA19676,0.000000
NA19657,55.454500
NA12489,54.368900
NA19059,51.818200
NA19317,0.000000
NA18564,51.376100
HG00275,57.943900
HG01051,0.000000
NA20334,66.438400
HG00124,54.205600
HG00350,55.319100
NA19307,0.000000
HG00614,50.442500
NA20828,55.963300
NA19093,64.102600
NA11995,55.000000
NA19783,0.000000
NA18505,67.664700
HG00339,61.764700
NA20753,51.818200
NA18963,48.543700
NA19701,72.142900
HG00331,50.526300
NA19063,0.000000
NA20757,51.456300
NA11931,58.653800
NA11930,0.000000
HG00478,0.000000
NA18516,0.000000
NA20536,0.000000
NA19331,0.000000
HG00257,55.140200
HG00254,59.000000
NA18535,55.855900
NA18984,0.000000
NA19060,0.000000
NA20524,0.000000
NA12043,0.000000
HG00174,59.482800
HG01069,0.000000
NA11830,51.041700
HG00131,0.000000
HG00129,0.000000
HG00320,58.653800
HG00376,58.415800
NA18974,0.000000
NA19117,0.000000
HG01623,58.490600
NA11994,0.000000
NA19222,68.553500
NA19197,65.217400
HG00096,0.000000
NA19747,0.000000
NA20298,0.000000
NA20516,0.000000
NA19038,71.604900
NA20754,0.000000
NA18603,0.000000
NA20816,0.000000
NA18861,62.987000
NA18534,0.000000
NA19770,63.392900
NA11892,61.165000
NA11831,0.000000
HG00448,0.000000
NA12004,56.756800
HG00437,55.263200
NA19355,69.871800
Query:
-- 10. Get counts of different genotype types per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 1 THEN f.value:"genotype"[0] ELSE NULL END AS "allele1",
  CASE WHEN ARRAY_SIZE(f.value:"genotype") >= 2 THEN f.value:"genotype"[1] ELSE NULL END AS "allele2",
  COUNT(*) AS "count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id", "allele1", "allele2"
ORDER BY "sample_id", "count" DESC
LIMIT 100
Answer:
sample_id,allele1,allele2,count
HG00096,0,,1228
HG00096,1,,86
HG00097,0,0,1196
HG00097,1,1,45
HG00097,1,0,40
HG00097,0,1,33
HG00099,0,0,1209
HG00099,1,1,54
HG00099,1,0,32
HG00099,0,1,19
HG00100,0,0,1206
HG00100,1,1,49
HG00100,0,1,35
HG00100,1,0,24
HG00101,0,,1233
HG00101,1,,81
HG00102,0,0,1207
HG00102,1,1,42
HG00102,1,0,34
HG00102,0,1,31
HG00103,0,,1224
HG00103,1,,90
HG00104,0,0,1203
HG00104,1,0,39
HG00104,1,1,36
HG00104,0,1,36
HG00106,0,0,1190
HG00106,1,1,50
HG00106,0,1,40
HG00106,1,0,34
HG00108,0,,1230
HG00108,1,,84
HG00109,0,,1234
HG00109,1,,80
HG00110,0,0,1201
HG00110,1,1,49
HG00110,1,0,43
HG00110,0,1,21
HG00111,0,0,1206
HG00111,1,1,45
HG00111,0,1,32
HG00111,1,0,31
HG00112,0,,1229
HG00112,1,,85
HG00113,0,,1237
HG00113,1,,77
HG00114,0,,1223
HG00114,1,,91
HG00116,0,,1231
HG00116,1,,83
HG00117,0,,1233
HG00117,1,,81
HG00118,0,0,1201
HG00118,1,1,49
HG00118,0,1,36
HG00118,1,0,28
HG00119,0,,1232
HG00119,1,,82
HG00120,0,0,1203
HG00120,1,1,49
HG00120,0,1,34
HG00120,1,0,28
HG00121,0,0,1206
HG00121,1,1,48
HG00121,1,0,33
HG00121,0,1,27
HG00122,0,0,1199
HG00122,1,1,45
HG00122,0,1,39
HG00122,1,0,31
HG00123,0,0,1200
HG00123,1,1,49
HG00123,1,0,35
HG00123,0,1,30
HG00124,0,0,1196
HG00124,1,1,55
HG00124,0,1,36
HG00124,1,0,27
HG00125,0,0,1194
HG00125,1,1,47
HG00125,1,0,43
HG00125,0,1,30
HG00126,0,,1227
HG00126,1,,87
HG00127,0,0,1189
HG00127,1,1,56
HG00127,0,1,35
HG00127,1,0,34
HG00128,0,0,1203
HG00128,1,1,46
HG00128,0,1,35
HG00128,1,0,30
HG00129,0,,1231
HG00129,1,,83
HG00130,0,0,1202
HG00130,1,1,46
HG00130,0,1,34
HG00130,1,0,32
HG00131,0,,1238
HG00131,1,,76
Query:
-- 11. List samples with their total number of callable sites
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_callable_sites"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND f.value:"genotype" IS NOT NULL
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,total_callable_sites
NA12546,1314
HG00312,1314
NA20802,1314
NA18610,1314
NA20812,1314
NA20317,1314
NA12249,1314
HG00382,1314
HG00121,1314
NA19734,1314
HG00111,1314
NA18550,1314
HG01516,1314
HG01488,1314
NA18623,1314
HG00351,1314
NA19834,1314
NA19087,1314
NA18910,1314
HG01148,1314
HG00428,1314
HG00640,1314
NA20543,1314
HG00110,1314
NA18498,1314
NA19080,1314
NA19738,1314
HG01174,1314
NA12275,1314
NA06989,1314
HG00362,1314
NA10847,1314
HG00559,1314
NA18745,1314
HG00596,1314
HG01101,1314
NA12889,1314
NA19753,1314
HG00156,1314
HG00404,1314
HG00236,1314
HG00536,1314
NA19095,1314
HG00112,1314
NA19098,1314
HG00251,1314
NA18526,1314
NA19403,1314
HG00557,1314
NA20278,1314
NA20522,1314
NA19399,1314
HG00705,1314
HG00306,1314
NA19036,1314
NA18868,1314
NA18978,1314
NA11932,1314
NA19377,1314
HG01491,1314
NA11829,1314
NA12347,1314
NA20503,1314
HG00534,1314
NA19065,1314
HG00512,1314
HG00356,1314
NA20504,1314
NA19352,1314
HG00332,1314
NA18966,1314
HG01274,1314
NA18612,1314
HG00263,1314
NA18633,1314
HG00359,1314
HG00141,1314
NA19247,1314
NA19436,1314
HG01066,1314
NA12272,1314
NA20521,1314
NA20801,1314
NA18553,1314
HG00180,1314
HG01617,1314
HG00525,1314
NA19444,1314
NA19385,1314
NA19457,1314
NA20804,1314
NA18487,1314
NA19223,1314
NA07347,1314
NA18980,1314
NA19055,1314
NA20339,1314
NA18961,1314
HG01137,1314
NA19434,1314
Query:
-- 12. Identify heterozygous genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "heterozygous_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND ARRAY_SIZE(f.value:"genotype") = 2
  AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL
  AND f.value:"genotype"[0] != f.value:"genotype"[1]
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,heterozygous_count
NA18614,65
NA19316,120
HG01108,83
NA18642,67
NA18555,76
NA18946,70
HG00446,70
HG00578,81
HG00262,58
NA19740,72
NA19087,61
HG00110,64
NA19080,70
NA12275,66
HG00428,70
HG01174,78
NA18567,69
NA19434,109
NA20336,113
NA19391,93
HG01102,72
NA19917,107
NA19719,82
NA20322,107
NA19675,75
NA20296,113
HG00449,68
HG01342,120
HG00378,66
NA18909,101
NA19204,112
NA19435,104
NA20585,68
HG00258,66
HG00593,66
HG00638,84
NA18617,67
HG00330,71
HG00590,69
NA18528,57
NA20504,70
HG00263,65
NA19247,99
HG00356,74
HG00359,70
HG00332,63
HG00534,56
NA19065,68
NA12749,72
HG01149,68
NA20541,74
HG01188,107
NA18951,80
HG00266,62
NA11933,62
HG00383,59
HG00690,70
HG00231,70
HG00346,59
NA20808,68
NA19470,116
NA19921,110
NA19440,102
NA18545,64
NA19728,60
HG01551,100
NA19328,112
NA18939,65
HG00240,67
NA20813,64
NA18525,60
NA18595,66
NA20282,100
NA19149,124
HG00654,55
NA18640,68
HG01618,72
HG00158,60
NA19190,111
NA12763,86
HG01198,83
NA19315,113
NA18593,63
NA12761,61
HG01384,87
HG01620,75
HG01441,70
NA18998,66
NA19379,124
NA18968,56
HG00171,73
NA18552,65
HG00684,79
NA19752,64
NA12873,68
HG00381,60
NA19114,120
NA18907,117
NA19835,119
HG00239,61
Query:
-- 13. Compute total SNVs per sample
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "total_SNVs"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f,
  LATERAL FLATTEN(input => t."alternate_bases") AS ab
WHERE t."reference_name" = 'X'
  AND LENGTH(t."reference_bases") = 1
  AND LENGTH(ab.value::STRING) = 1
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND (f.value:"genotype"[0] > 0 OR f.value:"genotype"[1] > 0)) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,total_SNVs
HG00428,113
HG00351,78
NA19834,90
HG01148,83
HG00110,102
NA18498,105
HG00640,77
NA12275,102
NA19087,109
NA19080,106
NA20543,70
NA19738,85
HG01174,116
NA18910,106
HG00156,77
HG00236,112
HG00112,78
NA19098,101
HG00559,80
NA06989,104
HG00362,88
NA10847,104
NA12889,66
HG00404,104
HG00536,75
HG00251,81
NA18526,107
HG00596,115
HG01101,81
NA19095,144
NA18745,83
NA19753,80
NA19403,143
NA20522,111
HG00306,99
NA19036,149
NA19377,165
NA20503,108
NA19399,164
NA11932,70
HG00557,104
NA18868,102
NA20278,107
HG00705,109
NA12347,70
HG01491,71
NA18978,104
NA11829,66
HG01488,73
NA20317,164
HG00121,100
NA20812,75
NA18623,84
NA12249,93
NA20802,114
HG00382,72
NA19734,108
NA12546,76
NA18610,103
HG00111,100
NA18550,109
HG01516,106
HG00312,77
NA20761,107
HG01351,109
NA19375,114
NA19723,76
HG00693,105
HG01389,72
NA19076,73
NA12815,98
NA20805,75
NA18917,100
HG01170,90
NA12777,77
NA19371,101
NA18962,72
NA18909,154
NA20585,114
NA19204,159
NA19435,156
HG01518,79
HG00258,97
NA20525,72
HG00593,106
HG01625,79
HG00638,123
NA18617,108
NA18986,79
HG00590,111
HG00330,101
HG00375,84
NA12748,80
NA18528,106
HG00148,69
HG00113,71
NA19651,109
NA19096,98
NA20796,84
NA20769,95
Query:
-- 14. List homozygous alternate genotypes for samples
SELECT 
  f.value:"call_set_name"::STRING AS "sample_id",
  COUNT(*) AS "homozygous_alternate_count"
FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" AS t,
  LATERAL FLATTEN(input => t."call") AS f
WHERE t."reference_name" = 'X'
  AND (
    (ARRAY_SIZE(f.value:"genotype") = 2 AND f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1]) OR
    (ARRAY_SIZE(f.value:"genotype") = 1 AND f.value:"genotype"[0] > 0)
  )
  AND t."start" NOT BETWEEN 60000 AND 2699519
  AND t."start" NOT BETWEEN 154931042 AND 155260559
GROUP BY "sample_id"
LIMIT 100
Answer:
sample_id,homozygous_alternate_count
NA19207,119
NA19675,45
NA07048,77
NA18543,87
NA18546,93
NA18959,85
HG00524,97
HG01342,50
NA20296,57
HG00449,56
HG00378,44
NA18908,128
NA18923,118
HG00247,48
NA20528,85
NA20513,77
NA19785,46
NA19786,87
HG01124,88
HG01113,46
NA18945,77
NA18602,57
NA19185,50
NA19310,57
NA18574,56
HG00663,59
HG01095,40
NA18910,120
HG00351,84
NA19834,98
HG01148,93
NA18498,113
HG00640,83
NA19087,61
NA19738,93
HG00428,55
NA20543,76
NA19080,48
HG01174,46
HG00110,49
NA12275,46
NA19028,112
NA19119,117
NA18912,68
NA19756,96
HG00421,87
NA18943,76
HG00565,89
HG00235,35
HG00130,46
NA18940,93
HG00186,78
NA19731,57
HG00276,44
HG00500,91
NA20334,54
NA19317,107
NA19468,62
HG01051,113
HG00128,46
NA18977,93
HG00464,58
NA19676,95
NA20792,77
HG00458,52
NA19657,52
NA12489,50
NA19059,58
HG00275,50
NA20517,52
NA18564,57
NA19171,126
NA19041,121
HG00244,88
NA18858,59
NA12778,47
NA12282,80
NA20506,74
NA20770,80
NA18562,92
HG00457,79
HG00325,82
HG01136,90
NA18609,93
HG00140,86
HG01251,43
HG00125,47
NA19064,59
NA12872,71
HG01168,43
HG00268,43
HG00353,47
NA11993,39
NA20773,41
NA19711,105
NA18934,131
NA19467,63
HG00613,92
NA18916,60
NA20518,81
End Exploring Related Columns
Task: Extract genotype data for single nucleotide polymorphisms (SNPs) from chromosome X , ensuring that the start positions are not between 59999 and 2699519 nor between 154931042 and 155260559.   Output the sample ID, counts of homozygous reference alleles, homozygous alternate alleles, heterozygous alternate alleles, the total number of callable sites, the total number of SNVs,  the percentage of heterozygous alternate alleles among all SNVs, and the percentage of homozygous alternate alleles among all SNVs.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To extract the genotype data for single nucleotide polymorphisms (SNPs) from chromosome X, excluding the specified regions, we would compile the counts and percentages for each sample as follows:

```csv
sample_id,homozygous_reference_alleles,homozygous_alternate_alleles,heterozygous_alternate_alleles,total_callable_sites,total_SNVs,percentage_heterozygous_alternate_alleles,percentage_homozygous_alternate_alleles
sample_id1:str,count1:int,count2:int,count3:int,total_sites1:int,total_snvs1:int,percentage1:float (0<=float<=100),percentage2:float (0<=float<=100)
sample_id2:str,count1:int,count2:int,count3:int,total_sites2:int,total_snvs2:int,percentage1:float (0<=float<=100),percentage2:float (0<=float<=100)
...
```

- **sample_id**: The identifier for each sample (string).
- **homozygous_reference_alleles**: Count of sites where the sample has homozygous reference alleles (integer).
- **homozygous_alternate_alleles**: Count of sites where the sample has homozygous alternate alleles (integer).
- **heterozygous_alternate_alleles**: Count of sites where the sample has heterozygous alternate alleles (integer).
- **total_callable_sites**: Total number of sites that are callable (integer).
- **total_SNVs**: Total number of single nucleotide variants (SNVs) observed in the sample (integer).
- **percentage_heterozygous_alternate_alleles**: Percentage of heterozygous alternate alleles among all SNVs (float between 0 and 100).
- **percentage_homozygous_alternate_alleles**: Percentage of homozygous alternate alleles among all SNVs (float between 0 and 100).

This format provides a clear and concise representation of the genotype data per sample, adhering to the specified requirements..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'_1000_GENOMES': {'_1000_GENOMES': ['PEDIGREE', 'SAMPLE_INFO', 'VARIANTS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 06:32:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:32:25 - root - INFO - To extract the genotype data for single nucleotide polymorphisms (SNPs) from chromosome X, excluding the specified regions, and compute the per-sample counts and percentages, you can use the following SQL query:

```sql
SELECT
  sample_id,
  SUM(homo_ref) AS homozygous_reference_alleles,
  SUM(homo_alt) AS homozygous_alternate_alleles,
  SUM(het_alt) AS heterozygous_alternate_alleles,
  COUNT(*) AS total_callable_sites,
  SUM(homo_alt + het_alt) AS total_SNVs,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN ROUND((SUM(het_alt) / SUM(homo_alt + het_alt)) * 100, 4)
    ELSE 0
  END AS percentage_heterozygous_alternate_alleles,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN ROUND((SUM(homo_alt) / SUM(homo_alt + het_alt)) * 100, 4)
    ELSE 0
  END AS percentage_homozygous_alternate_alleles
FROM (
  SELECT
    f.value:"call_set_name"::STRING AS sample_id,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_ref,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1] THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_alt,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] != f.value:"genotype"[1] AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL THEN 1
          ELSE 0
        END
      ELSE 0
    END AS het_alt
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
) sub
GROUP BY sample_id;
```

This query performs the following steps:

1. **Filters SNPs on Chromosome X excluding specified regions:**
   - Ensures the `reference_name` is `'X'`.
   - Excludes positions between `60000` and `2699519` and between `154931042` and `155260559`.
   - Includes only SNPs where both `reference_bases` and `alternate_bases` are single nucleotides (length of 1).

2. **Flattens the `call` and `alternate_bases` arrays:**
   - Uses `LATERAL FLATTEN` to process each element in the `call` and `alternate_bases` arrays.

3. **Classifies genotypes for each sample:**
   - **Homozygous Reference Alleles**: Both alleles are `0`.
   - **Homozygous Alternate Alleles**: Both alleles are the same and greater than `0`.
   - **Heterozygous Alternate Alleles**: Alleles are different and at least one is greater than `0`.

4. **Calculates per-sample counts and percentages:**
   - Sums up the counts for each genotype category.
   - Computes the total callable sites.
   - Calculates the total number of SNVs (sum of homozygous and heterozygous alternate alleles).
   - Determines the percentage of heterozygous and homozygous alternate alleles among all SNVs.

**Note:** The `ROUND` function is used to keep the percentage values to four decimal places as specified.

This query will output the results in the required format:

```csv
sample_id,homozygous_reference_alleles,homozygous_alternate_alleles,heterozygous_alternate_alleles,total_callable_sites,total_SNVs,percentage_heterozygous_alternate_alleles,percentage_homozygous_alternate_alleles
sample_id1,count1,count2,count3,total_sites1,total_snvs1,percentage1,percentage2
sample_id2,count1,count2,count3,total_sites2,total_snvs2,percentage1,percentage2
...
```

For example:

```csv
sample_id,homozygous_reference_alleles,homozygous_alternate_alleles,heterozygous_alternate_alleles,total_callable_sites,total_SNVs,percentage_heterozygous_alternate_alleles,percentage_homozygous_alternate_alleles
HG00123,1200,50,60,1310,110,54.5455,45.4545
NA12878,1180,70,50,1300,120,41.6667,58.3333
...
```

- **sample_id**: The identifier for each sample.
- **homozygous_reference_alleles**: Count of homozygous reference genotypes.
- **homozygous_alternate_alleles**: Count of homozygous alternate genotypes.
- **heterozygous_alternate_alleles**: Count of heterozygous genotypes.
- **total_callable_sites**: Sum of all genotype counts.
- **total_SNVs**: Sum of homozygous and heterozygous alternate counts.
- **percentage_heterozygous_alternate_alleles**: Percentage of heterozygous genotypes among all SNVs.
- **percentage_homozygous_alternate_alleles**: Percentage of homozygous alternate genotypes among all SNVs.

This query provides a comprehensive overview of the genotype distribution for SNPs on chromosome X for each sample in the dataset, adhering to the specified requirements.
2025-01-25 06:32:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:32:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:32:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:32:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 822
2025-01-25 06:32:28 - snowflake.connector.connection - INFO - closed
2025-01-25 06:32:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:32:28 - root - INFO - itercount: 1
2025-01-25 06:32:28 - root - INFO - 0
2025-01-25 06:32:28 - root - INFO - results: 
SAMPLE_ID,HOMOZYGOUS_REFERENCE_ALLELES,HOMOZYGOUS_ALTERNATE_ALLELES,HETEROZYGOUS_ALTERNATE_ALLELES,TOTAL_CALLABLE_SITES,TOTAL_SNVS,PERCENTAGE_HETEROZYGOUS_ALTERNATE_ALLELES,PERCENTAGE_HOMOZYGOUS_ALTERNATE_ALLELES
HG00351,1185,78,0,1263,78,0.0000,100.0000
NA19834,1173,90,0,1263,90,0.0000,100.0000
NA19087,1154,56,53,1263,109,48.6239,51.3761
NA18910,1157,106,0,1263,106,0.0000,100.0000
HG01148,1180,83,0,1263,83,0.0000,100.0000
HG00428,1150,51,62,1263,113,54.8673,45.1327
HG00640,1186,77,0,1263,77,0.0000,100.0000
NA20543,1193,70,0,1263,70,0.0000,100.0000
HG00110,1161,45,57,1263,102,55.8824,44.1176
NA18498,1158,105,0,1263,105,0.0000,100.0000
NA19080,1157,44,62,1263,106,58.4906,41.5094
NA19738,1178,85,0,1263,85,0.0000,100.0000
HG01174,1147,42,74,1263,116,63.7931,36.2069
NA12275,1161,42,60,1263,102,58.8235,41.1765
NA19434,1108,53,102,1263,155,65.8065,34.1935
NA20322,1112,49,102,1263,151,67.5497,32.4503
NA18561,1175,88,0,1263,88,0.0000,100.0000
NA18995,1197,66,0,1263,66,0.0000,100.0000
NA19719,1147,42,74,1263,116,63.7931,36.2069
HG01102,1152,44,67,1263,111,60.3604,39.6396
HG00183,1185,78,0,1263,78,0.0000,100.0000
NA20752,1186,77,0,1263,77,0.0000,100.0000
NA18567,1145,53,65,1263,118,55.0847,44.9153
NA19917,1100,61,102,1263,163,62.5767,37.4233
HG00650,1174,89,0,1263,89,0.0000,100.0000
NA18606,1191,72,0,1263,72,0.0000,100.0000
NA19391,1128,54,81,1263,135,60.0000,40.0000
NA20336,1119,44,100,1263,144,69.4444,30.5556
NA20755,1188,75,0,1263,75,0.0000,100.0000
NA19403,1120,51,92,1263,143,64.3357,35.6643
HG00557,1159,54,50,1263,104,48.0769,51.9231
NA20278,1156,107,0,1263,107,0.0000,100.0000
NA20522,1152,39,72,1263,111,64.8649,35.1351
NA19399,1099,62,102,1263,164,62.1951,37.8049
HG00705,1154,50,59,1263,109,54.1284,45.8716
NA19036,1114,57,92,1263,149,61.7450,38.2550
NA18868,1161,102,0,1263,102,0.0000,100.0000
NA18978,1159,37,67,1263,104,64.4231,35.5769
NA19377,1098,59,106,1263,165,64.2424,35.7576
NA11932,1193,70,0,1263,70,0.0000,100.0000
HG01491,1192,71,0,1263,71,0.0000,100.0000
NA11829,1197,66,0,1263,66,0.0000,100.0000
NA12347,1193,70,0,1263,70,0.0000,100.0000
HG00306,1164,36,63,1263,99,63.6364,36.3636
NA20503,1155,43,65,1263,108,60.1852,39.8148
NA18555,1144,52,67,1263,119,56.3025,43.6975
NA19720,1171,92,0,1263,92,0.0000,100.0000
NA19789,1171,92,0,1263,92,0.0000,100.0000
NA19740,1148,47,68,1263,115,59.1304,40.8696
NA19762,1186,77,0,1263,77,0.0000,100.0000
HG00451,1178,85,0,1263,85,0.0000,100.0000
NA19316,1094,55,114,1263,169,67.4556,32.5444
HG00358,1195,68,0,1263,68,0.0000,100.0000
NA20512,1192,71,0,1263,71,0.0000,100.0000
NA19682,1186,77,0,1263,77,0.0000,100.0000
HG01461,1172,91,0,1263,91,0.0000,100.0000
HG01108,1126,58,79,1263,137,57.6642,42.3358
NA18642,1162,43,58,1263,101,57.4257,42.5743
NA18946,1149,53,61,1263,114,53.5088,46.4912
NA18614,1147,57,59,1263,116,50.8621,49.1379
HG00345,1179,84,0,1263,84,0.0000,100.0000
HG00262,1171,45,47,1263,92,51.0870,48.9130
HG00446,1152,48,63,1263,111,56.7568,43.2432
HG00736,1195,68,0,1263,68,0.0000,100.0000
HG01107,1179,84,0,1263,84,0.0000,100.0000
HG00578,1141,45,77,1263,122,63.1148,36.8852
NA12716,1193,70,0,1263,70,0.0000,100.0000
NA18574,1149,51,63,1263,114,55.2632,44.7368
NA18945,1192,71,0,1263,71,0.0000,100.0000
NA18923,1157,106,0,1263,106,0.0000,100.0000
NA19185,1112,44,107,1263,151,70.8609,29.1391
NA20513,1191,72,0,1263,72,0.0000,100.0000
NA19785,1152,42,69,1263,111,62.1622,37.8378
HG00247,1145,43,75,1263,118,63.5593,36.4407
NA19310,1109,52,102,1263,154,66.2338,33.7662
NA19786,1185,78,0,1263,78,0.0000,100.0000
NA18908,1148,115,0,1263,115,0.0000,100.0000
NA20528,1185,78,0,1263,78,0.0000,100.0000
HG01124,1184,79,0,1263,79,0.0000,100.0000
HG01113,1160,40,63,1263,103,61.1650,38.8350
NA18602,1149,49,65,1263,114,57.0175,42.9825
HG00663,1158,54,51,1263,105,48.5714,51.4286
HG01095,1138,35,90,1263,125,72.0000,28.0000
NA12546,1187,76,0,1263,76,0.0000,100.0000
HG00312,1186,77,0,1263,77,0.0000,100.0000
NA20802,1149,34,80,1263,114,70.1754,29.8246
NA18610,1160,45,58,1263,103,56.3107,43.6893
NA20812,1188,75,0,1263,75,0.0000,100.0000
HG01488,1190,73,0,1263,73,0.0000,100.0000
NA18623,1179,84,0,1263,84,0.0000,100.0000
NA20317,1099,50,114,1263,164,69.5122,30.4878
NA12249,1170,48,45,1263,93,48.3871,51.6129
HG00121,1163,44,56,1263,100,56.0000,44.0000
NA19734,1155,53,55,1263,108,50.9259,49.0741
HG00111,1163,41,59,1263,100,59.0000,41.0000
NA18550,1154,54,55,1263,109,50.4587,49.5413
HG00382,1191,72,0,1263,72,0.0000,100.0000
HG01516,1157,48,58,1263,106,54.7170,45.2830
NA06989,1159,45,59,1263,104,56.7308,43.2692
HG00362,1175,43,45,1263,88,51.1364,48.8636
NA10847,1159,41,63,1263,104,60.5769,39.4231
NA18745,1180,83,0,1263,83,0.0000,100.0000
HG00596,1148,50,65,1263,115,56.5217,43.4783
NA12889,1197,66,0,1263,66,0.0000,100.0000
HG01101,1182,81,0,1263,81,0.0000,100.0000
NA19753,1183,80,0,1263,80,0.0000,100.0000
HG00156,1186,77,0,1263,77,0.0000,100.0000
HG00404,1159,46,58,1263,104,55.7692,44.2308
HG00236,1151,48,64,1263,112,57.1429,42.8571
NA19095,1119,48,96,1263,144,66.6667,33.3333
HG00112,1185,78,0,1263,78,0.0000,100.0000
HG00251,1182,81,0,1263,81,0.0000,100.0000
NA18526,1156,49,58,1263,107,54.2056,45.7944
HG00559,1183,80,0,1263,80,0.0000,100.0000
HG00536,1188,75,0,1263,75,0.0000,100.0000
NA19098,1162,101,0,1263,101,0.0000,100.0000
NA19675,1154,41,68,1263,109,62.3853,37.6147
NA19207,1156,107,0,1263,107,0.0000,100.0000
NA18546,1177,86,0,1263,86,0.0000,100.0000
NA18959,1185,78,0,1263,78,0.0000,100.0000
HG00449,1150,51,62,1263,113,54.8673,45.1327
HG00524,1176,87,0,1263,87,0.0000,100.0000
NA07048,1191,72,0,1263,72,0.0000,100.0000
NA20296,1109,52,102,1263,154,66.2338,33.7662
HG00378,1162,41,60,1263,101,59.4059,40.5941
NA18543,1181,82,0,1263,82,0.0000,100.0000
HG01342,1108,43,112,1263,155,72.2581,27.7419
NA20517,1153,48,62,1263,110,56.3636,43.6364
NA18977,1181,82,0,1263,82,0.0000,100.0000
HG00500,1181,82,0,1263,82,0.0000,100.0000
HG00128,1163,42,58,1263,100,58.0000,42.0000
NA20792,1191,72,0,1263,72,0.0000,100.0000
HG00464,1147,52,64,1263,116,55.1724,44.8276
NA19468,1116,52,95,1263,147,64.6259,35.3741
HG00458,1161,47,55,1263,102,53.9216,46.0784
NA19676,1174,89,0,1263,89,0.0000,100.0000
NA19657,1153,49,61,1263,110,55.4545,44.5455
NA12489,1160,47,56,1263,103,54.3689,45.6311
NA19059,1153,53,57,1263,110,51.8182,48.1818
NA19317,1164,99,0,1263,99,0.0000,100.0000
NA18564,1154,53,56,1263,109,51.3761,48.6239
HG00275,1156,45,62,1263,107,57.9439,42.0561
HG01051,1162,101,0,1263,101,0.0000,100.0000
NA20334,1117,49,97,1263,146,66.4384,33.5616
HG00342,1198,65,0,1263,65,0.0000,100.0000
NA19449,1107,53,103,1263,156,66.0256,33.9744
HG01278,1149,39,75,1263,114,65.7895,34.2105
HG01489,1152,41,70,1263,111,63.0631,36.9369
HG00189,1197,66,0,1263,66,0.0000,100.0000
NA07357,1180,83,0,1263,83,0.0000,100.0000
NA18964,1156,50,57,1263,107,53.2710,46.7290
HG00537,1155,61,47,1263,108,43.5185,56.4815
HG01187,1168,95,0,1263,95,0.0000,100.0000
HG00554,1151,52,60,1263,112,53.5714,46.4286
NA19782,1155,49,59,1263,108,54.6296,45.3704
NA20539,1189,74,0,1263,74,0.0000,100.0000
NA20359,1100,47,116,1263,163,71.1656,28.8344
NA20542,1150,43,70,1263,113,61.9469,38.0531
NA18517,1093,51,119,1263,170,70.0000,30.0000
NA19908,1161,102,0,1263,102,0.0000,100.0000
NA18990,1178,85,0,1263,85,0.0000,100.0000
HG00377,1172,48,43,1263,91,47.2527,52.7473
NA19147,1112,56,95,1263,151,62.9139,37.0861
HG01061,1143,46,74,1263,120,61.6667,38.3333
NA12273,1156,42,65,1263,107,60.7477,39.2523
NA12778,1151,41,71,1263,112,63.3929,36.6071
NA12872,1197,66,0,1263,66,0.0000,100.0000
HG00268,1171,41,51,1263,92,55.4348,44.5652
HG01251,1150,38,75,1263,113,66.3717,33.6283
NA12282,1190,73,0,1263,73,0.0000,100.0000
NA19041,1154,109,0,1263,109,0.0000,100.0000
NA20770,1192,71,0,1263,71,0.0000,100.0000
NA11993,1157,35,71,1263,106,66.9811,33.0189
HG00140,1184,79,0,1263,79,0.0000,100.0000
NA18562,1180,83,0,1263,83,0.0000,100.0000
HG00457,1193,70,0,1263,70,0.0000,100.0000
HG01136,1180,83,0,1263,83,0.0000,100.0000
NA18609,1179,84,0,1263,84,0.0000,100.0000
HG00244,1183,80,0,1263,80,0.0000,100.0000
HG00353,1159,43,61,1263,104,58.6538,41.3462
HG01168,1163,38,62,1263,100,62.0000,38.0000
HG00125,1154,42,67,1263,109,61.4679,38.5321
NA19171,1149,114,0,1263,114,0.0000,100.0000
NA20773,1166,36,61,1263,97,62.8866,37.1134
NA18858,1101,51,111,1263,162,68.5185,31.4815
NA19064,1160,54,49,1263,103,47.5728,52.4272
NA20506,1183,67,13,1263,80,16.2500,83.7500
HG00325,1187,76,0,1263,76,0.0000,100.0000
HG01171,1144,40,79,1263,119,66.3866,33.6134
HG00556,1172,91,0,1263,91,0.0000,100.0000
NA20281,1161,102,0,1263,102,0.0000,100.0000
NA18565,1160,46,57,1263,103,55.3398,44.6602
HG00101,1187,76,0,1263,76,0.0000,100.0000
NA19660,1148,48,67,1263,115,58.2609,41.7391
HG00553,1172,91,0,1263,91,0.0000,100.0000
HG00335,1194,69,0,1263,69,0.0000,100.0000
HG00338,1191,72,0,1263,72,0.0000,100.0000
NA18548,1177,86,0,1263,86,0.0000,100.0000
NA18867,1106,48,109,1263,157,69.4268,30.5732
NA20356,1169,94,0,1263,94,0.0000,100.0000
NA19067,1187,76,0,1263,76,0.0000,100.0000
NA18983,1182,81,0,1263,81,0.0000,100.0000
NA19982,1150,113,0,1263,113,0.0000,100.0000
NA18544,1172,91,0,1263,91,0.0000,100.0000
NA18627,1162,48,53,1263,101,52.4752,47.5248
HG00651,1163,52,48,1263,100,48.0000,52.0000
NA19678,1147,47,69,1263,116,59.4828,40.5172
NA20785,1193,70,0,1263,70,0.0000,100.0000
NA19428,1160,103,0,1263,103,0.0000,100.0000
HG00740,1151,42,70,1263,112,62.5000,37.5000
HG00119,1186,77,0,1263,77,0.0000,100.0000
NA18634,1151,45,67,1263,112,59.8214,40.1786
NA19082,1191,72,0,1263,72,0.0000,100.0000
NA18541,1148,49,66,1263,115,57.3913,42.6087
HG00581,1147,48,68,1263,116,58.6207,41.3793
NA18638,1186,77,0,1263,77,0.0000,100.0000
HG01277,1185,78,0,1263,78,0.0000,100.0000
HG01465,1170,39,54,1263,93,58.0645,41.9355
NA18592,1154,54,55,1263,109,50.4587,49.5413
HG00239,1169,40,54,1263,94,57.4468,42.5532
NA19625,1108,46,109,1263,155,70.3226,29.6774
NA19360,1157,106,0,1263,106,0.0000,100.0000
HG00610,1174,89,0,1263,89,0.0000,100.0000
HG00255,1163,49,51,1263,100,51.0000,49.0000
NA20809,1194,69,0,1263,69,0.0000,100.0000
NA20756,1154,45,64,1263,109,58.7156,41.2844
NA19448,1165,98,0,1263,98,0.0000,100.0000
NA19835,1105,47,111,1263,158,70.2532,29.7468
NA19761,1150,52,61,1263,113,53.9823,46.0177
HG01133,1182,81,0,1263,81,0.0000,100.0000
HG01374,1188,75,0,1263,75,0.0000,100.0000
HG00143,1186,77,0,1263,77,0.0000,100.0000
NA19114,1099,57,107,1263,164,65.2439,34.7561
HG01079,1181,82,0,1263,82,0.0000,100.0000
HG00271,1192,71,0,1263,71,0.0000,100.0000
HG00173,1153,47,63,1263,110,57.2727,42.7273
NA18907,1108,47,108,1263,155,69.6774,30.3226
NA18615,1154,56,53,1263,109,48.6239,51.3761
NA18573,1172,50,41,1263,91,45.0549,54.9451
NA18934,1147,116,0,1263,116,0.0000,100.0000
HG00708,1150,55,58,1263,113,51.3274,48.6726
NA18749,1192,71,0,1263,71,0.0000,100.0000
HG00337,1149,36,78,1263,114,68.4211,31.5789
HG01134,1158,45,60,1263,105,57.1429,42.8571
NA20518,1188,75,0,1263,75,0.0000,100.0000
NA19467,1117,56,90,1263,146,61.6438,38.3562
HG00133,1153,43,67,1263,110,60.9091,39.0909
HG01085,1188,75,0,1263,75,0.0000,100.0000
HG00152,1181,82,0,1263,82,0.0000,100.0000
HG00310,1192,71,0,1263,71,0.0000,100.0000
NA12890,1155,42,66,1263,108,61.1111,38.8889
NA19711,1170,93,0,1263,93,0.0000,100.0000
NA19131,1113,51,99,1263,150,66.0000,34.0000
NA12829,1180,83,0,1263,83,0.0000,100.0000
NA18916,1102,55,106,1263,161,65.8385,34.1615
HG00154,1168,43,52,1263,95,54.7368,45.2632
NA19901,1097,53,113,1263,166,68.0723,31.9277
NA18549,1181,82,0,1263,82,0.0000,100.0000
HG00533,1184,79,0,1263,79,0.0000,100.0000
HG00613,1180,83,0,1263,83,0.0000,100.0000
NA19777,1178,85,0,1263,85,0.0000,100.0000
NA19456,1106,53,104,1263,157,66.2420,33.7580
NA19430,1184,79,0,1263,79,0.0000,100.0000
HG00151,1190,73,0,1263,73,0.0000,100.0000
HG00731,1185,78,0,1263,78,0.0000,100.0000
NA18924,1114,60,89,1263,149,59.7315,40.2685
NA20348,1184,79,0,1263,79,0.0000,100.0000
NA20357,1101,53,109,1263,162,67.2840,32.7160
NA18558,1183,80,0,1263,80,0.0000,100.0000
NA20351,1169,94,0,1263,94,0.0000,100.0000
NA12830,1158,37,68,1263,105,64.7619,35.2381
HG01377,1180,83,0,1263,83,0.0000,100.0000
HG00479,1161,47,55,1263,102,53.9216,46.0784
HG00179,1170,40,53,1263,93,56.9892,43.0108
HG00272,1158,40,65,1263,105,61.9048,38.0952
NA20774,1153,52,58,1263,110,52.7273,47.2727
HG00699,1159,47,57,1263,104,54.8077,45.1923
NA19319,1159,104,0,1263,104,0.0000,100.0000
NA18557,1192,71,0,1263,71,0.0000,100.0000
NA19776,1146,44,73,1263,117,62.3932,37.6068
NA20800,1160,40,63,1263,103,61.1650,38.8350
NA20815,1189,74,0,1263,74,0.0000,100.0000
NA19712,1105,45,113,1263,158,71.5190,28.4810
NA18949,1165,45,53,1263,98,54.0816,45.9184
HG01456,1149,53,61,1263,114,53.5088,46.4912
NA19332,1148,105,10,1263,115,8.6957,91.3043
NA19732,1185,78,0,1263,78,0.0000,100.0000
HG00139,1194,69,0,1263,69,0.0000,100.0000
NA19463,1093,54,116,1263,170,68.2353,31.7647
HG00109,1190,73,0,1263,73,0.0000,100.0000
NA19077,1151,54,58,1263,112,51.7857,48.2143
NA19172,1102,53,108,1263,161,67.0807,32.9193
NA12749,1154,41,68,1263,109,62.3853,37.6147
NA19703,1147,116,0,1263,116,0.0000,100.0000
NA18621,1179,84,0,1263,84,0.0000,100.0000
HG00346,1165,45,53,1263,98,54.0816,45.9184
NA19376,1160,103,0,1263,103,0.0000,100.0000
NA11933,1158,47,58,1263,105,55.2381,44.7619
NA18951,1147,43,73,1263,116,62.9310,37.0690
HG00383,1162,48,53,1263,101,52.4752,47.5248
HG01149,1148,52,63,1263,115,54.7826,45.2174
HG00690,1152,49,62,1263,111,55.8559,44.1441
NA20541,1152,43,68,1263,111,61.2613,38.7387
HG00619,1182,81,0,1263,81,0.0000,100.0000
HG00266,1161,44,58,1263,102,56.8627,43.1373
HG00321,1183,80,0,1263,80,0.0000,100.0000
HG00698,1172,91,0,1263,91,0.0000,100.0000
HG00231,1153,44,66,1263,110,60.0000,40.0000
HG01188,1120,43,100,1263,143,69.9301,30.0699
HG00124,1156,49,58,1263,107,54.2056,45.7944
HG00350,1169,42,52,1263,94,55.3191,44.6809
NA19307,1164,99,0,1263,99,0.0000,100.0000
HG00614,1150,56,57,1263,113,50.4425,49.5575
NA20828,1154,48,61,1263,109,55.9633,44.0367
NA19093,1107,56,100,1263,156,64.1026,35.8974
NA11995,1163,45,55,1263,100,55.0000,45.0000
NA19783,1187,76,0,1263,76,0.0000,100.0000
NA18505,1096,54,113,1263,167,67.6647,32.3353
HG00339,1161,39,63,1263,102,61.7647,38.2353
NA20753,1153,53,57,1263,110,51.8182,48.1818
NA18963,1160,53,50,1263,103,48.5437,51.4563
NA19701,1123,39,101,1263,140,72.1429,27.8571
HG00331,1168,47,48,1263,95,50.5263,49.4737
NA19429,1170,93,0,1263,93,0.0000,100.0000
NA19788,1161,48,54,1263,102,52.9412,47.0588
NA20276,1121,50,92,1263,142,64.7887,35.2113
NA19909,1124,56,83,1263,139,59.7122,40.2878
HG00367,1155,45,63,1263,108,58.3333,41.6667
NA19189,1153,110,0,1263,110,0.0000,100.0000
HG00583,1185,78,0,1263,78,0.0000,100.0000
NA19759,1178,85,0,1263,85,0.0000,100.0000
HG01375,1149,39,75,1263,114,65.7895,34.2105
NA18641,1166,50,47,1263,97,48.4536,51.5464
NA19451,1162,101,0,1263,101,0.0000,100.0000
HG01357,1159,47,57,1263,104,54.8077,45.1923
NA20582,1159,48,56,1263,104,53.8462,46.1538
HG00364,1163,30,70,1263,100,70.0000,30.0000
NA19372,1164,99,0,1263,99,0.0000,100.0000
HG01366,1119,47,97,1263,144,67.3611,32.6389
NA19395,1119,64,80,1263,144,55.5556,44.4444
NA18608,1189,74,0,1263,74,0.0000,100.0000
HG00560,1148,53,62,1263,115,53.9130,46.0870
NA18507,1158,105,0,1263,105,0.0000,100.0000
NA12340,1181,82,0,1263,82,0.0000,100.0000
HG01272,1156,41,66,1263,107,61.6822,38.3178
HG00634,1184,79,0,1263,79,0.0000,100.0000
HG01550,1187,76,0,1263,76,0.0000,100.0000
HG01204,1184,79,0,1263,79,0.0000,100.0000
HG00329,1193,70,0,1263,70,0.0000,100.0000
HG00245,1168,40,55,1263,95,57.8947,42.1053
NA19922,1152,111,0,1263,111,0.0000,100.0000
NA19003,1161,50,52,1263,102,50.9804,49.0196
NA19663,1147,53,63,1263,116,54.3103,45.6897
HG00403,1179,84,0,1263,84,0.0000,100.0000
NA19009,1184,79,0,1263,79,0.0000,100.0000
HG00178,1165,39,59,1263,98,60.2041,39.7959
HG00233,1158,56,49,1263,105,46.6667,53.3333
NA19985,1110,43,110,1263,153,71.8954,28.1046
HG00100,1162,44,57,1263,101,56.4356,43.5644
NA18632,1184,79,0,1263,79,0.0000,100.0000
NA12827,1184,79,0,1263,79,0.0000,100.0000
HG00580,1187,76,0,1263,76,0.0000,100.0000
HG01271,1185,78,0,1263,78,0.0000,100.0000
NA20826,1147,47,69,1263,116,59.4828,40.5172
HG00452,1156,39,68,1263,107,63.5514,36.4486
HG01083,1143,52,68,1263,120,56.6667,43.3333
NA18912,1112,59,92,1263,151,60.9272,39.0728
NA19756,1176,87,0,1263,87,0.0000,100.0000
NA18940,1180,83,0,1263,83,0.0000,100.0000
HG00235,1158,30,75,1263,105,71.4286,28.5714
NA19119,1157,106,0,1263,106,0.0000,100.0000
HG00186,1194,69,0,1263,69,0.0000,100.0000
NA19028,1163,100,0,1263,100,0.0000,100.0000
NA19731,1158,52,53,1263,105,50.4762,49.5238
HG00421,1184,79,0,1263,79,0.0000,100.0000
NA18943,1194,69,0,1263,69,0.0000,100.0000
HG00130,1161,43,59,1263,102,57.8431,42.1569
HG00276,1157,40,66,1263,106,62.2642,37.7358
HG00565,1180,83,0,1263,83,0.0000,100.0000
NA11831,1190,73,0,1263,73,0.0000,100.0000
HG00448,1182,81,0,1263,81,0.0000,100.0000
NA12004,1152,48,63,1263,111,56.7568,43.2432
HG00437,1149,51,63,1263,114,55.2632,44.7368
NA19355,1107,47,109,1263,156,69.8718,30.1282
HG00120,1162,43,58,1263,101,57.4257,42.5743
NA12717,1149,45,69,1263,114,60.5263,39.4737
NA18999,1150,53,60,1263,113,53.0973,46.9027
HG00531,1161,51,51,1263,102,50.0000,50.0000
NA18624,1179,84,0,1263,84,0.0000,100.0000
NA19681,1134,46,83,1263,129,64.3411,35.6589
HG01259,1186,77,0,1263,77,0.0000,100.0000
NA18630,1154,42,67,1263,109,61.4679,38.5321
NA18953,1188,75,0,1263,75,0.0000,100.0000
HG00343,1162,49,52,1263,101,51.4851,48.5149
NA18626,1151,52,60,1263,112,53.5714,46.4286
NA20287,1121,50,92,1263,142,64.7887,35.2113
NA12399,1185,78,0,1263,78,0.0000,100.0000
NA18597,1161,52,50,1263,102,49.0196,50.9804
HG00252,1199,64,0,1263,64,0.0000,100.0000
HG01075,1175,88,0,1263,88,0.0000,100.0000
NA19723,1187,76,0,1263,76,0.0000,100.0000
NA20761,1156,42,65,1263,107,60.7477,39.2523
NA19076,1190,73,0,1263,73,0.0000,100.0000
NA12815,1165,40,58,1263,98,59.1837,40.8163
HG00693,1158,47,58,1263,105,55.2381,44.7619
NA19375,1149,114,0,1263,114,0.0000,100.0000
NA20805,1188,75,0,1263,75,0.0000,100.0000
HG01351,1154,46,63,1263,109,57.7982,42.2018
HG01389,1191,72,0,1263,72,0.0000,100.0000
NA19035,1162,101,0,1263,101,0.0000,100.0000
HG00190,1181,82,0,1263,82,0.0000,100.0000
NA19321,1126,47,90,1263,137,65.6934,34.3066
NA19716,1157,51,55,1263,106,51.8868,48.1132
NA19438,1104,50,109,1263,159,68.5535,31.4465
NA18510,1157,106,0,1263,106,0.0000,100.0000
HG00418,1192,71,0,1263,71,0.0000,100.0000
HG01105,1141,39,83,1263,122,68.0328,31.9672
HG00135,1166,38,59,1263,97,60.8247,39.1753
HG01125,1166,37,60,1263,97,61.8557,38.1443
NA19347,1159,104,0,1263,104,0.0000,100.0000
NA19398,1099,48,116,1263,164,70.7317,29.2683
HG00099,1168,49,46,1263,95,48.4211,51.5789
HG00176,1142,44,77,1263,121,63.6364,36.3636
NA12154,1178,85,0,1263,85,0.0000,100.0000
NA20412,1110,46,107,1263,153,69.9346,30.0654
NA12155,1181,82,0,1263,82,0.0000,100.0000
HG00702,1152,53,58,1263,111,52.2523,47.7477
HG00501,1147,49,67,1263,116,57.7586,42.2414
NA19116,1115,55,93,1263,148,62.8378,37.1622
NA18527,1160,48,55,1263,103,53.3981,46.6019
HG00472,1189,74,0,1263,74,0.0000,100.0000
NA20342,1162,101,0,1263,101,0.0000,100.0000
HG00146,1151,40,72,1263,112,64.2857,35.7143
NA18579,1157,51,55,1263,106,51.8868,48.1132
NA19722,1158,45,60,1263,105,57.1429,42.8571
HG01497,1169,94,0,1263,94,0.0000,100.0000
HG00463,1184,79,0,1263,79,0.0000,100.0000
NA19383,1176,87,0,1263,87,0.0000,100.0000
HG00476,1153,52,58,1263,110,52.7273,47.2727
NA19461,1155,108,0,1263,108,0.0000,100.0000
NA19309,1175,88,0,1263,88,0.0000,100.0000
HG01176,1168,95,0,1263,95,0.0000,100.0000
HG00311,1202,61,0,1263,61,0.0000,100.0000
HG00116,1187,76,0,1263,76,0.0000,100.0000
NA20502,1155,39,69,1263,108,63.8889,36.1111
HG01624,1198,65,0,1263,65,0.0000,100.0000
NA19725,1146,42,75,1263,117,64.1026,35.8974
NA18971,1185,78,0,1263,78,0.0000,100.0000
NA19749,1154,53,56,1263,109,51.3761,48.6239
NA19007,1183,80,0,1263,80,0.0000,100.0000
NA19469,1107,51,105,1263,156,67.3077,32.6923
NA20814,1181,82,0,1263,82,0.0000,100.0000
HG01365,1167,96,0,1263,96,0.0000,100.0000
NA20806,1191,72,0,1263,72,0.0000,100.0000
NA19446,1102,51,110,1263,161,68.3230,31.6770
HG01140,1137,46,80,1263,126,63.4921,36.5079
HG00584,1154,51,58,1263,109,53.2110,46.7890
HG00243,1191,72,0,1263,72,0.0000,100.0000
HG00334,1158,39,66,1263,105,62.8571,37.1429
HG00473,1159,47,57,1263,104,54.8077,45.1923
HG00159,1195,68,0,1263,68,0.0000,100.0000
HG00683,1181,82,0,1263,82,0.0000,100.0000
NA19819,1110,53,100,1263,153,65.3595,34.6405
NA19359,1162,101,0,1263,101,0.0000,100.0000
HG01275,1161,37,65,1263,102,63.7255,36.2745
HG01626,1172,32,59,1263,91,64.8352,35.1648
NA19472,1095,52,116,1263,168,69.0476,30.9524
NA18992,1165,50,48,1263,98,48.9796,51.0204
HG00734,1126,37,100,1263,137,72.9927,27.0073
NA19373,1149,114,0,1263,114,0.0000,100.0000
NA12751,1156,43,64,1263,107,59.8131,40.1869
HG00360,1205,58,0,1263,58,0.0000,100.0000
NA20289,1095,63,105,1263,168,62.5000,37.5000
NA19773,1143,47,73,1263,120,60.8333,39.1667
NA19713,1110,46,107,1263,153,69.9346,30.0654
NA18618,1162,56,45,1263,101,44.5545,55.4455
NA18982,1198,65,0,1263,65,0.0000,100.0000
NA19099,1128,40,95,1263,135,70.3704,29.6296
NA20341,1080,58,125,1263,183,68.3060,31.6940
NA11920,1163,36,64,1263,100,64.0000,36.0000
NA19338,1122,51,90,1263,141,63.8298,36.1702
NA18619,1156,56,51,1263,107,47.6636,52.3364
HG00704,1189,74,0,1263,74,0.0000,100.0000
NA18947,1155,54,54,1263,108,50.0000,50.0000
NA20589,1155,42,66,1263,108,61.1111,38.8889
NA12348,1150,56,57,1263,113,50.4425,49.5575
HG01191,1158,41,64,1263,105,60.9524,39.0476
NA18933,1113,67,83,1263,150,55.3333,44.6667
HG00232,1159,42,62,1263,104,59.6154,40.3846
NA19397,1164,99,0,1263,99,0.0000,100.0000
HG00344,1160,41,62,1263,103,60.1942,39.8058
NA19704,1120,42,101,1263,143,70.6294,29.3706
NA19717,1183,80,0,1263,80,0.0000,100.0000
NA18952,1188,75,0,1263,75,0.0000,100.0000
HG00656,1176,87,0,1263,87,0.0000,100.0000
NA18613,1177,86,0,1263,86,0.0000,100.0000
NA06984,1189,74,0,1263,74,0.0000,100.0000
NA19236,1152,111,0,1263,111,0.0000,100.0000
NA18636,1178,85,0,1263,85,0.0000,100.0000
HG01519,1164,51,48,1263,99,48.4848,51.5152
NA19679,1191,72,0,1263,72,0.0000,100.0000
HG00419,1169,40,54,1263,94,57.4468,42.5532
HG01190,1179,84,0,1263,84,0.0000,100.0000
HG00637,1187,76,0,1263,76,0.0000,100.0000
HG01055,1149,45,69,1263,114,60.5263,39.4737
NA18976,1150,50,63,1263,113,55.7522,44.2478
HG00629,1150,46,67,1263,113,59.2920,40.7080
NA18941,1147,51,65,1263,116,56.0345,43.9655
HG00357,1166,41,56,1263,97,57.7320,42.2680
HG00269,1152,48,63,1263,111,56.7568,43.2432
HG00366,1196,67,0,1263,67,0.0000,100.0000
HG00653,1186,77,0,1263,77,0.0000,100.0000
HG00267,1189,74,0,1263,74,0.0000,100.0000
NA18530,1189,74,0,1263,74,0.0000,100.0000
NA18502,1116,59,88,1263,147,59.8639,40.1361
NA07056,1161,41,61,1263,102,59.8039,40.1961
NA20531,1160,35,68,1263,103,66.0194,33.9806
HG00185,1191,72,0,1263,72,0.0000,100.0000
HG01098,1153,38,72,1263,110,65.4545,34.5455
HG01455,1177,86,0,1263,86,0.0000,100.0000
NA20414,1112,36,115,1263,151,76.1589,23.8411
HG01048,1183,80,0,1263,80,0.0000,100.0000
NA12341,1161,40,62,1263,102,60.7843,39.2157
NA20508,1165,35,63,1263,98,64.2857,35.7143
NA19381,1105,53,105,1263,158,66.4557,33.5443
NA18519,1167,96,0,1263,96,0.0000,100.0000
NA12046,1164,43,56,1263,99,56.5657,43.4343
HG01356,1189,74,0,1263,74,0.0000,100.0000
NA20760,1161,43,59,1263,102,57.8431,42.1569
NA19130,1165,98,0,1263,98,0.0000,100.0000
NA20529,1160,40,63,1263,103,61.1650,38.8350
NA19771,1193,70,0,1263,70,0.0000,100.0000
HG00315,1156,46,61,1263,107,57.0093,42.9907
NA18489,1116,59,88,1263,147,59.8639,40.1361
HG00593,1157,45,61,1263,106,57.5472,42.4528
NA18917,1163,100,0,1263,100,0.0000,100.0000
HG01170,1173,90,0,1263,90,0.0000,100.0000
NA12777,1186,77,0,1263,77,0.0000,100.0000
NA12748,1183,80,0,1263,80,0.0000,100.0000
HG01625,1184,79,0,1263,79,0.0000,100.0000
NA19371,1162,101,0,1263,101,0.0000,100.0000
NA18528,1157,52,54,1263,106,50.9434,49.0566
NA18962,1191,72,0,1263,72,0.0000,100.0000
NA19435,1107,64,92,1263,156,58.9744,41.0256
HG00638,1140,44,79,1263,123,64.2276,35.7724
NA18909,1109,64,90,1263,154,58.4416,41.5584
NA18617,1155,47,61,1263,108,56.4815,43.5185
NA20585,1149,49,65,1263,114,57.0175,42.9825
HG01518,1184,79,0,1263,79,0.0000,100.0000
HG00258,1166,38,59,1263,97,60.8247,39.1753
NA20525,1191,72,0,1263,72,0.0000,100.0000
NA18986,1184,79,0,1263,79,0.0000,100.0000
HG00375,1179,84,0,1263,84,0.0000,100.0000
HG00113,1192,71,0,1263,71,0.0000,100.0000
HG00330,1162,38,63,1263,101,62.3762,37.6238
NA19204,1104,55,104,1263,159,65.4088,34.5912
HG00148,1194,69,0,1263,69,0.0000,100.0000
HG00590,1152,49,62,1263,111,55.8559,44.1441
HG00150,1154,47,62,1263,109,56.8807,43.1193
NA19651,1154,44,65,1263,109,59.6330,40.3670
NA19393,1149,114,0,1263,114,0.0000,100.0000
HG00323,1159,43,61,1263,104,58.6538,41.3462
NA19074,1146,56,61,1263,117,52.1368,47.8632
NA19453,1155,108,0,1263,108,0.0000,100.0000
NA19096,1165,98,0,1263,98,0.0000,100.0000
NA19084,1148,48,67,1263,115,58.2609,41.7391
NA20796,1179,84,0,1263,84,0.0000,100.0000
HG00280,1185,78,0,1263,78,0.0000,100.0000
NA20769,1168,43,52,1263,95,54.7368,45.2632
NA19327,1109,59,95,1263,154,61.6883,38.3117
NA19401,1106,58,99,1263,157,63.0573,36.9427
NA18525,1163,48,52,1263,100,52.0000,48.0000
HG00654,1156,55,52,1263,107,48.5981,51.4019
HG01350,1178,85,0,1263,85,0.0000,100.0000
NA19328,1107,56,100,1263,156,64.1026,35.8974
HG00149,1183,80,0,1263,80,0.0000,100.0000
NA19190,1106,53,104,1263,157,66.2420,33.7580
NA18939,1156,48,59,1263,107,55.1402,44.8598
NA19046,1165,98,0,1263,98,0.0000,100.0000
NA18595,1163,42,58,1263,100,58.0000,42.0000
NA20813,1160,48,55,1263,103,53.3981,46.6019
HG01359,1190,73,0,1263,73,0.0000,100.0000
NA19113,1156,107,0,1263,107,0.0000,100.0000
HG01097,1194,69,0,1263,69,0.0000,100.0000
NA19149,1098,51,114,1263,165,69.0909,30.9091
HG01551,1131,40,92,1263,132,69.6970,30.3030
NA20282,1113,57,93,1263,150,62.0000,38.0000
HG01618,1157,40,66,1263,106,62.2642,37.7358
HG00240,1166,40,57,1263,97,58.7629,41.2371
NA18640,1152,47,64,1263,111,57.6577,42.3423
NA18994,1189,74,0,1263,74,0.0000,100.0000
NA19916,1154,109,0,1263,109,0.0000,100.0000
HG00158,1162,46,55,1263,101,54.4554,45.5446
NA19350,1158,105,0,1263,105,0.0000,100.0000
HG00106,1153,45,65,1263,110,59.0909,40.9091
NA18542,1153,48,62,1263,110,56.3636,43.6364
HG00635,1154,54,55,1263,109,50.4587,49.5413
NA20520,1187,76,0,1263,76,0.0000,100.0000
NA18985,1180,83,0,1263,83,0.0000,100.0000
HG01250,1175,88,0,1263,88,0.0000,100.0000
NA19044,1181,82,0,1263,82,0.0000,100.0000
HG01492,1146,39,78,1263,117,66.6667,33.3333
HG00641,1147,38,78,1263,116,67.2414,32.7586
HG00592,1180,83,0,1263,83,0.0000,100.0000
HG00701,1176,87,0,1263,87,0.0000,100.0000
NA18635,1180,83,0,1263,83,0.0000,100.0000
NA19737,1166,40,57,1263,97,58.7629,41.2371
HG00108,1185,78,0,1263,78,0.0000,100.0000
NA19750,1193,70,0,1263,70,0.0000,100.0000
HG00278,1180,83,0,1263,83,0.0000,100.0000
NA11919,1188,75,0,1263,75,0.0000,100.0000
NA19774,1191,72,0,1263,72,0.0000,100.0000
NA19473,1110,53,100,1263,153,65.3595,34.6405
NA19257,1115,47,101,1263,148,68.2432,31.7568
HG00122,1157,42,64,1263,106,60.3774,39.6226
NA19256,1152,111,0,1263,111,0.0000,100.0000
NA19445,1109,53,101,1263,154,65.5844,34.4156
NA19431,1105,54,104,1263,158,65.8228,34.1772
NA20586,1192,71,0,1263,71,0.0000,100.0000
NA18616,1149,54,60,1263,114,52.6316,47.3684
NA19198,1155,108,0,1263,108,0.0000,100.0000
NA19382,1156,107,0,1263,107,0.0000,100.0000
NA11843,1190,73,0,1263,73,0.0000,100.0000
HG00628,1185,78,0,1263,78,0.0000,100.0000
NA18552,1152,54,57,1263,111,51.3514,48.6486
HG00684,1139,52,72,1263,124,58.0645,41.9355
NA11893,1187,76,0,1263,76,0.0000,100.0000
NA19752,1157,48,58,1263,106,54.7170,45.2830
HG01197,1180,83,0,1263,83,0.0000,100.0000
NA20544,1198,65,0,1263,65,0.0000,100.0000
NA12873,1155,44,64,1263,108,59.2593,40.7407
HG00589,1184,79,0,1263,79,0.0000,100.0000
HG00171,1154,42,67,1263,109,61.4679,38.5321
NA18965,1190,73,0,1263,73,0.0000,100.0000
NA18856,1158,105,0,1263,105,0.0000,100.0000
HG00381,1168,42,53,1263,95,55.7895,44.2105
NA18747,1185,78,0,1263,78,0.0000,100.0000
HG00261,1156,47,60,1263,107,56.0748,43.9252
NA19452,1175,88,0,1263,88,0.0000,100.0000
NA19758,1140,45,78,1263,123,63.4146,36.5854
NA18520,1112,59,92,1263,151,60.9272,39.0728
NA20786,1159,40,64,1263,104,61.5385,38.4615
NA20126,1161,102,0,1263,102,0.0000,100.0000
NA11894,1145,47,71,1263,118,60.1695,39.8305
NA20775,1152,43,68,1263,111,61.2613,38.7387
NA19904,1166,97,0,1263,97,0.0000,100.0000
NA20127,1111,41,111,1263,152,73.0263,26.9737
HG00436,1180,83,0,1263,83,0.0000,100.0000
NA20344,1122,52,89,1263,141,63.1206,36.8794
NA18499,1104,52,107,1263,159,67.2956,32.7044
HG00657,1152,51,60,1263,111,54.0541,45.9459
NA18605,1174,89,0,1263,89,0.0000,100.0000
NA12718,1152,48,63,1263,111,56.7568,43.2432
HG01070,1133,48,82,1263,130,63.0769,36.9231
NA18577,1152,58,53,1263,111,47.7477,52.2523
HG00732,1153,40,70,1263,110,63.6364,36.3636
HG00692,1172,91,0,1263,91,0.0000,100.0000
NA19729,1190,73,0,1263,73,0.0000,100.0000
NA19384,1149,114,0,1263,114,0.0000,100.0000
NA19394,1164,99,0,1263,99,0.0000,100.0000
NA18956,1151,55,57,1263,112,50.8929,49.1071
NA19726,1171,92,0,1263,92,0.0000,100.0000
NA20530,1177,67,19,1263,86,22.0930,77.9070
NA18566,1153,50,60,1263,110,54.5455,45.4545
HG00442,1183,80,0,1263,80,0.0000,100.0000
NA20534,1184,79,0,1263,79,0.0000,100.0000
NA18874,1165,98,0,1263,98,0.0000,100.0000
HG01052,1113,45,105,1263,150,70.0000,30.0000
NA19914,1123,40,100,1263,140,71.4286,28.5714
NA19108,1119,48,96,1263,144,66.6667,33.3333
NA12874,1191,72,0,1263,72,0.0000,100.0000
HG00127,1150,50,63,1263,113,55.7522,44.2478
HG00320,1159,43,61,1263,104,58.6538,41.3462
HG00376,1162,42,59,1263,101,58.4158,41.5842
NA18974,1185,78,0,1263,78,0.0000,100.0000
NA19117,1161,102,0,1263,102,0.0000,100.0000
HG01623,1157,44,62,1263,106,58.4906,41.5094
NA11994,1183,80,0,1263,80,0.0000,100.0000
NA19222,1104,50,109,1263,159,68.5535,31.4465
NA19197,1102,56,105,1263,161,65.2174,34.7826
HG00096,1186,77,0,1263,77,0.0000,100.0000
NA19747,1190,73,0,1263,73,0.0000,100.0000
NA20298,1168,95,0,1263,95,0.0000,100.0000
NA20516,1189,74,0,1263,74,0.0000,100.0000
NA19038,1101,46,116,1263,162,71.6049,28.3951
NA20754,1202,61,0,1263,61,0.0000,100.0000
NA18603,1184,79,0,1263,79,0.0000,100.0000
NA20816,1188,75,0,1263,75,0.0000,100.0000
NA18861,1109,57,97,1263,154,62.9870,37.0130
NA18534,1177,86,0,1263,86,0.0000,100.0000
NA19770,1151,41,71,1263,112,63.3929,36.6071
NA11892,1160,40,63,1263,103,61.1650,38.8350
NA18954,1153,51,59,1263,110,53.6364,46.3636
NA18559,1189,74,0,1263,74,0.0000,100.0000
NA12058,1153,46,64,1263,110,58.1818,41.8182
NA12842,1191,72,0,1263,72,0.0000,100.0000
HG00238,1151,36,76,1263,112,67.8571,32.1429
NA19209,1108,62,93,1263,155,60.0000,40.0000
NA12006,1168,42,53,1263,95,55.7895,44.2105
HG01183,1149,37,77,1263,114,67.5439,32.4561
NA19078,1149,48,66,1263,114,57.8947,42.1053
HG00662,1186,77,0,1263,77,0.0000,100.0000
NA20810,1190,73,0,1263,73,0.0000,100.0000
NA20507,1154,47,62,1263,109,56.8807,43.1193
NA20294,1120,50,93,1263,143,65.0350,34.9650
NA19137,1098,50,115,1263,165,69.6970,30.3030
HG01360,1144,39,80,1263,119,67.2269,32.7731
HG01167,1174,89,0,1263,89,0.0000,100.0000
NA19146,1159,104,0,1263,104,0.0000,100.0000
HG00102,1167,39,57,1263,96,59.3750,40.6250
NA18987,1150,50,63,1263,113,55.7522,44.2478
NA20532,1196,67,0,1263,67,0.0000,100.0000
NA12843,1161,41,61,1263,102,59.8039,40.1961
NA19346,1148,115,0,1263,115,0.0000,100.0000
NA19471,1084,53,126,1263,179,70.3911,29.6089
HG01383,1179,84,0,1263,84,0.0000,100.0000
NA20515,1193,70,0,1263,70,0.0000,100.0000
HG00407,1162,51,50,1263,101,49.5050,50.4950
HG00242,1189,74,0,1263,74,0.0000,100.0000
HG00530,1182,81,0,1263,81,0.0000,100.0000
NA19685,1180,83,0,1263,83,0.0000,100.0000
HG01067,1150,46,67,1263,113,59.2920,40.7080
NA18960,1179,84,0,1263,84,0.0000,100.0000
NA19923,1124,38,101,1263,139,72.6619,27.3381
NA12413,1190,73,0,1263,73,0.0000,100.0000
NA19700,1161,102,0,1263,102,0.0000,100.0000
HG00253,1157,41,65,1263,106,61.3208,38.6792
NA18628,1158,51,54,1263,105,51.4286,48.5714
NA20332,1127,52,84,1263,136,61.7647,38.2353
NA19138,1175,88,0,1263,88,0.0000,100.0000
NA18637,1182,81,0,1263,81,0.0000,100.0000
NA20581,1188,75,0,1263,75,0.0000,100.0000
NA18647,1180,83,0,1263,83,0.0000,100.0000
NA19308,1162,101,0,1263,101,0.0000,100.0000
NA19058,1186,77,0,1263,77,0.0000,100.0000
NA19746,1134,39,90,1263,129,69.7674,30.2326
HG00155,1191,72,0,1263,72,0.0000,100.0000
HG00265,1193,70,0,1263,70,0.0000,100.0000
HG00177,1166,40,57,1263,97,58.7629,41.2371
NA18570,1142,56,65,1263,121,53.7190,46.2810
HG00443,1153,50,60,1263,110,54.5455,45.4545
NA18873,1122,48,93,1263,141,65.9574,34.0426
NA19654,1156,50,57,1263,107,53.2710,46.7290
NA19000,1184,79,0,1263,79,0.0000,100.0000
NA12750,1183,80,0,1263,80,0.0000,100.0000
NA20519,1192,71,0,1263,71,0.0000,100.0000
NA19443,1168,95,0,1263,95,0.0000,100.0000
NA19779,1144,46,73,1263,119,61.3445,38.6555
NA18748,1190,73,0,1263,73,0.0000,100.0000
NA19920,1154,109,0,1263,109,0.0000,100.0000
NA18576,1158,48,57,1263,105,54.2857,45.7143
NA18523,1115,57,91,1263,148,61.4865,38.5135
HG00611,1152,48,63,1263,111,56.7568,43.2432
NA19054,1148,55,60,1263,115,52.1739,47.8261
NA19079,1189,74,0,1263,74,0.0000,100.0000
NA20819,1148,43,72,1263,115,62.6087,37.3913
NA19318,1145,118,0,1263,118,0.0000,100.0000
HG01521,1190,73,0,1263,73,0.0000,100.0000
NA18942,1150,57,56,1263,113,49.5575,50.4425
HG01082,1171,92,0,1263,92,0.0000,100.0000
NA19235,1104,49,110,1263,159,69.1824,30.8176
HG00445,1185,78,0,1263,78,0.0000,100.0000
HG00160,1191,72,0,1263,72,0.0000,100.0000
NA12045,1187,76,0,1263,76,0.0000,100.0000
HG01437,1188,75,0,1263,75,0.0000,100.0000
NA19684,1158,43,62,1263,105,59.0476,40.9524
NA19121,1166,97,0,1263,97,0.0000,100.0000
NA20291,1159,104,0,1263,104,0.0000,100.0000
HG00114,1180,83,0,1263,83,0.0000,100.0000
NA19648,1160,44,59,1263,103,57.2816,42.7184
HG01072,1180,83,0,1263,83,0.0000,100.0000
HG00566,1152,50,61,1263,111,54.9550,45.0450
NA19664,1184,79,0,1263,79,0.0000,100.0000
NA19057,1147,57,59,1263,116,50.8621,49.1379
NA19474,1089,50,124,1263,174,71.2644,28.7356
NA06986,1184,79,0,1263,79,0.0000,100.0000
NA19225,1114,62,87,1263,149,58.3893,41.6107
HG01495,1147,56,60,1263,116,51.7241,48.2759
NA19085,1176,87,0,1263,87,0.0000,100.0000
HG00324,1152,40,71,1263,111,63.9640,36.0360
NA18957,1153,38,72,1263,110,65.4545,34.5455
NA19380,1151,112,0,1263,112,0.0000,100.0000
NA19152,1105,54,104,1263,158,65.8228,34.1772
NA12400,1151,43,69,1263,112,61.6071,38.3929
NA18853,1168,95,0,1263,95,0.0000,100.0000
HG00319,1157,41,65,1263,106,61.3208,38.6792
HG00138,1190,73,0,1263,73,0.0000,100.0000
NA20771,1161,44,58,1263,102,56.8627,43.1373
NA18948,1186,77,0,1263,77,0.0000,100.0000
HG00672,1157,46,60,1263,106,56.6038,43.3962
HG01378,1154,49,60,1263,109,55.0459,44.9541
HG00274,1154,43,66,1263,109,60.5505,39.4495
NA19160,1157,106,0,1263,106,0.0000,100.0000
NA20314,1150,51,62,1263,113,54.8673,45.1327
HG00313,1150,44,69,1263,113,61.0619,38.9381
HG00543,1159,45,59,1263,104,56.7308,43.2692
NA19070,1181,82,0,1263,82,0.0000,100.0000
NA20797,1169,47,47,1263,94,50.0000,50.0000
HG00542,1195,68,0,1263,68,0.0000,100.0000
NA18539,1162,58,43,1263,101,42.5743,57.4257
HG01344,1190,73,0,1263,73,0.0000,100.0000
NA20588,1190,73,0,1263,73,0.0000,100.0000
NA12761,1162,45,56,1263,101,55.4455,44.5545
HG00577,1185,78,0,1263,78,0.0000,100.0000
HG01620,1153,39,71,1263,110,64.5455,35.4545
NA19661,1179,84,0,1263,84,0.0000,100.0000
NA12763,1149,33,81,1263,114,71.0526,28.9474
NA07051,1186,77,0,1263,77,0.0000,100.0000
HG01198,1143,45,75,1263,120,62.5000,37.5000
NA18968,1161,50,52,1263,102,50.9804,49.0196
NA18998,1152,50,61,1263,111,54.9550,45.0450
NA10851,1192,71,0,1263,71,0.0000,100.0000
NA18563,1178,85,0,1263,85,0.0000,100.0000
HG00273,1197,66,0,1263,66,0.0000,100.0000
NA18593,1150,55,58,1263,113,51.3274,48.6726
HG01441,1154,47,62,1263,109,56.8807,43.1193
HG01384,1135,47,81,1263,128,63.2813,36.7188
NA19020,1175,88,0,1263,88,0.0000,100.0000
NA19379,1103,48,112,1263,160,70.0000,30.0000
NA18871,1160,103,0,1263,103,0.0000,100.0000
NA19315,1100,59,104,1263,163,63.8037,36.1963
HG01060,1168,95,0,1263,95,0.0000,100.0000
NA20299,1110,37,116,1263,153,75.8170,24.1830
NA19900,1159,104,0,1263,104,0.0000,100.0000
NA07037,1154,41,68,1263,109,62.3853,37.6147
NA20790,1152,39,72,1263,111,64.8649,35.1351
NA19707,1136,43,84,1263,127,66.1417,33.8583
NA19374,1156,107,0,1263,107,0.0000,100.0000
NA19312,1157,106,0,1263,106,0.0000,100.0000
HG01354,1159,41,63,1263,104,60.5769,39.4231
NA20340,1153,110,0,1263,110,0.0000,100.0000
NA19455,1141,122,0,1263,122,0.0000,100.0000
NA20807,1163,38,62,1263,100,62.0000,38.0000
NA18757,1184,79,0,1263,79,0.0000,100.0000
NA19735,1187,76,0,1263,76,0.0000,100.0000
NA18486,1162,101,0,1263,101,0.0000,100.0000
HG00256,1183,80,0,1263,80,0.0000,100.0000
NA20795,1160,46,57,1263,103,55.3398,44.6602
NA18645,1181,82,0,1263,82,0.0000,100.0000
NA20758,1187,76,0,1263,76,0.0000,100.0000
NA11992,1195,68,0,1263,68,0.0000,100.0000
NA19066,1179,84,0,1263,84,0.0000,100.0000
NA18511,1105,54,104,1263,158,65.8228,34.1772
NA19081,1161,50,52,1263,102,50.9804,49.0196
HG00117,1191,72,0,1263,72,0.0000,100.0000
NA19056,1172,91,0,1263,91,0.0000,100.0000
NA19129,1096,49,118,1263,167,70.6587,29.3413
HG00309,1155,34,74,1263,108,68.5185,31.4815
NA12814,1200,63,0,1263,63,0.0000,100.0000
NA19437,1117,47,99,1263,146,67.8082,32.1918
HG01494,1191,72,0,1263,72,0.0000,100.0000
NA19004,1180,83,0,1263,83,0.0000,100.0000
HG00282,1149,48,66,1263,114,57.8947,42.1053
HG00384,1165,43,55,1263,98,56.1224,43.8776
HG00281,1150,53,60,1263,113,53.0973,46.9027
NA18522,1159,104,0,1263,104,0.0000,100.0000
NA19072,1189,74,0,1263,74,0.0000,100.0000
NA12287,1159,48,56,1263,104,53.8462,46.1538
HG00361,1184,53,26,1263,79,32.9114,67.0886
NA12383,1144,47,72,1263,119,60.5042,39.4958
NA19175,1168,95,0,1263,95,0.0000,100.0000
NA20505,1160,38,65,1263,103,63.1068,36.8932
NA19741,1191,72,0,1263,72,0.0000,100.0000
HG01104,1186,77,0,1263,77,0.0000,100.0000
NA19063,1194,69,0,1263,69,0.0000,100.0000
NA20757,1160,50,53,1263,103,51.4563,48.5437
NA11931,1159,43,61,1263,104,58.6538,41.3462
NA11930,1187,76,0,1263,76,0.0000,100.0000
HG00478,1186,77,0,1263,77,0.0000,100.0000
NA18516,1159,104,0,1263,104,0.0000,100.0000
NA20536,1190,73,0,1263,73,0.0000,100.0000
NA19331,1165,98,0,1263,98,0.0000,100.0000
HG00257,1156,48,59,1263,107,55.1402,44.8598
HG00254,1163,41,59,1263,100,59.0000,41.0000
NA18535,1152,49,62,1263,111,55.8559,44.1441
NA18984,1177,86,0,1263,86,0.0000,100.0000
NA19060,1188,75,0,1263,75,0.0000,100.0000
NA20524,1186,77,0,1263,77,0.0000,100.0000
NA12043,1193,70,0,1263,70,0.0000,100.0000
HG00174,1147,47,69,1263,116,59.4828,40.5172
HG01069,1186,77,0,1263,77,0.0000,100.0000
NA11830,1167,47,49,1263,96,51.0417,48.9583
HG00131,1195,68,0,1263,68,0.0000,100.0000
HG00129,1190,73,0,1263,73,0.0000,100.0000
NA20759,1196,67,0,1263,67,0.0000,100.0000
NA12342,1184,79,0,1263,79,0.0000,100.0000
NA20798,1197,66,0,1263,66,0.0000,100.0000
HG01080,1148,37,78,1263,115,67.8261,32.1739
NA18504,1162,101,0,1263,101,0.0000,100.0000
NA19213,1155,108,0,1263,108,0.0000,100.0000
NA18989,1184,79,0,1263,79,0.0000,100.0000
HG00422,1157,60,46,1263,106,43.3962,56.6038
NA20509,1195,68,0,1263,68,0.0000,100.0000
NA18508,1122,47,94,1263,141,66.6667,33.3333
HG00328,1155,43,65,1263,108,60.1852,39.8148
NA19984,1178,85,0,1263,85,0.0000,100.0000
HG00607,1180,83,0,1263,83,0.0000,100.0000
NA19005,1183,80,0,1263,80,0.0000,100.0000
NA20766,1141,42,80,1263,122,65.5738,34.4262
NA18639,1193,70,0,1263,70,0.0000,100.0000
HG01353,1187,76,0,1263,76,0.0000,100.0000
NA20799,1163,36,64,1263,100,64.0000,36.0000
NA19324,1107,47,109,1263,156,69.8718,30.1282
NA20527,1193,70,0,1263,70,0.0000,100.0000
NA18988,1176,87,0,1263,87,0.0000,100.0000
HG00187,1198,65,0,1263,65,0.0000,100.0000
NA18620,1179,84,0,1263,84,0.0000,100.0000
NA19921,1118,43,102,1263,145,70.3448,29.6552
NA19818,1162,101,0,1263,101,0.0000,100.0000
NA19440,1106,62,95,1263,157,60.5096,39.4904
NA18944,1175,88,0,1263,88,0.0000,100.0000
NA20808,1150,51,62,1263,113,54.8673,45.1327
NA19150,1152,111,0,1263,111,0.0000,100.0000
NA19728,1155,53,55,1263,108,50.9259,49.0741
HG00406,1180,83,0,1263,83,0.0000,100.0000
NA18545,1150,56,57,1263,113,50.4425,49.5575
NA18536,1188,75,0,1263,75,0.0000,100.0000
NA20811,1188,75,0,1263,75,0.0000,100.0000
HG00689,1187,76,0,1263,76,0.0000,100.0000
NA19470,1105,49,109,1263,158,68.9873,31.0127
NA19088,1186,77,0,1263,77,0.0000,100.0000
HG00270,1158,47,58,1263,105,55.2381,44.7619
NA19248,1164,99,0,1263,99,0.0000,100.0000
NA20537,1194,69,0,1263,69,0.0000,100.0000
NA06994,1185,78,0,1263,78,0.0000,100.0000
NA19404,1105,56,102,1263,158,64.5570,35.4430
NA19764,1151,53,59,1263,112,52.6786,47.3214
NA20818,1162,46,55,1263,101,54.4554,45.5446
HG00097,1152,41,70,1263,111,63.0631,36.9369
HG00475,1190,73,0,1263,73,0.0000,100.0000
HG00118,1159,44,60,1263,104,57.6923,42.3077
HG00513,1152,57,54,1263,111,48.6486,51.3514
NA18631,1139,55,69,1263,124,55.6452,44.3548
NA18975,1157,39,67,1263,106,63.2075,36.7925
HG01345,1155,38,70,1263,108,64.8148,35.1852
HG00737,1141,37,85,1263,122,69.6721,30.3279
HG01619,1201,62,0,1263,62,0.0000,100.0000
HG00259,1161,45,57,1263,102,55.8824,44.1176
NA20772,1156,39,68,1263,107,63.5514,36.4486
HG00188,1185,78,0,1263,78,0.0000,100.0000
NA12144,1186,77,0,1263,77,0.0000,100.0000
NA20768,1158,49,56,1263,105,53.3333,46.6667
HG00626,1162,55,46,1263,101,45.5446,54.4554
HG00277,1197,66,0,1263,66,0.0000,100.0000
NA18599,1150,54,59,1263,113,52.2124,47.7876
HG00707,1186,77,0,1263,77,0.0000,100.0000
NA18973,1164,48,51,1263,99,51.5152,48.4848
NA20787,1185,78,0,1263,78,0.0000,100.0000
HG00134,1157,39,67,1263,106,63.2075,36.7925
HG00620,1156,44,63,1263,107,58.8785,41.1215
HG00625,1181,82,0,1263,82,0.0000,100.0000
HG00182,1184,79,0,1263,79,0.0000,100.0000
NA18740,1185,78,0,1263,78,0.0000,100.0000
HG00534,1146,65,52,1263,117,44.4444,55.5556
NA19065,1153,47,63,1263,110,57.2727,42.7273
HG00512,1177,86,0,1263,86,0.0000,100.0000
HG00356,1163,36,64,1263,100,64.0000,36.0000
NA20504,1157,45,61,1263,106,57.5472,42.4528
HG00332,1155,48,60,1263,108,55.5556,44.4444
NA19352,1158,105,0,1263,105,0.0000,100.0000
NA18966,1179,84,0,1263,84,0.0000,100.0000
NA18612,1189,74,0,1263,74,0.0000,100.0000
HG00263,1159,43,61,1263,104,58.6538,41.3462
HG00359,1166,37,60,1263,97,61.8557,38.1443
HG00141,1183,80,0,1263,80,0.0000,100.0000
HG01274,1188,75,0,1263,75,0.0000,100.0000
NA19247,1113,64,86,1263,150,57.3333,42.6667
NA18633,1183,80,0,1263,80,0.0000,100.0000
HG01515,1189,74,0,1263,74,0.0000,100.0000
HG01047,1190,73,0,1263,73,0.0000,100.0000
NA18981,1151,50,62,1263,112,55.3571,44.6429
NA19107,1152,111,0,1263,111,0.0000,100.0000
NA19118,1131,47,85,1263,132,64.3939,35.6061
HG00608,1160,46,57,1263,103,55.3398,44.6602
NA19200,1159,104,0,1263,104,0.0000,100.0000
NA18611,1179,84,0,1263,84,0.0000,100.0000
NA19794,1146,39,78,1263,117,66.6667,33.3333
NA07000,1159,44,60,1263,104,57.6923,42.3077
NA19652,1188,75,0,1263,75,0.0000,100.0000
NA20765,1191,72,0,1263,72,0.0000,100.0000
NA18537,1162,50,51,1263,101,50.4950,49.5050
NA19068,1179,84,0,1263,84,0.0000,100.0000
HG00237,1149,37,77,1263,114,67.5439,32.4561
NA19334,1150,113,0,1263,113,0.0000,100.0000
NA20803,1193,70,0,1263,70,0.0000,100.0000
NA19390,1117,43,103,1263,146,70.5479,29.4521
HG01173,1189,74,0,1263,74,0.0000,100.0000
NA12812,1188,75,0,1263,75,0.0000,100.0000
HG00264,1180,83,0,1263,83,0.0000,100.0000
NA19436,1101,62,100,1263,162,61.7284,38.2716
HG01066,1182,81,0,1263,81,0.0000,100.0000
NA12272,1196,67,0,1263,67,0.0000,100.0000
NA20801,1186,77,0,1263,77,0.0000,100.0000
NA20521,1194,69,0,1263,69,0.0000,100.0000
NA18553,1159,54,50,1263,104,48.0769,51.9231
HG00180,1156,45,62,1263,107,57.9439,42.0561
HG01617,1198,65,0,1263,65,0.0000,100.0000
HG00525,1147,47,69,1263,116,59.4828,40.5172
NA19444,1173,90,0,1263,90,0.0000,100.0000
NA19385,1166,97,0,1263,97,0.0000,100.0000
NA19457,1095,53,115,1263,168,68.4524,31.5476
NA19223,1158,105,0,1263,105,0.0000,100.0000
NA07347,1179,84,0,1263,84,0.0000,100.0000
NA18980,1154,49,60,1263,109,55.0459,44.9541
NA19055,1187,76,0,1263,76,0.0000,100.0000
HG01137,1147,47,69,1263,116,59.4828,40.5172
NA18961,1186,77,0,1263,77,0.0000,100.0000
NA20804,1157,36,70,1263,106,66.0377,33.9623
NA18487,1153,110,0,1263,110,0.0000,100.0000
NA20339,1107,55,101,1263,156,64.7436,35.2564
HG01498,1157,42,64,1263,106,60.3774,39.6226
HG00246,1186,77,0,1263,77,0.0000,100.0000
HG00104,1160,32,71,1263,103,68.9320,31.0680
HG00336,1178,85,0,1263,85,0.0000,100.0000
NA18501,1163,100,0,1263,100,0.0000,100.0000
HG00327,1151,40,72,1263,112,64.2857,35.7143
HG00103,1185,78,0,1263,78,0.0000,100.0000
NA18572,1183,80,0,1263,80,0.0000,100.0000
NA19075,1184,79,0,1263,79,0.0000,100.0000
HG01112,1185,78,0,1263,78,0.0000,100.0000
HG00341,1194,69,0,1263,69,0.0000,100.0000
NA20778,1177,86,0,1263,86,0.0000,100.0000
HG00250,1147,51,65,1263,116,56.0345,43.9655
NA18643,1176,87,0,1263,87,0.0000,100.0000
HG01073,1141,45,77,1263,122,63.1148,36.8852
HG00249,1158,38,67,1263,105,63.8095,36.1905
NA18870,1117,47,99,1263,146,67.8082,32.1918
HG00126,1183,80,0,1263,80,0.0000,100.0000
HG00671,1184,79,0,1263,79,0.0000,100.0000
NA12286,1186,77,0,1263,77,0.0000,100.0000
HG01334,1185,78,0,1263,78,0.0000,100.0000
NA19466,1162,101,0,1263,101,0.0000,100.0000
HG00427,1184,79,0,1263,79,0.0000,100.0000
HG01440,1184,79,0,1263,79,0.0000,100.0000
NA20533,1169,48,46,1263,94,48.9362,51.0638
NA19313,1118,53,92,1263,145,63.4483,36.5517
HG01522,1150,49,64,1263,113,56.6372,43.3628
HG01257,1149,39,75,1263,114,65.7895,34.2105
NA20538,1187,76,0,1263,76,0.0000,100.0000
NA19083,1173,90,0,1263,90,0.0000,100.0000
HG00260,1190,73,0,1263,73,0.0000,100.0000
HG00137,1165,38,60,1263,98,61.2245,38.7755
NA19351,1121,51,91,1263,142,64.0845,35.9155
NA20783,1179,84,0,1263,84,0.0000,100.0000
NA19010,1153,54,56,1263,110,50.9091,49.0909
NA18538,1150,49,64,1263,113,56.6372,43.3628
NA19655,1182,81,0,1263,81,0.0000,100.0000
NA19002,1158,55,50,1263,105,47.6190,52.3810
HG00326,1156,50,57,1263,107,53.2710,46.7290
NA18622,1193,70,0,1263,70,0.0000,100.0000
NA18560,1150,44,69,1263,113,61.0619,38.9381
NA18547,1159,51,53,1263,104,50.9615,49.0385
NA19062,1176,87,0,1263,87,0.0000,100.0000
NA20363,1104,50,109,1263,159,68.5535,31.4465
NA12775,1184,79,0,1263,79,0.0000,100.0000
NA20346,1159,104,0,1263,104,0.0000,100.0000
NA20540,1165,38,60,1263,98,61.2245,38.7755
NA19755,1154,43,66,1263,109,60.5505,39.4495
NA20535,1164,43,56,1263,99,56.5657,43.4343
NA18596,1151,48,64,1263,112,57.1429,42.8571
HG00142,1189,74,0,1263,74,0.0000,100.0000
HG00373,1163,42,58,1263,100,58.0000,42.0000
NA12283,1161,40,62,1263,102,60.7843,39.2157
NA19672,1150,41,72,1263,113,63.7168,36.2832
NA19311,1165,98,0,1263,98,0.0000,100.0000
NA18532,1153,56,54,1263,110,49.0909,50.9091
HG00369,1190,73,0,1263,73,0.0000,100.0000
NA12044,1163,46,54,1263,100,54.0000,46.0000
NA19462,1106,57,100,1263,157,63.6943,36.3057
HG00123,1160,45,58,1263,103,56.3107,43.6893
NA20510,1192,71,0,1263,71,0.0000,100.0000
NA18950,1151,54,58,1263,112,51.7857,48.2143
HG01390,1119,50,94,1263,144,65.2778,34.7222
HG00595,1178,85,0,1263,85,0.0000,100.0000
HG00355,1159,34,70,1263,104,67.3077,32.6923
NA19795,1185,78,0,1263,78,0.0000,100.0000
NA18582,1158,44,61,1263,105,58.0952,41.9048
HG00284,1186,77,0,1263,77,0.0000,100.0000
NA19780,1174,89,0,1263,89,0.0000,100.0000
HG00285,1157,46,60,1263,106,56.6038,43.3962
NA19012,1180,83,0,1263,83,0.0000,100.0000
HG00234,1193,70,0,1263,70,0.0000,100.0000
HG00136,1192,71,0,1263,71,0.0000,100.0000
HG01462,1135,44,84,1263,128,65.6250,34.3750
NA18571,1153,53,57,1263,110,51.8182,48.1818
NA19396,1101,48,114,1263,162,70.3704,29.6296
HG00349,1170,37,56,1263,93,60.2151,39.7849
NA12003,1192,71,0,1263,71,0.0000,100.0000
HG00318,1163,44,56,1263,100,56.0000,44.0000
HG00372,1186,77,0,1263,77,0.0000,100.0000
NA19102,1102,56,105,1263,161,65.2174,34.7826
NA19439,1118,49,96,1263,145,66.2069,33.7931


2025-01-25 06:32:28 - root - INFO - Please check the answer again by reviewing Extract genotype data for single nucleotide polymorphisms (SNPs) from chromosome X , ensuring that the start positions are not between 59999 and 2699519 nor between 154931042 and 155260559.   Output the sample ID, counts of homozygous reference alleles, homozygous alternate alleles, heterozygous alternate alleles, the total number of callable sites, the total number of SNVs,  the percentage of heterozygous alternate alleles among all SNVs, and the percentage of homozygous alternate alleles among all SNVs., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To extract the genotype data for single nucleotide polymorphisms (SNPs) from chromosome X, excluding the specified regions, we would compile the counts and percentages for each sample as follows:

```csv
sample_id,homozygous_reference_alleles,homozygous_alternate_alleles,heterozygous_alternate_alleles,total_callable_sites,total_SNVs,percentage_heterozygous_alternate_alleles,percentage_homozygous_alternate_alleles
sample_id1:str,count1:int,count2:int,count3:int,total_sites1:int,total_snvs1:int,percentage1:float (0<=float<=100),percentage2:float (0<=float<=100)
sample_id2:str,count1:int,count2:int,count3:int,total_sites2:int,total_snvs2:int,percentage1:float (0<=float<=100),percentage2:float (0<=float<=100)
...
```

- **sample_id**: The identifier for each sample (string).
- **homozygous_reference_alleles**: Count of sites where the sample has homozygous reference alleles (integer).
- **homozygous_alternate_alleles**: Count of sites where the sample has homozygous alternate alleles (integer).
- **heterozygous_alternate_alleles**: Count of sites where the sample has heterozygous alternate alleles (integer).
- **total_callable_sites**: Total number of sites that are callable (integer).
- **total_SNVs**: Total number of single nucleotide variants (SNVs) observed in the sample (integer).
- **percentage_heterozygous_alternate_alleles**: Percentage of heterozygous alternate alleles among all SNVs (float between 0 and 100).
- **percentage_homozygous_alternate_alleles**: Percentage of homozygous alternate alleles among all SNVs (float between 0 and 100).

This format provides a clear and concise representation of the genotype data per sample, adhering to the specified requirements. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
SAMPLE_ID,HOMOZYGOUS_REFERENCE_ALLELES,HOMOZYGOUS_ALTERNATE_ALLELES,HETEROZYGOUS_ALTERNATE_ALLELES,TOTAL_CALLABLE_SITES,TOTAL_SNVS,PERCENTAGE_HETEROZYGOUS_ALTERNATE_ALLELES,PERCENTAGE_HOMOZYGOUS_ALTERNATE_ALLELES
HG00351,1185,78,0,1263,78,0.0000,100.0000
NA19834,1173,90,0,1263,90,0.0000,100.0000
NA19087,1154,56,53,1263,109,48.6239,51.3761
NA18910,1157,106,0,1263,106,0.0000,100.0000
HG01148,1180,83,0,1263,83,0.0000,100.0000
HG00428,1150,51,62,1263,113,54.8673,45.1327
HG00640,1186,77,0,1263,77,0.0000,100.0000
NA20543,1193,70,0,1263,70,0.0000,100.0000
HG00110,1161,45,57,1263,102,55.8824,44.1176
NA18498,1158,105,0,1263,105,0.0000,100.0000
NA19080,1157,44,62,1263,106,58.4906,41.5094
NA19738,1178,85,0,1263,85,0.0000,100.0000
HG01174,1147,42,74,1263,116,63.7931,36.2069
NA12275,1161,42,60,1263,102,58.8235,41.1765
NA19434,1108,53,102,1263,155,65.8065,34.1935
NA20322,1112,49,102,1263,151,67.5497,32.4503
NA18561,1175,88,0,1263,88,0.0000,100.0000
NA18995,1197,66,0,1263,66,0.0000,100.0000
NA19719,1147,42,74,1263,116,63.7931,36.2069
HG01102,1152,44,67,1263,111,60.3604,39.6396
HG00183,1185,78,0,1263,78,0.0000,100.0000
NA20752,1186,77,0,1263,77,0.0000,100.0000
NA18567,1145,53,65,1263,118,55.0847,44.9153
NA19917,1100,61,102,1263,163,62.5767,37.4233
HG00650,1174,89,0,1263,89,0.0000,100.0000
NA18606,1191,72,0,1263,72,0.0000,100.0000
NA19391,1128,54,81,1263,135,60.0000,40.0000
NA20336,1119,44,100,1263,144,69.4444,30.5556
NA20755,1188,75,0,1263,75,0.0000,100.0000
NA19403,1120,51,92,1263,143,64.3357,35.6643
HG00557,1159,54,50,1263,104,48.0769,51.9231
NA20278,1156,107,0,1263,107,0.0000,100.0000
NA20522,1152,39,72,1263,111,64.8649,35.1351
NA19399,1099,62,102,1263,164,62.1951,37.8049
HG00705,1154,50,59,1263,109,54.1284,45.8716
NA19036,1114,57,92,1263,149,61.7450,38.2550
NA18868,1161,102,0,1263,102,0.0000,100.0000
NA18978,1159,37,67,1263,104,64.4231,35.5769
NA19377,1098,59,106,1263,165,64.2424,35.7576
NA11932,1193,70,0,1263,70,0.0000,100.0000
HG01491,1192,71,0,1263,71,0.0000,100.0000
NA11829,1197,66,0,1263,66,0.0000,100.0000
NA12347,1193,70,0,1263,70,0.0000,100.0000
HG00306,1164,36,63,1263,99,63.6364,36.3636
NA20503,1155,43,65,1263,108,60.1852,39.8148
NA18555,1144,52,67,1263,119,56.3025,43.6975
NA19720,1171,92,0,1263,92,0.0000,100.0000
NA19789,1171,92,0,1263,92,0.0000,100.0000
NA19740,1148,47,68,1263,115,59.1304,40.8696
NA19762,1186,77,0,1263,77,0.0000,100.0000
HG00451,1178,85,0,1263,85,0.0000,100.0000
NA19316,1094,55,114,1263,169,67.4556,32.5444
HG00358,1195,68,0,1263,68,0.0000,100.0000
NA20512,1192,71,0,1263,71,0.0000,100.0000
NA19682,1186,77,0,1263,77,0.0000,100.0000
HG01461,1172,91,0,1263,91,0.0000,100.0000
HG01108,1126,58,79,1263,137,57.6642,42.3358
NA18642,1162,43,58,1263,101,57.4257,42.5743
NA18946,1149,53,61,1263,114,53.5088,46.4912
NA18614,1147,57,59,1263,116,50.8621,49.1379
HG00345,1179,84,0,1263,84,0.0000,100.0000
HG00262,1171,45,47,1263,92,51.0870,48.9130
HG00446,1152,48,63,1263,111,56.7568,43.2432
HG00736,1195,68,0,1263,68,0.0000,100.0000
HG01107,1179,84,0,1263,84,0.0000,100.0000
HG00578,1141,45,77,1263,122,63.1148,36.8852
NA12716,1193,70,0,1263,70,0.0000,100.0000
NA18574,1149,51,63,1263,114,55.2632,44.7368
NA18945,1192,71,0,1263,71,0.0000,100.0000
NA18923,1157,106,0,1263,106,0.0000,100.0000
NA19185,1112,44,107,1263,151,70.8609,29.1391
NA20513,1191,72,0,1263,72,0.0000,100.0000
NA19785,1152,42,69,1263,111,62.1622,37.8378
HG00247,1145,43,75,1263,118,63.5593,36.4407
NA19310,1109,52,102,1263,154,66.2338,33.7662
NA19786,1185,78,0,1263,78,0.0000,100.0000
NA18908,1148,115,0,1263,115,0.0000,100.0000
NA20528,1185,78,0,1263,78,0.0000,100.0000
HG01124,1184,79,0,1263,79,0.0000,100.0000
HG01113,1160,40,63,1263,103,61.1650,38.8350
NA18602,1149,49,65,1263,114,57.0175,42.9825
HG00663,1158,54,51,1263,105,48.5714,51.4286
HG01095,1138,35,90,1263,125,72.0000,28.0000
NA12546,1187,76,0,1263,76,0.0000,100.0000
HG00312,1186,77,0,1263,77,0.0000,100.0000
NA20802,1149,34,80,1263,114,70.1754,29.8246
NA18610,1160,45,58,1263,103,56.3107,43.6893
NA20812,1188,75,0,1263,75,0.0000,100.0000
HG01488,1190,73,0,1263,73,0.0000,100.0000
NA18623,1179,84,0,1263,84,0.0000,100.0000
NA20317,1099,50,114,1263,164,69.5122,30.4878
NA12249,1170,48,45,1263,93,48.3871,51.6129
HG00121,1163,44,56,1263,100,56.0000,44.0000
NA19734,1155,53,55,1263,108,50.9259,49.0741
HG00111,1163,41,59,1263,100,59.0000,41.0000
NA18550,1154,54,55,1263,109,50.4587,49.5413
HG00382,1191,72,0,1263,72,0.0000,100.0000
HG01516,1157,48,58,1263,106,54.7170,45.2830
NA06989,1159,45,59,1263,104,56.7308,43.2692
HG00362,1175,43,45,1263,88,51.1364,48.8636
NA10847,1159,41,63,1263,104,60.5769,39.4231
NA18745,1180,83,0,1263,83,0.0000,100.0000
HG00596,1148,50,65,1263,115,56.5217,43.4783
NA12889,1197,66,0,1263,66,0.0000,100.0000
HG01101,1182,81,0,1263,81,0.0000,100.0000
NA19753,1183,80,0,1263,80,0.0000,100.0000
HG00156,1186,77,0,1263,77,0.0000,100.0000
HG00404,1159,46,58,1263,104,55.7692,44.2308
HG00236,1151,48,64,1263,112,57.1429,42.8571
NA19095,1119,48,96,1263,144,66.6667,33.3333
HG00112,1185,78,0,1263,78,0.0000,100.0000
HG00251,1182,81,0,1263,81,0.0000,100.0000
NA18526,1156,49,58,1263,107,54.2056,45.7944
HG00559,1183,80,0,1263,80,0.0000,100.0000
HG00536,1188,75,0,1263,75,0.0000,100.0000
NA19098,1162,101,0,1263,101,0.0000,100.0000
NA19675,1154,41,68,1263,109,62.3853,37.6147
NA19207,1156,107,0,1263,107,0.0000,100.0000
NA18546,1177,86,0,1263,86,0.0000,100.0000
NA18959,1185,78,0,1263,78,0.0000,100.0000
HG00449,1150,51,62,1263,113,54.8673,45.1327
HG00524,1176,87,0,1263,87,0.0000,100.0000
NA07048,1191,72,0,1263,72,0.0000,100.0000
NA20296,1109,52,102,1263,154,66.2338,33.7662
HG00378,1162,41,60,1263,101,59.4059,40.5941
NA18543,1181,82,0,1263,82,0.0000,100.0000
HG01342,1108,43,112,1263,155,72.2581,27.7419
NA20517,1153,48,62,1263,110,56.3636,43.6364
NA18977,1181,82,0,1263,82,0.0000,100.0000
HG00500,1181,82,0,1263,82,0.0000,100.0000
HG00128,1163,42,58,1263,100,58.0000,42.0000
NA20792,1191,72,0,1263,72,0.0000,100.0000
HG00464,1147,52,64,1263,116,55.1724,44.8276
NA19468,1116,52,95,1263,147,64.6259,35.3741
HG00458,1161,47,55,1263,102,53.9216,46.0784
NA19676,1174,89,0,1263,89,0.0000,100.0000
NA19657,1153,49,61,1263,110,55.4545,44.5455
NA12489,1160,47,56,1263,103,54.3689,45.6311
NA19059,1153,53,57,1263,110,51.8182,48.1818
NA19317,1164,99,0,1263,99,0.0000,100.0000
NA18564,1154,53,56,1263,109,51.3761,48.6239
HG00275,1156,45,62,1263,107,57.9439,42.0561
HG01051,1162,101,0,1263,101,0.0000,100.0000
NA20334,1117,49,97,1263,146,66.4384,33.5616
HG00342,1198,65,0,1263,65,0.0000,100.0000
NA19449,1107,53,103,1263,156,66.0256,33.9744
HG01278,1149,39,75,1263,114,65.7895,34.2105
HG01489,1152,41,70,1263,111,63.0631,36.9369
HG00189,1197,66,0,1263,66,0.0000,100.0000
NA07357,1180,83,0,1263,83,0.0000,100.0000
NA18964,1156,50,57,1263,107,53.2710,46.7290
HG00537,1155,61,47,1263,108,43.5185,56.4815
HG01187,1168,95,0,1263,95,0.0000,100.0000
HG00554,1151,52,60,1263,112,53.5714,46.4286
NA19782,1155,49,59,1263,108,54.6296,45.3704
NA20539,1189,74,0,1263,74,0.0000,100.0000
NA20359,1100,47,116,1263,163,71.1656,28.8344
NA20542,1150,43,70,1263,113,61.9469,38.0531
NA18517,1093,51,119,1263,170,70.0000,30.0000
NA19908,1161,102,0,1263,102,0.0000,100.0000
NA18990,1178,85,0,1263,85,0.0000,100.0000
HG00377,1172,48,43,1263,91,47.2527,52.7473
NA19147,1112,56,95,1263,151,62.9139,37.0861
HG01061,1143,46,74,1263,120,61.6667,38.3333
NA12273,1156,42,65,1263,107,60.7477,39.2523
NA12778,1151,41,71,1263,112,63.3929,36.6071
NA12872,1197,66,0,1263,66,0.0000,100.0000
HG00268,1171,41,51,1263,92,55.4348,44.5652
HG01251,1150,38,75,1263,113,66.3717,33.6283
NA12282,1190,73,0,1263,73,0.0000,100.0000
NA19041,1154,109,0,1263,109,0.0000,100.0000
NA20770,1192,71,0,1263,71,0.0000,100.0000
NA11993,1157,35,71,1263,106,66.9811,33.0189
HG00140,1184,79,0,1263,79,0.0000,100.0000
NA18562,1180,83,0,1263,83,0.0000,100.0000
HG00457,1193,70,0,1263,70,0.0000,100.0000
HG01136,1180,83,0,1263,83,0.0000,100.0000
NA18609,1179,84,0,1263,84,0.0000,100.0000
HG00244,1183,80,0,1263,80,0.0000,100.0000
HG00353,1159,43,61,1263,104,58.6538,41.3462
HG01168,1163,38,62,1263,100,62.0000,38.0000
HG00125,1154,42,67,1263,109,61.4679,38.5321
NA19171,1149,114,0,1263,114,0.0000,100.0000
NA20773,1166,36,61,1263,97,62.8866,37.1134
NA18858,1101,51,111,1263,162,68.5185,31.4815
NA19064,1160,54,49,1263,103,47.5728,52.4272
NA20506,1183,67,13,1263,80,16.2500,83.7500
HG00325,1187,76,0,1263,76,0.0000,100.0000
HG01171,1144,40,79,1263,119,66.3866,33.6134
HG00556,1172,91,0,1263,91,0.0000,100.0000
NA20281,1161,102,0,1263,102,0.0000,100.0000
NA18565,1160,46,57,1263,103,55.3398,44.6602
HG00101,1187,76,0,1263,76,0.0000,100.0000
NA19660,1148,48,67,1263,115,58.2609,41.7391
HG00553,1172,91,0,1263,91,0.0000,100.0000
HG00335,1194,69,0,1263,69,0.0000,100.0000
HG00338,1191,72,0,1263,72,0.0000,100.0000
NA18548,1177,86,0,1263,86,0.0000,100.0000
NA18867,1106,48,109,1263,157,69.4268,30.5732
NA20356,1169,94,0,1263,94,0.0000,100.0000
NA19067,1187,76,0,1263,76,0.0000,100.0000
NA18983,1182,81,0,1263,81,0.0000,100.0000
NA19982,1150,113,0,1263,113,0.0000,100.0000
NA18544,1172,91,0,1263,91,0.0000,100.0000
NA18627,1162,48,53,1263,101,52.4752,47.5248
HG00651,1163,52,48,1263,100,48.0000,52.0000
NA19678,1147,47,69,1263,116,59.4828,40.5172
NA20785,1193,70,0,1263,70,0.0000,100.0000
NA19428,1160,103,0,1263,103,0.0000,100.0000
HG00740,1151,42,70,1263,112,62.5000,37.5000
HG00119,1186,77,0,1263,77,0.0000,100.0000
NA18634,1151,45,67,1263,112,59.8214,40.1786
NA19082,1191,72,0,1263,72,0.0000,100.0000
NA18541,1148,49,66,1263,115,57.3913,42.6087
HG00581,1147,48,68,1263,116,58.6207,41.3793
NA18638,1186,77,0,1263,77,0.0000,100.0000
HG01277,1185,78,0,1263,78,0.0000,100.0000
HG01465,1170,39,54,1263,93,58.0645,41.9355
NA18592,1154,54,55,1263,109,50.4587,49.5413
HG00239,1169,40,54,1263,94,57.4468,42.5532
NA19625,1108,46,109,1263,155,70.3226,29.6774
NA19360,1157,106,0,1263,106,0.0000,100.0000
HG00610,1174,89,0,1263,89,0.0000,100.0000
HG00255,1163,49,51,1263,100,51.0000,49.0000
NA20809,1194,69,0,1263,69,0.0000,100.0000
NA20756,1154,45,64,1263,109,58.7156,41.2844
NA19448,1165,98,0,1
Current sql:
SELECT
  sample_id,
  SUM(homo_ref) AS homozygous_reference_alleles,
  SUM(homo_alt) AS homozygous_alternate_alleles,
  SUM(het_alt) AS heterozygous_alternate_alleles,
  COUNT(*) AS total_callable_sites,
  SUM(homo_alt + het_alt) AS total_SNVs,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN ROUND((SUM(het_alt) / SUM(homo_alt + het_alt)) * 100, 4)
    ELSE 0
  END AS percentage_heterozygous_alternate_alleles,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN ROUND((SUM(homo_alt) / SUM(homo_alt + het_alt)) * 100, 4)
    ELSE 0
  END AS percentage_homozygous_alternate_alleles
FROM (
  SELECT
    f.value:"call_set_name"::STRING AS sample_id,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_ref,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1] THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_alt,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] != f.value:"genotype"[1] AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL THEN 1
          ELSE 0
        END
      ELSE 0
    END AS het_alt
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND t."start" NOT BETWEEN 60000 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
) sub
GROUP BY sample_id;
2025-01-25 06:34:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:34:21 - root - INFO - ```sql
SELECT
  sample_id,
  SUM(homo_ref) AS homozygous_reference_alleles,
  SUM(homo_alt) AS homozygous_alternate_alleles,
  SUM(het_alt) AS heterozygous_alternate_alleles,
  COUNT(*) AS total_callable_sites,
  SUM(homo_alt + het_alt) AS total_SNVs,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN ROUND((SUM(het_alt) / SUM(homo_alt + het_alt)) * 100, 4)
    ELSE 0
  END AS percentage_heterozygous_alternate_alleles,
  CASE
    WHEN SUM(homo_alt + het_alt) > 0 THEN ROUND((SUM(homo_alt) / SUM(homo_alt + het_alt)) * 100, 4)
    ELSE 0
  END AS percentage_homozygous_alternate_alleles
FROM (
  SELECT
    f.value:"call_set_name"::STRING AS sample_id,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] = 0 AND f.value:"genotype"[1] = 0 THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_ref,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 1 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 THEN 1
          ELSE 0
        END
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] > 0 AND f.value:"genotype"[1] > 0 AND f.value:"genotype"[0] = f.value:"genotype"[1] THEN 1
          ELSE 0
        END
      ELSE 0
    END AS homo_alt,
    CASE
      WHEN ARRAY_SIZE(f.value:"genotype") = 2 THEN
        CASE
          WHEN f.value:"genotype"[0] != f.value:"genotype"[1] AND f.value:"genotype"[0] IS NOT NULL AND f.value:"genotype"[1] IS NOT NULL THEN 1
          ELSE 0
        END
      ELSE 0
    END AS het_alt
  FROM "_1000_GENOMES"."_1000_GENOMES"."VARIANTS" t,
    LATERAL FLATTEN(input => t."call") f,
    LATERAL FLATTEN(input => t."alternate_bases") ab
  WHERE t."reference_name" = 'X'
    AND t."start" NOT BETWEEN 59999 AND 2699519
    AND t."start" NOT BETWEEN 154931042 AND 155260559
    AND LENGTH(t."reference_bases") = 1
    AND LENGTH(ab.value::STRING) = 1
) sub
GROUP BY sample_id;
```
2025-01-25 06:34:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 06:34:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 06:34:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 06:34:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 822
2025-01-25 06:34:23 - snowflake.connector.connection - INFO - closed
2025-01-25 06:34:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 06:34:24 - root - INFO - itercount: 2
2025-01-25 06:34:24 - root - INFO - 0
2025-01-25 06:34:24 - root - INFO - Total iteration counts: 2
