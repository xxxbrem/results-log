2025-01-26 04:29:32 - openai._base_client - INFO - Retrying request to /chat/completions in 0.411228 seconds
2025-01-26 04:30:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:30:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:07 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:08 - root - INFO - SQL:
SELECT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
[]
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
[]
[]
"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
[]
[]
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SCHWAMM HORST""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""PEZZEI FRIEDBERT""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KREMS CHEMIE GMBH""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ELTREVA AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GANNER ERWIN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GRASS ALFRED METALLWAREN""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""INKOMAG FA""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PROHASKA HEINZ""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SIEMENS AG OESTERREICH""
 

2025-01-26 04:30:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:09 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:09 - root - INFO - SQL:
SELECT f.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
Results:
assignee_name
LIU QIN
NELSON CURT L
COMBS GREGG
LI HONG-CHUN
TSAY CHEAN-LUNG
CHEN DAN
IBM
GUTHRIE HUNG-CHIN
NYSTROM JAMES C
VOZZA-BROWN LAURA
YIM HARRY
CAMERON JOHN
O'BANION MATTHEW
HENRY ADAM S
OLIVIER LISA M
EURLINGS MARKUS FRANCISCUS A
LAIDIG THOMAS
HOLLERBACH UWE
KIM DONG-HO
ALEINER BORIS
MEDTRONIC MINIMED INC
MCI INC
WEINBERG CHRISTOPHER A
FORD MOTOR CO
ZHANG GUOBIAO
SIEK DAVID D
IND DESIGN LAB INC
ECOLAB
HOWELL THOMAS A
CHAO DAVID
THOMAS C D
TONG PETER P
TAMURA JUN
NAKANO YOSHIHIKO
OOTA HIDEO
KYOCERA CORP
UE SYSTEMS INC
IDEMITSU KOSAN CO
MUHR-SWEENEY AUDREY
IMP COLLEGE INNOVATIONS LTD
FUJI PHOTO FILM CO LTD
GEN ELECTRIC
ADVANCED SEMICONDUCTOR ENG
QWEST COMM INT INC
MINNESOTA MEDICAL PHYSICS LLC
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
ALEXANDER WARREN S
METCALF DONALD
GREENHALGH CHRISTOPHER J
STARCK H C INC
BAUMANN TORSTEN
HALLOR MATTIAS
ARVINMERITOR LIGHT VEHICLE SYS
BROTHER IND LTD
WYETH CORP
MICHEL XAVIER
OLYMPUS CORP
LIU FU-TONG
SANO HIDEKI
HSU DANIEL K
ORACLE INT CORP
TOYOTA CHUO KENKYUSHO KK
NORMINGTON GLYN
KEATING SCOTT
KEATING JOHN
HUANG CHI-FANG
LIU CHIA-LIN
MO CHI-NENG
MICKLE MARLIN H
HACKWORTH STEVEN A
HOFFMAN WILLIAM H
RUHL SANDRA R
SALK INST FOR BIOLOGICAL STUDI
UNIV KOREA IND & ACAD COOP
FCI AMERICAS TECHNOLOGY INC
JOHNSON ELECTRIC SA
HIROE ATSUO
YAMADA KEIICHI
LUCKE HELMUT
BROTHER IND LTD
DE LEYS ROBERT
ZHENG JIAN
SHELTON FREDERICK E IV
DOIL KEVIN R
SWAYZE JEFFREY S
TIMPERMAN EUGENE L
ARUZE CORP
HJERTMAN BIRGER
TSANG PATRICK
CHANG KUO-SHU E
WRIGHT ANDREW
LG PHILIPS LCD CO LTD
KRISHNAMOORTHI RAGHURAMAN
LING FUYUN
VIJAYAN RAJIV
GOTTFURCHT ELLIOT A
GOTTFURCHT GRANT E
LONG ALBERT-MICHEL C

2025-01-26 04:30:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:11 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:11 - root - INFO - SQL:
SELECT t."cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Results:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t

2025-01-26 04:30:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:12 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:13 - root - INFO - SQL:
SELECT f.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
Results:
cpc_code
G02F1/133753
G02F1/133738
G02F1/133738
G02F1/133742
G02F1/133788
G02F1/133788
G02F1/133753
G02F1/133742
H02M1/4225
H02M1/4225
H02M1/0022
H02M1/0022
Y02B70/10
Y02P80/10
Y02P80/10
Y02B70/10
G06F8/60
G06F8/60
B24B57/02
B24B57/02
C12N15/87
C12N15/87
C12M23/08
C12M35/02
C12M35/02
C12M23/08
C12N9/1007
C12N9/1007
G03F1/36
G05B17/00
G03F1/36
G05B15/00
G03F1/36
F21V33/0052
H04N21/42222
H04N21/42206
H04Q9/04
F21V33/0052
H04N21/42204
H04N21/42204
H04N21/42221
H04N21/42221
F21L13/08
H04N21/42206
H04N21/42222
G08C23/04
G08C23/04
F21L4/08
H03F1/3223
H03F2200/204
H03F1/32
H03F3/24
H03F2201/3215
H03F3/211
H03F1/02
H04B1/04
H04B1/04
H03F3/211
H03F3/24
H03F1/0205
H03F1/32
H03F1/3223
H03F1/3229
H04B2001/0441
H03F2200/204
H03F2201/3215
H04B2001/0441
H03F1/3229
H03F1/0205
H03F1/02
G16H50/50
G16H50/50
G02B5/20
G02B6/29383
G02B6/29398
G02B6/29365
H04J14/021
G02B6/29361
G02B6/29395
G02B6/29383
G02B6/29365
G02B6/29398
G02B6/29361
G02B6/29395
H04J14/021
H04J14/021
A23K40/30
A01K15/026
A23K50/45
A23K50/40
A23K10/26
A01K15/026
A23K10/26
A23K40/30
A23K50/40
A23K50/45
G05B19/4065
G05B19/4065
G03F1/22
G03F1/20

2025-01-26 04:30:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:14 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:14 - root - INFO - SQL:
SELECT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::VARIANT:"code"::STRING LIKE 'A61%'
   LIMIT 100;
Results:
publication_number
IN-2014CN04913-A
IN-2014CN04913-A
US-3904753-A
US-3904753-A
US-3904753-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
US-2100778-A
US-2100778-A
SG-11201912447R-A
SG-11201912447R-A
SG-11201912447R-A
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021012881-A1
US-2021012881-A1
US-2021012881-A1
US-2021012881-A1

2025-01-26 04:30:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:16 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:16 - root - INFO - SQL:
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
   LIMIT 100;
Results:
assignee_name
ECOLAB
ECOLAB
ECOLAB
ECOLAB
ECOLAB
ECOLAB
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
MINNESOTA MEDICAL PHYSICS LLC
MINNESOTA MEDICAL PHYSICS LLC
MINNESOTA MEDICAL PHYSICS LLC
MINNESOTA MEDICAL PHYSICS LLC
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR

2025-01-26 04:30:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:18 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:18 - root - INFO - SQL:
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
   GROUP BY "assignee_name"
   ORDER BY "patent_count" DESC
   LIMIT 100;
Results:
assignee_name,patent_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,140
PFIZER,125
UNIV CALIFORNIA,98
BRISTOL MYERS SQUIBB CO,90
COLGATE PALMOLIVE CO,89
COVIDIEN LP,84
BAYER AG,82
KIMBERLY CLARK CO,79
GENENTECH INC,78
HOECHST AG,78
MERCK & CO INC,77
JANSSEN PHARMACEUTICA NV,75
ASTRAZENECA AB,75
MERCK PATENT GMBH,73
KONINKLIJKE PHILIPS NV,68
BECTON DICKINSON CO,67
OLYMPUS CORP,65
MEDTRONIC INC,63
BOEHRINGER INGELHEIM INT,60
FUJIFILM CORP,60
CENTRE NAT RECH SCIENT,55
AMGEN INC,54
SCHERING AG,54
SIEMENS AG,53
BOSTON SCIENT SCIMED INC,52
UNI CHARM CORP,48
ABBOTT LAB,46
GEN ELECTRIC,46
KONINKL PHILIPS ELECTRONICS NV,44
MERCK SHARP & DOHME,44
ETHICON INC,44
PFIZER PROD INC,43
GLAXO GROUP LTD,43
SANOFI AVENTIS DEUTSCHLAND,43
WARNER LAMBERT CO,42
BAXTER INT,42
INST NAT SANTE RECH MED,41
3M INNOVATIVE PROPERTIES CO,41
TERUMO CORP,41
UNIV TEXAS,40
SMITHKLINE BEECHAM CORP,38
ALLERGAN INC,38
SAMSUNG ELECTRONICS CO LTD,37
AMERICAN CYANAMID CO,37
SANOFI SA,37
UNILEVER NV,36
UNIV LELAND STANFORD JUNIOR,36
SCHERING CORP,35
CIBA GEIGY AG,35
OTSUKA PHARMA CO LTD,35
ETHICON ENDO SURGERY INC,35
WYETH CORP,35
KAO CORP,34
ALCON INC,34
NOVO NORDISK AS,34
CANON KK,34
BEIERSDORF AG,33
GRUENENTHAL GMBH,33
US HEALTH,33
SANOFI AVENTIS,32
UPJOHN CO,31
REGENERON PHARMA,31
SERVIER LAB,31
BIOSENSE WEBSTER ISRAEL LTD,30
EDWARDS LIFESCIENCES CORP,30
UNIV PENNSYLVANIA,29
TYCO HEALTHCARE,28
UNILEVER PLC,28
BOEHRINGER INGELHEIM PHARMA,28
OLYMPUS MEDICAL SYSTEMS CORP,28
VERTEX PHARMA,28
GILEAD SCIENCES INC,26
ETHICON LLC,26
CARDIAC PACEMAKERS INC,26
UNIV FLORIDA,26
NESTEC SA,26
UNIV JOHNS HOPKINS,26
ALZA CORP,25
BASF AG,25
THOMAE GMBH DR K,25
PHILIP MORRIS PRODUCTS SA,25
MASSACHUSETTS GEN HOSPITAL,25
AVENTIS PHARMA SA,25
MASSACHUSETTS INST TECHNOLOGY,25
CHUGAI PHARMACEUTICAL CO LTD,25
MCNEIL PPC INC,24
SIEMENS HEALTHCARE GMBH,24
TAKEDA CHEMICAL INDUSTRIES LTD,24
AMOREPACIFIC CORP,24
SMITH & NEPHEW INC,23
GENZYME CORP,23
HENKEL KGAA,23
SMITHKLINE BEECHAM PLC,23
BAXTER HEALTHCARE SA,22
GORE & ASS,22
SHISEIDO CO LTD,22

2025-01-26 04:30:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:19 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:30:39 - root - INFO - The error you're encountering occurs because some rows in the `"filing_date"` column have values that cannot be parsed as valid dates using the `TO_DATE` function with the format `'YYYYMMDD'`. Specifically, the value `'0'` cannot be interpreted as a date in that format.

To resolve this issue, you can modify your SQL query to exclude rows where the `"filing_date"` is invalid (e.g., `'0'` or `NULL`). Here are two approaches you can use:

---

### **Approach 1: Filter Out Invalid Dates**

You can add a `WHERE` clause to filter out rows where `"filing_date"` is `'0'` or `NULL` before attempting to parse it.

```sql
SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
LIMIT 100;
```

**Explanation:**

- The condition `t."filing_date" IS NOT NULL` ensures that `NULL` values are excluded.
- The condition `t."filing_date" != '0'` filters out any rows where the filing date is `'0'`, which cannot be parsed as a valid date.
- The `TO_DATE` function now only processes valid date strings, preventing the parsing error.

---

### **Approach 2: Use `TRY_TO_DATE` Function**

Alternatively, you can use the `TRY_TO_DATE` function, which attempts to convert a string to a date and returns `NULL` if it fails, instead of raising an error.

```sql
SELECT DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100;
```

**Explanation:**

- `TRY_TO_DATE` attempts to parse the `"filing_date"`. If it can't, it returns `NULL` instead of throwing an error.
- The `WHERE` clause filters out rows where `TRY_TO_DATE` returned `NULL`, ensuring only valid dates are processed.
- This approach handles any invalid date formats gracefully without specifying all possible invalid values.

---

### **Additional Notes:**

- **Data Inspection:** It might be helpful to inspect the distinct values of `"filing_date"` that are causing issues. You can run the following query to identify problematic values:

  ```sql
  SELECT DISTINCT t."filing_date"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  WHERE t."filing_date" IS NULL OR t."filing_date" = '0' OR LENGTH(t."filing_date") != 8
  LIMIT 100;
  ```

- **Date Format Verification:** Ensure that all valid `"filing_date"` values are in the format `'YYYYMMDD'` (e.g., '20231025'). If there are dates with different lengths or formats, you may need to adjust your parsing strategy accordingly.

- **Comprehensive Filtering:** If there are other invalid date values besides `'0'`, you can modify the `WHERE` clause to exclude dates that don't match the expected format:

  ```sql
  WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
  ```

---

By applying one of these approaches, your query should execute without the parsing error, and you'll be able to extract the filing years successfully.

**Updated Query Example:**

```sql
SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
LIMIT 100;
```

---

**Summary:**

- The error is due to invalid date values in the `"filing_date"` column (e.g., `'0'` or `NULL`).
- Use a `WHERE` clause to filter out invalid dates before parsing.
- Alternatively, use `TRY_TO_DATE` to handle parsing errors gracefully.
- Ensure that the date strings conform to the `'YYYYMMDD'` format.

Let me know if you have any questions or need further assistance!
2025-01-26 04:30:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:40 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:31:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:31:38 - root - INFO - SQL:
SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
LIMIT 100;
Results:
filing_year
2008
1995
1993
1999
1991
1992
1995
1996
1992
1999
1991
1991
1992
1995
1999
1991
1991
1992
1996
1996
1999
2012
2016
2017
2019
2020
1977
1978
1980
1982
1983
1983
1989
1989
1990
1993
1998
1997
1999
1999
2001
2003
2003
2003
2007
2007
2008
2011
2012
2014
2015
2018
2020
2005
2005
2005
2008
2005
2005
2005
2005
2008
2002
2002
2005
2008
2005
2005
2008
2005
2008
2002
2008
2002
2008
2005
2005
2005
2006
2002
2005
2002
2002
2008
2008
2005
2005
2001
2008
2005
2005
2008
2002
2002
2002
2005
2005
2008
2005
2005

2025-01-26 04:31:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:31:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:31:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:31:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 04:31:39 - snowflake.connector.connection - INFO - closed
2025-01-26 04:31:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:32:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:32:08 - root - INFO - ```sql
SELECT DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "patent_count" DESC
LIMIT 100;
```
2025-01-26 04:32:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:32:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:32:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:32:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 46
2025-01-26 04:32:10 - snowflake.connector.connection - INFO - closed
2025-01-26 04:32:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:33:01 - root - INFO - SQL:
SELECT DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "patent_count" DESC
LIMIT 100;
Results:
filing_year,patent_count
1997,15
2000,11
1998,10
1999,10
2016,8
1996,8
2008,7
2012,7
2007,7
2017,7
2006,7
1995,6
1992,5
1986,5
2015,5
1991,5
1994,5
1990,5
2014,5
2021,4
2018,4
2005,4
2013,4
2011,4
1983,3
2023,3
2004,3
2003,3
1993,2
2001,2
2019,2
2010,2
1981,2
1972,2
2020,2
1988,2
2002,2
1979,1
2024,1
1966,1
1982,1
1973,1
1971,1
2009,1
1985,1
1989,1

2025-01-26 04:33:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-26 04:33:02 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:03 - root - INFO - SQL:
-- Corrected Query 2
SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 5
Results:
country_code,patent_count
CA,36
US,34
AU,24
CN,13
EP,11

2025-01-26 04:33:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:04 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:05 - root - INFO - SQL:
-- Corrected Query 3
SELECT t."publication_number", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100
Results:
publication_number,country_code
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
DE-112011100464-T5,DE
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU

2025-01-26 04:33:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 85
2025-01-26 04:33:06 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:06 - root - INFO - SQL:
-- Corrected Query 4
SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 100
Results:
country_code,patent_count
US,6179
CN,4575
JP,3409
KR,2240
AU,2198
CA,1946
WO,1543
EP,1265
BR,675
DE,653
AT,511
IL,450
GB,267
ZA,249
RU,247
MX,237
HU,235
TW,223
ES,186
FR,180
AR,155
NO,151
IT,146
CH,141
PT,140
PL,132
HK,127
DK,110
BE,97
NZ,92
IE,84
SE,77
SG,75
NL,74
HR,73
FI,71
CL,61
CY,55
CZ,52
CO,47
EA,47
SI,41
PH,36
PE,35
YU,32
GR,32
BG,31
SK,28
MY,25
AP,24
TR,22
CR,21
MA,20
IN,19
DD,17
LT,16
JO,13
UA,13
SU,12
RS,12
CS,10
LU,9
RO,8
EC,8
ID,8
GT,7
OA,6
IS,6
LV,6
CU,5
DO,5
SA,5
EG,5
EE,5
SM,4
ME,4
TN,3
NI,3
GE,2
HN,2
PA,2
MD,2
DZ,1
ZW,1
ZM,1

2025-01-26 04:33:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:08 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:08 - root - INFO - SQL:
-- Corrected Query 5
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name", t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
GROUP BY "assignee_name", t."country_code"
ORDER BY "patent_count" DESC
LIMIT 100
Results:
assignee_name,country_code,patent_count
COVIDIEN LP,US,48
BOSTON SCIENT SCIMED INC,US,37
PROCTER & GAMBLE,CA,36
PROCTER & GAMBLE,US,34
UNIV CALIFORNIA,US,33
KONINKLIJKE PHILIPS NV,US,31
MEDTRONIC INC,US,31
FUJIFILM CORP,US,25
PROCTER & GAMBLE,AU,24
OREAL,US,24
GEN ELECTRIC,US,23
GENENTECH INC,US,23
KONINKL PHILIPS ELECTRONICS NV,CN,23
NOVARTIS AG,AU,22
OLYMPUS CORP,US,22
SIEMENS AG,DE,21
LILLY CO ELI,AU,21
HOFFMANN LA ROCHE,AU,19
OREAL,JP,18
OREAL,FR,18
HOFFMANN LA ROCHE,CA,18
OLYMPUS CORP,WO,17
CARDIAC PACEMAKERS INC,US,17
UNIV TEXAS,US,17
GLOBUS MEDICAL INC,US,16
KONINKLIJKE PHILIPS NV,WO,16
US HEALTH,US,16
KIMBERLY CLARK CO,AU,16
UNIV CALIFORNIA,WO,15
SAMSUNG ELECTRONICS CO LTD,KR,15
TERUMO CORP,US,15
BAYER AG,AU,15
HOFFMANN LA ROCHE,CN,15
UNIV LELAND STANFORD JUNIOR,US,15
SIEMENS HEALTHCARE GMBH,US,15
BRISTOL MYERS SQUIBB CO,US,14
SAMSUNG ELECTRONICS CO LTD,US,14
INTUITIVE SURGICAL OPERATIONS,US,14
OREAL,BR,14
UNIV CALIFORNIA,AU,14
EDWARDS LIFESCIENCES CORP,US,14
CANON KK,US,14
CENTRE NAT RECH SCIENT,US,14
BECTON DICKINSON CO,CA,14
TOSHIBA CORP,JP,14
UNIV JOHNS HOPKINS,US,13
MEDTRONIC VASCULAR INC,US,13
FUJIFILM CORP,JP,13
PACESETTER INC,US,13
SIEMENS AG,US,13
PROCTER & GAMBLE,CN,13
AMOREPACIFIC CORP,KR,13
MERCK & CO INC,AU,13
BECTON DICKINSON CO,US,13
BEIERSDORF AG,DE,13
LG HOUSEHOLD & HEALTH CARE LTD,KR,13
HOFFMANN LA ROCHE,US,13
COLGATE PALMOLIVE CO,CA,12
HOFFMANN LA ROCHE,BR,12
BAYER AG,US,12
CILAG GMBH INT,US,12
CENTRE NAT RECH SCIENT,CA,12
NOVARTIS AG,CN,12
OREAL,AT,11
OLYMPUS CORP,JP,11
CANON KK,JP,11
NOVARTIS AG,US,11
SMITH & NEPHEW INC,US,11
LILLY CO ELI,CA,11
IBM,US,11
JANSSEN PHARMACEUTICA NV,AU,11
BRISTOL MYERS SQUIBB CO,AU,11
LILLY CO ELI,HU,11
UNIV PENNSYLVANIA,US,11
COLGATE PALMOLIVE CO,AU,11
MERCK & CO INC,CA,11
PFIZER,US,11
PROCTER & GAMBLE,EP,11
LILLY CO ELI,US,11
UNIV FLORIDA,US,10
UNIV NORTHWESTERN,US,10
ABBOTT DIABETES CARE INC,US,10
ALCON INC,AU,10
OREAL,CN,10
UNIV YONSEI IACF,KR,10
HOFFMANN LA ROCHE,AT,10
ALLERGAN INC,US,10
ASTRAZENECA AB,US,10
PROCTER & GAMBLE,MX,10
COVIDIEN LP,AU,10
PFIZER,PT,10
WYETH CORP,US,10
UNIV ZHEJIANG,CN,10
3M INNOVATIVE PROPERTIES CO,US,10
COLGATE PALMOLIVE CO,US,10
UNIV MARYLAND,US,10
ASTRAZENECA AB,AU,9
JOHNSON & JOHNSON,BR,9
SHANGHAI UNITED IMAGING HEALTHCARE CO LTD,CN,9
GENENTECH INC,AU,9

2025-01-26 04:33:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:09 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:10 - root - INFO - SQL:
-- Corrected Query 6
SELECT DISTINCT c.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
LIMIT 100
Results:
cpc_code
A61B6/547
A61K8/0241
A61B90/36
A61M60/205
A61M25/007
A61M2025/0037
A61B5/7465
A61B5/150099
A61B5/1126
A61F2/44
A61B2017/1205
A61K31/46
A61K9/1623
A61K8/03
A61P31/08
A61K36/13
A61P23/02
A61K39/46432
A61M16/0808
A61K33/04
A61M2205/18
A61K2236/33
A61B2017/00017
A61F13/15
A61K36/288
A61B2017/0432
A61G2210/50
A61B5/04014
A61M60/414
A61B2017/3419
A61F2002/8483
A61M25/0138
A61B3/113
A61B6/08
A61H2003/043
A61J9/0661
A61F13/474
A61L27/3641
A61M2021/0022
A61B17/26
A61B2017/3413
A61B5/1122
A61B1/125
A61B5/022
A61K31/194
A61B2017/2946
A61Q5/002
A61B17/105
A61B2018/20361
A61K31/235
A61M15/00
A61B2034/2048
A61F2005/0016
A61B17/3472
A61K51/1096
A61K31/66
A61F13/266
A61L33/0088
A61K38/2013
A61B2017/8838
A61M16/021
A61M25/0075
A61M5/502
A61K2039/60
A61F2007/0247
A61K2039/852
A61K31/145
A61H33/06
A61J1/1425
A61F9/00772
A61H33/08
A61B2017/00747
A61M5/3158
A61N1/36146
A61K31/706
A61B17/1615
A61P37/08
A61P35/02
A61K2039/5158
A61K31/497
A61K31/4188
A61J1/10
A61L24/06
A61K9/5031
A61B90/00
A61K47/68031
A61K36/88
A61M16/14
A61B5/02416
A61K9/127
A61B5/296
A61K51/0402
A61K8/0245
A61H2201/5023
A61C9/00
A61G5/027
A61B17/7011
A61B5/044
A61F2/958
A61G7/057

2025-01-26 04:33:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:11 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:12 - root - INFO - SQL:
-- Corrected Query 7
SELECT DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "filing_year"
LIMIT 100
Results:
filing_year,patent_count
1899,2
1900,1
1903,1
1905,1
1906,2
1907,2
1908,1
1909,1
1910,2
1911,3
1913,5
1914,5
1915,3
1916,3
1917,1
1920,2
1921,4
1922,1
1923,3
1924,2
1926,2
1927,3
1928,6
1929,4
1930,1
1931,6
1932,3
1933,2
1934,4
1935,9
1936,10
1937,4
1938,3
1939,4
1940,6
1941,7
1942,2
1943,5
1944,4
1945,7
1946,6
1947,3
1948,8
1949,6
1950,9
1951,6
1952,7
1953,10
1954,7
1955,11
1956,7
1957,11
1958,15
1959,10
1960,11
1961,20
1962,17
1963,22
1964,22
1965,24
1966,34
1967,19
1968,32
1969,42
1970,47
1971,38
1972,64
1973,84
1974,89
1975,82
1976,94
1977,102
1978,112
1979,95
1980,104
1981,133
1982,122
1983,144
1984,117
1985,156
1986,179
1987,169
1988,212
1989,217
1990,249
1991,245
1992,281
1993,296
1994,303
1995,327
1996,363
1997,413
1998,445
1999,505
2000,511
2001,633
2002,640
2003,761
2004,756
2005,781

2025-01-26 04:33:12 - root - INFO - itercount: 0
2025-01-26 04:33:12 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `PATENTS.PATENTS.PUBLICATIONS`
   - **"assignee_harmonized"**: Contains assignee information; used to identify assignees.
   - **"cpc"**: Contains the CPC classification codes; used to filter patents in category 'A61'.
   - **"filing_date"**: Date when the patent was filed; used to determine the busiest year.
   - **"country_code"**: Indicates the jurisdiction code where the patent was filed.
   - **"publication_number"**: Unique identifier for the patent; used for counting patents.

**Conditions That May Be Used:**

- Filter patents where the CPC code starts with 'A61' to focus on the desired category.
- Group by assignee to find the most active assignee in category 'A61'.
- Extract the year from the "filing_date" to determine the busiest year.
- Group by "country_code" to find the top five jurisdictions.
- Since "assignee_harmonized" and "cpc" are VARIANT types, we may need to flatten or extract specific fields.

---

**SQL Queries:**

1. **View the structure of the "assignee_harmonized" column:**

   ```sql
   SELECT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

2. **Flatten the "assignee_harmonized" column to see individual assignee names:**

   ```sql
   SELECT f.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
   ```

3. **View the structure of the "cpc" column:**

   ```sql
   SELECT t."cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

4. **Extract CPC codes from the "cpc" column:**

   ```sql
   SELECT f.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
   ```

5. **Find patents with CPC code starting with 'A61':**

   ```sql
   SELECT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::VARIANT:"code"::STRING LIKE 'A61%'
   LIMIT 100;
   ```

6. **List assignees for patents in category 'A61':**

   ```sql
   SELECT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
   LIMIT 100;
   ```

7. **Count the number of patents per assignee in category 'A61':**

   ```sql
   SELECT a.value::VARIANT:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
   GROUP BY "assignee_name"
   ORDER BY "patent_count" DESC
   LIMIT 100;
   ```

8. **Extract the filing year for patents:**

   ```sql
   SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

9. **Find the busiest year for a particular assignee in category 'A61':**

   ```sql
   SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%' AND a.value::VARIANT:"name"::STRING = 'Most Active Assignee'
   GROUP BY "filing_year"
   ORDER BY "patent_count" DESC
   LIMIT 100;
   ```

10. **Get the top five jurisdiction codes for the busiest year of the most active assignee in 'A61':**

    ```sql
    SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
      AND a.value::VARIANT:"name"::STRING = 'Most Active Assignee'
      AND DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) = 'Busiest Year'
    GROUP BY t."country_code"
    ORDER BY "patent_count" DESC
    LIMIT 5;
    ```

11. **List patent numbers and countries for the top assignee in 'A61' during their busiest year:**

    ```sql
    SELECT t."publication_number", t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
      AND a.value::VARIANT:"name"::STRING = 'Most Active Assignee'
      AND DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) = 'Busiest Year'
    LIMIT 100;
    ```

12. **Count the number of patents per country for all assignees in category 'A61':**

    ```sql
    SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    GROUP BY t."country_code"
    ORDER BY "patent_count" DESC
    LIMIT 100;
    ```

13. **Find the top assignees in category 'A61' along with their countries:**

    ```sql
    SELECT a.value::VARIANT:"name"::STRING AS "assignee_name", t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    GROUP BY "assignee_name", t."country_code"
    ORDER BY "patent_count" DESC
    LIMIT 100;
    ```

14. **Get a list of unique CPC codes that start with 'A61':**

    ```sql
    SELECT DISTINCT c.value::VARIANT:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    LIMIT 100;
    ```

15. **Find the total number of patents filed each year in category 'A61':**

    ```sql
    SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    GROUP BY "filing_year"
    ORDER BY "filing_year"
    LIMIT 100;
    ```

**Note:** In the queries above, replace `'Most Active Assignee'` with the actual name of the assignee obtained from the data, and `'Busiest Year'` with the specific year determined from the data.

**Explanation:**

- **Queries 1-4:** Explore the structure and contents of the VARIANT columns "assignee_harmonized" and "cpc" to understand how to extract necessary information.
- **Queries 5-7:** Filter and extract patents in category 'A61', list their assignees, and count the number of patents per assignee to identify the most active one.
- **Query 8:** Extract the year from the "filing_date" to use in further analysis.
- **Queries 9-10:** Determine the busiest year for the most active assignee and get the top five jurisdiction codes where they filed patents in that year.
- **Queries 11-15:** Further explore patents filed by assignees in category 'A61', including patent numbers, country codes, and yearly counts.

These queries help in understanding the data and provide insights needed to answer the task without directly providing the final answer.Query:
SELECT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
[]
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
[]
[]
"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
[]
[]
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SCHWAMM HORST""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""PEZZEI FRIEDBERT""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KREMS CHEMIE GMBH""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ELTREVA AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GANNER ERWIN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GRASS ALFRED METALLWAREN""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""INKOMAG FA""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PROHASKA HEINZ""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SIEMENS AG OESTERREICH""
 
Query:
SELECT f.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
Answer:
assignee_name
LIU QIN
NELSON CURT L
COMBS GREGG
LI HONG-CHUN
TSAY CHEAN-LUNG
CHEN DAN
IBM
GUTHRIE HUNG-CHIN
NYSTROM JAMES C
VOZZA-BROWN LAURA
YIM HARRY
CAMERON JOHN
O'BANION MATTHEW
HENRY ADAM S
OLIVIER LISA M
EURLINGS MARKUS FRANCISCUS A
LAIDIG THOMAS
HOLLERBACH UWE
KIM DONG-HO
ALEINER BORIS
MEDTRONIC MINIMED INC
MCI INC
WEINBERG CHRISTOPHER A
FORD MOTOR CO
ZHANG GUOBIAO
SIEK DAVID D
IND DESIGN LAB INC
ECOLAB
HOWELL THOMAS A
CHAO DAVID
THOMAS C D
TONG PETER P
TAMURA JUN
NAKANO YOSHIHIKO
OOTA HIDEO
KYOCERA CORP
UE SYSTEMS INC
IDEMITSU KOSAN CO
MUHR-SWEENEY AUDREY
IMP COLLEGE INNOVATIONS LTD
FUJI PHOTO FILM CO LTD
GEN ELECTRIC
ADVANCED SEMICONDUCTOR ENG
QWEST COMM INT INC
MINNESOTA MEDICAL PHYSICS LLC
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
ALEXANDER WARREN S
METCALF DONALD
GREENHALGH CHRISTOPHER J
STARCK H C INC
BAUMANN TORSTEN
HALLOR MATTIAS
ARVINMERITOR LIGHT VEHICLE SYS
BROTHER IND LTD
WYETH CORP
MICHEL XAVIER
OLYMPUS CORP
LIU FU-TONG
SANO HIDEKI
HSU DANIEL K
ORACLE INT CORP
TOYOTA CHUO KENKYUSHO KK
NORMINGTON GLYN
KEATING SCOTT
KEATING JOHN
HUANG CHI-FANG
LIU CHIA-LIN
MO CHI-NENG
MICKLE MARLIN H
HACKWORTH STEVEN A
HOFFMAN WILLIAM H
RUHL SANDRA R
SALK INST FOR BIOLOGICAL STUDI
UNIV KOREA IND & ACAD COOP
FCI AMERICAS TECHNOLOGY INC
JOHNSON ELECTRIC SA
HIROE ATSUO
YAMADA KEIICHI
LUCKE HELMUT
BROTHER IND LTD
DE LEYS ROBERT
ZHENG JIAN
SHELTON FREDERICK E IV
DOIL KEVIN R
SWAYZE JEFFREY S
TIMPERMAN EUGENE L
ARUZE CORP
HJERTMAN BIRGER
TSANG PATRICK
CHANG KUO-SHU E
WRIGHT ANDREW
LG PHILIPS LCD CO LTD
KRISHNAMOORTHI RAGHURAMAN
LING FUYUN
VIJAYAN RAJIV
GOTTFURCHT ELLIOT A
GOTTFURCHT GRANT E
LONG ALBERT-MICHEL C
Query:
SELECT t."cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Answer:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t
Query:
SELECT f.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
Answer:
cpc_code
G02F1/133753
G02F1/133738
G02F1/133738
G02F1/133742
G02F1/133788
G02F1/133788
G02F1/133753
G02F1/133742
H02M1/4225
H02M1/4225
H02M1/0022
H02M1/0022
Y02B70/10
Y02P80/10
Y02P80/10
Y02B70/10
G06F8/60
G06F8/60
B24B57/02
B24B57/02
C12N15/87
C12N15/87
C12M23/08
C12M35/02
C12M35/02
C12M23/08
C12N9/1007
C12N9/1007
G03F1/36
G05B17/00
G03F1/36
G05B15/00
G03F1/36
F21V33/0052
H04N21/42222
H04N21/42206
H04Q9/04
F21V33/0052
H04N21/42204
H04N21/42204
H04N21/42221
H04N21/42221
F21L13/08
H04N21/42206
H04N21/42222
G08C23/04
G08C23/04
F21L4/08
H03F1/3223
H03F2200/204
H03F1/32
H03F3/24
H03F2201/3215
H03F3/211
H03F1/02
H04B1/04
H04B1/04
H03F3/211
H03F3/24
H03F1/0205
H03F1/32
H03F1/3223
H03F1/3229
H04B2001/0441
H03F2200/204
H03F2201/3215
H04B2001/0441
H03F1/3229
H03F1/0205
H03F1/02
G16H50/50
G16H50/50
G02B5/20
G02B6/29383
G02B6/29398
G02B6/29365
H04J14/021
G02B6/29361
G02B6/29395
G02B6/29383
G02B6/29365
G02B6/29398
G02B6/29361
G02B6/29395
H04J14/021
H04J14/021
A23K40/30
A01K15/026
A23K50/45
A23K50/40
A23K10/26
A01K15/026
A23K10/26
A23K40/30
A23K50/40
A23K50/45
G05B19/4065
G05B19/4065
G03F1/22
G03F1/20
Query:
SELECT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::VARIANT:"code"::STRING LIKE 'A61%'
   LIMIT 100;
Answer:
publication_number
IN-2014CN04913-A
IN-2014CN04913-A
US-3904753-A
US-3904753-A
US-3904753-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
MX-PA05001837-A
US-2100778-A
US-2100778-A
SG-11201912447R-A
SG-11201912447R-A
SG-11201912447R-A
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020292730-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2020360606-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021130427-A1
US-2021012881-A1
US-2021012881-A1
US-2021012881-A1
US-2021012881-A1
Query:
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
   LIMIT 100;
Answer:
assignee_name
ECOLAB
ECOLAB
ECOLAB
ECOLAB
ECOLAB
ECOLAB
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
IMP COLLEGE INNOVATIONS LTD
MINNESOTA MEDICAL PHYSICS LLC
MINNESOTA MEDICAL PHYSICS LLC
MINNESOTA MEDICAL PHYSICS LLC
MINNESOTA MEDICAL PHYSICS LLC
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
JAFFE ROSS
TARTAGLIA JOSEPH M
BELSON AMIR
Query:
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
   GROUP BY "assignee_name"
   ORDER BY "patent_count" DESC
   LIMIT 100;
Answer:
assignee_name,patent_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,140
PFIZER,125
UNIV CALIFORNIA,98
BRISTOL MYERS SQUIBB CO,90
COLGATE PALMOLIVE CO,89
COVIDIEN LP,84
BAYER AG,82
KIMBERLY CLARK CO,79
GENENTECH INC,78
HOECHST AG,78
MERCK & CO INC,77
JANSSEN PHARMACEUTICA NV,75
ASTRAZENECA AB,75
MERCK PATENT GMBH,73
KONINKLIJKE PHILIPS NV,68
BECTON DICKINSON CO,67
OLYMPUS CORP,65
MEDTRONIC INC,63
BOEHRINGER INGELHEIM INT,60
FUJIFILM CORP,60
CENTRE NAT RECH SCIENT,55
AMGEN INC,54
SCHERING AG,54
SIEMENS AG,53
BOSTON SCIENT SCIMED INC,52
UNI CHARM CORP,48
ABBOTT LAB,46
GEN ELECTRIC,46
KONINKL PHILIPS ELECTRONICS NV,44
MERCK SHARP & DOHME,44
ETHICON INC,44
PFIZER PROD INC,43
GLAXO GROUP LTD,43
SANOFI AVENTIS DEUTSCHLAND,43
WARNER LAMBERT CO,42
BAXTER INT,42
INST NAT SANTE RECH MED,41
3M INNOVATIVE PROPERTIES CO,41
TERUMO CORP,41
UNIV TEXAS,40
SMITHKLINE BEECHAM CORP,38
ALLERGAN INC,38
SAMSUNG ELECTRONICS CO LTD,37
AMERICAN CYANAMID CO,37
SANOFI SA,37
UNILEVER NV,36
UNIV LELAND STANFORD JUNIOR,36
SCHERING CORP,35
CIBA GEIGY AG,35
OTSUKA PHARMA CO LTD,35
ETHICON ENDO SURGERY INC,35
WYETH CORP,35
KAO CORP,34
ALCON INC,34
NOVO NORDISK AS,34
CANON KK,34
BEIERSDORF AG,33
GRUENENTHAL GMBH,33
US HEALTH,33
SANOFI AVENTIS,32
UPJOHN CO,31
REGENERON PHARMA,31
SERVIER LAB,31
BIOSENSE WEBSTER ISRAEL LTD,30
EDWARDS LIFESCIENCES CORP,30
UNIV PENNSYLVANIA,29
TYCO HEALTHCARE,28
UNILEVER PLC,28
BOEHRINGER INGELHEIM PHARMA,28
OLYMPUS MEDICAL SYSTEMS CORP,28
VERTEX PHARMA,28
GILEAD SCIENCES INC,26
ETHICON LLC,26
CARDIAC PACEMAKERS INC,26
UNIV FLORIDA,26
NESTEC SA,26
UNIV JOHNS HOPKINS,26
ALZA CORP,25
BASF AG,25
THOMAE GMBH DR K,25
PHILIP MORRIS PRODUCTS SA,25
MASSACHUSETTS GEN HOSPITAL,25
AVENTIS PHARMA SA,25
MASSACHUSETTS INST TECHNOLOGY,25
CHUGAI PHARMACEUTICAL CO LTD,25
MCNEIL PPC INC,24
SIEMENS HEALTHCARE GMBH,24
TAKEDA CHEMICAL INDUSTRIES LTD,24
AMOREPACIFIC CORP,24
SMITH & NEPHEW INC,23
GENZYME CORP,23
HENKEL KGAA,23
SMITHKLINE BEECHAM PLC,23
BAXTER HEALTHCARE SA,22
GORE & ASS,22
SHISEIDO CO LTD,22
Query:
SELECT DATE_PART('year', TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL AND t."filing_date" != '0'
LIMIT 100;
Answer:
filing_year
2008
1995
1993
1999
1991
1992
1995
1996
1992
1999
1991
1991
1992
1995
1999
1991
1991
1992
1996
1996
1999
2012
2016
2017
2019
2020
1977
1978
1980
1982
1983
1983
1989
1989
1990
1993
1998
1997
1999
1999
2001
2003
2003
2003
2007
2007
2008
2011
2012
2014
2015
2018
2020
2005
2005
2005
2008
2005
2005
2005
2005
2008
2002
2002
2005
2008
2005
2005
2008
2005
2008
2002
2008
2002
2008
2005
2005
2005
2006
2002
2005
2002
2002
2008
2008
2005
2005
2001
2008
2005
2005
2008
2002
2002
2002
2005
2005
2008
2005
2005
Query:
SELECT DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "patent_count" DESC
LIMIT 100;
Answer:
filing_year,patent_count
1997,15
2000,11
1998,10
1999,10
2016,8
1996,8
2008,7
2012,7
2007,7
2017,7
2006,7
1995,6
1992,5
1986,5
2015,5
1991,5
1994,5
1990,5
2014,5
2021,4
2018,4
2005,4
2013,4
2011,4
1983,3
2023,3
2004,3
2003,3
1993,2
2001,2
2019,2
2010,2
1981,2
1972,2
2020,2
1988,2
2002,2
1979,1
2024,1
1966,1
1982,1
1973,1
1971,1
2009,1
1985,1
1989,1
Query:
-- Corrected Query 2
SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 5
Answer:
country_code,patent_count
CA,36
US,34
AU,24
CN,13
EP,11
Query:
-- Corrected Query 3
SELECT t."publication_number", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND a.value::VARIANT:"name"::STRING ILIKE '%PROCTER%GAMBLE%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100
Answer:
publication_number,country_code
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
FI-903881-A0,FI
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
PL-331854-A1,PL
DE-112011100464-T5,DE
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-11896689-B2,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
US-2022031532-A1,US
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
AU-1314599-A,AU
Query:
-- Corrected Query 4
SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 100
Answer:
country_code,patent_count
US,6179
CN,4575
JP,3409
KR,2240
AU,2198
CA,1946
WO,1543
EP,1265
BR,675
DE,653
AT,511
IL,450
GB,267
ZA,249
RU,247
MX,237
HU,235
TW,223
ES,186
FR,180
AR,155
NO,151
IT,146
CH,141
PT,140
PL,132
HK,127
DK,110
BE,97
NZ,92
IE,84
SE,77
SG,75
NL,74
HR,73
FI,71
CL,61
CY,55
CZ,52
CO,47
EA,47
SI,41
PH,36
PE,35
YU,32
GR,32
BG,31
SK,28
MY,25
AP,24
TR,22
CR,21
MA,20
IN,19
DD,17
LT,16
JO,13
UA,13
SU,12
RS,12
CS,10
LU,9
RO,8
EC,8
ID,8
GT,7
OA,6
IS,6
LV,6
CU,5
DO,5
SA,5
EG,5
EE,5
SM,4
ME,4
TN,3
NI,3
GE,2
HN,2
PA,2
MD,2
DZ,1
ZW,1
ZM,1
Query:
-- Corrected Query 5
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name", t."country_code", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
GROUP BY "assignee_name", t."country_code"
ORDER BY "patent_count" DESC
LIMIT 100
Answer:
assignee_name,country_code,patent_count
COVIDIEN LP,US,48
BOSTON SCIENT SCIMED INC,US,37
PROCTER & GAMBLE,CA,36
PROCTER & GAMBLE,US,34
UNIV CALIFORNIA,US,33
KONINKLIJKE PHILIPS NV,US,31
MEDTRONIC INC,US,31
FUJIFILM CORP,US,25
PROCTER & GAMBLE,AU,24
OREAL,US,24
GEN ELECTRIC,US,23
GENENTECH INC,US,23
KONINKL PHILIPS ELECTRONICS NV,CN,23
NOVARTIS AG,AU,22
OLYMPUS CORP,US,22
SIEMENS AG,DE,21
LILLY CO ELI,AU,21
HOFFMANN LA ROCHE,AU,19
OREAL,JP,18
OREAL,FR,18
HOFFMANN LA ROCHE,CA,18
OLYMPUS CORP,WO,17
CARDIAC PACEMAKERS INC,US,17
UNIV TEXAS,US,17
GLOBUS MEDICAL INC,US,16
KONINKLIJKE PHILIPS NV,WO,16
US HEALTH,US,16
KIMBERLY CLARK CO,AU,16
UNIV CALIFORNIA,WO,15
SAMSUNG ELECTRONICS CO LTD,KR,15
TERUMO CORP,US,15
BAYER AG,AU,15
HOFFMANN LA ROCHE,CN,15
UNIV LELAND STANFORD JUNIOR,US,15
SIEMENS HEALTHCARE GMBH,US,15
BRISTOL MYERS SQUIBB CO,US,14
SAMSUNG ELECTRONICS CO LTD,US,14
INTUITIVE SURGICAL OPERATIONS,US,14
OREAL,BR,14
UNIV CALIFORNIA,AU,14
EDWARDS LIFESCIENCES CORP,US,14
CANON KK,US,14
CENTRE NAT RECH SCIENT,US,14
BECTON DICKINSON CO,CA,14
TOSHIBA CORP,JP,14
UNIV JOHNS HOPKINS,US,13
MEDTRONIC VASCULAR INC,US,13
FUJIFILM CORP,JP,13
PACESETTER INC,US,13
SIEMENS AG,US,13
PROCTER & GAMBLE,CN,13
AMOREPACIFIC CORP,KR,13
MERCK & CO INC,AU,13
BECTON DICKINSON CO,US,13
BEIERSDORF AG,DE,13
LG HOUSEHOLD & HEALTH CARE LTD,KR,13
HOFFMANN LA ROCHE,US,13
COLGATE PALMOLIVE CO,CA,12
HOFFMANN LA ROCHE,BR,12
BAYER AG,US,12
CILAG GMBH INT,US,12
CENTRE NAT RECH SCIENT,CA,12
NOVARTIS AG,CN,12
OREAL,AT,11
OLYMPUS CORP,JP,11
CANON KK,JP,11
NOVARTIS AG,US,11
SMITH & NEPHEW INC,US,11
LILLY CO ELI,CA,11
IBM,US,11
JANSSEN PHARMACEUTICA NV,AU,11
BRISTOL MYERS SQUIBB CO,AU,11
LILLY CO ELI,HU,11
UNIV PENNSYLVANIA,US,11
COLGATE PALMOLIVE CO,AU,11
MERCK & CO INC,CA,11
PFIZER,US,11
PROCTER & GAMBLE,EP,11
LILLY CO ELI,US,11
UNIV FLORIDA,US,10
UNIV NORTHWESTERN,US,10
ABBOTT DIABETES CARE INC,US,10
ALCON INC,AU,10
OREAL,CN,10
UNIV YONSEI IACF,KR,10
HOFFMANN LA ROCHE,AT,10
ALLERGAN INC,US,10
ASTRAZENECA AB,US,10
PROCTER & GAMBLE,MX,10
COVIDIEN LP,AU,10
PFIZER,PT,10
WYETH CORP,US,10
UNIV ZHEJIANG,CN,10
3M INNOVATIVE PROPERTIES CO,US,10
COLGATE PALMOLIVE CO,US,10
UNIV MARYLAND,US,10
ASTRAZENECA AB,AU,9
JOHNSON & JOHNSON,BR,9
SHANGHAI UNITED IMAGING HEALTHCARE CO LTD,CN,9
GENENTECH INC,AU,9
Query:
-- Corrected Query 6
SELECT DISTINCT c.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
LIMIT 100
Answer:
cpc_code
A61B6/547
A61K8/0241
A61B90/36
A61M60/205
A61M25/007
A61M2025/0037
A61B5/7465
A61B5/150099
A61B5/1126
A61F2/44
A61B2017/1205
A61K31/46
A61K9/1623
A61K8/03
A61P31/08
A61K36/13
A61P23/02
A61K39/46432
A61M16/0808
A61K33/04
A61M2205/18
A61K2236/33
A61B2017/00017
A61F13/15
A61K36/288
A61B2017/0432
A61G2210/50
A61B5/04014
A61M60/414
A61B2017/3419
A61F2002/8483
A61M25/0138
A61B3/113
A61B6/08
A61H2003/043
A61J9/0661
A61F13/474
A61L27/3641
A61M2021/0022
A61B17/26
A61B2017/3413
A61B5/1122
A61B1/125
A61B5/022
A61K31/194
A61B2017/2946
A61Q5/002
A61B17/105
A61B2018/20361
A61K31/235
A61M15/00
A61B2034/2048
A61F2005/0016
A61B17/3472
A61K51/1096
A61K31/66
A61F13/266
A61L33/0088
A61K38/2013
A61B2017/8838
A61M16/021
A61M25/0075
A61M5/502
A61K2039/60
A61F2007/0247
A61K2039/852
A61K31/145
A61H33/06
A61J1/1425
A61F9/00772
A61H33/08
A61B2017/00747
A61M5/3158
A61N1/36146
A61K31/706
A61B17/1615
A61P37/08
A61P35/02
A61K2039/5158
A61K31/497
A61K31/4188
A61J1/10
A61L24/06
A61K9/5031
A61B90/00
A61K47/68031
A61K36/88
A61M16/14
A61B5/02416
A61K9/127
A61B5/296
A61K51/0402
A61K8/0245
A61H2201/5023
A61C9/00
A61G5/027
A61B17/7011
A61B5/044
A61F2/958
A61G7/057
Query:
-- Corrected Query 7
SELECT DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year", COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "filing_year"
LIMIT 100
Answer:
filing_year,patent_count
1899,2
1900,1
1903,1
1905,1
1906,2
1907,2
1908,1
1909,1
1910,2
1911,3
1913,5
1914,5
1915,3
1916,3
1917,1
1920,2
1921,4
1922,1
1923,3
1924,2
1926,2
1927,3
1928,6
1929,4
1930,1
1931,6
1932,3
1933,2
1934,4
1935,9
1936,10
1937,4
1938,3
1939,4
1940,6
1941,7
1942,2
1943,5
1944,4
1945,7
1946,6
1947,3
1948,8
1949,6
1950,9
1951,6
1952,7
1953,10
1954,7
1955,11
1956,7
1957,11
1958,15
1959,10
1960,11
1961,20
1962,17
1963,22
1964,22
1965,24
1966,34
1967,19
1968,32
1969,42
1970,47
1971,38
1972,64
1973,84
1974,89
1975,82
1976,94
1977,102
1978,112
1979,95
1980,104
1981,133
1982,122
1983,144
1984,117
1985,156
1986,179
1987,169
1988,212
1989,217
1990,249
1991,245
1992,281
1993,296
1994,303
1995,327
1996,363
1997,413
1998,445
1999,505
2000,511
2001,633
2002,640
2003,761
2004,756
2005,781
End Exploring Related Columns
Task: For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 04:33:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:33:50 - root - INFO - To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```sql
WITH procter_patents AS (
  SELECT
    t."publication_number",
    t."country_code",
    DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
  FROM PATENTS.PATENTS.PUBLICATIONS t
       LATERAL FLATTEN(input => t."cpc") c,
       LATERAL FLATTEN(input => t."assignee_harmonized") a
  WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    AND a.value::VARIANT:"name"::STRING = 'PROCTER & GAMBLE'
    AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
busiest_year AS (
  SELECT "filing_year"
  FROM procter_patents
  GROUP BY "filing_year"
  ORDER BY COUNT(DISTINCT "publication_number") DESC
  LIMIT 1
),
top_countries AS (
  SELECT "country_code", COUNT(DISTINCT "publication_number") AS "patent_count"
  FROM procter_patents
  WHERE "filing_year" = (SELECT "filing_year" FROM busiest_year)
  GROUP BY "country_code"
  ORDER BY "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_countries;
```
2025-01-26 04:33:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:51 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:52 - root - INFO - itercount: 1
2025-01-26 04:33:52 - root - INFO - 001003 (42000): 01b9f651-0004-7d15-0001-11c300fa9b3a: SQL compilation error:
syntax error line 7 at position 7 unexpected 'LATERAL'.
syntax error line 7 at position 23 unexpected 'input'.
syntax error line 7 at position 41 unexpected 'c'.
2025-01-26 04:33:52 - root - INFO - Input sql:
WITH procter_patents AS (
  SELECT
    t."publication_number",
    t."country_code",
    DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
  FROM PATENTS.PATENTS.PUBLICATIONS t
       LATERAL FLATTEN(input => t."cpc") c,
       LATERAL FLATTEN(input => t."assignee_harmonized") a
  WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    AND a.value::VARIANT:"name"::STRING = 'PROCTER & GAMBLE'
    AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
busiest_year AS (
  SELECT "filing_year"
  FROM procter_patents
  GROUP BY "filing_year"
  ORDER BY COUNT(DISTINCT "publication_number") DESC
  LIMIT 1
),
top_countries AS (
  SELECT "country_code", COUNT(DISTINCT "publication_number") AS "patent_count"
  FROM procter_patents
  WHERE "filing_year" = (SELECT "filing_year" FROM busiest_year)
  GROUP BY "country_code"
  ORDER BY "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_countries;
The error information is:
001003 (42000): 01b9f651-0004-7d15-0001-11c300fa9b3a: SQL compilation error:
syntax error line 7 at position 7 unexpected 'LATERAL'.
syntax error line 7 at position 23 unexpected 'input'.
syntax error line 7 at position 41 unexpected 'c'.
Please correct it and output only 1 complete SQL query.
2025-01-26 04:34:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:34:20 - root - INFO - ```sql
WITH procter_patents AS (
  SELECT
    t."publication_number",
    t."country_code",
    DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       LATERAL FLATTEN(input => t."cpc") c,
       LATERAL FLATTEN(input => t."assignee_harmonized") a
  WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    AND a.value::VARIANT:"name"::STRING = 'PROCTER & GAMBLE'
    AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
busiest_year AS (
  SELECT "filing_year"
  FROM procter_patents
  GROUP BY "filing_year"
  ORDER BY COUNT(DISTINCT "publication_number") DESC
  LIMIT 1
),
top_countries AS (
  SELECT "country_code", COUNT(DISTINCT "publication_number") AS "patent_count"
  FROM procter_patents
  WHERE "filing_year" = (SELECT "filing_year" FROM busiest_year)
  GROUP BY "country_code"
  ORDER BY "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_countries;
```
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 04:34:21 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:22 - root - INFO - itercount: 2
2025-01-26 04:34:22 - root - INFO - 0
2025-01-26 04:34:22 - root - INFO - results: 
Jurisdiction_Codes
"CA,US,NO,AT,PL"


2025-01-26 04:34:22 - root - INFO - Please check the answer again by reviewing For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Jurisdiction_Codes
"CA,US,NO,AT,PL"
Current sql:
WITH procter_patents AS (
  SELECT
    t."publication_number",
    t."country_code",
    DATE_PART('year', TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       LATERAL FLATTEN(input => t."cpc") c,
       LATERAL FLATTEN(input => t."assignee_harmonized") a
  WHERE c.value::VARIANT:"code"::STRING LIKE 'A61%'
    AND a.value::VARIANT:"name"::STRING = 'PROCTER & GAMBLE'
    AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
busiest_year AS (
  SELECT "filing_year"
  FROM procter_patents
  GROUP BY "filing_year"
  ORDER BY COUNT(DISTINCT "publication_number") DESC
  LIMIT 1
),
top_countries AS (
  SELECT "country_code", COUNT(DISTINCT "publication_number") AS "patent_count"
  FROM procter_patents
  WHERE "filing_year" = (SELECT "filing_year" FROM busiest_year)
  GROUP BY "country_code"
  ORDER BY "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_countries;
2025-01-26 04:34:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:34:57 - root - INFO - To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61', which is **PROCTER & GAMBLE**. Next, we find the year in which this assignee filed the most patents, which is **1997**. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
CA,US,NO,AT,PL
(Attention: answer in one row)
```
2025-01-26 04:34:57 - root - INFO - []
2025-01-26 04:34:57 - root - INFO - To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61', which is **PROCTER & GAMBLE**. Next, we find the year in which this assignee filed the most patents, which is **1997**. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
CA,US,NO,AT,PL
(Attention: answer in one row)
```
2025-01-26 04:34:57 - root - INFO - Total iteration counts: 2
