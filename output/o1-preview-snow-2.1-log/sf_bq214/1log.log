2025-01-20 05:59:10 - openai._base_client - INFO - Retrying request to /chat/completions in 0.436090 seconds
2025-01-20 06:00:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:00:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-20 06:00:16 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:17 - root - INFO - SQL:
SELECT DISTINCT "kind_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
Results:
kind_code
B
Y1
I1
T9
U9
B8
R1
H
T3
D1
U4
K4
Z1
A5
B3
T4
P1
R2
P
A4
T5
A8
I5
I2
V0
B1
S
D2
U8
Y2
T2
H1
T7
L
A0
B9
T1
Y4
R
K1
U
F
C1
T0
T8
U0
U1
A6
Y
A1
S1
M
U3
C9
C2
B4
C5
H3
A3
K5
E
D0
A2
I4
C
A
P3
P2
T
B2
A9
E1
C3
A7

2025-01-20 06:00:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:18 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:19 - root - INFO - SQL:
SELECT "publication_number", "country_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "country_code" = 'US'
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,country_code
US-2008248346-A1,US
US-2006098678-A1,US
US-5995882-A,US
US-D763862-S,US
US-6069490-A,US
US-4158426-A,US
US-9156652-B1,US
US-4573529-A,US
US-3409741-A,US
US-8719279-B2,US
US-2009204131-A1,US
US-3730531-A,US
US-5954205-A,US
US-3476385-A,US
US-2484101-A,US
US-2973985-A,US
US-2011248506-A1,US
US-4730930-A,US
US-6999717-B2,US
US-3511345-A,US
US-6612888-B1,US
US-5824842-A,US
US-2005204400-A1,US
US-2011154017-A1,US
US-2003154333-A1,US
US-2009215757-A1,US
US-2016138809-A1,US
US-2015068250-A1,US
US-2737418-A,US
US-2008033106-A1,US
US-8600107-B2,US
US-8370222-B2,US
US-2015366719-A1,US
US-6294170-B1,US
US-8334212-B2,US
US-2008028128-A1,US
US-6459987-B1,US
US-8666920-B2,US
US-2006198383-A1,US
US-7521122-B2,US
US-8661280-B2,US
US-2012329609-A1,US
US-2011177058-A1,US
US-2015058734-A1,US
US-2010182548-A1,US
US-2012212947-A1,US
US-2013086659-A1,US
US-2011055569-A1,US
US-2015086941-A1,US
US-2005001467-A1,US
US-2014020289-A1,US
US-9714722-B2,US
US-2007169335-A1,US
US-2010320277-A1,US
US-4547317-A,US
US-3387543-A,US
US-9610687-B2,US
US-8197428-B2,US
US-3709047-A,US
US-2009326460-A1,US
US-2017144221-A1,US
US-2006093549-A1,US
US-2014252590-A1,US
US-2008018479-A1,US
US-2009121361-A1,US
US-5589623-A,US
US-4271694-A,US
US-2006223953-A1,US
US-2015089988-A1,US
US-2015313150-A1,US
US-9049883-B2,US
US-2004205135-A1,US
US-2005263439-A1,US
US-2015052615-A1,US
US-2014013730-A1,US
US-2011096894-A1,US
US-2007113176-A1,US
US-2010054620-A1,US
US-8976393-B2,US
US-6955226-B2,US
US-2994468-A,US
US-4315100-A,US
US-4475935-A,US
US-5606980-A,US
US-8492762-B2,US
US-2016266823-A1,US
US-2006228948-A1,US
US-6118434-A,US
US-7464036-B1,US
US-3425201-A,US
US-3373486-A,US
US-3267593-A,US
US-7785372-B2,US
US-8163114-B2,US
US-4803369-A,US
US-4254651-A,US
US-4986127-A,US
US-9419736-B2,US
US-2005213316-A1,US
US-3242892-A,US
US-5545682-A,US
US-3569737-A,US
US-2746319-A,US
US-5348907-A,US
US-2014043950-A1,US
US-2013145150-A1,US
US-2009198615-A1,US
US-2011179357-A1,US
US-9155072-B2,US
US-4240112-A,US
US-5480477-A,US
US-5353982-A,US
US-2013259848-A1,US
US-5231499-A,US
US-6126232-A,US
US-2004013375-A1,US
US-5772961-A,US
US-5764786-A,US
US-7556775-B2,US
US-9620890-B1,US
US-6713367-B2,US
US-7655498-B2,US
US-9755000-B2,US
US-8150419-B2,US
US-2015106209-A1,US
US-8399429-B2,US
US-8807253-B2,US
US-2012150596-A1,US
US-2007171190-A1,US
US-2003219132-A1,US
US-6500413-B1,US
US-2001016508-A1,US
US-2013201919-A1,US
US-2013141431-A1,US
US-2015140236-A1,US
US-2014271228-A1,US
US-2009038341-A1,US
US-2012027574-A1,US
US-9527579-B2,US
US-2004182673-A1,US
US-2014206801-A1,US
US-2010120789-A1,US
US-7762801-B2,US
US-2009240984-A1,US
US-2009201033-A1,US
US-2009119651-A1,US
US-2013042794-A1,US
US-2013004710-A1,US
US-2010059170-A1,US
US-2017118514-A1,US
US-2014098307-A1,US
US-2014130035-A1,US
US-2009184353-A1,US
US-8077560-B2,US
US-9421780-B2,US
US-2016194291-A1,US
US-2010331020-A1,US
US-2005074520-A1,US
US-2006094172-A1,US
US-2008110653-A1,US
US-2006213849-A1,US
US-2709513-A,US
US-2007299716-A1,US
US-9650267-B2,US
US-8979585-B2,US
US-4915067-A,US
US-2734483-A,US
US-7933348-B2,US
US-9464056-B2,US
US-7655776-B2,US
US-4127231-A,US
US-2016234859-A1,US
US-6257184-B1,US
US-3069475-A,US
US-5996531-A,US
US-4952925-A,US
US-4873469-A,US
US-2008273841-A1,US
US-2016138857-A1,US
US-7393635-B2,US
US-7971258-B1,US
US-4823249-A,US
US-3400065-A,US
US-4739488-A,US
US-9289723-B2,US
US-5050477-A,US
US-D750284-S,US
US-2682632-A,US
US-2014180104-A1,US
US-3479443-A,US
US-4754382-A,US
US-3079329-A,US
US-7883339-B2,US
US-2015054070-A1,US
US-2004260555-A1,US
US-9465333-B2,US
US-D331040-S,US
US-2489114-A,US
US-5897314-A,US
US-2017075824-A1,US
US-2004176512-A1,US
US-4743763-A,US
US-8611388-B2,US
US-2009205842-A1,US
US-2007017751-A1,US
US-2008309029-A1,US
US-6154657-A,US
US-5098481-A,US
US-6184027-B1,US
US-9036463-B2,US
US-2004040355-A1,US
US-2003079197-A1,US
US-2004120289-A1,US
US-2010150882-A1,US
US-2007285051-A1,US
US-5790489-A,US
US-8469679-B2,US
US-7114564-B2,US
US-3274058-A,US
US-3148530-A,US
US-4465459-A,US
US-4048106-A,US
US-5275269-A,US
US-6422372-B2,US
US-7352425-B2,US
US-8403824-B2,US
US-2014259935-A1,US
US-8006496-B2,US
US-9076454-B2,US
US-2016220827-A1,US
US-2014076193-A1,US
US-2006170900-A1,US
US-9020108-B1,US
US-7075826-B2,US
US-9582120-B2,US
US-2008010051-A1,US
US-2006001934-A1,US
US-2009047162-A1,US
US-2012325217-A1,US
US-7060739-B2,US
US-2008221347-A1,US
US-7815109-B2,US
US-2015015026-A1,US
US-2015052360-A1,US
US-6672202-B2,US
US-2015058087-A1,US
US-2011080003-A1,US
US-2004058183-A1,US
US-2004076508-A1,US
US-2015165314-A1,US
US-2007128845-A1,US
US-8985352-B2,US
US-2772439-A,US
US-2010225265-A1,US
US-2014227373-A1,US
US-2007087396-A1,US
US-2011076946-A1,US
US-2009010147-A1,US
US-2005170882-A1,US
US-2005096737-A1,US
US-RE30702-E,US
US-5609586-A,US
US-4727490-A,US
US-8593015-B2,US
US-6052110-A,US
US-2013322605-A1,US
US-2005280665-A1,US
US-2009112550-A1,US
US-6908096-B2,US
US-2008182619-A1,US
US-2004086320-A1,US
US-2010213560-A1,US
US-5151786-A,US
US-2529907-A,US
US-33

2025-01-20 06:00:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:20 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:21 - root - INFO - SQL:
SELECT "publication_number", "grant_date"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20100101 AND 20141231
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,grant_date
EP-2409946-B1,20140507
JP-5036281-B2,20120926
GB-201008313-D0,20100707
JP-5065641-B2,20121107
CN-202476678-U,20121010
JP-5008058-B2,20120822
JP-5439596-B2,20140312
CN-201875846-U,20110622
CN-202377459-U,20120815
CN-202386491-U,20120822
CN-203879581-U,20141015
EP-1775720-B1,20111109
CN-201778352-U,20110330
CN-202008336-U,20111012
CN-202751797-U,20130227
CN-201482889-U,20100526
JP-5551640-B2,20140716
CN-201750912-U,20110223
CN-202788073-U,20130313
CA-2533614-C,20110503
CN-102392153-B,20140115
EP-1832160-B1,20110223
CN-102221073-B,20130327
US-8768622-B2,20140701
CN-103146534-B,20140319
KR-101284644-B1,20130711
KR-101356112-B1,20140129
US-7727119-B2,20100601
RU-2499633-C1,20131127
CN-102123931-B,20130515
CN-101421795-B,20130306
CN-101983201-B,20140423
CN-101546982-B,20110413
CN-102035046-B,20130612
KR-101248374-B1,20130401
CN-102838039-B,20140903
CN-1989298-B,20101117
CN-102001537-B,20130327
CN-102507392-B,20130814
CN-101753397-B,20121114
CN-100594022-C,20100317
CN-102372790-B,20130410
RU-2449358-C1,20120427
US-8591484-B2,20131126
CN-203550037-U,20140416
JP-4712713-B2,20110629
DE-202011052218-U1,20130109
JP-4538960-B2,20100908
RU-2465397-C1,20121027
US-8894929-B2,20141125
JP-4591505-B2,20101201
GB-2475537-B,20120125
CN-102170665-B,20130807
CN-102168881-B,20130619
KR-100994778-B1,20101117
CN-100591970-C,20100224
US-8550498-B2,20131008
CN-102108427-B,20120530
DE-102008053495-B4,20130103
CN-102449429-B,20140423
CN-101719181-B,20120704
CN-103634577-B,20141231
CN-102020446-B,20131023
US-8084696-B2,20111227
CN-101204742-B,20100526
US-8719990-B2,20140513
CN-101539009-B,20111005
CN-101576374-B,20110525
KR-101220417-B1,20130110
CN-101229787-B,20100901
CN-102017578-B,20141210
US-8719514-B2,20140506
US-8324898-B2,20121204
JP-4678032-B2,20110427
KR-101326001-B1,20131120
DE-102010036823-B8,20110818
US-7746011-B2,20100629
EP-1498629-B2,20131016
KR-101211327-B1,20121211
KR-101222043-B1,20130115
JP-4739062-B2,20110803
KR-100989724-B1,20101026
CN-102267494-B,20130123
US-8613206-B2,20131224
KR-101357430-B1,20140206
CN-1614956-B,20100505
US-7819758-B2,20101026
KR-101414981-B1,20140704
CN-101932380-B,20140319
NL-1037900-C,20111021
CN-101259887-B,20101013
CN-101847042-B,20111228
CN-101180839-B,20120215
CN-102234769-B,20141105
CN-101459378-B,20110309
CN-101302157-B,20110427
KR-101297073-B1,20130814
US-8729750-B2,20140520
US-7990739-B2,20110802
US-8824115-B2,20140902
CN-101253079-B,20101103
CN-100587710-C,20100203
DE-10308893-B4,20130919
KR-101009365-B1,20110119
CN-102064876-B,20130807
KR-101453731-B1,20141023
CN-101444011-B,20130220
US-8518784-B2,20130827
RU-2457643-C2,20120810
JP-4750889-B2,20110817
CN-101550011-B,20111005
CN-101549190-B,20120208
CN-101330719-B,20110810
KR-101379971-B1,20140410
CN-102158275-B,20131218
US-8141404-B2,20120327
US-7912686-B2,20110322
US-7904645-B2,20110308
CN-101586954-B,20120725
CN-103115813-B,20141022
CN-102688095-B,20140827
KR-100977469-B1,20100823
US-8073568-B2,20111206
US-8792886-B2,20140729
US-8528838-B2,20130910
CN-1986652-B,20101117
DE-10242257-B4,20131219
CN-1965694-B,20100414
CN-102526592-B,20130925
US-8023832-B2,20110920
RU-2511820-C2,20140410
CN-101890356-B,20130123
CN-1876659-B,20101222
GB-2451060-B,20130109
CN-101977996-B,20130102
CN-101820209-B,20121107
KR-100957377-B1,20100511
DE-102011006417-B3,20120830
KR-101155542-B1,20120618
CN-101552453-B,20120111
KR-101249589-B1,20130401
DE-102011016802-B4,20130221
CN-101029336-B,20101103
US-7786464-B2,20100831
KR-100970215-B1,20100716
US-7831404-B2,20101109
US-8508659-B2,20130813
CN-102036066-B,20130619
CN-102653256-B,20141105
CN-101510138-B,20120711
US-8073622-B2,20111206
US-8288748-B2,20121016
CN-101906454-B,20120815
US-8167061-B2,20120501
US-D620166-S,20100720
CN-102690433-B,20140716
CN-102113186-B,20140625
KR-101154296-B1,20120613
US-8218633-B2,20120710
CN-101811426-B,20121226
CN-102697304-B,20140402
CN-102249729-B,20130320
DE-10302601-B4,20100114
CN-103184225-B,20140813
RU-2500182-C1,20131210
CN-1889342-B,20100421
CN-101379515-B,20130102
CN-101243270-B,20110706
CN-102391195-B,20140507
JP-4600012-B2,20101215
CN-101937150-B,20120104
US-8154416-B1,20120410
US-8924594-B2,20141230
CN-102542858-B,20140611
US-8100264-B2,20120124
JP-5044395-B2,20121010
GB-2480765-B,20120801
KR-101147917-B1,20120525
CN-101592546-B,20121024
CN-101065445-B,20110511
JP-4925317-B2,20120425
CN-203099880-U,20130731
CN-203203414-U,20130918
RU-2397920-C2,20100827
CN-203705655-U,20140709
EP-2060396-B1,20100929
JP-5094281-B2,20121212
CN-202309349-U,20120704
ES-2399998-T3,20130404
CN-203953961-U,20141126
EP-2384771-B1,20130123
JP-5400994-B2,20140129
KR-101161137-B1,20120702
CN-201770958-U,20110323
US-8058883-B2,20111115
CN-203557466-U,20140423
EP-1979895-B1,20131009
CN-202344020-U,20120725
CN-203920796-U,20141105
CN-203265043-U,20131106
CN-203348719-U,20131218
CN-201534006-U,20100728
CN-201662302-U,20101201
JP-4787078-B2,20111005
JP-5142712-B2,20130213
CN-203999256-U,20141210
US-8548365-B2,20131001
CN-202833828-U,20130327
EP-1627846-B1,20100203
GB-

2025-01-20 06:00:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:22 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:23 - root - INFO - SQL:
SELECT "publication_number", "kind_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "kind_code" LIKE '%B2'
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,kind_code
US-6594862-B2,B2
US-8395734-B2,B2
US-7781260-B2,B2
JP-4565593-B2,B2
JP-4813799-B2,B2
US-7197968-B2,B2
US-6766870-B2,B2
JP-4719627-B2,B2
US-7518315-B2,B2
US-7879487-B2,B2
US-8229907-B2,B2
US-8405269-B2,B2
US-8423896-B2,B2
US-8694822-B2,B2
JP-H0625495-B2,B2
US-7717638-B2,B2
US-9658993-B2,B2
US-7432680-B2,B2
US-8984416-B2,B2
JP-H0476664-B2,B2
US-7255124-B2,B2
US-8503036-B2,B2
US-8178184-B2,B2
US-6946026-B2,B2
US-6924955-B2,B2
US-8879934-B2,B2
US-8547039-B2,B2
US-8802933-B2,B2
JP-H0535581-B2,B2
US-6903210-B2,B2
US-6788828-B2,B2
US-8103295-B2,B2
US-7581880-B2,B2
JP-4697146-B2,B2
US-9614020-B2,B2
US-8673549-B2,B2
JP-S551137-B2,B2
JP-S6236258-B2,B2
JP-H0431096-B2,B2
US-7495178-B2,B2
US-7690976-B2,B2
JP-S551734-B2,B2
US-6743873-B2,B2
US-8142536-B2,B2
US-8520301-B2,B2
US-8463797-B2,B2
US-7173260-B2,B2
US-7218306-B2,B2
JP-4622665-B2,B2
US-9322575-B2,B2
US-8251903-B2,B2
US-8011721-B2,B2
JP-3203231-B2,B2
JP-S6260989-B2,B2
JP-4496124-B2,B2
JP-4676540-B2,B2
US-7674988-B2,B2
US-7890720-B2,B2
US-7587611-B2,B2
US-8555064-B2,B2
US-9388108-B2,B2
JP-S5827857-B2,B2
JP-S6352211-B2,B2
US-9005975-B2,B2
US-9346287-B2,B2
US-7001361-B2,B2
US-8768622-B2,B2
US-9185508-B2,B2
US-9083834-B2,B2
US-7727119-B2,B2
JP-H0313720-B2,B2
US-8970668-B2,B2
US-9525112-B2,B2
US-6870915-B2,B2
US-7462187-B2,B2
US-7331956-B2,B2
US-8591484-B2,B2
US-8975032-B2,B2
JP-4712713-B2,B2
JP-4538960-B2,B2
US-6533371-B2,B2
US-8894929-B2,B2
US-7434357-B2,B2
JP-3401622-B2,B2
JP-4591505-B2,B2
US-6389824-B2,B2
US-9517750-B2,B2
JP-S5638173-B2,B2
JP-H0157315-B2,B2
US-8550498-B2,B2
JP-S5346988-B2,B2
US-8084696-B2,B2
US-6805302-B2,B2
US-9452126-B2,B2
US-9599863-B2,B2
US-8719990-B2,B2
JP-S5854321-B2,B2
US-8719514-B2,B2
US-8324898-B2,B2
JP-4678032-B2,B2
US-9243443-B2,B2
US-7421500-B2,B2
US-7235054-B2,B2
US-6913017-B2,B2
US-7746011-B2,B2
US-9214335-B2,B2
EP-1498629-B2,B2
US-9520403-B2,B2
JP-S5640564-B2,B2
JP-4739062-B2,B2
US-7142898-B2,B2
US-9008481-B2,B2
US-7164145-B2,B2
US-9027286-B2,B2
US-8984469-B2,B2
US-7431883-B2,B2
US-9384181-B2,B2
US-7540698-B2,B2
JP-3524143-B2,B2
JP-4668734-B2,B2
JP-H0363498-B2,B2
JP-S639222-B2,B2
US-7118014-B2,B2
US-9200008-B2,B2
US-7715549-B2,B2
JP-4754687-B2,B2
US-6723201-B2,B2
US-9293519-B2,B2
US-9711737-B2,B2
US-7130860-B2,B2
US-9660655-B2,B2
US-9624723-B2,B2
JP-5936769-B2,B2
JP-4603859-B2,B2
US-9683466-B2,B2
JP-4725216-B2,B2
US-9186273-B2,B2
JP-4629064-B2,B2
US-9077131-B2,B2
US-7868069-B2,B2
JP-H0558115-B2,B2
US-9022857-B2,B2
US-6906028-B2,B2
US-6555432-B2,B2
US-9224593-B2,B2
US-6915077-B2,B2
JP-H0437939-B2,B2
JP-S5637886-B2,B2
US-8908076-B2,B2
US-9108579-B2,B2
US-6590697-B2,B2
US-7848876-B2,B2
JP-2552101-B2,B2
JP-4641386-B2,B2
US-8213542-B2,B2
JP-2790475-B2,B2
US-7063971-B2,B2
US-6914807-B2,B2
US-8700554-B2,B2
JP-H0831880-B2,B2
JP-4562710-B2,B2
JP-3420081-B2,B2
US-9104816-B2,B2
US-6806882-B2,B2
US-9593877-B2,B2
US-6868666-B2,B2
US-6913759-B2,B2
US-7480745-B2,B2
US-7548036-B2,B2
US-8201355-B2,B2
US-7540586-B2,B2
US-6572968-B2,B2
US-7205403-B2,B2
US-8267414-B2,B2
JP-S5410401-B2,B2
JP-4757867-B2,B2
US-6859647-B2,B2
US-9308400-B2,B2
US-7123470-B2,B2
JP-H0333301-B2,B2
US-8235477-B2,B2
US-8876205-B2,B2
JP-H021650-B2,B2
US-8986204-B2,B2
US-8359599-B2,B2
US-6747341-B2,B2
US-6778157-B2,B2
US-9260719-B2,B2
US-9695715-B2,B2
US-8431428-B2,B2
JP-4645099-B2,B2
JP-H0223262-B2,B2
JP-S6059371-B2,B2
US-7756298-B2,B2
US-8746172-B2,B2
US-9453841-B2,B2
JP-H0379254-B2,B2
JP-2536575-B2,B2
US-8412097-B2,B2
US-8636026-B2,B2
US-7479454-B2,B2
US-6851712-B2,B2
US-7212673-B2,B2
US-7375773-B2,B2
US-7510057-B2,B2
US-8103516-B2,B2
US-9047865-B2,B2
US-9617863-B2,B2
US-7552891-B2,B2
US-9084332-B2,B2
US-7387605-B2,B2
US-6933842-B2,B2
US-6885763-B2,B2
US-7083680-B2,B2
US-7248611-B2,B2
US-8613206-B2,B2
JP-S591835-B2,B2
US-9674419-B2,B2
JP-S6354556-B2,B2
US-7819758-B2,B2
JP-H0338770-B2,B2
US-7268660-B2,B2
US-8729750-B2,B2
JP-S6121077-B2,B2
US-7990739-B2,B2
US-8824115-B2,B2
US-7564947-B2,B2
US-7434319-B2,B2
JP-3421335-B2,B2
US-8518784-B2,B2
JP-4750889-B2,B2
US-7094526-B2,B2
US-7179147-B2,B2
US-9190721-B2,B2
US-8141404-B2,B2
US-7454208-B2,B2
US-7912686-B2,B2
US-7904645-B2,B2
US-7473042-B2,B2
JP-2771994-B2,B2
US-6856148-B2,B2
US-8073568-B2,B2
JP-H0430718-B2,B2
JP-S6256322-B2,B2
US-8792886-B2,B2
US-8528838-B2,B2
US-6799231-B2,B2
US-8023832-B2,B2
US-6510198-B2,B2
US-7251263-B2,B2
JP-S6313360-B2,B2
US-7009545-B2,B2
US-9670686-B2,B2
US-9151051-B2,B2
US-7786464-B2,B2
US-7316311-B2,B2
US-7831404-B2,B2
US-8508659-B2,B2
JP-H051721-B2,B2
JP-3119392-B2,B2
US-9614151-B2,B2
US-8073622-B2,B2
US-8288748-B2,B2
US-9093289-B2,B2
US-8167061-B2,B2
US-7360462-B2,B2
US-6805600-B2,B2
US-8218633-B2,B2
US-6478806-B2,B2
JP-4600012-B2,B2
US-9195479-B2,B2
US-8924594-B2,B2
JP-S6327251-B2,B2
JP-S5346597-B2,B2
US-8100264-B2,B2
JP-5044395-B2,B2
US-7238129-B2,B2
JP-4648256-B2,B2
US-9684554-B2,B2
US-9653321-B2,B2
US-7894831-B2,B2
JP-H052284-B2,B2
JP-S5332017-B2,B2
US-7506485-B2,B2
US-6895754-B2,B2
US-8769944-B2,B2
US-8242652-B2,B2
US-8802367-B2,B2
US-8256557-B2,B2
US-9145233-B2,B2
US-82304

2025-01-20 06:00:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 668
2025-01-20 06:00:26 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:26 - root - INFO - SQL:
SELECT t."publication_number", f.value AS "cited_by_publication"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
   LATERAL FLATTEN(input => t."cited_by") f
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cited_by_publication
DE-318-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4377202-A"",
  ""type"": """"
}"
DE-6066-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1177870-B"",
  ""type"": """"
}"
DE-8199-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-10358537-A1"",
  ""type"": """"
}"
DE-9260-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-102004014318-A1"",
  ""type"": """"
}"
US-5418-P,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-PP27981-P3"",
  ""type"": """"
}"
US-5582-P,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-10478-P"",
  ""type"": """"
}"
US-7752-P,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2580807-A"",
  ""type"": """"
}"
US-7765-P,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-8038-P"",
  ""type"": """"
}"
CA-86501-S,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-D797248-S"",
  ""type"": """"
}"
CA-93339-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5328283-A"",
  ""type"": """"
}"
DE-13739-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1043865-B"",
  ""type"": """"
}"
DE-16474-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5037250-A"",
  ""type"": """"
}"
DE-16894-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1277699-B"",
  ""type"": """"
}"
DE-25283-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-930703-C"",
  ""type"": """"
}"
DE-26411-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""FR-2421020-A1"",
  ""type"": ""X""
}"
DE-29220-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-2134755-A1"",
  ""type"": """"
}"
DE-29420-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5509449-A"",
  ""type"": """"
}"
DE-32777-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-4241373-A1"",
  ""type"": """"
}"
DE-33237-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1141136-B"",
  ""type"": """"
}"
DE-35627-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5771599-A"",
  ""type"": """"
}"
DE-38499-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4577722-A"",
  ""type"": """"
}"
DE-51226-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2784744-A"",
  ""type"": """"
}"
DE-53179-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1918780-A1"",
  ""type"": """"
}"
DE-61256-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-965812-C"",
  ""type"": """"
}"
DE-64210-C,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-02061207-A1"",
  ""type"": ""Y""
}"
DE-68962-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4492046-A"",
  ""type"": """"
}"
DE-69706-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-3282606-A"",
  ""type"": """"
}"
DE-76735-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publica

2025-01-20 06:00:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:00:27 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:28 - root - INFO - SQL:
SELECT "publication_number", ARRAY_SIZE("cited_by") AS "forward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,forward_citation_count
CA-27-A,0
ES-81-Y,0
DE-303-C,0
ES-866-Y,0
FI-150-A,0
FI-250-A,0
FR-336-E,0
NL-284-C,0
NL-947-C,0
BE-107-T1,0
CA-1911-A,0
CA-4005-A,0
CA-4106-A,0
CA-4698-A,0
CA-4801-A,0
CA-5943-A,0
CA-6183-A,0
CA-6207-A,0
CA-6390-A,0
CA-6969-A,0
CA-8931-S,0
CA-9897-A,0
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,0
DK-3080-C,0
DK-3107-C,0
DK-3184-C,0
DK-3510-C,0
DK-5867-C,0
DK-5921-C,0
DK-6491-A,0
DK-7210-C,0
DK-8069-C,0
DK-8466-C,0
DK-9281-C,0
DK-9359-C,0
ES-1062-U,0
ES-1498-U,0
ES-1524-Y,0
ES-1872-U,0
ES-2542-Y,0
ES-2819-Y,0
ES-2960-U,0
ES-3045-U,0
ES-4483-Y,0
ES-4723-Y,0
ES-4858-U,0
ES-5089-Y,0
ES-5219-Y,0
ES-5716-U,0
ES-5975-Y,0
ES-6454-U,0
ES-6552-Y,0
ES-6928-Y,0
ES-6962-Y,0
ES-7086-Y,0
ES-7407-Y,0
ES-7489-Y,0
ES-7516-U,0
ES-7538-U,0
ES-764-H3,0
ES-8269-Y,0
FI-1825-A,0
FI-291-U1,0
FI-3021-A,0
FI-4211-A,0
FI-4543-A,0
FI-8034-A,0
FI-8619-A,0
FI-8985-A,0
FI-902-U1,0
FR-1186-E,0
FR-1382-E,0
FR-1550-M,0
FR-2064-E,0
FR-2510-M,0
FR-2578-M,0
FR-2635-E,0
FR-3293-M,0
FR-5174-E,0
FR-5770-E,0
FR-7085-M,0
FR-7747-E,0
FR-8053-M,0
FR-8143-M,0
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,0
RU-815-U1,0
US-1260-A,0
US-1844-A,0
US-3704-A,0
US-4174-P,0
US-4340-A,0
US-4449-P,0
US-4570-P,0
US-5293-P,0
US-5333-A,0
US-5618-A,0
US-6399-A,0
US-6501-P,0
US-7090-A,0
US-7624-A,0
US-7703-P,0
US-7765-P,0
US-8162-P,0
US-8923-P,0
US-9153-A,0
US-9563-A,0
US-H817-H,0
CA-10240-A,0
CA-10445-A,0
CA-11856-A,0
CA-12085-A,0
CA-12299-A,0
CA-12359-A,0
CA-12986-A,0
CA-14364-A,0
CA-15108-A,0
CA-15467-A,0
CA-16464-A,0
CA-16944-A,0
CA-17107-A,0
CA-18535-S,0
CA-19006-S,0
CA-21676-A,0
CA-21706-A,0
CA-21979-A,0
CA-22497-S,0
CA-22705-A,0
CA-23044-A,0
CA-25240-S,0
CA-25587-A,0
CA-26172-A,0
CA-27810-A,0
CA-29171-S,0
CA-29565-A,0
CA-30563-S,0
CA-30747-A,0
CA-31066-A,0
CA-31656-A,0
CA-34117-A,0
CA-34328-A,0
CA-35530-A,0
CA-36126-A,0
CA-37060-A,0
CA-37412-A,0
CA-38186-A,0
CA-38290-A,0
CA-38566-A,0
CA-39941-A,0
CA-41986-A,0
CA-42957-A,0
CA-43582-A,0
CA-43613-A,0
CA-43665-A,0
CA-44103-A,0
CA-44675-A,0
CA-45114-S,0
CA-45162-A,0
CA-46041-S,0
CA-46346-S,0
CA-46414-S,0
CA-46650-A,0
CA-47228-S,0
CA-47556-A,0
CA-47943-A,0
CA-48005-S,0
CA-50059-A,0
CA-51084-S,0
CA-51448-A,0
CA-53020-A,0
CA-53342-A,0
CA-53679-A,0
CA-54019-A,0
CA-56199-S,0
CA-57871-A,0
CA-58112-A,0
CA-59658-S,0
CA-62116-A,0
CA-63512-A,0
CA-64348-A,0
CA-64895-A,0
CA-64959-A,0
CA-65051-A,0
CA-65468-A,0
CA-66408-A,0
CA-67027-A,0
CA-67256-A,0
CA-68355-A,0
CA-68561-A,0
CA-69952-A,0
CA-69969-A,0
CA-70837-S,0
CA-71352-A,0
CA-72557-S,0
CA-73229-S,0
CA-73434-A,0
CA-73648-A,0
CA-75054-A,0
CA-75833-A,0
CA-75940-A,0
CA-76442-A,0
CA-77673-S,0
CA-78154-A,0
CA-78848-A,0
CA-80485-S,0
CA-81879-A,0
CA-82735-A,0
CA-83640-A,0
CA-84428-S,0
CA-84611-A,0
CA-85458-S,0
CA-87085-A,0
CA-87655-A,0
CA-88869-A,0
CA-89598-S,0
CA-90451-A,0
CA-90703-A,0
CA-91407-A,0
CA-91839-A,0
CA-92136-S,0
CA-92671-S,0
CA-93153-A,0
CA-93847-S,0
CA-94404-A,0
CA-94834-A,0
CA-95812-A,0
CA-96813-A,0
CA-97691-A,0
CA-97784-A,0
CA-98415-S,0
CA-98613-A,0
CA-98742-A,0
CA-99391-S,0
CA-99529-A,0
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,0
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,0
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,0
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,0
DK-11017-C,0
DK-11274-A,0
DK-11549-C,0
DK-13429-C,0
DK-14113-C,0
DK-15486-A,0
DK-15672-C,0
DK-16003-C,0
DK-16200-C,0
DK-16721-C,0
DK-17077-C,0
DK-17891-C,0
DK-18174-A,0
DK-18287-C,0
DK-18953-C,0
DK-19067-C,0
DK-20848-C,0
DK-21534-C,0
DK-21593-C,0
DK-24093-C,0
DK-24122-C,0
DK-24560-C,0
DK-24764-C,0
DK-25033-C,0
DK-26002-C,0
DK-28460-C,0
DK-30663-C,0
DK-31338-C,0
DK-32802-C,0
DK-32923-C,0
DK-32960-C,0
DK-33342-C,0
DK-33585-C,0
DK-34417-C,0
DK-34475-A,0
DK-34847-C,0
DK-3485-D0,0
DK-35287-A,0
DK-35387-A,0
DK-36818-C,0
DK-37723-C,0
DK-38288-C,0
DK-3889-D0,0
DK-40323-C,0
DK-42091-A,0
DK-44173-C,0
DK-45094-C,0
DK-46556-C,0
DK-47464-C,0
DK-48374-C,0
DK-48877-A,0
DK-49091-A,0
DK-49195-A,0
DK-49500-C,0
DK-49630-C,0
DK-50267-C,0
DK-50495-C,0
DK-50958-C,0
DK-51991-A,0
DK-54440-C,0
DK-57003-C,0
DK-57783-C,0
DK-58127-C,0
DK-58679-A,0
DK-59291-C,0
DK-59541-C,0
DK-61292-A,0
DK

2025-01-20 06:00:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 81
2025-01-20 06:00:31 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:00:32 - root - INFO - SQL:
SELECT "publication_number", "embedding_v1"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 

2025-01-20 06:00:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:00:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:00:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:00:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 06:00:33 - snowflake.connector.connection - INFO - closed
2025-01-20 06:00:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:01:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:01:47 - root - INFO - ```sql
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;
```
2025-01-20 06:01:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:01:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:01:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:01:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 06:01:50 - snowflake.connector.connection - INFO - closed
2025-01-20 06:01:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:03:10 - root - INFO - SQL:
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 

2025-01-20 06:03:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:03:11 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:12 - root - INFO - SQL:
SELECT 
  "publication_number", 
  "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-

2025-01-20 06:03:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 603
2025-01-20 06:03:14 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:15 - root - INFO - SQL:
SELECT 
  t."publication_number", 
  f.value AS "cited_publication"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") f
LIMIT 1000
Results:
Too long, hard cut:
publication_number,cited_publication
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4699103-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4886026-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""EP-0489493-A2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5438967-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5676118-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5740775-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6234153-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6367452-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6371077-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2002139111-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6516782-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""EP-1001153-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2003230276-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6725829-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6742492-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6763799-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6994077-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7234440-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007235009-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7284506-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007245818-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7350504-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2008103678-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7500471-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2009063298-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2009292447-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009281143-A"",
  ""type"": """"
}"
US-8

2025-01-20 06:03:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:16 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:03:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:03:43 - root - INFO - ```sql
SELECT
    "publication_number",
    CASE
        WHEN "citation" IS NULL THEN 0
        ELSE ARRAY_SIZE("citation")
    END AS "backward_citation_count"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000;
```

**Explanation:**

In Snowflake SQL, using `LEFT JOIN LATERAL FLATTEN` with an `ON` clause is not supported, which is why the previous query resulted in an error. To count the number of backward citations for each patent without encountering this error, we can utilize the `ARRAY_SIZE` function directly on the `"citation"` field.

The `"citation"` field contains an array of citations (or is `NULL` if there are none). The `ARRAY_SIZE` function returns the number of elements in this array. If `"citation"` is `NULL`, we return `0` to indicate there are no backward citations for that patent.

---

**Corrected SQL Queries for Others:**

1. **Retrieve Filing Dates:**

   ```sql
   SELECT 
     "publication_number", 
     "filing_date"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
   ```

2. **List Citations (Backward Citations) for Patents:**

   ```sql
   SELECT 
     t."publication_number", 
     f.value AS "cited_publication"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   LIMIT 1000;
   ```

3. **Count Backward Citations per Patent:**

   ```sql
   SELECT
     "publication_number",
     CASE
       WHEN "citation" IS NULL THEN 0
       ELSE ARRAY_SIZE("citation")
     END AS "backward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
   ```

4. **Retrieve Filing Dates for a Specific Year:**

   ```sql
   SELECT 
     "publication_number", 
     "filing_date"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "filing_date" BETWEEN 20100101 AND 20101231
   LIMIT 1000;
   ```

5. **Retrieve Patent Titles:**

   ```sql
   SELECT 
     "publication_number", 
     "title_localized"::VARIANT:"text"::STRING AS "title_text"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
   ```

6. **List Distinct Countries from `ABS_AND_EMB`:**

   ```sql
   SELECT DISTINCT "country"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
   ```

7. **Check Embedding Vector Sizes:**

   ```sql
   SELECT 
     "publication_number", 
     CASE
       WHEN "embedding_v1" IS NULL THEN 0
       ELSE ARRAY_SIZE("embedding_v1")
     END AS "embedding_vector_size"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
   ```

---

**Note:**

- **Handling NULL Values:** In the corrected queries, I included `CASE` statements to handle `NULL` values, ensuring that we return `0` when arrays are `NULL`.
- **Avoiding Unsupported Joins:** The error occurred because Snowflake does not support `LEFT JOIN LATERAL FLATTEN` with an `ON` clause. By directly using `ARRAY_SIZE` and handling `NULL` cases, we can achieve the desired result without using unsupported features.
- **Data Types:** When accessing nested fields like `"title_localized"`, I ensured to cast the `VARIANT` to `STRING` to extract the text properly.

---

These corrected SQL queries should run without errors and provide the desired insights from the data.
2025-01-20 06:03:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:03:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:03:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:03:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:03:44 - snowflake.connector.connection - INFO - closed
2025-01-20 06:03:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:04:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:04:32 - root - INFO - SQL:
SELECT 
     "publication_number", 
     CASE
       WHEN "embedding_v1" IS NULL THEN 0
       ELSE ARRAY_SIZE("embedding_v1")
     END AS "embedding_vector_size"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,embedding_vector_size
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,6

2025-01-20 06:04:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:04:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:04:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:04:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:04:34 - snowflake.connector.connection - INFO - closed
2025-01-20 06:04:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:04:34 - root - INFO - SQL:
SELECT 
  "publication_number", 
  "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "filing_date" BETWEEN 20100101 AND 20101231
  AND "filing_date" IS NOT NULL
  AND "filing_date" > 0
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date
JP-2011222733-A,20100409
WO-2011049397-A2,20101022
US-2011204460-A1,20100219
US-2011021348-A1,20101001
US-9129035-B2,20101005
US-2012025810-A1,20100329
US-7818867-B1,20100108
CN-101934142-B,20100921
KR-20120011656-A,20100729
US-2010245586-A1,20100303
CN-102712194-A,20101214
CN-102028000-B,20101101
CN-102082310-B,20101103
US-2010177864-A1,20100113
EP-2461968-A2,20100611
KR-20120095970-A,20101118
US-8208209-B2,20100415
EP-2223733-A1,20100219
CN-101926889-B,20100809
CN-104333392-B,20100127
KR-101221655-B1,20100824
CN-102714682-B,20100406
WO-2010102006-A2,20100303
US-2012112759-A1,20101109
EP-2305586-A2,20100921
EP-2421060-A1,20100412
US-2011103102-A1,20100222
US-2011252003-A1,20100409
US-2011313882-A1,20100621
EP-2401701-A4,20100219
US-2011001937-A1,20100907
US-8721767-B2,20100907
KR-101008573-B1,20100618
CN-102116427-A,20101216
EP-2402518-A1,20100630
JP-2012092690-A,20101026
US-8255845-B2,20100528
US-2012181249-A1,20100929
EP-2216080-A1,20100204
CN-102403137-A,20100917
KR-200453197-Y1,20100310
US-2011027214-A1,20100125
CN-102480671-B,20101126
KR-101158084-B1,20100416
US-8527613-B2,20100126
JP-2010214373-A,20100520
US-2010243777-A1,20100322
CN-102042450-A,20101206
CN-101785749-B,20100209
KR-101424324-B1,20100608
US-8285841-B2,20100607
EP-2233627-A3,20100216
CN-102630181-B,20100917
US-8612463-B2,20100603
KR-100986634-B1,20100104
CN-101954100-A,20100916
ES-2388550-A1,20100119
CN-102388253-A,20100406
JP-2012066873-A,20101112
KR-101754588-B1,20101209
JP-2012003479-A,20100616
US-9657880-B2,20101209
CN-102040365-A,20101103
CN-102640582-A,20101130
US-2011203873-A1,20100222
JP-2011157773-A,20100203
EP-2590873-A1,20100709
CN-101854407-A,20100329
GB-2486649-A,20101221
KR-200469113-Y1,20101224
CN-102274071-A,20100611
CN-101905595-B,20100702
WO-2011072482-A1,20101214
KR-101355269-B1,20100825
CN-101819197-B,20100310
CN-102270647-A,20101011
CN-102450064-B,20100528
KR-101505956-B1,20100811
ES-2368241-A1,20100419
CN-101795108-A,20100316
US-8625821-B2,20100713
CN-101877283-A,20100426
CN-101862689-B,20100609
JP-3166114-U,20101209
JP-5502700-B2,20101104
US-D640894-S,20100910
JP-5561833-B2,20101228
CN-201725995-U,20100719
US-D650723-S,20101015
EP-2437836-B1,20100518
CN-101755971-A,20100111
KR-20110086363-A,20100122
KR-20120040003-A,20101018
CN-201759443-U,20100818
US-8759255-B2,20100904
US-8344616-B2,20100526
RU-2011138022-A,20100115
WO-2010084052-A3,20100112
JP-2012111607-A,20101125
US-2012116991-A1,20101105
US-9704831-B2,20100521
EP-2408951-A1,20100317
US-2010273461-A1,20100315
GB-2476528-A,20100827
US-2010311050-A1,20100322
US-2012258751-A1,20100922
US-8374431-B2,20100727
CN-101974369-A,20100902
CN-102197878-A,20100323
GB-2480982-A,20100302
CN-101830253-A,20100521
US-2012004005-A1,20100809
EP-2425113-A1,20100414
WO-2011071766-A2,20101203
CN-102033671-A,20101013
KR-20120094158-A,20100914
US-8300588-B2,20100930
CN-102373699-B,20100809
CN-101962473-A,20101028
CN-102011253-A,20101225
CN-101927510-A,20100901
JP-2012008656-A,20100622
ES-1074090-Y,20101201
GB-201007824-D0,20100511
EP-2457080-B8,20101112
KR-20120061629-A,20101203
CN-201843382-U,20101029
ES-2380029-B1,20100920
EP-2359932-B1,20101223
JP-4979786-B2,20100316
CN-202092979-U,20101029
CA-2765181-A1,20100611
JP-5362111-B2,20100715
CN-202005145-U,20101018
CN-201810391-U,20101022
CN-102098476-A,20101201
EP-2539349-B1,20101228
JP-2012036952-A,20100805
FR-2966833-B1,20101103
JP-5038483-B2,20101224
KR-20110139775-A,20100608
KR-20120004813-A,20100707
CN-201895443-U,20101020
US-2013193451-A1,20101123
ES-2465218-T5,20100819
JP-5050068-B2,20100316
US-8447435-B1,20100415
US-2012174094-A1,20101231
KR-20120025759-A,20100908
US-8615268-B2,20101101
US-8391876-B2,20100819
WO-2011066498-A3,20101129
JP-2011159659-A,20100129
WO-2011014743-A3,20100730
US-7991278-B2,20100407
EP-2404029-A2,20100301
CN-101916617-A,20100508
RU-2446149-C1,20101108
EP-2243470-A1,20100420
JP-2011151944-A,20100121
JP-2013510309-A,20101105
WO-2011004071-A3,20100705
CN-102665767-A,20100824
US-2011217217-A1,20100910
US-8635935-B2,20100316
CN-102338143-A,20100722
CN-101856600-A,20100625
EP-2451612-A1,20100601
CN-102052431-B,20101110
JP-2012076424-A,20101005
KR-101230256-B1,20101202
WO-2011063023-A3,20101117
US-2011241894-A1,20100617
US-2012011113-A1,20100712
JP-2011255746-A,20100608
EP-2411299-A4,20100329
RU-2553133-C2,20100512
WO-2010142048-A1,20100520
CN-101852883-B,20100330
US-8359528-B2,20100723
WO-2010102202-A3,20100305
JP-2011190318-A,20100312
WO-2010093203-A2,20100212
EP-2530527-A1,20101029
US-8705040-B2,20100330
EP-2512369-B1,20101216
EP-2483438-A4,20100917
EP-2430641-A2,20100514
WO-2010141888-A1,20100604
JP-2012524790-A,20100421
CN-102298296-A,20101209
US-9539737-B2,20101207
CN-102299615-A,20100622
CN-102092004-B,20101217
CN-102648650-A,20101117
CN-102309763-B,20100709
JP-5389756-B2,20100903
JP-5781620-B2,20101105
GB-201021600-D0,20101221
WO-2011037728-A2,20100831
JP-2011177380-A,20100302
CN-202078613-U,20101122
CN-202034681-U,20101228
WO-2010099194-A2,20100224
DE-202010008791-U1,201

2025-01-20 06:04:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:04:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:04:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:04:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:04:35 - snowflake.connector.connection - INFO - closed
2025-01-20 06:04:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:04:36 - root - INFO - SQL:
SELECT 
  "publication_number", 
  "title_localized"::VARIANT:"text"::STRING AS "title_text"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Results:
Too long, hard cut:
publication_number,title_text
JP-1810118-C,
JP-1203714-C,
FR-1500580-A,
ES-8501233-A1,
CA-2165155-A1,
FR-2409943-B1,
GB-1086860-A,
JP-S54117658-A,
JP-H0710178-Y2,
JP-3172057-B2,
US-136580-A,
US-272220-A,
US-599187-A,
CN-1062411-C,
DE-1479218-U,
EP-2512367-B1,
ES-2312527-T3,
FR-1000748-A,
FR-1573809-A,
JP-S5066757-U,
JP-S5845249-Y2,
US-2103405-A,
GB-201114438-D0,
JP-5707248-B2,
JP-2016211567-A,
KR-20040075216-A,
CN-1954806-A,
CN-201399214-Y,
JP-1368881-C,
JP-1444589-C,
FR-1497898-A,
DE-2707796-A1,
DE-2962208-D1,
FR-2233137-A1,
GB-2224027-B,
JP-S5911756-Y2,
JP-2000218515-A,
JP-S56169301-A,
US-2002102047-A1,
CN-1467804-A,
EP-0988417-B1,
JP-H04334685-A,
JP-S6359143-U,
JP-H0685910-B2,
JP-H0350567-B2,
JP-5108773-B2,
CN-2768052-Y,
CN-1940157-B,
CN-202318915-U,
CN-203200362-U,
JP-897785-C,
JP-1789132-C,
JP-S62113530-U,
CA-118661-S,
FI-882364-A0,
CA-810158-A,
DE-2335240-A1,
DE-7610943-U1,
JP-H0673947-U,
JP-S54153049-A,
JP-S5716116-U,
US-548167-A,
CN-1055840-A,
JP-S6020713-A,
JP-S6234024-A,
JP-H0995081-A,
JP-H1088758-A,
GB-189709494-A,
JP-2001195445-A,
JP-2010101160-A,
CN-101746294-A,
CN-104170353-A,
CN-206056613-U,
JP-1032657-C,
JP-1654837-C,
DK-146223-C,
CA-564325-A,
GB-0802422-D0,
JP-S53139175-U,
JP-H01150349-U,
JP-2600796-Y2,
JP-S591896-U,
JP-S4922438-B1,
US-419959-A,
DE-69331528-D1,
DE-69430885-T2,
EP-1474362-B1,
JP-2000346423-A,
JP-2765752-B2,
KR-900003183-Y1,
JP-2003229053-A,
JP-2007241524-A,
JP-5129599-B2,
KR-100547071-B1,
KR-20070020426-A,
KR-20130050682-A,
CN-204556165-U,
ES-66185-Y,
CA-1331409-C,
FI-891492-A0,
GB-1348507-A,
JP-S60179587-U,
US-332138-A,
CN-1112492-C,
DE-566539-C,
DE-845109-C,
JP-S63125649-A,
JP-S6423693-U,
JP-S5243021-U,
JP-S5566205-U,
JP-H0825023-B2,
JP-2003215980-A,
JP-4255884-B2,
KR-100295305-B1,
CN-101547005-A,
CN-101988676-A,
CN-203259375-U,
CN-205932945-U,
DE-202006018912-U1,
FR-2828332-A1,
GB-1375879-A,
JP-S53161674-U,
US-2053075-A,
CN-2484753-Y,
CN-1212523-A,
FI-20010786-A,
JP-S6359144-U,
JP-2799203-B2,
JP-H08143121-A,
US-1837725-A,
US-2304134-A,
US-1864623-A,
JP-5991128-B2,
JP-2016105749-A,
RU-2191214-C2,
RU-2008140707-A,
CN-103265598-B,
CN-203928708-U,
CN-204557664-U,
CN-206326242-U,
CN-104559893-B,
CN-106856628-A,
US-6778773-B2,
JP-H00985753-A,
JP-1512007-C,
NL-28211-C,
CA-2184504-C,
FR-877274-A,
JP-S60218905-A,
JP-H04326774-A,
JP-S5125160-A,
FR-1012104-A,
JP-S5944363-A,
JP-H081564-A,
US-1233474-A,
US-2002011230-A1,
JP-2003169856-A,
US-811638-A,
KR-200338652-Y1,
KR-20070041890-A,
CN-1816294-A,
CN-2858160-Y,
CN-201276086-Y,
CN-201816145-U,
CN-102907994-A,
JP-1573454-C,
JP-1721868-C,
JP-2100371-C,
DK-358583-D0,
ES-146285-Y,
GB-478690-A,
DE-2649618-B2,
DE-3766112-D1,
DE-8007402-U1,
FR-390089-A,
FR-638126-A,
FR-2638622-B1,
JP-H0584037-U,
JP-S4739450-Y1,
JP-H0642846-U,
NL-296405-A,
NL-7211943-A,
EP-2781788-B1,
JP-S5072414-U,
JP-S5846920-U,
JP-S5874811-U,
JP-S5687776-U,
US-D279853-S,
KR-920008597-Y1,
JP-2004313014-A,
JP-6137070-B2,
RU-2008132286-A,
US-754320-A,
CN-105823611-A,
CN-106739164-A,
CN-205558012-U,
BE-512467-A,
CA-2244766-A1,
DE-1803332-A1,
DE-2149141-A1,
GB-2089320-A,
JP-S62164685-U,
JP-H066780-Y2,
DE-69322442-T2,
EP-1933436-B1,
EP-0782478-B1,
EP-0993180-B1,
JP-S5128923-U,
JP-S5153284-U,
JP-S5376919-A,
JP-3340813-B2,
JP-2000192758-A,
JP-H11193667-A,
RU-17326-U1,
KR-20110049427-A,
CN-101531763-A,
CN-201900010-U,
CN-202142477-U,
CN-202417422-U,
CN-202807027-U,
CA-27189-A,
JP-S4874140-A,
JP-2887866-B2,
FR-2239893-A5,
JP-H09201246-A,
JP-S6125607-Y2,
JP-H069665-Y2,
JP-H02145867-U,
DE-1899993-U,
DK-1279779-T3,
EP-1395943-B1,
JP-S61104472-A,
US-3605178-A,
ES-2301340-B1,
KR-890006762-Y1,
KR-910005717-Y1,
JP-WO2006134667-A1,
JP-WO2011121828-A1,
JP-6013229-B2,
KR-200371816-Y1,
KR-20040093694-A,
CN-104911016-A,
JP-1721970-C,
JP-H00979262-A,
JP-2045702-C,
CA-607467-A,
CA-870537-A,
DE-2913333-C2,
GB-2156898-B,
GB-9701425-D0,
DE-69108459-T2,
DE-69402587-D1,
DE-690465-C,
JP-S5354430-A,
JP-S5788835-A,
JP-H0510017-A,
JP-H08159838-A,
US-1863894-A,
JP-4882580-B2,
JP-5210626-B2,
RU-2345965-C2,
RU-2355420-C2,
KR-100352139-B1,
KR-100387884-B1,
KR-20120048256-A,
CN-201742521-U,
CN-202693633-U,
CN-202679530-U,
CN-106625363-A,
CN-205519698-U,
JP-1260064-C,
DE-54582-C,
ES-128308-A1,
DE-2516533-A1,
GB-0905075-D0,
GB-192211-A,
JP-2605593-Y2,
JP-S5020200-Y2,
JP-S524076-A,
DE-19811661-A1,
DE-29605835-U1,
DE-69131766-T2,
EP-2982223-A2,
EP-0172283-B1,
JP-S5743740-U,
JP-H04296316-A,
US-D487006-S,
US-3538803-A,
US-2002044447-A1,
JP-2003225526-A,
JP-2005299236-A,
JP-2010128199-A,
KR-101187803-B1,
CN-201628697-U,
CA-1192088-A1,
JP-1028326-C,
BE-782111-A1,
CA-1190527-A,
CA-2093193-C,
DE-130839-C,
ES-2051228-B1,
FR-554877-A,
FR-2636364-B1,
JP-S57153931-A,
JP-S5224357-Y2,
JP-H04314168-A,
DE-19851242-A1,
EP-2728262-B1,
ES-2463442-T3,
JP-S5541406-U,
JP-S609186-Y2,
JP-H04361539-A,
JP-H1117252-A,
JP-H02111359-A,
ES-1048572-U,
GB-201212390-D0,
KR-930004522-B1,
GB-190307993-A,
JP-5563820-B2,
JP-3167197-U,
KR-19980022791-U,
KR-20150068298-A,
CN-1649445-A,
CN-101762881-A,
CN-204219963-U,
CN-106140778-A,
CN-105167468-A,
C

2025-01-20 06:04:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:04:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:04:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:04:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-01-20 06:04:37 - snowflake.connector.connection - INFO - closed
2025-01-20 06:04:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:04:38 - root - INFO - SQL:
SELECT DISTINCT "country"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
WHERE "country" IS NOT NULL
LIMIT 1000
Results:
country
NETHERLANDS
JAPAN
FRANCE
SPAIN
BELGIUM
EUROPEAN PATENT OFFICE
CANADA
REPUBLIC OF KOREA
FEDERAL REPUBLIC GERMANY
DENMARK
FINLAND
LUXEMBOURG
RUSSIAN FEDERATION
WIPO (PCT)
USA
UNITED KINGDOM
CHINA

2025-01-20 06:04:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:04:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:04:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:04:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:04:39 - snowflake.connector.connection - INFO - closed
2025-01-20 06:04:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:04:39 - root - INFO - SQL:
SELECT 
  "publication_number", 
  CASE
    WHEN "embedding_v1" IS NULL THEN 0
    ELSE ARRAY_SIZE("embedding_v1")
  END AS "embedding_vector_size"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Results:
Too long, hard cut:
publication_number,embedding_vector_size
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,6

2025-01-20 06:04:39 - root - INFO - itercount: 0
2025-01-20 06:04:39 - root - INFO - Database Name: PATENTS_GOOGLE
Schema Name: PATENTS_GOOGLE
DDL describes table information.
,0
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

,1
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,2
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""description_localized"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""citation"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,3
table_name,ABS_AND_EMB
description,
DDL,"create or replace TABLE ABS_AND_EMB (
	""publication_number"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""title_translated"" BOOLEAN,
	""abstract"" VARCHAR(16777216),
	""abstract_translated"" BOOLEAN,
	""cpc"" VARIANT,
	""cpc_low"" VARIANT,
	""cpc_inventive_low"" VARIANT,
	""top_terms"" VARIANT,
	""similar"" VARIANT,
	""url"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""publication_description"" VARCHAR(16777216),
	""cited_by"" VARIANT,
	""embedding_v1"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `PUBLICATIONS`
   - **"publication_number"**: Unique identifier for each patent publication. *Potential usage*: To identify and link patents between tables.
   - **"country_code"**: Country code of the patent. *Potential usage*: To filter for United States patents (`"country_code" = 'US'`).
   - **"kind_code"**: Classification of the patent publication. *Potential usage*: To filter for utility patents under the B2 classification (`"kind_code" LIKE '%B2'`).
   - **"grant_date"**: Date the patent was granted. *Potential usage*: To filter for patents granted between 2010 and 2014.
   - **"filing_date"**: Date the patent was filed. *Potential usage*: To calculate the time window for counting forward citations.
   - **"citation"**: List of patents cited by this patent (backward citations). *Potential usage*: To understand the number of backward citations.

2. **Table:** `ABS_AND_EMB`
   - **"publication_number"**: Unique identifier matching the `PUBLICATIONS` table. *Potential usage*: To join with `PUBLICATIONS` for additional data.
   - **"cited_by"**: List of patents that cite this patent (forward citations). *Potential usage*: To count the number of forward citations.
   - **"embedding_v1"**: Embedding vector of the patent text. *Potential usage*: To compute similarity between patents.
   - **"country"**: Country code of the patent. *Potential usage*: To confirm the country code from `PUBLICATIONS`.

**Conditions That May Be Used:**

- Filter for United States patents: `"country_code" = 'US'` or `"country" = 'US'`
- Filter for B2 classification: `"kind_code" LIKE '%B2'`
- Filter for grant dates between 2010 and 2014: `"grant_date" BETWEEN 20100101 AND 20141231`
- Filter for a specific filing year: `"filing_date" BETWEEN '20100101' AND '20101231'` (for 2010, adjust for other years)
- Count forward citations within one month of filing date by comparing dates from `"cited_by"` patents.

---

**SQL Queries:**

1. **List distinct kind codes to understand classification formats:**

   ```sql
   SELECT DISTINCT "kind_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
   ```

2. **Retrieve publication numbers and country codes of US patents:**

   ```sql
   SELECT "publication_number", "country_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "country_code" = 'US'
   LIMIT 1000;
   ```

3. **Get publication numbers and grant dates for patents granted between 2010 and 2014:**

   ```sql
   SELECT "publication_number", "grant_date"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20100101 AND 20141231
   LIMIT 1000;
   ```

4. **List patents with kind codes ending with 'B2':**

   ```sql
   SELECT "publication_number", "kind_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "kind_code" LIKE '%B2'
   LIMIT 1000;
   ```

5. **Inspect the structure of the "cited_by" field in `ABS_AND_EMB`:**

   ```sql
   SELECT t."publication_number", f.value AS "cited_by_publication"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
   LATERAL FLATTEN(input => t."cited_by") f
   LIMIT 1000;
   ```

6. **Check the number of forward citations for each patent:**

   ```sql
   SELECT "publication_number", ARRAY_SIZE("cited_by") AS "forward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
   ```

7. **Retrieve embeddings to understand the data format:**

   ```sql
   SELECT "publication_number", "embedding_v1"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
   ```

8. **Examine the embedding vector values for a patent:**

   ```sql
   SELECT t."publication_number", f.value::FLOAT AS "embedding_value"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
   LATERAL FLATTEN(input => t."embedding_v1") f
   WHERE t."publication_number" = 'US1234567B2'
   LIMIT 1000;
   ```

9. **Check filing dates to understand the date format:**

   ```sql
   SELECT "publication_number", "filing_date"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
   ```

10. **List citations (backward citations) for a patent:**

    ```sql
    SELECT t."publication_number", f.value AS "cited_publication"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") f
    WHERE t."publication_number" = 'US1234567B2'
    LIMIT 1000;
    ```

11. **Count the number of backward citations per patent:**

    ```sql
    SELECT "publication_number", ARRAY_SIZE("citation") AS "backward_citation_count"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
    LIMIT 1000;
    ```

12. **Find patents filed in the same year regardless of type:**

    ```sql
    SELECT "publication_number", "filing_date"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
    WHERE "filing_date" BETWEEN 20100101 AND 20101231
    LIMIT 1000;
    ```

13. **Retrieve patent numbers and their corresponding titles:**

    ```sql
    SELECT "publication_number", "title_localized"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
    LIMIT 1000;
    ```

14. **List country codes from `ABS_AND_EMB` to compare with `PUBLICATIONS`:**

    ```sql
    SELECT DISTINCT "country"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
    LIMIT 1000;
    ```

15. **Select patents with embeddings and view their embedding vector size:**

    ```sql
    SELECT "publication_number", ARRAY_SIZE("embedding_v1") AS "embedding_vector_size"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
    LIMIT 1000;
    ```

---

These queries help understand the structure and content of the relevant tables and columns, providing insight into how to approach the task using the available data. Each query is designed to explore different aspects of the data, such as filtering conditions, data formats, and field contents.Query:
SELECT DISTINCT "kind_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   LIMIT 1000;
Answer:
kind_code
B
Y1
I1
T9
U9
B8
R1
H
T3
D1
U4
K4
Z1
A5
B3
T4
P1
R2
P
A4
T5
A8
I5
I2
V0
B1
S
D2
U8
Y2
T2
H1
T7
L
A0
B9
T1
Y4
R
K1
U
F
C1
T0
T8
U0
U1
A6
Y
A1
S1
M
U3
C9
C2
B4
C5
H3
A3
K5
E
D0
A2
I4
C
A
P3
P2
T
B2
A9
E1
C3
A7
Query:
SELECT "publication_number", "country_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "country_code" = 'US'
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,country_code
US-2008248346-A1,US
US-2006098678-A1,US
US-5995882-A,US
US-D763862-S,US
US-6069490-A,US
US-4158426-A,US
US-9156652-B1,US
US-4573529-A,US
US-3409741-A,US
US-8719279-B2,US
US-2009204131-A1,US
US-3730531-A,US
US-5954205-A,US
US-3476385-A,US
US-2484101-A,US
US-2973985-A,US
US-2011248506-A1,US
US-4730930-A,US
US-6999717-B2,US
US-3511345-A,US
US-6612888-B1,US
US-5824842-A,US
US-2005204400-A1,US
US-2011154017-A1,US
US-2003154333-A1,US
US-2009215757-A1,US
US-2016138809-A1,US
US-2015068250-A1,US
US-2737418-A,US
US-2008033106-A1,US
US-8600107-B2,US
US-8370222-B2,US
US-2015366719-A1,US
US-6294170-B1,US
US-8334212-B2,US
US-2008028128-A1,US
US-6459987-B1,US
US-8666920-B2,US
US-2006198383-A1,US
US-7521122-B2,US
US-8661280-B2,US
US-2012329609-A1,US
US-2011177058-A1,US
US-2015058734-A1,US
US-2010182548-A1,US
US-2012212947-A1,US
US-2013086659-A1,US
US-2011055569-A1,US
US-2015086941-A1,US
US-2005001467-A1,US
US-2014020289-A1,US
US-9714722-B2,US
US-2007169335-A1,US
US-2010320277-A1,US
US-4547317-A,US
US-3387543-A,US
US-9610687-B2,US
US-8197428-B2,US
US-3709047-A,US
US-2009326460-A1,US
US-2017144221-A1,US
US-2006093549-A1,US
US-2014252590-A1,US
US-2008018479-A1,US
US-2009121361-A1,US
US-5589623-A,US
US-4271694-A,US
US-2006223953-A1,US
US-2015089988-A1,US
US-2015313150-A1,US
US-9049883-B2,US
US-2004205135-A1,US
US-2005263439-A1,US
US-2015052615-A1,US
US-2014013730-A1,US
US-2011096894-A1,US
US-2007113176-A1,US
US-2010054620-A1,US
US-8976393-B2,US
US-6955226-B2,US
US-2994468-A,US
US-4315100-A,US
US-4475935-A,US
US-5606980-A,US
US-8492762-B2,US
US-2016266823-A1,US
US-2006228948-A1,US
US-6118434-A,US
US-7464036-B1,US
US-3425201-A,US
US-3373486-A,US
US-3267593-A,US
US-7785372-B2,US
US-8163114-B2,US
US-4803369-A,US
US-4254651-A,US
US-4986127-A,US
US-9419736-B2,US
US-2005213316-A1,US
US-3242892-A,US
US-5545682-A,US
US-3569737-A,US
US-2746319-A,US
US-5348907-A,US
US-2014043950-A1,US
US-2013145150-A1,US
US-2009198615-A1,US
US-2011179357-A1,US
US-9155072-B2,US
US-4240112-A,US
US-5480477-A,US
US-5353982-A,US
US-2013259848-A1,US
US-5231499-A,US
US-6126232-A,US
US-2004013375-A1,US
US-5772961-A,US
US-5764786-A,US
US-7556775-B2,US
US-9620890-B1,US
US-6713367-B2,US
US-7655498-B2,US
US-9755000-B2,US
US-8150419-B2,US
US-2015106209-A1,US
US-8399429-B2,US
US-8807253-B2,US
US-2012150596-A1,US
US-2007171190-A1,US
US-2003219132-A1,US
US-6500413-B1,US
US-2001016508-A1,US
US-2013201919-A1,US
US-2013141431-A1,US
US-2015140236-A1,US
US-2014271228-A1,US
US-2009038341-A1,US
US-2012027574-A1,US
US-9527579-B2,US
US-2004182673-A1,US
US-2014206801-A1,US
US-2010120789-A1,US
US-7762801-B2,US
US-2009240984-A1,US
US-2009201033-A1,US
US-2009119651-A1,US
US-2013042794-A1,US
US-2013004710-A1,US
US-2010059170-A1,US
US-2017118514-A1,US
US-2014098307-A1,US
US-2014130035-A1,US
US-2009184353-A1,US
US-8077560-B2,US
US-9421780-B2,US
US-2016194291-A1,US
US-2010331020-A1,US
US-2005074520-A1,US
US-2006094172-A1,US
US-2008110653-A1,US
US-2006213849-A1,US
US-2709513-A,US
US-2007299716-A1,US
US-9650267-B2,US
US-8979585-B2,US
US-4915067-A,US
US-2734483-A,US
US-7933348-B2,US
US-9464056-B2,US
US-7655776-B2,US
US-4127231-A,US
US-2016234859-A1,US
US-6257184-B1,US
US-3069475-A,US
US-5996531-A,US
US-4952925-A,US
US-4873469-A,US
US-2008273841-A1,US
US-2016138857-A1,US
US-7393635-B2,US
US-7971258-B1,US
US-4823249-A,US
US-3400065-A,US
US-4739488-A,US
US-9289723-B2,US
US-5050477-A,US
US-D750284-S,US
US-2682632-A,US
US-2014180104-A1,US
US-3479443-A,US
US-4754382-A,US
US-3079329-A,US
US-7883339-B2,US
US-2015054070-A1,US
US-2004260555-A1,US
US-9465333-B2,US
US-D331040-S,US
US-2489114-A,US
US-5897314-A,US
US-2017075824-A1,US
US-2004176512-A1,US
US-4743763-A,US
US-8611388-B2,US
US-2009205842-A1,US
US-2007017751-A1,US
US-2008309029-A1,US
US-6154657-A,US
US-5098481-A,US
US-6184027-B1,US
US-9036463-B2,US
US-2004040355-A1,US
US-2003079197-A1,US
US-2004120289-A1,US
US-2010150882-A1,US
US-2007285051-A1,US
US-5790489-A,US
US-8469679-B2,US
US-7114564-B2,US
US-3274058-A,US
US-3148530-A,US
US-4465459-A,US
US-4048106-A,US
US-5275269-A,US
US-6422372-B2,US
US-7352425-B2,US
US-8403824-B2,US
US-2014259935-A1,US
US-8006496-B2,US
US-9076454-B2,US
US-2016220827-A1,US
US-2014076193-A1,US
US-2006170900-A1,US
US-9020108-B1,US
US-7075826-B2,US
US-9582120-B2,US
US-2008010051-A1,US
US-2006001934-A1,US
US-2009047162-A1,US
US-2012325217-A1,US
US-7060739-B2,US
US-2008221347-A1,US
US-7815109-B2,US
US-2015015026-A1,US
US-2015052360-A1,US
US-6672202-B2,US
US-2015058087-A1,US
US-2011080003-A1,US
US-2004058183-A1,US
US-2004076508-A1,US
US-2015165314-A1,US
US-2007128845-A1,US
US-8985352-B2,US
US-2772439-A,US
US-2010225265-A1,US
US-2014227373-A1,US
US-2007087396-A1,US
US-2011076946-A1,US
US-2009010147-A1,US
US-2005170882-A1,US
US-2005096737-A1,US
US-RE30702-E,US
US-5609586-A,US
US-4727490-A,US
US-8593015-B2,US
US-6052110-A,US
US-2013322605-A1,US
US-2005280665-A1,US
US-2009112550-A1,US
US-6908096-B2,US
US-2008182619-A1,US
US-2004086320-A1,US
US-2010213560-A1,US
US-5151786-A,US
US-2529907-A,US
US-33
Query:
SELECT "publication_number", "grant_date"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20100101 AND 20141231
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,grant_date
EP-2409946-B1,20140507
JP-5036281-B2,20120926
GB-201008313-D0,20100707
JP-5065641-B2,20121107
CN-202476678-U,20121010
JP-5008058-B2,20120822
JP-5439596-B2,20140312
CN-201875846-U,20110622
CN-202377459-U,20120815
CN-202386491-U,20120822
CN-203879581-U,20141015
EP-1775720-B1,20111109
CN-201778352-U,20110330
CN-202008336-U,20111012
CN-202751797-U,20130227
CN-201482889-U,20100526
JP-5551640-B2,20140716
CN-201750912-U,20110223
CN-202788073-U,20130313
CA-2533614-C,20110503
CN-102392153-B,20140115
EP-1832160-B1,20110223
CN-102221073-B,20130327
US-8768622-B2,20140701
CN-103146534-B,20140319
KR-101284644-B1,20130711
KR-101356112-B1,20140129
US-7727119-B2,20100601
RU-2499633-C1,20131127
CN-102123931-B,20130515
CN-101421795-B,20130306
CN-101983201-B,20140423
CN-101546982-B,20110413
CN-102035046-B,20130612
KR-101248374-B1,20130401
CN-102838039-B,20140903
CN-1989298-B,20101117
CN-102001537-B,20130327
CN-102507392-B,20130814
CN-101753397-B,20121114
CN-100594022-C,20100317
CN-102372790-B,20130410
RU-2449358-C1,20120427
US-8591484-B2,20131126
CN-203550037-U,20140416
JP-4712713-B2,20110629
DE-202011052218-U1,20130109
JP-4538960-B2,20100908
RU-2465397-C1,20121027
US-8894929-B2,20141125
JP-4591505-B2,20101201
GB-2475537-B,20120125
CN-102170665-B,20130807
CN-102168881-B,20130619
KR-100994778-B1,20101117
CN-100591970-C,20100224
US-8550498-B2,20131008
CN-102108427-B,20120530
DE-102008053495-B4,20130103
CN-102449429-B,20140423
CN-101719181-B,20120704
CN-103634577-B,20141231
CN-102020446-B,20131023
US-8084696-B2,20111227
CN-101204742-B,20100526
US-8719990-B2,20140513
CN-101539009-B,20111005
CN-101576374-B,20110525
KR-101220417-B1,20130110
CN-101229787-B,20100901
CN-102017578-B,20141210
US-8719514-B2,20140506
US-8324898-B2,20121204
JP-4678032-B2,20110427
KR-101326001-B1,20131120
DE-102010036823-B8,20110818
US-7746011-B2,20100629
EP-1498629-B2,20131016
KR-101211327-B1,20121211
KR-101222043-B1,20130115
JP-4739062-B2,20110803
KR-100989724-B1,20101026
CN-102267494-B,20130123
US-8613206-B2,20131224
KR-101357430-B1,20140206
CN-1614956-B,20100505
US-7819758-B2,20101026
KR-101414981-B1,20140704
CN-101932380-B,20140319
NL-1037900-C,20111021
CN-101259887-B,20101013
CN-101847042-B,20111228
CN-101180839-B,20120215
CN-102234769-B,20141105
CN-101459378-B,20110309
CN-101302157-B,20110427
KR-101297073-B1,20130814
US-8729750-B2,20140520
US-7990739-B2,20110802
US-8824115-B2,20140902
CN-101253079-B,20101103
CN-100587710-C,20100203
DE-10308893-B4,20130919
KR-101009365-B1,20110119
CN-102064876-B,20130807
KR-101453731-B1,20141023
CN-101444011-B,20130220
US-8518784-B2,20130827
RU-2457643-C2,20120810
JP-4750889-B2,20110817
CN-101550011-B,20111005
CN-101549190-B,20120208
CN-101330719-B,20110810
KR-101379971-B1,20140410
CN-102158275-B,20131218
US-8141404-B2,20120327
US-7912686-B2,20110322
US-7904645-B2,20110308
CN-101586954-B,20120725
CN-103115813-B,20141022
CN-102688095-B,20140827
KR-100977469-B1,20100823
US-8073568-B2,20111206
US-8792886-B2,20140729
US-8528838-B2,20130910
CN-1986652-B,20101117
DE-10242257-B4,20131219
CN-1965694-B,20100414
CN-102526592-B,20130925
US-8023832-B2,20110920
RU-2511820-C2,20140410
CN-101890356-B,20130123
CN-1876659-B,20101222
GB-2451060-B,20130109
CN-101977996-B,20130102
CN-101820209-B,20121107
KR-100957377-B1,20100511
DE-102011006417-B3,20120830
KR-101155542-B1,20120618
CN-101552453-B,20120111
KR-101249589-B1,20130401
DE-102011016802-B4,20130221
CN-101029336-B,20101103
US-7786464-B2,20100831
KR-100970215-B1,20100716
US-7831404-B2,20101109
US-8508659-B2,20130813
CN-102036066-B,20130619
CN-102653256-B,20141105
CN-101510138-B,20120711
US-8073622-B2,20111206
US-8288748-B2,20121016
CN-101906454-B,20120815
US-8167061-B2,20120501
US-D620166-S,20100720
CN-102690433-B,20140716
CN-102113186-B,20140625
KR-101154296-B1,20120613
US-8218633-B2,20120710
CN-101811426-B,20121226
CN-102697304-B,20140402
CN-102249729-B,20130320
DE-10302601-B4,20100114
CN-103184225-B,20140813
RU-2500182-C1,20131210
CN-1889342-B,20100421
CN-101379515-B,20130102
CN-101243270-B,20110706
CN-102391195-B,20140507
JP-4600012-B2,20101215
CN-101937150-B,20120104
US-8154416-B1,20120410
US-8924594-B2,20141230
CN-102542858-B,20140611
US-8100264-B2,20120124
JP-5044395-B2,20121010
GB-2480765-B,20120801
KR-101147917-B1,20120525
CN-101592546-B,20121024
CN-101065445-B,20110511
JP-4925317-B2,20120425
CN-203099880-U,20130731
CN-203203414-U,20130918
RU-2397920-C2,20100827
CN-203705655-U,20140709
EP-2060396-B1,20100929
JP-5094281-B2,20121212
CN-202309349-U,20120704
ES-2399998-T3,20130404
CN-203953961-U,20141126
EP-2384771-B1,20130123
JP-5400994-B2,20140129
KR-101161137-B1,20120702
CN-201770958-U,20110323
US-8058883-B2,20111115
CN-203557466-U,20140423
EP-1979895-B1,20131009
CN-202344020-U,20120725
CN-203920796-U,20141105
CN-203265043-U,20131106
CN-203348719-U,20131218
CN-201534006-U,20100728
CN-201662302-U,20101201
JP-4787078-B2,20111005
JP-5142712-B2,20130213
CN-203999256-U,20141210
US-8548365-B2,20131001
CN-202833828-U,20130327
EP-1627846-B1,20100203
GB-
Query:
SELECT "publication_number", "kind_code"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
   WHERE "kind_code" LIKE '%B2'
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,kind_code
US-6594862-B2,B2
US-8395734-B2,B2
US-7781260-B2,B2
JP-4565593-B2,B2
JP-4813799-B2,B2
US-7197968-B2,B2
US-6766870-B2,B2
JP-4719627-B2,B2
US-7518315-B2,B2
US-7879487-B2,B2
US-8229907-B2,B2
US-8405269-B2,B2
US-8423896-B2,B2
US-8694822-B2,B2
JP-H0625495-B2,B2
US-7717638-B2,B2
US-9658993-B2,B2
US-7432680-B2,B2
US-8984416-B2,B2
JP-H0476664-B2,B2
US-7255124-B2,B2
US-8503036-B2,B2
US-8178184-B2,B2
US-6946026-B2,B2
US-6924955-B2,B2
US-8879934-B2,B2
US-8547039-B2,B2
US-8802933-B2,B2
JP-H0535581-B2,B2
US-6903210-B2,B2
US-6788828-B2,B2
US-8103295-B2,B2
US-7581880-B2,B2
JP-4697146-B2,B2
US-9614020-B2,B2
US-8673549-B2,B2
JP-S551137-B2,B2
JP-S6236258-B2,B2
JP-H0431096-B2,B2
US-7495178-B2,B2
US-7690976-B2,B2
JP-S551734-B2,B2
US-6743873-B2,B2
US-8142536-B2,B2
US-8520301-B2,B2
US-8463797-B2,B2
US-7173260-B2,B2
US-7218306-B2,B2
JP-4622665-B2,B2
US-9322575-B2,B2
US-8251903-B2,B2
US-8011721-B2,B2
JP-3203231-B2,B2
JP-S6260989-B2,B2
JP-4496124-B2,B2
JP-4676540-B2,B2
US-7674988-B2,B2
US-7890720-B2,B2
US-7587611-B2,B2
US-8555064-B2,B2
US-9388108-B2,B2
JP-S5827857-B2,B2
JP-S6352211-B2,B2
US-9005975-B2,B2
US-9346287-B2,B2
US-7001361-B2,B2
US-8768622-B2,B2
US-9185508-B2,B2
US-9083834-B2,B2
US-7727119-B2,B2
JP-H0313720-B2,B2
US-8970668-B2,B2
US-9525112-B2,B2
US-6870915-B2,B2
US-7462187-B2,B2
US-7331956-B2,B2
US-8591484-B2,B2
US-8975032-B2,B2
JP-4712713-B2,B2
JP-4538960-B2,B2
US-6533371-B2,B2
US-8894929-B2,B2
US-7434357-B2,B2
JP-3401622-B2,B2
JP-4591505-B2,B2
US-6389824-B2,B2
US-9517750-B2,B2
JP-S5638173-B2,B2
JP-H0157315-B2,B2
US-8550498-B2,B2
JP-S5346988-B2,B2
US-8084696-B2,B2
US-6805302-B2,B2
US-9452126-B2,B2
US-9599863-B2,B2
US-8719990-B2,B2
JP-S5854321-B2,B2
US-8719514-B2,B2
US-8324898-B2,B2
JP-4678032-B2,B2
US-9243443-B2,B2
US-7421500-B2,B2
US-7235054-B2,B2
US-6913017-B2,B2
US-7746011-B2,B2
US-9214335-B2,B2
EP-1498629-B2,B2
US-9520403-B2,B2
JP-S5640564-B2,B2
JP-4739062-B2,B2
US-7142898-B2,B2
US-9008481-B2,B2
US-7164145-B2,B2
US-9027286-B2,B2
US-8984469-B2,B2
US-7431883-B2,B2
US-9384181-B2,B2
US-7540698-B2,B2
JP-3524143-B2,B2
JP-4668734-B2,B2
JP-H0363498-B2,B2
JP-S639222-B2,B2
US-7118014-B2,B2
US-9200008-B2,B2
US-7715549-B2,B2
JP-4754687-B2,B2
US-6723201-B2,B2
US-9293519-B2,B2
US-9711737-B2,B2
US-7130860-B2,B2
US-9660655-B2,B2
US-9624723-B2,B2
JP-5936769-B2,B2
JP-4603859-B2,B2
US-9683466-B2,B2
JP-4725216-B2,B2
US-9186273-B2,B2
JP-4629064-B2,B2
US-9077131-B2,B2
US-7868069-B2,B2
JP-H0558115-B2,B2
US-9022857-B2,B2
US-6906028-B2,B2
US-6555432-B2,B2
US-9224593-B2,B2
US-6915077-B2,B2
JP-H0437939-B2,B2
JP-S5637886-B2,B2
US-8908076-B2,B2
US-9108579-B2,B2
US-6590697-B2,B2
US-7848876-B2,B2
JP-2552101-B2,B2
JP-4641386-B2,B2
US-8213542-B2,B2
JP-2790475-B2,B2
US-7063971-B2,B2
US-6914807-B2,B2
US-8700554-B2,B2
JP-H0831880-B2,B2
JP-4562710-B2,B2
JP-3420081-B2,B2
US-9104816-B2,B2
US-6806882-B2,B2
US-9593877-B2,B2
US-6868666-B2,B2
US-6913759-B2,B2
US-7480745-B2,B2
US-7548036-B2,B2
US-8201355-B2,B2
US-7540586-B2,B2
US-6572968-B2,B2
US-7205403-B2,B2
US-8267414-B2,B2
JP-S5410401-B2,B2
JP-4757867-B2,B2
US-6859647-B2,B2
US-9308400-B2,B2
US-7123470-B2,B2
JP-H0333301-B2,B2
US-8235477-B2,B2
US-8876205-B2,B2
JP-H021650-B2,B2
US-8986204-B2,B2
US-8359599-B2,B2
US-6747341-B2,B2
US-6778157-B2,B2
US-9260719-B2,B2
US-9695715-B2,B2
US-8431428-B2,B2
JP-4645099-B2,B2
JP-H0223262-B2,B2
JP-S6059371-B2,B2
US-7756298-B2,B2
US-8746172-B2,B2
US-9453841-B2,B2
JP-H0379254-B2,B2
JP-2536575-B2,B2
US-8412097-B2,B2
US-8636026-B2,B2
US-7479454-B2,B2
US-6851712-B2,B2
US-7212673-B2,B2
US-7375773-B2,B2
US-7510057-B2,B2
US-8103516-B2,B2
US-9047865-B2,B2
US-9617863-B2,B2
US-7552891-B2,B2
US-9084332-B2,B2
US-7387605-B2,B2
US-6933842-B2,B2
US-6885763-B2,B2
US-7083680-B2,B2
US-7248611-B2,B2
US-8613206-B2,B2
JP-S591835-B2,B2
US-9674419-B2,B2
JP-S6354556-B2,B2
US-7819758-B2,B2
JP-H0338770-B2,B2
US-7268660-B2,B2
US-8729750-B2,B2
JP-S6121077-B2,B2
US-7990739-B2,B2
US-8824115-B2,B2
US-7564947-B2,B2
US-7434319-B2,B2
JP-3421335-B2,B2
US-8518784-B2,B2
JP-4750889-B2,B2
US-7094526-B2,B2
US-7179147-B2,B2
US-9190721-B2,B2
US-8141404-B2,B2
US-7454208-B2,B2
US-7912686-B2,B2
US-7904645-B2,B2
US-7473042-B2,B2
JP-2771994-B2,B2
US-6856148-B2,B2
US-8073568-B2,B2
JP-H0430718-B2,B2
JP-S6256322-B2,B2
US-8792886-B2,B2
US-8528838-B2,B2
US-6799231-B2,B2
US-8023832-B2,B2
US-6510198-B2,B2
US-7251263-B2,B2
JP-S6313360-B2,B2
US-7009545-B2,B2
US-9670686-B2,B2
US-9151051-B2,B2
US-7786464-B2,B2
US-7316311-B2,B2
US-7831404-B2,B2
US-8508659-B2,B2
JP-H051721-B2,B2
JP-3119392-B2,B2
US-9614151-B2,B2
US-8073622-B2,B2
US-8288748-B2,B2
US-9093289-B2,B2
US-8167061-B2,B2
US-7360462-B2,B2
US-6805600-B2,B2
US-8218633-B2,B2
US-6478806-B2,B2
JP-4600012-B2,B2
US-9195479-B2,B2
US-8924594-B2,B2
JP-S6327251-B2,B2
JP-S5346597-B2,B2
US-8100264-B2,B2
JP-5044395-B2,B2
US-7238129-B2,B2
JP-4648256-B2,B2
US-9684554-B2,B2
US-9653321-B2,B2
US-7894831-B2,B2
JP-H052284-B2,B2
JP-S5332017-B2,B2
US-7506485-B2,B2
US-6895754-B2,B2
US-8769944-B2,B2
US-8242652-B2,B2
US-8802367-B2,B2
US-8256557-B2,B2
US-9145233-B2,B2
US-82304
Query:
SELECT t."publication_number", f.value AS "cited_by_publication"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB t,
   LATERAL FLATTEN(input => t."cited_by") f
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cited_by_publication
DE-318-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4377202-A"",
  ""type"": """"
}"
DE-6066-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1177870-B"",
  ""type"": """"
}"
DE-8199-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-10358537-A1"",
  ""type"": """"
}"
DE-9260-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-102004014318-A1"",
  ""type"": """"
}"
US-5418-P,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-PP27981-P3"",
  ""type"": """"
}"
US-5582-P,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-10478-P"",
  ""type"": """"
}"
US-7752-P,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2580807-A"",
  ""type"": """"
}"
US-7765-P,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-8038-P"",
  ""type"": """"
}"
CA-86501-S,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-D797248-S"",
  ""type"": """"
}"
CA-93339-A,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5328283-A"",
  ""type"": """"
}"
DE-13739-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1043865-B"",
  ""type"": """"
}"
DE-16474-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5037250-A"",
  ""type"": """"
}"
DE-16894-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1277699-B"",
  ""type"": """"
}"
DE-25283-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-930703-C"",
  ""type"": """"
}"
DE-26411-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""FR-2421020-A1"",
  ""type"": ""X""
}"
DE-29220-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-2134755-A1"",
  ""type"": """"
}"
DE-29420-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5509449-A"",
  ""type"": """"
}"
DE-32777-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-4241373-A1"",
  ""type"": """"
}"
DE-33237-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1141136-B"",
  ""type"": """"
}"
DE-35627-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5771599-A"",
  ""type"": """"
}"
DE-38499-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4577722-A"",
  ""type"": """"
}"
DE-51226-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2784744-A"",
  ""type"": """"
}"
DE-53179-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1918780-A1"",
  ""type"": """"
}"
DE-61256-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-965812-C"",
  ""type"": """"
}"
DE-64210-C,"{
  ""application_number"": """",
  ""category"": ""ISR"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-02061207-A1"",
  ""type"": ""Y""
}"
DE-68962-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4492046-A"",
  ""type"": """"
}"
DE-69706-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-3282606-A"",
  ""type"": """"
}"
DE-76735-C,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publica
Query:
SELECT "publication_number", ARRAY_SIZE("cited_by") AS "forward_citation_count"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,forward_citation_count
CA-27-A,0
ES-81-Y,0
DE-303-C,0
ES-866-Y,0
FI-150-A,0
FI-250-A,0
FR-336-E,0
NL-284-C,0
NL-947-C,0
BE-107-T1,0
CA-1911-A,0
CA-4005-A,0
CA-4106-A,0
CA-4698-A,0
CA-4801-A,0
CA-5943-A,0
CA-6183-A,0
CA-6207-A,0
CA-6390-A,0
CA-6969-A,0
CA-8931-S,0
CA-9897-A,0
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,0
DK-3080-C,0
DK-3107-C,0
DK-3184-C,0
DK-3510-C,0
DK-5867-C,0
DK-5921-C,0
DK-6491-A,0
DK-7210-C,0
DK-8069-C,0
DK-8466-C,0
DK-9281-C,0
DK-9359-C,0
ES-1062-U,0
ES-1498-U,0
ES-1524-Y,0
ES-1872-U,0
ES-2542-Y,0
ES-2819-Y,0
ES-2960-U,0
ES-3045-U,0
ES-4483-Y,0
ES-4723-Y,0
ES-4858-U,0
ES-5089-Y,0
ES-5219-Y,0
ES-5716-U,0
ES-5975-Y,0
ES-6454-U,0
ES-6552-Y,0
ES-6928-Y,0
ES-6962-Y,0
ES-7086-Y,0
ES-7407-Y,0
ES-7489-Y,0
ES-7516-U,0
ES-7538-U,0
ES-764-H3,0
ES-8269-Y,0
FI-1825-A,0
FI-291-U1,0
FI-3021-A,0
FI-4211-A,0
FI-4543-A,0
FI-8034-A,0
FI-8619-A,0
FI-8985-A,0
FI-902-U1,0
FR-1186-E,0
FR-1382-E,0
FR-1550-M,0
FR-2064-E,0
FR-2510-M,0
FR-2578-M,0
FR-2635-E,0
FR-3293-M,0
FR-5174-E,0
FR-5770-E,0
FR-7085-M,0
FR-7747-E,0
FR-8053-M,0
FR-8143-M,0
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,0
RU-815-U1,0
US-1260-A,0
US-1844-A,0
US-3704-A,0
US-4174-P,0
US-4340-A,0
US-4449-P,0
US-4570-P,0
US-5293-P,0
US-5333-A,0
US-5618-A,0
US-6399-A,0
US-6501-P,0
US-7090-A,0
US-7624-A,0
US-7703-P,0
US-7765-P,0
US-8162-P,0
US-8923-P,0
US-9153-A,0
US-9563-A,0
US-H817-H,0
CA-10240-A,0
CA-10445-A,0
CA-11856-A,0
CA-12085-A,0
CA-12299-A,0
CA-12359-A,0
CA-12986-A,0
CA-14364-A,0
CA-15108-A,0
CA-15467-A,0
CA-16464-A,0
CA-16944-A,0
CA-17107-A,0
CA-18535-S,0
CA-19006-S,0
CA-21676-A,0
CA-21706-A,0
CA-21979-A,0
CA-22497-S,0
CA-22705-A,0
CA-23044-A,0
CA-25240-S,0
CA-25587-A,0
CA-26172-A,0
CA-27810-A,0
CA-29171-S,0
CA-29565-A,0
CA-30563-S,0
CA-30747-A,0
CA-31066-A,0
CA-31656-A,0
CA-34117-A,0
CA-34328-A,0
CA-35530-A,0
CA-36126-A,0
CA-37060-A,0
CA-37412-A,0
CA-38186-A,0
CA-38290-A,0
CA-38566-A,0
CA-39941-A,0
CA-41986-A,0
CA-42957-A,0
CA-43582-A,0
CA-43613-A,0
CA-43665-A,0
CA-44103-A,0
CA-44675-A,0
CA-45114-S,0
CA-45162-A,0
CA-46041-S,0
CA-46346-S,0
CA-46414-S,0
CA-46650-A,0
CA-47228-S,0
CA-47556-A,0
CA-47943-A,0
CA-48005-S,0
CA-50059-A,0
CA-51084-S,0
CA-51448-A,0
CA-53020-A,0
CA-53342-A,0
CA-53679-A,0
CA-54019-A,0
CA-56199-S,0
CA-57871-A,0
CA-58112-A,0
CA-59658-S,0
CA-62116-A,0
CA-63512-A,0
CA-64348-A,0
CA-64895-A,0
CA-64959-A,0
CA-65051-A,0
CA-65468-A,0
CA-66408-A,0
CA-67027-A,0
CA-67256-A,0
CA-68355-A,0
CA-68561-A,0
CA-69952-A,0
CA-69969-A,0
CA-70837-S,0
CA-71352-A,0
CA-72557-S,0
CA-73229-S,0
CA-73434-A,0
CA-73648-A,0
CA-75054-A,0
CA-75833-A,0
CA-75940-A,0
CA-76442-A,0
CA-77673-S,0
CA-78154-A,0
CA-78848-A,0
CA-80485-S,0
CA-81879-A,0
CA-82735-A,0
CA-83640-A,0
CA-84428-S,0
CA-84611-A,0
CA-85458-S,0
CA-87085-A,0
CA-87655-A,0
CA-88869-A,0
CA-89598-S,0
CA-90451-A,0
CA-90703-A,0
CA-91407-A,0
CA-91839-A,0
CA-92136-S,0
CA-92671-S,0
CA-93153-A,0
CA-93847-S,0
CA-94404-A,0
CA-94834-A,0
CA-95812-A,0
CA-96813-A,0
CA-97691-A,0
CA-97784-A,0
CA-98415-S,0
CA-98613-A,0
CA-98742-A,0
CA-99391-S,0
CA-99529-A,0
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,0
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,0
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,0
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,0
DK-11017-C,0
DK-11274-A,0
DK-11549-C,0
DK-13429-C,0
DK-14113-C,0
DK-15486-A,0
DK-15672-C,0
DK-16003-C,0
DK-16200-C,0
DK-16721-C,0
DK-17077-C,0
DK-17891-C,0
DK-18174-A,0
DK-18287-C,0
DK-18953-C,0
DK-19067-C,0
DK-20848-C,0
DK-21534-C,0
DK-21593-C,0
DK-24093-C,0
DK-24122-C,0
DK-24560-C,0
DK-24764-C,0
DK-25033-C,0
DK-26002-C,0
DK-28460-C,0
DK-30663-C,0
DK-31338-C,0
DK-32802-C,0
DK-32923-C,0
DK-32960-C,0
DK-33342-C,0
DK-33585-C,0
DK-34417-C,0
DK-34475-A,0
DK-34847-C,0
DK-3485-D0,0
DK-35287-A,0
DK-35387-A,0
DK-36818-C,0
DK-37723-C,0
DK-38288-C,0
DK-3889-D0,0
DK-40323-C,0
DK-42091-A,0
DK-44173-C,0
DK-45094-C,0
DK-46556-C,0
DK-47464-C,0
DK-48374-C,0
DK-48877-A,0
DK-49091-A,0
DK-49195-A,0
DK-49500-C,0
DK-49630-C,0
DK-50267-C,0
DK-50495-C,0
DK-50958-C,0
DK-51991-A,0
DK-54440-C,0
DK-57003-C,0
DK-57783-C,0
DK-58127-C,0
DK-58679-A,0
DK-59291-C,0
DK-59541-C,0
DK-61292-A,0
DK
Query:
SELECT "publication_number", "embedding_v1"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 
Query:
SELECT "publication_number", "embedding_v1"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,embedding_v1
CA-27-A,"[
  1.542691000000000e-01,
  -1.512821800000000e-01,
  -1.650247300000000e-01,
  6.317439500000000e-03,
  -6.877411000000000e-02,
  7.857726000000000e-02,
  1.997577000000000e-02,
  -1.052709150000000e-01,
  1.906607200000000e-01,
  -3.087626800000000e-02,
  -4.402885000000000e-02,
  -1.932268600000000e-02,
  1.498914700000000e-01,
  -1.014574240000000e-01,
  1.522054700000000e-01,
  2.159083800000000e-02,
  3.287851200000000e-01,
  -3.723864300000000e-02,
  -1.093368460000000e-01,
  -2.695568300000000e-02,
  5.093054000000000e-03,
  -2.561860000000000e-02,
  -8.104277999999999e-02,
  4.378689000000000e-02,
  1.772555000000000e-01,
  1.866227200000000e-01,
  4.738728700000000e-02,
  1.293443900000000e-01,
  -9.107929000000001e-03,
  -5.338581700000000e-03,
  -5.402789600000000e-02,
  9.968319500000000e-02,
  -1.297268900000000e-01,
  -6.103027600000000e-02,
  1.034460960000000e-01,
  -1.370337900000000e-01,
  -1.529048900000000e-02,
  -7.281200600000000e-02,
  -6.650846000000000e-03,
  -5.688674000000000e-02,
  -5.571032000000000e-02,
  -2.353075000000000e-02,
  1.588186900000000e-01,
  1.485413600000000e-01,
  1.301227400000000e-02,
  7.831083000000000e-02,
  -1.220956100000000e-01,
  -3.694782800000000e-02,
  1.388754100000000e-01,
  -1.948010500000000e-01,
  1.644870500000000e-02,
  -1.159949600000000e-01,
  7.601101000000000e-02,
  -1.079300800000000e-01,
  3.773738400000000e-02,
  -3.411133600000000e-01,
  1.087194160000000e-01,
  3.469542000000000e-01,
  -1.208127800000000e-01,
  2.158840900000000e-01,
  -1.885225600000000e-02,
  -4.778167200000000e-02,
  1.922371400000000e-01,
  8.118848500000000e-02
]"
ES-81-Y,"[
  5.887155000000000e-02,
  -1.084279900000000e-01,
  -7.473050000000000e-03,
  -1.078326500000000e-01,
  -1.136954200000000e-01,
  -5.629550000000000e-02,
  -1.293592000000000e-01,
  1.470960500000000e-02,
  1.143989640000000e-01,
  -6.502111000000000e-03,
  1.211329850000000e-01,
  -1.472910300000000e-01,
  1.433625000000000e-01,
  -1.972437000000000e-01,
  -1.466153400000000e-01,
  6.347028000000000e-02,
  1.704387400000000e-01,
  -1.788644500000000e-01,
  -2.144294800000000e-01,
  -5.971858000000000e-02,
  -1.807118600000000e-02,
  9.654319999999999e-03,
  -6.319642000000000e-02,
  -1.158018000000000e-01,
  1.591617600000000e-01,
  -8.069207000000000e-02,
  2.444405900000000e-01,
  2.053556900000000e-01,
  2.203187000000000e-01,
  4.123914000000000e-02,
  -1.226528360000000e-01,
  1.756981200000000e-01,
  1.406480400000000e-01,
  -2.614098500000000e-01,
  -3.579098400000000e-02,
  -3.342285000000000e-02,
  5.340901400000000e-02,
  -2.008394400000000e-01,
  7.221930000000000e-02,
  1.083169000000000e-01,
  -1.035950600000000e-01,
  4.522684600000000e-02,
  2.121584000000000e-01,
  -3.648881000000000e-02,
  -4.667341700000000e-02,
  -8.133340000000000e-02,
  -5.762764000000000e-02,
  1.715386000000000e-01,
  -6.118799400000000e-02,
  -1.188068800000000e-01,
  -4.722248400000000e-02,
  -8.758543000000001e-02,
  -1.545800400000000e-02,
  -1.725661600000000e-02,
  -1.594496200000000e-01,
  -3.453176000000000e-02,
  -7.645045000000000e-02,
  9.057411999999999e-02,
  -3.059179000000000e-01,
  1.417563600000000e-01,
  4.234178700000000e-02,
  6.612614000000000e-02,
  1.629971300000000e-02,
  8.276451000000000e-02
]"
DE-303-C,[]
ES-866-Y,"[
  2.173252600000000e-01,
  -5.955347000000000e-02,
  -8.669304000000000e-02,
  -1.435769700000000e-02,
  -1.091980100000000e-01,
  -5.290851000000000e-02,
  -1.218726560000000e-01,
  -1.733191000000000e-02,
  1.428825100000000e-01,
  4.071840600000000e-02,
  1.569196900000000e-01,
  2.504207000000000e-02,
  1.646801100000000e-01,
  -1.555543000000000e-01,
  -1.366939400000000e-01,
  1.551018000000000e-01,
  2.533057300000000e-01,
  -1.034493300000000e-01,
  -3.249411000000000e-03,
  -1.919896700000000e-02,
  -3.357952500000000e-02,
  7.957726000000000e-02,
  -8.258553000000000e-02,
  -1.893159400000000e-01,
  1.380639200000000e-01,
  -1.185456100000000e-01,
  2.993756800000000e-01,
  1.806876800000000e-01,
  2.209677700000000e-01,
  1.239111650000000e-01,
  -3.356762600000000e-02,
  1.042425860000000e-01,
  1.649517100000000e-01,
  -2.388138300000000e-01,
  1.648602600000000e-02,
  -8.377965499999999e-02,
  1.231861600000000e-01,
  -1.706603200000000e-01,
  1.260255400000000e-01,
  1.798895000000000e-01,
  -1.287039000000000e-01,
  5.932817000000000e-02,
  1.091629300000000e-01,
  -9.887335000000000e-02,
  1.712858300000000e-02,
  -1.140154700000000e-01,
  2.210558600000000e-02,
  9.686722000000000e-02,
  -5.223890000000000e-02,
  -2.214440900000000e-01,
  -1.367440600000000e-02,
  -9.799734500000000e-02,
  6.677625000000000e-02,
  1.251626600000000e-01,
  -2.030494800000000e-01,
  -1.921786200000000e-02,
  -3.204157000000000e-02,
  4.560034300000000e-03,
  -1.331128200000000e-01,
  8.321140000000000e-02,
  -6.589308000000001e-02,
  7.723393000000001e-02,
  2.468057500000000e-02,
  6.641050400000000e-02
]"
FI-150-A,"[
 
Query:
SELECT 
  "publication_number", 
  "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date
JP-1810118-C,0
JP-1203714-C,0
FR-1500580-A,19661104
ES-8501233-A1,19831124
CA-2165155-A1,19940603
FR-2409943-B1,19771125
GB-1086860-A,19660422
JP-S54117658-A,19780306
JP-H0710178-Y2,19880302
JP-3172057-B2,19950405
US-136580-A,0
US-272220-A,0
US-599187-A,0
CN-1062411-C,19940709
DE-1479218-U,0
EP-2512367-B1,20101209
ES-2312527-T3,20021205
FR-1000748-A,19491117
FR-1573809-A,19640424
JP-S5066757-U,19731018
JP-S5845249-Y2,19751212
US-2103405-A,19310429
GB-201114438-D0,20110822
JP-5707248-B2,20110622
JP-2016211567-A,20160502
KR-20040075216-A,20030220
CN-1954806-A,20051027
CN-201399214-Y,20090409
JP-1368881-C,0
JP-1444589-C,0
FR-1497898-A,19661027
DE-2707796-A1,19770223
DE-2962208-D1,19790928
FR-2233137-A1,19740617
GB-2224027-B,19891011
JP-S5911756-Y2,19790131
JP-2000218515-A,19990204
JP-S56169301-A,19800602
US-2002102047-A1,20020226
CN-1467804-A,20020712
EP-0988417-B1,19980603
JP-H04334685-A,19910509
JP-S6359143-U,19861007
JP-H0685910-B2,19851219
JP-H0350567-B2,19840507
JP-5108773-B2,20060829
CN-2768052-Y,20041102
CN-1940157-B,20060925
CN-202318915-U,20111123
CN-203200362-U,20130419
JP-897785-C,0
JP-1789132-C,0
JP-S62113530-U,19860109
CA-118661-S,20061213
FI-882364-A0,19880519
CA-810158-A,0
DE-2335240-A1,19730711
DE-7610943-U1,19760408
JP-H0673947-U,19930324
JP-S54153049-A,19780523
JP-S5716116-U,19800624
US-548167-A,0
CN-1055840-A,19910408
JP-S6020713-A,19830713
JP-S6234024-A,19850806
JP-H0995081-A,19951002
JP-H1088758-A,19960917
GB-189709494-A,18970414
JP-2001195445-A,20001128
JP-2010101160-A,20091021
CN-101746294-A,20090903
CN-104170353-A,20131227
CN-206056613-U,20160726
JP-1032657-C,0
JP-1654837-C,0
DK-146223-C,19720608
CA-564325-A,0
GB-0802422-D0,20080208
JP-S53139175-U,19770408
JP-H01150349-U,19880407
JP-2600796-Y2,19921015
JP-S591896-U,19820628
JP-S4922438-B1,19691202
US-419959-A,0
DE-69331528-D1,19931110
DE-69430885-T2,19940405
EP-1474362-B1,20030211
JP-2000346423-A,19990531
JP-2765752-B2,19900926
KR-900003183-Y1,19870430
JP-2003229053-A,20020131
JP-2007241524-A,20060307
JP-5129599-B2,20080208
KR-100547071-B1,20030228
KR-20070020426-A,20050210
KR-20130050682-A,20111108
CN-204556165-U,20150506
ES-66185-Y,19580519
CA-1331409-C,19891023
FI-891492-A0,19890329
GB-1348507-A,19710419
JP-S60179587-U,19840510
US-332138-A,0
CN-1112492-C,20000616
DE-566539-C,19280927
DE-845109-C,19500618
JP-S63125649-A,19870430
JP-S6423693-U,19870801
JP-S5243021-U,19750922
JP-S5566205-U,19781031
JP-H0825023-B2,19880630
JP-2003215980-A,20020425
JP-4255884-B2,20040608
KR-100295305-B1,19990212
CN-101547005-A,20080328
CN-101988676-A,20090806
CN-203259375-U,20130516
CN-205932945-U,20160822
DE-202006018912-U1,20061214
FR-2828332-A1,20000623
GB-1375879-A,19730427
JP-S53161674-U,19770523
US-2053075-A,19351119
CN-2484753-Y,20010531
CN-1212523-A,19980910
FI-20010786-A,20010417
JP-S6359144-U,19861004
JP-2799203-B2,19891128
JP-H08143121-A,19941117
US-1837725-A,19290917
US-2304134-A,19410527
US-1864623-A,19310103
JP-5991128-B2,20120929
JP-2016105749-A,20130405
RU-2191214-C2,20010109
RU-2008140707-A,20081015
CN-103265598-B,20130603
CN-203928708-U,20140627
CN-204557664-U,20150410
CN-206326242-U,20160701
CN-104559893-B,20150127
CN-106856628-A,20151209
US-6778773-B2,20020927
JP-H00985753-A,0
JP-1512007-C,0
NL-28211-C,0
CA-2184504-C,19960829
FR-877274-A,19411126
JP-S60218905-A,19850228
JP-H04326774-A,19910426
JP-S5125160-A,19740827
FR-1012104-A,19490609
JP-S5944363-A,19830802
JP-H081564-A,19940615
US-1233474-A,19160803
US-2002011230-A1,20010522
JP-2003169856-A,20011206
US-811638-A,19040305
KR-200338652-Y1,20031028
KR-20070041890-A,20051017
CN-1816294-A,20040705
CN-2858160-Y,20060210
CN-201276086-Y,20080820
CN-201816145-U,20100720
CN-102907994-A,20121109
JP-1573454-C,0
JP-1721868-C,0
JP-2100371-C,0
DK-358583-D0,19830805
ES-146285-Y,19690306
GB-478690-A,19370224
DE-2649618-B2,19761029
DE-3766112-D1,19871124
DE-8007402-U1,19800315
FR-390089-A,19080509
FR-638126-A,19270722
FR-2638622-B1,19881104
JP-H0584037-U,19920421
JP-S4739450-Y1,19670612
JP-H0642846-U,19921120
NL-296405-A,0
NL-7211943-A,19720901
EP-2781788-B1,20140319
JP-S5072414-U,19731109
JP-S5846920-U,19810925
JP-S5874811-U,19811118
JP-S5687776-U,19791211
US-D279853-S,19831227
KR-920008597-Y1,19880908
JP-2004313014-A,20030411
JP-6137070-B2,20140625
RU-2008132286-A,20080804
US-754320-A,19030502
CN-105823611-A,20160326
CN-106739164-A,20161228
CN-205558012-U,20160203
BE-512467-A,0
CA-2244766-A1,19980811
DE-1803332-A1,19681016
DE-2149141-A1,19711001
GB-2089320-A,19811207
JP-S62164685-U,19860407
JP-H066780-Y2,19890523
DE-69322442-T2,19930622
EP-1933436-B1,20071004
EP-0782478-B1,19950906
EP-0993180-B1,19991007
JP-S5128923-U,19740826
JP-S5153284-U,19741022
JP-S5376919-A,19761220
JP-3340813-B2,19930831
JP-2000192758-A,19981225
JP-H11193667-A,19971229
RU-17326-U1,20001209
KR-20110049427-A,20091105
CN-101531763-A,20090402
CN-201900010-U,20101217
CN-202142477-U,20110623
CN-202417422-U,20120104
CN-202807027-U,20120824
CA-27189-A,0
JP-S4874140-A,19711229
JP-2887866-B2,19980107
FR-
Query:
SELECT 
  t."publication_number", 
  f.value AS "cited_publication"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") f
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,cited_publication
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4699103-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4886026-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""EP-0489493-A2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5438967-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5676118-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5740775-A"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6234153-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6367452-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6371077-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2002139111-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6516782-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""EP-1001153-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2003230276-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6725829-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6742492-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6763799-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6994077-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7234440-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007235009-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7284506-B1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007245818-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7350504-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2008103678-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7500471-B2"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""APP"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2009063298-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2009292447-A1"",
  ""type"": """"
}"
US-8899209-B2,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""JP-2009281143-A"",
  ""type"": """"
}"
US-8
Query:
SELECT 
     "publication_number", 
     CASE
       WHEN "embedding_v1" IS NULL THEN 0
       ELSE ARRAY_SIZE("embedding_v1")
     END AS "embedding_vector_size"
   FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,embedding_vector_size
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,6
Query:
SELECT 
  "publication_number", 
  "filing_date"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
WHERE "filing_date" BETWEEN 20100101 AND 20101231
  AND "filing_date" IS NOT NULL
  AND "filing_date" > 0
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date
JP-2011222733-A,20100409
WO-2011049397-A2,20101022
US-2011204460-A1,20100219
US-2011021348-A1,20101001
US-9129035-B2,20101005
US-2012025810-A1,20100329
US-7818867-B1,20100108
CN-101934142-B,20100921
KR-20120011656-A,20100729
US-2010245586-A1,20100303
CN-102712194-A,20101214
CN-102028000-B,20101101
CN-102082310-B,20101103
US-2010177864-A1,20100113
EP-2461968-A2,20100611
KR-20120095970-A,20101118
US-8208209-B2,20100415
EP-2223733-A1,20100219
CN-101926889-B,20100809
CN-104333392-B,20100127
KR-101221655-B1,20100824
CN-102714682-B,20100406
WO-2010102006-A2,20100303
US-2012112759-A1,20101109
EP-2305586-A2,20100921
EP-2421060-A1,20100412
US-2011103102-A1,20100222
US-2011252003-A1,20100409
US-2011313882-A1,20100621
EP-2401701-A4,20100219
US-2011001937-A1,20100907
US-8721767-B2,20100907
KR-101008573-B1,20100618
CN-102116427-A,20101216
EP-2402518-A1,20100630
JP-2012092690-A,20101026
US-8255845-B2,20100528
US-2012181249-A1,20100929
EP-2216080-A1,20100204
CN-102403137-A,20100917
KR-200453197-Y1,20100310
US-2011027214-A1,20100125
CN-102480671-B,20101126
KR-101158084-B1,20100416
US-8527613-B2,20100126
JP-2010214373-A,20100520
US-2010243777-A1,20100322
CN-102042450-A,20101206
CN-101785749-B,20100209
KR-101424324-B1,20100608
US-8285841-B2,20100607
EP-2233627-A3,20100216
CN-102630181-B,20100917
US-8612463-B2,20100603
KR-100986634-B1,20100104
CN-101954100-A,20100916
ES-2388550-A1,20100119
CN-102388253-A,20100406
JP-2012066873-A,20101112
KR-101754588-B1,20101209
JP-2012003479-A,20100616
US-9657880-B2,20101209
CN-102040365-A,20101103
CN-102640582-A,20101130
US-2011203873-A1,20100222
JP-2011157773-A,20100203
EP-2590873-A1,20100709
CN-101854407-A,20100329
GB-2486649-A,20101221
KR-200469113-Y1,20101224
CN-102274071-A,20100611
CN-101905595-B,20100702
WO-2011072482-A1,20101214
KR-101355269-B1,20100825
CN-101819197-B,20100310
CN-102270647-A,20101011
CN-102450064-B,20100528
KR-101505956-B1,20100811
ES-2368241-A1,20100419
CN-101795108-A,20100316
US-8625821-B2,20100713
CN-101877283-A,20100426
CN-101862689-B,20100609
JP-3166114-U,20101209
JP-5502700-B2,20101104
US-D640894-S,20100910
JP-5561833-B2,20101228
CN-201725995-U,20100719
US-D650723-S,20101015
EP-2437836-B1,20100518
CN-101755971-A,20100111
KR-20110086363-A,20100122
KR-20120040003-A,20101018
CN-201759443-U,20100818
US-8759255-B2,20100904
US-8344616-B2,20100526
RU-2011138022-A,20100115
WO-2010084052-A3,20100112
JP-2012111607-A,20101125
US-2012116991-A1,20101105
US-9704831-B2,20100521
EP-2408951-A1,20100317
US-2010273461-A1,20100315
GB-2476528-A,20100827
US-2010311050-A1,20100322
US-2012258751-A1,20100922
US-8374431-B2,20100727
CN-101974369-A,20100902
CN-102197878-A,20100323
GB-2480982-A,20100302
CN-101830253-A,20100521
US-2012004005-A1,20100809
EP-2425113-A1,20100414
WO-2011071766-A2,20101203
CN-102033671-A,20101013
KR-20120094158-A,20100914
US-8300588-B2,20100930
CN-102373699-B,20100809
CN-101962473-A,20101028
CN-102011253-A,20101225
CN-101927510-A,20100901
JP-2012008656-A,20100622
ES-1074090-Y,20101201
GB-201007824-D0,20100511
EP-2457080-B8,20101112
KR-20120061629-A,20101203
CN-201843382-U,20101029
ES-2380029-B1,20100920
EP-2359932-B1,20101223
JP-4979786-B2,20100316
CN-202092979-U,20101029
CA-2765181-A1,20100611
JP-5362111-B2,20100715
CN-202005145-U,20101018
CN-201810391-U,20101022
CN-102098476-A,20101201
EP-2539349-B1,20101228
JP-2012036952-A,20100805
FR-2966833-B1,20101103
JP-5038483-B2,20101224
KR-20110139775-A,20100608
KR-20120004813-A,20100707
CN-201895443-U,20101020
US-2013193451-A1,20101123
ES-2465218-T5,20100819
JP-5050068-B2,20100316
US-8447435-B1,20100415
US-2012174094-A1,20101231
KR-20120025759-A,20100908
US-8615268-B2,20101101
US-8391876-B2,20100819
WO-2011066498-A3,20101129
JP-2011159659-A,20100129
WO-2011014743-A3,20100730
US-7991278-B2,20100407
EP-2404029-A2,20100301
CN-101916617-A,20100508
RU-2446149-C1,20101108
EP-2243470-A1,20100420
JP-2011151944-A,20100121
JP-2013510309-A,20101105
WO-2011004071-A3,20100705
CN-102665767-A,20100824
US-2011217217-A1,20100910
US-8635935-B2,20100316
CN-102338143-A,20100722
CN-101856600-A,20100625
EP-2451612-A1,20100601
CN-102052431-B,20101110
JP-2012076424-A,20101005
KR-101230256-B1,20101202
WO-2011063023-A3,20101117
US-2011241894-A1,20100617
US-2012011113-A1,20100712
JP-2011255746-A,20100608
EP-2411299-A4,20100329
RU-2553133-C2,20100512
WO-2010142048-A1,20100520
CN-101852883-B,20100330
US-8359528-B2,20100723
WO-2010102202-A3,20100305
JP-2011190318-A,20100312
WO-2010093203-A2,20100212
EP-2530527-A1,20101029
US-8705040-B2,20100330
EP-2512369-B1,20101216
EP-2483438-A4,20100917
EP-2430641-A2,20100514
WO-2010141888-A1,20100604
JP-2012524790-A,20100421
CN-102298296-A,20101209
US-9539737-B2,20101207
CN-102299615-A,20100622
CN-102092004-B,20101217
CN-102648650-A,20101117
CN-102309763-B,20100709
JP-5389756-B2,20100903
JP-5781620-B2,20101105
GB-201021600-D0,20101221
WO-2011037728-A2,20100831
JP-2011177380-A,20100302
CN-202078613-U,20101122
CN-202034681-U,20101228
WO-2010099194-A2,20100224
DE-202010008791-U1,201
Query:
SELECT 
  "publication_number", 
  "title_localized"::VARIANT:"text"::STRING AS "title_text"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,title_text
JP-1810118-C,
JP-1203714-C,
FR-1500580-A,
ES-8501233-A1,
CA-2165155-A1,
FR-2409943-B1,
GB-1086860-A,
JP-S54117658-A,
JP-H0710178-Y2,
JP-3172057-B2,
US-136580-A,
US-272220-A,
US-599187-A,
CN-1062411-C,
DE-1479218-U,
EP-2512367-B1,
ES-2312527-T3,
FR-1000748-A,
FR-1573809-A,
JP-S5066757-U,
JP-S5845249-Y2,
US-2103405-A,
GB-201114438-D0,
JP-5707248-B2,
JP-2016211567-A,
KR-20040075216-A,
CN-1954806-A,
CN-201399214-Y,
JP-1368881-C,
JP-1444589-C,
FR-1497898-A,
DE-2707796-A1,
DE-2962208-D1,
FR-2233137-A1,
GB-2224027-B,
JP-S5911756-Y2,
JP-2000218515-A,
JP-S56169301-A,
US-2002102047-A1,
CN-1467804-A,
EP-0988417-B1,
JP-H04334685-A,
JP-S6359143-U,
JP-H0685910-B2,
JP-H0350567-B2,
JP-5108773-B2,
CN-2768052-Y,
CN-1940157-B,
CN-202318915-U,
CN-203200362-U,
JP-897785-C,
JP-1789132-C,
JP-S62113530-U,
CA-118661-S,
FI-882364-A0,
CA-810158-A,
DE-2335240-A1,
DE-7610943-U1,
JP-H0673947-U,
JP-S54153049-A,
JP-S5716116-U,
US-548167-A,
CN-1055840-A,
JP-S6020713-A,
JP-S6234024-A,
JP-H0995081-A,
JP-H1088758-A,
GB-189709494-A,
JP-2001195445-A,
JP-2010101160-A,
CN-101746294-A,
CN-104170353-A,
CN-206056613-U,
JP-1032657-C,
JP-1654837-C,
DK-146223-C,
CA-564325-A,
GB-0802422-D0,
JP-S53139175-U,
JP-H01150349-U,
JP-2600796-Y2,
JP-S591896-U,
JP-S4922438-B1,
US-419959-A,
DE-69331528-D1,
DE-69430885-T2,
EP-1474362-B1,
JP-2000346423-A,
JP-2765752-B2,
KR-900003183-Y1,
JP-2003229053-A,
JP-2007241524-A,
JP-5129599-B2,
KR-100547071-B1,
KR-20070020426-A,
KR-20130050682-A,
CN-204556165-U,
ES-66185-Y,
CA-1331409-C,
FI-891492-A0,
GB-1348507-A,
JP-S60179587-U,
US-332138-A,
CN-1112492-C,
DE-566539-C,
DE-845109-C,
JP-S63125649-A,
JP-S6423693-U,
JP-S5243021-U,
JP-S5566205-U,
JP-H0825023-B2,
JP-2003215980-A,
JP-4255884-B2,
KR-100295305-B1,
CN-101547005-A,
CN-101988676-A,
CN-203259375-U,
CN-205932945-U,
DE-202006018912-U1,
FR-2828332-A1,
GB-1375879-A,
JP-S53161674-U,
US-2053075-A,
CN-2484753-Y,
CN-1212523-A,
FI-20010786-A,
JP-S6359144-U,
JP-2799203-B2,
JP-H08143121-A,
US-1837725-A,
US-2304134-A,
US-1864623-A,
JP-5991128-B2,
JP-2016105749-A,
RU-2191214-C2,
RU-2008140707-A,
CN-103265598-B,
CN-203928708-U,
CN-204557664-U,
CN-206326242-U,
CN-104559893-B,
CN-106856628-A,
US-6778773-B2,
JP-H00985753-A,
JP-1512007-C,
NL-28211-C,
CA-2184504-C,
FR-877274-A,
JP-S60218905-A,
JP-H04326774-A,
JP-S5125160-A,
FR-1012104-A,
JP-S5944363-A,
JP-H081564-A,
US-1233474-A,
US-2002011230-A1,
JP-2003169856-A,
US-811638-A,
KR-200338652-Y1,
KR-20070041890-A,
CN-1816294-A,
CN-2858160-Y,
CN-201276086-Y,
CN-201816145-U,
CN-102907994-A,
JP-1573454-C,
JP-1721868-C,
JP-2100371-C,
DK-358583-D0,
ES-146285-Y,
GB-478690-A,
DE-2649618-B2,
DE-3766112-D1,
DE-8007402-U1,
FR-390089-A,
FR-638126-A,
FR-2638622-B1,
JP-H0584037-U,
JP-S4739450-Y1,
JP-H0642846-U,
NL-296405-A,
NL-7211943-A,
EP-2781788-B1,
JP-S5072414-U,
JP-S5846920-U,
JP-S5874811-U,
JP-S5687776-U,
US-D279853-S,
KR-920008597-Y1,
JP-2004313014-A,
JP-6137070-B2,
RU-2008132286-A,
US-754320-A,
CN-105823611-A,
CN-106739164-A,
CN-205558012-U,
BE-512467-A,
CA-2244766-A1,
DE-1803332-A1,
DE-2149141-A1,
GB-2089320-A,
JP-S62164685-U,
JP-H066780-Y2,
DE-69322442-T2,
EP-1933436-B1,
EP-0782478-B1,
EP-0993180-B1,
JP-S5128923-U,
JP-S5153284-U,
JP-S5376919-A,
JP-3340813-B2,
JP-2000192758-A,
JP-H11193667-A,
RU-17326-U1,
KR-20110049427-A,
CN-101531763-A,
CN-201900010-U,
CN-202142477-U,
CN-202417422-U,
CN-202807027-U,
CA-27189-A,
JP-S4874140-A,
JP-2887866-B2,
FR-2239893-A5,
JP-H09201246-A,
JP-S6125607-Y2,
JP-H069665-Y2,
JP-H02145867-U,
DE-1899993-U,
DK-1279779-T3,
EP-1395943-B1,
JP-S61104472-A,
US-3605178-A,
ES-2301340-B1,
KR-890006762-Y1,
KR-910005717-Y1,
JP-WO2006134667-A1,
JP-WO2011121828-A1,
JP-6013229-B2,
KR-200371816-Y1,
KR-20040093694-A,
CN-104911016-A,
JP-1721970-C,
JP-H00979262-A,
JP-2045702-C,
CA-607467-A,
CA-870537-A,
DE-2913333-C2,
GB-2156898-B,
GB-9701425-D0,
DE-69108459-T2,
DE-69402587-D1,
DE-690465-C,
JP-S5354430-A,
JP-S5788835-A,
JP-H0510017-A,
JP-H08159838-A,
US-1863894-A,
JP-4882580-B2,
JP-5210626-B2,
RU-2345965-C2,
RU-2355420-C2,
KR-100352139-B1,
KR-100387884-B1,
KR-20120048256-A,
CN-201742521-U,
CN-202693633-U,
CN-202679530-U,
CN-106625363-A,
CN-205519698-U,
JP-1260064-C,
DE-54582-C,
ES-128308-A1,
DE-2516533-A1,
GB-0905075-D0,
GB-192211-A,
JP-2605593-Y2,
JP-S5020200-Y2,
JP-S524076-A,
DE-19811661-A1,
DE-29605835-U1,
DE-69131766-T2,
EP-2982223-A2,
EP-0172283-B1,
JP-S5743740-U,
JP-H04296316-A,
US-D487006-S,
US-3538803-A,
US-2002044447-A1,
JP-2003225526-A,
JP-2005299236-A,
JP-2010128199-A,
KR-101187803-B1,
CN-201628697-U,
CA-1192088-A1,
JP-1028326-C,
BE-782111-A1,
CA-1190527-A,
CA-2093193-C,
DE-130839-C,
ES-2051228-B1,
FR-554877-A,
FR-2636364-B1,
JP-S57153931-A,
JP-S5224357-Y2,
JP-H04314168-A,
DE-19851242-A1,
EP-2728262-B1,
ES-2463442-T3,
JP-S5541406-U,
JP-S609186-Y2,
JP-H04361539-A,
JP-H1117252-A,
JP-H02111359-A,
ES-1048572-U,
GB-201212390-D0,
KR-930004522-B1,
GB-190307993-A,
JP-5563820-B2,
JP-3167197-U,
KR-19980022791-U,
KR-20150068298-A,
CN-1649445-A,
CN-101762881-A,
CN-204219963-U,
CN-106140778-A,
CN-105167468-A,
C
Query:
SELECT DISTINCT "country"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
WHERE "country" IS NOT NULL
LIMIT 1000
Answer:
country
NETHERLANDS
JAPAN
FRANCE
SPAIN
BELGIUM
EUROPEAN PATENT OFFICE
CANADA
REPUBLIC OF KOREA
FEDERAL REPUBLIC GERMANY
DENMARK
FINLAND
LUXEMBOURG
RUSSIAN FEDERATION
WIPO (PCT)
USA
UNITED KINGDOM
CHINA
Query:
SELECT 
  "publication_number", 
  CASE
    WHEN "embedding_v1" IS NULL THEN 0
    ELSE ARRAY_SIZE("embedding_v1")
  END AS "embedding_vector_size"
FROM PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,embedding_vector_size
CA-27-A,64
ES-81-Y,64
DE-303-C,0
ES-866-Y,64
FI-150-A,64
FI-250-A,64
FR-336-E,64
NL-284-C,0
NL-947-C,0
BE-107-T1,64
CA-1911-A,64
CA-4005-A,64
CA-4106-A,64
CA-4698-A,64
CA-4801-A,64
CA-5943-A,64
CA-6183-A,64
CA-6207-A,64
CA-6390-A,64
CA-6969-A,64
CA-8931-S,64
CA-9897-A,64
DE-3129-C,0
DE-3301-C,0
DE-3884-C,0
DE-3983-C,0
DE-5976-C,0
DK-2807-C,64
DK-3080-C,64
DK-3107-C,64
DK-3184-C,64
DK-3510-C,64
DK-5867-C,64
DK-5921-C,64
DK-6491-A,64
DK-7210-C,64
DK-8069-C,64
DK-8466-C,64
DK-9281-C,64
DK-9359-C,64
ES-1062-U,64
ES-1498-U,64
ES-1524-Y,64
ES-1872-U,64
ES-2542-Y,64
ES-2819-Y,64
ES-2960-U,64
ES-3045-U,64
ES-4483-Y,64
ES-4723-Y,64
ES-4858-U,64
ES-5089-Y,64
ES-5219-Y,64
ES-5716-U,64
ES-5975-Y,64
ES-6454-U,64
ES-6552-Y,64
ES-6928-Y,64
ES-6962-Y,64
ES-7086-Y,64
ES-7407-Y,64
ES-7489-Y,64
ES-7516-U,64
ES-7538-U,64
ES-764-H3,64
ES-8269-Y,64
FI-1825-A,64
FI-291-U1,64
FI-3021-A,64
FI-4211-A,64
FI-4543-A,64
FI-8034-A,64
FI-8619-A,64
FI-8985-A,64
FI-902-U1,64
FR-1186-E,64
FR-1382-E,64
FR-1550-M,64
FR-2064-E,64
FR-2510-M,64
FR-2578-M,64
FR-2635-E,64
FR-3293-M,64
FR-5174-E,64
FR-5770-E,64
FR-7085-M,64
FR-7747-E,64
FR-8053-M,64
FR-8143-M,64
NL-3613-C,0
NL-4187-C,0
NL-5034-C,0
NL-9752-C,0
NL-9761-C,64
RU-815-U1,64
US-1260-A,64
US-1844-A,64
US-3704-A,64
US-4174-P,64
US-4340-A,64
US-4449-P,64
US-4570-P,64
US-5293-P,64
US-5333-A,64
US-5618-A,64
US-6399-A,64
US-6501-P,64
US-7090-A,64
US-7624-A,64
US-7703-P,64
US-7765-P,0
US-8162-P,64
US-8923-P,0
US-9153-A,64
US-9563-A,64
US-H817-H,64
CA-10240-A,64
CA-10445-A,64
CA-11856-A,64
CA-12085-A,64
CA-12299-A,64
CA-12359-A,64
CA-12986-A,64
CA-14364-A,64
CA-15108-A,64
CA-15467-A,64
CA-16464-A,64
CA-16944-A,64
CA-17107-A,64
CA-18535-S,64
CA-19006-S,64
CA-21676-A,64
CA-21706-A,64
CA-21979-A,64
CA-22497-S,64
CA-22705-A,64
CA-23044-A,64
CA-25240-S,64
CA-25587-A,64
CA-26172-A,64
CA-27810-A,64
CA-29171-S,64
CA-29565-A,64
CA-30563-S,64
CA-30747-A,64
CA-31066-A,64
CA-31656-A,64
CA-34117-A,64
CA-34328-A,64
CA-35530-A,64
CA-36126-A,64
CA-37060-A,64
CA-37412-A,64
CA-38186-A,64
CA-38290-A,64
CA-38566-A,64
CA-39941-A,64
CA-41986-A,64
CA-42957-A,64
CA-43582-A,64
CA-43613-A,64
CA-43665-A,64
CA-44103-A,64
CA-44675-A,64
CA-45114-S,64
CA-45162-A,64
CA-46041-S,64
CA-46346-S,64
CA-46414-S,64
CA-46650-A,64
CA-47228-S,64
CA-47556-A,64
CA-47943-A,64
CA-48005-S,64
CA-50059-A,64
CA-51084-S,64
CA-51448-A,64
CA-53020-A,64
CA-53342-A,64
CA-53679-A,64
CA-54019-A,64
CA-56199-S,64
CA-57871-A,64
CA-58112-A,64
CA-59658-S,64
CA-62116-A,64
CA-63512-A,64
CA-64348-A,64
CA-64895-A,64
CA-64959-A,64
CA-65051-A,64
CA-65468-A,64
CA-66408-A,64
CA-67027-A,64
CA-67256-A,64
CA-68355-A,64
CA-68561-A,64
CA-69952-A,64
CA-69969-A,64
CA-70837-S,64
CA-71352-A,64
CA-72557-S,64
CA-73229-S,64
CA-73434-A,64
CA-73648-A,64
CA-75054-A,64
CA-75833-A,64
CA-75940-A,64
CA-76442-A,64
CA-77673-S,64
CA-78154-A,64
CA-78848-A,64
CA-80485-S,64
CA-81879-A,64
CA-82735-A,64
CA-83640-A,64
CA-84428-S,64
CA-84611-A,64
CA-85458-S,64
CA-87085-A,64
CA-87655-A,64
CA-88869-A,64
CA-89598-S,64
CA-90451-A,64
CA-90703-A,64
CA-91407-A,64
CA-91839-A,64
CA-92136-S,64
CA-92671-S,64
CA-93153-A,64
CA-93847-S,64
CA-94404-A,64
CA-94834-A,64
CA-95812-A,64
CA-96813-A,64
CA-97691-A,64
CA-97784-A,64
CA-98415-S,64
CA-98613-A,64
CA-98742-A,64
CA-99391-S,64
CA-99529-A,64
DE-10599-C,0
DE-10678-C,0
DE-10717-C,0
DE-12268-C,0
DE-16453-C,0
DE-17382-C,0
DE-17635-C,0
DE-18657-C,0
DE-21533-C,0
DE-21800-C,0
DE-22191-C,0
DE-24092-C,64
DE-24550-C,0
DE-26040-C,0
DE-26251-C,0
DE-26645-C,0
DE-27162-C,64
DE-28245-C,0
DE-28664-C,0
DE-29317-C,0
DE-29580-C,0
DE-29751-C,0
DE-29873-C,0
DE-34701-C,0
DE-35759-C,0
DE-36143-C,0
DE-36572-C,0
DE-36880-C,0
DE-37006-C,0
DE-39978-C,0
DE-41212-C,0
DE-41909-C,0
DE-43016-C,0
DE-43252-C,0
DE-43745-C,0
DE-44221-C,0
DE-44490-C,0
DE-46714-C,0
DE-46729-C,0
DE-46866-C,0
DE-47512-C,0
DE-48016-C,0
DE-48200-C,0
DE-48281-C,0
DE-48415-C,0
DE-48624-C,0
DE-48946-C,0
DE-55522-C,64
DE-57100-C,0
DE-59206-C,0
DE-62156-C,0
DE-62668-C,0
DE-64182-C,0
DE-64466-C,0
DE-68843-C,0
DE-69224-C,0
DE-69735-C,0
DE-70329-C,0
DE-70421-C,0
DE-70605-C,0
DE-71525-C,0
DE-72135-C,0
DE-72417-C,0
DE-73920-C,0
DE-75006-C,0
DE-75333-C,0
DE-78770-C,0
DE-82929-C,0
DE-83658-C,0
DE-83966-C,0
DE-84792-C,0
DE-87929-C,0
DE-90760-C,0
DE-91921-C,0
DE-92960-C,0
DE-93320-C,0
DE-93611-C,0
DE-94567-C,0
DE-96265-C,0
DE-97461-C,0
DE-98822-C,0
DK-10751-C,64
DK-11017-C,64
DK-11274-A,64
DK-11549-C,64
DK-13429-C,64
DK-14113-C,64
DK-15486-A,64
DK-15672-C,64
DK-16003-C,64
DK-16200-C,64
DK-16721-C,64
DK-17077-C,64
DK-17891-C,64
DK-18174-A,64
DK-18287-C,64
DK-18953-C,64
DK-19067-C,64
DK-20848-C,64
DK-21534-C,64
DK-21593-C,64
DK-24093-C,64
DK-24122-C,64
DK-24560-C,64
DK-24764-C,64
DK-25033-C,64
DK-26002-C,64
DK-28460-C,64
DK-30663-C,64
DK-31338-C,64
DK-32802-C,64
DK-32923-C,64
DK-32960-C,64
DK-33342-C,64
DK-33585-C,64
DK-34417-C,64
DK-34475-A,64
DK-34847-C,64
DK-3485-D0,64
DK-35287-A,64
DK-35387-A,64
DK-36818-C,64
DK-37723-C,64
DK-38288-C,64
DK-3889-D0,64
DK-40323-C,64
DK-42091-A,64
DK-44173-C,6
End Exploring Related Columns
Task: For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
publication_number,most_similar_publication_number,similarity
pub_num1:str,pub_num2:str,similarity:float(Attention: answer in one row)
```

The patent `pub_num1` is the United States utility patent under the B2 classification, granted between 2010 and 2014, that received the most forward citations within a month of its filing date. The most similar patent to `pub_num1`, filed in the same year regardless of its type, is `pub_num2`, with a similarity score of `similarity`..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS_GOOGLE': {'PATENTS_GOOGLE': ['ABS_AND_EMB', 'CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 06:06:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:06:34 - root - INFO - ```sql
WITH "TopPatent" AS (
  SELECT 
    "pub_num1",
    COUNT(DISTINCT "citing_pub_num") AS "forward_citations_within_30_days"
  FROM (
    SELECT 
      p."publication_number" AS "pub_num1",
      TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
      f.value:"publication_number"::STRING AS "citing_pub_num",
      TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_B",
      DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) AS "days_diff"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
      ON p."publication_number" = a."publication_number"
    , LATERAL FLATTEN(input => a."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
      ON f.value:"publication_number"::STRING = c."publication_number"
    WHERE p."country_code" = 'US'
      AND p."kind_code" LIKE '%B2'
      AND p."grant_date" BETWEEN 20100101 AND 20141231
      AND DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  ) sub
  GROUP BY "pub_num1"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    a."embedding_v1" AS "embedding_A"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  JOIN "TopPatent" t
    ON p."publication_number" = t."pub_num1"
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a."embedding_v1" AS "embedding_B"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  WHERE 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "PatentA")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "PatentA")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a_emb.value::FLOAT * b_emb.value::FLOAT) AS "similarity"
FROM "PatentA" a
CROSS JOIN "PatentB" b
, LATERAL FLATTEN(input => a."embedding_A") a_emb
, LATERAL FLATTEN(input => b."embedding_B") b_emb
WHERE a_emb."index" = b_emb."index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1
```
2025-01-20 06:06:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:06:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:06:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:06:35 - snowflake.connector.connection - INFO - closed
2025-01-20 06:06:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:06:35 - root - INFO - itercount: 1
2025-01-20 06:06:35 - root - INFO - 001072 (42601): 01b9d4ee-0004-7b17-0001-11c300f07486: SQL compilation error:
Lateral View cannot be on the left side of join
2025-01-20 06:06:35 - root - INFO - Input sql:
WITH "TopPatent" AS (
  SELECT 
    "pub_num1",
    COUNT(DISTINCT "citing_pub_num") AS "forward_citations_within_30_days"
  FROM (
    SELECT 
      p."publication_number" AS "pub_num1",
      TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
      f.value:"publication_number"::STRING AS "citing_pub_num",
      TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_B",
      DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) AS "days_diff"
    FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
    JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
      ON p."publication_number" = a."publication_number"
    , LATERAL FLATTEN(input => a."cited_by") f
    LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
      ON f.value:"publication_number"::STRING = c."publication_number"
    WHERE p."country_code" = 'US'
      AND p."kind_code" LIKE '%B2'
      AND p."grant_date" BETWEEN 20100101 AND 20141231
      AND DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  ) sub
  GROUP BY "pub_num1"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    a."embedding_v1" AS "embedding_A"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  JOIN "TopPatent" t
    ON p."publication_number" = t."pub_num1"
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a."embedding_v1" AS "embedding_B"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  WHERE 
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "PatentA")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "PatentA")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a_emb.value::FLOAT * b_emb.value::FLOAT) AS "similarity"
FROM "PatentA" a
CROSS JOIN "PatentB" b
, LATERAL FLATTEN(input => a."embedding_A") a_emb
, LATERAL FLATTEN(input => b."embedding_B") b_emb
WHERE a_emb."index" = b_emb."index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1
The error information is:
001072 (42601): 01b9d4ee-0004-7b17-0001-11c300f07486: SQL compilation error:
Lateral View cannot be on the left side of join
Please correct it and output only 1 complete SQL query.
2025-01-20 06:07:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:07:48 - root - INFO - ```sql
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.value::FLOAT AS "embedding_A_value",
    a_emb."index" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.value::FLOAT AS "embedding_B_value",
    a_emb."index" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a."embedding_A_value" * b."embedding_B_value") AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 06:07:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:07:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:07:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:07:49 - snowflake.connector.connection - INFO - closed
2025-01-20 06:07:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:07:50 - root - INFO - itercount: 2
2025-01-20 06:07:50 - root - INFO - 000904 (42000): 01b9d4ef-0004-7d02-0001-11c300f067da: SQL compilation error: error line 27 at position 4
invalid identifier 'A_EMB."index"'
2025-01-20 06:07:50 - root - INFO - Input sql:
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.value::FLOAT AS "embedding_A_value",
    a_emb."index" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.value::FLOAT AS "embedding_B_value",
    a_emb."index" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a."embedding_A_value" * b."embedding_B_value") AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9d4ef-0004-7d02-0001-11c300f067da: SQL compilation error: error line 27 at position 4
invalid identifier 'A_EMB."index"'
Please correct it and output only 1 complete SQL query.
2025-01-20 06:08:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:08:38 - root - INFO - ```sql
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.VALUE::FLOAT AS "embedding_A_value",
    a_emb."INDEX" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.VALUE::FLOAT AS "embedding_B_value",
    a_emb."INDEX" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a."embedding_A_value" * b."embedding_B_value") AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 06:08:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:08:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:08:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:08:40 - snowflake.connector.connection - INFO - closed
2025-01-20 06:08:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:08:41 - root - INFO - itercount: 3
2025-01-20 06:08:41 - root - INFO - 100097 (22007): 01b9d4f0-0004-7b17-0001-11c300f07496: Can't parse '0' as date with format 'YYYYMMDD'
2025-01-20 06:08:41 - root - INFO - Input sql:
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND DATEDIFF('day', TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.VALUE::FLOAT AS "embedding_A_value",
    a_emb."INDEX" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.VALUE::FLOAT AS "embedding_B_value",
    a_emb."INDEX" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    EXTRACT(YEAR FROM TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a."embedding_A_value" * b."embedding_B_value") AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
The error information is:
100097 (22007): 01b9d4f0-0004-7b17-0001-11c300f07496: Can't parse '0' as date with format 'YYYYMMDD'
Please correct it and output only 1 complete SQL query.
2025-01-20 06:09:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:09:45 - root - INFO - ```sql
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TRY_TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.VALUE::FLOAT AS "embedding_A_value",
    a_emb."INDEX" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.VALUE::FLOAT AS "embedding_B_value",
    a_emb."INDEX" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a."embedding_A_value" * b."embedding_B_value") AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 06:09:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:09:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:09:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:09:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 06:09:47 - snowflake.connector.connection - INFO - closed
2025-01-20 06:09:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:09:47 - root - INFO - itercount: 4
2025-01-20 06:09:47 - root - INFO - 0
2025-01-20 06:09:47 - root - INFO - results: 
publication_number,most_similar_publication_number,similarity
US-7877798-B2,US-2009209314-A1,0.8446726012811915


2025-01-20 06:09:47 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between 2010 and 2014, find the one with the most forward citations within a month of its filing date, and identify the most similar patent from the same filing year, regardless of its type., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
publication_number,most_similar_publication_number,similarity
pub_num1:str,pub_num2:str,similarity:float(Attention: answer in one row)
```

The patent `pub_num1` is the United States utility patent under the B2 classification, granted between 2010 and 2014, that received the most forward citations within a month of its filing date. The most similar patent to `pub_num1`, filed in the same year regardless of its type, is `pub_num2`, with a similarity score of `similarity`. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
publication_number,most_similar_publication_number,similarity
US-7877798-B2,US-2009209314-A1,0.8446726012811915
Current sql:
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TRY_TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.VALUE::FLOAT AS "embedding_A_value",
    a_emb."INDEX" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.VALUE::FLOAT AS "embedding_B_value",
    a_emb."INDEX" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  SUM(a."embedding_A_value" * b."embedding_B_value") AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
2025-01-20 06:10:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:10:38 - root - INFO - ```sql
WITH "TopPatent" AS (
  SELECT 
    p."publication_number" AS "pub_num1",
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_A",
    EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year_A",
    COUNT(DISTINCT f.value:"publication_number"::STRING) AS "forward_citations_within_30_days"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  LEFT JOIN LATERAL FLATTEN(input => a."cited_by") f
  LEFT JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS c
    ON f.value:"publication_number"::STRING = c."publication_number"
  WHERE p."country_code" = 'US'
    AND p."kind_code" LIKE '%B2'
    AND p."grant_date" BETWEEN 20100101 AND 20141231
    AND TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND TRY_TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD'), TRY_TO_DATE(c."filing_date"::VARCHAR, 'YYYYMMDD')) BETWEEN 0 AND 30
  GROUP BY p."publication_number", p."filing_date"
  ORDER BY "forward_citations_within_30_days" DESC NULLS LAST
  LIMIT 1
),
"PatentA" AS (
  SELECT 
    t."pub_num1",
    t."filing_date_A",
    t."filing_year_A",
    a_emb.VALUE::FLOAT AS "embedding_A_value",
    a_emb."INDEX" AS "embedding_index"
  FROM "TopPatent" t
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON t."pub_num1" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
),
"PatentB" AS (
  SELECT 
    p."publication_number" AS "pub_num2",
    a_emb.VALUE::FLOAT AS "embedding_B_value",
    a_emb."INDEX" AS "embedding_index"
  FROM PATENTS_GOOGLE.PATENTS_GOOGLE.PUBLICATIONS p
  JOIN PATENTS_GOOGLE.PATENTS_GOOGLE.ABS_AND_EMB a
    ON p."publication_number" = a."publication_number"
  , LATERAL FLATTEN(input => a."embedding_v1") a_emb
  WHERE 
    TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    AND EXTRACT(YEAR FROM TRY_TO_DATE(p."filing_date"::VARCHAR, 'YYYYMMDD')) = (SELECT "filing_year_A" FROM "TopPatent")
    AND p."publication_number" <> (SELECT "pub_num1" FROM "TopPatent")
)
SELECT 
  a."pub_num1" AS "publication_number",
  b."pub_num2" AS "most_similar_publication_number",
  ROUND(SUM(a."embedding_A_value" * b."embedding_B_value"), 4) AS "similarity"
FROM "PatentA" a
JOIN "PatentB" b ON a."embedding_index" = b."embedding_index"
GROUP BY a."pub_num1", b."pub_num2"
ORDER BY "similarity" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 06:10:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:10:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:10:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:10:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 06:10:41 - snowflake.connector.connection - INFO - closed
2025-01-20 06:10:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:10:41 - root - INFO - itercount: 5
2025-01-20 06:10:41 - root - INFO - 0
2025-01-20 06:10:41 - root - INFO - Total iteration counts: 5
