2025-01-26 01:20:15 - openai._base_client - INFO - Retrying request to /chat/completions in 0.417697 seconds
2025-01-26 01:21:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:21:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:21:29 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:21:29 - root - INFO - SQL:
SELECT "block_timestamp_month", COUNT(*) AS "total_transactions"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
Results:
block_timestamp_month,total_transactions
2023-09-01,35134
2023-10-01,27323

2025-01-26 01:21:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:21:31 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:21:31 - root - INFO - SQL:
SELECT "block_timestamp_month", "input_count", COUNT(*) AS "transaction_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month", "input_count"
   ORDER BY "block_timestamp_month", "input_count"
   LIMIT 100;
Results:
block_timestamp_month,input_count,transaction_count
2023-09-01,0,16
2023-09-01,1,30045
2023-09-01,2,2576
2023-09-01,3,806
2023-09-01,4,407
2023-09-01,5,289
2023-09-01,6,187
2023-09-01,7,128
2023-09-01,8,64
2023-09-01,9,49
2023-09-01,10,62
2023-09-01,11,34
2023-09-01,12,25
2023-09-01,13,23
2023-09-01,14,17
2023-09-01,15,13
2023-09-01,16,11
2023-09-01,17,10
2023-09-01,18,10
2023-09-01,19,13
2023-09-01,20,10
2023-09-01,21,7
2023-09-01,22,6
2023-09-01,23,12
2023-09-01,24,4
2023-09-01,25,38
2023-09-01,26,6
2023-09-01,27,3
2023-09-01,28,5
2023-09-01,29,2
2023-09-01,30,3
2023-09-01,31,3
2023-09-01,32,6
2023-09-01,33,6
2023-09-01,34,5
2023-09-01,35,6
2023-09-01,36,4
2023-09-01,37,1
2023-09-01,39,2
2023-09-01,40,2
2023-09-01,42,2
2023-09-01,43,1
2023-09-01,44,2
2023-09-01,45,1
2023-09-01,46,1
2023-09-01,47,1
2023-09-01,48,2
2023-09-01,49,3
2023-09-01,50,3
2023-09-01,51,2
2023-09-01,52,1
2023-09-01,53,2
2023-09-01,54,2
2023-09-01,55,4
2023-09-01,56,1
2023-09-01,57,1
2023-09-01,58,2
2023-09-01,59,1
2023-09-01,60,51
2023-09-01,61,6
2023-09-01,62,1
2023-09-01,63,1
2023-09-01,65,2
2023-09-01,66,1
2023-09-01,67,3
2023-09-01,69,1
2023-09-01,70,1
2023-09-01,73,2
2023-09-01,74,2
2023-09-01,75,1
2023-09-01,77,1
2023-09-01,80,3
2023-09-01,81,2
2023-09-01,82,2
2023-09-01,83,1
2023-09-01,84,1
2023-09-01,86,1
2023-09-01,90,2
2023-09-01,91,1
2023-09-01,92,1
2023-09-01,93,1
2023-09-01,94,1
2023-09-01,96,1
2023-09-01,99,1
2023-09-01,100,26
2023-09-01,101,1
2023-09-01,105,1
2023-09-01,106,1
2023-09-01,107,1
2023-09-01,110,1
2023-09-01,115,1
2023-09-01,116,1
2023-09-01,121,1
2023-09-01,130,2
2023-09-01,135,1
2023-09-01,138,2
2023-09-01,141,1
2023-09-01,150,2
2023-09-01,161,1
2023-09-01,165,1

2025-01-26 01:21:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:21:33 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:21:33 - root - INFO - SQL:
SELECT "block_timestamp_month", "output_count", COUNT(*) AS "transaction_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month", "output_count"
   ORDER BY "block_timestamp_month", "output_count"
   LIMIT 100;
Results:
block_timestamp_month,output_count,transaction_count
2023-09-01,1,20882
2023-09-01,2,12126
2023-09-01,3,661
2023-09-01,4,251
2023-09-01,5,124
2023-09-01,6,167
2023-09-01,7,98
2023-09-01,8,72
2023-09-01,9,32
2023-09-01,10,34
2023-09-01,11,59
2023-09-01,12,34
2023-09-01,13,26
2023-09-01,14,21
2023-09-01,15,27
2023-09-01,16,18
2023-09-01,17,13
2023-09-01,18,21
2023-09-01,19,24
2023-09-01,20,19
2023-09-01,21,26
2023-09-01,22,32
2023-09-01,23,22
2023-09-01,24,16
2023-09-01,25,18
2023-09-01,26,74
2023-09-01,27,4
2023-09-01,28,9
2023-09-01,29,14
2023-09-01,30,7
2023-09-01,31,10
2023-09-01,32,9
2023-09-01,33,1
2023-09-01,34,11
2023-09-01,35,9
2023-09-01,36,7
2023-09-01,37,4
2023-09-01,38,5
2023-09-01,39,4
2023-09-01,40,7
2023-09-01,41,5
2023-09-01,42,5
2023-09-01,43,4
2023-09-01,44,6
2023-09-01,45,2
2023-09-01,46,1
2023-09-01,47,3
2023-09-01,48,2
2023-09-01,51,3
2023-09-01,52,1
2023-09-01,53,1
2023-09-01,54,1
2023-09-01,55,2
2023-09-01,56,3
2023-09-01,59,1
2023-09-01,60,1
2023-09-01,61,1
2023-09-01,63,1
2023-09-01,64,1
2023-09-01,70,2
2023-09-01,72,1
2023-09-01,77,1
2023-09-01,80,1
2023-09-01,86,1
2023-09-01,90,1
2023-09-01,91,1
2023-09-01,93,1
2023-09-01,95,1
2023-09-01,100,2
2023-09-01,101,4
2023-09-01,102,1
2023-09-01,107,1
2023-09-01,109,1
2023-09-01,112,1
2023-09-01,127,1
2023-09-01,131,1
2023-09-01,151,1
2023-09-01,152,1
2023-09-01,167,1
2023-09-01,176,1
2023-09-01,177,1
2023-09-01,181,1
2023-09-01,188,1
2023-09-01,190,1
2023-09-01,191,2
2023-09-01,195,1
2023-09-01,196,2
2023-09-01,197,2
2023-09-01,201,4
2023-09-01,203,3
2023-09-01,204,2
2023-09-01,205,2
2023-09-01,206,3
2023-09-01,208,4
2023-09-01,209,3
2023-09-01,210,2
2023-09-01,211,2
2023-09-01,218,1
2023-09-01,219,2
2023-09-01,222,1

2025-01-26 01:21:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:21:34 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:21:35 - root - INFO - SQL:
SELECT "hash", "block_timestamp_month", "input_count", "output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "input_count" >= 5
     AND "output_count" >= 5
   LIMIT 100;
Results:
Too long, hard cut:
hash,block_timestamp_month,input_count,output_count
cccaecdcc6c7e043555f97cc059205b8916cac0ef28a33c78f2c070efe672cb8,2023-10-01,8,8
2e1ff25b18fd56e09724cb107327ef0590acce2dfb8bf8320dd80d674f10919e,2023-10-01,8,8
d195f0757fd290804353455e3e4c6cad70965dca089ff97811b26effa3195f0f,2023-10-01,10,16
efca68c830ed2e5b34ba9d971275fa76d0e9bf6b500ff681d9b9eca44fca6c85,2023-09-01,28,18
7d8306e310bf7ef8b5a2b0753964b8a4329c3a22a046b8457c32333ce49c277d,2023-10-01,58,91
e4120f354dfd46a969347b40f04d380839237b6d58a714ff873994d80da2d804,2023-09-01,5,131
ff311e5248648fa0e44a757cf93a25d2abe7ba9101eba0fc0750938aadfb70b3,2023-10-01,21,213
531fceb2c0d0f5d389ee1bfb06e60c2a9210ab57dfc1b7231b876f331b0261d5,2023-09-01,10,5
7efbdbe07c3af8607e8c95cf4464b79e52e07a20b4c678d7b5dbbb03c6f77aa1,2023-09-01,5,6
035fced09ed0cab7e7dc94877df82188830c0fa164b97cfca03277e43b75945b,2023-09-01,46,7
55bfa08d435d205d3d4eb658e89c8c7afe8c41d6ca2dce84a26beb1d37a7ac40,2023-10-01,8,8
03ea3e6371e4b75412f3cd8cb44905989a3c104ff5fc3c456f8facd1e3b1e48d,2023-10-01,8,8
805c4c360352669796ebe8927eb9b987c34e4b7ec388b457a5c76b8252a65879,2023-10-01,8,9
ee13b1af6494cf3cb8a6b2adad05717c7b2f6a5614c2e6d9e4dfaa6659431544,2023-09-01,10,11
99f8da23c2a084f1d36b837a7539ef5e9b13da4de99178a0350e28882379a383,2023-10-01,83,38
fccda3576b4e0367a08c3fdb1436d71f376aa64d527fc940b6d3134dded0fff6,2023-09-01,6,6
6557422fcfbc936dae581b67d2397dd2237bc86f47ed70c111999453414bdece,2023-10-01,5,6
68520dea01034193f2e3415d72fc8189ccd5536d50426a53dde9dedaf2ec81c9,2023-09-01,7,7
1382088a31322e270f9d46350c982872b0c6433125bd87e9ba3d23b425261809,2023-10-01,45,7
11b042bd539a384869eaabb343f17ab986f7f8a9262985fae69c29f6d0611cf1,2023-10-01,8,8
1e9b53340fad85d72ebf9b7a2d5f0da85526f97016075103bec79c9ea0439b3d,2023-10-01,8,8
f2ab64650666a0f4c73239009bfa12374c487d7b441e6c39756eca40dd0d8d0e,2023-10-01,29,13
f7dfe3b4770be65e8f0f023067feda37b3fb5bcbf996d0c75a5e425c8defa115,2023-10-01,11,13
cb554500f0923eff03e97ff9bee4766ef950e27c2247f8e67595abfdd39999e0,2023-10-01,39,14
590de27c1603374202dd4e28e21989e5b6d17a0194d55f9aa6ff135da6da450b,2023-09-01,10,231
03707d452fe5bb5d3b08f8e9d1c843c6d4078a85c1aeb87b0ebd0f739e8686cc,2023-09-01,5,5
4d1835eb51aca5d9deaaa16cd69177132997a74b7694dee2d17567700dbefa53,2023-10-01,12,5
60287c6d3d628b383d0132a9821065718a63644c65edcc7b6171c36e39bb84f2,2023-10-01,8,8
04db87d3b93ffcb68545009de92064fb7f0f59fe87de83cf7ed5f1fbec5b5202,2023-10-01,8,8
98b8fc09f0df3639fc7ebab3fd6e5134d1b5c636996663fe081685f1d530b493,2023-10-01,8,8
bcef0ae6e9d89e28f34325af45f52eefe5c44d79413bb854ecc319f88cbe5447,2023-10-01,27,9
51377950ef852e2e6dfe72764e8954a3e1144b97a3cf51991ffbd9e9aea4f86e,2023-09-01,6,10
1f6487cb75618e2c6b9f24eeebdeec13c2a14f130c019ca323f9bd8b84866a1b,2023-10-01,15,21
5854b42dcc7b9198316fc9a16b1167e9115fe2810de53b3a939fb25aaa12fa12,2023-09-01,22,23
4c8c54ca79e15c9342bc67af5990e10ed6124110b1bbe3c1cda983ddab6e6f69,2023-10-01,11,81
312cc4b1075acf9d5e2c2289bf629457c25a526bf963e62de21292bb934e1130,2023-10-01,10,5
f82d8d30608b9bf760318de769c903945db950bf8982a5b96f59675609fa36e4,2023-10-01,5,5
11441ecfdd1c623e8fa5d276eddf08cb58b0fb8179a16ed24908e8ff89700669,2023-09-01,5,6
809516777f5358648c798b80dee57a453111d884622c1c8d761dfa949c26f4a0,2023-09-01,10,6
454cbdecf835b470f8ee3d7504b758ae26b6c0f58d4230306b1ad0feb0723e42,2023-09-01,5,7
bfda5c1041959411686ada64d857acf4ffff07c1539eb973a66221efb8ec7ce5,2023-09-01,10,8
b544211e30bcca5dcb56c5c7c3cc88af2229dd3e72cd9abceb740f383b28fe68,2023-09-01,10,8
9f290fb853a238aa7e269a1c3330127211cc3c8d11785a7fb1fb72330f6a63ea,2023-10-01,8,8
37ab0c966885b5906f8c898101b7e87361c099e22eb8c4d7657e84f3d1eed9d6,2023-10-01,8,8
16945e757988b2b1e4796f921d355fe2d064ae0d79da41a507370bbd2b12e368,2023-09-01,10,9
e629f209e0ffcf5ab0f1c9bbb88fa00fd2fae3ddab636a5584c1dd5018ec2c03,2023-09-01,10,10
6d16fdcd620f346763cc802cd3a6f92e0e63217c1fa37beb65aa294789ae7694,2023-10-01,10,11
8b66a52ed0daadd6fe787641e71958c36a4e88d083985a43e60138a7d92eb7d5,2023-10-01,15,15
d10d498ade2f8ea0a400e935fc2752c6a501310fa0c2b59f88d43dfb7ad4191e,2023-09-01,26,19
c731591a0e446b1bc4e1f268ea0d26d9de5b7f0a3cf33a7410e6daf724990a19,2023-09-01,23,5
a58b1793d634b515d8543903e3634601bec37b71fd50eda01244c93d886a73be,2023-09-01,6,6
ebf85271963863db8038d34aaef8f5807fd45d9e438ba5017352ff1c31991a85,2023-09-01,5,7
7fa65c3a0caaabd7ebd079db27803b244f803ac5d658f327831059f0367010a7,2023-09-01,10,9
1b1756b1beb3f6f81192fb3a49b9ec94070a4e3e1e0e3aea6dce33ae59ba723d,2023-10-01,12,9
8b3a99bb9e736ec08e11907ca37da1e290215cd6f90f5701fec661d63fc99f75,2023-10-01,8,13
79d25a139db70af90ce96941fa7befec2159158690af41e3b07f4318c18e4fe9,2023-10-01,7,28
a2fdeafb0687c6b73e8e2c08169bbbcf634783ebaad841feab1cc5586222f737,2023-09-01,17,54
640fff5b34bb802e3d57d3800722b1e47102bb7c7bd33b5c49b0a45da1a55897,2023-09-01,14,177
78a23294127e79d14d4213d6ab586dfc2476db290a10c055c5e5f9dd0ee9586f,2023-09-01,48,211
8e2c8d33da568e829d2abad9d73c10a1623e77cdcf77f4f983644a76d696af61,2023-09-01,328,303
3fafe1801f4cb25292b96a4180b4cd273e1856dc366d4d59a9779db3a7fc86b7,2023-09-01,13,6
5

2025-01-26 01:21:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:21:36 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:21:36 - root - INFO - SQL:
SELECT "block_timestamp_month",
          AVG("input_count") AS "average_input_count",
          AVG("output_count") AS "average_output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
Results:
block_timestamp_month,average_input_count,average_output_count
2023-09-01,2.305374,2.677691
2023-10-01,3.795484,3.010431

2025-01-26 01:21:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:21:38 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:21:38 - root - INFO - SQL:
SELECT "block_timestamp_month", SUM("output_value") AS "total_volume"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
Results:
block_timestamp_month,total_volume
2023-09-01,7305381621178.000000000
2023-10-01,6921152069207.000000000

2025-01-26 01:21:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:21:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:21:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:21:39 - snowflake.connector.connection - INFO - closed
2025-01-26 01:21:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:22:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:22:13 - root - INFO - **Explanation:**

The error occurs because Snowflake does not support the `UNIX_TIMESTAMP` function. Instead, we can use the `DATE_PART` and `TO_TIMESTAMP` functions to achieve the same result.

Assuming that the `"block_timestamp"` column is in **milliseconds** since the Unix epoch, we can convert the date `'2023-07-01'` to milliseconds since the epoch and compare it directly with `"block_timestamp"`.

Here's the corrected query:

```sql
SELECT o."transaction_hash",
       COUNT(*) AS "output_count",
       MIN(o."value") AS "min_value",
       MAX(o."value") AS "max_value"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE o."block_timestamp" >= 1000 * DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('2023-07-01'))
GROUP BY o."transaction_hash"
HAVING COUNT(*) > 1 AND MIN(o."value") = MAX(o."value")
LIMIT 100;
```

**Explanation of Changes:**

- **Replace `UNIX_TIMESTAMP` Function:**
  - In Snowflake, use `DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('date_string'))` to get the Unix epoch time (in seconds) for a given date.
  - Multiply by `1000` to convert seconds to milliseconds (since `"block_timestamp"` is in milliseconds).

- **Full Correction:**

  ```sql
  WHERE o."block_timestamp" >= 1000 * DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('2023-07-01'))
  ```

**Alternatively**, you can convert `"block_timestamp"` from milliseconds to a timestamp and compare it directly with `'2023-07-01'`:

```sql
SELECT o."transaction_hash",
       COUNT(*) AS "output_count",
       MIN(o."value") AS "min_value",
       MAX(o."value") AS "max_value"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) >= TO_TIMESTAMP('2023-07-01')
GROUP BY o."transaction_hash"
HAVING COUNT(*) > 1 AND MIN(o."value") = MAX(o."value")
LIMIT 100;
```

**Explanation of Alternative:**

- **Convert `"block_timestamp"` to Timestamp:**
  - Divide `"block_timestamp"` by `1000` to convert from milliseconds to seconds.
  - Use `TO_TIMESTAMP_NTZ` to convert the epoch seconds to a timestamp without time zone.

- **Compare Timestamps Directly:**

  ```sql
  WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) >= TO_TIMESTAMP('2023-07-01')
  ```

**Note:** Ensure that the data type and format of `"block_timestamp"` are as expected. If `"block_timestamp"` is stored in seconds instead of milliseconds, adjust the calculations accordingly (omit multiplying or dividing by `1000`).

**Please try running the corrected query.**
2025-01-26 01:22:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:22:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:22:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:22:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:22:14 - snowflake.connector.connection - INFO - closed
2025-01-26 01:22:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:24:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:24:03 - root - INFO - SQL:
SELECT o."transaction_hash",
       COUNT(*) AS "output_count",
       MIN(o."value") AS "min_value",
       MAX(o."value") AS "max_value"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE o."block_timestamp" >= 1000 * DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('2023-07-01'))
GROUP BY o."transaction_hash"
HAVING COUNT(*) > 1 AND MIN(o."value") = MAX(o."value")
LIMIT 100;
Results:
Too long, hard cut:
transaction_hash,output_count,min_value,max_value
0c74f7059941b96dfd4edc89d0e4612950a0d48db75c8d01f70f0d27730ce479,3,1128.000000000,1128.000000000
67c4fb61cf5dad5e69846010e591ad417e99976d92656c63d81be8852dd08a96,2,66404.000000000,66404.000000000
eb475a400defc4d3223be7dd8c1afb73fc6f558220770ac55601b030d5312b91,6,546.000000000,546.000000000
9489f52b919a4b18bf79cd0d86abb50408f418a6cbebc676aacbd940696f2f4f,4,1124.000000000,1124.000000000
55dd72dd035cc440ef2d8276cd9e2816c74d957cf354966482b3e32c89686368,2,1000.000000000,1000.000000000
a0baa99a9ffa552d3db2197888eaac15054f9d5a9c52b0d8455fbed03b7c62c7,3,4195.000000000,4195.000000000
a44b18773b1c0e0a5cc9fd2fedd14c8ad7d3663277bdff3f9dc3a91e03767da1,2,25046.000000000,25046.000000000
4976ef23c498dbf29ee1cf59258250ccb9d1b264b07a790d53fae60146d20922,2,1175.000000000,1175.000000000
63bd097c6eaae3d19395a768cc45f9e37f87dff1359e71940904cf52cde0ed12,3,546.000000000,546.000000000
c7ba81da70ed790f7508dfb070c4c370672de5019692422bbecb72a88faac90c,2,1141.000000000,1141.000000000
7db179edc3c9cc3c9f7a97133cd051e62626aba3947cb73e86a422cfcb8313e8,2,2406.000000000,2406.000000000
fa164bab769bb29cd929b9a1ee9e8f1bb91ea61e29a96293af4c62f20380296d,2,4000.000000000,4000.000000000
a75e2b4cff227807e199d0d78433d00e196c92e43d01406f9e3f690d8b021262,2,3428.000000000,3428.000000000
f5536fce8da7b5c92642729f8e39aef9c8737b6d6304c7cd25f50ade07ce6118,2,8443.000000000,8443.000000000
50d16c991a1359a9498bd080b5835d129baf87cdb941e2777e661f2d792a81f1,2,10000.000000000,10000.000000000
5867b4c88c4f49e0f1e002b65ebfa44af60a934f2eee391821d45a5270036c2c,2,1245.000000000,1245.000000000
d9a05957ce3dcc04bcc2a12a3aaf291cdc9525d45b71d85ed1944502cf6a8676,2,174146.000000000,174146.000000000
718099fcd9ceb2232db809945b9007c03e1cdb768c131c22726045b823370110,2,1161.000000000,1161.000000000
0a0d73b38bf4dedbf108f4196618a7ae4b1b5c0600af4d384fba03d8932e428d,3,888.000000000,888.000000000
91def2dbad80a03e60a6e6c9cb6604d4a314f9de92448a5b7583319a179f808b,2,109220.000000000,109220.000000000
b028bd89892b3ceb71eb9267a6353a0a688db92b8bffeae583155bda0f016d5d,2,3586.000000000,3586.000000000
2a9985b2c1cea1887ad54c1ebc5212be83d0544271c7e033af683ee7c7dd2eae,2,2500.000000000,2500.000000000
dffea290e2afc6323dd41748b2a1c453f015fac04ffec63563382221efdd7ce8,4,1151.000000000,1151.000000000
f849c3d53b12977876708417d704401ae2b88fdd9792d958c7142fd85ac3048d,2,1168.000000000,1168.000000000
c399e14fb345f2c02e63cef85fc5f1e337d26eb686e12cde7f16e508372ed553,3,11904.000000000,11904.000000000
f4edb4673afe99d3f3ffd822c70e39379f428d8480cff1db359d53dcea4c9334,2,1957.000000000,1957.000000000
e0ec820b73c1c104db23d9d2864735c1a202e2e8021f78b90a8db661591a1fc9,2,10000.000000000,10000.000000000
1b438db7b39088cfb57951cccac3c579e945b722e1d9a021fc55f44a33d02712,2,1164.000000000,1164.000000000
a2e81cf84ca36866168d613afff76bab1133cc473dc0bee66e7068fa396f9c65,3,3953.000000000,3953.000000000
83164ef91a72932646bb6a80782e665a3c3264be00d0bd0101377824c01b8737,3,330.000000000,330.000000000
2adef1fbec5fa958f7eda7d02ac2e249040eb30f4d5514a8bc765e85f11b1908,2,129800.000000000,129800.000000000
96f11ad2c72428eaf17c6d2e4f62b04e5a64271a71b11eb98d04dbfcf5f44412,3,546.000000000,546.000000000
e45f72fcd8b9a09a85eb960594f048bf3e2660f4359e55549e7212381f1f2eb8,4,546.000000000,546.000000000
f0036946e27b944820cb03270f27211bba649e7477a121e803dee77d7a6b78d0,2,3616.000000000,3616.000000000
a7cd91b51a71aef492015141d945af03ab8ad71aaffe36bd8a55388dd4e31914,2,10000.000000000,10000.000000000
e7faaa689d13fc3e2cf0f50c646e939ca015bcb647d2016b8cd87940d143c37e,3,5562.000000000,5562.000000000
a65ba859d5282c1217f04a6adcb7030a191fde17c5aa2eb0707015d11624d5f7,2,102730.000000000,102730.000000000
0cd5d71bf32b86f3030ad900d4b414ecfc1d0e6fd87a3429475780884af69026,2,10000.000000000,10000.000000000
667fbceaf34e60d962a5c3b1ceda3e648de696df1ece4f8d8fb5e64acad3c05e,3,1010.000000000,1010.000000000
594d4b10dec0bae145ddc0952834be1f086b919e62746419923c9b8fe4e06120,3,1158.000000000,1158.000000000
9ef6958634cdf3942d62bb586da416f0205354e5c486d5b1995345b2af43c205,2,2124.000000000,2124.000000000
8f33ad7698c23c1ecaeea0133179d01894e6f6cad264e1c3715379fd9dda4e6a,4,330.000000000,330.000000000
db0e58b8fcef00f12da48c24275bf700e353cfacb4cafa7871c996a641a12ed9,2,548.000000000,548.000000000
2b780e3798d79022302c955f5e0948a2e304e671d76b172a69c902e7dad0f478,2,3318.000000000,3318.000000000
18ede4e2842cced3a11824438e9e8b4771b41035033ba7e678a9b50f7774928f,2,1128.000000000,1128.000000000
c896fecf8b84df06760068efa5db7ff46deca45d85fbea9b8cfecb1c8dca177e,2,888.000000000,888.000000000
da725bc2fa648b05e55b49b98a904b0717b91c220b1e84e51347f17488b84012,2,29981.000000000,29981.000000000
6ad079609527014d65dd596f433fb5e28ee335c4ccb8babe650b3206f8a2f33f,7,1143.000000000,1143.000000000
9822ef4d4162e15076e5a9191daab2ad47aef42dc9eac5edb136af131d1e2491,2,1145.000000000,1145.000000000
02214bcfa0f3c8880100468bac73378e83f35fdcb16cae2f12644a382ba16e28,2,2231.000000000,2231.000000000
7162640e086c26ec57d43d82cd6152d6ef5289017f5ffa84bf87047a4b16b627,3,1966.000000000,1966

2025-01-26 01:24:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:24:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:24:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:24:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:24:04 - snowflake.connector.connection - INFO - closed
2025-01-26 01:24:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:24:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:24:33 - root - INFO - **Explanation:**

The error message you're encountering:

```
252005: 252005: Failed to convert current row, cause: year 41092 is out of range
```

indicates that when trying to convert `"block_timestamp"` to a timestamp, some values result in dates that are outside the acceptable range (e.g., year 41092). This typically happens when the timestamp values are not in the expected format or units.

**Possible Reasons:**

1. **Incorrect Timestamp Units:**
   - The `"block_timestamp"` column might not be in milliseconds since the Unix epoch (which is common). It could be in **seconds**, **microseconds**, or **nanoseconds**.
   - Dividing or not dividing by `1000` incorrectly can lead to unrealistic dates.

2. **Invalid Data Entries:**
   - There may be null or incorrect values in `"block_timestamp"` that cannot be converted to valid timestamps.

**Solution:**

1. **Determine the Correct Units of `"block_timestamp"`:**
   - We need to verify whether `"block_timestamp"` is in **seconds**, **milliseconds**, **microseconds**, or **nanoseconds**.

2. **Adjust the Conversion Accordingly:**
   - If `"block_timestamp"` is in seconds, we should not divide by `1000`.
   - If it's in milliseconds, dividing by `1000` converts it to seconds for `TO_TIMESTAMP_NTZ`.

3. **Handle Invalid Values:**
   - Use `TRY_TO_TIMESTAMP_NTZ` instead of `TO_TIMESTAMP_NTZ` to safely handle invalid conversions.
   - Filter out any rows where the timestamp conversion results in `NULL`.

**Steps to Resolve:**

1. **Check the Timestamp Units:**

   Run a test query to inspect the timestamps:

   ```sql
   SELECT o."block_timestamp",
          TO_TIMESTAMP_NTZ(o."block_timestamp") AS "timestamp_seconds",
          TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) AS "timestamp_milliseconds"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   LIMIT 10;
   ```

   Observe which conversion yields valid dates.

2. **Correct the Query Based on Units:**

   - **If `"block_timestamp"` is in seconds:**

     ```sql
     SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp")) AS "month",
            COUNT(*) AS "total_outputs"
     FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
     WHERE TO_TIMESTAMP_NTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
     GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp"))
     ORDER BY "month"
     LIMIT 100;
     ```

   - **If `"block_timestamp"` is in milliseconds:**

     ```sql
     SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000)) AS "month",
            COUNT(*) AS "total_outputs"
     FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
     WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) >= TO_DATE('2023-07-01')
     GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000))
     ORDER BY "month"
     LIMIT 100;
     ```

   - **If unsure or if there are invalid values, use `TRY_TO_TIMESTAMP_NTZ`:**

     ```sql
     SELECT DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000)) AS "month",
            COUNT(*) AS "total_outputs"
     FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
     WHERE TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) >= TO_DATE('2023-07-01')
     GROUP BY DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000))
     ORDER BY "month"
     LIMIT 100;
     ```

**Corrected Query Using `TRY_TO_TIMESTAMP_NTZ`:**

```sql
SELECT DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000)) AS "month",
       COUNT(*) AS "total_outputs"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) >= TO_DATE('2023-07-01')
  AND TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) IS NOT NULL
GROUP BY DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000))
ORDER BY "month"
LIMIT 100;
```

**Explanation:**

- **TRY_TO_TIMESTAMP_NTZ Function:**
  - `TRY_TO_TIMESTAMP_NTZ` attempts to convert the input expression to a timestamp.
  - If the conversion fails (due to invalid input), it returns `NULL` instead of throwing an error.

- **Filtering Out NULL Values:**
  - We added `AND TRY_TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) IS NOT NULL` to exclude rows where the conversion failed.

- **Ensuring Valid Timestamps:**
  - By using `TRY_TO_TIMESTAMP_NTZ` and filtering out `NULL` values, we prevent the error caused by invalid dates.

**Additional Recommendations:**

- **Verify Data Integrity:**
  - Investigate why there are invalid or out-of-range timestamps in the data.
  - There might be data quality issues that need to be addressed.

- **Consider Data Ranges:**
  - If you know the valid range of timestamps for Bitcoin outputs (e.g., starting from Bitcoin's inception in 2009), you can add additional filters to exclude unrealistic dates.

  Example:

  ```sql
  AND o."block_timestamp" BETWEEN 1231006505000 AND 2000000000000
  ```

  Where `1231006505000` corresponds to `2009-01-03 18:15:05` in milliseconds.

**Testing the Solution:**

- Run the corrected query to see if it executes without errors.
- If errors persist, double-check the units and data types of `"block_timestamp"`.

**Conclusion:**

The error occurs because some `"block_timestamp"` values cannot be converted to valid timestamps. By using `TRY_TO_TIMESTAMP_NTZ` and filtering out `NULL` results, we can handle these cases gracefully and execute the query successfully.
2025-01-26 01:24:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:24:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:24:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:24:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 01:24:34 - snowflake.connector.connection - INFO - closed
2025-01-26 01:24:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:25:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:25:20 - root - INFO - **Explanation:**

The error message you're encountering:

```
252005: 252005: Failed to convert current row, cause: <built-in method fromutc of datetime.timezone object at 0x7f290579ce70> returned a result with an exception set
```

indicates that there's an issue with converting the `"block_timestamp"` values to timestamps. This could be due to:

1. **Incorrect Units of `"block_timestamp"`:**

   - The `"block_timestamp"` might not be in milliseconds since the Unix epoch as previously assumed.
   - It could be in **seconds**, **microseconds**, or **nanoseconds**.

2. **Invalid or Out-of-Range Values:**

   - Some `"block_timestamp"` values might be invalid or result in dates that are out of the acceptable range when converted.

**Steps to Resolve:**

1. **Determine the Correct Units of `"block_timestamp"`:**

   Let's inspect some sample `"block_timestamp"` values to understand their units.

   ```sql
   SELECT o."block_timestamp"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   LIMIT 10;
   ```

   **Interpretation:**

   - **If the values are around `1690000000`**, they are likely in **seconds** since the Unix epoch.
   - **If the values are around `1690000000000`**, they are likely in **milliseconds**.
   - **If the values are much larger**, they might be in **microseconds** or **nanoseconds**.

   **Example Values and Corresponding Units:**

   | block_timestamp       | Approximate Date            | Units          |
   |-----------------------|-----------------------------|----------------|
   | 1695868800            | Sept 28, 2023               | Seconds        |
   | 1695868800000         | Sept 28, 2023               | Milliseconds   |
   | 1695868800000000      | Sept 28, 2023               | Microseconds   |
   | 1695868800000000000   | Sept 28, 2023               | Nanoseconds    |

2. **Adjust the Conversion Based on Units:**

   **If `"block_timestamp"` is in seconds:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

   **If `"block_timestamp"` is in milliseconds:**

   *(Divide by `1000` to convert to seconds)*

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000)) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000) >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000))
   ORDER BY "month"
   LIMIT 100;
   ```

   **If `"block_timestamp"` is in microseconds:**

   *(Divide by `1,000,000` to convert to seconds)*

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000))
   ORDER BY "month"
   LIMIT 100;
   ```

3. **Handle Invalid Conversion Results:**

   Use `TRY_TO_TIMESTAMP_NTZ` to safely handle any invalid timestamp conversions.

   ```sql
   SELECT DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TRY_TO_TIMESTAMP_NTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
     AND TRY_TO_TIMESTAMP_NTZ(o."block_timestamp") IS NOT NULL
   GROUP BY DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

4. **Confirming the Correct Conversion:**

   Let's test with the assumption that `"block_timestamp"` is in **seconds**.

   **Modified Query:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

   **Explanation:**

   - **Removed Division by `1000`:** Assuming the timestamps are already in seconds.
   - **Used `TO_TIMESTAMP_NTZ`:** Converts epoch seconds to timestamp.

5. **Handling Time Zone Issues:**

   If the error persists, try using `TO_TIMESTAMP_LTZ` (local time zone) or `TO_TIMESTAMP` (with time zone).

   **Using `TO_TIMESTAMP_LTZ`:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_LTZ(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_LTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_LTZ(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

   **Using `TO_TIMESTAMP`:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP(o."block_timestamp") >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

6. **Check for Null or Invalid Values:**

   Include a condition to filter out any `NULL` or invalid `"block_timestamp"` values.

   ```sql
   SELECT DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TRY_TO_TIMESTAMP_NTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
     AND TRY_TO_TIMESTAMP_NTZ(o."block_timestamp") IS NOT NULL
   GROUP BY DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

7. **Final Corrected Query:**

   **Assuming `"block_timestamp"` is in seconds:**

   ```sql
   SELECT DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp")) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TRY_TO_TIMESTAMP_NTZ(o."block_timestamp") >= TO_DATE('2023-07-01')
     AND TRY_TO_TIMESTAMP_NTZ(o."block_timestamp") IS NOT NULL
   GROUP BY DATE_TRUNC('month', TRY_TO_TIMESTAMP_NTZ(o."block_timestamp"))
   ORDER BY "month"
   LIMIT 100;
   ```

8. **Testing the Query:**

   - Run the modified query.
   - If it works without errors and returns expected results, then the `"block_timestamp"` values are in seconds.
   - If not, adjust the division factor as needed (e.g., divide by `1000` or `1000000`).

**Summary:**

- **Verify the units of `"block_timestamp"`** by inspecting the data.
- **Adjust the conversion accordingly:**
  - **Seconds:** No division needed.
  - **Milliseconds:** Divide by `1000`.
  - **Microseconds:** Divide by `1,000,000`.
- **Use `TRY_TO_TIMESTAMP_NTZ`** to handle any invalid timestamps.
- **Filter out `NULL` values** resulting from failed conversions.
- **Adjust the query based on findings** to resolve the error.

**Note:**

- The error message indicates a problem during timestamp conversion, likely due to incorrect units or invalid data.
- By verifying the units and handling invalid values, we can resolve the issue and obtain the desired results.

**Next Steps:**

1. **Run the Sample Query to Determine Units:**

   ```sql
   SELECT o."block_timestamp"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   LIMIT 10;
   ```

2. **Adjust the Conversion Factor Based on the Observed Units.**

3. **Use the Final Corrected Query with Appropriate Conversion.**

4. **If Errors Persist, Consider Checking for Data Issues:**

   - There might be some corrupted or improperly formatted data.
   - You may need to exclude or clean such data.

5. **Feel Free to Reach Out if You Need Further Assistance.**

---

I hope this helps you resolve the error and successfully run your query. Let me know if you have any questions or need further clarification.
2025-01-26 01:25:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:25:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:25:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:25:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 01:25:22 - snowflake.connector.connection - INFO - closed
2025-01-26 01:25:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:25:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:25:59 - root - INFO - SQL:
SELECT o."block_timestamp"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   LIMIT 10;
Results:
block_timestamp
1434133281000000
1403725915000000
1601554753000000
1465827780000000
1663890771000000
1562550012000000
1664215824000000
1528919737000000
1630828581000000
1563104884000000

2025-01-26 01:25:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:25:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:25:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:26:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:26:00 - snowflake.connector.connection - INFO - closed
2025-01-26 01:26:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:26:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:26:44 - root - INFO - **Analysis:**

Based on the sample `"block_timestamp"` values you provided:

```
block_timestamp
1434133281000000
1403725915000000
1601554753000000
1465827780000000
1663890771000000
1562550012000000
1664215824000000
1528919737000000
1630828581000000
1563104884000000
```

These values are large integers, approximately in the range of 1.4 * 10^15 to 1.6 * 10^15. This suggests that the `"block_timestamp"` is stored in **microseconds** since the Unix epoch (January 1, 1970).

**Conversion to Timestamp:**

To convert microseconds since the Unix epoch to a timestamp, we'll need to:

1. **Divide the `"block_timestamp"` by 1,000,000** to get the value in seconds.
2. **Use `TO_TIMESTAMP_NTZ`** to convert the epoch seconds to a timestamp.

**Corrected SQL Queries:**

Here are the corrected SQL queries, adjusting for the microsecond timestamps:

---

1. **Monthly Outputs and Occurrences:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)) AS "month",
          o."value", COUNT(*) AS "occurrences"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)), o."value"
   ORDER BY "month", "occurrences" DESC
   LIMIT 100;
   ```

---

2. **Extracting Addresses from Outputs Since July 1, 2023:**

   ```sql
   SELECT o."transaction_hash", o."block_timestamp", a.value AS "address"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
        LATERAL FLATTEN(input => o."addresses") a
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   LIMIT 100;
   ```

---

3. **Extracting Addresses from Inputs Since July 1, 2023:**

   ```sql
   SELECT i."transaction_hash", i."block_timestamp", a.value AS "address"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i,
        LATERAL FLATTEN(input => i."addresses") a
   WHERE TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   LIMIT 100;
   ```

---

4. **Counting Outputs per Value Since July 1, 2023:**

   ```sql
   SELECT o."value", COUNT(*) AS "number_of_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY o."value"
   ORDER BY "number_of_outputs" DESC
   LIMIT 100;
   ```

---

5. **Total Number of Inputs Per Month:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000)) AS "month",
          COUNT(*) AS "total_inputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i
   WHERE TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000))
   ORDER BY "month"
   LIMIT 100;
   ```

---

6. **Transactions with Outputs to More Than Five Different Addresses:**

   ```sql
   SELECT o."transaction_hash", COUNT(DISTINCT a.value) AS "unique_addresses"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
        LATERAL FLATTEN(input => o."addresses") a
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY o."transaction_hash"
   HAVING COUNT(DISTINCT a.value) > 5
   LIMIT 100;
   ```

---

**Explanation:**

- **Microseconds to Seconds Conversion:**
  - We divide `"block_timestamp"` by **1,000,000** to convert microseconds to seconds.
    ```sql
    o."block_timestamp" / 1000000
    ```

- **Timestamp Conversion:**
  - Use `TO_TIMESTAMP_NTZ` to convert epoch seconds to timestamps.
    ```sql
    TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)
    ```

- **Date Comparison:**
  - Compare the converted timestamp with `'2023-07-01'` using `TO_DATE('2023-07-01')`.

**Notes on Other SQL Queries:**

- **Queries Using `"block_timestamp_month"`:**
  - Since `"block_timestamp_month"` appears to be already formatted correctly (e.g., `'2023-09-01'`), no changes are needed for queries using this column.

- **Queries Without Timestamp Conversion Errors:**
  - No adjustments are necessary for these queries.

**Understanding the Error Messages:**

- The errors occurred because the conversions were using incorrect units, resulting in invalid timestamp values.
- By adjusting the division factor to match the units (microseconds in this case), we can correctly convert the timestamps and eliminate the errors.

**Validation of Timestamp Units:**

- **Sample Calculation:**
  - Take a sample `"block_timestamp"` value: `1434133281000000`.
  - Divide by `1,000,000`: `1434133281` seconds.
  - Convert to a human-readable date:
    ```sql
    SELECT TO_TIMESTAMP_NTZ(1434133281) AS "date";
    ```
    - This gives us `2015-06-12 19:28:01`, which is a valid date.
  - This confirms that the timestamps are in microseconds.

**Conclusion:**

- **Adjust Timestamp Conversion in Queries:**
  - Always divide `"block_timestamp"` by `1,000,000` when converting to timestamps.
- **Run Corrected Queries:**
  - The corrected queries should now execute without errors.
- **Further Assistance:**
  - If you encounter any other issues or have questions, feel free to ask.

---

I hope this helps you resolve the errors in your SQL queries. Let me know if there's anything else I can assist you with!
2025-01-26 01:26:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:26:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:26:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:26:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:26:45 - snowflake.connector.connection - INFO - closed
2025-01-26 01:26:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:27:22 - root - INFO - SQL:
SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)) AS "month",
          o."value", COUNT(*) AS "occurrences"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)), o."value"
   ORDER BY "month", "occurrences" DESC
   LIMIT 100;
Results:
month,value,occurrences
2023-07-01,330.000000000,4943
2023-07-01,546.000000000,1555
2023-07-01,600.000000000,345
2023-07-01,10000.000000000,157
2023-07-01,100000.000000000,93
2023-07-01,1173.000000000,88
2023-07-01,946.000000000,87
2023-07-01,1316.000000000,86
2023-07-01,1097.000000000,74
2023-07-01,1200.000000000,72
2023-07-01,1163.000000000,70
2023-07-01,1100.000000000,70
2023-07-01,1135.000000000,69
2023-07-01,0E-9,69
2023-07-01,5000.000000000,68
2023-07-01,1162.000000000,68
2023-07-01,1254.000000000,67
2023-07-01,863.000000000,65
2023-07-01,1166.000000000,65
2023-07-01,1122.000000000,64
2023-07-01,1000000.000000000,63
2023-07-01,1155.000000000,63
2023-07-01,1164.000000000,62
2023-07-01,1159.000000000,60
2023-07-01,1142.000000000,57
2023-07-01,333.000000000,54
2023-07-01,1138.000000000,53
2023-07-01,814.000000000,52
2023-07-01,1108.000000000,51
2023-07-01,5000000.000000000,50
2023-07-01,1153.000000000,50
2023-07-01,1170.000000000,50
2023-07-01,1470.000000000,50
2023-07-01,1130.000000000,49
2023-07-01,1150.000000000,48
2023-07-01,1128.000000000,48
2023-07-01,1174.000000000,45
2023-07-01,1185.000000000,45
2023-07-01,1178.000000000,44
2023-07-01,810.000000000,44
2023-07-01,1114.000000000,43
2023-07-01,50000.000000000,42
2023-07-01,1167.000000000,41
2023-07-01,1425.000000000,40
2023-07-01,1000.000000000,40
2023-07-01,1168.000000000,40
2023-07-01,1116.000000000,39
2023-07-01,1300.000000000,38
2023-07-01,1113.000000000,38
2023-07-01,846.000000000,38
2023-07-01,1103.000000000,37
2023-07-01,1152.000000000,37
2023-07-01,824.000000000,36
2023-07-01,1161.000000000,36
2023-07-01,1160.000000000,36
2023-07-01,1110.000000000,36
2023-07-01,3000.000000000,35
2023-07-01,1171.000000000,34
2023-07-01,1089.000000000,34
2023-07-01,20000.000000000,34
2023-07-01,1157.000000000,34
2023-07-01,13000.000000000,34
2023-07-01,845.000000000,34
2023-07-01,1778.000000000,34
2023-07-01,10000000.000000000,33
2023-07-01,1117.000000000,33
2023-07-01,1068.000000000,33
2023-07-01,1158.000000000,32
2023-07-01,1137.000000000,32
2023-07-01,1118.000000000,32
2023-07-01,1099.000000000,31
2023-07-01,380.000000000,30
2023-07-01,1624.000000000,30
2023-07-01,811.000000000,30
2023-07-01,1617.000000000,30
2023-07-01,901.000000000,29
2023-07-01,1398.000000000,29
2023-07-01,1145.000000000,29
2023-07-01,1101.000000000,29
2023-07-01,300.000000000,28
2023-07-01,1140.000000000,28
2023-07-01,531441.000000000,28
2023-07-01,1141.000000000,27
2023-07-01,1119.000000000,27
2023-07-01,1604.000000000,26
2023-07-01,1175.000000000,26
2023-07-01,200000.000000000,26
2023-07-01,879.000000000,26
2023-07-01,1182.000000000,25
2023-07-01,1069.000000000,25
2023-07-01,1172.000000000,25
2023-07-01,1571.000000000,25
2023-07-01,779.000000000,25
2023-07-01,4000.000000000,25
2023-07-01,1540.000000000,25
2023-07-01,1191.000000000,24
2023-07-01,1121.000000000,23
2023-07-01,1032.000000000,23
2023-07-01,945.000000000,23
2023-07-01,1195.000000000,22

2025-01-26 01:27:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:23 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:23 - root - INFO - SQL:
SELECT o."transaction_hash", o."block_timestamp", a.value AS "address"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
     LATERAL FLATTEN(input => o."addresses") a
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
LIMIT 100
Results:
Too long, hard cut:
transaction_hash,block_timestamp,address
9d74333024b9d44a7b9db8541f27f73f2c77e11275a8ad6d575c1ab03dd64ad5,1710384546000000,"""3MwVg3WQ3HsQ68QHSotuMkfQhsEfNg7Cuy"""
a4c2b833d1d45ebe4fa51776be9b6c037ce5d0dbd58748080c2097a7be874ce4,1709747970000000,"""bc1qx8c8kufsvdq7alej048axzrfehjwcxem0fmvw8"""
17a12fd009f475f4172a8b56146bcfb8a8e86b9fc40557796019b7b28dc995a5,1728117660000000,"""bc1qw09fpz28e0cqqu2240vjj2mgcjz54mg30e790f"""
278af14736b3c14e524a81848cfae1f5d5c3a8d20664f5227816a6f7295ff426,1693840129000000,"""bc1qjcsa6qx27dy6rpx7rhwuza7zthlx8x9ysqywew"""
3a109ff70d54444825b603625652f5ae6fb1c350c87c2a82af5e262f69ea4f1e,1698284413000000,"""bc1q57f2avul6sng79pfl2thpqy7j4ahxxr9gzahw33nm5xcsu0sprwq6c8gxm"""
5186db462e823094ed0a15eba35f51687bef87af8b935b15d4799887083a5e72,1701168861000000,"""17yC4yR2x7RhkJ8W54D9gf1ejRbTS5rPhs"""
be179cc9143d5648b63dffaf1290ebc433c6cc27a3bc9cc1b442883b2e929d6a,1713975639000000,"""nonstandard9011dfc0598e3e31ef3452bb1245e95dda5948df"""
2c3d33c77a2c2e0fa5cd0daf99bcb47ecfc3392ecd82471a890808a9496784ce,1699664031000000,"""bc1p0sj2yx4q6d7r3ktn8g7gkxsed5eh4xqdn0mvk6zk8we77pehqlsq0gad8q"""
0ae51fb8766e5b3e490058b83ab8260e85dd04f833fe42be7b03c8a5c00499d1,1699772035000000,"""bc1p7u6mkw4ylv5uf5lp6k9hp76g6qn5c9a8qfq0kjnru5f6ffl6gt3qcwmytc"""
e9d80ab17e5f21edf5d685665bc3cc9878ae651bc559b6c3021c78b7302e206f,1723964659000000,"""nonstandard9eaeee16710719dc940121f0ca3d9b2ee637ead2"""
1265989fe2c755b9dd88ba001e04d9c06adbbfe8ae5658e9fa6295e2e32fbc7f,1712691753000000,"""bc1p35zmhdaudfnn44phu6h6pyu6e2wxwyjyv9pn3uaj48e8j6ep3rrqaeqlhp"""
fd3d7b07fa9bc423e9afffaf2cb2a2d0dac91785e4e5c984915faffb68080a43,1724223418000000,"""bc1pjjcjhe6rqqcjhj44rnas5gk420temzgl2z6ahhqmc70y8gy4e4fs5z9tur"""
3ecfc45022667b735f3f538c3f165f2fe5f24284c8137785792d4c5d9a9f0793,1714354550000000,"""nonstandard88cad0de6411d5787e2c2b6686d83fa280f37471"""
82a6ab7db0bc90ed915f0645ab555359b4c5e648a61d6d85d7ff77162f7134c3,1704688954000000,"""bc1qqde9rwk49zj55vqzd3jlvx4rl4qs3frxu6c656"""
c1a762221b376d226074a5f96ae1470cdd81c4ad9a4fc6367c6b475f22269222,1725161188000000,"""bc1qclyfsxuu8vcwq38yygs5zrskwacq8sjlyvk9mx"""
b83dc77b2e73d13973bc722d53f4f61bd92e2f30e3daa278fc59a4c792249360,1690783493000000,"""bc1qqfmuxy0268ltk9pls4kgupassextnretavagtt"""
e0c9c2fb776bc5cb6992978cb91cc00cb1a00c85555c422f1ee7f16c44456091,1688989478000000,"""bc1phg076wsv4ku0d7hzv8vde6ule820u9xcesr6slxhxeafg7g0p05s9ejqe6"""
0ef7e32a54f78475dbe33345bcdbb6d70fe30e4cf386ba5fe99354b17249ce83,1706830140000000,"""bc1q2c0tw55x57rzvt3ygzcgxu4gr0mzrztyjss8lk"""
bc521ad218bca6ea68436a0a7048fd97efc35d9225ef961df308f0d8bbbd4a31,1727114783000000,"""bc1pr3r3fdsfdw8yws2erh9g9lxke5fp6dyn4569gjwa7w9vnhlj7k2quv4wma"""
5d6ec060c98e2cb071b847444878fb79936dd73da3424f34a095616fb13f0a68,1688213098000000,"""3K794ADWfqxDu9jrrZvXdqnPN3seMkuDdd"""
ab20f018bf436b7dfabdb01ca0b217a849163b3ca9b1c7a7a6b6186cc513f5f5,1727035218000000,"""nonstandard9eaeee16710719dc940121f0ca3d9b2ee637ead2"""
779f572a4bb6ab351a4f7ae7349009a7bd5e32bcabfc03aab7272ec151153254,1727170631000000,"""bc1qx0ffq97ta93te9k8dyy0kct95q2ax0ygp0lmvn"""
f4c468b6b818957d2763d554590240b32d037bf058a4516a2cdbb443a808bbec,1727339368000000,"""nonstandardb530d86240943a23e8c52285cc23ca3aece4ff0a"""
769244a0c6c57a96e08900c18c4e06c7454409774a08857a50cb9ff5a2bd40a1,1691333748000000,"""bc1qeq8lc7n3l6ux7jf00a9vh67lqakaygy4yhgkx2ccgvt3ma3pmy0q06773l"""
a92a930ad11111240335a53934963c12dba5cb55143cbbccb06869bdc1c73add,1691486783000000,"""bc1pwwc99tus6d8tfudm9w3rdxrfu3l8rsyl33vdv3ulrlwxts7gtg0sp5xuck"""
6c45b30f7fcbbf945e4b1e832eb0321348b2a6c9d4475e7dd8e2460ce293a637,1708819644000000,"""bc1q5l68aycgt3ezh6jql45tjx47n6swe3f0e7xtae"""
033cc6a9fafb5012dd7eba590d906c283ad42a50228f1296d87957b827a82d43,1719206665000000,"""bc1qrnehfure686kvruku4ztjmjjjhs4ga88r56tya"""
c246da90f74c7806fd04a1d027cd120c6a767fed025cd32787566d0bbe559781,1691873550000000,"""bc1qg2mgat8egjsmhy50mvq982etk66n4980x3x3yz"""
d02f0e93d494021e99ef14e7047f2dbb0807a603c0e0779c0d8562978c7e1192,1721841481000000,"""bc1qk39dqwgnujeesy2kpke3ezl5caxw6rxjanzmw2"""
7678543f645e5d3615654195a8d9bdc3524d5e7b32778e50279137cb0740d076,1722232898000000,"""bc1qn763hmj7jt0dj9nlc8z02ty79huhapsn644gj0"""
69c7c31e8b89ac9092064eb01625fffd797cf5a844ceff5ab1476a7283befe35,1703502548000000,"""bc1pqmurp9x2fkt6l8fa73rptt93wap8wjckk3kksvhmh3jnq2j7jqusq66ql3"""
332f2f257339e62d429eee23bfe7124b4ba94251020fba98742ad353c462781a,1702290676000000,"""bc1pwtwuq0pw7xd0kuskt98d5wsvgqt3w94rvplnkx8cmvhfuwm2lfhsrggwr7"""
9beeb697e6630fea122905173a88aece79aee55150dee6724c5d84a519ea9990,1716605229000000,"""nonstandard19cb4b0188bbda184f58a5558070c369386371ae"""
c108ba751c9559b77c0827dedbecb25e920c7ea0d23e1316e27163a0abafaf43,1695620516000000,"""3A99Qr15FyEQCBfR8DH6sZsYLW6RvjBDQN"""
effa68dfcba0c6d3b2af031a81b861a7211c420709cc8ee523a4f0c2c602bab0,1727918051000000,"""nonstandard9eaeee16710719dc940121f0ca3d9b2ee637ead2"""
efada07dcddde9783407775ab5daf63baace25eb567bc51c8c25bb23f17fee50,1694081728000000,"""bc1q5pwj86d30kvly7tqun7alpzlfgm6mlge29

2025-01-26 01:27:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:25 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:26 - root - INFO - SQL:
SELECT i."transaction_hash", i."block_timestamp", a.value AS "address"
FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i,
     LATERAL FLATTEN(input => i."addresses") a
WHERE TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
LIMIT 100
Results:
Too long, hard cut:
transaction_hash,block_timestamp,address
e8f2aca2426a31e150cb7b2060f675e51a1f85198470ef35cc3014598f7e007c,1711663248000000,"""bc1qnsupj8eqya02nm8v6tmk93zslu2e2z8chlmcej"""
c4b01b659a3cb5e411a22a8bf7a1ec2cefa2a1b4739162d884d40eedbbdb9967,1693985754000000,"""bc1qql7zxnjt8tyyhv84ny3r5dfmya525v8rcl2wjhyrhwpjhn7pzussaeemjl"""
c3c6971bb956bc749544e655f2e0069bdeb9c73a2263ccea556ce1a4fabf3bb9,1710869343000000,"""bc1qlsnx3nhylmzqusn5m6kk5edpfla3tmzwhp29hx"""
d03fcc4455a8220b4bb9886646889a7f1981321c994e1dfc454e65f0e358c077,1699207030000000,"""bc1p9vplmxyxxc364jg4dedc7u6w55ff8lxm5r2fau2s45u5z4mjutsqsgwz7x"""
1966737f76788e3d606d5513f0d1f02bdaa3867952d00c4d99e39f354e4b9eb1,1703806461000000,"""bc1p382u66uvz2q7zt0qt0t9fhglzqdqfmtzmdqavpqt4pd74smhty9slhmuxv"""
6deac6851275f1d9a73f423d42f207aac21fb885e2414417e0687d1683f8c9b5,1715510251000000,"""bc1pxle75huhwje6te3aeyu65kv64h8s9al8dfpr9yuzqw3qwlpkzk4q7s3gzh"""
ed463425f2f9adff8d1e852998b84644f45aa9f87f9b03fe072214683febec37,1715773727000000,"""1CjvtkXyX1R939NsLb1PVu23PQFAQTdT9G"""
f76651dcc4074944e514e48abbd659ea0c5524b4ecec858b09ac184dd45675f4,1717026095000000,"""bc1plef3rq5wx4mx299ldexvdz73hs55lgee47pp3st8uef07u0eydcs70g6l3"""
0c45623a61d5abc14d9546919dc64e4e2ca42217daf2a8b6f3e95d31ed4b2112,1719775498000000,"""bc1qhsvrmsg7g45y6h7jjppe6pxvj5t8fesysdyueh"""
825a14afe3ce2eaafae40842ef2f6cbcb5fc5da6d3a7b1e157a5bdf9034d66d2,1692504897000000,"""bc1pwwc99tus6d8tfudm9w3rdxrfu3l8rsyl33vdv3ulrlwxts7gtg0sp5xuck"""
d4a79d359fbad78c9c4ec1a11a25d96f221ee051022cd8dd401558a4b0c4a367,1706573692000000,"""3Cw9rJQrrzZV2bHSnBP8kUoSwFUykt6ikA"""
f1b5f26fca8a893e0bf05474b4582605c7c610a78c8b61a3410abc14cf54182d,1724640100000000,"""bc1q72ymkjyt3sjwp0ftjuwtf0y0mftezt70ardd3m"""
62388347b1d4702822e7d4fb51b38fbcac43ab8778af9c054e40411e838bc0bb,1705703780000000,"""bc1pvnhy22yuk6kzlqylpcyqcd67wfhxqpz4w6mmf3t4yxqggrpaxrdq24qnz7"""
23f612360682cd8a8fe75b9018ef6d060c2dadc05bedad9e570e49c3141b8245,1707458467000000,"""bc1q2n2xahs5qa8h27qxxsqplafmrppeewe9f6ny2p"""
75a5486a8231ffd915b29425ff4b534499efddcad3a93ed229e0e35ff1c6ce48,1726621567000000,"""1FHRNPdv4Xv8fTBohJzg6pTwsNjsYc11dG"""
274dbfbd787229b61ff39543ae5b5b868a8c5344ae58c7a72be97b515a249dac,1708763636000000,"""bc1p9xxkwj6mq5sj5g3ggmcu9744sk5saw5lm5e9yzev7rnltk26dstshsvudk"""
47a61aa27a6d200a318e4590215552fc50135f99e6486f516e57eda8558183eb,1696786907000000,"""bc1qvhahl0yhsne0ypkfxdhje6c050sjfsyefavhlz"""
1ba5ce4b65cef0b2f0a85be4dd4b62ffcdd184dccadfe268b3caab47145f9d85,1697208680000000,"""bc1qt5m8xeclsja4lkfvl2nvmrt6z9vg60sd8w2kc6"""
b65016c5b47f4c709428aeb57620073df1d07fa4c7d0e94033114dbe9888c1f7,1700923134000000,"""1ETJcPaEuvuLsUHsQCsrWp88Q6PM3nJ7ZJ"""
51fa1a67c6cb6931145ff986eabef7ceacb6e53f6b7f78a9eece29554b9b0d02,1694180284000000,"""3MdZQGpfF8VJCe22EtjtVdiBq5QgueNK12"""
508f4dcf425eb89be45b568ae981ef4bee34793f9ff1f3e85d29ca40a02d2bc0,1712817632000000,"""bc1q997fx6smmqjn8xe7a8feku9ywdn2jtv25vmuaf"""
ef3563dfe081bc039ec0f4e6daea95e87dd780cc1cd615a4da33d0566d85f77a,1715501758000000,"""bc1pxrax79f0d4nj2maq5h57ghqp8ra8wkjhak7gxajm9ukhzxy9r9js4h7vvx"""
81ea29aefbdb61ae8329425aa95a5097d0b148e45fa0d2c24104e4e072ec308b,1717167435000000,"""bc1p8xaz6x9a44ffp2akd7y58g9aqkd3keg3vyrra5dk9f23wcdtdj7qfgrz9t"""
bb3c84b95da3060c740006a0f5fd3488a0b571f7eb4d1c9b9a220a2dbe2e2cd6,1720935154000000,"""bc1qcmnatkm5xnsa02stjyu8mn6fwluc0chnzc2r5v"""
3e034e2e08c36c61d8f47f20c8d275ed0a40fba6690a00c90d251aabbea806ab,1691460762000000,"""31iMVm3vyA9ZYWxJ4QERDVB7FkVC7F4Nvv"""
b437c3dccf4142aa1e51803a4d7f71092b237009ff59716a71609980a9f9a704,1692756204000000,"""bc1qywuwmz0uqlh3000hwe5dc2muk8gtktuyzzgzkt"""
1ed40824bb6244a6f0c57d71230c1940e305c063bae2b3c668cd086fc225448a,1723161684000000,"""bc1p07dh8pw9wutdd34vn7hwuee9gnhhx6mexz4fuqldmcwtauf3cvfse5g6lh"""
34da26b523bfe19ce4a07abcdf071762ecfaf1f4fd177b2c32c8e61f613c7f44,1690698115000000,"""1DvH2qCsshQ6byddP1J7RZR5mTR2RDztVc"""
f192b865883e57afdb00d1c21b0df54f0301bb036289c6d4af36f00e3af6f356,1707318139000000,"""bc1pgrxgquxdz6hl5am25gwrzthuddapy3l6g7pu2qcc4e4unktfvxqq7yvmy3"""
acb48b117b52eda0ace3739133864449c0209ea52b1c48580beb49c313e27f17,1706820992000000,"""bc1qw8wrek2m7nlqldll66ajnwr9mh64syvkt67zlu"""
08f4673dcd0dde120d7ef5f50ecf1770fbf128bb1c7d6d6b390d634e6753d791,1726847981000000,"""3EgqeXeL7KnWC7ALh4JLwcT1w4WGvEQEmc"""
2945539d669f28d283a50a6c00a675469b15ff4aedc39598950c22996afcd5e4,1688543814000000,"""bc1q7n9vufgkwnwjm4z54xxruc4s3606jyr56ctmtn"""
5ff9b970dc5b999027418f0a88674e3bb7b03519f90eaacec315478ce5f0b5fe,1708674313000000,"""bc1q6m68lxgplsm8xnhnqwhn3zlh4987ph55uw69t5"""
0554c18245a3c5fa669b64b54acf3ae9352605e44852476b8c22879984f3f6d4,1689968814000000,"""bc1qttwe4pflk6qu6qs5qu3tdj983dhx3jm7sgvlza"""
1bd494491a1c6590e7b6c273907c05169c4a0b3d6ef74fe318013d5b203ca67f,1727142547000000,"""bc1pv25udu0ldx925l3sfwdxvaljwtfq3u4qvy4fvuq3dus5gen2chksctesev"""
1b306ecd46bcf81c6926a2178e79b3743f6b6a11c5f4e836b624acd21bfd5a61,1727002550000000,"""bc1qtq9zgpaqvq0lysuflytxd8n6ne9p7qphuqndpe479k27nwm88kjs68zrm5"""
9e44f3dd2d279314a0287269b78

2025-01-26 01:27:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:27 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:28 - root - INFO - SQL:
SELECT o."value", COUNT(*) AS "number_of_outputs"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
GROUP BY o."value"
ORDER BY "number_of_outputs" DESC
LIMIT 100
Results:
value,number_of_outputs
0E-9,65908
546.000000000,44709
330.000000000,17089
294.000000000,16299
600.000000000,11473
1000.000000000,2664
1200.000000000,2397
10000.000000000,1851
100000.000000000,1719
20000.000000000,1205
1000000.000000000,809
300.000000000,803
796.000000000,716
4999.000000000,716
295.000000000,649
5000.000000000,605
200000.000000000,603
50000.000000000,570
333.000000000,563
5000000.000000000,554
420.000000000,508
547.000000000,476
10000000.000000000,464
30000.000000000,426
9999.000000000,394
500000.000000000,370
1127.000000000,359
2000000.000000000,324
1300.000000000,301
1120.000000000,295
500.000000000,288
579.000000000,287
3000.000000000,270
300000.000000000,269
4000.000000000,265
150000.000000000,255
40000.000000000,253
2000.000000000,251
20000000.000000000,247
50000000.000000000,245
888.000000000,241
15000.000000000,234
60000.000000000,231
100000000.000000000,221
2097152.000000000,217
801.000000000,211
354294.000000000,208
1128.000000000,205
400000.000000000,201
1062882.000000000,193
531441.000000000,187
6000.000000000,186
790.000000000,183
580.000000000,182
80000.000000000,182
1155.000000000,181
331.000000000,180
120000.000000000,180
1135.000000000,175
262144.000000000,175
7000.000000000,172
555.000000000,171
1162.000000000,168
8000.000000000,167
1122.000000000,166
600000.000000000,165
1150.000000000,164
1800.000000000,163
3000000.000000000,158
1130.000000000,156
1140.000000000,156
1170.000000000,155
1125.000000000,155
1168.000000000,154
1173.000000000,151
18000.000000000,151
1164.000000000,151
3188646.000000000,151
200000000.000000000,147
999.000000000,144
250000.000000000,143
1159.000000000,142
65536.000000000,141
70000.000000000,139
1142.000000000,139
1163.000000000,138
39366.000000000,137
1174.000000000,134
13000.000000000,133
1166.000000000,131
540.000000000,131
90000.000000000,129
110000.000000000,129
1153.000000000,126
130000.000000000,126
1500000.000000000,125
1624.000000000,125
8192.000000000,124
1134.000000000,123
16384.000000000,123

2025-01-26 01:27:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 16
2025-01-26 01:27:29 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:30 - root - INFO - SQL:
SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000)) AS "month",
       COUNT(*) AS "total_inputs"
FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i
WHERE TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000))
ORDER BY "month"
LIMIT 100
Results:
month,total_inputs
2023-07-01,30923
2023-08-01,30778
2023-09-01,30624
2023-10-01,35552
2023-11-01,29602
2023-12-01,30178
2024-01-01,30845
2024-02-01,29024
2024-03-01,31907
2024-04-01,29342
2024-05-01,33393
2024-06-01,31518
2024-07-01,37083
2024-08-01,34272
2024-09-01,32857
2024-10-01,7649

2025-01-26 01:27:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:31 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:31 - root - INFO - SQL:
SELECT o."transaction_hash", COUNT(DISTINCT a.value) AS "unique_addresses"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
     LATERAL FLATTEN(input => o."addresses") a
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
GROUP BY o."transaction_hash"
HAVING COUNT(DISTINCT a.value) > 5
LIMIT 100
Results:
Too long, hard cut:
transaction_hash,unique_addresses
40f0d67fa64f0335bbfcddbd9639852116abeca6a29f391fe154b992a6415528,6
ae71dcee2e4a570214f94cbe5155c055f7904053ea3abec30d4c808e84fb51f9,7
57f3d7e7ee3fec7f22edbdd851fdc4ba0bd88bc47dde5ee633caa65d68d9c51a,7
fce665171e1a99e5d1d7e6b5889bb196ac6b810f14a62cd79bd1ad730e6d8a64,7
8c405da57585b6571fb2963cb03ac2996fff593469289915e37a3c19f311f2cd,7
c9e6342824702f54f8fc7aedc115e85814689027171e5b44105d922fa5be1455,8
95d17bfb458cebfd5f176523e68d1cc2749d3794819e89805e148ebba4634301,6
8a4d0ec4c82856c1d7b086f389d55d8e5710a3a6f4f6bd769ccbf735bca71ed5,7
088869503df90841c88c83b34f7e1757c9c909530e6f8208e2f06fb43b7a02d4,6
2a3048b4c07380106c5adb48cb970570a0936cef0d6018da4a0086632d6f570f,7
116a5a2d8acbbcccf607e142dd158b74fa5609354c315b520ed39f55c52b5743,6
bb133f9eac7545946ef635f2afc5b5b13c49c70ef704bdc151d3df79a3093151,6
612d82869cf581b979e2ef9338379b1fe93a15cfa014716822fc0b831ccef951,6
21c7ff7c0c23a29bbb79f59918b42b067fe039553d78a450882b4b836bdbd7be,6
04e3bb21f0a3b28a8a87d7e3eac198e23920f296b2e1e29da69fc9c78df88f57,8
6ba93300c0f16ae032787c75f00bc5e0fbb0da2c3f6a89d65afb06839d9c46ee,6
7f5b78bcd97a3d0562c7e55a20d8e594c787c7abc83d9463614f50c5b22474cb,7
86cda71023cdebe1b8b3bab35928bad41e9913f6766b62be4ec903872a4e159f,6
d7e5b4ce4ef1a72bf012cadd0212fd996b5da5a5db4e3ec4d9cd93b7e56b6095,7
f13ea6725837135b86dfd6513b9bf5d7f6cc3e5a41bee1bfffef9ede4deb2428,8
8b2d48262a58d833a141c89cf72b736ce70d4f345859ed0e38a22b01bda48306,6
8e9e9d98474d49975462f011ea0b072a99d99ffa2224390abd8d173aaaab840e,7
0f8599a424a20b360e207cb97942876b05026417c36554f7ed1078461c71aa5a,6
7d97fe343fe44382c96339c4d960407727417223c337b00a41ff8e4726eca501,6
d885eab9f8ffd2573003e555884ba8eb2d524757ecea9c1af2c9d0fc387b513f,6
b9a69eb843461095dd8be2a74eed9664855a970bf1aa53dd1af25928b9ec5f1f,6
a7fa41709268493427df383cd56adc4d573b3d3c2e2e7479e6e5a107756d9742,6
25ce171a2d545961c0508dbe9929ccd7bb652ae6a641828c6d4c122955f75e78,7
618ea1ca9423b72cc0cdd6d93686ba0ac9156a9ab477647d1b95d17269f460d4,7
c8f8994d01fa6d090273b1868cac756d5263ed09e4cc9305c89d71bcd738d710,6
4edcb885f854f253d3fcdb40c96a172a843a627d94fded7bdca6861561047ebd,7
79b774a9425df770067b43d3158a69c0cfe3bdf3d80e0f8764919d943399254d,6
cdf96f3473a106bc29ef0d0cf63e080d47f4a47265e809f2d897b83533ed751b,6
e92e31245d90288ddb02b29284ebc016c85602684b2f225a417be7f7e8410fd7,6
120a3c1963c9b8275f2c66481c762984b67f8fc4fbc0d2cf40c485dd36d96fe4,6
3657da56c3cc2dc09d6ac4d98c1565ed50da45b18d3fd55c3e64b9f67cc52308,7
bbd86034103e647d26de6673e519ae3e84e79e804ff028dfc739ca1afcbf87c4,7
8ffaa98c590eb6e8fc21610c29edc30b414fc6b11435cf70cf19572291faea54,7
270e6984db298cba635c721fa446186b69d960d997511732bf39c780de28004b,8
eb2986f80c70cfaafb1c48716be30b1de08093cb2478ba549f53392e3a60b594,6
d4a13d85d2fafd446d9c7e4c07ebd8e9c5b08335285703065e514cf6f45767d0,6
b0bf6bb93158cc0714cbb34e197bf8936d258c3b9809b7f60d22785adb7cc58f,8
022fd00d0b45bd7d102017d3ee5c15ea7fe5a80a37a81fe992b2428876d0344b,9
b490fa5bea588e027c469b40c97846e7e9e6ffabeb579b9a514ec6a413515668,6
c7f86fb7b830124057475b282809f3474ef3565daa3de0b599980fb9e84ab019,7
49b15e1db620b6dea1db6766479ffcc84d6614ba3fe9687df7f37e7f7607f5fe,8
54834a16b2d7a84f977ab79470279afc57fb813141398845f968d9bb78644a43,6
84b81f25f0adb54442d432910823f15fc60d67a4ac1508bbb4f31c6e56aa4659,6
caab6f74e9741f48f4d6f4aadaef456b2b87648a68d8dfc8f9a77922e078371d,6
e6c8f4674ba07f6920a3240769346f70efcf68d55c9d73e606229d74414f5920,6
b395584b66fe00a83e5d85d4e25f5a2f16963b4e812d4539ef4b5071529880a5,6
6b2a72b6938313f0cb1a0276df788a0987671ea4551b7fb82c3e8b1bdc1abf2a,6
c9df45fa79e91d6c97b0ef0b77be2146c14d571a7f93adbfc7ea5399cdd5f16e,7
01683fc36c1a6b45d66b67d82bfa4c0ff719194090e60dbaf7fb597ad2a62705,6
7ba166bf1e6469a9ccd5b14b73e811a814c1c755ded22604ab3c71f082ac8a6b,6
f1270612c971485f4e3971920a3e635eff2ef4fc3d6ba70e6a00287415366a31,6
08c1e5111c887728e6908724e12fdc29c81083bd3551266b2a761c92c62f6a86,9
8cf72f8b899657879d47abfd288df1ab5fca5c50e11e3de021ef997f83f3bb7f,7
047fb0d0805d50ccb8bb3d95f0da5174e23f4a38f83a7d29a19a4077aea980e1,6
0721ed2e507a46530a8e332e8ff1a3c2912adefae903c647bba0ace89eeba42c,6
202a3280cd5ec1cacfbfa6d4bb370feca9d77baf80dcab967b58bd02b442382f,6
96dbf4c4e03d12d822d832c526e27b8c9359bb460b798c918007d194843b5f90,7
30eebbe549c4f31ec3cf8a1963a3236006b7c7173b36990d22d0832917b5b070,6
b103f5544401ae193c94c3d473d1d22924b04f0605ba77877282c6d925b625c0,6
d33a47709d3264184aa2018d56ead486bfe4b98e5527e978777c50d717a178f1,6
6226d602fa7fd882d1f150b588b3a8e17c5b087087a5f24e8bfe059c52c9853c,6
5a645fb3fd8cfe50ef2314b0df6dd97ace49779d207c9166d05a77f692d326f8,6
c2e113bbcf8e21ffd771f0f6d970fd879051a802321bf0a616cadba813c7acf5,6
f1cfa5f57c6d231d829e7f725fe08a64d1751f522a03c64f76e6cd86c423c390,6
ec72fcf1bba142af3bfa15a7ce898817542ca5b8d5546b01d869151ac793420a,6
d27e3a392417a61f24cbdedba63b078f2be402b6038a4b9af82a65a0c0ac6c69,6
1baf945d2f6f039138100669283a44d9ba379f9222e4ecc687e25d2ea32cb327,6
555b874da99e16ccd2dc400ea8239334499ee20cb9ccad935c3df5c222f9f80d,6
309e1e8283493653ff637e05b3a8a4fcf821180e6d09e731c17567d8348d421d,6
e31a40f4

2025-01-26 01:27:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:27:33 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:33 - root - INFO - SQL:
SELECT "block_timestamp_month", SUM("input_value") AS "total_input_value"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100
Results:
block_timestamp_month,total_input_value
2023-09-01,7295284812063.000000000
2023-10-01,6913060383233.000000000

2025-01-26 01:27:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:35 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:35 - root - INFO - SQL:
SELECT "hash", "block_timestamp_month", "input_count", "output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "input_count" = "output_count"
     AND "input_count" > 1
   LIMIT 100
Results:
Too long, hard cut:
hash,block_timestamp_month,input_count,output_count
cb803aa1c598989f41e74775da9a1d77dba6bd773b2173b97b093d26cf237d5b,2023-09-01,2,2
867ef9c3f5588b8ea836d1ac89fa53f0b9e9e302fccb5a06a39ce5f23052e549,2023-10-01,2,2
7398112761788d28db60051fbd11804910413a7ea64a5d24f857ea341563f725,2023-10-01,2,2
aaac30a3c6fa5e8215acdece4d4a30e15d578fa6a75168c8cc20a61a0653cb54,2023-10-01,2,2
b356eab004943940f98118a4c3483869d71513356984a09a40e88b4aa2428d8b,2023-10-01,2,2
cf5105f43d2fb1c4b7f28085fd89c8db7946ead1b3799ccbacd6916dd6b34c4b,2023-10-01,2,2
1d966c68b0f540d165cead61e2760399c19198d6af14c89d2b9d3d32d43b80fd,2023-10-01,2,2
7ac188866d0148936b24060ef2ec73b9229b8cfc24973ee28fdb27465095db53,2023-10-01,2,2
9ee846302ab4a113f463163998cfd4dcad672e994543b9fcf2b4d61a1846a02c,2023-10-01,2,2
344be5155220e9ceb2258c78b9bda50a5ecb636df7fe59ee6310b659b79e8a2d,2023-10-01,2,2
a063a6d4a75d8c1cc4827792c4b01ef1c296a6feefdd2f7ee9b163956a78cf97,2023-10-01,2,2
3828e2e685d055eb322c1342998fd26b58980fb75545be3fa053d4c3a12eaa6c,2023-10-01,2,2
18058b96fc83285b05b34ab59d8d66aa1daed9640d1fe848160da26220cc475a,2023-10-01,2,2
522a7c8dc4ca3a08d05098ca0236cae9894d136cef5809df0e1ad70eaf9ca53b,2023-10-01,2,2
3b6b0b6c60e587a1d46633c7b113b2c5f66d92855c005defc405960f2b1894f3,2023-10-01,2,2
832430c8cb657508d5fec809d2b0cb1fcfffc7165efc6151c51155b66d211444,2023-10-01,2,2
0f72cd000041d15c9a410b4ef9e4b3b507bff68991d9334143cc353129bf3824,2023-10-01,2,2
2f6c1939233d56a962734a605b925c87afac82d2b6bb2b2800a99431080b07d1,2023-10-01,2,2
474408f4bea61543ef286fb4570de8648fca958f8032cc5c65d37e217498e0fb,2023-10-01,2,2
99d339624e97c5f00efdd45195afb5fe4e858817915cee4e8605e4e790236cbe,2023-10-01,2,2
9859476ea247148f415c3eb8f3cf8399a9a785a5f9264c8084b90352c317285f,2023-10-01,2,2
72a9b309479877bce35b43e626578a44538596920a09c93eb1d7e5da569bd89a,2023-09-01,2,2
af0591320481535f0cc4de17e4c75dd527e7f4b7d4c6aaf13ef417b70d808f9b,2023-09-01,2,2
d12da92425007cb03a406b51c74a8e5a7c48aacce61e2510f93b5d33ff0ed15d,2023-09-01,2,2
8d821e205400c908041c6ac843b606a43fbe67035213f48945415ba7d078f56c,2023-09-01,2,2
b1359feb67309837e73851787d3f82e3ad348d985990b7cc70377a4c130e0096,2023-09-01,2,2
0bbd341124616794034f0d40051852c5375d89ab029885119d853c26eb2421b7,2023-09-01,2,2
d2198e9e796682beb4727913037dc906d7d5ce2082aaf0096d09f8c36c7f5dde,2023-09-01,2,2
58cf22886b6397a58e0fe6abe85e0a70adbd460df0a0b6ebaaf6cd212c94d843,2023-09-01,2,2
8404eaa377413d952898fb7f08d759a686eaba3381c1dd48564e32ca98f1868c,2023-09-01,2,2
61d264a70d151ba7db3c562399a43a4f0a72c48458a09ca7f0179b1b23753756,2023-09-01,2,2
80e20045fb2e3472b84ae86bb2f201bbc4d93492f98c6796f13d6abd9cc3537c,2023-09-01,2,2
3947cdfe7afeee3f7e0a61e3da5061a9b476500c6b85606a7194a57c794ca58f,2023-09-01,2,2
e814950bce8655050d08c90bec7a05308779778171fa475981a62a177beb9ec1,2023-09-01,2,2
7e61c786160242d400b338df9ddd3a22a4b787c0b4eb861ece491e3a3318fe4d,2023-09-01,2,2
d8de4956ae0b71107a0a2a288e79616b1baf0bec727cb276d5314b30e02a9fc4,2023-09-01,2,2
a53c2bb03a7f9d546e4459a8745ddcab62ef853c6bc863fd5751ca0e740f0144,2023-09-01,2,2
4b3b89af38063aec9beca98a094e9926d7c0a37e0d7586a8def90624b733e9d0,2023-09-01,2,2
fb2edd310c8e715084b33ac1ca51fb5b7dfb65e21d7936315ae8081015ae1ed5,2023-10-01,2,2
6567b8e7b4ed5e58b020ba13c5dc27856f7ea57fec537a0ed026e5a68bd88608,2023-10-01,2,2
9a3b66da30870b98f666fcf4dbed61d129a67808ac1deeade38470238938093c,2023-10-01,2,2
e1cfb8a1dc1dcd3cc1564aece27e892b3633de3493fa046f560377541ceb19db,2023-10-01,2,2
9edee90c49c16e0fc2f1aac3abc0889a148f8b8753943f50365e1213934284ef,2023-10-01,2,2
77b13921dcf281b4fc8fde80255d82d779a7645db80e5fad761d58118b9575f0,2023-10-01,2,2
7494f719385fea022f9a443d8e82de6fe10a27ffde4d60b16b3fda551a2b8927,2023-10-01,2,2
10881c20727dbbf6ae95503348b7a7627b22113f5c2dbf2b616f701aa7300ade,2023-10-01,2,2
b2d8f420d5a6955b371724511b164632b52ed6f9789554131c29a8a7dc0743b9,2023-10-01,2,2
1827a7720e0a620b8941cae0db71748e329fb111d1e7885f08e2ebdccbcd46c1,2023-10-01,2,2
c40fea3f8587b78b7e624affd717931924a374ea0828ed46de70069eb179487a,2023-10-01,2,2
fef88267e54bc80af90354b3bc4954706a529604c669309543de674ee3a5b555,2023-10-01,2,2
a317c46e7c120196781e4e7dfd2f6f22b662f3eb8eff247925776138c6290216,2023-10-01,2,2
61e1072a748bfbcb24194c90a1f1967f296a8be7f3c7e5c34b172ea803f308b5,2023-10-01,2,2
dc449cb48460f896fd65c9ec0034d402f6d5531762a2fa9989eb431677d0013d,2023-10-01,2,2
e260716622ff9466979fea0b3a8cf402065b60d23742149d4098cf3f22126b0c,2023-10-01,2,2
44c105999521445fa7c713f756b9074beb68fb2cb6e344dfc59e3cbc82f5ff88,2023-10-01,2,2
10bae0d53c8bfd3522d31a3c79f20f63afe55d8b4e49105287dab08151c76760,2023-10-01,2,2
1e81a805a1ef7422983d5bf8b3cf40500320d3059b25d55d1a93997b88c7227b,2023-10-01,2,2
8df22d9d6e4ecd33e612fe34f08203f327522bdbd5a3faae205892259a81d863,2023-10-01,2,2
84d23c2cde873387e1d042920e02d01f96c5bef65c9ea86f6548f108cd9f9fe4,2023-10-01,2,2
534a4dccd8b7e991f24135c9b736485e7213d65387fef893ee8e3d186861fb50,2023-10-01,2,2
4da846e112b40b729df5754b0ac2053bad3a30ccc3360c06d0ba73d659665a1b,2023-10-01,3,3
a35f834e2bead1cdc07f4a2d51d1522a780ec5b7ff9a769acaba615b4b3a8bfb,202

2025-01-26 01:27:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:36 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:37 - root - INFO - SQL:
SELECT "hash", "block_timestamp_month", "fee"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "fee" > 0.001
   ORDER BY "fee" DESC
   LIMIT 100
Results:
Too long, hard cut:
hash,block_timestamp_month,fee
0cdefc039f264fe9aed0808486f4933d3fbeb80ff0ff1aa6ba2d5a32e0431b20,2023-09-01,2391998.000000000
c745c42377f09907af2132b4c97a1574b71c3ffe611f5445df2833b0d178df08,2023-09-01,2391998.000000000
5d21e5b8866481d2a5effc4c0d9ef27243e3b6a3d2feb0d02b4aa3c7dd07f1a2,2023-09-01,1879324.000000000
d2e0057f12a1b5533e37a22199461bbe70f0f9c40586d05d21a0c1cfdc0a4c27,2023-09-01,1765700.000000000
b18358385e13b6234bdab341d8c08887a028cde63b02f8525cbbba0a4729c827,2023-09-01,1749990.000000000
9185cf697fe295db7fa9093a4aa3eb920c310b934a1ff4cd85807e21bc89fbeb,2023-09-01,1646153.000000000
9cc9907409c1b05d1116eeadf205e31cdbbbc00c509eaebb81c389762bfe4523,2023-09-01,1644600.000000000
8f55d2e572f7537a82da04f6e4e653941a7e75364c13e02141dc9cc29c13ebc2,2023-09-01,1606785.000000000
1f3ea6e88b6b9914f76286a30dd18478fa507ae0b5b560f0f6b45447a92fe588,2023-09-01,1598089.000000000
40255dc487de043267239c07c214498db067624868a31434b5df773ed05facc9,2023-09-01,1488158.000000000
14ad53ae455da46a59db1c59e753a4619f5dc985f98c3f059b7c537ef1cef54f,2023-09-01,1394251.000000000
3eb492680c174b244faf5f08ff09acd3660afd91c10f5f6337a4c36efc8770fc,2023-10-01,1368136.000000000
cb715454174ef0b7f6e5c503c1d17a513933e2eed70a12e1d63806aa83f8932c,2023-10-01,1361920.000000000
f4c3b0e07481108ab3852352c464dc2c73733f063afb4044d5e6068559906282,2023-10-01,1359848.000000000
e1a3508489c2f3f923c151be0c28a965ee44cf38ecc93e4164adf0f609ce886f,2023-10-01,1351560.000000000
a23f04e17e21e757b1d6477ff8b81b97dbfddc6952e0d72d13d9b2f6c63c2ded,2023-10-01,1351560.000000000
1503ac9564b0665886e2b31954d162ec5abbe8d10f6bdcac9de499cf2c0c5c38,2023-10-01,1349488.000000000
b21552d0a32196b48419343dc9f6be2b88cf6e227e5370ed8c4e5dcc78fb707a,2023-10-01,1347416.000000000
c7eb11fb4255894396868e51e1585066e5c285d99c9949fc96e4e1edb341b2fa,2023-10-01,1347416.000000000
6175500c92c347780ebac8586fe2ae357e6209f8bd3d7289575000e31460c09b,2023-10-01,1328768.000000000
0071703ca909aab4678704c86de5ae2507745d36c4bc3becf68099ed6160cfef,2023-09-01,1305463.000000000
92e534eb80a92249650ae497b477f9196ed3e81daadced4d7def98a7588870f9,2023-09-01,1214100.000000000
2aa3ba2177c17d22bbf6e20344a2da79fa90b7bc3da0224eb83a16f8b19fc96d,2023-09-01,1206642.000000000
cd91ac62d9daf12dc915844e04bd660899769420332891f818fea1e9e72dada9,2023-10-01,1205913.000000000
38498eae52c575e78ab754a5dd23a9fa6d0d52fbd0bbab2ef205b9ccfa75dee4,2023-09-01,1144110.000000000
efe1ea2d296352cad149c287da628733fcf29b9cb9192578f0f76c7d1dd1831f,2023-10-01,1065498.000000000
115b345dfe278b831a83fabe08583d3d7c04cd88c0caff91efc19cac8fc2b70c,2023-09-01,1045900.000000000
63b8363fd0c08c44c7cac089bbc047d824f1d41b686f9d9aff5f3abab4fc61da,2023-09-01,1017233.000000000
b1af44e81e87a55b323232ee9bbcfa7334bfe68505ed953645c11535c22e36c6,2023-09-01,992400.000000000
861926a31a2b321847d00d80b0290d0d4e9cc14893764bee38b326774af1d8a5,2023-09-01,991990.000000000
7835d3d478ec9429c0ea6ff3f05c767495f964b400321a554f3bb32383b53988,2023-10-01,984888.000000000
8bbb1dd6fbcc8c27bd691a034b97312baa4b40eb00442690602784a501634da1,2023-09-01,983400.000000000
f7c56101ba4b19b9b493a96d928af75d0e2e893f3bdd7eaf8a8ecc71b5396915,2023-09-01,977604.000000000
54fb635d39841877caabcfe93bc20ce2adca77eef893e6389df614378dff6309,2023-09-01,962485.000000000
d83051a35a0518b8e3c610648734b2492de80ce955578d8fccdd2caee26a2273,2023-09-01,948926.000000000
cb928fbbe46f7239665dee615bd7156fd9537abb9d576e827e31303a78d87b66,2023-09-01,929916.000000000
525e9b762dcc9c8a60de97063994ac0555aa6997ec23283901edc2bb4569dc38,2023-09-01,922635.000000000
104f1c9e7c18b49521df5e65afe232e8e4c3fb5ff27621d308765630f3c3325a,2023-09-01,911025.000000000
1a36e006085fefc5989ae4e479ce39dbf8229b352029bdb20c5f9e16bdefc3d3,2023-10-01,910445.000000000
e61962b57f83227c0927c8687f2568aac343f5a882b3300054147c05b34a3be9,2023-10-01,885144.000000000
7c94399d419f5b9dec3db3b6abd04fd87e5e4ce536a95178d93a7a6b9229e005,2023-09-01,881640.000000000
10fb48f4403e4019812272565cbf50256b1ef5911adbfc64641370ac8fa2df16,2023-09-01,853342.000000000
56be541675da4ded970749bc62d314dec39b757460d6e0d48dc679e10071839f,2023-10-01,851100.000000000
8a1e2d9033a759babac786f867172fa2e0bd4c79293a778c9803ae92ef79f26f,2023-10-01,851100.000000000
4cce01b1d87af12fe0be7dd2987056487569881acc131e8eb9ee532faca533df,2023-10-01,851100.000000000
58377946a75a9ddc869f42b997683cb7079b33a1ea447cd9125bba4a79ca13de,2023-10-01,851100.000000000
2a92edbe84aa28dc41b212680e273ac50e8c75e2c7c82fde8c2b451524684653,2023-10-01,851100.000000000
641360b1325636d951956d2b11c46e0faa364afac5cb5992ed5a6d640a689d0d,2023-09-01,784720.000000000
fcff284c6374f8efc37325ba7d66c4b3aa5c4edcadb9a6ee2679b9dc336317d0,2023-09-01,758801.000000000
8f2491225be0c8ce365136e8e4091e750bc4d163812a8600526bfe3ffa5028c4,2023-09-01,726867.000000000
c79d5e1c4625d5f12e50c09a0fc8574f6d48f547d270f692065da786bd902d7e,2023-09-01,720573.000000000
9eeb3278267e0afda400175ee7e8f99b9cb8eb7df130b14e688825279257a475,2023-09-01,715320.000000000
2052c7d57fcfc653294a3bfd318afe5462a1f32cc3d151d0503265a392944628,2023-09-01,687036.000000000
2fd7c1484599

2025-01-26 01:27:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:27:38 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:39 - root - INFO - SQL:
SELECT "block_timestamp_month", AVG("fee") AS "average_fee"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100
Results:
block_timestamp_month,average_fee
2023-09-01,9705.750327318267
2023-10-01,7012.582988690847

2025-01-26 01:27:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:27:40 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:40 - root - INFO - SQL:
SELECT t."hash", t."block_timestamp_month"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
   WHERE t."block_timestamp_month" >= '2023-07-01'
     AND t."input_value" = t."output_value"
   LIMIT 100
Results:
hash,block_timestamp_month
39cb49a47a2f2d2e9987c8c4aa0d6927fd3c748873cec47bc79294cfdac20204,2023-09-01
4ecfc5fd0e22e39007232b6ec875fcc39d930148032c3409b94dc7008e810890,2023-10-01

2025-01-26 01:27:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:27:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:27:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:27:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 01:27:42 - snowflake.connector.connection - INFO - closed
2025-01-26 01:27:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:27:42 - root - INFO - SQL:
SELECT "hash", "block_timestamp_month", "input_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   ORDER BY "input_count" DESC
   LIMIT 100
Results:
Too long, hard cut:
hash,block_timestamp_month,input_count
d59f3bc4fd605cd58b0386165863d2f1bc22c9126e937bf64de87db6ae6ccb2e,2023-10-01,1428
b66bd61c4924114cc90df69760bf9a4a634109a1dd42c5b87d670395e481e568,2023-10-01,1331
296bb9904f7ea772387a7c9402c809b824413b9236265ea5f3b3678dea81e48c,2023-10-01,1020
9336803419a5eb0249585d3036f1e1c32cae5119514f965d4b11923fdc877e78,2023-09-01,1000
4a96ea2ff8cc55fa1a024fc2cbd140b9dcbdd3ff53445644b8bed26c245cca79,2023-10-01,824
6edcf8f1830920bb06a0dfbfc614da6ce4de4dfe79ae6a5285609bcdd3a6fc82,2023-10-01,824
7835d3d478ec9429c0ea6ff3f05c767495f964b400321a554f3bb32383b53988,2023-10-01,802
efe1ea2d296352cad149c287da628733fcf29b9cb9192578f0f76c7d1dd1831f,2023-10-01,745
10fb48f4403e4019812272565cbf50256b1ef5911adbfc64641370ac8fa2df16,2023-09-01,669
3eb492680c174b244faf5f08ff09acd3660afd91c10f5f6337a4c36efc8770fc,2023-10-01,660
cb715454174ef0b7f6e5c503c1d17a513933e2eed70a12e1d63806aa83f8932c,2023-10-01,657
f4c3b0e07481108ab3852352c464dc2c73733f063afb4044d5e6068559906282,2023-10-01,656
e1a3508489c2f3f923c151be0c28a965ee44cf38ecc93e4164adf0f609ce886f,2023-10-01,652
a23f04e17e21e757b1d6477ff8b81b97dbfddc6952e0d72d13d9b2f6c63c2ded,2023-10-01,652
1503ac9564b0665886e2b31954d162ec5abbe8d10f6bdcac9de499cf2c0c5c38,2023-10-01,651
1f3ea6e88b6b9914f76286a30dd18478fa507ae0b5b560f0f6b45447a92fe588,2023-09-01,651
b21552d0a32196b48419343dc9f6be2b88cf6e227e5370ed8c4e5dcc78fb707a,2023-10-01,650
c7eb11fb4255894396868e51e1585066e5c285d99c9949fc96e4e1edb341b2fa,2023-10-01,650
6175500c92c347780ebac8586fe2ae357e6209f8bd3d7289575000e31460c09b,2023-10-01,641
0d0e0d2c6cba8455185078fe45320b07a925729c6d22bd9201941818f39a806f,2023-09-01,600
2fd7c1484599fbd4ad2e399daba6e1ac589fd3aa6c34d36974e5719be8277f02,2023-09-01,600
ab88fe06bc447d1f20171fd07a8ad4ad40e8b07dc9836019aca8d60db393ad35,2023-09-01,600
4cabc3c15c7f71bf5d80262973ab58fc146fa213b700eb045c2b05957a35dad8,2023-09-01,600
eb6f7482080a65cc765b06a72cebbffcb745c1648f3c76501d1c48b88fa69798,2023-09-01,600
044e6108066b97db7c1fcb158ac8cc634ed65d9774b3abce1dc755dd007b9fde,2023-09-01,600
a1765a52a98bcd58e0d168a101bd632b8a7e56d7a1ea36f2bb56d5de5d331186,2023-09-01,600
cd91ac62d9daf12dc915844e04bd660899769420332891f818fea1e9e72dada9,2023-10-01,600
6910753d5ddebc26dfa932660e0dd2d975c64d4b4011ea9c009a59744a11d7f1,2023-09-01,600
0e5cb9c6339b41236c8d144bca3bd8ef7bdf2cf5b8db424f30fa5f9ad557c6cd,2023-09-01,575
38498eae52c575e78ab754a5dd23a9fa6d0d52fbd0bbab2ef205b9ccfa75dee4,2023-09-01,518
14ad53ae455da46a59db1c59e753a4619f5dc985f98c3f059b7c537ef1cef54f,2023-09-01,504
121b4233bf332f28ba313ed7a1a94a175743119ed3dfdcfc98ad7f907f462634,2023-10-01,500
1dc90e19f3b1e7aa2510a52dc35e2e8ac23dbaa2cf7d191788030a1fdf1eb5e8,2023-10-01,500
58377946a75a9ddc869f42b997683cb7079b33a1ea447cd9125bba4a79ca13de,2023-10-01,500
49a98ad8a684a91e77cd5d37a2097357b6b9f16b0b626fcdbb1a3fd51df8d3f4,2023-10-01,500
1a36e006085fefc5989ae4e479ce39dbf8229b352029bdb20c5f9e16bdefc3d3,2023-10-01,500
96a42e16c42053753e2c6300a39d71eb98bb80c798a58d57b7ec565afd292311,2023-10-01,500
e61962b57f83227c0927c8687f2568aac343f5a882b3300054147c05b34a3be9,2023-10-01,500
68655a5f7035f1637ce5939a72d859a26f2d129c4bfc1d75b958b5028f76999d,2023-10-01,500
f85c87413ebb37082845fe65b319971aee11e45cc78c691c8ab40061bc313c21,2023-10-01,500
d0fce73d1a775fce3e3242543b91dedb4b40134d4e9ddd238e59793cddb3a545,2023-10-01,500
a40a4e71acb498e9bc89959dc345ad8c0ed6d024679beff3f60f8e645106c71f,2023-10-01,500
c0ecb4cf9ae9ee185765191ea4d831abafffbad80df4499ab0a2fe1a6b23f927,2023-10-01,500
8d01ef95cde4991c796c583c2e88fe4414691fa57cfc0faabc72a28c12dfb3e9,2023-10-01,500
8a1e2d9033a759babac786f867172fa2e0bd4c79293a778c9803ae92ef79f26f,2023-10-01,500
54fb635d39841877caabcfe93bc20ce2adca77eef893e6389df614378dff6309,2023-09-01,500
4cce01b1d87af12fe0be7dd2987056487569881acc131e8eb9ee532faca533df,2023-10-01,500
dd3678253a799f396e182f0b7122aa784b16a60dbc6306dc9a790c9786515db3,2023-10-01,500
2a92edbe84aa28dc41b212680e273ac50e8c75e2c7c82fde8c2b451524684653,2023-10-01,500
56be541675da4ded970749bc62d314dec39b757460d6e0d48dc679e10071839f,2023-10-01,500
a61e3a2f9e1e681c7aa9fd332e08682fd1cd3eee9bd5980902ba3f472b5410d3,2023-10-01,500
5c2ba606d0b2be7d146df9469bbc08b7023fe60f14ac4bbb6271f52e9c42f0e0,2023-10-01,500
6eda39cef63ef9debfdc698da0214e23347ebc8522f3994eb94a1d561d615cd7,2023-10-01,500
155bfdc0ad27330f55ac067d81385bf550b0a9cbf6e4ebde85632cd519b6b574,2023-10-01,500
f86ac4ba55193f8ca0cb103f9d43ca28ea345552a39903e9789bc4248466848b,2023-10-01,500
40255dc487de043267239c07c214498db067624868a31434b5df773ed05facc9,2023-09-01,490
7953a95aac3be12b5635e8ab17c9d352310e03c0ca97a936711fc21a5bcc17fb,2023-10-01,420
6c3e1b952b4b2f73ec583e7c9a8648360dbf0ff29def2f339a2329296ae239a0,2023-10-01,413
f7c56101ba4b19b9b493a96d928af75d0e2e893f3bdd7eaf8a8ecc71b5396915,2023-09-01,350
cb928fbbe46f7239665dee615bd7156fd9537abb9d576e827e31303a78d87b66,2023-09-01,350
9eeb3278267e0afda400175ee7e8f99b9cb8eb7df130b14e688825279257a475,2023-09-01,350
9a9f9f43d9e7e49f2939f65a8d76ec85ea791b74690ab2300a6d41b2e4a26aa4,2023-10-01,3

2025-01-26 01:27:42 - root - INFO - itercount: 0
2025-01-26 01:27:42 - root - INFO - Database Name: CRYPTO
Schema Name: CRYPTO_BAND
DDL describes table information.
,0
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""proposer_address"" VARCHAR(16777216),
	""last_commit_hash"" VARCHAR(16777216),
	""data_hash"" VARCHAR(16777216),
	""validators_hash"" VARCHAR(16777216),
	""next_validators_hash"" VARCHAR(16777216),
	""consensus_hash"" VARCHAR(16777216),
	""app_hash"" VARCHAR(16777216),
	""last_results_hash"" VARCHAR(16777216),
	""evidence_hash"" VARCHAR(16777216),
	""signatures"" VARIANT
);"

,1
table_name,ORACLE_REQUESTS
description,
DDL,"create or replace TABLE ORACLE_REQUESTS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""oracle_request_id"" NUMBER(38,0),
	""request"" VARIANT,
	""reports"" VARIANT,
	""result"" VARIANT,
	""decoded_result"" VARIANT,
	""oracle_script"" VARIANT
);"

,2
table_name,ERRORS
description,
DDL,"create or replace TABLE ERRORS (
	""tableRow"" VARCHAR(16777216),
	""errors"" VARCHAR(16777216)
);"

,3
table_name,LOGS
description,
DDL,"create or replace TABLE LOGS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_truncated"" NUMBER(38,0),
	""txhash"" VARCHAR(16777216),
	""log_index"" NUMBER(38,0),
	""msg_index"" NUMBER(38,0),
	""log"" VARCHAR(16777216),
	""events"" VARIANT
);"

,4
table_name,MESSAGES
description,
DDL,"create or replace TABLE MESSAGES (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""txhash"" VARCHAR(16777216),
	""message_type"" VARCHAR(16777216),
	""oracle_Activate"" VARIANT,
	""oracle_AddReporter"" VARIANT,
	""oracle_CreateDataSource"" VARIANT,
	""oracle_CreateOracleScript"" VARIANT,
	""oracle_EditDataSource"" VARIANT,
	""oracle_EditOracleScript"" VARIANT,
	""oracle_Report"" VARIANT,
	""oracle_Request"" VARIANT,
	""cosmos_sdk_MsgDelegate"" VARIANT,
	""cosmos_sdk_MsgEditValidator"" VARIANT,
	""cosmos_sdk_MsgMultiSend"" VARIANT,
	""cosmos_sdk_MsgSend"" VARIANT,
	""oracle_RemoveReporter"" VARIANT,
	""cosmos_sdk_MsgBeginRedelegate"" VARIANT,
	""cosmos_sdk_MsgCreateValidator"" VARIANT,
	""cosmos_sdk_MsgDeposit"" VARIANT,
	""cosmos_sdk_MsgFundCommunityPool"" VARIANT,
	""cosmos_sdk_MsgModifyWithdrawAddress"" VARIANT,
	""cosmos_sdk_MsgSubmitEvidence"" VARIANT,
	""cosmos_sdk_MsgSubmitProposal"" VARIANT,
	""cosmos_sdk_MsgUndelegate"" VARIANT,
	""cosmos_sdk_MsgUnjail"" VARIANT,
	""cosmos_sdk_MsgVerifyInvariant"" VARIANT,
	""cosmos_sdk_MsgVote"" VARIANT,
	""cosmos_sdk_MsgWithdrawDelegationReward"" VARIANT,
	""cosmos_sdk_MsgWithdrawValidatorCommission"" VARIANT
);"

,5
table_name,BLOCK_EVENTS
description,
DDL,"create or replace TABLE BLOCK_EVENTS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""event_type"" VARCHAR(16777216),
	""block_event_type"" VARCHAR(16777216),
	""attributes"" VARIANT
);"

,6
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""txhash"" VARCHAR(16777216),
	""transaction_type"" VARCHAR(16777216),
	""gas_wanted"" NUMBER(38,9),
	""gas_used"" NUMBER(38,9),
	""sender"" VARCHAR(16777216),
	""fee"" VARIANT,
	""memo"" VARCHAR(16777216)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_BITCOIN
DDL describes table information.
,0
table_name,OUTPUTS
description,
DDL,"create or replace TABLE OUTPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,1
table_name,INPUTS
description,
DDL,"create or replace TABLE INPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""spent_transaction_hash"" VARCHAR(16777216),
	""spent_output_index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,2
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""stripped_size"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""merkle_root"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""timestamp_month"" DATE,
	""nonce"" VARCHAR(16777216),
	""bits"" VARCHAR(16777216),
	""coinbase_param"" VARCHAR(16777216),
	""transaction_count"" NUMBER(38,0)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""virtual_size"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""lock_time"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_month"" DATE,
	""input_count"" NUMBER(38,0),
	""output_count"" NUMBER(38,0),
	""input_value"" NUMBER(38,9),
	""output_value"" NUMBER(38,9),
	""is_coinbase"" BOOLEAN,
	""fee"" NUMBER(38,9),
	""inputs"" VARIANT,
	""outputs"" VARIANT
);"

Database Name: CRYPTO
Schema Name: CRYPTO_BITCOIN_CASH
DDL describes table information.
,0
table_name,OUTPUTS
description,
DDL,"create or replace TABLE OUTPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,1
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""stripped_size"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""merkle_root"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""timestamp_month"" DATE,
	""nonce"" VARCHAR(16777216),
	""bits"" VARCHAR(16777216),
	""coinbase_param"" VARCHAR(16777216),
	""transaction_count"" NUMBER(38,0)
);"

,2
table_name,INPUTS
description,
DDL,"create or replace TABLE INPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""spent_transaction_hash"" VARCHAR(16777216),
	""spent_output_index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""virtual_size"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""lock_time"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_month"" DATE,
	""input_count"" NUMBER(38,0),
	""output_count"" NUMBER(38,0),
	""input_value"" NUMBER(38,9),
	""output_value"" NUMBER(38,9),
	""is_coinbase"" BOOLEAN,
	""fee"" NUMBER(38,9),
	""inputs"" VARIANT,
	""outputs"" VARIANT
);"

Database Name: CRYPTO
Schema Name: CRYPTO_DASH
DDL describes table information.
,0
table_name,INPUTS
description,
DDL,"create or replace TABLE INPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""spent_transaction_hash"" VARCHAR(16777216),
	""spent_output_index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,1
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""virtual_size"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""lock_time"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_month"" DATE,
	""input_count"" NUMBER(38,0),
	""output_count"" NUMBER(38,0),
	""input_value"" NUMBER(38,9),
	""output_value"" NUMBER(38,9),
	""is_coinbase"" BOOLEAN,
	""fee"" NUMBER(38,9),
	""inputs"" VARIANT,
	""outputs"" VARIANT
);"

,2
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""stripped_size"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""merkle_root"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""timestamp_month"" DATE,
	""nonce"" VARCHAR(16777216),
	""bits"" VARCHAR(16777216),
	""coinbase_param"" VARCHAR(16777216),
	""transaction_count"" NUMBER(38,0)
);"

,3
table_name,OUTPUTS
description,
DDL,"create or replace TABLE OUTPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_ETHEREUM
DDL describes table information.
,0
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""timestamp"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""hash"" VARCHAR(16777216),
	""parent_hash"" VARCHAR(16777216),
	""nonce"" VARCHAR(16777216),
	""sha3_uncles"" VARCHAR(16777216),
	""logs_bloom"" VARCHAR(16777216),
	""transactions_root"" VARCHAR(16777216),
	""state_root"" VARCHAR(16777216),
	""receipts_root"" VARCHAR(16777216),
	""miner"" VARCHAR(16777216),
	""difficulty"" NUMBER(38,9),
	""total_difficulty"" NUMBER(38,9),
	""size"" NUMBER(38,0),
	""extra_data"" VARCHAR(16777216),
	""gas_limit"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""transaction_count"" NUMBER(38,0),
	""base_fee_per_gas"" NUMBER(38,0),
	""withdrawals_root"" VARCHAR(16777216),
	""withdrawals"" VARIANT,
	""blob_gas_used"" NUMBER(38,0),
	""excess_blob_gas"" NUMBER(38,0)
);"

,1
table_name,LOGS
description,
DDL,"create or replace TABLE LOGS (
	""log_index"" NUMBER(38,0),
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""address"" VARCHAR(16777216),
	""data"" VARCHAR(16777216),
	""topics"" VARIANT,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,2
table_name,TRACES
description,
DDL,"create or replace TABLE TRACES (
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""input"" VARCHAR(16777216),
	""output"" VARCHAR(16777216),
	""trace_type"" VARCHAR(16777216),
	""call_type"" VARCHAR(16777216),
	""reward_type"" VARCHAR(16777216),
	""gas"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""subtraces"" NUMBER(38,0),
	""trace_address"" VARCHAR(16777216),
	""error"" VARCHAR(16777216),
	""status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""trace_id"" VARCHAR(16777216)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""nonce"" NUMBER(38,0),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""gas"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""input"" VARCHAR(16777216),
	""receipt_cumulative_gas_used"" NUMBER(38,0),
	""receipt_gas_used"" NUMBER(38,0),
	""receipt_contract_address"" VARCHAR(16777216),
	""receipt_root"" VARCHAR(16777216),
	""receipt_status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""max_fee_per_gas"" NUMBER(38,0),
	""max_priority_fee_per_gas"" NUMBER(38,0),
	""transaction_type"" NUMBER(38,0),
	""receipt_effective_gas_price"" NUMBER(38,0),
	""max_fee_per_blob_gas"" NUMBER(38,0),
	""blob_versioned_hashes"" VARIANT,
	""receipt_blob_gas_price"" NUMBER(38,0),
	""receipt_blob_gas_used"" NUMBER(38,0)
);"

,4
table_name,CONTRACTS
description,
DDL,"create or replace TABLE CONTRACTS (
	""address"" VARCHAR(16777216),
	""bytecode"" VARCHAR(16777216),
	""function_sighashes"" VARIANT,
	""is_erc20"" BOOLEAN,
	""is_erc721"" BOOLEAN,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,5
table_name,TOKEN_TRANSFERS
description,
DDL,"create or replace TABLE TOKEN_TRANSFERS (
	""token_address"" VARCHAR(16777216),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" VARCHAR(16777216),
	""transaction_hash"" VARCHAR(16777216),
	""log_index"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_ETHEREUM_CLASSIC
DDL describes table information.
,0
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""timestamp"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""hash"" VARCHAR(16777216),
	""parent_hash"" VARCHAR(16777216),
	""nonce"" VARCHAR(16777216),
	""sha3_uncles"" VARCHAR(16777216),
	""logs_bloom"" VARCHAR(16777216),
	""transactions_root"" VARCHAR(16777216),
	""state_root"" VARCHAR(16777216),
	""receipts_root"" VARCHAR(16777216),
	""miner"" VARCHAR(16777216),
	""difficulty"" NUMBER(38,9),
	""total_difficulty"" NUMBER(38,9),
	""size"" NUMBER(38,0),
	""extra_data"" VARCHAR(16777216),
	""gas_limit"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""transaction_count"" NUMBER(38,0)
);"

,1
table_name,CONTRACTS
description,
DDL,"create or replace TABLE CONTRACTS (
	""address"" VARCHAR(16777216),
	""bytecode"" VARCHAR(16777216),
	""function_sighashes"" VARIANT,
	""is_erc20"" BOOLEAN,
	""is_erc721"" BOOLEAN,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,2
table_name,TRACES
description,
DDL,"create or replace TABLE TRACES (
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""input"" VARCHAR(16777216),
	""output"" VARCHAR(16777216),
	""trace_type"" VARCHAR(16777216),
	""call_type"" VARCHAR(16777216),
	""reward_type"" VARCHAR(16777216),
	""gas"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""subtraces"" NUMBER(38,0),
	""trace_address"" VARCHAR(16777216),
	""error"" VARCHAR(16777216),
	""status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""trace_id"" VARCHAR(16777216)
);"

,3
table_name,TOKENS
description,
DDL,"create or replace TABLE TOKENS (
	""address"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""decimals"" VARCHAR(16777216),
	""total_supply"" VARCHAR(16777216),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,4
table_name,TOKEN_TRANSFERS
description,
DDL,"create or replace TABLE TOKEN_TRANSFERS (
	""token_address"" VARCHAR(16777216),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" VARCHAR(16777216),
	""transaction_hash"" VARCHAR(16777216),
	""log_index"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,5
table_name,BALANCES
description,
DDL,"create or replace TABLE BALANCES (
	""address"" VARCHAR(16777216),
	""eth_balance"" NUMBER(38,9)
);"

,6
table_name,LOGS
description,
DDL,"create or replace TABLE LOGS (
	""log_index"" NUMBER(38,0),
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""address"" VARCHAR(16777216),
	""data"" VARCHAR(16777216),
	""topics"" VARIANT,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,7
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""nonce"" NUMBER(38,0),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""gas"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""input"" VARCHAR(16777216),
	""receipt_cumulative_gas_used"" NUMBER(38,0),
	""receipt_gas_used"" NUMBER(38,0),
	""receipt_contract_address"" VARCHAR(16777216),
	""receipt_root"" VARCHAR(16777216),
	""receipt_status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_ZILLIQA
DDL describes table information.
,0
table_name,EVENT_LOGS
description,
DDL,"create or replace TABLE EVENT_LOGS (
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""transaction_id"" VARCHAR(16777216),
	""index"" NUMBER(38,0),
	""address"" VARCHAR(16777216),
	""event_name"" VARCHAR(16777216),
	""params"" VARIANT
);"

,1
table_name,TX_BLOCKS
description,
DDL,"create or replace TABLE TX_BLOCKS (
	""number"" NUMBER(38,0),
	""ds_block_number"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""gas_limit"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""mb_info_hash"" VARCHAR(16777216),
	""tx_leader_pub_key"" VARCHAR(16777216),
	""tx_leader_address"" VARCHAR(16777216),
	""num_micro_blocks"" NUMBER(38,0),
	""num_transactions"" NUMBER(38,0),
	""num_present_transactions"" NUMBER(38,0),
	""prev_block_hash"" VARCHAR(16777216),
	""rewards"" NUMBER(38,0),
	""state_delta_hash"" VARCHAR(16777216),
	""state_root_hash"" VARCHAR(16777216),
	""header_signature"" BINARY(8388608)
);"

,2
table_name,EXCEPTIONS
description,
DDL,"create or replace TABLE EXCEPTIONS (
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""transaction_id"" VARCHAR(16777216),
	""index"" NUMBER(38,0),
	""line"" NUMBER(38,0),
	""message"" VARCHAR(16777216)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""id"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""amount"" NUMBER(38,9),
	""code"" VARCHAR(16777216),
	""data"" VARCHAR(16777216),
	""gas_limit"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""sender_pub_key"" VARCHAR(16777216),
	""sender"" VARCHAR(16777216),
	""signature"" BINARY(8388608),
	""to_addr"" VARCHAR(16777216),
	""version"" NUMBER(38,0),
	""accepted"" BOOLEAN,
	""success"" BOOLEAN,
	""cumulative_gas"" NUMBER(38,0),
	""epoch_num"" NUMBER(38,0)
);"

,4
table_name,TRANSITIONS
description,
DDL,"create or replace TABLE TRANSITIONS (
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""transaction_id"" VARCHAR(16777216),
	""index"" NUMBER(38,0),
	""accepted"" BOOLEAN,
	""addr"" VARCHAR(16777216),
	""depth"" NUMBER(38,0),
	""amount"" NUMBER(38,9),
	""recipient"" VARCHAR(16777216),
	""tag"" VARCHAR(16777216),
	""params"" VARIANT
);"

,5
table_name,DS_BLOCKS
description,
DDL,"create or replace TABLE DS_BLOCKS (
	""number"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0),
	""difficulty"" NUMBER(38,0),
	""difficulty_ds"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""ds_leader_pub_key"" VARCHAR(16777216),
	""ds_leader_address"" VARCHAR(16777216),
	""prev_hash"" VARCHAR(16777216),
	""signature"" BINARY(8388608)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CRYPTO': {'CRYPTO_BAND': ['BLOCKS', 'BLOCK_EVENTS', 'ERRORS', 'LOGS', 'MESSAGES', 'ORACLE_REQUESTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN_CASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_DASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM': ['BLOCKS', 'CONTRACTS', 'LOGS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM_CLASSIC': ['BALANCES', 'BLOCKS', 'CONTRACTS', 'LOGS', 'TOKENS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ZILLIQA': ['DS_BLOCKS', 'EVENT_LOGS', 'EXCEPTIONS', 'TRANSACTIONS', 'TRANSITIONS', 'TX_BLOCKS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table**: `"CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"`
   - **"block_timestamp_month"**: Used to aggregate transactions on a monthly basis.
   - **"hash"**: Unique identifier for each transaction.
   - **"input_count"**: Number of inputs in a transaction; higher counts may indicate CoinJoin transactions.
   - **"output_count"**: Number of outputs in a transaction; higher counts may indicate CoinJoin transactions.
   - **"input_value"**: Total value of inputs in a transaction.
   - **"output_value"**: Total value of outputs in a transaction.
   - **"inputs"**: VARIANT column containing details of inputs.
   - **"outputs"**: VARIANT column containing details of outputs.

2. **Table**: `"CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS"`
   - **"transaction_hash"**: Links outputs to their transactions.
   - **"block_timestamp"**: Timestamp for filtering outputs by date.
   - **"value"**: Value of each output; equal values across outputs may indicate CoinJoin transactions.
   - **"addresses"**: VARIANT column containing output addresses.

3. **Table**: `"CRYPTO"."CRYPTO_BITCOIN"."INPUTS"`
   - **"transaction_hash"**: Links inputs to their transactions.
   - **"block_timestamp"**: Timestamp for filtering inputs by date.
   - **"value"**: Value of each input.
   - **"addresses"**: VARIANT column containing input addresses.

**SQL Queries:**

1. **Total Number of Transactions Per Month Since July 1, 2023:**

   ```sql
   SELECT "block_timestamp_month", COUNT(*) AS "total_transactions"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
   ```

2. **Distribution of Transaction Input Counts Per Month:**

   ```sql
   SELECT "block_timestamp_month", "input_count", COUNT(*) AS "transaction_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month", "input_count"
   ORDER BY "block_timestamp_month", "input_count"
   LIMIT 100;
   ```

3. **Distribution of Transaction Output Counts Per Month:**

   ```sql
   SELECT "block_timestamp_month", "output_count", COUNT(*) AS "transaction_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month", "output_count"
   ORDER BY "block_timestamp_month", "output_count"
   LIMIT 100;
   ```

4. **Transactions with High Input and Output Counts (Potential CoinJoin Transactions):**

   ```sql
   SELECT "hash", "block_timestamp_month", "input_count", "output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "input_count" >= 5
     AND "output_count" >= 5
   LIMIT 100;
   ```

5. **Average Input and Output Counts Per Month:**

   ```sql
   SELECT "block_timestamp_month",
          AVG("input_count") AS "average_input_count",
          AVG("output_count") AS "average_output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
   ```

6. **Total Transaction Volume Per Month:**

   ```sql
   SELECT "block_timestamp_month", SUM("output_value") AS "total_volume"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
   ```

7. **Transactions Where All Outputs Have Equal Values (Potential CoinJoin Transactions):**

   ```sql
   SELECT o."transaction_hash",
          COUNT(*) AS "output_count",
          MIN(o."value") AS "min_value",
          MAX(o."value") AS "max_value"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE o."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
   GROUP BY o."transaction_hash"
   HAVING COUNT(*) > 1 AND MIN(o."value") = MAX(o."value")
   LIMIT 100;
   ```

8. **Total Number of Outputs Per Month:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP(o."block_timestamp" / 1000)) AS "month",
          COUNT(*) AS "total_outputs"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE o."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP(o."block_timestamp" / 1000))
   ORDER BY "month"
   LIMIT 100;
   ```

9. **Most Common Output Values Per Month:**

   ```sql
   SELECT DATE_TRUNC('month', TO_TIMESTAMP(o."block_timestamp" / 1000)) AS "month",
          o."value", COUNT(*) AS "occurrences"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE o."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP(o."block_timestamp" / 1000)), o."value"
   ORDER BY "month", "occurrences" DESC
   LIMIT 100;
   ```

10. **Extract Addresses from Outputs Since July 1, 2023:**

    ```sql
    SELECT o."transaction_hash", o."block_timestamp", a.value AS "address"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
         LATERAL FLATTEN(input => o."addresses") a
    WHERE o."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
    LIMIT 100;
    ```

11. **Extract Addresses from Inputs Since July 1, 2023:**

    ```sql
    SELECT i."transaction_hash", i."block_timestamp", a.value AS "address"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i,
         LATERAL FLATTEN(input => i."addresses") a
    WHERE i."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
    LIMIT 100;
    ```

12. **Aggregate Total Input Value Per Month:**

    ```sql
    SELECT "block_timestamp_month", SUM("input_value") AS "total_input_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
    WHERE "block_timestamp_month" >= '2023-07-01'
    GROUP BY "block_timestamp_month"
    ORDER BY "block_timestamp_month"
    LIMIT 100;
    ```

13. **Identify Transactions with Equal Input and Output Counts:**

    ```sql
    SELECT "hash", "block_timestamp_month", "input_count", "output_count"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
    WHERE "block_timestamp_month" >= '2023-07-01'
      AND "input_count" = "output_count"
      AND "input_count" > 1
    LIMIT 100;
    ```

14. **Distribution of Output Values in Transactions Since July 1, 2023:**

    ```sql
    SELECT o."value", COUNT(*) AS "number_of_outputs"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
    WHERE o."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
    GROUP BY o."value"
    ORDER BY "number_of_outputs" DESC
    LIMIT 100;
    ```

15. **Transactions with High Fee (Potential Anonymity Set Transactions):**

    ```sql
    SELECT "hash", "block_timestamp_month", "fee"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
    WHERE "block_timestamp_month" >= '2023-07-01'
      AND "fee" > 0.001
    ORDER BY "fee" DESC
    LIMIT 100;
    ```

16. **Total Number of Inputs Per Month:**

    ```sql
    SELECT DATE_TRUNC('month', TO_TIMESTAMP(i."block_timestamp" / 1000)) AS "month",
           COUNT(*) AS "total_inputs"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i
    WHERE i."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
    GROUP BY DATE_TRUNC('month', TO_TIMESTAMP(i."block_timestamp" / 1000))
    ORDER BY "month"
    LIMIT 100;
    ```

17. **Average Transaction Fee Per Month:**

    ```sql
    SELECT "block_timestamp_month", AVG("fee") AS "average_fee"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
    WHERE "block_timestamp_month" >= '2023-07-01'
    GROUP BY "block_timestamp_month"
    ORDER BY "block_timestamp_month"
    LIMIT 100;
    ```

18. **Transactions with Outputs to More Than Five Different Addresses:**

    ```sql
    SELECT o."transaction_hash", COUNT(DISTINCT a.value) AS "unique_addresses"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
         LATERAL FLATTEN(input => o."addresses") a
    WHERE o."block_timestamp" >= UNIX_TIMESTAMP('2023-07-01') * 1000
    GROUP BY o."transaction_hash"
    HAVING COUNT(DISTINCT a.value) > 5
    LIMIT 100;
    ```

19. **Transactions with Equal Input and Output Values:**

    ```sql
    SELECT t."hash", t."block_timestamp_month"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
      AND t."input_value" = t."output_value"
    LIMIT 100;
    ```

20. **Transactions with High Number of Inputs (Top 100):**

    ```sql
    SELECT "hash", "block_timestamp_month", "input_count"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
    WHERE "block_timestamp_month" >= '2023-07-01'
    ORDER BY "input_count" DESC
    LIMIT 100;
    ```

These queries are designed to explore the Bitcoin transaction data, focusing on characteristics that may indicate potential CoinJoin transactions, such as high input and output counts, equal output values, and transactions where inputs and outputs have matching values. The queries also aggregate data monthly since July 1, 2023, to align with the task's requirements.Query:
SELECT "block_timestamp_month", COUNT(*) AS "total_transactions"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
Answer:
block_timestamp_month,total_transactions
2023-09-01,35134
2023-10-01,27323
Query:
SELECT "block_timestamp_month", "input_count", COUNT(*) AS "transaction_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month", "input_count"
   ORDER BY "block_timestamp_month", "input_count"
   LIMIT 100;
Answer:
block_timestamp_month,input_count,transaction_count
2023-09-01,0,16
2023-09-01,1,30045
2023-09-01,2,2576
2023-09-01,3,806
2023-09-01,4,407
2023-09-01,5,289
2023-09-01,6,187
2023-09-01,7,128
2023-09-01,8,64
2023-09-01,9,49
2023-09-01,10,62
2023-09-01,11,34
2023-09-01,12,25
2023-09-01,13,23
2023-09-01,14,17
2023-09-01,15,13
2023-09-01,16,11
2023-09-01,17,10
2023-09-01,18,10
2023-09-01,19,13
2023-09-01,20,10
2023-09-01,21,7
2023-09-01,22,6
2023-09-01,23,12
2023-09-01,24,4
2023-09-01,25,38
2023-09-01,26,6
2023-09-01,27,3
2023-09-01,28,5
2023-09-01,29,2
2023-09-01,30,3
2023-09-01,31,3
2023-09-01,32,6
2023-09-01,33,6
2023-09-01,34,5
2023-09-01,35,6
2023-09-01,36,4
2023-09-01,37,1
2023-09-01,39,2
2023-09-01,40,2
2023-09-01,42,2
2023-09-01,43,1
2023-09-01,44,2
2023-09-01,45,1
2023-09-01,46,1
2023-09-01,47,1
2023-09-01,48,2
2023-09-01,49,3
2023-09-01,50,3
2023-09-01,51,2
2023-09-01,52,1
2023-09-01,53,2
2023-09-01,54,2
2023-09-01,55,4
2023-09-01,56,1
2023-09-01,57,1
2023-09-01,58,2
2023-09-01,59,1
2023-09-01,60,51
2023-09-01,61,6
2023-09-01,62,1
2023-09-01,63,1
2023-09-01,65,2
2023-09-01,66,1
2023-09-01,67,3
2023-09-01,69,1
2023-09-01,70,1
2023-09-01,73,2
2023-09-01,74,2
2023-09-01,75,1
2023-09-01,77,1
2023-09-01,80,3
2023-09-01,81,2
2023-09-01,82,2
2023-09-01,83,1
2023-09-01,84,1
2023-09-01,86,1
2023-09-01,90,2
2023-09-01,91,1
2023-09-01,92,1
2023-09-01,93,1
2023-09-01,94,1
2023-09-01,96,1
2023-09-01,99,1
2023-09-01,100,26
2023-09-01,101,1
2023-09-01,105,1
2023-09-01,106,1
2023-09-01,107,1
2023-09-01,110,1
2023-09-01,115,1
2023-09-01,116,1
2023-09-01,121,1
2023-09-01,130,2
2023-09-01,135,1
2023-09-01,138,2
2023-09-01,141,1
2023-09-01,150,2
2023-09-01,161,1
2023-09-01,165,1
Query:
SELECT "block_timestamp_month", "output_count", COUNT(*) AS "transaction_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month", "output_count"
   ORDER BY "block_timestamp_month", "output_count"
   LIMIT 100;
Answer:
block_timestamp_month,output_count,transaction_count
2023-09-01,1,20882
2023-09-01,2,12126
2023-09-01,3,661
2023-09-01,4,251
2023-09-01,5,124
2023-09-01,6,167
2023-09-01,7,98
2023-09-01,8,72
2023-09-01,9,32
2023-09-01,10,34
2023-09-01,11,59
2023-09-01,12,34
2023-09-01,13,26
2023-09-01,14,21
2023-09-01,15,27
2023-09-01,16,18
2023-09-01,17,13
2023-09-01,18,21
2023-09-01,19,24
2023-09-01,20,19
2023-09-01,21,26
2023-09-01,22,32
2023-09-01,23,22
2023-09-01,24,16
2023-09-01,25,18
2023-09-01,26,74
2023-09-01,27,4
2023-09-01,28,9
2023-09-01,29,14
2023-09-01,30,7
2023-09-01,31,10
2023-09-01,32,9
2023-09-01,33,1
2023-09-01,34,11
2023-09-01,35,9
2023-09-01,36,7
2023-09-01,37,4
2023-09-01,38,5
2023-09-01,39,4
2023-09-01,40,7
2023-09-01,41,5
2023-09-01,42,5
2023-09-01,43,4
2023-09-01,44,6
2023-09-01,45,2
2023-09-01,46,1
2023-09-01,47,3
2023-09-01,48,2
2023-09-01,51,3
2023-09-01,52,1
2023-09-01,53,1
2023-09-01,54,1
2023-09-01,55,2
2023-09-01,56,3
2023-09-01,59,1
2023-09-01,60,1
2023-09-01,61,1
2023-09-01,63,1
2023-09-01,64,1
2023-09-01,70,2
2023-09-01,72,1
2023-09-01,77,1
2023-09-01,80,1
2023-09-01,86,1
2023-09-01,90,1
2023-09-01,91,1
2023-09-01,93,1
2023-09-01,95,1
2023-09-01,100,2
2023-09-01,101,4
2023-09-01,102,1
2023-09-01,107,1
2023-09-01,109,1
2023-09-01,112,1
2023-09-01,127,1
2023-09-01,131,1
2023-09-01,151,1
2023-09-01,152,1
2023-09-01,167,1
2023-09-01,176,1
2023-09-01,177,1
2023-09-01,181,1
2023-09-01,188,1
2023-09-01,190,1
2023-09-01,191,2
2023-09-01,195,1
2023-09-01,196,2
2023-09-01,197,2
2023-09-01,201,4
2023-09-01,203,3
2023-09-01,204,2
2023-09-01,205,2
2023-09-01,206,3
2023-09-01,208,4
2023-09-01,209,3
2023-09-01,210,2
2023-09-01,211,2
2023-09-01,218,1
2023-09-01,219,2
2023-09-01,222,1
Query:
SELECT "hash", "block_timestamp_month", "input_count", "output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "input_count" >= 5
     AND "output_count" >= 5
   LIMIT 100;
Answer:
Too long, hard cut:
hash,block_timestamp_month,input_count,output_count
cccaecdcc6c7e043555f97cc059205b8916cac0ef28a33c78f2c070efe672cb8,2023-10-01,8,8
2e1ff25b18fd56e09724cb107327ef0590acce2dfb8bf8320dd80d674f10919e,2023-10-01,8,8
d195f0757fd290804353455e3e4c6cad70965dca089ff97811b26effa3195f0f,2023-10-01,10,16
efca68c830ed2e5b34ba9d971275fa76d0e9bf6b500ff681d9b9eca44fca6c85,2023-09-01,28,18
7d8306e310bf7ef8b5a2b0753964b8a4329c3a22a046b8457c32333ce49c277d,2023-10-01,58,91
e4120f354dfd46a969347b40f04d380839237b6d58a714ff873994d80da2d804,2023-09-01,5,131
ff311e5248648fa0e44a757cf93a25d2abe7ba9101eba0fc0750938aadfb70b3,2023-10-01,21,213
531fceb2c0d0f5d389ee1bfb06e60c2a9210ab57dfc1b7231b876f331b0261d5,2023-09-01,10,5
7efbdbe07c3af8607e8c95cf4464b79e52e07a20b4c678d7b5dbbb03c6f77aa1,2023-09-01,5,6
035fced09ed0cab7e7dc94877df82188830c0fa164b97cfca03277e43b75945b,2023-09-01,46,7
55bfa08d435d205d3d4eb658e89c8c7afe8c41d6ca2dce84a26beb1d37a7ac40,2023-10-01,8,8
03ea3e6371e4b75412f3cd8cb44905989a3c104ff5fc3c456f8facd1e3b1e48d,2023-10-01,8,8
805c4c360352669796ebe8927eb9b987c34e4b7ec388b457a5c76b8252a65879,2023-10-01,8,9
ee13b1af6494cf3cb8a6b2adad05717c7b2f6a5614c2e6d9e4dfaa6659431544,2023-09-01,10,11
99f8da23c2a084f1d36b837a7539ef5e9b13da4de99178a0350e28882379a383,2023-10-01,83,38
fccda3576b4e0367a08c3fdb1436d71f376aa64d527fc940b6d3134dded0fff6,2023-09-01,6,6
6557422fcfbc936dae581b67d2397dd2237bc86f47ed70c111999453414bdece,2023-10-01,5,6
68520dea01034193f2e3415d72fc8189ccd5536d50426a53dde9dedaf2ec81c9,2023-09-01,7,7
1382088a31322e270f9d46350c982872b0c6433125bd87e9ba3d23b425261809,2023-10-01,45,7
11b042bd539a384869eaabb343f17ab986f7f8a9262985fae69c29f6d0611cf1,2023-10-01,8,8
1e9b53340fad85d72ebf9b7a2d5f0da85526f97016075103bec79c9ea0439b3d,2023-10-01,8,8
f2ab64650666a0f4c73239009bfa12374c487d7b441e6c39756eca40dd0d8d0e,2023-10-01,29,13
f7dfe3b4770be65e8f0f023067feda37b3fb5bcbf996d0c75a5e425c8defa115,2023-10-01,11,13
cb554500f0923eff03e97ff9bee4766ef950e27c2247f8e67595abfdd39999e0,2023-10-01,39,14
590de27c1603374202dd4e28e21989e5b6d17a0194d55f9aa6ff135da6da450b,2023-09-01,10,231
03707d452fe5bb5d3b08f8e9d1c843c6d4078a85c1aeb87b0ebd0f739e8686cc,2023-09-01,5,5
4d1835eb51aca5d9deaaa16cd69177132997a74b7694dee2d17567700dbefa53,2023-10-01,12,5
60287c6d3d628b383d0132a9821065718a63644c65edcc7b6171c36e39bb84f2,2023-10-01,8,8
04db87d3b93ffcb68545009de92064fb7f0f59fe87de83cf7ed5f1fbec5b5202,2023-10-01,8,8
98b8fc09f0df3639fc7ebab3fd6e5134d1b5c636996663fe081685f1d530b493,2023-10-01,8,8
bcef0ae6e9d89e28f34325af45f52eefe5c44d79413bb854ecc319f88cbe5447,2023-10-01,27,9
51377950ef852e2e6dfe72764e8954a3e1144b97a3cf51991ffbd9e9aea4f86e,2023-09-01,6,10
1f6487cb75618e2c6b9f24eeebdeec13c2a14f130c019ca323f9bd8b84866a1b,2023-10-01,15,21
5854b42dcc7b9198316fc9a16b1167e9115fe2810de53b3a939fb25aaa12fa12,2023-09-01,22,23
4c8c54ca79e15c9342bc67af5990e10ed6124110b1bbe3c1cda983ddab6e6f69,2023-10-01,11,81
312cc4b1075acf9d5e2c2289bf629457c25a526bf963e62de21292bb934e1130,2023-10-01,10,5
f82d8d30608b9bf760318de769c903945db950bf8982a5b96f59675609fa36e4,2023-10-01,5,5
11441ecfdd1c623e8fa5d276eddf08cb58b0fb8179a16ed24908e8ff89700669,2023-09-01,5,6
809516777f5358648c798b80dee57a453111d884622c1c8d761dfa949c26f4a0,2023-09-01,10,6
454cbdecf835b470f8ee3d7504b758ae26b6c0f58d4230306b1ad0feb0723e42,2023-09-01,5,7
bfda5c1041959411686ada64d857acf4ffff07c1539eb973a66221efb8ec7ce5,2023-09-01,10,8
b544211e30bcca5dcb56c5c7c3cc88af2229dd3e72cd9abceb740f383b28fe68,2023-09-01,10,8
9f290fb853a238aa7e269a1c3330127211cc3c8d11785a7fb1fb72330f6a63ea,2023-10-01,8,8
37ab0c966885b5906f8c898101b7e87361c099e22eb8c4d7657e84f3d1eed9d6,2023-10-01,8,8
16945e757988b2b1e4796f921d355fe2d064ae0d79da41a507370bbd2b12e368,2023-09-01,10,9
e629f209e0ffcf5ab0f1c9bbb88fa00fd2fae3ddab636a5584c1dd5018ec2c03,2023-09-01,10,10
6d16fdcd620f346763cc802cd3a6f92e0e63217c1fa37beb65aa294789ae7694,2023-10-01,10,11
8b66a52ed0daadd6fe787641e71958c36a4e88d083985a43e60138a7d92eb7d5,2023-10-01,15,15
d10d498ade2f8ea0a400e935fc2752c6a501310fa0c2b59f88d43dfb7ad4191e,2023-09-01,26,19
c731591a0e446b1bc4e1f268ea0d26d9de5b7f0a3cf33a7410e6daf724990a19,2023-09-01,23,5
a58b1793d634b515d8543903e3634601bec37b71fd50eda01244c93d886a73be,2023-09-01,6,6
ebf85271963863db8038d34aaef8f5807fd45d9e438ba5017352ff1c31991a85,2023-09-01,5,7
7fa65c3a0caaabd7ebd079db27803b244f803ac5d658f327831059f0367010a7,2023-09-01,10,9
1b1756b1beb3f6f81192fb3a49b9ec94070a4e3e1e0e3aea6dce33ae59ba723d,2023-10-01,12,9
8b3a99bb9e736ec08e11907ca37da1e290215cd6f90f5701fec661d63fc99f75,2023-10-01,8,13
79d25a139db70af90ce96941fa7befec2159158690af41e3b07f4318c18e4fe9,2023-10-01,7,28
a2fdeafb0687c6b73e8e2c08169bbbcf634783ebaad841feab1cc5586222f737,2023-09-01,17,54
640fff5b34bb802e3d57d3800722b1e47102bb7c7bd33b5c49b0a45da1a55897,2023-09-01,14,177
78a23294127e79d14d4213d6ab586dfc2476db290a10c055c5e5f9dd0ee9586f,2023-09-01,48,211
8e2c8d33da568e829d2abad9d73c10a1623e77cdcf77f4f983644a76d696af61,2023-09-01,328,303
3fafe1801f4cb25292b96a4180b4cd273e1856dc366d4d59a9779db3a7fc86b7,2023-09-01,13,6
5
Query:
SELECT "block_timestamp_month",
          AVG("input_count") AS "average_input_count",
          AVG("output_count") AS "average_output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
Answer:
block_timestamp_month,average_input_count,average_output_count
2023-09-01,2.305374,2.677691
2023-10-01,3.795484,3.010431
Query:
SELECT "block_timestamp_month", SUM("output_value") AS "total_volume"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100;
Answer:
block_timestamp_month,total_volume
2023-09-01,7305381621178.000000000
2023-10-01,6921152069207.000000000
Query:
SELECT o."transaction_hash",
       COUNT(*) AS "output_count",
       MIN(o."value") AS "min_value",
       MAX(o."value") AS "max_value"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE o."block_timestamp" >= 1000 * DATE_PART(EPOCH_SECOND, TO_TIMESTAMP('2023-07-01'))
GROUP BY o."transaction_hash"
HAVING COUNT(*) > 1 AND MIN(o."value") = MAX(o."value")
LIMIT 100;
Answer:
Too long, hard cut:
transaction_hash,output_count,min_value,max_value
0c74f7059941b96dfd4edc89d0e4612950a0d48db75c8d01f70f0d27730ce479,3,1128.000000000,1128.000000000
67c4fb61cf5dad5e69846010e591ad417e99976d92656c63d81be8852dd08a96,2,66404.000000000,66404.000000000
eb475a400defc4d3223be7dd8c1afb73fc6f558220770ac55601b030d5312b91,6,546.000000000,546.000000000
9489f52b919a4b18bf79cd0d86abb50408f418a6cbebc676aacbd940696f2f4f,4,1124.000000000,1124.000000000
55dd72dd035cc440ef2d8276cd9e2816c74d957cf354966482b3e32c89686368,2,1000.000000000,1000.000000000
a0baa99a9ffa552d3db2197888eaac15054f9d5a9c52b0d8455fbed03b7c62c7,3,4195.000000000,4195.000000000
a44b18773b1c0e0a5cc9fd2fedd14c8ad7d3663277bdff3f9dc3a91e03767da1,2,25046.000000000,25046.000000000
4976ef23c498dbf29ee1cf59258250ccb9d1b264b07a790d53fae60146d20922,2,1175.000000000,1175.000000000
63bd097c6eaae3d19395a768cc45f9e37f87dff1359e71940904cf52cde0ed12,3,546.000000000,546.000000000
c7ba81da70ed790f7508dfb070c4c370672de5019692422bbecb72a88faac90c,2,1141.000000000,1141.000000000
7db179edc3c9cc3c9f7a97133cd051e62626aba3947cb73e86a422cfcb8313e8,2,2406.000000000,2406.000000000
fa164bab769bb29cd929b9a1ee9e8f1bb91ea61e29a96293af4c62f20380296d,2,4000.000000000,4000.000000000
a75e2b4cff227807e199d0d78433d00e196c92e43d01406f9e3f690d8b021262,2,3428.000000000,3428.000000000
f5536fce8da7b5c92642729f8e39aef9c8737b6d6304c7cd25f50ade07ce6118,2,8443.000000000,8443.000000000
50d16c991a1359a9498bd080b5835d129baf87cdb941e2777e661f2d792a81f1,2,10000.000000000,10000.000000000
5867b4c88c4f49e0f1e002b65ebfa44af60a934f2eee391821d45a5270036c2c,2,1245.000000000,1245.000000000
d9a05957ce3dcc04bcc2a12a3aaf291cdc9525d45b71d85ed1944502cf6a8676,2,174146.000000000,174146.000000000
718099fcd9ceb2232db809945b9007c03e1cdb768c131c22726045b823370110,2,1161.000000000,1161.000000000
0a0d73b38bf4dedbf108f4196618a7ae4b1b5c0600af4d384fba03d8932e428d,3,888.000000000,888.000000000
91def2dbad80a03e60a6e6c9cb6604d4a314f9de92448a5b7583319a179f808b,2,109220.000000000,109220.000000000
b028bd89892b3ceb71eb9267a6353a0a688db92b8bffeae583155bda0f016d5d,2,3586.000000000,3586.000000000
2a9985b2c1cea1887ad54c1ebc5212be83d0544271c7e033af683ee7c7dd2eae,2,2500.000000000,2500.000000000
dffea290e2afc6323dd41748b2a1c453f015fac04ffec63563382221efdd7ce8,4,1151.000000000,1151.000000000
f849c3d53b12977876708417d704401ae2b88fdd9792d958c7142fd85ac3048d,2,1168.000000000,1168.000000000
c399e14fb345f2c02e63cef85fc5f1e337d26eb686e12cde7f16e508372ed553,3,11904.000000000,11904.000000000
f4edb4673afe99d3f3ffd822c70e39379f428d8480cff1db359d53dcea4c9334,2,1957.000000000,1957.000000000
e0ec820b73c1c104db23d9d2864735c1a202e2e8021f78b90a8db661591a1fc9,2,10000.000000000,10000.000000000
1b438db7b39088cfb57951cccac3c579e945b722e1d9a021fc55f44a33d02712,2,1164.000000000,1164.000000000
a2e81cf84ca36866168d613afff76bab1133cc473dc0bee66e7068fa396f9c65,3,3953.000000000,3953.000000000
83164ef91a72932646bb6a80782e665a3c3264be00d0bd0101377824c01b8737,3,330.000000000,330.000000000
2adef1fbec5fa958f7eda7d02ac2e249040eb30f4d5514a8bc765e85f11b1908,2,129800.000000000,129800.000000000
96f11ad2c72428eaf17c6d2e4f62b04e5a64271a71b11eb98d04dbfcf5f44412,3,546.000000000,546.000000000
e45f72fcd8b9a09a85eb960594f048bf3e2660f4359e55549e7212381f1f2eb8,4,546.000000000,546.000000000
f0036946e27b944820cb03270f27211bba649e7477a121e803dee77d7a6b78d0,2,3616.000000000,3616.000000000
a7cd91b51a71aef492015141d945af03ab8ad71aaffe36bd8a55388dd4e31914,2,10000.000000000,10000.000000000
e7faaa689d13fc3e2cf0f50c646e939ca015bcb647d2016b8cd87940d143c37e,3,5562.000000000,5562.000000000
a65ba859d5282c1217f04a6adcb7030a191fde17c5aa2eb0707015d11624d5f7,2,102730.000000000,102730.000000000
0cd5d71bf32b86f3030ad900d4b414ecfc1d0e6fd87a3429475780884af69026,2,10000.000000000,10000.000000000
667fbceaf34e60d962a5c3b1ceda3e648de696df1ece4f8d8fb5e64acad3c05e,3,1010.000000000,1010.000000000
594d4b10dec0bae145ddc0952834be1f086b919e62746419923c9b8fe4e06120,3,1158.000000000,1158.000000000
9ef6958634cdf3942d62bb586da416f0205354e5c486d5b1995345b2af43c205,2,2124.000000000,2124.000000000
8f33ad7698c23c1ecaeea0133179d01894e6f6cad264e1c3715379fd9dda4e6a,4,330.000000000,330.000000000
db0e58b8fcef00f12da48c24275bf700e353cfacb4cafa7871c996a641a12ed9,2,548.000000000,548.000000000
2b780e3798d79022302c955f5e0948a2e304e671d76b172a69c902e7dad0f478,2,3318.000000000,3318.000000000
18ede4e2842cced3a11824438e9e8b4771b41035033ba7e678a9b50f7774928f,2,1128.000000000,1128.000000000
c896fecf8b84df06760068efa5db7ff46deca45d85fbea9b8cfecb1c8dca177e,2,888.000000000,888.000000000
da725bc2fa648b05e55b49b98a904b0717b91c220b1e84e51347f17488b84012,2,29981.000000000,29981.000000000
6ad079609527014d65dd596f433fb5e28ee335c4ccb8babe650b3206f8a2f33f,7,1143.000000000,1143.000000000
9822ef4d4162e15076e5a9191daab2ad47aef42dc9eac5edb136af131d1e2491,2,1145.000000000,1145.000000000
02214bcfa0f3c8880100468bac73378e83f35fdcb16cae2f12644a382ba16e28,2,2231.000000000,2231.000000000
7162640e086c26ec57d43d82cd6152d6ef5289017f5ffa84bf87047a4b16b627,3,1966.000000000,1966
Query:
SELECT o."block_timestamp"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   LIMIT 10;
Answer:
block_timestamp
1434133281000000
1403725915000000
1601554753000000
1465827780000000
1663890771000000
1562550012000000
1664215824000000
1528919737000000
1630828581000000
1563104884000000
Query:
SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)) AS "month",
          o."value", COUNT(*) AS "occurrences"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
   WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
   GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000)), o."value"
   ORDER BY "month", "occurrences" DESC
   LIMIT 100;
Answer:
month,value,occurrences
2023-07-01,330.000000000,4943
2023-07-01,546.000000000,1555
2023-07-01,600.000000000,345
2023-07-01,10000.000000000,157
2023-07-01,100000.000000000,93
2023-07-01,1173.000000000,88
2023-07-01,946.000000000,87
2023-07-01,1316.000000000,86
2023-07-01,1097.000000000,74
2023-07-01,1200.000000000,72
2023-07-01,1163.000000000,70
2023-07-01,1100.000000000,70
2023-07-01,1135.000000000,69
2023-07-01,0E-9,69
2023-07-01,5000.000000000,68
2023-07-01,1162.000000000,68
2023-07-01,1254.000000000,67
2023-07-01,863.000000000,65
2023-07-01,1166.000000000,65
2023-07-01,1122.000000000,64
2023-07-01,1000000.000000000,63
2023-07-01,1155.000000000,63
2023-07-01,1164.000000000,62
2023-07-01,1159.000000000,60
2023-07-01,1142.000000000,57
2023-07-01,333.000000000,54
2023-07-01,1138.000000000,53
2023-07-01,814.000000000,52
2023-07-01,1108.000000000,51
2023-07-01,5000000.000000000,50
2023-07-01,1153.000000000,50
2023-07-01,1170.000000000,50
2023-07-01,1470.000000000,50
2023-07-01,1130.000000000,49
2023-07-01,1150.000000000,48
2023-07-01,1128.000000000,48
2023-07-01,1174.000000000,45
2023-07-01,1185.000000000,45
2023-07-01,1178.000000000,44
2023-07-01,810.000000000,44
2023-07-01,1114.000000000,43
2023-07-01,50000.000000000,42
2023-07-01,1167.000000000,41
2023-07-01,1425.000000000,40
2023-07-01,1000.000000000,40
2023-07-01,1168.000000000,40
2023-07-01,1116.000000000,39
2023-07-01,1300.000000000,38
2023-07-01,1113.000000000,38
2023-07-01,846.000000000,38
2023-07-01,1103.000000000,37
2023-07-01,1152.000000000,37
2023-07-01,824.000000000,36
2023-07-01,1161.000000000,36
2023-07-01,1160.000000000,36
2023-07-01,1110.000000000,36
2023-07-01,3000.000000000,35
2023-07-01,1171.000000000,34
2023-07-01,1089.000000000,34
2023-07-01,20000.000000000,34
2023-07-01,1157.000000000,34
2023-07-01,13000.000000000,34
2023-07-01,845.000000000,34
2023-07-01,1778.000000000,34
2023-07-01,10000000.000000000,33
2023-07-01,1117.000000000,33
2023-07-01,1068.000000000,33
2023-07-01,1158.000000000,32
2023-07-01,1137.000000000,32
2023-07-01,1118.000000000,32
2023-07-01,1099.000000000,31
2023-07-01,380.000000000,30
2023-07-01,1624.000000000,30
2023-07-01,811.000000000,30
2023-07-01,1617.000000000,30
2023-07-01,901.000000000,29
2023-07-01,1398.000000000,29
2023-07-01,1145.000000000,29
2023-07-01,1101.000000000,29
2023-07-01,300.000000000,28
2023-07-01,1140.000000000,28
2023-07-01,531441.000000000,28
2023-07-01,1141.000000000,27
2023-07-01,1119.000000000,27
2023-07-01,1604.000000000,26
2023-07-01,1175.000000000,26
2023-07-01,200000.000000000,26
2023-07-01,879.000000000,26
2023-07-01,1182.000000000,25
2023-07-01,1069.000000000,25
2023-07-01,1172.000000000,25
2023-07-01,1571.000000000,25
2023-07-01,779.000000000,25
2023-07-01,4000.000000000,25
2023-07-01,1540.000000000,25
2023-07-01,1191.000000000,24
2023-07-01,1121.000000000,23
2023-07-01,1032.000000000,23
2023-07-01,945.000000000,23
2023-07-01,1195.000000000,22
Query:
SELECT o."transaction_hash", o."block_timestamp", a.value AS "address"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
     LATERAL FLATTEN(input => o."addresses") a
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
LIMIT 100
Answer:
Too long, hard cut:
transaction_hash,block_timestamp,address
9d74333024b9d44a7b9db8541f27f73f2c77e11275a8ad6d575c1ab03dd64ad5,1710384546000000,"""3MwVg3WQ3HsQ68QHSotuMkfQhsEfNg7Cuy"""
a4c2b833d1d45ebe4fa51776be9b6c037ce5d0dbd58748080c2097a7be874ce4,1709747970000000,"""bc1qx8c8kufsvdq7alej048axzrfehjwcxem0fmvw8"""
17a12fd009f475f4172a8b56146bcfb8a8e86b9fc40557796019b7b28dc995a5,1728117660000000,"""bc1qw09fpz28e0cqqu2240vjj2mgcjz54mg30e790f"""
278af14736b3c14e524a81848cfae1f5d5c3a8d20664f5227816a6f7295ff426,1693840129000000,"""bc1qjcsa6qx27dy6rpx7rhwuza7zthlx8x9ysqywew"""
3a109ff70d54444825b603625652f5ae6fb1c350c87c2a82af5e262f69ea4f1e,1698284413000000,"""bc1q57f2avul6sng79pfl2thpqy7j4ahxxr9gzahw33nm5xcsu0sprwq6c8gxm"""
5186db462e823094ed0a15eba35f51687bef87af8b935b15d4799887083a5e72,1701168861000000,"""17yC4yR2x7RhkJ8W54D9gf1ejRbTS5rPhs"""
be179cc9143d5648b63dffaf1290ebc433c6cc27a3bc9cc1b442883b2e929d6a,1713975639000000,"""nonstandard9011dfc0598e3e31ef3452bb1245e95dda5948df"""
2c3d33c77a2c2e0fa5cd0daf99bcb47ecfc3392ecd82471a890808a9496784ce,1699664031000000,"""bc1p0sj2yx4q6d7r3ktn8g7gkxsed5eh4xqdn0mvk6zk8we77pehqlsq0gad8q"""
0ae51fb8766e5b3e490058b83ab8260e85dd04f833fe42be7b03c8a5c00499d1,1699772035000000,"""bc1p7u6mkw4ylv5uf5lp6k9hp76g6qn5c9a8qfq0kjnru5f6ffl6gt3qcwmytc"""
e9d80ab17e5f21edf5d685665bc3cc9878ae651bc559b6c3021c78b7302e206f,1723964659000000,"""nonstandard9eaeee16710719dc940121f0ca3d9b2ee637ead2"""
1265989fe2c755b9dd88ba001e04d9c06adbbfe8ae5658e9fa6295e2e32fbc7f,1712691753000000,"""bc1p35zmhdaudfnn44phu6h6pyu6e2wxwyjyv9pn3uaj48e8j6ep3rrqaeqlhp"""
fd3d7b07fa9bc423e9afffaf2cb2a2d0dac91785e4e5c984915faffb68080a43,1724223418000000,"""bc1pjjcjhe6rqqcjhj44rnas5gk420temzgl2z6ahhqmc70y8gy4e4fs5z9tur"""
3ecfc45022667b735f3f538c3f165f2fe5f24284c8137785792d4c5d9a9f0793,1714354550000000,"""nonstandard88cad0de6411d5787e2c2b6686d83fa280f37471"""
82a6ab7db0bc90ed915f0645ab555359b4c5e648a61d6d85d7ff77162f7134c3,1704688954000000,"""bc1qqde9rwk49zj55vqzd3jlvx4rl4qs3frxu6c656"""
c1a762221b376d226074a5f96ae1470cdd81c4ad9a4fc6367c6b475f22269222,1725161188000000,"""bc1qclyfsxuu8vcwq38yygs5zrskwacq8sjlyvk9mx"""
b83dc77b2e73d13973bc722d53f4f61bd92e2f30e3daa278fc59a4c792249360,1690783493000000,"""bc1qqfmuxy0268ltk9pls4kgupassextnretavagtt"""
e0c9c2fb776bc5cb6992978cb91cc00cb1a00c85555c422f1ee7f16c44456091,1688989478000000,"""bc1phg076wsv4ku0d7hzv8vde6ule820u9xcesr6slxhxeafg7g0p05s9ejqe6"""
0ef7e32a54f78475dbe33345bcdbb6d70fe30e4cf386ba5fe99354b17249ce83,1706830140000000,"""bc1q2c0tw55x57rzvt3ygzcgxu4gr0mzrztyjss8lk"""
bc521ad218bca6ea68436a0a7048fd97efc35d9225ef961df308f0d8bbbd4a31,1727114783000000,"""bc1pr3r3fdsfdw8yws2erh9g9lxke5fp6dyn4569gjwa7w9vnhlj7k2quv4wma"""
5d6ec060c98e2cb071b847444878fb79936dd73da3424f34a095616fb13f0a68,1688213098000000,"""3K794ADWfqxDu9jrrZvXdqnPN3seMkuDdd"""
ab20f018bf436b7dfabdb01ca0b217a849163b3ca9b1c7a7a6b6186cc513f5f5,1727035218000000,"""nonstandard9eaeee16710719dc940121f0ca3d9b2ee637ead2"""
779f572a4bb6ab351a4f7ae7349009a7bd5e32bcabfc03aab7272ec151153254,1727170631000000,"""bc1qx0ffq97ta93te9k8dyy0kct95q2ax0ygp0lmvn"""
f4c468b6b818957d2763d554590240b32d037bf058a4516a2cdbb443a808bbec,1727339368000000,"""nonstandardb530d86240943a23e8c52285cc23ca3aece4ff0a"""
769244a0c6c57a96e08900c18c4e06c7454409774a08857a50cb9ff5a2bd40a1,1691333748000000,"""bc1qeq8lc7n3l6ux7jf00a9vh67lqakaygy4yhgkx2ccgvt3ma3pmy0q06773l"""
a92a930ad11111240335a53934963c12dba5cb55143cbbccb06869bdc1c73add,1691486783000000,"""bc1pwwc99tus6d8tfudm9w3rdxrfu3l8rsyl33vdv3ulrlwxts7gtg0sp5xuck"""
6c45b30f7fcbbf945e4b1e832eb0321348b2a6c9d4475e7dd8e2460ce293a637,1708819644000000,"""bc1q5l68aycgt3ezh6jql45tjx47n6swe3f0e7xtae"""
033cc6a9fafb5012dd7eba590d906c283ad42a50228f1296d87957b827a82d43,1719206665000000,"""bc1qrnehfure686kvruku4ztjmjjjhs4ga88r56tya"""
c246da90f74c7806fd04a1d027cd120c6a767fed025cd32787566d0bbe559781,1691873550000000,"""bc1qg2mgat8egjsmhy50mvq982etk66n4980x3x3yz"""
d02f0e93d494021e99ef14e7047f2dbb0807a603c0e0779c0d8562978c7e1192,1721841481000000,"""bc1qk39dqwgnujeesy2kpke3ezl5caxw6rxjanzmw2"""
7678543f645e5d3615654195a8d9bdc3524d5e7b32778e50279137cb0740d076,1722232898000000,"""bc1qn763hmj7jt0dj9nlc8z02ty79huhapsn644gj0"""
69c7c31e8b89ac9092064eb01625fffd797cf5a844ceff5ab1476a7283befe35,1703502548000000,"""bc1pqmurp9x2fkt6l8fa73rptt93wap8wjckk3kksvhmh3jnq2j7jqusq66ql3"""
332f2f257339e62d429eee23bfe7124b4ba94251020fba98742ad353c462781a,1702290676000000,"""bc1pwtwuq0pw7xd0kuskt98d5wsvgqt3w94rvplnkx8cmvhfuwm2lfhsrggwr7"""
9beeb697e6630fea122905173a88aece79aee55150dee6724c5d84a519ea9990,1716605229000000,"""nonstandard19cb4b0188bbda184f58a5558070c369386371ae"""
c108ba751c9559b77c0827dedbecb25e920c7ea0d23e1316e27163a0abafaf43,1695620516000000,"""3A99Qr15FyEQCBfR8DH6sZsYLW6RvjBDQN"""
effa68dfcba0c6d3b2af031a81b861a7211c420709cc8ee523a4f0c2c602bab0,1727918051000000,"""nonstandard9eaeee16710719dc940121f0ca3d9b2ee637ead2"""
efada07dcddde9783407775ab5daf63baace25eb567bc51c8c25bb23f17fee50,1694081728000000,"""bc1q5pwj86d30kvly7tqun7alpzlfgm6mlge29
Query:
SELECT i."transaction_hash", i."block_timestamp", a.value AS "address"
FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i,
     LATERAL FLATTEN(input => i."addresses") a
WHERE TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
LIMIT 100
Answer:
Too long, hard cut:
transaction_hash,block_timestamp,address
e8f2aca2426a31e150cb7b2060f675e51a1f85198470ef35cc3014598f7e007c,1711663248000000,"""bc1qnsupj8eqya02nm8v6tmk93zslu2e2z8chlmcej"""
c4b01b659a3cb5e411a22a8bf7a1ec2cefa2a1b4739162d884d40eedbbdb9967,1693985754000000,"""bc1qql7zxnjt8tyyhv84ny3r5dfmya525v8rcl2wjhyrhwpjhn7pzussaeemjl"""
c3c6971bb956bc749544e655f2e0069bdeb9c73a2263ccea556ce1a4fabf3bb9,1710869343000000,"""bc1qlsnx3nhylmzqusn5m6kk5edpfla3tmzwhp29hx"""
d03fcc4455a8220b4bb9886646889a7f1981321c994e1dfc454e65f0e358c077,1699207030000000,"""bc1p9vplmxyxxc364jg4dedc7u6w55ff8lxm5r2fau2s45u5z4mjutsqsgwz7x"""
1966737f76788e3d606d5513f0d1f02bdaa3867952d00c4d99e39f354e4b9eb1,1703806461000000,"""bc1p382u66uvz2q7zt0qt0t9fhglzqdqfmtzmdqavpqt4pd74smhty9slhmuxv"""
6deac6851275f1d9a73f423d42f207aac21fb885e2414417e0687d1683f8c9b5,1715510251000000,"""bc1pxle75huhwje6te3aeyu65kv64h8s9al8dfpr9yuzqw3qwlpkzk4q7s3gzh"""
ed463425f2f9adff8d1e852998b84644f45aa9f87f9b03fe072214683febec37,1715773727000000,"""1CjvtkXyX1R939NsLb1PVu23PQFAQTdT9G"""
f76651dcc4074944e514e48abbd659ea0c5524b4ecec858b09ac184dd45675f4,1717026095000000,"""bc1plef3rq5wx4mx299ldexvdz73hs55lgee47pp3st8uef07u0eydcs70g6l3"""
0c45623a61d5abc14d9546919dc64e4e2ca42217daf2a8b6f3e95d31ed4b2112,1719775498000000,"""bc1qhsvrmsg7g45y6h7jjppe6pxvj5t8fesysdyueh"""
825a14afe3ce2eaafae40842ef2f6cbcb5fc5da6d3a7b1e157a5bdf9034d66d2,1692504897000000,"""bc1pwwc99tus6d8tfudm9w3rdxrfu3l8rsyl33vdv3ulrlwxts7gtg0sp5xuck"""
d4a79d359fbad78c9c4ec1a11a25d96f221ee051022cd8dd401558a4b0c4a367,1706573692000000,"""3Cw9rJQrrzZV2bHSnBP8kUoSwFUykt6ikA"""
f1b5f26fca8a893e0bf05474b4582605c7c610a78c8b61a3410abc14cf54182d,1724640100000000,"""bc1q72ymkjyt3sjwp0ftjuwtf0y0mftezt70ardd3m"""
62388347b1d4702822e7d4fb51b38fbcac43ab8778af9c054e40411e838bc0bb,1705703780000000,"""bc1pvnhy22yuk6kzlqylpcyqcd67wfhxqpz4w6mmf3t4yxqggrpaxrdq24qnz7"""
23f612360682cd8a8fe75b9018ef6d060c2dadc05bedad9e570e49c3141b8245,1707458467000000,"""bc1q2n2xahs5qa8h27qxxsqplafmrppeewe9f6ny2p"""
75a5486a8231ffd915b29425ff4b534499efddcad3a93ed229e0e35ff1c6ce48,1726621567000000,"""1FHRNPdv4Xv8fTBohJzg6pTwsNjsYc11dG"""
274dbfbd787229b61ff39543ae5b5b868a8c5344ae58c7a72be97b515a249dac,1708763636000000,"""bc1p9xxkwj6mq5sj5g3ggmcu9744sk5saw5lm5e9yzev7rnltk26dstshsvudk"""
47a61aa27a6d200a318e4590215552fc50135f99e6486f516e57eda8558183eb,1696786907000000,"""bc1qvhahl0yhsne0ypkfxdhje6c050sjfsyefavhlz"""
1ba5ce4b65cef0b2f0a85be4dd4b62ffcdd184dccadfe268b3caab47145f9d85,1697208680000000,"""bc1qt5m8xeclsja4lkfvl2nvmrt6z9vg60sd8w2kc6"""
b65016c5b47f4c709428aeb57620073df1d07fa4c7d0e94033114dbe9888c1f7,1700923134000000,"""1ETJcPaEuvuLsUHsQCsrWp88Q6PM3nJ7ZJ"""
51fa1a67c6cb6931145ff986eabef7ceacb6e53f6b7f78a9eece29554b9b0d02,1694180284000000,"""3MdZQGpfF8VJCe22EtjtVdiBq5QgueNK12"""
508f4dcf425eb89be45b568ae981ef4bee34793f9ff1f3e85d29ca40a02d2bc0,1712817632000000,"""bc1q997fx6smmqjn8xe7a8feku9ywdn2jtv25vmuaf"""
ef3563dfe081bc039ec0f4e6daea95e87dd780cc1cd615a4da33d0566d85f77a,1715501758000000,"""bc1pxrax79f0d4nj2maq5h57ghqp8ra8wkjhak7gxajm9ukhzxy9r9js4h7vvx"""
81ea29aefbdb61ae8329425aa95a5097d0b148e45fa0d2c24104e4e072ec308b,1717167435000000,"""bc1p8xaz6x9a44ffp2akd7y58g9aqkd3keg3vyrra5dk9f23wcdtdj7qfgrz9t"""
bb3c84b95da3060c740006a0f5fd3488a0b571f7eb4d1c9b9a220a2dbe2e2cd6,1720935154000000,"""bc1qcmnatkm5xnsa02stjyu8mn6fwluc0chnzc2r5v"""
3e034e2e08c36c61d8f47f20c8d275ed0a40fba6690a00c90d251aabbea806ab,1691460762000000,"""31iMVm3vyA9ZYWxJ4QERDVB7FkVC7F4Nvv"""
b437c3dccf4142aa1e51803a4d7f71092b237009ff59716a71609980a9f9a704,1692756204000000,"""bc1qywuwmz0uqlh3000hwe5dc2muk8gtktuyzzgzkt"""
1ed40824bb6244a6f0c57d71230c1940e305c063bae2b3c668cd086fc225448a,1723161684000000,"""bc1p07dh8pw9wutdd34vn7hwuee9gnhhx6mexz4fuqldmcwtauf3cvfse5g6lh"""
34da26b523bfe19ce4a07abcdf071762ecfaf1f4fd177b2c32c8e61f613c7f44,1690698115000000,"""1DvH2qCsshQ6byddP1J7RZR5mTR2RDztVc"""
f192b865883e57afdb00d1c21b0df54f0301bb036289c6d4af36f00e3af6f356,1707318139000000,"""bc1pgrxgquxdz6hl5am25gwrzthuddapy3l6g7pu2qcc4e4unktfvxqq7yvmy3"""
acb48b117b52eda0ace3739133864449c0209ea52b1c48580beb49c313e27f17,1706820992000000,"""bc1qw8wrek2m7nlqldll66ajnwr9mh64syvkt67zlu"""
08f4673dcd0dde120d7ef5f50ecf1770fbf128bb1c7d6d6b390d634e6753d791,1726847981000000,"""3EgqeXeL7KnWC7ALh4JLwcT1w4WGvEQEmc"""
2945539d669f28d283a50a6c00a675469b15ff4aedc39598950c22996afcd5e4,1688543814000000,"""bc1q7n9vufgkwnwjm4z54xxruc4s3606jyr56ctmtn"""
5ff9b970dc5b999027418f0a88674e3bb7b03519f90eaacec315478ce5f0b5fe,1708674313000000,"""bc1q6m68lxgplsm8xnhnqwhn3zlh4987ph55uw69t5"""
0554c18245a3c5fa669b64b54acf3ae9352605e44852476b8c22879984f3f6d4,1689968814000000,"""bc1qttwe4pflk6qu6qs5qu3tdj983dhx3jm7sgvlza"""
1bd494491a1c6590e7b6c273907c05169c4a0b3d6ef74fe318013d5b203ca67f,1727142547000000,"""bc1pv25udu0ldx925l3sfwdxvaljwtfq3u4qvy4fvuq3dus5gen2chksctesev"""
1b306ecd46bcf81c6926a2178e79b3743f6b6a11c5f4e836b624acd21bfd5a61,1727002550000000,"""bc1qtq9zgpaqvq0lysuflytxd8n6ne9p7qphuqndpe479k27nwm88kjs68zrm5"""
9e44f3dd2d279314a0287269b78
Query:
SELECT o."value", COUNT(*) AS "number_of_outputs"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
GROUP BY o."value"
ORDER BY "number_of_outputs" DESC
LIMIT 100
Answer:
value,number_of_outputs
0E-9,65908
546.000000000,44709
330.000000000,17089
294.000000000,16299
600.000000000,11473
1000.000000000,2664
1200.000000000,2397
10000.000000000,1851
100000.000000000,1719
20000.000000000,1205
1000000.000000000,809
300.000000000,803
796.000000000,716
4999.000000000,716
295.000000000,649
5000.000000000,605
200000.000000000,603
50000.000000000,570
333.000000000,563
5000000.000000000,554
420.000000000,508
547.000000000,476
10000000.000000000,464
30000.000000000,426
9999.000000000,394
500000.000000000,370
1127.000000000,359
2000000.000000000,324
1300.000000000,301
1120.000000000,295
500.000000000,288
579.000000000,287
3000.000000000,270
300000.000000000,269
4000.000000000,265
150000.000000000,255
40000.000000000,253
2000.000000000,251
20000000.000000000,247
50000000.000000000,245
888.000000000,241
15000.000000000,234
60000.000000000,231
100000000.000000000,221
2097152.000000000,217
801.000000000,211
354294.000000000,208
1128.000000000,205
400000.000000000,201
1062882.000000000,193
531441.000000000,187
6000.000000000,186
790.000000000,183
580.000000000,182
80000.000000000,182
1155.000000000,181
331.000000000,180
120000.000000000,180
1135.000000000,175
262144.000000000,175
7000.000000000,172
555.000000000,171
1162.000000000,168
8000.000000000,167
1122.000000000,166
600000.000000000,165
1150.000000000,164
1800.000000000,163
3000000.000000000,158
1130.000000000,156
1140.000000000,156
1170.000000000,155
1125.000000000,155
1168.000000000,154
1173.000000000,151
18000.000000000,151
1164.000000000,151
3188646.000000000,151
200000000.000000000,147
999.000000000,144
250000.000000000,143
1159.000000000,142
65536.000000000,141
70000.000000000,139
1142.000000000,139
1163.000000000,138
39366.000000000,137
1174.000000000,134
13000.000000000,133
1166.000000000,131
540.000000000,131
90000.000000000,129
110000.000000000,129
1153.000000000,126
130000.000000000,126
1500000.000000000,125
1624.000000000,125
8192.000000000,124
1134.000000000,123
16384.000000000,123
Query:
SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000)) AS "month",
       COUNT(*) AS "total_inputs"
FROM "CRYPTO"."CRYPTO_BITCOIN"."INPUTS" i
WHERE TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
GROUP BY DATE_TRUNC('month', TO_TIMESTAMP_NTZ(i."block_timestamp" / 1000000))
ORDER BY "month"
LIMIT 100
Answer:
month,total_inputs
2023-07-01,30923
2023-08-01,30778
2023-09-01,30624
2023-10-01,35552
2023-11-01,29602
2023-12-01,30178
2024-01-01,30845
2024-02-01,29024
2024-03-01,31907
2024-04-01,29342
2024-05-01,33393
2024-06-01,31518
2024-07-01,37083
2024-08-01,34272
2024-09-01,32857
2024-10-01,7649
Query:
SELECT o."transaction_hash", COUNT(DISTINCT a.value) AS "unique_addresses"
FROM "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o,
     LATERAL FLATTEN(input => o."addresses") a
WHERE TO_TIMESTAMP_NTZ(o."block_timestamp" / 1000000) >= TO_DATE('2023-07-01')
GROUP BY o."transaction_hash"
HAVING COUNT(DISTINCT a.value) > 5
LIMIT 100
Answer:
Too long, hard cut:
transaction_hash,unique_addresses
40f0d67fa64f0335bbfcddbd9639852116abeca6a29f391fe154b992a6415528,6
ae71dcee2e4a570214f94cbe5155c055f7904053ea3abec30d4c808e84fb51f9,7
57f3d7e7ee3fec7f22edbdd851fdc4ba0bd88bc47dde5ee633caa65d68d9c51a,7
fce665171e1a99e5d1d7e6b5889bb196ac6b810f14a62cd79bd1ad730e6d8a64,7
8c405da57585b6571fb2963cb03ac2996fff593469289915e37a3c19f311f2cd,7
c9e6342824702f54f8fc7aedc115e85814689027171e5b44105d922fa5be1455,8
95d17bfb458cebfd5f176523e68d1cc2749d3794819e89805e148ebba4634301,6
8a4d0ec4c82856c1d7b086f389d55d8e5710a3a6f4f6bd769ccbf735bca71ed5,7
088869503df90841c88c83b34f7e1757c9c909530e6f8208e2f06fb43b7a02d4,6
2a3048b4c07380106c5adb48cb970570a0936cef0d6018da4a0086632d6f570f,7
116a5a2d8acbbcccf607e142dd158b74fa5609354c315b520ed39f55c52b5743,6
bb133f9eac7545946ef635f2afc5b5b13c49c70ef704bdc151d3df79a3093151,6
612d82869cf581b979e2ef9338379b1fe93a15cfa014716822fc0b831ccef951,6
21c7ff7c0c23a29bbb79f59918b42b067fe039553d78a450882b4b836bdbd7be,6
04e3bb21f0a3b28a8a87d7e3eac198e23920f296b2e1e29da69fc9c78df88f57,8
6ba93300c0f16ae032787c75f00bc5e0fbb0da2c3f6a89d65afb06839d9c46ee,6
7f5b78bcd97a3d0562c7e55a20d8e594c787c7abc83d9463614f50c5b22474cb,7
86cda71023cdebe1b8b3bab35928bad41e9913f6766b62be4ec903872a4e159f,6
d7e5b4ce4ef1a72bf012cadd0212fd996b5da5a5db4e3ec4d9cd93b7e56b6095,7
f13ea6725837135b86dfd6513b9bf5d7f6cc3e5a41bee1bfffef9ede4deb2428,8
8b2d48262a58d833a141c89cf72b736ce70d4f345859ed0e38a22b01bda48306,6
8e9e9d98474d49975462f011ea0b072a99d99ffa2224390abd8d173aaaab840e,7
0f8599a424a20b360e207cb97942876b05026417c36554f7ed1078461c71aa5a,6
7d97fe343fe44382c96339c4d960407727417223c337b00a41ff8e4726eca501,6
d885eab9f8ffd2573003e555884ba8eb2d524757ecea9c1af2c9d0fc387b513f,6
b9a69eb843461095dd8be2a74eed9664855a970bf1aa53dd1af25928b9ec5f1f,6
a7fa41709268493427df383cd56adc4d573b3d3c2e2e7479e6e5a107756d9742,6
25ce171a2d545961c0508dbe9929ccd7bb652ae6a641828c6d4c122955f75e78,7
618ea1ca9423b72cc0cdd6d93686ba0ac9156a9ab477647d1b95d17269f460d4,7
c8f8994d01fa6d090273b1868cac756d5263ed09e4cc9305c89d71bcd738d710,6
4edcb885f854f253d3fcdb40c96a172a843a627d94fded7bdca6861561047ebd,7
79b774a9425df770067b43d3158a69c0cfe3bdf3d80e0f8764919d943399254d,6
cdf96f3473a106bc29ef0d0cf63e080d47f4a47265e809f2d897b83533ed751b,6
e92e31245d90288ddb02b29284ebc016c85602684b2f225a417be7f7e8410fd7,6
120a3c1963c9b8275f2c66481c762984b67f8fc4fbc0d2cf40c485dd36d96fe4,6
3657da56c3cc2dc09d6ac4d98c1565ed50da45b18d3fd55c3e64b9f67cc52308,7
bbd86034103e647d26de6673e519ae3e84e79e804ff028dfc739ca1afcbf87c4,7
8ffaa98c590eb6e8fc21610c29edc30b414fc6b11435cf70cf19572291faea54,7
270e6984db298cba635c721fa446186b69d960d997511732bf39c780de28004b,8
eb2986f80c70cfaafb1c48716be30b1de08093cb2478ba549f53392e3a60b594,6
d4a13d85d2fafd446d9c7e4c07ebd8e9c5b08335285703065e514cf6f45767d0,6
b0bf6bb93158cc0714cbb34e197bf8936d258c3b9809b7f60d22785adb7cc58f,8
022fd00d0b45bd7d102017d3ee5c15ea7fe5a80a37a81fe992b2428876d0344b,9
b490fa5bea588e027c469b40c97846e7e9e6ffabeb579b9a514ec6a413515668,6
c7f86fb7b830124057475b282809f3474ef3565daa3de0b599980fb9e84ab019,7
49b15e1db620b6dea1db6766479ffcc84d6614ba3fe9687df7f37e7f7607f5fe,8
54834a16b2d7a84f977ab79470279afc57fb813141398845f968d9bb78644a43,6
84b81f25f0adb54442d432910823f15fc60d67a4ac1508bbb4f31c6e56aa4659,6
caab6f74e9741f48f4d6f4aadaef456b2b87648a68d8dfc8f9a77922e078371d,6
e6c8f4674ba07f6920a3240769346f70efcf68d55c9d73e606229d74414f5920,6
b395584b66fe00a83e5d85d4e25f5a2f16963b4e812d4539ef4b5071529880a5,6
6b2a72b6938313f0cb1a0276df788a0987671ea4551b7fb82c3e8b1bdc1abf2a,6
c9df45fa79e91d6c97b0ef0b77be2146c14d571a7f93adbfc7ea5399cdd5f16e,7
01683fc36c1a6b45d66b67d82bfa4c0ff719194090e60dbaf7fb597ad2a62705,6
7ba166bf1e6469a9ccd5b14b73e811a814c1c755ded22604ab3c71f082ac8a6b,6
f1270612c971485f4e3971920a3e635eff2ef4fc3d6ba70e6a00287415366a31,6
08c1e5111c887728e6908724e12fdc29c81083bd3551266b2a761c92c62f6a86,9
8cf72f8b899657879d47abfd288df1ab5fca5c50e11e3de021ef997f83f3bb7f,7
047fb0d0805d50ccb8bb3d95f0da5174e23f4a38f83a7d29a19a4077aea980e1,6
0721ed2e507a46530a8e332e8ff1a3c2912adefae903c647bba0ace89eeba42c,6
202a3280cd5ec1cacfbfa6d4bb370feca9d77baf80dcab967b58bd02b442382f,6
96dbf4c4e03d12d822d832c526e27b8c9359bb460b798c918007d194843b5f90,7
30eebbe549c4f31ec3cf8a1963a3236006b7c7173b36990d22d0832917b5b070,6
b103f5544401ae193c94c3d473d1d22924b04f0605ba77877282c6d925b625c0,6
d33a47709d3264184aa2018d56ead486bfe4b98e5527e978777c50d717a178f1,6
6226d602fa7fd882d1f150b588b3a8e17c5b087087a5f24e8bfe059c52c9853c,6
5a645fb3fd8cfe50ef2314b0df6dd97ace49779d207c9166d05a77f692d326f8,6
c2e113bbcf8e21ffd771f0f6d970fd879051a802321bf0a616cadba813c7acf5,6
f1cfa5f57c6d231d829e7f725fe08a64d1751f522a03c64f76e6cd86c423c390,6
ec72fcf1bba142af3bfa15a7ce898817542ca5b8d5546b01d869151ac793420a,6
d27e3a392417a61f24cbdedba63b078f2be402b6038a4b9af82a65a0c0ac6c69,6
1baf945d2f6f039138100669283a44d9ba379f9222e4ecc687e25d2ea32cb327,6
555b874da99e16ccd2dc400ea8239334499ee20cb9ccad935c3df5c222f9f80d,6
309e1e8283493653ff637e05b3a8a4fcf821180e6d09e731c17567d8348d421d,6
e31a40f4
Query:
SELECT "block_timestamp_month", SUM("input_value") AS "total_input_value"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100
Answer:
block_timestamp_month,total_input_value
2023-09-01,7295284812063.000000000
2023-10-01,6913060383233.000000000
Query:
SELECT "hash", "block_timestamp_month", "input_count", "output_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "input_count" = "output_count"
     AND "input_count" > 1
   LIMIT 100
Answer:
Too long, hard cut:
hash,block_timestamp_month,input_count,output_count
cb803aa1c598989f41e74775da9a1d77dba6bd773b2173b97b093d26cf237d5b,2023-09-01,2,2
867ef9c3f5588b8ea836d1ac89fa53f0b9e9e302fccb5a06a39ce5f23052e549,2023-10-01,2,2
7398112761788d28db60051fbd11804910413a7ea64a5d24f857ea341563f725,2023-10-01,2,2
aaac30a3c6fa5e8215acdece4d4a30e15d578fa6a75168c8cc20a61a0653cb54,2023-10-01,2,2
b356eab004943940f98118a4c3483869d71513356984a09a40e88b4aa2428d8b,2023-10-01,2,2
cf5105f43d2fb1c4b7f28085fd89c8db7946ead1b3799ccbacd6916dd6b34c4b,2023-10-01,2,2
1d966c68b0f540d165cead61e2760399c19198d6af14c89d2b9d3d32d43b80fd,2023-10-01,2,2
7ac188866d0148936b24060ef2ec73b9229b8cfc24973ee28fdb27465095db53,2023-10-01,2,2
9ee846302ab4a113f463163998cfd4dcad672e994543b9fcf2b4d61a1846a02c,2023-10-01,2,2
344be5155220e9ceb2258c78b9bda50a5ecb636df7fe59ee6310b659b79e8a2d,2023-10-01,2,2
a063a6d4a75d8c1cc4827792c4b01ef1c296a6feefdd2f7ee9b163956a78cf97,2023-10-01,2,2
3828e2e685d055eb322c1342998fd26b58980fb75545be3fa053d4c3a12eaa6c,2023-10-01,2,2
18058b96fc83285b05b34ab59d8d66aa1daed9640d1fe848160da26220cc475a,2023-10-01,2,2
522a7c8dc4ca3a08d05098ca0236cae9894d136cef5809df0e1ad70eaf9ca53b,2023-10-01,2,2
3b6b0b6c60e587a1d46633c7b113b2c5f66d92855c005defc405960f2b1894f3,2023-10-01,2,2
832430c8cb657508d5fec809d2b0cb1fcfffc7165efc6151c51155b66d211444,2023-10-01,2,2
0f72cd000041d15c9a410b4ef9e4b3b507bff68991d9334143cc353129bf3824,2023-10-01,2,2
2f6c1939233d56a962734a605b925c87afac82d2b6bb2b2800a99431080b07d1,2023-10-01,2,2
474408f4bea61543ef286fb4570de8648fca958f8032cc5c65d37e217498e0fb,2023-10-01,2,2
99d339624e97c5f00efdd45195afb5fe4e858817915cee4e8605e4e790236cbe,2023-10-01,2,2
9859476ea247148f415c3eb8f3cf8399a9a785a5f9264c8084b90352c317285f,2023-10-01,2,2
72a9b309479877bce35b43e626578a44538596920a09c93eb1d7e5da569bd89a,2023-09-01,2,2
af0591320481535f0cc4de17e4c75dd527e7f4b7d4c6aaf13ef417b70d808f9b,2023-09-01,2,2
d12da92425007cb03a406b51c74a8e5a7c48aacce61e2510f93b5d33ff0ed15d,2023-09-01,2,2
8d821e205400c908041c6ac843b606a43fbe67035213f48945415ba7d078f56c,2023-09-01,2,2
b1359feb67309837e73851787d3f82e3ad348d985990b7cc70377a4c130e0096,2023-09-01,2,2
0bbd341124616794034f0d40051852c5375d89ab029885119d853c26eb2421b7,2023-09-01,2,2
d2198e9e796682beb4727913037dc906d7d5ce2082aaf0096d09f8c36c7f5dde,2023-09-01,2,2
58cf22886b6397a58e0fe6abe85e0a70adbd460df0a0b6ebaaf6cd212c94d843,2023-09-01,2,2
8404eaa377413d952898fb7f08d759a686eaba3381c1dd48564e32ca98f1868c,2023-09-01,2,2
61d264a70d151ba7db3c562399a43a4f0a72c48458a09ca7f0179b1b23753756,2023-09-01,2,2
80e20045fb2e3472b84ae86bb2f201bbc4d93492f98c6796f13d6abd9cc3537c,2023-09-01,2,2
3947cdfe7afeee3f7e0a61e3da5061a9b476500c6b85606a7194a57c794ca58f,2023-09-01,2,2
e814950bce8655050d08c90bec7a05308779778171fa475981a62a177beb9ec1,2023-09-01,2,2
7e61c786160242d400b338df9ddd3a22a4b787c0b4eb861ece491e3a3318fe4d,2023-09-01,2,2
d8de4956ae0b71107a0a2a288e79616b1baf0bec727cb276d5314b30e02a9fc4,2023-09-01,2,2
a53c2bb03a7f9d546e4459a8745ddcab62ef853c6bc863fd5751ca0e740f0144,2023-09-01,2,2
4b3b89af38063aec9beca98a094e9926d7c0a37e0d7586a8def90624b733e9d0,2023-09-01,2,2
fb2edd310c8e715084b33ac1ca51fb5b7dfb65e21d7936315ae8081015ae1ed5,2023-10-01,2,2
6567b8e7b4ed5e58b020ba13c5dc27856f7ea57fec537a0ed026e5a68bd88608,2023-10-01,2,2
9a3b66da30870b98f666fcf4dbed61d129a67808ac1deeade38470238938093c,2023-10-01,2,2
e1cfb8a1dc1dcd3cc1564aece27e892b3633de3493fa046f560377541ceb19db,2023-10-01,2,2
9edee90c49c16e0fc2f1aac3abc0889a148f8b8753943f50365e1213934284ef,2023-10-01,2,2
77b13921dcf281b4fc8fde80255d82d779a7645db80e5fad761d58118b9575f0,2023-10-01,2,2
7494f719385fea022f9a443d8e82de6fe10a27ffde4d60b16b3fda551a2b8927,2023-10-01,2,2
10881c20727dbbf6ae95503348b7a7627b22113f5c2dbf2b616f701aa7300ade,2023-10-01,2,2
b2d8f420d5a6955b371724511b164632b52ed6f9789554131c29a8a7dc0743b9,2023-10-01,2,2
1827a7720e0a620b8941cae0db71748e329fb111d1e7885f08e2ebdccbcd46c1,2023-10-01,2,2
c40fea3f8587b78b7e624affd717931924a374ea0828ed46de70069eb179487a,2023-10-01,2,2
fef88267e54bc80af90354b3bc4954706a529604c669309543de674ee3a5b555,2023-10-01,2,2
a317c46e7c120196781e4e7dfd2f6f22b662f3eb8eff247925776138c6290216,2023-10-01,2,2
61e1072a748bfbcb24194c90a1f1967f296a8be7f3c7e5c34b172ea803f308b5,2023-10-01,2,2
dc449cb48460f896fd65c9ec0034d402f6d5531762a2fa9989eb431677d0013d,2023-10-01,2,2
e260716622ff9466979fea0b3a8cf402065b60d23742149d4098cf3f22126b0c,2023-10-01,2,2
44c105999521445fa7c713f756b9074beb68fb2cb6e344dfc59e3cbc82f5ff88,2023-10-01,2,2
10bae0d53c8bfd3522d31a3c79f20f63afe55d8b4e49105287dab08151c76760,2023-10-01,2,2
1e81a805a1ef7422983d5bf8b3cf40500320d3059b25d55d1a93997b88c7227b,2023-10-01,2,2
8df22d9d6e4ecd33e612fe34f08203f327522bdbd5a3faae205892259a81d863,2023-10-01,2,2
84d23c2cde873387e1d042920e02d01f96c5bef65c9ea86f6548f108cd9f9fe4,2023-10-01,2,2
534a4dccd8b7e991f24135c9b736485e7213d65387fef893ee8e3d186861fb50,2023-10-01,2,2
4da846e112b40b729df5754b0ac2053bad3a30ccc3360c06d0ba73d659665a1b,2023-10-01,3,3
a35f834e2bead1cdc07f4a2d51d1522a780ec5b7ff9a769acaba615b4b3a8bfb,202
Query:
SELECT "hash", "block_timestamp_month", "fee"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
     AND "fee" > 0.001
   ORDER BY "fee" DESC
   LIMIT 100
Answer:
Too long, hard cut:
hash,block_timestamp_month,fee
0cdefc039f264fe9aed0808486f4933d3fbeb80ff0ff1aa6ba2d5a32e0431b20,2023-09-01,2391998.000000000
c745c42377f09907af2132b4c97a1574b71c3ffe611f5445df2833b0d178df08,2023-09-01,2391998.000000000
5d21e5b8866481d2a5effc4c0d9ef27243e3b6a3d2feb0d02b4aa3c7dd07f1a2,2023-09-01,1879324.000000000
d2e0057f12a1b5533e37a22199461bbe70f0f9c40586d05d21a0c1cfdc0a4c27,2023-09-01,1765700.000000000
b18358385e13b6234bdab341d8c08887a028cde63b02f8525cbbba0a4729c827,2023-09-01,1749990.000000000
9185cf697fe295db7fa9093a4aa3eb920c310b934a1ff4cd85807e21bc89fbeb,2023-09-01,1646153.000000000
9cc9907409c1b05d1116eeadf205e31cdbbbc00c509eaebb81c389762bfe4523,2023-09-01,1644600.000000000
8f55d2e572f7537a82da04f6e4e653941a7e75364c13e02141dc9cc29c13ebc2,2023-09-01,1606785.000000000
1f3ea6e88b6b9914f76286a30dd18478fa507ae0b5b560f0f6b45447a92fe588,2023-09-01,1598089.000000000
40255dc487de043267239c07c214498db067624868a31434b5df773ed05facc9,2023-09-01,1488158.000000000
14ad53ae455da46a59db1c59e753a4619f5dc985f98c3f059b7c537ef1cef54f,2023-09-01,1394251.000000000
3eb492680c174b244faf5f08ff09acd3660afd91c10f5f6337a4c36efc8770fc,2023-10-01,1368136.000000000
cb715454174ef0b7f6e5c503c1d17a513933e2eed70a12e1d63806aa83f8932c,2023-10-01,1361920.000000000
f4c3b0e07481108ab3852352c464dc2c73733f063afb4044d5e6068559906282,2023-10-01,1359848.000000000
e1a3508489c2f3f923c151be0c28a965ee44cf38ecc93e4164adf0f609ce886f,2023-10-01,1351560.000000000
a23f04e17e21e757b1d6477ff8b81b97dbfddc6952e0d72d13d9b2f6c63c2ded,2023-10-01,1351560.000000000
1503ac9564b0665886e2b31954d162ec5abbe8d10f6bdcac9de499cf2c0c5c38,2023-10-01,1349488.000000000
b21552d0a32196b48419343dc9f6be2b88cf6e227e5370ed8c4e5dcc78fb707a,2023-10-01,1347416.000000000
c7eb11fb4255894396868e51e1585066e5c285d99c9949fc96e4e1edb341b2fa,2023-10-01,1347416.000000000
6175500c92c347780ebac8586fe2ae357e6209f8bd3d7289575000e31460c09b,2023-10-01,1328768.000000000
0071703ca909aab4678704c86de5ae2507745d36c4bc3becf68099ed6160cfef,2023-09-01,1305463.000000000
92e534eb80a92249650ae497b477f9196ed3e81daadced4d7def98a7588870f9,2023-09-01,1214100.000000000
2aa3ba2177c17d22bbf6e20344a2da79fa90b7bc3da0224eb83a16f8b19fc96d,2023-09-01,1206642.000000000
cd91ac62d9daf12dc915844e04bd660899769420332891f818fea1e9e72dada9,2023-10-01,1205913.000000000
38498eae52c575e78ab754a5dd23a9fa6d0d52fbd0bbab2ef205b9ccfa75dee4,2023-09-01,1144110.000000000
efe1ea2d296352cad149c287da628733fcf29b9cb9192578f0f76c7d1dd1831f,2023-10-01,1065498.000000000
115b345dfe278b831a83fabe08583d3d7c04cd88c0caff91efc19cac8fc2b70c,2023-09-01,1045900.000000000
63b8363fd0c08c44c7cac089bbc047d824f1d41b686f9d9aff5f3abab4fc61da,2023-09-01,1017233.000000000
b1af44e81e87a55b323232ee9bbcfa7334bfe68505ed953645c11535c22e36c6,2023-09-01,992400.000000000
861926a31a2b321847d00d80b0290d0d4e9cc14893764bee38b326774af1d8a5,2023-09-01,991990.000000000
7835d3d478ec9429c0ea6ff3f05c767495f964b400321a554f3bb32383b53988,2023-10-01,984888.000000000
8bbb1dd6fbcc8c27bd691a034b97312baa4b40eb00442690602784a501634da1,2023-09-01,983400.000000000
f7c56101ba4b19b9b493a96d928af75d0e2e893f3bdd7eaf8a8ecc71b5396915,2023-09-01,977604.000000000
54fb635d39841877caabcfe93bc20ce2adca77eef893e6389df614378dff6309,2023-09-01,962485.000000000
d83051a35a0518b8e3c610648734b2492de80ce955578d8fccdd2caee26a2273,2023-09-01,948926.000000000
cb928fbbe46f7239665dee615bd7156fd9537abb9d576e827e31303a78d87b66,2023-09-01,929916.000000000
525e9b762dcc9c8a60de97063994ac0555aa6997ec23283901edc2bb4569dc38,2023-09-01,922635.000000000
104f1c9e7c18b49521df5e65afe232e8e4c3fb5ff27621d308765630f3c3325a,2023-09-01,911025.000000000
1a36e006085fefc5989ae4e479ce39dbf8229b352029bdb20c5f9e16bdefc3d3,2023-10-01,910445.000000000
e61962b57f83227c0927c8687f2568aac343f5a882b3300054147c05b34a3be9,2023-10-01,885144.000000000
7c94399d419f5b9dec3db3b6abd04fd87e5e4ce536a95178d93a7a6b9229e005,2023-09-01,881640.000000000
10fb48f4403e4019812272565cbf50256b1ef5911adbfc64641370ac8fa2df16,2023-09-01,853342.000000000
56be541675da4ded970749bc62d314dec39b757460d6e0d48dc679e10071839f,2023-10-01,851100.000000000
8a1e2d9033a759babac786f867172fa2e0bd4c79293a778c9803ae92ef79f26f,2023-10-01,851100.000000000
4cce01b1d87af12fe0be7dd2987056487569881acc131e8eb9ee532faca533df,2023-10-01,851100.000000000
58377946a75a9ddc869f42b997683cb7079b33a1ea447cd9125bba4a79ca13de,2023-10-01,851100.000000000
2a92edbe84aa28dc41b212680e273ac50e8c75e2c7c82fde8c2b451524684653,2023-10-01,851100.000000000
641360b1325636d951956d2b11c46e0faa364afac5cb5992ed5a6d640a689d0d,2023-09-01,784720.000000000
fcff284c6374f8efc37325ba7d66c4b3aa5c4edcadb9a6ee2679b9dc336317d0,2023-09-01,758801.000000000
8f2491225be0c8ce365136e8e4091e750bc4d163812a8600526bfe3ffa5028c4,2023-09-01,726867.000000000
c79d5e1c4625d5f12e50c09a0fc8574f6d48f547d270f692065da786bd902d7e,2023-09-01,720573.000000000
9eeb3278267e0afda400175ee7e8f99b9cb8eb7df130b14e688825279257a475,2023-09-01,715320.000000000
2052c7d57fcfc653294a3bfd318afe5462a1f32cc3d151d0503265a392944628,2023-09-01,687036.000000000
2fd7c1484599
Query:
SELECT "block_timestamp_month", AVG("fee") AS "average_fee"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   GROUP BY "block_timestamp_month"
   ORDER BY "block_timestamp_month"
   LIMIT 100
Answer:
block_timestamp_month,average_fee
2023-09-01,9705.750327318267
2023-10-01,7012.582988690847
Query:
SELECT t."hash", t."block_timestamp_month"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
   WHERE t."block_timestamp_month" >= '2023-07-01'
     AND t."input_value" = t."output_value"
   LIMIT 100
Answer:
hash,block_timestamp_month
39cb49a47a2f2d2e9987c8c4aa0d6927fd3c748873cec47bc79294cfdac20204,2023-09-01
4ecfc5fd0e22e39007232b6ec875fcc39d930148032c3409b94dc7008e810890,2023-10-01
Query:
SELECT "hash", "block_timestamp_month", "input_count"
   FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
   WHERE "block_timestamp_month" >= '2023-07-01'
   ORDER BY "input_count" DESC
   LIMIT 100
Answer:
Too long, hard cut:
hash,block_timestamp_month,input_count
d59f3bc4fd605cd58b0386165863d2f1bc22c9126e937bf64de87db6ae6ccb2e,2023-10-01,1428
b66bd61c4924114cc90df69760bf9a4a634109a1dd42c5b87d670395e481e568,2023-10-01,1331
296bb9904f7ea772387a7c9402c809b824413b9236265ea5f3b3678dea81e48c,2023-10-01,1020
9336803419a5eb0249585d3036f1e1c32cae5119514f965d4b11923fdc877e78,2023-09-01,1000
4a96ea2ff8cc55fa1a024fc2cbd140b9dcbdd3ff53445644b8bed26c245cca79,2023-10-01,824
6edcf8f1830920bb06a0dfbfc614da6ce4de4dfe79ae6a5285609bcdd3a6fc82,2023-10-01,824
7835d3d478ec9429c0ea6ff3f05c767495f964b400321a554f3bb32383b53988,2023-10-01,802
efe1ea2d296352cad149c287da628733fcf29b9cb9192578f0f76c7d1dd1831f,2023-10-01,745
10fb48f4403e4019812272565cbf50256b1ef5911adbfc64641370ac8fa2df16,2023-09-01,669
3eb492680c174b244faf5f08ff09acd3660afd91c10f5f6337a4c36efc8770fc,2023-10-01,660
cb715454174ef0b7f6e5c503c1d17a513933e2eed70a12e1d63806aa83f8932c,2023-10-01,657
f4c3b0e07481108ab3852352c464dc2c73733f063afb4044d5e6068559906282,2023-10-01,656
e1a3508489c2f3f923c151be0c28a965ee44cf38ecc93e4164adf0f609ce886f,2023-10-01,652
a23f04e17e21e757b1d6477ff8b81b97dbfddc6952e0d72d13d9b2f6c63c2ded,2023-10-01,652
1503ac9564b0665886e2b31954d162ec5abbe8d10f6bdcac9de499cf2c0c5c38,2023-10-01,651
1f3ea6e88b6b9914f76286a30dd18478fa507ae0b5b560f0f6b45447a92fe588,2023-09-01,651
b21552d0a32196b48419343dc9f6be2b88cf6e227e5370ed8c4e5dcc78fb707a,2023-10-01,650
c7eb11fb4255894396868e51e1585066e5c285d99c9949fc96e4e1edb341b2fa,2023-10-01,650
6175500c92c347780ebac8586fe2ae357e6209f8bd3d7289575000e31460c09b,2023-10-01,641
0d0e0d2c6cba8455185078fe45320b07a925729c6d22bd9201941818f39a806f,2023-09-01,600
2fd7c1484599fbd4ad2e399daba6e1ac589fd3aa6c34d36974e5719be8277f02,2023-09-01,600
ab88fe06bc447d1f20171fd07a8ad4ad40e8b07dc9836019aca8d60db393ad35,2023-09-01,600
4cabc3c15c7f71bf5d80262973ab58fc146fa213b700eb045c2b05957a35dad8,2023-09-01,600
eb6f7482080a65cc765b06a72cebbffcb745c1648f3c76501d1c48b88fa69798,2023-09-01,600
044e6108066b97db7c1fcb158ac8cc634ed65d9774b3abce1dc755dd007b9fde,2023-09-01,600
a1765a52a98bcd58e0d168a101bd632b8a7e56d7a1ea36f2bb56d5de5d331186,2023-09-01,600
cd91ac62d9daf12dc915844e04bd660899769420332891f818fea1e9e72dada9,2023-10-01,600
6910753d5ddebc26dfa932660e0dd2d975c64d4b4011ea9c009a59744a11d7f1,2023-09-01,600
0e5cb9c6339b41236c8d144bca3bd8ef7bdf2cf5b8db424f30fa5f9ad557c6cd,2023-09-01,575
38498eae52c575e78ab754a5dd23a9fa6d0d52fbd0bbab2ef205b9ccfa75dee4,2023-09-01,518
14ad53ae455da46a59db1c59e753a4619f5dc985f98c3f059b7c537ef1cef54f,2023-09-01,504
121b4233bf332f28ba313ed7a1a94a175743119ed3dfdcfc98ad7f907f462634,2023-10-01,500
1dc90e19f3b1e7aa2510a52dc35e2e8ac23dbaa2cf7d191788030a1fdf1eb5e8,2023-10-01,500
58377946a75a9ddc869f42b997683cb7079b33a1ea447cd9125bba4a79ca13de,2023-10-01,500
49a98ad8a684a91e77cd5d37a2097357b6b9f16b0b626fcdbb1a3fd51df8d3f4,2023-10-01,500
1a36e006085fefc5989ae4e479ce39dbf8229b352029bdb20c5f9e16bdefc3d3,2023-10-01,500
96a42e16c42053753e2c6300a39d71eb98bb80c798a58d57b7ec565afd292311,2023-10-01,500
e61962b57f83227c0927c8687f2568aac343f5a882b3300054147c05b34a3be9,2023-10-01,500
68655a5f7035f1637ce5939a72d859a26f2d129c4bfc1d75b958b5028f76999d,2023-10-01,500
f85c87413ebb37082845fe65b319971aee11e45cc78c691c8ab40061bc313c21,2023-10-01,500
d0fce73d1a775fce3e3242543b91dedb4b40134d4e9ddd238e59793cddb3a545,2023-10-01,500
a40a4e71acb498e9bc89959dc345ad8c0ed6d024679beff3f60f8e645106c71f,2023-10-01,500
c0ecb4cf9ae9ee185765191ea4d831abafffbad80df4499ab0a2fe1a6b23f927,2023-10-01,500
8d01ef95cde4991c796c583c2e88fe4414691fa57cfc0faabc72a28c12dfb3e9,2023-10-01,500
8a1e2d9033a759babac786f867172fa2e0bd4c79293a778c9803ae92ef79f26f,2023-10-01,500
54fb635d39841877caabcfe93bc20ce2adca77eef893e6389df614378dff6309,2023-09-01,500
4cce01b1d87af12fe0be7dd2987056487569881acc131e8eb9ee532faca533df,2023-10-01,500
dd3678253a799f396e182f0b7122aa784b16a60dbc6306dc9a790c9786515db3,2023-10-01,500
2a92edbe84aa28dc41b212680e273ac50e8c75e2c7c82fde8c2b451524684653,2023-10-01,500
56be541675da4ded970749bc62d314dec39b757460d6e0d48dc679e10071839f,2023-10-01,500
a61e3a2f9e1e681c7aa9fd332e08682fd1cd3eee9bd5980902ba3f472b5410d3,2023-10-01,500
5c2ba606d0b2be7d146df9469bbc08b7023fe60f14ac4bbb6271f52e9c42f0e0,2023-10-01,500
6eda39cef63ef9debfdc698da0214e23347ebc8522f3994eb94a1d561d615cd7,2023-10-01,500
155bfdc0ad27330f55ac067d81385bf550b0a9cbf6e4ebde85632cd519b6b574,2023-10-01,500
f86ac4ba55193f8ca0cb103f9d43ca28ea345552a39903e9789bc4248466848b,2023-10-01,500
40255dc487de043267239c07c214498db067624868a31434b5df773ed05facc9,2023-09-01,490
7953a95aac3be12b5635e8ab17c9d352310e03c0ca97a936711fc21a5bcc17fb,2023-10-01,420
6c3e1b952b4b2f73ec583e7c9a8648360dbf0ff29def2f339a2329296ae239a0,2023-10-01,413
f7c56101ba4b19b9b493a96d928af75d0e2e893f3bdd7eaf8a8ecc71b5396915,2023-09-01,350
cb928fbbe46f7239665dee615bd7156fd9537abb9d576e827e31303a78d87b66,2023-09-01,350
9eeb3278267e0afda400175ee7e8f99b9cb8eb7df130b14e688825279257a475,2023-09-01,350
9a9f9f43d9e7e49f2939f65a8d76ec85ea791b74690ab2300a6d41b2e4a26aa4,2023-10-01,3
End Exploring Related Columns
Task: Please analyse the monthly aggregated statistics and percentages of potential CoinJoin transactions within the Bitcoin network since July 1, 2023 as below. How much percent of monthly Bitcoin txs that were CoinJoins and what about the Bitcoin utxos? Also please show me the percent of monthly Bitcoin volume that took place in CoinJoined transactions.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Month,Percentage_of_CoinJoin_Transactions,Percentage_of_CoinJoin_UTXOs,Percentage_of_CoinJoin_Volume
Jul-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Aug-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Sep-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Oct-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
```

**Explanation:**

This table provides the monthly aggregated statistics and percentages of potential CoinJoin transactions within the Bitcoin network since July 1, 2023. For each month from July to October 2023, the table includes:

- **Percentage_of_CoinJoin_Transactions**: The percentage of Bitcoin transactions that were identified as potential CoinJoin transactions during the month.

- **Percentage_of_CoinJoin_UTXOs**: The percentage of Bitcoin UTXOs involved in CoinJoin transactions during the month.

- **Percentage_of_CoinJoin_Volume**: The percentage of the total Bitcoin transaction volume that took place in CoinJoin transactions during the month.

Please note that the percentages are placeholders represented as `pct_transactions:0<=float<=100`, indicating that the actual values are floats between 0 and 100..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CRYPTO': {'CRYPTO_BAND': ['BLOCKS', 'BLOCK_EVENTS', 'ERRORS', 'LOGS', 'MESSAGES', 'ORACLE_REQUESTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN_CASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_DASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM': ['BLOCKS', 'CONTRACTS', 'LOGS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM_CLASSIC': ['BALANCES', 'BLOCKS', 'CONTRACTS', 'LOGS', 'TOKENS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ZILLIQA': ['DS_BLOCKS', 'EVENT_LOGS', 'EXCEPTIONS', 'TRANSACTIONS', 'TRANSITIONS', 'TX_BLOCKS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 01:28:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:28:36 - root - INFO - ```sql
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash", t."input_count", t."output_count"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        COUNT(*) = t."output_count" AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    Month,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN 1 ELSE 0 END) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;
```
2025-01-26 01:28:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:28:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:28:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:28:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:28:37 - snowflake.connector.connection - INFO - closed
2025-01-26 01:28:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:28:38 - root - INFO - itercount: 1
2025-01-26 01:28:38 - root - INFO - 0
2025-01-26 01:28:38 - root - INFO - results: 
MONTH,PERCENTAGE_OF_COINJOIN_TRANSACTIONS,PERCENTAGE_OF_COINJOIN_UTXOS,PERCENTAGE_OF_COINJOIN_VOLUME
2023-09-01,0.0000,0.0000,0.0000
2023-10-01,0.0000,0.0000,0.0000


2025-01-26 01:28:38 - root - INFO - Please check the answer again by reviewing Please analyse the monthly aggregated statistics and percentages of potential CoinJoin transactions within the Bitcoin network since July 1, 2023 as below. How much percent of monthly Bitcoin txs that were CoinJoins and what about the Bitcoin utxos? Also please show me the percent of monthly Bitcoin volume that took place in CoinJoined transactions., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Month,Percentage_of_CoinJoin_Transactions,Percentage_of_CoinJoin_UTXOs,Percentage_of_CoinJoin_Volume
Jul-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Aug-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Sep-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Oct-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
```

**Explanation:**

This table provides the monthly aggregated statistics and percentages of potential CoinJoin transactions within the Bitcoin network since July 1, 2023. For each month from July to October 2023, the table includes:

- **Percentage_of_CoinJoin_Transactions**: The percentage of Bitcoin transactions that were identified as potential CoinJoin transactions during the month.

- **Percentage_of_CoinJoin_UTXOs**: The percentage of Bitcoin UTXOs involved in CoinJoin transactions during the month.

- **Percentage_of_CoinJoin_Volume**: The percentage of the total Bitcoin transaction volume that took place in CoinJoin transactions during the month.

Please note that the percentages are placeholders represented as `pct_transactions:0<=float<=100`, indicating that the actual values are floats between 0 and 100. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
MONTH,PERCENTAGE_OF_COINJOIN_TRANSACTIONS,PERCENTAGE_OF_COINJOIN_UTXOS,PERCENTAGE_OF_COINJOIN_VOLUME
2023-09-01,0.0000,0.0000,0.0000
2023-10-01,0.0000,0.0000,0.0000
Current sql:
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash", t."input_count", t."output_count"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        COUNT(*) = t."output_count" AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    Month,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN 1 ELSE 0 END) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;Empty results in Column ['PERCENTAGE_OF_COINJOIN_TRANSACTIONS', 'PERCENTAGE_OF_COINJOIN_UTXOS', 'PERCENTAGE_OF_COINJOIN_VOLUME']. Please correct them.

2025-01-26 01:29:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:29:13 - root - INFO - ```sql
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    TO_CHAR(Month, 'Mon-YYYY') AS Month,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN 1 ELSE 0 END) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;
```
2025-01-26 01:29:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:29:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:29:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:29:14 - snowflake.connector.connection - INFO - closed
2025-01-26 01:29:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:29:14 - root - INFO - itercount: 2
2025-01-26 01:29:14 - root - INFO - 000979 (42601): 01b9f599-0004-82df-0001-11c300fa8ef2: SQL compilation error:
[SYS_VW."input_count_1"] is not a valid group by expression
2025-01-26 01:29:14 - root - INFO - Input sql:
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    TO_CHAR(Month, 'Mon-YYYY') AS Month,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN 1 ELSE 0 END) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;
The error information is:
000979 (42601): 01b9f599-0004-82df-0001-11c300fa8ef2: SQL compilation error:
[SYS_VW."input_count_1"] is not a valid group by expression
Please correct it and output only 1 complete SQL query.
2025-01-26 01:29:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:29:50 - root - INFO - ```sql
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash", t."input_count", t."output_count"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    TO_CHAR(Month, 'Mon-YYYY') AS Month,
    ROUND((SUM(is_coinjoin) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;
```
2025-01-26 01:29:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:29:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:29:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:29:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:29:52 - snowflake.connector.connection - INFO - closed
2025-01-26 01:29:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:29:52 - root - INFO - itercount: 3
2025-01-26 01:29:52 - root - INFO - 0
2025-01-26 01:29:52 - root - INFO - results: 
MONTH,PERCENTAGE_OF_COINJOIN_TRANSACTIONS,PERCENTAGE_OF_COINJOIN_UTXOS,PERCENTAGE_OF_COINJOIN_VOLUME
Oct-2023,0.0403,1.8443,0.2208
Sep-2023,0.0114,0.8206,0.0357


2025-01-26 01:29:52 - root - INFO - Please check the answer again by reviewing Please analyse the monthly aggregated statistics and percentages of potential CoinJoin transactions within the Bitcoin network since July 1, 2023 as below. How much percent of monthly Bitcoin txs that were CoinJoins and what about the Bitcoin utxos? Also please show me the percent of monthly Bitcoin volume that took place in CoinJoined transactions., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Month,Percentage_of_CoinJoin_Transactions,Percentage_of_CoinJoin_UTXOs,Percentage_of_CoinJoin_Volume
Jul-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Aug-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Sep-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
Oct-2023,pct_transactions:0<=float<=100,pct_utxos:0<=float<=100,pct_volume:0<=float<=100
```

**Explanation:**

This table provides the monthly aggregated statistics and percentages of potential CoinJoin transactions within the Bitcoin network since July 1, 2023. For each month from July to October 2023, the table includes:

- **Percentage_of_CoinJoin_Transactions**: The percentage of Bitcoin transactions that were identified as potential CoinJoin transactions during the month.

- **Percentage_of_CoinJoin_UTXOs**: The percentage of Bitcoin UTXOs involved in CoinJoin transactions during the month.

- **Percentage_of_CoinJoin_Volume**: The percentage of the total Bitcoin transaction volume that took place in CoinJoin transactions during the month.

Please note that the percentages are placeholders represented as `pct_transactions:0<=float<=100`, indicating that the actual values are floats between 0 and 100. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
MONTH,PERCENTAGE_OF_COINJOIN_TRANSACTIONS,PERCENTAGE_OF_COINJOIN_UTXOS,PERCENTAGE_OF_COINJOIN_VOLUME
Oct-2023,0.0403,1.8443,0.2208
Sep-2023,0.0114,0.8206,0.0357
Current sql:
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash", t."input_count", t."output_count"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    TO_CHAR(Month, 'Mon-YYYY') AS Month,
    ROUND((SUM(is_coinjoin) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;
2025-01-26 01:30:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 01:30:22 - root - INFO - ```sql
WITH
-- Transactions since July 1, 2023
txns AS (
    SELECT
        t."hash",
        t."block_timestamp_month" AS Month,
        t."input_count",
        t."output_count",
        t."input_value",
        t."output_value"
    FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS" t
    WHERE t."block_timestamp_month" >= '2023-07-01'
),

-- CoinJoin transactions
coinjoin_txns AS (
    SELECT
        t."hash"
    FROM txns t
    JOIN "CRYPTO"."CRYPTO_BITCOIN"."OUTPUTS" o ON t."hash" = o."transaction_hash"
    GROUP BY t."hash", t."input_count", t."output_count"
    HAVING
        t."input_count" >= 5 AND
        t."output_count" >= 5 AND
        MIN(o."value") = MAX(o."value")
),

-- Annotate transactions with CoinJoin flag
annotated_txns AS (
    SELECT
        t.*,
        CASE WHEN cj."hash" IS NOT NULL THEN 1 ELSE 0 END AS is_coinjoin
    FROM txns t
    LEFT JOIN coinjoin_txns cj ON t."hash" = cj."hash"
)

-- Calculate percentages per month
SELECT
    TO_CHAR(Month, 'Mon-YYYY') AS Month,
    ROUND((SUM(is_coinjoin) * 100.0) / COUNT(*), 4) AS Percentage_of_CoinJoin_Transactions,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_count" ELSE 0 END) * 100.0) / SUM("output_count"), 4) AS Percentage_of_CoinJoin_UTXOs,
    ROUND((SUM(CASE WHEN is_coinjoin = 1 THEN "output_value" ELSE 0 END) * 100.0) / SUM("output_value"), 4) AS Percentage_of_CoinJoin_Volume
FROM annotated_txns
GROUP BY Month
ORDER BY Month;
```
2025-01-26 01:30:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 01:30:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 01:30:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 01:30:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-26 01:30:24 - snowflake.connector.connection - INFO - closed
2025-01-26 01:30:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 01:30:24 - root - INFO - itercount: 4
2025-01-26 01:30:24 - root - INFO - 0
2025-01-26 01:30:24 - root - INFO - Total iteration counts: 4
