2025-01-20 05:17:29 - openai._base_client - INFO - Retrying request to /chat/completions in 0.418142 seconds
2025-01-20 05:18:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 05:18:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:18:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:18:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:18:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-20 05:18:34 - snowflake.connector.connection - INFO - closed
2025-01-20 05:18:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:18:34 - root - INFO - SQL:
-- 1. List all distinct states in the dataset.
SELECT DISTINCT "nppes_provider_state"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
LIMIT 1000;
Results:
nppes_provider_state
WI
AA
NY
TX
AE
DE
NM
MO
AR
WY
RI
MA
MP
WV
OK
SD
ID
NH
PR
NC
AL
VA
IN
AK
CT
NJ
MI
TN
CO
NE
IA
DC
OH
IL
MT
KS
LA
ME
GU
UT
AS
NV
SC
OR
PA
MD
FL
CA
GA
AZ
ND
ZZ
WA
HI
KY
AP
VT
MN
XX
MS
VI

2025-01-20 05:18:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:18:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:18:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:18:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:18:35 - snowflake.connector.connection - INFO - closed
2025-01-20 05:18:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:18:36 - root - INFO - SQL:
-- 2. Retrieve all distinct drug names prescribed in New York State.
SELECT DISTINCT "drug_name"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
LIMIT 1000;
Results:
Too long, hard cut:
drug_name
ECONAZOLE NITRATE
TRAMADOL HCL-ACETAMINOPHEN
ZETIA
DUREZOL
LANTUS SOLOSTAR
GALANTAMINE HBR
GEMFIBROZIL
DOXEPIN HCL
LANTUS
TOPROL XL
HALOBETASOL PROPIONATE
TRAVOPROST
AMPICILLIN TRIHYDRATE
PEN NEEDLES
GATIFLOXACIN
FLUNISOLIDE
POLYMYXIN B SUL-TRIMETHOPRIM
PERPHENAZINE
DILANTIN
CILOSTAZOL
ORPHENADRINE CITRATE
ADCIRCA
BCG VACCINE (TICE STRAIN)
FENOGLIDE
NITROLINGUAL
TEKAMLO
LUXIQ
PREDNICARBATE
TRUEPLUS INSULIN SYRINGE
TYGACIL
OXANDROLONE
LEVOXYL
SYMLINPEN 120
TRI-PREVIFEM
ORSYTHIA
OSMOPREP
EVOXAC
ADAPALENE
ZELAPAR
ACETIC ACID-ALUMINUM
E.E.S. 200
CORTISPORIN
TREXALL
FYCOMPA
ALDACTAZIDE
VINORELBINE TARTRATE
NORTHERA
TRIBENZOR
LYRICA
TIKOSYN
NYSTATIN
K-TAB ER
METHOCARBAMOL
CORTISONE ACETATE
GLUCOPHAGE
METAXALONE
ATRIPLA
HYDROCORTISONE-ACETIC ACID
PROTRIPTYLINE HCL
ACITRETIN
ALVESCO
ULTICARE
OPIUM TINCTURE
OPSUMIT
ERYPED 200
1ST TIER UNIFINE PENTIPS
HALDOL DECANOATE 100
TENIVAC
CAYSTON
PRANDIMET
FIRAZYR
INTERMEZZO
KENALOG-40
GAMMAKED
LACTATED RINGERS
VECTIBIX
HALFLYTELY-BISACODYL
DUETACT
PIROXICAM
METOCLOPRAMIDE HCL
PERMETHRIN
ULORIC
SINGULAIR
RISPERIDONE ODT
PHENOBARBITAL
ASCOMP WITH CODEINE
GILOTRIF
ZAFIRLUKAST
NICOTROL
JENTADUETO
SOLARAZE
ABILIFY MAINTENA
PREVIDENT 5000 PLUS
COSOPT
TIVICAY
FLUOCINONIDE
XGEVA
ERGOLOID MESYLATES
GLUCAGON EMERGENCY KIT
DENTAGEL
NORA-BE
MS CONTIN
KELNOR 1-35
TOBRAMYCIN SULFATE
INNOPRAN XL
SULFADIAZINE
LEUKINE
ENTOCORT EC
ALBUMINAR-25
PRECOSE
ANZEMET
ABILIFY
COMBIVENT RESPIMAT
RANITIDINE HCL
RANEXA
TEKTURNA
DILTIAZEM HCL
AMLODIPINE BESYLATE-BENAZEPRIL
PRINIVIL
BUTALB-CAFF-ACETAMINOPH-CODEIN
BROMOCRIPTINE MESYLATE
ATROPINE SULFATE
PULMICORT
RELISTOR
NIACOR
APIDRA SOLOSTAR
AMBISOME
LAMICTAL
ZEGERID
EASY TOUCH
CYCLOSPORINE MODIFIED
AMLODIPINE-VALSARTAN
QUINIDINE GLUCONATE
PACLITAXEL
ARAVA
GILENYA
PHENYTEK
DIDANOSINE
EURAX
CYSTADANE
LORTAB
STAXYN
DIAMOX SEQUELS
MIACALCIN
BETAPACE
CARIMUNE NF NANOFILTERED
AMTURNIDE
LESCOL
VARIVAX VACCINE
ZOSYN
CARNITOR
IMURAN
ARICEPT ODT
AVODART
LEVOTHYROXINE SODIUM
RAPAFLO
TRAMADOL HCL
MONOJECT INSULIN SYRINGE
AZELASTINE HCL
ACETAMINOPHEN-CODEINE
OFLOXACIN
HYDROXYCHLOROQUINE SULFATE
ENBREL
FAMCICLOVIR
SEREVENT DISKUS
NAPROXEN SODIUM
GAMMAGARD LIQUID
NEFAZODONE HCL
ELMIRON
ZARONTIN
GRANISETRON HCL
ROXICODONE
DESOGESTREL-ETHINYL ESTRADIOL
EMOQUETTE
CODEINE SULFATE
INDERAL LA
HEALTHY ACCENTS UNIFINE PENTIP
ZIANA
XALKORI
MEPERIDINE HCL
PHILITH
MAXZIDE-25 MG
ENABLEX
EXEMESTANE
TRAVATAN Z
TRADJENTA
AMILORIDE HCL
TOVIAZ
ONDANSETRON HCL
JANTOVEN
DIPYRIDAMOLE
ISOSORBIDE MONONITRATE
GAVILYTE-G
NARATRIPTAN HCL
HUMULIN N KWIKPEN
BETIMOL
LO LOESTRIN FE
FASLODEX
TYVASO
GENTAK
RIBAPAK
ADEFOVIR DIPIVOXIL
INFANRIX DTAP
MAXALT MLT
SINEMET CR
OB COMPLETE
PREVIFEM
ERYPED 400
SUBSYS
LARIN FE
AMOXICILLIN-CLAVULANATE ER
LEVAQUIN
UNIVASC
RAZADYNE ER
TETANUS DIPHTHERIA TOXOIDS
MACRODANTIN
DILTZAC ER
VANDAZOLE
VALACYCLOVIR
CLINDAMYCIN HCL
PAROXETINE HCL
DIOVAN
UNIFINE PENTIPS
FELODIPINE ER
COMFORT EZ
DOXAZOSIN MESYLATE
DRONABINOL
FLOVENT DISKUS
CANDESARTAN CILEXETIL
BETAXOLOL HCL
REMERON
AMARYL
RIBAVIRIN
EXFORGE HCT
QNASL
RELPAX
EFFEXOR XR
MAXALT
MAGNESIUM SULFATE
TRIVORA-28
HEXALEN
DELESTROGEN
AVELOX
SURE-JECT INSULIN SYRINGE
EASY TOUCH INSULIN SYRINGE
GLUCOTROL
ANGELIQ
GENERESS FE
MIRVASO
GLIPIZIDE ER
TRELSTAR
PEG-3350 AND ELECTROLYTES
NAMENDA XR
CEFADROXIL
SAVELLA
PHENYTOIN
TYSABRI
DILT-XR
FLOMAX
MINIVELLE
EPINASTINE HCL
EDARBI
EDECRIN
THALOMID
DOXY 100
ITRACONAZOLE
TOPICORT
SOLU-CORTEF
TRIGLIDE
TYLENOL-CODEINE NO.4
ZYCLARA
PRENATE ESSENTIAL
RAYOS
COLISTIMETHATE
SILVADENE
ERTACZO
ACULAR LS
OMEPRAZOLE
ZYTIGA
CARBIDOPA-LEVODOPA ER
AMIODARONE HCL
HYDROCORTISONE VALERATE
MYRBETRIQ
PROTONIX
LUPRON DEPOT
BETAMETHASONE VALERATE
MEGACE ES
PAXIL CR
ESTRADIOL-NORETHINDRONE ACETAT
TEKTURNA HCT
RETROVIR
WELLBUTRIN SR
FOCALIN XR
BANZEL
RISPERDAL M-TAB
ALTABAX
PRENATE MINI
NUTROPIN AQ
XYLOCAINE-MPF
PREVIDENT 5000 ENAMEL PROTECT
IBUPROFEN
LACTULOSE
FAMOTIDINE
INDOMETHACIN
NIFEDIPINE ER
SANTYL
BUMETANIDE
RAMIPRIL
KETOCONAZOLE
ROZEREM
JANUMET
SYNTHROID
NOVOLOG FLEXPEN
CARISOPRODOL
CONCERTA
ENDOCET
BOOSTRIX TDAP
ALBUTEROL SULFATE
ZENPEP
BD ULTRA-FINE PEN NEEDLE
VORICONAZOLE
HUMIRA
TEFLARO
DESMOPRESSIN ACETATE
EPIVIR
CLOZARIL
ENPRESSE
ACAMPROSATE CALCIUM
TWYNSTA
DIPHENHYDRAMINE HCL
LOTRONEX
ANTARA
RAZADYNE
DEPEN
EPINEPHRINE
FALMINA
SOLODYN
ETIDRONATE DISODIUM
MOZOBIL
VINCASAR PFS
KEPPRA
CALCITRIOL
PROCTOZONE-HC
NOVOLOG MIX 70-30
CEFDINIR
DEPAKOTE
GLIPIZIDE XL
IMIPRAMINE HCL
SENSIPAR
DETROL LA
VERAPAMIL ER PM
ACETAZOLAMIDE
LAMIVUDINE-ZIDOVUDINE
LACLOTION
PENTASA
BETASERON
FLUOCINONIDE-E
ZYVOX
INVEGA
ACETYLCYSTEINE
ZONEGRAN
OXAZEPAM
CARDIZEM CD
VGO 30
NORITATE
TRUSOPT
NULOJIX
EXTAVIA
VINBLASTINE SULFATE
DANAZOL
MYFORTIC
BICILLIN L-A
PREDNISOLONE SODIUM PHOSPHATE
VINCRISTINE SULFATE
SRONYX
BUPROBAN
MARPLAN
RENAL CAPS
BUTISOL SODIUM
DEPO-MEDROL
LAMOTRIGINE
DIOVAN HCT
ELIQUIS
PANTOPRAZOLE SODIUM
LISINOPRIL
VALSARTAN-HYDROCHLOROTHIAZIDE
TELMISARTAN-HYDROCHLOROTHIAZID
ANDROGEL
NATEGLINIDE
SUCRALFATE
ESTRING
ALCLOMETASONE DIPROPIONATE
CONSTULOSE
FENOFIBRIC ACID
XOPENEX HFA
LOTREL
PREMPRO
NISOL

2025-01-20 05:18:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:18:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:18:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:18:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:18:37 - snowflake.connector.connection - INFO - closed
2025-01-20 05:18:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:18:38 - root - INFO - SQL:
-- 3. Get total claim counts for each drug in New York State.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 1000;
Results:
Too long, hard cut:
drug_name,total_claims
AMLODIPINE BESYLATE,2606392
SIMVASTATIN,2483824
ATORVASTATIN CALCIUM,2343736
OMEPRAZOLE,2158771
LEVOTHYROXINE SODIUM,2091879
LISINOPRIL,1878852
FUROSEMIDE,1604273
METOPROLOL SUCCINATE,1497362
METFORMIN HCL,1483466
METOPROLOL TARTRATE,1476125
LOSARTAN POTASSIUM,1179068
HYDROCHLOROTHIAZIDE,1177844
GABAPENTIN,1063477
WARFARIN SODIUM,1037689
CLOPIDOGREL,1027289
TAMSULOSIN HCL,950300
CRESTOR,902634
ATENOLOL,872477
ZOLPIDEM TARTRATE,740031
CARVEDILOL,711856
SERTRALINE HCL,702641
NEXIUM,675301
HYDROCODONE-ACETAMINOPHEN,669509
PRAVASTATIN SODIUM,662043
PANTOPRAZOLE SODIUM,616877
FLUTICASONE PROPIONATE,579662
PREDNISONE,562097
DONEPEZIL HCL,521804
ALENDRONATE SODIUM,521736
PROAIR HFA,520129
MONTELUKAST SODIUM,518027
ENALAPRIL MALEATE,516231
LATANOPROST,508505
JANUVIA,508330
CITALOPRAM HBR,498268
ADVAIR DISKUS,483391
ALPRAZOLAM,478214
POTASSIUM CHLORIDE,457448
SYNTHROID,453791
QUETIAPINE FUMARATE,447257
ESCITALOPRAM OXALATE,446888
TRAZODONE HCL,441018
OXYCODONE-ACETAMINOPHEN,433851
CLONAZEPAM,430536
RANITIDINE HCL,422992
LOSARTAN-HYDROCHLOROTHIAZIDE,412328
ALLOPURINOL,408017
SPIRIVA,404803
AZITHROMYCIN,394490
MELOXICAM,383651
MIRTAZAPINE,383213
FINASTERIDE,378878
TRAMADOL HCL,364355
DIOVAN,358834
GLIMEPIRIDE,358155
DULOXETINE HCL,357225
ISOSORBIDE MONONITRATE ER,346521
RAMIPRIL,343510
LANTUS SOLOSTAR,343009
AMOXICILLIN,340811
RISPERIDONE,340499
CIPROFLOXACIN HCL,338454
NAMENDA,320510
LORAZEPAM,317161
METFORMIN HCL ER,306073
IBUPROFEN,302979
LISINOPRIL-HYDROCHLOROTHIAZIDE,299542
VALSARTAN-HYDROCHLOROTHIAZIDE,283681
FAMOTIDINE,278964
VOLTAREN,278509
AMMONIUM LACTATE,277683
PAROXETINE HCL,268093
GLIPIZIDE,255509
OXYCODONE HCL,255226
FENOFIBRATE,253225
FLUOXETINE HCL,252205
SPIRONOLACTONE,246063
NIFEDIPINE ER,245644
LEVETIRACETAM,232951
HYDRALAZINE HCL,229279
LOVASTATIN,225838
POLYETHYLENE GLYCOL 3350,224730
OLANZAPINE,224053
LYRICA,220106
ZETIA,214969
ABILIFY,209738
VENLAFAXINE HCL ER,207255
SYMBICORT,201916
LEVOFLOXACIN,200878
NAPROXEN,199601
AMLODIPINE BESYLATE-BENAZEPRIL,195625
CELEBREX,194637
LOVAZA,194003
LUMIGAN,193751
CLONIDINE HCL,184816
DIVALPROEX SODIUM,181189
TRIAMCINOLONE ACETONIDE,180960
LAMOTRIGINE,178665
TRIAMTERENE-HYDROCHLOROTHIAZID,178524
XARELTO,177758
BENZTROPINE MESYLATE,177116
BUPROPION XL,177098
CARBIDOPA-LEVODOPA,176483
BD ULTRA-FINE PEN NEEDLE,174415
PREDNISOLONE ACETATE,172342
LANTUS,171652
DILTIAZEM 24HR ER,168681
VENTOLIN HFA,167376
AMOX TR-POTASSIUM CLAVULANATE,167204
LIDOCAINE,166872
MECLIZINE HCL,165798
TIMOLOL MALEATE,157757
DORZOLAMIDE-TIMOLOL,155438
SULFAMETHOXAZOLE-TRIMETHOPRIM,153797
TRAVATAN Z,151135
CLOBETASOL PROPIONATE,151077
JANUMET,150537
OXYBUTYNIN CHLORIDE ER,148582
QUINAPRIL HCL,147391
BYSTOLIC,147198
PIOGLITAZONE HCL,145249
BUSPIRONE HCL,143422
RESTASIS,141964
BACLOFEN,140937
AMITRIPTYLINE HCL,140699
GLIPIZIDE ER,140394
DIAZEPAM,139279
DOXAZOSIN MESYLATE,138825
CEPHALEXIN,137706
MUPIROCIN,135100
DIGOX,134514
DIGOXIN,133812
AVODART,133353
CHLORHEXIDINE GLUCONATE,132311
LACTULOSE,128404
GLIPIZIDE XL,126744
TOPIRAMATE,126476
COMBIGAN,126296
BENICAR,125746
FENTANYL,123240
DIVALPROEX SODIUM ER,123218
VESICARE,122059
HUMALOG,119543
LABETALOL HCL,119449
ACETAMINOPHEN-CODEINE,117625
DEXILANT,116409
METHOTREXATE,116118
IRBESARTAN,115758
CLOZAPINE,109610
NOVOLOG FLEXPEN,108274
KETOCONAZOLE,105255
CICLOPIROX,104434
HALOPERIDOL,103663
PRADAXA,101573
PATADAY,101163
DILTIAZEM 24HR CD,101139
ALPHAGAN P,100973
KLOR-CON M20,100814
CLOTRIMAZOLE-BETAMETHASONE,100714
CYCLOBENZAPRINE HCL,100707
LIDODERM,99510
BRIMONIDINE TARTRATE,98842
LANSOPRAZOLE,98791
CHLORTHALIDONE,96841
NYSTATIN,96655
METHYLPREDNISOLONE,96266
NAMENDA XR,95581
DOXYCYCLINE HYCLATE,95531
LEVEMIR FLEXPEN,94262
VERAPAMIL ER,93009
NASONEX,92831
TERAZOSIN HCL,92683
RANEXA,89604
FLUOCINONIDE,88073
COLCRYS,87328
BENAZEPRIL HCL,85024
TIZANIDINE HCL,84681
TORSEMIDE,83979
GEMFIBROZIL,82491
BUPROPION HCL SR,81924
ECONAZOLE NITRATE,81847
HYDROXYCHLOROQUINE SULFATE,81124
ROPINIROLE HCL,80150
DICLOFENAC SODIUM,79801
BENICAR HCT,78764
AZELASTINE HCL,78567
VALSARTAN,78447
OXYBUTYNIN CHLORIDE,78428
MORPHINE SULFATE ER,77889
OXYCONTIN,77360
RALOXIFENE HCL,76707
SINGLE USE SWAB,76172
CLOTRIMAZOLE,75585
NITROSTAT,75561
EXELON,74714
AMIODARONE HCL,74637
NIFEDICAL XL,73128
GLYBURIDE,73043
TOPROL XL,72958
VALACYCLOVIR,72509
PROPRANOLOL HCL,72042
ANASTROZOLE,71546
KETOROLAC TROMETHAMINE,70687
ALBUTEROL SULFATE,66127
CREON,64598
COMBIVENT RESPIMAT,64509
TRADJENTA,63702
FLOVENT HFA,63459
NORVIR,62431
CARBAMAZEPINE,61858
METOCLOPRAMIDE HCL,61183
HYDROCORTISONE,60622
ALCOHOL PADS,60215
IPRATROPIUM-ALBUTEROL,60122
CALCITRIOL,59890
JANTOVEN,59842
FOSINOPRIL SODIUM,59739
IPRATROPIUM BROMIDE,59553
HYDROXYZINE HCL,59365
RAPAFLO,58620
NORTRIPTYLINE HCL,57921
METRONIDAZOLE,57609
LITHIUM CARBONATE,56866
PATANOL,56786
SEROQUEL XR,55802
TRUVADA,55534
IBANDRONATE SODIUM,54573
NITROFURANTOIN MONO-MACRO,53554
PHENYTOIN SODIUM EXTENDED,52949
INSULIN SYRINGE,52550
FLUCONAZOLE,52522
CILOSTAZOL,52479
COUMADIN,52376
VIGAMOX,52295
OMEGA-3 ACID ETHYL

2025-01-20 05:18:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:18:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:18:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:18:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:18:39 - snowflake.connector.connection - INFO - closed
2025-01-20 05:18:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:18:40 - root - INFO - SQL:
-- 4. Find total drug costs for each drug in New York State.
SELECT "drug_name", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "total_cost" DESC
LIMIT 1000;
Results:
Too long, hard cut:
drug_name,total_cost
CRESTOR,249327097.41000012
SOVALDI,230243170.39
NEXIUM,214788833.79000002
JANUVIA,194438475.12000006
ABILIFY,181274610.4100001
ADVAIR DISKUS,180060546.1900001
SPIRIVA,150863384.09000003
LANTUS SOLOSTAR,148985758.74999994
REVLIMID,107219280.90999997
NAMENDA,83872328.88
ENBREL,81570443.91999999
COPAXONE,79486041.02000001
DIOVAN,78426639.23000002
TRUVADA,72683222.99
HUMIRA,72616484.43
DULOXETINE HCL,71719393.02999999
LYRICA,66070666.27
XARELTO,64782309.809999995
ZETIA,63663933.77
RESTASIS,63575130.730000004
LANTUS,61681575.25
SYMBICORT,59867832.10999999
CELEBREX,59071901.58
METOPROLOL SUCCINATE,57766641.45999998
OLYSIO,55122556.60000001
JANUMET,55056829.46
ATRIPLA,54860236.31000002
ATORVASTATIN CALCIUM,53943714.93
GLEEVEC,51117573.96000002
HUMALOG,48263419.919999994
NOVOLOG FLEXPEN,48213346.3
ISENTRESS,47487933.49000002
LOVAZA,45890986.8
SENSIPAR,45096677.930000015
TECFIDERA,42576237.6
OXYCONTIN,42112905.27
LIDODERM,40911216.23
RENVELA,40821118.470000006
PREZISTA,40812033.78999999
HARVONI,40439111.25
LIDOCAINE,40209597.260000005
ZYTIGA,40067382.019999996
PRADAXA,40056632.84
LEVEMIR FLEXPEN,38206535.82000001
LEVOTHYROXINE SODIUM,37782511.40999999
LUMIGAN,34801637.98
VESICARE,34509594.030000016
RANEXA,32636829.85
SEROQUEL XR,32380961.619999997
REYATAZ,32013003.350000013
OMEPRAZOLE,31535545.88
VICTOZA 3-PAK,30027173.900000002
PROAIR HFA,29455596.169999994
EXELON,29194113.789999995
TARCEVA,29140341.81999999
CREON,27937813.83
AVODART,27472993.950000003
CLOPIDOGREL,27348175.679999996
EPZICOM,26709837.580000002
NAMENDA XR,25983794.51
LETAIRIS,25902094.29
DEXILANT,25676366.45
BENICAR,25443544.000000004
PROCRIT,25153769.129999995
TRAVATAN Z,24771707.959999997
OLANZAPINE,24613230.34
QUETIAPINE FUMARATE,24296346.749999985
AVONEX,24095960.069999997
TRADJENTA,23621812.8
FENOFIBRATE,23577113.29000001
XTANDI,22975633.199999996
SIMVASTATIN,22966671.89
GAMMAGARD LIQUID,22137393.639999993
H.P. ACTHAR,22109154.050000004
TAMSULOSIN HCL,21594947.83
AVONEX PEN,21381695.33
TRACLEER,21115983.340000004
OXYCODONE-ACETAMINOPHEN,21104760.020000003
DIVALPROEX SODIUM ER,21020703.65
PRAVASTATIN SODIUM,20913612.590000007
NORVIR,20754231.05
AMLODIPINE BESYLATE,20729281.249999993
COMBIVENT RESPIMAT,20700370.280000005
VIREAD,20304233.08
GABAPENTIN,20300069.87999999
VOLTAREN,19943125.9
WELCHOL,19644395.279999997
BYSTOLIC,19561871.959999997
COLCRYS,19379766.75
NOVOLOG MIX 70-30 FLEXPEN,19346065.25
SYNTHROID,19280530.58
FORTEO,19164627.519999996
COMBIGAN,18785901.630000006
ENOXAPARIN SODIUM,17958707.119999997
HYDROCODONE-ACETAMINOPHEN,17544090.789999995
NASONEX,17455648.05
COMPLERA,17237542.630000003
RALOXIFENE HCL,17232401.17
ELIQUIS,17225348.98
ALPHAGAN P,17197571.570000004
ONGLYZA,17097443.660000008
CLOBETASOL PROPIONATE,17034813.119999997
STRIBILD,16736289.4
LATUDA,16714844.339999996
LOSARTAN POTASSIUM,16707068.97
REBIF,16471064.780000001
BENICAR HCT,16365516.01
FENTANYL,16106482.219999997
VALSARTAN,16003284.72
VYTORIN,15631262.600000003
INVEGA SUSTENNA,15577263.82
FLOVENT HFA,15417080.719999999
DONEPEZIL HCL,15253989.270000003
PATADAY,15244739.37
AGGRENOX,15219900.719999997
GAMUNEX-C,14807257.29
NOVOLOG,14675388.849999998
VALSARTAN-HYDROCHLOROTHIAZIDE,14637686.24
AMITIZA,14614131.22
GILENYA,14583050.459999997
OXYCODONE HCL,14576462.039999994
MONTELUKAST SODIUM,14196241.420000004
XIFAXAN,13925425.670000004
IMBRUVICA,13594120.35
AZILECT,13095812.929999996
EVISTA,12826356.569999995
POTASSIUM CHLORIDE,12816403.469999999
VIMPAT,12466537.829999996
MYRBETRIQ,12435013.940000001
METFORMIN HCL,12377618.139999999
HUMALOG MIX 75-25,12168255.439999996
LISINOPRIL,12129540.520000003
RAPAFLO,11860292.84
AFINITOR,11842201.23
AMPYRA,11729545.72
VALCYTE,11694943.840000002
PROLIA,11647358.110000003
METFORMIN HCL ER,11580778.149999999
DICLOFENAC SODIUM,11575983.980000004
ADCIRCA,11298534.26
AMLODIPINE BESYLATE-BENAZEPRIL,11121216.640000002
WARFARIN SODIUM,11100457.57
INTELENCE,11013016.680000003
SANTYL,10946240.520000001
JAKAFI,10902051.390000002
INVOKANA,10842460.520000001
LEVEMIR,10820001.459999999
OMEGA-3 ACID ETHYL ESTERS,10777016.410000002
INVEGA,10755982.93
FLUTICASONE PROPIONATE,10629640.18
PREDNISOLONE ACETATE,10501226.98
NIACIN ER,10420729.770000001
ULORIC,10399172.72
MULTAQ,10351336.500000004
PIOGLITAZONE HCL,10267115.030000003
EXFORGE,10256804.23
RISPERDAL CONSTA,10206885.15
PANTOPRAZOLE SODIUM,10186062.680000002
PREMARIN,10150921.780000001
TASIGNA,10099062.06
POMALYST,10085754.040000001
CLOZAPINE,10046192.16
METOPROLOL TARTRATE,9967777.960000003
NIFEDIPINE ER,9949490.360000001
PATANOL,9637933.74
ESCITALOPRAM OXALATE,9584397.98
LATANOPROST,9357466.48
MORPHINE SULFATE ER,9315240.059999997
LIALDA,9218202.670000002
TIVICAY,9160245.05
ACTONEL,9125216.939999998
SUBOXONE,9123378.790000001
OXYBUTYNIN CHLORIDE ER,9084748.64
METHOTREXATE,9060760.379999999
ANDROGEL,8960305.679999998
AZOR,8950289.609999998
ZOSTAVAX,8891298.76
AUBAGIO,8873366.209999999
BARACLUDE,8852746.04
AZOPT,8803192.419999998
RAMIPRIL,8697248.9
LINZESS,8584279.369999997
VE

2025-01-20 05:18:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:18:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:18:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:18:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-20 05:18:41 - snowflake.connector.connection - INFO - closed
2025-01-20 05:18:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:18:41 - root - INFO - SQL:
-- 5. List the top 10 drugs by total claim counts across all states.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 10;
Results:
drug_name,total_claims
LISINOPRIL,37599566
LEVOTHYROXINE SODIUM,37075950
AMLODIPINE BESYLATE,35659180
SIMVASTATIN,33549777
OMEPRAZOLE,32276944
HYDROCODONE-ACETAMINOPHEN,32204330
ATORVASTATIN CALCIUM,31959252
FUROSEMIDE,26372608
METFORMIN HCL,22952294
GABAPENTIN,21323652

2025-01-20 05:18:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:18:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:18:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:18:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 05:18:43 - snowflake.connector.connection - INFO - closed
2025-01-20 05:18:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:19:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 05:19:30 - root - INFO - ```sql
SELECT "nppes_provider_state", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "total_claims" DESC
LIMIT 10;
```
2025-01-20 05:19:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:19:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:19:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:19:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-20 05:19:32 - snowflake.connector.connection - INFO - closed
2025-01-20 05:19:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 05:20:12 - root - INFO - SQL:
SELECT "nppes_provider_state", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "total_claims" DESC
LIMIT 10;
Results:
nppes_provider_state,total_claims
CA,116440694
FL,91441123
NY,79570924
TX,75682169
PA,62946334
OH,53494076
NC,46020420
IL,42527191
MI,39461213
GA,39066489

2025-01-20 05:20:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 60
2025-01-20 05:20:14 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:14 - root - INFO - SQL:
-- 7. Retrieve total drug costs per state for a specific drug.
-- Replacing 'DrugNamePlaceholder' with an actual drug name, for example 'LISINOPRIL'.
SELECT "nppes_provider_state", SUM("total_drug_cost") AS "state_total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "drug_name" = 'LISINOPRIL'
GROUP BY "nppes_provider_state"
ORDER BY "state_total_cost" DESC
LIMIT 1000
Results:
nppes_provider_state,state_total_cost
CA,28081799.270000007
FL,18765053.880000003
TX,18193331.150000002
PA,13881711.110000001
OH,13078051.309999995
NY,12129540.519999998
IL,11182703.340000002
MI,10286256.829999998
NC,9100926.089999998
MO,7989472.850000001
MA,7797229.159999999
GA,7093689.38
TN,6822899.400000002
AZ,6699458.37
MN,6357574.170000001
IN,6331941.26
VA,6214347.589999999
WA,5961205.869999998
WI,5830349.669999999
KY,5608079.180000002
NJ,4388274.59
CO,4293032.0200000005
MD,4031259.4699999997
AL,3969057.4
OR,3878300.94
SC,3832939.3499999996
OK,3792994.8099999987
LA,3591451.1000000006
IA,3361841.53
CT,3163402.6
AR,3100542.76
KS,2767073.0599999987
MS,2390290.689999999
WV,2284762.25
NV,2236554.97
NM,2164382.7400000007
ME,1700248.8499999996
PR,1668734.31
NE,1512062.860000001
UT,1416171.4000000004
RI,1365108.7000000002
ID,1227299.51
NH,1182892.28
HI,1126129.4499999997
DE,1014526.88
SD,877349.5100000002
MT,856439.07
ND,773696.0099999995
VT,563978.6999999998
DC,453014.1699999998
WY,385846.3
AK,361804.7900000001
VI,35915.01
GU,27074.559999999994
ZZ,7056.420000000001
MP,3149.42
AE,1740.78
XX,677.3399999999999
AP,496.99
AS,151.66

2025-01-20 05:20:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:20:16 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:16 - root - INFO - SQL:
-- 8. Calculate average drug cost per claim for each drug in New York State.
SELECT "drug_name", SUM("total_drug_cost") / SUM("total_claim_count") AS "avg_cost_per_claim"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
HAVING SUM("total_claim_count") > 0  -- Ensure division by zero is avoided
ORDER BY "avg_cost_per_claim" DESC
LIMIT 1000
Results:
Too long, hard cut:
drug_name,avg_cost_per_claim
ELAPRASE,65276.352222222224
CINRYZE,60768.683833333336
RAVICTI,42428.24964285714
PROCYSBI,42166.539333333334
H.P. ACTHAR,38317.4246967071
CHENODAL,36108.195384615385
HARVONI,32145.557432432433
GATTEX,31578.390219780216
FIRAZYR,30701.36266666667
KALYDECO,30269.19833333333
KALBITOR,29386.1188
SOVALDI,28573.24030652768
APOKYN,27715.462
JUXTAPID,27520.148823529413
LUMIZYME,27022.897454545455
BERINERT,23022.39525423729
OLYSIO,22609.744298605416
VPRIV,22309.94754385965
SOLIRIS,21273.995789473684
KORLYM,20766.115217391307
TARGRETIN,20280.789056047197
MOZOBIL,19168.855
ELELYSO,18802.0
CEREZYME,17842.561299999998
KUVAN,17506.413333333334
TYVASO,14887.955777777777
ORENITRAM ER,13993.30510638298
SODIUM PHENYLBUTYRATE,13889.707142857142
ZYKADIA,13190.450833333334
GAMMAKED,12849.59012345679
XALKORI,12674.966190476189
CAPRELSA,11917.92
ACTIQ,11529.232727272727
LAZANDA,11361.056153846155
POMALYST,11181.545498891353
FERRIPROX,11179.465538461538
STELARA,11026.392320185612
SABRIL,11012.395862068965
ALBENZA,10812.370238095238
SUBSYS,10793.219328358207
BUPHENYL,10403.520238095238
SEROSTIM,10395.255487571698
INLYTA,10170.812305825242
JAKAFI,10169.824057835824
FLEBOGAMMA DIF,10148.561538461538
STIVARGA,10142.038818181818
ICLUSIG,10074.233333333334
FABRAZYME,9901.669591836735
AFINITOR,9827.552887966804
ABSTRAL,9737.644210526316
REVLIMID,9570.586531286266
MEKINIST,9539.798181818182
OCTAGAM,9355.354705882353
IMBRUVICA,9210.108638211384
GLASSIA,9134.961818181819
ERIVEDGE,9076.844049586776
JEVTANA,8908.311818181817
BOSULIF,8685.97796460177
NEXAVAR,8621.466373626376
PROLASTIN C,8428.681493670887
XTANDI,8403.669787856617
GLEEVEC,8323.982081094284
GAMUNEX-C,8309.347525252526
GAMMAGARD LIQUID,8297.373928035984
TASIGNA,8217.300292921074
XYREM,8080.52527777778
NPLATE,7859.560757575758
SPRYCEL,7836.920239833158
SOMAVERT,7643.65925925926
EXJADE,7545.456211180125
SAMSCA,7537.739925373134
TRACLEER,7493.251717530162
ADEMPAS,7460.704311224491
ANZEMET,7405.419687500001
VOTRIENT,7400.523508442777
ZYTIGA,7368.036414122836
CARIMUNE NF NANOFILTERED,7326.557250000001
LETAIRIS,7229.163910131175
RITUXAN,7217.458158783783
PRIVIGEN,7178.857943661971
OPSUMIT,7177.309185750637
PROMACTA,7174.179348659003
TOBI PODHALER,7158.574615384616
VALCHLOR,7107.772727272727
VECTIBIX,7049.693846153847
TOBI,6846.525000000001
ERBITUX,6843.979253731343
NORTHERA,6663.645833333333
SUTENT,6638.673315719949
KADCYLA,6631.729777777777
XENAZINE,6560.109056162247
THALOMID,6485.287917448406
FENTORA,6336.729887005651
REMODULIN,6276.3099999999995
CAYSTON,6200.429259259259
TARCEVA,6200.0727276595735
TREANDA,6112.447636363636
TECFIDERA,6011.894606043493
GAZYVA,5991.2840625
GILOTRIF,5978.707475728155
VIDAZA,5769.0440625
GILENYA,5674.338700389104
AUBAGIO,5630.308508883248
ARALAST NP,5599.276231155779
AVASTIN,5598.689894625921
COPAXONE,5532.542703417555
HALAVEN,5512.37875
ALIMTA,5472.809700598803
AVONEX PEN,5309.584139557985
EXTAVIA,5271.702
REBIF REBIDOSE,5260.885656934308
NEULASTA,5201.684639084508
AVONEX,5190.857404136149
VELCADE,5160.571147540984
ZEMAIRA,5116.3090740740745
AVONEX ADMINISTRATION PACK,5020.600552486189
REBIF,4979.161058041112
BETASERON,4916.548891129031
HERCEPTIN,4853.794588235293
GAMMAPLEX,4806.171176470589
TYSABRI,4782.291277533041
NOXAFIL,4781.582222222222
REMICADE,4753.249519071309
SOMATULINE DEPOT,4656.475652173913
ABRAXANE,4506.173395061728
PERJETA,4408.845308641975
GAMMAGARD S-D,4243.6033333333335
SANDOSTATIN LAR,4199.314712793734
OXSORALEN-ULTRA,4081.539375
NILANDRON,3991.93219269103
TYKERB,3869.1095833333334
CYSTARAN,3726.2461538461534
ARIXTRA,3693.184791666667
BENLYSTA,3672.1958407079646
METHYLERGONOVINE MALEATE,3652.5
AZACITIDINE,3648.74046875
TORISEL,3564.5183333333334
HUMIRA,3538.987495979336
PEGASYS,3533.9074074074065
REVATIO,3380.9466752577323
CIMZIA,3362.998648838846
NEUPOGEN,3362.575299950422
HIZENTRA,3342.041397849462
TASMAR,3304.5092458100553
ENBREL,3303.5170873157313
SIMPONI,3290.2579450980393
MIGRANAL,3274.023902439025
PEGASYS PROCLICK,3211.029041353383
LEUKINE,3155.1775
PEGINTRON REDIPEN,3127.5962
DIFICID,3117.524705882353
XOLAIR,3092.7501711229947
FUZEON,2985.3037373737375
KINERET,2978.957828947368
CUPRIMINE,2972.6717021276595
ORENCIA,2920.2818677042796
PULMOZYME,2875.9
SAIZEN,2851.9436363636364
AMBISOME,2763.395925925926
GENOTROPIN,2716.474303797468
NORDITROPIN NORDIFLEX,2713.3108333333334
HEPAGAM B,2689.0266666666666
DEPEN,2637.403333333333
OXALIPLATIN,2624.631777777778
XELJANZ,2621.248628503279
STRIBILD,2539.6493778452204
VALCYTE,2513.4201246507632
TRELSTAR,2470.9281487101666
CYSTADANE,2454.5828125
TRIUMEQ,2392.362
LUCENTIS,2359.4441637010677
ZYVOX,2334.095423728814
ZYFLO CR,2298.674722222222
EYLEA,2293.623236714976
VANOS,2200.278888888889
LUPRON DEPOT,2196.013436246993
MIACALCIN,2166.974715447155
OTEZLA,2165.8633846153843
LYSODREN,2146.2813333333334
ATRIPLA,2126.9428259605315
COMPLERA,2125.7297607596493
ADCIRCA,2115.8303857677897
RILUTEK,2093.5473568281936
ACTEMRA,2081.9734966592428
PROLEUKIN,2069.088823529412
AMPYR

2025-01-20 05:20:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-20 05:20:18 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:18 - root - INFO - SQL:
-- 9. Find the number of unique prescribers per state.
SELECT "nppes_provider_state", COUNT(DISTINCT "npi") AS "number_of_prescribers"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "number_of_prescribers" DESC
LIMIT 1000
Results:
nppes_provider_state,number_of_prescribers
CA,86586
NY,63751
TX,50853
FL,49874
PA,41440
OH,33064
IL,32415
MI,29898
NC,26875
MA,24875
NJ,23515
GA,20728
VA,19335
WA,19060
TN,18826
AZ,16666
WI,16441
IN,16316
MO,16128
MN,16099
MD,15616
CO,13888
LA,12345
CT,12263
OR,12171
KY,12131
SC,11689
AL,10719
OK,9152
PR,8385
IA,8364
KS,7707
MS,7114
AR,6816
UT,6077
WV,5668
NV,5556
NM,5389
NE,5279
ME,4825
NH,4397
ID,4071
RI,3701
HI,3171
MT,2889
DC,2677
DE,2568
SD,2560
ND,2293
VT,1996
AK,1609
WY,1394
VI,154
ZZ,99
GU,98
AE,32
AP,25
MP,16
AA,7
XX,5
AS,2

2025-01-20 05:20:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-20 05:20:19 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:20 - root - INFO - SQL:
-- 10. Retrieve total claim counts and total drug costs per state.
SELECT "nppes_provider_state", SUM("total_claim_count") AS "total_claims", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "total_claims" DESC
LIMIT 1000
Results:
nppes_provider_state,total_claims,total_cost
CA,116440694,9633494580.830002
FL,91441123,6969574542.380003
NY,79570924,7521861271.360001
TX,75682169,6462480867.609998
PA,62946334,4841813377.080001
OH,53494076,4050597920.3
NC,46020420,3357740486.2099996
IL,42527191,3120595897.4100003
MI,39461213,3193421559.090002
GA,39066489,2787324531.739999
TN,35472398,2449796259.99
MO,31071230,2266900573.049999
NJ,29242463,2980085648.56
IN,27822613,2151310576.07
KY,26196384,1749915624.0500007
AL,26162156,1774188310.3899994
MA,26156247,1993379967.38
VA,25549776,1845291759.1400003
PR,24988874,998242828.4499999
LA,22456360,1586697376.66
SC,21795317,1625039227.0200002
WI,21461606,1595424680.7500005
AZ,19873807,1531414913.72
WA,19108957,1374073749.7700002
MN,17312127,1268712288.75
MS,15737130,971791465.0899998
AR,15647866,924771139.8100001
OK,14918485,1099747189.1000001
IA,14673562,851657297.38
OR,13889191,940748728.5399997
MD,13798859,1285911121.54
CT,12892970,1213947159.8300004
CO,12823030,987955657.2400001
KS,12042320,812376124.8
WV,11216491,774905769.8599999
NE,7991763,513097615.17
NV,7457176,530336271.75000006
UT,5796245,446198781.28999996
NM,5770207,402878429.6
ME,5699119,445414042.0799999
RI,5535266,345326474.99
ID,4852448,340866011.09000003
NH,4095519,322343632.6399999
HI,3777714,342155461.13999987
SD,3525885,233180044.24000007
MT,3315266,235183327.45000002
ND,3061665,198826531.82999998
DE,3042265,313539382.5000001
VT,2115996,171127800.37999994
DC,1487724,192973624.24999997
WY,1380174,89775137.25999999
AK,1074367,78887893.48
VI,197072,9122593.650000002
GU,76979,3012622.01
ZZ,33284,2394695.3500000006
AE,7617,482799.32000000007
MP,7104,273092.6499999999
XX,1909,41955.99
AP,1839,68270.65999999999
AA,999,9045.2
AS,218,1660.4500000000003

2025-01-20 05:20:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:20:21 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:22 - root - INFO - SQL:
-- 11. Get total claim counts and total drug costs for each drug nationwide.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 1000
Results:
Too long, hard cut:
drug_name,total_claims,total_cost
LISINOPRIL,37599566,277213345.65
LEVOTHYROXINE SODIUM,37075950,621294485.3899997
AMLODIPINE BESYLATE,35659180,298507550.62
SIMVASTATIN,33549777,341421087.83000004
OMEPRAZOLE,32276944,517533247.7799998
HYDROCODONE-ACETAMINOPHEN,32204330,658789651.37
ATORVASTATIN CALCIUM,31959252,733947717.3099997
FUROSEMIDE,26372608,132377918.97000004
METFORMIN HCL,22952294,199522058.46000004
GABAPENTIN,21323652,475796482.49000007
METOPROLOL TARTRATE,20782646,143697787.07999992
LOSARTAN POTASSIUM,17873509,256379132.92999998
HYDROCHLOROTHIAZIDE,17373067,103773229.71000004
METOPROLOL SUCCINATE,16781720,646937388.2099999
WARFARIN SODIUM,15241971,157425944.31999993
CLOPIDOGREL,14563125,327030151.14000005
PRAVASTATIN SODIUM,14190361,432287194.74
CARVEDILOL,13310395,133491005.67
TRAMADOL HCL,13242625,118801590.98999998
ALPRAZOLAM,13081892,88534125.56000002
ATENOLOL,12883671,93628523.41000003
POTASSIUM CHLORIDE,12506552,364394350.96000004
TAMSULOSIN HCL,11685280,272151299.9099999
SERTRALINE HCL,11187864,120372788.28999999
PANTOPRAZOLE SODIUM,11071364,172384475.60999995
CITALOPRAM HBR,10234686,79372249.20000003
PREDNISONE,9844536,78529400.60000002
TRAZODONE HCL,9663151,80163222.24
FLUTICASONE PROPIONATE,9614633,189919666.91999993
LORAZEPAM,9560017,74394806.97000001
ZOLPIDEM TARTRATE,9448045,74632610.31000002
CLONAZEPAM,9267099,68803079.37
CRESTOR,8600472,2395819380.2099996
OXYCODONE-ACETAMINOPHEN,8250381,444323992.09
DONEPEZIL HCL,8052913,194387985.29999998
MELOXICAM,7921650,56024994.470000006
PROAIR HFA,7686762,451525668.56
ALLOPURINOL,7530262,69459113.43000002
ALENDRONATE SODIUM,7293735,75525328.64
RANITIDINE HCL,7170871,87715348.41000001
LISINOPRIL-HYDROCHLOROTHIAZIDE,7042874,61660247.66999999
NEXIUM,6968108,2422256935.2699995
MONTELUKAST SODIUM,6855005,193820317.04999998
ESCITALOPRAM OXALATE,6711864,141059806.65999997
DULOXETINE HCL,6503301,1299549926.38
QUETIAPINE FUMARATE,6398416,344499121.16
LATANOPROST,6339049,112311174.86999999
AZITHROMYCIN,6135891,59233312.989999995
CIPROFLOXACIN HCL,5924418,38133665.10999999
FLUOXETINE HCL,5834784,82081466.64999998
GLIMEPIRIDE,5613158,57195791.78
OXYCODONE HCL,5603775,272529852.76
LOVASTATIN,5551048,76714852.2
ISOSORBIDE MONONITRATE ER,5542060,95898313.63
ADVAIR DISKUS,5541448,2064905171.0499997
LOSARTAN-HYDROCHLOROTHIAZIDE,5512996,95233069.05000001
SPIRIVA,5339480,1956946798.4799995
SYNTHROID,5306839,206879791.19
MIRTAZAPINE,5235802,78296109.29000002
GLIPIZIDE,5077217,42183510.46
AMOXICILLIN,4970056,24123109.319999993
FENOFIBRATE,4957587,438239797.4800001
NAMENDA,4879366,1241647331.0200005
SPIRONOLACTONE,4612646,53522835.330000006
RISPERIDONE,4511603,92356467.66
TRIAMTERENE-HYDROCHLOROTHIAZID,4407324,53308712.32000001
FINASTERIDE,4357389,96933367.26
IBUPROFEN,4326254,34824688.79
PAROXETINE HCL,4313490,75138378.25
CLONIDINE HCL,4299189,37722883.65
ENALAPRIL MALEATE,4211624,56424392.29000001
JANUVIA,4112402,1591852562.3300009
LANTUS SOLOSTAR,3967264,1805583150.8300002
LYRICA,3933987,1208504599.46
METFORMIN HCL ER,3927209,110156746.98000003
LANTUS,3799781,1511895513.5600004
VENLAFAXINE HCL ER,3776399,145511344.82000002
CEPHALEXIN,3636174,26831203.969999995
FAMOTIDINE,3621252,38633663.76999999
DIOVAN,3614837,784411444.9700001
SULFAMETHOXAZOLE-TRIMETHOPRIM,3569752,21830063.030000005
AMITRIPTYLINE HCL,3539561,41848047.64
DIAZEPAM,3510005,24612711.360000003
HYDRALAZINE HCL,3501872,74809148.85000002
LEVOFLOXACIN,3378066,48175958.85000002
POLYETHYLENE GLYCOL 3350,3178311,74705597.06999998
ZETIA,3174655,898243212.4600002
TEMAZEPAM,3171737,40364815.07000001
VALSARTAN-HYDROCHLOROTHIAZIDE,3065182,179968803.19000003
TRIAMCINOLONE ACETONIDE,3052903,62427789.16000003
BENAZEPRIL HCL,3052603,30051090.500000004
MORPHINE SULFATE ER,2946254,290867807.89
LEVETIRACETAM,2919863,105160925.61999999
NAPROXEN,2872736,24055452.65
LAMOTRIGINE,2835316,44234301.559999995
CELEBREX,2829304,881309305.3100003
TIZANIDINE HCL,2815712,89200101.14000002
FENTANYL,2803034,345832972.77000004
BACLOFEN,2790878,56521523.93999999
OLANZAPINE,2712012,270030069.6699999
CYCLOBENZAPRINE HCL,2696200,51508903.92000002
XARELTO,2684840,915381796.09
ABILIFY,2677876,2246738757.45
DOXAZOSIN MESYLATE,2675492,85145805.51000002
SYMBICORT,2655360,790798550.2899997
KLOR-CON M20,2550689,65344605.81000001
DIVALPROEX SODIUM,2534690,94148001.77000003
BUPROPION XL,2500986,99651464.06
BD ULTRA-FINE PEN NEEDLE,2473580,114335782.14
ROPINIROLE HCL,2439553,78174577.50000001
RAMIPRIL,2421338,58331693.88
BUSPIRONE HCL,2401589,48229966.55000001
PREDNISOLONE ACETATE,2378009,149994480.36
CARBIDOPA-LEVODOPA,2374868,87048536.90000005
AMOX TR-POTASSIUM CLAVULANATE,2327900,40215020.029999994
NIFEDIPINE ER,2298940,102069888.29999998
TOPIRAMATE,2260947,46154713.929999985
DIGOX,2248777,93904414.60000004
AMLODIPINE BESYLATE-BENAZEPRIL,2242350,122989563.75
BENZTROPINE MESYLATE,2204320,22752194.449999996
METHYLPREDNISOLONE,2194209,48401483.209999986
OXYBUTYNIN CHLORIDE ER,2134351,128386751.57999997
PIOGLITAZONE HCL,2110714,146729882.06999996

2025-01-20 05:20:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:20:24 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:24 - root - INFO - SQL:
-- 12. Identify the drugs with the highest average cost per claim nationwide.
SELECT "drug_name", SUM("total_drug_cost") / SUM("total_claim_count") AS "avg_cost_per_claim"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
HAVING SUM("total_claim_count") > 0  -- Ensure division by zero is avoided
ORDER BY "avg_cost_per_claim" DESC
LIMIT 1000
Results:
Too long, hard cut:
drug_name,avg_cost_per_claim
ADAGEN,94218.08307692308
ELAPRASE,58922.49405405405
CINRYZE,52784.52038490568
FIRAZYR,48099.664440753055
BERINERT,47776.39671159029
CARBAGLU,44471.74333333333
NAGLAZYME,42268.6128440367
RAVICTI,41223.50049792531
PROCYSBI,40156.55495327103
ALDURAZYME,39379.55583333334
H.P. ACTHAR,39204.23321896073
CHENODAL,36052.11075
ACTIMMUNE,33417.868276836154
YERVOY,32363.61
HARVONI,32080.829197146297
GATTEX,28956.995817245806
KALBITOR,28842.32502189781
SOVALDI,28340.424900299837
ELELYSO,28307.3
JUXTAPID,27518.29496865204
LUMIZYME,27010.800597014924
KALYDECO,25481.912769516726
VPRIV,22641.465223880597
OLYSIO,22558.138000295654
INCIVEK,22557.087058823527
APOKYN,22329.24423580786
SOLIRIS,22265.210060240966
ARCALYST,21002.0
REMODULIN,20897.538095238095
MOZOBIL,20282.172083333335
KYNAMRO,20201.490625000002
ILARIS,19728.650555555552
VENTAVIS,17345.661
ZAVESCA,16975.584468085104
KORLYM,15957.928796296297
TARGRETIN,15888.062559999997
SYPRINE,15785.365827586207
ADCETRIS,15459.004
SIGNIFOR,15243.0755
KUVAN,14731.920958286355
FABRAZYME,14477.500735551663
CEREZYME,14467.57185858586
TYVASO,14185.003846153846
AFINITOR DISPERZ,13565.781923076924
BIVIGAM,12455.43
XALKORI,11575.664203494345
SABRIL,11442.97229428173
STELARA,11051.114118488835
POMALYST,10956.690261627908
ICLUSIG,10725.371255230124
OCTAGAM,10576.266011477761
COMETRIQ,10489.468520179373
SEROSTIM,10414.583615059546
KEYTRUDA,10196.00846153846
ACTIQ,10121.035454545454
CAPRELSA,9873.375465686273
AFINITOR,9699.803753008036
INLYTA,9660.476653789005
STIVARGA,9531.084188398087
TALWIN,9481.949999999999
REVLIMID,9364.143442414335
ZEMAIRA,9301.863337570368
ZYKADIA,9105.113513513514
MEKINIST,9028.769855687606
JEVTANA,9015.62534883721
JAKAFI,8997.707499677379
ERIVEDGE,8984.350845070425
IMBRUVICA,8907.086982665869
DACOGEN,8906.497647058823
ZELBORAF,8896.525093023254
PROLASTIN C,8887.33505543902
GAMMAGARD LIQUID,8785.366058134367
GLASSIA,8705.734157441575
BUPHENYL,8699.849310344827
SODIUM PHENYLBUTYRATE,8581.633061224491
GAMMAKED,8513.787644991213
NEXAVAR,8498.062598408258
XYREM,8300.493277232352
FENTORA,8290.50756804214
SUBSYS,8273.914342337051
XTANDI,8242.413887552777
BOSULIF,8221.538396226417
GLEEVEC,8217.76359406148
GAMMAPLEX,8024.499895178196
SPRYCEL,8015.665063218754
FERRIPROX,8012.841844106463
DECITABINE,8007.6016
SOMAVERT,7955.650682730926
ESBRIET,7921.287272727273
RITUXAN,7910.220963503651
ABSTRAL,7779.462036474165
TASIGNA,7754.0396306301
TAFINLAR,7687.024580792681
TRACLEER,7625.6115161753505
ADEMPAS,7414.1150761019935
ERBITUX,7307.490791788858
EXJADE,7272.785586080585
LETAIRIS,7174.756180604912
ZYTIGA,7169.337561926254
OPSUMIT,7132.927883277897
ZYDELIG,7130.996666666667
HETLIOZ,7113.059843749999
TOBI PODHALER,7103.474591836734
XENAZINE,7093.926011129076
VOTRIENT,7070.065869224748
VECTIBIX,7049.693846153847
PRIVIGEN,7029.571949247073
THALOMID,6999.393932141351
SYLATRON,6993.137142857143
ZOLINZA,6934.363558558558
SUTENT,6898.2065613344375
GAMUNEX-C,6867.900701312576
TREANDA,6753.471822916667
NORTHERA,6663.645833333333
SAMSCA,6656.064114194237
ORENITRAM ER,6632.469167502508
ARALAST NP,6597.980266299356
PLEGRIDY PEN,6391.056923076923
KADCYLA,6263.2320425531925
CAYSTON,6187.300148423006
DEMSER,6180.5233333333335
GILOTRIF,6135.664878928388
SYNRIBO,6067.28
LAZANDA,6042.239689922481
GAZYVA,5991.2840625
TARCEVA,5978.279426167974
VICTRELIS,5940.296101694915
VIDAZA,5881.175390625001
TECFIDERA,5862.015208607574
GILENYA,5718.869288944333
LEUKINE,5709.28370015949
IXEMPRA,5568.587500000001
SUCRAID,5502.988666666667
NEULASTA,5408.43845786421
SANDOSTATIN,5381.223251533743
COPAXONE,5369.262740946855
AUBAGIO,5349.6182635918185
ANDROID,5326.286724137931
VELCADE,5306.94219795222
SYLATRON 4-PACK,5284.4277142857145
PROMACTA,5276.241423113658
ABRAXANE,5209.18233983287
REBIF REBIDOSE,5208.073691683572
BETASERON,5157.922732842652
HERCEPTIN,5154.900042046251
SIMPONI ARIA,5142.2157
AVONEX PEN,5075.078467251718
REBIF,5038.7079481121655
AVONEX,4985.120593511677
ALIMTA,4947.558982346833
GAMMAGARD S-D,4940.157027972028
AVASTIN,4932.66626688103
AVONEX ADMINISTRATION PACK,4867.616074907987
TYSABRI,4834.982584493042
NPLATE,4790.93682648402
NOXAFIL,4768.724549583648
VALCHLOR,4749.402857142856
SOMATULINE DEPOT,4748.1211683532665
FLEBOGAMMA DIF,4745.912929936306
AZACITIDINE,4686.148716216216
HALAVEN,4652.826363636364
CARIMUNE NF NANOFILTERED,4583.243496835444
PERJETA,4527.309187817259
REMICADE,4521.610731423587
SIRTURO,4460.722
NILANDRON,4375.300922444184
ALBENZA,4336.903184357541
TYKERB,4298.760754048583
HIZENTRA,4198.0624162414015
DIFICID,4096.061467889908
TOBI,4031.3399999999997
SANDOSTATIN LAR,4002.4689945266564
DOXIL,3991.0833333333335
SAIZEN,3807.7038644688646
CYSTARAN,3734.896593406593
D.H.E.45,3668.3695999999995
TORISEL,3564.5183333333334
EXTAVIA,3466.044709228823
REVATIO,3419.5773914231086
HUMIRA,3373.8089135500277
CIMZIA,3346.965377376984
KINERET,3286.642341549296
TASMAR,3271.671833333333
PEGASYS PROCLICK,3216.8207825567506
SIMPONI,3214.732058321871
PEGASYS,3207.130610958904
PU

2025-01-20 05:20:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:20:25 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:26 - root - INFO - SQL:
-- 13. Retrieve total claim counts per provider in New York State.
SELECT "npi", SUM("total_claim_count") AS "provider_total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "npi"
ORDER BY "provider_total_claims" DESC
LIMIT 1000
Results:
Too long, hard cut:
npi,provider_total_claims
1457492688,65131
1093793101,57140
1639171143,53895
1730172776,52654
1588750467,52409
1174639819,51997
1508896457,48926
1467560656,45848
1124087713,45205
1154417871,44196
1588633135,43555
1356318992,43313
1366432213,43287
1265455109,41793
1235223868,41347
1639138654,41209
1245229905,38711
1487640900,37918
1891720058,37644
1154384782,37292
1407801798,37226
1619082625,36466
1609882000,36146
1255395935,35379
1073671400,35129
1962422972,35040
1619989514,34879
1467446054,34572
1083646970,34489
1932112158,34109
1831196898,33535
1487633772,33476
1679570246,33313
1649275918,32579
1477720167,32342
1013019454,32297
1215028956,32274
1093798746,32273
1760431761,31452
1306847405,31199
1255313391,30980
1154493575,30905
1093777930,30764
1114968385,30670
1851507362,30565
1912011107,30269
1083765531,30161
1720016793,30112
1750558979,29988
1659353068,29838
1871530949,29748
1528235181,29361
1386745578,29297
1568607919,29264
1497837090,28789
1154310266,28662
1336184290,28157
1740508696,28136
1528140597,28032
1083750913,28004
1275639502,27675
1639346976,27674
1235113044,27660
1316924715,27476
1043381569,27453
1881623445,27358
1164433900,27283
1922039213,27200
1841253267,27197
1912950858,27182
1588644991,27138
1629295571,27128
1982699773,27126
1942253158,27072
1659354983,27041
1316914021,27001
1063400521,26977
1326057787,26877
1235122326,26542
1386605566,26311
1568513257,26246
1467487801,25989
1124187307,25973
1679560833,25846
1477509602,25801
1710071063,25697
1417992322,25508
1649280413,25417
1033205117,25288
1689654220,25146
1679674717,25008
1215997887,24881
1932261716,24826
1447296421,24760
1790714962,24673
1205948668,24469
1205867835,24371
1285679498,24361
1366425530,24260
1144340225,24218
1780772947,24202
1558451450,24109
1558465237,24102
1144277443,23943
1437151537,23938
1023028354,23669
1871674960,23397
1316979651,23351
1790750859,23328
1588712152,23316
1780654558,23313
1427067644,23290
1093880957,23228
1477501609,23194
1710181110,23141
1558445478,23133
1720059298,23033
1508060880,23031
1205803509,22912
1750302576,22907
1265595300,22865
1134112691,22794
1164447629,22789
1164406229,22678
1235127150,22645
1902835192,22589
1174633622,22527
1841231057,22516
1023119039,22477
1851539415,22449
1508890740,22442
1144222340,22434
1326000498,22315
1144271917,22288
1558372086,22286
1619998077,22247
1447340237,22223
1528153467,22202
1760407084,22109
1386733442,22091
1992907539,22002
1013900513,21988
1710978481,21967
1265480073,21950
1982662458,21947
1891700605,21940
1720146699,21909
1801824255,21906
1457561920,21879
1861570558,21871
1679619233,21722
1033277827,21706
1225080054,21673
1588658512,21635
1326111550,21499
1053309039,21491
1154332310,21440
1396793113,21376
1053429829,21372
1508809740,21318
1619984432,21302
1700870953,21237
1245247402,21222
1902831175,21219
1750332623,21205
1073561056,21133
1942335096,21089
1942381405,21053
1205947074,20996
1881601052,20969
1215949219,20921
1033202544,20892
1346221264,20830
1902978141,20796
1053361816,20782
1538438858,20779
1992749410,20638
1386733764,20546
1821162611,20522
1124017249,20456
1205885514,20424
1235210956,20402
1659476711,20342
1720035082,20304
1255358164,20292
1174592455,20288
1396820759,20200
1285605394,20192
1649351214,20128
1023052784,20126
1487741039,20020
1083798920,20018
1225069446,20008
1801017470,19985
1619977675,19924
1821172362,19908
1093784837,19871
1306852942,19822
1992773329,19795
1942211776,19788
1346321254,19788
1730125618,19714
1295758860,19550
1972516482,19547
1861436719,19541
1588823025,19505
1942272323,19426
1912908203,19371
1467450759,19342
1932274156,19274
1609869833,19269
1386601557,19188
1306823935,19180
1821053299,19173
1538131388,19133
1295739944,19129
1942393343,19046
1245231083,18977
1780623868,18886
1497771018,18849
1003880055,18809
1528004207,18778
1336229392,18744
1194740506,18700
1154326825,18678
1942226485,18653
1831160589,18620
1750339404,18606
1619925344,18576
1528003019,18510
1194748822,18502
1346450897,18499
1326032012,18445
1831248095,18438
1215906078,18385
1427095686,18384
1023106838,18381
1386733715,18374
1508880006,18371
1730181868,18309
1083632392,18290
1821056433,18284
1548299670,18272
1861456196,18268
1902955768,18208
1225050404,18196
1861587438,18188
1386711612,18110
1356382246,18101
1033161021,18074
1568750057,18060
1154497642,17992
1508933581,17962
1053342535,17962
1326131616,17948
1912993098,17934
1134124464,17933
1033233879,17906
1285681643,17853
1013953975,17831
1003875733,17817
1760496921,17802
1720022486,17763
1467490896,17732
1811007743,17648
1972684751,17646
1306885306,17608
1548333552,17594
1972532554,17573
1295803120,17567
1003825274,17547
1073598660,17508
1689765901,17501
1326073289,17487
1497778799,17486
1275556623,17473
1023030251,17468
1003845660,17459
1750457032,17438
1649341843,17398
1285794925,17383
1578625737,17369
1043316755,17291
1982780078,17252
1548261811,17171
1194915389,17155
1053419028,17143
1033147426,17138
1629031208,17093
1225025109,17090
1477508117,17076
1649379934,17073
1528092707

2025-01-20 05:20:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 190
2025-01-20 05:20:27 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:28 - root - INFO - SQL:
-- 14. Find the specialties with the highest total claim counts nationwide.
SELECT "specialty_description", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "specialty_description"
ORDER BY "total_claims" DESC
LIMIT 1000
Results:
Too long, hard cut:
specialty_description,total_claims
Internal Medicine,385858450
Family Practice,361410647
Nurse Practitioner,77798973
Cardiology,67061172
Psychiatry,40912819
Physician Assistant,40433925
General Practice,30214429
Ophthalmology,23576481
Neurology,18610103
Nephrology,13896844
Emergency Medicine,12468018
Endocrinology,12427024
Urology,11877008
Pulmonary Disease,11506976
Geriatric Medicine,10970038
Rheumatology,10879733
Gastroenterology,10337430
Dermatology,6086148
Physical Medicine and Rehabilitation,6041716
Orthopedic Surgery,5957525
Dentist,5507795
Hematology/Oncology,5323040
Anesthesiology,4356238
Interventional Pain Management,4052937
Psychiatry & Neurology,3965578
Optometry,3911430
Obstetrics/Gynecology,3842451
General Surgery,3796486
Infectious Disease,3618386
Otolaryngology,3607257
Pain Management,2987367
Podiatry,2747446
Certified Clinical Nurse Specialist,2227157
Student in an Organized Health Care Education/Training Program,2136393
Cardiac Electrophysiology,2030588
Allergy/Immunology,1982136
Pediatric Medicine,1960228
Medical Oncology,1536571
Oral Surgery (dentists only),922026
Critical Care (Intensivists),787028
Osteopathic Manipulative Medicine,760072
Neurosurgery,740265
Specialist,649455
Neuropsychiatry,612804
Vascular Surgery,491463
Preventive Medicine,395584
Pharmacist,392667
Family Medicine,391783
Registered Nurse,335449
Plastic and Reconstructive Surgery,323740
Cardiac Surgery,322047
Hematology,303023
Radiation Oncology,299581
Diagnostic Radiology,278532
Maxillofacial Surgery,255078
Hospice and Palliative Care,243237
Geriatric Psychiatry,225099
Thoracic Surgery,217715
Clinic/Center,184814
Colorectal Surgery (formerly proctology),177762
Hand Surgery,150760
Gynecological/Oncology,139191
Addiction Medicine,120726
Sports Medicine,114748
Multispecialty Clinic/Group Practice,112220
Legal Medicine,94363
Nuclear Medicine,88485
Hospitalist,77109
Orthopaedic Surgery,71631
Sleep Medicine,70563
Pathology,65949
Interventional Radiology,61565
Psychologist (billing independently),60265
Certified Nurse Midwife,54794
Surgical Oncology,50046
Community Health Worker,48937
"Medical Genetics, Ph.D. Medical Genetics",48271
Clinical Psychologist,47463
Peripheral Vascular Disease,41768
Counselor,39785
Oral & Maxillofacial Surgery,38207
Licensed Practical Nurse,36464
Unknown Physician Specialty Code,36100
Naturopath,33196
Driver,32162
CRNA,29108
Personal Emergency Response Attendant,21539
Plastic Surgery,19845
Hospital (Dmercs Only),16848
Neurological Surgery,16469
Health Maintenance Organization,15273
Chiropractic,13746
Rehabilitation Agency,13658
General Acute Care Hospital,13390
Interventional Cardiology,13310
Thoracic Surgery (Cardiothoracic Vascular Surgery),12859
Case Manager/Care Coordinator,12058
"Neuromusculoskeletal Medicine, Sports Medicine",11769
Respite Care,8909
Independent Medical Examiner,7712
Licensed Clinical Social Worker,6956
Surgery,6653
Public Health Welfare Agency,4895
Contractor,4608
Clinical Pharmacology,4594
Clinical Neuropsychologist,4417
Acupuncturist,4324
Physical Therapist,4069
Midwife,3371
Unknown Supplier/Provider,3005
Psychoanalyst,2684
Point of Service,2253
Chronic Disease Hospital,2220
Radiology,1921
Obstetrics & Gynecology,1779
Psychologist,1772
Behavioral Analyst,1751
Prosthetist,1172
Licensed Vocational Nurse,1140
Colon & Rectal Surgery,1109
Homeopath,924
Rehabilitation Practitioner,857
Occupational therapist,848
Exclusive Provider Organization,845
Speech Language Pathologist,798
Marriage & Family Therapist,735
Religious Nonmedical Nursing Personnel,663
Medical Genetics,627
Social Worker,618
Preferred Provider Organization,587
Adult Companion,520
Dental Hygienist,502
Military Health Care Provider,450
Physical Medicine & Rehabilitation,413
Denturist,403
Electrodiagnostic Medicine,384
Technician/Technologist,329
Slide Preparation Facility,327
Registered Dietician/Nutrition Professional,321
Pediatrics,316
Nutritionist,308
Specialist/Technologist,306
Naprapath,277
Audiologist (billing independently),268
Chore Provider,232
Dental Assistant,213
"Specialist/Technologist, Other",212
Case Management,209
Anesthesiologist Assistants,208
"Respiratory Therapist, Certified",179
"Emergency Medical Technician, Intermediate",154
"Emergency Medical Technician, Basic",152
"Nursing Facility, Other (Dmercs Only)",144
Substance Abuse Rehabilitation Facility,143
"Spec/Tech, Cardiovascular",140
Ambulatory Surgical Center,126
Radiologic Technologist,120
Home Health Aide,116
Physical Therapy Assistant,113
Massage Therapist,111
Community/Behavioral Health,109
Phlebology,104
Occupational Therapy Assistant,101
Durable Medical Equipment & Medical Supplies,91
Clinical Medical Laboratory,90
Military Hospital,87
Technician,82
Optician,78
"Spec/Tech, Pathology",57
Nurse's Aide,56
Rehabilitation Counselor,55
Pharmacy Technician,55
"Residential Treatment Facility, Emotionally Disturbed Children",47
Pharmacy,35
Mass Immunization Roster Biller,35
Licensed Psychiatric Technician,33
"Medical Supply Company, Other",30
"Ge

2025-01-20 05:20:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:20:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:20:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:20:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 05:20:29 - snowflake.connector.connection - INFO - closed
2025-01-20 05:20:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:20:30 - root - INFO - SQL:
-- 15. List total drug costs per city in New York State.
SELECT "nppes_provider_city", SUM("total_drug_cost") AS "city_total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "nppes_provider_city"
ORDER BY "city_total_cost" DESC
LIMIT 1000
Results:
Too long, hard cut:
nppes_provider_city,city_total_cost
NEW YORK,1381447820.7600005
BROOKLYN,939567561.99
BRONX,442377376.72999996
ROCHESTER,297455250.8599999
FLUSHING,180465300.49
ALBANY,164038339.42000005
STATEN ISLAND,146385378.27000004
BUFFALO,146117772.1
SYRACUSE,107722980.39000002
WILLIAMSVILLE,95257449.82000002
FOREST HILLS,65517355.66
NEW HYDE PARK,65036679.34000001
JAMAICA,54070267.879999995
SCHENECTADY,53222507.050000004
YONKERS,53005053.97999999
MIDDLETOWN,52931350.90000003
BINGHAMTON,50174731.98000001
ELMHURST,48946385.480000004
GREAT NECK,48669597.300000004
POUGHKEEPSIE,48358056.580000006
WHITE PLAINS,47363487.69
MANHASSET,45831665.7
NEW HARTFORD,42753347.37000001
REGO PARK,41217154.099999994
AMHERST,38511866.68000001
KINGSTON,37976679.37
MINEOLA,37818040.67999999
SMITHTOWN,35843945.28
LAKE SUCCESS,34683996.82
ORCHARD PARK,33925638.51
BAY SHORE,33817027.42000001
JACKSON HEIGHTS,33662502.0
ROCKVILLE CENTRE,33444079.009999998
ASTORIA,33284492.03999999
UTICA,31396867.169999994
HUNTINGTON,29877777.07
EAST SETAUKET,29414618.329999994
ELMIRA,29217237.059999995
TROY,28729272.930000007
WEST SENECA,28486620.950000003
VALHALLA,27438195.740000002
NIAGARA FALLS,26872722.01000001
GARDEN CITY,26520690.620000005
RIVERHEAD,25911390.330000006
GLENS FALLS,25870704.32
STONY BROOK,25095516.350000005
SARATOGA SPRINGS,25085995.089999996
WATERTOWN,24717859.400000002
JAMESTOWN,24509370.389999997
FAR ROCKAWAY,24062389.86
FISHKILL,23942822.030000016
PLATTSBURGH,23795270.560000002
LIVERPOOL,23515728.83
CHEEKTOWAGA,22435470.839999996
OLEAN,22202163.380000003
NEW ROCHELLE,21535504.149999995
MASSAPEQUA,19862954.349999998
EAST SYRACUSE,19511564.16
COOPERSTOWN,19471224.6
PLAINVIEW,19313748.46000001
WEST NYACK,18934459.810000002
JOHNSON CITY,18802021.669999994
ITHACA,18064281.32
MOUNT KISCO,17595387.56
BAYSIDE,17018159.220000006
LATHAM,16955182.590000004
NEWBURGH,16752602.12
FRESH MEADOWS,16721118.780000001
ROME,16238946.090000004
AUBURN,16076030.05
AMSTERDAM,15755200.319999998
SUFFERN,15684966.550000008
EAST MEADOW,15422751.349999994
GOSHEN,14734687.460000005
SCARSDALE,14224777.359999994
VESTAL,14088987.69
CORNING,13765833.919999998
BETHPAGE,13614534.000000002
HORSEHEADS,13568569.860000001
POMONA,13549434.599999998
VALLEY STREAM,13059484.309999997
LYNBROOK,12985280.6
OSWEGO,12885013.239999993
YORKTOWN HEIGHTS,12790316.76
PORT JEFFERSON,12778708.840000004
AMITYVILLE,12628861.57
ROSLYN,12528975.469999999
HAWTHORNE,12035707.060000006
HUDSON,12011562.479999997
HICKSVILLE,11869879.340000004
SYOSSET,11795539.039999997
CANANDAIGUA,11590664.370000001
BATAVIA,11414495.399999995
BABYLON,11393320.890000002
WEST ISLIP,11331308.74
NEW WINDSOR,11265538.749999993
PORT JEFFERSON STATION,10902174.109999994
LOCKPORT,10874175.879999999
CLIFTON SPRINGS,10810599.170000006
GENEVA,10806279.170000002
GLEN COVE,10777943.87
E SETAUKET,10754767.479999997
PATCHOGUE,10658848.450000001
COMMACK,10546363.739999998
ONEONTA,10262734.849999996
NEW CITY,9993587.780000001
SOUTH RICHMOND HILL,9815675.829999998
GLOVERSVILLE,9757721.920000002
FREEPORT,9688891.040000003
WOODSIDE,9612428.23
EAST PATCHOGUE,9561135.959999999
LONG BEACH,9497272.379999997
TONAWANDA,9378252.489999998
MALONE,9276843.34
MONTICELLO,9222707.009999998
QUEENSBURY,8730951.460000005
CLIFTON PARK,8716323.46
HAUPPAUGE,8706413.99
RIDGEWOOD,8661619.249999998
HEWLETT,8531021.460000003
OGDENSBURG,8378191.97
RICHMOND HILL,8338837.800000001
LONG ISLAND CITY,8338733.37
FAYETTEVILLE,8308120.74
BREWSTER,8192291.079999999
CORTLAND,8107423.779999998
HORNELL,7918876.949999999
SARANAC LAKE,7897594.619999999
CAMILLUS,7726631.500000003
HAMBURG,7692652.070000001
MEDFORD,7672428.71
ISLIP,7664897.190000003
MOUNT VERNON,7613627.8900000015
WOODBURY,7439377.659999999
CORTLANDT MANOR,7378570.320000001
QUEENS VILLAGE,7238038.999999999
CORONA,7105348.949999997
KENMORE,6939267.300000001
LEWISTON,6918358.700000001
HEMPSTEAD,6843091.44
HOWARD BEACH,6831392.550000001
HUNTINGTON STATION,6782984.979999998
DUNKIRK,6483644.749999999
LAKE RONKONKOMA,6416212.300000001
WEBSTER,6380557.48
BRENTWOOD,6332377.110000001
CARMEL,6318069.500000001
SLINGERLANDS,6211498.989999998
ONEIDA,6159369.94
NYACK,6138879.010000001
ENDWELL,6088188.919999998
DEER PARK,5928421.019999999
LAWRENCE,5913951.979999997
NORWICH,5911517.130000003
NORTH SYRACUSE,5882984.28
MIDDLE VILLAGE,5881849.990000001
OCEANSIDE,5837954.440000001
CEDARHURST,5794501.200000003
DELMAR,5741320.829999999
NANUET,5706706.779999997
SOUTHAMPTON,5693047.610000001
NESCONSET,5617783.47
RYE,5610028.490000002
BATH,5609065.390000001
BRONXVILLE,5575032.290000002
FAIRPORT,5551246.6800000025
NEWARK,5456101.28
WARSAW,5438391.7299999995
OSSINING,5321767.47
GARNERVILLE,5309168.069999998
CORNWALL,5223707.529999999
POTSDAM,5144302.4799999995
PITTSFORD,5133215.839999999
SEAFORD,5101835.91
RYE BROOK,5073462.240000001
DANSVILLE,5035367.76
WEST BABYLON,5034279.38
ENDICOTT,5017987.170000001
PENN YAN,4951728.36
NORTH BABYLON,4950814.72
MEDINA,4872225.27
KEW GARDENS,4808340.849999999
MASSENA,4718675.71
CANTON,4676148.13
HOLLIS

2025-01-20 05:20:30 - root - INFO - itercount: 0
2025-01-20 05:20:30 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"`
  - `"drug_name"`: To identify the names of drugs prescribed.
  - `"nppes_provider_state"`: To filter data by state.
  - `"total_claim_count"`: To find the total number of prescriptions (claims) for each drug.
  - `"total_drug_cost"`: To determine the total cost associated with the prescriptions.
  - `"npi"`: National Provider Identifier, to identify unique prescribers.

**Conditions that may be used:**

- Filter records for New York State: `"nppes_provider_state" = 'NY'`
- Aggregate data by `"drug_name"` to sum total claims and costs.
- Group data by `"nppes_provider_state"` to compare between states.
- Order results by total claim counts or total drug costs in descending order.

---

**SQL Queries:**

```sql
-- 1. List all distinct states in the dataset.
SELECT DISTINCT "nppes_provider_state"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
LIMIT 1000;
```

```sql
-- 2. Retrieve all distinct drug names prescribed in New York State.
SELECT DISTINCT "drug_name"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
LIMIT 1000;
```

```sql
-- 3. Get total claim counts for each drug in New York State.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 1000;
```

```sql
-- 4. Find total drug costs for each drug in New York State.
SELECT "drug_name", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "total_cost" DESC
LIMIT 1000;
```

```sql
-- 5. List the top 10 drugs by total claim counts across all states.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 10;
```

```sql
-- 6. Get total claim counts per state for a specific drug.
SELECT "nppes_provider_state", SUM("total_claim_count") AS "state_total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "drug_name" = 'DrugNamePlaceholder'
GROUP BY "nppes_provider_state"
ORDER BY "state_total_claims" DESC
LIMIT 1000;
```

```sql
-- 7. Retrieve total drug costs per state for a specific drug.
SELECT "nppes_provider_state", SUM("total_drug_cost") AS "state_total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "drug_name" = 'DrugNamePlaceholder'
GROUP BY "nppes_provider_state"
ORDER BY "state_total_cost" DESC
LIMIT 1000;
```

```sql
-- 8. Calculate average drug cost per claim for each drug in New York State.
SELECT "drug_name", SUM("total_drug_cost") / SUM("total_claim_count") AS "avg_cost_per_claim"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "avg_cost_per_claim" DESC
LIMIT 1000;
```

```sql
-- 9. Find the number of unique prescribers per state.
SELECT "nppes_provider_state", COUNT(DISTINCT "npi") AS "number_of_prescribers"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "number_of_prescribers" DESC
LIMIT 1000;
```

```sql
-- 10. Retrieve total claim counts and total drug costs per state.
SELECT "nppes_provider_state", SUM("total_claim_count") AS "total_claims", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "total_claims" DESC
LIMIT 1000;
```

```sql
-- 11. Get total claim counts and total drug costs for each drug nationwide.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 1000;
```

```sql
-- 12. Identify the drugs with the highest average cost per claim nationwide.
SELECT "drug_name", SUM("total_drug_cost") / SUM("total_claim_count") AS "avg_cost_per_claim"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "avg_cost_per_claim" DESC
LIMIT 1000;
```

```sql
-- 13. Retrieve total claim counts per provider in New York State.
SELECT "npi", SUM("total_claim_count") AS "provider_total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "npi"
ORDER BY "provider_total_claims" DESC
LIMIT 1000;
```

```sql
-- 14. Find the specialties with the highest total claim counts nationwide.
SELECT "specialty_description", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "specialty_description"
ORDER BY "total_claims" DESC
LIMIT 1000;
```

```sql
-- 15. List total drug costs per city in New York State.
SELECT "nppes_provider_city", SUM("total_drug_cost") AS "city_total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "nppes_provider_city"
ORDER BY "city_total_cost" DESC
LIMIT 1000;
```

---

These queries explore various aspects of the dataset, such as total claim counts and costs per drug, per state, and per provider. They help understand the distribution and usage patterns of prescription drugs across different regions and specialties without directly answering the specific task.Query:
-- 1. List all distinct states in the dataset.
SELECT DISTINCT "nppes_provider_state"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
LIMIT 1000;
Answer:
nppes_provider_state
WI
AA
NY
TX
AE
DE
NM
MO
AR
WY
RI
MA
MP
WV
OK
SD
ID
NH
PR
NC
AL
VA
IN
AK
CT
NJ
MI
TN
CO
NE
IA
DC
OH
IL
MT
KS
LA
ME
GU
UT
AS
NV
SC
OR
PA
MD
FL
CA
GA
AZ
ND
ZZ
WA
HI
KY
AP
VT
MN
XX
MS
VI
Query:
-- 2. Retrieve all distinct drug names prescribed in New York State.
SELECT DISTINCT "drug_name"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
LIMIT 1000;
Answer:
Too long, hard cut:
drug_name
ECONAZOLE NITRATE
TRAMADOL HCL-ACETAMINOPHEN
ZETIA
DUREZOL
LANTUS SOLOSTAR
GALANTAMINE HBR
GEMFIBROZIL
DOXEPIN HCL
LANTUS
TOPROL XL
HALOBETASOL PROPIONATE
TRAVOPROST
AMPICILLIN TRIHYDRATE
PEN NEEDLES
GATIFLOXACIN
FLUNISOLIDE
POLYMYXIN B SUL-TRIMETHOPRIM
PERPHENAZINE
DILANTIN
CILOSTAZOL
ORPHENADRINE CITRATE
ADCIRCA
BCG VACCINE (TICE STRAIN)
FENOGLIDE
NITROLINGUAL
TEKAMLO
LUXIQ
PREDNICARBATE
TRUEPLUS INSULIN SYRINGE
TYGACIL
OXANDROLONE
LEVOXYL
SYMLINPEN 120
TRI-PREVIFEM
ORSYTHIA
OSMOPREP
EVOXAC
ADAPALENE
ZELAPAR
ACETIC ACID-ALUMINUM
E.E.S. 200
CORTISPORIN
TREXALL
FYCOMPA
ALDACTAZIDE
VINORELBINE TARTRATE
NORTHERA
TRIBENZOR
LYRICA
TIKOSYN
NYSTATIN
K-TAB ER
METHOCARBAMOL
CORTISONE ACETATE
GLUCOPHAGE
METAXALONE
ATRIPLA
HYDROCORTISONE-ACETIC ACID
PROTRIPTYLINE HCL
ACITRETIN
ALVESCO
ULTICARE
OPIUM TINCTURE
OPSUMIT
ERYPED 200
1ST TIER UNIFINE PENTIPS
HALDOL DECANOATE 100
TENIVAC
CAYSTON
PRANDIMET
FIRAZYR
INTERMEZZO
KENALOG-40
GAMMAKED
LACTATED RINGERS
VECTIBIX
HALFLYTELY-BISACODYL
DUETACT
PIROXICAM
METOCLOPRAMIDE HCL
PERMETHRIN
ULORIC
SINGULAIR
RISPERIDONE ODT
PHENOBARBITAL
ASCOMP WITH CODEINE
GILOTRIF
ZAFIRLUKAST
NICOTROL
JENTADUETO
SOLARAZE
ABILIFY MAINTENA
PREVIDENT 5000 PLUS
COSOPT
TIVICAY
FLUOCINONIDE
XGEVA
ERGOLOID MESYLATES
GLUCAGON EMERGENCY KIT
DENTAGEL
NORA-BE
MS CONTIN
KELNOR 1-35
TOBRAMYCIN SULFATE
INNOPRAN XL
SULFADIAZINE
LEUKINE
ENTOCORT EC
ALBUMINAR-25
PRECOSE
ANZEMET
ABILIFY
COMBIVENT RESPIMAT
RANITIDINE HCL
RANEXA
TEKTURNA
DILTIAZEM HCL
AMLODIPINE BESYLATE-BENAZEPRIL
PRINIVIL
BUTALB-CAFF-ACETAMINOPH-CODEIN
BROMOCRIPTINE MESYLATE
ATROPINE SULFATE
PULMICORT
RELISTOR
NIACOR
APIDRA SOLOSTAR
AMBISOME
LAMICTAL
ZEGERID
EASY TOUCH
CYCLOSPORINE MODIFIED
AMLODIPINE-VALSARTAN
QUINIDINE GLUCONATE
PACLITAXEL
ARAVA
GILENYA
PHENYTEK
DIDANOSINE
EURAX
CYSTADANE
LORTAB
STAXYN
DIAMOX SEQUELS
MIACALCIN
BETAPACE
CARIMUNE NF NANOFILTERED
AMTURNIDE
LESCOL
VARIVAX VACCINE
ZOSYN
CARNITOR
IMURAN
ARICEPT ODT
AVODART
LEVOTHYROXINE SODIUM
RAPAFLO
TRAMADOL HCL
MONOJECT INSULIN SYRINGE
AZELASTINE HCL
ACETAMINOPHEN-CODEINE
OFLOXACIN
HYDROXYCHLOROQUINE SULFATE
ENBREL
FAMCICLOVIR
SEREVENT DISKUS
NAPROXEN SODIUM
GAMMAGARD LIQUID
NEFAZODONE HCL
ELMIRON
ZARONTIN
GRANISETRON HCL
ROXICODONE
DESOGESTREL-ETHINYL ESTRADIOL
EMOQUETTE
CODEINE SULFATE
INDERAL LA
HEALTHY ACCENTS UNIFINE PENTIP
ZIANA
XALKORI
MEPERIDINE HCL
PHILITH
MAXZIDE-25 MG
ENABLEX
EXEMESTANE
TRAVATAN Z
TRADJENTA
AMILORIDE HCL
TOVIAZ
ONDANSETRON HCL
JANTOVEN
DIPYRIDAMOLE
ISOSORBIDE MONONITRATE
GAVILYTE-G
NARATRIPTAN HCL
HUMULIN N KWIKPEN
BETIMOL
LO LOESTRIN FE
FASLODEX
TYVASO
GENTAK
RIBAPAK
ADEFOVIR DIPIVOXIL
INFANRIX DTAP
MAXALT MLT
SINEMET CR
OB COMPLETE
PREVIFEM
ERYPED 400
SUBSYS
LARIN FE
AMOXICILLIN-CLAVULANATE ER
LEVAQUIN
UNIVASC
RAZADYNE ER
TETANUS DIPHTHERIA TOXOIDS
MACRODANTIN
DILTZAC ER
VANDAZOLE
VALACYCLOVIR
CLINDAMYCIN HCL
PAROXETINE HCL
DIOVAN
UNIFINE PENTIPS
FELODIPINE ER
COMFORT EZ
DOXAZOSIN MESYLATE
DRONABINOL
FLOVENT DISKUS
CANDESARTAN CILEXETIL
BETAXOLOL HCL
REMERON
AMARYL
RIBAVIRIN
EXFORGE HCT
QNASL
RELPAX
EFFEXOR XR
MAXALT
MAGNESIUM SULFATE
TRIVORA-28
HEXALEN
DELESTROGEN
AVELOX
SURE-JECT INSULIN SYRINGE
EASY TOUCH INSULIN SYRINGE
GLUCOTROL
ANGELIQ
GENERESS FE
MIRVASO
GLIPIZIDE ER
TRELSTAR
PEG-3350 AND ELECTROLYTES
NAMENDA XR
CEFADROXIL
SAVELLA
PHENYTOIN
TYSABRI
DILT-XR
FLOMAX
MINIVELLE
EPINASTINE HCL
EDARBI
EDECRIN
THALOMID
DOXY 100
ITRACONAZOLE
TOPICORT
SOLU-CORTEF
TRIGLIDE
TYLENOL-CODEINE NO.4
ZYCLARA
PRENATE ESSENTIAL
RAYOS
COLISTIMETHATE
SILVADENE
ERTACZO
ACULAR LS
OMEPRAZOLE
ZYTIGA
CARBIDOPA-LEVODOPA ER
AMIODARONE HCL
HYDROCORTISONE VALERATE
MYRBETRIQ
PROTONIX
LUPRON DEPOT
BETAMETHASONE VALERATE
MEGACE ES
PAXIL CR
ESTRADIOL-NORETHINDRONE ACETAT
TEKTURNA HCT
RETROVIR
WELLBUTRIN SR
FOCALIN XR
BANZEL
RISPERDAL M-TAB
ALTABAX
PRENATE MINI
NUTROPIN AQ
XYLOCAINE-MPF
PREVIDENT 5000 ENAMEL PROTECT
IBUPROFEN
LACTULOSE
FAMOTIDINE
INDOMETHACIN
NIFEDIPINE ER
SANTYL
BUMETANIDE
RAMIPRIL
KETOCONAZOLE
ROZEREM
JANUMET
SYNTHROID
NOVOLOG FLEXPEN
CARISOPRODOL
CONCERTA
ENDOCET
BOOSTRIX TDAP
ALBUTEROL SULFATE
ZENPEP
BD ULTRA-FINE PEN NEEDLE
VORICONAZOLE
HUMIRA
TEFLARO
DESMOPRESSIN ACETATE
EPIVIR
CLOZARIL
ENPRESSE
ACAMPROSATE CALCIUM
TWYNSTA
DIPHENHYDRAMINE HCL
LOTRONEX
ANTARA
RAZADYNE
DEPEN
EPINEPHRINE
FALMINA
SOLODYN
ETIDRONATE DISODIUM
MOZOBIL
VINCASAR PFS
KEPPRA
CALCITRIOL
PROCTOZONE-HC
NOVOLOG MIX 70-30
CEFDINIR
DEPAKOTE
GLIPIZIDE XL
IMIPRAMINE HCL
SENSIPAR
DETROL LA
VERAPAMIL ER PM
ACETAZOLAMIDE
LAMIVUDINE-ZIDOVUDINE
LACLOTION
PENTASA
BETASERON
FLUOCINONIDE-E
ZYVOX
INVEGA
ACETYLCYSTEINE
ZONEGRAN
OXAZEPAM
CARDIZEM CD
VGO 30
NORITATE
TRUSOPT
NULOJIX
EXTAVIA
VINBLASTINE SULFATE
DANAZOL
MYFORTIC
BICILLIN L-A
PREDNISOLONE SODIUM PHOSPHATE
VINCRISTINE SULFATE
SRONYX
BUPROBAN
MARPLAN
RENAL CAPS
BUTISOL SODIUM
DEPO-MEDROL
LAMOTRIGINE
DIOVAN HCT
ELIQUIS
PANTOPRAZOLE SODIUM
LISINOPRIL
VALSARTAN-HYDROCHLOROTHIAZIDE
TELMISARTAN-HYDROCHLOROTHIAZID
ANDROGEL
NATEGLINIDE
SUCRALFATE
ESTRING
ALCLOMETASONE DIPROPIONATE
CONSTULOSE
FENOFIBRIC ACID
XOPENEX HFA
LOTREL
PREMPRO
NISOL
Query:
-- 3. Get total claim counts for each drug in New York State.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 1000;
Answer:
Too long, hard cut:
drug_name,total_claims
AMLODIPINE BESYLATE,2606392
SIMVASTATIN,2483824
ATORVASTATIN CALCIUM,2343736
OMEPRAZOLE,2158771
LEVOTHYROXINE SODIUM,2091879
LISINOPRIL,1878852
FUROSEMIDE,1604273
METOPROLOL SUCCINATE,1497362
METFORMIN HCL,1483466
METOPROLOL TARTRATE,1476125
LOSARTAN POTASSIUM,1179068
HYDROCHLOROTHIAZIDE,1177844
GABAPENTIN,1063477
WARFARIN SODIUM,1037689
CLOPIDOGREL,1027289
TAMSULOSIN HCL,950300
CRESTOR,902634
ATENOLOL,872477
ZOLPIDEM TARTRATE,740031
CARVEDILOL,711856
SERTRALINE HCL,702641
NEXIUM,675301
HYDROCODONE-ACETAMINOPHEN,669509
PRAVASTATIN SODIUM,662043
PANTOPRAZOLE SODIUM,616877
FLUTICASONE PROPIONATE,579662
PREDNISONE,562097
DONEPEZIL HCL,521804
ALENDRONATE SODIUM,521736
PROAIR HFA,520129
MONTELUKAST SODIUM,518027
ENALAPRIL MALEATE,516231
LATANOPROST,508505
JANUVIA,508330
CITALOPRAM HBR,498268
ADVAIR DISKUS,483391
ALPRAZOLAM,478214
POTASSIUM CHLORIDE,457448
SYNTHROID,453791
QUETIAPINE FUMARATE,447257
ESCITALOPRAM OXALATE,446888
TRAZODONE HCL,441018
OXYCODONE-ACETAMINOPHEN,433851
CLONAZEPAM,430536
RANITIDINE HCL,422992
LOSARTAN-HYDROCHLOROTHIAZIDE,412328
ALLOPURINOL,408017
SPIRIVA,404803
AZITHROMYCIN,394490
MELOXICAM,383651
MIRTAZAPINE,383213
FINASTERIDE,378878
TRAMADOL HCL,364355
DIOVAN,358834
GLIMEPIRIDE,358155
DULOXETINE HCL,357225
ISOSORBIDE MONONITRATE ER,346521
RAMIPRIL,343510
LANTUS SOLOSTAR,343009
AMOXICILLIN,340811
RISPERIDONE,340499
CIPROFLOXACIN HCL,338454
NAMENDA,320510
LORAZEPAM,317161
METFORMIN HCL ER,306073
IBUPROFEN,302979
LISINOPRIL-HYDROCHLOROTHIAZIDE,299542
VALSARTAN-HYDROCHLOROTHIAZIDE,283681
FAMOTIDINE,278964
VOLTAREN,278509
AMMONIUM LACTATE,277683
PAROXETINE HCL,268093
GLIPIZIDE,255509
OXYCODONE HCL,255226
FENOFIBRATE,253225
FLUOXETINE HCL,252205
SPIRONOLACTONE,246063
NIFEDIPINE ER,245644
LEVETIRACETAM,232951
HYDRALAZINE HCL,229279
LOVASTATIN,225838
POLYETHYLENE GLYCOL 3350,224730
OLANZAPINE,224053
LYRICA,220106
ZETIA,214969
ABILIFY,209738
VENLAFAXINE HCL ER,207255
SYMBICORT,201916
LEVOFLOXACIN,200878
NAPROXEN,199601
AMLODIPINE BESYLATE-BENAZEPRIL,195625
CELEBREX,194637
LOVAZA,194003
LUMIGAN,193751
CLONIDINE HCL,184816
DIVALPROEX SODIUM,181189
TRIAMCINOLONE ACETONIDE,180960
LAMOTRIGINE,178665
TRIAMTERENE-HYDROCHLOROTHIAZID,178524
XARELTO,177758
BENZTROPINE MESYLATE,177116
BUPROPION XL,177098
CARBIDOPA-LEVODOPA,176483
BD ULTRA-FINE PEN NEEDLE,174415
PREDNISOLONE ACETATE,172342
LANTUS,171652
DILTIAZEM 24HR ER,168681
VENTOLIN HFA,167376
AMOX TR-POTASSIUM CLAVULANATE,167204
LIDOCAINE,166872
MECLIZINE HCL,165798
TIMOLOL MALEATE,157757
DORZOLAMIDE-TIMOLOL,155438
SULFAMETHOXAZOLE-TRIMETHOPRIM,153797
TRAVATAN Z,151135
CLOBETASOL PROPIONATE,151077
JANUMET,150537
OXYBUTYNIN CHLORIDE ER,148582
QUINAPRIL HCL,147391
BYSTOLIC,147198
PIOGLITAZONE HCL,145249
BUSPIRONE HCL,143422
RESTASIS,141964
BACLOFEN,140937
AMITRIPTYLINE HCL,140699
GLIPIZIDE ER,140394
DIAZEPAM,139279
DOXAZOSIN MESYLATE,138825
CEPHALEXIN,137706
MUPIROCIN,135100
DIGOX,134514
DIGOXIN,133812
AVODART,133353
CHLORHEXIDINE GLUCONATE,132311
LACTULOSE,128404
GLIPIZIDE XL,126744
TOPIRAMATE,126476
COMBIGAN,126296
BENICAR,125746
FENTANYL,123240
DIVALPROEX SODIUM ER,123218
VESICARE,122059
HUMALOG,119543
LABETALOL HCL,119449
ACETAMINOPHEN-CODEINE,117625
DEXILANT,116409
METHOTREXATE,116118
IRBESARTAN,115758
CLOZAPINE,109610
NOVOLOG FLEXPEN,108274
KETOCONAZOLE,105255
CICLOPIROX,104434
HALOPERIDOL,103663
PRADAXA,101573
PATADAY,101163
DILTIAZEM 24HR CD,101139
ALPHAGAN P,100973
KLOR-CON M20,100814
CLOTRIMAZOLE-BETAMETHASONE,100714
CYCLOBENZAPRINE HCL,100707
LIDODERM,99510
BRIMONIDINE TARTRATE,98842
LANSOPRAZOLE,98791
CHLORTHALIDONE,96841
NYSTATIN,96655
METHYLPREDNISOLONE,96266
NAMENDA XR,95581
DOXYCYCLINE HYCLATE,95531
LEVEMIR FLEXPEN,94262
VERAPAMIL ER,93009
NASONEX,92831
TERAZOSIN HCL,92683
RANEXA,89604
FLUOCINONIDE,88073
COLCRYS,87328
BENAZEPRIL HCL,85024
TIZANIDINE HCL,84681
TORSEMIDE,83979
GEMFIBROZIL,82491
BUPROPION HCL SR,81924
ECONAZOLE NITRATE,81847
HYDROXYCHLOROQUINE SULFATE,81124
ROPINIROLE HCL,80150
DICLOFENAC SODIUM,79801
BENICAR HCT,78764
AZELASTINE HCL,78567
VALSARTAN,78447
OXYBUTYNIN CHLORIDE,78428
MORPHINE SULFATE ER,77889
OXYCONTIN,77360
RALOXIFENE HCL,76707
SINGLE USE SWAB,76172
CLOTRIMAZOLE,75585
NITROSTAT,75561
EXELON,74714
AMIODARONE HCL,74637
NIFEDICAL XL,73128
GLYBURIDE,73043
TOPROL XL,72958
VALACYCLOVIR,72509
PROPRANOLOL HCL,72042
ANASTROZOLE,71546
KETOROLAC TROMETHAMINE,70687
ALBUTEROL SULFATE,66127
CREON,64598
COMBIVENT RESPIMAT,64509
TRADJENTA,63702
FLOVENT HFA,63459
NORVIR,62431
CARBAMAZEPINE,61858
METOCLOPRAMIDE HCL,61183
HYDROCORTISONE,60622
ALCOHOL PADS,60215
IPRATROPIUM-ALBUTEROL,60122
CALCITRIOL,59890
JANTOVEN,59842
FOSINOPRIL SODIUM,59739
IPRATROPIUM BROMIDE,59553
HYDROXYZINE HCL,59365
RAPAFLO,58620
NORTRIPTYLINE HCL,57921
METRONIDAZOLE,57609
LITHIUM CARBONATE,56866
PATANOL,56786
SEROQUEL XR,55802
TRUVADA,55534
IBANDRONATE SODIUM,54573
NITROFURANTOIN MONO-MACRO,53554
PHENYTOIN SODIUM EXTENDED,52949
INSULIN SYRINGE,52550
FLUCONAZOLE,52522
CILOSTAZOL,52479
COUMADIN,52376
VIGAMOX,52295
OMEGA-3 ACID ETHYL
Query:
-- 4. Find total drug costs for each drug in New York State.
SELECT "drug_name", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
ORDER BY "total_cost" DESC
LIMIT 1000;
Answer:
Too long, hard cut:
drug_name,total_cost
CRESTOR,249327097.41000012
SOVALDI,230243170.39
NEXIUM,214788833.79000002
JANUVIA,194438475.12000006
ABILIFY,181274610.4100001
ADVAIR DISKUS,180060546.1900001
SPIRIVA,150863384.09000003
LANTUS SOLOSTAR,148985758.74999994
REVLIMID,107219280.90999997
NAMENDA,83872328.88
ENBREL,81570443.91999999
COPAXONE,79486041.02000001
DIOVAN,78426639.23000002
TRUVADA,72683222.99
HUMIRA,72616484.43
DULOXETINE HCL,71719393.02999999
LYRICA,66070666.27
XARELTO,64782309.809999995
ZETIA,63663933.77
RESTASIS,63575130.730000004
LANTUS,61681575.25
SYMBICORT,59867832.10999999
CELEBREX,59071901.58
METOPROLOL SUCCINATE,57766641.45999998
OLYSIO,55122556.60000001
JANUMET,55056829.46
ATRIPLA,54860236.31000002
ATORVASTATIN CALCIUM,53943714.93
GLEEVEC,51117573.96000002
HUMALOG,48263419.919999994
NOVOLOG FLEXPEN,48213346.3
ISENTRESS,47487933.49000002
LOVAZA,45890986.8
SENSIPAR,45096677.930000015
TECFIDERA,42576237.6
OXYCONTIN,42112905.27
LIDODERM,40911216.23
RENVELA,40821118.470000006
PREZISTA,40812033.78999999
HARVONI,40439111.25
LIDOCAINE,40209597.260000005
ZYTIGA,40067382.019999996
PRADAXA,40056632.84
LEVEMIR FLEXPEN,38206535.82000001
LEVOTHYROXINE SODIUM,37782511.40999999
LUMIGAN,34801637.98
VESICARE,34509594.030000016
RANEXA,32636829.85
SEROQUEL XR,32380961.619999997
REYATAZ,32013003.350000013
OMEPRAZOLE,31535545.88
VICTOZA 3-PAK,30027173.900000002
PROAIR HFA,29455596.169999994
EXELON,29194113.789999995
TARCEVA,29140341.81999999
CREON,27937813.83
AVODART,27472993.950000003
CLOPIDOGREL,27348175.679999996
EPZICOM,26709837.580000002
NAMENDA XR,25983794.51
LETAIRIS,25902094.29
DEXILANT,25676366.45
BENICAR,25443544.000000004
PROCRIT,25153769.129999995
TRAVATAN Z,24771707.959999997
OLANZAPINE,24613230.34
QUETIAPINE FUMARATE,24296346.749999985
AVONEX,24095960.069999997
TRADJENTA,23621812.8
FENOFIBRATE,23577113.29000001
XTANDI,22975633.199999996
SIMVASTATIN,22966671.89
GAMMAGARD LIQUID,22137393.639999993
H.P. ACTHAR,22109154.050000004
TAMSULOSIN HCL,21594947.83
AVONEX PEN,21381695.33
TRACLEER,21115983.340000004
OXYCODONE-ACETAMINOPHEN,21104760.020000003
DIVALPROEX SODIUM ER,21020703.65
PRAVASTATIN SODIUM,20913612.590000007
NORVIR,20754231.05
AMLODIPINE BESYLATE,20729281.249999993
COMBIVENT RESPIMAT,20700370.280000005
VIREAD,20304233.08
GABAPENTIN,20300069.87999999
VOLTAREN,19943125.9
WELCHOL,19644395.279999997
BYSTOLIC,19561871.959999997
COLCRYS,19379766.75
NOVOLOG MIX 70-30 FLEXPEN,19346065.25
SYNTHROID,19280530.58
FORTEO,19164627.519999996
COMBIGAN,18785901.630000006
ENOXAPARIN SODIUM,17958707.119999997
HYDROCODONE-ACETAMINOPHEN,17544090.789999995
NASONEX,17455648.05
COMPLERA,17237542.630000003
RALOXIFENE HCL,17232401.17
ELIQUIS,17225348.98
ALPHAGAN P,17197571.570000004
ONGLYZA,17097443.660000008
CLOBETASOL PROPIONATE,17034813.119999997
STRIBILD,16736289.4
LATUDA,16714844.339999996
LOSARTAN POTASSIUM,16707068.97
REBIF,16471064.780000001
BENICAR HCT,16365516.01
FENTANYL,16106482.219999997
VALSARTAN,16003284.72
VYTORIN,15631262.600000003
INVEGA SUSTENNA,15577263.82
FLOVENT HFA,15417080.719999999
DONEPEZIL HCL,15253989.270000003
PATADAY,15244739.37
AGGRENOX,15219900.719999997
GAMUNEX-C,14807257.29
NOVOLOG,14675388.849999998
VALSARTAN-HYDROCHLOROTHIAZIDE,14637686.24
AMITIZA,14614131.22
GILENYA,14583050.459999997
OXYCODONE HCL,14576462.039999994
MONTELUKAST SODIUM,14196241.420000004
XIFAXAN,13925425.670000004
IMBRUVICA,13594120.35
AZILECT,13095812.929999996
EVISTA,12826356.569999995
POTASSIUM CHLORIDE,12816403.469999999
VIMPAT,12466537.829999996
MYRBETRIQ,12435013.940000001
METFORMIN HCL,12377618.139999999
HUMALOG MIX 75-25,12168255.439999996
LISINOPRIL,12129540.520000003
RAPAFLO,11860292.84
AFINITOR,11842201.23
AMPYRA,11729545.72
VALCYTE,11694943.840000002
PROLIA,11647358.110000003
METFORMIN HCL ER,11580778.149999999
DICLOFENAC SODIUM,11575983.980000004
ADCIRCA,11298534.26
AMLODIPINE BESYLATE-BENAZEPRIL,11121216.640000002
WARFARIN SODIUM,11100457.57
INTELENCE,11013016.680000003
SANTYL,10946240.520000001
JAKAFI,10902051.390000002
INVOKANA,10842460.520000001
LEVEMIR,10820001.459999999
OMEGA-3 ACID ETHYL ESTERS,10777016.410000002
INVEGA,10755982.93
FLUTICASONE PROPIONATE,10629640.18
PREDNISOLONE ACETATE,10501226.98
NIACIN ER,10420729.770000001
ULORIC,10399172.72
MULTAQ,10351336.500000004
PIOGLITAZONE HCL,10267115.030000003
EXFORGE,10256804.23
RISPERDAL CONSTA,10206885.15
PANTOPRAZOLE SODIUM,10186062.680000002
PREMARIN,10150921.780000001
TASIGNA,10099062.06
POMALYST,10085754.040000001
CLOZAPINE,10046192.16
METOPROLOL TARTRATE,9967777.960000003
NIFEDIPINE ER,9949490.360000001
PATANOL,9637933.74
ESCITALOPRAM OXALATE,9584397.98
LATANOPROST,9357466.48
MORPHINE SULFATE ER,9315240.059999997
LIALDA,9218202.670000002
TIVICAY,9160245.05
ACTONEL,9125216.939999998
SUBOXONE,9123378.790000001
OXYBUTYNIN CHLORIDE ER,9084748.64
METHOTREXATE,9060760.379999999
ANDROGEL,8960305.679999998
AZOR,8950289.609999998
ZOSTAVAX,8891298.76
AUBAGIO,8873366.209999999
BARACLUDE,8852746.04
AZOPT,8803192.419999998
RAMIPRIL,8697248.9
LINZESS,8584279.369999997
VE
Query:
-- 5. List the top 10 drugs by total claim counts across all states.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 10;
Answer:
drug_name,total_claims
LISINOPRIL,37599566
LEVOTHYROXINE SODIUM,37075950
AMLODIPINE BESYLATE,35659180
SIMVASTATIN,33549777
OMEPRAZOLE,32276944
HYDROCODONE-ACETAMINOPHEN,32204330
ATORVASTATIN CALCIUM,31959252
FUROSEMIDE,26372608
METFORMIN HCL,22952294
GABAPENTIN,21323652
Query:
SELECT "nppes_provider_state", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "total_claims" DESC
LIMIT 10;
Answer:
nppes_provider_state,total_claims
CA,116440694
FL,91441123
NY,79570924
TX,75682169
PA,62946334
OH,53494076
NC,46020420
IL,42527191
MI,39461213
GA,39066489
Query:
-- 7. Retrieve total drug costs per state for a specific drug.
-- Replacing 'DrugNamePlaceholder' with an actual drug name, for example 'LISINOPRIL'.
SELECT "nppes_provider_state", SUM("total_drug_cost") AS "state_total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "drug_name" = 'LISINOPRIL'
GROUP BY "nppes_provider_state"
ORDER BY "state_total_cost" DESC
LIMIT 1000
Answer:
nppes_provider_state,state_total_cost
CA,28081799.270000007
FL,18765053.880000003
TX,18193331.150000002
PA,13881711.110000001
OH,13078051.309999995
NY,12129540.519999998
IL,11182703.340000002
MI,10286256.829999998
NC,9100926.089999998
MO,7989472.850000001
MA,7797229.159999999
GA,7093689.38
TN,6822899.400000002
AZ,6699458.37
MN,6357574.170000001
IN,6331941.26
VA,6214347.589999999
WA,5961205.869999998
WI,5830349.669999999
KY,5608079.180000002
NJ,4388274.59
CO,4293032.0200000005
MD,4031259.4699999997
AL,3969057.4
OR,3878300.94
SC,3832939.3499999996
OK,3792994.8099999987
LA,3591451.1000000006
IA,3361841.53
CT,3163402.6
AR,3100542.76
KS,2767073.0599999987
MS,2390290.689999999
WV,2284762.25
NV,2236554.97
NM,2164382.7400000007
ME,1700248.8499999996
PR,1668734.31
NE,1512062.860000001
UT,1416171.4000000004
RI,1365108.7000000002
ID,1227299.51
NH,1182892.28
HI,1126129.4499999997
DE,1014526.88
SD,877349.5100000002
MT,856439.07
ND,773696.0099999995
VT,563978.6999999998
DC,453014.1699999998
WY,385846.3
AK,361804.7900000001
VI,35915.01
GU,27074.559999999994
ZZ,7056.420000000001
MP,3149.42
AE,1740.78
XX,677.3399999999999
AP,496.99
AS,151.66
Query:
-- 8. Calculate average drug cost per claim for each drug in New York State.
SELECT "drug_name", SUM("total_drug_cost") / SUM("total_claim_count") AS "avg_cost_per_claim"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "drug_name"
HAVING SUM("total_claim_count") > 0  -- Ensure division by zero is avoided
ORDER BY "avg_cost_per_claim" DESC
LIMIT 1000
Answer:
Too long, hard cut:
drug_name,avg_cost_per_claim
ELAPRASE,65276.352222222224
CINRYZE,60768.683833333336
RAVICTI,42428.24964285714
PROCYSBI,42166.539333333334
H.P. ACTHAR,38317.4246967071
CHENODAL,36108.195384615385
HARVONI,32145.557432432433
GATTEX,31578.390219780216
FIRAZYR,30701.36266666667
KALYDECO,30269.19833333333
KALBITOR,29386.1188
SOVALDI,28573.24030652768
APOKYN,27715.462
JUXTAPID,27520.148823529413
LUMIZYME,27022.897454545455
BERINERT,23022.39525423729
OLYSIO,22609.744298605416
VPRIV,22309.94754385965
SOLIRIS,21273.995789473684
KORLYM,20766.115217391307
TARGRETIN,20280.789056047197
MOZOBIL,19168.855
ELELYSO,18802.0
CEREZYME,17842.561299999998
KUVAN,17506.413333333334
TYVASO,14887.955777777777
ORENITRAM ER,13993.30510638298
SODIUM PHENYLBUTYRATE,13889.707142857142
ZYKADIA,13190.450833333334
GAMMAKED,12849.59012345679
XALKORI,12674.966190476189
CAPRELSA,11917.92
ACTIQ,11529.232727272727
LAZANDA,11361.056153846155
POMALYST,11181.545498891353
FERRIPROX,11179.465538461538
STELARA,11026.392320185612
SABRIL,11012.395862068965
ALBENZA,10812.370238095238
SUBSYS,10793.219328358207
BUPHENYL,10403.520238095238
SEROSTIM,10395.255487571698
INLYTA,10170.812305825242
JAKAFI,10169.824057835824
FLEBOGAMMA DIF,10148.561538461538
STIVARGA,10142.038818181818
ICLUSIG,10074.233333333334
FABRAZYME,9901.669591836735
AFINITOR,9827.552887966804
ABSTRAL,9737.644210526316
REVLIMID,9570.586531286266
MEKINIST,9539.798181818182
OCTAGAM,9355.354705882353
IMBRUVICA,9210.108638211384
GLASSIA,9134.961818181819
ERIVEDGE,9076.844049586776
JEVTANA,8908.311818181817
BOSULIF,8685.97796460177
NEXAVAR,8621.466373626376
PROLASTIN C,8428.681493670887
XTANDI,8403.669787856617
GLEEVEC,8323.982081094284
GAMUNEX-C,8309.347525252526
GAMMAGARD LIQUID,8297.373928035984
TASIGNA,8217.300292921074
XYREM,8080.52527777778
NPLATE,7859.560757575758
SPRYCEL,7836.920239833158
SOMAVERT,7643.65925925926
EXJADE,7545.456211180125
SAMSCA,7537.739925373134
TRACLEER,7493.251717530162
ADEMPAS,7460.704311224491
ANZEMET,7405.419687500001
VOTRIENT,7400.523508442777
ZYTIGA,7368.036414122836
CARIMUNE NF NANOFILTERED,7326.557250000001
LETAIRIS,7229.163910131175
RITUXAN,7217.458158783783
PRIVIGEN,7178.857943661971
OPSUMIT,7177.309185750637
PROMACTA,7174.179348659003
TOBI PODHALER,7158.574615384616
VALCHLOR,7107.772727272727
VECTIBIX,7049.693846153847
TOBI,6846.525000000001
ERBITUX,6843.979253731343
NORTHERA,6663.645833333333
SUTENT,6638.673315719949
KADCYLA,6631.729777777777
XENAZINE,6560.109056162247
THALOMID,6485.287917448406
FENTORA,6336.729887005651
REMODULIN,6276.3099999999995
CAYSTON,6200.429259259259
TARCEVA,6200.0727276595735
TREANDA,6112.447636363636
TECFIDERA,6011.894606043493
GAZYVA,5991.2840625
GILOTRIF,5978.707475728155
VIDAZA,5769.0440625
GILENYA,5674.338700389104
AUBAGIO,5630.308508883248
ARALAST NP,5599.276231155779
AVASTIN,5598.689894625921
COPAXONE,5532.542703417555
HALAVEN,5512.37875
ALIMTA,5472.809700598803
AVONEX PEN,5309.584139557985
EXTAVIA,5271.702
REBIF REBIDOSE,5260.885656934308
NEULASTA,5201.684639084508
AVONEX,5190.857404136149
VELCADE,5160.571147540984
ZEMAIRA,5116.3090740740745
AVONEX ADMINISTRATION PACK,5020.600552486189
REBIF,4979.161058041112
BETASERON,4916.548891129031
HERCEPTIN,4853.794588235293
GAMMAPLEX,4806.171176470589
TYSABRI,4782.291277533041
NOXAFIL,4781.582222222222
REMICADE,4753.249519071309
SOMATULINE DEPOT,4656.475652173913
ABRAXANE,4506.173395061728
PERJETA,4408.845308641975
GAMMAGARD S-D,4243.6033333333335
SANDOSTATIN LAR,4199.314712793734
OXSORALEN-ULTRA,4081.539375
NILANDRON,3991.93219269103
TYKERB,3869.1095833333334
CYSTARAN,3726.2461538461534
ARIXTRA,3693.184791666667
BENLYSTA,3672.1958407079646
METHYLERGONOVINE MALEATE,3652.5
AZACITIDINE,3648.74046875
TORISEL,3564.5183333333334
HUMIRA,3538.987495979336
PEGASYS,3533.9074074074065
REVATIO,3380.9466752577323
CIMZIA,3362.998648838846
NEUPOGEN,3362.575299950422
HIZENTRA,3342.041397849462
TASMAR,3304.5092458100553
ENBREL,3303.5170873157313
SIMPONI,3290.2579450980393
MIGRANAL,3274.023902439025
PEGASYS PROCLICK,3211.029041353383
LEUKINE,3155.1775
PEGINTRON REDIPEN,3127.5962
DIFICID,3117.524705882353
XOLAIR,3092.7501711229947
FUZEON,2985.3037373737375
KINERET,2978.957828947368
CUPRIMINE,2972.6717021276595
ORENCIA,2920.2818677042796
PULMOZYME,2875.9
SAIZEN,2851.9436363636364
AMBISOME,2763.395925925926
GENOTROPIN,2716.474303797468
NORDITROPIN NORDIFLEX,2713.3108333333334
HEPAGAM B,2689.0266666666666
DEPEN,2637.403333333333
OXALIPLATIN,2624.631777777778
XELJANZ,2621.248628503279
STRIBILD,2539.6493778452204
VALCYTE,2513.4201246507632
TRELSTAR,2470.9281487101666
CYSTADANE,2454.5828125
TRIUMEQ,2392.362
LUCENTIS,2359.4441637010677
ZYVOX,2334.095423728814
ZYFLO CR,2298.674722222222
EYLEA,2293.623236714976
VANOS,2200.278888888889
LUPRON DEPOT,2196.013436246993
MIACALCIN,2166.974715447155
OTEZLA,2165.8633846153843
LYSODREN,2146.2813333333334
ATRIPLA,2126.9428259605315
COMPLERA,2125.7297607596493
ADCIRCA,2115.8303857677897
RILUTEK,2093.5473568281936
ACTEMRA,2081.9734966592428
PROLEUKIN,2069.088823529412
AMPYR
Query:
-- 9. Find the number of unique prescribers per state.
SELECT "nppes_provider_state", COUNT(DISTINCT "npi") AS "number_of_prescribers"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "number_of_prescribers" DESC
LIMIT 1000
Answer:
nppes_provider_state,number_of_prescribers
CA,86586
NY,63751
TX,50853
FL,49874
PA,41440
OH,33064
IL,32415
MI,29898
NC,26875
MA,24875
NJ,23515
GA,20728
VA,19335
WA,19060
TN,18826
AZ,16666
WI,16441
IN,16316
MO,16128
MN,16099
MD,15616
CO,13888
LA,12345
CT,12263
OR,12171
KY,12131
SC,11689
AL,10719
OK,9152
PR,8385
IA,8364
KS,7707
MS,7114
AR,6816
UT,6077
WV,5668
NV,5556
NM,5389
NE,5279
ME,4825
NH,4397
ID,4071
RI,3701
HI,3171
MT,2889
DC,2677
DE,2568
SD,2560
ND,2293
VT,1996
AK,1609
WY,1394
VI,154
ZZ,99
GU,98
AE,32
AP,25
MP,16
AA,7
XX,5
AS,2
Query:
-- 10. Retrieve total claim counts and total drug costs per state.
SELECT "nppes_provider_state", SUM("total_claim_count") AS "total_claims", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "nppes_provider_state"
ORDER BY "total_claims" DESC
LIMIT 1000
Answer:
nppes_provider_state,total_claims,total_cost
CA,116440694,9633494580.830002
FL,91441123,6969574542.380003
NY,79570924,7521861271.360001
TX,75682169,6462480867.609998
PA,62946334,4841813377.080001
OH,53494076,4050597920.3
NC,46020420,3357740486.2099996
IL,42527191,3120595897.4100003
MI,39461213,3193421559.090002
GA,39066489,2787324531.739999
TN,35472398,2449796259.99
MO,31071230,2266900573.049999
NJ,29242463,2980085648.56
IN,27822613,2151310576.07
KY,26196384,1749915624.0500007
AL,26162156,1774188310.3899994
MA,26156247,1993379967.38
VA,25549776,1845291759.1400003
PR,24988874,998242828.4499999
LA,22456360,1586697376.66
SC,21795317,1625039227.0200002
WI,21461606,1595424680.7500005
AZ,19873807,1531414913.72
WA,19108957,1374073749.7700002
MN,17312127,1268712288.75
MS,15737130,971791465.0899998
AR,15647866,924771139.8100001
OK,14918485,1099747189.1000001
IA,14673562,851657297.38
OR,13889191,940748728.5399997
MD,13798859,1285911121.54
CT,12892970,1213947159.8300004
CO,12823030,987955657.2400001
KS,12042320,812376124.8
WV,11216491,774905769.8599999
NE,7991763,513097615.17
NV,7457176,530336271.75000006
UT,5796245,446198781.28999996
NM,5770207,402878429.6
ME,5699119,445414042.0799999
RI,5535266,345326474.99
ID,4852448,340866011.09000003
NH,4095519,322343632.6399999
HI,3777714,342155461.13999987
SD,3525885,233180044.24000007
MT,3315266,235183327.45000002
ND,3061665,198826531.82999998
DE,3042265,313539382.5000001
VT,2115996,171127800.37999994
DC,1487724,192973624.24999997
WY,1380174,89775137.25999999
AK,1074367,78887893.48
VI,197072,9122593.650000002
GU,76979,3012622.01
ZZ,33284,2394695.3500000006
AE,7617,482799.32000000007
MP,7104,273092.6499999999
XX,1909,41955.99
AP,1839,68270.65999999999
AA,999,9045.2
AS,218,1660.4500000000003
Query:
-- 11. Get total claim counts and total drug costs for each drug nationwide.
SELECT "drug_name", SUM("total_claim_count") AS "total_claims", SUM("total_drug_cost") AS "total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
ORDER BY "total_claims" DESC
LIMIT 1000
Answer:
Too long, hard cut:
drug_name,total_claims,total_cost
LISINOPRIL,37599566,277213345.65
LEVOTHYROXINE SODIUM,37075950,621294485.3899997
AMLODIPINE BESYLATE,35659180,298507550.62
SIMVASTATIN,33549777,341421087.83000004
OMEPRAZOLE,32276944,517533247.7799998
HYDROCODONE-ACETAMINOPHEN,32204330,658789651.37
ATORVASTATIN CALCIUM,31959252,733947717.3099997
FUROSEMIDE,26372608,132377918.97000004
METFORMIN HCL,22952294,199522058.46000004
GABAPENTIN,21323652,475796482.49000007
METOPROLOL TARTRATE,20782646,143697787.07999992
LOSARTAN POTASSIUM,17873509,256379132.92999998
HYDROCHLOROTHIAZIDE,17373067,103773229.71000004
METOPROLOL SUCCINATE,16781720,646937388.2099999
WARFARIN SODIUM,15241971,157425944.31999993
CLOPIDOGREL,14563125,327030151.14000005
PRAVASTATIN SODIUM,14190361,432287194.74
CARVEDILOL,13310395,133491005.67
TRAMADOL HCL,13242625,118801590.98999998
ALPRAZOLAM,13081892,88534125.56000002
ATENOLOL,12883671,93628523.41000003
POTASSIUM CHLORIDE,12506552,364394350.96000004
TAMSULOSIN HCL,11685280,272151299.9099999
SERTRALINE HCL,11187864,120372788.28999999
PANTOPRAZOLE SODIUM,11071364,172384475.60999995
CITALOPRAM HBR,10234686,79372249.20000003
PREDNISONE,9844536,78529400.60000002
TRAZODONE HCL,9663151,80163222.24
FLUTICASONE PROPIONATE,9614633,189919666.91999993
LORAZEPAM,9560017,74394806.97000001
ZOLPIDEM TARTRATE,9448045,74632610.31000002
CLONAZEPAM,9267099,68803079.37
CRESTOR,8600472,2395819380.2099996
OXYCODONE-ACETAMINOPHEN,8250381,444323992.09
DONEPEZIL HCL,8052913,194387985.29999998
MELOXICAM,7921650,56024994.470000006
PROAIR HFA,7686762,451525668.56
ALLOPURINOL,7530262,69459113.43000002
ALENDRONATE SODIUM,7293735,75525328.64
RANITIDINE HCL,7170871,87715348.41000001
LISINOPRIL-HYDROCHLOROTHIAZIDE,7042874,61660247.66999999
NEXIUM,6968108,2422256935.2699995
MONTELUKAST SODIUM,6855005,193820317.04999998
ESCITALOPRAM OXALATE,6711864,141059806.65999997
DULOXETINE HCL,6503301,1299549926.38
QUETIAPINE FUMARATE,6398416,344499121.16
LATANOPROST,6339049,112311174.86999999
AZITHROMYCIN,6135891,59233312.989999995
CIPROFLOXACIN HCL,5924418,38133665.10999999
FLUOXETINE HCL,5834784,82081466.64999998
GLIMEPIRIDE,5613158,57195791.78
OXYCODONE HCL,5603775,272529852.76
LOVASTATIN,5551048,76714852.2
ISOSORBIDE MONONITRATE ER,5542060,95898313.63
ADVAIR DISKUS,5541448,2064905171.0499997
LOSARTAN-HYDROCHLOROTHIAZIDE,5512996,95233069.05000001
SPIRIVA,5339480,1956946798.4799995
SYNTHROID,5306839,206879791.19
MIRTAZAPINE,5235802,78296109.29000002
GLIPIZIDE,5077217,42183510.46
AMOXICILLIN,4970056,24123109.319999993
FENOFIBRATE,4957587,438239797.4800001
NAMENDA,4879366,1241647331.0200005
SPIRONOLACTONE,4612646,53522835.330000006
RISPERIDONE,4511603,92356467.66
TRIAMTERENE-HYDROCHLOROTHIAZID,4407324,53308712.32000001
FINASTERIDE,4357389,96933367.26
IBUPROFEN,4326254,34824688.79
PAROXETINE HCL,4313490,75138378.25
CLONIDINE HCL,4299189,37722883.65
ENALAPRIL MALEATE,4211624,56424392.29000001
JANUVIA,4112402,1591852562.3300009
LANTUS SOLOSTAR,3967264,1805583150.8300002
LYRICA,3933987,1208504599.46
METFORMIN HCL ER,3927209,110156746.98000003
LANTUS,3799781,1511895513.5600004
VENLAFAXINE HCL ER,3776399,145511344.82000002
CEPHALEXIN,3636174,26831203.969999995
FAMOTIDINE,3621252,38633663.76999999
DIOVAN,3614837,784411444.9700001
SULFAMETHOXAZOLE-TRIMETHOPRIM,3569752,21830063.030000005
AMITRIPTYLINE HCL,3539561,41848047.64
DIAZEPAM,3510005,24612711.360000003
HYDRALAZINE HCL,3501872,74809148.85000002
LEVOFLOXACIN,3378066,48175958.85000002
POLYETHYLENE GLYCOL 3350,3178311,74705597.06999998
ZETIA,3174655,898243212.4600002
TEMAZEPAM,3171737,40364815.07000001
VALSARTAN-HYDROCHLOROTHIAZIDE,3065182,179968803.19000003
TRIAMCINOLONE ACETONIDE,3052903,62427789.16000003
BENAZEPRIL HCL,3052603,30051090.500000004
MORPHINE SULFATE ER,2946254,290867807.89
LEVETIRACETAM,2919863,105160925.61999999
NAPROXEN,2872736,24055452.65
LAMOTRIGINE,2835316,44234301.559999995
CELEBREX,2829304,881309305.3100003
TIZANIDINE HCL,2815712,89200101.14000002
FENTANYL,2803034,345832972.77000004
BACLOFEN,2790878,56521523.93999999
OLANZAPINE,2712012,270030069.6699999
CYCLOBENZAPRINE HCL,2696200,51508903.92000002
XARELTO,2684840,915381796.09
ABILIFY,2677876,2246738757.45
DOXAZOSIN MESYLATE,2675492,85145805.51000002
SYMBICORT,2655360,790798550.2899997
KLOR-CON M20,2550689,65344605.81000001
DIVALPROEX SODIUM,2534690,94148001.77000003
BUPROPION XL,2500986,99651464.06
BD ULTRA-FINE PEN NEEDLE,2473580,114335782.14
ROPINIROLE HCL,2439553,78174577.50000001
RAMIPRIL,2421338,58331693.88
BUSPIRONE HCL,2401589,48229966.55000001
PREDNISOLONE ACETATE,2378009,149994480.36
CARBIDOPA-LEVODOPA,2374868,87048536.90000005
AMOX TR-POTASSIUM CLAVULANATE,2327900,40215020.029999994
NIFEDIPINE ER,2298940,102069888.29999998
TOPIRAMATE,2260947,46154713.929999985
DIGOX,2248777,93904414.60000004
AMLODIPINE BESYLATE-BENAZEPRIL,2242350,122989563.75
BENZTROPINE MESYLATE,2204320,22752194.449999996
METHYLPREDNISOLONE,2194209,48401483.209999986
OXYBUTYNIN CHLORIDE ER,2134351,128386751.57999997
PIOGLITAZONE HCL,2110714,146729882.06999996
Query:
-- 12. Identify the drugs with the highest average cost per claim nationwide.
SELECT "drug_name", SUM("total_drug_cost") / SUM("total_claim_count") AS "avg_cost_per_claim"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "drug_name"
HAVING SUM("total_claim_count") > 0  -- Ensure division by zero is avoided
ORDER BY "avg_cost_per_claim" DESC
LIMIT 1000
Answer:
Too long, hard cut:
drug_name,avg_cost_per_claim
ADAGEN,94218.08307692308
ELAPRASE,58922.49405405405
CINRYZE,52784.52038490568
FIRAZYR,48099.664440753055
BERINERT,47776.39671159029
CARBAGLU,44471.74333333333
NAGLAZYME,42268.6128440367
RAVICTI,41223.50049792531
PROCYSBI,40156.55495327103
ALDURAZYME,39379.55583333334
H.P. ACTHAR,39204.23321896073
CHENODAL,36052.11075
ACTIMMUNE,33417.868276836154
YERVOY,32363.61
HARVONI,32080.829197146297
GATTEX,28956.995817245806
KALBITOR,28842.32502189781
SOVALDI,28340.424900299837
ELELYSO,28307.3
JUXTAPID,27518.29496865204
LUMIZYME,27010.800597014924
KALYDECO,25481.912769516726
VPRIV,22641.465223880597
OLYSIO,22558.138000295654
INCIVEK,22557.087058823527
APOKYN,22329.24423580786
SOLIRIS,22265.210060240966
ARCALYST,21002.0
REMODULIN,20897.538095238095
MOZOBIL,20282.172083333335
KYNAMRO,20201.490625000002
ILARIS,19728.650555555552
VENTAVIS,17345.661
ZAVESCA,16975.584468085104
KORLYM,15957.928796296297
TARGRETIN,15888.062559999997
SYPRINE,15785.365827586207
ADCETRIS,15459.004
SIGNIFOR,15243.0755
KUVAN,14731.920958286355
FABRAZYME,14477.500735551663
CEREZYME,14467.57185858586
TYVASO,14185.003846153846
AFINITOR DISPERZ,13565.781923076924
BIVIGAM,12455.43
XALKORI,11575.664203494345
SABRIL,11442.97229428173
STELARA,11051.114118488835
POMALYST,10956.690261627908
ICLUSIG,10725.371255230124
OCTAGAM,10576.266011477761
COMETRIQ,10489.468520179373
SEROSTIM,10414.583615059546
KEYTRUDA,10196.00846153846
ACTIQ,10121.035454545454
CAPRELSA,9873.375465686273
AFINITOR,9699.803753008036
INLYTA,9660.476653789005
STIVARGA,9531.084188398087
TALWIN,9481.949999999999
REVLIMID,9364.143442414335
ZEMAIRA,9301.863337570368
ZYKADIA,9105.113513513514
MEKINIST,9028.769855687606
JEVTANA,9015.62534883721
JAKAFI,8997.707499677379
ERIVEDGE,8984.350845070425
IMBRUVICA,8907.086982665869
DACOGEN,8906.497647058823
ZELBORAF,8896.525093023254
PROLASTIN C,8887.33505543902
GAMMAGARD LIQUID,8785.366058134367
GLASSIA,8705.734157441575
BUPHENYL,8699.849310344827
SODIUM PHENYLBUTYRATE,8581.633061224491
GAMMAKED,8513.787644991213
NEXAVAR,8498.062598408258
XYREM,8300.493277232352
FENTORA,8290.50756804214
SUBSYS,8273.914342337051
XTANDI,8242.413887552777
BOSULIF,8221.538396226417
GLEEVEC,8217.76359406148
GAMMAPLEX,8024.499895178196
SPRYCEL,8015.665063218754
FERRIPROX,8012.841844106463
DECITABINE,8007.6016
SOMAVERT,7955.650682730926
ESBRIET,7921.287272727273
RITUXAN,7910.220963503651
ABSTRAL,7779.462036474165
TASIGNA,7754.0396306301
TAFINLAR,7687.024580792681
TRACLEER,7625.6115161753505
ADEMPAS,7414.1150761019935
ERBITUX,7307.490791788858
EXJADE,7272.785586080585
LETAIRIS,7174.756180604912
ZYTIGA,7169.337561926254
OPSUMIT,7132.927883277897
ZYDELIG,7130.996666666667
HETLIOZ,7113.059843749999
TOBI PODHALER,7103.474591836734
XENAZINE,7093.926011129076
VOTRIENT,7070.065869224748
VECTIBIX,7049.693846153847
PRIVIGEN,7029.571949247073
THALOMID,6999.393932141351
SYLATRON,6993.137142857143
ZOLINZA,6934.363558558558
SUTENT,6898.2065613344375
GAMUNEX-C,6867.900701312576
TREANDA,6753.471822916667
NORTHERA,6663.645833333333
SAMSCA,6656.064114194237
ORENITRAM ER,6632.469167502508
ARALAST NP,6597.980266299356
PLEGRIDY PEN,6391.056923076923
KADCYLA,6263.2320425531925
CAYSTON,6187.300148423006
DEMSER,6180.5233333333335
GILOTRIF,6135.664878928388
SYNRIBO,6067.28
LAZANDA,6042.239689922481
GAZYVA,5991.2840625
TARCEVA,5978.279426167974
VICTRELIS,5940.296101694915
VIDAZA,5881.175390625001
TECFIDERA,5862.015208607574
GILENYA,5718.869288944333
LEUKINE,5709.28370015949
IXEMPRA,5568.587500000001
SUCRAID,5502.988666666667
NEULASTA,5408.43845786421
SANDOSTATIN,5381.223251533743
COPAXONE,5369.262740946855
AUBAGIO,5349.6182635918185
ANDROID,5326.286724137931
VELCADE,5306.94219795222
SYLATRON 4-PACK,5284.4277142857145
PROMACTA,5276.241423113658
ABRAXANE,5209.18233983287
REBIF REBIDOSE,5208.073691683572
BETASERON,5157.922732842652
HERCEPTIN,5154.900042046251
SIMPONI ARIA,5142.2157
AVONEX PEN,5075.078467251718
REBIF,5038.7079481121655
AVONEX,4985.120593511677
ALIMTA,4947.558982346833
GAMMAGARD S-D,4940.157027972028
AVASTIN,4932.66626688103
AVONEX ADMINISTRATION PACK,4867.616074907987
TYSABRI,4834.982584493042
NPLATE,4790.93682648402
NOXAFIL,4768.724549583648
VALCHLOR,4749.402857142856
SOMATULINE DEPOT,4748.1211683532665
FLEBOGAMMA DIF,4745.912929936306
AZACITIDINE,4686.148716216216
HALAVEN,4652.826363636364
CARIMUNE NF NANOFILTERED,4583.243496835444
PERJETA,4527.309187817259
REMICADE,4521.610731423587
SIRTURO,4460.722
NILANDRON,4375.300922444184
ALBENZA,4336.903184357541
TYKERB,4298.760754048583
HIZENTRA,4198.0624162414015
DIFICID,4096.061467889908
TOBI,4031.3399999999997
SANDOSTATIN LAR,4002.4689945266564
DOXIL,3991.0833333333335
SAIZEN,3807.7038644688646
CYSTARAN,3734.896593406593
D.H.E.45,3668.3695999999995
TORISEL,3564.5183333333334
EXTAVIA,3466.044709228823
REVATIO,3419.5773914231086
HUMIRA,3373.8089135500277
CIMZIA,3346.965377376984
KINERET,3286.642341549296
TASMAR,3271.671833333333
PEGASYS PROCLICK,3216.8207825567506
SIMPONI,3214.732058321871
PEGASYS,3207.130610958904
PU
Query:
-- 13. Retrieve total claim counts per provider in New York State.
SELECT "npi", SUM("total_claim_count") AS "provider_total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "npi"
ORDER BY "provider_total_claims" DESC
LIMIT 1000
Answer:
Too long, hard cut:
npi,provider_total_claims
1457492688,65131
1093793101,57140
1639171143,53895
1730172776,52654
1588750467,52409
1174639819,51997
1508896457,48926
1467560656,45848
1124087713,45205
1154417871,44196
1588633135,43555
1356318992,43313
1366432213,43287
1265455109,41793
1235223868,41347
1639138654,41209
1245229905,38711
1487640900,37918
1891720058,37644
1154384782,37292
1407801798,37226
1619082625,36466
1609882000,36146
1255395935,35379
1073671400,35129
1962422972,35040
1619989514,34879
1467446054,34572
1083646970,34489
1932112158,34109
1831196898,33535
1487633772,33476
1679570246,33313
1649275918,32579
1477720167,32342
1013019454,32297
1215028956,32274
1093798746,32273
1760431761,31452
1306847405,31199
1255313391,30980
1154493575,30905
1093777930,30764
1114968385,30670
1851507362,30565
1912011107,30269
1083765531,30161
1720016793,30112
1750558979,29988
1659353068,29838
1871530949,29748
1528235181,29361
1386745578,29297
1568607919,29264
1497837090,28789
1154310266,28662
1336184290,28157
1740508696,28136
1528140597,28032
1083750913,28004
1275639502,27675
1639346976,27674
1235113044,27660
1316924715,27476
1043381569,27453
1881623445,27358
1164433900,27283
1922039213,27200
1841253267,27197
1912950858,27182
1588644991,27138
1629295571,27128
1982699773,27126
1942253158,27072
1659354983,27041
1316914021,27001
1063400521,26977
1326057787,26877
1235122326,26542
1386605566,26311
1568513257,26246
1467487801,25989
1124187307,25973
1679560833,25846
1477509602,25801
1710071063,25697
1417992322,25508
1649280413,25417
1033205117,25288
1689654220,25146
1679674717,25008
1215997887,24881
1932261716,24826
1447296421,24760
1790714962,24673
1205948668,24469
1205867835,24371
1285679498,24361
1366425530,24260
1144340225,24218
1780772947,24202
1558451450,24109
1558465237,24102
1144277443,23943
1437151537,23938
1023028354,23669
1871674960,23397
1316979651,23351
1790750859,23328
1588712152,23316
1780654558,23313
1427067644,23290
1093880957,23228
1477501609,23194
1710181110,23141
1558445478,23133
1720059298,23033
1508060880,23031
1205803509,22912
1750302576,22907
1265595300,22865
1134112691,22794
1164447629,22789
1164406229,22678
1235127150,22645
1902835192,22589
1174633622,22527
1841231057,22516
1023119039,22477
1851539415,22449
1508890740,22442
1144222340,22434
1326000498,22315
1144271917,22288
1558372086,22286
1619998077,22247
1447340237,22223
1528153467,22202
1760407084,22109
1386733442,22091
1992907539,22002
1013900513,21988
1710978481,21967
1265480073,21950
1982662458,21947
1891700605,21940
1720146699,21909
1801824255,21906
1457561920,21879
1861570558,21871
1679619233,21722
1033277827,21706
1225080054,21673
1588658512,21635
1326111550,21499
1053309039,21491
1154332310,21440
1396793113,21376
1053429829,21372
1508809740,21318
1619984432,21302
1700870953,21237
1245247402,21222
1902831175,21219
1750332623,21205
1073561056,21133
1942335096,21089
1942381405,21053
1205947074,20996
1881601052,20969
1215949219,20921
1033202544,20892
1346221264,20830
1902978141,20796
1053361816,20782
1538438858,20779
1992749410,20638
1386733764,20546
1821162611,20522
1124017249,20456
1205885514,20424
1235210956,20402
1659476711,20342
1720035082,20304
1255358164,20292
1174592455,20288
1396820759,20200
1285605394,20192
1649351214,20128
1023052784,20126
1487741039,20020
1083798920,20018
1225069446,20008
1801017470,19985
1619977675,19924
1821172362,19908
1093784837,19871
1306852942,19822
1992773329,19795
1942211776,19788
1346321254,19788
1730125618,19714
1295758860,19550
1972516482,19547
1861436719,19541
1588823025,19505
1942272323,19426
1912908203,19371
1467450759,19342
1932274156,19274
1609869833,19269
1386601557,19188
1306823935,19180
1821053299,19173
1538131388,19133
1295739944,19129
1942393343,19046
1245231083,18977
1780623868,18886
1497771018,18849
1003880055,18809
1528004207,18778
1336229392,18744
1194740506,18700
1154326825,18678
1942226485,18653
1831160589,18620
1750339404,18606
1619925344,18576
1528003019,18510
1194748822,18502
1346450897,18499
1326032012,18445
1831248095,18438
1215906078,18385
1427095686,18384
1023106838,18381
1386733715,18374
1508880006,18371
1730181868,18309
1083632392,18290
1821056433,18284
1548299670,18272
1861456196,18268
1902955768,18208
1225050404,18196
1861587438,18188
1386711612,18110
1356382246,18101
1033161021,18074
1568750057,18060
1154497642,17992
1508933581,17962
1053342535,17962
1326131616,17948
1912993098,17934
1134124464,17933
1033233879,17906
1285681643,17853
1013953975,17831
1003875733,17817
1760496921,17802
1720022486,17763
1467490896,17732
1811007743,17648
1972684751,17646
1306885306,17608
1548333552,17594
1972532554,17573
1295803120,17567
1003825274,17547
1073598660,17508
1689765901,17501
1326073289,17487
1497778799,17486
1275556623,17473
1023030251,17468
1003845660,17459
1750457032,17438
1649341843,17398
1285794925,17383
1578625737,17369
1043316755,17291
1982780078,17252
1548261811,17171
1194915389,17155
1053419028,17143
1033147426,17138
1629031208,17093
1225025109,17090
1477508117,17076
1649379934,17073
1528092707
Query:
-- 14. Find the specialties with the highest total claim counts nationwide.
SELECT "specialty_description", SUM("total_claim_count") AS "total_claims"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
GROUP BY "specialty_description"
ORDER BY "total_claims" DESC
LIMIT 1000
Answer:
Too long, hard cut:
specialty_description,total_claims
Internal Medicine,385858450
Family Practice,361410647
Nurse Practitioner,77798973
Cardiology,67061172
Psychiatry,40912819
Physician Assistant,40433925
General Practice,30214429
Ophthalmology,23576481
Neurology,18610103
Nephrology,13896844
Emergency Medicine,12468018
Endocrinology,12427024
Urology,11877008
Pulmonary Disease,11506976
Geriatric Medicine,10970038
Rheumatology,10879733
Gastroenterology,10337430
Dermatology,6086148
Physical Medicine and Rehabilitation,6041716
Orthopedic Surgery,5957525
Dentist,5507795
Hematology/Oncology,5323040
Anesthesiology,4356238
Interventional Pain Management,4052937
Psychiatry & Neurology,3965578
Optometry,3911430
Obstetrics/Gynecology,3842451
General Surgery,3796486
Infectious Disease,3618386
Otolaryngology,3607257
Pain Management,2987367
Podiatry,2747446
Certified Clinical Nurse Specialist,2227157
Student in an Organized Health Care Education/Training Program,2136393
Cardiac Electrophysiology,2030588
Allergy/Immunology,1982136
Pediatric Medicine,1960228
Medical Oncology,1536571
Oral Surgery (dentists only),922026
Critical Care (Intensivists),787028
Osteopathic Manipulative Medicine,760072
Neurosurgery,740265
Specialist,649455
Neuropsychiatry,612804
Vascular Surgery,491463
Preventive Medicine,395584
Pharmacist,392667
Family Medicine,391783
Registered Nurse,335449
Plastic and Reconstructive Surgery,323740
Cardiac Surgery,322047
Hematology,303023
Radiation Oncology,299581
Diagnostic Radiology,278532
Maxillofacial Surgery,255078
Hospice and Palliative Care,243237
Geriatric Psychiatry,225099
Thoracic Surgery,217715
Clinic/Center,184814
Colorectal Surgery (formerly proctology),177762
Hand Surgery,150760
Gynecological/Oncology,139191
Addiction Medicine,120726
Sports Medicine,114748
Multispecialty Clinic/Group Practice,112220
Legal Medicine,94363
Nuclear Medicine,88485
Hospitalist,77109
Orthopaedic Surgery,71631
Sleep Medicine,70563
Pathology,65949
Interventional Radiology,61565
Psychologist (billing independently),60265
Certified Nurse Midwife,54794
Surgical Oncology,50046
Community Health Worker,48937
"Medical Genetics, Ph.D. Medical Genetics",48271
Clinical Psychologist,47463
Peripheral Vascular Disease,41768
Counselor,39785
Oral & Maxillofacial Surgery,38207
Licensed Practical Nurse,36464
Unknown Physician Specialty Code,36100
Naturopath,33196
Driver,32162
CRNA,29108
Personal Emergency Response Attendant,21539
Plastic Surgery,19845
Hospital (Dmercs Only),16848
Neurological Surgery,16469
Health Maintenance Organization,15273
Chiropractic,13746
Rehabilitation Agency,13658
General Acute Care Hospital,13390
Interventional Cardiology,13310
Thoracic Surgery (Cardiothoracic Vascular Surgery),12859
Case Manager/Care Coordinator,12058
"Neuromusculoskeletal Medicine, Sports Medicine",11769
Respite Care,8909
Independent Medical Examiner,7712
Licensed Clinical Social Worker,6956
Surgery,6653
Public Health Welfare Agency,4895
Contractor,4608
Clinical Pharmacology,4594
Clinical Neuropsychologist,4417
Acupuncturist,4324
Physical Therapist,4069
Midwife,3371
Unknown Supplier/Provider,3005
Psychoanalyst,2684
Point of Service,2253
Chronic Disease Hospital,2220
Radiology,1921
Obstetrics & Gynecology,1779
Psychologist,1772
Behavioral Analyst,1751
Prosthetist,1172
Licensed Vocational Nurse,1140
Colon & Rectal Surgery,1109
Homeopath,924
Rehabilitation Practitioner,857
Occupational therapist,848
Exclusive Provider Organization,845
Speech Language Pathologist,798
Marriage & Family Therapist,735
Religious Nonmedical Nursing Personnel,663
Medical Genetics,627
Social Worker,618
Preferred Provider Organization,587
Adult Companion,520
Dental Hygienist,502
Military Health Care Provider,450
Physical Medicine & Rehabilitation,413
Denturist,403
Electrodiagnostic Medicine,384
Technician/Technologist,329
Slide Preparation Facility,327
Registered Dietician/Nutrition Professional,321
Pediatrics,316
Nutritionist,308
Specialist/Technologist,306
Naprapath,277
Audiologist (billing independently),268
Chore Provider,232
Dental Assistant,213
"Specialist/Technologist, Other",212
Case Management,209
Anesthesiologist Assistants,208
"Respiratory Therapist, Certified",179
"Emergency Medical Technician, Intermediate",154
"Emergency Medical Technician, Basic",152
"Nursing Facility, Other (Dmercs Only)",144
Substance Abuse Rehabilitation Facility,143
"Spec/Tech, Cardiovascular",140
Ambulatory Surgical Center,126
Radiologic Technologist,120
Home Health Aide,116
Physical Therapy Assistant,113
Massage Therapist,111
Community/Behavioral Health,109
Phlebology,104
Occupational Therapy Assistant,101
Durable Medical Equipment & Medical Supplies,91
Clinical Medical Laboratory,90
Military Hospital,87
Technician,82
Optician,78
"Spec/Tech, Pathology",57
Nurse's Aide,56
Rehabilitation Counselor,55
Pharmacy Technician,55
"Residential Treatment Facility, Emotionally Disturbed Children",47
Pharmacy,35
Mass Immunization Roster Biller,35
Licensed Psychiatric Technician,33
"Medical Supply Company, Other",30
"Ge
Query:
-- 15. List total drug costs per city in New York State.
SELECT "nppes_provider_city", SUM("total_drug_cost") AS "city_total_cost"
FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE "nppes_provider_state" = 'NY'
GROUP BY "nppes_provider_city"
ORDER BY "city_total_cost" DESC
LIMIT 1000
Answer:
Too long, hard cut:
nppes_provider_city,city_total_cost
NEW YORK,1381447820.7600005
BROOKLYN,939567561.99
BRONX,442377376.72999996
ROCHESTER,297455250.8599999
FLUSHING,180465300.49
ALBANY,164038339.42000005
STATEN ISLAND,146385378.27000004
BUFFALO,146117772.1
SYRACUSE,107722980.39000002
WILLIAMSVILLE,95257449.82000002
FOREST HILLS,65517355.66
NEW HYDE PARK,65036679.34000001
JAMAICA,54070267.879999995
SCHENECTADY,53222507.050000004
YONKERS,53005053.97999999
MIDDLETOWN,52931350.90000003
BINGHAMTON,50174731.98000001
ELMHURST,48946385.480000004
GREAT NECK,48669597.300000004
POUGHKEEPSIE,48358056.580000006
WHITE PLAINS,47363487.69
MANHASSET,45831665.7
NEW HARTFORD,42753347.37000001
REGO PARK,41217154.099999994
AMHERST,38511866.68000001
KINGSTON,37976679.37
MINEOLA,37818040.67999999
SMITHTOWN,35843945.28
LAKE SUCCESS,34683996.82
ORCHARD PARK,33925638.51
BAY SHORE,33817027.42000001
JACKSON HEIGHTS,33662502.0
ROCKVILLE CENTRE,33444079.009999998
ASTORIA,33284492.03999999
UTICA,31396867.169999994
HUNTINGTON,29877777.07
EAST SETAUKET,29414618.329999994
ELMIRA,29217237.059999995
TROY,28729272.930000007
WEST SENECA,28486620.950000003
VALHALLA,27438195.740000002
NIAGARA FALLS,26872722.01000001
GARDEN CITY,26520690.620000005
RIVERHEAD,25911390.330000006
GLENS FALLS,25870704.32
STONY BROOK,25095516.350000005
SARATOGA SPRINGS,25085995.089999996
WATERTOWN,24717859.400000002
JAMESTOWN,24509370.389999997
FAR ROCKAWAY,24062389.86
FISHKILL,23942822.030000016
PLATTSBURGH,23795270.560000002
LIVERPOOL,23515728.83
CHEEKTOWAGA,22435470.839999996
OLEAN,22202163.380000003
NEW ROCHELLE,21535504.149999995
MASSAPEQUA,19862954.349999998
EAST SYRACUSE,19511564.16
COOPERSTOWN,19471224.6
PLAINVIEW,19313748.46000001
WEST NYACK,18934459.810000002
JOHNSON CITY,18802021.669999994
ITHACA,18064281.32
MOUNT KISCO,17595387.56
BAYSIDE,17018159.220000006
LATHAM,16955182.590000004
NEWBURGH,16752602.12
FRESH MEADOWS,16721118.780000001
ROME,16238946.090000004
AUBURN,16076030.05
AMSTERDAM,15755200.319999998
SUFFERN,15684966.550000008
EAST MEADOW,15422751.349999994
GOSHEN,14734687.460000005
SCARSDALE,14224777.359999994
VESTAL,14088987.69
CORNING,13765833.919999998
BETHPAGE,13614534.000000002
HORSEHEADS,13568569.860000001
POMONA,13549434.599999998
VALLEY STREAM,13059484.309999997
LYNBROOK,12985280.6
OSWEGO,12885013.239999993
YORKTOWN HEIGHTS,12790316.76
PORT JEFFERSON,12778708.840000004
AMITYVILLE,12628861.57
ROSLYN,12528975.469999999
HAWTHORNE,12035707.060000006
HUDSON,12011562.479999997
HICKSVILLE,11869879.340000004
SYOSSET,11795539.039999997
CANANDAIGUA,11590664.370000001
BATAVIA,11414495.399999995
BABYLON,11393320.890000002
WEST ISLIP,11331308.74
NEW WINDSOR,11265538.749999993
PORT JEFFERSON STATION,10902174.109999994
LOCKPORT,10874175.879999999
CLIFTON SPRINGS,10810599.170000006
GENEVA,10806279.170000002
GLEN COVE,10777943.87
E SETAUKET,10754767.479999997
PATCHOGUE,10658848.450000001
COMMACK,10546363.739999998
ONEONTA,10262734.849999996
NEW CITY,9993587.780000001
SOUTH RICHMOND HILL,9815675.829999998
GLOVERSVILLE,9757721.920000002
FREEPORT,9688891.040000003
WOODSIDE,9612428.23
EAST PATCHOGUE,9561135.959999999
LONG BEACH,9497272.379999997
TONAWANDA,9378252.489999998
MALONE,9276843.34
MONTICELLO,9222707.009999998
QUEENSBURY,8730951.460000005
CLIFTON PARK,8716323.46
HAUPPAUGE,8706413.99
RIDGEWOOD,8661619.249999998
HEWLETT,8531021.460000003
OGDENSBURG,8378191.97
RICHMOND HILL,8338837.800000001
LONG ISLAND CITY,8338733.37
FAYETTEVILLE,8308120.74
BREWSTER,8192291.079999999
CORTLAND,8107423.779999998
HORNELL,7918876.949999999
SARANAC LAKE,7897594.619999999
CAMILLUS,7726631.500000003
HAMBURG,7692652.070000001
MEDFORD,7672428.71
ISLIP,7664897.190000003
MOUNT VERNON,7613627.8900000015
WOODBURY,7439377.659999999
CORTLANDT MANOR,7378570.320000001
QUEENS VILLAGE,7238038.999999999
CORONA,7105348.949999997
KENMORE,6939267.300000001
LEWISTON,6918358.700000001
HEMPSTEAD,6843091.44
HOWARD BEACH,6831392.550000001
HUNTINGTON STATION,6782984.979999998
DUNKIRK,6483644.749999999
LAKE RONKONKOMA,6416212.300000001
WEBSTER,6380557.48
BRENTWOOD,6332377.110000001
CARMEL,6318069.500000001
SLINGERLANDS,6211498.989999998
ONEIDA,6159369.94
NYACK,6138879.010000001
ENDWELL,6088188.919999998
DEER PARK,5928421.019999999
LAWRENCE,5913951.979999997
NORWICH,5911517.130000003
NORTH SYRACUSE,5882984.28
MIDDLE VILLAGE,5881849.990000001
OCEANSIDE,5837954.440000001
CEDARHURST,5794501.200000003
DELMAR,5741320.829999999
NANUET,5706706.779999997
SOUTHAMPTON,5693047.610000001
NESCONSET,5617783.47
RYE,5610028.490000002
BATH,5609065.390000001
BRONXVILLE,5575032.290000002
FAIRPORT,5551246.6800000025
NEWARK,5456101.28
WARSAW,5438391.7299999995
OSSINING,5321767.47
GARNERVILLE,5309168.069999998
CORNWALL,5223707.529999999
POTSDAM,5144302.4799999995
PITTSFORD,5133215.839999999
SEAFORD,5101835.91
RYE BROOK,5073462.240000001
DANSVILLE,5035367.76
WEST BABYLON,5034279.38
ENDICOTT,5017987.170000001
PENN YAN,4951728.36
NORTH BABYLON,4950814.72
MEDINA,4872225.27
KEW GARDENS,4808340.849999999
MASSENA,4718675.71
CANTON,4676148.13
HOLLIS
End Exploring Related Columns
Task: For the drug with the highest total number of prescriptions in New York State during 2014, could you list the top five states with the highest total claim counts for this drug? Please also include their total claim counts and total drug costs. 

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: The drug with the highest total number of prescriptions in New York State during 2014 is **drug_name:str**. Here are the top five states with the highest total claim counts for this drug:

```csv
State,Total Claim Count,Total Drug Cost
state1:str,claim_count1:int,cost1:float
state2:str,claim_count2:int,cost2:float
state3:str,claim_count3:int,cost3:float
state4:str,claim_count4:int,cost4:float
state5:str,claim_count5:int,cost5:float
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 05:21:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 05:21:21 - root - INFO - ```sql
WITH top_drug AS (
    SELECT "drug_name"
    FROM (
        SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
        FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
        WHERE "nppes_provider_state" = 'NY'
        GROUP BY "drug_name"
        ORDER BY "total_claims" DESC NULLS LAST
        LIMIT 1
    ) AS sub
)
SELECT
    "nppes_provider_state" AS "State",
    SUM("total_claim_count") AS "Total Claim Count",
    SUM("total_drug_cost") AS "Total Drug Cost"
FROM
    CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014",
    top_drug
WHERE
    "drug_name" = top_drug."drug_name"
GROUP BY
    "nppes_provider_state"
ORDER BY
    "Total Claim Count" DESC NULLS LAST,
    "nppes_provider_state"
LIMIT 5;
```
2025-01-20 05:21:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:21:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:21:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:21:22 - snowflake.connector.connection - INFO - closed
2025-01-20 05:21:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:21:23 - root - INFO - itercount: 1
2025-01-20 05:21:23 - root - INFO - 002028 (42601): 01b9d4c1-0004-7d02-0001-11c300f063c2: SQL compilation error:
ambiguous column name 'drug_name'
2025-01-20 05:21:23 - root - INFO - Input sql:
WITH top_drug AS (
    SELECT "drug_name"
    FROM (
        SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
        FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
        WHERE "nppes_provider_state" = 'NY'
        GROUP BY "drug_name"
        ORDER BY "total_claims" DESC NULLS LAST
        LIMIT 1
    ) AS sub
)
SELECT
    "nppes_provider_state" AS "State",
    SUM("total_claim_count") AS "Total Claim Count",
    SUM("total_drug_cost") AS "Total Drug Cost"
FROM
    CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014",
    top_drug
WHERE
    "drug_name" = top_drug."drug_name"
GROUP BY
    "nppes_provider_state"
ORDER BY
    "Total Claim Count" DESC NULLS LAST,
    "nppes_provider_state"
LIMIT 5;
The error information is:
002028 (42601): 01b9d4c1-0004-7d02-0001-11c300f063c2: SQL compilation error:
ambiguous column name 'drug_name'
Please correct it and output only 1 complete SQL query.
2025-01-20 05:22:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 05:22:01 - root - INFO - ```sql
WITH top_drug AS (
    SELECT "drug_name"
    FROM (
        SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
        FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
        WHERE "nppes_provider_state" = 'NY'
        GROUP BY "drug_name"
        ORDER BY "total_claims" DESC NULLS LAST
        LIMIT 1
    ) AS sub
)
SELECT
    p."nppes_provider_state" AS "State",
    SUM(p."total_claim_count") AS "Total Claim Count",
    SUM(p."total_drug_cost") AS "Total Drug Cost"
FROM
    CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014" AS p
    JOIN top_drug ON p."drug_name" = top_drug."drug_name"
GROUP BY
    p."nppes_provider_state"
ORDER BY
    "Total Claim Count" DESC NULLS LAST,
    p."nppes_provider_state"
LIMIT 5;
```
2025-01-20 05:22:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:22:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:22:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:22:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 05:22:03 - snowflake.connector.connection - INFO - closed
2025-01-20 05:22:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:22:03 - root - INFO - itercount: 2
2025-01-20 05:22:03 - root - INFO - 0
2025-01-20 05:22:03 - root - INFO - results: 
State,Total Claim Count,Total Drug Cost
CA,3725846,35073534.86999998
FL,2689327,21046051.189999994
NY,2606392,20729281.250000007
TX,2212275,17513523.7
PA,1760543,14121212.74


2025-01-20 05:22:03 - root - INFO - Please check the answer again by reviewing For the drug with the highest total number of prescriptions in New York State during 2014, could you list the top five states with the highest total claim counts for this drug? Please also include their total claim counts and total drug costs. , reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: The drug with the highest total number of prescriptions in New York State during 2014 is **drug_name:str**. Here are the top five states with the highest total claim counts for this drug:

```csv
State,Total Claim Count,Total Drug Cost
state1:str,claim_count1:int,cost1:float
state2:str,claim_count2:int,cost2:float
state3:str,claim_count3:int,cost3:float
state4:str,claim_count4:int,cost4:float
state5:str,claim_count5:int,cost5:float
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Total Claim Count,Total Drug Cost
CA,3725846,35073534.86999998
FL,2689327,21046051.189999994
NY,2606392,20729281.250000007
TX,2212275,17513523.7
PA,1760543,14121212.74
Current sql:
WITH top_drug AS (
    SELECT "drug_name"
    FROM (
        SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
        FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
        WHERE "nppes_provider_state" = 'NY'
        GROUP BY "drug_name"
        ORDER BY "total_claims" DESC NULLS LAST
        LIMIT 1
    ) AS sub
)
SELECT
    p."nppes_provider_state" AS "State",
    SUM(p."total_claim_count") AS "Total Claim Count",
    SUM(p."total_drug_cost") AS "Total Drug Cost"
FROM
    CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014" AS p
    JOIN top_drug ON p."drug_name" = top_drug."drug_name"
GROUP BY
    p."nppes_provider_state"
ORDER BY
    "Total Claim Count" DESC NULLS LAST,
    p."nppes_provider_state"
LIMIT 5;
2025-01-20 05:22:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 05:22:46 - root - INFO - The drug with the highest total number of prescriptions in New York State during 2014 is **AMLODIPINE BESYLATE**. Here are the top five states with the highest total claim counts for this drug:

```csv
State,Total Claim Count,Total Drug Cost
CA,3725846,35073534.8700
FL,2689327,21046051.1900
NY,2606392,20729281.2500
TX,2212275,17513523.7000
PA,1760543,14121212.7400
```

```sql
WITH top_drug AS (
    SELECT "drug_name"
    FROM (
        SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
        FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
        WHERE "nppes_provider_state" = 'NY'
        GROUP BY "drug_name"
        ORDER BY "total_claims" DESC NULLS LAST
        LIMIT 1
    ) AS sub
)
SELECT
    p."nppes_provider_state" AS "State",
    SUM(p."total_claim_count") AS "Total Claim Count",
    ROUND(SUM(p."total_drug_cost"), 4) AS "Total Drug Cost"
FROM
    CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014" AS p
    JOIN top_drug ON p."drug_name" = top_drug."drug_name"
GROUP BY
    p."nppes_provider_state"
ORDER BY
    "Total Claim Count" DESC NULLS LAST,
    p."nppes_provider_state"
LIMIT 5;
```
2025-01-20 05:22:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 05:22:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 05:22:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 05:22:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 05:22:47 - snowflake.connector.connection - INFO - closed
2025-01-20 05:22:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 05:22:48 - root - INFO - itercount: 3
2025-01-20 05:22:48 - root - INFO - 0
2025-01-20 05:22:48 - root - INFO - Total iteration counts: 3
