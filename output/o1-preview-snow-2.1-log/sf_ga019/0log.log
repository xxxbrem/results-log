2025-01-23 04:48:56 - openai._base_client - INFO - Retrying request to /chat/completions in 0.497855 seconds
2025-01-23 04:49:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 04:49:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:49:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:49:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:49:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-01-23 04:49:37 - snowflake.connector.connection - INFO - closed
2025-01-23 04:49:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:49:37 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
   LIMIT 100;
Results:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open

2025-01-23 04:49:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:49:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:49:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:49:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 04:49:39 - snowflake.connector.connection - INFO - closed
2025-01-23 04:49:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:49:39 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
   WHERE "event_date" BETWEEN '20180801' AND '20180831'
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
7153341A14B1253A46FD8D6DE5490EE4,1518103722890000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
475BF363AECBE3A08102A769174D278F,1529461048713000
475BF363AECBE3A08102A769174D278F,1529461048713000
475BF363AECBE3A08102A769174D278F,1529461048713000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5

2025-01-23 04:49:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:49:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:49:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:49:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 04:49:41 - snowflake.connector.connection - INFO - closed
2025-01-23 04:49:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:50:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 04:50:29 - root - INFO - ```sql
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
WHERE "event_name" IN ('first_open', 'app_remove')
LIMIT 100;
```
2025-01-23 04:50:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:50:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:50:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:50:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-23 04:50:30 - snowflake.connector.connection - INFO - closed
2025-01-23 04:50:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 04:51:23 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
WHERE "event_name" IN ('first_open', 'app_remove')
LIMIT 100;
Results:
user_pseudo_id,event_name,event_timestamp
F27F046DF960AB50CE65B9F4364C981E,app_remove,1534320357679014
0CA01A88046296B06E72B5E945A95732,app_remove,1534361274773000
0CE0108DD168AC70E11C9DD96C122956,app_remove,1534341750149000
9D535D543FD07B8247DEADB4669FADE6,app_remove,1534334244423000
62440E2EC0A24E9FB2CF09E230FFDEC4,app_remove,1534366142788000
5346C62F49BF2E6C1199456F16604B3C,app_remove,1534373536131000
E806F12D29E9F873BE6EAA01CD1E1B4F,app_remove,1534342478172000
0597C8E39ECFBDFB2C6289471B52B974,app_remove,1534358635605000
D49B24FA9F7D4D482074FCE5E0469C55,app_remove,1534328491032000
310D44D95961BF9754C9948AF6F437EA,app_remove,1534323863109000
B2F661E88136265632545A030F09A88A,app_remove,1534352912485000
DE7350AD7068B30F98279BBD65AEF609,app_remove,1534345252488000
DAB972641CDD57B498702CA343A4ABCF,app_remove,1534344719287000
2B38130AF309DC84605BF6658EC03470,app_remove,1534371885800000
8BC72D1925A8866050D5A6FB01148518,app_remove,1534344472289000
80B7E9D1DF9155BA2277817B7F1E06AE,app_remove,1534387428443000
15C047FB330537BE72C8B690117BC25A,app_remove,1534327418105000
BC4975868D38E7BA0AC93C69B4FE6FF5,app_remove,1534334430982429
835765A97BEE13977198CB622AB23A8E,app_remove,1534341773716000
005F127942F3FD25588272950FDFD339,app_remove,1534326738450000
0545C2BABDB15C6A952ECEA222E8F5E6,first_open,1534385001696000
96B108514A10609B9E8F4F78B47B6776,first_open,1534364313386000
7F8E0A83EA3833F063DA2107E073AC03,first_open,1534351821439000
B234DE95E7BA43F7D422B2A2ED211629,first_open,1534372312457000
51E3AEBCB31617B0A5EC1A48877E9A70,first_open,1534390469545000
F475A23EE0B80DC59250CBB1C35AFB3E,first_open,1534361592926000
AEEFEB2B840AB521A60BDFB354D06F32,first_open,1534317334718000
62440E2EC0A24E9FB2CF09E230FFDEC4,first_open,1534366108062000
A1377ED195838AEBC979C6884647383F,first_open,1534319298387000
80B7E9D1DF9155BA2277817B7F1E06AE,first_open,1534387401660000
F7164A70962E5AED09AD0CEB0A3C7C82,first_open,1534390727580000
BFF00C0BEDC08F406D999413584797D5,first_open,1534390382577000
7E48E529DD8F36846B02F6ACE460236F,first_open,1534396103025000
14DE6B1CDA3BFD44679C7E9382644AC7,first_open,1534371104465000
D85672E8322401603F6706560AAFACA7,first_open,1534359769094000
7EA86ADA1763724469F41BFE017D43C4,app_remove,1534360359238000
E9E777B58E17AE5695695BD3B68B255F,first_open,1534360360688000
1C9927831BAA7A0569130EADD6320C69,first_open,1534365421765000
ED4C30231EFF6BA5660398B76E680FA8,first_open,1534381270405000
19B5E340A2D84666E5178E237F29A22B,first_open,1534359288922000
BC4975868D38E7BA0AC93C69B4FE6FF5,first_open,1534325111919000
7C2B51C7FD6A677AA1627FFCCA79CAA9,first_open,1534348230884000
10F23E6BC97C1373F4F972DB75A30F01,first_open,1534354146852000
49E983E1361F11F5205CDA4289B71003,first_open,1534366336654000
BC575A719C37E1C2237B79FE7FD3F7E1,first_open,1534332267576000
D4BE9C6F73E39CCE4ED1901AF98A9E3A,first_open,1534385444055000
814700C58B117F7ABFFB1145B9C29D29,first_open,1534381476043000
005F127942F3FD25588272950FDFD339,first_open,1534326741323000

2025-01-23 04:51:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 04:51:24 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:25 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
WHERE "event_name" = 'app_remove' AND "event_date" BETWEEN '20180801' AND '20180930'
LIMIT 100
Results:
user_pseudo_id,event_name,event_timestamp
7705D52DD2286DC2E6DB831A2E129E94,app_remove,1536612574534044
E069FDF17198500FCB6DDDF406ABA122,app_remove,1536604953898000
2EF53F63407052EC94131725462F090E,app_remove,1536605164712000
663EAD1943AE7594E0633D10ADB5EF52,app_remove,1536606759225000
860EFF376090269DF25684D8769DF55F,app_remove,1536562882037000
E1A3C786B2E4D56629EE808A3A174995,app_remove,1536614421446000
E161A81E23235DDDF1C2B76E37A66EC5,app_remove,1536580493381000
B654CDDD4CC097495BF30819077AE75C,app_remove,1536638786229008
B108145758BBB6A7B69869E2E4EB9203,app_remove,1536575617429000
FD46EE61C22A10F97D29D527EDF7BC7D,app_remove,1536624041951000
8CED53DF2E18FAB2FCD5297C0CC860AB,app_remove,1536642234031000
C63E044972BC46A8840F4CCB3174690B,app_remove,1536590296636000
B5EE4A89792209060659C9A6719EA8A4,app_remove,1536623047415016
1E4AEC3626FA2D8DA2522810B11A0278,app_remove,1536571308770000
B3234CECCA15CEE80BDE39DA9D8AE687,app_remove,1536622843562000

2025-01-23 04:51:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 04:51:27 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:27 - root - INFO - SQL:
SELECT f.value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 18
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 19
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455464
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455459
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455455
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455450
  }
}"
"{
  ""key"": ""board"",
  ""value"": {


2025-01-23 04:51:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-01-23 04:51:29 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:29 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
WHERE "event_name" = 'first_open' AND "event_date" BETWEEN '20180801' AND '20180831'
LIMIT 100
Results:
user_pseudo_id
6FA9428194AD2E9D16720D405ED2DAB2
43251B4821FA3F7EF7A38628655ACB7D
CBC67C63B6826BABB6BC657E5E4382E5
D5544C064404DC6067412B1272F848D6
C1B1A57BFD7A3176CB7C587FF29653C6
57EC50FBC6C7277B8EDCCE44C1352BD4
4091F647A1B6367AC7945DA0917CDA7D
E846EDC289792A14A18D16A50F50DBCA
7954F970C93ED6F9AEF04CE25CE871CD
EE3C0D0F03E9B90D93E774EF0E4F8D4A
68F870FD9708D9569124B7882EA53641
747E6D4DF9C3C9FEC2151A72F696ACF9
4E6F4A73B5D05B33DC73B11547E39004
3B503D512D8D9A26C813B15CAA5A1BEF
92D613354268A0E592A3032CFE1D7987
3A540A2426891205362CA11B28D4D612
422E4B66736C74A880ACFF8895D1117F
670514A3825CACC6F6628AF24441AD0F
4678BE2C4434D27CCB2AAEEE76A5339E
9690B6E46BD58A8B118514973F0B57D0
4A74F895139C481B907A37EE5D25BA1B
FB629A58366521D55498F45606F8CA84
BB90E3EF80325C68D00E6BCEEBDCAA79
B2F661E88136265632545A030F09A88A
239B36D8ED2161D10687A09C0EF34477
E3DB69E48378F1EED6C064C7614AACAB
EF651AFA508A4888B92578704BFAC986
5646899D197E5F36BA6CE0E08456B026
6040FA99B7E38468A771643D0702322F
EC3BAA23738340386BBAD8114221E1D7
80E1D7AD1980A2D9B7A6A7BD4D939337
F6E6CCCB27C3FA47728DCA1C4AE72AC4
774364DD86012B5503A710C4BF612F92
CAAE5593CC002505DFF01CBF4C33B83A
C98E984527F5BF9F4F673530F184AF62
59D595A9B16ACFB6FA3E0BF068C17C32
57665A278A54980F95181A64E6D55E6A
A1959F7082D82015768E43409DC15E50
7A3A20ED131AB674321A955B40644B7A
F7D09AFD89AFEA294B430C83737224A8
4E68A26D72DE120819F9FA3AD7482EF4
A332BF6CC122D1CEE65358AF2CBBD567
83087EBE7E2001DD1918810489389A6D
56A069E37C273BE2092ADEB0D527D9B3
38D65030548914B5E167CE85B035CA8F
0C67D250019C3714C55CFCEB663544A4
E3EDDBED53EE3E42ECF55A5E091F56D8
19CBDFEE0542DE6749B6D1628021BB4F
DFF46496068299CA44163BEF38B7F89D
747C402883F8362C5126E1F17001589D
D459259A48556B4C4BA67DA52F665AC9
E68A264ADBA1C799CEC92C1B6D234E2A
33443052ABE335E361BACA959B64F9D4
82660A783170BC1C45EEAB3B713B6C5C
D00B400D2C00C34D76B3DA942BCF93C5
52FD02951B8655BDEDFEBC6BEDD1B311
A20E7E669E319B0A1912A187C4169AEE
19C8EAB201DA2CDDC1240ACD0E3D7441
45FB547C5857493104687C234EDCDE37
CE869BF6173A1F46388AC4B3F6FF4EFA
F3B0F2F150A1D91E15BB07FACD1EFC89
1BC92220D3CB5345F4E46D35D14D5FC8
F737990A8EE1F47ADA4A5200F9C38A97
918AB13390C2B040E4B0D5086EBF3349

2025-01-23 04:51:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 16
2025-01-23 04:51:30 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:31 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
WHERE "event_name" = 'app_remove' AND "event_date" BETWEEN '20180901' AND '20180930'
LIMIT 100
Results:
user_pseudo_id
87A089C253872EDE201776ABF0CE69CC
50B507B8C1BD14FA0BC9BE6991513DFE
9DB91A563FC210E7CB110408AB943DC5
57E7A689A86A94D750A4C68220DDD679
1EE74A9149F4AA2CC1E6DABD18BEFD3C
433E34F1BFEEF8A34A78D2C73D3AA014
6194417FC6F7937D8EE0DE82668B5453
4293BE87C4C4EE3249F6DCA7A27A866C
64E3BBB507EEFDE76364031EADF502F4
289D738E3B01C988983B957444571412
260F744C558B490AA7A98F05BB3E9E05
76B80AC19A11BEB87D87ED5D1A8642BA
34ADF71F1AADCA26EC8008496F7CC87E
415E757904443C53EE090E77B1F1EDA4
4E835B658FBCD64F19EB3F3C9FA601FA
77A9D856AEF74B96BDFBE805E66DB4A9

2025-01-23 04:51:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 04:51:33 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:33 - root - INFO - SQL:
SELECT "event_date", "event_name"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
WHERE "user_pseudo_id" = '023A2DB99CC3F70A4B71869C36952D74'
LIMIT 100
Results:
event_date,event_name
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view

2025-01-23 04:51:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 04:51:34 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:35 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
WHERE "event_date" = '20180905'
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
user_pseudo_id,event_count
817C3E590030EB56A11A38D56919B6C5,24
9F7B0D1BFB822F5E26E91E184E2E437C,4
49E9C6C52FBDE2759897A72EB7C37165,3
B390E09582A6DEF9545267A37C78B809,45
023A2DB99CC3F70A4B71869C36952D74,37
2C8605D838AC52596D7B42B550C9E608,146
A7993B3D9E693DFD3EA57CF4D1B8D00F,18
A2616A0876190B8C349DE35A9AF631B9,123
2EF53F63407052EC94131725462F090E,125
A70504A67EE34DD45EF82BFF86E9F94D,11
B087A865A90AD52D1864A36482983BD2,139
72946F932EBBBFA6C72D662874D2E4D5,117
608CEA53C39E0A3EAB36C8E8B075F161,3
5ACF1A6BFE350F7BB661BF389AF7E2F0,32
B99FD965B0874192EE94E8A8FE85EA9E,10
8EB99B177B914F63CE215683892205AD,9
48AB910A8DE8485D4C34238EA61F782C,90
ECB676BED33FDF42E1B0DCF234E1344B,35
AC14799A5E8C340D6CADCBAE72037D81,20
E75EF199A45513454ECC834C545EAC75,21
32D665523EBBFFF2A492D8E043A4FB6B,1
4ABFD2281F974B00B844E8F97B2E6D38,17
02CA9DD43A7BE3472BB48D0B0F72D52A,17
192440EC48EB5C30C261D16F03D7D229,1
3DEB0C12C49AD19D7ACE68FA59E7ACD6,443
51B215871E81C64077434452838DE86A,33
920DB84FCC0F4421650B9E257E33180B,10
D5F9D9AF22EF5073E10342973D48FB2C,21
84AFEFA3875BA1F17232CB41D06B6EF4,37
B71CB5D517BE99FEEED64A0F57842032,47
59BE43F3FE7AB3F91B016B56508D4C46,21
3682C2527BEE6BA0255321BB25DF44BB,9
7A8D1CAA45CDE7652260DA6E71068A13,89
7439CA3E049F434742CB5C63A55FC24D,157
E80C958E3C33898989A30B8F5A4514F0,87
E9B6A8FE354E4EF0A8C883E51755CA12,230
336BDA268CA6379F6EE567B4C16A1090,4
E1A3C786B2E4D56629EE808A3A174995,27
DC16CFBE43A591C7D18D4BE0BBC2E6CE,35
959635567E419A061EECCCA478EDC718,1139
7AA6572327B5C45D273CCD8868760033,7
622E890EE63F0B83C532CC052BEE8A50,48
B4BF91F8CFA904E81999D0422214BDF8,53
871CEF665A392E49675F62AF04E61D76,297
932AAF56DDE9C55359B9CCFA18E7FB95,115
9F8D4A18FC571082BD1D7AA5597756AD,4
0CAAA1B6F161BA4D363EB7A2DEF64A08,25
A305B55D5049F38F5139DA95B3DCE247,123
74375465CD17299EBC7C75A1B4047EE0,292
B5395F8C2077B59B3D6C5719C0CA0339,237
782A9B1FA75F15FA0EFE0FE3819BB5D7,21
BE36C49B1AB3968D420923AEC4FDD7AE,51
1E9F6BA9BD8C45633C26F42995A77775,78
0F1BF0E64772D0D00359FD7A4997D067,1
77F125B832C748232EDA6AF8C7D08ED1,23
018F03084C88E944163F76A0D0C2FBA1,164
C677D4AC75F093F984D7881B299C8C12,15
AE158E6238A048413B91B5A50D08810D,98
55E9F64E0467628594A2DD0B8BDB9EFA,20
8AFAFD6D7E79149C91BCAE1995E0CF47,48
C3FCDF18C57A6F16E5EE6867CA6679E1,104
C6F1E972D68BE8C168E02404C3B272C7,60
DA48D36D07835B1918BDF831AF83B5EF,145
5BA23094CD864C7FB5265F83652FA028,17
7E74A2BB6BBF4746DEE15F957B315401,511
BE0B27C2C14F4BC2B33DAEF7505BAF54,6
186F51E5AACB37852E3650E7027E33B1,3
C9262E10BCACD67DADD85566E354FEFC,21
0A26E7281EC31038AD42F28C930FFF90,44
459FD97ABE14D7762CD58C3A3104D183,158
CF092C279C3407DD69A44008D7511A2E,8
01B358175084B5B44F1C83C2A42FE33A,4
F0186BDA8E7BF76675999CFDCFB10F6B,29
904877128B8889DDD71A38BDBCD21724,458
39747754B0805753690EFF8D9711AB0C,158
037DAC225F0C1E54657770CD201CDDA7,11
09A826527E24EFA70A0B7A8BDCD38962,3
59454BAC415BB1F18517C6FD2C023E49,21
78CA698EA887F6421432DC107CD539B4,2
AD540E549BA77A71A7459EEAF2F8D3BC,36
9A10BF8F0166076BD918A5027396A46B,298
3D03A380687FE3369E93915D50C572CB,41
45EC7F973F9C0FE50CBCC7B05D88B39C,15
97380FCE77BAB6B251B50DDE4ABD8F8A,44
B27F6463047977351E76AEED8456E9FF,135
A1A9A8FC9138E7F9B568176AA7091F2D,42
E7F45BD93A980C6443443893DCDC0048,104
3DA885537C8B031959908EC7E8F27C9A,66
11FC272840E1ED3923F92C521AC68F1E,91
E063775534D380684BCA33B63B11B213,23
B175B187062693360BCBADC4160F8D88,155
6423FBDB63333D5EF6E628446EDE5635,36
D4DDA67EF184AFBC5E2D52FBDEDD7837,19
EB1A430BACB37E6EA72592BF838E64A6,196
466C7664CCCF329A8D39176840B3EB02,3
10B0D468B5E036E16D13DB53A65F2D49,562
CBC0686061C729A9C9181A919C4C5F9F,18
BED8A5D6788A8D8744F4656392DD2D7B,148
44CB977CB944DE7FD71943CE9A304F9E,52
28FC1BD0204945ED4B1B15E3A139347C,691

2025-01-23 04:51:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:51:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:51:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:51:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 04:51:37 - snowflake.connector.connection - INFO - closed
2025-01-23 04:51:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:51:37 - root - INFO - SQL:
SELECT f.value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920" t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572811016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707299946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445854869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640162766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572838902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787088340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572809736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572811016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572818016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707306946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445861869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640169766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572845902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787095340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572816736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572818016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572775016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707263946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445818869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640126766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572802902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787052340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572773736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572775016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572807016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707295946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445850869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640158766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572834902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787084340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572805736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572807016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572813016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707301946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445856869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640164766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572840902000,
    "

2025-01-23 04:51:37 - root - INFO - itercount: 0
2025-01-23 04:51:37 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
Consider the following columns and their potential usage:

- **"event_date"**: Used to filter events that occurred during August and September 2018.
- **"event_name"**: Identifies the type of event (e.g., "app_install", "app_uninstall"), used to find installation and uninstallation events.
- **"user_pseudo_id"**: Unique identifier for users, used to track user activities and link installations to uninstallations.
- **"event_timestamp"**: Provides the exact time of an event, useful for calculating the time between installation and uninstallation.
- **"user_first_touch_timestamp"**: Indicates when a user first interacted with the app, potentially representing the installation time.
- **"event_params"**: Contains additional details about events in nested JSON format; can be flattened to extract specific parameters.
- **"user_properties"**: Stores user attributes in nested JSON format; may contain information about uninstallation.
- **"platform"**: Could be used to filter events based on the operating system or device type.

Conditions that may be used:

- **Filter by "event_date"**: Select events that occurred in August and September 2018 (`"event_date"` between '20180801' and '20180930').
- **Filter by "event_name"**: Select events where `"event_name"` is 'app_install' or 'app_uninstall'.
- **Calculate time differences**: Use `"event_timestamp"` and `"user_first_touch_timestamp"` to determine the duration between installation and uninstallation.
- **Flatten nested JSON fields**: Use `LATERAL FLATTEN` to extract specific values from `"event_params"` or `"user_properties"`.
- **Filter by "user_pseudo_id"**: Group or filter events based on users to track their activity over time.

Here are 10 different SQL queries to explore the data and understand values in related columns:

1. **Select distinct event names to identify all types of events:**

   ```sql
   SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
   LIMIT 100;
   ```

2. **List user IDs and their first touch timestamps for August 2018 installations:**

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
   WHERE "event_date" BETWEEN '20180801' AND '20180831'
   LIMIT 100;
   ```

3. **Retrieve installation events during August and September 2018:**

   ```sql
   SELECT "user_pseudo_id", "event_name", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
   WHERE "event_name" = 'app_install' AND "event_date" BETWEEN '20180801' AND '20180930'
   LIMIT 100;
   ```

4. **Retrieve uninstallation events during August and September 2018:**

   ```sql
   SELECT "user_pseudo_id", "event_name", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
   WHERE "event_name" = 'app_uninstall' AND "event_date" BETWEEN '20180801' AND '20180930'
   LIMIT 100;
   ```

5. **Extract values from "event_params" to explore parameters associated with events:**

   ```sql
   SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

6. **List distinct users who installed the app in August 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
   WHERE "event_name" = 'app_install' AND "event_date" BETWEEN '20180801' AND '20180831'
   LIMIT 100;
   ```

7. **List distinct users who uninstalled the app in September 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
   WHERE "event_name" = 'app_uninstall' AND "event_date" BETWEEN '20180901' AND '20180930'
   LIMIT 100;
   ```

8. **Select event dates and names for a specific user to trace their activity:**

   ```sql
   SELECT "event_date", "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
   WHERE "user_pseudo_id" = 'user_12345'
   LIMIT 100;
   ```

9. **Count the number of events per user during August and September 2018:**

   ```sql
   SELECT "user_pseudo_id", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
   WHERE "event_date" BETWEEN '20180801' AND '20180930'
   GROUP BY "user_pseudo_id"
   LIMIT 100;
   ```

10. **Extract user properties to check for attributes related to uninstallation:**

    ```sql
    SELECT f.value
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920" t,
    LATERAL FLATTEN(input => t."user_properties") f
    LIMIT 100;
    ```

These queries help in understanding the values in related columns and provide insights into:

- The types of events recorded in the data.
- The users who installed and uninstalled the app during the specified period.
- The relationships between different events and user activities.
- The structure and content of nested JSON fields like `"event_params"` and `"user_properties"`.

By analyzing the results of these queries, you can gather the necessary information to calculate the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018.

(Note: Adjust the table names (e.g., `"EVENTS_20180801"`) and conditions as needed to cover all relevant dates in August and September 2018.)

---

**Explanation:**

- **Queries 1 & 2**: Help identify the different event types and user installations during the target period.
- **Queries 3 & 4**: Focus on retrieving installation and uninstallation events to find users who installed or uninstalled the app.
- **Queries 5 & 10**: Explore nested JSON columns to understand additional event parameters and user properties that might affect uninstallation.
- **Queries 6 & 7**: List distinct users for installations and uninstallations to determine user counts.
- **Query 8**: Provides a user's activity timeline for detailed analysis.
- **Query 9**: Counts events per user to identify engagement levels.

By combining insights from these queries, you can determine the total number of users who installed the app during August and September 2018, identify those who uninstalled within seven days, and calculate the required percentage.Query:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
   LIMIT 100;
Answer:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open
Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
   WHERE "event_date" BETWEEN '20180801' AND '20180831'
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
7153341A14B1253A46FD8D6DE5490EE4,1518103722890000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
E069FDF17198500FCB6DDDF406ABA122,1532285830420000
475BF363AECBE3A08102A769174D278F,1529461048713000
475BF363AECBE3A08102A769174D278F,1529461048713000
475BF363AECBE3A08102A769174D278F,1529461048713000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5E441969283C94713E308A11D,1533760955966000
D0E006B5
Query:
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
WHERE "event_name" IN ('first_open', 'app_remove')
LIMIT 100;
Answer:
user_pseudo_id,event_name,event_timestamp
F27F046DF960AB50CE65B9F4364C981E,app_remove,1534320357679014
0CA01A88046296B06E72B5E945A95732,app_remove,1534361274773000
0CE0108DD168AC70E11C9DD96C122956,app_remove,1534341750149000
9D535D543FD07B8247DEADB4669FADE6,app_remove,1534334244423000
62440E2EC0A24E9FB2CF09E230FFDEC4,app_remove,1534366142788000
5346C62F49BF2E6C1199456F16604B3C,app_remove,1534373536131000
E806F12D29E9F873BE6EAA01CD1E1B4F,app_remove,1534342478172000
0597C8E39ECFBDFB2C6289471B52B974,app_remove,1534358635605000
D49B24FA9F7D4D482074FCE5E0469C55,app_remove,1534328491032000
310D44D95961BF9754C9948AF6F437EA,app_remove,1534323863109000
B2F661E88136265632545A030F09A88A,app_remove,1534352912485000
DE7350AD7068B30F98279BBD65AEF609,app_remove,1534345252488000
DAB972641CDD57B498702CA343A4ABCF,app_remove,1534344719287000
2B38130AF309DC84605BF6658EC03470,app_remove,1534371885800000
8BC72D1925A8866050D5A6FB01148518,app_remove,1534344472289000
80B7E9D1DF9155BA2277817B7F1E06AE,app_remove,1534387428443000
15C047FB330537BE72C8B690117BC25A,app_remove,1534327418105000
BC4975868D38E7BA0AC93C69B4FE6FF5,app_remove,1534334430982429
835765A97BEE13977198CB622AB23A8E,app_remove,1534341773716000
005F127942F3FD25588272950FDFD339,app_remove,1534326738450000
0545C2BABDB15C6A952ECEA222E8F5E6,first_open,1534385001696000
96B108514A10609B9E8F4F78B47B6776,first_open,1534364313386000
7F8E0A83EA3833F063DA2107E073AC03,first_open,1534351821439000
B234DE95E7BA43F7D422B2A2ED211629,first_open,1534372312457000
51E3AEBCB31617B0A5EC1A48877E9A70,first_open,1534390469545000
F475A23EE0B80DC59250CBB1C35AFB3E,first_open,1534361592926000
AEEFEB2B840AB521A60BDFB354D06F32,first_open,1534317334718000
62440E2EC0A24E9FB2CF09E230FFDEC4,first_open,1534366108062000
A1377ED195838AEBC979C6884647383F,first_open,1534319298387000
80B7E9D1DF9155BA2277817B7F1E06AE,first_open,1534387401660000
F7164A70962E5AED09AD0CEB0A3C7C82,first_open,1534390727580000
BFF00C0BEDC08F406D999413584797D5,first_open,1534390382577000
7E48E529DD8F36846B02F6ACE460236F,first_open,1534396103025000
14DE6B1CDA3BFD44679C7E9382644AC7,first_open,1534371104465000
D85672E8322401603F6706560AAFACA7,first_open,1534359769094000
7EA86ADA1763724469F41BFE017D43C4,app_remove,1534360359238000
E9E777B58E17AE5695695BD3B68B255F,first_open,1534360360688000
1C9927831BAA7A0569130EADD6320C69,first_open,1534365421765000
ED4C30231EFF6BA5660398B76E680FA8,first_open,1534381270405000
19B5E340A2D84666E5178E237F29A22B,first_open,1534359288922000
BC4975868D38E7BA0AC93C69B4FE6FF5,first_open,1534325111919000
7C2B51C7FD6A677AA1627FFCCA79CAA9,first_open,1534348230884000
10F23E6BC97C1373F4F972DB75A30F01,first_open,1534354146852000
49E983E1361F11F5205CDA4289B71003,first_open,1534366336654000
BC575A719C37E1C2237B79FE7FD3F7E1,first_open,1534332267576000
D4BE9C6F73E39CCE4ED1901AF98A9E3A,first_open,1534385444055000
814700C58B117F7ABFFB1145B9C29D29,first_open,1534381476043000
005F127942F3FD25588272950FDFD339,first_open,1534326741323000
Query:
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
WHERE "event_name" = 'app_remove' AND "event_date" BETWEEN '20180801' AND '20180930'
LIMIT 100
Answer:
user_pseudo_id,event_name,event_timestamp
7705D52DD2286DC2E6DB831A2E129E94,app_remove,1536612574534044
E069FDF17198500FCB6DDDF406ABA122,app_remove,1536604953898000
2EF53F63407052EC94131725462F090E,app_remove,1536605164712000
663EAD1943AE7594E0633D10ADB5EF52,app_remove,1536606759225000
860EFF376090269DF25684D8769DF55F,app_remove,1536562882037000
E1A3C786B2E4D56629EE808A3A174995,app_remove,1536614421446000
E161A81E23235DDDF1C2B76E37A66EC5,app_remove,1536580493381000
B654CDDD4CC097495BF30819077AE75C,app_remove,1536638786229008
B108145758BBB6A7B69869E2E4EB9203,app_remove,1536575617429000
FD46EE61C22A10F97D29D527EDF7BC7D,app_remove,1536624041951000
8CED53DF2E18FAB2FCD5297C0CC860AB,app_remove,1536642234031000
C63E044972BC46A8840F4CCB3174690B,app_remove,1536590296636000
B5EE4A89792209060659C9A6719EA8A4,app_remove,1536623047415016
1E4AEC3626FA2D8DA2522810B11A0278,app_remove,1536571308770000
B3234CECCA15CEE80BDE39DA9D8AE687,app_remove,1536622843562000
Query:
SELECT f.value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 18
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 19
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455464
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455466
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455459
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455455
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -8227619652226455450
  }
}"
"{
  ""key"": ""board"",
  ""value"": {

Query:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
WHERE "event_name" = 'first_open' AND "event_date" BETWEEN '20180801' AND '20180831'
LIMIT 100
Answer:
user_pseudo_id
6FA9428194AD2E9D16720D405ED2DAB2
43251B4821FA3F7EF7A38628655ACB7D
CBC67C63B6826BABB6BC657E5E4382E5
D5544C064404DC6067412B1272F848D6
C1B1A57BFD7A3176CB7C587FF29653C6
57EC50FBC6C7277B8EDCCE44C1352BD4
4091F647A1B6367AC7945DA0917CDA7D
E846EDC289792A14A18D16A50F50DBCA
7954F970C93ED6F9AEF04CE25CE871CD
EE3C0D0F03E9B90D93E774EF0E4F8D4A
68F870FD9708D9569124B7882EA53641
747E6D4DF9C3C9FEC2151A72F696ACF9
4E6F4A73B5D05B33DC73B11547E39004
3B503D512D8D9A26C813B15CAA5A1BEF
92D613354268A0E592A3032CFE1D7987
3A540A2426891205362CA11B28D4D612
422E4B66736C74A880ACFF8895D1117F
670514A3825CACC6F6628AF24441AD0F
4678BE2C4434D27CCB2AAEEE76A5339E
9690B6E46BD58A8B118514973F0B57D0
4A74F895139C481B907A37EE5D25BA1B
FB629A58366521D55498F45606F8CA84
BB90E3EF80325C68D00E6BCEEBDCAA79
B2F661E88136265632545A030F09A88A
239B36D8ED2161D10687A09C0EF34477
E3DB69E48378F1EED6C064C7614AACAB
EF651AFA508A4888B92578704BFAC986
5646899D197E5F36BA6CE0E08456B026
6040FA99B7E38468A771643D0702322F
EC3BAA23738340386BBAD8114221E1D7
80E1D7AD1980A2D9B7A6A7BD4D939337
F6E6CCCB27C3FA47728DCA1C4AE72AC4
774364DD86012B5503A710C4BF612F92
CAAE5593CC002505DFF01CBF4C33B83A
C98E984527F5BF9F4F673530F184AF62
59D595A9B16ACFB6FA3E0BF068C17C32
57665A278A54980F95181A64E6D55E6A
A1959F7082D82015768E43409DC15E50
7A3A20ED131AB674321A955B40644B7A
F7D09AFD89AFEA294B430C83737224A8
4E68A26D72DE120819F9FA3AD7482EF4
A332BF6CC122D1CEE65358AF2CBBD567
83087EBE7E2001DD1918810489389A6D
56A069E37C273BE2092ADEB0D527D9B3
38D65030548914B5E167CE85B035CA8F
0C67D250019C3714C55CFCEB663544A4
E3EDDBED53EE3E42ECF55A5E091F56D8
19CBDFEE0542DE6749B6D1628021BB4F
DFF46496068299CA44163BEF38B7F89D
747C402883F8362C5126E1F17001589D
D459259A48556B4C4BA67DA52F665AC9
E68A264ADBA1C799CEC92C1B6D234E2A
33443052ABE335E361BACA959B64F9D4
82660A783170BC1C45EEAB3B713B6C5C
D00B400D2C00C34D76B3DA942BCF93C5
52FD02951B8655BDEDFEBC6BEDD1B311
A20E7E669E319B0A1912A187C4169AEE
19C8EAB201DA2CDDC1240ACD0E3D7441
45FB547C5857493104687C234EDCDE37
CE869BF6173A1F46388AC4B3F6FF4EFA
F3B0F2F150A1D91E15BB07FACD1EFC89
1BC92220D3CB5345F4E46D35D14D5FC8
F737990A8EE1F47ADA4A5200F9C38A97
918AB13390C2B040E4B0D5086EBF3349
Query:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
WHERE "event_name" = 'app_remove' AND "event_date" BETWEEN '20180901' AND '20180930'
LIMIT 100
Answer:
user_pseudo_id
87A089C253872EDE201776ABF0CE69CC
50B507B8C1BD14FA0BC9BE6991513DFE
9DB91A563FC210E7CB110408AB943DC5
57E7A689A86A94D750A4C68220DDD679
1EE74A9149F4AA2CC1E6DABD18BEFD3C
433E34F1BFEEF8A34A78D2C73D3AA014
6194417FC6F7937D8EE0DE82668B5453
4293BE87C4C4EE3249F6DCA7A27A866C
64E3BBB507EEFDE76364031EADF502F4
289D738E3B01C988983B957444571412
260F744C558B490AA7A98F05BB3E9E05
76B80AC19A11BEB87D87ED5D1A8642BA
34ADF71F1AADCA26EC8008496F7CC87E
415E757904443C53EE090E77B1F1EDA4
4E835B658FBCD64F19EB3F3C9FA601FA
77A9D856AEF74B96BDFBE805E66DB4A9
Query:
SELECT "event_date", "event_name"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
WHERE "user_pseudo_id" = '023A2DB99CC3F70A4B71869C36952D74'
LIMIT 100
Answer:
event_date,event_name
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_up
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,level_complete
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
20180812,screen_view
Query:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
WHERE "event_date" = '20180905'
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
user_pseudo_id,event_count
817C3E590030EB56A11A38D56919B6C5,24
9F7B0D1BFB822F5E26E91E184E2E437C,4
49E9C6C52FBDE2759897A72EB7C37165,3
B390E09582A6DEF9545267A37C78B809,45
023A2DB99CC3F70A4B71869C36952D74,37
2C8605D838AC52596D7B42B550C9E608,146
A7993B3D9E693DFD3EA57CF4D1B8D00F,18
A2616A0876190B8C349DE35A9AF631B9,123
2EF53F63407052EC94131725462F090E,125
A70504A67EE34DD45EF82BFF86E9F94D,11
B087A865A90AD52D1864A36482983BD2,139
72946F932EBBBFA6C72D662874D2E4D5,117
608CEA53C39E0A3EAB36C8E8B075F161,3
5ACF1A6BFE350F7BB661BF389AF7E2F0,32
B99FD965B0874192EE94E8A8FE85EA9E,10
8EB99B177B914F63CE215683892205AD,9
48AB910A8DE8485D4C34238EA61F782C,90
ECB676BED33FDF42E1B0DCF234E1344B,35
AC14799A5E8C340D6CADCBAE72037D81,20
E75EF199A45513454ECC834C545EAC75,21
32D665523EBBFFF2A492D8E043A4FB6B,1
4ABFD2281F974B00B844E8F97B2E6D38,17
02CA9DD43A7BE3472BB48D0B0F72D52A,17
192440EC48EB5C30C261D16F03D7D229,1
3DEB0C12C49AD19D7ACE68FA59E7ACD6,443
51B215871E81C64077434452838DE86A,33
920DB84FCC0F4421650B9E257E33180B,10
D5F9D9AF22EF5073E10342973D48FB2C,21
84AFEFA3875BA1F17232CB41D06B6EF4,37
B71CB5D517BE99FEEED64A0F57842032,47
59BE43F3FE7AB3F91B016B56508D4C46,21
3682C2527BEE6BA0255321BB25DF44BB,9
7A8D1CAA45CDE7652260DA6E71068A13,89
7439CA3E049F434742CB5C63A55FC24D,157
E80C958E3C33898989A30B8F5A4514F0,87
E9B6A8FE354E4EF0A8C883E51755CA12,230
336BDA268CA6379F6EE567B4C16A1090,4
E1A3C786B2E4D56629EE808A3A174995,27
DC16CFBE43A591C7D18D4BE0BBC2E6CE,35
959635567E419A061EECCCA478EDC718,1139
7AA6572327B5C45D273CCD8868760033,7
622E890EE63F0B83C532CC052BEE8A50,48
B4BF91F8CFA904E81999D0422214BDF8,53
871CEF665A392E49675F62AF04E61D76,297
932AAF56DDE9C55359B9CCFA18E7FB95,115
9F8D4A18FC571082BD1D7AA5597756AD,4
0CAAA1B6F161BA4D363EB7A2DEF64A08,25
A305B55D5049F38F5139DA95B3DCE247,123
74375465CD17299EBC7C75A1B4047EE0,292
B5395F8C2077B59B3D6C5719C0CA0339,237
782A9B1FA75F15FA0EFE0FE3819BB5D7,21
BE36C49B1AB3968D420923AEC4FDD7AE,51
1E9F6BA9BD8C45633C26F42995A77775,78
0F1BF0E64772D0D00359FD7A4997D067,1
77F125B832C748232EDA6AF8C7D08ED1,23
018F03084C88E944163F76A0D0C2FBA1,164
C677D4AC75F093F984D7881B299C8C12,15
AE158E6238A048413B91B5A50D08810D,98
55E9F64E0467628594A2DD0B8BDB9EFA,20
8AFAFD6D7E79149C91BCAE1995E0CF47,48
C3FCDF18C57A6F16E5EE6867CA6679E1,104
C6F1E972D68BE8C168E02404C3B272C7,60
DA48D36D07835B1918BDF831AF83B5EF,145
5BA23094CD864C7FB5265F83652FA028,17
7E74A2BB6BBF4746DEE15F957B315401,511
BE0B27C2C14F4BC2B33DAEF7505BAF54,6
186F51E5AACB37852E3650E7027E33B1,3
C9262E10BCACD67DADD85566E354FEFC,21
0A26E7281EC31038AD42F28C930FFF90,44
459FD97ABE14D7762CD58C3A3104D183,158
CF092C279C3407DD69A44008D7511A2E,8
01B358175084B5B44F1C83C2A42FE33A,4
F0186BDA8E7BF76675999CFDCFB10F6B,29
904877128B8889DDD71A38BDBCD21724,458
39747754B0805753690EFF8D9711AB0C,158
037DAC225F0C1E54657770CD201CDDA7,11
09A826527E24EFA70A0B7A8BDCD38962,3
59454BAC415BB1F18517C6FD2C023E49,21
78CA698EA887F6421432DC107CD539B4,2
AD540E549BA77A71A7459EEAF2F8D3BC,36
9A10BF8F0166076BD918A5027396A46B,298
3D03A380687FE3369E93915D50C572CB,41
45EC7F973F9C0FE50CBCC7B05D88B39C,15
97380FCE77BAB6B251B50DDE4ABD8F8A,44
B27F6463047977351E76AEED8456E9FF,135
A1A9A8FC9138E7F9B568176AA7091F2D,42
E7F45BD93A980C6443443893DCDC0048,104
3DA885537C8B031959908EC7E8F27C9A,66
11FC272840E1ED3923F92C521AC68F1E,91
E063775534D380684BCA33B63B11B213,23
B175B187062693360BCBADC4160F8D88,155
6423FBDB63333D5EF6E628446EDE5635,36
D4DDA67EF184AFBC5E2D52FBDEDD7837,19
EB1A430BACB37E6EA72592BF838E64A6,196
466C7664CCCF329A8D39176840B3EB02,3
10B0D468B5E036E16D13DB53A65F2D49,562
CBC0686061C729A9C9181A919C4C5F9F,18
BED8A5D6788A8D8744F4656392DD2D7B,148
44CB977CB944DE7FD71943CE9A304F9E,52
28FC1BD0204945ED4B1B15E3A139347C,691
Query:
SELECT f.value
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920" t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572811016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707299946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445854869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640162766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572838902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787088340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572809736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572811016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572818016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707306946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445861869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640169766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572845902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787095340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572816736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572818016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572775016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707263946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445818869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640126766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572802902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787052340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572773736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572775016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572807016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707295946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445850869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640158766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572834902000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1528787084340000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1482572812736000,
    ""set_timestamp_micros"": 1482572805736000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482572807016000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1482572813016000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1482707301946000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1537445856869000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524640164766000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1482572840902000,
    "
End Exploring Related Columns
Task: Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we analyzed the installation and uninstallation data for that period. The result is as follows:

```csv
Percentage_of_users
value:0<=float<=100
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 04:52:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 04:52:44 - root - INFO - To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we analyzed the installation and uninstallation data for that period. The result is as follows:

```sql
WITH events AS (
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181003"
),

install_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "install_timestamp"
  FROM events
  WHERE "event_name" = 'first_open'
    AND "event_date" BETWEEN '20180801' AND '20180930'
  GROUP BY "user_pseudo_id"
),

uninstall_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "uninstall_timestamp"
  FROM events
  WHERE "event_name" = 'app_remove'
  GROUP BY "user_pseudo_id"
),

joined_events AS (
  SELECT i."user_pseudo_id",
         i."install_timestamp",
         u."uninstall_timestamp",
         DATEDIFF('day', TO_TIMESTAMP(i."install_timestamp" / 1000000), TO_TIMESTAMP(u."uninstall_timestamp" / 1000000)) AS days_until_uninstall
  FROM install_events i
  LEFT JOIN uninstall_events u
    ON i."user_pseudo_id" = u."user_pseudo_id"
      AND u."uninstall_timestamp" >= i."install_timestamp"
)

SELECT ROUND(
  (COUNT(CASE WHEN (days_until_uninstall > 7 OR days_until_uninstall IS NULL) THEN 1 END)
  / COUNT(*)) * 100.0, 4) AS "Percentage_of_users"
FROM joined_events;
```
2025-01-23 04:52:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:52:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:52:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:52:46 - snowflake.connector.connection - INFO - closed
2025-01-23 04:52:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:52:46 - root - INFO - itercount: 1
2025-01-23 04:52:46 - root - INFO - 001789 (42601): 01b9e584-0004-7ed2-0001-11c300f59baa: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 28
2025-01-23 04:52:46 - root - INFO - Input sql:
WITH events AS (
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
  UNION ALL
  SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181003"
),

install_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "install_timestamp"
  FROM events
  WHERE "event_name" = 'first_open'
    AND "event_date" BETWEEN '20180801' AND '20180930'
  GROUP BY "user_pseudo_id"
),

uninstall_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "uninstall_timestamp"
  FROM events
  WHERE "event_name" = 'app_remove'
  GROUP BY "user_pseudo_id"
),

joined_events AS (
  SELECT i."user_pseudo_id",
         i."install_timestamp",
         u."uninstall_timestamp",
         DATEDIFF('day', TO_TIMESTAMP(i."install_timestamp" / 1000000), TO_TIMESTAMP(u."uninstall_timestamp" / 1000000)) AS days_until_uninstall
  FROM install_events i
  LEFT JOIN uninstall_events u
    ON i."user_pseudo_id" = u."user_pseudo_id"
      AND u."uninstall_timestamp" >= i."install_timestamp"
)

SELECT ROUND(
  (COUNT(CASE WHEN (days_until_uninstall > 7 OR days_until_uninstall IS NULL) THEN 1 END)
  / COUNT(*)) * 100.0, 4) AS "Percentage_of_users"
FROM joined_events;
The error information is:
001789 (42601): 01b9e584-0004-7ed2-0001-11c300f59baa: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 28
Please correct it and output only 1 complete SQL query.
2025-01-23 04:53:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 04:53:56 - root - INFO - ```sql
WITH events AS (
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
),

install_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "install_timestamp"
  FROM events
  WHERE "event_name" = 'first_open'
    AND "event_date" BETWEEN '20180801' AND '20180930'
  GROUP BY "user_pseudo_id"
),

uninstall_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "uninstall_timestamp"
  FROM events
  WHERE "event_name" = 'app_remove'
  GROUP BY "user_pseudo_id"
),

joined_events AS (
  SELECT i."user_pseudo_id",
         i."install_timestamp",
         u."uninstall_timestamp",
         DATEDIFF('day', TO_TIMESTAMP(i."install_timestamp" / 1000000), TO_TIMESTAMP(u."uninstall_timestamp" / 1000000)) AS days_until_uninstall
  FROM install_events i
  LEFT JOIN uninstall_events u
    ON i."user_pseudo_id" = u."user_pseudo_id"
      AND u."uninstall_timestamp" >= i."install_timestamp"
)

SELECT ROUND(
  (COUNT(CASE WHEN (days_until_uninstall > 7 OR days_until_uninstall IS NULL) THEN 1 END)
  / COUNT(*)) * 100.0, 4) AS "Percentage_of_users"
FROM joined_events;
```
2025-01-23 04:53:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:53:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:53:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:53:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 04:53:58 - snowflake.connector.connection - INFO - closed
2025-01-23 04:53:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:53:59 - root - INFO - itercount: 2
2025-01-23 04:53:59 - root - INFO - 0
2025-01-23 04:53:59 - root - INFO - results: 
Percentage_of_users
78.1756


2025-01-23 04:53:59 - root - INFO - Please check the answer again by reviewing Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we analyzed the installation and uninstallation data for that period. The result is as follows:

```csv
Percentage_of_users
value:0<=float<=100
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users
78.1756
Current sql:
WITH events AS (
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
),

install_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "install_timestamp"
  FROM events
  WHERE "event_name" = 'first_open'
    AND "event_date" BETWEEN '20180801' AND '20180930'
  GROUP BY "user_pseudo_id"
),

uninstall_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "uninstall_timestamp"
  FROM events
  WHERE "event_name" = 'app_remove'
  GROUP BY "user_pseudo_id"
),

joined_events AS (
  SELECT i."user_pseudo_id",
         i."install_timestamp",
         u."uninstall_timestamp",
         DATEDIFF('day', TO_TIMESTAMP(i."install_timestamp" / 1000000), TO_TIMESTAMP(u."uninstall_timestamp" / 1000000)) AS days_until_uninstall
  FROM install_events i
  LEFT JOIN uninstall_events u
    ON i."user_pseudo_id" = u."user_pseudo_id"
      AND u."uninstall_timestamp" >= i."install_timestamp"
)

SELECT ROUND(
  (COUNT(CASE WHEN (days_until_uninstall > 7 OR days_until_uninstall IS NULL) THEN 1 END)
  / COUNT(*)) * 100.0, 4) AS "Percentage_of_users"
FROM joined_events;
2025-01-23 04:54:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 04:54:50 - root - INFO - To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we analyzed the installation and uninstallation data for that period. The result is as follows:

```csv
Percentage_of_users
78.1756
```

The SQL query used to obtain this result is:

```sql
WITH events AS (
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL
  SELECT "user_pseudo_id", "event_timestamp", "event_date", "event_name"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
),

install_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "install_timestamp"
  FROM events
  WHERE "event_name" = 'first_open'
    AND "event_date" BETWEEN '20180801' AND '20180930'
  GROUP BY "user_pseudo_id"
),

uninstall_events AS (
  SELECT "user_pseudo_id", MIN("event_timestamp") AS "uninstall_timestamp"
  FROM events
  WHERE "event_name" = 'app_remove'
  GROUP BY "user_pseudo_id"
),

joined_events AS (
  SELECT i."user_pseudo_id",
         i."install_timestamp",
         u."uninstall_timestamp",
         DATEDIFF(
           'day',
           TO_TIMESTAMP_NTZ(i."install_timestamp" / 1000000),
           TO_TIMESTAMP_NTZ(u."uninstall_timestamp" / 1000000)
         ) AS days_until_uninstall
  FROM install_events i
  LEFT JOIN uninstall_events u
    ON i."user_pseudo_id" = u."user_pseudo_id"
      AND u."uninstall_timestamp" >= i."install_timestamp"
)

SELECT ROUND(
  (COUNT(CASE WHEN (days_until_uninstall > 7 OR days_until_uninstall IS NULL) THEN 1 END)
  / COUNT(*)) * 100.0, 4) AS "Percentage_of_users"
FROM joined_events;
```
2025-01-23 04:54:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 04:54:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 04:54:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 04:54:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 04:54:56 - snowflake.connector.connection - INFO - closed
2025-01-23 04:54:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 04:54:56 - root - INFO - itercount: 3
2025-01-23 04:54:56 - root - INFO - 0
2025-01-23 04:54:56 - root - INFO - Total iteration counts: 3
