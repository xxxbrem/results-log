SELECT COUNT(DISTINCT u7."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active in the last 7 days (January 1 to January 7, 2021)
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210101"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210102"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210103"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210104"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210105"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210106"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210107"
    ) AS last7days_users
) AS u7
LEFT JOIN (
    -- Users active in the last 2 days (January 6 and January 7, 2021)
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210106"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210107"
    ) AS last2days_users
) AS u2
ON u7."USER_PSEUDO_ID" = u2."USER_PSEUDO_ID"
WHERE u2."USER_PSEUDO_ID" IS NULL;