WITH last7days AS (
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210101"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210102"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210103"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210104"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210105"
    )
),
last2days AS (
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210106"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210107"
    )
)
SELECT COUNT(*) AS "Number_of_Pseudo_Users"
FROM last7days l7
LEFT JOIN last2days l2 ON l7."USER_PSEUDO_ID" = l2."USER_PSEUDO_ID"
WHERE l2."USER_PSEUDO_ID" IS NULL;