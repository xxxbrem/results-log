2025-01-20 15:07:32 - openai._base_client - INFO - Retrying request to /chat/completions in 0.447391 seconds
2025-01-20 15:08:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:08:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:08:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:08:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:08:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-01-20 15:08:20 - snowflake.connector.connection - INFO - closed
2025-01-20 15:08:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:08:21 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   LIMIT 1000;
Results:
event_name
first_open
app_update
app_exception
level_retry_quickplay
level_fail
error
level_complete
level_up
level_reset
completed_5_levels
spend_virtual_currency
no_more_extra_steps
ad_reward
firebase_campaign
app_remove
challenge_a_friend
post_score
level_retry
level_start
screen_view
select_content
user_engagement
level_end_quickplay
level_reset_quickplay
level_start_quickplay
level_complete_quickplay
os_update
use_extra_steps
level_end
session_start
level_fail_quickplay

2025-01-20 15:08:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:08:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:08:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:08:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 15:08:22 - snowflake.connector.connection - INFO - closed
2025-01-20 15:08:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:08:22 - root - INFO - SQL:
SELECT "event_date", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_date" = '20180915'
   LIMIT 1000;
Results:
Too long, hard cut:
event_date,event_name
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_exception
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,os_update
20180915,app_update
20180915,os_update
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_fail
20180915,error
20180915,error
20180915,error
20180915,error
20180915,error
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_reset
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_reset
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_reset
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_fail
20180915,level_complete
20180915,level_up
20180915,error
20180915,error
20180915,error
20180915,error
20180915,level_retry_quickplay
20180915,app_exception
20180915,app_update
20180915,os_update
20180915,level_retry_quickplay
20180915,use_extra_steps
20180915,spend_virtual_currency
20180915,app_update
20180915,app_update
20180915,os_update
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,app_exception
20180915,app_exception
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,os_update
20180915,error
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,app_update
20180915,use_extra_steps
20180915,no_more_extra_steps
20180915,spend_virtual_currency
20180915,ad_reward
20180915,app_exception
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_fail
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_fail
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,app_update
20180915,os_update
20180915,use_extra_steps
20180915,level_retry_quickplay
20180915,spend_virtual_currency
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_retry_quickplay
20180915,error
20180915,app_exception
20180915,level_complete
20180915,level_up
20180915,error
20180915,error
20180915,level_retry_quickplay


2025-01-20 15:08:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:08:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:08:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:08:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 15:08:24 - snowflake.connector.connection - INFO - closed
2025-01-20 15:08:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:08:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:08:55 - root - INFO - ```sql
WITH "event_params_flat" AS (
  SELECT
    t."event_timestamp",
    t."event_name",
    f.value::VARIANT:"key"::STRING AS "key",
    f.value::VARIANT:"value"::VARIANT AS "value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
)
SELECT
  board_type."value"::STRING AS "board_type",
  AVG(score."value"::FLOAT) AS "average_score"
FROM
  "event_params_flat" AS board_type
  JOIN "event_params_flat" AS score
    ON board_type."event_timestamp" = score."event_timestamp"
    AND board_type."event_name" = score."event_name"
WHERE
  board_type."key" = 'board_type'
  AND score."key" = 'score'
GROUP BY
  board_type."value"::STRING
LIMIT 1000;
```
2025-01-20 15:08:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:08:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:08:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:08:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 15:08:57 - snowflake.connector.connection - INFO - closed
2025-01-20 15:08:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:09:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:09:54 - root - INFO - ```sql
WITH event_params_flat AS (
  SELECT
    t."event_timestamp",
    t."event_name",
    f.value::VARIANT:"key"::STRING AS "key",
    f.value::VARIANT:"value"::VARIANT AS "value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
)
SELECT
  board_type."value"::STRING AS "board_type",
  AVG(score."value"::FLOAT) AS "average_score"
FROM
  event_params_flat AS board_type
  INNER JOIN event_params_flat AS score
    ON board_type."event_timestamp" = score."event_timestamp"
    AND board_type."event_name" = score."event_name"
WHERE
  board_type."key" = 'board_type'
  AND score."key" = 'score'
GROUP BY
  board_type."value"::STRING
LIMIT 1000;
```
2025-01-20 15:09:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:09:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:09:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:09:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 15:09:56 - snowflake.connector.connection - INFO - closed
2025-01-20 15:09:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:10:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:10:28 - root - INFO - ```sql
SELECT
  t."event_name",
  f.value::VARIANT:"key"::STRING AS "key",
  f.value::VARIANT:"value"::STRING AS "value"
FROM
  FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
  LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```
2025-01-20 15:10:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:10:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:10:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:10:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 15:10:30 - snowflake.connector.connection - INFO - closed
2025-01-20 15:10:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:11:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:11:20 - root - INFO - SQL:
SELECT
  t."event_name",
  f.value::VARIANT:"key"::STRING AS "key",
  f.value::VARIANT:"value"::STRING AS "value"
FROM
  FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
  LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Results:
Too long, hard cut:
event_name,key,value
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
app_update,firebase_screen_id,"{""int_value"":5640021151996172547}"
app_update,previous_app_version,"{""string_value"":""2.2.5""}"
app_update,firebase_screen_class,"{""string_value"":""main_menu""}"
app_update,firebase_event_origin,"{""string_value"":""auto""}"
os_update,previous_os_version,"{""string_value"":""9.3.2""}"
os_update,firebase_screen_id,"{""int_value"":5640021151996172547}"
os_update,firebase_screen_class,"{""string_value"":""main_menu""}"
os_update,firebase_event_origin,"{""string_value"":""auto""}"
first_open,firebase_screen_id,"{""int_value"":5640021151996172545}"
first_open,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
first_open,update_with_analytics,"{""int_value"":1}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":1}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,firebase_screen_id,"{""int_value"":6713771638975339060}"
first_open,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
first_open,update_with_analytics,"{""int_value"":1}"
first_open,previous_first_open_count,"{""int_value"":2}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
app_update,firebase_screen_id

2025-01-20 15:11:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:11:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:11:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:11:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 15:11:22 - snowflake.connector.connection - INFO - closed
2025-01-20 15:11:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:11:22 - root - INFO - SQL:
SELECT "user_id", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_name" = 'level_complete_quickplay'
   LIMIT 1000
Results:
Too long, hard cut:
user_id,event_name
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete

2025-01-20 15:11:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:11:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:11:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:11:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 239
2025-01-20 15:11:24 - snowflake.connector.connection - INFO - closed
2025-01-20 15:11:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:11:25 - root - INFO - SQL:
SELECT t."event_params"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t
   WHERE t."event_name" = 'level_complete_quickplay'
   LIMIT 1000
Results:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 19
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 7521325268372734470
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -2591581918779773063
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 4067270961625782754
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -7769943645087595865
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -7358516765759958541
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 19
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -2730134379371087689
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8913050640993562618
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 1063389985999301656
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 34
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -5546306245961433308
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 36
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 896687594504409882
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""M""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 28
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
 

2025-01-20 15:11:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:11:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:11:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:11:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 15:11:26 - snowflake.connector.connection - INFO - closed
2025-01-20 15:11:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:11:27 - root - INFO - SQL:
SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'level_complete_quickplay'
   LIMIT 1000
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 19
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 7521325268372734470
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -2591581918779773063
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 4067270961625782754
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -7769943645087595865
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -7358516765759958541
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 19
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -2730134379371087689
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8913050640993562618
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 1063389985999301656
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""L""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 34
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -5546306245961433308
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""L""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 36
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 896687594504409882
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""M""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 28
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8117298942848971437
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""M""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 30
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"

2025-01-20 15:11:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:11:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:11:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:11:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 15:11:28 - snowflake.connector.connection - INFO - closed
2025-01-20 15:11:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:11:28 - root - INFO - SQL:
SELECT
     f.value:"key"::STRING AS "param_key",
     f.value:"value"::VARIANT AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'level_complete_quickplay'
   LIMIT 1000
Results:
Too long, hard cut:
param_key,param_value
value,"{
  ""int_value"": 19
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 7521325268372734470
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -2591581918779773063
}"
board,"{
  ""string_value"": ""S""
}"
firebase_screen_id,"{
  ""int_value"": 4067270961625782754
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -7769943645087595865
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app""
}"
firebase_screen_id,"{
  ""int_value"": -7358516765759958541
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 19
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app""
}"
firebase_screen_id,"{
  ""int_value"": -2730134379371087689
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8913050640993562618
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1063389985999301656
}"
board,"{
  ""string_value"": ""L""
}"
value,"{
  ""int_value"": 34
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -5546306245961433308
}"
board,"{
  ""string_value"": ""L""
}"
value,"{
  ""int_value"": 36
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 896687594504409882
}"
board,"{
  ""string_value"": ""M""
}"
value,"{
  ""int_value"": 28
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8117298942848971437
}"
board,"{
  ""string_value"": ""M""
}"
value,"{
  ""int_value"": 30
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 4217125534225938865
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 20
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 586322440749441861
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 20
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 586322440749441861
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 20
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 586322440749441861
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_e

2025-01-20 15:11:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:11:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:11:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:11:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 15:11:30 - snowflake.connector.connection - INFO - closed
2025-01-20 15:11:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:12:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:12:02 - root - INFO - ```sql
WITH params AS (
  SELECT
    t."event_timestamp",
    MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value" END) AS "board_value",
    MAX(CASE WHEN f.value:"key"::STRING = 'value' THEN f.value:"value" END) AS "score_value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
  GROUP BY
    t."event_timestamp"
)
SELECT
  params."board_value":"string_value"::STRING AS "board_type",
  AVG(params."score_value":"int_value"::FLOAT) AS "average_score"
FROM params
GROUP BY params."board_value":"string_value"
LIMIT 1000;
```
2025-01-20 15:12:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:12:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:12:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:12:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 15:12:03 - snowflake.connector.connection - INFO - closed
2025-01-20 15:12:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:12:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:12:25 - root - INFO - SQL:
WITH params AS (
  SELECT
    t."event_timestamp",
    MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value" END) AS "board_value",
    MAX(CASE WHEN f.value:"key"::STRING = 'value' THEN f.value:"value" END) AS "score_value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
  GROUP BY
    t."event_timestamp"
)
SELECT
  params."board_value":"string_value"::STRING AS "board_type",
  AVG(params."score_value":"int_value"::FLOAT) AS "average_score"
FROM params
GROUP BY params."board_value":"string_value"
LIMIT 1000;
Results:
board_type,average_score
S,20.471182412358882
M,28.181818181818183
L,34.16923076923077

2025-01-20 15:12:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:12:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:12:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:12:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 15:12:27 - snowflake.connector.connection - INFO - closed
2025-01-20 15:12:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:12:27 - root - INFO - SQL:
SELECT
     f.value:"key"::STRING AS "param_key",
     f.value:"value"::VARIANT AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'level_complete_quickplay'
     AND f.value:"key"::STRING = 'board'
   LIMIT 1000
Results:
Too long, hard cut:
param_key,param_value
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""L""
}"
board,"{
  ""string_value"": ""L""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"


2025-01-20 15:12:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:12:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:12:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:12:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 15:12:28 - snowflake.connector.connection - INFO - closed
2025-01-20 15:12:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:12:29 - root - INFO - SQL:
SELECT DISTINCT "platform"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   LIMIT 1000
Results:
platform
ANDROID
IOS

2025-01-20 15:12:29 - root - INFO - itercount: 0
2025-01-20 15:12:29 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
Sure, let's consider the relevant columns and their potential usage:

- **"event_date"**: Used to filter events that occurred on September 15, 2018.
- **"event_name"**: Used to identify quick play mode completions.
- **"event_params"**: Contains nested JSON data; can extract "score" and "board_type" parameters.
- **"user_id"**: Might be useful to identify unique users.
- **"platform"**: Could be used to analyze data by platform.

**Conditions that may be used**:

- **"event_date" = '20180915'**: To select events from September 15, 2018.
- **"event_name" = 'quick_play_completed'**: To filter for quick play mode completions.

Here are 10 simple, short, non-nested SQL queries to explore the data:

1. Retrieve distinct event names to understand available event types:
   ```sql
   SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   LIMIT 1000;
   ```

2. List events that occurred on September 15, 2018:
   ```sql
   SELECT "event_date", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_date" = '20180915'
   LIMIT 1000;
   ```

3. Get timestamps for quick play completions:
   ```sql
   SELECT "event_timestamp", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_name" = 'quick_play_completed'
   LIMIT 1000;
   ```

4. Extract user IDs associated with quick play completions:
   ```sql
   SELECT "user_id", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_name" = 'quick_play_completed'
   LIMIT 1000;
   ```

5. View raw event parameters for further analysis:
   ```sql
   SELECT t."event_params"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t
   LIMIT 1000;
   ```

6. Flatten "event_params" to inspect nested values:
   ```sql
   SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 1000;
   ```

7. Extract keys and values from "event_params":
   ```sql
   SELECT f.value::VARIANT:"key"::STRING AS "param_key",
          f.value::VARIANT:"value"::STRING AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 1000;
   ```

8. Retrieve scores from event parameters:
   ```sql
   SELECT f.value::VARIANT:"key"::STRING AS "param_key",
          f.value::VARIANT:"value"::STRING AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE f.value::VARIANT:"key"::STRING = 'score'
   LIMIT 1000;
   ```

9. Retrieve board types from event parameters:
   ```sql
   SELECT f.value::VARIANT:"key"::STRING AS "param_key",
          f.value::VARIANT:"value"::STRING AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE f.value::VARIANT:"key"::STRING = 'board_type'
   LIMIT 1000;
   ```

10. List distinct platforms to see if platform analysis is needed:
    ```sql
    SELECT DISTINCT "platform"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
    LIMIT 1000;
    ```

These queries will help in understanding the data structure and extracting necessary information to calculate the average scores for each board type from quick play mode completions on September 15, 2018.Query:
SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   LIMIT 1000;
Answer:
event_name
first_open
app_update
app_exception
level_retry_quickplay
level_fail
error
level_complete
level_up
level_reset
completed_5_levels
spend_virtual_currency
no_more_extra_steps
ad_reward
firebase_campaign
app_remove
challenge_a_friend
post_score
level_retry
level_start
screen_view
select_content
user_engagement
level_end_quickplay
level_reset_quickplay
level_start_quickplay
level_complete_quickplay
os_update
use_extra_steps
level_end
session_start
level_fail_quickplay
Query:
SELECT "event_date", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_date" = '20180915'
   LIMIT 1000;
Answer:
Too long, hard cut:
event_date,event_name
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_exception
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,os_update
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,first_open
20180915,app_update
20180915,os_update
20180915,first_open
20180915,first_open
20180915,os_update
20180915,app_update
20180915,os_update
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_fail
20180915,error
20180915,error
20180915,error
20180915,error
20180915,error
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_reset
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_reset
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_reset
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_fail
20180915,level_complete
20180915,level_up
20180915,error
20180915,error
20180915,error
20180915,error
20180915,level_retry_quickplay
20180915,app_exception
20180915,app_update
20180915,os_update
20180915,level_retry_quickplay
20180915,use_extra_steps
20180915,spend_virtual_currency
20180915,app_update
20180915,app_update
20180915,os_update
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,app_exception
20180915,app_exception
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,os_update
20180915,error
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,level_retry_quickplay
20180915,app_update
20180915,use_extra_steps
20180915,no_more_extra_steps
20180915,spend_virtual_currency
20180915,ad_reward
20180915,app_exception
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_fail
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_fail
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,app_update
20180915,os_update
20180915,use_extra_steps
20180915,level_retry_quickplay
20180915,spend_virtual_currency
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,level_up
20180915,level_complete
20180915,completed_5_levels
20180915,level_up
20180915,level_retry_quickplay
20180915,error
20180915,app_exception
20180915,level_complete
20180915,level_up
20180915,error
20180915,error
20180915,level_retry_quickplay

Query:
SELECT
  t."event_name",
  f.value::VARIANT:"key"::STRING AS "key",
  f.value::VARIANT:"value"::STRING AS "value"
FROM
  FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
  LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Answer:
Too long, hard cut:
event_name,key,value
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
app_update,firebase_screen_id,"{""int_value"":5640021151996172547}"
app_update,previous_app_version,"{""string_value"":""2.2.5""}"
app_update,firebase_screen_class,"{""string_value"":""main_menu""}"
app_update,firebase_event_origin,"{""string_value"":""auto""}"
os_update,previous_os_version,"{""string_value"":""9.3.2""}"
os_update,firebase_screen_id,"{""int_value"":5640021151996172547}"
os_update,firebase_screen_class,"{""string_value"":""main_menu""}"
os_update,firebase_event_origin,"{""string_value"":""auto""}"
first_open,firebase_screen_id,"{""int_value"":5640021151996172545}"
first_open,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
first_open,update_with_analytics,"{""int_value"":1}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":1}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,system_app,"{""int_value"":0}"
first_open,system_app_update,"{""int_value"":0}"
first_open,update_with_analytics,"{""int_value"":0}"
first_open,previous_first_open_count,"{""int_value"":0}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
first_open,firebase_screen_id,"{""int_value"":6713771638975339060}"
first_open,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
first_open,update_with_analytics,"{""int_value"":1}"
first_open,previous_first_open_count,"{""int_value"":2}"
first_open,firebase_conversion,"{""int_value"":1}"
first_open,firebase_event_origin,"{""string_value"":""auto""}"
app_update,firebase_screen_id
Query:
SELECT "user_id", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   WHERE "event_name" = 'level_complete_quickplay'
   LIMIT 1000
Answer:
Too long, hard cut:
user_id,event_name
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete_quickplay
,level_complete
Query:
SELECT t."event_params"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t
   WHERE t."event_name" = 'level_complete_quickplay'
   LIMIT 1000
Answer:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 19
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 7521325268372734470
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -2591581918779773063
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 4067270961625782754
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -7769943645087595865
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -7358516765759958541
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 19
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -2730134379371087689
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8913050640993562618
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 1063389985999301656
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 34
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -5546306245961433308
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 36
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 896687594504409882
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""M""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 28
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""FIRootViewController""
    }
  },
 
Query:
SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'level_complete_quickplay'
   LIMIT 1000
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 19
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 7521325268372734470
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -2591581918779773063
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 4067270961625782754
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -7769943645087595865
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -7358516765759958541
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 19
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -2730134379371087689
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8913050640993562618
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 1063389985999301656
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""L""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 34
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -5546306245961433308
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""L""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 36
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 896687594504409882
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""M""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 28
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8117298942848971437
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""M""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 30
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"
Query:
SELECT
     f.value:"key"::STRING AS "param_key",
     f.value:"value"::VARIANT AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'level_complete_quickplay'
   LIMIT 1000
Answer:
Too long, hard cut:
param_key,param_value
value,"{
  ""int_value"": 19
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 7521325268372734470
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -2591581918779773063
}"
board,"{
  ""string_value"": ""S""
}"
firebase_screen_id,"{
  ""int_value"": 4067270961625782754
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -7769943645087595865
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app""
}"
firebase_screen_id,"{
  ""int_value"": -7358516765759958541
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 19
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app""
}"
firebase_screen_id,"{
  ""int_value"": -2730134379371087689
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8913050640993562618
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1063389985999301656
}"
board,"{
  ""string_value"": ""L""
}"
value,"{
  ""int_value"": 34
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -5546306245961433308
}"
board,"{
  ""string_value"": ""L""
}"
value,"{
  ""int_value"": 36
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 896687594504409882
}"
board,"{
  ""string_value"": ""M""
}"
value,"{
  ""int_value"": 28
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8117298942848971437
}"
board,"{
  ""string_value"": ""M""
}"
value,"{
  ""int_value"": 30
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 4217125534225938865
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 21
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 1825334383851548795
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 20
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 586322440749441861
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 20
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 586322440749441861
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 20
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 586322440749441861
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_e
Query:
WITH params AS (
  SELECT
    t."event_timestamp",
    MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value" END) AS "board_value",
    MAX(CASE WHEN f.value:"key"::STRING = 'value' THEN f.value:"value" END) AS "score_value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
  GROUP BY
    t."event_timestamp"
)
SELECT
  params."board_value":"string_value"::STRING AS "board_type",
  AVG(params."score_value":"int_value"::FLOAT) AS "average_score"
FROM params
GROUP BY params."board_value":"string_value"
LIMIT 1000;
Answer:
board_type,average_score
S,20.471182412358882
M,28.181818181818183
L,34.16923076923077
Query:
SELECT
     f.value:"key"::STRING AS "param_key",
     f.value:"value"::VARIANT AS "param_value"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
        LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'level_complete_quickplay'
     AND f.value:"key"::STRING = 'board'
   LIMIT 1000
Answer:
Too long, hard cut:
param_key,param_value
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""L""
}"
board,"{
  ""string_value"": ""L""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""M""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"
board,"{
  ""string_value"": ""S""
}"

Query:
SELECT DISTINCT "platform"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
   LIMIT 1000
Answer:
platform
ANDROID
IOS
End Exploring Related Columns
Task: I'm trying to evaluate which board types were most effective on September 15, 2018. Can you find out the average scores for each board type from the quick play mode completions on that day?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: On September 15, 2018, the average scores for each board type from quick play mode completions are as follows:

```csv
Board_Type,Average_Score
board_type1:str,average_score1:float
board_type2:str,average_score2:float
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 15:12:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:12:55 - root - INFO - ```sql
WITH params AS (
  SELECT
    t."event_timestamp",
    MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value" END) AS "board_value",
    MAX(CASE WHEN f.value:"key"::STRING = 'value' THEN f.value:"value" END) AS "score_value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
  GROUP BY
    t."event_timestamp"
)
SELECT
  params."board_value":"string_value"::STRING AS "Board_Type",
  ROUND(AVG(params."score_value":"int_value"::FLOAT), 4) AS "Average_Score"
FROM params
WHERE params."board_value" IS NOT NULL AND params."score_value" IS NOT NULL
GROUP BY params."board_value":"string_value"
ORDER BY "Average_Score" DESC;
```
2025-01-20 15:12:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:12:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:12:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:12:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 15:12:56 - snowflake.connector.connection - INFO - closed
2025-01-20 15:12:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:12:56 - root - INFO - itercount: 1
2025-01-20 15:12:56 - root - INFO - 0
2025-01-20 15:12:56 - root - INFO - results: 
Board_Type,Average_Score
L,34.1692
M,28.1818
S,20.4712


2025-01-20 15:12:56 - root - INFO - Please check the answer again by reviewing I'm trying to evaluate which board types were most effective on September 15, 2018. Can you find out the average scores for each board type from the quick play mode completions on that day?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: On September 15, 2018, the average scores for each board type from quick play mode completions are as follows:

```csv
Board_Type,Average_Score
board_type1:str,average_score1:float
board_type2:str,average_score2:float
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Board_Type,Average_Score
L,34.1692
M,28.1818
S,20.4712
Current sql:
WITH params AS (
  SELECT
    t."event_timestamp",
    MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value" END) AS "board_value",
    MAX(CASE WHEN f.value:"key"::STRING = 'value' THEN f.value:"value" END) AS "score_value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
  GROUP BY
    t."event_timestamp"
)
SELECT
  params."board_value":"string_value"::STRING AS "Board_Type",
  ROUND(AVG(params."score_value":"int_value"::FLOAT), 4) AS "Average_Score"
FROM params
WHERE params."board_value" IS NOT NULL AND params."score_value" IS NOT NULL
GROUP BY params."board_value":"string_value"
ORDER BY "Average_Score" DESC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-20 15:13:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 15:13:30 - root - INFO - On September 15, 2018, the average scores for each board type from quick play mode completions are as follows:

```csv
Board_Type,Average_Score
L,34.1692
M,28.1818
S,20.4712
```

```sql
WITH params AS (
  SELECT
    t."event_timestamp",
    MAX(CASE WHEN f.value:"key"::STRING = 'board' THEN f.value:"value" END) AS "board_value",
    MAX(CASE WHEN f.value:"key"::STRING = 'value' THEN f.value:"value" END) AS "score_value"
  FROM
    FIREBASE.ANALYTICS_153293282."EVENTS_20180915" t,
    LATERAL FLATTEN(input => t."event_params") f
  WHERE
    t."event_name" = 'level_complete_quickplay'
  GROUP BY
    t."event_timestamp"
)
SELECT
  params."board_value":"string_value"::STRING AS "Board_Type",
  ROUND(AVG(params."score_value":"int_value"::FLOAT), 4) AS "Average_Score"
FROM params
WHERE params."board_value" IS NOT NULL AND params."score_value" IS NOT NULL
GROUP BY params."board_value":"string_value"
ORDER BY "Average_Score" DESC NULLS LAST;
```
2025-01-20 15:13:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 15:13:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 15:13:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 15:13:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 15:13:31 - snowflake.connector.connection - INFO - closed
2025-01-20 15:13:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 15:13:32 - root - INFO - itercount: 2
2025-01-20 15:13:32 - root - INFO - 0
2025-01-20 15:13:32 - root - INFO - Total iteration counts: 2
