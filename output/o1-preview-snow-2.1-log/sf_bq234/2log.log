2025-01-23 11:54:26 - openai._base_client - INFO - Retrying request to /chat/completions in 0.497377 seconds
2025-01-23 11:55:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:55:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:55:14 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:15 - root - INFO - SQL:
SELECT DISTINCT "nppes_provider_state"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   LIMIT 100;
Results:
nppes_provider_state
WI
AA
TX
AE
AR
IL
OH
MT
MO
NY
AL
LA
HI
SD
WV
ID
OK
MA
CT
DE
MP
NM
NH
IA
DC
NJ
PA
NV
MD
KY
AP
UT
AS
GU
VA
IN
AK
KS
CO
NE
NC
PR
OR
SC
MS
VI
RI
WY
CA
FL
GA
AZ
ND
ZZ
WA
ME
VT
MN
XX
MI
TN

2025-01-23 11:55:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:16 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:16 - root - INFO - SQL:
SELECT DISTINCT "drug_name"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   LIMIT 100;
Results:
drug_name
ACETAMINOPHEN-CODEINE
TRAMADOL HCL
LEVOTHYROXINE SODIUM
AVODART
ENBREL
SEREVENT DISKUS
HYDROXYCHLOROQUINE SULFATE
RAPAFLO
NEFAZODONE HCL
OFLOXACIN
NAPROXEN SODIUM
FAMCICLOVIR
AZELASTINE HCL
HEALTHY ACCENTS UNIFINE PENTIP
MONOJECT INSULIN SYRINGE
ROXICODONE
ELMIRON
GAMMAGARD LIQUID
MEPERIDINE HCL
CODEINE SULFATE
ESCITALOPRAM OXALATE
AMITRIPTYLINE HCL
TRIAMCINOLONE ACETONIDE
DIPHENOXYLATE-ATROPINE
ESTRADIOL
PIOGLITAZONE HCL
NUEDEXTA
DYMISTA
CLARITHROMYCIN
PEG-3350
FLECTOR
EXJADE
IMBRUVICA
ATELVIA
ARMOUR THYROID
MOEXIPRIL-HYDROCHLOROTHIAZIDE
PINDOLOL
VIDAZA
AGGRENOX
CELEBREX
LEXIVA
RESCULA
SULFAMETHOXAZOLE-TRIMETHOPRIM
CARAFATE
DESLORATADINE
GABITRIL
DIFLUNISAL
EPIPEN 2-PAK
PROMACTA
TARCEVA
VASCEPA
CAPTOPRIL-HYDROCHLOROTHIAZIDE
INSPRA
TRIFLURIDINE
ZYMAXID
GENERLAC
SALSALATE
TOLTERODINE TARTRATE
CLOMIPRAMINE HCL
PILOCARPINE HCL
TRETINOIN
SUPREP
AZILECT
SIMCOR
ASMANEX
XTANDI
CLARINEX
SURE COMFORT
GOLYTELY
ACTEMRA
CEFPROZIL
FEMARA
OXYCODONE HCL
DILTIAZEM 24HR ER
MECLIZINE HCL
TRIMETHOPRIM
EPLERENONE
FLUOCINOLONE ACETONIDE OIL
OLANZAPINE ODT
SAPHRIS
HUMALOG MIX 50-50
EASY TOUCH PEN NEEDLE
REYATAZ
SULFAZINE EC
TYPHIM VI
ACUVAIL
HYDROCODONE-ACETAMINOPHEN
LISINOPRIL-HYDROCHLOROTHIAZIDE
AFEDITAB CR
NITROGLYCERIN PATCH
NORTRIPTYLINE HCL
LEVOCETIRIZINE DIHYDROCHLORIDE
AZOPT
BRILINTA
DEXAMETHASONE
HALOPERIDOL LACTATE
"PANCRELIPASE 5,000"
NYSTOP
ANAGRELIDE HCL
CLICKFINE

2025-01-23 11:55:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:18 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:18 - root - INFO - SQL:
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "drug_name"
   ORDER BY "total_claims" DESC
   LIMIT 100;
Results:
drug_name,total_claims
LISINOPRIL,37599566
LEVOTHYROXINE SODIUM,37075950
AMLODIPINE BESYLATE,35659180
SIMVASTATIN,33549777
OMEPRAZOLE,32276944
HYDROCODONE-ACETAMINOPHEN,32204330
ATORVASTATIN CALCIUM,31959252
FUROSEMIDE,26372608
METFORMIN HCL,22952294
GABAPENTIN,21323652
METOPROLOL TARTRATE,20782646
LOSARTAN POTASSIUM,17873509
HYDROCHLOROTHIAZIDE,17373067
METOPROLOL SUCCINATE,16781720
WARFARIN SODIUM,15241971
CLOPIDOGREL,14563125
PRAVASTATIN SODIUM,14190361
CARVEDILOL,13310395
TRAMADOL HCL,13242625
ALPRAZOLAM,13081892
ATENOLOL,12883671
POTASSIUM CHLORIDE,12506552
TAMSULOSIN HCL,11685280
SERTRALINE HCL,11187864
PANTOPRAZOLE SODIUM,11071364
CITALOPRAM HBR,10234686
PREDNISONE,9844536
TRAZODONE HCL,9663151
FLUTICASONE PROPIONATE,9614633
LORAZEPAM,9560017
ZOLPIDEM TARTRATE,9448045
CLONAZEPAM,9267099
CRESTOR,8600472
OXYCODONE-ACETAMINOPHEN,8250381
DONEPEZIL HCL,8052913
MELOXICAM,7921650
PROAIR HFA,7686762
ALLOPURINOL,7530262
ALENDRONATE SODIUM,7293735
RANITIDINE HCL,7170871
LISINOPRIL-HYDROCHLOROTHIAZIDE,7042874
NEXIUM,6968108
MONTELUKAST SODIUM,6855005
ESCITALOPRAM OXALATE,6711864
DULOXETINE HCL,6503301
QUETIAPINE FUMARATE,6398416
LATANOPROST,6339049
AZITHROMYCIN,6135891
CIPROFLOXACIN HCL,5924418
FLUOXETINE HCL,5834784
GLIMEPIRIDE,5613158
OXYCODONE HCL,5603775
LOVASTATIN,5551048
ISOSORBIDE MONONITRATE ER,5542060
ADVAIR DISKUS,5541448
LOSARTAN-HYDROCHLOROTHIAZIDE,5512996
SPIRIVA,5339480
SYNTHROID,5306839
MIRTAZAPINE,5235802
GLIPIZIDE,5077217
AMOXICILLIN,4970056
FENOFIBRATE,4957587
NAMENDA,4879366
SPIRONOLACTONE,4612646
RISPERIDONE,4511603
TRIAMTERENE-HYDROCHLOROTHIAZID,4407324
FINASTERIDE,4357389
IBUPROFEN,4326254
PAROXETINE HCL,4313490
CLONIDINE HCL,4299189
ENALAPRIL MALEATE,4211624
JANUVIA,4112402
LANTUS SOLOSTAR,3967264
LYRICA,3933987
METFORMIN HCL ER,3927209
LANTUS,3799781
VENLAFAXINE HCL ER,3776399
CEPHALEXIN,3636174
FAMOTIDINE,3621252
DIOVAN,3614837
SULFAMETHOXAZOLE-TRIMETHOPRIM,3569752
AMITRIPTYLINE HCL,3539561
DIAZEPAM,3510005
HYDRALAZINE HCL,3501872
LEVOFLOXACIN,3378066
POLYETHYLENE GLYCOL 3350,3178311
ZETIA,3174655
TEMAZEPAM,3171737
VALSARTAN-HYDROCHLOROTHIAZIDE,3065182
TRIAMCINOLONE ACETONIDE,3052903
BENAZEPRIL HCL,3052603
MORPHINE SULFATE ER,2946254
LEVETIRACETAM,2919863
NAPROXEN,2872736
LAMOTRIGINE,2835316
CELEBREX,2829304
TIZANIDINE HCL,2815712
FENTANYL,2803034
BACLOFEN,2790878
OLANZAPINE,2712012

2025-01-23 11:55:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:19 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:20 - root - INFO - SQL:
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   WHERE "nppes_provider_state" = 'CA'
   GROUP BY "drug_name"
   ORDER BY "total_claims" DESC
   LIMIT 100;
Results:
drug_name,total_claims
HYDROCODONE-ACETAMINOPHEN,3726576
AMLODIPINE BESYLATE,3725846
ATORVASTATIN CALCIUM,3672387
LEVOTHYROXINE SODIUM,3489384
SIMVASTATIN,3391598
LISINOPRIL,3328132
OMEPRAZOLE,2893661
METFORMIN HCL,2583231
LOSARTAN POTASSIUM,2213792
FUROSEMIDE,1999403
HYDROCHLOROTHIAZIDE,1788127
GABAPENTIN,1785041
ATENOLOL,1782218
METOPROLOL TARTRATE,1655218
TAMSULOSIN HCL,1291197
WARFARIN SODIUM,1271893
CARVEDILOL,1268157
CLOPIDOGREL,1204209
ALENDRONATE SODIUM,1197539
METOPROLOL SUCCINATE,1191102
LORAZEPAM,1072871
FLUTICASONE PROPIONATE,1030521
PANTOPRAZOLE SODIUM,1024386
ZOLPIDEM TARTRATE,1001342
TRAMADOL HCL,969328
PRAVASTATIN SODIUM,920449
LOVASTATIN,899560
GLIPIZIDE,891412
PROAIR HFA,840455
BENAZEPRIL HCL,834666
ALPRAZOLAM,819521
TRAZODONE HCL,817230
POTASSIUM CHLORIDE,811954
IBUPROFEN,779462
DONEPEZIL HCL,772689
SERTRALINE HCL,754760
ALLOPURINOL,734788
PREDNISONE,726710
LATANOPROST,680964
CITALOPRAM HBR,632437
CLONAZEPAM,631260
CRESTOR,609621
CIPROFLOXACIN HCL,580501
DIOVAN,578671
FAMOTIDINE,576503
MONTELUKAST SODIUM,572720
FLUOXETINE HCL,572277
MELOXICAM,567331
AZITHROMYCIN,561403
QUETIAPINE FUMARATE,559484
ESCITALOPRAM OXALATE,558272
NEXIUM,531478
FINASTERIDE,523121
JANUVIA,520244
TRIAMCINOLONE ACETONIDE,514032
ADVAIR DISKUS,503908
AMOXICILLIN,494134
LISINOPRIL-HYDROCHLOROTHIAZIDE,478616
SPIRIVA,457673
RANITIDINE HCL,451429
DULOXETINE HCL,447651
NAMENDA,445818
GLIMEPIRIDE,441366
TRIAMTERENE-HYDROCHLOROTHIAZID,438309
CEPHALEXIN,434611
TEMAZEPAM,431214
FENOFIBRATE,429570
LOSARTAN-HYDROCHLOROTHIAZIDE,424282
CLONIDINE HCL,410922
OXYCODONE-ACETAMINOPHEN,410193
TERAZOSIN HCL,395927
ISOSORBIDE MONONITRATE ER,392080
PAROXETINE HCL,391398
RISPERIDONE,391375
MIRTAZAPINE,389212
LANTUS,382580
CELEBREX,357739
SYNTHROID,350789
HYDRALAZINE HCL,349076
SPIRONOLACTONE,343402
BACLOFEN,336316
NAPROXEN,332530
ACETAMINOPHEN-CODEINE,316224
PIOGLITAZONE HCL,314815
VALSARTAN-HYDROCHLOROTHIAZIDE,310066
SULFAMETHOXAZOLE-TRIMETHOPRIM,307559
INSULIN SYRINGE,304612
MORPHINE SULFATE ER,293222
PREDNISOLONE ACETATE,291182
OLANZAPINE,279600
DIAZEPAM,278345
LEVOFLOXACIN,277064
ZETIA,275060
VOLTAREN,273773
METFORMIN HCL ER,272267
VENLAFAXINE HCL ER,271927
ENALAPRIL MALEATE,269915
LYRICA,268101
TIMOLOL MALEATE,262891
LANTUS SOLOSTAR,261289

2025-01-23 11:55:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:55:21 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:22 - root - INFO - SQL:
SELECT "nppes_provider_state", COUNT(DISTINCT "npi") AS "provider_count"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "nppes_provider_state"
   LIMIT 100;
Results:
nppes_provider_state,provider_count
WI,16441
AA,7
MP,16
TX,50853
AE,32
DC,2677
IA,8364
DE,2568
NV,5556
VA,19335
IN,16316
AK,1609
UT,6077
AS,2
ME,4825
MN,16099
VT,1996
XX,5
NH,4397
PA,41440
NE,5279
CO,13888
NY,63751
WY,1394
RI,3701
LA,12345
KY,12131
AP,25
MA,24875
OR,12171
SC,11689
KS,7707
MO,16128
AR,6816
AL,10719
MD,15616
WA,19060
NM,5389
MI,29898
TN,18826
WV,5668
OK,9152
SD,2560
ID,4071
NC,26875
PR,8385
OH,33064
IL,32415
MT,2889
CA,86586
FL,49874
GA,20728
AZ,16666
ND,2293
ZZ,99
HI,3171
CT,12263
MS,7114
VI,154
NJ,23515
GU,98

2025-01-23 11:55:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:55:23 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:24 - root - INFO - SQL:
SELECT "nppes_provider_state", SUM("total_drug_cost") AS "total_cost"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "nppes_provider_state"
   ORDER BY "total_cost" DESC
   LIMIT 100;
Results:
nppes_provider_state,total_cost
CA,9633494580.83
NY,7521861271.359999
FL,6969574542.380001
TX,6462480867.610001
PA,4841813377.080002
OH,4050597920.3
NC,3357740486.209999
MI,3193421559.0900006
IL,3120595897.4099994
NJ,2980085648.56
GA,2787324531.7400007
TN,2449796259.99
MO,2266900573.0499997
IN,2151310576.0699997
MA,1993379967.38
VA,1845291759.1399999
AL,1774188310.3899996
KY,1749915624.0500004
SC,1625039227.0199997
WI,1595424680.7499993
LA,1586697376.6599998
AZ,1531414913.72
WA,1374073749.7699995
MD,1285911121.5400002
MN,1268712288.75
CT,1213947159.8300006
OK,1099747189.1000001
PR,998242828.4499998
CO,987955657.2399999
MS,971791465.0900002
OR,940748728.54
AR,924771139.8100002
IA,851657297.3800001
KS,812376124.7999998
WV,774905769.8599999
NV,530336271.75000006
NE,513097615.17
UT,446198781.2899999
ME,445414042.08000004
NM,402878429.59999996
RI,345326474.99000007
HI,342155461.1400001
ID,340866011.0899999
NH,322343632.64000005
DE,313539382.5
MT,235183327.44999993
SD,233180044.23999992
ND,198826531.83
DC,192973624.25
VT,171127800.38
WY,89775137.25999996
AK,78887893.47999996
VI,9122593.65
GU,3012622.0100000002
ZZ,2394695.35
AE,482799.32000000007
MP,273092.6499999999
AP,68270.65999999999
XX,41955.98999999999
AA,9045.2
AS,1660.4500000000003

2025-01-23 11:55:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:25 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:26 - root - INFO - SQL:
SELECT DISTINCT "npi", "nppes_provider_last_org_name", "nppes_provider_first_name"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   WHERE "drug_name" = 'LISINOPRIL'
   LIMIT 100;
Results:
npi,nppes_provider_last_org_name,nppes_provider_first_name
1407092042,HOMMEMA,LAURIE
1104921444,ARORA,AJIT
1669429395,TANUR,MARCIA
1134120421,VAZQUEZ,EMILIO
1558343061,HENDERSON,TRAVIS
1427283928,GANDHE,NALINIKUMARI
1346596707,MAGWOOD,REBECCA
1154394724,SEE,NEIL
1548339278,AGUINALDO,ESTRELLA
1275541203,KODRAS,RONALD
1134173768,HOLMES,LEWIS
1891994026,KURKOWSKI,APRIL
1093936247,VENDIG,JOSHUA
1164452108,CROPPER,WENDY
1659371847,FINKELSTEIN,LARRY
1780751503,ROSEN,ROMINA
1194873067,AGATEP,ANGELI
1649257338,KIMMEL,RONALD
1730280660,KADAM,SHIVAJI
1316955040,ALLEN,BRANDON
1861487282,HUGHES,LYNDA
1578562013,OLIVERIO,FREELAND
1033291257,MOYER,RICHARD
1720156631,NAJIEB,AMINAH
1255490868,SIM,JOHN
1497076673,TIEN,PHUONG
1770707093,JACKSON,EVELYN
1790006799,KANWAL,TUBA
1528068194,STRAYHORN,GREGORY
1679867709,FUNCHES,JOSALYN
1003887431,MINION,RANDALL
1942561451,ORTIZ,ZACHARY
1891796603,SOBRAL,CARLOS
1871701888,STOVERINK,MATTHEW
1487944021,MACKENZIE,KARA
1487623294,CROWELL,CHARLES
1932290483,LASANTA RAMOS,IRIS
1366705766,WILSON,DINA
1033486758,SHAUKAT,BUSHRA
1003803461,MACK,JEFFREY
1134173222,PAI,DAVID
1912211483,ROXAS,SHARON
1487620969,GRAFTON,GEORGI
1508868985,MCSWAIN,ROBERT
1477643955,MAKHOUL,ISSAM
1104856046,BISGROVE,MICHAEL
1215198460,ST. HILAIRE,KENDRA
1144289653,PATEL,RATNADEEP
1174610240,PAINTER,LUCY
1285632661,PORTER,ROBERT
1780678870,VARELA,MARISELA
1023104353,SPRIGGS,DAVID
1407946213,LAGROTTERIA,JANE
1306893227,CHINITZ,MARVIN
1457436990,LESTER,JEFF
1154359479,PEREZ,RODOLFO
1740256973,WEAVERLING,ERIC
1750575213,AKHAVON,FARIBA
1205916236,SUTTON,REID
1457391401,LEONARD,JAYNE
1366528887,MAR,JOHN
1558561076,PINZON,AMABELLE
1932178928,HALKO,GEORGE
1295773745,FERLAZZO,HELEN
1003816745,UPPALAPATI,PADMAVATHY
1639304124,KIM,ELIZABETH
1265421275,VANGA,AMARESH
1467400945,DEUTSCH,JAUHNA
1780604827,DIPRIMO,DOMINICK
1295979227,LAGUE,DAVID
1518947894,SHIRIAEVA,NATALIA
1821037367,SPENCER,CHARLENE
1063513547,BIOCIC,BARTOL
1295748358,PESCATORE,FRED
1790813046,LOWENTHAL,SARAH
1447228069,REED,MICHAEL
1285924712,VAN WINKLE,KRISTINE
1073557740,MAYUGA,RUPERTO
1710093315,CARBALLO,DARLA
1235118035,NGUYEN,ANNALYSA
1467637736,LOGAN,KIMBER
1477708436,RATTAN,JASWINDER
1710147269,KREMSER,CHELSI
1861817934,TUAZON,HOMER
1700106028,JABEEN,SUMAIRA
1396004404,CHITTICK,CONAN
1225251440,SETHI,VISHAL
1841300092,WRITZ,PAUL
1518931211,BILLAS,ANTHONY
1801862586,CORPUS,JAMES
1902091499,NAIK,JAEE
1205173903,JANICH,CARMEN
1588004071,GHOSH,RAKTIM
1295700862,SODUMS,MARCIS
1568467983,FLANAGAN,CLINT
1902850464,ZEBROSKI,RUTH
1568525269,HUAN,YONGHONG
1487689212,FISCHER,KEITH
1962443531,MORGAN,RUTH
1124262738,BERNHARD,CLINT

2025-01-23 11:55:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:27 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:28 - root - INFO - SQL:
SELECT "npi", AVG("total_claim_count") AS "average_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "npi"
   LIMIT 100;
Results:
npi,average_claims
1609966613,53.511278
1780755892,54.033708
1790069599,27.769231
1124349493,48.150538
1043314313,25.100000
1912941824,71.315000
1568607984,53.482517
1396922423,34.126316
1336177070,43.666667
1831490283,83.931818
1285739813,56.162963
1124087853,35.500000
1457362527,28.764706
1275525768,43.836207
1639140247,55.761905
1710908744,94.377510
1598721029,34.514286
1225003098,28.850575
1043210354,108.709677
1013071612,57.467456
1760662373,41.873016
1174634513,49.070175
1225262561,57.216216
1194076836,49.715596
1942358106,30.285714
1992730725,66.798742
1144458977,76.814978
1972547438,34.206897
1417975889,41.418033
1417168998,47.089888
1205925344,35.562500
1619969615,58.785714
1295799864,55.327044
1013022300,24.666667
1427262112,19.380952
1255439360,61.887097
1679587778,100.080537
1366654329,79.301075
1942300082,54.441558
1134177157,36.214286
1033123971,23.611111
1831430750,21.214286
1831184258,46.112150
1639180912,59.850932
1285642611,50.930636
1578666848,61.648855
1457302499,36.794393
1568405710,59.936508
1851370951,52.802326
1891785614,48.304348
1326027806,34.344538
1619976644,73.111765
1043291495,59.127168
1386949659,29.493333
1760466262,148.054131
1730127242,27.833333
1689645327,33.911392
1750351615,68.105505
1982652483,26.434783
1073506036,44.175676
1710051743,48.232394
1114248465,50.125000
1851371991,14.000000
1871567487,46.181818
1699728535,86.004367
1003803552,44.968750
1104064823,19.851852
1215082961,30.479167
1639199102,41.370787
1922233873,41.788618
1578568614,48.940741
1306072202,25.166667
1437162054,68.587786
1447571864,50.918182
1821050089,89.585799
1023043494,20.888889
1467590877,57.256410
1457492688,174.147059
1528007226,60.005051
1548374192,84.330579
1518127927,103.266160
1336158179,72.531429
1942313069,31.636364
1659402782,77.377990
1003064577,172.750000
1588892558,25.250000
1437574134,23.937500
1295819274,69.382353
1508843095,48.102273
1992752349,43.735632
1003895574,25.142857
1619915295,118.623794
1801878145,72.072000
1881680908,39.670588
1609001551,43.280992
1093761678,41.166667
1487854998,27.234043
1215079710,37.445652
1083645469,41.781250
1093772873,32.584906

2025-01-23 11:55:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:29 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:29 - root - INFO - SQL:
SELECT "specialty_description", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "specialty_description"
   ORDER BY "total_claims" DESC
   LIMIT 100;
Results:
specialty_description,total_claims
Internal Medicine,385858450
Family Practice,361410647
Nurse Practitioner,77798973
Cardiology,67061172
Psychiatry,40912819
Physician Assistant,40433925
General Practice,30214429
Ophthalmology,23576481
Neurology,18610103
Nephrology,13896844
Emergency Medicine,12468018
Endocrinology,12427024
Urology,11877008
Pulmonary Disease,11506976
Geriatric Medicine,10970038
Rheumatology,10879733
Gastroenterology,10337430
Dermatology,6086148
Physical Medicine and Rehabilitation,6041716
Orthopedic Surgery,5957525
Dentist,5507795
Hematology/Oncology,5323040
Anesthesiology,4356238
Interventional Pain Management,4052937
Psychiatry & Neurology,3965578
Optometry,3911430
Obstetrics/Gynecology,3842451
General Surgery,3796486
Infectious Disease,3618386
Otolaryngology,3607257
Pain Management,2987367
Podiatry,2747446
Certified Clinical Nurse Specialist,2227157
Student in an Organized Health Care Education/Training Program,2136393
Cardiac Electrophysiology,2030588
Allergy/Immunology,1982136
Pediatric Medicine,1960228
Medical Oncology,1536571
Oral Surgery (dentists only),922026
Critical Care (Intensivists),787028
Osteopathic Manipulative Medicine,760072
Neurosurgery,740265
Specialist,649455
Neuropsychiatry,612804
Vascular Surgery,491463
Preventive Medicine,395584
Pharmacist,392667
Family Medicine,391783
Registered Nurse,335449
Plastic and Reconstructive Surgery,323740
Cardiac Surgery,322047
Hematology,303023
Radiation Oncology,299581
Diagnostic Radiology,278532
Maxillofacial Surgery,255078
Hospice and Palliative Care,243237
Geriatric Psychiatry,225099
Thoracic Surgery,217715
Clinic/Center,184814
Colorectal Surgery (formerly proctology),177762
Hand Surgery,150760
Gynecological/Oncology,139191
Addiction Medicine,120726
Sports Medicine,114748
Multispecialty Clinic/Group Practice,112220
Legal Medicine,94363
Nuclear Medicine,88485
Hospitalist,77109
Orthopaedic Surgery,71631
Sleep Medicine,70563
Pathology,65949
Interventional Radiology,61565
Psychologist (billing independently),60265
Certified Nurse Midwife,54794
Surgical Oncology,50046
Community Health Worker,48937
"Medical Genetics, Ph.D. Medical Genetics",48271
Clinical Psychologist,47463
Peripheral Vascular Disease,41768
Counselor,39785
Oral & Maxillofacial Surgery,38207
Licensed Practical Nurse,36464
Unknown Physician Specialty Code,36100
Naturopath,33196
Driver,32162
CRNA,29108
Personal Emergency Response Attendant,21539
Plastic Surgery,19845
Hospital (Dmercs Only),16848
Neurological Surgery,16469
Health Maintenance Organization,15273
Chiropractic,13746
Rehabilitation Agency,13658
General Acute Care Hospital,13390
Interventional Cardiology,13310
Thoracic Surgery (Cardiothoracic Vascular Surgery),12859
Case Manager/Care Coordinator,12058
"Neuromusculoskeletal Medicine, Sports Medicine",11769
Respite Care,8909
Independent Medical Examiner,7712

2025-01-23 11:55:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:30 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:31 - root - INFO - SQL:
SELECT "generic_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "generic_name"
    ORDER BY "total_claims" DESC
    LIMIT 100;
Results:
generic_name,total_claims
LEVOTHYROXINE SODIUM,42430339
LISINOPRIL,37605748
AMLODIPINE BESYLATE,35681542
SIMVASTATIN,33558623
HYDROCODONE/ACETAMINOPHEN,32288473
OMEPRAZOLE,32280054
ATORVASTATIN CALCIUM,32009788
METFORMIN HCL,26913238
FUROSEMIDE,26379474
GABAPENTIN,21365858
METOPROLOL TARTRATE,20782669
LOSARTAN POTASSIUM,17885149
HYDROCHLOROTHIAZIDE,17373282
METOPROLOL SUCCINATE,17361227
POTASSIUM CHLORIDE,17345158
WARFARIN SODIUM,16565795
CLOPIDOGREL BISULFATE,14614432
PRAVASTATIN SODIUM,14192174
TRAMADOL HCL,13321051
CARVEDILOL,13316449
ALPRAZOLAM,13131628
ATENOLOL,12888728
TAMSULOSIN HCL,11694092
SERTRALINE HCL,11197155
PANTOPRAZOLE SODIUM,11112212
ALBUTEROL SULFATE,10260542
CITALOPRAM HYDROBROMIDE,10237680
FLUTICASONE PROPIONATE,10195610
PREDNISONE,9845533
ZOLPIDEM TARTRATE,9730444
TRAZODONE HCL,9664295
LORAZEPAM,9576548
CLONAZEPAM,9268365
OXYCODONE HCL/ACETAMINOPHEN,8630902
ROSUVASTATIN CALCIUM,8600472
DONEPEZIL HCL,8099405
MELOXICAM,7922498
GLIPIZIDE,7771236
"INSULIN GLARGINE,HUM.REC.ANLOG",7767045
ALLOPURINOL,7530593
ALENDRONATE SODIUM,7297574
QUETIAPINE FUMARATE,7244987
OXYCODONE HCL,7224160
RANITIDINE HCL,7172003
LISINOPRIL/HYDROCHLOROTHIAZIDE,7043906
ESOMEPRAZOLE MAGNESIUM,6968108
MONTELUKAST SODIUM,6874507
ESCITALOPRAM OXALATE,6741826
MEMANTINE HCL,6737089
DULOXETINE HCL,6731071
LATANOPROST,6369288
AZITHROMYCIN,6164236
CIPROFLOXACIN HCL,5926993
FLUOXETINE HCL,5849076
DILTIAZEM HCL,5751296
FLUTICASONE/SALMETEROL,5737472
ISOSORBIDE MONONITRATE,5669065
GLIMEPIRIDE,5615920
LOVASTATIN,5552130
LOSARTAN/HYDROCHLOROTHIAZIDE,5521064
TIOTROPIUM BROMIDE,5339480
MIRTAZAPINE,5238016
AMOXICILLIN,4970085
BUPROPION HCL,4714423
SPIRONOLACTONE,4613483
RISPERIDONE,4549653
VENLAFAXINE HCL,4474679
TRIAMTERENE/HYDROCHLOROTHIAZID,4412123
FINASTERIDE,4359255
DIVALPROEX SODIUM,4338653
IBUPROFEN,4326254
PAROXETINE HCL,4323218
CLONIDINE HCL,4300833
VALSARTAN,4262715
OXYBUTYNIN CHLORIDE,4245422
ENALAPRIL MALEATE,4212935
DIGOXIN,4207804
SITAGLIPTIN PHOSPHATE,4112402
PREGABALIN,3933987
DICLOFENAC SODIUM,3868462
MORPHINE SULFATE,3639351
CEPHALEXIN,3636197
FAMOTIDINE,3620199
SULFAMETHOXAZOLE/TRIMETHOPRIM,3569799
AMITRIPTYLINE HCL,3539561
DIAZEPAM,3515123
HYDRALAZINE HCL,3501872
LEVOFLOXACIN,3378176
POLYETHYLENE GLYCOL 3350,3178311
EZETIMIBE,3174655
TEMAZEPAM,3172449
VALSARTAN/HYDROCHLOROTHIAZIDE,3092810
"NEEDLES, INSULIN DISPOSABLE",3071091
TRIAMCINOLONE ACETONIDE,3062939
LEVETIRACETAM,3057611
BENAZEPRIL HCL,3053426
NIFEDIPINE,2976379
LAMOTRIGINE,2958171
NAPROXEN,2872866
OLANZAPINE,2872862

2025-01-23 11:55:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:32 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:33 - root - INFO - SQL:
SELECT "nppes_provider_state", "drug_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "nppes_provider_state", "drug_name"
    ORDER BY "nppes_provider_state", "total_claims" DESC
    LIMIT 100;
Results:
nppes_provider_state,drug_name,total_claims
AA,AMOXICILLIN,225
AA,HYDROCODONE-ACETAMINOPHEN,180
AA,IBUPROFEN,155
AA,AZITHROMYCIN,78
AA,METHYLPREDNISOLONE,71
AA,OXYCODONE-ACETAMINOPHEN,38
AA,LEVOFLOXACIN,30
AA,CLINDAMYCIN HCL,29
AA,AMOX TR-POTASSIUM CLAVULANATE,26
AA,TRAMADOL HCL,25
AA,PROAIR HFA,20
AA,CIPROFLOXACIN HCL,16
AA,SULFAMETHOXAZOLE-TRIMETHOPRIM,16
AA,FLUCONAZOLE,15
AA,CLONIDINE HCL,15
AA,CHLORHEXIDINE GLUCONATE,14
AA,MUPIROCIN,12
AA,PROMETHAZINE HCL,12
AA,CEFDINIR,11
AA,MELOXICAM,11
AE,HYDROCODONE-ACETAMINOPHEN,654
AE,FINASTERIDE,467
AE,AMOXICILLIN,312
AE,TAMSULOSIN HCL,253
AE,OXYCODONE-ACETAMINOPHEN,223
AE,LEVOTHYROXINE SODIUM,222
AE,CIPROFLOXACIN HCL,212
AE,SIMVASTATIN,204
AE,LISINOPRIL,196
AE,ATORVASTATIN CALCIUM,187
AE,METFORMIN HCL,177
AE,FUROSEMIDE,174
AE,AMLODIPINE BESYLATE,171
AE,TRAMADOL HCL,168
AE,METOPROLOL TARTRATE,162
AE,OXYCODONE HCL,136
AE,GABAPENTIN,127
AE,METOPROLOL SUCCINATE,119
AE,IBUPROFEN,101
AE,CARVEDILOL,100
AE,CEPHALEXIN,98
AE,CHLORHEXIDINE GLUCONATE,95
AE,HYDROCHLOROTHIAZIDE,91
AE,SULFAMETHOXAZOLE-TRIMETHOPRIM,84
AE,NAPROXEN,77
AE,OMEPRAZOLE,72
AE,HUMALOG,71
AE,POTASSIUM CHLORIDE,71
AE,LORAZEPAM,67
AE,LOSARTAN POTASSIUM,65
AE,OXYBUTYNIN CHLORIDE ER,62
AE,GLIMEPIRIDE,57
AE,ALENDRONATE SODIUM,56
AE,TROSPIUM CHLORIDE,54
AE,SERTRALINE HCL,53
AE,DIAZEPAM,52
AE,NEXIUM,52
AE,SYNTHROID,52
AE,LANTUS SOLOSTAR,51
AE,TROSPIUM CHLORIDE ER,51
AE,METHYLPREDNISOLONE,49
AE,METFORMIN HCL ER,49
AE,PANTOPRAZOLE SODIUM,48
AE,NITROFURANTOIN MONO-MACRO,46
AE,TERAZOSIN HCL,46
AE,CLINDAMYCIN HCL,46
AE,HYDRALAZINE HCL,41
AE,PREDNISONE,40
AE,ZOLPIDEM TARTRATE,39
AE,LOSARTAN-HYDROCHLOROTHIAZIDE,39
AE,CRESTOR,38
AE,PROAIR HFA,34
AE,CLOPIDOGREL,34
AE,WARFARIN SODIUM,34
AE,ACETAMINOPHEN-CODEINE,33
AE,PRAVASTATIN SODIUM,32
AE,FLUTICASONE PROPIONATE,30
AE,BD ULTRA-FINE PEN NEEDLE,30
AE,GLIPIZIDE,29
AE,TRIAZOLAM,28
AE,NOVOLOG FLEXPEN,28
AE,DIOVAN,28
AE,RANITIDINE HCL,28
AE,CLONIDINE HCL,27
AE,CEFDINIR,26
AE,LEVOFLOXACIN,26
AE,CITALOPRAM HBR,26
AE,CELEBREX,25
AE,LANTUS,24
AE,VALSARTAN-HYDROCHLOROTHIAZIDE,24
AE,LEVEMIR FLEXPEN,24
AE,BICALUTAMIDE,24
AE,IMIPRAMINE HCL,23
AE,TIKOSYN,23
AE,ZETIA,22
AE,ELIQUIS,22
AE,GLIPIZIDE ER,22
AE,LEVEMIR FLEXTOUCH,21
AE,LIOTHYRONINE SODIUM,19
AE,TRADJENTA,19

2025-01-23 11:55:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:34 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:35 - root - INFO - SQL:
SELECT "drug_name", SUM("total_day_supply") AS "total_days_supplied"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    WHERE "nppes_provider_state" = 'TX'
    GROUP BY "drug_name"
    ORDER BY "total_days_supplied" DESC
    LIMIT 100;
Results:
drug_name,total_days_supplied
LISINOPRIL,125802012
LEVOTHYROXINE SODIUM,124752473
AMLODIPINE BESYLATE,113929409
SIMVASTATIN,105981489
ATORVASTATIN CALCIUM,101906013
METFORMIN HCL,76267953
OMEPRAZOLE,70857037
FUROSEMIDE,68188187
HYDROCODONE-ACETAMINOPHEN,60325615
METOPROLOL SUCCINATE,57800929
PRAVASTATIN SODIUM,56023449
METOPROLOL TARTRATE,55473242
LOSARTAN POTASSIUM,55212278
GABAPENTIN,54493587
CLOPIDOGREL,52203742
HYDROCHLOROTHIAZIDE,48881905
CARVEDILOL,46929922
POTASSIUM CHLORIDE,36504803
TAMSULOSIN HCL,36223099
PANTOPRAZOLE SODIUM,34097177
CRESTOR,33644095
LISINOPRIL-HYDROCHLOROTHIAZIDE,32755728
NEXIUM,32177522
ATENOLOL,29019995
WARFARIN SODIUM,27871587
SERTRALINE HCL,27473759
TRAMADOL HCL,27339906
ALPRAZOLAM,26829593
MELOXICAM,25466241
CITALOPRAM HBR,25162104
ALENDRONATE SODIUM,24599004
FLUTICASONE PROPIONATE,24368405
TRAZODONE HCL,22791002
MONTELUKAST SODIUM,22667860
ALLOPURINOL,21961842
ZOLPIDEM TARTRATE,21448437
LOSARTAN-HYDROCHLOROTHIAZIDE,21367104
DONEPEZIL HCL,20814277
SYNTHROID,20187349
GLIMEPIRIDE,19818610
FENOFIBRATE,17585759
DULOXETINE HCL,17412602
ESCITALOPRAM OXALATE,16712592
CLONAZEPAM,16188820
GLIPIZIDE,15922183
ISOSORBIDE MONONITRATE ER,15328934
METFORMIN HCL ER,14960756
LOVASTATIN,14949926
PREDNISONE,14447517
CLONIDINE HCL,14320098
LATANOPROST,13572288
FINASTERIDE,13113891
SPIRONOLACTONE,13009828
VALSARTAN-HYDROCHLOROTHIAZIDE,12804544
ENALAPRIL MALEATE,12551011
FLUOXETINE HCL,12528189
TRIAMTERENE-HYDROCHLOROTHIAZID,12441055
QUETIAPINE FUMARATE,12334509
LYRICA,12039045
JANUVIA,12020639
LORAZEPAM,12003282
RANITIDINE HCL,11539349
LANTUS SOLOSTAR,11359420
NAMENDA,11024122
ADVAIR DISKUS,10728854
HYDRALAZINE HCL,10622096
PROAIR HFA,10340087
DIOVAN,10236945
ZETIA,9967875
SPIRIVA,9964812
RAMIPRIL,9786809
AMITRIPTYLINE HCL,9720009
MIRTAZAPINE,9374566
PAROXETINE HCL,9021870
BENAZEPRIL HCL,9012595
AMLODIPINE BESYLATE-BENAZEPRIL,8799435
BD ULTRA-FINE PEN NEEDLE,8509708
LANTUS,8503766
NIFEDIPINE ER,8271532
PIOGLITAZONE HCL,8003776
VENLAFAXINE HCL ER,7856418
CELEBREX,7679136
TIZANIDINE HCL,7676412
DOXAZOSIN MESYLATE,7352079
TEMAZEPAM,7147711
BYSTOLIC,7146104
RISPERIDONE,6955607
NAPROXEN,6630066
XARELTO,6616250
AMIODARONE HCL,6284294
SYMBICORT,6260086
LEVETIRACETAM,6220039
FAMOTIDINE,6193444
VESICARE,6192349
ROPINIROLE HCL,6020214
DIGOX,5864141
ESTRADIOL,5763536
KLOR-CON M20,5623873
BACLOFEN,5595134
DIGOXIN,5555759

2025-01-23 11:55:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:55:36 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:37 - root - INFO - SQL:
SELECT "nppes_provider_state", AVG("total_drug_cost" / NULLIF("total_claim_count", 0)) AS "average_cost_per_claim"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "nppes_provider_state"
    LIMIT 100;
Results:
nppes_provider_state,average_cost_per_claim
MO,108.34067500377114
WV,102.10411161002477
OK,106.32660285036658
ID,100.77330055434551
SD,96.13380533219062
CO,107.50767829056143
NE,94.59838559447603
NY,126.56813878798036
AR,92.04466460134235
WI,105.38883267746768
AA,10.954631054413234
NC,107.10580117390131
PR,68.54964658227632
IN,113.43207342167638
AK,95.842994298381
VA,105.91269582059857
TX,119.18019092969504
AE,71.00598916803804
IA,88.37711802696569
DC,149.49499299234952
DE,136.3810106141489
AL,107.04068016639992
LA,105.78540688814792
ME,105.27454332946226
NH,106.27264522454718
RI,96.93625338542567
WY,90.65712789346283
MD,127.56210050754613
NM,99.91891062713032
MA,111.00314300009038
AZ,109.06582511275339
FL,115.93749086075663
CA,114.44873400091022
GA,109.6762093301181
ND,99.07691179411461
ZZ,99.10502958928238
CT,128.1805428545716
NV,109.69959783621577
NJ,133.52248273014018
MP,52.66112946333795
TN,105.97230903771825
MI,115.77793377688975
OH,112.20802034704019
IL,107.80849932580716
MT,101.36544565980509
KY,103.34128981172267
AP,42.84780329309047
UT,107.21681032532459
AS,8.49925542230042
GU,53.90638563067569
WA,98.65502539538707
SC,110.7608952125914
OR,97.84619292215547
MS,94.99482967329358
VI,75.45310941241763
HI,123.66015482438914
PA,114.46946173608771
KS,100.0867538536687
MN,102.66523518159843
VT,105.24618145803922
XX,29.020966627008097

2025-01-23 11:55:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:55:38 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:55:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:55:55 - root - INFO - ```sql
SELECT
  t."nppes_provider_state" AS "State",
  t."drug_name" AS "Most_Prescribed_Medication"
FROM (
  SELECT
    "nppes_provider_state",
    "drug_name",
    SUM("total_claim_count") AS "total_claims",
    ROW_NUMBER() OVER (
      PARTITION BY "nppes_provider_state"
      ORDER BY SUM("total_claim_count") DESC
    ) AS rn
  FROM
    CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
  GROUP BY
    "nppes_provider_state",
    "drug_name"
) t
WHERE
  t.rn = 1
ORDER BY
  t."State";
```
2025-01-23 11:55:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:55:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:55:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:55:56 - snowflake.connector.connection - INFO - closed
2025-01-23 11:55:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:56:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:56:50 - root - INFO - ```sql
SELECT
  "nppes_provider_state" AS "State",
  "drug_name" AS "Most_Prescribed_Medication"
FROM (
  SELECT
    "nppes_provider_state",
    "drug_name",
    "total_claims",
    ROW_NUMBER() OVER (
      PARTITION BY "nppes_provider_state"
      ORDER BY "total_claims" DESC
    ) AS rn
  FROM (
    SELECT
      "nppes_provider_state",
      "drug_name",
      SUM("total_claim_count") AS "total_claims"
    FROM
      CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY
      "nppes_provider_state",
      "drug_name"
  ) sd
) ranked_sd
WHERE ranked_sd.rn = 1
ORDER BY "State"
LIMIT 100;
```
2025-01-23 11:56:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:56:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:56:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:56:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:56:52 - snowflake.connector.connection - INFO - closed
2025-01-23 11:56:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:57:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:57:33 - root - INFO - SQL:
SELECT
  "nppes_provider_state" AS "State",
  "drug_name" AS "Most_Prescribed_Medication"
FROM (
  SELECT
    "nppes_provider_state",
    "drug_name",
    "total_claims",
    ROW_NUMBER() OVER (
      PARTITION BY "nppes_provider_state"
      ORDER BY "total_claims" DESC
    ) AS rn
  FROM (
    SELECT
      "nppes_provider_state",
      "drug_name",
      SUM("total_claim_count") AS "total_claims"
    FROM
      CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY
      "nppes_provider_state",
      "drug_name"
  ) sd
) ranked_sd
WHERE ranked_sd.rn = 1
ORDER BY "State"
LIMIT 100;
Results:
State,Most_Prescribed_Medication
AA,AMOXICILLIN
AE,HYDROCODONE-ACETAMINOPHEN
AK,LISINOPRIL
AL,HYDROCODONE-ACETAMINOPHEN
AP,HYDROCODONE-ACETAMINOPHEN
AR,HYDROCODONE-ACETAMINOPHEN
AS,LISINOPRIL
AZ,LISINOPRIL
CA,HYDROCODONE-ACETAMINOPHEN
CO,LEVOTHYROXINE SODIUM
CT,ATORVASTATIN CALCIUM
DC,AMLODIPINE BESYLATE
DE,ATORVASTATIN CALCIUM
FL,LISINOPRIL
GA,AMLODIPINE BESYLATE
GU,AMLODIPINE BESYLATE
HI,ATORVASTATIN CALCIUM
IA,LEVOTHYROXINE SODIUM
ID,HYDROCODONE-ACETAMINOPHEN
IL,LISINOPRIL
IN,HYDROCODONE-ACETAMINOPHEN
KS,LEVOTHYROXINE SODIUM
KY,HYDROCODONE-ACETAMINOPHEN
LA,HYDROCODONE-ACETAMINOPHEN
MA,LISINOPRIL
MD,LISINOPRIL
ME,LISINOPRIL
MI,HYDROCODONE-ACETAMINOPHEN
MN,LISINOPRIL
MO,LISINOPRIL
MP,AMLODIPINE BESYLATE
MS,HYDROCODONE-ACETAMINOPHEN
MT,LEVOTHYROXINE SODIUM
NC,AMLODIPINE BESYLATE
ND,LEVOTHYROXINE SODIUM
NE,LEVOTHYROXINE SODIUM
NH,LISINOPRIL
NJ,ATORVASTATIN CALCIUM
NM,LEVOTHYROXINE SODIUM
NV,HYDROCODONE-ACETAMINOPHEN
NY,AMLODIPINE BESYLATE
OH,LISINOPRIL
OK,HYDROCODONE-ACETAMINOPHEN
OR,LISINOPRIL
PA,LISINOPRIL
PR,SIMVASTATIN
RI,LISINOPRIL
SC,HYDROCODONE-ACETAMINOPHEN
SD,LEVOTHYROXINE SODIUM
TN,HYDROCODONE-ACETAMINOPHEN
TX,HYDROCODONE-ACETAMINOPHEN
UT,LEVOTHYROXINE SODIUM
VA,LISINOPRIL
VI,AMLODIPINE BESYLATE
VT,LISINOPRIL
WA,LISINOPRIL
WI,LISINOPRIL
WV,HYDROCODONE-ACETAMINOPHEN
WY,LEVOTHYROXINE SODIUM
XX,SIMVASTATIN
ZZ,HYDROCODONE-ACETAMINOPHEN

2025-01-23 11:57:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:57:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:57:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:57:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-01-23 11:57:34 - snowflake.connector.connection - INFO - closed
2025-01-23 11:57:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:57:35 - root - INFO - SQL:
SELECT
  "generic_name",
  SUM("total_claim_count") AS "total_claims"
FROM
  CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE
  "generic_name" ILIKE '%STATIN%'
GROUP BY
  "generic_name"
ORDER BY
  "total_claims" DESC
LIMIT 100
Results:
generic_name,total_claims
SIMVASTATIN,33558623
ATORVASTATIN CALCIUM,32009788
PRAVASTATIN SODIUM,14192174
ROSUVASTATIN CALCIUM,8600472
LOVASTATIN,5552130
NYSTATIN,1672042
EZETIMIBE/SIMVASTATIN,686144
NYSTATIN/TRIAMCIN,285850
PITAVASTATIN CALCIUM,141050
AMLODIPINE/ATORVASTATIN,60954
FLUVASTATIN SODIUM,38847
NIACIN/SIMVASTATIN,17363
IMIPENEM/CILASTATIN SODIUM,7383
NIACIN/LOVASTATIN,5926
EZETIMIBE/ATORVASTATIN CALCIUM,75
SITAGLIPTIN/SIMVASTATIN,12
PENTOSTATIN,11

2025-01-23 11:57:35 - root - INFO - itercount: 0
2025-01-23 11:57:35 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `PART_D_PRESCRIBER_2014` (Database: `CMS_DATA`, Schema: `CMS_MEDICARE`)

  - `"nppes_provider_state"`: Identifies the state where the provider is located; used to group prescriptions by state.
  - `"drug_name"`: The name of the prescribed medication; used to identify and group medications.
  - `"total_claim_count"`: The number of claims for each drug by a provider; used to determine how often a medication was prescribed.
  - `"npi"`: National Provider Identifier; could be used to count unique providers or analyze prescribing patterns.
  - `"nppes_provider_city"`: City of the provider; provides additional geographic context.
  - `"specialty_description"`: The provider's medical specialty; useful for understanding prescribing trends within specialties.
  - `"generic_name"`: The generic name of the medication; helpful for grouping similar medications.
  - `"total_day_supply"`: Total number of days supplied for prescriptions; indicates the volume of medication dispensed.
  - `"total_drug_cost"`: The total cost of the drug prescribed; useful for cost analysis.

**Possible Conditions:**

- Since the data is from 2014, no additional date filtering is necessary.
- Grouping data by `"nppes_provider_state"` to analyze prescriptions on a state-by-state basis.
- Summing `"total_claim_count"` for each `"drug_name"` within each state to find the most prescribed medications.
- Ordering results by `"total_claim_count"` in descending order to identify top medications.
- Using `LIMIT` to retrieve a subset of the data for exploration.

**SQL Queries to Explore the Data:**

1. **Retrieve a list of all distinct states represented in the data:**

   ```sql
   SELECT DISTINCT "nppes_provider_state"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   LIMIT 100;
   ```

2. **List all distinct drug names prescribed:**

   ```sql
   SELECT DISTINCT "drug_name"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   LIMIT 100;
   ```

3. **Get the top 100 drugs by total claim count nationwide:**

   ```sql
   SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "drug_name"
   ORDER BY "total_claims" DESC
   LIMIT 100;
   ```

4. **Find the top 100 most prescribed medications in California (CA):**

   ```sql
   SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   WHERE "nppes_provider_state" = 'CA'
   GROUP BY "drug_name"
   ORDER BY "total_claims" DESC
   LIMIT 100;
   ```

5. **Count the number of unique providers in each state:**

   ```sql
   SELECT "nppes_provider_state", COUNT(DISTINCT "npi") AS "provider_count"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "nppes_provider_state"
   LIMIT 100;
   ```

6. **Calculate the total drug cost per state:**

   ```sql
   SELECT "nppes_provider_state", SUM("total_drug_cost") AS "total_cost"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "nppes_provider_state"
   ORDER BY "total_cost" DESC
   LIMIT 100;
   ```

7. **List providers who prescribed a specific medication (e.g., 'LISINOPRIL'):**

   ```sql
   SELECT DISTINCT "npi", "nppes_provider_last_org_name", "nppes_provider_first_name"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   WHERE "drug_name" = 'LISINOPRIL'
   LIMIT 100;
   ```

8. **Find the average number of claims per provider:**

   ```sql
   SELECT "npi", AVG("total_claim_count") AS "average_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "npi"
   LIMIT 100;
   ```

9. **Get the total number of claims per medical specialty:**

   ```sql
   SELECT "specialty_description", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "specialty_description"
   ORDER BY "total_claims" DESC
   LIMIT 100;
   ```

10. **List the top 100 generic medications prescribed nationwide:**

    ```sql
    SELECT "generic_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "generic_name"
    ORDER BY "total_claims" DESC
    LIMIT 100;
    ```

11. **Explore the most prescribed medications in each state:**

    ```sql
    SELECT "nppes_provider_state", "drug_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "nppes_provider_state", "drug_name"
    ORDER BY "nppes_provider_state", "total_claims" DESC
    LIMIT 100;
    ```

12. **Retrieve total days supplied for medications in Texas (TX):**

    ```sql
    SELECT "drug_name", SUM("total_day_supply") AS "total_days_supplied"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    WHERE "nppes_provider_state" = 'TX'
    GROUP BY "drug_name"
    ORDER BY "total_days_supplied" DESC
    LIMIT 100;
    ```

13. **Calculate the average drug cost per claim in each state:**

    ```sql
    SELECT "nppes_provider_state", AVG("total_drug_cost" / NULLIF("total_claim_count", 0)) AS "average_cost_per_claim"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "nppes_provider_state"
    LIMIT 100;
    ```

14. **Identify the total number of beneficiaries for each drug:**

    ```sql
    SELECT "drug_name", SUM("bene_count") AS "total_beneficiaries"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "drug_name"
    ORDER BY "total_beneficiaries" DESC
    LIMIT 100;
    ```

15. **Find total claim counts for medications containing 'STATIN' in their generic name:**

    ```sql
    SELECT "generic_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    WHERE "generic_name" ILIKE '%STATIN%'
    GROUP BY "generic_name"
    ORDER BY "total_claims" DESC
    LIMIT 100;
    ```

These queries help in understanding the distribution of prescriptions, providers, and medications across different states, as well as identifying trends that are relevant to determining the most prescribed medication in each state for 2014.Query:
SELECT DISTINCT "nppes_provider_state"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   LIMIT 100;
Answer:
nppes_provider_state
WI
AA
TX
AE
AR
IL
OH
MT
MO
NY
AL
LA
HI
SD
WV
ID
OK
MA
CT
DE
MP
NM
NH
IA
DC
NJ
PA
NV
MD
KY
AP
UT
AS
GU
VA
IN
AK
KS
CO
NE
NC
PR
OR
SC
MS
VI
RI
WY
CA
FL
GA
AZ
ND
ZZ
WA
ME
VT
MN
XX
MI
TN
Query:
SELECT DISTINCT "drug_name"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   LIMIT 100;
Answer:
drug_name
ACETAMINOPHEN-CODEINE
TRAMADOL HCL
LEVOTHYROXINE SODIUM
AVODART
ENBREL
SEREVENT DISKUS
HYDROXYCHLOROQUINE SULFATE
RAPAFLO
NEFAZODONE HCL
OFLOXACIN
NAPROXEN SODIUM
FAMCICLOVIR
AZELASTINE HCL
HEALTHY ACCENTS UNIFINE PENTIP
MONOJECT INSULIN SYRINGE
ROXICODONE
ELMIRON
GAMMAGARD LIQUID
MEPERIDINE HCL
CODEINE SULFATE
ESCITALOPRAM OXALATE
AMITRIPTYLINE HCL
TRIAMCINOLONE ACETONIDE
DIPHENOXYLATE-ATROPINE
ESTRADIOL
PIOGLITAZONE HCL
NUEDEXTA
DYMISTA
CLARITHROMYCIN
PEG-3350
FLECTOR
EXJADE
IMBRUVICA
ATELVIA
ARMOUR THYROID
MOEXIPRIL-HYDROCHLOROTHIAZIDE
PINDOLOL
VIDAZA
AGGRENOX
CELEBREX
LEXIVA
RESCULA
SULFAMETHOXAZOLE-TRIMETHOPRIM
CARAFATE
DESLORATADINE
GABITRIL
DIFLUNISAL
EPIPEN 2-PAK
PROMACTA
TARCEVA
VASCEPA
CAPTOPRIL-HYDROCHLOROTHIAZIDE
INSPRA
TRIFLURIDINE
ZYMAXID
GENERLAC
SALSALATE
TOLTERODINE TARTRATE
CLOMIPRAMINE HCL
PILOCARPINE HCL
TRETINOIN
SUPREP
AZILECT
SIMCOR
ASMANEX
XTANDI
CLARINEX
SURE COMFORT
GOLYTELY
ACTEMRA
CEFPROZIL
FEMARA
OXYCODONE HCL
DILTIAZEM 24HR ER
MECLIZINE HCL
TRIMETHOPRIM
EPLERENONE
FLUOCINOLONE ACETONIDE OIL
OLANZAPINE ODT
SAPHRIS
HUMALOG MIX 50-50
EASY TOUCH PEN NEEDLE
REYATAZ
SULFAZINE EC
TYPHIM VI
ACUVAIL
HYDROCODONE-ACETAMINOPHEN
LISINOPRIL-HYDROCHLOROTHIAZIDE
AFEDITAB CR
NITROGLYCERIN PATCH
NORTRIPTYLINE HCL
LEVOCETIRIZINE DIHYDROCHLORIDE
AZOPT
BRILINTA
DEXAMETHASONE
HALOPERIDOL LACTATE
"PANCRELIPASE 5,000"
NYSTOP
ANAGRELIDE HCL
CLICKFINE
Query:
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "drug_name"
   ORDER BY "total_claims" DESC
   LIMIT 100;
Answer:
drug_name,total_claims
LISINOPRIL,37599566
LEVOTHYROXINE SODIUM,37075950
AMLODIPINE BESYLATE,35659180
SIMVASTATIN,33549777
OMEPRAZOLE,32276944
HYDROCODONE-ACETAMINOPHEN,32204330
ATORVASTATIN CALCIUM,31959252
FUROSEMIDE,26372608
METFORMIN HCL,22952294
GABAPENTIN,21323652
METOPROLOL TARTRATE,20782646
LOSARTAN POTASSIUM,17873509
HYDROCHLOROTHIAZIDE,17373067
METOPROLOL SUCCINATE,16781720
WARFARIN SODIUM,15241971
CLOPIDOGREL,14563125
PRAVASTATIN SODIUM,14190361
CARVEDILOL,13310395
TRAMADOL HCL,13242625
ALPRAZOLAM,13081892
ATENOLOL,12883671
POTASSIUM CHLORIDE,12506552
TAMSULOSIN HCL,11685280
SERTRALINE HCL,11187864
PANTOPRAZOLE SODIUM,11071364
CITALOPRAM HBR,10234686
PREDNISONE,9844536
TRAZODONE HCL,9663151
FLUTICASONE PROPIONATE,9614633
LORAZEPAM,9560017
ZOLPIDEM TARTRATE,9448045
CLONAZEPAM,9267099
CRESTOR,8600472
OXYCODONE-ACETAMINOPHEN,8250381
DONEPEZIL HCL,8052913
MELOXICAM,7921650
PROAIR HFA,7686762
ALLOPURINOL,7530262
ALENDRONATE SODIUM,7293735
RANITIDINE HCL,7170871
LISINOPRIL-HYDROCHLOROTHIAZIDE,7042874
NEXIUM,6968108
MONTELUKAST SODIUM,6855005
ESCITALOPRAM OXALATE,6711864
DULOXETINE HCL,6503301
QUETIAPINE FUMARATE,6398416
LATANOPROST,6339049
AZITHROMYCIN,6135891
CIPROFLOXACIN HCL,5924418
FLUOXETINE HCL,5834784
GLIMEPIRIDE,5613158
OXYCODONE HCL,5603775
LOVASTATIN,5551048
ISOSORBIDE MONONITRATE ER,5542060
ADVAIR DISKUS,5541448
LOSARTAN-HYDROCHLOROTHIAZIDE,5512996
SPIRIVA,5339480
SYNTHROID,5306839
MIRTAZAPINE,5235802
GLIPIZIDE,5077217
AMOXICILLIN,4970056
FENOFIBRATE,4957587
NAMENDA,4879366
SPIRONOLACTONE,4612646
RISPERIDONE,4511603
TRIAMTERENE-HYDROCHLOROTHIAZID,4407324
FINASTERIDE,4357389
IBUPROFEN,4326254
PAROXETINE HCL,4313490
CLONIDINE HCL,4299189
ENALAPRIL MALEATE,4211624
JANUVIA,4112402
LANTUS SOLOSTAR,3967264
LYRICA,3933987
METFORMIN HCL ER,3927209
LANTUS,3799781
VENLAFAXINE HCL ER,3776399
CEPHALEXIN,3636174
FAMOTIDINE,3621252
DIOVAN,3614837
SULFAMETHOXAZOLE-TRIMETHOPRIM,3569752
AMITRIPTYLINE HCL,3539561
DIAZEPAM,3510005
HYDRALAZINE HCL,3501872
LEVOFLOXACIN,3378066
POLYETHYLENE GLYCOL 3350,3178311
ZETIA,3174655
TEMAZEPAM,3171737
VALSARTAN-HYDROCHLOROTHIAZIDE,3065182
TRIAMCINOLONE ACETONIDE,3052903
BENAZEPRIL HCL,3052603
MORPHINE SULFATE ER,2946254
LEVETIRACETAM,2919863
NAPROXEN,2872736
LAMOTRIGINE,2835316
CELEBREX,2829304
TIZANIDINE HCL,2815712
FENTANYL,2803034
BACLOFEN,2790878
OLANZAPINE,2712012
Query:
SELECT "drug_name", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   WHERE "nppes_provider_state" = 'CA'
   GROUP BY "drug_name"
   ORDER BY "total_claims" DESC
   LIMIT 100;
Answer:
drug_name,total_claims
HYDROCODONE-ACETAMINOPHEN,3726576
AMLODIPINE BESYLATE,3725846
ATORVASTATIN CALCIUM,3672387
LEVOTHYROXINE SODIUM,3489384
SIMVASTATIN,3391598
LISINOPRIL,3328132
OMEPRAZOLE,2893661
METFORMIN HCL,2583231
LOSARTAN POTASSIUM,2213792
FUROSEMIDE,1999403
HYDROCHLOROTHIAZIDE,1788127
GABAPENTIN,1785041
ATENOLOL,1782218
METOPROLOL TARTRATE,1655218
TAMSULOSIN HCL,1291197
WARFARIN SODIUM,1271893
CARVEDILOL,1268157
CLOPIDOGREL,1204209
ALENDRONATE SODIUM,1197539
METOPROLOL SUCCINATE,1191102
LORAZEPAM,1072871
FLUTICASONE PROPIONATE,1030521
PANTOPRAZOLE SODIUM,1024386
ZOLPIDEM TARTRATE,1001342
TRAMADOL HCL,969328
PRAVASTATIN SODIUM,920449
LOVASTATIN,899560
GLIPIZIDE,891412
PROAIR HFA,840455
BENAZEPRIL HCL,834666
ALPRAZOLAM,819521
TRAZODONE HCL,817230
POTASSIUM CHLORIDE,811954
IBUPROFEN,779462
DONEPEZIL HCL,772689
SERTRALINE HCL,754760
ALLOPURINOL,734788
PREDNISONE,726710
LATANOPROST,680964
CITALOPRAM HBR,632437
CLONAZEPAM,631260
CRESTOR,609621
CIPROFLOXACIN HCL,580501
DIOVAN,578671
FAMOTIDINE,576503
MONTELUKAST SODIUM,572720
FLUOXETINE HCL,572277
MELOXICAM,567331
AZITHROMYCIN,561403
QUETIAPINE FUMARATE,559484
ESCITALOPRAM OXALATE,558272
NEXIUM,531478
FINASTERIDE,523121
JANUVIA,520244
TRIAMCINOLONE ACETONIDE,514032
ADVAIR DISKUS,503908
AMOXICILLIN,494134
LISINOPRIL-HYDROCHLOROTHIAZIDE,478616
SPIRIVA,457673
RANITIDINE HCL,451429
DULOXETINE HCL,447651
NAMENDA,445818
GLIMEPIRIDE,441366
TRIAMTERENE-HYDROCHLOROTHIAZID,438309
CEPHALEXIN,434611
TEMAZEPAM,431214
FENOFIBRATE,429570
LOSARTAN-HYDROCHLOROTHIAZIDE,424282
CLONIDINE HCL,410922
OXYCODONE-ACETAMINOPHEN,410193
TERAZOSIN HCL,395927
ISOSORBIDE MONONITRATE ER,392080
PAROXETINE HCL,391398
RISPERIDONE,391375
MIRTAZAPINE,389212
LANTUS,382580
CELEBREX,357739
SYNTHROID,350789
HYDRALAZINE HCL,349076
SPIRONOLACTONE,343402
BACLOFEN,336316
NAPROXEN,332530
ACETAMINOPHEN-CODEINE,316224
PIOGLITAZONE HCL,314815
VALSARTAN-HYDROCHLOROTHIAZIDE,310066
SULFAMETHOXAZOLE-TRIMETHOPRIM,307559
INSULIN SYRINGE,304612
MORPHINE SULFATE ER,293222
PREDNISOLONE ACETATE,291182
OLANZAPINE,279600
DIAZEPAM,278345
LEVOFLOXACIN,277064
ZETIA,275060
VOLTAREN,273773
METFORMIN HCL ER,272267
VENLAFAXINE HCL ER,271927
ENALAPRIL MALEATE,269915
LYRICA,268101
TIMOLOL MALEATE,262891
LANTUS SOLOSTAR,261289
Query:
SELECT "nppes_provider_state", COUNT(DISTINCT "npi") AS "provider_count"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "nppes_provider_state"
   LIMIT 100;
Answer:
nppes_provider_state,provider_count
WI,16441
AA,7
MP,16
TX,50853
AE,32
DC,2677
IA,8364
DE,2568
NV,5556
VA,19335
IN,16316
AK,1609
UT,6077
AS,2
ME,4825
MN,16099
VT,1996
XX,5
NH,4397
PA,41440
NE,5279
CO,13888
NY,63751
WY,1394
RI,3701
LA,12345
KY,12131
AP,25
MA,24875
OR,12171
SC,11689
KS,7707
MO,16128
AR,6816
AL,10719
MD,15616
WA,19060
NM,5389
MI,29898
TN,18826
WV,5668
OK,9152
SD,2560
ID,4071
NC,26875
PR,8385
OH,33064
IL,32415
MT,2889
CA,86586
FL,49874
GA,20728
AZ,16666
ND,2293
ZZ,99
HI,3171
CT,12263
MS,7114
VI,154
NJ,23515
GU,98
Query:
SELECT "nppes_provider_state", SUM("total_drug_cost") AS "total_cost"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "nppes_provider_state"
   ORDER BY "total_cost" DESC
   LIMIT 100;
Answer:
nppes_provider_state,total_cost
CA,9633494580.83
NY,7521861271.359999
FL,6969574542.380001
TX,6462480867.610001
PA,4841813377.080002
OH,4050597920.3
NC,3357740486.209999
MI,3193421559.0900006
IL,3120595897.4099994
NJ,2980085648.56
GA,2787324531.7400007
TN,2449796259.99
MO,2266900573.0499997
IN,2151310576.0699997
MA,1993379967.38
VA,1845291759.1399999
AL,1774188310.3899996
KY,1749915624.0500004
SC,1625039227.0199997
WI,1595424680.7499993
LA,1586697376.6599998
AZ,1531414913.72
WA,1374073749.7699995
MD,1285911121.5400002
MN,1268712288.75
CT,1213947159.8300006
OK,1099747189.1000001
PR,998242828.4499998
CO,987955657.2399999
MS,971791465.0900002
OR,940748728.54
AR,924771139.8100002
IA,851657297.3800001
KS,812376124.7999998
WV,774905769.8599999
NV,530336271.75000006
NE,513097615.17
UT,446198781.2899999
ME,445414042.08000004
NM,402878429.59999996
RI,345326474.99000007
HI,342155461.1400001
ID,340866011.0899999
NH,322343632.64000005
DE,313539382.5
MT,235183327.44999993
SD,233180044.23999992
ND,198826531.83
DC,192973624.25
VT,171127800.38
WY,89775137.25999996
AK,78887893.47999996
VI,9122593.65
GU,3012622.0100000002
ZZ,2394695.35
AE,482799.32000000007
MP,273092.6499999999
AP,68270.65999999999
XX,41955.98999999999
AA,9045.2
AS,1660.4500000000003
Query:
SELECT DISTINCT "npi", "nppes_provider_last_org_name", "nppes_provider_first_name"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   WHERE "drug_name" = 'LISINOPRIL'
   LIMIT 100;
Answer:
npi,nppes_provider_last_org_name,nppes_provider_first_name
1407092042,HOMMEMA,LAURIE
1104921444,ARORA,AJIT
1669429395,TANUR,MARCIA
1134120421,VAZQUEZ,EMILIO
1558343061,HENDERSON,TRAVIS
1427283928,GANDHE,NALINIKUMARI
1346596707,MAGWOOD,REBECCA
1154394724,SEE,NEIL
1548339278,AGUINALDO,ESTRELLA
1275541203,KODRAS,RONALD
1134173768,HOLMES,LEWIS
1891994026,KURKOWSKI,APRIL
1093936247,VENDIG,JOSHUA
1164452108,CROPPER,WENDY
1659371847,FINKELSTEIN,LARRY
1780751503,ROSEN,ROMINA
1194873067,AGATEP,ANGELI
1649257338,KIMMEL,RONALD
1730280660,KADAM,SHIVAJI
1316955040,ALLEN,BRANDON
1861487282,HUGHES,LYNDA
1578562013,OLIVERIO,FREELAND
1033291257,MOYER,RICHARD
1720156631,NAJIEB,AMINAH
1255490868,SIM,JOHN
1497076673,TIEN,PHUONG
1770707093,JACKSON,EVELYN
1790006799,KANWAL,TUBA
1528068194,STRAYHORN,GREGORY
1679867709,FUNCHES,JOSALYN
1003887431,MINION,RANDALL
1942561451,ORTIZ,ZACHARY
1891796603,SOBRAL,CARLOS
1871701888,STOVERINK,MATTHEW
1487944021,MACKENZIE,KARA
1487623294,CROWELL,CHARLES
1932290483,LASANTA RAMOS,IRIS
1366705766,WILSON,DINA
1033486758,SHAUKAT,BUSHRA
1003803461,MACK,JEFFREY
1134173222,PAI,DAVID
1912211483,ROXAS,SHARON
1487620969,GRAFTON,GEORGI
1508868985,MCSWAIN,ROBERT
1477643955,MAKHOUL,ISSAM
1104856046,BISGROVE,MICHAEL
1215198460,ST. HILAIRE,KENDRA
1144289653,PATEL,RATNADEEP
1174610240,PAINTER,LUCY
1285632661,PORTER,ROBERT
1780678870,VARELA,MARISELA
1023104353,SPRIGGS,DAVID
1407946213,LAGROTTERIA,JANE
1306893227,CHINITZ,MARVIN
1457436990,LESTER,JEFF
1154359479,PEREZ,RODOLFO
1740256973,WEAVERLING,ERIC
1750575213,AKHAVON,FARIBA
1205916236,SUTTON,REID
1457391401,LEONARD,JAYNE
1366528887,MAR,JOHN
1558561076,PINZON,AMABELLE
1932178928,HALKO,GEORGE
1295773745,FERLAZZO,HELEN
1003816745,UPPALAPATI,PADMAVATHY
1639304124,KIM,ELIZABETH
1265421275,VANGA,AMARESH
1467400945,DEUTSCH,JAUHNA
1780604827,DIPRIMO,DOMINICK
1295979227,LAGUE,DAVID
1518947894,SHIRIAEVA,NATALIA
1821037367,SPENCER,CHARLENE
1063513547,BIOCIC,BARTOL
1295748358,PESCATORE,FRED
1790813046,LOWENTHAL,SARAH
1447228069,REED,MICHAEL
1285924712,VAN WINKLE,KRISTINE
1073557740,MAYUGA,RUPERTO
1710093315,CARBALLO,DARLA
1235118035,NGUYEN,ANNALYSA
1467637736,LOGAN,KIMBER
1477708436,RATTAN,JASWINDER
1710147269,KREMSER,CHELSI
1861817934,TUAZON,HOMER
1700106028,JABEEN,SUMAIRA
1396004404,CHITTICK,CONAN
1225251440,SETHI,VISHAL
1841300092,WRITZ,PAUL
1518931211,BILLAS,ANTHONY
1801862586,CORPUS,JAMES
1902091499,NAIK,JAEE
1205173903,JANICH,CARMEN
1588004071,GHOSH,RAKTIM
1295700862,SODUMS,MARCIS
1568467983,FLANAGAN,CLINT
1902850464,ZEBROSKI,RUTH
1568525269,HUAN,YONGHONG
1487689212,FISCHER,KEITH
1962443531,MORGAN,RUTH
1124262738,BERNHARD,CLINT
Query:
SELECT "npi", AVG("total_claim_count") AS "average_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "npi"
   LIMIT 100;
Answer:
npi,average_claims
1609966613,53.511278
1780755892,54.033708
1790069599,27.769231
1124349493,48.150538
1043314313,25.100000
1912941824,71.315000
1568607984,53.482517
1396922423,34.126316
1336177070,43.666667
1831490283,83.931818
1285739813,56.162963
1124087853,35.500000
1457362527,28.764706
1275525768,43.836207
1639140247,55.761905
1710908744,94.377510
1598721029,34.514286
1225003098,28.850575
1043210354,108.709677
1013071612,57.467456
1760662373,41.873016
1174634513,49.070175
1225262561,57.216216
1194076836,49.715596
1942358106,30.285714
1992730725,66.798742
1144458977,76.814978
1972547438,34.206897
1417975889,41.418033
1417168998,47.089888
1205925344,35.562500
1619969615,58.785714
1295799864,55.327044
1013022300,24.666667
1427262112,19.380952
1255439360,61.887097
1679587778,100.080537
1366654329,79.301075
1942300082,54.441558
1134177157,36.214286
1033123971,23.611111
1831430750,21.214286
1831184258,46.112150
1639180912,59.850932
1285642611,50.930636
1578666848,61.648855
1457302499,36.794393
1568405710,59.936508
1851370951,52.802326
1891785614,48.304348
1326027806,34.344538
1619976644,73.111765
1043291495,59.127168
1386949659,29.493333
1760466262,148.054131
1730127242,27.833333
1689645327,33.911392
1750351615,68.105505
1982652483,26.434783
1073506036,44.175676
1710051743,48.232394
1114248465,50.125000
1851371991,14.000000
1871567487,46.181818
1699728535,86.004367
1003803552,44.968750
1104064823,19.851852
1215082961,30.479167
1639199102,41.370787
1922233873,41.788618
1578568614,48.940741
1306072202,25.166667
1437162054,68.587786
1447571864,50.918182
1821050089,89.585799
1023043494,20.888889
1467590877,57.256410
1457492688,174.147059
1528007226,60.005051
1548374192,84.330579
1518127927,103.266160
1336158179,72.531429
1942313069,31.636364
1659402782,77.377990
1003064577,172.750000
1588892558,25.250000
1437574134,23.937500
1295819274,69.382353
1508843095,48.102273
1992752349,43.735632
1003895574,25.142857
1619915295,118.623794
1801878145,72.072000
1881680908,39.670588
1609001551,43.280992
1093761678,41.166667
1487854998,27.234043
1215079710,37.445652
1083645469,41.781250
1093772873,32.584906
Query:
SELECT "specialty_description", SUM("total_claim_count") AS "total_claims"
   FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
   GROUP BY "specialty_description"
   ORDER BY "total_claims" DESC
   LIMIT 100;
Answer:
specialty_description,total_claims
Internal Medicine,385858450
Family Practice,361410647
Nurse Practitioner,77798973
Cardiology,67061172
Psychiatry,40912819
Physician Assistant,40433925
General Practice,30214429
Ophthalmology,23576481
Neurology,18610103
Nephrology,13896844
Emergency Medicine,12468018
Endocrinology,12427024
Urology,11877008
Pulmonary Disease,11506976
Geriatric Medicine,10970038
Rheumatology,10879733
Gastroenterology,10337430
Dermatology,6086148
Physical Medicine and Rehabilitation,6041716
Orthopedic Surgery,5957525
Dentist,5507795
Hematology/Oncology,5323040
Anesthesiology,4356238
Interventional Pain Management,4052937
Psychiatry & Neurology,3965578
Optometry,3911430
Obstetrics/Gynecology,3842451
General Surgery,3796486
Infectious Disease,3618386
Otolaryngology,3607257
Pain Management,2987367
Podiatry,2747446
Certified Clinical Nurse Specialist,2227157
Student in an Organized Health Care Education/Training Program,2136393
Cardiac Electrophysiology,2030588
Allergy/Immunology,1982136
Pediatric Medicine,1960228
Medical Oncology,1536571
Oral Surgery (dentists only),922026
Critical Care (Intensivists),787028
Osteopathic Manipulative Medicine,760072
Neurosurgery,740265
Specialist,649455
Neuropsychiatry,612804
Vascular Surgery,491463
Preventive Medicine,395584
Pharmacist,392667
Family Medicine,391783
Registered Nurse,335449
Plastic and Reconstructive Surgery,323740
Cardiac Surgery,322047
Hematology,303023
Radiation Oncology,299581
Diagnostic Radiology,278532
Maxillofacial Surgery,255078
Hospice and Palliative Care,243237
Geriatric Psychiatry,225099
Thoracic Surgery,217715
Clinic/Center,184814
Colorectal Surgery (formerly proctology),177762
Hand Surgery,150760
Gynecological/Oncology,139191
Addiction Medicine,120726
Sports Medicine,114748
Multispecialty Clinic/Group Practice,112220
Legal Medicine,94363
Nuclear Medicine,88485
Hospitalist,77109
Orthopaedic Surgery,71631
Sleep Medicine,70563
Pathology,65949
Interventional Radiology,61565
Psychologist (billing independently),60265
Certified Nurse Midwife,54794
Surgical Oncology,50046
Community Health Worker,48937
"Medical Genetics, Ph.D. Medical Genetics",48271
Clinical Psychologist,47463
Peripheral Vascular Disease,41768
Counselor,39785
Oral & Maxillofacial Surgery,38207
Licensed Practical Nurse,36464
Unknown Physician Specialty Code,36100
Naturopath,33196
Driver,32162
CRNA,29108
Personal Emergency Response Attendant,21539
Plastic Surgery,19845
Hospital (Dmercs Only),16848
Neurological Surgery,16469
Health Maintenance Organization,15273
Chiropractic,13746
Rehabilitation Agency,13658
General Acute Care Hospital,13390
Interventional Cardiology,13310
Thoracic Surgery (Cardiothoracic Vascular Surgery),12859
Case Manager/Care Coordinator,12058
"Neuromusculoskeletal Medicine, Sports Medicine",11769
Respite Care,8909
Independent Medical Examiner,7712
Query:
SELECT "generic_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "generic_name"
    ORDER BY "total_claims" DESC
    LIMIT 100;
Answer:
generic_name,total_claims
LEVOTHYROXINE SODIUM,42430339
LISINOPRIL,37605748
AMLODIPINE BESYLATE,35681542
SIMVASTATIN,33558623
HYDROCODONE/ACETAMINOPHEN,32288473
OMEPRAZOLE,32280054
ATORVASTATIN CALCIUM,32009788
METFORMIN HCL,26913238
FUROSEMIDE,26379474
GABAPENTIN,21365858
METOPROLOL TARTRATE,20782669
LOSARTAN POTASSIUM,17885149
HYDROCHLOROTHIAZIDE,17373282
METOPROLOL SUCCINATE,17361227
POTASSIUM CHLORIDE,17345158
WARFARIN SODIUM,16565795
CLOPIDOGREL BISULFATE,14614432
PRAVASTATIN SODIUM,14192174
TRAMADOL HCL,13321051
CARVEDILOL,13316449
ALPRAZOLAM,13131628
ATENOLOL,12888728
TAMSULOSIN HCL,11694092
SERTRALINE HCL,11197155
PANTOPRAZOLE SODIUM,11112212
ALBUTEROL SULFATE,10260542
CITALOPRAM HYDROBROMIDE,10237680
FLUTICASONE PROPIONATE,10195610
PREDNISONE,9845533
ZOLPIDEM TARTRATE,9730444
TRAZODONE HCL,9664295
LORAZEPAM,9576548
CLONAZEPAM,9268365
OXYCODONE HCL/ACETAMINOPHEN,8630902
ROSUVASTATIN CALCIUM,8600472
DONEPEZIL HCL,8099405
MELOXICAM,7922498
GLIPIZIDE,7771236
"INSULIN GLARGINE,HUM.REC.ANLOG",7767045
ALLOPURINOL,7530593
ALENDRONATE SODIUM,7297574
QUETIAPINE FUMARATE,7244987
OXYCODONE HCL,7224160
RANITIDINE HCL,7172003
LISINOPRIL/HYDROCHLOROTHIAZIDE,7043906
ESOMEPRAZOLE MAGNESIUM,6968108
MONTELUKAST SODIUM,6874507
ESCITALOPRAM OXALATE,6741826
MEMANTINE HCL,6737089
DULOXETINE HCL,6731071
LATANOPROST,6369288
AZITHROMYCIN,6164236
CIPROFLOXACIN HCL,5926993
FLUOXETINE HCL,5849076
DILTIAZEM HCL,5751296
FLUTICASONE/SALMETEROL,5737472
ISOSORBIDE MONONITRATE,5669065
GLIMEPIRIDE,5615920
LOVASTATIN,5552130
LOSARTAN/HYDROCHLOROTHIAZIDE,5521064
TIOTROPIUM BROMIDE,5339480
MIRTAZAPINE,5238016
AMOXICILLIN,4970085
BUPROPION HCL,4714423
SPIRONOLACTONE,4613483
RISPERIDONE,4549653
VENLAFAXINE HCL,4474679
TRIAMTERENE/HYDROCHLOROTHIAZID,4412123
FINASTERIDE,4359255
DIVALPROEX SODIUM,4338653
IBUPROFEN,4326254
PAROXETINE HCL,4323218
CLONIDINE HCL,4300833
VALSARTAN,4262715
OXYBUTYNIN CHLORIDE,4245422
ENALAPRIL MALEATE,4212935
DIGOXIN,4207804
SITAGLIPTIN PHOSPHATE,4112402
PREGABALIN,3933987
DICLOFENAC SODIUM,3868462
MORPHINE SULFATE,3639351
CEPHALEXIN,3636197
FAMOTIDINE,3620199
SULFAMETHOXAZOLE/TRIMETHOPRIM,3569799
AMITRIPTYLINE HCL,3539561
DIAZEPAM,3515123
HYDRALAZINE HCL,3501872
LEVOFLOXACIN,3378176
POLYETHYLENE GLYCOL 3350,3178311
EZETIMIBE,3174655
TEMAZEPAM,3172449
VALSARTAN/HYDROCHLOROTHIAZIDE,3092810
"NEEDLES, INSULIN DISPOSABLE",3071091
TRIAMCINOLONE ACETONIDE,3062939
LEVETIRACETAM,3057611
BENAZEPRIL HCL,3053426
NIFEDIPINE,2976379
LAMOTRIGINE,2958171
NAPROXEN,2872866
OLANZAPINE,2872862
Query:
SELECT "nppes_provider_state", "drug_name", SUM("total_claim_count") AS "total_claims"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "nppes_provider_state", "drug_name"
    ORDER BY "nppes_provider_state", "total_claims" DESC
    LIMIT 100;
Answer:
nppes_provider_state,drug_name,total_claims
AA,AMOXICILLIN,225
AA,HYDROCODONE-ACETAMINOPHEN,180
AA,IBUPROFEN,155
AA,AZITHROMYCIN,78
AA,METHYLPREDNISOLONE,71
AA,OXYCODONE-ACETAMINOPHEN,38
AA,LEVOFLOXACIN,30
AA,CLINDAMYCIN HCL,29
AA,AMOX TR-POTASSIUM CLAVULANATE,26
AA,TRAMADOL HCL,25
AA,PROAIR HFA,20
AA,CIPROFLOXACIN HCL,16
AA,SULFAMETHOXAZOLE-TRIMETHOPRIM,16
AA,FLUCONAZOLE,15
AA,CLONIDINE HCL,15
AA,CHLORHEXIDINE GLUCONATE,14
AA,MUPIROCIN,12
AA,PROMETHAZINE HCL,12
AA,CEFDINIR,11
AA,MELOXICAM,11
AE,HYDROCODONE-ACETAMINOPHEN,654
AE,FINASTERIDE,467
AE,AMOXICILLIN,312
AE,TAMSULOSIN HCL,253
AE,OXYCODONE-ACETAMINOPHEN,223
AE,LEVOTHYROXINE SODIUM,222
AE,CIPROFLOXACIN HCL,212
AE,SIMVASTATIN,204
AE,LISINOPRIL,196
AE,ATORVASTATIN CALCIUM,187
AE,METFORMIN HCL,177
AE,FUROSEMIDE,174
AE,AMLODIPINE BESYLATE,171
AE,TRAMADOL HCL,168
AE,METOPROLOL TARTRATE,162
AE,OXYCODONE HCL,136
AE,GABAPENTIN,127
AE,METOPROLOL SUCCINATE,119
AE,IBUPROFEN,101
AE,CARVEDILOL,100
AE,CEPHALEXIN,98
AE,CHLORHEXIDINE GLUCONATE,95
AE,HYDROCHLOROTHIAZIDE,91
AE,SULFAMETHOXAZOLE-TRIMETHOPRIM,84
AE,NAPROXEN,77
AE,OMEPRAZOLE,72
AE,HUMALOG,71
AE,POTASSIUM CHLORIDE,71
AE,LORAZEPAM,67
AE,LOSARTAN POTASSIUM,65
AE,OXYBUTYNIN CHLORIDE ER,62
AE,GLIMEPIRIDE,57
AE,ALENDRONATE SODIUM,56
AE,TROSPIUM CHLORIDE,54
AE,SERTRALINE HCL,53
AE,DIAZEPAM,52
AE,NEXIUM,52
AE,SYNTHROID,52
AE,LANTUS SOLOSTAR,51
AE,TROSPIUM CHLORIDE ER,51
AE,METHYLPREDNISOLONE,49
AE,METFORMIN HCL ER,49
AE,PANTOPRAZOLE SODIUM,48
AE,NITROFURANTOIN MONO-MACRO,46
AE,TERAZOSIN HCL,46
AE,CLINDAMYCIN HCL,46
AE,HYDRALAZINE HCL,41
AE,PREDNISONE,40
AE,ZOLPIDEM TARTRATE,39
AE,LOSARTAN-HYDROCHLOROTHIAZIDE,39
AE,CRESTOR,38
AE,PROAIR HFA,34
AE,CLOPIDOGREL,34
AE,WARFARIN SODIUM,34
AE,ACETAMINOPHEN-CODEINE,33
AE,PRAVASTATIN SODIUM,32
AE,FLUTICASONE PROPIONATE,30
AE,BD ULTRA-FINE PEN NEEDLE,30
AE,GLIPIZIDE,29
AE,TRIAZOLAM,28
AE,NOVOLOG FLEXPEN,28
AE,DIOVAN,28
AE,RANITIDINE HCL,28
AE,CLONIDINE HCL,27
AE,CEFDINIR,26
AE,LEVOFLOXACIN,26
AE,CITALOPRAM HBR,26
AE,CELEBREX,25
AE,LANTUS,24
AE,VALSARTAN-HYDROCHLOROTHIAZIDE,24
AE,LEVEMIR FLEXPEN,24
AE,BICALUTAMIDE,24
AE,IMIPRAMINE HCL,23
AE,TIKOSYN,23
AE,ZETIA,22
AE,ELIQUIS,22
AE,GLIPIZIDE ER,22
AE,LEVEMIR FLEXTOUCH,21
AE,LIOTHYRONINE SODIUM,19
AE,TRADJENTA,19
Query:
SELECT "drug_name", SUM("total_day_supply") AS "total_days_supplied"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    WHERE "nppes_provider_state" = 'TX'
    GROUP BY "drug_name"
    ORDER BY "total_days_supplied" DESC
    LIMIT 100;
Answer:
drug_name,total_days_supplied
LISINOPRIL,125802012
LEVOTHYROXINE SODIUM,124752473
AMLODIPINE BESYLATE,113929409
SIMVASTATIN,105981489
ATORVASTATIN CALCIUM,101906013
METFORMIN HCL,76267953
OMEPRAZOLE,70857037
FUROSEMIDE,68188187
HYDROCODONE-ACETAMINOPHEN,60325615
METOPROLOL SUCCINATE,57800929
PRAVASTATIN SODIUM,56023449
METOPROLOL TARTRATE,55473242
LOSARTAN POTASSIUM,55212278
GABAPENTIN,54493587
CLOPIDOGREL,52203742
HYDROCHLOROTHIAZIDE,48881905
CARVEDILOL,46929922
POTASSIUM CHLORIDE,36504803
TAMSULOSIN HCL,36223099
PANTOPRAZOLE SODIUM,34097177
CRESTOR,33644095
LISINOPRIL-HYDROCHLOROTHIAZIDE,32755728
NEXIUM,32177522
ATENOLOL,29019995
WARFARIN SODIUM,27871587
SERTRALINE HCL,27473759
TRAMADOL HCL,27339906
ALPRAZOLAM,26829593
MELOXICAM,25466241
CITALOPRAM HBR,25162104
ALENDRONATE SODIUM,24599004
FLUTICASONE PROPIONATE,24368405
TRAZODONE HCL,22791002
MONTELUKAST SODIUM,22667860
ALLOPURINOL,21961842
ZOLPIDEM TARTRATE,21448437
LOSARTAN-HYDROCHLOROTHIAZIDE,21367104
DONEPEZIL HCL,20814277
SYNTHROID,20187349
GLIMEPIRIDE,19818610
FENOFIBRATE,17585759
DULOXETINE HCL,17412602
ESCITALOPRAM OXALATE,16712592
CLONAZEPAM,16188820
GLIPIZIDE,15922183
ISOSORBIDE MONONITRATE ER,15328934
METFORMIN HCL ER,14960756
LOVASTATIN,14949926
PREDNISONE,14447517
CLONIDINE HCL,14320098
LATANOPROST,13572288
FINASTERIDE,13113891
SPIRONOLACTONE,13009828
VALSARTAN-HYDROCHLOROTHIAZIDE,12804544
ENALAPRIL MALEATE,12551011
FLUOXETINE HCL,12528189
TRIAMTERENE-HYDROCHLOROTHIAZID,12441055
QUETIAPINE FUMARATE,12334509
LYRICA,12039045
JANUVIA,12020639
LORAZEPAM,12003282
RANITIDINE HCL,11539349
LANTUS SOLOSTAR,11359420
NAMENDA,11024122
ADVAIR DISKUS,10728854
HYDRALAZINE HCL,10622096
PROAIR HFA,10340087
DIOVAN,10236945
ZETIA,9967875
SPIRIVA,9964812
RAMIPRIL,9786809
AMITRIPTYLINE HCL,9720009
MIRTAZAPINE,9374566
PAROXETINE HCL,9021870
BENAZEPRIL HCL,9012595
AMLODIPINE BESYLATE-BENAZEPRIL,8799435
BD ULTRA-FINE PEN NEEDLE,8509708
LANTUS,8503766
NIFEDIPINE ER,8271532
PIOGLITAZONE HCL,8003776
VENLAFAXINE HCL ER,7856418
CELEBREX,7679136
TIZANIDINE HCL,7676412
DOXAZOSIN MESYLATE,7352079
TEMAZEPAM,7147711
BYSTOLIC,7146104
RISPERIDONE,6955607
NAPROXEN,6630066
XARELTO,6616250
AMIODARONE HCL,6284294
SYMBICORT,6260086
LEVETIRACETAM,6220039
FAMOTIDINE,6193444
VESICARE,6192349
ROPINIROLE HCL,6020214
DIGOX,5864141
ESTRADIOL,5763536
KLOR-CON M20,5623873
BACLOFEN,5595134
DIGOXIN,5555759
Query:
SELECT "nppes_provider_state", AVG("total_drug_cost" / NULLIF("total_claim_count", 0)) AS "average_cost_per_claim"
    FROM CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY "nppes_provider_state"
    LIMIT 100;
Answer:
nppes_provider_state,average_cost_per_claim
MO,108.34067500377114
WV,102.10411161002477
OK,106.32660285036658
ID,100.77330055434551
SD,96.13380533219062
CO,107.50767829056143
NE,94.59838559447603
NY,126.56813878798036
AR,92.04466460134235
WI,105.38883267746768
AA,10.954631054413234
NC,107.10580117390131
PR,68.54964658227632
IN,113.43207342167638
AK,95.842994298381
VA,105.91269582059857
TX,119.18019092969504
AE,71.00598916803804
IA,88.37711802696569
DC,149.49499299234952
DE,136.3810106141489
AL,107.04068016639992
LA,105.78540688814792
ME,105.27454332946226
NH,106.27264522454718
RI,96.93625338542567
WY,90.65712789346283
MD,127.56210050754613
NM,99.91891062713032
MA,111.00314300009038
AZ,109.06582511275339
FL,115.93749086075663
CA,114.44873400091022
GA,109.6762093301181
ND,99.07691179411461
ZZ,99.10502958928238
CT,128.1805428545716
NV,109.69959783621577
NJ,133.52248273014018
MP,52.66112946333795
TN,105.97230903771825
MI,115.77793377688975
OH,112.20802034704019
IL,107.80849932580716
MT,101.36544565980509
KY,103.34128981172267
AP,42.84780329309047
UT,107.21681032532459
AS,8.49925542230042
GU,53.90638563067569
WA,98.65502539538707
SC,110.7608952125914
OR,97.84619292215547
MS,94.99482967329358
VI,75.45310941241763
HI,123.66015482438914
PA,114.46946173608771
KS,100.0867538536687
MN,102.66523518159843
VT,105.24618145803922
XX,29.020966627008097
Query:
SELECT
  "nppes_provider_state" AS "State",
  "drug_name" AS "Most_Prescribed_Medication"
FROM (
  SELECT
    "nppes_provider_state",
    "drug_name",
    "total_claims",
    ROW_NUMBER() OVER (
      PARTITION BY "nppes_provider_state"
      ORDER BY "total_claims" DESC
    ) AS rn
  FROM (
    SELECT
      "nppes_provider_state",
      "drug_name",
      SUM("total_claim_count") AS "total_claims"
    FROM
      CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
    GROUP BY
      "nppes_provider_state",
      "drug_name"
  ) sd
) ranked_sd
WHERE ranked_sd.rn = 1
ORDER BY "State"
LIMIT 100;
Answer:
State,Most_Prescribed_Medication
AA,AMOXICILLIN
AE,HYDROCODONE-ACETAMINOPHEN
AK,LISINOPRIL
AL,HYDROCODONE-ACETAMINOPHEN
AP,HYDROCODONE-ACETAMINOPHEN
AR,HYDROCODONE-ACETAMINOPHEN
AS,LISINOPRIL
AZ,LISINOPRIL
CA,HYDROCODONE-ACETAMINOPHEN
CO,LEVOTHYROXINE SODIUM
CT,ATORVASTATIN CALCIUM
DC,AMLODIPINE BESYLATE
DE,ATORVASTATIN CALCIUM
FL,LISINOPRIL
GA,AMLODIPINE BESYLATE
GU,AMLODIPINE BESYLATE
HI,ATORVASTATIN CALCIUM
IA,LEVOTHYROXINE SODIUM
ID,HYDROCODONE-ACETAMINOPHEN
IL,LISINOPRIL
IN,HYDROCODONE-ACETAMINOPHEN
KS,LEVOTHYROXINE SODIUM
KY,HYDROCODONE-ACETAMINOPHEN
LA,HYDROCODONE-ACETAMINOPHEN
MA,LISINOPRIL
MD,LISINOPRIL
ME,LISINOPRIL
MI,HYDROCODONE-ACETAMINOPHEN
MN,LISINOPRIL
MO,LISINOPRIL
MP,AMLODIPINE BESYLATE
MS,HYDROCODONE-ACETAMINOPHEN
MT,LEVOTHYROXINE SODIUM
NC,AMLODIPINE BESYLATE
ND,LEVOTHYROXINE SODIUM
NE,LEVOTHYROXINE SODIUM
NH,LISINOPRIL
NJ,ATORVASTATIN CALCIUM
NM,LEVOTHYROXINE SODIUM
NV,HYDROCODONE-ACETAMINOPHEN
NY,AMLODIPINE BESYLATE
OH,LISINOPRIL
OK,HYDROCODONE-ACETAMINOPHEN
OR,LISINOPRIL
PA,LISINOPRIL
PR,SIMVASTATIN
RI,LISINOPRIL
SC,HYDROCODONE-ACETAMINOPHEN
SD,LEVOTHYROXINE SODIUM
TN,HYDROCODONE-ACETAMINOPHEN
TX,HYDROCODONE-ACETAMINOPHEN
UT,LEVOTHYROXINE SODIUM
VA,LISINOPRIL
VI,AMLODIPINE BESYLATE
VT,LISINOPRIL
WA,LISINOPRIL
WI,LISINOPRIL
WV,HYDROCODONE-ACETAMINOPHEN
WY,LEVOTHYROXINE SODIUM
XX,SIMVASTATIN
ZZ,HYDROCODONE-ACETAMINOPHEN
Query:
SELECT
  "generic_name",
  SUM("total_claim_count") AS "total_claims"
FROM
  CMS_DATA.CMS_MEDICARE."PART_D_PRESCRIBER_2014"
WHERE
  "generic_name" ILIKE '%STATIN%'
GROUP BY
  "generic_name"
ORDER BY
  "total_claims" DESC
LIMIT 100
Answer:
generic_name,total_claims
SIMVASTATIN,33558623
ATORVASTATIN CALCIUM,32009788
PRAVASTATIN SODIUM,14192174
ROSUVASTATIN CALCIUM,8600472
LOVASTATIN,5552130
NYSTATIN,1672042
EZETIMIBE/SIMVASTATIN,686144
NYSTATIN/TRIAMCIN,285850
PITAVASTATIN CALCIUM,141050
AMLODIPINE/ATORVASTATIN,60954
FLUVASTATIN SODIUM,38847
NIACIN/SIMVASTATIN,17363
IMIPENEM/CILASTATIN SODIUM,7383
NIACIN/LOVASTATIN,5926
EZETIMIBE/ATORVASTATIN CALCIUM,75
SITAGLIPTIN/SIMVASTATIN,12
PENTOSTATIN,11
End Exploring Related Columns
Task: What is the most prescribed medication in each state in 2014?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the most prescribed medication in each state for 2014, we would analyze the `PART_D_PRESCRIBER_2014` table from the `CMS_DATA` database and `CMS_MEDICARE` schema. This table contains prescription data including the state (`nppes_provider_state`), the drug name (`drug_name`), and the total number of claims (`total_claim_count`).

The expected output format is:

```csv
State,Most_Prescribed_Medication
state1:str,medication1:str
state2:str,medication2:str
...
```

This table lists each state and the corresponding medication that was prescribed the most in 2014..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 11:58:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:58:03 - root - INFO - To determine the most prescribed medication in each state for 2014, we can use the following SQL query:

```sql
SELECT
    "nppes_provider_state" AS "State",
    "drug_name" AS "Most_Prescribed_Medication"
FROM (
    SELECT
        "nppes_provider_state",
        "drug_name",
        SUM("total_claim_count") AS "total_claims",
        ROW_NUMBER() OVER (
            PARTITION BY "nppes_provider_state"
            ORDER BY SUM("total_claim_count") DESC
        ) AS rn
    FROM
        "CMS_DATA"."CMS_MEDICARE"."PART_D_PRESCRIBER_2014"
    GROUP BY
        "nppes_provider_state", "drug_name"
) sub
WHERE rn = 1
ORDER BY "State";
```
2025-01-23 11:58:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:58:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:58:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:58:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:58:04 - snowflake.connector.connection - INFO - closed
2025-01-23 11:58:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:58:05 - root - INFO - itercount: 1
2025-01-23 11:58:05 - root - INFO - 0
2025-01-23 11:58:05 - root - INFO - results: 
State,Most_Prescribed_Medication
AA,AMOXICILLIN
AE,HYDROCODONE-ACETAMINOPHEN
AK,LISINOPRIL
AL,HYDROCODONE-ACETAMINOPHEN
AP,HYDROCODONE-ACETAMINOPHEN
AR,HYDROCODONE-ACETAMINOPHEN
AS,LISINOPRIL
AZ,LISINOPRIL
CA,HYDROCODONE-ACETAMINOPHEN
CO,LEVOTHYROXINE SODIUM
CT,ATORVASTATIN CALCIUM
DC,AMLODIPINE BESYLATE
DE,ATORVASTATIN CALCIUM
FL,LISINOPRIL
GA,AMLODIPINE BESYLATE
GU,AMLODIPINE BESYLATE
HI,ATORVASTATIN CALCIUM
IA,LEVOTHYROXINE SODIUM
ID,HYDROCODONE-ACETAMINOPHEN
IL,LISINOPRIL
IN,HYDROCODONE-ACETAMINOPHEN
KS,LEVOTHYROXINE SODIUM
KY,HYDROCODONE-ACETAMINOPHEN
LA,HYDROCODONE-ACETAMINOPHEN
MA,LISINOPRIL
MD,LISINOPRIL
ME,LISINOPRIL
MI,HYDROCODONE-ACETAMINOPHEN
MN,LISINOPRIL
MO,LISINOPRIL
MP,AMLODIPINE BESYLATE
MS,HYDROCODONE-ACETAMINOPHEN
MT,LEVOTHYROXINE SODIUM
NC,AMLODIPINE BESYLATE
ND,LEVOTHYROXINE SODIUM
NE,LEVOTHYROXINE SODIUM
NH,LISINOPRIL
NJ,ATORVASTATIN CALCIUM
NM,LEVOTHYROXINE SODIUM
NV,HYDROCODONE-ACETAMINOPHEN
NY,AMLODIPINE BESYLATE
OH,LISINOPRIL
OK,HYDROCODONE-ACETAMINOPHEN
OR,LISINOPRIL
PA,LISINOPRIL
PR,SIMVASTATIN
RI,LISINOPRIL
SC,HYDROCODONE-ACETAMINOPHEN
SD,LEVOTHYROXINE SODIUM
TN,HYDROCODONE-ACETAMINOPHEN
TX,HYDROCODONE-ACETAMINOPHEN
UT,LEVOTHYROXINE SODIUM
VA,LISINOPRIL
VI,AMLODIPINE BESYLATE
VT,LISINOPRIL
WA,LISINOPRIL
WI,LISINOPRIL
WV,HYDROCODONE-ACETAMINOPHEN
WY,LEVOTHYROXINE SODIUM
XX,SIMVASTATIN
ZZ,HYDROCODONE-ACETAMINOPHEN


2025-01-23 11:58:05 - root - INFO - Please check the answer again by reviewing What is the most prescribed medication in each state in 2014?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the most prescribed medication in each state for 2014, we would analyze the `PART_D_PRESCRIBER_2014` table from the `CMS_DATA` database and `CMS_MEDICARE` schema. This table contains prescription data including the state (`nppes_provider_state`), the drug name (`drug_name`), and the total number of claims (`total_claim_count`).

The expected output format is:

```csv
State,Most_Prescribed_Medication
state1:str,medication1:str
state2:str,medication2:str
...
```

This table lists each state and the corresponding medication that was prescribed the most in 2014. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Most_Prescribed_Medication
AA,AMOXICILLIN
AE,HYDROCODONE-ACETAMINOPHEN
AK,LISINOPRIL
AL,HYDROCODONE-ACETAMINOPHEN
AP,HYDROCODONE-ACETAMINOPHEN
AR,HYDROCODONE-ACETAMINOPHEN
AS,LISINOPRIL
AZ,LISINOPRIL
CA,HYDROCODONE-ACETAMINOPHEN
CO,LEVOTHYROXINE SODIUM
CT,ATORVASTATIN CALCIUM
DC,AMLODIPINE BESYLATE
DE,ATORVASTATIN CALCIUM
FL,LISINOPRIL
GA,AMLODIPINE BESYLATE
GU,AMLODIPINE BESYLATE
HI,ATORVASTATIN CALCIUM
IA,LEVOTHYROXINE SODIUM
ID,HYDROCODONE-ACETAMINOPHEN
IL,LISINOPRIL
IN,HYDROCODONE-ACETAMINOPHEN
KS,LEVOTHYROXINE SODIUM
KY,HYDROCODONE-ACETAMINOPHEN
LA,HYDROCODONE-ACETAMINOPHEN
MA,LISINOPRIL
MD,LISINOPRIL
ME,LISINOPRIL
MI,HYDROCODONE-ACETAMINOPHEN
MN,LISINOPRIL
MO,LISINOPRIL
MP,AMLODIPINE BESYLATE
MS,HYDROCODONE-ACETAMINOPHEN
MT,LEVOTHYROXINE SODIUM
NC,AMLODIPINE BESYLATE
ND,LEVOTHYROXINE SODIUM
NE,LEVOTHYROXINE SODIUM
NH,LISINOPRIL
NJ,ATORVASTATIN CALCIUM
NM,LEVOTHYROXINE SODIUM
NV,HYDROCODONE-ACETAMINOPHEN
NY,AMLODIPINE BESYLATE
OH,LISINOPRIL
OK,HYDROCODONE-ACETAMINOPHEN
OR,LISINOPRIL
PA,LISINOPRIL
PR,SIMVASTATIN
RI,LISINOPRIL
SC,HYDROCODONE-ACETAMINOPHEN
SD,LEVOTHYROXINE SODIUM
TN,HYDROCODONE-ACETAMINOPHEN
TX,HYDROCODONE-ACETAMINOPHEN
UT,LEVOTHYROXINE SODIUM
VA,LISINOPRIL
VI,AMLODIPINE BESYLATE
VT,LISINOPRIL
WA,LISINOPRIL
WI,LISINOPRIL
WV,HYDROCODONE-ACETAMINOPHEN
WY,LEVOTHYROXINE SODIUM
XX,SIMVASTATIN
ZZ,HYDROCODONE-ACETAMINOPHEN
Current sql:
SELECT
    "nppes_provider_state" AS "State",
    "drug_name" AS "Most_Prescribed_Medication"
FROM (
    SELECT
        "nppes_provider_state",
        "drug_name",
        SUM("total_claim_count") AS "total_claims",
        ROW_NUMBER() OVER (
            PARTITION BY "nppes_provider_state"
            ORDER BY SUM("total_claim_count") DESC
        ) AS rn
    FROM
        "CMS_DATA"."CMS_MEDICARE"."PART_D_PRESCRIBER_2014"
    GROUP BY
        "nppes_provider_state", "drug_name"
) sub
WHERE rn = 1
ORDER BY "State";When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-23 11:58:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:58:45 - root - INFO - To determine the most prescribed medication in each state for 2014, we would analyze the `PART_D_PRESCRIBER_2014` table from the `CMS_DATA` database and `CMS_MEDICARE` schema. This table contains prescription data including the state (`nppes_provider_state`), the drug name (`drug_name`), and the total number of claims (`total_claim_count`).

The expected output format is:

```csv
State,Most_Prescribed_Medication
state1:str,medication1:str
state2:str,medication2:str
...
```

This table lists each state and the corresponding medication that was prescribed the most in 2014.

Here is the SQL query:

```sql
WITH total_claims AS (
    SELECT
        "nppes_provider_state",
        "drug_name",
        SUM("total_claim_count") AS "total_claims"
    FROM
        "CMS_DATA"."CMS_MEDICARE"."PART_D_PRESCRIBER_2014"
    GROUP BY
        "nppes_provider_state", "drug_name"
),
ranked_claims AS (
    SELECT
        "nppes_provider_state",
        "drug_name",
        ROW_NUMBER() OVER (
            PARTITION BY "nppes_provider_state"
            ORDER BY "total_claims" DESC NULLS LAST
        ) AS rn
    FROM
        total_claims
)
SELECT
    "nppes_provider_state" AS "State",
    "drug_name" AS "Most_Prescribed_Medication"
FROM
    ranked_claims
WHERE
    rn = 1
ORDER BY
    "State";
```
2025-01-23 11:58:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:58:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:58:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:58:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-23 11:58:46 - snowflake.connector.connection - INFO - closed
2025-01-23 11:58:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:58:47 - root - INFO - itercount: 2
2025-01-23 11:58:47 - root - INFO - 0
2025-01-23 11:58:47 - root - INFO - Total iteration counts: 2
