2025-01-23 17:39:17 - openai._base_client - INFO - Retrying request to /chat/completions in 0.457604 seconds
2025-01-23 17:40:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:40:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:11 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:12 - root - INFO - SQL:
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
   FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
   LIMIT 100;
Results:
Too long, hard cut:
customer_id,customer_unique_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade,GO
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel,PR
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia,DF
03f846ad034

2025-01-23 17:40:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:13 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:14 - root - INFO - SQL:
SELECT "order_id", "customer_id", "order_status", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_status,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,invoiced,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,shipped,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4

2025-01-23 17:40:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:15 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:16 - root - INFO - SQL:
SELECT "order_id", "customer_id", "order_status", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   WHERE "order_status" ILIKE '%delivered%'
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_status,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered,2017-07-09 21:57:05
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered,2018-08-04 23:25:30
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9

2025-01-23 17:40:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:17 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:17 - root - INFO - SQL:
SELECT "order_id", "order_item_id", "product_id", "price", "freight_value"
   FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
   LIMIT 100;
Results:
Too long, hard cut:
order_id,order_item_id,product_id,price,freight_value
00010242fe8c5a6d1ba2dd792cb16214,1,4244733e06e7ecb4970a6e2683c13e61,58.9,13.29
00018f77f2f0320c557190d7a144bdd3,1,e5f2d52b802189ee658865ca93d83a8f,239.9,19.93
000229ec398224ef6ca0657da4fc703e,1,c777355d18b72b67abbeef9df44fd0fd,199.0,17.87
00024acbcdf0a6daa1e931b038114c75,1,7634da152a4610f1595efa32f14722fc,12.99,12.79
00042b26cf59d7ce69dfabb4e55b4fd9,1,ac6c3623068f30de03045865e4e10089,199.9,18.14
00048cc3ae777c65dbb7d2a0634bc1ea,1,ef92defde845ab8450f9d70c526ef70f,21.9,12.69
00054e8431b9d7675808bcb819fb4a32,1,8d4f2bb7e93e6710a28f34fa83ee7d28,19.9,11.85
000576fe39319847cbb9d288c5617fa6,1,557d850972a7d6f792fd18ae1400d9b6,810.0,70.75
0005a1a1728c9d785b8e2b08b904576c,1,310ae3c140ff94b03219ad0adc3c778f,145.95,11.65
0005f50442cb953dcd1d21e1fb923495,1,4535b0e1091c278dfd193e5a1d63b39f,53.99,11.4
00061f2a7bc09da83e415a52dc8a4af1,1,d63c1011f49d98b976c352955b1c4bea,59.99,8.88
00063b381e2406b52ad429470734ebd5,1,f177554ea93259a5b282f24e33f65ab6,45.0,12.98
0006ec9db01a64e59a68b2c340bf65a7,1,99a4788cb24856965c36a24e339b6058,74.0,23.32
0008288aa423d2a3f00fcb17cd7d8719,1,368c6c730842d78016ad823897a372db,49.9,13.37
0008288aa423d2a3f00fcb17cd7d8719,2,368c6c730842d78016ad823897a372db,49.9,13.37
0009792311464db532ff765bf7b182ae,1,8cab8abac59158715e0d70a36c807415,99.9,27.65
0009c9a17f916a706d71784483a5d643,1,3f27ac8e699df3d300ec4a5d8c5cf0b2,639.0,11.34
000aed2e25dbad2f9ddb70584c5a2ded,1,4fa33915031a8cde03dd0d3e8fb27f01,144.0,8.77
000c3e6612759851cc3cbb4b83257986,1,b50c950aba0dcead2c48032a690ce817,99.0,13.71
000e562887b1f2006d75e0be9558292e,1,5ed9eaf534f6936b51d0b6c5e4d5c2e9,25.0,16.11
000e63d38ae8c00bbcb5a30573b99628,1,553e0e7590d3116a072507a3635d2877,47.9,8.88
000e906b789b55f64edcb1f84030f90d,1,57d79905de06d8897872c551bfd09358,21.99,11.85
000f25f4d72195062c040b12dce9a18a,1,1c05e0964302b6cf68ca0d15f326c6ba,119.99,44.4
001021efaa8636c29475e7734483457d,1,5d7c23067ed3fc8c6e699b9373d5890b,49.0,15.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,1,5a419dbf24a8c9718fe522b81c69f61a,48.9,16.6
00119ff934e539cf26f92b9ef0cdfed8,1,21b1c2f67a9aafb5af0eb06c13b9dbda,219.9,16.98
0011d82c4b53e22e84023405fb467e57,1,c389f712c4b4510bc997cee93e8b1a28,289.0,26.33
00125cb692d04887809806618a2a145f,1,1c0c0093a48f13ba70d0c6b0a9157cb7,109.9,25.51
00130c0eee84a3d909e75bc08c5c3ca1,1,89321f94e35fc6d7903d36f74e351d40,27.9,7.94
0013503b13da1eac686219390b7d641b,1,38afdf723b95d455b418a0f57d623c6b,119.9,17.32
00137e170939bba5a3134e2386413108,1,672e757f331900b9deea127a2a7b79fd,397.0,24.65
001427c0ec99cf8af737bd88e92fd444,1,28b4eced95a52d9c437a4caf9d311b95,59.9,23.35
00143d0f86d6fbd9f9b38ab440ac16f5,1,e95ee6822b66ac6058e2e4aff656071a,21.33,15.1
00143d0f86d6fbd9f9b38ab440ac16f5,2,e95ee6822b66ac6058e2e4aff656071a,21.33,15.1
00143d0f86d6fbd9f9b38ab440ac16f5,3,e95ee6822b66ac6058e2e4aff656071a,21.33,15.1
0014ae671de39511f7575066200733b7,1,23365beed316535b4105bd800c46670e,16.5,14.1
0015ebb40fb17286bea51d4607c4733c,1,50fd2b788dc166edd20512370dac54df,21.9,15.1
00169e31ef4b29deaae414f9a5e95929,1,b10eba910a974df70b8a12d0665cdb9e,39.0,16.11
0016dfedd97fc2950e388d2971d718c7,1,4089861a1bd4685da70bddd6b4f974f1,49.75,20.8
0017afd5076e074a48f1f1a4c7bac9c5,1,fe59a1e006df3ac42bf0ceb876d70969,809.1,44.29
001862358bf858722e1e2ae000cfed8b,1,c6dd917a0be2a704582055949915ab32,99.99,13.72
0019c29108428acffd089c36103c9440,1,28b4eced95a52d9c437a4caf9d311b95,59.9,19.95
001ab0a7578dd66cd4b0a71f5b6e1e41,1,0b0172eb0fd18479d29c3bc122c058c2,24.89,17.63
001ab0a7578dd66cd4b0a71f5b6e1e41,2,0b0172eb0fd18479d29c3bc122c058c2,24.89,17.63
001ab0a7578dd66cd4b0a71f5b6e1e41,3,0b0172eb0fd18479d29c3bc122c058c2,24.89,17.63
001ac194d4a326a6fa99b581e9a3d963,1,dbaee28f4ee64465838a229582d77520,54.0,8.54
001b76dd48a5b1eee3e87778daa40df8,1,dbb67791e405873b259e4656bf971246,81.99,13.01
001c85b5f68d2be0cb0797afc9e8ce9a,1,84f456958365164420cfc80fbe4c7fab,99.0,13.71
001d8f0e34a38c37f7dba2a37d4eba8b,1,e67307ff0f15ade43fcb6e670be7a74c,18.99,7.78
001d8f0e34a38c37f7dba2a37d4eba8b,2,e67307ff0f15ade43fcb6e670be7a74c,18.99,7.78
001daeb0eddc45b999bad0801ad9d273,1,30c01cc81c9eb80469371743813789cc,38.33,16.79
001dbc16dc51075e987543d23a0507c7,1,777d2e438a1b645f3aec9bd57e92672c,69.9,18.0
001e7ba991be1b19605ca0316e7130f9,1,884fa3cd42986ba480ea2f8ae4e25ff7,195.0,18.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,1,bdcf6a834e8faa30dac3886c7a58e92e,35.9,15.2
0020262c8a370bd5a174ea6a2a267321,1,a5341e3f8155dbb3e62323d3ea289729,79.5,21.05
0020a222f55eb79a372d0efee3cca688,1,e19ddcc85537b41f22116c8d5425ef46,29.99,15.1
002175704e8b209f61b9ad5cfd92b60e,1,e6b6e13cf71449a457269f425b89dc74,109.9,13.21
00229e4e43f7a7e0b9dd819ad43268d3,1,13fcfc313dfb2217e5ee3000a702f9ef,74.9,16.49
0025081dcf9330f9a5052ae82c6ce396,1,4e3f399366b0047a572b6682f9bb166e,14.95,18.23
00254baeb6c932b0a8aeead91fbd02b5,1,18901878788fec7ddc55e64d1ace8187,149.9,43.11
00259a44fcad3fc0474329e925d14fc3,1,0c4d0a08f95c7b7dc5dc7402bfdafd4c,19.99,14.1
0025c5d1a8ca53a240ec2634bb4492ea,1,35537536ed2b4c561b4018bf3abf54e0,390.0,29.39
002611a77fe03d076285fd4ca95db7

2025-01-23 17:40:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:19 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:19 - root - INFO - SQL:
SELECT "order_id", SUM("price") AS "total_order_price"
   FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
   GROUP BY "order_id"
   ORDER BY "total_order_price" DESC
   LIMIT 100;
Results:
order_id,total_order_price
03caa2c082116e1d31e67e9ae3700499,13440.0
736e1922ae60d0d6a89247b851902527,7160.0
0812eb902a67711a1cb742b3cdaa65ae,6735.0
fefacc66af859508bf1a7934eab1e97f,6729.0
f5136e38d1a14a4dbd87dff67da82701,6499.0
2cc9089445046817a7539d90805e6e5a,5934.6
a96610ab360d42a2e5335a3998b4718a,4799.0
199af31afc78c699f0dbf71fb178d4d4,4690.0
b4c4b76c642808cbe472a32b86cddc95,4599.9
8dbc85d1447242f3b127dda390d56e19,4590.0
d2f270487125ddc41fd134c4003ad1d7,4400.0
426a9742b533fc6fed17d1fd6d143d7e,4399.87
68101694e5c5dc7330c91e1bbc36214f,4099.99
b239ca7cd485940b31882363b52e6674,4059.0
86c4eab1571921a6a6e248ed312f5a5a,3999.9
80dfedb6d17bf23539beeef3c768f4d7,3999.0
9a3966c23190dbdbaabed08e8429c006,3980.0
41b7766bb1df487d17fb9725b78ff509,3930.0
9de73f3e6157169ad6c32b9f313c7dcb,3899.0
d3f66901a6743e15f9311547cc623b91,3700.0
e85c92ee6a3ba1ef47e41c23286314d9,3699.99
a53e05ecd2ed1f46a2b8e1f5828be7c6,3690.0
b15c7e972c74684414fb2e659fce916a,3597.0
df85c824523500d4066a0dbdb5d95bed,3549.0
3a4b013e014723cc38c9faa8ffdc6387,3399.99
66b9c991ee308f9342f6a7f63bb68251,3300.0
cb418bb4b6115438d20b0141ed5bc9e0,3198.0
f398a143c0fe171d965db2096cf064cf,3124.0
53c71d3953507c6239ff73917ed358c9,3109.99
1d54db601b417ccdfd3b7071955e6cc7,3105.0
31e50461be6957a749166e97af082d0a,3099.9
4412d97cb2093633afa85f11db46316c,3099.75
94fca82966c05ba707f4e7dc0c50aa3c,3099.0
43bdbd9dc0931d72befdf4765af6c442,3089.0
0af28d87520565eb3b57c9b2abe1a2cc,2999.99
d9956b0805e324db3f2a546ef216c10b,2999.99
4160b6447ad70e6d73f7221dd970bbe9,2999.9
79d3522a0854c853a4979ff2691abd91,2999.89
bd2fef198085db0b586b9c71aa2d35da,2999.89
52e6988a13f9dd7d567b0816dba52a03,2999.89
3c71011c33cf4ba95d18787bdc0e94d3,2999.89
b0b0d3285e59abf2f6c9d7e1bf761323,2999.89
586992f50ed97898737b07970376d19c,2999.0
d7a2c0c1ff66b314f3bf166fb4157fd4,2990.0
f0da489592c62097d0034f139386cb32,2951.0
8171523911786efd1d91c66d69051fcd,2920.0
912343626f370ead5ef2e85a9d757e22,2919.3999999999996
d3fc45461660252856d603ed31eb4e77,2899.0
3c4a05391c2fcd152731f52de8fc4347,2899.0
6fd59e3ae7e24c50131f6bc97c4c7776,2874.0
e8fa22c3673b1dd17ea315021b1f0f61,2849.9
abb71d0110c4be1a1a0c52f929cab4a3,2799.65
362aa88dd1265e7b4ea491b5836fb5f6,2799.0
80d49171762a51f500bf6b774aa24617,2749.65
2ec398158cb686267b1f4b102129098e,2749.0
794c69999774820e22c161f6dc4fef91,2740.0
3745e06e7f01e1652cfd4b9d31651820,2700.0
877a74a0ee5c1f719f39f4f11d2fc19a,2700.0
3dd5626c63f493f8b8f8788c2be24baa,2699.0
de0d8b8e774b3211e7e001d3e5985470,2699.0
da8be3bb62e9bf01e2e1a3bfd74ebd1a,2690.0
afc58387b17fa794fd73b0773a9f6ea7,2690.0
0f924038b00d1f102e4d09bea4fa666a,2689.0
694e3d121f16bcbb9b4595b6c6ab3baf,2680.0
bf205457ee84ab84c423d67b88239982,2649.99
028558cddca332b40b4ac4cb77407edf,2649.99
d0bce34c31d4494a153aa82c468152c4,2649.0
83e6338b5cf25dcf222551cb8da8d0d6,2649.0
242800e82e3e3f0aca252d6e03e4564c,2649.0
fb441bffe443e71cb16477c4743591e8,2600.0
78ce53a063eb2907f9727aac2c678339,2589.0
8ea7aebc18842332aad5f41ca74b334c,2589.0
457ade8093de88b42998c569334a7864,2550.0
0818699476819463109688475b808343,2547.0
122f75d9c2b30dfb21ca6950ec587b90,2520.0
d182d98f09b4277c0d58801e991f7757,2499.99
c28f3a01d4cfee461234c86a41f52e37,2498.0
83167649ca3fb63d1a7daada42232e14,2492.5
8ee5cab30019132affead27f19959ff2,2470.5
39a6ecead949b006d60a132d146ea284,2470.5
a5d11ae16578088b0fcd76de30368bdb,2433.6
880995aee9550ecd4518103daaf74fa0,2428.0
27db1a079a22bec1453d0f24f630005f,2400.0
3b43ab87914ebf7fd563557362108ebd,2400.0
d3e20e12dd625bc8aa36a78636912b0f,2399.8
9f5abaa01d419a15e448f089b1cf4b94,2399.0
acf01c9262ddb5d9adae8daa34e31568,2399.0
558b5f3eea27fa1b4cbc05013c45948e,2399.0
e130d3f737127ae52681b9338aea9b64,2370.0
6d0940a8f5fba47562bb14cd97dfd6da,2350.0
078f6a01964ee122ef20881df839af31,2350.0
eea28d6b80e09bfb00dc1f0640d2de47,2338.08
076d1555fb53a89b0ef4d529e527a0f6,2338.08
3fde74c28a3d5d618c00f26d51baafa0,2338.08
c8536491e6701f9b5382da168ee54048,2300.0
372f8e1a08cbd807194b89b3c31a448a,2300.0
44ecd2ebe54e3c23da26345bfcf1c919,2299.99
f7b13a5afd48ca5bcf589a25d5377b00,2299.95
98464a5096e400810b94bb93f38924c9,2299.95
1fe148272b3216d1704900d718e701bd,2299.95

2025-01-23 17:40:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:21 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:21 - root - INFO - SQL:
SELECT "customer_id", MAX("order_purchase_timestamp") AS "last_purchase_date"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   LIMIT 100;
Results:
Too long, hard cut:
customer_id,last_purchase_date
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
c77ee2d8ba1614a4d489a44166894938,2018-02-19 20:31:09
35ec6c1ca9e5844c5ca94214cce16dca,2018-02-21 17:15:49
456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
68c85132eb3b96fbe6cbddc09a568d24,2017-06-27 23:11:57
86ff82570097f39b2193254f540e4a69,2017-11-17 21:14:42
fbfba770bf13f470f63d1854a765a2d3,2018-01-18 09:30:54
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50
93ada7a24817edda9f4ab998fa823d16,2018-02-27 12:55:42
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18
2c3642e1392097fb4af76a76fec16a46,2018-08-26 11:04:26
b896b244963dc7543d400ad82d6710e0,2017-09-27 12:07:22
6454e6cba392b35aa21527063026fc92,2018-03-07 23:00:33
df5c9e02596851fcbfc98804e4108bbd,2017-12-02 14:28:03
4924a47e8cd5630b3564e26fac55c5ec,2018-07-18 13:39:54
8ed14e450a6268ec13f325e7c2eafeed,2018-02-02 16:15:41
a8331c35b57d8fe09e8df1c06509de29,2018-02-28 17:00:28
243ee97e01766bf68c3e30f0fe572490,2017-06-25 19:30:09
9f5a2f912f123d541a318029712fe90b,2017-09-12 16:32:09
45c9fcdb0cd88a5630cb4405c4d2e4a7,2018-02-27 10:05:56
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14
05e996469a2bf9559c7122b87e156724,2017-08-09 18:32:47
e28087daa16ea2d4ef377fd789af20b4,2018-01-25 23:13:41
6d491c9fe2f04f6e2af6ec033cd8907c,2017-11-17 19:53:21
ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
a559b10d4f093640a0ed4693ce16ed02,2018-04-26 11:59:05
ed8c52327eecff596e141636d5b556d2,2017-11-24 16:56:46
8ebe25aca53cef9a055de5c20eca76e7,2017-12-11 21:43:24
271f76c70ce217ee656713b99097eaef,2018-08-08 10:49:59
4fd75fb5ef1f01c7585bf746092a1544,2018-05-16 16:10:21
a9c6cd6cf9583fa5820d55c21238f78e,2018-05-07 21:49:08
58ffe52cbd8077e75af00321bd152ce2,2018-06-09 11:02:51
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49
d19813c8754cc82d0add67df8bd8a38c,2018-04-03 20:44:15
24d47eeeee1e60eb5caf099281d0b3b8,2018-06-05 11:36:11
7aed8da5ae4e0e34226c47f3bf041956,2017-06-29 00:10:49
de1e5517fb50896bbdcff5814fb31802,2018-02-28 08:57:03
3e87356efef361b40b30fd699f9e5638,2018-03-07 15:37:22
282d52f23f7c0ece9340d411c4d2cdd9,2017-12-01 20:39:26
a207382f0f563c1f430ef732ade9d9ff,2017-05-08 12:22:44
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19
70ab5e994ea383619a19687837eedbbc,2017-10-25 13:32:46
6abf781c5304890987047e9aa239caa8,2018-03-04 15:58:09
229c98245e2b6995b67be1e1921e62d1,2017-08-05 19:30:41
f3223fd3b2517fa73ebb06dd5f1b0e99,2017-09-11 09:40:11
a57a381a12573edc7711887551fc961c,2017-10-12 23:11:44
4913f37a6cb9e2ba061770efb2ea4e58,2017-02-17 17:37:52
3a6586139c630a9648d74d1da4a11cd8,2018-07-01 21:12:33
6b74fa3521fe75edbeff9948022f13d1,2017-05-03 14:31:43
ce0518f0279ef8b73d94633720e70b9f,2017-09-03 15:21:44
d7c4d8b45b0a33ff6df7a3950800d4e8,2018-07-30 18:25:18
3d2b9ce5685b7810c56c6b8babb0432e,2017-11-26 12:15:07
366e99a4996b3f8f781b60d7549f9e38,2018-01-25 19:46:47
511565b2987c19e165331306886f10f8,2017-10-17 15:58:05
f9ed63010ec897e6fb2c5ce868195a18,2018-01-03 16:29:52
f36d397e361b66b7220f849320541fd8,2017-08-31 09:31:20
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52
b59948a7b140d0a16d1683138820eed9,2017-09-11 15:39:11
e7fb8d2c8a581e31b93defd84ee988fe,2018-04-30 11:18:47
993a76ab0714792eb45d4ebdd58e9a1c,2018-01-05 11:04:11
2acac3dfe4fa0e75b07461873a67e7e6,2017-01-27 00:34:10
64e006a132d86c9189f9656a1cb41939,2017-12-06 09:53:36
7e016f9ea275279784f42e0642214284,2017-11-20 16:21:04
933bf00ad9a4f8bfd36bd85e09bd6cba,2017-06-29 23:08:50
ff0a44202beb5310644a0ea439973f4d,2018-08-19 11:28:11
2fdffca8dcdf01547529d45f7f4e8e8f,2018-07-31 20:47:41
a4a00c41b5e3ed88bf0e0bb96576c2b2,2017-12-15 23:33:32
aaaa6531d040b9cef69bf13af9be2fd6,2018-07-25 07:39:35
46ec8bcd9649f0f7bbb179bb59d6702e,2018-07-23 11:30:12
ef21aebbb093a6db29ccc6aa0b89c347,2016-10-05 15:08:00
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18
698e55af1f6f37f7f304a74eb93b85b0,2017-02-26 17:33:51
9a516f56e5f6f198350066cc99339bb0,2018-01-11 12:20:07
33bfc91146c9eea42397a0430585ee59,2017-11-30 13:34:43
7ee968b8ed74301e0cbd3e44416cad9d,2018-03-19 21:50:14
a81e8424b6bfd433cfef8d7bcb36b26d,2018-06-16 18:31:23
fd673a07896aec385c5287234605f166,2017-01-14 15:42:20
bf22881f1f23a79916784ac5b4319c56,2017-04-13 17:26:06
cb1b31ec399f6183dee790a4c349e712,2017-12-01 07:15:07
284e326e8a71e55bdb0b210ddfabaa27,2018-08-06 18:45:01
cb1d99010eebd5ee5b64dc9e37caa9d4,2018-05-18 11:26:45
5c4a6f6b98ec2d780b10f1cc88ef208f,2018-05-02 13:17:54
449057269c318304d8a753f64c181b07,2018-01-04 13:14:34
1f184001b4cbba29eb3ddefd7b0a195b,2017-08-16 08:00:13
ea0b7ca96e72354232c17d72b8bdf66d,2017-03-04 09:55:08
5b6e97fea8528cf0060d86dbd82f9c4a,2018-06-27 16:11:38
6a4ea2081853cd8dd8d7c69cdf86925a,2017-05-11 21:36:10
8ca53db6e60cffad03828535d1fcc1a2,2018-02-27 08:31:17
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01
4cd756c714ca569c2450c24782004147,2017-06-27 17:58:14
d79764082a836f215312d98c964ce478,2018-03

2025-01-23 17:40:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:23 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:23 - root - INFO - SQL:
SELECT o."customer_id", SUM(oi."price") AS "total_spent"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
   GROUP BY o."customer_id"
   ORDER BY "total_spent" DESC
   LIMIT 100;
Results:
customer_id,total_spent
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
e0a2412720e9ea4f26c1ac985f6a7358,4599.9
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
4312e816d88fa8bdb6246878f61cdad5,2999.89
fd78e5e3abdc375368456fe738694c00,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a5c69c3bf293d341b6a56a4b7307c529,2899.0
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
5f87c05477db2d22c63b718299c9c03e,2700.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
a8f345f82667eb421151dc7626147636,2699.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
3690e975641f01bd07ad635f03dbb894,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
03a6f3a3935165f5d26f4797ba6039bb,2492.5
279ca766397588e704abddd56d2dc131,2470.5
9537f2addba8448428a3fd1a1add0656,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
b76816b61d8043a98db57875437da6b5,2400.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
30ab7e538292e6130a456c371778d595,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
177ba55869da8001fcca079af0b85832,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
2b7ae7a532ff538ce88f6bfdd2cb564c,2350.0
f08306b95370e8d5f0d97b71229284b6,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
24301c6ce48874a51221d4e5584a7885,2299.95
9125dbd39c45287dfab9207f3cb15075,2299.95
d791834a0555c0062e98d735083f4373,2299.95

2025-01-23 17:40:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:24 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:25 - root - INFO - SQL:
SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   ORDER BY "order_count" DESC
   LIMIT 100;
Results:
customer_id,order_count
3b6828a50ffe546942b7a473d70ac0fc,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
f54a9f0e6b351c431402b8461ea51999,1
62b423aab58096ca514ba6aa06be2f98,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
3a874b4d4c4b6543206ff5d89287f0c3,1
456dc10730fbdba34615447ea195d643,1
2a1dfb647f32f4390e7b857c67458536,1
816f8653d5361cbf94e58c33f2502a5c,1
3391c4bc11a817e7973e498b0b023158,1
f178c1827f67a8467b0385b7378d951a,1
12fd2740039676063a874b9567dfa651,1
5dda11942d4f77bee3a46d71e442aec4,1
74805bc388861fa350ed2fade8444e0b,1
6772a0a230a2667d16c3620f000e1348,1
2c3642e1392097fb4af76a76fec16a46,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
494dded5b201313c64ed7f100595b95c,1
3187789bec990987628d7a9beb4dd6ac,1
059f7fc5719c7da6cbafe370971a8d70,1
7e20bf5ca92da68200643bda76c504c6,1
fc849c5fbc7e2b0c7cfebc138886c693,1
fb9590a1e30e0ba8304ea73a31325797,1
4c9c7c2b6de6ee2568681b5599bb7495,1
cce89a605105b148387c52e286ac8335,1
636e15840ab051faa13d3f781b6e4233,1
29cb486c739f9774c8eb542e07b56cd2,1
13fd7ce9f08449dec2533119379a2527,1
e8a332c3433fbd37920ec89fc295d075,1
62ffae18a7ca4b2e681c6296180ae346,1
39f944145e00598d075faec0bb1f447a,1
ddaff536587109b89777e0353215e150,1
1833a0540067becaf59368fe4cd4303a,1
38ccd077e65d89b8a720be73bfaa9c6f,1
a2cb2bc236e62cf807925d6cecc245c6,1
a8b396cd7edcd4340e02a07685084cd6,1
2932d241d1f31e6df6c701d52370ae02,1
df9b032b2ad0fd6bf37dfb48e5f83845,1
e28dd4261bed9c7ba89ecaf411b88f7c,1
148348ff65384b4249b762579532e248,1
684fa6da5134b9e4dab731e00011712d,1
68451b39b1314302c08c65a29f1140fc,1
d68901955dc622165460ba6cb4ac49f3,1
83257fb6f3a1edd3a75464178aa3f382,1
eecf2b94cdbe9ef6245fabb5e091c987,1
597950088114c1a9e2b27459051f40ff,1
48f239e15744ed5e7ffbafc6bb6e882b,1
f7398fc942c8fa80e5419ae52e49f7fb,1
b7ee9b824b4a83b389379ac70585bf3b,1
ebfb3f2e532c37d5a959ded000c9f603,1
ac7e3d34240c0ebfc003455c2e04d10a,1
ed8c52327eecff596e141636d5b556d2,1
8ebe25aca53cef9a055de5c20eca76e7,1
19402a48fe860416adf93348aba37740,1
d2b091571da224a1b36412c18bc3bbfe,1
241e78de29b3090cfa1b5d73a8130c72,1
9bdf08b4b3b52b5526ff42d37d47f222,1
4afc1dcca5fe8926fc97d60a4497f8ab,1
8644be24d48806bc3a88fd59fb47ceb1,1
ef15b3240b2083e0487762ee2978d2b8,1
9f5a2f912f123d541a318029712fe90b,1
148ecba880f508ca2d5b6744b6a7b6c5,1
167b9485947ed0a354a3f8dad04eb199,1
bf141bf67fbe428d558bcf0e018eab60,1
4f28355e5c17a4a42d3ce2439a1d4501,1
48558a50a7ba1aab61891936d2ca7681,1
57ee2ef64f17a5f9a4bf30489b06326c,1
72ae281627a6102d9b3718528b420f8a,1
22eb8142d6313bab19fa6c657170ae6b,1
0dd5a932b1e29daa12845dbf696cbb54,1
68c85132eb3b96fbe6cbddc09a568d24,1
5cff2efe34e8e604619520cc86201235,1
03b3813a78be4cf5205e70977ad78d29,1
503740e9ca751ccdda7ba28e9ab8f608,1
a166da34890074091a942054b36e4265,1
756fb9391752dad934e0fe3733378e57,1
81e08b08e5ed4472008030d70327c71f,1
0b9e85491c194a97516c87f30a93abfa,1
2b47ff70d422cc3ada976dea40f48782,1
d4c5a2a1316f738e72e179d6bb3b6d8f,1
31ad1d1b63eb9962463f764d4e6e0c9d,1
d3e3b74c766bc6214e0c830b17ee2341,1
8b212b9525f9e74e85e37ed6df37693e,1
9b18f3fc296990b97854e351334a32f6,1
05e996469a2bf9559c7122b87e156724,1
a51b373c427132a77b112ca10f502c4f,1
738b086814c6fcc74b8cc583f8516ee3,1
52142aa69d8d0e1247ab0cada0f76023,1
eb1c0e1ca3e17eccaefb7f0d4dc659b1,1
b896b244963dc7543d400ad82d6710e0,1
295ae9b35379e077273387ff64354b6f,1
3df704f53d3f1d4818840b34ec672a9f,1
41ce2a54c0b03bf3443c3d931a367089,1
9ef432eb6251297304e76186b10a928d,1
332df68ccac2f2f7d9e11299188f8bce,1
c77ee2d8ba1614a4d489a44166894938,1
f5afca14dfa9dc64251cf2b45c54c363,1
4fa1cd166fa598be6de80fa84eaade43,1
ed0271e0b7da060a393796590e7b737a,1
f88197465ea7920adcdbec7375364d82,1

2025-01-23 17:40:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:27 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:27 - root - INFO - SQL:
SELECT o."customer_id", SUM(oi."price") / COUNT(DISTINCT o."order_id") AS "avg_sales_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
   GROUP BY o."customer_id"
   ORDER BY "avg_sales_per_order" DESC
   LIMIT 100;
Results:
customer_id,avg_sales_per_order
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
e0a2412720e9ea4f26c1ac985f6a7358,4599.9
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
fd78e5e3abdc375368456fe738694c00,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
a5c69c3bf293d341b6a56a4b7307c529,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
5f87c05477db2d22c63b718299c9c03e,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
8401401a8752eb431189e021b8009e37,2649.99
695476b5848d64ba0875324c88390206,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
3690e975641f01bd07ad635f03dbb894,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
03a6f3a3935165f5d26f4797ba6039bb,2492.5
279ca766397588e704abddd56d2dc131,2470.5
9537f2addba8448428a3fd1a1add0656,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
233d97d412c7f4bb8d857ec922c0317f,2399.0
177ba55869da8001fcca079af0b85832,2399.0
30ab7e538292e6130a456c371778d595,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
2b7ae7a532ff538ce88f6bfdd2cb564c,2350.0
f08306b95370e8d5f0d97b71229284b6,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
d791834a0555c0062e98d735083f4373,2299.95
24301c6ce48874a51221d4e5584a7885,2299.95

2025-01-23 17:40:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-01-23 17:40:28 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:29 - root - INFO - SQL:
SELECT DISTINCT "order_status"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    LIMIT 100;
Results:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved

2025-01-23 17:40:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-01-23 17:40:30 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:31 - root - INFO - SQL:
SELECT "order_status", COUNT("order_id") AS "order_count"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "order_status"
    ORDER BY "order_count" DESC
    LIMIT 100;
Results:
order_status,order_count
delivered,96478
shipped,1107
canceled,625
unavailable,609
invoiced,314
processing,301
created,5
approved,2

2025-01-23 17:40:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:32 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:33 - root - INFO - SQL:
SELECT "customer_id", MIN("order_purchase_timestamp") AS "first_purchase_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "customer_id"
    LIMIT 100;
Results:
Too long, hard cut:
customer_id,first_purchase_date
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
c77ee2d8ba1614a4d489a44166894938,2018-02-19 20:31:09
35ec6c1ca9e5844c5ca94214cce16dca,2018-02-21 17:15:49
456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
68c85132eb3b96fbe6cbddc09a568d24,2017-06-27 23:11:57
86ff82570097f39b2193254f540e4a69,2017-11-17 21:14:42
fbfba770bf13f470f63d1854a765a2d3,2018-01-18 09:30:54
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50
93ada7a24817edda9f4ab998fa823d16,2018-02-27 12:55:42
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18
2c3642e1392097fb4af76a76fec16a46,2018-08-26 11:04:26
b896b244963dc7543d400ad82d6710e0,2017-09-27 12:07:22
6454e6cba392b35aa21527063026fc92,2018-03-07 23:00:33
df5c9e02596851fcbfc98804e4108bbd,2017-12-02 14:28:03
4924a47e8cd5630b3564e26fac55c5ec,2018-07-18 13:39:54
8ed14e450a6268ec13f325e7c2eafeed,2018-02-02 16:15:41
a8331c35b57d8fe09e8df1c06509de29,2018-02-28 17:00:28
243ee97e01766bf68c3e30f0fe572490,2017-06-25 19:30:09
9f5a2f912f123d541a318029712fe90b,2017-09-12 16:32:09
45c9fcdb0cd88a5630cb4405c4d2e4a7,2018-02-27 10:05:56
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14
05e996469a2bf9559c7122b87e156724,2017-08-09 18:32:47
e28087daa16ea2d4ef377fd789af20b4,2018-01-25 23:13:41
6d491c9fe2f04f6e2af6ec033cd8907c,2017-11-17 19:53:21
ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
a559b10d4f093640a0ed4693ce16ed02,2018-04-26 11:59:05
ed8c52327eecff596e141636d5b556d2,2017-11-24 16:56:46
8ebe25aca53cef9a055de5c20eca76e7,2017-12-11 21:43:24
271f76c70ce217ee656713b99097eaef,2018-08-08 10:49:59
4fd75fb5ef1f01c7585bf746092a1544,2018-05-16 16:10:21
a9c6cd6cf9583fa5820d55c21238f78e,2018-05-07 21:49:08
58ffe52cbd8077e75af00321bd152ce2,2018-06-09 11:02:51
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49
d19813c8754cc82d0add67df8bd8a38c,2018-04-03 20:44:15
24d47eeeee1e60eb5caf099281d0b3b8,2018-06-05 11:36:11
7aed8da5ae4e0e34226c47f3bf041956,2017-06-29 00:10:49
de1e5517fb50896bbdcff5814fb31802,2018-02-28 08:57:03
3e87356efef361b40b30fd699f9e5638,2018-03-07 15:37:22
282d52f23f7c0ece9340d411c4d2cdd9,2017-12-01 20:39:26
a207382f0f563c1f430ef732ade9d9ff,2017-05-08 12:22:44
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19
70ab5e994ea383619a19687837eedbbc,2017-10-25 13:32:46
6abf781c5304890987047e9aa239caa8,2018-03-04 15:58:09
229c98245e2b6995b67be1e1921e62d1,2017-08-05 19:30:41
f3223fd3b2517fa73ebb06dd5f1b0e99,2017-09-11 09:40:11
a57a381a12573edc7711887551fc961c,2017-10-12 23:11:44
4913f37a6cb9e2ba061770efb2ea4e58,2017-02-17 17:37:52
3a6586139c630a9648d74d1da4a11cd8,2018-07-01 21:12:33
6b74fa3521fe75edbeff9948022f13d1,2017-05-03 14:31:43
ce0518f0279ef8b73d94633720e70b9f,2017-09-03 15:21:44
d7c4d8b45b0a33ff6df7a3950800d4e8,2018-07-30 18:25:18
3d2b9ce5685b7810c56c6b8babb0432e,2017-11-26 12:15:07
366e99a4996b3f8f781b60d7549f9e38,2018-01-25 19:46:47
511565b2987c19e165331306886f10f8,2017-10-17 15:58:05
f9ed63010ec897e6fb2c5ce868195a18,2018-01-03 16:29:52
f36d397e361b66b7220f849320541fd8,2017-08-31 09:31:20
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52
b59948a7b140d0a16d1683138820eed9,2017-09-11 15:39:11
e7fb8d2c8a581e31b93defd84ee988fe,2018-04-30 11:18:47
993a76ab0714792eb45d4ebdd58e9a1c,2018-01-05 11:04:11
2acac3dfe4fa0e75b07461873a67e7e6,2017-01-27 00:34:10
64e006a132d86c9189f9656a1cb41939,2017-12-06 09:53:36
7e016f9ea275279784f42e0642214284,2017-11-20 16:21:04
933bf00ad9a4f8bfd36bd85e09bd6cba,2017-06-29 23:08:50
ff0a44202beb5310644a0ea439973f4d,2018-08-19 11:28:11
2fdffca8dcdf01547529d45f7f4e8e8f,2018-07-31 20:47:41
a4a00c41b5e3ed88bf0e0bb96576c2b2,2017-12-15 23:33:32
aaaa6531d040b9cef69bf13af9be2fd6,2018-07-25 07:39:35
46ec8bcd9649f0f7bbb179bb59d6702e,2018-07-23 11:30:12
ef21aebbb093a6db29ccc6aa0b89c347,2016-10-05 15:08:00
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18
698e55af1f6f37f7f304a74eb93b85b0,2017-02-26 17:33:51
9a516f56e5f6f198350066cc99339bb0,2018-01-11 12:20:07
33bfc91146c9eea42397a0430585ee59,2017-11-30 13:34:43
7ee968b8ed74301e0cbd3e44416cad9d,2018-03-19 21:50:14
a81e8424b6bfd433cfef8d7bcb36b26d,2018-06-16 18:31:23
fd673a07896aec385c5287234605f166,2017-01-14 15:42:20
bf22881f1f23a79916784ac5b4319c56,2017-04-13 17:26:06
cb1b31ec399f6183dee790a4c349e712,2017-12-01 07:15:07
284e326e8a71e55bdb0b210ddfabaa27,2018-08-06 18:45:01
cb1d99010eebd5ee5b64dc9e37caa9d4,2018-05-18 11:26:45
5c4a6f6b98ec2d780b10f1cc88ef208f,2018-05-02 13:17:54
449057269c318304d8a753f64c181b07,2018-01-04 13:14:34
1f184001b4cbba29eb3ddefd7b0a195b,2017-08-16 08:00:13
ea0b7ca96e72354232c17d72b8bdf66d,2017-03-04 09:55:08
5b6e97fea8528cf0060d86dbd82f9c4a,2018-06-27 16:11:38
6a4ea2081853cd8dd8d7c69cdf86925a,2017-05-11 21:36:10
8ca53db6e60cffad03828535d1fcc1a2,2018-02-27 08:31:17
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01
4cd756c714ca569c2450c24782004147,2017-06-27 17:58:14
d79764082a836f215312d98c964ce478,2018-0

2025-01-23 17:40:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:34 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:34 - root - INFO - SQL:
SELECT o."customer_id", SUM(oi."price") AS "total_spent_delivered"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    GROUP BY o."customer_id"
    ORDER BY "total_spent_delivered" DESC
    LIMIT 100;
Results:
customer_id,total_spent_delivered
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
fd78e5e3abdc375368456fe738694c00,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a5c69c3bf293d341b6a56a4b7307c529,2899.0
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
5f87c05477db2d22c63b718299c9c03e,2700.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b177ef267a4377b77e0620d1a7f08dce,2649.0
b1c28f9b72d07054b64d09e487b5021c,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
30ab7e538292e6130a456c371778d595,2399.0
177ba55869da8001fcca079af0b85832,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
f08306b95370e8d5f0d97b71229284b6,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
e683dddabd8f5c3ad3708a3364e932f8,2300.0
f767e7437c3aa2c044523c0a6712380b,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0

2025-01-23 17:40:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:36 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:36 - root - INFO - SQL:
SELECT "customer_id", COUNT(DISTINCT "order_id") AS "delivered_order_count"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" ILIKE '%delivered%'
    GROUP BY "customer_id"
    ORDER BY "delivered_order_count" DESC
    LIMIT 100;
Results:
customer_id,delivered_order_count
f54a9f0e6b351c431402b8461ea51999,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
503740e9ca751ccdda7ba28e9ab8f608,1
19402a48fe860416adf93348aba37740,1
494dded5b201313c64ed7f100595b95c,1
3b6828a50ffe546942b7a473d70ac0fc,1
059f7fc5719c7da6cbafe370971a8d70,1
ddaff536587109b89777e0353215e150,1
72ae281627a6102d9b3718528b420f8a,1
756fb9391752dad934e0fe3733378e57,1
f5618502bee8eafdee72fb6955e2ebdf,1
569cf68214806a39acc0f39344aea67f,1
9f6618c17568ac301465fe7ad056c674,1
fee181bf648906d1c57f84f216976286,1
fb9590a1e30e0ba8304ea73a31325797,1
62ffae18a7ca4b2e681c6296180ae346,1
5883f965ac70043c2e908c3657c5d548,1
d9ef95f98d8da3b492bb8c0447910498,1
2a1dfb647f32f4390e7b857c67458536,1
f5afca14dfa9dc64251cf2b45c54c363,1
684fa6da5134b9e4dab731e00011712d,1
328d7a69cb9cbaf088eed3ed778804bb,1
4afc1dcca5fe8926fc97d60a4497f8ab,1
6772a0a230a2667d16c3620f000e1348,1
456dc10730fbdba34615447ea195d643,1
911e4c37f5cafe1604fe6767034bf1ae,1
295ae9b35379e077273387ff64354b6f,1
3df704f53d3f1d4818840b34ec672a9f,1
8628fac2267e8c8804525da99c10ed0e,1
e8a332c3433fbd37920ec89fc295d075,1
c572fd6cdd98e87ea2bc433b6da21078,1
eb1c0e1ca3e17eccaefb7f0d4dc659b1,1
f178c1827f67a8467b0385b7378d951a,1
d19f254a07da73a055409256e9bfe40a,1
ed8c52327eecff596e141636d5b556d2,1
48558a50a7ba1aab61891936d2ca7681,1
62b423aab58096ca514ba6aa06be2f98,1
4f28355e5c17a4a42d3ce2439a1d4501,1
9b18f3fc296990b97854e351334a32f6,1
241e78de29b3090cfa1b5d73a8130c72,1
4632eb5a8f175f6fe020520ae0c678f3,1
3135962ee745ef39b85576df7ddbaa99,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
d0e6cb83a3fc27f56be011b2941f54c6,1
2528510465c7572dedee4431a7d52e08,1
330ca6b207006779da875ef48faef608,1
eecf2b94cdbe9ef6245fabb5e091c987,1
b53cc3c992caaa45ec73cfdde4d839b5,1
02ed2cff54eb047cdbe79dd0535945d4,1
b6f05b99667a02c3722610a7bb6b4062,1
e5b70244ffbbac9f5ebde9ecdfc049f9,1
0f5b40f9925b49675464fb74869c6547,1
8dd1c4e88c1db62830ab1f7c56b6ee42,1
d2b091571da224a1b36412c18bc3bbfe,1
cf8ffeddf027932e51e4eae73b384059,1
74805bc388861fa350ed2fade8444e0b,1
be8c14c16a4d47194ccdfe10f1fc5b1a,1
8644be24d48806bc3a88fd59fb47ceb1,1
bb2f5e670f7155dc622c57e4b31d0a69,1
5bb39c890c91b1d26801aa19a9336eac,1
d0e71d7a6dbca8ac513ac63d08a81fa0,1
dd5095632e3953fc0947b8ab5176b0be,1
a8b396cd7edcd4340e02a07685084cd6,1
ef15b3240b2083e0487762ee2978d2b8,1
68c85132eb3b96fbe6cbddc09a568d24,1
a78b75a2ad06180de06b82857ca442b3,1
167b9485947ed0a354a3f8dad04eb199,1
df5c9e02596851fcbfc98804e4108bbd,1
c1ddb7521d14db9071dccad0a94305c2,1
3a874b4d4c4b6543206ff5d89287f0c3,1
1833a0540067becaf59368fe4cd4303a,1
243ee97e01766bf68c3e30f0fe572490,1
4fa1cd166fa598be6de80fa84eaade43,1
cce89a605105b148387c52e286ac8335,1
7f2178c5d771e17f507d3c1637339298,1
2c3642e1392097fb4af76a76fec16a46,1
2b56e94c2f66f2d97cfa63356f69cee8,1
afb19a4b667cb708caab312757ec3d3f,1
93ada7a24817edda9f4ab998fa823d16,1
e1862648f338ecaf4242e8e2b59126ca,1
aa3d8c9eec8e52e90b117efe5e97a560,1
57ee2ef64f17a5f9a4bf30489b06326c,1
7711cf624183d843aafe81855097bc37,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
79183cd650e2bb0d475b0067d45946ac,1
f26a435864aebedff7f7c84f82ee229f,1
4c9c7c2b6de6ee2568681b5599bb7495,1
8b212b9525f9e74e85e37ed6df37693e,1
7251aa758779438faea714941f1051c4,1
cf9e2b07f78cce347089900f49fb4746,1
816f8653d5361cbf94e58c33f2502a5c,1
9bdf08b4b3b52b5526ff42d37d47f222,1
41ce2a54c0b03bf3443c3d931a367089,1
9ef432eb6251297304e76186b10a928d,1
5dda11942d4f77bee3a46d71e442aec4,1
148348ff65384b4249b762579532e248,1
55e6b290205c84ddd23ddf5eb134efd4,1
d3e3b74c766bc6214e0c830b17ee2341,1
8ab97904e6daea8866dbdbc4fb7aad2c,1
f88197465ea7920adcdbec7375364d82,1

2025-01-23 17:40:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:38 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:38 - root - INFO - SQL:
SELECT "customer_id", MIN("order_purchase_timestamp") AS "first_purchase", MAX("order_purchase_timestamp") AS "last_purchase"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "customer_id"
    LIMIT 100;
Results:
Too long, hard cut:
customer_id,first_purchase,last_purchase
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
a9d37ddc8ba4d9f6dbac7d8ec378cc95,2018-07-15 08:33:19,2018-07-15 08:33:19
f26a435864aebedff7f7c84f82ee229f,2017-07-30 03:06:35,2017-07-30 03:06:35
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
388025bec8128ff20ec1a316ed4dcf02,2017-04-20 17:15:46,2017-04-20 17:15:46
d0e71d7a6dbca8ac513ac63d08a81fa0,2018-04-25 22:18:10,2018-04-25 22:18:10
5232c22d7ed2b631db6b2cab74b2c5f2,2018-08-01 10:48:19,2018-08-01 10:48:19
5dda11942d4f77bee3a46d71e442aec4,2018-01-07 21:44:54,2018-01-07 21:44:54
e8a332c3433fbd37920ec89fc295d075,2017-09-29 09:32:17,2017-09-29 09:32:17
4c9c7c2b6de6ee2568681b5599bb7495,2018-05-08 22:12:34,2018-05-08 22:12:34
fa5c31ea5a141cb29a683b6420f2693a,2017-09-20 17:12:34,2017-09-20 17:12:34
f7398fc942c8fa80e5419ae52e49f7fb,2018-04-15 19:42:06,2018-04-15 19:42:06
a338f42b6e47cb49d5c5128a348b76ba,2018-05-15 19:55:51,2018-05-15 19:55:51
56dfafb543cfa4c2edcc08b9b2c5f0c6,2017-08-01 18:52:12,2017-08-01 18:52:12
b3519c0352b07bc3017acebea4ce6724,2017-11-16 14:32:06,2017-11-16 14:32:06
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14,2018-05-08 14:38:14
ed532487db04478dfba09d112649fc13,2018-02-01 07:47:34,2018-02-01 07:47:34
86acfb656743da0c113d176832c9d535,2018-02-08 18:56:45,2018-02-08 18:56:45
64a254d30eed42cd0e6c36dddb88adf0,2017-11-16 15:09:28,2017-11-16 15:09:28
977275bd3cd425aa9926a3388658f485,2018-03-09 14:58:05,2018-03-09 14:58:05
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49,2017-11-11 22:16:49
53379b14e4048e025dc5a2185f461bb7,2018-03-27 22:14:59,2018-03-27 22:14:59
da2fbad9b2235c67c9bc7c7a274ee389,2018-08-03 13:32:54,2018-08-03 13:32:54
b7b15ab12fa50616eee696a22f098e07,2017-01-21 17:08:01,2017-01-21 17:08:01
5d6e19aed6284c2fcb4b1a0eba6820de,2018-08-21 16:45:44,2018-08-21 16:45:44
ffdc2af7160aed3bad21cbc8ec68c0c5,2017-05-20 02:48:00,2017-05-20 02:48:00
5265029daa29cc08d86b9f96cd99d03f,2018-04-18 15:40:36,2018-04-18 15:40:36
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19,2018-03-29 22:46:19
364fbe9334877bc7ca3da92913b2cdbf,2017-06-02 14:00:19,2017-06-02 14:00:19
610a4163b8ab832daf93b4fbb48e9119,2017-11-19 16:12:34,2017-11-19 16:12:34
2f9902d85fcd930227f711cf47012bdf,2017-05-10 14:03:27,2017-05-10 14:03:27
940526d0df4938d234d0a900268106c4,2017-08-28 22:47:13,2017-08-28 22:47:13
9c338ea8093192e203bc16add78c123c,2017-11-21 12:08:32,2017-11-21 12:08:32
a4156bb8aff5d6722dc68f605d8fa241,2017-09-26 11:08:38,2017-09-26 11:08:38
ddbd5d378c4a0981ba1ef29fb8e40b8f,2017-09-13 15:07:45,2017-09-13 15:07:45
d44c356f894fa28cffe33c455abb72ba,2017-08-17 17:03:31,2017-08-17 17:03:31
24c63a7108d652ad0ed85589c4575297,2018-06-13 22:54:20,2018-06-13 22:54:20
18c934f4cdc994cd04eb13bce3f47a18,2018-02-02 15:26:38,2018-02-02 15:26:38
f31eb05ebdef1ede72cebeba759e7c92,2018-08-06 22:25:10,2018-08-06 22:25:10
021e84751ba0ead75b6d314a6ead88d9,2017-08-01 18:17:41,2017-08-01 18:17:41
1f7945736d0f303827055ca99168ad20,2017-04-03 23:09:50,2017-04-03 23:09:50
016c5c3fb572754f302fdac24aa9cfa4,2018-06-04 08:33:09,2018-06-04 08:33:09
5072cf2f4cbec30b8ba917d5d7b6b125,2017-04-27 14:17:37,2017-04-27 14:17:37
40eb5b16b04bc62c59d4905857958e82,2017-10-31 21:47:13,2017-10-31 21:47:13
e54367d4b00c5cb76d2dfe71b9bdb89c,2018-07-04 16:49:21,2018-07-04 16:49:21
c5064807abdc55acd37860160154ed1a,2018-08-27 13:57:36,2018-08-27 13:57:36
90714b0e62fe1fbd304fb45fd644ebdd,2018-02-24 08:45:01,2018-02-24 08:45:01
17ebae22126d3df35f5e1fa1efedab94,2018-05-17 07:17:54,2018-05-17 07:17:54
5957d9ae822bcbe88c00fb8286362339,2018-03-01 12:43:37,2018-03-01 12:43:37
32fa597a3b06db1949ee96c416335b6b,2018-03-01 20:30:22,2018-03-01 20:30:22
80f70f0ca0bcd19bf71e848e51206d68,2017-07-12 18:45:24,2017-07-12 18:45:24
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52,2017-07-04 23:29:52
08fe63b02e7e846c85b8a49b9fd540d9,2018-02-15 11:58:49,2018-02-15 11:58:49
99ae056139c928155fbb6789440c8824,2018-07-31 21:51:41,2018-07-31 21:51:41
6c5aeca0152670c75e44c9c67eb7c1f3,2018-01-22 15:24:44,2018-01-22 15:24:44
cb1e2bf26acb98ef66bb11447a218cc2,2017-02-25 14:34:40,2017-02-25 14:34:40
d436bce514752338004b26a232f21008,2018-05-16 13:47:51,2018-05-16 13:47:51
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01,2017-06-19 18:00:01
88196bd808ae8abe1b944efe1807b508,2017-11-19 20:06:12,2017-11-19 20:06:12
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18,2018-08-02 12:25:18
f1b66f0324a631de414bc2bf62b5e915,2018-06-23 19:29:12,2018-06-23 19:2

2025-01-23 17:40:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:40:39 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:40:40 - root - INFO - SQL:
SELECT o."customer_id", SUM(oi."price") / COUNT(DISTINCT o."order_id") AS "avg_order_value_delivered"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    GROUP BY o."customer_id"
    ORDER BY "avg_order_value_delivered" DESC
    LIMIT 100;
Results:
customer_id,avg_order_value_delivered
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
10a86619816f9d2afce3f45b04aabc71,2999.99
0a209a88c2e3dc2981c79ad85c558059,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
fd78e5e3abdc375368456fe738694c00,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
a5c69c3bf293d341b6a56a4b7307c529,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
5f87c05477db2d22c63b718299c9c03e,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
0c5292f5e3690805390efddf53935915,2600.0
349509b216bd5ec11c5fae929fd13595,2589.0
e9859fbdff7d26c36c228cf60796e844,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
177ba55869da8001fcca079af0b85832,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
30ab7e538292e6130a456c371778d595,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
f08306b95370e8d5f0d97b71229284b6,2338.08
e683dddabd8f5c3ad3708a3364e932f8,2300.0
f767e7437c3aa2c044523c0a6712380b,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0

2025-01-23 17:40:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:40:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:40:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:40:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 17:40:41 - snowflake.connector.connection - INFO - closed
2025-01-23 17:40:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:41:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:41:20 - root - INFO - ```sql
SELECT o."customer_id", AVG(oi_totals."order_total") AS "avg_order_value_delivered"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT "order_id", SUM("price") AS "order_total"
    FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
    GROUP BY "order_id"
) oi_totals ON o."order_id" = oi_totals."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY o."customer_id"
ORDER BY "avg_order_value_delivered" DESC
LIMIT 100;
```
2025-01-23 17:41:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:41:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:41:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:41:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:41:21 - snowflake.connector.connection - INFO - closed
2025-01-23 17:41:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:41:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:41:53 - root - INFO - SQL:
SELECT o."customer_id", AVG(oi_totals."order_total") AS "avg_order_value_delivered"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT "order_id", SUM("price") AS "order_total"
    FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
    GROUP BY "order_id"
) oi_totals ON o."order_id" = oi_totals."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY o."customer_id"
ORDER BY "avg_order_value_delivered" DESC
LIMIT 100;
Results:
customer_id,avg_order_value_delivered
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
fd78e5e3abdc375368456fe738694c00,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
a5c69c3bf293d341b6a56a4b7307c529,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
5f87c05477db2d22c63b718299c9c03e,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b177ef267a4377b77e0620d1a7f08dce,2649.0
b1c28f9b72d07054b64d09e487b5021c,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
b76816b61d8043a98db57875437da6b5,2400.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
177ba55869da8001fcca079af0b85832,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
30ab7e538292e6130a456c371778d595,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
f08306b95370e8d5f0d97b71229284b6,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0

2025-01-23 17:41:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:41:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:41:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:41:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:41:54 - snowflake.connector.connection - INFO - closed
2025-01-23 17:41:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:41:55 - root - INFO - SQL:
-- Corrected Query 1
SELECT DISTINCT oi."product_id", oi."order_id"
FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON o."order_id" = oi."order_id"
WHERE o."order_status" = 'delivered'
LIMIT 100
Results:
Too long, hard cut:
product_id,order_id
4244733e06e7ecb4970a6e2683c13e61,00010242fe8c5a6d1ba2dd792cb16214
e5f2d52b802189ee658865ca93d83a8f,00018f77f2f0320c557190d7a144bdd3
ef92defde845ab8450f9d70c526ef70f,00048cc3ae777c65dbb7d2a0634bc1ea
4535b0e1091c278dfd193e5a1d63b39f,0005f50442cb953dcd1d21e1fb923495
d63c1011f49d98b976c352955b1c4bea,00061f2a7bc09da83e415a52dc8a4af1
f177554ea93259a5b282f24e33f65ab6,00063b381e2406b52ad429470734ebd5
99a4788cb24856965c36a24e339b6058,0006ec9db01a64e59a68b2c340bf65a7
3f27ac8e699df3d300ec4a5d8c5cf0b2,0009c9a17f916a706d71784483a5d643
1c05e0964302b6cf68ca0d15f326c6ba,000f25f4d72195062c040b12dce9a18a
38afdf723b95d455b418a0f57d623c6b,0013503b13da1eac686219390b7d641b
b10eba910a974df70b8a12d0665cdb9e,00169e31ef4b29deaae414f9a5e95929
28b4eced95a52d9c437a4caf9d311b95,0019c29108428acffd089c36103c9440
4e3f399366b0047a572b6682f9bb166e,0025081dcf9330f9a5052ae82c6ce396
430d215740da7fdda91cc938f8fd92f6,002691433f09002ac9ca0c4e8dbb8ead
6490b9f63b0b595e1c1402b46b0f50ad,00275bce676303c3bfd7292aefdfa223
c2ece64199af7a53793ed9612a89a8cd,002af7fa9eb99d1456bceb6a13d6fc0b
d9c01b484ada6a360c2715a08fdf1568,00584d79015452d19fd3d044ba3abdc0
4089861a1bd4685da70bddd6b4f974f1,0016dfedd97fc2950e388d2971d718c7
777d2e438a1b645f3aec9bd57e92672c,001dbc16dc51075e987543d23a0507c7
df3655ac9aa8c6cbfa63bdd8d3b09c50,002834535f7a609a5c68266f173fa59e
54e5063e43f27f747d592eb24e913150,00324b3eda39ba5ecce3945823e3594c
0f80705139ce16ea35bb489987399b55,0072847849eafe70995fa51a714c81ac
f71a7c95a86564873cd996896b2976f6,008c3a655c66f4d92370d0d422732f69
cbecf0dca7a42c56c9ad9e20c74af1fd,00921e4911895b93c7b4fc0d80c0815e
ac6c3623068f30de03045865e4e10089,00042b26cf59d7ce69dfabb4e55b4fd9
310ae3c140ff94b03219ad0adc3c778f,0005a1a1728c9d785b8e2b08b904576c
21b1c2f67a9aafb5af0eb06c13b9dbda,00119ff934e539cf26f92b9ef0cdfed8
892832da5b05b0f54578e1f14f193c22,0026a368634b6e6f34f33b1499773a30
656e0eca68dcecf6a31b8ececfabe3e8,003f201cdd39cdd59b6447cff2195456
01cf56cd6138b926a4802d16fc304149,0044c6f6d22dd280534344177c81b989
2fb0efd1f61f186ffdda9e8ec70f27f2,0066a1fdaee16ad5022c5ef979d0b661
0ec7b6a863e219792bc4d50d3a62a839,007bbb40c95870c0f75a7855f2636c65
4bc3ab2ff016887e619e587a993af3bf,003f9bcc09427647c4b9d361a523545b
e1c0a39b7f806727ea5121c60035ed3c,0081ab2c99dc85945c28926b77dc6960
36826c711e5778c8d88a7311cc29c446,009838529bb913846ab6670d22865381
4834f24983a4f056e5ae64265f723aaf,00a1e977cf6e672402963940db55d919
c2ece64199af7a53793ed9612a89a8cd,00a690becda145533fa5a54daa7b6ad5
617186c3d97ea56c9c683a8a3974e8c1,009fa9bd0d92710e840793bfefa80867
6536314c94d43b787fc1c622941da14b,00a843f5a80c7aea894c558acc29f513
437c05a395e9e47f9762e677a7068ce7,00b8d354b36820e9d6131fd5173c5581
6131240aedf34224270cd6f07e8229e4,00c42b1633c1b2fa4e937bf312466561
2ffb8b836bb62d53a77a69a67814fffa,00c9d9e61ed13f5bf2f0344da1aa4775
4f3b83b83f7fb280fca4f90ba502f50e,00dfb074b5c910fbd08e04691c4b712f
69c5919a1b057b3d3d8b58f3b9b4b89d,00f426c7214575822c3cb44ea59ef0f6
9f69acd4da62618a3f6365b732d00ccd,011080783e02d05b26c8c158b3653a42
e8ca1ff2d0a28edb5be8bfbf2964dc3a,0113c9989fe6e5007795daec0633b405
dea3de7c4e7aa375d564fa2ddb7099b7,011af0959ebf2b09a062867811dc63b5
0c7ec2b24166d57ac38a9db523711782,012ea594e035047289b3e7c3f8b90cef
cc47c0863559499f01b4cad750929d10,002b430ff89b3a24c31a1170acbbedea
2948658cb6abc82847412be7201bfc4c,005997dca4c1fc45066d0a03d54a6469
03bb24d19ea7449ce170e0888d830707,005e5166e99d1e4d0c4f808b0540ba94
fa11ecd35f999783e96ac500532d9d45,0064d74f7de7917d54768d7722ad56ac
19421075ae0b585f2dc13ff149e2119d,0079bca8e89bd52fdb87408e4f3fb94d
a8115d34a4b7b74388da609692162c37,008990da719764fb392914d8ab53ad04
779559842fc122d55edbd03153f35e81,007ec946d4f798caf2b43c9d44c56421
bf06a69bb27c58156391de458700f3e7,0091a677651feaf5a08d7bb147681e14
d64e758afad411049a45e42c9a259241,0094bd07f49fed90209ffa62d1ef26d6
3cb39171fd36c50097f2dedbbe0dfe6e,011405ae7b89def8ffb3468eb29c299d
e3a23a99f074226ad690393a840c3244,012e93f8170eb75b2f2f650629d04517
8ef8561be5799da29925c5baaf083a13,014ac3cfd0e55bdc2cdd12aa181b00cb
2b0ee2d07306f7c9ac55a43166e9bb4b,019636907d07b2433be000d9d6bed153
c6dd917a0be2a704582055949915ab32,001862358bf858722e1e2ae000cfed8b
553e0e7590d3116a072507a3635d2877,000e63d38ae8c00bbcb5a30573b99628
fe59a1e006df3ac42bf0ceb876d70969,0017afd5076e074a48f1f1a4c7bac9c5
00ffe57f0110d73fd84d162252b2c784,0071ee2429bc1efdc43aa3e073a5290e
55782cb82e0efe052da0a3da237da3b2,0096668e5b0b8e9657a6f7209a4e58b4
5d7c23067ed3fc8c6e699b9373d5890b,001021efaa8636c29475e7734483457d
7614c62b86a81021243e438cfde78ccc,0029c5db35ef291ce99d1262012e7daa
d54c5b81fc2b38707588dd4eddc7c594,002f16b7bc4530031b7d90f791b12d8a
d41dc2f2979f52d75d78714b378d4068,002f98c0f7efd42638ed6100ca699b42
bd7cab8de4d7943286634023cc06f8ff,0030ff924c38549807645976adeef2c0
0c4a0f8ab44f9acd2d04e7024f9ba362,00526a9d4ebde463baee25f386963ddc
85b8a24337b4e2571f8fee38f4253a06,00772b2af35643653f108fdac1155ee3
f9d774a1820f792952eea079a40a7c6b,00789ce015e7e5791c7914f32bb4fad4
5a419dbf24a8c9718fe522b81c69f61a,0010b2e5201cc5f1ae7e9c6cc8f5bd00
71a5f1c2a5fd9889ef26b5ac22aec9

2025-01-23 17:41:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:41:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:41:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:41:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:41:56 - snowflake.connector.connection - INFO - closed
2025-01-23 17:41:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:41:57 - root - INFO - SQL:
-- Corrected Query 2
SELECT oi."order_id", SUM(oi."freight_value") AS "total_freight"
FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON oi."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY oi."order_id"
LIMIT 100
Results:
order_id,total_freight
00010242fe8c5a6d1ba2dd792cb16214,13.29
00018f77f2f0320c557190d7a144bdd3,19.93
000576fe39319847cbb9d288c5617fa6,70.75
0008288aa423d2a3f00fcb17cd7d8719,26.74
0009792311464db532ff765bf7b182ae,27.65
0009c9a17f916a706d71784483a5d643,11.34
000e562887b1f2006d75e0be9558292e,16.11
001021efaa8636c29475e7734483457d,15.1
00125cb692d04887809806618a2a145f,25.51
00130c0eee84a3d909e75bc08c5c3ca1,7.94
00137e170939bba5a3134e2386413108,24.65
0016dfedd97fc2950e388d2971d718c7,20.8
001dbc16dc51075e987543d23a0507c7,18.0
00254baeb6c932b0a8aeead91fbd02b5,43.11
002834535f7a609a5c68266f173fa59e,19.18
002955b0acc63d04f6724a31967e82bd,15.59
0029f17cf0e7640c5cb6825af681303f,18.54
002d040018d12a3853c059f7f23ab5b1,14.84
0036757472ece3dde52fd4bfd929c90e,66.04
003822434f91204da0a51fe4cf2aba18,37.16
004fb11815bc03b01b20a614eef69d14,19.75
0057199db02d1a5ef41bacbf41f8f63b,16.79
008fab5602c441d51f30b1464f5d4643,15.56
009905140e9f8cc35d5be897937381db,36.46
0011d82c4b53e22e84023405fb467e57,26.33
001b76dd48a5b1eee3e87778daa40df8,13.01
001daeb0eddc45b999bad0801ad9d273,16.79
0020a222f55eb79a372d0efee3cca688,15.1
0025081dcf9330f9a5052ae82c6ce396,18.23
002691433f09002ac9ca0c4e8dbb8ead,16.43
0026a368634b6e6f34f33b1499773a30,15.8
0029c5db35ef291ce99d1262012e7daa,21.62
0032d07457ae9c806c79368d7d9ce96b,27.19
003a7f59d7e08a9c61d9e2881fe6459c,15.28
004345d16a1ab2c21962992c721c8643,15.37
00482f2670787292280e0a8153d82467,10.96
0066a1fdaee16ad5022c5ef979d0b661,87.28
00789ce015e7e5791c7914f32bb4fad4,14.83
007ec946d4f798caf2b43c9d44c56421,15.1
0097f0545a302aafa32782f1734ff71c,41.84
00998f38df3012359ef195ca75ebb329,23.34
00a1e977cf6e672402963940db55d919,7.75
002af7fa9eb99d1456bceb6a13d6fc0b,21.11
0030ff924c38549807645976adeef2c0,67.24
003cc6161d7a2593f2525cce0c330d32,12.9
005d9a5423d47281ac463a968b3936fb,45.28
006c42f310102c1910b3c5793ce5fc34,20.8
0072847849eafe70995fa51a714c81ac,14.9
008f831b7185cff7ab35a46c37d64cd2,37.09
00a174dbf11967d260033fa6ab711493,41.53
00a4d94df1c9757661679b2f4bd6d311,21.43
0055b77cca3186676c147f532dd2547b,40.37
008c3a655c66f4d92370d0d422732f69,9.44
00b4a910f64f24dbcac04fe54088a443,16.6
00b4c651133c06fb175123a492f1cac3,14.59
00b9e0f8f588d0406a3de447eb606970,16.6
00c81b6675ef9ecaaff5fc1d6720b96c,14.1
00c842d0ae6462afc1d38fc055b02c75,17.67
00c95282163553a982f38481f9488481,18.0
00f6ac4816d12f49026b09f2aa77d15f,58.32000000000001
00fbcd8b120e5706c58b9d1a0026a7da,16.11
014a0793ab3d930d6f3b206cee474af4,18.24
014f1e63f9bd4f5578edcf4e5c305a0a,18.34
014ffbfe2df4c96a2b063d084583978f,15.3
000f25f4d72195062c040b12dce9a18a,44.4
001427c0ec99cf8af737bd88e92fd444,23.35
0015ebb40fb17286bea51d4607c4733c,15.1
00169e31ef4b29deaae414f9a5e95929,16.11
002b4e6fa42cd4a22cc86abc18fe9c05,19.67
006127b8b9a1681a982313ed7129c3c0,16.22
00921e4911895b93c7b4fc0d80c0815e,11.62
00a57dfbb049fbaae10763e2cf15f797,67.67999999999999
0006ec9db01a64e59a68b2c340bf65a7,23.32
00119ff934e539cf26f92b9ef0cdfed8,16.98
0014ae671de39511f7575066200733b7,14.1
0017afd5076e074a48f1f1a4c7bac9c5,44.29
001e7ba991be1b19605ca0316e7130f9,18.21
00259a44fcad3fc0474329e925d14fc3,14.1
00276d5c3491fbf55305e26891040df9,23.22
0028de0ca693a1bb26448916a81105cc,15.31
0030d783f979fbc5981e75613b057344,17.67
0035246a40f520710769010f752e7507,12.11
0035e6b7ade84b3f5b86bd49814793df,14.1
004157daafa0bc8672e01f00e4f0c04f,33.91
0045e3085f083f0f38d24bb3f22e6593,13.84
0046e1d57f4c07c8c92ab26be8c3dfc0,7.78
004ba47bb589cdbc485e6025bd6d3c81,11.85
004f5d8f238e8908e6864b874eda3391,15.61
004fb5e6f90a178dc74ad2b016649249,13.93
005a1dded353107dbabf8ffc83a20365,14.28
00611822267e76e0055c25c18506f06e,20.31
0071ee2429bc1efdc43aa3e073a5290e,12.46
00750f68bb64537034e93554c64b41b5,8.16
007beb35f98c075747e6fc4fd1c0cb73,18.69
0080eebb288dba1857ccf048dfe6bdfe,14.1
00946f674d880be1f188abc10ad7cf46,32.92
00975e709cd12c34d3bd44e4a7f7a876,7.86
0039500db36d50d7d0bfaf23723550f3,33.33
00404fa7a687c8c44ca69d42695aae73,0.0
004d76fef3dd46eb4f70da049c8d1f93,27.39

2025-01-23 17:41:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:41:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:41:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:41:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:41:58 - snowflake.connector.connection - INFO - closed
2025-01-23 17:41:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:41:59 - root - INFO - SQL:
-- Corrected Query 3
SELECT oi."order_id", COUNT(oi."order_item_id") AS "items_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON oi."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY oi."order_id"
ORDER BY "items_per_order" DESC
LIMIT 100
Results:
order_id,items_per_order
8272b63d03f5f79c56e9e4120aec44ef,21
ab14fdcfbe524636d65ee38360e22ce8,20
1b15974a0141d54e36626dca3fdc731a,20
9ef13efd6949e4573a18964dd1bbe7f5,15
428a2f660dc84138d969ccd69a0ab6d5,15
73c8ab38f07dc94389065f7eba4f297a,14
9bdc4d4c71aa1de4606060929dee888c,14
37ee401157a3a0b28c9c6d0ed8c3b24b,13
af822dacd6f5cff7376413c03a388bb7,12
2c2a19b5703863c908512d135aa6accc,12
c05d6a79e55da72ca780ce90364abed9,12
637617b3ffe9e2f7a2411243829226d0,12
3a213fcdfe7d98be74ea0dc05a8b31ae,12
71dab1155600756af6de79de92e712e3,11
6c355e2913545fa6f72c40cbca57729e,11
5a3b1c29a49756e75f1ef513383c0c12,11
7f2c22c54cbae55091a09a9653fd2b8a,11
ca3625898fbd48669d50701aba51cd5f,10
30bdf3d824d824610a49887486debcaf,10
f80549a97eb203e1566e026ab66f045b,10
9aec4e1ae90b23c7bf2d2b3bfafbd943,10
f60ce04ff8060152c83c7c97e246d6a8,10
e8fa22c3673b1dd17ea315021b1f0f61,10
9f5054bd9a3c71702aa0917a7da29193,10
a483ffe0ce133740ab12ebcba8a3ccf9,10
f5aa338a071dcf7d23d8e6b116bfcab5,9
c52c7fbe316b5b9d549e8a25206b8a1f,9
f368c3e5edb7b7db5296654ed37464b2,9
612d140e314dab491efb33ec8219c2ee,8
03caa2c082116e1d31e67e9ae3700499,8
04993613aee4046caf92ea17b316dcfb,8
3cb5915708fd5b47246994508f858ffd,8
848b0561d4bc26f57b288a5004f38683,8
9a2b443dc8e6673e4fc330b3ea033569,8
be382a9e1ed25128148b97d6bfdb21af,8
4affd1928d3900a415e9886a179d5124,8
1c437b4d4326d36b71e91dd7a7c2c4f6,7
62073ec6b54b8e6322037fc0f3591ad3,7
487e6e67e10e5756f886f5994439c22f,7
9bdf94af058f959fbc09c3ea1eb32465,7
e332eda82fe7ca4e86daf4f71ca785df,7
cd51709c98c738351915f79c4318675e,7
8dd554aaa8e7d61ddde56ba4189c780f,7
ad850e69fce9a512ada84086651a2e7d,7
7b598857cddf46a156640f69f70a6e6d,7
895dce73de79888b14581541cf3a811b,7
3e6f06c624c7f67d6a0710e39ca97f2b,7
77df84f9195be22a4e9cb72ca9e8b4c2,7
1c11d0f4353b31ac3417fbfa5f0f2a8a,7
e37f11cae9985ca58f0b56f268720537,7
83f0c4c6b1a3c31214ca8266dc888258,7
df36d28de846593cdbc153e28f195cd5,7
df13cbaf3230c62a4b582317936e8a39,7
7d8f5bfd5aff648220374a2df62e84d5,7
dc3adcf742779e0c8eb5bd587ed4ec57,7
0c82a229fc22597c2361656cba8d3230,7
dc43adc8cf44306503fd3db002d5db5f,7
c33368133f0a06d3c803f11e48f17309,7
28cf49bbfe2683759d3cf866b7fda22f,6
44ca3a6e88412fa58bacabe95656aa63,6
9f36a6b11ec95b4f8586000d49dae422,6
468c8b5d4cee2be214b52f9602980779,6
3e9bdc72197be8d2881273a27efc207d,6
a2d8aaf39efc96fe140eda3e8f2e337e,6
2455cbeb73fd04b170ca2504662f95ce,6
201183426051cfc62c56f2414b2480e3,6
7683e28d403c6a04e30902e9e415eec8,6
7af905809ddbaaed2af20592006857e0,6
2bb6b9ebbb0ae5423d46be8e62e09538,6
3edb50273f0fec7a7e340030467076bc,6
ad71f559c9264f19bdacbc2062847e74,6
8f6f263a5e96515d5534199b74cb7748,6
55298973d17a0c1dfb2281ae969a65d8,6
8adafb3466daa5395694d3a906ff9d40,6
3e141e345041b9a2a2648dca90d431c7,6
aa0b425987bdeae4a29c616a2bc3a08a,6
ad1aeeb1a99c9f021e38a49865bb812c,6
ac48e79befd4d8cbfb58047dde3e43cf,6
3263e5243c28ebe706f7500cf88054ad,6
8fc11d5503f6e2b6e15242e0365633e4,6
82acff152625d343c9ef91512401c210,6
4c966c07e48f5460c75f69d0352a61be,6
3e073b27114fe955e184db124d34a566,6
1daecbe2a13ab0881c418e978f1e08c1,6
4ea517483bf1d3580730f6042334d158,6
50fc570b5b9de1500a9e66edcc9d8525,6
597233a841339cc9249ce67709f68574,6
2e8644b6852a0e75700c764e182ddbbe,6
2efe3d3b0ddc295d2ce1c43f021078cb,6
60b570df9018c6b6441017314a2dd081,6
7b1628af9aa95c57c63665fb81cced3b,6
b47f9f663e41971f0d31b1caa6468c40,6
200f4d883fcc701355e46b8c6035743f,6
47435f657d2323e5eb4455aa5bc6a436,6
99330d45c3ba6f45ad5745f6de036c5f,6
47399920ee7546351440204086acb793,6
0b0809b2b64511c62fb745fb8b465cc9,6
3f744e5030fb02e02651eb31d5204878,6
3990f96693d321ac142fff312bf3706a,6
30a022caf1ba5b86f28124ed216c859f,6

2025-01-23 17:41:59 - root - INFO - itercount: 0
2025-01-23 17:41:59 - root - INFO - Database Name: E_COMMERCE
Schema Name: E_COMMERCE
DDL describes table information.
,0
table_name,LEADS_QUALIFIED
description,
DDL,"create or replace TABLE LEADS_QUALIFIED (
	""mql_id"" VARCHAR(16777216),
	""first_contact_date"" VARCHAR(16777216),
	""landing_page_id"" VARCHAR(16777216),
	""origin"" VARCHAR(16777216)
);"

,1
table_name,GEOLOCATION
description,
DDL,"create or replace TABLE GEOLOCATION (
	""geolocation_zip_code_prefix"" NUMBER(38,0),
	""geolocation_lat"" FLOAT,
	""geolocation_lng"" FLOAT,
	""geolocation_city"" VARCHAR(16777216),
	""geolocation_state"" VARCHAR(16777216)
);"

,2
table_name,LEADS_CLOSED
description,
DDL,"create or replace TABLE LEADS_CLOSED (
	""mql_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""sdr_id"" VARCHAR(16777216),
	""sr_id"" VARCHAR(16777216),
	""won_date"" VARCHAR(16777216),
	""business_segment"" VARCHAR(16777216),
	""lead_type"" VARCHAR(16777216),
	""lead_behaviour_profile"" VARCHAR(16777216),
	""has_company"" FLOAT,
	""has_gtin"" FLOAT,
	""average_stock"" VARCHAR(16777216),
	""business_type"" VARCHAR(16777216),
	""declared_product_catalog_size"" FLOAT,
	""declared_monthly_revenue"" FLOAT
);"

,3
table_name,ORDER_ITEMS
description,
DDL,"create or replace TABLE ORDER_ITEMS (
	""order_id"" VARCHAR(16777216),
	""order_item_id"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""shipping_limit_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""freight_value"" FLOAT
);"

,4
table_name,SELLERS
description,
DDL,"create or replace TABLE SELLERS (
	""seller_id"" VARCHAR(16777216),
	""seller_zip_code_prefix"" NUMBER(38,0),
	""seller_city"" VARCHAR(16777216),
	""seller_state"" VARCHAR(16777216)
);"

,5
table_name,CUSTOMERS
description,
DDL,"create or replace TABLE CUSTOMERS (
	""customer_id"" VARCHAR(16777216),
	""customer_unique_id"" VARCHAR(16777216),
	""customer_zip_code_prefix"" NUMBER(38,0),
	""customer_city"" VARCHAR(16777216),
	""customer_state"" VARCHAR(16777216)
);"

,6
table_name,ORDER_REVIEWS
description,
DDL,"create or replace TABLE ORDER_REVIEWS (
	""review_id"" VARCHAR(16777216),
	""order_id"" VARCHAR(16777216),
	""review_score"" NUMBER(38,0),
	""review_comment_title"" VARCHAR(16777216),
	""review_comment_message"" VARCHAR(16777216),
	""review_creation_date"" VARCHAR(16777216),
	""review_answer_timestamp"" VARCHAR(16777216)
);"

,7
table_name,PRODUCTS
description,
DDL,"create or replace TABLE PRODUCTS (
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

,8
table_name,PRODUCT_CATEGORY_NAME_TRANSLATION
description,
DDL,"create or replace TABLE PRODUCT_CATEGORY_NAME_TRANSLATION (
	""product_category_name"" VARCHAR(16777216),
	""product_category_name_english"" VARCHAR(16777216)
);"

,9
table_name,ORDERS
description,
DDL,"create or replace TABLE ORDERS (
	""order_id"" VARCHAR(16777216),
	""customer_id"" VARCHAR(16777216),
	""order_status"" VARCHAR(16777216),
	""order_purchase_timestamp"" VARCHAR(16777216),
	""order_approved_at"" VARCHAR(16777216),
	""order_delivered_carrier_date"" VARCHAR(16777216),
	""order_delivered_customer_date"" VARCHAR(16777216),
	""order_estimated_delivery_date"" VARCHAR(16777216)
);"

,10
table_name,ORDER_PAYMENTS
description,
DDL,"create or replace TABLE ORDER_PAYMENTS (
	""order_id"" VARCHAR(16777216),
	""payment_sequential"" NUMBER(38,0),
	""payment_type"" VARCHAR(16777216),
	""payment_installments"" NUMBER(38,0),
	""payment_value"" FLOAT
);"

External knowledge that might be helpful: 
# Introduction to the RFM Model

The RFM (Recency, Frequency, Monetary) model segments and scores customers based on three key dimensions:

Recency: The time since the customer's last purchase. Customers who made a purchase more recently are more likely to buy again.

Frequency: The number of purchases made by the customer within a given period. Customers with higher purchase frequency are generally more valuable.

Monetary: The total amount of money spent by the customer. Customers who spend more are typically considered more valuable.

Using these three dimensions, the SQL assigns each customer a score based on their historical order data and classifies them into different customer segments (RFM Buckets).

By taking the values for each customer, bucketing them to produce a score from 1 (lowest) to 5 (highest) and then concatenating all three scores together you get an easy way to divide-up your customers into segments (or “RFM cells”; high-spending new purchasers (514, 5 for recency, 1 for frequency and 4 for monetary value), almost-lost but previously loyal customers (153, 1 for recency, 5 for frequency and 3 for monetary value) and so on.

One of the most popular ways to visualize your customer RFM segments is by using a grid such as the one below, with each segment labelled and sized proportionate to the volume of customers each contains.

# RFM Segmentation Calculation


RFM analysis is particularly useful for sales and customer teams needing to focus their limited time and money on those customers for whom a change in behavior — from lapsed to active, or first-time to repeat shopper for example — would have the most impact on your bottom line.

For example, by focusing retention efforts on customers who used to be frequent, loyal and high-value purchasers (RFM segment 355) the revenue upside is obviously much greater than if they managed to retain customers who were previously infrequent low-value purchasers (RFM segment 132).

Similarly, there’s little point in incentivising customers who are already your most loyal, frequent and high-spending customers (RFM segment 555) when spending those incentives on customers who’ve just made their first purchase and have the potential to also become loyal and valuable repeat customers (RFM segment 514, for example)

Building an RFM model is often one of the first projects our clients’ data teams ask us to help deliver as the concept is straightforward, the data required has usually just been centralized and the output is immediately actionable by customer and marketing teams keen to focus their time on customer activity that has the greatest potential to retain or increase revenue.

We’ve created an RFM model using the project timesheets and invoicing data we centralise in our Google BigQuery data warehouse and used it to create the RFM analysis dashboard shown in the screenshot at the start of this blog; in the rest of this blog I’ll walk through how we build the model using dbt and LookML and used the visualization features in Looker to help analyze and make the data actionable.

For the purposes of the RFM model we created for our consulting business, we defined our Recency, Frequency and Monetary Value measures as:

Recency: the number of months since the last invoice raised for a customer

Frequency : the number of invoices raised for the customer in the 12 months leading-up to their last invoice

Monetary Value : the total value of invoices raised for the customer over the 12 months leading-up to their last invoice

The RFM (Recency, Frequency, Monetary) model categorizes customers based on three dimensions: **Recency**, **Frequency**, and **Monetary**. This helps in identifying high-value customers, those at risk of leaving, and others who require attention. Below is a detailed explanation of how customers are grouped based on these three factors.


## RFM Segmentation Logic

Customers are assigned to specific segments (RFM Buckets) based on a combination of their Recency, Frequency, and Monetary scores. The segmentation logic is as follows:

- **Champions**: Customers who have made a recent purchase, with high frequency and high monetary value. These are considered the most valuable customers.
  - Criteria: Recency = 1 and Frequency + Monetary score between 1 and 4.

- **Can't Lose Them**: Previously frequent and high-spending customers who have not made a recent purchase. These customers are at risk of leaving and need attention.
  - Criteria: Recency = 4 or 5 and Frequency + Monetary score between 1 and 2.

- **Hibernating**: Customers whose last purchase was a while ago, with low to moderate frequency and spending. These customers might have lost interest in the products.
  - Criteria: Recency = 4 or 5 and Frequency + Monetary score between 3 and 6.

- **Lost**: Customers who have not purchased in a long time and have low frequency and monetary value. These customers are likely lost.
  - Criteria: Recency = 4 or 5 and Frequency + Monetary score between 7 and 10.

- **Loyal Customers**: Customers who are frequent buyers with decent spending levels, and they have made a purchase relatively recently. These customers are likely to be very loyal.
  - Criteria: Recency = 2 or 3 and Frequency + Monetary score between 1 and 4.

- **Needs Attention**: Customers whose purchase frequency and spending are moderate. They haven't bought very recently, but they could be incentivized to become more active.
  - Criteria: Recency = 3 and Frequency + Monetary score between 5 and 6.

- **Recent Users**: Customers who made a purchase recently, but their frequency and spending are moderate. These are relatively new or inconsistent buyers.
  - Criteria: Recency = 1 and Frequency + Monetary score between 7 and 8.

- **Potential Loyalists**: Customers who show potential to become loyal customers. They have good frequency and monetary scores, and they have made recent purchases. With the right engagement, they could become loyal customers.
  - Criteria:
    - Recency = 1 and Frequency + Monetary score between 5 and 6.
    - OR Recency = 2 and Frequency + Monetary score between 5 and 8.

- **Price Sensitive**: Customers who have made recent purchases but tend to spend less, indicating they may be more sensitive to price.
  - Criteria: Recency = 1 and Frequency + Monetary score between 9 and 10.

- **Promising**: These customers exhibit high potential with decent frequency and monetary scores, and they could become more valuable over time.
  - Criteria: Recency = 2 and Frequency + Monetary score between 9 and 10.

- **About to Sleep**: Customers whose frequency and spending are low, and their last purchase was some time ago. These customers are likely to become inactive.
  - Criteria: Recency = 3 and Frequency + Monetary score between 7 and 10.

## Summary

This segmentation logic groups customers based on their behavior in terms of when they last purchased (Recency), how often they purchase (Frequency), and how much they spend (Monetary). By understanding which group a customer belongs to, organizations can tailor marketing strategies to engage the right audience more effectively, improving customer retention and maximizing value.

The table structure information is ({database name: {schema name: {table name}}}): 
{'E_COMMERCE': {'E_COMMERCE': ['CUSTOMERS', 'GEOLOCATION', 'LEADS_CLOSED', 'LEADS_QUALIFIED', 'ORDERS', 'ORDER_ITEMS', 'ORDER_PAYMENTS', 'ORDER_REVIEWS', 'PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION', 'SELLERS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **CUSTOMERS**

   - `"customer_id"`: Used to uniquely identify customers and join with the `ORDERS` table.
   - Potential Usage: To link customers to their orders and analyze customer-specific metrics.

2. **ORDERS**

   - `"order_id"`: Unique identifier for each order; used to join with `ORDER_ITEMS`.
   - `"customer_id"`: Links orders to customers.
   - `"order_status"`: Indicates the status of the order; used to filter for 'delivered' orders.
   - `"order_purchase_timestamp"`: Timestamp of when the order was placed; used to calculate Recency.
   - Potential Usage: To identify delivered orders, calculate Recency, and link orders to customers.

3. **ORDER_ITEMS**

   - `"order_id"`: Links items to their respective orders.
   - `"price"`: Price of each item; used to calculate the sales amount per order.
   - Potential Usage: To compute Monetary value by summing item prices per order.

**Conditions That May Be Used:**

- Filter orders to include only those where `"order_status"` is 'delivered'.
- Use date fields to calculate the time since last purchase (Recency).
- Aggregate data per customer to calculate Frequency (number of orders) and Monetary (total spent).

---

**SQL Queries:**

1. **Retrieve Basic Customer Information:**

   ```sql
   SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
   FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
   LIMIT 100;
   ```

2. **View Orders with Their Statuses:**

   ```sql
   SELECT "order_id", "customer_id", "order_status", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   LIMIT 100;
   ```

3. **List 'Delivered' Orders:**

   ```sql
   SELECT "order_id", "customer_id", "order_status", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   WHERE "order_status" ILIKE '%delivered%'
   LIMIT 100;
   ```

4. **Get Order Items with Prices:**

   ```sql
   SELECT "order_id", "order_item_id", "product_id", "price", "freight_value"
   FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
   LIMIT 100;
   ```

5. **Calculate Total Sales Amount per Order:**

   ```sql
   SELECT "order_id", SUM("price") AS "total_order_price"
   FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
   GROUP BY "order_id"
   ORDER BY "total_order_price" DESC
   LIMIT 100;
   ```

6. **Find Last Purchase Date for Each Customer:**

   ```sql
   SELECT "customer_id", MAX("order_purchase_timestamp") AS "last_purchase_date"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   LIMIT 100;
   ```

7. **Compute Total Amount Spent by Each Customer:**

   ```sql
   SELECT o."customer_id", SUM(oi."price") AS "total_spent"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
   GROUP BY o."customer_id"
   ORDER BY "total_spent" DESC
   LIMIT 100;
   ```

8. **Count Number of Orders per Customer:**

   ```sql
   SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   ORDER BY "order_count" DESC
   LIMIT 100;
   ```

9. **Calculate Average Sales per Order for Each Customer:**

   ```sql
   SELECT o."customer_id", SUM(oi."price") / COUNT(DISTINCT o."order_id") AS "avg_sales_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
   GROUP BY o."customer_id"
   ORDER BY "avg_sales_per_order" DESC
   LIMIT 100;
   ```

10. **Retrieve Distinct Order Statuses:**

    ```sql
    SELECT DISTINCT "order_status"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    LIMIT 100;
    ```

11. **Count Orders per Status:**

    ```sql
    SELECT "order_status", COUNT("order_id") AS "order_count"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "order_status"
    ORDER BY "order_count" DESC
    LIMIT 100;
    ```

12. **Get Earliest Purchase Date per Customer:**

    ```sql
    SELECT "customer_id", MIN("order_purchase_timestamp") AS "first_purchase_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "customer_id"
    LIMIT 100;
    ```

13. **Calculate Total Amount Spent by Each Customer on Delivered Orders:**

    ```sql
    SELECT o."customer_id", SUM(oi."price") AS "total_spent_delivered"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    GROUP BY o."customer_id"
    ORDER BY "total_spent_delivered" DESC
    LIMIT 100;
    ```

14. **Count Number of Delivered Orders per Customer:**

    ```sql
    SELECT "customer_id", COUNT(DISTINCT "order_id") AS "delivered_order_count"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" ILIKE '%delivered%'
    GROUP BY "customer_id"
    ORDER BY "delivered_order_count" DESC
    LIMIT 100;
    ```

15. **List Customers with Their First and Last Purchase Dates:**

    ```sql
    SELECT "customer_id", MIN("order_purchase_timestamp") AS "first_purchase", MAX("order_purchase_timestamp") AS "last_purchase"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "customer_id"
    LIMIT 100;
    ```

16. **Get Average Order Value per Customer for Delivered Orders:**

    ```sql
    SELECT o."customer_id", SUM(oi."price") / COUNT(DISTINCT o."order_id") AS "avg_order_value_delivered"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    GROUP BY o."customer_id"
    ORDER BY "avg_order_value_delivered" DESC
    LIMIT 100;
    ```

17. **Find Customers with Orders in the Last Month:**

    ```sql
    SELECT DISTINCT o."customer_id"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    WHERE o."order_purchase_timestamp" >= DATEADD(month, -1, CURRENT_DATE)
    LIMIT 100;
    ```

18. **List Products Purchased in Delivered Orders:**

    ```sql
    SELECT DISTINCT oi."product_id", oi."order_id"
    FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
    JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    LIMIT 100;
    ```

19. **Get Total Freight Value per Order:**

    ```sql
    SELECT "order_id", SUM("freight_value") AS "total_freight"
    FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
    GROUP BY "order_id"
    LIMIT 100;
    ```

20. **Count Number of Items per Order:**

    ```sql
    SELECT "order_id", COUNT("order_item_id") AS "items_per_order"
    FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
    GROUP BY "order_id"
    ORDER BY "items_per_order" DESC
    LIMIT 100;
    ```

These queries help to understand the data related to customers, orders, and sales amounts, which are essential for calculating Recency, Frequency, and Monetary values needed for RFM segmentation. The use of different queries allows for exploration of various aspects of the dataset, such as order statuses, sales amounts, and customer purchase behaviors, considering only the tables and columns specified.Query:
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
   FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
   LIMIT 100;
Answer:
Too long, hard cut:
customer_id,customer_unique_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade,GO
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel,PR
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia,DF
03f846ad034
Query:
SELECT "order_id", "customer_id", "order_status", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_status,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered,2017-07-09 21:57:05
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,invoiced,2017-04-11 12:22:08
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered,2018-08-04 23:25:30
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,shipped,2018-06-04 16:44:48
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4
Query:
SELECT "order_id", "customer_id", "order_status", "order_purchase_timestamp"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   WHERE "order_status" ILIKE '%delivered%'
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_status,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered,2017-07-09 21:57:05
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered,2018-08-04 23:25:30
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9
Query:
SELECT "order_id", "order_item_id", "product_id", "price", "freight_value"
   FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,order_item_id,product_id,price,freight_value
00010242fe8c5a6d1ba2dd792cb16214,1,4244733e06e7ecb4970a6e2683c13e61,58.9,13.29
00018f77f2f0320c557190d7a144bdd3,1,e5f2d52b802189ee658865ca93d83a8f,239.9,19.93
000229ec398224ef6ca0657da4fc703e,1,c777355d18b72b67abbeef9df44fd0fd,199.0,17.87
00024acbcdf0a6daa1e931b038114c75,1,7634da152a4610f1595efa32f14722fc,12.99,12.79
00042b26cf59d7ce69dfabb4e55b4fd9,1,ac6c3623068f30de03045865e4e10089,199.9,18.14
00048cc3ae777c65dbb7d2a0634bc1ea,1,ef92defde845ab8450f9d70c526ef70f,21.9,12.69
00054e8431b9d7675808bcb819fb4a32,1,8d4f2bb7e93e6710a28f34fa83ee7d28,19.9,11.85
000576fe39319847cbb9d288c5617fa6,1,557d850972a7d6f792fd18ae1400d9b6,810.0,70.75
0005a1a1728c9d785b8e2b08b904576c,1,310ae3c140ff94b03219ad0adc3c778f,145.95,11.65
0005f50442cb953dcd1d21e1fb923495,1,4535b0e1091c278dfd193e5a1d63b39f,53.99,11.4
00061f2a7bc09da83e415a52dc8a4af1,1,d63c1011f49d98b976c352955b1c4bea,59.99,8.88
00063b381e2406b52ad429470734ebd5,1,f177554ea93259a5b282f24e33f65ab6,45.0,12.98
0006ec9db01a64e59a68b2c340bf65a7,1,99a4788cb24856965c36a24e339b6058,74.0,23.32
0008288aa423d2a3f00fcb17cd7d8719,1,368c6c730842d78016ad823897a372db,49.9,13.37
0008288aa423d2a3f00fcb17cd7d8719,2,368c6c730842d78016ad823897a372db,49.9,13.37
0009792311464db532ff765bf7b182ae,1,8cab8abac59158715e0d70a36c807415,99.9,27.65
0009c9a17f916a706d71784483a5d643,1,3f27ac8e699df3d300ec4a5d8c5cf0b2,639.0,11.34
000aed2e25dbad2f9ddb70584c5a2ded,1,4fa33915031a8cde03dd0d3e8fb27f01,144.0,8.77
000c3e6612759851cc3cbb4b83257986,1,b50c950aba0dcead2c48032a690ce817,99.0,13.71
000e562887b1f2006d75e0be9558292e,1,5ed9eaf534f6936b51d0b6c5e4d5c2e9,25.0,16.11
000e63d38ae8c00bbcb5a30573b99628,1,553e0e7590d3116a072507a3635d2877,47.9,8.88
000e906b789b55f64edcb1f84030f90d,1,57d79905de06d8897872c551bfd09358,21.99,11.85
000f25f4d72195062c040b12dce9a18a,1,1c05e0964302b6cf68ca0d15f326c6ba,119.99,44.4
001021efaa8636c29475e7734483457d,1,5d7c23067ed3fc8c6e699b9373d5890b,49.0,15.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,1,5a419dbf24a8c9718fe522b81c69f61a,48.9,16.6
00119ff934e539cf26f92b9ef0cdfed8,1,21b1c2f67a9aafb5af0eb06c13b9dbda,219.9,16.98
0011d82c4b53e22e84023405fb467e57,1,c389f712c4b4510bc997cee93e8b1a28,289.0,26.33
00125cb692d04887809806618a2a145f,1,1c0c0093a48f13ba70d0c6b0a9157cb7,109.9,25.51
00130c0eee84a3d909e75bc08c5c3ca1,1,89321f94e35fc6d7903d36f74e351d40,27.9,7.94
0013503b13da1eac686219390b7d641b,1,38afdf723b95d455b418a0f57d623c6b,119.9,17.32
00137e170939bba5a3134e2386413108,1,672e757f331900b9deea127a2a7b79fd,397.0,24.65
001427c0ec99cf8af737bd88e92fd444,1,28b4eced95a52d9c437a4caf9d311b95,59.9,23.35
00143d0f86d6fbd9f9b38ab440ac16f5,1,e95ee6822b66ac6058e2e4aff656071a,21.33,15.1
00143d0f86d6fbd9f9b38ab440ac16f5,2,e95ee6822b66ac6058e2e4aff656071a,21.33,15.1
00143d0f86d6fbd9f9b38ab440ac16f5,3,e95ee6822b66ac6058e2e4aff656071a,21.33,15.1
0014ae671de39511f7575066200733b7,1,23365beed316535b4105bd800c46670e,16.5,14.1
0015ebb40fb17286bea51d4607c4733c,1,50fd2b788dc166edd20512370dac54df,21.9,15.1
00169e31ef4b29deaae414f9a5e95929,1,b10eba910a974df70b8a12d0665cdb9e,39.0,16.11
0016dfedd97fc2950e388d2971d718c7,1,4089861a1bd4685da70bddd6b4f974f1,49.75,20.8
0017afd5076e074a48f1f1a4c7bac9c5,1,fe59a1e006df3ac42bf0ceb876d70969,809.1,44.29
001862358bf858722e1e2ae000cfed8b,1,c6dd917a0be2a704582055949915ab32,99.99,13.72
0019c29108428acffd089c36103c9440,1,28b4eced95a52d9c437a4caf9d311b95,59.9,19.95
001ab0a7578dd66cd4b0a71f5b6e1e41,1,0b0172eb0fd18479d29c3bc122c058c2,24.89,17.63
001ab0a7578dd66cd4b0a71f5b6e1e41,2,0b0172eb0fd18479d29c3bc122c058c2,24.89,17.63
001ab0a7578dd66cd4b0a71f5b6e1e41,3,0b0172eb0fd18479d29c3bc122c058c2,24.89,17.63
001ac194d4a326a6fa99b581e9a3d963,1,dbaee28f4ee64465838a229582d77520,54.0,8.54
001b76dd48a5b1eee3e87778daa40df8,1,dbb67791e405873b259e4656bf971246,81.99,13.01
001c85b5f68d2be0cb0797afc9e8ce9a,1,84f456958365164420cfc80fbe4c7fab,99.0,13.71
001d8f0e34a38c37f7dba2a37d4eba8b,1,e67307ff0f15ade43fcb6e670be7a74c,18.99,7.78
001d8f0e34a38c37f7dba2a37d4eba8b,2,e67307ff0f15ade43fcb6e670be7a74c,18.99,7.78
001daeb0eddc45b999bad0801ad9d273,1,30c01cc81c9eb80469371743813789cc,38.33,16.79
001dbc16dc51075e987543d23a0507c7,1,777d2e438a1b645f3aec9bd57e92672c,69.9,18.0
001e7ba991be1b19605ca0316e7130f9,1,884fa3cd42986ba480ea2f8ae4e25ff7,195.0,18.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,1,bdcf6a834e8faa30dac3886c7a58e92e,35.9,15.2
0020262c8a370bd5a174ea6a2a267321,1,a5341e3f8155dbb3e62323d3ea289729,79.5,21.05
0020a222f55eb79a372d0efee3cca688,1,e19ddcc85537b41f22116c8d5425ef46,29.99,15.1
002175704e8b209f61b9ad5cfd92b60e,1,e6b6e13cf71449a457269f425b89dc74,109.9,13.21
00229e4e43f7a7e0b9dd819ad43268d3,1,13fcfc313dfb2217e5ee3000a702f9ef,74.9,16.49
0025081dcf9330f9a5052ae82c6ce396,1,4e3f399366b0047a572b6682f9bb166e,14.95,18.23
00254baeb6c932b0a8aeead91fbd02b5,1,18901878788fec7ddc55e64d1ace8187,149.9,43.11
00259a44fcad3fc0474329e925d14fc3,1,0c4d0a08f95c7b7dc5dc7402bfdafd4c,19.99,14.1
0025c5d1a8ca53a240ec2634bb4492ea,1,35537536ed2b4c561b4018bf3abf54e0,390.0,29.39
002611a77fe03d076285fd4ca95db7
Query:
SELECT "order_id", SUM("price") AS "total_order_price"
   FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
   GROUP BY "order_id"
   ORDER BY "total_order_price" DESC
   LIMIT 100;
Answer:
order_id,total_order_price
03caa2c082116e1d31e67e9ae3700499,13440.0
736e1922ae60d0d6a89247b851902527,7160.0
0812eb902a67711a1cb742b3cdaa65ae,6735.0
fefacc66af859508bf1a7934eab1e97f,6729.0
f5136e38d1a14a4dbd87dff67da82701,6499.0
2cc9089445046817a7539d90805e6e5a,5934.6
a96610ab360d42a2e5335a3998b4718a,4799.0
199af31afc78c699f0dbf71fb178d4d4,4690.0
b4c4b76c642808cbe472a32b86cddc95,4599.9
8dbc85d1447242f3b127dda390d56e19,4590.0
d2f270487125ddc41fd134c4003ad1d7,4400.0
426a9742b533fc6fed17d1fd6d143d7e,4399.87
68101694e5c5dc7330c91e1bbc36214f,4099.99
b239ca7cd485940b31882363b52e6674,4059.0
86c4eab1571921a6a6e248ed312f5a5a,3999.9
80dfedb6d17bf23539beeef3c768f4d7,3999.0
9a3966c23190dbdbaabed08e8429c006,3980.0
41b7766bb1df487d17fb9725b78ff509,3930.0
9de73f3e6157169ad6c32b9f313c7dcb,3899.0
d3f66901a6743e15f9311547cc623b91,3700.0
e85c92ee6a3ba1ef47e41c23286314d9,3699.99
a53e05ecd2ed1f46a2b8e1f5828be7c6,3690.0
b15c7e972c74684414fb2e659fce916a,3597.0
df85c824523500d4066a0dbdb5d95bed,3549.0
3a4b013e014723cc38c9faa8ffdc6387,3399.99
66b9c991ee308f9342f6a7f63bb68251,3300.0
cb418bb4b6115438d20b0141ed5bc9e0,3198.0
f398a143c0fe171d965db2096cf064cf,3124.0
53c71d3953507c6239ff73917ed358c9,3109.99
1d54db601b417ccdfd3b7071955e6cc7,3105.0
31e50461be6957a749166e97af082d0a,3099.9
4412d97cb2093633afa85f11db46316c,3099.75
94fca82966c05ba707f4e7dc0c50aa3c,3099.0
43bdbd9dc0931d72befdf4765af6c442,3089.0
0af28d87520565eb3b57c9b2abe1a2cc,2999.99
d9956b0805e324db3f2a546ef216c10b,2999.99
4160b6447ad70e6d73f7221dd970bbe9,2999.9
79d3522a0854c853a4979ff2691abd91,2999.89
bd2fef198085db0b586b9c71aa2d35da,2999.89
52e6988a13f9dd7d567b0816dba52a03,2999.89
3c71011c33cf4ba95d18787bdc0e94d3,2999.89
b0b0d3285e59abf2f6c9d7e1bf761323,2999.89
586992f50ed97898737b07970376d19c,2999.0
d7a2c0c1ff66b314f3bf166fb4157fd4,2990.0
f0da489592c62097d0034f139386cb32,2951.0
8171523911786efd1d91c66d69051fcd,2920.0
912343626f370ead5ef2e85a9d757e22,2919.3999999999996
d3fc45461660252856d603ed31eb4e77,2899.0
3c4a05391c2fcd152731f52de8fc4347,2899.0
6fd59e3ae7e24c50131f6bc97c4c7776,2874.0
e8fa22c3673b1dd17ea315021b1f0f61,2849.9
abb71d0110c4be1a1a0c52f929cab4a3,2799.65
362aa88dd1265e7b4ea491b5836fb5f6,2799.0
80d49171762a51f500bf6b774aa24617,2749.65
2ec398158cb686267b1f4b102129098e,2749.0
794c69999774820e22c161f6dc4fef91,2740.0
3745e06e7f01e1652cfd4b9d31651820,2700.0
877a74a0ee5c1f719f39f4f11d2fc19a,2700.0
3dd5626c63f493f8b8f8788c2be24baa,2699.0
de0d8b8e774b3211e7e001d3e5985470,2699.0
da8be3bb62e9bf01e2e1a3bfd74ebd1a,2690.0
afc58387b17fa794fd73b0773a9f6ea7,2690.0
0f924038b00d1f102e4d09bea4fa666a,2689.0
694e3d121f16bcbb9b4595b6c6ab3baf,2680.0
bf205457ee84ab84c423d67b88239982,2649.99
028558cddca332b40b4ac4cb77407edf,2649.99
d0bce34c31d4494a153aa82c468152c4,2649.0
83e6338b5cf25dcf222551cb8da8d0d6,2649.0
242800e82e3e3f0aca252d6e03e4564c,2649.0
fb441bffe443e71cb16477c4743591e8,2600.0
78ce53a063eb2907f9727aac2c678339,2589.0
8ea7aebc18842332aad5f41ca74b334c,2589.0
457ade8093de88b42998c569334a7864,2550.0
0818699476819463109688475b808343,2547.0
122f75d9c2b30dfb21ca6950ec587b90,2520.0
d182d98f09b4277c0d58801e991f7757,2499.99
c28f3a01d4cfee461234c86a41f52e37,2498.0
83167649ca3fb63d1a7daada42232e14,2492.5
8ee5cab30019132affead27f19959ff2,2470.5
39a6ecead949b006d60a132d146ea284,2470.5
a5d11ae16578088b0fcd76de30368bdb,2433.6
880995aee9550ecd4518103daaf74fa0,2428.0
27db1a079a22bec1453d0f24f630005f,2400.0
3b43ab87914ebf7fd563557362108ebd,2400.0
d3e20e12dd625bc8aa36a78636912b0f,2399.8
9f5abaa01d419a15e448f089b1cf4b94,2399.0
acf01c9262ddb5d9adae8daa34e31568,2399.0
558b5f3eea27fa1b4cbc05013c45948e,2399.0
e130d3f737127ae52681b9338aea9b64,2370.0
6d0940a8f5fba47562bb14cd97dfd6da,2350.0
078f6a01964ee122ef20881df839af31,2350.0
eea28d6b80e09bfb00dc1f0640d2de47,2338.08
076d1555fb53a89b0ef4d529e527a0f6,2338.08
3fde74c28a3d5d618c00f26d51baafa0,2338.08
c8536491e6701f9b5382da168ee54048,2300.0
372f8e1a08cbd807194b89b3c31a448a,2300.0
44ecd2ebe54e3c23da26345bfcf1c919,2299.99
f7b13a5afd48ca5bcf589a25d5377b00,2299.95
98464a5096e400810b94bb93f38924c9,2299.95
1fe148272b3216d1704900d718e701bd,2299.95
Query:
SELECT "customer_id", MAX("order_purchase_timestamp") AS "last_purchase_date"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
Too long, hard cut:
customer_id,last_purchase_date
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
c77ee2d8ba1614a4d489a44166894938,2018-02-19 20:31:09
35ec6c1ca9e5844c5ca94214cce16dca,2018-02-21 17:15:49
456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
68c85132eb3b96fbe6cbddc09a568d24,2017-06-27 23:11:57
86ff82570097f39b2193254f540e4a69,2017-11-17 21:14:42
fbfba770bf13f470f63d1854a765a2d3,2018-01-18 09:30:54
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50
93ada7a24817edda9f4ab998fa823d16,2018-02-27 12:55:42
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18
2c3642e1392097fb4af76a76fec16a46,2018-08-26 11:04:26
b896b244963dc7543d400ad82d6710e0,2017-09-27 12:07:22
6454e6cba392b35aa21527063026fc92,2018-03-07 23:00:33
df5c9e02596851fcbfc98804e4108bbd,2017-12-02 14:28:03
4924a47e8cd5630b3564e26fac55c5ec,2018-07-18 13:39:54
8ed14e450a6268ec13f325e7c2eafeed,2018-02-02 16:15:41
a8331c35b57d8fe09e8df1c06509de29,2018-02-28 17:00:28
243ee97e01766bf68c3e30f0fe572490,2017-06-25 19:30:09
9f5a2f912f123d541a318029712fe90b,2017-09-12 16:32:09
45c9fcdb0cd88a5630cb4405c4d2e4a7,2018-02-27 10:05:56
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14
05e996469a2bf9559c7122b87e156724,2017-08-09 18:32:47
e28087daa16ea2d4ef377fd789af20b4,2018-01-25 23:13:41
6d491c9fe2f04f6e2af6ec033cd8907c,2017-11-17 19:53:21
ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
a559b10d4f093640a0ed4693ce16ed02,2018-04-26 11:59:05
ed8c52327eecff596e141636d5b556d2,2017-11-24 16:56:46
8ebe25aca53cef9a055de5c20eca76e7,2017-12-11 21:43:24
271f76c70ce217ee656713b99097eaef,2018-08-08 10:49:59
4fd75fb5ef1f01c7585bf746092a1544,2018-05-16 16:10:21
a9c6cd6cf9583fa5820d55c21238f78e,2018-05-07 21:49:08
58ffe52cbd8077e75af00321bd152ce2,2018-06-09 11:02:51
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49
d19813c8754cc82d0add67df8bd8a38c,2018-04-03 20:44:15
24d47eeeee1e60eb5caf099281d0b3b8,2018-06-05 11:36:11
7aed8da5ae4e0e34226c47f3bf041956,2017-06-29 00:10:49
de1e5517fb50896bbdcff5814fb31802,2018-02-28 08:57:03
3e87356efef361b40b30fd699f9e5638,2018-03-07 15:37:22
282d52f23f7c0ece9340d411c4d2cdd9,2017-12-01 20:39:26
a207382f0f563c1f430ef732ade9d9ff,2017-05-08 12:22:44
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19
70ab5e994ea383619a19687837eedbbc,2017-10-25 13:32:46
6abf781c5304890987047e9aa239caa8,2018-03-04 15:58:09
229c98245e2b6995b67be1e1921e62d1,2017-08-05 19:30:41
f3223fd3b2517fa73ebb06dd5f1b0e99,2017-09-11 09:40:11
a57a381a12573edc7711887551fc961c,2017-10-12 23:11:44
4913f37a6cb9e2ba061770efb2ea4e58,2017-02-17 17:37:52
3a6586139c630a9648d74d1da4a11cd8,2018-07-01 21:12:33
6b74fa3521fe75edbeff9948022f13d1,2017-05-03 14:31:43
ce0518f0279ef8b73d94633720e70b9f,2017-09-03 15:21:44
d7c4d8b45b0a33ff6df7a3950800d4e8,2018-07-30 18:25:18
3d2b9ce5685b7810c56c6b8babb0432e,2017-11-26 12:15:07
366e99a4996b3f8f781b60d7549f9e38,2018-01-25 19:46:47
511565b2987c19e165331306886f10f8,2017-10-17 15:58:05
f9ed63010ec897e6fb2c5ce868195a18,2018-01-03 16:29:52
f36d397e361b66b7220f849320541fd8,2017-08-31 09:31:20
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52
b59948a7b140d0a16d1683138820eed9,2017-09-11 15:39:11
e7fb8d2c8a581e31b93defd84ee988fe,2018-04-30 11:18:47
993a76ab0714792eb45d4ebdd58e9a1c,2018-01-05 11:04:11
2acac3dfe4fa0e75b07461873a67e7e6,2017-01-27 00:34:10
64e006a132d86c9189f9656a1cb41939,2017-12-06 09:53:36
7e016f9ea275279784f42e0642214284,2017-11-20 16:21:04
933bf00ad9a4f8bfd36bd85e09bd6cba,2017-06-29 23:08:50
ff0a44202beb5310644a0ea439973f4d,2018-08-19 11:28:11
2fdffca8dcdf01547529d45f7f4e8e8f,2018-07-31 20:47:41
a4a00c41b5e3ed88bf0e0bb96576c2b2,2017-12-15 23:33:32
aaaa6531d040b9cef69bf13af9be2fd6,2018-07-25 07:39:35
46ec8bcd9649f0f7bbb179bb59d6702e,2018-07-23 11:30:12
ef21aebbb093a6db29ccc6aa0b89c347,2016-10-05 15:08:00
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18
698e55af1f6f37f7f304a74eb93b85b0,2017-02-26 17:33:51
9a516f56e5f6f198350066cc99339bb0,2018-01-11 12:20:07
33bfc91146c9eea42397a0430585ee59,2017-11-30 13:34:43
7ee968b8ed74301e0cbd3e44416cad9d,2018-03-19 21:50:14
a81e8424b6bfd433cfef8d7bcb36b26d,2018-06-16 18:31:23
fd673a07896aec385c5287234605f166,2017-01-14 15:42:20
bf22881f1f23a79916784ac5b4319c56,2017-04-13 17:26:06
cb1b31ec399f6183dee790a4c349e712,2017-12-01 07:15:07
284e326e8a71e55bdb0b210ddfabaa27,2018-08-06 18:45:01
cb1d99010eebd5ee5b64dc9e37caa9d4,2018-05-18 11:26:45
5c4a6f6b98ec2d780b10f1cc88ef208f,2018-05-02 13:17:54
449057269c318304d8a753f64c181b07,2018-01-04 13:14:34
1f184001b4cbba29eb3ddefd7b0a195b,2017-08-16 08:00:13
ea0b7ca96e72354232c17d72b8bdf66d,2017-03-04 09:55:08
5b6e97fea8528cf0060d86dbd82f9c4a,2018-06-27 16:11:38
6a4ea2081853cd8dd8d7c69cdf86925a,2017-05-11 21:36:10
8ca53db6e60cffad03828535d1fcc1a2,2018-02-27 08:31:17
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01
4cd756c714ca569c2450c24782004147,2017-06-27 17:58:14
d79764082a836f215312d98c964ce478,2018-03
Query:
SELECT o."customer_id", SUM(oi."price") AS "total_spent"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
   GROUP BY o."customer_id"
   ORDER BY "total_spent" DESC
   LIMIT 100;
Answer:
customer_id,total_spent
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
e0a2412720e9ea4f26c1ac985f6a7358,4599.9
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
4312e816d88fa8bdb6246878f61cdad5,2999.89
fd78e5e3abdc375368456fe738694c00,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a5c69c3bf293d341b6a56a4b7307c529,2899.0
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
5f87c05477db2d22c63b718299c9c03e,2700.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
a8f345f82667eb421151dc7626147636,2699.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
3690e975641f01bd07ad635f03dbb894,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
03a6f3a3935165f5d26f4797ba6039bb,2492.5
279ca766397588e704abddd56d2dc131,2470.5
9537f2addba8448428a3fd1a1add0656,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
b76816b61d8043a98db57875437da6b5,2400.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
30ab7e538292e6130a456c371778d595,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
177ba55869da8001fcca079af0b85832,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
2b7ae7a532ff538ce88f6bfdd2cb564c,2350.0
f08306b95370e8d5f0d97b71229284b6,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
24301c6ce48874a51221d4e5584a7885,2299.95
9125dbd39c45287dfab9207f3cb15075,2299.95
d791834a0555c0062e98d735083f4373,2299.95
Query:
SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
   FROM E_COMMERCE.E_COMMERCE.ORDERS
   GROUP BY "customer_id"
   ORDER BY "order_count" DESC
   LIMIT 100;
Answer:
customer_id,order_count
3b6828a50ffe546942b7a473d70ac0fc,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
f54a9f0e6b351c431402b8461ea51999,1
62b423aab58096ca514ba6aa06be2f98,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
3a874b4d4c4b6543206ff5d89287f0c3,1
456dc10730fbdba34615447ea195d643,1
2a1dfb647f32f4390e7b857c67458536,1
816f8653d5361cbf94e58c33f2502a5c,1
3391c4bc11a817e7973e498b0b023158,1
f178c1827f67a8467b0385b7378d951a,1
12fd2740039676063a874b9567dfa651,1
5dda11942d4f77bee3a46d71e442aec4,1
74805bc388861fa350ed2fade8444e0b,1
6772a0a230a2667d16c3620f000e1348,1
2c3642e1392097fb4af76a76fec16a46,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
494dded5b201313c64ed7f100595b95c,1
3187789bec990987628d7a9beb4dd6ac,1
059f7fc5719c7da6cbafe370971a8d70,1
7e20bf5ca92da68200643bda76c504c6,1
fc849c5fbc7e2b0c7cfebc138886c693,1
fb9590a1e30e0ba8304ea73a31325797,1
4c9c7c2b6de6ee2568681b5599bb7495,1
cce89a605105b148387c52e286ac8335,1
636e15840ab051faa13d3f781b6e4233,1
29cb486c739f9774c8eb542e07b56cd2,1
13fd7ce9f08449dec2533119379a2527,1
e8a332c3433fbd37920ec89fc295d075,1
62ffae18a7ca4b2e681c6296180ae346,1
39f944145e00598d075faec0bb1f447a,1
ddaff536587109b89777e0353215e150,1
1833a0540067becaf59368fe4cd4303a,1
38ccd077e65d89b8a720be73bfaa9c6f,1
a2cb2bc236e62cf807925d6cecc245c6,1
a8b396cd7edcd4340e02a07685084cd6,1
2932d241d1f31e6df6c701d52370ae02,1
df9b032b2ad0fd6bf37dfb48e5f83845,1
e28dd4261bed9c7ba89ecaf411b88f7c,1
148348ff65384b4249b762579532e248,1
684fa6da5134b9e4dab731e00011712d,1
68451b39b1314302c08c65a29f1140fc,1
d68901955dc622165460ba6cb4ac49f3,1
83257fb6f3a1edd3a75464178aa3f382,1
eecf2b94cdbe9ef6245fabb5e091c987,1
597950088114c1a9e2b27459051f40ff,1
48f239e15744ed5e7ffbafc6bb6e882b,1
f7398fc942c8fa80e5419ae52e49f7fb,1
b7ee9b824b4a83b389379ac70585bf3b,1
ebfb3f2e532c37d5a959ded000c9f603,1
ac7e3d34240c0ebfc003455c2e04d10a,1
ed8c52327eecff596e141636d5b556d2,1
8ebe25aca53cef9a055de5c20eca76e7,1
19402a48fe860416adf93348aba37740,1
d2b091571da224a1b36412c18bc3bbfe,1
241e78de29b3090cfa1b5d73a8130c72,1
9bdf08b4b3b52b5526ff42d37d47f222,1
4afc1dcca5fe8926fc97d60a4497f8ab,1
8644be24d48806bc3a88fd59fb47ceb1,1
ef15b3240b2083e0487762ee2978d2b8,1
9f5a2f912f123d541a318029712fe90b,1
148ecba880f508ca2d5b6744b6a7b6c5,1
167b9485947ed0a354a3f8dad04eb199,1
bf141bf67fbe428d558bcf0e018eab60,1
4f28355e5c17a4a42d3ce2439a1d4501,1
48558a50a7ba1aab61891936d2ca7681,1
57ee2ef64f17a5f9a4bf30489b06326c,1
72ae281627a6102d9b3718528b420f8a,1
22eb8142d6313bab19fa6c657170ae6b,1
0dd5a932b1e29daa12845dbf696cbb54,1
68c85132eb3b96fbe6cbddc09a568d24,1
5cff2efe34e8e604619520cc86201235,1
03b3813a78be4cf5205e70977ad78d29,1
503740e9ca751ccdda7ba28e9ab8f608,1
a166da34890074091a942054b36e4265,1
756fb9391752dad934e0fe3733378e57,1
81e08b08e5ed4472008030d70327c71f,1
0b9e85491c194a97516c87f30a93abfa,1
2b47ff70d422cc3ada976dea40f48782,1
d4c5a2a1316f738e72e179d6bb3b6d8f,1
31ad1d1b63eb9962463f764d4e6e0c9d,1
d3e3b74c766bc6214e0c830b17ee2341,1
8b212b9525f9e74e85e37ed6df37693e,1
9b18f3fc296990b97854e351334a32f6,1
05e996469a2bf9559c7122b87e156724,1
a51b373c427132a77b112ca10f502c4f,1
738b086814c6fcc74b8cc583f8516ee3,1
52142aa69d8d0e1247ab0cada0f76023,1
eb1c0e1ca3e17eccaefb7f0d4dc659b1,1
b896b244963dc7543d400ad82d6710e0,1
295ae9b35379e077273387ff64354b6f,1
3df704f53d3f1d4818840b34ec672a9f,1
41ce2a54c0b03bf3443c3d931a367089,1
9ef432eb6251297304e76186b10a928d,1
332df68ccac2f2f7d9e11299188f8bce,1
c77ee2d8ba1614a4d489a44166894938,1
f5afca14dfa9dc64251cf2b45c54c363,1
4fa1cd166fa598be6de80fa84eaade43,1
ed0271e0b7da060a393796590e7b737a,1
f88197465ea7920adcdbec7375364d82,1
Query:
SELECT o."customer_id", SUM(oi."price") / COUNT(DISTINCT o."order_id") AS "avg_sales_per_order"
   FROM E_COMMERCE.E_COMMERCE.ORDERS o
   JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
   GROUP BY o."customer_id"
   ORDER BY "avg_sales_per_order" DESC
   LIMIT 100;
Answer:
customer_id,avg_sales_per_order
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
e0a2412720e9ea4f26c1ac985f6a7358,4599.9
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
fd78e5e3abdc375368456fe738694c00,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
a5c69c3bf293d341b6a56a4b7307c529,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
5f87c05477db2d22c63b718299c9c03e,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
8401401a8752eb431189e021b8009e37,2649.99
695476b5848d64ba0875324c88390206,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
3690e975641f01bd07ad635f03dbb894,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
03a6f3a3935165f5d26f4797ba6039bb,2492.5
279ca766397588e704abddd56d2dc131,2470.5
9537f2addba8448428a3fd1a1add0656,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
233d97d412c7f4bb8d857ec922c0317f,2399.0
177ba55869da8001fcca079af0b85832,2399.0
30ab7e538292e6130a456c371778d595,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
2b7ae7a532ff538ce88f6bfdd2cb564c,2350.0
f08306b95370e8d5f0d97b71229284b6,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
d791834a0555c0062e98d735083f4373,2299.95
24301c6ce48874a51221d4e5584a7885,2299.95
Query:
SELECT DISTINCT "order_status"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    LIMIT 100;
Answer:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved
Query:
SELECT "order_status", COUNT("order_id") AS "order_count"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "order_status"
    ORDER BY "order_count" DESC
    LIMIT 100;
Answer:
order_status,order_count
delivered,96478
shipped,1107
canceled,625
unavailable,609
invoiced,314
processing,301
created,5
approved,2
Query:
SELECT "customer_id", MIN("order_purchase_timestamp") AS "first_purchase_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "customer_id"
    LIMIT 100;
Answer:
Too long, hard cut:
customer_id,first_purchase_date
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
c77ee2d8ba1614a4d489a44166894938,2018-02-19 20:31:09
35ec6c1ca9e5844c5ca94214cce16dca,2018-02-21 17:15:49
456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
68c85132eb3b96fbe6cbddc09a568d24,2017-06-27 23:11:57
86ff82570097f39b2193254f540e4a69,2017-11-17 21:14:42
fbfba770bf13f470f63d1854a765a2d3,2018-01-18 09:30:54
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50
93ada7a24817edda9f4ab998fa823d16,2018-02-27 12:55:42
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18
2c3642e1392097fb4af76a76fec16a46,2018-08-26 11:04:26
b896b244963dc7543d400ad82d6710e0,2017-09-27 12:07:22
6454e6cba392b35aa21527063026fc92,2018-03-07 23:00:33
df5c9e02596851fcbfc98804e4108bbd,2017-12-02 14:28:03
4924a47e8cd5630b3564e26fac55c5ec,2018-07-18 13:39:54
8ed14e450a6268ec13f325e7c2eafeed,2018-02-02 16:15:41
a8331c35b57d8fe09e8df1c06509de29,2018-02-28 17:00:28
243ee97e01766bf68c3e30f0fe572490,2017-06-25 19:30:09
9f5a2f912f123d541a318029712fe90b,2017-09-12 16:32:09
45c9fcdb0cd88a5630cb4405c4d2e4a7,2018-02-27 10:05:56
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14
05e996469a2bf9559c7122b87e156724,2017-08-09 18:32:47
e28087daa16ea2d4ef377fd789af20b4,2018-01-25 23:13:41
6d491c9fe2f04f6e2af6ec033cd8907c,2017-11-17 19:53:21
ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
a559b10d4f093640a0ed4693ce16ed02,2018-04-26 11:59:05
ed8c52327eecff596e141636d5b556d2,2017-11-24 16:56:46
8ebe25aca53cef9a055de5c20eca76e7,2017-12-11 21:43:24
271f76c70ce217ee656713b99097eaef,2018-08-08 10:49:59
4fd75fb5ef1f01c7585bf746092a1544,2018-05-16 16:10:21
a9c6cd6cf9583fa5820d55c21238f78e,2018-05-07 21:49:08
58ffe52cbd8077e75af00321bd152ce2,2018-06-09 11:02:51
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49
d19813c8754cc82d0add67df8bd8a38c,2018-04-03 20:44:15
24d47eeeee1e60eb5caf099281d0b3b8,2018-06-05 11:36:11
7aed8da5ae4e0e34226c47f3bf041956,2017-06-29 00:10:49
de1e5517fb50896bbdcff5814fb31802,2018-02-28 08:57:03
3e87356efef361b40b30fd699f9e5638,2018-03-07 15:37:22
282d52f23f7c0ece9340d411c4d2cdd9,2017-12-01 20:39:26
a207382f0f563c1f430ef732ade9d9ff,2017-05-08 12:22:44
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19
70ab5e994ea383619a19687837eedbbc,2017-10-25 13:32:46
6abf781c5304890987047e9aa239caa8,2018-03-04 15:58:09
229c98245e2b6995b67be1e1921e62d1,2017-08-05 19:30:41
f3223fd3b2517fa73ebb06dd5f1b0e99,2017-09-11 09:40:11
a57a381a12573edc7711887551fc961c,2017-10-12 23:11:44
4913f37a6cb9e2ba061770efb2ea4e58,2017-02-17 17:37:52
3a6586139c630a9648d74d1da4a11cd8,2018-07-01 21:12:33
6b74fa3521fe75edbeff9948022f13d1,2017-05-03 14:31:43
ce0518f0279ef8b73d94633720e70b9f,2017-09-03 15:21:44
d7c4d8b45b0a33ff6df7a3950800d4e8,2018-07-30 18:25:18
3d2b9ce5685b7810c56c6b8babb0432e,2017-11-26 12:15:07
366e99a4996b3f8f781b60d7549f9e38,2018-01-25 19:46:47
511565b2987c19e165331306886f10f8,2017-10-17 15:58:05
f9ed63010ec897e6fb2c5ce868195a18,2018-01-03 16:29:52
f36d397e361b66b7220f849320541fd8,2017-08-31 09:31:20
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52
b59948a7b140d0a16d1683138820eed9,2017-09-11 15:39:11
e7fb8d2c8a581e31b93defd84ee988fe,2018-04-30 11:18:47
993a76ab0714792eb45d4ebdd58e9a1c,2018-01-05 11:04:11
2acac3dfe4fa0e75b07461873a67e7e6,2017-01-27 00:34:10
64e006a132d86c9189f9656a1cb41939,2017-12-06 09:53:36
7e016f9ea275279784f42e0642214284,2017-11-20 16:21:04
933bf00ad9a4f8bfd36bd85e09bd6cba,2017-06-29 23:08:50
ff0a44202beb5310644a0ea439973f4d,2018-08-19 11:28:11
2fdffca8dcdf01547529d45f7f4e8e8f,2018-07-31 20:47:41
a4a00c41b5e3ed88bf0e0bb96576c2b2,2017-12-15 23:33:32
aaaa6531d040b9cef69bf13af9be2fd6,2018-07-25 07:39:35
46ec8bcd9649f0f7bbb179bb59d6702e,2018-07-23 11:30:12
ef21aebbb093a6db29ccc6aa0b89c347,2016-10-05 15:08:00
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18
698e55af1f6f37f7f304a74eb93b85b0,2017-02-26 17:33:51
9a516f56e5f6f198350066cc99339bb0,2018-01-11 12:20:07
33bfc91146c9eea42397a0430585ee59,2017-11-30 13:34:43
7ee968b8ed74301e0cbd3e44416cad9d,2018-03-19 21:50:14
a81e8424b6bfd433cfef8d7bcb36b26d,2018-06-16 18:31:23
fd673a07896aec385c5287234605f166,2017-01-14 15:42:20
bf22881f1f23a79916784ac5b4319c56,2017-04-13 17:26:06
cb1b31ec399f6183dee790a4c349e712,2017-12-01 07:15:07
284e326e8a71e55bdb0b210ddfabaa27,2018-08-06 18:45:01
cb1d99010eebd5ee5b64dc9e37caa9d4,2018-05-18 11:26:45
5c4a6f6b98ec2d780b10f1cc88ef208f,2018-05-02 13:17:54
449057269c318304d8a753f64c181b07,2018-01-04 13:14:34
1f184001b4cbba29eb3ddefd7b0a195b,2017-08-16 08:00:13
ea0b7ca96e72354232c17d72b8bdf66d,2017-03-04 09:55:08
5b6e97fea8528cf0060d86dbd82f9c4a,2018-06-27 16:11:38
6a4ea2081853cd8dd8d7c69cdf86925a,2017-05-11 21:36:10
8ca53db6e60cffad03828535d1fcc1a2,2018-02-27 08:31:17
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01
4cd756c714ca569c2450c24782004147,2017-06-27 17:58:14
d79764082a836f215312d98c964ce478,2018-0
Query:
SELECT o."customer_id", SUM(oi."price") AS "total_spent_delivered"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    GROUP BY o."customer_id"
    ORDER BY "total_spent_delivered" DESC
    LIMIT 100;
Answer:
customer_id,total_spent_delivered
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
fd78e5e3abdc375368456fe738694c00,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a5c69c3bf293d341b6a56a4b7307c529,2899.0
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
5f87c05477db2d22c63b718299c9c03e,2700.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b177ef267a4377b77e0620d1a7f08dce,2649.0
b1c28f9b72d07054b64d09e487b5021c,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
30ab7e538292e6130a456c371778d595,2399.0
177ba55869da8001fcca079af0b85832,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
f08306b95370e8d5f0d97b71229284b6,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
e683dddabd8f5c3ad3708a3364e932f8,2300.0
f767e7437c3aa2c044523c0a6712380b,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0
Query:
SELECT "customer_id", COUNT(DISTINCT "order_id") AS "delivered_order_count"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" ILIKE '%delivered%'
    GROUP BY "customer_id"
    ORDER BY "delivered_order_count" DESC
    LIMIT 100;
Answer:
customer_id,delivered_order_count
f54a9f0e6b351c431402b8461ea51999,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
503740e9ca751ccdda7ba28e9ab8f608,1
19402a48fe860416adf93348aba37740,1
494dded5b201313c64ed7f100595b95c,1
3b6828a50ffe546942b7a473d70ac0fc,1
059f7fc5719c7da6cbafe370971a8d70,1
ddaff536587109b89777e0353215e150,1
72ae281627a6102d9b3718528b420f8a,1
756fb9391752dad934e0fe3733378e57,1
f5618502bee8eafdee72fb6955e2ebdf,1
569cf68214806a39acc0f39344aea67f,1
9f6618c17568ac301465fe7ad056c674,1
fee181bf648906d1c57f84f216976286,1
fb9590a1e30e0ba8304ea73a31325797,1
62ffae18a7ca4b2e681c6296180ae346,1
5883f965ac70043c2e908c3657c5d548,1
d9ef95f98d8da3b492bb8c0447910498,1
2a1dfb647f32f4390e7b857c67458536,1
f5afca14dfa9dc64251cf2b45c54c363,1
684fa6da5134b9e4dab731e00011712d,1
328d7a69cb9cbaf088eed3ed778804bb,1
4afc1dcca5fe8926fc97d60a4497f8ab,1
6772a0a230a2667d16c3620f000e1348,1
456dc10730fbdba34615447ea195d643,1
911e4c37f5cafe1604fe6767034bf1ae,1
295ae9b35379e077273387ff64354b6f,1
3df704f53d3f1d4818840b34ec672a9f,1
8628fac2267e8c8804525da99c10ed0e,1
e8a332c3433fbd37920ec89fc295d075,1
c572fd6cdd98e87ea2bc433b6da21078,1
eb1c0e1ca3e17eccaefb7f0d4dc659b1,1
f178c1827f67a8467b0385b7378d951a,1
d19f254a07da73a055409256e9bfe40a,1
ed8c52327eecff596e141636d5b556d2,1
48558a50a7ba1aab61891936d2ca7681,1
62b423aab58096ca514ba6aa06be2f98,1
4f28355e5c17a4a42d3ce2439a1d4501,1
9b18f3fc296990b97854e351334a32f6,1
241e78de29b3090cfa1b5d73a8130c72,1
4632eb5a8f175f6fe020520ae0c678f3,1
3135962ee745ef39b85576df7ddbaa99,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
d0e6cb83a3fc27f56be011b2941f54c6,1
2528510465c7572dedee4431a7d52e08,1
330ca6b207006779da875ef48faef608,1
eecf2b94cdbe9ef6245fabb5e091c987,1
b53cc3c992caaa45ec73cfdde4d839b5,1
02ed2cff54eb047cdbe79dd0535945d4,1
b6f05b99667a02c3722610a7bb6b4062,1
e5b70244ffbbac9f5ebde9ecdfc049f9,1
0f5b40f9925b49675464fb74869c6547,1
8dd1c4e88c1db62830ab1f7c56b6ee42,1
d2b091571da224a1b36412c18bc3bbfe,1
cf8ffeddf027932e51e4eae73b384059,1
74805bc388861fa350ed2fade8444e0b,1
be8c14c16a4d47194ccdfe10f1fc5b1a,1
8644be24d48806bc3a88fd59fb47ceb1,1
bb2f5e670f7155dc622c57e4b31d0a69,1
5bb39c890c91b1d26801aa19a9336eac,1
d0e71d7a6dbca8ac513ac63d08a81fa0,1
dd5095632e3953fc0947b8ab5176b0be,1
a8b396cd7edcd4340e02a07685084cd6,1
ef15b3240b2083e0487762ee2978d2b8,1
68c85132eb3b96fbe6cbddc09a568d24,1
a78b75a2ad06180de06b82857ca442b3,1
167b9485947ed0a354a3f8dad04eb199,1
df5c9e02596851fcbfc98804e4108bbd,1
c1ddb7521d14db9071dccad0a94305c2,1
3a874b4d4c4b6543206ff5d89287f0c3,1
1833a0540067becaf59368fe4cd4303a,1
243ee97e01766bf68c3e30f0fe572490,1
4fa1cd166fa598be6de80fa84eaade43,1
cce89a605105b148387c52e286ac8335,1
7f2178c5d771e17f507d3c1637339298,1
2c3642e1392097fb4af76a76fec16a46,1
2b56e94c2f66f2d97cfa63356f69cee8,1
afb19a4b667cb708caab312757ec3d3f,1
93ada7a24817edda9f4ab998fa823d16,1
e1862648f338ecaf4242e8e2b59126ca,1
aa3d8c9eec8e52e90b117efe5e97a560,1
57ee2ef64f17a5f9a4bf30489b06326c,1
7711cf624183d843aafe81855097bc37,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
79183cd650e2bb0d475b0067d45946ac,1
f26a435864aebedff7f7c84f82ee229f,1
4c9c7c2b6de6ee2568681b5599bb7495,1
8b212b9525f9e74e85e37ed6df37693e,1
7251aa758779438faea714941f1051c4,1
cf9e2b07f78cce347089900f49fb4746,1
816f8653d5361cbf94e58c33f2502a5c,1
9bdf08b4b3b52b5526ff42d37d47f222,1
41ce2a54c0b03bf3443c3d931a367089,1
9ef432eb6251297304e76186b10a928d,1
5dda11942d4f77bee3a46d71e442aec4,1
148348ff65384b4249b762579532e248,1
55e6b290205c84ddd23ddf5eb134efd4,1
d3e3b74c766bc6214e0c830b17ee2341,1
8ab97904e6daea8866dbdbc4fb7aad2c,1
f88197465ea7920adcdbec7375364d82,1
Query:
SELECT "customer_id", MIN("order_purchase_timestamp") AS "first_purchase", MAX("order_purchase_timestamp") AS "last_purchase"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    GROUP BY "customer_id"
    LIMIT 100;
Answer:
Too long, hard cut:
customer_id,first_purchase,last_purchase
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
a9d37ddc8ba4d9f6dbac7d8ec378cc95,2018-07-15 08:33:19,2018-07-15 08:33:19
f26a435864aebedff7f7c84f82ee229f,2017-07-30 03:06:35,2017-07-30 03:06:35
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
388025bec8128ff20ec1a316ed4dcf02,2017-04-20 17:15:46,2017-04-20 17:15:46
d0e71d7a6dbca8ac513ac63d08a81fa0,2018-04-25 22:18:10,2018-04-25 22:18:10
5232c22d7ed2b631db6b2cab74b2c5f2,2018-08-01 10:48:19,2018-08-01 10:48:19
5dda11942d4f77bee3a46d71e442aec4,2018-01-07 21:44:54,2018-01-07 21:44:54
e8a332c3433fbd37920ec89fc295d075,2017-09-29 09:32:17,2017-09-29 09:32:17
4c9c7c2b6de6ee2568681b5599bb7495,2018-05-08 22:12:34,2018-05-08 22:12:34
fa5c31ea5a141cb29a683b6420f2693a,2017-09-20 17:12:34,2017-09-20 17:12:34
f7398fc942c8fa80e5419ae52e49f7fb,2018-04-15 19:42:06,2018-04-15 19:42:06
a338f42b6e47cb49d5c5128a348b76ba,2018-05-15 19:55:51,2018-05-15 19:55:51
56dfafb543cfa4c2edcc08b9b2c5f0c6,2017-08-01 18:52:12,2017-08-01 18:52:12
b3519c0352b07bc3017acebea4ce6724,2017-11-16 14:32:06,2017-11-16 14:32:06
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14,2018-05-08 14:38:14
ed532487db04478dfba09d112649fc13,2018-02-01 07:47:34,2018-02-01 07:47:34
86acfb656743da0c113d176832c9d535,2018-02-08 18:56:45,2018-02-08 18:56:45
64a254d30eed42cd0e6c36dddb88adf0,2017-11-16 15:09:28,2017-11-16 15:09:28
977275bd3cd425aa9926a3388658f485,2018-03-09 14:58:05,2018-03-09 14:58:05
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49,2017-11-11 22:16:49
53379b14e4048e025dc5a2185f461bb7,2018-03-27 22:14:59,2018-03-27 22:14:59
da2fbad9b2235c67c9bc7c7a274ee389,2018-08-03 13:32:54,2018-08-03 13:32:54
b7b15ab12fa50616eee696a22f098e07,2017-01-21 17:08:01,2017-01-21 17:08:01
5d6e19aed6284c2fcb4b1a0eba6820de,2018-08-21 16:45:44,2018-08-21 16:45:44
ffdc2af7160aed3bad21cbc8ec68c0c5,2017-05-20 02:48:00,2017-05-20 02:48:00
5265029daa29cc08d86b9f96cd99d03f,2018-04-18 15:40:36,2018-04-18 15:40:36
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19,2018-03-29 22:46:19
364fbe9334877bc7ca3da92913b2cdbf,2017-06-02 14:00:19,2017-06-02 14:00:19
610a4163b8ab832daf93b4fbb48e9119,2017-11-19 16:12:34,2017-11-19 16:12:34
2f9902d85fcd930227f711cf47012bdf,2017-05-10 14:03:27,2017-05-10 14:03:27
940526d0df4938d234d0a900268106c4,2017-08-28 22:47:13,2017-08-28 22:47:13
9c338ea8093192e203bc16add78c123c,2017-11-21 12:08:32,2017-11-21 12:08:32
a4156bb8aff5d6722dc68f605d8fa241,2017-09-26 11:08:38,2017-09-26 11:08:38
ddbd5d378c4a0981ba1ef29fb8e40b8f,2017-09-13 15:07:45,2017-09-13 15:07:45
d44c356f894fa28cffe33c455abb72ba,2017-08-17 17:03:31,2017-08-17 17:03:31
24c63a7108d652ad0ed85589c4575297,2018-06-13 22:54:20,2018-06-13 22:54:20
18c934f4cdc994cd04eb13bce3f47a18,2018-02-02 15:26:38,2018-02-02 15:26:38
f31eb05ebdef1ede72cebeba759e7c92,2018-08-06 22:25:10,2018-08-06 22:25:10
021e84751ba0ead75b6d314a6ead88d9,2017-08-01 18:17:41,2017-08-01 18:17:41
1f7945736d0f303827055ca99168ad20,2017-04-03 23:09:50,2017-04-03 23:09:50
016c5c3fb572754f302fdac24aa9cfa4,2018-06-04 08:33:09,2018-06-04 08:33:09
5072cf2f4cbec30b8ba917d5d7b6b125,2017-04-27 14:17:37,2017-04-27 14:17:37
40eb5b16b04bc62c59d4905857958e82,2017-10-31 21:47:13,2017-10-31 21:47:13
e54367d4b00c5cb76d2dfe71b9bdb89c,2018-07-04 16:49:21,2018-07-04 16:49:21
c5064807abdc55acd37860160154ed1a,2018-08-27 13:57:36,2018-08-27 13:57:36
90714b0e62fe1fbd304fb45fd644ebdd,2018-02-24 08:45:01,2018-02-24 08:45:01
17ebae22126d3df35f5e1fa1efedab94,2018-05-17 07:17:54,2018-05-17 07:17:54
5957d9ae822bcbe88c00fb8286362339,2018-03-01 12:43:37,2018-03-01 12:43:37
32fa597a3b06db1949ee96c416335b6b,2018-03-01 20:30:22,2018-03-01 20:30:22
80f70f0ca0bcd19bf71e848e51206d68,2017-07-12 18:45:24,2017-07-12 18:45:24
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52,2017-07-04 23:29:52
08fe63b02e7e846c85b8a49b9fd540d9,2018-02-15 11:58:49,2018-02-15 11:58:49
99ae056139c928155fbb6789440c8824,2018-07-31 21:51:41,2018-07-31 21:51:41
6c5aeca0152670c75e44c9c67eb7c1f3,2018-01-22 15:24:44,2018-01-22 15:24:44
cb1e2bf26acb98ef66bb11447a218cc2,2017-02-25 14:34:40,2017-02-25 14:34:40
d436bce514752338004b26a232f21008,2018-05-16 13:47:51,2018-05-16 13:47:51
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01,2017-06-19 18:00:01
88196bd808ae8abe1b944efe1807b508,2017-11-19 20:06:12,2017-11-19 20:06:12
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18,2018-08-02 12:25:18
f1b66f0324a631de414bc2bf62b5e915,2018-06-23 19:29:12,2018-06-23 19:2
Query:
SELECT o."customer_id", SUM(oi."price") / COUNT(DISTINCT o."order_id") AS "avg_order_value_delivered"
    FROM E_COMMERCE.E_COMMERCE.ORDERS o
    JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" ILIKE '%delivered%'
    GROUP BY o."customer_id"
    ORDER BY "avg_order_value_delivered" DESC
    LIMIT 100;
Answer:
customer_id,avg_order_value_delivered
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
10a86619816f9d2afce3f45b04aabc71,2999.99
0a209a88c2e3dc2981c79ad85c558059,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
fd78e5e3abdc375368456fe738694c00,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
a5c69c3bf293d341b6a56a4b7307c529,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
5f87c05477db2d22c63b718299c9c03e,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
0c5292f5e3690805390efddf53935915,2600.0
349509b216bd5ec11c5fae929fd13595,2589.0
e9859fbdff7d26c36c228cf60796e844,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
177ba55869da8001fcca079af0b85832,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
30ab7e538292e6130a456c371778d595,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
f08306b95370e8d5f0d97b71229284b6,2338.08
e683dddabd8f5c3ad3708a3364e932f8,2300.0
f767e7437c3aa2c044523c0a6712380b,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0
Query:
SELECT o."customer_id", AVG(oi_totals."order_total") AS "avg_order_value_delivered"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN (
    SELECT "order_id", SUM("price") AS "order_total"
    FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS
    GROUP BY "order_id"
) oi_totals ON o."order_id" = oi_totals."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY o."customer_id"
ORDER BY "avg_order_value_delivered" DESC
LIMIT 100;
Answer:
customer_id,avg_order_value_delivered
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
0a209a88c2e3dc2981c79ad85c558059,2999.99
10a86619816f9d2afce3f45b04aabc71,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
fd78e5e3abdc375368456fe738694c00,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.3999999999996
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
a5c69c3bf293d341b6a56a4b7307c529,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.9
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
5f87c05477db2d22c63b718299c9c03e,2700.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
a8f345f82667eb421151dc7626147636,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
695476b5848d64ba0875324c88390206,2649.99
8401401a8752eb431189e021b8009e37,2649.99
b177ef267a4377b77e0620d1a7f08dce,2649.0
b1c28f9b72d07054b64d09e487b5021c,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
b76816b61d8043a98db57875437da6b5,2400.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
177ba55869da8001fcca079af0b85832,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
30ab7e538292e6130a456c371778d595,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f2c743697f9b2ff2902df23a16582d80,2338.08
f08306b95370e8d5f0d97b71229284b6,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0
Query:
-- Corrected Query 1
SELECT DISTINCT oi."product_id", oi."order_id"
FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON o."order_id" = oi."order_id"
WHERE o."order_status" = 'delivered'
LIMIT 100
Answer:
Too long, hard cut:
product_id,order_id
4244733e06e7ecb4970a6e2683c13e61,00010242fe8c5a6d1ba2dd792cb16214
e5f2d52b802189ee658865ca93d83a8f,00018f77f2f0320c557190d7a144bdd3
ef92defde845ab8450f9d70c526ef70f,00048cc3ae777c65dbb7d2a0634bc1ea
4535b0e1091c278dfd193e5a1d63b39f,0005f50442cb953dcd1d21e1fb923495
d63c1011f49d98b976c352955b1c4bea,00061f2a7bc09da83e415a52dc8a4af1
f177554ea93259a5b282f24e33f65ab6,00063b381e2406b52ad429470734ebd5
99a4788cb24856965c36a24e339b6058,0006ec9db01a64e59a68b2c340bf65a7
3f27ac8e699df3d300ec4a5d8c5cf0b2,0009c9a17f916a706d71784483a5d643
1c05e0964302b6cf68ca0d15f326c6ba,000f25f4d72195062c040b12dce9a18a
38afdf723b95d455b418a0f57d623c6b,0013503b13da1eac686219390b7d641b
b10eba910a974df70b8a12d0665cdb9e,00169e31ef4b29deaae414f9a5e95929
28b4eced95a52d9c437a4caf9d311b95,0019c29108428acffd089c36103c9440
4e3f399366b0047a572b6682f9bb166e,0025081dcf9330f9a5052ae82c6ce396
430d215740da7fdda91cc938f8fd92f6,002691433f09002ac9ca0c4e8dbb8ead
6490b9f63b0b595e1c1402b46b0f50ad,00275bce676303c3bfd7292aefdfa223
c2ece64199af7a53793ed9612a89a8cd,002af7fa9eb99d1456bceb6a13d6fc0b
d9c01b484ada6a360c2715a08fdf1568,00584d79015452d19fd3d044ba3abdc0
4089861a1bd4685da70bddd6b4f974f1,0016dfedd97fc2950e388d2971d718c7
777d2e438a1b645f3aec9bd57e92672c,001dbc16dc51075e987543d23a0507c7
df3655ac9aa8c6cbfa63bdd8d3b09c50,002834535f7a609a5c68266f173fa59e
54e5063e43f27f747d592eb24e913150,00324b3eda39ba5ecce3945823e3594c
0f80705139ce16ea35bb489987399b55,0072847849eafe70995fa51a714c81ac
f71a7c95a86564873cd996896b2976f6,008c3a655c66f4d92370d0d422732f69
cbecf0dca7a42c56c9ad9e20c74af1fd,00921e4911895b93c7b4fc0d80c0815e
ac6c3623068f30de03045865e4e10089,00042b26cf59d7ce69dfabb4e55b4fd9
310ae3c140ff94b03219ad0adc3c778f,0005a1a1728c9d785b8e2b08b904576c
21b1c2f67a9aafb5af0eb06c13b9dbda,00119ff934e539cf26f92b9ef0cdfed8
892832da5b05b0f54578e1f14f193c22,0026a368634b6e6f34f33b1499773a30
656e0eca68dcecf6a31b8ececfabe3e8,003f201cdd39cdd59b6447cff2195456
01cf56cd6138b926a4802d16fc304149,0044c6f6d22dd280534344177c81b989
2fb0efd1f61f186ffdda9e8ec70f27f2,0066a1fdaee16ad5022c5ef979d0b661
0ec7b6a863e219792bc4d50d3a62a839,007bbb40c95870c0f75a7855f2636c65
4bc3ab2ff016887e619e587a993af3bf,003f9bcc09427647c4b9d361a523545b
e1c0a39b7f806727ea5121c60035ed3c,0081ab2c99dc85945c28926b77dc6960
36826c711e5778c8d88a7311cc29c446,009838529bb913846ab6670d22865381
4834f24983a4f056e5ae64265f723aaf,00a1e977cf6e672402963940db55d919
c2ece64199af7a53793ed9612a89a8cd,00a690becda145533fa5a54daa7b6ad5
617186c3d97ea56c9c683a8a3974e8c1,009fa9bd0d92710e840793bfefa80867
6536314c94d43b787fc1c622941da14b,00a843f5a80c7aea894c558acc29f513
437c05a395e9e47f9762e677a7068ce7,00b8d354b36820e9d6131fd5173c5581
6131240aedf34224270cd6f07e8229e4,00c42b1633c1b2fa4e937bf312466561
2ffb8b836bb62d53a77a69a67814fffa,00c9d9e61ed13f5bf2f0344da1aa4775
4f3b83b83f7fb280fca4f90ba502f50e,00dfb074b5c910fbd08e04691c4b712f
69c5919a1b057b3d3d8b58f3b9b4b89d,00f426c7214575822c3cb44ea59ef0f6
9f69acd4da62618a3f6365b732d00ccd,011080783e02d05b26c8c158b3653a42
e8ca1ff2d0a28edb5be8bfbf2964dc3a,0113c9989fe6e5007795daec0633b405
dea3de7c4e7aa375d564fa2ddb7099b7,011af0959ebf2b09a062867811dc63b5
0c7ec2b24166d57ac38a9db523711782,012ea594e035047289b3e7c3f8b90cef
cc47c0863559499f01b4cad750929d10,002b430ff89b3a24c31a1170acbbedea
2948658cb6abc82847412be7201bfc4c,005997dca4c1fc45066d0a03d54a6469
03bb24d19ea7449ce170e0888d830707,005e5166e99d1e4d0c4f808b0540ba94
fa11ecd35f999783e96ac500532d9d45,0064d74f7de7917d54768d7722ad56ac
19421075ae0b585f2dc13ff149e2119d,0079bca8e89bd52fdb87408e4f3fb94d
a8115d34a4b7b74388da609692162c37,008990da719764fb392914d8ab53ad04
779559842fc122d55edbd03153f35e81,007ec946d4f798caf2b43c9d44c56421
bf06a69bb27c58156391de458700f3e7,0091a677651feaf5a08d7bb147681e14
d64e758afad411049a45e42c9a259241,0094bd07f49fed90209ffa62d1ef26d6
3cb39171fd36c50097f2dedbbe0dfe6e,011405ae7b89def8ffb3468eb29c299d
e3a23a99f074226ad690393a840c3244,012e93f8170eb75b2f2f650629d04517
8ef8561be5799da29925c5baaf083a13,014ac3cfd0e55bdc2cdd12aa181b00cb
2b0ee2d07306f7c9ac55a43166e9bb4b,019636907d07b2433be000d9d6bed153
c6dd917a0be2a704582055949915ab32,001862358bf858722e1e2ae000cfed8b
553e0e7590d3116a072507a3635d2877,000e63d38ae8c00bbcb5a30573b99628
fe59a1e006df3ac42bf0ceb876d70969,0017afd5076e074a48f1f1a4c7bac9c5
00ffe57f0110d73fd84d162252b2c784,0071ee2429bc1efdc43aa3e073a5290e
55782cb82e0efe052da0a3da237da3b2,0096668e5b0b8e9657a6f7209a4e58b4
5d7c23067ed3fc8c6e699b9373d5890b,001021efaa8636c29475e7734483457d
7614c62b86a81021243e438cfde78ccc,0029c5db35ef291ce99d1262012e7daa
d54c5b81fc2b38707588dd4eddc7c594,002f16b7bc4530031b7d90f791b12d8a
d41dc2f2979f52d75d78714b378d4068,002f98c0f7efd42638ed6100ca699b42
bd7cab8de4d7943286634023cc06f8ff,0030ff924c38549807645976adeef2c0
0c4a0f8ab44f9acd2d04e7024f9ba362,00526a9d4ebde463baee25f386963ddc
85b8a24337b4e2571f8fee38f4253a06,00772b2af35643653f108fdac1155ee3
f9d774a1820f792952eea079a40a7c6b,00789ce015e7e5791c7914f32bb4fad4
5a419dbf24a8c9718fe522b81c69f61a,0010b2e5201cc5f1ae7e9c6cc8f5bd00
71a5f1c2a5fd9889ef26b5ac22aec9
Query:
-- Corrected Query 2
SELECT oi."order_id", SUM(oi."freight_value") AS "total_freight"
FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON oi."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY oi."order_id"
LIMIT 100
Answer:
order_id,total_freight
00010242fe8c5a6d1ba2dd792cb16214,13.29
00018f77f2f0320c557190d7a144bdd3,19.93
000576fe39319847cbb9d288c5617fa6,70.75
0008288aa423d2a3f00fcb17cd7d8719,26.74
0009792311464db532ff765bf7b182ae,27.65
0009c9a17f916a706d71784483a5d643,11.34
000e562887b1f2006d75e0be9558292e,16.11
001021efaa8636c29475e7734483457d,15.1
00125cb692d04887809806618a2a145f,25.51
00130c0eee84a3d909e75bc08c5c3ca1,7.94
00137e170939bba5a3134e2386413108,24.65
0016dfedd97fc2950e388d2971d718c7,20.8
001dbc16dc51075e987543d23a0507c7,18.0
00254baeb6c932b0a8aeead91fbd02b5,43.11
002834535f7a609a5c68266f173fa59e,19.18
002955b0acc63d04f6724a31967e82bd,15.59
0029f17cf0e7640c5cb6825af681303f,18.54
002d040018d12a3853c059f7f23ab5b1,14.84
0036757472ece3dde52fd4bfd929c90e,66.04
003822434f91204da0a51fe4cf2aba18,37.16
004fb11815bc03b01b20a614eef69d14,19.75
0057199db02d1a5ef41bacbf41f8f63b,16.79
008fab5602c441d51f30b1464f5d4643,15.56
009905140e9f8cc35d5be897937381db,36.46
0011d82c4b53e22e84023405fb467e57,26.33
001b76dd48a5b1eee3e87778daa40df8,13.01
001daeb0eddc45b999bad0801ad9d273,16.79
0020a222f55eb79a372d0efee3cca688,15.1
0025081dcf9330f9a5052ae82c6ce396,18.23
002691433f09002ac9ca0c4e8dbb8ead,16.43
0026a368634b6e6f34f33b1499773a30,15.8
0029c5db35ef291ce99d1262012e7daa,21.62
0032d07457ae9c806c79368d7d9ce96b,27.19
003a7f59d7e08a9c61d9e2881fe6459c,15.28
004345d16a1ab2c21962992c721c8643,15.37
00482f2670787292280e0a8153d82467,10.96
0066a1fdaee16ad5022c5ef979d0b661,87.28
00789ce015e7e5791c7914f32bb4fad4,14.83
007ec946d4f798caf2b43c9d44c56421,15.1
0097f0545a302aafa32782f1734ff71c,41.84
00998f38df3012359ef195ca75ebb329,23.34
00a1e977cf6e672402963940db55d919,7.75
002af7fa9eb99d1456bceb6a13d6fc0b,21.11
0030ff924c38549807645976adeef2c0,67.24
003cc6161d7a2593f2525cce0c330d32,12.9
005d9a5423d47281ac463a968b3936fb,45.28
006c42f310102c1910b3c5793ce5fc34,20.8
0072847849eafe70995fa51a714c81ac,14.9
008f831b7185cff7ab35a46c37d64cd2,37.09
00a174dbf11967d260033fa6ab711493,41.53
00a4d94df1c9757661679b2f4bd6d311,21.43
0055b77cca3186676c147f532dd2547b,40.37
008c3a655c66f4d92370d0d422732f69,9.44
00b4a910f64f24dbcac04fe54088a443,16.6
00b4c651133c06fb175123a492f1cac3,14.59
00b9e0f8f588d0406a3de447eb606970,16.6
00c81b6675ef9ecaaff5fc1d6720b96c,14.1
00c842d0ae6462afc1d38fc055b02c75,17.67
00c95282163553a982f38481f9488481,18.0
00f6ac4816d12f49026b09f2aa77d15f,58.32000000000001
00fbcd8b120e5706c58b9d1a0026a7da,16.11
014a0793ab3d930d6f3b206cee474af4,18.24
014f1e63f9bd4f5578edcf4e5c305a0a,18.34
014ffbfe2df4c96a2b063d084583978f,15.3
000f25f4d72195062c040b12dce9a18a,44.4
001427c0ec99cf8af737bd88e92fd444,23.35
0015ebb40fb17286bea51d4607c4733c,15.1
00169e31ef4b29deaae414f9a5e95929,16.11
002b4e6fa42cd4a22cc86abc18fe9c05,19.67
006127b8b9a1681a982313ed7129c3c0,16.22
00921e4911895b93c7b4fc0d80c0815e,11.62
00a57dfbb049fbaae10763e2cf15f797,67.67999999999999
0006ec9db01a64e59a68b2c340bf65a7,23.32
00119ff934e539cf26f92b9ef0cdfed8,16.98
0014ae671de39511f7575066200733b7,14.1
0017afd5076e074a48f1f1a4c7bac9c5,44.29
001e7ba991be1b19605ca0316e7130f9,18.21
00259a44fcad3fc0474329e925d14fc3,14.1
00276d5c3491fbf55305e26891040df9,23.22
0028de0ca693a1bb26448916a81105cc,15.31
0030d783f979fbc5981e75613b057344,17.67
0035246a40f520710769010f752e7507,12.11
0035e6b7ade84b3f5b86bd49814793df,14.1
004157daafa0bc8672e01f00e4f0c04f,33.91
0045e3085f083f0f38d24bb3f22e6593,13.84
0046e1d57f4c07c8c92ab26be8c3dfc0,7.78
004ba47bb589cdbc485e6025bd6d3c81,11.85
004f5d8f238e8908e6864b874eda3391,15.61
004fb5e6f90a178dc74ad2b016649249,13.93
005a1dded353107dbabf8ffc83a20365,14.28
00611822267e76e0055c25c18506f06e,20.31
0071ee2429bc1efdc43aa3e073a5290e,12.46
00750f68bb64537034e93554c64b41b5,8.16
007beb35f98c075747e6fc4fd1c0cb73,18.69
0080eebb288dba1857ccf048dfe6bdfe,14.1
00946f674d880be1f188abc10ad7cf46,32.92
00975e709cd12c34d3bd44e4a7f7a876,7.86
0039500db36d50d7d0bfaf23723550f3,33.33
00404fa7a687c8c44ca69d42695aae73,0.0
004d76fef3dd46eb4f70da049c8d1f93,27.39
Query:
-- Corrected Query 3
SELECT oi."order_id", COUNT(oi."order_item_id") AS "items_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi
JOIN E_COMMERCE.E_COMMERCE.ORDERS o ON oi."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY oi."order_id"
ORDER BY "items_per_order" DESC
LIMIT 100
Answer:
order_id,items_per_order
8272b63d03f5f79c56e9e4120aec44ef,21
ab14fdcfbe524636d65ee38360e22ce8,20
1b15974a0141d54e36626dca3fdc731a,20
9ef13efd6949e4573a18964dd1bbe7f5,15
428a2f660dc84138d969ccd69a0ab6d5,15
73c8ab38f07dc94389065f7eba4f297a,14
9bdc4d4c71aa1de4606060929dee888c,14
37ee401157a3a0b28c9c6d0ed8c3b24b,13
af822dacd6f5cff7376413c03a388bb7,12
2c2a19b5703863c908512d135aa6accc,12
c05d6a79e55da72ca780ce90364abed9,12
637617b3ffe9e2f7a2411243829226d0,12
3a213fcdfe7d98be74ea0dc05a8b31ae,12
71dab1155600756af6de79de92e712e3,11
6c355e2913545fa6f72c40cbca57729e,11
5a3b1c29a49756e75f1ef513383c0c12,11
7f2c22c54cbae55091a09a9653fd2b8a,11
ca3625898fbd48669d50701aba51cd5f,10
30bdf3d824d824610a49887486debcaf,10
f80549a97eb203e1566e026ab66f045b,10
9aec4e1ae90b23c7bf2d2b3bfafbd943,10
f60ce04ff8060152c83c7c97e246d6a8,10
e8fa22c3673b1dd17ea315021b1f0f61,10
9f5054bd9a3c71702aa0917a7da29193,10
a483ffe0ce133740ab12ebcba8a3ccf9,10
f5aa338a071dcf7d23d8e6b116bfcab5,9
c52c7fbe316b5b9d549e8a25206b8a1f,9
f368c3e5edb7b7db5296654ed37464b2,9
612d140e314dab491efb33ec8219c2ee,8
03caa2c082116e1d31e67e9ae3700499,8
04993613aee4046caf92ea17b316dcfb,8
3cb5915708fd5b47246994508f858ffd,8
848b0561d4bc26f57b288a5004f38683,8
9a2b443dc8e6673e4fc330b3ea033569,8
be382a9e1ed25128148b97d6bfdb21af,8
4affd1928d3900a415e9886a179d5124,8
1c437b4d4326d36b71e91dd7a7c2c4f6,7
62073ec6b54b8e6322037fc0f3591ad3,7
487e6e67e10e5756f886f5994439c22f,7
9bdf94af058f959fbc09c3ea1eb32465,7
e332eda82fe7ca4e86daf4f71ca785df,7
cd51709c98c738351915f79c4318675e,7
8dd554aaa8e7d61ddde56ba4189c780f,7
ad850e69fce9a512ada84086651a2e7d,7
7b598857cddf46a156640f69f70a6e6d,7
895dce73de79888b14581541cf3a811b,7
3e6f06c624c7f67d6a0710e39ca97f2b,7
77df84f9195be22a4e9cb72ca9e8b4c2,7
1c11d0f4353b31ac3417fbfa5f0f2a8a,7
e37f11cae9985ca58f0b56f268720537,7
83f0c4c6b1a3c31214ca8266dc888258,7
df36d28de846593cdbc153e28f195cd5,7
df13cbaf3230c62a4b582317936e8a39,7
7d8f5bfd5aff648220374a2df62e84d5,7
dc3adcf742779e0c8eb5bd587ed4ec57,7
0c82a229fc22597c2361656cba8d3230,7
dc43adc8cf44306503fd3db002d5db5f,7
c33368133f0a06d3c803f11e48f17309,7
28cf49bbfe2683759d3cf866b7fda22f,6
44ca3a6e88412fa58bacabe95656aa63,6
9f36a6b11ec95b4f8586000d49dae422,6
468c8b5d4cee2be214b52f9602980779,6
3e9bdc72197be8d2881273a27efc207d,6
a2d8aaf39efc96fe140eda3e8f2e337e,6
2455cbeb73fd04b170ca2504662f95ce,6
201183426051cfc62c56f2414b2480e3,6
7683e28d403c6a04e30902e9e415eec8,6
7af905809ddbaaed2af20592006857e0,6
2bb6b9ebbb0ae5423d46be8e62e09538,6
3edb50273f0fec7a7e340030467076bc,6
ad71f559c9264f19bdacbc2062847e74,6
8f6f263a5e96515d5534199b74cb7748,6
55298973d17a0c1dfb2281ae969a65d8,6
8adafb3466daa5395694d3a906ff9d40,6
3e141e345041b9a2a2648dca90d431c7,6
aa0b425987bdeae4a29c616a2bc3a08a,6
ad1aeeb1a99c9f021e38a49865bb812c,6
ac48e79befd4d8cbfb58047dde3e43cf,6
3263e5243c28ebe706f7500cf88054ad,6
8fc11d5503f6e2b6e15242e0365633e4,6
82acff152625d343c9ef91512401c210,6
4c966c07e48f5460c75f69d0352a61be,6
3e073b27114fe955e184db124d34a566,6
1daecbe2a13ab0881c418e978f1e08c1,6
4ea517483bf1d3580730f6042334d158,6
50fc570b5b9de1500a9e66edcc9d8525,6
597233a841339cc9249ce67709f68574,6
2e8644b6852a0e75700c764e182ddbbe,6
2efe3d3b0ddc295d2ce1c43f021078cb,6
60b570df9018c6b6441017314a2dd081,6
7b1628af9aa95c57c63665fb81cced3b,6
b47f9f663e41971f0d31b1caa6468c40,6
200f4d883fcc701355e46b8c6035743f,6
47435f657d2323e5eb4455aa5bc6a436,6
99330d45c3ba6f45ad5745f6de036c5f,6
47399920ee7546351440204086acb793,6
0b0809b2b64511c62fb745fb8b465cc9,6
3f744e5030fb02e02651eb31d5204878,6
3990f96693d321ac142fff312bf3706a,6
30a022caf1ba5b86f28124ed216c859f,6
End Exploring Related Columns
Task: According to the RFM definition document, how much is the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders? Please rank the customers into segments to analyze differences in average sales across these segments

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
RFM_Segment,Average_Sales_Per_Order
Champions:str,avg_sales1:float
Can't Lose Them:str,avg_sales2:float
Hibernating:str,avg_sales3:float
Lost:str,avg_sales4:float
Loyal Customers:str,avg_sales5:float
Needs Attention:str,avg_sales6:float
Recent Users:str,avg_sales7:float
Potential Loyalists:str,avg_sales8:float
Price Sensitive:str,avg_sales9:float
Promising:str,avg_sales10:float
About to Sleep:str,avg_sales11:float
...
```

**Explanation:** The table above displays the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. This allows for the analysis of differences in average sales across these segments..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'E_COMMERCE': {'E_COMMERCE': ['CUSTOMERS', 'GEOLOCATION', 'LEADS_CLOSED', 'LEADS_QUALIFIED', 'ORDERS', 'ORDER_ITEMS', 'ORDER_PAYMENTS', 'ORDER_REVIEWS', 'PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION', 'SELLERS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 17:43:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:43:19 - root - INFO - ```sql
WITH
max_date AS (
    SELECT MAX("order_purchase_timestamp") AS "max_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" = 'delivered'
),
customer_data AS (
    SELECT
        o."customer_id",
        MAX(o."order_purchase_timestamp") AS "last_purchase_date",
        COUNT(DISTINCT o."order_id") AS "frequency",
        SUM(oi."price") AS "monetary"
    FROM
        E_COMMERCE.E_COMMERCE.ORDERS o
        JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE
        o."order_status" = 'delivered'
    GROUP BY
        o."customer_id"
),
customer_rfm AS (
    SELECT
        cd."customer_id",
        DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
        cd."frequency",
        cd."monetary"
    FROM
        customer_data cd
        CROSS JOIN max_date md
),
customer_rfm_scores AS (
    SELECT
        cr."customer_id",
        cr."recency",
        cr."frequency",
        cr."monetary",
        NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
        NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
        NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
    FROM
        customer_rfm cr
),
customer_rfm_segment AS (
    SELECT
        crs.*,
        (crs."F_score" + crs."M_score") AS "FM_sum",
        (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
        CASE
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Champions'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Can't Lose Them'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 5 AND 8 THEN 'Hibernating'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Lost'
            WHEN crs."R_score" IN (2,3) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Loyal Customers'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 5 AND 6 THEN 'Needs Attention'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 7 AND 8 THEN 'Recent Users'
            WHEN (crs."R_score" = 1 AND crs."FM_sum" BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND crs."FM_sum" BETWEEN 5 AND 8) THEN 'Potential Loyalists'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Price Sensitive'
            WHEN crs."R_score" = 2 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Promising'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 7 AND 10 THEN 'About to Sleep'
            ELSE 'Other'
        END AS "RFM_Segment"
    FROM
        customer_rfm_scores crs
)
SELECT
    "RFM_Segment",
    AVG("avg_sales_per_order") AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC;
```
2025-01-23 17:43:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:43:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:43:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:43:21 - snowflake.connector.connection - INFO - closed
2025-01-23 17:43:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:43:21 - root - INFO - itercount: 1
2025-01-23 17:43:21 - root - INFO - 001003 (42000): 01b9e887-0004-8095-0001-11c300f86ade: SQL compilation error:
syntax error line 50 at position 83 unexpected 't'.
syntax error line 50 at position 85 unexpected 'Lose'.
parse error line 73 at position 35 near '<EOF>'.
2025-01-23 17:43:21 - root - INFO - Input sql:
WITH
max_date AS (
    SELECT MAX("order_purchase_timestamp") AS "max_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" = 'delivered'
),
customer_data AS (
    SELECT
        o."customer_id",
        MAX(o."order_purchase_timestamp") AS "last_purchase_date",
        COUNT(DISTINCT o."order_id") AS "frequency",
        SUM(oi."price") AS "monetary"
    FROM
        E_COMMERCE.E_COMMERCE.ORDERS o
        JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE
        o."order_status" = 'delivered'
    GROUP BY
        o."customer_id"
),
customer_rfm AS (
    SELECT
        cd."customer_id",
        DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
        cd."frequency",
        cd."monetary"
    FROM
        customer_data cd
        CROSS JOIN max_date md
),
customer_rfm_scores AS (
    SELECT
        cr."customer_id",
        cr."recency",
        cr."frequency",
        cr."monetary",
        NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
        NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
        NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
    FROM
        customer_rfm cr
),
customer_rfm_segment AS (
    SELECT
        crs.*,
        (crs."F_score" + crs."M_score") AS "FM_sum",
        (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
        CASE
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Champions'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Can't Lose Them'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 5 AND 8 THEN 'Hibernating'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Lost'
            WHEN crs."R_score" IN (2,3) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Loyal Customers'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 5 AND 6 THEN 'Needs Attention'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 7 AND 8 THEN 'Recent Users'
            WHEN (crs."R_score" = 1 AND crs."FM_sum" BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND crs."FM_sum" BETWEEN 5 AND 8) THEN 'Potential Loyalists'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Price Sensitive'
            WHEN crs."R_score" = 2 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Promising'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 7 AND 10 THEN 'About to Sleep'
            ELSE 'Other'
        END AS "RFM_Segment"
    FROM
        customer_rfm_scores crs
)
SELECT
    "RFM_Segment",
    AVG("avg_sales_per_order") AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC;
The error information is:
001003 (42000): 01b9e887-0004-8095-0001-11c300f86ade: SQL compilation error:
syntax error line 50 at position 83 unexpected 't'.
syntax error line 50 at position 85 unexpected 'Lose'.
parse error line 73 at position 35 near '<EOF>'.
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-23 17:44:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:44:35 - root - INFO - ```sql
WITH
max_date AS (
    SELECT MAX("order_purchase_timestamp") AS "max_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" = 'delivered'
),
customer_data AS (
    SELECT
        o."customer_id",
        MAX(o."order_purchase_timestamp") AS "last_purchase_date",
        COUNT(DISTINCT o."order_id") AS "frequency",
        SUM(oi."price") AS "monetary"
    FROM
        E_COMMERCE.E_COMMERCE.ORDERS o
        JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE
        o."order_status" = 'delivered'
    GROUP BY
        o."customer_id"
),
customer_rfm AS (
    SELECT
        cd."customer_id",
        DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
        cd."frequency",
        cd."monetary"
    FROM
        customer_data cd
        CROSS JOIN max_date md
),
customer_rfm_scores AS (
    SELECT
        cr."customer_id",
        cr."recency",
        cr."frequency",
        cr."monetary",
        NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
        NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
        NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
    FROM
        customer_rfm cr
),
customer_rfm_segment AS (
    SELECT
        crs.*,
        (crs."F_score" + crs."M_score") AS "FM_sum",
        (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
        CASE
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Champions'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Can''t Lose Them'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 5 AND 8 THEN 'Hibernating'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Lost'
            WHEN crs."R_score" IN (2,3) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Loyal Customers'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 5 AND 6 THEN 'Needs Attention'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 7 AND 8 THEN 'Recent Users'
            WHEN (crs."R_score" = 1 AND crs."FM_sum" BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND crs."FM_sum" BETWEEN 5 AND 8) THEN 'Potential Loyalists'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Price Sensitive'
            WHEN crs."R_score" = 2 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Promising'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 7 AND 10 THEN 'About to Sleep'
            ELSE 'Other'
        END AS "RFM_Segment"
    FROM
        customer_rfm_scores crs
)
SELECT
    "RFM_Segment",
    AVG("avg_sales_per_order") AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC NULLS LAST;
```
2025-01-23 17:44:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:44:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:44:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:44:37 - snowflake.connector.connection - INFO - closed
2025-01-23 17:44:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:44:37 - root - INFO - itercount: 2
2025-01-23 17:44:37 - root - INFO - 000904 (42000): 01b9e888-0004-809b-0001-11c300f87336: SQL compilation error: error line 49 at position 39
invalid identifier 'CRS."FM_sum"'
2025-01-23 17:44:37 - root - INFO - Input sql:
WITH
max_date AS (
    SELECT MAX("order_purchase_timestamp") AS "max_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" = 'delivered'
),
customer_data AS (
    SELECT
        o."customer_id",
        MAX(o."order_purchase_timestamp") AS "last_purchase_date",
        COUNT(DISTINCT o."order_id") AS "frequency",
        SUM(oi."price") AS "monetary"
    FROM
        E_COMMERCE.E_COMMERCE.ORDERS o
        JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE
        o."order_status" = 'delivered'
    GROUP BY
        o."customer_id"
),
customer_rfm AS (
    SELECT
        cd."customer_id",
        DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
        cd."frequency",
        cd."monetary"
    FROM
        customer_data cd
        CROSS JOIN max_date md
),
customer_rfm_scores AS (
    SELECT
        cr."customer_id",
        cr."recency",
        cr."frequency",
        cr."monetary",
        NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
        NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
        NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
    FROM
        customer_rfm cr
),
customer_rfm_segment AS (
    SELECT
        crs.*,
        (crs."F_score" + crs."M_score") AS "FM_sum",
        (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
        CASE
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Champions'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Can''t Lose Them'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 5 AND 8 THEN 'Hibernating'
            WHEN crs."R_score" IN (4,5) AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Lost'
            WHEN crs."R_score" IN (2,3) AND crs."FM_sum" BETWEEN 2 AND 4 THEN 'Loyal Customers'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 5 AND 6 THEN 'Needs Attention'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 7 AND 8 THEN 'Recent Users'
            WHEN (crs."R_score" = 1 AND crs."FM_sum" BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND crs."FM_sum" BETWEEN 5 AND 8) THEN 'Potential Loyalists'
            WHEN crs."R_score" = 1 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Price Sensitive'
            WHEN crs."R_score" = 2 AND crs."FM_sum" BETWEEN 9 AND 10 THEN 'Promising'
            WHEN crs."R_score" = 3 AND crs."FM_sum" BETWEEN 7 AND 10 THEN 'About to Sleep'
            ELSE 'Other'
        END AS "RFM_Segment"
    FROM
        customer_rfm_scores crs
)
SELECT
    "RFM_Segment",
    AVG("avg_sales_per_order") AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC NULLS LAST;
The error information is:
000904 (42000): 01b9e888-0004-809b-0001-11c300f87336: SQL compilation error: error line 49 at position 39
invalid identifier 'CRS."FM_sum"'
Please correct it and output only 1 complete SQL query.
2025-01-23 17:45:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:45:26 - root - INFO - ```sql
WITH
max_date AS (
    SELECT MAX("order_purchase_timestamp") AS "max_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" = 'delivered'
),
customer_data AS (
    SELECT
        o."customer_id",
        MAX(o."order_purchase_timestamp") AS "last_purchase_date",
        COUNT(DISTINCT o."order_id") AS "frequency",
        SUM(oi."price") AS "monetary"
    FROM
        E_COMMERCE.E_COMMERCE.ORDERS o
        JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE
        o."order_status" = 'delivered'
    GROUP BY
        o."customer_id"
),
customer_rfm AS (
    SELECT
        cd."customer_id",
        DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
        cd."frequency",
        cd."monetary"
    FROM
        customer_data cd
        CROSS JOIN max_date md
),
customer_rfm_scores AS (
    SELECT
        cr."customer_id",
        cr."recency",
        cr."frequency",
        cr."monetary",
        NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
        NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
        NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
    FROM
        customer_rfm cr
),
customer_rfm_segment AS (
    SELECT
        crs.*,
        (crs."F_score" + crs."M_score") AS "FM_sum",
        (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
        CASE
            WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Champions'
            WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Can''t Lose Them'
            WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8 THEN 'Hibernating'
            WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Lost'
            WHEN crs."R_score" IN (2,3) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Loyal Customers'
            WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6 THEN 'Needs Attention'
            WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 8 THEN 'Recent Users'
            WHEN (crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8) THEN 'Potential Loyalists'
            WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Price Sensitive'
            WHEN crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Promising'
            WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 10 THEN 'About to Sleep'
            ELSE 'Other'
        END AS "RFM_Segment"
    FROM
        customer_rfm_scores crs
)
SELECT
    "RFM_Segment",
    AVG("avg_sales_per_order") AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC NULLS LAST;
```
2025-01-23 17:45:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:45:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:45:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:45:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-23 17:45:28 - snowflake.connector.connection - INFO - closed
2025-01-23 17:45:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:45:28 - root - INFO - itercount: 3
2025-01-23 17:45:28 - root - INFO - 0
2025-01-23 17:45:28 - root - INFO - results: 
RFM_Segment,Average_Sales_Per_Order
Can't Lose Them,386.3158978328173
Champions,288.00205313267816
Loyal Customers,216.68488959829742
Hibernating,153.25473665455064
Needs Attention,147.21669985996576
About to Sleep,66.32590380139644
Potential Loyalists,66.09336724551248
Lost,33.69189988358556
Recent Users,31.462876280535855


2025-01-23 17:45:28 - root - INFO - Please check the answer again by reviewing According to the RFM definition document, how much is the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders? Please rank the customers into segments to analyze differences in average sales across these segments, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
RFM_Segment,Average_Sales_Per_Order
Champions:str,avg_sales1:float
Can't Lose Them:str,avg_sales2:float
Hibernating:str,avg_sales3:float
Lost:str,avg_sales4:float
Loyal Customers:str,avg_sales5:float
Needs Attention:str,avg_sales6:float
Recent Users:str,avg_sales7:float
Potential Loyalists:str,avg_sales8:float
Price Sensitive:str,avg_sales9:float
Promising:str,avg_sales10:float
About to Sleep:str,avg_sales11:float
...
```

**Explanation:** The table above displays the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. This allows for the analysis of differences in average sales across these segments. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
RFM_Segment,Average_Sales_Per_Order
Can't Lose Them,386.3158978328173
Champions,288.00205313267816
Loyal Customers,216.68488959829742
Hibernating,153.25473665455064
Needs Attention,147.21669985996576
About to Sleep,66.32590380139644
Potential Loyalists,66.09336724551248
Lost,33.69189988358556
Recent Users,31.462876280535855
Current sql:
WITH
max_date AS (
    SELECT MAX("order_purchase_timestamp") AS "max_order_date"
    FROM E_COMMERCE.E_COMMERCE.ORDERS
    WHERE "order_status" = 'delivered'
),
customer_data AS (
    SELECT
        o."customer_id",
        MAX(o."order_purchase_timestamp") AS "last_purchase_date",
        COUNT(DISTINCT o."order_id") AS "frequency",
        SUM(oi."price") AS "monetary"
    FROM
        E_COMMERCE.E_COMMERCE.ORDERS o
        JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
    WHERE
        o."order_status" = 'delivered'
    GROUP BY
        o."customer_id"
),
customer_rfm AS (
    SELECT
        cd."customer_id",
        DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
        cd."frequency",
        cd."monetary"
    FROM
        customer_data cd
        CROSS JOIN max_date md
),
customer_rfm_scores AS (
    SELECT
        cr."customer_id",
        cr."recency",
        cr."frequency",
        cr."monetary",
        NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
        NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
        NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
    FROM
        customer_rfm cr
),
customer_rfm_segment AS (
    SELECT
        crs.*,
        (crs."F_score" + crs."M_score") AS "FM_sum",
        (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
        CASE
            WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Champions'
            WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Can''t Lose Them'
            WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8 THEN 'Hibernating'
            WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Lost'
            WHEN crs."R_score" IN (2,3) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Loyal Customers'
            WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6 THEN 'Needs Attention'
            WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 8 THEN 'Recent Users'
            WHEN (crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8) THEN 'Potential Loyalists'
            WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Price Sensitive'
            WHEN crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Promising'
            WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 10 THEN 'About to Sleep'
            ELSE 'Other'
        END AS "RFM_Segment"
    FROM
        customer_rfm_scores crs
)
SELECT
    "RFM_Segment",
    AVG("avg_sales_per_order") AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC NULLS LAST;
2025-01-23 17:46:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:46:29 - root - INFO - ```sql
WITH
    max_date AS (
        SELECT MAX("order_purchase_timestamp") AS "max_order_date"
        FROM E_COMMERCE.E_COMMERCE.ORDERS
        WHERE "order_status" = 'delivered'
    ),
    customer_data AS (
        SELECT
            o."customer_id",
            MAX(o."order_purchase_timestamp") AS "last_purchase_date",
            COUNT(DISTINCT o."order_id") AS "frequency",
            SUM(oi."price") AS "monetary"
        FROM
            E_COMMERCE.E_COMMERCE.ORDERS o
            JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
        WHERE
            o."order_status" = 'delivered'
        GROUP BY
            o."customer_id"
    ),
    customer_rfm AS (
        SELECT
            cd."customer_id",
            DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
            cd."frequency",
            cd."monetary"
        FROM
            customer_data cd
            CROSS JOIN max_date md
    ),
    customer_rfm_scores AS (
        SELECT
            cr."customer_id",
            cr."recency",
            cr."frequency",
            cr."monetary",
            NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
            NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
            NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
        FROM
            customer_rfm cr
    ),
    customer_rfm_segment AS (
        SELECT
            crs.*,
            (crs."F_score" + crs."M_score") AS "FM_sum",
            (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
            CASE
                WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Champions'
                WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Can''t Lose Them'
                WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8 THEN 'Hibernating'
                WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Lost'
                WHEN crs."R_score" IN (2,3) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Loyal Customers'
                WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6 THEN 'Needs Attention'
                WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 8 THEN 'Recent Users'
                WHEN (crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8) THEN 'Potential Loyalists'
                WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Price Sensitive'
                WHEN crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Promising'
                WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 10 THEN 'About to Sleep'
                ELSE 'Other'
            END AS "RFM_Segment"
        FROM
            customer_rfm_scores crs
    )
SELECT
    "RFM_Segment",
    ROUND(AVG("avg_sales_per_order"), 4) AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC NULLS LAST;
```
2025-01-23 17:46:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:46:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:46:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:46:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-23 17:46:31 - snowflake.connector.connection - INFO - closed
2025-01-23 17:46:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:46:32 - root - INFO - itercount: 4
2025-01-23 17:46:32 - root - INFO - 0
2025-01-23 17:46:32 - root - INFO - results: 
RFM_Segment,Average_Sales_Per_Order
Can't Lose Them,385.6932
Champions,287.9751
Loyal Customers,216.8047
Hibernating,153.3184
Needs Attention,147.553
About to Sleep,66.4683
Potential Loyalists,66.0416
Lost,33.6667
Recent Users,31.4591


2025-01-23 17:46:32 - root - INFO - Please check the answer again by reviewing According to the RFM definition document, how much is the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders? Please rank the customers into segments to analyze differences in average sales across these segments, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
RFM_Segment,Average_Sales_Per_Order
Champions:str,avg_sales1:float
Can't Lose Them:str,avg_sales2:float
Hibernating:str,avg_sales3:float
Lost:str,avg_sales4:float
Loyal Customers:str,avg_sales5:float
Needs Attention:str,avg_sales6:float
Recent Users:str,avg_sales7:float
Potential Loyalists:str,avg_sales8:float
Price Sensitive:str,avg_sales9:float
Promising:str,avg_sales10:float
About to Sleep:str,avg_sales11:float
...
```

**Explanation:** The table above displays the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. This allows for the analysis of differences in average sales across these segments. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
RFM_Segment,Average_Sales_Per_Order
Can't Lose Them,385.6932
Champions,287.9751
Loyal Customers,216.8047
Hibernating,153.3184
Needs Attention,147.553
About to Sleep,66.4683
Potential Loyalists,66.0416
Lost,33.6667
Recent Users,31.4591
Current sql:
WITH
    max_date AS (
        SELECT MAX("order_purchase_timestamp") AS "max_order_date"
        FROM E_COMMERCE.E_COMMERCE.ORDERS
        WHERE "order_status" = 'delivered'
    ),
    customer_data AS (
        SELECT
            o."customer_id",
            MAX(o."order_purchase_timestamp") AS "last_purchase_date",
            COUNT(DISTINCT o."order_id") AS "frequency",
            SUM(oi."price") AS "monetary"
        FROM
            E_COMMERCE.E_COMMERCE.ORDERS o
            JOIN E_COMMERCE.E_COMMERCE.ORDER_ITEMS oi ON o."order_id" = oi."order_id"
        WHERE
            o."order_status" = 'delivered'
        GROUP BY
            o."customer_id"
    ),
    customer_rfm AS (
        SELECT
            cd."customer_id",
            DATEDIFF('day', cd."last_purchase_date", md."max_order_date") AS "recency",
            cd."frequency",
            cd."monetary"
        FROM
            customer_data cd
            CROSS JOIN max_date md
    ),
    customer_rfm_scores AS (
        SELECT
            cr."customer_id",
            cr."recency",
            cr."frequency",
            cr."monetary",
            NTILE(5) OVER (ORDER BY cr."recency" ASC) AS "R_score",
            NTILE(5) OVER (ORDER BY cr."frequency" DESC) AS "F_score",
            NTILE(5) OVER (ORDER BY cr."monetary" DESC) AS "M_score"
        FROM
            customer_rfm cr
    ),
    customer_rfm_segment AS (
        SELECT
            crs.*,
            (crs."F_score" + crs."M_score") AS "FM_sum",
            (crs."monetary" / NULLIF(crs."frequency", 0)) AS "avg_sales_per_order",
            CASE
                WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Champions'
                WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Can''t Lose Them'
                WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8 THEN 'Hibernating'
                WHEN crs."R_score" IN (4,5) AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Lost'
                WHEN crs."R_score" IN (2,3) AND (crs."F_score" + crs."M_score") BETWEEN 2 AND 4 THEN 'Loyal Customers'
                WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6 THEN 'Needs Attention'
                WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 8 THEN 'Recent Users'
                WHEN (crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 6) OR (crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 5 AND 8) THEN 'Potential Loyalists'
                WHEN crs."R_score" = 1 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Price Sensitive'
                WHEN crs."R_score" = 2 AND (crs."F_score" + crs."M_score") BETWEEN 9 AND 10 THEN 'Promising'
                WHEN crs."R_score" = 3 AND (crs."F_score" + crs."M_score") BETWEEN 7 AND 10 THEN 'About to Sleep'
                ELSE 'Other'
            END AS "RFM_Segment"
        FROM
            customer_rfm_scores crs
    )
SELECT
    "RFM_Segment",
    ROUND(AVG("avg_sales_per_order"), 4) AS "Average_Sales_Per_Order"
FROM
    customer_rfm_segment
GROUP BY
    "RFM_Segment"
ORDER BY
    "Average_Sales_Per_Order" DESC NULLS LAST;
2025-01-23 17:46:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:46:57 - root - INFO - The SQL query is correct.

Here is the average sales per order for each RFM segment:

```csv
RFM_Segment,Average_Sales_Per_Order
Can't Lose Them,385.6932
Champions,287.9751
Loyal Customers,216.8047
Hibernating,153.3184
Needs Attention,147.5530
About to Sleep,66.4683
Potential Loyalists,66.0416
Lost,33.6667
Recent Users,31.4591
```
2025-01-23 17:46:57 - root - INFO - []
2025-01-23 17:46:57 - root - INFO - The SQL query is correct.

Here is the average sales per order for each RFM segment:

```csv
RFM_Segment,Average_Sales_Per_Order
Can't Lose Them,385.6932
Champions,287.9751
Loyal Customers,216.8047
Hibernating,153.3184
Needs Attention,147.5530
About to Sleep,66.4683
Potential Loyalists,66.0416
Lost,33.6667
Recent Users,31.4591
```
2025-01-23 17:46:57 - root - INFO - Total iteration counts: 4
