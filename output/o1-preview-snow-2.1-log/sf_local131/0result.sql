SELECT s."StyleName",
       TO_CHAR(COALESCE(SUM(CASE WHEN p."PreferenceSeq" = 1 THEN 1 ELSE 0 END), 0), 'FM9999.0000') AS "Preference1_Count",
       TO_CHAR(COALESCE(SUM(CASE WHEN p."PreferenceSeq" = 2 THEN 1 ELSE 0 END), 0), 'FM9999.0000') AS "Preference2_Count",
       TO_CHAR(COALESCE(SUM(CASE WHEN p."PreferenceSeq" = 3 THEN 1 ELSE 0 END), 0), 'FM9999.0000') AS "Preference3_Count"
FROM ENTERTAINMENTAGENCY.ENTERTAINMENTAGENCY.MUSICAL_STYLES s
LEFT JOIN ENTERTAINMENTAGENCY.ENTERTAINMENTAGENCY.MUSICAL_PREFERENCES p
       ON s."StyleID" = p."StyleID" AND p."PreferenceSeq" IN (1, 2, 3)
GROUP BY s."StyleID", s."StyleName";