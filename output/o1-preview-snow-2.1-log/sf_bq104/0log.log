2025-01-24 06:47:28 - openai._base_client - INFO - Retrying request to /chat/completions in 0.489799 seconds
2025-01-24 06:48:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 06:48:50 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:49:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:49:44 - root - INFO - ```sql
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC
LIMIT 1;
```
2025-01-24 06:49:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:49:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:49:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:49:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:49:45 - snowflake.connector.connection - INFO - closed
2025-01-24 06:49:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:50:56 - root - INFO - SQL:
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC
LIMIT 1;
Results:
dma_name,total_search_score
New York NY,1264645

2025-01-24 06:50:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:57 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:58 - root - INFO - SQL:
SELECT "term", "percent_gain"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   ORDER BY "percent_gain" DESC
   LIMIT 100
Results:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850

2025-01-24 06:50:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:59 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:59 - root - INFO - SQL:
SELECT "dma_name", "term", "score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   LIMIT 100
Results:
dma_name,term,score
Portland-Auburn ME,Aurora forecast,
Charlotte NC,Aurora forecast,
Portland-Auburn ME,Brandon McManus,
Charlotte NC,Brandon McManus,
Charlotte NC,Brandon McManus,
Greensboro-High Point-Winston Salem NC,Golden Bachelorette,
Greensboro-High Point-Winston Salem NC,Golden Bachelorette,
Gainesville FL,Golden Bachelorette,
Joplin MO-Pittsburg KS,Golden Bachelorette,
Joplin MO-Pittsburg KS,Golden Bachelorette,
Ft. Smith-Fayetteville-Springdale-Rogers AR,Golden Bachelorette,
Cheyenne WY-Scottsbluff NE,Golden Bachelorette,
Cheyenne WY-Scottsbluff NE,Golden Bachelorette,
Portland-Auburn ME,49ers vs Seahawks,
Portland-Auburn ME,49ers vs Seahawks,
Charlotte NC,49ers vs Seahawks,
Greenville-New Bern-Washington NC,49ers vs Seahawks,
Dothan AL,49ers vs Seahawks,
Portland-Auburn ME,Aurora forecast,
Charlotte NC,Aurora forecast,
Greenville-New Bern-Washington NC,Aurora forecast,
Chattanooga TN,Aurora forecast,
Dothan AL,Aurora forecast,
Greenville-New Bern-Washington NC,Aurora forecast,
Wilmington NC,Aurora forecast,
Wilmington NC,Aurora forecast,
Chattanooga TN,Aurora forecast,
Great Falls MT,Ohio State football,
Lima OH,Ohio State football,5.0
Lima OH,Ohio State football,4.0
Baltimore MD,49ers vs Seahawks,
Atlanta GA,49ers vs Seahawks,
Atlanta GA,49ers vs Seahawks,
Marquette MI,49ers vs Seahawks,
Marquette MI,49ers vs Seahawks,
Wilkes Barre-Scranton PA,49ers vs Seahawks,
Evansville IN,49ers vs Seahawks,
Evansville IN,49ers vs Seahawks,
Rapid City SD,49ers vs Seahawks,
Charlotte NC,Aiden Hutchinson,
Greenville-New Bern-Washington NC,Aiden Hutchinson,
Wilmington NC,Aiden Hutchinson,
Wilmington NC,Aiden Hutchinson,
Grand Rapids-Kalamazoo-Battle Creek MI,Aurora forecast,
Grand Rapids-Kalamazoo-Battle Creek MI,Aurora forecast,
Wilkes Barre-Scranton PA,Aurora forecast,
Evansville IN,Aurora forecast,
Evansville IN,Aurora forecast,
Rapid City SD,Aurora forecast,
Rapid City SD,Aurora forecast,
Greenville-New Bern-Washington NC,Brandon McManus,
Greenville-New Bern-Washington NC,Brandon McManus,
Wilmington NC,Brandon McManus,
Wilmington NC,Brandon McManus,
Chattanooga TN,Brandon McManus,
Dothan AL,Brandon McManus,
Medford-Klamath Falls OR,Ohio State football,
Medford-Klamath Falls OR,Ohio State football,
Indianapolis IN,Ohio State football,2.0
Norfolk-Portsmouth-Newport News VA,Ohio State football,
Alpena MI,Ohio State football,
Alpena MI,Ohio State football,
Philadelphia PA,49ers vs Seahawks,
Philadelphia PA,49ers vs Seahawks,
Buffalo NY,49ers vs Seahawks,
Ft. Myers-Naples FL,49ers vs Seahawks,
Lake Charles LA,49ers vs Seahawks,
Huntsville-Decatur (Florence) AL,49ers vs Seahawks,
Huntsville-Decatur (Florence) AL,49ers vs Seahawks,
Juneau AK,49ers vs Seahawks,
Seattle-Tacoma WA,49ers vs Seahawks,
Savannah GA,49ers vs Seahawks,
Savannah GA,49ers vs Seahawks,
Cleveland-Akron (Canton) OH,49ers vs Seahawks,
Panama City FL,49ers vs Seahawks,
Panama City FL,49ers vs Seahawks,
Palm Springs CA,49ers vs Seahawks,
Dothan AL,Aiden Hutchinson,
Atlanta GA,Aiden Hutchinson,
Grand Rapids-Kalamazoo-Battle Creek MI,Aiden Hutchinson,3.0
Wilkes Barre-Scranton PA,Aiden Hutchinson,
Wilkes Barre-Scranton PA,Aiden Hutchinson,
Rapid City SD,Aiden Hutchinson,
Dothan AL,Aurora forecast,
Baltimore MD,Aurora forecast,
Baltimore MD,Aurora forecast,
Atlanta GA,Aurora forecast,
Atlanta GA,Aurora forecast,
Marquette MI,Aurora forecast,
Marquette MI,Aurora forecast,
Wilkes Barre-Scranton PA,Aurora forecast,
Buffalo NY,Aurora forecast,
Buffalo NY,Aurora forecast,
Ft. Myers-Naples FL,Aurora forecast,
Ft. Myers-Naples FL,Aurora forecast,
Las Vegas NV,Aurora forecast,
Columbus-Tupelo-West Point MS,Aurora forecast,
Columbus-Tupelo-West Point MS,Aurora forecast,
Huntsville-Decatur (Florence) AL,Aurora forecast,
Juneau AK,Aurora forecast,

2025-01-24 06:50:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:01 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:01 - root - INFO - SQL:
SELECT "dma_name", SUM("score") AS "total_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "total_search_score" DESC
   LIMIT 100
Results:
dma_name,total_search_score
Los Angeles CA,11103
San Francisco-Oakland-San Jose CA,10483
Atlanta GA,10458
Chicago IL,10363
Salt Lake City UT,10229
Philadelphia PA,10057
Sacramento-Stockton-Modesto CA,10053
Charlotte NC,10035
New York NY,9996
Detroit MI,9975
Washington DC (Hagerstown MD),9936
Denver CO,9929
Dallas-Ft. Worth TX,9903
Boston MA-Manchester NH,9821
Pittsburgh PA,9819
Seattle-Tacoma WA,9792
Phoenix AZ,9787
Greenville-Spartanburg-Asheville-Anderson,9748
Baltimore MD,9684
Raleigh-Durham (Fayetteville) NC,9615
Providence-New Bedford MA,9581
San Diego CA,9531
Fresno-Visalia CA,9505
Houston TX,9497
Hartford & New Haven CT,9489
Portland OR,9466
Orlando-Daytona Beach-Melbourne FL,9415
Austin TX,9395
Columbia SC,9332
Harrisburg-Lancaster-Lebanon-York PA,9329
Nashville TN,9311
Cleveland-Akron (Canton) OH,9305
Indianapolis IN,9288
Columbus OH,9281
Minneapolis-St. Paul MN,9241
Albuquerque-Santa Fe NM,9228
Tampa-St. Petersburg (Sarasota) FL,9215
Greensboro-High Point-Winston Salem NC,9186
Milwaukee WI,9182
Louisville KY,9180
Grand Rapids-Kalamazoo-Battle Creek MI,9166
Wilkes Barre-Scranton PA,9136
San Antonio TX,9109
Savannah GA,9051
Syracuse NY,9039
Miami-Ft. Lauderdale FL,8938
Birmingham (Ann and Tusc) AL,8933
Buffalo NY,8849
Mobile AL-Pensacola (Ft. Walton Beach) FL,8835
Lexington KY,8819
Albany-Schenectady-Troy NY,8743
Norfolk-Portsmouth-Newport News VA,8741
New Orleans LA,8737
Waco-Temple-Bryan TX,8722
Huntsville-Decatur (Florence) AL,8701
Jacksonville FL,8699
Spokane WA,8634
Las Vegas NV,8612
Honolulu HI,8610
Richmond-Petersburg VA,8598
St. Louis MO,8597
Toledo OH,8597
Oklahoma City OK,8543
Cincinnati OH,8464
West Palm Beach-Ft. Pierce FL,8441
Monterey-Salinas CA,8422
El Paso TX,8405
Ft. Myers-Naples FL,8363
Omaha NE,8323
Augusta GA,8323
Macon GA,8309
Chattanooga TN,8288
Little Rock-Pine Bluff AR,8267
Memphis TN,8263
Dayton OH,8239
Colorado Springs-Pueblo CO,8222
Des Moines-Ames IA,8214
Baton Rouge LA,8187
Knoxville TN,8174
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,8103
Tulsa OK,8091
Boise ID,8076
Charleston SC,8073
Florence-Myrtle Beach SC,8060
Rochester NY,7960
Madison WI,7926
Tucson (Sierra Vista) AZ,7923
Wichita-Hutchinson KS,7916
Santa Barbara-Santa Maria-San Luis Obispo CA,7894
Roanoke-Lynchburg VA,7887
Flint-Saginaw-Bay City MI,7871
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,7848
Shreveport LA,7819
Evansville IN,7789
Champaign & Springfield-Decatur IL,7751
Kansas City MO,7722
Harlingen-Weslaco-Brownsville-McAllen TX,7696
Green Bay-Appleton WI,7687
Ft. Smith-Fayetteville-Springdale-Rogers AR,7682
Reno NV,7543

2025-01-24 06:51:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:02 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:03 - root - INFO - SQL:
SELECT "dma_name", COUNT(DISTINCT "term") AS "number_of_top_rising_terms"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "number_of_top_rising_terms" DESC
   LIMIT 100
Results:
dma_name,number_of_top_rising_terms
Knoxville TN,513
Springfield-Holyoke MA,513
Lubbock TX,513
Birmingham (Ann and Tusc) AL,513
Ottumwa IA-Kirksville MO,513
Chicago IL,513
Wilmington NC,513
Austin TX,513
Wilkes Barre-Scranton PA,513
Orlando-Daytona Beach-Melbourne FL,513
Columbia-Jefferson City MO,513
Duluth MN-Superior WI,513
Sherman-Ada OK,513
Alexandria LA,513
Dothan AL,513
Zanesville OH,513
Bend OR,513
Traverse City-Cadillac MI,513
Fresno-Visalia CA,513
Providence-New Bedford MA,513
Des Moines-Ames IA,513
Jackson MS,513
Davenport IA-Rock Island-Moline IL,513
Waco-Temple-Bryan TX,513
Little Rock-Pine Bluff AR,513
Biloxi-Gulfport MS,513
Helena MT,513
Minot-Bismarck-Dickinson(Williston) ND,513
Columbus GA,513
Madison WI,513
Columbus-Tupelo-West Point MS,513
St. Louis MO,513
Monroe LA-El Dorado AR,513
Salt Lake City UT,513
Buffalo NY,513
Miami-Ft. Lauderdale FL,513
Topeka KS,513
Seattle-Tacoma WA,513
Wheeling WV-Steubenville OH,513
Los Angeles CA,513
Laredo TX,513
Champaign & Springfield-Decatur IL,513
Greenville-Spartanburg-Asheville-Anderson,513
Kansas City MO,513
Joplin MO-Pittsburg KS,513
Tucson (Sierra Vista) AZ,513
Juneau AK,513
Oklahoma City OK,513
Tyler-Longview(Lufkin & Nacogdoches) TX,513
North Platte NE,513
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,513
Albany-Schenectady-Troy NY,513
Meridian MS,513
Springfield MO,513
Yakima-Pasco-Richland-Kennewick WA,513
Lake Charles LA,513
Columbus OH,513
Dayton OH,513
Quincy IL-Hannibal MO-Keokuk IA,513
San Angelo TX,513
Charleston SC,513
West Palm Beach-Ft. Pierce FL,513
Missoula MT,513
Hartford & New Haven CT,513
Jonesboro AR,513
Sacramento-Stockton-Modesto CA,513
Salisbury MD,513
Lexington KY,513
San Diego CA,513
Twin Falls ID,513
Santa Barbara-Santa Maria-San Luis Obispo CA,513
Glendive MT,513
Terre Haute IN,513
Reno NV,513
Baltimore MD,513
Sioux City IA,513
Green Bay-Appleton WI,513
Lafayette IN,513
Fargo-Valley City ND,513
Grand Rapids-Kalamazoo-Battle Creek MI,513
Johnstown-Altoona-State College PA,513
Boston MA-Manchester NH,513
Beaumont-Port Arthur TX,513
Erie PA,513
Rochester-Mason City-Austin IA,513
Yuma AZ-El Centro CA,513
Hattiesburg-Laurel MS,513
Toledo OH,513
Burlington VT-Plattsburgh NY,513
La Crosse-Eau Claire WI,513
Huntsville-Decatur (Florence) AL,513
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,513
Columbia SC,513
Rockford IL,513
Shreveport LA,513
Rapid City SD,513
Ft. Smith-Fayetteville-Springdale-Rogers AR,513
Alpena MI,513
Detroit MI,513
Harrisonburg VA,513

2025-01-24 06:51:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:04 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:05 - root - INFO - SQL:
SELECT "dma_name", MAX("score") AS "max_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "max_search_score" DESC
   LIMIT 100
Results:
dma_name,max_search_score
Knoxville TN,100
Alpena MI,100
Bend OR,100
Detroit MI,100
Traverse City-Cadillac MI,100
Harrisonburg VA,100
Orlando-Daytona Beach-Melbourne FL,100
Ft. Smith-Fayetteville-Springdale-Rogers AR,100
Wilkes Barre-Scranton PA,100
Duluth MN-Superior WI,100
Greensboro-High Point-Winston Salem NC,100
Cincinnati OH,100
Corpus Christi TX,100
Austin TX,100
Helena MT,100
Rochester NY,100
Bakersfield CA,100
Marquette MI,100
Indianapolis IN,100
Macon GA,100
Lake Charles LA,100
Dayton OH,100
Shreveport LA,100
Yakima-Pasco-Richland-Kennewick WA,100
Quincy IL-Hannibal MO-Keokuk IA,100
Toledo OH,100
Columbus OH,100
Hattiesburg-Laurel MS,100
Burlington VT-Plattsburgh NY,100
La Crosse-Eau Claire WI,100
Las Vegas NV,100
Washington DC (Hagerstown MD),100
San Francisco-Oakland-San Jose CA,100
Mankato MN,100
Cheyenne WY-Scottsbluff NE,100
Nashville TN,100
Cleveland-Akron (Canton) OH,100
Fresno-Visalia CA,100
Casper-Riverton WY,100
Syracuse NY,100
Phoenix AZ,100
Bowling Green KY,100
Greenwood-Greenville MS,100
Butte-Bozeman MT,100
Champaign & Springfield-Decatur IL,100
Los Angeles CA,100
Kansas City MO,100
Greenville-Spartanburg-Asheville-Anderson,100
Laredo TX,100
Madison WI,100
Columbus-Tupelo-West Point MS,100
Wilmington NC,100
Chicago IL,100
Birmingham (Ann and Tusc) AL,100
Seattle-Tacoma WA,100
Topeka KS,100
Pittsburgh PA,100
Wheeling WV-Steubenville OH,100
Philadelphia PA,100
South Bend-Elkhart IN,100
Louisville KY,100
Chattanooga TN,100
Utica NY,100
Presque Isle ME,100
Portland-Auburn ME,100
Juneau AK,100
Joplin MO-Pittsburg KS,100
Tucson (Sierra Vista) AZ,100
Portland OR,100
Houston TX,100
Milwaukee WI,100
Evansville IN,100
Anchorage AK,100
Victoria TX,100
Lansing MI,100
Watertown NY,100
Memphis TN,100
Colorado Springs-Pueblo CO,100
Florence-Myrtle Beach SC,100
Medford-Klamath Falls OR,100
Youngstown OH,100
Wausau-Rhinelander WI,100
Rochester-Mason City-Austin IA,100
Yuma AZ-El Centro CA,100
Mobile AL-Pensacola (Ft. Walton Beach) FL,100
El Paso TX,100
Elmira (Corning) NY,100
Zanesville OH,100
Columbia-Jefferson City MO,100
Alexandria LA,100
Sherman-Ada OK,100
Dothan AL,100
West Palm Beach-Ft. Pierce FL,100
Missoula MT,100
Bluefield-Beckley-Oak Hill WV,100
San Angelo TX,100
Boise ID,100
Springfield-Holyoke MA,100
Lubbock TX,100
Ottumwa IA-Kirksville MO,100

2025-01-24 06:51:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:06 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:06 - root - INFO - SQL:
SELECT "t"."dma_name", "t"."term", "t"."score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS" AS "t"
   WHERE "t"."week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
     AND "t"."term" IN (
       SELECT DISTINCT "term"
       FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
       WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
     )
   ORDER BY "t"."score" DESC
   LIMIT 100
Results:
dma_name,term,score
Glendive MT,49ers,
Presque Isle ME,49ers,
Presque Isle ME,49ers,
Glendive MT,49ers,
Presque Isle ME,49ers,
Glendive MT,49ers,
Glendive MT,49ers,
Juneau AK,49ers,
Portland OR,49ers,100.0
Pittsburgh PA,49ers,100.0
Toledo OH,49ers,100.0
Tucson (Sierra Vista) AZ,49ers,100.0
Anchorage AK,49ers,100.0
Omaha NE,49ers,100.0
Joplin MO-Pittsburg KS,49ers,100.0
Wichita Falls TX & Lawton OK,49ers,100.0
Medford-Klamath Falls OR,49ers,100.0
Chattanooga TN,49ers,100.0
Casper-Riverton WY,49ers,100.0
San Angelo TX,49ers,100.0
Columbia-Jefferson City MO,49ers,100.0
Wilkes Barre-Scranton PA,49ers,100.0
Jonesboro AR,49ers,100.0
Denver CO,49ers,100.0
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,49ers,100.0
Columbus OH,49ers,100.0
Portland-Auburn ME,49ers,100.0
Washington DC (Hagerstown MD),49ers,100.0
Davenport IA-Rock Island-Moline IL,49ers,100.0
Greenville-Spartanburg-Asheville-Anderson,49ers,100.0
Tampa-St. Petersburg (Sarasota) FL,49ers,100.0
Odessa-Midland TX,49ers,100.0
Sacramento-Stockton-Modesto CA,49ers,100.0
Richmond-Petersburg VA,49ers,100.0
Panama City FL,49ers,100.0
Champaign & Springfield-Decatur IL,49ers,100.0
Springfield-Holyoke MA,49ers,100.0
Baton Rouge LA,49ers,100.0
Bakersfield CA,49ers,100.0
Jackson TN,49ers,100.0
Grand Rapids-Kalamazoo-Battle Creek MI,49ers,100.0
Topeka KS,49ers,100.0
Helena MT,49ers,100.0
Lubbock TX,49ers,100.0
Ft. Smith-Fayetteville-Springdale-Rogers AR,49ers,100.0
San Antonio TX,49ers,100.0
Peoria-Bloomington IL,49ers,100.0
West Palm Beach-Ft. Pierce FL,49ers,100.0
Ft. Wayne IN,49ers,100.0
Orlando-Daytona Beach-Melbourne FL,49ers,100.0
Chicago IL,49ers,100.0
Terre Haute IN,49ers,100.0
Gainesville FL,49ers,100.0
Omaha NE,49ers,100.0
Wheeling WV-Steubenville OH,49ers,100.0
Louisville KY,49ers,100.0
Augusta GA,49ers,100.0
St. Joseph MO,49ers,100.0
Jackson MS,49ers,100.0
Albuquerque-Santa Fe NM,49ers,100.0
Peoria-Bloomington IL,49ers,100.0
Davenport IA-Rock Island-Moline IL,49ers,100.0
Tri-Cities TN-VA,49ers,100.0
Meridian MS,49ers,100.0
Beaumont-Port Arthur TX,49ers,100.0
Albany-Schenectady-Troy NY,49ers,100.0
Johnstown-Altoona-State College PA,49ers,100.0
Traverse City-Cadillac MI,49ers,100.0
Shreveport LA,49ers,100.0
Laredo TX,49ers,100.0
San Angelo TX,49ers,100.0
Houston TX,49ers,100.0
Greenville-New Bern-Washington NC,49ers,100.0
Harlingen-Weslaco-Brownsville-McAllen TX,49ers,100.0
Syracuse NY,49ers,100.0
Los Angeles CA,49ers,100.0
Zanesville OH,49ers,100.0
Champaign & Springfield-Decatur IL,49ers,100.0
Bluefield-Beckley-Oak Hill WV,49ers,100.0
Boston MA-Manchester NH,49ers,100.0
Juneau AK,49ers,100.0
Memphis TN,49ers,100.0
Sioux Falls(Mitchell) SD,49ers,100.0
Lincoln & Hastings-Kearney NE,49ers,100.0
Honolulu HI,49ers,100.0
Ottumwa IA-Kirksville MO,49ers,100.0
Bakersfield CA,49ers,100.0
Idaho Falls-Pocatello ID,49ers,100.0
Rapid City SD,49ers,100.0
Joplin MO-Pittsburg KS,49ers,100.0
Flint-Saginaw-Bay City MI,49ers,100.0
Lafayette LA,49ers,100.0
Rockford IL,49ers,100.0
Charleston-Huntington WV,49ers,100.0
New York NY,49ers,100.0
Austin TX,49ers,100.0
Sioux City IA,49ers,100.0
Quincy IL-Hannibal MO-Keokuk IA,49ers,100.0
Nashville TN,49ers,100.0
Kansas City MO,49ers,100.0

2025-01-24 06:51:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:08 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:08 - root - INFO - SQL:
SELECT "dma_name", AVG("score") AS "average_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "average_search_score" DESC
   LIMIT 100
Results:
dma_name,average_search_score
Glendive MT,89.500000
Alpena MI,88.040000
Presque Isle ME,87.857143
North Platte NE,76.000000
Juneau AK,75.357143
Fairbanks AK,75.181818
Helena MT,69.000000
Victoria TX,67.360000
Grand Junction-Montrose CO,64.123077
Casper-Riverton WY,62.716667
Ottumwa IA-Kirksville MO,60.750000
Marquette MI,60.476744
Cheyenne WY-Scottsbluff NE,60.120690
Quincy IL-Hannibal MO-Keokuk IA,59.539474
Great Falls MT,59.000000
Mankato MN,58.234375
Clarksburg-Weston WV,56.942857
Beaumont-Port Arthur TX,56.896000
San Angelo TX,56.845070
Alexandria LA,56.771930
Eureka CA,56.618182
Bluefield-Beckley-Oak Hill WV,56.530864
St. Joseph MO,55.728814
Jonesboro AR,55.718750
Wheeling WV-Steubenville OH,55.443299
Terre Haute IN,55.121212
Parkersburg WV,55.032258
Lima OH,54.694444
Twin Falls ID,54.658824
Zanesville OH,54.375000
Butte-Bozeman MT,54.223404
Sherman-Ada OK,54.009091
Meridian MS,53.982456
Medford-Klamath Falls OR,53.747899
Abilene-Sweetwater TX,53.440000
Hattiesburg-Laurel MS,53.313725
Billings MT,53.204082
Amarillo TX,53.067164
Rockford IL,52.871212
Joplin MO-Pittsburg KS,52.796748
Rapid City SD,52.641975
Monroe LA-El Dorado AR,52.555556
Bend OR,52.536232
Chico-Redding CA,52.347518
Utica NY,51.916667
Minot-Bismarck-Dickinson(Williston) ND,51.801887
Greenwood-Greenville MS,51.783333
Duluth MN-Superior WI,51.669725
Jackson TN,51.217391
Wichita Falls TX & Lawton OK,50.272727
Albany GA,49.812030
Anchorage AK,49.557377
Harrisonburg VA,49.327869
Idaho Falls-Pocatello ID,49.248120
Watertown NY,49.152941
Rochester-Mason City-Austin IA,49.060606
Elmira (Corning) NY,49.046512
Bowling Green KY,48.745098
Bangor ME,48.686275
Topeka KS,48.282443
Missoula MT,47.552381
Laredo TX,47.379630
Lafayette IN,47.194030
Lubbock TX,47.150685
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,46.437870
Binghamton NY,45.980392
Charlottesville VA,45.952756
Erie PA,45.896825
Yuma AZ-El Centro CA,44.553846
Macon GA,44.433155
Lafayette LA,44.380952
Biloxi-Gulfport MS,44.240000
Wausau-Rhinelander WI,44.226891
Monterey-Salinas CA,44.094241
Sioux City IA,44.017751
Evansville IN,43.758427
Tyler-Longview(Lufkin & Nacogdoches) TX,43.738372
Montgomery-Selma AL,43.615854
Lake Charles LA,43.357143
Traverse City-Cadillac MI,42.878788
Odessa-Midland TX,42.683099
Fargo-Valley City ND,42.294872
La Crosse-Eau Claire WI,41.482517
Dothan AL,41.315789
Salisbury MD,41.180645
Peoria-Bloomington IL,41.114865
Bakersfield CA,41.099448
Columbia-Jefferson City MO,41.046512
Columbus-Tupelo-West Point MS,41.007407
Jackson MS,40.740113
Shreveport LA,40.723958
Yakima-Pasco-Richland-Kennewick WA,40.358696
Wilmington NC,40.253165
Eugene OR,40.092199
Davenport IA-Rock Island-Moline IL,40.067416
Panama City FL,40.039474
Augusta GA,40.014423
Corpus Christi TX,39.560606
Tri-Cities TN-VA,39.251429
Palm Springs CA,39.241830

2025-01-24 06:51:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-24 06:51:10 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:10 - root - INFO - SQL:
SELECT "dma_name", SUM("score") AS "total_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "total_search_score" DESC
   LIMIT 5
Results:
dma_name,total_search_score
Los Angeles CA,11103
San Francisco-Oakland-San Jose CA,10483
Atlanta GA,10458
Chicago IL,10363
Salt Lake City UT,10229

2025-01-24 06:51:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:12 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:12 - root - INFO - SQL:
SELECT "dma_name", "term", "rank"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   ORDER BY "dma_name", "rank" ASC
   LIMIT 100
Results:
dma_name,term,rank
Abilene-Sweetwater TX,ratan tata,1
Abilene-Sweetwater TX,bills vs jets,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,chiefs vs falcons,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,olivia nuzzi,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,south carolina vs alabama,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,national daughters day,1
Abilene-Sweetwater TX,pete rose,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,olivia nuzzi,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,buccaneers vs falcons,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,cowboys vs steelers,1
Abilene-Sweetwater TX,skrrt,1
Abilene-Sweetwater TX,hurricane milton,1
Abilene-Sweetwater TX,john amos,1
Abilene-Sweetwater TX,skrrt,1
Abilene-Sweetwater TX,pete rose,1
Abilene-Sweetwater TX,aidan hutchinson,1
Abilene-Sweetwater TX,aiden hutchinson,1
Abilene-Sweetwater TX,ravens vs cowboys,1
Abilene-Sweetwater TX,national daughters day,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,seahawks vs 49ers,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,cowboys vs steelers,1
Abilene-Sweetwater TX,aiden hutchinson,1
Abilene-Sweetwater TX,tropical storm warning,1
Abilene-Sweetwater TX,seahawks vs 49ers,1
Abilene-Sweetwater TX,hurricane helene,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,liam payne,1
Abilene-Sweetwater TX,ravens vs cowboys,1
Abilene-Sweetwater TX,tropical storm warning,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,ratan tata,1
Abilene-Sweetwater TX,witherspoon meaning,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,aidan hutchinson,1
Abilene-Sweetwater TX,ryan routh,1
Abilene-Sweetwater TX,national dog day,1
Abilene-Sweetwater TX,buccaneers vs falcons,1
Abilene-Sweetwater TX,south carolina vs alabama,1
Abilene-Sweetwater TX,witherspoon meaning,1
Abilene-Sweetwater TX,john amos,1
Abilene-Sweetwater TX,ryan routh,1
Abilene-Sweetwater TX,hurricane helene,1
Abilene-Sweetwater TX,chiefs vs falcons,1
Abilene-Sweetwater TX,alabama vs vanderbilt,1
Abilene-Sweetwater TX,alabama vs vanderbilt,1
Abilene-Sweetwater TX,bills vs jets,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,hurricane milton,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,liam payne,1
Abilene-Sweetwater TX,national dog day,1
Abilene-Sweetwater TX,hurricane milton tracker,2
Abilene-Sweetwater TX,vanderbilt football,2
Abilene-Sweetwater TX,cowboys vs giants,2
Abilene-Sweetwater TX,vanderbilt football,2
Abilene-Sweetwater TX,matt gaetz,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,eric adams,2
Abilene-Sweetwater TX,matt gaetz,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,saints vs chiefs,2
Abilene-Sweetwater TX,cowboys vs giants,2
Abilene-Sweetwater TX,baylor vs colorado,2
Abilene-Sweetwater TX,northern lights tonight,2
Abilene-Sweetwater TX,sean combs,2
Abilene-Sweetwater TX,ryan wesley routh,2
Abilene-Sweetwater TX,commanders vs bengals,2
Abilene-Sweetwater TX,aiden hutchinson,2
Abilene-Sweetwater TX,eric adams,2
Abilene-Sweetwater TX,aiden hutchinson,2
Abilene-Sweetwater TX,gamut,2
Abilene-Sweetwater TX,liam payne death,2
Abilene-Sweetwater TX,mark robinson,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,mark robinson,2
Abilene-Sweetwater TX,saints vs chiefs,2
Abilene-Sweetwater TX,mark robinson,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,alabama vs georgia,2
Abilene-Sweetwater TX,texas vs oklahoma,2
Abilene-Sweetwater TX,ryan wesley routh,2
Abilene-Sweetwater TX,texas vs oklahoma,2
Abilene-Sweetwater TX,baylor vs colorado,2
Abilene-Sweetwater TX,alabama vs georgia,2
Abilene-Sweetwater TX,hurricane helene tracker,2

2025-01-24 06:51:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 06:51:13 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:51:35 - root - INFO - ```sql
SELECT "dma_name", "term", "rank"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
ORDER BY "dma_name", "rank" ASC
LIMIT 100;
```
2025-01-24 06:51:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:51:36 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:52:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:52:09 - root - INFO - SQL:
SELECT "dma_name", "term", "rank"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
ORDER BY "dma_name", "rank" ASC
LIMIT 100;
Results:
dma_name,term,rank
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1

2025-01-24 06:52:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:52:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:52:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:52:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:52:10 - snowflake.connector.connection - INFO - closed
2025-01-24 06:52:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:52:11 - root - INFO - SQL:
SELECT COUNT(DISTINCT "dma_name") AS "number_of_dmas"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
Results:
number_of_dmas
210

2025-01-24 06:52:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:52:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:52:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:52:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-24 06:52:12 - snowflake.connector.connection - INFO - closed
2025-01-24 06:52:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:52:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:52:43 - root - INFO - ```sql
SELECT "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "score" IS NOT NULL AND "score" != ''
ORDER BY "score" DESC
LIMIT 10;
```
2025-01-24 06:52:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:52:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:52:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:52:45 - snowflake.connector.connection - INFO - closed
2025-01-24 06:52:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:53:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:53:05 - root - INFO - ```sql
SELECT "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE TRY_TO_NUMBER("score") IS NOT NULL
ORDER BY TRY_TO_NUMBER("score") DESC
LIMIT 10;
```
2025-01-24 06:53:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:53:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:53:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:53:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-24 06:53:06 - snowflake.connector.connection - INFO - closed
2025-01-24 06:53:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:53:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:53:32 - root - INFO - SQL:
SELECT "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE TRY_TO_NUMBER("score") IS NOT NULL
ORDER BY TRY_TO_NUMBER("score") DESC
LIMIT 10;
Results:
term,score
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100

2025-01-24 06:53:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:53:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:53:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:53:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:53:34 - snowflake.connector.connection - INFO - closed
2025-01-24 06:53:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:53:35 - root - INFO - SQL:
SELECT DISTINCT "t"."term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS" AS "t"
INNER JOIN "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS" AS "r"
  ON "t"."term" = "r"."term" AND "t"."week" = "r"."week"
WHERE "t"."term" IS NOT NULL AND "t"."term" != ''
  AND "r"."term" IS NOT NULL AND "r"."term" != ''
LIMIT 100
Results:
term
49ers

2025-01-24 06:53:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:53:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:53:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:53:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:53:36 - snowflake.connector.connection - INFO - closed
2025-01-24 06:53:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:53:37 - root - INFO - SQL:
SELECT "dma_name", AVG(TRY_TO_NUMBER("percent_gain")) AS "average_percent_gain"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE TRY_TO_NUMBER("percent_gain") IS NOT NULL
GROUP BY "dma_name"
ORDER BY "average_percent_gain" DESC
LIMIT 100
Results:
dma_name,average_percent_gain
Traverse City-Cadillac MI,1517.222356
Tucson (Sierra Vista) AZ,1517.222356
Bend OR,1517.222356
Alpena MI,1517.222356
Lubbock TX,1517.222356
Ottumwa IA-Kirksville MO,1517.222356
Fresno-Visalia CA,1517.222356
Detroit MI,1517.222356
Harrisonburg VA,1517.222356
Springfield-Holyoke MA,1517.222356
Birmingham (Ann and Tusc) AL,1517.222356
Marquette MI,1517.222356
Wilmington NC,1517.222356
Indianapolis IN,1517.222356
Macon GA,1517.222356
Lafayette IN,1517.222356
Johnstown-Altoona-State College PA,1517.222356
Fargo-Valley City ND,1517.222356
Grand Rapids-Kalamazoo-Battle Creek MI,1517.222356
Nashville TN,1517.222356
Mankato MN,1517.222356
Cheyenne WY-Scottsbluff NE,1517.222356
San Francisco-Oakland-San Jose CA,1517.222356
Cleveland-Akron (Canton) OH,1517.222356
Utica NY,1517.222356
Wausau-Rhinelander WI,1517.222356
Presque Isle ME,1517.222356
Youngstown OH,1517.222356
Ft. Smith-Fayetteville-Springdale-Rogers AR,1517.222356
Duluth MN-Superior WI,1517.222356
Wilkes Barre-Scranton PA,1517.222356
Orlando-Daytona Beach-Melbourne FL,1517.222356
Ft. Myers-Naples FL,1517.222356
Hattiesburg-Laurel MS,1517.222356
La Crosse-Eau Claire WI,1517.222356
Toledo OH,1517.222356
Burlington VT-Plattsburgh NY,1517.222356
Louisville KY,1517.222356
Philadelphia PA,1517.222356
South Bend-Elkhart IN,1517.222356
Bluefield-Beckley-Oak Hill WV,1517.222356
Pittsburgh PA,1517.222356
Chattanooga TN,1517.222356
Florence-Myrtle Beach SC,1517.222356
Medford-Klamath Falls OR,1517.222356
Colorado Springs-Pueblo CO,1517.222356
Lansing MI,1517.222356
Anchorage AK,1517.222356
Watertown NY,1517.222356
Victoria TX,1517.222356
Memphis TN,1517.222356
Topeka KS,1517.222356
Wheeling WV-Steubenville OH,1517.222356
Seattle-Tacoma WA,1517.222356
Madison WI,1517.222356
Columbus-Tupelo-West Point MS,1517.222356
Dayton OH,1517.222356
Shreveport LA,1517.222356
Lake Charles LA,1517.222356
Erie PA,1517.222356
Beaumont-Port Arthur TX,1517.222356
Boston MA-Manchester NH,1517.222356
Columbus OH,1517.222356
San Angelo TX,1517.222356
Quincy IL-Hannibal MO-Keokuk IA,1517.222356
Yuma AZ-El Centro CA,1517.222356
Rochester-Mason City-Austin IA,1517.222356
Fairbanks AK,1517.222356
Panama City FL,1517.222356
Lima OH,1517.222356
Harrisburg-Lancaster-Lebanon-York PA,1517.222356
Binghamton NY,1517.222356
Palm Springs CA,1517.222356
Helena MT,1517.222356
Tulsa OK,1517.222356
Amarillo TX,1517.222356
Augusta GA,1517.222356
Jackson TN,1517.222356
Savannah GA,1517.222356
Greensboro-High Point-Winston Salem NC,1517.222356
Boise ID,1517.222356
Cincinnati OH,1517.222356
Corpus Christi TX,1517.222356
Austin TX,1517.222356
Missoula MT,1517.222356
West Palm Beach-Ft. Pierce FL,1517.222356
Charleston SC,1517.222356
Harlingen-Weslaco-Brownsville-McAllen TX,1517.222356
Parkersburg WV,1517.222356
Dallas-Ft. Worth TX,1517.222356
Charleston-Huntington WV,1517.222356
Omaha NE,1517.222356
Norfolk-Portsmouth-Newport News VA,1517.222356
Chico-Redding CA,1517.222356
Yakima-Pasco-Richland-Kennewick WA,1517.222356
Portland-Auburn ME,1517.222356
Chicago IL,1517.222356
Knoxville TN,1517.222356
Juneau AK,1517.222356
Joplin MO-Pittsburg KS,1517.222356

2025-01-24 06:53:37 - root - INFO - itercount: 0
2025-01-24 06:53:37 - root - INFO - Database Name: GOOGLE_TRENDS
Schema Name: GOOGLE_TRENDS
DDL describes table information.
,0
table_name,TOP_TERMS
description,
DDL,"create or replace TABLE TOP_TERMS (
	""dma_name"" VARCHAR(16777216),
	""dma_id"" NUMBER(38,0),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""refresh_date"" DATE
);"

,1
table_name,TOP_RISING_TERMS
description,
DDL,"create or replace TABLE TOP_RISING_TERMS (
	""dma_id"" NUMBER(38,0),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""percent_gain"" NUMBER(38,0),
	""refresh_date"" DATE,
	""dma_name"" VARCHAR(16777216)
);"

,2
table_name,INTERNATIONAL_TOP_RISING_TERMS
description,
DDL,"create or replace TABLE INTERNATIONAL_TOP_RISING_TERMS (
	""percent_gain"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""refresh_date"" DATE,
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""region_code"" VARCHAR(16777216),
	""rank"" NUMBER(38,0)
);"

,3
table_name,INTERNATIONAL_TOP_TERMS
description,
DDL,"create or replace TABLE INTERNATIONAL_TOP_TERMS (
	""term"" VARCHAR(16777216),
	""refresh_date"" DATE,
	""region_code"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""region_name"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""country_name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'GOOGLE_TRENDS': {'GOOGLE_TRENDS': ['INTERNATIONAL_TOP_RISING_TERMS', 'INTERNATIONAL_TOP_TERMS', 'TOP_RISING_TERMS', 'TOP_TERMS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `TOP_RISING_TERMS`
  - **"term"**: To identify the top rising terms.
  - **"week"**: To filter terms from one year ago.
  - **"dma_id"** and **"dma_name"**: To identify the DMA regions.
  - **"score"**: The search score associated with the term.
  - **"percent_gain"**: The percentage increase in search interest.
  - **"rank"**: The rank of the term.

- **Table:** `TOP_TERMS`
  - **"term"**: To get search scores for the terms.
  - **"week"**: Date of the data.
  - **"dma_id"** and **"dma_name"**: To identify the DMA regions.
  - **"score"**: The search score associated with the term.
  - **"rank"**: The rank of the term.

**Conditions That May Be Used:**

- Filter data from one year ago using the `"week"` column (e.g., `"week" = DATEADD('year', -1, CURRENT_DATE())`).
- Select terms that were top rising one year ago from `TOP_RISING_TERMS`.
- Use the terms from one year ago to find their search scores in different DMAs in `TOP_TERMS`.
- Aggregate scores per DMA to find the DMA with the highest total search scores.

---

**SQL Queries:**

1. **Retrieve distinct terms that were top rising one year ago:**

   ```sql
   SELECT DISTINCT "term"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   LIMIT 100;
   ```

2. **List top rising terms with their percent gain from one year ago:**

   ```sql
   SELECT "term", "percent_gain"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   ORDER BY "percent_gain" DESC
   LIMIT 100;
   ```

3. **Get search scores of top rising terms from `TOP_TERMS` for one year ago:**

   ```sql
   SELECT "dma_name", "term", "score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   LIMIT 100;
   ```

4. **Find DMAs with the total search scores for top rising terms one year ago:**

   ```sql
   SELECT "dma_name", SUM("score") AS "total_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   GROUP BY "dma_name"
   ORDER BY "total_search_score" DESC
   LIMIT 100;
   ```

5. **List DMAs and the number of top rising terms they have one year ago:**

   ```sql
   SELECT "dma_name", COUNT(DISTINCT "term") AS "number_of_top_rising_terms"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   GROUP BY "dma_name"
   ORDER BY "number_of_top_rising_terms" DESC
   LIMIT 100;
   ```

6. **Retrieve the highest search score of top rising terms per DMA one year ago:**

   ```sql
   SELECT "dma_name", MAX("score") AS "max_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   GROUP BY "dma_name"
   ORDER BY "max_search_score" DESC
   LIMIT 100;
   ```

7. **List terms and their search scores from `TOP_TERMS` where terms are top rising terms one year ago:**

   ```sql
   SELECT "t"."dma_name", "t"."term", "t"."score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS" AS "t"
   WHERE "t"."week" = DATEADD('year', -1, CURRENT_DATE())
     AND "t"."term" IN (
       SELECT DISTINCT "term"
       FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
       WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
     )
   ORDER BY "t"."score" DESC
   LIMIT 100;
   ```

8. **Find the average search score of top rising terms per DMA one year ago:**

   ```sql
   SELECT "dma_name", AVG("score") AS "average_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   GROUP BY "dma_name"
   ORDER BY "average_search_score" DESC
   LIMIT 100;
   ```

9. **Retrieve the top 5 DMAs with the highest total search scores for top rising terms one year ago:**

   ```sql
   SELECT "dma_name", SUM("score") AS "total_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
   GROUP BY "dma_name"
   ORDER BY "total_search_score" DESC
   LIMIT 5;
   ```

10. **List the ranks of top rising terms per DMA one year ago:**

    ```sql
    SELECT "dma_name", "term", "rank"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
    ORDER BY "dma_name", "rank" ASC
    LIMIT 100;
    ```

11. **Find DMAs where a specific term was a top rising term one year ago:**

    ```sql
    SELECT DISTINCT "dma_name"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "term" = 'SpecificTerm'
      AND "week" = DATEADD('year', -1, CURRENT_DATE())
    LIMIT 100;
    ```

12. **Get the total number of DMAs that had top rising terms one year ago:**

    ```sql
    SELECT COUNT(DISTINCT "dma_name") AS "number_of_dmas"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" = DATEADD('year', -1, CURRENT_DATE());
    ```

13. **List the top 10 terms with the highest scores from `TOP_RISING_TERMS` one year ago:**

    ```sql
    SELECT "term", "score"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
    ORDER BY "score" DESC
    LIMIT 10;
    ```

14. **Retrieve terms that appeared both in `TOP_RISING_TERMS` and `TOP_TERMS` one year ago:**

    ```sql
    SELECT DISTINCT "t"."term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS" AS "t"
    INNER JOIN "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS" AS "r"
      ON "t"."term" = "r"."term" AND "t"."week" = "r"."week"
    WHERE "t"."week" = DATEADD('year', -1, CURRENT_DATE())
    LIMIT 100;
    ```

15. **Find the average percent gain of top rising terms per DMA one year ago:**

    ```sql
    SELECT "dma_name", AVG("percent_gain") AS "average_percent_gain"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
    GROUP BY "dma_name"
    ORDER BY "average_percent_gain" DESC
    LIMIT 100;
    ```

These queries help explore and understand the relevant data within the tables to address the task. They cover various aspects such as identifying top rising terms from one year ago, aggregating search scores per DMA, and analyzing the distribution of terms across DMAs.Query:
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC
LIMIT 1;
Answer:
dma_name,total_search_score
New York NY,1264645
Query:
SELECT "term", "percent_gain"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   ORDER BY "percent_gain" DESC
   LIMIT 100
Answer:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
Query:
SELECT "dma_name", "term", "score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   LIMIT 100
Answer:
dma_name,term,score
Portland-Auburn ME,Aurora forecast,
Charlotte NC,Aurora forecast,
Portland-Auburn ME,Brandon McManus,
Charlotte NC,Brandon McManus,
Charlotte NC,Brandon McManus,
Greensboro-High Point-Winston Salem NC,Golden Bachelorette,
Greensboro-High Point-Winston Salem NC,Golden Bachelorette,
Gainesville FL,Golden Bachelorette,
Joplin MO-Pittsburg KS,Golden Bachelorette,
Joplin MO-Pittsburg KS,Golden Bachelorette,
Ft. Smith-Fayetteville-Springdale-Rogers AR,Golden Bachelorette,
Cheyenne WY-Scottsbluff NE,Golden Bachelorette,
Cheyenne WY-Scottsbluff NE,Golden Bachelorette,
Portland-Auburn ME,49ers vs Seahawks,
Portland-Auburn ME,49ers vs Seahawks,
Charlotte NC,49ers vs Seahawks,
Greenville-New Bern-Washington NC,49ers vs Seahawks,
Dothan AL,49ers vs Seahawks,
Portland-Auburn ME,Aurora forecast,
Charlotte NC,Aurora forecast,
Greenville-New Bern-Washington NC,Aurora forecast,
Chattanooga TN,Aurora forecast,
Dothan AL,Aurora forecast,
Greenville-New Bern-Washington NC,Aurora forecast,
Wilmington NC,Aurora forecast,
Wilmington NC,Aurora forecast,
Chattanooga TN,Aurora forecast,
Great Falls MT,Ohio State football,
Lima OH,Ohio State football,5.0
Lima OH,Ohio State football,4.0
Baltimore MD,49ers vs Seahawks,
Atlanta GA,49ers vs Seahawks,
Atlanta GA,49ers vs Seahawks,
Marquette MI,49ers vs Seahawks,
Marquette MI,49ers vs Seahawks,
Wilkes Barre-Scranton PA,49ers vs Seahawks,
Evansville IN,49ers vs Seahawks,
Evansville IN,49ers vs Seahawks,
Rapid City SD,49ers vs Seahawks,
Charlotte NC,Aiden Hutchinson,
Greenville-New Bern-Washington NC,Aiden Hutchinson,
Wilmington NC,Aiden Hutchinson,
Wilmington NC,Aiden Hutchinson,
Grand Rapids-Kalamazoo-Battle Creek MI,Aurora forecast,
Grand Rapids-Kalamazoo-Battle Creek MI,Aurora forecast,
Wilkes Barre-Scranton PA,Aurora forecast,
Evansville IN,Aurora forecast,
Evansville IN,Aurora forecast,
Rapid City SD,Aurora forecast,
Rapid City SD,Aurora forecast,
Greenville-New Bern-Washington NC,Brandon McManus,
Greenville-New Bern-Washington NC,Brandon McManus,
Wilmington NC,Brandon McManus,
Wilmington NC,Brandon McManus,
Chattanooga TN,Brandon McManus,
Dothan AL,Brandon McManus,
Medford-Klamath Falls OR,Ohio State football,
Medford-Klamath Falls OR,Ohio State football,
Indianapolis IN,Ohio State football,2.0
Norfolk-Portsmouth-Newport News VA,Ohio State football,
Alpena MI,Ohio State football,
Alpena MI,Ohio State football,
Philadelphia PA,49ers vs Seahawks,
Philadelphia PA,49ers vs Seahawks,
Buffalo NY,49ers vs Seahawks,
Ft. Myers-Naples FL,49ers vs Seahawks,
Lake Charles LA,49ers vs Seahawks,
Huntsville-Decatur (Florence) AL,49ers vs Seahawks,
Huntsville-Decatur (Florence) AL,49ers vs Seahawks,
Juneau AK,49ers vs Seahawks,
Seattle-Tacoma WA,49ers vs Seahawks,
Savannah GA,49ers vs Seahawks,
Savannah GA,49ers vs Seahawks,
Cleveland-Akron (Canton) OH,49ers vs Seahawks,
Panama City FL,49ers vs Seahawks,
Panama City FL,49ers vs Seahawks,
Palm Springs CA,49ers vs Seahawks,
Dothan AL,Aiden Hutchinson,
Atlanta GA,Aiden Hutchinson,
Grand Rapids-Kalamazoo-Battle Creek MI,Aiden Hutchinson,3.0
Wilkes Barre-Scranton PA,Aiden Hutchinson,
Wilkes Barre-Scranton PA,Aiden Hutchinson,
Rapid City SD,Aiden Hutchinson,
Dothan AL,Aurora forecast,
Baltimore MD,Aurora forecast,
Baltimore MD,Aurora forecast,
Atlanta GA,Aurora forecast,
Atlanta GA,Aurora forecast,
Marquette MI,Aurora forecast,
Marquette MI,Aurora forecast,
Wilkes Barre-Scranton PA,Aurora forecast,
Buffalo NY,Aurora forecast,
Buffalo NY,Aurora forecast,
Ft. Myers-Naples FL,Aurora forecast,
Ft. Myers-Naples FL,Aurora forecast,
Las Vegas NV,Aurora forecast,
Columbus-Tupelo-West Point MS,Aurora forecast,
Columbus-Tupelo-West Point MS,Aurora forecast,
Huntsville-Decatur (Florence) AL,Aurora forecast,
Juneau AK,Aurora forecast,
Query:
SELECT "dma_name", SUM("score") AS "total_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "total_search_score" DESC
   LIMIT 100
Answer:
dma_name,total_search_score
Los Angeles CA,11103
San Francisco-Oakland-San Jose CA,10483
Atlanta GA,10458
Chicago IL,10363
Salt Lake City UT,10229
Philadelphia PA,10057
Sacramento-Stockton-Modesto CA,10053
Charlotte NC,10035
New York NY,9996
Detroit MI,9975
Washington DC (Hagerstown MD),9936
Denver CO,9929
Dallas-Ft. Worth TX,9903
Boston MA-Manchester NH,9821
Pittsburgh PA,9819
Seattle-Tacoma WA,9792
Phoenix AZ,9787
Greenville-Spartanburg-Asheville-Anderson,9748
Baltimore MD,9684
Raleigh-Durham (Fayetteville) NC,9615
Providence-New Bedford MA,9581
San Diego CA,9531
Fresno-Visalia CA,9505
Houston TX,9497
Hartford & New Haven CT,9489
Portland OR,9466
Orlando-Daytona Beach-Melbourne FL,9415
Austin TX,9395
Columbia SC,9332
Harrisburg-Lancaster-Lebanon-York PA,9329
Nashville TN,9311
Cleveland-Akron (Canton) OH,9305
Indianapolis IN,9288
Columbus OH,9281
Minneapolis-St. Paul MN,9241
Albuquerque-Santa Fe NM,9228
Tampa-St. Petersburg (Sarasota) FL,9215
Greensboro-High Point-Winston Salem NC,9186
Milwaukee WI,9182
Louisville KY,9180
Grand Rapids-Kalamazoo-Battle Creek MI,9166
Wilkes Barre-Scranton PA,9136
San Antonio TX,9109
Savannah GA,9051
Syracuse NY,9039
Miami-Ft. Lauderdale FL,8938
Birmingham (Ann and Tusc) AL,8933
Buffalo NY,8849
Mobile AL-Pensacola (Ft. Walton Beach) FL,8835
Lexington KY,8819
Albany-Schenectady-Troy NY,8743
Norfolk-Portsmouth-Newport News VA,8741
New Orleans LA,8737
Waco-Temple-Bryan TX,8722
Huntsville-Decatur (Florence) AL,8701
Jacksonville FL,8699
Spokane WA,8634
Las Vegas NV,8612
Honolulu HI,8610
Richmond-Petersburg VA,8598
St. Louis MO,8597
Toledo OH,8597
Oklahoma City OK,8543
Cincinnati OH,8464
West Palm Beach-Ft. Pierce FL,8441
Monterey-Salinas CA,8422
El Paso TX,8405
Ft. Myers-Naples FL,8363
Omaha NE,8323
Augusta GA,8323
Macon GA,8309
Chattanooga TN,8288
Little Rock-Pine Bluff AR,8267
Memphis TN,8263
Dayton OH,8239
Colorado Springs-Pueblo CO,8222
Des Moines-Ames IA,8214
Baton Rouge LA,8187
Knoxville TN,8174
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,8103
Tulsa OK,8091
Boise ID,8076
Charleston SC,8073
Florence-Myrtle Beach SC,8060
Rochester NY,7960
Madison WI,7926
Tucson (Sierra Vista) AZ,7923
Wichita-Hutchinson KS,7916
Santa Barbara-Santa Maria-San Luis Obispo CA,7894
Roanoke-Lynchburg VA,7887
Flint-Saginaw-Bay City MI,7871
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,7848
Shreveport LA,7819
Evansville IN,7789
Champaign & Springfield-Decatur IL,7751
Kansas City MO,7722
Harlingen-Weslaco-Brownsville-McAllen TX,7696
Green Bay-Appleton WI,7687
Ft. Smith-Fayetteville-Springdale-Rogers AR,7682
Reno NV,7543
Query:
SELECT "dma_name", COUNT(DISTINCT "term") AS "number_of_top_rising_terms"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "number_of_top_rising_terms" DESC
   LIMIT 100
Answer:
dma_name,number_of_top_rising_terms
Knoxville TN,513
Springfield-Holyoke MA,513
Lubbock TX,513
Birmingham (Ann and Tusc) AL,513
Ottumwa IA-Kirksville MO,513
Chicago IL,513
Wilmington NC,513
Austin TX,513
Wilkes Barre-Scranton PA,513
Orlando-Daytona Beach-Melbourne FL,513
Columbia-Jefferson City MO,513
Duluth MN-Superior WI,513
Sherman-Ada OK,513
Alexandria LA,513
Dothan AL,513
Zanesville OH,513
Bend OR,513
Traverse City-Cadillac MI,513
Fresno-Visalia CA,513
Providence-New Bedford MA,513
Des Moines-Ames IA,513
Jackson MS,513
Davenport IA-Rock Island-Moline IL,513
Waco-Temple-Bryan TX,513
Little Rock-Pine Bluff AR,513
Biloxi-Gulfport MS,513
Helena MT,513
Minot-Bismarck-Dickinson(Williston) ND,513
Columbus GA,513
Madison WI,513
Columbus-Tupelo-West Point MS,513
St. Louis MO,513
Monroe LA-El Dorado AR,513
Salt Lake City UT,513
Buffalo NY,513
Miami-Ft. Lauderdale FL,513
Topeka KS,513
Seattle-Tacoma WA,513
Wheeling WV-Steubenville OH,513
Los Angeles CA,513
Laredo TX,513
Champaign & Springfield-Decatur IL,513
Greenville-Spartanburg-Asheville-Anderson,513
Kansas City MO,513
Joplin MO-Pittsburg KS,513
Tucson (Sierra Vista) AZ,513
Juneau AK,513
Oklahoma City OK,513
Tyler-Longview(Lufkin & Nacogdoches) TX,513
North Platte NE,513
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,513
Albany-Schenectady-Troy NY,513
Meridian MS,513
Springfield MO,513
Yakima-Pasco-Richland-Kennewick WA,513
Lake Charles LA,513
Columbus OH,513
Dayton OH,513
Quincy IL-Hannibal MO-Keokuk IA,513
San Angelo TX,513
Charleston SC,513
West Palm Beach-Ft. Pierce FL,513
Missoula MT,513
Hartford & New Haven CT,513
Jonesboro AR,513
Sacramento-Stockton-Modesto CA,513
Salisbury MD,513
Lexington KY,513
San Diego CA,513
Twin Falls ID,513
Santa Barbara-Santa Maria-San Luis Obispo CA,513
Glendive MT,513
Terre Haute IN,513
Reno NV,513
Baltimore MD,513
Sioux City IA,513
Green Bay-Appleton WI,513
Lafayette IN,513
Fargo-Valley City ND,513
Grand Rapids-Kalamazoo-Battle Creek MI,513
Johnstown-Altoona-State College PA,513
Boston MA-Manchester NH,513
Beaumont-Port Arthur TX,513
Erie PA,513
Rochester-Mason City-Austin IA,513
Yuma AZ-El Centro CA,513
Hattiesburg-Laurel MS,513
Toledo OH,513
Burlington VT-Plattsburgh NY,513
La Crosse-Eau Claire WI,513
Huntsville-Decatur (Florence) AL,513
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,513
Columbia SC,513
Rockford IL,513
Shreveport LA,513
Rapid City SD,513
Ft. Smith-Fayetteville-Springdale-Rogers AR,513
Alpena MI,513
Detroit MI,513
Harrisonburg VA,513
Query:
SELECT "dma_name", MAX("score") AS "max_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "max_search_score" DESC
   LIMIT 100
Answer:
dma_name,max_search_score
Knoxville TN,100
Alpena MI,100
Bend OR,100
Detroit MI,100
Traverse City-Cadillac MI,100
Harrisonburg VA,100
Orlando-Daytona Beach-Melbourne FL,100
Ft. Smith-Fayetteville-Springdale-Rogers AR,100
Wilkes Barre-Scranton PA,100
Duluth MN-Superior WI,100
Greensboro-High Point-Winston Salem NC,100
Cincinnati OH,100
Corpus Christi TX,100
Austin TX,100
Helena MT,100
Rochester NY,100
Bakersfield CA,100
Marquette MI,100
Indianapolis IN,100
Macon GA,100
Lake Charles LA,100
Dayton OH,100
Shreveport LA,100
Yakima-Pasco-Richland-Kennewick WA,100
Quincy IL-Hannibal MO-Keokuk IA,100
Toledo OH,100
Columbus OH,100
Hattiesburg-Laurel MS,100
Burlington VT-Plattsburgh NY,100
La Crosse-Eau Claire WI,100
Las Vegas NV,100
Washington DC (Hagerstown MD),100
San Francisco-Oakland-San Jose CA,100
Mankato MN,100
Cheyenne WY-Scottsbluff NE,100
Nashville TN,100
Cleveland-Akron (Canton) OH,100
Fresno-Visalia CA,100
Casper-Riverton WY,100
Syracuse NY,100
Phoenix AZ,100
Bowling Green KY,100
Greenwood-Greenville MS,100
Butte-Bozeman MT,100
Champaign & Springfield-Decatur IL,100
Los Angeles CA,100
Kansas City MO,100
Greenville-Spartanburg-Asheville-Anderson,100
Laredo TX,100
Madison WI,100
Columbus-Tupelo-West Point MS,100
Wilmington NC,100
Chicago IL,100
Birmingham (Ann and Tusc) AL,100
Seattle-Tacoma WA,100
Topeka KS,100
Pittsburgh PA,100
Wheeling WV-Steubenville OH,100
Philadelphia PA,100
South Bend-Elkhart IN,100
Louisville KY,100
Chattanooga TN,100
Utica NY,100
Presque Isle ME,100
Portland-Auburn ME,100
Juneau AK,100
Joplin MO-Pittsburg KS,100
Tucson (Sierra Vista) AZ,100
Portland OR,100
Houston TX,100
Milwaukee WI,100
Evansville IN,100
Anchorage AK,100
Victoria TX,100
Lansing MI,100
Watertown NY,100
Memphis TN,100
Colorado Springs-Pueblo CO,100
Florence-Myrtle Beach SC,100
Medford-Klamath Falls OR,100
Youngstown OH,100
Wausau-Rhinelander WI,100
Rochester-Mason City-Austin IA,100
Yuma AZ-El Centro CA,100
Mobile AL-Pensacola (Ft. Walton Beach) FL,100
El Paso TX,100
Elmira (Corning) NY,100
Zanesville OH,100
Columbia-Jefferson City MO,100
Alexandria LA,100
Sherman-Ada OK,100
Dothan AL,100
West Palm Beach-Ft. Pierce FL,100
Missoula MT,100
Bluefield-Beckley-Oak Hill WV,100
San Angelo TX,100
Boise ID,100
Springfield-Holyoke MA,100
Lubbock TX,100
Ottumwa IA-Kirksville MO,100
Query:
SELECT "t"."dma_name", "t"."term", "t"."score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS" AS "t"
   WHERE "t"."week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
     AND "t"."term" IN (
       SELECT DISTINCT "term"
       FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
       WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
     )
   ORDER BY "t"."score" DESC
   LIMIT 100
Answer:
dma_name,term,score
Glendive MT,49ers,
Presque Isle ME,49ers,
Presque Isle ME,49ers,
Glendive MT,49ers,
Presque Isle ME,49ers,
Glendive MT,49ers,
Glendive MT,49ers,
Juneau AK,49ers,
Portland OR,49ers,100.0
Pittsburgh PA,49ers,100.0
Toledo OH,49ers,100.0
Tucson (Sierra Vista) AZ,49ers,100.0
Anchorage AK,49ers,100.0
Omaha NE,49ers,100.0
Joplin MO-Pittsburg KS,49ers,100.0
Wichita Falls TX & Lawton OK,49ers,100.0
Medford-Klamath Falls OR,49ers,100.0
Chattanooga TN,49ers,100.0
Casper-Riverton WY,49ers,100.0
San Angelo TX,49ers,100.0
Columbia-Jefferson City MO,49ers,100.0
Wilkes Barre-Scranton PA,49ers,100.0
Jonesboro AR,49ers,100.0
Denver CO,49ers,100.0
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,49ers,100.0
Columbus OH,49ers,100.0
Portland-Auburn ME,49ers,100.0
Washington DC (Hagerstown MD),49ers,100.0
Davenport IA-Rock Island-Moline IL,49ers,100.0
Greenville-Spartanburg-Asheville-Anderson,49ers,100.0
Tampa-St. Petersburg (Sarasota) FL,49ers,100.0
Odessa-Midland TX,49ers,100.0
Sacramento-Stockton-Modesto CA,49ers,100.0
Richmond-Petersburg VA,49ers,100.0
Panama City FL,49ers,100.0
Champaign & Springfield-Decatur IL,49ers,100.0
Springfield-Holyoke MA,49ers,100.0
Baton Rouge LA,49ers,100.0
Bakersfield CA,49ers,100.0
Jackson TN,49ers,100.0
Grand Rapids-Kalamazoo-Battle Creek MI,49ers,100.0
Topeka KS,49ers,100.0
Helena MT,49ers,100.0
Lubbock TX,49ers,100.0
Ft. Smith-Fayetteville-Springdale-Rogers AR,49ers,100.0
San Antonio TX,49ers,100.0
Peoria-Bloomington IL,49ers,100.0
West Palm Beach-Ft. Pierce FL,49ers,100.0
Ft. Wayne IN,49ers,100.0
Orlando-Daytona Beach-Melbourne FL,49ers,100.0
Chicago IL,49ers,100.0
Terre Haute IN,49ers,100.0
Gainesville FL,49ers,100.0
Omaha NE,49ers,100.0
Wheeling WV-Steubenville OH,49ers,100.0
Louisville KY,49ers,100.0
Augusta GA,49ers,100.0
St. Joseph MO,49ers,100.0
Jackson MS,49ers,100.0
Albuquerque-Santa Fe NM,49ers,100.0
Peoria-Bloomington IL,49ers,100.0
Davenport IA-Rock Island-Moline IL,49ers,100.0
Tri-Cities TN-VA,49ers,100.0
Meridian MS,49ers,100.0
Beaumont-Port Arthur TX,49ers,100.0
Albany-Schenectady-Troy NY,49ers,100.0
Johnstown-Altoona-State College PA,49ers,100.0
Traverse City-Cadillac MI,49ers,100.0
Shreveport LA,49ers,100.0
Laredo TX,49ers,100.0
San Angelo TX,49ers,100.0
Houston TX,49ers,100.0
Greenville-New Bern-Washington NC,49ers,100.0
Harlingen-Weslaco-Brownsville-McAllen TX,49ers,100.0
Syracuse NY,49ers,100.0
Los Angeles CA,49ers,100.0
Zanesville OH,49ers,100.0
Champaign & Springfield-Decatur IL,49ers,100.0
Bluefield-Beckley-Oak Hill WV,49ers,100.0
Boston MA-Manchester NH,49ers,100.0
Juneau AK,49ers,100.0
Memphis TN,49ers,100.0
Sioux Falls(Mitchell) SD,49ers,100.0
Lincoln & Hastings-Kearney NE,49ers,100.0
Honolulu HI,49ers,100.0
Ottumwa IA-Kirksville MO,49ers,100.0
Bakersfield CA,49ers,100.0
Idaho Falls-Pocatello ID,49ers,100.0
Rapid City SD,49ers,100.0
Joplin MO-Pittsburg KS,49ers,100.0
Flint-Saginaw-Bay City MI,49ers,100.0
Lafayette LA,49ers,100.0
Rockford IL,49ers,100.0
Charleston-Huntington WV,49ers,100.0
New York NY,49ers,100.0
Austin TX,49ers,100.0
Sioux City IA,49ers,100.0
Quincy IL-Hannibal MO-Keokuk IA,49ers,100.0
Nashville TN,49ers,100.0
Kansas City MO,49ers,100.0
Query:
SELECT "dma_name", AVG("score") AS "average_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "average_search_score" DESC
   LIMIT 100
Answer:
dma_name,average_search_score
Glendive MT,89.500000
Alpena MI,88.040000
Presque Isle ME,87.857143
North Platte NE,76.000000
Juneau AK,75.357143
Fairbanks AK,75.181818
Helena MT,69.000000
Victoria TX,67.360000
Grand Junction-Montrose CO,64.123077
Casper-Riverton WY,62.716667
Ottumwa IA-Kirksville MO,60.750000
Marquette MI,60.476744
Cheyenne WY-Scottsbluff NE,60.120690
Quincy IL-Hannibal MO-Keokuk IA,59.539474
Great Falls MT,59.000000
Mankato MN,58.234375
Clarksburg-Weston WV,56.942857
Beaumont-Port Arthur TX,56.896000
San Angelo TX,56.845070
Alexandria LA,56.771930
Eureka CA,56.618182
Bluefield-Beckley-Oak Hill WV,56.530864
St. Joseph MO,55.728814
Jonesboro AR,55.718750
Wheeling WV-Steubenville OH,55.443299
Terre Haute IN,55.121212
Parkersburg WV,55.032258
Lima OH,54.694444
Twin Falls ID,54.658824
Zanesville OH,54.375000
Butte-Bozeman MT,54.223404
Sherman-Ada OK,54.009091
Meridian MS,53.982456
Medford-Klamath Falls OR,53.747899
Abilene-Sweetwater TX,53.440000
Hattiesburg-Laurel MS,53.313725
Billings MT,53.204082
Amarillo TX,53.067164
Rockford IL,52.871212
Joplin MO-Pittsburg KS,52.796748
Rapid City SD,52.641975
Monroe LA-El Dorado AR,52.555556
Bend OR,52.536232
Chico-Redding CA,52.347518
Utica NY,51.916667
Minot-Bismarck-Dickinson(Williston) ND,51.801887
Greenwood-Greenville MS,51.783333
Duluth MN-Superior WI,51.669725
Jackson TN,51.217391
Wichita Falls TX & Lawton OK,50.272727
Albany GA,49.812030
Anchorage AK,49.557377
Harrisonburg VA,49.327869
Idaho Falls-Pocatello ID,49.248120
Watertown NY,49.152941
Rochester-Mason City-Austin IA,49.060606
Elmira (Corning) NY,49.046512
Bowling Green KY,48.745098
Bangor ME,48.686275
Topeka KS,48.282443
Missoula MT,47.552381
Laredo TX,47.379630
Lafayette IN,47.194030
Lubbock TX,47.150685
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,46.437870
Binghamton NY,45.980392
Charlottesville VA,45.952756
Erie PA,45.896825
Yuma AZ-El Centro CA,44.553846
Macon GA,44.433155
Lafayette LA,44.380952
Biloxi-Gulfport MS,44.240000
Wausau-Rhinelander WI,44.226891
Monterey-Salinas CA,44.094241
Sioux City IA,44.017751
Evansville IN,43.758427
Tyler-Longview(Lufkin & Nacogdoches) TX,43.738372
Montgomery-Selma AL,43.615854
Lake Charles LA,43.357143
Traverse City-Cadillac MI,42.878788
Odessa-Midland TX,42.683099
Fargo-Valley City ND,42.294872
La Crosse-Eau Claire WI,41.482517
Dothan AL,41.315789
Salisbury MD,41.180645
Peoria-Bloomington IL,41.114865
Bakersfield CA,41.099448
Columbia-Jefferson City MO,41.046512
Columbus-Tupelo-West Point MS,41.007407
Jackson MS,40.740113
Shreveport LA,40.723958
Yakima-Pasco-Richland-Kennewick WA,40.358696
Wilmington NC,40.253165
Eugene OR,40.092199
Davenport IA-Rock Island-Moline IL,40.067416
Panama City FL,40.039474
Augusta GA,40.014423
Corpus Christi TX,39.560606
Tri-Cities TN-VA,39.251429
Palm Springs CA,39.241830
Query:
SELECT "dma_name", SUM("score") AS "total_search_score"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   GROUP BY "dma_name"
   ORDER BY "total_search_score" DESC
   LIMIT 5
Answer:
dma_name,total_search_score
Los Angeles CA,11103
San Francisco-Oakland-San Jose CA,10483
Atlanta GA,10458
Chicago IL,10363
Salt Lake City UT,10229
Query:
SELECT "dma_name", "term", "rank"
   FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
   WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
   ORDER BY "dma_name", "rank" ASC
   LIMIT 100
Answer:
dma_name,term,rank
Abilene-Sweetwater TX,ratan tata,1
Abilene-Sweetwater TX,bills vs jets,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,chiefs vs falcons,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,olivia nuzzi,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,south carolina vs alabama,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,national daughters day,1
Abilene-Sweetwater TX,pete rose,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,olivia nuzzi,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,buccaneers vs falcons,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,cowboys vs steelers,1
Abilene-Sweetwater TX,skrrt,1
Abilene-Sweetwater TX,hurricane milton,1
Abilene-Sweetwater TX,john amos,1
Abilene-Sweetwater TX,skrrt,1
Abilene-Sweetwater TX,pete rose,1
Abilene-Sweetwater TX,aidan hutchinson,1
Abilene-Sweetwater TX,aiden hutchinson,1
Abilene-Sweetwater TX,ravens vs cowboys,1
Abilene-Sweetwater TX,national daughters day,1
Abilene-Sweetwater TX,emerson romero,1
Abilene-Sweetwater TX,seahawks vs 49ers,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,cowboys vs steelers,1
Abilene-Sweetwater TX,aiden hutchinson,1
Abilene-Sweetwater TX,tropical storm warning,1
Abilene-Sweetwater TX,seahawks vs 49ers,1
Abilene-Sweetwater TX,hurricane helene,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,maggie smith,1
Abilene-Sweetwater TX,liam payne,1
Abilene-Sweetwater TX,ravens vs cowboys,1
Abilene-Sweetwater TX,tropical storm warning,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,ratan tata,1
Abilene-Sweetwater TX,witherspoon meaning,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,aidan hutchinson,1
Abilene-Sweetwater TX,ryan routh,1
Abilene-Sweetwater TX,national dog day,1
Abilene-Sweetwater TX,buccaneers vs falcons,1
Abilene-Sweetwater TX,south carolina vs alabama,1
Abilene-Sweetwater TX,witherspoon meaning,1
Abilene-Sweetwater TX,john amos,1
Abilene-Sweetwater TX,ryan routh,1
Abilene-Sweetwater TX,hurricane helene,1
Abilene-Sweetwater TX,chiefs vs falcons,1
Abilene-Sweetwater TX,alabama vs vanderbilt,1
Abilene-Sweetwater TX,alabama vs vanderbilt,1
Abilene-Sweetwater TX,bills vs jets,1
Abilene-Sweetwater TX,how to register to vote in the us,1
Abilene-Sweetwater TX,hurricane milton,1
Abilene-Sweetwater TX,kris kristofferson,1
Abilene-Sweetwater TX,liam payne,1
Abilene-Sweetwater TX,national dog day,1
Abilene-Sweetwater TX,hurricane milton tracker,2
Abilene-Sweetwater TX,vanderbilt football,2
Abilene-Sweetwater TX,cowboys vs giants,2
Abilene-Sweetwater TX,vanderbilt football,2
Abilene-Sweetwater TX,matt gaetz,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,eric adams,2
Abilene-Sweetwater TX,matt gaetz,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,saints vs chiefs,2
Abilene-Sweetwater TX,cowboys vs giants,2
Abilene-Sweetwater TX,baylor vs colorado,2
Abilene-Sweetwater TX,northern lights tonight,2
Abilene-Sweetwater TX,sean combs,2
Abilene-Sweetwater TX,ryan wesley routh,2
Abilene-Sweetwater TX,commanders vs bengals,2
Abilene-Sweetwater TX,aiden hutchinson,2
Abilene-Sweetwater TX,eric adams,2
Abilene-Sweetwater TX,aiden hutchinson,2
Abilene-Sweetwater TX,gamut,2
Abilene-Sweetwater TX,liam payne death,2
Abilene-Sweetwater TX,mark robinson,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,mark robinson,2
Abilene-Sweetwater TX,saints vs chiefs,2
Abilene-Sweetwater TX,mark robinson,2
Abilene-Sweetwater TX,mutombo,2
Abilene-Sweetwater TX,alabama vs georgia,2
Abilene-Sweetwater TX,texas vs oklahoma,2
Abilene-Sweetwater TX,ryan wesley routh,2
Abilene-Sweetwater TX,texas vs oklahoma,2
Abilene-Sweetwater TX,baylor vs colorado,2
Abilene-Sweetwater TX,alabama vs georgia,2
Abilene-Sweetwater TX,hurricane helene tracker,2
Query:
SELECT "dma_name", "term", "rank"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
ORDER BY "dma_name", "rank" ASC
LIMIT 100;
Answer:
dma_name,term,rank
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Abilene-Sweetwater TX,venus de milo,1
Query:
SELECT COUNT(DISTINCT "dma_name") AS "number_of_dmas"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
Answer:
number_of_dmas
210
Query:
SELECT "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE TRY_TO_NUMBER("score") IS NOT NULL
ORDER BY TRY_TO_NUMBER("score") DESC
LIMIT 10;
Answer:
term,score
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
eminem,100
Query:
SELECT DISTINCT "t"."term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS" AS "t"
INNER JOIN "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS" AS "r"
  ON "t"."term" = "r"."term" AND "t"."week" = "r"."week"
WHERE "t"."term" IS NOT NULL AND "t"."term" != ''
  AND "r"."term" IS NOT NULL AND "r"."term" != ''
LIMIT 100
Answer:
term
49ers
Query:
SELECT "dma_name", AVG(TRY_TO_NUMBER("percent_gain")) AS "average_percent_gain"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE TRY_TO_NUMBER("percent_gain") IS NOT NULL
GROUP BY "dma_name"
ORDER BY "average_percent_gain" DESC
LIMIT 100
Answer:
dma_name,average_percent_gain
Traverse City-Cadillac MI,1517.222356
Tucson (Sierra Vista) AZ,1517.222356
Bend OR,1517.222356
Alpena MI,1517.222356
Lubbock TX,1517.222356
Ottumwa IA-Kirksville MO,1517.222356
Fresno-Visalia CA,1517.222356
Detroit MI,1517.222356
Harrisonburg VA,1517.222356
Springfield-Holyoke MA,1517.222356
Birmingham (Ann and Tusc) AL,1517.222356
Marquette MI,1517.222356
Wilmington NC,1517.222356
Indianapolis IN,1517.222356
Macon GA,1517.222356
Lafayette IN,1517.222356
Johnstown-Altoona-State College PA,1517.222356
Fargo-Valley City ND,1517.222356
Grand Rapids-Kalamazoo-Battle Creek MI,1517.222356
Nashville TN,1517.222356
Mankato MN,1517.222356
Cheyenne WY-Scottsbluff NE,1517.222356
San Francisco-Oakland-San Jose CA,1517.222356
Cleveland-Akron (Canton) OH,1517.222356
Utica NY,1517.222356
Wausau-Rhinelander WI,1517.222356
Presque Isle ME,1517.222356
Youngstown OH,1517.222356
Ft. Smith-Fayetteville-Springdale-Rogers AR,1517.222356
Duluth MN-Superior WI,1517.222356
Wilkes Barre-Scranton PA,1517.222356
Orlando-Daytona Beach-Melbourne FL,1517.222356
Ft. Myers-Naples FL,1517.222356
Hattiesburg-Laurel MS,1517.222356
La Crosse-Eau Claire WI,1517.222356
Toledo OH,1517.222356
Burlington VT-Plattsburgh NY,1517.222356
Louisville KY,1517.222356
Philadelphia PA,1517.222356
South Bend-Elkhart IN,1517.222356
Bluefield-Beckley-Oak Hill WV,1517.222356
Pittsburgh PA,1517.222356
Chattanooga TN,1517.222356
Florence-Myrtle Beach SC,1517.222356
Medford-Klamath Falls OR,1517.222356
Colorado Springs-Pueblo CO,1517.222356
Lansing MI,1517.222356
Anchorage AK,1517.222356
Watertown NY,1517.222356
Victoria TX,1517.222356
Memphis TN,1517.222356
Topeka KS,1517.222356
Wheeling WV-Steubenville OH,1517.222356
Seattle-Tacoma WA,1517.222356
Madison WI,1517.222356
Columbus-Tupelo-West Point MS,1517.222356
Dayton OH,1517.222356
Shreveport LA,1517.222356
Lake Charles LA,1517.222356
Erie PA,1517.222356
Beaumont-Port Arthur TX,1517.222356
Boston MA-Manchester NH,1517.222356
Columbus OH,1517.222356
San Angelo TX,1517.222356
Quincy IL-Hannibal MO-Keokuk IA,1517.222356
Yuma AZ-El Centro CA,1517.222356
Rochester-Mason City-Austin IA,1517.222356
Fairbanks AK,1517.222356
Panama City FL,1517.222356
Lima OH,1517.222356
Harrisburg-Lancaster-Lebanon-York PA,1517.222356
Binghamton NY,1517.222356
Palm Springs CA,1517.222356
Helena MT,1517.222356
Tulsa OK,1517.222356
Amarillo TX,1517.222356
Augusta GA,1517.222356
Jackson TN,1517.222356
Savannah GA,1517.222356
Greensboro-High Point-Winston Salem NC,1517.222356
Boise ID,1517.222356
Cincinnati OH,1517.222356
Corpus Christi TX,1517.222356
Austin TX,1517.222356
Missoula MT,1517.222356
West Palm Beach-Ft. Pierce FL,1517.222356
Charleston SC,1517.222356
Harlingen-Weslaco-Brownsville-McAllen TX,1517.222356
Parkersburg WV,1517.222356
Dallas-Ft. Worth TX,1517.222356
Charleston-Huntington WV,1517.222356
Omaha NE,1517.222356
Norfolk-Portsmouth-Newport News VA,1517.222356
Chico-Redding CA,1517.222356
Yakima-Pasco-Richland-Kennewick WA,1517.222356
Portland-Auburn ME,1517.222356
Chicago IL,1517.222356
Knoxville TN,1517.222356
Juneau AK,1517.222356
Joplin MO-Pittsburg KS,1517.222356
End Exploring Related Columns
Task: Identify which DMA had the highest search scores for the terms that were top rising one year ago

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
dma_name,total_search_score
dma_name1:str,score1:int
(Attention: answer in one row)
```

**Explanation:**

The DMA (Designated Market Area) with the highest search scores for the terms that were top rising one year ago is identified by aggregating the search scores of those terms for each DMA. The DMA with the highest total search score across these terms is presented in the result..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'GOOGLE_TRENDS': {'GOOGLE_TRENDS': ['INTERNATIONAL_TOP_RISING_TERMS', 'INTERNATIONAL_TOP_TERMS', 'TOP_RISING_TERMS', 'TOP_TERMS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 06:54:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:54:07 - root - INFO - ```sql
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC
LIMIT 1;
```

```csv
dma_name,total_search_score
Los Angeles CA:str,11103:int
```
2025-01-24 06:54:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:54:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:54:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:54:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 06:54:08 - snowflake.connector.connection - INFO - closed
2025-01-24 06:54:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:54:09 - root - INFO - itercount: 1
2025-01-24 06:54:09 - root - INFO - No data found for the specified query.

2025-01-24 06:54:09 - root - INFO - Input sql:
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" = DATEADD('year', -1, CURRENT_DATE())
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC
LIMIT 1;
The error information is:
 No data found for the specified query.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-24 06:54:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:54:30 - root - INFO - ```sql
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
```

```csv
dma_name,total_search_score
Los Angeles CA:str,11103:int
```
2025-01-24 06:54:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:54:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:54:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:54:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:54:32 - snowflake.connector.connection - INFO - closed
2025-01-24 06:54:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:54:32 - root - INFO - itercount: 2
2025-01-24 06:54:32 - root - INFO - 0
2025-01-24 06:54:32 - root - INFO - results: 
dma_name,total_search_score
Los Angeles CA,11103


2025-01-24 06:54:32 - root - INFO - Please check the answer again by reviewing Identify which DMA had the highest search scores for the terms that were top rising one year ago, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
dma_name,total_search_score
dma_name1:str,score1:int
(Attention: answer in one row)
```

**Explanation:**

The DMA (Designated Market Area) with the highest search scores for the terms that were top rising one year ago is identified by aggregating the search scores of those terms for each DMA. The DMA with the highest total search score across these terms is presented in the result. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
dma_name,total_search_score
Los Angeles CA,11103
Current sql:
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
2025-01-24 06:54:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:54:57 - root - INFO - ```sql
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN DATEADD('year', -1, CURRENT_DATE() - INTERVAL '7 DAY') AND DATEADD('year', -1, CURRENT_DATE() + INTERVAL '7 DAY')
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
```

```csv
dma_name,total_search_score
Los Angeles CA:str,11103:int
```
2025-01-24 06:54:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:54:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:54:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:54:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:54:59 - snowflake.connector.connection - INFO - closed
2025-01-24 06:54:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:54:59 - root - INFO - itercount: 3
2025-01-24 06:54:59 - root - INFO - 0
2025-01-24 06:54:59 - root - INFO - Total iteration counts: 3
