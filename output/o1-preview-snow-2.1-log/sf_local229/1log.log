2025-01-25 03:24:45 - openai._base_client - INFO - Retrying request to /chat/completions in 0.414932 seconds
2025-01-25 03:26:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 03:26:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:35 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:36 - root - INFO - SQL:
SELECT * FROM "IPL"."IPL"."BALL_BY_BALL" LIMIT 100;
Results:
match_id,over_id,ball_id,innings_no,team_batting,team_bowling,striker_batting_position,striker,non_striker,bowler
335987,1,1,2,2,1,1,6,7,106
335987,1,2,1,1,2,2,2,1,14
335987,1,2,2,2,1,2,7,6,106
335987,1,3,1,1,2,2,2,1,14
335987,1,3,2,2,1,2,7,6,106
335987,1,4,1,1,2,2,2,1,14
335987,1,4,2,2,1,2,7,6,106
335987,1,5,1,1,2,2,2,1,14
335987,1,5,2,2,1,1,6,7,106
335987,1,6,1,1,2,2,2,1,14
335987,1,6,2,2,1,2,7,6,106
335987,1,7,1,1,2,2,2,1,14
335987,1,7,2,2,1,2,7,6,106
335987,2,1,1,1,2,2,2,1,15
335987,2,1,2,2,1,1,6,7,84
335987,2,2,1,1,2,2,2,1,15
335987,2,2,2,2,1,3,8,7,84
335987,2,3,1,1,2,2,2,1,15
335987,2,3,2,2,1,3,8,7,84
335987,2,4,1,1,2,2,2,1,15
335987,2,4,2,2,1,3,8,7,84
335987,2,5,1,1,2,2,2,1,15
335987,2,5,2,2,1,2,7,8,84
335987,2,6,1,1,2,2,2,1,15
335987,2,6,2,2,1,2,7,8,84
335987,3,1,1,1,2,1,1,2,14
335987,3,1,2,2,1,3,8,7,106
335987,3,2,1,1,2,1,1,2,14
335987,3,2,2,2,1,3,8,7,106
335987,3,3,1,1,2,1,1,2,14
335987,3,3,2,2,1,4,9,7,106
335987,3,4,1,1,2,2,2,1,14
335987,3,4,2,2,1,2,7,9,106
335987,3,5,1,1,2,2,2,1,14
335987,3,5,2,2,1,2,7,9,106
335987,3,6,1,1,2,1,1,2,14
335987,3,6,2,2,1,2,7,9,106
335987,3,7,2,2,1,2,7,9,106
335987,4,1,1,1,2,2,2,1,13
335987,4,1,2,2,1,2,7,9,84
335987,4,2,1,1,2,2,2,1,13
335987,4,2,2,2,1,2,7,9,84
335987,4,3,1,1,2,2,2,1,13
335987,4,3,2,2,1,4,9,7,84
335987,4,4,1,1,2,1,1,2,13
335987,4,4,2,2,1,4,9,7,84
335987,4,5,1,1,2,1,1,2,13
335987,4,5,2,2,1,2,7,9,84
335987,4,6,1,1,2,1,1,2,13
335987,4,6,2,2,1,2,7,9,84
335987,4,7,1,1,2,2,2,1,13
335987,5,1,1,1,2,1,1,2,14
335987,5,1,2,2,1,4,9,7,82
335987,5,2,1,1,2,1,1,2,14
335987,5,2,2,2,1,2,7,9,82
335987,5,3,1,1,2,2,2,1,14
335987,5,3,2,2,1,4,9,7,82
335987,5,4,1,1,2,2,2,1,14
335987,5,4,2,2,1,4,9,7,82
335987,5,5,1,1,2,2,2,1,14
335987,5,5,2,2,1,4,9,7,82
335987,5,6,1,1,2,1,1,2,14
335987,5,6,2,2,1,5,10,7,82
335987,6,1,1,1,2,2,2,1,15
335987,6,1,2,2,1,2,7,10,106
335987,6,2,1,1,2,1,1,2,15
335987,6,2,2,2,1,2,7,10,106
335987,6,3,1,1,2,3,3,2,15
335987,6,3,2,2,1,6,11,10,106
335987,6,4,1,1,2,3,3,2,15
335987,6,4,2,2,1,6,11,10,106
335987,6,5,1,1,2,3,3,2,15
335987,6,5,2,2,1,5,10,11,106
335987,6,6,1,1,2,3,3,2,15
335987,6,6,2,2,1,6,11,10,106
335987,7,1,1,1,2,2,2,3,13
335987,7,1,2,2,1,5,10,11,82
335987,7,2,1,1,2,3,3,2,13
335987,7,2,2,2,1,5,10,11,82
335987,7,3,1,1,2,2,2,3,13
335987,7,3,2,2,1,5,10,11,82
335987,7,4,1,1,2,3,3,2,13
335987,7,4,2,2,1,6,11,10,82
335987,7,5,1,1,2,3,3,2,13
335987,7,5,2,2,1,6,11,10,82
335987,7,6,1,1,2,2,2,3,13
335987,7,6,2,2,1,6,11,10,82
335987,7,7,2,2,1,6,11,10,82
335987,7,8,2,2,1,6,11,10,82
335987,8,1,1,1,2,2,2,3,15
335987,8,1,2,2,1,5,10,11,1
335987,8,2,1,1,2,2,2,3,15
335987,8,2,2,2,1,6,11,10,1
335987,8,3,1,1,2,3,3,2,15
335987,8,3,2,2,1,5,10,11,1
335987,8,4,1,1,2,2,2,3,15
335987,8,4,2,2,1,6,11,10,1
335987,8,5,1,1,2,3,3,2,15
335987,8,5,2,2,1,6,11,10,1
335987,8,6,1,1,2,2,2,3,15

2025-01-25 03:26:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:37 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:37 - root - INFO - SQL:
SELECT DISTINCT "match_id" FROM "IPL"."IPL"."BALL_BY_BALL" LIMIT 100;
Results:
match_id
335987
335988
335989
335990
335991
335992
335993
335994
335995
335996
335998
335999
336000
336002
336003
336001
336004
336006
336008
336010
336015
336017
336018
336020
336014
336024
336025
336028
336030
336036
336037
336038
336039
336026
336044
392186
392193
392194
392202
392206
392214
392215
392216
392221
392224
392227
392228
392233
392234
335997
336005
336007
336009
336012
336013
336016
336019
336023
336031
336032
336033
336034
336029
336040
336041
336042
336043
392188
392189
392190
392196
392197
392199
392200
336045
392201
392203
392204
392205
392208
392209
392210
392211
392218
392220
392223
392229
392230
392231
392232
336011
336021
336022
336027
392187
392207
392212
392213
392217
392219

2025-01-25 03:26:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:39 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:39 - root - INFO - SQL:
SELECT * FROM "IPL"."IPL"."BATSMAN_SCORED" LIMIT 100;
Results:
match_id,over_id,ball_id,runs_scored,innings_no
335987,1,1,1,2
335987,1,2,0,1
335987,1,3,0,2
335987,1,4,0,1
335987,1,4,1,2
335987,1,5,0,1
335987,1,5,1,2
335987,1,6,0,1
335987,1,6,0,2
335987,1,7,0,1
335987,1,7,0,2
335987,2,1,0,1
335987,2,1,0,2
335987,2,2,4,1
335987,2,2,0,2
335987,2,3,4,1
335987,2,3,0,2
335987,2,4,6,1
335987,2,4,1,2
335987,2,5,4,1
335987,2,5,0,2
335987,2,6,0,1
335987,2,6,0,2
335987,3,1,0,1
335987,3,1,0,2
335987,3,2,0,1
335987,3,2,0,2
335987,3,3,0,1
335987,3,3,1,2
335987,3,4,4,1
335987,3,4,0,2
335987,3,5,1,1
335987,3,6,0,1
335987,3,6,0,2
335987,3,7,1,2
335987,4,1,2,2
335987,4,2,6,1
335987,4,2,1,2
335987,4,3,0,1
335987,4,3,0,2
335987,4,4,4,1
335987,4,4,0,2
335987,4,5,0,1
335987,4,5,0,2
335987,4,6,1,1
335987,4,6,0,2
335987,4,7,6,1
335987,5,1,4,1
335987,5,1,1,2
335987,5,2,1,1
335987,5,2,1,2
335987,5,3,4,1
335987,5,3,0,2
335987,5,4,0,1
335987,5,4,6,2
335987,5,5,1,1
335987,5,5,0,2
335987,5,6,0,1
335987,5,6,0,2
335987,6,1,1,1
335987,6,1,0,2
335987,6,2,0,1
335987,6,2,0,2
335987,6,3,0,1
335987,6,3,0,2
335987,6,4,0,1
335987,6,4,1,2
335987,6,5,0,1
335987,6,5,1,2
335987,6,6,0,1
335987,6,6,0,2
335987,7,1,1,1
335987,7,1,0,2
335987,7,2,1,1
335987,7,2,0,2
335987,7,3,1,1
335987,7,3,1,2
335987,7,4,2,1
335987,7,5,1,1
335987,7,6,1,1
335987,7,6,0,2
335987,7,7,0,2
335987,7,8,4,2
335987,8,1,0,1
335987,8,1,1,2
335987,8,2,1,1
335987,8,2,0,2
335987,8,3,1,1
335987,8,3,1,2
335987,8,4,1,1
335987,8,4,2,2
335987,8,5,1,1
335987,8,5,0,2
335987,8,6,1,1
335987,8,6,0,2
335987,9,1,0,1
335987,9,1,0,2
335987,9,2,0,1
335987,9,2,0,2
335987,9,3,0,1

2025-01-25 03:26:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:40 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:41 - root - INFO - SQL:
SELECT 
     bb."match_id", 
     bb."innings_no", 
     bb."over_id", 
     bb."ball_id", 
     bb."striker", 
     bb."non_striker", 
     bs."runs_scored"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,striker,non_striker,runs_scored
335987,2,1,1,6,7,1
335987,1,1,2,2,1,0
335987,2,1,3,7,6,0
335987,1,1,4,2,1,0
335987,2,1,4,7,6,1
335987,1,1,5,2,1,0
335987,2,1,5,6,7,1
335987,1,1,6,2,1,0
335987,2,1,6,7,6,0
335987,1,1,7,2,1,0
335987,2,1,7,7,6,0
335987,1,2,1,2,1,0
335987,2,2,1,6,7,0
335987,1,2,2,2,1,4
335987,2,2,2,8,7,0
335987,1,2,3,2,1,4
335987,2,2,3,8,7,0
335987,1,2,4,2,1,6
335987,2,2,4,8,7,1
335987,1,2,5,2,1,4
335987,2,2,5,7,8,0
335987,1,2,6,2,1,0
335987,2,2,6,7,8,0
335987,1,3,1,1,2,0
335987,2,3,1,8,7,0
335987,1,3,2,1,2,0
335987,2,3,2,8,7,0
335987,1,3,3,1,2,0
335987,2,3,3,9,7,1
335987,1,3,4,2,1,4
335987,2,3,4,7,9,0
335987,1,3,5,2,1,1
335987,1,3,6,1,2,0
335987,2,3,6,7,9,0
335987,2,3,7,7,9,1
335987,2,4,1,7,9,2
335987,1,4,2,2,1,6
335987,2,4,2,7,9,1
335987,1,4,3,2,1,0
335987,2,4,3,9,7,0
335987,1,4,4,1,2,4
335987,2,4,4,9,7,0
335987,1,4,5,1,2,0
335987,2,4,5,7,9,0
335987,1,4,6,1,2,1
335987,2,4,6,7,9,0
335987,1,4,7,2,1,6
335987,1,5,1,1,2,4
335987,2,5,1,9,7,1
335987,1,5,2,1,2,1
335987,2,5,2,7,9,1
335987,1,5,3,2,1,4
335987,2,5,3,9,7,0
335987,1,5,4,2,1,0
335987,2,5,4,9,7,6
335987,1,5,5,2,1,1
335987,2,5,5,9,7,0
335987,1,5,6,1,2,0
335987,2,5,6,10,7,0
335987,1,6,1,2,1,1
335987,2,6,1,7,10,0
335987,1,6,2,1,2,0
335987,2,6,2,7,10,0
335987,1,6,3,3,2,0
335987,2,6,3,11,10,0
335987,1,6,4,3,2,0
335987,2,6,4,11,10,1
335987,1,6,5,3,2,0
335987,2,6,5,10,11,1
335987,1,6,6,3,2,0
335987,2,6,6,11,10,0
335987,1,7,1,2,3,1
335987,2,7,1,10,11,0
335987,1,7,2,3,2,1
335987,2,7,2,10,11,0
335987,1,7,3,2,3,1
335987,2,7,3,10,11,1
335987,1,7,4,3,2,2
335987,1,7,5,3,2,1
335987,1,7,6,2,3,1
335987,2,7,6,11,10,0
335987,2,7,7,11,10,0
335987,2,7,8,11,10,4
335987,1,8,1,2,3,0
335987,2,8,1,10,11,1
335987,1,8,2,2,3,1
335987,2,8,2,11,10,0
335987,1,8,3,3,2,1
335987,2,8,3,10,11,1
335987,1,8,4,2,3,1
335987,2,8,4,11,10,2
335987,1,8,5,3,2,1
335987,2,8,5,11,10,0
335987,1,8,6,2,3,1
335987,2,8,6,10,12,0
335987,1,9,1,2,3,0
335987,2,9,1,12,10,0
335987,1,9,2,2,3,0
335987,2,9,2,12,10,0
335987,1,9,3,2,3,0

2025-01-25 03:26:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:42 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:43 - root - INFO - SQL:
SELECT 
     bb."match_id", 
     bb."striker", 
     SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   GROUP BY bb."match_id", bb."striker"
   LIMIT 100;
Results:
match_id,striker,total_runs
335987,2,158
335987,9,8
335987,14,18
335988,19,116
335988,26,54
335988,21,32
335988,29,3
335989,30,7
335989,42,52
335989,32,17
335989,38,14
335990,43,8
335990,6,32
335990,9,25
335990,11,39
335990,49,28
335990,50,2
335991,60,0
335991,61,1
335992,33,5
335992,31,7
335992,26,20
335993,54,14
335998,5,16
336000,41,6
336002,5,2
335987,15,3
335988,23,31
335989,36,2
335991,62,10
335991,4,38
335991,5,13
335992,24,26
335992,32,76
335992,65,4
335994,46,43
335994,49,17
335994,73,1
335994,23,2
335996,48,2
335998,1,12
336000,87,39
336000,29,10
336000,66,1
336001,21,28
336002,46,37
336002,82,2
335990,48,20
335992,35,36
335994,19,5
335995,232,16
335996,46,21
335997,14,34
335999,44,18
335999,85,0
336000,27,40
336003,8,1
336007,9,31
336007,7,5
336011,76,31
336013,114,27
336012,70,20
336020,42,3
336029,61,3
335991,3,0
335996,49,22
335991,54,14
335991,2,5
335991,1,14
335992,25,16
335992,64,2
335992,66,0
335993,57,66
335994,21,53
335995,53,13
335996,64,12
335996,73,2
335997,51,2
335997,9,11
335997,32,61
335997,11,4
335997,15,17
335998,4,0
335998,83,3
336001,11,4
336001,6,0
336003,42,50
336004,76,15
335991,57,0
335991,58,6
335993,59,8
335993,60,12
335993,61,1
335994,18,81
335995,75,4
335996,26,94
335996,67,0
335996,78,4
335997,16,3
335998,18,70

2025-01-25 03:26:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:44 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:44 - root - INFO - SQL:
SELECT DISTINCT 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
     GREATEST(bb."striker", bb."non_striker") AS "batsman2_id"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   LIMIT 100;
Results:
match_id,batsman1_id,batsman2_id
335987,6,7
335987,1,2
335987,7,9
335987,7,10
335987,2,3
335987,10,11
335987,10,12
335987,10,13
335987,2,4
335987,2,5
335988,24,25
335987,7,8
335987,14,15
335987,14,16
335988,18,19
335988,25,26
335988,19,22
335988,26,28
335989,30,31
335989,40,41
335989,40,42
335989,31,32
335989,33,35
335989,35,36
335990,43,44
335990,6,51
335990,6,52
335990,46,47
335988,19,23
335989,37,38
335990,44,46
335990,8,9
335990,9,11
335990,48,49
335991,3,62
335991,1,62
335991,53,55
335991,1,4
335991,56,57
335991,56,232
335991,4,5
335991,59,60
335991,59,61
335992,24,25
335992,25,26
335992,32,34
335993,57,70
335991,56,58
335991,61,131
335994,17,18
335994,48,50
335995,31,74
335995,55,56
335995,32,74
335995,35,74
335996,46,71
335996,26,65
335997,32,74
335997,8,52
335998,1,2
335998,1,62
336001,19,22
335987,13,14
335988,17,18
335988,19,21
335988,26,27
335988,28,29
335989,32,33
335989,35,37
335989,37,39
335990,44,45
335990,9,52
335990,46,48
335990,11,12
335991,53,54
335991,2,62
335991,56,59
335991,4,63
335992,25,64
335992,25,27
335992,27,29
335992,32,35
335992,29,65
335992,67,68
335993,53,54
335993,40,41
335993,54,55
335993,56,57
335993,60,232
335994,43,44
335994,44,46
335994,46,49
335994,49,71
335992,32,69
335992,65,66
335993,41,42
335993,54,56
335993,57,232
335993,60,61
335994,18,19

2025-01-25 03:26:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:46 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:46 - root - INFO - SQL:
SELECT 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
     GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
     SUM(bs."runs_scored") AS "partnership_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   GROUP BY 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker"), 
     GREATEST(bb."striker", bb."non_striker")
   LIMIT 100;
Results:
match_id,batsman1_id,batsman2_id,partnership_runs
335987,6,7,3
335987,7,10,0
335987,14,15,11
335987,2,5,50
335988,17,18,24
335988,24,25,55
335987,10,13,3
335987,14,16,9
335988,18,19,30
335988,25,26,52
335988,19,21,65
335988,26,27,38
335989,40,42,102
335989,33,34,5
335989,33,35,8
335989,35,37,20
335990,44,46,25
335990,9,52,8
335991,2,62,6
335991,56,57,0
335991,59,60,1
335992,65,66,0
335992,67,68,16
335995,55,70,10
335996,49,50,0
335996,66,77,1
335989,31,32,6
335989,37,38,17
335990,8,9,29
335991,53,56,24
335992,24,25,34
335992,65,67,13
335994,20,22,11
335995,31,74,97
335997,9,52,43
335997,32,74,101
335997,11,14,1
335999,53,55,146
335999,71,72,29
336003,7,14,6
336001,19,22,0
336004,53,55,27
335992,25,26,22
335994,48,73,12
335996,46,79,4
335997,51,52,13
335998,63,82,20
335999,44,85,3
336000,86,87,7
336001,17,19,19
336001,11,52,4
336003,40,41,50
336001,8,14,6
336005,1,82,27
336005,33,101,37
336005,1,104,6
336006,42,110,32
336008,4,63,20
336013,36,39,1
336018,25,100,16
336019,54,61,17
336022,103,128,31
336020,135,136,6
336029,47,114,13
335993,40,41,31
335993,54,55,14
335993,57,70,15
335997,14,16,12
335999,44,49,28
335987,10,11,11
335987,2,3,47
335990,46,47,49
335991,3,62,6
335991,53,55,1
335991,1,4,27
335991,59,61,5
335991,61,131,0
335992,25,27,7
335992,29,65,0
335993,57,59,21
335994,18,21,94
335995,35,74,0
335996,24,29,8
335996,26,66,3
335997,36,74,1
335997,8,52,4
336002,1,2,5
336002,46,71,101
336003,40,42,98
336003,9,11,26
336004,54,57,2
335990,44,45,6
335992,32,69,25
335993,41,42,100
335995,53,55,22
335996,66,67,8
335998,1,4,2
335998,18,20,79
335999,43,44,13
335999,48,49,22

2025-01-25 03:26:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:48 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:48 - root - INFO - SQL:
SELECT * FROM "IPL"."IPL"."WICKET_TAKEN" LIMIT 100;
Results:
match_id,over_id,ball_id,player_out,kind_out,innings_no
419167,10,3,154,caught,1
419167,10,3,46,caught,2
419167,12,4,8,caught,2
419167,14,4,96,caught,2
419167,18,4,208,caught,1
419168,2,7,18,caught,1
419168,5,5,21,caught,1
419168,6,1,53,caught,2
419168,6,5,178,caught,2
419168,8,2,57,caught,2
419168,14,2,20,caught,1
419168,15,5,109,caught,1
419168,16,2,56,caught,2
419168,18,4,188,caught,2
419168,20,2,131,caught,2
419168,20,4,125,caught,1
419169,1,4,53,caught,1
419169,4,2,57,caught,1
419169,7,1,56,caught,1
419169,17,3,54,caught,1
419169,19,3,131,caught,1
419170,2,4,42,caught,2
419170,8,2,185,caught,1
419170,9,4,18,caught,1
419170,12,2,23,caught,1
419170,15,2,133,caught,2
419170,15,5,79,caught,2
419170,17,6,154,caught,2
419170,18,1,20,caught,1
419170,19,6,221,caught,2
501203,1,6,185,caught,1
501203,11,3,21,caught,1
501203,16,2,9,caught,2
501203,18,2,20,caught,1
501203,20,2,63,caught,2
501204,5,5,42,caught,1
501204,6,3,26,caught,1
501204,6,5,252,caught,2
501204,11,1,257,caught,1
501204,13,6,154,caught,1
501204,18,3,258,caught,1
501204,20,1,112,caught,1
501204,20,3,94,caught,1
501205,2,2,135,caught,2
501205,9,6,55,caught,1
501205,10,6,260,caught,2
501205,12,3,2,caught,1
501205,18,4,79,caught,2
501205,19,4,259,caught,1
501206,7,6,254,caught,1
501206,15,2,183,caught,1
501206,18,4,106,caught,1
501207,1,1,74,caught,2
501207,1,4,53,caught,1
501207,2,3,100,caught,1
501207,3,4,167,caught,1
501207,4,3,88,caught,1
501207,8,5,171,caught,2
501207,9,3,48,caught,1
501207,9,3,157,caught,2
501207,18,1,67,caught,1
501207,20,1,14,caught,1
501208,9,6,26,caught,2
501208,13,2,154,caught,2
501208,13,3,9,caught,1
501208,14,6,93,caught,2
501208,17,4,258,caught,2
501208,18,1,112,caught,2
501208,20,6,31,caught,1
501209,1,3,41,caught,1
501209,5,5,254,caught,1
501209,8,1,262,caught,1
501209,8,3,183,caught,1
501209,8,3,6,caught,2
501209,11,5,266,caught,2
501209,18,4,187,caught,1
501209,19,7,54,caught,1
501210,5,4,8,caught,1
501211,1,2,21,caught,1
501211,6,5,53,caught,2
501211,14,6,264,caught,2
501212,1,1,2,caught,1
501212,3,5,64,caught,1
501212,5,5,17,caught,1
501212,8,4,74,caught,2
501212,10,5,171,caught,2
501212,12,2,27,caught,2
501212,16,2,104,caught,1
501212,17,1,35,caught,1
501213,2,6,135,caught,2
501213,3,5,42,caught,1
501213,5,6,260,caught,2
501213,7,4,110,caught,2
501213,9,6,65,caught,1
501213,12,1,79,caught,2
501213,15,4,26,caught,1
501213,17,5,203,caught,2
501213,17,6,268,caught,2
501213,20,1,269,caught,2
501213,20,2,154,caught,1

2025-01-25 03:26:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:49 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:50 - root - INFO - SQL:
SELECT 
     "match_id", 
     "innings_no", 
     "over_id", 
     "ball_id", 
     "player_out", 
     "kind_out"
   FROM "IPL"."IPL"."WICKET_TAKEN"
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,player_out,kind_out
419167,1,10,3,154,caught
419167,2,10,3,46,caught
419167,2,12,4,8,caught
419167,2,14,4,96,caught
419167,1,18,4,208,caught
419168,1,2,7,18,caught
419168,1,5,5,21,caught
419168,2,6,1,53,caught
419168,2,6,5,178,caught
419168,2,8,2,57,caught
419168,1,14,2,20,caught
419168,1,15,5,109,caught
419168,2,16,2,56,caught
419168,2,18,4,188,caught
419168,2,20,2,131,caught
419168,1,20,4,125,caught
419169,1,1,4,53,caught
419169,1,4,2,57,caught
419169,1,7,1,56,caught
419169,1,17,3,54,caught
419169,1,19,3,131,caught
419170,2,2,4,42,caught
419170,1,8,2,185,caught
419170,1,9,4,18,caught
419170,1,12,2,23,caught
419170,2,15,2,133,caught
419170,2,15,5,79,caught
419170,2,17,6,154,caught
419170,1,18,1,20,caught
419170,2,19,6,221,caught
501203,1,1,6,185,caught
501203,1,11,3,21,caught
501203,2,16,2,9,caught
501203,1,18,2,20,caught
501203,2,20,2,63,caught
501204,1,5,5,42,caught
501204,1,6,3,26,caught
501204,2,6,5,252,caught
501204,1,11,1,257,caught
501204,1,13,6,154,caught
501204,1,18,3,258,caught
501204,1,20,1,112,caught
501204,1,20,3,94,caught
501205,2,2,2,135,caught
501205,1,9,6,55,caught
501205,2,10,6,260,caught
501205,1,12,3,2,caught
501205,2,18,4,79,caught
501205,1,19,4,259,caught
501206,1,7,6,254,caught
501206,1,15,2,183,caught
501206,1,18,4,106,caught
501207,2,1,1,74,caught
501207,1,1,4,53,caught
501207,1,2,3,100,caught
501207,1,3,4,167,caught
501207,1,4,3,88,caught
501207,2,8,5,171,caught
501207,1,9,3,48,caught
501207,2,9,3,157,caught
501207,1,18,1,67,caught
501207,1,20,1,14,caught
501208,2,9,6,26,caught
501208,2,13,2,154,caught
501208,1,13,3,9,caught
501208,2,14,6,93,caught
501208,2,17,4,258,caught
501208,2,18,1,112,caught
501208,1,20,6,31,caught
501209,1,1,3,41,caught
501209,1,5,5,254,caught
501209,1,8,1,262,caught
501209,1,8,3,183,caught
501209,2,8,3,6,caught
501209,2,11,5,266,caught
501209,1,18,4,187,caught
501209,1,19,7,54,caught
501210,1,5,4,8,caught
501211,1,1,2,21,caught
501211,2,6,5,53,caught
501211,2,14,6,264,caught
501212,1,1,1,2,caught
501212,1,3,5,64,caught
501212,1,5,5,17,caught
501212,2,8,4,74,caught
501212,2,10,5,171,caught
501212,2,12,2,27,caught
501212,1,16,2,104,caught
501212,1,17,1,35,caught
501213,2,2,6,135,caught
501213,1,3,5,42,caught
501213,2,5,6,260,caught
501213,2,7,4,110,caught
501213,1,9,6,65,caught
501213,2,12,1,79,caught
501213,1,15,4,26,caught
501213,2,17,5,203,caught
501213,2,17,6,268,caught
501213,2,20,1,269,caught
501213,1,20,2,154,caught

2025-01-25 03:26:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:51 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:52 - root - INFO - SQL:
SELECT 
      bb."match_id", 
      bb."striker", 
      p."player_name", 
      SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id" 
      AND bb."innings_no" = bs."innings_no" 
      AND bb."over_id" = bs."over_id" 
      AND bb."ball_id" = bs."ball_id"
    JOIN "IPL"."IPL"."PLAYER" p
      ON bb."striker" = p."player_id"
    GROUP BY bb."match_id", bb."striker", p."player_name"
    LIMIT 100;
Results:
match_id,striker,player_name,total_runs
335987,6,R Dravid,2
335987,2,BB McCullum,158
335987,7,W Jaffer,6
335987,8,V Kohli,1
335987,4,DJ Hussey,12
335988,26,KC Sangakkara,54
335990,52,LRPL Taylor,23
335991,58,SB Styris,6
335997,15,Z Khan,17
336005,33,M Kaif,21
335991,62,WP Saha,10
336007,61,RP Singh,1
335988,25,JR Hopes,71
335989,33,M Kaif,9
335990,11,MV Boucher,39
335998,84,I Sharma,4
335989,37,D Salunkhe,26
335990,50,Harbhajan Singh,2
335991,232,UT Yadav,10
335992,66,B Lee,0
335992,67,PP Chawla,24
335995,75,Pankaj Singh,4
336003,40,G Gambhir,86
335988,27,Yuvraj Singh,23
335996,77,S Sreesanth,0
335998,62,WP Saha,27
335999,49,SM Pollock,31
336000,42,S Dhawan,0
336002,3,RT Ponting,19
336001,17,PA Patel,21
336005,106,AB Dinda,1
336009,40,G Gambhir,1
336013,32,SR Watson,32
336015,4,DJ Hussey,26
336020,135,TM Dilshan,18
336029,47,PR Shah,10
336040,29,IK Pathan,7
335993,41,V Sehwag,94
335994,71,DJ Bravo,24
335999,43,L Ronchi,13
335991,5,Mohammad Hafeez,13
335994,50,Harbhajan Singh,28
335995,53,AC Gilchrist,13
335995,33,M Kaif,34
336002,82,AB Agarkar,2
336002,83,M Kartik,10
336003,52,LRPL Taylor,29
336003,8,V Kohli,1
335994,18,ML Hayden,81
336011,100,SE Marsh,39
336012,119,Joginder Sharma,16
336014,109,JA Morkel,30
336016,112,DB Ravi Teja,6
336021,113,Misbah-ul-Haq,21
336021,10,CL White,10
336024,100,SE Marsh,115
336026,128,A Chopra,1
336040,92,TM Srivastava,1
336033,49,SM Pollock,0
336044,25,JR Hopes,2
392186,156,T Thushara,1
392190,14,P Kumar,0
392217,147,DR Smith,16
392189,163,MC Henriques,6
335992,27,Yuvraj Singh,57
335993,55,VVS Laxman,2
335990,6,R Dravid,32
335999,44,ST Jayasuriya,18
335995,32,SR Watson,4
335996,24,K Goel,18
335991,63,LR Shukla,4
335995,38,SK Warne,22
335992,69,Kamran Akmal,15
335999,71,DJ Bravo,34
336000,88,KD Karthik,24
336014,40,G Gambhir,80
336030,103,Salman Butt,73
335989,32,SR Watson,17
335994,23,S Badrinath,2
335999,85,AM Rahane,0
336002,1,SC Ganguly,4
335997,6,R Dravid,0
335996,44,ST Jayasuriya,1
335998,1,SC Ganguly,12
336001,11,MV Boucher,4
336003,88,KD Karthik,2
335998,5,Mohammad Hafeez,16
336004,99,D Kalyankrishna,3
336005,101,SA Asnodkar,60
336002,2,BB McCullum,1
336005,36,M Rawat,1
336007,53,AC Gilchrist,46
336007,7,W Jaffer,5
336007,60,WPUJC Vaas,0
336008,5,Mohammad Hafeez,13
336008,27,Yuvraj Singh,17
336009,71,DJ Bravo,2
336009,49,SM Pollock,33
336009,79,SS Tiwary,9
336009,115,RR Raje,6

2025-01-25 03:26:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:53 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:53 - root - INFO - SQL:
SELECT "player_id", "player_name" FROM "IPL"."IPL"."PLAYER" LIMIT 100;
Results:
player_id,player_name
1,SC Ganguly
2,BB McCullum
3,RT Ponting
4,DJ Hussey
5,Mohammad Hafeez
6,R Dravid
7,W Jaffer
8,V Kohli
9,JH Kallis
10,CL White
11,MV Boucher
12,B Akhil
13,AA Noffke
14,P Kumar
15,Z Khan
16,SB Joshi
17,PA Patel
18,ML Hayden
19,MEK Hussey
20,MS Dhoni
21,SK Raina
22,JDP Oram
23,S Badrinath
24,K Goel
25,JR Hopes
26,KC Sangakkara
27,Yuvraj Singh
28,SM Katich
29,IK Pathan
30,T Kohli
31,YK Pathan
32,SR Watson
33,M Kaif
34,DS Lehmann
36,M Rawat
37,D Salunkhe
38,SK Warne
39,SK Trivedi
40,G Gambhir
41,V Sehwag
42,S Dhawan
43,L Ronchi
44,ST Jayasuriya
45,DJ Thornely
46,RV Uthappa
47,PR Shah
48,AM Nayar
49,SM Pollock
50,Harbhajan Singh
51,S Chanderpaul
52,LRPL Taylor
53,AC Gilchrist
54,Y Venugopal Rao
55,VVS Laxman
56,A Symonds
57,RG Sharma
58,SB Styris
59,SB Bangar
60,WPUJC Vaas
61,RP Singh
62,WP Saha
63,LR Shukla
64,DPMD Jayawardene
65,S Sohal
66,B Lee
67,PP Chawla
68,WA Mota
69,Kamran Akmal
70,Shahid Afridi
71,DJ Bravo
72,MA Khote
73,A Nehra
74,GC Smith
75,Pankaj Singh
76,RR Sarwan
77,S Sreesanth
78,VRV Singh
79,SS Tiwary
80,DS Kulkarni
81,R Vinay Kumar
82,AB Agarkar
83,M Kartik
84,I Sharma
85,AM Rahane
86,Shoaib Malik
87,MK Tiwary
88,KD Karthik
89,R Bhatia
90,MF Maharoof
91,VY Mahesh
92,TM Srivastava
93,B Chipli
94,DW Steyn
95,DB Das
96,MK Pandey
97,HH Gibbs
98,DNT Zoysa
99,D Kalyankrishna
100,SE Marsh
101,SA Asnodkar

2025-01-25 03:26:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:55 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:55 - root - INFO - SQL:
SELECT * FROM "IPL"."IPL"."MATCH" LIMIT 100;
Results:
Too long, hard cut:
match_id,team_1,team_2,match_date,season_id,venue,toss_winner,toss_decision,win_type,win_margin,outcome_type,match_winner,man_of_the_match
335987,2,1,2008-04-18,1,M Chinnaswamy Stadium,2,field,runs,140,Result,1,2
335988,4,3,2008-04-19,1,Punjab Cricket Association Stadium Mohali,3,bat,runs,33,Result,3,19
335989,6,5,2008-04-19,1,Feroz Shah Kotla,5,bat,wickets,9,Result,6,90
335990,7,2,2008-04-20,1,Wankhede Stadium,7,bat,wickets,5,Result,2,11
335991,1,8,2008-04-20,1,Eden Gardens,8,bat,wickets,5,Result,1,4
335992,5,4,2008-04-21,1,Sawai Mansingh Stadium,4,bat,wickets,6,Result,5,32
335993,8,6,2008-04-22,1,Rajiv Gandhi International Stadium Uppal,8,bat,wickets,9,Result,6,41
335994,3,7,2008-04-23,1,MA Chidambaram Stadium Chepauk,7,field,runs,6,Result,3,18
335995,8,5,2008-04-24,1,Rajiv Gandhi International Stadium Uppal,5,field,wickets,3,Result,5,31
335996,4,7,2008-04-25,1,Punjab Cricket Association Stadium Mohali,7,field,runs,66,Result,4,26
335997,2,5,2008-04-26,1,M Chinnaswamy Stadium,5,field,wickets,7,Result,5,32
335998,3,1,2008-04-26,1,MA Chidambaram Stadium Chepauk,1,bat,wickets,9,Result,3,22
335999,7,8,2008-04-27,1,Dr DY Patil Sports Academy,8,field,wickets,10,Result,8,53
336000,4,6,2008-04-27,1,Punjab Cricket Association Stadium Mohali,6,bat,wickets,4,Result,4,28
336001,2,3,2008-04-28,1,M Chinnaswamy Stadium,3,bat,runs,13,Result,3,20
336002,1,7,2008-04-29,1,Eden Gardens,1,bat,wickets,7,Result,7,44
336003,6,2,2008-04-30,1,Feroz Shah Kotla,2,field,runs,10,Result,6,118
336004,8,4,2008-05-01,1,Rajiv Gandhi International Stadium Uppal,4,field,wickets,7,Result,4,100
336005,5,1,2008-05-01,1,Sawai Mansingh Stadium,5,bat,runs,45,Result,5,101
336006,3,6,2008-05-02,1,MA Chidambaram Stadium Chepauk,3,bat,wickets,8,Result,6,41
336007,8,2,2008-05-25,1,Rajiv Gandhi International Stadium Uppal,8,bat,wickets,5,Result,2,81
336008,4,1,2008-05-03,1,Punjab Cricket Association Stadium Mohali,4,bat,runs,9,Result,4,29
336009,7,6,2008-05-04,1,Dr DY Patil Sports Academy,6,field,runs,29,Result,7,49
336010,5,3,2008-05-04,1,Sawai Mansingh Stadium,3,bat,wickets,8,Result,5,102
336011,2,4,2008-05-05,1,M Chinnaswamy Stadium,4,field,wickets,6,Result,4,77
336012,3,8,2008-05-06,1,MA Chidambaram Stadium Chepauk,8,field,wickets,7,Result,8,53
336013,7,5,2008-05-07,1,Dr DY Patil Sports Academy,7,field,wickets,7,Result,7,73
336014,6,3,2008-05-08,1,Feroz Shah Kotla,3,field,wickets,4,Result,3,20
336015,1,2,2008-05-08,1,Eden Gardens,1,bat,runs,5,Result,1,1
336016,5,8,2008-05-09,1,Sawai Mansingh Stadium,5,field,wickets,8,Result,5,31
336017,2,7,2008-05-28,1,M Chinnaswamy Stadium,7,field,wickets,9,Result,7,149
336018,3,4,2008-05-10,1,MA Chidambaram Stadium Chepauk,4,field,runs,18,Result,3,151
336019,8,1,2008-05-11,1,Rajiv Gandhi International Stadium Uppal,1,bat,runs,23,Result,1,1
336020,5,6,2008-05-11,1,Sawai Mansingh Stadium,5,field,wickets,3,Result,5,32
336021,4,2,2008-05-12,1,Punjab Cricket Association Stadium Mohali,2,bat,wickets,9,Result,4,100
336022,1,6,2008-05-13,1,Eden Gardens,1,bat,runs,23,Result,1,144
336023,7,3,2008-05-14,1,Wankhede Stadium,7,field,wickets,9,Result,7,44
336024,4,5,2008-05-28,1,Punjab Cricket Association Stadium Mohali,5,field,runs,41,Result,4,100
336025,6,8,2008-05-15,1,Feroz Shah Kotla,8,field,runs,12,Result,6,136
336026,7,1,2008-05-16,1,Wankhede Stadium,7,field,wickets,8,Result,7,49
336027,6,4,2008-05-17,1,Feroz Shah Kotla,6,bat,runs,6,Result,4,64
336028,5,2,2008-05-17,1,Sawai Mansingh Stadium,2,field,runs,65,Result,5,74
336029,8,7,2008-05-18,1,Rajiv Gandhi International Stadium Uppal,8,field,runs,25,Result,7,71
336030,1,3,2008-05-18,1,Eden Gardens,1,bat,runs,3,Result,3,122
336031,2,6,2008-05-19,1,M Chinnaswamy Stadium,6,field,wickets,5,Result,6,132
336032,1,5,2008-05-20,1,Eden Gardens,5,field,wickets,6,Result,5,31
336033,7,4,2008-05-21,1,Wankhede Stadium,7,field,runs,1,Result,4,100
336034,3,2,2008-05-21,1,MA Chidambaram Stadium Chepauk,2,bat,runs,14,Result,2,124
336036,4,8,2008-05-23,1,Punjab Cricket Association Stadium Mohali,4,field,wickets,6,Result,4,100
336037,6,7,2008-05-24,1,Feroz Shah Kotla,6,field,wickets,5,Result,6,88
336038,3,5,2008-05-24,1,MA Chidambaram Stadium Chepauk,5,bat,runs,10,Result,5,109
336039,2,8,2008-05-03,1,M Chinnaswamy Stadium,8,field,runs,3,Result,2,14
336040,1,4,2008-05-25,1,Eden Gardens,4,bat,wickets,3,Result,1,105
336041,5,7,2008-05-26,1,Sawai Mansingh Stadium,5,field,wickets,5,Result,5,102
336042,8,3,2008-05-27,1,Rajiv Gandhi International Stadium Uppal,8,bat,wickets,7,Result,3,21
336043,6,5,2008-05-30,1,Wankhede Stadium,6,field,runs,105,Result,5,32
336044,3,4,2008-05-31,1,Wankhede Stadium,4,bat,wickets,9,Result,3,122
336045,3,5,2008-06-01,1,Dr DY Patil Sports Academy,5,field,wickets,3,Result,5,31
392186,3,7,2009-04-18,2,Newlands,3,field,runs,19,Result,7,133
392187,2,5,2009-04-18,2,Newlands,2,bat,runs,75,Result,2,6
392188,6,4,2009-04-19,2,Newlands,6,field,wickets,10,Result,6,175
392189,8,1,2009-04-19,2,Newlands,1,bat,wickets,8,Result,8,61
392190,2,3,2009-04-20,2,St George's Park,3,bat,runs,92,R

2025-01-25 03:26:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:57 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:57 - root - INFO - SQL:
SELECT 
      "match_id", 
      MAX("partnership_runs") AS "max_runs"
    FROM (
      SELECT 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
        GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
        SUM(bs."runs_scored") AS "partnership_runs"
      FROM "IPL"."IPL"."BALL_BY_BALL" bb
      JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id" 
        AND bb."innings_no" = bs."innings_no" 
        AND bb."over_id" = bs."over_id" 
        AND bb."ball_id" = bs."ball_id"
      GROUP BY 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker"), 
        GREATEST(bb."striker", bb."non_striker")
    ) AS partnerships
    GROUP BY "match_id"
    LIMIT 100;
Results:
match_id,max_runs
335988,73
335996,70
335997,101
335999,146
336000,55
336005,65
336013,47
336020,62
335993,100
336009,46
336011,52
336015,44
336021,95
336023,89
336024,131
336030,80
336037,65
336041,65
392194,74
392207,67
392224,52
392226,65
392233,66
336042,69
419134,53
419157,50
419162,60
548365,91
336003,98
336006,110
336027,69
336043,64
392190,95
392193,58
392221,90
336038,120
336044,99
392201,65
392218,41
392220,59
392223,103
392237,70
419111,123
419112,106
419117,120
419135,51
419142,147
419167,63
501227,122
501259,110
548324,50
598054,97
598056,127
392214,69
419140,73
419153,62
501243,51
501262,97
501266,36
548341,106
548348,64
598034,51
729312,27
734040,71
392204,63
392217,51
392232,67
336033,128
392227,78
392243,69
336026,40
392196,65
392203,79
392213,121
392225,37
392234,52
392235,85
419118,108
419133,65
419136,127
419137,42
419138,62
419144,96
419145,55
419150,89
419158,127
419164,97
419166,88
501208,49
501213,60
501226,84
548338,82
548363,56
548378,59
548379,76
729290,75
729310,32
734042,50
336025,127
392228,59

2025-01-25 03:26:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:26:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:26:58 - snowflake.connector.connection - INFO - closed
2025-01-25 03:26:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:26:59 - root - INFO - SQL:
SELECT 
      p."match_id", 
      p."batsman1_id", 
      p."batsman2_id", 
      p."partnership_runs"
    FROM (
      SELECT 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
        GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
        SUM(bs."runs_scored") AS "partnership_runs"
      FROM "IPL"."IPL"."BALL_BY_BALL" bb
      JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id" 
        AND bb."innings_no" = bs."innings_no" 
        AND bb."over_id" = bs."over_id" 
        AND bb."ball_id" = bs."ball_id"
      GROUP BY 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker"), 
        GREATEST(bb."striker", bb."non_striker")
    ) AS p
    JOIN (
      SELECT 
        "match_id", 
        MAX("partnership_runs") AS "max_runs"
      FROM (
        SELECT 
          bb."match_id", 
          LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
          GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
          SUM(bs."runs_scored") AS "partnership_runs"
        FROM "IPL"."IPL"."BALL_BY_BALL" bb
        JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
          ON bb."match_id" = bs."match_id" 
          AND bb."innings_no" = bs."innings_no" 
          AND bb."over_id" = bs."over_id" 
          AND bb."ball_id" = bs."ball_id"
        GROUP BY 
          bb."match_id", 
          LEAST(bb."striker", bb."non_striker"), 
          GREATEST(bb."striker", bb."non_striker")
      ) AS partnerships
      GROUP BY "match_id"
    ) AS max_p
      ON p."match_id" = max_p."match_id" 
      AND p."partnership_runs" = max_p."max_runs"
    LIMIT 100;
Results:
match_id,batsman1_id,batsman2_id,partnership_runs
335988,19,23,73
335993,41,42,100
335996,24,26,70
335997,32,74,101
336000,28,64,55
335999,53,55,146
336003,40,42,98
336009,45,46,46
336011,6,8,52
336005,1,4,65
336015,10,11,44
336021,100,139,95
336023,20,23,89
336025,40,42,127
336030,95,103,80
336038,74,101,120
392186,48,133,45
392199,52,158,57
336043,74,101,64
392194,87,110,74
392196,27,161,65
392203,31,74,79
392217,47,154,51
392234,26,68,52
392237,6,9,70
419158,21,185,127
419167,79,208,63
548312,41,254,46
336006,40,41,110
336013,32,101,47
336026,44,46,40
336041,44,133,65
336033,100,139,128
392188,24,161,60
392211,88,187,73
392204,9,132,63
392207,21,23,67
392207,20,21,67
392213,9,46,121
392232,18,20,67
392239,17,197,40
419132,1,87,71
419138,8,9,62
419139,40,88,76
419142,109,185,147
419150,56,178,89
501209,54,187,81
501227,135,162,122
501235,40,87,37
548362,2,40,67
598075,19,21,140
392233,53,97,66
419117,161,214,120
419122,56,97,55
501259,88,100,110
548318,46,307,75
548322,208,221,93
548330,50,318,33
548334,183,187,173
598060,27,96,58
829726,221,372,102
829772,260,393,99
829794,17,383,83
733986,21,147,83
981004,8,162,142
392190,17,18,95
392222,18,23,81
392225,60,147,37
419111,191,204,123
419113,40,171,61
392243,6,96,69
336020,32,74,62
336024,25,100,131
336027,40,41,69
336044,17,21,99
392193,53,57,58
336042,54,112,69
392210,57,178,56
392218,31,183,41
392221,54,56,90
392224,88,110,52
392228,56,112,59
392235,110,135,85
419118,20,23,108
419128,11,46,52
419133,9,96,65
419146,32,229,71
419149,40,41,93
419162,208,210,60
419166,1,2,88
501206,57,133,62
501213,8,203,60
501216,19,185,50
501223,133,208,67
501225,88,100,66
501243,2,288,51
501243,17,104,51
548324,53,100,50
548373,2,40,98
548379,187,262,76

2025-01-25 03:26:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:26:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:26:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:27:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 03:27:00 - snowflake.connector.connection - INFO - closed
2025-01-25 03:27:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:27:01 - root - INFO - SQL:
SELECT 
      bb."match_id", 
      bb."striker" AS "batsman_id", 
      SUM(bs."runs_scored") AS "runs_scored"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id" 
      AND bb."innings_no" = bs."innings_no" 
      AND bb."over_id" = bs."over_id" 
      AND bb."ball_id" = bs."ball_id"
    GROUP BY bb."match_id", bb."striker"
    LIMIT 100;
Results:
match_id,batsman_id,runs_scored
335987,2,158
335987,9,8
335987,14,18
335988,19,116
335988,26,54
335988,21,32
335988,29,3
335989,30,7
335989,42,52
335989,32,17
335989,38,14
335990,43,8
335990,6,32
335990,9,25
335990,11,39
335990,49,28
335990,50,2
335991,60,0
335991,61,1
335992,33,5
335992,31,7
335992,26,20
335993,54,14
335998,5,16
336000,41,6
336002,5,2
335987,15,3
335988,23,31
335989,36,2
335991,62,10
335991,4,38
335991,5,13
335992,24,26
335992,32,76
335992,65,4
335994,46,43
335994,49,17
335994,73,1
335994,23,2
335996,48,2
335998,1,12
336000,87,39
336000,29,10
336000,66,1
336001,21,28
336002,46,37
336002,82,2
335990,48,20
335992,35,36
335994,19,5
335995,232,16
335996,46,21
335997,14,34
335999,44,18
335999,85,0
336000,27,40
336003,8,1
336007,9,31
336007,7,5
336011,76,31
336013,114,27
336012,70,20
336020,42,3
336029,61,3
335991,3,0
335996,49,22
335991,54,14
335991,2,5
335991,1,14
335992,25,16
335992,64,2
335992,66,0
335993,57,66
335994,21,53
335995,53,13
335996,64,12
335996,73,2
335997,51,2
335997,9,11
335997,32,61
335997,11,4
335997,15,17
335998,4,0
335998,83,3
336001,11,4
336001,6,0
336003,42,50
336004,76,15
335991,57,0
335991,58,6
335993,59,8
335993,60,12
335993,61,1
335994,18,81
335995,75,4
335996,26,94
335996,67,0
335996,78,4
335997,16,3
335998,18,70

2025-01-25 03:27:01 - root - INFO - itercount: 0
2025-01-25 03:27:01 - root - INFO - Database Name: IPL
Schema Name: IPL
DDL describes table information.
,0
table_name,PLAYER_MATCH
description,
DDL,"create or replace TABLE PLAYER_MATCH (
	""match_id"" NUMBER(38,0),
	""player_id"" NUMBER(38,0),
	""role"" VARCHAR(16777216),
	""team_id"" NUMBER(38,0)
);"

,1
table_name,PLAYER
description,
DDL,"create or replace TABLE PLAYER (
	""player_id"" NUMBER(38,0),
	""player_name"" VARCHAR(16777216),
	""dob"" VARCHAR(16777216),
	""batting_hand"" VARCHAR(16777216),
	""bowling_skill"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216)
);"

,2
table_name,BATSMAN_SCORED
description,
DDL,"create or replace TABLE BATSMAN_SCORED (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""runs_scored"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

,3
table_name,WICKET_TAKEN
description,
DDL,"create or replace TABLE WICKET_TAKEN (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""player_out"" NUMBER(38,0),
	""kind_out"" VARCHAR(16777216),
	""innings_no"" NUMBER(38,0)
);"

,4
table_name,BALL_BY_BALL
description,
DDL,"create or replace TABLE BALL_BY_BALL (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0),
	""team_batting"" NUMBER(38,0),
	""team_bowling"" NUMBER(38,0),
	""striker_batting_position"" NUMBER(38,0),
	""striker"" NUMBER(38,0),
	""non_striker"" NUMBER(38,0),
	""bowler"" NUMBER(38,0)
);"

,5
table_name,EXTRA_RUNS
description,
DDL,"create or replace TABLE EXTRA_RUNS (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""extra_type"" VARCHAR(16777216),
	""extra_runs"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

,6
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""match_id"" NUMBER(38,0),
	""team_1"" NUMBER(38,0),
	""team_2"" NUMBER(38,0),
	""match_date"" VARCHAR(16777216),
	""season_id"" NUMBER(38,0),
	""venue"" VARCHAR(16777216),
	""toss_winner"" NUMBER(38,0),
	""toss_decision"" VARCHAR(16777216),
	""win_type"" VARCHAR(16777216),
	""win_margin"" NUMBER(38,0),
	""outcome_type"" VARCHAR(16777216),
	""match_winner"" NUMBER(38,0),
	""man_of_the_match"" NUMBER(38,0)
);"

,7
table_name,TEAM
description,
DDL,"create or replace TABLE TEAM (
	""team_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IPL': {'IPL': ['BALL_BY_BALL', 'BATSMAN_SCORED', 'EXTRA_RUNS', 'MATCH', 'PLAYER', 'PLAYER_MATCH', 'TEAM', 'WICKET_TAKEN']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **BALL_BY_BALL**
   - `"match_id"`: Identifies the match.
   - `"innings_no"`: Distinguishes the innings number.
   - `"over_id"`, `"ball_id"`: Identifies each delivery in the match.
   - `"striker"`: ID of the batsman on strike.
   - `"non_striker"`: ID of the batsman at the non-striker end.
   - **Potential Usage**: Used to identify partnerships by pairing `"striker"` and `"non_striker"` during each ball of a match.

2. **BATSMAN_SCORED**
   - `"match_id"`, `"innings_no"`, `"over_id"`, `"ball_id"`: Used to join with `BALL_BY_BALL`.
   - `"runs_scored"`: Runs scored on that ball by the striker.
   - **Potential Usage**: Used to calculate the runs contributed by the striker on each ball.

3. **WICKET_TAKEN**
   - `"match_id"`, `"innings_no"`, `"over_id"`, `"ball_id"`: Identifies when a wicket was taken.
   - `"player_out"`: ID of the player who was dismissed.
   - **Potential Usage**: Helps determine when partnerships end due to a wicket.

4. **PLAYER**
   - `"player_id"`: Unique ID of a player.
   - `"player_name"`: Name of the player.
   - **Potential Usage**: Maps `player_id` to `player_name` for readability.

**Conditions that may be used:**

- Joining `BALL_BY_BALL` and `BATSMAN_SCORED` on `"match_id"`, `"innings_no"`, `"over_id"`, and `"ball_id"` to associate runs with each delivery.
- Grouping data by `"match_id"`, `"innings_no"`, and batsmen pairs to calculate partnership runs.
- Ordering batsman IDs using `LEAST` and `GREATEST` functions to avoid duplicate pairs.
- Using `JOIN` operations to bring in player names from `PLAYER` table.
- Identifying the maximum partnership runs per match to find the highest partnerships.

---

**SQL Queries:**

1. **Sample data from `BALL_BY_BALL` table:**
   ```sql
   SELECT * FROM "IPL"."IPL"."BALL_BY_BALL" LIMIT 100;
   ```

2. **Distinct matches in `BALL_BY_BALL` table:**
   ```sql
   SELECT DISTINCT "match_id" FROM "IPL"."IPL"."BALL_BY_BALL" LIMIT 100;
   ```

3. **Sample data from `BATSMAN_SCORED` table:**
   ```sql
   SELECT * FROM "IPL"."IPL"."BATSMAN_SCORED" LIMIT 100;
   ```

4. **Joining `BALL_BY_BALL` and `BATSMAN_SCORED` to get runs per ball with batsmen:**
   ```sql
   SELECT 
     bb."match_id", 
     bb."innings_no", 
     bb."over_id", 
     bb."ball_id", 
     bb."striker", 
     bb."non_striker", 
     bs."runs_scored"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   LIMIT 100;
   ```

5. **Total runs scored by each batsman per match:**
   ```sql
   SELECT 
     bb."match_id", 
     bb."striker", 
     SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   GROUP BY bb."match_id", bb."striker"
   LIMIT 100;
   ```

6. **Distinct pairs of batsmen per match:**
   ```sql
   SELECT DISTINCT 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
     GREATEST(bb."striker", bb."non_striker") AS "batsman2_id"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   LIMIT 100;
   ```

7. **Total runs per partnership (pair of batsmen):**
   ```sql
   SELECT 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
     GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
     SUM(bs."runs_scored") AS "partnership_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   GROUP BY 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker"), 
     GREATEST(bb."striker", bb."non_striker")
   LIMIT 100;
   ```

8. **Sample data from `WICKET_TAKEN` table:**
   ```sql
   SELECT * FROM "IPL"."IPL"."WICKET_TAKEN" LIMIT 100;
   ```

9. **Wickets taken in matches with player dismissed:**
   ```sql
   SELECT 
     "match_id", 
     "innings_no", 
     "over_id", 
     "ball_id", 
     "player_out", 
     "kind_out"
   FROM "IPL"."IPL"."WICKET_TAKEN"
   LIMIT 100;
   ```

10. **Total runs per batsman with player names:**
    ```sql
    SELECT 
      bb."match_id", 
      bb."striker", 
      p."player_name", 
      SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id" 
      AND bb."innings_no" = bs."innings_no" 
      AND bb."over_id" = bs."over_id" 
      AND bb."ball_id" = bs."ball_id"
    JOIN "IPL"."IPL"."PLAYER" p
      ON bb."striker" = p."player_id"
    GROUP BY bb."match_id", bb."striker", p."player_name"
    LIMIT 100;
    ```

11. **Player names corresponding to player IDs:**
    ```sql
    SELECT "player_id", "player_name" FROM "IPL"."IPL"."PLAYER" LIMIT 100;
    ```

12. **Distinct matches from `MATCH` table:**
    ```sql
    SELECT * FROM "IPL"."IPL"."MATCH" LIMIT 100;
    ```

13. **Maximum partnership runs per match:**
    ```sql
    SELECT 
      "match_id", 
      MAX("partnership_runs") AS "max_runs"
    FROM (
      SELECT 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
        GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
        SUM(bs."runs_scored") AS "partnership_runs"
      FROM "IPL"."IPL"."BALL_BY_BALL" bb
      JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id" 
        AND bb."innings_no" = bs."innings_no" 
        AND bb."over_id" = bs."over_id" 
        AND bb."ball_id" = bs."ball_id"
      GROUP BY 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker"), 
        GREATEST(bb."striker", bb."non_striker")
    ) AS partnerships
    GROUP BY "match_id"
    LIMIT 100;
    ```

14. **Partnerships matching the maximum runs per match:**
    ```sql
    SELECT 
      p."match_id", 
      p."batsman1_id", 
      p."batsman2_id", 
      p."partnership_runs"
    FROM (
      SELECT 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
        GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
        SUM(bs."runs_scored") AS "partnership_runs"
      FROM "IPL"."IPL"."BALL_BY_BALL" bb
      JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id" 
        AND bb."innings_no" = bs."innings_no" 
        AND bb."over_id" = bs."over_id" 
        AND bb."ball_id" = bs."ball_id"
      GROUP BY 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker"), 
        GREATEST(bb."striker", bb."non_striker")
    ) AS p
    JOIN (
      SELECT 
        "match_id", 
        MAX("partnership_runs") AS "max_runs"
      FROM (
        SELECT 
          bb."match_id", 
          LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
          GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
          SUM(bs."runs_scored") AS "partnership_runs"
        FROM "IPL"."IPL"."BALL_BY_BALL" bb
        JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
          ON bb."match_id" = bs."match_id" 
          AND bb."innings_no" = bs."innings_no" 
          AND bb."over_id" = bs."over_id" 
          AND bb."ball_id" = bs."ball_id"
        GROUP BY 
          bb."match_id", 
          LEAST(bb."striker", bb."non_striker"), 
          GREATEST(bb."striker", bb."non_striker")
      ) AS partnerships
      GROUP BY "match_id"
    ) AS max_p
      ON p."match_id" = max_p."match_id" 
      AND p."partnership_runs" = max_p."max_runs"
    LIMIT 100;
    ```

15. **Total runs contributed by each batsman in partnerships:**
    ```sql
    SELECT 
      bb."match_id", 
      bb."striker" AS "batsman_id", 
      SUM(bs."runs_scored") AS "runs_scored"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id" 
      AND bb."innings_no" = bs."innings_no" 
      AND bb."over_id" = bs."over_id" 
      AND bb."ball_id" = bs."ball_id"
    GROUP BY bb."match_id", bb."striker"
    LIMIT 100;
    ```

---

These queries will help in understanding the data and preparing to find the IDs of players who scored the highest number of partnership runs for each match. Each query explores different aspects of the data, such as partnerships, runs scored, wickets taken, and player information.Query:
SELECT * FROM "IPL"."IPL"."BALL_BY_BALL" LIMIT 100;
Answer:
match_id,over_id,ball_id,innings_no,team_batting,team_bowling,striker_batting_position,striker,non_striker,bowler
335987,1,1,2,2,1,1,6,7,106
335987,1,2,1,1,2,2,2,1,14
335987,1,2,2,2,1,2,7,6,106
335987,1,3,1,1,2,2,2,1,14
335987,1,3,2,2,1,2,7,6,106
335987,1,4,1,1,2,2,2,1,14
335987,1,4,2,2,1,2,7,6,106
335987,1,5,1,1,2,2,2,1,14
335987,1,5,2,2,1,1,6,7,106
335987,1,6,1,1,2,2,2,1,14
335987,1,6,2,2,1,2,7,6,106
335987,1,7,1,1,2,2,2,1,14
335987,1,7,2,2,1,2,7,6,106
335987,2,1,1,1,2,2,2,1,15
335987,2,1,2,2,1,1,6,7,84
335987,2,2,1,1,2,2,2,1,15
335987,2,2,2,2,1,3,8,7,84
335987,2,3,1,1,2,2,2,1,15
335987,2,3,2,2,1,3,8,7,84
335987,2,4,1,1,2,2,2,1,15
335987,2,4,2,2,1,3,8,7,84
335987,2,5,1,1,2,2,2,1,15
335987,2,5,2,2,1,2,7,8,84
335987,2,6,1,1,2,2,2,1,15
335987,2,6,2,2,1,2,7,8,84
335987,3,1,1,1,2,1,1,2,14
335987,3,1,2,2,1,3,8,7,106
335987,3,2,1,1,2,1,1,2,14
335987,3,2,2,2,1,3,8,7,106
335987,3,3,1,1,2,1,1,2,14
335987,3,3,2,2,1,4,9,7,106
335987,3,4,1,1,2,2,2,1,14
335987,3,4,2,2,1,2,7,9,106
335987,3,5,1,1,2,2,2,1,14
335987,3,5,2,2,1,2,7,9,106
335987,3,6,1,1,2,1,1,2,14
335987,3,6,2,2,1,2,7,9,106
335987,3,7,2,2,1,2,7,9,106
335987,4,1,1,1,2,2,2,1,13
335987,4,1,2,2,1,2,7,9,84
335987,4,2,1,1,2,2,2,1,13
335987,4,2,2,2,1,2,7,9,84
335987,4,3,1,1,2,2,2,1,13
335987,4,3,2,2,1,4,9,7,84
335987,4,4,1,1,2,1,1,2,13
335987,4,4,2,2,1,4,9,7,84
335987,4,5,1,1,2,1,1,2,13
335987,4,5,2,2,1,2,7,9,84
335987,4,6,1,1,2,1,1,2,13
335987,4,6,2,2,1,2,7,9,84
335987,4,7,1,1,2,2,2,1,13
335987,5,1,1,1,2,1,1,2,14
335987,5,1,2,2,1,4,9,7,82
335987,5,2,1,1,2,1,1,2,14
335987,5,2,2,2,1,2,7,9,82
335987,5,3,1,1,2,2,2,1,14
335987,5,3,2,2,1,4,9,7,82
335987,5,4,1,1,2,2,2,1,14
335987,5,4,2,2,1,4,9,7,82
335987,5,5,1,1,2,2,2,1,14
335987,5,5,2,2,1,4,9,7,82
335987,5,6,1,1,2,1,1,2,14
335987,5,6,2,2,1,5,10,7,82
335987,6,1,1,1,2,2,2,1,15
335987,6,1,2,2,1,2,7,10,106
335987,6,2,1,1,2,1,1,2,15
335987,6,2,2,2,1,2,7,10,106
335987,6,3,1,1,2,3,3,2,15
335987,6,3,2,2,1,6,11,10,106
335987,6,4,1,1,2,3,3,2,15
335987,6,4,2,2,1,6,11,10,106
335987,6,5,1,1,2,3,3,2,15
335987,6,5,2,2,1,5,10,11,106
335987,6,6,1,1,2,3,3,2,15
335987,6,6,2,2,1,6,11,10,106
335987,7,1,1,1,2,2,2,3,13
335987,7,1,2,2,1,5,10,11,82
335987,7,2,1,1,2,3,3,2,13
335987,7,2,2,2,1,5,10,11,82
335987,7,3,1,1,2,2,2,3,13
335987,7,3,2,2,1,5,10,11,82
335987,7,4,1,1,2,3,3,2,13
335987,7,4,2,2,1,6,11,10,82
335987,7,5,1,1,2,3,3,2,13
335987,7,5,2,2,1,6,11,10,82
335987,7,6,1,1,2,2,2,3,13
335987,7,6,2,2,1,6,11,10,82
335987,7,7,2,2,1,6,11,10,82
335987,7,8,2,2,1,6,11,10,82
335987,8,1,1,1,2,2,2,3,15
335987,8,1,2,2,1,5,10,11,1
335987,8,2,1,1,2,2,2,3,15
335987,8,2,2,2,1,6,11,10,1
335987,8,3,1,1,2,3,3,2,15
335987,8,3,2,2,1,5,10,11,1
335987,8,4,1,1,2,2,2,3,15
335987,8,4,2,2,1,6,11,10,1
335987,8,5,1,1,2,3,3,2,15
335987,8,5,2,2,1,6,11,10,1
335987,8,6,1,1,2,2,2,3,15
Query:
SELECT DISTINCT "match_id" FROM "IPL"."IPL"."BALL_BY_BALL" LIMIT 100;
Answer:
match_id
335987
335988
335989
335990
335991
335992
335993
335994
335995
335996
335998
335999
336000
336002
336003
336001
336004
336006
336008
336010
336015
336017
336018
336020
336014
336024
336025
336028
336030
336036
336037
336038
336039
336026
336044
392186
392193
392194
392202
392206
392214
392215
392216
392221
392224
392227
392228
392233
392234
335997
336005
336007
336009
336012
336013
336016
336019
336023
336031
336032
336033
336034
336029
336040
336041
336042
336043
392188
392189
392190
392196
392197
392199
392200
336045
392201
392203
392204
392205
392208
392209
392210
392211
392218
392220
392223
392229
392230
392231
392232
336011
336021
336022
336027
392187
392207
392212
392213
392217
392219
Query:
SELECT * FROM "IPL"."IPL"."BATSMAN_SCORED" LIMIT 100;
Answer:
match_id,over_id,ball_id,runs_scored,innings_no
335987,1,1,1,2
335987,1,2,0,1
335987,1,3,0,2
335987,1,4,0,1
335987,1,4,1,2
335987,1,5,0,1
335987,1,5,1,2
335987,1,6,0,1
335987,1,6,0,2
335987,1,7,0,1
335987,1,7,0,2
335987,2,1,0,1
335987,2,1,0,2
335987,2,2,4,1
335987,2,2,0,2
335987,2,3,4,1
335987,2,3,0,2
335987,2,4,6,1
335987,2,4,1,2
335987,2,5,4,1
335987,2,5,0,2
335987,2,6,0,1
335987,2,6,0,2
335987,3,1,0,1
335987,3,1,0,2
335987,3,2,0,1
335987,3,2,0,2
335987,3,3,0,1
335987,3,3,1,2
335987,3,4,4,1
335987,3,4,0,2
335987,3,5,1,1
335987,3,6,0,1
335987,3,6,0,2
335987,3,7,1,2
335987,4,1,2,2
335987,4,2,6,1
335987,4,2,1,2
335987,4,3,0,1
335987,4,3,0,2
335987,4,4,4,1
335987,4,4,0,2
335987,4,5,0,1
335987,4,5,0,2
335987,4,6,1,1
335987,4,6,0,2
335987,4,7,6,1
335987,5,1,4,1
335987,5,1,1,2
335987,5,2,1,1
335987,5,2,1,2
335987,5,3,4,1
335987,5,3,0,2
335987,5,4,0,1
335987,5,4,6,2
335987,5,5,1,1
335987,5,5,0,2
335987,5,6,0,1
335987,5,6,0,2
335987,6,1,1,1
335987,6,1,0,2
335987,6,2,0,1
335987,6,2,0,2
335987,6,3,0,1
335987,6,3,0,2
335987,6,4,0,1
335987,6,4,1,2
335987,6,5,0,1
335987,6,5,1,2
335987,6,6,0,1
335987,6,6,0,2
335987,7,1,1,1
335987,7,1,0,2
335987,7,2,1,1
335987,7,2,0,2
335987,7,3,1,1
335987,7,3,1,2
335987,7,4,2,1
335987,7,5,1,1
335987,7,6,1,1
335987,7,6,0,2
335987,7,7,0,2
335987,7,8,4,2
335987,8,1,0,1
335987,8,1,1,2
335987,8,2,1,1
335987,8,2,0,2
335987,8,3,1,1
335987,8,3,1,2
335987,8,4,1,1
335987,8,4,2,2
335987,8,5,1,1
335987,8,5,0,2
335987,8,6,1,1
335987,8,6,0,2
335987,9,1,0,1
335987,9,1,0,2
335987,9,2,0,1
335987,9,2,0,2
335987,9,3,0,1
Query:
SELECT 
     bb."match_id", 
     bb."innings_no", 
     bb."over_id", 
     bb."ball_id", 
     bb."striker", 
     bb."non_striker", 
     bs."runs_scored"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,striker,non_striker,runs_scored
335987,2,1,1,6,7,1
335987,1,1,2,2,1,0
335987,2,1,3,7,6,0
335987,1,1,4,2,1,0
335987,2,1,4,7,6,1
335987,1,1,5,2,1,0
335987,2,1,5,6,7,1
335987,1,1,6,2,1,0
335987,2,1,6,7,6,0
335987,1,1,7,2,1,0
335987,2,1,7,7,6,0
335987,1,2,1,2,1,0
335987,2,2,1,6,7,0
335987,1,2,2,2,1,4
335987,2,2,2,8,7,0
335987,1,2,3,2,1,4
335987,2,2,3,8,7,0
335987,1,2,4,2,1,6
335987,2,2,4,8,7,1
335987,1,2,5,2,1,4
335987,2,2,5,7,8,0
335987,1,2,6,2,1,0
335987,2,2,6,7,8,0
335987,1,3,1,1,2,0
335987,2,3,1,8,7,0
335987,1,3,2,1,2,0
335987,2,3,2,8,7,0
335987,1,3,3,1,2,0
335987,2,3,3,9,7,1
335987,1,3,4,2,1,4
335987,2,3,4,7,9,0
335987,1,3,5,2,1,1
335987,1,3,6,1,2,0
335987,2,3,6,7,9,0
335987,2,3,7,7,9,1
335987,2,4,1,7,9,2
335987,1,4,2,2,1,6
335987,2,4,2,7,9,1
335987,1,4,3,2,1,0
335987,2,4,3,9,7,0
335987,1,4,4,1,2,4
335987,2,4,4,9,7,0
335987,1,4,5,1,2,0
335987,2,4,5,7,9,0
335987,1,4,6,1,2,1
335987,2,4,6,7,9,0
335987,1,4,7,2,1,6
335987,1,5,1,1,2,4
335987,2,5,1,9,7,1
335987,1,5,2,1,2,1
335987,2,5,2,7,9,1
335987,1,5,3,2,1,4
335987,2,5,3,9,7,0
335987,1,5,4,2,1,0
335987,2,5,4,9,7,6
335987,1,5,5,2,1,1
335987,2,5,5,9,7,0
335987,1,5,6,1,2,0
335987,2,5,6,10,7,0
335987,1,6,1,2,1,1
335987,2,6,1,7,10,0
335987,1,6,2,1,2,0
335987,2,6,2,7,10,0
335987,1,6,3,3,2,0
335987,2,6,3,11,10,0
335987,1,6,4,3,2,0
335987,2,6,4,11,10,1
335987,1,6,5,3,2,0
335987,2,6,5,10,11,1
335987,1,6,6,3,2,0
335987,2,6,6,11,10,0
335987,1,7,1,2,3,1
335987,2,7,1,10,11,0
335987,1,7,2,3,2,1
335987,2,7,2,10,11,0
335987,1,7,3,2,3,1
335987,2,7,3,10,11,1
335987,1,7,4,3,2,2
335987,1,7,5,3,2,1
335987,1,7,6,2,3,1
335987,2,7,6,11,10,0
335987,2,7,7,11,10,0
335987,2,7,8,11,10,4
335987,1,8,1,2,3,0
335987,2,8,1,10,11,1
335987,1,8,2,2,3,1
335987,2,8,2,11,10,0
335987,1,8,3,3,2,1
335987,2,8,3,10,11,1
335987,1,8,4,2,3,1
335987,2,8,4,11,10,2
335987,1,8,5,3,2,1
335987,2,8,5,11,10,0
335987,1,8,6,2,3,1
335987,2,8,6,10,12,0
335987,1,9,1,2,3,0
335987,2,9,1,12,10,0
335987,1,9,2,2,3,0
335987,2,9,2,12,10,0
335987,1,9,3,2,3,0
Query:
SELECT 
     bb."match_id", 
     bb."striker", 
     SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   GROUP BY bb."match_id", bb."striker"
   LIMIT 100;
Answer:
match_id,striker,total_runs
335987,2,158
335987,9,8
335987,14,18
335988,19,116
335988,26,54
335988,21,32
335988,29,3
335989,30,7
335989,42,52
335989,32,17
335989,38,14
335990,43,8
335990,6,32
335990,9,25
335990,11,39
335990,49,28
335990,50,2
335991,60,0
335991,61,1
335992,33,5
335992,31,7
335992,26,20
335993,54,14
335998,5,16
336000,41,6
336002,5,2
335987,15,3
335988,23,31
335989,36,2
335991,62,10
335991,4,38
335991,5,13
335992,24,26
335992,32,76
335992,65,4
335994,46,43
335994,49,17
335994,73,1
335994,23,2
335996,48,2
335998,1,12
336000,87,39
336000,29,10
336000,66,1
336001,21,28
336002,46,37
336002,82,2
335990,48,20
335992,35,36
335994,19,5
335995,232,16
335996,46,21
335997,14,34
335999,44,18
335999,85,0
336000,27,40
336003,8,1
336007,9,31
336007,7,5
336011,76,31
336013,114,27
336012,70,20
336020,42,3
336029,61,3
335991,3,0
335996,49,22
335991,54,14
335991,2,5
335991,1,14
335992,25,16
335992,64,2
335992,66,0
335993,57,66
335994,21,53
335995,53,13
335996,64,12
335996,73,2
335997,51,2
335997,9,11
335997,32,61
335997,11,4
335997,15,17
335998,4,0
335998,83,3
336001,11,4
336001,6,0
336003,42,50
336004,76,15
335991,57,0
335991,58,6
335993,59,8
335993,60,12
335993,61,1
335994,18,81
335995,75,4
335996,26,94
335996,67,0
335996,78,4
335997,16,3
335998,18,70
Query:
SELECT DISTINCT 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
     GREATEST(bb."striker", bb."non_striker") AS "batsman2_id"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   LIMIT 100;
Answer:
match_id,batsman1_id,batsman2_id
335987,6,7
335987,1,2
335987,7,9
335987,7,10
335987,2,3
335987,10,11
335987,10,12
335987,10,13
335987,2,4
335987,2,5
335988,24,25
335987,7,8
335987,14,15
335987,14,16
335988,18,19
335988,25,26
335988,19,22
335988,26,28
335989,30,31
335989,40,41
335989,40,42
335989,31,32
335989,33,35
335989,35,36
335990,43,44
335990,6,51
335990,6,52
335990,46,47
335988,19,23
335989,37,38
335990,44,46
335990,8,9
335990,9,11
335990,48,49
335991,3,62
335991,1,62
335991,53,55
335991,1,4
335991,56,57
335991,56,232
335991,4,5
335991,59,60
335991,59,61
335992,24,25
335992,25,26
335992,32,34
335993,57,70
335991,56,58
335991,61,131
335994,17,18
335994,48,50
335995,31,74
335995,55,56
335995,32,74
335995,35,74
335996,46,71
335996,26,65
335997,32,74
335997,8,52
335998,1,2
335998,1,62
336001,19,22
335987,13,14
335988,17,18
335988,19,21
335988,26,27
335988,28,29
335989,32,33
335989,35,37
335989,37,39
335990,44,45
335990,9,52
335990,46,48
335990,11,12
335991,53,54
335991,2,62
335991,56,59
335991,4,63
335992,25,64
335992,25,27
335992,27,29
335992,32,35
335992,29,65
335992,67,68
335993,53,54
335993,40,41
335993,54,55
335993,56,57
335993,60,232
335994,43,44
335994,44,46
335994,46,49
335994,49,71
335992,32,69
335992,65,66
335993,41,42
335993,54,56
335993,57,232
335993,60,61
335994,18,19
Query:
SELECT 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
     GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
     SUM(bs."runs_scored") AS "partnership_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" bb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
     ON bb."match_id" = bs."match_id" 
     AND bb."innings_no" = bs."innings_no" 
     AND bb."over_id" = bs."over_id" 
     AND bb."ball_id" = bs."ball_id"
   GROUP BY 
     bb."match_id", 
     LEAST(bb."striker", bb."non_striker"), 
     GREATEST(bb."striker", bb."non_striker")
   LIMIT 100;
Answer:
match_id,batsman1_id,batsman2_id,partnership_runs
335987,6,7,3
335987,7,10,0
335987,14,15,11
335987,2,5,50
335988,17,18,24
335988,24,25,55
335987,10,13,3
335987,14,16,9
335988,18,19,30
335988,25,26,52
335988,19,21,65
335988,26,27,38
335989,40,42,102
335989,33,34,5
335989,33,35,8
335989,35,37,20
335990,44,46,25
335990,9,52,8
335991,2,62,6
335991,56,57,0
335991,59,60,1
335992,65,66,0
335992,67,68,16
335995,55,70,10
335996,49,50,0
335996,66,77,1
335989,31,32,6
335989,37,38,17
335990,8,9,29
335991,53,56,24
335992,24,25,34
335992,65,67,13
335994,20,22,11
335995,31,74,97
335997,9,52,43
335997,32,74,101
335997,11,14,1
335999,53,55,146
335999,71,72,29
336003,7,14,6
336001,19,22,0
336004,53,55,27
335992,25,26,22
335994,48,73,12
335996,46,79,4
335997,51,52,13
335998,63,82,20
335999,44,85,3
336000,86,87,7
336001,17,19,19
336001,11,52,4
336003,40,41,50
336001,8,14,6
336005,1,82,27
336005,33,101,37
336005,1,104,6
336006,42,110,32
336008,4,63,20
336013,36,39,1
336018,25,100,16
336019,54,61,17
336022,103,128,31
336020,135,136,6
336029,47,114,13
335993,40,41,31
335993,54,55,14
335993,57,70,15
335997,14,16,12
335999,44,49,28
335987,10,11,11
335987,2,3,47
335990,46,47,49
335991,3,62,6
335991,53,55,1
335991,1,4,27
335991,59,61,5
335991,61,131,0
335992,25,27,7
335992,29,65,0
335993,57,59,21
335994,18,21,94
335995,35,74,0
335996,24,29,8
335996,26,66,3
335997,36,74,1
335997,8,52,4
336002,1,2,5
336002,46,71,101
336003,40,42,98
336003,9,11,26
336004,54,57,2
335990,44,45,6
335992,32,69,25
335993,41,42,100
335995,53,55,22
335996,66,67,8
335998,1,4,2
335998,18,20,79
335999,43,44,13
335999,48,49,22
Query:
SELECT * FROM "IPL"."IPL"."WICKET_TAKEN" LIMIT 100;
Answer:
match_id,over_id,ball_id,player_out,kind_out,innings_no
419167,10,3,154,caught,1
419167,10,3,46,caught,2
419167,12,4,8,caught,2
419167,14,4,96,caught,2
419167,18,4,208,caught,1
419168,2,7,18,caught,1
419168,5,5,21,caught,1
419168,6,1,53,caught,2
419168,6,5,178,caught,2
419168,8,2,57,caught,2
419168,14,2,20,caught,1
419168,15,5,109,caught,1
419168,16,2,56,caught,2
419168,18,4,188,caught,2
419168,20,2,131,caught,2
419168,20,4,125,caught,1
419169,1,4,53,caught,1
419169,4,2,57,caught,1
419169,7,1,56,caught,1
419169,17,3,54,caught,1
419169,19,3,131,caught,1
419170,2,4,42,caught,2
419170,8,2,185,caught,1
419170,9,4,18,caught,1
419170,12,2,23,caught,1
419170,15,2,133,caught,2
419170,15,5,79,caught,2
419170,17,6,154,caught,2
419170,18,1,20,caught,1
419170,19,6,221,caught,2
501203,1,6,185,caught,1
501203,11,3,21,caught,1
501203,16,2,9,caught,2
501203,18,2,20,caught,1
501203,20,2,63,caught,2
501204,5,5,42,caught,1
501204,6,3,26,caught,1
501204,6,5,252,caught,2
501204,11,1,257,caught,1
501204,13,6,154,caught,1
501204,18,3,258,caught,1
501204,20,1,112,caught,1
501204,20,3,94,caught,1
501205,2,2,135,caught,2
501205,9,6,55,caught,1
501205,10,6,260,caught,2
501205,12,3,2,caught,1
501205,18,4,79,caught,2
501205,19,4,259,caught,1
501206,7,6,254,caught,1
501206,15,2,183,caught,1
501206,18,4,106,caught,1
501207,1,1,74,caught,2
501207,1,4,53,caught,1
501207,2,3,100,caught,1
501207,3,4,167,caught,1
501207,4,3,88,caught,1
501207,8,5,171,caught,2
501207,9,3,48,caught,1
501207,9,3,157,caught,2
501207,18,1,67,caught,1
501207,20,1,14,caught,1
501208,9,6,26,caught,2
501208,13,2,154,caught,2
501208,13,3,9,caught,1
501208,14,6,93,caught,2
501208,17,4,258,caught,2
501208,18,1,112,caught,2
501208,20,6,31,caught,1
501209,1,3,41,caught,1
501209,5,5,254,caught,1
501209,8,1,262,caught,1
501209,8,3,183,caught,1
501209,8,3,6,caught,2
501209,11,5,266,caught,2
501209,18,4,187,caught,1
501209,19,7,54,caught,1
501210,5,4,8,caught,1
501211,1,2,21,caught,1
501211,6,5,53,caught,2
501211,14,6,264,caught,2
501212,1,1,2,caught,1
501212,3,5,64,caught,1
501212,5,5,17,caught,1
501212,8,4,74,caught,2
501212,10,5,171,caught,2
501212,12,2,27,caught,2
501212,16,2,104,caught,1
501212,17,1,35,caught,1
501213,2,6,135,caught,2
501213,3,5,42,caught,1
501213,5,6,260,caught,2
501213,7,4,110,caught,2
501213,9,6,65,caught,1
501213,12,1,79,caught,2
501213,15,4,26,caught,1
501213,17,5,203,caught,2
501213,17,6,268,caught,2
501213,20,1,269,caught,2
501213,20,2,154,caught,1
Query:
SELECT 
     "match_id", 
     "innings_no", 
     "over_id", 
     "ball_id", 
     "player_out", 
     "kind_out"
   FROM "IPL"."IPL"."WICKET_TAKEN"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,player_out,kind_out
419167,1,10,3,154,caught
419167,2,10,3,46,caught
419167,2,12,4,8,caught
419167,2,14,4,96,caught
419167,1,18,4,208,caught
419168,1,2,7,18,caught
419168,1,5,5,21,caught
419168,2,6,1,53,caught
419168,2,6,5,178,caught
419168,2,8,2,57,caught
419168,1,14,2,20,caught
419168,1,15,5,109,caught
419168,2,16,2,56,caught
419168,2,18,4,188,caught
419168,2,20,2,131,caught
419168,1,20,4,125,caught
419169,1,1,4,53,caught
419169,1,4,2,57,caught
419169,1,7,1,56,caught
419169,1,17,3,54,caught
419169,1,19,3,131,caught
419170,2,2,4,42,caught
419170,1,8,2,185,caught
419170,1,9,4,18,caught
419170,1,12,2,23,caught
419170,2,15,2,133,caught
419170,2,15,5,79,caught
419170,2,17,6,154,caught
419170,1,18,1,20,caught
419170,2,19,6,221,caught
501203,1,1,6,185,caught
501203,1,11,3,21,caught
501203,2,16,2,9,caught
501203,1,18,2,20,caught
501203,2,20,2,63,caught
501204,1,5,5,42,caught
501204,1,6,3,26,caught
501204,2,6,5,252,caught
501204,1,11,1,257,caught
501204,1,13,6,154,caught
501204,1,18,3,258,caught
501204,1,20,1,112,caught
501204,1,20,3,94,caught
501205,2,2,2,135,caught
501205,1,9,6,55,caught
501205,2,10,6,260,caught
501205,1,12,3,2,caught
501205,2,18,4,79,caught
501205,1,19,4,259,caught
501206,1,7,6,254,caught
501206,1,15,2,183,caught
501206,1,18,4,106,caught
501207,2,1,1,74,caught
501207,1,1,4,53,caught
501207,1,2,3,100,caught
501207,1,3,4,167,caught
501207,1,4,3,88,caught
501207,2,8,5,171,caught
501207,1,9,3,48,caught
501207,2,9,3,157,caught
501207,1,18,1,67,caught
501207,1,20,1,14,caught
501208,2,9,6,26,caught
501208,2,13,2,154,caught
501208,1,13,3,9,caught
501208,2,14,6,93,caught
501208,2,17,4,258,caught
501208,2,18,1,112,caught
501208,1,20,6,31,caught
501209,1,1,3,41,caught
501209,1,5,5,254,caught
501209,1,8,1,262,caught
501209,1,8,3,183,caught
501209,2,8,3,6,caught
501209,2,11,5,266,caught
501209,1,18,4,187,caught
501209,1,19,7,54,caught
501210,1,5,4,8,caught
501211,1,1,2,21,caught
501211,2,6,5,53,caught
501211,2,14,6,264,caught
501212,1,1,1,2,caught
501212,1,3,5,64,caught
501212,1,5,5,17,caught
501212,2,8,4,74,caught
501212,2,10,5,171,caught
501212,2,12,2,27,caught
501212,1,16,2,104,caught
501212,1,17,1,35,caught
501213,2,2,6,135,caught
501213,1,3,5,42,caught
501213,2,5,6,260,caught
501213,2,7,4,110,caught
501213,1,9,6,65,caught
501213,2,12,1,79,caught
501213,1,15,4,26,caught
501213,2,17,5,203,caught
501213,2,17,6,268,caught
501213,2,20,1,269,caught
501213,1,20,2,154,caught
Query:
SELECT 
      bb."match_id", 
      bb."striker", 
      p."player_name", 
      SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id" 
      AND bb."innings_no" = bs."innings_no" 
      AND bb."over_id" = bs."over_id" 
      AND bb."ball_id" = bs."ball_id"
    JOIN "IPL"."IPL"."PLAYER" p
      ON bb."striker" = p."player_id"
    GROUP BY bb."match_id", bb."striker", p."player_name"
    LIMIT 100;
Answer:
match_id,striker,player_name,total_runs
335987,6,R Dravid,2
335987,2,BB McCullum,158
335987,7,W Jaffer,6
335987,8,V Kohli,1
335987,4,DJ Hussey,12
335988,26,KC Sangakkara,54
335990,52,LRPL Taylor,23
335991,58,SB Styris,6
335997,15,Z Khan,17
336005,33,M Kaif,21
335991,62,WP Saha,10
336007,61,RP Singh,1
335988,25,JR Hopes,71
335989,33,M Kaif,9
335990,11,MV Boucher,39
335998,84,I Sharma,4
335989,37,D Salunkhe,26
335990,50,Harbhajan Singh,2
335991,232,UT Yadav,10
335992,66,B Lee,0
335992,67,PP Chawla,24
335995,75,Pankaj Singh,4
336003,40,G Gambhir,86
335988,27,Yuvraj Singh,23
335996,77,S Sreesanth,0
335998,62,WP Saha,27
335999,49,SM Pollock,31
336000,42,S Dhawan,0
336002,3,RT Ponting,19
336001,17,PA Patel,21
336005,106,AB Dinda,1
336009,40,G Gambhir,1
336013,32,SR Watson,32
336015,4,DJ Hussey,26
336020,135,TM Dilshan,18
336029,47,PR Shah,10
336040,29,IK Pathan,7
335993,41,V Sehwag,94
335994,71,DJ Bravo,24
335999,43,L Ronchi,13
335991,5,Mohammad Hafeez,13
335994,50,Harbhajan Singh,28
335995,53,AC Gilchrist,13
335995,33,M Kaif,34
336002,82,AB Agarkar,2
336002,83,M Kartik,10
336003,52,LRPL Taylor,29
336003,8,V Kohli,1
335994,18,ML Hayden,81
336011,100,SE Marsh,39
336012,119,Joginder Sharma,16
336014,109,JA Morkel,30
336016,112,DB Ravi Teja,6
336021,113,Misbah-ul-Haq,21
336021,10,CL White,10
336024,100,SE Marsh,115
336026,128,A Chopra,1
336040,92,TM Srivastava,1
336033,49,SM Pollock,0
336044,25,JR Hopes,2
392186,156,T Thushara,1
392190,14,P Kumar,0
392217,147,DR Smith,16
392189,163,MC Henriques,6
335992,27,Yuvraj Singh,57
335993,55,VVS Laxman,2
335990,6,R Dravid,32
335999,44,ST Jayasuriya,18
335995,32,SR Watson,4
335996,24,K Goel,18
335991,63,LR Shukla,4
335995,38,SK Warne,22
335992,69,Kamran Akmal,15
335999,71,DJ Bravo,34
336000,88,KD Karthik,24
336014,40,G Gambhir,80
336030,103,Salman Butt,73
335989,32,SR Watson,17
335994,23,S Badrinath,2
335999,85,AM Rahane,0
336002,1,SC Ganguly,4
335997,6,R Dravid,0
335996,44,ST Jayasuriya,1
335998,1,SC Ganguly,12
336001,11,MV Boucher,4
336003,88,KD Karthik,2
335998,5,Mohammad Hafeez,16
336004,99,D Kalyankrishna,3
336005,101,SA Asnodkar,60
336002,2,BB McCullum,1
336005,36,M Rawat,1
336007,53,AC Gilchrist,46
336007,7,W Jaffer,5
336007,60,WPUJC Vaas,0
336008,5,Mohammad Hafeez,13
336008,27,Yuvraj Singh,17
336009,71,DJ Bravo,2
336009,49,SM Pollock,33
336009,79,SS Tiwary,9
336009,115,RR Raje,6
Query:
SELECT "player_id", "player_name" FROM "IPL"."IPL"."PLAYER" LIMIT 100;
Answer:
player_id,player_name
1,SC Ganguly
2,BB McCullum
3,RT Ponting
4,DJ Hussey
5,Mohammad Hafeez
6,R Dravid
7,W Jaffer
8,V Kohli
9,JH Kallis
10,CL White
11,MV Boucher
12,B Akhil
13,AA Noffke
14,P Kumar
15,Z Khan
16,SB Joshi
17,PA Patel
18,ML Hayden
19,MEK Hussey
20,MS Dhoni
21,SK Raina
22,JDP Oram
23,S Badrinath
24,K Goel
25,JR Hopes
26,KC Sangakkara
27,Yuvraj Singh
28,SM Katich
29,IK Pathan
30,T Kohli
31,YK Pathan
32,SR Watson
33,M Kaif
34,DS Lehmann
36,M Rawat
37,D Salunkhe
38,SK Warne
39,SK Trivedi
40,G Gambhir
41,V Sehwag
42,S Dhawan
43,L Ronchi
44,ST Jayasuriya
45,DJ Thornely
46,RV Uthappa
47,PR Shah
48,AM Nayar
49,SM Pollock
50,Harbhajan Singh
51,S Chanderpaul
52,LRPL Taylor
53,AC Gilchrist
54,Y Venugopal Rao
55,VVS Laxman
56,A Symonds
57,RG Sharma
58,SB Styris
59,SB Bangar
60,WPUJC Vaas
61,RP Singh
62,WP Saha
63,LR Shukla
64,DPMD Jayawardene
65,S Sohal
66,B Lee
67,PP Chawla
68,WA Mota
69,Kamran Akmal
70,Shahid Afridi
71,DJ Bravo
72,MA Khote
73,A Nehra
74,GC Smith
75,Pankaj Singh
76,RR Sarwan
77,S Sreesanth
78,VRV Singh
79,SS Tiwary
80,DS Kulkarni
81,R Vinay Kumar
82,AB Agarkar
83,M Kartik
84,I Sharma
85,AM Rahane
86,Shoaib Malik
87,MK Tiwary
88,KD Karthik
89,R Bhatia
90,MF Maharoof
91,VY Mahesh
92,TM Srivastava
93,B Chipli
94,DW Steyn
95,DB Das
96,MK Pandey
97,HH Gibbs
98,DNT Zoysa
99,D Kalyankrishna
100,SE Marsh
101,SA Asnodkar
Query:
SELECT * FROM "IPL"."IPL"."MATCH" LIMIT 100;
Answer:
Too long, hard cut:
match_id,team_1,team_2,match_date,season_id,venue,toss_winner,toss_decision,win_type,win_margin,outcome_type,match_winner,man_of_the_match
335987,2,1,2008-04-18,1,M Chinnaswamy Stadium,2,field,runs,140,Result,1,2
335988,4,3,2008-04-19,1,Punjab Cricket Association Stadium Mohali,3,bat,runs,33,Result,3,19
335989,6,5,2008-04-19,1,Feroz Shah Kotla,5,bat,wickets,9,Result,6,90
335990,7,2,2008-04-20,1,Wankhede Stadium,7,bat,wickets,5,Result,2,11
335991,1,8,2008-04-20,1,Eden Gardens,8,bat,wickets,5,Result,1,4
335992,5,4,2008-04-21,1,Sawai Mansingh Stadium,4,bat,wickets,6,Result,5,32
335993,8,6,2008-04-22,1,Rajiv Gandhi International Stadium Uppal,8,bat,wickets,9,Result,6,41
335994,3,7,2008-04-23,1,MA Chidambaram Stadium Chepauk,7,field,runs,6,Result,3,18
335995,8,5,2008-04-24,1,Rajiv Gandhi International Stadium Uppal,5,field,wickets,3,Result,5,31
335996,4,7,2008-04-25,1,Punjab Cricket Association Stadium Mohali,7,field,runs,66,Result,4,26
335997,2,5,2008-04-26,1,M Chinnaswamy Stadium,5,field,wickets,7,Result,5,32
335998,3,1,2008-04-26,1,MA Chidambaram Stadium Chepauk,1,bat,wickets,9,Result,3,22
335999,7,8,2008-04-27,1,Dr DY Patil Sports Academy,8,field,wickets,10,Result,8,53
336000,4,6,2008-04-27,1,Punjab Cricket Association Stadium Mohali,6,bat,wickets,4,Result,4,28
336001,2,3,2008-04-28,1,M Chinnaswamy Stadium,3,bat,runs,13,Result,3,20
336002,1,7,2008-04-29,1,Eden Gardens,1,bat,wickets,7,Result,7,44
336003,6,2,2008-04-30,1,Feroz Shah Kotla,2,field,runs,10,Result,6,118
336004,8,4,2008-05-01,1,Rajiv Gandhi International Stadium Uppal,4,field,wickets,7,Result,4,100
336005,5,1,2008-05-01,1,Sawai Mansingh Stadium,5,bat,runs,45,Result,5,101
336006,3,6,2008-05-02,1,MA Chidambaram Stadium Chepauk,3,bat,wickets,8,Result,6,41
336007,8,2,2008-05-25,1,Rajiv Gandhi International Stadium Uppal,8,bat,wickets,5,Result,2,81
336008,4,1,2008-05-03,1,Punjab Cricket Association Stadium Mohali,4,bat,runs,9,Result,4,29
336009,7,6,2008-05-04,1,Dr DY Patil Sports Academy,6,field,runs,29,Result,7,49
336010,5,3,2008-05-04,1,Sawai Mansingh Stadium,3,bat,wickets,8,Result,5,102
336011,2,4,2008-05-05,1,M Chinnaswamy Stadium,4,field,wickets,6,Result,4,77
336012,3,8,2008-05-06,1,MA Chidambaram Stadium Chepauk,8,field,wickets,7,Result,8,53
336013,7,5,2008-05-07,1,Dr DY Patil Sports Academy,7,field,wickets,7,Result,7,73
336014,6,3,2008-05-08,1,Feroz Shah Kotla,3,field,wickets,4,Result,3,20
336015,1,2,2008-05-08,1,Eden Gardens,1,bat,runs,5,Result,1,1
336016,5,8,2008-05-09,1,Sawai Mansingh Stadium,5,field,wickets,8,Result,5,31
336017,2,7,2008-05-28,1,M Chinnaswamy Stadium,7,field,wickets,9,Result,7,149
336018,3,4,2008-05-10,1,MA Chidambaram Stadium Chepauk,4,field,runs,18,Result,3,151
336019,8,1,2008-05-11,1,Rajiv Gandhi International Stadium Uppal,1,bat,runs,23,Result,1,1
336020,5,6,2008-05-11,1,Sawai Mansingh Stadium,5,field,wickets,3,Result,5,32
336021,4,2,2008-05-12,1,Punjab Cricket Association Stadium Mohali,2,bat,wickets,9,Result,4,100
336022,1,6,2008-05-13,1,Eden Gardens,1,bat,runs,23,Result,1,144
336023,7,3,2008-05-14,1,Wankhede Stadium,7,field,wickets,9,Result,7,44
336024,4,5,2008-05-28,1,Punjab Cricket Association Stadium Mohali,5,field,runs,41,Result,4,100
336025,6,8,2008-05-15,1,Feroz Shah Kotla,8,field,runs,12,Result,6,136
336026,7,1,2008-05-16,1,Wankhede Stadium,7,field,wickets,8,Result,7,49
336027,6,4,2008-05-17,1,Feroz Shah Kotla,6,bat,runs,6,Result,4,64
336028,5,2,2008-05-17,1,Sawai Mansingh Stadium,2,field,runs,65,Result,5,74
336029,8,7,2008-05-18,1,Rajiv Gandhi International Stadium Uppal,8,field,runs,25,Result,7,71
336030,1,3,2008-05-18,1,Eden Gardens,1,bat,runs,3,Result,3,122
336031,2,6,2008-05-19,1,M Chinnaswamy Stadium,6,field,wickets,5,Result,6,132
336032,1,5,2008-05-20,1,Eden Gardens,5,field,wickets,6,Result,5,31
336033,7,4,2008-05-21,1,Wankhede Stadium,7,field,runs,1,Result,4,100
336034,3,2,2008-05-21,1,MA Chidambaram Stadium Chepauk,2,bat,runs,14,Result,2,124
336036,4,8,2008-05-23,1,Punjab Cricket Association Stadium Mohali,4,field,wickets,6,Result,4,100
336037,6,7,2008-05-24,1,Feroz Shah Kotla,6,field,wickets,5,Result,6,88
336038,3,5,2008-05-24,1,MA Chidambaram Stadium Chepauk,5,bat,runs,10,Result,5,109
336039,2,8,2008-05-03,1,M Chinnaswamy Stadium,8,field,runs,3,Result,2,14
336040,1,4,2008-05-25,1,Eden Gardens,4,bat,wickets,3,Result,1,105
336041,5,7,2008-05-26,1,Sawai Mansingh Stadium,5,field,wickets,5,Result,5,102
336042,8,3,2008-05-27,1,Rajiv Gandhi International Stadium Uppal,8,bat,wickets,7,Result,3,21
336043,6,5,2008-05-30,1,Wankhede Stadium,6,field,runs,105,Result,5,32
336044,3,4,2008-05-31,1,Wankhede Stadium,4,bat,wickets,9,Result,3,122
336045,3,5,2008-06-01,1,Dr DY Patil Sports Academy,5,field,wickets,3,Result,5,31
392186,3,7,2009-04-18,2,Newlands,3,field,runs,19,Result,7,133
392187,2,5,2009-04-18,2,Newlands,2,bat,runs,75,Result,2,6
392188,6,4,2009-04-19,2,Newlands,6,field,wickets,10,Result,6,175
392189,8,1,2009-04-19,2,Newlands,1,bat,wickets,8,Result,8,61
392190,2,3,2009-04-20,2,St George's Park,3,bat,runs,92,R
Query:
SELECT 
      "match_id", 
      MAX("partnership_runs") AS "max_runs"
    FROM (
      SELECT 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
        GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
        SUM(bs."runs_scored") AS "partnership_runs"
      FROM "IPL"."IPL"."BALL_BY_BALL" bb
      JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id" 
        AND bb."innings_no" = bs."innings_no" 
        AND bb."over_id" = bs."over_id" 
        AND bb."ball_id" = bs."ball_id"
      GROUP BY 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker"), 
        GREATEST(bb."striker", bb."non_striker")
    ) AS partnerships
    GROUP BY "match_id"
    LIMIT 100;
Answer:
match_id,max_runs
335988,73
335996,70
335997,101
335999,146
336000,55
336005,65
336013,47
336020,62
335993,100
336009,46
336011,52
336015,44
336021,95
336023,89
336024,131
336030,80
336037,65
336041,65
392194,74
392207,67
392224,52
392226,65
392233,66
336042,69
419134,53
419157,50
419162,60
548365,91
336003,98
336006,110
336027,69
336043,64
392190,95
392193,58
392221,90
336038,120
336044,99
392201,65
392218,41
392220,59
392223,103
392237,70
419111,123
419112,106
419117,120
419135,51
419142,147
419167,63
501227,122
501259,110
548324,50
598054,97
598056,127
392214,69
419140,73
419153,62
501243,51
501262,97
501266,36
548341,106
548348,64
598034,51
729312,27
734040,71
392204,63
392217,51
392232,67
336033,128
392227,78
392243,69
336026,40
392196,65
392203,79
392213,121
392225,37
392234,52
392235,85
419118,108
419133,65
419136,127
419137,42
419138,62
419144,96
419145,55
419150,89
419158,127
419164,97
419166,88
501208,49
501213,60
501226,84
548338,82
548363,56
548378,59
548379,76
729290,75
729310,32
734042,50
336025,127
392228,59
Query:
SELECT 
      p."match_id", 
      p."batsman1_id", 
      p."batsman2_id", 
      p."partnership_runs"
    FROM (
      SELECT 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
        GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
        SUM(bs."runs_scored") AS "partnership_runs"
      FROM "IPL"."IPL"."BALL_BY_BALL" bb
      JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id" 
        AND bb."innings_no" = bs."innings_no" 
        AND bb."over_id" = bs."over_id" 
        AND bb."ball_id" = bs."ball_id"
      GROUP BY 
        bb."match_id", 
        LEAST(bb."striker", bb."non_striker"), 
        GREATEST(bb."striker", bb."non_striker")
    ) AS p
    JOIN (
      SELECT 
        "match_id", 
        MAX("partnership_runs") AS "max_runs"
      FROM (
        SELECT 
          bb."match_id", 
          LEAST(bb."striker", bb."non_striker") AS "batsman1_id", 
          GREATEST(bb."striker", bb."non_striker") AS "batsman2_id", 
          SUM(bs."runs_scored") AS "partnership_runs"
        FROM "IPL"."IPL"."BALL_BY_BALL" bb
        JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
          ON bb."match_id" = bs."match_id" 
          AND bb."innings_no" = bs."innings_no" 
          AND bb."over_id" = bs."over_id" 
          AND bb."ball_id" = bs."ball_id"
        GROUP BY 
          bb."match_id", 
          LEAST(bb."striker", bb."non_striker"), 
          GREATEST(bb."striker", bb."non_striker")
      ) AS partnerships
      GROUP BY "match_id"
    ) AS max_p
      ON p."match_id" = max_p."match_id" 
      AND p."partnership_runs" = max_p."max_runs"
    LIMIT 100;
Answer:
match_id,batsman1_id,batsman2_id,partnership_runs
335988,19,23,73
335993,41,42,100
335996,24,26,70
335997,32,74,101
336000,28,64,55
335999,53,55,146
336003,40,42,98
336009,45,46,46
336011,6,8,52
336005,1,4,65
336015,10,11,44
336021,100,139,95
336023,20,23,89
336025,40,42,127
336030,95,103,80
336038,74,101,120
392186,48,133,45
392199,52,158,57
336043,74,101,64
392194,87,110,74
392196,27,161,65
392203,31,74,79
392217,47,154,51
392234,26,68,52
392237,6,9,70
419158,21,185,127
419167,79,208,63
548312,41,254,46
336006,40,41,110
336013,32,101,47
336026,44,46,40
336041,44,133,65
336033,100,139,128
392188,24,161,60
392211,88,187,73
392204,9,132,63
392207,21,23,67
392207,20,21,67
392213,9,46,121
392232,18,20,67
392239,17,197,40
419132,1,87,71
419138,8,9,62
419139,40,88,76
419142,109,185,147
419150,56,178,89
501209,54,187,81
501227,135,162,122
501235,40,87,37
548362,2,40,67
598075,19,21,140
392233,53,97,66
419117,161,214,120
419122,56,97,55
501259,88,100,110
548318,46,307,75
548322,208,221,93
548330,50,318,33
548334,183,187,173
598060,27,96,58
829726,221,372,102
829772,260,393,99
829794,17,383,83
733986,21,147,83
981004,8,162,142
392190,17,18,95
392222,18,23,81
392225,60,147,37
419111,191,204,123
419113,40,171,61
392243,6,96,69
336020,32,74,62
336024,25,100,131
336027,40,41,69
336044,17,21,99
392193,53,57,58
336042,54,112,69
392210,57,178,56
392218,31,183,41
392221,54,56,90
392224,88,110,52
392228,56,112,59
392235,110,135,85
419118,20,23,108
419128,11,46,52
419133,9,96,65
419146,32,229,71
419149,40,41,93
419162,208,210,60
419166,1,2,88
501206,57,133,62
501213,8,203,60
501216,19,185,50
501223,133,208,67
501225,88,100,66
501243,2,288,51
501243,17,104,51
548324,53,100,50
548373,2,40,98
548379,187,262,76
Query:
SELECT 
      bb."match_id", 
      bb."striker" AS "batsman_id", 
      SUM(bs."runs_scored") AS "runs_scored"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id" 
      AND bb."innings_no" = bs."innings_no" 
      AND bb."over_id" = bs."over_id" 
      AND bb."ball_id" = bs."ball_id"
    GROUP BY bb."match_id", bb."striker"
    LIMIT 100;
Answer:
match_id,batsman_id,runs_scored
335987,2,158
335987,9,8
335987,14,18
335988,19,116
335988,26,54
335988,21,32
335988,29,3
335989,30,7
335989,42,52
335989,32,17
335989,38,14
335990,43,8
335990,6,32
335990,9,25
335990,11,39
335990,49,28
335990,50,2
335991,60,0
335991,61,1
335992,33,5
335992,31,7
335992,26,20
335993,54,14
335998,5,16
336000,41,6
336002,5,2
335987,15,3
335988,23,31
335989,36,2
335991,62,10
335991,4,38
335991,5,13
335992,24,26
335992,32,76
335992,65,4
335994,46,43
335994,49,17
335994,73,1
335994,23,2
335996,48,2
335998,1,12
336000,87,39
336000,29,10
336000,66,1
336001,21,28
336002,46,37
336002,82,2
335990,48,20
335992,35,36
335994,19,5
335995,232,16
335996,46,21
335997,14,34
335999,44,18
335999,85,0
336000,27,40
336003,8,1
336007,9,31
336007,7,5
336011,76,31
336013,114,27
336012,70,20
336020,42,3
336029,61,3
335991,3,0
335996,49,22
335991,54,14
335991,2,5
335991,1,14
335992,25,16
335992,64,2
335992,66,0
335993,57,66
335994,21,53
335995,53,13
335996,64,12
335996,73,2
335997,51,2
335997,9,11
335997,32,61
335997,11,4
335997,15,17
335998,4,0
335998,83,3
336001,11,4
336001,6,0
336003,42,50
336004,76,15
335991,57,0
335991,58,6
335993,59,8
335993,60,12
335993,61,1
335994,18,81
335995,75,4
335996,26,94
335996,67,0
335996,78,4
335997,16,3
335998,18,70
End Exploring Related Columns
Task: Find the IDs of players who scored the highest number of partnership runs for each match. The output should include the IDs of two players, each with their individual scores and the total partnership score. For each pair, the player with the higher individual score should be listed as player 1, and the player with the lower score as player 2. In cases where both players have the same score, the player with the higher ID should be player 1, and the player with the lower ID should be player 2. There can be multiple rows for a single match.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To find the IDs of players who scored the highest number of partnership runs for each match, we identify the partnerships with the maximum total runs in each match. For each such partnership, we provide the match ID, the IDs of the two players involved along with their individual scores, and the total partnership score. The player with the higher individual score is listed as player1; if both players have the same score, the player with the higher ID is listed as player1.

```csv
match_id,player1_id,player1_score,player2_id,player2_score,partnership_score
match_id1:int,player1_id1:int,player1_score1:int,player2_id1:int,player2_score1:int,partnership_score1:int
match_id2:int,player1_id2:int,player1_score2:int,player2_id2:int,player2_score2:int,partnership_score2:int
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IPL': {'IPL': ['BALL_BY_BALL', 'BATSMAN_SCORED', 'EXTRA_RUNS', 'MATCH', 'PLAYER', 'PLAYER_MATCH', 'TEAM', 'WICKET_TAKEN']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 03:28:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 03:28:37 - root - INFO - To find the IDs of players who scored the highest number of partnership runs for each match, we identify the partnerships with the maximum total runs in each match. For each such partnership, we provide the match ID, the IDs of the two players involved along with their individual scores, and the total partnership score. The player with the higher individual score is listed as player1; if both players have the same score, the player with the higher ID is listed as player1.

```sql
WITH partnership_balls AS (
    SELECT
        bb."match_id",
        bb."innings_no",
        bb."over_id",
        bb."ball_id",
        bb."striker",
        bb."non_striker",
        bs."runs_scored",
        CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END AS "wicket_fell",
        SUM(CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END) OVER (
            PARTITION BY bb."match_id", bb."innings_no"
            ORDER BY bb."over_id", bb."ball_id"
            ROWS UNBOUNDED PRECEDING
        ) AS "partnership_no"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id"
        AND bb."innings_no" = bs."innings_no"
        AND bb."over_id" = bs."over_id"
        AND bb."ball_id" = bs."ball_id"
    LEFT JOIN "IPL"."IPL"."WICKET_TAKEN" wt
        ON bb."match_id" = wt."match_id"
        AND bb."innings_no" = wt."innings_no"
        AND bb."over_id" = wt."over_id"
        AND bb."ball_id" = wt."ball_id"
),
partnerships AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        FIRST_VALUE(pb."striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) AS "batsman1_id",
        FIRST_VALUE(pb."non_striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) AS "batsman2_id",
        SUM(pb."runs_scored") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
        ) AS "partnership_runs",
        SUM(CASE WHEN pb."striker" = FIRST_VALUE(pb."striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) THEN pb."runs_scored" ELSE 0 END) OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
        ) AS "batsman1_score",
        SUM(CASE WHEN pb."striker" = FIRST_VALUE(pb."non_striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) THEN pb."runs_scored" ELSE 0 END) OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
        ) AS "batsman2_score"
    FROM partnership_balls pb
),
partnerships_unique AS (
    SELECT DISTINCT
        "match_id",
        "innings_no",
        "partnership_no",
        "batsman1_id",
        "batsman2_id",
        "partnership_runs",
        "batsman1_score",
        "batsman2_score"
    FROM partnerships
),
max_partnerships AS (
    SELECT
        "match_id",
        MAX("partnership_runs") AS "max_partnership_runs"
    FROM partnerships_unique
    GROUP BY "match_id"
),
top_partnerships AS (
    SELECT
        p."match_id",
        p."batsman1_id",
        p."batsman1_score",
        p."batsman2_id",
        p."batsman2_score",
        p."partnership_runs",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player1_id",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player2_id",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player1_score",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player2_score"
    FROM partnerships_unique p
    JOIN max_partnerships mp
        ON p."match_id" = mp."match_id"
        AND p."partnership_runs" = mp."max_partnership_runs"
)
SELECT
    "match_id",
    "player1_id",
    "player1_score",
    "player2_id",
    "player2_score",
    "partnership_runs" AS "partnership_score"
FROM top_partnerships
ORDER BY "match_id";
```
2025-01-25 03:28:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:28:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:28:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:28:38 - snowflake.connector.connection - INFO - closed
2025-01-25 03:28:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:28:39 - root - INFO - itercount: 1
2025-01-25 03:28:39 - root - INFO - 002062 (42601): 01b9f070-0004-7d15-0001-11c300f9eaca: SQL compilation error:
Window function [FIRST_VALUE(PB."striker") OVER (PARTITION BY PB."match_id", PB."innings_no", PB."partnership_no" ORDER BY PB."over_id" ASC NULLS LAST, PB."ball_id" ASC NULLS LAST)] may not be nested inside another window function.
2025-01-25 03:28:39 - root - INFO - Input sql:
WITH partnership_balls AS (
    SELECT
        bb."match_id",
        bb."innings_no",
        bb."over_id",
        bb."ball_id",
        bb."striker",
        bb."non_striker",
        bs."runs_scored",
        CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END AS "wicket_fell",
        SUM(CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END) OVER (
            PARTITION BY bb."match_id", bb."innings_no"
            ORDER BY bb."over_id", bb."ball_id"
            ROWS UNBOUNDED PRECEDING
        ) AS "partnership_no"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id"
        AND bb."innings_no" = bs."innings_no"
        AND bb."over_id" = bs."over_id"
        AND bb."ball_id" = bs."ball_id"
    LEFT JOIN "IPL"."IPL"."WICKET_TAKEN" wt
        ON bb."match_id" = wt."match_id"
        AND bb."innings_no" = wt."innings_no"
        AND bb."over_id" = wt."over_id"
        AND bb."ball_id" = wt."ball_id"
),
partnerships AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        FIRST_VALUE(pb."striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) AS "batsman1_id",
        FIRST_VALUE(pb."non_striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) AS "batsman2_id",
        SUM(pb."runs_scored") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
        ) AS "partnership_runs",
        SUM(CASE WHEN pb."striker" = FIRST_VALUE(pb."striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) THEN pb."runs_scored" ELSE 0 END) OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
        ) AS "batsman1_score",
        SUM(CASE WHEN pb."striker" = FIRST_VALUE(pb."non_striker") OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
            ORDER BY pb."over_id", pb."ball_id"
        ) THEN pb."runs_scored" ELSE 0 END) OVER (
            PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
        ) AS "batsman2_score"
    FROM partnership_balls pb
),
partnerships_unique AS (
    SELECT DISTINCT
        "match_id",
        "innings_no",
        "partnership_no",
        "batsman1_id",
        "batsman2_id",
        "partnership_runs",
        "batsman1_score",
        "batsman2_score"
    FROM partnerships
),
max_partnerships AS (
    SELECT
        "match_id",
        MAX("partnership_runs") AS "max_partnership_runs"
    FROM partnerships_unique
    GROUP BY "match_id"
),
top_partnerships AS (
    SELECT
        p."match_id",
        p."batsman1_id",
        p."batsman1_score",
        p."batsman2_id",
        p."batsman2_score",
        p."partnership_runs",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player1_id",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player2_id",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player1_score",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player2_score"
    FROM partnerships_unique p
    JOIN max_partnerships mp
        ON p."match_id" = mp."match_id"
        AND p."partnership_runs" = mp."max_partnership_runs"
)
SELECT
    "match_id",
    "player1_id",
    "player1_score",
    "player2_id",
    "player2_score",
    "partnership_runs" AS "partnership_score"
FROM top_partnerships
ORDER BY "match_id";
The error information is:
002062 (42601): 01b9f070-0004-7d15-0001-11c300f9eaca: SQL compilation error:
Window function [FIRST_VALUE(PB."striker") OVER (PARTITION BY PB."match_id", PB."innings_no", PB."partnership_no" ORDER BY PB."over_id" ASC NULLS LAST, PB."ball_id" ASC NULLS LAST)] may not be nested inside another window function.
Please correct it and output only 1 complete SQL query.
2025-01-25 03:29:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 03:29:33 - root - INFO - ```sql
WITH partnership_balls AS (
    SELECT
        bb."match_id",
        bb."innings_no",
        bb."over_id",
        bb."ball_id",
        bb."striker",
        bb."non_striker",
        bs."runs_scored",
        CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END AS "wicket_fell",
        SUM(CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END) OVER (
            PARTITION BY bb."match_id", bb."innings_no"
            ORDER BY bb."over_id", bb."ball_id"
            ROWS UNBOUNDED PRECEDING
        ) AS "partnership_no"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id"
        AND bb."innings_no" = bs."innings_no"
        AND bb."over_id" = bs."over_id"
        AND bb."ball_id" = bs."ball_id"
    LEFT JOIN "IPL"."IPL"."WICKET_TAKEN" wt
        ON bb."match_id" = wt."match_id"
        AND bb."innings_no" = wt."innings_no"
        AND bb."over_id" = wt."over_id"
        AND bb."ball_id" = wt."ball_id"
),
first_ball_per_partnership AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker" AS "batsman1_id",
        pb."non_striker" AS "batsman2_id"
    FROM (
        SELECT
            pb.*,
            ROW_NUMBER() OVER (
                PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
                ORDER BY pb."over_id", pb."ball_id"
            ) AS rn
        FROM partnership_balls pb
    ) pb
    WHERE pb.rn = 1
),
partnership_runs AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        SUM(pb."runs_scored") AS "partnership_runs"
    FROM partnership_balls pb
    GROUP BY
        pb."match_id",
        pb."innings_no",
        pb."partnership_no"
),
batsman_runs_per_partnership AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker" AS "batsman_id",
        SUM(pb."runs_scored") AS "batsman_runs"
    FROM partnership_balls pb
    GROUP BY
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker"
),
partnerships_unique AS (
    SELECT
        fp."match_id",
        fp."innings_no",
        fp."partnership_no",
        fp."batsman1_id",
        fp."batsman2_id",
        pr."partnership_runs",
        COALESCE(b1."batsman_runs", 0) AS "batsman1_score",
        COALESCE(b2."batsman_runs", 0) AS "batsman2_score"
    FROM first_ball_per_partnership fp
    JOIN partnership_runs pr
        ON fp."match_id" = pr."match_id"
        AND fp."innings_no" = pr."innings_no"
        AND fp."partnership_no" = pr."partnership_no"
    LEFT JOIN batsman_runs_per_partnership b1
        ON fp."match_id" = b1."match_id"
        AND fp."innings_no" = b1."innings_no"
        AND fp."partnership_no" = b1."partnership_no"
        AND fp."batsman1_id" = b1."batsman_id"
    LEFT JOIN batsman_runs_per_partnership b2
        ON fp."match_id" = b2."match_id"
        AND fp."innings_no" = b2."innings_no"
        AND fp."partnership_no" = b2."partnership_no"
        AND fp."batsman2_id" = b2."batsman_id"
),
max_partnerships AS (
    SELECT
        "match_id",
        MAX("partnership_runs") AS "max_partnership_runs"
    FROM partnerships_unique
    GROUP BY "match_id"
),
top_partnerships AS (
    SELECT
        p."match_id",
        p."batsman1_id",
        p."batsman1_score",
        p."batsman2_id",
        p."batsman2_score",
        p."partnership_runs",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player1_id",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player2_id",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player1_score",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player2_score"
    FROM partnerships_unique p
    JOIN max_partnerships mp
        ON p."match_id" = mp."match_id"
        AND p."partnership_runs" = mp."max_partnership_runs"
)
SELECT
    "match_id",
    "player1_id",
    "player1_score",
    "player2_id",
    "player2_score",
    "partnership_runs" AS "partnership_score"
FROM top_partnerships
ORDER BY "match_id";
```
2025-01-25 03:29:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:29:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:29:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:29:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 574
2025-01-25 03:29:35 - snowflake.connector.connection - INFO - closed
2025-01-25 03:29:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:29:35 - root - INFO - itercount: 2
2025-01-25 03:29:35 - root - INFO - 0
2025-01-25 03:29:35 - root - INFO - results: 
match_id,player1_id,player1_score,player2_id,player2_score,partnership_score
335987,2,45,3,0,57
335988,19,42,22,0,73
335989,40,50,41,0,102
335990,9,16,8,0,54
335991,56,22,232,0,31
335992,32,30,34,0,66
335993,41,75,40,0,100
335994,18,41,19,0,94
335995,56,73,55,0,109
335996,24,16,29,0,70
335997,74,44,31,0,101
335998,18,36,17,0,79
335999,53,109,55,37,146
336000,28,40,26,0,55
336001,19,30,21,0,95
336002,46,37,96,0,101
336003,40,48,41,0,98
336004,100,31,27,0,76
336005,1,34,104,0,65
336006,41,71,40,39,110
336007,97,47,53,45,92
336008,4,58,63,0,104
336009,45,24,44,0,46
336010,101,32,74,27,59
336011,8,22,9,0,52
336012,53,41,97,0,52
336013,101,15,31,0,47
336014,40,60,110,0,112
336015,11,14,6,0,44
336016,31,68,74,35,103
336017,44,54,133,30,84
336018,23,44,21,0,88
336019,1,48,128,0,100
336020,74,21,33,0,62
336021,100,61,25,0,95
336022,103,28,1,0,37
336023,23,51,127,0,89
336024,100,80,25,51,131
336025,40,72,41,0,151
336026,44,31,133,0,40
336027,40,40,41,29,69
336028,101,50,74,40,90
336029,54,41,111,0,72
336030,103,53,1,0,80
336031,41,47,40,33,80
336032,33,29,32,0,77
336033,100,80,25,0,128
336034,107,29,17,24,53
336036,26,50,100,33,83
336037,44,47,133,18,65
336038,74,79,101,41,120
336039,55,37,97,0,94
336040,100,35,25,0,80
336041,44,38,133,27,65
336042,54,29,58,0,69
336043,101,39,74,25,64
336044,17,44,108,0,99
336045,32,27,69,0,61
392186,133,10,71,0,45
392187,158,19,46,0,35
392188,24,38,161,22,60
392189,97,31,55,0,67
392190,18,65,17,30,95
392191,162,32,2,21,53
392193,53,29,55,0,58
392194,110,65,88,0,74
392196,161,48,26,0,65
392197,133,34,44,0,73
392199,158,30,46,0,57
392200,26,33,64,0,72
392201,53,44,97,21,65
392202,133,68,44,51,119
392203,74,17,38,0,79
392204,132,43,9,20,63
392205,154,29,71,0,44
392206,135,31,40,0,72
392207,21,46,22,0,67
392207,21,38,17,0,67
392208,104,51,162,0,83
392209,27,50,24,19,69
392210,57,32,53,0,56
392211,187,26,135,0,73
392212,104,26,2,0,48
392213,9,55,7,0,121
392214,57,21,55,0,69
392215,74,77,183,56,133
392216,40,49,187,0,91
392217,47,29,133,0,51
392218,183,19,182,0,41
392219,18,46,21,0,95
392220,135,15,40,0,59
392221,56,58,57,0,89
392222,18,36,21,0,96
392223,85,44,44,0,103
392224,110,35,135,0,52
392225,147,17,56,0,37
392226,2,22,173,0,65
392227,71,37,85,0,78
392228,112,18,53,0,59
392229,52,18,46,0,56
392230,168,25,31,0,61
392231,27,18,139,0,51
392232,18,44,23,0,67
392233,53,43,97,23,66
392234,26,40,27,0,52
392235,110,52,41,0,85
392236,2,52,1,0,86
392237,9,32,46,0,70
392238,63,40,200,0,53
392239,17,25,197,15,40
392240,40,26,187,0,62
392241,97,45,53,15,60
392242,41,39,187,0,79
392243,96,37,177,0,69
392244,97,25,56,0,49
419111,204,58,104,0,123
419112,79,51,207,0,106
419113,40,35,88,0,61
419114,87,50,104,48,98
419115,97,45,55,0,86
419116,211,29,74,0,58
419117,214,75,161,45,120
419118,23,42,21,0,108
419119,79,34,133,0,68
419120,9,44,96,42,86
419121,18,52,23,0,73
419122,97,22,55,1,56
419123,104,21,87,0,50
419124,9,43,96,40,83
419125,57,35,56,0,60
419127,162,46,1,0,77
419128,46,41,216,0,52
419129,229,23,31,0,57
419130,21,78,17,0,133
419131,224,37,183,14,51
419132,1,30,236,0,71
419133,96,38,9,27,65
419134,183,36,224,0,53
419135,210,2,133,0,51
419136,187,74,88,0,127
419137,100,22,214,0,41
419138,9,28,46,0,62
419139,40,29,237,0,76
419140,1,54,87,0,73
419141,158,31,96,0,73
419142,185,85,21,0,147
419143,79,37,71,0,63
419144,64,58,214,0,96
419145,241,36,237,0,55
419146,229,36,183,0,71
419147,18,17,21,0,48
419148,224,83,183,21,104
419149,41,46,187,0,93
419150,178,36,57,0,89
419151,227,24,64,0,45
419152,178,34,57,0,44
419153,249,24,9,0,62
419154,26,21,64,0,42
419155,133,26,79,0,57
419156,57,36,97,0,77
419157,154,5,208,0,50
419158,185,49,18,0,127
419159,158,33,96,0,59
419160,40,43,88,0,68
419161,64,63,26,0,83
419162,210,14,133,0,60
419163,1,62,162,0,107
419164,100,53,27,0,97
419165,56,41,231,0,50
419166,2,46,1,42,88
419167,208,17,154,0,63
419168,23,17,21,0,47
419169,6,20,9,0,49
419170,21,47,23,0,69
501203,125,39,185,0,72
501204,192,35,6,0,56
501205,2,41,55,36,77
501206,133,35,208,0,62
501207,157,23,74,0,58
501208,9,30,214,19,49
501209,187,39,183,0,81
501210,133,46,263,0,109
501211,185,74,21,0,120
501212,104,38,17,0,84
501213,8,35,79,0,60
501214,9,76,214,0,151
501215,2,62,64,56,118
501216,185,31,19,19,50
501217,167,63,53,61,124
501218,187,45,41,22,67
501219,40,18,214,0,48
501220,2,25,64,0,50
501221,65,40,42,0,89
501223,133,34,275,0,67
501224,64,24,2,23,47
501225,100,45,167,0,66
501226,57,54,208,0,84
501227,162,84,135,38,122
501228,41,77,187,59,136
501229,57,56,221,0,100
501230,6,39,32,25,64
501231,19,32,185,31,63
501232,162,26,135,0,74
501233,23,30,185,0,64
501234,26,58,93,0,89
501235,40,10,132,0,37
501236,32,14,6,0,39
501237,8,40,162,0,66
501238,41,30,54,0,51
501239,40,39,216,0,73
501240,52,33,266,0,48
501241,65,56,42,10,66
501242,133,42,263,0,93
501243,2,37,288,14,51
501243,17,27,64,0,51
501244,31,42,40,0,75
501245,19,72,185,0,133
501246,96,25,27,0,39
501247,9,45,216,22,67
501248,41,55,285,0,66
501249,162,83,135,0,110
501250,23,31,19,0,61
501251,54,36,183,0,85
501252,162,44,135,21,65
501253,96,9,157,0,31
501254,19,46,185,28,74
501255,157,35,96,19,54
501256,53,22,167,0,52
501257,162,43,135,0,82
501258,23,41,185,0,91
501259,100,41,53,0,110
501260,87,15,40,0,51
501261,221,23,133,0,39
501262,167,51,53,0,97
501263,17,15,2,0,48
501264,65,31,42,28,59
501265,53,105,167,0,184
501266,19,20,23,0,36
501267,40,32,87,0,61
501268,32,89,6,43,132
501269,112,60,42,55,115
501271,162,44,110,0,75
501272,9,21,87,0,57
501273,21,26,185,0,60
501274,289,51,133,28,79
501275,162,62,260,41,103
501276,185,89,19,63,152
548311,304,50,133,14,64
548312,254,30,41,16,46
548313,275,15,57,0,47
548314,85,41,6,28,69
548315,110,34,175,0,52
548316,71,39,35,0,41
548317,266,20,132,0,64
548318,307,45,157,0,75
548319,57,27,304,0,46
548320,40,18,9,0,64
548321,158,40,41,0,60
548322,208,29,304,0,93
548323,162,62,260,0,100
548324,53,21,167,0,50
548325,132,23,6,0,53
548326,42,35,26,0,69
548327,157,21,307,0,65
548328,236,27,100,0,52
548329,85,55,6,0,115
548330,50,25,88,0,33
548331,26,44,42,42,86
548332,157,34,46,26,60
548333,40,22,214,0,52
548334,187,109,41,0,173
548335,303,58,23,57,115
548336,162,73,79,0,125
548337,204,43,6,0,79
548338,157,41,46,0,82
548339,275,40,57,0,74
548340,42,19,26,0,41
548341,135,47,162,0,106
548342,96,80,1,0,140
548344,4,48,100,0,82
548346,10,53,26,0,71
548347,41,72,64,55,127
548348,236,32,100,32,64
548349,40,49,2,43,92
548350,85,55,6,40,95
548351,17,19,42,16,35
548352,40,34,2,0,60
548353,10,65,42,0,147
548354,41,55,64,0,91
548355,162,71,260,0,116
548356,275,25,133,23,48
548357,42,28,17,0,67
548358,40,56,2,42,98
548359,6,31,85,0,67
548360,133,67,275,0,124
548361,135,62,162,26,88
548362,40,36,2,31,67
548363,32,38,6,0,56
548364,236,30,100,22,52
548365,162,55,135,0,91
548366,109,18,35,0,36
548367,162,57,135,17,74
548368,97,53,133,0,162
548369,19,38,185,36,74
548370,85,36,6,0,94
548371,42,44,26,0,91
548372,208,64,147,0,116
548373,40,61,2,36,97
548374,64,23,52,0,57
548375,87,27,40,0,40
548376,236,24,53,23,47
548377,162,127,135,0,200
548378,331,33,42,26,59
548379,187,58,262,18,76
548380,2,25,9,0,62
548381,154,53,26,0,68
548382,147,87,133,58,145
548383,31,31,9,0,55
548384,19,43,21,0,90
548385,185,42,19,0,69
548386,214,88,40,0,129
598003,40,23,214,0,46
598004,162,48,339,0,67
598005,46,24,96,10,34
598006,187,43,64,0,63
598007,221,41,147,0,62
598008,236,26,53,0,58
598010,85,12,255,0,37
598011,88,86,133,0,124
598012,19,86,185,50,136
598013,162,54,8,0,76
598014,85,30,341,0,78
598015,17,19,331,0,44
598016,57,47,88,0,66
598017,8,37,260,0,78
598018,9,16,40,0,63
598019,85,20,104,0,47
598020,254,67,46,24,91
598021,40,60,9,0,100
598023,46,22,254,16,38
598024,32,31,85,25,56
598025,19,28,21,0,72
598026,331,19,355,0,48
598027,40,25,31,18,43
598028,162,26,110,0,51
598029,41,90,64,59,149
598030,236,47,345,0,127
598031,19,36,185,0,87
598032,162,127,135,33,160
598033,53,42,100,14,56
598034,87,20,9,0,51
598035,19,44,185,18,62
598036,214,24,9,0,66
598037,6,30,85,0,72
598038,147,46,133,0,63
598039,19,63,62,39,102
598040,46,37,254,35,72
598041,351,41,6,0,66
598042,57,63,147,0,83
598043,21,39,62,0,73
598044,42,47,26,0,72
598045,262,33,64,0,94
598046,100,46,4,0,94
598047,110,41,79,0,68
598048,9,28,214,0,77
598049,42,22,17,11,33
598050,162,74,203,0,129
598051,57,31,208,0,56
598052,6,58,85,37,95
598053,10,36,26,0,76
598054,6,53,85,44,97
598055,133,48,147,41,89
598056,19,52,185,0,127
598057,53,42,236,0,96
598058,40,31,214,12,43
598059,8,61,163,0,93
598060,96,26,46,0,58
598061,17,21,166,0,47
598062,9,15,31,0,33
598063,32,57,6,0,92
598064,236,24,53,0,42
598065,57,17,208,0,83
598066,31,56,40,0,98
598067,20,31,21,0,55
598068,207,51,305,0,72
598069,320,93,4,0,120
598070,327,25,340,0,48
598071,321,79,53,0,142
598072,191,25,27,0,69
598073,8,35,162,28,63
598074,17,45,42,42,87
598075,19,58,185,0,140
598076,42,19,340,0,50
598077,207,35,147,33,68
598078,208,15,88,0,47
729284,9,61,40,0,125
729286,154,61,185,0,104
729288,2,67,147,44,111
729290,85,41,32,0,75
729292,17,52,27,0,97
729294,96,45,40,0,60
729296,203,21,62,0,110
729298,147,16,2,0,51
729300,305,56,203,0,66
729302,147,28,2,6,34
729304,9,33,96,0,78
729306,254,69,42,0,127
729308,372,38,207,0,84
729310,48,8,339,0,32
729312,41,16,320,0,27
729312,336,13,9,0,27
729312,41,12,62,0,27
729314,185,30,355,0,44
729316,147,42,2,40,82
729318,110,17,17,0,41
729322,354,34,254,0,99
733976,2,38,147,0,69
733978,62,18,203,0,63
733980,339,15,85,0,49
733982,42,27,354,0,58
733984,46,65,40,54,119
733986,147,37,2,0,83
733988,57,50,372,0,93
733990,46,47,40,47,94
733992,305,84,41,0,131
733994,42,33,254,3,36
733996,320,39,197,0,52
733998,88,35,260,0,52
734000,147,43,2,0,87
734002,40,45,46,0,81
734004,110,43,384,0,126
734006,383,67,360,0,130
734008,314,30,32,21,51
734010,27,59,110,0,74
734012,345,36,41,0,90
734014,46,33,40,14,47
734016,85,32,309,0,71
734018,21,47,147,0,72
734020,46,38,40,0,50
734022,383,62,19,55,117
734024,158,42,185,0,68
734026,42,50,187,46,96
734028,46,42,40,21,63
734030,383,55,19,6,61
734032,46,58,31,0,118
734034,187,90,42,22,112
734036,87,40,88,0,81
734038,100,31,345,1,57
734040,303,22,21,0,71
734042,42,24,187,0,50
734044,345,42,305,0,83
734046,351,49,32,0,99
734048,46,41,40,0,62
734050,21,46,2,0,86
734052,41,69,345,34,103
734054,345,46,197,0,123
829710,57,75,208,0,130
829712,109,27,393,0,47
829714,394,30,255,0,47
829716,2,9,21,0,62
829716,2,35,147,27,62
829718,40,44,46,35,79
829720,85,13,255,0,50
829722,398,32,221,0,96
829724,187,57,42,24,81
829726,372,32,262,0,102
829728,46,52,308,0,107
829730,260,46,154,0,100
829732,85,33,351,26,59
829734,147,56,2,46,102
829736,393,47,260,0,73
829738,31,28,284,0,94
829740,32,73,85,70,143
829742,383,32,17,0,66
829744,40,25,308,0,65
829748,187,91,42,36,127
829750,147,35,2,0,56
829752,393,82,260,0,148
829754,8,51,162,0,98
829756,383,29,262,0,51
829758,2,42,147,0,57
829762,162,62,8,35,97
829764,163,17,187,0,45
829764,187,36,42,0,45
829766,393,35,87,25,60
829770,46,38,40,0,50
829772,393,54,260,45,99
829774,208,34,57,0,58
829776,8,24,162,21,45
829778,187,61,42,22,83
829780,17,59,383,50,109
829782,85,50,32,0,111
829784,8,39,236,0,62
829786,40,31,46,21,52
829788,57,32,50,0,56
829790,162,80,8,32,112
829792,216,46,42,0,52
829794,17,45,383,38,83
829796,62,19,345,0,62
829798,237,62,154,0,88
829800,8,76,162,0,209
829802,2,64,21,0,93
829804,187,35,42,0,63
829806,393,37,154,0,69
829808,320,14,305,0,43
829810,221,24,57,0,85
829812,187,40,42,0,97
829814,303,52,2,0,86
829816,32,38,85,36,74
829820,17,50,383,48,98
829822,383,52,17,35,87
829824,110,65,8,0,107
829826,19,36,21,0,47
829828,383,67,17,0,117
980906,85,40,303,34,74
980908,46,35,40,24,59
980910,345,38,185,37,75
980912,8,71,162,0,153
980914,40,44,46,0,96
980916,303,48,85,0,85
980918,355,48,393,0,81
980920,40,50,46,38,88
980922,254,22,2,0,49
980924,345,51,185,44,95
980926,355,74,351,0,128
980928,208,26,407,0,61
980930,46,53,40,22,75
980932,57,43,17,0,74
980934,187,74,42,53,127
980936,8,61,354,0,144
980938,351,43,339,0,68
980940,187,59,42,28,87
980942,8,67,110,0,118
980944,85,25,303,0,56
980946,17,68,57,0,133
980948,303,30,85,0,68
980950,2,58,147,53,111
980952,57,18,407,0,69
980954,85,42,79,0,107
980956,339,53,351,0,98
980958,187,76,42,0,121
980960,185,36,409,27,63
980962,79,36,85,0,81
980964,31,45,96,0,84
980966,420,69,355,44,113
980968,40,54,46,46,100
980970,426,30,85,29,59
980972,254,24,2,0,42
980974,85,51,426,0,112
980976,355,52,351,15,67
980978,42,44,396,0,83
980980,276,66,308,0,129
980982,110,61,32,0,88
980984,197,27,426,1,50
980986,57,24,17,0,55
980988,351,31,355,0,70
980990,185,50,427,0,106
980992,8,97,162,0,226
980994,96,12,40,0,49
980996,187,39,42,25,64
980998,415,33,57,0,93
981000,8,54,162,0,113
981002,85,33,426,0,41
981004,162,73,8,69,142
981006,21,21,88,0,47
981008,420,31,355,0,70
981010,185,31,62,0,58
981012,2,48,254,0,93
981014,96,44,40,0,85
981016,8,28,110,0,66
981018,110,51,255,0,84
981020,187,26,42,0,57
981022,254,35,147,0,51
981024,162,76,8,32,108


2025-01-25 03:29:35 - root - INFO - Please check the answer again by reviewing Find the IDs of players who scored the highest number of partnership runs for each match. The output should include the IDs of two players, each with their individual scores and the total partnership score. For each pair, the player with the higher individual score should be listed as player 1, and the player with the lower score as player 2. In cases where both players have the same score, the player with the higher ID should be player 1, and the player with the lower ID should be player 2. There can be multiple rows for a single match., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To find the IDs of players who scored the highest number of partnership runs for each match, we identify the partnerships with the maximum total runs in each match. For each such partnership, we provide the match ID, the IDs of the two players involved along with their individual scores, and the total partnership score. The player with the higher individual score is listed as player1; if both players have the same score, the player with the higher ID is listed as player1.

```csv
match_id,player1_id,player1_score,player2_id,player2_score,partnership_score
match_id1:int,player1_id1:int,player1_score1:int,player2_id1:int,player2_score1:int,partnership_score1:int
match_id2:int,player1_id2:int,player1_score2:int,player2_id2:int,player2_score2:int,partnership_score2:int
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
match_id,player1_id,player1_score,player2_id,player2_score,partnership_score
335987,2,45,3,0,57
335988,19,42,22,0,73
335989,40,50,41,0,102
335990,9,16,8,0,54
335991,56,22,232,0,31
335992,32,30,34,0,66
335993,41,75,40,0,100
335994,18,41,19,0,94
335995,56,73,55,0,109
335996,24,16,29,0,70
335997,74,44,31,0,101
335998,18,36,17,0,79
335999,53,109,55,37,146
336000,28,40,26,0,55
336001,19,30,21,0,95
336002,46,37,96,0,101
336003,40,48,41,0,98
336004,100,31,27,0,76
336005,1,34,104,0,65
336006,41,71,40,39,110
336007,97,47,53,45,92
336008,4,58,63,0,104
336009,45,24,44,0,46
336010,101,32,74,27,59
336011,8,22,9,0,52
336012,53,41,97,0,52
336013,101,15,31,0,47
336014,40,60,110,0,112
336015,11,14,6,0,44
336016,31,68,74,35,103
336017,44,54,133,30,84
336018,23,44,21,0,88
336019,1,48,128,0,100
336020,74,21,33,0,62
336021,100,61,25,0,95
336022,103,28,1,0,37
336023,23,51,127,0,89
336024,100,80,25,51,131
336025,40,72,41,0,151
336026,44,31,133,0,40
336027,40,40,41,29,69
336028,101,50,74,40,90
336029,54,41,111,0,72
336030,103,53,1,0,80
336031,41,47,40,33,80
336032,33,29,32,0,77
336033,100,80,25,0,128
336034,107,29,17,24,53
336036,26,50,100,33,83
336037,44,47,133,18,65
336038,74,79,101,41,120
336039,55,37,97,0,94
336040,100,35,25,0,80
336041,44,38,133,27,65
336042,54,29,58,0,69
336043,101,39,74,25,64
336044,17,44,108,0,99
336045,32,27,69,0,61
392186,133,10,71,0,45
392187,158,19,46,0,35
392188,24,38,161,22,60
392189,97,31,55,0,67
392190,18,65,17,30,95
392191,162,32,2,21,53
392193,53,29,55,0,58
392194,110,65,88,0,74
392196,161,48,26,0,65
392197,133,34,44,0,73
392199,158,30,46,0,57
392200,26,33,64,0,72
392201,53,44,97,21,65
392202,133,68,44,51,119
392203,74,17,38,0,79
392204,132,43,9,20,63
392205,154,29,71,0,44
392206,135,31,40,0,72
392207,21,46,22,0,67
392207,21,38,17,0,67
392208,104,51,162,0,83
392209,27,50,24,19,69
392210,57,32,53,0,56
392211,187,26,135,0,73
392212,104,26,2,0,48
392213,9,55,7,0,121
392214,57,21,55,0,69
392215,74,77,183,56,133
392216,40,49,187,0,91
392217,47,29,133,0,51
392218,183,19,182,0,41
392219,18,46,21,0,95
392220,135,15,40,0,59
392221,56,58,57,0,89
392222,18,36,21,0,96
392223,85,44,44,0,103
392224,110,35,135,0,52
392225,147,17,56,0,37
392226,2,22,173,0,65
392227,71,37,85,0,78
392228,112,18,53,0,59
392229,52,18,46,0,56
392230,168,25,31,0,61
392231,27,18,139,0,51
392232,18,44,23,0,67
392233,53,43,97,23,66
392234,26,40,27,0,52
392235,110,52,41,0,85
392236,2,52,1,0,86
392237,9,32,46,0,70
392238,63,40,200,0,53
392239,17,25,197,15,40
392240,40,26,187,0,62
392241,97,45,53,15,60
392242,41,39,187,0,79
392243,96,37,177,0,69
392244,97,25,56,0,49
419111,204,58,104,0,123
419112,79,51,207,0,106
419113,40,35,88,0,61
419114,87,50,104,48,98
419115,97,45,55,0,86
419116,211,29,74,0,58
419117,214,75,161,45,120
419118,23,42,21,0,108
419119,79,34,133,0,68
419120,9,44,96,42,86
419121,18,52,23,0,73
419122,97,22,55,1,56
419123,104,21,87,0,50
419124,9,43,96,40,83
419125,57,35,56,0,60
419127,162,46,1,0,77
419128,46,41,216,0,52
419129,229,23,31,0,57
419130,21,78,17,0,133
419131,224,37,183,14,51
419132,1,30,236,0,71
419133,96,38,9,27,65
419134,183,36,224,0,53
419135,210,2,133,0,51
419136,187,74,88,0,127
419137,100,22,214,0,41
419138,9,28,46,0,62
419139,40,29,237,0,76
419140,1,54,87,0,73
419141,158,31,96,0,73
419142,185,85,21,0,147
419143,79,37,71,0,63
419144,64,58,214,0,96
419145,241,36,237,0,55
419146,229,36,183,0,71
419147,18,17,21,0,48
419148,224,83,183,21,104
419149,41,46,187,0,93
419150,178,36,57,0,89
419151,227,24,64,0,45
419152,178,34,57,0,44
419153,249,24,9,0,62
419154,26,21,64,0,42
419155,133,26,79,0,57
419156,57,36,97,0,77
419157,154,5,208,0,50
419158,185,49,18,0,127
419159,158,33,96,0,59
419160,40,43,88,0,68
419161,64,63,26,0,83
419162,210,14,133,0,60
419163,1,62,162,0,107
419164,100,53,27,0,97
419165,56,41,231,0,50
419166,2,46,1,42,88
419167,208,17,154,0,63
419168,23,17,21,0,47
419169,6,20,9,0,49
419170,21,47,23,0,69
501203,125,39,185,0,72
501204,192,35,6,0,56
501205,2,41,55,36,77
501206,133,35,208,0,62
501207,157,23,74,0,58
501208,9,30,214,19,49
501209,187,39,183,0,81
501210,133,46,263,0,109
501211,185,74,21,0,120
501212,104,38,17,0,84
501213,8,35,79,0,60
501214,9,76,214,0,151
501215,2,62,64,56,118
501216,185,31,19,19,50
501217,167,63,53,61,124
501218,187,45,41,22,67
501219,40,18,214,0,48
501220,2,25,64,0,50
501221,65,40,42,0,89
501223,133,34,275,0,67
501224,64,24,2,23,47
501225,100,45,167,0,66
501226,57,54,208,0,84
501227,162,84,135,38,122
501228,41,77,187,59,136
501229,57,56,221,0,100
501230,6,39,32,25,64
501231,19,32,185,31,63
501232,162,26,135,0,74
501233,23,30,185,0,64
501234,26,58,93,0,89
501235,40,10,132,0,37
501236,32,14,6,0,39
501237,8,40,162,0,66
501238,41,30,54,0,51
501239,40,39,216,0,73
501240,52,33,266,0,48
501241,65,56,42,10,66
501242,133,42,263,0,93
501243,2,37,288,14,51
501243,17,27,64,0,51
501244,31,42,40,0,75
501245,19,72,185,0,133
501246,96,25,27,0,39
501247,9,45,216,22,67
501248,41,55,285,0,66
501249,162,83,135,0,110
501250,23,31,19,0,61
501251,54,36,183,0,85
501252,162,44,135,21,65
501253,96,9,157,0,31
501254,19,46,185,28,74
501255,157,35,96,19,54
501256,53,22,167,0,52
501257,162,43,135,0,82
501258,23,41,185,0,91
501259,100,41,53,0,110
501260,87,15,40,0,51
501261,221,23,133,0,39
501262,167,51,53,0,97
501263,17,15,2,0,48
501264,65,31,42,28,59
501265,53,105,167,0,184
501266,19,20,23,0,36
501267,40,32,87,0,61
501268,32,89,6,43,132
501269,112,60,42,55,115
501271,162,44,110,0,75
501272,9,21,87,0,57
501273,21,26,185,0,60
501274,289,51,133,28,79
501275,162,62,260,41,103
501276,185,89,19,63,152
548311,304,50,133,14,64
548312,254,30,41,16,46
548313,275,15,57,0,47
548314,85,41,6,28,69
548315,110,34,175,0,52
548316,71,39,35,0,41
548317,266,20,132,0,64
548318,307,45,157,0,75
548319,57,27,304,0,46
548320,40,18,9,0,64
548321,158,40,41,0,60
548322,208,29,304,0,93
548323,162,62,260,0,100
548324,53,21,167,0,50
548325,132,23,6,0,53
548326,42,35,26,0,69
548327,157,21,307,0,65
548328,236,27,100,0,52
548329,85,55,6,0,115
548330,50,25,88,0,33
548331,26,44,42,42,86
548332,157,34,46,26,60
548333,40,22,214,0,52
548334,187,109,41,0,173
548335,303,58,23,57,115
548336,162,73,79,0,125
548337,204,43,6,0,79
548338,157,41,46,0,82
548339,275,40,57,0,74
548340,42,19,26,0,41
548341,135,47,162,0,106
548342,96,80,1,0,140
548344,4,48,100,0,82
548346,10,53,26,0,71
548347,41,72,64,55,127
548348,236,32,100,32,64
548349,40,49,2,43,92
548350,85,55,6,40,95
548351,17,19,42,16,35
548352,40,34,2,0,60
548353,10,65,42,0,147
548354,41,55,64,0,91
548355,162,71,260,0,116
548356,275,25,133,23,48
548357,42,28,17,0,67
548358,40,56,2,42,98
548359,6,31,85,0,67
548360,133,67,275,0,124
548361,135,62,162,26,88
548362,40,36,2,31,67
548363,32,38,6,0,56
548364,236,30,100,22,52
548365,162,55,135,0,91
548366,109,18,35,0,36
548367,162,57,135,17,74
548368,97,53,133,0,162
548369,19,38,185,36,74
548370,85,36,6,0,94
548371,42,44,26,0,91
548372,208,64,147,0,116
548373,40,61,2,36,97
548374,64,23,52,0,57
548375,87,27,40,0,40
548376,236,24,53,23,47
548377,162,127,135,0,200
548378,331,33,42,26,59
548379,187,58,262,18,76
548380,2,25,9,0,62
548381,154,53,26,0,68
548382,147,87,133,58,145
548383,31,31,9,0,55
548384,19,43,21,0,90
548385,185,42,19,0,69
548386,214,88,40,0,129
598003,40,23,214,0,46
598004,162,48,339,0,67
598005,46,24,96,10,34
598006,187,43,64,0,63
598007,221,41,147,0,62
598008,236,26,53,0,58
598010,85,12,255,0,37
598011,88,86,133,0,124
598012,19,86,185,50,136
598013,162,54,8,0,76
598014,85,30,341,0,78
598015,17,19,331,0,44
598016,57,47,88,0,66
598017,8,37,260,0,78
598018,9,16,40,0,63
598019,85,20,104,0,47
598020,254,67,46,24,91
598021,40,60,9,0,100
598023,46,22,254,16,38
598024,32,31,85,25,56
598025,19,28,21,0,72
598026,331,19,355,0,48
598027,40,25,31,18,43
598028,162,26,110,0,51
598029,41,90,64,59,149
598030,236,47,345,0,127
598031,19,36,185,0,87
598032,162,127,135,33,160
598033,53,42,100,14,56
598034,87,20,9,0,51
598035,19,44,185,18,62
598036,214,24,9,0,66
598037,6,30,85,0,72
598038,147,46,133,0,63
598039,19,63,62,39,102
598040,46,37,254,35,72
598041,351,41,6,0,66
598042,57,63,147,0,83
598043,21,39,62,0,73
598044,42,47,26,0,72
598045,262,33,64,0,94
598046,100,46,4,0,94
598047,110,41,79,0,68
598048,9,28,214,0,77
598049,42,22,17,11,33
598050,162,74,203,0,129
598051,57,31,208,0,56
598052,6,58,85,37,95
598053,10,36,26,0,76
598054,6,53,85,44,97
598055,133,48,147,41,89
598056,19,52,185,0,127
598057,53,42,236,0,96
598058,40,31,214,12,43
598059,8,61,163,0,93
598060,96,26,46,0,58
598061,17,21,166,0,47
598062,9,15,31,0,33
598063,32,57,6,0,92
598064,236,24,53,0,42
598065,57,17,208,0,83
598066,31,56,40,0,98
598067,20,31,21,0,55
598068,207,51,305,0,72
598069,320,93,4,0,120
598070,327,25,340,0,48
598071,321,79,53,0,142
598072,191,25,27,0,69
598073,8,35,162,28,63
598074,17,45,42,42,87
598075,19,58,185,0,140
598076,42,19,340,0,50
598077,207,35,147,33,68
598078,208,15,88,0,47
729284,9,61,40,0,125
729286,154,61,185,0,104
729288,2,67,147,44,111
729290,85,41,32,0,75
729292,17,52,27,0,97
729294,96,45,40,0,60
729296,203,21,62,0,110
729298,147,16,2,0,51
729300,305,56,203,0,66
729302,147,28,2,6,34
729304,9,33,96,0,78
729306,254,69,42,0,127
729308,372,38,207,0,84
729310,48,8,339,0,32
729312,41,16,320,0,27
729312,336,13,9,0,27
729312,41,12,62,0,27
729314,185,30,355,0,44
729316,147,42,2,40,82
729318,110,17,17,0,41
729322,354,34,254,0,99
733976,2,38,147,0,69
733978,62,18,203,0,63
733980,339,15,85,0,49
733982,42,27,354,0,58
733984,46,65,40,54,119
733986,147,37,2,0,83
733988,57,50,372,0,93
733990,46,47,40,47,94
733992,305,84,41,0,131
733994,42,33,254,3,36
733996,320,39,197,0,52
733998,88,35,260,0,52
734000,147,43,2,0,87
734002,40,45,46,0,81
734004,110,43,384,0,126
734006,383,67,360,0,130
734008,314,30,32,21,51
734010,27,59,110,0,74
734012,345,36,41,0,90
734014,46,33,40,14,47
734016,85,32,309,0,71
734018,21,47,147,0,72
734020,46,38,40,0,50
734022,383,62,19,55,117
734024,158,42,185,0,68
734026,42,50,187,46,96
734028,46,42,40,21,63
734030,383,55,19,6,61
734032,46,58,31,0,118
734034,187,90,42,22,112
734036,87,40,88,0,81
734038,100,31,345,1,57
734040,303,22,21,0,71
734042,42,24,187,0,50
734044,345,42,30
Current sql:
WITH partnership_balls AS (
    SELECT
        bb."match_id",
        bb."innings_no",
        bb."over_id",
        bb."ball_id",
        bb."striker",
        bb."non_striker",
        bs."runs_scored",
        CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END AS "wicket_fell",
        SUM(CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END) OVER (
            PARTITION BY bb."match_id", bb."innings_no"
            ORDER BY bb."over_id", bb."ball_id"
            ROWS UNBOUNDED PRECEDING
        ) AS "partnership_no"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id"
        AND bb."innings_no" = bs."innings_no"
        AND bb."over_id" = bs."over_id"
        AND bb."ball_id" = bs."ball_id"
    LEFT JOIN "IPL"."IPL"."WICKET_TAKEN" wt
        ON bb."match_id" = wt."match_id"
        AND bb."innings_no" = wt."innings_no"
        AND bb."over_id" = wt."over_id"
        AND bb."ball_id" = wt."ball_id"
),
first_ball_per_partnership AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker" AS "batsman1_id",
        pb."non_striker" AS "batsman2_id"
    FROM (
        SELECT
            pb.*,
            ROW_NUMBER() OVER (
                PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
                ORDER BY pb."over_id", pb."ball_id"
            ) AS rn
        FROM partnership_balls pb
    ) pb
    WHERE pb.rn = 1
),
partnership_runs AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        SUM(pb."runs_scored") AS "partnership_runs"
    FROM partnership_balls pb
    GROUP BY
        pb."match_id",
        pb."innings_no",
        pb."partnership_no"
),
batsman_runs_per_partnership AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker" AS "batsman_id",
        SUM(pb."runs_scored") AS "batsman_runs"
    FROM partnership_balls pb
    GROUP BY
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker"
),
partnerships_unique AS (
    SELECT
        fp."match_id",
        fp."innings_no",
        fp."partnership_no",
        fp."batsman1_id",
        fp."batsman2_id",
        pr."partnership_runs",
        COALESCE(b1."batsman_runs", 0) AS "batsman1_score",
        COALESCE(b2."batsman_runs", 0) AS "batsman2_score"
    FROM first_ball_per_partnership fp
    JOIN partnership_runs pr
        ON fp."match_id" = pr."match_id"
        AND fp."innings_no" = pr."innings_no"
        AND fp."partnership_no" = pr."partnership_no"
    LEFT JOIN batsman_runs_per_partnership b1
        ON fp."match_id" = b1."match_id"
        AND fp."innings_no" = b1."innings_no"
        AND fp."partnership_no" = b1."partnership_no"
        AND fp."batsman1_id" = b1."batsman_id"
    LEFT JOIN batsman_runs_per_partnership b2
        ON fp."match_id" = b2."match_id"
        AND fp."innings_no" = b2."innings_no"
        AND fp."partnership_no" = b2."partnership_no"
        AND fp."batsman2_id" = b2."batsman_id"
),
max_partnerships AS (
    SELECT
        "match_id",
        MAX("partnership_runs") AS "max_partnership_runs"
    FROM partnerships_unique
    GROUP BY "match_id"
),
top_partnerships AS (
    SELECT
        p."match_id",
        p."batsman1_id",
        p."batsman1_score",
        p."batsman2_id",
        p."batsman2_score",
        p."partnership_runs",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player1_id",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player2_id",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player1_score",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player2_score"
    FROM partnerships_unique p
    JOIN max_partnerships mp
        ON p."match_id" = mp."match_id"
        AND p."partnership_runs" = mp."max_partnership_runs"
)
SELECT
    "match_id",
    "player1_id",
    "player1_score",
    "player2_id",
    "player2_score",
    "partnership_runs" AS "partnership_score"
FROM top_partnerships
ORDER BY "match_id";
2025-01-25 03:30:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 03:30:41 - root - INFO - ```sql
WITH partnership_balls AS (
    SELECT
        bb."match_id",
        bb."innings_no",
        bb."over_id",
        bb."ball_id",
        bb."striker",
        bb."non_striker",
        bs."runs_scored",
        CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END AS "wicket_fell",
        SUM(CASE WHEN wt."player_out" IS NOT NULL THEN 1 ELSE 0 END) OVER (
            PARTITION BY bb."match_id", bb."innings_no"
            ORDER BY bb."over_id", bb."ball_id"
            ROWS UNBOUNDED PRECEDING
        ) AS "partnership_no"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
        ON bb."match_id" = bs."match_id"
        AND bb."innings_no" = bs."innings_no"
        AND bb."over_id" = bs."over_id"
        AND bb."ball_id" = bs."ball_id"
    LEFT JOIN "IPL"."IPL"."WICKET_TAKEN" wt
        ON bb."match_id" = wt."match_id"
        AND bb."innings_no" = wt."innings_no"
        AND bb."over_id" = wt."over_id"
        AND bb."ball_id" = wt."ball_id"
),
first_ball_per_partnership AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker" AS "batsman1_id",
        pb."non_striker" AS "batsman2_id"
    FROM (
        SELECT
            pb.*,
            ROW_NUMBER() OVER (
                PARTITION BY pb."match_id", pb."innings_no", pb."partnership_no"
                ORDER BY pb."over_id", pb."ball_id"
            ) AS rn
        FROM partnership_balls pb
    ) pb
    WHERE pb.rn = 1
),
partnership_runs AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        SUM(pb."runs_scored") AS "partnership_runs"
    FROM partnership_balls pb
    GROUP BY
        pb."match_id",
        pb."innings_no",
        pb."partnership_no"
),
batsman_runs_per_partnership AS (
    SELECT
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker" AS "batsman_id",
        SUM(pb."runs_scored") AS "batsman_runs"
    FROM partnership_balls pb
    GROUP BY
        pb."match_id",
        pb."innings_no",
        pb."partnership_no",
        pb."striker"
),
partnerships_unique AS (
    SELECT
        fp."match_id",
        fp."innings_no",
        fp."partnership_no",
        fp."batsman1_id",
        fp."batsman2_id",
        pr."partnership_runs",
        COALESCE(b1."batsman_runs", 0) AS "batsman1_score",
        COALESCE(b2."batsman_runs", 0) AS "batsman2_score"
    FROM first_ball_per_partnership fp
    JOIN partnership_runs pr
        ON fp."match_id" = pr."match_id"
        AND fp."innings_no" = pr."innings_no"
        AND fp."partnership_no" = pr."partnership_no"
    LEFT JOIN batsman_runs_per_partnership b1
        ON fp."match_id" = b1."match_id"
        AND fp."innings_no" = b1."innings_no"
        AND fp."partnership_no" = b1."partnership_no"
        AND fp."batsman1_id" = b1."batsman_id"
    LEFT JOIN batsman_runs_per_partnership b2
        ON fp."match_id" = b2."match_id"
        AND fp."innings_no" = b2."innings_no"
        AND fp."partnership_no" = b2."partnership_no"
        AND fp."batsman2_id" = b2."batsman_id"
),
max_partnerships AS (
    SELECT
        "match_id",
        MAX("partnership_runs") AS "max_partnership_runs"
    FROM partnerships_unique
    GROUP BY "match_id"
),
top_partnerships AS (
    SELECT
        p."match_id",
        p."batsman1_id",
        p."batsman1_score",
        p."batsman2_id",
        p."batsman2_score",
        p."partnership_runs",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player1_id",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_id"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_id"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_id"
            ELSE p."batsman2_id"
        END AS "player2_id",
        CASE
            WHEN p."batsman1_score" > p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" > p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" > p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player1_score",
        CASE
            WHEN p."batsman1_score" < p."batsman2_score" THEN p."batsman1_score"
            WHEN p."batsman2_score" < p."batsman1_score" THEN p."batsman2_score"
            WHEN p."batsman1_id" < p."batsman2_id" THEN p."batsman1_score"
            ELSE p."batsman2_score"
        END AS "player2_score"
    FROM partnerships_unique p
    JOIN max_partnerships mp
        ON p."match_id" = mp."match_id"
        AND p."partnership_runs" = mp."max_partnership_runs"
)
SELECT
    "match_id",
    "player1_id",
    "player1_score",
    "player2_id",
    "player2_score",
    "partnership_runs" AS "partnership_score"
FROM top_partnerships
ORDER BY "match_id";
```
2025-01-25 03:30:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 03:30:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 03:30:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 03:30:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 574
2025-01-25 03:30:43 - snowflake.connector.connection - INFO - closed
2025-01-25 03:30:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 03:30:43 - root - INFO - itercount: 3
2025-01-25 03:30:43 - root - INFO - 0
2025-01-25 03:30:43 - root - INFO - Total iteration counts: 3
