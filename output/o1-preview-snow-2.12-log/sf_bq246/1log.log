2025-01-25 02:07:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.494162 seconds
2025-01-25 02:09:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:09:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:09:10 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:11 - root - INFO - SQL:
SELECT p."id", p."country", a."date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT p
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
   WHERE p."country" = 'US'
   LIMIT 100;
Results:
id,country,application_date
D396456,US,1994-01-21
D394631,US,1994-08-02
D388775,US,1994-09-01
D391947,US,1995-05-05
D392963,US,1995-05-05
D384418,US,1995-05-19
D388136,US,1995-06-05
D385266,US,1995-09-08
D397064,US,1995-09-27
D394722,US,1995-12-13
D403435,US,1995-12-21
D388528,US,1996-01-22
D399212,US,1996-02-09
D391948,US,1996-02-14
D384439,US,1996-02-29
D386744,US,1996-03-01
D384435,US,1996-03-27
D386360,US,1996-04-23
D385353,US,1996-04-29
D389840,US,1996-04-30
D383936,US,1996-05-07
D388444,US,1996-05-23
D396284,US,1996-05-29
D386367,US,1996-05-31
D386870,US,1996-06-07
D384946,US,1996-07-09
D387926,US,1996-07-19
D387281,US,1996-07-19
D395202,US,1996-07-22
D385463,US,1996-08-16
D386325,US,1996-08-20
D391786,US,1996-08-21
D394093,US,1996-08-22
D394588,US,1996-08-26
D392007,US,1996-08-27
D403186,US,1996-08-29
D387007,US,1996-09-06
D386133,US,1996-09-11
D395364,US,1996-09-13
D392144,US,1996-09-18
D386818,US,1996-09-30
D391580,US,1996-10-16
D385862,US,1996-10-17
D401184,US,1996-10-22
D393522,US,1996-10-22
D389286,US,1996-10-25
D391656,US,1996-11-08
D401340,US,1996-11-12
D402384,US,1996-11-15
D388840,US,1996-11-18
D397862,US,1996-11-22
D395356,US,1996-11-27
D391516,US,1996-11-29
D393911,US,1996-12-05
D397095,US,1996-12-09
D386736,US,1996-12-17
D391687,US,1996-12-24
D394322,US,1997-01-06
D399997,US,1997-01-06
D400324,US,1997-01-10
D390986,US,1997-01-14
D392519,US,1997-01-15
D394561,US,1997-01-29
D388381,US,1997-02-12
D392303,US,1997-02-14
D403091,US,1997-02-18
D387763,US,1997-02-24
D392959,US,1997-02-26
D393899,US,1997-02-28
D393049,US,1994-08-18
D388460,US,1994-11-28
D392622,US,1995-03-28
D387207,US,1995-05-10
D397157,US,1995-08-04
D384021,US,1995-09-05
D383906,US,1995-10-11
D396755,US,1995-11-03
D394000,US,1995-11-20
D390967,US,1996-01-02
D384111,US,1996-01-04
D383891,US,1996-01-11
D397677,US,1996-01-29
D391215,US,1996-03-07
D393638,US,1996-03-08
D389526,US,1996-03-15
D384819,US,1996-03-22
D385531,US,1996-03-26
D384444,US,1996-04-08
D401861,US,1996-04-30
D394225,US,1996-05-06
D397167,US,1996-05-14
D385529,US,1996-05-15
D391542,US,1996-05-23
D402621,US,1996-05-24
D389444,US,1996-05-24
D386176,US,1996-05-31
D386509,US,1996-06-07
D387035,US,1996-06-10
D392711,US,1996-06-20
D388830,US,1996-06-25

2025-01-25 02:09:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:09:13 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:13 - root - INFO - SQL:
SELECT "uuid", "patent_id", "citation_id", "date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   LIMIT 100;
Results:
Too long, hard cut:
uuid,patent_id,citation_id,date
uw9ozu90526jbrp6bkgrsa7ug,4233808,524,1837-12-01
2v6errxk0imqlqpljqyc1hdnk,5418423,H60,1986-05-01
wczaz39w3wsq0w8z1sespsve4,5445606,H71,1986-06-01
n7uo4k2d6ujcxzk5m5n2c9uab,4671363,1482,1840-01-01
093ps1aznu4twc2wlh5q8zqnc,4295314,1887,1840-12-01
2psm2pgoavmu4uxp92hhkr57d,5666885,1931,1841-01-01
ytdsbj900b8olpta54t71b3fy,D283714,4174,1870-06-01
cc2y7c7x3jz8qci3cfa1h6s39,5048848,7345,1876-10-01
ifnynku5a2rrrgk64vcj4e01r,4612868,8164,1851-06-01
faz72gr84wbj1rplfh1xit51w,5611671,8834,1835-05-01
yyaruiqdf54z3coz1t84ky289,5009345,9837,1853-07-01
kwq23s4hqdj6cde6i8h6tbgow,D311841,D392,1851-07-01
4j05fb9wn1l11eoandwlk34gw,4815385,H162,1986-11-01
f395pepp5acn6xplv5qbjh1uw,5798553,H204,1987-02-00
y21xe3cvzl7v38r37l80145gw,5561678,H275,1987-05-01
n63s3kamg8r34e7kd3khgfs46,4911487,H358,1987-11-01
lqpzclgdv7ajfa8dmjucfkszy,5221744,H531,1988-10-01
bqa2icahemi04xdg79a8m89e3,5940597,H586,1989-02-01
9c2uydekhboe1l6di943z6j0d,5211875,H724,1990-01-01
b18hmno6j5p8v1bn9nvef78oz,6073962,H767,1990-04-01
lhg18m89ep6ovcvmzdlcyrzlh,5349364,H880,1991-01-01
7ujqrwxkg7fajgvhrxx9ufn5g,5651474,H943,1991-08-01
wgvmkjgsacqz4huidv001tulx,5224658,11368,1854-07-01
ql7p55wxlfhog5ugvhbsujb5b,5090897,13387,1912-03-01
wca77wptgv312293fsrcxf9ht,D316160,15211,1884-08-01
onl0b5pjxmq5m2x8hbrz0fe96,D395737,17748,1857-09-00
94pwkhtn61fm4iv8wuw3gxrj9,4588302,19413,1858-02-01
t9wilm4xqvn2kd1tctrsa1bqh,4665741,21487,1858-09-01
s9npkw77s0prx48smncxm2z6g,5514166,22080,1958-11-01
ryy9kznq1cbtfzlvjmdtb7zjw,D358251,22456,1893-05-01
rnt27gh82bacgt6no5smeav1c,5920920,23335,1859-03-01
vj6stk2fq455v4rfdy7z3luyp,5941231,24840,1859-07-01
472vdhebd91tsu503l135juk6,4568320,24874,1908-11-01
mvlwpzwxhkm26zi22bs6w1urw,5030203,25129,1962-02-01
awwgz487hmmx0s2jv2sfb5pqf,5794810,26188,1859-11-00
hizyjia69mshxibmxqydvfgse,5013461,26709,1869-11-01
of5r3ft3jwyjj1o6mvjk0q9av,4729321,29995,1860-09-01
5hzxd3ci2k32oavkh0t0urm1p,5005259,31574,1861-02-01
b2kxzfhwe9n3ftjluq7j159f1,5239018,32136,1886-05-01
5w61fg4b4dll80b4ukuccz5uu,5248309,32649,1988-04-01
2n15q13kaq1v3nsi7plycohrq,5060706,32693,1888-06-01
0xdwez1dq0p19m6yk1kapun52,D350403,34792,1901-07-01
1oq3lvzy44gtq2dcouq6lgynw,D377562,34991,1901-08-01
5sbptbzdy5p87numca2kf0hkq,4688727,35036,1862-04-01
f3a14pjuwi11cbx4bpb063o1q,5479861,36773,1862-10-01
l82aaitjmtvx2vujom6xyqv0u,5329869,37849,1863-03-01
0ak1um7juawlmgv60xzgktkcz,4101419,39150,1863-07-01
d0npbfw4ikm2kgvppr7wi291v,6327797,39575,1863-08-01
2qtlmezsf4bf4b080d9xrhicr,4239460,39974,1863-09-01
3b3rmpx3hrou66f9ncni7weoy,5228705,40921,1863-12-01
nvnml3ug678xcmv0ett1wxhm1,3962925,41574,1864-02-01
u4gbkfh9utqw0j5jq87ak4pvi,D452982,43931,1864-08-01
ofs5kfyj2kguu8tftql127kun,5714098,45178,1864-11-00
h2djwzgznsmhv19h8tm8zemvb,5875785,45258,1864-11-01
u1gju31irntca1qfxnoehihl9,4669324,46056,1865-01-01
184f79avwfajcbfk3lt3z928c,5727698,46296,1865-02-00
nv9yffffsqbf3sfjpcni6mpp3,D441147,46579,1865-02-01
xs4nbcjgfq376v8o4hz5ua5im,4360315,50705,1865-10-01
7c476eh0gd56wqaojh3jrqtha,6113158,52010,1866-01-01
qabpw95r7mqgy06yqtgs8pp5w,D327304,53426,1919-06-01
5d4syrrkbx99xbgy1yte69mub,5429831,56217,1866-07-01
wcv3nv0mwqfmjde1lzuar7lzz,4269417,56326,1866-10-01
e7rmoikk1y74lb4jcn2ldexzl,4702856,59724,1866-11-01
ewuejo7msqhzv6628pc4xmg8a,5015399,61880,1867-02-01
j9m91zwhnzwm445vnwfjk9y37,4437634,63383,1867-04-01
6bovgqv1hm7b62vqcgwy0mhep,5570971,64757,1867-05-01
kl9ovkm3wbfumoaxwgpqjv7lp,4678011,66631,1867-07-01
axxoedfi6m251s1peo6qkfa8k,5354077,68558,1887-09-01
xlscad07q371iui2ndp8fnier,4967939,69485,1867-10-01
rplhk4ytmkz17q9q82j6s6h27,6099490,70683,1867-11-01
z1l67879l9wchgifg4yoij3dh,4146982,70849,1867-11-01
fodmfzrzgh1q0psagcgbhgcub,4858867,70884,1867-11-01
bzm6cvc72ug8ki0xwo4ninfes,5141236,73006,1868-01-01
gm4t5cr0du3vihuxxh7h9q8jz,4394803,74707,1868-02-01
v94hxxpj1ulfbqocqa50qj5vu,4488381,76755,1868-04-01
0oj7ljmh7xhc324lahqnrv7ma,4018394,77102,1868-04-01
1fck9d2j1ptf0khuhgzv40ezf,5067396,77884,1868-05-01
q4jx0llbnrlsp99o1kc6abscj,6044570,79052,1868-02-01
d6edchh9hhr5eyrx4knfovx26,4676772,79436,1868-06-01
3dlkox34l2dn524tgm4x8a9u0,D396895,81947,1868-09-00
8coi9ug6az4g7yx5viba49d5u,D405235,83973,1868-11-01
5d86wcoqez9fkat02yu5o0rbt,4112838,86045,1969-01-01
ng8hrlogy5cw0pyx1v1mgb5i8,D404519,86101,1869-01-01
kr1kb0bncszj3ljtu2qm75bf5,5571229,87015,1869-02-01
uwhma3hzydnlbd6zu27av2uyf,5667122,88505,1869-03-01
cnbiq7uc4z2g40p43l1yif833,4574977,90036,1869-05-01
85xughuh0mykocsq97hqm5tj6,4096853,90217,1869-05-00
5pl9la9gl3hcaihon5bjno9t1,4901645,90732,1869-01-01
mp1aw6qlza4p0ce506yprkzg2,5383675,90837,1869-06-01
53akjddbmdncmmsglmtn366fa,D304074,92049,1869-06-01
4p4e3dswlkwymqlh4xpo6y2zd,6344226,92640,1869-07-01
wb2ijlilmsi3pbjgignni0d1a,4598447,94503,1869-09-01
f9l4nb4xl0uypitkyhapwgpta,4867255,94854,1869-09-01
3k0xdjqn6xtzfvi8o9t6sok8z,5666885,95705,1869-10-01
nsuut6p5za7ypwu5sn8tt8592,6164033,97316,1869-11-01
r1t60wvcqrgscczpt12nwi84y,D415547,98439,1869-12-01
5za0o1sheg0gt1yzl687wfhqc,D266832,D2599,1867-03-01
2qwd6qox5k5hvleyx735hvuq4,D365016,D3310,1869-0

2025-01-25 02:09:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:09:15 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:15 - root - INFO - SQL:
SELECT c."patent_id", c."citation_id", c."date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
   WHERE p."country" = 'US'
   LIMIT 100;
Results:
patent_id,citation_id,date
8620900,6976025,2005-12-01
11030408,6976031,2005-12-01
11080232,6976039,2005-12-01
9971784,6976039,2005-12-01
9507617,6976059,2005-12-01
10540159,6976079,2005-12-01
10116738,6976090,2005-12-01
9338523,6976090,2005-12-01
9986419,6976090,2005-12-01
8902915,6976095,2005-12-01
9032132,6976105,2005-12-01
9788215,6976160,2005-12-01
10285094,6976160,2005-12-01
9509682,6976164,2005-12-01
9641490,6976165,2005-12-01
9189392,6976190,2005-12-01
10459710,6976193,2005-12-01
9852205,6976210,2005-12-01
9256664,6976210,2005-12-01
8849850,6976210,2005-12-01
8739302,6976259,2005-12-01
9339074,6976321,2005-12-01
10865545,6976325,2005-12-01
10617227,6976348,2005-12-01
10113823,6976416,2005-12-01
10556720,6976438,2005-12-01
8447648,6976439,2005-12-01
10736304,6976452,2005-12-01
10087357,6976542,2005-12-01
D724696,6976543,2005-12-01
10286409,6976543,2005-12-01
10152624,6976626,2005-12-01
10002272,6976631,2005-12-01
8713829,6976660,2005-12-01
9169821,6976683,2005-12-01
8857387,6976683,2005-12-01
D704600,6976697,2005-12-01
9126417,6976753,2005-12-01
9954993,6976799,2005-12-01
10351229,6976829,2005-12-01
10213160,6976857,2005-12-01
10268014,6976867,2005-12-01
8648932,6976954,2005-12-01
9775529,6976958,2005-12-01
8499252,6976958,2005-12-01
9775567,6976965,2005-12-01
8936021,6976969,2005-12-01
9913776,6976969,2005-12-01
9339425,6976978,2005-12-01
9492315,6976982,2005-12-01
9687263,6976983,2005-12-01
10449330,6976987,2005-12-01
9050141,6976988,2005-12-01
10208468,6977005,2005-12-01
9670351,6977105,2005-12-01
10557691,6977140,2005-12-01
8815513,6977148,2005-12-01
9269648,6977188,2005-12-01
10472750,6977231,2005-12-01
11116717,6977250,2005-12-01
10799476,6977257,2005-12-01
8648197,6977265,2005-12-01
8791087,6977295,2005-12-01
9164099,6977305,2005-12-01
9126184,6977319,2005-12-01
8608889,6977324,2005-12-01
9554549,6977327,2005-12-01
11109546,6977351,2005-12-01
9904327,6977352,2005-12-01
10179730,6977468,2005-12-01
8882791,6977495,2005-12-01
10966744,6977495,2005-12-01
9872725,6977495,2005-12-01
9287075,6977569,2005-12-01
8367991,6977598,2005-12-01
9244157,6977608,2005-12-01
10595574,6977615,2005-12-01
9401025,6977630,2005-12-01
8515132,6977643,2005-12-01
9083830,6977685,2005-12-01
10937755,6977686,2005-12-01
8923564,6977687,2005-12-01
8760576,6977690,2005-12-01
10218848,6977740,2005-12-01
9053727,6977789,2005-12-01
9245555,6977790,2005-12-01
9153283,6977793,2005-12-01
10205395,6977824,2005-12-01
8612670,6977847,2005-12-01
8947382,6977868,2005-12-01
9453742,6977868,2005-12-01
9913289,6977888,2005-12-01
8789201,6977894,2005-12-01
8520688,6977896,2005-12-01
9262225,6977939,2005-12-01
8976280,6977985,2005-12-01
8995641,6977992,2005-12-01
9906651,6977992,2005-12-01
10757262,6978006,2005-12-01
10218515,6978017,2005-12-01

2025-01-25 02:09:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:09:18 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:18 - root - INFO - SQL:
SELECT c."patent_id", c."citation_id", a1."date" AS "citing_app_date", a2."date" AS "cited_app_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
   LIMIT 100;
Results:
patent_id,citation_id,citing_app_date,cited_app_date
9104930,7221394,2013-07-03,2003-08-21
8735090,7221443,2013-03-28,2004-01-23
9390359,7221473,2014-11-14,2001-08-03
8941631,7221495,2008-11-14,2003-06-24
11115166,7221645,2020-03-19,2001-07-03
9064164,7221660,2013-09-30,2001-08-08
10453023,7221668,2014-09-17,2005-08-08
10074069,7221668,2015-09-23,2005-08-08
9621198,7221680,2014-12-03,2004-09-01
9449781,7221731,2014-12-08,2003-11-21
9445418,7221750,2015-09-15,2006-01-20
9025086,7221787,2013-04-11,2002-12-10
9177372,7221788,2015-01-21,2003-07-01
9006628,7221847,2010-04-05,2004-08-03
8681225,7221863,2006-04-03,2005-02-02
10097798,7221910,2017-06-06,2003-10-17
10333525,7221921,2016-12-06,2003-12-08
9766079,7221937,2015-09-30,2003-05-05
9338153,7221959,2013-04-10,2003-10-14
D835283,7221971,2017-04-28,2005-12-19
9408587,7221972,2009-08-21,2004-07-16
9566441,7221979,2010-04-30,2003-04-30
8447411,7221979,2009-04-30,2003-04-30
8433403,7221980,2010-02-22,2001-08-14
9434072,7221983,2012-09-17,2003-11-25
9182895,7222021,2013-12-10,2002-09-03
9498159,7222054,2007-10-30,2002-03-04
10235383,7222078,2013-12-19,2003-12-10
9244887,7222082,2012-07-13,2000-08-28
10191982,7222090,2010-01-22,2002-05-01
8700441,7222102,2009-03-25,2002-03-20
8379841,7222114,2007-03-22,2003-08-20
10853173,7222133,2019-04-03,2004-02-05
9398001,7222158,2014-01-10,2003-12-31
8595475,7222163,2012-02-17,2001-04-06
9491511,7222163,2015-12-22,2001-04-06
9467481,7222190,2014-07-25,2001-12-07
10508921,7222293,2017-12-28,2000-08-11
9521099,7222299,2016-06-22,2003-12-19
10831509,7222302,2017-08-28,2003-06-05
9319913,7222304,2015-04-13,2003-07-30
8441793,7222339,2010-07-21,2003-06-13
8745622,7222343,2009-04-22,2003-01-16
9819230,7222356,2014-05-07,2000-01-11
10266195,7222363,2016-12-19,2002-12-09
9307975,7222380,2014-06-19,2003-04-21
10654689,7222460,2019-09-30,2002-07-17
8738329,7222544,2011-03-03,2005-03-07
10032526,7222623,2013-03-15,2004-12-29
8434479,7222623,2009-02-27,2004-12-29
8616207,7222624,2010-09-07,2004-07-02
8376138,7222736,2008-10-22,2003-06-13
10232791,7222763,2016-06-08,2004-07-12
10547446,7222791,2017-05-01,2004-03-30
8766194,7222800,2013-09-26,2004-06-03
8857738,7222802,2008-03-26,2004-04-28
D764599,7222852,2014-08-01,2003-02-05
8590950,7222873,2011-05-17,2004-12-10
9004618,7222924,2011-05-20,2004-11-10
10646755,7223180,2017-12-20,2004-08-06
10569144,7223180,2018-07-27,2004-08-06
11007860,7223200,2019-08-14,2002-10-02
9375596,7223212,2014-12-30,2003-11-29
8535217,7223229,2006-07-25,2006-05-01
10555769,7223229,2016-02-22,2006-05-01
11096752,7223229,2020-01-02,2006-05-01
9433339,7223232,2012-11-02,2004-01-20
11004125,7223234,2020-09-24,2005-07-08
10496803,7223234,2019-01-07,2005-07-08
11120161,7223234,2020-12-28,2005-07-08
8845513,7223239,2011-03-03,2005-01-10
9808332,7223253,2015-07-22,2002-07-29
10231753,7223256,2016-11-30,2003-05-01
10368908,7223257,2016-08-31,2004-08-31
9821108,7223257,2014-07-25,2004-08-31
10570294,7223270,2016-11-17,2004-02-10
9642687,7223270,2011-06-01,2004-02-10
9375219,7223271,2014-05-22,2002-05-13
10231738,7223272,2016-05-03,2004-06-14
9649102,7223278,2015-07-08,2003-05-16
8556962,7223286,2005-05-25,2004-09-28
8591590,7223289,2012-08-10,2002-04-16
10576130,7223346,2015-12-18,2005-04-18
9895418,7223346,2013-03-15,2005-04-18
8678233,7223361,2011-11-22,2005-08-16
9873904,7223364,2014-09-23,2000-07-07
11002743,7223365,2018-02-13,2001-01-24
9265887,7223394,2012-01-24,2001-03-07
9090449,7223427,2013-08-08,2002-10-14
10683455,7223432,2019-04-02,2003-04-04
8828601,7223494,2011-02-21,2002-07-24
8835053,7223498,2008-03-18,2004-10-08
10544456,7223540,2017-07-20,2003-01-15
11039816,7223540,2016-03-30,2003-01-15
10730906,7223545,2003-07-30,2004-09-24
10828356,7223557,2019-05-13,2002-05-22
8372606,7223572,2009-06-25,2000-04-07
9173365,7223577,2013-02-20,2005-05-31
8378715,7223612,2012-08-24,2004-07-26
9431323,7223634,2015-02-05,2004-07-26

2025-01-25 02:09:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:09:20 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:20 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   GROUP BY c."patent_id"
   ORDER BY COUNT(*) DESC
   LIMIT 100;
Results:
patent_id,num_backward_citations
8892495,5828
11103241,5769
11090045,5684
11051807,5617
9980729,5444
11000274,5379
10945729,5320
10779825,5196
11026680,5162
10881399,5156
10695058,5065
10888322,5038
10716565,5037
10835249,4941
10959722,4730
10537325,4688
10765425,4620
10575868,4476
9986419,4468
11051811,4445
10463384,4380
10433844,4322
10368867,4285
10368864,4266
10485541,4266
10293100,4262
10271849,4233
10842491,4218
10245032,4212
10335148,4151
10390841,4142
10448948,4127
10433918,4120
10238391,4101
10625137,3937
10278780,3749
10172616,3708
10687810,3223
D896380,3216
10517599,3054
10765424,2878
10172619,2867
10117652,2756
10052100,2755
10028743,2725
9999426,2723
9901345,2717
9962158,2714
9974538,2713
9788836,2696
9592053,2638
9693777,2620
9585663,2605
9775609,2586
9962486,2573
8758323,2502
11120372,2464
10449416,2442
9804618,2436
9662110,2425
9700317,2401
9408604,2397
9749790,2395
9649111,2319
10791176,2277
9433419,2271
11096752,2170
10952788,2140
9253616,2118
10898256,2109
9668024,2096
11006971,2096
10709469,2091
9031581,2085
10966744,2083
9966068,2031
10185542,2030
11069510,2008
D922229,1996
9721566,1966
9886953,1965
10101822,1965
10679605,1936
10553209,1930
10675035,1921
10241644,1905
9760559,1893
9966065,1887
10078631,1881
10555769,1879
10446141,1864
9483461,1864
10463421,1850
10376305,1844
10312567,1816
9865911,1807
8403864,1783
8202231,1777
8763875,1777
8430828,1771

2025-01-25 02:09:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:09:27 - snowflake.connector.connection - INFO - closed
2025-01-25 02:09:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:09:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:09:56 - root - INFO - The error you're encountering is due to invalid date formats in the `"date"` columns of the `"APPLICATION"` table. Specifically, some date strings have `'00'` for the day or month (e.g., `'1977-03-00'`), which cannot be parsed using the `TO_DATE` function with the format `'YYYY-MM-DD'`.

To handle this issue, you can use the `TRY_TO_DATE` function instead of `TO_DATE`. The `TRY_TO_DATE` function attempts to convert a string to a date and returns `NULL` if it fails, rather than throwing an error. You can then exclude any rows where the date conversion returns `NULL`.

Here's the corrected SQL query:

```sql
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."patent_id"
LIMIT 100;
```

**Explanation:**

- **Use `TRY_TO_DATE` Function:**
  - Replaces `TO_DATE` with `TRY_TO_DATE` to handle invalid date formats without raising an error.
  - `TRY_TO_DATE(a1."date", 'YYYY-MM-DD')` attempts to parse the `date` string. If it fails (e.g., due to `'00'` in the date), it returns `NULL`.

- **Filter Out Invalid Dates:**
  - Adds conditions `TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL` and `TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL` to exclude records with invalid dates.

- **Calculate Date Difference:**
  - Uses the parsed dates in `DATEDIFF` to calculate the absolute difference in years between the application dates of the citing and cited patents.

**Additional Notes:**

- **Potential Data Loss:**
  - By excluding records with invalid dates, you might lose some data. If retaining as much data as possible is critical, consider cleaning or preprocessing the date data to handle incomplete dates.

- **Alternative Handling of Incomplete Dates:**
  - If the incomplete dates represent the first day of the month (e.g., `'1977-03-00'` could be treated as `'1977-03-01'`), you could replace `'00'` with `'01'` using the `REPLACE` function before parsing.

  Example:

  ```sql
  TRY_TO_DATE(
    REPLACE(a1."date", '-00', '-01'),
    'YYYY-MM-DD'
  )
  ```

- **Ensure Date Formats Are Consistent:**
  - Confirm that all dates in the `"date"` columns follow a consistent format or adjust the parsing logic accordingly.

**Testing the Corrected Query:**

Run the corrected query to verify that it executes without errors and returns the expected results.

**Proceeding with Your Task:**

Once you've resolved the error, you can continue with your original task:

- Identify the U.S. patent with the most backward citations within 1 year from its application date.
- Use that patent's ID to calculate the number of forward citations it received within 1 year from its application date.

Let me know if you need further assistance with these steps.
2025-01-25 02:09:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:09:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:09:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:10:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:10:00 - snowflake.connector.connection - INFO - closed
2025-01-25 02:10:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:11:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:11:36 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."patent_id"
LIMIT 100;
Results:
patent_id,num_backward_citations_within_1_year
4085362,2
4030123,1
4045778,1
4149593,2
4116720,3
4175685,2
4262066,1
4331129,1
4447435,2
4374775,1
4452098,1
4556068,1
4797273,3
4897361,8
4852041,7
5050453,1
4558376,2
4562128,2
D292529,1
4658280,2
4738683,2
4841134,2
4710818,3
4706493,1
4785330,2
4807210,1
4956675,2
4983566,4
4902037,1
5121472,2
5113267,1
5171613,3
D339711,3
4956003,1
4969443,2
4987428,6
5090345,1
5199492,1
5633574,1
5623160,1
6030857,8
5814370,2
4731818,1
4829017,11
5057860,2
5115303,1
5244819,5
5313451,5
5576705,2
6130623,14
6008891,1
D417582,1
5956497,6
6002441,3
5975788,1
5930665,1
6126732,1
D336109,1
D382438,1
D624338,4
D719121,17
D711243,14
D817935,4
D781113,2
4917048,1
4335428,1
4569128,2
4924936,2
4753348,1
4965271,3
5214784,11
4862989,1
5148523,9
5069732,1
5212831,5
5042347,1
5056485,4
5078683,3
5299235,2
5767626,1
5758281,4
5935680,1
5937582,1
5276238,3
5581497,5
5578174,2
5668852,2
5611257,1
5794125,1
5523195,1
5812972,2
5873347,3
6207370,8
6139167,3
6076877,3
5800253,1
6114991,5
6073169,2
6119613,1
6338158,4

2025-01-25 02:11:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:11:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:11:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:11:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:11:40 - snowflake.connector.connection - INFO - closed
2025-01-25 02:11:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:11:41 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."patent_id"
ORDER BY COUNT(*) DESC
LIMIT 1
Results:
patent_id,num_backward_citations_within_1_year
10835249,476

2025-01-25 02:11:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:11:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:11:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:11:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:11:44 - snowflake.connector.connection - INFO - closed
2025-01-25 02:11:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:11:45 - root - INFO - SQL:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a2."date", 'YYYY-MM-DD'), TRY_TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."citation_id"
LIMIT 100
Results:
patent_id,num_forward_citations_within_1_year
3960752,1
3980400,1
3963680,1
4008719,1
4079284,1
4115425,1
4160982,2
4267011,1
4170119,2
4252014,1
4243264,1
4332010,1
4374912,1
4291240,1
4407185,1
4439260,1
4518879,1
4564575,1
4784913,1
4787759,1
4887265,1
4910373,1
4981337,1
4964880,1
4972363,1
4936174,1
5103831,1
5269220,1
5508990,1
5423594,2
4353184,1
4739409,1
4709774,1
4807229,1
4923959,1
5011720,1
5146654,1
5134925,1
5249174,1
5193738,1
5335782,1
5423062,1
5462804,1
5482908,1
5424006,1
5442399,1
5704163,1
5714967,1
5597995,3
5673254,1
5270616,1
5751906,1
5874479,1
5965894,1
D442146,1
D521023,7
D576154,1
D622545,2
D637706,1
D642866,1
D647679,1
D770491,1
D803631,2
4205190,2
4186025,1
4229555,1
4524140,2
4522726,2
4617140,1
4856380,1
4937806,2
4916144,1
5007719,1
5057871,1
5142363,1
5390040,1
4799774,1
4825278,1
4970188,1
5104466,1
5169027,1
5276217,1
5332528,2
5345402,1
5336356,2
5430263,1
5496400,1
5438311,1
5451410,2
5497463,1
5542554,1
5597602,1
5622977,1
5765098,1
5720341,1
4852976,3
5186042,1
5189748,3
5354188,1
5361195,1

2025-01-25 02:11:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:11:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:11:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:11:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 02:11:46 - snowflake.connector.connection - INFO - closed
2025-01-25 02:11:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:12:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:12:14 - root - INFO - ```sql
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."citation_id"
LIMIT 100;
```
2025-01-25 02:12:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:12:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:12:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:12:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:12:17 - snowflake.connector.connection - INFO - closed
2025-01-25 02:12:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:13:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:13:47 - root - INFO - SQL:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."citation_id"
LIMIT 100;
Results:
patent_id,num_forward_citations_within_1_year
7666094,1
7820676,1
8306937,2
7733077,2
7841967,1
7959626,1
8108460,2
8637540,2
8685008,1
8756325,3
9457182,2
9213485,3
9807104,2
D800904,7
D687819,3
3980400,1
8421865,2
8493679,1
8364136,1
8514183,1
8688388,1
9035062,1
9115101,1
9228194,1
9306666,1
9374586,1
9172094,1
9655188,1
9922540,1
9974529,12
10420491,1
4079284,1
4008719,1
4852976,3
4936174,1
5007719,1
5361195,1
5415794,1
9205001,1
D751340,2
D750746,1
10108961,2
10129646,3
4617140,1
4709774,1
4923959,1
5273523,1
5442399,1
5462804,1
5497463,1
5707486,1
5874479,1
6082071,1
6165707,1
8032233,1
8407067,1
9293326,1
8347322,2
8308732,2
8551101,1
8728131,1
9621934,1
9689466,9
9706981,1
D551243,1
D732012,1
D692110,2
D738096,1
10039906,4
10564936,2
3960752,1
4267011,1
4799774,1
9208071,1
9788835,2
D699179,1
D803850,12
10842491,3
10058373,7
4229555,1
5146654,1
5169027,1
10317787,2
4964880,1
5430263,1
5551963,1
5735066,1
5938422,1
5984017,1
5661496,1
5673254,1
6117354,1
5781218,1
6088698,1
5778386,1
5911717,1
5986135,1
6077840,4
D287588,1
D388480,1

2025-01-25 02:13:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:13:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:13:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:13:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:13:49 - snowflake.connector.connection - INFO - closed
2025-01-25 02:13:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:13:50 - root - INFO - SQL:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE p."country" = 'US'
  AND TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a2."date", 'YYYY-MM-DD'), TRY_TO_DATE(a1."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."patent_id"
ORDER BY COUNT(*) DESC
LIMIT 100
Results:
patent_id,num_backward_citations_within_1_year
10888322,176
10835249,174
10433918,152
10433844,149
10945729,144
7410468,124
11000274,108
7589029,104
10271849,102
10537325,101
10575868,101
8149048,100
10779825,96
10517599,94
10335148,93
10881399,92
10687810,92
10595835,92
11026680,92
10919230,83
10695058,80
10959722,77
10485541,75
9433419,72
9563733,72
9649111,70
8816402,69
7172614,68
10368867,65
8669595,65
11051811,63
8758323,62
10245032,61
10448948,61
8065713,59
D853924,59
8344088,58
10172616,58
11090045,58
9137739,58
10716565,57
10172619,57
6994160,56
11103241,55
7017661,53
10729402,53
7547321,52
8672844,51
6202111,51
6212585,50
8333710,50
6263387,50
10463421,50
9700317,50
D930961,49
8984740,48
7682669,47
7178236,46
7476925,46
7400155,46
D893838,45
9755842,45
9780834,45
7524910,45
11035511,45
10409629,45
10238391,45
7425215,44
8771183,43
10076139,43
11114195,43
D928799,43
9685992,42
9775545,42
8162853,40
9775609,40
10504185,40
8895311,40
10449416,40
9125667,40
D691990,40
D750632,40
6182180,40
9189392,40
7398832,40
7901426,39
11099380,39
8952634,39
D893843,39
D920309,38
10770800,38
9368134,38
6337102,38
10675035,37
9078685,37
10373259,37
D486548,36
7240728,36
9782077,36
10625137,36

2025-01-25 02:13:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:13:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:13:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:13:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:13:51 - snowflake.connector.connection - INFO - closed
2025-01-25 02:13:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:13:52 - root - INFO - SQL:
SELECT c."citation_id", TRY_TO_DATE(a."date", 'YYYY-MM-DD') AS "cited_app_date", p."country" AS "cited_country"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON c."citation_id" = a."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."citation_id" = p."id"
WHERE TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL
LIMIT 100
Results:
citation_id,cited_app_date,cited_country
6979090,2003-10-20,US
6979204,2004-02-18,US
6979267,2002-07-12,US
6979267,2002-07-12,US
6979267,2002-07-12,US
6979312,2002-11-18,US
6979601,2003-04-21,US
6980077,2004-08-19,US
6980092,2001-04-05,US
6980433,2004-12-23,US
6980547,2000-10-31,US
6980716,2002-03-29,US
6981029,2001-07-17,US
6981295,2005-01-24,US
6982027,2001-10-25,US
6982311,2002-07-31,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6983031,2001-09-05,US
6983370,2001-11-27,US
6983886,2003-07-16,US
6984158,2004-02-20,US
6984188,2003-03-10,US
6984719,1999-09-15,US
6984970,2003-09-22,US
6984970,2003-09-22,US
6985831,2002-10-18,US
6985839,2001-05-03,US
6986118,2003-09-26,US
6986118,2003-09-26,US
6986353,2004-01-03,US
6986370,2000-02-01,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986988,2001-04-11,US
6986988,2001-04-11,US
6987317,2003-09-30,US
6987732,2000-12-15,US
6988139,2002-04-26,US
6988219,2002-08-28,US
6988667,2002-05-30,US
6989195,2003-07-23,US
6989954,2004-01-31,US
6989962,2003-02-24,US
6990148,2003-01-23,US
6990335,2005-06-06,US
6990335,2005-06-06,US
6990366,2003-11-24,US
6990381,2002-12-05,US
6990591,1999-12-22,US
6990804,2004-04-12,US
6991505,2004-04-29,US
6991873,2001-10-05,US
6991998,2004-07-02,US
6992123,2003-11-05,US
6992419,2003-06-25,US
6992501,2004-03-15,US
6992501,2004-03-15,US
6992543,2002-11-22,US
6992598,2002-12-24,US
6992598,2002-12-24,US
6992686,2004-06-14,US
6992851,2004-06-30,US
6992919,2003-12-08,US
6993157,2000-05-18,US
6993242,2003-08-14,US
6993308,2001-07-25,US
6993332,2002-06-05,US
6993332,2002-06-05,US
6993421,2002-12-20,US
6993564,2000-12-22,US
6993660,2001-12-10,US
6993877,2002-10-09,US
6993960,2003-04-10,US
6994160,2001-04-24,US
6994169,2002-04-24,US
6994320,2004-09-14,US
6994637,2004-05-18,US
6994825,2003-04-23,US
6994904,2001-05-02,US
6994907,2003-04-25,US
6995169,2002-05-14,US
6995169,2002-05-14,US
6995456,2004-03-12,US
6995667,2002-12-23,US
6995925,2003-03-04,US
6996427,2003-12-18,US
6996427,2003-12-18,US
6996427,2003-12-18,US
6996427,2003-12-18,US
6996455,2003-06-05,US
6996537,2001-08-13,US
6997918,2003-03-04,US
6998124,2000-04-14,US

2025-01-25 02:13:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:13:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:13:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:13:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:13:55 - snowflake.connector.connection - INFO - closed
2025-01-25 02:13:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:13:56 - root - INFO - SQL:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"  -- Cited patent
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"    -- Citing patent
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."citation_id"
ORDER BY COUNT(*) DESC
LIMIT 100
Results:
patent_id,num_forward_citations_within_1_year
9358005,21
9320520,16
9498219,16
8275836,15
10171158,14
10200106,12
8939344,12
9918704,12
10305192,12
D803850,12
9974529,12
8989053,12
9724096,12
7668340,11
9844372,11
9572574,11
RE42256,11
9872684,11
9687237,11
7809167,11
9808247,11
9730697,11
9883861,11
10405199,11
9867618,11
9737365,11
9913647,11
9737302,10
9775614,10
8870050,10
10052164,10
9277922,10
10052102,10
9211121,10
9968356,10
10045769,10
6737522,10
6730502,10
9833242,10
D837244,9
9027817,9
9282966,9
9844379,9
9471969,9
D819072,9
9808246,9
9042812,9
D849382,9
10064621,9
9987099,9
10426471,9
9829698,9
8939343,9
10105128,9
9585663,9
10448950,9
9907620,9
9689466,9
D831209,9
10371889,9
8773012,9
9872682,9
9289206,9
10028743,9
9901346,9
9439650,9
9901344,9
9526499,9
9931118,8
D820867,8
10003364,8
9566067,8
D810099,8
D820307,8
10028744,8
9998172,8
9993258,8
D710859,8
9687253,8
9924961,8
10307170,8
9241712,8
10390841,8
6559420,8
10201349,8
10292707,8
6633213,8
9592054,8
9999472,8
9095339,8
6389814,8
9564773,8
9901345,8
9260244,8
5802324,8
10405932,8
10315566,8
10111702,8
10064688,8
10045778,8

2025-01-25 02:13:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:13:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:13:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:13:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:13:57 - snowflake.connector.connection - INFO - closed
2025-01-25 02:13:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:13:58 - root - INFO - SQL:
SELECT p."id", TRY_TO_DATE(p."date", 'YYYY-MM-DD') AS "issue_date", TRY_TO_DATE(a."date", 'YYYY-MM-DD') AS "application_date"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
WHERE TRY_TO_DATE(p."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL
LIMIT 100
Results:
id,issue_date,application_date
D366645,1996-01-30,1990-10-15
D387923,1997-12-23,1995-03-21
D386268,1997-11-11,1995-05-03
D385951,1997-11-04,1995-06-27
D401358,1998-11-17,1995-06-29
D385909,1997-11-04,1995-08-04
D385507,1997-10-28,1995-08-11
D391383,1998-02-24,1995-08-23
D401003,1998-11-10,1995-10-31
D389796,1998-01-27,1996-01-19
D384523,1997-10-07,1996-01-24
D393500,1998-04-14,1996-01-25
D384008,1997-09-23,1996-01-30
D395502,1998-06-23,1996-03-19
D386612,1997-11-25,1996-04-24
D392943,1998-03-31,1994-08-25
D435879,2001-01-02,1995-01-24
D385637,1997-10-28,1995-03-17
D392928,1998-03-31,1995-06-05
D384945,1997-10-14,1995-06-13
D400559,1998-11-03,1995-09-06
D386809,1997-11-25,1995-11-08
D394063,1998-05-05,1995-11-09
D384303,1997-09-30,1995-12-19
D389610,1998-01-20,1995-12-27
D384064,1997-09-23,1996-01-03
D385899,1997-11-04,1996-02-12
D386661,1997-11-25,1996-04-15
D391412,1998-03-03,1996-05-01
D385455,1997-10-28,1996-05-02
D393202,1998-04-07,1996-05-13
D385110,1997-10-21,1996-05-15
D385461,1997-10-28,1995-03-07
D397192,1998-08-18,1995-03-27
D386927,1997-12-02,1995-08-24
D387722,1997-12-16,1995-09-29
D390048,1998-02-03,1995-10-04
D401451,1998-11-24,1995-10-20
D392746,1998-03-24,1995-10-26
D384269,1997-09-30,1995-12-21
D390301,1998-02-03,1995-12-28
D390367,1998-02-10,1996-01-25
D384518,1997-10-07,1996-02-01
D386548,1997-11-18,1996-02-08
D399309,1998-10-06,1996-02-22
D386690,1997-11-25,1996-02-28
D386912,1997-12-02,1996-03-11
D397262,1998-08-25,1996-03-29
D392737,1998-03-24,1996-04-16
D386935,1997-12-02,1996-04-25
D387167,1997-12-02,1996-05-03
D387822,1997-12-16,1996-05-06
D398300,1998-09-15,1993-05-10
D396709,1998-08-04,1994-01-21
D386575,1997-11-18,1994-09-02
D389425,1998-01-20,1994-09-22
D391594,1998-03-03,1995-02-28
D394767,1998-06-02,1995-07-05
D390870,1998-02-17,1995-08-04
D383956,1997-09-23,1995-09-12
D385594,1997-10-28,1995-09-14
D385203,1997-10-21,1995-12-08
D389193,1998-01-13,1995-12-08
D400847,1998-11-10,1996-01-12
D396458,1998-07-28,1996-02-14
D384386,1997-09-30,1996-02-15
D384396,1997-09-30,1996-04-04
D386543,1997-11-18,1996-04-08
D387476,1997-12-09,1996-04-12
D386045,1997-11-11,1996-04-23
D401835,1998-12-01,1996-04-30
D388168,1997-12-23,1996-05-13
D388481,1997-12-30,1996-05-20
D385449,1997-10-28,1996-05-21
D387045,1997-12-02,1993-05-10
D384933,1997-10-14,1993-12-28
D387750,1997-12-16,1994-03-16
D401999,1998-12-01,1994-04-26
D388196,1997-12-23,1994-08-16
D391335,1998-02-24,1994-12-29
D393329,1998-04-07,1995-01-06
D403042,1998-12-22,1995-02-09
D385659,1997-10-28,1995-04-07
D402246,1998-12-08,1995-05-11
D384333,1997-09-30,1995-08-10
D392554,1998-03-24,1995-10-05
D384329,1997-09-30,1995-10-27
D402749,1998-12-15,1995-11-06
D384204,1997-09-30,1995-11-28
D388234,1997-12-23,1996-01-11
D387117,1997-12-02,1996-01-19
D383907,1997-09-23,1996-02-01
D388373,1997-12-30,1996-02-20
D395410,1998-06-23,1996-02-29
D388798,1998-01-06,1996-03-07
D386580,1997-11-18,1996-03-22
D386273,1997-11-11,1996-04-25
D384041,1997-09-23,1996-05-02
D397745,1998-09-01,1996-05-03
D398007,1998-09-08,1993-11-15

2025-01-25 02:13:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:13:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:13:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:13:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 02:13:59 - snowflake.connector.connection - INFO - closed
2025-01-25 02:13:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:14:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:14:19 - root - INFO - ```sql
SELECT p."id",
       TRY_TO_DATE(REPLACE(p."date", '-00', '-01'), 'YYYY-MM-DD') AS "issue_date",
       TRY_TO_DATE(REPLACE(a."date", '-00', '-01'), 'YYYY-MM-DD') AS "application_date"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
WHERE TRY_TO_DATE(REPLACE(p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
LIMIT 100;
```
2025-01-25 02:14:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:14:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:14:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:14:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:14:20 - snowflake.connector.connection - INFO - closed
2025-01-25 02:14:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:15:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:15:10 - root - INFO - SQL:
SELECT p."id",
       TRY_TO_DATE(REPLACE(p."date", '-00', '-01'), 'YYYY-MM-DD') AS "issue_date",
       TRY_TO_DATE(REPLACE(a."date", '-00', '-01'), 'YYYY-MM-DD') AS "application_date"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
WHERE TRY_TO_DATE(REPLACE(p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
LIMIT 100;
Results:
id,issue_date,application_date
D390404,1998-02-10,1993-12-13
D394636,1998-05-26,1994-07-18
D393466,1998-04-14,1994-09-09
D397432,1998-08-25,1995-01-25
D393944,1998-05-05,1995-03-16
D385651,1997-10-28,1995-04-21
D389893,1998-01-27,1995-04-28
D391283,1998-02-24,1995-07-20
D385472,1997-10-28,1995-08-10
D385384,1997-10-21,1995-08-17
D387258,1997-12-09,1995-10-11
D402906,1998-12-22,1995-10-24
D384042,1997-09-23,1995-11-07
D384141,1997-09-23,1995-11-09
D397741,1998-09-01,1996-01-18
D387883,1997-12-16,1996-02-20
D396456,1998-07-28,1994-01-21
D394631,1998-05-26,1994-08-02
D388775,1998-01-06,1994-09-01
D391947,1998-03-10,1995-05-05
D392963,1998-03-31,1995-05-05
D384418,1997-09-30,1995-05-19
D388136,1997-12-23,1995-06-05
D385266,1997-10-21,1995-09-08
D397064,1998-08-18,1995-09-27
D394722,1998-05-26,1995-12-13
D403435,1998-12-29,1995-12-21
D388528,1997-12-30,1996-01-22
D399212,1998-10-06,1996-02-09
D391948,1998-03-10,1996-02-14
D384439,1997-09-30,1996-02-29
D386744,1997-11-25,1996-03-01
D384435,1997-09-30,1996-03-27
D386360,1997-11-18,1996-04-23
D385353,1997-10-21,1996-04-29
D389840,1998-01-27,1996-04-30
D386559,1997-11-18,1995-05-05
D400799,1998-11-10,1995-05-18
D402086,1998-12-08,1995-07-21
D386489,1997-11-18,1995-07-24
D385697,1997-11-04,1995-08-02
D395163,1998-06-16,1995-08-18
D394025,1998-05-05,1995-10-16
D384516,1997-10-07,1995-10-17
D384301,1997-09-30,1995-12-12
D395737,1998-07-07,1995-12-16
D396307,1998-07-21,1996-01-12
D384676,1997-10-07,1996-02-20
D383937,1997-09-23,1996-03-21
D384016,1997-09-23,1996-03-25
D385416,1997-10-28,1996-03-29
D384616,1997-10-07,1996-04-11
D389483,1998-01-20,1996-04-26
D386860,1997-11-25,1996-04-30
D387045,1997-12-02,1993-05-10
D384933,1997-10-14,1993-12-28
D387750,1997-12-16,1994-03-16
D401999,1998-12-01,1994-04-26
D388196,1997-12-23,1994-08-16
D391335,1998-02-24,1994-12-29
D393329,1998-04-07,1995-01-06
D403042,1998-12-22,1995-02-09
D385659,1997-10-28,1995-04-07
D402246,1998-12-08,1995-05-11
D384333,1997-09-30,1995-08-10
D392554,1998-03-24,1995-10-05
D384329,1997-09-30,1995-10-27
D402749,1998-12-15,1995-11-06
D384204,1997-09-30,1995-11-28
D388234,1997-12-23,1996-01-11
D387117,1997-12-02,1996-01-19
D383907,1997-09-23,1996-02-01
D388373,1997-12-30,1996-02-20
D395410,1998-06-23,1996-02-29
D388798,1998-01-06,1996-03-07
D386580,1997-11-18,1996-03-22
D386273,1997-11-11,1996-04-25
D384041,1997-09-23,1996-05-02
D397745,1998-09-01,1996-05-03
D392943,1998-03-31,1994-08-25
D435879,2001-01-02,1995-01-24
D385637,1997-10-28,1995-03-17
D392928,1998-03-31,1995-06-05
D384945,1997-10-14,1995-06-13
D400559,1998-11-03,1995-09-06
D386809,1997-11-25,1995-11-08
D394063,1998-05-05,1995-11-09
D384303,1997-09-30,1995-12-19
D389610,1998-01-20,1995-12-27
D384064,1997-09-23,1996-01-03
D385899,1997-11-04,1996-02-12
D386661,1997-11-25,1996-04-15
D391412,1998-03-03,1996-05-01
D385455,1997-10-28,1996-05-02
D393202,1998-04-07,1996-05-13
D385110,1997-10-21,1996-05-15
D406355,1999-03-02,1991-04-01
D396396,1998-07-28,1994-10-31
D402477,1998-12-15,1994-11-04
D385294,1997-10-21,1995-01-06

2025-01-25 02:15:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:15:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:15:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:15:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:15:16 - snowflake.connector.connection - INFO - closed
2025-01-25 02:15:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:16:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:16:55 - root - INFO - ```sql
SELECT patent_id, SUM(num_forward_citations) AS total_forward, SUM(num_backward_citations) AS total_backward
FROM (
  -- Forward citations within 1 year
  SELECT c."citation_id" AS patent_id, COUNT(*) AS num_forward_citations, 0 AS num_backward_citations
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"  -- Cited patent
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"    -- Citing patent
  WHERE 
    TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'), TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
  GROUP BY c."citation_id"
  UNION ALL
  -- Backward citations within 1 year
  SELECT c."patent_id", 0 AS num_forward_citations, COUNT(*) AS num_backward_citations
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"    -- Citing patent
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"  -- Cited patent
  WHERE 
    TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'), TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
  GROUP BY c."patent_id"
) sub
GROUP BY patent_id
LIMIT 100;
```
2025-01-25 02:16:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:16:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:16:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:17:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 02:17:00 - snowflake.connector.connection - INFO - closed
2025-01-25 02:17:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:17:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:17:23 - root - INFO - SQL:
SELECT patent_id, SUM(num_forward_citations) AS total_forward, SUM(num_backward_citations) AS total_backward
FROM (
  -- Forward citations within 1 year
  SELECT c."citation_id" AS patent_id, COUNT(*) AS num_forward_citations, 0 AS num_backward_citations
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"  -- Cited patent
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"    -- Citing patent
  WHERE 
    TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'), TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
  GROUP BY c."citation_id"
  UNION ALL
  -- Backward citations within 1 year
  SELECT c."patent_id", 0 AS num_forward_citations, COUNT(*) AS num_backward_citations
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"    -- Citing patent
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"  -- Cited patent
  WHERE 
    TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'), TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
  GROUP BY c."patent_id"
) sub
GROUP BY patent_id
LIMIT 100;
Results:
PATENT_ID,TOTAL_FORWARD,TOTAL_BACKWARD
3944384,1,0
3964488,1,0
4113997,1,0
4132452,1,0
4180494,1,0
4256000,1,0
4541987,1,0
4496487,1,0
4782834,1,0
4612415,1,0
4621487,1,0
4706100,1,0
5425032,2,0
5532754,2,0
5625406,1,0
D262653,1,0
5868204,1,0
5924529,1,0
D569772,1,0
D690331,1,0
5355749,1,0
5391287,1,0
5572666,2,0
5996725,1,0
5835319,1,0
9881626,1,0
5548483,1,0
6011930,1,0
9663062,1,0
D611241,1,0
D787792,1,0
D705919,1,0
D860601,1,0
D874450,1,0
5491813,2,0
5920814,1,0
5881110,1,0
D680544,1,0
D547079,2,0
D558288,4,0
D844657,1,0
D711311,1,0
D476650,2,0
D862729,1,0
9210192,4,0
6633729,1,0
5597752,1,0
9586500,1,0
5507026,2,0
5005703,1,0
5198968,1,0
9754674,1,0
D678219,2,0
D807249,2,0
D847906,1,0
10158709,1,0
D531753,1,0
D680488,1,0
D767861,2,0
D844217,1,0
6571282,1,0
6722210,1,0
D662663,1,0
7246734,3,0
4022534,1,0
4943224,1,0
5940841,1,0
5772745,1,0
D503700,1,0
D563514,2,0
D660602,1,0
D703170,1,0
5266523,1,0
9652294,1,0
D823887,1,0
D496343,5,0
D797301,1,0
D801569,1,0
8019834,1,0
9124703,1,0
7592597,2,0
8866109,1,0
4550824,1,0
4868135,1,0
5699265,5,0
D385430,1,0
D405749,1,0
D682866,1,0
D646105,1,0
D776658,1,0
D717334,2,0
D863263,3,0
4739727,1,0
4489183,1,0
9962421,1,0
5714683,1,0
5771571,1,0
6061426,1,0
D475043,3,0
5727156,1,0

2025-01-25 02:17:23 - root - INFO - itercount: 0
2025-01-25 02:17:23 - root - INFO - Database Name: PATENTSVIEW
Schema Name: PATENTSVIEW
DDL describes table information.
,0
table_name,BRF_SUM_TEXT
description,
DDL,"create or replace TABLE BRF_SUM_TEXT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216)
);"

,1
table_name,CLAIMS_2021
description,
DDL,"create or replace TABLE CLAIMS_2021 (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""dependent"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""num"" VARCHAR(16777216),
	""exemplary"" NUMBER(38,0)
);"

,2
table_name,FIGURES
description,
DDL,"create or replace TABLE FIGURES (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""num_figures"" NUMBER(38,0),
	""num_sheets"" NUMBER(38,0)
);"

,3
table_name,FOREIGNCITATION
description,
DDL,"create or replace TABLE FOREIGNCITATION (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,4
table_name,INVENTOR_GENDER
description,
DDL,"create or replace TABLE INVENTOR_GENDER (
	""disamb_inventor_id_20170808"" VARCHAR(16777216),
	""disamb_inventor_id_20181127"" VARCHAR(16777216),
	""disamb_inventor_id_20190312"" VARCHAR(16777216),
	""male"" VARCHAR(16777216)
);"

,5
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""id"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""county"" VARCHAR(16777216),
	""state_fips"" FLOAT,
	""county_fips"" VARCHAR(16777216)
);"

,6
table_name,OTHERREFERENCE
description,
DDL,"create or replace TABLE OTHERREFERENCE (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,7
table_name,PATENT
description,
DDL,"create or replace TABLE PATENT (
	""id"" VARCHAR(16777216),
	""type"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""abstract"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""num_claims"" NUMBER(38,0),
	""filename"" VARCHAR(16777216),
	""withdrawn"" NUMBER(38,0)
);"

,8
table_name,RAWLOCATION
description,
DDL,"create or replace TABLE RAWLOCATION (
	""id"" VARCHAR(16777216),
	""location_id"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""latlong"" VARCHAR(16777216)
);"

,9
table_name,USAPPLICATIONCITATION
description,
DDL,"create or replace TABLE USAPPLICATIONCITATION (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""application_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,10
table_name,USPC
description,
DDL,"create or replace TABLE USPC (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""mainclass_id"" VARCHAR(16777216),
	""subclass_id"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,11
table_name,NBER_SUBCATEGORY
description,
DDL,"create or replace TABLE NBER_SUBCATEGORY (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,12
table_name,NON_INVENTOR_APPLICANT
description,
DDL,"create or replace TABLE NON_INVENTOR_APPLICANT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""rawlocation_id"" VARCHAR(16777216),
	""lname"" VARCHAR(16777216),
	""fname"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""designation"" VARCHAR(16777216),
	""applicant_type"" VARCHAR(16777216)
);"

,13
table_name,PERSISTENT_ASSIGNEE_DISAMBIG
description,
DDL,"create or replace TABLE PERSISTENT_ASSIGNEE_DISAMBIG (
	""rawassignee_id"" VARCHAR(16777216),
	""disamb_assignee_id_20181127"" VARCHAR(16777216),
	""disamb_assignee_id_20190312"" VARCHAR(16777216),
	""disamb_assignee_id_20190820"" VARCHAR(16777216),
	""disamb_assignee_id_20191008"" VARCHAR(16777216),
	""disamb_assignee_id_20191231"" VARCHAR(16777216),
	""disamb_assignee_id_20200331"" VARCHAR(16777216),
	""disamb_assignee_id_20200630"" VARCHAR(16777216),
	""disamb_assignee_id_20200929"" VARCHAR(16777216)
);"

,14
table_name,SUBCLASS
description,
DDL,"create or replace TABLE SUBCLASS (
	""id"" VARCHAR(16777216)
);"

,15
table_name,US_TERM_OF_GRANT
description,
DDL,"create or replace TABLE US_TERM_OF_GRANT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""lapse_of_patent"" VARCHAR(16777216),
	""disclaimer_date"" VARCHAR(16777216),
	""term_disclaimer"" VARCHAR(16777216),
	""term_grant"" VARCHAR(16777216),
	""term_extension"" VARCHAR(16777216)
);"

,16
table_name,ASSIGNEE
description,
DDL,"create or replace TABLE ASSIGNEE (
	""id"" VARCHAR(16777216),
	""type"" FLOAT,
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216)
);"

,17
table_name,CLAIM
description,
DDL,"create or replace TABLE CLAIM (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""dependent"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216),
	""exemplary"" VARCHAR(16777216)
);"

,18
table_name,CPC_GROUP
description,
DDL,"create or replace TABLE CPC_GROUP (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,19
table_name,DRAW_DESC_TEXT_2021
description,
DDL,"create or replace TABLE DRAW_DESC_TEXT_2021 (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,20
table_name,INVENTOR
description,
DDL,"create or replace TABLE INVENTOR (
	""id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""male_flag"" FLOAT,
	""attribution_status"" NUMBER(38,0)
);"

,21
table_name,IPCR
description,
DDL,"create or replace TABLE IPCR (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""classification_level"" VARCHAR(16777216),
	""section"" VARCHAR(16777216),
	""ipc_class"" VARCHAR(16777216),
	""subclass"" VARCHAR(16777216),
	""main_group"" VARCHAR(16777216),
	""subgroup"" VARCHAR(16777216),
	""symbol_position"" VARCHAR(16777216),
	""classification_value"" VARCHAR(16777216),
	""classification_status"" VARCHAR(16777216),
	""classification_data_source"" VARCHAR(16777216),
	""action_date"" VARCHAR(16777216),
	""ipc_version_indicator"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,22
table_name,PATENT_LAWYER
description,
DDL,"create or replace TABLE PATENT_LAWYER (
	""patent_id"" VARCHAR(16777216),
	""lawyer_id"" VARCHAR(16777216)
);"

,23
table_name,RAWASSIGNEE
description,
DDL,"create or replace TABLE RAWASSIGNEE (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""assignee_id"" VARCHAR(16777216),
	""rawlocation_id"" VARCHAR(16777216),
	""type"" FLOAT,
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,24
table_name,DETAIL_DESC_TEXT_2021
description,
DDL,"create or replace TABLE DETAIL_DESC_TEXT_2021 (
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""length"" NUMBER(38,0)
);"

,25
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""patent_id"" VARCHAR(16777216),
	""publication_number"" VARCHAR(16777216)
);"

,26
table_name,USPATENTCITATION
description,
DDL,"create or replace TABLE USPATENTCITATION (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""citation_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,27
table_name,GOVERNMENT_ORGANIZATION
description,
DDL,"create or replace TABLE GOVERNMENT_ORGANIZATION (
	""organization_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""level_one"" VARCHAR(16777216),
	""level_two"" VARCHAR(16777216),
	""level_three"" VARCHAR(16777216)
);"

,28
table_name,WIPO_FIELD
description,
DDL,"create or replace TABLE WIPO_FIELD (
	""id"" VARCHAR(16777216),
	""sector_title"" VARCHAR(16777216),
	""field_title"" VARCHAR(16777216)
);"

,29
table_name,APPLICATION
description,
DDL,"create or replace TABLE APPLICATION (
	""id"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""date"" VARCHAR(16777216)
);"

,30
table_name,BOTANIC
description,
DDL,"create or replace TABLE BOTANIC (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""latin_name"" VARCHAR(16777216),
	""variety"" VARCHAR(16777216)
);"

,31
table_name,CPC_SUBSECTION
description,
DDL,"create or replace TABLE CPC_SUBSECTION (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,32
table_name,GOVERNMENT_INTEREST
description,
DDL,"create or replace TABLE GOVERNMENT_INTEREST (
	""patent_id"" VARCHAR(16777216),
	""gi_statement"" VARCHAR(16777216)
);"

,33
table_name,LAWYER
description,
DDL,"create or replace TABLE LAWYER (
	""id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""country"" VARCHAR(16777216)
);"

,34
table_name,PATENT_ASSIGNEE
description,
DDL,"create or replace TABLE PATENT_ASSIGNEE (
	""patent_id"" VARCHAR(16777216),
	""assignee_id"" VARCHAR(16777216),
	""location_id"" VARCHAR(16777216)
);"

,35
table_name,PATENT_GOVINTORG
description,
DDL,"create or replace TABLE PATENT_GOVINTORG (
	""patent_id"" VARCHAR(16777216),
	""organization_id"" NUMBER(38,0)
);"

,36
table_name,PERSISTENT_INVENTOR_DISAMB
description,
DDL,"create or replace TABLE PERSISTENT_INVENTOR_DISAMB (
	""rawinventor_id"" VARCHAR(16777216),
	""disamb_inventor_id_20170307"" VARCHAR(16777216),
	""disamb_inventor_id_20170808"" VARCHAR(16777216)
);"

,37
table_name,PATENT_INVENTOR
description,
DDL,"create or replace TABLE PATENT_INVENTOR (
	""patent_id"" VARCHAR(16777216),
	""inventor_id"" VARCHAR(16777216),
	""location_id"" VARCHAR(16777216)
);"

,38
table_name,PCT_DATA
description,
DDL,"create or replace TABLE PCT_DATA (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""rel_id"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""_371_date"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216),
	""doc_type"" VARCHAR(16777216),
	""_102_date"" VARCHAR(16777216)
);"

,39
table_name,PERSISTENT_INVENTOR_DISAMBIG
description,
DDL,"create or replace TABLE PERSISTENT_INVENTOR_DISAMBIG (
	""rawinventor_id"" VARCHAR(16777216),
	""disamb_inventor_id_20170808"" VARCHAR(16777216),
	""disamb_inventor_id_20171003"" VARCHAR(16777216),
	""disamb_inventor_id_20171226"" VARCHAR(16777216),
	""disamb_inventor_id_20180528"" VARCHAR(16777216),
	""disamb_inventor_id_20181127"" VARCHAR(16777216),
	""disamb_inventor_id_20190312"" VARCHAR(16777216),
	""disamb_inventor_id_20190820"" VARCHAR(16777216),
	""disamb_inventor_id_20191008"" VARCHAR(16777216),
	""disamb_inventor_id_20191231"" VARCHAR(16777216),
	""disamb_inventor_id_20200331"" VARCHAR(16777216),
	""disamb_inventor_id_20200630"" VARCHAR(16777216),
	""disamb_inventor_id_20200929"" VARCHAR(16777216),
	""disamb_inventor_id_20201229"" VARCHAR(16777216)
);"

,40
table_name,RAWLAWYER
description,
DDL,"create or replace TABLE RAWLAWYER (
	""uuid"" VARCHAR(16777216),
	""lawyer_id"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""organization"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,41
table_name,WIPO
description,
DDL,"create or replace TABLE WIPO (
	""patent_id"" VARCHAR(16777216),
	""field_id"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216)
);"

,42
table_name,RAWINVENTOR
description,
DDL,"create or replace TABLE RAWINVENTOR (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""inventor_id"" VARCHAR(16777216),
	""rawlocation_id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""rule_47"" VARCHAR(16777216),
	""deceased"" VARCHAR(16777216)
);"

,43
table_name,CPC_CURRENT
description,
DDL,"create or replace TABLE CPC_CURRENT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""section_id"" VARCHAR(16777216),
	""subsection_id"" VARCHAR(16777216),
	""group_id"" VARCHAR(16777216),
	""subgroup_id"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

,44
table_name,CPC_SUBGROUP
description,
DDL,"create or replace TABLE CPC_SUBGROUP (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,45
table_name,DRAW_DESC_TEXT
description,
DDL,"create or replace TABLE DRAW_DESC_TEXT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216)
);"

,46
table_name,LOCATION_ASSIGNEE
description,
DDL,"create or replace TABLE LOCATION_ASSIGNEE (
	""location_id"" VARCHAR(16777216),
	""assignee_id"" VARCHAR(16777216)
);"

,47
table_name,LOCATION_INVENTOR
description,
DDL,"create or replace TABLE LOCATION_INVENTOR (
	""location_id"" VARCHAR(16777216),
	""inventor_id"" VARCHAR(16777216)
);"

,48
table_name,MAINCLASS_CURRENT
description,
DDL,"create or replace TABLE MAINCLASS_CURRENT (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,49
table_name,NBER_CATEGORY
description,
DDL,"create or replace TABLE NBER_CATEGORY (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,50
table_name,PATENT_CONTRACTAWARDNUMBER
description,
DDL,"create or replace TABLE PATENT_CONTRACTAWARDNUMBER (
	""patent_id"" VARCHAR(16777216),
	""contract_award_number"" VARCHAR(16777216)
);"

,51
table_name,RAWEXAMINER
description,
DDL,"create or replace TABLE RAWEXAMINER (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""name_first"" VARCHAR(16777216),
	""name_last"" VARCHAR(16777216),
	""role"" VARCHAR(16777216),
	""group"" VARCHAR(16777216)
);"

,52
table_name,REL_APP_TEXT
description,
DDL,"create or replace TABLE REL_APP_TEXT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""text"" VARCHAR(16777216)
);"

,53
table_name,SUBCLASS_CURRENT
description,
DDL,"create or replace TABLE SUBCLASS_CURRENT (
	""id"" VARCHAR(16777216),
	""title"" VARCHAR(16777216)
);"

,54
table_name,USRELDOC
description,
DDL,"create or replace TABLE USRELDOC (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""doctype"" VARCHAR(16777216),
	""relkind"" VARCHAR(16777216),
	""reldocno"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""sequence"" VARCHAR(16777216),
	""kind"" VARCHAR(16777216)
);"

,55
table_name,MAINCLASS
description,
DDL,"create or replace TABLE MAINCLASS (
	""id"" VARCHAR(16777216)
);"

,56
table_name,NBER
description,
DDL,"create or replace TABLE NBER (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""category_id"" VARCHAR(16777216),
	""subcategory_id"" VARCHAR(16777216)
);"

,57
table_name,FOREIGN_PRIORITY
description,
DDL,"create or replace TABLE FOREIGN_PRIORITY (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""kind"" VARCHAR(16777216),
	""number"" VARCHAR(16777216),
	""date"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""country_transformed"" VARCHAR(16777216)
);"

,58
table_name,USPC_CURRENT
description,
DDL,"create or replace TABLE USPC_CURRENT (
	""uuid"" VARCHAR(16777216),
	""patent_id"" VARCHAR(16777216),
	""mainclass_id"" VARCHAR(16777216),
	""subclass_id"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTSVIEW': {'PATENTSVIEW': ['APPLICATION', 'ASSIGNEE', 'BOTANIC', 'BRF_SUM_TEXT', 'CLAIM', 'CLAIMS_2021', 'CPC_CURRENT', 'CPC_GROUP', 'CPC_SUBGROUP', 'CPC_SUBSECTION', 'DETAIL_DESC_TEXT_2021', 'DRAW_DESC_TEXT', 'DRAW_DESC_TEXT_2021', 'FIGURES', 'FOREIGNCITATION', 'FOREIGN_PRIORITY', 'GOVERNMENT_INTEREST', 'GOVERNMENT_ORGANIZATION', 'INVENTOR', 'INVENTOR_GENDER', 'IPCR', 'LAWYER', 'LOCATION', 'LOCATION_ASSIGNEE', 'LOCATION_INVENTOR', 'MAINCLASS', 'MAINCLASS_CURRENT', 'MATCH', 'NBER', 'NBER_CATEGORY', 'NBER_SUBCATEGORY', 'NON_INVENTOR_APPLICANT', 'OTHERREFERENCE', 'PATENT', 'PATENT_ASSIGNEE', 'PATENT_CONTRACTAWARDNUMBER', 'PATENT_GOVINTORG', 'PATENT_INVENTOR', 'PATENT_LAWYER', 'PCT_DATA', 'PERSISTENT_ASSIGNEE_DISAMBIG', 'PERSISTENT_INVENTOR_DISAMB', 'PERSISTENT_INVENTOR_DISAMBIG', 'RAWASSIGNEE', 'RAWEXAMINER', 'RAWINVENTOR', 'RAWLAWYER', 'RAWLOCATION', 'REL_APP_TEXT', 'SUBCLASS', 'SUBCLASS_CURRENT', 'USAPPLICATIONCITATION', 'USPATENTCITATION', 'USPC', 'USPC_CURRENT', 'USRELDOC', 'US_TERM_OF_GRANT', 'WIPO', 'WIPO_FIELD']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **PATENT**

   - `"id"`: Patent identifier (used to join with other tables).
   - `"country"`: Country of the patent (used to filter for U.S. patents).

2. **APPLICATION**

   - `"patent_id"`: Patent identifier (used to join with PATENT and get application dates).
   - `"date"`: Application date of the patent (used to calculate time differences).

3. **USPATENTCITATION**

   - `"patent_id"`: The citing patent's ID.
   - `"citation_id"`: The cited patent's ID.
   - `"date"`: Date related to the citation (usage depends on context).

**Conditions That May Be Used:**

- **Filter for U.S. patents**: `PATENT."country" = 'US'`
- **Calculate time differences** between application dates to determine citations within 1 year.
- **Date conversions**: Use `TO_DATE` to convert string dates to date format for calculations.
- **Date difference**: Use `DATEDIFF` function to find the difference in years between two dates.
- **Limit results**: Use `LIMIT` to restrict the number of rows returned.
- **Grouping and counting**: Use `GROUP BY` and `COUNT(*)` to aggregate citation counts.
- **Ordering results**: Use `ORDER BY` to sort results based on citation counts.

---

**Sample SQL Queries:**

1. **Retrieve sample U.S. patents with their application dates:**

   ```sql
   SELECT p."id", p."country", a."date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT p
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
   WHERE p."country" = 'US'
   LIMIT 100;
   ```

2. **Get a sample of patent citations:**

   ```sql
   SELECT "uuid", "patent_id", "citation_id", "date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   LIMIT 100;
   ```

3. **Find backward citations made by U.S. patents:**

   ```sql
   SELECT c."patent_id", c."citation_id", c."date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
   WHERE p."country" = 'US'
   LIMIT 100;
   ```

4. **Get application dates of citing and cited patents:**

   ```sql
   SELECT c."patent_id", c."citation_id", a1."date" AS "citing_app_date", a2."date" AS "cited_app_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
   LIMIT 100;
   ```

5. **Count backward citations for each patent:**

   ```sql
   SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   GROUP BY c."patent_id"
   ORDER BY COUNT(*) DESC
   LIMIT 100;
   ```

6. **Count backward citations within 1 year of application date:**

   ```sql
   SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
   WHERE ABS(DATEDIFF('year', TO_DATE(a1."date", 'YYYY-MM-DD'), TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
   GROUP BY c."patent_id"
   LIMIT 100;
   ```

7. **Identify the patent with the most backward citations within 1 year:**

   ```sql
   SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
   WHERE ABS(DATEDIFF('year', TO_DATE(a1."date", 'YYYY-MM-DD'), TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
   GROUP BY c."patent_id"
   ORDER BY COUNT(*) DESC
   LIMIT 1;
   ```

8. **Retrieve forward citations to patents within 1 year of their application date:**

   ```sql
   SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
   WHERE ABS(DATEDIFF('year', TO_DATE(a2."date", 'YYYY-MM-DD'), TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
   GROUP BY c."citation_id"
   LIMIT 100;
   ```

9. **Find forward citations to the patent with most backward citations within 1 year:**

   ```sql
   SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
   WHERE c."citation_id" = 'max_back_patent_id'
     AND ABS(DATEDIFF('year', TO_DATE(a2."date", 'YYYY-MM-DD'), TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
   GROUP BY c."citation_id"
   LIMIT 1;
   ```

10. **List U.S. patents with counts of backward citations within 1 year:**

    ```sql
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    WHERE p."country" = 'US'
      AND ABS(DATEDIFF('year', TO_DATE(a1."date", 'YYYY-MM-DD'), TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
    GROUP BY c."patent_id"
    ORDER BY COUNT(*) DESC
    LIMIT 100;
    ```

11. **Get the application dates and countries of cited patents:**

    ```sql
    SELECT c."citation_id", a."date" AS "cited_app_date", p."country" AS "cited_country"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON c."citation_id" = a."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."citation_id" = p."id"
    LIMIT 100;
    ```

12. **List patents and their total number of citations received within 1 year of their application date:**

    ```sql
    SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
    WHERE ABS(DATEDIFF('year', TO_DATE(a2."date", 'YYYY-MM-DD'), TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
    GROUP BY c."citation_id"
    ORDER BY COUNT(*) DESC
    LIMIT 100;
    ```

13. **Get patents with their issue dates and application dates:**

    ```sql
    SELECT p."id", p."date" AS "issue_date", a."date" AS "application_date"
    FROM PATENTSVIEW.PATENTSVIEW.PATENT p
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
    LIMIT 100;
    ```

14. **Find patents citing a specific patent within 1 year of its application date:**

    ```sql
    SELECT c."patent_id", c."citation_id", a1."date" AS "cited_app_date", a2."date" AS "citing_app_date"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
    WHERE c."citation_id" = 'specific_patent_id'
      AND ABS(DATEDIFF('year', TO_DATE(a2."date", 'YYYY-MM-DD'), TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
    LIMIT 100;
    ```

15. **List patents along with the number of forward and backward citations within 1 year:**

    ```sql
    SELECT patent_id, SUM(num_forward_citations) AS total_forward, SUM(num_backward_citations) AS total_backward
    FROM (
      SELECT c."citation_id" AS patent_id, COUNT(*) AS num_forward_citations, 0 AS num_backward_citations
      FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
      WHERE ABS(DATEDIFF('year', TO_DATE(a2."date", 'YYYY-MM-DD'), TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
      GROUP BY c."citation_id"
      UNION ALL
      SELECT c."patent_id", 0 AS num_forward_citations, COUNT(*) AS num_backward_citations
      FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
      JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
      WHERE ABS(DATEDIFF('year', TO_DATE(a1."date", 'YYYY-MM-DD'), TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
      GROUP BY c."patent_id"
    ) sub
    GROUP BY patent_id
    LIMIT 100;
    ```

---

These queries explore various aspects of the data to help understand how to determine:

- The number of backward citations within 1 year from the application date for each patent.
- The patent with the most backward citations within 1 year.
- The number of forward citations within 1 year from the application date for a given patent.
- The relationships between citing and cited patents based on application dates.

The queries use relevant tables and columns, apply necessary conditions, and adhere to the specified requirements, such as limiting the number of rows and using distinct column names.Query:
SELECT p."id", p."country", a."date" AS "application_date"
   FROM PATENTSVIEW.PATENTSVIEW.PATENT p
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
   WHERE p."country" = 'US'
   LIMIT 100;
Answer:
id,country,application_date
D396456,US,1994-01-21
D394631,US,1994-08-02
D388775,US,1994-09-01
D391947,US,1995-05-05
D392963,US,1995-05-05
D384418,US,1995-05-19
D388136,US,1995-06-05
D385266,US,1995-09-08
D397064,US,1995-09-27
D394722,US,1995-12-13
D403435,US,1995-12-21
D388528,US,1996-01-22
D399212,US,1996-02-09
D391948,US,1996-02-14
D384439,US,1996-02-29
D386744,US,1996-03-01
D384435,US,1996-03-27
D386360,US,1996-04-23
D385353,US,1996-04-29
D389840,US,1996-04-30
D383936,US,1996-05-07
D388444,US,1996-05-23
D396284,US,1996-05-29
D386367,US,1996-05-31
D386870,US,1996-06-07
D384946,US,1996-07-09
D387926,US,1996-07-19
D387281,US,1996-07-19
D395202,US,1996-07-22
D385463,US,1996-08-16
D386325,US,1996-08-20
D391786,US,1996-08-21
D394093,US,1996-08-22
D394588,US,1996-08-26
D392007,US,1996-08-27
D403186,US,1996-08-29
D387007,US,1996-09-06
D386133,US,1996-09-11
D395364,US,1996-09-13
D392144,US,1996-09-18
D386818,US,1996-09-30
D391580,US,1996-10-16
D385862,US,1996-10-17
D401184,US,1996-10-22
D393522,US,1996-10-22
D389286,US,1996-10-25
D391656,US,1996-11-08
D401340,US,1996-11-12
D402384,US,1996-11-15
D388840,US,1996-11-18
D397862,US,1996-11-22
D395356,US,1996-11-27
D391516,US,1996-11-29
D393911,US,1996-12-05
D397095,US,1996-12-09
D386736,US,1996-12-17
D391687,US,1996-12-24
D394322,US,1997-01-06
D399997,US,1997-01-06
D400324,US,1997-01-10
D390986,US,1997-01-14
D392519,US,1997-01-15
D394561,US,1997-01-29
D388381,US,1997-02-12
D392303,US,1997-02-14
D403091,US,1997-02-18
D387763,US,1997-02-24
D392959,US,1997-02-26
D393899,US,1997-02-28
D393049,US,1994-08-18
D388460,US,1994-11-28
D392622,US,1995-03-28
D387207,US,1995-05-10
D397157,US,1995-08-04
D384021,US,1995-09-05
D383906,US,1995-10-11
D396755,US,1995-11-03
D394000,US,1995-11-20
D390967,US,1996-01-02
D384111,US,1996-01-04
D383891,US,1996-01-11
D397677,US,1996-01-29
D391215,US,1996-03-07
D393638,US,1996-03-08
D389526,US,1996-03-15
D384819,US,1996-03-22
D385531,US,1996-03-26
D384444,US,1996-04-08
D401861,US,1996-04-30
D394225,US,1996-05-06
D397167,US,1996-05-14
D385529,US,1996-05-15
D391542,US,1996-05-23
D402621,US,1996-05-24
D389444,US,1996-05-24
D386176,US,1996-05-31
D386509,US,1996-06-07
D387035,US,1996-06-10
D392711,US,1996-06-20
D388830,US,1996-06-25
Query:
SELECT "uuid", "patent_id", "citation_id", "date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION
   LIMIT 100;
Answer:
Too long, hard cut:
uuid,patent_id,citation_id,date
uw9ozu90526jbrp6bkgrsa7ug,4233808,524,1837-12-01
2v6errxk0imqlqpljqyc1hdnk,5418423,H60,1986-05-01
wczaz39w3wsq0w8z1sespsve4,5445606,H71,1986-06-01
n7uo4k2d6ujcxzk5m5n2c9uab,4671363,1482,1840-01-01
093ps1aznu4twc2wlh5q8zqnc,4295314,1887,1840-12-01
2psm2pgoavmu4uxp92hhkr57d,5666885,1931,1841-01-01
ytdsbj900b8olpta54t71b3fy,D283714,4174,1870-06-01
cc2y7c7x3jz8qci3cfa1h6s39,5048848,7345,1876-10-01
ifnynku5a2rrrgk64vcj4e01r,4612868,8164,1851-06-01
faz72gr84wbj1rplfh1xit51w,5611671,8834,1835-05-01
yyaruiqdf54z3coz1t84ky289,5009345,9837,1853-07-01
kwq23s4hqdj6cde6i8h6tbgow,D311841,D392,1851-07-01
4j05fb9wn1l11eoandwlk34gw,4815385,H162,1986-11-01
f395pepp5acn6xplv5qbjh1uw,5798553,H204,1987-02-00
y21xe3cvzl7v38r37l80145gw,5561678,H275,1987-05-01
n63s3kamg8r34e7kd3khgfs46,4911487,H358,1987-11-01
lqpzclgdv7ajfa8dmjucfkszy,5221744,H531,1988-10-01
bqa2icahemi04xdg79a8m89e3,5940597,H586,1989-02-01
9c2uydekhboe1l6di943z6j0d,5211875,H724,1990-01-01
b18hmno6j5p8v1bn9nvef78oz,6073962,H767,1990-04-01
lhg18m89ep6ovcvmzdlcyrzlh,5349364,H880,1991-01-01
7ujqrwxkg7fajgvhrxx9ufn5g,5651474,H943,1991-08-01
wgvmkjgsacqz4huidv001tulx,5224658,11368,1854-07-01
ql7p55wxlfhog5ugvhbsujb5b,5090897,13387,1912-03-01
wca77wptgv312293fsrcxf9ht,D316160,15211,1884-08-01
onl0b5pjxmq5m2x8hbrz0fe96,D395737,17748,1857-09-00
94pwkhtn61fm4iv8wuw3gxrj9,4588302,19413,1858-02-01
t9wilm4xqvn2kd1tctrsa1bqh,4665741,21487,1858-09-01
s9npkw77s0prx48smncxm2z6g,5514166,22080,1958-11-01
ryy9kznq1cbtfzlvjmdtb7zjw,D358251,22456,1893-05-01
rnt27gh82bacgt6no5smeav1c,5920920,23335,1859-03-01
vj6stk2fq455v4rfdy7z3luyp,5941231,24840,1859-07-01
472vdhebd91tsu503l135juk6,4568320,24874,1908-11-01
mvlwpzwxhkm26zi22bs6w1urw,5030203,25129,1962-02-01
awwgz487hmmx0s2jv2sfb5pqf,5794810,26188,1859-11-00
hizyjia69mshxibmxqydvfgse,5013461,26709,1869-11-01
of5r3ft3jwyjj1o6mvjk0q9av,4729321,29995,1860-09-01
5hzxd3ci2k32oavkh0t0urm1p,5005259,31574,1861-02-01
b2kxzfhwe9n3ftjluq7j159f1,5239018,32136,1886-05-01
5w61fg4b4dll80b4ukuccz5uu,5248309,32649,1988-04-01
2n15q13kaq1v3nsi7plycohrq,5060706,32693,1888-06-01
0xdwez1dq0p19m6yk1kapun52,D350403,34792,1901-07-01
1oq3lvzy44gtq2dcouq6lgynw,D377562,34991,1901-08-01
5sbptbzdy5p87numca2kf0hkq,4688727,35036,1862-04-01
f3a14pjuwi11cbx4bpb063o1q,5479861,36773,1862-10-01
l82aaitjmtvx2vujom6xyqv0u,5329869,37849,1863-03-01
0ak1um7juawlmgv60xzgktkcz,4101419,39150,1863-07-01
d0npbfw4ikm2kgvppr7wi291v,6327797,39575,1863-08-01
2qtlmezsf4bf4b080d9xrhicr,4239460,39974,1863-09-01
3b3rmpx3hrou66f9ncni7weoy,5228705,40921,1863-12-01
nvnml3ug678xcmv0ett1wxhm1,3962925,41574,1864-02-01
u4gbkfh9utqw0j5jq87ak4pvi,D452982,43931,1864-08-01
ofs5kfyj2kguu8tftql127kun,5714098,45178,1864-11-00
h2djwzgznsmhv19h8tm8zemvb,5875785,45258,1864-11-01
u1gju31irntca1qfxnoehihl9,4669324,46056,1865-01-01
184f79avwfajcbfk3lt3z928c,5727698,46296,1865-02-00
nv9yffffsqbf3sfjpcni6mpp3,D441147,46579,1865-02-01
xs4nbcjgfq376v8o4hz5ua5im,4360315,50705,1865-10-01
7c476eh0gd56wqaojh3jrqtha,6113158,52010,1866-01-01
qabpw95r7mqgy06yqtgs8pp5w,D327304,53426,1919-06-01
5d4syrrkbx99xbgy1yte69mub,5429831,56217,1866-07-01
wcv3nv0mwqfmjde1lzuar7lzz,4269417,56326,1866-10-01
e7rmoikk1y74lb4jcn2ldexzl,4702856,59724,1866-11-01
ewuejo7msqhzv6628pc4xmg8a,5015399,61880,1867-02-01
j9m91zwhnzwm445vnwfjk9y37,4437634,63383,1867-04-01
6bovgqv1hm7b62vqcgwy0mhep,5570971,64757,1867-05-01
kl9ovkm3wbfumoaxwgpqjv7lp,4678011,66631,1867-07-01
axxoedfi6m251s1peo6qkfa8k,5354077,68558,1887-09-01
xlscad07q371iui2ndp8fnier,4967939,69485,1867-10-01
rplhk4ytmkz17q9q82j6s6h27,6099490,70683,1867-11-01
z1l67879l9wchgifg4yoij3dh,4146982,70849,1867-11-01
fodmfzrzgh1q0psagcgbhgcub,4858867,70884,1867-11-01
bzm6cvc72ug8ki0xwo4ninfes,5141236,73006,1868-01-01
gm4t5cr0du3vihuxxh7h9q8jz,4394803,74707,1868-02-01
v94hxxpj1ulfbqocqa50qj5vu,4488381,76755,1868-04-01
0oj7ljmh7xhc324lahqnrv7ma,4018394,77102,1868-04-01
1fck9d2j1ptf0khuhgzv40ezf,5067396,77884,1868-05-01
q4jx0llbnrlsp99o1kc6abscj,6044570,79052,1868-02-01
d6edchh9hhr5eyrx4knfovx26,4676772,79436,1868-06-01
3dlkox34l2dn524tgm4x8a9u0,D396895,81947,1868-09-00
8coi9ug6az4g7yx5viba49d5u,D405235,83973,1868-11-01
5d86wcoqez9fkat02yu5o0rbt,4112838,86045,1969-01-01
ng8hrlogy5cw0pyx1v1mgb5i8,D404519,86101,1869-01-01
kr1kb0bncszj3ljtu2qm75bf5,5571229,87015,1869-02-01
uwhma3hzydnlbd6zu27av2uyf,5667122,88505,1869-03-01
cnbiq7uc4z2g40p43l1yif833,4574977,90036,1869-05-01
85xughuh0mykocsq97hqm5tj6,4096853,90217,1869-05-00
5pl9la9gl3hcaihon5bjno9t1,4901645,90732,1869-01-01
mp1aw6qlza4p0ce506yprkzg2,5383675,90837,1869-06-01
53akjddbmdncmmsglmtn366fa,D304074,92049,1869-06-01
4p4e3dswlkwymqlh4xpo6y2zd,6344226,92640,1869-07-01
wb2ijlilmsi3pbjgignni0d1a,4598447,94503,1869-09-01
f9l4nb4xl0uypitkyhapwgpta,4867255,94854,1869-09-01
3k0xdjqn6xtzfvi8o9t6sok8z,5666885,95705,1869-10-01
nsuut6p5za7ypwu5sn8tt8592,6164033,97316,1869-11-01
r1t60wvcqrgscczpt12nwi84y,D415547,98439,1869-12-01
5za0o1sheg0gt1yzl687wfhqc,D266832,D2599,1867-03-01
2qwd6qox5k5hvleyx735hvuq4,D365016,D3310,1869-0
Query:
SELECT c."patent_id", c."citation_id", c."date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
   WHERE p."country" = 'US'
   LIMIT 100;
Answer:
patent_id,citation_id,date
8620900,6976025,2005-12-01
11030408,6976031,2005-12-01
11080232,6976039,2005-12-01
9971784,6976039,2005-12-01
9507617,6976059,2005-12-01
10540159,6976079,2005-12-01
10116738,6976090,2005-12-01
9338523,6976090,2005-12-01
9986419,6976090,2005-12-01
8902915,6976095,2005-12-01
9032132,6976105,2005-12-01
9788215,6976160,2005-12-01
10285094,6976160,2005-12-01
9509682,6976164,2005-12-01
9641490,6976165,2005-12-01
9189392,6976190,2005-12-01
10459710,6976193,2005-12-01
9852205,6976210,2005-12-01
9256664,6976210,2005-12-01
8849850,6976210,2005-12-01
8739302,6976259,2005-12-01
9339074,6976321,2005-12-01
10865545,6976325,2005-12-01
10617227,6976348,2005-12-01
10113823,6976416,2005-12-01
10556720,6976438,2005-12-01
8447648,6976439,2005-12-01
10736304,6976452,2005-12-01
10087357,6976542,2005-12-01
D724696,6976543,2005-12-01
10286409,6976543,2005-12-01
10152624,6976626,2005-12-01
10002272,6976631,2005-12-01
8713829,6976660,2005-12-01
9169821,6976683,2005-12-01
8857387,6976683,2005-12-01
D704600,6976697,2005-12-01
9126417,6976753,2005-12-01
9954993,6976799,2005-12-01
10351229,6976829,2005-12-01
10213160,6976857,2005-12-01
10268014,6976867,2005-12-01
8648932,6976954,2005-12-01
9775529,6976958,2005-12-01
8499252,6976958,2005-12-01
9775567,6976965,2005-12-01
8936021,6976969,2005-12-01
9913776,6976969,2005-12-01
9339425,6976978,2005-12-01
9492315,6976982,2005-12-01
9687263,6976983,2005-12-01
10449330,6976987,2005-12-01
9050141,6976988,2005-12-01
10208468,6977005,2005-12-01
9670351,6977105,2005-12-01
10557691,6977140,2005-12-01
8815513,6977148,2005-12-01
9269648,6977188,2005-12-01
10472750,6977231,2005-12-01
11116717,6977250,2005-12-01
10799476,6977257,2005-12-01
8648197,6977265,2005-12-01
8791087,6977295,2005-12-01
9164099,6977305,2005-12-01
9126184,6977319,2005-12-01
8608889,6977324,2005-12-01
9554549,6977327,2005-12-01
11109546,6977351,2005-12-01
9904327,6977352,2005-12-01
10179730,6977468,2005-12-01
8882791,6977495,2005-12-01
10966744,6977495,2005-12-01
9872725,6977495,2005-12-01
9287075,6977569,2005-12-01
8367991,6977598,2005-12-01
9244157,6977608,2005-12-01
10595574,6977615,2005-12-01
9401025,6977630,2005-12-01
8515132,6977643,2005-12-01
9083830,6977685,2005-12-01
10937755,6977686,2005-12-01
8923564,6977687,2005-12-01
8760576,6977690,2005-12-01
10218848,6977740,2005-12-01
9053727,6977789,2005-12-01
9245555,6977790,2005-12-01
9153283,6977793,2005-12-01
10205395,6977824,2005-12-01
8612670,6977847,2005-12-01
8947382,6977868,2005-12-01
9453742,6977868,2005-12-01
9913289,6977888,2005-12-01
8789201,6977894,2005-12-01
8520688,6977896,2005-12-01
9262225,6977939,2005-12-01
8976280,6977985,2005-12-01
8995641,6977992,2005-12-01
9906651,6977992,2005-12-01
10757262,6978006,2005-12-01
10218515,6978017,2005-12-01
Query:
SELECT c."patent_id", c."citation_id", a1."date" AS "citing_app_date", a2."date" AS "cited_app_date"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
   JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
   LIMIT 100;
Answer:
patent_id,citation_id,citing_app_date,cited_app_date
9104930,7221394,2013-07-03,2003-08-21
8735090,7221443,2013-03-28,2004-01-23
9390359,7221473,2014-11-14,2001-08-03
8941631,7221495,2008-11-14,2003-06-24
11115166,7221645,2020-03-19,2001-07-03
9064164,7221660,2013-09-30,2001-08-08
10453023,7221668,2014-09-17,2005-08-08
10074069,7221668,2015-09-23,2005-08-08
9621198,7221680,2014-12-03,2004-09-01
9449781,7221731,2014-12-08,2003-11-21
9445418,7221750,2015-09-15,2006-01-20
9025086,7221787,2013-04-11,2002-12-10
9177372,7221788,2015-01-21,2003-07-01
9006628,7221847,2010-04-05,2004-08-03
8681225,7221863,2006-04-03,2005-02-02
10097798,7221910,2017-06-06,2003-10-17
10333525,7221921,2016-12-06,2003-12-08
9766079,7221937,2015-09-30,2003-05-05
9338153,7221959,2013-04-10,2003-10-14
D835283,7221971,2017-04-28,2005-12-19
9408587,7221972,2009-08-21,2004-07-16
9566441,7221979,2010-04-30,2003-04-30
8447411,7221979,2009-04-30,2003-04-30
8433403,7221980,2010-02-22,2001-08-14
9434072,7221983,2012-09-17,2003-11-25
9182895,7222021,2013-12-10,2002-09-03
9498159,7222054,2007-10-30,2002-03-04
10235383,7222078,2013-12-19,2003-12-10
9244887,7222082,2012-07-13,2000-08-28
10191982,7222090,2010-01-22,2002-05-01
8700441,7222102,2009-03-25,2002-03-20
8379841,7222114,2007-03-22,2003-08-20
10853173,7222133,2019-04-03,2004-02-05
9398001,7222158,2014-01-10,2003-12-31
8595475,7222163,2012-02-17,2001-04-06
9491511,7222163,2015-12-22,2001-04-06
9467481,7222190,2014-07-25,2001-12-07
10508921,7222293,2017-12-28,2000-08-11
9521099,7222299,2016-06-22,2003-12-19
10831509,7222302,2017-08-28,2003-06-05
9319913,7222304,2015-04-13,2003-07-30
8441793,7222339,2010-07-21,2003-06-13
8745622,7222343,2009-04-22,2003-01-16
9819230,7222356,2014-05-07,2000-01-11
10266195,7222363,2016-12-19,2002-12-09
9307975,7222380,2014-06-19,2003-04-21
10654689,7222460,2019-09-30,2002-07-17
8738329,7222544,2011-03-03,2005-03-07
10032526,7222623,2013-03-15,2004-12-29
8434479,7222623,2009-02-27,2004-12-29
8616207,7222624,2010-09-07,2004-07-02
8376138,7222736,2008-10-22,2003-06-13
10232791,7222763,2016-06-08,2004-07-12
10547446,7222791,2017-05-01,2004-03-30
8766194,7222800,2013-09-26,2004-06-03
8857738,7222802,2008-03-26,2004-04-28
D764599,7222852,2014-08-01,2003-02-05
8590950,7222873,2011-05-17,2004-12-10
9004618,7222924,2011-05-20,2004-11-10
10646755,7223180,2017-12-20,2004-08-06
10569144,7223180,2018-07-27,2004-08-06
11007860,7223200,2019-08-14,2002-10-02
9375596,7223212,2014-12-30,2003-11-29
8535217,7223229,2006-07-25,2006-05-01
10555769,7223229,2016-02-22,2006-05-01
11096752,7223229,2020-01-02,2006-05-01
9433339,7223232,2012-11-02,2004-01-20
11004125,7223234,2020-09-24,2005-07-08
10496803,7223234,2019-01-07,2005-07-08
11120161,7223234,2020-12-28,2005-07-08
8845513,7223239,2011-03-03,2005-01-10
9808332,7223253,2015-07-22,2002-07-29
10231753,7223256,2016-11-30,2003-05-01
10368908,7223257,2016-08-31,2004-08-31
9821108,7223257,2014-07-25,2004-08-31
10570294,7223270,2016-11-17,2004-02-10
9642687,7223270,2011-06-01,2004-02-10
9375219,7223271,2014-05-22,2002-05-13
10231738,7223272,2016-05-03,2004-06-14
9649102,7223278,2015-07-08,2003-05-16
8556962,7223286,2005-05-25,2004-09-28
8591590,7223289,2012-08-10,2002-04-16
10576130,7223346,2015-12-18,2005-04-18
9895418,7223346,2013-03-15,2005-04-18
8678233,7223361,2011-11-22,2005-08-16
9873904,7223364,2014-09-23,2000-07-07
11002743,7223365,2018-02-13,2001-01-24
9265887,7223394,2012-01-24,2001-03-07
9090449,7223427,2013-08-08,2002-10-14
10683455,7223432,2019-04-02,2003-04-04
8828601,7223494,2011-02-21,2002-07-24
8835053,7223498,2008-03-18,2004-10-08
10544456,7223540,2017-07-20,2003-01-15
11039816,7223540,2016-03-30,2003-01-15
10730906,7223545,2003-07-30,2004-09-24
10828356,7223557,2019-05-13,2002-05-22
8372606,7223572,2009-06-25,2000-04-07
9173365,7223577,2013-02-20,2005-05-31
8378715,7223612,2012-08-24,2004-07-26
9431323,7223634,2015-02-05,2004-07-26
Query:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations"
   FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
   GROUP BY c."patent_id"
   ORDER BY COUNT(*) DESC
   LIMIT 100;
Answer:
patent_id,num_backward_citations
8892495,5828
11103241,5769
11090045,5684
11051807,5617
9980729,5444
11000274,5379
10945729,5320
10779825,5196
11026680,5162
10881399,5156
10695058,5065
10888322,5038
10716565,5037
10835249,4941
10959722,4730
10537325,4688
10765425,4620
10575868,4476
9986419,4468
11051811,4445
10463384,4380
10433844,4322
10368867,4285
10368864,4266
10485541,4266
10293100,4262
10271849,4233
10842491,4218
10245032,4212
10335148,4151
10390841,4142
10448948,4127
10433918,4120
10238391,4101
10625137,3937
10278780,3749
10172616,3708
10687810,3223
D896380,3216
10517599,3054
10765424,2878
10172619,2867
10117652,2756
10052100,2755
10028743,2725
9999426,2723
9901345,2717
9962158,2714
9974538,2713
9788836,2696
9592053,2638
9693777,2620
9585663,2605
9775609,2586
9962486,2573
8758323,2502
11120372,2464
10449416,2442
9804618,2436
9662110,2425
9700317,2401
9408604,2397
9749790,2395
9649111,2319
10791176,2277
9433419,2271
11096752,2170
10952788,2140
9253616,2118
10898256,2109
9668024,2096
11006971,2096
10709469,2091
9031581,2085
10966744,2083
9966068,2031
10185542,2030
11069510,2008
D922229,1996
9721566,1966
9886953,1965
10101822,1965
10679605,1936
10553209,1930
10675035,1921
10241644,1905
9760559,1893
9966065,1887
10078631,1881
10555769,1879
10446141,1864
9483461,1864
10463421,1850
10376305,1844
10312567,1816
9865911,1807
8403864,1783
8202231,1777
8763875,1777
8430828,1771
Query:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."patent_id"
LIMIT 100;
Answer:
patent_id,num_backward_citations_within_1_year
4085362,2
4030123,1
4045778,1
4149593,2
4116720,3
4175685,2
4262066,1
4331129,1
4447435,2
4374775,1
4452098,1
4556068,1
4797273,3
4897361,8
4852041,7
5050453,1
4558376,2
4562128,2
D292529,1
4658280,2
4738683,2
4841134,2
4710818,3
4706493,1
4785330,2
4807210,1
4956675,2
4983566,4
4902037,1
5121472,2
5113267,1
5171613,3
D339711,3
4956003,1
4969443,2
4987428,6
5090345,1
5199492,1
5633574,1
5623160,1
6030857,8
5814370,2
4731818,1
4829017,11
5057860,2
5115303,1
5244819,5
5313451,5
5576705,2
6130623,14
6008891,1
D417582,1
5956497,6
6002441,3
5975788,1
5930665,1
6126732,1
D336109,1
D382438,1
D624338,4
D719121,17
D711243,14
D817935,4
D781113,2
4917048,1
4335428,1
4569128,2
4924936,2
4753348,1
4965271,3
5214784,11
4862989,1
5148523,9
5069732,1
5212831,5
5042347,1
5056485,4
5078683,3
5299235,2
5767626,1
5758281,4
5935680,1
5937582,1
5276238,3
5581497,5
5578174,2
5668852,2
5611257,1
5794125,1
5523195,1
5812972,2
5873347,3
6207370,8
6139167,3
6076877,3
5800253,1
6114991,5
6073169,2
6119613,1
6338158,4
Query:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."patent_id"
ORDER BY COUNT(*) DESC
LIMIT 1
Answer:
patent_id,num_backward_citations_within_1_year
10835249,476
Query:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND ABS(DATEDIFF('year', TRY_TO_DATE(a2."date", 'YYYY-MM-DD'), TRY_TO_DATE(a1."date", 'YYYY-MM-DD'))) <= 1
GROUP BY c."citation_id"
LIMIT 100
Answer:
patent_id,num_forward_citations_within_1_year
3960752,1
3980400,1
3963680,1
4008719,1
4079284,1
4115425,1
4160982,2
4267011,1
4170119,2
4252014,1
4243264,1
4332010,1
4374912,1
4291240,1
4407185,1
4439260,1
4518879,1
4564575,1
4784913,1
4787759,1
4887265,1
4910373,1
4981337,1
4964880,1
4972363,1
4936174,1
5103831,1
5269220,1
5508990,1
5423594,2
4353184,1
4739409,1
4709774,1
4807229,1
4923959,1
5011720,1
5146654,1
5134925,1
5249174,1
5193738,1
5335782,1
5423062,1
5462804,1
5482908,1
5424006,1
5442399,1
5704163,1
5714967,1
5597995,3
5673254,1
5270616,1
5751906,1
5874479,1
5965894,1
D442146,1
D521023,7
D576154,1
D622545,2
D637706,1
D642866,1
D647679,1
D770491,1
D803631,2
4205190,2
4186025,1
4229555,1
4524140,2
4522726,2
4617140,1
4856380,1
4937806,2
4916144,1
5007719,1
5057871,1
5142363,1
5390040,1
4799774,1
4825278,1
4970188,1
5104466,1
5169027,1
5276217,1
5332528,2
5345402,1
5336356,2
5430263,1
5496400,1
5438311,1
5451410,2
5497463,1
5542554,1
5597602,1
5622977,1
5765098,1
5720341,1
4852976,3
5186042,1
5189748,3
5354188,1
5361195,1
Query:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."citation_id"
LIMIT 100;
Answer:
patent_id,num_forward_citations_within_1_year
7666094,1
7820676,1
8306937,2
7733077,2
7841967,1
7959626,1
8108460,2
8637540,2
8685008,1
8756325,3
9457182,2
9213485,3
9807104,2
D800904,7
D687819,3
3980400,1
8421865,2
8493679,1
8364136,1
8514183,1
8688388,1
9035062,1
9115101,1
9228194,1
9306666,1
9374586,1
9172094,1
9655188,1
9922540,1
9974529,12
10420491,1
4079284,1
4008719,1
4852976,3
4936174,1
5007719,1
5361195,1
5415794,1
9205001,1
D751340,2
D750746,1
10108961,2
10129646,3
4617140,1
4709774,1
4923959,1
5273523,1
5442399,1
5462804,1
5497463,1
5707486,1
5874479,1
6082071,1
6165707,1
8032233,1
8407067,1
9293326,1
8347322,2
8308732,2
8551101,1
8728131,1
9621934,1
9689466,9
9706981,1
D551243,1
D732012,1
D692110,2
D738096,1
10039906,4
10564936,2
3960752,1
4267011,1
4799774,1
9208071,1
9788835,2
D699179,1
D803850,12
10842491,3
10058373,7
4229555,1
5146654,1
5169027,1
10317787,2
4964880,1
5430263,1
5551963,1
5735066,1
5938422,1
5984017,1
5661496,1
5673254,1
6117354,1
5781218,1
6088698,1
5778386,1
5911717,1
5986135,1
6077840,4
D287588,1
D388480,1
Query:
SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
WHERE p."country" = 'US'
  AND TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a2."date", 'YYYY-MM-DD'), TRY_TO_DATE(a1."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."patent_id"
ORDER BY COUNT(*) DESC
LIMIT 100
Answer:
patent_id,num_backward_citations_within_1_year
10888322,176
10835249,174
10433918,152
10433844,149
10945729,144
7410468,124
11000274,108
7589029,104
10271849,102
10537325,101
10575868,101
8149048,100
10779825,96
10517599,94
10335148,93
10881399,92
10687810,92
10595835,92
11026680,92
10919230,83
10695058,80
10959722,77
10485541,75
9433419,72
9563733,72
9649111,70
8816402,69
7172614,68
10368867,65
8669595,65
11051811,63
8758323,62
10245032,61
10448948,61
8065713,59
D853924,59
8344088,58
10172616,58
11090045,58
9137739,58
10716565,57
10172619,57
6994160,56
11103241,55
7017661,53
10729402,53
7547321,52
8672844,51
6202111,51
6212585,50
8333710,50
6263387,50
10463421,50
9700317,50
D930961,49
8984740,48
7682669,47
7178236,46
7476925,46
7400155,46
D893838,45
9755842,45
9780834,45
7524910,45
11035511,45
10409629,45
10238391,45
7425215,44
8771183,43
10076139,43
11114195,43
D928799,43
9685992,42
9775545,42
8162853,40
9775609,40
10504185,40
8895311,40
10449416,40
9125667,40
D691990,40
D750632,40
6182180,40
9189392,40
7398832,40
7901426,39
11099380,39
8952634,39
D893843,39
D920309,38
10770800,38
9368134,38
6337102,38
10675035,37
9078685,37
10373259,37
D486548,36
7240728,36
9782077,36
10625137,36
Query:
SELECT c."citation_id", TRY_TO_DATE(a."date", 'YYYY-MM-DD') AS "cited_app_date", p."country" AS "cited_country"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON c."citation_id" = a."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."citation_id" = p."id"
WHERE TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL
LIMIT 100
Answer:
citation_id,cited_app_date,cited_country
6979090,2003-10-20,US
6979204,2004-02-18,US
6979267,2002-07-12,US
6979267,2002-07-12,US
6979267,2002-07-12,US
6979312,2002-11-18,US
6979601,2003-04-21,US
6980077,2004-08-19,US
6980092,2001-04-05,US
6980433,2004-12-23,US
6980547,2000-10-31,US
6980716,2002-03-29,US
6981029,2001-07-17,US
6981295,2005-01-24,US
6982027,2001-10-25,US
6982311,2002-07-31,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6982367,2004-02-12,US
6983031,2001-09-05,US
6983370,2001-11-27,US
6983886,2003-07-16,US
6984158,2004-02-20,US
6984188,2003-03-10,US
6984719,1999-09-15,US
6984970,2003-09-22,US
6984970,2003-09-22,US
6985831,2002-10-18,US
6985839,2001-05-03,US
6986118,2003-09-26,US
6986118,2003-09-26,US
6986353,2004-01-03,US
6986370,2000-02-01,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986451,2000-07-26,US
6986988,2001-04-11,US
6986988,2001-04-11,US
6987317,2003-09-30,US
6987732,2000-12-15,US
6988139,2002-04-26,US
6988219,2002-08-28,US
6988667,2002-05-30,US
6989195,2003-07-23,US
6989954,2004-01-31,US
6989962,2003-02-24,US
6990148,2003-01-23,US
6990335,2005-06-06,US
6990335,2005-06-06,US
6990366,2003-11-24,US
6990381,2002-12-05,US
6990591,1999-12-22,US
6990804,2004-04-12,US
6991505,2004-04-29,US
6991873,2001-10-05,US
6991998,2004-07-02,US
6992123,2003-11-05,US
6992419,2003-06-25,US
6992501,2004-03-15,US
6992501,2004-03-15,US
6992543,2002-11-22,US
6992598,2002-12-24,US
6992598,2002-12-24,US
6992686,2004-06-14,US
6992851,2004-06-30,US
6992919,2003-12-08,US
6993157,2000-05-18,US
6993242,2003-08-14,US
6993308,2001-07-25,US
6993332,2002-06-05,US
6993332,2002-06-05,US
6993421,2002-12-20,US
6993564,2000-12-22,US
6993660,2001-12-10,US
6993877,2002-10-09,US
6993960,2003-04-10,US
6994160,2001-04-24,US
6994169,2002-04-24,US
6994320,2004-09-14,US
6994637,2004-05-18,US
6994825,2003-04-23,US
6994904,2001-05-02,US
6994907,2003-04-25,US
6995169,2002-05-14,US
6995169,2002-05-14,US
6995456,2004-03-12,US
6995667,2002-12-23,US
6995925,2003-03-04,US
6996427,2003-12-18,US
6996427,2003-12-18,US
6996427,2003-12-18,US
6996427,2003-12-18,US
6996455,2003-06-05,US
6996537,2001-08-13,US
6997918,2003-03-04,US
6998124,2000-04-14,US
Query:
SELECT c."citation_id" AS "patent_id", COUNT(*) AS "num_forward_citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"  -- Cited patent
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"    -- Citing patent
WHERE TRY_TO_DATE(a1."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a2."date", 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(a1."date", 'YYYY-MM-DD'), TRY_TO_DATE(a2."date", 'YYYY-MM-DD')) BETWEEN 0 AND 365
GROUP BY c."citation_id"
ORDER BY COUNT(*) DESC
LIMIT 100
Answer:
patent_id,num_forward_citations_within_1_year
9358005,21
9320520,16
9498219,16
8275836,15
10171158,14
10200106,12
8939344,12
9918704,12
10305192,12
D803850,12
9974529,12
8989053,12
9724096,12
7668340,11
9844372,11
9572574,11
RE42256,11
9872684,11
9687237,11
7809167,11
9808247,11
9730697,11
9883861,11
10405199,11
9867618,11
9737365,11
9913647,11
9737302,10
9775614,10
8870050,10
10052164,10
9277922,10
10052102,10
9211121,10
9968356,10
10045769,10
6737522,10
6730502,10
9833242,10
D837244,9
9027817,9
9282966,9
9844379,9
9471969,9
D819072,9
9808246,9
9042812,9
D849382,9
10064621,9
9987099,9
10426471,9
9829698,9
8939343,9
10105128,9
9585663,9
10448950,9
9907620,9
9689466,9
D831209,9
10371889,9
8773012,9
9872682,9
9289206,9
10028743,9
9901346,9
9439650,9
9901344,9
9526499,9
9931118,8
D820867,8
10003364,8
9566067,8
D810099,8
D820307,8
10028744,8
9998172,8
9993258,8
D710859,8
9687253,8
9924961,8
10307170,8
9241712,8
10390841,8
6559420,8
10201349,8
10292707,8
6633213,8
9592054,8
9999472,8
9095339,8
6389814,8
9564773,8
9901345,8
9260244,8
5802324,8
10405932,8
10315566,8
10111702,8
10064688,8
10045778,8
Query:
SELECT p."id", TRY_TO_DATE(p."date", 'YYYY-MM-DD') AS "issue_date", TRY_TO_DATE(a."date", 'YYYY-MM-DD') AS "application_date"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
WHERE TRY_TO_DATE(p."date", 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(a."date", 'YYYY-MM-DD') IS NOT NULL
LIMIT 100
Answer:
id,issue_date,application_date
D366645,1996-01-30,1990-10-15
D387923,1997-12-23,1995-03-21
D386268,1997-11-11,1995-05-03
D385951,1997-11-04,1995-06-27
D401358,1998-11-17,1995-06-29
D385909,1997-11-04,1995-08-04
D385507,1997-10-28,1995-08-11
D391383,1998-02-24,1995-08-23
D401003,1998-11-10,1995-10-31
D389796,1998-01-27,1996-01-19
D384523,1997-10-07,1996-01-24
D393500,1998-04-14,1996-01-25
D384008,1997-09-23,1996-01-30
D395502,1998-06-23,1996-03-19
D386612,1997-11-25,1996-04-24
D392943,1998-03-31,1994-08-25
D435879,2001-01-02,1995-01-24
D385637,1997-10-28,1995-03-17
D392928,1998-03-31,1995-06-05
D384945,1997-10-14,1995-06-13
D400559,1998-11-03,1995-09-06
D386809,1997-11-25,1995-11-08
D394063,1998-05-05,1995-11-09
D384303,1997-09-30,1995-12-19
D389610,1998-01-20,1995-12-27
D384064,1997-09-23,1996-01-03
D385899,1997-11-04,1996-02-12
D386661,1997-11-25,1996-04-15
D391412,1998-03-03,1996-05-01
D385455,1997-10-28,1996-05-02
D393202,1998-04-07,1996-05-13
D385110,1997-10-21,1996-05-15
D385461,1997-10-28,1995-03-07
D397192,1998-08-18,1995-03-27
D386927,1997-12-02,1995-08-24
D387722,1997-12-16,1995-09-29
D390048,1998-02-03,1995-10-04
D401451,1998-11-24,1995-10-20
D392746,1998-03-24,1995-10-26
D384269,1997-09-30,1995-12-21
D390301,1998-02-03,1995-12-28
D390367,1998-02-10,1996-01-25
D384518,1997-10-07,1996-02-01
D386548,1997-11-18,1996-02-08
D399309,1998-10-06,1996-02-22
D386690,1997-11-25,1996-02-28
D386912,1997-12-02,1996-03-11
D397262,1998-08-25,1996-03-29
D392737,1998-03-24,1996-04-16
D386935,1997-12-02,1996-04-25
D387167,1997-12-02,1996-05-03
D387822,1997-12-16,1996-05-06
D398300,1998-09-15,1993-05-10
D396709,1998-08-04,1994-01-21
D386575,1997-11-18,1994-09-02
D389425,1998-01-20,1994-09-22
D391594,1998-03-03,1995-02-28
D394767,1998-06-02,1995-07-05
D390870,1998-02-17,1995-08-04
D383956,1997-09-23,1995-09-12
D385594,1997-10-28,1995-09-14
D385203,1997-10-21,1995-12-08
D389193,1998-01-13,1995-12-08
D400847,1998-11-10,1996-01-12
D396458,1998-07-28,1996-02-14
D384386,1997-09-30,1996-02-15
D384396,1997-09-30,1996-04-04
D386543,1997-11-18,1996-04-08
D387476,1997-12-09,1996-04-12
D386045,1997-11-11,1996-04-23
D401835,1998-12-01,1996-04-30
D388168,1997-12-23,1996-05-13
D388481,1997-12-30,1996-05-20
D385449,1997-10-28,1996-05-21
D387045,1997-12-02,1993-05-10
D384933,1997-10-14,1993-12-28
D387750,1997-12-16,1994-03-16
D401999,1998-12-01,1994-04-26
D388196,1997-12-23,1994-08-16
D391335,1998-02-24,1994-12-29
D393329,1998-04-07,1995-01-06
D403042,1998-12-22,1995-02-09
D385659,1997-10-28,1995-04-07
D402246,1998-12-08,1995-05-11
D384333,1997-09-30,1995-08-10
D392554,1998-03-24,1995-10-05
D384329,1997-09-30,1995-10-27
D402749,1998-12-15,1995-11-06
D384204,1997-09-30,1995-11-28
D388234,1997-12-23,1996-01-11
D387117,1997-12-02,1996-01-19
D383907,1997-09-23,1996-02-01
D388373,1997-12-30,1996-02-20
D395410,1998-06-23,1996-02-29
D388798,1998-01-06,1996-03-07
D386580,1997-11-18,1996-03-22
D386273,1997-11-11,1996-04-25
D384041,1997-09-23,1996-05-02
D397745,1998-09-01,1996-05-03
D398007,1998-09-08,1993-11-15
Query:
SELECT p."id",
       TRY_TO_DATE(REPLACE(p."date", '-00', '-01'), 'YYYY-MM-DD') AS "issue_date",
       TRY_TO_DATE(REPLACE(a."date", '-00', '-01'), 'YYYY-MM-DD') AS "application_date"
FROM PATENTSVIEW.PATENTSVIEW.PATENT p
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a ON p."id" = a."patent_id"
WHERE TRY_TO_DATE(REPLACE(p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
LIMIT 100;
Answer:
id,issue_date,application_date
D390404,1998-02-10,1993-12-13
D394636,1998-05-26,1994-07-18
D393466,1998-04-14,1994-09-09
D397432,1998-08-25,1995-01-25
D393944,1998-05-05,1995-03-16
D385651,1997-10-28,1995-04-21
D389893,1998-01-27,1995-04-28
D391283,1998-02-24,1995-07-20
D385472,1997-10-28,1995-08-10
D385384,1997-10-21,1995-08-17
D387258,1997-12-09,1995-10-11
D402906,1998-12-22,1995-10-24
D384042,1997-09-23,1995-11-07
D384141,1997-09-23,1995-11-09
D397741,1998-09-01,1996-01-18
D387883,1997-12-16,1996-02-20
D396456,1998-07-28,1994-01-21
D394631,1998-05-26,1994-08-02
D388775,1998-01-06,1994-09-01
D391947,1998-03-10,1995-05-05
D392963,1998-03-31,1995-05-05
D384418,1997-09-30,1995-05-19
D388136,1997-12-23,1995-06-05
D385266,1997-10-21,1995-09-08
D397064,1998-08-18,1995-09-27
D394722,1998-05-26,1995-12-13
D403435,1998-12-29,1995-12-21
D388528,1997-12-30,1996-01-22
D399212,1998-10-06,1996-02-09
D391948,1998-03-10,1996-02-14
D384439,1997-09-30,1996-02-29
D386744,1997-11-25,1996-03-01
D384435,1997-09-30,1996-03-27
D386360,1997-11-18,1996-04-23
D385353,1997-10-21,1996-04-29
D389840,1998-01-27,1996-04-30
D386559,1997-11-18,1995-05-05
D400799,1998-11-10,1995-05-18
D402086,1998-12-08,1995-07-21
D386489,1997-11-18,1995-07-24
D385697,1997-11-04,1995-08-02
D395163,1998-06-16,1995-08-18
D394025,1998-05-05,1995-10-16
D384516,1997-10-07,1995-10-17
D384301,1997-09-30,1995-12-12
D395737,1998-07-07,1995-12-16
D396307,1998-07-21,1996-01-12
D384676,1997-10-07,1996-02-20
D383937,1997-09-23,1996-03-21
D384016,1997-09-23,1996-03-25
D385416,1997-10-28,1996-03-29
D384616,1997-10-07,1996-04-11
D389483,1998-01-20,1996-04-26
D386860,1997-11-25,1996-04-30
D387045,1997-12-02,1993-05-10
D384933,1997-10-14,1993-12-28
D387750,1997-12-16,1994-03-16
D401999,1998-12-01,1994-04-26
D388196,1997-12-23,1994-08-16
D391335,1998-02-24,1994-12-29
D393329,1998-04-07,1995-01-06
D403042,1998-12-22,1995-02-09
D385659,1997-10-28,1995-04-07
D402246,1998-12-08,1995-05-11
D384333,1997-09-30,1995-08-10
D392554,1998-03-24,1995-10-05
D384329,1997-09-30,1995-10-27
D402749,1998-12-15,1995-11-06
D384204,1997-09-30,1995-11-28
D388234,1997-12-23,1996-01-11
D387117,1997-12-02,1996-01-19
D383907,1997-09-23,1996-02-01
D388373,1997-12-30,1996-02-20
D395410,1998-06-23,1996-02-29
D388798,1998-01-06,1996-03-07
D386580,1997-11-18,1996-03-22
D386273,1997-11-11,1996-04-25
D384041,1997-09-23,1996-05-02
D397745,1998-09-01,1996-05-03
D392943,1998-03-31,1994-08-25
D435879,2001-01-02,1995-01-24
D385637,1997-10-28,1995-03-17
D392928,1998-03-31,1995-06-05
D384945,1997-10-14,1995-06-13
D400559,1998-11-03,1995-09-06
D386809,1997-11-25,1995-11-08
D394063,1998-05-05,1995-11-09
D384303,1997-09-30,1995-12-19
D389610,1998-01-20,1995-12-27
D384064,1997-09-23,1996-01-03
D385899,1997-11-04,1996-02-12
D386661,1997-11-25,1996-04-15
D391412,1998-03-03,1996-05-01
D385455,1997-10-28,1996-05-02
D393202,1998-04-07,1996-05-13
D385110,1997-10-21,1996-05-15
D406355,1999-03-02,1991-04-01
D396396,1998-07-28,1994-10-31
D402477,1998-12-15,1994-11-04
D385294,1997-10-21,1995-01-06
Query:
SELECT patent_id, SUM(num_forward_citations) AS total_forward, SUM(num_backward_citations) AS total_backward
FROM (
  -- Forward citations within 1 year
  SELECT c."citation_id" AS patent_id, COUNT(*) AS num_forward_citations, 0 AS num_backward_citations
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"  -- Cited patent
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"    -- Citing patent
  WHERE 
    TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'), TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
  GROUP BY c."citation_id"
  UNION ALL
  -- Backward citations within 1 year
  SELECT c."patent_id", 0 AS num_forward_citations, COUNT(*) AS num_backward_citations
  FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"    -- Citing patent
  JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"  -- Cited patent
  WHERE 
    TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
    AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'), TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
  GROUP BY c."patent_id"
) sub
GROUP BY patent_id
LIMIT 100;
Answer:
PATENT_ID,TOTAL_FORWARD,TOTAL_BACKWARD
3944384,1,0
3964488,1,0
4113997,1,0
4132452,1,0
4180494,1,0
4256000,1,0
4541987,1,0
4496487,1,0
4782834,1,0
4612415,1,0
4621487,1,0
4706100,1,0
5425032,2,0
5532754,2,0
5625406,1,0
D262653,1,0
5868204,1,0
5924529,1,0
D569772,1,0
D690331,1,0
5355749,1,0
5391287,1,0
5572666,2,0
5996725,1,0
5835319,1,0
9881626,1,0
5548483,1,0
6011930,1,0
9663062,1,0
D611241,1,0
D787792,1,0
D705919,1,0
D860601,1,0
D874450,1,0
5491813,2,0
5920814,1,0
5881110,1,0
D680544,1,0
D547079,2,0
D558288,4,0
D844657,1,0
D711311,1,0
D476650,2,0
D862729,1,0
9210192,4,0
6633729,1,0
5597752,1,0
9586500,1,0
5507026,2,0
5005703,1,0
5198968,1,0
9754674,1,0
D678219,2,0
D807249,2,0
D847906,1,0
10158709,1,0
D531753,1,0
D680488,1,0
D767861,2,0
D844217,1,0
6571282,1,0
6722210,1,0
D662663,1,0
7246734,3,0
4022534,1,0
4943224,1,0
5940841,1,0
5772745,1,0
D503700,1,0
D563514,2,0
D660602,1,0
D703170,1,0
5266523,1,0
9652294,1,0
D823887,1,0
D496343,5,0
D797301,1,0
D801569,1,0
8019834,1,0
9124703,1,0
7592597,2,0
8866109,1,0
4550824,1,0
4868135,1,0
5699265,5,0
D385430,1,0
D405749,1,0
D682866,1,0
D646105,1,0
D776658,1,0
D717334,2,0
D863263,3,0
4739727,1,0
4489183,1,0
9962421,1,0
5714683,1,0
5771571,1,0
6061426,1,0
D475043,3,0
5727156,1,0
End Exploring Related Columns
Task: Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTSVIEW': {'PATENTSVIEW': ['APPLICATION', 'ASSIGNEE', 'BOTANIC', 'BRF_SUM_TEXT', 'CLAIM', 'CLAIMS_2021', 'CPC_CURRENT', 'CPC_GROUP', 'CPC_SUBGROUP', 'CPC_SUBSECTION', 'DETAIL_DESC_TEXT_2021', 'DRAW_DESC_TEXT', 'DRAW_DESC_TEXT_2021', 'FIGURES', 'FOREIGNCITATION', 'FOREIGN_PRIORITY', 'GOVERNMENT_INTEREST', 'GOVERNMENT_ORGANIZATION', 'INVENTOR', 'INVENTOR_GENDER', 'IPCR', 'LAWYER', 'LOCATION', 'LOCATION_ASSIGNEE', 'LOCATION_INVENTOR', 'MAINCLASS', 'MAINCLASS_CURRENT', 'MATCH', 'NBER', 'NBER_CATEGORY', 'NBER_SUBCATEGORY', 'NON_INVENTOR_APPLICANT', 'OTHERREFERENCE', 'PATENT', 'PATENT_ASSIGNEE', 'PATENT_CONTRACTAWARDNUMBER', 'PATENT_GOVINTORG', 'PATENT_INVENTOR', 'PATENT_LAWYER', 'PCT_DATA', 'PERSISTENT_ASSIGNEE_DISAMBIG', 'PERSISTENT_INVENTOR_DISAMB', 'PERSISTENT_INVENTOR_DISAMBIG', 'RAWASSIGNEE', 'RAWEXAMINER', 'RAWINVENTOR', 'RAWLAWYER', 'RAWLOCATION', 'REL_APP_TEXT', 'SUBCLASS', 'SUBCLASS_CURRENT', 'USAPPLICATIONCITATION', 'USPATENTCITATION', 'USPC', 'USPC_CURRENT', 'USRELDOC', 'US_TERM_OF_GRANT', 'WIPO', 'WIPO_FIELD']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 02:18:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:18:10 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations_within_1_year
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND ABS(DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                           TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD'))) <= 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY num_backward_citations_within_1_year DESC
    LIMIT 1
)
SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
  AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                     TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:18:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:18:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:18:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:18:12 - snowflake.connector.connection - INFO - closed
2025-01-25 02:18:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:18:12 - root - INFO - itercount: 1
2025-01-25 02:18:12 - root - INFO - 000904 (42000): 01b9f02a-0004-8038-0001-11c300f9f432: SQL compilation error: error line 15 at position 24
invalid identifier '"num_backward_citations_within_1_year"'
2025-01-25 02:18:12 - root - INFO - Input sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations_within_1_year
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND ABS(DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                           TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD'))) <= 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY num_backward_citations_within_1_year DESC
    LIMIT 1
)
SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
  AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                     TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365;
The error information is:
000904 (42000): 01b9f02a-0004-8038-0001-11c300f9f432: SQL compilation error: error line 15 at position 24
invalid identifier '"num_backward_citations_within_1_year"'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-25 02:19:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:19:19 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND ABS(DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                           TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD'))) <= 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
  AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                     TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:19:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:19:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:19:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:19:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:19:22 - snowflake.connector.connection - INFO - closed
2025-01-25 02:19:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:19:22 - root - INFO - itercount: 2
2025-01-25 02:19:22 - root - INFO - 0
2025-01-25 02:19:22 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:19:22 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND ABS(DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                           TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD'))) <= 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
  AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day', TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
                     TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:21:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:21:31 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND ABS(DATEDIFF('day',
            TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
            TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD'))) <= 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COALESCE(COUNT(*), 0) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
  AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day',
       TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
       TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365;
```
2025-01-25 02:21:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:21:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:21:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:21:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:21:34 - snowflake.connector.connection - INFO - closed
2025-01-25 02:21:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:21:34 - root - INFO - itercount: 3
2025-01-25 02:21:34 - root - INFO - 0
2025-01-25 02:21:34 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:21:34 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."patent_id" = a1."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."citation_id" = a2."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND ABS(DATEDIFF('day',
            TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
            TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD'))) <= 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COALESCE(COUNT(*), 0) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a1 ON c."citation_id" = a1."patent_id"
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a2 ON c."patent_id" = a2."patent_id"
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
  AND TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day',
       TRY_TO_DATE(REPLACE(a1."date", '-00', '-01'), 'YYYY-MM-DD'),
       TRY_TO_DATE(REPLACE(a2."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:23:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:23:08 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COALESCE(f."num_forward_citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM max_backward_citations mbc
LEFT JOIN (
    SELECT c."citation_id", COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cite ON c."patent_id" = a_cite."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_orig ON c."citation_id" = a_orig."patent_id"
    WHERE c."citation_id" = mbc."patent_id"
      AND TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day",
           TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."citation_id"
) f ON mbc."patent_id" = f."citation_id";
```
2025-01-25 02:23:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:23:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:23:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:23:09 - snowflake.connector.connection - INFO - closed
2025-01-25 02:23:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:23:10 - root - INFO - itercount: 4
2025-01-25 02:23:10 - root - INFO - 001003 (42000): 01b9f02f-0004-8038-0001-11c300f9f452: SQL compilation error:
syntax error line 32 at position 50 unexpected '', ''.
syntax error line 32 at position 57 unexpected ''), ''.
parse error line 35 at position 41 near '<EOF>'.
syntax error line 35 at position 0 unexpected ')'.
2025-01-25 02:23:10 - root - INFO - Input sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COALESCE(f."num_forward_citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM max_backward_citations mbc
LEFT JOIN (
    SELECT c."citation_id", COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cite ON c."patent_id" = a_cite."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_orig ON c."citation_id" = a_orig."patent_id"
    WHERE c."citation_id" = mbc."patent_id"
      AND TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day",
           TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."citation_id"
) f ON mbc."patent_id" = f."citation_id";
The error information is:
001003 (42000): 01b9f02f-0004-8038-0001-11c300f9f452: SQL compilation error:
syntax error line 32 at position 50 unexpected '', ''.
syntax error line 32 at position 57 unexpected ''), ''.
parse error line 35 at position 41 near '<EOF>'.
syntax error line 35 at position 0 unexpected ')'.
Please correct it and output only 1 complete SQL query.
2025-01-25 02:23:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:23:45 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COALESCE(f."num_forward_citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM max_backward_citations mbc
LEFT JOIN (
    SELECT c."citation_id", COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cite ON c."patent_id" = a_cite."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_orig ON c."citation_id" = a_orig."patent_id"
    WHERE c."citation_id" = mbc."patent_id"
      AND TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."citation_id"
) f ON mbc."patent_id" = f."citation_id";
```
2025-01-25 02:23:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:23:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:23:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:23:47 - snowflake.connector.connection - INFO - closed
2025-01-25 02:23:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:23:47 - root - INFO - itercount: 5
2025-01-25 02:23:47 - root - INFO - 000904 (42000): 01b9f02f-0004-8038-0001-11c300f9f45a: SQL compilation error: error line 28 at position 28
invalid identifier 'MBC."patent_id"'
2025-01-25 02:23:47 - root - INFO - Input sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
)
SELECT COALESCE(f."num_forward_citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM max_backward_citations mbc
LEFT JOIN (
    SELECT c."citation_id", COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cite ON c."patent_id" = a_cite."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_orig ON c."citation_id" = a_orig."patent_id"
    WHERE c."citation_id" = mbc."patent_id"
      AND TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD')) BETWEEN 0 AND 365
    GROUP BY c."citation_id"
) f ON mbc."patent_id" = f."citation_id";
The error information is:
000904 (42000): 01b9f02f-0004-8038-0001-11c300f9f45a: SQL compilation error: error line 28 at position 28
invalid identifier 'MBC."patent_id"'
Please correct it and output only 1 complete SQL query.
2025-01-25 02:24:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:24:32 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"    -- citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"  -- cited patent
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cite ON c."patent_id" = a_cite."patent_id"    -- citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_orig ON c."citation_id" = a_orig."patent_id"  -- cited patent
    WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
      AND TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE(fc."num_forward_citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations fc;
```
2025-01-25 02:24:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:24:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:24:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:24:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:24:35 - snowflake.connector.connection - INFO - closed
2025-01-25 02:24:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:24:36 - root - INFO - itercount: 6
2025-01-25 02:24:36 - root - INFO - 0
2025-01-25 02:24:36 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:24:36 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"    -- citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"  -- cited patent
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citations AS (
    SELECT "patent_id", "num_backward_citations_within_1_year"
    FROM backward_citations
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS "num_forward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cite ON c."patent_id" = a_cite."patent_id"    -- citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_orig ON c."citation_id" = a_orig."patent_id"  -- cited patent
    WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citations)
      AND TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_orig."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_cite."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE(fc."num_forward_citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations fc;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:26:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:26:35 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"    -- Citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"   -- Cited patent
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN backward_citations bc ON c."citation_id" = bc."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"    -- Citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"   -- Cited patent
    WHERE TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE("Number_of_Forward_Citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations;
```
2025-01-25 02:26:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:26:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:26:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:26:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:26:39 - snowflake.connector.connection - INFO - closed
2025-01-25 02:26:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:26:39 - root - INFO - itercount: 7
2025-01-25 02:26:39 - root - INFO - 0
2025-01-25 02:26:39 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:26:39 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"    -- Citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"   -- Cited patent
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY "num_backward_citations_within_1_year" DESC NULLS LAST
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN backward_citations bc ON c."citation_id" = bc."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"    -- Citing patent
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"   -- Cited patent
    WHERE TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_cited."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE("Number_of_Forward_Citations_within_1_year", 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:28:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:28:22 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD'),
           TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY "num_backward_citations_within_1_year" DESC
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN backward_citations bc ON c."citation_id" = bc."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"
    WHERE TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD'),
           TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE(MAX("Number_of_Forward_Citations_within_1_year"), 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations;
```
2025-01-25 02:28:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:28:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:28:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:28:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:28:26 - snowflake.connector.connection - INFO - closed
2025-01-25 02:28:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:28:26 - root - INFO - itercount: 8
2025-01-25 02:28:26 - root - INFO - 0
2025-01-25 02:28:26 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:28:26 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS "num_backward_citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD'),
           TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY "num_backward_citations_within_1_year" DESC
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN backward_citations bc ON c."citation_id" = bc."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_cited ON c."citation_id" = a_cited."patent_id"
    WHERE TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(a_cited."date", 'YYYY-MM-DD'),
           TRY_TO_DATE(a_citing."date", 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE(MAX("Number_of_Forward_Citations_within_1_year"), 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-25 02:29:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:29:04 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations_within_1_year
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"  -- Citing patent application date
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"  -- Cited patent application date
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citation_patent AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY num_backward_citations_within_1_year DESC NULLS LAST
    LIMIT 1
)
SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."citation_id" = a_p."patent_id"  -- The patent being cited
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"  -- The citing patent
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citation_patent)
  AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day',
       TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD'),
       TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
       ) BETWEEN 0 AND 365;
```
2025-01-25 02:29:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:29:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:29:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:29:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 02:29:08 - snowflake.connector.connection - INFO - closed
2025-01-25 02:29:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:29:08 - root - INFO - itercount: 9
2025-01-25 02:29:08 - root - INFO - 0
2025-01-25 02:29:08 - root - INFO - results: 
Number_of_Forward_Citations_within_1_year
0


2025-01-25 02:29:08 - root - INFO - Please check the answer again by reviewing Can you figure out the number of forward citations within 1 years from the application date for the patent that has the most backward citations within 1 years from application among all U.S. patents?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Forward_Citations_within_1_year
num_forward:int
(Attention: answer in one row)
```

**Explanation:** This is the number of forward citations within 1 year from the application date for the U.S. patent that has the most backward citations within 1 year from its application date. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Forward_Citations_within_1_year
0
Current sql:
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations_within_1_year
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"  -- Citing patent application date
    JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"  -- Cited patent application date
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day',
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
),
max_backward_citation_patent AS (
    SELECT "patent_id"
    FROM backward_citations
    ORDER BY num_backward_citations_within_1_year DESC NULLS LAST
    LIMIT 1
)
SELECT COUNT(*) AS "Number_of_Forward_Citations_within_1_year"
FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."citation_id" = a_p."patent_id"  -- The patent being cited
JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"  -- The citing patent
WHERE c."citation_id" = (SELECT "patent_id" FROM max_backward_citation_patent)
  AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
  AND DATEDIFF('day',
       TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD'),
       TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
       ) BETWEEN 0 AND 365;Empty results in Column ['Number_of_Forward_Citations_within_1_year']. Please correct them.

2025-01-25 02:30:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 02:30:40 - root - INFO - ```sql
WITH backward_citations AS (
    SELECT c."patent_id", COUNT(*) AS num_backward_citations_within_1_year
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    INNER JOIN PATENTSVIEW.PATENTSVIEW.PATENT p ON c."patent_id" = p."id"
    INNER JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."patent_id" = a_p."patent_id"  -- Citing patent application date
    INNER JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_c ON c."citation_id" = a_c."patent_id"  -- Cited patent application date
    WHERE p."country" = 'US'
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day', 
           TRY_TO_DATE(REPLACE(a_c."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
    GROUP BY c."patent_id"
    ORDER BY num_backward_citations_within_1_year DESC NULLS LAST
    LIMIT 1
),
forward_citations AS (
    SELECT COUNT(*) AS num_forward_citations_within_1_year
    FROM PATENTSVIEW.PATENTSVIEW.USPATENTCITATION c
    INNER JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_p ON c."citation_id" = a_p."patent_id"  -- The patent being cited
    INNER JOIN PATENTSVIEW.PATENTSVIEW.APPLICATION a_citing ON c."patent_id" = a_citing."patent_id"  -- The citing patent
    WHERE c."citation_id" = (SELECT "patent_id" FROM backward_citations)
      AND TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD') IS NOT NULL
      AND DATEDIFF('day", 
           TRY_TO_DATE(REPLACE(a_p."date", '-00', '-01'), 'YYYY-MM-DD'),
           TRY_TO_DATE(REPLACE(a_citing."date", '-00', '-01'), 'YYYY-MM-DD')
           ) BETWEEN 0 AND 365
)
SELECT COALESCE(MAX(num_forward_citations_within_1_year), 0) AS "Number_of_Forward_Citations_within_1_year"
FROM forward_citations;
```
2025-01-25 02:30:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 02:30:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 02:30:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 02:30:42 - snowflake.connector.connection - INFO - closed
2025-01-25 02:30:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 02:30:42 - root - INFO - Total iteration counts: 10
