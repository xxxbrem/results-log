SELECT
    "STATE_ABBREVIATION" AS "State",
    COUNT(CASE WHEN "START_DATE" <= '2020-03-01' AND ("END_DATE" IS NULL OR "END_DATE" >= '2020-03-01') THEN 1 END) AS "Num_Entities_Mar_1_2020",
    COUNT(CASE WHEN "START_DATE" <= '2021-12-31' AND ("END_DATE" IS NULL OR "END_DATE" >= '2021-12-31') THEN 1 END) AS "Num_Entities_Dec_31_2021",
    ROUND(
        (
            COUNT(CASE WHEN "START_DATE" <= '2021-12-31' AND ("END_DATE" IS NULL OR "END_DATE" >= '2021-12-31') THEN 1 END) -
            COUNT(CASE WHEN "START_DATE" <= '2020-03-01' AND ("END_DATE" IS NULL OR "END_DATE" >= '2020-03-01') THEN 1 END)
        ) * 100.0 /
        NULLIF(COUNT(CASE WHEN "START_DATE" <= '2020-03-01' AND ("END_DATE" IS NULL OR "END_DATE" >= '2020-03-01') THEN 1 END), 0),
        4
    ) AS "Percentage_Change"
FROM FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_BRANCH_ENTITIES
GROUP BY "STATE_ABBREVIATION"
ORDER BY "State";