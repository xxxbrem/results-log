2025-02-11 17:27:27 - openai._base_client - INFO - Retrying request to /chat/completions in 0.495316 seconds
2025-02-11 17:28:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:28:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:28:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:28:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:28:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:28:20 - snowflake.connector.connection - INFO - closed
2025-02-11 17:28:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:28:21 - root - INFO - SQL:
SELECT "id", "name"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT"
   LIMIT 100;
Results:
Too long, hard cut:
id,name
b972d9cb-9a11-4a49-893b-327c58185d83,"[
  {
    ""family"": ""Auer97"",
    ""given"": [
      ""Candyce305""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
c9865d08-da7e-4cf8-afb8-8802da4324e9,"[
  {
    ""family"": ""Perales854"",
    ""given"": [
      ""Jorge Luis88""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
1f7198cd-8f12-42fc-b7a8-92e5a0c4dd78,"[
  {
    ""family"": ""Vel치zquez409"",
    ""given"": [
      ""Antonia30""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
c18c9677-c194-4931-a1ec-b9f499c15dc6,"[
  {
    ""family"": ""Hern치dez343"",
    ""given"": [
      ""Eva64""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
2c981886-3710-4c7e-9d26-c56589276913,"[
  {
    ""family"": ""Cordero852"",
    ""given"": [
      ""Sergio619""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
fb90cddc-b4d9-41c7-88b2-472c16f078ea,"[
  {
    ""family"": ""Feest103"",
    ""given"": [
      ""Marianna323""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
bed95537-1f15-4265-a456-7cacc56e4331,"[
  {
    ""family"": ""Corrales691"",
    ""given"": [
      ""Elsa29""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
360fc2be-e006-40b2-a598-fe49a14e26e1,"[
  {
    ""family"": ""Lynch190"",
    ""given"": [
      ""Jodee687""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
9fdaa2bb-859d-46d3-ad40-278d86edc84f,"[
  {
    ""family"": ""Ceja441"",
    ""given"": [
      ""Daniela614""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
e2ff66bc-4ec4-4b27-b5ad-ac01ce63e255,"[
  {
    ""family"": ""Metz686"",
    ""given"": [
      ""Will178""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
51910199-f8c0-4b5d-9909-e27e3473be20,"[
  {
    ""family"": ""Stoltenberg489"",
    ""given"": [
      ""Shandra823""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
77fb5380-ed88-4e20-bbb4-f941701be4e3,"[
  {
    ""family"": ""Murphy561"",
    ""given"": [
      ""Noriko180""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
29b899ac-ede1-4881-90c1-ae48c7de332d,"[
  {
    ""family"": ""Prieto999"",
    ""given"": [
      ""Francisca486""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
4c73f559-6a58-4c60-b64b-03b2eba4692f,"[
  {
    ""family"": ""Montenegro24"",
    ""given"": [
      ""Patricia625""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
8d2d512e-ce6b-4c0f-94a4-540738371130,"[
  {
    ""family"": ""Hettinger594"",
    ""given"": [
      ""Alverta45""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
919d42cb-c051-45ec-a140-afad25350408,"[
  {
    ""family"": ""Quintero729"",
    ""given"": [
      ""Gonzalo160""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
0c25d541-42b9-4266-87e5-017f9546abcd,"[
  {
    ""family"": ""Vargas494"",
    ""given"": [
      ""Ignacio928""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
454b8161-86a9-498e-b574-b2b4406c0633,"[
  {
    ""family"": ""Garrido242"",
    ""given"": [
      ""Anita473""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
31349fec-85da-4420-a574-2baaeb51a796,"[
  {
    ""family"": ""Rodriguez71"",
    ""given"": [
      ""Isabelle619""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
845e737f-8f48-4e35-985d-37d54328bdae,"[
  {
    ""family"": ""Effertz744"",
    ""given"": [
      ""Merlin721""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
dfe4960b-cf5d-4d17-8f50-1ab1ee181b0c,"[
  {
    ""family"": ""Qui침칩nez764"",
    ""given"": [
      ""Amalia471""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
e31e9d0f-8bfb-4af4-b7be-3c71fd4d5586,"[
  {
    ""family"": ""Peres371"",
    ""given"": [
      ""Graciela518""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
790638ba-037a-4db4-8641-c1f7328dae3c,"[
  {
    ""family"": ""Cornejo190"",
    ""given"": [
      ""Laura391""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
48930f02-42fc-47a4-bd45-2a1165e1d7e6,"[
  {
    ""family"": ""Zavala169"",
    ""given"": [
      ""Juan88""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
6cb8f426-43be-4a84-8e40-c9ca3cf8ddd4,"[
  {
    ""family"": ""Adams676"",
    ""given"": [
      ""Lorette239""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
e8022243-19d9-4d8f-a0ac-2595baf27a09,"[
  {
    ""family"": ""Granados71"",
    ""given"": [
      ""Antonio44""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use

2025-02-11 17:28:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:28:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:28:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:28:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:28:22 - snowflake.connector.connection - INFO - closed
2025-02-11 17:28:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:28:22 - root - INFO - SQL:
SELECT p."id", n.value:"family"::STRING AS "last_name"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
   LATERAL FLATTEN(input => p."name") n
   WHERE n.value:"family"::STRING ILIKE 'A%'
   LIMIT 100;
Results:
id,last_name
e5c26e5d-f948-452b-9028-4fc32c9dc43c,Auer97
8d5a8da0-b955-4309-af79-bdc06e325c61,Aufderhar910
48ccd623-17c4-40c5-b57a-34011920dd01,Aufderhar910
2e74a426-05d7-46fd-b285-e1334131b46b,Altenwerth646
b44b4f2a-d835-487d-b360-180dce80c600,Armstrong51
7e2e504a-de10-436c-92d3-ff4a1848b956,Abernathy524
3e16b87a-f0d1-4546-bc49-a8b4e2d8470e,Anderson154
730cd58c-8a99-4e24-88ea-7b945a10892b,Adams676
cf235044-9d32-4d04-8f79-f7515b9f6609,Anderson154
fec31a34-56d5-4620-b329-f4f1863ff3fe,Abbott774
20649d37-036c-4586-8862-6c321f8a9124,Auer97
50196de2-2405-4822-9d52-d2f714d440ba,Auer97
c7b2cbf8-c61f-4c41-bf1e-5c26400a04e8,Anderson154
de7699da-4642-4a79-b5cc-c10b1f026ad4,Abernathy524
ff599ea0-92a8-4677-b5b7-fbc754900294,Abernathy524
ef341f55-59c8-423d-8633-554dfcaf0f42,Abshire638
41c67c66-7735-49fd-90a1-6b6e099cdf8f,Abshire638
c5a97fb1-66c1-4a75-b06d-58ac84a091c0,Aufderhar910
088dcc38-7964-460b-8835-6a9280a2bfc4,Aufderhar910
6673c464-9f78-4875-8597-98cd0af67811,Adams676
8a582d86-9480-437e-b9d5-69c1cf85b5bd,Altenwerth646
03d17814-f535-4563-9cdd-e4aa296c5ffa,Anderson154
7ba91fef-50bd-4d35-8893-ef9f6915d082,Abernathy524
bc0d5fe9-f04f-4412-a45c-52bbe5f180ea,Armstrong51
16984bfc-6254-46bf-a76b-f9ebae232a9a,Altenwerth646
d77ceece-5af4-4ed3-9005-d9c9906e081b,Abernathy524
4b3ca3ec-8c42-4037-bfb3-c4ed340d0524,Adams676
ec2fab6f-763a-4492-8292-c94f697a9480,Altenwerth646
0adc0086-8e77-43ea-ab6d-c64591b66508,Ankunding277
15607b50-2e55-4532-a3dc-6e62285ba28c,Altenwerth646
796d1d2c-f011-4044-a2ed-80ca087d28f2,Ankunding277
b83497b9-9b7d-486c-9aeb-40ae98ef038d,Abshire638
ffbd8d6d-f3e1-4d39-a829-3a8dec7cf423,Ankunding277
b20579c8-c7e9-4893-a5ae-758b0a30202d,Aufderhar910
c4427a19-b270-4a68-8030-9e1d9a0a88d6,Ankunding277
0e3b2866-b890-4d56-81c4-38f24019b311,Aufderhar910
69faf3e9-3f96-489c-a7c4-d321779c6945,Auer97
55c5a3c9-1258-4d59-b818-7daacd10432e,Abbott774
afe15de8-5783-496c-9c45-8a930a822a24,Aufderhar910
7a216826-59aa-4300-889f-8d2db86f1214,Abbott774
25507e9b-cb58-4a57-8727-38859c1a2ade,Abernathy524
0765d7b3-06f9-48f2-876b-057a4500251a,Aufderhar910
449b14f4-dee6-48cf-948d-2207d3d71143,Abbott774
0c4caeb4-3834-4a13-9564-f851a7f74076,Armstrong51
2d7e0069-9655-4104-9280-84a065716aa5,Abshire638
df9d46ba-5580-4b7d-bc6c-27c69a800969,Abshire638
e8d1a000-ff3d-45c4-8bf2-309d476fe555,Auer97
ce445bac-bef5-4f20-9089-1e57edd28a19,Aufderhar910
27ebe4a9-9e59-4f6b-958b-1daf1d2ab051,Armstrong51
dcca3aca-95ed-45ae-a86a-e4e6d113d780,Altenwerth646
84d41795-af4f-405c-a208-a3427b44a38c,Anderson154
bdf01e04-d958-4f9a-b07b-c325ebe3b074,Ankunding277
aa46f615-89fb-4e9d-b4f7-2ce1e4eacf1b,Abbott774
6c2a1eea-2797-4ba9-a67e-ed61dd9c460e,Abshire638
ebf64f69-8cd6-4090-9418-e0ba122e5700,Adams676
1641dc83-2b5e-49fd-8852-e0d1572092ad,Anderson154
70e68f26-d642-4105-b82a-1257a0d10848,Ankunding277
8c373ed3-716d-4c86-bf5e-a050f4de09d7,Abernathy524
fc000d11-aad4-4afc-93b5-e0353e0b3287,Armstrong51
728f1242-263c-434e-9a2a-d6fa319e0628,Abshire638
f4a80dd3-5146-40ee-9ac9-a6ae62d9cfe8,Adams676
5c664454-b26e-40b4-a113-2e4e4d21d1da,Altenwerth646
fd480c9c-8b8a-46de-803a-b1603c00b671,Adams676
1e741807-21d1-451d-9cc5-6473955d3fb7,Aufderhar910
92495ce3-2931-4fb7-a319-a47710ffea2c,Abshire638
f9ead748-9551-493f-a680-7170099ff04b,Aufderhar910
338ce980-c43b-4502-afc3-15746a05c1f2,Auer97
4dd34bce-1f98-4466-83b0-d94c05985239,Abshire638
a9a351c8-2548-4aee-acac-7187c194cb62,Anderson154
6438e914-a3d3-4afd-b2f7-ef36cc8f80d3,Ankunding277
b646928b-df03-4f37-93e4-d9288f75f98d,Ankunding277
6dd31b62-c47f-49e1-8dc4-cd1a5ee0bb40,Auer97
7876cf97-fc11-42f7-bc1d-a9a9f4c81476,Abernathy524
ff91decc-9783-4488-bcad-20dd94a24f7c,Adams676
7dfbcd44-1262-49f6-8010-8efb105cfc77,Auer97
65547c01-0a6c-4233-ad24-f4c7a63bd864,Ankunding277
4493c653-1c67-463a-856e-2d0b0aaabf85,Abernathy524
2c9161f4-0904-43b9-bacf-8fd1c99ccc9c,Auer97
6397f464-8957-45c2-a7cf-7d52b9dc4624,Abernathy524
4e075e89-128f-40f5-9772-9fcb451308eb,Abernathy524
e6692abc-7f0b-4c04-a1fa-5bb4157a83aa,Altenwerth646
9fecda40-1dbf-43cb-9e6d-4f5920254814,Auer97
d156e626-31fa-411d-986c-13ffcb49d5b9,Altenwerth646
006c1aaa-2708-4959-b1bb-d62c1b7cf670,Anderson154
5961bcfc-65b5-4ab0-9a5b-459d1e98efb9,Auer97
02a55af4-37a4-48ff-b18b-30308f2e0226,Ankunding277
6c77cb04-9d6d-4de6-a39c-a67d1fe3ba4c,Armstrong51
6c77cb04-9d6d-4de6-a39c-a67d1fe3ba4c,Abshire638
3725c157-8e34-4fae-9307-75f4c950c619,Altenwerth646
0443daaf-a911-4492-9d05-b1971fcb2428,Ankunding277
119973c2-f99c-47e8-836e-f2cc6d31db43,Adams676
3ca3d8be-3c1c-4e5f-ad5a-a05024369f1a,Aufderhar910
a5e7b2b2-58a2-4aa4-be96-998acc29aa7f,Auer97
fb52fe3d-45b2-425b-9962-64c3cab2b41d,Abshire638
2a790bd0-b45f-4108-a0ba-d11178b50194,Anderson154
9c772a71-0d55-4bc5-88e4-0d8a7cd632b1,Aufderhar910
9c6be5ae-95a5-4d1f-a839-140508909f13,Abernathy524
384c1b16-9c60-470f-9404-45cc7e429340,Abshire638
4bc76a72-ba8f-434e-ba05-8f33783e2939,Anderson154
2c2c1ce3-8aab-408f-b4aa-119a9657e197,Adams676

2025-02-11 17:28:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:28:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:28:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:28:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:28:23 - snowflake.connector.connection - INFO - closed
2025-02-11 17:28:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:28:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:28:59 - root - INFO - ```sql
WITH patients_with_lastname_A AS (
    SELECT DISTINCT p."id" AS patient_id
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    WHERE (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
      AND n.value:"family"::STRING ILIKE 'A%'
),
patients_with_one_condition AS (
    SELECT c."subject"::STRING AS subject_ref,
           c."code",
           COUNT(DISTINCT c."id") AS condition_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject"::STRING, c."code"
    HAVING COUNT(DISTINCT c."id") = 1
),
active_medications_per_patient AS (
    SELECT m."subject"::STRING AS subject_ref,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::STRING
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code,
           a.active_med_count
    FROM patients_with_lastname_A p
    JOIN patients_with_one_condition c
        ON c.subject_ref = CONCAT('Patient/', p.patient_id)
    JOIN active_medications_per_patient a
        ON a.subject_ref = CONCAT('Patient/', p.patient_id)
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:28:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:28:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:28:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:29:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 17:29:05 - snowflake.connector.connection - INFO - closed
2025-02-11 17:29:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:29:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:29:56 - root - INFO - ```sql
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name,
           p."deceased"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
),
patients_with_lastname_A AS (
    SELECT DISTINCT patient_id
    FROM patient_names
    WHERE (deceased IS NULL OR deceased::STRING = 'false')
      AND last_name ILIKE 'A%'
),
patient_conditions AS (
    SELECT c."subject"::STRING AS subject_ref,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::STRING AS subject_ref,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::STRING
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patients_with_lastname_A p
    JOIN patient_conditions c
        ON c.subject_ref = CONCAT('Patient/', p.patient_id)
    JOIN active_medications_per_patient a
        ON a.subject_ref = CONCAT('Patient/', p.patient_id)
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:29:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:29:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:29:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:29:57 - snowflake.connector.connection - INFO - closed
2025-02-11 17:29:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:30:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:30:27 - root - INFO - ```sql
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
),
patients_with_lastname_A AS (
    SELECT DISTINCT patient_id
    FROM patient_names
    WHERE last_name ILIKE 'A%'
),
patient_conditions AS (
    SELECT c."subject"::STRING AS subject_ref,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
patients_with_one_condition AS (
    SELECT subject_ref, condition_code, COUNT(*) AS condition_count
    FROM patient_conditions
    GROUP BY subject_ref, condition_code
    HAVING COUNT(*) = 1
),
active_medications_per_patient AS (
    SELECT m."subject"::STRING AS subject_ref,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::STRING
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patients_with_lastname_A p
    JOIN patients_with_one_condition c
        ON c.subject_ref = CONCAT('Patient/', p.patient_id)
    JOIN active_medications_per_patient a
        ON a.subject_ref = CONCAT('Patient/', p.patient_id)
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:30:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:30:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:30:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:30:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 17:30:30 - snowflake.connector.connection - INFO - closed
2025-02-11 17:30:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:30:30 - root - INFO - SQL:
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
),
patients_with_lastname_A AS (
    SELECT DISTINCT patient_id
    FROM patient_names
    WHERE last_name ILIKE 'A%'
),
patient_conditions AS (
    SELECT c."subject"::STRING AS subject_ref,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
patients_with_one_condition AS (
    SELECT subject_ref, condition_code, COUNT(*) AS condition_count
    FROM patient_conditions
    GROUP BY subject_ref, condition_code
    HAVING COUNT(*) = 1
),
active_medications_per_patient AS (
    SELECT m."subject"::STRING AS subject_ref,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::STRING
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patients_with_lastname_A p
    JOIN patients_with_one_condition c
        ON c.subject_ref = CONCAT('Patient/', p.patient_id)
    JOIN active_medications_per_patient a
        ON a.subject_ref = CONCAT('Patient/', p.patient_id)
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Results:
No data found for the specified query.

2025-02-11 17:30:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:30:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:30:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:30:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:30:32 - snowflake.connector.connection - INFO - closed
2025-02-11 17:30:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:30:32 - root - INFO - SQL:
SELECT c."subject", COUNT(DISTINCT c."id") AS "condition_count"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
   GROUP BY c."subject"
   HAVING COUNT(DISTINCT c."id") = 1
   LIMIT 100;
Results:
Too long, hard cut:
subject,condition_count
"{
  ""patientId"": ""5ced7587-5155-4e8b-93d1-b0036a5c7aa1""
}",1
"{
  ""patientId"": ""3ba34735-dcc3-4082-bda2-d3d3c78fd7fb""
}",1
"{
  ""patientId"": ""76ccc6b5-afc7-4b73-9fb4-c58f96573e68""
}",1
"{
  ""patientId"": ""8917db9c-ae32-4f30-b484-5319ea624b3c""
}",1
"{
  ""patientId"": ""d91b5204-3706-4c58-abf6-799cecf4c78d""
}",1
"{
  ""patientId"": ""652dbda2-0740-428e-85d2-aff162be2dd6""
}",1
"{
  ""patientId"": ""504f98f4-cef9-43fd-85c2-20c2112029b6""
}",1
"{
  ""patientId"": ""0ea9fdb5-7cb7-4c1a-9e5a-32fac8bf2bf6""
}",1
"{
  ""patientId"": ""18b418e4-b465-4fce-95c2-9a29d9da7341""
}",1
"{
  ""patientId"": ""d99bfb55-7c0f-4ed6-b46a-846daa17d698""
}",1
"{
  ""patientId"": ""cfec8c51-ad8c-45f6-b8f5-fef59185fb7a""
}",1
"{
  ""patientId"": ""1bf8a526-92c4-427e-9534-ec0ae718ba17""
}",1
"{
  ""patientId"": ""22ac5fe1-1099-490f-b13a-2841f93bb6da""
}",1
"{
  ""patientId"": ""05311d13-27e7-423f-8fee-80a6bdcdcbbc""
}",1
"{
  ""patientId"": ""ae866336-87a2-4618-8e7f-475989859d06""
}",1
"{
  ""patientId"": ""feeb4216-40b7-4f33-999d-fdc5b0244ec2""
}",1
"{
  ""patientId"": ""e39cc651-28d6-4b56-b405-f27ae4ed8073""
}",1
"{
  ""patientId"": ""819bbb95-972a-40f4-9617-83325d96882c""
}",1
"{
  ""patientId"": ""fa155a89-9b94-4d50-9764-64bf20aaa384""
}",1
"{
  ""patientId"": ""00ffb1aa-4688-4116-afc4-f070ac2949c7""
}",1
"{
  ""patientId"": ""dd644501-60c1-4e90-a7f2-d5453c28dd4b""
}",1
"{
  ""patientId"": ""4a06a8d0-1327-4bb3-b9e3-0945a02a651e""
}",1
"{
  ""patientId"": ""f74da7ad-78e5-4e3d-9018-b7c4e5eda1a3""
}",1
"{
  ""patientId"": ""701f0b36-dc60-4518-a27e-1c0752c53c34""
}",1
"{
  ""patientId"": ""9676ae8f-d14e-4635-9921-20f162815cd9""
}",1
"{
  ""patientId"": ""56c771c9-2f2b-473f-b70c-507f1892ad32""
}",1
"{
  ""patientId"": ""a4d4f0f1-2a86-43f4-b61f-a7586b9e51de""
}",1
"{
  ""patientId"": ""059ffba9-b89f-4845-bd4c-132130f6bf6b""
}",1
"{
  ""patientId"": ""423999c9-da3f-4e85-88a2-c459d4c75d93""
}",1
"{
  ""patientId"": ""b9f23934-ec33-441c-bba8-b78a1051dad6""
}",1
"{
  ""patientId"": ""a1c2c0fb-fe69-4914-923d-e537216fef43""
}",1
"{
  ""patientId"": ""94b60cff-0783-4f20-bc81-d6ccbd09099c""
}",1
"{
  ""patientId"": ""bc04b77b-3af7-4484-82c7-6e86a0ab943c""
}",1
"{
  ""patientId"": ""55efcf76-99ab-4ff4-9ab9-ecd5e9540f97""
}",1
"{
  ""patientId"": ""f0d5018f-9701-4906-ad07-14288d3cc20b""
}",1
"{
  ""patientId"": ""80390857-07ee-4a4d-bc67-94555b14c248""
}",1
"{
  ""patientId"": ""70de0a51-e759-4975-85e2-29d2286c50cf""
}",1
"{
  ""patientId"": ""817722a2-5df1-41dd-b809-3876eaf06bd0""
}",1
"{
  ""patientId"": ""87acf546-bf38-451a-bef7-903f16759911""
}",1
"{
  ""patientId"": ""11fb371a-fb1e-46f5-8284-9a8477953ff9""
}",1
"{
  ""patientId"": ""84701621-3f15-4223-bb75-80cf1b6b4560""
}",1
"{
  ""patientId"": ""772bf732-7686-4972-9822-e26701161bb3""
}",1
"{
  ""patientId"": ""243492e4-1f70-42a6-9ab4-904e2c8edb9a""
}",1
"{
  ""patientId"": ""30188d31-b3a4-43d9-8520-86520830a724""
}",1
"{
  ""patientId"": ""da6c3a25-153d-4bf9-9f35-992b68399fc7""
}",1
"{
  ""patientId"": ""788755af-8ea0-4b27-a418-f9b02b80c18e""
}",1
"{
  ""patientId"": ""440a5d56-fd8b-4c43-88b7-b8ba671a51bc""
}",1
"{
  ""patientId"": ""79891b9d-266a-4f3a-8dd6-f77591a8a6e6""
}",1
"{
  ""patientId"": ""633ee23e-9173-4a8e-9ec0-1efaaebfee95""
}",1
"{
  ""patientId"": ""fbacea96-4fa6-4e62-aa41-09608ca8c78f""
}",1
"{
  ""patientId"": ""4d3d55c6-c6af-4114-a3e1-50cee3e86870""
}",1
"{
  ""patientId"": ""130ee5d0-6c06-40c3-bf87-a3f8278dcfbe""
}",1
"{
  ""patientId"": ""ff8b32ae-968f-481a-92ad-a86862904eb8""
}",1
"{
  ""patientId"": ""ac8c7b1c-87ce-4436-83bf-dd74f303e188""
}",1
"{
  ""patientId"": ""f36b02ed-0a49-4898-a7e7-718d1c61da63""
}",1
"{
  ""patientId"": ""58b28627-e096-4d59-954c-f962e3b0ecb3""
}",1
"{
  ""patientId"": ""0d6b2edc-7955-4216-bbb9-9e9733a9a803""
}",1
"{
  ""patientId"": ""0c8eb16d-4253-4352-bc46-2d4d9d4555a4""
}",1
"{
  ""patientId"": ""e8d611a0-4a76-4548-89ef-93eeaba96cdf""
}",1
"{
  ""patientId"": ""c8a63f51-d6a2-480f-9efa-e1dffc7cd871""
}",1
"{
  ""patientId"": ""d221ac7c-0deb-4e51-b535-6cffffa547b1""
}",1
"{
  ""patientId"": ""fe35f7a4-bc0c-42ff-bfe9-29bbcc8576f5""
}",1
"{
  ""patientId"": ""86c759d5-905f-469a-b5c7-867b7583d08f""
}",1
"{
  ""patientId"": ""e06387b0-dc0f-462a-bb60-4e338f3f37d2""
}",1
"{
  ""patientId"": ""f6afa81b-dad9-4309-8691-00a373f16021""
}",1
"{
  ""patientId"": ""dff5d640-de15-44a8-854e-42ee99268f30""
}",1
"{
  ""patientId"": ""7344a8fb-4800-4b17-9667-391b5987a988""
}",1
"{
  ""patientId"": ""2e2b9e2d-ab08-48bd-896f-6e36841d17aa""
}",1
"{
  ""patientId"": ""536f503f-fb95-4d67-8a52-2d32417b9824""
}",1
"{
  ""patientId"": ""dcea158a-33ea-48d5-baf9-1507240d113a""
}",1
"{
  ""patientId"": ""76acbb94-9b8a-4035-be9f-7991b9b69360""
}",1
"{
  ""patientId"": ""d613ce2d-2487-4443-9962-6857e1bb9f66""
}",1
"{
  ""patientId"": ""41b986cf-dbe0-4ca1-9cf9-9da43b0b05eb""
}",1
"{
  ""patientId"": ""820914fa-a14f-49e8-a950-74f9d382916a""
}",1
"{
  ""patientId"": ""3cc7d63d-c85c-4c83-a370-590c301bb096""
}",1
"{
  ""patientId"": ""19a4

2025-02-11 17:30:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:30:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:30:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:30:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:30:34 - snowflake.connector.connection - INFO - closed
2025-02-11 17:30:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:30:35 - root - INFO - SQL:
SELECT "id", "subject", "status"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
   WHERE "status" = 'active'
   LIMIT 100;
Results:
Too long, hard cut:
id,subject,status
4995669d-b05c-4727-96ec-8b9231df8c1d,"{
  ""patientId"": ""1a89bde4-e47b-4462-b81c-baabfd57f7c4""
}",active
49704eeb-df76-4f89-b604-8d0a9b565ccb,"{
  ""patientId"": ""d8376f0e-192f-4dab-9a82-5cdb19dc4c0e""
}",active
e08d7ea9-d0f1-409b-b7ac-43dc672ced03,"{
  ""patientId"": ""6d73860b-cbca-4c58-b526-f009c2d7b27b""
}",active
f3ae86f3-afee-406f-ba36-ad60e1b4e294,"{
  ""patientId"": ""85497af4-0359-40f7-89bf-5276d2184e2a""
}",active
e1b705bd-6cdd-40d2-95eb-bc8dfc63ed17,"{
  ""patientId"": ""eb96aae7-1108-4a85-af22-850f885e31b4""
}",active
e1a4f2a0-b842-476b-a701-dd3088bc10a4,"{
  ""patientId"": ""28867b4b-458d-4e50-ae72-eb2d8e806ca4""
}",active
7b9c3de1-a5e4-4b9f-8210-35ccd1aa7884,"{
  ""patientId"": ""2631347e-bf18-4308-8bac-45ca352c55bc""
}",active
6ab57460-f870-4971-8617-551c362cbc0a,"{
  ""patientId"": ""2902d496-fd1d-4297-9a14-540fd2917266""
}",active
6ac5f983-161b-415d-a1aa-5bc48a95c98d,"{
  ""patientId"": ""804227db-1797-4765-8972-da8d906564c1""
}",active
000b7799-cfa9-43d5-993f-90fc760dde1d,"{
  ""patientId"": ""9610b099-dae9-4f44-baee-59dadb3fb5ec""
}",active
6a3098a9-59cd-4c1b-ab87-352b03b253fb,"{
  ""patientId"": ""717db0b2-b5c8-4e19-a072-f14f48c4ce53""
}",active
0109b244-64bf-4dc7-9cfd-3e573dfb3269,"{
  ""patientId"": ""121e1731-8892-4f4d-8631-285fb737198e""
}",active
00e8632a-9ce8-4a09-8ddb-070dfb8886f9,"{
  ""patientId"": ""b9fc27bc-968a-4bea-b627-1da97148f1d0""
}",active
009aef71-5b53-4178-8c18-02919f624acb,"{
  ""patientId"": ""4dceb125-032e-408c-8b6a-866588f2eb60""
}",active
bd7aa392-ffb4-4578-b565-bc3e1ce4d846,"{
  ""patientId"": ""c1ab8f12-f6b0-4f03-aead-af5ccf7bd681""
}",active
bda37260-21ee-4295-b3b6-4b6322ccb9cb,"{
  ""patientId"": ""f2d88a62-2bc5-4ba8-8364-0508e47f339b""
}",active
bdd3c619-0963-4835-9504-d6fb5a11f534,"{
  ""patientId"": ""d1618723-5885-48d2-8cbb-32d8e37d9793""
}",active
15a7743d-fc52-49ea-8c07-f42b1880b5dd,"{
  ""patientId"": ""ffd43773-abd8-4a41-9617-790ff3c2093b""
}",active
fa9c537b-c2d5-492d-9855-9dc1b09ba427,"{
  ""patientId"": ""3899a4f1-0ebd-4691-9717-31abe97b3abe""
}",active
bcf96d25-e386-4b15-a254-c019253a0517,"{
  ""patientId"": ""94f7d3b8-ddbd-455e-a322-9ae71dc8218e""
}",active
bbf3c1a7-73a1-4a34-b257-6ca849ed44fd,"{
  ""patientId"": ""954d7d21-46a8-426f-814e-9d215e86715b""
}",active
bcdc972a-bbf7-4b32-b253-7bb96222fa0c,"{
  ""patientId"": ""9404ae08-fcde-47bb-b630-cff7ae52936d""
}",active
bafd14d5-6b11-4496-9059-57764d5952a5,"{
  ""patientId"": ""a4a80b0f-d377-4a89-b87b-1e0e09ed7b00""
}",active
bc4480ef-0f6b-4549-9855-2ebde729715e,"{
  ""patientId"": ""6c81731a-45eb-4351-8822-882f21226b76""
}",active
f59ef9d4-a956-42f8-9dd9-05b28200abd1,"{
  ""patientId"": ""abff57ba-6c48-481f-bf31-c17c100acfbb""
}",active
f607a9f2-55b3-4734-b81c-61545e1de09f,"{
  ""patientId"": ""44690417-ab7b-4d5c-8166-f2590f92a736""
}",active
bc1fc3d3-0437-4fb1-8400-43d87d891e65,"{
  ""patientId"": ""16250605-7939-45fb-b449-4849cda3f297""
}",active
a8e1e873-40a0-4b26-8e19-490c05251c74,"{
  ""patientId"": ""b5752f52-964d-4be2-b14a-344e0176441a""
}",active
23e8b52a-ff7d-4709-9114-3e574640cbdc,"{
  ""patientId"": ""96cae120-fef6-40ce-ba61-63809bf24f9d""
}",active
a727f272-e3db-4f5e-b2ff-a692d6ed4aee,"{
  ""patientId"": ""95275540-d0db-433d-bb23-b61c44d67088""
}",active
a7c6083e-3e06-4b62-ba1f-ba7df5037775,"{
  ""patientId"": ""4659ff9f-ae11-4341-8241-3b6edc572602""
}",active
4901a24b-2155-4e33-b740-2d74720334d1,"{
  ""patientId"": ""a17375c9-f5ef-4e04-aa1d-786a3e31e8bc""
}",active
a76dcc41-09be-4589-9a0b-505dd4a4801a,"{
  ""patientId"": ""873e6bfc-3ec7-4d8f-9f20-cac13ae38a75""
}",active
4843c94b-b461-41d4-b373-02fd09defc8b,"{
  ""patientId"": ""3d52edae-8a29-4266-a44d-176bfc980e04""
}",active
2447e008-732f-4116-9204-fbb3ac6eefb3,"{
  ""patientId"": ""4d5c0d55-8635-4874-aa33-fc62fd3d4c73""
}",active
fcb10a93-dfc2-4ffd-8120-3166e2529935,"{
  ""patientId"": ""a6bb4dcb-8bdf-4d74-a593-a596212052e1""
}",active
0f3486da-a517-4158-9b24-43f926d5e84f,"{
  ""patientId"": ""db0e9ec2-5e7e-41c0-8929-4567deb7856d""
}",active
1039d673-6146-4cb0-a4fa-ea45ce1b2f1a,"{
  ""patientId"": ""4f3161b0-bfae-4f57-8cfe-67b92f7e3459""
}",active
fbf6c23c-947e-4963-90b5-64666444d93d,"{
  ""patientId"": ""b75674ae-1310-465f-bbdb-269ee1bf3674""
}",active
bf9fa8b4-c53c-4c09-97c8-826532d31270,"{
  ""patientId"": ""c3e3462d-f87c-49e8-a6b5-ed41b79b9ad5""
}",active
fbf9676b-75ba-4146-bc98-5eba2c1c4ddb,"{
  ""patientId"": ""ce640217-c73e-41e5-b569-40f129026fbf""
}",active
1032acb2-4b52-4892-b418-0ef3c482e3f0,"{
  ""patientId"": ""1d692416-0bd9-431b-9fcb-bca3c25b6e43""
}",active
fb31f70d-8673-41b0-8141-9381996ec86c,"{
  ""patientId"": ""d6333072-9788-4c57-b3b3-e16173c97fa8""
}",active
0fc2acb9-f809-446e-afdf-ec9832ba0136,"{
  ""patientId"": ""d1979b52-12ef-4adf-8b9a-6858b4a5f806""
}",active
d863c96b-7f73-4364-a1b2-e6ef50056c58,"{
  ""patientId"": ""359ef90f-ba0d-40e7-a8a4-ed81e7a6fc13""
}",active
b9c265dd-0bc0-4838-b9d0-47e0af619374,"{
  ""patientId"": ""217a74b1-bf4c-40c0-9b5e-fc4ea0ac1be5""
}",active
ba15b3ae-6f4e-

2025-02-11 17:30:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:30:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:30:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:30:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:30:36 - snowflake.connector.connection - INFO - closed
2025-02-11 17:30:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:30:36 - root - INFO - SQL:
SELECT c."id", c."code"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
   LIMIT 100;
Results:
Too long, hard cut:
id,code
372b7d2e-ecb2-4fe6-a572-2e1955e493d1,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
9b9e7457-d096-4766-ad30-9975ad8352db,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
36f814a7-8da2-4163-a9e1-573dbacf971e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
b2d7987a-eb81-431c-80b9-8e1cce4f47e5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
d58ed937-24af-45f2-88fe-3faafeddfa1a,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
011ebdc7-4a1b-45c0-a155-aaaff81d7e0b,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
82e3ab6f-49cd-481b-88fc-cae52cdb729e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
825db10a-a2bb-4a95-9f80-2b15c3d83b40,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
37a130aa-b37e-4986-afa6-1d98aaf50eaa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
cb3dfebd-5a5e-4273-bc32-3fe5c43e0ecd,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
ab561037-815d-4182-ae51-526a8c4f85a4,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
7597a472-3ebe-4bc2-b179-7236514e98aa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
fc1079d1-11fb-43c4-8718-127e91fb2426,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
992edc1d-0bd1-4444-97cf-179d0085e4c6,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
62dabd0d-baac-43e5-9e65-d6473025522c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
3afa9aea-e686-4b4a-b2f0-2641fd45633c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
c5385f1f-16fd-425e-9f64-fc77401b0dd5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the 

2025-02-11 17:30:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:30:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:30:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:30:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 17:30:38 - snowflake.connector.connection - INFO - closed
2025-02-11 17:30:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:31:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:31:16 - root - INFO - ```sql
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
),
patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_names p
    JOIN patient_conditions c ON c.patient_id = p.patient_id
    JOIN active_medications_per_patient a ON a.patient_id = p.patient_id
    WHERE p.last_name ILIKE 'A%'
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:31:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:31:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:31:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:31:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 17:31:17 - snowflake.connector.connection - INFO - closed
2025-02-11 17:31:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:32:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:32:30 - root - INFO - SQL:
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
),
patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_names p
    JOIN patient_conditions c ON c.patient_id = p.patient_id
    JOIN active_medications_per_patient a ON a.patient_id = p.patient_id
    WHERE p.last_name ILIKE 'A%'
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Results:
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
302870006,17
126906006,17
49436004,17
15777000,17
422034002,17
230690007,17
239873007,17
53741008,17

2025-02-11 17:32:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:32:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:32:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:32:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:32:32 - snowflake.connector.connection - INFO - closed
2025-02-11 17:32:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:32:32 - root - INFO - SQL:
SELECT "id", "subject", "medication"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
   LIMIT 100;
Results:
Too long, hard cut:
id,subject,medication
c2add253-c592-4d15-9d22-680b6407ef86,"{
  ""patientId"": ""6014b1f1-342f-4e93-80d8-1c6c31afd003""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
c43129cd-02d7-4ff7-9934-8988ded26178,"{
  ""patientId"": ""52c2ef3d-1ebb-4a71-bc22-1733f9c46b84""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
f3c85a1d-1fe8-4730-8343-0b0a1af9eac5,"{
  ""patientId"": ""cf3253b0-4d98-4d7b-92d3-17760dfe92b1""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
4c59b084-4c9c-42e0-89fa-f49c9a77660a,"{
  ""patientId"": ""bad4c7e4-e40a-4bf4-9da2-0e0f9ee47bfb""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
4073a9ce-c77d-4bf1-a82d-5d3e85190752,"{
  ""patientId"": ""2bca9741-8e35-4677-8e04-f4b657a405ef""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
97d5b846-a994-4b4e-8bf7-da23a62a0539,"{
  ""patientId"": ""d4ce9987-17a6-4a10-af77-988867ef9998""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
fde465fe-0810-4b39-ae64-5d8d3c36a66c,"{
  ""patientId"": ""1127929a-7985-4302-a206-847d5644d939""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
3e063cdc-ffac-4808-8db4-decdc8516647,"{
  ""patientId"": ""8f8263d1-55df-46fa-a0ca-44264b8de3d0""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
d382dc83-b4a0-4f32-9d1d-f7374d003f40,"{
  ""patientId"": ""39d10bf0-59bf-4c6a-96cf-4f361510d474""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
184d32ff-218a-4ac0-bb4f-354a7f92702e,"{
  ""patientId"": ""52e98828-0ea3-4656-a173-6cb8b2d0740f""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
0c5489d9-f868-4017-aa43-27c68f793549,"{
  ""patientId"": ""d6b60fe1-ee78-4218-81d0-9500a1b1712b""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
115546f4-82ee-452a-95c3-56615ccbb8ef,"{
  ""patientId"": ""e71757c4-bcfa-483c-835d-a461dad7525d""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
6e826a5e-7e2e-4645-82d5-014a48ee2b01,"{
  ""patientId"": ""5a502bc3-10f4-4153-8d56-22581fbe3115""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""480"",
        ""display"": ""Alfentanil"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Alfentanil""
  }
}"
f381b355-6aee-4ddb-a4b3-2a827535167a,"{
  ""patientId"": ""9984a23a-40ac-4342-8720-7ec443b72431""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""480"",
        ""display"": ""Alfentanil"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Alfentanil""
  }
}"
e7f6bbd9-9db7-4d2b-9337-98eb9f11a2c5,"{
  ""patientId"": ""b439378f-cf4f-4c5f-8057-fc9220d14471""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""480"",
        ""display"": ""Alfentanil"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxno

2025-02-11 17:32:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:32:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:32:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:32:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:32:33 - snowflake.connector.connection - INFO - closed
2025-02-11 17:32:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:33:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:33:01 - root - INFO - ```sql
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
),
patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_names p
    JOIN patient_conditions c ON c.patient_id = p.patient_id
    JOIN active_medications_per_patient a ON a.patient_id = p.patient_id
    WHERE p.last_name ILIKE 'A%'
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:33:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:33:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:33:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:33:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 17:33:03 - snowflake.connector.connection - INFO - closed
2025-02-11 17:33:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:34:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:34:29 - root - INFO - SQL:
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
),
patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_names p
    JOIN patient_conditions c ON c.patient_id = p.patient_id
    JOIN active_medications_per_patient a ON a.patient_id = p.patient_id
    WHERE p.last_name ILIKE 'A%'
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Results:
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
49436004,17
239873007,17
302870006,17
90781000119102,17
53741008,17
92691004,17
88805009,17
422034002,17

2025-02-11 17:34:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:34:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:34:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:34:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:34:30 - snowflake.connector.connection - INFO - closed
2025-02-11 17:34:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:34:31 - root - INFO - SQL:
SELECT m."subject", COUNT(DISTINCT m."medication") AS "active_medication_count"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"
    LIMIT 100;
Results:
Too long, hard cut:
subject,active_medication_count
"{
  ""patientId"": ""2c5023d2-24db-473d-af86-0fd8c5248215""
}",5
"{
  ""patientId"": ""0b177698-ec33-4710-96eb-56ef57eb16ed""
}",1
"{
  ""patientId"": ""c435db10-8ce1-4130-83a1-bcea5e705470""
}",4
"{
  ""patientId"": ""ea8e21d6-1933-4623-a6e1-34c4d02fdfe2""
}",4
"{
  ""patientId"": ""9f4a1ae9-f6d6-462c-864d-82ace4bb88ea""
}",3
"{
  ""patientId"": ""d5734e1e-7b51-4724-9515-a0b6c3d2a2eb""
}",2
"{
  ""patientId"": ""ec3e8e6b-4697-4735-b776-f04f0ab0ae1b""
}",1
"{
  ""patientId"": ""ff967fb1-bcdb-4114-9398-8d9c4d031f64""
}",1
"{
  ""patientId"": ""db780e8c-44d6-4bb0-9d81-4f34ec90a2fd""
}",5
"{
  ""patientId"": ""ab7eb2a5-aefc-4abc-9d57-309a1a727b55""
}",3
"{
  ""patientId"": ""0af20a41-52da-46d8-8463-56290ed6559f""
}",1
"{
  ""patientId"": ""a83d53d1-3f8c-4dc3-878e-b7523d6996e3""
}",15
"{
  ""patientId"": ""ce9ff2f4-3ead-477e-9257-bd9cfb5315b3""
}",4
"{
  ""patientId"": ""56e7c71e-f950-44ac-9e16-6373d8dfa2e0""
}",6
"{
  ""patientId"": ""f2e66446-8e51-4ebd-83c9-1f15e0309f90""
}",1
"{
  ""patientId"": ""a3c3d2e2-0a6a-4faf-a6bd-b8b2d1a6fa2c""
}",4
"{
  ""patientId"": ""b2b60c79-2089-46be-982c-24aafb07c197""
}",9
"{
  ""patientId"": ""445d3c28-b9c0-42b4-b8e8-a585f001f6cb""
}",3
"{
  ""patientId"": ""563bbbeb-4442-4758-9cb1-1ef34ae1f135""
}",1
"{
  ""patientId"": ""3f293ebe-8883-41a6-a4f3-9fa200642964""
}",3
"{
  ""patientId"": ""d3fbe8c0-82a8-4ce0-a6ac-40932b41d5fe""
}",5
"{
  ""patientId"": ""46b40863-30df-459e-b4eb-94230918ab13""
}",6
"{
  ""patientId"": ""15df7913-9e64-4f88-9c52-5980dc001789""
}",1
"{
  ""patientId"": ""846a59e0-8243-44be-892a-bb6e37e3a645""
}",1
"{
  ""patientId"": ""d209ab43-13cd-4b66-a525-5b7789c8983f""
}",9
"{
  ""patientId"": ""b80d97d8-0906-423c-93d1-48f2ddd5f6d0""
}",6
"{
  ""patientId"": ""c1d99fe3-1d19-472f-ae2e-9fa128391dd6""
}",3
"{
  ""patientId"": ""aad74eb6-1f18-4b2c-8b67-efc591a08251""
}",5
"{
  ""patientId"": ""c81ed47b-d00c-4a68-81bb-4692d8fcaccc""
}",2
"{
  ""patientId"": ""22a42c5b-d3af-4f1f-9f99-14c33a8a75f7""
}",1
"{
  ""patientId"": ""34b9a6e6-584d-47c1-86e0-353b0eb10f94""
}",1
"{
  ""patientId"": ""4d1c89a6-1fe2-4950-8ada-547fa292b96c""
}",7
"{
  ""patientId"": ""94511beb-e82c-4651-9825-4758dc16b13f""
}",5
"{
  ""patientId"": ""417f3ad2-c155-466f-a884-bab06ae8ef03""
}",3
"{
  ""patientId"": ""16ce4b60-92be-4bfe-89c7-324e07984f54""
}",3
"{
  ""patientId"": ""bb7f1693-2884-4d94-b4c9-c76c18b4d65b""
}",1
"{
  ""patientId"": ""2787b6ce-826e-49a5-977d-8994caa9e387""
}",1
"{
  ""patientId"": ""892ed989-3509-46df-8606-da29f1b6fcc3""
}",1
"{
  ""patientId"": ""86ca67ef-6bb9-4933-84ca-69ea2b2bcdcb""
}",2
"{
  ""patientId"": ""51bcd86b-c47d-4897-8fd6-272f8ccd3908""
}",5
"{
  ""patientId"": ""dfef5f47-0108-423d-a1bf-087ad603a199""
}",2
"{
  ""patientId"": ""eb0de8d7-e668-4a8d-ba15-0518ab999792""
}",2
"{
  ""patientId"": ""8b8e8d28-c53b-4098-8eae-ae9dc55f85cc""
}",1
"{
  ""patientId"": ""4b43ff20-160a-4ebc-9909-a6694927c358""
}",4
"{
  ""patientId"": ""3df42085-7bed-4f58-ba3f-9740c760d0f8""
}",1
"{
  ""patientId"": ""a3fd1dec-75a1-41e1-9dda-4f7a6d3dd140""
}",8
"{
  ""patientId"": ""5a9e7f09-fc66-4d8c-853a-12f2f3a7d976""
}",4
"{
  ""patientId"": ""284b67ce-5fc5-4caf-80a9-a2fa2c3e5481""
}",13
"{
  ""patientId"": ""4ceaa4b6-4c7d-4a37-bda4-d60a8bee2d9f""
}",1
"{
  ""patientId"": ""6618110f-fe95-44c6-8dcd-9b9656a26c64""
}",3
"{
  ""patientId"": ""a0e0f317-c8ad-427a-83fa-16f8e0e732a8""
}",1
"{
  ""patientId"": ""ed1201a6-3f31-4d27-b9df-66dc0c559c30""
}",7
"{
  ""patientId"": ""3cc1f24d-8f63-4d9e-a630-e5e6279d53c7""
}",7
"{
  ""patientId"": ""95593208-25ce-4c21-b22f-efe099e6b340""
}",6
"{
  ""patientId"": ""8e52dcd1-3e09-401e-a500-b9f10887bc25""
}",4
"{
  ""patientId"": ""3f3980e9-56a8-4dd4-8902-c6aee4e6f812""
}",3
"{
  ""patientId"": ""eb26abfb-efee-4476-a4b7-cad9bbb5f159""
}",4
"{
  ""patientId"": ""dd56eae0-2361-45b9-85f3-e9ba8f5c0a4e""
}",5
"{
  ""patientId"": ""f17f8d5c-0959-45b0-9a7e-dc88d1f1e8c3""
}",1
"{
  ""patientId"": ""97af413f-39a2-4104-8a22-5e63ddd5433d""
}",10
"{
  ""patientId"": ""8395f086-0cd3-4f03-ba45-e92f852acf35""
}",4
"{
  ""patientId"": ""b4312256-0b11-41a6-a47e-21ed9e680dae""
}",5
"{
  ""patientId"": ""6efb9050-29b9-45eb-8aa4-725858a71a73""
}",1
"{
  ""patientId"": ""c1d7cc61-06e0-4fc7-8013-958be09ea19e""
}",9
"{
  ""patientId"": ""946c3106-6379-47b3-a4f3-72f9c4b3ed90""
}",4
"{
  ""patientId"": ""e8847c8f-7999-42ad-8e9f-9b602eab87a8""
}",4
"{
  ""patientId"": ""783a22e1-86f0-48d6-a941-d22879ceffb1""
}",4
"{
  ""patientId"": ""f22b295a-c4a3-4470-8924-06377f8aada6""
}",2
"{
  ""patientId"": ""e468f6f1-315d-4427-a059-73df1cb7bff5""
}",1
"{
  ""patientId"": ""bd31c5bf-5f3b-478e-b955-dd128cc0692b""
}",2
"{
  ""patientId"": ""40664b95-86c5-4c31-91c3-10bf71708ade""
}",2
"{
  ""patientId"": ""c6991dc6-65a4-41ee-a9d8-4deba91d8ebe""
}",3
"{
  ""patientId"": ""1c215dd7-7683-4a9a-b001-035de456eeb2""
}",7
"{
  ""patientId"": ""ea7b0001-20d2-4796-9092-1c947b2d13b4""
}",5
"{
  ""patientId"": ""181bdd58-2a13-403d-82da-7a8ffbee1a17""
}",3
"{
  ""patientI

2025-02-11 17:34:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:34:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:34:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:34:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 17:34:32 - snowflake.connector.connection - INFO - closed
2025-02-11 17:34:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:34:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:34:57 - root - INFO - ```sql
WITH patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT c.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_conditions c
    JOIN active_medications_per_patient a ON a.patient_id = c.patient_id
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:34:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:34:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:34:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:34:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 17:34:59 - snowflake.connector.connection - INFO - closed
2025-02-11 17:34:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:36:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:36:14 - root - INFO - SQL:
WITH patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT c.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_conditions c
    JOIN active_medications_per_patient a ON a.patient_id = c.patient_id
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Results:
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
92691004,20
49436004,20
88805009,20
127013003,20
302870006,20
64859006,20
443165006,20
53741008,20

2025-02-11 17:36:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:36:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:36:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:36:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:36:19 - snowflake.connector.connection - INFO - closed
2025-02-11 17:36:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:36:19 - root - INFO - SQL:
SELECT p."id", n.value:"family"::STRING AS "last_name"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    WHERE (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
      AND n.value:"family"::STRING ILIKE 'A%'
    LIMIT 100;
Results:
id,last_name
70e68f26-d642-4105-b82a-1257a0d10848,Ankunding277
8c373ed3-716d-4c86-bf5e-a050f4de09d7,Abernathy524
fc000d11-aad4-4afc-93b5-e0353e0b3287,Armstrong51
f4a80dd3-5146-40ee-9ac9-a6ae62d9cfe8,Adams676
5c664454-b26e-40b4-a113-2e4e4d21d1da,Altenwerth646
fd480c9c-8b8a-46de-803a-b1603c00b671,Adams676
1e741807-21d1-451d-9cc5-6473955d3fb7,Aufderhar910
92495ce3-2931-4fb7-a319-a47710ffea2c,Abshire638
730cd58c-8a99-4e24-88ea-7b945a10892b,Adams676
cf235044-9d32-4d04-8f79-f7515b9f6609,Anderson154
fec31a34-56d5-4620-b329-f4f1863ff3fe,Abbott774
20649d37-036c-4586-8862-6c321f8a9124,Auer97
50196de2-2405-4822-9d52-d2f714d440ba,Auer97
c7b2cbf8-c61f-4c41-bf1e-5c26400a04e8,Anderson154
de7699da-4642-4a79-b5cc-c10b1f026ad4,Abernathy524
ff599ea0-92a8-4677-b5b7-fbc754900294,Abernathy524
ef341f55-59c8-423d-8633-554dfcaf0f42,Abshire638
d77ceece-5af4-4ed3-9005-d9c9906e081b,Abernathy524
4b3ca3ec-8c42-4037-bfb3-c4ed340d0524,Adams676
ec2fab6f-763a-4492-8292-c94f697a9480,Altenwerth646
0adc0086-8e77-43ea-ab6d-c64591b66508,Ankunding277
15607b50-2e55-4532-a3dc-6e62285ba28c,Altenwerth646
796d1d2c-f011-4044-a2ed-80ca087d28f2,Ankunding277
b83497b9-9b7d-486c-9aeb-40ae98ef038d,Abshire638
ffbd8d6d-f3e1-4d39-a829-3a8dec7cf423,Ankunding277
b20579c8-c7e9-4893-a5ae-758b0a30202d,Aufderhar910
c4427a19-b270-4a68-8030-9e1d9a0a88d6,Ankunding277
41c67c66-7735-49fd-90a1-6b6e099cdf8f,Abshire638
c5a97fb1-66c1-4a75-b06d-58ac84a091c0,Aufderhar910
8a582d86-9480-437e-b9d5-69c1cf85b5bd,Altenwerth646
7ba91fef-50bd-4d35-8893-ef9f6915d082,Abernathy524
bc0d5fe9-f04f-4412-a45c-52bbe5f180ea,Armstrong51
16984bfc-6254-46bf-a76b-f9ebae232a9a,Altenwerth646
2038e30f-9f98-4337-90a4-6dcb267f0181,Anderson154
a62d1fde-ddc3-4aed-93e4-019fcb7ee889,Abernathy524
ee3185b1-9a60-471c-afb9-8bf476cd5614,Abernathy524
a4aac524-dd30-48e5-bd5e-3a4a7d4f25cd,Abernathy524
34fe508d-4d96-405c-9633-4c27091d4870,Aufderhar910
3c0b28e6-2c92-472b-be03-6052302285c8,Abernathy524
43819a00-f532-40ce-87ea-a31d7806aee9,Abernathy524
d8f88a34-ae2f-4d7b-9885-f698f7c06bb2,Abshire638
063fe861-2ffa-47d4-b090-170fd4c86f24,Abernathy524
34e15838-36f3-4353-88c4-a7a18d9223c1,Armstrong51
560e4590-d952-4bf3-94ac-fcdabd74f488,Armstrong51
50ccf4a2-1a93-43b1-8655-51e6b39aceda,Auer97
a91118f7-bad9-4fae-82c8-419ea50986f0,Abernathy524
ce46a3b0-232b-4310-938f-42f68c84c57d,Abbott774
3e770e48-eea4-4da9-ad49-40c65bd7c7f3,Altenwerth646
65550337-ecca-41f6-bc76-64ca259186ba,Ankunding277
bac6395e-3edb-4ff4-892f-15cb678eaa0b,Abernathy524
9b92e0d4-30da-4e21-8760-c083849ef8e4,Aufderhar910
99c7ec03-e162-4125-81b0-6990f3f61355,Ankunding277
6907d53d-4252-4c27-9fb7-bb5ba43515a2,Armstrong51
6b20bd50-653f-4e13-8540-acb20c96d8dd,Armstrong51
7de75cb2-2f64-4fdc-b751-eed00c9c33b7,Abbott774
b7396cf7-85cb-4b21-aad0-367ae5d2cc7c,Aufderhar910
009efe51-00f5-45d7-ac13-2c82b919cce0,Adams676
f318abec-9783-4554-b5d8-4ca49597bb6f,Abbott774
a9cc5f19-4aa9-4a6d-8269-f7c49f2cf34b,Armstrong51
1b1d402e-17c0-4a5f-ac74-971fd4779d66,Abbott774
f1e09c8b-a661-47f1-9cd5-704d51358cdc,Altenwerth646
ef55677e-f307-4032-94a9-72732a971bca,Abshire638
1b930227-c879-475b-a91e-c2937b62d208,Anderson154
3ae19083-c488-40fb-a7e3-831045a09bed,Adams676
0f05a6ab-e13f-47d7-b048-d1919ca18166,Auer97
ff2889b6-2f03-4fb8-b45a-a3d2eda4abbd,Abshire638
96d9c096-974f-4177-b248-15dba6bce243,Auer97
a2d00aa3-9282-46be-8f00-0388a7eaf9c1,Anderson154
20b8e390-0cea-43cb-8abe-588630e79f42,Ankunding277
a86fe402-17f5-41ea-bca0-5eb37e763850,Armstrong51
a86fe402-17f5-41ea-bca0-5eb37e763850,Abernathy524
64c2c754-b84a-4e53-b0b6-f469d3c81787,Ankunding277
82a6d413-d60b-4052-9009-0cedb2922dde,Ankunding277
08f2fc89-ed7f-4dbc-adcb-75caed2dd26c,Ankunding277
42532a4b-db49-405a-92c9-34e60cbbcadd,Armstrong51
6bc1acea-3808-4af2-98a8-a16e537ed8f8,Abshire638
acc3f1d8-cc7e-417a-ab83-76f137eb4f0d,Auer97
405dc7e0-98c3-487c-bc8f-16df685d84c0,Abshire638
777414ce-f051-43ca-8641-ba671dcf38c5,Armstrong51
33d47315-4240-4f7d-8f3a-6eb5e5eff925,Abshire638
d6aeab94-fe7d-4a04-8ea6-79209448f1d0,Abernathy524
068755c9-132d-41ca-aa08-f3d64714a7fd,Aufderhar910
1d7e3acd-a164-4f6f-8b94-52b4ace86e70,Armstrong51
aba017c3-4e76-4d35-a138-a4ca65431cf7,Auer97
cc68130c-76e5-49f3-9495-6dcd7ace191e,Abbott774
d38755be-ef4f-4750-935e-ff96159ff624,Abshire638
fa659eb8-3f2b-4fde-ac48-f9785dd9f8fd,Abshire638
64b1d8dc-05a4-4dfb-80ba-6374b5cc0571,Aufderhar910
31250542-dd38-49f7-b3b2-5e31c22006ba,Adams676
1a40a0e2-9604-451d-a03d-2346d243ee90,Auer97
118ca6d2-1e43-46d1-be27-c01dcf5d0af3,Aufderhar910
d2e60257-31de-4833-8453-06f2ae15bd48,Auer97
88e9d3e9-95cc-4ec3-85b2-196073e79a69,Abshire638
8d3eadd9-1677-467f-9d59-938d74e167c1,Armstrong51
748c3e66-9782-4d19-b85b-1b56f8593132,Aufderhar910
e84455fd-7d5e-4375-9f9c-885f9b70caf5,Abernathy524
473b069b-179d-4e44-b903-47cf6514b93a,Altenwerth646
1a4dc92c-c017-418e-90b3-164142ef7d32,Auer97
e6ddaa3a-b3f1-4db0-9d23-85b35d94cb16,Aufderhar910
55ce78bb-5df5-4dbe-a4bc-a71682a21a6f,Auer97

2025-02-11 17:36:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:36:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:36:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:36:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:36:23 - snowflake.connector.connection - INFO - closed
2025-02-11 17:36:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:36:23 - root - INFO - SQL:
SELECT c."subject", c."code"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject", c."code"
    HAVING COUNT(DISTINCT c."id") = 1
    LIMIT 100;
Results:
Too long, hard cut:
subject,code
"{
  ""patientId"": ""33262bbe-6ca0-4c61-89f0-c3387b4eeccc""
}","{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}"
"{
  ""patientId"": ""816157d6-a6a2-4404-a1a0-ff71ef3678fa""
}","{
  ""coding"": [
    {
      ""code"": ""88805009"",
      ""display"": ""Chronic congestive heart failure (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Chronic congestive heart failure (disorder)""
}"
"{
  ""patientId"": ""02b499ca-9f25-48fa-b8fd-0391e9ee3d31""
}","{
  ""coding"": [
    {
      ""code"": ""128613002"",
      ""display"": ""Seizure disorder"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Seizure disorder""
}"
"{
  ""patientId"": ""b59e1687-e64c-4c43-9861-451829da148a""
}","{
  ""coding"": [
    {
      ""code"": ""444814009"",
      ""display"": ""Viral sinusitis (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Viral sinusitis (disorder)""
}"
"{
  ""patientId"": ""4af3449a-a3d0-4b9a-b91d-fd6d328f818f""
}","{
  ""coding"": [
    {
      ""code"": ""5602001"",
      ""display"": ""Opioid abuse (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Opioid abuse (disorder)""
}"
"{
  ""patientId"": ""1a1590a5-61d6-4b10-b24a-af7b4c63e940""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""e1e02c17-ba4e-41a0-b6d1-bd854ec3a135""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""ec994d06-33c0-4cda-ae17-84aa9fc67bae""
}","{
  ""coding"": [
    {
      ""code"": ""127013003"",
      ""display"": ""Diabetic renal disease (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Diabetic renal disease (disorder)""
}"
"{
  ""patientId"": ""c62c8452-40a0-4fc5-b675-cd4d9f9c1339""
}","{
  ""coding"": [
    {
      ""code"": ""444814009"",
      ""display"": ""Viral sinusitis (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Viral sinusitis (disorder)""
}"
"{
  ""patientId"": ""01cb3f05-203f-4124-bc18-92f92e3345e7""
}","{
  ""coding"": [
    {
      ""code"": ""126906006"",
      ""display"": ""Neoplasm of prostate"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Neoplasm of prostate""
}"
"{
  ""patientId"": ""f1eafbb2-3c5d-432e-96d1-e45f01d90b4b""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""3fa17d2c-6e99-4f62-b73c-263f156878dc""
}","{
  ""coding"": [
    {
      ""code"": ""195662009"",
      ""display"": ""Acute viral pharyngitis (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Acute viral pharyngitis (disorder)""
}"
"{
  ""patientId"": ""3e587bb5-74fa-4a91-922a-569bdf99628f""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""608900b0-7655-43f0-ba3f-790401d5aa60""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""5e59b6e3-a8dc-4c17-baa9-2ef8dbc63f25""
}","{
  ""coding"": [
    {
      ""code"": ""24079001"",
      ""display"": ""Atopic dermatitis"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Atopic dermatitis""
}"
"{
  ""patientId"": ""299388f4-d727-4a15-8d01-91f4ebb91cd7""
}","{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}"
"{
  ""patientId"": ""81244712-9228-4815-9fa3-d4d462af9801""
}","{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}"
"{
  ""patientId"": ""e154a6fa-1f22-4387-b016-2fbacd32f74d""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  "

2025-02-11 17:36:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:36:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:36:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:36:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:36:29 - snowflake.connector.connection - INFO - closed
2025-02-11 17:36:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:36:29 - root - INFO - SQL:
SELECT c."code", COUNT(DISTINCT m."medication") AS "active_medication_count"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      ON m."subject" = c."subject"
    WHERE m."status" = 'active'
    GROUP BY c."code"
    LIMIT 100;
Results:
Too long, hard cut:
code,active_medication_count
"{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}",112
"{
  ""coding"": [
    {
      ""code"": ""48333001"",
      ""display"": ""Burn injury(morphologic abnormality)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Burn injury(morphologic abnormality)""
}",75
"{
  ""coding"": [
    {
      ""code"": ""196416002"",
      ""display"": ""Impacted molars"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Impacted molars""
}",105
"{
  ""coding"": [
    {
      ""code"": ""6072007"",
      ""display"": ""Bleeding from anus"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Bleeding from anus""
}",82
"{
  ""coding"": [
    {
      ""code"": ""45816000"",
      ""display"": ""Pyelonephritis"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Pyelonephritis""
}",73
"{
  ""coding"": [
    {
      ""code"": ""82423001"",
      ""display"": ""Chronic pain"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Chronic pain""
}",104
"{
  ""coding"": [
    {
      ""code"": ""84757009"",
      ""display"": ""Epilepsy"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Epilepsy""
}",108
"{
  ""coding"": [
    {
      ""code"": ""239720000"",
      ""display"": ""Tear of meniscus of knee"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Tear of meniscus of knee""
}",99
"{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}",116
"{
  ""coding"": [
    {
      ""code"": ""44301001"",
      ""display"": ""Suicide"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Suicide""
}",2
"{
  ""coding"": [
    {
      ""code"": ""425048006"",
      ""display"": ""Non-small cell carcinoma of lung, TNM stage 2 (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Non-small cell carcinoma of lung, TNM stage 2 (disorder)""
}",3
"{
  ""coding"": [
    {
      ""code"": ""68496003"",
      ""display"": ""Polyp of colon"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Polyp of colon""
}",92
"{
  ""coding"": [
    {
      ""code"": ""195967001"",
      ""display"": ""Asthma"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Asthma""
}",83
"{
  ""coding"": [
    {
      ""code"": ""431856006"",
      ""display"": ""Chronic kidney disease stage 2 (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Chronic kidney disease stage 2 (disorder)""
}",92
"{
  ""coding"": [
    {
      ""code"": ""363406005"",
      ""display"": ""Malignant tumor of colon"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Malignant tumor of colon""
}",86
"{
  ""coding"": [
    {
      ""code"": ""161622006"",
      ""display"": ""History of lower limb amputation (situation)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""History of lower limb amputation (situation)""
}",56
"{
  ""coding"": [
    {
      ""code"": ""49436004"",
      ""display"": ""Atrial Fibrillation"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Atrial Fibrillation""
}",82
"{
  ""coding"": [
    {
      ""code"": ""1501000119109"",
      ""display"": ""Proliferative diabetic retinopathy due to type II diabetes mellitus (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Proliferative diabetic retinopathy due to type II diabetes mellitus (disorder)""
}",81
"{
  ""coding"": [
    {
      ""code"": ""236077008"",
      ""display"": ""Protracted diarrhea"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Protracted diarrhea""
}",82
"{
  ""coding"": [
    {
      ""code"": ""427089005"",
      ""display"": ""Diabetes from Cystic Fibrosis"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Diabetes from Cystic Fibrosis""
}",44
"{
  ""coding"": [
    {
      ""code"": ""22298006"",
      ""display"": ""Myocardial Infarction"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Myocardial Infarction""
}",103
"{
  ""coding"": [
    {
      ""code"": ""275272006"",
      ""display"": ""Brain damage - traumatic"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Brain damage - traumatic""
}",101
"{
  ""coding"": [
    {
      ""code"": ""225444004"",
      ""display"": ""At risk for suicide (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""At risk for suicide (finding)""
}",46
"{
  ""coding"": [
    {
      ""code"": ""43878008"",
      ""display"": ""Streptococcal sore throat (disorder)"",
 

2025-02-11 17:36:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:36:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:36:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:36:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:36:30 - snowflake.connector.connection - INFO - closed
2025-02-11 17:36:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:36:31 - root - INFO - SQL:
SELECT p."id",
           n.value:"family"::STRING AS "last_name",
           n.value:"given"[0]::STRING AS "first_name"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    LIMIT 100;
Results:
Too long, hard cut:
id,last_name,first_name
88ef6674-68e2-4891-baf1-97ae4fab039a,Marquardt819,Myrtis608
88ef6674-68e2-4891-baf1-97ae4fab039a,Mante251,Myrtis608
a2c64eff-6d05-4827-807a-2e9fbde7f10a,Wolff180,Faviola526
a2c64eff-6d05-4827-807a-2e9fbde7f10a,Rogahn59,Faviola526
eb263d17-f504-47b1-a211-7c93813a28b2,Kulas532,Chin306
eb263d17-f504-47b1-a211-7c93813a28b2,Williamson769,Chin306
06905e8c-1844-4064-b0ef-2a856af10e0f,Krajcik437,Ali918
06905e8c-1844-4064-b0ef-2a856af10e0f,Dickens475,Ali918
4b110832-9a6e-4373-ab1d-e5d839eae6f3,Schuster709,Elicia233
4b110832-9a6e-4373-ab1d-e5d839eae6f3,Rolfson709,Elicia233
6d9f03ac-dc40-4e22-abd2-c1ad1fe55fde,Bradtke547,Jonnie215
6d9f03ac-dc40-4e22-abd2-c1ad1fe55fde,Cremin516,Jonnie215
a1382e5a-ab4e-4a05-8845-0d9945144b93,Rempel203,Sandie760
a1382e5a-ab4e-4a05-8845-0d9945144b93,Bailey598,Sandie760
eefd666e-cb9d-4c4c-80f3-bf08f0d0bb2c,Grimes165,Lanelle105
eefd666e-cb9d-4c4c-80f3-bf08f0d0bb2c,Bode78,Lanelle105
612216b5-3e8d-462a-b156-ad560224c107,Christiansen251,Keva141
612216b5-3e8d-462a-b156-ad560224c107,Stanton715,Keva141
ebe32feb-0749-45a6-9ae8-a90b84b93359,Dicki44,Olevia458
ebe32feb-0749-45a6-9ae8-a90b84b93359,Kemmer137,Olevia458
75585234-faf4-4fba-b107-903482e1e042,Trantow673,Tora746
75585234-faf4-4fba-b107-903482e1e042,Schneider199,Tora746
98f0996a-2321-4705-9dcf-da12ddbab7f0,Runolfsdottir785,Dacia646
98f0996a-2321-4705-9dcf-da12ddbab7f0,Rohan584,Dacia646
0e3b2866-b890-4d56-81c4-38f24019b311,Aufderhar910,May125
0e3b2866-b890-4d56-81c4-38f24019b311,Schmeler639,May125
bf62270a-3b19-4035-ba99-99314885de5c,Haag279,Cornelia505
bf62270a-3b19-4035-ba99-99314885de5c,Ernser583,Cornelia505
9b259b7a-d3f6-4ea6-b4e2-3a25f5c1000f,Paucek755,Becki838
9b259b7a-d3f6-4ea6-b4e2-3a25f5c1000f,Labadie908,Becki838
e09557f9-6d52-4f5b-922c-7cfe41654ad6,O'Reilly797,Junie167
e09557f9-6d52-4f5b-922c-7cfe41654ad6,Walker122,Junie167
138c6e78-c68f-4abd-998b-bbeec2aabe90,Kassulke119,Kera17
138c6e78-c68f-4abd-998b-bbeec2aabe90,Becker968,Kera17
8aadf318-f511-4d4e-80a4-9e25650b733c,Schumm995,Abbie917
8aadf318-f511-4d4e-80a4-9e25650b733c,Carroll471,Abbie917
91973365-4f7f-4a3b-bdbf-e2ca20c00680,Kunze215,Velma961
91973365-4f7f-4a3b-bdbf-e2ca20c00680,Leannon79,Velma961
1699b106-0123-4bc7-a327-eb3cbbb5d5f6,Batz141,Lourdes258
1699b106-0123-4bc7-a327-eb3cbbb5d5f6,Kuvalis369,Lourdes258
53948541-0bd8-4390-a8ff-70741ad41956,Roob72,Jerlene697
53948541-0bd8-4390-a8ff-70741ad41956,Hudson301,Jerlene697
a45223c5-e0b4-4b68-9f98-d460b9c53b45,Hegmann834,Joanne343
a45223c5-e0b4-4b68-9f98-d460b9c53b45,Glover433,Joanne343
14b533f9-5f25-4371-9b31-393f147492cf,Parker433,Jeannie478
14b533f9-5f25-4371-9b31-393f147492cf,Upton904,Jeannie478
0882bcdc-9f73-4036-b334-5e56d5242769,Balistreri607,Dorathy429
0882bcdc-9f73-4036-b334-5e56d5242769,Mante251,Dorathy429
327e547f-33f4-486c-8ba9-ed4f55819c16,Prohaska837,Sharita792
327e547f-33f4-486c-8ba9-ed4f55819c16,Fritsch593,Sharita792
6ab6e369-51c6-4b06-953a-1ac562420c0c,Bailey598,Nanci249
6ab6e369-51c6-4b06-953a-1ac562420c0c,Heaney114,Nanci249
156d7a1d-e48f-40f3-9ff2-e01f06941d7b,Weissnat378,Ozie87
156d7a1d-e48f-40f3-9ff2-e01f06941d7b,Williamson769,Ozie87
abeb2157-0661-4db5-bc5b-0e3f6ea6ad3a,Schuppe920,Claudette391
abeb2157-0661-4db5-bc5b-0e3f6ea6ad3a,Frami345,Claudette391
9595dbfc-eb84-44d3-91f8-bac9984c6aad,Kovacek682,Flavia315
9595dbfc-eb84-44d3-91f8-bac9984c6aad,Muller251,Flavia315
2936b0f4-8007-49a9-95fb-d914d6da7eaf,Steuber698,Sondra191
2936b0f4-8007-49a9-95fb-d914d6da7eaf,Batz141,Sondra191
6bc61296-cf64-4c1c-b3e8-e69d911e4174,Reynolds644,Delorse592
6bc61296-cf64-4c1c-b3e8-e69d911e4174,Farrell962,Delorse592
4f431df5-b2c6-4a1a-b7be-44f501de7027,McCullough561,Theressa101
4f431df5-b2c6-4a1a-b7be-44f501de7027,Torp761,Theressa101
5c891356-1585-4d31-bc69-2bd8e7f51279,Stamm704,Willia886
5c891356-1585-4d31-bc69-2bd8e7f51279,Reichel38,Willia886
10619919-cb9d-4759-ab09-126132d39322,Langosh790,Rosamaria757
10619919-cb9d-4759-ab09-126132d39322,Hand679,Rosamaria757
3b2797b4-06cc-44e9-911a-a2709963c1d9,O'Connell601,Adrien235
3b2797b4-06cc-44e9-911a-a2709963c1d9,Considine820,Adrien235
db6b5e30-a89f-4fb7-ab4a-ed4ac2166d8b,Herman763,Lynna524
db6b5e30-a89f-4fb7-ab4a-ed4ac2166d8b,Bechtelar572,Lynna524
bc567489-ee83-4514-acdd-18cfd16869aa,Kilback373,Eleanor470
bc567489-ee83-4514-acdd-18cfd16869aa,Cummings51,Eleanor470
a434065f-3f54-496e-85e0-97b64a862c66,Leffler128,Carlyn477
a434065f-3f54-496e-85e0-97b64a862c66,Pouros728,Carlyn477
18d917a8-4c89-4b7f-9cde-ea4c8d5dbebc,Mraz590,Mendy939
18d917a8-4c89-4b7f-9cde-ea4c8d5dbebc,Dibbert990,Mendy939
b6cf7d30-424b-4c71-9abc-e16cd3790895,Dooley940,Charisse42
b6cf7d30-424b-4c71-9abc-e16cd3790895,Runte676,Charisse42
d28218d5-b57a-4341-9573-060a49fab5b1,Connelly992,Cyndy549
d28218d5-b57a-4341-9573-060a49fab5b1,Ward668,Cyndy549
3fe6e303-c6c1-4c07-af4a-f5aa12d53dfb,Rowe323,Chastity705
3fe6e303-c6c1-4c07-af4a-f5aa12d53dfb,O'Connell601,Chastity705
444bb7e2-fd21-4bd1-a563-12ab05246454,McCullough561,Gaynelle249
444bb7e2-fd21-4bd1-a563-12ab05246454,Jaskolski867,Gaynelle249
bc5d5d12-43b5-4a72-a52

2025-02-11 17:36:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:36:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:36:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:36:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-11 17:36:32 - snowflake.connector.connection - INFO - closed
2025-02-11 17:36:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:36:32 - root - INFO - SQL:
SELECT DISTINCT "status"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
    LIMIT 100;
Results:
status
active
stopped

2025-02-11 17:36:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:36:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:36:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:36:34 - snowflake.connector.connection - INFO - closed
2025-02-11 17:36:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:37:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:37:03 - root - INFO - ```sql
SELECT p."id" AS "patient_id",
       n.value:"family"::STRING AS "last_name",
       c."code"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
  ON c."subject"::STRING = CONCAT('Patient/', p."id")
CROSS JOIN LATERAL FLATTEN(input => p."name") n
WHERE (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
GROUP BY p."id", n.value:"family"::STRING, c."code"
HAVING COUNT(DISTINCT c."id") = 1
LIMIT 100;
```
2025-02-11 17:37:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:37:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:37:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:37:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 17:37:05 - snowflake.connector.connection - INFO - closed
2025-02-11 17:37:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:37:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:37:40 - root - INFO - ```sql
SELECT p."id" AS "patient_id",
       n.value:"family"::STRING AS "last_name",
       c."code"::VARIANT:"coding"[0]:"code"::STRING AS "condition_code"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
     LATERAL FLATTEN(input => p."name") n,
     "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
WHERE c."subject"::VARIANT:"patientId"::STRING = p."id"
LIMIT 100;
```
2025-02-11 17:37:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:37:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:37:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:37:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:37:41 - snowflake.connector.connection - INFO - closed
2025-02-11 17:37:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:38:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:38:09 - root - INFO - SQL:
SELECT p."id" AS "patient_id",
       n.value:"family"::STRING AS "last_name",
       c."code"::VARIANT:"coding"[0]:"code"::STRING AS "condition_code"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
     LATERAL FLATTEN(input => p."name") n,
     "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
WHERE c."subject"::VARIANT:"patientId"::STRING = p."id"
LIMIT 100;
Results:
Too long, hard cut:
patient_id,last_name,condition_code
41906489-9613-426a-99dc-0f1d150a51ea,Nader710,444814009
db025c5b-6e59-4279-a0a2-5cb7586ad2b6,Schmeler639,444814009
db025c5b-6e59-4279-a0a2-5cb7586ad2b6,Renner328,444814009
729ad6f5-c2c0-472d-b1e9-84b2f9cc3c12,Shields502,444814009
68b69b9f-c9d9-473b-9f58-f0439cadb249,Cummings51,444814009
b6f80926-23d8-423f-9a7f-8bfe4d1374a8,Haley279,444814009
b6f80926-23d8-423f-9a7f-8bfe4d1374a8,Yundt842,444814009
0e54459d-1fc1-4a0e-b6ae-80c64cfcd8be,Jacobson885,444814009
74695d93-c8a8-4676-91b0-d5414a299678,Frami345,444814009
74695d93-c8a8-4676-91b0-d5414a299678,Kemmer137,444814009
682c1f5e-dfc7-4811-ad98-3d76a2b80ec4,Anderson154,444814009
32f22c90-7992-4e21-912b-70cecccbda88,Ruecker817,444814009
32f22c90-7992-4e21-912b-70cecccbda88,Gusikowski974,444814009
41a3eb67-dcfe-465d-aa79-f0f541eff537,McGlynn426,444814009
209cb05b-6f6f-4289-81bc-2ab0da20b7bc,Wilkinson796,444814009
6ccbd722-a06f-4efc-8c51-c62f8e4788cf,Turner526,444814009
eb9e33b5-578d-4f20-89a0-13fd0c44d1e4,Greenfelder433,444814009
ca9814bd-3fb2-48dd-8b60-84baf310ea39,Stroman228,444814009
2ab9c5bb-c1c8-4550-8f1b-60770d116260,Flatley871,444814009
e9b5c9c2-902a-4f0a-a3cb-a4202858350f,Weber641,444814009
13a6db00-b31c-409c-927f-62217fed875e,Ledner144,444814009
13a6db00-b31c-409c-927f-62217fed875e,Schumm995,444814009
5d41110c-13f7-49ff-b7d2-357690515c1c,Reilly981,444814009
edf7b96b-71fa-412b-a865-18b57b6b70d7,Emmerich580,444814009
edf7b96b-71fa-412b-a865-18b57b6b70d7,Kirlin939,444814009
be2503ab-b586-41f5-a9c5-20eca825996c,Langosh790,444814009
3741b2cd-9a05-4d48-adbd-beaa68e4ca51,Sipes176,444814009
94faee47-8d49-499f-b4db-f2a120fe7234,Schneider199,444814009
0ab3dae8-a36e-423b-bbae-bb864f5248b4,Leannon79,444814009
0ab3dae8-a36e-423b-bbae-bb864f5248b4,Farrell962,444814009
aef9470c-a3a1-451c-b139-de1a7320cf6b,Grady603,444814009
201f0444-2348-45cd-a609-54d570cae9d4,Gallardo890,444814009
201f0444-2348-45cd-a609-54d570cae9d4,Urrutia540,444814009
3a4f26f7-3fff-415f-aebb-41085c65e235,Lubowitz58,444814009
71a6a5fc-b048-4e27-841c-21b7e1a5880d,O'Keefe54,444814009
50ca0fa8-8c85-4d32-9d52-eb5820e6222f,McDermott739,444814009
635d35f9-2402-4ade-b809-d9896de50f10,Weimann465,444814009
f5f9182b-4420-4127-8be9-1f73b34e1205,Keebler762,444814009
327a6c79-f5f5-459a-9162-92e4eedde32d,Lueilwitz711,444814009
8021a33a-ee8b-489a-8239-a6316a1a69e1,Schamberger479,444814009
e458f72f-ffb8-4057-a836-fd78918c396b,Toy286,444814009
d132eb7f-056e-426e-a9a0-7d4f42969ab2,Rice937,444814009
f8d26a5c-c102-4984-abed-73614f3b5c6d,Kilback373,444814009
302a7c6e-e664-4f62-8cd2-0a1a5d314306,Graham902,444814009
302a7c6e-e664-4f62-8cd2-0a1a5d314306,Mohr916,444814009
28808aee-3609-410a-acb1-0eaf80693180,Ortiz186,444814009
d2c21c57-1565-4e81-9d69-19408cb83d0c,Schiller186,444814009
d2c21c57-1565-4e81-9d69-19408cb83d0c,Hirthe744,444814009
a5be08e6-aeb2-4f64-b71d-8ca157203f71,Botsford977,444814009
dc98e60d-0ea5-437f-a513-a9f74e714c7c,Orn563,444814009
dc98e60d-0ea5-437f-a513-a9f74e714c7c,Abbott774,444814009
0848f444-6534-47f1-951e-5b02111e228a,Pollich983,444814009
aa1932e8-5d65-42ba-9b27-1bb5bca02a64,Bogisich202,444814009
aa1932e8-5d65-42ba-9b27-1bb5bca02a64,Brown30,444814009
b90697da-f329-4cfe-8275-ed077f8a3a54,Beatty507,444814009
d51c2331-bcee-442e-8512-a6179ec0d653,Gorczany269,444814009
c987146b-fc4e-44ac-ac95-351af70d647c,Barrows492,444814009
c987146b-fc4e-44ac-ac95-351af70d647c,O'Kon634,444814009
ca3f9823-b738-4ac6-86be-7c7c88eb6189,Dicki44,444814009
ca3f9823-b738-4ac6-86be-7c7c88eb6189,Buckridge80,444814009
92a2a973-3a48-467f-9254-1dd966ba5f2a,Stokes453,444814009
61ceed7b-02b7-4ba3-bbb5-074eafc5e40a,Spinka232,444814009
61ceed7b-02b7-4ba3-bbb5-074eafc5e40a,Auer97,444814009
97539bff-4eb6-46a1-b5e3-6bbb1a4b4a55,Little434,444814009
97539bff-4eb6-46a1-b5e3-6bbb1a4b4a55,Berge125,444814009
ec52396d-02a6-40aa-9ff4-dbf311d80c19,Champlin946,444814009
ec52396d-02a6-40aa-9ff4-dbf311d80c19,O'Hara248,444814009
fd157c30-7f8d-449b-a051-2d77d1873968,Lowe577,444814009
ec2e0ed4-c93d-470c-8d88-d840323ece1c,Zemlak964,444814009
c68f98e4-bb23-4a97-bd95-4fa69a3f57dc,DuBuque211,444814009
ef0dad7e-53a9-476e-9e3d-d7986ad6a993,Wintheiser220,444814009
cfe95ac8-3d04-4488-8841-a3a2b42c82a9,Sep칰lveda884,444814009
cfe95ac8-3d04-4488-8841-a3a2b42c82a9,Zayas20,444814009
c27dde79-eb9d-4288-bcaf-46b4c79b2258,Vega377,444814009
c72356c3-aaed-492d-af86-4994a5029da2,Koepp521,444814009
24d5cf99-b537-4cb0-a2ab-d7b8c54489a5,Krajcik437,444814009
11b2dc58-f51c-40b9-a5ba-1c3a92e1d020,Bernier607,444814009
57ecd316-0171-425e-8d54-5e09723d9b60,Bayer639,444814009
de975818-1615-4908-a50f-973eb5cd1f1f,Casper496,444814009
fb87ea32-6f8f-4209-b590-5d2f6b57e89b,Kohler843,444814009
0e1bba74-742a-491d-a3af-e092196c024c,Dickens475,444814009
3801cd58-9614-44e6-99ac-6fc646194825,Kirlin939,444814009
3801cd58-9614-44e6-99ac-6fc646194825,Flatley871,444814009
b67db99a-7af7-46cc-b609-d0181f38288d,Hintz995,444814009
b67db99a-7af7-46cc-b609-d0181f38288d,Cruickshank494,444814009
a8a2e8af-6e3a-40b9-b5b0-f1c675fb6b8c,Stracke611,444814009
161b544e-cc5d-435

2025-02-11 17:38:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:38:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:38:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:38:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 17:38:10 - snowflake.connector.connection - INFO - closed
2025-02-11 17:38:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:38:11 - root - INFO - SQL:
SELECT MAX(med_count) AS "max_active_medications"
    FROM (
      SELECT m."subject", COUNT(DISTINCT m."medication") AS med_count
      FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      WHERE m."status" = 'active'
      GROUP BY m."subject"
    )
    LIMIT 100;
Results:
max_active_medications
20

2025-02-11 17:38:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:38:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:38:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:38:12 - snowflake.connector.connection - INFO - closed
2025-02-11 17:38:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:38:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:38:29 - root - INFO - ```sql
SELECT p."id" AS "patient_id", 
       n.value:"family"::STRING AS "last_name",
       m."medication"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
CROSS JOIN LATERAL FLATTEN(input => p."name") n
JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
  ON m."subject"::VARIANT:"patientId"::STRING = p."id"
WHERE n.value:"family"::STRING ILIKE 'A%'
LIMIT 100;
```
2025-02-11 17:38:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:38:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:38:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:38:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:38:34 - snowflake.connector.connection - INFO - closed
2025-02-11 17:38:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:38:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:38:48 - root - INFO - SQL:
SELECT p."id" AS "patient_id", 
       n.value:"family"::STRING AS "last_name",
       m."medication"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
CROSS JOIN LATERAL FLATTEN(input => p."name") n
JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
  ON m."subject"::VARIANT:"patientId"::STRING = p."id"
WHERE n.value:"family"::STRING ILIKE 'A%'
LIMIT 100;
Results:
Too long, hard cut:
patient_id,last_name,medication
877e2465-bab0-4aba-a02f-72642ae47312,Abshire638,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
12776b91-a037-4597-8c7b-d3a1bfbcc4e2,Altenwerth646,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
6954156b-4288-4617-b342-7156965c0d7d,Armstrong51,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
1563e62e-43e7-4f3d-b2c3-b008eff560d5,Abernathy524,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
11c0527f-a6cb-47f9-90ee-fde42964bfd7,Abernathy524,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
9a606691-340b-4838-afca-6f70b40e97de,Altenwerth646,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
f4edabdc-5503-4b4a-b390-e88d06a753f6,Almanza534,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
d28dd4e3-ae32-4306-9d24-ca87566c7365,Abbott774,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
31d434fa-0d99-453e-a024-2ba3b5dfc06f,Arce139,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
2a1a47ec-f71e-45f8-bba7-d0bae0c426c7,Anderson154,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
9622d4a7-4550-4fdd-8ef8-f00e845282c4,Adams676,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
e26e5e84-1623-4311-9dcd-157a716a981b,Adams676,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
d17b42ba-a410-4511-a74b-a2179486d64a,Almaraz628,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
f98d5542-13e1-44f4-9a53-f572d7183f2b,Acu침a179,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
f74ddb9e-c201-4c60-b58d-854632e8b39b,Ankunding277,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
c70467af-fe35-4de2-8b8c-c390c3fe38e5,Abernathy524,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
29a53d88-3391-4173-9d34-1a82f286ea92,Adams676,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",


2025-02-11 17:38:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:38:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:38:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:38:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 17:38:49 - snowflake.connector.connection - INFO - closed
2025-02-11 17:38:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:38:49 - root - INFO - SQL:
SELECT c."id", c."code"::VARIANT
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    LIMIT 100;
Results:
Too long, hard cut:
id,"C.""CODE""::VARIANT"
372b7d2e-ecb2-4fe6-a572-2e1955e493d1,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
9b9e7457-d096-4766-ad30-9975ad8352db,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
36f814a7-8da2-4163-a9e1-573dbacf971e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
b2d7987a-eb81-431c-80b9-8e1cce4f47e5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
d58ed937-24af-45f2-88fe-3faafeddfa1a,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
011ebdc7-4a1b-45c0-a155-aaaff81d7e0b,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
82e3ab6f-49cd-481b-88fc-cae52cdb729e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
825db10a-a2bb-4a95-9f80-2b15c3d83b40,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
37a130aa-b37e-4986-afa6-1d98aaf50eaa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
cb3dfebd-5a5e-4273-bc32-3fe5c43e0ecd,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
ab561037-815d-4182-ae51-526a8c4f85a4,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
7597a472-3ebe-4bc2-b179-7236514e98aa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
fc1079d1-11fb-43c4-8718-127e91fb2426,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
992edc1d-0bd1-4444-97cf-179d0085e4c6,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
62dabd0d-baac-43e5-9e65-d6473025522c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
3afa9aea-e686-4b4a-b2f0-2641fd45633c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
c5385f1f-16fd-425e-9f64-fc77401b0dd5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": "

2025-02-11 17:38:49 - root - INFO - itercount: 0
2025-02-11 17:38:49 - root - INFO - Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,0
table_name,BASIC
description,
DDL,"create or replace TABLE BASIC (
	""author"" VARIANT,
	""created"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""subject"" VARIANT,
	""text"" VARIANT,
	""code"" VARIANT,
	""id"" VARCHAR(16777216),
	""meta"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,1
table_name,DIAGNOSTIC_REPORT
description,
DDL,"create or replace TABLE DIAGNOSTIC_REPORT (
	""basedOn"" VARIANT,
	""category"" VARIANT,
	""codedDiagnosis"" VARIANT,
	""conclusion"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""image"" VARIANT,
	""imagingStudy"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""meta"" VARIANT,
	""performer"" VARIANT,
	""presentedForm"" VARIANT,
	""specimen"" VARIANT,
	""text"" VARIANT,
	""code"" VARIANT,
	""context"" VARIANT,
	""effective"" VARIANT,
	""id"" VARCHAR(16777216),
	""issued"" NUMBER(38,0),
	""result"" VARIANT,
	""status"" VARCHAR(16777216),
	""subject"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,2
table_name,EXPLANATION_OF_BENEFIT
description,
DDL,"create or replace TABLE EXPLANATION_OF_BENEFIT (
	""accident"" VARIANT,
	""addItem"" VARIANT,
	""benefitBalance"" VARIANT,
	""claimResponse"" VARIANT,
	""disposition"" VARCHAR(16777216),
	""employmentImpacted"" VARIANT,
	""enterer"" VARIANT,
	""facility"" VARIANT,
	""form"" VARIANT,
	""hospitalization"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""information"" VARIANT,
	""insurer"" VARIANT,
	""language"" VARCHAR(16777216),
	""originalPrescription"" VARIANT,
	""outcome"" VARIANT,
	""payee"" VARIANT,
	""precedence"" NUMBER(38,0),
	""prescription"" VARIANT,
	""procedure"" VARIANT,
	""processNote"" VARIANT,
	""related"" VARIANT,
	""subType"" VARIANT,
	""text"" VARIANT,
	""totalBenefit"" VARIANT,
	""unallocDeductable"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_mdcr_non_pmt_rsn_cd_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pass_thru_per_diem_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pps_cptl_dsprprtnt_shr_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pps_cptl_excptn_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pps_cptl_fsp_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pps_cptl_ime_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pps_cptl_outlier_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_pps_old_cptl_hld_hrmls_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_clm_tot_pps_cptl_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_dsh_op_clm_val_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_fi_num_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_ime_op_clm_val_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_bene_blood_ddctbl_lblty_am_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_bene_ip_ddctbl_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_bene_pta_coinsrnc_lblty_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_drg_outlier_aprvd_pmt_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_ip_ncvrd_chrg_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_ip_tot_ddctn_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_nch_profnl_cmpnt_chrg_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_inpatient_prpayamt_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_clm_mdcr_non_pmt_rsn_cd_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_clm_op_bene_pmt_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_clm_op_prvdr_pmt_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_fi_num_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_nch_bene_blood_ddctbl_lblty_am_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_nch_bene_ptb_coinsrnc_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_nch_bene_ptb_ddctbl_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_nch_profnl_cmpnt_chrg_amt_extension"" VARIANT,
	""StructureDefinition_bluebutton_outpatient_prpayamt_extension"" VARIANT,
	""billablePeriod"" VARIANT,
	""careTeam"" VARIANT,
	""claim"" VARIANT,
	""created"" VARCHAR(16777216),
	""diagnosis"" VARIANT,
	""id"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""insurance"" VARIANT,
	""item"" VARIANT,
	""meta"" VARIANT,
	""organization"" VARIANT,
	""patient"" VARIANT,
	""payment"" VARIANT,
	""provider"" VARIANT,
	""referral"" VARIANT,
	""status"" VARCHAR(16777216),
	""totalCost"" VARIANT,
	""type"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,3
table_name,ORGANIZATION
description,
DDL,"create or replace TABLE ORGANIZATION (
	""active"" BOOLEAN,
	""alias"" VARIANT,
	""endpoint"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""partOf"" VARIANT,
	""text"" VARIANT,
	""address"" VARIANT,
	""contact"" VARIANT,
	""id"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""meta"" VARIANT,
	""name"" VARCHAR(16777216),
	""telecom"" VARIANT,
	""type"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,4
table_name,PATIENT
description,
DDL,"create or replace TABLE PATIENT (
	""active"" BOOLEAN,
	""animal"" VARIANT,
	""contact"" VARIANT,
	""generalPractitioner"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""link"" VARIANT,
	""managingOrganization"" VARIANT,
	""photo"" VARIANT,
	""birthPlace"" VARIANT,
	""disability_adjusted_life_years"" VARIANT,
	""patient_mothersMaidenName"" VARIANT,
	""quality_adjusted_life_years"" VARIANT,
	""shr_actor_FictionalPerson_extension"" VARIANT,
	""shr_demographics_SocialSecurityNumber_extension"" VARIANT,
	""shr_entity_FathersName_extension"" VARIANT,
	""shr_entity_Person_extension"" VARIANT,
	""us_core_birthsex"" VARIANT,
	""us_core_ethnicity"" VARIANT,
	""us_core_race"" VARIANT,
	""address"" VARIANT,
	""birthDate"" VARCHAR(16777216),
	""communication"" VARIANT,
	""deceased"" VARIANT,
	""gender"" VARCHAR(16777216),
	""id"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""maritalStatus"" VARIANT,
	""meta"" VARIANT,
	""multipleBirth"" VARIANT,
	""name"" VARIANT,
	""telecom"" VARIANT,
	""text"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,5
table_name,PROCEDURE
description,
DDL,"create or replace TABLE PROCEDURE (
	""basedOn"" VARIANT,
	""bodySite"" VARIANT,
	""category"" VARIANT,
	""complication"" VARIANT,
	""complicationDetail"" VARIANT,
	""definition"" VARIANT,
	""focalDevice"" VARIANT,
	""followUp"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""location"" VARIANT,
	""notDone"" BOOLEAN,
	""notDoneReason"" VARIANT,
	""note"" VARIANT,
	""outcome"" VARIANT,
	""partOf"" VARIANT,
	""performer"" VARIANT,
	""reasonCode"" VARIANT,
	""report"" VARIANT,
	""text"" VARIANT,
	""usedCode"" VARIANT,
	""usedReference"" VARIANT,
	""shr_action_PerformedContext_extension"" VARIANT,
	""code"" VARIANT,
	""context"" VARIANT,
	""id"" VARCHAR(16777216),
	""meta"" VARIANT,
	""performed"" VARIANT,
	""reasonReference"" VARIANT,
	""status"" VARCHAR(16777216),
	""subject"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,6
table_name,IMMUNIZATION
description,
DDL,"create or replace TABLE IMMUNIZATION (
	""doseQuantity"" VARIANT,
	""expirationDate"" VARCHAR(16777216),
	""explanation"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""location"" VARIANT,
	""lotNumber"" VARCHAR(16777216),
	""manufacturer"" VARIANT,
	""note"" VARIANT,
	""practitioner"" VARIANT,
	""reaction"" VARIANT,
	""reportOrigin"" VARIANT,
	""route"" VARIANT,
	""site"" VARIANT,
	""text"" VARIANT,
	""vaccinationProtocol"" VARIANT,
	""shr_action_PerformedContext_extension"" VARIANT,
	""date"" VARCHAR(16777216),
	""encounter"" VARIANT,
	""id"" VARCHAR(16777216),
	""meta"" VARIANT,
	""notGiven"" BOOLEAN,
	""patient"" VARIANT,
	""primarySource"" BOOLEAN,
	""status"" VARCHAR(16777216),
	""vaccineCode"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,7
table_name,ENCOUNTER
description,
DDL,"create or replace TABLE ENCOUNTER (
	""account"" VARIANT,
	""appointment"" VARIANT,
	""classHistory"" VARIANT,
	""diagnosis"" VARIANT,
	""episodeOfCare"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""incomingReferral"" VARIANT,
	""language"" VARCHAR(16777216),
	""length"" VARIANT,
	""location"" VARIANT,
	""partOf"" VARIANT,
	""priority"" VARIANT,
	""statusHistory"" VARIANT,
	""text"" VARIANT,
	""shr_action_PerformedContext_extension"" VARIANT,
	""class"" VARIANT,
	""hospitalization"" VARIANT,
	""id"" VARCHAR(16777216),
	""meta"" VARIANT,
	""participant"" VARIANT,
	""period"" VARIANT,
	""reason"" VARIANT,
	""serviceProvider"" VARIANT,
	""status"" VARCHAR(16777216),
	""subject"" VARIANT,
	""type"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,8
table_name,GOAL
description,
DDL,"create or replace TABLE GOAL (
	""addresses"" VARIANT,
	""category"" VARIANT,
	""expressedBy"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""meta"" VARIANT,
	""note"" VARIANT,
	""outcomeCode"" VARIANT,
	""outcomeReference"" VARIANT,
	""priority"" VARIANT,
	""start"" VARIANT,
	""statusDate"" VARCHAR(16777216),
	""statusReason"" VARCHAR(16777216),
	""subject"" VARIANT,
	""target"" VARIANT,
	""text"" VARIANT,
	""description"" VARIANT,
	""id"" VARCHAR(16777216),
	""status"" VARCHAR(16777216)
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,9
table_name,IMAGING_STUDY
description,
DDL,"create or replace TABLE IMAGING_STUDY (
	""accession"" VARIANT,
	""availability"" VARCHAR(16777216),
	""basedOn"" VARIANT,
	""description"" VARCHAR(16777216),
	""endpoint"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""interpreter"" VARIANT,
	""language"" VARCHAR(16777216),
	""meta"" VARIANT,
	""modalityList"" VARIANT,
	""procedureCode"" VARIANT,
	""procedureReference"" VARIANT,
	""reason"" VARIANT,
	""referrer"" VARIANT,
	""text"" VARIANT,
	""context"" VARIANT,
	""id"" VARCHAR(16777216),
	""numberOfInstances"" NUMBER(38,0),
	""numberOfSeries"" NUMBER(38,0),
	""patient"" VARIANT,
	""series"" VARIANT,
	""started"" VARCHAR(16777216),
	""uid"" VARCHAR(16777216)
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,10
table_name,ALLERGY_INTOLERANCE
description,
DDL,"create or replace TABLE ALLERGY_INTOLERANCE (
	""asserter"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""lastOccurrence"" VARCHAR(16777216),
	""note"" VARIANT,
	""onset"" VARIANT,
	""reaction"" VARIANT,
	""recorder"" VARIANT,
	""text"" VARIANT,
	""assertedDate"" VARCHAR(16777216),
	""category"" VARIANT,
	""clinicalStatus"" VARCHAR(16777216),
	""code"" VARIANT,
	""criticality"" VARCHAR(16777216),
	""id"" VARCHAR(16777216),
	""meta"" VARIANT,
	""patient"" VARIANT,
	""type"" VARCHAR(16777216),
	""verificationStatus"" VARCHAR(16777216)
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,11
table_name,CARE_PLAN
description,
DDL,"create or replace TABLE CARE_PLAN (
	""author"" VARIANT,
	""basedOn"" VARIANT,
	""careTeam"" VARIANT,
	""definition"" VARIANT,
	""description"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""meta"" VARIANT,
	""note"" VARIANT,
	""partOf"" VARIANT,
	""replaces"" VARIANT,
	""supportingInfo"" VARIANT,
	""text"" VARIANT,
	""title"" VARCHAR(16777216),
	""activity"" VARIANT,
	""addresses"" VARIANT,
	""category"" VARIANT,
	""context"" VARIANT,
	""goal"" VARIANT,
	""id"" VARCHAR(16777216),
	""intent"" VARCHAR(16777216),
	""period"" VARIANT,
	""status"" VARCHAR(16777216),
	""subject"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,12
table_name,CONDITION
description,
DDL,"create or replace TABLE CONDITION (
	""asserter"" VARIANT,
	""bodySite"" VARIANT,
	""evidence"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""note"" VARIANT,
	""severity"" VARIANT,
	""stage"" VARIANT,
	""text"" VARIANT,
	""abatement"" VARIANT,
	""assertedDate"" VARCHAR(16777216),
	""category"" VARIANT,
	""clinicalStatus"" VARCHAR(16777216),
	""code"" VARIANT,
	""context"" VARIANT,
	""id"" VARCHAR(16777216),
	""meta"" VARIANT,
	""onset"" VARIANT,
	""subject"" VARIANT,
	""verificationStatus"" VARCHAR(16777216)
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,13
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""basedOn"" VARIANT,
	""bodySite"" VARIANT,
	""comment"" VARCHAR(16777216),
	""dataAbsentReason"" VARIANT,
	""device"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""interpretation"" VARIANT,
	""language"" VARCHAR(16777216),
	""method"" VARIANT,
	""performer"" VARIANT,
	""referenceRange"" VARIANT,
	""related"" VARIANT,
	""specimen"" VARIANT,
	""text"" VARIANT,
	""category"" VARIANT,
	""code"" VARIANT,
	""component"" VARIANT,
	""context"" VARIANT,
	""effective"" VARIANT,
	""id"" VARCHAR(16777216),
	""issued"" NUMBER(38,0),
	""meta"" VARIANT,
	""status"" VARCHAR(16777216),
	""subject"" VARIANT,
	""value"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,14
table_name,CLAIM
description,
DDL,"create or replace TABLE CLAIM (
	""accident"" VARIANT,
	""careTeam"" VARIANT,
	""created"" VARCHAR(16777216),
	""employmentImpacted"" VARIANT,
	""enterer"" VARIANT,
	""facility"" VARIANT,
	""fundsReserve"" VARIANT,
	""hospitalization"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""insurance"" VARIANT,
	""insurer"" VARIANT,
	""language"" VARCHAR(16777216),
	""meta"" VARIANT,
	""originalPrescription"" VARIANT,
	""payee"" VARIANT,
	""priority"" VARIANT,
	""provider"" VARIANT,
	""referral"" VARIANT,
	""related"" VARIANT,
	""subType"" VARIANT,
	""text"" VARIANT,
	""type"" VARIANT,
	""billablePeriod"" VARIANT,
	""diagnosis"" VARIANT,
	""id"" VARCHAR(16777216),
	""information"" VARIANT,
	""item"" VARIANT,
	""organization"" VARIANT,
	""patient"" VARIANT,
	""prescription"" VARIANT,
	""procedure"" VARIANT,
	""status"" VARCHAR(16777216),
	""total"" VARIANT,
	""use"" VARCHAR(16777216)
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,15
table_name,MEDICATION_REQUEST
description,
DDL,"create or replace TABLE MEDICATION_REQUEST (
	""basedOn"" VARIANT,
	""category"" VARIANT,
	""definition"" VARIANT,
	""detectedIssue"" VARIANT,
	""dispenseRequest"" VARIANT,
	""eventHistory"" VARIANT,
	""groupIdentifier"" VARIANT,
	""identifier"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""note"" VARIANT,
	""priorPrescription"" VARIANT,
	""priority"" VARCHAR(16777216),
	""reasonCode"" VARIANT,
	""recorder"" VARIANT,
	""substitution"" VARIANT,
	""supportingInformation"" VARIANT,
	""text"" VARIANT,
	""shr_action_RequestedContext_extension"" VARIANT,
	""shr_base_ActionCode_extension"" VARIANT,
	""authoredOn"" VARCHAR(16777216),
	""context"" VARIANT,
	""dosageInstruction"" VARIANT,
	""id"" VARCHAR(16777216),
	""intent"" VARCHAR(16777216),
	""medication"" VARIANT,
	""meta"" VARIANT,
	""reasonReference"" VARIANT,
	""requester"" VARIANT,
	""status"" VARCHAR(16777216),
	""subject"" VARIANT
);"

Database Name: FHIR_SYNTHEA
Schema Name: FHIR_SYNTHEA
,16
table_name,PRACTITIONER
description,
DDL,"create or replace TABLE PRACTITIONER (
	""birthDate"" VARCHAR(16777216),
	""communication"" VARIANT,
	""implicitRules"" VARCHAR(16777216),
	""language"" VARCHAR(16777216),
	""meta"" VARIANT,
	""photo"" VARIANT,
	""qualification"" VARIANT,
	""telecom"" VARIANT,
	""text"" VARIANT,
	""active"" BOOLEAN,
	""address"" VARIANT,
	""gender"" VARCHAR(16777216),
	""id"" VARCHAR(16777216),
	""identifier"" VARIANT,
	""name"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'FHIR_SYNTHEA': {'FHIR_SYNTHEA': ['BASIC', 'DIAGNOSTIC_REPORT', 'EXPLANATION_OF_BENEFIT', 'ORGANIZATION', 'PATIENT', 'PROCEDURE', 'IMMUNIZATION', 'ENCOUNTER', 'GOAL', 'IMAGING_STUDY', 'ALLERGY_INTOLERANCE', 'CARE_PLAN', 'CONDITION', 'OBSERVATION', 'CLAIM', 'MEDICATION_REQUEST', 'PRACTITIONER']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **`PATIENT` Table**

   - **`"id"`**: Patient identifier used to join with other tables.
   - **`"name"`** (`VARIANT`): Contains patient names; used to extract last names and check if they begin with "A".
   - **`"deceased"`** (`VARIANT`): Indicates if the patient is deceased; used to filter for living patients.

2. **`CONDITION` Table**

   - **`"id"`**: Condition identifier.
   - **`"subject"`** (`VARIANT`): Reference to the patient; used to join with the `PATIENT` table.
   - **`"code"`** (`VARIANT`): Contains condition codes; used to identify conditions associated with patients.

3. **`MEDICATION_REQUEST` Table**

   - **`"id"`**: Medication request identifier.
   - **`"subject"`** (`VARIANT`): Reference to the patient; used to join with the `PATIENT` table.
   - **`"status"`**: Indicates the status of the medication request; used to filter active medications.
   - **`"medication"`** (`VARIANT`): Contains details about the prescribed medication.

**Conditions That May Be Used:**

- Patients whose last names begin with "A".
- Patients who are alive (i.e., `"deceased"` field is `NULL` or indicates living).
- Patients who have exactly one distinct condition.
- Medications that are active (i.e., `"status"` is `'active'`).

---

**SQL Queries:**

1. **Retrieve patient IDs and names to inspect the structure of the `"name"` column:**

   ```sql
   SELECT "id", "name"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT"
   LIMIT 100;
   ```

2. **Extract last names from the `"name"` column using `LATERAL FLATTEN` and check if they begin with "A":**

   ```sql
   SELECT p."id", n.value:"family"::STRING AS "last_name"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
   LATERAL FLATTEN(input => p."name") n
   WHERE n.value:"family"::STRING ILIKE 'A%'
   LIMIT 100;
   ```

3. **Identify living patients by checking the `"deceased"` field:**

   ```sql
   SELECT "id", "deceased"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT"
   WHERE "deceased" IS NULL OR "deceased"::STRING = 'false'
   LIMIT 100;
   ```

4. **Count the number of conditions per patient to find patients with exactly one condition:**

   ```sql
   SELECT c."subject", COUNT(DISTINCT c."id") AS "condition_count"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
   GROUP BY c."subject"
   HAVING COUNT(DISTINCT c."id") = 1
   LIMIT 100;
   ```

5. **List active medications prescribed to patients by checking the `"status"` field:**

   ```sql
   SELECT "id", "subject", "status"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
   WHERE "status" = 'active'
   LIMIT 100;
   ```

6. **Extract condition codes from the `"code"` column in the `CONDITION` table:**

   ```sql
   SELECT c."id", c."code"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
   LIMIT 100;
   ```

7. **Join `PATIENT` and `CONDITION` tables to link patients with their conditions:**

   ```sql
   SELECT p."id" AS "patient_id", c."id" AS "condition_id", c."code"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
   JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
     ON c."subject"::STRING = CONCAT('Patient/', p."id")
   LIMIT 100;
   ```

8. **Inspect the `"medication"` column in the `MEDICATION_REQUEST` table:**

   ```sql
   SELECT "id", "subject", "medication"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
   LIMIT 100;
   ```

9. **Extract medication codes from the `"medication"` column:**

   ```sql
   SELECT m."id", m."medication"::VARIANT:"coding"[0]:"code"::STRING AS "medication_code"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
   LIMIT 100;
   ```

10. **Find the number of different active medications prescribed to each patient:**

    ```sql
    SELECT m."subject", COUNT(DISTINCT m."medication") AS "active_medication_count"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"
    LIMIT 100;
    ```

11. **Combine `PATIENT`, `CONDITION`, and `MEDICATION_REQUEST` to explore relationships between patients, their conditions, and medications:**

    ```sql
    SELECT p."id" AS "patient_id", c."code", m."medication", m."status"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
      ON c."subject"::STRING = CONCAT('Patient/', p."id")
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      ON m."subject"::STRING = CONCAT('Patient/', p."id")
    WHERE m."status" = 'active'
    LIMIT 100;
    ```

12. **List patients whose last names begin with "A" and are alive:**

    ```sql
    SELECT p."id", n.value:"family"::STRING AS "last_name"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    WHERE (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
      AND n.value:"family"::STRING ILIKE 'A%'
    LIMIT 100;
    ```

13. **Identify patients with exactly one condition and extract their condition codes:**

    ```sql
    SELECT c."subject", c."code"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject", c."code"
    HAVING COUNT(DISTINCT c."id") = 1
    LIMIT 100;
    ```

14. **Count the number of active medications per condition code:**

    ```sql
    SELECT c."code", COUNT(DISTINCT m."medication") AS "active_medication_count"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      ON m."subject" = c."subject"
    WHERE m."status" = 'active'
    GROUP BY c."code"
    LIMIT 100;
    ```

15. **Extract the `"family"` (last name) and `"given"` (first name) from the `"name"` column for all patients:**

    ```sql
    SELECT p."id",
           n.value:"family"::STRING AS "last_name",
           n.value:"given"[0]::STRING AS "first_name"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    LIMIT 100;
    ```

16. **Check the structure of the `"status"` field in the `MEDICATION_REQUEST` table:**

    ```sql
    SELECT DISTINCT "status"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
    LIMIT 100;
    ```

17. **List conditions along with the patients' last names for patients with exactly one condition:**

    ```sql
    SELECT p."id" AS "patient_id",
           n.value:"family"::STRING AS "last_name",
           c."code"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
      ON c."subject"::STRING = CONCAT('Patient/', p."id")
    JOIN LATERAL FLATTEN(input => p."name") n
    ON TRUE
    WHERE (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
    GROUP BY p."id", n.value:"family"::STRING, c."code"
    HAVING COUNT(DISTINCT c."id") = 1
    LIMIT 100;
    ```

18. **Find the maximum number of active medications prescribed to any single patient:**

    ```sql
    SELECT MAX(med_count) AS "max_active_medications"
    FROM (
      SELECT m."subject", COUNT(DISTINCT m."medication") AS med_count
      FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      WHERE m."status" = 'active'
      GROUP BY m."subject"
    )
    LIMIT 100;
    ```

19. **List the medications prescribed to patients whose last names begin with "A":**

    ```sql
    SELECT p."id" AS "patient_id", n.value:"family"::STRING AS "last_name", m."medication"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      ON m."subject"::STRING = CONCAT('Patient/', p."id")
    JOIN LATERAL FLATTEN(input => p."name") n
    ON TRUE
    WHERE n.value:"family"::STRING ILIKE 'A%'
    LIMIT 100;
    ```

20. **Inspect the `"code"` field in the `CONDITION` table to understand its structure (nested JSON):**

    ```sql
    SELECT c."id", c."code"::VARIANT
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    LIMIT 100;
    ```

---

These queries are designed to explore the relevant tables and columns to gain an understanding of how to extract and manipulate the data needed for the task. They help in examining the data structure, relationships between tables, and handling of `VARIANT` (JSON) columns in Snowflake SQL.

**Note:** Ensure that all queries are tested and adjusted as needed based on the actual data and schema in your database. The `VARIANT` columns may contain nested JSON structures that require specific parsing using JSON path expressions.Query:
SELECT "id", "name"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT"
   LIMIT 100;
Answer:
Too long, hard cut:
id,name
b972d9cb-9a11-4a49-893b-327c58185d83,"[
  {
    ""family"": ""Auer97"",
    ""given"": [
      ""Candyce305""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
c9865d08-da7e-4cf8-afb8-8802da4324e9,"[
  {
    ""family"": ""Perales854"",
    ""given"": [
      ""Jorge Luis88""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
1f7198cd-8f12-42fc-b7a8-92e5a0c4dd78,"[
  {
    ""family"": ""Vel치zquez409"",
    ""given"": [
      ""Antonia30""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
c18c9677-c194-4931-a1ec-b9f499c15dc6,"[
  {
    ""family"": ""Hern치dez343"",
    ""given"": [
      ""Eva64""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
2c981886-3710-4c7e-9d26-c56589276913,"[
  {
    ""family"": ""Cordero852"",
    ""given"": [
      ""Sergio619""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
fb90cddc-b4d9-41c7-88b2-472c16f078ea,"[
  {
    ""family"": ""Feest103"",
    ""given"": [
      ""Marianna323""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
bed95537-1f15-4265-a456-7cacc56e4331,"[
  {
    ""family"": ""Corrales691"",
    ""given"": [
      ""Elsa29""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
360fc2be-e006-40b2-a598-fe49a14e26e1,"[
  {
    ""family"": ""Lynch190"",
    ""given"": [
      ""Jodee687""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
9fdaa2bb-859d-46d3-ad40-278d86edc84f,"[
  {
    ""family"": ""Ceja441"",
    ""given"": [
      ""Daniela614""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
e2ff66bc-4ec4-4b27-b5ad-ac01ce63e255,"[
  {
    ""family"": ""Metz686"",
    ""given"": [
      ""Will178""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
51910199-f8c0-4b5d-9909-e27e3473be20,"[
  {
    ""family"": ""Stoltenberg489"",
    ""given"": [
      ""Shandra823""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
77fb5380-ed88-4e20-bbb4-f941701be4e3,"[
  {
    ""family"": ""Murphy561"",
    ""given"": [
      ""Noriko180""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
29b899ac-ede1-4881-90c1-ae48c7de332d,"[
  {
    ""family"": ""Prieto999"",
    ""given"": [
      ""Francisca486""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
4c73f559-6a58-4c60-b64b-03b2eba4692f,"[
  {
    ""family"": ""Montenegro24"",
    ""given"": [
      ""Patricia625""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
8d2d512e-ce6b-4c0f-94a4-540738371130,"[
  {
    ""family"": ""Hettinger594"",
    ""given"": [
      ""Alverta45""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
919d42cb-c051-45ec-a140-afad25350408,"[
  {
    ""family"": ""Quintero729"",
    ""given"": [
      ""Gonzalo160""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
0c25d541-42b9-4266-87e5-017f9546abcd,"[
  {
    ""family"": ""Vargas494"",
    ""given"": [
      ""Ignacio928""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
454b8161-86a9-498e-b574-b2b4406c0633,"[
  {
    ""family"": ""Garrido242"",
    ""given"": [
      ""Anita473""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
31349fec-85da-4420-a574-2baaeb51a796,"[
  {
    ""family"": ""Rodriguez71"",
    ""given"": [
      ""Isabelle619""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
845e737f-8f48-4e35-985d-37d54328bdae,"[
  {
    ""family"": ""Effertz744"",
    ""given"": [
      ""Merlin721""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
dfe4960b-cf5d-4d17-8f50-1ab1ee181b0c,"[
  {
    ""family"": ""Qui침칩nez764"",
    ""given"": [
      ""Amalia471""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
e31e9d0f-8bfb-4af4-b7be-3c71fd4d5586,"[
  {
    ""family"": ""Peres371"",
    ""given"": [
      ""Graciela518""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
790638ba-037a-4db4-8641-c1f7328dae3c,"[
  {
    ""family"": ""Cornejo190"",
    ""given"": [
      ""Laura391""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
48930f02-42fc-47a4-bd45-2a1165e1d7e6,"[
  {
    ""family"": ""Zavala169"",
    ""given"": [
      ""Juan88""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
6cb8f426-43be-4a84-8e40-c9ca3cf8ddd4,"[
  {
    ""family"": ""Adams676"",
    ""given"": [
      ""Lorette239""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use"": ""official""
  }
]"
e8022243-19d9-4d8f-a0ac-2595baf27a09,"[
  {
    ""family"": ""Granados71"",
    ""given"": [
      ""Antonio44""
    ],
    ""prefix"": [],
    ""suffix"": [],
    ""use
Query:
SELECT p."id", n.value:"family"::STRING AS "last_name"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
   LATERAL FLATTEN(input => p."name") n
   WHERE n.value:"family"::STRING ILIKE 'A%'
   LIMIT 100;
Answer:
id,last_name
e5c26e5d-f948-452b-9028-4fc32c9dc43c,Auer97
8d5a8da0-b955-4309-af79-bdc06e325c61,Aufderhar910
48ccd623-17c4-40c5-b57a-34011920dd01,Aufderhar910
2e74a426-05d7-46fd-b285-e1334131b46b,Altenwerth646
b44b4f2a-d835-487d-b360-180dce80c600,Armstrong51
7e2e504a-de10-436c-92d3-ff4a1848b956,Abernathy524
3e16b87a-f0d1-4546-bc49-a8b4e2d8470e,Anderson154
730cd58c-8a99-4e24-88ea-7b945a10892b,Adams676
cf235044-9d32-4d04-8f79-f7515b9f6609,Anderson154
fec31a34-56d5-4620-b329-f4f1863ff3fe,Abbott774
20649d37-036c-4586-8862-6c321f8a9124,Auer97
50196de2-2405-4822-9d52-d2f714d440ba,Auer97
c7b2cbf8-c61f-4c41-bf1e-5c26400a04e8,Anderson154
de7699da-4642-4a79-b5cc-c10b1f026ad4,Abernathy524
ff599ea0-92a8-4677-b5b7-fbc754900294,Abernathy524
ef341f55-59c8-423d-8633-554dfcaf0f42,Abshire638
41c67c66-7735-49fd-90a1-6b6e099cdf8f,Abshire638
c5a97fb1-66c1-4a75-b06d-58ac84a091c0,Aufderhar910
088dcc38-7964-460b-8835-6a9280a2bfc4,Aufderhar910
6673c464-9f78-4875-8597-98cd0af67811,Adams676
8a582d86-9480-437e-b9d5-69c1cf85b5bd,Altenwerth646
03d17814-f535-4563-9cdd-e4aa296c5ffa,Anderson154
7ba91fef-50bd-4d35-8893-ef9f6915d082,Abernathy524
bc0d5fe9-f04f-4412-a45c-52bbe5f180ea,Armstrong51
16984bfc-6254-46bf-a76b-f9ebae232a9a,Altenwerth646
d77ceece-5af4-4ed3-9005-d9c9906e081b,Abernathy524
4b3ca3ec-8c42-4037-bfb3-c4ed340d0524,Adams676
ec2fab6f-763a-4492-8292-c94f697a9480,Altenwerth646
0adc0086-8e77-43ea-ab6d-c64591b66508,Ankunding277
15607b50-2e55-4532-a3dc-6e62285ba28c,Altenwerth646
796d1d2c-f011-4044-a2ed-80ca087d28f2,Ankunding277
b83497b9-9b7d-486c-9aeb-40ae98ef038d,Abshire638
ffbd8d6d-f3e1-4d39-a829-3a8dec7cf423,Ankunding277
b20579c8-c7e9-4893-a5ae-758b0a30202d,Aufderhar910
c4427a19-b270-4a68-8030-9e1d9a0a88d6,Ankunding277
0e3b2866-b890-4d56-81c4-38f24019b311,Aufderhar910
69faf3e9-3f96-489c-a7c4-d321779c6945,Auer97
55c5a3c9-1258-4d59-b818-7daacd10432e,Abbott774
afe15de8-5783-496c-9c45-8a930a822a24,Aufderhar910
7a216826-59aa-4300-889f-8d2db86f1214,Abbott774
25507e9b-cb58-4a57-8727-38859c1a2ade,Abernathy524
0765d7b3-06f9-48f2-876b-057a4500251a,Aufderhar910
449b14f4-dee6-48cf-948d-2207d3d71143,Abbott774
0c4caeb4-3834-4a13-9564-f851a7f74076,Armstrong51
2d7e0069-9655-4104-9280-84a065716aa5,Abshire638
df9d46ba-5580-4b7d-bc6c-27c69a800969,Abshire638
e8d1a000-ff3d-45c4-8bf2-309d476fe555,Auer97
ce445bac-bef5-4f20-9089-1e57edd28a19,Aufderhar910
27ebe4a9-9e59-4f6b-958b-1daf1d2ab051,Armstrong51
dcca3aca-95ed-45ae-a86a-e4e6d113d780,Altenwerth646
84d41795-af4f-405c-a208-a3427b44a38c,Anderson154
bdf01e04-d958-4f9a-b07b-c325ebe3b074,Ankunding277
aa46f615-89fb-4e9d-b4f7-2ce1e4eacf1b,Abbott774
6c2a1eea-2797-4ba9-a67e-ed61dd9c460e,Abshire638
ebf64f69-8cd6-4090-9418-e0ba122e5700,Adams676
1641dc83-2b5e-49fd-8852-e0d1572092ad,Anderson154
70e68f26-d642-4105-b82a-1257a0d10848,Ankunding277
8c373ed3-716d-4c86-bf5e-a050f4de09d7,Abernathy524
fc000d11-aad4-4afc-93b5-e0353e0b3287,Armstrong51
728f1242-263c-434e-9a2a-d6fa319e0628,Abshire638
f4a80dd3-5146-40ee-9ac9-a6ae62d9cfe8,Adams676
5c664454-b26e-40b4-a113-2e4e4d21d1da,Altenwerth646
fd480c9c-8b8a-46de-803a-b1603c00b671,Adams676
1e741807-21d1-451d-9cc5-6473955d3fb7,Aufderhar910
92495ce3-2931-4fb7-a319-a47710ffea2c,Abshire638
f9ead748-9551-493f-a680-7170099ff04b,Aufderhar910
338ce980-c43b-4502-afc3-15746a05c1f2,Auer97
4dd34bce-1f98-4466-83b0-d94c05985239,Abshire638
a9a351c8-2548-4aee-acac-7187c194cb62,Anderson154
6438e914-a3d3-4afd-b2f7-ef36cc8f80d3,Ankunding277
b646928b-df03-4f37-93e4-d9288f75f98d,Ankunding277
6dd31b62-c47f-49e1-8dc4-cd1a5ee0bb40,Auer97
7876cf97-fc11-42f7-bc1d-a9a9f4c81476,Abernathy524
ff91decc-9783-4488-bcad-20dd94a24f7c,Adams676
7dfbcd44-1262-49f6-8010-8efb105cfc77,Auer97
65547c01-0a6c-4233-ad24-f4c7a63bd864,Ankunding277
4493c653-1c67-463a-856e-2d0b0aaabf85,Abernathy524
2c9161f4-0904-43b9-bacf-8fd1c99ccc9c,Auer97
6397f464-8957-45c2-a7cf-7d52b9dc4624,Abernathy524
4e075e89-128f-40f5-9772-9fcb451308eb,Abernathy524
e6692abc-7f0b-4c04-a1fa-5bb4157a83aa,Altenwerth646
9fecda40-1dbf-43cb-9e6d-4f5920254814,Auer97
d156e626-31fa-411d-986c-13ffcb49d5b9,Altenwerth646
006c1aaa-2708-4959-b1bb-d62c1b7cf670,Anderson154
5961bcfc-65b5-4ab0-9a5b-459d1e98efb9,Auer97
02a55af4-37a4-48ff-b18b-30308f2e0226,Ankunding277
6c77cb04-9d6d-4de6-a39c-a67d1fe3ba4c,Armstrong51
6c77cb04-9d6d-4de6-a39c-a67d1fe3ba4c,Abshire638
3725c157-8e34-4fae-9307-75f4c950c619,Altenwerth646
0443daaf-a911-4492-9d05-b1971fcb2428,Ankunding277
119973c2-f99c-47e8-836e-f2cc6d31db43,Adams676
3ca3d8be-3c1c-4e5f-ad5a-a05024369f1a,Aufderhar910
a5e7b2b2-58a2-4aa4-be96-998acc29aa7f,Auer97
fb52fe3d-45b2-425b-9962-64c3cab2b41d,Abshire638
2a790bd0-b45f-4108-a0ba-d11178b50194,Anderson154
9c772a71-0d55-4bc5-88e4-0d8a7cd632b1,Aufderhar910
9c6be5ae-95a5-4d1f-a839-140508909f13,Abernathy524
384c1b16-9c60-470f-9404-45cc7e429340,Abshire638
4bc76a72-ba8f-434e-ba05-8f33783e2939,Anderson154
2c2c1ce3-8aab-408f-b4aa-119a9657e197,Adams676
Query:
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
),
patients_with_lastname_A AS (
    SELECT DISTINCT patient_id
    FROM patient_names
    WHERE last_name ILIKE 'A%'
),
patient_conditions AS (
    SELECT c."subject"::STRING AS subject_ref,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
patients_with_one_condition AS (
    SELECT subject_ref, condition_code, COUNT(*) AS condition_count
    FROM patient_conditions
    GROUP BY subject_ref, condition_code
    HAVING COUNT(*) = 1
),
active_medications_per_patient AS (
    SELECT m."subject"::STRING AS subject_ref,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::STRING
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patients_with_lastname_A p
    JOIN patients_with_one_condition c
        ON c.subject_ref = CONCAT('Patient/', p.patient_id)
    JOIN active_medications_per_patient a
        ON a.subject_ref = CONCAT('Patient/', p.patient_id)
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Answer:
No data found for the specified query.
Query:
SELECT c."subject", COUNT(DISTINCT c."id") AS "condition_count"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
   GROUP BY c."subject"
   HAVING COUNT(DISTINCT c."id") = 1
   LIMIT 100;
Answer:
Too long, hard cut:
subject,condition_count
"{
  ""patientId"": ""5ced7587-5155-4e8b-93d1-b0036a5c7aa1""
}",1
"{
  ""patientId"": ""3ba34735-dcc3-4082-bda2-d3d3c78fd7fb""
}",1
"{
  ""patientId"": ""76ccc6b5-afc7-4b73-9fb4-c58f96573e68""
}",1
"{
  ""patientId"": ""8917db9c-ae32-4f30-b484-5319ea624b3c""
}",1
"{
  ""patientId"": ""d91b5204-3706-4c58-abf6-799cecf4c78d""
}",1
"{
  ""patientId"": ""652dbda2-0740-428e-85d2-aff162be2dd6""
}",1
"{
  ""patientId"": ""504f98f4-cef9-43fd-85c2-20c2112029b6""
}",1
"{
  ""patientId"": ""0ea9fdb5-7cb7-4c1a-9e5a-32fac8bf2bf6""
}",1
"{
  ""patientId"": ""18b418e4-b465-4fce-95c2-9a29d9da7341""
}",1
"{
  ""patientId"": ""d99bfb55-7c0f-4ed6-b46a-846daa17d698""
}",1
"{
  ""patientId"": ""cfec8c51-ad8c-45f6-b8f5-fef59185fb7a""
}",1
"{
  ""patientId"": ""1bf8a526-92c4-427e-9534-ec0ae718ba17""
}",1
"{
  ""patientId"": ""22ac5fe1-1099-490f-b13a-2841f93bb6da""
}",1
"{
  ""patientId"": ""05311d13-27e7-423f-8fee-80a6bdcdcbbc""
}",1
"{
  ""patientId"": ""ae866336-87a2-4618-8e7f-475989859d06""
}",1
"{
  ""patientId"": ""feeb4216-40b7-4f33-999d-fdc5b0244ec2""
}",1
"{
  ""patientId"": ""e39cc651-28d6-4b56-b405-f27ae4ed8073""
}",1
"{
  ""patientId"": ""819bbb95-972a-40f4-9617-83325d96882c""
}",1
"{
  ""patientId"": ""fa155a89-9b94-4d50-9764-64bf20aaa384""
}",1
"{
  ""patientId"": ""00ffb1aa-4688-4116-afc4-f070ac2949c7""
}",1
"{
  ""patientId"": ""dd644501-60c1-4e90-a7f2-d5453c28dd4b""
}",1
"{
  ""patientId"": ""4a06a8d0-1327-4bb3-b9e3-0945a02a651e""
}",1
"{
  ""patientId"": ""f74da7ad-78e5-4e3d-9018-b7c4e5eda1a3""
}",1
"{
  ""patientId"": ""701f0b36-dc60-4518-a27e-1c0752c53c34""
}",1
"{
  ""patientId"": ""9676ae8f-d14e-4635-9921-20f162815cd9""
}",1
"{
  ""patientId"": ""56c771c9-2f2b-473f-b70c-507f1892ad32""
}",1
"{
  ""patientId"": ""a4d4f0f1-2a86-43f4-b61f-a7586b9e51de""
}",1
"{
  ""patientId"": ""059ffba9-b89f-4845-bd4c-132130f6bf6b""
}",1
"{
  ""patientId"": ""423999c9-da3f-4e85-88a2-c459d4c75d93""
}",1
"{
  ""patientId"": ""b9f23934-ec33-441c-bba8-b78a1051dad6""
}",1
"{
  ""patientId"": ""a1c2c0fb-fe69-4914-923d-e537216fef43""
}",1
"{
  ""patientId"": ""94b60cff-0783-4f20-bc81-d6ccbd09099c""
}",1
"{
  ""patientId"": ""bc04b77b-3af7-4484-82c7-6e86a0ab943c""
}",1
"{
  ""patientId"": ""55efcf76-99ab-4ff4-9ab9-ecd5e9540f97""
}",1
"{
  ""patientId"": ""f0d5018f-9701-4906-ad07-14288d3cc20b""
}",1
"{
  ""patientId"": ""80390857-07ee-4a4d-bc67-94555b14c248""
}",1
"{
  ""patientId"": ""70de0a51-e759-4975-85e2-29d2286c50cf""
}",1
"{
  ""patientId"": ""817722a2-5df1-41dd-b809-3876eaf06bd0""
}",1
"{
  ""patientId"": ""87acf546-bf38-451a-bef7-903f16759911""
}",1
"{
  ""patientId"": ""11fb371a-fb1e-46f5-8284-9a8477953ff9""
}",1
"{
  ""patientId"": ""84701621-3f15-4223-bb75-80cf1b6b4560""
}",1
"{
  ""patientId"": ""772bf732-7686-4972-9822-e26701161bb3""
}",1
"{
  ""patientId"": ""243492e4-1f70-42a6-9ab4-904e2c8edb9a""
}",1
"{
  ""patientId"": ""30188d31-b3a4-43d9-8520-86520830a724""
}",1
"{
  ""patientId"": ""da6c3a25-153d-4bf9-9f35-992b68399fc7""
}",1
"{
  ""patientId"": ""788755af-8ea0-4b27-a418-f9b02b80c18e""
}",1
"{
  ""patientId"": ""440a5d56-fd8b-4c43-88b7-b8ba671a51bc""
}",1
"{
  ""patientId"": ""79891b9d-266a-4f3a-8dd6-f77591a8a6e6""
}",1
"{
  ""patientId"": ""633ee23e-9173-4a8e-9ec0-1efaaebfee95""
}",1
"{
  ""patientId"": ""fbacea96-4fa6-4e62-aa41-09608ca8c78f""
}",1
"{
  ""patientId"": ""4d3d55c6-c6af-4114-a3e1-50cee3e86870""
}",1
"{
  ""patientId"": ""130ee5d0-6c06-40c3-bf87-a3f8278dcfbe""
}",1
"{
  ""patientId"": ""ff8b32ae-968f-481a-92ad-a86862904eb8""
}",1
"{
  ""patientId"": ""ac8c7b1c-87ce-4436-83bf-dd74f303e188""
}",1
"{
  ""patientId"": ""f36b02ed-0a49-4898-a7e7-718d1c61da63""
}",1
"{
  ""patientId"": ""58b28627-e096-4d59-954c-f962e3b0ecb3""
}",1
"{
  ""patientId"": ""0d6b2edc-7955-4216-bbb9-9e9733a9a803""
}",1
"{
  ""patientId"": ""0c8eb16d-4253-4352-bc46-2d4d9d4555a4""
}",1
"{
  ""patientId"": ""e8d611a0-4a76-4548-89ef-93eeaba96cdf""
}",1
"{
  ""patientId"": ""c8a63f51-d6a2-480f-9efa-e1dffc7cd871""
}",1
"{
  ""patientId"": ""d221ac7c-0deb-4e51-b535-6cffffa547b1""
}",1
"{
  ""patientId"": ""fe35f7a4-bc0c-42ff-bfe9-29bbcc8576f5""
}",1
"{
  ""patientId"": ""86c759d5-905f-469a-b5c7-867b7583d08f""
}",1
"{
  ""patientId"": ""e06387b0-dc0f-462a-bb60-4e338f3f37d2""
}",1
"{
  ""patientId"": ""f6afa81b-dad9-4309-8691-00a373f16021""
}",1
"{
  ""patientId"": ""dff5d640-de15-44a8-854e-42ee99268f30""
}",1
"{
  ""patientId"": ""7344a8fb-4800-4b17-9667-391b5987a988""
}",1
"{
  ""patientId"": ""2e2b9e2d-ab08-48bd-896f-6e36841d17aa""
}",1
"{
  ""patientId"": ""536f503f-fb95-4d67-8a52-2d32417b9824""
}",1
"{
  ""patientId"": ""dcea158a-33ea-48d5-baf9-1507240d113a""
}",1
"{
  ""patientId"": ""76acbb94-9b8a-4035-be9f-7991b9b69360""
}",1
"{
  ""patientId"": ""d613ce2d-2487-4443-9962-6857e1bb9f66""
}",1
"{
  ""patientId"": ""41b986cf-dbe0-4ca1-9cf9-9da43b0b05eb""
}",1
"{
  ""patientId"": ""820914fa-a14f-49e8-a950-74f9d382916a""
}",1
"{
  ""patientId"": ""3cc7d63d-c85c-4c83-a370-590c301bb096""
}",1
"{
  ""patientId"": ""19a4
Query:
SELECT "id", "subject", "status"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
   WHERE "status" = 'active'
   LIMIT 100;
Answer:
Too long, hard cut:
id,subject,status
4995669d-b05c-4727-96ec-8b9231df8c1d,"{
  ""patientId"": ""1a89bde4-e47b-4462-b81c-baabfd57f7c4""
}",active
49704eeb-df76-4f89-b604-8d0a9b565ccb,"{
  ""patientId"": ""d8376f0e-192f-4dab-9a82-5cdb19dc4c0e""
}",active
e08d7ea9-d0f1-409b-b7ac-43dc672ced03,"{
  ""patientId"": ""6d73860b-cbca-4c58-b526-f009c2d7b27b""
}",active
f3ae86f3-afee-406f-ba36-ad60e1b4e294,"{
  ""patientId"": ""85497af4-0359-40f7-89bf-5276d2184e2a""
}",active
e1b705bd-6cdd-40d2-95eb-bc8dfc63ed17,"{
  ""patientId"": ""eb96aae7-1108-4a85-af22-850f885e31b4""
}",active
e1a4f2a0-b842-476b-a701-dd3088bc10a4,"{
  ""patientId"": ""28867b4b-458d-4e50-ae72-eb2d8e806ca4""
}",active
7b9c3de1-a5e4-4b9f-8210-35ccd1aa7884,"{
  ""patientId"": ""2631347e-bf18-4308-8bac-45ca352c55bc""
}",active
6ab57460-f870-4971-8617-551c362cbc0a,"{
  ""patientId"": ""2902d496-fd1d-4297-9a14-540fd2917266""
}",active
6ac5f983-161b-415d-a1aa-5bc48a95c98d,"{
  ""patientId"": ""804227db-1797-4765-8972-da8d906564c1""
}",active
000b7799-cfa9-43d5-993f-90fc760dde1d,"{
  ""patientId"": ""9610b099-dae9-4f44-baee-59dadb3fb5ec""
}",active
6a3098a9-59cd-4c1b-ab87-352b03b253fb,"{
  ""patientId"": ""717db0b2-b5c8-4e19-a072-f14f48c4ce53""
}",active
0109b244-64bf-4dc7-9cfd-3e573dfb3269,"{
  ""patientId"": ""121e1731-8892-4f4d-8631-285fb737198e""
}",active
00e8632a-9ce8-4a09-8ddb-070dfb8886f9,"{
  ""patientId"": ""b9fc27bc-968a-4bea-b627-1da97148f1d0""
}",active
009aef71-5b53-4178-8c18-02919f624acb,"{
  ""patientId"": ""4dceb125-032e-408c-8b6a-866588f2eb60""
}",active
bd7aa392-ffb4-4578-b565-bc3e1ce4d846,"{
  ""patientId"": ""c1ab8f12-f6b0-4f03-aead-af5ccf7bd681""
}",active
bda37260-21ee-4295-b3b6-4b6322ccb9cb,"{
  ""patientId"": ""f2d88a62-2bc5-4ba8-8364-0508e47f339b""
}",active
bdd3c619-0963-4835-9504-d6fb5a11f534,"{
  ""patientId"": ""d1618723-5885-48d2-8cbb-32d8e37d9793""
}",active
15a7743d-fc52-49ea-8c07-f42b1880b5dd,"{
  ""patientId"": ""ffd43773-abd8-4a41-9617-790ff3c2093b""
}",active
fa9c537b-c2d5-492d-9855-9dc1b09ba427,"{
  ""patientId"": ""3899a4f1-0ebd-4691-9717-31abe97b3abe""
}",active
bcf96d25-e386-4b15-a254-c019253a0517,"{
  ""patientId"": ""94f7d3b8-ddbd-455e-a322-9ae71dc8218e""
}",active
bbf3c1a7-73a1-4a34-b257-6ca849ed44fd,"{
  ""patientId"": ""954d7d21-46a8-426f-814e-9d215e86715b""
}",active
bcdc972a-bbf7-4b32-b253-7bb96222fa0c,"{
  ""patientId"": ""9404ae08-fcde-47bb-b630-cff7ae52936d""
}",active
bafd14d5-6b11-4496-9059-57764d5952a5,"{
  ""patientId"": ""a4a80b0f-d377-4a89-b87b-1e0e09ed7b00""
}",active
bc4480ef-0f6b-4549-9855-2ebde729715e,"{
  ""patientId"": ""6c81731a-45eb-4351-8822-882f21226b76""
}",active
f59ef9d4-a956-42f8-9dd9-05b28200abd1,"{
  ""patientId"": ""abff57ba-6c48-481f-bf31-c17c100acfbb""
}",active
f607a9f2-55b3-4734-b81c-61545e1de09f,"{
  ""patientId"": ""44690417-ab7b-4d5c-8166-f2590f92a736""
}",active
bc1fc3d3-0437-4fb1-8400-43d87d891e65,"{
  ""patientId"": ""16250605-7939-45fb-b449-4849cda3f297""
}",active
a8e1e873-40a0-4b26-8e19-490c05251c74,"{
  ""patientId"": ""b5752f52-964d-4be2-b14a-344e0176441a""
}",active
23e8b52a-ff7d-4709-9114-3e574640cbdc,"{
  ""patientId"": ""96cae120-fef6-40ce-ba61-63809bf24f9d""
}",active
a727f272-e3db-4f5e-b2ff-a692d6ed4aee,"{
  ""patientId"": ""95275540-d0db-433d-bb23-b61c44d67088""
}",active
a7c6083e-3e06-4b62-ba1f-ba7df5037775,"{
  ""patientId"": ""4659ff9f-ae11-4341-8241-3b6edc572602""
}",active
4901a24b-2155-4e33-b740-2d74720334d1,"{
  ""patientId"": ""a17375c9-f5ef-4e04-aa1d-786a3e31e8bc""
}",active
a76dcc41-09be-4589-9a0b-505dd4a4801a,"{
  ""patientId"": ""873e6bfc-3ec7-4d8f-9f20-cac13ae38a75""
}",active
4843c94b-b461-41d4-b373-02fd09defc8b,"{
  ""patientId"": ""3d52edae-8a29-4266-a44d-176bfc980e04""
}",active
2447e008-732f-4116-9204-fbb3ac6eefb3,"{
  ""patientId"": ""4d5c0d55-8635-4874-aa33-fc62fd3d4c73""
}",active
fcb10a93-dfc2-4ffd-8120-3166e2529935,"{
  ""patientId"": ""a6bb4dcb-8bdf-4d74-a593-a596212052e1""
}",active
0f3486da-a517-4158-9b24-43f926d5e84f,"{
  ""patientId"": ""db0e9ec2-5e7e-41c0-8929-4567deb7856d""
}",active
1039d673-6146-4cb0-a4fa-ea45ce1b2f1a,"{
  ""patientId"": ""4f3161b0-bfae-4f57-8cfe-67b92f7e3459""
}",active
fbf6c23c-947e-4963-90b5-64666444d93d,"{
  ""patientId"": ""b75674ae-1310-465f-bbdb-269ee1bf3674""
}",active
bf9fa8b4-c53c-4c09-97c8-826532d31270,"{
  ""patientId"": ""c3e3462d-f87c-49e8-a6b5-ed41b79b9ad5""
}",active
fbf9676b-75ba-4146-bc98-5eba2c1c4ddb,"{
  ""patientId"": ""ce640217-c73e-41e5-b569-40f129026fbf""
}",active
1032acb2-4b52-4892-b418-0ef3c482e3f0,"{
  ""patientId"": ""1d692416-0bd9-431b-9fcb-bca3c25b6e43""
}",active
fb31f70d-8673-41b0-8141-9381996ec86c,"{
  ""patientId"": ""d6333072-9788-4c57-b3b3-e16173c97fa8""
}",active
0fc2acb9-f809-446e-afdf-ec9832ba0136,"{
  ""patientId"": ""d1979b52-12ef-4adf-8b9a-6858b4a5f806""
}",active
d863c96b-7f73-4364-a1b2-e6ef50056c58,"{
  ""patientId"": ""359ef90f-ba0d-40e7-a8a4-ed81e7a6fc13""
}",active
b9c265dd-0bc0-4838-b9d0-47e0af619374,"{
  ""patientId"": ""217a74b1-bf4c-40c0-9b5e-fc4ea0ac1be5""
}",active
ba15b3ae-6f4e-
Query:
SELECT c."id", c."code"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
   LIMIT 100;
Answer:
Too long, hard cut:
id,code
372b7d2e-ecb2-4fe6-a572-2e1955e493d1,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
9b9e7457-d096-4766-ad30-9975ad8352db,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
36f814a7-8da2-4163-a9e1-573dbacf971e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
b2d7987a-eb81-431c-80b9-8e1cce4f47e5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
d58ed937-24af-45f2-88fe-3faafeddfa1a,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
011ebdc7-4a1b-45c0-a155-aaaff81d7e0b,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
82e3ab6f-49cd-481b-88fc-cae52cdb729e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
825db10a-a2bb-4a95-9f80-2b15c3d83b40,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
37a130aa-b37e-4986-afa6-1d98aaf50eaa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
cb3dfebd-5a5e-4273-bc32-3fe5c43e0ecd,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
ab561037-815d-4182-ae51-526a8c4f85a4,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
7597a472-3ebe-4bc2-b179-7236514e98aa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
fc1079d1-11fb-43c4-8718-127e91fb2426,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
992edc1d-0bd1-4444-97cf-179d0085e4c6,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
62dabd0d-baac-43e5-9e65-d6473025522c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
3afa9aea-e686-4b4a-b2f0-2641fd45633c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
c5385f1f-16fd-425e-9f64-fc77401b0dd5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the 
Query:
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
),
patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication") AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_names p
    JOIN patient_conditions c ON c.patient_id = p.patient_id
    JOIN active_medications_per_patient a ON a.patient_id = p.patient_id
    WHERE p.last_name ILIKE 'A%'
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Answer:
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
302870006,17
126906006,17
49436004,17
15777000,17
422034002,17
230690007,17
239873007,17
53741008,17
Query:
SELECT "id", "subject", "medication"
   FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
   LIMIT 100;
Answer:
Too long, hard cut:
id,subject,medication
c2add253-c592-4d15-9d22-680b6407ef86,"{
  ""patientId"": ""6014b1f1-342f-4e93-80d8-1c6c31afd003""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
c43129cd-02d7-4ff7-9934-8988ded26178,"{
  ""patientId"": ""52c2ef3d-1ebb-4a71-bc22-1733f9c46b84""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
f3c85a1d-1fe8-4730-8343-0b0a1af9eac5,"{
  ""patientId"": ""cf3253b0-4d98-4d7b-92d3-17760dfe92b1""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
4c59b084-4c9c-42e0-89fa-f49c9a77660a,"{
  ""patientId"": ""bad4c7e4-e40a-4bf4-9da2-0e0f9ee47bfb""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
4073a9ce-c77d-4bf1-a82d-5d3e85190752,"{
  ""patientId"": ""2bca9741-8e35-4677-8e04-f4b657a405ef""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
97d5b846-a994-4b4e-8bf7-da23a62a0539,"{
  ""patientId"": ""d4ce9987-17a6-4a10-af77-988867ef9998""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
fde465fe-0810-4b39-ae64-5d8d3c36a66c,"{
  ""patientId"": ""1127929a-7985-4302-a206-847d5644d939""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
3e063cdc-ffac-4808-8db4-decdc8516647,"{
  ""patientId"": ""8f8263d1-55df-46fa-a0ca-44264b8de3d0""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
d382dc83-b4a0-4f32-9d1d-f7374d003f40,"{
  ""patientId"": ""39d10bf0-59bf-4c6a-96cf-4f361510d474""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
184d32ff-218a-4ac0-bb4f-354a7f92702e,"{
  ""patientId"": ""52e98828-0ea3-4656-a173-6cb8b2d0740f""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
0c5489d9-f868-4017-aa43-27c68f793549,"{
  ""patientId"": ""d6b60fe1-ee78-4218-81d0-9500a1b1712b""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
115546f4-82ee-452a-95c3-56615ccbb8ef,"{
  ""patientId"": ""e71757c4-bcfa-483c-835d-a461dad7525d""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""4337"",
        ""display"": ""Fentanyl"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Fentanyl""
  }
}"
6e826a5e-7e2e-4645-82d5-014a48ee2b01,"{
  ""patientId"": ""5a502bc3-10f4-4153-8d56-22581fbe3115""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""480"",
        ""display"": ""Alfentanil"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Alfentanil""
  }
}"
f381b355-6aee-4ddb-a4b3-2a827535167a,"{
  ""patientId"": ""9984a23a-40ac-4342-8720-7ec443b72431""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""480"",
        ""display"": ""Alfentanil"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Alfentanil""
  }
}"
e7f6bbd9-9db7-4d2b-9337-98eb9f11a2c5,"{
  ""patientId"": ""b439378f-cf4f-4c5f-8057-fc9220d14471""
}","{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""480"",
        ""display"": ""Alfentanil"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxno
Query:
WITH patient_names AS (
    SELECT p."id" AS patient_id,
           n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
),
patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT p.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_names p
    JOIN patient_conditions c ON c.patient_id = p.patient_id
    JOIN active_medications_per_patient a ON a.patient_id = p.patient_id
    WHERE p.last_name ILIKE 'A%'
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Answer:
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
49436004,17
239873007,17
302870006,17
90781000119102,17
53741008,17
92691004,17
88805009,17
422034002,17
Query:
SELECT m."subject", COUNT(DISTINCT m."medication") AS "active_medication_count"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"
    LIMIT 100;
Answer:
Too long, hard cut:
subject,active_medication_count
"{
  ""patientId"": ""2c5023d2-24db-473d-af86-0fd8c5248215""
}",5
"{
  ""patientId"": ""0b177698-ec33-4710-96eb-56ef57eb16ed""
}",1
"{
  ""patientId"": ""c435db10-8ce1-4130-83a1-bcea5e705470""
}",4
"{
  ""patientId"": ""ea8e21d6-1933-4623-a6e1-34c4d02fdfe2""
}",4
"{
  ""patientId"": ""9f4a1ae9-f6d6-462c-864d-82ace4bb88ea""
}",3
"{
  ""patientId"": ""d5734e1e-7b51-4724-9515-a0b6c3d2a2eb""
}",2
"{
  ""patientId"": ""ec3e8e6b-4697-4735-b776-f04f0ab0ae1b""
}",1
"{
  ""patientId"": ""ff967fb1-bcdb-4114-9398-8d9c4d031f64""
}",1
"{
  ""patientId"": ""db780e8c-44d6-4bb0-9d81-4f34ec90a2fd""
}",5
"{
  ""patientId"": ""ab7eb2a5-aefc-4abc-9d57-309a1a727b55""
}",3
"{
  ""patientId"": ""0af20a41-52da-46d8-8463-56290ed6559f""
}",1
"{
  ""patientId"": ""a83d53d1-3f8c-4dc3-878e-b7523d6996e3""
}",15
"{
  ""patientId"": ""ce9ff2f4-3ead-477e-9257-bd9cfb5315b3""
}",4
"{
  ""patientId"": ""56e7c71e-f950-44ac-9e16-6373d8dfa2e0""
}",6
"{
  ""patientId"": ""f2e66446-8e51-4ebd-83c9-1f15e0309f90""
}",1
"{
  ""patientId"": ""a3c3d2e2-0a6a-4faf-a6bd-b8b2d1a6fa2c""
}",4
"{
  ""patientId"": ""b2b60c79-2089-46be-982c-24aafb07c197""
}",9
"{
  ""patientId"": ""445d3c28-b9c0-42b4-b8e8-a585f001f6cb""
}",3
"{
  ""patientId"": ""563bbbeb-4442-4758-9cb1-1ef34ae1f135""
}",1
"{
  ""patientId"": ""3f293ebe-8883-41a6-a4f3-9fa200642964""
}",3
"{
  ""patientId"": ""d3fbe8c0-82a8-4ce0-a6ac-40932b41d5fe""
}",5
"{
  ""patientId"": ""46b40863-30df-459e-b4eb-94230918ab13""
}",6
"{
  ""patientId"": ""15df7913-9e64-4f88-9c52-5980dc001789""
}",1
"{
  ""patientId"": ""846a59e0-8243-44be-892a-bb6e37e3a645""
}",1
"{
  ""patientId"": ""d209ab43-13cd-4b66-a525-5b7789c8983f""
}",9
"{
  ""patientId"": ""b80d97d8-0906-423c-93d1-48f2ddd5f6d0""
}",6
"{
  ""patientId"": ""c1d99fe3-1d19-472f-ae2e-9fa128391dd6""
}",3
"{
  ""patientId"": ""aad74eb6-1f18-4b2c-8b67-efc591a08251""
}",5
"{
  ""patientId"": ""c81ed47b-d00c-4a68-81bb-4692d8fcaccc""
}",2
"{
  ""patientId"": ""22a42c5b-d3af-4f1f-9f99-14c33a8a75f7""
}",1
"{
  ""patientId"": ""34b9a6e6-584d-47c1-86e0-353b0eb10f94""
}",1
"{
  ""patientId"": ""4d1c89a6-1fe2-4950-8ada-547fa292b96c""
}",7
"{
  ""patientId"": ""94511beb-e82c-4651-9825-4758dc16b13f""
}",5
"{
  ""patientId"": ""417f3ad2-c155-466f-a884-bab06ae8ef03""
}",3
"{
  ""patientId"": ""16ce4b60-92be-4bfe-89c7-324e07984f54""
}",3
"{
  ""patientId"": ""bb7f1693-2884-4d94-b4c9-c76c18b4d65b""
}",1
"{
  ""patientId"": ""2787b6ce-826e-49a5-977d-8994caa9e387""
}",1
"{
  ""patientId"": ""892ed989-3509-46df-8606-da29f1b6fcc3""
}",1
"{
  ""patientId"": ""86ca67ef-6bb9-4933-84ca-69ea2b2bcdcb""
}",2
"{
  ""patientId"": ""51bcd86b-c47d-4897-8fd6-272f8ccd3908""
}",5
"{
  ""patientId"": ""dfef5f47-0108-423d-a1bf-087ad603a199""
}",2
"{
  ""patientId"": ""eb0de8d7-e668-4a8d-ba15-0518ab999792""
}",2
"{
  ""patientId"": ""8b8e8d28-c53b-4098-8eae-ae9dc55f85cc""
}",1
"{
  ""patientId"": ""4b43ff20-160a-4ebc-9909-a6694927c358""
}",4
"{
  ""patientId"": ""3df42085-7bed-4f58-ba3f-9740c760d0f8""
}",1
"{
  ""patientId"": ""a3fd1dec-75a1-41e1-9dda-4f7a6d3dd140""
}",8
"{
  ""patientId"": ""5a9e7f09-fc66-4d8c-853a-12f2f3a7d976""
}",4
"{
  ""patientId"": ""284b67ce-5fc5-4caf-80a9-a2fa2c3e5481""
}",13
"{
  ""patientId"": ""4ceaa4b6-4c7d-4a37-bda4-d60a8bee2d9f""
}",1
"{
  ""patientId"": ""6618110f-fe95-44c6-8dcd-9b9656a26c64""
}",3
"{
  ""patientId"": ""a0e0f317-c8ad-427a-83fa-16f8e0e732a8""
}",1
"{
  ""patientId"": ""ed1201a6-3f31-4d27-b9df-66dc0c559c30""
}",7
"{
  ""patientId"": ""3cc1f24d-8f63-4d9e-a630-e5e6279d53c7""
}",7
"{
  ""patientId"": ""95593208-25ce-4c21-b22f-efe099e6b340""
}",6
"{
  ""patientId"": ""8e52dcd1-3e09-401e-a500-b9f10887bc25""
}",4
"{
  ""patientId"": ""3f3980e9-56a8-4dd4-8902-c6aee4e6f812""
}",3
"{
  ""patientId"": ""eb26abfb-efee-4476-a4b7-cad9bbb5f159""
}",4
"{
  ""patientId"": ""dd56eae0-2361-45b9-85f3-e9ba8f5c0a4e""
}",5
"{
  ""patientId"": ""f17f8d5c-0959-45b0-9a7e-dc88d1f1e8c3""
}",1
"{
  ""patientId"": ""97af413f-39a2-4104-8a22-5e63ddd5433d""
}",10
"{
  ""patientId"": ""8395f086-0cd3-4f03-ba45-e92f852acf35""
}",4
"{
  ""patientId"": ""b4312256-0b11-41a6-a47e-21ed9e680dae""
}",5
"{
  ""patientId"": ""6efb9050-29b9-45eb-8aa4-725858a71a73""
}",1
"{
  ""patientId"": ""c1d7cc61-06e0-4fc7-8013-958be09ea19e""
}",9
"{
  ""patientId"": ""946c3106-6379-47b3-a4f3-72f9c4b3ed90""
}",4
"{
  ""patientId"": ""e8847c8f-7999-42ad-8e9f-9b602eab87a8""
}",4
"{
  ""patientId"": ""783a22e1-86f0-48d6-a941-d22879ceffb1""
}",4
"{
  ""patientId"": ""f22b295a-c4a3-4470-8924-06377f8aada6""
}",2
"{
  ""patientId"": ""e468f6f1-315d-4427-a059-73df1cb7bff5""
}",1
"{
  ""patientId"": ""bd31c5bf-5f3b-478e-b955-dd128cc0692b""
}",2
"{
  ""patientId"": ""40664b95-86c5-4c31-91c3-10bf71708ade""
}",2
"{
  ""patientId"": ""c6991dc6-65a4-41ee-a9d8-4deba91d8ebe""
}",3
"{
  ""patientId"": ""1c215dd7-7683-4a9a-b001-035de456eeb2""
}",7
"{
  ""patientId"": ""ea7b0001-20d2-4796-9092-1c947b2d13b4""
}",5
"{
  ""patientId"": ""181bdd58-2a13-403d-82da-7a8ffbee1a17""
}",3
"{
  ""patientI
Query:
WITH patient_conditions AS (
    SELECT c."subject"::VARIANT:"patientId"::STRING AS patient_id,
           c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
),
active_medications_per_patient AS (
    SELECT m."subject"::VARIANT:"patientId"::STRING AS patient_id,
           COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY patient_id
),
patient_conditions_medications AS (
    SELECT c.patient_id,
           c.condition_code,
           a.active_med_count
    FROM patient_conditions c
    JOIN active_medications_per_patient a ON a.patient_id = c.patient_id
)
SELECT pcm.condition_code,
       MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
Answer:
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
92691004,20
49436004,20
88805009,20
127013003,20
302870006,20
64859006,20
443165006,20
53741008,20
Query:
SELECT p."id", n.value:"family"::STRING AS "last_name"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    WHERE (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
      AND n.value:"family"::STRING ILIKE 'A%'
    LIMIT 100;
Answer:
id,last_name
70e68f26-d642-4105-b82a-1257a0d10848,Ankunding277
8c373ed3-716d-4c86-bf5e-a050f4de09d7,Abernathy524
fc000d11-aad4-4afc-93b5-e0353e0b3287,Armstrong51
f4a80dd3-5146-40ee-9ac9-a6ae62d9cfe8,Adams676
5c664454-b26e-40b4-a113-2e4e4d21d1da,Altenwerth646
fd480c9c-8b8a-46de-803a-b1603c00b671,Adams676
1e741807-21d1-451d-9cc5-6473955d3fb7,Aufderhar910
92495ce3-2931-4fb7-a319-a47710ffea2c,Abshire638
730cd58c-8a99-4e24-88ea-7b945a10892b,Adams676
cf235044-9d32-4d04-8f79-f7515b9f6609,Anderson154
fec31a34-56d5-4620-b329-f4f1863ff3fe,Abbott774
20649d37-036c-4586-8862-6c321f8a9124,Auer97
50196de2-2405-4822-9d52-d2f714d440ba,Auer97
c7b2cbf8-c61f-4c41-bf1e-5c26400a04e8,Anderson154
de7699da-4642-4a79-b5cc-c10b1f026ad4,Abernathy524
ff599ea0-92a8-4677-b5b7-fbc754900294,Abernathy524
ef341f55-59c8-423d-8633-554dfcaf0f42,Abshire638
d77ceece-5af4-4ed3-9005-d9c9906e081b,Abernathy524
4b3ca3ec-8c42-4037-bfb3-c4ed340d0524,Adams676
ec2fab6f-763a-4492-8292-c94f697a9480,Altenwerth646
0adc0086-8e77-43ea-ab6d-c64591b66508,Ankunding277
15607b50-2e55-4532-a3dc-6e62285ba28c,Altenwerth646
796d1d2c-f011-4044-a2ed-80ca087d28f2,Ankunding277
b83497b9-9b7d-486c-9aeb-40ae98ef038d,Abshire638
ffbd8d6d-f3e1-4d39-a829-3a8dec7cf423,Ankunding277
b20579c8-c7e9-4893-a5ae-758b0a30202d,Aufderhar910
c4427a19-b270-4a68-8030-9e1d9a0a88d6,Ankunding277
41c67c66-7735-49fd-90a1-6b6e099cdf8f,Abshire638
c5a97fb1-66c1-4a75-b06d-58ac84a091c0,Aufderhar910
8a582d86-9480-437e-b9d5-69c1cf85b5bd,Altenwerth646
7ba91fef-50bd-4d35-8893-ef9f6915d082,Abernathy524
bc0d5fe9-f04f-4412-a45c-52bbe5f180ea,Armstrong51
16984bfc-6254-46bf-a76b-f9ebae232a9a,Altenwerth646
2038e30f-9f98-4337-90a4-6dcb267f0181,Anderson154
a62d1fde-ddc3-4aed-93e4-019fcb7ee889,Abernathy524
ee3185b1-9a60-471c-afb9-8bf476cd5614,Abernathy524
a4aac524-dd30-48e5-bd5e-3a4a7d4f25cd,Abernathy524
34fe508d-4d96-405c-9633-4c27091d4870,Aufderhar910
3c0b28e6-2c92-472b-be03-6052302285c8,Abernathy524
43819a00-f532-40ce-87ea-a31d7806aee9,Abernathy524
d8f88a34-ae2f-4d7b-9885-f698f7c06bb2,Abshire638
063fe861-2ffa-47d4-b090-170fd4c86f24,Abernathy524
34e15838-36f3-4353-88c4-a7a18d9223c1,Armstrong51
560e4590-d952-4bf3-94ac-fcdabd74f488,Armstrong51
50ccf4a2-1a93-43b1-8655-51e6b39aceda,Auer97
a91118f7-bad9-4fae-82c8-419ea50986f0,Abernathy524
ce46a3b0-232b-4310-938f-42f68c84c57d,Abbott774
3e770e48-eea4-4da9-ad49-40c65bd7c7f3,Altenwerth646
65550337-ecca-41f6-bc76-64ca259186ba,Ankunding277
bac6395e-3edb-4ff4-892f-15cb678eaa0b,Abernathy524
9b92e0d4-30da-4e21-8760-c083849ef8e4,Aufderhar910
99c7ec03-e162-4125-81b0-6990f3f61355,Ankunding277
6907d53d-4252-4c27-9fb7-bb5ba43515a2,Armstrong51
6b20bd50-653f-4e13-8540-acb20c96d8dd,Armstrong51
7de75cb2-2f64-4fdc-b751-eed00c9c33b7,Abbott774
b7396cf7-85cb-4b21-aad0-367ae5d2cc7c,Aufderhar910
009efe51-00f5-45d7-ac13-2c82b919cce0,Adams676
f318abec-9783-4554-b5d8-4ca49597bb6f,Abbott774
a9cc5f19-4aa9-4a6d-8269-f7c49f2cf34b,Armstrong51
1b1d402e-17c0-4a5f-ac74-971fd4779d66,Abbott774
f1e09c8b-a661-47f1-9cd5-704d51358cdc,Altenwerth646
ef55677e-f307-4032-94a9-72732a971bca,Abshire638
1b930227-c879-475b-a91e-c2937b62d208,Anderson154
3ae19083-c488-40fb-a7e3-831045a09bed,Adams676
0f05a6ab-e13f-47d7-b048-d1919ca18166,Auer97
ff2889b6-2f03-4fb8-b45a-a3d2eda4abbd,Abshire638
96d9c096-974f-4177-b248-15dba6bce243,Auer97
a2d00aa3-9282-46be-8f00-0388a7eaf9c1,Anderson154
20b8e390-0cea-43cb-8abe-588630e79f42,Ankunding277
a86fe402-17f5-41ea-bca0-5eb37e763850,Armstrong51
a86fe402-17f5-41ea-bca0-5eb37e763850,Abernathy524
64c2c754-b84a-4e53-b0b6-f469d3c81787,Ankunding277
82a6d413-d60b-4052-9009-0cedb2922dde,Ankunding277
08f2fc89-ed7f-4dbc-adcb-75caed2dd26c,Ankunding277
42532a4b-db49-405a-92c9-34e60cbbcadd,Armstrong51
6bc1acea-3808-4af2-98a8-a16e537ed8f8,Abshire638
acc3f1d8-cc7e-417a-ab83-76f137eb4f0d,Auer97
405dc7e0-98c3-487c-bc8f-16df685d84c0,Abshire638
777414ce-f051-43ca-8641-ba671dcf38c5,Armstrong51
33d47315-4240-4f7d-8f3a-6eb5e5eff925,Abshire638
d6aeab94-fe7d-4a04-8ea6-79209448f1d0,Abernathy524
068755c9-132d-41ca-aa08-f3d64714a7fd,Aufderhar910
1d7e3acd-a164-4f6f-8b94-52b4ace86e70,Armstrong51
aba017c3-4e76-4d35-a138-a4ca65431cf7,Auer97
cc68130c-76e5-49f3-9495-6dcd7ace191e,Abbott774
d38755be-ef4f-4750-935e-ff96159ff624,Abshire638
fa659eb8-3f2b-4fde-ac48-f9785dd9f8fd,Abshire638
64b1d8dc-05a4-4dfb-80ba-6374b5cc0571,Aufderhar910
31250542-dd38-49f7-b3b2-5e31c22006ba,Adams676
1a40a0e2-9604-451d-a03d-2346d243ee90,Auer97
118ca6d2-1e43-46d1-be27-c01dcf5d0af3,Aufderhar910
d2e60257-31de-4833-8453-06f2ae15bd48,Auer97
88e9d3e9-95cc-4ec3-85b2-196073e79a69,Abshire638
8d3eadd9-1677-467f-9d59-938d74e167c1,Armstrong51
748c3e66-9782-4d19-b85b-1b56f8593132,Aufderhar910
e84455fd-7d5e-4375-9f9c-885f9b70caf5,Abernathy524
473b069b-179d-4e44-b903-47cf6514b93a,Altenwerth646
1a4dc92c-c017-418e-90b3-164142ef7d32,Auer97
e6ddaa3a-b3f1-4db0-9d23-85b35d94cb16,Aufderhar910
55ce78bb-5df5-4dbe-a4bc-a71682a21a6f,Auer97
Query:
SELECT c."subject", c."code"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject", c."code"
    HAVING COUNT(DISTINCT c."id") = 1
    LIMIT 100;
Answer:
Too long, hard cut:
subject,code
"{
  ""patientId"": ""33262bbe-6ca0-4c61-89f0-c3387b4eeccc""
}","{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}"
"{
  ""patientId"": ""816157d6-a6a2-4404-a1a0-ff71ef3678fa""
}","{
  ""coding"": [
    {
      ""code"": ""88805009"",
      ""display"": ""Chronic congestive heart failure (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Chronic congestive heart failure (disorder)""
}"
"{
  ""patientId"": ""02b499ca-9f25-48fa-b8fd-0391e9ee3d31""
}","{
  ""coding"": [
    {
      ""code"": ""128613002"",
      ""display"": ""Seizure disorder"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Seizure disorder""
}"
"{
  ""patientId"": ""b59e1687-e64c-4c43-9861-451829da148a""
}","{
  ""coding"": [
    {
      ""code"": ""444814009"",
      ""display"": ""Viral sinusitis (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Viral sinusitis (disorder)""
}"
"{
  ""patientId"": ""4af3449a-a3d0-4b9a-b91d-fd6d328f818f""
}","{
  ""coding"": [
    {
      ""code"": ""5602001"",
      ""display"": ""Opioid abuse (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Opioid abuse (disorder)""
}"
"{
  ""patientId"": ""1a1590a5-61d6-4b10-b24a-af7b4c63e940""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""e1e02c17-ba4e-41a0-b6d1-bd854ec3a135""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""ec994d06-33c0-4cda-ae17-84aa9fc67bae""
}","{
  ""coding"": [
    {
      ""code"": ""127013003"",
      ""display"": ""Diabetic renal disease (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Diabetic renal disease (disorder)""
}"
"{
  ""patientId"": ""c62c8452-40a0-4fc5-b675-cd4d9f9c1339""
}","{
  ""coding"": [
    {
      ""code"": ""444814009"",
      ""display"": ""Viral sinusitis (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Viral sinusitis (disorder)""
}"
"{
  ""patientId"": ""01cb3f05-203f-4124-bc18-92f92e3345e7""
}","{
  ""coding"": [
    {
      ""code"": ""126906006"",
      ""display"": ""Neoplasm of prostate"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Neoplasm of prostate""
}"
"{
  ""patientId"": ""f1eafbb2-3c5d-432e-96d1-e45f01d90b4b""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""3fa17d2c-6e99-4f62-b73c-263f156878dc""
}","{
  ""coding"": [
    {
      ""code"": ""195662009"",
      ""display"": ""Acute viral pharyngitis (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Acute viral pharyngitis (disorder)""
}"
"{
  ""patientId"": ""3e587bb5-74fa-4a91-922a-569bdf99628f""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""608900b0-7655-43f0-ba3f-790401d5aa60""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  ""patientId"": ""5e59b6e3-a8dc-4c17-baa9-2ef8dbc63f25""
}","{
  ""coding"": [
    {
      ""code"": ""24079001"",
      ""display"": ""Atopic dermatitis"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Atopic dermatitis""
}"
"{
  ""patientId"": ""299388f4-d727-4a15-8d01-91f4ebb91cd7""
}","{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}"
"{
  ""patientId"": ""81244712-9228-4815-9fa3-d4d462af9801""
}","{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}"
"{
  ""patientId"": ""e154a6fa-1f22-4387-b016-2fbacd32f74d""
}","{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}"
"{
  "
Query:
SELECT c."code", COUNT(DISTINCT m."medication") AS "active_medication_count"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      ON m."subject" = c."subject"
    WHERE m."status" = 'active'
    GROUP BY c."code"
    LIMIT 100;
Answer:
Too long, hard cut:
code,active_medication_count
"{
  ""coding"": [
    {
      ""code"": ""15777000"",
      ""display"": ""Prediabetes"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Prediabetes""
}",112
"{
  ""coding"": [
    {
      ""code"": ""48333001"",
      ""display"": ""Burn injury(morphologic abnormality)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Burn injury(morphologic abnormality)""
}",75
"{
  ""coding"": [
    {
      ""code"": ""196416002"",
      ""display"": ""Impacted molars"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Impacted molars""
}",105
"{
  ""coding"": [
    {
      ""code"": ""6072007"",
      ""display"": ""Bleeding from anus"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Bleeding from anus""
}",82
"{
  ""coding"": [
    {
      ""code"": ""45816000"",
      ""display"": ""Pyelonephritis"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Pyelonephritis""
}",73
"{
  ""coding"": [
    {
      ""code"": ""82423001"",
      ""display"": ""Chronic pain"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Chronic pain""
}",104
"{
  ""coding"": [
    {
      ""code"": ""84757009"",
      ""display"": ""Epilepsy"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Epilepsy""
}",108
"{
  ""coding"": [
    {
      ""code"": ""239720000"",
      ""display"": ""Tear of meniscus of knee"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Tear of meniscus of knee""
}",99
"{
  ""coding"": [
    {
      ""code"": ""162864005"",
      ""display"": ""Body mass index 30+ - obesity (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Body mass index 30+ - obesity (finding)""
}",116
"{
  ""coding"": [
    {
      ""code"": ""44301001"",
      ""display"": ""Suicide"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Suicide""
}",2
"{
  ""coding"": [
    {
      ""code"": ""425048006"",
      ""display"": ""Non-small cell carcinoma of lung, TNM stage 2 (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Non-small cell carcinoma of lung, TNM stage 2 (disorder)""
}",3
"{
  ""coding"": [
    {
      ""code"": ""68496003"",
      ""display"": ""Polyp of colon"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Polyp of colon""
}",92
"{
  ""coding"": [
    {
      ""code"": ""195967001"",
      ""display"": ""Asthma"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Asthma""
}",83
"{
  ""coding"": [
    {
      ""code"": ""431856006"",
      ""display"": ""Chronic kidney disease stage 2 (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Chronic kidney disease stage 2 (disorder)""
}",92
"{
  ""coding"": [
    {
      ""code"": ""363406005"",
      ""display"": ""Malignant tumor of colon"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Malignant tumor of colon""
}",86
"{
  ""coding"": [
    {
      ""code"": ""161622006"",
      ""display"": ""History of lower limb amputation (situation)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""History of lower limb amputation (situation)""
}",56
"{
  ""coding"": [
    {
      ""code"": ""49436004"",
      ""display"": ""Atrial Fibrillation"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Atrial Fibrillation""
}",82
"{
  ""coding"": [
    {
      ""code"": ""1501000119109"",
      ""display"": ""Proliferative diabetic retinopathy due to type II diabetes mellitus (disorder)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Proliferative diabetic retinopathy due to type II diabetes mellitus (disorder)""
}",81
"{
  ""coding"": [
    {
      ""code"": ""236077008"",
      ""display"": ""Protracted diarrhea"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Protracted diarrhea""
}",82
"{
  ""coding"": [
    {
      ""code"": ""427089005"",
      ""display"": ""Diabetes from Cystic Fibrosis"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Diabetes from Cystic Fibrosis""
}",44
"{
  ""coding"": [
    {
      ""code"": ""22298006"",
      ""display"": ""Myocardial Infarction"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Myocardial Infarction""
}",103
"{
  ""coding"": [
    {
      ""code"": ""275272006"",
      ""display"": ""Brain damage - traumatic"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Brain damage - traumatic""
}",101
"{
  ""coding"": [
    {
      ""code"": ""225444004"",
      ""display"": ""At risk for suicide (finding)"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""At risk for suicide (finding)""
}",46
"{
  ""coding"": [
    {
      ""code"": ""43878008"",
      ""display"": ""Streptococcal sore throat (disorder)"",
 
Query:
SELECT p."id",
           n.value:"family"::STRING AS "last_name",
           n.value:"given"[0]::STRING AS "first_name"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
    LATERAL FLATTEN(input => p."name") n
    LIMIT 100;
Answer:
Too long, hard cut:
id,last_name,first_name
88ef6674-68e2-4891-baf1-97ae4fab039a,Marquardt819,Myrtis608
88ef6674-68e2-4891-baf1-97ae4fab039a,Mante251,Myrtis608
a2c64eff-6d05-4827-807a-2e9fbde7f10a,Wolff180,Faviola526
a2c64eff-6d05-4827-807a-2e9fbde7f10a,Rogahn59,Faviola526
eb263d17-f504-47b1-a211-7c93813a28b2,Kulas532,Chin306
eb263d17-f504-47b1-a211-7c93813a28b2,Williamson769,Chin306
06905e8c-1844-4064-b0ef-2a856af10e0f,Krajcik437,Ali918
06905e8c-1844-4064-b0ef-2a856af10e0f,Dickens475,Ali918
4b110832-9a6e-4373-ab1d-e5d839eae6f3,Schuster709,Elicia233
4b110832-9a6e-4373-ab1d-e5d839eae6f3,Rolfson709,Elicia233
6d9f03ac-dc40-4e22-abd2-c1ad1fe55fde,Bradtke547,Jonnie215
6d9f03ac-dc40-4e22-abd2-c1ad1fe55fde,Cremin516,Jonnie215
a1382e5a-ab4e-4a05-8845-0d9945144b93,Rempel203,Sandie760
a1382e5a-ab4e-4a05-8845-0d9945144b93,Bailey598,Sandie760
eefd666e-cb9d-4c4c-80f3-bf08f0d0bb2c,Grimes165,Lanelle105
eefd666e-cb9d-4c4c-80f3-bf08f0d0bb2c,Bode78,Lanelle105
612216b5-3e8d-462a-b156-ad560224c107,Christiansen251,Keva141
612216b5-3e8d-462a-b156-ad560224c107,Stanton715,Keva141
ebe32feb-0749-45a6-9ae8-a90b84b93359,Dicki44,Olevia458
ebe32feb-0749-45a6-9ae8-a90b84b93359,Kemmer137,Olevia458
75585234-faf4-4fba-b107-903482e1e042,Trantow673,Tora746
75585234-faf4-4fba-b107-903482e1e042,Schneider199,Tora746
98f0996a-2321-4705-9dcf-da12ddbab7f0,Runolfsdottir785,Dacia646
98f0996a-2321-4705-9dcf-da12ddbab7f0,Rohan584,Dacia646
0e3b2866-b890-4d56-81c4-38f24019b311,Aufderhar910,May125
0e3b2866-b890-4d56-81c4-38f24019b311,Schmeler639,May125
bf62270a-3b19-4035-ba99-99314885de5c,Haag279,Cornelia505
bf62270a-3b19-4035-ba99-99314885de5c,Ernser583,Cornelia505
9b259b7a-d3f6-4ea6-b4e2-3a25f5c1000f,Paucek755,Becki838
9b259b7a-d3f6-4ea6-b4e2-3a25f5c1000f,Labadie908,Becki838
e09557f9-6d52-4f5b-922c-7cfe41654ad6,O'Reilly797,Junie167
e09557f9-6d52-4f5b-922c-7cfe41654ad6,Walker122,Junie167
138c6e78-c68f-4abd-998b-bbeec2aabe90,Kassulke119,Kera17
138c6e78-c68f-4abd-998b-bbeec2aabe90,Becker968,Kera17
8aadf318-f511-4d4e-80a4-9e25650b733c,Schumm995,Abbie917
8aadf318-f511-4d4e-80a4-9e25650b733c,Carroll471,Abbie917
91973365-4f7f-4a3b-bdbf-e2ca20c00680,Kunze215,Velma961
91973365-4f7f-4a3b-bdbf-e2ca20c00680,Leannon79,Velma961
1699b106-0123-4bc7-a327-eb3cbbb5d5f6,Batz141,Lourdes258
1699b106-0123-4bc7-a327-eb3cbbb5d5f6,Kuvalis369,Lourdes258
53948541-0bd8-4390-a8ff-70741ad41956,Roob72,Jerlene697
53948541-0bd8-4390-a8ff-70741ad41956,Hudson301,Jerlene697
a45223c5-e0b4-4b68-9f98-d460b9c53b45,Hegmann834,Joanne343
a45223c5-e0b4-4b68-9f98-d460b9c53b45,Glover433,Joanne343
14b533f9-5f25-4371-9b31-393f147492cf,Parker433,Jeannie478
14b533f9-5f25-4371-9b31-393f147492cf,Upton904,Jeannie478
0882bcdc-9f73-4036-b334-5e56d5242769,Balistreri607,Dorathy429
0882bcdc-9f73-4036-b334-5e56d5242769,Mante251,Dorathy429
327e547f-33f4-486c-8ba9-ed4f55819c16,Prohaska837,Sharita792
327e547f-33f4-486c-8ba9-ed4f55819c16,Fritsch593,Sharita792
6ab6e369-51c6-4b06-953a-1ac562420c0c,Bailey598,Nanci249
6ab6e369-51c6-4b06-953a-1ac562420c0c,Heaney114,Nanci249
156d7a1d-e48f-40f3-9ff2-e01f06941d7b,Weissnat378,Ozie87
156d7a1d-e48f-40f3-9ff2-e01f06941d7b,Williamson769,Ozie87
abeb2157-0661-4db5-bc5b-0e3f6ea6ad3a,Schuppe920,Claudette391
abeb2157-0661-4db5-bc5b-0e3f6ea6ad3a,Frami345,Claudette391
9595dbfc-eb84-44d3-91f8-bac9984c6aad,Kovacek682,Flavia315
9595dbfc-eb84-44d3-91f8-bac9984c6aad,Muller251,Flavia315
2936b0f4-8007-49a9-95fb-d914d6da7eaf,Steuber698,Sondra191
2936b0f4-8007-49a9-95fb-d914d6da7eaf,Batz141,Sondra191
6bc61296-cf64-4c1c-b3e8-e69d911e4174,Reynolds644,Delorse592
6bc61296-cf64-4c1c-b3e8-e69d911e4174,Farrell962,Delorse592
4f431df5-b2c6-4a1a-b7be-44f501de7027,McCullough561,Theressa101
4f431df5-b2c6-4a1a-b7be-44f501de7027,Torp761,Theressa101
5c891356-1585-4d31-bc69-2bd8e7f51279,Stamm704,Willia886
5c891356-1585-4d31-bc69-2bd8e7f51279,Reichel38,Willia886
10619919-cb9d-4759-ab09-126132d39322,Langosh790,Rosamaria757
10619919-cb9d-4759-ab09-126132d39322,Hand679,Rosamaria757
3b2797b4-06cc-44e9-911a-a2709963c1d9,O'Connell601,Adrien235
3b2797b4-06cc-44e9-911a-a2709963c1d9,Considine820,Adrien235
db6b5e30-a89f-4fb7-ab4a-ed4ac2166d8b,Herman763,Lynna524
db6b5e30-a89f-4fb7-ab4a-ed4ac2166d8b,Bechtelar572,Lynna524
bc567489-ee83-4514-acdd-18cfd16869aa,Kilback373,Eleanor470
bc567489-ee83-4514-acdd-18cfd16869aa,Cummings51,Eleanor470
a434065f-3f54-496e-85e0-97b64a862c66,Leffler128,Carlyn477
a434065f-3f54-496e-85e0-97b64a862c66,Pouros728,Carlyn477
18d917a8-4c89-4b7f-9cde-ea4c8d5dbebc,Mraz590,Mendy939
18d917a8-4c89-4b7f-9cde-ea4c8d5dbebc,Dibbert990,Mendy939
b6cf7d30-424b-4c71-9abc-e16cd3790895,Dooley940,Charisse42
b6cf7d30-424b-4c71-9abc-e16cd3790895,Runte676,Charisse42
d28218d5-b57a-4341-9573-060a49fab5b1,Connelly992,Cyndy549
d28218d5-b57a-4341-9573-060a49fab5b1,Ward668,Cyndy549
3fe6e303-c6c1-4c07-af4a-f5aa12d53dfb,Rowe323,Chastity705
3fe6e303-c6c1-4c07-af4a-f5aa12d53dfb,O'Connell601,Chastity705
444bb7e2-fd21-4bd1-a563-12ab05246454,McCullough561,Gaynelle249
444bb7e2-fd21-4bd1-a563-12ab05246454,Jaskolski867,Gaynelle249
bc5d5d12-43b5-4a72-a52
Query:
SELECT DISTINCT "status"
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST"
    LIMIT 100;
Answer:
status
active
stopped
Query:
SELECT p."id" AS "patient_id",
       n.value:"family"::STRING AS "last_name",
       c."code"::VARIANT:"coding"[0]:"code"::STRING AS "condition_code"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
     LATERAL FLATTEN(input => p."name") n,
     "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
WHERE c."subject"::VARIANT:"patientId"::STRING = p."id"
LIMIT 100;
Answer:
Too long, hard cut:
patient_id,last_name,condition_code
41906489-9613-426a-99dc-0f1d150a51ea,Nader710,444814009
db025c5b-6e59-4279-a0a2-5cb7586ad2b6,Schmeler639,444814009
db025c5b-6e59-4279-a0a2-5cb7586ad2b6,Renner328,444814009
729ad6f5-c2c0-472d-b1e9-84b2f9cc3c12,Shields502,444814009
68b69b9f-c9d9-473b-9f58-f0439cadb249,Cummings51,444814009
b6f80926-23d8-423f-9a7f-8bfe4d1374a8,Haley279,444814009
b6f80926-23d8-423f-9a7f-8bfe4d1374a8,Yundt842,444814009
0e54459d-1fc1-4a0e-b6ae-80c64cfcd8be,Jacobson885,444814009
74695d93-c8a8-4676-91b0-d5414a299678,Frami345,444814009
74695d93-c8a8-4676-91b0-d5414a299678,Kemmer137,444814009
682c1f5e-dfc7-4811-ad98-3d76a2b80ec4,Anderson154,444814009
32f22c90-7992-4e21-912b-70cecccbda88,Ruecker817,444814009
32f22c90-7992-4e21-912b-70cecccbda88,Gusikowski974,444814009
41a3eb67-dcfe-465d-aa79-f0f541eff537,McGlynn426,444814009
209cb05b-6f6f-4289-81bc-2ab0da20b7bc,Wilkinson796,444814009
6ccbd722-a06f-4efc-8c51-c62f8e4788cf,Turner526,444814009
eb9e33b5-578d-4f20-89a0-13fd0c44d1e4,Greenfelder433,444814009
ca9814bd-3fb2-48dd-8b60-84baf310ea39,Stroman228,444814009
2ab9c5bb-c1c8-4550-8f1b-60770d116260,Flatley871,444814009
e9b5c9c2-902a-4f0a-a3cb-a4202858350f,Weber641,444814009
13a6db00-b31c-409c-927f-62217fed875e,Ledner144,444814009
13a6db00-b31c-409c-927f-62217fed875e,Schumm995,444814009
5d41110c-13f7-49ff-b7d2-357690515c1c,Reilly981,444814009
edf7b96b-71fa-412b-a865-18b57b6b70d7,Emmerich580,444814009
edf7b96b-71fa-412b-a865-18b57b6b70d7,Kirlin939,444814009
be2503ab-b586-41f5-a9c5-20eca825996c,Langosh790,444814009
3741b2cd-9a05-4d48-adbd-beaa68e4ca51,Sipes176,444814009
94faee47-8d49-499f-b4db-f2a120fe7234,Schneider199,444814009
0ab3dae8-a36e-423b-bbae-bb864f5248b4,Leannon79,444814009
0ab3dae8-a36e-423b-bbae-bb864f5248b4,Farrell962,444814009
aef9470c-a3a1-451c-b139-de1a7320cf6b,Grady603,444814009
201f0444-2348-45cd-a609-54d570cae9d4,Gallardo890,444814009
201f0444-2348-45cd-a609-54d570cae9d4,Urrutia540,444814009
3a4f26f7-3fff-415f-aebb-41085c65e235,Lubowitz58,444814009
71a6a5fc-b048-4e27-841c-21b7e1a5880d,O'Keefe54,444814009
50ca0fa8-8c85-4d32-9d52-eb5820e6222f,McDermott739,444814009
635d35f9-2402-4ade-b809-d9896de50f10,Weimann465,444814009
f5f9182b-4420-4127-8be9-1f73b34e1205,Keebler762,444814009
327a6c79-f5f5-459a-9162-92e4eedde32d,Lueilwitz711,444814009
8021a33a-ee8b-489a-8239-a6316a1a69e1,Schamberger479,444814009
e458f72f-ffb8-4057-a836-fd78918c396b,Toy286,444814009
d132eb7f-056e-426e-a9a0-7d4f42969ab2,Rice937,444814009
f8d26a5c-c102-4984-abed-73614f3b5c6d,Kilback373,444814009
302a7c6e-e664-4f62-8cd2-0a1a5d314306,Graham902,444814009
302a7c6e-e664-4f62-8cd2-0a1a5d314306,Mohr916,444814009
28808aee-3609-410a-acb1-0eaf80693180,Ortiz186,444814009
d2c21c57-1565-4e81-9d69-19408cb83d0c,Schiller186,444814009
d2c21c57-1565-4e81-9d69-19408cb83d0c,Hirthe744,444814009
a5be08e6-aeb2-4f64-b71d-8ca157203f71,Botsford977,444814009
dc98e60d-0ea5-437f-a513-a9f74e714c7c,Orn563,444814009
dc98e60d-0ea5-437f-a513-a9f74e714c7c,Abbott774,444814009
0848f444-6534-47f1-951e-5b02111e228a,Pollich983,444814009
aa1932e8-5d65-42ba-9b27-1bb5bca02a64,Bogisich202,444814009
aa1932e8-5d65-42ba-9b27-1bb5bca02a64,Brown30,444814009
b90697da-f329-4cfe-8275-ed077f8a3a54,Beatty507,444814009
d51c2331-bcee-442e-8512-a6179ec0d653,Gorczany269,444814009
c987146b-fc4e-44ac-ac95-351af70d647c,Barrows492,444814009
c987146b-fc4e-44ac-ac95-351af70d647c,O'Kon634,444814009
ca3f9823-b738-4ac6-86be-7c7c88eb6189,Dicki44,444814009
ca3f9823-b738-4ac6-86be-7c7c88eb6189,Buckridge80,444814009
92a2a973-3a48-467f-9254-1dd966ba5f2a,Stokes453,444814009
61ceed7b-02b7-4ba3-bbb5-074eafc5e40a,Spinka232,444814009
61ceed7b-02b7-4ba3-bbb5-074eafc5e40a,Auer97,444814009
97539bff-4eb6-46a1-b5e3-6bbb1a4b4a55,Little434,444814009
97539bff-4eb6-46a1-b5e3-6bbb1a4b4a55,Berge125,444814009
ec52396d-02a6-40aa-9ff4-dbf311d80c19,Champlin946,444814009
ec52396d-02a6-40aa-9ff4-dbf311d80c19,O'Hara248,444814009
fd157c30-7f8d-449b-a051-2d77d1873968,Lowe577,444814009
ec2e0ed4-c93d-470c-8d88-d840323ece1c,Zemlak964,444814009
c68f98e4-bb23-4a97-bd95-4fa69a3f57dc,DuBuque211,444814009
ef0dad7e-53a9-476e-9e3d-d7986ad6a993,Wintheiser220,444814009
cfe95ac8-3d04-4488-8841-a3a2b42c82a9,Sep칰lveda884,444814009
cfe95ac8-3d04-4488-8841-a3a2b42c82a9,Zayas20,444814009
c27dde79-eb9d-4288-bcaf-46b4c79b2258,Vega377,444814009
c72356c3-aaed-492d-af86-4994a5029da2,Koepp521,444814009
24d5cf99-b537-4cb0-a2ab-d7b8c54489a5,Krajcik437,444814009
11b2dc58-f51c-40b9-a5ba-1c3a92e1d020,Bernier607,444814009
57ecd316-0171-425e-8d54-5e09723d9b60,Bayer639,444814009
de975818-1615-4908-a50f-973eb5cd1f1f,Casper496,444814009
fb87ea32-6f8f-4209-b590-5d2f6b57e89b,Kohler843,444814009
0e1bba74-742a-491d-a3af-e092196c024c,Dickens475,444814009
3801cd58-9614-44e6-99ac-6fc646194825,Kirlin939,444814009
3801cd58-9614-44e6-99ac-6fc646194825,Flatley871,444814009
b67db99a-7af7-46cc-b609-d0181f38288d,Hintz995,444814009
b67db99a-7af7-46cc-b609-d0181f38288d,Cruickshank494,444814009
a8a2e8af-6e3a-40b9-b5b0-f1c675fb6b8c,Stracke611,444814009
161b544e-cc5d-435
Query:
SELECT MAX(med_count) AS "max_active_medications"
    FROM (
      SELECT m."subject", COUNT(DISTINCT m."medication") AS med_count
      FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
      WHERE m."status" = 'active'
      GROUP BY m."subject"
    )
    LIMIT 100;
Answer:
max_active_medications
20
Query:
SELECT p."id" AS "patient_id", 
       n.value:"family"::STRING AS "last_name",
       m."medication"
FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p
CROSS JOIN LATERAL FLATTEN(input => p."name") n
JOIN "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
  ON m."subject"::VARIANT:"patientId"::STRING = p."id"
WHERE n.value:"family"::STRING ILIKE 'A%'
LIMIT 100;
Answer:
Too long, hard cut:
patient_id,last_name,medication
877e2465-bab0-4aba-a02f-72642ae47312,Abshire638,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
12776b91-a037-4597-8c7b-d3a1bfbcc4e2,Altenwerth646,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
6954156b-4288-4617-b342-7156965c0d7d,Armstrong51,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
1563e62e-43e7-4f3d-b2c3-b008eff560d5,Abernathy524,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
11c0527f-a6cb-47f9-90ee-fde42964bfd7,Abernathy524,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
9a606691-340b-4838-afca-6f70b40e97de,Altenwerth646,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
f4edabdc-5503-4b4a-b390-e88d06a753f6,Almanza534,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
d28dd4e3-ae32-4306-9d24-ca87566c7365,Abbott774,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
31d434fa-0d99-453e-a024-2ba3b5dfc06f,Arce139,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
2a1a47ec-f71e-45f8-bba7-d0bae0c426c7,Anderson154,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
9622d4a7-4550-4fdd-8ef8-f00e845282c4,Adams676,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
e26e5e84-1623-4311-9dcd-157a716a981b,Adams676,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
d17b42ba-a410-4511-a74b-a2179486d64a,Almaraz628,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
f98d5542-13e1-44f4-9a53-f572d7183f2b,Acu침a179,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
f74ddb9e-c201-4c60-b58d-854632e8b39b,Ankunding277,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
c70467af-fe35-4de2-8b8c-c390c3fe38e5,Abernathy524,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",
        ""display"": ""Simvistatin 10 MG"",
        ""system"": ""http://www.nlm.nih.gov/research/umls/rxnorm""
      }
    ],
    ""text"": ""Simvistatin 10 MG""
  }
}"
29a53d88-3391-4173-9d34-1a82f286ea92,Adams676,"{
  ""codeableConcept"": {
    ""coding"": [
      {
        ""code"": ""316672"",

Query:
SELECT c."id", c."code"::VARIANT
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    LIMIT 100;
Answer:
Too long, hard cut:
id,"C.""CODE""::VARIANT"
372b7d2e-ecb2-4fe6-a572-2e1955e493d1,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
9b9e7457-d096-4766-ad30-9975ad8352db,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
36f814a7-8da2-4163-a9e1-573dbacf971e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
b2d7987a-eb81-431c-80b9-8e1cce4f47e5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
d58ed937-24af-45f2-88fe-3faafeddfa1a,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
011ebdc7-4a1b-45c0-a155-aaaff81d7e0b,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
82e3ab6f-49cd-481b-88fc-cae52cdb729e,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
825db10a-a2bb-4a95-9f80-2b15c3d83b40,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
37a130aa-b37e-4986-afa6-1d98aaf50eaa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
cb3dfebd-5a5e-4273-bc32-3fe5c43e0ecd,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
ab561037-815d-4182-ae51-526a8c4f85a4,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
7597a472-3ebe-4bc2-b179-7236514e98aa,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
fc1079d1-11fb-43c4-8718-127e91fb2426,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
992edc1d-0bd1-4444-97cf-179d0085e4c6,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
62dabd0d-baac-43e5-9e65-d6473025522c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
3afa9aea-e686-4b4a-b2f0-2641fd45633c,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": ""Fracture of the vertebral column with spinal cord injury"",
      ""system"": ""http://snomed.info/sct""
    }
  ],
  ""text"": ""Fracture of the vertebral column with spinal cord injury""
}"
c5385f1f-16fd-425e-9f64-fc77401b0dd5,"{
  ""coding"": [
    {
      ""code"": ""1734006"",
      ""display"": "
End Exploring Related Columns
Task: Among living patients whose last names begin with "A" and who each have exactly one distinct condition, which eight conditions have the highest number of different active medications prescribed to any single patient, and what are their corresponding codes?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
condition_code,number_of_different_active_medications
code1:str,number1:int
code2:str,number2:int
code3:str,number3:int
code4:str,number4:int
code5:str,number5:int
code6:str,number6:int
code7:str,number7:int
code8:str,number8:int
```

**Explanation:**

The table lists the eight conditions with the highest number of different active medications prescribed to any single patient among living patients whose last names begin with "A" and who each have exactly one distinct condition. The `condition_code` column contains the codes corresponding to these conditions, and the `number_of_different_active_medications` column shows the maximum number of different active medications prescribed to a single patient for each condition..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FHIR_SYNTHEA': {'FHIR_SYNTHEA': ['BASIC', 'DIAGNOSTIC_REPORT', 'EXPLANATION_OF_BENEFIT', 'ORGANIZATION', 'PATIENT', 'PROCEDURE', 'IMMUNIZATION', 'ENCOUNTER', 'GOAL', 'IMAGING_STUDY', 'ALLERGY_INTOLERANCE', 'CARE_PLAN', 'CONDITION', 'OBSERVATION', 'CLAIM', 'MEDICATION_REQUEST', 'PRACTITIONER']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 17:39:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:39:40 - root - INFO - ```sql
WITH patient_names AS (
    SELECT 
        p."id" AS patient_id,
        n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
    WHERE
        (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
        AND n.value:"family"::STRING ILIKE 'A%'
),
patients_with_one_condition AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT c."id") AS condition_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject"::VARIANT:"patientId"::STRING
    HAVING COUNT(DISTINCT c."id") = 1
),
patients_with_lastname_A_and_one_condition AS (
    SELECT pn.patient_id
    FROM patient_names pn
    INNER JOIN patients_with_one_condition pwoc ON pn.patient_id = pwoc.patient_id
),
patient_conditions AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    WHERE c."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
),
active_medications_per_patient AS (
    SELECT
        m."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::VARIANT:"patientId"::STRING
),
patient_conditions_medications AS (
    SELECT
        pc.condition_code,
        a.active_med_count
    FROM patient_conditions pc
    JOIN active_medications_per_patient a ON pc.patient_id = a.patient_id
)
SELECT
    pcm.condition_code,
    MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;
```
2025-02-11 17:39:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:39:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:39:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:39:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 17:39:42 - snowflake.connector.connection - INFO - closed
2025-02-11 17:39:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:39:42 - root - INFO - itercount: 1
2025-02-11 17:39:42 - root - INFO - 0
2025-02-11 17:39:42 - root - INFO - results: 
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
195662009,4
53741008,4
446096008,3
162864005,3
49436004,3
40275004,3
444814009,3
38341003,3


2025-02-11 17:39:42 - root - INFO - Please check the answer again by reviewing Among living patients whose last names begin with "A" and who each have exactly one distinct condition, which eight conditions have the highest number of different active medications prescribed to any single patient, and what are their corresponding codes?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
condition_code,number_of_different_active_medications
code1:str,number1:int
code2:str,number2:int
code3:str,number3:int
code4:str,number4:int
code5:str,number5:int
code6:str,number6:int
code7:str,number7:int
code8:str,number8:int
```

**Explanation:**

The table lists the eight conditions with the highest number of different active medications prescribed to any single patient among living patients whose last names begin with "A" and who each have exactly one distinct condition. The `condition_code` column contains the codes corresponding to these conditions, and the `number_of_different_active_medications` column shows the maximum number of different active medications prescribed to a single patient for each condition. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
195662009,4
53741008,4
446096008,3
162864005,3
49436004,3
40275004,3
444814009,3
38341003,3
Current sql:
WITH patient_names AS (
    SELECT 
        p."id" AS patient_id,
        n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
    WHERE
        (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
        AND n.value:"family"::STRING ILIKE 'A%'
),
patients_with_one_condition AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT c."id") AS condition_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject"::VARIANT:"patientId"::STRING
    HAVING COUNT(DISTINCT c."id") = 1
),
patients_with_lastname_A_and_one_condition AS (
    SELECT pn.patient_id
    FROM patient_names pn
    INNER JOIN patients_with_one_condition pwoc ON pn.patient_id = pwoc.patient_id
),
patient_conditions AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    WHERE c."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
),
active_medications_per_patient AS (
    SELECT
        m."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
    GROUP BY m."subject"::VARIANT:"patientId"::STRING
),
patient_conditions_medications AS (
    SELECT
        pc.condition_code,
        a.active_med_count
    FROM patient_conditions pc
    JOIN active_medications_per_patient a ON pc.patient_id = a.patient_id
)
SELECT
    pcm.condition_code,
    MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC
LIMIT 8;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-11 17:40:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:40:21 - root - INFO - ```sql
WITH patient_names AS (
    SELECT 
        p."id" AS patient_id,
        n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
    WHERE
        (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
        AND n.value:"family"::STRING ILIKE 'A%'
),
patients_with_one_condition AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT c."id") AS condition_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject"::VARIANT:"patientId"::STRING
    HAVING COUNT(DISTINCT c."id") = 1
),
patients_with_lastname_A_and_one_condition AS (
    SELECT pn.patient_id
    FROM patient_names pn
    INNER JOIN patients_with_one_condition pwoc ON pn.patient_id = pwoc.patient_id
),
patient_conditions AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    WHERE c."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
),
active_medications_per_patient AS (
    SELECT
        m."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
        AND m."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
    GROUP BY m."subject"::VARIANT:"patientId"::STRING
),
patient_conditions_medications AS (
    SELECT
        pc.condition_code,
        a.active_med_count
    FROM patient_conditions pc
    JOIN active_medications_per_patient a ON pc.patient_id = a.patient_id
)
SELECT
    pcm.condition_code,
    MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC NULLS LAST
LIMIT 8;
```
2025-02-11 17:40:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:40:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:40:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:40:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 17:40:23 - snowflake.connector.connection - INFO - closed
2025-02-11 17:40:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:40:24 - root - INFO - itercount: 2
2025-02-11 17:40:24 - root - INFO - 0
2025-02-11 17:40:24 - root - INFO - results: 
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
53741008,4
195662009,4
444814009,3
38341003,3
162864005,3
49436004,3
446096008,3
40275004,3


2025-02-11 17:40:24 - root - INFO - Please check the answer again by reviewing Among living patients whose last names begin with "A" and who each have exactly one distinct condition, which eight conditions have the highest number of different active medications prescribed to any single patient, and what are their corresponding codes?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
condition_code,number_of_different_active_medications
code1:str,number1:int
code2:str,number2:int
code3:str,number3:int
code4:str,number4:int
code5:str,number5:int
code6:str,number6:int
code7:str,number7:int
code8:str,number8:int
```

**Explanation:**

The table lists the eight conditions with the highest number of different active medications prescribed to any single patient among living patients whose last names begin with "A" and who each have exactly one distinct condition. The `condition_code` column contains the codes corresponding to these conditions, and the `number_of_different_active_medications` column shows the maximum number of different active medications prescribed to a single patient for each condition. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
CONDITION_CODE,NUMBER_OF_DIFFERENT_ACTIVE_MEDICATIONS
53741008,4
195662009,4
444814009,3
38341003,3
162864005,3
49436004,3
446096008,3
40275004,3
Current sql:
WITH patient_names AS (
    SELECT 
        p."id" AS patient_id,
        n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
    WHERE
        (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
        AND n.value:"family"::STRING ILIKE 'A%'
),
patients_with_one_condition AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT c."id") AS condition_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject"::VARIANT:"patientId"::STRING
    HAVING COUNT(DISTINCT c."id") = 1
),
patients_with_lastname_A_and_one_condition AS (
    SELECT pn.patient_id
    FROM patient_names pn
    INNER JOIN patients_with_one_condition pwoc ON pn.patient_id = pwoc.patient_id
),
patient_conditions AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    WHERE c."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
),
active_medications_per_patient AS (
    SELECT
        m."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
        AND m."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
    GROUP BY m."subject"::VARIANT:"patientId"::STRING
),
patient_conditions_medications AS (
    SELECT
        pc.condition_code,
        a.active_med_count
    FROM patient_conditions pc
    JOIN active_medications_per_patient a ON pc.patient_id = a.patient_id
)
SELECT
    pcm.condition_code,
    MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC NULLS LAST
LIMIT 8;
2025-02-11 17:40:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 17:40:49 - root - INFO - ```sql
WITH patient_names AS (
    SELECT 
        p."id" AS patient_id,
        n.value:"family"::STRING AS last_name
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."PATIENT" p,
         LATERAL FLATTEN(input => p."name") n
    WHERE
        (p."deceased" IS NULL OR p."deceased"::STRING = 'false')
        AND n.value:"family"::STRING ILIKE 'A%'
),
patients_with_one_condition AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT c."id") AS condition_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    GROUP BY c."subject"::VARIANT:"patientId"::STRING
    HAVING COUNT(DISTINCT c."id") = 1
),
patients_with_lastname_A_and_one_condition AS (
    SELECT pn.patient_id
    FROM patient_names pn
    INNER JOIN patients_with_one_condition pwoc ON pn.patient_id = pwoc.patient_id
),
patient_conditions AS (
    SELECT
        c."subject"::VARIANT:"patientId"::STRING AS patient_id,
        c."code"::VARIANT:"coding"[0]:"code"::STRING AS condition_code
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."CONDITION" c
    WHERE c."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
),
active_medications_per_patient AS (
    SELECT
        m."subject"::VARIANT:"patientId"::STRING AS patient_id,
        COUNT(DISTINCT m."medication"::VARIANT:"codeableConcept":"coding"[0]:"code"::STRING) AS active_med_count
    FROM "FHIR_SYNTHEA"."FHIR_SYNTHEA"."MEDICATION_REQUEST" m
    WHERE m."status" = 'active'
        AND m."subject"::VARIANT:"patientId"::STRING IN (SELECT patient_id FROM patients_with_lastname_A_and_one_condition)
    GROUP BY m."subject"::VARIANT:"patientId"::STRING
),
patient_conditions_medications AS (
    SELECT
        pc.condition_code,
        a.active_med_count
    FROM patient_conditions pc
    JOIN active_medications_per_patient a ON pc.patient_id = a.patient_id
)
SELECT
    pcm.condition_code,
    MAX(pcm.active_med_count) AS number_of_different_active_medications
FROM patient_conditions_medications pcm
GROUP BY pcm.condition_code
ORDER BY number_of_different_active_medications DESC NULLS LAST
LIMIT 8;
```
2025-02-11 17:40:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 17:40:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 17:40:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 17:40:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 17:40:51 - snowflake.connector.connection - INFO - closed
2025-02-11 17:40:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 17:40:51 - root - INFO - itercount: 3
2025-02-11 17:40:51 - root - INFO - 0
2025-02-11 17:40:51 - root - INFO - Total iteration counts: 3
