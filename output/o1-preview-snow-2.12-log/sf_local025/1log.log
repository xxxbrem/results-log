2025-02-10 16:00:48 - openai._base_client - INFO - Retrying request to /chat/completions in 0.459301 seconds
2025-02-10 16:01:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:01:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:54 - root - INFO - SQL:
SELECT DISTINCT "match_id"
   FROM "IPL"."IPL"."MATCH"
   LIMIT 100;
Results:
match_id
335987
335988
335989
335990
335991
335992
335993
335994
335995
335996
335998
335999
336000
336002
336004
336006
336008
336010
336017
336018
336019
336020
336024
336028
336030
336036
336044
392193
392202
392216
419117
419128
419141
419143
419149
501203
501207
501230
336003
336015
336037
336039
392186
392194
392214
392215
392221
392233
392236
392241
419114
419124
419150
419152
419153
419158
501211
501212
501221
419138
501214
501259
501264
335997
336005
336007
336009
336012
336013
336023
336031
336034
336042
392188
392201
392205
392220
392225
392235
419131
419142
419166
336014
336016
336033
336040
336041
336043
336045
392189
392190
392196
392197
392200
392204
392206
392210
392218
392223
392224

2025-02-10 16:01:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:55 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:56 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,runs_scored
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,0
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,0
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,0
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,0
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,0
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,0
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0

2025-02-10 16:01:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:57 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_runs", "extra_type"
   FROM "IPL"."IPL"."EXTRA_RUNS"
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,extra_runs,extra_type
501229,1,16,3,1,legbyes
501229,2,18,1,1,legbyes
501229,2,18,6,4,legbyes
392239,2,18,6,1,legbyes
501229,1,20,3,1,legbyes
501230,1,1,4,4,legbyes
829714,1,18,4,1,legbyes
829816,2,3,3,1,legbyes
501230,2,3,4,1,legbyes
829816,1,2,3,4,legbyes
980962,2,18,2,1,legbyes
829714,2,18,1,1,legbyes
829714,1,9,6,1,legbyes
501231,2,1,1,1,legbyes
335994,2,4,6,1,legbyes
501231,2,2,6,1,legbyes
829714,1,9,3,2,legbyes
980962,2,17,5,2,legbyes
336045,2,3,5,4,legbyes
392240,1,3,7,1,legbyes
336045,1,4,1,1,legbyes
829714,1,3,6,1,legbyes
501231,2,20,5,1,legbyes
501232,2,1,1,1,legbyes
501232,1,1,2,1,legbyes
336045,1,8,3,1,legbyes
336017,2,4,4,1,legbyes
829814,1,18,1,1,legbyes
501232,2,4,3,1,legbyes
501232,1,4,6,1,legbyes
501232,2,7,2,1,legbyes
829714,1,1,1,4,legbyes
336045,2,9,3,1,legbyes
501232,2,14,3,1,legbyes
501232,1,14,7,1,legbyes
829712,1,18,5,1,legbyes
829712,1,3,1,4,legbyes
829712,1,2,6,1,legbyes
392240,1,10,2,2,legbyes
829712,1,1,3,4,legbyes
392240,1,11,2,1,legbyes
335991,1,2,1,1,legbyes
980962,2,14,1,1,legbyes
335988,2,17,1,1,legbyes
392240,1,13,3,1,legbyes
829814,1,14,3,1,legbyes
501232,1,20,7,1,legbyes
829812,1,4,5,1,legbyes
392240,1,15,3,1,legbyes
980960,1,7,5,1,legbyes
829710,2,4,2,1,legbyes
501233,2,6,1,1,legbyes
501233,2,6,3,1,legbyes
981018,2,2,1,1,legbyes
336045,2,18,8,1,legbyes
501233,1,13,1,1,legbyes
829812,1,1,4,1,legbyes
392241,2,3,6,1,legbyes
392241,2,4,6,1,legbyes
981018,1,1,3,1,legbyes
829810,1,12,6,1,legbyes
501234,2,2,1,1,legbyes
980958,1,3,2,1,legbyes
829710,1,1,5,1,legbyes
829710,2,1,3,1,legbyes
392241,2,8,3,1,legbyes
980956,1,20,3,1,legbyes
336017,2,7,5,1,legbyes
392186,1,2,1,1,legbyes
501234,2,14,5,2,legbyes
501234,1,16,2,1,legbyes
336001,2,20,3,1,legbyes
734054,1,19,6,1,legbyes
392186,2,6,1,4,legbyes
392241,1,19,4,1,legbyes
392186,2,6,2,1,legbyes
980986,1,18,2,1,legbyes
392186,2,10,3,1,legbyes
501235,1,12,3,1,legbyes
734054,1,17,6,1,legbyes
829808,1,9,2,1,legbyes
335994,1,9,3,1,legbyes
829808,2,8,2,2,legbyes
829808,2,7,3,1,legbyes
829808,2,7,1,1,legbyes
734054,1,13,2,1,legbyes
501235,1,18,4,1,legbyes
980956,1,16,2,1,legbyes
335994,1,10,2,1,legbyes
335991,2,2,5,4,legbyes
501236,1,13,2,1,legbyes
392187,1,2,2,1,legbyes
501236,1,13,5,1,legbyes
501236,1,15,1,1,legbyes
829808,2,3,1,1,legbyes
501236,2,17,2,1,legbyes
392243,1,4,4,1,legbyes
829806,1,19,6,1,legbyes
392243,2,10,1,1,legbyes
501237,2,5,6,1,legbyes

2025-02-10 16:01:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:58 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:58 - root - INFO - SQL:
SELECT DISTINCT "bowler"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   WHERE "innings_no" = 1
   LIMIT 100;
Results:
bowler
14
15
13
16
10
66
77
25
29
67
68
118
436
90
89
81
175
106
84
82
83
126
32
38
37
31
117
73
80
71
150
48
5
120
121
119
44
435
437
86
58
115
54
136
148
174
159
439
165
158
52
163
157
215
9
24
12
4
39
75
49
50
91
72
102
22
61
98
70
99
78
94
149
8
105
116
41
124
143
109
151
127
153
145
135
21
155
440
161
194
59
131
27
1
63
147
137
60
142
122

2025-02-10 16:01:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:59 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:00 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_batsman_runs"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   GROUP BY "match_id", "innings_no", "over_id"
   LIMIT 100;
Results:
match_id,innings_no,over_id,total_batsman_runs
335987,2,1,3
335987,1,1,0
335987,1,2,18
335987,2,2,1
335987,1,3,5
335987,2,3,2
335987,2,4,3
335987,1,4,17
335987,1,5,10
335987,1,6,1
335987,2,6,2
335987,1,7,7
335987,2,7,5
335987,1,8,5
335987,2,8,4
335987,1,9,4
335987,2,9,3
335987,2,10,6
335987,1,12,10
335987,1,13,11
335987,2,13,9
335987,2,14,7
335987,2,15,2
335987,2,16,0
335988,2,1,9
335988,2,2,7
335988,1,4,6
335988,2,4,10
335987,1,11,11
335987,1,16,4
335987,1,17,14
335987,1,20,22
335988,2,5,10
335988,1,7,9
335988,2,9,12
335988,2,10,13
335988,2,13,12
335988,1,14,9
335988,1,18,17
335988,2,18,4
335988,2,19,7
335989,1,2,10
335989,2,2,12
335989,2,3,5
335989,1,10,5
335989,1,11,2
335989,1,14,7
335990,1,1,8
335990,2,3,11
335990,2,8,8
335988,2,14,9
335989,1,3,0
335989,1,15,9
335989,1,16,10
335990,1,5,18
335990,2,10,7
335990,1,18,20
335990,2,19,8
335991,1,2,2
335991,2,5,2
335992,1,18,2
335994,1,10,9
335994,1,14,14
335995,1,2,10
335987,1,10,10
335987,2,11,5
335987,1,15,22
335987,1,18,7
335988,2,3,11
335987,2,5,8
335987,2,12,3
335987,1,14,6
335987,1,19,21
335988,1,1,5
335988,1,2,14
335988,1,3,6
335988,1,5,8
335988,2,6,14
335988,1,10,5
335988,1,11,19
335988,2,11,5
335988,1,12,20
335988,2,12,12
335988,1,13,4
335988,1,15,18
335988,2,15,13
335988,1,16,8
335988,1,17,14
335988,1,19,15
335989,1,1,6
335989,1,5,6
335989,2,6,6
335989,2,7,4
335989,1,8,3
335989,1,9,2
335989,2,11,9
335989,1,12,12
335989,2,12,5
335989,2,13,6
335989,1,17,4

2025-02-10 16:02:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:01 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "total_extra_runs"
   FROM "IPL"."IPL"."EXTRA_RUNS"
   GROUP BY "match_id", "innings_no", "over_id"
   LIMIT 100;
Results:
match_id,innings_no,over_id,total_extra_runs
501229,1,16,1
392239,2,18,1
501229,1,20,1
501230,1,1,4
829714,1,18,1
829816,2,3,1
501230,2,3,1
829816,1,2,4
980962,2,18,1
829714,2,18,3
829714,1,9,8
980962,2,17,3
336045,1,4,1
829714,1,3,1
336045,1,8,1
336017,2,4,2
501232,2,14,1
501232,1,14,2
829712,1,18,1
829712,1,3,4
980962,2,14,1
335988,2,17,1
829814,1,14,5
829812,1,4,1
829710,2,4,1
501233,2,6,2
392241,2,4,1
829710,1,1,1
392186,1,2,1
734054,1,19,1
829808,2,8,2
501235,1,18,2
392187,1,2,1
829808,2,3,1
501236,2,17,1
829806,1,19,1
501238,2,10,1
335987,2,15,2
734050,2,8,2
501242,2,19,1
734044,2,6,4
501231,2,1,1
335994,2,4,1
501232,2,1,1
501232,1,4,1
829712,1,2,2
392240,1,11,1
980958,1,3,1
392241,1,19,1
980986,1,18,1
501235,1,12,1
829808,2,7,2
734054,1,1,1
392244,2,20,4
981006,2,3,1
734048,1,13,1
829804,2,12,1
734046,1,3,1
501246,1,6,6
392188,2,3,2
419113,2,3,4
734050,2,1,2
336003,2,10,1
501258,2,6,5
501229,2,18,5
336045,2,3,5
501231,2,20,1
336045,2,9,3
392240,1,13,5
981018,1,1,1
501234,2,2,2
501234,2,14,2
734054,1,17,4
829808,1,9,1
392243,1,4,1
734052,2,10,2
501238,1,6,3
829806,1,17,1
501238,1,20,4
501240,2,9,1
734042,2,12,1
501232,1,1,1
501232,2,7,1
829714,1,1,4
829712,1,1,4
335991,1,2,3
980960,1,7,1
981018,2,2,1
336045,2,18,3
501233,1,13,1
829812,1,1,1
392241,2,3,1
829810,1,12,1
829710,2,1,2
980956,1,20,1
336017,2,7,3
501234,1,16,1
336001,2,20,1
392186,2,10,1
734054,1,13,1

2025-02-10 16:02:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:02 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:03 - root - INFO - SQL:
SELECT bs."match_id", bs."innings_no", bs."over_id",
          SUM(bs."runs_scored") + SUM(er."extra_runs") AS "total_runs"
   FROM "IPL"."IPL"."BATSMAN_SCORED" bs
   LEFT JOIN "IPL"."IPL"."EXTRA_RUNS" er
     ON bs."match_id" = er."match_id"
     AND bs."innings_no" = er."innings_no"
     AND bs."over_id" = er."over_id"
     AND bs."ball_id" = er."ball_id"
   GROUP BY bs."match_id", bs."innings_no", bs."over_id"
   LIMIT 100;
Results:
match_id,innings_no,over_id,total_runs
335987,2,1,
335987,1,2,
335987,2,2,5.0
335987,2,4,4.0
335987,1,5,
335987,1,8,
335987,2,9,
335987,1,11,15.0
335987,2,12,
335987,2,15,3.0
335987,2,16,
335987,1,17,
335987,1,18,
335988,1,3,7.0
335987,2,6,
335987,1,10,
335987,1,16,
335988,2,2,
335987,2,11,
335988,2,5,
335988,2,6,
335988,1,8,
335988,1,9,
335988,1,11,
335988,1,14,10.0
335988,2,17,10.0
335988,1,18,
335989,1,2,
335989,2,2,
335989,1,4,
335989,1,6,3.0
335989,1,9,3.0
335989,1,11,
335989,2,13,
335989,1,14,
335989,1,19,
335989,1,20,
335990,2,2,
335990,1,6,
335989,2,5,
335989,2,9,
335989,2,14,
335988,2,12,
335990,2,14,
335991,1,3,
335991,2,9,
335991,1,12,
335991,2,15,4.0
335991,1,16,
335992,2,5,6.0
335992,2,7,
335992,1,10,
335992,1,11,
335994,1,3,18.0
335994,2,9,
335993,2,11,
335994,2,5,
335995,2,2,9.0
335995,2,10,
335996,1,3,
335996,1,4,
335997,1,18,9.0
336002,2,7,5.0
336009,1,14,
335987,1,15,
335988,2,1,
335988,2,13,14.0
335988,1,13,
335988,2,14,
335988,1,19,
335988,2,19,
335988,1,20,
335989,2,1,
335989,2,6,
335989,1,7,
335989,2,8,
335989,2,16,
335989,1,18,
335990,2,5,
335990,1,8,
335990,1,9,12.0
335988,2,10,
335990,2,7,
335990,1,11,
335990,2,12,
335990,1,14,2.0
335990,1,16,
335990,1,17,11.0
335990,1,18,
335990,2,20,
335991,2,1,
335991,1,6,
335991,2,10,
335991,2,19,9.0
335992,1,2,
335992,2,6,5.0
335992,1,16,
335992,1,17,
335992,1,19,
335993,1,2,

2025-02-10 16:02:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:04 - root - INFO - SQL:
SELECT "bowler", COUNT(DISTINCT "over_id") AS "overs_bowled"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   GROUP BY "bowler"
   LIMIT 100;
Results:
bowler,overs_bowled
106,20
14,20
15,19
84,20
13,4
82,20
1,12
10,6
66,18
16,7
77,20
22,16
25,15
120,20
435,11
121,19
119,17
126,20
89,16
37,6
436,6
68,7
81,20
44,14
48,11
83,18
38,17
58,17
117,13
150,4
437,12
116,19
86,5
109,20
54,16
115,13
52,2
259,9
42,6
67,18
73,20
80,20
56,20
148,6
174,16
159,5
439,15
165,9
215,17
163,19
157,14
161,12
177,18
186,18
196,17
211,13
286,18
307,17
154,20
199,6
245,9
291,6
265,3
409,14
9,20
24,6
49,11
61,20
39,19
31,19
70,13
75,16
78,18
41,13
151,20
179,12
60,14
98,6
94,19
111,1
137,15
442,1
234,17
274,14
192,20
63,15
29,20
118,11
4,17
90,20
50,20
12,13
5,7
149,17
71,19
105,14
8,13
108,2
127,3
57,19

2025-02-10 16:02:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:05 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:05 - root - INFO - SQL:
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id", bs."runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED" bs
   WHERE bs."runs_scored" = 6
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,runs_scored
335987,1,2,4,6
335987,1,4,2,6
335987,1,4,7,6
335987,2,5,4,6
335987,1,10,5,6
335987,1,11,4,6
335987,1,12,2,6
335987,2,13,1,6
335987,2,14,6,6
335987,1,15,3,6
335987,1,15,7,6
335987,1,17,4,6
335987,1,19,1,6
335987,1,19,3,6
335987,1,20,1,6
335987,1,20,2,6
335987,1,20,6,6
335988,2,4,6,6
335988,1,6,2,6
335988,2,6,2,6
335988,2,6,8,6
335988,1,8,5,6
335988,1,9,5,6
335988,2,10,2,6
335988,1,11,1,6
335988,1,11,5,6
335988,1,12,1,6
335988,2,12,2,6
335988,1,12,4,6
335988,2,13,2,6
335988,1,14,5,6
335988,2,14,5,6
335988,1,15,6,6
335988,2,15,6,6
335988,1,16,1,6
335988,1,17,3,6
335988,1,18,5,6
335988,1,19,5,6
335988,1,20,1,6
335988,1,20,2,6
335988,2,20,4,6
335988,1,20,5,6
335989,1,1,7,6
335989,2,5,3,6
335989,1,12,1,6
335989,1,15,1,6
335990,1,5,7,6
335990,2,9,1,6
335990,2,9,2,6
335990,2,12,5,6
335990,1,12,6,6
335990,2,17,1,6
335990,2,18,1,6
335990,1,18,2,6
335990,1,18,5,6
335990,2,18,6,6
335990,1,19,6,6
335991,1,6,1,6
335991,1,6,3,6
335991,2,11,3,6
335991,2,14,6,6
335991,1,15,1,6
335991,1,17,3,6
335991,1,17,4,6
335991,1,17,6,6
335991,2,18,5,6
335991,2,19,6,6
335992,1,3,4,6
335992,2,3,7,6
335992,2,4,6,6
335992,1,5,4,6
335992,1,6,2,6
335992,2,7,2,6
335992,2,9,1,6
335992,2,11,5,6
335992,2,13,4,6
335992,1,14,1,6
335992,2,15,5,6
335992,1,16,1,6
335992,1,16,2,6
335992,1,17,3,6
335993,1,2,3,6
335993,2,9,5,6
335993,2,9,6,6
335993,2,10,3,6
335993,2,13,2,6
335993,2,13,4,6
335993,2,13,6,6
335993,1,16,3,6
335993,1,17,4,6
335993,1,18,1,6
335993,1,18,2,6
335993,1,20,6,6
335994,1,3,3,6
335994,2,5,4,6
335994,1,10,3,6
335994,1,11,1,6
335994,2,12,3,6
335994,2,13,1,6
335994,1,14,3,6

2025-02-10 16:02:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:06 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:07 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_batsman_runs"
    FROM "IPL"."IPL"."BATSMAN_SCORED"
    GROUP BY "match_id", "innings_no", "over_id"
    ORDER BY "total_batsman_runs" DESC
    LIMIT 100;
Results:
match_id,innings_no,over_id,total_batsman_runs
501252,2,3,36
734052,2,6,32
548332,2,13,31
980992,1,19,30
335993,2,13,30
501265,1,15,30
598032,1,8,29
598065,2,17,29
980992,1,18,29
598032,1,5,28
548323,2,19,28
980912,1,19,27
548344,2,19,27
336020,1,19,27
729296,2,18,27
598032,1,15,27
734042,2,13,26
392233,1,19,26
336023,2,14,26
419142,1,16,26
980928,1,14,26
335997,2,14,26
729322,2,17,26
335993,1,18,26
598047,1,20,26
419144,1,13,26
598042,1,20,26
733988,2,3,25
980936,2,18,25
598034,1,1,25
335988,1,20,25
419112,2,12,25
548367,1,6,25
729300,1,13,25
419157,1,20,25
733996,1,16,25
734010,1,20,25
501218,1,20,25
419117,2,13,25
598069,2,15,25
501262,1,13,25
981024,1,20,24
548332,2,20,24
548329,1,17,24
829812,2,2,24
598059,1,18,24
336031,1,20,24
548353,1,19,24
336041,1,20,24
829734,1,14,24
829742,1,17,24
548318,1,19,24
548329,1,14,24
501225,1,3,24
392235,1,19,24
734012,1,5,24
734034,1,20,24
392242,2,6,24
734032,1,15,24
392228,1,6,24
733988,1,19,24
548372,1,20,24
392219,1,15,24
419134,2,5,24
980964,2,17,24
419128,1,19,24
829794,2,19,24
419138,2,3,24
548353,1,18,24
501246,1,19,24
734012,1,19,24
829800,1,17,24
548381,2,2,24
501261,1,20,23
336024,2,14,23
829796,2,14,23
336024,1,17,23
501248,2,8,23
548379,2,7,23
419142,2,15,23
548349,2,19,23
548360,1,5,23
548385,1,19,23
598056,1,17,23
548361,2,18,23
598004,2,17,23
335999,2,7,23
392233,2,20,23
734052,1,4,23
419117,2,18,23
501260,2,2,23
392241,1,20,23
501272,2,20,23
829790,1,3,23
501229,1,20,23
392207,1,18,23
336001,1,19,23
733982,2,19,23
733992,1,20,23
829790,1,15,23

2025-02-10 16:02:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-10 16:02:08 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:08 - root - INFO - SQL:
SELECT DISTINCT "extra_type"
    FROM "IPL"."IPL"."EXTRA_RUNS"
    LIMIT 100;
Results:
extra_type
legbyes
wides
byes
noballs
penalty

2025-02-10 16:02:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:09 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:10 - root - INFO - SQL:
SELECT "bowler", COUNT(*) AS "deliveries_bowled"
    FROM "IPL"."IPL"."BALL_BY_BALL"
    GROUP BY "bowler"
    LIMIT 100;
Results:
bowler,deliveries_bowled
106,1505
14,2528
15,2029
13,25
82,813
1,262
9,1793
16,55
63,326
10,46
66,916
22,244
120,898
25,369
121,1528
435,132
24,67
68,75
118,329
436,49
32,1747
90,441
89,1593
37,51
80,1340
81,2062
12,193
44,301
48,239
61,1849
59,153
5,63
4,323
72,30
99,50
148,38
86,58
27,837
8,264
122,213
143,158
111,6
115,144
127,17
147,475
137,286
144,46
140,897
135,269
160,143
440,12
177,455
218,220
184,67
169,30
189,43
188,865
192,709
210,372
228,336
234,286
282,122
349,247
84,1551
77,947
29,2058
119,272
67,2430
38,1197
49,280
126,1320
39,1557
31,1114
175,785
73,1817
60,288
83,1156
131,1945
117,199
91,359
71,2110
150,32
75,311
78,371
102,265
124,983
98,69
94,2127
109,1782
41,138
437,84
105,153
116,726
112,18
21,841
151,1549
153,418
142,31
145,14
57,342

2025-02-10 16:02:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:11 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:11 - root - INFO - SQL:
SELECT DISTINCT "match_id", "innings_no", "over_id"
    FROM "IPL"."IPL"."EXTRA_RUNS"
    LIMIT 100;
Results:
match_id,innings_no,over_id
501229,1,16
392239,2,18
501229,1,20
501230,1,1
829714,1,18
829816,2,3
501230,2,3
829816,1,2
980962,2,18
829714,2,18
829714,1,9
980962,2,17
336045,1,4
829714,1,3
336045,1,8
336017,2,4
501232,2,14
501232,1,14
829712,1,18
829712,1,3
980962,2,14
335988,2,17
829814,1,14
829812,1,4
829710,2,4
501233,2,6
392241,2,4
829710,1,1
392186,1,2
734054,1,19
829808,2,8
501235,1,18
392187,1,2
829808,2,3
501236,2,17
829806,1,19
501238,2,10
335987,2,15
734050,2,8
501242,2,19
734044,2,6
501231,2,1
335994,2,4
501232,2,1
501232,1,4
829712,1,2
392240,1,11
980958,1,3
392241,1,19
980986,1,18
501235,1,12
829808,2,7
734054,1,1
392244,2,20
981006,2,3
734048,1,13
829804,2,12
734046,1,3
501246,1,6
392188,2,3
419113,2,3
734050,2,1
501229,2,18
336045,2,3
501231,2,20
336045,2,9
392240,1,13
981018,1,1
501234,2,2
501234,2,14
734054,1,17
829808,1,9
392243,1,4
734052,2,10
501238,1,6
829806,1,17
501238,1,20
501240,2,9
734042,2,12
501232,1,1
501232,2,7
829714,1,1
829712,1,1
335991,1,2
980960,1,7
981018,2,2
336045,2,18
501233,1,13
829812,1,1
392241,2,3
829810,1,12
829710,2,1
980956,1,20
336017,2,7
501234,1,16
336001,2,20
392186,2,10
734054,1,13
335991,2,2
501236,1,15

2025-02-10 16:02:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:12 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:13 - root - INFO - SQL:
SELECT bb."bowler", SUM(bs."runs_scored") AS "runs_conceded"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id"
     AND bb."innings_no" = bs."innings_no"
     AND bb."over_id" = bs."over_id"
     AND bb."ball_id" = bs."ball_id"
    GROUP BY bb."bowler"
    LIMIT 100;
Results:
bowler,runs_conceded
14,2966
82,1099
1,336
120,1201
10,81
25,539
29,2475
435,236
67,2967
126,1578
436,86
31,1286
60,345
61,2183
59,212
56,656
131,2261
99,85
78,531
121,1599
68,94
117,289
102,246
143,192
21,975
108,21
147,643
145,23
35,2102
57,425
194,2407
156,152
155,105
215,294
165,144
162,644
440,24
133,57
169,44
190,1939
201,2377
442,11
219,8
273,131
245,105
377,762
275,216
171,42
284,88
293,1153
311,874
313,26
306,5
356,606
349,261
372,210
376,88
385,110
397,55
73,2200
149,279
89,1905
5,61
124,1027
27,996
111,21
144,50
438,31
157,297
439,190
161,276
179,151
181,278
154,766
196,603
441,34
85,5
198,242
206,162
238,557
213,64
209,227
228,430
220,218
241,100
229,20
291,72
254,66
298,78
265,19
269,65
296,997
324,115
294,219
290,23
297,318
305,327
307,244
314,392
450,132

2025-02-10 16:02:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:14 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:14 - root - INFO - SQL:
SELECT "player_id", "player_name"
    FROM "IPL"."IPL"."PLAYER"
    LIMIT 100;
Results:
player_id,player_name
1,SC Ganguly
2,BB McCullum
3,RT Ponting
4,DJ Hussey
5,Mohammad Hafeez
6,R Dravid
7,W Jaffer
8,V Kohli
9,JH Kallis
10,CL White
11,MV Boucher
12,B Akhil
13,AA Noffke
14,P Kumar
15,Z Khan
16,SB Joshi
17,PA Patel
18,ML Hayden
19,MEK Hussey
20,MS Dhoni
21,SK Raina
22,JDP Oram
23,S Badrinath
24,K Goel
25,JR Hopes
26,KC Sangakkara
27,Yuvraj Singh
28,SM Katich
29,IK Pathan
30,T Kohli
31,YK Pathan
32,SR Watson
33,M Kaif
34,DS Lehmann
36,M Rawat
37,D Salunkhe
38,SK Warne
39,SK Trivedi
40,G Gambhir
41,V Sehwag
42,S Dhawan
43,L Ronchi
44,ST Jayasuriya
45,DJ Thornely
46,RV Uthappa
47,PR Shah
48,AM Nayar
49,SM Pollock
50,Harbhajan Singh
51,S Chanderpaul
52,LRPL Taylor
53,AC Gilchrist
54,Y Venugopal Rao
55,VVS Laxman
56,A Symonds
57,RG Sharma
58,SB Styris
59,SB Bangar
60,WPUJC Vaas
61,RP Singh
62,WP Saha
63,LR Shukla
64,DPMD Jayawardene
65,S Sohal
66,B Lee
67,PP Chawla
68,WA Mota
69,Kamran Akmal
70,Shahid Afridi
71,DJ Bravo
72,MA Khote
73,A Nehra
74,GC Smith
75,Pankaj Singh
76,RR Sarwan
77,S Sreesanth
78,VRV Singh
79,SS Tiwary
80,DS Kulkarni
81,R Vinay Kumar
82,AB Agarkar
83,M Kartik
84,I Sharma
85,AM Rahane
86,Shoaib Malik
87,MK Tiwary
88,KD Karthik
89,R Bhatia
90,MF Maharoof
91,VY Mahesh
92,TM Srivastava
93,B Chipli
94,DW Steyn
95,DB Das
96,MK Pandey
97,HH Gibbs
98,DNT Zoysa
99,D Kalyankrishna
100,SE Marsh
101,SA Asnodkar

2025-02-10 16:02:14 - root - INFO - itercount: 0
2025-02-10 16:02:14 - root - INFO - Database Name: IPL
Schema Name: IPL
,0
table_name,PLAYER_MATCH
description,
DDL,"create or replace TABLE PLAYER_MATCH (
	""match_id"" NUMBER(38,0),
	""player_id"" NUMBER(38,0),
	""role"" VARCHAR(16777216),
	""team_id"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,1
table_name,PLAYER
description,
DDL,"create or replace TABLE PLAYER (
	""player_id"" NUMBER(38,0),
	""player_name"" VARCHAR(16777216),
	""dob"" VARCHAR(16777216),
	""batting_hand"" VARCHAR(16777216),
	""bowling_skill"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216)
);"

Database Name: IPL
Schema Name: IPL
,2
table_name,BATSMAN_SCORED
description,
DDL,"create or replace TABLE BATSMAN_SCORED (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""runs_scored"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,3
table_name,WICKET_TAKEN
description,
DDL,"create or replace TABLE WICKET_TAKEN (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""player_out"" NUMBER(38,0),
	""kind_out"" VARCHAR(16777216),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,4
table_name,BALL_BY_BALL
description,
DDL,"create or replace TABLE BALL_BY_BALL (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0),
	""team_batting"" NUMBER(38,0),
	""team_bowling"" NUMBER(38,0),
	""striker_batting_position"" NUMBER(38,0),
	""striker"" NUMBER(38,0),
	""non_striker"" NUMBER(38,0),
	""bowler"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,5
table_name,EXTRA_RUNS
description,
DDL,"create or replace TABLE EXTRA_RUNS (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""extra_type"" VARCHAR(16777216),
	""extra_runs"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,6
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""match_id"" NUMBER(38,0),
	""team_1"" NUMBER(38,0),
	""team_2"" NUMBER(38,0),
	""match_date"" VARCHAR(16777216),
	""season_id"" NUMBER(38,0),
	""venue"" VARCHAR(16777216),
	""toss_winner"" NUMBER(38,0),
	""toss_decision"" VARCHAR(16777216),
	""win_type"" VARCHAR(16777216),
	""win_margin"" NUMBER(38,0),
	""outcome_type"" VARCHAR(16777216),
	""match_winner"" NUMBER(38,0),
	""man_of_the_match"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,7
table_name,TEAM
description,
DDL,"create or replace TABLE TEAM (
	""team_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'IPL': {'IPL': ['PLAYER_MATCH', 'PLAYER', 'BATSMAN_SCORED', 'WICKET_TAKEN', 'BALL_BY_BALL', 'EXTRA_RUNS', 'MATCH', 'TEAM']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **BATSMAN_SCORED** table:
  - `"match_id"`: Identifies each match.
  - `"innings_no"`: Identifies each innings within a match.
  - `"over_id"`: Identifies each over within an innings.
  - `"ball_id"`: Identifies each delivery within an over.
  - `"runs_scored"`: Runs scored by the batsman on a delivery.

- **EXTRA_RUNS** table:
  - `"match_id"`: Identifies each match.
  - `"innings_no"`: Identifies each innings within a match.
  - `"over_id"`: Identifies each over within an innings.
  - `"ball_id"`: Identifies each delivery within an over.
  - `"extra_runs"`: Extra runs awarded on a delivery.
  - `"extra_type"`: Type of extra run (e.g., wide, no-ball).

- **BALL_BY_BALL** table:
  - `"match_id"`: Identifies each match.
  - `"innings_no"`: Identifies each innings within a match.
  - `"over_id"`: Identifies each over within an innings.
  - `"ball_id"`: Identifies each delivery within an over.
  - `"bowler"`: Player ID of the bowler delivering the ball.

**Conditions that may be used:**

- Joining tables on `"match_id"`, `"innings_no"`, `"over_id"`, and `"ball_id"` to combine data from different tables.
- Grouping data by `"match_id"`, `"innings_no"`, `"over_id"` to calculate total runs per over.
- Summing `"runs_scored"` and `"extra_runs"` to get total runs for each delivery or over.
- Using `DISTINCT` to find unique matches, bowlers, or overs.
- Ordering data to identify overs with the highest total runs.

---

**SQL Queries:**

1. Retrieve a list of unique matches from the **MATCH** table:

   ```sql
   SELECT DISTINCT "match_id"
   FROM "IPL"."IPL"."MATCH"
   LIMIT 100;
   ```

2. Get the runs scored by batsmen for each delivery:

   ```sql
   SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   LIMIT 100;
   ```

3. List all extra runs awarded on deliveries:

   ```sql
   SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_runs", "extra_type"
   FROM "IPL"."IPL"."EXTRA_RUNS"
   LIMIT 100;
   ```

4. Find all bowlers who bowled in the first innings of matches:

   ```sql
   SELECT DISTINCT "bowler"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   WHERE "innings_no" = 1
   LIMIT 100;
   ```

5. Calculate total runs scored by batsmen per over:

   ```sql
   SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_batsman_runs"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   GROUP BY "match_id", "innings_no", "over_id"
   LIMIT 100;
   ```

6. Calculate total extra runs awarded per over:

   ```sql
   SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "total_extra_runs"
   FROM "IPL"."IPL"."EXTRA_RUNS"
   GROUP BY "match_id", "innings_no", "over_id"
   LIMIT 100;
   ```

7. Get the total runs (batsman runs + extra runs) per over:

   ```sql
   SELECT bs."match_id", bs."innings_no", bs."over_id",
          SUM(bs."runs_scored") + SUM(er."extra_runs") AS "total_runs"
   FROM "IPL"."IPL"."BATSMAN_SCORED" bs
   LEFT JOIN "IPL"."IPL"."EXTRA_RUNS" er
     ON bs."match_id" = er."match_id"
     AND bs."innings_no" = er."innings_no"
     AND bs."over_id" = er."over_id"
     AND bs."ball_id" = er."ball_id"
   GROUP BY bs."match_id", bs."innings_no", bs."over_id"
   LIMIT 100;
   ```

8. List bowlers and the number of overs they have bowled:

   ```sql
   SELECT "bowler", COUNT(DISTINCT "over_id") AS "overs_bowled"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   GROUP BY "bowler"
   LIMIT 100;
   ```

9. Retrieve details of deliveries where six runs were scored:

   ```sql
   SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id", bs."runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED" bs
   WHERE bs."runs_scored" = 6
   LIMIT 100;
   ```

10. Find overs with the highest batsman runs (without extras):

    ```sql
    SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_batsman_runs"
    FROM "IPL"."IPL"."BATSMAN_SCORED"
    GROUP BY "match_id", "innings_no", "over_id"
    ORDER BY "total_batsman_runs" DESC
    LIMIT 100;
    ```

11. Identify the different types of extra runs:

    ```sql
    SELECT DISTINCT "extra_type"
    FROM "IPL"."IPL"."EXTRA_RUNS"
    LIMIT 100;
    ```

12. Get the number of deliveries bowled by each bowler:

    ```sql
    SELECT "bowler", COUNT(*) AS "deliveries_bowled"
    FROM "IPL"."IPL"."BALL_BY_BALL"
    GROUP BY "bowler"
    LIMIT 100;
    ```

13. List all overs where any extra runs were awarded:

    ```sql
    SELECT DISTINCT "match_id", "innings_no", "over_id"
    FROM "IPL"."IPL"."EXTRA_RUNS"
    LIMIT 100;
    ```

14. Find total runs conceded by each bowler (excluding extras):

    ```sql
    SELECT bb."bowler", SUM(bs."runs_scored") AS "runs_conceded"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id"
     AND bb."innings_no" = bs."innings_no"
     AND bb."over_id" = bs."over_id"
     AND bb."ball_id" = bs."ball_id"
    GROUP BY bb."bowler"
    LIMIT 100;
    ```

15. Retrieve player names and their IDs from the **PLAYER** table:

    ```sql
    SELECT "player_id", "player_name"
    FROM "IPL"."IPL"."PLAYER"
    LIMIT 100;
    ```

---

These queries provide insights into the data relevant to the task by exploring different aspects of the matches, innings, overs, runs, and bowlers in the database.Query:
SELECT DISTINCT "match_id"
   FROM "IPL"."IPL"."MATCH"
   LIMIT 100;
Answer:
match_id
335987
335988
335989
335990
335991
335992
335993
335994
335995
335996
335998
335999
336000
336002
336004
336006
336008
336010
336017
336018
336019
336020
336024
336028
336030
336036
336044
392193
392202
392216
419117
419128
419141
419143
419149
501203
501207
501230
336003
336015
336037
336039
392186
392194
392214
392215
392221
392233
392236
392241
419114
419124
419150
419152
419153
419158
501211
501212
501221
419138
501214
501259
501264
335997
336005
336007
336009
336012
336013
336023
336031
336034
336042
392188
392201
392205
392220
392225
392235
419131
419142
419166
336014
336016
336033
336040
336041
336043
336045
392189
392190
392196
392197
392200
392204
392206
392210
392218
392223
392224
Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,runs_scored
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,0
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,0
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,0
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,0
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,0
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,0
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0
Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_runs", "extra_type"
   FROM "IPL"."IPL"."EXTRA_RUNS"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,extra_runs,extra_type
501229,1,16,3,1,legbyes
501229,2,18,1,1,legbyes
501229,2,18,6,4,legbyes
392239,2,18,6,1,legbyes
501229,1,20,3,1,legbyes
501230,1,1,4,4,legbyes
829714,1,18,4,1,legbyes
829816,2,3,3,1,legbyes
501230,2,3,4,1,legbyes
829816,1,2,3,4,legbyes
980962,2,18,2,1,legbyes
829714,2,18,1,1,legbyes
829714,1,9,6,1,legbyes
501231,2,1,1,1,legbyes
335994,2,4,6,1,legbyes
501231,2,2,6,1,legbyes
829714,1,9,3,2,legbyes
980962,2,17,5,2,legbyes
336045,2,3,5,4,legbyes
392240,1,3,7,1,legbyes
336045,1,4,1,1,legbyes
829714,1,3,6,1,legbyes
501231,2,20,5,1,legbyes
501232,2,1,1,1,legbyes
501232,1,1,2,1,legbyes
336045,1,8,3,1,legbyes
336017,2,4,4,1,legbyes
829814,1,18,1,1,legbyes
501232,2,4,3,1,legbyes
501232,1,4,6,1,legbyes
501232,2,7,2,1,legbyes
829714,1,1,1,4,legbyes
336045,2,9,3,1,legbyes
501232,2,14,3,1,legbyes
501232,1,14,7,1,legbyes
829712,1,18,5,1,legbyes
829712,1,3,1,4,legbyes
829712,1,2,6,1,legbyes
392240,1,10,2,2,legbyes
829712,1,1,3,4,legbyes
392240,1,11,2,1,legbyes
335991,1,2,1,1,legbyes
980962,2,14,1,1,legbyes
335988,2,17,1,1,legbyes
392240,1,13,3,1,legbyes
829814,1,14,3,1,legbyes
501232,1,20,7,1,legbyes
829812,1,4,5,1,legbyes
392240,1,15,3,1,legbyes
980960,1,7,5,1,legbyes
829710,2,4,2,1,legbyes
501233,2,6,1,1,legbyes
501233,2,6,3,1,legbyes
981018,2,2,1,1,legbyes
336045,2,18,8,1,legbyes
501233,1,13,1,1,legbyes
829812,1,1,4,1,legbyes
392241,2,3,6,1,legbyes
392241,2,4,6,1,legbyes
981018,1,1,3,1,legbyes
829810,1,12,6,1,legbyes
501234,2,2,1,1,legbyes
980958,1,3,2,1,legbyes
829710,1,1,5,1,legbyes
829710,2,1,3,1,legbyes
392241,2,8,3,1,legbyes
980956,1,20,3,1,legbyes
336017,2,7,5,1,legbyes
392186,1,2,1,1,legbyes
501234,2,14,5,2,legbyes
501234,1,16,2,1,legbyes
336001,2,20,3,1,legbyes
734054,1,19,6,1,legbyes
392186,2,6,1,4,legbyes
392241,1,19,4,1,legbyes
392186,2,6,2,1,legbyes
980986,1,18,2,1,legbyes
392186,2,10,3,1,legbyes
501235,1,12,3,1,legbyes
734054,1,17,6,1,legbyes
829808,1,9,2,1,legbyes
335994,1,9,3,1,legbyes
829808,2,8,2,2,legbyes
829808,2,7,3,1,legbyes
829808,2,7,1,1,legbyes
734054,1,13,2,1,legbyes
501235,1,18,4,1,legbyes
980956,1,16,2,1,legbyes
335994,1,10,2,1,legbyes
335991,2,2,5,4,legbyes
501236,1,13,2,1,legbyes
392187,1,2,2,1,legbyes
501236,1,13,5,1,legbyes
501236,1,15,1,1,legbyes
829808,2,3,1,1,legbyes
501236,2,17,2,1,legbyes
392243,1,4,4,1,legbyes
829806,1,19,6,1,legbyes
392243,2,10,1,1,legbyes
501237,2,5,6,1,legbyes
Query:
SELECT DISTINCT "bowler"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   WHERE "innings_no" = 1
   LIMIT 100;
Answer:
bowler
14
15
13
16
10
66
77
25
29
67
68
118
436
90
89
81
175
106
84
82
83
126
32
38
37
31
117
73
80
71
150
48
5
120
121
119
44
435
437
86
58
115
54
136
148
174
159
439
165
158
52
163
157
215
9
24
12
4
39
75
49
50
91
72
102
22
61
98
70
99
78
94
149
8
105
116
41
124
143
109
151
127
153
145
135
21
155
440
161
194
59
131
27
1
63
147
137
60
142
122
Query:
SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_batsman_runs"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   GROUP BY "match_id", "innings_no", "over_id"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,total_batsman_runs
335987,2,1,3
335987,1,1,0
335987,1,2,18
335987,2,2,1
335987,1,3,5
335987,2,3,2
335987,2,4,3
335987,1,4,17
335987,1,5,10
335987,1,6,1
335987,2,6,2
335987,1,7,7
335987,2,7,5
335987,1,8,5
335987,2,8,4
335987,1,9,4
335987,2,9,3
335987,2,10,6
335987,1,12,10
335987,1,13,11
335987,2,13,9
335987,2,14,7
335987,2,15,2
335987,2,16,0
335988,2,1,9
335988,2,2,7
335988,1,4,6
335988,2,4,10
335987,1,11,11
335987,1,16,4
335987,1,17,14
335987,1,20,22
335988,2,5,10
335988,1,7,9
335988,2,9,12
335988,2,10,13
335988,2,13,12
335988,1,14,9
335988,1,18,17
335988,2,18,4
335988,2,19,7
335989,1,2,10
335989,2,2,12
335989,2,3,5
335989,1,10,5
335989,1,11,2
335989,1,14,7
335990,1,1,8
335990,2,3,11
335990,2,8,8
335988,2,14,9
335989,1,3,0
335989,1,15,9
335989,1,16,10
335990,1,5,18
335990,2,10,7
335990,1,18,20
335990,2,19,8
335991,1,2,2
335991,2,5,2
335992,1,18,2
335994,1,10,9
335994,1,14,14
335995,1,2,10
335987,1,10,10
335987,2,11,5
335987,1,15,22
335987,1,18,7
335988,2,3,11
335987,2,5,8
335987,2,12,3
335987,1,14,6
335987,1,19,21
335988,1,1,5
335988,1,2,14
335988,1,3,6
335988,1,5,8
335988,2,6,14
335988,1,10,5
335988,1,11,19
335988,2,11,5
335988,1,12,20
335988,2,12,12
335988,1,13,4
335988,1,15,18
335988,2,15,13
335988,1,16,8
335988,1,17,14
335988,1,19,15
335989,1,1,6
335989,1,5,6
335989,2,6,6
335989,2,7,4
335989,1,8,3
335989,1,9,2
335989,2,11,9
335989,1,12,12
335989,2,12,5
335989,2,13,6
335989,1,17,4
Query:
SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "total_extra_runs"
   FROM "IPL"."IPL"."EXTRA_RUNS"
   GROUP BY "match_id", "innings_no", "over_id"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,total_extra_runs
501229,1,16,1
392239,2,18,1
501229,1,20,1
501230,1,1,4
829714,1,18,1
829816,2,3,1
501230,2,3,1
829816,1,2,4
980962,2,18,1
829714,2,18,3
829714,1,9,8
980962,2,17,3
336045,1,4,1
829714,1,3,1
336045,1,8,1
336017,2,4,2
501232,2,14,1
501232,1,14,2
829712,1,18,1
829712,1,3,4
980962,2,14,1
335988,2,17,1
829814,1,14,5
829812,1,4,1
829710,2,4,1
501233,2,6,2
392241,2,4,1
829710,1,1,1
392186,1,2,1
734054,1,19,1
829808,2,8,2
501235,1,18,2
392187,1,2,1
829808,2,3,1
501236,2,17,1
829806,1,19,1
501238,2,10,1
335987,2,15,2
734050,2,8,2
501242,2,19,1
734044,2,6,4
501231,2,1,1
335994,2,4,1
501232,2,1,1
501232,1,4,1
829712,1,2,2
392240,1,11,1
980958,1,3,1
392241,1,19,1
980986,1,18,1
501235,1,12,1
829808,2,7,2
734054,1,1,1
392244,2,20,4
981006,2,3,1
734048,1,13,1
829804,2,12,1
734046,1,3,1
501246,1,6,6
392188,2,3,2
419113,2,3,4
734050,2,1,2
336003,2,10,1
501258,2,6,5
501229,2,18,5
336045,2,3,5
501231,2,20,1
336045,2,9,3
392240,1,13,5
981018,1,1,1
501234,2,2,2
501234,2,14,2
734054,1,17,4
829808,1,9,1
392243,1,4,1
734052,2,10,2
501238,1,6,3
829806,1,17,1
501238,1,20,4
501240,2,9,1
734042,2,12,1
501232,1,1,1
501232,2,7,1
829714,1,1,4
829712,1,1,4
335991,1,2,3
980960,1,7,1
981018,2,2,1
336045,2,18,3
501233,1,13,1
829812,1,1,1
392241,2,3,1
829810,1,12,1
829710,2,1,2
980956,1,20,1
336017,2,7,3
501234,1,16,1
336001,2,20,1
392186,2,10,1
734054,1,13,1
Query:
SELECT bs."match_id", bs."innings_no", bs."over_id",
          SUM(bs."runs_scored") + SUM(er."extra_runs") AS "total_runs"
   FROM "IPL"."IPL"."BATSMAN_SCORED" bs
   LEFT JOIN "IPL"."IPL"."EXTRA_RUNS" er
     ON bs."match_id" = er."match_id"
     AND bs."innings_no" = er."innings_no"
     AND bs."over_id" = er."over_id"
     AND bs."ball_id" = er."ball_id"
   GROUP BY bs."match_id", bs."innings_no", bs."over_id"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,total_runs
335987,2,1,
335987,1,2,
335987,2,2,5.0
335987,2,4,4.0
335987,1,5,
335987,1,8,
335987,2,9,
335987,1,11,15.0
335987,2,12,
335987,2,15,3.0
335987,2,16,
335987,1,17,
335987,1,18,
335988,1,3,7.0
335987,2,6,
335987,1,10,
335987,1,16,
335988,2,2,
335987,2,11,
335988,2,5,
335988,2,6,
335988,1,8,
335988,1,9,
335988,1,11,
335988,1,14,10.0
335988,2,17,10.0
335988,1,18,
335989,1,2,
335989,2,2,
335989,1,4,
335989,1,6,3.0
335989,1,9,3.0
335989,1,11,
335989,2,13,
335989,1,14,
335989,1,19,
335989,1,20,
335990,2,2,
335990,1,6,
335989,2,5,
335989,2,9,
335989,2,14,
335988,2,12,
335990,2,14,
335991,1,3,
335991,2,9,
335991,1,12,
335991,2,15,4.0
335991,1,16,
335992,2,5,6.0
335992,2,7,
335992,1,10,
335992,1,11,
335994,1,3,18.0
335994,2,9,
335993,2,11,
335994,2,5,
335995,2,2,9.0
335995,2,10,
335996,1,3,
335996,1,4,
335997,1,18,9.0
336002,2,7,5.0
336009,1,14,
335987,1,15,
335988,2,1,
335988,2,13,14.0
335988,1,13,
335988,2,14,
335988,1,19,
335988,2,19,
335988,1,20,
335989,2,1,
335989,2,6,
335989,1,7,
335989,2,8,
335989,2,16,
335989,1,18,
335990,2,5,
335990,1,8,
335990,1,9,12.0
335988,2,10,
335990,2,7,
335990,1,11,
335990,2,12,
335990,1,14,2.0
335990,1,16,
335990,1,17,11.0
335990,1,18,
335990,2,20,
335991,2,1,
335991,1,6,
335991,2,10,
335991,2,19,9.0
335992,1,2,
335992,2,6,5.0
335992,1,16,
335992,1,17,
335992,1,19,
335993,1,2,
Query:
SELECT "bowler", COUNT(DISTINCT "over_id") AS "overs_bowled"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   GROUP BY "bowler"
   LIMIT 100;
Answer:
bowler,overs_bowled
106,20
14,20
15,19
84,20
13,4
82,20
1,12
10,6
66,18
16,7
77,20
22,16
25,15
120,20
435,11
121,19
119,17
126,20
89,16
37,6
436,6
68,7
81,20
44,14
48,11
83,18
38,17
58,17
117,13
150,4
437,12
116,19
86,5
109,20
54,16
115,13
52,2
259,9
42,6
67,18
73,20
80,20
56,20
148,6
174,16
159,5
439,15
165,9
215,17
163,19
157,14
161,12
177,18
186,18
196,17
211,13
286,18
307,17
154,20
199,6
245,9
291,6
265,3
409,14
9,20
24,6
49,11
61,20
39,19
31,19
70,13
75,16
78,18
41,13
151,20
179,12
60,14
98,6
94,19
111,1
137,15
442,1
234,17
274,14
192,20
63,15
29,20
118,11
4,17
90,20
50,20
12,13
5,7
149,17
71,19
105,14
8,13
108,2
127,3
57,19
Query:
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id", bs."runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED" bs
   WHERE bs."runs_scored" = 6
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,runs_scored
335987,1,2,4,6
335987,1,4,2,6
335987,1,4,7,6
335987,2,5,4,6
335987,1,10,5,6
335987,1,11,4,6
335987,1,12,2,6
335987,2,13,1,6
335987,2,14,6,6
335987,1,15,3,6
335987,1,15,7,6
335987,1,17,4,6
335987,1,19,1,6
335987,1,19,3,6
335987,1,20,1,6
335987,1,20,2,6
335987,1,20,6,6
335988,2,4,6,6
335988,1,6,2,6
335988,2,6,2,6
335988,2,6,8,6
335988,1,8,5,6
335988,1,9,5,6
335988,2,10,2,6
335988,1,11,1,6
335988,1,11,5,6
335988,1,12,1,6
335988,2,12,2,6
335988,1,12,4,6
335988,2,13,2,6
335988,1,14,5,6
335988,2,14,5,6
335988,1,15,6,6
335988,2,15,6,6
335988,1,16,1,6
335988,1,17,3,6
335988,1,18,5,6
335988,1,19,5,6
335988,1,20,1,6
335988,1,20,2,6
335988,2,20,4,6
335988,1,20,5,6
335989,1,1,7,6
335989,2,5,3,6
335989,1,12,1,6
335989,1,15,1,6
335990,1,5,7,6
335990,2,9,1,6
335990,2,9,2,6
335990,2,12,5,6
335990,1,12,6,6
335990,2,17,1,6
335990,2,18,1,6
335990,1,18,2,6
335990,1,18,5,6
335990,2,18,6,6
335990,1,19,6,6
335991,1,6,1,6
335991,1,6,3,6
335991,2,11,3,6
335991,2,14,6,6
335991,1,15,1,6
335991,1,17,3,6
335991,1,17,4,6
335991,1,17,6,6
335991,2,18,5,6
335991,2,19,6,6
335992,1,3,4,6
335992,2,3,7,6
335992,2,4,6,6
335992,1,5,4,6
335992,1,6,2,6
335992,2,7,2,6
335992,2,9,1,6
335992,2,11,5,6
335992,2,13,4,6
335992,1,14,1,6
335992,2,15,5,6
335992,1,16,1,6
335992,1,16,2,6
335992,1,17,3,6
335993,1,2,3,6
335993,2,9,5,6
335993,2,9,6,6
335993,2,10,3,6
335993,2,13,2,6
335993,2,13,4,6
335993,2,13,6,6
335993,1,16,3,6
335993,1,17,4,6
335993,1,18,1,6
335993,1,18,2,6
335993,1,20,6,6
335994,1,3,3,6
335994,2,5,4,6
335994,1,10,3,6
335994,1,11,1,6
335994,2,12,3,6
335994,2,13,1,6
335994,1,14,3,6
Query:
SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_batsman_runs"
    FROM "IPL"."IPL"."BATSMAN_SCORED"
    GROUP BY "match_id", "innings_no", "over_id"
    ORDER BY "total_batsman_runs" DESC
    LIMIT 100;
Answer:
match_id,innings_no,over_id,total_batsman_runs
501252,2,3,36
734052,2,6,32
548332,2,13,31
980992,1,19,30
335993,2,13,30
501265,1,15,30
598032,1,8,29
598065,2,17,29
980992,1,18,29
598032,1,5,28
548323,2,19,28
980912,1,19,27
548344,2,19,27
336020,1,19,27
729296,2,18,27
598032,1,15,27
734042,2,13,26
392233,1,19,26
336023,2,14,26
419142,1,16,26
980928,1,14,26
335997,2,14,26
729322,2,17,26
335993,1,18,26
598047,1,20,26
419144,1,13,26
598042,1,20,26
733988,2,3,25
980936,2,18,25
598034,1,1,25
335988,1,20,25
419112,2,12,25
548367,1,6,25
729300,1,13,25
419157,1,20,25
733996,1,16,25
734010,1,20,25
501218,1,20,25
419117,2,13,25
598069,2,15,25
501262,1,13,25
981024,1,20,24
548332,2,20,24
548329,1,17,24
829812,2,2,24
598059,1,18,24
336031,1,20,24
548353,1,19,24
336041,1,20,24
829734,1,14,24
829742,1,17,24
548318,1,19,24
548329,1,14,24
501225,1,3,24
392235,1,19,24
734012,1,5,24
734034,1,20,24
392242,2,6,24
734032,1,15,24
392228,1,6,24
733988,1,19,24
548372,1,20,24
392219,1,15,24
419134,2,5,24
980964,2,17,24
419128,1,19,24
829794,2,19,24
419138,2,3,24
548353,1,18,24
501246,1,19,24
734012,1,19,24
829800,1,17,24
548381,2,2,24
501261,1,20,23
336024,2,14,23
829796,2,14,23
336024,1,17,23
501248,2,8,23
548379,2,7,23
419142,2,15,23
548349,2,19,23
548360,1,5,23
548385,1,19,23
598056,1,17,23
548361,2,18,23
598004,2,17,23
335999,2,7,23
392233,2,20,23
734052,1,4,23
419117,2,18,23
501260,2,2,23
392241,1,20,23
501272,2,20,23
829790,1,3,23
501229,1,20,23
392207,1,18,23
336001,1,19,23
733982,2,19,23
733992,1,20,23
829790,1,15,23
Query:
SELECT DISTINCT "extra_type"
    FROM "IPL"."IPL"."EXTRA_RUNS"
    LIMIT 100;
Answer:
extra_type
legbyes
wides
byes
noballs
penalty
Query:
SELECT "bowler", COUNT(*) AS "deliveries_bowled"
    FROM "IPL"."IPL"."BALL_BY_BALL"
    GROUP BY "bowler"
    LIMIT 100;
Answer:
bowler,deliveries_bowled
106,1505
14,2528
15,2029
13,25
82,813
1,262
9,1793
16,55
63,326
10,46
66,916
22,244
120,898
25,369
121,1528
435,132
24,67
68,75
118,329
436,49
32,1747
90,441
89,1593
37,51
80,1340
81,2062
12,193
44,301
48,239
61,1849
59,153
5,63
4,323
72,30
99,50
148,38
86,58
27,837
8,264
122,213
143,158
111,6
115,144
127,17
147,475
137,286
144,46
140,897
135,269
160,143
440,12
177,455
218,220
184,67
169,30
189,43
188,865
192,709
210,372
228,336
234,286
282,122
349,247
84,1551
77,947
29,2058
119,272
67,2430
38,1197
49,280
126,1320
39,1557
31,1114
175,785
73,1817
60,288
83,1156
131,1945
117,199
91,359
71,2110
150,32
75,311
78,371
102,265
124,983
98,69
94,2127
109,1782
41,138
437,84
105,153
116,726
112,18
21,841
151,1549
153,418
142,31
145,14
57,342
Query:
SELECT DISTINCT "match_id", "innings_no", "over_id"
    FROM "IPL"."IPL"."EXTRA_RUNS"
    LIMIT 100;
Answer:
match_id,innings_no,over_id
501229,1,16
392239,2,18
501229,1,20
501230,1,1
829714,1,18
829816,2,3
501230,2,3
829816,1,2
980962,2,18
829714,2,18
829714,1,9
980962,2,17
336045,1,4
829714,1,3
336045,1,8
336017,2,4
501232,2,14
501232,1,14
829712,1,18
829712,1,3
980962,2,14
335988,2,17
829814,1,14
829812,1,4
829710,2,4
501233,2,6
392241,2,4
829710,1,1
392186,1,2
734054,1,19
829808,2,8
501235,1,18
392187,1,2
829808,2,3
501236,2,17
829806,1,19
501238,2,10
335987,2,15
734050,2,8
501242,2,19
734044,2,6
501231,2,1
335994,2,4
501232,2,1
501232,1,4
829712,1,2
392240,1,11
980958,1,3
392241,1,19
980986,1,18
501235,1,12
829808,2,7
734054,1,1
392244,2,20
981006,2,3
734048,1,13
829804,2,12
734046,1,3
501246,1,6
392188,2,3
419113,2,3
734050,2,1
501229,2,18
336045,2,3
501231,2,20
336045,2,9
392240,1,13
981018,1,1
501234,2,2
501234,2,14
734054,1,17
829808,1,9
392243,1,4
734052,2,10
501238,1,6
829806,1,17
501238,1,20
501240,2,9
734042,2,12
501232,1,1
501232,2,7
829714,1,1
829712,1,1
335991,1,2
980960,1,7
981018,2,2
336045,2,18
501233,1,13
829812,1,1
392241,2,3
829810,1,12
829710,2,1
980956,1,20
336017,2,7
501234,1,16
336001,2,20
392186,2,10
734054,1,13
335991,2,2
501236,1,15
Query:
SELECT bb."bowler", SUM(bs."runs_scored") AS "runs_conceded"
    FROM "IPL"."IPL"."BALL_BY_BALL" bb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" bs
      ON bb."match_id" = bs."match_id"
     AND bb."innings_no" = bs."innings_no"
     AND bb."over_id" = bs."over_id"
     AND bb."ball_id" = bs."ball_id"
    GROUP BY bb."bowler"
    LIMIT 100;
Answer:
bowler,runs_conceded
14,2966
82,1099
1,336
120,1201
10,81
25,539
29,2475
435,236
67,2967
126,1578
436,86
31,1286
60,345
61,2183
59,212
56,656
131,2261
99,85
78,531
121,1599
68,94
117,289
102,246
143,192
21,975
108,21
147,643
145,23
35,2102
57,425
194,2407
156,152
155,105
215,294
165,144
162,644
440,24
133,57
169,44
190,1939
201,2377
442,11
219,8
273,131
245,105
377,762
275,216
171,42
284,88
293,1153
311,874
313,26
306,5
356,606
349,261
372,210
376,88
385,110
397,55
73,2200
149,279
89,1905
5,61
124,1027
27,996
111,21
144,50
438,31
157,297
439,190
161,276
179,151
181,278
154,766
196,603
441,34
85,5
198,242
206,162
238,557
213,64
209,227
228,430
220,218
241,100
229,20
291,72
254,66
298,78
265,19
269,65
296,997
324,115
294,219
290,23
297,318
305,327
307,244
314,392
450,132
Query:
SELECT "player_id", "player_name"
    FROM "IPL"."IPL"."PLAYER"
    LIMIT 100;
Answer:
player_id,player_name
1,SC Ganguly
2,BB McCullum
3,RT Ponting
4,DJ Hussey
5,Mohammad Hafeez
6,R Dravid
7,W Jaffer
8,V Kohli
9,JH Kallis
10,CL White
11,MV Boucher
12,B Akhil
13,AA Noffke
14,P Kumar
15,Z Khan
16,SB Joshi
17,PA Patel
18,ML Hayden
19,MEK Hussey
20,MS Dhoni
21,SK Raina
22,JDP Oram
23,S Badrinath
24,K Goel
25,JR Hopes
26,KC Sangakkara
27,Yuvraj Singh
28,SM Katich
29,IK Pathan
30,T Kohli
31,YK Pathan
32,SR Watson
33,M Kaif
34,DS Lehmann
36,M Rawat
37,D Salunkhe
38,SK Warne
39,SK Trivedi
40,G Gambhir
41,V Sehwag
42,S Dhawan
43,L Ronchi
44,ST Jayasuriya
45,DJ Thornely
46,RV Uthappa
47,PR Shah
48,AM Nayar
49,SM Pollock
50,Harbhajan Singh
51,S Chanderpaul
52,LRPL Taylor
53,AC Gilchrist
54,Y Venugopal Rao
55,VVS Laxman
56,A Symonds
57,RG Sharma
58,SB Styris
59,SB Bangar
60,WPUJC Vaas
61,RP Singh
62,WP Saha
63,LR Shukla
64,DPMD Jayawardene
65,S Sohal
66,B Lee
67,PP Chawla
68,WA Mota
69,Kamran Akmal
70,Shahid Afridi
71,DJ Bravo
72,MA Khote
73,A Nehra
74,GC Smith
75,Pankaj Singh
76,RR Sarwan
77,S Sreesanth
78,VRV Singh
79,SS Tiwary
80,DS Kulkarni
81,R Vinay Kumar
82,AB Agarkar
83,M Kartik
84,I Sharma
85,AM Rahane
86,Shoaib Malik
87,MK Tiwary
88,KD Karthik
89,R Bhatia
90,MF Maharoof
91,VY Mahesh
92,TM Srivastava
93,B Chipli
94,DW Steyn
95,DB Das
96,MK Pandey
97,HH Gibbs
98,DNT Zoysa
99,D Kalyankrishna
100,SE Marsh
101,SA Asnodkar
End Exploring Related Columns
Task: For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Average_Highest_Over_Total
average_runs:float
(Attention: answer in one row)
```

We calculated the average of the highest over totals across all matches by combining runs from both the batsman scored (`runs_scored`) and extra runs (`extra_runs`) for each over in every innings. For each match and innings, we identified the single over with the highest total runs, retrieved the bowler for that over from the `BALL_BY_BALL` table, and then computed the average of these highest over totals across all matches to ensure all runs and bowler details are accurately reflected..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'IPL': {'IPL': ['PLAYER_MATCH', 'PLAYER', 'BATSMAN_SCORED', 'WICKET_TAKEN', 'BALL_BY_BALL', 'EXTRA_RUNS', 'MATCH', 'TEAM']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 16:02:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:02:58 - root - INFO - ```sql
WITH total_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_scored"
  FROM "IPL"."IPL"."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
  FROM "IPL"."IPL"."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
over_total_runs AS (
  SELECT 
    COALESCE(tr."match_id", er."match_id") AS "match_id",
    COALESCE(tr."innings_no", er."innings_no") AS "innings_no",
    COALESCE(tr."over_id", er."over_id") AS "over_id",
    COALESCE(tr."runs_scored", 0) + COALESCE(er."extra_runs", 0) AS "over_total_runs"
  FROM total_runs_per_over tr
  FULL OUTER JOIN extra_runs_per_over er
    ON tr."match_id" = er."match_id"
    AND tr."innings_no" = er."innings_no"
    AND tr."over_id" = er."over_id"
),
over_bowlers AS (
  SELECT 
    "match_id", 
    "innings_no", 
    "over_id", 
    "bowler"
  FROM (
    SELECT 
      "match_id", 
      "innings_no", 
      "over_id", 
      "bowler",
      ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no", "over_id" ORDER BY "ball_id") AS rn
    FROM "IPL"."IPL"."BALL_BY_BALL"
  ) ob
  WHERE rn = 1
),
over_runs_bowlers AS (
  SELECT otr."match_id", otr."innings_no", otr."over_id", otr."over_total_runs", ob."bowler"
  FROM over_total_runs otr
  JOIN over_bowlers ob
    ON otr."match_id" = ob."match_id" AND otr."innings_no" = ob."innings_no" AND otr."over_id" = ob."over_id"
),
highest_over_per_innings AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler",
         ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no" ORDER BY "over_total_runs" DESC, "over_id") AS rn
  FROM over_runs_bowlers
),
final_highest_overs AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler"
  FROM highest_over_per_innings
  WHERE rn = 1
)
SELECT AVG("over_total_runs") AS "average_runs"
FROM final_highest_overs;
```
2025-02-10 16:02:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:02:59 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:59 - root - INFO - itercount: 1
2025-02-10 16:02:59 - root - INFO - 0
2025-02-10 16:02:59 - root - INFO - results: 
average_runs
17.429577


2025-02-10 16:02:59 - root - INFO - Please check the answer again by reviewing For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Average_Highest_Over_Total
average_runs:float
(Attention: answer in one row)
```

We calculated the average of the highest over totals across all matches by combining runs from both the batsman scored (`runs_scored`) and extra runs (`extra_runs`) for each over in every innings. For each match and innings, we identified the single over with the highest total runs, retrieved the bowler for that over from the `BALL_BY_BALL` table, and then computed the average of these highest over totals across all matches to ensure all runs and bowler details are accurately reflected. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
average_runs
17.429577
Current sql:
WITH total_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_scored"
  FROM "IPL"."IPL"."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
  FROM "IPL"."IPL"."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
over_total_runs AS (
  SELECT 
    COALESCE(tr."match_id", er."match_id") AS "match_id",
    COALESCE(tr."innings_no", er."innings_no") AS "innings_no",
    COALESCE(tr."over_id", er."over_id") AS "over_id",
    COALESCE(tr."runs_scored", 0) + COALESCE(er."extra_runs", 0) AS "over_total_runs"
  FROM total_runs_per_over tr
  FULL OUTER JOIN extra_runs_per_over er
    ON tr."match_id" = er."match_id"
    AND tr."innings_no" = er."innings_no"
    AND tr."over_id" = er."over_id"
),
over_bowlers AS (
  SELECT 
    "match_id", 
    "innings_no", 
    "over_id", 
    "bowler"
  FROM (
    SELECT 
      "match_id", 
      "innings_no", 
      "over_id", 
      "bowler",
      ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no", "over_id" ORDER BY "ball_id") AS rn
    FROM "IPL"."IPL"."BALL_BY_BALL"
  ) ob
  WHERE rn = 1
),
over_runs_bowlers AS (
  SELECT otr."match_id", otr."innings_no", otr."over_id", otr."over_total_runs", ob."bowler"
  FROM over_total_runs otr
  JOIN over_bowlers ob
    ON otr."match_id" = ob."match_id" AND otr."innings_no" = ob."innings_no" AND otr."over_id" = ob."over_id"
),
highest_over_per_innings AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler",
         ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no" ORDER BY "over_total_runs" DESC, "over_id") AS rn
  FROM over_runs_bowlers
),
final_highest_overs AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler"
  FROM highest_over_per_innings
  WHERE rn = 1
)
SELECT AVG("over_total_runs") AS "average_runs"
FROM final_highest_overs;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-10 16:04:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:04:03 - root - INFO - ```sql
WITH total_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_scored"
  FROM "IPL"."IPL"."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
  FROM "IPL"."IPL"."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
over_total_runs AS (
  SELECT 
    COALESCE(tr."match_id", er."match_id") AS "match_id",
    COALESCE(tr."innings_no", er."innings_no") AS "innings_no",
    COALESCE(tr."over_id", er."over_id") AS "over_id",
    COALESCE(tr."runs_scored", 0) + COALESCE(er."extra_runs", 0) AS "over_total_runs"
  FROM total_runs_per_over tr
  FULL OUTER JOIN extra_runs_per_over er
    ON tr."match_id" = er."match_id"
    AND tr."innings_no" = er."innings_no"
    AND tr."over_id" = er."over_id"
),
over_bowlers AS (
  SELECT 
    "match_id", 
    "innings_no", 
    "over_id", 
    "bowler"
  FROM (
    SELECT 
      "match_id", 
      "innings_no", 
      "over_id", 
      "bowler",
      ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no", "over_id" ORDER BY "ball_id") AS rn
    FROM "IPL"."IPL"."BALL_BY_BALL"
  ) ob
  WHERE rn = 1
),
over_runs_bowlers AS (
  SELECT otr."match_id", otr."innings_no", otr."over_id", otr."over_total_runs", ob."bowler"
  FROM over_total_runs otr
  JOIN over_bowlers ob
    ON otr."match_id" = ob."match_id" AND otr."innings_no" = ob."innings_no" AND otr."over_id" = ob."over_id"
),
highest_over_per_innings AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler",
         ROW_NUMBER() OVER (
           PARTITION BY "match_id", "innings_no" 
           ORDER BY "over_total_runs" DESC NULLS LAST, "over_id"
         ) AS rn
  FROM over_runs_bowlers
),
final_highest_overs AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler"
  FROM highest_over_per_innings
  WHERE rn = 1
)
SELECT ROUND(AVG("over_total_runs"), 4) AS "Average_Highest_Over_Total"
FROM final_highest_overs;
```
2025-02-10 16:04:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:04:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:04:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:04:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:04:04 - snowflake.connector.connection - INFO - closed
2025-02-10 16:04:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:04:04 - root - INFO - itercount: 2
2025-02-10 16:04:04 - root - INFO - 0
2025-02-10 16:04:04 - root - INFO - results: 
Average_Highest_Over_Total
17.4296


2025-02-10 16:04:04 - root - INFO - Please check the answer again by reviewing For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Average_Highest_Over_Total
average_runs:float
(Attention: answer in one row)
```

We calculated the average of the highest over totals across all matches by combining runs from both the batsman scored (`runs_scored`) and extra runs (`extra_runs`) for each over in every innings. For each match and innings, we identified the single over with the highest total runs, retrieved the bowler for that over from the `BALL_BY_BALL` table, and then computed the average of these highest over totals across all matches to ensure all runs and bowler details are accurately reflected. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Average_Highest_Over_Total
17.4296
Current sql:
WITH total_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_scored"
  FROM "IPL"."IPL"."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
  FROM "IPL"."IPL"."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
over_total_runs AS (
  SELECT 
    COALESCE(tr."match_id", er."match_id") AS "match_id",
    COALESCE(tr."innings_no", er."innings_no") AS "innings_no",
    COALESCE(tr."over_id", er."over_id") AS "over_id",
    COALESCE(tr."runs_scored", 0) + COALESCE(er."extra_runs", 0) AS "over_total_runs"
  FROM total_runs_per_over tr
  FULL OUTER JOIN extra_runs_per_over er
    ON tr."match_id" = er."match_id"
    AND tr."innings_no" = er."innings_no"
    AND tr."over_id" = er."over_id"
),
over_bowlers AS (
  SELECT 
    "match_id", 
    "innings_no", 
    "over_id", 
    "bowler"
  FROM (
    SELECT 
      "match_id", 
      "innings_no", 
      "over_id", 
      "bowler",
      ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no", "over_id" ORDER BY "ball_id") AS rn
    FROM "IPL"."IPL"."BALL_BY_BALL"
  ) ob
  WHERE rn = 1
),
over_runs_bowlers AS (
  SELECT otr."match_id", otr."innings_no", otr."over_id", otr."over_total_runs", ob."bowler"
  FROM over_total_runs otr
  JOIN over_bowlers ob
    ON otr."match_id" = ob."match_id" AND otr."innings_no" = ob."innings_no" AND otr."over_id" = ob."over_id"
),
highest_over_per_innings AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler",
         ROW_NUMBER() OVER (
           PARTITION BY "match_id", "innings_no" 
           ORDER BY "over_total_runs" DESC NULLS LAST, "over_id"
         ) AS rn
  FROM over_runs_bowlers
),
final_highest_overs AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler"
  FROM highest_over_per_innings
  WHERE rn = 1
)
SELECT ROUND(AVG("over_total_runs"), 4) AS "Average_Highest_Over_Total"
FROM final_highest_overs;
2025-02-10 16:04:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:04:31 - root - INFO - ```csv
Average_Highest_Over_Total
17.4296
```

```sql
WITH total_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_scored"
  FROM "IPL"."IPL"."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs_per_over AS (
  SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
  FROM "IPL"."IPL"."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
over_total_runs AS (
  SELECT 
    COALESCE(tr."match_id", er."match_id") AS "match_id",
    COALESCE(tr."innings_no", er."innings_no") AS "innings_no",
    COALESCE(tr."over_id", er."over_id") AS "over_id",
    COALESCE(tr."runs_scored", 0) + COALESCE(er."extra_runs", 0) AS "over_total_runs"
  FROM total_runs_per_over tr
  FULL OUTER JOIN extra_runs_per_over er
    ON tr."match_id" = er."match_id"
    AND tr."innings_no" = er."innings_no"
    AND tr."over_id" = er."over_id"
),
over_bowlers AS (
  SELECT 
    "match_id", 
    "innings_no", 
    "over_id", 
    "bowler"
  FROM (
    SELECT 
      "match_id", 
      "innings_no", 
      "over_id", 
      "bowler",
      ROW_NUMBER() OVER (PARTITION BY "match_id", "innings_no", "over_id" ORDER BY "ball_id") AS rn
    FROM "IPL"."IPL"."BALL_BY_BALL"
  ) ob
  WHERE rn = 1
),
over_runs_bowlers AS (
  SELECT otr."match_id", otr."innings_no", otr."over_id", otr."over_total_runs", ob."bowler"
  FROM over_total_runs otr
  JOIN over_bowlers ob
    ON otr."match_id" = ob."match_id" AND otr."innings_no" = ob."innings_no" AND otr."over_id" = ob."over_id"
),
highest_over_per_innings AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler",
         ROW_NUMBER() OVER (
           PARTITION BY "match_id", "innings_no" 
           ORDER BY "over_total_runs" DESC NULLS LAST, "over_id"
         ) AS rn
  FROM over_runs_bowlers
),
final_highest_overs AS (
  SELECT "match_id", "innings_no", "over_id", "over_total_runs", "bowler"
  FROM highest_over_per_innings
  WHERE rn = 1
)
SELECT ROUND(AVG("over_total_runs"), 4) AS "Average_Highest_Over_Total"
FROM final_highest_overs;
```
2025-02-10 16:04:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:04:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:04:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:04:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:04:32 - snowflake.connector.connection - INFO - closed
2025-02-10 16:04:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:04:32 - root - INFO - itercount: 3
2025-02-10 16:04:32 - root - INFO - 0
2025-02-10 16:04:32 - root - INFO - Total iteration counts: 3
