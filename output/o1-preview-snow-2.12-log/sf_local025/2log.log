2025-02-10 16:01:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:55 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:56 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
   FROM IPL.IPL.BATSMAN_SCORED
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,runs_scored
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,0
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,0
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,0
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,0
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,0
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,0
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0

2025-02-10 16:01:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:57 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_runs", "extra_type"
   FROM IPL.IPL.EXTRA_RUNS
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,extra_runs,extra_type
501229,1,16,3,1,legbyes
501229,2,18,1,1,legbyes
501229,2,18,6,4,legbyes
392239,2,18,6,1,legbyes
501229,1,20,3,1,legbyes
501230,1,1,4,4,legbyes
829714,1,18,4,1,legbyes
829816,2,3,3,1,legbyes
501230,2,3,4,1,legbyes
829816,1,2,3,4,legbyes
980962,2,18,2,1,legbyes
829714,2,18,1,1,legbyes
829714,1,9,6,1,legbyes
501231,2,1,1,1,legbyes
335994,2,4,6,1,legbyes
501231,2,2,6,1,legbyes
829714,1,9,3,2,legbyes
980962,2,17,5,2,legbyes
336045,2,3,5,4,legbyes
392240,1,3,7,1,legbyes
336045,1,4,1,1,legbyes
829714,1,3,6,1,legbyes
501231,2,20,5,1,legbyes
501232,2,1,1,1,legbyes
501232,1,1,2,1,legbyes
336045,1,8,3,1,legbyes
336017,2,4,4,1,legbyes
829814,1,18,1,1,legbyes
501232,2,4,3,1,legbyes
501232,1,4,6,1,legbyes
501232,2,7,2,1,legbyes
829714,1,1,1,4,legbyes
336045,2,9,3,1,legbyes
501232,2,14,3,1,legbyes
501232,1,14,7,1,legbyes
829712,1,18,5,1,legbyes
829712,1,3,1,4,legbyes
829712,1,2,6,1,legbyes
392240,1,10,2,2,legbyes
829712,1,1,3,4,legbyes
392240,1,11,2,1,legbyes
335991,1,2,1,1,legbyes
980962,2,14,1,1,legbyes
335988,2,17,1,1,legbyes
392240,1,13,3,1,legbyes
829814,1,14,3,1,legbyes
501232,1,20,7,1,legbyes
829812,1,4,5,1,legbyes
392240,1,15,3,1,legbyes
980960,1,7,5,1,legbyes
829710,2,4,2,1,legbyes
501233,2,6,1,1,legbyes
501233,2,6,3,1,legbyes
981018,2,2,1,1,legbyes
336045,2,18,8,1,legbyes
501233,1,13,1,1,legbyes
829812,1,1,4,1,legbyes
392241,2,3,6,1,legbyes
392241,2,4,6,1,legbyes
981018,1,1,3,1,legbyes
829810,1,12,6,1,legbyes
501234,2,2,1,1,legbyes
980958,1,3,2,1,legbyes
829710,1,1,5,1,legbyes
829710,2,1,3,1,legbyes
392241,2,8,3,1,legbyes
980956,1,20,3,1,legbyes
336017,2,7,5,1,legbyes
392186,1,2,1,1,legbyes
501234,2,14,5,2,legbyes
501234,1,16,2,1,legbyes
336001,2,20,3,1,legbyes
734054,1,19,6,1,legbyes
392186,2,6,1,4,legbyes
392241,1,19,4,1,legbyes
392186,2,6,2,1,legbyes
980986,1,18,2,1,legbyes
392186,2,10,3,1,legbyes
501235,1,12,3,1,legbyes
734054,1,17,6,1,legbyes
829808,1,9,2,1,legbyes
335994,1,9,3,1,legbyes
829808,2,8,2,2,legbyes
829808,2,7,3,1,legbyes
829808,2,7,1,1,legbyes
734054,1,13,2,1,legbyes
501235,1,18,4,1,legbyes
980956,1,16,2,1,legbyes
335994,1,10,2,1,legbyes
335991,2,2,5,4,legbyes
501236,1,13,2,1,legbyes
392187,1,2,2,1,legbyes
501236,1,13,5,1,legbyes
501236,1,15,1,1,legbyes
829808,2,3,1,1,legbyes
501236,2,17,2,1,legbyes
392243,1,4,4,1,legbyes
829806,1,19,6,1,legbyes
392243,2,10,1,1,legbyes
501237,2,5,6,1,legbyes

2025-02-10 16:01:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:01:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:01:58 - snowflake.connector.connection - INFO - closed
2025-02-10 16:01:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:01:59 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "bowler"
   FROM IPL.IPL.BALL_BY_BALL
   LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,bowler
335987,2,1,1,106
335987,1,1,2,14
335987,2,1,2,106
335987,1,1,3,14
335987,2,1,3,106
335987,1,1,4,14
335987,2,1,4,106
335987,1,1,5,14
335987,2,1,5,106
335987,1,1,6,14
335987,2,1,6,106
335987,1,1,7,14
335987,2,1,7,106
335987,1,2,1,15
335987,2,2,1,84
335987,1,2,2,15
335987,2,2,2,84
335987,1,2,3,15
335987,2,2,3,84
335987,1,2,4,15
335987,2,2,4,84
335987,1,2,5,15
335987,2,2,5,84
335987,1,2,6,15
335987,2,2,6,84
335987,1,3,1,14
335987,2,3,1,106
335987,1,3,2,14
335987,2,3,2,106
335987,1,3,3,14
335987,2,3,3,106
335987,1,3,4,14
335987,2,3,4,106
335987,1,3,5,14
335987,2,3,5,106
335987,1,3,6,14
335987,2,3,6,106
335987,2,3,7,106
335987,1,4,1,13
335987,2,4,1,84
335987,1,4,2,13
335987,2,4,2,84
335987,1,4,3,13
335987,2,4,3,84
335987,1,4,4,13
335987,2,4,4,84
335987,1,4,5,13
335987,2,4,5,84
335987,1,4,6,13
335987,2,4,6,84
335987,1,4,7,13
335987,1,5,1,14
335987,2,5,1,82
335987,1,5,2,14
335987,2,5,2,82
335987,1,5,3,14
335987,2,5,3,82
335987,1,5,4,14
335987,2,5,4,82
335987,1,5,5,14
335987,2,5,5,82
335987,1,5,6,14
335987,2,5,6,82
335987,1,6,1,15
335987,2,6,1,106
335987,1,6,2,15
335987,2,6,2,106
335987,1,6,3,15
335987,2,6,3,106
335987,1,6,4,15
335987,2,6,4,106
335987,1,6,5,15
335987,2,6,5,106
335987,1,6,6,15
335987,2,6,6,106
335987,1,7,1,13
335987,2,7,1,82
335987,1,7,2,13
335987,2,7,2,82
335987,1,7,3,13
335987,2,7,3,82
335987,1,7,4,13
335987,2,7,4,82
335987,1,7,5,13
335987,2,7,5,82
335987,1,7,6,13
335987,2,7,6,82
335987,2,7,7,82
335987,2,7,8,82
335987,1,8,1,15
335987,2,8,1,1
335987,1,8,2,15
335987,2,8,2,1
335987,1,8,3,15
335987,2,8,3,1
335987,1,8,4,15
335987,2,8,4,1
335987,1,8,5,15
335987,2,8,5,1
335987,1,8,6,15

2025-02-10 16:01:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:01:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:01:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:00 - root - INFO - SQL:
SELECT DISTINCT "match_id"
   FROM IPL.IPL.BATSMAN_SCORED
   LIMIT 100;
Results:
match_id
335987
335988
335989
335990
335991
335992
335993
335994
335995
335996
335998
335999
336000
336002
336004
336006
336008
336010
336017
336018
336019
336020
336024
336028
336030
336036
336044
392193
392202
392216
419117
419128
419141
419143
419149
501203
501207
501230
336003
336015
336037
336039
392186
392194
392214
392215
392221
392233
392236
392241
419114
419124
419150
419152
419153
419158
501211
501212
501221
419138
501214
501259
501264
335997
336005
336007
336009
336012
336013
336023
336031
336034
336042
392188
392201
392205
392220
392225
392235
419131
419142
419166
336014
336016
336033
336040
336041
336043
336045
392189
392190
392196
392197
392200
392204
392206
392210
392218
392223
392224

2025-02-10 16:02:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:01 - root - INFO - SQL:
SELECT "match_id", SUM("runs_scored") AS "total_runs"
   FROM IPL.IPL.BATSMAN_SCORED
   GROUP BY "match_id"
   ORDER BY "total_runs" DESC
   LIMIT 100;
Results:
match_id,total_runs
419142,448
335988,430
829800,420
335995,418
501228,412
733992,404
734052,401
419112,399
548377,398
734012,397
336038,396
336024,392
548323,391
729288,391
980912,391
419144,386
981024,385
734054,385
419117,384
598032,381
335994,379
980954,377
501211,375
548331,374
829792,373
980974,373
734046,372
419164,372
729296,369
734004,367
548371,367
548386,367
829742,367
336025,365
980958,365
548347,364
598069,363
598039,363
548334,362
734034,361
598030,360
980926,360
501218,359
336019,358
548322,357
336003,356
419121,355
598056,355
980914,355
829720,355
548332,354
598011,354
981000,354
548361,354
598031,354
829734,354
829816,353
829804,353
729306,353
392194,353
336014,352
392236,352
980964,351
829796,351
598046,351
829778,350
829828,350
598065,348
419150,347
392219,347
980996,347
829716,347
980952,346
598059,346
598052,346
829774,345
980942,345
548338,344
419141,344
734032,343
336037,343
733996,343
980946,343
829718,342
548353,342
336033,342
548385,341
829782,341
336036,340
980982,340
598047,339
980936,338
734050,338
501215,338
734010,337
980950,337
733986,337
501276,337
980976,336
598050,335

2025-02-10 16:02:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:03 - root - INFO - SQL:
SELECT "match_id", SUM("extra_runs") AS "total_extra_runs"
   FROM IPL.IPL.EXTRA_RUNS
   GROUP BY "match_id"
   ORDER BY "total_extra_runs" DESC
   LIMIT 100;
Results:
match_id,total_extra_runs
419137,38
335991,38
501265,36
335987,36
829816,36
419158,35
336033,35
733988,35
392240,33
829742,33
336028,32
829724,32
548382,32
419147,32
501259,31
501232,31
392232,31
335994,31
548362,30
829714,30
829728,30
548358,29
336041,29
548341,29
392205,28
419119,28
336010,28
336020,28
336029,28
336023,28
419130,28
501215,28
336002,28
729322,27
734052,27
392197,27
336011,27
501256,27
419111,27
981018,27
336042,27
734042,26
336005,26
829716,26
335998,26
392236,25
729294,25
419128,25
392230,25
548366,25
501246,25
501243,25
548314,25
501261,25
548372,25
598077,24
392227,24
419132,24
981006,24
336021,24
501226,24
419154,24
419133,24
419168,24
598004,24
734016,24
501238,24
336017,24
501205,24
829782,23
419167,23
419117,23
392200,23
598074,23
980908,23
419170,23
548318,23
501214,23
392231,23
419150,23
980926,23
392206,23
598068,23
981024,23
980964,23
392215,23
598039,23
980956,23
336014,23
419166,22
729318,22
548325,22
419146,22
419131,22
733994,22
733986,22
501272,22
501273,22
734044,22
419153,22

2025-02-10 16:02:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:04 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_this_over"
   FROM IPL.IPL.BATSMAN_SCORED
   GROUP BY "match_id", "innings_no", "over_id"
   ORDER BY "runs_this_over" DESC
   LIMIT 100;
Results:
match_id,innings_no,over_id,runs_this_over
501252,2,3,36
734052,2,6,32
548332,2,13,31
980992,1,19,30
335993,2,13,30
501265,1,15,30
598032,1,8,29
598065,2,17,29
980992,1,18,29
598032,1,5,28
548323,2,19,28
980912,1,19,27
548344,2,19,27
336020,1,19,27
729296,2,18,27
598032,1,15,27
734042,2,13,26
392233,1,19,26
336023,2,14,26
419142,1,16,26
980928,1,14,26
335997,2,14,26
729322,2,17,26
335993,1,18,26
598047,1,20,26
419144,1,13,26
598042,1,20,26
733988,2,3,25
980936,2,18,25
598034,1,1,25
335988,1,20,25
419112,2,12,25
548367,1,6,25
729300,1,13,25
419157,1,20,25
733996,1,16,25
734010,1,20,25
501218,1,20,25
419117,2,13,25
598069,2,15,25
501262,1,13,25
981024,1,20,24
548332,2,20,24
548329,1,17,24
829812,2,2,24
598059,1,18,24
336031,1,20,24
548353,1,19,24
336041,1,20,24
829734,1,14,24
829742,1,17,24
548318,1,19,24
548329,1,14,24
501225,1,3,24
392235,1,19,24
734012,1,5,24
734034,1,20,24
392242,2,6,24
734032,1,15,24
392228,1,6,24
733988,1,19,24
548372,1,20,24
392219,1,15,24
419134,2,5,24
980964,2,17,24
419128,1,19,24
829794,2,19,24
419138,2,3,24
548353,1,18,24
501246,1,19,24
734012,1,19,24
829800,1,17,24
548381,2,2,24
501261,1,20,23
336024,2,14,23
829796,2,14,23
336024,1,17,23
501248,2,8,23
548379,2,7,23
419142,2,15,23
548349,2,19,23
548360,1,5,23
548385,1,19,23
598056,1,17,23
548361,2,18,23
598004,2,17,23
335999,2,7,23
392233,2,20,23
734052,1,4,23
419117,2,18,23
501260,2,2,23
392241,1,20,23
501272,2,20,23
829790,1,3,23
501229,1,20,23
392207,1,18,23
336001,1,19,23
733982,2,19,23
733992,1,20,23
829790,1,15,23

2025-02-10 16:02:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:05 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:06 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs_this_over"
   FROM IPL.IPL.EXTRA_RUNS
   GROUP BY "match_id", "innings_no", "over_id"
   ORDER BY "extra_runs_this_over" DESC
   LIMIT 100;
Results:
match_id,innings_no,over_id,extra_runs_this_over
598039,2,1,12
336010,2,7,12
335991,2,12,11
548337,1,15,10
598047,1,10,10
335993,2,12,9
980964,2,14,9
829790,2,1,8
548334,2,7,8
501243,2,1,8
729294,1,1,8
598077,1,20,8
548382,2,7,8
829714,1,9,8
419144,1,13,7
501227,1,1,7
501218,2,6,7
501275,1,1,7
392215,2,8,7
336031,1,2,7
392191,1,12,7
829724,2,17,7
419119,1,10,7
734038,1,20,7
829716,1,3,7
548358,1,4,7
548362,2,17,7
829728,1,1,7
336033,2,1,7
981006,2,7,7
419117,2,4,7
734018,2,7,7
548331,1,4,7
392224,2,4,6
335987,1,4,6
980934,2,2,6
419154,1,7,6
980906,1,6,6
598072,2,1,6
501259,1,1,6
598066,2,1,6
829744,1,7,6
501269,1,2,6
598066,2,2,6
981008,2,1,6
980994,2,5,6
981018,2,1,6
598055,1,20,6
336029,1,19,6
501215,1,2,6
501257,1,19,6
548364,2,6,6
829758,1,7,6
980926,2,1,6
548353,1,17,6
829770,1,10,6
829742,1,2,6
392240,2,11,6
501228,1,6,6
980936,1,16,6
598051,2,14,6
980956,2,10,6
548344,1,14,6
598011,2,13,6
419147,1,3,6
336007,1,1,6
548366,2,19,6
501276,1,4,6
419124,1,3,6
419153,2,9,6
829724,1,7,6
419158,1,18,6
598074,2,13,6
419139,1,18,6
392230,2,9,6
392186,2,6,6
501214,1,20,6
392209,2,18,6
501259,1,8,6
392202,1,3,6
501246,1,6,6
501264,2,4,6
548335,2,16,6
501229,2,8,6
336034,2,3,6
419166,2,13,6
501205,1,13,6
336017,2,5,6
419153,1,7,6
829780,2,1,6
733994,1,20,6
733988,1,8,6
501212,1,20,6
501232,2,3,6
336002,2,9,5
335994,1,12,5
336045,2,3,5
501229,2,18,5
335998,2,16,5
501258,2,6,5

2025-02-10 16:02:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:07 - root - INFO - SQL:
SELECT bs."match_id", bs."innings_no", bs."over_id",
          SUM(bs."runs_scored") AS "total_batsman_runs",
          SUM(er."extra_runs") AS "total_extra_runs"
   FROM IPL.IPL.BATSMAN_SCORED bs
   LEFT JOIN IPL.IPL.EXTRA_RUNS er
     ON bs."match_id" = er."match_id"
     AND bs."innings_no" = er."innings_no"
     AND bs."over_id" = er."over_id"
     AND bs."ball_id" = er."ball_id"
   GROUP BY bs."match_id", bs."innings_no", bs."over_id"
   ORDER BY bs."match_id", bs."innings_no", bs."over_id"
   LIMIT 100;
Results:
match_id,innings_no,over_id,total_batsman_runs,total_extra_runs
335987,1,1,0,1.0
335987,1,2,18,
335987,1,3,5,1.0
335987,1,4,17,1.0
335987,1,5,10,
335987,1,6,1,
335987,1,7,7,
335987,1,8,5,
335987,1,9,4,
335987,1,10,10,
335987,1,11,11,4.0
335987,1,12,10,
335987,1,13,11,
335987,1,14,6,
335987,1,15,22,
335987,1,16,4,
335987,1,17,14,
335987,1,18,7,
335987,1,19,21,
335987,1,20,22,
335987,2,1,3,
335987,2,2,1,4.0
335987,2,3,2,
335987,2,4,3,1.0
335987,2,5,8,
335987,2,6,2,
335987,2,7,5,
335987,2,8,4,1.0
335987,2,9,3,
335987,2,10,6,1.0
335987,2,11,5,
335987,2,12,3,
335987,2,13,9,
335987,2,14,7,
335987,2,15,2,1.0
335987,2,16,0,
335988,1,1,5,
335988,1,2,14,
335988,1,3,6,1.0
335988,1,4,6,
335988,1,5,8,1.0
335988,1,6,11,
335988,1,7,9,
335988,1,8,8,
335988,1,9,13,
335988,1,10,5,
335988,1,11,19,
335988,1,12,20,
335988,1,13,4,
335988,1,14,9,1.0
335988,1,15,18,
335988,1,16,8,
335988,1,17,14,
335988,1,18,17,
335988,1,19,15,
335988,1,20,25,
335988,2,1,9,
335988,2,2,7,
335988,2,3,11,
335988,2,4,10,
335988,2,5,10,
335988,2,6,14,
335988,2,7,5,1.0
335988,2,8,15,
335988,2,9,12,
335988,2,10,13,
335988,2,11,5,
335988,2,12,12,
335988,2,13,12,2.0
335988,2,14,9,
335988,2,15,13,
335988,2,16,10,1.0
335988,2,17,9,1.0
335988,2,18,4,1.0
335988,2,19,7,
335988,2,20,9,
335989,1,1,6,
335989,1,2,10,
335989,1,3,0,
335989,1,4,10,
335989,1,5,6,
335989,1,6,2,1.0
335989,1,7,4,
335989,1,8,3,1.0
335989,1,9,2,1.0
335989,1,10,5,1.0
335989,1,11,2,
335989,1,12,12,
335989,1,13,7,
335989,1,14,7,
335989,1,15,9,
335989,1,16,10,
335989,1,17,4,
335989,1,18,1,
335989,1,19,10,
335989,1,20,8,
335989,2,1,8,
335989,2,2,12,
335989,2,3,5,
335989,2,4,10,

2025-02-10 16:02:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:08 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:09 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "bowler"
    FROM IPL.IPL.BALL_BY_BALL
    ORDER BY "match_id", "innings_no", "over_id", "ball_id"
    LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,bowler
335987,1,1,2,14
335987,1,1,3,14
335987,1,1,4,14
335987,1,1,5,14
335987,1,1,6,14
335987,1,1,7,14
335987,1,2,1,15
335987,1,2,2,15
335987,1,2,3,15
335987,1,2,4,15
335987,1,2,5,15
335987,1,2,6,15
335987,1,3,1,14
335987,1,3,2,14
335987,1,3,3,14
335987,1,3,4,14
335987,1,3,5,14
335987,1,3,6,14
335987,1,4,1,13
335987,1,4,2,13
335987,1,4,3,13
335987,1,4,4,13
335987,1,4,5,13
335987,1,4,6,13
335987,1,4,7,13
335987,1,5,1,14
335987,1,5,2,14
335987,1,5,3,14
335987,1,5,4,14
335987,1,5,5,14
335987,1,5,6,14
335987,1,6,1,15
335987,1,6,2,15
335987,1,6,3,15
335987,1,6,4,15
335987,1,6,5,15
335987,1,6,6,15
335987,1,7,1,13
335987,1,7,2,13
335987,1,7,3,13
335987,1,7,4,13
335987,1,7,5,13
335987,1,7,6,13
335987,1,8,1,15
335987,1,8,2,15
335987,1,8,3,15
335987,1,8,4,15
335987,1,8,5,15
335987,1,8,6,15
335987,1,9,1,9
335987,1,9,2,9
335987,1,9,3,9
335987,1,9,4,9
335987,1,9,5,9
335987,1,9,6,9
335987,1,10,1,16
335987,1,10,2,16
335987,1,10,3,16
335987,1,10,4,16
335987,1,10,5,16
335987,1,10,6,16
335987,1,11,1,9
335987,1,11,2,9
335987,1,11,3,9
335987,1,11,4,9
335987,1,11,5,9
335987,1,11,6,9
335987,1,12,1,16
335987,1,12,2,16
335987,1,12,3,16
335987,1,12,4,16
335987,1,12,5,16
335987,1,12,6,16
335987,1,13,1,9
335987,1,13,2,9
335987,1,13,3,9
335987,1,13,4,9
335987,1,13,5,9
335987,1,13,6,9
335987,1,13,7,9
335987,1,14,1,16
335987,1,14,2,16
335987,1,14,3,16
335987,1,14,4,16
335987,1,14,5,16
335987,1,14,6,16
335987,1,15,1,10
335987,1,15,2,10
335987,1,15,3,10
335987,1,15,4,10
335987,1,15,5,10
335987,1,15,6,10
335987,1,15,7,10
335987,1,16,1,13
335987,1,16,2,13
335987,1,16,3,13
335987,1,16,4,13
335987,1,16,5,13
335987,1,16,6,13
335987,1,17,1,15

2025-02-10 16:02:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:10 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:11 - root - INFO - SQL:
SELECT bb."bowler", SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "runs_conceded"
    FROM IPL.IPL.BALL_BY_BALL bb
    LEFT JOIN IPL.IPL.BATSMAN_SCORED bs
      ON bb."match_id" = bs."match_id"
      AND bb."innings_no" = bs."innings_no"
      AND bb."over_id" = bs."over_id"
      AND bb."ball_id" = bs."ball_id"
    LEFT JOIN IPL.IPL.EXTRA_RUNS er
      ON bb."match_id" = er."match_id"
      AND bb."innings_no" = er."innings_no"
      AND bb."over_id" = er."over_id"
      AND bb."ball_id" = er."ball_id"
    GROUP BY bb."bowler"
    ORDER BY "runs_conceded" DESC
    LIMIT 100;
Results:
bowler,runs_conceded
14,3187
50,3184
67,3082
136,2939
81,2842
71,2815
194,2641
29,2613
15,2537
201,2519
131,2399
109,2386
61,2363
9,2344
232,2333
94,2323
73,2308
35,2181
32,2178
190,2063
151,2053
84,2036
299,2020
89,1975
39,1944
106,1943
221,1755
121,1714
80,1701
364,1676
126,1637
315,1634
310,1468
38,1440
186,1422
83,1390
31,1351
357,1336
120,1265
382,1223
77,1221
367,1194
374,1188
293,1187
82,1160
166,1140
66,1126
235,1096
124,1089
188,1085
296,1080
276,1066
140,1052
333,1045
191,1038
27,1019
21,1018
350,1017
280,1010
116,993
163,992
375,977
346,950
311,924
334,917
175,894
403,844
223,815
192,814
154,811
377,798
309,789
270,779
370,774
256,747
267,731
248,716
162,714
347,712
321,707
56,694
378,690
147,674
238,668
356,655
258,653
196,639
386,632
359,609
322,600
316,585
255,582
25,562
210,558
78,549
90,532
153,515
246,515
177,515
91,511

2025-02-10 16:02:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:12 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:12 - root - INFO - SQL:
SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
    FROM (
      SELECT bs."match_id", bs."innings_no", bs."over_id",
             SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
             ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
      FROM IPL.IPL.BATSMAN_SCORED bs
      LEFT JOIN IPL.IPL.EXTRA_RUNS er
        ON bs."match_id" = er."match_id"
        AND bs."innings_no" = er."innings_no"
        AND bs."over_id" = er."over_id"
        AND bs."ball_id" = er."ball_id"
      GROUP BY bs."match_id", bs."innings_no", bs."over_id"
    ) sub
    WHERE sub."row_num" = 1
    ORDER BY sub."total_runs" DESC
    LIMIT 100;
Results:
match_id,innings_no,over_id,total_runs
501252,2,3,37
734052,2,6,33
548332,2,13,31
335993,2,13,30
980992,1,19,30
501265,1,15,30
598032,1,8,29
598065,2,17,29
392233,1,19,28
980912,1,19,28
548323,2,19,28
336020,1,19,27
548318,1,19,27
548344,2,19,27
729296,2,18,27
419144,1,13,26
734042,2,13,26
980928,1,14,26
335993,1,18,26
598034,1,1,26
729322,2,17,26
336023,2,14,26
734010,1,20,26
335997,2,14,26
419142,1,16,26
598042,1,20,26
598047,1,20,26
734012,1,5,26
501218,1,20,25
392233,2,20,25
336041,1,20,25
548385,1,19,25
729300,1,13,25
829800,1,17,25
548367,1,6,25
335988,1,20,25
829794,2,19,25
733988,2,3,25
501262,1,13,25
980936,2,18,25
419157,1,20,25
501246,1,19,25
501225,1,3,25
392242,2,6,25
392235,1,19,25
548353,1,18,25
733996,1,16,25
419112,2,12,25
598069,2,15,25
419117,2,13,25
548329,1,17,24
734052,1,4,24
829734,1,14,24
392219,1,15,24
829812,2,2,24
336031,1,20,24
501229,1,20,24
419134,2,5,24
548360,1,5,24
829742,1,17,24
598004,2,17,24
419138,2,3,24
548372,1,20,24
598072,1,19,24
980964,2,17,24
598059,1,18,24
392228,1,6,24
419128,1,19,24
734032,1,15,24
548381,2,2,24
336024,1,17,24
734034,1,20,24
829790,1,3,24
392207,1,18,24
733988,1,19,24
733982,2,19,24
981024,1,20,24
829828,1,17,23
548379,2,7,23
336001,1,19,23
419122,1,2,23
548347,1,11,23
392241,1,20,23
501248,2,8,23
501261,1,20,23
548316,1,20,23
501237,1,18,23
501272,2,20,23
548322,1,14,23
598056,1,17,23
336026,2,3,23
336024,2,14,23
392215,1,19,23
829796,2,14,23
980998,1,13,23
980986,1,18,23
548361,2,18,23
548338,1,18,23
419142,2,15,23
548349,2,19,23

2025-02-10 16:02:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:13 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:14 - root - INFO - SQL:
SELECT hso."match_id", hso."innings_no", hso."over_id", hso."total_runs", bb."bowler"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso
    JOIN IPL.IPL.BALL_BY_BALL bb
      ON hso."match_id" = bb."match_id"
      AND hso."innings_no" = bb."innings_no"
      AND hso."over_id" = bb."over_id"
    GROUP BY hso."match_id", hso."innings_no", hso."over_id", hso."total_runs", bb."bowler"
    ORDER BY hso."total_runs" DESC
    LIMIT 100;
Results:
match_id,innings_no,over_id,total_runs,bowler
501252,2,3,37,294
734052,2,6,33,333
548332,2,13,31,235
501265,1,15,30,268
980992,1,19,30,432
335993,2,13,30,56
598065,2,17,29,280
598032,1,8,29,254
980912,1,19,28,299
392233,1,19,28,61
392233,1,19,28,256
548323,2,19,28,8
729296,2,18,27,80
548318,1,19,27,256
548344,2,19,27,67
336020,1,19,27,38
548318,1,19,27,228
734010,1,20,26,342
734012,1,5,26,367
335993,1,18,26,90
336023,2,14,26,127
598042,1,20,26,4
419144,1,13,26,161
598034,1,1,26,50
335997,2,14,26,14
980928,1,14,26,228
734042,2,13,26,94
419142,1,16,26,226
729322,2,17,26,136
598047,1,20,26,106
733988,2,3,25,453
335988,1,20,25,25
392233,2,20,25,195
829794,2,19,25,322
501225,1,3,25,39
733996,1,16,25,311
419157,1,20,25,198
501218,1,20,25,106
729300,1,13,25,136
336041,1,20,25,32
501262,1,13,25,249
548367,1,6,25,299
501246,1,19,25,274
980936,2,18,25,311
419117,2,13,25,77
548385,1,19,25,296
548353,1,18,25,1
598069,2,15,25,61
419112,2,12,25,209
392242,2,6,25,41
829800,1,17,25,375
392235,1,19,25,126
829734,1,14,24,35
734052,1,4,24,359
548360,1,5,24,126
419134,2,5,24,226
548381,2,2,24,120
598059,1,18,24,232
392207,1,18,24,137
392228,1,6,24,179
419128,1,19,24,151
733982,2,19,24,94
392219,1,15,24,78
734032,1,15,24,382
336031,1,20,24,89
734034,1,20,24,94
501229,1,20,24,258
598004,2,17,24,258
598072,1,19,24,232
829812,2,2,24,299
392207,1,18,24,160
981024,1,20,24,32
829790,1,3,24,367
829742,1,17,24,246
980964,2,17,24,32
733988,1,19,24,296
548372,1,20,24,126
548329,1,17,24,81
336024,1,17,24,75
419138,2,3,24,14
829716,1,12,23,84
501237,1,18,23,282
336001,1,19,23,94
336014,2,14,23,41
548349,2,19,23,89
501248,2,8,23,290
548347,1,11,23,221
501260,2,2,23,346
548361,2,18,23,94
548316,1,20,23,120
980986,1,18,23,221
598056,1,17,23,84
734038,1,19,23,310
392241,1,20,23,61
829796,2,14,23,374
501272,2,20,23,151
419122,1,2,23,77
392215,1,19,23,77
335999,2,7,23,49
548379,2,7,23,333

2025-02-10 16:02:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:02:15 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:15 - root - INFO - SQL:
SELECT AVG(hso."total_runs") AS "average_highest_over_total"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso;
Results:
average_highest_over_total
17.125880

2025-02-10 16:02:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:02:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:02:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:02:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:02:16 - snowflake.connector.connection - INFO - closed
2025-02-10 16:02:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:02:17 - root - INFO - SQL:
SELECT DISTINCT bb."bowler"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso
    JOIN IPL.IPL.BALL_BY_BALL bb
      ON hso."match_id" = bb."match_id"
      AND hso."innings_no" = bb."innings_no"
      AND hso."over_id" = bb."over_id"
    LIMIT 100;
Results:
bowler
73
60
39
126
14
120
86
77
111
31
151
155
82
195
199
198
259
314
90
70
59
61
439
136
15
50
222
232
246
191
192
258
299
266
325
309
349
408
400
117
223
147
280
452
375
422
12
162
188
217
230
190
296
372
388
244
218
213
238
161
235
278
307
335
315
358
368
391
395
401
412
462
35
154
284
382
418
140
328
10
435
25
32
175
4
58
78
149
44
108
127
106
440
294
447
166
376
305
99
124

2025-02-10 16:02:17 - root - INFO - itercount: 0
2025-02-10 16:02:17 - root - INFO - Database Name: IPL
Schema Name: IPL
,0
table_name,PLAYER_MATCH
description,
DDL,"create or replace TABLE PLAYER_MATCH (
	""match_id"" NUMBER(38,0),
	""player_id"" NUMBER(38,0),
	""role"" VARCHAR(16777216),
	""team_id"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,1
table_name,PLAYER
description,
DDL,"create or replace TABLE PLAYER (
	""player_id"" NUMBER(38,0),
	""player_name"" VARCHAR(16777216),
	""dob"" VARCHAR(16777216),
	""batting_hand"" VARCHAR(16777216),
	""bowling_skill"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216)
);"

Database Name: IPL
Schema Name: IPL
,2
table_name,BATSMAN_SCORED
description,
DDL,"create or replace TABLE BATSMAN_SCORED (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""runs_scored"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,3
table_name,WICKET_TAKEN
description,
DDL,"create or replace TABLE WICKET_TAKEN (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""player_out"" NUMBER(38,0),
	""kind_out"" VARCHAR(16777216),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,4
table_name,BALL_BY_BALL
description,
DDL,"create or replace TABLE BALL_BY_BALL (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0),
	""team_batting"" NUMBER(38,0),
	""team_bowling"" NUMBER(38,0),
	""striker_batting_position"" NUMBER(38,0),
	""striker"" NUMBER(38,0),
	""non_striker"" NUMBER(38,0),
	""bowler"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,5
table_name,EXTRA_RUNS
description,
DDL,"create or replace TABLE EXTRA_RUNS (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""extra_type"" VARCHAR(16777216),
	""extra_runs"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,6
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""match_id"" NUMBER(38,0),
	""team_1"" NUMBER(38,0),
	""team_2"" NUMBER(38,0),
	""match_date"" VARCHAR(16777216),
	""season_id"" NUMBER(38,0),
	""venue"" VARCHAR(16777216),
	""toss_winner"" NUMBER(38,0),
	""toss_decision"" VARCHAR(16777216),
	""win_type"" VARCHAR(16777216),
	""win_margin"" NUMBER(38,0),
	""outcome_type"" VARCHAR(16777216),
	""match_winner"" NUMBER(38,0),
	""man_of_the_match"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,7
table_name,TEAM
description,
DDL,"create or replace TABLE TEAM (
	""team_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'IPL': {'IPL': ['PLAYER_MATCH', 'PLAYER', 'BATSMAN_SCORED', 'WICKET_TAKEN', 'BALL_BY_BALL', 'EXTRA_RUNS', 'MATCH', 'TEAM']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **BATSMAN_SCORED**
   - `"match_id"`: To identify each match.
   - `"innings_no"`: To distinguish between different innings in a match.
   - `"over_id"`: To group runs by each over.
   - `"ball_id"`: To associate runs with specific deliveries.
   - `"runs_scored"`: Runs scored by the batsman on each ball.

2. **EXTRA_RUNS**
   - `"match_id"`: To identify each match.
   - `"innings_no"`: To distinguish between different innings in a match.
   - `"over_id"`: To group extra runs by each over.
   - `"ball_id"`: To associate extra runs with specific deliveries.
   - `"extra_runs"`: Additional runs awarded (e.g., wides, no-balls).

3. **BALL_BY_BALL**
   - `"match_id"`: To identify each match.
   - `"innings_no"`: To distinguish between different innings.
   - `"over_id"`: To link bowlers to specific overs.
   - `"ball_id"`: To associate bowlers with specific deliveries.
   - `"bowler"`: To retrieve the bowler for each delivery.

**Conditions That May Be Used:**
- Joining tables on `"match_id"`, `"innings_no"`, `"over_id"`, and `"ball_id"` to combine runs and bowler details.
- Grouping data by `"match_id"`, `"innings_no"`, and `"over_id"` to calculate total runs per over.
- Using `DISTINCT` to retrieve unique values (e.g., unique match IDs or bowlers).
- Applying `LIMIT` to control the number of rows in the result.
- Utilizing aggregation functions like `SUM` to calculate total runs.
- Ordering results using `ORDER BY` to sort data (e.g., highest runs).

---

**SQL Queries:**

1. **Query 1: Retrieve sample runs scored from `BATSMAN_SCORED`**

   ```sql
   SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
   FROM IPL.IPL.BATSMAN_SCORED
   LIMIT 100;
   ```

2. **Query 2: Retrieve sample extra runs from `EXTRA_RUNS`**

   ```sql
   SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_runs", "extra_type"
   FROM IPL.IPL.EXTRA_RUNS
   LIMIT 100;
   ```

3. **Query 3: Retrieve sample bowler details from `BALL_BY_BALL`**

   ```sql
   SELECT "match_id", "innings_no", "over_id", "ball_id", "bowler"
   FROM IPL.IPL.BALL_BY_BALL
   LIMIT 100;
   ```

4. **Query 4: Get distinct match IDs from `BATSMAN_SCORED`**

   ```sql
   SELECT DISTINCT "match_id"
   FROM IPL.IPL.BATSMAN_SCORED
   LIMIT 100;
   ```

5. **Query 5: Calculate total runs scored per match**

   ```sql
   SELECT "match_id", SUM("runs_scored") AS "total_runs"
   FROM IPL.IPL.BATSMAN_SCORED
   GROUP BY "match_id"
   ORDER BY "total_runs" DESC
   LIMIT 100;
   ```

6. **Query 6: Calculate total extra runs per match**

   ```sql
   SELECT "match_id", SUM("extra_runs") AS "total_extra_runs"
   FROM IPL.IPL.EXTRA_RUNS
   GROUP BY "match_id"
   ORDER BY "total_extra_runs" DESC
   LIMIT 100;
   ```

7. **Query 7: Retrieve total runs per over from `BATSMAN_SCORED`**

   ```sql
   SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_this_over"
   FROM IPL.IPL.BATSMAN_SCORED
   GROUP BY "match_id", "innings_no", "over_id"
   ORDER BY "runs_this_over" DESC
   LIMIT 100;
   ```

8. **Query 8: Retrieve total extra runs per over from `EXTRA_RUNS`**

   ```sql
   SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs_this_over"
   FROM IPL.IPL.EXTRA_RUNS
   GROUP BY "match_id", "innings_no", "over_id"
   ORDER BY "extra_runs_this_over" DESC
   LIMIT 100;
   ```

9. **Query 9: Combine runs and extra runs per over**

   ```sql
   SELECT bs."match_id", bs."innings_no", bs."over_id",
          SUM(bs."runs_scored") AS "total_batsman_runs",
          SUM(er."extra_runs") AS "total_extra_runs"
   FROM IPL.IPL.BATSMAN_SCORED bs
   LEFT JOIN IPL.IPL.EXTRA_RUNS er
     ON bs."match_id" = er."match_id"
     AND bs."innings_no" = er."innings_no"
     AND bs."over_id" = er."over_id"
     AND bs."ball_id" = er."ball_id"
   GROUP BY bs."match_id", bs."innings_no", bs."over_id"
   ORDER BY bs."match_id", bs."innings_no", bs."over_id"
   LIMIT 100;
   ```

10. **Query 10: Retrieve bowler for each delivery**

    ```sql
    SELECT "match_id", "innings_no", "over_id", "ball_id", "bowler"
    FROM IPL.IPL.BALL_BY_BALL
    ORDER BY "match_id", "innings_no", "over_id", "ball_id"
    LIMIT 100;
    ```

11. **Query 11: Get total runs conceded by each bowler**

    ```sql
    SELECT bb."bowler", SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "runs_conceded"
    FROM IPL.IPL.BALL_BY_BALL bb
    LEFT JOIN IPL.IPL.BATSMAN_SCORED bs
      ON bb."match_id" = bs."match_id"
      AND bb."innings_no" = bs."innings_no"
      AND bb."over_id" = bs."over_id"
      AND bb."ball_id" = bs."ball_id"
    LEFT JOIN IPL.IPL.EXTRA_RUNS er
      ON bb."match_id" = er."match_id"
      AND bb."innings_no" = er."innings_no"
      AND bb."over_id" = er."over_id"
      AND bb."ball_id" = er."ball_id"
    GROUP BY bb."bowler"
    ORDER BY "runs_conceded" DESC
    LIMIT 100;
    ```

12. **Query 12: Identify the highest scoring over in each innings of each match**

    ```sql
    SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
    FROM (
      SELECT bs."match_id", bs."innings_no", bs."over_id",
             SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
             ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
      FROM IPL.IPL.BATSMAN_SCORED bs
      LEFT JOIN IPL.IPL.EXTRA_RUNS er
        ON bs."match_id" = er."match_id"
        AND bs."innings_no" = er."innings_no"
        AND bs."over_id" = er."over_id"
        AND bs."ball_id" = er."ball_id"
      GROUP BY bs."match_id", bs."innings_no", bs."over_id"
    ) sub
    WHERE sub."row_num" = 1
    ORDER BY sub."total_runs" DESC
    LIMIT 100;
    ```

13. **Query 13: Retrieve bowler for the highest scoring over in each innings of each match**

    ```sql
    SELECT hso."match_id", hso."innings_no", hso."over_id", hso."total_runs", bb."bowler"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso
    JOIN IPL.IPL.BALL_BY_BALL bb
      ON hso."match_id" = bb."match_id"
      AND hso."innings_no" = bb."innings_no"
      AND hso."over_id" = bb."over_id"
    GROUP BY hso."match_id", hso."innings_no", hso."over_id", hso."total_runs", bb."bowler"
    ORDER BY hso."total_runs" DESC
    LIMIT 100;
    ```

14. **Query 14: Calculate the average of the highest over totals across all matches**

    ```sql
    SELECT AVG(hso."total_runs") AS "average_highest_over_total"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso;
    ```

15. **Query 15: List distinct bowlers who delivered the highest scoring overs**

    ```sql
    SELECT DISTINCT bb."bowler"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso
    JOIN IPL.IPL.BALL_BY_BALL bb
      ON hso."match_id" = bb."match_id"
      AND hso."innings_no" = bb."innings_no"
      AND hso."over_id" = bb."over_id"
    LIMIT 100;
    ```

These queries progressively explore the data related to the task, starting from simple data retrieval to more complex aggregations and joins. They help understand how runs (both batsman and extra runs) are recorded, how they can be aggregated per over, and how to associate bowlers with overs to ultimately compute the average of the highest over totals across all matches.

Please note that these queries are designed to gain an understanding of the data and may need to be adjusted based on actual data and desired results.Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
   FROM IPL.IPL.BATSMAN_SCORED
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,runs_scored
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,0
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,0
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,0
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,0
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,0
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,0
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0
Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_runs", "extra_type"
   FROM IPL.IPL.EXTRA_RUNS
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,extra_runs,extra_type
501229,1,16,3,1,legbyes
501229,2,18,1,1,legbyes
501229,2,18,6,4,legbyes
392239,2,18,6,1,legbyes
501229,1,20,3,1,legbyes
501230,1,1,4,4,legbyes
829714,1,18,4,1,legbyes
829816,2,3,3,1,legbyes
501230,2,3,4,1,legbyes
829816,1,2,3,4,legbyes
980962,2,18,2,1,legbyes
829714,2,18,1,1,legbyes
829714,1,9,6,1,legbyes
501231,2,1,1,1,legbyes
335994,2,4,6,1,legbyes
501231,2,2,6,1,legbyes
829714,1,9,3,2,legbyes
980962,2,17,5,2,legbyes
336045,2,3,5,4,legbyes
392240,1,3,7,1,legbyes
336045,1,4,1,1,legbyes
829714,1,3,6,1,legbyes
501231,2,20,5,1,legbyes
501232,2,1,1,1,legbyes
501232,1,1,2,1,legbyes
336045,1,8,3,1,legbyes
336017,2,4,4,1,legbyes
829814,1,18,1,1,legbyes
501232,2,4,3,1,legbyes
501232,1,4,6,1,legbyes
501232,2,7,2,1,legbyes
829714,1,1,1,4,legbyes
336045,2,9,3,1,legbyes
501232,2,14,3,1,legbyes
501232,1,14,7,1,legbyes
829712,1,18,5,1,legbyes
829712,1,3,1,4,legbyes
829712,1,2,6,1,legbyes
392240,1,10,2,2,legbyes
829712,1,1,3,4,legbyes
392240,1,11,2,1,legbyes
335991,1,2,1,1,legbyes
980962,2,14,1,1,legbyes
335988,2,17,1,1,legbyes
392240,1,13,3,1,legbyes
829814,1,14,3,1,legbyes
501232,1,20,7,1,legbyes
829812,1,4,5,1,legbyes
392240,1,15,3,1,legbyes
980960,1,7,5,1,legbyes
829710,2,4,2,1,legbyes
501233,2,6,1,1,legbyes
501233,2,6,3,1,legbyes
981018,2,2,1,1,legbyes
336045,2,18,8,1,legbyes
501233,1,13,1,1,legbyes
829812,1,1,4,1,legbyes
392241,2,3,6,1,legbyes
392241,2,4,6,1,legbyes
981018,1,1,3,1,legbyes
829810,1,12,6,1,legbyes
501234,2,2,1,1,legbyes
980958,1,3,2,1,legbyes
829710,1,1,5,1,legbyes
829710,2,1,3,1,legbyes
392241,2,8,3,1,legbyes
980956,1,20,3,1,legbyes
336017,2,7,5,1,legbyes
392186,1,2,1,1,legbyes
501234,2,14,5,2,legbyes
501234,1,16,2,1,legbyes
336001,2,20,3,1,legbyes
734054,1,19,6,1,legbyes
392186,2,6,1,4,legbyes
392241,1,19,4,1,legbyes
392186,2,6,2,1,legbyes
980986,1,18,2,1,legbyes
392186,2,10,3,1,legbyes
501235,1,12,3,1,legbyes
734054,1,17,6,1,legbyes
829808,1,9,2,1,legbyes
335994,1,9,3,1,legbyes
829808,2,8,2,2,legbyes
829808,2,7,3,1,legbyes
829808,2,7,1,1,legbyes
734054,1,13,2,1,legbyes
501235,1,18,4,1,legbyes
980956,1,16,2,1,legbyes
335994,1,10,2,1,legbyes
335991,2,2,5,4,legbyes
501236,1,13,2,1,legbyes
392187,1,2,2,1,legbyes
501236,1,13,5,1,legbyes
501236,1,15,1,1,legbyes
829808,2,3,1,1,legbyes
501236,2,17,2,1,legbyes
392243,1,4,4,1,legbyes
829806,1,19,6,1,legbyes
392243,2,10,1,1,legbyes
501237,2,5,6,1,legbyes
Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "bowler"
   FROM IPL.IPL.BALL_BY_BALL
   LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,bowler
335987,2,1,1,106
335987,1,1,2,14
335987,2,1,2,106
335987,1,1,3,14
335987,2,1,3,106
335987,1,1,4,14
335987,2,1,4,106
335987,1,1,5,14
335987,2,1,5,106
335987,1,1,6,14
335987,2,1,6,106
335987,1,1,7,14
335987,2,1,7,106
335987,1,2,1,15
335987,2,2,1,84
335987,1,2,2,15
335987,2,2,2,84
335987,1,2,3,15
335987,2,2,3,84
335987,1,2,4,15
335987,2,2,4,84
335987,1,2,5,15
335987,2,2,5,84
335987,1,2,6,15
335987,2,2,6,84
335987,1,3,1,14
335987,2,3,1,106
335987,1,3,2,14
335987,2,3,2,106
335987,1,3,3,14
335987,2,3,3,106
335987,1,3,4,14
335987,2,3,4,106
335987,1,3,5,14
335987,2,3,5,106
335987,1,3,6,14
335987,2,3,6,106
335987,2,3,7,106
335987,1,4,1,13
335987,2,4,1,84
335987,1,4,2,13
335987,2,4,2,84
335987,1,4,3,13
335987,2,4,3,84
335987,1,4,4,13
335987,2,4,4,84
335987,1,4,5,13
335987,2,4,5,84
335987,1,4,6,13
335987,2,4,6,84
335987,1,4,7,13
335987,1,5,1,14
335987,2,5,1,82
335987,1,5,2,14
335987,2,5,2,82
335987,1,5,3,14
335987,2,5,3,82
335987,1,5,4,14
335987,2,5,4,82
335987,1,5,5,14
335987,2,5,5,82
335987,1,5,6,14
335987,2,5,6,82
335987,1,6,1,15
335987,2,6,1,106
335987,1,6,2,15
335987,2,6,2,106
335987,1,6,3,15
335987,2,6,3,106
335987,1,6,4,15
335987,2,6,4,106
335987,1,6,5,15
335987,2,6,5,106
335987,1,6,6,15
335987,2,6,6,106
335987,1,7,1,13
335987,2,7,1,82
335987,1,7,2,13
335987,2,7,2,82
335987,1,7,3,13
335987,2,7,3,82
335987,1,7,4,13
335987,2,7,4,82
335987,1,7,5,13
335987,2,7,5,82
335987,1,7,6,13
335987,2,7,6,82
335987,2,7,7,82
335987,2,7,8,82
335987,1,8,1,15
335987,2,8,1,1
335987,1,8,2,15
335987,2,8,2,1
335987,1,8,3,15
335987,2,8,3,1
335987,1,8,4,15
335987,2,8,4,1
335987,1,8,5,15
335987,2,8,5,1
335987,1,8,6,15
Query:
SELECT DISTINCT "match_id"
   FROM IPL.IPL.BATSMAN_SCORED
   LIMIT 100;
Answer:
match_id
335987
335988
335989
335990
335991
335992
335993
335994
335995
335996
335998
335999
336000
336002
336004
336006
336008
336010
336017
336018
336019
336020
336024
336028
336030
336036
336044
392193
392202
392216
419117
419128
419141
419143
419149
501203
501207
501230
336003
336015
336037
336039
392186
392194
392214
392215
392221
392233
392236
392241
419114
419124
419150
419152
419153
419158
501211
501212
501221
419138
501214
501259
501264
335997
336005
336007
336009
336012
336013
336023
336031
336034
336042
392188
392201
392205
392220
392225
392235
419131
419142
419166
336014
336016
336033
336040
336041
336043
336045
392189
392190
392196
392197
392200
392204
392206
392210
392218
392223
392224
Query:
SELECT "match_id", SUM("runs_scored") AS "total_runs"
   FROM IPL.IPL.BATSMAN_SCORED
   GROUP BY "match_id"
   ORDER BY "total_runs" DESC
   LIMIT 100;
Answer:
match_id,total_runs
419142,448
335988,430
829800,420
335995,418
501228,412
733992,404
734052,401
419112,399
548377,398
734012,397
336038,396
336024,392
548323,391
729288,391
980912,391
419144,386
981024,385
734054,385
419117,384
598032,381
335994,379
980954,377
501211,375
548331,374
829792,373
980974,373
734046,372
419164,372
729296,369
734004,367
548371,367
548386,367
829742,367
336025,365
980958,365
548347,364
598069,363
598039,363
548334,362
734034,361
598030,360
980926,360
501218,359
336019,358
548322,357
336003,356
419121,355
598056,355
980914,355
829720,355
548332,354
598011,354
981000,354
548361,354
598031,354
829734,354
829816,353
829804,353
729306,353
392194,353
336014,352
392236,352
980964,351
829796,351
598046,351
829778,350
829828,350
598065,348
419150,347
392219,347
980996,347
829716,347
980952,346
598059,346
598052,346
829774,345
980942,345
548338,344
419141,344
734032,343
336037,343
733996,343
980946,343
829718,342
548353,342
336033,342
548385,341
829782,341
336036,340
980982,340
598047,339
980936,338
734050,338
501215,338
734010,337
980950,337
733986,337
501276,337
980976,336
598050,335
Query:
SELECT "match_id", SUM("extra_runs") AS "total_extra_runs"
   FROM IPL.IPL.EXTRA_RUNS
   GROUP BY "match_id"
   ORDER BY "total_extra_runs" DESC
   LIMIT 100;
Answer:
match_id,total_extra_runs
419137,38
335991,38
501265,36
335987,36
829816,36
419158,35
336033,35
733988,35
392240,33
829742,33
336028,32
829724,32
548382,32
419147,32
501259,31
501232,31
392232,31
335994,31
548362,30
829714,30
829728,30
548358,29
336041,29
548341,29
392205,28
419119,28
336010,28
336020,28
336029,28
336023,28
419130,28
501215,28
336002,28
729322,27
734052,27
392197,27
336011,27
501256,27
419111,27
981018,27
336042,27
734042,26
336005,26
829716,26
335998,26
392236,25
729294,25
419128,25
392230,25
548366,25
501246,25
501243,25
548314,25
501261,25
548372,25
598077,24
392227,24
419132,24
981006,24
336021,24
501226,24
419154,24
419133,24
419168,24
598004,24
734016,24
501238,24
336017,24
501205,24
829782,23
419167,23
419117,23
392200,23
598074,23
980908,23
419170,23
548318,23
501214,23
392231,23
419150,23
980926,23
392206,23
598068,23
981024,23
980964,23
392215,23
598039,23
980956,23
336014,23
419166,22
729318,22
548325,22
419146,22
419131,22
733994,22
733986,22
501272,22
501273,22
734044,22
419153,22
Query:
SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "runs_this_over"
   FROM IPL.IPL.BATSMAN_SCORED
   GROUP BY "match_id", "innings_no", "over_id"
   ORDER BY "runs_this_over" DESC
   LIMIT 100;
Answer:
match_id,innings_no,over_id,runs_this_over
501252,2,3,36
734052,2,6,32
548332,2,13,31
980992,1,19,30
335993,2,13,30
501265,1,15,30
598032,1,8,29
598065,2,17,29
980992,1,18,29
598032,1,5,28
548323,2,19,28
980912,1,19,27
548344,2,19,27
336020,1,19,27
729296,2,18,27
598032,1,15,27
734042,2,13,26
392233,1,19,26
336023,2,14,26
419142,1,16,26
980928,1,14,26
335997,2,14,26
729322,2,17,26
335993,1,18,26
598047,1,20,26
419144,1,13,26
598042,1,20,26
733988,2,3,25
980936,2,18,25
598034,1,1,25
335988,1,20,25
419112,2,12,25
548367,1,6,25
729300,1,13,25
419157,1,20,25
733996,1,16,25
734010,1,20,25
501218,1,20,25
419117,2,13,25
598069,2,15,25
501262,1,13,25
981024,1,20,24
548332,2,20,24
548329,1,17,24
829812,2,2,24
598059,1,18,24
336031,1,20,24
548353,1,19,24
336041,1,20,24
829734,1,14,24
829742,1,17,24
548318,1,19,24
548329,1,14,24
501225,1,3,24
392235,1,19,24
734012,1,5,24
734034,1,20,24
392242,2,6,24
734032,1,15,24
392228,1,6,24
733988,1,19,24
548372,1,20,24
392219,1,15,24
419134,2,5,24
980964,2,17,24
419128,1,19,24
829794,2,19,24
419138,2,3,24
548353,1,18,24
501246,1,19,24
734012,1,19,24
829800,1,17,24
548381,2,2,24
501261,1,20,23
336024,2,14,23
829796,2,14,23
336024,1,17,23
501248,2,8,23
548379,2,7,23
419142,2,15,23
548349,2,19,23
548360,1,5,23
548385,1,19,23
598056,1,17,23
548361,2,18,23
598004,2,17,23
335999,2,7,23
392233,2,20,23
734052,1,4,23
419117,2,18,23
501260,2,2,23
392241,1,20,23
501272,2,20,23
829790,1,3,23
501229,1,20,23
392207,1,18,23
336001,1,19,23
733982,2,19,23
733992,1,20,23
829790,1,15,23
Query:
SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs_this_over"
   FROM IPL.IPL.EXTRA_RUNS
   GROUP BY "match_id", "innings_no", "over_id"
   ORDER BY "extra_runs_this_over" DESC
   LIMIT 100;
Answer:
match_id,innings_no,over_id,extra_runs_this_over
598039,2,1,12
336010,2,7,12
335991,2,12,11
548337,1,15,10
598047,1,10,10
335993,2,12,9
980964,2,14,9
829790,2,1,8
548334,2,7,8
501243,2,1,8
729294,1,1,8
598077,1,20,8
548382,2,7,8
829714,1,9,8
419144,1,13,7
501227,1,1,7
501218,2,6,7
501275,1,1,7
392215,2,8,7
336031,1,2,7
392191,1,12,7
829724,2,17,7
419119,1,10,7
734038,1,20,7
829716,1,3,7
548358,1,4,7
548362,2,17,7
829728,1,1,7
336033,2,1,7
981006,2,7,7
419117,2,4,7
734018,2,7,7
548331,1,4,7
392224,2,4,6
335987,1,4,6
980934,2,2,6
419154,1,7,6
980906,1,6,6
598072,2,1,6
501259,1,1,6
598066,2,1,6
829744,1,7,6
501269,1,2,6
598066,2,2,6
981008,2,1,6
980994,2,5,6
981018,2,1,6
598055,1,20,6
336029,1,19,6
501215,1,2,6
501257,1,19,6
548364,2,6,6
829758,1,7,6
980926,2,1,6
548353,1,17,6
829770,1,10,6
829742,1,2,6
392240,2,11,6
501228,1,6,6
980936,1,16,6
598051,2,14,6
980956,2,10,6
548344,1,14,6
598011,2,13,6
419147,1,3,6
336007,1,1,6
548366,2,19,6
501276,1,4,6
419124,1,3,6
419153,2,9,6
829724,1,7,6
419158,1,18,6
598074,2,13,6
419139,1,18,6
392230,2,9,6
392186,2,6,6
501214,1,20,6
392209,2,18,6
501259,1,8,6
392202,1,3,6
501246,1,6,6
501264,2,4,6
548335,2,16,6
501229,2,8,6
336034,2,3,6
419166,2,13,6
501205,1,13,6
336017,2,5,6
419153,1,7,6
829780,2,1,6
733994,1,20,6
733988,1,8,6
501212,1,20,6
501232,2,3,6
336002,2,9,5
335994,1,12,5
336045,2,3,5
501229,2,18,5
335998,2,16,5
501258,2,6,5
Query:
SELECT bs."match_id", bs."innings_no", bs."over_id",
          SUM(bs."runs_scored") AS "total_batsman_runs",
          SUM(er."extra_runs") AS "total_extra_runs"
   FROM IPL.IPL.BATSMAN_SCORED bs
   LEFT JOIN IPL.IPL.EXTRA_RUNS er
     ON bs."match_id" = er."match_id"
     AND bs."innings_no" = er."innings_no"
     AND bs."over_id" = er."over_id"
     AND bs."ball_id" = er."ball_id"
   GROUP BY bs."match_id", bs."innings_no", bs."over_id"
   ORDER BY bs."match_id", bs."innings_no", bs."over_id"
   LIMIT 100;
Answer:
match_id,innings_no,over_id,total_batsman_runs,total_extra_runs
335987,1,1,0,1.0
335987,1,2,18,
335987,1,3,5,1.0
335987,1,4,17,1.0
335987,1,5,10,
335987,1,6,1,
335987,1,7,7,
335987,1,8,5,
335987,1,9,4,
335987,1,10,10,
335987,1,11,11,4.0
335987,1,12,10,
335987,1,13,11,
335987,1,14,6,
335987,1,15,22,
335987,1,16,4,
335987,1,17,14,
335987,1,18,7,
335987,1,19,21,
335987,1,20,22,
335987,2,1,3,
335987,2,2,1,4.0
335987,2,3,2,
335987,2,4,3,1.0
335987,2,5,8,
335987,2,6,2,
335987,2,7,5,
335987,2,8,4,1.0
335987,2,9,3,
335987,2,10,6,1.0
335987,2,11,5,
335987,2,12,3,
335987,2,13,9,
335987,2,14,7,
335987,2,15,2,1.0
335987,2,16,0,
335988,1,1,5,
335988,1,2,14,
335988,1,3,6,1.0
335988,1,4,6,
335988,1,5,8,1.0
335988,1,6,11,
335988,1,7,9,
335988,1,8,8,
335988,1,9,13,
335988,1,10,5,
335988,1,11,19,
335988,1,12,20,
335988,1,13,4,
335988,1,14,9,1.0
335988,1,15,18,
335988,1,16,8,
335988,1,17,14,
335988,1,18,17,
335988,1,19,15,
335988,1,20,25,
335988,2,1,9,
335988,2,2,7,
335988,2,3,11,
335988,2,4,10,
335988,2,5,10,
335988,2,6,14,
335988,2,7,5,1.0
335988,2,8,15,
335988,2,9,12,
335988,2,10,13,
335988,2,11,5,
335988,2,12,12,
335988,2,13,12,2.0
335988,2,14,9,
335988,2,15,13,
335988,2,16,10,1.0
335988,2,17,9,1.0
335988,2,18,4,1.0
335988,2,19,7,
335988,2,20,9,
335989,1,1,6,
335989,1,2,10,
335989,1,3,0,
335989,1,4,10,
335989,1,5,6,
335989,1,6,2,1.0
335989,1,7,4,
335989,1,8,3,1.0
335989,1,9,2,1.0
335989,1,10,5,1.0
335989,1,11,2,
335989,1,12,12,
335989,1,13,7,
335989,1,14,7,
335989,1,15,9,
335989,1,16,10,
335989,1,17,4,
335989,1,18,1,
335989,1,19,10,
335989,1,20,8,
335989,2,1,8,
335989,2,2,12,
335989,2,3,5,
335989,2,4,10,
Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "bowler"
    FROM IPL.IPL.BALL_BY_BALL
    ORDER BY "match_id", "innings_no", "over_id", "ball_id"
    LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,bowler
335987,1,1,2,14
335987,1,1,3,14
335987,1,1,4,14
335987,1,1,5,14
335987,1,1,6,14
335987,1,1,7,14
335987,1,2,1,15
335987,1,2,2,15
335987,1,2,3,15
335987,1,2,4,15
335987,1,2,5,15
335987,1,2,6,15
335987,1,3,1,14
335987,1,3,2,14
335987,1,3,3,14
335987,1,3,4,14
335987,1,3,5,14
335987,1,3,6,14
335987,1,4,1,13
335987,1,4,2,13
335987,1,4,3,13
335987,1,4,4,13
335987,1,4,5,13
335987,1,4,6,13
335987,1,4,7,13
335987,1,5,1,14
335987,1,5,2,14
335987,1,5,3,14
335987,1,5,4,14
335987,1,5,5,14
335987,1,5,6,14
335987,1,6,1,15
335987,1,6,2,15
335987,1,6,3,15
335987,1,6,4,15
335987,1,6,5,15
335987,1,6,6,15
335987,1,7,1,13
335987,1,7,2,13
335987,1,7,3,13
335987,1,7,4,13
335987,1,7,5,13
335987,1,7,6,13
335987,1,8,1,15
335987,1,8,2,15
335987,1,8,3,15
335987,1,8,4,15
335987,1,8,5,15
335987,1,8,6,15
335987,1,9,1,9
335987,1,9,2,9
335987,1,9,3,9
335987,1,9,4,9
335987,1,9,5,9
335987,1,9,6,9
335987,1,10,1,16
335987,1,10,2,16
335987,1,10,3,16
335987,1,10,4,16
335987,1,10,5,16
335987,1,10,6,16
335987,1,11,1,9
335987,1,11,2,9
335987,1,11,3,9
335987,1,11,4,9
335987,1,11,5,9
335987,1,11,6,9
335987,1,12,1,16
335987,1,12,2,16
335987,1,12,3,16
335987,1,12,4,16
335987,1,12,5,16
335987,1,12,6,16
335987,1,13,1,9
335987,1,13,2,9
335987,1,13,3,9
335987,1,13,4,9
335987,1,13,5,9
335987,1,13,6,9
335987,1,13,7,9
335987,1,14,1,16
335987,1,14,2,16
335987,1,14,3,16
335987,1,14,4,16
335987,1,14,5,16
335987,1,14,6,16
335987,1,15,1,10
335987,1,15,2,10
335987,1,15,3,10
335987,1,15,4,10
335987,1,15,5,10
335987,1,15,6,10
335987,1,15,7,10
335987,1,16,1,13
335987,1,16,2,13
335987,1,16,3,13
335987,1,16,4,13
335987,1,16,5,13
335987,1,16,6,13
335987,1,17,1,15
Query:
SELECT bb."bowler", SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "runs_conceded"
    FROM IPL.IPL.BALL_BY_BALL bb
    LEFT JOIN IPL.IPL.BATSMAN_SCORED bs
      ON bb."match_id" = bs."match_id"
      AND bb."innings_no" = bs."innings_no"
      AND bb."over_id" = bs."over_id"
      AND bb."ball_id" = bs."ball_id"
    LEFT JOIN IPL.IPL.EXTRA_RUNS er
      ON bb."match_id" = er."match_id"
      AND bb."innings_no" = er."innings_no"
      AND bb."over_id" = er."over_id"
      AND bb."ball_id" = er."ball_id"
    GROUP BY bb."bowler"
    ORDER BY "runs_conceded" DESC
    LIMIT 100;
Answer:
bowler,runs_conceded
14,3187
50,3184
67,3082
136,2939
81,2842
71,2815
194,2641
29,2613
15,2537
201,2519
131,2399
109,2386
61,2363
9,2344
232,2333
94,2323
73,2308
35,2181
32,2178
190,2063
151,2053
84,2036
299,2020
89,1975
39,1944
106,1943
221,1755
121,1714
80,1701
364,1676
126,1637
315,1634
310,1468
38,1440
186,1422
83,1390
31,1351
357,1336
120,1265
382,1223
77,1221
367,1194
374,1188
293,1187
82,1160
166,1140
66,1126
235,1096
124,1089
188,1085
296,1080
276,1066
140,1052
333,1045
191,1038
27,1019
21,1018
350,1017
280,1010
116,993
163,992
375,977
346,950
311,924
334,917
175,894
403,844
223,815
192,814
154,811
377,798
309,789
270,779
370,774
256,747
267,731
248,716
162,714
347,712
321,707
56,694
378,690
147,674
238,668
356,655
258,653
196,639
386,632
359,609
322,600
316,585
255,582
25,562
210,558
78,549
90,532
153,515
246,515
177,515
91,511
Query:
SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
    FROM (
      SELECT bs."match_id", bs."innings_no", bs."over_id",
             SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
             ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
      FROM IPL.IPL.BATSMAN_SCORED bs
      LEFT JOIN IPL.IPL.EXTRA_RUNS er
        ON bs."match_id" = er."match_id"
        AND bs."innings_no" = er."innings_no"
        AND bs."over_id" = er."over_id"
        AND bs."ball_id" = er."ball_id"
      GROUP BY bs."match_id", bs."innings_no", bs."over_id"
    ) sub
    WHERE sub."row_num" = 1
    ORDER BY sub."total_runs" DESC
    LIMIT 100;
Answer:
match_id,innings_no,over_id,total_runs
501252,2,3,37
734052,2,6,33
548332,2,13,31
335993,2,13,30
980992,1,19,30
501265,1,15,30
598032,1,8,29
598065,2,17,29
392233,1,19,28
980912,1,19,28
548323,2,19,28
336020,1,19,27
548318,1,19,27
548344,2,19,27
729296,2,18,27
419144,1,13,26
734042,2,13,26
980928,1,14,26
335993,1,18,26
598034,1,1,26
729322,2,17,26
336023,2,14,26
734010,1,20,26
335997,2,14,26
419142,1,16,26
598042,1,20,26
598047,1,20,26
734012,1,5,26
501218,1,20,25
392233,2,20,25
336041,1,20,25
548385,1,19,25
729300,1,13,25
829800,1,17,25
548367,1,6,25
335988,1,20,25
829794,2,19,25
733988,2,3,25
501262,1,13,25
980936,2,18,25
419157,1,20,25
501246,1,19,25
501225,1,3,25
392242,2,6,25
392235,1,19,25
548353,1,18,25
733996,1,16,25
419112,2,12,25
598069,2,15,25
419117,2,13,25
548329,1,17,24
734052,1,4,24
829734,1,14,24
392219,1,15,24
829812,2,2,24
336031,1,20,24
501229,1,20,24
419134,2,5,24
548360,1,5,24
829742,1,17,24
598004,2,17,24
419138,2,3,24
548372,1,20,24
598072,1,19,24
980964,2,17,24
598059,1,18,24
392228,1,6,24
419128,1,19,24
734032,1,15,24
548381,2,2,24
336024,1,17,24
734034,1,20,24
829790,1,3,24
392207,1,18,24
733988,1,19,24
733982,2,19,24
981024,1,20,24
829828,1,17,23
548379,2,7,23
336001,1,19,23
419122,1,2,23
548347,1,11,23
392241,1,20,23
501248,2,8,23
501261,1,20,23
548316,1,20,23
501237,1,18,23
501272,2,20,23
548322,1,14,23
598056,1,17,23
336026,2,3,23
336024,2,14,23
392215,1,19,23
829796,2,14,23
980998,1,13,23
980986,1,18,23
548361,2,18,23
548338,1,18,23
419142,2,15,23
548349,2,19,23
Query:
SELECT hso."match_id", hso."innings_no", hso."over_id", hso."total_runs", bb."bowler"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso
    JOIN IPL.IPL.BALL_BY_BALL bb
      ON hso."match_id" = bb."match_id"
      AND hso."innings_no" = bb."innings_no"
      AND hso."over_id" = bb."over_id"
    GROUP BY hso."match_id", hso."innings_no", hso."over_id", hso."total_runs", bb."bowler"
    ORDER BY hso."total_runs" DESC
    LIMIT 100;
Answer:
match_id,innings_no,over_id,total_runs,bowler
501252,2,3,37,294
734052,2,6,33,333
548332,2,13,31,235
501265,1,15,30,268
980992,1,19,30,432
335993,2,13,30,56
598065,2,17,29,280
598032,1,8,29,254
980912,1,19,28,299
392233,1,19,28,61
392233,1,19,28,256
548323,2,19,28,8
729296,2,18,27,80
548318,1,19,27,256
548344,2,19,27,67
336020,1,19,27,38
548318,1,19,27,228
734010,1,20,26,342
734012,1,5,26,367
335993,1,18,26,90
336023,2,14,26,127
598042,1,20,26,4
419144,1,13,26,161
598034,1,1,26,50
335997,2,14,26,14
980928,1,14,26,228
734042,2,13,26,94
419142,1,16,26,226
729322,2,17,26,136
598047,1,20,26,106
733988,2,3,25,453
335988,1,20,25,25
392233,2,20,25,195
829794,2,19,25,322
501225,1,3,25,39
733996,1,16,25,311
419157,1,20,25,198
501218,1,20,25,106
729300,1,13,25,136
336041,1,20,25,32
501262,1,13,25,249
548367,1,6,25,299
501246,1,19,25,274
980936,2,18,25,311
419117,2,13,25,77
548385,1,19,25,296
548353,1,18,25,1
598069,2,15,25,61
419112,2,12,25,209
392242,2,6,25,41
829800,1,17,25,375
392235,1,19,25,126
829734,1,14,24,35
734052,1,4,24,359
548360,1,5,24,126
419134,2,5,24,226
548381,2,2,24,120
598059,1,18,24,232
392207,1,18,24,137
392228,1,6,24,179
419128,1,19,24,151
733982,2,19,24,94
392219,1,15,24,78
734032,1,15,24,382
336031,1,20,24,89
734034,1,20,24,94
501229,1,20,24,258
598004,2,17,24,258
598072,1,19,24,232
829812,2,2,24,299
392207,1,18,24,160
981024,1,20,24,32
829790,1,3,24,367
829742,1,17,24,246
980964,2,17,24,32
733988,1,19,24,296
548372,1,20,24,126
548329,1,17,24,81
336024,1,17,24,75
419138,2,3,24,14
829716,1,12,23,84
501237,1,18,23,282
336001,1,19,23,94
336014,2,14,23,41
548349,2,19,23,89
501248,2,8,23,290
548347,1,11,23,221
501260,2,2,23,346
548361,2,18,23,94
548316,1,20,23,120
980986,1,18,23,221
598056,1,17,23,84
734038,1,19,23,310
392241,1,20,23,61
829796,2,14,23,374
501272,2,20,23,151
419122,1,2,23,77
392215,1,19,23,77
335999,2,7,23,49
548379,2,7,23,333
Query:
SELECT AVG(hso."total_runs") AS "average_highest_over_total"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso;
Answer:
average_highest_over_total
17.125880
Query:
SELECT DISTINCT bb."bowler"
    FROM (
      SELECT sub."match_id", sub."innings_no", sub."over_id", sub."total_runs"
      FROM (
        SELECT bs."match_id", bs."innings_no", bs."over_id",
               SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs",
               ROW_NUMBER() OVER (PARTITION BY bs."match_id", bs."innings_no" ORDER BY SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) DESC) AS "row_num"
        FROM IPL.IPL.BATSMAN_SCORED bs
        LEFT JOIN IPL.IPL.EXTRA_RUNS er
          ON bs."match_id" = er."match_id"
          AND bs."innings_no" = er."innings_no"
          AND bs."over_id" = er."over_id"
          AND bs."ball_id" = er."ball_id"
        GROUP BY bs."match_id", bs."innings_no", bs."over_id"
      ) sub
      WHERE sub."row_num" = 1
    ) hso
    JOIN IPL.IPL.BALL_BY_BALL bb
      ON hso."match_id" = bb."match_id"
      AND hso."innings_no" = bb."innings_no"
      AND hso."over_id" = bb."over_id"
    LIMIT 100;
Answer:
bowler
73
60
39
126
14
120
86
77
111
31
151
155
82
195
199
198
259
314
90
70
59
61
439
136
15
50
222
232
246
191
192
258
299
266
325
309
349
408
400
117
223
147
280
452
375
422
12
162
188
217
230
190
296
372
388
244
218
213
238
161
235
278
307
335
315
358
368
391
395
401
412
462
35
154
284
382
418
140
328
10
435
25
32
175
4
58
78
149
44
108
127
106
440
294
447
166
376
305
99
124
End Exploring Related Columns
Task: For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Average_Highest_Over_Total
average_runs:float
(Attention: answer in one row)
```

We calculated the average of the highest over totals across all matches by combining runs from both the batsman scored (`runs_scored`) and extra runs (`extra_runs`) for each over in every innings. For each match and innings, we identified the single over with the highest total runs, retrieved the bowler for that over from the `BALL_BY_BALL` table, and then computed the average of these highest over totals across all matches to ensure all runs and bowler details are accurately reflected..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'IPL': {'IPL': ['PLAYER_MATCH', 'PLAYER', 'BATSMAN_SCORED', 'WICKET_TAKEN', 'BALL_BY_BALL', 'EXTRA_RUNS', 'MATCH', 'TEAM']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 16:03:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:03:10 - root - INFO - ```sql
WITH over_totals AS (
  SELECT bs."match_id", bs."innings_no", bs."over_id",
         SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs"
  FROM IPL.IPL.BATSMAN_SCORED bs
  LEFT JOIN IPL.IPL.EXTRA_RUNS er
    ON bs."match_id" = er."match_id"
    AND bs."innings_no" = er."innings_no"
    AND bs."over_id" = er."over_id"
    AND bs."ball_id" = er."ball_id"
  GROUP BY bs."match_id", bs."innings_no", bs."over_id"
),
bowler_per_over AS (
  SELECT
    bb."match_id",
    bb."innings_no",
    bb."over_id",
    bb."bowler",
    ROW_NUMBER() OVER (
      PARTITION BY bb."match_id", bb."innings_no", bb."over_id"
      ORDER BY bb."ball_id"
    ) AS rn_bowler
  FROM IPL.IPL.BALL_BY_BALL bb
),
highest_over AS (
  SELECT
    ot."match_id",
    ot."innings_no",
    ot."over_id",
    ot."total_runs",
    bpo."bowler",
    ROW_NUMBER() OVER (
      PARTITION BY ot."match_id"
      ORDER BY ot."total_runs" DESC
    ) AS rn
  FROM over_totals ot
  JOIN bowler_per_over bpo
    ON ot."match_id" = bpo."match_id"
    AND ot."innings_no" = bpo."innings_no"
    AND ot."over_id" = bpo."over_id"
    AND bpo.rn_bowler = 1
)
SELECT AVG(h."total_runs") AS "Average_Highest_Over_Total"
FROM highest_over h
WHERE h.rn = 1;
```
2025-02-10 16:03:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:03:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:03:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:03:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:03:11 - snowflake.connector.connection - INFO - closed
2025-02-10 16:03:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:03:11 - root - INFO - itercount: 1
2025-02-10 16:03:11 - root - INFO - 0
2025-02-10 16:03:11 - root - INFO - results: 
Average_Highest_Over_Total
19.086268


2025-02-10 16:03:11 - root - INFO - Please check the answer again by reviewing For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Average_Highest_Over_Total
average_runs:float
(Attention: answer in one row)
```

We calculated the average of the highest over totals across all matches by combining runs from both the batsman scored (`runs_scored`) and extra runs (`extra_runs`) for each over in every innings. For each match and innings, we identified the single over with the highest total runs, retrieved the bowler for that over from the `BALL_BY_BALL` table, and then computed the average of these highest over totals across all matches to ensure all runs and bowler details are accurately reflected. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Average_Highest_Over_Total
19.086268
Current sql:
WITH over_totals AS (
  SELECT bs."match_id", bs."innings_no", bs."over_id",
         SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs"
  FROM IPL.IPL.BATSMAN_SCORED bs
  LEFT JOIN IPL.IPL.EXTRA_RUNS er
    ON bs."match_id" = er."match_id"
    AND bs."innings_no" = er."innings_no"
    AND bs."over_id" = er."over_id"
    AND bs."ball_id" = er."ball_id"
  GROUP BY bs."match_id", bs."innings_no", bs."over_id"
),
bowler_per_over AS (
  SELECT
    bb."match_id",
    bb."innings_no",
    bb."over_id",
    bb."bowler",
    ROW_NUMBER() OVER (
      PARTITION BY bb."match_id", bb."innings_no", bb."over_id"
      ORDER BY bb."ball_id"
    ) AS rn_bowler
  FROM IPL.IPL.BALL_BY_BALL bb
),
highest_over AS (
  SELECT
    ot."match_id",
    ot."innings_no",
    ot."over_id",
    ot."total_runs",
    bpo."bowler",
    ROW_NUMBER() OVER (
      PARTITION BY ot."match_id"
      ORDER BY ot."total_runs" DESC
    ) AS rn
  FROM over_totals ot
  JOIN bowler_per_over bpo
    ON ot."match_id" = bpo."match_id"
    AND ot."innings_no" = bpo."innings_no"
    AND ot."over_id" = bpo."over_id"
    AND bpo.rn_bowler = 1
)
SELECT AVG(h."total_runs") AS "Average_Highest_Over_Total"
FROM highest_over h
WHERE h.rn = 1;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-10 16:03:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:03:56 - root - INFO - ```sql
WITH over_totals AS (
  SELECT bs."match_id", bs."innings_no", bs."over_id",
         SUM(bs."runs_scored") + COALESCE(SUM(er."extra_runs"), 0) AS "total_runs"
  FROM IPL.IPL.BATSMAN_SCORED bs
  LEFT JOIN IPL.IPL.EXTRA_RUNS er
    ON bs."match_id" = er."match_id"
    AND bs."innings_no" = er."innings_no"
    AND bs."over_id" = er."over_id"
    AND bs."ball_id" = er."ball_id"
  GROUP BY bs."match_id", bs."innings_no", bs."over_id"
),
bowler_per_over AS (
  SELECT
    bb."match_id",
    bb."innings_no",
    bb."over_id",
    bb."bowler",
    ROW_NUMBER() OVER (
      PARTITION BY bb."match_id", bb."innings_no", bb."over_id"
      ORDER BY bb."ball_id"
    ) AS rn_bowler
  FROM IPL.IPL.BALL_BY_BALL bb
),
highest_over AS (
  SELECT
    ot."match_id",
    ot."innings_no",
    ot."over_id",
    ot."total_runs",
    bpo."bowler",
    ROW_NUMBER() OVER (
      PARTITION BY ot."match_id"
      ORDER BY ot."total_runs" DESC NULLS LAST
    ) AS rn
  FROM over_totals ot
  JOIN bowler_per_over bpo
    ON ot."match_id" = bpo."match_id"
    AND ot."innings_no" = bpo."innings_no"
    AND ot."over_id" = bpo."over_id"
    AND bpo.rn_bowler = 1
)
SELECT ROUND(AVG(h."total_runs"), 4) AS "Average_Highest_Over_Total"
FROM highest_over h
WHERE h.rn = 1;
```

```csv
Average_Highest_Over_Total
19.0863
```
2025-02-10 16:03:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:03:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:03:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:03:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:03:58 - snowflake.connector.connection - INFO - closed
2025-02-10 16:03:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:03:58 - root - INFO - itercount: 2
2025-02-10 16:03:58 - root - INFO - 0
2025-02-10 16:03:58 - root - INFO - Total iteration counts: 2
