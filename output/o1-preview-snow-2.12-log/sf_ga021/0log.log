2025-01-23 06:42:54 - openai._base_client - INFO - Retrying request to /chat/completions in 0.448937 seconds
2025-01-23 06:44:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:44:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:44:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:44:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:44:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-23 06:44:18 - snowflake.connector.connection - INFO - closed
2025-01-23 06:44:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:44:18 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Results:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
user_engagement
level_up
level_complete
select_content
level_fail
level_end
level_start
level_retry
completed_5_levels
no_more_extra_steps
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
app_clear_data
app_update
firebase_campaign
error
ad_reward
use_extra_steps
spend_virtual_currency
challenge_a_friend
first_open

2025-01-23 06:44:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:44:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:44:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:44:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-23 06:44:20 - snowflake.connector.connection - INFO - closed
2025-01-23 06:44:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:44:20 - root - INFO - SQL:
SELECT "event_name", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "event_name"
   ORDER BY "event_count" DESC
   LIMIT 100;
Results:
event_name,event_count
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
app_clear_data,1
challenge_a_friend,1

2025-01-23 06:44:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:44:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:44:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:44:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 06:44:21 - snowflake.connector.connection - INFO - closed
2025-01-23 06:44:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:44:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:44:41 - root - INFO - ```sql
SELECT *
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100;
```
2025-01-23 06:44:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:44:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:44:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:44:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 43
2025-01-23 06:44:44 - snowflake.connector.connection - INFO - closed
2025-01-23 06:44:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:46:02 - root - INFO - SQL:
SELECT *
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100;
Results:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform
20180702,1530590034397045,level_complete_quickplay,"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -3260873074173490837
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]",1526505129609045,,472,1323984,,654F30C1312F6C1A26DFDA9F076A62D8,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1482378805491000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1477369230231000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1476908488411000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1530589570174000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_last_notification"",
    ""value"": {
      ""set_timestamp_micros"": 1494813899942000,
      ""string_value"": ""4857993083614758445""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1530589572284000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1476917467314000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1530589572283000,
      ""string_value"": ""0""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1476908354977000,
      ""set_timestamp_micros"": 1476908266977000
    }
  }
]",1476908354977000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""(none)"",
  ""name"": ""(direct)"",
  ""source"": ""(direct)""
}",1051193346,ANDROID
20180702,1530592878437030,level_complete_quickplay,"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8126232848982224228
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]",1530590027397030,,474,1349590,,654F30C1312F6C1A26DFDA9F076A62D8,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1482378833491000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1477369258231000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1476908516411000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1530592265519000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_last_notification"",
    ""value"": {
      ""set_timestamp_micros"": 1494813927942000,
      ""string_value"": ""4857993083614758445""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1530589600284000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1476917495314000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1530589600283000,
      ""string_value"": ""0""
    }
  },
  {
    ""key"": ""first_open_time"",
    "

2025-01-23 06:46:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:46:04 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:04 - root - INFO - SQL:
SELECT "event_params"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Results:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -3260873074173490837
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8126232848982224228
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8126232848982224228
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -3260873074173490837
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_v

2025-01-23 06:46:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:46:06 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:06 - root - INFO - SQL:
SELECT f.value:"key"::STRING AS "param_key",
       f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Results:
param_key,param_value
value,"{""int_value"":22}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
value,"{""int_value"":22}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
value,"{""int_value"":22}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"

2025-01-23 06:46:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 06:46:07 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:08 - root - INFO - SQL:
SELECT DISTINCT f.value:"key"::STRING AS "param_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Results:
param_key
value
firebase_screen_class
firebase_event_origin
firebase_screen_id
board

2025-01-23 06:46:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 06:46:09 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:46:33 - root - INFO - ```sql
SELECT DISTINCT f.value:"value"::STRING AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100;
```
2025-01-23 06:46:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 06:46:34 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:47:28 - root - INFO - SQL:
SELECT DISTINCT f.value:"value"::STRING AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100;
Results:
quickplay_event_type
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""M""}"

2025-01-23 06:47:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:47:30 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:30 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
08D399C66188D9A356AFAD5E2B2BA45E
05407E04B9FA64CB63D8FA1D966AD6A2
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
A064A84CD3CF7058F39333D6212E8615
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
DE4912FBC5F915C027000A8A6FF44F85
88A41BFED275BB69125BE1F5524F3B42
A87A30159D909E2356F72AAC76F26707
4BDC831A6940071E2461D0B5293A329E
AE920B86560554C0BE3F888EDBA2BBF7
037DAC225F0C1E54657770CD201CDDA7
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
60CFF65B640769B6FD3BC9593EDF7C1D
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
C87CDC0C4F86B10B7467281D516929B5
EA9A16D9042286D55399A418CC7A28F3
8040FC9C0479C3B9A74ED298DD8F357D
D7D49CC32C4A23AD56E8DEAE6878EC7B
CE7404D5A8831F2DE46BD0A013A8ED64
E2D6E7FE36B7CDD0789CC8F03CC747E0
332FF17A7140DA319A07A72CA1CB6A5A
0AAA02628D6A75EEC75D37DA84D04426
50D8D0C89D69EDAE2F04E43E90DB59C1
004D2DFEB866BFB00427DB2F530C1F3D
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
5CDFC86835249BE3DB5E9F6778E344AD
F815B0069F973BFA743EF90A85224109
4D084D38156128AAA060303AA91E689D
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
2F5B044B41268F6643EB4D0EF15D4E87
2F8E2DBB938D2E43C2D171AF5F35EEF8
64BA3BB3BD757CE7000D38CB7125E6DA
C795AFA7F574C2BB09D3647AD90A9719
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
53866E32BA0ABFD846772D4B7B9B5921
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
84D135997D8A4D9CB35D4ECA46EF6861
664F913ED3B54941B5F0886D94E01623
2F5BBABE9DD0271DCD62E501F76DA736
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
117AD1627465CC9E03AB5D8825D42E07
920DB84FCC0F4421650B9E257E33180B
D3F06F9B7BD9D7FC8758BF78BF0705E9
97E7144B7FA861C3C8DB7424D7039832
05FB3382D94C7E963B408FD6CC357D33
41F62B68F0D1C05B6F17CFACD42913C5
B75FCD833DE643B45B326D2E7AC413E4
932AAF56DDE9C55359B9CCFA18E7FB95
E512079B53179DF9A608CF4ADE47DE9D
C09F04828B07E4DFEF39DA5C4A976A90
19DEEA6B15B314DB0ED2A4936959D8F9
98578513E0F25350F961CDCBA9D3656F
3E8023DB1D342304C2D6BD56705C4687
EB1A430BACB37E6EA72592BF838E64A6
79C6CEA7189615EF5319ED1BA55DDE9D
8BF9627603DCFB395B8D4EC4A92E90DD
85549E512A7BB6B13BD956D427B86C74
76BB576278338D2E508DE5D705241B47
7207044281C74501C14233463AAD9A71
FEDC59699D8832A11B88BFCCCAD0951D
11A8D6037368A4C4508B11ADB4353BC4
2B1A8699D5D9CC85A21E5AD20A5F1278
B141B75E5E5D48DAD8298F91B94A2E07
DE0CCACD4BB0DBB022445718217A0819
10B0D468B5E036E16D13DB53A65F2D49
B7701369F8598A25DED0499DAD3BE85D
187F3053F04D9D7EF93DF21DBDB59684
7AA6572327B5C45D273CCD8868760033
0CAAA1B6F161BA4D363EB7A2DEF64A08

2025-01-23 06:47:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:47:32 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:32 - root - INFO - SQL:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "initial_quickplay_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,initial_quickplay_timestamp
654F30C1312F6C1A26DFDA9F076A62D8,1530589592250005
65D7715C409E6A38667447CE2B52AFFE,1530590779420007
B205B117C82A24AA95E663FFB7D04718,1530575608047015
EF9E8CCCCBBB015CAE0C334AB1745417,1530595751676008
83D8C7F90DAF2C832F05A9DDD8693135,1530595501830008
0F67E233B19D2898229CD156974A93AE,1530550074439007
5217AB1A454DAED6243E1C9818BE6A20,1530527233524005
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,1530522794080006
38D4084307B6D1CEA37A48981753428E,1530553464348008
0373DF7959F6867CDFB1C905D39CE67C,1530567542147009
5D5895B1267014C54ECBE08864420979,1530537320109064
D34924C19421D7E083FD387D97765F94,1530540061575005
C136A7CE1D0A52B8D4E5F144DF114EB7,1530528424855007
49309C5759610DBF6C829C0D4AB23943,1530536482228010
08D399C66188D9A356AFAD5E2B2BA45E,1530528877863016
05407E04B9FA64CB63D8FA1D966AD6A2,1530586748004008
3A58859E074B02E8FB1CAEA291636112,1530577516756007
706C748E6D1E0768BFEFE6362B5D3F67,1530574702461008
D0F280B12652EB0D74F6BC74AB13606F,1530537375967017
3EF8FC940E379D53BBD3FEFDAF626BB2,1530565244937008
7101B4232F5B26A9C987C54F8717DCDC,1530589149019005
4948BEDE78FC6EBA9899F26BF5C53897,1530565865612005
A064A84CD3CF7058F39333D6212E8615,1530524294068008
7842C62D45ECE888132F21C9F4417B21,1530546059046009
672B24B51143CC66DCBAA0FA88C38D57,1530553436222004
DE4912FBC5F915C027000A8A6FF44F85,1530563378905010
88A41BFED275BB69125BE1F5524F3B42,1530556388228007
A87A30159D909E2356F72AAC76F26707,1530560677341067
4BDC831A6940071E2461D0B5293A329E,1530575354098007
AE920B86560554C0BE3F888EDBA2BBF7,1530518555623005
037DAC225F0C1E54657770CD201CDDA7,1530547332646007
E50F7AC0680FD87AD6CE6B6700D209A7,1530551578162009
7D613AF4DA0F508C7090E96FD73B7E6D,1530571965300008
D7EA8E3645EFFBD6443946179ED704A6,1530540178824008
59454BAC415BB1F18517C6FD2C023E49,1530535803536008
60CFF65B640769B6FD3BC9593EDF7C1D,1530575646345015
EBFE0623EF1109A89B392B9DF4375951,1530579875527008
CA04708DA02378999ECB402481FF1AE4,1530535905765007
C87CDC0C4F86B10B7467281D516929B5,1530566574138007
EA9A16D9042286D55399A418CC7A28F3,1530595720759006
8040FC9C0479C3B9A74ED298DD8F357D,1530591676725001
D7D49CC32C4A23AD56E8DEAE6878EC7B,1530569074007005
CE7404D5A8831F2DE46BD0A013A8ED64,1530532483201008
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584705538004
332FF17A7140DA319A07A72CA1CB6A5A,1530544386209010
0AAA02628D6A75EEC75D37DA84D04426,1530577474164008
50D8D0C89D69EDAE2F04E43E90DB59C1,1530548538865008
004D2DFEB866BFB00427DB2F530C1F3D,1530555922343008
0D17D0247F158FA3E40D21EFF46D1651,1530534796962023
472451071AED6FF801BC0FE66706FD27,1530535171941001
FFA9AE78B23263835F8AAED57713EBE9,1530544809486030
1213ED1E96B0A49B51C0F7683DB2ACCC,1530545900524014
E080406D26F71C9B8F331779CE8B82BA,1530550329748007
548C38A983EB2EB88DC1DEEA9DE6DED9,1530568295460007
F47CF9AFCC314481CAF183DC6836965E,1530547671223008
C8685B0DFA2C4B4E6E6EA72894C30F6F,1530542035764007
9F5F895A86C3F594339330FB7275EE6D,1530590679338012
4B2605822194ABE869CE8DE6DCE0395E,1530527408222001
22FC699EA575027C5A7909E24A7F187D,1530572908268008
A2B8271B8CE580EC92A8D8CCAD85FE5C,1530538829829002
6A71951BC1C5F03C22E9E892AEB90B19,1530536671413005
C6DE585349744A40725DB0AB17041BA3,1530541062214016
E4C6FF8288DD4BFCDE93E2218E20643B,1530581720199007
BB063F0A226E371EAC4F1509183E333F,1530528699795009
909A16079F7183140ACF4C71A6CCDF3D,1530527709482008
3031EAD1E9D35306A37A0F3DC3B84A0A,1530539682696010
5CDFC86835249BE3DB5E9F6778E344AD,1530563541151009
F815B0069F973BFA743EF90A85224109,1530548878210007
4D084D38156128AAA060303AA91E689D,1530568792432011
E6FEE8B98E75EA5311FE004F98559A27,1530584782945008
48AB910A8DE8485D4C34238EA61F782C,1530524429332020
2F5B044B41268F6643EB4D0EF15D4E87,1530524279135074
2F8E2DBB938D2E43C2D171AF5F35EEF8,1530520042044005
64BA3BB3BD757CE7000D38CB7125E6DA,1530578266926009
C795AFA7F574C2BB09D3647AD90A9719,1530522583459011
E451D416F972019604F1456533FF3858,1530589733196009
AFE7A3E11C66E71FA9EA7B138700EC44,1530542942271008
5E694DE02688C2FDDEA38A6946A4CC3F,1530562716602009
B75F91EB6C7FDA9A329567E763CF9E44,1530561358542015
53866E32BA0ABFD846772D4B7B9B5921,1530541076164007
8EDB9A9856CDB5AFC42546106EE46734,1530543225081008
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,1530554360527008
84D135997D8A4D9CB35D4ECA46EF6861,1530520077430009
664F913ED3B54941B5F0886D94E01623,1530522383436005
2F5BBABE9DD0271DCD62E501F76DA736,1530543347988008
4CE503AE5B4C4F67A00474CE380CCC39,1530546742069007
3D03A380687FE3369E93915D50C572CB,1530573068701015
117AD1627465CC9E03AB5D8825D42E07,1530522884943007
920DB84FCC0F4421650B9E257E33180B,1530552925122006
D3F06F9B7BD9D7FC8758BF78BF0705E9,1530517358985007
97E7144B7FA861C3C8DB7424D7039832,1530573552024008
05FB3382D94C7E963B408FD6CC357D33,1530540114739007
41F62B68F0D1C05B6F17CFACD42913C5,1530574931809024
B75FCD833DE643B45B326D2E7AC413E4,1530550088914007
932AAF56DDE9C55359B9CCFA18E7FB95,1530540132657009
E512079B53179DF9A608CF4ADE47DE9D,1530560684457006
C09F04828B07E4DFEF39DA5C4A976A90,1530552491794008
19DEEA6B15B314DB0ED2A4936959D8F9,1530592349086001
98578513E0F25350F961CDCBA9D3656F,1530572659870008
3E8023D

2025-01-23 06:47:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 06:47:33 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:34 - root - INFO - SQL:
SELECT f.value:"value"::STRING AS "quickplay_event_type",
       COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
GROUP BY "quickplay_event_type"
ORDER BY "event_count" DESC
LIMIT 100
Results:
quickplay_event_type,event_count
"{""string_value"":""S""}",10281
"{""string_value"":""M""}",1186
"{""string_value"":""L""}",466

2025-01-23 06:47:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:47:35 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:35 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id",
       f.value:"value"::STRING AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,quickplay_event_type
654F30C1312F6C1A26DFDA9F076A62D8,"{""string_value"":""S""}"
65D7715C409E6A38667447CE2B52AFFE,"{""string_value"":""S""}"
B205B117C82A24AA95E663FFB7D04718,"{""string_value"":""S""}"
EF9E8CCCCBBB015CAE0C334AB1745417,"{""string_value"":""M""}"
83D8C7F90DAF2C832F05A9DDD8693135,"{""string_value"":""L""}"
0F67E233B19D2898229CD156974A93AE,"{""string_value"":""S""}"
5217AB1A454DAED6243E1C9818BE6A20,"{""string_value"":""S""}"
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,"{""string_value"":""S""}"
38D4084307B6D1CEA37A48981753428E,"{""string_value"":""S""}"
0373DF7959F6867CDFB1C905D39CE67C,"{""string_value"":""M""}"
0373DF7959F6867CDFB1C905D39CE67C,"{""string_value"":""L""}"
D34924C19421D7E083FD387D97765F94,"{""string_value"":""S""}"
C136A7CE1D0A52B8D4E5F144DF114EB7,"{""string_value"":""L""}"
49309C5759610DBF6C829C0D4AB23943,"{""string_value"":""S""}"
08D399C66188D9A356AFAD5E2B2BA45E,"{""string_value"":""S""}"
909A16079F7183140ACF4C71A6CCDF3D,"{""string_value"":""M""}"
3031EAD1E9D35306A37A0F3DC3B84A0A,"{""string_value"":""S""}"
05407E04B9FA64CB63D8FA1D966AD6A2,"{""string_value"":""M""}"
5CDFC86835249BE3DB5E9F6778E344AD,"{""string_value"":""S""}"
D0F280B12652EB0D74F6BC74AB13606F,"{""string_value"":""S""}"
DE4912FBC5F915C027000A8A6FF44F85,"{""string_value"":""S""}"
E6FEE8B98E75EA5311FE004F98559A27,"{""string_value"":""S""}"
2F5B044B41268F6643EB4D0EF15D4E87,"{""string_value"":""S""}"
7101B4232F5B26A9C987C54F8717DCDC,"{""string_value"":""S""}"
4948BEDE78FC6EBA9899F26BF5C53897,"{""string_value"":""S""}"
88A41BFED275BB69125BE1F5524F3B42,"{""string_value"":""S""}"
A87A30159D909E2356F72AAC76F26707,"{""string_value"":""S""}"
2F8E2DBB938D2E43C2D171AF5F35EEF8,"{""string_value"":""S""}"
A064A84CD3CF7058F39333D6212E8615,"{""string_value"":""S""}"
76BB576278338D2E508DE5D705241B47,"{""string_value"":""S""}"
7207044281C74501C14233463AAD9A71,"{""string_value"":""S""}"
4BDC831A6940071E2461D0B5293A329E,"{""string_value"":""L""}"
64BA3BB3BD757CE7000D38CB7125E6DA,"{""string_value"":""S""}"
C795AFA7F574C2BB09D3647AD90A9719,"{""string_value"":""S""}"
59454BAC415BB1F18517C6FD2C023E49,"{""string_value"":""S""}"
CA04708DA02378999ECB402481FF1AE4,"{""string_value"":""S""}"
664F913ED3B54941B5F0886D94E01623,"{""string_value"":""S""}"
4CE503AE5B4C4F67A00474CE380CCC39,"{""string_value"":""S""}"
D3F06F9B7BD9D7FC8758BF78BF0705E9,"{""string_value"":""S""}"
60CFF65B640769B6FD3BC9593EDF7C1D,"{""string_value"":""L""}"
8EDB9A9856CDB5AFC42546106EE46734,"{""string_value"":""S""}"
84D135997D8A4D9CB35D4ECA46EF6861,"{""string_value"":""S""}"
3D03A380687FE3369E93915D50C572CB,"{""string_value"":""S""}"
B7701369F8598A25DED0499DAD3BE85D,"{""string_value"":""S""}"
85549E512A7BB6B13BD956D427B86C74,"{""string_value"":""S""}"
EB1A430BACB37E6EA72592BF838E64A6,"{""string_value"":""S""}"
B75FCD833DE643B45B326D2E7AC413E4,"{""string_value"":""S""}"
DE0CCACD4BB0DBB022445718217A0819,"{""string_value"":""S""}"
3E8023DB1D342304C2D6BD56705C4687,"{""string_value"":""S""}"
004D2DFEB866BFB00427DB2F530C1F3D,"{""string_value"":""S""}"
5D5895B1267014C54ECBE08864420979,"{""string_value"":""S""}"
3A58859E074B02E8FB1CAEA291636112,"{""string_value"":""S""}"
706C748E6D1E0768BFEFE6362B5D3F67,"{""string_value"":""S""}"
F815B0069F973BFA743EF90A85224109,"{""string_value"":""S""}"
4D084D38156128AAA060303AA91E689D,"{""string_value"":""M""}"
3EF8FC940E379D53BBD3FEFDAF626BB2,"{""string_value"":""S""}"
48AB910A8DE8485D4C34238EA61F782C,"{""string_value"":""M""}"
7842C62D45ECE888132F21C9F4417B21,"{""string_value"":""S""}"
672B24B51143CC66DCBAA0FA88C38D57,"{""string_value"":""S""}"
920DB84FCC0F4421650B9E257E33180B,"{""string_value"":""S""}"
AE920B86560554C0BE3F888EDBA2BBF7,"{""string_value"":""S""}"
037DAC225F0C1E54657770CD201CDDA7,"{""string_value"":""S""}"
E50F7AC0680FD87AD6CE6B6700D209A7,"{""string_value"":""S""}"
7D613AF4DA0F508C7090E96FD73B7E6D,"{""string_value"":""S""}"
FEDC59699D8832A11B88BFCCCAD0951D,"{""string_value"":""S""}"
E451D416F972019604F1456533FF3858,"{""string_value"":""S""}"
AFE7A3E11C66E71FA9EA7B138700EC44,"{""string_value"":""S""}"
5E694DE02688C2FDDEA38A6946A4CC3F,"{""string_value"":""S""}"
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,"{""string_value"":""S""}"
11A8D6037368A4C4508B11ADB4353BC4,"{""string_value"":""M""}"
C87CDC0C4F86B10B7467281D516929B5,"{""string_value"":""S""}"
2F5BBABE9DD0271DCD62E501F76DA736,"{""string_value"":""S""}"
97E7144B7FA861C3C8DB7424D7039832,"{""string_value"":""S""}"
2B1A8699D5D9CC85A21E5AD20A5F1278,"{""string_value"":""S""}"
CE7404D5A8831F2DE46BD0A013A8ED64,"{""string_value"":""S""}"
8040FC9C0479C3B9A74ED298DD8F357D,"{""string_value"":""S""}"
05FB3382D94C7E963B408FD6CC357D33,"{""string_value"":""S""}"
E2D6E7FE36B7CDD0789CC8F03CC747E0,"{""string_value"":""S""}"
B141B75E5E5D48DAD8298F91B94A2E07,"{""string_value"":""S""}"
932AAF56DDE9C55359B9CCFA18E7FB95,"{""string_value"":""S""}"
E512079B53179DF9A608CF4ADE47DE9D,"{""string_value"":""S""}"
C09F04828B07E4DFEF39DA5C4A976A90,"{""string_value"":""S""}"
19DEEA6B15B314DB0ED2A4936959D8F9,"{""string_

2025-01-23 06:47:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:47:37 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:37 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  WHERE "event_name" LIKE '%quickplay%'
)
LIMIT 100
Results:
user_pseudo_id
5217AB1A454DAED6243E1C9818BE6A20
0373DF7959F6867CDFB1C905D39CE67C
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
7842C62D45ECE888132F21C9F4417B21
4BDC831A6940071E2461D0B5293A329E
037DAC225F0C1E54657770CD201CDDA7
FEDC59699D8832A11B88BFCCCAD0951D
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
11A8D6037368A4C4508B11ADB4353BC4
CA04708DA02378999ECB402481FF1AE4
C87CDC0C4F86B10B7467281D516929B5
EA9A16D9042286D55399A418CC7A28F3
B75FCD833DE643B45B326D2E7AC413E4
932AAF56DDE9C55359B9CCFA18E7FB95
E512079B53179DF9A608CF4ADE47DE9D
98578513E0F25350F961CDCBA9D3656F
0CAAA1B6F161BA4D363EB7A2DEF64A08
B5F3D00E28A57C9522F2DEE3CB903DD1
5CC434A43CB09640FC6BE2D7A18183E4
1213ED1E96B0A49B51C0F7683DB2ACCC
6A07135DA41B81E278341576A26672E4
E080406D26F71C9B8F331779CE8B82BA
4AB0441290F6077849CBE9C74A828F0A
C639CACA07D03F536F537ED779CF6599
229254D7C810F98F72C89A8060E194D4
29BC86DCA0D500C9410F392B57C28DD3
1F0D27B8A7E058446D4A6409E2E73B19
F655D26B0F7A4093F1D2FFBD5E61B09D
C3326C2CCF5D46173E4973A13512B163
682A8CD0767A569DC68E7AA0201BFBA3
B141B75E5E5D48DAD8298F91B94A2E07
EB1A430BACB37E6EA72592BF838E64A6
004D2DFEB866BFB00427DB2F530C1F3D
03A9D32C44665A9E15CFCCEDC9F68EDB
B5395F8C2077B59B3D6C5719C0CA0339
1CF315BC6864E7A71A81E47925E18A61
E6B6CAE2D200FC3EACF21DDE75402DCD
3875A92B5F5C2BBA1355CED06A986079
4EF964D59282E5A2C8692D30F011256B
7BEC6B06860D25AE7E44CA49AB939BBF
0C777BD44F304574371C97674DCD0702
93A7A5C31807490E878F4164A6418BFC
7EE035CA8E6132A8877C39656896BA41
472451071AED6FF801BC0FE66706FD27
89BD2B0E233951461CF06C9B4FDA0D81
84E491A60BE52A4C6A438A89FADE283C
28C4A09298C441D5AFD39E749D9F3DA3
B10AE521352392E4981BA07E0D86081C
E50F7AC0680FD87AD6CE6B6700D209A7
0D17D0247F158FA3E40D21EFF46D1651
E5A2CB7A471E740E758BE5E2E0C79BC2
A2B7DF97E146FC5AB4C8F89A94D85B4A
7E40E634997585B0C69B6F67C01C191B
B63075B53A750A67A12F7F19ED5AA835
4D33ED6DCCD63BBED146B6060B307CAF
3D1B58553D2E2D4DD5DFCF251D5E23B2
2B7787A34C362AA51FF8E4DD031A2F70
FC48EDE912EDD9F8D7ED45F697EE7193
55BFC405FFA33C0781DE73101011E45B
CFA0F8C5E25A71062E573EF8E6BC9F76
DA48D36D07835B1918BDF831AF83B5EF
372D9BB5088C4E9000C65B06459B403A
13E6C8A193FF140F7D4222B569DD5B50
0F93A84CB0774C5BAB3E5FF8A72A694D
12E5626928FE0885DEEF068683E8BD63
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
4CE503AE5B4C4F67A00474CE380CCC39
10B0D468B5E036E16D13DB53A65F2D49
BE36C49B1AB3968D420923AEC4FDD7AE
A74C05E503F6274BAA9457B2265471F5
81BFFE61CAB181676917D75F1B617CB2
F2A1FD8B142EB4C6CAAE415FA1917F50
3D9A1566A6D35AC1D20B7D125637B637
C6DE585349744A40725DB0AB17041BA3
24EED66707DBBEAE56954F7F45B834F1
74456352647C13028F89D1EEFFB905F4
E4C6FF8288DD4BFCDE93E2218E20643B
437E1E4F1A7DF0CC995FCE10EAC96350
6683CAFB77FB7B60C78CD233EB2B62F7
B458770ED6E295374FEEB3A68902CC28
96161BF2E55C7E32ED5F411432875ECB
2B90CE94C6039DF03E72FE15B5320ABA
AD99B4950F9D70E0FD5E8563F2A664FB
8211CABE9A3F1FE1BF3154E0C8D30368
C7E2273D8B11257FCCC915D27C1FCA24
7386D239899D55E3D62DA619F359A7C0
CABE7E24215A5C36862658A36AE5CE12
096C23E69254818F7EE03C1239005F2B
A0616D4E494DC3BCCB94B8B6E5B48380
4EF1041DB2A406750E4A46AFD78FB543
8F6C5F7611B67A4A437FF283B6C10181
D8A6BDFA89F65FC9B5159A3031C33004
8D9D62A4402581BB1181D3AA73AD54E8
D4F4DAEF5BE38E5C67FD72BB1F082EBF

2025-01-23 06:47:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 44
2025-01-23 06:47:40 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:40 - root - INFO - SQL:
SELECT *
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  WHERE "event_name" LIKE '%quickplay%'
)
LIMIT 100
Results:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform
20180716,1531796092182005,post_score,"[
  {
    ""key"": ""time"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  },
  {
    ""key"": ""score"",
    ""value"": {
      ""double_value"": 4.000000000000000e+00
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""double_value"": 5.532138157231706e+18
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_0""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  }
]",1531704253013005,,230,-88255857,,5217AB1A454DAED6243E1C9818BE6A20,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1529861622278000,
      ""string_value"": ""4""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1529861622278000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1530125581768000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1531796034371000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1529921012727000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1529861624039000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1529861622387000,
      ""string_value"": ""0""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1529861553949000,
      ""set_timestamp_micros"": 1529861606949000
    }
  }
]",1529861553949000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""organic"",
  ""source"": ""google""
}",1051193346,ANDROID
20180716,1531796223490047,post_score,"[
  {
    ""key"": ""time"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  },
  {
    ""key"": ""score"",
    ""value"": {
      ""double_value"": 1.000000000000000e+00
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""double_value"": 5.532138157231706e+18
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_0""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  }
]",1531795999182047,,230,-88255857,,5217AB1A454DAED6243E1C9818BE6A20,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1529861600278000,
      ""string_value"": ""4""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1529861600278000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1530125559768000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1531796012371000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1529920990727000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1529861602039000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1529861600387000,
    

2025-01-23 06:47:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:47:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 06:47:42 - snowflake.connector.connection - INFO - closed
2025-01-23 06:47:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:47:42 - root - INFO - SQL:
SELECT qp."quickplay_event_type", COUNT(DISTINCT r."user_pseudo_id") AS "returning_users"
FROM (
  SELECT "user_pseudo_id",
         f.value:"value"::STRING AS "quickplay_event_type"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
       LATERAL FLATTEN(input => "event_params") f
  WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
) qp
JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716" r
  ON qp."user_pseudo_id" = r."user_pseudo_id"
GROUP BY qp."quickplay_event_type"
ORDER BY "returning_users" DESC
LIMIT 100
Results:
quickplay_event_type,returning_users
"{""string_value"":""S""}",90
"{""string_value"":""M""}",17
"{""string_value"":""L""}",10

2025-01-23 06:47:42 - root - INFO - itercount: 0
2025-01-23 06:47:42 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - **"FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"** to **"FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"**: These tables contain event data from July 2, 2018, to July 16, 2018, which is the initial period for user events.

- **Columns:**
  - **"event_date"**: Used to filter events within the date range of interest (July 2, 2018, to July 16, 2018).
  - **"event_timestamp"**: Provides the exact timestamp of events, useful for determining initial and return events.
  - **"event_name"**: Identifies the type of event; used to filter for "quickplay" events.
  - **"event_params"**: A VARIANT (JSON) column that may contain details about the "quickplay" event types.
  - **"user_pseudo_id"**: A unique identifier for users; used to track user activities over time.
  - **"user_first_touch_timestamp"**: Indicates when a user first interacted with the app; may help in determining new users.

**Conditions that may be used:**

- **Date Range Filtering**: Using **"event_date"** to select events between '20180702' and '20180716'.
- **Event Type Filtering**: Using **"event_name"** to select events related to "quickplay".
- **Event Parameters Extraction**: Parsing **"event_params"** to extract "quickplay" event types.
- **User Identification**: Using **"user_pseudo_id"** to identify and track users.
- **Retention Calculation**: Comparing initial events with subsequent events after two weeks.

---

**SQL Queries:**

1. **Retrieve distinct event names from July 2, 2018:**

   ```sql
   SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
   ```

2. **Count the number of events per event name on July 2, 2018:**

   ```sql
   SELECT "event_name", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "event_name"
   ORDER BY "event_count" DESC
   LIMIT 100;
   ```

3. **Select events where the event name is 'quick_play' on July 2, 2018:**

   ```sql
   SELECT *
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_name" = 'quick_play'
   LIMIT 100;
   ```

4. **View the event parameters of 'quick_play' events on July 2, 2018:**

   ```sql
   SELECT "event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_name" = 'quick_play'
   LIMIT 100;
   ```

5. **Extract keys and values from event parameters for 'quick_play' events:**

   ```sql
   SELECT f.value:"key"::STRING AS "param_key",
          f.value:"value"::STRING AS "param_value"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702", 
        LATERAL FLATTEN(input => "event_params") f
   WHERE "event_name" = 'quick_play'
   LIMIT 100;
   ```

6. **Retrieve distinct parameter keys from event parameters:**

   ```sql
   SELECT DISTINCT f.value:"key"::STRING AS "param_key"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702", 
        LATERAL FLATTEN(input => "event_params") f
   LIMIT 100;
   ```

7. **Get distinct quickplay event types from event parameters:**

   ```sql
   SELECT DISTINCT f.value:"value"::STRING AS "quickplay_event_type"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702", 
        LATERAL FLATTEN(input => "event_params") f
   WHERE "event_name" = 'quick_play' AND f.value:"key"::STRING = 'quickplay_type'
   LIMIT 100;
   ```

8. **List unique users who had a 'quick_play' event on July 2, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_name" = 'quick_play'
   LIMIT 100;
   ```

9. **Find the initial 'quick_play' event timestamp for each user on July 2, 2018:**

   ```sql
   SELECT "user_pseudo_id", MIN("event_timestamp") AS "initial_quickplay_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_name" = 'quick_play'
   GROUP BY "user_pseudo_id"
   LIMIT 100;
   ```

10. **Count the number of 'quick_play' events per quickplay event type:**

    ```sql
    SELECT f.value:"value"::STRING AS "quickplay_event_type",
           COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702", 
         LATERAL FLATTEN(input => "event_params") f
    WHERE "event_name" = 'quick_play' AND f.value:"key"::STRING = 'quickplay_type'
    GROUP BY "quickplay_event_type"
    ORDER BY "event_count" DESC
    LIMIT 100;
    ```

11. **Extract users and their associated quickplay event types:**

    ```sql
    SELECT DISTINCT "user_pseudo_id",
           f.value:"value"::STRING AS "quickplay_event_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702", 
         LATERAL FLATTEN(input => "event_params") f
    WHERE "event_name" = 'quick_play' AND f.value:"key"::STRING = 'quickplay_type'
    LIMIT 100;
    ```

12. **Identify users who returned two weeks after their initial 'quick_play' event:**

    ```sql
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    WHERE "user_pseudo_id" IN (
      SELECT DISTINCT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
      WHERE "event_name" = 'quick_play'
    )
    LIMIT 100;
    ```

13. **Retrieve events on July 16, 2018, for users who had an initial 'quick_play' event on July 2, 2018:**

    ```sql
    SELECT *
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    WHERE "user_pseudo_id" IN (
      SELECT DISTINCT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
      WHERE "event_name" = 'quick_play'
    )
    LIMIT 100;
    ```

14. **Count returning users per quickplay event type after two weeks:**

    ```sql
    SELECT qp."quickplay_event_type", COUNT(DISTINCT r."user_pseudo_id") AS "returning_users"
    FROM (
      SELECT "user_pseudo_id",
             f.value:"value"::STRING AS "quickplay_event_type"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
           LATERAL FLATTEN(input => "event_params") f
      WHERE "event_name" = 'quick_play' AND f.value:"key"::STRING = 'quickplay_type'
    ) qp
    JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716" r
      ON qp."user_pseudo_id" = r."user_pseudo_id"
    GROUP BY qp."quickplay_event_type"
    ORDER BY "returning_users" DESC
    LIMIT 100;
    ```

    *Note: This query joins the initial quickplay events with the returning events after two weeks to count the number of returning users per quickplay event type.*

---

These queries aim to explore the relevant data and understand the structure and content of the tables and columns necessary for calculating the retention rate as specified in the task.Query:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Answer:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
user_engagement
level_up
level_complete
select_content
level_fail
level_end
level_start
level_retry
completed_5_levels
no_more_extra_steps
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
app_clear_data
app_update
firebase_campaign
error
ad_reward
use_extra_steps
spend_virtual_currency
challenge_a_friend
first_open
Query:
SELECT "event_name", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "event_name"
   ORDER BY "event_count" DESC
   LIMIT 100;
Answer:
event_name,event_count
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
app_clear_data,1
challenge_a_friend,1
Query:
SELECT *
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100;
Answer:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform
20180702,1530590034397045,level_complete_quickplay,"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -3260873074173490837
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]",1526505129609045,,472,1323984,,654F30C1312F6C1A26DFDA9F076A62D8,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1482378805491000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1477369230231000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1476908488411000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1530589570174000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_last_notification"",
    ""value"": {
      ""set_timestamp_micros"": 1494813899942000,
      ""string_value"": ""4857993083614758445""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1530589572284000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1476917467314000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1530589572283000,
      ""string_value"": ""0""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1476908354977000,
      ""set_timestamp_micros"": 1476908266977000
    }
  }
]",1476908354977000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""(none)"",
  ""name"": ""(direct)"",
  ""source"": ""(direct)""
}",1051193346,ANDROID
20180702,1530592878437030,level_complete_quickplay,"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8126232848982224228
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]",1530590027397030,,474,1349590,,654F30C1312F6C1A26DFDA9F076A62D8,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1482378833491000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1477369258231000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1476908516411000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1530592265519000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_last_notification"",
    ""value"": {
      ""set_timestamp_micros"": 1494813927942000,
      ""string_value"": ""4857993083614758445""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1530589600284000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1476917495314000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1530589600283000,
      ""string_value"": ""0""
    }
  },
  {
    ""key"": ""first_open_time"",
    "
Query:
SELECT "event_params"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -3260873074173490837
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8126232848982224228
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 22
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 8126232848982224228
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": -3260873074173490837
    }
  },
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  }
]"
"[
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_v
Query:
SELECT f.value:"key"::STRING AS "param_key",
       f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
param_key,param_value
value,"{""int_value"":22}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
value,"{""int_value"":22}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
value,"{""int_value"":22}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-3260873074173490837}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_board""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":8126232848982224228}"
Query:
SELECT DISTINCT f.value:"key"::STRING AS "param_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
param_key
value
firebase_screen_class
firebase_event_origin
firebase_screen_id
board
Query:
SELECT DISTINCT f.value:"value"::STRING AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100;
Answer:
quickplay_event_type
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""M""}"
Query:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
08D399C66188D9A356AFAD5E2B2BA45E
05407E04B9FA64CB63D8FA1D966AD6A2
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
A064A84CD3CF7058F39333D6212E8615
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
DE4912FBC5F915C027000A8A6FF44F85
88A41BFED275BB69125BE1F5524F3B42
A87A30159D909E2356F72AAC76F26707
4BDC831A6940071E2461D0B5293A329E
AE920B86560554C0BE3F888EDBA2BBF7
037DAC225F0C1E54657770CD201CDDA7
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
60CFF65B640769B6FD3BC9593EDF7C1D
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
C87CDC0C4F86B10B7467281D516929B5
EA9A16D9042286D55399A418CC7A28F3
8040FC9C0479C3B9A74ED298DD8F357D
D7D49CC32C4A23AD56E8DEAE6878EC7B
CE7404D5A8831F2DE46BD0A013A8ED64
E2D6E7FE36B7CDD0789CC8F03CC747E0
332FF17A7140DA319A07A72CA1CB6A5A
0AAA02628D6A75EEC75D37DA84D04426
50D8D0C89D69EDAE2F04E43E90DB59C1
004D2DFEB866BFB00427DB2F530C1F3D
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
5CDFC86835249BE3DB5E9F6778E344AD
F815B0069F973BFA743EF90A85224109
4D084D38156128AAA060303AA91E689D
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
2F5B044B41268F6643EB4D0EF15D4E87
2F8E2DBB938D2E43C2D171AF5F35EEF8
64BA3BB3BD757CE7000D38CB7125E6DA
C795AFA7F574C2BB09D3647AD90A9719
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
53866E32BA0ABFD846772D4B7B9B5921
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
84D135997D8A4D9CB35D4ECA46EF6861
664F913ED3B54941B5F0886D94E01623
2F5BBABE9DD0271DCD62E501F76DA736
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
117AD1627465CC9E03AB5D8825D42E07
920DB84FCC0F4421650B9E257E33180B
D3F06F9B7BD9D7FC8758BF78BF0705E9
97E7144B7FA861C3C8DB7424D7039832
05FB3382D94C7E963B408FD6CC357D33
41F62B68F0D1C05B6F17CFACD42913C5
B75FCD833DE643B45B326D2E7AC413E4
932AAF56DDE9C55359B9CCFA18E7FB95
E512079B53179DF9A608CF4ADE47DE9D
C09F04828B07E4DFEF39DA5C4A976A90
19DEEA6B15B314DB0ED2A4936959D8F9
98578513E0F25350F961CDCBA9D3656F
3E8023DB1D342304C2D6BD56705C4687
EB1A430BACB37E6EA72592BF838E64A6
79C6CEA7189615EF5319ED1BA55DDE9D
8BF9627603DCFB395B8D4EC4A92E90DD
85549E512A7BB6B13BD956D427B86C74
76BB576278338D2E508DE5D705241B47
7207044281C74501C14233463AAD9A71
FEDC59699D8832A11B88BFCCCAD0951D
11A8D6037368A4C4508B11ADB4353BC4
2B1A8699D5D9CC85A21E5AD20A5F1278
B141B75E5E5D48DAD8298F91B94A2E07
DE0CCACD4BB0DBB022445718217A0819
10B0D468B5E036E16D13DB53A65F2D49
B7701369F8598A25DED0499DAD3BE85D
187F3053F04D9D7EF93DF21DBDB59684
7AA6572327B5C45D273CCD8868760033
0CAAA1B6F161BA4D363EB7A2DEF64A08
Query:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "initial_quickplay_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,initial_quickplay_timestamp
654F30C1312F6C1A26DFDA9F076A62D8,1530589592250005
65D7715C409E6A38667447CE2B52AFFE,1530590779420007
B205B117C82A24AA95E663FFB7D04718,1530575608047015
EF9E8CCCCBBB015CAE0C334AB1745417,1530595751676008
83D8C7F90DAF2C832F05A9DDD8693135,1530595501830008
0F67E233B19D2898229CD156974A93AE,1530550074439007
5217AB1A454DAED6243E1C9818BE6A20,1530527233524005
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,1530522794080006
38D4084307B6D1CEA37A48981753428E,1530553464348008
0373DF7959F6867CDFB1C905D39CE67C,1530567542147009
5D5895B1267014C54ECBE08864420979,1530537320109064
D34924C19421D7E083FD387D97765F94,1530540061575005
C136A7CE1D0A52B8D4E5F144DF114EB7,1530528424855007
49309C5759610DBF6C829C0D4AB23943,1530536482228010
08D399C66188D9A356AFAD5E2B2BA45E,1530528877863016
05407E04B9FA64CB63D8FA1D966AD6A2,1530586748004008
3A58859E074B02E8FB1CAEA291636112,1530577516756007
706C748E6D1E0768BFEFE6362B5D3F67,1530574702461008
D0F280B12652EB0D74F6BC74AB13606F,1530537375967017
3EF8FC940E379D53BBD3FEFDAF626BB2,1530565244937008
7101B4232F5B26A9C987C54F8717DCDC,1530589149019005
4948BEDE78FC6EBA9899F26BF5C53897,1530565865612005
A064A84CD3CF7058F39333D6212E8615,1530524294068008
7842C62D45ECE888132F21C9F4417B21,1530546059046009
672B24B51143CC66DCBAA0FA88C38D57,1530553436222004
DE4912FBC5F915C027000A8A6FF44F85,1530563378905010
88A41BFED275BB69125BE1F5524F3B42,1530556388228007
A87A30159D909E2356F72AAC76F26707,1530560677341067
4BDC831A6940071E2461D0B5293A329E,1530575354098007
AE920B86560554C0BE3F888EDBA2BBF7,1530518555623005
037DAC225F0C1E54657770CD201CDDA7,1530547332646007
E50F7AC0680FD87AD6CE6B6700D209A7,1530551578162009
7D613AF4DA0F508C7090E96FD73B7E6D,1530571965300008
D7EA8E3645EFFBD6443946179ED704A6,1530540178824008
59454BAC415BB1F18517C6FD2C023E49,1530535803536008
60CFF65B640769B6FD3BC9593EDF7C1D,1530575646345015
EBFE0623EF1109A89B392B9DF4375951,1530579875527008
CA04708DA02378999ECB402481FF1AE4,1530535905765007
C87CDC0C4F86B10B7467281D516929B5,1530566574138007
EA9A16D9042286D55399A418CC7A28F3,1530595720759006
8040FC9C0479C3B9A74ED298DD8F357D,1530591676725001
D7D49CC32C4A23AD56E8DEAE6878EC7B,1530569074007005
CE7404D5A8831F2DE46BD0A013A8ED64,1530532483201008
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584705538004
332FF17A7140DA319A07A72CA1CB6A5A,1530544386209010
0AAA02628D6A75EEC75D37DA84D04426,1530577474164008
50D8D0C89D69EDAE2F04E43E90DB59C1,1530548538865008
004D2DFEB866BFB00427DB2F530C1F3D,1530555922343008
0D17D0247F158FA3E40D21EFF46D1651,1530534796962023
472451071AED6FF801BC0FE66706FD27,1530535171941001
FFA9AE78B23263835F8AAED57713EBE9,1530544809486030
1213ED1E96B0A49B51C0F7683DB2ACCC,1530545900524014
E080406D26F71C9B8F331779CE8B82BA,1530550329748007
548C38A983EB2EB88DC1DEEA9DE6DED9,1530568295460007
F47CF9AFCC314481CAF183DC6836965E,1530547671223008
C8685B0DFA2C4B4E6E6EA72894C30F6F,1530542035764007
9F5F895A86C3F594339330FB7275EE6D,1530590679338012
4B2605822194ABE869CE8DE6DCE0395E,1530527408222001
22FC699EA575027C5A7909E24A7F187D,1530572908268008
A2B8271B8CE580EC92A8D8CCAD85FE5C,1530538829829002
6A71951BC1C5F03C22E9E892AEB90B19,1530536671413005
C6DE585349744A40725DB0AB17041BA3,1530541062214016
E4C6FF8288DD4BFCDE93E2218E20643B,1530581720199007
BB063F0A226E371EAC4F1509183E333F,1530528699795009
909A16079F7183140ACF4C71A6CCDF3D,1530527709482008
3031EAD1E9D35306A37A0F3DC3B84A0A,1530539682696010
5CDFC86835249BE3DB5E9F6778E344AD,1530563541151009
F815B0069F973BFA743EF90A85224109,1530548878210007
4D084D38156128AAA060303AA91E689D,1530568792432011
E6FEE8B98E75EA5311FE004F98559A27,1530584782945008
48AB910A8DE8485D4C34238EA61F782C,1530524429332020
2F5B044B41268F6643EB4D0EF15D4E87,1530524279135074
2F8E2DBB938D2E43C2D171AF5F35EEF8,1530520042044005
64BA3BB3BD757CE7000D38CB7125E6DA,1530578266926009
C795AFA7F574C2BB09D3647AD90A9719,1530522583459011
E451D416F972019604F1456533FF3858,1530589733196009
AFE7A3E11C66E71FA9EA7B138700EC44,1530542942271008
5E694DE02688C2FDDEA38A6946A4CC3F,1530562716602009
B75F91EB6C7FDA9A329567E763CF9E44,1530561358542015
53866E32BA0ABFD846772D4B7B9B5921,1530541076164007
8EDB9A9856CDB5AFC42546106EE46734,1530543225081008
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,1530554360527008
84D135997D8A4D9CB35D4ECA46EF6861,1530520077430009
664F913ED3B54941B5F0886D94E01623,1530522383436005
2F5BBABE9DD0271DCD62E501F76DA736,1530543347988008
4CE503AE5B4C4F67A00474CE380CCC39,1530546742069007
3D03A380687FE3369E93915D50C572CB,1530573068701015
117AD1627465CC9E03AB5D8825D42E07,1530522884943007
920DB84FCC0F4421650B9E257E33180B,1530552925122006
D3F06F9B7BD9D7FC8758BF78BF0705E9,1530517358985007
97E7144B7FA861C3C8DB7424D7039832,1530573552024008
05FB3382D94C7E963B408FD6CC357D33,1530540114739007
41F62B68F0D1C05B6F17CFACD42913C5,1530574931809024
B75FCD833DE643B45B326D2E7AC413E4,1530550088914007
932AAF56DDE9C55359B9CCFA18E7FB95,1530540132657009
E512079B53179DF9A608CF4ADE47DE9D,1530560684457006
C09F04828B07E4DFEF39DA5C4A976A90,1530552491794008
19DEEA6B15B314DB0ED2A4936959D8F9,1530592349086001
98578513E0F25350F961CDCBA9D3656F,1530572659870008
3E8023D
Query:
SELECT f.value:"value"::STRING AS "quickplay_event_type",
       COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
GROUP BY "quickplay_event_type"
ORDER BY "event_count" DESC
LIMIT 100
Answer:
quickplay_event_type,event_count
"{""string_value"":""S""}",10281
"{""string_value"":""M""}",1186
"{""string_value"":""L""}",466
Query:
SELECT DISTINCT "user_pseudo_id",
       f.value:"value"::STRING AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
     LATERAL FLATTEN(input => "event_params") f
WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,quickplay_event_type
654F30C1312F6C1A26DFDA9F076A62D8,"{""string_value"":""S""}"
65D7715C409E6A38667447CE2B52AFFE,"{""string_value"":""S""}"
B205B117C82A24AA95E663FFB7D04718,"{""string_value"":""S""}"
EF9E8CCCCBBB015CAE0C334AB1745417,"{""string_value"":""M""}"
83D8C7F90DAF2C832F05A9DDD8693135,"{""string_value"":""L""}"
0F67E233B19D2898229CD156974A93AE,"{""string_value"":""S""}"
5217AB1A454DAED6243E1C9818BE6A20,"{""string_value"":""S""}"
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,"{""string_value"":""S""}"
38D4084307B6D1CEA37A48981753428E,"{""string_value"":""S""}"
0373DF7959F6867CDFB1C905D39CE67C,"{""string_value"":""M""}"
0373DF7959F6867CDFB1C905D39CE67C,"{""string_value"":""L""}"
D34924C19421D7E083FD387D97765F94,"{""string_value"":""S""}"
C136A7CE1D0A52B8D4E5F144DF114EB7,"{""string_value"":""L""}"
49309C5759610DBF6C829C0D4AB23943,"{""string_value"":""S""}"
08D399C66188D9A356AFAD5E2B2BA45E,"{""string_value"":""S""}"
909A16079F7183140ACF4C71A6CCDF3D,"{""string_value"":""M""}"
3031EAD1E9D35306A37A0F3DC3B84A0A,"{""string_value"":""S""}"
05407E04B9FA64CB63D8FA1D966AD6A2,"{""string_value"":""M""}"
5CDFC86835249BE3DB5E9F6778E344AD,"{""string_value"":""S""}"
D0F280B12652EB0D74F6BC74AB13606F,"{""string_value"":""S""}"
DE4912FBC5F915C027000A8A6FF44F85,"{""string_value"":""S""}"
E6FEE8B98E75EA5311FE004F98559A27,"{""string_value"":""S""}"
2F5B044B41268F6643EB4D0EF15D4E87,"{""string_value"":""S""}"
7101B4232F5B26A9C987C54F8717DCDC,"{""string_value"":""S""}"
4948BEDE78FC6EBA9899F26BF5C53897,"{""string_value"":""S""}"
88A41BFED275BB69125BE1F5524F3B42,"{""string_value"":""S""}"
A87A30159D909E2356F72AAC76F26707,"{""string_value"":""S""}"
2F8E2DBB938D2E43C2D171AF5F35EEF8,"{""string_value"":""S""}"
A064A84CD3CF7058F39333D6212E8615,"{""string_value"":""S""}"
76BB576278338D2E508DE5D705241B47,"{""string_value"":""S""}"
7207044281C74501C14233463AAD9A71,"{""string_value"":""S""}"
4BDC831A6940071E2461D0B5293A329E,"{""string_value"":""L""}"
64BA3BB3BD757CE7000D38CB7125E6DA,"{""string_value"":""S""}"
C795AFA7F574C2BB09D3647AD90A9719,"{""string_value"":""S""}"
59454BAC415BB1F18517C6FD2C023E49,"{""string_value"":""S""}"
CA04708DA02378999ECB402481FF1AE4,"{""string_value"":""S""}"
664F913ED3B54941B5F0886D94E01623,"{""string_value"":""S""}"
4CE503AE5B4C4F67A00474CE380CCC39,"{""string_value"":""S""}"
D3F06F9B7BD9D7FC8758BF78BF0705E9,"{""string_value"":""S""}"
60CFF65B640769B6FD3BC9593EDF7C1D,"{""string_value"":""L""}"
8EDB9A9856CDB5AFC42546106EE46734,"{""string_value"":""S""}"
84D135997D8A4D9CB35D4ECA46EF6861,"{""string_value"":""S""}"
3D03A380687FE3369E93915D50C572CB,"{""string_value"":""S""}"
B7701369F8598A25DED0499DAD3BE85D,"{""string_value"":""S""}"
85549E512A7BB6B13BD956D427B86C74,"{""string_value"":""S""}"
EB1A430BACB37E6EA72592BF838E64A6,"{""string_value"":""S""}"
B75FCD833DE643B45B326D2E7AC413E4,"{""string_value"":""S""}"
DE0CCACD4BB0DBB022445718217A0819,"{""string_value"":""S""}"
3E8023DB1D342304C2D6BD56705C4687,"{""string_value"":""S""}"
004D2DFEB866BFB00427DB2F530C1F3D,"{""string_value"":""S""}"
5D5895B1267014C54ECBE08864420979,"{""string_value"":""S""}"
3A58859E074B02E8FB1CAEA291636112,"{""string_value"":""S""}"
706C748E6D1E0768BFEFE6362B5D3F67,"{""string_value"":""S""}"
F815B0069F973BFA743EF90A85224109,"{""string_value"":""S""}"
4D084D38156128AAA060303AA91E689D,"{""string_value"":""M""}"
3EF8FC940E379D53BBD3FEFDAF626BB2,"{""string_value"":""S""}"
48AB910A8DE8485D4C34238EA61F782C,"{""string_value"":""M""}"
7842C62D45ECE888132F21C9F4417B21,"{""string_value"":""S""}"
672B24B51143CC66DCBAA0FA88C38D57,"{""string_value"":""S""}"
920DB84FCC0F4421650B9E257E33180B,"{""string_value"":""S""}"
AE920B86560554C0BE3F888EDBA2BBF7,"{""string_value"":""S""}"
037DAC225F0C1E54657770CD201CDDA7,"{""string_value"":""S""}"
E50F7AC0680FD87AD6CE6B6700D209A7,"{""string_value"":""S""}"
7D613AF4DA0F508C7090E96FD73B7E6D,"{""string_value"":""S""}"
FEDC59699D8832A11B88BFCCCAD0951D,"{""string_value"":""S""}"
E451D416F972019604F1456533FF3858,"{""string_value"":""S""}"
AFE7A3E11C66E71FA9EA7B138700EC44,"{""string_value"":""S""}"
5E694DE02688C2FDDEA38A6946A4CC3F,"{""string_value"":""S""}"
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,"{""string_value"":""S""}"
11A8D6037368A4C4508B11ADB4353BC4,"{""string_value"":""M""}"
C87CDC0C4F86B10B7467281D516929B5,"{""string_value"":""S""}"
2F5BBABE9DD0271DCD62E501F76DA736,"{""string_value"":""S""}"
97E7144B7FA861C3C8DB7424D7039832,"{""string_value"":""S""}"
2B1A8699D5D9CC85A21E5AD20A5F1278,"{""string_value"":""S""}"
CE7404D5A8831F2DE46BD0A013A8ED64,"{""string_value"":""S""}"
8040FC9C0479C3B9A74ED298DD8F357D,"{""string_value"":""S""}"
05FB3382D94C7E963B408FD6CC357D33,"{""string_value"":""S""}"
E2D6E7FE36B7CDD0789CC8F03CC747E0,"{""string_value"":""S""}"
B141B75E5E5D48DAD8298F91B94A2E07,"{""string_value"":""S""}"
932AAF56DDE9C55359B9CCFA18E7FB95,"{""string_value"":""S""}"
E512079B53179DF9A608CF4ADE47DE9D,"{""string_value"":""S""}"
C09F04828B07E4DFEF39DA5C4A976A90,"{""string_value"":""S""}"
19DEEA6B15B314DB0ED2A4936959D8F9,"{""string_
Query:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  WHERE "event_name" LIKE '%quickplay%'
)
LIMIT 100
Answer:
user_pseudo_id
5217AB1A454DAED6243E1C9818BE6A20
0373DF7959F6867CDFB1C905D39CE67C
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
7842C62D45ECE888132F21C9F4417B21
4BDC831A6940071E2461D0B5293A329E
037DAC225F0C1E54657770CD201CDDA7
FEDC59699D8832A11B88BFCCCAD0951D
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
11A8D6037368A4C4508B11ADB4353BC4
CA04708DA02378999ECB402481FF1AE4
C87CDC0C4F86B10B7467281D516929B5
EA9A16D9042286D55399A418CC7A28F3
B75FCD833DE643B45B326D2E7AC413E4
932AAF56DDE9C55359B9CCFA18E7FB95
E512079B53179DF9A608CF4ADE47DE9D
98578513E0F25350F961CDCBA9D3656F
0CAAA1B6F161BA4D363EB7A2DEF64A08
B5F3D00E28A57C9522F2DEE3CB903DD1
5CC434A43CB09640FC6BE2D7A18183E4
1213ED1E96B0A49B51C0F7683DB2ACCC
6A07135DA41B81E278341576A26672E4
E080406D26F71C9B8F331779CE8B82BA
4AB0441290F6077849CBE9C74A828F0A
C639CACA07D03F536F537ED779CF6599
229254D7C810F98F72C89A8060E194D4
29BC86DCA0D500C9410F392B57C28DD3
1F0D27B8A7E058446D4A6409E2E73B19
F655D26B0F7A4093F1D2FFBD5E61B09D
C3326C2CCF5D46173E4973A13512B163
682A8CD0767A569DC68E7AA0201BFBA3
B141B75E5E5D48DAD8298F91B94A2E07
EB1A430BACB37E6EA72592BF838E64A6
004D2DFEB866BFB00427DB2F530C1F3D
03A9D32C44665A9E15CFCCEDC9F68EDB
B5395F8C2077B59B3D6C5719C0CA0339
1CF315BC6864E7A71A81E47925E18A61
E6B6CAE2D200FC3EACF21DDE75402DCD
3875A92B5F5C2BBA1355CED06A986079
4EF964D59282E5A2C8692D30F011256B
7BEC6B06860D25AE7E44CA49AB939BBF
0C777BD44F304574371C97674DCD0702
93A7A5C31807490E878F4164A6418BFC
7EE035CA8E6132A8877C39656896BA41
472451071AED6FF801BC0FE66706FD27
89BD2B0E233951461CF06C9B4FDA0D81
84E491A60BE52A4C6A438A89FADE283C
28C4A09298C441D5AFD39E749D9F3DA3
B10AE521352392E4981BA07E0D86081C
E50F7AC0680FD87AD6CE6B6700D209A7
0D17D0247F158FA3E40D21EFF46D1651
E5A2CB7A471E740E758BE5E2E0C79BC2
A2B7DF97E146FC5AB4C8F89A94D85B4A
7E40E634997585B0C69B6F67C01C191B
B63075B53A750A67A12F7F19ED5AA835
4D33ED6DCCD63BBED146B6060B307CAF
3D1B58553D2E2D4DD5DFCF251D5E23B2
2B7787A34C362AA51FF8E4DD031A2F70
FC48EDE912EDD9F8D7ED45F697EE7193
55BFC405FFA33C0781DE73101011E45B
CFA0F8C5E25A71062E573EF8E6BC9F76
DA48D36D07835B1918BDF831AF83B5EF
372D9BB5088C4E9000C65B06459B403A
13E6C8A193FF140F7D4222B569DD5B50
0F93A84CB0774C5BAB3E5FF8A72A694D
12E5626928FE0885DEEF068683E8BD63
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
4CE503AE5B4C4F67A00474CE380CCC39
10B0D468B5E036E16D13DB53A65F2D49
BE36C49B1AB3968D420923AEC4FDD7AE
A74C05E503F6274BAA9457B2265471F5
81BFFE61CAB181676917D75F1B617CB2
F2A1FD8B142EB4C6CAAE415FA1917F50
3D9A1566A6D35AC1D20B7D125637B637
C6DE585349744A40725DB0AB17041BA3
24EED66707DBBEAE56954F7F45B834F1
74456352647C13028F89D1EEFFB905F4
E4C6FF8288DD4BFCDE93E2218E20643B
437E1E4F1A7DF0CC995FCE10EAC96350
6683CAFB77FB7B60C78CD233EB2B62F7
B458770ED6E295374FEEB3A68902CC28
96161BF2E55C7E32ED5F411432875ECB
2B90CE94C6039DF03E72FE15B5320ABA
AD99B4950F9D70E0FD5E8563F2A664FB
8211CABE9A3F1FE1BF3154E0C8D30368
C7E2273D8B11257FCCC915D27C1FCA24
7386D239899D55E3D62DA619F359A7C0
CABE7E24215A5C36862658A36AE5CE12
096C23E69254818F7EE03C1239005F2B
A0616D4E494DC3BCCB94B8B6E5B48380
4EF1041DB2A406750E4A46AFD78FB543
8F6C5F7611B67A4A437FF283B6C10181
D8A6BDFA89F65FC9B5159A3031C33004
8D9D62A4402581BB1181D3AA73AD54E8
D4F4DAEF5BE38E5C67FD72BB1F082EBF
Query:
SELECT *
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  WHERE "event_name" LIKE '%quickplay%'
)
LIMIT 100
Answer:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform
20180716,1531796092182005,post_score,"[
  {
    ""key"": ""time"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  },
  {
    ""key"": ""score"",
    ""value"": {
      ""double_value"": 4.000000000000000e+00
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""double_value"": 5.532138157231706e+18
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_0""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  }
]",1531704253013005,,230,-88255857,,5217AB1A454DAED6243E1C9818BE6A20,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1529861622278000,
      ""string_value"": ""4""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1529861622278000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1530125581768000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1531796034371000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1529921012727000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1529861624039000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1529861622387000,
      ""string_value"": ""0""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1529861553949000,
      ""set_timestamp_micros"": 1529861606949000
    }
  }
]",1529861553949000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""organic"",
  ""source"": ""google""
}",1051193346,ANDROID
20180716,1531796223490047,post_score,"[
  {
    ""key"": ""time"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  },
  {
    ""key"": ""score"",
    ""value"": {
      ""double_value"": 1.000000000000000e+00
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""double_value"": 5.532138157231706e+18
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_0""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 0.000000000000000e+00
    }
  }
]",1531795999182047,,230,-88255857,,5217AB1A454DAED6243E1C9818BE6A20,"[
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1529861600278000,
      ""string_value"": ""4""
    }
  },
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1529861600278000,
      ""string_value"": ""3""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1530125559768000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1531796012371000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""firebase_exp_4"",
    ""value"": {
      ""set_timestamp_micros"": 1529920990727000,
      ""string_value"": ""2""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1529861602039000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1529861600387000,
    
Query:
SELECT qp."quickplay_event_type", COUNT(DISTINCT r."user_pseudo_id") AS "returning_users"
FROM (
  SELECT "user_pseudo_id",
         f.value:"value"::STRING AS "quickplay_event_type"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702",
       LATERAL FLATTEN(input => "event_params") f
  WHERE "event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
) qp
JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716" r
  ON qp."user_pseudo_id" = r."user_pseudo_id"
GROUP BY qp."quickplay_event_type"
ORDER BY "returning_users" DESC
LIMIT 100
Answer:
quickplay_event_type,returning_users
"{""string_value"":""S""}",90
"{""string_value"":""M""}",17
"{""string_value"":""L""}",10
End Exploring Related Columns
Task: What is the retention rate for users two weeks after their initial quickplay event within the period from July 2, 2018, to July 16, 2018, calculated separately for each quickplay event type?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Quickplay_Event_Type,Retention_Rate
type1:str,rate1:0<=float<=100
type2:str,rate2:0<=float<=100
...
```

We calculated the retention rate for users two weeks after their initial quickplay event between July 2, 2018, and July 16, 2018, separately for each quickplay event type..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 06:50:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:50:03 - root - INFO - ```sql
WITH quickplay_events AS (
  SELECT
    e."user_pseudo_id",
    e."event_timestamp",
    e."event_date",
    f.value:"value":"string_value"::STRING AS "quickplay_event_type"
  FROM (
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  ) e,
  LATERAL FLATTEN(input => e."event_params") f
  WHERE e."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
),
initial_quickplay_events AS (
  SELECT
    q."user_pseudo_id",
    MIN(q."event_timestamp") AS "initial_event_timestamp"
  FROM quickplay_events q
  GROUP BY q."user_pseudo_id"
),
initial_quickplay_users AS (
  SELECT
    iqe."user_pseudo_id",
    iqe."initial_event_timestamp",
    q."quickplay_event_type"
  FROM initial_quickplay_events iqe
  JOIN quickplay_events q
    ON iqe."user_pseudo_id" = q."user_pseudo_id" AND iqe."initial_event_timestamp" = q."event_timestamp"
),
all_events AS (
  SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
)
SELECT
  iqu."quickplay_event_type" AS "Quickplay_Event_Type",
  ROUND((COUNT(DISTINCT ead."user_pseudo_id")::FLOAT / COUNT(DISTINCT iqu."user_pseudo_id")::FLOAT) * 100, 4) AS "Retention_Rate"
FROM initial_quickplay_users iqu
LEFT JOIN (
  SELECT DISTINCT ae."user_pseudo_id"
  FROM all_events ae
  JOIN initial_quickplay_users iqu2 ON ae."user_pseudo_id" = iqu2."user_pseudo_id"
  WHERE ae."event_timestamp" >= iqu2."initial_event_timestamp" + 1209600000000
) ead ON iqu."user_pseudo_id" = ead."user_pseudo_id"
GROUP BY iqu."quickplay_event_type";
```
2025-01-23 06:50:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:50:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:50:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:50:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 06:50:21 - snowflake.connector.connection - INFO - closed
2025-01-23 06:50:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:50:21 - root - INFO - itercount: 1
2025-01-23 06:50:21 - root - INFO - 0
2025-01-23 06:50:21 - root - INFO - results: 
Quickplay_Event_Type,Retention_Rate
S,59.0879
L,70.0787
M,73.8462


2025-01-23 06:50:21 - root - INFO - Please check the answer again by reviewing What is the retention rate for users two weeks after their initial quickplay event within the period from July 2, 2018, to July 16, 2018, calculated separately for each quickplay event type?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Quickplay_Event_Type,Retention_Rate
type1:str,rate1:0<=float<=100
type2:str,rate2:0<=float<=100
...
```

We calculated the retention rate for users two weeks after their initial quickplay event between July 2, 2018, and July 16, 2018, separately for each quickplay event type. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Quickplay_Event_Type,Retention_Rate
S,59.0879
L,70.0787
M,73.8462
Current sql:
WITH quickplay_events AS (
  SELECT
    e."user_pseudo_id",
    e."event_timestamp",
    e."event_date",
    f.value:"value":"string_value"::STRING AS "quickplay_event_type"
  FROM (
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  ) e,
  LATERAL FLATTEN(input => e."event_params") f
  WHERE e."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
),
initial_quickplay_events AS (
  SELECT
    q."user_pseudo_id",
    MIN(q."event_timestamp") AS "initial_event_timestamp"
  FROM quickplay_events q
  GROUP BY q."user_pseudo_id"
),
initial_quickplay_users AS (
  SELECT
    iqe."user_pseudo_id",
    iqe."initial_event_timestamp",
    q."quickplay_event_type"
  FROM initial_quickplay_events iqe
  JOIN quickplay_events q
    ON iqe."user_pseudo_id" = q."user_pseudo_id" AND iqe."initial_event_timestamp" = q."event_timestamp"
),
all_events AS (
  SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
)
SELECT
  iqu."quickplay_event_type" AS "Quickplay_Event_Type",
  ROUND((COUNT(DISTINCT ead."user_pseudo_id")::FLOAT / COUNT(DISTINCT iqu."user_pseudo_id")::FLOAT) * 100, 4) AS "Retention_Rate"
FROM initial_quickplay_users iqu
LEFT JOIN (
  SELECT DISTINCT ae."user_pseudo_id"
  FROM all_events ae
  JOIN initial_quickplay_users iqu2 ON ae."user_pseudo_id" = iqu2."user_pseudo_id"
  WHERE ae."event_timestamp" >= iqu2."initial_event_timestamp" + 1209600000000
) ead ON iqu."user_pseudo_id" = ead."user_pseudo_id"
GROUP BY iqu."quickplay_event_type";
2025-01-23 06:51:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 400 model_error"
2025-01-23 06:51:59 - root - INFO - Please check the answer again by reviewing What is the retention rate for users two weeks after their initial quickplay event within the period from July 2, 2018, to July 16, 2018, calculated separately for each quickplay event type?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Quickplay_Event_Type,Retention_Rate
type1:str,rate1:0<=float<=100
type2:str,rate2:0<=float<=100
...
```

We calculated the retention rate for users two weeks after their initial quickplay event between July 2, 2018, and July 16, 2018, separately for each quickplay event type. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Quickplay_Event_Type,Retention_Rate
S,59.0879
L,70.0787
M,73.8462
Current sql:
WITH quickplay_events AS (
  SELECT
    e."user_pseudo_id",
    e."event_timestamp",
    e."event_date",
    f.value:"value":"string_value"::STRING AS "quickplay_event_type"
  FROM (
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  ) e,
  LATERAL FLATTEN(input => e."event_params") f
  WHERE e."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
),
initial_quickplay_events AS (
  SELECT
    q."user_pseudo_id",
    MIN(q."event_timestamp") AS "initial_event_timestamp"
  FROM quickplay_events q
  GROUP BY q."user_pseudo_id"
),
initial_quickplay_users AS (
  SELECT
    iqe."user_pseudo_id",
    iqe."initial_event_timestamp",
    q."quickplay_event_type"
  FROM initial_quickplay_events iqe
  JOIN quickplay_events q
    ON iqe."user_pseudo_id" = q."user_pseudo_id" AND iqe."initial_event_timestamp" = q."event_timestamp"
),
all_events AS (
  SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
)
SELECT
  iqu."quickplay_event_type" AS "Quickplay_Event_Type",
  ROUND((COUNT(DISTINCT ead."user_pseudo_id")::FLOAT / COUNT(DISTINCT iqu."user_pseudo_id")::FLOAT) * 100, 4) AS "Retention_Rate"
FROM initial_quickplay_users iqu
LEFT JOIN (
  SELECT DISTINCT ae."user_pseudo_id"
  FROM all_events ae
  JOIN initial_quickplay_users iqu2 ON ae."user_pseudo_id" = iqu2."user_pseudo_id"
  WHERE ae."event_timestamp" >= iqu2."initial_event_timestamp" + 1209600000000
) ead ON iqu."user_pseudo_id" = ead."user_pseudo_id"
GROUP BY iqu."quickplay_event_type";
2025-01-23 06:51:59 - root - INFO - Exceeded
2025-01-23 06:51:59 - root - INFO - Please check the answer again by reviewing What is the retention rate for users two weeks after their initial quickplay event within the period from July 2, 2018, to July 16, 2018, calculated separately for each quickplay event type?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Quickplay_Event_Type,Retention_Rate
type1:str,rate1:0<=float<=100
type2:str,rate2:0<=float<=100
...
```

We calculated the retention rate for users two weeks after their initial quickplay event between July 2, 2018, and July 16, 2018, separately for each quickplay event type. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Quickplay_Event_Type,Retention_Rate
S,59.0879
L,70.0787
M,73.8462
Current sql:
WITH quickplay_events AS (
  SELECT
    e."user_pseudo_id",
    e."event_timestamp",
    e."event_date",
    f.value:"value":"string_value"::STRING AS "quickplay_event_type"
  FROM (
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  ) e,
  LATERAL FLATTEN(input => e."event_params") f
  WHERE e."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
),
initial_quickplay_events AS (
  SELECT
    q."user_pseudo_id",
    MIN(q."event_timestamp") AS "initial_event_timestamp"
  FROM quickplay_events q
  GROUP BY q."user_pseudo_id"
),
initial_quickplay_users AS (
  SELECT
    iqe."user_pseudo_id",
    iqe."initial_event_timestamp",
    q."quickplay_event_type"
  FROM initial_quickplay_events iqe
  JOIN quickplay_events q
    ON iqe."user_pseudo_id" = q."user_pseudo_id" AND iqe."initial_event_timestamp" = q."event_timestamp"
),
all_events AS (
  SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
)
SELECT
  iqu."quickplay_event_type" AS "Quickplay_Event_Type",
  ROUND((COUNT(DISTINCT ead."user_pseudo_id")::FLOAT / COUNT(DISTINCT iqu."user_pseudo_id")::FLOAT) * 100, 4) AS "Retention_Rate"
FROM initial_quickplay_users iqu
LEFT JOIN (
  SELECT DISTINCT ae."user_pseudo_id"
  FROM all_events ae
  JOIN initial_quickplay_users iqu2 ON ae."user_pseudo_id" = iqu2."user_pseudo_id"
  WHERE ae."event_timestamp" >= iqu2."initial_event_timestamp" + 1209600000000
) ead ON iqu."user_pseudo_id" = ead."user_pseudo_id"
GROUP BY iqu."quickplay_event_type";
2025-01-23 06:51:59 - root - INFO - Total iteration counts: 1
