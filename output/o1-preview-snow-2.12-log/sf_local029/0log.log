2025-02-10 15:56:04 - openai._base_client - INFO - Retrying request to /chat/completions in 0.421325 seconds
2025-02-10 15:57:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 15:57:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:07 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:08 - root - INFO - SQL:
-- 1. Retrieve basic customer information.
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS
LIMIT 100;
Results:
Too long, hard cut:
customer_id,customer_unique_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade,GO
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel,PR
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia,DF
03f846ad034

2025-02-10 15:57:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:09 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:09 - root - INFO - SQL:
-- 2. View orders with their statuses.
SELECT "order_id", "customer_id", "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,invoiced
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,shipped
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,delivered
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,delivered
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,delivered
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,delivered
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,delivered
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,delivered
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,delivered
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,delivered
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,delivered
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,delivered
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a4d489a44166894938,delivered
688052146432ef8253587b930b01a06d,81e08b08e5ed4472008030d70327c71f,delivered
f271576bed568e896f99eb710cd3a

2025-02-10 15:57:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:10 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:11 - root - INFO - SQL:
-- 3. List delivered orders.
SELECT "order_id", "customer_id", "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
WHERE "order_status" = 'delivered'
LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,delivered
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,delivered
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,delivered
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,delivered
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,delivered
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,delivered
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,delivered
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,delivered
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,delivered
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,delivered
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a4d489a44166894938,delivered
688052146432ef8253587b930b01a06d,81e08b08e5ed4472008030d70327c71f,delivered
f271576bed568e896f99eb710cd3a6f8,5dda11942d4f77bee3a46d71e442aec4,delivered
686541986ecfb7d9296eb67719973bf0,74805bc388861fa350ed2fade8444e0b,delivered
68e48e68da1f50f7c5838ea75e

2025-02-10 15:57:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:12 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:12 - root - INFO - SQL:
-- 4. Display payment values for orders.
SELECT "order_id", "payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS
LIMIT 100;
Results:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27

2025-02-10 15:57:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:13 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:14 - root - INFO - SQL:
-- 5. Join orders with customers to associate orders with customer unique IDs.
SELECT o."order_id", o."customer_id", c."customer_unique_id", o."order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,customer_unique_id,order_status
00e7ee1b050b8499577073aeb2a297a1,06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,delivered
29150127e6685892b6eab3eec79f59c7,18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,delivered
b2059ed67ce144a36e2aa97d2c9e9ad2,4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,delivered
951670f92359f4fe4a63112aa7306eba,b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,delivered
6b7d50bd145f6fc7f33cebabd7e49d0f,4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,delivered
5741ea1f91b5fbab2bd2dc653a5b5099,879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,delivered
36e694cf4cbc2a4803200c35e84abdc4,fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,delivered
1093c8304c7a003280dd34598194913d,5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,delivered
1ebeea841c590e86a14a0d7a48e7d062,5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,delivered
7433cbcc783205509d66a5260da5b574,4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,delivered
8428e578bb1cf839ae26a6b7615502b9,9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,delivered
f86c5ed7048ac10eb88ec21c00f71892,5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,delivered
83d8f70418eefd96f37b483dff430305,b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,delivered
852d2f4d37773bcbc21c8e09a05a4ea5,eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,delivered
6c949e670b5d33dc8fb8ad25b6da4860,1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,delivered
eac76692452422620996fe5e1a7f8bb0,206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,delivered
72bab69c50432c6f94d8b50a5f84b69a,a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,delivered
ec28553b12bef4b538e5d7454464a1c6,c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,delivered
17825f24877a9289214c301ae0c9424b,9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,delivered
ab797176e01c2fa3d13aa1fe3e63d9ee,49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,delivered
830d8b3e6875ef6165ffc33219ab4fea,154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,delivered
aaff8afa47c8426e414a6d908a97713c,690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,delivered
0198c71148c2e08c7c52b860f640fa4e,2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,delivered
eac4ffbe456464bdc3ce5f001b6439c5,237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,delivered
6cdc131d3c28253cd03cd0fbc3d5f938,cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,delivered
daf946e879dab6e7e6b3f968297c3fe3,f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,delivered
d10eafa208521dc30796e6a26099b6a6,167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,delivered
a8f5a2b22f55e0af45b300929d1fdc7d,6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,delivered
3a6d41a4fe7a8e841b7c8e4b77d4e301,e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,delivered
0330631bdb2ec8c341f487ed9c22fc8b,e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,delivered
2904d3ae0064e840ffb4798ba4a12ae3,261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,delivered
f3b96845efd71daecf6b331fb3a9f537,6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,delivered
19c0c76962278b152cc44fc63ffd5e48,2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,delivered
77b062be7c5bd21712905feb8e1cfeed,b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,delivered
a9119eb77d6200811953803a7b6539e1,469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,delivered
72bd19ef4fa285334b95bda01a3718c7,df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,delivered
4ca8a781d1f4b13e966bf35cdc333f56,41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,delivered
d4668cd8ef48b78df597195703c95da2,54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,delivered
997fd4b37386d10b57d4ac8cdec011a6,4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,delivered
47cb08d5bac6105ae32587814fca96ca,b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,delivered
42cebac003b40e6aa0b3e37b99d83c2f,4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,delivered
1bae3477022e0394ab9af1d25a242fd0,c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,delivered
2dd604f5ec1bd2f58c14e9908c7df826,a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,delivered
a74869096437cef33d04006e8480e0db,0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,delivered
04a92860751dfe7ae41f71e1228ffd18,c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,delivered
14282bc70be9bdda515182fb1ce62af4,19cecb194

2025-02-10 15:57:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:15 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:15 - root - INFO - SQL:
-- 6. Count the number of delivered orders per customer.
SELECT c."customer_unique_id", COUNT(*) AS "num_delivered_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Results:
customer_unique_id,num_delivered_orders
8d50f5eadf50201ccdcedfb9e2ac8455,15
3e43e6105506432c953e165fb2acf44c,9
1b6c7548a2a1f9037c1fd3ddfed95f33,7
ca77025e7201e3b30c44b472ff346268,7
6469f99c1f9dfae7733b25662e7f1782,7
47c1a3033b8b77b3ab6e109eb4d5fdf3,6
12f5d6e1cbf93dafd9dcc19095df0b3d,6
f0e310a6839dce9de1638e0fe5ab282a,6
dc813062e0fc23409cd255f7f53c7074,6
63cfc61cee11cbe306bff5857d00bfe4,6
4e65032f1f574189fb793bac5a867bbc,5
de34b16117594161a6a89c50b289d35a,5
fe81bb32c243a86b2f86fbf053fe6140,5
35ecdf6858edc6427223b64804cf028e,5
b4e4f24de1e8725b74e4a1f4975116ed,5
394ac4de8f3acb14253c177f0e15bc58,5
74cb1ad7e6d5674325c1f99b5ea30d82,5
5e8f38a9a1c023f3db718edcf926a2db,5
56c8638e7c058b98aae6d74d2dd6ea23,5
f34cd7fd85a1f8baff886edf09567be3,4
a73c5464692d3bc09d64e3edefae9015,4
7305430719d715992b00be82af4a6aa8,4
12d8b5ed661190a3a08183644dfc504d,4
b39dde6dd619943190a8cc9aa6db38a4,4
c8460e4251689ba205045f3ea17884a1,4
d3359a56d96666ac0c21bb01e7a61c95,4
83e7958a94bd7f74a9414d8782f87628,4
ec7f1811826ab04a27a92197bc40c888,4
b896655e2083a1d76b7b85df8fc86e40,4
acea6bd29b8c1e3c6a8b266a8fb4475e,4
738ffcf1017b584e9d2684b36e07469c,4
a1874c5550d2f0bc14cc122164603713,4
a239b8e2fbce33780f1f1912e2ee5275,4
f64ec6d8dd29940264cd0bbb5ecade8a,4
9cc5a07f169a1606fd347a56683e6ea6,4
b2bd387fdc3cf05931f0f897d607dc88,4
08e5b38d7948d37fbb2a59fc5e175ab1,4
a0abd26659c9914690cbd3320d39fd96,4
4facc2e6fbc2bffab2fea92d2b4aa7e4,4
795c1622cf7a53d63d324e862349d01c,4
a7657330b1c135f3acd420326e335b2c,4
b08fab27d47a1eb6deda07bfd965ad43,4
2ddc001b620bd90d0f4378cfde1db887,4
397b44d5bb99eabf54ea9c2b41ebb905,4
6358b15ef7fa9b1210f1a5735cabd3d9,4
c37cc6c1a59d81460a3059744f7ada1c,4
25a560b9a6006157838aab1bdbd68624,4
dc48b0a1b0e6abb6586f322c189f6b93,3
a72a2d4e19868dba726c0e6f49198c7e,3
e68e1b61896163cdd7f8e07b2ae814c9,3
98e3117841a2431959d17808f04bf23c,3
8c21dd8c37144807c601f99f2a209dfb,3
31d332d20895c5c0baefe55207a0fead,3
e2492e4188991b6276a4a62a287a5451,3
06a52782a04f0086d16b9c22d0e29438,3
1fbd81e4d0a0cf9125ca038b43533b7f,3
c9b3b24308b1a4587ffa3e60fafc2b1f,3
4e1cce07cd5937c69dacac3c8b13d965,3
d132b863416f85f2abb1a988ca05dd12,3
8dafb82f687e3b0dc9e97b4198b92128,3
732d307839b02bc2d3a4c26b515ea2b9,3
51d91326ffc0688da14a001de38c264b,3
c76762dfb642ac154475239639f7f8f4,3
18a65d67bb184e736656cc017f09f7b8,3
acaf5177d6de60fda7ce77c48abb5230,3
db07fd2ad9869f8356b1fbeefdac31e8,3
e30b83af13d6ff0b0f427b2a67c43b39,3
2e43e031f10de28e557c35ef668f9396,3
6f64406ed5cfa4a2d9bd35e91bfd6587,3
e226254ce0c6d5b7a7ef7218c9b5b518,3
9947c0ed8bf41cd508a78da36abc1d41,3
d7624d219b6ffad980e91412174db310,3
d3882d7abd0c66064d740d7ed04dd1ef,3
ba87a137c5191264841e0be40e53f4ed,3
fe59d5878cd80080edbd29b5a0a4e1cf,3
310647380793836bfa5b7b6b3f518423,3
64df076fb557552498049bb07ed1cd5f,3
0a609db8d244100909a15d65eadf8539,3
9aae8213ff9bc04cc3ce48b85f43a173,3
fc719c11b4dce594f47e1f9aa739a3a2,3
3de0c9303f39b7ccfe69ca11aee19cc6,3
23339103d82a054f9729b0554ce22e8c,3
7588c20c457369de8caad958afc1cc06,3
7589544c08cc5de364cad85ee73f4b63,3
02e9109b7e0a985108b43e573b6afb23,3
d75acd4c5b7b4dfd32b9d9172b195419,3
d26c616e241736e0c1c1ab14150239e7,3
46958f708ade6b6a88b2e5aca1e66de5,3
30a81e307f19e822e7199139fe52b1b0,3
7d3d94b4740895a17760e976797f9f0e,3
1373e04979cfa0fb2092909abbd57f25,3
90f323e9f0948ddd96c6f6a8ecc75830,3
ff922bdd6bafcdf99cb90d7f39cea5b3,3
cef29e793e232d30250331804cdb7000,3
549a24530925587e2faddb35f667e458,3
bd86b1862fe796149a4d2af57bd85451,3
3e5306add1209e5ba184092dd1587282,3
76a0491dd70c125840fa259f00dfc351,3
d4a5e9f19897de65433c9d97bf4b9f8e,3
b2e9a05d23ea17713b5d7799f2004f8e,3

2025-02-10 15:57:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:16 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:17 - root - INFO - SQL:
-- 7. Retrieve payment values along with customer unique IDs.
SELECT c."customer_unique_id", p."payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
Results:
customer_unique_id,payment_value
708ab75d2a007f0564aedd11139c7708,99.33
a8b9d3a27068454b1c98cc67d4e31e6f,24.39
6f70c0b2f7552832ba46eb57b1c5651e,65.71
87695ed086ebd36f20404c82d20fca87,107.78
4291db0da71914754618cd789aebcd56,128.45
6e3c218d5f0434ddc4af3d6a60767bbf,96.12
9a3526eee723accd014ec683afe5bf20,81.16
9db67268a3fee1d4b13faaeb90af07c0,51.84
2ecddf370925aff428e58b4f6021fe38,341.09
511c345b0383af6ef25406c564e4d6b6,51.95
a51f8568095ce89a4ffce365dcb7d46d,188.73
2faf4a1d502b10555a9f39353ea20148,141.9
198ab463c8a3a754aa6ae61b38c4c8db,75.78
ec103b892f579de25189dda196a4c5b3,102.66
9b61cfcf9bc923fed1c1c8d38fab5a1c,105.28
0ae522661311f598df20272643d39ce6,157.45
3129dce5dc566246ea1354bff5bb6fea,132.04
186638bdb0f600c9bf2bd60e4b14537c,98.94
501598d5821539430a35385474cd44d9,244.15
d386a136dc889cf681443061874caad8,136.71
5986b5f70bf08b414d16a93ac5b1d76c,47.69
79403f8240aafdd83128106b5b48fd43,170.57
bd5fb6a2e66d7bfb061efd93b994f168,67.5
14f64911f31f3722899596d1095a233e,353.09
d0c437f172b9c527c0d196815b92c5ce,330.66
e2381d9bb9b49c35fff077d4ae613816,45.17
d132b863416f85f2abb1a988ca05dd12,541.0
53829feb906370f277393325399b8487,139.22
67a7e94ec59ef6d6ba83942c81d39b9a,290.16
e9dc392ca45bbd1c3faf921ccd7ebbd1,283.34
9585898e80f9de26178eb04cd600b6f5,13.78
d0ad8d078320fd639fe1ef1bcbe0e4af,30.28
bf635aadfff238fd7e9b0d25e800d019,26.58
35aebf263a4418be92141cc28421c0e0,89.68
4872db1f116f7639293f1e960ac655d6,65.09
a6aa1df65dedcad75c34bbc175e5a068,173.84
3af91c25f393301d27ccd39bce43f29d,103.49
1504b719eb728716ff7583dc7b86a0b0,64.03
1b70f1238c390e4e7f01455440b09233,157.15
34dd888b565982c76c7a9ee9dc41db4e,130.88
1fe64a1a47422f65cb1c179f0ab5ee36,47.72
cdf4461e9701d83bfb42aa0e2319cd68,117.74
52cf00bf99b259287bcd5b5a766adf2a,56.6
2becf6f55d064453e6d7abe2af4ad36b,266.16
07314acd6253564af6a73a1cc8aca080,31.38
1801a172ccbf9172fa375bb6f0c9765e,121.49
35fd26e0b8e2aad867717d6e3227fc9d,32.0
a56a69b5c5e0e105c671353ee9caa01a,153.41
271d3cdd872021b1b6669ad93e8b856b,65.71
aec80ef34b077632b58f710c6d9476d3,278.22
f822326a71e929f4d905a15676a5cb48,91.66
5ceed695eeb968efc7959d859a902e00,132.51
74dc6a3e622375fc6aae191555a5a95a,542.66
78fc10170ee499077d81e1ed7b03fe6e,166.04
5b7f468205743c98e58a379722d3ae79,368.98
b807ae7957e78cf94c30251b4ddd0ed9,113.2
b1cae7084960bab5c863422a645dce72,99.43
8632c4862d819878dc37d5d2867d87ba,27.35
10e49a12540465d3141f898aeee0a6b4,43.77
47a0a92a1b4d507faa45c6d4910e9d2d,68.49
1defe0913f512f19056b668156476990,105.53
bcdd3f31625ec664aca676d1c101e753,387.8
f384ac31b4473faf74a4672c9d0d9c69,84.14
741996aa586218efdc5169365507510d,210.82
f42a3583d172ef020244c94136cac8db,90.05
ce4f5c53597a5a4e50f990e8e7676bd9,67.88
d7b23ec12acc9df1a7f032ae6b276976,37.58
f0e310a6839dce9de1638e0fe5ab282a,89.63
a2ac4c64994786e12db70e1782d2bfef,69.46
300077767cbc925601b3e23098cfc69a,78.3
0b11937f7f94a269cc94a3378be84839,50.8
1acc368e2db62752896a9e414eff41c2,34.0
3904ade0c6610a7c4fb9ec34259528f6,77.1
2a6f1c54c079bb319508a8278df9febc,566.4
30d2beed036d709d9e6ded9c08496981,402.42
764bf13c9f7df277b9c0950b88b4c3eb,57.53
ae74c314b9c383e5d7bcd99d54ffbc71,44.01
b07a68d575f329bb71dcbd58e3fb5a16,187.51
aec9d2bee598a5e8f88b3e9a8b29bc86,77.7
297ec5afd18366f5ba27520cc4954151,48.68
ecac07aedaa3221150cc28e6fa2e99db,77.29
9cd31aa2388af9525780c2e1c3ad4ff7,117.71
201e18d3b497478c79eaf7306aa38a21,169.34
7602a5a3d9acc46b565e9c6551c8f494,37.61
8fcf63613662e902d775fa5aa245c5e0,13.8
7d409442d2f22a2d058c1d1a19615324,227.12
adc3fee64ef2dad64eb6fbe5db907742,34.78
16211bcf5b07a02aaa15f592d88cd42f,342.56
8d384d9d49defe554f47b8186a206803,73.34
4320120e01ea53da8c84d35c246cc3e6,117.85
4f6e6a1e4d70f0210c1aa0861dfd5c78,48.62
fa1573613e47e14b61de057fcae891b0,53.99
28e4558f55bcf5b9f9ef85e9985f1810,51.14
89d4ec26627e7fe35be69c0512748842,121.45
d94137816541d7919b82c664a8f3937f,73.34
127d41455fd0ee4fe94ecd34b6b206b9,117.68
a324e032a76af91eb1bfbc44a2abe81c,56.77
1d7e8be24bca64576da891970638bfe3,115.59
0f424f4c18f96da61b1ecc28281a319c,60.07
f754725dc3ae7829e913f88cbf2177c8,27.27

2025-02-10 15:57:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:18 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:18 - root - INFO - SQL:
-- 8. Calculate average payment value per customer.
SELECT c."customer_unique_id", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_unique_id"
LIMIT 100;
Results:
customer_unique_id,avg_payment_value
9b61cfcf9bc923fed1c1c8d38fab5a1c,105.28
e2381d9bb9b49c35fff077d4ae613816,355.28999999999996
d132b863416f85f2abb1a988ca05dd12,425.50666666666666
3af91c25f393301d27ccd39bce43f29d,103.49
b1cae7084960bab5c863422a645dce72,99.43
8fcf63613662e902d775fa5aa245c5e0,56.9
7d409442d2f22a2d058c1d1a19615324,227.12
28e4558f55bcf5b9f9ef85e9985f1810,51.14
127d41455fd0ee4fe94ecd34b6b206b9,117.68
e1399e9f6a55f443777d138d1c40bfdd,32.15
3ad8facb6eae216562fa5b74a17a6e9e,48.61
93b305948f8ecf70d2248fb41e0bce89,125.53
9db67268a3fee1d4b13faaeb90af07c0,51.84
53829feb906370f277393325399b8487,139.22
a6aa1df65dedcad75c34bbc175e5a068,98.96000000000001
1504b719eb728716ff7583dc7b86a0b0,64.03
2becf6f55d064453e6d7abe2af4ad36b,266.16
a2ac4c64994786e12db70e1782d2bfef,69.46
1acc368e2db62752896a9e414eff41c2,34.0
ae74c314b9c383e5d7bcd99d54ffbc71,119.63
b07a68d575f329bb71dcbd58e3fb5a16,187.51
297ec5afd18366f5ba27520cc4954151,483.6666666666667
ecac07aedaa3221150cc28e6fa2e99db,77.29
9cd31aa2388af9525780c2e1c3ad4ff7,117.71
89d4ec26627e7fe35be69c0512748842,121.45
cf4fa55f22af926c5ae29864635892c8,22.4
9202421110f6a19ddcf0b9b93602a0a1,138.725
a8096d09d1d508bfecccc9b80baa35df,61.77
972181580a78cb0d90f4286d5a92e5eb,42.19
3718945ae32eccdfb1209155e35b7e05,348.02
43fee0c28d0149eef54898d1d877a3e2,180.55
95c47859b6c051088b75e1ddcd15fe38,26.08
975362d8244917265887d77cb0156ded,165.96
6219e27197bb69d46b4df3fcc2325edf,33.13
643978b81660b3d83a38dbc89d386f8d,68.54
2bcbc94dd2ff7b15765fd1f97e2f34c8,139.87
464c15327646c422f5f1828b989417d2,214.755
a7f45c1961dbd98e7a14f3d38ea11c06,203.51
2090a6ff83e24734f0663e29f976909c,106.96
d7b23ec12acc9df1a7f032ae6b276976,37.58
f8fe53da72425fdda7f64542b1e85725,40.99
2a2a3fad75a86811325aa30582b160a2,17.78
e81955e2057830e1f23747959afb0723,121.88
7ebe3f683282a3df95d323a008f0c4d1,92.76
d7702658d570da430a6f4f9c4719d7ca,168.57
beba456e33133cc65b481399d051b2ba,31.72
472f97755c020f7fff14b98fc996c900,54.85
d27159211774d240eae28f4554b5a09b,19.18
ffddff7cfa827d6c430ed9e373be416c,105.42
628bdd93abd27fbdd50f4e2e91ec64b3,162.525
124bc956b56b1523d2a75b29a856085d,126.54
b7a5335c3a43bbbe4c7dd6505bf24499,128.95
5d8c508f148157b5095cab78700ae2a4,20.29
5c418344883a1f8617cb5577648adb4a,264.08
71167ca196ecf2c5aa680ce139f3bc0b,36.69
4847d361361a3440824346865cf03f83,65.71
fb920961e4d8e55fd9c357976a611765,16.6375
75359d2f105d3ac60bf3ad1b8a8c53ee,37.65
d6fd4848820f95837e8c37e1fc02787f,48.13
6cd315c36fcc1a203690c2bc092d2136,69.99
3856822a82996dad2607aaa95811551b,24.691666666666666
bdb132c2c3751f7f54a917955dbec063,73.34
4d66a989c3b48ccc474bf0b8c0fee918,63.23
a32fd99e791dbe323486039bce9ac35e,69.61
79403f8240aafdd83128106b5b48fd43,170.57
1801a172ccbf9172fa375bb6f0c9765e,121.49
47a0a92a1b4d507faa45c6d4910e9d2d,68.49
f42a3583d172ef020244c94136cac8db,90.05
a324e032a76af91eb1bfbc44a2abe81c,56.77
0f424f4c18f96da61b1ecc28281a319c,60.07
713110abe5de675d1513356694fe095a,285.79
5692cd1570356a05121efc3514c7a09e,27.63
970e5961383615662043afa2d9c68802,119.97
f46ebdbd5c48c0683980a759b8937912,87.15
0367371b350d144bb2c4efd70458249d,31.0
c4d9ec8c227594222eedd980cb28a6f4,123.605
b38c8c380d02399365a217729afc48a7,215.75
4601d7311d630cad38cf60e271a1a718,133.81
713a7708cfc3acf278ddeabdb7046fa0,89.88
e9b87dccd9c326a3325385087eb0150c,150.61
20a8698f41f83c2bcc9c20b6a2deaaee,110.03
45134d1b1e875ff5216c0c35c9a015b6,67.01
c21a8548a914d25a223b16cd2db5e0ec,112.73
027f4dabd2ab93d782fd604ade3f9f1b,72.05
e2ad8bcf2251723975d35fb6d5588e29,371.42
5b92df6945d212dcba4b6997d2fcaf24,52.57
e88b14e28d506b282a9a54db6e999ff0,145.58
dd69f24efd472cdcae01b58709c81fed,283.66
eb6d4ec7b36ba41ea2f6318bee73b0ca,43.08
3f75097158fca0329354ccb3d7435913,103.68
a4197eaeabe099da551896138a4dafc7,163.08
46e5acb6c2cdfc0f4860de6df22769e5,91.17
6c213d4c60e0584f43b1f66035dfecca,311.18
7d0e399eab77b5142609cf7821711c4e,88.08
4dfcad2550d5a550b707ea167f33ae8c,159.18
74b70f040f3977a893ed8646cce8a120,26.264999999999997
002da6dde369f6a8b4c999ed61eb5a87,52.38
9b657714f1df8f8f86cdcdab9925b349,38.06
61fe766e454d5e750b33250035b4311d,200.53500000000003
7599dea7f7520c8c37351721ad6870de,156.34

2025-02-10 15:57:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:20 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:20 - root - INFO - SQL:
-- 9. Combine delivered order counts and average payment values per customer.
SELECT c."customer_unique_id", COUNT(*) AS "num_delivered_orders", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Results:
Too long, hard cut:
customer_unique_id,num_delivered_orders,avg_payment_value
9a736b248f67d166d2fbb006bcb877c3,33,7.075454545454545
569aa12b73b5f7edeaa6f2a01603e381,26,2.4107692307692306
f9ae226291893fda10af7965268fb7f6,23,22.65521739130435
2524dcec233c3766f2c2b22f69fd65f4,22,1.856818181818182
6fbc7cdadbb522125f4b27ae9dee4060,19,10.82842105263158
24f12460aad399ba18f4ed2c2fbab65d,19,4.354210526315789
1d2435aa3b858d45c707c9fc25e18779,16,9.223749999999999
8d50f5eadf50201ccdcedfb9e2ac8455,15,58.618
c4b224d2c784bae11ae98b6ae9f2454c,15,49.384
25ba76039a1caff121dfcb0d66e54780,15,5.799333333333333
301d1ce5a76b7e1bc47e5115bf5eb6ba,14,37.824999999999996
1bc3d5e384c365c86cf79078f32eb495,14,7.183571428571429
94a19681bf6faa3c6ce3e2df1c2d97cb,14,14.40857142857143
74adf920dbd3d2e6e9f18acd88b2fd41,13,7.863076923076924
aae867e923db95a5af878ffec19ebd8c,13,14.378461538461538
7293e0b38ab0dab128e6bfb7239c37ad,13,8.251538461538463
c411c8b6dbaffd467263f87a23f2cf52,13,16.103846153846153
90807fdb59eec2152bc977feeb6e47e7,12,8.987499999999999
db1af3fd6b23ac3873ef02619d548f9c,12,27.435000000000002
024676cef113f6c81db6c5b8d29e5ee9,12,5.298333333333333
85963fd37bfd387aa6d915d8a1065486,12,73.28666666666666
39c7f8c4e4552af113351a650816296c,12,5.8308333333333335
43128f4462af59091a28f9141a3ee7ba,11,12.498181818181818
c96dac240f97b3f694b804e6406af73d,11,7.969090909090909
0fc594155e889688ea4477afcd26a134,11,19.126363636363635
2f8b722d3e62bb8a9860c7a29ad2b60f,11,20.718181818181815
a378caa847f8b44d00411d34449359d1,11,7.006363636363636
ff4bb0e2cade5df30146a1d570ae777d,11,28.89090909090909
b0f3a98136fb0e22d808f855bd430970,11,13.377272727272727
3806104dbbc3d14c17b091b3b8e38d59,10,15.424000000000001
1d37df739a7cdbd28609dc2954cc2c75,10,13.799000000000001
ed917c786a8a3e411eae87aeca27cb27,10,28.881999999999998
afc3f49cfd0567e08a8c452beb212c04,10,9.065999999999999
6bd5b501f37638859ccc1dc94cce730d,9,3.776666666666666
3e43e6105506432c953e165fb2acf44c,9,130.29555555555555
a4d4a76b47ccec27db5ea63da11debf5,9,34.803333333333335
182ebbe49711dd49de4fbbdf4a999c10,9,62.84222222222221
0fff4016f4008007ba2bb7d63ebae39d,9,13.520000000000001
495fe7ae31686381c8145b2936e761dc,9,33.68888888888889
e0ff4805ba6693550d1db7d374c477c9,9,8.575555555555557
3069f30fbf3f30057b1b4ff36c72208e,9,13.094444444444443
2eba6acde8e5a52e86f94b2c6224a986,9,21.008888888888887
311b7759da40d8d24724a882f0641308,8,77.76
142f18a4a7cd370e40b64f34baf14a6a,8,4.9399999999999995
738ffcf1017b584e9d2684b36e07469c,8,97.39750000000001
096e351116755fe4c3c1e48eaf301a41,8,27.18625
b25a21b56a2d74da49e04cadbc9e0dd8,8,15.9525
aad0fb3a1680f7a08d9b8de7da72e1cc,8,12.28875
ab719d1153364ba40df26f5e44c6192a,8,11.48125
c63a8c4fb13043a3fbe33bd17c69d17d,8,4.2425
1b6c7548a2a1f9037c1fd3ddfed95f33,8,119.87625
f0fd988c7c2a4cba167138a8adada6ca,8,21.942500000000003
08d8fd00898e7cc99d6e32c74d7d3ce5,8,4.375
a52327252e5d68739d85eadb7dd461e4,8,21.465
fa897856f19a95faf61b1fe22bfd0ace,7,8.712857142857143
e66c03faee607e9eb86380d0a86a327d,7,37.63857142857143
df2988ba3ed226b10521a0e4da849b61,7,12.411428571428571
bddc05c034061c84f92fe1710bfa5fe4,7,31.934285714285718
ec59dafb5820ce13fcc2fd6402be9b54,7,10.578571428571427
f71d1ce0ca77b13eb4a0909685c1a288,7,4.857142857142857
dd162f2be22e534992b3f874cc57eda0,7,19.995714285714286
90f323e9f0948ddd96c6f6a8ecc75830,7,35.02857142857143
7f6fd66526ed914998d483cff9b7bdd7,7,146.53
7019c99575147f8ea1bbf0a6e281bbf9,7,22.107142857142858
9620623f9ea546719cb3cd99bbb879a9,7,15.831428571428573
c5610cd24fef40cd91dbc4f45183eef0,7,9.847142857142858
e7251a1cbeb7ba8093c9b1593005ca90,7,37.79
7634efb2f26e897125a36155a6f92889,7,14.448571428571428
6f35424ab0a4f25807ac4e03b155832e,7,44.25714285714286
be74c431147c32ab2d7c7cef5e4a995f,7,205.20857142857145
6acc5385a15c441abe050fc7abda50bf,7,58.62428571428571
79f3d6597edbdbed1545a11e3d2fa280,7,9.557142857142859
e428b46d4645f1d7db520d95b2e446ee,7,30.37142857142857
31628ac4d85d1c46ebf7dad444adcbe3,7,23.40142857142857
6469f99c1f9dfae7733b25662e7f1782,7,108.40428571428572
993d47c24f159f09b8904941581211b3,7,18.67142857142857
8d3a01dad8496e7c850d5b3d580c8e90,7,9.304285714285713
96ce642e637cf74a0d3023db31e59d16,7,45.79
58b051c30d684ac12a2049a49c856203,7,6.67
cea1537ac1a5e083b8626a93f85475cc,7,5.96
ca77025e7201e3b30c44b472ff346268,7,160.38857142857142
56437a026e07b2b2271b8742aee81fb9,7,39.55714285714286
cfaec087ed620ecebc6e6f82fe276fe2,7,9.892857142857142
4532ac5f2f4f8c943a41d1ba00bd6c6d,7,19.225714285714282
262305e901587b79c5236175b06efb78,6,84.62666666666667
75a2adfe9f86d401f24b5fe2eb9a582c,6,59.03
2bca5fe01d46ab5cc2bc5aaade88d850,6,3.1666666666666665
ae977f6cf6981d883940f7e618620b3e,6,5.923333333333333
37d2d1ac62901f9a36cff32ca86c9337,6,30.293333333333333
09f55ef15bde8baeef87b3348b31c150,6,7.183333333333333
fd7069cf6891edbf32ba84c9c3f083d4,6,180.88333333333333
a1bb96820529725c3c79a77c69e7e792,6,13.281666666666666
94bd5dee83e9590368179f4ab026b4f4,6,19.201666666666668
6a8f804159a866574d2831e9651f589e,6,26.46666666666667
47c1a3033b8b77b3ab6e109eb4d5fdf3,6,157.3683333333333
7b08fc11e1aacd85ef2845c1

2025-02-10 15:57:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:22 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:22 - root - INFO - SQL:
-- 10. Retrieve customer details along with order counts and average payment values.
SELECT c."customer_unique_id", c."customer_city", c."customer_state", COUNT(*) AS "num_delivered_orders", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Results:
Too long, hard cut:
customer_unique_id,customer_city,customer_state,num_delivered_orders,avg_payment_value
9a736b248f67d166d2fbb006bcb877c3,sao paulo,SP,33,7.075454545454545
569aa12b73b5f7edeaa6f2a01603e381,sao paulo,SP,26,2.4107692307692306
f9ae226291893fda10af7965268fb7f6,guarulhos,SP,23,22.65521739130435
2524dcec233c3766f2c2b22f69fd65f4,tupa,SP,22,1.856818181818182
6fbc7cdadbb522125f4b27ae9dee4060,rio de janeiro,RJ,19,10.82842105263158
24f12460aad399ba18f4ed2c2fbab65d,campinas,SP,19,4.354210526315789
1d2435aa3b858d45c707c9fc25e18779,rio de janeiro,RJ,16,9.223749999999999
c4b224d2c784bae11ae98b6ae9f2454c,sao paulo,SP,15,49.384
25ba76039a1caff121dfcb0d66e54780,cabo frio,RJ,15,5.799333333333333
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,15,58.618
94a19681bf6faa3c6ce3e2df1c2d97cb,sao paulo,SP,14,14.40857142857143
1bc3d5e384c365c86cf79078f32eb495,embu-guacu,SP,14,7.183571428571429
301d1ce5a76b7e1bc47e5115bf5eb6ba,palmas,TO,14,37.824999999999996
7293e0b38ab0dab128e6bfb7239c37ad,sao paulo,SP,13,8.251538461538463
c411c8b6dbaffd467263f87a23f2cf52,sao paulo,SP,13,16.103846153846153
74adf920dbd3d2e6e9f18acd88b2fd41,ubatuba,SP,13,7.863076923076924
aae867e923db95a5af878ffec19ebd8c,sao paulo,SP,13,14.378461538461538
90807fdb59eec2152bc977feeb6e47e7,suzano,SP,12,8.987499999999999
85963fd37bfd387aa6d915d8a1065486,atibaia,SP,12,73.28666666666666
39c7f8c4e4552af113351a650816296c,sao jose dos pinhais,PR,12,5.8308333333333335
024676cef113f6c81db6c5b8d29e5ee9,sao paulo,SP,12,5.298333333333333
db1af3fd6b23ac3873ef02619d548f9c,itaqui,RS,12,27.435000000000002
c96dac240f97b3f694b804e6406af73d,cabo frio,RJ,11,7.969090909090909
43128f4462af59091a28f9141a3ee7ba,itaborai,RJ,11,12.498181818181818
2f8b722d3e62bb8a9860c7a29ad2b60f,sumare,SP,11,20.718181818181815
ff4bb0e2cade5df30146a1d570ae777d,bom jesus dos perdoes,SP,11,28.89090909090909
a378caa847f8b44d00411d34449359d1,sao jose dos campos,SP,11,7.006363636363636
b0f3a98136fb0e22d808f855bd430970,canoas,RS,11,13.377272727272727
0fc594155e889688ea4477afcd26a134,ilheus,BA,11,19.126363636363635
3806104dbbc3d14c17b091b3b8e38d59,sao paulo,SP,10,15.424000000000001
ed917c786a8a3e411eae87aeca27cb27,cruz alta,RS,10,28.881999999999998
1d37df739a7cdbd28609dc2954cc2c75,sao joao de meriti,RJ,10,13.799000000000001
afc3f49cfd0567e08a8c452beb212c04,taubate,SP,10,9.065999999999999
2eba6acde8e5a52e86f94b2c6224a986,franca,SP,9,21.008888888888887
495fe7ae31686381c8145b2936e761dc,rio de janeiro,RJ,9,33.68888888888889
6bd5b501f37638859ccc1dc94cce730d,carapicuiba,SP,9,3.776666666666666
3e43e6105506432c953e165fb2acf44c,praia grande,SP,9,130.29555555555555
0fff4016f4008007ba2bb7d63ebae39d,mogi das cruzes,SP,9,13.520000000000001
e0ff4805ba6693550d1db7d374c477c9,conselheiro lafaiete,MG,9,8.575555555555557
182ebbe49711dd49de4fbbdf4a999c10,sao paulo,SP,9,62.84222222222221
a4d4a76b47ccec27db5ea63da11debf5,salvador,BA,9,34.803333333333335
3069f30fbf3f30057b1b4ff36c72208e,rio de janeiro,RJ,9,13.094444444444443
311b7759da40d8d24724a882f0641308,goiania,GO,8,77.76
ab719d1153364ba40df26f5e44c6192a,brotas,SP,8,11.48125
1b6c7548a2a1f9037c1fd3ddfed95f33,ituiutaba,MG,8,119.87625
a52327252e5d68739d85eadb7dd461e4,franca,SP,8,21.465
aad0fb3a1680f7a08d9b8de7da72e1cc,rio de janeiro,RJ,8,12.28875
f0fd988c7c2a4cba167138a8adada6ca,cansancao,BA,8,21.942500000000003
c63a8c4fb13043a3fbe33bd17c69d17d,caucaia,CE,8,4.2425
142f18a4a7cd370e40b64f34baf14a6a,sao jose dos pinhais,PR,8,4.9399999999999995
08d8fd00898e7cc99d6e32c74d7d3ce5,campos dos goytacazes,RJ,8,4.375
096e351116755fe4c3c1e48eaf301a41,sao paulo,SP,8,27.18625
c5610cd24fef40cd91dbc4f45183eef0,sao paulo,SP,7,9.847142857142858
7634efb2f26e897125a36155a6f92889,sao paulo,SP,7,14.448571428571428
8d3a01dad8496e7c850d5b3d580c8e90,sao paulo,SP,7,9.304285714285713
9620623f9ea546719cb3cd99bbb879a9,paulinia,SP,7,15.831428571428573
56437a026e07b2b2271b8742aee81fb9,indaiatuba,SP,7,39.55714285714286
7019c99575147f8ea1bbf0a6e281bbf9,rio de janeiro,RJ,7,22.107142857142858
79f3d6597edbdbed1545a11e3d2fa280,contagem,MG,7,9.557142857142859
ec59dafb5820ce13fcc2fd6402be9b54,apucarana,PR,7,10.578571428571427
6f35424ab0a4f25807ac4e03b155832e,rio de janeiro,RJ,7,44.25714285714286
bddc05c034061c84f92fe1710bfa5fe4,sao joaquim da barra,SP,7,31.934285714285718
ca77025e7201e3b30c44b472ff346268,recife,PE,7,160.38857142857142
dd162f2be22e534992b3f874cc57eda0,guaruja,SP,7,19.995714285714286
cfaec087ed620ecebc6e6f82fe276fe2,goiania,GO,7,9.892857142857142
4532ac5f2f4f8c943a41d1ba00bd6c6d,goiania,GO,7,19.225714285714282
e66c03faee607e9eb86380d0a86a327d,rio de janeiro,RJ,7,37.63857142857143
96ce642e637cf74a0d3023db31e59d16,adamantina,SP,7,45.79
31628ac4d85d1c46ebf7dad444adcbe3,paraty,RJ,7,23.40142857142857
cea1537ac1a5e083b8626a93f85475cc,sao vicente,SP,7,5.96
6acc5385a15c441abe050fc7abda50bf,salvador,BA,7,58.62428571428571
e7251a1cbeb7ba8093c9b1593005ca90,belo horizonte,MG,7,37.79
993d47c24f159f09b8904941581211b3,curitiba,PR,7,18.67142857142857
6469f99c1f9dfae7733b25662e7f1782,santos,SP,7,108.40428571428572
df2988ba3ed226b10521a0e

2025-02-10 15:57:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:23 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:23 - root - INFO - SQL:
-- 11. List distinct mappings of customer IDs to customer unique IDs.
SELECT DISTINCT "customer_id", "customer_unique_id"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS
LIMIT 100;
Results:
Too long, hard cut:
customer_id,customer_unique_id
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db
26acee41e2f75689a5615892f06ea0bd,c3293e875ffb1116018edf76d24e52a2
7300450cedf7e4c35c243c4a03c1e8a6,95700615deef776ed32faa08f0be634e
4c7241af24b5344cb01fe687643de4fe,b157c176c3fe04914fde33f2dc8b878a
b514422efcf14bef34858a0829bef189,b436a108536c1dabbc1d3e808d782df9
0aae2862f8eac77f10a34f44860720ac,cd076285a12f40041b32f5ad8c98699f
12d1b4294fef21016c9614eb31e55e15,7556f182460418cf30957e6ce377c674
ee3a81b2771fec5f9e982cdb1b3a4804,a9a77b4e25980b7ca58cb71f878abb27
f7cb015ff73be957ee6a30e2577742c5,e235442a956c524e6c141141171f5801
5f8b4882b5a4ec7bf6d2107e6cd0cf29,694cb45ff29b603ac2acd51016770097
a1b9e0e44dbb043645cd14b00849a705,eab761ccdba80c5b9a7f01b16543da0f
39c9dc82d5f60eb1ee8bc4fe4aa29dc6,1f6d48610f32c723924f9af3e88f1c64
aa0fbd830c89acc3d79d311ff43d0920,eabd76f3506262b0db0dda1d48394a9b
bf60fa574e188373d3cb331d04aeb4f1,54fccbde5e005f2dbc6ad8d5473c9ac7
8d1b923f85a34afac5bd669d50417602,82e96a74eeb99b61395a1403630fe437
e255bea28fdeb105b85a23947349cca5,34c6f984b590bbfe3d4d6c76007c0b1c
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391
38d1cd89306128348ffdf4cc23f3a50a,d491a65a6ef3c04e145d37395996bad7
91ec76836092bba85d11761078ed7bb5,6edd17d0a29e2d4057e694afee5eaa3b
23e96758fd640560e9b1fbcda90abfc4,9e1f719fe5b17b9c51905fee6d6385c1
4cc465bb8ccb079ba561852ffa794668,7981196c7252350915beb9a7367d40b2
560829a36d563e8395cc073071a02bfd,fa7e6f153b7724fda5c1d7cc7b9ae4ec
b0964d76975dbc174b623b5a300973d5,24a5c2b24a4467c37e2f54c1b311de93
f7c5afab273b47ab517e096e0219b932,b6c083700ca8c135ba9f0f132930d4e8
7f2357cfd99c900565e6ffd6d2708d9d,466c3a741a952640c1984a48ebbffbf9
029ca19aa34f9311941ab931975cff1b,95363f351776a3f8a43145c79a046053
d6b41b191f1f643ff583898156e049cf,3a62a4803c77457a96c996a9db36a662
8891eb5ca0e28df961b2b5b8f3c0eb23,13ac6da47fef1b17b16f511e03b57918
154e666b681104319714a99a3ab71e44,be1e99a0c57d7c3c699cfc4db26c8edf
9e0628923d9fe029c079eb11ae72d241,dc643b60537f44f35b2f91610ea64153
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e
cc32707d2e2f7c92ab449f9b28154809,0d516ca029d6a28d5cfddd80b27a26dc
6c9a5923526346cbc0bd7bbd92269c01,cf6d4152d758efc43910e0141ae5b912
f6529ffebe6b3440d45

2025-02-10 15:57:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-10 15:57:24 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:25 - root - INFO - SQL:
-- 12. Display all distinct order statuses.
SELECT DISTINCT "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
LIMIT 100;
Results:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved

2025-02-10 15:57:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-10 15:57:26 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:26 - root - INFO - SQL:
-- 13. Count the number of orders per status.
SELECT "order_status", COUNT(*) AS "num_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
GROUP BY "order_status"
LIMIT 100;
Results:
order_status,num_orders
delivered,96478
invoiced,314
shipped,1107
processing,301
unavailable,609
canceled,625
created,5
approved,2

2025-02-10 15:57:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:27 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:28 - root - INFO - SQL:
-- 14. Summarize payment information per order.
SELECT p."order_id", COUNT(*) AS "num_payments", SUM(p."payment_value") AS "total_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
GROUP BY p."order_id"
LIMIT 100;
Results:
order_id,num_payments,total_payment_value
b81ef226f3fe1789b1e8b2acac839d17,1,99.33
a9810da82917af2d9aefd1278f1dcfa0,1,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,1,65.71
ba78997921bbcdc1373bb41e913ab953,1,107.78
298fcdf1f73eb413e4d26d01b25bc1cd,1,96.12
771ee386b001f06208a7419e4fc1bbd7,1,81.16
1f78449c87a54faf9e96e88ba1491fa9,1,341.09
0573b5e23cbd798006520e1d5b4c6714,1,51.95
d88e0d5fa41661ce03cf6cf336527646,1,188.73
2480f727e869fdeb397244a21b721b67,1,141.9
616105c9352a9668c38303ad44e056cd,1,75.78
769214176682788a92801d8907fa1b40,1,105.28
79da3f5fe31ad1e454f06f95dc032ad5,1,98.94
8ac09207f415d55acff302df7d6a895c,1,244.15
5a1f6d22f7dfb061ef29216b9af687a1,1,47.69
4214cda550ece8ee66441f459dc33a8c,1,170.57
4d680edbaa7d3d9bed69532957368a03,1,353.09
5d9c5817e278892b7498d90bfa28ade8,1,290.16
f45074ae38f2e01d9b854ec8d40362ff,1,13.78
81cedc4d2132eb6f512354166e51b187,1,30.28
f9d0ec2fa088ac583e1ccd15b6686073,1,89.68
23f10f509600c30cf2852f9dbdf28fc3,1,103.49
cf30fe76d1505192acee1c6dccb15545,1,47.72
0e0441786430b7cfcd0d91f822ea4c99,1,121.49
6ffb3f1686bceae3466facf7e02ce3fb,1,32.0
1807cc736321f14baa58ef39cf6e5989,1,91.66
10af96a0689260134307879127ac1952,1,113.2
85eef2d342b0de363c45c1bc324729c5,1,99.43
3e0c3cab458e8b3cc8d1d38ecb7e7775,1,105.53
795c16acb4e3c30dfa5b6827727ef488,1,37.58
e3e9e3295f4e1512167c232a0aaae8a5,1,50.8
42f5954cda381bd032934ee38c453711,1,402.42
c9f23db8a1cb725df9bdb3383bd72b38,1,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,1,34.78
b19ca559688b49e8cf7f88c1aa3f0009,1,73.34
4a02e985c7239d866a632f07ed20d9c0,1,48.62
46ee6eaca194413758f200a6974b7e4d,1,71.99
a490a5d59a9bf4ef3334bfd7cf1dbdfc,1,17.78
c1b770015e27aaf2b475026989d04fe0,1,137.73
d087b8e096ca051f548e29b324272834,1,72.05
5cfd514482e22bc992e7693f0e3e8df7,2,710.5799999999999
f86f6472fa9f395d8d9a6751ca118afb,1,64.03
d3e774a185c0b1b2286ffd6c70abe2e6,1,117.74
56c3277583e16009c925fdf116df420f,1,31.38
afef48d3c8a0b1b7c9b7f8f922fb5674,1,153.41
2e2c60b99754ae1e4d8b18846cfec9f2,1,542.66
343348b1e29e9fa9e7b6ab1027f9177d,1,43.77
97c111c4f22dfa1089a9c0b5338dcc79,1,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,1,187.51
e1b4ee0e390fbac1dec439d72b45a115,1,77.7
f8d323a2702fed37f0229965f7e9f8b3,1,51.14
3ba2d0012b1f34bc6ccbc31c4ba69f93,1,60.07
96de2b7f7f3c401fbee3eef068376da6,1,32.15
f090de1b2ed9f4e251662cb31e3c7127,1,27.63
2ccde1e4676c20b9444e2bcbed36334c,1,134.56
68d7420c86be23f313c81a554320f986,1,121.88
a5f860aaf6a3c35399495aefe92d363f,1,75.75
55779fa8fe072d9f8c92d672154558f2,1,233.66
845af9472cc76e66fbf445931b511755,1,123.41
67c8c2016ddabf0059783eb44e921f99,1,68.54
332c6742772f2df936696b6512b10edb,2,143.25
27a7ac440630f9de788e4d66e72c6424,1,186.39
e6670c9089973cc68e5b90b7d1f4fec4,1,88.49
aa7c35fd606f4275e267e859c6a84d0f,1,26.68
3d7239c394a212faae122962df514ac7,1,51.84
cf95215a722f3ebf29e6bbab87a29e61,1,102.66
12e5cfe0e4716b59afb0e0f4a3bd6570,1,157.45
61059985a6fc0ad64e95d9944caacdad,1,132.04
8cd68144cdb62dc0d60848cf8616d2a4,1,330.66
c39414c195d0f94c9d9c35e7c6ed4f1a,1,139.22
e647bf617de735448a4ba54f8910393c,1,65.09
aa964845f1de8125410aea8b73e9e1ec,1,27.35
ad4098a257676ea4d394fb3bbbf36ca3,1,68.49
4217849b1ff18a9270fe048eabc4dc45,1,67.88
55e2d723733c45033e71cb4d44690234,1,89.63
4c2e1a95586c815795a324d1599e7b5a,1,117.71
723e462ce1ee50e024887c0b403130f3,2,113.8
198298d54f269d8c5fe89e85a859af61,1,342.56
20f136d890c31a62486c809f91a5b098,1,117.68
cf61ad2218e5c14397e7c0ba7a6a50f9,1,35.14
99bc267f49d76932cd195bfb2a94dd03,1,163.08
aa600269bffea363cca75ad2d1908903,1,93.26
57e4fc8f20507381b3f7abbe4e2ccda3,1,215.56
ae1126b6891f58552443772c80b1f562,1,133.81
42fdf880ba16b47b59251dd489d4441a,1,128.45
adfbf6c2a620196f9a3ec747491c72b7,1,67.5
d0a945f85ba1074b60aac97ade7e240e,1,541.0
595f598849d89203c28d05d0fbf3f92e,1,26.58
b2bb080b6bc860118a246fd9b6fad6da,2,197.92000000000002
32b1d8f3789a57f1f752e20ac7404b4c,1,56.6
c0db7d31ace61fc360a3eaa34dd3457c,1,65.71
d574338f566ca28dd67820f48ec1f1d8,1,278.22
e8977f709bbb0367f51b589e6325f991,1,132.51
95442deb81a5d91c97c0df96b431634a,1,368.98
fc662bafa52d2ef16078f6f6141009d6,1,90.05
947e9c6bfd83a06953c420ef92d3da6e,1,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,1,78.3
460d57443ffdcaeba240360239747cf7,1,34.0
4d3bfdf4c7d6578ea445d588371ae10e,1,77.29
8e47a04b25d7a7075064e8e0bd2e0318,1,37.61

2025-02-10 15:57:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-10 15:57:29 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:29 - root - INFO - SQL:
-- 15. List all distinct payment types used.
SELECT DISTINCT "payment_type"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS
LIMIT 100;
Results:
payment_type
credit_card
boleto
voucher
debit_card
not_defined

2025-02-10 15:57:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:30 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:31 - root - INFO - SQL:
-- 16. Retrieve payment values and types along with customer unique IDs.
SELECT c."customer_unique_id", p."payment_value", p."payment_type"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
Results:
Too long, hard cut:
customer_unique_id,payment_value,payment_type
708ab75d2a007f0564aedd11139c7708,99.33,credit_card
a8b9d3a27068454b1c98cc67d4e31e6f,24.39,credit_card
6f70c0b2f7552832ba46eb57b1c5651e,65.71,credit_card
87695ed086ebd36f20404c82d20fca87,107.78,credit_card
4291db0da71914754618cd789aebcd56,128.45,credit_card
6e3c218d5f0434ddc4af3d6a60767bbf,96.12,credit_card
9a3526eee723accd014ec683afe5bf20,81.16,credit_card
9db67268a3fee1d4b13faaeb90af07c0,51.84,credit_card
2ecddf370925aff428e58b4f6021fe38,341.09,credit_card
511c345b0383af6ef25406c564e4d6b6,51.95,boleto
a51f8568095ce89a4ffce365dcb7d46d,188.73,credit_card
2faf4a1d502b10555a9f39353ea20148,141.9,credit_card
198ab463c8a3a754aa6ae61b38c4c8db,75.78,credit_card
ec103b892f579de25189dda196a4c5b3,102.66,credit_card
9b61cfcf9bc923fed1c1c8d38fab5a1c,105.28,credit_card
0ae522661311f598df20272643d39ce6,157.45,credit_card
3129dce5dc566246ea1354bff5bb6fea,132.04,credit_card
186638bdb0f600c9bf2bd60e4b14537c,98.94,credit_card
501598d5821539430a35385474cd44d9,244.15,credit_card
d386a136dc889cf681443061874caad8,136.71,credit_card
5986b5f70bf08b414d16a93ac5b1d76c,47.69,credit_card
79403f8240aafdd83128106b5b48fd43,170.57,credit_card
bd5fb6a2e66d7bfb061efd93b994f168,67.5,credit_card
14f64911f31f3722899596d1095a233e,353.09,credit_card
d0c437f172b9c527c0d196815b92c5ce,330.66,boleto
e2381d9bb9b49c35fff077d4ae613816,45.17,voucher
d132b863416f85f2abb1a988ca05dd12,541.0,credit_card
53829feb906370f277393325399b8487,139.22,credit_card
67a7e94ec59ef6d6ba83942c81d39b9a,290.16,credit_card
e9dc392ca45bbd1c3faf921ccd7ebbd1,283.34,boleto
9585898e80f9de26178eb04cd600b6f5,13.78,credit_card
d0ad8d078320fd639fe1ef1bcbe0e4af,30.28,credit_card
bf635aadfff238fd7e9b0d25e800d019,26.58,credit_card
35aebf263a4418be92141cc28421c0e0,89.68,credit_card
4872db1f116f7639293f1e960ac655d6,65.09,credit_card
a6aa1df65dedcad75c34bbc175e5a068,173.84,credit_card
3af91c25f393301d27ccd39bce43f29d,103.49,credit_card
1504b719eb728716ff7583dc7b86a0b0,64.03,credit_card
1b70f1238c390e4e7f01455440b09233,157.15,credit_card
34dd888b565982c76c7a9ee9dc41db4e,130.88,boleto
1fe64a1a47422f65cb1c179f0ab5ee36,47.72,credit_card
cdf4461e9701d83bfb42aa0e2319cd68,117.74,credit_card
52cf00bf99b259287bcd5b5a766adf2a,56.6,boleto
2becf6f55d064453e6d7abe2af4ad36b,266.16,credit_card
07314acd6253564af6a73a1cc8aca080,31.38,boleto
1801a172ccbf9172fa375bb6f0c9765e,121.49,credit_card
35fd26e0b8e2aad867717d6e3227fc9d,32.0,credit_card
a56a69b5c5e0e105c671353ee9caa01a,153.41,credit_card
271d3cdd872021b1b6669ad93e8b856b,65.71,credit_card
aec80ef34b077632b58f710c6d9476d3,278.22,credit_card
f822326a71e929f4d905a15676a5cb48,91.66,credit_card
5ceed695eeb968efc7959d859a902e00,132.51,credit_card
74dc6a3e622375fc6aae191555a5a95a,542.66,credit_card
78fc10170ee499077d81e1ed7b03fe6e,166.04,boleto
5b7f468205743c98e58a379722d3ae79,368.98,boleto
b807ae7957e78cf94c30251b4ddd0ed9,113.2,credit_card
b1cae7084960bab5c863422a645dce72,99.43,credit_card
8632c4862d819878dc37d5d2867d87ba,27.35,credit_card
10e49a12540465d3141f898aeee0a6b4,43.77,credit_card
47a0a92a1b4d507faa45c6d4910e9d2d,68.49,credit_card
1defe0913f512f19056b668156476990,105.53,credit_card
bcdd3f31625ec664aca676d1c101e753,387.8,credit_card
f384ac31b4473faf74a4672c9d0d9c69,84.14,boleto
741996aa586218efdc5169365507510d,210.82,credit_card
f42a3583d172ef020244c94136cac8db,90.05,boleto
ce4f5c53597a5a4e50f990e8e7676bd9,67.88,credit_card
d7b23ec12acc9df1a7f032ae6b276976,37.58,credit_card
f0e310a6839dce9de1638e0fe5ab282a,89.63,boleto
a2ac4c64994786e12db70e1782d2bfef,69.46,voucher
300077767cbc925601b3e23098cfc69a,78.3,credit_card
0b11937f7f94a269cc94a3378be84839,50.8,voucher
1acc368e2db62752896a9e414eff41c2,34.0,credit_card
3904ade0c6610a7c4fb9ec34259528f6,77.1,boleto
2a6f1c54c079bb319508a8278df9febc,566.4,credit_card
30d2beed036d709d9e6ded9c08496981,402.42,credit_card
764bf13c9f7df277b9c0950b88b4c3eb,57.53,voucher
ae74c314b9c383e5d7bcd99d54ffbc71,44.01,credit_card
b07a68d575f329bb71dcbd58e3fb5a16,187.51,credit_card
aec9d2bee598a5e8f88b3e9a8b29bc86,77.7,credit_card
297ec5afd18366f5ba27520cc4954151,48.68,credit_card
ecac07aedaa3221150cc28e6fa2e99db,77.29,credit_card
9cd31aa2388af9525780c2e1c3ad4ff7,117.71,credit_card
201e18d3b497478c79eaf7306aa38a21,169.34,credit_card
7602a5a3d9acc46b565e9c6551c8f494,37.61,credit_card
8fcf63613662e902d775fa5aa245c5e0,13.8,credit_card
7d409442d2f22a2d058c1d1a19615324,227.12,debit_card
adc3fee64ef2dad64eb6fbe5db907742,34.78,credit_card
16211bcf5b07a02aaa15f592d88cd42f,342.56,credit_card
8d384d9d49defe554f47b8186a206803,73.34,credit_card
4320120e01ea53da8c84d35c246cc3e6,117.85,credit_card
4f6e6a1e4d70f0210c1aa0861dfd5c78,48.62,credit_card
fa1573613e47e14b61de057fcae891b0,53.99,credit_card
28e4558f55bcf5b9f9ef85e9985f1810,51.14,credit_card
89d4ec26627e7fe35be69c0512748842,121.45,credit_card
d94137816541d7919b82c664a8f3937f,73.34,credit_card
127d41455fd0ee4fe94ecd34b6b206b9,117.68,credit_card
a324e032a76af91eb1bfbc44a2abe81c,56.77,credit_card
1d7e8be24bca64576da891970638bfe3,115.59,credit_card
0

2025-02-10 15:57:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:32 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:32 - root - INFO - SQL:
-- 17. Count the number of orders per city.
SELECT c."customer_city", COUNT(*) AS "num_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_city"
LIMIT 100;
Results:
customer_city,num_orders
sao paulo,15540
campinas,1444
jaragua do sul,89
timoteo,54
montes claros,211
rio de janeiro,6882
santo andre,797
cachoeiro de itapemirim,122
sao jose dos campos,691
sao luis,353
sao jose,169
taquarituba,16
barrinha,20
brasilia,2131
nova iguacu,442
aparecida de goiania,110
cascavel,153
salto,95
cabo frio,117
cafeara,3
foz do iguacu,87
rio grande,125
santa cruz do rio pardo,35
diadema,286
birigui,79
marialva,16
gameleiras,3
mangaratiba,13
espigao do oeste,6
ivoti,13
sao carlos,241
feliz,14
itajuba,94
paulista,42
timbo,20
nova bassano,4
moncoes,2
araucaria,54
niteroi,849
paraiba do sul,18
balneario camboriu,100
santiago,26
salvador,1245
pocos de caldas,122
uba,53
sao sebastiao do paraiso,36
arapiraca,29
nova friburgo,152
carangola,27
camboriu,28
osasco,746
ribeira,3
sao joao de meriti,134
pirassununga,69
sao caetano do sul,277
chapada do norte,2
teresopolis,120
porto feliz,22
palhoca,95
regeneracao,6
ipameri,13
araruama,77
comendador levy gasparian,7
pires do rio,12
curitiba,1521
sao roque,79
parati,13
fortaleza,654
uberlandia,374
pindamonhangaba,101
varre-sai,4
goiania,692
cacapava,74
santos,713
paulinia,130
ibatiba,9
taboao da serra,296
bom jesus,14
feira de santana,185
contagem,426
suzano,234
ipatinga,171
apucarana,52
sao sepe,6
alta floresta,12
jaboatao dos guararapes,135
votorantim,85
barra mansa,123
cuiaba,248
campo limpo paulista,48
itaquaquecetuba,172
valenca,63
altamira,25
vianopolis,3
loanda,13
charqueada,10
icem,9
joao pessoa,256
francisco morato,100
boa esperanca do sul,11

2025-02-10 15:57:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:33 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:34 - root - INFO - SQL:
-- 18. Identify top customers per city based on delivered orders.
SELECT c."customer_city", c."customer_unique_id", COUNT(*) AS "num_delivered_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_city", c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Results:
customer_city,customer_unique_id,num_delivered_orders
sao paulo,8d50f5eadf50201ccdcedfb9e2ac8455,15
praia grande,3e43e6105506432c953e165fb2acf44c,9
ituiutaba,1b6c7548a2a1f9037c1fd3ddfed95f33,7
recife,ca77025e7201e3b30c44b472ff346268,7
santos,6469f99c1f9dfae7733b25662e7f1782,7
rio de janeiro,63cfc61cee11cbe306bff5857d00bfe4,6
jandira,47c1a3033b8b77b3ab6e109eb4d5fdf3,6
curitiba,12f5d6e1cbf93dafd9dcc19095df0b3d,6
garanhuns,dc813062e0fc23409cd255f7f53c7074,6
vitoria,f0e310a6839dce9de1638e0fe5ab282a,6
sao caetano do sul,4e65032f1f574189fb793bac5a867bbc,5
sao luis,35ecdf6858edc6427223b64804cf028e,5
sao paulo,fe81bb32c243a86b2f86fbf053fe6140,5
sao paulo,74cb1ad7e6d5674325c1f99b5ea30d82,5
sao paulo,394ac4de8f3acb14253c177f0e15bc58,5
feira de santana,5e8f38a9a1c023f3db718edcf926a2db,5
juiz de fora,b4e4f24de1e8725b74e4a1f4975116ed,5
santo andre,de34b16117594161a6a89c50b289d35a,5
guaxupe,56c8638e7c058b98aae6d74d2dd6ea23,5
sao mateus,b08fab27d47a1eb6deda07bfd965ad43,4
manaus,a239b8e2fbce33780f1f1912e2ee5275,4
sao paulo,d3359a56d96666ac0c21bb01e7a61c95,4
porto alegre,7305430719d715992b00be82af4a6aa8,4
canoas,a0abd26659c9914690cbd3320d39fd96,4
petropolis,f64ec6d8dd29940264cd0bbb5ecade8a,4
porto alegre,c8460e4251689ba205045f3ea17884a1,4
ribeirao preto,b2bd387fdc3cf05931f0f897d607dc88,4
porto alegre,4facc2e6fbc2bffab2fea92d2b4aa7e4,4
curitiba,83e7958a94bd7f74a9414d8782f87628,4
rio de janeiro,a1874c5550d2f0bc14cc122164603713,4
curitiba,795c1622cf7a53d63d324e862349d01c,4
sao bernardo do campo,b39dde6dd619943190a8cc9aa6db38a4,4
porto alegre,25a560b9a6006157838aab1bdbd68624,4
francisco morato,b896655e2083a1d76b7b85df8fc86e40,4
correia pinto,c37cc6c1a59d81460a3059744f7ada1c,4
osasco,2ddc001b620bd90d0f4378cfde1db887,4
coromandel,a7657330b1c135f3acd420326e335b2c,4
rio de janeiro,9cc5a07f169a1606fd347a56683e6ea6,4
santo andre,a73c5464692d3bc09d64e3edefae9015,4
rio de janeiro,ec7f1811826ab04a27a92197bc40c888,4
sao paulo,6358b15ef7fa9b1210f1a5735cabd3d9,4
niteroi,397b44d5bb99eabf54ea9c2b41ebb905,4
montanha,12d8b5ed661190a3a08183644dfc504d,4
porto velho,acea6bd29b8c1e3c6a8b266a8fb4475e,4
joao pessoa,08e5b38d7948d37fbb2a59fc5e175ab1,4
ribeirao preto,310647380793836bfa5b7b6b3f518423,3
catalao,51d91326ffc0688da14a001de38c264b,3
dourados,06a52782a04f0086d16b9c22d0e29438,3
petropolis,0a609db8d244100909a15d65eadf8539,3
porto alegre,86df00dc5fd68f4dd5d5945ca19f3ed6,3
sao paulo,a3021c629bd1d99347a8e75a9ab035d8,3
timbo,f34cd7fd85a1f8baff886edf09567be3,3
canoas,2e43e031f10de28e557c35ef668f9396,3
sao bernardo do campo,b64ebaf3d11b7209fe566364cc359a51,3
sao paulo,cd11a0920c498edb1da9ecd2d31aa599,3
rio de janeiro,c76762dfb642ac154475239639f7f8f4,3
tijucas,90f323e9f0948ddd96c6f6a8ecc75830,3
joao pessoa,083ca1aa470c280236380973a48f77c6,3
belo horizonte,cef29e793e232d30250331804cdb7000,3
maringa,593cb774409e5239a1946d1c88e0813d,3
saquarema,bb58670190dba4e9b320f84cb98317a3,3
rio de janeiro,3db6e5afa8e8178a29afc729855315e2,3
barrinha,0e4cb268bd62da7db135af6349b4fc2a,3
barra do tarrachil,bd86b1862fe796149a4d2af57bd85451,3
aracruz,b59e4bb4efe81ba0f7d30cff6734f9a2,3
sao paulo,e3301490c373db9263c15a73172d0c6f,3
jundiai,98e3117841a2431959d17808f04bf23c,3
sao jose dos campos,3de0c9303f39b7ccfe69ca11aee19cc6,3
catanduva,d7624d219b6ffad980e91412174db310,3
teresina,0cc2ee1112a11a1094eff52fa2e87150,3
campinas,e0836a97eaae86ac4adc26fbb334a527,3
astolfo dutra,e78838df9c44e102b6ac84cc5eea7d5c,3
rio de janeiro,ae20947231d4d44dde1680a7ab14d90a,3
sao paulo,fc719c11b4dce594f47e1f9aa739a3a2,3
rio de janeiro,4e2d666f4bbc94a8ded712172a433d65,3
sao joaquim da barra,26a6e3e036636ef1d5636f98b66094cc,3
morrinhos,a029899dd8534557a81c369475ff80c8,3
sao paulo,7589544c08cc5de364cad85ee73f4b63,3
brasilia,3e5306add1209e5ba184092dd1587282,3
rio de janeiro,a40096fc0a3862e9e12bc55b5f8e6ab2,3
petropolis,6419a1be8feac26ec793667b71cbaeb4,3
petropolis,6a6a7141119ceaeca4dfbae7a580a515,3
sao paulo,d4a5e9f19897de65433c9d97bf4b9f8e,3
belo horizonte,0a61b571f594b6919601bcf3380da7f7,3
sao paulo,9d31457a03125fc870787a251760315a,3
rio de janeiro,e68e1b61896163cdd7f8e07b2ae814c9,3
rio de janeiro,25f3cf83109f636d52d288fa4e797111,3
valenca,1373e04979cfa0fb2092909abbd57f25,3
santo andre,d132b863416f85f2abb1a988ca05dd12,3
mogi das cruzes,7779fdf670bfe673e064b9aa5447674e,3
osasco,8961b4ca2c5aceb7a78ea72c6e0c840a,3
estiva gerbi,c0118e2c0a037c31aeca71d0b81f66a1,3
pelotas,c6df3869c263531ebd51f0454a353605,3
niteroi,fd8ccc89be43894d2553494c71a61fd8,3
aruja,732d307839b02bc2d3a4c26b515ea2b9,3
niteroi,1da09dd64e235e7c2f29a4faff33535c,3
alta floresta,76a0491dd70c125840fa259f00dfc351,3
barra bonita,ff922bdd6bafcdf99cb90d7f39cea5b3,3
tres rios,c4fe9fc8b5e1b4f9992db983d0429854,3
guarulhos,a3dc27d87234f862d7e61a0148c77fa9,3

2025-02-10 15:57:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 15:57:35 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:35 - root - INFO - SQL:
-- 19. Calculate average payment value per city.
SELECT c."customer_city", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_city"
LIMIT 100;
Results:
customer_city,avg_payment_value
juiz de fora,171.95204081632653
betim,164.3190476190476
serra,145.6466779661017
cacequi,200.3425
arapora,208.89499999999998
sorocaba,134.4558599695586
florianopolis,181.76136518771332
rio de janeiro,161.22205633411963
campinas,142.73823762376236
nova granada,106.12249999999999
araras,154.9719387755102
goiania,169.35843454790825
toledo,160.77794520547945
lagoa nova,51.300000000000004
sao lourenco,144.44361111111112
sao sebastiao do cai,198.5153846153846
sao goncalo,142.1907356321839
paulinia,133.04760563380282
pitangui,127.675
rio claro,146.38320987654322
ananindeua,230.8353260869565
amparo,185.08084507042253
campos dos goytacazes,155.86089147286822
nova iguacu,155.11971615720523
itajai,182.93851239669422
resende,134.11967479674797
santa maria,183.02367647058824
guaxupe,183.3421052631579
sao joao de meriti,145.95105263157896
ituiutaba,118.41293103448275
jequie,158.8905263157895
guaruja,139.82458677685952
porto velho,245.82882352941178
ilhabela,90.87782608695652
iaciara,274.5775
vitoria da conquista,209.69894736842107
mariluz,174.825
ibiuna,129.35258064516128
volta redonda,161.63020661157026
londrina,171.91179810725552
teresina,204.12612794612795
nova esperanca,220.0575
barra mansa,175.20315789473685
blumenau,144.94143564356435
novo hamburgo,178.9677519379845
queimados,125.09152542372883
varginha,181.56655555555557
praia grande,144.1124924012158
muriae,185.53073529411765
garca,123.35758620689654
sacramento,181.42615384615385
sao jose do goiabal,123.83500000000001
claraval,197.04
acarau,204.9925
taquara,235.94809523809522
campo bom,142.792972972973
turvo,66.86833333333334
lagoa da canoa,204.53
almirante tamandare,140.05083333333334
adustina,102.27
patos de minas,186.05336538461538
sao pedro,325.2775
itau de minas,65.71857142857142
bandeirantes do tocantins,216.1
itaborai,112.42946666666666
cascavel,176.24603658536586
pirassununga,138.993661971831
pindamonhangaba,142.6955769230769
aracariguama,93.70700000000001
cataguases,131.83800000000002
sao bernardo do campo,123.0182226762002
nova friburgo,197.13298136645963
mage,159.00466101694914
valentim gentil,139.62333333333333
sao gabriel,125.14166666666667
teixeiras,83.345
jundiai,156.89483979763912
sao luis,178.17635359116022
rio bonito,172.88931034482758
divinolandia de minas,62.564
santo antonio de jesus,166.00129032258064
carlos barbosa,155.41
ouro branco,122.87883720930232
santa rosa de lima,77.59666666666666
mendonca,78.07166666666667
rio largo,99.00571428571428
viamao,106.63532467532468
ibiaca,160.435
remanso,97.59799999999998
presidente getulio,131.54714285714286
varzea paulista,140.54461538461538
atibaia,136.61638418079096
cotia,140.44941634241246
itaperuna,164.92938775510203
chapeco,162.85073394495413
videira,204.50829787234042
caucaia,154.1895652173913
amambai,148.44833333333335
mostardas,143.36083333333332
passos,108.25916666666666

2025-02-10 15:57:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:57:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:57:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:57:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 27
2025-02-10 15:57:36 - snowflake.connector.connection - INFO - closed
2025-02-10 15:57:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:57:37 - root - INFO - SQL:
-- 20. Count the number of customers per state.
SELECT c."customer_state", COUNT(DISTINCT c."customer_unique_id") AS "num_customers"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
GROUP BY c."customer_state"
LIMIT 100;
Results:
customer_state,num_customers
SP,40302
SC,3534
MG,11259
PR,4882
RJ,12384
GO,1952
ES,1964
MS,694
BA,3277
DF,2075
PA,949
MA,726
AL,401
RN,474
PI,482
PB,519
TO,273
AC,77
SE,342
RR,45
AM,143
RO,240
AP,67
MT,876
CE,1313
PE,1609
RS,5277

2025-02-10 15:57:37 - root - INFO - itercount: 0
2025-02-10 15:57:37 - root - INFO - Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,0
table_name,OLIST_ORDERS
description,
DDL,"create or replace TABLE OLIST_ORDERS (
	""order_id"" VARCHAR(16777216),
	""customer_id"" VARCHAR(16777216),
	""order_status"" VARCHAR(16777216),
	""order_purchase_timestamp"" VARCHAR(16777216),
	""order_approved_at"" VARCHAR(16777216),
	""order_delivered_carrier_date"" VARCHAR(16777216),
	""order_delivered_customer_date"" VARCHAR(16777216),
	""order_estimated_delivery_date"" VARCHAR(16777216)
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,1
table_name,OLIST_ORDER_PAYMENTS
description,
DDL,"create or replace TABLE OLIST_ORDER_PAYMENTS (
	""order_id"" VARCHAR(16777216),
	""payment_sequential"" NUMBER(38,0),
	""payment_type"" VARCHAR(16777216),
	""payment_installments"" NUMBER(38,0),
	""payment_value"" FLOAT
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,2
table_name,OLIST_PRODUCTS_DATASET
description,
DDL,"create or replace TABLE OLIST_PRODUCTS_DATASET (
	""index"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,3
table_name,OLIST_ORDER_ITEMS
description,
DDL,"create or replace TABLE OLIST_ORDER_ITEMS (
	""order_id"" VARCHAR(16777216),
	""order_item_id"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""shipping_limit_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""freight_value"" FLOAT
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,4
table_name,OLIST_GEOLOCATION
description,
DDL,"create or replace TABLE OLIST_GEOLOCATION (
	""geolocation_zip_code_prefix"" NUMBER(38,0),
	""geolocation_lat"" FLOAT,
	""geolocation_lng"" FLOAT,
	""geolocation_city"" VARCHAR(16777216),
	""geolocation_state"" VARCHAR(16777216)
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,5
table_name,OLIST_SELLERS
description,
DDL,"create or replace TABLE OLIST_SELLERS (
	""seller_id"" VARCHAR(16777216),
	""seller_zip_code_prefix"" NUMBER(38,0),
	""seller_city"" VARCHAR(16777216),
	""seller_state"" VARCHAR(16777216)
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,6
table_name,OLIST_ORDER_REVIEWS
description,
DDL,"create or replace TABLE OLIST_ORDER_REVIEWS (
	""review_id"" VARCHAR(16777216),
	""order_id"" VARCHAR(16777216),
	""review_score"" NUMBER(38,0),
	""review_comment_title"" VARCHAR(16777216),
	""review_comment_message"" VARCHAR(16777216),
	""review_creation_date"" VARCHAR(16777216),
	""review_answer_timestamp"" VARCHAR(16777216)
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,7
table_name,OLIST_CUSTOMERS
description,
DDL,"create or replace TABLE OLIST_CUSTOMERS (
	""customer_id"" VARCHAR(16777216),
	""customer_unique_id"" VARCHAR(16777216),
	""customer_zip_code_prefix"" NUMBER(38,0),
	""customer_city"" VARCHAR(16777216),
	""customer_state"" VARCHAR(16777216)
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,8
table_name,OLIST_PRODUCTS
description,
DDL,"create or replace TABLE OLIST_PRODUCTS (
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
,9
table_name,PRODUCT_CATEGORY_NAME_TRANSLATION
description,
DDL,"create or replace TABLE PRODUCT_CATEGORY_NAME_TRANSLATION (
	""product_category_name"" VARCHAR(16777216),
	""product_category_name_english"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'BRAZILIAN_E_COMMERCE': {'BRAZILIAN_E_COMMERCE': ['OLIST_ORDERS', 'OLIST_ORDER_PAYMENTS', 'OLIST_PRODUCTS_DATASET', 'OLIST_ORDER_ITEMS', 'OLIST_GEOLOCATION', 'OLIST_SELLERS', 'OLIST_ORDER_REVIEWS', 'OLIST_CUSTOMERS', 'OLIST_PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION']}}
Begin Exploring Related Columns
To address the task, we'll first identify the relevant tables and columns, specifying their potential usage:

- **Tables and Columns:**

  **1. `OLIST_CUSTOMERS`**
     - `"customer_id"`: Used to join with `OLIST_ORDERS` to associate orders with customers.
     - `"customer_unique_id"`: Unique identifier for each customer; used to identify customers with the highest number of delivered orders.
     - `"customer_city"`: Provides the city information of the customer.
     - `"customer_state"`: Provides the state information of the customer.

  **2. `OLIST_ORDERS`**
     - `"order_id"`: Used to join with `OLIST_ORDER_PAYMENTS` to link orders with their payments.
     - `"customer_id"`: Used to join with `OLIST_CUSTOMERS`.
     - `"order_status"`: Used to filter orders with the status `'delivered'`.

  **3. `OLIST_ORDER_PAYMENTS`**
     - `"order_id"`: Used to join with `OLIST_ORDERS`.
     - `"payment_value"`: Used to calculate the average payment value per customer.

- **Conditions that may be used:**
  - Filter orders where `"order_status"` equals `'delivered'`.
  - Group data by `"customer_unique_id"` to aggregate orders and payments.
  - Use aggregate functions like `COUNT` and `AVG` to find the number of delivered orders and average payment values.

Below are SQL queries ranging from simple to more complex to explore the relevant data. Each query is different and aims to understand the values in related columns. All queries limit the results to 100 rows.

```sql
-- 1. Retrieve basic customer information.
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS
LIMIT 100;
```

```sql
-- 2. View orders with their statuses.
SELECT "order_id", "customer_id", "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
LIMIT 100;
```

```sql
-- 3. List delivered orders.
SELECT "order_id", "customer_id", "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
WHERE "order_status" = 'delivered'
LIMIT 100;
```

```sql
-- 4. Display payment values for orders.
SELECT "order_id", "payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS
LIMIT 100;
```

```sql
-- 5. Join orders with customers to associate orders with customer unique IDs.
SELECT o."order_id", o."customer_id", c."customer_unique_id", o."order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
```

```sql
-- 6. Count the number of delivered orders per customer.
SELECT c."customer_unique_id", COUNT(*) AS "num_delivered_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
```

```sql
-- 7. Retrieve payment values along with customer unique IDs.
SELECT c."customer_unique_id", p."payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
```

```sql
-- 8. Calculate average payment value per customer.
SELECT c."customer_unique_id", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_unique_id"
LIMIT 100;
```

```sql
-- 9. Combine delivered order counts and average payment values per customer.
SELECT c."customer_unique_id", COUNT(*) AS "num_delivered_orders", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
```

```sql
-- 10. Retrieve customer details along with order counts and average payment values.
SELECT c."customer_unique_id", c."customer_city", c."customer_state", COUNT(*) AS "num_delivered_orders", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
```

```sql
-- 11. List distinct mappings of customer IDs to customer unique IDs.
SELECT DISTINCT "customer_id", "customer_unique_id"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS
LIMIT 100;
```

```sql
-- 12. Display all distinct order statuses.
SELECT DISTINCT "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
LIMIT 100;
```

```sql
-- 13. Count the number of orders per status.
SELECT "order_status", COUNT(*) AS "num_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
GROUP BY "order_status"
LIMIT 100;
```

```sql
-- 14. Summarize payment information per order.
SELECT p."order_id", COUNT(*) AS "num_payments", SUM(p."payment_value") AS "total_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
GROUP BY p."order_id"
LIMIT 100;
```

```sql
-- 15. List all distinct payment types used.
SELECT DISTINCT "payment_type"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS
LIMIT 100;
```

```sql
-- 16. Retrieve payment values and types along with customer unique IDs.
SELECT c."customer_unique_id", p."payment_value", p."payment_type"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
```

```sql
-- 17. Count the number of orders per city.
SELECT c."customer_city", COUNT(*) AS "num_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_city"
LIMIT 100;
```

```sql
-- 18. Identify top customers per city based on delivered orders.
SELECT c."customer_city", c."customer_unique_id", COUNT(*) AS "num_delivered_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_city", c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
```

```sql
-- 19. Calculate average payment value per city.
SELECT c."customer_city", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_city"
LIMIT 100;
```

```sql
-- 20. Count the number of customers per state.
SELECT c."customer_state", COUNT(DISTINCT c."customer_unique_id") AS "num_customers"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
GROUP BY c."customer_state"
LIMIT 100;
```

These queries help in exploring the necessary data to address the original task, ensuring a comprehensive understanding of the relevant tables and columns. Each query is designed to be different, utilizes appropriate joins and aggregations, and adheres to the specified guidelines.Query:
-- 1. Retrieve basic customer information.
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS
LIMIT 100;
Answer:
Too long, hard cut:
customer_id,customer_unique_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade,GO
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel,PR
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia,DF
03f846ad034
Query:
-- 2. View orders with their statuses.
SELECT "order_id", "customer_id", "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,invoiced
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,shipped
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,delivered
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,delivered
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,delivered
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,delivered
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,delivered
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,delivered
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,delivered
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,delivered
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,delivered
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,delivered
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a4d489a44166894938,delivered
688052146432ef8253587b930b01a06d,81e08b08e5ed4472008030d70327c71f,delivered
f271576bed568e896f99eb710cd3a
Query:
-- 3. List delivered orders.
SELECT "order_id", "customer_id", "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
WHERE "order_status" = 'delivered'
LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,delivered
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,delivered
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,delivered
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,delivered
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,delivered
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,delivered
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,delivered
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,delivered
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,delivered
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,delivered
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a4d489a44166894938,delivered
688052146432ef8253587b930b01a06d,81e08b08e5ed4472008030d70327c71f,delivered
f271576bed568e896f99eb710cd3a6f8,5dda11942d4f77bee3a46d71e442aec4,delivered
686541986ecfb7d9296eb67719973bf0,74805bc388861fa350ed2fade8444e0b,delivered
68e48e68da1f50f7c5838ea75e
Query:
-- 4. Display payment values for orders.
SELECT "order_id", "payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS
LIMIT 100;
Answer:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27
Query:
-- 5. Join orders with customers to associate orders with customer unique IDs.
SELECT o."order_id", o."customer_id", c."customer_unique_id", o."order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,customer_unique_id,order_status
00e7ee1b050b8499577073aeb2a297a1,06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,delivered
29150127e6685892b6eab3eec79f59c7,18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,delivered
b2059ed67ce144a36e2aa97d2c9e9ad2,4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,delivered
951670f92359f4fe4a63112aa7306eba,b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,delivered
6b7d50bd145f6fc7f33cebabd7e49d0f,4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,delivered
5741ea1f91b5fbab2bd2dc653a5b5099,879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,delivered
36e694cf4cbc2a4803200c35e84abdc4,fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,delivered
1093c8304c7a003280dd34598194913d,5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,delivered
1ebeea841c590e86a14a0d7a48e7d062,5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,delivered
7433cbcc783205509d66a5260da5b574,4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,delivered
8428e578bb1cf839ae26a6b7615502b9,9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,delivered
f86c5ed7048ac10eb88ec21c00f71892,5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,delivered
83d8f70418eefd96f37b483dff430305,b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,delivered
852d2f4d37773bcbc21c8e09a05a4ea5,eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,delivered
6c949e670b5d33dc8fb8ad25b6da4860,1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,delivered
eac76692452422620996fe5e1a7f8bb0,206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,delivered
72bab69c50432c6f94d8b50a5f84b69a,a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,delivered
ec28553b12bef4b538e5d7454464a1c6,c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,delivered
17825f24877a9289214c301ae0c9424b,9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,delivered
ab797176e01c2fa3d13aa1fe3e63d9ee,49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,delivered
830d8b3e6875ef6165ffc33219ab4fea,154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,delivered
aaff8afa47c8426e414a6d908a97713c,690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,delivered
0198c71148c2e08c7c52b860f640fa4e,2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,delivered
eac4ffbe456464bdc3ce5f001b6439c5,237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,delivered
6cdc131d3c28253cd03cd0fbc3d5f938,cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,delivered
daf946e879dab6e7e6b3f968297c3fe3,f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,delivered
d10eafa208521dc30796e6a26099b6a6,167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,delivered
a8f5a2b22f55e0af45b300929d1fdc7d,6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,delivered
3a6d41a4fe7a8e841b7c8e4b77d4e301,e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,delivered
0330631bdb2ec8c341f487ed9c22fc8b,e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,delivered
2904d3ae0064e840ffb4798ba4a12ae3,261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,delivered
f3b96845efd71daecf6b331fb3a9f537,6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,delivered
19c0c76962278b152cc44fc63ffd5e48,2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,delivered
77b062be7c5bd21712905feb8e1cfeed,b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,delivered
a9119eb77d6200811953803a7b6539e1,469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,delivered
72bd19ef4fa285334b95bda01a3718c7,df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,delivered
4ca8a781d1f4b13e966bf35cdc333f56,41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,delivered
d4668cd8ef48b78df597195703c95da2,54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,delivered
997fd4b37386d10b57d4ac8cdec011a6,4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,delivered
47cb08d5bac6105ae32587814fca96ca,b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,delivered
42cebac003b40e6aa0b3e37b99d83c2f,4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,delivered
1bae3477022e0394ab9af1d25a242fd0,c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,delivered
2dd604f5ec1bd2f58c14e9908c7df826,a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,delivered
a74869096437cef33d04006e8480e0db,0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,delivered
04a92860751dfe7ae41f71e1228ffd18,c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,delivered
14282bc70be9bdda515182fb1ce62af4,19cecb194
Query:
-- 6. Count the number of delivered orders per customer.
SELECT c."customer_unique_id", COUNT(*) AS "num_delivered_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Answer:
customer_unique_id,num_delivered_orders
8d50f5eadf50201ccdcedfb9e2ac8455,15
3e43e6105506432c953e165fb2acf44c,9
1b6c7548a2a1f9037c1fd3ddfed95f33,7
ca77025e7201e3b30c44b472ff346268,7
6469f99c1f9dfae7733b25662e7f1782,7
47c1a3033b8b77b3ab6e109eb4d5fdf3,6
12f5d6e1cbf93dafd9dcc19095df0b3d,6
f0e310a6839dce9de1638e0fe5ab282a,6
dc813062e0fc23409cd255f7f53c7074,6
63cfc61cee11cbe306bff5857d00bfe4,6
4e65032f1f574189fb793bac5a867bbc,5
de34b16117594161a6a89c50b289d35a,5
fe81bb32c243a86b2f86fbf053fe6140,5
35ecdf6858edc6427223b64804cf028e,5
b4e4f24de1e8725b74e4a1f4975116ed,5
394ac4de8f3acb14253c177f0e15bc58,5
74cb1ad7e6d5674325c1f99b5ea30d82,5
5e8f38a9a1c023f3db718edcf926a2db,5
56c8638e7c058b98aae6d74d2dd6ea23,5
f34cd7fd85a1f8baff886edf09567be3,4
a73c5464692d3bc09d64e3edefae9015,4
7305430719d715992b00be82af4a6aa8,4
12d8b5ed661190a3a08183644dfc504d,4
b39dde6dd619943190a8cc9aa6db38a4,4
c8460e4251689ba205045f3ea17884a1,4
d3359a56d96666ac0c21bb01e7a61c95,4
83e7958a94bd7f74a9414d8782f87628,4
ec7f1811826ab04a27a92197bc40c888,4
b896655e2083a1d76b7b85df8fc86e40,4
acea6bd29b8c1e3c6a8b266a8fb4475e,4
738ffcf1017b584e9d2684b36e07469c,4
a1874c5550d2f0bc14cc122164603713,4
a239b8e2fbce33780f1f1912e2ee5275,4
f64ec6d8dd29940264cd0bbb5ecade8a,4
9cc5a07f169a1606fd347a56683e6ea6,4
b2bd387fdc3cf05931f0f897d607dc88,4
08e5b38d7948d37fbb2a59fc5e175ab1,4
a0abd26659c9914690cbd3320d39fd96,4
4facc2e6fbc2bffab2fea92d2b4aa7e4,4
795c1622cf7a53d63d324e862349d01c,4
a7657330b1c135f3acd420326e335b2c,4
b08fab27d47a1eb6deda07bfd965ad43,4
2ddc001b620bd90d0f4378cfde1db887,4
397b44d5bb99eabf54ea9c2b41ebb905,4
6358b15ef7fa9b1210f1a5735cabd3d9,4
c37cc6c1a59d81460a3059744f7ada1c,4
25a560b9a6006157838aab1bdbd68624,4
dc48b0a1b0e6abb6586f322c189f6b93,3
a72a2d4e19868dba726c0e6f49198c7e,3
e68e1b61896163cdd7f8e07b2ae814c9,3
98e3117841a2431959d17808f04bf23c,3
8c21dd8c37144807c601f99f2a209dfb,3
31d332d20895c5c0baefe55207a0fead,3
e2492e4188991b6276a4a62a287a5451,3
06a52782a04f0086d16b9c22d0e29438,3
1fbd81e4d0a0cf9125ca038b43533b7f,3
c9b3b24308b1a4587ffa3e60fafc2b1f,3
4e1cce07cd5937c69dacac3c8b13d965,3
d132b863416f85f2abb1a988ca05dd12,3
8dafb82f687e3b0dc9e97b4198b92128,3
732d307839b02bc2d3a4c26b515ea2b9,3
51d91326ffc0688da14a001de38c264b,3
c76762dfb642ac154475239639f7f8f4,3
18a65d67bb184e736656cc017f09f7b8,3
acaf5177d6de60fda7ce77c48abb5230,3
db07fd2ad9869f8356b1fbeefdac31e8,3
e30b83af13d6ff0b0f427b2a67c43b39,3
2e43e031f10de28e557c35ef668f9396,3
6f64406ed5cfa4a2d9bd35e91bfd6587,3
e226254ce0c6d5b7a7ef7218c9b5b518,3
9947c0ed8bf41cd508a78da36abc1d41,3
d7624d219b6ffad980e91412174db310,3
d3882d7abd0c66064d740d7ed04dd1ef,3
ba87a137c5191264841e0be40e53f4ed,3
fe59d5878cd80080edbd29b5a0a4e1cf,3
310647380793836bfa5b7b6b3f518423,3
64df076fb557552498049bb07ed1cd5f,3
0a609db8d244100909a15d65eadf8539,3
9aae8213ff9bc04cc3ce48b85f43a173,3
fc719c11b4dce594f47e1f9aa739a3a2,3
3de0c9303f39b7ccfe69ca11aee19cc6,3
23339103d82a054f9729b0554ce22e8c,3
7588c20c457369de8caad958afc1cc06,3
7589544c08cc5de364cad85ee73f4b63,3
02e9109b7e0a985108b43e573b6afb23,3
d75acd4c5b7b4dfd32b9d9172b195419,3
d26c616e241736e0c1c1ab14150239e7,3
46958f708ade6b6a88b2e5aca1e66de5,3
30a81e307f19e822e7199139fe52b1b0,3
7d3d94b4740895a17760e976797f9f0e,3
1373e04979cfa0fb2092909abbd57f25,3
90f323e9f0948ddd96c6f6a8ecc75830,3
ff922bdd6bafcdf99cb90d7f39cea5b3,3
cef29e793e232d30250331804cdb7000,3
549a24530925587e2faddb35f667e458,3
bd86b1862fe796149a4d2af57bd85451,3
3e5306add1209e5ba184092dd1587282,3
76a0491dd70c125840fa259f00dfc351,3
d4a5e9f19897de65433c9d97bf4b9f8e,3
b2e9a05d23ea17713b5d7799f2004f8e,3
Query:
-- 7. Retrieve payment values along with customer unique IDs.
SELECT c."customer_unique_id", p."payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
Answer:
customer_unique_id,payment_value
708ab75d2a007f0564aedd11139c7708,99.33
a8b9d3a27068454b1c98cc67d4e31e6f,24.39
6f70c0b2f7552832ba46eb57b1c5651e,65.71
87695ed086ebd36f20404c82d20fca87,107.78
4291db0da71914754618cd789aebcd56,128.45
6e3c218d5f0434ddc4af3d6a60767bbf,96.12
9a3526eee723accd014ec683afe5bf20,81.16
9db67268a3fee1d4b13faaeb90af07c0,51.84
2ecddf370925aff428e58b4f6021fe38,341.09
511c345b0383af6ef25406c564e4d6b6,51.95
a51f8568095ce89a4ffce365dcb7d46d,188.73
2faf4a1d502b10555a9f39353ea20148,141.9
198ab463c8a3a754aa6ae61b38c4c8db,75.78
ec103b892f579de25189dda196a4c5b3,102.66
9b61cfcf9bc923fed1c1c8d38fab5a1c,105.28
0ae522661311f598df20272643d39ce6,157.45
3129dce5dc566246ea1354bff5bb6fea,132.04
186638bdb0f600c9bf2bd60e4b14537c,98.94
501598d5821539430a35385474cd44d9,244.15
d386a136dc889cf681443061874caad8,136.71
5986b5f70bf08b414d16a93ac5b1d76c,47.69
79403f8240aafdd83128106b5b48fd43,170.57
bd5fb6a2e66d7bfb061efd93b994f168,67.5
14f64911f31f3722899596d1095a233e,353.09
d0c437f172b9c527c0d196815b92c5ce,330.66
e2381d9bb9b49c35fff077d4ae613816,45.17
d132b863416f85f2abb1a988ca05dd12,541.0
53829feb906370f277393325399b8487,139.22
67a7e94ec59ef6d6ba83942c81d39b9a,290.16
e9dc392ca45bbd1c3faf921ccd7ebbd1,283.34
9585898e80f9de26178eb04cd600b6f5,13.78
d0ad8d078320fd639fe1ef1bcbe0e4af,30.28
bf635aadfff238fd7e9b0d25e800d019,26.58
35aebf263a4418be92141cc28421c0e0,89.68
4872db1f116f7639293f1e960ac655d6,65.09
a6aa1df65dedcad75c34bbc175e5a068,173.84
3af91c25f393301d27ccd39bce43f29d,103.49
1504b719eb728716ff7583dc7b86a0b0,64.03
1b70f1238c390e4e7f01455440b09233,157.15
34dd888b565982c76c7a9ee9dc41db4e,130.88
1fe64a1a47422f65cb1c179f0ab5ee36,47.72
cdf4461e9701d83bfb42aa0e2319cd68,117.74
52cf00bf99b259287bcd5b5a766adf2a,56.6
2becf6f55d064453e6d7abe2af4ad36b,266.16
07314acd6253564af6a73a1cc8aca080,31.38
1801a172ccbf9172fa375bb6f0c9765e,121.49
35fd26e0b8e2aad867717d6e3227fc9d,32.0
a56a69b5c5e0e105c671353ee9caa01a,153.41
271d3cdd872021b1b6669ad93e8b856b,65.71
aec80ef34b077632b58f710c6d9476d3,278.22
f822326a71e929f4d905a15676a5cb48,91.66
5ceed695eeb968efc7959d859a902e00,132.51
74dc6a3e622375fc6aae191555a5a95a,542.66
78fc10170ee499077d81e1ed7b03fe6e,166.04
5b7f468205743c98e58a379722d3ae79,368.98
b807ae7957e78cf94c30251b4ddd0ed9,113.2
b1cae7084960bab5c863422a645dce72,99.43
8632c4862d819878dc37d5d2867d87ba,27.35
10e49a12540465d3141f898aeee0a6b4,43.77
47a0a92a1b4d507faa45c6d4910e9d2d,68.49
1defe0913f512f19056b668156476990,105.53
bcdd3f31625ec664aca676d1c101e753,387.8
f384ac31b4473faf74a4672c9d0d9c69,84.14
741996aa586218efdc5169365507510d,210.82
f42a3583d172ef020244c94136cac8db,90.05
ce4f5c53597a5a4e50f990e8e7676bd9,67.88
d7b23ec12acc9df1a7f032ae6b276976,37.58
f0e310a6839dce9de1638e0fe5ab282a,89.63
a2ac4c64994786e12db70e1782d2bfef,69.46
300077767cbc925601b3e23098cfc69a,78.3
0b11937f7f94a269cc94a3378be84839,50.8
1acc368e2db62752896a9e414eff41c2,34.0
3904ade0c6610a7c4fb9ec34259528f6,77.1
2a6f1c54c079bb319508a8278df9febc,566.4
30d2beed036d709d9e6ded9c08496981,402.42
764bf13c9f7df277b9c0950b88b4c3eb,57.53
ae74c314b9c383e5d7bcd99d54ffbc71,44.01
b07a68d575f329bb71dcbd58e3fb5a16,187.51
aec9d2bee598a5e8f88b3e9a8b29bc86,77.7
297ec5afd18366f5ba27520cc4954151,48.68
ecac07aedaa3221150cc28e6fa2e99db,77.29
9cd31aa2388af9525780c2e1c3ad4ff7,117.71
201e18d3b497478c79eaf7306aa38a21,169.34
7602a5a3d9acc46b565e9c6551c8f494,37.61
8fcf63613662e902d775fa5aa245c5e0,13.8
7d409442d2f22a2d058c1d1a19615324,227.12
adc3fee64ef2dad64eb6fbe5db907742,34.78
16211bcf5b07a02aaa15f592d88cd42f,342.56
8d384d9d49defe554f47b8186a206803,73.34
4320120e01ea53da8c84d35c246cc3e6,117.85
4f6e6a1e4d70f0210c1aa0861dfd5c78,48.62
fa1573613e47e14b61de057fcae891b0,53.99
28e4558f55bcf5b9f9ef85e9985f1810,51.14
89d4ec26627e7fe35be69c0512748842,121.45
d94137816541d7919b82c664a8f3937f,73.34
127d41455fd0ee4fe94ecd34b6b206b9,117.68
a324e032a76af91eb1bfbc44a2abe81c,56.77
1d7e8be24bca64576da891970638bfe3,115.59
0f424f4c18f96da61b1ecc28281a319c,60.07
f754725dc3ae7829e913f88cbf2177c8,27.27
Query:
-- 8. Calculate average payment value per customer.
SELECT c."customer_unique_id", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_unique_id"
LIMIT 100;
Answer:
customer_unique_id,avg_payment_value
9b61cfcf9bc923fed1c1c8d38fab5a1c,105.28
e2381d9bb9b49c35fff077d4ae613816,355.28999999999996
d132b863416f85f2abb1a988ca05dd12,425.50666666666666
3af91c25f393301d27ccd39bce43f29d,103.49
b1cae7084960bab5c863422a645dce72,99.43
8fcf63613662e902d775fa5aa245c5e0,56.9
7d409442d2f22a2d058c1d1a19615324,227.12
28e4558f55bcf5b9f9ef85e9985f1810,51.14
127d41455fd0ee4fe94ecd34b6b206b9,117.68
e1399e9f6a55f443777d138d1c40bfdd,32.15
3ad8facb6eae216562fa5b74a17a6e9e,48.61
93b305948f8ecf70d2248fb41e0bce89,125.53
9db67268a3fee1d4b13faaeb90af07c0,51.84
53829feb906370f277393325399b8487,139.22
a6aa1df65dedcad75c34bbc175e5a068,98.96000000000001
1504b719eb728716ff7583dc7b86a0b0,64.03
2becf6f55d064453e6d7abe2af4ad36b,266.16
a2ac4c64994786e12db70e1782d2bfef,69.46
1acc368e2db62752896a9e414eff41c2,34.0
ae74c314b9c383e5d7bcd99d54ffbc71,119.63
b07a68d575f329bb71dcbd58e3fb5a16,187.51
297ec5afd18366f5ba27520cc4954151,483.6666666666667
ecac07aedaa3221150cc28e6fa2e99db,77.29
9cd31aa2388af9525780c2e1c3ad4ff7,117.71
89d4ec26627e7fe35be69c0512748842,121.45
cf4fa55f22af926c5ae29864635892c8,22.4
9202421110f6a19ddcf0b9b93602a0a1,138.725
a8096d09d1d508bfecccc9b80baa35df,61.77
972181580a78cb0d90f4286d5a92e5eb,42.19
3718945ae32eccdfb1209155e35b7e05,348.02
43fee0c28d0149eef54898d1d877a3e2,180.55
95c47859b6c051088b75e1ddcd15fe38,26.08
975362d8244917265887d77cb0156ded,165.96
6219e27197bb69d46b4df3fcc2325edf,33.13
643978b81660b3d83a38dbc89d386f8d,68.54
2bcbc94dd2ff7b15765fd1f97e2f34c8,139.87
464c15327646c422f5f1828b989417d2,214.755
a7f45c1961dbd98e7a14f3d38ea11c06,203.51
2090a6ff83e24734f0663e29f976909c,106.96
d7b23ec12acc9df1a7f032ae6b276976,37.58
f8fe53da72425fdda7f64542b1e85725,40.99
2a2a3fad75a86811325aa30582b160a2,17.78
e81955e2057830e1f23747959afb0723,121.88
7ebe3f683282a3df95d323a008f0c4d1,92.76
d7702658d570da430a6f4f9c4719d7ca,168.57
beba456e33133cc65b481399d051b2ba,31.72
472f97755c020f7fff14b98fc996c900,54.85
d27159211774d240eae28f4554b5a09b,19.18
ffddff7cfa827d6c430ed9e373be416c,105.42
628bdd93abd27fbdd50f4e2e91ec64b3,162.525
124bc956b56b1523d2a75b29a856085d,126.54
b7a5335c3a43bbbe4c7dd6505bf24499,128.95
5d8c508f148157b5095cab78700ae2a4,20.29
5c418344883a1f8617cb5577648adb4a,264.08
71167ca196ecf2c5aa680ce139f3bc0b,36.69
4847d361361a3440824346865cf03f83,65.71
fb920961e4d8e55fd9c357976a611765,16.6375
75359d2f105d3ac60bf3ad1b8a8c53ee,37.65
d6fd4848820f95837e8c37e1fc02787f,48.13
6cd315c36fcc1a203690c2bc092d2136,69.99
3856822a82996dad2607aaa95811551b,24.691666666666666
bdb132c2c3751f7f54a917955dbec063,73.34
4d66a989c3b48ccc474bf0b8c0fee918,63.23
a32fd99e791dbe323486039bce9ac35e,69.61
79403f8240aafdd83128106b5b48fd43,170.57
1801a172ccbf9172fa375bb6f0c9765e,121.49
47a0a92a1b4d507faa45c6d4910e9d2d,68.49
f42a3583d172ef020244c94136cac8db,90.05
a324e032a76af91eb1bfbc44a2abe81c,56.77
0f424f4c18f96da61b1ecc28281a319c,60.07
713110abe5de675d1513356694fe095a,285.79
5692cd1570356a05121efc3514c7a09e,27.63
970e5961383615662043afa2d9c68802,119.97
f46ebdbd5c48c0683980a759b8937912,87.15
0367371b350d144bb2c4efd70458249d,31.0
c4d9ec8c227594222eedd980cb28a6f4,123.605
b38c8c380d02399365a217729afc48a7,215.75
4601d7311d630cad38cf60e271a1a718,133.81
713a7708cfc3acf278ddeabdb7046fa0,89.88
e9b87dccd9c326a3325385087eb0150c,150.61
20a8698f41f83c2bcc9c20b6a2deaaee,110.03
45134d1b1e875ff5216c0c35c9a015b6,67.01
c21a8548a914d25a223b16cd2db5e0ec,112.73
027f4dabd2ab93d782fd604ade3f9f1b,72.05
e2ad8bcf2251723975d35fb6d5588e29,371.42
5b92df6945d212dcba4b6997d2fcaf24,52.57
e88b14e28d506b282a9a54db6e999ff0,145.58
dd69f24efd472cdcae01b58709c81fed,283.66
eb6d4ec7b36ba41ea2f6318bee73b0ca,43.08
3f75097158fca0329354ccb3d7435913,103.68
a4197eaeabe099da551896138a4dafc7,163.08
46e5acb6c2cdfc0f4860de6df22769e5,91.17
6c213d4c60e0584f43b1f66035dfecca,311.18
7d0e399eab77b5142609cf7821711c4e,88.08
4dfcad2550d5a550b707ea167f33ae8c,159.18
74b70f040f3977a893ed8646cce8a120,26.264999999999997
002da6dde369f6a8b4c999ed61eb5a87,52.38
9b657714f1df8f8f86cdcdab9925b349,38.06
61fe766e454d5e750b33250035b4311d,200.53500000000003
7599dea7f7520c8c37351721ad6870de,156.34
Query:
-- 9. Combine delivered order counts and average payment values per customer.
SELECT c."customer_unique_id", COUNT(*) AS "num_delivered_orders", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Answer:
Too long, hard cut:
customer_unique_id,num_delivered_orders,avg_payment_value
9a736b248f67d166d2fbb006bcb877c3,33,7.075454545454545
569aa12b73b5f7edeaa6f2a01603e381,26,2.4107692307692306
f9ae226291893fda10af7965268fb7f6,23,22.65521739130435
2524dcec233c3766f2c2b22f69fd65f4,22,1.856818181818182
6fbc7cdadbb522125f4b27ae9dee4060,19,10.82842105263158
24f12460aad399ba18f4ed2c2fbab65d,19,4.354210526315789
1d2435aa3b858d45c707c9fc25e18779,16,9.223749999999999
8d50f5eadf50201ccdcedfb9e2ac8455,15,58.618
c4b224d2c784bae11ae98b6ae9f2454c,15,49.384
25ba76039a1caff121dfcb0d66e54780,15,5.799333333333333
301d1ce5a76b7e1bc47e5115bf5eb6ba,14,37.824999999999996
1bc3d5e384c365c86cf79078f32eb495,14,7.183571428571429
94a19681bf6faa3c6ce3e2df1c2d97cb,14,14.40857142857143
74adf920dbd3d2e6e9f18acd88b2fd41,13,7.863076923076924
aae867e923db95a5af878ffec19ebd8c,13,14.378461538461538
7293e0b38ab0dab128e6bfb7239c37ad,13,8.251538461538463
c411c8b6dbaffd467263f87a23f2cf52,13,16.103846153846153
90807fdb59eec2152bc977feeb6e47e7,12,8.987499999999999
db1af3fd6b23ac3873ef02619d548f9c,12,27.435000000000002
024676cef113f6c81db6c5b8d29e5ee9,12,5.298333333333333
85963fd37bfd387aa6d915d8a1065486,12,73.28666666666666
39c7f8c4e4552af113351a650816296c,12,5.8308333333333335
43128f4462af59091a28f9141a3ee7ba,11,12.498181818181818
c96dac240f97b3f694b804e6406af73d,11,7.969090909090909
0fc594155e889688ea4477afcd26a134,11,19.126363636363635
2f8b722d3e62bb8a9860c7a29ad2b60f,11,20.718181818181815
a378caa847f8b44d00411d34449359d1,11,7.006363636363636
ff4bb0e2cade5df30146a1d570ae777d,11,28.89090909090909
b0f3a98136fb0e22d808f855bd430970,11,13.377272727272727
3806104dbbc3d14c17b091b3b8e38d59,10,15.424000000000001
1d37df739a7cdbd28609dc2954cc2c75,10,13.799000000000001
ed917c786a8a3e411eae87aeca27cb27,10,28.881999999999998
afc3f49cfd0567e08a8c452beb212c04,10,9.065999999999999
6bd5b501f37638859ccc1dc94cce730d,9,3.776666666666666
3e43e6105506432c953e165fb2acf44c,9,130.29555555555555
a4d4a76b47ccec27db5ea63da11debf5,9,34.803333333333335
182ebbe49711dd49de4fbbdf4a999c10,9,62.84222222222221
0fff4016f4008007ba2bb7d63ebae39d,9,13.520000000000001
495fe7ae31686381c8145b2936e761dc,9,33.68888888888889
e0ff4805ba6693550d1db7d374c477c9,9,8.575555555555557
3069f30fbf3f30057b1b4ff36c72208e,9,13.094444444444443
2eba6acde8e5a52e86f94b2c6224a986,9,21.008888888888887
311b7759da40d8d24724a882f0641308,8,77.76
142f18a4a7cd370e40b64f34baf14a6a,8,4.9399999999999995
738ffcf1017b584e9d2684b36e07469c,8,97.39750000000001
096e351116755fe4c3c1e48eaf301a41,8,27.18625
b25a21b56a2d74da49e04cadbc9e0dd8,8,15.9525
aad0fb3a1680f7a08d9b8de7da72e1cc,8,12.28875
ab719d1153364ba40df26f5e44c6192a,8,11.48125
c63a8c4fb13043a3fbe33bd17c69d17d,8,4.2425
1b6c7548a2a1f9037c1fd3ddfed95f33,8,119.87625
f0fd988c7c2a4cba167138a8adada6ca,8,21.942500000000003
08d8fd00898e7cc99d6e32c74d7d3ce5,8,4.375
a52327252e5d68739d85eadb7dd461e4,8,21.465
fa897856f19a95faf61b1fe22bfd0ace,7,8.712857142857143
e66c03faee607e9eb86380d0a86a327d,7,37.63857142857143
df2988ba3ed226b10521a0e4da849b61,7,12.411428571428571
bddc05c034061c84f92fe1710bfa5fe4,7,31.934285714285718
ec59dafb5820ce13fcc2fd6402be9b54,7,10.578571428571427
f71d1ce0ca77b13eb4a0909685c1a288,7,4.857142857142857
dd162f2be22e534992b3f874cc57eda0,7,19.995714285714286
90f323e9f0948ddd96c6f6a8ecc75830,7,35.02857142857143
7f6fd66526ed914998d483cff9b7bdd7,7,146.53
7019c99575147f8ea1bbf0a6e281bbf9,7,22.107142857142858
9620623f9ea546719cb3cd99bbb879a9,7,15.831428571428573
c5610cd24fef40cd91dbc4f45183eef0,7,9.847142857142858
e7251a1cbeb7ba8093c9b1593005ca90,7,37.79
7634efb2f26e897125a36155a6f92889,7,14.448571428571428
6f35424ab0a4f25807ac4e03b155832e,7,44.25714285714286
be74c431147c32ab2d7c7cef5e4a995f,7,205.20857142857145
6acc5385a15c441abe050fc7abda50bf,7,58.62428571428571
79f3d6597edbdbed1545a11e3d2fa280,7,9.557142857142859
e428b46d4645f1d7db520d95b2e446ee,7,30.37142857142857
31628ac4d85d1c46ebf7dad444adcbe3,7,23.40142857142857
6469f99c1f9dfae7733b25662e7f1782,7,108.40428571428572
993d47c24f159f09b8904941581211b3,7,18.67142857142857
8d3a01dad8496e7c850d5b3d580c8e90,7,9.304285714285713
96ce642e637cf74a0d3023db31e59d16,7,45.79
58b051c30d684ac12a2049a49c856203,7,6.67
cea1537ac1a5e083b8626a93f85475cc,7,5.96
ca77025e7201e3b30c44b472ff346268,7,160.38857142857142
56437a026e07b2b2271b8742aee81fb9,7,39.55714285714286
cfaec087ed620ecebc6e6f82fe276fe2,7,9.892857142857142
4532ac5f2f4f8c943a41d1ba00bd6c6d,7,19.225714285714282
262305e901587b79c5236175b06efb78,6,84.62666666666667
75a2adfe9f86d401f24b5fe2eb9a582c,6,59.03
2bca5fe01d46ab5cc2bc5aaade88d850,6,3.1666666666666665
ae977f6cf6981d883940f7e618620b3e,6,5.923333333333333
37d2d1ac62901f9a36cff32ca86c9337,6,30.293333333333333
09f55ef15bde8baeef87b3348b31c150,6,7.183333333333333
fd7069cf6891edbf32ba84c9c3f083d4,6,180.88333333333333
a1bb96820529725c3c79a77c69e7e792,6,13.281666666666666
94bd5dee83e9590368179f4ab026b4f4,6,19.201666666666668
6a8f804159a866574d2831e9651f589e,6,26.46666666666667
47c1a3033b8b77b3ab6e109eb4d5fdf3,6,157.3683333333333
7b08fc11e1aacd85ef2845c1
Query:
-- 10. Retrieve customer details along with order counts and average payment values.
SELECT c."customer_unique_id", c."customer_city", c."customer_state", COUNT(*) AS "num_delivered_orders", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Answer:
Too long, hard cut:
customer_unique_id,customer_city,customer_state,num_delivered_orders,avg_payment_value
9a736b248f67d166d2fbb006bcb877c3,sao paulo,SP,33,7.075454545454545
569aa12b73b5f7edeaa6f2a01603e381,sao paulo,SP,26,2.4107692307692306
f9ae226291893fda10af7965268fb7f6,guarulhos,SP,23,22.65521739130435
2524dcec233c3766f2c2b22f69fd65f4,tupa,SP,22,1.856818181818182
6fbc7cdadbb522125f4b27ae9dee4060,rio de janeiro,RJ,19,10.82842105263158
24f12460aad399ba18f4ed2c2fbab65d,campinas,SP,19,4.354210526315789
1d2435aa3b858d45c707c9fc25e18779,rio de janeiro,RJ,16,9.223749999999999
c4b224d2c784bae11ae98b6ae9f2454c,sao paulo,SP,15,49.384
25ba76039a1caff121dfcb0d66e54780,cabo frio,RJ,15,5.799333333333333
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,15,58.618
94a19681bf6faa3c6ce3e2df1c2d97cb,sao paulo,SP,14,14.40857142857143
1bc3d5e384c365c86cf79078f32eb495,embu-guacu,SP,14,7.183571428571429
301d1ce5a76b7e1bc47e5115bf5eb6ba,palmas,TO,14,37.824999999999996
7293e0b38ab0dab128e6bfb7239c37ad,sao paulo,SP,13,8.251538461538463
c411c8b6dbaffd467263f87a23f2cf52,sao paulo,SP,13,16.103846153846153
74adf920dbd3d2e6e9f18acd88b2fd41,ubatuba,SP,13,7.863076923076924
aae867e923db95a5af878ffec19ebd8c,sao paulo,SP,13,14.378461538461538
90807fdb59eec2152bc977feeb6e47e7,suzano,SP,12,8.987499999999999
85963fd37bfd387aa6d915d8a1065486,atibaia,SP,12,73.28666666666666
39c7f8c4e4552af113351a650816296c,sao jose dos pinhais,PR,12,5.8308333333333335
024676cef113f6c81db6c5b8d29e5ee9,sao paulo,SP,12,5.298333333333333
db1af3fd6b23ac3873ef02619d548f9c,itaqui,RS,12,27.435000000000002
c96dac240f97b3f694b804e6406af73d,cabo frio,RJ,11,7.969090909090909
43128f4462af59091a28f9141a3ee7ba,itaborai,RJ,11,12.498181818181818
2f8b722d3e62bb8a9860c7a29ad2b60f,sumare,SP,11,20.718181818181815
ff4bb0e2cade5df30146a1d570ae777d,bom jesus dos perdoes,SP,11,28.89090909090909
a378caa847f8b44d00411d34449359d1,sao jose dos campos,SP,11,7.006363636363636
b0f3a98136fb0e22d808f855bd430970,canoas,RS,11,13.377272727272727
0fc594155e889688ea4477afcd26a134,ilheus,BA,11,19.126363636363635
3806104dbbc3d14c17b091b3b8e38d59,sao paulo,SP,10,15.424000000000001
ed917c786a8a3e411eae87aeca27cb27,cruz alta,RS,10,28.881999999999998
1d37df739a7cdbd28609dc2954cc2c75,sao joao de meriti,RJ,10,13.799000000000001
afc3f49cfd0567e08a8c452beb212c04,taubate,SP,10,9.065999999999999
2eba6acde8e5a52e86f94b2c6224a986,franca,SP,9,21.008888888888887
495fe7ae31686381c8145b2936e761dc,rio de janeiro,RJ,9,33.68888888888889
6bd5b501f37638859ccc1dc94cce730d,carapicuiba,SP,9,3.776666666666666
3e43e6105506432c953e165fb2acf44c,praia grande,SP,9,130.29555555555555
0fff4016f4008007ba2bb7d63ebae39d,mogi das cruzes,SP,9,13.520000000000001
e0ff4805ba6693550d1db7d374c477c9,conselheiro lafaiete,MG,9,8.575555555555557
182ebbe49711dd49de4fbbdf4a999c10,sao paulo,SP,9,62.84222222222221
a4d4a76b47ccec27db5ea63da11debf5,salvador,BA,9,34.803333333333335
3069f30fbf3f30057b1b4ff36c72208e,rio de janeiro,RJ,9,13.094444444444443
311b7759da40d8d24724a882f0641308,goiania,GO,8,77.76
ab719d1153364ba40df26f5e44c6192a,brotas,SP,8,11.48125
1b6c7548a2a1f9037c1fd3ddfed95f33,ituiutaba,MG,8,119.87625
a52327252e5d68739d85eadb7dd461e4,franca,SP,8,21.465
aad0fb3a1680f7a08d9b8de7da72e1cc,rio de janeiro,RJ,8,12.28875
f0fd988c7c2a4cba167138a8adada6ca,cansancao,BA,8,21.942500000000003
c63a8c4fb13043a3fbe33bd17c69d17d,caucaia,CE,8,4.2425
142f18a4a7cd370e40b64f34baf14a6a,sao jose dos pinhais,PR,8,4.9399999999999995
08d8fd00898e7cc99d6e32c74d7d3ce5,campos dos goytacazes,RJ,8,4.375
096e351116755fe4c3c1e48eaf301a41,sao paulo,SP,8,27.18625
c5610cd24fef40cd91dbc4f45183eef0,sao paulo,SP,7,9.847142857142858
7634efb2f26e897125a36155a6f92889,sao paulo,SP,7,14.448571428571428
8d3a01dad8496e7c850d5b3d580c8e90,sao paulo,SP,7,9.304285714285713
9620623f9ea546719cb3cd99bbb879a9,paulinia,SP,7,15.831428571428573
56437a026e07b2b2271b8742aee81fb9,indaiatuba,SP,7,39.55714285714286
7019c99575147f8ea1bbf0a6e281bbf9,rio de janeiro,RJ,7,22.107142857142858
79f3d6597edbdbed1545a11e3d2fa280,contagem,MG,7,9.557142857142859
ec59dafb5820ce13fcc2fd6402be9b54,apucarana,PR,7,10.578571428571427
6f35424ab0a4f25807ac4e03b155832e,rio de janeiro,RJ,7,44.25714285714286
bddc05c034061c84f92fe1710bfa5fe4,sao joaquim da barra,SP,7,31.934285714285718
ca77025e7201e3b30c44b472ff346268,recife,PE,7,160.38857142857142
dd162f2be22e534992b3f874cc57eda0,guaruja,SP,7,19.995714285714286
cfaec087ed620ecebc6e6f82fe276fe2,goiania,GO,7,9.892857142857142
4532ac5f2f4f8c943a41d1ba00bd6c6d,goiania,GO,7,19.225714285714282
e66c03faee607e9eb86380d0a86a327d,rio de janeiro,RJ,7,37.63857142857143
96ce642e637cf74a0d3023db31e59d16,adamantina,SP,7,45.79
31628ac4d85d1c46ebf7dad444adcbe3,paraty,RJ,7,23.40142857142857
cea1537ac1a5e083b8626a93f85475cc,sao vicente,SP,7,5.96
6acc5385a15c441abe050fc7abda50bf,salvador,BA,7,58.62428571428571
e7251a1cbeb7ba8093c9b1593005ca90,belo horizonte,MG,7,37.79
993d47c24f159f09b8904941581211b3,curitiba,PR,7,18.67142857142857
6469f99c1f9dfae7733b25662e7f1782,santos,SP,7,108.40428571428572
df2988ba3ed226b10521a0e
Query:
-- 11. List distinct mappings of customer IDs to customer unique IDs.
SELECT DISTINCT "customer_id", "customer_unique_id"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS
LIMIT 100;
Answer:
Too long, hard cut:
customer_id,customer_unique_id
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db
26acee41e2f75689a5615892f06ea0bd,c3293e875ffb1116018edf76d24e52a2
7300450cedf7e4c35c243c4a03c1e8a6,95700615deef776ed32faa08f0be634e
4c7241af24b5344cb01fe687643de4fe,b157c176c3fe04914fde33f2dc8b878a
b514422efcf14bef34858a0829bef189,b436a108536c1dabbc1d3e808d782df9
0aae2862f8eac77f10a34f44860720ac,cd076285a12f40041b32f5ad8c98699f
12d1b4294fef21016c9614eb31e55e15,7556f182460418cf30957e6ce377c674
ee3a81b2771fec5f9e982cdb1b3a4804,a9a77b4e25980b7ca58cb71f878abb27
f7cb015ff73be957ee6a30e2577742c5,e235442a956c524e6c141141171f5801
5f8b4882b5a4ec7bf6d2107e6cd0cf29,694cb45ff29b603ac2acd51016770097
a1b9e0e44dbb043645cd14b00849a705,eab761ccdba80c5b9a7f01b16543da0f
39c9dc82d5f60eb1ee8bc4fe4aa29dc6,1f6d48610f32c723924f9af3e88f1c64
aa0fbd830c89acc3d79d311ff43d0920,eabd76f3506262b0db0dda1d48394a9b
bf60fa574e188373d3cb331d04aeb4f1,54fccbde5e005f2dbc6ad8d5473c9ac7
8d1b923f85a34afac5bd669d50417602,82e96a74eeb99b61395a1403630fe437
e255bea28fdeb105b85a23947349cca5,34c6f984b590bbfe3d4d6c76007c0b1c
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391
38d1cd89306128348ffdf4cc23f3a50a,d491a65a6ef3c04e145d37395996bad7
91ec76836092bba85d11761078ed7bb5,6edd17d0a29e2d4057e694afee5eaa3b
23e96758fd640560e9b1fbcda90abfc4,9e1f719fe5b17b9c51905fee6d6385c1
4cc465bb8ccb079ba561852ffa794668,7981196c7252350915beb9a7367d40b2
560829a36d563e8395cc073071a02bfd,fa7e6f153b7724fda5c1d7cc7b9ae4ec
b0964d76975dbc174b623b5a300973d5,24a5c2b24a4467c37e2f54c1b311de93
f7c5afab273b47ab517e096e0219b932,b6c083700ca8c135ba9f0f132930d4e8
7f2357cfd99c900565e6ffd6d2708d9d,466c3a741a952640c1984a48ebbffbf9
029ca19aa34f9311941ab931975cff1b,95363f351776a3f8a43145c79a046053
d6b41b191f1f643ff583898156e049cf,3a62a4803c77457a96c996a9db36a662
8891eb5ca0e28df961b2b5b8f3c0eb23,13ac6da47fef1b17b16f511e03b57918
154e666b681104319714a99a3ab71e44,be1e99a0c57d7c3c699cfc4db26c8edf
9e0628923d9fe029c079eb11ae72d241,dc643b60537f44f35b2f91610ea64153
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e
cc32707d2e2f7c92ab449f9b28154809,0d516ca029d6a28d5cfddd80b27a26dc
6c9a5923526346cbc0bd7bbd92269c01,cf6d4152d758efc43910e0141ae5b912
f6529ffebe6b3440d45
Query:
-- 12. Display all distinct order statuses.
SELECT DISTINCT "order_status"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
LIMIT 100;
Answer:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved
Query:
-- 13. Count the number of orders per status.
SELECT "order_status", COUNT(*) AS "num_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS
GROUP BY "order_status"
LIMIT 100;
Answer:
order_status,num_orders
delivered,96478
invoiced,314
shipped,1107
processing,301
unavailable,609
canceled,625
created,5
approved,2
Query:
-- 14. Summarize payment information per order.
SELECT p."order_id", COUNT(*) AS "num_payments", SUM(p."payment_value") AS "total_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
GROUP BY p."order_id"
LIMIT 100;
Answer:
order_id,num_payments,total_payment_value
b81ef226f3fe1789b1e8b2acac839d17,1,99.33
a9810da82917af2d9aefd1278f1dcfa0,1,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,1,65.71
ba78997921bbcdc1373bb41e913ab953,1,107.78
298fcdf1f73eb413e4d26d01b25bc1cd,1,96.12
771ee386b001f06208a7419e4fc1bbd7,1,81.16
1f78449c87a54faf9e96e88ba1491fa9,1,341.09
0573b5e23cbd798006520e1d5b4c6714,1,51.95
d88e0d5fa41661ce03cf6cf336527646,1,188.73
2480f727e869fdeb397244a21b721b67,1,141.9
616105c9352a9668c38303ad44e056cd,1,75.78
769214176682788a92801d8907fa1b40,1,105.28
79da3f5fe31ad1e454f06f95dc032ad5,1,98.94
8ac09207f415d55acff302df7d6a895c,1,244.15
5a1f6d22f7dfb061ef29216b9af687a1,1,47.69
4214cda550ece8ee66441f459dc33a8c,1,170.57
4d680edbaa7d3d9bed69532957368a03,1,353.09
5d9c5817e278892b7498d90bfa28ade8,1,290.16
f45074ae38f2e01d9b854ec8d40362ff,1,13.78
81cedc4d2132eb6f512354166e51b187,1,30.28
f9d0ec2fa088ac583e1ccd15b6686073,1,89.68
23f10f509600c30cf2852f9dbdf28fc3,1,103.49
cf30fe76d1505192acee1c6dccb15545,1,47.72
0e0441786430b7cfcd0d91f822ea4c99,1,121.49
6ffb3f1686bceae3466facf7e02ce3fb,1,32.0
1807cc736321f14baa58ef39cf6e5989,1,91.66
10af96a0689260134307879127ac1952,1,113.2
85eef2d342b0de363c45c1bc324729c5,1,99.43
3e0c3cab458e8b3cc8d1d38ecb7e7775,1,105.53
795c16acb4e3c30dfa5b6827727ef488,1,37.58
e3e9e3295f4e1512167c232a0aaae8a5,1,50.8
42f5954cda381bd032934ee38c453711,1,402.42
c9f23db8a1cb725df9bdb3383bd72b38,1,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,1,34.78
b19ca559688b49e8cf7f88c1aa3f0009,1,73.34
4a02e985c7239d866a632f07ed20d9c0,1,48.62
46ee6eaca194413758f200a6974b7e4d,1,71.99
a490a5d59a9bf4ef3334bfd7cf1dbdfc,1,17.78
c1b770015e27aaf2b475026989d04fe0,1,137.73
d087b8e096ca051f548e29b324272834,1,72.05
5cfd514482e22bc992e7693f0e3e8df7,2,710.5799999999999
f86f6472fa9f395d8d9a6751ca118afb,1,64.03
d3e774a185c0b1b2286ffd6c70abe2e6,1,117.74
56c3277583e16009c925fdf116df420f,1,31.38
afef48d3c8a0b1b7c9b7f8f922fb5674,1,153.41
2e2c60b99754ae1e4d8b18846cfec9f2,1,542.66
343348b1e29e9fa9e7b6ab1027f9177d,1,43.77
97c111c4f22dfa1089a9c0b5338dcc79,1,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,1,187.51
e1b4ee0e390fbac1dec439d72b45a115,1,77.7
f8d323a2702fed37f0229965f7e9f8b3,1,51.14
3ba2d0012b1f34bc6ccbc31c4ba69f93,1,60.07
96de2b7f7f3c401fbee3eef068376da6,1,32.15
f090de1b2ed9f4e251662cb31e3c7127,1,27.63
2ccde1e4676c20b9444e2bcbed36334c,1,134.56
68d7420c86be23f313c81a554320f986,1,121.88
a5f860aaf6a3c35399495aefe92d363f,1,75.75
55779fa8fe072d9f8c92d672154558f2,1,233.66
845af9472cc76e66fbf445931b511755,1,123.41
67c8c2016ddabf0059783eb44e921f99,1,68.54
332c6742772f2df936696b6512b10edb,2,143.25
27a7ac440630f9de788e4d66e72c6424,1,186.39
e6670c9089973cc68e5b90b7d1f4fec4,1,88.49
aa7c35fd606f4275e267e859c6a84d0f,1,26.68
3d7239c394a212faae122962df514ac7,1,51.84
cf95215a722f3ebf29e6bbab87a29e61,1,102.66
12e5cfe0e4716b59afb0e0f4a3bd6570,1,157.45
61059985a6fc0ad64e95d9944caacdad,1,132.04
8cd68144cdb62dc0d60848cf8616d2a4,1,330.66
c39414c195d0f94c9d9c35e7c6ed4f1a,1,139.22
e647bf617de735448a4ba54f8910393c,1,65.09
aa964845f1de8125410aea8b73e9e1ec,1,27.35
ad4098a257676ea4d394fb3bbbf36ca3,1,68.49
4217849b1ff18a9270fe048eabc4dc45,1,67.88
55e2d723733c45033e71cb4d44690234,1,89.63
4c2e1a95586c815795a324d1599e7b5a,1,117.71
723e462ce1ee50e024887c0b403130f3,2,113.8
198298d54f269d8c5fe89e85a859af61,1,342.56
20f136d890c31a62486c809f91a5b098,1,117.68
cf61ad2218e5c14397e7c0ba7a6a50f9,1,35.14
99bc267f49d76932cd195bfb2a94dd03,1,163.08
aa600269bffea363cca75ad2d1908903,1,93.26
57e4fc8f20507381b3f7abbe4e2ccda3,1,215.56
ae1126b6891f58552443772c80b1f562,1,133.81
42fdf880ba16b47b59251dd489d4441a,1,128.45
adfbf6c2a620196f9a3ec747491c72b7,1,67.5
d0a945f85ba1074b60aac97ade7e240e,1,541.0
595f598849d89203c28d05d0fbf3f92e,1,26.58
b2bb080b6bc860118a246fd9b6fad6da,2,197.92000000000002
32b1d8f3789a57f1f752e20ac7404b4c,1,56.6
c0db7d31ace61fc360a3eaa34dd3457c,1,65.71
d574338f566ca28dd67820f48ec1f1d8,1,278.22
e8977f709bbb0367f51b589e6325f991,1,132.51
95442deb81a5d91c97c0df96b431634a,1,368.98
fc662bafa52d2ef16078f6f6141009d6,1,90.05
947e9c6bfd83a06953c420ef92d3da6e,1,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,1,78.3
460d57443ffdcaeba240360239747cf7,1,34.0
4d3bfdf4c7d6578ea445d588371ae10e,1,77.29
8e47a04b25d7a7075064e8e0bd2e0318,1,37.61
Query:
-- 15. List all distinct payment types used.
SELECT DISTINCT "payment_type"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS
LIMIT 100;
Answer:
payment_type
credit_card
boleto
voucher
debit_card
not_defined
Query:
-- 16. Retrieve payment values and types along with customer unique IDs.
SELECT c."customer_unique_id", p."payment_value", p."payment_type"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
LIMIT 100;
Answer:
Too long, hard cut:
customer_unique_id,payment_value,payment_type
708ab75d2a007f0564aedd11139c7708,99.33,credit_card
a8b9d3a27068454b1c98cc67d4e31e6f,24.39,credit_card
6f70c0b2f7552832ba46eb57b1c5651e,65.71,credit_card
87695ed086ebd36f20404c82d20fca87,107.78,credit_card
4291db0da71914754618cd789aebcd56,128.45,credit_card
6e3c218d5f0434ddc4af3d6a60767bbf,96.12,credit_card
9a3526eee723accd014ec683afe5bf20,81.16,credit_card
9db67268a3fee1d4b13faaeb90af07c0,51.84,credit_card
2ecddf370925aff428e58b4f6021fe38,341.09,credit_card
511c345b0383af6ef25406c564e4d6b6,51.95,boleto
a51f8568095ce89a4ffce365dcb7d46d,188.73,credit_card
2faf4a1d502b10555a9f39353ea20148,141.9,credit_card
198ab463c8a3a754aa6ae61b38c4c8db,75.78,credit_card
ec103b892f579de25189dda196a4c5b3,102.66,credit_card
9b61cfcf9bc923fed1c1c8d38fab5a1c,105.28,credit_card
0ae522661311f598df20272643d39ce6,157.45,credit_card
3129dce5dc566246ea1354bff5bb6fea,132.04,credit_card
186638bdb0f600c9bf2bd60e4b14537c,98.94,credit_card
501598d5821539430a35385474cd44d9,244.15,credit_card
d386a136dc889cf681443061874caad8,136.71,credit_card
5986b5f70bf08b414d16a93ac5b1d76c,47.69,credit_card
79403f8240aafdd83128106b5b48fd43,170.57,credit_card
bd5fb6a2e66d7bfb061efd93b994f168,67.5,credit_card
14f64911f31f3722899596d1095a233e,353.09,credit_card
d0c437f172b9c527c0d196815b92c5ce,330.66,boleto
e2381d9bb9b49c35fff077d4ae613816,45.17,voucher
d132b863416f85f2abb1a988ca05dd12,541.0,credit_card
53829feb906370f277393325399b8487,139.22,credit_card
67a7e94ec59ef6d6ba83942c81d39b9a,290.16,credit_card
e9dc392ca45bbd1c3faf921ccd7ebbd1,283.34,boleto
9585898e80f9de26178eb04cd600b6f5,13.78,credit_card
d0ad8d078320fd639fe1ef1bcbe0e4af,30.28,credit_card
bf635aadfff238fd7e9b0d25e800d019,26.58,credit_card
35aebf263a4418be92141cc28421c0e0,89.68,credit_card
4872db1f116f7639293f1e960ac655d6,65.09,credit_card
a6aa1df65dedcad75c34bbc175e5a068,173.84,credit_card
3af91c25f393301d27ccd39bce43f29d,103.49,credit_card
1504b719eb728716ff7583dc7b86a0b0,64.03,credit_card
1b70f1238c390e4e7f01455440b09233,157.15,credit_card
34dd888b565982c76c7a9ee9dc41db4e,130.88,boleto
1fe64a1a47422f65cb1c179f0ab5ee36,47.72,credit_card
cdf4461e9701d83bfb42aa0e2319cd68,117.74,credit_card
52cf00bf99b259287bcd5b5a766adf2a,56.6,boleto
2becf6f55d064453e6d7abe2af4ad36b,266.16,credit_card
07314acd6253564af6a73a1cc8aca080,31.38,boleto
1801a172ccbf9172fa375bb6f0c9765e,121.49,credit_card
35fd26e0b8e2aad867717d6e3227fc9d,32.0,credit_card
a56a69b5c5e0e105c671353ee9caa01a,153.41,credit_card
271d3cdd872021b1b6669ad93e8b856b,65.71,credit_card
aec80ef34b077632b58f710c6d9476d3,278.22,credit_card
f822326a71e929f4d905a15676a5cb48,91.66,credit_card
5ceed695eeb968efc7959d859a902e00,132.51,credit_card
74dc6a3e622375fc6aae191555a5a95a,542.66,credit_card
78fc10170ee499077d81e1ed7b03fe6e,166.04,boleto
5b7f468205743c98e58a379722d3ae79,368.98,boleto
b807ae7957e78cf94c30251b4ddd0ed9,113.2,credit_card
b1cae7084960bab5c863422a645dce72,99.43,credit_card
8632c4862d819878dc37d5d2867d87ba,27.35,credit_card
10e49a12540465d3141f898aeee0a6b4,43.77,credit_card
47a0a92a1b4d507faa45c6d4910e9d2d,68.49,credit_card
1defe0913f512f19056b668156476990,105.53,credit_card
bcdd3f31625ec664aca676d1c101e753,387.8,credit_card
f384ac31b4473faf74a4672c9d0d9c69,84.14,boleto
741996aa586218efdc5169365507510d,210.82,credit_card
f42a3583d172ef020244c94136cac8db,90.05,boleto
ce4f5c53597a5a4e50f990e8e7676bd9,67.88,credit_card
d7b23ec12acc9df1a7f032ae6b276976,37.58,credit_card
f0e310a6839dce9de1638e0fe5ab282a,89.63,boleto
a2ac4c64994786e12db70e1782d2bfef,69.46,voucher
300077767cbc925601b3e23098cfc69a,78.3,credit_card
0b11937f7f94a269cc94a3378be84839,50.8,voucher
1acc368e2db62752896a9e414eff41c2,34.0,credit_card
3904ade0c6610a7c4fb9ec34259528f6,77.1,boleto
2a6f1c54c079bb319508a8278df9febc,566.4,credit_card
30d2beed036d709d9e6ded9c08496981,402.42,credit_card
764bf13c9f7df277b9c0950b88b4c3eb,57.53,voucher
ae74c314b9c383e5d7bcd99d54ffbc71,44.01,credit_card
b07a68d575f329bb71dcbd58e3fb5a16,187.51,credit_card
aec9d2bee598a5e8f88b3e9a8b29bc86,77.7,credit_card
297ec5afd18366f5ba27520cc4954151,48.68,credit_card
ecac07aedaa3221150cc28e6fa2e99db,77.29,credit_card
9cd31aa2388af9525780c2e1c3ad4ff7,117.71,credit_card
201e18d3b497478c79eaf7306aa38a21,169.34,credit_card
7602a5a3d9acc46b565e9c6551c8f494,37.61,credit_card
8fcf63613662e902d775fa5aa245c5e0,13.8,credit_card
7d409442d2f22a2d058c1d1a19615324,227.12,debit_card
adc3fee64ef2dad64eb6fbe5db907742,34.78,credit_card
16211bcf5b07a02aaa15f592d88cd42f,342.56,credit_card
8d384d9d49defe554f47b8186a206803,73.34,credit_card
4320120e01ea53da8c84d35c246cc3e6,117.85,credit_card
4f6e6a1e4d70f0210c1aa0861dfd5c78,48.62,credit_card
fa1573613e47e14b61de057fcae891b0,53.99,credit_card
28e4558f55bcf5b9f9ef85e9985f1810,51.14,credit_card
89d4ec26627e7fe35be69c0512748842,121.45,credit_card
d94137816541d7919b82c664a8f3937f,73.34,credit_card
127d41455fd0ee4fe94ecd34b6b206b9,117.68,credit_card
a324e032a76af91eb1bfbc44a2abe81c,56.77,credit_card
1d7e8be24bca64576da891970638bfe3,115.59,credit_card
0
Query:
-- 17. Count the number of orders per city.
SELECT c."customer_city", COUNT(*) AS "num_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_city"
LIMIT 100;
Answer:
customer_city,num_orders
sao paulo,15540
campinas,1444
jaragua do sul,89
timoteo,54
montes claros,211
rio de janeiro,6882
santo andre,797
cachoeiro de itapemirim,122
sao jose dos campos,691
sao luis,353
sao jose,169
taquarituba,16
barrinha,20
brasilia,2131
nova iguacu,442
aparecida de goiania,110
cascavel,153
salto,95
cabo frio,117
cafeara,3
foz do iguacu,87
rio grande,125
santa cruz do rio pardo,35
diadema,286
birigui,79
marialva,16
gameleiras,3
mangaratiba,13
espigao do oeste,6
ivoti,13
sao carlos,241
feliz,14
itajuba,94
paulista,42
timbo,20
nova bassano,4
moncoes,2
araucaria,54
niteroi,849
paraiba do sul,18
balneario camboriu,100
santiago,26
salvador,1245
pocos de caldas,122
uba,53
sao sebastiao do paraiso,36
arapiraca,29
nova friburgo,152
carangola,27
camboriu,28
osasco,746
ribeira,3
sao joao de meriti,134
pirassununga,69
sao caetano do sul,277
chapada do norte,2
teresopolis,120
porto feliz,22
palhoca,95
regeneracao,6
ipameri,13
araruama,77
comendador levy gasparian,7
pires do rio,12
curitiba,1521
sao roque,79
parati,13
fortaleza,654
uberlandia,374
pindamonhangaba,101
varre-sai,4
goiania,692
cacapava,74
santos,713
paulinia,130
ibatiba,9
taboao da serra,296
bom jesus,14
feira de santana,185
contagem,426
suzano,234
ipatinga,171
apucarana,52
sao sepe,6
alta floresta,12
jaboatao dos guararapes,135
votorantim,85
barra mansa,123
cuiaba,248
campo limpo paulista,48
itaquaquecetuba,172
valenca,63
altamira,25
vianopolis,3
loanda,13
charqueada,10
icem,9
joao pessoa,256
francisco morato,100
boa esperanca do sul,11
Query:
-- 18. Identify top customers per city based on delivered orders.
SELECT c."customer_city", c."customer_unique_id", COUNT(*) AS "num_delivered_orders"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_city", c."customer_unique_id"
ORDER BY "num_delivered_orders" DESC
LIMIT 100;
Answer:
customer_city,customer_unique_id,num_delivered_orders
sao paulo,8d50f5eadf50201ccdcedfb9e2ac8455,15
praia grande,3e43e6105506432c953e165fb2acf44c,9
ituiutaba,1b6c7548a2a1f9037c1fd3ddfed95f33,7
recife,ca77025e7201e3b30c44b472ff346268,7
santos,6469f99c1f9dfae7733b25662e7f1782,7
rio de janeiro,63cfc61cee11cbe306bff5857d00bfe4,6
jandira,47c1a3033b8b77b3ab6e109eb4d5fdf3,6
curitiba,12f5d6e1cbf93dafd9dcc19095df0b3d,6
garanhuns,dc813062e0fc23409cd255f7f53c7074,6
vitoria,f0e310a6839dce9de1638e0fe5ab282a,6
sao caetano do sul,4e65032f1f574189fb793bac5a867bbc,5
sao luis,35ecdf6858edc6427223b64804cf028e,5
sao paulo,fe81bb32c243a86b2f86fbf053fe6140,5
sao paulo,74cb1ad7e6d5674325c1f99b5ea30d82,5
sao paulo,394ac4de8f3acb14253c177f0e15bc58,5
feira de santana,5e8f38a9a1c023f3db718edcf926a2db,5
juiz de fora,b4e4f24de1e8725b74e4a1f4975116ed,5
santo andre,de34b16117594161a6a89c50b289d35a,5
guaxupe,56c8638e7c058b98aae6d74d2dd6ea23,5
sao mateus,b08fab27d47a1eb6deda07bfd965ad43,4
manaus,a239b8e2fbce33780f1f1912e2ee5275,4
sao paulo,d3359a56d96666ac0c21bb01e7a61c95,4
porto alegre,7305430719d715992b00be82af4a6aa8,4
canoas,a0abd26659c9914690cbd3320d39fd96,4
petropolis,f64ec6d8dd29940264cd0bbb5ecade8a,4
porto alegre,c8460e4251689ba205045f3ea17884a1,4
ribeirao preto,b2bd387fdc3cf05931f0f897d607dc88,4
porto alegre,4facc2e6fbc2bffab2fea92d2b4aa7e4,4
curitiba,83e7958a94bd7f74a9414d8782f87628,4
rio de janeiro,a1874c5550d2f0bc14cc122164603713,4
curitiba,795c1622cf7a53d63d324e862349d01c,4
sao bernardo do campo,b39dde6dd619943190a8cc9aa6db38a4,4
porto alegre,25a560b9a6006157838aab1bdbd68624,4
francisco morato,b896655e2083a1d76b7b85df8fc86e40,4
correia pinto,c37cc6c1a59d81460a3059744f7ada1c,4
osasco,2ddc001b620bd90d0f4378cfde1db887,4
coromandel,a7657330b1c135f3acd420326e335b2c,4
rio de janeiro,9cc5a07f169a1606fd347a56683e6ea6,4
santo andre,a73c5464692d3bc09d64e3edefae9015,4
rio de janeiro,ec7f1811826ab04a27a92197bc40c888,4
sao paulo,6358b15ef7fa9b1210f1a5735cabd3d9,4
niteroi,397b44d5bb99eabf54ea9c2b41ebb905,4
montanha,12d8b5ed661190a3a08183644dfc504d,4
porto velho,acea6bd29b8c1e3c6a8b266a8fb4475e,4
joao pessoa,08e5b38d7948d37fbb2a59fc5e175ab1,4
ribeirao preto,310647380793836bfa5b7b6b3f518423,3
catalao,51d91326ffc0688da14a001de38c264b,3
dourados,06a52782a04f0086d16b9c22d0e29438,3
petropolis,0a609db8d244100909a15d65eadf8539,3
porto alegre,86df00dc5fd68f4dd5d5945ca19f3ed6,3
sao paulo,a3021c629bd1d99347a8e75a9ab035d8,3
timbo,f34cd7fd85a1f8baff886edf09567be3,3
canoas,2e43e031f10de28e557c35ef668f9396,3
sao bernardo do campo,b64ebaf3d11b7209fe566364cc359a51,3
sao paulo,cd11a0920c498edb1da9ecd2d31aa599,3
rio de janeiro,c76762dfb642ac154475239639f7f8f4,3
tijucas,90f323e9f0948ddd96c6f6a8ecc75830,3
joao pessoa,083ca1aa470c280236380973a48f77c6,3
belo horizonte,cef29e793e232d30250331804cdb7000,3
maringa,593cb774409e5239a1946d1c88e0813d,3
saquarema,bb58670190dba4e9b320f84cb98317a3,3
rio de janeiro,3db6e5afa8e8178a29afc729855315e2,3
barrinha,0e4cb268bd62da7db135af6349b4fc2a,3
barra do tarrachil,bd86b1862fe796149a4d2af57bd85451,3
aracruz,b59e4bb4efe81ba0f7d30cff6734f9a2,3
sao paulo,e3301490c373db9263c15a73172d0c6f,3
jundiai,98e3117841a2431959d17808f04bf23c,3
sao jose dos campos,3de0c9303f39b7ccfe69ca11aee19cc6,3
catanduva,d7624d219b6ffad980e91412174db310,3
teresina,0cc2ee1112a11a1094eff52fa2e87150,3
campinas,e0836a97eaae86ac4adc26fbb334a527,3
astolfo dutra,e78838df9c44e102b6ac84cc5eea7d5c,3
rio de janeiro,ae20947231d4d44dde1680a7ab14d90a,3
sao paulo,fc719c11b4dce594f47e1f9aa739a3a2,3
rio de janeiro,4e2d666f4bbc94a8ded712172a433d65,3
sao joaquim da barra,26a6e3e036636ef1d5636f98b66094cc,3
morrinhos,a029899dd8534557a81c369475ff80c8,3
sao paulo,7589544c08cc5de364cad85ee73f4b63,3
brasilia,3e5306add1209e5ba184092dd1587282,3
rio de janeiro,a40096fc0a3862e9e12bc55b5f8e6ab2,3
petropolis,6419a1be8feac26ec793667b71cbaeb4,3
petropolis,6a6a7141119ceaeca4dfbae7a580a515,3
sao paulo,d4a5e9f19897de65433c9d97bf4b9f8e,3
belo horizonte,0a61b571f594b6919601bcf3380da7f7,3
sao paulo,9d31457a03125fc870787a251760315a,3
rio de janeiro,e68e1b61896163cdd7f8e07b2ae814c9,3
rio de janeiro,25f3cf83109f636d52d288fa4e797111,3
valenca,1373e04979cfa0fb2092909abbd57f25,3
santo andre,d132b863416f85f2abb1a988ca05dd12,3
mogi das cruzes,7779fdf670bfe673e064b9aa5447674e,3
osasco,8961b4ca2c5aceb7a78ea72c6e0c840a,3
estiva gerbi,c0118e2c0a037c31aeca71d0b81f66a1,3
pelotas,c6df3869c263531ebd51f0454a353605,3
niteroi,fd8ccc89be43894d2553494c71a61fd8,3
aruja,732d307839b02bc2d3a4c26b515ea2b9,3
niteroi,1da09dd64e235e7c2f29a4faff33535c,3
alta floresta,76a0491dd70c125840fa259f00dfc351,3
barra bonita,ff922bdd6bafcdf99cb90d7f39cea5b3,3
tres rios,c4fe9fc8b5e1b4f9992db983d0429854,3
guarulhos,a3dc27d87234f862d7e61a0148c77fa9,3
Query:
-- 19. Calculate average payment value per city.
SELECT c."customer_city", AVG(p."payment_value") AS "avg_payment_value"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  ON p."order_id" = o."order_id"
JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
  ON o."customer_id" = c."customer_id"
GROUP BY c."customer_city"
LIMIT 100;
Answer:
customer_city,avg_payment_value
juiz de fora,171.95204081632653
betim,164.3190476190476
serra,145.6466779661017
cacequi,200.3425
arapora,208.89499999999998
sorocaba,134.4558599695586
florianopolis,181.76136518771332
rio de janeiro,161.22205633411963
campinas,142.73823762376236
nova granada,106.12249999999999
araras,154.9719387755102
goiania,169.35843454790825
toledo,160.77794520547945
lagoa nova,51.300000000000004
sao lourenco,144.44361111111112
sao sebastiao do cai,198.5153846153846
sao goncalo,142.1907356321839
paulinia,133.04760563380282
pitangui,127.675
rio claro,146.38320987654322
ananindeua,230.8353260869565
amparo,185.08084507042253
campos dos goytacazes,155.86089147286822
nova iguacu,155.11971615720523
itajai,182.93851239669422
resende,134.11967479674797
santa maria,183.02367647058824
guaxupe,183.3421052631579
sao joao de meriti,145.95105263157896
ituiutaba,118.41293103448275
jequie,158.8905263157895
guaruja,139.82458677685952
porto velho,245.82882352941178
ilhabela,90.87782608695652
iaciara,274.5775
vitoria da conquista,209.69894736842107
mariluz,174.825
ibiuna,129.35258064516128
volta redonda,161.63020661157026
londrina,171.91179810725552
teresina,204.12612794612795
nova esperanca,220.0575
barra mansa,175.20315789473685
blumenau,144.94143564356435
novo hamburgo,178.9677519379845
queimados,125.09152542372883
varginha,181.56655555555557
praia grande,144.1124924012158
muriae,185.53073529411765
garca,123.35758620689654
sacramento,181.42615384615385
sao jose do goiabal,123.83500000000001
claraval,197.04
acarau,204.9925
taquara,235.94809523809522
campo bom,142.792972972973
turvo,66.86833333333334
lagoa da canoa,204.53
almirante tamandare,140.05083333333334
adustina,102.27
patos de minas,186.05336538461538
sao pedro,325.2775
itau de minas,65.71857142857142
bandeirantes do tocantins,216.1
itaborai,112.42946666666666
cascavel,176.24603658536586
pirassununga,138.993661971831
pindamonhangaba,142.6955769230769
aracariguama,93.70700000000001
cataguases,131.83800000000002
sao bernardo do campo,123.0182226762002
nova friburgo,197.13298136645963
mage,159.00466101694914
valentim gentil,139.62333333333333
sao gabriel,125.14166666666667
teixeiras,83.345
jundiai,156.89483979763912
sao luis,178.17635359116022
rio bonito,172.88931034482758
divinolandia de minas,62.564
santo antonio de jesus,166.00129032258064
carlos barbosa,155.41
ouro branco,122.87883720930232
santa rosa de lima,77.59666666666666
mendonca,78.07166666666667
rio largo,99.00571428571428
viamao,106.63532467532468
ibiaca,160.435
remanso,97.59799999999998
presidente getulio,131.54714285714286
varzea paulista,140.54461538461538
atibaia,136.61638418079096
cotia,140.44941634241246
itaperuna,164.92938775510203
chapeco,162.85073394495413
videira,204.50829787234042
caucaia,154.1895652173913
amambai,148.44833333333335
mostardas,143.36083333333332
passos,108.25916666666666
Query:
-- 20. Count the number of customers per state.
SELECT c."customer_state", COUNT(DISTINCT c."customer_unique_id") AS "num_customers"
FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
GROUP BY c."customer_state"
LIMIT 100;
Answer:
customer_state,num_customers
SP,40302
SC,3534
MG,11259
PR,4882
RJ,12384
GO,1952
ES,1964
MS,694
BA,3277
DF,2075
PA,949
MA,726
AL,401
RN,474
PI,482
PB,519
TO,273
AC,77
SE,342
RR,45
AM,143
RO,240
AP,67
MT,876
CE,1313
PE,1609
RS,5277
End Exploring Related Columns
Task: Please identify the top three customers, based on their customer_unique_id, who have the highest number of delivered orders, and provide the average payment value, city, and state for each of these customers.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To identify the top three customers with the highest number of delivered orders, we count the number of delivered orders per `customer_unique_id` from the `OLIST_ORDERS` and `OLIST_CUSTOMERS` tables. For each of these customers, we calculate the average payment value from the `OLIST_ORDER_PAYMENTS` table and retrieve their city and state from the `OLIST_CUSTOMERS` table.

```csv
customer_unique_id,average_payment_value,city,state
id1:str,avg_payment1:float,city1:str,state1:str
id2:str,avg_payment2:float,city2:str,state2:str
id3:str,avg_payment3:float,city3:str,state3:str
(Attention: answer in three rows)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'BRAZILIAN_E_COMMERCE': {'BRAZILIAN_E_COMMERCE': ['OLIST_ORDERS', 'OLIST_ORDER_PAYMENTS', 'OLIST_PRODUCTS_DATASET', 'OLIST_ORDER_ITEMS', 'OLIST_GEOLOCATION', 'OLIST_SELLERS', 'OLIST_ORDER_REVIEWS', 'OLIST_CUSTOMERS', 'OLIST_PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 15:58:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 15:58:30 - root - INFO - To identify the top three customers with the highest number of delivered orders, we count the number of delivered orders per `customer_unique_id` from the `OLIST_ORDERS` and `OLIST_CUSTOMERS` tables. For each of these customers, we calculate the average payment value from the `OLIST_ORDER_PAYMENTS` table and retrieve their city and state from the `OLIST_CUSTOMERS` table.

```sql
WITH customer_orders AS (
  SELECT
    c."customer_unique_id",
    c."customer_city" AS "city",
    c."customer_state" AS "state",
    COUNT(*) AS "num_delivered_orders",
    AVG(p."payment_value") AS "average_payment_value"
  FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  INNER JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
    ON o."customer_id" = c."customer_id"
  INNER JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
    ON o."order_id" = p."order_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
)
SELECT
  "customer_unique_id",
  ROUND("average_payment_value", 4) AS "average_payment_value",
  "city",
  "state"
FROM customer_orders
ORDER BY "num_delivered_orders" DESC NULLS LAST, "customer_unique_id"
LIMIT 3;
```
2025-02-10 15:58:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:58:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:58:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:58:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 15:58:31 - snowflake.connector.connection - INFO - closed
2025-02-10 15:58:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:58:31 - root - INFO - itercount: 1
2025-02-10 15:58:31 - root - INFO - 0
2025-02-10 15:58:31 - root - INFO - results: 
customer_unique_id,average_payment_value,city,state
9a736b248f67d166d2fbb006bcb877c3,7.0755,sao paulo,SP
569aa12b73b5f7edeaa6f2a01603e381,2.4108,sao paulo,SP
f9ae226291893fda10af7965268fb7f6,22.6552,guarulhos,SP


2025-02-10 15:58:31 - root - INFO - Please check the answer again by reviewing Please identify the top three customers, based on their customer_unique_id, who have the highest number of delivered orders, and provide the average payment value, city, and state for each of these customers., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To identify the top three customers with the highest number of delivered orders, we count the number of delivered orders per `customer_unique_id` from the `OLIST_ORDERS` and `OLIST_CUSTOMERS` tables. For each of these customers, we calculate the average payment value from the `OLIST_ORDER_PAYMENTS` table and retrieve their city and state from the `OLIST_CUSTOMERS` table.

```csv
customer_unique_id,average_payment_value,city,state
id1:str,avg_payment1:float,city1:str,state1:str
id2:str,avg_payment2:float,city2:str,state2:str
id3:str,avg_payment3:float,city3:str,state3:str
(Attention: answer in three rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
customer_unique_id,average_payment_value,city,state
9a736b248f67d166d2fbb006bcb877c3,7.0755,sao paulo,SP
569aa12b73b5f7edeaa6f2a01603e381,2.4108,sao paulo,SP
f9ae226291893fda10af7965268fb7f6,22.6552,guarulhos,SP
Current sql:
WITH customer_orders AS (
  SELECT
    c."customer_unique_id",
    c."customer_city" AS "city",
    c."customer_state" AS "state",
    COUNT(*) AS "num_delivered_orders",
    AVG(p."payment_value") AS "average_payment_value"
  FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  INNER JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
    ON o."customer_id" = c."customer_id"
  INNER JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
    ON o."order_id" = p."order_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
)
SELECT
  "customer_unique_id",
  ROUND("average_payment_value", 4) AS "average_payment_value",
  "city",
  "state"
FROM customer_orders
ORDER BY "num_delivered_orders" DESC NULLS LAST, "customer_unique_id"
LIMIT 3;
2025-02-10 15:59:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 15:59:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 15:59:44 - root - INFO - To identify the top three customers with the highest number of delivered orders, we count the number of delivered orders per `customer_unique_id` from the `OLIST_ORDERS` and `OLIST_CUSTOMERS` tables. For each of these customers, we calculate the average payment value from the `OLIST_ORDER_PAYMENTS` table and retrieve their city and state from the `OLIST_CUSTOMERS` table.

```sql
WITH customer_orders AS (
  SELECT
    c."customer_unique_id",
    c."customer_city" AS "city",
    c."customer_state" AS "state",
    COUNT(*) AS "num_delivered_orders",
    AVG(p."payment_value") AS "average_payment_value"
  FROM BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDERS o
  INNER JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_CUSTOMERS c
    ON o."customer_id" = c."customer_id"
  INNER JOIN BRAZILIAN_E_COMMERCE.BRAZILIAN_E_COMMERCE.OLIST_ORDER_PAYMENTS p
    ON o."order_id" = p."order_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
)
SELECT
  "customer_unique_id",
  ROUND("average_payment_value", 4) AS "average_payment_value",
  "city",
  "state"
FROM customer_orders
ORDER BY "num_delivered_orders" DESC NULLS LAST, "customer_unique_id"
LIMIT 3;
```
2025-02-10 15:59:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 15:59:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 15:59:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 15:59:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 15:59:45 - snowflake.connector.connection - INFO - closed
2025-02-10 15:59:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 15:59:45 - root - INFO - itercount: 2
2025-02-10 15:59:45 - root - INFO - 0
2025-02-10 15:59:45 - root - INFO - Total iteration counts: 2
