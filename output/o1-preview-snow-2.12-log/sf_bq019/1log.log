2025-02-12 17:54:00 - openai._base_client - INFO - Retrying request to /chat/completions in 0.450368 seconds
2025-02-12 17:55:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:55:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:55:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:55:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:55:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:55:09 - snowflake.connector.connection - INFO - closed
2025-02-12 17:55:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:55:10 - root - INFO - SQL:
SELECT *
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   LIMIT 100;
Results:
Too long, hard cut:
provider_id,provider_name,provider_street_address,provider_city,provider_state,provider_zipcode,drg_definition,hospital_referral_region_description,total_discharges,average_covered_charges,average_total_payments,average_medicare_payments
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,MA - Springfield,22,11152.0,7331.0,5824.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,101 - SEIZURES W/O MCC,MA - Springfield,11,8049.0,6022.0,4931.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,176 - PULMONARY EMBOLISM W/O MCC,MA - Springfield,16,9892.0,7262.0,6354.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,MA - Springfield,11,10445.0,9891.0,9064.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,180 - RESPIRATORY NEOPLASMS W MCC,MA - Springfield,12,14492.0,13221.0,11387.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,189 - PULMONARY EDEMA & RESPIRATORY FAILURE,MA - Springfield,12,13412.0,9413.0,8608.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,MA - Springfield,47,10209.0,8688.0,7923.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,MA - Springfield,66,8821.0,7326.0,6516.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,MA - Springfield,36,6994.0,5883.0,4944.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,193 - SIMPLE PNEUMONIA & PLEURISY W MCC,MA - Springfield,43,13486.0,10981.0,10202.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,194 - SIMPLE PNEUMONIA & PLEURISY W CC,MA - Springfield,60,9220.0,7635.0,6730.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,MA - Springfield,25,6337.0,5893.0,4685.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,202 - BRONCHITIS & ASTHMA W CC/MCC,MA - Springfield,16,7656.0,7054.0,5922.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,MA - Springfield,11,23843.0,16402.0,15742.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",MA - Springfield,25,13730.0,10940.0,10164.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",MA - Springfield,17,9174.0,7749.0,6894.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC",MA - Springfield,19,6426.0,6095.0,5332.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,291 - HEART FAILURE & SHOCK W MCC,MA - Springfield,67,11574.0,10615.0,9948.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,292 - HEART FAILURE & SHOCK W CC,MA - Springfield,49,8541.0,7867.0,6506.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,293 - HEART FAILURE & SHOCK W/O CC/MCC,MA - Springfield,36,7453.0,5480.0,4608.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,303 - ATHEROSCLEROSIS W/O MCC,MA - Springfield,17,9027.0,5133.0,4493.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,MA - Springfield,20,10255.0,9516.0,8556.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,MA - Springfield,22,8888.0,6394.0,5622.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,MA - Springfield,17,6387.0,4761.0,3841.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,312 - SYNCOPE & COLLAPSE,MA - Springfield,24,10573.0,5967.0,4963.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,313 - CHEST PAIN,MA - Springfield,13,7624.0,5101.0,4542.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,MA - Springfield,18,46069.0,34739.0,33663.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,378 - G.I. HEMORRHAGE W CC,MA - Springfield,23,11824.0,8027.0,7080.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,379 - G.I. HEMORRHAGE W/O CC/MCC,MA - Springfield,12,6852.0,5724.0,4436.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,389 - G.I. OBSTRUCTION W CC,MA - Springfield,13,12356.0,7362.0,5980.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",MA - Springfield,11,9990.0,9384.0,8285.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS 

2025-02-12 17:55:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:55:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:55:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:55:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:55:11 - snowflake.connector.connection - INFO - closed
2025-02-12 17:55:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:55:11 - root - INFO - SQL:
SELECT DISTINCT "drg_definition"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   LIMIT 100;
Results:
drg_definition
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS
101 - SEIZURES W/O MCC
176 - PULMONARY EMBOLISM W/O MCC
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC
189 - PULMONARY EDEMA & RESPIRATORY FAILURE
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC
193 - SIMPLE PNEUMONIA & PLEURISY W MCC
194 - SIMPLE PNEUMONIA & PLEURISY W CC
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC"
291 - HEART FAILURE & SHOCK W MCC
293 - HEART FAILURE & SHOCK W/O CC/MCC
303 - ATHEROSCLEROSIS W/O MCC
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC
313 - CHEST PAIN
379 - G.I. HEMORRHAGE W/O CC/MCC
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC"
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC"
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC
602 - CELLULITIS W MCC
"641 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W/O MCC"
682 - RENAL FAILURE W MCC
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC
948 - SIGNS & SYMPTOMS W/O MCC
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS
491 - BACK & NECK PROC EXC SPINAL FUSION W/O CC/MCC
536 - FRACTURES OF HIP & PELVIS W/O MCC
638 - DIABETES W CC
064 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W MCC
055 - NERVOUS SYSTEM NEOPLASMS W/O MCC
057 - DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC
100 - SEIZURES W MCC
238 - MAJOR CARDIOVASC PROCEDURES W/O MCC
240 - AMPUTATION FOR CIRC SYS DISORDERS EXC UPPER LIMB & TOE W CC
881 - DEPRESSIVE NEUROSES
196 - INTERSTITIAL LUNG DISEASE W MCC
071 - NONSPECIFIC CEREBROVASCULAR DISORDERS W CC
"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC"
389 - G.I. OBSTRUCTION W CC
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC
684 - RENAL FAILURE W/O CC/MCC
690 - KIDNEY & URINARY TRACT INFECTIONS W/O MCC
165 - MAJOR CHEST PROCEDURES W/O CC/MCC
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC"
490 - BACK & NECK PROC EXC SPINAL FUSION W CC/MCC OR DISC DEVICE/NEUROSTIM
708 - MAJOR MALE PELVIC PROCEDURES W/O CC/MCC
027 - CRANIOTOMY & ENDOVASCULAR INTRACRANIAL PROCEDURES W/O CC/MCC
081 - NONTRAUMATIC STUPOR & COMA W/O MCC
166 - OTHER RESP SYSTEM O.R. PROCEDURES W MCC
234 - CORONARY BYPASS W CARDIAC CATH W/O MCC
248 - PERC CARDIOVASC PROC W NON-DRUG-ELUTING STENT W MCC OR 4+ VES/STENTS
264 - OTHER CIRCULATORY SYSTEM O.R. PROCEDURES
652 - KIDNEY TRANSPLANT
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC
229 - OTHER CARDIOTHORACIC PROCEDURES W CC
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC
862 - POSTOPERATIVE & POST-TRAUMATIC INFECTIONS W MCC
884 - ORGANIC DISTURBANCES & MENTAL RETARDATION
947 - SIGNS & SYMPTOMS W MCC
180 - RESPIRATORY NEOPLASMS W MCC
292 - HEART FAILURE & SHOCK W CC
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC
445 - DISORDERS OF THE BILIARY TRACT W CC
603 - CELLULITIS W/O MCC
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC
482 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W/O CC/MCC
149 - DYSEQUILIBRIUM
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R."
"086 - TRAUMATIC STUPOR & COMA, COMA <1 HR W CC"
233 - CORONARY BYPASS W CARDIAC CATH W MCC
246 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W MCC OR 4+ VESSELS/STENTS
247 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W/O MCC
440 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W/O CC/MCC
469 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W MCC
484 - MAJOR JOINT & LIMB REATTACHMENT PROC OF UPPER EXTREMITY W/O CC/MCC
728 - INFLAMMATION OF THE MALE REPRODUCTIVE SYSTEM W/O MCC
765 - CESAREAN SECTION W CC/MCC
202 - BRONCHITIS & ASTHMA W CC/MCC
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC
378 - G.I. HEMORRHAGE W CC
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC"
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC
918 - POISONING & TOXIC EFFECTS OF DRUGS W/O MCC
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC
812 - RED BLOOD CELL DISORDERS W/O MCC
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS
181 - RESPIRATORY NEOPLASMS W CC
331 - MAJOR SMALL & LARGE BOWEL PROCEDURES W/O CC/MCC
418 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W CC
419 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W/O CC/MCC
"442 - DISORDERS OF LIVER EXCEPT MALIG,CIRR,ALC HEPA W CC"

2025-02-12 17:55:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:55:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:55:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:55:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:55:13 - snowflake.connector.connection - INFO - closed
2025-02-12 17:55:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:55:13 - root - INFO - SQL:
SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "total_discharges_per_drg" DESC
   LIMIT 100;
Results:
Too long, hard cut:
drg_definition,total_discharges_per_drg
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,458259
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC,438597
291 - HEART FAILURE & SHOCK W MCC,198889
292 - HEART FAILURE & SHOCK W CC,192918
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC",190375
690 - KIDNEY & URINARY TRACT INFECTIONS W/O MCC,159823
194 - SIMPLE PNEUMONIA & PLEURISY W CC,148808
683 - RENAL FAILURE W CC,144145
378 - G.I. HEMORRHAGE W CC,138485
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC,134816
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,134793
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,132669
603 - CELLULITIS W/O MCC,126750
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,114155
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,112227
682 - RENAL FAILURE W MCC,109178
"641 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W/O MCC",108336
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,100654
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,90055
885 - PSYCHOSES,87942
247 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W/O MCC,84407
312 - SYNCOPE & COLLAPSE,84213
"287 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W/O MCC",81314
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,78138
310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,75896
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC,74041
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC,70107
812 - RED BLOOD CELL DISORDERS W/O MCC,69596
064 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W MCC,68825
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,65003
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,64992
313 - CHEST PAIN,64624
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC,63390
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,61816
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",60156
293 - HEART FAILURE & SHOCK W/O CC/MCC,58718
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC",58450
069 - TRANSIENT ISCHEMIA,56614
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,54698
377 - G.I. HEMORRHAGE W MCC,53042
552 - MEDICAL BACK PROBLEMS W/O MCC,50615
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,48798
066 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W/O CC/MCC,46735
389 - G.I. OBSTRUCTION W CC,46273
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC,46046
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC,41831
638 - DIABETES W CC,41679
101 - SEIZURES W/O MCC,39289
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",39184
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,37763
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",36576
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,36417
948 - SIGNS & SYMPTOMS W/O MCC,33548
253 - OTHER VASCULAR PROCEDURES W CC,32741
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,31619
698 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W MCC,31311
238 - MAJOR CARDIOVASC PROCEDURES W/O MCC,31151
897 - ALCOHOL/DRUG ABUSE OR DEPENDENCE W/O REHABILITATION THERAPY W/O MCC,30983
300 - PERIPHERAL VASCULAR DISORDERS W CC,29550
246 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W MCC OR 4+ VESSELS/STENTS,29222
176 - PULMONARY EMBOLISM W/O MCC,28799
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,28260
252 - OTHER VASCULAR PROCEDURES W MCC,27983
390 - G.I. OBSTRUCTION W/O CC/MCC,27743
039 - EXTRACRANIAL PROCEDURES W/O CC/MCC,26914
473 - CERVICAL SPINAL FUSION W/O CC/MCC,25228
372 - MAJOR GASTROINTESTINAL DISORDERS & PERITONEAL INFECTIONS W CC,24442
202 - BRONCHITIS & ASTHMA W CC/MCC,24174
"286 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W MCC",24034
811 - RED BLOOD CELL DISORDERS W MCC,23375
699 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W CC,22826
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,22723
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC,22479
484 - MAJOR JOINT & LIMB REATTACHMENT PROC OF UPPER EXTREMITY W/O CC/MCC,22204
917 - POISONING & TOXIC EFFECTS OF DRUGS W MCC,21365
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,21164
057 - DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC,20831
491 - BACK & NECK PROC EXC SPINAL FUSION W/O CC/MCC,20567
379 - G.I. HEMORRHAGE W/O CC/MCC,20148
480 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W MCC,19262
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,18853
602 - CELLULITIS W MCC,18665
469 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W MCC,18656
251 - PERC CARDIOVASC PROC W/O CORONARY ARTERY STENT W/O MCC,18485
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC,18312
918 - POISONING & TOXIC EFFECTS OF DRUGS W/O MCC,17846
236 - CORONARY BYPASS W/O CARDIAC CATH W/O MCC,17488
536 - FRACTURES OF HIP & PELVIS W/O MCC,17469
482 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W/O CC/MCC,17272
467 - REVISION OF HIP OR KNEE REPLACEMENT W CC,17135
"563 - FX, SPRN, STRN & DISL EXCEPT FEMUR, HIP, PELVIS & THIGH W/O MCC",16867
418 - LAPAROSCOPIC C

2025-02-12 17:55:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:55:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:55:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:55:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-12 17:55:14 - snowflake.connector.connection - INFO - closed
2025-02-12 17:55:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:55:15 - root - INFO - SQL:
SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "total_discharges_per_drg" DESC
   LIMIT 1;
Results:
drg_definition,total_discharges_per_drg
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,458259

2025-02-12 17:55:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:55:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:55:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:55:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 17:55:16 - snowflake.connector.connection - INFO - closed
2025-02-12 17:55:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:55:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:55:49 - root - INFO - ```sql
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE "drg_definition" = '470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
```
2025-02-12 17:55:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:55:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:55:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:55:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 17:55:51 - snowflake.connector.connection - INFO - closed
2025-02-12 17:55:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:56:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:56:46 - root - INFO - SQL:
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE "drg_definition" = '470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
Results:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852

2025-02-12 17:56:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:56:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:56:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:56:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 17:56:47 - snowflake.connector.connection - INFO - closed
2025-02-12 17:56:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:57:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:57:24 - root - INFO - ```sql
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE REGEXP_SUBSTR("drg_definition", '^\d+') = '470'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
```
2025-02-12 17:57:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:57:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:57:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:57:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 17:57:25 - snowflake.connector.connection - INFO - closed
2025-02-12 17:57:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:58:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:58:01 - root - INFO - ```sql
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE "drg_definition" LIKE '%470%'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
```
2025-02-12 17:58:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:58:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:58:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:58:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 17:58:02 - snowflake.connector.connection - INFO - closed
2025-02-12 17:58:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:58:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:58:48 - root - INFO - SQL:
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE "drg_definition" LIKE '%470%'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
Results:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852

2025-02-12 17:58:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:58:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:58:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:58:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 17:58:49 - snowflake.connector.connection - INFO - closed
2025-02-12 17:58:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:59:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:59:56 - root - INFO - ```sql
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE REGEXP_SUBSTR("drg_definition", '^\s*"*(\d+)\s*-') = '470 -'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
```
2025-02-12 17:59:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:59:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:59:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:59:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 17:59:57 - snowflake.connector.connection - INFO - closed
2025-02-12 17:59:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:00:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:00:15 - root - INFO - ```sql
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE SPLIT_PART("drg_definition", ' - ', 1) = '470'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
```
2025-02-12 18:00:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:00:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:00:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:00:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 18:00:16 - snowflake.connector.connection - INFO - closed
2025-02-12 18:00:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:01:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:01:04 - root - INFO - SQL:
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE SPLIT_PART("drg_definition", ' - ', 1) = '470'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
Results:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852

2025-02-12 18:01:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:01:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:01:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:01:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 18:01:05 - snowflake.connector.connection - INFO - closed
2025-02-12 18:01:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:01:06 - root - INFO - SQL:
SELECT "drg_definition", AVG("average_total_payments") AS "avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "avg_total_payments" DESC
   LIMIT 100;
Results:
Too long, hard cut:
drg_definition,avg_total_payments
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC,244554.5588235294
002 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W/O MCC,155086.5
215 - OTHER HEART ASSIST SYSTEM IMPLANT,136869.0
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",134199.6497797357
005 - LIVER TRANSPLANT W MCC OR INTESTINAL TRANSPLANT,125107.5
014 - ALLOGENEIC BONE MARROW TRANSPLANT,119135.62962962964
927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT,115031.0
007 - LUNG TRANSPLANT,104386.21052631579
453 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W MCC,98293.44444444444
020 - INTRACRANIAL VASCULAR PROCEDURES W PDX HEMORRHAGE W MCC,92115.68421052632
456 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W MCC,92086.17647058824
826 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W MAJ O.R. PROC W MCC,82978.0
"004 - TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W/O MAJ O.R.",79539.63130434783
820 - LYMPHOMA & LEUKEMIA W MAJOR O.R. PROCEDURE W MCC,75147.0
951 - OTHER FACTORS INFLUENCING HEALTH STATUS,74733.0
222 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W MCC,72575.33333333333
216 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W MCC,72156.15646258503
224 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W MCC,71252.5
834 - ACUTE LEUKEMIA W/O MAJOR O.R. PROCEDURE W MCC,68996.359375
837 - CHEMO W ACUTE LEUKEMIA AS SDX OR W HIGH DOSE CHEMO AGENT W MCC,68039.84210526316
500 - SOFT TISSUE PROCEDURES W MCC,67321.0
957 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W MCC,66910.6129032258
423 - OTHER HEPATOBILIARY OR PANCREAS O.R. PROCEDURES W MCC,63876.0
454 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W CC,63862.262295081964
008 - SIMULTANEOUS PANCREAS/KIDNEY TRANSPLANT,63612.0
016 - AUTOLOGOUS BONE MARROW TRANSPLANT W CC/MCC,60541.69491525424
223 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W/O MCC,59812.25
228 - OTHER CARDIOTHORACIC PROCEDURES W MCC,58482.375
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,58401.27557411273
823 - LYMPHOMA & NON-ACUTE LEUKEMIA W OTHER O.R. PROC W MCC,58391.4
457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC,56080.556818181816
006 - LIVER TRANSPLANT W/O MCC,55617.75
969 - HIV W EXTENSIVE O.R. PROCEDURE W MCC,54603.0
028 - SPINAL PROCEDURES W MCC,54099.5
928 - FULL THICKNESS BURN W SKIN GRAFT OR INHAL INJ W CC/MCC,53686.36842105263
226 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W MCC,53493.02597402597
"011 - TRACHEOSTOMY FOR FACE,MOUTH & NECK DIAGNOSES W MCC",52272.8064516129
653 - MAJOR BLADDER PROCEDURES W MCC,51973.78571428572
"405 - PANCREAS, LIVER & SHUNT PROCEDURES W MCC",51653.11607142857
233 - CORONARY BYPASS W CARDIAC CATH W MCC,50909.48409090909
459 - SPINAL FUSION EXCEPT CERVICAL W MCC,49542.98648648649
217 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W CC,47003.651162790695
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC",45339.234042553195
455 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W/O CC/MCC,45095.50892857143
218 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W/O CC/MCC,44782.666666666664
"463 - WND DEBRID & SKN GRFT EXC HAND, FOR MUSCULO-CONN TISS DIS W MCC",44524.854545454546
023 - CRANIO W MAJOR DEV IMPL/ACUTE COMPLEX CNS PDX W MCC OR CHEMO IMPLANT,44412.127071823204
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,43888.93134598013
225 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W/O MCC,43402.8
235 - CORONARY BYPASS W/O CARDIAC CATH W MCC,43214.4173553719
958 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W CC,41913.2
471 - CERVICAL SPINAL FUSION W MCC,41469.22222222222
227 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W/O MCC,40687.22619047619
856 - POSTOPERATIVE OR POST-TRAUMATIC INFECTIONS W O.R. PROC W MCC,40488.37037037037
829 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W OTHER O.R. PROC W CC/MCC,40311.5
237 - MAJOR CARDIOVASC PROCEDURES W MCC,39915.12634822804
458 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W/O CC/MCC,39789.142857142855
245 - AICD GENERATOR PROCEDURES,38909.25
332 - RECTAL RESECTION W MCC,38715.0
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,38595.19937694704
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38472.1189516129
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,38450.055555555555
466 - REVISION OF HIP OR KNEE REPLACEMENT W MCC,38067.64705882353
163 - MAJOR CHEST PROCEDURES W MCC,37511.87009063444
034 - CAROTID ARTERY STENT PROCEDURE W MCC,37494.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,36969.536098310295
652 - KIDNEY TRANSPLANT,36219.832402234635
981 - EXTENSIVE O.R. PROCEDURE UNRELATED TO PRINCIPAL DIAGNOSIS W MCC,36126.76478318003
347 - ANAL & STOMAL PROCEDURES W MCC,35826.0
229 - OTHER CARDIOTHORACIC PROCEDURES W CC,35479.46153846154
260 - CARDIAC PACEMAKER REVISION EXCEPT DEVICE REPLACEMENT W MCC,34872.818181818184
221 - CARDIAC VALVE & OTH M

2025-02-12 18:01:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:01:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:01:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:01:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 18:01:11 - snowflake.connector.connection - INFO - closed
2025-02-12 18:01:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:01:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:01:37 - root - INFO - ```sql
SELECT "drg_definition", AVG(TRY_TO_NUMBER("average_total_payments")) AS "avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
GROUP BY "drg_definition"
LIMIT 100;
```
2025-02-12 18:01:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:01:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:01:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:01:38 - snowflake.connector.connection - INFO - closed
2025-02-12 18:01:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:02:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:02:07 - root - INFO - ```sql
SELECT "drg_definition", AVG("average_total_payments") AS "avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
GROUP BY "drg_definition"
ORDER BY "avg_total_payments" DESC
LIMIT 100;
```
2025-02-12 18:02:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:02:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:02:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:02:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 18:02:10 - snowflake.connector.connection - INFO - closed
2025-02-12 18:02:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:02:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:02:59 - root - INFO - SQL:
SELECT "drg_definition", AVG("average_total_payments") AS "avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
GROUP BY "drg_definition"
ORDER BY "avg_total_payments" DESC
LIMIT 100;
Results:
Too long, hard cut:
drg_definition,avg_total_payments
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC,244554.5588235294
002 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W/O MCC,155086.5
215 - OTHER HEART ASSIST SYSTEM IMPLANT,136869.0
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",134199.6497797357
005 - LIVER TRANSPLANT W MCC OR INTESTINAL TRANSPLANT,125107.5
014 - ALLOGENEIC BONE MARROW TRANSPLANT,119135.62962962964
927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT,115031.0
007 - LUNG TRANSPLANT,104386.21052631579
453 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W MCC,98293.44444444444
020 - INTRACRANIAL VASCULAR PROCEDURES W PDX HEMORRHAGE W MCC,92115.68421052632
456 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W MCC,92086.17647058824
826 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W MAJ O.R. PROC W MCC,82978.0
"004 - TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W/O MAJ O.R.",79539.63130434783
820 - LYMPHOMA & LEUKEMIA W MAJOR O.R. PROCEDURE W MCC,75147.0
951 - OTHER FACTORS INFLUENCING HEALTH STATUS,74733.0
222 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W MCC,72575.33333333333
216 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W MCC,72156.15646258503
224 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W MCC,71252.5
834 - ACUTE LEUKEMIA W/O MAJOR O.R. PROCEDURE W MCC,68996.359375
837 - CHEMO W ACUTE LEUKEMIA AS SDX OR W HIGH DOSE CHEMO AGENT W MCC,68039.84210526316
500 - SOFT TISSUE PROCEDURES W MCC,67321.0
957 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W MCC,66910.6129032258
423 - OTHER HEPATOBILIARY OR PANCREAS O.R. PROCEDURES W MCC,63876.0
454 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W CC,63862.262295081964
008 - SIMULTANEOUS PANCREAS/KIDNEY TRANSPLANT,63612.0
016 - AUTOLOGOUS BONE MARROW TRANSPLANT W CC/MCC,60541.69491525424
223 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W/O MCC,59812.25
228 - OTHER CARDIOTHORACIC PROCEDURES W MCC,58482.375
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,58401.27557411273
823 - LYMPHOMA & NON-ACUTE LEUKEMIA W OTHER O.R. PROC W MCC,58391.4
457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC,56080.556818181816
006 - LIVER TRANSPLANT W/O MCC,55617.75
969 - HIV W EXTENSIVE O.R. PROCEDURE W MCC,54603.0
028 - SPINAL PROCEDURES W MCC,54099.5
928 - FULL THICKNESS BURN W SKIN GRAFT OR INHAL INJ W CC/MCC,53686.36842105263
226 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W MCC,53493.02597402597
"011 - TRACHEOSTOMY FOR FACE,MOUTH & NECK DIAGNOSES W MCC",52272.8064516129
653 - MAJOR BLADDER PROCEDURES W MCC,51973.78571428572
"405 - PANCREAS, LIVER & SHUNT PROCEDURES W MCC",51653.11607142857
233 - CORONARY BYPASS W CARDIAC CATH W MCC,50909.48409090909
459 - SPINAL FUSION EXCEPT CERVICAL W MCC,49542.98648648649
217 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W CC,47003.651162790695
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC",45339.234042553195
455 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W/O CC/MCC,45095.50892857143
218 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W/O CC/MCC,44782.666666666664
"463 - WND DEBRID & SKN GRFT EXC HAND, FOR MUSCULO-CONN TISS DIS W MCC",44524.854545454546
023 - CRANIO W MAJOR DEV IMPL/ACUTE COMPLEX CNS PDX W MCC OR CHEMO IMPLANT,44412.127071823204
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,43888.93134598013
225 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W/O MCC,43402.8
235 - CORONARY BYPASS W/O CARDIAC CATH W MCC,43214.4173553719
958 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W CC,41913.2
471 - CERVICAL SPINAL FUSION W MCC,41469.22222222222
227 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W/O MCC,40687.22619047619
856 - POSTOPERATIVE OR POST-TRAUMATIC INFECTIONS W O.R. PROC W MCC,40488.37037037037
829 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W OTHER O.R. PROC W CC/MCC,40311.5
237 - MAJOR CARDIOVASC PROCEDURES W MCC,39915.12634822804
458 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W/O CC/MCC,39789.142857142855
245 - AICD GENERATOR PROCEDURES,38909.25
332 - RECTAL RESECTION W MCC,38715.0
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,38595.19937694704
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38472.1189516129
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,38450.055555555555
466 - REVISION OF HIP OR KNEE REPLACEMENT W MCC,38067.64705882353
163 - MAJOR CHEST PROCEDURES W MCC,37511.87009063444
034 - CAROTID ARTERY STENT PROCEDURE W MCC,37494.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,36969.536098310295
652 - KIDNEY TRANSPLANT,36219.832402234635
981 - EXTENSIVE O.R. PROCEDURE UNRELATED TO PRINCIPAL DIAGNOSIS W MCC,36126.76478318003
347 - ANAL & STOMAL PROCEDURES W MCC,35826.0
229 - OTHER CARDIOTHORACIC PROCEDURES W CC,35479.46153846154
260 - CARDIAC PACEMAKER REVISION EXCEPT DEVICE REPLACEMENT W MCC,34872.818181818184
221 - CARDIAC VALVE & OTH M

2025-02-12 18:02:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:02:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:02:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:03:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 18:03:00 - snowflake.connector.connection - INFO - closed
2025-02-12 18:03:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:04:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:04:00 - root - INFO - ```sql
SELECT "drg_definition", "average_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
LIMIT 100;
```
2025-02-12 18:04:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:04:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:04:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:04:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 18:04:01 - snowflake.connector.connection - INFO - closed
2025-02-12 18:04:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:04:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:04:36 - root - INFO - SQL:
SELECT "drg_definition", "average_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
LIMIT 100;
Results:
Too long, hard cut:
drg_definition,average_total_payments
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,7331.0
101 - SEIZURES W/O MCC,6022.0
176 - PULMONARY EMBOLISM W/O MCC,7262.0
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,9891.0
180 - RESPIRATORY NEOPLASMS W MCC,13221.0
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,9413.0
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,8688.0
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,7326.0
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,5883.0
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,10981.0
194 - SIMPLE PNEUMONIA & PLEURISY W CC,7635.0
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,5893.0
202 - BRONCHITIS & ASTHMA W CC/MCC,7054.0
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,16402.0
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",10940.0
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",7749.0
"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC",6095.0
291 - HEART FAILURE & SHOCK W MCC,10615.0
292 - HEART FAILURE & SHOCK W CC,7867.0
293 - HEART FAILURE & SHOCK W/O CC/MCC,5480.0
303 - ATHEROSCLEROSIS W/O MCC,5133.0
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,9516.0
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,6394.0
310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,4761.0
312 - SYNCOPE & COLLAPSE,5967.0
313 - CHEST PAIN,5101.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,34739.0
378 - G.I. HEMORRHAGE W CC,8027.0
379 - G.I. HEMORRHAGE W/O CC/MCC,5724.0
389 - G.I. OBSTRUCTION W CC,7362.0
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",9384.0
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC",6123.0
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,7536.0
445 - DISORDERS OF THE BILIARY TRACT W CC,8111.0
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,16334.0
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,14766.0
602 - CELLULITIS W MCC,11004.0
603 - CELLULITIS W/O MCC,6601.0
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC",8768.0
"641 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W/O MCC",5667.0
682 - RENAL FAILURE W MCC,11395.0
683 - RENAL FAILURE W CC,7453.0
684 - RENAL FAILURE W/O CC/MCC,5179.0
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC,8724.0
690 - KIDNEY & URINARY TRACT INFECTIONS W/O MCC,6123.0
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC,13769.0
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC,8133.0
897 - ALCOHOL/DRUG ABUSE OR DEPENDENCE W/O REHABILITATION THERAPY W/O MCC,5690.0
918 - POISONING & TOXIC EFFECTS OF DRUGS W/O MCC,5276.0
948 - SIGNS & SYMPTOMS W/O MCC,5819.0
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,7520.0
066 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W/O CC/MCC,5679.0
101 - SEIZURES W/O MCC,5677.0
176 - PULMONARY EMBOLISM W/O MCC,7262.0
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC,13102.0
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,9615.0
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,8713.0
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,8251.0
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,6857.0
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,5287.0
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,11649.0
194 - SIMPLE PNEUMONIA & PLEURISY W CC,9064.0
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,5281.0
202 - BRONCHITIS & ASTHMA W CC/MCC,6450.0
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,36561.0
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,16950.0
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC,18509.0
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",11442.0
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",7070.0
"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC",5508.0
291 - HEART FAILURE & SHOCK W MCC,10673.0
292 - HEART FAILURE & SHOCK W CC,7649.0
293 - HEART FAILURE & SHOCK W/O CC/MCC,5035.0
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,9713.0
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,5857.0
310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,4246.0
312 - SYNCOPE & COLLAPSE,5436.0
313 - CHEST PAIN,4579.0
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC,12762.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,38036.0
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC,19368.0
372 - MAJOR GASTROINTESTINAL DISORDERS & PERITONEAL INFECTIONS W CC,8269.0
378 - G.I. HEMORRHAGE W CC,7263.0
389 - G.I. OBSTRUCTION W CC,6338.0
390 - G.I. OBSTRUCTION W/O CC/MCC,4577.0
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",8695.0
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC",5560.0
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,7127.0
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC,6786.0
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC,35153.0
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,15623.0
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,1

2025-02-12 18:04:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:04:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:04:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:04:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 18:04:37 - snowflake.connector.connection - INFO - closed
2025-02-12 18:04:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:05:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:05:40 - root - INFO - Sure, here are the corrected SQL queries:

1. **Retrieve weighted average total payments for the top three cities:**

   ```sql
   SELECT "provider_city",
          SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "provider_city"
   ORDER BY "weighted_avg_total_payments" DESC
   LIMIT 100;
   ```

   *Note:* Removed the condition on `"drg_definition"` since it was causing no data to be returned. This query calculates the weighted average total payments for all cities.

2. **Find the total number of discharges nationwide:**

   ```sql
   SELECT SUM("total_discharges") AS "national_total_discharges"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014";
   ```

   *Note:* Removed `LIMIT 100` since it is unnecessary when calculating a single aggregate value.

3. **Compare average total payments and total discharges between all DRG definitions:**

   ```sql
   SELECT "drg_definition",
          AVG("average_total_payments") AS "avg_total_payments",
          SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   WHERE "average_total_payments" IS NOT NULL
   GROUP BY "drg_definition"
   ORDER BY "avg_total_payments" DESC
   LIMIT 100;
   ```

   *Note:* Added a condition to exclude null values in `"average_total_payments"` to ensure accurate calculation.

4. **Examine the distribution of total discharges across states:**

   ```sql
   SELECT "provider_state", SUM("total_discharges") AS "total_discharges_per_state"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "provider_state"
   ORDER BY "total_discharges_per_state" DESC
   LIMIT 100;
   ```

   *Note:* Removed the condition on `"drg_definition"` to include all data, addressing the issue of no data being returned.

5. **Identify providers with the highest average total payments:**

   ```sql
   SELECT "provider_id", "provider_name", "average_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   WHERE "average_total_payments" IS NOT NULL
   ORDER BY "average_total_payments" DESC
   LIMIT 100;
   ```

   *Note:* Removed the condition on `"drg_definition"` and added a check for non-null `"average_total_payments"` to ensure data is returned.

These corrections simplify the conditions by removing filters that may have caused the queries to return no data. By broadening the scope of the queries, you should now receive results when executing them.
2025-02-12 18:05:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:05:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:05:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:05:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 18:05:42 - snowflake.connector.connection - INFO - closed
2025-02-12 18:05:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:06:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:06:32 - root - INFO - SQL:
SELECT "provider_city",
          SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "provider_city"
   ORDER BY "weighted_avg_total_payments" DESC
   LIMIT 100;
Results:
provider_city,weighted_avg_total_payments
VAIL,39829.87719298246
VALHALLA,35942.17015895954
STANFORD,34460.472471190784
SYLMAR,29640.666666666668
LOS BANOS,28339.96913580247
SAN FRANCISCO,27972.584363561018
STEAMBOAT SPRIN,27632.70731707317
COSTA MESA,26402.29775280899
LOMA LINDA,25949.72606296657
FISHERS,25686.0
ROYERSFORD,23467.967567567568
FRENCH CAMP,23448.934210526317
NEW YORK,23447.968839098732
SACRAMENTO,22788.269757702663
LOS ANGELES,22661.930675866235
CHAPEL HILL,22627.406612784718
TROPHY CLUB,22424.2
LAKEWAY,22359.821428571428
BRONX,22254.965069551778
SAINT HELENA,22248.24238943136
LENEXA,22228.0
FLAGSTAFF,22078.76782273603
FAR ROCKAWAY,21945.474764281753
ANCHORAGE,21734.217236317887
MAYWOOD,21592.556864010323
KING CITY,21562.275862068964
BOSTON,21546.86358754028
MORENO VALLEY,21503.65226130653
SEATTLE,21071.57804632427
GALVESTON,20844.27606928243
STONY BROOK,20787.389069689147
HERSHEY,20743.74328187536
NEW HAVEN,20663.571870737593
FAIRBANKS,20460.931350114417
ORANGE,20157.53606166269
ROSLYN,20141.728339854668
BALTIMORE,20129.263951508547
CHARLOTTESVILLE,19932.883191575536
PHILADELPHIA,19821.489041125587
DURHAM,19681.989643191235
SANTA ANA,19668.84
BROOKLYN,19668.429922541534
MINEOLA,19516.185185185186
LANDER,19371.090909090908
REDWOOD CITY,19320.00308880309
BROWNS MILLS,19113.66434648105
COLTON,19105.23779724656
SEBASTOPOL,18971.78021978022
SAN JOSE,18898.54958043851
NEW HYDE PARK,18859.75676479334
ANN ARBOR,18857.17929914133
BRIGHTON,18827.840238647663
MARTINEZ,18799.58620689655
LYNWOOD,18676.69923076923
JAMAICA,18619.512021036815
SAN DIEGO,18593.096496266513
SANTA CLARA,18554.436842105264
SALINAS,18304.158297611757
MENLO PARK,18265.0
ROCHESTER,18261.930331618067
HONOLULU,18217.862269503545
BERKELEY,18209.78090766823
MINNEAPOLIS,18169.339208651796
LA JOLLA,18114.59443990188
ADDISON,18096.77449168207
MONTEREY,18092.60730593607
FLUSHING,17928.822360399903
VAN NUYS,17863.538612887358
IOWA CITY,17811.727291388688
CLEVELAND,17791.218920329353
BRIGHAM CITY,17623.0
SALT LAKE CITY,17575.512240307
OAK LAWN,17543.91871492162
MANHASSET,17396.34272197962
HACKENSACK,17360.835429095914
NEW ORLEANS,17296.940790138426
GLENWOOD SPRING,17146.300632911392
NEW BRUNSWICK,17087.036659011654
DENVER,17046.005257105306
PHOENIX,17008.658613401847
STOCKTON,16995.303197120473
FALLS CHURCH,16927.151626939085
OAKLAND,16925.718997361477
PORTLAND,16889.57057411401
SOUTH EL MONTE,16857.854545454546
IRVINE,16772.890574214518
WALNUT CREEK,16768.87914798206
CAMDEN,16712.4377030468
HARTFORD,16670.152267396403
PARAMUS,16617.716374269006
SOUTH LAKE TAHO,16602.18631178707
MADISON,16590.075445960127
LEBANON,16586.631494804158
TREMONTON,16578.0
DALY CITY,16491.718885448918
ATLANTA,16490.705916623512
KAMUELA,16411.19178082192
RIVERSIDE,16409.986902740722
WASHINGTON,16363.145358677255
LOS ALAMOS,16348.709090909091

2025-02-12 18:06:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:06:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:06:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:06:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-12 18:06:33 - snowflake.connector.connection - INFO - closed
2025-02-12 18:06:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:06:34 - root - INFO - SQL:
SELECT SUM("total_discharges") AS "national_total_discharges"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    LIMIT 100;
Results:
national_total_discharges
7297885

2025-02-12 18:06:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:06:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:06:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:06:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 18:06:35 - snowflake.connector.connection - INFO - closed
2025-02-12 18:06:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:06:35 - root - INFO - SQL:
SELECT "drg_definition",
           AVG("average_total_payments") AS "avg_total_payments",
           SUM("total_discharges") AS "total_discharges_per_drg"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    GROUP BY "drg_definition"
    ORDER BY "avg_total_payments" DESC
    LIMIT 100;
Results:
Too long, hard cut:
drg_definition,avg_total_payments,total_discharges_per_drg
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC,244554.5588235294,1495
002 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W/O MCC,155086.5,23
215 - OTHER HEART ASSIST SYSTEM IMPLANT,136869.0,23
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",134199.6497797357,11987
005 - LIVER TRANSPLANT W MCC OR INTESTINAL TRANSPLANT,125107.5,741
014 - ALLOGENEIC BONE MARROW TRANSPLANT,119135.62962962964,467
927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT,115031.0,27
007 - LUNG TRANSPLANT,104386.21052631579,328
453 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W MCC,98293.44444444444,297
020 - INTRACRANIAL VASCULAR PROCEDURES W PDX HEMORRHAGE W MCC,92115.68421052632,264
456 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W MCC,92086.17647058824,231
826 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W MAJ O.R. PROC W MCC,82978.0,13
"004 - TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W/O MAJ O.R.",79539.63130434783,11774
820 - LYMPHOMA & LEUKEMIA W MAJOR O.R. PROCEDURE W MCC,75147.0,12
951 - OTHER FACTORS INFLUENCING HEALTH STATUS,74733.0,73
222 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W MCC,72575.33333333333,86
216 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W MCC,72156.15646258503,7449
224 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W MCC,71252.5,73
834 - ACUTE LEUKEMIA W/O MAJOR O.R. PROCEDURE W MCC,68996.359375,1356
837 - CHEMO W ACUTE LEUKEMIA AS SDX OR W HIGH DOSE CHEMO AGENT W MCC,68039.84210526316,776
500 - SOFT TISSUE PROCEDURES W MCC,67321.0,12
957 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W MCC,66910.6129032258,492
423 - OTHER HEPATOBILIARY OR PANCREAS O.R. PROCEDURES W MCC,63876.0,16
454 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W CC,63862.262295081964,2690
008 - SIMULTANEOUS PANCREAS/KIDNEY TRANSPLANT,63612.0,54
016 - AUTOLOGOUS BONE MARROW TRANSPLANT W CC/MCC,60541.69491525424,1305
223 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W/O MCC,59812.25,73
228 - OTHER CARDIOTHORACIC PROCEDURES W MCC,58482.375,127
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,58401.27557411273,18853
823 - LYMPHOMA & NON-ACUTE LEUKEMIA W OTHER O.R. PROC W MCC,58391.4,69
457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC,56080.556818181816,1890
006 - LIVER TRANSPLANT W/O MCC,55617.75,61
969 - HIV W EXTENSIVE O.R. PROCEDURE W MCC,54603.0,11
028 - SPINAL PROCEDURES W MCC,54099.5,209
928 - FULL THICKNESS BURN W SKIN GRAFT OR INHAL INJ W CC/MCC,53686.36842105263,756
226 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W MCC,53493.02597402597,1175
"011 - TRACHEOSTOMY FOR FACE,MOUTH & NECK DIAGNOSES W MCC",52272.8064516129,491
653 - MAJOR BLADDER PROCEDURES W MCC,51973.78571428572,206
"405 - PANCREAS, LIVER & SHUNT PROCEDURES W MCC",51653.11607142857,2321
233 - CORONARY BYPASS W CARDIAC CATH W MCC,50909.48409090909,8615
459 - SPINAL FUSION EXCEPT CERVICAL W MCC,49542.98648648649,1111
217 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W CC,47003.651162790695,3164
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC",45339.234042553195,4107
455 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W/O CC/MCC,45095.50892857143,2368
218 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W/O CC/MCC,44782.666666666664,126
"463 - WND DEBRID & SKN GRFT EXC HAND, FOR MUSCULO-CONN TISS DIS W MCC",44524.854545454546,777
023 - CRANIO W MAJOR DEV IMPL/ACUTE COMPLEX CNS PDX W MCC OR CHEMO IMPLANT,44412.127071823204,3418
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,43888.93134598013,28260
225 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W/O MCC,43402.8,163
235 - CORONARY BYPASS W/O CARDIAC CATH W MCC,43214.4173553719,5467
958 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W CC,41913.2,148
471 - CERVICAL SPINAL FUSION W MCC,41469.22222222222,512
227 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W/O MCC,40687.22619047619,5096
856 - POSTOPERATIVE OR POST-TRAUMATIC INFECTIONS W O.R. PROC W MCC,40488.37037037037,1701
829 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W OTHER O.R. PROC W CC/MCC,40311.5,60
237 - MAJOR CARDIOVASC PROCEDURES W MCC,39915.12634822804,14469
458 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W/O CC/MCC,39789.142857142855,306
245 - AICD GENERATOR PROCEDURES,38909.25,106
332 - RECTAL RESECTION W MCC,38715.0,12
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,38595.19937694704,54698
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38472.1189516129,21164
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,38450.055555555555,22723
466 - REVISION OF HIP OR KNEE REPLACEMENT W MCC,38067.64705882353,522
163 - MAJOR CHEST PROCEDURES W MCC,37511.87009063444,6021
034 - CAROTID ARTERY STENT PROCEDURE W MCC,37494.0,13
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,36969.536098310295,31619
652 - KIDNEY TRANSPLANT,36219.83240223463

2025-02-12 18:06:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:06:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:06:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:06:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 18:06:36 - snowflake.connector.connection - INFO - closed
2025-02-12 18:06:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:07:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:07:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:07:19 - root - INFO - ```sql
WITH TopDRG AS (
  SELECT "drg_definition"
  FROM (
    SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    GROUP BY "drg_definition"
    ORDER BY "total_discharges_per_drg" DESC
    LIMIT 1
  )
),
TopCities AS (
  SELECT "provider_city", SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" t
  JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
  GROUP BY "provider_city"
  ORDER BY "total_discharges_city" DESC
  LIMIT 3
)
SELECT t."provider_city",
       SUM(t."total_discharges" * t."average_total_payments") / SUM(t."total_discharges") AS "weighted_avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" t
JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
JOIN TopCities ON t."provider_city" = TopCities."provider_city"
GROUP BY t."provider_city";
```
2025-02-12 18:07:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:07:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:07:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:07:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 18:07:21 - snowflake.connector.connection - INFO - closed
2025-02-12 18:07:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:07:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:07:49 - root - INFO - SQL:
WITH TopDRG AS (
  SELECT "drg_definition"
  FROM (
    SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    GROUP BY "drg_definition"
    ORDER BY "total_discharges_per_drg" DESC
    LIMIT 1
  )
),
TopCities AS (
  SELECT "provider_city", SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" t
  JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
  GROUP BY "provider_city"
  ORDER BY "total_discharges_city" DESC
  LIMIT 3
)
SELECT t."provider_city",
       SUM(t."total_discharges" * t."average_total_payments") / SUM(t."total_discharges") AS "weighted_avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" t
JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
JOIN TopCities ON t."provider_city" = TopCities."provider_city"
GROUP BY t."provider_city";
Results:
provider_city,weighted_avg_total_payments
SPRINGFIELD,15290.641242937852
BOSTON,18323.85317159464
NEW YORK,21656.258430507405

2025-02-12 18:07:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:07:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:07:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:07:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 18:07:50 - snowflake.connector.connection - INFO - closed
2025-02-12 18:07:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:08:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:08:33 - root - INFO - ```sql
SELECT "provider_city",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
WHERE LEFT("drg_definition", 3) = '470'
GROUP BY "provider_city"
ORDER BY SUM("total_discharges") DESC
LIMIT 3;
```
2025-02-12 18:08:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:08:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:08:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:08:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 18:08:34 - snowflake.connector.connection - INFO - closed
2025-02-12 18:08:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:08:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:09:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:09:32 - root - INFO - SQL:
SELECT "provider_city",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
WHERE LEFT("drg_definition", 3) = '470'
GROUP BY "provider_city"
ORDER BY SUM("total_discharges") DESC
LIMIT 3;
Results:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852

2025-02-12 18:09:32 - root - INFO - itercount: 0
2025-02-12 18:09:32 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD10_DIAGNOSES_2019', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CONDITION_OCCURRENCE', 'DRUG_ERA', 'LOCATION', 'PERSON', 'CONDITION_ERA', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'OBSERVATION', 'COST', 'PROVIDER', 'CARE_SITE', 'CONCEPT_ANCESTOR', 'CONCEPT_RELATIONSHIP', 'DEATH', 'DRUG_STRENGTH', 'CONCEPT', 'CONCEPT_CLASS', 'DRUG_EXPOSURE', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'RELATIONSHIP', 'VOCABULARY', 'PROCEDURE_OCCURRENCE']}}
Begin Exploring Related Columns
To address the task, we'll focus on the `INPATIENT_CHARGES_2014` table from the `CMS_DATA`.`CMS_MEDICARE` database and schema.

**Relevant Columns and Their Potential Usage:**

- `"drg_definition"`: Identifies the Diagnosis-Related Group (DRG) codes and descriptions. Used to group and find the DRG with the highest total discharges.
- `"total_discharges"`: Represents the number of discharges per provider and DRG. Used to calculate total discharges per DRG and per city.
- `"provider_city"`: Indicates the city of the provider. Used to identify the top three cities with the most discharges for a specific DRG.
- `"average_total_payments"`: Shows the average total payments made for services. Used to calculate the weighted average total payments per city.
- `"provider_id"`: Unique identifier for each provider. May be used to aggregate data by provider.
- `"provider_name"`: Name of the provider. Useful for contextual information.

**Conditions That May Be Used:**

- Filtering data for the specific DRG with the highest total discharges.
- Grouping data by `"drg_definition"` and `"provider_city"`.
- Ordering results to identify top discharges and payments.
- Calculating sums and weighted averages for discharges and payments.

**SQL Queries to Understand the Data:**

1. **Retrieve a sample of the data to understand the structure:**
   ```sql
   SELECT *
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   LIMIT 100;
   ```

2. **List all unique DRG definitions:**
   ```sql
   SELECT DISTINCT "drg_definition"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   LIMIT 100;
   ```

3. **Calculate total discharges per DRG definition:**
   ```sql
   SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "total_discharges_per_drg" DESC
   LIMIT 100;
   ```

4. **Identify the DRG definition with the highest total discharges:**
   ```sql
   SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "total_discharges_per_drg" DESC
   LIMIT 1;
   ```

5. **Find total discharges per city for the top DRG definition (replace 'TOP_DRG_DEFINITION' with actual DRG):**
   ```sql
   SELECT "provider_city", SUM("total_discharges") AS "total_discharges_per_city"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
   GROUP BY "provider_city"
   ORDER BY "total_discharges_per_city" DESC
   LIMIT 100;
   ```

6. **Calculate weighted average total payments for each city for the top DRG:**
   ```sql
   SELECT "provider_city",
          SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "weighted_avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
   GROUP BY "provider_city"
   ORDER BY "weighted_avg_total_payments" DESC
   LIMIT 100;
   ```

7. **List providers and their total discharges for the top DRG definition:**
   ```sql
   SELECT "provider_id", "provider_name", SUM("total_discharges") AS "total_discharges_per_provider"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_discharges_per_provider" DESC
   LIMIT 100;
   ```

8. **Get average total payments per DRG across all providers:**
   ```sql
   SELECT "drg_definition", AVG("average_total_payments") AS "avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "avg_total_payments" DESC
   LIMIT 100;
   ```

9. **Determine the number of providers in each city for the top DRG:**
   ```sql
   SELECT "provider_city", COUNT(DISTINCT "provider_id") AS "number_of_providers"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
   GROUP BY "provider_city"
   ORDER BY "number_of_providers" DESC
   LIMIT 100;
   ```

10. **List the top three cities with the most discharges for the top DRG definition:**
    ```sql
    SELECT "provider_city", SUM("total_discharges") AS "total_discharges_per_city"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
    GROUP BY "provider_city"
    ORDER BY "total_discharges_per_city" DESC
    LIMIT 3;
    ```

11. **Retrieve weighted average total payments for the top three cities (replace 'CITY_NAME' with actual city names):**
    ```sql
    SELECT "provider_city",
           SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "weighted_avg_total_payments"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    WHERE "drg_definition" = 'TOP_DRG_DEFINITION' AND "provider_city" IN ('CITY_NAME_1', 'CITY_NAME_2', 'CITY_NAME_3')
    GROUP BY "provider_city"
    LIMIT 100;
    ```

12. **Find the total number of discharges nationwide for context:**
    ```sql
    SELECT SUM("total_discharges") AS "national_total_discharges"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    LIMIT 100;
    ```

13. **Compare average total payments between the top DRG and others:**
    ```sql
    SELECT "drg_definition",
           AVG("average_total_payments") AS "avg_total_payments",
           SUM("total_discharges") AS "total_discharges_per_drg"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    GROUP BY "drg_definition"
    ORDER BY "avg_total_payments" DESC
    LIMIT 100;
    ```

14. **Examine the distribution of total discharges across states for the top DRG:**
    ```sql
    SELECT "provider_state", SUM("total_discharges") AS "total_discharges_per_state"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
    GROUP BY "provider_state"
    ORDER BY "total_discharges_per_state" DESC
    LIMIT 100;
    ```

15. **Identify providers with the highest average total payments for the top DRG:**
    ```sql
    SELECT "provider_id", "provider_name", "average_total_payments"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    WHERE "drg_definition" = 'TOP_DRG_DEFINITION'
    ORDER BY "average_total_payments" DESC
    LIMIT 100;
    ```

These queries provide insights into the distribution of discharges and payments associated with different DRG definitions and cities. They help to identify the DRG with the highest total discharges and explore the associated data needed to calculate the weighted average total payments for the top cities.

**Note:** Replace `'TOP_DRG_DEFINITION'` with the actual DRG definition obtained from query 4, and `'CITY_NAME_1', 'CITY_NAME_2', 'CITY_NAME_3'` with the city names from query 10 when executing the queries.Query:
SELECT *
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   LIMIT 100;
Answer:
Too long, hard cut:
provider_id,provider_name,provider_street_address,provider_city,provider_state,provider_zipcode,drg_definition,hospital_referral_region_description,total_discharges,average_covered_charges,average_total_payments,average_medicare_payments
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,MA - Springfield,22,11152.0,7331.0,5824.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,101 - SEIZURES W/O MCC,MA - Springfield,11,8049.0,6022.0,4931.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,176 - PULMONARY EMBOLISM W/O MCC,MA - Springfield,16,9892.0,7262.0,6354.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,MA - Springfield,11,10445.0,9891.0,9064.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,180 - RESPIRATORY NEOPLASMS W MCC,MA - Springfield,12,14492.0,13221.0,11387.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,189 - PULMONARY EDEMA & RESPIRATORY FAILURE,MA - Springfield,12,13412.0,9413.0,8608.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,MA - Springfield,47,10209.0,8688.0,7923.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,MA - Springfield,66,8821.0,7326.0,6516.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,MA - Springfield,36,6994.0,5883.0,4944.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,193 - SIMPLE PNEUMONIA & PLEURISY W MCC,MA - Springfield,43,13486.0,10981.0,10202.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,194 - SIMPLE PNEUMONIA & PLEURISY W CC,MA - Springfield,60,9220.0,7635.0,6730.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,MA - Springfield,25,6337.0,5893.0,4685.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,202 - BRONCHITIS & ASTHMA W CC/MCC,MA - Springfield,16,7656.0,7054.0,5922.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,MA - Springfield,11,23843.0,16402.0,15742.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",MA - Springfield,25,13730.0,10940.0,10164.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",MA - Springfield,17,9174.0,7749.0,6894.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC",MA - Springfield,19,6426.0,6095.0,5332.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,291 - HEART FAILURE & SHOCK W MCC,MA - Springfield,67,11574.0,10615.0,9948.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,292 - HEART FAILURE & SHOCK W CC,MA - Springfield,49,8541.0,7867.0,6506.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,293 - HEART FAILURE & SHOCK W/O CC/MCC,MA - Springfield,36,7453.0,5480.0,4608.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,303 - ATHEROSCLEROSIS W/O MCC,MA - Springfield,17,9027.0,5133.0,4493.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,MA - Springfield,20,10255.0,9516.0,8556.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,MA - Springfield,22,8888.0,6394.0,5622.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,MA - Springfield,17,6387.0,4761.0,3841.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,312 - SYNCOPE & COLLAPSE,MA - Springfield,24,10573.0,5967.0,4963.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,313 - CHEST PAIN,MA - Springfield,13,7624.0,5101.0,4542.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,MA - Springfield,18,46069.0,34739.0,33663.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,378 - G.I. HEMORRHAGE W CC,MA - Springfield,23,11824.0,8027.0,7080.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,379 - G.I. HEMORRHAGE W/O CC/MCC,MA - Springfield,12,6852.0,5724.0,4436.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,389 - G.I. OBSTRUCTION W CC,MA - Springfield,13,12356.0,7362.0,5980.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",MA - Springfield,11,9990.0,9384.0,8285.0
220024,HOLYOKE MEDICAL CENTER,575 BEECH STREET,HOLYOKE,MA,01040,"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS 
Query:
SELECT DISTINCT "drg_definition"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   LIMIT 100;
Answer:
drg_definition
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS
101 - SEIZURES W/O MCC
176 - PULMONARY EMBOLISM W/O MCC
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC
189 - PULMONARY EDEMA & RESPIRATORY FAILURE
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC
193 - SIMPLE PNEUMONIA & PLEURISY W MCC
194 - SIMPLE PNEUMONIA & PLEURISY W CC
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC"
291 - HEART FAILURE & SHOCK W MCC
293 - HEART FAILURE & SHOCK W/O CC/MCC
303 - ATHEROSCLEROSIS W/O MCC
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC
313 - CHEST PAIN
379 - G.I. HEMORRHAGE W/O CC/MCC
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC"
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC"
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC
602 - CELLULITIS W MCC
"641 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W/O MCC"
682 - RENAL FAILURE W MCC
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC
948 - SIGNS & SYMPTOMS W/O MCC
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS
491 - BACK & NECK PROC EXC SPINAL FUSION W/O CC/MCC
536 - FRACTURES OF HIP & PELVIS W/O MCC
638 - DIABETES W CC
064 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W MCC
055 - NERVOUS SYSTEM NEOPLASMS W/O MCC
057 - DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC
100 - SEIZURES W MCC
238 - MAJOR CARDIOVASC PROCEDURES W/O MCC
240 - AMPUTATION FOR CIRC SYS DISORDERS EXC UPPER LIMB & TOE W CC
881 - DEPRESSIVE NEUROSES
196 - INTERSTITIAL LUNG DISEASE W MCC
071 - NONSPECIFIC CEREBROVASCULAR DISORDERS W CC
"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC"
389 - G.I. OBSTRUCTION W CC
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC
684 - RENAL FAILURE W/O CC/MCC
690 - KIDNEY & URINARY TRACT INFECTIONS W/O MCC
165 - MAJOR CHEST PROCEDURES W/O CC/MCC
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC"
490 - BACK & NECK PROC EXC SPINAL FUSION W CC/MCC OR DISC DEVICE/NEUROSTIM
708 - MAJOR MALE PELVIC PROCEDURES W/O CC/MCC
027 - CRANIOTOMY & ENDOVASCULAR INTRACRANIAL PROCEDURES W/O CC/MCC
081 - NONTRAUMATIC STUPOR & COMA W/O MCC
166 - OTHER RESP SYSTEM O.R. PROCEDURES W MCC
234 - CORONARY BYPASS W CARDIAC CATH W/O MCC
248 - PERC CARDIOVASC PROC W NON-DRUG-ELUTING STENT W MCC OR 4+ VES/STENTS
264 - OTHER CIRCULATORY SYSTEM O.R. PROCEDURES
652 - KIDNEY TRANSPLANT
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC
229 - OTHER CARDIOTHORACIC PROCEDURES W CC
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC
862 - POSTOPERATIVE & POST-TRAUMATIC INFECTIONS W MCC
884 - ORGANIC DISTURBANCES & MENTAL RETARDATION
947 - SIGNS & SYMPTOMS W MCC
180 - RESPIRATORY NEOPLASMS W MCC
292 - HEART FAILURE & SHOCK W CC
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC
445 - DISORDERS OF THE BILIARY TRACT W CC
603 - CELLULITIS W/O MCC
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC
482 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W/O CC/MCC
149 - DYSEQUILIBRIUM
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R."
"086 - TRAUMATIC STUPOR & COMA, COMA <1 HR W CC"
233 - CORONARY BYPASS W CARDIAC CATH W MCC
246 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W MCC OR 4+ VESSELS/STENTS
247 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W/O MCC
440 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W/O CC/MCC
469 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W MCC
484 - MAJOR JOINT & LIMB REATTACHMENT PROC OF UPPER EXTREMITY W/O CC/MCC
728 - INFLAMMATION OF THE MALE REPRODUCTIVE SYSTEM W/O MCC
765 - CESAREAN SECTION W CC/MCC
202 - BRONCHITIS & ASTHMA W CC/MCC
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC
378 - G.I. HEMORRHAGE W CC
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC"
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC
918 - POISONING & TOXIC EFFECTS OF DRUGS W/O MCC
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC
812 - RED BLOOD CELL DISORDERS W/O MCC
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS
181 - RESPIRATORY NEOPLASMS W CC
331 - MAJOR SMALL & LARGE BOWEL PROCEDURES W/O CC/MCC
418 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W CC
419 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W/O CC/MCC
"442 - DISORDERS OF LIVER EXCEPT MALIG,CIRR,ALC HEPA W CC"
Query:
SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "total_discharges_per_drg" DESC
   LIMIT 100;
Answer:
Too long, hard cut:
drg_definition,total_discharges_per_drg
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,458259
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC,438597
291 - HEART FAILURE & SHOCK W MCC,198889
292 - HEART FAILURE & SHOCK W CC,192918
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC",190375
690 - KIDNEY & URINARY TRACT INFECTIONS W/O MCC,159823
194 - SIMPLE PNEUMONIA & PLEURISY W CC,148808
683 - RENAL FAILURE W CC,144145
378 - G.I. HEMORRHAGE W CC,138485
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC,134816
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,134793
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,132669
603 - CELLULITIS W/O MCC,126750
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,114155
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,112227
682 - RENAL FAILURE W MCC,109178
"641 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W/O MCC",108336
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,100654
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,90055
885 - PSYCHOSES,87942
247 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W/O MCC,84407
312 - SYNCOPE & COLLAPSE,84213
"287 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W/O MCC",81314
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,78138
310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,75896
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC,74041
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC,70107
812 - RED BLOOD CELL DISORDERS W/O MCC,69596
064 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W MCC,68825
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,65003
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,64992
313 - CHEST PAIN,64624
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC,63390
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,61816
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",60156
293 - HEART FAILURE & SHOCK W/O CC/MCC,58718
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC",58450
069 - TRANSIENT ISCHEMIA,56614
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,54698
377 - G.I. HEMORRHAGE W MCC,53042
552 - MEDICAL BACK PROBLEMS W/O MCC,50615
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,48798
066 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W/O CC/MCC,46735
389 - G.I. OBSTRUCTION W CC,46273
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC,46046
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC,41831
638 - DIABETES W CC,41679
101 - SEIZURES W/O MCC,39289
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",39184
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,37763
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",36576
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,36417
948 - SIGNS & SYMPTOMS W/O MCC,33548
253 - OTHER VASCULAR PROCEDURES W CC,32741
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,31619
698 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W MCC,31311
238 - MAJOR CARDIOVASC PROCEDURES W/O MCC,31151
897 - ALCOHOL/DRUG ABUSE OR DEPENDENCE W/O REHABILITATION THERAPY W/O MCC,30983
300 - PERIPHERAL VASCULAR DISORDERS W CC,29550
246 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W MCC OR 4+ VESSELS/STENTS,29222
176 - PULMONARY EMBOLISM W/O MCC,28799
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,28260
252 - OTHER VASCULAR PROCEDURES W MCC,27983
390 - G.I. OBSTRUCTION W/O CC/MCC,27743
039 - EXTRACRANIAL PROCEDURES W/O CC/MCC,26914
473 - CERVICAL SPINAL FUSION W/O CC/MCC,25228
372 - MAJOR GASTROINTESTINAL DISORDERS & PERITONEAL INFECTIONS W CC,24442
202 - BRONCHITIS & ASTHMA W CC/MCC,24174
"286 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W MCC",24034
811 - RED BLOOD CELL DISORDERS W MCC,23375
699 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W CC,22826
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,22723
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC,22479
484 - MAJOR JOINT & LIMB REATTACHMENT PROC OF UPPER EXTREMITY W/O CC/MCC,22204
917 - POISONING & TOXIC EFFECTS OF DRUGS W MCC,21365
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,21164
057 - DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC,20831
491 - BACK & NECK PROC EXC SPINAL FUSION W/O CC/MCC,20567
379 - G.I. HEMORRHAGE W/O CC/MCC,20148
480 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W MCC,19262
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,18853
602 - CELLULITIS W MCC,18665
469 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W MCC,18656
251 - PERC CARDIOVASC PROC W/O CORONARY ARTERY STENT W/O MCC,18485
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC,18312
918 - POISONING & TOXIC EFFECTS OF DRUGS W/O MCC,17846
236 - CORONARY BYPASS W/O CARDIAC CATH W/O MCC,17488
536 - FRACTURES OF HIP & PELVIS W/O MCC,17469
482 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W/O CC/MCC,17272
467 - REVISION OF HIP OR KNEE REPLACEMENT W CC,17135
"563 - FX, SPRN, STRN & DISL EXCEPT FEMUR, HIP, PELVIS & THIGH W/O MCC",16867
418 - LAPAROSCOPIC C
Query:
SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "total_discharges_per_drg" DESC
   LIMIT 1;
Answer:
drg_definition,total_discharges_per_drg
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,458259
Query:
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE "drg_definition" = '470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
Answer:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852
Query:
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE "drg_definition" LIKE '%470%'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
Answer:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852
Query:
SELECT sub."provider_city", sub."weighted_avg_total_payments"
FROM (
  SELECT "provider_city",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments",
         SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
  WHERE SPLIT_PART("drg_definition", ' - ', 1) = '470'
  GROUP BY "provider_city"
) sub
ORDER BY sub."total_discharges_city" DESC
LIMIT 3;
Answer:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852
Query:
SELECT "drg_definition", AVG("average_total_payments") AS "avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "drg_definition"
   ORDER BY "avg_total_payments" DESC
   LIMIT 100;
Answer:
Too long, hard cut:
drg_definition,avg_total_payments
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC,244554.5588235294
002 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W/O MCC,155086.5
215 - OTHER HEART ASSIST SYSTEM IMPLANT,136869.0
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",134199.6497797357
005 - LIVER TRANSPLANT W MCC OR INTESTINAL TRANSPLANT,125107.5
014 - ALLOGENEIC BONE MARROW TRANSPLANT,119135.62962962964
927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT,115031.0
007 - LUNG TRANSPLANT,104386.21052631579
453 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W MCC,98293.44444444444
020 - INTRACRANIAL VASCULAR PROCEDURES W PDX HEMORRHAGE W MCC,92115.68421052632
456 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W MCC,92086.17647058824
826 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W MAJ O.R. PROC W MCC,82978.0
"004 - TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W/O MAJ O.R.",79539.63130434783
820 - LYMPHOMA & LEUKEMIA W MAJOR O.R. PROCEDURE W MCC,75147.0
951 - OTHER FACTORS INFLUENCING HEALTH STATUS,74733.0
222 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W MCC,72575.33333333333
216 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W MCC,72156.15646258503
224 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W MCC,71252.5
834 - ACUTE LEUKEMIA W/O MAJOR O.R. PROCEDURE W MCC,68996.359375
837 - CHEMO W ACUTE LEUKEMIA AS SDX OR W HIGH DOSE CHEMO AGENT W MCC,68039.84210526316
500 - SOFT TISSUE PROCEDURES W MCC,67321.0
957 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W MCC,66910.6129032258
423 - OTHER HEPATOBILIARY OR PANCREAS O.R. PROCEDURES W MCC,63876.0
454 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W CC,63862.262295081964
008 - SIMULTANEOUS PANCREAS/KIDNEY TRANSPLANT,63612.0
016 - AUTOLOGOUS BONE MARROW TRANSPLANT W CC/MCC,60541.69491525424
223 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W/O MCC,59812.25
228 - OTHER CARDIOTHORACIC PROCEDURES W MCC,58482.375
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,58401.27557411273
823 - LYMPHOMA & NON-ACUTE LEUKEMIA W OTHER O.R. PROC W MCC,58391.4
457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC,56080.556818181816
006 - LIVER TRANSPLANT W/O MCC,55617.75
969 - HIV W EXTENSIVE O.R. PROCEDURE W MCC,54603.0
028 - SPINAL PROCEDURES W MCC,54099.5
928 - FULL THICKNESS BURN W SKIN GRAFT OR INHAL INJ W CC/MCC,53686.36842105263
226 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W MCC,53493.02597402597
"011 - TRACHEOSTOMY FOR FACE,MOUTH & NECK DIAGNOSES W MCC",52272.8064516129
653 - MAJOR BLADDER PROCEDURES W MCC,51973.78571428572
"405 - PANCREAS, LIVER & SHUNT PROCEDURES W MCC",51653.11607142857
233 - CORONARY BYPASS W CARDIAC CATH W MCC,50909.48409090909
459 - SPINAL FUSION EXCEPT CERVICAL W MCC,49542.98648648649
217 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W CC,47003.651162790695
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC",45339.234042553195
455 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W/O CC/MCC,45095.50892857143
218 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W/O CC/MCC,44782.666666666664
"463 - WND DEBRID & SKN GRFT EXC HAND, FOR MUSCULO-CONN TISS DIS W MCC",44524.854545454546
023 - CRANIO W MAJOR DEV IMPL/ACUTE COMPLEX CNS PDX W MCC OR CHEMO IMPLANT,44412.127071823204
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,43888.93134598013
225 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W/O MCC,43402.8
235 - CORONARY BYPASS W/O CARDIAC CATH W MCC,43214.4173553719
958 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W CC,41913.2
471 - CERVICAL SPINAL FUSION W MCC,41469.22222222222
227 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W/O MCC,40687.22619047619
856 - POSTOPERATIVE OR POST-TRAUMATIC INFECTIONS W O.R. PROC W MCC,40488.37037037037
829 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W OTHER O.R. PROC W CC/MCC,40311.5
237 - MAJOR CARDIOVASC PROCEDURES W MCC,39915.12634822804
458 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W/O CC/MCC,39789.142857142855
245 - AICD GENERATOR PROCEDURES,38909.25
332 - RECTAL RESECTION W MCC,38715.0
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,38595.19937694704
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38472.1189516129
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,38450.055555555555
466 - REVISION OF HIP OR KNEE REPLACEMENT W MCC,38067.64705882353
163 - MAJOR CHEST PROCEDURES W MCC,37511.87009063444
034 - CAROTID ARTERY STENT PROCEDURE W MCC,37494.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,36969.536098310295
652 - KIDNEY TRANSPLANT,36219.832402234635
981 - EXTENSIVE O.R. PROCEDURE UNRELATED TO PRINCIPAL DIAGNOSIS W MCC,36126.76478318003
347 - ANAL & STOMAL PROCEDURES W MCC,35826.0
229 - OTHER CARDIOTHORACIC PROCEDURES W CC,35479.46153846154
260 - CARDIAC PACEMAKER REVISION EXCEPT DEVICE REPLACEMENT W MCC,34872.818181818184
221 - CARDIAC VALVE & OTH M
Query:
SELECT "drg_definition", AVG("average_total_payments") AS "avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
GROUP BY "drg_definition"
ORDER BY "avg_total_payments" DESC
LIMIT 100;
Answer:
Too long, hard cut:
drg_definition,avg_total_payments
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC,244554.5588235294
002 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W/O MCC,155086.5
215 - OTHER HEART ASSIST SYSTEM IMPLANT,136869.0
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",134199.6497797357
005 - LIVER TRANSPLANT W MCC OR INTESTINAL TRANSPLANT,125107.5
014 - ALLOGENEIC BONE MARROW TRANSPLANT,119135.62962962964
927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT,115031.0
007 - LUNG TRANSPLANT,104386.21052631579
453 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W MCC,98293.44444444444
020 - INTRACRANIAL VASCULAR PROCEDURES W PDX HEMORRHAGE W MCC,92115.68421052632
456 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W MCC,92086.17647058824
826 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W MAJ O.R. PROC W MCC,82978.0
"004 - TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W/O MAJ O.R.",79539.63130434783
820 - LYMPHOMA & LEUKEMIA W MAJOR O.R. PROCEDURE W MCC,75147.0
951 - OTHER FACTORS INFLUENCING HEALTH STATUS,74733.0
222 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W MCC,72575.33333333333
216 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W MCC,72156.15646258503
224 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W MCC,71252.5
834 - ACUTE LEUKEMIA W/O MAJOR O.R. PROCEDURE W MCC,68996.359375
837 - CHEMO W ACUTE LEUKEMIA AS SDX OR W HIGH DOSE CHEMO AGENT W MCC,68039.84210526316
500 - SOFT TISSUE PROCEDURES W MCC,67321.0
957 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W MCC,66910.6129032258
423 - OTHER HEPATOBILIARY OR PANCREAS O.R. PROCEDURES W MCC,63876.0
454 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W CC,63862.262295081964
008 - SIMULTANEOUS PANCREAS/KIDNEY TRANSPLANT,63612.0
016 - AUTOLOGOUS BONE MARROW TRANSPLANT W CC/MCC,60541.69491525424
223 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W/O MCC,59812.25
228 - OTHER CARDIOTHORACIC PROCEDURES W MCC,58482.375
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,58401.27557411273
823 - LYMPHOMA & NON-ACUTE LEUKEMIA W OTHER O.R. PROC W MCC,58391.4
457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC,56080.556818181816
006 - LIVER TRANSPLANT W/O MCC,55617.75
969 - HIV W EXTENSIVE O.R. PROCEDURE W MCC,54603.0
028 - SPINAL PROCEDURES W MCC,54099.5
928 - FULL THICKNESS BURN W SKIN GRAFT OR INHAL INJ W CC/MCC,53686.36842105263
226 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W MCC,53493.02597402597
"011 - TRACHEOSTOMY FOR FACE,MOUTH & NECK DIAGNOSES W MCC",52272.8064516129
653 - MAJOR BLADDER PROCEDURES W MCC,51973.78571428572
"405 - PANCREAS, LIVER & SHUNT PROCEDURES W MCC",51653.11607142857
233 - CORONARY BYPASS W CARDIAC CATH W MCC,50909.48409090909
459 - SPINAL FUSION EXCEPT CERVICAL W MCC,49542.98648648649
217 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W CC,47003.651162790695
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC",45339.234042553195
455 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W/O CC/MCC,45095.50892857143
218 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W/O CC/MCC,44782.666666666664
"463 - WND DEBRID & SKN GRFT EXC HAND, FOR MUSCULO-CONN TISS DIS W MCC",44524.854545454546
023 - CRANIO W MAJOR DEV IMPL/ACUTE COMPLEX CNS PDX W MCC OR CHEMO IMPLANT,44412.127071823204
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,43888.93134598013
225 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W/O MCC,43402.8
235 - CORONARY BYPASS W/O CARDIAC CATH W MCC,43214.4173553719
958 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W CC,41913.2
471 - CERVICAL SPINAL FUSION W MCC,41469.22222222222
227 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W/O MCC,40687.22619047619
856 - POSTOPERATIVE OR POST-TRAUMATIC INFECTIONS W O.R. PROC W MCC,40488.37037037037
829 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W OTHER O.R. PROC W CC/MCC,40311.5
237 - MAJOR CARDIOVASC PROCEDURES W MCC,39915.12634822804
458 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W/O CC/MCC,39789.142857142855
245 - AICD GENERATOR PROCEDURES,38909.25
332 - RECTAL RESECTION W MCC,38715.0
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,38595.19937694704
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38472.1189516129
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,38450.055555555555
466 - REVISION OF HIP OR KNEE REPLACEMENT W MCC,38067.64705882353
163 - MAJOR CHEST PROCEDURES W MCC,37511.87009063444
034 - CAROTID ARTERY STENT PROCEDURE W MCC,37494.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,36969.536098310295
652 - KIDNEY TRANSPLANT,36219.832402234635
981 - EXTENSIVE O.R. PROCEDURE UNRELATED TO PRINCIPAL DIAGNOSIS W MCC,36126.76478318003
347 - ANAL & STOMAL PROCEDURES W MCC,35826.0
229 - OTHER CARDIOTHORACIC PROCEDURES W CC,35479.46153846154
260 - CARDIAC PACEMAKER REVISION EXCEPT DEVICE REPLACEMENT W MCC,34872.818181818184
221 - CARDIAC VALVE & OTH M
Query:
SELECT "drg_definition", "average_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
LIMIT 100;
Answer:
Too long, hard cut:
drg_definition,average_total_payments
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,7331.0
101 - SEIZURES W/O MCC,6022.0
176 - PULMONARY EMBOLISM W/O MCC,7262.0
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,9891.0
180 - RESPIRATORY NEOPLASMS W MCC,13221.0
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,9413.0
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,8688.0
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,7326.0
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,5883.0
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,10981.0
194 - SIMPLE PNEUMONIA & PLEURISY W CC,7635.0
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,5893.0
202 - BRONCHITIS & ASTHMA W CC/MCC,7054.0
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,16402.0
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",10940.0
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",7749.0
"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC",6095.0
291 - HEART FAILURE & SHOCK W MCC,10615.0
292 - HEART FAILURE & SHOCK W CC,7867.0
293 - HEART FAILURE & SHOCK W/O CC/MCC,5480.0
303 - ATHEROSCLEROSIS W/O MCC,5133.0
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,9516.0
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,6394.0
310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,4761.0
312 - SYNCOPE & COLLAPSE,5967.0
313 - CHEST PAIN,5101.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,34739.0
378 - G.I. HEMORRHAGE W CC,8027.0
379 - G.I. HEMORRHAGE W/O CC/MCC,5724.0
389 - G.I. OBSTRUCTION W CC,7362.0
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",9384.0
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC",6123.0
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,7536.0
445 - DISORDERS OF THE BILIARY TRACT W CC,8111.0
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,16334.0
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,14766.0
602 - CELLULITIS W MCC,11004.0
603 - CELLULITIS W/O MCC,6601.0
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC",8768.0
"641 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W/O MCC",5667.0
682 - RENAL FAILURE W MCC,11395.0
683 - RENAL FAILURE W CC,7453.0
684 - RENAL FAILURE W/O CC/MCC,5179.0
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC,8724.0
690 - KIDNEY & URINARY TRACT INFECTIONS W/O MCC,6123.0
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC,13769.0
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC,8133.0
897 - ALCOHOL/DRUG ABUSE OR DEPENDENCE W/O REHABILITATION THERAPY W/O MCC,5690.0
918 - POISONING & TOXIC EFFECTS OF DRUGS W/O MCC,5276.0
948 - SIGNS & SYMPTOMS W/O MCC,5819.0
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS,7520.0
066 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W/O CC/MCC,5679.0
101 - SEIZURES W/O MCC,5677.0
176 - PULMONARY EMBOLISM W/O MCC,7262.0
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC,13102.0
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,9615.0
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,8713.0
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,8251.0
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,6857.0
192 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W/O CC/MCC,5287.0
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,11649.0
194 - SIMPLE PNEUMONIA & PLEURISY W CC,9064.0
195 - SIMPLE PNEUMONIA & PLEURISY W/O CC/MCC,5281.0
202 - BRONCHITIS & ASTHMA W CC/MCC,6450.0
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,36561.0
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,16950.0
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC,18509.0
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",11442.0
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",7070.0
"282 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W/O CC/MCC",5508.0
291 - HEART FAILURE & SHOCK W MCC,10673.0
292 - HEART FAILURE & SHOCK W CC,7649.0
293 - HEART FAILURE & SHOCK W/O CC/MCC,5035.0
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,9713.0
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,5857.0
310 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W/O CC/MCC,4246.0
312 - SYNCOPE & COLLAPSE,5436.0
313 - CHEST PAIN,4579.0
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC,12762.0
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,38036.0
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC,19368.0
372 - MAJOR GASTROINTESTINAL DISORDERS & PERITONEAL INFECTIONS W CC,8269.0
378 - G.I. HEMORRHAGE W CC,7263.0
389 - G.I. OBSTRUCTION W CC,6338.0
390 - G.I. OBSTRUCTION W/O CC/MCC,4577.0
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",8695.0
"392 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W/O MCC",5560.0
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,7127.0
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC,6786.0
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC,35153.0
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,15623.0
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,1
Query:
SELECT "provider_city",
          SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments"
   FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
   GROUP BY "provider_city"
   ORDER BY "weighted_avg_total_payments" DESC
   LIMIT 100;
Answer:
provider_city,weighted_avg_total_payments
VAIL,39829.87719298246
VALHALLA,35942.17015895954
STANFORD,34460.472471190784
SYLMAR,29640.666666666668
LOS BANOS,28339.96913580247
SAN FRANCISCO,27972.584363561018
STEAMBOAT SPRIN,27632.70731707317
COSTA MESA,26402.29775280899
LOMA LINDA,25949.72606296657
FISHERS,25686.0
ROYERSFORD,23467.967567567568
FRENCH CAMP,23448.934210526317
NEW YORK,23447.968839098732
SACRAMENTO,22788.269757702663
LOS ANGELES,22661.930675866235
CHAPEL HILL,22627.406612784718
TROPHY CLUB,22424.2
LAKEWAY,22359.821428571428
BRONX,22254.965069551778
SAINT HELENA,22248.24238943136
LENEXA,22228.0
FLAGSTAFF,22078.76782273603
FAR ROCKAWAY,21945.474764281753
ANCHORAGE,21734.217236317887
MAYWOOD,21592.556864010323
KING CITY,21562.275862068964
BOSTON,21546.86358754028
MORENO VALLEY,21503.65226130653
SEATTLE,21071.57804632427
GALVESTON,20844.27606928243
STONY BROOK,20787.389069689147
HERSHEY,20743.74328187536
NEW HAVEN,20663.571870737593
FAIRBANKS,20460.931350114417
ORANGE,20157.53606166269
ROSLYN,20141.728339854668
BALTIMORE,20129.263951508547
CHARLOTTESVILLE,19932.883191575536
PHILADELPHIA,19821.489041125587
DURHAM,19681.989643191235
SANTA ANA,19668.84
BROOKLYN,19668.429922541534
MINEOLA,19516.185185185186
LANDER,19371.090909090908
REDWOOD CITY,19320.00308880309
BROWNS MILLS,19113.66434648105
COLTON,19105.23779724656
SEBASTOPOL,18971.78021978022
SAN JOSE,18898.54958043851
NEW HYDE PARK,18859.75676479334
ANN ARBOR,18857.17929914133
BRIGHTON,18827.840238647663
MARTINEZ,18799.58620689655
LYNWOOD,18676.69923076923
JAMAICA,18619.512021036815
SAN DIEGO,18593.096496266513
SANTA CLARA,18554.436842105264
SALINAS,18304.158297611757
MENLO PARK,18265.0
ROCHESTER,18261.930331618067
HONOLULU,18217.862269503545
BERKELEY,18209.78090766823
MINNEAPOLIS,18169.339208651796
LA JOLLA,18114.59443990188
ADDISON,18096.77449168207
MONTEREY,18092.60730593607
FLUSHING,17928.822360399903
VAN NUYS,17863.538612887358
IOWA CITY,17811.727291388688
CLEVELAND,17791.218920329353
BRIGHAM CITY,17623.0
SALT LAKE CITY,17575.512240307
OAK LAWN,17543.91871492162
MANHASSET,17396.34272197962
HACKENSACK,17360.835429095914
NEW ORLEANS,17296.940790138426
GLENWOOD SPRING,17146.300632911392
NEW BRUNSWICK,17087.036659011654
DENVER,17046.005257105306
PHOENIX,17008.658613401847
STOCKTON,16995.303197120473
FALLS CHURCH,16927.151626939085
OAKLAND,16925.718997361477
PORTLAND,16889.57057411401
SOUTH EL MONTE,16857.854545454546
IRVINE,16772.890574214518
WALNUT CREEK,16768.87914798206
CAMDEN,16712.4377030468
HARTFORD,16670.152267396403
PARAMUS,16617.716374269006
SOUTH LAKE TAHO,16602.18631178707
MADISON,16590.075445960127
LEBANON,16586.631494804158
TREMONTON,16578.0
DALY CITY,16491.718885448918
ATLANTA,16490.705916623512
KAMUELA,16411.19178082192
RIVERSIDE,16409.986902740722
WASHINGTON,16363.145358677255
LOS ALAMOS,16348.709090909091
Query:
SELECT SUM("total_discharges") AS "national_total_discharges"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    LIMIT 100;
Answer:
national_total_discharges
7297885
Query:
SELECT "drg_definition",
           AVG("average_total_payments") AS "avg_total_payments",
           SUM("total_discharges") AS "total_discharges_per_drg"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    GROUP BY "drg_definition"
    ORDER BY "avg_total_payments" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
drg_definition,avg_total_payments,total_discharges_per_drg
001 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W MCC,244554.5588235294,1495
002 - HEART TRANSPLANT OR IMPLANT OF HEART ASSIST SYSTEM W/O MCC,155086.5,23
215 - OTHER HEART ASSIST SYSTEM IMPLANT,136869.0,23
"003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",134199.6497797357,11987
005 - LIVER TRANSPLANT W MCC OR INTESTINAL TRANSPLANT,125107.5,741
014 - ALLOGENEIC BONE MARROW TRANSPLANT,119135.62962962964,467
927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT,115031.0,27
007 - LUNG TRANSPLANT,104386.21052631579,328
453 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W MCC,98293.44444444444,297
020 - INTRACRANIAL VASCULAR PROCEDURES W PDX HEMORRHAGE W MCC,92115.68421052632,264
456 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W MCC,92086.17647058824,231
826 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W MAJ O.R. PROC W MCC,82978.0,13
"004 - TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W/O MAJ O.R.",79539.63130434783,11774
820 - LYMPHOMA & LEUKEMIA W MAJOR O.R. PROCEDURE W MCC,75147.0,12
951 - OTHER FACTORS INFLUENCING HEALTH STATUS,74733.0,73
222 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W MCC,72575.33333333333,86
216 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W MCC,72156.15646258503,7449
224 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W MCC,71252.5,73
834 - ACUTE LEUKEMIA W/O MAJOR O.R. PROCEDURE W MCC,68996.359375,1356
837 - CHEMO W ACUTE LEUKEMIA AS SDX OR W HIGH DOSE CHEMO AGENT W MCC,68039.84210526316,776
500 - SOFT TISSUE PROCEDURES W MCC,67321.0,12
957 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W MCC,66910.6129032258,492
423 - OTHER HEPATOBILIARY OR PANCREAS O.R. PROCEDURES W MCC,63876.0,16
454 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W CC,63862.262295081964,2690
008 - SIMULTANEOUS PANCREAS/KIDNEY TRANSPLANT,63612.0,54
016 - AUTOLOGOUS BONE MARROW TRANSPLANT W CC/MCC,60541.69491525424,1305
223 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W AMI/HF/SHOCK W/O MCC,59812.25,73
228 - OTHER CARDIOTHORACIC PROCEDURES W MCC,58482.375,127
219 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W MCC,58401.27557411273,18853
823 - LYMPHOMA & NON-ACUTE LEUKEMIA W OTHER O.R. PROC W MCC,58391.4,69
457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC,56080.556818181816,1890
006 - LIVER TRANSPLANT W/O MCC,55617.75,61
969 - HIV W EXTENSIVE O.R. PROCEDURE W MCC,54603.0,11
028 - SPINAL PROCEDURES W MCC,54099.5,209
928 - FULL THICKNESS BURN W SKIN GRAFT OR INHAL INJ W CC/MCC,53686.36842105263,756
226 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W MCC,53493.02597402597,1175
"011 - TRACHEOSTOMY FOR FACE,MOUTH & NECK DIAGNOSES W MCC",52272.8064516129,491
653 - MAJOR BLADDER PROCEDURES W MCC,51973.78571428572,206
"405 - PANCREAS, LIVER & SHUNT PROCEDURES W MCC",51653.11607142857,2321
233 - CORONARY BYPASS W CARDIAC CATH W MCC,50909.48409090909,8615
459 - SPINAL FUSION EXCEPT CERVICAL W MCC,49542.98648648649,1111
217 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W CC,47003.651162790695,3164
"326 - STOMACH, ESOPHAGEAL & DUODENAL PROC W MCC",45339.234042553195,4107
455 - COMBINED ANTERIOR/POSTERIOR SPINAL FUSION W/O CC/MCC,45095.50892857143,2368
218 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W CARD CATH W/O CC/MCC,44782.666666666664,126
"463 - WND DEBRID & SKN GRFT EXC HAND, FOR MUSCULO-CONN TISS DIS W MCC",44524.854545454546,777
023 - CRANIO W MAJOR DEV IMPL/ACUTE COMPLEX CNS PDX W MCC OR CHEMO IMPLANT,44412.127071823204,3418
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,43888.93134598013,28260
225 - CARDIAC DEFIB IMPLANT W CARDIAC CATH W/O AMI/HF/SHOCK W/O MCC,43402.8,163
235 - CORONARY BYPASS W/O CARDIAC CATH W MCC,43214.4173553719,5467
958 - OTHER O.R. PROCEDURES FOR MULTIPLE SIGNIFICANT TRAUMA W CC,41913.2,148
471 - CERVICAL SPINAL FUSION W MCC,41469.22222222222,512
227 - CARDIAC DEFIBRILLATOR IMPLANT W/O CARDIAC CATH W/O MCC,40687.22619047619,5096
856 - POSTOPERATIVE OR POST-TRAUMATIC INFECTIONS W O.R. PROC W MCC,40488.37037037037,1701
829 - MYELOPROLIF DISORD OR POORLY DIFF NEOPL W OTHER O.R. PROC W CC/MCC,40311.5,60
237 - MAJOR CARDIOVASC PROCEDURES W MCC,39915.12634822804,14469
458 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W/O CC/MCC,39789.142857142855,306
245 - AICD GENERATOR PROCEDURES,38909.25,106
332 - RECTAL RESECTION W MCC,38715.0,12
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,38595.19937694704,54698
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38472.1189516129,21164
220 - CARDIAC VALVE & OTH MAJ CARDIOTHORACIC PROC W/O CARD CATH W CC,38450.055555555555,22723
466 - REVISION OF HIP OR KNEE REPLACEMENT W MCC,38067.64705882353,522
163 - MAJOR CHEST PROCEDURES W MCC,37511.87009063444,6021
034 - CAROTID ARTERY STENT PROCEDURE W MCC,37494.0,13
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,36969.536098310295,31619
652 - KIDNEY TRANSPLANT,36219.83240223463
Query:
WITH TopDRG AS (
  SELECT "drg_definition"
  FROM (
    SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
    GROUP BY "drg_definition"
    ORDER BY "total_discharges_per_drg" DESC
    LIMIT 1
  )
),
TopCities AS (
  SELECT "provider_city", SUM("total_discharges") AS "total_discharges_city"
  FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" t
  JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
  GROUP BY "provider_city"
  ORDER BY "total_discharges_city" DESC
  LIMIT 3
)
SELECT t."provider_city",
       SUM(t."total_discharges" * t."average_total_payments") / SUM(t."total_discharges") AS "weighted_avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" t
JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
JOIN TopCities ON t."provider_city" = TopCities."provider_city"
GROUP BY t."provider_city";
Answer:
provider_city,weighted_avg_total_payments
SPRINGFIELD,15290.641242937852
BOSTON,18323.85317159464
NEW YORK,21656.258430507405
Query:
SELECT "provider_city",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "weighted_avg_total_payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
WHERE LEFT("drg_definition", 3) = '470'
GROUP BY "provider_city"
ORDER BY SUM("total_discharges") DESC
LIMIT 3;
Answer:
provider_city,weighted_avg_total_payments
NEW YORK,21656.258430507405
BOSTON,18323.85317159464
SPRINGFIELD,15290.641242937852
End Exploring Related Columns
Task: In the 2014 CMS Medicare inpatient charges data, which DRG definition has the highest total number of discharges, and among the top three cities with the most discharges for that DRG definition, what are their respective weighted average total payments (weighted by total discharges)

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: The DRG definition with the highest total number of discharges is `drg_definition:str`. The top three cities with the most discharges for this DRG definition, and their respective weighted average total payments are:

```csv
City,Weighted_Average_Total_Payments
city1:str,payment1:float
city2:str,payment2:float
city3:str,payment3:float
(Attention: answer in three rows)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD10_DIAGNOSES_2019', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CONDITION_OCCURRENCE', 'DRUG_ERA', 'LOCATION', 'PERSON', 'CONDITION_ERA', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'OBSERVATION', 'COST', 'PROVIDER', 'CARE_SITE', 'CONCEPT_ANCESTOR', 'CONCEPT_RELATIONSHIP', 'DEATH', 'DRUG_STRENGTH', 'CONCEPT', 'CONCEPT_CLASS', 'DRUG_EXPOSURE', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'RELATIONSHIP', 'VOCABULARY', 'PROCEDURE_OCCURRENCE']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-12 18:10:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:10:17 - root - INFO - ```sql
WITH TopDRG AS (
    SELECT "drg_definition"
    FROM (
        SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
        FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
        GROUP BY "drg_definition"
        ORDER BY "total_discharges_per_drg" DESC
        LIMIT 1
    )
),
TopCities AS (
    SELECT "provider_city", SUM("total_discharges") AS "total_city_discharges"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" AS t
    JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
    GROUP BY "provider_city"
    ORDER BY "total_city_discharges" DESC
    LIMIT 3
)
SELECT t."provider_city" AS "City",
       SUM(t."total_discharges" * t."average_total_payments") / SUM(t."total_discharges") AS "Weighted_Average_Total_Payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" AS t
JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
JOIN TopCities ON t."provider_city" = TopCities."provider_city"
GROUP BY t."provider_city";
```

The DRG definition with the highest total number of discharges is `470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC`. The top three cities with the most discharges for this DRG definition, and their respective weighted average total payments are:

```csv
City,Weighted_Average_Total_Payments
NEW YORK,21656.2584
BOSTON,18323.8532
SPRINGFIELD,15290.6412
```
2025-02-12 18:10:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:10:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:10:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:10:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 18:10:18 - snowflake.connector.connection - INFO - closed
2025-02-12 18:10:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:10:18 - root - INFO - itercount: 1
2025-02-12 18:10:18 - root - INFO - 0
2025-02-12 18:10:18 - root - INFO - results: 
City,Weighted_Average_Total_Payments
SPRINGFIELD,15290.641242937852
BOSTON,18323.85317159464
NEW YORK,21656.258430507405


2025-02-12 18:10:18 - root - INFO - Please check the answer again by reviewing In the 2014 CMS Medicare inpatient charges data, which DRG definition has the highest total number of discharges, and among the top three cities with the most discharges for that DRG definition, what are their respective weighted average total payments (weighted by total discharges), reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: The DRG definition with the highest total number of discharges is `drg_definition:str`. The top three cities with the most discharges for this DRG definition, and their respective weighted average total payments are:

```csv
City,Weighted_Average_Total_Payments
city1:str,payment1:float
city2:str,payment2:float
city3:str,payment3:float
(Attention: answer in three rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
City,Weighted_Average_Total_Payments
SPRINGFIELD,15290.641242937852
BOSTON,18323.85317159464
NEW YORK,21656.258430507405
Current sql:
WITH TopDRG AS (
    SELECT "drg_definition"
    FROM (
        SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
        FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
        GROUP BY "drg_definition"
        ORDER BY "total_discharges_per_drg" DESC
        LIMIT 1
    )
),
TopCities AS (
    SELECT "provider_city", SUM("total_discharges") AS "total_city_discharges"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" AS t
    JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
    GROUP BY "provider_city"
    ORDER BY "total_city_discharges" DESC
    LIMIT 3
)
SELECT t."provider_city" AS "City",
       SUM(t."total_discharges" * t."average_total_payments") / SUM(t."total_discharges") AS "Weighted_Average_Total_Payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" AS t
JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
JOIN TopCities ON t."provider_city" = TopCities."provider_city"
GROUP BY t."provider_city";When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-12 18:10:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 18:10:46 - root - INFO - The DRG definition with the highest total number of discharges is `470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC`. The top three cities with the most discharges for this DRG definition, and their respective weighted average total payments are:

```csv
City,Weighted_Average_Total_Payments
NEW YORK,21656.2584
BOSTON,18323.8532
SPRINGFIELD,15290.6412
```

```sql
WITH TopDRG AS (
    SELECT "drg_definition"
    FROM (
        SELECT "drg_definition", SUM("total_discharges") AS "total_discharges_per_drg"
        FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014"
        GROUP BY "drg_definition"
        ORDER BY "total_discharges_per_drg" DESC NULLS LAST
        LIMIT 1
    )
),
TopCities AS (
    SELECT "provider_city", SUM("total_discharges") AS "total_city_discharges"
    FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" AS t
    JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
    GROUP BY "provider_city"
    ORDER BY "total_city_discharges" DESC NULLS LAST
    LIMIT 3
)
SELECT t."provider_city" AS "City",
       ROUND(
           SUM(t."total_discharges" * t."average_total_payments") / SUM(t."total_discharges"), 4
       ) AS "Weighted_Average_Total_Payments"
FROM "CMS_DATA"."CMS_MEDICARE"."INPATIENT_CHARGES_2014" AS t
JOIN TopDRG ON t."drg_definition" = TopDRG."drg_definition"
JOIN TopCities ON t."provider_city" = TopCities."provider_city"
GROUP BY t."provider_city";
```
2025-02-12 18:10:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 18:10:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 18:10:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 18:10:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-12 18:10:47 - snowflake.connector.connection - INFO - closed
2025-02-12 18:10:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 18:10:48 - root - INFO - itercount: 2
2025-02-12 18:10:48 - root - INFO - 0
2025-02-12 18:10:48 - root - INFO - Total iteration counts: 2
