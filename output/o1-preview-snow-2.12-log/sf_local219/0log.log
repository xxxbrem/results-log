2025-02-10 11:59:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.480351 seconds
2025-02-10 12:00:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 12:00:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-02-10 12:00:21 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:22 - root - INFO - SQL:
SELECT "id", "name"
   FROM EU_SOCCER.EU_SOCCER.LEAGUE
   LIMIT 100;
Results:
id,name
1,Belgium Jupiler League
1729,England Premier League
4769,France Ligue 1
7809,Germany 1. Bundesliga
10257,Italy Serie A
13274,Netherlands Eredivisie
15722,Poland Ekstraklasa
17642,Portugal Liga ZON Sagres
19694,Scotland Premier League
21518,Spain LIGA BBVA
24558,Switzerland Super League

2025-02-10 12:00:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:23 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:23 - root - INFO - SQL:
SELECT "team_api_id", "team_long_name"
   FROM EU_SOCCER.EU_SOCCER.TEAM
   LIMIT 100;
Results:
team_api_id,team_long_name
9987,KRC Genk
9993,Beerschot AC
10000,SV Zulte-Waregem
9994,Sporting Lokeren
9984,KSV Cercle Brugge
8635,RSC Anderlecht
9991,KAA Gent
9998,RAEC Mons
7947,FCV Dender EH
9985,Standard de Liège
8203,KV Mechelen
8342,Club Brugge KV
9999,KSV Roeselare
8571,KV Kortrijk
4049,Tubize
9996,Royal Excel Mouscron
10001,KVC Westerlo
9986,Sporting Charleroi
9997,Sint-Truidense VV
9989,Lierse SK
6351,KAS Eupen
1773,Oud-Heverlee Leuven
8475,Waasland-Beveren
8573,KV Oostende
274581,Royal Excel Mouscron
10260,Manchester United
10261,Newcastle United
9825,Arsenal
8659,West Bromwich Albion
8472,Sunderland
8650,Liverpool
8654,West Ham United
8528,Wigan Athletic
10252,Aston Villa
8456,Manchester City
8668,Everton
8655,Blackburn Rovers
8549,Middlesbrough
8586,Tottenham Hotspur
8559,Bolton Wanderers
10194,Stoke City
8667,Hull City
9879,Fulham
8455,Chelsea
8462,Portsmouth
8658,Birmingham City
8602,Wolverhampton Wanderers
8191,Burnley
8483,Blackpool
10003,Swansea City
10172,Queens Park Rangers
9850,Norwich City
8466,Southampton
9798,Reading
9826,Crystal Palace
8344,Cardiff City
8197,Leicester City
8678,Bournemouth
9817,Watford
8583,AJ Auxerre
9830,FC Nantes
9827,Girondins de Bordeaux
7819,SM Caen
9746,Le Havre AC
9831,OGC Nice
8682,Le Mans FC
8689,FC Lorient
9748,Olympique Lyonnais
9941,Toulouse FC
9829,AS Monaco
9847,Paris Saint-Germain
8481,AS Nancy-Lorraine
8639,LOSC Lille
9851,Stade Rennais FC
8592,Olympique de Marseille
9874,FC Sochaux-Montbéliard
9855,Grenoble Foot 38
9873,Valenciennes FC
9853,AS Saint-Étienne
8588,RC Lens
10249,Montpellier Hérault SC
4170,US Boulogne Cote D'Opale
108893,AC Arles-Avignon
8521,Stade Brestois 29
8576,AC Ajaccio
4087,Évian Thonon Gaillard FC
9836,Dijon FCO
9837,Stade de Reims
7794,SC Bastia
10242,ES Troyes AC
9747,En Avant de Guingamp
8550,FC Metz
8121,Angers SCO
6391,GFC Ajaccio
9823,FC Bayern Munich
9790,Hamburger SV
8178,Bayer 04 Leverkusen
9789,Borussia Dortmund
10189,FC Schalke 04
9904,Hannover 96

2025-02-10 12:00:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:24 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:25 - root - INFO - SQL:
SELECT "id", "league_id", "home_team_api_id", "away_team_api_id", "home_team_goal", "away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH
   LIMIT 100;
Results:
id,league_id,home_team_api_id,away_team_api_id,home_team_goal,away_team_goal
1,1,9987,9993,1,1
2,1,10000,9994,0,0
3,1,9984,8635,0,3
4,1,9991,9998,5,0
5,1,7947,9985,1,3
6,1,8203,8342,1,1
7,1,9999,8571,2,2
8,1,4049,9996,1,2
9,1,10001,9986,1,0
10,1,8342,8571,4,1
11,1,9985,9986,1,2
12,1,10000,9991,0,2
13,1,9994,9998,0,0
14,1,7947,10001,2,2
15,1,8203,9999,1,2
16,1,9996,9984,0,1
17,1,4049,9987,1,3
18,1,9993,8635,1,3
19,1,8635,9994,2,3
20,1,9998,9996,0,0
21,1,9986,8342,2,2
22,1,9984,10000,2,0
23,1,9991,7947,1,1
24,1,9999,4049,1,2
25,1,8571,8203,0,0
26,1,10001,9987,1,0
27,1,9993,9985,1,3
28,1,8342,8635,1,1
29,1,9987,9999,1,1
30,1,10000,9993,2,2
31,1,9994,9985,1,1
32,1,7947,8571,1,0
33,1,8203,9998,0,0
34,1,9996,9986,2,1
35,1,4049,9984,3,0
36,1,10001,9991,3,2
37,1,8635,10001,2,0
38,1,9985,9996,3,1
39,1,9998,8342,1,2
40,1,9986,4049,3,2
41,1,9984,8203,2,1
42,1,9991,9987,2,3
43,1,9999,7947,2,2
44,1,8571,10000,1,0
45,1,9993,9994,0,2
46,1,8342,9993,3,0
47,1,9987,9984,3,2
48,1,10000,9986,4,2
49,1,9991,9999,4,0
50,1,7947,8635,0,2
51,1,8203,9985,0,0
52,1,9996,9994,2,0
53,1,4049,8571,3,3
54,1,10001,9998,2,1
55,1,8635,4049,5,1
56,1,9985,10000,1,2
57,1,9998,7947,5,2
58,1,9986,8203,1,2
59,1,9984,9991,3,1
60,1,9994,8342,2,0
61,1,9999,10001,1,0
62,1,8571,9987,3,1
63,1,9993,9996,3,0
64,1,8342,9985,1,4
65,1,9987,9986,1,0
66,1,10000,9996,2,1
67,1,9991,8571,1,1
68,1,7947,9994,1,1
69,1,8203,9993,2,1
70,1,9999,8635,0,3
71,1,4049,9998,2,1
72,1,10001,9984,1,2
73,1,8635,9987,2,0
74,1,9985,9991,2,1
75,1,9998,10000,2,2
76,1,9986,7947,2,0
77,1,9984,9999,4,3
78,1,9994,8203,2,2
79,1,9996,8342,5,1
80,1,8571,10001,0,0
81,1,9993,4049,2,0
82,1,9993,9987,4,1
83,1,9994,10000,2,1
84,1,8635,9984,1,2
85,1,9998,9991,1,2
86,1,9985,7947,3,2
87,1,8342,8203,3,0
88,1,8571,9999,2,1
89,1,9996,4049,1,1
90,1,9986,10001,1,2
91,1,10000,8342,3,1
92,1,9991,8635,1,2
93,1,10001,9985,0,1
94,1,9987,9998,2,0
95,1,9999,9986,3,1
96,1,4049,9994,2,1
97,1,8203,9996,2,2
98,1,9984,8571,0,1
99,1,7947,9993,0,1
100,1,8342,10000,2,0

2025-02-10 12:00:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-02-10 12:00:26 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:26 - root - INFO - SQL:
SELECT DISTINCT "league_id"
   FROM EU_SOCCER.EU_SOCCER.MATCH
   LIMIT 100;
Results:
league_id
1
1729
4769
7809
15722
10257
17642
19694
21518
24558
13274

2025-02-10 12:00:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:27 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:28 - root - INFO - SQL:
SELECT m."id", l."name" AS "league_name", m."home_team_api_id", m."away_team_api_id", m."home_team_goal", m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
   LIMIT 100;
Results:
id,league_name,home_team_api_id,away_team_api_id,home_team_goal,away_team_goal
1,Belgium Jupiler League,9987,9993,1,1
2,Belgium Jupiler League,10000,9994,0,0
3,Belgium Jupiler League,9984,8635,0,3
4,Belgium Jupiler League,9991,9998,5,0
5,Belgium Jupiler League,7947,9985,1,3
6,Belgium Jupiler League,8203,8342,1,1
7,Belgium Jupiler League,9999,8571,2,2
8,Belgium Jupiler League,4049,9996,1,2
9,Belgium Jupiler League,10001,9986,1,0
10,Belgium Jupiler League,8342,8571,4,1
11,Belgium Jupiler League,9985,9986,1,2
12,Belgium Jupiler League,10000,9991,0,2
13,Belgium Jupiler League,9994,9998,0,0
14,Belgium Jupiler League,7947,10001,2,2
15,Belgium Jupiler League,8203,9999,1,2
16,Belgium Jupiler League,9996,9984,0,1
17,Belgium Jupiler League,4049,9987,1,3
18,Belgium Jupiler League,9993,8635,1,3
19,Belgium Jupiler League,8635,9994,2,3
20,Belgium Jupiler League,9998,9996,0,0
21,Belgium Jupiler League,9986,8342,2,2
22,Belgium Jupiler League,9984,10000,2,0
23,Belgium Jupiler League,9991,7947,1,1
24,Belgium Jupiler League,9999,4049,1,2
25,Belgium Jupiler League,8571,8203,0,0
26,Belgium Jupiler League,10001,9987,1,0
27,Belgium Jupiler League,9993,9985,1,3
28,Belgium Jupiler League,8342,8635,1,1
29,Belgium Jupiler League,9987,9999,1,1
30,Belgium Jupiler League,10000,9993,2,2
31,Belgium Jupiler League,9994,9985,1,1
32,Belgium Jupiler League,7947,8571,1,0
33,Belgium Jupiler League,8203,9998,0,0
34,Belgium Jupiler League,9996,9986,2,1
35,Belgium Jupiler League,4049,9984,3,0
36,Belgium Jupiler League,10001,9991,3,2
37,Belgium Jupiler League,8635,10001,2,0
38,Belgium Jupiler League,9985,9996,3,1
39,Belgium Jupiler League,9998,8342,1,2
40,Belgium Jupiler League,9986,4049,3,2
41,Belgium Jupiler League,9984,8203,2,1
42,Belgium Jupiler League,9991,9987,2,3
43,Belgium Jupiler League,9999,7947,2,2
44,Belgium Jupiler League,8571,10000,1,0
45,Belgium Jupiler League,9993,9994,0,2
46,Belgium Jupiler League,8342,9993,3,0
47,Belgium Jupiler League,9987,9984,3,2
48,Belgium Jupiler League,10000,9986,4,2
49,Belgium Jupiler League,9991,9999,4,0
50,Belgium Jupiler League,7947,8635,0,2
51,Belgium Jupiler League,8203,9985,0,0
52,Belgium Jupiler League,9996,9994,2,0
53,Belgium Jupiler League,4049,8571,3,3
54,Belgium Jupiler League,10001,9998,2,1
55,Belgium Jupiler League,8635,4049,5,1
56,Belgium Jupiler League,9985,10000,1,2
57,Belgium Jupiler League,9998,7947,5,2
58,Belgium Jupiler League,9986,8203,1,2
59,Belgium Jupiler League,9984,9991,3,1
60,Belgium Jupiler League,9994,8342,2,0
61,Belgium Jupiler League,9999,10001,1,0
62,Belgium Jupiler League,8571,9987,3,1
63,Belgium Jupiler League,9993,9996,3,0
64,Belgium Jupiler League,8342,9985,1,4
65,Belgium Jupiler League,9987,9986,1,0
66,Belgium Jupiler League,10000,9996,2,1
67,Belgium Jupiler League,9991,8571,1,1
68,Belgium Jupiler League,7947,9994,1,1
69,Belgium Jupiler League,8203,9993,2,1
70,Belgium Jupiler League,9999,8635,0,3
71,Belgium Jupiler League,4049,9998,2,1
72,Belgium Jupiler League,10001,9984,1,2
73,Belgium Jupiler League,8635,9987,2,0
74,Belgium Jupiler League,9985,9991,2,1
75,Belgium Jupiler League,9998,10000,2,2
76,Belgium Jupiler League,9986,7947,2,0
77,Belgium Jupiler League,9984,9999,4,3
78,Belgium Jupiler League,9994,8203,2,2
79,Belgium Jupiler League,9996,8342,5,1
80,Belgium Jupiler League,8571,10001,0,0
81,Belgium Jupiler League,9993,4049,2,0
82,Belgium Jupiler League,9993,9987,4,1
83,Belgium Jupiler League,9994,10000,2,1
84,Belgium Jupiler League,8635,9984,1,2
85,Belgium Jupiler League,9998,9991,1,2
86,Belgium Jupiler League,9985,7947,3,2
87,Belgium Jupiler League,8342,8203,3,0
88,Belgium Jupiler League,8571,9999,2,1
89,Belgium Jupiler League,9996,4049,1,1
90,Belgium Jupiler League,9986,10001,1,2
91,Belgium Jupiler League,10000,8342,3,1
92,Belgium Jupiler League,9991,8635,1,2
93,Belgium Jupiler League,10001,9985,0,1
94,Belgium Jupiler League,9987,9998,2,0
95,Belgium Jupiler League,9999,9986,3,1
96,Belgium Jupiler League,4049,9994,2,1
97,Belgium Jupiler League,8203,9996,2,2
98,Belgium Jupiler League,9984,8571,0,1
99,Belgium Jupiler League,7947,9993,0,1
100,Belgium Jupiler League,8342,10000,2,0

2025-02-10 12:00:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:29 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:30 - root - INFO - SQL:
SELECT m."id", t."team_long_name" AS "home_team_name", m."home_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id"
   LIMIT 100;
Results:
id,home_team_name,home_team_goal
16385,Lechia Gdańsk,1
16386,Lech Poznań,4
16387,Lechia Gdańsk,1
16388,Polonia Bytom,4
16389,Wisła Kraków,0
16390,Śląsk Wrocław,5
16391,Legia Warszawa,4
16392,GKS Bełchatów,1
16393,Jagiellonia Białystok,2
16394,Legia Warszawa,0
16395,Lechia Gdańsk,2
16396,Jagiellonia Białystok,2
16397,Wisła Kraków,2
16398,Polonia Bytom,1
16399,Korona Kielce,1
16400,Zagłębie Lubin,1
16401,Widzew Łódź,0
16402,Śląsk Wrocław,1
16403,GKS Bełchatów,1
16404,P. Warszawa,1
16405,Arka Gdynia,1
16406,Polonia Bytom,2
16407,Cracovia,2
16408,Ruch Chorzów,1
16409,Jagiellonia Białystok,2
16410,Polonia Bytom,1
16411,Wisła Kraków,2
16412,Zagłębie Lubin,2
16413,Widzew Łódź,5
16414,Lech Poznań,2
16415,Arka Gdynia,1
16416,Polonia Bytom,1
16417,Lechia Gdańsk,1
16418,Korona Kielce,2
16419,GKS Bełchatów,1
16420,Legia Warszawa,2
16421,Lechia Gdańsk,5
16422,P. Warszawa,2
16423,Cracovia,2
16424,Ruch Chorzów,1
16425,Jagiellonia Białystok,2
16426,Legia Warszawa,0
16427,GKS Bełchatów,1
16428,Wisła Kraków,0
16429,Polonia Bytom,0
16430,Ruch Chorzów,0
16431,Zagłębie Lubin,0
16432,Polonia Bytom,2
16433,Arka Gdynia,0
16434,Śląsk Wrocław,2
16435,Korona Kielce,3
16436,Widzew Łódź,0
16437,Lechia Gdańsk,1
16438,Lech Poznań,0
16439,Polonia Bytom,1
16440,Cracovia,2
16441,Jagiellonia Białystok,3
16442,Cracovia,1
16443,P. Warszawa,1
16444,Legia Warszawa,3
16445,Widzew Łódź,0
16446,Podbeskidzie Bielsko-Biała,2
16447,Ruch Chorzów,2
16448,Śląsk Wrocław,1
16449,Widzew Łódź,1
16450,GKS Bełchatów,3
16451,Lech Poznań,1
16452,Podbeskidzie Bielsko-Biała,1
16453,P. Warszawa,1
16454,Ruch Chorzów,0
16455,Widzew Łódź,0
16456,Wisła Kraków,3
16457,Zagłębie Lubin,0
16458,Cracovia,0
16459,Polonia Bytom,1
16460,Jagiellonia Białystok,1
16461,Lechia Gdańsk,0
16462,Legia Warszawa,2
16463,Widzew Łódź,1
16464,Śląsk Wrocław,1
16465,Zagłębie Lubin,3
16466,GKS Bełchatów,2
16467,Polonia Bytom,2
16468,Korona Kielce,0
16469,Lech Poznań,0
16470,Ruch Chorzów,0
16471,Śląsk Wrocław,1
16472,Widzew Łódź,1
16473,Wisła Kraków,0
16474,Cracovia,1
16475,Jagiellonia Białystok,0
16476,Korona Kielce,2
16477,Lechia Gdańsk,0
16478,Widzew Łódź,0
16479,Podbeskidzie Bielsko-Biała,1
16480,P. Warszawa,1
16481,Zagłębie Lubin,1
16482,GKS Bełchatów,3
16483,Jagiellonia Białystok,0
16484,Legia Warszawa,3

2025-02-10 12:00:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:31 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:31 - root - INFO - SQL:
SELECT m."id", t."team_long_name" AS "away_team_name", m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."away_team_api_id" = t."team_api_id"
   LIMIT 100;
Results:
id,away_team_name,away_team_goal
16385,Jagiellonia Białystok,2
16386,Korona Kielce,0
16387,Zagłębie Lubin,2
16388,Widzew Łódź,0
16389,P. Warszawa,2
16390,Arka Gdynia,0
16391,Polonia Bytom,0
16392,Cracovia,0
16393,Ruch Chorzów,1
16394,GKS Bełchatów,2
16395,Śląsk Wrocław,0
16396,Lech Poznań,0
16397,Polonia Bytom,1
16398,Ruch Chorzów,0
16399,Cracovia,0
16400,Arka Gdynia,0
16401,P. Warszawa,0
16402,Lech Poznań,2
16403,Lechia Gdańsk,0
16404,Korona Kielce,3
16405,Widzew Łódź,1
16406,Zagłębie Lubin,0
16407,Polonia Bytom,3
16408,Legia Warszawa,0
16409,Wisła Kraków,1
16410,GKS Bełchatów,0
16411,Korona Kielce,2
16412,Legia Warszawa,1
16413,Śląsk Wrocław,2
16414,P. Warszawa,2
16415,Jagiellonia Białystok,0
16416,Ruch Chorzów,0
16417,Cracovia,0
16418,Śląsk Wrocław,1
16419,Wisła Kraków,1
16420,Lech Poznań,1
16421,Polonia Bytom,1
16422,Polonia Bytom,2
16423,Arka Gdynia,0
16424,Widzew Łódź,1
16425,Zagłębie Lubin,0
16426,Lechia Gdańsk,3
16427,Lech Poznań,0
16428,Śląsk Wrocław,0
16429,Jagiellonia Białystok,1
16430,Korona Kielce,1
16431,Cracovia,0
16432,Widzew Łódź,2
16433,P. Warszawa,0
16434,P. Warszawa,2
16435,GKS Bełchatów,1
16436,Legia Warszawa,1
16437,Arka Gdynia,0
16438,Zagłębie Lubin,1
16439,Wisła Kraków,0
16440,Ruch Chorzów,3
16441,Polonia Bytom,0
16442,Korona Kielce,2
16443,Lechia Gdańsk,0
16444,Zagłębie Lubin,0
16445,Lech Poznań,5
16446,Jagiellonia Białystok,2
16447,GKS Bełchatów,1
16448,Polonia Bytom,1
16449,Wisła Kraków,1
16450,Śląsk Wrocław,0
16451,Korona Kielce,0
16452,Cracovia,0
16453,Polonia Bytom,1
16454,Legia Warszawa,1
16455,Widzew Łódź,1
16456,Jagiellonia Białystok,1
16457,Lechia Gdańsk,1
16458,P. Warszawa,0
16459,Ruch Chorzów,2
16460,GKS Bełchatów,0
16461,Lech Poznań,0
16462,Widzew Łódź,0
16463,Wisła Kraków,2
16464,Podbeskidzie Bielsko-Biała,0
16465,Korona Kielce,1
16466,Zagłębie Lubin,1
16467,Jagiellonia Białystok,0
16468,Widzew Łódź,2
16469,Legia Warszawa,0
16470,P. Warszawa,1
16471,Lechia Gdańsk,0
16472,Cracovia,0
16473,Podbeskidzie Bielsko-Biała,1
16474,Wisła Kraków,0
16475,Legia Warszawa,0
16476,GKS Bełchatów,2
16477,Widzew Łódź,0
16478,Ruch Chorzów,4
16479,Polonia Bytom,1
16480,Lech Poznań,0
16481,Śląsk Wrocław,5
16482,Widzew Łódź,0
16483,Śląsk Wrocław,2
16484,Lechia Gdańsk,0

2025-02-10 12:00:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:32 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:33 - root - INFO - SQL:
SELECT m."id",
          ht."team_long_name" AS "home_team_name",
          at."team_long_name" AS "away_team_name",
          m."home_team_goal",
          m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
   JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
   LIMIT 100;
Results:
id,home_team_name,away_team_name,home_team_goal,away_team_goal
16385,Lechia Gdańsk,Jagiellonia Białystok,1,2
16386,Lech Poznań,Korona Kielce,4,0
16387,Lechia Gdańsk,Zagłębie Lubin,1,2
16388,Polonia Bytom,Widzew Łódź,4,0
16389,Wisła Kraków,P. Warszawa,0,2
16390,Śląsk Wrocław,Arka Gdynia,5,0
16391,Legia Warszawa,Polonia Bytom,4,0
16392,GKS Bełchatów,Cracovia,1,0
16393,Jagiellonia Białystok,Ruch Chorzów,2,1
16394,Legia Warszawa,GKS Bełchatów,0,2
16395,Lechia Gdańsk,Śląsk Wrocław,2,0
16396,Jagiellonia Białystok,Lech Poznań,2,0
16397,Wisła Kraków,Polonia Bytom,2,1
16398,Polonia Bytom,Ruch Chorzów,1,0
16399,Korona Kielce,Cracovia,1,0
16400,Zagłębie Lubin,Arka Gdynia,1,0
16401,Widzew Łódź,P. Warszawa,0,0
16402,Śląsk Wrocław,Lech Poznań,1,2
16403,GKS Bełchatów,Lechia Gdańsk,1,0
16404,P. Warszawa,Korona Kielce,1,3
16405,Arka Gdynia,Widzew Łódź,1,1
16406,Polonia Bytom,Zagłębie Lubin,2,0
16407,Cracovia,Polonia Bytom,2,3
16408,Ruch Chorzów,Legia Warszawa,1,0
16409,Jagiellonia Białystok,Wisła Kraków,2,1
16410,Polonia Bytom,GKS Bełchatów,1,0
16411,Wisła Kraków,Korona Kielce,2,2
16412,Zagłębie Lubin,Legia Warszawa,2,1
16413,Widzew Łódź,Śląsk Wrocław,5,2
16414,Lech Poznań,P. Warszawa,2,2
16415,Arka Gdynia,Jagiellonia Białystok,1,0
16416,Polonia Bytom,Ruch Chorzów,1,0
16417,Lechia Gdańsk,Cracovia,1,0
16418,Korona Kielce,Śląsk Wrocław,2,1
16419,GKS Bełchatów,Wisła Kraków,1,1
16420,Legia Warszawa,Lech Poznań,2,1
16421,Lechia Gdańsk,Polonia Bytom,5,1
16422,P. Warszawa,Polonia Bytom,2,2
16423,Cracovia,Arka Gdynia,2,0
16424,Ruch Chorzów,Widzew Łódź,1,1
16425,Jagiellonia Białystok,Zagłębie Lubin,2,0
16426,Legia Warszawa,Lechia Gdańsk,0,3
16427,GKS Bełchatów,Lech Poznań,1,0
16428,Wisła Kraków,Śląsk Wrocław,0,0
16429,Polonia Bytom,Jagiellonia Białystok,0,1
16430,Ruch Chorzów,Korona Kielce,0,1
16431,Zagłębie Lubin,Cracovia,0,0
16432,Polonia Bytom,Widzew Łódź,2,2
16433,Arka Gdynia,P. Warszawa,0,0
16434,Śląsk Wrocław,P. Warszawa,2,2
16435,Korona Kielce,GKS Bełchatów,3,1
16436,Widzew Łódź,Legia Warszawa,0,1
16437,Lechia Gdańsk,Arka Gdynia,1,0
16438,Lech Poznań,Zagłębie Lubin,0,1
16439,Polonia Bytom,Wisła Kraków,1,0
16440,Cracovia,Ruch Chorzów,2,3
16441,Jagiellonia Białystok,Polonia Bytom,3,0
16442,Cracovia,Korona Kielce,1,2
16443,P. Warszawa,Lechia Gdańsk,1,0
16444,Legia Warszawa,Zagłębie Lubin,3,0
16445,Widzew Łódź,Lech Poznań,0,5
16446,Podbeskidzie Bielsko-Biała,Jagiellonia Białystok,2,2
16447,Ruch Chorzów,GKS Bełchatów,2,1
16448,Śląsk Wrocław,Polonia Bytom,1,1
16449,Widzew Łódź,Wisła Kraków,1,1
16450,GKS Bełchatów,Śląsk Wrocław,3,0
16451,Lech Poznań,Korona Kielce,1,0
16452,Podbeskidzie Bielsko-Biała,Cracovia,1,0
16453,P. Warszawa,Polonia Bytom,1,1
16454,Ruch Chorzów,Legia Warszawa,0,1
16455,Widzew Łódź,Widzew Łódź,0,1
16456,Wisła Kraków,Jagiellonia Białystok,3,1
16457,Zagłębie Lubin,Lechia Gdańsk,0,1
16458,Cracovia,P. Warszawa,0,0
16459,Polonia Bytom,Ruch Chorzów,1,2
16460,Jagiellonia Białystok,GKS Bełchatów,1,0
16461,Lechia Gdańsk,Lech Poznań,0,0
16462,Legia Warszawa,Widzew Łódź,2,0
16463,Widzew Łódź,Wisła Kraków,1,2
16464,Śląsk Wrocław,Podbeskidzie Bielsko-Biała,1,0
16465,Zagłębie Lubin,Korona Kielce,3,1
16466,GKS Bełchatów,Zagłębie Lubin,2,1
16467,Polonia Bytom,Jagiellonia Białystok,2,0
16468,Korona Kielce,Widzew Łódź,0,2
16469,Lech Poznań,Legia Warszawa,0,0
16470,Ruch Chorzów,P. Warszawa,0,1
16471,Śląsk Wrocław,Lechia Gdańsk,1,0
16472,Widzew Łódź,Cracovia,1,0
16473,Wisła Kraków,Podbeskidzie Bielsko-Biała,0,1
16474,Cracovia,Wisła Kraków,1,0
16475,Jagiellonia Białystok,Legia Warszawa,0,0
16476,Korona Kielce,GKS Bełchatów,2,2
16477,Lechia Gdańsk,Widzew Łódź,0,0
16478,Widzew Łódź,Ruch Chorzów,0,4
16479,Podbeskidzie Bielsko-Biała,Polonia Bytom,1,1
16480,P. Warszawa,Lech Poznań,1,0
16481,Zagłębie Lubin,Śląsk Wrocław,1,5
16482,GKS Bełchatów,Widzew Łódź,3,0
16483,Jagiellonia Białystok,Śląsk Wrocław,0,2
16484,Legia Warszawa,Lechia Gdańsk,3,0

2025-02-10 12:00:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-02-10 12:00:34 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:34 - root - INFO - SQL:
SELECT l."name" AS "league_name", COUNT(*) AS "match_count"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
   GROUP BY l."name"
   LIMIT 100;
Results:
league_name,match_count
Germany 1. Bundesliga,2448
Spain LIGA BBVA,3040
France Ligue 1,3040
Netherlands Eredivisie,2448
Scotland Premier League,1824
Switzerland Super League,1422
Belgium Jupiler League,1728
England Premier League,3040
Italy Serie A,3017
Poland Ekstraklasa,1920
Portugal Liga ZON Sagres,2052

2025-02-10 12:00:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:35 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:36 - root - INFO - SQL:
SELECT t."team_long_name" AS "team_name", SUM(m."home_team_goal") AS "total_home_goals"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
Results:
team_name,total_home_goals
SV Zulte-Waregem,176
KSV Roeselare,36
KVC Westerlo,124
Standard de Liège,199
Royal Excel Mouscron,69
Beerschot AC,112
Sporting Charleroi,113
Aston Villa,179
Hull City,79
Fulham,173
Wigan Athletic,106
West Bromwich Albion,177
Blackburn Rovers,98
Queens Park Rangers,60
Cardiff City,20
Bournemouth,23
Girondins de Bordeaux,228
AS Monaco,153
AS Nancy-Lorraine,103
Stade Rennais FC,205
AS Saint-Étienne,223
Grenoble Foot 38,33
Paris Saint-Germain,332
RC Lens,61
Dijon FCO,23
DSC Arminia Bielefeld,16
Hamburger SV,178
VfL Bochum,41
FC St. Pauli,21
FC Augsburg,112
Chievo Verona,144
Milan,271
Sampdoria,190
Lazio,239
AZ,279
PEC Zwolle,124
Arka Gdynia,52
Odra Wodzisław,29
Zagłębie Lubin,116
KV Oostende,62
Le Havre AC,17
LOSC Lille,270
ES Troyes AC,38
En Avant de Guingamp,75
GFC Ajaccio,23
Borussia Mönchengladbach,242
Karlsruher SC,18
Cagliari,181
Roma,299
Napoli,303
Parma,151
N.E.C.,174
FC Volendam,27
Feyenoord,291
PSV,370
Legia Warszawa,240
Lech Poznań,215
Piast Gliwice,115
SC Freiburg,133
Carpi,23
De Graafschap,81
Korona Kielce,149
Podbeskidzie Bielsko-Biała,85
Pogoń Szczecin,85
Górnik Łęczna,43
FC Porto,295
Vitória Guimarães,156
Leixões SC,35
CF Os Belenenses,83
CS Marítimo,171
Académica de Coimbra,136
"União de Leiria, SAD",45
S.C. Olhanense,70
Moreirense FC,53
FC Arouca,56
Uniao da Madeira,19
Falkirk,36
Aberdeen,186
St. Mirren,137
Dundee FC,72
CA Osasuna,137
RC Deportivo de La Coruña,144
Sevilla FC,285
Real Zaragoza,95
CD Tenerife,26
RC Celta de Vigo,105
Elche CF,32
SD Eibar,46
BSC Young Boys,319
Neuchâtel Xamax,106
FC Thun,175
Termalica Bruk-Bet Nieciecza,21
SC Braga,239
Athletic Club de Bilbao,250
Real Valladolid,94
Rayo Vallecano,139
Grasshopper Club Zürich,234
FC Aarau,89
FCV Dender EH,21
Sporting Lokeren,149

2025-02-10 12:00:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:37 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:37 - root - INFO - SQL:
SELECT t."team_long_name" AS "team_name", SUM(m."home_team_goal") AS "total_goals_conceded_as_away_team"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
Results:
team_name,total_goals_conceded_as_away_team
Korona Kielce,144
Zagłębie Lubin,124
Arka Gdynia,68
Podbeskidzie Bielsko-Biała,124
Lech Poznań,119
Legia Warszawa,116
Pogoń Szczecin,82
Górnik Łęczna,42
CF Os Belenenses,114
SC Braga,138
Académica de Coimbra,190
Vitória Guimarães,195
FC Porto,96
S.C. Olhanense,117
"União de Leiria, SAD",67
Moreirense FC,75
Uniao da Madeira,33
Aberdeen,210
Falkirk,60
Sevilla FC,231
RC Deportivo de La Coruña,186
CD Tenerife,45
Real Zaragoza,139
RC Celta de Vigo,118
SD Eibar,65
BSC Young Boys,207
FC Thun,144
Piast Gliwice,147
Termalica Bruk-Bet Nieciecza,24
CS Marítimo,201
Leixões SC,42
FC Arouca,68
St. Mirren,221
Real Valladolid,146
Athletic Club de Bilbao,236
CA Osasuna,202
Elche CF,69
FC Aarau,155
Dundee FC,96
Rayo Vallecano,214
Grasshopper Club Zürich,236
Neuchâtel Xamax,102
Beerschot AC,139
Standard de Liège,152
Sporting Charleroi,155
KVC Westerlo,178
SV Zulte-Waregem,145
Royal Excel Mouscron,85
KSV Roeselare,63
West Bromwich Albion,216
Wigan Athletic,178
Blackburn Rovers,162
Fulham,171
Aston Villa,264
Hull City,133
Queens Park Rangers,122
Cardiff City,39
Bournemouth,33
Paris Saint-Germain,151
LOSC Lille,165
Grenoble Foot 38,57
AS Saint-Étienne,188
Girondins de Bordeaux,197
AS Monaco,140
Le Havre AC,33
AS Nancy-Lorraine,138
Stade Rennais FC,193
RC Lens,96
Dijon FCO,37
ES Troyes AC,84
En Avant de Guingamp,84
Hamburger SV,250
VfL Bochum,56
DSC Arminia Bielefeld,30
Karlsruher SC,32
FC St. Pauli,33
FC Augsburg,131
Lazio,213
Napoli,189
Chievo Verona,220
Sampdoria,215
Milan,184
Cagliari,211
Parma,201
PSV,168
FC Volendam,40
N.E.C.,216
AZ,203
PEC Zwolle,110
Odra Wodzisław,53
KV Oostende,47
GFC Ajaccio,26
Borussia Mönchengladbach,220
SC Freiburg,178
Roma,217
Carpi,31
De Graafschap,137
Feyenoord,196
Widzew Łódź,145
Polonia Bytom,224

2025-02-10 12:00:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:38 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:39 - root - INFO - SQL:
SELECT ht."team_long_name" AS "team_name", COUNT(*) AS "home_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    WHERE m."home_team_goal" > m."away_team_goal"
    GROUP BY ht."team_long_name"
    LIMIT 100;
Results:
team_name,home_wins
KVC Westerlo,35
Royal Excel Mouscron,18
Standard de Liège,66
Sporting Charleroi,35
SV Zulte-Waregem,45
KSV Roeselare,8
Beerschot AC,30
Hull City,21
Fulham,52
Queens Park Rangers,15
Paris Saint-Germain,102
ES Troyes AC,7
Roma,97
Aston Villa,45
Blackburn Rovers,29
West Bromwich Albion,47
Bournemouth,5
AS Monaco,53
RC Lens,19
Dijon FCO,6
GFC Ajaccio,5
SC Freiburg,38
Sampdoria,56
Lazio,81
Feyenoord,86
PSV,105
Piast Gliwice,38
Lech Poznań,74
Arka Gdynia,16
Girondins de Bordeaux,81
LOSC Lille,93
Hamburger SV,55
Borussia Mönchengladbach,71
De Graafschap,18
FC Volendam,6
PEC Zwolle,31
Legia Warszawa,81
Wigan Athletic,28
AZ,82
KV Oostende,17
Le Havre AC,4
Stade Rennais FC,63
Karlsruher SC,5
Napoli,95
Parma,50
AS Nancy-Lorraine,30
AS Saint-Étienne,75
Grenoble Foot 38,10
En Avant de Guingamp,23
DSC Arminia Bielefeld,2
VfL Bochum,7
Chievo Verona,46
Cagliari,52
Odra Wodzisław,10
Korona Kielce,43
FC St. Pauli,4
Milan,92
Cardiff City,5
FC Augsburg,32
Carpi,6
N.E.C.,44
Zagłębie Lubin,35
Podbeskidzie Bielsko-Biała,19
Pogoń Szczecin,26
Górnik Łęczna,12
Termalica Bruk-Bet Nieciecza,5
SC Braga,81
Vitória Guimarães,53
Leixões SC,9
"União de Leiria, SAD",15
FC Arouca,18
Aberdeen,67
Falkirk,9
Sevilla FC,91
Académica de Coimbra,35
FC Porto,102
S.C. Olhanense,19
Uniao da Madeira,6
St. Mirren,34
Dundee FC,16
Athletic Club de Bilbao,80
Real Valladolid,25
CD Tenerife,8
Rayo Vallecano,41
SD Eibar,13
Grasshopper Club Zürich,71
FC Aarau,25
Neuchâtel Xamax,22
RC Celta de Vigo,30
Elche CF,12
FC Thun,44
CF Os Belenenses,22
Moreirense FC,12
CS Marítimo,55
Real Zaragoza,29
BSC Young Boys,85
CA Osasuna,48
RC Deportivo de La Coruña,42
Club Brugge KV,75
FCV Dender EH,5

2025-02-10 12:00:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:40 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:40 - root - INFO - SQL:
SELECT at."team_long_name" AS "team_name", COUNT(*) AS "away_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
    WHERE m."away_team_goal" > m."home_team_goal"
    GROUP BY at."team_long_name"
    LIMIT 100;
Results:
team_name,away_wins
Zagłębie Lubin,24
Lech Poznań,50
Podbeskidzie Bielsko-Biała,23
Legia Warszawa,56
Pogoń Szczecin,16
Piast Gliwice,27
Górnik Łęczna,4
Termalica Bruk-Bet Nieciecza,3
SC Braga,45
Vitória Guimarães,39
Leixões SC,8
"União de Leiria, SAD",8
S.C. Olhanense,13
FC Arouca,10
Aberdeen,53
Falkirk,6
Sevilla FC,48
Académica de Coimbra,21
FC Porto,81
Uniao da Madeira,1
St. Mirren,27
Dundee FC,13
CD Tenerife,1
Rayo Vallecano,25
SD Eibar,7
Neuchâtel Xamax,14
FC Aarau,10
Athletic Club de Bilbao,42
Elche CF,8
FC Thun,27
Korona Kielce,26
CF Os Belenenses,15
Moreirense FC,13
CS Marítimo,30
Real Zaragoza,14
Real Valladolid,12
BSC Young Boys,57
Grasshopper Club Zürich,44
RC Celta de Vigo,24
CA Osasuna,19
RC Deportivo de La Coruña,20
Standard de Liège,40
Royal Excel Mouscron,8
Sporting Charleroi,20
KSV Roeselare,4
SV Zulte-Waregem,33
KVC Westerlo,19
Beerschot AC,10
Hull City,11
Fulham,19
Queens Park Rangers,7
Paris Saint-Germain,73
ES Troyes AC,4
Roma,65
AZ,58
Blackburn Rovers,13
Aston Villa,41
West Bromwich Albion,28
Cardiff City,2
Bournemouth,6
Grenoble Foot 38,5
AS Monaco,42
Stade Rennais FC,48
RC Lens,7
Dijon FCO,3
GFC Ajaccio,3
Hamburger SV,38
SC Freiburg,24
Lazio,50
Sampdoria,28
PSV,73
Feyenoord,53
Arka Gdynia,4
AS Saint-Étienne,46
LOSC Lille,54
En Avant de Guingamp,14
Borussia Mönchengladbach,38
VfL Bochum,6
Karlsruher SC,3
Chievo Verona,41
Cagliari,24
De Graafschap,9
FC Volendam,1
Odra Wodzisław,5
FC St. Pauli,4
PEC Zwolle,18
Wigan Athletic,22
KV Oostende,12
Le Havre AC,3
Napoli,58
AS Nancy-Lorraine,26
Girondins de Bordeaux,45
DSC Arminia Bielefeld,2
FC Augsburg,23
Parma,24
Carpi,3
N.E.C.,24
Milan,62
GKS Bełchatów,20
Polonia Bytom,31

2025-02-10 12:00:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:00:41 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:00:41 - root - INFO - SQL:
SELECT t."team_long_name" AS "team_name",
           SUM(CASE WHEN m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal" THEN 1
                    WHEN m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal" THEN 1
                    ELSE 0 END) AS "total_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id" OR m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
Results:
team_name,total_wins
Beerschot AC,40
SV Zulte-Waregem,78
Standard de Liège,106
KSV Roeselare,12
Royal Excel Mouscron,26
KVC Westerlo,54
Sporting Charleroi,55
KV Oostende,29
Wigan Athletic,50
Blackburn Rovers,42
Hull City,32
Fulham,71
Queens Park Rangers,22
Cardiff City,7
Bournemouth,11
Girondins de Bordeaux,126
Le Havre AC,7
Paris Saint-Germain,175
AS Monaco,95
AS Nancy-Lorraine,56
AS Saint-Étienne,121
Dijon FCO,9
Grenoble Foot 38,15
ES Troyes AC,11
En Avant de Guingamp,37
Karlsruher SC,8
SC Freiburg,62
FC St. Pauli,8
FC Augsburg,55
Lazio,131
Cagliari,76
Chievo Verona,87
Roma,162
Sampdoria,84
Parma,74
Carpi,9
AZ,140
PEC Zwolle,49
Legia Warszawa,137
West Bromwich Albion,75
Aston Villa,86
Stade Rennais FC,111
LOSC Lille,147
RC Lens,26
GFC Ajaccio,8
Hamburger SV,93
DSC Arminia Bielefeld,4
Borussia Mönchengladbach,109
VfL Bochum,13
Milan,154
De Graafschap,27
N.E.C.,68
PSV,178
FC Volendam,7
Odra Wodzisław,15
Arka Gdynia,20
Piast Gliwice,65
Korona Kielce,69
Zagłębie Lubin,59
Napoli,153
Feyenoord,139
Lech Poznań,124
Podbeskidzie Bielsko-Biała,42
Pogoń Szczecin,42
Górnik Łęczna,16
Termalica Bruk-Bet Nieciecza,8
FC Porto,183
CF Os Belenenses,37
Vitória Guimarães,92
SC Braga,126
Académica de Coimbra,56
Leixões SC,17
S.C. Olhanense,32
CS Marítimo,85
"União de Leiria, SAD",23
Moreirense FC,25
FC Arouca,28
Uniao da Madeira,7
Falkirk,15
Dundee FC,29
CA Osasuna,67
RC Deportivo de La Coruña,62
Sevilla FC,139
Real Valladolid,37
Athletic Club de Bilbao,122
Real Zaragoza,43
CD Tenerife,9
Rayo Vallecano,66
RC Celta de Vigo,54
Grasshopper Club Zürich,115
FC Aarau,35
Neuchâtel Xamax,36
FC Thun,71
Aberdeen,120
St. Mirren,61
Elche CF,20
SD Eibar,20
BSC Young Boys,142
Widzew Łódź,48
Polonia Bytom,94

2025-02-10 12:00:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:00:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:00:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:00:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 12:00:43 - snowflake.connector.connection - INFO - closed
2025-02-10 12:00:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:02:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 12:02:10 - root - INFO - ```sql
SELECT
    league_name,
    team_name,
    total_wins
FROM (
    SELECT
        l."name" AS league_name,
        t."team_long_name" AS team_name,
        COUNT(CASE
            WHEN (m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal") OR
                 (m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal")
            THEN 1
            ELSE NULL
        END) AS total_wins,
        ROW_NUMBER() OVER (
            PARTITION BY l."name"
            ORDER BY
                COUNT(CASE
                    WHEN (m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal") OR
                         (m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal")
                    THEN 1
                    ELSE NULL
                END) ASC,
                t."team_long_name" ASC
        ) AS rn
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
    GROUP BY
        l."name",
        t."team_long_name"
) subquery
WHERE
    rn = 1
ORDER BY
    league_name;
```

This query finds, for each league, the single team with the fewest total match wins based on comparing home and away goals, including teams with zero wins. If multiple teams tie for the fewest wins, only one team is returned per league by selecting the team with the alphabetically first name.

**Explanation:**

- The inner query calculates the total number of wins (`total_wins`) for each team in each league.
    - A win is counted when a team is either the home team and scores more goals than the away team, or the away team and scores more goals than the home team.
- The `ROW_NUMBER()` window function partitions the results by league name and orders them by `total_wins` in ascending order and `team_name` in ascending order.
    - This assigns a unique rank to each team within their league based on the fewest wins.
- The outer query selects only the teams where `rn = 1`, which corresponds to the team(s) with the fewest wins in each league.
    - If multiple teams have the same number of wins, only one (the one with the alphabetically first name) is selected due to the ordering in the `ROW_NUMBER()` function.

This simplified query should return the desired results without any issues related to empty data sets.
2025-02-10 12:02:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:02:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:02:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:02:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-02-10 12:02:11 - snowflake.connector.connection - INFO - closed
2025-02-10 12:02:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:03:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 12:03:34 - root - INFO - SQL:
SELECT
    league_name,
    team_name,
    total_wins
FROM (
    SELECT
        l."name" AS league_name,
        t."team_long_name" AS team_name,
        COUNT(CASE
            WHEN (m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal") OR
                 (m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal")
            THEN 1
            ELSE NULL
        END) AS total_wins,
        ROW_NUMBER() OVER (
            PARTITION BY l."name"
            ORDER BY
                COUNT(CASE
                    WHEN (m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal") OR
                         (m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal")
                    THEN 1
                    ELSE NULL
                END) ASC,
                t."team_long_name" ASC
        ) AS rn
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
    GROUP BY
        l."name",
        t."team_long_name"
) subquery
WHERE
    rn = 1
ORDER BY
    league_name;
Results:
LEAGUE_NAME,TEAM_NAME,TOTAL_WINS
Belgium Jupiler League,KAS Eupen,5
England Premier League,Reading,6
France Ligue 1,AC Arles-Avignon,3
Germany 1. Bundesliga,DSC Arminia Bielefeld,4
Italy Serie A,Novara,6
Netherlands Eredivisie,FC Dordrecht,4
Poland Ekstraklasa,Termalica Bruk-Bet Nieciecza,8
Portugal Liga ZON Sagres,FC Penafiel,5
Scotland Premier League,Dunfermline Athletic,5
Spain LIGA BBVA,Córdoba CF,3
Switzerland Super League,Lugano,9

2025-02-10 12:03:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:03:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:03:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:03:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:03:35 - snowflake.connector.connection - INFO - closed
2025-02-10 12:03:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:03:36 - root - INFO - SQL:
-- Corrected SQL 1:

SELECT DISTINCT
    l."name" AS "league_name",
    t."team_long_name" AS "team_name"
FROM
    EU_SOCCER.EU_SOCCER.LEAGUE l
    JOIN EU_SOCCER.EU_SOCCER.MATCH m ON l."id" = m."league_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id"
UNION
SELECT DISTINCT
    l."name" AS "league_name",
    t."team_long_name" AS "team_name"
FROM
    EU_SOCCER.EU_SOCCER.LEAGUE l
    JOIN EU_SOCCER.EU_SOCCER.MATCH m ON l."id" = m."league_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."away_team_api_id"
LIMIT 100
Results:
league_name,team_name
Belgium Jupiler League,KRC Genk
Belgium Jupiler League,KSV Cercle Brugge
Belgium Jupiler League,KAA Gent
Belgium Jupiler League,KV Mechelen
Belgium Jupiler League,Royal Excel Mouscron
Belgium Jupiler League,Lierse SK
Belgium Jupiler League,Waasland-Beveren
England Premier League,Manchester United
England Premier League,Manchester City
England Premier League,Swansea City
France Ligue 1,En Avant de Guingamp
England Premier League,Bolton Wanderers
England Premier League,Burnley
England Premier League,Crystal Palace
France Ligue 1,Le Havre AC
Netherlands Eredivisie,PEC Zwolle
Germany 1. Bundesliga,VfB Stuttgart
England Premier League,Birmingham City
France Ligue 1,AS Nancy-Lorraine
France Ligue 1,RC Lens
Germany 1. Bundesliga,Hertha BSC Berlin
Netherlands Eredivisie,Go Ahead Eagles
Netherlands Eredivisie,NAC Breda
France Ligue 1,Valenciennes FC
Germany 1. Bundesliga,FC Schalke 04
Italy Serie A,Roma
Italy Serie A,Juventus
Belgium Jupiler League,KSV Roeselare
Belgium Jupiler League,Oud-Heverlee Leuven
Netherlands Eredivisie,FC Twente
France Ligue 1,AC Ajaccio
Netherlands Eredivisie,Feyenoord
England Premier League,Blackpool
England Premier League,Cardiff City
Germany 1. Bundesliga,Bayer 04 Leverkusen
England Premier League,Wolverhampton Wanderers
France Ligue 1,FC Lorient
Poland Ekstraklasa,Wisła Kraków
Poland Ekstraklasa,Legia Warszawa
England Premier League,Middlesbrough
Netherlands Eredivisie,Roda JC Kerkrade
England Premier League,Leicester City
Germany 1. Bundesliga,FC Augsburg
Italy Serie A,Sampdoria
Poland Ekstraklasa,Polonia Bytom
Italy Serie A,Parma
Belgium Jupiler League,Beerschot AC
Italy Serie A,Catania
Netherlands Eredivisie,Sparta Rotterdam
Netherlands Eredivisie,ADO Den Haag
Poland Ekstraklasa,Odra Wodzisław
Belgium Jupiler League,FCV Dender EH
England Premier League,Bournemouth
France Ligue 1,Paris Saint-Germain
England Premier League,Newcastle United
Poland Ekstraklasa,Cracovia
Poland Ekstraklasa,Korona Kielce
Belgium Jupiler League,KAS Eupen
Italy Serie A,Chievo Verona
Italy Serie A,Carpi
Italy Serie A,Brescia
Belgium Jupiler League,Sint-Truidense VV
Italy Serie A,Livorno
Netherlands Eredivisie,Vitesse
Netherlands Eredivisie,AZ
France Ligue 1,LOSC Lille
Germany 1. Bundesliga,DSC Arminia Bielefeld
Germany 1. Bundesliga,SV Darmstadt 98
Netherlands Eredivisie,FC Dordrecht
France Ligue 1,SM Caen
France Ligue 1,FC Metz
Poland Ekstraklasa,Widzew Łódź
France Ligue 1,SC Bastia
Germany 1. Bundesliga,Hamburger SV
Italy Serie A,Reggio Calabria
Netherlands Eredivisie,FC Volendam
France Ligue 1,Olympique de Marseille
Netherlands Eredivisie,N.E.C.
England Premier League,Arsenal
Italy Serie A,Siena
Italy Serie A,Cesena
Italy Serie A,Lazio
Italy Serie A,Hellas Verona
Poland Ekstraklasa,Śląsk Wrocław
Poland Ekstraklasa,Ruch Chorzów
Poland Ekstraklasa,GKS Bełchatów
Italy Serie A,Frosinone
Poland Ekstraklasa,Lech Poznań
Poland Ekstraklasa,Jagiellonia Białystok
Poland Ekstraklasa,Zagłębie Lubin
France Ligue 1,ES Troyes AC
Netherlands Eredivisie,FC Utrecht
England Premier League,West Bromwich Albion
Germany 1. Bundesliga,FC St. Pauli
Italy Serie A,Torino
Italy Serie A,Cagliari
Italy Serie A,Fiorentina
Germany 1. Bundesliga,Eintracht Frankfurt
Netherlands Eredivisie,PSV
Netherlands Eredivisie,RKC Waalwijk

2025-02-10 12:03:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:03:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:03:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:03:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:03:37 - snowflake.connector.connection - INFO - closed
2025-02-10 12:03:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:03:37 - root - INFO - SQL:
-- Corrected SQL 2:

SELECT
    t."team_long_name" AS "team_name",
    COUNT(*) AS "total_matches"
FROM
    EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
GROUP BY
    t."team_long_name"
LIMIT 100
Results:
team_name,total_matches
Lech Poznań,240
Korona Kielce,210
Zagłębie Lubin,180
Arka Gdynia,90
Legia Warszawa,240
Podbeskidzie Bielsko-Biała,150
Piast Gliwice,180
Pogoń Szczecin,120
Górnik Łęczna,60
Vitória Guimarães,248
Académica de Coimbra,248
Leixões SC,60
S.C. Olhanense,150
CS Marítimo,248
Moreirense FC,98
FC Arouca,98
Falkirk,76
Dundee FC,114
RC Deportivo de La Coruña,228
Sevilla FC,304
Real Valladolid,152
Athletic Club de Bilbao,304
Real Zaragoza,152
Rayo Vallecano,190
FC Aarau,144
FC Thun,214
Termalica Bruk-Bet Nieciecza,30
FC Porto,248
CF Os Belenenses,158
SC Braga,248
"União de Leiria, SAD",90
Uniao da Madeira,34
CA Osasuna,228
CD Tenerife,38
RC Celta de Vigo,152
BSC Young Boys,286
Neuchâtel Xamax,126
Aberdeen,304
St. Mirren,266
Elche CF,76
SD Eibar,76
Grasshopper Club Zürich,286
Beerschot AC,152
SV Zulte-Waregem,212
Standard de Liège,212
KSV Roeselare,62
Royal Excel Mouscron,94
KVC Westerlo,182
Sporting Charleroi,182
KV Oostende,66
West Bromwich Albion,266
Wigan Athletic,190
Blackburn Rovers,152
Hull City,152
Fulham,228
Queens Park Rangers,114
Cardiff City,38
Bournemouth,38
Girondins de Bordeaux,304
Le Havre AC,38
Paris Saint-Germain,304
AS Monaco,228
AS Nancy-Lorraine,190
Stade Rennais FC,304
AS Saint-Étienne,304
Dijon FCO,38
Grenoble Foot 38,76
RC Lens,114
ES Troyes AC,76
En Avant de Guingamp,114
GFC Ajaccio,38
DSC Arminia Bielefeld,34
Karlsruher SC,34
VfL Bochum,68
SC Freiburg,204
FC St. Pauli,34
FC Augsburg,170
Lazio,301
Cagliari,264
Chievo Verona,303
Roma,303
Sampdoria,266
Parma,226
Carpi,38
De Graafschap,136
PSV,272
FC Volendam,34
AZ,272
PEC Zwolle,136
Aston Villa,304
LOSC Lille,304
Hamburger SV,272
Borussia Mönchengladbach,272
Milan,303
N.E.C.,238
Feyenoord,272
Odra Wodzisław,60
Napoli,301
Widzew Łódź,180
Polonia Bytom,300

2025-02-10 12:03:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:03:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:03:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:03:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:03:38 - snowflake.connector.connection - INFO - closed
2025-02-10 12:03:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:03:39 - root - INFO - SQL:
-- Corrected SQL 3:

SELECT
    team_name,
    AVG(goals_scored) AS "average_goals_per_match"
FROM
    (
        SELECT t."team_long_name" AS team_name, m."home_team_goal" AS goals_scored
        FROM EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id"
        UNION ALL
        SELECT t."team_long_name" AS team_name, m."away_team_goal" AS goals_scored
        FROM EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."away_team_api_id"
    ) sub
GROUP BY
    team_name
LIMIT 100
Results:
TEAM_NAME,average_goals_per_match
SV Zulte-Waregem,1.443396
KSV Roeselare,1.000000
KVC Westerlo,1.192308
Standard de Liège,1.608491
Royal Excel Mouscron,1.202128
Beerschot AC,1.144737
Sporting Charleroi,1.104396
KV Oostende,1.545455
Aston Villa,1.101974
Hull City,0.947368
Fulham,1.162281
Blackburn Rovers,1.151316
Wigan Athletic,1.052632
West Bromwich Albion,1.146617
Queens Park Rangers,1.008772
Cardiff City,0.842105
Bournemouth,1.184211
Girondins de Bordeaux,1.328947
AS Monaco,1.258772
Stade Rennais FC,1.207237
LOSC Lille,1.480263
Grenoble Foot 38,0.723684
AS Nancy-Lorraine,1.068421
Dijon FCO,1.000000
En Avant de Guingamp,1.070175
GFC Ajaccio,0.973684
SC Freiburg,1.200980
FC St. Pauli,1.029412
FC Augsburg,1.182353
Cagliari,1.170455
Chievo Verona,0.940594
Roma,1.749175
Sampdoria,1.195489
Napoli,1.707641
Parma,1.203540
Carpi,0.973684
N.E.C.,1.302521
FC Volendam,1.117647
AZ,1.808824
Feyenoord,1.797794
PSV,2.397059
PEC Zwolle,1.500000
Zagłębie Lubin,1.150000
Le Havre AC,0.789474
AS Saint-Étienne,1.220395
Paris Saint-Germain,1.868421
RC Lens,0.938596
ES Troyes AC,0.934211
DSC Arminia Bielefeld,0.852941
Borussia Mönchengladbach,1.481618
Karlsruher SC,0.882353
Hamburger SV,1.264706
VfL Bochum,1.058824
Milan,1.636964
Lazio,1.385382
De Graafschap,0.955882
Legia Warszawa,1.704167
Lech Poznań,1.550000
Arka Gdynia,0.855556
Piast Gliwice,1.133333
Korona Kielce,1.128571
Odra Wodzisław,0.833333
Podbeskidzie Bielsko-Biała,1.126667
Pogoń Szczecin,1.266667
Górnik Łęczna,1.016667
Termalica Bruk-Bet Nieciecza,1.100000
FC Porto,2.181452
Vitória Guimarães,1.209677
Leixões SC,0.916667
CF Os Belenenses,0.936709
CS Marítimo,1.274194
Académica de Coimbra,0.967742
"União de Leiria, SAD",0.944444
S.C. Olhanense,0.920000
SC Braga,1.604839
FC Arouca,1.030612
Uniao da Madeira,0.794118
Falkirk,0.894737
St. Mirren,0.966165
Aberdeen,1.200658
CA Osasuna,1.017544
RC Deportivo de La Coruña,1.057018
Athletic Club de Bilbao,1.365132
Real Valladolid,1.118421
Real Zaragoza,1.046053
CD Tenerife,1.052632
Rayo Vallecano,1.300000
RC Celta de Vigo,1.210526
SD Eibar,1.092105
FC Aarau,1.062500
Moreirense FC,1.030612
Dundee FC,1.114035
Sevilla FC,1.572368
BSC Young Boys,1.849650
Neuchâtel Xamax,1.357143
FC Thun,1.303738
Elche CF,0.855263
Grasshopper Club Zürich,1.500000
FCV Dender EH,1.294118
Club Brugge KV,1.985849

2025-02-10 12:03:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:03:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:03:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:03:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:03:40 - snowflake.connector.connection - INFO - closed
2025-02-10 12:03:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:03:40 - root - INFO - SQL:
-- Corrected SQL 4:

SELECT
    m."id",
    ht."team_long_name" AS "home_team",
    at."team_long_name" AS "away_team",
    m."home_team_goal",
    m."away_team_goal"
FROM
    EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
WHERE
    m."home_team_goal" > m."away_team_goal"
LIMIT 100
Results:
id,home_team,away_team,home_team_goal,away_team_goal
4,KAA Gent,RAEC Mons,5,0
9,KVC Westerlo,Sporting Charleroi,1,0
10,Club Brugge KV,KV Kortrijk,4,1
22,KSV Cercle Brugge,SV Zulte-Waregem,2,0
26,KVC Westerlo,KRC Genk,1,0
32,FCV Dender EH,KV Kortrijk,1,0
34,Royal Excel Mouscron,Sporting Charleroi,2,1
35,Tubize,KSV Cercle Brugge,3,0
36,KVC Westerlo,KAA Gent,3,2
37,RSC Anderlecht,KVC Westerlo,2,0
38,Standard de Liège,Royal Excel Mouscron,3,1
40,Sporting Charleroi,Tubize,3,2
41,KSV Cercle Brugge,KV Mechelen,2,1
44,KV Kortrijk,SV Zulte-Waregem,1,0
46,Club Brugge KV,Beerschot AC,3,0
47,KRC Genk,KSV Cercle Brugge,3,2
48,SV Zulte-Waregem,Sporting Charleroi,4,2
49,KAA Gent,KSV Roeselare,4,0
52,Royal Excel Mouscron,Sporting Lokeren,2,0
54,KVC Westerlo,RAEC Mons,2,1
55,RSC Anderlecht,Tubize,5,1
57,RAEC Mons,FCV Dender EH,5,2
59,KSV Cercle Brugge,KAA Gent,3,1
60,Sporting Lokeren,Club Brugge KV,2,0
61,KSV Roeselare,KVC Westerlo,1,0
62,KV Kortrijk,KRC Genk,3,1
63,Beerschot AC,Royal Excel Mouscron,3,0
65,KRC Genk,Sporting Charleroi,1,0
66,SV Zulte-Waregem,Royal Excel Mouscron,2,1
69,KV Mechelen,Beerschot AC,2,1
71,Tubize,RAEC Mons,2,1
73,RSC Anderlecht,KRC Genk,2,0
74,Standard de Liège,KAA Gent,2,1
76,Sporting Charleroi,FCV Dender EH,2,0
77,KSV Cercle Brugge,KSV Roeselare,4,3
79,Royal Excel Mouscron,Club Brugge KV,5,1
81,Beerschot AC,Tubize,2,0
82,Beerschot AC,KRC Genk,4,1
83,Sporting Lokeren,SV Zulte-Waregem,2,1
86,Standard de Liège,FCV Dender EH,3,2
87,Club Brugge KV,KV Mechelen,3,0
88,KV Kortrijk,KSV Roeselare,2,1
91,SV Zulte-Waregem,Club Brugge KV,3,1
94,KRC Genk,RAEC Mons,2,0
95,KSV Roeselare,Sporting Charleroi,3,1
96,Tubize,Sporting Lokeren,2,1
100,Club Brugge KV,SV Zulte-Waregem,2,0
102,Standard de Liège,KVC Westerlo,3,0
103,RAEC Mons,KRC Genk,3,1
104,Sporting Charleroi,KSV Roeselare,1,0
105,Sporting Lokeren,Tubize,4,1
106,Royal Excel Mouscron,KV Mechelen,3,1
107,KV Kortrijk,KSV Cercle Brugge,2,1
115,Standard de Liège,KSV Roeselare,3,0
116,Club Brugge KV,Tubize,3,1
117,Beerschot AC,KVC Westerlo,2,1
120,RSC Anderlecht,RAEC Mons,3,2
123,KVC Westerlo,Sporting Lokeren,1,0
125,KAA Gent,Royal Excel Mouscron,2,0
131,SV Zulte-Waregem,FCV Dender EH,1,0
132,Sporting Lokeren,KSV Roeselare,2,1
134,Standard de Liège,Tubize,4,0
137,RSC Anderlecht,Standard de Liège,4,2
138,KSV Roeselare,RAEC Mons,3,2
146,KV Mechelen,KRC Genk,2,1
147,Sporting Charleroi,RAEC Mons,3,0
148,Standard de Liège,KSV Cercle Brugge,4,0
150,Club Brugge KV,KSV Roeselare,2,1
151,Beerschot AC,KV Kortrijk,3,0
152,FCV Dender EH,Tubize,4,0
156,RSC Anderlecht,SV Zulte-Waregem,2,0
158,KRC Genk,FCV Dender EH,4,3
160,KSV Roeselare,Royal Excel Mouscron,2,0
161,KAA Gent,Tubize,2,0
163,KV Mechelen,RSC Anderlecht,2,1
164,Standard de Liège,KRC Genk,2,0
165,Beerschot AC,RAEC Mons,2,0
167,FCV Dender EH,KSV Cercle Brugge,1,0
170,Royal Excel Mouscron,KV Kortrijk,1,0
173,Sporting Charleroi,Standard de Liège,1,0
174,KAA Gent,SV Zulte-Waregem,1,0
176,KVC Westerlo,FCV Dender EH,3,1
177,KSV Roeselare,KV Mechelen,1,0
179,KRC Genk,Tubize,3,0
180,RSC Anderlecht,Beerschot AC,2,0
182,Royal Excel Mouscron,RAEC Mons,3,2
183,Club Brugge KV,Sporting Charleroi,2,1
184,SV Zulte-Waregem,KSV Cercle Brugge,3,1
189,Standard de Liège,Beerschot AC,3,1
190,RSC Anderlecht,Club Brugge KV,1,0
191,KSV Roeselare,KRC Genk,1,0
193,Standard de Liège,Sporting Lokeren,1,0
196,Sporting Charleroi,Royal Excel Mouscron,1,0
197,KSV Cercle Brugge,Tubize,4,1
198,KAA Gent,KVC Westerlo,2,0
199,RSC Anderlecht,KV Kortrijk,4,0
200,KRC Genk,Sporting Lokeren,1,0
201,KSV Cercle Brugge,RAEC Mons,2,1
202,KAA Gent,Sporting Charleroi,2,0
207,KVC Westerlo,Beerschot AC,1,0

2025-02-10 12:03:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:03:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:03:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:03:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 12:03:41 - snowflake.connector.connection - INFO - closed
2025-02-10 12:03:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:03:42 - root - INFO - SQL:
-- Corrected SQL 5:

SELECT
    m."id",
    ht."team_long_name" AS "home_team",
    at."team_long_name" AS "away_team",
    m."home_team_goal",
    m."away_team_goal"
FROM
    EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
WHERE
    m."away_team_goal" > m."home_team_goal"
LIMIT 100
Results:
id,home_team,away_team,home_team_goal,away_team_goal
16385,Lechia Gdańsk,Jagiellonia Białystok,1,2
16387,Lechia Gdańsk,Zagłębie Lubin,1,2
16389,Wisła Kraków,P. Warszawa,0,2
16394,Legia Warszawa,GKS Bełchatów,0,2
16402,Śląsk Wrocław,Lech Poznań,1,2
16404,P. Warszawa,Korona Kielce,1,3
16407,Cracovia,Polonia Bytom,2,3
16426,Legia Warszawa,Lechia Gdańsk,0,3
16429,Polonia Bytom,Jagiellonia Białystok,0,1
16430,Ruch Chorzów,Korona Kielce,0,1
16436,Widzew Łódź,Legia Warszawa,0,1
16438,Lech Poznań,Zagłębie Lubin,0,1
16440,Cracovia,Ruch Chorzów,2,3
16442,Cracovia,Korona Kielce,1,2
16445,Widzew Łódź,Lech Poznań,0,5
16454,Ruch Chorzów,Legia Warszawa,0,1
16455,Widzew Łódź,Widzew Łódź,0,1
16457,Zagłębie Lubin,Lechia Gdańsk,0,1
16459,Polonia Bytom,Ruch Chorzów,1,2
16463,Widzew Łódź,Wisła Kraków,1,2
16468,Korona Kielce,Widzew Łódź,0,2
16470,Ruch Chorzów,P. Warszawa,0,1
16473,Wisła Kraków,Podbeskidzie Bielsko-Biała,0,1
16478,Widzew Łódź,Ruch Chorzów,0,4
16481,Zagłębie Lubin,Śląsk Wrocław,1,5
16483,Jagiellonia Białystok,Śląsk Wrocław,0,2
16488,Wisła Kraków,Polonia Bytom,0,1
16493,Lech Poznań,Widzew Łódź,0,1
16496,Śląsk Wrocław,Wisła Kraków,0,1
16499,Polonia Bytom,Śląsk Wrocław,0,2
16500,Jagiellonia Białystok,Podbeskidzie Bielsko-Biała,0,2
16503,Lechia Gdańsk,P. Warszawa,1,3
16505,Zagłębie Lubin,Legia Warszawa,0,4
16507,Lechia Gdańsk,Jagiellonia Białystok,0,1
16509,Widzew Łódź,Śląsk Wrocław,1,2
16513,Wisła Kraków,P. Warszawa,0,1
16517,Lech Poznań,GKS Bełchatów,0,1
16518,Widzew Łódź,P. Warszawa,0,2
16520,Widzew Łódź,Podbeskidzie Bielsko-Biała,0,1
16526,P. Warszawa,Widzew Łódź,1,2
16528,Śląsk Wrocław,Legia Warszawa,0,4
16529,Wisła Kraków,Korona Kielce,0,1
16530,Cracovia,Legia Warszawa,1,3
16538,Cracovia,Zagłębie Lubin,0,2
16540,Jagiellonia Białystok,Ruch Chorzów,0,1
16543,Lechia Gdańsk,Wisła Kraków,0,2
16548,Podbeskidzie Bielsko-Biała,Legia Warszawa,0,1
16550,Śląsk Wrocław,Korona Kielce,1,2
16562,Cracovia,Polonia Bytom,1,3
16566,Lechia Gdańsk,Podbeskidzie Bielsko-Biała,2,3
16568,Widzew Łódź,Zagłębie Lubin,1,2
16570,GKS Bełchatów,Lechia Gdańsk,1,3
16573,Podbeskidzie Bielsko-Biała,Widzew Łódź,0,1
16575,Widzew Łódź,Ruch Chorzów,1,2
16582,Lechia Gdańsk,Zagłębie Lubin,0,1
16587,Korona Kielce,Zagłębie Lubin,0,2
16597,Legia Warszawa,Lech Poznań,0,1
16598,Widzew Łódź,Korona Kielce,0,2
16599,Podbeskidzie Bielsko-Biała,Wisła Kraków,1,3
16600,P. Warszawa,Ruch Chorzów,0,1
16602,GKS Bełchatów,Korona Kielce,0,2
16608,Widzew Łódź,Lechia Gdańsk,0,1
16610,Cracovia,Ruch Chorzów,0,2
16612,Korona Kielce,Widzew Łódź,0,2
16616,P. Warszawa,Zagłębie Lubin,0,4
16618,GKS Bełchatów,Lech Poznań,0,3
16624,Ruch Chorzów,Śląsk Wrocław,0,1
16632,Wisła Kraków,Śląsk Wrocław,0,1
16639,Legia Warszawa,Śląsk Wrocław,1,2
3,KSV Cercle Brugge,RSC Anderlecht,0,3
5,FCV Dender EH,Standard de Liège,1,3
8,Tubize,Royal Excel Mouscron,1,2
11,Standard de Liège,Sporting Charleroi,1,2
12,SV Zulte-Waregem,KAA Gent,0,2
15,KV Mechelen,KSV Roeselare,1,2
16,Royal Excel Mouscron,KSV Cercle Brugge,0,1
17,Tubize,KRC Genk,1,3
18,Beerschot AC,RSC Anderlecht,1,3
19,RSC Anderlecht,Sporting Lokeren,2,3
24,KSV Roeselare,Tubize,1,2
27,Beerschot AC,Standard de Liège,1,3
39,RAEC Mons,Club Brugge KV,1,2
42,KAA Gent,KRC Genk,2,3
45,Beerschot AC,Sporting Lokeren,0,2
50,FCV Dender EH,RSC Anderlecht,0,2
56,Standard de Liège,SV Zulte-Waregem,1,2
58,Sporting Charleroi,KV Mechelen,1,2
64,Club Brugge KV,Standard de Liège,1,4
70,KSV Roeselare,RSC Anderlecht,0,3
72,KVC Westerlo,KSV Cercle Brugge,1,2
84,RSC Anderlecht,KSV Cercle Brugge,1,2
85,RAEC Mons,KAA Gent,1,2
90,Sporting Charleroi,KVC Westerlo,1,2
92,KAA Gent,RSC Anderlecht,1,2
93,KVC Westerlo,Standard de Liège,0,1
98,KSV Cercle Brugge,KV Kortrijk,0,1
99,FCV Dender EH,Beerschot AC,0,1
109,KV Kortrijk,RSC Anderlecht,1,3
110,Sporting Lokeren,KRC Genk,1,2
112,Sporting Charleroi,KAA Gent,2,5

2025-02-10 12:03:42 - root - INFO - itercount: 0
2025-02-10 12:03:42 - root - INFO - Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,0
table_name,PLAYER
description,
DDL,"create or replace TABLE PLAYER (
	""id"" NUMBER(38,0),
	""player_api_id"" NUMBER(38,0),
	""player_name"" VARCHAR(16777216),
	""player_fifa_api_id"" NUMBER(38,0),
	""birthday"" VARCHAR(16777216),
	""height"" FLOAT,
	""weight"" NUMBER(38,0)
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,1
table_name,COUNTRY
description,
DDL,"create or replace TABLE COUNTRY (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,2
table_name,PLAYER_ATTRIBUTES
description,
DDL,"create or replace TABLE PLAYER_ATTRIBUTES (
	""id"" NUMBER(38,0),
	""player_fifa_api_id"" NUMBER(38,0),
	""player_api_id"" NUMBER(38,0),
	""date"" VARCHAR(16777216),
	""overall_rating"" FLOAT,
	""potential"" FLOAT,
	""preferred_foot"" VARCHAR(16777216),
	""attacking_work_rate"" VARCHAR(16777216),
	""defensive_work_rate"" VARCHAR(16777216),
	""crossing"" FLOAT,
	""finishing"" FLOAT,
	""heading_accuracy"" FLOAT,
	""short_passing"" FLOAT,
	""volleys"" FLOAT,
	""dribbling"" FLOAT,
	""curve"" FLOAT,
	""free_kick_accuracy"" FLOAT,
	""long_passing"" FLOAT,
	""ball_control"" FLOAT,
	""acceleration"" FLOAT,
	""sprint_speed"" FLOAT,
	""agility"" FLOAT,
	""reactions"" FLOAT,
	""balance"" FLOAT,
	""shot_power"" FLOAT,
	""jumping"" FLOAT,
	""stamina"" FLOAT,
	""strength"" FLOAT,
	""long_shots"" FLOAT,
	""aggression"" FLOAT,
	""interceptions"" FLOAT,
	""positioning"" FLOAT,
	""vision"" FLOAT,
	""penalties"" FLOAT,
	""marking"" FLOAT,
	""standing_tackle"" FLOAT,
	""sliding_tackle"" FLOAT,
	""gk_diving"" FLOAT,
	""gk_handling"" FLOAT,
	""gk_kicking"" FLOAT,
	""gk_positioning"" FLOAT,
	""gk_reflexes"" FLOAT
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,3
table_name,SQLITE_SEQUENCE
description,
DDL,"create or replace TABLE SQLITE_SEQUENCE (
	""name"" VARCHAR(16777216),
	""seq"" NUMBER(38,0)
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,4
table_name,LEAGUE
description,
DDL,"create or replace TABLE LEAGUE (
	""id"" NUMBER(38,0),
	""country_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,5
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""id"" NUMBER(38,0),
	""country_id"" NUMBER(38,0),
	""league_id"" NUMBER(38,0),
	""season"" VARCHAR(16777216),
	""stage"" NUMBER(38,0),
	""date"" VARCHAR(16777216),
	""match_api_id"" NUMBER(38,0),
	""home_team_api_id"" NUMBER(38,0),
	""away_team_api_id"" NUMBER(38,0),
	""home_team_goal"" NUMBER(38,0),
	""away_team_goal"" NUMBER(38,0),
	""home_player_X1"" FLOAT,
	""home_player_X2"" FLOAT,
	""home_player_X3"" FLOAT,
	""home_player_X4"" FLOAT,
	""home_player_X5"" FLOAT,
	""home_player_X6"" FLOAT,
	""home_player_X7"" FLOAT,
	""home_player_X8"" FLOAT,
	""home_player_X9"" FLOAT,
	""home_player_X10"" FLOAT,
	""home_player_X11"" FLOAT,
	""away_player_X1"" FLOAT,
	""away_player_X2"" FLOAT,
	""away_player_X3"" FLOAT,
	""away_player_X4"" FLOAT,
	""away_player_X5"" FLOAT,
	""away_player_X6"" FLOAT,
	""away_player_X7"" FLOAT,
	""away_player_X8"" FLOAT,
	""away_player_X9"" FLOAT,
	""away_player_X10"" FLOAT,
	""away_player_X11"" FLOAT,
	""home_player_Y1"" FLOAT,
	""home_player_Y2"" FLOAT,
	""home_player_Y3"" FLOAT,
	""home_player_Y4"" FLOAT,
	""home_player_Y5"" FLOAT,
	""home_player_Y6"" FLOAT,
	""home_player_Y7"" FLOAT,
	""home_player_Y8"" FLOAT,
	""home_player_Y9"" FLOAT,
	""home_player_Y10"" FLOAT,
	""home_player_Y11"" FLOAT,
	""away_player_Y1"" FLOAT,
	""away_player_Y2"" FLOAT,
	""away_player_Y3"" FLOAT,
	""away_player_Y4"" FLOAT,
	""away_player_Y5"" FLOAT,
	""away_player_Y6"" FLOAT,
	""away_player_Y7"" FLOAT,
	""away_player_Y8"" FLOAT,
	""away_player_Y9"" FLOAT,
	""away_player_Y10"" FLOAT,
	""away_player_Y11"" FLOAT,
	""home_player_1"" FLOAT,
	""home_player_2"" FLOAT,
	""home_player_3"" FLOAT,
	""home_player_4"" FLOAT,
	""home_player_5"" FLOAT,
	""home_player_6"" FLOAT,
	""home_player_7"" FLOAT,
	""home_player_8"" FLOAT,
	""home_player_9"" FLOAT,
	""home_player_10"" FLOAT,
	""home_player_11"" FLOAT,
	""away_player_1"" FLOAT,
	""away_player_2"" FLOAT,
	""away_player_3"" FLOAT,
	""away_player_4"" FLOAT,
	""away_player_5"" FLOAT,
	""away_player_6"" FLOAT,
	""away_player_7"" FLOAT,
	""away_player_8"" FLOAT,
	""away_player_9"" FLOAT,
	""away_player_10"" FLOAT,
	""away_player_11"" FLOAT,
	""goal"" VARCHAR(16777216),
	""shoton"" VARCHAR(16777216),
	""shotoff"" VARCHAR(16777216),
	""foulcommit"" VARCHAR(16777216),
	""card"" VARCHAR(16777216),
	""cross"" VARCHAR(16777216),
	""corner"" VARCHAR(16777216),
	""possession"" VARCHAR(16777216),
	B365H FLOAT,
	B365D FLOAT,
	B365A FLOAT,
	BWH FLOAT,
	BWD FLOAT,
	BWA FLOAT,
	IWH FLOAT,
	IWD FLOAT,
	IWA FLOAT,
	LBH FLOAT,
	LBD FLOAT,
	LBA FLOAT,
	PSH FLOAT,
	PSD FLOAT,
	PSA FLOAT,
	WHH FLOAT,
	WHD FLOAT,
	WHA FLOAT,
	SJH FLOAT,
	SJD FLOAT,
	SJA FLOAT,
	VCH FLOAT,
	VCD FLOAT,
	VCA FLOAT,
	GBH FLOAT,
	GBD FLOAT,
	GBA FLOAT,
	BSH FLOAT,
	BSD FLOAT,
	BSA FLOAT
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,6
table_name,TEAM
description,
DDL,"create or replace TABLE TEAM (
	""id"" NUMBER(38,0),
	""team_api_id"" NUMBER(38,0),
	""team_fifa_api_id"" FLOAT,
	""team_long_name"" VARCHAR(16777216),
	""team_short_name"" VARCHAR(16777216)
);"

Database Name: EU_SOCCER
Schema Name: EU_SOCCER
,7
table_name,TEAM_ATTRIBUTES
description,
DDL,"create or replace TABLE TEAM_ATTRIBUTES (
	""id"" NUMBER(38,0),
	""team_fifa_api_id"" NUMBER(38,0),
	""team_api_id"" NUMBER(38,0),
	""date"" VARCHAR(16777216),
	""buildUpPlaySpeed"" NUMBER(38,0),
	""buildUpPlaySpeedClass"" VARCHAR(16777216),
	""buildUpPlayDribbling"" FLOAT,
	""buildUpPlayDribblingClass"" VARCHAR(16777216),
	""buildUpPlayPassing"" NUMBER(38,0),
	""buildUpPlayPassingClass"" VARCHAR(16777216),
	""buildUpPlayPositioningClass"" VARCHAR(16777216),
	""chanceCreationPassing"" NUMBER(38,0),
	""chanceCreationPassingClass"" VARCHAR(16777216),
	""chanceCreationCrossing"" NUMBER(38,0),
	""chanceCreationCrossingClass"" VARCHAR(16777216),
	""chanceCreationShooting"" NUMBER(38,0),
	""chanceCreationShootingClass"" VARCHAR(16777216),
	""chanceCreationPositioningClass"" VARCHAR(16777216),
	""defencePressure"" NUMBER(38,0),
	""defencePressureClass"" VARCHAR(16777216),
	""defenceAggression"" NUMBER(38,0),
	""defenceAggressionClass"" VARCHAR(16777216),
	""defenceTeamWidth"" NUMBER(38,0),
	""defenceTeamWidthClass"" VARCHAR(16777216),
	""defenceDefenderLineClass"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'EU_SOCCER': {'EU_SOCCER': ['PLAYER', 'COUNTRY', 'PLAYER_ATTRIBUTES', 'SQLITE_SEQUENCE', 'LEAGUE', 'MATCH', 'TEAM', 'TEAM_ATTRIBUTES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **LEAGUE Table:**
  - `"id"`: Unique identifier for each league. Used to join with `MATCH."league_id"`.
  - `"name"`: Name of the league. Useful for displaying league names in results.

- **TEAM Table:**
  - `"team_api_id"`: Unique identifier for each team. Used to join with `MATCH."home_team_api_id"` and `MATCH."away_team_api_id"`.
  - `"team_long_name"`: Full name of the team. Useful for displaying team names in results.

- **MATCH Table:**
  - `"league_id"`: Foreign key linking to `LEAGUE."id"`. Used to associate matches with their respective leagues.
  - `"home_team_api_id"`: Identifier for the home team. Used to join with `TEAM."team_api_id"`.
  - `"away_team_api_id"`: Identifier for the away team. Used to join with `TEAM."team_api_id"`.
  - `"home_team_goal"`: Number of goals scored by the home team. Used to determine match outcomes.
  - `"away_team_goal"`: Number of goals scored by the away team. Used to determine match outcomes.

**Conditions That May Be Used:**

- Comparing `"home_team_goal"` and `"away_team_goal"` to determine match winners.
- Joining `MATCH` with `TEAM` and `LEAGUE` tables to access team and league names.
- Grouping by `LEAGUE` and `TEAM` to calculate total wins per team in each league.
- Including teams with zero wins by considering all teams in each league.
- If multiple teams tie for fewest wins, selecting only one team per league.

---

**Sample SQL Queries:**

1. **List all leagues:**

   ```sql
   SELECT "id", "name"
   FROM EU_SOCCER.EU_SOCCER.LEAGUE
   LIMIT 100;
   ```

2. **List all teams:**

   ```sql
   SELECT "team_api_id", "team_long_name"
   FROM EU_SOCCER.EU_SOCCER.TEAM
   LIMIT 100;
   ```

3. **Display basic match information:**

   ```sql
   SELECT "id", "league_id", "home_team_api_id", "away_team_api_id", "home_team_goal", "away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH
   LIMIT 100;
   ```

4. **Get distinct league IDs from matches:**

   ```sql
   SELECT DISTINCT "league_id"
   FROM EU_SOCCER.EU_SOCCER.MATCH
   LIMIT 100;
   ```

5. **List matches with league names:**

   ```sql
   SELECT m."id", l."name" AS "league_name", m."home_team_api_id", m."away_team_api_id", m."home_team_goal", m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
   LIMIT 100;
   ```

6. **Get home team names and goals:**

   ```sql
   SELECT m."id", t."team_long_name" AS "home_team_name", m."home_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id"
   LIMIT 100;
   ```

7. **Get away team names and goals:**

   ```sql
   SELECT m."id", t."team_long_name" AS "away_team_name", m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."away_team_api_id" = t."team_api_id"
   LIMIT 100;
   ```

8. **List matches with both team names and goals:**

   ```sql
   SELECT m."id",
          ht."team_long_name" AS "home_team_name",
          at."team_long_name" AS "away_team_name",
          m."home_team_goal",
          m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
   JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
   LIMIT 100;
   ```

9. **Count of matches per league:**

   ```sql
   SELECT l."name" AS "league_name", COUNT(*) AS "match_count"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
   GROUP BY l."name"
   LIMIT 100;
   ```

10. **Total goals scored by each team as home team:**

    ```sql
    SELECT t."team_long_name" AS "team_name", SUM(m."home_team_goal") AS "total_home_goals"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
    ```

11. **Total goals conceded by each team as away team:**

    ```sql
    SELECT t."team_long_name" AS "team_name", SUM(m."home_team_goal") AS "total_goals_conceded_as_away_team"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
    ```

12. **Number of home wins per team:**

    ```sql
    SELECT ht."team_long_name" AS "team_name", COUNT(*) AS "home_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    WHERE m."home_team_goal" > m."away_team_goal"
    GROUP BY ht."team_long_name"
    LIMIT 100;
    ```

13. **Number of away wins per team:**

    ```sql
    SELECT at."team_long_name" AS "team_name", COUNT(*) AS "away_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
    WHERE m."away_team_goal" > m."home_team_goal"
    GROUP BY at."team_long_name"
    LIMIT 100;
    ```

14. **Total wins per team (combining home and away wins):**

    ```sql
    SELECT t."team_long_name" AS "team_name",
           SUM(CASE WHEN m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal" THEN 1
                    WHEN m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal" THEN 1
                    ELSE 0 END) AS "total_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id" OR m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
    ```

15. **List teams with zero wins:**

    ```sql
    SELECT t."team_long_name" AS "team_name"
    FROM EU_SOCCER.EU_SOCCER.TEAM t
    WHERE t."team_api_id" NOT IN (
      SELECT DISTINCT m."home_team_api_id"
      FROM EU_SOCCER.EU_SOCCER.MATCH m
      WHERE m."home_team_goal" > m."away_team_goal"
      UNION
      SELECT DISTINCT m."away_team_api_id"
      FROM EU_SOCCER.EU_SOCCER.MATCH m
      WHERE m."away_team_goal" > m."home_team_goal"
    )
    LIMIT 100;
    ```

16. **List all teams in each league:**

    ```sql
    SELECT DISTINCT l."name" AS "league_name", t."team_long_name" AS "team_name"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id" OR m."away_team_api_id" = t."team_api_id"
    LIMIT 100;
    ```

17. **Total matches played by each team:**

    ```sql
    SELECT t."team_long_name" AS "team_name", COUNT(*) AS "total_matches"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id" OR m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
    ```

18. **Average goals scored by each team per match:**

    ```sql
    SELECT t."team_long_name" AS "team_name",
           AVG(
             CASE WHEN m."home_team_api_id" = t."team_api_id" THEN m."home_team_goal"
                  WHEN m."away_team_api_id" = t."team_api_id" THEN m."away_team_goal"
             END
           ) AS "average_goals_per_match"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id" OR m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
    ```

19. **Matches where the home team won:**

    ```sql
    SELECT m."id", ht."team_long_name" AS "home_team", at."team_long_name" AS "away_team", m."home_team_goal", m."away_team_goal"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
    WHERE m."home_team_goal" > m."away_team_goal"
    LIMIT 100;
    ```

20. **Matches where the away team won:**

    ```sql
    SELECT m."id", ht."team_long_name" AS "home_team", at."team_long_name" AS "away_team", m."home_team_goal", m."away_team_goal"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
    WHERE m."away_team_goal" > m."home_team_goal"
    LIMIT 100;
    ```

These queries help in understanding the structure and content of the relevant tables, how teams and matches are associated with leagues, and how match outcomes can be used to calculate total wins for each team. By analyzing these results, one can proceed to compute the team with the fewest total match wins in each league, including those with zero wins.Query:
SELECT "id", "name"
   FROM EU_SOCCER.EU_SOCCER.LEAGUE
   LIMIT 100;
Answer:
id,name
1,Belgium Jupiler League
1729,England Premier League
4769,France Ligue 1
7809,Germany 1. Bundesliga
10257,Italy Serie A
13274,Netherlands Eredivisie
15722,Poland Ekstraklasa
17642,Portugal Liga ZON Sagres
19694,Scotland Premier League
21518,Spain LIGA BBVA
24558,Switzerland Super League
Query:
SELECT "team_api_id", "team_long_name"
   FROM EU_SOCCER.EU_SOCCER.TEAM
   LIMIT 100;
Answer:
team_api_id,team_long_name
9987,KRC Genk
9993,Beerschot AC
10000,SV Zulte-Waregem
9994,Sporting Lokeren
9984,KSV Cercle Brugge
8635,RSC Anderlecht
9991,KAA Gent
9998,RAEC Mons
7947,FCV Dender EH
9985,Standard de Liège
8203,KV Mechelen
8342,Club Brugge KV
9999,KSV Roeselare
8571,KV Kortrijk
4049,Tubize
9996,Royal Excel Mouscron
10001,KVC Westerlo
9986,Sporting Charleroi
9997,Sint-Truidense VV
9989,Lierse SK
6351,KAS Eupen
1773,Oud-Heverlee Leuven
8475,Waasland-Beveren
8573,KV Oostende
274581,Royal Excel Mouscron
10260,Manchester United
10261,Newcastle United
9825,Arsenal
8659,West Bromwich Albion
8472,Sunderland
8650,Liverpool
8654,West Ham United
8528,Wigan Athletic
10252,Aston Villa
8456,Manchester City
8668,Everton
8655,Blackburn Rovers
8549,Middlesbrough
8586,Tottenham Hotspur
8559,Bolton Wanderers
10194,Stoke City
8667,Hull City
9879,Fulham
8455,Chelsea
8462,Portsmouth
8658,Birmingham City
8602,Wolverhampton Wanderers
8191,Burnley
8483,Blackpool
10003,Swansea City
10172,Queens Park Rangers
9850,Norwich City
8466,Southampton
9798,Reading
9826,Crystal Palace
8344,Cardiff City
8197,Leicester City
8678,Bournemouth
9817,Watford
8583,AJ Auxerre
9830,FC Nantes
9827,Girondins de Bordeaux
7819,SM Caen
9746,Le Havre AC
9831,OGC Nice
8682,Le Mans FC
8689,FC Lorient
9748,Olympique Lyonnais
9941,Toulouse FC
9829,AS Monaco
9847,Paris Saint-Germain
8481,AS Nancy-Lorraine
8639,LOSC Lille
9851,Stade Rennais FC
8592,Olympique de Marseille
9874,FC Sochaux-Montbéliard
9855,Grenoble Foot 38
9873,Valenciennes FC
9853,AS Saint-Étienne
8588,RC Lens
10249,Montpellier Hérault SC
4170,US Boulogne Cote D'Opale
108893,AC Arles-Avignon
8521,Stade Brestois 29
8576,AC Ajaccio
4087,Évian Thonon Gaillard FC
9836,Dijon FCO
9837,Stade de Reims
7794,SC Bastia
10242,ES Troyes AC
9747,En Avant de Guingamp
8550,FC Metz
8121,Angers SCO
6391,GFC Ajaccio
9823,FC Bayern Munich
9790,Hamburger SV
8178,Bayer 04 Leverkusen
9789,Borussia Dortmund
10189,FC Schalke 04
9904,Hannover 96
Query:
SELECT "id", "league_id", "home_team_api_id", "away_team_api_id", "home_team_goal", "away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH
   LIMIT 100;
Answer:
id,league_id,home_team_api_id,away_team_api_id,home_team_goal,away_team_goal
1,1,9987,9993,1,1
2,1,10000,9994,0,0
3,1,9984,8635,0,3
4,1,9991,9998,5,0
5,1,7947,9985,1,3
6,1,8203,8342,1,1
7,1,9999,8571,2,2
8,1,4049,9996,1,2
9,1,10001,9986,1,0
10,1,8342,8571,4,1
11,1,9985,9986,1,2
12,1,10000,9991,0,2
13,1,9994,9998,0,0
14,1,7947,10001,2,2
15,1,8203,9999,1,2
16,1,9996,9984,0,1
17,1,4049,9987,1,3
18,1,9993,8635,1,3
19,1,8635,9994,2,3
20,1,9998,9996,0,0
21,1,9986,8342,2,2
22,1,9984,10000,2,0
23,1,9991,7947,1,1
24,1,9999,4049,1,2
25,1,8571,8203,0,0
26,1,10001,9987,1,0
27,1,9993,9985,1,3
28,1,8342,8635,1,1
29,1,9987,9999,1,1
30,1,10000,9993,2,2
31,1,9994,9985,1,1
32,1,7947,8571,1,0
33,1,8203,9998,0,0
34,1,9996,9986,2,1
35,1,4049,9984,3,0
36,1,10001,9991,3,2
37,1,8635,10001,2,0
38,1,9985,9996,3,1
39,1,9998,8342,1,2
40,1,9986,4049,3,2
41,1,9984,8203,2,1
42,1,9991,9987,2,3
43,1,9999,7947,2,2
44,1,8571,10000,1,0
45,1,9993,9994,0,2
46,1,8342,9993,3,0
47,1,9987,9984,3,2
48,1,10000,9986,4,2
49,1,9991,9999,4,0
50,1,7947,8635,0,2
51,1,8203,9985,0,0
52,1,9996,9994,2,0
53,1,4049,8571,3,3
54,1,10001,9998,2,1
55,1,8635,4049,5,1
56,1,9985,10000,1,2
57,1,9998,7947,5,2
58,1,9986,8203,1,2
59,1,9984,9991,3,1
60,1,9994,8342,2,0
61,1,9999,10001,1,0
62,1,8571,9987,3,1
63,1,9993,9996,3,0
64,1,8342,9985,1,4
65,1,9987,9986,1,0
66,1,10000,9996,2,1
67,1,9991,8571,1,1
68,1,7947,9994,1,1
69,1,8203,9993,2,1
70,1,9999,8635,0,3
71,1,4049,9998,2,1
72,1,10001,9984,1,2
73,1,8635,9987,2,0
74,1,9985,9991,2,1
75,1,9998,10000,2,2
76,1,9986,7947,2,0
77,1,9984,9999,4,3
78,1,9994,8203,2,2
79,1,9996,8342,5,1
80,1,8571,10001,0,0
81,1,9993,4049,2,0
82,1,9993,9987,4,1
83,1,9994,10000,2,1
84,1,8635,9984,1,2
85,1,9998,9991,1,2
86,1,9985,7947,3,2
87,1,8342,8203,3,0
88,1,8571,9999,2,1
89,1,9996,4049,1,1
90,1,9986,10001,1,2
91,1,10000,8342,3,1
92,1,9991,8635,1,2
93,1,10001,9985,0,1
94,1,9987,9998,2,0
95,1,9999,9986,3,1
96,1,4049,9994,2,1
97,1,8203,9996,2,2
98,1,9984,8571,0,1
99,1,7947,9993,0,1
100,1,8342,10000,2,0
Query:
SELECT DISTINCT "league_id"
   FROM EU_SOCCER.EU_SOCCER.MATCH
   LIMIT 100;
Answer:
league_id
1
1729
4769
7809
15722
10257
17642
19694
21518
24558
13274
Query:
SELECT m."id", l."name" AS "league_name", m."home_team_api_id", m."away_team_api_id", m."home_team_goal", m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
   LIMIT 100;
Answer:
id,league_name,home_team_api_id,away_team_api_id,home_team_goal,away_team_goal
1,Belgium Jupiler League,9987,9993,1,1
2,Belgium Jupiler League,10000,9994,0,0
3,Belgium Jupiler League,9984,8635,0,3
4,Belgium Jupiler League,9991,9998,5,0
5,Belgium Jupiler League,7947,9985,1,3
6,Belgium Jupiler League,8203,8342,1,1
7,Belgium Jupiler League,9999,8571,2,2
8,Belgium Jupiler League,4049,9996,1,2
9,Belgium Jupiler League,10001,9986,1,0
10,Belgium Jupiler League,8342,8571,4,1
11,Belgium Jupiler League,9985,9986,1,2
12,Belgium Jupiler League,10000,9991,0,2
13,Belgium Jupiler League,9994,9998,0,0
14,Belgium Jupiler League,7947,10001,2,2
15,Belgium Jupiler League,8203,9999,1,2
16,Belgium Jupiler League,9996,9984,0,1
17,Belgium Jupiler League,4049,9987,1,3
18,Belgium Jupiler League,9993,8635,1,3
19,Belgium Jupiler League,8635,9994,2,3
20,Belgium Jupiler League,9998,9996,0,0
21,Belgium Jupiler League,9986,8342,2,2
22,Belgium Jupiler League,9984,10000,2,0
23,Belgium Jupiler League,9991,7947,1,1
24,Belgium Jupiler League,9999,4049,1,2
25,Belgium Jupiler League,8571,8203,0,0
26,Belgium Jupiler League,10001,9987,1,0
27,Belgium Jupiler League,9993,9985,1,3
28,Belgium Jupiler League,8342,8635,1,1
29,Belgium Jupiler League,9987,9999,1,1
30,Belgium Jupiler League,10000,9993,2,2
31,Belgium Jupiler League,9994,9985,1,1
32,Belgium Jupiler League,7947,8571,1,0
33,Belgium Jupiler League,8203,9998,0,0
34,Belgium Jupiler League,9996,9986,2,1
35,Belgium Jupiler League,4049,9984,3,0
36,Belgium Jupiler League,10001,9991,3,2
37,Belgium Jupiler League,8635,10001,2,0
38,Belgium Jupiler League,9985,9996,3,1
39,Belgium Jupiler League,9998,8342,1,2
40,Belgium Jupiler League,9986,4049,3,2
41,Belgium Jupiler League,9984,8203,2,1
42,Belgium Jupiler League,9991,9987,2,3
43,Belgium Jupiler League,9999,7947,2,2
44,Belgium Jupiler League,8571,10000,1,0
45,Belgium Jupiler League,9993,9994,0,2
46,Belgium Jupiler League,8342,9993,3,0
47,Belgium Jupiler League,9987,9984,3,2
48,Belgium Jupiler League,10000,9986,4,2
49,Belgium Jupiler League,9991,9999,4,0
50,Belgium Jupiler League,7947,8635,0,2
51,Belgium Jupiler League,8203,9985,0,0
52,Belgium Jupiler League,9996,9994,2,0
53,Belgium Jupiler League,4049,8571,3,3
54,Belgium Jupiler League,10001,9998,2,1
55,Belgium Jupiler League,8635,4049,5,1
56,Belgium Jupiler League,9985,10000,1,2
57,Belgium Jupiler League,9998,7947,5,2
58,Belgium Jupiler League,9986,8203,1,2
59,Belgium Jupiler League,9984,9991,3,1
60,Belgium Jupiler League,9994,8342,2,0
61,Belgium Jupiler League,9999,10001,1,0
62,Belgium Jupiler League,8571,9987,3,1
63,Belgium Jupiler League,9993,9996,3,0
64,Belgium Jupiler League,8342,9985,1,4
65,Belgium Jupiler League,9987,9986,1,0
66,Belgium Jupiler League,10000,9996,2,1
67,Belgium Jupiler League,9991,8571,1,1
68,Belgium Jupiler League,7947,9994,1,1
69,Belgium Jupiler League,8203,9993,2,1
70,Belgium Jupiler League,9999,8635,0,3
71,Belgium Jupiler League,4049,9998,2,1
72,Belgium Jupiler League,10001,9984,1,2
73,Belgium Jupiler League,8635,9987,2,0
74,Belgium Jupiler League,9985,9991,2,1
75,Belgium Jupiler League,9998,10000,2,2
76,Belgium Jupiler League,9986,7947,2,0
77,Belgium Jupiler League,9984,9999,4,3
78,Belgium Jupiler League,9994,8203,2,2
79,Belgium Jupiler League,9996,8342,5,1
80,Belgium Jupiler League,8571,10001,0,0
81,Belgium Jupiler League,9993,4049,2,0
82,Belgium Jupiler League,9993,9987,4,1
83,Belgium Jupiler League,9994,10000,2,1
84,Belgium Jupiler League,8635,9984,1,2
85,Belgium Jupiler League,9998,9991,1,2
86,Belgium Jupiler League,9985,7947,3,2
87,Belgium Jupiler League,8342,8203,3,0
88,Belgium Jupiler League,8571,9999,2,1
89,Belgium Jupiler League,9996,4049,1,1
90,Belgium Jupiler League,9986,10001,1,2
91,Belgium Jupiler League,10000,8342,3,1
92,Belgium Jupiler League,9991,8635,1,2
93,Belgium Jupiler League,10001,9985,0,1
94,Belgium Jupiler League,9987,9998,2,0
95,Belgium Jupiler League,9999,9986,3,1
96,Belgium Jupiler League,4049,9994,2,1
97,Belgium Jupiler League,8203,9996,2,2
98,Belgium Jupiler League,9984,8571,0,1
99,Belgium Jupiler League,7947,9993,0,1
100,Belgium Jupiler League,8342,10000,2,0
Query:
SELECT m."id", t."team_long_name" AS "home_team_name", m."home_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id"
   LIMIT 100;
Answer:
id,home_team_name,home_team_goal
16385,Lechia Gdańsk,1
16386,Lech Poznań,4
16387,Lechia Gdańsk,1
16388,Polonia Bytom,4
16389,Wisła Kraków,0
16390,Śląsk Wrocław,5
16391,Legia Warszawa,4
16392,GKS Bełchatów,1
16393,Jagiellonia Białystok,2
16394,Legia Warszawa,0
16395,Lechia Gdańsk,2
16396,Jagiellonia Białystok,2
16397,Wisła Kraków,2
16398,Polonia Bytom,1
16399,Korona Kielce,1
16400,Zagłębie Lubin,1
16401,Widzew Łódź,0
16402,Śląsk Wrocław,1
16403,GKS Bełchatów,1
16404,P. Warszawa,1
16405,Arka Gdynia,1
16406,Polonia Bytom,2
16407,Cracovia,2
16408,Ruch Chorzów,1
16409,Jagiellonia Białystok,2
16410,Polonia Bytom,1
16411,Wisła Kraków,2
16412,Zagłębie Lubin,2
16413,Widzew Łódź,5
16414,Lech Poznań,2
16415,Arka Gdynia,1
16416,Polonia Bytom,1
16417,Lechia Gdańsk,1
16418,Korona Kielce,2
16419,GKS Bełchatów,1
16420,Legia Warszawa,2
16421,Lechia Gdańsk,5
16422,P. Warszawa,2
16423,Cracovia,2
16424,Ruch Chorzów,1
16425,Jagiellonia Białystok,2
16426,Legia Warszawa,0
16427,GKS Bełchatów,1
16428,Wisła Kraków,0
16429,Polonia Bytom,0
16430,Ruch Chorzów,0
16431,Zagłębie Lubin,0
16432,Polonia Bytom,2
16433,Arka Gdynia,0
16434,Śląsk Wrocław,2
16435,Korona Kielce,3
16436,Widzew Łódź,0
16437,Lechia Gdańsk,1
16438,Lech Poznań,0
16439,Polonia Bytom,1
16440,Cracovia,2
16441,Jagiellonia Białystok,3
16442,Cracovia,1
16443,P. Warszawa,1
16444,Legia Warszawa,3
16445,Widzew Łódź,0
16446,Podbeskidzie Bielsko-Biała,2
16447,Ruch Chorzów,2
16448,Śląsk Wrocław,1
16449,Widzew Łódź,1
16450,GKS Bełchatów,3
16451,Lech Poznań,1
16452,Podbeskidzie Bielsko-Biała,1
16453,P. Warszawa,1
16454,Ruch Chorzów,0
16455,Widzew Łódź,0
16456,Wisła Kraków,3
16457,Zagłębie Lubin,0
16458,Cracovia,0
16459,Polonia Bytom,1
16460,Jagiellonia Białystok,1
16461,Lechia Gdańsk,0
16462,Legia Warszawa,2
16463,Widzew Łódź,1
16464,Śląsk Wrocław,1
16465,Zagłębie Lubin,3
16466,GKS Bełchatów,2
16467,Polonia Bytom,2
16468,Korona Kielce,0
16469,Lech Poznań,0
16470,Ruch Chorzów,0
16471,Śląsk Wrocław,1
16472,Widzew Łódź,1
16473,Wisła Kraków,0
16474,Cracovia,1
16475,Jagiellonia Białystok,0
16476,Korona Kielce,2
16477,Lechia Gdańsk,0
16478,Widzew Łódź,0
16479,Podbeskidzie Bielsko-Biała,1
16480,P. Warszawa,1
16481,Zagłębie Lubin,1
16482,GKS Bełchatów,3
16483,Jagiellonia Białystok,0
16484,Legia Warszawa,3
Query:
SELECT m."id", t."team_long_name" AS "away_team_name", m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."away_team_api_id" = t."team_api_id"
   LIMIT 100;
Answer:
id,away_team_name,away_team_goal
16385,Jagiellonia Białystok,2
16386,Korona Kielce,0
16387,Zagłębie Lubin,2
16388,Widzew Łódź,0
16389,P. Warszawa,2
16390,Arka Gdynia,0
16391,Polonia Bytom,0
16392,Cracovia,0
16393,Ruch Chorzów,1
16394,GKS Bełchatów,2
16395,Śląsk Wrocław,0
16396,Lech Poznań,0
16397,Polonia Bytom,1
16398,Ruch Chorzów,0
16399,Cracovia,0
16400,Arka Gdynia,0
16401,P. Warszawa,0
16402,Lech Poznań,2
16403,Lechia Gdańsk,0
16404,Korona Kielce,3
16405,Widzew Łódź,1
16406,Zagłębie Lubin,0
16407,Polonia Bytom,3
16408,Legia Warszawa,0
16409,Wisła Kraków,1
16410,GKS Bełchatów,0
16411,Korona Kielce,2
16412,Legia Warszawa,1
16413,Śląsk Wrocław,2
16414,P. Warszawa,2
16415,Jagiellonia Białystok,0
16416,Ruch Chorzów,0
16417,Cracovia,0
16418,Śląsk Wrocław,1
16419,Wisła Kraków,1
16420,Lech Poznań,1
16421,Polonia Bytom,1
16422,Polonia Bytom,2
16423,Arka Gdynia,0
16424,Widzew Łódź,1
16425,Zagłębie Lubin,0
16426,Lechia Gdańsk,3
16427,Lech Poznań,0
16428,Śląsk Wrocław,0
16429,Jagiellonia Białystok,1
16430,Korona Kielce,1
16431,Cracovia,0
16432,Widzew Łódź,2
16433,P. Warszawa,0
16434,P. Warszawa,2
16435,GKS Bełchatów,1
16436,Legia Warszawa,1
16437,Arka Gdynia,0
16438,Zagłębie Lubin,1
16439,Wisła Kraków,0
16440,Ruch Chorzów,3
16441,Polonia Bytom,0
16442,Korona Kielce,2
16443,Lechia Gdańsk,0
16444,Zagłębie Lubin,0
16445,Lech Poznań,5
16446,Jagiellonia Białystok,2
16447,GKS Bełchatów,1
16448,Polonia Bytom,1
16449,Wisła Kraków,1
16450,Śląsk Wrocław,0
16451,Korona Kielce,0
16452,Cracovia,0
16453,Polonia Bytom,1
16454,Legia Warszawa,1
16455,Widzew Łódź,1
16456,Jagiellonia Białystok,1
16457,Lechia Gdańsk,1
16458,P. Warszawa,0
16459,Ruch Chorzów,2
16460,GKS Bełchatów,0
16461,Lech Poznań,0
16462,Widzew Łódź,0
16463,Wisła Kraków,2
16464,Podbeskidzie Bielsko-Biała,0
16465,Korona Kielce,1
16466,Zagłębie Lubin,1
16467,Jagiellonia Białystok,0
16468,Widzew Łódź,2
16469,Legia Warszawa,0
16470,P. Warszawa,1
16471,Lechia Gdańsk,0
16472,Cracovia,0
16473,Podbeskidzie Bielsko-Biała,1
16474,Wisła Kraków,0
16475,Legia Warszawa,0
16476,GKS Bełchatów,2
16477,Widzew Łódź,0
16478,Ruch Chorzów,4
16479,Polonia Bytom,1
16480,Lech Poznań,0
16481,Śląsk Wrocław,5
16482,Widzew Łódź,0
16483,Śląsk Wrocław,2
16484,Lechia Gdańsk,0
Query:
SELECT m."id",
          ht."team_long_name" AS "home_team_name",
          at."team_long_name" AS "away_team_name",
          m."home_team_goal",
          m."away_team_goal"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
   JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
   LIMIT 100;
Answer:
id,home_team_name,away_team_name,home_team_goal,away_team_goal
16385,Lechia Gdańsk,Jagiellonia Białystok,1,2
16386,Lech Poznań,Korona Kielce,4,0
16387,Lechia Gdańsk,Zagłębie Lubin,1,2
16388,Polonia Bytom,Widzew Łódź,4,0
16389,Wisła Kraków,P. Warszawa,0,2
16390,Śląsk Wrocław,Arka Gdynia,5,0
16391,Legia Warszawa,Polonia Bytom,4,0
16392,GKS Bełchatów,Cracovia,1,0
16393,Jagiellonia Białystok,Ruch Chorzów,2,1
16394,Legia Warszawa,GKS Bełchatów,0,2
16395,Lechia Gdańsk,Śląsk Wrocław,2,0
16396,Jagiellonia Białystok,Lech Poznań,2,0
16397,Wisła Kraków,Polonia Bytom,2,1
16398,Polonia Bytom,Ruch Chorzów,1,0
16399,Korona Kielce,Cracovia,1,0
16400,Zagłębie Lubin,Arka Gdynia,1,0
16401,Widzew Łódź,P. Warszawa,0,0
16402,Śląsk Wrocław,Lech Poznań,1,2
16403,GKS Bełchatów,Lechia Gdańsk,1,0
16404,P. Warszawa,Korona Kielce,1,3
16405,Arka Gdynia,Widzew Łódź,1,1
16406,Polonia Bytom,Zagłębie Lubin,2,0
16407,Cracovia,Polonia Bytom,2,3
16408,Ruch Chorzów,Legia Warszawa,1,0
16409,Jagiellonia Białystok,Wisła Kraków,2,1
16410,Polonia Bytom,GKS Bełchatów,1,0
16411,Wisła Kraków,Korona Kielce,2,2
16412,Zagłębie Lubin,Legia Warszawa,2,1
16413,Widzew Łódź,Śląsk Wrocław,5,2
16414,Lech Poznań,P. Warszawa,2,2
16415,Arka Gdynia,Jagiellonia Białystok,1,0
16416,Polonia Bytom,Ruch Chorzów,1,0
16417,Lechia Gdańsk,Cracovia,1,0
16418,Korona Kielce,Śląsk Wrocław,2,1
16419,GKS Bełchatów,Wisła Kraków,1,1
16420,Legia Warszawa,Lech Poznań,2,1
16421,Lechia Gdańsk,Polonia Bytom,5,1
16422,P. Warszawa,Polonia Bytom,2,2
16423,Cracovia,Arka Gdynia,2,0
16424,Ruch Chorzów,Widzew Łódź,1,1
16425,Jagiellonia Białystok,Zagłębie Lubin,2,0
16426,Legia Warszawa,Lechia Gdańsk,0,3
16427,GKS Bełchatów,Lech Poznań,1,0
16428,Wisła Kraków,Śląsk Wrocław,0,0
16429,Polonia Bytom,Jagiellonia Białystok,0,1
16430,Ruch Chorzów,Korona Kielce,0,1
16431,Zagłębie Lubin,Cracovia,0,0
16432,Polonia Bytom,Widzew Łódź,2,2
16433,Arka Gdynia,P. Warszawa,0,0
16434,Śląsk Wrocław,P. Warszawa,2,2
16435,Korona Kielce,GKS Bełchatów,3,1
16436,Widzew Łódź,Legia Warszawa,0,1
16437,Lechia Gdańsk,Arka Gdynia,1,0
16438,Lech Poznań,Zagłębie Lubin,0,1
16439,Polonia Bytom,Wisła Kraków,1,0
16440,Cracovia,Ruch Chorzów,2,3
16441,Jagiellonia Białystok,Polonia Bytom,3,0
16442,Cracovia,Korona Kielce,1,2
16443,P. Warszawa,Lechia Gdańsk,1,0
16444,Legia Warszawa,Zagłębie Lubin,3,0
16445,Widzew Łódź,Lech Poznań,0,5
16446,Podbeskidzie Bielsko-Biała,Jagiellonia Białystok,2,2
16447,Ruch Chorzów,GKS Bełchatów,2,1
16448,Śląsk Wrocław,Polonia Bytom,1,1
16449,Widzew Łódź,Wisła Kraków,1,1
16450,GKS Bełchatów,Śląsk Wrocław,3,0
16451,Lech Poznań,Korona Kielce,1,0
16452,Podbeskidzie Bielsko-Biała,Cracovia,1,0
16453,P. Warszawa,Polonia Bytom,1,1
16454,Ruch Chorzów,Legia Warszawa,0,1
16455,Widzew Łódź,Widzew Łódź,0,1
16456,Wisła Kraków,Jagiellonia Białystok,3,1
16457,Zagłębie Lubin,Lechia Gdańsk,0,1
16458,Cracovia,P. Warszawa,0,0
16459,Polonia Bytom,Ruch Chorzów,1,2
16460,Jagiellonia Białystok,GKS Bełchatów,1,0
16461,Lechia Gdańsk,Lech Poznań,0,0
16462,Legia Warszawa,Widzew Łódź,2,0
16463,Widzew Łódź,Wisła Kraków,1,2
16464,Śląsk Wrocław,Podbeskidzie Bielsko-Biała,1,0
16465,Zagłębie Lubin,Korona Kielce,3,1
16466,GKS Bełchatów,Zagłębie Lubin,2,1
16467,Polonia Bytom,Jagiellonia Białystok,2,0
16468,Korona Kielce,Widzew Łódź,0,2
16469,Lech Poznań,Legia Warszawa,0,0
16470,Ruch Chorzów,P. Warszawa,0,1
16471,Śląsk Wrocław,Lechia Gdańsk,1,0
16472,Widzew Łódź,Cracovia,1,0
16473,Wisła Kraków,Podbeskidzie Bielsko-Biała,0,1
16474,Cracovia,Wisła Kraków,1,0
16475,Jagiellonia Białystok,Legia Warszawa,0,0
16476,Korona Kielce,GKS Bełchatów,2,2
16477,Lechia Gdańsk,Widzew Łódź,0,0
16478,Widzew Łódź,Ruch Chorzów,0,4
16479,Podbeskidzie Bielsko-Biała,Polonia Bytom,1,1
16480,P. Warszawa,Lech Poznań,1,0
16481,Zagłębie Lubin,Śląsk Wrocław,1,5
16482,GKS Bełchatów,Widzew Łódź,3,0
16483,Jagiellonia Białystok,Śląsk Wrocław,0,2
16484,Legia Warszawa,Lechia Gdańsk,3,0
Query:
SELECT l."name" AS "league_name", COUNT(*) AS "match_count"
   FROM EU_SOCCER.EU_SOCCER.MATCH m
   JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
   GROUP BY l."name"
   LIMIT 100;
Answer:
league_name,match_count
Germany 1. Bundesliga,2448
Spain LIGA BBVA,3040
France Ligue 1,3040
Netherlands Eredivisie,2448
Scotland Premier League,1824
Switzerland Super League,1422
Belgium Jupiler League,1728
England Premier League,3040
Italy Serie A,3017
Poland Ekstraklasa,1920
Portugal Liga ZON Sagres,2052
Query:
SELECT t."team_long_name" AS "team_name", SUM(m."home_team_goal") AS "total_home_goals"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
Answer:
team_name,total_home_goals
SV Zulte-Waregem,176
KSV Roeselare,36
KVC Westerlo,124
Standard de Liège,199
Royal Excel Mouscron,69
Beerschot AC,112
Sporting Charleroi,113
Aston Villa,179
Hull City,79
Fulham,173
Wigan Athletic,106
West Bromwich Albion,177
Blackburn Rovers,98
Queens Park Rangers,60
Cardiff City,20
Bournemouth,23
Girondins de Bordeaux,228
AS Monaco,153
AS Nancy-Lorraine,103
Stade Rennais FC,205
AS Saint-Étienne,223
Grenoble Foot 38,33
Paris Saint-Germain,332
RC Lens,61
Dijon FCO,23
DSC Arminia Bielefeld,16
Hamburger SV,178
VfL Bochum,41
FC St. Pauli,21
FC Augsburg,112
Chievo Verona,144
Milan,271
Sampdoria,190
Lazio,239
AZ,279
PEC Zwolle,124
Arka Gdynia,52
Odra Wodzisław,29
Zagłębie Lubin,116
KV Oostende,62
Le Havre AC,17
LOSC Lille,270
ES Troyes AC,38
En Avant de Guingamp,75
GFC Ajaccio,23
Borussia Mönchengladbach,242
Karlsruher SC,18
Cagliari,181
Roma,299
Napoli,303
Parma,151
N.E.C.,174
FC Volendam,27
Feyenoord,291
PSV,370
Legia Warszawa,240
Lech Poznań,215
Piast Gliwice,115
SC Freiburg,133
Carpi,23
De Graafschap,81
Korona Kielce,149
Podbeskidzie Bielsko-Biała,85
Pogoń Szczecin,85
Górnik Łęczna,43
FC Porto,295
Vitória Guimarães,156
Leixões SC,35
CF Os Belenenses,83
CS Marítimo,171
Académica de Coimbra,136
"União de Leiria, SAD",45
S.C. Olhanense,70
Moreirense FC,53
FC Arouca,56
Uniao da Madeira,19
Falkirk,36
Aberdeen,186
St. Mirren,137
Dundee FC,72
CA Osasuna,137
RC Deportivo de La Coruña,144
Sevilla FC,285
Real Zaragoza,95
CD Tenerife,26
RC Celta de Vigo,105
Elche CF,32
SD Eibar,46
BSC Young Boys,319
Neuchâtel Xamax,106
FC Thun,175
Termalica Bruk-Bet Nieciecza,21
SC Braga,239
Athletic Club de Bilbao,250
Real Valladolid,94
Rayo Vallecano,139
Grasshopper Club Zürich,234
FC Aarau,89
FCV Dender EH,21
Sporting Lokeren,149
Query:
SELECT t."team_long_name" AS "team_name", SUM(m."home_team_goal") AS "total_goals_conceded_as_away_team"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
Answer:
team_name,total_goals_conceded_as_away_team
Korona Kielce,144
Zagłębie Lubin,124
Arka Gdynia,68
Podbeskidzie Bielsko-Biała,124
Lech Poznań,119
Legia Warszawa,116
Pogoń Szczecin,82
Górnik Łęczna,42
CF Os Belenenses,114
SC Braga,138
Académica de Coimbra,190
Vitória Guimarães,195
FC Porto,96
S.C. Olhanense,117
"União de Leiria, SAD",67
Moreirense FC,75
Uniao da Madeira,33
Aberdeen,210
Falkirk,60
Sevilla FC,231
RC Deportivo de La Coruña,186
CD Tenerife,45
Real Zaragoza,139
RC Celta de Vigo,118
SD Eibar,65
BSC Young Boys,207
FC Thun,144
Piast Gliwice,147
Termalica Bruk-Bet Nieciecza,24
CS Marítimo,201
Leixões SC,42
FC Arouca,68
St. Mirren,221
Real Valladolid,146
Athletic Club de Bilbao,236
CA Osasuna,202
Elche CF,69
FC Aarau,155
Dundee FC,96
Rayo Vallecano,214
Grasshopper Club Zürich,236
Neuchâtel Xamax,102
Beerschot AC,139
Standard de Liège,152
Sporting Charleroi,155
KVC Westerlo,178
SV Zulte-Waregem,145
Royal Excel Mouscron,85
KSV Roeselare,63
West Bromwich Albion,216
Wigan Athletic,178
Blackburn Rovers,162
Fulham,171
Aston Villa,264
Hull City,133
Queens Park Rangers,122
Cardiff City,39
Bournemouth,33
Paris Saint-Germain,151
LOSC Lille,165
Grenoble Foot 38,57
AS Saint-Étienne,188
Girondins de Bordeaux,197
AS Monaco,140
Le Havre AC,33
AS Nancy-Lorraine,138
Stade Rennais FC,193
RC Lens,96
Dijon FCO,37
ES Troyes AC,84
En Avant de Guingamp,84
Hamburger SV,250
VfL Bochum,56
DSC Arminia Bielefeld,30
Karlsruher SC,32
FC St. Pauli,33
FC Augsburg,131
Lazio,213
Napoli,189
Chievo Verona,220
Sampdoria,215
Milan,184
Cagliari,211
Parma,201
PSV,168
FC Volendam,40
N.E.C.,216
AZ,203
PEC Zwolle,110
Odra Wodzisław,53
KV Oostende,47
GFC Ajaccio,26
Borussia Mönchengladbach,220
SC Freiburg,178
Roma,217
Carpi,31
De Graafschap,137
Feyenoord,196
Widzew Łódź,145
Polonia Bytom,224
Query:
SELECT ht."team_long_name" AS "team_name", COUNT(*) AS "home_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    WHERE m."home_team_goal" > m."away_team_goal"
    GROUP BY ht."team_long_name"
    LIMIT 100;
Answer:
team_name,home_wins
KVC Westerlo,35
Royal Excel Mouscron,18
Standard de Liège,66
Sporting Charleroi,35
SV Zulte-Waregem,45
KSV Roeselare,8
Beerschot AC,30
Hull City,21
Fulham,52
Queens Park Rangers,15
Paris Saint-Germain,102
ES Troyes AC,7
Roma,97
Aston Villa,45
Blackburn Rovers,29
West Bromwich Albion,47
Bournemouth,5
AS Monaco,53
RC Lens,19
Dijon FCO,6
GFC Ajaccio,5
SC Freiburg,38
Sampdoria,56
Lazio,81
Feyenoord,86
PSV,105
Piast Gliwice,38
Lech Poznań,74
Arka Gdynia,16
Girondins de Bordeaux,81
LOSC Lille,93
Hamburger SV,55
Borussia Mönchengladbach,71
De Graafschap,18
FC Volendam,6
PEC Zwolle,31
Legia Warszawa,81
Wigan Athletic,28
AZ,82
KV Oostende,17
Le Havre AC,4
Stade Rennais FC,63
Karlsruher SC,5
Napoli,95
Parma,50
AS Nancy-Lorraine,30
AS Saint-Étienne,75
Grenoble Foot 38,10
En Avant de Guingamp,23
DSC Arminia Bielefeld,2
VfL Bochum,7
Chievo Verona,46
Cagliari,52
Odra Wodzisław,10
Korona Kielce,43
FC St. Pauli,4
Milan,92
Cardiff City,5
FC Augsburg,32
Carpi,6
N.E.C.,44
Zagłębie Lubin,35
Podbeskidzie Bielsko-Biała,19
Pogoń Szczecin,26
Górnik Łęczna,12
Termalica Bruk-Bet Nieciecza,5
SC Braga,81
Vitória Guimarães,53
Leixões SC,9
"União de Leiria, SAD",15
FC Arouca,18
Aberdeen,67
Falkirk,9
Sevilla FC,91
Académica de Coimbra,35
FC Porto,102
S.C. Olhanense,19
Uniao da Madeira,6
St. Mirren,34
Dundee FC,16
Athletic Club de Bilbao,80
Real Valladolid,25
CD Tenerife,8
Rayo Vallecano,41
SD Eibar,13
Grasshopper Club Zürich,71
FC Aarau,25
Neuchâtel Xamax,22
RC Celta de Vigo,30
Elche CF,12
FC Thun,44
CF Os Belenenses,22
Moreirense FC,12
CS Marítimo,55
Real Zaragoza,29
BSC Young Boys,85
CA Osasuna,48
RC Deportivo de La Coruña,42
Club Brugge KV,75
FCV Dender EH,5
Query:
SELECT at."team_long_name" AS "team_name", COUNT(*) AS "away_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
    WHERE m."away_team_goal" > m."home_team_goal"
    GROUP BY at."team_long_name"
    LIMIT 100;
Answer:
team_name,away_wins
Zagłębie Lubin,24
Lech Poznań,50
Podbeskidzie Bielsko-Biała,23
Legia Warszawa,56
Pogoń Szczecin,16
Piast Gliwice,27
Górnik Łęczna,4
Termalica Bruk-Bet Nieciecza,3
SC Braga,45
Vitória Guimarães,39
Leixões SC,8
"União de Leiria, SAD",8
S.C. Olhanense,13
FC Arouca,10
Aberdeen,53
Falkirk,6
Sevilla FC,48
Académica de Coimbra,21
FC Porto,81
Uniao da Madeira,1
St. Mirren,27
Dundee FC,13
CD Tenerife,1
Rayo Vallecano,25
SD Eibar,7
Neuchâtel Xamax,14
FC Aarau,10
Athletic Club de Bilbao,42
Elche CF,8
FC Thun,27
Korona Kielce,26
CF Os Belenenses,15
Moreirense FC,13
CS Marítimo,30
Real Zaragoza,14
Real Valladolid,12
BSC Young Boys,57
Grasshopper Club Zürich,44
RC Celta de Vigo,24
CA Osasuna,19
RC Deportivo de La Coruña,20
Standard de Liège,40
Royal Excel Mouscron,8
Sporting Charleroi,20
KSV Roeselare,4
SV Zulte-Waregem,33
KVC Westerlo,19
Beerschot AC,10
Hull City,11
Fulham,19
Queens Park Rangers,7
Paris Saint-Germain,73
ES Troyes AC,4
Roma,65
AZ,58
Blackburn Rovers,13
Aston Villa,41
West Bromwich Albion,28
Cardiff City,2
Bournemouth,6
Grenoble Foot 38,5
AS Monaco,42
Stade Rennais FC,48
RC Lens,7
Dijon FCO,3
GFC Ajaccio,3
Hamburger SV,38
SC Freiburg,24
Lazio,50
Sampdoria,28
PSV,73
Feyenoord,53
Arka Gdynia,4
AS Saint-Étienne,46
LOSC Lille,54
En Avant de Guingamp,14
Borussia Mönchengladbach,38
VfL Bochum,6
Karlsruher SC,3
Chievo Verona,41
Cagliari,24
De Graafschap,9
FC Volendam,1
Odra Wodzisław,5
FC St. Pauli,4
PEC Zwolle,18
Wigan Athletic,22
KV Oostende,12
Le Havre AC,3
Napoli,58
AS Nancy-Lorraine,26
Girondins de Bordeaux,45
DSC Arminia Bielefeld,2
FC Augsburg,23
Parma,24
Carpi,3
N.E.C.,24
Milan,62
GKS Bełchatów,20
Polonia Bytom,31
Query:
SELECT t."team_long_name" AS "team_name",
           SUM(CASE WHEN m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal" THEN 1
                    WHEN m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal" THEN 1
                    ELSE 0 END) AS "total_wins"
    FROM EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON m."home_team_api_id" = t."team_api_id" OR m."away_team_api_id" = t."team_api_id"
    GROUP BY t."team_long_name"
    LIMIT 100;
Answer:
team_name,total_wins
Beerschot AC,40
SV Zulte-Waregem,78
Standard de Liège,106
KSV Roeselare,12
Royal Excel Mouscron,26
KVC Westerlo,54
Sporting Charleroi,55
KV Oostende,29
Wigan Athletic,50
Blackburn Rovers,42
Hull City,32
Fulham,71
Queens Park Rangers,22
Cardiff City,7
Bournemouth,11
Girondins de Bordeaux,126
Le Havre AC,7
Paris Saint-Germain,175
AS Monaco,95
AS Nancy-Lorraine,56
AS Saint-Étienne,121
Dijon FCO,9
Grenoble Foot 38,15
ES Troyes AC,11
En Avant de Guingamp,37
Karlsruher SC,8
SC Freiburg,62
FC St. Pauli,8
FC Augsburg,55
Lazio,131
Cagliari,76
Chievo Verona,87
Roma,162
Sampdoria,84
Parma,74
Carpi,9
AZ,140
PEC Zwolle,49
Legia Warszawa,137
West Bromwich Albion,75
Aston Villa,86
Stade Rennais FC,111
LOSC Lille,147
RC Lens,26
GFC Ajaccio,8
Hamburger SV,93
DSC Arminia Bielefeld,4
Borussia Mönchengladbach,109
VfL Bochum,13
Milan,154
De Graafschap,27
N.E.C.,68
PSV,178
FC Volendam,7
Odra Wodzisław,15
Arka Gdynia,20
Piast Gliwice,65
Korona Kielce,69
Zagłębie Lubin,59
Napoli,153
Feyenoord,139
Lech Poznań,124
Podbeskidzie Bielsko-Biała,42
Pogoń Szczecin,42
Górnik Łęczna,16
Termalica Bruk-Bet Nieciecza,8
FC Porto,183
CF Os Belenenses,37
Vitória Guimarães,92
SC Braga,126
Académica de Coimbra,56
Leixões SC,17
S.C. Olhanense,32
CS Marítimo,85
"União de Leiria, SAD",23
Moreirense FC,25
FC Arouca,28
Uniao da Madeira,7
Falkirk,15
Dundee FC,29
CA Osasuna,67
RC Deportivo de La Coruña,62
Sevilla FC,139
Real Valladolid,37
Athletic Club de Bilbao,122
Real Zaragoza,43
CD Tenerife,9
Rayo Vallecano,66
RC Celta de Vigo,54
Grasshopper Club Zürich,115
FC Aarau,35
Neuchâtel Xamax,36
FC Thun,71
Aberdeen,120
St. Mirren,61
Elche CF,20
SD Eibar,20
BSC Young Boys,142
Widzew Łódź,48
Polonia Bytom,94
Query:
SELECT
    league_name,
    team_name,
    total_wins
FROM (
    SELECT
        l."name" AS league_name,
        t."team_long_name" AS team_name,
        COUNT(CASE
            WHEN (m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal") OR
                 (m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal")
            THEN 1
            ELSE NULL
        END) AS total_wins,
        ROW_NUMBER() OVER (
            PARTITION BY l."name"
            ORDER BY
                COUNT(CASE
                    WHEN (m."home_team_api_id" = t."team_api_id" AND m."home_team_goal" > m."away_team_goal") OR
                         (m."away_team_api_id" = t."team_api_id" AND m."away_team_goal" > m."home_team_goal")
                    THEN 1
                    ELSE NULL
                END) ASC,
                t."team_long_name" ASC
        ) AS rn
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.LEAGUE l ON m."league_id" = l."id"
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
    GROUP BY
        l."name",
        t."team_long_name"
) subquery
WHERE
    rn = 1
ORDER BY
    league_name;
Answer:
LEAGUE_NAME,TEAM_NAME,TOTAL_WINS
Belgium Jupiler League,KAS Eupen,5
England Premier League,Reading,6
France Ligue 1,AC Arles-Avignon,3
Germany 1. Bundesliga,DSC Arminia Bielefeld,4
Italy Serie A,Novara,6
Netherlands Eredivisie,FC Dordrecht,4
Poland Ekstraklasa,Termalica Bruk-Bet Nieciecza,8
Portugal Liga ZON Sagres,FC Penafiel,5
Scotland Premier League,Dunfermline Athletic,5
Spain LIGA BBVA,Córdoba CF,3
Switzerland Super League,Lugano,9
Query:
-- Corrected SQL 1:

SELECT DISTINCT
    l."name" AS "league_name",
    t."team_long_name" AS "team_name"
FROM
    EU_SOCCER.EU_SOCCER.LEAGUE l
    JOIN EU_SOCCER.EU_SOCCER.MATCH m ON l."id" = m."league_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id"
UNION
SELECT DISTINCT
    l."name" AS "league_name",
    t."team_long_name" AS "team_name"
FROM
    EU_SOCCER.EU_SOCCER.LEAGUE l
    JOIN EU_SOCCER.EU_SOCCER.MATCH m ON l."id" = m."league_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."away_team_api_id"
LIMIT 100
Answer:
league_name,team_name
Belgium Jupiler League,KRC Genk
Belgium Jupiler League,KSV Cercle Brugge
Belgium Jupiler League,KAA Gent
Belgium Jupiler League,KV Mechelen
Belgium Jupiler League,Royal Excel Mouscron
Belgium Jupiler League,Lierse SK
Belgium Jupiler League,Waasland-Beveren
England Premier League,Manchester United
England Premier League,Manchester City
England Premier League,Swansea City
France Ligue 1,En Avant de Guingamp
England Premier League,Bolton Wanderers
England Premier League,Burnley
England Premier League,Crystal Palace
France Ligue 1,Le Havre AC
Netherlands Eredivisie,PEC Zwolle
Germany 1. Bundesliga,VfB Stuttgart
England Premier League,Birmingham City
France Ligue 1,AS Nancy-Lorraine
France Ligue 1,RC Lens
Germany 1. Bundesliga,Hertha BSC Berlin
Netherlands Eredivisie,Go Ahead Eagles
Netherlands Eredivisie,NAC Breda
France Ligue 1,Valenciennes FC
Germany 1. Bundesliga,FC Schalke 04
Italy Serie A,Roma
Italy Serie A,Juventus
Belgium Jupiler League,KSV Roeselare
Belgium Jupiler League,Oud-Heverlee Leuven
Netherlands Eredivisie,FC Twente
France Ligue 1,AC Ajaccio
Netherlands Eredivisie,Feyenoord
England Premier League,Blackpool
England Premier League,Cardiff City
Germany 1. Bundesliga,Bayer 04 Leverkusen
England Premier League,Wolverhampton Wanderers
France Ligue 1,FC Lorient
Poland Ekstraklasa,Wisła Kraków
Poland Ekstraklasa,Legia Warszawa
England Premier League,Middlesbrough
Netherlands Eredivisie,Roda JC Kerkrade
England Premier League,Leicester City
Germany 1. Bundesliga,FC Augsburg
Italy Serie A,Sampdoria
Poland Ekstraklasa,Polonia Bytom
Italy Serie A,Parma
Belgium Jupiler League,Beerschot AC
Italy Serie A,Catania
Netherlands Eredivisie,Sparta Rotterdam
Netherlands Eredivisie,ADO Den Haag
Poland Ekstraklasa,Odra Wodzisław
Belgium Jupiler League,FCV Dender EH
England Premier League,Bournemouth
France Ligue 1,Paris Saint-Germain
England Premier League,Newcastle United
Poland Ekstraklasa,Cracovia
Poland Ekstraklasa,Korona Kielce
Belgium Jupiler League,KAS Eupen
Italy Serie A,Chievo Verona
Italy Serie A,Carpi
Italy Serie A,Brescia
Belgium Jupiler League,Sint-Truidense VV
Italy Serie A,Livorno
Netherlands Eredivisie,Vitesse
Netherlands Eredivisie,AZ
France Ligue 1,LOSC Lille
Germany 1. Bundesliga,DSC Arminia Bielefeld
Germany 1. Bundesliga,SV Darmstadt 98
Netherlands Eredivisie,FC Dordrecht
France Ligue 1,SM Caen
France Ligue 1,FC Metz
Poland Ekstraklasa,Widzew Łódź
France Ligue 1,SC Bastia
Germany 1. Bundesliga,Hamburger SV
Italy Serie A,Reggio Calabria
Netherlands Eredivisie,FC Volendam
France Ligue 1,Olympique de Marseille
Netherlands Eredivisie,N.E.C.
England Premier League,Arsenal
Italy Serie A,Siena
Italy Serie A,Cesena
Italy Serie A,Lazio
Italy Serie A,Hellas Verona
Poland Ekstraklasa,Śląsk Wrocław
Poland Ekstraklasa,Ruch Chorzów
Poland Ekstraklasa,GKS Bełchatów
Italy Serie A,Frosinone
Poland Ekstraklasa,Lech Poznań
Poland Ekstraklasa,Jagiellonia Białystok
Poland Ekstraklasa,Zagłębie Lubin
France Ligue 1,ES Troyes AC
Netherlands Eredivisie,FC Utrecht
England Premier League,West Bromwich Albion
Germany 1. Bundesliga,FC St. Pauli
Italy Serie A,Torino
Italy Serie A,Cagliari
Italy Serie A,Fiorentina
Germany 1. Bundesliga,Eintracht Frankfurt
Netherlands Eredivisie,PSV
Netherlands Eredivisie,RKC Waalwijk
Query:
-- Corrected SQL 2:

SELECT
    t."team_long_name" AS "team_name",
    COUNT(*) AS "total_matches"
FROM
    EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
GROUP BY
    t."team_long_name"
LIMIT 100
Answer:
team_name,total_matches
Lech Poznań,240
Korona Kielce,210
Zagłębie Lubin,180
Arka Gdynia,90
Legia Warszawa,240
Podbeskidzie Bielsko-Biała,150
Piast Gliwice,180
Pogoń Szczecin,120
Górnik Łęczna,60
Vitória Guimarães,248
Académica de Coimbra,248
Leixões SC,60
S.C. Olhanense,150
CS Marítimo,248
Moreirense FC,98
FC Arouca,98
Falkirk,76
Dundee FC,114
RC Deportivo de La Coruña,228
Sevilla FC,304
Real Valladolid,152
Athletic Club de Bilbao,304
Real Zaragoza,152
Rayo Vallecano,190
FC Aarau,144
FC Thun,214
Termalica Bruk-Bet Nieciecza,30
FC Porto,248
CF Os Belenenses,158
SC Braga,248
"União de Leiria, SAD",90
Uniao da Madeira,34
CA Osasuna,228
CD Tenerife,38
RC Celta de Vigo,152
BSC Young Boys,286
Neuchâtel Xamax,126
Aberdeen,304
St. Mirren,266
Elche CF,76
SD Eibar,76
Grasshopper Club Zürich,286
Beerschot AC,152
SV Zulte-Waregem,212
Standard de Liège,212
KSV Roeselare,62
Royal Excel Mouscron,94
KVC Westerlo,182
Sporting Charleroi,182
KV Oostende,66
West Bromwich Albion,266
Wigan Athletic,190
Blackburn Rovers,152
Hull City,152
Fulham,228
Queens Park Rangers,114
Cardiff City,38
Bournemouth,38
Girondins de Bordeaux,304
Le Havre AC,38
Paris Saint-Germain,304
AS Monaco,228
AS Nancy-Lorraine,190
Stade Rennais FC,304
AS Saint-Étienne,304
Dijon FCO,38
Grenoble Foot 38,76
RC Lens,114
ES Troyes AC,76
En Avant de Guingamp,114
GFC Ajaccio,38
DSC Arminia Bielefeld,34
Karlsruher SC,34
VfL Bochum,68
SC Freiburg,204
FC St. Pauli,34
FC Augsburg,170
Lazio,301
Cagliari,264
Chievo Verona,303
Roma,303
Sampdoria,266
Parma,226
Carpi,38
De Graafschap,136
PSV,272
FC Volendam,34
AZ,272
PEC Zwolle,136
Aston Villa,304
LOSC Lille,304
Hamburger SV,272
Borussia Mönchengladbach,272
Milan,303
N.E.C.,238
Feyenoord,272
Odra Wodzisław,60
Napoli,301
Widzew Łódź,180
Polonia Bytom,300
Query:
-- Corrected SQL 3:

SELECT
    team_name,
    AVG(goals_scored) AS "average_goals_per_match"
FROM
    (
        SELECT t."team_long_name" AS team_name, m."home_team_goal" AS goals_scored
        FROM EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."home_team_api_id"
        UNION ALL
        SELECT t."team_long_name" AS team_name, m."away_team_goal" AS goals_scored
        FROM EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.TEAM t ON t."team_api_id" = m."away_team_api_id"
    ) sub
GROUP BY
    team_name
LIMIT 100
Answer:
TEAM_NAME,average_goals_per_match
SV Zulte-Waregem,1.443396
KSV Roeselare,1.000000
KVC Westerlo,1.192308
Standard de Liège,1.608491
Royal Excel Mouscron,1.202128
Beerschot AC,1.144737
Sporting Charleroi,1.104396
KV Oostende,1.545455
Aston Villa,1.101974
Hull City,0.947368
Fulham,1.162281
Blackburn Rovers,1.151316
Wigan Athletic,1.052632
West Bromwich Albion,1.146617
Queens Park Rangers,1.008772
Cardiff City,0.842105
Bournemouth,1.184211
Girondins de Bordeaux,1.328947
AS Monaco,1.258772
Stade Rennais FC,1.207237
LOSC Lille,1.480263
Grenoble Foot 38,0.723684
AS Nancy-Lorraine,1.068421
Dijon FCO,1.000000
En Avant de Guingamp,1.070175
GFC Ajaccio,0.973684
SC Freiburg,1.200980
FC St. Pauli,1.029412
FC Augsburg,1.182353
Cagliari,1.170455
Chievo Verona,0.940594
Roma,1.749175
Sampdoria,1.195489
Napoli,1.707641
Parma,1.203540
Carpi,0.973684
N.E.C.,1.302521
FC Volendam,1.117647
AZ,1.808824
Feyenoord,1.797794
PSV,2.397059
PEC Zwolle,1.500000
Zagłębie Lubin,1.150000
Le Havre AC,0.789474
AS Saint-Étienne,1.220395
Paris Saint-Germain,1.868421
RC Lens,0.938596
ES Troyes AC,0.934211
DSC Arminia Bielefeld,0.852941
Borussia Mönchengladbach,1.481618
Karlsruher SC,0.882353
Hamburger SV,1.264706
VfL Bochum,1.058824
Milan,1.636964
Lazio,1.385382
De Graafschap,0.955882
Legia Warszawa,1.704167
Lech Poznań,1.550000
Arka Gdynia,0.855556
Piast Gliwice,1.133333
Korona Kielce,1.128571
Odra Wodzisław,0.833333
Podbeskidzie Bielsko-Biała,1.126667
Pogoń Szczecin,1.266667
Górnik Łęczna,1.016667
Termalica Bruk-Bet Nieciecza,1.100000
FC Porto,2.181452
Vitória Guimarães,1.209677
Leixões SC,0.916667
CF Os Belenenses,0.936709
CS Marítimo,1.274194
Académica de Coimbra,0.967742
"União de Leiria, SAD",0.944444
S.C. Olhanense,0.920000
SC Braga,1.604839
FC Arouca,1.030612
Uniao da Madeira,0.794118
Falkirk,0.894737
St. Mirren,0.966165
Aberdeen,1.200658
CA Osasuna,1.017544
RC Deportivo de La Coruña,1.057018
Athletic Club de Bilbao,1.365132
Real Valladolid,1.118421
Real Zaragoza,1.046053
CD Tenerife,1.052632
Rayo Vallecano,1.300000
RC Celta de Vigo,1.210526
SD Eibar,1.092105
FC Aarau,1.062500
Moreirense FC,1.030612
Dundee FC,1.114035
Sevilla FC,1.572368
BSC Young Boys,1.849650
Neuchâtel Xamax,1.357143
FC Thun,1.303738
Elche CF,0.855263
Grasshopper Club Zürich,1.500000
FCV Dender EH,1.294118
Club Brugge KV,1.985849
Query:
-- Corrected SQL 4:

SELECT
    m."id",
    ht."team_long_name" AS "home_team",
    at."team_long_name" AS "away_team",
    m."home_team_goal",
    m."away_team_goal"
FROM
    EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
WHERE
    m."home_team_goal" > m."away_team_goal"
LIMIT 100
Answer:
id,home_team,away_team,home_team_goal,away_team_goal
4,KAA Gent,RAEC Mons,5,0
9,KVC Westerlo,Sporting Charleroi,1,0
10,Club Brugge KV,KV Kortrijk,4,1
22,KSV Cercle Brugge,SV Zulte-Waregem,2,0
26,KVC Westerlo,KRC Genk,1,0
32,FCV Dender EH,KV Kortrijk,1,0
34,Royal Excel Mouscron,Sporting Charleroi,2,1
35,Tubize,KSV Cercle Brugge,3,0
36,KVC Westerlo,KAA Gent,3,2
37,RSC Anderlecht,KVC Westerlo,2,0
38,Standard de Liège,Royal Excel Mouscron,3,1
40,Sporting Charleroi,Tubize,3,2
41,KSV Cercle Brugge,KV Mechelen,2,1
44,KV Kortrijk,SV Zulte-Waregem,1,0
46,Club Brugge KV,Beerschot AC,3,0
47,KRC Genk,KSV Cercle Brugge,3,2
48,SV Zulte-Waregem,Sporting Charleroi,4,2
49,KAA Gent,KSV Roeselare,4,0
52,Royal Excel Mouscron,Sporting Lokeren,2,0
54,KVC Westerlo,RAEC Mons,2,1
55,RSC Anderlecht,Tubize,5,1
57,RAEC Mons,FCV Dender EH,5,2
59,KSV Cercle Brugge,KAA Gent,3,1
60,Sporting Lokeren,Club Brugge KV,2,0
61,KSV Roeselare,KVC Westerlo,1,0
62,KV Kortrijk,KRC Genk,3,1
63,Beerschot AC,Royal Excel Mouscron,3,0
65,KRC Genk,Sporting Charleroi,1,0
66,SV Zulte-Waregem,Royal Excel Mouscron,2,1
69,KV Mechelen,Beerschot AC,2,1
71,Tubize,RAEC Mons,2,1
73,RSC Anderlecht,KRC Genk,2,0
74,Standard de Liège,KAA Gent,2,1
76,Sporting Charleroi,FCV Dender EH,2,0
77,KSV Cercle Brugge,KSV Roeselare,4,3
79,Royal Excel Mouscron,Club Brugge KV,5,1
81,Beerschot AC,Tubize,2,0
82,Beerschot AC,KRC Genk,4,1
83,Sporting Lokeren,SV Zulte-Waregem,2,1
86,Standard de Liège,FCV Dender EH,3,2
87,Club Brugge KV,KV Mechelen,3,0
88,KV Kortrijk,KSV Roeselare,2,1
91,SV Zulte-Waregem,Club Brugge KV,3,1
94,KRC Genk,RAEC Mons,2,0
95,KSV Roeselare,Sporting Charleroi,3,1
96,Tubize,Sporting Lokeren,2,1
100,Club Brugge KV,SV Zulte-Waregem,2,0
102,Standard de Liège,KVC Westerlo,3,0
103,RAEC Mons,KRC Genk,3,1
104,Sporting Charleroi,KSV Roeselare,1,0
105,Sporting Lokeren,Tubize,4,1
106,Royal Excel Mouscron,KV Mechelen,3,1
107,KV Kortrijk,KSV Cercle Brugge,2,1
115,Standard de Liège,KSV Roeselare,3,0
116,Club Brugge KV,Tubize,3,1
117,Beerschot AC,KVC Westerlo,2,1
120,RSC Anderlecht,RAEC Mons,3,2
123,KVC Westerlo,Sporting Lokeren,1,0
125,KAA Gent,Royal Excel Mouscron,2,0
131,SV Zulte-Waregem,FCV Dender EH,1,0
132,Sporting Lokeren,KSV Roeselare,2,1
134,Standard de Liège,Tubize,4,0
137,RSC Anderlecht,Standard de Liège,4,2
138,KSV Roeselare,RAEC Mons,3,2
146,KV Mechelen,KRC Genk,2,1
147,Sporting Charleroi,RAEC Mons,3,0
148,Standard de Liège,KSV Cercle Brugge,4,0
150,Club Brugge KV,KSV Roeselare,2,1
151,Beerschot AC,KV Kortrijk,3,0
152,FCV Dender EH,Tubize,4,0
156,RSC Anderlecht,SV Zulte-Waregem,2,0
158,KRC Genk,FCV Dender EH,4,3
160,KSV Roeselare,Royal Excel Mouscron,2,0
161,KAA Gent,Tubize,2,0
163,KV Mechelen,RSC Anderlecht,2,1
164,Standard de Liège,KRC Genk,2,0
165,Beerschot AC,RAEC Mons,2,0
167,FCV Dender EH,KSV Cercle Brugge,1,0
170,Royal Excel Mouscron,KV Kortrijk,1,0
173,Sporting Charleroi,Standard de Liège,1,0
174,KAA Gent,SV Zulte-Waregem,1,0
176,KVC Westerlo,FCV Dender EH,3,1
177,KSV Roeselare,KV Mechelen,1,0
179,KRC Genk,Tubize,3,0
180,RSC Anderlecht,Beerschot AC,2,0
182,Royal Excel Mouscron,RAEC Mons,3,2
183,Club Brugge KV,Sporting Charleroi,2,1
184,SV Zulte-Waregem,KSV Cercle Brugge,3,1
189,Standard de Liège,Beerschot AC,3,1
190,RSC Anderlecht,Club Brugge KV,1,0
191,KSV Roeselare,KRC Genk,1,0
193,Standard de Liège,Sporting Lokeren,1,0
196,Sporting Charleroi,Royal Excel Mouscron,1,0
197,KSV Cercle Brugge,Tubize,4,1
198,KAA Gent,KVC Westerlo,2,0
199,RSC Anderlecht,KV Kortrijk,4,0
200,KRC Genk,Sporting Lokeren,1,0
201,KSV Cercle Brugge,RAEC Mons,2,1
202,KAA Gent,Sporting Charleroi,2,0
207,KVC Westerlo,Beerschot AC,1,0
Query:
-- Corrected SQL 5:

SELECT
    m."id",
    ht."team_long_name" AS "home_team",
    at."team_long_name" AS "away_team",
    m."home_team_goal",
    m."away_team_goal"
FROM
    EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM ht ON m."home_team_api_id" = ht."team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.TEAM at ON m."away_team_api_id" = at."team_api_id"
WHERE
    m."away_team_goal" > m."home_team_goal"
LIMIT 100
Answer:
id,home_team,away_team,home_team_goal,away_team_goal
16385,Lechia Gdańsk,Jagiellonia Białystok,1,2
16387,Lechia Gdańsk,Zagłębie Lubin,1,2
16389,Wisła Kraków,P. Warszawa,0,2
16394,Legia Warszawa,GKS Bełchatów,0,2
16402,Śląsk Wrocław,Lech Poznań,1,2
16404,P. Warszawa,Korona Kielce,1,3
16407,Cracovia,Polonia Bytom,2,3
16426,Legia Warszawa,Lechia Gdańsk,0,3
16429,Polonia Bytom,Jagiellonia Białystok,0,1
16430,Ruch Chorzów,Korona Kielce,0,1
16436,Widzew Łódź,Legia Warszawa,0,1
16438,Lech Poznań,Zagłębie Lubin,0,1
16440,Cracovia,Ruch Chorzów,2,3
16442,Cracovia,Korona Kielce,1,2
16445,Widzew Łódź,Lech Poznań,0,5
16454,Ruch Chorzów,Legia Warszawa,0,1
16455,Widzew Łódź,Widzew Łódź,0,1
16457,Zagłębie Lubin,Lechia Gdańsk,0,1
16459,Polonia Bytom,Ruch Chorzów,1,2
16463,Widzew Łódź,Wisła Kraków,1,2
16468,Korona Kielce,Widzew Łódź,0,2
16470,Ruch Chorzów,P. Warszawa,0,1
16473,Wisła Kraków,Podbeskidzie Bielsko-Biała,0,1
16478,Widzew Łódź,Ruch Chorzów,0,4
16481,Zagłębie Lubin,Śląsk Wrocław,1,5
16483,Jagiellonia Białystok,Śląsk Wrocław,0,2
16488,Wisła Kraków,Polonia Bytom,0,1
16493,Lech Poznań,Widzew Łódź,0,1
16496,Śląsk Wrocław,Wisła Kraków,0,1
16499,Polonia Bytom,Śląsk Wrocław,0,2
16500,Jagiellonia Białystok,Podbeskidzie Bielsko-Biała,0,2
16503,Lechia Gdańsk,P. Warszawa,1,3
16505,Zagłębie Lubin,Legia Warszawa,0,4
16507,Lechia Gdańsk,Jagiellonia Białystok,0,1
16509,Widzew Łódź,Śląsk Wrocław,1,2
16513,Wisła Kraków,P. Warszawa,0,1
16517,Lech Poznań,GKS Bełchatów,0,1
16518,Widzew Łódź,P. Warszawa,0,2
16520,Widzew Łódź,Podbeskidzie Bielsko-Biała,0,1
16526,P. Warszawa,Widzew Łódź,1,2
16528,Śląsk Wrocław,Legia Warszawa,0,4
16529,Wisła Kraków,Korona Kielce,0,1
16530,Cracovia,Legia Warszawa,1,3
16538,Cracovia,Zagłębie Lubin,0,2
16540,Jagiellonia Białystok,Ruch Chorzów,0,1
16543,Lechia Gdańsk,Wisła Kraków,0,2
16548,Podbeskidzie Bielsko-Biała,Legia Warszawa,0,1
16550,Śląsk Wrocław,Korona Kielce,1,2
16562,Cracovia,Polonia Bytom,1,3
16566,Lechia Gdańsk,Podbeskidzie Bielsko-Biała,2,3
16568,Widzew Łódź,Zagłębie Lubin,1,2
16570,GKS Bełchatów,Lechia Gdańsk,1,3
16573,Podbeskidzie Bielsko-Biała,Widzew Łódź,0,1
16575,Widzew Łódź,Ruch Chorzów,1,2
16582,Lechia Gdańsk,Zagłębie Lubin,0,1
16587,Korona Kielce,Zagłębie Lubin,0,2
16597,Legia Warszawa,Lech Poznań,0,1
16598,Widzew Łódź,Korona Kielce,0,2
16599,Podbeskidzie Bielsko-Biała,Wisła Kraków,1,3
16600,P. Warszawa,Ruch Chorzów,0,1
16602,GKS Bełchatów,Korona Kielce,0,2
16608,Widzew Łódź,Lechia Gdańsk,0,1
16610,Cracovia,Ruch Chorzów,0,2
16612,Korona Kielce,Widzew Łódź,0,2
16616,P. Warszawa,Zagłębie Lubin,0,4
16618,GKS Bełchatów,Lech Poznań,0,3
16624,Ruch Chorzów,Śląsk Wrocław,0,1
16632,Wisła Kraków,Śląsk Wrocław,0,1
16639,Legia Warszawa,Śląsk Wrocław,1,2
3,KSV Cercle Brugge,RSC Anderlecht,0,3
5,FCV Dender EH,Standard de Liège,1,3
8,Tubize,Royal Excel Mouscron,1,2
11,Standard de Liège,Sporting Charleroi,1,2
12,SV Zulte-Waregem,KAA Gent,0,2
15,KV Mechelen,KSV Roeselare,1,2
16,Royal Excel Mouscron,KSV Cercle Brugge,0,1
17,Tubize,KRC Genk,1,3
18,Beerschot AC,RSC Anderlecht,1,3
19,RSC Anderlecht,Sporting Lokeren,2,3
24,KSV Roeselare,Tubize,1,2
27,Beerschot AC,Standard de Liège,1,3
39,RAEC Mons,Club Brugge KV,1,2
42,KAA Gent,KRC Genk,2,3
45,Beerschot AC,Sporting Lokeren,0,2
50,FCV Dender EH,RSC Anderlecht,0,2
56,Standard de Liège,SV Zulte-Waregem,1,2
58,Sporting Charleroi,KV Mechelen,1,2
64,Club Brugge KV,Standard de Liège,1,4
70,KSV Roeselare,RSC Anderlecht,0,3
72,KVC Westerlo,KSV Cercle Brugge,1,2
84,RSC Anderlecht,KSV Cercle Brugge,1,2
85,RAEC Mons,KAA Gent,1,2
90,Sporting Charleroi,KVC Westerlo,1,2
92,KAA Gent,RSC Anderlecht,1,2
93,KVC Westerlo,Standard de Liège,0,1
98,KSV Cercle Brugge,KV Kortrijk,0,1
99,FCV Dender EH,Beerschot AC,0,1
109,KV Kortrijk,RSC Anderlecht,1,3
110,Sporting Lokeren,KRC Genk,1,2
112,Sporting Charleroi,KAA Gent,2,5
End Exploring Related Columns
Task: In each league, considering all seasons, which single team has the fewest total match wins based on comparing home and away goals, including teams with zero wins, ensuring that if multiple teams tie for the fewest wins, only one team is returned for each league?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
League_Name,Team_Name,Total_Wins
league_name1:str,team_name1:str,num_wins1:int
league_name2:str,team_name2:str,num_wins2:int
...
(Attention: answer in one row per league)
```

Explanation:
For each league, the team with the fewest total match wins is listed based on comparing home and away goals over all seasons, including teams with zero wins. If multiple teams tie for the fewest wins, only one team is returned per league..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'EU_SOCCER': {'EU_SOCCER': ['PLAYER', 'COUNTRY', 'PLAYER_ATTRIBUTES', 'SQLITE_SEQUENCE', 'LEAGUE', 'MATCH', 'TEAM', 'TEAM_ATTRIBUTES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 12:04:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 12:04:51 - root - INFO - ```sql
WITH 
teams_in_league AS (
    SELECT DISTINCT
        m."league_id",
        l."name" AS "league_name",
        t."team_api_id",
        t."team_long_name"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.TEAM t
        ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
        JOIN EU_SOCCER.EU_SOCCER.LEAGUE l
        ON l."id" = m."league_id"
),
home_wins AS (
    SELECT
        m."league_id",
        m."home_team_api_id" AS "team_api_id",
        COUNT(*) AS "wins"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    WHERE
        m."home_team_goal" > m."away_team_goal"
    GROUP BY
        m."league_id", m."home_team_api_id"
),
away_wins AS (
    SELECT
        m."league_id",
        m."away_team_api_id" AS "team_api_id",
        COUNT(*) AS "wins"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    WHERE
        m."away_team_goal" > m."home_team_goal"
    GROUP BY
        m."league_id", m."away_team_api_id"
),
total_wins_per_team AS (
    SELECT "league_id", "team_api_id", SUM("wins") AS "total_wins"
    FROM (
        SELECT * FROM home_wins
        UNION ALL
        SELECT * FROM away_wins
    ) win_union
    GROUP BY "league_id", "team_api_id"
),
teams_with_wins AS (
    SELECT
        til."league_id",
        til."league_name",
        til."team_api_id",
        til."team_long_name",
        COALESCE(twpt."total_wins", 0) AS "total_wins"
    FROM
        teams_in_league til
        LEFT JOIN total_wins_per_team twpt
        ON til."league_id" = twpt."league_id" AND til."team_api_id" = twpt."team_api_id"
)
SELECT
    "league_name",
    "team_name",
    "total_wins"
FROM (
    SELECT
        tw."league_name",
        tw."team_long_name" AS "team_name",
        tw."total_wins",
        ROW_NUMBER() OVER (
            PARTITION BY tw."league_name"
            ORDER BY tw."total_wins" ASC, tw."team_long_name" ASC
        ) AS rn
    FROM
        teams_with_wins tw
) subquery
WHERE
    rn = 1
ORDER BY
    "league_name";
```
2025-02-10 12:04:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:04:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:04:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:04:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-02-10 12:04:52 - snowflake.connector.connection - INFO - closed
2025-02-10 12:04:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:04:52 - root - INFO - itercount: 1
2025-02-10 12:04:52 - root - INFO - 0
2025-02-10 12:04:52 - root - INFO - results: 
league_name,team_name,total_wins
Belgium Jupiler League,KAS Eupen,5
England Premier League,Reading,6
France Ligue 1,AC Arles-Avignon,3
Germany 1. Bundesliga,DSC Arminia Bielefeld,4
Italy Serie A,Novara,6
Netherlands Eredivisie,FC Dordrecht,4
Poland Ekstraklasa,Termalica Bruk-Bet Nieciecza,8
Portugal Liga ZON Sagres,FC Penafiel,5
Scotland Premier League,Dunfermline Athletic,5
Spain LIGA BBVA,Córdoba CF,3
Switzerland Super League,Lugano,9


2025-02-10 12:04:52 - root - INFO - Please check the answer again by reviewing In each league, considering all seasons, which single team has the fewest total match wins based on comparing home and away goals, including teams with zero wins, ensuring that if multiple teams tie for the fewest wins, only one team is returned for each league?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
League_Name,Team_Name,Total_Wins
league_name1:str,team_name1:str,num_wins1:int
league_name2:str,team_name2:str,num_wins2:int
...
(Attention: answer in one row per league)
```

Explanation:
For each league, the team with the fewest total match wins is listed based on comparing home and away goals over all seasons, including teams with zero wins. If multiple teams tie for the fewest wins, only one team is returned per league. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
league_name,team_name,total_wins
Belgium Jupiler League,KAS Eupen,5
England Premier League,Reading,6
France Ligue 1,AC Arles-Avignon,3
Germany 1. Bundesliga,DSC Arminia Bielefeld,4
Italy Serie A,Novara,6
Netherlands Eredivisie,FC Dordrecht,4
Poland Ekstraklasa,Termalica Bruk-Bet Nieciecza,8
Portugal Liga ZON Sagres,FC Penafiel,5
Scotland Premier League,Dunfermline Athletic,5
Spain LIGA BBVA,Córdoba CF,3
Switzerland Super League,Lugano,9
Current sql:
WITH 
teams_in_league AS (
    SELECT DISTINCT
        m."league_id",
        l."name" AS "league_name",
        t."team_api_id",
        t."team_long_name"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
        JOIN EU_SOCCER.EU_SOCCER.TEAM t
        ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
        JOIN EU_SOCCER.EU_SOCCER.LEAGUE l
        ON l."id" = m."league_id"
),
home_wins AS (
    SELECT
        m."league_id",
        m."home_team_api_id" AS "team_api_id",
        COUNT(*) AS "wins"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    WHERE
        m."home_team_goal" > m."away_team_goal"
    GROUP BY
        m."league_id", m."home_team_api_id"
),
away_wins AS (
    SELECT
        m."league_id",
        m."away_team_api_id" AS "team_api_id",
        COUNT(*) AS "wins"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    WHERE
        m."away_team_goal" > m."home_team_goal"
    GROUP BY
        m."league_id", m."away_team_api_id"
),
total_wins_per_team AS (
    SELECT "league_id", "team_api_id", SUM("wins") AS "total_wins"
    FROM (
        SELECT * FROM home_wins
        UNION ALL
        SELECT * FROM away_wins
    ) win_union
    GROUP BY "league_id", "team_api_id"
),
teams_with_wins AS (
    SELECT
        til."league_id",
        til."league_name",
        til."team_api_id",
        til."team_long_name",
        COALESCE(twpt."total_wins", 0) AS "total_wins"
    FROM
        teams_in_league til
        LEFT JOIN total_wins_per_team twpt
        ON til."league_id" = twpt."league_id" AND til."team_api_id" = twpt."team_api_id"
)
SELECT
    "league_name",
    "team_name",
    "total_wins"
FROM (
    SELECT
        tw."league_name",
        tw."team_long_name" AS "team_name",
        tw."total_wins",
        ROW_NUMBER() OVER (
            PARTITION BY tw."league_name"
            ORDER BY tw."total_wins" ASC, tw."team_long_name" ASC
        ) AS rn
    FROM
        teams_with_wins tw
) subquery
WHERE
    rn = 1
ORDER BY
    "league_name";
2025-02-10 12:05:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 12:05:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 12:05:51 - root - INFO - ```sql
WITH 
teams_in_league AS (
    SELECT DISTINCT
        m."league_id",
        l."name" AS "league_name",
        t."team_api_id",
        t."team_long_name"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    JOIN EU_SOCCER.EU_SOCCER.TEAM t
        ON t."team_api_id" = m."home_team_api_id" OR t."team_api_id" = m."away_team_api_id"
    JOIN EU_SOCCER.EU_SOCCER.LEAGUE l
        ON l."id" = m."league_id"
),
home_wins AS (
    SELECT
        m."league_id",
        m."home_team_api_id" AS "team_api_id",
        COUNT(*) AS "wins"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    WHERE
        m."home_team_goal" > m."away_team_goal"
    GROUP BY
        m."league_id", m."home_team_api_id"
),
away_wins AS (
    SELECT
        m."league_id",
        m."away_team_api_id" AS "team_api_id",
        COUNT(*) AS "wins"
    FROM
        EU_SOCCER.EU_SOCCER.MATCH m
    WHERE
        m."away_team_goal" > m."home_team_goal"
    GROUP BY
        m."league_id", m."away_team_api_id"
),
total_wins_per_team AS (
    SELECT "league_id", "team_api_id", SUM("wins") AS "total_wins"
    FROM (
        SELECT * FROM home_wins
        UNION ALL
        SELECT * FROM away_wins
    ) win_union
    GROUP BY "league_id", "team_api_id"
),
teams_with_wins AS (
    SELECT
        til."league_id",
        til."league_name",
        til."team_api_id",
        til."team_long_name",
        COALESCE(twpt."total_wins", 0) AS "total_wins"
    FROM
        teams_in_league til
    LEFT JOIN total_wins_per_team twpt
        ON til."league_id" = twpt."league_id" AND til."team_api_id" = twpt."team_api_id"
)
SELECT
    "league_name",
    "team_name",
    "total_wins"
FROM (
    SELECT
        tw."league_name",
        tw."team_long_name" AS "team_name",
        tw."total_wins",
        ROW_NUMBER() OVER (
            PARTITION BY tw."league_name"
            ORDER BY tw."total_wins" ASC, tw."team_long_name" ASC
        ) AS rn
    FROM
        teams_with_wins tw
) subquery
WHERE
    rn = 1
ORDER BY
    "league_name";
```
2025-02-10 12:05:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 12:05:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 12:05:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 12:05:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11
2025-02-10 12:05:52 - snowflake.connector.connection - INFO - closed
2025-02-10 12:05:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 12:05:52 - root - INFO - itercount: 2
2025-02-10 12:05:52 - root - INFO - 0
2025-02-10 12:05:52 - root - INFO - Total iteration counts: 2
