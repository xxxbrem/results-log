2025-02-10 16:47:37 - openai._base_client - INFO - Retrying request to /chat/completions in 0.401920 seconds
2025-02-10 16:49:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:49:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:49:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:49:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:49:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-02-10 16:49:01 - snowflake.connector.connection - INFO - closed
2025-02-10 16:49:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:49:02 - root - INFO - SQL:
SELECT DISTINCT "event_name"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    LIMIT 100;
Results:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open

2025-02-10 16:49:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:49:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:49:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:49:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 16:49:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:49:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:49:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:49:37 - root - INFO - ```sql
SELECT f.value:"value"::STRING AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'quickplay_event_type'
LIMIT 100;
```
2025-02-10 16:49:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:49:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:49:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:49:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 16:49:38 - snowflake.connector.connection - INFO - closed
2025-02-10 16:49:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:51:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:51:07 - root - INFO - ```sql
SELECT t."event_name", f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100;
```
2025-02-10 16:51:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:51:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:51:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:51:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:51:08 - snowflake.connector.connection - INFO - closed
2025-02-10 16:51:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:53:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:53:09 - root - INFO - SQL:
SELECT t."event_name", f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100;
Results:
Too long, hard cut:
event_name,param_key,param_value
level_complete_quickplay,value,"{""int_value"":21}"
level_complete_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_complete_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_complete_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_complete_quickplay,board,"{""string_value"":""S""}"
level_complete_quickplay,value,"{""int_value"":21}"
level_complete_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_complete_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_complete_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_complete_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":2637284676279794021}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_fail_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_fail_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_fail_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_fail_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""game_over""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":2637284676279794027}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""game_over""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":2637284676279794031}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":-2614613710786332224}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_complete_quickplay,value,"{""int_value"":21}"
level_complete_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_complete_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_complete_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571154}"
level_complete_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571152}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571154}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""game_over""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571150}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":5344990970727766676}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":5344990970727766674}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_fail_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewC

2025-02-10 16:53:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:53:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:53:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:53:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:53:10 - snowflake.connector.connection - INFO - closed
2025-02-10 16:53:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:53:11 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Results:
user_pseudo_id
B458770ED6E295374FEEB3A68902CC28
841A68D5D1F94857BEB64225193B2432
EE99F8CB32999A0FDAABBA18B05D4E48
2B5ABA17A30D32531C09DAF2865F9E55
159002C6F393752AD79B3C2E8C7104C7
A8D7DCCA39D8703F2928AD2D7BBB6BE9
F4634EFF4D9470DCA00051E3304B81AF
EBC3581ADA874D494FBE2C7CCF53BF99
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
CEBD783B8F2E96E9F3B9424D4FB130E7
D9AA0EC27AF47514DDB5C664A6EF758A
CFA0F8C5E25A71062E573EF8E6BC9F76
DA48D36D07835B1918BDF831AF83B5EF
EFB696A82D093B3AFBE92FF526DD5CEA
55BFC405FFA33C0781DE73101011E45B
5E624075FDFE3003C34E1138546B2450
EF7772819E807EDBD8DB0F0B5210030E
210C3692734E251EEF4E952BC57DD998
91814809BD9374D5CEDFC6A31727CC55
B1D1ED35873581A23E48C4CD03DDFF81
C80CEE0983AB5B21D3F4B46089FDD9EB
AA35092B507100A45CBF225A23D56864
AFA6BA99FB329CB459E8E57FDE1DF9AE
377303AA2F5C5C80E5AAAD26C029BD5A
91F5161F80D1083CA7B37A08DEC9EC78
B54ED4ED7A122CAD69ED8771E62F4D72
46D808E730894AB0AC6E0F493B6FC864
934A101CA7B97944D05E0FC2ED3E203D
372D9BB5088C4E9000C65B06459B403A
27B1CD26769B068D16FAAF82D4F2C1A8
6B7F85DBAABE78A99689D49CAE22072E
70646770530D6BDEB05AFC16DD2559C2
7ED8C235689771F6B0F29BBF295A346F
56FA726AC14329729C5A9B020B508034
13E6C8A193FF140F7D4222B569DD5B50
81E2E892D1C23CE76B072FA71310829F
28AA4A0542C8873691715C284D13C34B
84E491A60BE52A4C6A438A89FADE283C
0F93A84CB0774C5BAB3E5FF8A72A694D
E643F6549E6C7EA0FD01EF4BF7A40F76
396CD60DADAB9CBA7DDCAF239B477135
EF500E0CF578004836D1D38C8901862B
A3C5BA7BE9F5439A73A57D9010C607A2
96D260425F451E90979EA7417C72A09B
12E5626928FE0885DEEF068683E8BD63
C1A0D9FB3527654CA715A732B5FB5202
4593E981ECEF849FC7DA0F7FDA0F250E
C5B527B0AA7603C4EF8C0ECBBCB5372E
27293EA0B2F41A672E15EF7B1FA21298
04EF01C1F4723249F90F920DF018F16C
CC81C3C01DE545318860C5BFDC6AD31E
EC1A759709685E136767F2C1BA4751ED
1F0D27B8A7E058446D4A6409E2E73B19
68C5F7CFAEAB93924B7B55D7129C0286
C60EACB47CF25AEEFD16C5E332078852
628E501EA1130A3A1C63DC1A3DF9D43A
CA51DAF1373B5C2A16C174AFBD2132A4
1D435E381B7264B0A2DDDC9D911F9AE8
6683CAFB77FB7B60C78CD233EB2B62F7
3E5101BCD089218A0E026C6750673B33
F4EA0F2888792BD62555AD46ED534839
2BFF75BDF9645D51E99CE5148F4847CA
64EA802089E68A699EC86438C9504F94
8065F8E98407106A65D35195984B2258
0EAC48BCE6DA434412A01656309CB1FF
428B364B8F2B42ED8D7C5AD1020705EF
E66C3B8A38C424C7CBE0B5388EE5F77E
27C6D0E213A8121BF39FEA92C19D9144
B621164BDFE39D8021DDA4F652A284A5
A72750663D0181C7817F61B3DD2CA656
FDA4BBBCF1EA2D95CDD77BFC5F00A837
2F4A6CF5C60E72BC578CA0E5189505F7
76690E22DDCE2B1FFA98C6A4376B8EA2
328DC7FE55E8881B2EA668C9A2855BB7
2B90CE94C6039DF03E72FE15B5320ABA
7CA838857E3B7B8C9FC6A34E975FBF22
F655D26B0F7A4093F1D2FFBD5E61B09D
01C784BDB7AF4DC8DAD6DCD21AF56E25
5A7EB17BF7D867AADECA2FDAF0941E88
137944D29FEB9F2C96187C5F6604F5DB
06A302E3A4767793ADBC884143708660
E9DCE2D958652BD58E846DCE86BDD90A
A279C431ACB82BFB2B7A234A6707BCFF
682A8CD0767A569DC68E7AA0201BFBA3
C4411A9EA6C9822AD521C60A4ED25F25
DF7B1F6B6AEF483760B6439EF91BC26A
82B5DB000108639FF0D38F39D7AC46FD
C74B58C4CD2770A1E97D6DC13D42CCAC
81F5705397CE9F0236B2B672AE113154
38328F5729077611D47495753D2C04D1
A7AAA5EF977926DBCF801D15F83EE4A5
32DC4BE3AF515BD8BD59B4DC0052A3AB
33E5EA9FE1E29AC3127D975A5494213D
674EAE8D70D203FEDBE60DEAE2F834CC
0C777BD44F304574371C97674DCD0702
C2B541CA130165D03BA9BA7DC0E79273
E594F4CE9B23146A461021258CC7ACA2
827848D9C0FD18D44110098CEC982CDE
E53BC2A0AD86417B443AF14EE3082C0F

2025-02-10 16:53:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:53:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:53:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:53:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 16:53:12 - snowflake.connector.connection - INFO - closed
2025-02-10 16:53:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:54:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:54:21 - root - INFO - ```sql
SELECT f.value:"value"::STRING AS "board"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100;
```
2025-02-10 16:54:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:54:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:54:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:54:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:54:22 - snowflake.connector.connection - INFO - closed
2025-02-10 16:54:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:56:28 - root - INFO - SQL:
SELECT f.value:"value"::STRING AS "board"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100;
Results:
board
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""M""}"
"{""string_value"":""M""}"
"{""string_value"":""M""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"

2025-02-10 16:56:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 16:56:29 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:30 - root - INFO - SQL:
SELECT DISTINCT f.value:"value"::STRING AS "board"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100
Results:
board
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""M""}"

2025-02-10 16:56:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:56:31 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:31 - root - INFO - SQL:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "initial_engagement"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
WHERE "event_date" BETWEEN '20180801' AND '20180815'
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,initial_engagement
B458770ED6E295374FEEB3A68902CC28,1533178505779007
841A68D5D1F94857BEB64225193B2432,1533176867427006
27293EA0B2F41A672E15EF7B1FA21298,1533153306935005
2B5ABA17A30D32531C09DAF2865F9E55,1533178462868005
159002C6F393752AD79B3C2E8C7104C7,1533170322225002
A8D7DCCA39D8703F2928AD2D7BBB6BE9,1533173221311010
F4634EFF4D9470DCA00051E3304B81AF,1533122457793008
EE99F8CB32999A0FDAABBA18B05D4E48,1533146745626004
EBC3581ADA874D494FBE2C7CCF53BF99,1533142657327001
D41AA91B61872612B5F5F4E42870042C,1533148932154001
45BDDEC4DF8773F88DC51D1AFD145521,1533188760502001
CEBD783B8F2E96E9F3B9424D4FB130E7,1533177960046004
D9AA0EC27AF47514DDB5C664A6EF758A,1533172089171007
55BFC405FFA33C0781DE73101011E45B,1533133455728000
DA48D36D07835B1918BDF831AF83B5EF,1533106869082010
04EF01C1F4723249F90F920DF018F16C,1533171743463003
5E624075FDFE3003C34E1138546B2450,1533124768362004
AEB21692315E4F72D255C75E3584C12E,1533179941598001
91814809BD9374D5CEDFC6A31727CC55,1533130454890010
C80CEE0983AB5B21D3F4B46089FDD9EB,1533125775807005
AFA6BA99FB329CB459E8E57FDE1DF9AE,1533160939121003
CC81C3C01DE545318860C5BFDC6AD31E,1533174742411000
EC1A759709685E136767F2C1BA4751ED,1533171989300007
91F5161F80D1083CA7B37A08DEC9EC78,1533185768243009
46D808E730894AB0AC6E0F493B6FC864,1533192746558000
1F0D27B8A7E058446D4A6409E2E73B19,1533187697905000
934A101CA7B97944D05E0FC2ED3E203D,1533171629414000
C60EACB47CF25AEEFD16C5E332078852,1533164539057002
6B7F85DBAABE78A99689D49CAE22072E,1533182931359001
70646770530D6BDEB05AFC16DD2559C2,1533175639501011
CA51DAF1373B5C2A16C174AFBD2132A4,1533120883539000
1D435E381B7264B0A2DDDC9D911F9AE8,1533156299293002
377303AA2F5C5C80E5AAAD26C029BD5A,1533173763034009
56FA726AC14329729C5A9B020B508034,1533163613073001
6683CAFB77FB7B60C78CD233EB2B62F7,1533141905760015
96161BF2E55C7E32ED5F411432875ECB,1533140485494000
FCA08F9B0DCB6E33A74F672CE7F73BE3,1533174086441008
2BFF75BDF9645D51E99CE5148F4847CA,1533128131133002
8065F8E98407106A65D35195984B2258,1533108915014000
0EAC48BCE6DA434412A01656309CB1FF,1533166965314000
E643F6549E6C7EA0FD01EF4BF7A40F76,1533168309554001
B621164BDFE39D8021DDA4F652A284A5,1533190862200000
32DC4BE3AF515BD8BD59B4DC0052A3AB,1533176193618000
EF500E0CF578004836D1D38C8901862B,1533107128893008
396CD60DADAB9CBA7DDCAF239B477135,1533163578799002
7CA838857E3B7B8C9FC6A34E975FBF22,1533170425858006
96D260425F451E90979EA7417C72A09B,1533176911931003
5A7EB17BF7D867AADECA2FDAF0941E88,1533160163632007
137944D29FEB9F2C96187C5F6604F5DB,1533178052043007
E9DCE2D958652BD58E846DCE86BDD90A,1533128164654000
E594F4CE9B23146A461021258CC7ACA2,1533123042581000
12E5626928FE0885DEEF068683E8BD63,1533134813433004
6C654E9F5D2B57F4F2E2D9F240EC882C,1533128260822001
59772415A60A0B7E16588D219D7B85F1,1533163988816004
76B29DA61902BE1C9F957B66B017DA47,1533149390326000
D0F280B12652EB0D74F6BC74AB13606F,1533118001891001
1FFEE889C95637FE2D229E04149BC23B,1533107176316000
22DC6A6AE86C0AA33EBB8C3164A26925,1533133692594005
B83E97CDE1FCF1D681206DFFC5F1898E,1533108699128002
C8859A791226C6027B90F72F880C3528,1533131587579000
2A4B17256B9DB151E67DA8BE415ED0E6,1533171518038001
0CB6886B20DE2210225F4BAEB575AC71,1533176941588003
E5D16173400729E05DFFB4883FA6EF1C,1533114442632008
F3917138A3D4B03ADA1C2E77E3B84649,1533112715387004
3FC8ECFC8F2976C5B56D0D782F36BD7F,1533135918343001
CFA0F8C5E25A71062E573EF8E6BC9F76,1533145998415006
EFB696A82D093B3AFBE92FF526DD5CEA,1533135323325000
EF7772819E807EDBD8DB0F0B5210030E,1533127746980001
210C3692734E251EEF4E952BC57DD998,1533160417982002
B1D1ED35873581A23E48C4CD03DDFF81,1533125343928006
AA35092B507100A45CBF225A23D56864,1533152437096015
FCB218A1B5C858D56B849CA70EDCF6B4,1533186864456000
B54ED4ED7A122CAD69ED8771E62F4D72,1533142849561000
68C5F7CFAEAB93924B7B55D7129C0286,1533108027819000
628E501EA1130A3A1C63DC1A3DF9D43A,1533181889361001
27B1CD26769B068D16FAAF82D4F2C1A8,1533175933626001
38328F5729077611D47495753D2C04D1,1533118410628007
7ED8C235689771F6B0F29BBF295A346F,1533127531469000
81E2E892D1C23CE76B072FA71310829F,1533162222654004
28AA4A0542C8873691715C284D13C34B,1533162021714007
84E491A60BE52A4C6A438A89FADE283C,1533170476364000
80662734A6A658F7713A71428B9AA027,1533146872376004
3E5101BCD089218A0E026C6750673B33,1533138832510001
A7AAA5EF977926DBCF801D15F83EE4A5,1533119588196000
A72750663D0181C7817F61B3DD2CA656,1533190314648004
C74E5AF2DAC240FA7F3B1612D5AEAA78,1533134373647002
E66C3B8A38C424C7CBE0B5388EE5F77E,1533156611623009
27C6D0E213A8121BF39FEA92C19D9144,1533166265354001
428B364B8F2B42ED8D7C5AD1020705EF,1533156745350012
CABB19A642780994D8EC3CEDC967265F,1533141691400002
EF028BE6C2230A5166A1A247D4687BA3,1533132511316006
76690E22DDCE2B1FFA98C6A4376B8EA2,1533187855561005
A3C5BA7BE9F5439A73A57D9010C607A2,1533129337644001
33E5EA9FE1E29AC3127D975A5494213D,1533176177876013
2B90CE94C6039DF03E72FE15B5320ABA,1533143360031005
674EAE8D70D203FEDBE60DEAE2F834CC,1533127582998014
06A302E3A4767793ADBC884143708660,1533136369906005
0C777BD44F304574371C97674DCD0702,1533130304092014
A279C431ACB82BFB2B7A234A6707BCFF,1533128060037013
C1A0D9FB3527654C

2025-02-10 16:56:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:56:32 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:32 - root - INFO - SQL:
SELECT DISTINCT t2."user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" t2
WHERE t2."event_name" = 'session_start' AND t2."user_pseudo_id" IN (
    SELECT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t1
    WHERE t1."event_name" LIKE '%quickplay%'
)
LIMIT 100
Results:
user_pseudo_id
2AC0EF5047BC538BDA6388E644409B5D
706C748E6D1E0768BFEFE6362B5D3F67
DF0E6C6C5E4F3F34FEC6EE54FD945B05
48AB910A8DE8485D4C34238EA61F782C
FA30269453141794E79B8F15EE0BA5B9
B63075B53A750A67A12F7F19ED5AA835
40B501E0460E254E289A776CFC31DCF2
A95BA9143018CA81430258E8A725C3E6
89BD2B0E233951461CF06C9B4FDA0D81
44A600997B9B6499325D518A19B51FEC
F3CA6D208932C0BD365FE0D589038E1C
1235BA39F8C700F0529EC1A33470BF0C
5B888A06EFF60B86B10367EEC3B44E85
42E6A7C3536775E3B8C3DB919AE9A452
E4196C5E0A92A22F69DE4E3AA288D6EE
9A12E7E2B3CF644B8304DF8E1A9CE2D8
488BE19C45D3D8B2DF02214BC19B44B4
2B5ABA17A30D32531C09DAF2865F9E55
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
6683CAFB77FB7B60C78CD233EB2B62F7
0C777BD44F304574371C97674DCD0702
7386D239899D55E3D62DA619F359A7C0
A064A84CD3CF7058F39333D6212E8615
8E1749E5A26DD54E346476A289854E93
8EDB9A9856CDB5AFC42546106EE46734
D5F9D9AF22EF5073E10342973D48FB2C
841A68D5D1F94857BEB64225193B2432
05FB3382D94C7E963B408FD6CC357D33
DA48D36D07835B1918BDF831AF83B5EF
EFB696A82D093B3AFBE92FF526DD5CEA
CA51DAF1373B5C2A16C174AFBD2132A4
EB1A430BACB37E6EA72592BF838E64A6
FDA4BBBCF1EA2D95CDD77BFC5F00A837
2B90CE94C6039DF03E72FE15B5320ABA
472451071AED6FF801BC0FE66706FD27
EEBCB25D5F056CCF59DDE654388ACD2B
7BF597A11650FE351760281648C7A3F8
6A07135DA41B81E278341576A26672E4
28C4A09298C441D5AFD39E749D9F3DA3
3D1B58553D2E2D4DD5DFCF251D5E23B2
58C58BE1BC4187B0C0192D05F718A1A4
8BD465AC77DC9D8B4C597BF35950FDA3
17934EF7C1BC1CF2C7D942401FDE84CE
6A2F4E7AB1816D2F6EC741BC92141766
8601A3659DC5C1F0444E5CCDA5ED3E14
D9AA0EC27AF47514DDB5C664A6EF758A
AFA6BA99FB329CB459E8E57FDE1DF9AE
91D637F0D9FB259AD52773B1B20151BE
F815B0069F973BFA743EF90A85224109
7F811674D65C2E02A6A705E97799E372
932AAF56DDE9C55359B9CCFA18E7FB95
84E491A60BE52A4C6A438A89FADE283C
0CAAA1B6F161BA4D363EB7A2DEF64A08
F5DAD8DD17B689CF672D65A0A81CF4AC
8211CABE9A3F1FE1BF3154E0C8D30368
FE3331C93B8A54B8C9145532FFAD704A
C7E2273D8B11257FCCC915D27C1FCA24
210C3692734E251EEF4E952BC57DD998
A19F659EA9BA36A3595F088F30A6B7E7
C80CEE0983AB5B21D3F4B46089FDD9EB
1B3AD9683D475EFB398E131DFE65AE61
FEDC59699D8832A11B88BFCCCAD0951D
8765E2797C05DF924237C185AFA365BA
A0616D4E494DC3BCCB94B8B6E5B48380
CA04708DA02378999ECB402481FF1AE4
1213ED1E96B0A49B51C0F7683DB2ACCC
45EB0927832513B89E58E6C6C93D841C
9BC94B3773C8304A9E101AEBCFEF4A5F
295D9E24D8DE65A010313E667131EF19
77F5E9A5630151C9E831156AEAB4DA11
7E40E634997585B0C69B6F67C01C191B
D0F280B12652EB0D74F6BC74AB13606F
E6FEE8B98E75EA5311FE004F98559A27
0E05F56141200FF41FCC0C7FA297FF08
959635567E419A061EECCCA478EDC718
3DEB0C12C49AD19D7ACE68FA59E7ACD6
59BE43F3FE7AB3F91B016B56508D4C46
9DE945166BCD4709696C5836317DDE47
59454BAC415BB1F18517C6FD2C023E49
8F69F63C94FC7045651B1B164AE7B379
B1D1ED35873581A23E48C4CD03DDFF81
372D9BB5088C4E9000C65B06459B403A
10B0D468B5E036E16D13DB53A65F2D49
13E6C8A193FF140F7D4222B569DD5B50
A7AAA5EF977926DBCF801D15F83EE4A5
F4EA0F2888792BD62555AD46ED534839
EF500E0CF578004836D1D38C8901862B
8252847DECB3C31CAB9BDEE566F97BA2
12E5626928FE0885DEEF068683E8BD63
74375465CD17299EBC7C75A1B4047EE0
B5395F8C2077B59B3D6C5719C0CA0339
C5B527B0AA7603C4EF8C0ECBBCB5372E
82B5DB000108639FF0D38F39D7AC46FD
0CB6886B20DE2210225F4BAEB575AC71
3875A92B5F5C2BBA1355CED06A986079
E80C958E3C33898989A30B8F5A4514F0
3D03A380687FE3369E93915D50C572CB
C6DE585349744A40725DB0AB17041BA3
635808C1DDFBC662DC3015097E26E62A

2025-02-10 16:56:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 16:56:33 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:34 - root - INFO - SQL:
SELECT f.value:"value"::STRING AS "board_type", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
GROUP BY "board_type"
LIMIT 100
Results:
board_type,user_count
"{""string_value"":""S""}",273
"{""string_value"":""M""}",38
"{""string_value"":""L""}",33

2025-02-10 16:56:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 16:56:35 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:35 - root - INFO - SQL:
SELECT q."board_type", COUNT(DISTINCT s."user_pseudo_id") AS "retained_users"
FROM (
    SELECT t."user_pseudo_id", f.value:"value"::STRING AS "board_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
) q
JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" s
ON q."user_pseudo_id" = s."user_pseudo_id"
WHERE s."event_name" = 'session_start'
GROUP BY q."board_type"
LIMIT 100
Results:
board_type,retained_users
"{""string_value"":""S""}",110
"{""string_value"":""L""}",15
"{""string_value"":""M""}",19

2025-02-10 16:56:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:56:36 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:37 - root - INFO - SQL:
SELECT t."user_pseudo_id", t."event_name", t."event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."user_pseudo_id" NOT IN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
)
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
B458770ED6E295374FEEB3A68902CC28,session_start,1533178516177000
B458770ED6E295374FEEB3A68902CC28,session_start,1533186548206000
B458770ED6E295374FEEB3A68902CC28,level_complete_quickplay,1533178706133033
B458770ED6E295374FEEB3A68902CC28,level_complete_quickplay,1533186675592002
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178649867023
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178654065028
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178577238001
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178589239002
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178544470012
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178619839003
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178634839004
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178592839005
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178622840006
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178572533010
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178645114013
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178637114014
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178632893019
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178659866022
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178680673037
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178700673038
B458770ED6E295374FEEB3A68902CC28,screen_view,1533186529737004
B458770ED6E295374FEEB3A68902CC28,screen_view,1533186639178006
B458770ED6E295374FEEB3A68902CC28,screen_view,1533186655178007
B458770ED6E295374FEEB3A68902CC28,post_score,1533178694133031
B458770ED6E295374FEEB3A68902CC28,post_score,1533186632592000
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178513674000
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay,1533178505779007
B458770ED6E295374FEEB3A68902CC28,level_end_quickplay,1533178604533011
B458770ED6E295374FEEB3A68902CC28,level_fail_quickplay,1533178616533012
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay,1533178652337015
B458770ED6E295374FEEB3A68902CC28,level_end_quickplay,1533178757133032
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay,1533186595977000
B458770ED6E295374FEEB3A68902CC28,level_end_quickplay,1533186658592001
B458770ED6E295374FEEB3A68902CC28,select_content,1533178513778006
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178510469009
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178587838000
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178625531007
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178606892016
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178728673034
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178759086039
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533186577737001
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533186608176003
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533186609960008
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178609064025
27293EA0B2F41A672E15EF7B1FA21298,session_start,1533153346436000
27293EA0B2F41A672E15EF7B1FA21298,error,1533153565261001
27293EA0B2F41A672E15EF7B1FA21298,level_complete_quickplay,1533153427747002
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153526463016
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153306935005
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153390935006
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153403144011
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153501316006
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153480317007
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153500660012
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153552462015
27293EA0B2F41A672E15EF7B1FA21298,post_score,1533153501747000
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153386415003
27293EA0B2F41A672E15EF7B1FA21298,level_start_quickplay,1533153377417008
27293EA0B2F41A672E15EF7B1FA21298,level_end_quickplay,1533153501747001
27293EA0B2F41A672E15EF7B1FA21298,level_start_quickplay,1533153554895008
27293EA0B2F41A672E15EF7B1FA21298,select_content,1533153354416007
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153335144010
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153440315003
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153483659009
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153572283002
EE99F8CB32999A0FDAABBA18B05D4E48,app_update,1533146745626004
EE99F8CB32999A0FDAABBA18B05D4E48,session_start,1533146807631000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533146992865000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533146982986000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533147027807000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533147036897000
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533146989865070
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533146947986003
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533146975807003
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533147097897008
EE99F8CB32999A0FDAABBA18B05D4E48,screen_view,1533146967161058
EE99F8CB32999A0FDAABBA18B05D4E48,screen_view,15331470301

2025-02-10 16:56:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:56:38 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:38 - root - INFO - SQL:
SELECT f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100
Results:
Too long, hard cut:
param_key,param_value
value,"{""int_value"":21}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
value,"{""int_value"":21}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794021}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794027}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794031}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-2614613710786332224}"
board,"{""string_value"":""S""}"
value,"{""int_value"":21}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571154}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571152}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571154}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571150}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766676}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766682}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
value,"{""int_value"":29}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-6841316843749891991}"
board,"{""string_value"":""M""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-6841316843749891989}"
board,"{""string_value"":""M""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-6841316843749891991}"
board,"{""string_value"":""M""}"
value,"{""int_value"":22}"
firebase_screen_class,"{""string_va

2025-02-10 16:56:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:56:39 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:39 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS "session_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
WHERE "event_name" = 'session_start'
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
user_pseudo_id,session_count
1879629E259EAE7CC648E2F33CD77776,1
68495553C4E4675C74F6476A12E92ADB,1
E6850F5E0DAB3E339C6A36BDEECCA26F,1
102CC7D8CD5D3E861EACE1BAB97E61EC,3
023A2DB99CC3F70A4B71869C36952D74,1
7CDC52F058F406CC41FCDC16E464342A,2
9BC94B3773C8304A9E101AEBCFEF4A5F,1
295D9E24D8DE65A010313E667131EF19,2
B081E087ABDC8FE6FB390ACF48CD61D8,1
58230465C695B0FDDDAE08A481FAEECC,1
4BB019F8F6D1FE7BA78CA42A4698EF56,1
F4810B35D08410542741137BD5FD3326,1
17636078D57884AD7EA5406C60E2BD10,1
77F5E9A5630151C9E831156AEAB4DA11,1
4A93C01615B33FF5804AF8D19895247F,1
08B7AEC83DA53E917D595FE60C2CB600,1
45FB547C5857493104687C234EDCDE37,2
2AC0EF5047BC538BDA6388E644409B5D,1
BB322D2CA948F548EA3A05A2BD93B1A3,2
525D2BA85EFE112B955CD3B19909E059,3
7E40E634997585B0C69B6F67C01C191B,1
B9D8DF9BE543DEFAEDC13BF8903A859A,1
8CBA9954233F9C12C693325C6BC60D74,2
57EC50FBC6C7277B8EDCCE44C1352BD4,5
706C748E6D1E0768BFEFE6362B5D3F67,1
F815B0069F973BFA743EF90A85224109,1
D0F280B12652EB0D74F6BC74AB13606F,1
1E829A6853724F89B436A122FE010198,2
EECDCA8076D5842922767F5C08957B17,1
54827B02505D08E40E29E608008431B4,1
383F4B98EC31DD2A915427D36A30354E,1
6A2F4E7AB1816D2F6EC741BC92141766,1
797844212D53A601F14C15BAB621F67E,1
1CF315BC6864E7A71A81E47925E18A61,1
ECB676BED33FDF42E1B0DCF234E1344B,1
0E05F56141200FF41FCC0C7FA297FF08,4
E6FEE8B98E75EA5311FE004F98559A27,2
FA30269453141794E79B8F15EE0BA5B9,1
A421EBCE8AA69A980AAFC4F141BDEFFB,1
91381A6BC5F5E06D1B8DEFD96761751C,1
88A41BFED275BB69125BE1F5524F3B42,2
A95BA9143018CA81430258E8A725C3E6,3
184B6DE721CD75D84BB9975E19003195,1
F4F4EAE9439622EA3CA9489A52E7230F,2
1CE19ED5366D09B6A3E9CCD4AA475B85,2
079E84FBF40BA6D3E74C7E61A7BD4F91,1
A9F5CC6811A363B671124943547E3631,1
5145D8121071A9EA903A1098034962F6,1
89BD2B0E233951461CF06C9B4FDA0D81,2
F81A7FACD9640F8169D8DE2E27D217E6,3
F187F3F6C0DFB1FA23483A67AA31A16D,1
9F10D203085E22749FAB8E6A2DB1BABA,2
488908B4727978E9813DD50CB3E7F330,1
7F811674D65C2E02A6A705E97799E372,1
6C14B6297FCC1782508E14996A4DBB7C,1
F34FF1C9F0C022B684BC885BA1DDC260,2
812A0C9302E7E1A711B416C0904C99CD,1
C6DE585349744A40725DB0AB17041BA3,1
488BE19C45D3D8B2DF02214BC19B44B4,1
EBC3581ADA874D494FBE2C7CCF53BF99,2
ADDC25F2E0EE2C18855F0D850EBE2A8C,1
F1555004E0D95599AF2F2B8EA130A9C3,3
56A3ECD9106EA59DE52682BEFFFAC53C,1
7CC61FB109657777ADD59480BC290F29,1
2F0F260BD7B876C346B41977D0D03D62,3
A70504A67EE34DD45EF82BFF86E9F94D,1
448F4402131C2DE70EC67F04D4BF5719,1
52332E7857233EC06090B1059F0C6292,1
27954A1D70BCD7F326F926A5D5B666E6,1
E080406D26F71C9B8F331779CE8B82BA,1
05F7B2C58D627CE948B06C10E39CDF91,1
48AB910A8DE8485D4C34238EA61F782C,6
64E0BF319001686AAB32B5120FFA0167,1
B63075B53A750A67A12F7F19ED5AA835,3
0ED6BC1D319AB5BD1F245628EA47EDBB,1
40B501E0460E254E289A776CFC31DCF2,5
C04D8138266E1439C156ABE4E82F4706,1
7566596A1D6ACA781692A7A0B89B06EF,2
9278A7C15D0307622E7A0305C4091A91,1
835F907F89D3CB8B5010D980D7F2AED5,2
44A600997B9B6499325D518A19B51FEC,1
F3CA6D208932C0BD365FE0D589038E1C,1
F24F41EC0396166669C20DFC3CFBC7D3,1
3DEB0C12C49AD19D7ACE68FA59E7ACD6,2
42B0EA9C46944FD3177C30038D4970B3,2
A62D86FAFF43F1EC89D6F867915D7D56,1
3BF1D92C836CBAFACDD2063848BAB11C,2
CE3E59F2C2C3BD7F1C8FB80D53CF0F3B,1
9DE945166BCD4709696C5836317DDE47,1
C78B719086D5C386E072A891285D8933,2
5B9149282B2EB48FE5AFE1240FC0440E,3
FEDC59699D8832A11B88BFCCCAD0951D,1
E19F04BAB15FBA761833F71BCF5D97D3,2
30B0DA9467C7DC2B85C4C72815775B67,1
59454BAC415BB1F18517C6FD2C023E49,2
490F592DDAB95F2590917ACA94B377C6,1
2A78A1F772DEA29CA407EDE2D31A2D7F,1
959D4D83EB7DA9966F66F133B20BF016,1
8E1749E5A26DD54E346476A289854E93,3
5B888A06EFF60B86B10367EEC3B44E85,1

2025-02-10 16:56:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-10 16:56:40 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:56:41 - root - INFO - SQL:
SELECT DISTINCT t."platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" t
WHERE t."event_name" = 'session_start' AND t."user_pseudo_id" IN (
    SELECT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    WHERE "event_name" LIKE '%quickplay%'
)
LIMIT 100
Results:
platform
ANDROID
IOS

2025-02-10 16:56:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:56:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:56:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:56:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:56:42 - snowflake.connector.connection - INFO - closed
2025-02-10 16:56:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:57:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:57:15 - root - INFO - ```sql
SELECT t."user_pseudo_id", t."device":"mobile_model_name"::STRING AS "device_model"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."event_name" LIKE '%quickplay%' AND t."device":"mobile_model_name" IS NOT NULL
LIMIT 100;
```
2025-02-10 16:57:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:57:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:57:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:57:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:57:16 - snowflake.connector.connection - INFO - closed
2025-02-10 16:57:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:58:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:58:30 - root - INFO - SQL:
SELECT t."user_pseudo_id", t."device":"mobile_model_name"::STRING AS "device_model"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."event_name" LIKE '%quickplay%' AND t."device":"mobile_model_name" IS NOT NULL
LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,device_model
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
841A68D5D1F94857BEB64225193B2432,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
2B5ABA17A30D32531C09DAF2865F9E55,not available in demo dataset
2B5ABA17A30D32531C09DAF2865F9E55,not available in demo dataset
2B5ABA17A30D32531C09DAF2865F9E55,not available in demo dataset
159002C6F393752AD79B3C2E8C7104C7,not available in demo dataset
159002C6F393752AD79B3C2E8C7104C7,not available in demo dataset
159002C6F393752AD79B3C2E8C7104C7,not available in demo dataset
A8D7DCCA39D8703F2928AD2D7BBB6BE9,not available in demo dataset
A8D7DCCA39D8703F2928AD2D7BBB6BE9,not available in demo dataset
A8D7DCCA39D8703F2928AD2D7BBB6BE9,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
EBC3581ADA874D494FBE2C7CCF53BF99,not available in demo dataset
EBC3581ADA874D494FBE2C7CCF53BF99,not available in demo dataset
EBC3581ADA874D494FBE2C7CCF53BF99,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
45BDDEC4DF8773F88DC51D1AFD145521,not available in demo dataset
45BDDEC4DF8773F88DC51D1AFD145521,not available in demo dataset
45BDDEC4DF8773F88DC51D1AFD145521,not available in demo dataset
CEBD783B8F2E96E9F3B9424D4FB130E7,not available in demo dataset
CEBD783B8F2E96E9F3B9424D4FB130E7,not available in demo dataset
CEBD783B8F2E96E9F3B9424D4FB130E7,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dat

2025-02-10 16:58:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:58:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:58:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:58:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:58:31 - snowflake.connector.connection - INFO - closed
2025-02-10 16:58:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:59:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:59:32 - root - INFO - ```sql
SELECT t."platform", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."event_name" LIKE '%quickplay%' AND t."user_pseudo_id" NOT IN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
)
GROUP BY t."platform"
LIMIT 100;
```
2025-02-10 16:59:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:59:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:59:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:59:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-10 16:59:33 - snowflake.connector.connection - INFO - closed
2025-02-10 16:59:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 17:00:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 17:00:40 - root - INFO - SQL:
SELECT t."platform", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."event_name" LIKE '%quickplay%' AND t."user_pseudo_id" NOT IN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
)
GROUP BY t."platform"
LIMIT 100;
Results:
platform,user_count
IOS,91
ANDROID,105

2025-02-10 17:00:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 17:00:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 17:00:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 17:00:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 17:00:41 - snowflake.connector.connection - INFO - closed
2025-02-10 17:00:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 17:00:42 - root - INFO - SQL:
SELECT
    f.value:"value":"string_value"::STRING AS "board_type",
    COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM
    "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
WHERE
    t."event_name" LIKE '%quickplay%' AND
    f.value:"key"::STRING = 'board'
GROUP BY
    "board_type"
LIMIT 100
Results:
board_type,user_count
S,273
L,33
M,38

2025-02-10 17:00:42 - root - INFO - itercount: 0
2025-02-10 17:00:42 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googles public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measures how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (17 days) and week 3 (1521 days) but not week 2 (814 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (17 days), week 2 (814 days), and week 3 (1521 days) but not week 4 (2228 days).

By calculating these metrics, companies can evaluate how well their products hold users interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}
Begin Exploring Related Columns
Relevant columns and their potential usage:

- `"event_name"`: Used to filter specific event types such as `'session_start'` and `'quickplay'`.
- `"event_timestamp"`: Used to determine event dates and times, identify initial engagements, and calculate the second-week window after initial engagement.
- `"user_pseudo_id"`: Unique identifier for users, used to track user activity over time.
- `"event_params"`: A VARIANT column containing nested JSON data; can be flattened to extract the `'quickplay_event_type'`.
- `"event_date"`: Used to filter events by date (in `'YYYYMMDD'` format).

Conditions that may be used:

- Filter events where `"event_name"` equals `'quickplay'` or `'session_start'`.
- Filter `"event_timestamp"` to select events between August 1 and August 15, 2018.
- Extract `'quickplay_event_type'` from `"event_params"` for `'quickplay'` events.
- Identify users' initial engagement dates.
- Determine if users had `'session_start'` events during the second week after their initial engagement.

---

**SQL Queries:**

1. **Retrieve distinct event names to understand the types of events recorded:**

    ```sql
    SELECT DISTINCT "event_name"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    LIMIT 100;
    ```

2. **List all events for a specific user to see their activity:**

    ```sql
    SELECT "event_name", "event_timestamp", "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    WHERE "user_pseudo_id" = 'some_user_id'
    LIMIT 100;
    ```

3. **Find users who had a `'quickplay'` event between August 1 and August 15, 2018:**

    ```sql
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    WHERE "event_name" = 'quickplay'
    LIMIT 100;
    ```

4. **Extract the `'quickplay_event_type'` from `"event_params"` for `'quickplay'` events:**

    ```sql
    SELECT f.value:"value"::STRING AS "quickplay_event_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'quickplay' AND f.value:"key"::STRING = 'quickplay_event_type'
    LIMIT 100;
    ```

5. **List distinct `'quickplay_event_type'` values to identify different types:**

    ```sql
    SELECT DISTINCT f.value:"value"::STRING AS "quickplay_event_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'quickplay' AND f.value:"key"::STRING = 'quickplay_event_type'
    LIMIT 100;
    ```

6. **Find the initial engagement date for each user between August 1 and August 15, 2018:**

    ```sql
    SELECT "user_pseudo_id", MIN("event_timestamp") AS "initial_engagement"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    GROUP BY "user_pseudo_id"
    LIMIT 100;
    ```

7. **Identify users who had a `'session_start'` event during the second week after their initial engagement:**

    ```sql
    SELECT DISTINCT t2."user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" t2
    WHERE t2."event_name" = 'session_start' AND t2."user_pseudo_id" IN (
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t1
        WHERE t1."event_name" = 'quickplay'
    )
    LIMIT 100;
    ```

8. **Calculate the number of users per `'quickplay_event_type'` during the initial engagement period:**

    ```sql
    SELECT f.value:"value"::STRING AS "quickplay_event_type", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'quickplay' AND f.value:"key"::STRING = 'quickplay_event_type'
    GROUP BY "quickplay_event_type"
    LIMIT 100;
    ```

9. **Determine the retention rate for each `'quickplay_event_type'` by finding users who returned in the second week:**

    ```sql
    SELECT q."quickplay_event_type", COUNT(DISTINCT s."user_pseudo_id") AS "retained_users"
    FROM (
        SELECT t."user_pseudo_id", f.value:"value"::STRING AS "quickplay_event_type"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
        LATERAL FLATTEN(input => t."event_params") f
        WHERE t."event_name" = 'quickplay' AND f.value:"key"::STRING = 'quickplay_event_type'
    ) q
    JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" s
    ON q."user_pseudo_id" = s."user_pseudo_id"
    WHERE s."event_name" = 'session_start'
    GROUP BY q."quickplay_event_type"
    LIMIT 100;
    ```

10. **List events for users who did not return in the second week to identify potential drop-off points:**

    ```sql
    SELECT t."user_pseudo_id", t."event_name", t."event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
    WHERE t."user_pseudo_id" NOT IN (
        SELECT DISTINCT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        WHERE "event_name" = 'session_start'
    )
    LIMIT 100;
    ```

11. **Extract other parameters from `"event_params"` to see what additional data is available:**

    ```sql
    SELECT f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'quickplay'
    LIMIT 100;
    ```

12. **Find the total number of `'session_start'` events per user during the second week:**

    ```sql
    SELECT "user_pseudo_id", COUNT(*) AS "session_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
    GROUP BY "user_pseudo_id"
    LIMIT 100;
    ```

13. **Identify the platform used by users who returned in the second week:**

    ```sql
    SELECT DISTINCT t."platform"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" t
    WHERE t."event_name" = 'session_start' AND t."user_pseudo_id" IN (
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
        WHERE "event_name" = 'quickplay'
    )
    LIMIT 100;
    ```

14. **Check if device information influences retention by extracting device models:**

    ```sql
    SELECT t."user_pseudo_id", t."device"::VARIANT:"device_model"::STRING AS "device_model"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
    WHERE t."event_name" = 'quickplay'
    LIMIT 100;
    ```

15. **Analyze geographic distribution of users who did not return in the second week:**

    ```sql
    SELECT t."geo"::VARIANT:"country"::STRING AS "country", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
    WHERE t."event_name" = 'quickplay' AND t."user_pseudo_id" NOT IN (
        SELECT DISTINCT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        WHERE "event_name" = 'session_start'
    )
    GROUP BY "country"
    LIMIT 100;
    ```

These queries help in understanding the data structure and exploring the necessary columns and conditions required to calculate the user retention rate per `'quickplay_event_type'`. By examining users' activity, event parameters, and engagement over time, you can derive insights into retention patterns during the second week after initial engagement.Query:
SELECT DISTINCT "event_name"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    LIMIT 100;
Answer:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open
Query:
SELECT t."event_name", f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100;
Answer:
Too long, hard cut:
event_name,param_key,param_value
level_complete_quickplay,value,"{""int_value"":21}"
level_complete_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_complete_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_complete_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_complete_quickplay,board,"{""string_value"":""S""}"
level_complete_quickplay,value,"{""int_value"":21}"
level_complete_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_complete_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_complete_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_complete_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":2637284676279794021}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_fail_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_fail_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_fail_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_fail_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""game_over""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":2637284676279794027}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""game_over""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":2637284676279794031}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":2637284676279794019}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":-2614613710786332224}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_complete_quickplay,value,"{""int_value"":21}"
level_complete_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_complete_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_complete_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571154}"
level_complete_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571152}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571154}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""game_over""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":-7592093320680571150}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_start_quickplay,firebase_screen_class,"{""string_value"":""main_menu""}"
level_start_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_start_quickplay,firebase_screen_id,"{""int_value"":5344990970727766676}"
level_start_quickplay,board,"{""string_value"":""S""}"
level_end_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewController""}"
level_end_quickplay,firebase_event_origin,"{""string_value"":""app+gtm""}"
level_end_quickplay,firebase_screen_id,"{""int_value"":5344990970727766674}"
level_end_quickplay,board,"{""string_value"":""S""}"
level_fail_quickplay,firebase_screen_class,"{""string_value"":""FIRootViewC
Query:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
user_pseudo_id
B458770ED6E295374FEEB3A68902CC28
841A68D5D1F94857BEB64225193B2432
EE99F8CB32999A0FDAABBA18B05D4E48
2B5ABA17A30D32531C09DAF2865F9E55
159002C6F393752AD79B3C2E8C7104C7
A8D7DCCA39D8703F2928AD2D7BBB6BE9
F4634EFF4D9470DCA00051E3304B81AF
EBC3581ADA874D494FBE2C7CCF53BF99
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
CEBD783B8F2E96E9F3B9424D4FB130E7
D9AA0EC27AF47514DDB5C664A6EF758A
CFA0F8C5E25A71062E573EF8E6BC9F76
DA48D36D07835B1918BDF831AF83B5EF
EFB696A82D093B3AFBE92FF526DD5CEA
55BFC405FFA33C0781DE73101011E45B
5E624075FDFE3003C34E1138546B2450
EF7772819E807EDBD8DB0F0B5210030E
210C3692734E251EEF4E952BC57DD998
91814809BD9374D5CEDFC6A31727CC55
B1D1ED35873581A23E48C4CD03DDFF81
C80CEE0983AB5B21D3F4B46089FDD9EB
AA35092B507100A45CBF225A23D56864
AFA6BA99FB329CB459E8E57FDE1DF9AE
377303AA2F5C5C80E5AAAD26C029BD5A
91F5161F80D1083CA7B37A08DEC9EC78
B54ED4ED7A122CAD69ED8771E62F4D72
46D808E730894AB0AC6E0F493B6FC864
934A101CA7B97944D05E0FC2ED3E203D
372D9BB5088C4E9000C65B06459B403A
27B1CD26769B068D16FAAF82D4F2C1A8
6B7F85DBAABE78A99689D49CAE22072E
70646770530D6BDEB05AFC16DD2559C2
7ED8C235689771F6B0F29BBF295A346F
56FA726AC14329729C5A9B020B508034
13E6C8A193FF140F7D4222B569DD5B50
81E2E892D1C23CE76B072FA71310829F
28AA4A0542C8873691715C284D13C34B
84E491A60BE52A4C6A438A89FADE283C
0F93A84CB0774C5BAB3E5FF8A72A694D
E643F6549E6C7EA0FD01EF4BF7A40F76
396CD60DADAB9CBA7DDCAF239B477135
EF500E0CF578004836D1D38C8901862B
A3C5BA7BE9F5439A73A57D9010C607A2
96D260425F451E90979EA7417C72A09B
12E5626928FE0885DEEF068683E8BD63
C1A0D9FB3527654CA715A732B5FB5202
4593E981ECEF849FC7DA0F7FDA0F250E
C5B527B0AA7603C4EF8C0ECBBCB5372E
27293EA0B2F41A672E15EF7B1FA21298
04EF01C1F4723249F90F920DF018F16C
CC81C3C01DE545318860C5BFDC6AD31E
EC1A759709685E136767F2C1BA4751ED
1F0D27B8A7E058446D4A6409E2E73B19
68C5F7CFAEAB93924B7B55D7129C0286
C60EACB47CF25AEEFD16C5E332078852
628E501EA1130A3A1C63DC1A3DF9D43A
CA51DAF1373B5C2A16C174AFBD2132A4
1D435E381B7264B0A2DDDC9D911F9AE8
6683CAFB77FB7B60C78CD233EB2B62F7
3E5101BCD089218A0E026C6750673B33
F4EA0F2888792BD62555AD46ED534839
2BFF75BDF9645D51E99CE5148F4847CA
64EA802089E68A699EC86438C9504F94
8065F8E98407106A65D35195984B2258
0EAC48BCE6DA434412A01656309CB1FF
428B364B8F2B42ED8D7C5AD1020705EF
E66C3B8A38C424C7CBE0B5388EE5F77E
27C6D0E213A8121BF39FEA92C19D9144
B621164BDFE39D8021DDA4F652A284A5
A72750663D0181C7817F61B3DD2CA656
FDA4BBBCF1EA2D95CDD77BFC5F00A837
2F4A6CF5C60E72BC578CA0E5189505F7
76690E22DDCE2B1FFA98C6A4376B8EA2
328DC7FE55E8881B2EA668C9A2855BB7
2B90CE94C6039DF03E72FE15B5320ABA
7CA838857E3B7B8C9FC6A34E975FBF22
F655D26B0F7A4093F1D2FFBD5E61B09D
01C784BDB7AF4DC8DAD6DCD21AF56E25
5A7EB17BF7D867AADECA2FDAF0941E88
137944D29FEB9F2C96187C5F6604F5DB
06A302E3A4767793ADBC884143708660
E9DCE2D958652BD58E846DCE86BDD90A
A279C431ACB82BFB2B7A234A6707BCFF
682A8CD0767A569DC68E7AA0201BFBA3
C4411A9EA6C9822AD521C60A4ED25F25
DF7B1F6B6AEF483760B6439EF91BC26A
82B5DB000108639FF0D38F39D7AC46FD
C74B58C4CD2770A1E97D6DC13D42CCAC
81F5705397CE9F0236B2B672AE113154
38328F5729077611D47495753D2C04D1
A7AAA5EF977926DBCF801D15F83EE4A5
32DC4BE3AF515BD8BD59B4DC0052A3AB
33E5EA9FE1E29AC3127D975A5494213D
674EAE8D70D203FEDBE60DEAE2F834CC
0C777BD44F304574371C97674DCD0702
C2B541CA130165D03BA9BA7DC0E79273
E594F4CE9B23146A461021258CC7ACA2
827848D9C0FD18D44110098CEC982CDE
E53BC2A0AD86417B443AF14EE3082C0F
Query:
SELECT f.value:"value"::STRING AS "board"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100;
Answer:
board
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""M""}"
"{""string_value"":""M""}"
"{""string_value"":""M""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""L""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
"{""string_value"":""S""}"
Query:
SELECT DISTINCT f.value:"value"::STRING AS "board"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
LIMIT 100
Answer:
board
"{""string_value"":""S""}"
"{""string_value"":""L""}"
"{""string_value"":""M""}"
Query:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "initial_engagement"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
WHERE "event_date" BETWEEN '20180801' AND '20180815'
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,initial_engagement
B458770ED6E295374FEEB3A68902CC28,1533178505779007
841A68D5D1F94857BEB64225193B2432,1533176867427006
27293EA0B2F41A672E15EF7B1FA21298,1533153306935005
2B5ABA17A30D32531C09DAF2865F9E55,1533178462868005
159002C6F393752AD79B3C2E8C7104C7,1533170322225002
A8D7DCCA39D8703F2928AD2D7BBB6BE9,1533173221311010
F4634EFF4D9470DCA00051E3304B81AF,1533122457793008
EE99F8CB32999A0FDAABBA18B05D4E48,1533146745626004
EBC3581ADA874D494FBE2C7CCF53BF99,1533142657327001
D41AA91B61872612B5F5F4E42870042C,1533148932154001
45BDDEC4DF8773F88DC51D1AFD145521,1533188760502001
CEBD783B8F2E96E9F3B9424D4FB130E7,1533177960046004
D9AA0EC27AF47514DDB5C664A6EF758A,1533172089171007
55BFC405FFA33C0781DE73101011E45B,1533133455728000
DA48D36D07835B1918BDF831AF83B5EF,1533106869082010
04EF01C1F4723249F90F920DF018F16C,1533171743463003
5E624075FDFE3003C34E1138546B2450,1533124768362004
AEB21692315E4F72D255C75E3584C12E,1533179941598001
91814809BD9374D5CEDFC6A31727CC55,1533130454890010
C80CEE0983AB5B21D3F4B46089FDD9EB,1533125775807005
AFA6BA99FB329CB459E8E57FDE1DF9AE,1533160939121003
CC81C3C01DE545318860C5BFDC6AD31E,1533174742411000
EC1A759709685E136767F2C1BA4751ED,1533171989300007
91F5161F80D1083CA7B37A08DEC9EC78,1533185768243009
46D808E730894AB0AC6E0F493B6FC864,1533192746558000
1F0D27B8A7E058446D4A6409E2E73B19,1533187697905000
934A101CA7B97944D05E0FC2ED3E203D,1533171629414000
C60EACB47CF25AEEFD16C5E332078852,1533164539057002
6B7F85DBAABE78A99689D49CAE22072E,1533182931359001
70646770530D6BDEB05AFC16DD2559C2,1533175639501011
CA51DAF1373B5C2A16C174AFBD2132A4,1533120883539000
1D435E381B7264B0A2DDDC9D911F9AE8,1533156299293002
377303AA2F5C5C80E5AAAD26C029BD5A,1533173763034009
56FA726AC14329729C5A9B020B508034,1533163613073001
6683CAFB77FB7B60C78CD233EB2B62F7,1533141905760015
96161BF2E55C7E32ED5F411432875ECB,1533140485494000
FCA08F9B0DCB6E33A74F672CE7F73BE3,1533174086441008
2BFF75BDF9645D51E99CE5148F4847CA,1533128131133002
8065F8E98407106A65D35195984B2258,1533108915014000
0EAC48BCE6DA434412A01656309CB1FF,1533166965314000
E643F6549E6C7EA0FD01EF4BF7A40F76,1533168309554001
B621164BDFE39D8021DDA4F652A284A5,1533190862200000
32DC4BE3AF515BD8BD59B4DC0052A3AB,1533176193618000
EF500E0CF578004836D1D38C8901862B,1533107128893008
396CD60DADAB9CBA7DDCAF239B477135,1533163578799002
7CA838857E3B7B8C9FC6A34E975FBF22,1533170425858006
96D260425F451E90979EA7417C72A09B,1533176911931003
5A7EB17BF7D867AADECA2FDAF0941E88,1533160163632007
137944D29FEB9F2C96187C5F6604F5DB,1533178052043007
E9DCE2D958652BD58E846DCE86BDD90A,1533128164654000
E594F4CE9B23146A461021258CC7ACA2,1533123042581000
12E5626928FE0885DEEF068683E8BD63,1533134813433004
6C654E9F5D2B57F4F2E2D9F240EC882C,1533128260822001
59772415A60A0B7E16588D219D7B85F1,1533163988816004
76B29DA61902BE1C9F957B66B017DA47,1533149390326000
D0F280B12652EB0D74F6BC74AB13606F,1533118001891001
1FFEE889C95637FE2D229E04149BC23B,1533107176316000
22DC6A6AE86C0AA33EBB8C3164A26925,1533133692594005
B83E97CDE1FCF1D681206DFFC5F1898E,1533108699128002
C8859A791226C6027B90F72F880C3528,1533131587579000
2A4B17256B9DB151E67DA8BE415ED0E6,1533171518038001
0CB6886B20DE2210225F4BAEB575AC71,1533176941588003
E5D16173400729E05DFFB4883FA6EF1C,1533114442632008
F3917138A3D4B03ADA1C2E77E3B84649,1533112715387004
3FC8ECFC8F2976C5B56D0D782F36BD7F,1533135918343001
CFA0F8C5E25A71062E573EF8E6BC9F76,1533145998415006
EFB696A82D093B3AFBE92FF526DD5CEA,1533135323325000
EF7772819E807EDBD8DB0F0B5210030E,1533127746980001
210C3692734E251EEF4E952BC57DD998,1533160417982002
B1D1ED35873581A23E48C4CD03DDFF81,1533125343928006
AA35092B507100A45CBF225A23D56864,1533152437096015
FCB218A1B5C858D56B849CA70EDCF6B4,1533186864456000
B54ED4ED7A122CAD69ED8771E62F4D72,1533142849561000
68C5F7CFAEAB93924B7B55D7129C0286,1533108027819000
628E501EA1130A3A1C63DC1A3DF9D43A,1533181889361001
27B1CD26769B068D16FAAF82D4F2C1A8,1533175933626001
38328F5729077611D47495753D2C04D1,1533118410628007
7ED8C235689771F6B0F29BBF295A346F,1533127531469000
81E2E892D1C23CE76B072FA71310829F,1533162222654004
28AA4A0542C8873691715C284D13C34B,1533162021714007
84E491A60BE52A4C6A438A89FADE283C,1533170476364000
80662734A6A658F7713A71428B9AA027,1533146872376004
3E5101BCD089218A0E026C6750673B33,1533138832510001
A7AAA5EF977926DBCF801D15F83EE4A5,1533119588196000
A72750663D0181C7817F61B3DD2CA656,1533190314648004
C74E5AF2DAC240FA7F3B1612D5AEAA78,1533134373647002
E66C3B8A38C424C7CBE0B5388EE5F77E,1533156611623009
27C6D0E213A8121BF39FEA92C19D9144,1533166265354001
428B364B8F2B42ED8D7C5AD1020705EF,1533156745350012
CABB19A642780994D8EC3CEDC967265F,1533141691400002
EF028BE6C2230A5166A1A247D4687BA3,1533132511316006
76690E22DDCE2B1FFA98C6A4376B8EA2,1533187855561005
A3C5BA7BE9F5439A73A57D9010C607A2,1533129337644001
33E5EA9FE1E29AC3127D975A5494213D,1533176177876013
2B90CE94C6039DF03E72FE15B5320ABA,1533143360031005
674EAE8D70D203FEDBE60DEAE2F834CC,1533127582998014
06A302E3A4767793ADBC884143708660,1533136369906005
0C777BD44F304574371C97674DCD0702,1533130304092014
A279C431ACB82BFB2B7A234A6707BCFF,1533128060037013
C1A0D9FB3527654C
Query:
SELECT DISTINCT t2."user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" t2
WHERE t2."event_name" = 'session_start' AND t2."user_pseudo_id" IN (
    SELECT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t1
    WHERE t1."event_name" LIKE '%quickplay%'
)
LIMIT 100
Answer:
user_pseudo_id
2AC0EF5047BC538BDA6388E644409B5D
706C748E6D1E0768BFEFE6362B5D3F67
DF0E6C6C5E4F3F34FEC6EE54FD945B05
48AB910A8DE8485D4C34238EA61F782C
FA30269453141794E79B8F15EE0BA5B9
B63075B53A750A67A12F7F19ED5AA835
40B501E0460E254E289A776CFC31DCF2
A95BA9143018CA81430258E8A725C3E6
89BD2B0E233951461CF06C9B4FDA0D81
44A600997B9B6499325D518A19B51FEC
F3CA6D208932C0BD365FE0D589038E1C
1235BA39F8C700F0529EC1A33470BF0C
5B888A06EFF60B86B10367EEC3B44E85
42E6A7C3536775E3B8C3DB919AE9A452
E4196C5E0A92A22F69DE4E3AA288D6EE
9A12E7E2B3CF644B8304DF8E1A9CE2D8
488BE19C45D3D8B2DF02214BC19B44B4
2B5ABA17A30D32531C09DAF2865F9E55
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
6683CAFB77FB7B60C78CD233EB2B62F7
0C777BD44F304574371C97674DCD0702
7386D239899D55E3D62DA619F359A7C0
A064A84CD3CF7058F39333D6212E8615
8E1749E5A26DD54E346476A289854E93
8EDB9A9856CDB5AFC42546106EE46734
D5F9D9AF22EF5073E10342973D48FB2C
841A68D5D1F94857BEB64225193B2432
05FB3382D94C7E963B408FD6CC357D33
DA48D36D07835B1918BDF831AF83B5EF
EFB696A82D093B3AFBE92FF526DD5CEA
CA51DAF1373B5C2A16C174AFBD2132A4
EB1A430BACB37E6EA72592BF838E64A6
FDA4BBBCF1EA2D95CDD77BFC5F00A837
2B90CE94C6039DF03E72FE15B5320ABA
472451071AED6FF801BC0FE66706FD27
EEBCB25D5F056CCF59DDE654388ACD2B
7BF597A11650FE351760281648C7A3F8
6A07135DA41B81E278341576A26672E4
28C4A09298C441D5AFD39E749D9F3DA3
3D1B58553D2E2D4DD5DFCF251D5E23B2
58C58BE1BC4187B0C0192D05F718A1A4
8BD465AC77DC9D8B4C597BF35950FDA3
17934EF7C1BC1CF2C7D942401FDE84CE
6A2F4E7AB1816D2F6EC741BC92141766
8601A3659DC5C1F0444E5CCDA5ED3E14
D9AA0EC27AF47514DDB5C664A6EF758A
AFA6BA99FB329CB459E8E57FDE1DF9AE
91D637F0D9FB259AD52773B1B20151BE
F815B0069F973BFA743EF90A85224109
7F811674D65C2E02A6A705E97799E372
932AAF56DDE9C55359B9CCFA18E7FB95
84E491A60BE52A4C6A438A89FADE283C
0CAAA1B6F161BA4D363EB7A2DEF64A08
F5DAD8DD17B689CF672D65A0A81CF4AC
8211CABE9A3F1FE1BF3154E0C8D30368
FE3331C93B8A54B8C9145532FFAD704A
C7E2273D8B11257FCCC915D27C1FCA24
210C3692734E251EEF4E952BC57DD998
A19F659EA9BA36A3595F088F30A6B7E7
C80CEE0983AB5B21D3F4B46089FDD9EB
1B3AD9683D475EFB398E131DFE65AE61
FEDC59699D8832A11B88BFCCCAD0951D
8765E2797C05DF924237C185AFA365BA
A0616D4E494DC3BCCB94B8B6E5B48380
CA04708DA02378999ECB402481FF1AE4
1213ED1E96B0A49B51C0F7683DB2ACCC
45EB0927832513B89E58E6C6C93D841C
9BC94B3773C8304A9E101AEBCFEF4A5F
295D9E24D8DE65A010313E667131EF19
77F5E9A5630151C9E831156AEAB4DA11
7E40E634997585B0C69B6F67C01C191B
D0F280B12652EB0D74F6BC74AB13606F
E6FEE8B98E75EA5311FE004F98559A27
0E05F56141200FF41FCC0C7FA297FF08
959635567E419A061EECCCA478EDC718
3DEB0C12C49AD19D7ACE68FA59E7ACD6
59BE43F3FE7AB3F91B016B56508D4C46
9DE945166BCD4709696C5836317DDE47
59454BAC415BB1F18517C6FD2C023E49
8F69F63C94FC7045651B1B164AE7B379
B1D1ED35873581A23E48C4CD03DDFF81
372D9BB5088C4E9000C65B06459B403A
10B0D468B5E036E16D13DB53A65F2D49
13E6C8A193FF140F7D4222B569DD5B50
A7AAA5EF977926DBCF801D15F83EE4A5
F4EA0F2888792BD62555AD46ED534839
EF500E0CF578004836D1D38C8901862B
8252847DECB3C31CAB9BDEE566F97BA2
12E5626928FE0885DEEF068683E8BD63
74375465CD17299EBC7C75A1B4047EE0
B5395F8C2077B59B3D6C5719C0CA0339
C5B527B0AA7603C4EF8C0ECBBCB5372E
82B5DB000108639FF0D38F39D7AC46FD
0CB6886B20DE2210225F4BAEB575AC71
3875A92B5F5C2BBA1355CED06A986079
E80C958E3C33898989A30B8F5A4514F0
3D03A380687FE3369E93915D50C572CB
C6DE585349744A40725DB0AB17041BA3
635808C1DDFBC662DC3015097E26E62A
Query:
SELECT f.value:"value"::STRING AS "board_type", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
GROUP BY "board_type"
LIMIT 100
Answer:
board_type,user_count
"{""string_value"":""S""}",273
"{""string_value"":""M""}",38
"{""string_value"":""L""}",33
Query:
SELECT q."board_type", COUNT(DISTINCT s."user_pseudo_id") AS "retained_users"
FROM (
    SELECT t."user_pseudo_id", f.value:"value"::STRING AS "board_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
) q
JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" s
ON q."user_pseudo_id" = s."user_pseudo_id"
WHERE s."event_name" = 'session_start'
GROUP BY q."board_type"
LIMIT 100
Answer:
board_type,retained_users
"{""string_value"":""S""}",110
"{""string_value"":""L""}",15
"{""string_value"":""M""}",19
Query:
SELECT t."user_pseudo_id", t."event_name", t."event_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."user_pseudo_id" NOT IN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
)
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
B458770ED6E295374FEEB3A68902CC28,session_start,1533178516177000
B458770ED6E295374FEEB3A68902CC28,session_start,1533186548206000
B458770ED6E295374FEEB3A68902CC28,level_complete_quickplay,1533178706133033
B458770ED6E295374FEEB3A68902CC28,level_complete_quickplay,1533186675592002
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178649867023
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178654065028
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178577238001
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178589239002
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178544470012
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178619839003
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178634839004
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178592839005
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178622840006
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178572533010
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178645114013
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178637114014
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178632893019
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178659866022
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178680673037
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178700673038
B458770ED6E295374FEEB3A68902CC28,screen_view,1533186529737004
B458770ED6E295374FEEB3A68902CC28,screen_view,1533186639178006
B458770ED6E295374FEEB3A68902CC28,screen_view,1533186655178007
B458770ED6E295374FEEB3A68902CC28,post_score,1533178694133031
B458770ED6E295374FEEB3A68902CC28,post_score,1533186632592000
B458770ED6E295374FEEB3A68902CC28,screen_view,1533178513674000
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay,1533178505779007
B458770ED6E295374FEEB3A68902CC28,level_end_quickplay,1533178604533011
B458770ED6E295374FEEB3A68902CC28,level_fail_quickplay,1533178616533012
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay,1533178652337015
B458770ED6E295374FEEB3A68902CC28,level_end_quickplay,1533178757133032
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay,1533186595977000
B458770ED6E295374FEEB3A68902CC28,level_end_quickplay,1533186658592001
B458770ED6E295374FEEB3A68902CC28,select_content,1533178513778006
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178510469009
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178587838000
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178625531007
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178606892016
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178728673034
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178759086039
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533186577737001
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533186608176003
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533186609960008
B458770ED6E295374FEEB3A68902CC28,user_engagement,1533178609064025
27293EA0B2F41A672E15EF7B1FA21298,session_start,1533153346436000
27293EA0B2F41A672E15EF7B1FA21298,error,1533153565261001
27293EA0B2F41A672E15EF7B1FA21298,level_complete_quickplay,1533153427747002
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153526463016
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153306935005
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153390935006
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153403144011
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153501316006
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153480317007
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153500660012
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153552462015
27293EA0B2F41A672E15EF7B1FA21298,post_score,1533153501747000
27293EA0B2F41A672E15EF7B1FA21298,screen_view,1533153386415003
27293EA0B2F41A672E15EF7B1FA21298,level_start_quickplay,1533153377417008
27293EA0B2F41A672E15EF7B1FA21298,level_end_quickplay,1533153501747001
27293EA0B2F41A672E15EF7B1FA21298,level_start_quickplay,1533153554895008
27293EA0B2F41A672E15EF7B1FA21298,select_content,1533153354416007
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153335144010
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153440315003
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153483659009
27293EA0B2F41A672E15EF7B1FA21298,user_engagement,1533153572283002
EE99F8CB32999A0FDAABBA18B05D4E48,app_update,1533146745626004
EE99F8CB32999A0FDAABBA18B05D4E48,session_start,1533146807631000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533146992865000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533146982986000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533147027807000
EE99F8CB32999A0FDAABBA18B05D4E48,level_complete,1533147036897000
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533146989865070
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533146947986003
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533146975807003
EE99F8CB32999A0FDAABBA18B05D4E48,level_up,1533147097897008
EE99F8CB32999A0FDAABBA18B05D4E48,screen_view,1533146967161058
EE99F8CB32999A0FDAABBA18B05D4E48,screen_view,15331470301
Query:
SELECT f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
Too long, hard cut:
param_key,param_value
value,"{""int_value"":21}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
value,"{""int_value"":21}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794021}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794027}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794031}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":2637284676279794019}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-2614613710786332224}"
board,"{""string_value"":""S""}"
value,"{""int_value"":21}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571154}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571152}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571154}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-7592093320680571150}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766676}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""game_over""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766682}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":5344990970727766674}"
board,"{""string_value"":""S""}"
value,"{""int_value"":29}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-6841316843749891991}"
board,"{""string_value"":""M""}"
firebase_screen_class,"{""string_value"":""main_menu""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-6841316843749891989}"
board,"{""string_value"":""M""}"
firebase_screen_class,"{""string_value"":""FIRootViewController""}"
firebase_event_origin,"{""string_value"":""app+gtm""}"
firebase_screen_id,"{""int_value"":-6841316843749891991}"
board,"{""string_value"":""M""}"
value,"{""int_value"":22}"
firebase_screen_class,"{""string_va
Query:
SELECT "user_pseudo_id", COUNT(*) AS "session_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
WHERE "event_name" = 'session_start'
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
user_pseudo_id,session_count
1879629E259EAE7CC648E2F33CD77776,1
68495553C4E4675C74F6476A12E92ADB,1
E6850F5E0DAB3E339C6A36BDEECCA26F,1
102CC7D8CD5D3E861EACE1BAB97E61EC,3
023A2DB99CC3F70A4B71869C36952D74,1
7CDC52F058F406CC41FCDC16E464342A,2
9BC94B3773C8304A9E101AEBCFEF4A5F,1
295D9E24D8DE65A010313E667131EF19,2
B081E087ABDC8FE6FB390ACF48CD61D8,1
58230465C695B0FDDDAE08A481FAEECC,1
4BB019F8F6D1FE7BA78CA42A4698EF56,1
F4810B35D08410542741137BD5FD3326,1
17636078D57884AD7EA5406C60E2BD10,1
77F5E9A5630151C9E831156AEAB4DA11,1
4A93C01615B33FF5804AF8D19895247F,1
08B7AEC83DA53E917D595FE60C2CB600,1
45FB547C5857493104687C234EDCDE37,2
2AC0EF5047BC538BDA6388E644409B5D,1
BB322D2CA948F548EA3A05A2BD93B1A3,2
525D2BA85EFE112B955CD3B19909E059,3
7E40E634997585B0C69B6F67C01C191B,1
B9D8DF9BE543DEFAEDC13BF8903A859A,1
8CBA9954233F9C12C693325C6BC60D74,2
57EC50FBC6C7277B8EDCCE44C1352BD4,5
706C748E6D1E0768BFEFE6362B5D3F67,1
F815B0069F973BFA743EF90A85224109,1
D0F280B12652EB0D74F6BC74AB13606F,1
1E829A6853724F89B436A122FE010198,2
EECDCA8076D5842922767F5C08957B17,1
54827B02505D08E40E29E608008431B4,1
383F4B98EC31DD2A915427D36A30354E,1
6A2F4E7AB1816D2F6EC741BC92141766,1
797844212D53A601F14C15BAB621F67E,1
1CF315BC6864E7A71A81E47925E18A61,1
ECB676BED33FDF42E1B0DCF234E1344B,1
0E05F56141200FF41FCC0C7FA297FF08,4
E6FEE8B98E75EA5311FE004F98559A27,2
FA30269453141794E79B8F15EE0BA5B9,1
A421EBCE8AA69A980AAFC4F141BDEFFB,1
91381A6BC5F5E06D1B8DEFD96761751C,1
88A41BFED275BB69125BE1F5524F3B42,2
A95BA9143018CA81430258E8A725C3E6,3
184B6DE721CD75D84BB9975E19003195,1
F4F4EAE9439622EA3CA9489A52E7230F,2
1CE19ED5366D09B6A3E9CCD4AA475B85,2
079E84FBF40BA6D3E74C7E61A7BD4F91,1
A9F5CC6811A363B671124943547E3631,1
5145D8121071A9EA903A1098034962F6,1
89BD2B0E233951461CF06C9B4FDA0D81,2
F81A7FACD9640F8169D8DE2E27D217E6,3
F187F3F6C0DFB1FA23483A67AA31A16D,1
9F10D203085E22749FAB8E6A2DB1BABA,2
488908B4727978E9813DD50CB3E7F330,1
7F811674D65C2E02A6A705E97799E372,1
6C14B6297FCC1782508E14996A4DBB7C,1
F34FF1C9F0C022B684BC885BA1DDC260,2
812A0C9302E7E1A711B416C0904C99CD,1
C6DE585349744A40725DB0AB17041BA3,1
488BE19C45D3D8B2DF02214BC19B44B4,1
EBC3581ADA874D494FBE2C7CCF53BF99,2
ADDC25F2E0EE2C18855F0D850EBE2A8C,1
F1555004E0D95599AF2F2B8EA130A9C3,3
56A3ECD9106EA59DE52682BEFFFAC53C,1
7CC61FB109657777ADD59480BC290F29,1
2F0F260BD7B876C346B41977D0D03D62,3
A70504A67EE34DD45EF82BFF86E9F94D,1
448F4402131C2DE70EC67F04D4BF5719,1
52332E7857233EC06090B1059F0C6292,1
27954A1D70BCD7F326F926A5D5B666E6,1
E080406D26F71C9B8F331779CE8B82BA,1
05F7B2C58D627CE948B06C10E39CDF91,1
48AB910A8DE8485D4C34238EA61F782C,6
64E0BF319001686AAB32B5120FFA0167,1
B63075B53A750A67A12F7F19ED5AA835,3
0ED6BC1D319AB5BD1F245628EA47EDBB,1
40B501E0460E254E289A776CFC31DCF2,5
C04D8138266E1439C156ABE4E82F4706,1
7566596A1D6ACA781692A7A0B89B06EF,2
9278A7C15D0307622E7A0305C4091A91,1
835F907F89D3CB8B5010D980D7F2AED5,2
44A600997B9B6499325D518A19B51FEC,1
F3CA6D208932C0BD365FE0D589038E1C,1
F24F41EC0396166669C20DFC3CFBC7D3,1
3DEB0C12C49AD19D7ACE68FA59E7ACD6,2
42B0EA9C46944FD3177C30038D4970B3,2
A62D86FAFF43F1EC89D6F867915D7D56,1
3BF1D92C836CBAFACDD2063848BAB11C,2
CE3E59F2C2C3BD7F1C8FB80D53CF0F3B,1
9DE945166BCD4709696C5836317DDE47,1
C78B719086D5C386E072A891285D8933,2
5B9149282B2EB48FE5AFE1240FC0440E,3
FEDC59699D8832A11B88BFCCCAD0951D,1
E19F04BAB15FBA761833F71BCF5D97D3,2
30B0DA9467C7DC2B85C4C72815775B67,1
59454BAC415BB1F18517C6FD2C023E49,2
490F592DDAB95F2590917ACA94B377C6,1
2A78A1F772DEA29CA407EDE2D31A2D7F,1
959D4D83EB7DA9966F66F133B20BF016,1
8E1749E5A26DD54E346476A289854E93,3
5B888A06EFF60B86B10367EEC3B44E85,1
Query:
SELECT DISTINCT t."platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808" t
WHERE t."event_name" = 'session_start' AND t."user_pseudo_id" IN (
    SELECT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    WHERE "event_name" LIKE '%quickplay%'
)
LIMIT 100
Answer:
platform
ANDROID
IOS
Query:
SELECT t."user_pseudo_id", t."device":"mobile_model_name"::STRING AS "device_model"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."event_name" LIKE '%quickplay%' AND t."device":"mobile_model_name" IS NOT NULL
LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,device_model
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
B458770ED6E295374FEEB3A68902CC28,not available in demo dataset
841A68D5D1F94857BEB64225193B2432,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
27293EA0B2F41A672E15EF7B1FA21298,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
EE99F8CB32999A0FDAABBA18B05D4E48,not available in demo dataset
2B5ABA17A30D32531C09DAF2865F9E55,not available in demo dataset
2B5ABA17A30D32531C09DAF2865F9E55,not available in demo dataset
2B5ABA17A30D32531C09DAF2865F9E55,not available in demo dataset
159002C6F393752AD79B3C2E8C7104C7,not available in demo dataset
159002C6F393752AD79B3C2E8C7104C7,not available in demo dataset
159002C6F393752AD79B3C2E8C7104C7,not available in demo dataset
A8D7DCCA39D8703F2928AD2D7BBB6BE9,not available in demo dataset
A8D7DCCA39D8703F2928AD2D7BBB6BE9,not available in demo dataset
A8D7DCCA39D8703F2928AD2D7BBB6BE9,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
F4634EFF4D9470DCA00051E3304B81AF,not available in demo dataset
EBC3581ADA874D494FBE2C7CCF53BF99,not available in demo dataset
EBC3581ADA874D494FBE2C7CCF53BF99,not available in demo dataset
EBC3581ADA874D494FBE2C7CCF53BF99,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
D41AA91B61872612B5F5F4E42870042C,not available in demo dataset
45BDDEC4DF8773F88DC51D1AFD145521,not available in demo dataset
45BDDEC4DF8773F88DC51D1AFD145521,not available in demo dataset
45BDDEC4DF8773F88DC51D1AFD145521,not available in demo dataset
CEBD783B8F2E96E9F3B9424D4FB130E7,not available in demo dataset
CEBD783B8F2E96E9F3B9424D4FB130E7,not available in demo dataset
CEBD783B8F2E96E9F3B9424D4FB130E7,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
D9AA0EC27AF47514DDB5C664A6EF758A,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dataset
04EF01C1F4723249F90F920DF018F16C,not available in demo dat
Query:
SELECT t."platform", COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t
WHERE t."event_name" LIKE '%quickplay%' AND t."user_pseudo_id" NOT IN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
)
GROUP BY t."platform"
LIMIT 100;
Answer:
platform,user_count
IOS,91
ANDROID,105
Query:
SELECT
    f.value:"value":"string_value"::STRING AS "board_type",
    COUNT(DISTINCT t."user_pseudo_id") AS "user_count"
FROM
    "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
WHERE
    t."event_name" LIKE '%quickplay%' AND
    f.value:"key"::STRING = 'board'
GROUP BY
    "board_type"
LIMIT 100
Answer:
board_type,user_count
S,273
L,33
M,38
End Exploring Related Columns
Task: Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018, as measured by the presence of session_start events??

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
quickplay_event_type,user_retention_rate
event_type:str,rate:0<=float<=100
(Attention: answer in one row)
```

The quickplay event type with the lowest user retention rate during the second week after users first engaged between August 1 and August 15, 2018, is provided above. The retention rate is calculated based on the presence of `session_start` events during the second week after the initial engagement..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 17:02:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 17:02:40 - root - INFO - ```sql
SELECT
    q."board_type" AS "quickplay_event_type",
    ROUND((COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT q."user_pseudo_id")) * 100, 2) AS "user_retention_rate"
FROM (
    SELECT t."user_pseudo_id", f.value:"value":"string_value"::STRING AS "board_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
) q
LEFT JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
) s ON q."user_pseudo_id" = s."user_pseudo_id"
GROUP BY q."board_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
```
2025-02-10 17:02:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 17:02:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 17:02:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 17:02:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 17:02:41 - snowflake.connector.connection - INFO - closed
2025-02-10 17:02:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 17:02:41 - root - INFO - itercount: 1
2025-02-10 17:02:41 - root - INFO - 0
2025-02-10 17:02:41 - root - INFO - results: 
quickplay_event_type,user_retention_rate
S,40.29


2025-02-10 17:02:41 - root - INFO - Please check the answer again by reviewing Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018, as measured by the presence of session_start events??, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
quickplay_event_type,user_retention_rate
event_type:str,rate:0<=float<=100
(Attention: answer in one row)
```

The quickplay event type with the lowest user retention rate during the second week after users first engaged between August 1 and August 15, 2018, is provided above. The retention rate is calculated based on the presence of `session_start` events during the second week after the initial engagement. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
quickplay_event_type,user_retention_rate
S,40.29
Current sql:
SELECT
    q."board_type" AS "quickplay_event_type",
    ROUND((COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT q."user_pseudo_id")) * 100, 2) AS "user_retention_rate"
FROM (
    SELECT t."user_pseudo_id", f.value:"value":"string_value"::STRING AS "board_type"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%' AND f.value:"key"::STRING = 'board'
) q
LEFT JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
    WHERE "event_name" = 'session_start'
) s ON q."user_pseudo_id" = s."user_pseudo_id"
GROUP BY q."board_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
2025-02-10 17:04:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 17:04:11 - root - INFO - ```sql
WITH initial_engagements AS (
    SELECT
        t."user_pseudo_id",
        MIN(t."event_timestamp") AS initial_engagement_ts,
        f.value:"value":"string_value"::STRING AS "quickplay_event_type"
    FROM (
        -- Include all EVENTS tables from August 1 to August 15, 2018
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
    ) t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%'
      AND f.value:"key"::STRING = 'board'
    GROUP BY t."user_pseudo_id", f.value:"value":"string_value"
),
second_week_sessions AS (
    SELECT
        t."user_pseudo_id",
        t."event_timestamp"
    FROM (
        -- Include all EVENTS tables from August 8 to August 29, 2018
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
    ) t
    WHERE t."event_name" = 'session_start'
)
SELECT
    ie."quickplay_event_type",
    ROUND(
        (COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT ie."user_pseudo_id")) * 100, 4
    ) AS "user_retention_rate"
FROM initial_engagements ie
LEFT JOIN second_week_sessions s ON
    ie."user_pseudo_id" = s."user_pseudo_id" AND
    s."event_timestamp" >= ie.initial_engagement_ts + (7 * 24 * 60 * 60 * 1000000) AND
    s."event_timestamp" < ie.initial_engagement_ts + (14 * 24 * 60 * 60 * 1000000)
GROUP BY ie."quickplay_event_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
```
2025-02-10 17:04:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 17:04:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 17:04:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 17:04:12 - snowflake.connector.connection - INFO - closed
2025-02-10 17:04:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 17:04:13 - root - INFO - itercount: 2
2025-02-10 17:04:13 - root - INFO - 001789 (42601): 01ba4da0-0004-92b1-0001-11c3010c94de: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 21
2025-02-10 17:04:13 - root - INFO - Input sql:
WITH initial_engagements AS (
    SELECT
        t."user_pseudo_id",
        MIN(t."event_timestamp") AS initial_engagement_ts,
        f.value:"value":"string_value"::STRING AS "quickplay_event_type"
    FROM (
        -- Include all EVENTS tables from August 1 to August 15, 2018
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
    ) t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%'
      AND f.value:"key"::STRING = 'board'
    GROUP BY t."user_pseudo_id", f.value:"value":"string_value"
),
second_week_sessions AS (
    SELECT
        t."user_pseudo_id",
        t."event_timestamp"
    FROM (
        -- Include all EVENTS tables from August 8 to August 29, 2018
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
        UNION ALL SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
    ) t
    WHERE t."event_name" = 'session_start'
)
SELECT
    ie."quickplay_event_type",
    ROUND(
        (COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT ie."user_pseudo_id")) * 100, 4
    ) AS "user_retention_rate"
FROM initial_engagements ie
LEFT JOIN second_week_sessions s ON
    ie."user_pseudo_id" = s."user_pseudo_id" AND
    s."event_timestamp" >= ie.initial_engagement_ts + (7 * 24 * 60 * 60 * 1000000) AND
    s."event_timestamp" < ie.initial_engagement_ts + (14 * 24 * 60 * 60 * 1000000)
GROUP BY ie."quickplay_event_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
The error information is:
001789 (42601): 01ba4da0-0004-92b1-0001-11c3010c94de: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 21
Please correct it and output only 1 complete SQL query.When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}


2025-02-10 17:05:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 17:05:36 - root - INFO - ```sql
WITH initial_engagements AS (
    SELECT
        t."user_pseudo_id",
        MIN(t."event_timestamp") AS initial_engagement_ts,
        f.value:"value":"string_value"::STRING AS "quickplay_event_type"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
    ) t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%'
      AND f.value:"key"::STRING = 'board'
    GROUP BY t."user_pseudo_id", f.value:"value":"string_value"
),
second_week_sessions AS (
    SELECT
        t."user_pseudo_id",
        t."event_timestamp"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
    ) t
    WHERE t."event_name" = 'session_start'
)
SELECT
    ie."quickplay_event_type",
    ROUND(
        (COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT ie."user_pseudo_id")) * 100, 4
    ) AS "user_retention_rate"
FROM initial_engagements ie
LEFT JOIN second_week_sessions s ON
    ie."user_pseudo_id" = s."user_pseudo_id" AND
    s."event_timestamp" >= ie.initial_engagement_ts + (7 * 24 * 60 * 60 * 1000000) AND
    s."event_timestamp" < ie.initial_engagement_ts + (14 * 24 * 60 * 60 * 1000000)
GROUP BY ie."quickplay_event_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
```
2025-02-10 17:05:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 17:05:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 17:05:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 17:05:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 17:05:49 - snowflake.connector.connection - INFO - closed
2025-02-10 17:05:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 17:05:49 - root - INFO - itercount: 3
2025-02-10 17:05:49 - root - INFO - 0
2025-02-10 17:05:49 - root - INFO - results: 
quickplay_event_type,user_retention_rate
S,33.7823


2025-02-10 17:05:49 - root - INFO - Please check the answer again by reviewing Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018, as measured by the presence of session_start events??, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
quickplay_event_type,user_retention_rate
event_type:str,rate:0<=float<=100
(Attention: answer in one row)
```

The quickplay event type with the lowest user retention rate during the second week after users first engaged between August 1 and August 15, 2018, is provided above. The retention rate is calculated based on the presence of `session_start` events during the second week after the initial engagement. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
quickplay_event_type,user_retention_rate
S,33.7823
Current sql:
WITH initial_engagements AS (
    SELECT
        t."user_pseudo_id",
        MIN(t."event_timestamp") AS initial_engagement_ts,
        f.value:"value":"string_value"::STRING AS "quickplay_event_type"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
    ) t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%'
      AND f.value:"key"::STRING = 'board'
    GROUP BY t."user_pseudo_id", f.value:"value":"string_value"
),
second_week_sessions AS (
    SELECT
        t."user_pseudo_id",
        t."event_timestamp"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
    ) t
    WHERE t."event_name" = 'session_start'
)
SELECT
    ie."quickplay_event_type",
    ROUND(
        (COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT ie."user_pseudo_id")) * 100, 4
    ) AS "user_retention_rate"
FROM initial_engagements ie
LEFT JOIN second_week_sessions s ON
    ie."user_pseudo_id" = s."user_pseudo_id" AND
    s."event_timestamp" >= ie.initial_engagement_ts + (7 * 24 * 60 * 60 * 1000000) AND
    s."event_timestamp" < ie.initial_engagement_ts + (14 * 24 * 60 * 60 * 1000000)
GROUP BY ie."quickplay_event_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
2025-02-10 17:07:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 17:07:59 - root - INFO - ```sql
WITH initial_engagements AS (
    SELECT
        t."user_pseudo_id",
        MIN(t."event_timestamp") AS initial_engagement_ts,
        f.value:"value":"string_value"::STRING AS "quickplay_event_type"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name", "event_params"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
    ) t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" LIKE '%quickplay%'
      AND f.value:"key"::STRING = 'board'
    GROUP BY t."user_pseudo_id", f.value:"value":"string_value"
),
second_week_sessions AS (
    SELECT
        t."user_pseudo_id",
        t."event_timestamp"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
        UNION ALL
        SELECT "user_pseudo_id", "event_timestamp", "event_name"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
    ) t
    WHERE t."event_name" = 'session_start'
)
SELECT
    ie."quickplay_event_type",
    ROUND(
        (COUNT(DISTINCT s."user_pseudo_id") / COUNT(DISTINCT ie."user_pseudo_id")) * 100, 4
    ) AS "user_retention_rate"
FROM initial_engagements ie
LEFT JOIN second_week_sessions s ON
    ie."user_pseudo_id" = s."user_pseudo_id" AND
    s."event_timestamp" >= ie.initial_engagement_ts + (7 * 24 * 60 * 60 * 1000000) AND
    s."event_timestamp" < ie.initial_engagement_ts + (14 * 24 * 60 * 60 * 1000000)
GROUP BY ie."quickplay_event_type"
ORDER BY "user_retention_rate" ASC
LIMIT 1;
```
2025-02-10 17:07:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 17:07:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 17:07:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 17:08:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 17:08:01 - snowflake.connector.connection - INFO - closed
2025-02-10 17:08:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 17:08:01 - root - INFO - itercount: 4
2025-02-10 17:08:01 - root - INFO - 0
2025-02-10 17:08:01 - root - INFO - Total iteration counts: 4
