2025-02-10 16:21:07 - openai._base_client - INFO - Retrying request to /chat/completions in 0.401108 seconds
2025-02-10 16:22:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:22:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-02-10 16:22:17 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:17 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Results:
event_name
session_start
screen_view
level_start_quickplay
user_engagement
post_score
level_complete_quickplay
level_end_quickplay
select_content
level_fail_quickplay
level_retry_quickplay
level_up
level_complete
level_start
level_end
level_retry
level_reset_quickplay
level_fail
completed_5_levels
app_remove
app_exception
level_reset
no_more_extra_steps
os_update
error
firebase_campaign
app_update
use_extra_steps
spend_virtual_currency
ad_reward
challenge_a_friend
first_open

2025-02-10 16:22:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:18 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:19 - root - INFO - SQL:
SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Results:
Too long, hard cut:
event_name,event_timestamp,user_pseudo_id
session_start,1535867185623000,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849095212001,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849167262008,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849154282009,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849162943013,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535867236618001,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849186141000,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535867221530000,9F7B0D1BFB822F5E26E91E184E2E437C
level_start_quickplay,1535849137266010,9F7B0D1BFB822F5E26E91E184E2E437C
select_content,1535849164052005,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535849135086007,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535849135913012,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535849197632016,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535867170853001,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535826937106001,0AF67C1A1C8F3785609B4210C3E04FC8
screen_view,1535826950106001,0AF67C1A1C8F3785609B4210C3E04FC8
screen_view,1535826961795000,0AF67C1A1C8F3785609B4210C3E04FC8
screen_view,1535826910795000,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535826971247003,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535827320896005,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535826970247003,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535827264896005,0AF67C1A1C8F3785609B4210C3E04FC8
post_score,1535821239792002,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535821383892014,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535821504763026,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535821890531040,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821250791000,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821402891012,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821553762024,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821939530038,102CC7D8CD5D3E861EACE1BAB97E61EC
session_start,1535821133482000,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821133383001,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821104130005,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821104161006,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821296883004,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821226892005,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821213161007,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821322983016,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821385997017,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821375615019,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821521848028,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821501857029,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821846390032,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821943611042,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821925620043,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821951099046,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821111327000,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821116132007,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821234792001,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821211156008,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821364892013,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821341611020,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821534763025,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821784387033,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821940531039,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535822022095047,102CC7D8CD5D3E861EACE1BAB97E61EC
select_content,1535821167995003,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821167045004,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821256874003,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821278137006,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821387973015,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821368577018,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821476838027,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821540075030,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821804316031,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821953594041,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821920836044,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821978034045,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821957063051,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535858453281002,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858450179027,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858549250053,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858583326076,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858575828103,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858676432129,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858667955146,A976A39B8E08829A5BC5CD3827C942A2
post_score,153585876923

2025-02-10 16:22:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-02-10 16:22:20 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:20 - root - INFO - SQL:
SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
Results:
event_name,event_timestamp,user_pseudo_id
first_open,1535855580096000,4EEE67C2E335213F6815144829801E0F
first_open,1535825903840000,27C0BAADCE9520F17249A8B85F6477DA
first_open,1535800510069000,9FD6E2CD74490F5DA5F52D249CBB750A
first_open,1535796824597000,D963E509346C0E5358ECFE56AF3BB2ED
first_open,1535855219914000,4A2A03B50BDA6AC1687703BD39A91E3E
first_open,1535836565290000,0E9150E8985138A744B88D56F015EDA7
first_open,1535810901162000,FCD8DDE7775A7211BCA9F42768C3BB8B
first_open,1535800915359000,6D6EB70E837A5007BE550C44FF276440
first_open,1535861885300000,96333A5A97DA9F4AEBC7A70483AF6C5C
first_open,1535843461289000,F4CB0B30E0A170AEB6A94EF1156738C8
first_open,1535827029854000,EA89F979E0D4C374DBC95268982D18DE
first_open,1535807127198000,1D5A0DC978A69FF28EC9D153F32EA871
first_open,1535852034675000,34CAF47105A2D9D0AC7464BB3AF8DB2A
first_open,1535851024659000,2C15FFDEDDA69390B7A8EB5808FB7ED6
first_open,1535824322547000,B9A395E297106E5D6F72747F84AC7AE5
first_open,1535844742760000,6C333017CEA199B69BB27611BA5DE7B5
first_open,1535801979560000,531E7B35DE9A21A1942F057C98B4E74C
first_open,1535820568861000,C09F65F2853D03DE23CFD90F97429735
first_open,1535864378333000,14FC1A25D55E89AC7ECD600CD3A08C13
first_open,1535867137394000,7331597E5500811253BA85AF851A193C
first_open,1535823083751000,5DA9B900E7C9F71714FB1AE9DA631C83
first_open,1535833844071000,97D9D96077AD3E8859BF5C54C873E59D
first_open,1535786768380000,CEBA063FD7BF190D727CC948185CCEC8
first_open,1535834527505000,61BB31EC7781341B1D7B8D8A85688DA3
first_open,1535857954726000,5A66BC427F25EFFDFEDED4A07D8F9F91
first_open,1535793454587000,37EFBD2BA398148336F96B4347392A8D
first_open,1535813813915000,E0F1ED4167D0C0B2D6DCBA85CB020F52
first_open,1535851408336000,177C0BEFFC69408F88D3377632F1BB60
first_open,1535851178598000,5F5D7A3F5575008A81BB77CFE70C4285
first_open,1535814119760000,37034A23CAFF85394E2E349C381788A6
first_open,1535818383344000,387B532B7AF7A362DBF783E34C05BF54
first_open,1535865216880000,1E882F0B9818614D6E47620DD31229F1
first_open,1535839822373000,9F8885F0261FE69A58C8B6AE9176E437
first_open,1535851880421000,ACA2E31E67D50F779611D7FDB674C370
first_open,1535809874149000,551B893D34A2A59971B8FF185C1CD0C8
first_open,1535799569882000,B82793CB1270A48BB2697C51AEED3E4A
first_open,1535867549146000,D771048ADB1B9CACADFE001E6F9BA799
first_open,1535798021434000,C7DD86F06FD4AA8A0967E27E20750FCD
first_open,1535846621178000,E6E7FC8AC6D32935DA5ADCFFD14CC3A8
first_open,1535821909295000,D1C57A2E87382A82A40B1816E85277EA
first_open,1535864536964000,D8B77A575B5308D161F95ACF515F9772
first_open,1535860647684000,7AB9D5F7D122A38CA8769C9C93F3A12F
first_open,1535791708036000,D6803CFD38D435F0364EB47684F7CCF6
first_open,1535790604676000,3E336ECE1F533064D663A350DAB00790
first_open,1535844174073000,CCE5E30054C510608589FA6240615B0A
first_open,1535820720601000,3B049329E3090DA7A4339C4A46EF0763
first_open,1535857240494000,B9D800D33FDCF7AF2157CB66910A0797
first_open,1535807013891000,8DEB6CB6C3E85D0032D8557C73ADD49F
first_open,1535823345176000,A6E8B0AC5E066F7670116136442F728F
first_open,1535814764621000,A305B55D5049F38F5139DA95B3DCE247
first_open,1535785705389000,9E25C5FED0F3F775FBB2A5C76DD0511C
first_open,1535808725794000,C945C989CF380E22E1B1E4B28E26801A
first_open,1535843573111000,D31F0611DE6B94A5F001584286883AB7
first_open,1535814207479000,ADB20527463A407E77162C54D30435F1
first_open,1535858897335000,D2007D608FBB90EF5363BF5C8E08117A
first_open,1535787320439000,DAD134C77F7E09BC552E290534CB90E8
first_open,1535858125431000,0CBC523581751D977C4121B95429E8A9
first_open,1535862392716000,AD7DEB9BF9C9B17C60B69DA2B3B6C59A
first_open,1535840569836000,B1885B70DEFAC440D7DCBB520854A651
first_open,1535845655446000,66788E34B6E292DE03B1B54E797CADBF
first_open,1535838840694000,879503A3ED5F2DCB6592E99C42E1BDFE
first_open,1535828304758000,2B6D9C77F287F5C021EC7297203D412B
first_open,1535862567179000,A5302213F1605BE400E8AA34992B18A8
first_open,1535815094027000,2C45FDF91F91AE8A3A9E6F119E8BED13

2025-02-10 16:22:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-02-10 16:22:21 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:21 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
Results:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA

2025-02-10 16:22:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-02-10 16:22:23 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:23 - root - INFO - SQL:
SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'app_exception'
   LIMIT 100;
Results:
event_name,event_timestamp,user_pseudo_id
app_exception,1535846266102003,14DE6B1CDA3BFD44679C7E9382644AC7
app_exception,1535847792339003,B2D359D114428D8DD085DFAFF11195CE
app_exception,1535790897890002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535847669757002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535863213378002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535817449773002,0A26E7281EC31038AD42F28C930FFF90
app_exception,1535835686896005,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535786745474023,D3F06F9B7BD9D7FC8758BF78BF0705E9
app_exception,1535827737994047,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535827864817008,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535832466123018,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869689760019,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869756295014,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535801517341010,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535801814369015,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535793852010011,DD7772866FB721476438D3EDCFA89E06
app_exception,1535801963145000,E594F4CE9B23146A461021258CC7ACA2
app_exception,1535833266081013,E80C958E3C33898989A30B8F5A4514F0
app_exception,1535795070725005,0289ACB4026B0C28A9FF7BF2560E2A7F
app_exception,1535820399116011,959635567E419A061EECCCA478EDC718
app_exception,1535820433900009,959635567E419A061EECCCA478EDC718
app_exception,1535820449873009,959635567E419A061EECCCA478EDC718
app_exception,1535822114482010,959635567E419A061EECCCA478EDC718
app_exception,1535813640000009,F5DAD8DD17B689CF672D65A0A81CF4AC

2025-02-10 16:22:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:24 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:24 - root - INFO - SQL:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""content_type"",
  ""value"": {
    ""string_value"": ""mode""
  }
}"
"{
  ""key"": ""item_id"",
  ""value"": {
    ""string_value"": ""quickplay""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 4945
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""engag

2025-02-10 16:22:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:26 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:23:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:23:43 - root - INFO - ```sql
SELECT
    (COUNT(DISTINCT CASE WHEN u."experienced_crash" = 1 THEN u."user_pseudo_id" END) * 100.0) /
    COUNT(DISTINCT u."user_pseudo_id") AS "Percentage_of_users_who_experienced_crash"
FROM
(
    SELECT
        "user_pseudo_id",
        MIN(CASE WHEN "event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930' THEN "event_timestamp" END) AS "first_open_ts",
        MIN(CASE WHEN "event_name" = 'app_remove' THEN "event_timestamp" END) AS "app_remove_ts",
        MAX(CASE WHEN "event_name" = 'app_exception' THEN 1 ELSE 0 END) AS "experienced_crash"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
        -- Include all other September 2018 tables
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
    ) e
    WHERE
        ("event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930')
        OR "event_name" = 'app_remove'
        OR "event_name" = 'app_exception'
    GROUP BY
        "user_pseudo_id"
) u
WHERE
    u."first_open_ts" IS NOT NULL
    AND u."app_remove_ts" IS NOT NULL
    AND DATEDIFF('day', TO_TIMESTAMP(u."first_open_ts" / 1000), TO_TIMESTAMP(u."app_remove_ts" / 1000)) <= 7;
```
2025-02-10 16:23:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:23:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:23:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:23:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:23:46 - snowflake.connector.connection - INFO - closed
2025-02-10 16:23:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:25:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:25:03 - root - INFO - SQL:
SELECT
    (COUNT(DISTINCT CASE WHEN u."experienced_crash" = 1 THEN u."user_pseudo_id" END) * 100.0) /
    COUNT(DISTINCT u."user_pseudo_id") AS "Percentage_of_users_who_experienced_crash"
FROM
(
    SELECT
        "user_pseudo_id",
        MIN(CASE WHEN "event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930' THEN "event_timestamp" END) AS "first_open_ts",
        MIN(CASE WHEN "event_name" = 'app_remove' THEN "event_timestamp" END) AS "app_remove_ts",
        MAX(CASE WHEN "event_name" = 'app_exception' THEN 1 ELSE 0 END) AS "experienced_crash"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
        -- Include all other September 2018 tables
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
    ) e
    WHERE
        ("event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930')
        OR "event_name" = 'app_remove'
        OR "event_name" = 'app_exception'
    GROUP BY
        "user_pseudo_id"
) u
WHERE
    u."first_open_ts" IS NOT NULL
    AND u."app_remove_ts" IS NOT NULL
    AND DATEDIFF('day', TO_TIMESTAMP(u."first_open_ts" / 1000), TO_TIMESTAMP(u."app_remove_ts" / 1000)) <= 7;
Results:
Percentage_of_users_who_experienced_crash
0.000000

2025-02-10 16:25:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:25:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:25:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:25:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 83
2025-02-10 16:25:05 - snowflake.connector.connection - INFO - closed
2025-02-10 16:25:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:25:05 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
    -- Include all other September 2018 tables up to EVENTS_20180930
) e
WHERE "event_name" = 'app_remove'
LIMIT 100
Results:
user_pseudo_id
9DB70702AD6350C1150E2AD452047208
B0153FFD55333D4C4B546EC5B3FAC70E
3A73CDE17520867FB9C03E491F778B60
6722ACD286AC0F5CA22E745302CAEB89
14FC1A25D55E89AC7ECD600CD3A08C13
4EEE67C2E335213F6815144829801E0F
6D6EB70E837A5007BE550C44FF276440
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
5ACD59093D1C49F2EADAE29D7181A9CF
37EFBD2BA398148336F96B4347392A8D
177C0BEFFC69408F88D3377632F1BB60
37034A23CAFF85394E2E349C381788A6
1E882F0B9818614D6E47620DD31229F1
551B893D34A2A59971B8FF185C1CD0C8
0FDAC2A4A154F9E946D749BFE67B1FCD
7AB9D5F7D122A38CA8769C9C93F3A12F
D6803CFD38D435F0364EB47684F7CCF6
B9D800D33FDCF7AF2157CB66910A0797
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
9E25C5FED0F3F775FBB2A5C76DD0511C
D963E509346C0E5358ECFE56AF3BB2ED
DA4F13B8835C8DF20ADF1C21E060E4B7
ED5C290C8F82C28C033482D31299D8CD
CDB3E008092CD77C3620521FD1F2EB15
1D5A0DC978A69FF28EC9D153F32EA871
2C15FFDEDDA69390B7A8EB5808FB7ED6
531E7B35DE9A21A1942F057C98B4E74C
E0F1ED4167D0C0B2D6DCBA85CB020F52
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
A6E8B0AC5E066F7670116136442F728F
C945C989CF380E22E1B1E4B28E26801A
1852998AFEA1A073E65DECA1F357B6BD
4AE8FCFC6BB2D2974D3C5D83DDC33993
0979A3E58FC8F7FFB1F9FB7C69AF99FE
00AE0CA4117376AE083FD6AEA744CE88
0CC5E5E794CB2FA570F8E6076A4022C1
BD44D71E2775BCAC13C2EADFD20A60CD
1521424D33DCF011133317B863DE89B6
E1FEA6BA9D049EF343C2D18C13E32756
62E7B9088F79A20CADFD49569BA58056
68FD7BAA83E0EBA01BF3D9944032C0B3
492F7F04FA27A466D29C9C0FE7D0E843
8AFB3221668B5EF2E9A246387A266772
C576922AC96E60240D148752D36BF34C
CEBA063FD7BF190D727CC948185CCEC8
EA5907924EF10ECB8AE8AD017E53B0E9
A5302213F1605BE400E8AA34992B18A8
C09F65F2853D03DE23CFD90F97429735
D8B77A575B5308D161F95ACF515F9772
8DEB6CB6C3E85D0032D8557C73ADD49F
6A1D30C821861EACD41F274E8E6D5455
031A51C8350FF183C2C5F2AB9AD00753
99AEF7972E0B774A904B5F2839FC09B0
7954F970C93ED6F9AEF04CE25CE871CD
A33DE80957EE65767566B772BC3E8BA5
2979D1B301F7F36C666AE78523223737
F553AB13C0D66F0916896A26E2B86906
CF13213745D519874DC3AB772839C6AD
CFF34B5186EB1563295F0058BBC7CC0B
FF4633212F293014C26AF8A5C589754C
76515A5A5DDB817C3CF49F1FCFA4D733
6B743763D2790D33F26AFB5618307222
21FD52300AE0FBAB4C95D6D470E471D2
8F780847855ADB932B0121C7278F375F
60A36D65D2C9A3DA5C804006972CCAF8
8B7110AC0A6E048628AB4BCC751E0A09
E4CA88442149C9E1F3A64917A85797D3
5A480E51FD40723099F04567AB4508F4
D0B47C51E0A61F1D0F25F05396D8ABA2
488BE19C45D3D8B2DF02214BC19B44B4
2B9E05C9A73CE9EFCADC80CE582ADBA6
27C0BAADCE9520F17249A8B85F6477DA
8AE0BEA642E3BFAADCABB2FFC6D4B6B4
2C45FDF91F91AE8A3A9E6F119E8BED13
578CB14FCF0AB3CD15250A6991E76B91
3A18031D2051200FEDBE392EB42490A6
6AE4C2E59BEAD8C97D0CE344CA7A1AE5
4242F3099015CEED6E973B209C3C48BE
A51A3E253AE3F2668DC50CB1AE96D60E
03C8FFC95DEC2C1E87EB4646970FC12E
0EFA419FF8D1FB5BAA12E4794D511937

2025-02-10 16:25:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:25:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:25:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:25:06 - snowflake.connector.connection - INFO - closed
2025-02-10 16:25:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:26:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:26:26 - root - INFO - I apologize for the confusion and the error in the SQL query.

**Explanation of the Error:**

The error occurs because the `UNION ALL` operator must be followed by another `SELECT` statement. In your query, the `UNION ALL` is followed by a comment (`-- Include all other September 2018 tables`), which the SQL parser ignores. This results in an incomplete `UNION ALL`, causing the syntax error:

```
syntax error line 7 at position 0 unexpected ')'.
```

**How to Fix the Error:**

To resolve this issue, you have two options:

1. **Include All Relevant Tables After `UNION ALL`:**

   Replace the comment with actual `SELECT` statements from each of the September 2018 tables. Here’s the corrected query:

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM
   (
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
       UNION ALL
       -- Add SELECT statements for all other September 2018 tables up to EVENTS_20180930
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
   ) e
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

   **Note:** You need to include a `SELECT` statement for each of the September 2018 tables you wish to query.

2. **Remove the Incomplete `UNION ALL` Operator:**

   If you only want to query the `EVENTS_20180901` table, you can remove the `UNION ALL` and the comment:

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM
       (SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901") e
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

   Or, even more simply:

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

**Alternative Solution Using a Dynamic Approach:**

If you want to avoid listing all tables manually, you can leverage Snowflake's metadata to dynamically construct the query. Here’s how:

1. **Use a View or Table Function:**

   If you have a large number of tables, consider creating a view that combines all the `EVENTS_201809XX` tables.

2. **Dynamic SQL (Advanced):**

   You can generate and execute dynamic SQL to union all tables that match a pattern. Here’s an example:

   ```sql
   -- Generate a list of all relevant tables
   WITH table_list AS (
     SELECT LISTAGG('SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."' || "TABLE_NAME" || '"', ' UNION ALL ') AS sql_query
     FROM INFORMATION_SCHEMA.TABLES
     WHERE "TABLE_SCHEMA" = 'ANALYTICS_153293282'
       AND "TABLE_NAME" LIKE 'EVENTS_201809%'
   )
   -- Prepare the full query
   SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM (
     EXECUTE IMMEDIATE (SELECT sql_query FROM table_list)
   ) e
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

   **Note:** Using `EXECUTE IMMEDIATE` requires appropriate privileges and may have security implications. Ensure you understand these before proceeding.

**Corrected SQL Query Including All September 2018 Tables:**

Here’s the corrected query with all September 2018 tables explicitly listed:

```sql
SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
) e
WHERE "event_name" = 'first_open'
LIMIT 100;
```

**Summary:**

- **Problem:** The `UNION ALL` operator was left incomplete due to the comment, causing a syntax error.
- **Solution:** Include actual `SELECT` statements after each `UNION ALL` or remove the incomplete `UNION ALL` if not needed.
- **Recommendation:** For maintainability, consider creating a view that combines all relevant tables or using dynamic SQL if appropriate.

Feel free to adjust the query based on your specific needs and ensure all necessary tables are included.
2025-02-10 16:26:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:26:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:26:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:26:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:26:27 - snowflake.connector.connection - INFO - closed
2025-02-10 16:26:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:28:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:28:30 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM
   (
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
       UNION ALL
       -- Add SELECT statements for all other September 2018 tables up to EVENTS_20180930
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
   ) e
   WHERE "event_name" = 'first_open'
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp,event_timestamp
4EEE67C2E335213F6815144829801E0F,1535855580096000,1535855580096000
27C0BAADCE9520F17249A8B85F6477DA,1535825903840000,1535825903840000
9FD6E2CD74490F5DA5F52D249CBB750A,1535800510069000,1535800510069000
D963E509346C0E5358ECFE56AF3BB2ED,1535796824597000,1535796824597000
4A2A03B50BDA6AC1687703BD39A91E3E,1535855219914000,1535855219914000
0E9150E8985138A744B88D56F015EDA7,1535836565290000,1535836565290000
FCD8DDE7775A7211BCA9F42768C3BB8B,1535810901162000,1535810901162000
6D6EB70E837A5007BE550C44FF276440,1535800915359000,1535800915359000
96333A5A97DA9F4AEBC7A70483AF6C5C,1535861885300000,1535861885300000
F4CB0B30E0A170AEB6A94EF1156738C8,1535843461289000,1535843461289000
EA89F979E0D4C374DBC95268982D18DE,1535827029854000,1535827029854000
1D5A0DC978A69FF28EC9D153F32EA871,1535807127198000,1535807127198000
34CAF47105A2D9D0AC7464BB3AF8DB2A,1535852034675000,1535852034675000
2C15FFDEDDA69390B7A8EB5808FB7ED6,1535851024659000,1535851024659000
B9A395E297106E5D6F72747F84AC7AE5,1535824322547000,1535824322547000
6C333017CEA199B69BB27611BA5DE7B5,1535844742760000,1535844742760000
531E7B35DE9A21A1942F057C98B4E74C,1535801979560000,1535801979560000
C09F65F2853D03DE23CFD90F97429735,1535820568861000,1535820568861000
14FC1A25D55E89AC7ECD600CD3A08C13,1535864378333000,1535864378333000
7331597E5500811253BA85AF851A193C,1535867137394000,1535867137394000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000,1535823083751000
97D9D96077AD3E8859BF5C54C873E59D,1535833844071000,1535833844071000
CEBA063FD7BF190D727CC948185CCEC8,1535786768380000,1535786768380000
61BB31EC7781341B1D7B8D8A85688DA3,1535834527505000,1535834527505000
5A66BC427F25EFFDFEDED4A07D8F9F91,1535857954726000,1535857954726000
37EFBD2BA398148336F96B4347392A8D,1535793454587000,1535793454587000
E0F1ED4167D0C0B2D6DCBA85CB020F52,1535813813915000,1535813813915000
177C0BEFFC69408F88D3377632F1BB60,1535851408336000,1535851408336000
5F5D7A3F5575008A81BB77CFE70C4285,1502934327056000,1535851178598000
37034A23CAFF85394E2E349C381788A6,1535814119760000,1535814119760000
387B532B7AF7A362DBF783E34C05BF54,1535818383344000,1535818383344000
1E882F0B9818614D6E47620DD31229F1,1535865216880000,1535865216880000
9F8885F0261FE69A58C8B6AE9176E437,1535839822373000,1535839822373000
ACA2E31E67D50F779611D7FDB674C370,1535851880421000,1535851880421000
551B893D34A2A59971B8FF185C1CD0C8,1535809874149000,1535809874149000
B82793CB1270A48BB2697C51AEED3E4A,1535799569882000,1535799569882000
D771048ADB1B9CACADFE001E6F9BA799,1535867549146000,1535867549146000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000,1535798021434000
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,1535846621178000,1535846621178000
D1C57A2E87382A82A40B1816E85277EA,1535821909295000,1535821909295000
D8B77A575B5308D161F95ACF515F9772,1535864536964000,1535864536964000
7AB9D5F7D122A38CA8769C9C93F3A12F,1535860647684000,1535860647684000
D6803CFD38D435F0364EB47684F7CCF6,1535791708036000,1535791708036000
3E336ECE1F533064D663A350DAB00790,1535790604676000,1535790604676000
CCE5E30054C510608589FA6240615B0A,1535844174073000,1535844174073000
3B049329E3090DA7A4339C4A46EF0763,1535820720601000,1535820720601000
B9D800D33FDCF7AF2157CB66910A0797,1535857240494000,1535857240494000
8DEB6CB6C3E85D0032D8557C73ADD49F,1535807013891000,1535807013891000
A6E8B0AC5E066F7670116136442F728F,1535823345176000,1535823345176000
A305B55D5049F38F5139DA95B3DCE247,1535814764621000,1535814764621000
9E25C5FED0F3F775FBB2A5C76DD0511C,1535785705389000,1535785705389000
C945C989CF380E22E1B1E4B28E26801A,1535808725794000,1535808725794000
D31F0611DE6B94A5F001584286883AB7,1535843573111000,1535843573111000
ADB20527463A407E77162C54D30435F1,1535814207479000,1535814207479000
D2007D608FBB90EF5363BF5C8E08117A,1535858897335000,1535858897335000
DAD134C77F7E09BC552E290534CB90E8,1535787320439000,1535787320439000
0CBC523581751D977C4121B95429E8A9,1535858125431000,1535858125431000
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,1535862392716000,1535862392716000
B1885B70DEFAC440D7DCBB520854A651,1535840569836000,1535840569836000
66788E34B6E292DE03B1B54E797CADBF,1535845655446000,1535845655446000
879503A3ED5F2DCB6592E99C42E1BDFE,1535838840694000,1535838840694000
2B6D9C77F287F5C021EC7297203D412B,1535828304758000,1535828304758000
A5302213F1605BE400E8AA34992B18A8,1535862567179000,1535862567179000
2C45FDF91F91AE8A3A9E6F119E8BED13,1535815094027000,1535815094027000
31334ECCEC5C9988469EAD462A6C4D47,1535927276725000,1535927276725000
0150077AE685E3084E5DB84CF61CE383,1535899621098000,1535899621098000
4AE8FCFC6BB2D2974D3C5D83DDC33993,1535891317770000,1535891317770000
F00F1E006770842CC139749CBA8E9451,1535905050143000,1535905050143000
6A1D30C821861EACD41F274E8E6D5455,1535945982047000,1535945982047000
0FFB521F60BC6AADD9A8E24A248EE0A6,1535934901780000,1535934901780000
1714B7BB554962AE0FA45425EF723D5F,1535947487657000,1535947487657000
1521424D33DCF011133317B863DE89B6,1535896572617000,1535896572617000
63550F65F0818B874ADA2B18C463AB21,1535942088041000,1535942088041000
5A44D0AF57DD95C0F5301649B7A23509,1535909259113000,1

2025-02-10 16:28:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:28:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:28:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:28:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:28:32 - snowflake.connector.connection - INFO - closed
2025-02-10 16:28:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:28:32 - root - INFO - SQL:
-- Corrected SQL 1
SELECT f.value
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484747233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527606769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535867175448000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413020916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118000433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095669887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903928606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484747147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642763867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484724233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527583769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849095055000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465412997916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524117977433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095646887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903905606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484724147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642740867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484791233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527650769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849162055000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413064916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118044433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095713887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903972606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484791147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642807867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484778233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527637769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849149055000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413051916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118031433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095700887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903959606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484778147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642794867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key

2025-02-10 16:28:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:28:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:28:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:28:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:28:33 - snowflake.connector.connection - INFO - closed
2025-02-10 16:28:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:28:34 - root - INFO - SQL:
-- Corrected SQL 2
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
ORDER BY "user_pseudo_id", "event_timestamp"
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943832262001
00AE0CA4117376AE083FD6AEA744CE88,session_start,1535943838600000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943841399005
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943846861001
00AE0CA4117376AE083FD6AEA744CE88,first_open,1535943849861000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943853441006
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943860138004
00AE0CA4117376AE083FD6AEA744CE88,select_content,1535943875092002
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943879944000
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943898262003
00AE0CA4117376AE083FD6AEA744CE88,level_start_quickplay,1535943914329007
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943918990002
00AE0CA4117376AE083FD6AEA744CE88,spend_virtual_currency,1535943927247009
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943932255005
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943937970001
00AE0CA4117376AE083FD6AEA744CE88,use_extra_steps,1535943946247008
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943965900000
00AE0CA4117376AE083FD6AEA744CE88,no_more_extra_steps,1535943977247006
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943982902012
00AE0CA4117376AE083FD6AEA744CE88,ad_reward,1535943983925000
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943996488005
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944000993014
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944008221004
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944014576018
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944022443002
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944022970013
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944023464016
00AE0CA4117376AE083FD6AEA744CE88,no_more_extra_steps,1535944036473004
00AE0CA4117376AE083FD6AEA744CE88,spend_virtual_currency,1535944045473007
00AE0CA4117376AE083FD6AEA744CE88,use_extra_steps,1535944047473006
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944054794017
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944065477003
00AE0CA4117376AE083FD6AEA744CE88,ad_reward,1535944080985000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944085541015
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944088821000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944103042004
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944103442013
00AE0CA4117376AE083FD6AEA744CE88,use_extra_steps,1535944110341013
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944115913019
00AE0CA4117376AE083FD6AEA744CE88,spend_virtual_currency,1535944117341014
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944123308011
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944124519014
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944132005006
00AE0CA4117376AE083FD6AEA744CE88,level_complete_quickplay,1535944132817000
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944133540013
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944135071008
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944139788027
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944143019008
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944146894021
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944150081005
00AE0CA4117376AE083FD6AEA744CE88,level_retry_quickplay,1535944151995007
00AE0CA4117376AE083FD6AEA744CE88,post_score,1535944153817002
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944154831007
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944155379012
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944161634015
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944169900003
00AE0CA4117376AE083FD6AEA744CE88,level_start_quickplay,1535944172694020
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944177707031
00AE0CA4117376AE083FD6AEA744CE88,level_end_quickplay,1535944190817001
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944191909028
00AE0CA4117376AE083FD6AEA744CE88,level_start_quickplay,1535944192052010
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944211706019
00AE0CA4117376AE083FD6AEA744CE88,level_reset_quickplay,1535944215463012
00AE0CA4117376AE083FD6AEA744CE88,app_remove,1535948734327000
00B6295EC351DBFE0E31015296871E35,level_start_quickplay,1535859927443008
00B6295EC351DBFE0E31015296871E35,select_content,1535859957280003
00B6295EC351DBFE0E31015296871E35,screen_view,1535859957476006
00B6295EC351DBFE0E31015296871E35,screen_view,1535859960022001
00B6295EC351DBFE0E31015296871E35,screen_view,1535859972440005
00B6295EC351DBFE0E31015296871E35,screen_view,1535859977850000
00B6295EC351DBFE0E31015296871E35,user_engagement,1535859993343004
00B6295EC351DBFE0E31015296871E35,post_score,1535860005773002
00B6295EC351DBFE0E31015296871E35,session_start,1535860013030000
00B6295EC351DBFE0E31015296871E35,level_complete_quickplay,1535860031770000
00B6295EC351DBFE0E31015296871E35,screen_view,1535860035080005
00B6295EC351DBFE0E31015296871E35,user_engagement,1535860036933004
00B62

2025-02-10 16:28:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:28:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:28:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:28:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-02-10 16:28:35 - snowflake.connector.connection - INFO - closed
2025-02-10 16:28:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:28:36 - root - INFO - SQL:
-- Corrected SQL 3
SELECT DISTINCT "event_name"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
    -- Continue including all relevant tables
) e
LIMIT 100
Results:
event_name
level_complete_quickplay
post_score
session_start
screen_view
level_fail_quickplay
level_end_quickplay
level_start_quickplay
select_content
user_engagement
level_complete
level_end
level_start
level_reset_quickplay
level_retry_quickplay
level_reset
spend_virtual_currency
app_exception
level_fail
app_remove
challenge_a_friend
firebase_campaign
completed_5_levels
app_update
os_update
level_up
level_retry
use_extra_steps
no_more_extra_steps
ad_reward
error
challenge_accepted
first_open
dynamic_link_app_open

2025-02-10 16:28:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:28:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:28:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:28:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:28:37 - snowflake.connector.connection - INFO - closed
2025-02-10 16:28:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:28:37 - root - INFO - SQL:
-- Corrected SQL 4
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
user_pseudo_id,event_count
9F7B0D1BFB822F5E26E91E184E2E437C,14
0AF67C1A1C8F3785609B4210C3E04FC8,8
102CC7D8CD5D3E861EACE1BAB97E61EC,47
A976A39B8E08829A5BC5CD3827C942A2,604
22DF34962481295121082D8C105EB436,34
B8FE9AD137A133A89389656F7989B36C,197
4E6F4A73B5D05B33DC73B11547E39004,4
6D32B47F6F516304209375F1D0CCE5A3,3
4B6BD3964DB295D02E54E59927ED73A0,70
B607C1DF4606F29FD7FA56A6D4DACFAC,58
487DE902636DD8A9844A2D61FE7BD568,217
690DA199396D35B845005CCD13ED8D67,112
9DB70702AD6350C1150E2AD452047208,1
14DE6B1CDA3BFD44679C7E9382644AC7,70
58230465C695B0FDDDAE08A481FAEECC,60
4BB019F8F6D1FE7BA78CA42A4698EF56,36
B0153FFD55333D4C4B546EC5B3FAC70E,1
945DE7C965AFB12E35C3C992CF9847E2,24
E30E8756808AB219B28276F129C51552,3
B2D359D114428D8DD085DFAFF11195CE,13
841727B396264112EC75FEB26C57E25C,194
17636078D57884AD7EA5406C60E2BD10,253
40E48F9F86A546EF73EDE7855625E2B2,3
2F2B5C88B72A5253AAF448B1E29333F5,180
F3917138A3D4B03ADA1C2E77E3B84649,65
3883FF0DFAB40ECD4EA781FC0D1CE18A,36
3A73CDE17520867FB9C03E491F778B60,1
57EC50FBC6C7277B8EDCCE44C1352BD4,1119
186F51E5AACB37852E3650E7027E33B1,83
9FF3330617722CBCB12644B02BFC5EF5,594
C66BF8A9ACA5CD56597E18B0729181C4,41
48AB910A8DE8485D4C34238EA61F782C,218
0579CD8B9F2F5C48A5F1ACECF88750A7,8
FA30269453141794E79B8F15EE0BA5B9,189
0A26E7281EC31038AD42F28C930FFF90,100
1AB36A765847D90D7F029C21FADFB3F4,135
9AAAE2A96BA29B283C25AA62182ECA9D,3
6722ACD286AC0F5CA22E745302CAEB89,13
A5BEE3FC4D5248D2B2C655F6B7C1E5A3,15
4BDC831A6940071E2461D0B5293A329E,254
93CE02A528E41C078FDB04857CCDA48C,202
A7722F61A84758A6CAE3E2C03B9EF742,92
DDDF330206C8FD63B6C78C3BFB13F801,58
34ADF71F1AADCA26EC8008496F7CC87E,164
59BE43F3FE7AB3F91B016B56508D4C46,42
E50F7AC0680FD87AD6CE6B6700D209A7,15
D99BC96AD021DD4BC255489C45083668,9
CA04708DA02378999ECB402481FF1AE4,163
DEADCFB9776A98526FE128254F93C278,40
AFA25B217428A5328ECE8D2C4C583916,10
7FA778C27A7CD840454FC893B8200200,8
CEBA063FD7BF190D727CC948185CCEC8,75
5ACD59093D1C49F2EADAE29D7181A9CF,1
177C0BEFFC69408F88D3377632F1BB60,36
551B893D34A2A59971B8FF185C1CD0C8,35
6E94F41FB1EB000C00CEAF43CF70938F,28
A6522F1A3180B75F091CEB712356A375,42
3B049329E3090DA7A4339C4A46EF0763,199
472451071AED6FF801BC0FE66706FD27,487
8BB6E580D7771BBBE04D3953EA43F640,26
763B5A6DDFFFF56975B9EB032F7E1A96,23
05B57F40FB0403F6F6C3052D28244AB8,15
5800569BC32997BCE5774BA3C675C4E4,30
B081E087ABDC8FE6FB390ACF48CD61D8,25
F26EC6056E284FDDEA7771F203B6BB8F,27
7E74A2BB6BBF4746DEE15F957B315401,848
E8124E2C2D99AB999ADC3CA7D481242E,90
39BE7CAB9B8602ABD10A1BFB4E66BBB2,41
9DE7361ACCDEA6541AD5EA55D59B1C78,21
5ACF1A6BFE350F7BB661BF389AF7E2F0,175
D2057EE2B8E8563B522E6C21B7BD4524,40
26FACA90F8AA62D614E65FD30CD978AB,21
706C748E6D1E0768BFEFE6362B5D3F67,12
4D084D38156128AAA060303AA91E689D,15
8D0EAD73C85E48D958042757FEBB37BC,70
B8984A29BE4798F85EA15F483E37877E,4
571B1FB7D9D44445BF25B75F0FD91660,66
AC14799A5E8C340D6CADCBAE72037D81,59
7ED4165854463C38F1D739A2014001D9,24
47EF903C26610B033B8734C8159B2ECA,17
14FC1A25D55E89AC7ECD600CD3A08C13,305
534D8E69233D917A9A5BC15E3953FEB8,5
7EB0099C021CF1B2C0688CB1C9D42ED0,245
192440EC48EB5C30C261D16F03D7D229,26
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1035
3DC1C89C927D2FC9D264FBC21E401E5B,28
34CAF47105A2D9D0AC7464BB3AF8DB2A,591
A064A84CD3CF7058F39333D6212E8615,21
9A46DD24A6F7AD154E9143AA2D588310,25
037DAC225F0C1E54657770CD201CDDA7,58
03948FE68D30FD7BD6B46D1993062581,33
8065F8E98407106A65D35195984B2258,115
FF20E4EE129C3700FC1C6CEF188E17BB,151
FEDC59699D8832A11B88BFCCCAD0951D,38
D7EA8E3645EFFBD6443946179ED704A6,191
7A85F2041ECC509DEDAD05C9C09125FA,678
3F4C49B7D999DB0D286AA09BED5C04A9,45
7A8D1CAA45CDE7652260DA6E71068A13,164
BF709EB51D61C3A7BF68C4CFD7F236BE,10
53866E32BA0ABFD846772D4B7B9B5921,152

2025-02-10 16:28:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:28:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:28:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:28:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-10 16:28:38 - snowflake.connector.connection - INFO - closed
2025-02-10 16:28:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:28:39 - root - INFO - SQL:
-- Corrected SQL 5
SELECT DISTINCT "event_date"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
LIMIT 100
Results:
event_date
20180901
20180902

2025-02-10 16:28:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:28:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:28:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:28:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:28:40 - snowflake.connector.connection - INFO - closed
2025-02-10 16:28:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:29:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:29:37 - root - INFO - **Explanation of the Error:**

The error message:

```
252005: Failed to convert current row, cause: date value out of range
```

occurs because the `TO_TIMESTAMP` function is receiving invalid or out-of-range values from the `"event_timestamp"` column. This typically happens when:

- The `"event_timestamp"` contains `NULL`, negative, or zero values.
- The timestamp value is too large or too small to be converted into a valid date.
- There are corrupted or unexpected values in the `"event_timestamp"` column.

**How to Fix the Error:**

To resolve this issue, we need to ensure that only valid, positive, non-zero timestamp values are passed to the `TO_TIMESTAMP` function. We can achieve this by adding a `WHERE` clause to filter out invalid values.

**Corrected SQL Query:**

```sql
SELECT "event_timestamp", TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
WHERE "event_timestamp" > 0
LIMIT 100;
```

**Notes:**

- **Added `WHERE "event_timestamp" > 0`:** This filters out any `event_timestamp` values that are `NULL`, zero, or negative, which cannot be converted to valid timestamps.
- **Why `/ 1000`:** If your `event_timestamp` is in milliseconds, dividing by 1000 converts it to seconds, which is the expected input for `TO_TIMESTAMP`.
- **Optional - Use `TRY_TO_TIMESTAMP`:** If you want to handle invalid timestamps gracefully without filtering them out, you can use `TRY_TO_TIMESTAMP`, which returns `NULL` for invalid inputs instead of throwing an error:

  ```sql
  SELECT "event_timestamp", TRY_TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
  FROM
  (
      SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
      UNION ALL
      SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
      -- Continue including all relevant tables
  ) e
  LIMIT 100;
  ```
  
  Using `TRY_TO_TIMESTAMP` prevents the query from failing due to bad data but will result in `NULL` values for invalid timestamps.

**Recommendation:**

- **Data Validation:** It might be helpful to check the data in the `"event_timestamp"` column to identify any anomalous values.
- **Comprehensive Date Range:** Ensure that all relevant tables for September 2018 are included in the `UNION ALL` to get accurate results.
2025-02-10 16:29:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:29:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:29:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:29:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:29:38 - snowflake.connector.connection - INFO - closed
2025-02-10 16:29:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:30:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:30:32 - root - INFO - **Understanding the Issue:**

Despite previous attempts to resolve the error, you are still encountering the following message when running your SQL query:

```
252005: Failed to convert current row, cause: date value out of range
```

This error indicates that the `TO_TIMESTAMP` function is attempting to convert an `event_timestamp` value that is invalid or out of the acceptable range for timestamps. The issue persists because the query is still processing rows with problematic `event_timestamp` values.

**Possible Causes:**

- **Negative or Zero Values:** `event_timestamp` values that are zero or negative cannot be converted to valid timestamps.
- **Excessively Large Values:** Timestamps that are beyond the acceptable range (e.g., beyond the year 9999) will cause conversion errors.
- **Null Values:** If `event_timestamp` contains `NULL` values, the conversion will fail.
- **Non-numeric Values:** Although unlikely in this context, if `event_timestamp` contains non-numeric values, conversion will fail.

**Steps to Diagnose and Fix the Issue:**

1. **Identify Invalid `event_timestamp` Values:**

   First, let's find out which `event_timestamp` values are causing the problem.

   ```sql
   SELECT DISTINCT "event_timestamp"
   FROM
   (
       SELECT "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       -- Continue including all relevant tables
   ) e
   WHERE
       "event_timestamp" IS NULL
       OR "event_timestamp" <= 0
       OR "event_timestamp" > 2534023007999000  -- Timestamp equivalent to '9999-12-31 23:59:59'
   LIMIT 100;
   ```

   **Explanation:**

   - This query retrieves any `event_timestamp` values that are `NULL`, less than or equal to zero, or unreasonably large.
   - By identifying these values, you can assess the extent of data issues.

2. **Exclude Invalid Timestamps in Your Query:**

   Modify your original query to filter out these invalid `event_timestamp` values.

   ```sql
   SELECT "event_timestamp", TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
   FROM
   (
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       -- Continue including all relevant tables
   ) e
   WHERE
       "event_timestamp" > 0
       AND "event_timestamp" <= 2534023007999000
       AND "event_timestamp" IS NOT NULL
   LIMIT 100;
   ```

   **Explanation:**

   - **`"event_timestamp" > 0`:** Excludes zero or negative timestamp values.
   - **`"event_timestamp" <= 2534023007999000`:** Ensures the timestamp does not exceed '9999-12-31 23:59:59'.
   - **`"event_timestamp" IS NOT NULL`:** Excludes `NULL` values.

3. **Use `TRY_TO_TIMESTAMP` Function:**

   To handle invalid `event_timestamp` values gracefully, you can use the `TRY_TO_TIMESTAMP` function, which returns `NULL` for invalid inputs instead of throwing an error.

   ```sql
   SELECT "event_timestamp", TRY_TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
   FROM
   (
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       -- Continue including all relevant tables
   ) e
   LIMIT 100;
   ```

   **Explanation:**

   - `TRY_TO_TIMESTAMP` attempts to convert the value and returns `NULL` if it fails, preventing the query from throwing an error.

4. **Check Data Types and Clean Data if Necessary:**

   Ensure that the `event_timestamp` column is of the appropriate numeric data type (e.g., `BIGINT`).

   If there are any non-numeric or malformed values, you might need to clean the data. You can identify such values with:

   ```sql
   SELECT "event_timestamp"
   FROM
   (
       SELECT "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       -- Continue including all relevant tables
   ) e
   WHERE TRY_TO_TIMESTAMP("event_timestamp" / 1000) IS NULL
   LIMIT 100;
   ```

5. **Confirm the Range of Your Timestamps:**

   Get a sense of the minimum and maximum `event_timestamp` values to see if they are within expected ranges.

   ```sql
   SELECT
       MIN("event_timestamp") AS min_timestamp,
       MAX("event_timestamp") AS max_timestamp
   FROM
   (
       SELECT "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT "event_timestamp" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       -- Continue including all relevant tables
   ) e;
   ```

   **Explanation:**

   - Reviewing the range helps identify if there are outlier values causing the issue.

6. **Include the `LIMIT` Inside the Subqueries (Optional):**

   To reduce the data volume while testing, you can limit the number of records in each subquery.

   ```sql
   SELECT "event_timestamp", TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
   FROM
   (
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" LIMIT 10000
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" LIMIT 10000
       -- Continue including all relevant tables
   ) e
   WHERE
       "event_timestamp" > 0
       AND "event_timestamp" <= 2534023007999000
       AND "event_timestamp" IS NOT NULL
   LIMIT 100;
   ```

   **Note:** Adjust the inner `LIMIT` values as needed.

**Recommendations:**

- **Use `TRY_TO_TIMESTAMP`:** This function prevents the query from failing and allows you to identify problematic `event_timestamp` values.
  
- **Filter Out Invalid Values:** Apply appropriate `WHERE` clauses to exclude invalid or out-of-range timestamps.

- **Data Validation:** Check the data at the source to ensure that `event_timestamp` values are being recorded correctly.

**Final Corrected Query:**

```sql
SELECT "event_timestamp", TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
WHERE
    "event_timestamp" > 0
    AND "event_timestamp" <= 2534023007999000
    AND "event_timestamp" IS NOT NULL
LIMIT 100;
```

**Or Using `TRY_TO_TIMESTAMP`:**

```sql
SELECT "event_timestamp", TRY_TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
WHERE
    "event_timestamp" IS NOT NULL
LIMIT 100;
```

**Next Steps:**

- **Run the adjusted query** and see if the error persists.
- **Investigate the identified invalid `event_timestamp` values** to understand why they are incorrect.
- **Consider data correction** at the source or during ETL processes to prevent such issues in the future.

**Additional Tip:**

If you continue to face issues, you might want to **cast** the `event_timestamp` to a numeric type explicitly:

```sql
SELECT "event_timestamp", TO_TIMESTAMP(CAST("event_timestamp" AS BIGINT) / 1000) AS "event_date"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
WHERE
    "event_timestamp" > 0
    AND "event_timestamp" <= 2534023007999000
    AND "event_timestamp" IS NOT NULL
LIMIT 100;
```

This ensures that `event_timestamp` is treated as a numeric value during the conversion.

---

By applying these modifications, you should be able to execute your query successfully without encountering the date conversion error.
2025-02-10 16:30:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:30:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:30:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:30:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 16:30:33 - snowflake.connector.connection - INFO - closed
2025-02-10 16:30:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:31:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:31:08 - root - INFO - ```sql
SELECT "event_timestamp", TRY_TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
```
2025-02-10 16:31:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:31:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:31:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:31:09 - snowflake.connector.connection - INFO - closed
2025-02-10 16:31:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:31:10 - root - INFO - SQL:
SELECT "event_timestamp", TRY_TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
Results:
001065 (22023): 01ba4d7f-0004-96e7-0001-11c3010c837e: SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,6) and TIMESTAMP_NTZ(6)
2025-02-10 16:31:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:31:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:31:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:31:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 16:31:11 - snowflake.connector.connection - INFO - closed
2025-02-10 16:31:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:31:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:31:48 - root - INFO - ```sql
SELECT "event_timestamp",
       TO_TIMESTAMP(CAST("event_timestamp" / 1000 AS INTEGER)) AS "event_date"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
```
2025-02-10 16:31:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:31:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:31:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:31:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:31:49 - snowflake.connector.connection - INFO - closed
2025-02-10 16:31:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:33:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:33:05 - root - INFO - ```sql
SELECT DISTINCT t1."user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all other September 2018 tables up to "EVENTS_20180930"
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all other September 2018 tables up to "EVENTS_20180930"
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'app_exception'
  AND t2."event_name" = 'app_remove'
  AND TRY_TO_TIMESTAMP(t1."event_timestamp" / 1e6) IS NOT NULL
  AND TRY_TO_TIMESTAMP(t2."event_timestamp" / 1e6) IS NOT NULL
  AND TRY_TO_TIMESTAMP(t1."event_timestamp" / 1e6) < TRY_TO_TIMESTAMP(t2."event_timestamp" / 1e6)
LIMIT 100;
```
2025-02-10 16:33:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:33:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:33:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:33:06 - snowflake.connector.connection - INFO - closed
2025-02-10 16:33:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:33:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:33:57 - root - INFO - ```sql
SELECT DISTINCT t1."user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include UNION ALL statements for all other September 2018 tables up to "EVENTS_20180930"
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include UNION ALL statements for all other September 2018 tables up to "EVENTS_20180930"
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'app_exception'
  AND t2."event_name" = 'app_remove'
  AND TO_TIMESTAMP_NTZ(CAST(t1."event_timestamp" / 1e6 AS BIGINT)) < TO_TIMESTAMP_NTZ(CAST(t2."event_timestamp" / 1e6 AS BIGINT))
LIMIT 100;
```
2025-02-10 16:33:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:33:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:33:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:33:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 16:33:58 - snowflake.connector.connection - INFO - closed
2025-02-10 16:33:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:33:59 - root - INFO - SQL:
SELECT DISTINCT t1."user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include UNION ALL statements for all other September 2018 tables up to "EVENTS_20180930"
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include UNION ALL statements for all other September 2018 tables up to "EVENTS_20180930"
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'app_exception'
  AND t2."event_name" = 'app_remove'
  AND TO_TIMESTAMP_NTZ(CAST(t1."event_timestamp" / 1e6 AS BIGINT)) < TO_TIMESTAMP_NTZ(CAST(t2."event_timestamp" / 1e6 AS BIGINT))
LIMIT 100;
Results:
No data found for the specified query.

2025-02-10 16:33:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:33:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:33:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:34:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 30
2025-02-10 16:34:00 - snowflake.connector.connection - INFO - closed
2025-02-10 16:34:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:34:00 - root - INFO - SQL:
-- Corrected SQL 8
SELECT t1."user_pseudo_id",
       (t2."event_timestamp" - t1."event_timestamp") / (1000 * 60 * 60 * 24) AS "days_to_uninstall"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'first_open'
  AND t2."event_name" = 'app_remove'
LIMIT 100
Results:
user_pseudo_id,days_to_uninstall
4EEE67C2E335213F6815144829801E0F,7.018705
27C0BAADCE9520F17249A8B85F6477DA,1.402153
D963E509346C0E5358ECFE56AF3BB2ED,98.481910
6D6EB70E837A5007BE550C44FF276440,161.350752
1D5A0DC978A69FF28EC9D153F32EA871,0.310845
2C15FFDEDDA69390B7A8EB5808FB7ED6,0.762859
531E7B35DE9A21A1942F057C98B4E74C,0.657130
C09F65F2853D03DE23CFD90F97429735,37.428877
14FC1A25D55E89AC7ECD600CD3A08C13,10.134318
97D9D96077AD3E8859BF5C54C873E59D,28.763600
CEBA063FD7BF190D727CC948185CCEC8,43.856146
5A66BC427F25EFFDFEDED4A07D8F9F91,-0.052477
37EFBD2BA398148336F96B4347392A8D,3.515185
E0F1ED4167D0C0B2D6DCBA85CB020F52,1.795116
177C0BEFFC69408F88D3377632F1BB60,0.963484
37034A23CAFF85394E2E349C381788A6,10.659123
1E882F0B9818614D6E47620DD31229F1,2.862836
551B893D34A2A59971B8FF185C1CD0C8,0.487905
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,17.841412
D8B77A575B5308D161F95ACF515F9772,0.714398
7AB9D5F7D122A38CA8769C9C93F3A12F,63.901481
D6803CFD38D435F0364EB47684F7CCF6,104.375127
B9D800D33FDCF7AF2157CB66910A0797,1.849075
8DEB6CB6C3E85D0032D8557C73ADD49F,0.240787
A6E8B0AC5E066F7670116136442F728F,3.942350
9E25C5FED0F3F775FBB2A5C76DD0511C,4.817292
C945C989CF380E22E1B1E4B28E26801A,0.035069
DAD134C77F7E09BC552E290534CB90E8,14.537246
66788E34B6E292DE03B1B54E797CADBF,0.903368
A5302213F1605BE400E8AA34992B18A8,4.815000

2025-02-10 16:34:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:34:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:34:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:34:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 18
2025-02-10 16:34:01 - snowflake.connector.connection - INFO - closed
2025-02-10 16:34:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:34:02 - root - INFO - SQL:
-- Corrected SQL 9
SELECT t1."user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'first_open'
  AND t2."event_name" = 'app_remove'
  AND (t2."event_timestamp" - t1."event_timestamp") <= (7 * 24 * 60 * 60 * 1000)
LIMIT 100
Results:
user_pseudo_id
27C0BAADCE9520F17249A8B85F6477DA
1D5A0DC978A69FF28EC9D153F32EA871
2C15FFDEDDA69390B7A8EB5808FB7ED6
531E7B35DE9A21A1942F057C98B4E74C
5A66BC427F25EFFDFEDED4A07D8F9F91
37EFBD2BA398148336F96B4347392A8D
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
1E882F0B9818614D6E47620DD31229F1
551B893D34A2A59971B8FF185C1CD0C8
D8B77A575B5308D161F95ACF515F9772
B9D800D33FDCF7AF2157CB66910A0797
8DEB6CB6C3E85D0032D8557C73ADD49F
A6E8B0AC5E066F7670116136442F728F
9E25C5FED0F3F775FBB2A5C76DD0511C
C945C989CF380E22E1B1E4B28E26801A
66788E34B6E292DE03B1B54E797CADBF
A5302213F1605BE400E8AA34992B18A8

2025-02-10 16:34:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:34:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:34:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:34:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-02-10 16:34:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:34:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:34:03 - root - INFO - SQL:
-- Corrected SQL 10
SELECT DISTINCT "user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) e
WHERE "event_name" = 'first_open'
LIMIT 100
Results:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA

2025-02-10 16:34:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:34:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:34:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:34:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 44
2025-02-10 16:34:05 - snowflake.connector.connection - INFO - closed
2025-02-10 16:34:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:34:06 - root - INFO - SQL:
-- Corrected SQL 11
SELECT e.*
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) e
INNER JOIN
(
    SELECT DISTINCT "user_pseudo_id"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        -- Include all other September 2018 tables
    )
    WHERE "event_name" = 'first_open'
) first_users ON e."user_pseudo_id" = first_users."user_pseudo_id"
LIMIT 100
Results:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform,event_dimensions
20180901,1535854411699006,level_fail,"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 6.000000000000000e+00
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_6""
    }
  }
]",,,18,981843,,34CAF47105A2D9D0AC7464BB3AF8DB2A,"[
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1535852002219000,
      ""string_value"": ""20""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1535852185237000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1535854148158000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1535854179387000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1535852002438000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1535852034675000,
      ""set_timestamp_micros"": 1535851995675000
    }
  },
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1535852002220000,
      ""string_value"": ""2""
    }
  }
]",1535852034675000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -18000
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""organic"",
  ""source"": ""google-play""
}",1051193346,ANDROID,
20180901,1535854390699007,level_end,"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 6.000000000000000e+00
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_6""
    }
  }
]",1535854315239007.0,,18,981843,,34CAF47105A2D9D0AC7464BB3AF8DB2A,"[
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1535851981219000,
      ""string_value"": ""20""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1535852164237000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1535854127158000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1535854158387000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1535851981438000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1535852034675000,
      ""set_timestamp_micros"": 1535851974675000
    }
  },
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1535851981220000,
      ""string_value"": ""2""
    }
  }
]",1535852034675000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -18000
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""organic"",
  ""source"": ""google-play""
}",1051193346,ANDROID,
20180901,1535854488836006,use_extra_steps,"[
  {
    ""key"": ""item_name"",
    ""value"": {
      ""string_

2025-02-10 16:34:06 - root - INFO - itercount: 0
2025-02-10 16:34:06 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- **"event_name"**: Used to filter specific events such as `'first_open'`, `'app_exception'`, and `'app_remove'`.
- **"event_timestamp"**: Used to determine when an event occurred.
- **"user_pseudo_id"**: Used to identify unique users across events.
- **"user_first_touch_timestamp"**: Indicates when the user first interacted with the app.
- **"event_params"**: May contain additional event-specific parameters; useful for extracting detailed information.
- **"event_date"**: Represents the date of the event in string format.

**Conditions That May Be Used:**

- Filtering events by **"event_name"** equal to `'first_open'`, `'app_exception'`, or `'app_remove'`.
- Selecting events where **"event_date"** falls within September 2018.
- Calculating time differences by converting **"event_timestamp"** to dates.
- Using **LATERAL FLATTEN** to extract data from JSON columns like **"event_params"** and **"user_properties"**.

---

**SQL Queries:**

1. **Retrieve distinct event names from September 1, 2018:**
   ```sql
   SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
   ```

2. **List events with their timestamps and user IDs:**
   ```sql
   SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
   ```

3. **Find 'first_open' events in September 2018:**
   ```sql
   SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

4. **Get distinct users who opened the app for the first time in September 2018:**
   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

5. **Retrieve 'app_exception' (crash) events:**
   ```sql
   SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'app_exception'
   LIMIT 100;
   ```

6. **Explore the contents of the "event_params" column:**
   ```sql
   SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

7. **Extract specific keys from "event_params" (example key "error_message"):**
   ```sql
   SELECT f.value::VARIANT:"error_message"::STRING AS "error_message"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

8. **Find users who uninstalled the app ('app_remove' events):**
   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'app_remove'
   LIMIT 100;
   ```

9. **Compare "user_first_touch_timestamp" with "event_timestamp" for 'first_open' events:**
   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
   ```

10. **Inspect the "user_properties" column for additional user information:**
    ```sql
    SELECT f.value
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
         LATERAL FLATTEN(input => t."user_properties") f
    LIMIT 100;
    ```

11. **List all events for users, ordered by user and time:**
    ```sql
    SELECT "user_pseudo_id", "event_name", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    ORDER BY "user_pseudo_id", "event_timestamp"
    LIMIT 100;
    ```

12. **Retrieve distinct event names from another date (September 2, 2018):**
    ```sql
    SELECT DISTINCT "event_name"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    LIMIT 100;
    ```

13. **Count the number of events per user:**
    ```sql
    SELECT "user_pseudo_id", COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    GROUP BY "user_pseudo_id"
    LIMIT 100;
    ```

14. **Check the format of "event_date":**
    ```sql
    SELECT DISTINCT "event_date"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    LIMIT 100;
    ```

15. **Convert "event_timestamp" from milliseconds to a readable date:**
    ```sql
    SELECT "event_timestamp", TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    LIMIT 100;
    ```

16. **Identify users who experienced an 'app_exception' before 'app_remove':**
    ```sql
    SELECT DISTINCT t1."user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t1
    INNER JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t2
        ON t1."user_pseudo_id" = t2."user_pseudo_id"
    WHERE t1."event_name" = 'app_exception'
      AND t2."event_name" = 'app_remove'
      AND t1."event_timestamp" < t2."event_timestamp"
    LIMIT 100;
    ```

17. **Calculate the time difference between 'first_open' and 'app_remove' events for users:**
    ```sql
    SELECT t1."user_pseudo_id",
           (t2."event_timestamp" - t1."event_timestamp") / (1000 * 60 * 60 * 24) AS "days_to_uninstall"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t1
    INNER JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t2
        ON t1."user_pseudo_id" = t2."user_pseudo_id"
    WHERE t1."event_name" = 'first_open'
      AND t2."event_name" = 'app_remove'
    LIMIT 100;
    ```

18. **List users who uninstalled the app within 7 days of first opening it:**
    ```sql
    SELECT t1."user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t1
    INNER JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t2
        ON t1."user_pseudo_id" = t2."user_pseudo_id"
    WHERE t1."event_name" = 'first_open'
      AND t2."event_name" = 'app_remove'
      AND (t2."event_timestamp" - t1."event_timestamp") <= (7 * 24 * 60 * 60 * 1000)
    LIMIT 100;
    ```

19. **Identify users who first opened the app in September 2018:**
    ```sql
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    WHERE "event_name" = 'first_open'
    LIMIT 100;
    ```

20. **Fetch all events for users who first opened the app in September 2018:**
    ```sql
    SELECT e.*
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e
    INNER JOIN (
        SELECT DISTINCT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        WHERE "event_name" = 'first_open'
    ) first_users ON e."user_pseudo_id" = first_users."user_pseudo_id"
    LIMIT 100;
    ```

These queries are designed to explore the data relevant to the task, such as identifying users who first opened the app in September 2018, those who experienced crashes, and those who uninstalled the app within a specific timeframe. By examining the structure and contents of the tables and columns, we can gain a better understanding of how to approach the analysis.Query:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Answer:
event_name
session_start
screen_view
level_start_quickplay
user_engagement
post_score
level_complete_quickplay
level_end_quickplay
select_content
level_fail_quickplay
level_retry_quickplay
level_up
level_complete
level_start
level_end
level_retry
level_reset_quickplay
level_fail
completed_5_levels
app_remove
app_exception
level_reset
no_more_extra_steps
os_update
error
firebase_campaign
app_update
use_extra_steps
spend_virtual_currency
ad_reward
challenge_a_friend
first_open
Query:
SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Answer:
Too long, hard cut:
event_name,event_timestamp,user_pseudo_id
session_start,1535867185623000,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849095212001,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849167262008,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849154282009,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849162943013,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535867236618001,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535849186141000,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535867221530000,9F7B0D1BFB822F5E26E91E184E2E437C
level_start_quickplay,1535849137266010,9F7B0D1BFB822F5E26E91E184E2E437C
select_content,1535849164052005,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535849135086007,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535849135913012,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535849197632016,9F7B0D1BFB822F5E26E91E184E2E437C
user_engagement,1535867170853001,9F7B0D1BFB822F5E26E91E184E2E437C
screen_view,1535826937106001,0AF67C1A1C8F3785609B4210C3E04FC8
screen_view,1535826950106001,0AF67C1A1C8F3785609B4210C3E04FC8
screen_view,1535826961795000,0AF67C1A1C8F3785609B4210C3E04FC8
screen_view,1535826910795000,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535826971247003,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535827320896005,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535826970247003,0AF67C1A1C8F3785609B4210C3E04FC8
user_engagement,1535827264896005,0AF67C1A1C8F3785609B4210C3E04FC8
post_score,1535821239792002,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535821383892014,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535821504763026,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535821890531040,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821250791000,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821402891012,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821553762024,102CC7D8CD5D3E861EACE1BAB97E61EC
level_complete_quickplay,1535821939530038,102CC7D8CD5D3E861EACE1BAB97E61EC
session_start,1535821133482000,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821133383001,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821104130005,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821104161006,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821296883004,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821226892005,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821213161007,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821322983016,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821385997017,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821375615019,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821521848028,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821501857029,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821846390032,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821943611042,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821925620043,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821951099046,102CC7D8CD5D3E861EACE1BAB97E61EC
screen_view,1535821111327000,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821116132007,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821234792001,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821211156008,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821364892013,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821341611020,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821534763025,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535821784387033,102CC7D8CD5D3E861EACE1BAB97E61EC
level_end_quickplay,1535821940531039,102CC7D8CD5D3E861EACE1BAB97E61EC
level_start_quickplay,1535822022095047,102CC7D8CD5D3E861EACE1BAB97E61EC
select_content,1535821167995003,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821167045004,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821256874003,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821278137006,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821387973015,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821368577018,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821476838027,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821540075030,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821804316031,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821953594041,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821920836044,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821978034045,102CC7D8CD5D3E861EACE1BAB97E61EC
user_engagement,1535821957063051,102CC7D8CD5D3E861EACE1BAB97E61EC
post_score,1535858453281002,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858450179027,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858549250053,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858583326076,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858575828103,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858676432129,A976A39B8E08829A5BC5CD3827C942A2
post_score,1535858667955146,A976A39B8E08829A5BC5CD3827C942A2
post_score,153585876923
Query:
SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
Answer:
event_name,event_timestamp,user_pseudo_id
first_open,1535855580096000,4EEE67C2E335213F6815144829801E0F
first_open,1535825903840000,27C0BAADCE9520F17249A8B85F6477DA
first_open,1535800510069000,9FD6E2CD74490F5DA5F52D249CBB750A
first_open,1535796824597000,D963E509346C0E5358ECFE56AF3BB2ED
first_open,1535855219914000,4A2A03B50BDA6AC1687703BD39A91E3E
first_open,1535836565290000,0E9150E8985138A744B88D56F015EDA7
first_open,1535810901162000,FCD8DDE7775A7211BCA9F42768C3BB8B
first_open,1535800915359000,6D6EB70E837A5007BE550C44FF276440
first_open,1535861885300000,96333A5A97DA9F4AEBC7A70483AF6C5C
first_open,1535843461289000,F4CB0B30E0A170AEB6A94EF1156738C8
first_open,1535827029854000,EA89F979E0D4C374DBC95268982D18DE
first_open,1535807127198000,1D5A0DC978A69FF28EC9D153F32EA871
first_open,1535852034675000,34CAF47105A2D9D0AC7464BB3AF8DB2A
first_open,1535851024659000,2C15FFDEDDA69390B7A8EB5808FB7ED6
first_open,1535824322547000,B9A395E297106E5D6F72747F84AC7AE5
first_open,1535844742760000,6C333017CEA199B69BB27611BA5DE7B5
first_open,1535801979560000,531E7B35DE9A21A1942F057C98B4E74C
first_open,1535820568861000,C09F65F2853D03DE23CFD90F97429735
first_open,1535864378333000,14FC1A25D55E89AC7ECD600CD3A08C13
first_open,1535867137394000,7331597E5500811253BA85AF851A193C
first_open,1535823083751000,5DA9B900E7C9F71714FB1AE9DA631C83
first_open,1535833844071000,97D9D96077AD3E8859BF5C54C873E59D
first_open,1535786768380000,CEBA063FD7BF190D727CC948185CCEC8
first_open,1535834527505000,61BB31EC7781341B1D7B8D8A85688DA3
first_open,1535857954726000,5A66BC427F25EFFDFEDED4A07D8F9F91
first_open,1535793454587000,37EFBD2BA398148336F96B4347392A8D
first_open,1535813813915000,E0F1ED4167D0C0B2D6DCBA85CB020F52
first_open,1535851408336000,177C0BEFFC69408F88D3377632F1BB60
first_open,1535851178598000,5F5D7A3F5575008A81BB77CFE70C4285
first_open,1535814119760000,37034A23CAFF85394E2E349C381788A6
first_open,1535818383344000,387B532B7AF7A362DBF783E34C05BF54
first_open,1535865216880000,1E882F0B9818614D6E47620DD31229F1
first_open,1535839822373000,9F8885F0261FE69A58C8B6AE9176E437
first_open,1535851880421000,ACA2E31E67D50F779611D7FDB674C370
first_open,1535809874149000,551B893D34A2A59971B8FF185C1CD0C8
first_open,1535799569882000,B82793CB1270A48BB2697C51AEED3E4A
first_open,1535867549146000,D771048ADB1B9CACADFE001E6F9BA799
first_open,1535798021434000,C7DD86F06FD4AA8A0967E27E20750FCD
first_open,1535846621178000,E6E7FC8AC6D32935DA5ADCFFD14CC3A8
first_open,1535821909295000,D1C57A2E87382A82A40B1816E85277EA
first_open,1535864536964000,D8B77A575B5308D161F95ACF515F9772
first_open,1535860647684000,7AB9D5F7D122A38CA8769C9C93F3A12F
first_open,1535791708036000,D6803CFD38D435F0364EB47684F7CCF6
first_open,1535790604676000,3E336ECE1F533064D663A350DAB00790
first_open,1535844174073000,CCE5E30054C510608589FA6240615B0A
first_open,1535820720601000,3B049329E3090DA7A4339C4A46EF0763
first_open,1535857240494000,B9D800D33FDCF7AF2157CB66910A0797
first_open,1535807013891000,8DEB6CB6C3E85D0032D8557C73ADD49F
first_open,1535823345176000,A6E8B0AC5E066F7670116136442F728F
first_open,1535814764621000,A305B55D5049F38F5139DA95B3DCE247
first_open,1535785705389000,9E25C5FED0F3F775FBB2A5C76DD0511C
first_open,1535808725794000,C945C989CF380E22E1B1E4B28E26801A
first_open,1535843573111000,D31F0611DE6B94A5F001584286883AB7
first_open,1535814207479000,ADB20527463A407E77162C54D30435F1
first_open,1535858897335000,D2007D608FBB90EF5363BF5C8E08117A
first_open,1535787320439000,DAD134C77F7E09BC552E290534CB90E8
first_open,1535858125431000,0CBC523581751D977C4121B95429E8A9
first_open,1535862392716000,AD7DEB9BF9C9B17C60B69DA2B3B6C59A
first_open,1535840569836000,B1885B70DEFAC440D7DCBB520854A651
first_open,1535845655446000,66788E34B6E292DE03B1B54E797CADBF
first_open,1535838840694000,879503A3ED5F2DCB6592E99C42E1BDFE
first_open,1535828304758000,2B6D9C77F287F5C021EC7297203D412B
first_open,1535862567179000,A5302213F1605BE400E8AA34992B18A8
first_open,1535815094027000,2C45FDF91F91AE8A3A9E6F119E8BED13
Query:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
   LIMIT 100;
Answer:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA
Query:
SELECT "event_name", "event_timestamp", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'app_exception'
   LIMIT 100;
Answer:
event_name,event_timestamp,user_pseudo_id
app_exception,1535846266102003,14DE6B1CDA3BFD44679C7E9382644AC7
app_exception,1535847792339003,B2D359D114428D8DD085DFAFF11195CE
app_exception,1535790897890002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535847669757002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535863213378002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535817449773002,0A26E7281EC31038AD42F28C930FFF90
app_exception,1535835686896005,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535786745474023,D3F06F9B7BD9D7FC8758BF78BF0705E9
app_exception,1535827737994047,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535827864817008,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535832466123018,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869689760019,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869756295014,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535801517341010,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535801814369015,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535793852010011,DD7772866FB721476438D3EDCFA89E06
app_exception,1535801963145000,E594F4CE9B23146A461021258CC7ACA2
app_exception,1535833266081013,E80C958E3C33898989A30B8F5A4514F0
app_exception,1535795070725005,0289ACB4026B0C28A9FF7BF2560E2A7F
app_exception,1535820399116011,959635567E419A061EECCCA478EDC718
app_exception,1535820433900009,959635567E419A061EECCCA478EDC718
app_exception,1535820449873009,959635567E419A061EECCCA478EDC718
app_exception,1535822114482010,959635567E419A061EECCCA478EDC718
app_exception,1535813640000009,F5DAD8DD17B689CF672D65A0A81CF4AC
Query:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""content_type"",
  ""value"": {
    ""string_value"": ""mode""
  }
}"
"{
  ""key"": ""item_id"",
  ""value"": {
    ""string_value"": ""quickplay""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 4945
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""engag
Query:
SELECT
    (COUNT(DISTINCT CASE WHEN u."experienced_crash" = 1 THEN u."user_pseudo_id" END) * 100.0) /
    COUNT(DISTINCT u."user_pseudo_id") AS "Percentage_of_users_who_experienced_crash"
FROM
(
    SELECT
        "user_pseudo_id",
        MIN(CASE WHEN "event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930' THEN "event_timestamp" END) AS "first_open_ts",
        MIN(CASE WHEN "event_name" = 'app_remove' THEN "event_timestamp" END) AS "app_remove_ts",
        MAX(CASE WHEN "event_name" = 'app_exception' THEN 1 ELSE 0 END) AS "experienced_crash"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
        -- Include all other September 2018 tables
        UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
    ) e
    WHERE
        ("event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930')
        OR "event_name" = 'app_remove'
        OR "event_name" = 'app_exception'
    GROUP BY
        "user_pseudo_id"
) u
WHERE
    u."first_open_ts" IS NOT NULL
    AND u."app_remove_ts" IS NOT NULL
    AND DATEDIFF('day', TO_TIMESTAMP(u."first_open_ts" / 1000), TO_TIMESTAMP(u."app_remove_ts" / 1000)) <= 7;
Answer:
Percentage_of_users_who_experienced_crash
0.000000
Query:
SELECT DISTINCT "user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
    -- Include all other September 2018 tables up to EVENTS_20180930
) e
WHERE "event_name" = 'app_remove'
LIMIT 100
Answer:
user_pseudo_id
9DB70702AD6350C1150E2AD452047208
B0153FFD55333D4C4B546EC5B3FAC70E
3A73CDE17520867FB9C03E491F778B60
6722ACD286AC0F5CA22E745302CAEB89
14FC1A25D55E89AC7ECD600CD3A08C13
4EEE67C2E335213F6815144829801E0F
6D6EB70E837A5007BE550C44FF276440
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
5ACD59093D1C49F2EADAE29D7181A9CF
37EFBD2BA398148336F96B4347392A8D
177C0BEFFC69408F88D3377632F1BB60
37034A23CAFF85394E2E349C381788A6
1E882F0B9818614D6E47620DD31229F1
551B893D34A2A59971B8FF185C1CD0C8
0FDAC2A4A154F9E946D749BFE67B1FCD
7AB9D5F7D122A38CA8769C9C93F3A12F
D6803CFD38D435F0364EB47684F7CCF6
B9D800D33FDCF7AF2157CB66910A0797
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
9E25C5FED0F3F775FBB2A5C76DD0511C
D963E509346C0E5358ECFE56AF3BB2ED
DA4F13B8835C8DF20ADF1C21E060E4B7
ED5C290C8F82C28C033482D31299D8CD
CDB3E008092CD77C3620521FD1F2EB15
1D5A0DC978A69FF28EC9D153F32EA871
2C15FFDEDDA69390B7A8EB5808FB7ED6
531E7B35DE9A21A1942F057C98B4E74C
E0F1ED4167D0C0B2D6DCBA85CB020F52
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
A6E8B0AC5E066F7670116136442F728F
C945C989CF380E22E1B1E4B28E26801A
1852998AFEA1A073E65DECA1F357B6BD
4AE8FCFC6BB2D2974D3C5D83DDC33993
0979A3E58FC8F7FFB1F9FB7C69AF99FE
00AE0CA4117376AE083FD6AEA744CE88
0CC5E5E794CB2FA570F8E6076A4022C1
BD44D71E2775BCAC13C2EADFD20A60CD
1521424D33DCF011133317B863DE89B6
E1FEA6BA9D049EF343C2D18C13E32756
62E7B9088F79A20CADFD49569BA58056
68FD7BAA83E0EBA01BF3D9944032C0B3
492F7F04FA27A466D29C9C0FE7D0E843
8AFB3221668B5EF2E9A246387A266772
C576922AC96E60240D148752D36BF34C
CEBA063FD7BF190D727CC948185CCEC8
EA5907924EF10ECB8AE8AD017E53B0E9
A5302213F1605BE400E8AA34992B18A8
C09F65F2853D03DE23CFD90F97429735
D8B77A575B5308D161F95ACF515F9772
8DEB6CB6C3E85D0032D8557C73ADD49F
6A1D30C821861EACD41F274E8E6D5455
031A51C8350FF183C2C5F2AB9AD00753
99AEF7972E0B774A904B5F2839FC09B0
7954F970C93ED6F9AEF04CE25CE871CD
A33DE80957EE65767566B772BC3E8BA5
2979D1B301F7F36C666AE78523223737
F553AB13C0D66F0916896A26E2B86906
CF13213745D519874DC3AB772839C6AD
CFF34B5186EB1563295F0058BBC7CC0B
FF4633212F293014C26AF8A5C589754C
76515A5A5DDB817C3CF49F1FCFA4D733
6B743763D2790D33F26AFB5618307222
21FD52300AE0FBAB4C95D6D470E471D2
8F780847855ADB932B0121C7278F375F
60A36D65D2C9A3DA5C804006972CCAF8
8B7110AC0A6E048628AB4BCC751E0A09
E4CA88442149C9E1F3A64917A85797D3
5A480E51FD40723099F04567AB4508F4
D0B47C51E0A61F1D0F25F05396D8ABA2
488BE19C45D3D8B2DF02214BC19B44B4
2B9E05C9A73CE9EFCADC80CE582ADBA6
27C0BAADCE9520F17249A8B85F6477DA
8AE0BEA642E3BFAADCABB2FFC6D4B6B4
2C45FDF91F91AE8A3A9E6F119E8BED13
578CB14FCF0AB3CD15250A6991E76B91
3A18031D2051200FEDBE392EB42490A6
6AE4C2E59BEAD8C97D0CE344CA7A1AE5
4242F3099015CEED6E973B209C3C48BE
A51A3E253AE3F2668DC50CB1AE96D60E
03C8FFC95DEC2C1E87EB4646970FC12E
0EFA419FF8D1FB5BAA12E4794D511937
Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_timestamp"
   FROM
   (
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
       UNION ALL
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
       UNION ALL
       -- Add SELECT statements for all other September 2018 tables up to EVENTS_20180930
       SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
   ) e
   WHERE "event_name" = 'first_open'
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp,event_timestamp
4EEE67C2E335213F6815144829801E0F,1535855580096000,1535855580096000
27C0BAADCE9520F17249A8B85F6477DA,1535825903840000,1535825903840000
9FD6E2CD74490F5DA5F52D249CBB750A,1535800510069000,1535800510069000
D963E509346C0E5358ECFE56AF3BB2ED,1535796824597000,1535796824597000
4A2A03B50BDA6AC1687703BD39A91E3E,1535855219914000,1535855219914000
0E9150E8985138A744B88D56F015EDA7,1535836565290000,1535836565290000
FCD8DDE7775A7211BCA9F42768C3BB8B,1535810901162000,1535810901162000
6D6EB70E837A5007BE550C44FF276440,1535800915359000,1535800915359000
96333A5A97DA9F4AEBC7A70483AF6C5C,1535861885300000,1535861885300000
F4CB0B30E0A170AEB6A94EF1156738C8,1535843461289000,1535843461289000
EA89F979E0D4C374DBC95268982D18DE,1535827029854000,1535827029854000
1D5A0DC978A69FF28EC9D153F32EA871,1535807127198000,1535807127198000
34CAF47105A2D9D0AC7464BB3AF8DB2A,1535852034675000,1535852034675000
2C15FFDEDDA69390B7A8EB5808FB7ED6,1535851024659000,1535851024659000
B9A395E297106E5D6F72747F84AC7AE5,1535824322547000,1535824322547000
6C333017CEA199B69BB27611BA5DE7B5,1535844742760000,1535844742760000
531E7B35DE9A21A1942F057C98B4E74C,1535801979560000,1535801979560000
C09F65F2853D03DE23CFD90F97429735,1535820568861000,1535820568861000
14FC1A25D55E89AC7ECD600CD3A08C13,1535864378333000,1535864378333000
7331597E5500811253BA85AF851A193C,1535867137394000,1535867137394000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000,1535823083751000
97D9D96077AD3E8859BF5C54C873E59D,1535833844071000,1535833844071000
CEBA063FD7BF190D727CC948185CCEC8,1535786768380000,1535786768380000
61BB31EC7781341B1D7B8D8A85688DA3,1535834527505000,1535834527505000
5A66BC427F25EFFDFEDED4A07D8F9F91,1535857954726000,1535857954726000
37EFBD2BA398148336F96B4347392A8D,1535793454587000,1535793454587000
E0F1ED4167D0C0B2D6DCBA85CB020F52,1535813813915000,1535813813915000
177C0BEFFC69408F88D3377632F1BB60,1535851408336000,1535851408336000
5F5D7A3F5575008A81BB77CFE70C4285,1502934327056000,1535851178598000
37034A23CAFF85394E2E349C381788A6,1535814119760000,1535814119760000
387B532B7AF7A362DBF783E34C05BF54,1535818383344000,1535818383344000
1E882F0B9818614D6E47620DD31229F1,1535865216880000,1535865216880000
9F8885F0261FE69A58C8B6AE9176E437,1535839822373000,1535839822373000
ACA2E31E67D50F779611D7FDB674C370,1535851880421000,1535851880421000
551B893D34A2A59971B8FF185C1CD0C8,1535809874149000,1535809874149000
B82793CB1270A48BB2697C51AEED3E4A,1535799569882000,1535799569882000
D771048ADB1B9CACADFE001E6F9BA799,1535867549146000,1535867549146000
C7DD86F06FD4AA8A0967E27E20750FCD,1535798021434000,1535798021434000
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,1535846621178000,1535846621178000
D1C57A2E87382A82A40B1816E85277EA,1535821909295000,1535821909295000
D8B77A575B5308D161F95ACF515F9772,1535864536964000,1535864536964000
7AB9D5F7D122A38CA8769C9C93F3A12F,1535860647684000,1535860647684000
D6803CFD38D435F0364EB47684F7CCF6,1535791708036000,1535791708036000
3E336ECE1F533064D663A350DAB00790,1535790604676000,1535790604676000
CCE5E30054C510608589FA6240615B0A,1535844174073000,1535844174073000
3B049329E3090DA7A4339C4A46EF0763,1535820720601000,1535820720601000
B9D800D33FDCF7AF2157CB66910A0797,1535857240494000,1535857240494000
8DEB6CB6C3E85D0032D8557C73ADD49F,1535807013891000,1535807013891000
A6E8B0AC5E066F7670116136442F728F,1535823345176000,1535823345176000
A305B55D5049F38F5139DA95B3DCE247,1535814764621000,1535814764621000
9E25C5FED0F3F775FBB2A5C76DD0511C,1535785705389000,1535785705389000
C945C989CF380E22E1B1E4B28E26801A,1535808725794000,1535808725794000
D31F0611DE6B94A5F001584286883AB7,1535843573111000,1535843573111000
ADB20527463A407E77162C54D30435F1,1535814207479000,1535814207479000
D2007D608FBB90EF5363BF5C8E08117A,1535858897335000,1535858897335000
DAD134C77F7E09BC552E290534CB90E8,1535787320439000,1535787320439000
0CBC523581751D977C4121B95429E8A9,1535858125431000,1535858125431000
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,1535862392716000,1535862392716000
B1885B70DEFAC440D7DCBB520854A651,1535840569836000,1535840569836000
66788E34B6E292DE03B1B54E797CADBF,1535845655446000,1535845655446000
879503A3ED5F2DCB6592E99C42E1BDFE,1535838840694000,1535838840694000
2B6D9C77F287F5C021EC7297203D412B,1535828304758000,1535828304758000
A5302213F1605BE400E8AA34992B18A8,1535862567179000,1535862567179000
2C45FDF91F91AE8A3A9E6F119E8BED13,1535815094027000,1535815094027000
31334ECCEC5C9988469EAD462A6C4D47,1535927276725000,1535927276725000
0150077AE685E3084E5DB84CF61CE383,1535899621098000,1535899621098000
4AE8FCFC6BB2D2974D3C5D83DDC33993,1535891317770000,1535891317770000
F00F1E006770842CC139749CBA8E9451,1535905050143000,1535905050143000
6A1D30C821861EACD41F274E8E6D5455,1535945982047000,1535945982047000
0FFB521F60BC6AADD9A8E24A248EE0A6,1535934901780000,1535934901780000
1714B7BB554962AE0FA45425EF723D5F,1535947487657000,1535947487657000
1521424D33DCF011133317B863DE89B6,1535896572617000,1535896572617000
63550F65F0818B874ADA2B18C463AB21,1535942088041000,1535942088041000
5A44D0AF57DD95C0F5301649B7A23509,1535909259113000,1
Query:
-- Corrected SQL 1
SELECT f.value
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484747233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527606769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535867175448000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413020916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118000433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095669887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903928606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484747147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642763867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484724233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527583769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849095055000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465412997916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524117977433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095646887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903905606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484724147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642740867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484791233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527650769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849162055000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413064916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118044433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095713887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903972606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484791147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642807867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484778233000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527637769000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849149055000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413051916000,
    ""string_value"": ""856338239819935514""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118031433000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095700887000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903959606000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484778147000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642794867000,
    ""string_value"": ""2""
  }
}"
"{
  ""key
Query:
-- Corrected SQL 2
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
ORDER BY "user_pseudo_id", "event_timestamp"
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943832262001
00AE0CA4117376AE083FD6AEA744CE88,session_start,1535943838600000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943841399005
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943846861001
00AE0CA4117376AE083FD6AEA744CE88,first_open,1535943849861000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943853441006
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943860138004
00AE0CA4117376AE083FD6AEA744CE88,select_content,1535943875092002
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943879944000
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943898262003
00AE0CA4117376AE083FD6AEA744CE88,level_start_quickplay,1535943914329007
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943918990002
00AE0CA4117376AE083FD6AEA744CE88,spend_virtual_currency,1535943927247009
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943932255005
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535943937970001
00AE0CA4117376AE083FD6AEA744CE88,use_extra_steps,1535943946247008
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943965900000
00AE0CA4117376AE083FD6AEA744CE88,no_more_extra_steps,1535943977247006
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943982902012
00AE0CA4117376AE083FD6AEA744CE88,ad_reward,1535943983925000
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535943996488005
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944000993014
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944008221004
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944014576018
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944022443002
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944022970013
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944023464016
00AE0CA4117376AE083FD6AEA744CE88,no_more_extra_steps,1535944036473004
00AE0CA4117376AE083FD6AEA744CE88,spend_virtual_currency,1535944045473007
00AE0CA4117376AE083FD6AEA744CE88,use_extra_steps,1535944047473006
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944054794017
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944065477003
00AE0CA4117376AE083FD6AEA744CE88,ad_reward,1535944080985000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944085541015
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944088821000
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944103042004
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944103442013
00AE0CA4117376AE083FD6AEA744CE88,use_extra_steps,1535944110341013
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944115913019
00AE0CA4117376AE083FD6AEA744CE88,spend_virtual_currency,1535944117341014
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944123308011
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944124519014
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944132005006
00AE0CA4117376AE083FD6AEA744CE88,level_complete_quickplay,1535944132817000
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944133540013
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944135071008
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944139788027
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944143019008
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944146894021
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944150081005
00AE0CA4117376AE083FD6AEA744CE88,level_retry_quickplay,1535944151995007
00AE0CA4117376AE083FD6AEA744CE88,post_score,1535944153817002
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944154831007
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944155379012
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944161634015
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944169900003
00AE0CA4117376AE083FD6AEA744CE88,level_start_quickplay,1535944172694020
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944177707031
00AE0CA4117376AE083FD6AEA744CE88,level_end_quickplay,1535944190817001
00AE0CA4117376AE083FD6AEA744CE88,screen_view,1535944191909028
00AE0CA4117376AE083FD6AEA744CE88,level_start_quickplay,1535944192052010
00AE0CA4117376AE083FD6AEA744CE88,user_engagement,1535944211706019
00AE0CA4117376AE083FD6AEA744CE88,level_reset_quickplay,1535944215463012
00AE0CA4117376AE083FD6AEA744CE88,app_remove,1535948734327000
00B6295EC351DBFE0E31015296871E35,level_start_quickplay,1535859927443008
00B6295EC351DBFE0E31015296871E35,select_content,1535859957280003
00B6295EC351DBFE0E31015296871E35,screen_view,1535859957476006
00B6295EC351DBFE0E31015296871E35,screen_view,1535859960022001
00B6295EC351DBFE0E31015296871E35,screen_view,1535859972440005
00B6295EC351DBFE0E31015296871E35,screen_view,1535859977850000
00B6295EC351DBFE0E31015296871E35,user_engagement,1535859993343004
00B6295EC351DBFE0E31015296871E35,post_score,1535860005773002
00B6295EC351DBFE0E31015296871E35,session_start,1535860013030000
00B6295EC351DBFE0E31015296871E35,level_complete_quickplay,1535860031770000
00B6295EC351DBFE0E31015296871E35,screen_view,1535860035080005
00B6295EC351DBFE0E31015296871E35,user_engagement,1535860036933004
00B62
Query:
-- Corrected SQL 3
SELECT DISTINCT "event_name"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
    -- Continue including all relevant tables
) e
LIMIT 100
Answer:
event_name
level_complete_quickplay
post_score
session_start
screen_view
level_fail_quickplay
level_end_quickplay
level_start_quickplay
select_content
user_engagement
level_complete
level_end
level_start
level_reset_quickplay
level_retry_quickplay
level_reset
spend_virtual_currency
app_exception
level_fail
app_remove
challenge_a_friend
firebase_campaign
completed_5_levels
app_update
os_update
level_up
level_retry
use_extra_steps
no_more_extra_steps
ad_reward
error
challenge_accepted
first_open
dynamic_link_app_open
Query:
-- Corrected SQL 4
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
user_pseudo_id,event_count
9F7B0D1BFB822F5E26E91E184E2E437C,14
0AF67C1A1C8F3785609B4210C3E04FC8,8
102CC7D8CD5D3E861EACE1BAB97E61EC,47
A976A39B8E08829A5BC5CD3827C942A2,604
22DF34962481295121082D8C105EB436,34
B8FE9AD137A133A89389656F7989B36C,197
4E6F4A73B5D05B33DC73B11547E39004,4
6D32B47F6F516304209375F1D0CCE5A3,3
4B6BD3964DB295D02E54E59927ED73A0,70
B607C1DF4606F29FD7FA56A6D4DACFAC,58
487DE902636DD8A9844A2D61FE7BD568,217
690DA199396D35B845005CCD13ED8D67,112
9DB70702AD6350C1150E2AD452047208,1
14DE6B1CDA3BFD44679C7E9382644AC7,70
58230465C695B0FDDDAE08A481FAEECC,60
4BB019F8F6D1FE7BA78CA42A4698EF56,36
B0153FFD55333D4C4B546EC5B3FAC70E,1
945DE7C965AFB12E35C3C992CF9847E2,24
E30E8756808AB219B28276F129C51552,3
B2D359D114428D8DD085DFAFF11195CE,13
841727B396264112EC75FEB26C57E25C,194
17636078D57884AD7EA5406C60E2BD10,253
40E48F9F86A546EF73EDE7855625E2B2,3
2F2B5C88B72A5253AAF448B1E29333F5,180
F3917138A3D4B03ADA1C2E77E3B84649,65
3883FF0DFAB40ECD4EA781FC0D1CE18A,36
3A73CDE17520867FB9C03E491F778B60,1
57EC50FBC6C7277B8EDCCE44C1352BD4,1119
186F51E5AACB37852E3650E7027E33B1,83
9FF3330617722CBCB12644B02BFC5EF5,594
C66BF8A9ACA5CD56597E18B0729181C4,41
48AB910A8DE8485D4C34238EA61F782C,218
0579CD8B9F2F5C48A5F1ACECF88750A7,8
FA30269453141794E79B8F15EE0BA5B9,189
0A26E7281EC31038AD42F28C930FFF90,100
1AB36A765847D90D7F029C21FADFB3F4,135
9AAAE2A96BA29B283C25AA62182ECA9D,3
6722ACD286AC0F5CA22E745302CAEB89,13
A5BEE3FC4D5248D2B2C655F6B7C1E5A3,15
4BDC831A6940071E2461D0B5293A329E,254
93CE02A528E41C078FDB04857CCDA48C,202
A7722F61A84758A6CAE3E2C03B9EF742,92
DDDF330206C8FD63B6C78C3BFB13F801,58
34ADF71F1AADCA26EC8008496F7CC87E,164
59BE43F3FE7AB3F91B016B56508D4C46,42
E50F7AC0680FD87AD6CE6B6700D209A7,15
D99BC96AD021DD4BC255489C45083668,9
CA04708DA02378999ECB402481FF1AE4,163
DEADCFB9776A98526FE128254F93C278,40
AFA25B217428A5328ECE8D2C4C583916,10
7FA778C27A7CD840454FC893B8200200,8
CEBA063FD7BF190D727CC948185CCEC8,75
5ACD59093D1C49F2EADAE29D7181A9CF,1
177C0BEFFC69408F88D3377632F1BB60,36
551B893D34A2A59971B8FF185C1CD0C8,35
6E94F41FB1EB000C00CEAF43CF70938F,28
A6522F1A3180B75F091CEB712356A375,42
3B049329E3090DA7A4339C4A46EF0763,199
472451071AED6FF801BC0FE66706FD27,487
8BB6E580D7771BBBE04D3953EA43F640,26
763B5A6DDFFFF56975B9EB032F7E1A96,23
05B57F40FB0403F6F6C3052D28244AB8,15
5800569BC32997BCE5774BA3C675C4E4,30
B081E087ABDC8FE6FB390ACF48CD61D8,25
F26EC6056E284FDDEA7771F203B6BB8F,27
7E74A2BB6BBF4746DEE15F957B315401,848
E8124E2C2D99AB999ADC3CA7D481242E,90
39BE7CAB9B8602ABD10A1BFB4E66BBB2,41
9DE7361ACCDEA6541AD5EA55D59B1C78,21
5ACF1A6BFE350F7BB661BF389AF7E2F0,175
D2057EE2B8E8563B522E6C21B7BD4524,40
26FACA90F8AA62D614E65FD30CD978AB,21
706C748E6D1E0768BFEFE6362B5D3F67,12
4D084D38156128AAA060303AA91E689D,15
8D0EAD73C85E48D958042757FEBB37BC,70
B8984A29BE4798F85EA15F483E37877E,4
571B1FB7D9D44445BF25B75F0FD91660,66
AC14799A5E8C340D6CADCBAE72037D81,59
7ED4165854463C38F1D739A2014001D9,24
47EF903C26610B033B8734C8159B2ECA,17
14FC1A25D55E89AC7ECD600CD3A08C13,305
534D8E69233D917A9A5BC15E3953FEB8,5
7EB0099C021CF1B2C0688CB1C9D42ED0,245
192440EC48EB5C30C261D16F03D7D229,26
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1035
3DC1C89C927D2FC9D264FBC21E401E5B,28
34CAF47105A2D9D0AC7464BB3AF8DB2A,591
A064A84CD3CF7058F39333D6212E8615,21
9A46DD24A6F7AD154E9143AA2D588310,25
037DAC225F0C1E54657770CD201CDDA7,58
03948FE68D30FD7BD6B46D1993062581,33
8065F8E98407106A65D35195984B2258,115
FF20E4EE129C3700FC1C6CEF188E17BB,151
FEDC59699D8832A11B88BFCCCAD0951D,38
D7EA8E3645EFFBD6443946179ED704A6,191
7A85F2041ECC509DEDAD05C9C09125FA,678
3F4C49B7D999DB0D286AA09BED5C04A9,45
7A8D1CAA45CDE7652260DA6E71068A13,164
BF709EB51D61C3A7BF68C4CFD7F236BE,10
53866E32BA0ABFD846772D4B7B9B5921,152
Query:
-- Corrected SQL 5
SELECT DISTINCT "event_date"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    UNION ALL
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
    -- Continue including all relevant tables
) e
LIMIT 100
Answer:
event_date
20180901
20180902
Query:
SELECT "event_timestamp", TRY_TO_TIMESTAMP("event_timestamp" / 1000) AS "event_date"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
Answer:
001065 (22023): 01ba4d7f-0004-96e7-0001-11c3010c837e: SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,6) and TIMESTAMP_NTZ(6)Query:
SELECT DISTINCT t1."user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include UNION ALL statements for all other September 2018 tables up to "EVENTS_20180930"
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include UNION ALL statements for all other September 2018 tables up to "EVENTS_20180930"
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'app_exception'
  AND t2."event_name" = 'app_remove'
  AND TO_TIMESTAMP_NTZ(CAST(t1."event_timestamp" / 1e6 AS BIGINT)) < TO_TIMESTAMP_NTZ(CAST(t2."event_timestamp" / 1e6 AS BIGINT))
LIMIT 100;
Answer:
No data found for the specified query.
Query:
-- Corrected SQL 8
SELECT t1."user_pseudo_id",
       (t2."event_timestamp" - t1."event_timestamp") / (1000 * 60 * 60 * 24) AS "days_to_uninstall"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'first_open'
  AND t2."event_name" = 'app_remove'
LIMIT 100
Answer:
user_pseudo_id,days_to_uninstall
4EEE67C2E335213F6815144829801E0F,7.018705
27C0BAADCE9520F17249A8B85F6477DA,1.402153
D963E509346C0E5358ECFE56AF3BB2ED,98.481910
6D6EB70E837A5007BE550C44FF276440,161.350752
1D5A0DC978A69FF28EC9D153F32EA871,0.310845
2C15FFDEDDA69390B7A8EB5808FB7ED6,0.762859
531E7B35DE9A21A1942F057C98B4E74C,0.657130
C09F65F2853D03DE23CFD90F97429735,37.428877
14FC1A25D55E89AC7ECD600CD3A08C13,10.134318
97D9D96077AD3E8859BF5C54C873E59D,28.763600
CEBA063FD7BF190D727CC948185CCEC8,43.856146
5A66BC427F25EFFDFEDED4A07D8F9F91,-0.052477
37EFBD2BA398148336F96B4347392A8D,3.515185
E0F1ED4167D0C0B2D6DCBA85CB020F52,1.795116
177C0BEFFC69408F88D3377632F1BB60,0.963484
37034A23CAFF85394E2E349C381788A6,10.659123
1E882F0B9818614D6E47620DD31229F1,2.862836
551B893D34A2A59971B8FF185C1CD0C8,0.487905
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,17.841412
D8B77A575B5308D161F95ACF515F9772,0.714398
7AB9D5F7D122A38CA8769C9C93F3A12F,63.901481
D6803CFD38D435F0364EB47684F7CCF6,104.375127
B9D800D33FDCF7AF2157CB66910A0797,1.849075
8DEB6CB6C3E85D0032D8557C73ADD49F,0.240787
A6E8B0AC5E066F7670116136442F728F,3.942350
9E25C5FED0F3F775FBB2A5C76DD0511C,4.817292
C945C989CF380E22E1B1E4B28E26801A,0.035069
DAD134C77F7E09BC552E290534CB90E8,14.537246
66788E34B6E292DE03B1B54E797CADBF,0.903368
A5302213F1605BE400E8AA34992B18A8,4.815000
Query:
-- Corrected SQL 9
SELECT t1."user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t1
INNER JOIN
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
WHERE t1."event_name" = 'first_open'
  AND t2."event_name" = 'app_remove'
  AND (t2."event_timestamp" - t1."event_timestamp") <= (7 * 24 * 60 * 60 * 1000)
LIMIT 100
Answer:
user_pseudo_id
27C0BAADCE9520F17249A8B85F6477DA
1D5A0DC978A69FF28EC9D153F32EA871
2C15FFDEDDA69390B7A8EB5808FB7ED6
531E7B35DE9A21A1942F057C98B4E74C
5A66BC427F25EFFDFEDED4A07D8F9F91
37EFBD2BA398148336F96B4347392A8D
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
1E882F0B9818614D6E47620DD31229F1
551B893D34A2A59971B8FF185C1CD0C8
D8B77A575B5308D161F95ACF515F9772
B9D800D33FDCF7AF2157CB66910A0797
8DEB6CB6C3E85D0032D8557C73ADD49F
A6E8B0AC5E066F7670116136442F728F
9E25C5FED0F3F775FBB2A5C76DD0511C
C945C989CF380E22E1B1E4B28E26801A
66788E34B6E292DE03B1B54E797CADBF
A5302213F1605BE400E8AA34992B18A8
Query:
-- Corrected SQL 10
SELECT DISTINCT "user_pseudo_id"
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) e
WHERE "event_name" = 'first_open'
LIMIT 100
Answer:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA
Query:
-- Corrected SQL 11
SELECT e.*
FROM
(
    SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    -- Include all other September 2018 tables
) e
INNER JOIN
(
    SELECT DISTINCT "user_pseudo_id"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        -- Include all other September 2018 tables
    )
    WHERE "event_name" = 'first_open'
) first_users ON e."user_pseudo_id" = first_users."user_pseudo_id"
LIMIT 100
Answer:
Too long, hard cut:
event_date,event_timestamp,event_name,event_params,event_previous_timestamp,event_value_in_usd,event_bundle_sequence_id,event_server_timestamp_offset,user_id,user_pseudo_id,user_properties,user_first_touch_timestamp,user_ltv,device,geo,app_info,traffic_source,stream_id,platform,event_dimensions
20180901,1535854411699006,level_fail,"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 6.000000000000000e+00
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_6""
    }
  }
]",,,18,981843,,34CAF47105A2D9D0AC7464BB3AF8DB2A,"[
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1535852002219000,
      ""string_value"": ""20""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1535852185237000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1535854148158000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1535854179387000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1535852002438000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1535852034675000,
      ""set_timestamp_micros"": 1535851995675000
    }
  },
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1535852002220000,
      ""string_value"": ""2""
    }
  }
]",1535852034675000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -18000
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""organic"",
  ""source"": ""google-play""
}",1051193346,ANDROID,
20180901,1535854390699007,level_end,"[
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""level"",
    ""value"": {
      ""double_value"": 6.000000000000000e+00
    }
  },
  {
    ""key"": ""level_name"",
    ""value"": {
      ""string_value"": ""level_6""
    }
  }
]",1535854315239007.0,,18,981843,,34CAF47105A2D9D0AC7464BB3AF8DB2A,"[
  {
    ""key"": ""initial_extra_steps"",
    ""value"": {
      ""set_timestamp_micros"": 1535851981219000,
      ""string_value"": ""20""
    }
  },
  {
    ""key"": ""plays_quickplay"",
    ""value"": {
      ""set_timestamp_micros"": 1535852164237000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""num_levels_available"",
    ""value"": {
      ""set_timestamp_micros"": 1535854127158000,
      ""string_value"": ""30""
    }
  },
  {
    ""key"": ""plays_progressive"",
    ""value"": {
      ""set_timestamp_micros"": 1535854158387000,
      ""string_value"": ""true""
    }
  },
  {
    ""key"": ""firebase_exp_1"",
    ""value"": {
      ""set_timestamp_micros"": 1535851981438000,
      ""string_value"": ""1""
    }
  },
  {
    ""key"": ""first_open_time"",
    ""value"": {
      ""int_value"": 1535852034675000,
      ""set_timestamp_micros"": 1535851974675000
    }
  },
  {
    ""key"": ""ad_frequency"",
    ""value"": {
      ""set_timestamp_micros"": 1535851981220000,
      ""string_value"": ""2""
    }
  }
]",1535852034675000,,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -18000
}","{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}","{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}","{
  ""medium"": ""organic"",
  ""source"": ""google-play""
}",1051193346,ANDROID,
20180901,1535854488836006,use_extra_steps,"[
  {
    ""key"": ""item_name"",
    ""value"": {
      ""string_
End Exploring Related Columns
Task: For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Percentage_of_users_who_experienced_crash
value:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

This percentage indicates the proportion of users who first opened the app in September 2018, uninstalled it within seven days, and experienced an app crash (`app_exception`) during that period. The calculation involves converting the timestamps to dates, determining the number of days to uninstall, and identifying users who had a crash event before uninstalling..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 16:35:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:35:25 - root - INFO - ```sql
SELECT
    (COUNT(DISTINCT CASE WHEN u."experienced_crash" = 1 THEN u."user_pseudo_id" END) * 100.0) /
    COUNT(DISTINCT u."user_pseudo_id") AS "Percentage_of_users_who_experienced_crash"
FROM
(
    SELECT
        "user_pseudo_id",
        MIN(CASE WHEN "event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930' THEN "event_timestamp" END) AS "first_open_ts",
        MIN(CASE WHEN "event_name" = 'app_remove' THEN "event_timestamp" END) AS "app_remove_ts",
        MAX(CASE WHEN "event_name" = 'app_exception' THEN 1 ELSE 0 END) AS "experienced_crash"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
    ) e
    WHERE
        ("event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930')
        OR "event_name" = 'app_remove'
        OR "event_name" = 'app_exception'
    GROUP BY
        "user_pseudo_id"
) u
WHERE
    u."first_open_ts" IS NOT NULL
    AND u."app_remove_ts" IS NOT NULL
    AND DATEDIFF('day', TO_TIMESTAMP_NTZ(u."first_open_ts" / 1000000), TO_TIMESTAMP_NTZ(u."app_remove_ts" / 1000000)) <= 7;
```
2025-02-10 16:35:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:35:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:35:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:35:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:35:33 - snowflake.connector.connection - INFO - closed
2025-02-10 16:35:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:35:33 - root - INFO - itercount: 1
2025-02-10 16:35:33 - root - INFO - 0
2025-02-10 16:35:33 - root - INFO - results: 
Percentage_of_users_who_experienced_crash
2.469136


2025-02-10 16:35:33 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users_who_experienced_crash
value:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

This percentage indicates the proportion of users who first opened the app in September 2018, uninstalled it within seven days, and experienced an app crash (`app_exception`) during that period. The calculation involves converting the timestamps to dates, determining the number of days to uninstall, and identifying users who had a crash event before uninstalling. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users_who_experienced_crash
2.469136
Current sql:
SELECT
    (COUNT(DISTINCT CASE WHEN u."experienced_crash" = 1 THEN u."user_pseudo_id" END) * 100.0) /
    COUNT(DISTINCT u."user_pseudo_id") AS "Percentage_of_users_who_experienced_crash"
FROM
(
    SELECT
        "user_pseudo_id",
        MIN(CASE WHEN "event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930' THEN "event_timestamp" END) AS "first_open_ts",
        MIN(CASE WHEN "event_name" = 'app_remove' THEN "event_timestamp" END) AS "app_remove_ts",
        MAX(CASE WHEN "event_name" = 'app_exception' THEN 1 ELSE 0 END) AS "experienced_crash"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
    ) e
    WHERE
        ("event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930')
        OR "event_name" = 'app_remove'
        OR "event_name" = 'app_exception'
    GROUP BY
        "user_pseudo_id"
) u
WHERE
    u."first_open_ts" IS NOT NULL
    AND u."app_remove_ts" IS NOT NULL
    AND DATEDIFF('day', TO_TIMESTAMP_NTZ(u."first_open_ts" / 1000000), TO_TIMESTAMP_NTZ(u."app_remove_ts" / 1000000)) <= 7;
2025-02-10 16:36:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:36:02 - root - INFO - ```sql
SELECT
    (COUNT(DISTINCT CASE WHEN u."experienced_crash" = 1 THEN u."user_pseudo_id" END) * 100.0) /
    COUNT(DISTINCT u."user_pseudo_id") AS "Percentage_of_users_who_experienced_crash"
FROM
(
    SELECT
        "user_pseudo_id",
        MIN(CASE WHEN "event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930' THEN "event_timestamp" END) AS "first_open_ts",
        MIN(CASE WHEN "event_name" = 'app_remove' THEN "event_timestamp" END) AS "app_remove_ts",
        MAX(CASE WHEN "event_name" = 'app_exception' THEN 1 ELSE 0 END) AS "experienced_crash"
    FROM
    (
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929" UNION ALL
        SELECT * FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
    ) e
    WHERE
        ("event_name" = 'first_open' AND "event_date" BETWEEN '20180901' AND '20180930')
        OR "event_name" = 'app_remove'
        OR "event_name" = 'app_exception'
    GROUP BY
        "user_pseudo_id"
) u
WHERE
    u."first_open_ts" IS NOT NULL
    AND u."app_remove_ts" IS NOT NULL
    AND DATEDIFF('day', TO_TIMESTAMP_NTZ(u."first_open_ts" / 1000000), TO_TIMESTAMP_NTZ(u."app_remove_ts" / 1000000)) <= 7;
```

```csv
Percentage_of_users_who_experienced_crash
2.4691
```
2025-02-10 16:36:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:36:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:36:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:36:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:36:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:36:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:36:03 - root - INFO - itercount: 2
2025-02-10 16:36:03 - root - INFO - 0
2025-02-10 16:36:03 - root - INFO - Total iteration counts: 2
