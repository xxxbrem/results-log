2025-02-10 16:21:07 - openai._base_client - INFO - Retrying request to /chat/completions in 0.407792 seconds
2025-02-10 16:21:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:21:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:21:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:21:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:21:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:21:55 - snowflake.connector.connection - INFO - closed
2025-02-10 16:21:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:21:56 - root - INFO - SQL:
-- 1. Select user_pseudo_id and user_first_touch_timestamp from a table in September 2018
SELECT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B

2025-02-10 16:21:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:21:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:21:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:21:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-02-10 16:21:57 - snowflake.connector.connection - INFO - closed
2025-02-10 16:21:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:21:57 - root - INFO - SQL:
-- 2. Select distinct event names to see what events are present
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Results:
event_name
session_start
screen_view
level_start_quickplay
user_engagement
post_score
level_complete_quickplay
level_end_quickplay
select_content
level_fail_quickplay
level_retry_quickplay
level_up
level_complete
level_start
level_end
level_retry
level_reset_quickplay
level_fail
completed_5_levels
app_remove
app_exception
level_reset
no_more_extra_steps
os_update
error
firebase_campaign
app_update
use_extra_steps
spend_virtual_currency
ad_reward
challenge_a_friend
first_open

2025-02-10 16:21:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:21:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:21:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:21:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-02-10 16:21:59 - snowflake.connector.connection - INFO - closed
2025-02-10 16:21:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:21:59 - root - INFO - SQL:
-- 3. Select events where event_name is 'app_exception'
SELECT "event_name", "event_timestamp", "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE "event_name" = 'app_exception'
LIMIT 100;
Results:
event_name,event_timestamp,user_pseudo_id
app_exception,1535846266102003,14DE6B1CDA3BFD44679C7E9382644AC7
app_exception,1535847792339003,B2D359D114428D8DD085DFAFF11195CE
app_exception,1535790897890002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535847669757002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535863213378002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535817449773002,0A26E7281EC31038AD42F28C930FFF90
app_exception,1535835686896005,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535786745474023,D3F06F9B7BD9D7FC8758BF78BF0705E9
app_exception,1535827737994047,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535827864817008,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535832466123018,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869689760019,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869756295014,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535801517341010,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535801814369015,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535793852010011,DD7772866FB721476438D3EDCFA89E06
app_exception,1535801963145000,E594F4CE9B23146A461021258CC7ACA2
app_exception,1535833266081013,E80C958E3C33898989A30B8F5A4514F0
app_exception,1535795070725005,0289ACB4026B0C28A9FF7BF2560E2A7F
app_exception,1535820399116011,959635567E419A061EECCCA478EDC718
app_exception,1535820433900009,959635567E419A061EECCCA478EDC718
app_exception,1535820449873009,959635567E419A061EECCCA478EDC718
app_exception,1535822114482010,959635567E419A061EECCCA478EDC718
app_exception,1535813640000009,F5DAD8DD17B689CF672D65A0A81CF4AC

2025-02-10 16:21:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:21:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:21:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:00 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:00 - root - INFO - SQL:
-- 4. Select event_date and event_timestamp to compare date formats
SELECT "event_date", "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Results:
event_date,event_timestamp
20180901,1535867185623000
20180901,1535849095212001
20180901,1535849167262008
20180901,1535849154282009
20180901,1535849162943013
20180901,1535867236618001
20180901,1535849186141000
20180901,1535867221530000
20180901,1535849137266010
20180901,1535849164052005
20180901,1535849135086007
20180901,1535849135913012
20180901,1535849197632016
20180901,1535867170853001
20180901,1535826937106001
20180901,1535826950106001
20180901,1535826961795000
20180901,1535826910795000
20180901,1535826971247003
20180901,1535827320896005
20180901,1535826970247003
20180901,1535827264896005
20180901,1535821239792002
20180901,1535821383892014
20180901,1535821504763026
20180901,1535821890531040
20180901,1535821250791000
20180901,1535821402891012
20180901,1535821553762024
20180901,1535821939530038
20180901,1535821133482000
20180901,1535821133383001
20180901,1535821104130005
20180901,1535821104161006
20180901,1535821296883004
20180901,1535821226892005
20180901,1535821213161007
20180901,1535821322983016
20180901,1535821385997017
20180901,1535821375615019
20180901,1535821521848028
20180901,1535821501857029
20180901,1535821846390032
20180901,1535821943611042
20180901,1535821925620043
20180901,1535821951099046
20180901,1535821111327000
20180901,1535821116132007
20180901,1535821234792001
20180901,1535821211156008
20180901,1535821364892013
20180901,1535821341611020
20180901,1535821534763025
20180901,1535821784387033
20180901,1535821940531039
20180901,1535822022095047
20180901,1535821167995003
20180901,1535821167045004
20180901,1535821256874003
20180901,1535821278137006
20180901,1535821387973015
20180901,1535821368577018
20180901,1535821476838027
20180901,1535821540075030
20180901,1535821804316031
20180901,1535821953594041
20180901,1535821920836044
20180901,1535821978034045
20180901,1535821957063051
20180901,1535858453281002
20180901,1535858450179027
20180901,1535858549250053
20180901,1535858583326076
20180901,1535858575828103
20180901,1535858676432129
20180901,1535858667955146
20180901,1535858769237168
20180901,1535858768783180
20180901,1535858744875206
20180901,1535858850484233
20180901,1535858892209245
20180901,1535858932936270
20180901,1535858903897297
20180901,1535859040769356
20180901,1535859068813378
20180901,1535859103834393
20180901,1535859153021417
20180901,1535859203675439
20180901,1535859275236451
20180901,1535859544576037
20180901,1535859581082054
20180901,1535859551489078
20180901,1535859610298101
20180901,1535859708640147
20180901,1535859766289182
20180901,1535859835450227
20180901,1535859955311290
20180901,1535860063140323
20180901,1535860037320348
20180901,1535860174600361

2025-02-10 16:22:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:01 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:02 - root - INFO - SQL:
-- 5. Convert user_first_touch_timestamp to a readable date format
SELECT "user_pseudo_id",
       TO_TIMESTAMP("user_first_touch_timestamp" / 1000000) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,first_touch_date
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8

2025-02-10 16:22:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 68
2025-02-10 16:22:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:03 - root - INFO - SQL:
-- 6. Select users who first opened the app in September 2018
SELECT DISTINCT "user_pseudo_id",
       TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE TO_CHAR(TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)), 'YYYY-MM') = '2018-09'
LIMIT 100;
Results:
user_pseudo_id,first_touch_date
34CAF47105A2D9D0AC7464BB3AF8DB2A,2018-09-02
14FC1A25D55E89AC7ECD600CD3A08C13,2018-09-02
34ADF71F1AADCA26EC8008496F7CC87E,2018-09-01
C7DD86F06FD4AA8A0967E27E20750FCD,2018-09-01
4EEE67C2E335213F6815144829801E0F,2018-09-02
4A2A03B50BDA6AC1687703BD39A91E3E,2018-09-02
EA89F979E0D4C374DBC95268982D18DE,2018-09-01
7FA778C27A7CD840454FC893B8200200,2018-09-01
108522345C425B9AEB5F83FE07C1A3A4,2018-09-01
7331597E5500811253BA85AF851A193C,2018-09-02
CEBA063FD7BF190D727CC948185CCEC8,2018-09-01
5A66BC427F25EFFDFEDED4A07D8F9F91,2018-09-02
37034A23CAFF85394E2E349C381788A6,2018-09-01
387B532B7AF7A362DBF783E34C05BF54,2018-09-01
1E882F0B9818614D6E47620DD31229F1,2018-09-02
9F8885F0261FE69A58C8B6AE9176E437,2018-09-01
551B893D34A2A59971B8FF185C1CD0C8,2018-09-01
D771048ADB1B9CACADFE001E6F9BA799,2018-09-02
97D9D96077AD3E8859BF5C54C873E59D,2018-09-01
7AB9D5F7D122A38CA8769C9C93F3A12F,2018-09-02
D6803CFD38D435F0364EB47684F7CCF6,2018-09-01
3B049329E3090DA7A4339C4A46EF0763,2018-09-01
B9D800D33FDCF7AF2157CB66910A0797,2018-09-02
9E25C5FED0F3F775FBB2A5C76DD0511C,2018-09-01
ADB20527463A407E77162C54D30435F1,2018-09-01
DAD134C77F7E09BC552E290534CB90E8,2018-09-01
8BB6E580D7771BBBE04D3953EA43F640,2018-09-01
0CBC523581751D977C4121B95429E8A9,2018-09-02
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,2018-09-02
66788E34B6E292DE03B1B54E797CADBF,2018-09-01
2B6D9C77F287F5C021EC7297203D412B,2018-09-01
879503A3ED5F2DCB6592E99C42E1BDFE,2018-09-01
2C45FDF91F91AE8A3A9E6F119E8BED13,2018-09-01
9FD6E2CD74490F5DA5F52D249CBB750A,2018-09-01
0E9150E8985138A744B88D56F015EDA7,2018-09-01
61BB31EC7781341B1D7B8D8A85688DA3,2018-09-01
3E336ECE1F533064D663A350DAB00790,2018-09-01
CCE5E30054C510608589FA6240615B0A,2018-09-01
D31F0611DE6B94A5F001584286883AB7,2018-09-01
D963E509346C0E5358ECFE56AF3BB2ED,2018-09-01
96333A5A97DA9F4AEBC7A70483AF6C5C,2018-09-02
531E7B35DE9A21A1942F057C98B4E74C,2018-09-01
C09F65F2853D03DE23CFD90F97429735,2018-09-01
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,2018-09-02
8DEB6CB6C3E85D0032D8557C73ADD49F,2018-09-01
C945C989CF380E22E1B1E4B28E26801A,2018-09-01
6D6EB70E837A5007BE550C44FF276440,2018-09-01
F4CB0B30E0A170AEB6A94EF1156738C8,2018-09-01
37EFBD2BA398148336F96B4347392A8D,2018-09-01
A305B55D5049F38F5139DA95B3DCE247,2018-09-01
A5302213F1605BE400E8AA34992B18A8,2018-09-02
6C333017CEA199B69BB27611BA5DE7B5,2018-09-01
FCD8DDE7775A7211BCA9F42768C3BB8B,2018-09-01
ACA2E31E67D50F779611D7FDB674C370,2018-09-02
D1C57A2E87382A82A40B1816E85277EA,2018-09-01
D2007D608FBB90EF5363BF5C8E08117A,2018-09-02
1D5A0DC978A69FF28EC9D153F32EA871,2018-09-01
2C15FFDEDDA69390B7A8EB5808FB7ED6,2018-09-02
B9A395E297106E5D6F72747F84AC7AE5,2018-09-01
5DA9B900E7C9F71714FB1AE9DA631C83,2018-09-01
E0F1ED4167D0C0B2D6DCBA85CB020F52,2018-09-01
B82793CB1270A48BB2697C51AEED3E4A,2018-09-01
D8B77A575B5308D161F95ACF515F9772,2018-09-02
B0D104EE63ABB85675B078664B5924A8,2018-09-01
177C0BEFFC69408F88D3377632F1BB60,2018-09-02
B1885B70DEFAC440D7DCBB520854A651,2018-09-01
A6E8B0AC5E066F7670116136442F728F,2018-09-01
27C0BAADCE9520F17249A8B85F6477DA,2018-09-01

2025-02-10 16:22:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:04 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:04 - root - INFO - SQL:
-- 7. Find the last event timestamp for each user_pseudo_id
SELECT "user_pseudo_id",
       MAX("event_timestamp") AS "last_event_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
GROUP BY "user_pseudo_id"
LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,last_event_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1535867236618001
0AF67C1A1C8F3785609B4210C3E04FC8,1535827320896005
102CC7D8CD5D3E861EACE1BAB97E61EC,1535822022095047
A976A39B8E08829A5BC5CD3827C942A2,1535860792942634
22DF34962481295121082D8C105EB436,1535817475474001
B8FE9AD137A133A89389656F7989B36C,1535847614531048
4E6F4A73B5D05B33DC73B11547E39004,1535794785998000
6D32B47F6F516304209375F1D0CCE5A3,1535790108054001
4B6BD3964DB295D02E54E59927ED73A0,1535860239941000
B607C1DF4606F29FD7FA56A6D4DACFAC,1535837311513063
487DE902636DD8A9844A2D61FE7BD568,1535860145910011
B081E087ABDC8FE6FB390ACF48CD61D8,1535833798172024
690DA199396D35B845005CCD13ED8D67,1535846475097109
F26EC6056E284FDDEA7771F203B6BB8F,1535806394272010
4BB019F8F6D1FE7BA78CA42A4698EF56,1535813888847161
B0153FFD55333D4C4B546EC5B3FAC70E,1535833646359000
841727B396264112EC75FEB26C57E25C,1535866443366092
14DE6B1CDA3BFD44679C7E9382644AC7,1535849945969004
7E74A2BB6BBF4746DEE15F957B315401,1535870700990000
17636078D57884AD7EA5406C60E2BD10,1535811216672001
40E48F9F86A546EF73EDE7855625E2B2,1535835510215000
2F2B5C88B72A5253AAF448B1E29333F5,1535865332080138
39BE7CAB9B8602ABD10A1BFB4E66BBB2,1535812209254002
5C5A0787542CD24F1E19F9EB778BA766,1535871521019007
186F51E5AACB37852E3650E7027E33B1,1535863178192008
3A73CDE17520867FB9C03E491F778B60,1535820055622000
26FACA90F8AA62D614E65FD30CD978AB,1535853390835002
57EC50FBC6C7277B8EDCCE44C1352BD4,1535857268572616
5ACF1A6BFE350F7BB661BF389AF7E2F0,1535860443502115
F3917138A3D4B03ADA1C2E77E3B84649,1535824887820027
D2057EE2B8E8563B522E6C21B7BD4524,1535825283600004
8D0EAD73C85E48D958042757FEBB37BC,1535787587120001
C66BF8A9ACA5CD56597E18B0729181C4,1535820457018055
48AB910A8DE8485D4C34238EA61F782C,1535825268040329
571B1FB7D9D44445BF25B75F0FD91660,1535806454956028
FA30269453141794E79B8F15EE0BA5B9,1535863213378002
1AB36A765847D90D7F029C21FADFB3F4,1535825077148003
A7722F61A84758A6CAE3E2C03B9EF742,1535838276393000
AC14799A5E8C340D6CADCBAE72037D81,1535831889015323
9AAAE2A96BA29B283C25AA62182ECA9D,1535791876382000
6722ACD286AC0F5CA22E745302CAEB89,1535798517820000
93CE02A528E41C078FDB04857CCDA48C,1535837500960088
3DC1C89C927D2FC9D264FBC21E401E5B,1535814872694029
534D8E69233D917A9A5BC15E3953FEB8,1535851250048007
D407419A2E57FC81BF4C6C4334B7DB90,1535824719625009
4BDC831A6940071E2461D0B5293A329E,1535841251120054
59BE43F3FE7AB3F91B016B56508D4C46,1535806300519003
7A8D1CAA45CDE7652260DA6E71068A13,1535855914614022
53866E32BA0ABFD846772D4B7B9B5921,1535797579556244
CA04708DA02378999ECB402481FF1AE4,1535845390653054
635808C1DDFBC662DC3015097E26E62A,1535847679223055
D3F06F9B7BD9D7FC8758BF78BF0705E9,1535786756295002
6A5F60408CAFD78C48447547A30BA926,1535853780229002
5C3E52036EA54498B6E571A50A45ABFD,1535821870465001
4A2A03B50BDA6AC1687703BD39A91E3E,1535855371335016
F3C9D7235C2A60FBFBDE1F2EEFBA8B2B,1535821330442000
108522345C425B9AEB5F83FE07C1A3A4,1535820293478020
CEBA063FD7BF190D727CC948185CCEC8,1535790557551000
7AB9D5F7D122A38CA8769C9C93F3A12F,1535866168772000
BA3E7A5857FD7BE68F02E4D2F5744BE8,1535850451929067
CC62213661BE43BF92836F37DF9B3ADD,1535823469139016
879503A3ED5F2DCB6592E99C42E1BDFE,1535841762558099
F0FE3E7D8F5EF494C7D34AECB8D27951,1535852986352007
EF5251E1700D0283DDF3538BC27BB932,1535800970805037
9DB70702AD6350C1150E2AD452047208,1535841223810000
58230465C695B0FDDDAE08A481FAEECC,1535838864050007
E30E8756808AB219B28276F129C51552,1535841842740000
B2D359D114428D8DD085DFAFF11195CE,1535848403998004
E8124E2C2D99AB999ADC3CA7D481242E,1535854191124004
9DE7361ACCDEA6541AD5EA55D59B1C78,1535821685084005
706C748E6D1E0768BFEFE6362B5D3F67,1535833102433001
4D084D38156128AAA060303AA91E689D,1535834719056005
B8984A29BE4798F85EA15F483E37877E,1535847569642000
0579CD8B9F2F5C48A5F1ACECF88750A7,1535811549728005
0A26E7281EC31038AD42F28C930FFF90,1535830994642019
34CAF47105A2D9D0AC7464BB3AF8DB2A,1535855015711217
A064A84CD3CF7058F39333D6212E8615,1535787460202002
47EF903C26610B033B8734C8159B2ECA,1535860534975008
7EB0099C021CF1B2C0688CB1C9D42ED0,1535853123083091
A5BEE3FC4D5248D2B2C655F6B7C1E5A3,1535803974757003
1B959D672ABAE4A3BFB9D720D415E064,1535861629161011
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1535858047115035
34ADF71F1AADCA26EC8008496F7CC87E,1535820898103116
D5F9D9AF22EF5073E10342973D48FB2C,1535839175555034
037DAC225F0C1E54657770CD201CDDA7,1535823422678079
14FC1A25D55E89AC7ECD600CD3A08C13,1535865253938104
C679FF00E17790E7E16AB903212EE05C,1535793590492026
03948FE68D30FD7BD6B46D1993062581,1535801594601036
31E8B3EB3D9167E813FDFB812898F2F6,1535827403555003
E50F7AC0680FD87AD6CE6B6700D209A7,1535827867191003
FF20E4EE129C3700FC1C6CEF188E17BB,1535797964294021
FEDC59699D8832A11B88BFCCCAD0951D,1535810000897005
D7EA8E3645EFFBD6443946179ED704A6,1535849778822216
59454BAC415BB1F18517C6FD2C023E49,1535855832835001
3F4C49B7D999DB0D286AA09BED5C04A9,1535823495780055
BF709EB51D61C3A7BF68C4CFD7F236BE,1535856976721001
6C14B6297FCC1782508E14996A4DBB7C,1535845839621020
D99BC96AD021DD4BC255489C45083668,1535850111217005
FB88784404E4864870E5DABC75F2C70B,1535871694143021
E80C958E3C3389

2025-02-10 16:22:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:22:05 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:06 - root - INFO - SQL:
-- 8. Calculate days since first touch for each event
SELECT "user_pseudo_id",
       ("event_timestamp" - "user_first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_since_first_touch"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Results:
user_pseudo_id,days_since_first_touch
9F7B0D1BFB822F5E26E91E184E2E437C,826.185087
9F7B0D1BFB822F5E26E91E184E2E437C,825.975707
9F7B0D1BFB822F5E26E91E184E2E437C,825.976541
9F7B0D1BFB822F5E26E91E184E2E437C,825.976390
9F7B0D1BFB822F5E26E91E184E2E437C,825.976491
9F7B0D1BFB822F5E26E91E184E2E437C,826.185677
9F7B0D1BFB822F5E26E91E184E2E437C,825.976759
9F7B0D1BFB822F5E26E91E184E2E437C,826.185502
9F7B0D1BFB822F5E26E91E184E2E437C,825.976194
9F7B0D1BFB822F5E26E91E184E2E437C,825.976504
9F7B0D1BFB822F5E26E91E184E2E437C,825.976168
9F7B0D1BFB822F5E26E91E184E2E437C,825.976178
9F7B0D1BFB822F5E26E91E184E2E437C,825.976892
9F7B0D1BFB822F5E26E91E184E2E437C,826.184916
0AF67C1A1C8F3785609B4210C3E04FC8,427.704826
0AF67C1A1C8F3785609B4210C3E04FC8,427.704976
0AF67C1A1C8F3785609B4210C3E04FC8,427.705112
0AF67C1A1C8F3785609B4210C3E04FC8,427.704521
0AF67C1A1C8F3785609B4210C3E04FC8,427.705221
0AF67C1A1C8F3785609B4210C3E04FC8,427.709268
0AF67C1A1C8F3785609B4210C3E04FC8,427.705209
0AF67C1A1C8F3785609B4210C3E04FC8,427.708620
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166288
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167956
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169355
102CC7D8CD5D3E861EACE1BAB97E61EC,86.173820
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166416
102CC7D8CD5D3E861EACE1BAB97E61EC,86.168176
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169922
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174387
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165058
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165057
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164718
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164719
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166949
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166139
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165980
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167251
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167981
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167860
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169553
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169322
102CC7D8CD5D3E861EACE1BAB97E61EC,86.173309
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174435
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174226
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174521
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164802
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164857
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166231
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165957
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167736
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167467
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169702
102CC7D8CD5D3E861EACE1BAB97E61EC,86.172592
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174399
102CC7D8CD5D3E861EACE1BAB97E61EC,86.175343
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165457
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165446
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166486
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166732
102CC7D8CD5D3E861EACE1BAB97E61EC,86.168004
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167779
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169032
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169764
102CC7D8CD5D3E861EACE1BAB97E61EC,86.172822
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174550
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174171
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174833
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174590
A976A39B8E08829A5BC5CD3827C942A2,20.599425
A976A39B8E08829A5BC5CD3827C942A2,20.599389
A976A39B8E08829A5BC5CD3827C942A2,20.600536
A976A39B8E08829A5BC5CD3827C942A2,20.600930
A976A39B8E08829A5BC5CD3827C942A2,20.600843
A976A39B8E08829A5BC5CD3827C942A2,20.602008
A976A39B8E08829A5BC5CD3827C942A2,20.601910
A976A39B8E08829A5BC5CD3827C942A2,20.603082
A976A39B8E08829A5BC5CD3827C942A2,20.603077
A976A39B8E08829A5BC5CD3827C942A2,20.602800
A976A39B8E08829A5BC5CD3827C942A2,20.604022
A976A39B8E08829A5BC5CD3827C942A2,20.604505
A976A39B8E08829A5BC5CD3827C942A2,20.604977
A976A39B8E08829A5BC5CD3827C942A2,20.604641
A976A39B8E08829A5BC5CD3827C942A2,20.606225
A976A39B8E08829A5BC5CD3827C942A2,20.606549
A976A39B8E08829A5BC5CD3827C942A2,20.606955
A976A39B8E08829A5BC5CD3827C942A2,20.607524
A976A39B8E08829A5BC5CD3827C942A2,20.608110
A976A39B8E08829A5BC5CD3827C942A2,20.608938
A976A39B8E08829A5BC5CD3827C942A2,20.612056
A976A39B8E08829A5BC5CD3827C942A2,20.612478
A976A39B8E08829A5BC5CD3827C942A2,20.612136
A976A39B8E08829A5BC5CD3827C942A2,20.612816
A976A39B8E08829A5BC5CD3827C942A2,20.613955
A976A39B8E08829A5BC5CD3827C942A2,20.614622
A976A39B8E08829A5BC5CD3827C942A2,20.615422
A976A39B8E08829A5BC5CD3827C942A2,20.616810
A976A39B8E08829A5BC5CD3827C942A2,20.618058
A976A39B8E08829A5BC5CD3827C942A2,20.617759
A976A39B8E08829A5BC5CD3827C942A2,20.619348

2025-02-10 16:22:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 95
2025-02-10 16:22:07 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:07 - root - INFO - SQL:
-- 9. Select users whose last event occurred within 7 days of first touch
SELECT "user_pseudo_id",
       MAX("event_timestamp") AS "last_event_timestamp",
       MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
GROUP BY "user_pseudo_id"
HAVING (MAX("event_timestamp") - MIN("user_first_touch_timestamp")) / (1000000 * 60 * 60 * 24) <= 7
LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,last_event_timestamp,first_touch_timestamp
7E74A2BB6BBF4746DEE15F957B315401,1535870700990000,1535645962201000
571B1FB7D9D44445BF25B75F0FD91660,1535806454956028,1535723375540000
6722ACD286AC0F5CA22E745302CAEB89,1535798517820000,1535355604168000
4A2A03B50BDA6AC1687703BD39A91E3E,1535855371335016,1535855219914000
108522345C425B9AEB5F83FE07C1A3A4,1535820293478020,1535783499357000
CEBA063FD7BF190D727CC948185CCEC8,1535790557551000,1535786768380000
7AB9D5F7D122A38CA8769C9C93F3A12F,1535866168772000,1535860647684000
879503A3ED5F2DCB6592E99C42E1BDFE,1535841762558099,1535838840694000
0579CD8B9F2F5C48A5F1ACECF88750A7,1535811549728005,1535565350548000
0A26E7281EC31038AD42F28C930FFF90,1535830994642019,1535518994452000
34CAF47105A2D9D0AC7464BB3AF8DB2A,1535855015711217,1535852034675000
7EB0099C021CF1B2C0688CB1C9D42ED0,1535853123083091,1535382934226000
34ADF71F1AADCA26EC8008496F7CC87E,1535820898103116,1535778825958000
14FC1A25D55E89AC7ECD600CD3A08C13,1535865253938104,1535864378333000
5C5D78DD8E3D3B7FFC9118D4511E76BF,1535863126815025,1535502565121000
6D6EB70E837A5007BE550C44FF276440,1535814856064000,1535800915359000
7FA778C27A7CD840454FC893B8200200,1535841045757000,1535764158259000
97D9D96077AD3E8859BF5C54C873E59D,1535836329246000,1535833844071000
5A66BC427F25EFFDFEDED4A07D8F9F91,1535857973764001,1535857954726000
37EFBD2BA398148336F96B4347392A8D,1535793758299000,1535793454587000
1E882F0B9818614D6E47620DD31229F1,1535865479525008,1535865216880000
551B893D34A2A59971B8FF185C1CD0C8,1535809927628001,1535809874149000
D6803CFD38D435F0364EB47684F7CCF6,1535800726047000,1535791708036000
A305B55D5049F38F5139DA95B3DCE247,1535814853258010,1535814764621000
9E25C5FED0F3F775FBB2A5C76DD0511C,1535786121603000,1535785705389000
EA5907924EF10ECB8AE8AD017E53B0E9,1535805740806000,1535496377570000
DAD134C77F7E09BC552E290534CB90E8,1535788576457041,1535787320439000
8BB6E580D7771BBBE04D3953EA43F640,1535822617209029,1535763735607000
B1885B70DEFAC440D7DCBB520854A651,1535841047648052,1535840569836000
66788E34B6E292DE03B1B54E797CADBF,1535845809470026,1535845655446000
2B6D9C77F287F5C021EC7297203D412B,1535843216236000,1535828304758000
6C333017CEA199B69BB27611BA5DE7B5,1535844918253020,1535844742760000
6F90140F6B66544AAF9181C740122566,1535844081708014,1535483513935000
0E9150E8985138A744B88D56F015EDA7,1535836757204067,1535836565290000
ACA2E31E67D50F779611D7FDB674C370,1535852512904013,1535851880421000
3E336ECE1F533064D663A350DAB00790,1535791558588116,1535790604676000
192440EC48EB5C30C261D16F03D7D229,1535809596132000,1535628964295000
C7DD86F06FD4AA8A0967E27E20750FCD,1535837370493046,1535798021434000
DC14701AE5C2808151BE7008898B13B8,1535828720527059,1535246439342000
4EEE67C2E335213F6815144829801E0F,1535856207647080,1535855580096000
A2D0AAFA35E66B8372DDAD76450A82FF,1535824649554060,1535742880724000
F4CB0B30E0A170AEB6A94EF1156738C8,1535859229587000,1535843461289000
EA89F979E0D4C374DBC95268982D18DE,1535840230933092,1535827029854000
7331597E5500811253BA85AF851A193C,1535869790798292,1535867137394000
C576922AC96E60240D148752D36BF34C,1535802215494000,1535281297959000
177C0BEFFC69408F88D3377632F1BB60,1535851529235003,1535851408336000
37034A23CAFF85394E2E349C381788A6,1535815081763214,1535814119760000
387B532B7AF7A362DBF783E34C05BF54,1535856735398195,1535818383344000
9F8885F0261FE69A58C8B6AE9176E437,1535839963628000,1535839822373000
0FDAC2A4A154F9E946D749BFE67B1FCD,1535799162708000,1535734298629000
D771048ADB1B9CACADFE001E6F9BA799,1535868897655168,1535867549146000
CB3247B1C1CDA46A0F086191DB3FF5B2,1535871010760001,1535553261060000
B9D800D33FDCF7AF2157CB66910A0797,1535857400254040,1535857240494000
ADB20527463A407E77162C54D30435F1,1535814861615017,1535814207479000
B50E2B0888440679A84A3D861332531C,1535868287632124,1535756158807000
0CBC523581751D977C4121B95429E8A9,1535858433720003,1535858125431000
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,1535862620797007,1535862392716000
A5302213F1605BE400E8AA34992B18A8,1535862983195028,1535862567179000
9FD6E2CD74490F5DA5F52D249CBB750A,1535807496939001,1535800510069000
FCD8DDE7775A7211BCA9F42768C3BB8B,1535832918174228,1535810901162000
B6A174B1E55B3CB60DA1B9DBE341AECF,1535836942765006,1535421457737000
27C88E1533471126F779ADE591D7915D,1535815496829181,1535596400784000
1B7FF293CEB974A6F4E4788D705FF314,1535799440268022,1535637478341000
D1C57A2E87382A82A40B1816E85277EA,1535867606092557,1535821909295000
3B049329E3090DA7A4339C4A46EF0763,1535855253888029,1535820720601000
2C45FDF91F91AE8A3A9E6F119E8BED13,1535815491764024,1535815094027000
61BB31EC7781341B1D7B8D8A85688DA3,1535847366632007,1535834527505000
D8B8615DDE319FEBE0A2AC1364E2C2EC,1535800751155008,1535747732463000
CCE5E30054C510608589FA6240615B0A,1535846530052021,1535844174073000
F3C82C9DB04064BA7965BBBD95864189,1535820445774045,1535690140909000
DFDE5425237185986327A054407A09B4,1535809644372004,1535503293314000
D2007D608FBB90EF5363BF5C8E08117A,1535858976843009,1535858897335000
D31F0611DE6B94A5F001584286883AB7,1535844548020014,1535843573111000
0DCD6B00CAB93941AA5EB18DE8C053EE,1535807602430000,1

2025-02-10 16:22:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:22:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:22:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:22:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 14
2025-02-10 16:22:08 - snowflake.connector.connection - INFO - closed
2025-02-10 16:22:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:22:09 - root - INFO - SQL:
-- 10. Select users who experienced an 'app_exception' event
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE "event_name" = 'app_exception'
LIMIT 100;
Results:
user_pseudo_id
14DE6B1CDA3BFD44679C7E9382644AC7
B2D359D114428D8DD085DFAFF11195CE
FA30269453141794E79B8F15EE0BA5B9
0A26E7281EC31038AD42F28C930FFF90
DDDF330206C8FD63B6C78C3BFB13F801
D3F06F9B7BD9D7FC8758BF78BF0705E9
B5F3D00E28A57C9522F2DEE3CB903DD1
E1A3C786B2E4D56629EE808A3A174995
DD7772866FB721476438D3EDCFA89E06
E594F4CE9B23146A461021258CC7ACA2
E80C958E3C33898989A30B8F5A4514F0
0289ACB4026B0C28A9FF7BF2560E2A7F
959635567E419A061EECCCA478EDC718
F5DAD8DD17B689CF672D65A0A81CF4AC

2025-02-10 16:22:09 - root - INFO - itercount: 0
2025-02-10 16:22:09 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}
Begin Exploring Related Columns
Firstly, here are the relevant columns and their potential usage:

- **"user_pseudo_id"**: Used to uniquely identify users.
- **"user_first_touch_timestamp"**: Timestamp of when the user first opened the app; used to determine if they first opened the app in September 2018.
- **"event_timestamp"**: Timestamp of events; used to calculate days to uninstall and to identify events within seven days.
- **"event_name"**: Used to identify if an event is an 'app_exception' (app crash).
- **"event_date"**: Date of the event; useful for filtering events in September 2018.
- **"event_params"**: Nested JSON column; could contain additional details about events.
- **"event_previous_timestamp"**: May be used to determine the previous event's timestamp.
- **Tables ("EVENTS_YYYYMMDD")**: Each table represents events for a specific date; need to query multiple tables to cover all of September 2018.

**Conditions that may be used:**

- Users who first opened the app in September 2018.
- Users who uninstalled the app within seven days of first opening it.
- Users who experienced an 'app_exception' event.
- Calculations involving converting timestamps to dates.
- Calculating the number of days between events.

Here are 10 Snowflake SQL queries to understand the values in related columns:

---

```sql
-- 1. Select user_pseudo_id and user_first_touch_timestamp from a table in September 2018
SELECT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
```

```sql
-- 2. Select distinct event names to see what events are present
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
```

```sql
-- 3. Select events where event_name is 'app_exception'
SELECT "event_name", "event_timestamp", "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE "event_name" = 'app_exception'
LIMIT 100;
```

```sql
-- 4. Select event_date and event_timestamp to compare date formats
SELECT "event_date", "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
```

```sql
-- 5. Convert user_first_touch_timestamp to a readable date format
SELECT "user_pseudo_id",
       TO_TIMESTAMP("user_first_touch_timestamp" / 1000000) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
```

```sql
-- 6. Select users who first opened the app in September 2018
SELECT DISTINCT "user_pseudo_id",
       TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE TO_CHAR(TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)), 'YYYY-MM') = '2018-09'
LIMIT 100;
```

```sql
-- 7. Find the last event timestamp for each user_pseudo_id
SELECT "user_pseudo_id",
       MAX("event_timestamp") AS "last_event_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
GROUP BY "user_pseudo_id"
LIMIT 100;
```

```sql
-- 8. Calculate days since first touch for each event
SELECT "user_pseudo_id",
       ("event_timestamp" - "user_first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_since_first_touch"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
```

```sql
-- 9. Select users whose last event occurred within 7 days of first touch
SELECT "user_pseudo_id",
       MAX("event_timestamp") AS "last_event_timestamp",
       MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
GROUP BY "user_pseudo_id"
HAVING (MAX("event_timestamp") - MIN("user_first_touch_timestamp")) / (1000000 * 60 * 60 * 24) <= 7
LIMIT 100;
```

```sql
-- 10. Select users who experienced an 'app_exception' event
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE "event_name" = 'app_exception'
LIMIT 100;
```

---

These queries help explore the relevant data and understand how to extract information necessary for the task.Query:
-- 1. Select user_pseudo_id and user_first_touch_timestamp from a table in September 2018
SELECT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B
Query:
-- 2. Select distinct event names to see what events are present
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Answer:
event_name
session_start
screen_view
level_start_quickplay
user_engagement
post_score
level_complete_quickplay
level_end_quickplay
select_content
level_fail_quickplay
level_retry_quickplay
level_up
level_complete
level_start
level_end
level_retry
level_reset_quickplay
level_fail
completed_5_levels
app_remove
app_exception
level_reset
no_more_extra_steps
os_update
error
firebase_campaign
app_update
use_extra_steps
spend_virtual_currency
ad_reward
challenge_a_friend
first_open
Query:
-- 3. Select events where event_name is 'app_exception'
SELECT "event_name", "event_timestamp", "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE "event_name" = 'app_exception'
LIMIT 100;
Answer:
event_name,event_timestamp,user_pseudo_id
app_exception,1535846266102003,14DE6B1CDA3BFD44679C7E9382644AC7
app_exception,1535847792339003,B2D359D114428D8DD085DFAFF11195CE
app_exception,1535790897890002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535847669757002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535863213378002,FA30269453141794E79B8F15EE0BA5B9
app_exception,1535817449773002,0A26E7281EC31038AD42F28C930FFF90
app_exception,1535835686896005,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535786745474023,D3F06F9B7BD9D7FC8758BF78BF0705E9
app_exception,1535827737994047,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535827864817008,B5F3D00E28A57C9522F2DEE3CB903DD1
app_exception,1535832466123018,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869689760019,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535869756295014,E1A3C786B2E4D56629EE808A3A174995
app_exception,1535801517341010,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535801814369015,DDDF330206C8FD63B6C78C3BFB13F801
app_exception,1535793852010011,DD7772866FB721476438D3EDCFA89E06
app_exception,1535801963145000,E594F4CE9B23146A461021258CC7ACA2
app_exception,1535833266081013,E80C958E3C33898989A30B8F5A4514F0
app_exception,1535795070725005,0289ACB4026B0C28A9FF7BF2560E2A7F
app_exception,1535820399116011,959635567E419A061EECCCA478EDC718
app_exception,1535820433900009,959635567E419A061EECCCA478EDC718
app_exception,1535820449873009,959635567E419A061EECCCA478EDC718
app_exception,1535822114482010,959635567E419A061EECCCA478EDC718
app_exception,1535813640000009,F5DAD8DD17B689CF672D65A0A81CF4AC
Query:
-- 4. Select event_date and event_timestamp to compare date formats
SELECT "event_date", "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Answer:
event_date,event_timestamp
20180901,1535867185623000
20180901,1535849095212001
20180901,1535849167262008
20180901,1535849154282009
20180901,1535849162943013
20180901,1535867236618001
20180901,1535849186141000
20180901,1535867221530000
20180901,1535849137266010
20180901,1535849164052005
20180901,1535849135086007
20180901,1535849135913012
20180901,1535849197632016
20180901,1535867170853001
20180901,1535826937106001
20180901,1535826950106001
20180901,1535826961795000
20180901,1535826910795000
20180901,1535826971247003
20180901,1535827320896005
20180901,1535826970247003
20180901,1535827264896005
20180901,1535821239792002
20180901,1535821383892014
20180901,1535821504763026
20180901,1535821890531040
20180901,1535821250791000
20180901,1535821402891012
20180901,1535821553762024
20180901,1535821939530038
20180901,1535821133482000
20180901,1535821133383001
20180901,1535821104130005
20180901,1535821104161006
20180901,1535821296883004
20180901,1535821226892005
20180901,1535821213161007
20180901,1535821322983016
20180901,1535821385997017
20180901,1535821375615019
20180901,1535821521848028
20180901,1535821501857029
20180901,1535821846390032
20180901,1535821943611042
20180901,1535821925620043
20180901,1535821951099046
20180901,1535821111327000
20180901,1535821116132007
20180901,1535821234792001
20180901,1535821211156008
20180901,1535821364892013
20180901,1535821341611020
20180901,1535821534763025
20180901,1535821784387033
20180901,1535821940531039
20180901,1535822022095047
20180901,1535821167995003
20180901,1535821167045004
20180901,1535821256874003
20180901,1535821278137006
20180901,1535821387973015
20180901,1535821368577018
20180901,1535821476838027
20180901,1535821540075030
20180901,1535821804316031
20180901,1535821953594041
20180901,1535821920836044
20180901,1535821978034045
20180901,1535821957063051
20180901,1535858453281002
20180901,1535858450179027
20180901,1535858549250053
20180901,1535858583326076
20180901,1535858575828103
20180901,1535858676432129
20180901,1535858667955146
20180901,1535858769237168
20180901,1535858768783180
20180901,1535858744875206
20180901,1535858850484233
20180901,1535858892209245
20180901,1535858932936270
20180901,1535858903897297
20180901,1535859040769356
20180901,1535859068813378
20180901,1535859103834393
20180901,1535859153021417
20180901,1535859203675439
20180901,1535859275236451
20180901,1535859544576037
20180901,1535859581082054
20180901,1535859551489078
20180901,1535859610298101
20180901,1535859708640147
20180901,1535859766289182
20180901,1535859835450227
20180901,1535859955311290
20180901,1535860063140323
20180901,1535860037320348
20180901,1535860174600361
Query:
-- 5. Convert user_first_touch_timestamp to a readable date format
SELECT "user_pseudo_id",
       TO_TIMESTAMP("user_first_touch_timestamp" / 1000000) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,first_touch_date
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
9F7B0D1BFB822F5E26E91E184E2E437C,2016-05-29 01:19:54.147
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-06-07 13:01:12.469
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8E08829A5BC5CD3827C942A2,2018-08-12 12:57:42.954
A976A39B8
Query:
-- 6. Select users who first opened the app in September 2018
SELECT DISTINCT "user_pseudo_id",
       TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE TO_CHAR(TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)), 'YYYY-MM') = '2018-09'
LIMIT 100;
Answer:
user_pseudo_id,first_touch_date
34CAF47105A2D9D0AC7464BB3AF8DB2A,2018-09-02
14FC1A25D55E89AC7ECD600CD3A08C13,2018-09-02
34ADF71F1AADCA26EC8008496F7CC87E,2018-09-01
C7DD86F06FD4AA8A0967E27E20750FCD,2018-09-01
4EEE67C2E335213F6815144829801E0F,2018-09-02
4A2A03B50BDA6AC1687703BD39A91E3E,2018-09-02
EA89F979E0D4C374DBC95268982D18DE,2018-09-01
7FA778C27A7CD840454FC893B8200200,2018-09-01
108522345C425B9AEB5F83FE07C1A3A4,2018-09-01
7331597E5500811253BA85AF851A193C,2018-09-02
CEBA063FD7BF190D727CC948185CCEC8,2018-09-01
5A66BC427F25EFFDFEDED4A07D8F9F91,2018-09-02
37034A23CAFF85394E2E349C381788A6,2018-09-01
387B532B7AF7A362DBF783E34C05BF54,2018-09-01
1E882F0B9818614D6E47620DD31229F1,2018-09-02
9F8885F0261FE69A58C8B6AE9176E437,2018-09-01
551B893D34A2A59971B8FF185C1CD0C8,2018-09-01
D771048ADB1B9CACADFE001E6F9BA799,2018-09-02
97D9D96077AD3E8859BF5C54C873E59D,2018-09-01
7AB9D5F7D122A38CA8769C9C93F3A12F,2018-09-02
D6803CFD38D435F0364EB47684F7CCF6,2018-09-01
3B049329E3090DA7A4339C4A46EF0763,2018-09-01
B9D800D33FDCF7AF2157CB66910A0797,2018-09-02
9E25C5FED0F3F775FBB2A5C76DD0511C,2018-09-01
ADB20527463A407E77162C54D30435F1,2018-09-01
DAD134C77F7E09BC552E290534CB90E8,2018-09-01
8BB6E580D7771BBBE04D3953EA43F640,2018-09-01
0CBC523581751D977C4121B95429E8A9,2018-09-02
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,2018-09-02
66788E34B6E292DE03B1B54E797CADBF,2018-09-01
2B6D9C77F287F5C021EC7297203D412B,2018-09-01
879503A3ED5F2DCB6592E99C42E1BDFE,2018-09-01
2C45FDF91F91AE8A3A9E6F119E8BED13,2018-09-01
9FD6E2CD74490F5DA5F52D249CBB750A,2018-09-01
0E9150E8985138A744B88D56F015EDA7,2018-09-01
61BB31EC7781341B1D7B8D8A85688DA3,2018-09-01
3E336ECE1F533064D663A350DAB00790,2018-09-01
CCE5E30054C510608589FA6240615B0A,2018-09-01
D31F0611DE6B94A5F001584286883AB7,2018-09-01
D963E509346C0E5358ECFE56AF3BB2ED,2018-09-01
96333A5A97DA9F4AEBC7A70483AF6C5C,2018-09-02
531E7B35DE9A21A1942F057C98B4E74C,2018-09-01
C09F65F2853D03DE23CFD90F97429735,2018-09-01
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,2018-09-02
8DEB6CB6C3E85D0032D8557C73ADD49F,2018-09-01
C945C989CF380E22E1B1E4B28E26801A,2018-09-01
6D6EB70E837A5007BE550C44FF276440,2018-09-01
F4CB0B30E0A170AEB6A94EF1156738C8,2018-09-01
37EFBD2BA398148336F96B4347392A8D,2018-09-01
A305B55D5049F38F5139DA95B3DCE247,2018-09-01
A5302213F1605BE400E8AA34992B18A8,2018-09-02
6C333017CEA199B69BB27611BA5DE7B5,2018-09-01
FCD8DDE7775A7211BCA9F42768C3BB8B,2018-09-01
ACA2E31E67D50F779611D7FDB674C370,2018-09-02
D1C57A2E87382A82A40B1816E85277EA,2018-09-01
D2007D608FBB90EF5363BF5C8E08117A,2018-09-02
1D5A0DC978A69FF28EC9D153F32EA871,2018-09-01
2C15FFDEDDA69390B7A8EB5808FB7ED6,2018-09-02
B9A395E297106E5D6F72747F84AC7AE5,2018-09-01
5DA9B900E7C9F71714FB1AE9DA631C83,2018-09-01
E0F1ED4167D0C0B2D6DCBA85CB020F52,2018-09-01
B82793CB1270A48BB2697C51AEED3E4A,2018-09-01
D8B77A575B5308D161F95ACF515F9772,2018-09-02
B0D104EE63ABB85675B078664B5924A8,2018-09-01
177C0BEFFC69408F88D3377632F1BB60,2018-09-02
B1885B70DEFAC440D7DCBB520854A651,2018-09-01
A6E8B0AC5E066F7670116136442F728F,2018-09-01
27C0BAADCE9520F17249A8B85F6477DA,2018-09-01
Query:
-- 7. Find the last event timestamp for each user_pseudo_id
SELECT "user_pseudo_id",
       MAX("event_timestamp") AS "last_event_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
GROUP BY "user_pseudo_id"
LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,last_event_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1535867236618001
0AF67C1A1C8F3785609B4210C3E04FC8,1535827320896005
102CC7D8CD5D3E861EACE1BAB97E61EC,1535822022095047
A976A39B8E08829A5BC5CD3827C942A2,1535860792942634
22DF34962481295121082D8C105EB436,1535817475474001
B8FE9AD137A133A89389656F7989B36C,1535847614531048
4E6F4A73B5D05B33DC73B11547E39004,1535794785998000
6D32B47F6F516304209375F1D0CCE5A3,1535790108054001
4B6BD3964DB295D02E54E59927ED73A0,1535860239941000
B607C1DF4606F29FD7FA56A6D4DACFAC,1535837311513063
487DE902636DD8A9844A2D61FE7BD568,1535860145910011
B081E087ABDC8FE6FB390ACF48CD61D8,1535833798172024
690DA199396D35B845005CCD13ED8D67,1535846475097109
F26EC6056E284FDDEA7771F203B6BB8F,1535806394272010
4BB019F8F6D1FE7BA78CA42A4698EF56,1535813888847161
B0153FFD55333D4C4B546EC5B3FAC70E,1535833646359000
841727B396264112EC75FEB26C57E25C,1535866443366092
14DE6B1CDA3BFD44679C7E9382644AC7,1535849945969004
7E74A2BB6BBF4746DEE15F957B315401,1535870700990000
17636078D57884AD7EA5406C60E2BD10,1535811216672001
40E48F9F86A546EF73EDE7855625E2B2,1535835510215000
2F2B5C88B72A5253AAF448B1E29333F5,1535865332080138
39BE7CAB9B8602ABD10A1BFB4E66BBB2,1535812209254002
5C5A0787542CD24F1E19F9EB778BA766,1535871521019007
186F51E5AACB37852E3650E7027E33B1,1535863178192008
3A73CDE17520867FB9C03E491F778B60,1535820055622000
26FACA90F8AA62D614E65FD30CD978AB,1535853390835002
57EC50FBC6C7277B8EDCCE44C1352BD4,1535857268572616
5ACF1A6BFE350F7BB661BF389AF7E2F0,1535860443502115
F3917138A3D4B03ADA1C2E77E3B84649,1535824887820027
D2057EE2B8E8563B522E6C21B7BD4524,1535825283600004
8D0EAD73C85E48D958042757FEBB37BC,1535787587120001
C66BF8A9ACA5CD56597E18B0729181C4,1535820457018055
48AB910A8DE8485D4C34238EA61F782C,1535825268040329
571B1FB7D9D44445BF25B75F0FD91660,1535806454956028
FA30269453141794E79B8F15EE0BA5B9,1535863213378002
1AB36A765847D90D7F029C21FADFB3F4,1535825077148003
A7722F61A84758A6CAE3E2C03B9EF742,1535838276393000
AC14799A5E8C340D6CADCBAE72037D81,1535831889015323
9AAAE2A96BA29B283C25AA62182ECA9D,1535791876382000
6722ACD286AC0F5CA22E745302CAEB89,1535798517820000
93CE02A528E41C078FDB04857CCDA48C,1535837500960088
3DC1C89C927D2FC9D264FBC21E401E5B,1535814872694029
534D8E69233D917A9A5BC15E3953FEB8,1535851250048007
D407419A2E57FC81BF4C6C4334B7DB90,1535824719625009
4BDC831A6940071E2461D0B5293A329E,1535841251120054
59BE43F3FE7AB3F91B016B56508D4C46,1535806300519003
7A8D1CAA45CDE7652260DA6E71068A13,1535855914614022
53866E32BA0ABFD846772D4B7B9B5921,1535797579556244
CA04708DA02378999ECB402481FF1AE4,1535845390653054
635808C1DDFBC662DC3015097E26E62A,1535847679223055
D3F06F9B7BD9D7FC8758BF78BF0705E9,1535786756295002
6A5F60408CAFD78C48447547A30BA926,1535853780229002
5C3E52036EA54498B6E571A50A45ABFD,1535821870465001
4A2A03B50BDA6AC1687703BD39A91E3E,1535855371335016
F3C9D7235C2A60FBFBDE1F2EEFBA8B2B,1535821330442000
108522345C425B9AEB5F83FE07C1A3A4,1535820293478020
CEBA063FD7BF190D727CC948185CCEC8,1535790557551000
7AB9D5F7D122A38CA8769C9C93F3A12F,1535866168772000
BA3E7A5857FD7BE68F02E4D2F5744BE8,1535850451929067
CC62213661BE43BF92836F37DF9B3ADD,1535823469139016
879503A3ED5F2DCB6592E99C42E1BDFE,1535841762558099
F0FE3E7D8F5EF494C7D34AECB8D27951,1535852986352007
EF5251E1700D0283DDF3538BC27BB932,1535800970805037
9DB70702AD6350C1150E2AD452047208,1535841223810000
58230465C695B0FDDDAE08A481FAEECC,1535838864050007
E30E8756808AB219B28276F129C51552,1535841842740000
B2D359D114428D8DD085DFAFF11195CE,1535848403998004
E8124E2C2D99AB999ADC3CA7D481242E,1535854191124004
9DE7361ACCDEA6541AD5EA55D59B1C78,1535821685084005
706C748E6D1E0768BFEFE6362B5D3F67,1535833102433001
4D084D38156128AAA060303AA91E689D,1535834719056005
B8984A29BE4798F85EA15F483E37877E,1535847569642000
0579CD8B9F2F5C48A5F1ACECF88750A7,1535811549728005
0A26E7281EC31038AD42F28C930FFF90,1535830994642019
34CAF47105A2D9D0AC7464BB3AF8DB2A,1535855015711217
A064A84CD3CF7058F39333D6212E8615,1535787460202002
47EF903C26610B033B8734C8159B2ECA,1535860534975008
7EB0099C021CF1B2C0688CB1C9D42ED0,1535853123083091
A5BEE3FC4D5248D2B2C655F6B7C1E5A3,1535803974757003
1B959D672ABAE4A3BFB9D720D415E064,1535861629161011
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1535858047115035
34ADF71F1AADCA26EC8008496F7CC87E,1535820898103116
D5F9D9AF22EF5073E10342973D48FB2C,1535839175555034
037DAC225F0C1E54657770CD201CDDA7,1535823422678079
14FC1A25D55E89AC7ECD600CD3A08C13,1535865253938104
C679FF00E17790E7E16AB903212EE05C,1535793590492026
03948FE68D30FD7BD6B46D1993062581,1535801594601036
31E8B3EB3D9167E813FDFB812898F2F6,1535827403555003
E50F7AC0680FD87AD6CE6B6700D209A7,1535827867191003
FF20E4EE129C3700FC1C6CEF188E17BB,1535797964294021
FEDC59699D8832A11B88BFCCCAD0951D,1535810000897005
D7EA8E3645EFFBD6443946179ED704A6,1535849778822216
59454BAC415BB1F18517C6FD2C023E49,1535855832835001
3F4C49B7D999DB0D286AA09BED5C04A9,1535823495780055
BF709EB51D61C3A7BF68C4CFD7F236BE,1535856976721001
6C14B6297FCC1782508E14996A4DBB7C,1535845839621020
D99BC96AD021DD4BC255489C45083668,1535850111217005
FB88784404E4864870E5DABC75F2C70B,1535871694143021
E80C958E3C3389
Query:
-- 8. Calculate days since first touch for each event
SELECT "user_pseudo_id",
       ("event_timestamp" - "user_first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_since_first_touch"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
LIMIT 100;
Answer:
user_pseudo_id,days_since_first_touch
9F7B0D1BFB822F5E26E91E184E2E437C,826.185087
9F7B0D1BFB822F5E26E91E184E2E437C,825.975707
9F7B0D1BFB822F5E26E91E184E2E437C,825.976541
9F7B0D1BFB822F5E26E91E184E2E437C,825.976390
9F7B0D1BFB822F5E26E91E184E2E437C,825.976491
9F7B0D1BFB822F5E26E91E184E2E437C,826.185677
9F7B0D1BFB822F5E26E91E184E2E437C,825.976759
9F7B0D1BFB822F5E26E91E184E2E437C,826.185502
9F7B0D1BFB822F5E26E91E184E2E437C,825.976194
9F7B0D1BFB822F5E26E91E184E2E437C,825.976504
9F7B0D1BFB822F5E26E91E184E2E437C,825.976168
9F7B0D1BFB822F5E26E91E184E2E437C,825.976178
9F7B0D1BFB822F5E26E91E184E2E437C,825.976892
9F7B0D1BFB822F5E26E91E184E2E437C,826.184916
0AF67C1A1C8F3785609B4210C3E04FC8,427.704826
0AF67C1A1C8F3785609B4210C3E04FC8,427.704976
0AF67C1A1C8F3785609B4210C3E04FC8,427.705112
0AF67C1A1C8F3785609B4210C3E04FC8,427.704521
0AF67C1A1C8F3785609B4210C3E04FC8,427.705221
0AF67C1A1C8F3785609B4210C3E04FC8,427.709268
0AF67C1A1C8F3785609B4210C3E04FC8,427.705209
0AF67C1A1C8F3785609B4210C3E04FC8,427.708620
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166288
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167956
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169355
102CC7D8CD5D3E861EACE1BAB97E61EC,86.173820
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166416
102CC7D8CD5D3E861EACE1BAB97E61EC,86.168176
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169922
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174387
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165058
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165057
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164718
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164719
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166949
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166139
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165980
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167251
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167981
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167860
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169553
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169322
102CC7D8CD5D3E861EACE1BAB97E61EC,86.173309
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174435
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174226
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174521
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164802
102CC7D8CD5D3E861EACE1BAB97E61EC,86.164857
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166231
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165957
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167736
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167467
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169702
102CC7D8CD5D3E861EACE1BAB97E61EC,86.172592
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174399
102CC7D8CD5D3E861EACE1BAB97E61EC,86.175343
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165457
102CC7D8CD5D3E861EACE1BAB97E61EC,86.165446
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166486
102CC7D8CD5D3E861EACE1BAB97E61EC,86.166732
102CC7D8CD5D3E861EACE1BAB97E61EC,86.168004
102CC7D8CD5D3E861EACE1BAB97E61EC,86.167779
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169032
102CC7D8CD5D3E861EACE1BAB97E61EC,86.169764
102CC7D8CD5D3E861EACE1BAB97E61EC,86.172822
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174550
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174171
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174833
102CC7D8CD5D3E861EACE1BAB97E61EC,86.174590
A976A39B8E08829A5BC5CD3827C942A2,20.599425
A976A39B8E08829A5BC5CD3827C942A2,20.599389
A976A39B8E08829A5BC5CD3827C942A2,20.600536
A976A39B8E08829A5BC5CD3827C942A2,20.600930
A976A39B8E08829A5BC5CD3827C942A2,20.600843
A976A39B8E08829A5BC5CD3827C942A2,20.602008
A976A39B8E08829A5BC5CD3827C942A2,20.601910
A976A39B8E08829A5BC5CD3827C942A2,20.603082
A976A39B8E08829A5BC5CD3827C942A2,20.603077
A976A39B8E08829A5BC5CD3827C942A2,20.602800
A976A39B8E08829A5BC5CD3827C942A2,20.604022
A976A39B8E08829A5BC5CD3827C942A2,20.604505
A976A39B8E08829A5BC5CD3827C942A2,20.604977
A976A39B8E08829A5BC5CD3827C942A2,20.604641
A976A39B8E08829A5BC5CD3827C942A2,20.606225
A976A39B8E08829A5BC5CD3827C942A2,20.606549
A976A39B8E08829A5BC5CD3827C942A2,20.606955
A976A39B8E08829A5BC5CD3827C942A2,20.607524
A976A39B8E08829A5BC5CD3827C942A2,20.608110
A976A39B8E08829A5BC5CD3827C942A2,20.608938
A976A39B8E08829A5BC5CD3827C942A2,20.612056
A976A39B8E08829A5BC5CD3827C942A2,20.612478
A976A39B8E08829A5BC5CD3827C942A2,20.612136
A976A39B8E08829A5BC5CD3827C942A2,20.612816
A976A39B8E08829A5BC5CD3827C942A2,20.613955
A976A39B8E08829A5BC5CD3827C942A2,20.614622
A976A39B8E08829A5BC5CD3827C942A2,20.615422
A976A39B8E08829A5BC5CD3827C942A2,20.616810
A976A39B8E08829A5BC5CD3827C942A2,20.618058
A976A39B8E08829A5BC5CD3827C942A2,20.617759
A976A39B8E08829A5BC5CD3827C942A2,20.619348
Query:
-- 9. Select users whose last event occurred within 7 days of first touch
SELECT "user_pseudo_id",
       MAX("event_timestamp") AS "last_event_timestamp",
       MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
GROUP BY "user_pseudo_id"
HAVING (MAX("event_timestamp") - MIN("user_first_touch_timestamp")) / (1000000 * 60 * 60 * 24) <= 7
LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,last_event_timestamp,first_touch_timestamp
7E74A2BB6BBF4746DEE15F957B315401,1535870700990000,1535645962201000
571B1FB7D9D44445BF25B75F0FD91660,1535806454956028,1535723375540000
6722ACD286AC0F5CA22E745302CAEB89,1535798517820000,1535355604168000
4A2A03B50BDA6AC1687703BD39A91E3E,1535855371335016,1535855219914000
108522345C425B9AEB5F83FE07C1A3A4,1535820293478020,1535783499357000
CEBA063FD7BF190D727CC948185CCEC8,1535790557551000,1535786768380000
7AB9D5F7D122A38CA8769C9C93F3A12F,1535866168772000,1535860647684000
879503A3ED5F2DCB6592E99C42E1BDFE,1535841762558099,1535838840694000
0579CD8B9F2F5C48A5F1ACECF88750A7,1535811549728005,1535565350548000
0A26E7281EC31038AD42F28C930FFF90,1535830994642019,1535518994452000
34CAF47105A2D9D0AC7464BB3AF8DB2A,1535855015711217,1535852034675000
7EB0099C021CF1B2C0688CB1C9D42ED0,1535853123083091,1535382934226000
34ADF71F1AADCA26EC8008496F7CC87E,1535820898103116,1535778825958000
14FC1A25D55E89AC7ECD600CD3A08C13,1535865253938104,1535864378333000
5C5D78DD8E3D3B7FFC9118D4511E76BF,1535863126815025,1535502565121000
6D6EB70E837A5007BE550C44FF276440,1535814856064000,1535800915359000
7FA778C27A7CD840454FC893B8200200,1535841045757000,1535764158259000
97D9D96077AD3E8859BF5C54C873E59D,1535836329246000,1535833844071000
5A66BC427F25EFFDFEDED4A07D8F9F91,1535857973764001,1535857954726000
37EFBD2BA398148336F96B4347392A8D,1535793758299000,1535793454587000
1E882F0B9818614D6E47620DD31229F1,1535865479525008,1535865216880000
551B893D34A2A59971B8FF185C1CD0C8,1535809927628001,1535809874149000
D6803CFD38D435F0364EB47684F7CCF6,1535800726047000,1535791708036000
A305B55D5049F38F5139DA95B3DCE247,1535814853258010,1535814764621000
9E25C5FED0F3F775FBB2A5C76DD0511C,1535786121603000,1535785705389000
EA5907924EF10ECB8AE8AD017E53B0E9,1535805740806000,1535496377570000
DAD134C77F7E09BC552E290534CB90E8,1535788576457041,1535787320439000
8BB6E580D7771BBBE04D3953EA43F640,1535822617209029,1535763735607000
B1885B70DEFAC440D7DCBB520854A651,1535841047648052,1535840569836000
66788E34B6E292DE03B1B54E797CADBF,1535845809470026,1535845655446000
2B6D9C77F287F5C021EC7297203D412B,1535843216236000,1535828304758000
6C333017CEA199B69BB27611BA5DE7B5,1535844918253020,1535844742760000
6F90140F6B66544AAF9181C740122566,1535844081708014,1535483513935000
0E9150E8985138A744B88D56F015EDA7,1535836757204067,1535836565290000
ACA2E31E67D50F779611D7FDB674C370,1535852512904013,1535851880421000
3E336ECE1F533064D663A350DAB00790,1535791558588116,1535790604676000
192440EC48EB5C30C261D16F03D7D229,1535809596132000,1535628964295000
C7DD86F06FD4AA8A0967E27E20750FCD,1535837370493046,1535798021434000
DC14701AE5C2808151BE7008898B13B8,1535828720527059,1535246439342000
4EEE67C2E335213F6815144829801E0F,1535856207647080,1535855580096000
A2D0AAFA35E66B8372DDAD76450A82FF,1535824649554060,1535742880724000
F4CB0B30E0A170AEB6A94EF1156738C8,1535859229587000,1535843461289000
EA89F979E0D4C374DBC95268982D18DE,1535840230933092,1535827029854000
7331597E5500811253BA85AF851A193C,1535869790798292,1535867137394000
C576922AC96E60240D148752D36BF34C,1535802215494000,1535281297959000
177C0BEFFC69408F88D3377632F1BB60,1535851529235003,1535851408336000
37034A23CAFF85394E2E349C381788A6,1535815081763214,1535814119760000
387B532B7AF7A362DBF783E34C05BF54,1535856735398195,1535818383344000
9F8885F0261FE69A58C8B6AE9176E437,1535839963628000,1535839822373000
0FDAC2A4A154F9E946D749BFE67B1FCD,1535799162708000,1535734298629000
D771048ADB1B9CACADFE001E6F9BA799,1535868897655168,1535867549146000
CB3247B1C1CDA46A0F086191DB3FF5B2,1535871010760001,1535553261060000
B9D800D33FDCF7AF2157CB66910A0797,1535857400254040,1535857240494000
ADB20527463A407E77162C54D30435F1,1535814861615017,1535814207479000
B50E2B0888440679A84A3D861332531C,1535868287632124,1535756158807000
0CBC523581751D977C4121B95429E8A9,1535858433720003,1535858125431000
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,1535862620797007,1535862392716000
A5302213F1605BE400E8AA34992B18A8,1535862983195028,1535862567179000
9FD6E2CD74490F5DA5F52D249CBB750A,1535807496939001,1535800510069000
FCD8DDE7775A7211BCA9F42768C3BB8B,1535832918174228,1535810901162000
B6A174B1E55B3CB60DA1B9DBE341AECF,1535836942765006,1535421457737000
27C88E1533471126F779ADE591D7915D,1535815496829181,1535596400784000
1B7FF293CEB974A6F4E4788D705FF314,1535799440268022,1535637478341000
D1C57A2E87382A82A40B1816E85277EA,1535867606092557,1535821909295000
3B049329E3090DA7A4339C4A46EF0763,1535855253888029,1535820720601000
2C45FDF91F91AE8A3A9E6F119E8BED13,1535815491764024,1535815094027000
61BB31EC7781341B1D7B8D8A85688DA3,1535847366632007,1535834527505000
D8B8615DDE319FEBE0A2AC1364E2C2EC,1535800751155008,1535747732463000
CCE5E30054C510608589FA6240615B0A,1535846530052021,1535844174073000
F3C82C9DB04064BA7965BBBD95864189,1535820445774045,1535690140909000
DFDE5425237185986327A054407A09B4,1535809644372004,1535503293314000
D2007D608FBB90EF5363BF5C8E08117A,1535858976843009,1535858897335000
D31F0611DE6B94A5F001584286883AB7,1535844548020014,1535843573111000
0DCD6B00CAB93941AA5EB18DE8C053EE,1535807602430000,1
Query:
-- 10. Select users who experienced an 'app_exception' event
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
WHERE "event_name" = 'app_exception'
LIMIT 100;
Answer:
user_pseudo_id
14DE6B1CDA3BFD44679C7E9382644AC7
B2D359D114428D8DD085DFAFF11195CE
FA30269453141794E79B8F15EE0BA5B9
0A26E7281EC31038AD42F28C930FFF90
DDDF330206C8FD63B6C78C3BFB13F801
D3F06F9B7BD9D7FC8758BF78BF0705E9
B5F3D00E28A57C9522F2DEE3CB903DD1
E1A3C786B2E4D56629EE808A3A174995
DD7772866FB721476438D3EDCFA89E06
E594F4CE9B23146A461021258CC7ACA2
E80C958E3C33898989A30B8F5A4514F0
0289ACB4026B0C28A9FF7BF2560E2A7F
959635567E419A061EECCCA478EDC718
F5DAD8DD17B689CF672D65A0A81CF4AC
End Exploring Related Columns
Task: For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Percentage_of_users_who_experienced_crash
value:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

This percentage indicates the proportion of users who first opened the app in September 2018, uninstalled it within seven days, and experienced an app crash (`app_exception`) during that period. The calculation involves converting the timestamps to dates, determining the number of days to uninstall, and identifying users who had a crash event before uninstalling..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 16:23:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:23:58 - root - INFO - ```sql
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "uninstall_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_timestamp",
        ue."uninstall_timestamp",
        ("ue"."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE ("ue"."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "exception_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_timestamp" BETWEEN u."first_touch_timestamp" AND u."uninstall_timestamp"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
```
2025-02-10 16:23:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:23:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:23:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:24:00 - snowflake.connector.connection - INFO - closed
2025-02-10 16:24:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:24:00 - root - INFO - itercount: 1
2025-02-10 16:24:00 - root - INFO - 000904 (42000): 01ba4d77-0004-96e7-0001-11c3010c8312: SQL compilation error: error line 80 at position 9
invalid identifier '"ue"."uninstall_timestamp"'
2025-02-10 16:24:00 - root - INFO - Input sql:
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "uninstall_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_timestamp",
        ue."uninstall_timestamp",
        ("ue"."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE ("ue"."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "exception_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_timestamp" BETWEEN u."first_touch_timestamp" AND u."uninstall_timestamp"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
The error information is:
000904 (42000): 01ba4d77-0004-96e7-0001-11c3010c8312: SQL compilation error: error line 80 at position 9
invalid identifier '"ue"."uninstall_timestamp"'
Please correct it and output only 1 complete SQL query.
2025-02-10 16:25:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:25:24 - root - INFO - ```sql
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "uninstall_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_timestamp",
        ue."uninstall_timestamp",
        (ue."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE (ue."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "exception_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_timestamp" BETWEEN u."first_touch_timestamp" AND u."uninstall_timestamp"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
```
2025-02-10 16:25:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:25:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:25:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:25:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:25:42 - snowflake.connector.connection - INFO - closed
2025-02-10 16:25:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:25:42 - root - INFO - itercount: 2
2025-02-10 16:25:42 - root - INFO - 0
2025-02-10 16:25:42 - root - INFO - results: 
Percentage_of_users_who_experienced_crash
2.3188


2025-02-10 16:25:42 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users_who_experienced_crash
value:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

This percentage indicates the proportion of users who first opened the app in September 2018, uninstalled it within seven days, and experienced an app crash (`app_exception`) during that period. The calculation involves converting the timestamps to dates, determining the number of days to uninstall, and identifying users who had a crash event before uninstalling. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users_who_experienced_crash
2.3188
Current sql:
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "uninstall_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_timestamp",
        ue."uninstall_timestamp",
        (ue."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE (ue."uninstall_timestamp" - u."first_touch_timestamp") / (1000000 * 60 * 60 * 24) <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        MIN("event_timestamp") AS "exception_timestamp"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_timestamp" BETWEEN u."first_touch_timestamp" AND u."uninstall_timestamp"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
2025-02-10 16:26:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:26:22 - root - INFO - ```sql
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("user_first_touch_timestamp") / 1000000)) AS "first_touch_date"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("event_timestamp") / 1000000)) AS "uninstall_date"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_date",
        ue."uninstall_date",
        DATEDIFF('day', u."first_touch_date", ue."uninstall_date") AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE DATEDIFF('day', u."first_touch_date", ue."uninstall_date") <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("event_timestamp") / 1000000)) AS "exception_date"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_date" BETWEEN u."first_touch_date" AND u."uninstall_date"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
```
2025-02-10 16:26:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:26:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:26:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:26:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:26:29 - snowflake.connector.connection - INFO - closed
2025-02-10 16:26:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:26:30 - root - INFO - itercount: 3
2025-02-10 16:26:30 - root - INFO - 0
2025-02-10 16:26:30 - root - INFO - results: 
Percentage_of_users_who_experienced_crash
2.8818


2025-02-10 16:26:30 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users_who_experienced_crash
value:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

This percentage indicates the proportion of users who first opened the app in September 2018, uninstalled it within seven days, and experienced an app crash (`app_exception`) during that period. The calculation involves converting the timestamps to dates, determining the number of days to uninstall, and identifying users who had a crash event before uninstalling. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users_who_experienced_crash
2.8818
Current sql:
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("user_first_touch_timestamp") / 1000000)) AS "first_touch_date"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("event_timestamp") / 1000000)) AS "uninstall_date"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_date",
        ue."uninstall_date",
        DATEDIFF('day', u."first_touch_date", ue."uninstall_date") AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE DATEDIFF('day', u."first_touch_date", ue."uninstall_date") <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("event_timestamp") / 1000000)) AS "exception_date"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_date" BETWEEN u."first_touch_date" AND u."uninstall_date"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
2025-02-10 16:27:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:27:14 - root - INFO - ```sql
WITH all_events AS (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
),
first_open_users AS (
    SELECT DISTINCT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("user_first_touch_timestamp") / 1000000)) AS "first_touch_date"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP("user_first_touch_timestamp" / 1000000)) BETWEEN '2018-09-01' AND '2018-09-30'
    GROUP BY "user_pseudo_id"
),
uninstall_events AS (
    SELECT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("event_timestamp") / 1000000)) AS "uninstall_date"
    FROM all_events
    WHERE "event_name" = 'app_remove'
    GROUP BY "user_pseudo_id"
),
uninstall_users AS (
    SELECT u."user_pseudo_id",
        u."first_touch_date",
        ue."uninstall_date",
        DATEDIFF('day', u."first_touch_date", ue."uninstall_date") AS "days_to_uninstall"
    FROM first_open_users u
    JOIN uninstall_events ue ON u."user_pseudo_id" = ue."user_pseudo_id"
    WHERE DATEDIFF('day', u."first_touch_date", ue."uninstall_date") <= 7
),
exception_events AS (
    SELECT "user_pseudo_id",
        TO_DATE(TO_TIMESTAMP(MIN("event_timestamp") / 1000000)) AS "exception_date"
    FROM all_events
    WHERE "event_name" = 'app_exception'
    GROUP BY "user_pseudo_id"
),
exception_uninstall_users AS (
    SELECT u."user_pseudo_id"
    FROM uninstall_users u
    JOIN exception_events e ON u."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."exception_date" BETWEEN u."first_touch_date" AND u."uninstall_date"
)
SELECT ROUND(
    (
        (SELECT COUNT(DISTINCT "user_pseudo_id") FROM exception_uninstall_users)::FLOAT /
        NULLIF((SELECT COUNT(DISTINCT "user_pseudo_id") FROM uninstall_users), 0)
    ) * 100, 4
) AS "Percentage_of_users_who_experienced_crash";
```
2025-02-10 16:27:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:27:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:27:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:27:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:27:19 - snowflake.connector.connection - INFO - closed
2025-02-10 16:27:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:27:20 - root - INFO - itercount: 4
2025-02-10 16:27:20 - root - INFO - 0
2025-02-10 16:27:20 - root - INFO - Total iteration counts: 4
