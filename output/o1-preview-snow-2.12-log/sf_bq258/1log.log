2025-02-12 06:47:40 - openai._base_client - INFO - Retrying request to /chat/completions in 0.428145 seconds
2025-02-12 06:48:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:48:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:48:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:48:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:48:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 06:48:37 - snowflake.connector.connection - INFO - closed
2025-02-12 06:48:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:48:37 - root - INFO - SQL:
SELECT *
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE "status" = 'Complete'
   LIMIT 100;
Results:
Too long, hard cut:
order_id,user_id,status,gender,created_at,returned_at,shipped_at,delivered_at,num_of_item
2,3,Complete,F,1720203480000000,,1720303560000000,1720556040000000,1
15,17,Complete,F,1726771320000000,,1726969680000000,1727318580000000,1
17,18,Complete,F,1724156580000000,,1724334840000000,1724540460000000,1
32,35,Complete,F,1705130340000000,,1705298820000000,1705415880000000,2
44,52,Complete,F,1593392280000000,,1593538980000000,1593826680000000,1
53,57,Complete,F,1719043560000000,,1719091860000000,1719505560000000,1
54,57,Complete,F,1708416360000000,,1708419240000000,1708661280000000,2
72,72,Complete,F,1675307400000000,,1675348260000000,1675523400000000,3
77,77,Complete,F,1729042920000000,,1729205460000000,1729580220000000,1
106,100,Complete,F,1636387140000000,,1636396620000000,1636727040000000,1
107,100,Complete,F,1719244740000000,,1719387000000000,1719731280000000,2
108,101,Complete,F,1728881220000000,,1728907080000000,1729223580000000,1
111,104,Complete,F,1719151020000000,,1719222360000000,1719339000000000,2
128,117,Complete,F,1675837740000000,,1675951260000000,1676327640000000,1
151,133,Complete,F,1623901860000000,,1624078740000000,1624374600000000,1
159,145,Complete,F,1729176088031265,,1729423408031265,1729557268031265,2
175,155,Complete,F,1673232900000000,,1673355600000000,1673648160000000,1
180,160,Complete,F,1685610480000000,,1685624520000000,1685821440000000,1
190,168,Complete,F,1670464980000000,,1670716560000000,1671118200000000,1
195,172,Complete,F,1674700140000000,,1674704820000000,1674912300000000,1
203,178,Complete,F,1715519220000000,,1715664840000000,1716068820000000,1
207,183,Complete,F,1683690420000000,,1683919860000000,1683937020000000,1
216,189,Complete,F,1653207600000000,,1653338640000000,1653477300000000,2
220,192,Complete,F,1686701400000000,,1686853680000000,1687159980000000,1
255,218,Complete,F,1689989340000000,,1690236720000000,1690525320000000,1
258,220,Complete,F,1704883920000000,,1704955740000000,1705099980000000,3
283,239,Complete,F,1603616280000000,,1603618200000000,1603822800000000,1
289,243,Complete,F,1624628040000000,,1624670880000000,1624713300000000,4
297,253,Complete,F,1662471120000000,,1662705900000000,1662838140000000,1
301,258,Complete,F,1614214860000000,,1614231540000000,1614356820000000,1
302,260,Complete,F,1715364180000000,,1715480160000000,1715497500000000,1
311,269,Complete,F,1701960900000000,,1702208820000000,1702331880000000,1
342,289,Complete,F,1725637560000000,,1725746400000000,1725755160000000,1
361,308,Complete,F,1634051040000000,,1634275140000000,1634677020000000,1
371,317,Complete,F,1692024540000000,,1692148320000000,1692505140000000,3
376,321,Complete,F,1620235920000000,,1620487740000000,1620727380000000,1
396,340,Complete,F,1665501900000000,,1665598860000000,1665884700000000,1
404,347,Complete,F,1646927160000000,,1647133260000000,1647417780000000,1
412,354,Complete,F,1633573200000000,,1633806180000000,1634036460000000,1
416,359,Complete,F,1729323515837874,,1729324595837874,1729739015837874,1
426,366,Complete,F,1726595160000000,,1726643940000000,1726675260000000,1
427,368,Complete,F,1712073060000000,,1712250420000000,1712313960000000,1
432,370,Complete,F,1695655500000000,,1695691440000000,1695900060000000,1
434,372,Complete,F,1707457980000000,,1707570240000000,1707586560000000,1
436,372,Complete,F,1631944380000000,,1632067560000000,1632195600000000,2
444,377,Complete,F,1631156040000000,,1631252400000000,1631393160000000,1
456,389,Complete,F,1720088160000000,,1720107780000000,1720245840000000,2
461,394,Complete,F,1728393600000000,,1728632400000000,1728965820000000,1
462,395,Complete,F,1659720720000000,,1659864240000000,1660023780000000,1
474,404,Complete,F,1665544320000000,,1665629700000000,1666030380000000,1
475,404,Complete,F,1655089920000000,,1655327520000000,1655684940000000,1
479,409,Complete,F,1698649800000000,,1698883680000000,1699285440000000,3
480,409,Complete,F,1695625800000000,,1695855840000000,1696261080000000,4
487,413,Complete,F,1727535480000000,,1727762040000000,1728082560000000,1
490,415,Complete,F,1697355480000000,,1697581440000000,1697926740000000,1
492,415,Complete,F,1705390680000000,,1705514940000000,1705624680000000,4
499,423,Complete,F,1695176340000000,,1695421440000000,1695818580000000,1
504,427,Complete,F,1687426740000000,,1687581240000000,1687878600000000,2
509,430,Complete,F,1720866840000000,,1720899420000000,1721113320000000,1
516,435,Complete,F,1714672260000000,,1714776600000000,1714820100000000,1
529,441,Complete,F,1707479520000000,,1707624420000000,1707914520000000,1
531,444,Complete,F,1727765700000000,,1728019260000000,1728236400000000,1
533,447,Complete,F,1685177460000000,,1685310120000000,1685565660000000,1
540,452,Complete,F,1726013640000000,,1726185600000000,1726583880000000,1
541,453,Complete,F,1728972600000000,,1729033440000000,1729289400000000,1
542,453,Complete,F,1698387000000000,,1698522960000000,1698788520000000,1
545,455,Complete,F,1672474200000000,,1672703220000000,1672789560000000,1
554,462,Complete,F,1688019120000000,,16

2025-02-12 06:48:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:48:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:48:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:48:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-02-12 06:48:38 - snowflake.connector.connection - INFO - closed
2025-02-12 06:48:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:48:38 - root - INFO - SQL:
SELECT DISTINCT "category"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS"
   LIMIT 100;
Results:
category
Accessories
Plus
Swim
Active
Socks & Hosiery
Socks
Dresses
Pants & Capris
Fashion Hoodies & Sweatshirts
Skirts
Blazers & Jackets
Suits
Tops & Tees
Sweaters
Jeans
Sleep & Lounge
Suits & Sport Coats
Pants
Intimates
Outerwear & Coats
Maternity
Jumpsuits & Rompers
Clothing Sets
Underwear
Shorts
Leggings

2025-02-12 06:48:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:48:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:48:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:48:39 - snowflake.connector.connection - INFO - closed
2025-02-12 06:48:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:49:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:49:17 - root - INFO - The error you're encountering is due to the use of the `UNIX_TIMESTAMP` function, which is not available in Snowflake SQL. Instead, Snowflake provides different functions to handle timestamp conversions.

In your dataset, the `delivered_at` column is of type `NUMBER(38,0)`, and it appears to store timestamps as nanoseconds since the UNIX epoch (January 1, 1970). This is inferred from the large numeric values in the `delivered_at` column, such as `1720556040000000`.

To fix the error and correctly filter orders delivered before the year 2022, you can convert the numeric nanosecond timestamp to a date using `TO_TIMESTAMP_NTZ`, and then compare it with the date `'2022-01-01'`.

Here's how you can adjust your query:

```sql
SELECT "order_id", "delivered_at"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at") < TIMESTAMP_NTZ '2022-01-01'
LIMIT 100;
```

**Explanation:**

- **TO_TIMESTAMP_NTZ("delivered_at")**: This function converts the numeric nanosecond timestamp into a `TIMESTAMP_NTZ` (timestamp without timezone) data type that Snowflake can understand.
  
- **TIMESTAMP_NTZ '2022-01-01'**: This specifies the date `'2022-01-01'` as a timestamp without timezone, ensuring both sides of the comparison are of the same data type.
  
By converting `delivered_at` to a timestamp, you can directly compare it with the date `'2022-01-01'`.

**Additional Notes:**

- If your timestamps are in nanoseconds, `TO_TIMESTAMP_NTZ` will handle the conversion correctly.
- If they are in microseconds or milliseconds, you might need to adjust the scale. For example, if the timestamps are in microseconds, you would divide by `1e6` to convert to seconds:

  ```sql
  SELECT "order_id", "delivered_at"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
  WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e6) < TIMESTAMP_NTZ '2022-01-01'
  LIMIT 100;
  ```

- However, based on the sample data, converting directly with `TO_TIMESTAMP_NTZ` should suffice.

**Testing the Conversion:**

To verify the conversion, you can run a query to view the original `delivered_at` values alongside their converted timestamps:

```sql
SELECT "order_id",
       "delivered_at",
       TO_TIMESTAMP_NTZ("delivered_at") AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
LIMIT 10;
```

This will allow you to see if the dates make sense (e.g., they correspond to realistic delivery dates prior to 2022).

**Updated Query with Conversions:**

Now, to proceed with your task and ensure all timestamps are handled correctly, you can adjust the earlier queries accordingly.

For example, recalculating the third query:

**Original Query with Error:**

```sql
SELECT "order_id", "delivered_at"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" < UNIX_TIMESTAMP('2022-01-01')
LIMIT 100;
```

**Corrected Query:**

```sql
SELECT "order_id", "delivered_at"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at") < TIMESTAMP_NTZ '2022-01-01'
LIMIT 100;
```

**Proceeding with Further Queries:**

When joining tables and performing further calculations, ensure that any comparisons or manipulations involving timestamps use the `TO_TIMESTAMP_NTZ` function for consistency.

---

**Here's the corrected version of Query 9 from earlier, adjusted to handle the timestamp conversion:**

```sql
SELECT "order_id",
       TO_TIMESTAMP_NTZ("delivered_at") AS "delivered_date",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at")) AS "month",
       EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at")) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at") < TIMESTAMP_NTZ '2022-01-01'
LIMIT 100;
```

---

**In summary**, the key adjustments are:

- Replace `UNIX_TIMESTAMP` with appropriate timestamp conversion functions provided by Snowflake.
- Use `TO_TIMESTAMP_NTZ` to convert numeric timestamps to proper timestamp data types.
- Ensure that all date comparisons are performed between compatible data types.

By making these changes, you should be able to run your queries without errors and proceed with generating the monthly report as per your task.
2025-02-12 06:49:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:49:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:49:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:49:18 - snowflake.connector.connection - INFO - closed
2025-02-12 06:49:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:50:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:50:02 - root - INFO - The error you're encountering is due to the use of the `UNIX_TIMESTAMP` function with an argument, which is not supported in Snowflake SQL. In Snowflake, `UNIX_TIMESTAMP()` returns the current Unix timestamp and does not accept any arguments. Attempting to pass `'2022-01-01'` as an argument results in a syntax error.

Additionally, your `delivered_at` column is a numeric value representing timestamps, but we need to understand the unit (seconds, milliseconds, microseconds, or nanoseconds) to correctly convert and compare it with a standard date.

**Here's how you can resolve the issue:**

1. **Determine the Time Unit of `delivered_at`:**

   Based on your sample data:

   ```
   delivered_at
   1720556040000000
   1727318580000000
   1724540460000000
   ```

   These are very large numbers, suggesting that `delivered_at` is stored in **microseconds** or **nanoseconds** since the Unix epoch (January 1, 1970).

   Let's test both possibilities to see which one yields correct dates.

2. **Convert `delivered_at` to Readable Timestamps:**

   - **If in Microseconds (divide by 1e6):**

     ```sql
     SELECT "order_id",
            "delivered_at",
            TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_timestamp"
     FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
     LIMIT 10;
     ```

   - **If in Nanoseconds (divide by 1e9):**

     ```sql
     SELECT "order_id",
            "delivered_at",
            TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "delivered_timestamp"
     FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
     LIMIT 10;
     ```

   Run these queries and observe the `delivered_timestamp` results to see which conversion gives you realistic dates.

3. **Identify the Correct Conversion Factor:**

   - **Microseconds Conversion Example:**

     If dividing by `1e6` yields dates like `2024-08-23`, then the timestamps are likely in microseconds.

   - **Nanoseconds Conversion Example:**

     If dividing by `1e9` yields dates like `2022-01-15`, then the timestamps are likely in nanoseconds.

4. **Adjust Your Query to Compare Dates:**

   Assuming we've determined that `delivered_at` is in **nanoseconds**, we can proceed as follows.

   **Corrected Query:**

   ```sql
   SELECT "order_id", "delivered_at"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e9) < TIMESTAMP_NTZ '2022-01-01'
   LIMIT 100;
   ```

   **Explanation:**

   - `TO_TIMESTAMP_NTZ("delivered_at" / 1e9)`: Converts the nanosecond timestamp to a standard timestamp in Snowflake.
   - `TIMESTAMP_NTZ '2022-01-01'`: Represents the date January 1, 2022, without time zone.
   - `<`: Compares the converted delivery timestamp to ensure it's before 2022.

5. **Verify the Results:**

   Run the corrected query and check if the results make sense—i.e., the `delivered_timestamp` values are dates before 2022.

6. **Update Your Other Queries Accordingly:**

   Now that we've addressed the timestamp conversion, you can adjust your previous and future queries to include this conversion wherever necessary.

   **Example of Adjusted Query 9:**

   ```sql
   SELECT "order_id",
          TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "delivered_date",
          EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e9)) AS "month",
          EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e9)) AS "year"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e9) < TIMESTAMP_NTZ '2022-01-01'
   LIMIT 100;
   ```

7. **Adjusting the Original Task Query:**

   When generating your monthly report, ensure all timestamps are converted appropriately.

   **Example:**

   ```sql
   SELECT
     EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e9)) AS "Year",
     EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e9)) AS "Month",
     p."category" AS "Category",
     SUM(oi."sale_price") AS "Total_Revenue",
     COUNT(DISTINCT o."order_id") AS "Total_Completed_Orders"
     -- Additional calculations for MoM growth, Total Cost, Total Profit, etc.
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
     ON oi."order_id" = o."order_id"
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   WHERE o."status" = 'Complete'
     AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e9) < TIMESTAMP_NTZ '2022-01-01'
   GROUP BY "Year", "Month", "Category"
   ORDER BY "Year", "Month", "Category"
   LIMIT 100;
   ```

8. **Handling Timestamps in Other Conditions:**

   Apply the same conversion for any other timestamp comparisons or calculations involving `created_at`, `shipped_at`, etc.

**Summary:**

- **Issue:** The `UNIX_TIMESTAMP` function in Snowflake does not accept arguments, leading to a syntax error.
- **Solution:** Use `TO_TIMESTAMP_NTZ` to convert numeric timestamps and compare them with standard dates.
- **Conversion Factor:** Determine whether your timestamps are in microseconds or nanoseconds by testing with division by `1e6` or `1e9`.

**Final Notes:**

- Always ensure that both sides of your date comparisons are of compatible data types—preferably both as timestamps.
- By properly converting and comparing timestamps, you can confidently filter and manipulate your data as required.
- Adjust all your queries to include the correct timestamp conversions to avoid similar errors in the future.

---

If you need further assistance with adjusting other queries or have additional questions, feel free to ask!
2025-02-12 06:50:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:50:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:50:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:50:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-02-12 06:50:03 - snowflake.connector.connection - INFO - closed
2025-02-12 06:50:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:51:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:51:36 - root - INFO - SQL:
SELECT "order_id",
            "delivered_at",
            TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_timestamp"
     FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
     LIMIT 10;
Results:
order_id,delivered_at,delivered_timestamp
28,,
45,,
73,,
88,,
98,,
136,,
165,,
167,,
176,,
177,,

2025-02-12 06:51:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:51:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:51:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:51:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 06:51:37 - snowflake.connector.connection - INFO - closed
2025-02-12 06:51:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:51:37 - root - INFO - SQL:
SELECT oi."sale_price"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
     ON oi."order_id" = o."order_id"
   WHERE o."status" = 'Complete'
   LIMIT 100;
Results:
sale_price
0.0199999995529651
0.0199999995529651
0.0199999995529651
1.5
1.5099999904632568
1.75
1.75
1.75
1.8200000524520876
1.8200000524520876
1.8200000524520876
1.8200000524520876
1.950000047683716
1.950000047683716
1.950000047683716
1.9800000190734863
1.9800000190734863
2.5
2.5899999141693115
2.6700000762939453
2.6700000762939453
2.6700000762939453
2.6700000762939453
2.7799999713897705
2.7799999713897705
2.7799999713897705
2.7799999713897705
2.7799999713897705
2.799999952316284
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
3.0
3.0
3.0
3.0899999141693115
3.1099998950958248
3.1700000762939453
3.1700000762939453
3.1700000762939453
3.1700000762939453
3.1700000762939453
3.25
3.289999961853028
3.369999885559082
3.369999885559082
3.390000104904175
3.390000104904175
3.390000104904175
3.400000095367432
3.400000095367432
3.4600000381469727
3.4800000190734863
3.5
3.5
3.5
3.5
3.5
3.5
3.5
3.5
3.5999999046325684
3.5999999046325684
3.5999999046325684
3.5999999046325684
3.670000076293945
3.75
3.75
3.75
3.799999952316284
3.799999952316284
3.799999952316284
3.880000114440918
3.900000095367432
3.950000047683716
3.950000047683716
3.950000047683716
3.950000047683716

2025-02-12 06:51:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:51:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:51:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:51:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 06:51:38 - snowflake.connector.connection - INFO - closed
2025-02-12 06:51:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:51:39 - root - INFO - SQL:
SELECT "id", "category", "cost"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS"
   LIMIT 100;
Results:
id,category,cost
13842,Accessories,2.518749990849756
13928,Accessories,2.3383499148894105
14115,Accessories,4.879559879379869
14157,Accessories,4.648769887297898
14273,Accessories,6.507929886473045
15674,Plus,3.1062499998370185
15816,Plus,3.1772999091416594
28646,Accessories,8.73562987972319
28670,Accessories,2.6759399153566363
28714,Accessories,2.275000000372529
28779,Accessories,7.36748991528362
28904,Accessories,6.7957498848550015
29007,Accessories,10.795999868229032
12777,Swim,16.691290760814255
12810,Swim,21.055320884742144
12812,Swim,21.14530090284795
12853,Swim,18.71584077014294
12900,Swim,17.39565078823306
13247,Swim,20.65041088706643
13477,Swim,22.600890809484422
13574,Swim,19.39069080118597
2848,Active,20.946700439925493
3039,Active,22.627350425997378
9041,Socks & Hosiery,20.479500227209176
13122,Swim,68.73737201425911
18147,Active,17.069900398133232
18363,Active,65.0955812367481
18394,Active,22.97700039561093
18465,Active,27.240000218153
18593,Active,17.00110065520704
18607,Active,30.63616928671479
18644,Active,41.28767906982421
18664,Active,25.83845043245256
18708,Active,42.59726061337233
18796,Active,36.31391910439163
24644,Socks,27.872100528435407
24674,Socks,35.64000008627772
24731,Socks,25.58795095982142
27569,Swim,92.6525625942932
3206,Dresses,38.31499995291233
3660,Dresses,21.91964971384816
3682,Dresses,18.956299259465936
3730,Dresses,39.070999938994646
3943,Dresses,26.28080032457113
5353,Pants & Capris,22.46999996714294
5433,Pants & Capris,11.640959460911304
9035,Socks & Hosiery,1.3983000106409191
14170,Accessories,1.1859000150532462
28411,Accessories,2.083760045012236
28548,Accessories,1.280300021749735
28873,Accessories,1.3904000092506408
29033,Accessories,1.7182500154450535
25038,Socks,7.600199877980351
17159,Fashion Hoodies & Sweatshirts,28.429830918571056
5357,Pants & Capris,15.4504798515518
5440,Pants & Capris,13.46318990700826
5474,Pants & Capris,13.89443986939028
7234,Skirts,9.19631984055072
7236,Skirts,11.383619829264582
7246,Skirts,9.452059872821495
7377,Skirts,10.1959198788739
7448,Skirts,9.171329883230927
7903,Blazers & Jackets,10.567589980136454
8080,Suits,37.113601108783485
8089,Suits,49.165528608800166
8093,Suits,14.139569917708933
8101,Suits,8.50591988700248
8103,Suits,38.11730891824752
8107,Suits,36.057561151015165
8109,Suits,37.754101099950816
8110,Suits,9.701289908803105
8139,Suits,59.51379877566248
8145,Suits,44.83409886984303
8148,Suits,42.90603882040273
8155,Suits,42.87359867274165
8158,Suits,15.12617992565751
8160,Suits,15.697959905421325
8162,Suits,9.820219895048735
8185,Suits,10.261959890300371
8188,Suits,35.49766125103474
8189,Suits,19.204350993917885
8191,Suits,43.697928826136206
8194,Suits,16.139789889234155
8195,Suits,39.658078809719605
8197,Suits,16.191769897296577
8199,Suits,17.165639852822423
8208,Suits,16.21775990132779
8209,Suits,9.837209897604733
70,Tops & Tees,56.92499983403832
791,Sweaters,44.6489999309415
2060,Fashion Hoodies & Sweatshirts,6.033999998122454
1935,Fashion Hoodies & Sweatshirts,59.90400007367134
1972,Fashion Hoodies & Sweatshirts,36.876000098884106
2349,Fashion Hoodies & Sweatshirts,38.47200004756451
6529,Shorts,31.960000045597557
12746,Swim,27.84000009298325
12750,Swim,34.93951924982994
12757,Swim,22.781000450715425
12762,Swim,20.816100375162065
12768,Swim,21.74639948249459

2025-02-12 06:51:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:51:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:51:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:51:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 06:51:40 - snowflake.connector.connection - INFO - closed
2025-02-12 06:51:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:51:40 - root - INFO - SQL:
SELECT "product_id", "sale_price"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS"
   LIMIT 100;
Results:
product_id,sale_price
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14202,1.5
14202,1.5
14202,1.5
14202,1.5
14202,1.5
14202,1.5
28700,1.5
28700,1.5
28700,1.5
14202,1.5
28700,1.5
14202,1.5
14202,1.5
14202,1.5
28700,1.5
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
14298,1.7200000286102295
14298,1.7200000286102295
12536,1.75
12536,1.75
12536,1.75
12536,1.75
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
13659,1.8200000524520876
13659,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
13659,1.8200000524520876
13659,1.8200000524520876
15332,1.8200000524520876
13659,1.8200000524520876
15332,1.8200000524520876
9204,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
9204,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
13690,2.6700000762939453
13690,2.6700000762939453
15395,2.6700000762939453
13690,2.6700000762939453

2025-02-12 06:51:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:51:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:51:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:51:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 06:51:41 - snowflake.connector.connection - INFO - closed
2025-02-12 06:51:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:51:42 - root - INFO - SQL:
SELECT oi."sale_price", p."category"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   LIMIT 100;
Results:
sale_price,category
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.7200000286102295,Accessories
1.7200000286102295,Accessories
1.75,Intimates
1.75,Intimates
1.75,Intimates
1.75,Intimates
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Accessories
1.8200000524520876,Accessories
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Accessories
1.8200000524520876,Accessories
1.8200000524520876,Plus
1.8200000524520876,Accessories
1.8200000524520876,Plus
1.950000047683716,Socks & Hosiery
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Socks & Hosiery
1.950000047683716,Active
1.950000047683716,Active
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.6700000762939453,Accessories
2.6700000762939453,Accessories
2.6700000762939453,Plus
2.6700000762939453,Accessories

2025-02-12 06:51:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:51:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:51:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:51:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-02-12 06:51:43 - snowflake.connector.connection - INFO - closed
2025-02-12 06:51:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:51:43 - root - INFO - SQL:
SELECT p."category", SUM(oi."sale_price") AS "total_revenue"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category"
   LIMIT 100;
Results:
category,total_revenue
Accessories,426937.3099739477
Intimates,443541.7106554508
Socks & Hosiery,62033.70993947983
Socks,126569.1599957943
Sleep & Lounge,548868.940983057
Tops & Tees,497956.07168388367
Active,441559.9801414013
Maternity,262485.38956069946
Leggings,87022.33988285065
Shorts,515053.82150888443
Swim,649922.6206922531
Sweaters,816881.8499956131
Blazers & Jackets,284830.890540123
Pants & Capris,183690.72078704834
Dresses,447111.8608894348
Jumpsuits & Rompers,41770.06012630463
Fashion Hoodies & Sweatshirts,653688.1405649185
Pants,422951.41153144836
Suits & Sport Coats,635448.5994358063
Outerwear & Coats,1322241.8987178802
Suits,128779.5800743103
Clothing Sets,18734.360023498535
Plus,158538.950476408
Underwear,203074.67025232315
Jeans,1256239.8812875748
Skirts,102504.10020780563

2025-02-12 06:51:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:51:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:51:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:51:44 - snowflake.connector.connection - INFO - closed
2025-02-12 06:51:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:52:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:52:09 - root - INFO - The error you're encountering is because Snowflake does not support the functions `DATE_FROM_UNIX_TIMESTAMP` or `UNIX_TIMESTAMP` with arguments. In Snowflake, to convert a Unix timestamp (epoch time) to a date or timestamp, you should use the `TO_TIMESTAMP_NTZ` function.

Given that your `delivered_at` column contains large numeric values (likely in **nanoseconds**), you need to divide these values by `1e9` to convert them into **seconds** before converting them to a timestamp.

**Here's the corrected query:**

```sql
SELECT "order_id",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "delivered_date",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e9)) AS "month",
       EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e9)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e9) < TIMESTAMP_NTZ '2022-01-01'
LIMIT 100;
```

**Explanation:**

- **TO_TIMESTAMP_NTZ("delivered_at" / 1e9)**: Converts the numeric nanosecond timestamps into proper timestamps by dividing by `1e9` (since there are 1,000,000,000 nanoseconds in a second). The `TO_TIMESTAMP_NTZ` function converts the resulting seconds into a timestamp without timezone.

- **EXTRACT(MONTH FROM ...)** and **EXTRACT(YEAR FROM ...)**: Extracts the month and year from the converted timestamp.

- **WHERE Clause**: Filters the records to include only those delivered before January 1, 2022.

**Why the Original Query Failed:**

- **`DATE_FROM_UNIX_TIMESTAMP`**: This function does not exist in Snowflake. Instead, use `TO_TIMESTAMP_NTZ` to convert Unix timestamps to timestamps.

- **`UNIX_TIMESTAMP` with an argument**: In Snowflake, `UNIX_TIMESTAMP()` returns the current Unix timestamp and does not accept any arguments.

**Additional Notes:**

- **Verifying the Timestamp Conversion:**

  If you're unsure about the units of your `delivered_at` timestamps, you can verify the conversion by running:

  ```sql
  SELECT "order_id",
         "delivered_at",
         TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "delivered_timestamp"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
  LIMIT 10;
  ```

  Check the `delivered_timestamp` to ensure the dates are reasonable and correspond to the expected delivery dates.

- **Adjusting for Different Time Units:**

  - If your timestamps are in **microseconds**, divide by `1e6` instead of `1e9`.
  - If they are in **milliseconds**, divide by `1e3`.

- **Consistent Conversion:**

  Ensure that all instances where you use the `delivered_at` timestamp are consistently converted using the correct factor. This includes the `SELECT` list, `WHERE` clause, and any `JOIN` conditions.

**Updated Query for Previous Instances:**

You should adjust all previous queries where `delivered_at` is used. For example, an earlier query should be corrected as follows:

```sql
SELECT "order_id", "delivered_at"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e9) < TIMESTAMP_NTZ '2022-01-01'
LIMIT 100;
```

**Conclusion:**

By replacing the unsupported functions with the appropriate Snowflake functions and correctly converting the timestamp units, you should be able to run your queries without errors. This will allow you to proceed with generating your monthly report as per your task.

If you have any further questions or need assistance with other queries, feel free to ask!
2025-02-12 06:52:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:52:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:52:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:52:10 - snowflake.connector.connection - INFO - closed
2025-02-12 06:52:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:53:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:53:16 - root - INFO - I'm sorry that you're still encountering errors with your query. Let's address the issue step by step to resolve the problem.

---

### Understanding the Error

**Error Message:**

```
SQL compilation error:
syntax error line 6 at position 61 unexpected ''2022-01-01''.
```

This error indicates there's a syntax issue at line 6, specifically at position 61, where `'2022-01-01'` is used in your query.

---

### Identifying the Issues in Your Query

Let's look at your query:

```sql
SELECT "order_id",
       DATE_FROM_UNIX_TIMESTAMP("delivered_at") AS "delivered_date",
       EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP("delivered_at")) AS "month",
       EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP("delivered_at")) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" < UNIX_TIMESTAMP('2022-01-01')
LIMIT 100;
```

There are two main issues here:

1. **Use of Unsupported Functions:**
   - **`DATE_FROM_UNIX_TIMESTAMP`**: This function is not available in Snowflake SQL.
   - **`UNIX_TIMESTAMP('2022-01-01')`**: In Snowflake, the `UNIX_TIMESTAMP()` function does not accept any arguments.

2. **Syntax Error with Function Arguments:**
   - Attempting to pass `'2022-01-01'` as an argument to `UNIX_TIMESTAMP` causes a syntax error.

---

### Correcting the Query

#### 1. Replace Unsupported Functions

- **Replace `DATE_FROM_UNIX_TIMESTAMP` with `TO_TIMESTAMP_NTZ`:**
  - Snowflake provides the `TO_TIMESTAMP_NTZ` function to convert numeric timestamps to `TIMESTAMP_NTZ` (timestamp without time zone).

- **Handle the Date Comparison Without `UNIX_TIMESTAMP`:**
  - Instead of `UNIX_TIMESTAMP('2022-01-01')`, use a date or timestamp literal.

#### 2. Determine the Correct Time Unit for `delivered_at`

From your earlier test where the results were empty when dividing by `1e6` (microseconds):

```sql
SELECT "order_id",
       "delivered_at",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
LIMIT 10;
```

The returned `delivered_timestamp` values were empty, suggesting that dividing by `1e6` is incorrect.

Let's try dividing by **`1e3` (milliseconds)** instead.

---

### Testing the Time Unit Conversion

**Test Query:**

```sql
SELECT "order_id",
       "delivered_at",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

**Explanation:**

- **If `delivered_at` is in milliseconds:**
  - Dividing by `1e3` converts milliseconds to seconds, which can then be converted to a timestamp.

---

### Adjusting the Main Query

Given that, here's the corrected query:

```sql
SELECT "order_id",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "delivered_date",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e3)) AS "month",
       EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e3)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e3) < '2022-01-01'
  AND "delivered_at" IS NOT NULL
LIMIT 100;
```

**Explanation:**

- **Conversion:**
  - Dividing `delivered_at` by `1e3` converts milliseconds to seconds.
  - `TO_TIMESTAMP_NTZ("delivered_at" / 1e3)` converts the seconds to a timestamp.

- **Date Comparison:**
  - Comparing the converted `delivered_at` timestamp directly to the date `'2022-01-01'`.

- **Handling NULL Values:**
  - Including `AND "delivered_at" IS NOT NULL` ensures that we only process non-null timestamps.

---

### Verifying the Conversion

Please run the test query to verify if dividing by `1e3` yields correct timestamps:

```sql
SELECT "order_id",
       "delivered_at",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

Check the `delivered_timestamp` values to see if they correspond to realistic delivery dates.

---

### Alternative: If `delivered_at` is in Seconds

If the above still doesn't produce valid dates, try assuming that `delivered_at` is stored in seconds (without dividing):

```sql
SELECT "order_id",
       "delivered_at",
       TO_TIMESTAMP_NTZ("delivered_at") AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

---

### Understanding the Units

Based on the sample data you've provided earlier:

```
order_id,delivered_at
2,1720556040000000
15,1727318580000000
17,1724540460000000
...
```

These large numbers suggest that the timestamps might be in **microseconds** or **nanoseconds**.

But dividing by `1e6` (microseconds) didn't yield results, so perhaps the data needs more investigation.

---

### Using Snowflake's `TRY_TO_TIMESTAMP` Function

To handle potential conversion issues, we can use `TRY_TO_TIMESTAMP_NTZ`, which attempts the conversion and returns `NULL` if it fails.

**Test Query:**

```sql
SELECT "order_id",
       "delivered_at",
       TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_in_ns",
       TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_in_us",
       TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_in_ms",
       TRY_TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_in_s"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

This will help you see which conversion yields valid timestamps.

---

### Adjusted Query Based on Conversion

Once you've determined the correct unit, adjust your main query accordingly.

**Example if `delivered_at` is in Seconds:**

```sql
SELECT "order_id",
       TO_TIMESTAMP_NTZ("delivered_at") AS "delivered_date",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at")) AS "month",
       EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at")) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at") < '2022-01-01'
  AND "delivered_at" IS NOT NULL
LIMIT 100;
```

---

### Avoiding Unsupported Functions

Remember, in Snowflake:

- **`UNIX_TIMESTAMP()`**: Returns the current Unix timestamp and **does not accept arguments**.
- **`DATE_FROM_UNIX_TIMESTAMP`**: Does **not exist**.

Always use `TO_TIMESTAMP_NTZ` for converting epoch times to timestamps.

---

### Recap and Final Steps

1. **Determine the Correct Time Unit:**
   - Use the test query with `TRY_TO_TIMESTAMP_NTZ` to find which division factor (`1e9`, `1e6`, `1e3`, or none) yields valid timestamps.

2. **Adjust Your Query Accordingly:**
   - Once you've identified the correct unit, update your query to use the appropriate division factor.

3. **Use the Correct Functions:**
   - Replace any unsupported functions with Snowflake-compatible ones.

---

### Example of Corrected Query (Assuming `delivered_at` is in Microseconds)

**Test the Conversion:**

```sql
SELECT "order_id",
       "delivered_at",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

**If This Yields Valid Dates, Then Use:**

```sql
SELECT "order_id",
       TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_date",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e6)) AS "month",
       EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e6)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e6) < '2022-01-01'
  AND "delivered_at" IS NOT NULL
LIMIT 100;
```

---

### Conclusion

By identifying the correct time unit for your `delivered_at` column and using the appropriate functions and conversion factors, you should be able to resolve the syntax errors and obtain the desired results.

---

### Key Points:

- **Unsupported Functions:**
  - Do not use `UNIX_TIMESTAMP('date')` or `DATE_FROM_UNIX_TIMESTAMP`.

- **Timestamp Conversion:**
  - Use `TO_TIMESTAMP_NTZ("delivered_at" / division_factor)`.

- **Time Units:**
  - Determine whether `delivered_at` is in seconds, milliseconds, microseconds, or nanoseconds.

- **Syntax Errors:**
  - Ensure function usage and syntax are correct.
  - Remove any unsupported function calls.

---

If you need further assistance or if the issue persists after trying these adjustments, please let me know, and I'll be happy to help you troubleshoot further.
2025-02-12 06:53:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:53:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:53:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:53:17 - snowflake.connector.connection - INFO - closed
2025-02-12 06:53:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:53:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:53:53 - root - INFO - I understand that you're still encountering errors with your SQL query due to unsupported functions and timestamp conversions in Snowflake. Let's address the issues step by step to help you construct a working query.

---

### **Error Analysis**

**Error Message:**

```
SQL compilation error:
Unknown functions DATE_FROM_UNIX_TIMESTAMP, DATE_FROM_UNIX_TIMESTAMP, DATE_FROM_UNIX_TIMESTAMP, UNIX_TIMESTAMP
```

**Issues Identified:**

1. **Unsupported Functions:**

   - **`DATE_FROM_UNIX_TIMESTAMP`**: This function is not available in Snowflake.
   - **`UNIX_TIMESTAMP('2022-01-01')`**: In Snowflake, `UNIX_TIMESTAMP()` does not accept arguments.

2. **Timestamp Conversion:**

   - The `delivered_at` column contains numeric timestamps, and we need to convert them properly to perform date comparisons and extract date parts.

---

### **Solution Steps**

#### **1. Understanding the `delivered_at` Column**

From your provided data:

```
order_id,delivered_at
2,1720556040000000
15,1727318580000000
17,1724540460000000
...
```

The `delivered_at` values are large numbers, suggesting they represent timestamps in **microseconds** or **nanoseconds** since the Unix epoch (January 1, 1970).

#### **2. Determining the Correct Time Unit**

To find out whether `delivered_at` is in microseconds or nanoseconds, we can run a test query:

```sql
SELECT
  "order_id",
  "delivered_at",
  TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
```

**Explanation:**

- **`TO_TIMESTAMP_NTZ("delivered_at")`**: Assumes `delivered_at` is in seconds.
- **`TO_TIMESTAMP_NTZ("delivered_at" / 1e3)`**: Assumes milliseconds.
- **`TO_TIMESTAMP_NTZ("delivered_at" / 1e6)`**: Assumes microseconds.
- **`TO_TIMESTAMP_NTZ("delivered_at" / 1e9)`**: Assumes nanoseconds.

**Run the query and observe which `timestamp_*` column contains valid dates.**

#### **3. Adjusting the Query Based on the Correct Time Unit**

Assuming the test reveals that dividing `delivered_at` by **`1e6`** gives correct timestamps (indicating microseconds), we can proceed accordingly.

#### **4. Corrected Query**

```sql
SELECT
  "order_id",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_date",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e6)) AS "month",
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e6)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e6) < '2022-01-01'
LIMIT 100;
```

**Explanation:**

- **Convert `delivered_at` to a Timestamp:**

  - `TO_TIMESTAMP_NTZ("delivered_at" / 1e6)` converts the microsecond timestamp to a standard timestamp.

- **Extract Month and Year:**

  - Use `EXTRACT(MONTH FROM ...)` and `EXTRACT(YEAR FROM ...)` on the converted timestamp.

- **Filter for Dates Before 2022:**

  - Compare the converted `delivered_date` with `'2022-01-01'`.

#### **5. If Microseconds Do Not Yield Correct Dates**

If dividing by `1e6` doesn't produce valid dates, try dividing by `1e9` (nanoseconds):

```sql
SELECT
  "order_id",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "delivered_date",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e9)) AS "month",
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e9)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e9) < '2022-01-01'
LIMIT 100;
```

**Or** if timestamps are in milliseconds (divide by `1e3`):

```sql
SELECT
  "order_id",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "delivered_date",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e3)) AS "month",
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e3)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e3) < '2022-01-01'
LIMIT 100;
```

Repeat the test until you find the factor that yields correct dates.

#### **6. Removing Unsupported Functions**

- **Replace `DATE_FROM_UNIX_TIMESTAMP` with `TO_TIMESTAMP_NTZ`.**
- **Do not use `UNIX_TIMESTAMP('2022-01-01')`; instead, compare with a date string `'2022-01-01'`.**

---

### **Final Correct Query**

Assuming `delivered_at` is in **microseconds**, the final query would be:

```sql
SELECT
  "order_id",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_date",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e6)) AS "month",
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("delivered_at" / 1e6)) AS "year"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE TO_TIMESTAMP_NTZ("delivered_at" / 1e6) < '2022-01-01'
LIMIT 100;
```

---

### **Additional Notes**

- **Consistent Division Factor:**

  - Ensure you use the same division factor when converting `delivered_at` throughout your queries.

- **Testing Your Data:**

  - Run small test queries to confirm that the converted timestamps are correct.

- **Adjusting Other Queries:**

  - Update all your queries that involve `delivered_at` to use the correct timestamp conversion.

---

### **Example of Testing Timestamp Conversion**

```sql
SELECT
  "order_id",
  "delivered_at",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

Check which `timestamp_*` column contains valid dates that make sense (e.g., realistic delivery dates).

---

### **Conclusion**

By replacing unsupported functions with the appropriate Snowflake functions and correctly converting the `delivered_at` timestamps, you should be able to run your query successfully. Ensure that:

- All timestamp conversions use the correct division factor.
- You use `TO_TIMESTAMP_NTZ` for converting numeric timestamps.
- Date comparisons are made against date strings or proper timestamp literals.

If you continue to experience issues, please share the results of the test queries, and I'll be happy to help further.
2025-02-12 06:53:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:53:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:53:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:53:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 06:53:54 - snowflake.connector.connection - INFO - closed
2025-02-12 06:53:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:53:54 - root - INFO - SQL:
SELECT
  "order_id",
  "delivered_at",
  TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
Results:
252005: 252005: Failed to convert current row, cause: year 54524220 is out of range
2025-02-12 06:53:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:53:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:53:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:53:55 - snowflake.connector.connection - INFO - closed
2025-02-12 06:53:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:54:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:54:58 - root - INFO - The error you're encountering is due to the use of the `UNIX_TIMESTAMP` function with an argument in Snowflake SQL. In Snowflake, the `UNIX_TIMESTAMP()` function **does not accept any arguments** and only returns the current Unix timestamp. Attempting to pass a string or date to it results in an "Unknown function" error.

Additionally, from your previous attempts, it seems there's uncertainty about the format and unit of the `delivered_at` timestamps in your data. This makes it challenging to perform accurate date comparisons.

---

### **Understanding the Error**

**Error Message:**

```
SQL compilation error:
Unknown function UNIX_TIMESTAMP
```

**Cause:**

- **`UNIX_TIMESTAMP` Function in Snowflake:**
  - In Snowflake, `UNIX_TIMESTAMP()` returns the current Unix timestamp (number of seconds since January 1, 1970) and **does not accept any arguments**.
  - Using `UNIX_TIMESTAMP('2022-01-01')` is invalid and causes an error.

---

### **Resolving the Error**

To fix the error, you need to:

1. **Remove or Replace the `UNIX_TIMESTAMP` Function:**
   - Since you cannot use `UNIX_TIMESTAMP('2022-01-01')`, replace it with a valid date or timestamp literal.

2. **Convert the `delivered_at` Field Properly:**
   - Determine the correct unit of the `delivered_at` timestamps (seconds, milliseconds, microseconds, nanoseconds).
   - Use appropriate functions to convert `delivered_at` to a timestamp.

However, based on the previous attempts and error messages, it seems that the `delivered_at` field contains large numeric values that are not converting into valid dates using standard methods.

---

### **Proposed Solution**

#### **1. Temporarily Remove the `delivered_at` Condition**

Since we're uncertain about the correct way to convert `delivered_at`, you can **temporarily remove the `delivered_at` condition** to proceed with your query:

```sql
SELECT p."category",
       SUM(p."cost") AS "total_cost",
       SUM(oi."sale_price" - p."cost") AS "total_profit"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
```

This will allow you to get results for the categories, total costs, and total profits for all completed orders, regardless of the delivery date.

#### **2. Investigate the `delivered_at` Field Format**

To include the `delivered_at` condition, you need to understand how to convert it correctly. Here's how you can proceed:

##### **a. Analyze the `delivered_at` Values**

Run the following query to inspect `delivered_at` values:

```sql
SELECT "delivered_at"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 10;
```

Observe the values and see if there's any pattern or commonality that suggests the unit (e.g., they may be timestamps in milliseconds since a certain date).

##### **b. Test Different Conversion Factors**

Use the `TRY_TO_TIMESTAMP` function to test different conversion factors:

```sql
SELECT
  "order_id",
  "delivered_at",
  TRY_TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
```

**Note:** The `TRY_TO_TIMESTAMP_NTZ` function attempts to convert the input to a timestamp and returns `NULL` if it fails, which helps avoid errors during testing.

##### **c. Determine the Correct Conversion**

- If one of the `timestamp_*` columns shows valid dates (e.g., between 2019 and 2022), you can identify the correct conversion factor.
- For example, if `timestamp_milliseconds` shows valid dates, it suggests that `delivered_at` is in milliseconds, and you should divide it by `1e3` during conversion.

#### **3. Adjust the Query with the Correct Conversion**

Once you've determined the correct conversion, modify your query accordingly. Replace the `UNIX_TIMESTAMP` function and convert `delivered_at` properly.

**Example (assuming `delivered_at` is in milliseconds):**

```sql
SELECT p."category",
       SUM(p."cost") AS "total_cost",
       SUM(oi."sale_price" - p."cost") AS "total_profit"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
GROUP BY p."category"
LIMIT 100;
```

**Important:** Replace `1e3` with the correct conversion factor based on your findings.

---

### **Alternative Approach**

If you're unable to determine the correct conversion, consider reaching out to your database administrator or checking the data documentation to understand the format of the `delivered_at` field.

---

### **Summary**

- **Error Cause:** The `UNIX_TIMESTAMP` function in Snowflake does not accept arguments.
- **Solution:** Remove `UNIX_TIMESTAMP('2022-01-01')` and replace it with an appropriate date comparison.
- **Action Steps:**
  1. Remove or replace the faulty function.
  2. Determine the correct way to convert `delivered_at` to a timestamp.
  3. Adjust your query accordingly.

---

### **Example of Corrected Query (Without `delivered_at` Condition)**

```sql
SELECT p."category",
       SUM(p."cost") AS "total_cost",
       SUM(oi."sale_price" - p."cost") AS "total_profit"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
```

---

### **Next Steps**

- **Investigate the `delivered_at` Field:**
  - Determine the timestamp unit and format.
  - Confirm whether the values can be accurately converted to standard timestamps.

- **Update Your Queries:**
  - Once you have the correct conversion, apply it consistently in your queries.
  - Replace any usage of unsupported functions.

- **Consult Documentation or Support:**
  - If uncertainty persists, consult the data documentation or database administrator for clarification on the `delivered_at` field.

---

**Feel free to reach out if you need further assistance or have questions about other queries!**
2025-02-12 06:54:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:54:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:54:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:54:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-02-12 06:54:59 - snowflake.connector.connection - INFO - closed
2025-02-12 06:54:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:56:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:56:24 - root - INFO - SQL:
SELECT p."category",
       SUM(p."cost") AS "total_cost",
       SUM(oi."sale_price" - p."cost") AS "total_profit"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
Results:
category,total_cost,total_profit
Active,47862.99779793553,66687.96225908466
Maternity,28285.50152955421,35848.41835417382
Socks,20631.074219290553,13434.215769704044
Swim,83798.80405621776,80545.17612356892
Skirts,11689.853984055871,17586.1160629412
Outerwear & Coats,145492.66617854146,182226.52353779765
Clothing Sets,3148.4248405689254,1862.6651538616163
Accessories,42146.47870100175,63272.031378676395
Intimates,58697.03962734969,51870.56052657334
Plus,20071.33499859177,19868.295136467586
Sleep & Lounge,64156.921443076775,69519.38887443955
Tops & Tees,70077.00030258964,55251.12011524369
Socks & Hosiery,6140.191714758374,9030.558276896976
Leggings,11544.278053374519,7600.941903977166
Shorts,61405.04095921349,61302.99940552879
Sweaters,99987.45475320493,107014.60524053896
Underwear,23955.124780527352,27018.89527905822
Blazers & Jackets,27222.463950088586,44292.66623360816
Pants & Capris,23927.39609953744,21219.504105121065
Dresses,50606.800507742104,61604.52971629507
Jumpsuits & Rompers,5296.296991693783,4706.483042371464
Fashion Hoodies & Sweatshirts,86610.15491459359,79895.90521838676
Pants,48619.652028058015,57144.24838640884
Suits,18809.008732941496,12406.201231810703
Jeans,166708.6677969575,145009.9525081038
Suits & Sport Coats,61535.93244198517,92159.54742881103

2025-02-12 06:56:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:56:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:56:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:56:25 - snowflake.connector.connection - INFO - closed
2025-02-12 06:56:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:57:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:57:19 - root - INFO - I understand that you're encountering errors with your SQL query due to unsupported functions in Snowflake SQL and issues with timestamp conversion. Let's address the problem step by step to help you construct a working query.

---

### **Error Details**

**SQL Query:**

```sql
SELECT EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
       EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
       COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

**Error Message:**

```
SQL compilation error:
Unknown functions DATE_FROM_UNIX_TIMESTAMP, DATE_FROM_UNIX_TIMESTAMP, UNIX_TIMESTAMP
```

---

### **Causes of the Error**

1. **Unsupported Functions in Snowflake SQL:**

   - **`DATE_FROM_UNIX_TIMESTAMP`**: This function is not available in Snowflake.
   - **`UNIX_TIMESTAMP('2022-01-01')`**: In Snowflake, the `UNIX_TIMESTAMP()` function does not accept arguments. It returns the current Unix timestamp when called without arguments.

2. **Incorrect Timestamp Conversion:**

   - The `delivered_at` field seems to store timestamps in a specific format and unit that need proper conversion.

---

### **Solution**

We need to replace the unsupported functions with appropriate Snowflake functions and correctly handle the conversion of the `delivered_at` timestamps.

---

### **Step-by-Step Correction**

#### **1. Determine the Time Unit of `delivered_at`**

Based on your data:

- **`delivered_at` Values:**

  ```
  1720556040000000
  1727318580000000
  1724540460000000
  ```

- These large numbers suggest that `delivered_at` is stored in **microseconds** or **nanoseconds** since the Unix epoch.

#### **2. Test Timestamp Conversion**

Run the following query to determine the correct conversion factor:

```sql
SELECT
  "order_id",
  "delivered_at",
  TRY_TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
```

**Explanation:**

- **`TRY_TO_TIMESTAMP_NTZ`**: Attempts to convert a numeric value to a timestamp without time zone. If conversion fails, it returns `NULL` instead of an error.
- We divide `delivered_at` by different factors to test for seconds, milliseconds, microseconds, and nanoseconds.

#### **3. Analyze the Results**

From your previous attempt:

```
252005: Failed to convert current row, cause: year 54524220 is out of range
```

This error indicates that dividing by `1e9` (nanoseconds) or `1e6` (microseconds) results in timestamps with years that are out of range. Therefore, let's try dividing by `1e3` (milliseconds).

**Run the Test for Milliseconds:**

```sql
SELECT
  "order_id",
  "delivered_at",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "delivered_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
```

**Check if `delivered_timestamp` shows valid dates (e.g., between 2015 and 2022).**

#### **4. Correct the SQL Query Using the Proper Conversion**

Assuming that dividing by `1e3` yields valid dates, we can adjust your original query as follows:

```sql
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
       COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

**Explanation:**

- **`TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)`**: Converts `delivered_at` from milliseconds to a timestamp.
- **`EXTRACT(YEAR FROM ...)`, `EXTRACT(MONTH FROM ...)`**: Extracts the year and month from the converted timestamp.
- **Date Comparison**: Uses a direct date string `'2022-01-01'` instead of `UNIX_TIMESTAMP('2022-01-01')`.
- **Removed Unsupported Functions**: Replaced `DATE_FROM_UNIX_TIMESTAMP` and `UNIX_TIMESTAMP`.

---

### **Updated Query**

```sql
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
       COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

---

### **Additional Notes**

- **Verifying the Conversion Factor:**

  If dividing by `1e3` does not yield correct dates, try other factors (e.g., no division if timestamps are in seconds). It's crucial to confirm the correct time unit.

- **Consistent Conversion:**

  Use the same conversion factor (`/ 1e3`) throughout all queries involving `delivered_at` to ensure consistency.

- **Adjusting Other Queries:**

  Replace `DATE_FROM_UNIX_TIMESTAMP` and `UNIX_TIMESTAMP` in all other queries with the appropriate functions and conversions.

---

### **Correcting Similar Queries**

**Example of Corrected Queries:**

1. **Counting Orders by Year and Month:**

   ```sql
   SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
          EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
          COUNT(DISTINCT o."order_id") AS "total_completed_orders"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
   WHERE o."status" = 'Complete'
     AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
   GROUP BY "year", "month"
   ORDER BY "year", "month"
   LIMIT 100;
   ```

2. **Calculating Total Revenue by Category, Year, and Month:**

   ```sql
   SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
          EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
          p."category",
          SUM(oi."sale_price") AS "total_revenue"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
     ON oi."order_id" = o."order_id"
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   WHERE o."status" = 'Complete'
     AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
   GROUP BY "year", "month", p."category"
   ORDER BY "year", "month", p."category"
   LIMIT 100;
   ```

3. **Calculating Month-over-Month Revenue Growth:**

   ```sql
   SELECT "year", "month", "category", "total_revenue",
          LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_revenue",
          (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month")) 
            / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100 
            AS "revenue_growth_percentage"
   FROM (
     SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
            EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
            p."category",
            SUM(oi."sale_price") AS "total_revenue"
     FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
     JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
       ON oi."order_id" = o."order_id"
     JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
       ON oi."product_id" = p."id"
     WHERE o."status" = 'Complete'
       AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
     GROUP BY "year", "month", p."category"
   )
   ORDER BY "year", "month", "category"
   LIMIT 100;
   ```

---

### **Summary**

- **Issue:** The functions `DATE_FROM_UNIX_TIMESTAMP` and `UNIX_TIMESTAMP('2022-01-01')` are not valid in Snowflake SQL.

- **Solution:**

  - Use `TO_TIMESTAMP_NTZ` to convert numeric timestamps to timestamp data types.
  - Determine the correct time unit of your timestamps (`delivered_at`) and divide accordingly.
  - Replace any unsupported functions with appropriate ones.
  - Use direct date strings for comparisons (e.g., `'2022-01-01'`).

- **Next Steps:**

  - Run the test queries to confirm the correct conversion factor for `delivered_at`.
  - Adjust all queries that use `delivered_at` to include the correct timestamp conversions.
  - Ensure consistency across all queries.

---

If you need further assistance or have questions about other queries, feel free to ask!
2025-02-12 06:57:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:57:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:57:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:57:20 - snowflake.connector.connection - INFO - closed
2025-02-12 06:57:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:58:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:58:25 - root - INFO - I understand that you're encountering errors with your SQL query due to unsupported functions in Snowflake (`DATE_FROM_UNIX_TIMESTAMP` and `UNIX_TIMESTAMP`) and issues with the `delivered_at` timestamp conversion. Let's resolve these issues step by step.

---

### **Understanding the Error**

**Error Message:**

```
SQL compilation error:
Unknown functions DATE_FROM_UNIX_TIMESTAMP, DATE_FROM_UNIX_TIMESTAMP, UNIX_TIMESTAMP
```

**Cause:**

- **Unsupported Functions:**
  - `DATE_FROM_UNIX_TIMESTAMP` is not a valid function in Snowflake.
  - `UNIX_TIMESTAMP` in Snowflake returns the current Unix timestamp and does not accept arguments.

---

### **Resolving the Errors**

#### **1. Replace Unsupported Functions**

- **Use `TO_TIMESTAMP_NTZ`** to convert numeric timestamps to `TIMESTAMP_NTZ` (timestamp without time zone).
- Replace `UNIX_TIMESTAMP('2022-01-01')` with a standard date or timestamp literal (e.g., `'2022-01-01'`).

#### **2. Determine the Correct Time Unit for `delivered_at`**

Based on the data you've provided, the `delivered_at` field contains large numeric values like `1720556040000000`. We need to determine the correct time unit (milliseconds, microseconds, nanoseconds) to accurately convert these values to timestamps.

**Let's test different conversion factors:**

```sql
SELECT
  "order_id",
  "delivered_at",
  TRY_TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TRY_TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
```

**Explanation:**

- **`TRY_TO_TIMESTAMP_NTZ`** attempts to convert a numeric value to a timestamp. If it fails, it returns `NULL` instead of an error.
- Dividing `delivered_at` by different factors helps identify the correct time unit.

**Analyzing the Results:**

- **If `timestamp_seconds` yields valid dates** (e.g., between 2015 and 2022), then `delivered_at` is in seconds.
- **If `timestamp_milliseconds` yields valid dates**, then `delivered_at` is in milliseconds.
- **If `timestamp_microseconds` yields valid dates**, then `delivered_at` is in microseconds.
- **If `timestamp_nanoseconds` yields valid dates**, then `delivered_at` is in nanoseconds.

Given that you're receiving an error about the year being out of range when dividing by `1e6` or `1e9`, it's possible that the timestamps are in **milliseconds**.

---

#### **3. Use Milliseconds for Timestamp Conversion**

Assuming that dividing `delivered_at` by `1e3` (milliseconds) results in valid dates, we'll proceed with that.

**Updated Query:**

```sql
SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
       EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
       COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

**Explanation:**

- **Convert `delivered_at` to a timestamp:**
  - `TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)`
  - Divides `delivered_at` by `1e3` to convert milliseconds to seconds.
- **Extract Year and Month:**
  - `EXTRACT(YEAR FROM ...)` and `EXTRACT(MONTH FROM ...)`
- **Date Comparison:**
  - Compares the converted timestamp to `'2022-01-01'`.

---

#### **4. Adjust Other Queries Accordingly**

**For other queries involving `delivered_at`, apply the same conversion:**

- **Example:**

  ```sql
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3)) AS "month",
         p."category",
         SUM(oi."sale_price") AS "total_revenue"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
    AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) < '2022-01-01'
  GROUP BY "year", "month", p."category"
  ORDER BY "year", "month", p."category"
  LIMIT 100;
  ```

---

### **Verifying the Conversion**

It's essential to verify that dividing by `1e3` correctly converts your timestamps. Run this test query:

```sql
SELECT
  "order_id",
  "delivered_at",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "converted_timestamp"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
```

**Check the `converted_timestamp` values:**

- Ensure they represent realistic dates (e.g., between 2015 and 2022).
- If the dates are still incorrect, you may need to adjust the division factor (try dividing by `1e0` or `1e6`).

---

### **Conclusion**

By replacing unsupported functions and correctly converting the `delivered_at` timestamps, you should be able to run your queries without errors.

**Key Points:**

- **Replace Unsupported Functions:**
  - Use `TO_TIMESTAMP_NTZ` instead of `DATE_FROM_UNIX_TIMESTAMP`.
  - Remove `UNIX_TIMESTAMP('2022-01-01')` and use a date literal.
- **Convert Timestamps Correctly:**
  - Determine the correct time unit (seconds, milliseconds, microseconds, nanoseconds).
  - Use the appropriate division factor in `TO_TIMESTAMP_NTZ`.
- **Consistency:**
  - Apply the same conversion method across all queries involving `delivered_at`.

---

### **Additional Assistance**

If you're still encountering issues:

- **Check Data Documentation:**
  - Verify the format and unit of the `delivered_at` timestamps in your dataset documentation.
- **Consult Database Administrator:**
  - If possible, consult with someone familiar with the database to confirm the timestamp format.
- **Testing Different Units:**
  - Try other division factors (e.g., `1e6` for microseconds) if milliseconds don't yield correct dates.

---

Feel free to reach out if you need further clarification or assistance with other queries!
2025-02-12 06:58:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:58:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:58:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:58:26 - snowflake.connector.connection - INFO - closed
2025-02-12 06:58:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:59:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 06:59:17 - root - INFO - I'm sorry to hear that you're still encountering errors with your SQL query. The error message you're receiving:

```
001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,0) and TIMESTAMP_NTZ(0)
```

indicates that there's an issue with data type conversion in your query. Let's analyze your query step by step to identify the problem and find a solution.

---

### **Understanding the Error**

**Error Explanation:**

The error message suggests that Snowflake is attempting to perform an implicit or explicit cast between a `NUMBER(38,0)` and a `TIMESTAMP_NTZ(0)` data type, which is not allowed.

- **`NUMBER(38,0)`:** This is the data type of the `"delivered_at"` column.
- **`TIMESTAMP_NTZ(0)`:** This is the data type of a timestamp without timezone information.

The function `TRY_CAST` is failing because it's trying to convert a `NUMBER` to a `TIMESTAMP_NTZ` or vice versa, and it cannot perform this operation with the given data.

---

### **Analyzing Your Query**

Your current query is:

```sql
SELECT
  EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
  EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
  COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

**Issues Identified:**

1. **Unsupported Functions:**

   - **`DATE_FROM_UNIX_TIMESTAMP`**: This function does not exist in Snowflake.
   - **`UNIX_TIMESTAMP('2022-01-01')`**: In Snowflake, `UNIX_TIMESTAMP()` does not accept arguments.

2. **Data Type Mismatch:**

   - You're comparing a `NUMBER` (`o."delivered_at"`) with a `TIMESTAMP` or attempting to extract date parts from a `NUMBER`, leading to the data type conversion error.

---

### **Solution Steps**

#### **1. Understand the `delivered_at` Field**

First, we need to determine the correct way to handle the `"delivered_at"` column.

- **Data Type:** `NUMBER(38,0)`
- **Sample Values:** Large numeric values like `1720556040000000`

#### **2. Determine the Correct Time Unit**

Based on the sample values, the numbers are large, and it's likely that the timestamps are stored in **milliseconds** since the Unix epoch (`1970-01-01`). Let's test this assumption.

**Test the Conversion:**

```sql
SELECT
  o."order_id",
  o."delivered_at",
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) AS "timestamp_ms",
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1000000) AS "timestamp_us",
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1000000000) AS "timestamp_ns"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."delivered_at" IS NOT NULL
LIMIT 5;
```

**Check which `timestamp_*` field gives you valid dates.** If dividing by `1000` (milliseconds) results in valid dates, then `"delivered_at"` is in milliseconds.

#### **3. Correct the Query**

Assuming `"delivered_at"` is in **milliseconds**, you can adjust your query as follows:

```sql
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

**Explanation:**

- **Convert `"delivered_at"` to a TIMESTAMP:**
  - `TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)` converts milliseconds to seconds and then to a timestamp.
- **Extract Year and Month:**
  - Use `EXTRACT(YEAR FROM ...)` and `EXTRACT(MONTH FROM ...)` on the converted timestamp.
- **Date Comparison:**
  - Compare the converted timestamp directly to a date string `'2022-01-01'`.

#### **4. Address the Error Message**

The error about `TRY_CAST` failing is due to attempting to compare a `NUMBER` with a `TIMESTAMP_NTZ` directly in your `WHERE` clause:

```sql
AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
```

Since `o."delivered_at"` is a `NUMBER` and `UNIX_TIMESTAMP('2022-01-01')` (even if it worked) returns a `NUMBER`, but in Snowflake, the function doesn't accept arguments. Instead, you're trying to compare different data types.

By converting both sides of the comparison to the same data type (TIMESTAMP), you eliminate the data type mismatch.

#### **5. Remove Unsupported Functions**

Replace unsupported functions with the correct ones:

- **Replace `DATE_FROM_UNIX_TIMESTAMP` with `TO_TIMESTAMP_NTZ`.**
- **Do not use `UNIX_TIMESTAMP('2022-01-01')`; instead, use a date literal `'2022-01-01'`.**

---

### **Final Corrected Query**

```sql
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

---

### **Additional Notes**

- **Verify the Conversion Factor:**

  If dividing `"delivered_at"` by `1000` doesn't yield valid dates, try other factors like `1000000` (microseconds) or `1000000000` (nanoseconds). Use the conversion factor that results in realistic dates.

- **Consistent Data Types:**

  Always ensure that when performing comparisons or calculations, the data types on both sides are compatible.

- **Adjust Other Queries Accordingly:**

  For any other queries that involve `"delivered_at"`, make sure to apply the same conversion and data type considerations.

---

### **Conclusion**

The error you're experiencing is due to data type mismatches and the use of unsupported functions in Snowflake. By properly converting `"delivered_at"` to a timestamp and replacing unsupported functions with the appropriate ones, you should be able to resolve the error and run your query successfully.

---

If you need further assistance or if you encounter additional issues, please feel free to ask, and I'll be happy to help you troubleshoot further.
2025-02-12 06:59:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:59:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:59:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:59:18 - snowflake.connector.connection - INFO - closed
2025-02-12 06:59:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 06:59:19 - root - INFO - SQL:
SELECT
  EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
  EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
  COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
Results:
002140 (42601): 01ba5683-0004-9c12-0001-11c3010ef752: SQL compilation error:
Unknown functions DATE_FROM_UNIX_TIMESTAMP, DATE_FROM_UNIX_TIMESTAMP, UNIX_TIMESTAMP
2025-02-12 06:59:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 06:59:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 06:59:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 06:59:20 - snowflake.connector.connection - INFO - closed
2025-02-12 06:59:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:00:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:00:01 - root - INFO - It appears you're encountering errors due to the use of unsupported functions in Snowflake SQL:

- **`DATE_FROM_UNIX_TIMESTAMP`** does not exist in Snowflake.
- **`UNIX_TIMESTAMP('2022-01-01')`** is invalid because `UNIX_TIMESTAMP()` in Snowflake does not accept arguments.

To fix your query, we'll replace these functions with the appropriate ones and ensure the `delivered_at` field is correctly converted to a timestamp.

---

### **Corrected SQL Query:**

```sql
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  p."category",
  SUM(oi."sale_price") AS "total_revenue"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
GROUP BY "year", "month", p."category"
ORDER BY "year", "month", p."category"
LIMIT 100;
```

---

### **Explanation:**

1. **Replacing Unsupported Functions:**

   - **`DATE_FROM_UNIX_TIMESTAMP`** is replaced with `TO_TIMESTAMP_NTZ`, which converts numeric epoch timestamps to Snowflake `TIMESTAMP_NTZ` data type.
   - **`UNIX_TIMESTAMP('2022-01-01')`** is replaced with a date string `'2022-01-01'` for direct comparison.

2. **Converting `delivered_at` to a Timestamp:**

   - Assuming `delivered_at` is in **milliseconds**, we divide it by `1000` to convert to seconds.
   - `TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)` converts the numeric timestamp to a Snowflake timestamp.

3. **Extracting Year and Month:**

   - `EXTRACT(YEAR FROM ...)` and `EXTRACT(MONTH FROM ...)` retrieve the year and month from the converted timestamp.

4. **Filtering by Date:**

   - We compare the converted `delivered_at` timestamp to the date `'2022-01-01'` to include only orders delivered before 2022.

---

### **Confirming the Time Unit of `delivered_at`:**

It's crucial to verify the time unit (milliseconds, microseconds, or nanoseconds) of `delivered_at`. Here's how you can test it:

**Test Query:**

```sql
SELECT
  o."order_id",
  o."delivered_at",
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1e3) AS "timestamp_milliseconds",
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6) AS "timestamp_microseconds",
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."delivered_at" IS NOT NULL
LIMIT 5;
```

**Instructions:**

- Run the above query.
- Check which `timestamp_*` column yields valid dates.
  - If `timestamp_milliseconds` shows correct dates, use `/ 1000`.
  - If `timestamp_microseconds` shows correct dates, use `/ 1e6`.
  - If `timestamp_nanoseconds` shows correct dates, use `/ 1e9`.

**Adjust Accordingly:**

- If `delivered_at` is in microseconds:

  ```sql
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)
  ```

- If `delivered_at` is in nanoseconds:

  ```sql
  TO_TIMESTAMP_NTZ(o."delivered_at" / 1e9)
  ```

---

### **Applying the Correct Conversion Factor:**

If you determine that `delivered_at` is not in milliseconds, adjust the division factor in your query accordingly.

**Example if in Microseconds:**

```sql
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "month",
  p."category",
  SUM(oi."sale_price") AS "total_revenue"
FROM ...
-- Rest of the query remains the same, but replace / 1000 with / 1e6
```

---

### **Additional Adjustments for Other Queries:**

**Corrected Query for Counting Total Completed Orders:**

```sql
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
```

**Corrected Query for Profit Calculations:**

```sql
SELECT p."category",
       SUM(p."cost") AS "total_cost",
       SUM(oi."sale_price" - p."cost") AS "total_profit"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN ...
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
GROUP BY p."category"
LIMIT 100;
```

---

### **Key Points:**

- **Use `TO_TIMESTAMP_NTZ`** to convert numeric timestamps.
- **Replace Unsupported Functions** with Snowflake-compatible ones.
- **Verify Time Units** to ensure accurate timestamp conversion.
- **Use Date Strings** (e.g., `'2022-01-01'`) for comparisons instead of unsupported functions.

---

### **Final Remarks:**

By making these corrections, your queries should run without errors, and you can proceed with generating the required monthly report.

If you encounter any further issues or need additional assistance, please feel free to ask!
2025-02-12 07:00:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:00:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:00:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:00:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 07:00:03 - snowflake.connector.connection - INFO - closed
2025-02-12 07:00:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:00:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:00:29 - root - INFO - ```sql
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  p."category",
  SUM(oi."sale_price") AS "total_revenue"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY "year", "month", p."category"
ORDER BY "year", "month", p."category"
LIMIT 100;
```
2025-02-12 07:00:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:00:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:00:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:00:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 07:00:30 - snowflake.connector.connection - INFO - closed
2025-02-12 07:00:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:01:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:01:40 - root - INFO - SQL:
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  p."category",
  SUM(oi."sale_price") AS "total_revenue"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY "year", "month", p."category"
ORDER BY "year", "month", p."category"
LIMIT 100;
Results:
year,month,category,total_revenue
51076,10,Sleep & Lounge,38.5
51076,10,Socks,11.949999809265137
51082,1,Accessories,9.0
51082,1,Socks,4.889999866485596
51082,7,Sleep & Lounge,128.0
51082,7,Socks,22.989999771118164
51084,10,Maternity,62.0
51084,10,Socks & Hosiery,10.0
51090,8,Fashion Hoodies & Sweatshirts,16.959999084472656
51090,8,Sweaters,42.0
51095,2,Tops & Tees,130.0
51096,8,Socks,11.989999771118164
51111,6,Fashion Hoodies & Sweatshirts,49.9900016784668
51113,9,Fashion Hoodies & Sweatshirts,39.9900016784668
51113,9,Shorts,29.989999771118164
51122,6,Fashion Hoodies & Sweatshirts,293.3299865722656
51127,3,Accessories,17.950000762939453
51127,3,Shorts,54.0
51130,9,Active,84.94999694824217
51135,7,Suits,88.2699966430664
51139,3,Active,23.0
51139,11,Socks,9.359999656677246
51139,11,Swim,41.650001525878906
51144,5,Sweaters,63.59999847412109
51149,10,Shorts,24.979999542236328
51160,7,Intimates,10.0
51176,12,Active,43.9900016784668
51188,10,Outerwear & Coats,903.0
51193,4,Intimates,36.0
51200,2,Sleep & Lounge,64.0
51207,5,Jeans,39.9900016784668
51213,5,Maternity,38.0
51213,5,Shorts,37.0
51216,4,Jeans,200.0
51223,8,Active,25.0
51223,8,Plus,12.989999771118164
51227,9,Underwear,14.989999771118164
51235,9,Fashion Hoodies & Sweatshirts,32.9900016784668
51235,9,Shorts,27.700000762939453
51241,8,Socks,25.0
51254,5,Leggings,19.989999771118164
51254,10,Socks,17.0
51260,11,Accessories,50.0
51260,11,Fashion Hoodies & Sweatshirts,58.9099998474121
51260,11,Jeans,34.5
51260,11,Pants,95.0
51261,2,Sleep & Lounge,179.9499969482422
51261,5,Sweaters,155.92999267578125
51261,5,Tops & Tees,15.210000038146973
51264,3,Tops & Tees,46.220001220703125
51264,9,Underwear,14.989999771118164
51269,7,Shorts,158.0
51271,7,Pants & Capris,42.9900016784668
51276,11,Intimates,42.0
51276,11,Maternity,16.979999542236328
51286,7,Maternity,13.520000457763672
51287,8,Outerwear & Coats,41.9900016784668
51287,8,Sleep & Lounge,59.9900016784668
51287,8,Sweaters,33.970001220703125
51287,8,Swim,52.0
51303,10,Intimates,78.0
51305,1,Active,30.0
51308,12,Pants,55.0
51311,7,Shorts,84.38000106811523
51311,12,Accessories,12.75
51311,12,Pants & Capris,11.970000267028809
51311,12,Socks & Hosiery,25.0
51321,9,Intimates,39.93999862670898
51326,8,Dresses,28.899999618530277
51326,8,Intimates,30.950000762939453
51334,4,Swim,44.950000762939446
51336,2,Underwear,22.0
51339,2,Intimates,129.99000549316406
51340,4,Active,64.0
51340,4,Tops & Tees,24.0
51340,8,Jumpsuits & Rompers,15.8100004196167
51347,10,Maternity,69.0
51347,10,Sweaters,72.95999908447266
51348,4,Plus,16.989999771118164
51352,1,Pants,39.9900016784668
51352,7,Accessories,24.989999771118164
51361,4,Intimates,22.0
51361,4,Maternity,29.729999542236328
51362,11,Sleep & Lounge,27.590000152587887
51362,11,Suits & Sport Coats,299.989990234375
51363,4,Swim,36.0
51363,4,Underwear,25.0
51364,1,Maternity,48.09999847412109
51364,1,Sleep & Lounge,20.0
51365,11,Jeans,86.75
51365,11,Swim,62.9099998474121
51367,9,Tops & Tees,25.0
51372,3,Active,50.0
51374,11,Dresses,39.950000762939446
51375,3,Accessories,103.91000366210938
51380,6,Socks & Hosiery,15.0
51389,3,Intimates,44.0
51389,3,Swim,78.0
51391,12,Jeans,198.0
51393,9,Accessories,65.0

2025-02-12 07:01:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:01:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:01:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:01:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 07:01:42 - snowflake.connector.connection - INFO - closed
2025-02-12 07:01:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:01:42 - root - INFO - SQL:
SELECT oi."order_id",
           oi."product_id",
           oi."sale_price",
           p."cost",
           (oi."sale_price" - p."cost") AS "profit"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    LIMIT 100;
Results:
Too long, hard cut:
order_id,product_id,sale_price,cost,profit
14805,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
71201,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
81114,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
109826,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
49859,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
6684,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
82012,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
28060,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
63169,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
12239,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
50479,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
73832,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
108606,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
114916,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
35245,14202,1.5,0.617999997921288,0.882000002078712
42210,14202,1.5,0.617999997921288,0.882000002078712
5718,14202,1.5,0.617999997921288,0.882000002078712
6074,14202,1.5,0.617999997921288,0.882000002078712
25844,14202,1.5,0.617999997921288,0.882000002078712
33209,14202,1.5,0.617999997921288,0.882000002078712
57511,28700,1.5,0.6059999980498105,0.8940000019501895
108498,28700,1.5,0.6059999980498105,0.8940000019501895
5338,28700,1.5,0.6059999980498105,0.8940000019501895
33098,14202,1.5,0.617999997921288,0.882000002078712
76384,28700,1.5,0.6059999980498105,0.8940000019501895
101325,14202,1.5,0.617999997921288,0.882000002078712
7232,14202,1.5,0.617999997921288,0.882000002078712
46807,14202,1.5,0.617999997921288,0.882000002078712
120416,28700,1.5,0.6059999980498105,0.8940000019501895
61834,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
79332,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
14956,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
3229,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
69780,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
103440,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
100896,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
18515,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
18022,14298,1.7200000286102295,0.6450000075250863,1.0750000210851431
63483,14298,1.7200000286102295,0.6450000075250863,1.0750000210851431
90395,12536,1.75,1.0132499965839088,0.7367500034160912
105059,12536,1.75,1.0132499965839088,0.7367500034160912
122880,12536,1.75,1.0132499965839088,0.7367500034160912
106189,12536,1.75,1.0132499965839088,0.7367500034160912
21501,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
35298,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
111104,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
7274,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
11963,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
12507,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
83546,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
33669,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
34236,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
105655,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
111185,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
112616,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
54378,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
6059,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
28271,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
34370,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
55186,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
62067,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
88741,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
11966,9204,1.950000047683716,0.7722000156065448,1.177800032077171
72980,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
21690,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
80738,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
119820,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
29862,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
115326,9204,1.950000047683716,0.7722000156065448,1.177800032077171
121983,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
20438,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
32712,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
100600,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
73565,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
18204,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
26774,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
70016,14549,1.9800000

2025-02-12 07:01:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:01:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:01:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:01:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-02-12 07:01:43 - snowflake.connector.connection - INFO - closed
2025-02-12 07:01:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:01:44 - root - INFO - SQL:
SELECT p."category", AVG(oi."sale_price") AS "average_sale_price"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."category"
    LIMIT 100;
Results:
category,average_sale_price
Accessories,43.229780272777205
Intimates,33.32644906870921
Socks & Hosiery,16.765867551210764
Socks,20.299785083527553
Sleep & Lounge,49.21708581268445
Tops & Tees,41.579498303597504
Active,49.71962393214743
Maternity,51.90535684411696
Leggings,27.279730370799577
Shorts,46.110458505719286
Swim,57.18632826152689
Sweaters,75.17778851422908
Blazers & Jackets,91.61495353493824
Pants & Capris,53.83667080511382
Dresses,84.29710801082858
Jumpsuits & Rompers,47.03835599809079
Fashion Hoodies & Sweatshirts,54.835008855374426
Pants,59.8149358692474
Suits & Sport Coats,124.52451488062047
Outerwear & Coats,145.25342180796224
Suits,116.64817035716513
Clothing Sets,92.74435655197294
Plus,36.28723975198169
Underwear,27.134509654238798
Jeans,98.7687617963342
Skirts,50.870521194940764

2025-02-12 07:01:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:01:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:01:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:01:45 - snowflake.connector.connection - INFO - closed
2025-02-12 07:01:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:02:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:02:05 - root - INFO - ```sql
SELECT p."category",
       SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
  AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
GROUP BY p."category"
LIMIT 100;
```
2025-02-12 07:02:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:02:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:02:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:02:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 07:02:06 - snowflake.connector.connection - INFO - closed
2025-02-12 07:02:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:02:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:02:23 - root - INFO - ```sql
SELECT p."category",
       SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
```
2025-02-12 07:02:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:02:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:02:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:02:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-02-12 07:02:24 - snowflake.connector.connection - INFO - closed
2025-02-12 07:02:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:03:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:03:32 - root - INFO - SQL:
SELECT p."category",
       SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
Results:
category,profit_to_cost_ratio
Active,1.3933093480818517
Maternity,1.267377858466376
Socks,0.6511641433165282
Swim,0.9611733369074564
Skirts,1.5043914224187411
Outerwear & Coats,1.2524790996281434
Clothing Sets,0.5916181100658034
Accessories,1.5012412265220278
Intimates,0.8836997718434241
Plus,0.9898840878228364
Sleep & Lounge,1.0835836151539882
Tops & Tees,0.7884344346457696
Socks & Hosiery,1.4707290417645116
Leggings,0.6584163919852335
Shorts,0.9983382218773785
Sweaters,1.0702803217131476
Underwear,1.1278962446073897
Blazers & Jackets,1.6270630871186818
Pants & Capris,0.8868288056438902
Dresses,1.2173172201801312
Jumpsuits & Rompers,0.888636541672922
Fashion Hoodies & Sweatshirts,0.9224773387967293
Pants,1.1753323193969252
Suits,0.6595882541158524
Jeans,0.8698405093412322
Suits & Sport Coats,1.497654196037367

2025-02-12 07:03:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:03:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:03:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:03:33 - snowflake.connector.connection - INFO - closed
2025-02-12 07:03:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:03:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:03:59 - root - INFO - ```sql
SELECT "year", "month", "category", "total_revenue",
       LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_revenue",
       (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "revenue_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         SUM(oi."sale_price") AS "total_revenue"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
```
2025-02-12 07:03:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:03:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:03:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:04:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 07:04:01 - snowflake.connector.connection - INFO - closed
2025-02-12 07:04:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:04:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:04:43 - root - INFO - SQL:
SELECT "year", "month", "category", "total_revenue",
       LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_revenue",
       (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "revenue_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         SUM(oi."sale_price") AS "total_revenue"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
Results:
Too long, hard cut:
year,month,category,total_revenue,previous_month_revenue,revenue_growth_percentage
51076,10,Sleep & Lounge,38.5,,
51076,10,Socks,11.949999809265137,,
51082,1,Accessories,9.0,,
51082,1,Socks,4.889999866485596,11.949999809265137,-59.07949837208989
51082,7,Sleep & Lounge,128.0,38.5,232.4675324675325
51082,7,Socks,22.989999771118164,4.889999866485596,370.14315744022497
51084,10,Maternity,62.0,,
51084,10,Socks & Hosiery,10.0,,
51090,8,Fashion Hoodies & Sweatshirts,16.959999084472656,,
51090,8,Sweaters,42.0,,
51095,2,Tops & Tees,130.0,,
51096,8,Socks,11.989999771118164,22.989999771118164,-47.84689042850301
51111,6,Fashion Hoodies & Sweatshirts,49.9900016784668,16.959999084472656,194.75238429838132
51113,9,Fashion Hoodies & Sweatshirts,39.9900016784668,49.9900016784668,-20.0040001285047
51113,9,Shorts,29.989999771118164,,
51122,6,Fashion Hoodies & Sweatshirts,293.3299865722656,39.9900016784668,633.5083127296127
51127,3,Accessories,17.950000762939453,9.0,99.44445292154947
51127,3,Shorts,54.0,29.989999771118164,80.0600213808759
51130,9,Active,84.94999694824217,,
51135,7,Suits,88.2699966430664,,
51139,3,Active,23.0,84.94999694824217,-72.92524917450756
51139,11,Socks,9.359999656677246,11.989999771118164,-21.934947161351356
51139,11,Swim,41.650001525878906,,
51144,5,Sweaters,63.59999847412109,42.0,51.42856779552639
51149,10,Shorts,24.979999542236328,54.0,-53.74074158845124
51160,7,Intimates,10.0,,
51176,12,Active,43.9900016784668,23.0,91.26087686289912
51188,10,Outerwear & Coats,903.0,,
51193,4,Intimates,36.0,10.0,260.0
51200,2,Sleep & Lounge,64.0,128.0,-50.0
51207,5,Jeans,39.9900016784668,,
51213,5,Maternity,38.0,62.0,-38.70967741935484
51213,5,Shorts,37.0,24.979999542236328,48.1184975101388
51216,4,Jeans,200.0,39.9900016784668,400.125010266486
51223,8,Active,25.0,43.9900016784668,-43.168904191614175
51223,8,Plus,12.989999771118164,,
51227,9,Underwear,14.989999771118164,,
51235,9,Fashion Hoodies & Sweatshirts,32.9900016784668,293.3299865722656,-88.75328020023645
51235,9,Shorts,27.700000762939453,37.0,-25.13513307313661
51241,8,Socks,25.0,9.359999656677246,167.09402689096763
51254,5,Leggings,19.989999771118164,,
51254,10,Socks,17.0,25.0,-32.0
51260,11,Accessories,50.0,17.950000762939453,178.5515201939864
51260,11,Fashion Hoodies & Sweatshirts,58.9099998474121,32.9900016784668,78.56925386537273
51260,11,Jeans,34.5,200.0,-82.75
51260,11,Pants,95.0,,
51261,2,Sleep & Lounge,179.9499969482422,64.0,181.17187023162842
51261,5,Sweaters,155.92999267578125,63.59999847412109,145.1729503409176
51261,5,Tops & Tees,15.210000038146973,130.0,-88.29999997065617
51264,3,Tops & Tees,46.220001220703125,15.210000038146973,203.87903421947712
51264,9,Underwear,14.989999771118164,14.989999771118164,0.0
51269,7,Shorts,158.0,27.700000762939453,470.3970962029441
51271,7,Pants & Capris,42.9900016784668,,
51276,11,Intimates,42.0,36.0,16.666666666666664
51276,11,Maternity,16.979999542236328,38.0,-55.31579067832545
51286,7,Maternity,13.520000457763672,16.979999542236328,-20.37690917403265
51287,8,Outerwear & Coats,41.9900016784668,903.0,-95.34994444313767
51287,8,Sleep & Lounge,59.9900016784668,179.9499969482422,-66.66296043576966
51287,8,Sweaters,33.970001220703125,155.92999267578125,-78.21458166079984
51287,8,Swim,52.0,41.650001525878906,24.849935402019618
51303,10,Intimates,78.0,42.0,85.71428571428571
51305,1,Active,30.0,25.0,20.0
51308,12,Pants,55.0,95.0,-42.10526315789473
51311,7,Shorts,84.38000106811523,158.0,-46.594936032838454
51311,12,Accessories,12.75,50.0,-74.5
51311,12,Pants & Capris,11.970000267028809,42.9900016784668,-72.1563158881558
51311,12,Socks & Hosiery,25.0,10.0,150.0
51321,9,Intimates,39.93999862670898,78.0,-48.79487355550131
51326,8,Dresses,28.899999618530277,,
51326,8,Intimates,30.950000762939453,39.93999862670898,-22.508758570055797
51334,4,Swim,44.950000762939446,52.0,-13.557690840501065
51336,2,Underwear,22.0,14.989999771118164,46.7645119140581
51339,2,Intimates,129.99000549316406,30.950000762939453,320.0000073952126
51340,4,Active,64.0,30.0,113.33333333333333
51340,4,Tops & Tees,24.0,46.220001220703125,-48.074428026518994
51340,8,Jumpsuits & Rompers,15.8100004196167,,
51347,10,Maternity,69.0,13.520000457763672,410.3550123060662
51347,10,Sweaters,72.95999908447266,33.970001220703125,114.77773465609107
51348,4,Plus,16.989999771118164,12.989999771118164,30.792918171511907
51352,1,Pants,39.9900016784668,55.0,-27.29090603915128
51352,7,Accessories,24.989999771118164,12.75,95.99999820484835
51361,4,Intimates,22.0,129.99000549316406,-83.07562191682733
51361,4,Maternity,29.729999542236328,69.0,-56.913044141686484
51362,11,Sleep & Lounge,27.590000152587887,59.9900016784668,-54.00900253268167
51362,11,Suits & Sport Coats,299.989990234375,,
51363,4,Swim,36.0,44.950000762939446,-19.911013595173458
51363,4,Underwear,25.0,22.0,13.636363636363635
51364,1,Maternity,48.09999847412109,29.729999542236328,61.78943563650975
51364,1,Sleep & Lounge,20.0,27.590000152587887,-27.5099677803951
51365,11,Jeans,86.75,34.5,151.44927536231884
51365,11,S

2025-02-12 07:04:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:04:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:04:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:04:44 - snowflake.connector.connection - INFO - closed
2025-02-12 07:04:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:05:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:05:14 - root - INFO - ```sql
SELECT "year", "month", "category", "total_orders",
       LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_orders",
       (("total_orders" - LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "orders_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         COUNT(DISTINCT o."order_id") AS "total_orders"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
    AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1000) < '2022-01-01'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
```
2025-02-12 07:05:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:05:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:05:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:05:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-12 07:05:15 - snowflake.connector.connection - INFO - closed
2025-02-12 07:05:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:05:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:05:48 - root - INFO - ```sql
SELECT "year", "month", "category", "total_orders",
       LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_orders",
       (("total_orders" - LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "orders_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         COUNT(DISTINCT o."order_id") AS "total_orders"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
```
2025-02-12 07:05:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:05:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:05:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:05:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 07:05:50 - snowflake.connector.connection - INFO - closed
2025-02-12 07:05:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:06:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:06:13 - root - INFO - SQL:
SELECT "year", "month", "category", "total_orders",
       LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_orders",
       (("total_orders" - LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "orders_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         COUNT(DISTINCT o."order_id") AS "total_orders"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
Results:
year,month,category,total_orders,previous_month_orders,orders_growth_percentage
51076,10,Sleep & Lounge,1,,
51076,10,Socks,1,,
51082,1,Accessories,1,,
51082,1,Socks,1,1.0,0.000000
51082,7,Sleep & Lounge,1,1.0,0.000000
51082,7,Socks,1,1.0,0.000000
51084,10,Maternity,1,,
51084,10,Socks & Hosiery,1,,
51090,8,Fashion Hoodies & Sweatshirts,1,,
51090,8,Sweaters,1,,
51095,2,Tops & Tees,1,,
51096,8,Socks,1,1.0,0.000000
51111,6,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51113,9,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51113,9,Shorts,1,,
51122,6,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51127,3,Accessories,1,1.0,0.000000
51127,3,Shorts,1,1.0,0.000000
51130,9,Active,1,,
51135,7,Suits,1,,
51139,3,Active,1,1.0,0.000000
51139,11,Socks,1,1.0,0.000000
51139,11,Swim,1,,
51144,5,Sweaters,1,1.0,0.000000
51149,10,Shorts,1,1.0,0.000000
51160,7,Intimates,1,,
51176,12,Active,1,1.0,0.000000
51188,10,Outerwear & Coats,1,,
51193,4,Intimates,1,1.0,0.000000
51200,2,Sleep & Lounge,1,1.0,0.000000
51207,5,Jeans,1,,
51213,5,Maternity,1,1.0,0.000000
51213,5,Shorts,1,1.0,0.000000
51216,4,Jeans,1,1.0,0.000000
51223,8,Active,1,1.0,0.000000
51223,8,Plus,1,,
51227,9,Underwear,1,,
51235,9,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51235,9,Shorts,1,1.0,0.000000
51241,8,Socks,1,1.0,0.000000
51254,5,Leggings,1,,
51254,10,Socks,1,1.0,0.000000
51260,11,Accessories,1,1.0,0.000000
51260,11,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51260,11,Jeans,1,1.0,0.000000
51260,11,Pants,1,,
51261,2,Sleep & Lounge,1,1.0,0.000000
51261,5,Sweaters,1,1.0,0.000000
51261,5,Tops & Tees,1,1.0,0.000000
51264,3,Tops & Tees,1,1.0,0.000000
51264,9,Underwear,1,1.0,0.000000
51269,7,Shorts,1,1.0,0.000000
51271,7,Pants & Capris,1,,
51276,11,Intimates,1,1.0,0.000000
51276,11,Maternity,1,1.0,0.000000
51286,7,Maternity,1,1.0,0.000000
51287,8,Outerwear & Coats,1,1.0,0.000000
51287,8,Sleep & Lounge,1,1.0,0.000000
51287,8,Sweaters,1,1.0,0.000000
51287,8,Swim,1,1.0,0.000000
51303,10,Intimates,1,1.0,0.000000
51305,1,Active,1,1.0,0.000000
51308,12,Pants,1,1.0,0.000000
51311,7,Shorts,1,1.0,0.000000
51311,12,Accessories,1,1.0,0.000000
51311,12,Pants & Capris,1,1.0,0.000000
51311,12,Socks & Hosiery,1,1.0,0.000000
51321,9,Intimates,1,1.0,0.000000
51326,8,Dresses,1,,
51326,8,Intimates,1,1.0,0.000000
51334,4,Swim,1,1.0,0.000000
51336,2,Underwear,1,1.0,0.000000
51339,2,Intimates,1,1.0,0.000000
51340,4,Active,1,1.0,0.000000
51340,4,Tops & Tees,1,1.0,0.000000
51340,8,Jumpsuits & Rompers,1,,
51347,10,Maternity,1,1.0,0.000000
51347,10,Sweaters,1,1.0,0.000000
51348,4,Plus,1,1.0,0.000000
51352,1,Pants,1,1.0,0.000000
51352,7,Accessories,1,1.0,0.000000
51361,4,Intimates,1,1.0,0.000000
51361,4,Maternity,1,1.0,0.000000
51362,11,Sleep & Lounge,1,1.0,0.000000
51362,11,Suits & Sport Coats,1,,
51363,4,Swim,1,1.0,0.000000
51363,4,Underwear,1,1.0,0.000000
51364,1,Maternity,1,1.0,0.000000
51364,1,Sleep & Lounge,1,1.0,0.000000
51365,11,Jeans,1,1.0,0.000000
51365,11,Swim,1,1.0,0.000000
51367,9,Tops & Tees,1,1.0,0.000000
51372,3,Active,1,1.0,0.000000
51374,11,Dresses,1,1.0,0.000000
51375,3,Accessories,1,1.0,0.000000
51380,6,Socks & Hosiery,1,1.0,0.000000
51389,3,Intimates,1,1.0,0.000000
51389,3,Swim,1,1.0,0.000000
51391,12,Jeans,1,1.0,0.000000
51393,9,Accessories,1,1.0,0.000000

2025-02-12 07:06:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:06:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:06:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:06:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 07:06:15 - snowflake.connector.connection - INFO - closed
2025-02-12 07:06:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:06:16 - root - INFO - SQL:
SELECT p."name", p."category", SUM(oi."sale_price") AS "total_revenue"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."name", p."category"
    ORDER BY "total_revenue" DESC
    LIMIT 5;
Results:
name,category,total_revenue
The North Face Apex Bionic Soft Shell Jacket - Men's,Fashion Hoodies & Sweatshirts,13545.0
Canada Goose Women's Expedition Parka,Outerwear & Coats,11130.0
The North Face Apex Bionic Soft Shell Jacket - Men's,Active,10836.0
The North Face Nuptse 2 Jacket - Noah Green/TNF Black,Outerwear & Coats,9933.0
Mens Nike AirJordan Varsity Hoodie Jacket Grey / Black 451582-066,Outerwear & Coats,9933.0

2025-02-12 07:06:16 - root - INFO - itercount: 0
2025-02-12 07:06:16 - root - INFO - Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,0
table_name,DISTRIBUTION_CENTERS
description,
DDL,"create or replace TABLE DISTRIBUTION_CENTERS (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT
);"

Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,1
table_name,ORDERS
description,
DDL,"create or replace TABLE ORDERS (
	""order_id"" NUMBER(38,0),
	""user_id"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""gender"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0),
	""returned_at"" NUMBER(38,0),
	""shipped_at"" NUMBER(38,0),
	""delivered_at"" NUMBER(38,0),
	""num_of_item"" NUMBER(38,0)
);"

Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,2
table_name,USERS
description,
DDL,"create or replace TABLE USERS (
	""id"" NUMBER(38,0),
	""first_name"" VARCHAR(16777216),
	""last_name"" VARCHAR(16777216),
	""email"" VARCHAR(16777216),
	""age"" NUMBER(38,0),
	""gender"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""postal_code"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""traffic_source"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0)
);"

Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,3
table_name,EVENTS
description,
DDL,"create or replace TABLE EVENTS (
	""id"" NUMBER(38,0),
	""user_id"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""session_id"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0),
	""ip_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""postal_code"" VARCHAR(16777216),
	""browser"" VARCHAR(16777216),
	""traffic_source"" VARCHAR(16777216),
	""uri"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216)
);"

Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,4
table_name,INVENTORY_ITEMS
description,
DDL,"create or replace TABLE INVENTORY_ITEMS (
	""id"" NUMBER(38,0),
	""product_id"" NUMBER(38,0),
	""created_at"" NUMBER(38,0),
	""sold_at"" NUMBER(38,0),
	""cost"" FLOAT,
	""product_category"" VARCHAR(16777216),
	""product_name"" VARCHAR(16777216),
	""product_brand"" VARCHAR(16777216),
	""product_retail_price"" FLOAT,
	""product_department"" VARCHAR(16777216),
	""product_sku"" VARCHAR(16777216),
	""product_distribution_center_id"" NUMBER(38,0)
);"

Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,5
table_name,PRODUCTS
description,
DDL,"create or replace TABLE PRODUCTS (
	""id"" NUMBER(38,0),
	""cost"" FLOAT,
	""category"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""brand"" VARCHAR(16777216),
	""retail_price"" FLOAT,
	""department"" VARCHAR(16777216),
	""sku"" VARCHAR(16777216),
	""distribution_center_id"" NUMBER(38,0)
);"

Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
,6
table_name,ORDER_ITEMS
description,
DDL,"create or replace TABLE ORDER_ITEMS (
	""id"" NUMBER(38,0),
	""order_id"" NUMBER(38,0),
	""user_id"" NUMBER(38,0),
	""product_id"" NUMBER(38,0),
	""inventory_item_id"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0),
	""shipped_at"" NUMBER(38,0),
	""delivered_at"" NUMBER(38,0),
	""returned_at"" NUMBER(38,0),
	""sale_price"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'THELOOK_ECOMMERCE': {'THELOOK_ECOMMERCE': ['DISTRIBUTION_CENTERS', 'ORDERS', 'USERS', 'EVENTS', 'INVENTORY_ITEMS', 'PRODUCTS', 'ORDER_ITEMS']}}
Begin Exploring Related Columns
**Relevant tables, columns, and their potential usage:**

- **ORDERS**
  - `"order_id"`: Used to join with `ORDER_ITEMS`.
  - `"status"`: To filter orders with status 'Complete'.
  - `"delivered_at"`: To filter orders delivered before the year 2022 and to extract the month and year of delivery.
  
- **ORDER_ITEMS**
  - `"order_id"`: Used to join with `ORDERS`.
  - `"product_id"`: Used to join with `PRODUCTS`.
  - `"sale_price"`: To calculate total revenue.
  
- **PRODUCTS**
  - `"id"`: Used to join with `ORDER_ITEMS` via `"product_id"`.
  - `"category"`: To group data by product category.
  - `"cost"`: To calculate the total cost of products sold.

**Conditions that may be used:**

- Filter orders where `ORDERS."status" = 'Complete'`.
- Filter orders delivered before 2022: `ORDERS."delivered_at" < UNIX_TIMESTAMP('2022-01-01')`.
- Extract month and year from `ORDERS."delivered_at"` for grouping purposes.

---

Below are SQL queries to explore the relevant data:

1. **Select all orders with status 'Complete':**

   ```sql
   SELECT *
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE "status" = 'Complete'
   LIMIT 100;
   ```

2. **Select distinct product categories:**

   ```sql
   SELECT DISTINCT "category"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS"
   LIMIT 100;
   ```

3. **Select orders delivered before January 1, 2022:**

   ```sql
   SELECT "order_id", "delivered_at"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE "delivered_at" < UNIX_TIMESTAMP('2022-01-01')
   LIMIT 100;
   ```

4. **Select sale prices from order items of completed orders:**

   ```sql
   SELECT oi."sale_price"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
     ON oi."order_id" = o."order_id"
   WHERE o."status" = 'Complete'
   LIMIT 100;
   ```

5. **Select products with their categories and costs:**

   ```sql
   SELECT "id", "category", "cost"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS"
   LIMIT 100;
   ```

6. **Select order items with their product IDs and sale prices:**

   ```sql
   SELECT "product_id", "sale_price"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS"
   LIMIT 100;
   ```

7. **Join order items with products to get sale prices and categories:**

   ```sql
   SELECT oi."sale_price", p."category"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   LIMIT 100;
   ```

8. **Calculate total revenue per product category:**

   ```sql
   SELECT p."category", SUM(oi."sale_price") AS "total_revenue"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category"
   LIMIT 100;
   ```

9. **Select orders with delivery dates and extract month and year:**

   ```sql
   SELECT "order_id",
          DATE_FROM_UNIX_TIMESTAMP("delivered_at") AS "delivered_date",
          EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP("delivered_at")) AS "month",
          EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP("delivered_at")) AS "year"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE "delivered_at" < UNIX_TIMESTAMP('2022-01-01')
   LIMIT 100;
   ```

10. **Calculate total cost and profit per product category for completed orders delivered before 2022:**

    ```sql
    SELECT p."category",
           SUM(p."cost") AS "total_cost",
           SUM(oi."sale_price" - p."cost") AS "total_profit"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
      ON oi."order_id" = o."order_id"
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE o."status" = 'Complete'
      AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
    GROUP BY p."category"
    LIMIT 100;
    ```

11. **Count total completed orders per month and year:**

    ```sql
    SELECT EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
           EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
           COUNT(DISTINCT o."order_id") AS "total_completed_orders"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    WHERE o."status" = 'Complete'
      AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
    GROUP BY "year", "month"
    ORDER BY "year", "month"
    LIMIT 100;
    ```

12. **Calculate total revenue per category per month and year:**

    ```sql
    SELECT EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
           EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
           p."category",
           SUM(oi."sale_price") AS "total_revenue"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
      ON oi."order_id" = o."order_id"
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE o."status" = 'Complete'
      AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
    GROUP BY "year", "month", p."category"
    ORDER BY "year", "month", p."category"
    LIMIT 100;
    ```

13. **Select profit per order item:**

    ```sql
    SELECT oi."order_id",
           oi."product_id",
           oi."sale_price",
           p."cost",
           (oi."sale_price" - p."cost") AS "profit"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    LIMIT 100;
    ```

14. **Calculate average sale price per product category:**

    ```sql
    SELECT p."category", AVG(oi."sale_price") AS "average_sale_price"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."category"
    LIMIT 100;
    ```

15. **Select the profit-to-cost ratio per product category:**

    ```sql
    SELECT p."category",
           SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
      ON oi."order_id" = o."order_id"
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE o."status" = 'Complete'
      AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
    GROUP BY p."category"
    LIMIT 100;
    ```

16. **Compute month-over-month revenue growth per category:**

    ```sql
    SELECT "year", "month", "category", "total_revenue",
           LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_revenue",
           (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month")) / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100 AS "revenue_growth_percentage"
    FROM (
      SELECT EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
             EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
             p."category",
             SUM(oi."sale_price") AS "total_revenue"
      FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
      JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
      JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
      WHERE o."status" = 'Complete'
        AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
      GROUP BY "year", "month", p."category"
    )
    ORDER BY "year", "month", "category"
    LIMIT 100;
    ```

17. **Compute month-over-month order growth per category:**

    ```sql
    SELECT "year", "month", "category", "total_orders",
           LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_orders",
           (("total_orders" - LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month")) / NULLIF(LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100 AS "orders_growth_percentage"
    FROM (
      SELECT EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
             EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
             p."category",
             COUNT(DISTINCT o."order_id") AS "total_orders"
      FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
      JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
      JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
      WHERE o."status" = 'Complete'
        AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
      GROUP BY "year", "month", p."category"
    )
    ORDER BY "year", "month", "category"
    LIMIT 100;
    ```

18. **List top 5 products by total revenue:**

    ```sql
    SELECT p."name", p."category", SUM(oi."sale_price") AS "total_revenue"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."name", p."category"
    ORDER BY "total_revenue" DESC
    LIMIT 5;
    ```

These queries help in understanding the data and how different columns and tables relate to the task at hand. They cover simple selections, joins, aggregations, and window functions to explore and prepare the necessary data for the monthly report.Query:
SELECT *
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
   WHERE "status" = 'Complete'
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,user_id,status,gender,created_at,returned_at,shipped_at,delivered_at,num_of_item
2,3,Complete,F,1720203480000000,,1720303560000000,1720556040000000,1
15,17,Complete,F,1726771320000000,,1726969680000000,1727318580000000,1
17,18,Complete,F,1724156580000000,,1724334840000000,1724540460000000,1
32,35,Complete,F,1705130340000000,,1705298820000000,1705415880000000,2
44,52,Complete,F,1593392280000000,,1593538980000000,1593826680000000,1
53,57,Complete,F,1719043560000000,,1719091860000000,1719505560000000,1
54,57,Complete,F,1708416360000000,,1708419240000000,1708661280000000,2
72,72,Complete,F,1675307400000000,,1675348260000000,1675523400000000,3
77,77,Complete,F,1729042920000000,,1729205460000000,1729580220000000,1
106,100,Complete,F,1636387140000000,,1636396620000000,1636727040000000,1
107,100,Complete,F,1719244740000000,,1719387000000000,1719731280000000,2
108,101,Complete,F,1728881220000000,,1728907080000000,1729223580000000,1
111,104,Complete,F,1719151020000000,,1719222360000000,1719339000000000,2
128,117,Complete,F,1675837740000000,,1675951260000000,1676327640000000,1
151,133,Complete,F,1623901860000000,,1624078740000000,1624374600000000,1
159,145,Complete,F,1729176088031265,,1729423408031265,1729557268031265,2
175,155,Complete,F,1673232900000000,,1673355600000000,1673648160000000,1
180,160,Complete,F,1685610480000000,,1685624520000000,1685821440000000,1
190,168,Complete,F,1670464980000000,,1670716560000000,1671118200000000,1
195,172,Complete,F,1674700140000000,,1674704820000000,1674912300000000,1
203,178,Complete,F,1715519220000000,,1715664840000000,1716068820000000,1
207,183,Complete,F,1683690420000000,,1683919860000000,1683937020000000,1
216,189,Complete,F,1653207600000000,,1653338640000000,1653477300000000,2
220,192,Complete,F,1686701400000000,,1686853680000000,1687159980000000,1
255,218,Complete,F,1689989340000000,,1690236720000000,1690525320000000,1
258,220,Complete,F,1704883920000000,,1704955740000000,1705099980000000,3
283,239,Complete,F,1603616280000000,,1603618200000000,1603822800000000,1
289,243,Complete,F,1624628040000000,,1624670880000000,1624713300000000,4
297,253,Complete,F,1662471120000000,,1662705900000000,1662838140000000,1
301,258,Complete,F,1614214860000000,,1614231540000000,1614356820000000,1
302,260,Complete,F,1715364180000000,,1715480160000000,1715497500000000,1
311,269,Complete,F,1701960900000000,,1702208820000000,1702331880000000,1
342,289,Complete,F,1725637560000000,,1725746400000000,1725755160000000,1
361,308,Complete,F,1634051040000000,,1634275140000000,1634677020000000,1
371,317,Complete,F,1692024540000000,,1692148320000000,1692505140000000,3
376,321,Complete,F,1620235920000000,,1620487740000000,1620727380000000,1
396,340,Complete,F,1665501900000000,,1665598860000000,1665884700000000,1
404,347,Complete,F,1646927160000000,,1647133260000000,1647417780000000,1
412,354,Complete,F,1633573200000000,,1633806180000000,1634036460000000,1
416,359,Complete,F,1729323515837874,,1729324595837874,1729739015837874,1
426,366,Complete,F,1726595160000000,,1726643940000000,1726675260000000,1
427,368,Complete,F,1712073060000000,,1712250420000000,1712313960000000,1
432,370,Complete,F,1695655500000000,,1695691440000000,1695900060000000,1
434,372,Complete,F,1707457980000000,,1707570240000000,1707586560000000,1
436,372,Complete,F,1631944380000000,,1632067560000000,1632195600000000,2
444,377,Complete,F,1631156040000000,,1631252400000000,1631393160000000,1
456,389,Complete,F,1720088160000000,,1720107780000000,1720245840000000,2
461,394,Complete,F,1728393600000000,,1728632400000000,1728965820000000,1
462,395,Complete,F,1659720720000000,,1659864240000000,1660023780000000,1
474,404,Complete,F,1665544320000000,,1665629700000000,1666030380000000,1
475,404,Complete,F,1655089920000000,,1655327520000000,1655684940000000,1
479,409,Complete,F,1698649800000000,,1698883680000000,1699285440000000,3
480,409,Complete,F,1695625800000000,,1695855840000000,1696261080000000,4
487,413,Complete,F,1727535480000000,,1727762040000000,1728082560000000,1
490,415,Complete,F,1697355480000000,,1697581440000000,1697926740000000,1
492,415,Complete,F,1705390680000000,,1705514940000000,1705624680000000,4
499,423,Complete,F,1695176340000000,,1695421440000000,1695818580000000,1
504,427,Complete,F,1687426740000000,,1687581240000000,1687878600000000,2
509,430,Complete,F,1720866840000000,,1720899420000000,1721113320000000,1
516,435,Complete,F,1714672260000000,,1714776600000000,1714820100000000,1
529,441,Complete,F,1707479520000000,,1707624420000000,1707914520000000,1
531,444,Complete,F,1727765700000000,,1728019260000000,1728236400000000,1
533,447,Complete,F,1685177460000000,,1685310120000000,1685565660000000,1
540,452,Complete,F,1726013640000000,,1726185600000000,1726583880000000,1
541,453,Complete,F,1728972600000000,,1729033440000000,1729289400000000,1
542,453,Complete,F,1698387000000000,,1698522960000000,1698788520000000,1
545,455,Complete,F,1672474200000000,,1672703220000000,1672789560000000,1
554,462,Complete,F,1688019120000000,,16
Query:
SELECT DISTINCT "category"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS"
   LIMIT 100;
Answer:
category
Accessories
Plus
Swim
Active
Socks & Hosiery
Socks
Dresses
Pants & Capris
Fashion Hoodies & Sweatshirts
Skirts
Blazers & Jackets
Suits
Tops & Tees
Sweaters
Jeans
Sleep & Lounge
Suits & Sport Coats
Pants
Intimates
Outerwear & Coats
Maternity
Jumpsuits & Rompers
Clothing Sets
Underwear
Shorts
Leggings
Query:
SELECT "order_id",
            "delivered_at",
            TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "delivered_timestamp"
     FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
     LIMIT 10;
Answer:
order_id,delivered_at,delivered_timestamp
28,,
45,,
73,,
88,,
98,,
136,,
165,,
167,,
176,,
177,,
Query:
SELECT oi."sale_price"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
     ON oi."order_id" = o."order_id"
   WHERE o."status" = 'Complete'
   LIMIT 100;
Answer:
sale_price
0.0199999995529651
0.0199999995529651
0.0199999995529651
1.5
1.5099999904632568
1.75
1.75
1.75
1.8200000524520876
1.8200000524520876
1.8200000524520876
1.8200000524520876
1.950000047683716
1.950000047683716
1.950000047683716
1.9800000190734863
1.9800000190734863
2.5
2.5899999141693115
2.6700000762939453
2.6700000762939453
2.6700000762939453
2.6700000762939453
2.7799999713897705
2.7799999713897705
2.7799999713897705
2.7799999713897705
2.7799999713897705
2.799999952316284
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.950000047683716
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
2.990000009536743
3.0
3.0
3.0
3.0899999141693115
3.1099998950958248
3.1700000762939453
3.1700000762939453
3.1700000762939453
3.1700000762939453
3.1700000762939453
3.25
3.289999961853028
3.369999885559082
3.369999885559082
3.390000104904175
3.390000104904175
3.390000104904175
3.400000095367432
3.400000095367432
3.4600000381469727
3.4800000190734863
3.5
3.5
3.5
3.5
3.5
3.5
3.5
3.5
3.5999999046325684
3.5999999046325684
3.5999999046325684
3.5999999046325684
3.670000076293945
3.75
3.75
3.75
3.799999952316284
3.799999952316284
3.799999952316284
3.880000114440918
3.900000095367432
3.950000047683716
3.950000047683716
3.950000047683716
3.950000047683716
Query:
SELECT "id", "category", "cost"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS"
   LIMIT 100;
Answer:
id,category,cost
13842,Accessories,2.518749990849756
13928,Accessories,2.3383499148894105
14115,Accessories,4.879559879379869
14157,Accessories,4.648769887297898
14273,Accessories,6.507929886473045
15674,Plus,3.1062499998370185
15816,Plus,3.1772999091416594
28646,Accessories,8.73562987972319
28670,Accessories,2.6759399153566363
28714,Accessories,2.275000000372529
28779,Accessories,7.36748991528362
28904,Accessories,6.7957498848550015
29007,Accessories,10.795999868229032
12777,Swim,16.691290760814255
12810,Swim,21.055320884742144
12812,Swim,21.14530090284795
12853,Swim,18.71584077014294
12900,Swim,17.39565078823306
13247,Swim,20.65041088706643
13477,Swim,22.600890809484422
13574,Swim,19.39069080118597
2848,Active,20.946700439925493
3039,Active,22.627350425997378
9041,Socks & Hosiery,20.479500227209176
13122,Swim,68.73737201425911
18147,Active,17.069900398133232
18363,Active,65.0955812367481
18394,Active,22.97700039561093
18465,Active,27.240000218153
18593,Active,17.00110065520704
18607,Active,30.63616928671479
18644,Active,41.28767906982421
18664,Active,25.83845043245256
18708,Active,42.59726061337233
18796,Active,36.31391910439163
24644,Socks,27.872100528435407
24674,Socks,35.64000008627772
24731,Socks,25.58795095982142
27569,Swim,92.6525625942932
3206,Dresses,38.31499995291233
3660,Dresses,21.91964971384816
3682,Dresses,18.956299259465936
3730,Dresses,39.070999938994646
3943,Dresses,26.28080032457113
5353,Pants & Capris,22.46999996714294
5433,Pants & Capris,11.640959460911304
9035,Socks & Hosiery,1.3983000106409191
14170,Accessories,1.1859000150532462
28411,Accessories,2.083760045012236
28548,Accessories,1.280300021749735
28873,Accessories,1.3904000092506408
29033,Accessories,1.7182500154450535
25038,Socks,7.600199877980351
17159,Fashion Hoodies & Sweatshirts,28.429830918571056
5357,Pants & Capris,15.4504798515518
5440,Pants & Capris,13.46318990700826
5474,Pants & Capris,13.89443986939028
7234,Skirts,9.19631984055072
7236,Skirts,11.383619829264582
7246,Skirts,9.452059872821495
7377,Skirts,10.1959198788739
7448,Skirts,9.171329883230927
7903,Blazers & Jackets,10.567589980136454
8080,Suits,37.113601108783485
8089,Suits,49.165528608800166
8093,Suits,14.139569917708933
8101,Suits,8.50591988700248
8103,Suits,38.11730891824752
8107,Suits,36.057561151015165
8109,Suits,37.754101099950816
8110,Suits,9.701289908803105
8139,Suits,59.51379877566248
8145,Suits,44.83409886984303
8148,Suits,42.90603882040273
8155,Suits,42.87359867274165
8158,Suits,15.12617992565751
8160,Suits,15.697959905421325
8162,Suits,9.820219895048735
8185,Suits,10.261959890300371
8188,Suits,35.49766125103474
8189,Suits,19.204350993917885
8191,Suits,43.697928826136206
8194,Suits,16.139789889234155
8195,Suits,39.658078809719605
8197,Suits,16.191769897296577
8199,Suits,17.165639852822423
8208,Suits,16.21775990132779
8209,Suits,9.837209897604733
70,Tops & Tees,56.92499983403832
791,Sweaters,44.6489999309415
2060,Fashion Hoodies & Sweatshirts,6.033999998122454
1935,Fashion Hoodies & Sweatshirts,59.90400007367134
1972,Fashion Hoodies & Sweatshirts,36.876000098884106
2349,Fashion Hoodies & Sweatshirts,38.47200004756451
6529,Shorts,31.960000045597557
12746,Swim,27.84000009298325
12750,Swim,34.93951924982994
12757,Swim,22.781000450715425
12762,Swim,20.816100375162065
12768,Swim,21.74639948249459
Query:
SELECT "product_id", "sale_price"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS"
   LIMIT 100;
Answer:
product_id,sale_price
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14235,0.0199999995529651
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14159,0.4900000095367431
14202,1.5
14202,1.5
14202,1.5
14202,1.5
14202,1.5
14202,1.5
28700,1.5
28700,1.5
28700,1.5
14202,1.5
28700,1.5
14202,1.5
14202,1.5
14202,1.5
28700,1.5
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
13629,1.5099999904632568
14298,1.7200000286102295
14298,1.7200000286102295
12536,1.75
12536,1.75
12536,1.75
12536,1.75
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
13659,1.8200000524520876
13659,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
15332,1.8200000524520876
13659,1.8200000524520876
13659,1.8200000524520876
15332,1.8200000524520876
13659,1.8200000524520876
15332,1.8200000524520876
9204,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
9204,1.950000047683716
3049,1.950000047683716
3049,1.950000047683716
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
14549,1.9800000190734863
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
13606,2.5
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
28913,2.5899999141693115
13690,2.6700000762939453
13690,2.6700000762939453
15395,2.6700000762939453
13690,2.6700000762939453
Query:
SELECT oi."sale_price", p."category"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   LIMIT 100;
Answer:
sale_price,category
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.0199999995529651,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
0.4900000095367431,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.5099999904632568,Accessories
1.7200000286102295,Accessories
1.7200000286102295,Accessories
1.75,Intimates
1.75,Intimates
1.75,Intimates
1.75,Intimates
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Accessories
1.8200000524520876,Accessories
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Plus
1.8200000524520876,Accessories
1.8200000524520876,Accessories
1.8200000524520876,Plus
1.8200000524520876,Accessories
1.8200000524520876,Plus
1.950000047683716,Socks & Hosiery
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Active
1.950000047683716,Socks & Hosiery
1.950000047683716,Active
1.950000047683716,Active
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
1.9800000190734863,Maternity
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.5899999141693115,Accessories
2.6700000762939453,Accessories
2.6700000762939453,Accessories
2.6700000762939453,Plus
2.6700000762939453,Accessories
Query:
SELECT p."category", SUM(oi."sale_price") AS "total_revenue"
   FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
   JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category"
   LIMIT 100;
Answer:
category,total_revenue
Accessories,426937.3099739477
Intimates,443541.7106554508
Socks & Hosiery,62033.70993947983
Socks,126569.1599957943
Sleep & Lounge,548868.940983057
Tops & Tees,497956.07168388367
Active,441559.9801414013
Maternity,262485.38956069946
Leggings,87022.33988285065
Shorts,515053.82150888443
Swim,649922.6206922531
Sweaters,816881.8499956131
Blazers & Jackets,284830.890540123
Pants & Capris,183690.72078704834
Dresses,447111.8608894348
Jumpsuits & Rompers,41770.06012630463
Fashion Hoodies & Sweatshirts,653688.1405649185
Pants,422951.41153144836
Suits & Sport Coats,635448.5994358063
Outerwear & Coats,1322241.8987178802
Suits,128779.5800743103
Clothing Sets,18734.360023498535
Plus,158538.950476408
Underwear,203074.67025232315
Jeans,1256239.8812875748
Skirts,102504.10020780563
Query:
SELECT
  "order_id",
  "delivered_at",
  TO_TIMESTAMP_NTZ("delivered_at") AS "timestamp_seconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e3) AS "timestamp_milliseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e6) AS "timestamp_microseconds",
  TO_TIMESTAMP_NTZ("delivered_at" / 1e9) AS "timestamp_nanoseconds"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS"
WHERE "delivered_at" IS NOT NULL
LIMIT 5;
Answer:
252005: 252005: Failed to convert current row, cause: year 54524220 is out of rangeQuery:
SELECT p."category",
       SUM(p."cost") AS "total_cost",
       SUM(oi."sale_price" - p."cost") AS "total_profit"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
Answer:
category,total_cost,total_profit
Active,47862.99779793553,66687.96225908466
Maternity,28285.50152955421,35848.41835417382
Socks,20631.074219290553,13434.215769704044
Swim,83798.80405621776,80545.17612356892
Skirts,11689.853984055871,17586.1160629412
Outerwear & Coats,145492.66617854146,182226.52353779765
Clothing Sets,3148.4248405689254,1862.6651538616163
Accessories,42146.47870100175,63272.031378676395
Intimates,58697.03962734969,51870.56052657334
Plus,20071.33499859177,19868.295136467586
Sleep & Lounge,64156.921443076775,69519.38887443955
Tops & Tees,70077.00030258964,55251.12011524369
Socks & Hosiery,6140.191714758374,9030.558276896976
Leggings,11544.278053374519,7600.941903977166
Shorts,61405.04095921349,61302.99940552879
Sweaters,99987.45475320493,107014.60524053896
Underwear,23955.124780527352,27018.89527905822
Blazers & Jackets,27222.463950088586,44292.66623360816
Pants & Capris,23927.39609953744,21219.504105121065
Dresses,50606.800507742104,61604.52971629507
Jumpsuits & Rompers,5296.296991693783,4706.483042371464
Fashion Hoodies & Sweatshirts,86610.15491459359,79895.90521838676
Pants,48619.652028058015,57144.24838640884
Suits,18809.008732941496,12406.201231810703
Jeans,166708.6677969575,145009.9525081038
Suits & Sport Coats,61535.93244198517,92159.54742881103
Query:
SELECT
  EXTRACT(YEAR FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "year",
  EXTRACT(MONTH FROM DATE_FROM_UNIX_TIMESTAMP(o."delivered_at")) AS "month",
  COUNT(DISTINCT o."order_id") AS "total_completed_orders"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
WHERE o."status" = 'Complete'
  AND o."delivered_at" < UNIX_TIMESTAMP('2022-01-01')
GROUP BY "year", "month"
ORDER BY "year", "month"
LIMIT 100;
Answer:
002140 (42601): 01ba5683-0004-9c12-0001-11c3010ef752: SQL compilation error:
Unknown functions DATE_FROM_UNIX_TIMESTAMP, DATE_FROM_UNIX_TIMESTAMP, UNIX_TIMESTAMPQuery:
SELECT
  EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
  EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
  p."category",
  SUM(oi."sale_price") AS "total_revenue"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY "year", "month", p."category"
ORDER BY "year", "month", p."category"
LIMIT 100;
Answer:
year,month,category,total_revenue
51076,10,Sleep & Lounge,38.5
51076,10,Socks,11.949999809265137
51082,1,Accessories,9.0
51082,1,Socks,4.889999866485596
51082,7,Sleep & Lounge,128.0
51082,7,Socks,22.989999771118164
51084,10,Maternity,62.0
51084,10,Socks & Hosiery,10.0
51090,8,Fashion Hoodies & Sweatshirts,16.959999084472656
51090,8,Sweaters,42.0
51095,2,Tops & Tees,130.0
51096,8,Socks,11.989999771118164
51111,6,Fashion Hoodies & Sweatshirts,49.9900016784668
51113,9,Fashion Hoodies & Sweatshirts,39.9900016784668
51113,9,Shorts,29.989999771118164
51122,6,Fashion Hoodies & Sweatshirts,293.3299865722656
51127,3,Accessories,17.950000762939453
51127,3,Shorts,54.0
51130,9,Active,84.94999694824217
51135,7,Suits,88.2699966430664
51139,3,Active,23.0
51139,11,Socks,9.359999656677246
51139,11,Swim,41.650001525878906
51144,5,Sweaters,63.59999847412109
51149,10,Shorts,24.979999542236328
51160,7,Intimates,10.0
51176,12,Active,43.9900016784668
51188,10,Outerwear & Coats,903.0
51193,4,Intimates,36.0
51200,2,Sleep & Lounge,64.0
51207,5,Jeans,39.9900016784668
51213,5,Maternity,38.0
51213,5,Shorts,37.0
51216,4,Jeans,200.0
51223,8,Active,25.0
51223,8,Plus,12.989999771118164
51227,9,Underwear,14.989999771118164
51235,9,Fashion Hoodies & Sweatshirts,32.9900016784668
51235,9,Shorts,27.700000762939453
51241,8,Socks,25.0
51254,5,Leggings,19.989999771118164
51254,10,Socks,17.0
51260,11,Accessories,50.0
51260,11,Fashion Hoodies & Sweatshirts,58.9099998474121
51260,11,Jeans,34.5
51260,11,Pants,95.0
51261,2,Sleep & Lounge,179.9499969482422
51261,5,Sweaters,155.92999267578125
51261,5,Tops & Tees,15.210000038146973
51264,3,Tops & Tees,46.220001220703125
51264,9,Underwear,14.989999771118164
51269,7,Shorts,158.0
51271,7,Pants & Capris,42.9900016784668
51276,11,Intimates,42.0
51276,11,Maternity,16.979999542236328
51286,7,Maternity,13.520000457763672
51287,8,Outerwear & Coats,41.9900016784668
51287,8,Sleep & Lounge,59.9900016784668
51287,8,Sweaters,33.970001220703125
51287,8,Swim,52.0
51303,10,Intimates,78.0
51305,1,Active,30.0
51308,12,Pants,55.0
51311,7,Shorts,84.38000106811523
51311,12,Accessories,12.75
51311,12,Pants & Capris,11.970000267028809
51311,12,Socks & Hosiery,25.0
51321,9,Intimates,39.93999862670898
51326,8,Dresses,28.899999618530277
51326,8,Intimates,30.950000762939453
51334,4,Swim,44.950000762939446
51336,2,Underwear,22.0
51339,2,Intimates,129.99000549316406
51340,4,Active,64.0
51340,4,Tops & Tees,24.0
51340,8,Jumpsuits & Rompers,15.8100004196167
51347,10,Maternity,69.0
51347,10,Sweaters,72.95999908447266
51348,4,Plus,16.989999771118164
51352,1,Pants,39.9900016784668
51352,7,Accessories,24.989999771118164
51361,4,Intimates,22.0
51361,4,Maternity,29.729999542236328
51362,11,Sleep & Lounge,27.590000152587887
51362,11,Suits & Sport Coats,299.989990234375
51363,4,Swim,36.0
51363,4,Underwear,25.0
51364,1,Maternity,48.09999847412109
51364,1,Sleep & Lounge,20.0
51365,11,Jeans,86.75
51365,11,Swim,62.9099998474121
51367,9,Tops & Tees,25.0
51372,3,Active,50.0
51374,11,Dresses,39.950000762939446
51375,3,Accessories,103.91000366210938
51380,6,Socks & Hosiery,15.0
51389,3,Intimates,44.0
51389,3,Swim,78.0
51391,12,Jeans,198.0
51393,9,Accessories,65.0
Query:
SELECT oi."order_id",
           oi."product_id",
           oi."sale_price",
           p."cost",
           (oi."sale_price" - p."cost") AS "profit"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    LIMIT 100;
Answer:
Too long, hard cut:
order_id,product_id,sale_price,cost,profit
14805,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
71201,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
81114,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
109826,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
49859,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
6684,14235,0.0199999995529651,0.0082999997779726,0.011699999774992502
82012,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
28060,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
63169,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
12239,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
50479,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
73832,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
108606,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
114916,14159,0.4900000095367431,0.1773800033208727,0.3126200062158704
35245,14202,1.5,0.617999997921288,0.882000002078712
42210,14202,1.5,0.617999997921288,0.882000002078712
5718,14202,1.5,0.617999997921288,0.882000002078712
6074,14202,1.5,0.617999997921288,0.882000002078712
25844,14202,1.5,0.617999997921288,0.882000002078712
33209,14202,1.5,0.617999997921288,0.882000002078712
57511,28700,1.5,0.6059999980498105,0.8940000019501895
108498,28700,1.5,0.6059999980498105,0.8940000019501895
5338,28700,1.5,0.6059999980498105,0.8940000019501895
33098,14202,1.5,0.617999997921288,0.882000002078712
76384,28700,1.5,0.6059999980498105,0.8940000019501895
101325,14202,1.5,0.617999997921288,0.882000002078712
7232,14202,1.5,0.617999997921288,0.882000002078712
46807,14202,1.5,0.617999997921288,0.882000002078712
120416,28700,1.5,0.6059999980498105,0.8940000019501895
61834,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
79332,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
14956,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
3229,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
69780,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
103440,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
100896,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
18515,13629,1.5099999904632568,0.6447699947352707,0.8652299957279861
18022,14298,1.7200000286102295,0.6450000075250863,1.0750000210851431
63483,14298,1.7200000286102295,0.6450000075250863,1.0750000210851431
90395,12536,1.75,1.0132499965839088,0.7367500034160912
105059,12536,1.75,1.0132499965839088,0.7367500034160912
122880,12536,1.75,1.0132499965839088,0.7367500034160912
106189,12536,1.75,1.0132499965839088,0.7367500034160912
21501,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
35298,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
111104,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
7274,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
11963,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
12507,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
83546,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
33669,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
34236,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
105655,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
111185,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
112616,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
54378,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
6059,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
28271,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
34370,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
55186,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
62067,13659,1.8200000524520876,0.7498400190880893,1.0701600333639982
88741,15332,1.8200000524520876,0.8918000261083245,0.9282000263437631
11966,9204,1.950000047683716,0.7722000156065448,1.177800032077171
72980,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
21690,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
80738,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
119820,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
29862,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
115326,9204,1.950000047683716,0.7722000156065448,1.177800032077171
121983,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
20438,3049,1.950000047683716,0.9165000273510814,1.0335000203326348
32712,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
100600,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
73565,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
18204,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
26774,14549,1.9800000190734863,0.7840800106805563,1.19592000839293
70016,14549,1.9800000
Query:
SELECT p."category", AVG(oi."sale_price") AS "average_sale_price"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."category"
    LIMIT 100;
Answer:
category,average_sale_price
Accessories,43.229780272777205
Intimates,33.32644906870921
Socks & Hosiery,16.765867551210764
Socks,20.299785083527553
Sleep & Lounge,49.21708581268445
Tops & Tees,41.579498303597504
Active,49.71962393214743
Maternity,51.90535684411696
Leggings,27.279730370799577
Shorts,46.110458505719286
Swim,57.18632826152689
Sweaters,75.17778851422908
Blazers & Jackets,91.61495353493824
Pants & Capris,53.83667080511382
Dresses,84.29710801082858
Jumpsuits & Rompers,47.03835599809079
Fashion Hoodies & Sweatshirts,54.835008855374426
Pants,59.8149358692474
Suits & Sport Coats,124.52451488062047
Outerwear & Coats,145.25342180796224
Suits,116.64817035716513
Clothing Sets,92.74435655197294
Plus,36.28723975198169
Underwear,27.134509654238798
Jeans,98.7687617963342
Skirts,50.870521194940764
Query:
SELECT p."category",
       SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
  ON oi."order_id" = o."order_id"
JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE o."status" = 'Complete'
GROUP BY p."category"
LIMIT 100;
Answer:
category,profit_to_cost_ratio
Active,1.3933093480818517
Maternity,1.267377858466376
Socks,0.6511641433165282
Swim,0.9611733369074564
Skirts,1.5043914224187411
Outerwear & Coats,1.2524790996281434
Clothing Sets,0.5916181100658034
Accessories,1.5012412265220278
Intimates,0.8836997718434241
Plus,0.9898840878228364
Sleep & Lounge,1.0835836151539882
Tops & Tees,0.7884344346457696
Socks & Hosiery,1.4707290417645116
Leggings,0.6584163919852335
Shorts,0.9983382218773785
Sweaters,1.0702803217131476
Underwear,1.1278962446073897
Blazers & Jackets,1.6270630871186818
Pants & Capris,0.8868288056438902
Dresses,1.2173172201801312
Jumpsuits & Rompers,0.888636541672922
Fashion Hoodies & Sweatshirts,0.9224773387967293
Pants,1.1753323193969252
Suits,0.6595882541158524
Jeans,0.8698405093412322
Suits & Sport Coats,1.497654196037367
Query:
SELECT "year", "month", "category", "total_revenue",
       LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_revenue",
       (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "revenue_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         SUM(oi."sale_price") AS "total_revenue"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
Answer:
Too long, hard cut:
year,month,category,total_revenue,previous_month_revenue,revenue_growth_percentage
51076,10,Sleep & Lounge,38.5,,
51076,10,Socks,11.949999809265137,,
51082,1,Accessories,9.0,,
51082,1,Socks,4.889999866485596,11.949999809265137,-59.07949837208989
51082,7,Sleep & Lounge,128.0,38.5,232.4675324675325
51082,7,Socks,22.989999771118164,4.889999866485596,370.14315744022497
51084,10,Maternity,62.0,,
51084,10,Socks & Hosiery,10.0,,
51090,8,Fashion Hoodies & Sweatshirts,16.959999084472656,,
51090,8,Sweaters,42.0,,
51095,2,Tops & Tees,130.0,,
51096,8,Socks,11.989999771118164,22.989999771118164,-47.84689042850301
51111,6,Fashion Hoodies & Sweatshirts,49.9900016784668,16.959999084472656,194.75238429838132
51113,9,Fashion Hoodies & Sweatshirts,39.9900016784668,49.9900016784668,-20.0040001285047
51113,9,Shorts,29.989999771118164,,
51122,6,Fashion Hoodies & Sweatshirts,293.3299865722656,39.9900016784668,633.5083127296127
51127,3,Accessories,17.950000762939453,9.0,99.44445292154947
51127,3,Shorts,54.0,29.989999771118164,80.0600213808759
51130,9,Active,84.94999694824217,,
51135,7,Suits,88.2699966430664,,
51139,3,Active,23.0,84.94999694824217,-72.92524917450756
51139,11,Socks,9.359999656677246,11.989999771118164,-21.934947161351356
51139,11,Swim,41.650001525878906,,
51144,5,Sweaters,63.59999847412109,42.0,51.42856779552639
51149,10,Shorts,24.979999542236328,54.0,-53.74074158845124
51160,7,Intimates,10.0,,
51176,12,Active,43.9900016784668,23.0,91.26087686289912
51188,10,Outerwear & Coats,903.0,,
51193,4,Intimates,36.0,10.0,260.0
51200,2,Sleep & Lounge,64.0,128.0,-50.0
51207,5,Jeans,39.9900016784668,,
51213,5,Maternity,38.0,62.0,-38.70967741935484
51213,5,Shorts,37.0,24.979999542236328,48.1184975101388
51216,4,Jeans,200.0,39.9900016784668,400.125010266486
51223,8,Active,25.0,43.9900016784668,-43.168904191614175
51223,8,Plus,12.989999771118164,,
51227,9,Underwear,14.989999771118164,,
51235,9,Fashion Hoodies & Sweatshirts,32.9900016784668,293.3299865722656,-88.75328020023645
51235,9,Shorts,27.700000762939453,37.0,-25.13513307313661
51241,8,Socks,25.0,9.359999656677246,167.09402689096763
51254,5,Leggings,19.989999771118164,,
51254,10,Socks,17.0,25.0,-32.0
51260,11,Accessories,50.0,17.950000762939453,178.5515201939864
51260,11,Fashion Hoodies & Sweatshirts,58.9099998474121,32.9900016784668,78.56925386537273
51260,11,Jeans,34.5,200.0,-82.75
51260,11,Pants,95.0,,
51261,2,Sleep & Lounge,179.9499969482422,64.0,181.17187023162842
51261,5,Sweaters,155.92999267578125,63.59999847412109,145.1729503409176
51261,5,Tops & Tees,15.210000038146973,130.0,-88.29999997065617
51264,3,Tops & Tees,46.220001220703125,15.210000038146973,203.87903421947712
51264,9,Underwear,14.989999771118164,14.989999771118164,0.0
51269,7,Shorts,158.0,27.700000762939453,470.3970962029441
51271,7,Pants & Capris,42.9900016784668,,
51276,11,Intimates,42.0,36.0,16.666666666666664
51276,11,Maternity,16.979999542236328,38.0,-55.31579067832545
51286,7,Maternity,13.520000457763672,16.979999542236328,-20.37690917403265
51287,8,Outerwear & Coats,41.9900016784668,903.0,-95.34994444313767
51287,8,Sleep & Lounge,59.9900016784668,179.9499969482422,-66.66296043576966
51287,8,Sweaters,33.970001220703125,155.92999267578125,-78.21458166079984
51287,8,Swim,52.0,41.650001525878906,24.849935402019618
51303,10,Intimates,78.0,42.0,85.71428571428571
51305,1,Active,30.0,25.0,20.0
51308,12,Pants,55.0,95.0,-42.10526315789473
51311,7,Shorts,84.38000106811523,158.0,-46.594936032838454
51311,12,Accessories,12.75,50.0,-74.5
51311,12,Pants & Capris,11.970000267028809,42.9900016784668,-72.1563158881558
51311,12,Socks & Hosiery,25.0,10.0,150.0
51321,9,Intimates,39.93999862670898,78.0,-48.79487355550131
51326,8,Dresses,28.899999618530277,,
51326,8,Intimates,30.950000762939453,39.93999862670898,-22.508758570055797
51334,4,Swim,44.950000762939446,52.0,-13.557690840501065
51336,2,Underwear,22.0,14.989999771118164,46.7645119140581
51339,2,Intimates,129.99000549316406,30.950000762939453,320.0000073952126
51340,4,Active,64.0,30.0,113.33333333333333
51340,4,Tops & Tees,24.0,46.220001220703125,-48.074428026518994
51340,8,Jumpsuits & Rompers,15.8100004196167,,
51347,10,Maternity,69.0,13.520000457763672,410.3550123060662
51347,10,Sweaters,72.95999908447266,33.970001220703125,114.77773465609107
51348,4,Plus,16.989999771118164,12.989999771118164,30.792918171511907
51352,1,Pants,39.9900016784668,55.0,-27.29090603915128
51352,7,Accessories,24.989999771118164,12.75,95.99999820484835
51361,4,Intimates,22.0,129.99000549316406,-83.07562191682733
51361,4,Maternity,29.729999542236328,69.0,-56.913044141686484
51362,11,Sleep & Lounge,27.590000152587887,59.9900016784668,-54.00900253268167
51362,11,Suits & Sport Coats,299.989990234375,,
51363,4,Swim,36.0,44.950000762939446,-19.911013595173458
51363,4,Underwear,25.0,22.0,13.636363636363635
51364,1,Maternity,48.09999847412109,29.729999542236328,61.78943563650975
51364,1,Sleep & Lounge,20.0,27.590000152587887,-27.5099677803951
51365,11,Jeans,86.75,34.5,151.44927536231884
51365,11,S
Query:
SELECT "year", "month", "category", "total_orders",
       LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month") AS "previous_month_orders",
       (("total_orders" - LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100
         AS "orders_growth_percentage"
FROM (
  SELECT EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "year",
         EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1000)) AS "month",
         p."category",
         COUNT(DISTINCT o."order_id") AS "total_orders"
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
    ON oi."order_id" = o."order_id"
  JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
    ON oi."product_id" = p."id"
  WHERE o."status" = 'Complete'
  GROUP BY "year", "month", p."category"
)
ORDER BY "year", "month", "category"
LIMIT 100;
Answer:
year,month,category,total_orders,previous_month_orders,orders_growth_percentage
51076,10,Sleep & Lounge,1,,
51076,10,Socks,1,,
51082,1,Accessories,1,,
51082,1,Socks,1,1.0,0.000000
51082,7,Sleep & Lounge,1,1.0,0.000000
51082,7,Socks,1,1.0,0.000000
51084,10,Maternity,1,,
51084,10,Socks & Hosiery,1,,
51090,8,Fashion Hoodies & Sweatshirts,1,,
51090,8,Sweaters,1,,
51095,2,Tops & Tees,1,,
51096,8,Socks,1,1.0,0.000000
51111,6,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51113,9,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51113,9,Shorts,1,,
51122,6,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51127,3,Accessories,1,1.0,0.000000
51127,3,Shorts,1,1.0,0.000000
51130,9,Active,1,,
51135,7,Suits,1,,
51139,3,Active,1,1.0,0.000000
51139,11,Socks,1,1.0,0.000000
51139,11,Swim,1,,
51144,5,Sweaters,1,1.0,0.000000
51149,10,Shorts,1,1.0,0.000000
51160,7,Intimates,1,,
51176,12,Active,1,1.0,0.000000
51188,10,Outerwear & Coats,1,,
51193,4,Intimates,1,1.0,0.000000
51200,2,Sleep & Lounge,1,1.0,0.000000
51207,5,Jeans,1,,
51213,5,Maternity,1,1.0,0.000000
51213,5,Shorts,1,1.0,0.000000
51216,4,Jeans,1,1.0,0.000000
51223,8,Active,1,1.0,0.000000
51223,8,Plus,1,,
51227,9,Underwear,1,,
51235,9,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51235,9,Shorts,1,1.0,0.000000
51241,8,Socks,1,1.0,0.000000
51254,5,Leggings,1,,
51254,10,Socks,1,1.0,0.000000
51260,11,Accessories,1,1.0,0.000000
51260,11,Fashion Hoodies & Sweatshirts,1,1.0,0.000000
51260,11,Jeans,1,1.0,0.000000
51260,11,Pants,1,,
51261,2,Sleep & Lounge,1,1.0,0.000000
51261,5,Sweaters,1,1.0,0.000000
51261,5,Tops & Tees,1,1.0,0.000000
51264,3,Tops & Tees,1,1.0,0.000000
51264,9,Underwear,1,1.0,0.000000
51269,7,Shorts,1,1.0,0.000000
51271,7,Pants & Capris,1,,
51276,11,Intimates,1,1.0,0.000000
51276,11,Maternity,1,1.0,0.000000
51286,7,Maternity,1,1.0,0.000000
51287,8,Outerwear & Coats,1,1.0,0.000000
51287,8,Sleep & Lounge,1,1.0,0.000000
51287,8,Sweaters,1,1.0,0.000000
51287,8,Swim,1,1.0,0.000000
51303,10,Intimates,1,1.0,0.000000
51305,1,Active,1,1.0,0.000000
51308,12,Pants,1,1.0,0.000000
51311,7,Shorts,1,1.0,0.000000
51311,12,Accessories,1,1.0,0.000000
51311,12,Pants & Capris,1,1.0,0.000000
51311,12,Socks & Hosiery,1,1.0,0.000000
51321,9,Intimates,1,1.0,0.000000
51326,8,Dresses,1,,
51326,8,Intimates,1,1.0,0.000000
51334,4,Swim,1,1.0,0.000000
51336,2,Underwear,1,1.0,0.000000
51339,2,Intimates,1,1.0,0.000000
51340,4,Active,1,1.0,0.000000
51340,4,Tops & Tees,1,1.0,0.000000
51340,8,Jumpsuits & Rompers,1,,
51347,10,Maternity,1,1.0,0.000000
51347,10,Sweaters,1,1.0,0.000000
51348,4,Plus,1,1.0,0.000000
51352,1,Pants,1,1.0,0.000000
51352,7,Accessories,1,1.0,0.000000
51361,4,Intimates,1,1.0,0.000000
51361,4,Maternity,1,1.0,0.000000
51362,11,Sleep & Lounge,1,1.0,0.000000
51362,11,Suits & Sport Coats,1,,
51363,4,Swim,1,1.0,0.000000
51363,4,Underwear,1,1.0,0.000000
51364,1,Maternity,1,1.0,0.000000
51364,1,Sleep & Lounge,1,1.0,0.000000
51365,11,Jeans,1,1.0,0.000000
51365,11,Swim,1,1.0,0.000000
51367,9,Tops & Tees,1,1.0,0.000000
51372,3,Active,1,1.0,0.000000
51374,11,Dresses,1,1.0,0.000000
51375,3,Accessories,1,1.0,0.000000
51380,6,Socks & Hosiery,1,1.0,0.000000
51389,3,Intimates,1,1.0,0.000000
51389,3,Swim,1,1.0,0.000000
51391,12,Jeans,1,1.0,0.000000
51393,9,Accessories,1,1.0,0.000000
Query:
SELECT p."name", p."category", SUM(oi."sale_price") AS "total_revenue"
    FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."name", p."category"
    ORDER BY "total_revenue" DESC
    LIMIT 5;
Answer:
name,category,total_revenue
The North Face Apex Bionic Soft Shell Jacket - Men's,Fashion Hoodies & Sweatshirts,13545.0
Canada Goose Women's Expedition Parka,Outerwear & Coats,11130.0
The North Face Apex Bionic Soft Shell Jacket - Men's,Active,10836.0
The North Face Nuptse 2 Jacket - Noah Green/TNF Black,Outerwear & Coats,9933.0
Mens Nike AirJordan Varsity Hoodie Jacket Grey / Black 451582-066,Outerwear & Coats,9933.0
End Exploring Related Columns
Task: Generate a monthly report for each product category , where each row corresponds to orders that have a status of 'Complete' and were delivered before the year 2022, grouping by the month and year of delivery. For each category, calculate the total revenue (the sum of sale_price), the total number of completed orders, and compute the month-over-month percentage growth for both revenue and orders by comparing each month’s totals to the previous month’s. Then, for the same orders, aggregate and show the total cost (from product costs), total profit (revenue minus total cost), and finally the profit-to-cost ratio for each month.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year,Month,Category,Total_Revenue,Total_Completed_Orders,Revenue_MoM_Growth(%),Orders_MoM_Growth(%),Total_Cost,Total_Profit,Profit_to_Cost_Ratio
year:int,month:int,category:str,total_revenue:float,total_orders:int,revenue_mom_growth:float,orders_mom_growth:float,total_cost:float,total_profit:float,profit_to_cost_ratio:float
...
```

This report displays, for each product category and for each month and year before 2022, the total revenue from completed orders, the total number of completed orders, the month-over-month growth percentages for both revenue and orders compared to the previous month, the total cost of products sold, the total profit (calculated as revenue minus total cost), and the profit-to-cost ratio for that period..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'THELOOK_ECOMMERCE': {'THELOOK_ECOMMERCE': ['DISTRIBUTION_CENTERS', 'ORDERS', 'USERS', 'EVENTS', 'INVENTORY_ITEMS', 'PRODUCTS', 'ORDER_ITEMS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-12 07:07:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:07:17 - root - INFO - ```sql
SELECT
    "year",
    "month",
    "category",
    "total_revenue",
    "total_completed_orders",
    ROUND(
        (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month")) 
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        2
    ) AS "revenue_mom_growth",
    ROUND(
        (("total_completed_orders" - LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month")) 
         / NULLIF(LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        2
    ) AS "orders_mom_growth",
    "total_cost",
    "total_profit",
    "profit_to_cost_ratio"
FROM (
    SELECT
        EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "year",
        EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "month",
        p."category",
        SUM(oi."sale_price") AS "total_revenue",
        COUNT(DISTINCT o."order_id") AS "total_completed_orders",
        SUM(p."cost") AS "total_cost",
        SUM(oi."sale_price" - p."cost") AS "total_profit",
        SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
    FROM
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        o."status" = 'Complete'
        AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6) < '2022-01-01'
    GROUP BY
        "year", "month", p."category"
) base_data
ORDER BY
    "year", "month", "category";
```
2025-02-12 07:07:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:07:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:07:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:07:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 796
2025-02-12 07:07:19 - snowflake.connector.connection - INFO - closed
2025-02-12 07:07:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:07:19 - root - INFO - itercount: 1
2025-02-12 07:07:19 - root - INFO - 0
2025-02-12 07:07:19 - root - INFO - results: 
year,month,category,total_revenue,total_completed_orders,revenue_mom_growth,orders_mom_growth,total_cost,total_profit,profit_to_cost_ratio
2019,2,Accessories,26.950000762939453,2,,,11.803900280861555,15.146100482077898,1.2831437170504798
2019,2,Active,84.94999694824217,1,,,34.82949891966953,50.12049802857264,1.439024378276878
2019,2,Fashion Hoodies & Sweatshirts,400.2699890136719,4,,,230.10690333794258,170.1630856757293,0.7394957874246049
2019,2,Maternity,62.0,1,,,28.458000045269728,33.54199995473027,1.178649234007068
2019,2,Shorts,83.98999977111816,2,,,40.1587299695839,43.83126980153426,1.0914505970366077
2019,2,Sleep & Lounge,166.5,2,,,60.15849962644279,106.34150037355721,1.7676887062325368
2019,2,Socks,51.81999921798706,4,,,30.17878962317765,21.64120959480941,0.717099985288632
2019,2,Socks & Hosiery,10.0,1,,,4.219999983906746,5.780000016093254,1.3696682554823871
2019,2,Sweaters,42.0,1,,,21.58800001814961,20.41199998185039,0.9455252901931385
2019,2,Tops & Tees,130.0,1,,,74.35999983921647,55.64000016078353,0.7482517520318731
2019,3,Active,66.9900016784668,2,-21.14,100.00,26.697080748638214,40.29292092982858,1.5092631778432881
2019,3,Intimates,46.0,2,,,24.695999963209033,21.304000036790967,0.8626498246083855
2019,3,Jeans,239.9900016784668,2,,,137.73219094341755,102.25781073504925,0.7424394401527984
2019,3,Maternity,38.0,1,-38.71,0.00,17.974000044167042,20.025999955832958,1.1141648996674969
2019,3,Outerwear & Coats,903.0,1,,,419.89500154741114,483.10499845258886,1.1505376264833687
2019,3,Shorts,61.97999954223633,2,-26.21,0.00,30.00771983284384,31.972279709392488,1.0654684823602762
2019,3,Sleep & Lounge,64.0,1,-61.56,-50.00,40.25600004196167,23.74399995803833,0.589825117579697
2019,3,Socks,9.359999656677246,1,-81.94,-75.00,5.718959803619384,3.641039853057862,0.6366612072974425
2019,3,Suits,88.2699966430664,1,,,52.167568181783246,36.10242846128316,0.6920473719511047
2019,3,Sweaters,63.59999847412109,1,51.43,0.00,30.1463992426157,33.453599231505386,1.1097046437378346
2019,3,Swim,41.650001525878906,1,,,25.281550997271015,16.36845052860789,0.6474464533593988
2019,4,Accessories,50.0,1,85.53,-50.00,22.499999962747097,27.500000037252903,1.2222222259015212
2019,4,Active,25.0,1,-62.68,-50.00,9.325000084936617,15.674999915063383,1.680965123033554
2019,4,Fashion Hoodies & Sweatshirts,91.9000015258789,2,-77.04,-50.00,51.9729608638072,39.9270406620717,0.7682271704069104
2019,4,Intimates,42.0,1,-8.7,-50.00,21.16799994930625,20.83200005069375,0.9841269888786299
2019,4,Jeans,34.5,1,-85.62,-50.00,19.802999968640503,14.697000031359497,0.7421602815044827
2019,4,Leggings,19.989999771118164,1,,,11.49424989073351,8.495749880384654,0.7391304314023831
2019,4,Maternity,30.5,2,-19.74,100.00,13.275700017678737,17.224299982321263,1.297430640899111
2019,4,Outerwear & Coats,41.9900016784668,1,-95.35,0.00,20.155200824435056,21.83480085403174,1.083333331393078
2019,4,Pants,95.0,1,,,46.2650001514703,48.7349998485297,1.0533880836263414
2019,4,Pants & Capris,42.9900016784668,1,,,22.397790862309783,20.592210816157014,0.9193857975881391
2019,4,Plus,12.989999771118164,1,,,6.884699869982152,6.105299901136012,0.8867924552173454
2019,4,Shorts,185.70000076293945,2,199.61,0.00,94.07300041953474,91.62700034340472,0.973998915042343
2019,4,Sleep & Lounge,239.93999862670898,2,274.91,100.00,103.23418890256569,136.7058097241433,1.3242299976141503
2019,4,Socks,42.0,2,348.72,100.00,25.677000034600496,16.322999965399504,0.6357051035324918
2019,4,Sweaters,189.89999389648438,2,198.58,100.00,79.71955737863719,110.18043651784718,1.3821004549050937
2019,4,Swim,52.0,1,24.85,0.00,31.98000006005168,20.01999993994832,0.6260162571092869
2019,4,Tops & Tees,61.4300012588501,2,-52.75,100.00,33.98246059634998,27.447540662500117,0.8076972703220975
2019,4,Underwear,29.979999542236328,2,,,13.371079809686243,16.608919732550085,1.2421524640454464
2019,5,Accessories,141.65000343322754,3,183.3,200.00,54.78807118436351,86.86193224886404,1.5854168685108665
2019,5,Active,144.0,3,476.0,200.00,56.24600021960214,87.75399978039786,1.560182047394989
2019,5,Dresses,68.85000038146973,2,,,30.49630012205504,38.35370025941469,1.2576509316183293
2019,5,Intimates,300.8800048828125,5,616.38,400.00,163.69096263941466,137.18904224339784,0.8380978401697327
2019,5,Jeans,86.75,1,151.45,0.00,46.23774990369566,40.51225009630434,0.8761726117876317
2019,5,Jumpsuits & Rompers,15.8100004196167,1,,,8.015670201437473,7.794330218179226,0.9723865905537689
2019,5,Maternity,146.82999801635742,3,381.41,50.00,65.57566925949037,81.25432875686704,1.239092634119134
2019,5,Pants,94.9900016784668,2,-0.01,100.00,44.724950980293755,50.26505069817304,1.1238704480709283
2019,5,Pants & Capris,11.970000267028809,1,-72.16,0.00,6.679260151320845,5.290740115707964,0.7921146947183518
2019,5,Plus,16.989999771118164,1,30.79,0.00,9.259549905639886,7.730449865478278,0.8348623793009365
2019,5,Shorts,84.38000106811523,1,-54.56,-50.00,42.223620457333624,42.15638061078161,0.9984075300548906
2019,5,Sleep & Lounge,47.59000015258789,2,-80.17,0.00,22.638660046156645,24.951340106431243,1.1021562254815174
2019,5,Socks & Hosiery,40.0,2,300.0,100.00,14.814999895170331,25.18500010482967,1.6999662695265993
2019,5,Suits & Sport Coats,299.989990234375,1,,,125.69580527790504,174.29418495646996,1.3866348568364486
2019,5,Sweaters,72.95999908447266,1,-61.58,-50.00,34.5100795158577,38.44991956861496,1.1141649079929494
2019,5,Swim,143.86000061035156,3,176.65,200.00,76.41246068592272,67.44753992442882,0.882677240321545
2019,5,Tops & Tees,49.0,2,-20.23,0.00,25.73399992659688,23.26600007340312,0.9040957542460002
2019,5,Underwear,47.0,2,56.77,0.00,23.09899999492336,23.90100000507664,1.034720118201201
2019,6,Accessories,153.0999984741211,4,8.08,33.33,59.93658919489741,93.16340927922369,1.5543662148722166
2019,6,Active,100.0,2,-30.56,-33.33,39.570000153034925,60.429999846965075,1.5271670359680358
2019,6,Blazers & Jackets,53.180000305175774,1,,,18.13438020391285,35.04562010126293,1.932551303501464
2019,6,Dresses,255.97999954223633,2,271.79,0.00,109.95543970878184,146.02455983345448,1.3280339764926783
2019,6,Fashion Hoodies & Sweatshirts,161.18000030517578,3,75.39,50.00,88.04046018625466,73.1395401189211,0.830749180140474
2019,6,Intimates,148.98999977111816,5,-50.48,0.00,80.20079976015239,68.78920001096577,0.8577121452240624
2019,6,Jeans,362.9900016784668,3,318.43,200.00,195.81501029584348,167.17499138262332,0.8537394101200417
2019,6,Leggings,6.980000019073486,1,-65.08,0.00,4.020480019931197,2.959519999142289,0.7361111072485658
2019,6,Maternity,73.41999816894531,1,-50.0,-66.67,30.689559341835377,42.730438827109936,1.3923444892498238
2019,6,Outerwear & Coats,1182.9399948120117,4,2717.19,300.00,498.4235495672066,684.5164452448051,1.3733629677794872
2019,6,Pants,79.95000076293945,2,-15.83,0.00,35.13940036381632,44.81060039912313,1.2752238209865818
2019,6,Shorts,167.45000076293945,3,98.45,200.00,84.3871503917262,83.06285037121327,0.9843068522356129
2019,6,Sleep & Lounge,14.989999771118164,1,-68.5,-50.00,5.876079882245586,9.113919888872578,1.551020420333297
2019,6,Socks,119.9499969482422,1,185.6,-50.00,74.96874831607565,44.981248632166555,0.5999999952316286
2019,6,Suits & Sport Coats,79.94999694824217,1,-73.35,0.00,34.05869862370491,45.89129832453726,1.3474178456306853
2019,6,Sweaters,272.9799995422363,2,274.15,100.00,136.59576972619772,136.3842298160386,0.9984513436207935
2019,6,Swim,359.2699966430664,5,149.74,66.67,198.9106884289863,160.3593082140801,0.8061874878650901
2019,6,Tops & Tees,57.50000190734863,2,17.35,0.00,33.97233098310426,23.52767092424438,0.6925539179500397
2019,6,Underwear,170.0900001525879,6,261.89,200.00,77.47823010156348,92.61177005102441,1.195326350764891
2019,7,Active,107.98999977111816,3,7.99,50.00,45.359810094130516,62.63018967698765,1.3807418846555508
2019,7,Blazers & Jackets,249.0,1,368.22,0.00,84.41100038588047,164.58899961411953,1.949852493889535
2019,7,Dresses,39.950000762939446,1,-84.39,-50.00,18.65665036343634,21.293350399503105,1.1413276223064253
2019,7,Fashion Hoodies & Sweatshirts,284.03999519348145,5,76.23,66.67,146.88776766553104,137.1522275279504,0.9337212329365041
2019,7,Intimates,224.5900046825409,5,50.74,0.00,113.70957233994298,110.8804323425979,0.9751195968894584
2019,7,Jeans,836.9500045776367,6,130.57,100.00,444.8680318977807,392.081972679856,0.8813444540109063
2019,7,Jumpsuits & Rompers,9.920000076293944,1,-37.25,0.00,5.465920032577515,4.454080043716429,0.8148820358090857
2019,7,Leggings,11.829999923706056,1,69.48,0.00,7.003359967966899,4.826639955739157,0.6891891860215702
2019,7,Maternity,34.97999954223633,1,-52.36,0.00,13.677179912753104,21.302819629483224,1.5575447398787008
2019,7,Outerwear & Coats,165.9499969482422,2,-85.97,-50.00,73.11754892709553,92.83244802114665,1.2696329319478223
2019,7,Pants,135.0,1,68.86,-50.00,56.024999879300594,78.9750001206994,1.409638559408156
2019,7,Pants & Capris,170.89999961853027,4,1327.74,300.00,92.61449962123484,78.28549999729545,0.8452834093739031
2019,7,Plus,98.05999946594238,2,477.16,100.00,51.371239695025835,46.68875977091655,0.9088501669045241
2019,7,Shorts,171.11999988555908,5,2.19,66.67,87.8599898818361,83.26001000372298,0.947644202050334
2019,7,Sleep & Lounge,166.48000144958496,4,1010.61,300.00,77.15549036873877,89.32451108084621,1.1577207358018164
2019,7,Socks,24.210000038146973,2,-79.82,100.00,14.482440074366927,9.727559963780045,0.6716796281447943
2019,7,Socks & Hosiery,12.0,1,-70.0,-50.00,4.811999982688576,7.188000017311424,1.4937655950063662
2019,7,Suits & Sport Coats,71.2400016784668,2,-10.89,100.00,26.586000506073233,44.65400117239356,1.6796058196942005
2019,7,Sweaters,100.8000030517578,1,-63.07,-50.00,55.23840171442032,45.56160133733748,0.8248175168588078
2019,7,Swim,49.5,1,-86.22,-80.00,29.056500060483813,20.443499939516187,0.703577509230676
2019,7,Tops & Tees,269.9400005340576,4,369.46,100.00,152.1400199194881,117.79998061456949,0.7742866122727522
2019,7,Underwear,103.19000053405762,4,-39.33,-33.33,47.60173036493033,55.588270169127284,1.1677783505551067
2019,8,Accessories,212.15999794006348,6,38.58,50.00,83.54372894833747,128.61626899172597,1.5395083582067646
2019,8,Active,222.5400047302246,4,106.07,33.33,92.30288236188225,130.23712236834234,1.410975681753201
2019,8,Dresses,39.950000762939446,1,0.0,0.00,17.57800031485781,22.372000448081636,1.2727272754211807
2019,8,Fashion Hoodies & Sweatshirts,367.0799961090088,7,29.24,40.00,193.0866277653248,173.99336834368398,0.9011155788331103
2019,8,Intimates,146.39000129699707,5,-34.82,0.00,77.3077405804044,69.08226071659266,0.8936008244186521
2019,8,Jeans,680.2299995422363,8,-18.73,33.33,351.3453592144077,328.8846403278286,0.9360722482949533
2019,8,Leggings,37.69000053405762,2,218.6,100.00,21.61623031678468,16.073770217272937,0.7435972869326755
2019,8,Maternity,35.720001220703125,1,2.12,0.00,15.752520587930942,19.967480632772183,1.2675736890050855
2019,8,Outerwear & Coats,554.2500019073486,5,233.99,150.00,228.37034048639597,325.87966142095263,1.4269789182206227
2019,8,Pants,109.9900016784668,2,-18.53,100.00,53.710171009844096,56.2798306686227,1.0478430734898914
2019,8,Pants & Capris,191.0,2,11.76,-50.00,97.7729999627918,93.2270000372082,0.9535045469882931
2019,8,Plus,96.93000221252441,3,-1.15,50.00,46.033311043201536,50.89669116932288,1.105649148755716
2019,8,Shorts,363.44000244140625,6,112.39,20.00,179.94222129963592,183.49778114177033,1.019759452875786
2019,8,Sleep & Lounge,338.8499946594238,6,103.54,50.00,157.3609568293476,181.48903783007623,1.1533295265031636
2019,8,Socks,12.949999809265137,1,-46.51,-50.00,7.329699887412786,5.620299921852351,0.7667844534131651
2019,8,Socks & Hosiery,35.989999771118164,2,199.92,100.00,14.460239885704816,21.52975988541335,1.488893687489746
2019,8,Suits,200.0,1,126.58,0.00,129.60000038146973,70.39999961853027,0.5432098720008653
2019,8,Suits & Sport Coats,334.4000015258789,2,369.4,0.00,131.1552002020359,203.244801323843,1.5496511080823165
2019,8,Sweaters,666.7799987792969,9,561.49,800.00,337.45451939233254,329.32547938696433,0.9759107093305299
2019,8,Swim,272.2899971008301,4,450.08,300.00,122.08003933405413,150.20995776677594,1.2304219312687834
2019,8,Tops & Tees,203.22000217437744,6,-24.72,50.00,110.20736107589804,93.0126410984794,0.8439784801164334
2019,8,Underwear,61.0,3,-40.89,-25.00,27.405000003054738,33.59499999694526,1.2258711911403228
2019,9,Accessories,222.43000030517578,5,4.84,-16.67,83.90705954143877,138.522940763737,1.6509092503155276
2019,9,Active,150.67999649047852,3,-32.29,-25.00,64.99866883472905,85.68132765574947,1.3182012676845714
2019,9,Blazers & Jackets,10.949999809265137,1,-95.6,0.00,4.566149955055117,6.38384985421002,1.3980815166051552
2019,9,Dresses,107.11999893188477,2,168.14,100.00,47.481249301414934,59.63874963046983,1.2560484508711653
2019,9,Fashion Hoodies & Sweatshirts,382.2999973297119,7,4.15,0.00,203.35633920980416,178.94365811990775,0.879951216742205
2019,9,Intimates,360.1900005340576,10,146.05,100.00,190.0414498853862,170.14855064867137,0.8953233663039709
2019,9,Jeans,444.9900016784668,6,-34.58,-25.00,248.36023045477685,196.62977122368994,0.7917119857057535
2019,9,Leggings,74.98999977111816,3,98.97,50.00,44.65763998748422,30.332359783633947,0.679219945168059
2019,9,Maternity,52.970001220703125,2,48.29,100.00,24.837670619839727,28.132330600863398,1.1326477040239022
2019,9,Outerwear & Coats,305.9499969482422,3,-44.8,-40.00,139.237299169977,166.71269777826518,1.1973278623764956
2019,9,Pants,72.95000076293945,2,-33.68,0.00,30.829900399877133,42.12010036306232,1.3662094206191526
2019,9,Pants & Capris,69.0,1,-63.87,-50.00,38.846999941393726,30.153000058606274,0.7761989369602904
2019,9,Plus,96.98999977111816,2,0.06,-33.33,51.85703988900225,45.13295988211591,0.8703342878560184
2019,9,Shorts,181.5,4,-50.06,-33.33,87.2600000720704,94.2399999279296,1.079990830278412
2019,9,Skirts,155.0300006866455,3,,,64.11301999570199,90.91698069094352,1.418073594053726
2019,9,Sleep & Lounge,152.9300022125244,4,-54.87,-33.33,67.69121067421227,85.23879153831214,1.259229827466874
2019,9,Socks,74.65000057220459,2,476.45,100.00,47.15745053356905,27.492550038635535,0.5829948338505907
2019,9,Sweaters,220.03999710083008,5,-67.0,-44.44,102.2270483306216,117.81294877020846,1.1524635670706163
2019,9,Swim,89.50000190734863,3,-67.13,-25.00,43.7519710453802,45.74803086196843,1.04562216898795
2019,9,Tops & Tees,299.83999824523926,6,47.54,0.00,161.08012863615983,138.75986960907943,0.861433814238525
2019,9,Underwear,79.0,3,29.51,0.00,38.15200004912913,40.84799995087087,1.0706647069162836
2019,10,Accessories,61.80000114440918,3,-72.22,-40.00,25.23875036361627,36.56125078079291,1.4486157299411684
2019,10,Active,122.98000144958496,4,-18.38,33.33,50.27888071088761,72.70112073869734,1.4459574220981877
2019,10,Blazers & Jackets,112.04999923706055,2,923.29,100.00,42.81844996359497,69.23154927346557,1.6168625751826025
2019,10,Dresses,184.57999801635742,2,72.31,0.00,76.49916903250099,108.08082898385643,1.412836640590669
2019,10,Fashion Hoodies & Sweatshirts,393.48000717163086,6,2.92,-14.29,199.47312371101148,194.00688346061938,0.9725966077599939
2019,10,Intimates,132.98999977111816,5,-63.08,-50.00,67.90991978039399,65.08007999072417,0.9583295076945915
2019,10,Jeans,463.5,5,4.16,-16.67,237.36099985428154,226.13900014571846,0.9527218046964228
2019,10,Jumpsuits & Rompers,10.9399995803833,1,10.28,0.00,5.360599796833098,5.579399783550203,1.0408163255996776
2019,10,Leggings,54.60000038146972,2,-27.19,-33.33,33.41370032267571,21.18630005879401,0.6340602762997861
2019,10,Outerwear & Coats,279.98999786376953,3,-8.49,0.00,119.34563921350579,160.64435865026374,1.3460429698891283
2019,10,Pants,164.94000244140625,3,126.1,50.00,78.03187130621366,86.90813113519258,1.1137517232432705
2019,10,Pants & Capris,34.900001525878906,1,-49.42,0.00,18.531900788497087,16.36810073738182,0.8832391735844843
2019,10,Plus,350.9000005722046,4,261.79,100.00,171.10617053220042,179.79383004000417,1.050773502093946
2019,10,Shorts,94.84000253677368,5,-47.75,25.00,46.28212120497517,48.55788133179851,1.0491714741583344
2019,10,Skirts,163.9600067138672,1,5.76,-66.67,72.47032263036844,91.48968408349874,1.2624434494398167
2019,10,Sleep & Lounge,217.93999862670898,6,42.51,50.00,92.21142913523659,125.7285694914724,1.3634814108246802
2019,10,Socks,41.43000030517578,3,-44.5,50.00,25.314930296865924,16.115070008309857,0.6365836215754842
2019,10,Socks & Hosiery,12.989999771118164,1,-63.91,-50.00,4.6114498761624105,8.378549894955754,1.8169014344634438
2019,10,Suits,122.59999847412108,1,-38.7,0.00,71.35319938962459,51.24679908449649,0.7182130517324531
2019,10,Suits & Sport Coats,633.9499969482422,4,89.58,100.00,272.8679982916266,361.0819986566156,1.3232845218834004
2019,10,Sweaters,256.7100067138672,5,16.67,0.00,116.5018029967491,140.20820371711807,1.2034852689879012
2019,10,Swim,351.4400005340576,6,292.67,100.00,163.69010087469928,187.74989965935833,1.146983835040069
2019,10,Tops & Tees,348.5499973297119,7,16.25,16.67,188.34368804151768,160.20630928819423,0.8506062027036395
2019,10,Underwear,68.0,3,-13.92,0.00,31.290000073611736,36.709999926388264,1.1732182754881952
2019,11,Accessories,238.89000320434567,3,286.55,0.00,104.48654122759311,134.40346197675257,1.286323199118959
2019,11,Active,71.93999862670898,2,-41.5,-50.00,30.304579578725697,41.63541904798328,1.3738985865097435
2019,11,Blazers & Jackets,14.81999969482422,1,-86.77,-50.00,6.268859932302831,8.55113976252139,1.3640661707016597
2019,11,Dresses,521.9799995422363,4,182.79,100.00,221.54418018885673,300.4358193533796,1.3560989013445137
2019,11,Fashion Hoodies & Sweatshirts,535.6499938964844,7,36.13,16.67,290.5747672068807,245.0752266896036,0.8434153765151852
2019,11,Intimates,219.9600019454956,10,65.4,100.00,119.40255090237297,100.55745104312264,0.8421717147847316
2019,11,Jeans,445.0600051879883,6,-3.98,20.00,230.84961213196942,214.21039305601886,0.9279218235530825
2019,11,Leggings,31.949999809265137,2,-41.48,0.00,19.6140999143362,12.335899894928934,0.6289302057604216
2019,11,Maternity,97.59000015258789,3,84.24,50.00,41.234740170592666,56.355259981995225,1.3666937089659665
2019,11,Outerwear & Coats,480.51000213623047,5,71.62,66.67,217.0699609185373,263.4400412176932,1.213618135383356
2019,11,Pants,461.42999839782715,7,179.76,133.33,207.00464969692788,254.42534870089924,1.2290803567620303
2019,11,Pants & Capris,241.75000762939453,4,592.69,300.00,119.07010338786763,122.67990424152688,1.0303166013209917
2019,11,Plus,118.71000003814697,4,-66.17,0.00,61.935899976820124,56.77410006132685,0.9166589987805923
2019,11,Shorts,248.11000061035156,6,161.61,20.00,125.16736031739867,122.94264029295289,0.9822260370530755
2019,11,Skirts,73.44000244140625,2,-55.21,100.00,31.01193094425991,42.42807149714634,1.3681209200873536
2019,11,Sleep & Lounge,170.27999877929688,4,-21.87,-33.33,72.7902093540439,97.48978942525298,1.3393255808768585
2019,11,Socks,63.69999980926514,4,53.75,33.33,37.01314997905996,26.68684983020518,0.7210099611976597
2019,11,Socks & Hosiery,66.74000072479248,5,413.78,400.00,27.798340197528095,38.94166052726439,1.4008627943450807
2019,11,Suits & Sport Coats,474.53001403808594,3,-25.15,-25.00,201.472434875935,273.057579162151,1.3553098682224074
2019,11,Sweaters,419.48999977111816,4,63.41,-20.00,202.59357963253382,216.89642013858435,1.0705986859603012
2019,11,Swim,390.3799991607666,7,11.08,16.67,183.8709002205398,206.5090989402268,1.123120073336967
2019,11,Tops & Tees,305.0599994659424,5,-12.48,-28.57,169.15896921589479,135.9010302500476,0.8033923999418522
2019,11,Underwear,177.98000144958496,7,161.74,133.33,84.68020089280158,93.29980055678338,1.1017900237966314
2019,12,Accessories,195.77000045776367,7,-18.05,133.33,76.44950982332162,119.32049063444205,1.5607750907781786
2019,12,Active,215.97000312805176,4,200.21,100.00,86.43131152096629,129.53869160708547,1.4987472633185983
2019,12,Blazers & Jackets,172.72000122070312,2,1065.45,100.00,62.706270887445214,110.01373033325791,1.7544294817136765
2019,12,Dresses,592.25,3,13.46,-25.00,268.94324945518747,323.30675054481253,1.2021374442368495
2019,12,Fashion Hoodies & Sweatshirts,377.4700012207031,7,-29.53,0.00,193.54504105146745,183.92496016923565,0.9502953894867623
2019,12,Intimates,287.5899991989136,6,30.75,-40.00,153.29325927836052,134.29673992055302,0.8760772688425111
2019,12,Jeans,373.9499969482422,4,-15.98,-33.33,209.88709812300615,164.062898825236,0.7816721479901805
2019,12,Jumpsuits & Rompers,11.090000152587892,1,1.37,0.00,5.999690074452609,5.090310078135284,0.8484288379845532
2019,12,Leggings,76.9000015258789,3,140.69,50.00,48.12067108383954,28.779330442039367,0.5980658580570873
2019,12,Maternity,69.95999908447266,1,-28.31,-66.67,28.613639754817484,41.34635932965517,1.4449877640153754
2019,12,Outerwear & Coats,854.4500007629395,5,77.82,0.00,385.32130112584383,469.1286996370956,1.2175000402686815
2019,12,Pants,69.98999977111816,2,-84.83,-71.43,30.834979948278963,39.1550198228392,1.2698247214207972
2019,12,Pants & Capris,25.190000534057617,1,-89.58,-75.00,13.552220280003471,11.637780254054146,0.8587360604834535
2019,12,Plus,9.949999809265137,1,-91.62,-75.00,5.134199909142405,4.815799900122732,0.9379844932697884
2019,12,Shorts,310.93000316619873,8,25.32,33.33,158.57917173050524,152.35083143569352,0.960724096192176
2019,12,Skirts,166.95000076293945,2,127.33,0.00,61.658800303307174,105.29120045963228,1.707642703745321
2019,12,Sleep & Lounge,508.2700023651123,10,198.49,150.00,223.21231062225795,285.05769174285433,1.2770697590477313
2019,12,Socks,48.989999771118164,3,-23.09,-25.00,27.749179947681426,21.240819823436738,0.7654575689618355
2019,12,Socks & Hosiery,12.949999809265137,1,-80.6,-80.00,5.076399901014193,7.873599908250943,1.5510204203332973
2019,12,Suits,250.2300033569336,2,104.1,100.00,147.0278522508923,103.2021511060413,0.7019224556850246
2019,12,Sweaters,501.24999618530273,6,19.49,50.00,235.77374779609778,265.47624838920495,1.1259788287320034
2019,12,Swim,141.20000076293945,3,-63.83,-57.14,79.24050064840168,61.959500114537775,0.7819170702802409
2019,12,Tops & Tees,236.88000106811523,7,-22.35,40.00,126.39584014345039,110.48416092466485,0.8741123188806934
2019,12,Underwear,166.45000076293945,5,-6.48,-28.57,78.97870048608556,87.47130027685388,1.1075302548471857
2020,1,Accessories,164.9999988079071,8,-15.72,14.29,65.31236926828058,99.68762953962653,1.526320827991162
2020,1,Active,391.22000312805176,8,81.15,100.00,160.5331320565379,230.68687107151385,1.4370047361330283
2020,1,Dresses,11.130000114440918,1,-98.12,-66.67,4.997370042562829,6.132630071878089,1.2271714961362075
2020,1,Fashion Hoodies & Sweatshirts,483.7700023651123,10,28.16,42.86,244.22097184043633,239.54903052467597,0.9808700240583237
2020,1,Intimates,187.82999920845032,9,-34.69,50.00,99.98706958368264,87.84292962476766,0.8785428955015916
2020,1,Jeans,402.8799991607666,7,7.74,75.00,214.96009925971887,187.91989990104773,0.8742082858549453
2020,1,Jumpsuits & Rompers,59.77999973297119,2,439.04,100.00,32.568319803647995,27.211679929323193,0.835526060090923
2020,1,Leggings,45.839999198913574,3,-40.39,0.00,27.03847960951596,18.80151958939761,0.6953615684359922
2020,1,Maternity,157.5,2,125.13,100.00,70.80150023661554,86.69849976338446,1.2245291338974718
2020,1,Outerwear & Coats,902.840015411377,5,5.66,0.00,403.8229277433047,499.01708766807224,1.2357324296981942
2020,1,Pants,426.1800003051758,6,508.92,200.00,202.60865063558745,223.57134966958836,1.1034639881774075
2020,1,Pants & Capris,86.75000190734863,3,244.38,200.00,48.34226100899815,38.40774089835048,0.7944961633300827
2020,1,Plus,382.89000129699707,5,3748.14,400.00,183.2488804759708,199.64112082102628,1.089453426959435
2020,1,Shorts,353.78000831604004,8,13.78,0.00,177.4155240841536,176.36448423188642,0.9940758292844282
2020,1,Skirts,23.450000762939453,1,-85.95,-50.00,8.230950262899697,15.219050500039756,1.8490028506961491
2020,1,Sleep & Lounge,561.2499980926514,9,10.42,-10.00,270.3792786314723,290.8707194611791,1.0757877635202833
2020,1,Socks,51.189998626708984,2,4.49,-33.33,30.05510932391077,21.134889302798214,0.7032045392023929
2020,1,Socks & Hosiery,76.35999965667725,5,489.65,400.00,31.65775975573227,44.702239900944974,1.412046848730373
2020,1,Suits,75.98999786376953,1,-69.63,-50.00,49.165528608800166,26.824469254969365,0.5455950543806019
2020,1,Suits & Sport Coats,879.9300060272217,10,85.43,233.33,366.1804815088664,513.7495245183552,1.402995381953245
2020,1,Sweaters,516.0,4,2.94,-33.33,261.13899984769523,254.86100015230477,0.9759591646630645
2020,1,Swim,454.84000396728516,9,222.12,200.00,228.83770248798953,226.00230147929562,0.98760955481607
2020,1,Tops & Tees,549.5000019073486,11,131.97,57.14,306.80565032049117,242.69435158685744,0.7910361211840048
2020,1,Underwear,97.0,3,-41.72,-40.00,42.732000103220344,54.267999896779656,1.2699616157842784
2020,2,Accessories,222.98999786376953,3,35.15,-62.50,89.12009889384136,133.86989896992816,1.5021291564026669
2020,2,Active,1090.6999988555908,13,178.79,62.50,421.36480149830953,669.3351973572812,1.5884933790796631
2020,2,Blazers & Jackets,17.5,1,-89.87,-50.00,6.125000058673321,11.374999941326678,1.8571428297733779
2020,2,Dresses,390.9900016784668,4,3412.94,300.00,179.74178050650775,211.24822117195905,1.1752872402658243
2020,2,Fashion Hoodies & Sweatshirts,554.2300052642822,12,14.56,20.00,290.2941229757987,263.9358822884835,0.9092016041622978
2020,2,Intimates,386.3600034713745,10,105.7,11.11,206.41508158642804,179.94492188494647,0.8717624724993834
2020,2,Jeans,1078.2600002288818,13,167.64,85.71,585.5578695372577,492.7021306916241,0.8414234635442375
2020,2,Jumpsuits & Rompers,23.5,1,-60.69,-50.00,12.666499975137413,10.833500024862587,0.8552875732149567
2020,2,Leggings,50.989999771118164,4,11.23,33.33,30.37595993959993,20.614039831518234,0.6786300703749787
2020,2,Maternity,205.9799976348877,3,30.78,50.00,90.60185916279009,115.3781384720976,1.273463254929354
2020,2,Outerwear & Coats,1315.3699989318848,9,45.69,80.00,580.5749103737699,734.7950885581149,1.2656335563744208
2020,2,Pants,407.3100004196167,6,-4.43,0.00,190.4709305809547,216.839069838662,1.138436553952259
2020,2,Plus,135.98999786376953,3,-64.48,-40.00,65.78148913185507,70.20850873191446,1.067298865660911
2020,2,Shorts,380.9200029373169,7,7.67,-12.50,191.86093136649177,189.05907157082513,0.9853964026145868
2020,2,Skirts,51.39000129699707,2,119.15,100.00,19.267250435341147,32.12275086165592,1.66722029017355
2020,2,Sleep & Lounge,527.379994392395,8,-6.03,-11.11,255.7192564799243,271.6607379124707,1.062339777035125
2020,2,Socks,44.989999771118164,3,-12.11,50.00,26.743819903247356,18.246179867870808,0.6822578051258591
2020,2,Socks & Hosiery,61.14999961853027,4,-19.92,-20.00,23.28196977219053,37.868029846339745,1.626495963050847
2020,2,Suits,98.08000183105469,1,29.07,0.00,54.532481187601086,43.5475206434536,0.7985611454876345
2020,2,Suits & Sport Coats,278.9499969482422,2,-68.3,-80.00,116.50714879794641,162.44284815029576,1.3942736546751628
2020,2,Sweaters,617.589994430542,10,19.69,150.00,293.71698718468775,323.87300724585424,1.1026703302053298
2020,2,Swim,752.980001449585,10,65.55,11.11,366.9818321648576,385.99816928472734,1.0518181976685077
2020,2,Tops & Tees,279.1500024795532,9,-49.2,-18.18,150.79938081700436,128.35062166254886,0.8511349381354745
2020,2,Underwear,158.48999977111816,6,63.39,100.00,75.3011299691376,83.18886980198056,1.10474928910198
2020,3,Accessories,224.97000312805176,7,0.89,133.33,88.41453091149896,136.5554722165528,1.5444912822445656
2020,3,Active,191.92999935150146,5,-82.4,-61.54,75.89506006566114,116.03493928584032,1.5288865861025986
2020,3,Blazers & Jackets,34.9900016784668,1,99.94,0.00,14.975720826833252,20.014280851633544,1.3364485812110147
2020,3,Dresses,51.989999771118164,2,-86.7,-50.00,21.90350985468599,30.086489916432175,1.3735921829895923
2020,3,Fashion Hoodies & Sweatshirts,562.8200035095215,11,1.55,-8.33,309.3265422852925,253.49346122422904,0.8195011632413733
2020,3,Intimates,284.789999961853,10,-26.29,0.00,153.7379097851628,131.05209017669023,0.8524383501754752
2020,3,Jeans,1772.1099948883057,14,64.35,7.69,938.4637562001103,833.6462386881954,0.8883094665942917
2020,3,Leggings,114.88999938964844,3,125.32,-25.00,66.98327986923725,47.90671952041119,0.7152041466756069
2020,3,Maternity,180.70999908447266,4,-12.27,33.33,80.28570990122572,100.42428918324694,1.2508364104495981
2020,3,Outerwear & Coats,840.9700012207031,8,-36.07,-11.11,389.32983096300535,451.6401702576978,1.1600451194314294
2020,3,Pants,460.31000328063965,9,13.01,50.00,213.61908190958397,246.69092137105568,1.1548168785570834
2020,3,Pants & Capris,185.72000217437744,6,114.09,100.00,93.72951087362483,91.99049130075261,0.9814464029880948
2020,3,Plus,124.97000122070312,5,-8.1,66.67,65.62208060981527,59.347920610887854,0.9043894990737467
2020,3,Shorts,570.0500068664551,10,49.65,42.86,292.0906038103835,277.95940305607155,0.951620488403367
2020,3,Skirts,39.0,1,-24.11,-50.00,15.911999956704676,23.088000043295324,1.4509803988257912
2020,3,Sleep & Lounge,599.9999961853027,10,13.77,25.00,260.1582482278822,339.8417479574205,1.306288577326753
2020,3,Socks,149.5299997329712,9,232.36,200.00,88.43933004857048,61.09066968440071,0.6907635963643097
2020,3,Socks & Hosiery,25.489999771118164,2,-58.32,-50.00,9.94854986875765,15.541449902360513,1.562182439389158
2020,3,Suits & Sport Coats,397.0,3,42.32,50.00,167.18499945942312,229.81500054057688,1.3746149551913265
2020,3,Sweaters,391.97000312805176,7,-36.53,-30.00,178.1191310360859,213.85087209196587,1.2006058577090237
2020,3,Swim,457.45000171661377,13,-39.25,30.00,244.24506152934424,213.20494018726953,0.8729140268068615
2020,3,Tops & Tees,132.9900016784668,4,-52.36,-55.56,78.64091075387239,54.3490909245944,0.6911045460128801
2020,3,Underwear,191.39000129699707,7,20.76,16.67,86.63322078765576,104.75678050934131,1.2091987295047901
2020,4,Accessories,298.8700008392334,9,32.85,28.57,125.33391003188599,173.53609080734742,1.384590098267886
2020,4,Active,208.91000175476074,7,8.85,40.00,90.9234210211485,117.98658073361224,1.2976478382414685
2020,4,Blazers & Jackets,286.51000213623047,5,718.83,400.00,105.14020153459275,181.3698006016377,1.7250280858741196
2020,4,Dresses,339.45000076293945,5,552.91,150.00,148.67428991894334,190.77571084399608,1.2831788935935478
2020,4,Fashion Hoodies & Sweatshirts,664.2899932861328,12,18.03,9.09,354.7975969495118,309.4923963366211,0.872306912441299
2020,4,Intimates,554.7199974060059,15,94.78,50.00,300.67707801370426,254.04291939230163,0.8449028475018068
2020,4,Jeans,1104.4200057983398,9,-37.68,-35.71,582.2871623391072,522.1328434592326,0.8966930360644935
2020,4,Jumpsuits & Rompers,32.790000915527344,1,39.53,0.00,17.313120458296147,15.476880457231196,0.8939393966854163
2020,4,Leggings,150.57999897003174,7,31.06,133.33,88.24325957546546,62.336739394566266,0.7064192743385234
2020,4,Maternity,279.87999725341797,4,54.88,0.00,117.48465928813457,162.3953379652834,1.3822684506153615
2020,4,Outerwear & Coats,328.04999923706055,3,-60.99,-62.50,148.22317982450005,179.8268194125605,1.213216580736427
2020,4,Pants,175.25000381469727,4,-61.93,-55.56,81.5956319932741,93.65437182142317,1.1477865853057314
2020,4,Pants & Capris,182.45999908447266,3,-1.76,-50.00,95.18427937696713,87.27571970750553,0.9169131738851476
2020,4,Plus,437.2699966430664,5,249.9,0.00,219.99828853354515,217.27170810952123,0.9876063562030476
2020,4,Shorts,211.39999961853027,4,-62.92,-60.00,109.40439970879108,101.9955999097392,0.9322806046304137
2020,4,Skirts,73.98999977111816,2,89.72,100.00,26.278349780158702,47.711649990959465,1.8156258056578514
2020,4,Sleep & Lounge,527.4300012588501,13,-12.09,30.00,291.37064053551165,236.05936072333844,0.8101686576570779
2020,4,Socks,86.6899995803833,6,-42.03,-33.33,51.90385990069933,34.78613967968397,0.6702033287357744
2020,4,Socks & Hosiery,91.15999984741211,6,257.63,200.00,35.01744969807118,56.14255014934093,1.6032735288667623
2020,4,Suits,194.9900016784668,2,98.81,100.00,118.20266147369534,76.78734020477145,0.6496244606290832
2020,4,Suits & Sport Coats,298.0,1,-24.94,-66.67,118.60399952763692,179.39600047236308,1.5125628240771132
2020,4,Sweaters,676.0399913787842,11,72.47,57.14,339.21653509458434,336.8234562841998,0.9929452766513363
2020,4,Swim,471.8799991607666,11,3.15,-15.38,255.12519042581616,216.75480873495042,0.8496017518817968
2020,4,Tops & Tees,437.7700090408325,14,229.18,250.00,239.4413843008991,198.32862473993342,0.8282971856306157
2020,4,Underwear,166.4699993133545,6,-13.02,-14.29,78.80133975209282,87.66865956126168,1.1125275260175176
2020,5,Accessories,573.3100032806396,10,91.83,11.11,224.69849007065056,348.6115132099891,1.5514635327561717
2020,5,Active,273.14000129699707,7,30.75,0.00,118.7843010319516,154.35570026504547,1.2994621252477259
2020,5,Blazers & Jackets,214.04000568389895,2,-25.29,-60.00,91.07193267782003,122.96807300607892,1.350230190470384
2020,5,Dresses,601.4399967193604,4,77.18,-20.00,283.20435797141806,318.2356387479423,1.12369612186568
2020,5,Fashion Hoodies & Sweatshirts,671.6399993896484,8,1.11,-33.33,332.2043299989582,339.4356693906902,1.0217677457477892
2020,5,Intimates,448.57000064849854,16,-19.14,6.67,237.2510699191471,211.3189307293514,0.8906974826346067
2020,5,Jeans,961.25,7,-12.96,-22.22,514.4284993633628,446.8215006366372,0.8685784344949912
2020,5,Leggings,17.899999618530273,1,-88.11,-85.71,9.862899839422104,8.03709977910817,0.8148820235387372
2020,5,Maternity,292.0299997329712,5,4.34,25.00,125.41181049195961,166.61818924101158,1.3285685661295337
2020,5,Outerwear & Coats,1568.77001953125,7,378.21,133.33,681.4327186677297,887.3373008635202,1.3021642145366237
2020,5,Pants,415.98000144958496,5,137.36,25.00,195.59899105898126,220.3810103906037,1.1266980938779467
2020,5,Plus,80.97000122070312,3,-81.48,-40.00,40.51932063532464,40.450680585378485,0.9983059920830382
2020,5,Shorts,456.0000033378601,14,115.7,250.00,224.94705147431262,231.0529518635475,1.0271437227081508
2020,5,Skirts,103.0,2,39.21,0.00,40.667999828234315,62.332000171765685,1.5327038564726962
2020,5,Sleep & Lounge,615.9300022125244,9,16.78,-30.77,268.5627408830405,347.36726132948394,1.2934305785952749
2020,5,Socks,70.30000114440918,4,-18.91,-33.33,40.93015074584112,29.369850398568058,0.7175602792411486
2020,5,Socks & Hosiery,30.0,1,-67.09,-83.33,11.429999973624945,18.570000026375055,1.624671922067005
2020,5,Suits & Sport Coats,219.5,1,-26.34,0.00,93.06799971871078,126.43200028128922,1.3584905731660504
2020,5,Sweaters,423.45999908447266,8,-37.36,-27.27,208.3900398687767,215.06995921569592,1.0320548878013822
2020,5,Swim,302.7199993133545,5,-35.85,-54.55,149.68506012894545,153.03493918440904,1.0223795150469783
2020,5,Tops & Tees,402.86999893188477,10,-7.97,-28.57,221.64402880544614,181.2259701264386,0.8176442699727068
2020,5,Underwear,205.29000186920166,8,23.32,33.33,96.11795096955234,109.17205089964932,1.1358133397395476
2020,6,Accessories,354.25,8,-38.21,-20.00,134.2297695496078,220.0202304503922,1.639131402733121
2020,6,Active,429.84000396728516,8,57.37,14.29,180.86821239334807,248.97179157393708,1.3765370281455478
2020,6,Blazers & Jackets,252.47000122070312,2,17.95,0.00,90.51035102857799,161.95965019212514,1.7894047294213626
2020,6,Dresses,304.9900026321411,4,-49.29,0.00,138.00047107589427,166.98953155624685,1.2100649385784332
2020,6,Fashion Hoodies & Sweatshirts,500.00000190734863,11,-25.56,37.50,256.01827123927654,243.9817306680721,0.9529856189054764
2020,6,Intimates,570.2500019073486,11,27.13,-31.25,295.42824057340925,274.8217613339393,0.9302487832596033
2020,6,Jeans,1041.2699966430664,11,8.32,57.14,539.4510471782021,501.8189494648642,0.9302400136023714
2020,6,Leggings,292.0099983215332,5,1531.34,400.00,179.31144945523442,112.69854886629878,0.6285072660373217
2020,6,Maternity,25.0,1,-91.44,-80.00,10.925000032875689,14.074999967124311,1.2883295125647223
2020,6,Outerwear & Coats,2166.7499828338623,9,38.12,28.57,955.5809322747955,1211.1690505590668,1.2674688345610188
2020,6,Pants,452.7300033569336,3,8.83,-40.00,219.00363210953108,233.7263712474025,1.0672260044094068
2020,6,Pants & Capris,85.44999885559082,3,-53.17,0.00,44.28108928281799,41.16890957277283,0.9297176343118383
2020,6,Plus,147.27000045776367,6,81.88,100.00,75.25349024475946,72.01651021300421,0.9569856491542508
2020,6,Shorts,605.7400016784668,12,32.84,-14.29,303.8481007707376,301.8919009077292,0.9935619151212521
2020,6,Skirts,33.88999938964844,1,-67.1,-50.00,13.081539699259253,20.808459690389185,1.5906735880308853
2020,6,Sleep & Lounge,320.0900020599365,6,-48.03,-33.33,144.123220338484,175.96678172145252,1.2209467794862032
2020,6,Socks,126.17000007629395,8,79.47,100.00,77.37599026499151,48.79400981130242,0.630609180498968
2020,6,Socks & Hosiery,41.96000003814697,3,39.87,200.00,16.89512994614139,25.06487009200558,1.483555922440836
2020,6,Suits,122.59999847412108,1,-37.12,-50.00,71.35319938962459,51.24679908449649,0.7182130517324531
2020,6,Suits & Sport Coats,264.939998626709,3,20.7,200.00,108.43970940794887,156.50028921876012,1.4432009277155837
2020,6,Sweaters,671.8900012969971,11,58.67,37.50,326.2823008093725,345.6077004876246,1.0592290774899948
2020,6,Swim,670.6500034332275,13,121.54,160.00,353.07243307651225,317.5775703567153,0.8994686092864546
2020,6,Tops & Tees,301.479998588562,9,-25.17,-10.00,171.49411831657133,129.98588027199068,0.7579611566155401
2020,6,Underwear,170.0900001525879,7,-17.15,-12.50,80.94814021128849,89.1418599412994,1.101221840410711
2020,7,Accessories,325.0399971008301,14,-8.25,75.00,135.04479826141085,189.99519883941923,1.4069049773515823
2020,7,Active,513.6199998855591,8,19.49,0.00,208.6966909174588,304.9233089681003,1.4610835832020925
2020,7,Blazers & Jackets,152.98000049591064,3,-39.41,50.00,58.72388065285504,94.25611984305559,1.6050730775142164
2020,7,Dresses,311.56000232696533,5,2.15,25.00,138.26235133610814,173.2976509908572,1.2533972503446016
2020,7,Fashion Hoodies & Sweatshirts,697.6900043487549,13,39.54,18.18,384.5142427076744,313.17576164108044,0.8144711609009793
2020,7,Intimates,703.9200029373169,21,23.44,90.91,372.65166128915143,331.26834164816546,0.8889490536609324
2020,7,Jeans,1171.5300064086914,13,12.51,18.18,629.8848420709892,541.6451643377022,0.8599114126271638
2020,7,Jumpsuits & Rompers,26.170000076293945,2,-20.19,100.00,14.146980020594299,12.023020055699645,0.8498647794933814
2020,7,Leggings,52.950000762939446,1,-81.87,-80.00,30.075600431771576,22.87440033116787,0.7605633803740647
2020,7,Maternity,163.59000205993652,5,554.36,400.00,72.85425116034038,90.73575089959614,1.2454420909481518
2020,7,Outerwear & Coats,940.6999969482422,6,-56.58,-33.33,421.20640812199815,519.493588826244,1.2333468314085525
2020,7,Pants,670.4700012207031,7,48.09,133.33,296.82016109117137,373.64984012953175,1.258842521868861
2020,7,Pants & Capris,216.0,3,152.78,0.00,110.77299995161593,105.22700004838407,0.9499336489428446
2020,7,Plus,333.9699993133545,6,126.77,0.00,174.88799989446625,159.08199941888824,0.9096221554073698
2020,7,Shorts,409.18000411987305,7,-32.45,-41.67,201.6035620514197,207.57644206845336,1.0296268575627163
2020,7,Skirts,134.98999977111816,2,298.32,100.00,50.754379750820696,84.23562002029746,1.6596719422807127
2020,7,Sleep & Lounge,496.14000129699707,10,55.0,66.67,234.4516101969591,261.68839110003796,1.1161722919292287
2020,7,Socks,121.30999946594238,6,-3.85,-25.00,76.09182981531889,45.218169650623494,0.5942578823557233
2020,7,Socks & Hosiery,48.97999954223633,3,16.73,0.00,20.32962973904226,28.650369803194067,1.4092912744088077
2020,7,Suits,127.51000213623048,1,4.0,0.00,73.06323132476254,54.44677081146794,0.7452006956748829
2020,7,Suits & Sport Coats,736.9999961853027,7,178.18,133.33,293.44192750314596,443.5580686821567,1.5115701851345063
2020,7,Sweaters,1170.5399990081787,18,74.22,63.64,572.7953090886349,597.7446899195438,1.0435572366516155
2020,7,Swim,1052.0400009155273,14,56.87,7.69,473.0445719594604,578.9954289560669,1.223976477645084
2020,7,Tops & Tees,443.4000015258789,11,47.07,22.22,250.61647005614333,192.78353146973558,0.7692372788849353
2020,7,Underwear,309.8899974822998,8,82.19,14.29,151.84159909615067,158.0483983861491,1.0408768040309435
2020,8,Accessories,577.3500061035156,13,77.62,-7.14,241.81809170265294,335.53191440086266,1.3875385089608727
2020,8,Active,307.10000228881836,10,-40.21,25.00,129.89636137549286,177.20364091332547,1.3641924918980675
2020,8,Blazers & Jackets,277.61000061035156,4,81.47,33.33,107.5898208880758,170.02017972227577,1.5802626895265994
2020,8,Dresses,758.9300079345703,7,143.59,40.00,326.0285925555097,432.9014153790606,1.327801994254092
2020,8,Fashion Hoodies & Sweatshirts,687.2600002288818,14,-1.49,7.69,364.1119708869997,323.14802934188214,0.8874963065747967
2020,8,Intimates,567.7399950027466,15,-19.35,-28.57,302.07430671774046,265.6656882850061,0.879471316748714
2020,8,Jeans,1955.930009841919,18,66.96,38.46,1026.0759839142165,929.8540259277024,0.9062233601653437
2020,8,Leggings,101.08000183105469,5,90.9,400.00,62.161051362084976,38.91895046896971,0.6260986520686208
2020,8,Maternity,125.8700008392334,4,-23.06,-20.00,54.835840470846605,71.0341603683868,1.2953965829365195
2020,8,Outerwear & Coats,2136.1599922180176,15,127.08,150.00,971.1777004129498,1164.9822918050677,1.1995562617528297
2020,8,Pants,608.4400062561035,10,-9.25,42.86,273.05337323009513,335.3866330260084,1.2282823283174993
2020,8,Pants & Capris,84.97999954223633,3,-60.66,0.00,45.73823969024442,39.24175985199191,0.8579639294767578
2020,8,Plus,285.6000016927719,9,-14.48,50.00,150.87100079681352,134.7290008959584,0.8930079351525316
2020,8,Shorts,575.4800062179565,14,40.64,100.00,283.32694299241103,292.1530632255455,1.0311517151878171
2020,8,Skirts,246.79000091552734,4,82.82,100.00,93.32635999541206,153.4636409201153,1.6443761540432906
2020,8,Sleep & Lounge,604.2500019073486,9,21.79,-10.00,285.79801084763164,318.451991059717,1.1142554495576746
2020,8,Socks,112.94999980926514,6,-6.89,0.00,68.29968003293841,44.650319776326725,0.6537412730893253
2020,8,Socks & Hosiery,132.8499994277954,8,171.23,166.67,54.521279487815946,78.32871993997946,1.4366632748867136
2020,8,Suits & Sport Coats,790.4499969482422,5,7.25,-28.57,331.72664778577763,458.7233491624646,1.3828353924062768
2020,8,Sweaters,629.4100131988525,8,-46.23,-55.56,307.9450462889327,321.46496690991984,1.0439036795165781
2020,8,Swim,649.2299957275391,11,-38.29,-21.43,320.5367399875021,328.693255740037,1.0254464301123576
2020,8,Tops & Tees,458.2200012207031,13,3.34,18.18,251.60970994390823,206.6102912767949,0.821153886798943
2020,8,Underwear,528.8200073242188,12,70.65,50.00,247.60166363077906,281.2183436934397,1.1357692011019338
2020,9,Accessories,484.68000507354736,13,-16.05,0.00,201.39490140414648,283.2851036694009,1.4066150716542836
2020,9,Active,710.6899948120117,14,131.42,40.00,300.5647491022404,410.12524570977126,1.3645154561031463
2020,9,Blazers & Jackets,394.37999725341797,4,42.06,0.00,142.4597902537687,251.92020699964928,1.7683600863857434
2020,9,Dresses,420.0199909210205,5,-44.66,-28.57,182.3603265147359,237.65966440628463,1.3032421522182358
2020,9,Fashion Hoodies & Sweatshirts,2075.349992752075,30,201.97,114.29,1106.558957293841,968.7910354582341,0.8754987965824008
2020,9,Intimates,504.1900005340576,14,-11.19,-6.67,261.2830198511037,242.90698068295393,0.9296699832288312
2020,9,Jeans,1864.0599918365479,19,-4.7,5.56,1009.0934941892586,854.9664976472892,0.8472619262442074
2020,9,Leggings,111.88000106811523,4,10.68,-20.00,67.57024083285243,44.3097602352628,0.655758506838406
2020,9,Maternity,270.9799995422363,5,115.29,25.00,119.49954011236787,151.48045942986846,1.2676237857269432
2020,9,Outerwear & Coats,1542.01997756958,14,-27.81,-6.67,684.5231717330834,857.4968058364967,1.252692153087348
2020,9,Pants,195.63000106811523,4,-67.85,-60.00,88.81215076618307,106.81785030193217,1.2027391452680045
2020,9,Pants & Capris,29.47000026702881,2,-65.32,-33.33,15.167110133025199,14.30289013400361,0.9430201276682354
2020,9,Plus,94.3700008392334,5,-66.96,-44.44,47.32668043363646,47.04332040559694,0.9940126789911482
2020,9,Shorts,836.120002746582,20,45.29,42.86,421.4132015476804,414.70680119890164,0.9840859272463491
2020,9,Skirts,74.93000030517578,1,-69.64,-75.00,28.24861000004724,46.681390305128545,1.6525199046979826
2020,9,Sleep & Lounge,305.8899955749512,9,-49.38,0.00,146.25653834813653,159.63345722681464,1.0914620230299505
2020,9,Socks,166.71999835968018,9,47.61,50.00,101.53009923012145,65.18989912955873,0.6420746125915191
2020,9,Socks & Hosiery,50.88000011444092,4,-61.7,-50.00,19.887969969234167,30.992030145206748,1.5583304979417247
2020,9,Suits & Sport Coats,1087.7700119018555,9,37.61,80.00,438.2162038922069,649.5538080096486,1.4822678902339879
2020,9,Sweaters,755.0300025939941,9,19.96,12.50,379.50629140353743,375.5237111904567,0.9895058914613725
2020,9,Swim,626.0600032806396,14,-3.57,27.27,317.60848194346806,308.4515213371715,0.9711690300263253
2020,9,Tops & Tees,844.9600009918213,20,84.4,53.85,462.22292903820767,382.7370719536136,0.8280356683083896
2020,9,Underwear,354.44999980926514,13,-32.97,8.33,162.49530026437884,191.9546995448863,1.1812938542381053
2020,10,Accessories,675.2599976062775,16,39.32,23.08,281.606608163369,393.65338944290846,1.397884062488113
2020,10,Active,251.88999843597412,8,-64.56,-42.86,101.60925980287954,150.2807386330946,1.47900633194885
2020,10,Blazers & Jackets,536.7399997711182,6,36.1,50.00,202.92391129870168,333.8160884724165,1.6450308213359983
2020,10,Clothing Sets,54.9900016784668,1,,,35.7984909173271,19.191510761139696,0.5360983178162593
2020,10,Dresses,558.7900066375732,12,33.04,140.00,251.8803824743972,306.90962416317603,1.2184737102119192
2020,10,Fashion Hoodies & Sweatshirts,913.669994354248,20,-55.98,-33.33,477.0572275326142,436.6127668216338,0.9152209454614847
2020,10,Intimates,324.8500003814697,13,-35.57,-7.14,170.30767977099768,154.54232061047207,0.9074301336162626
2020,10,Jeans,1067.8099937438965,13,-42.72,-31.58,564.7776359770211,503.03235776687546,0.890673294626245
2020,10,Jumpsuits & Rompers,50.02999973297119,3,91.17,50.00,27.244819831181616,22.785179901789576,0.836312372149072
2020,10,Leggings,93.17000007629395,4,-16.72,0.00,57.88023019129456,35.28976988499939,0.6097033437560019
2020,10,Maternity,302.8899955749512,5,11.78,0.00,141.57391826892916,161.316077306022,1.1394477123928384
2020,10,Outerwear & Coats,1672.0500087738037,17,8.43,21.43,737.3577251550395,934.6922836187642,1.2676239113413132
2020,10,Pants,575.2299995422363,9,194.04,125.00,268.72070020816585,306.5092993340704,1.1406240721188634
2020,10,Pants & Capris,365.49000549316406,4,1140.21,100.00,194.50559283670765,170.9844126564564,0.8790719596428374
2020,10,Plus,212.98000144958496,4,125.69,-20.00,114.14894095354661,98.83106049603835,0.8658079494251117
2020,10,Shorts,494.58000564575195,12,-40.85,-40.00,243.17573267358188,251.40427297217008,1.0338378349192987
2020,10,Sleep & Lounge,686.7400035858154,15,124.51,66.67,312.9151306000996,373.82487298571584,1.1946525956376903
2020,10,Socks,128.0,8,-23.22,-11.11,76.3914601987572,51.608539801242806,0.6755799623016293
2020,10,Socks & Hosiery,67.95000076293945,4,33.55,0.00,26.204950195192545,41.74505056774691,1.5930215572554414
2020,10,Suits,406.98999786376953,3,219.18,200.00,252.56685920973436,154.42313865403514,0.6114148908420342
2020,10,Suits & Sport Coats,561.6199989318848,4,-48.37,-55.56,213.07571901895733,348.54427991292744,1.6357766221214416
2020,10,Sweaters,789.6099967956543,10,4.58,11.11,372.9613084539488,416.6486883417055,1.1171364935115005
2020,10,Swim,1251.7700004577637,19,99.94,35.71,621.5120623610349,630.2579380967288,1.014071932413459
2020,10,Tops & Tees,780.579999923706,17,-7.62,-15.00,434.5142885190491,346.0657114046569,0.796442649985457
2020,10,Underwear,193.09000205993652,7,-45.52,-46.15,89.58270100673958,103.50730105319694,1.1554384930346069
2020,11,Accessories,982.4100036621094,16,45.49,0.00,407.9306305647929,574.4793730973165,1.408277118837415
2020,11,Active,413.6399955749512,12,64.21,50.00,172.65238869367133,240.98760688127982,1.3957965406945647
2020,11,Blazers & Jackets,381.3999996185303,3,-28.94,-50.00,147.508500585936,233.89149903259425,1.5856136975396409
2020,11,Dresses,432.0099983215332,7,-22.69,-41.67,200.95946905046884,231.05052927106436,1.1497369612030497
2020,11,Fashion Hoodies & Sweatshirts,930.4499969482422,17,1.84,-15.00,461.24894937554484,469.2010475726973,1.0172403605643292
2020,11,Intimates,631.760000705719,18,94.48,38.46,329.20029973267185,302.55970097304714,0.919074804059236
2020,11,Jeans,1459.2200050354004,14,36.66,7.69,792.4232422846595,666.7967627507409,0.8414654280309584
2020,11,Leggings,100.63000011444092,4,8.01,0.00,59.75655024232418,40.87344987211674,0.6839994897022522
2020,11,Maternity,66.0,2,-78.21,-60.00,27.22200011089444,38.77799988910556,1.4245095779566292
2020,11,Outerwear & Coats,1499.399990081787,13,-10.33,-23.53,672.3771763157677,827.0228137660195,1.2299983445268312
2020,11,Pants,537.7100028991699,10,-6.52,11.11,245.65456202988008,292.05544086928984,1.1888866970594496
2020,11,Pants & Capris,256.1900005340576,5,-29.91,25.00,135.5859200431089,120.6040804909487,0.8895029841786168
2020,11,Plus,246.78999948501587,10,15.87,150.00,123.66937989366974,123.12061959134613,0.995562682510453
2020,11,Shorts,540.5400009155273,10,9.29,-16.67,278.8519406918636,261.68806022366374,0.9384480508702421
2020,11,Skirts,19.989999771118164,1,-73.32,0.00,8.715639839441183,11.274359931676981,1.2935779976424375
2020,11,Sleep & Lounge,517.5,12,-24.64,-20.00,220.36470971814168,297.1352902818583,1.3483796505434573
2020,11,Socks,108.51999950408936,6,-15.22,-25.00,64.89120999588349,43.62878950820588,0.6723374323113033
2020,11,Socks & Hosiery,78.96999931335449,5,16.22,25.00,30.92442964652151,48.04556966683298,1.5536444880637377
2020,11,Suits & Sport Coats,555.4100036621094,6,-1.11,50.00,220.98687103144556,334.4231326306638,1.5133167462381814
2020,11,Sweaters,845.3300037384033,13,7.06,30.00,415.7177217300574,429.6122820083459,1.0334230646229483
2020,11,Swim,864.2499961853027,15,-30.96,-21.05,463.29891951863834,400.9510766666644,0.8654263150089956
2020,11,Tops & Tees,603.1900062561035,17,-22.73,0.00,335.5411226953437,267.6488835607598,0.7976634321623017
2020,11,Underwear,355.9300003051758,11,84.33,57.14,166.85197044171272,189.07802986346306,1.133208252578082
2020,12,Accessories,559.9599947929382,13,-43.0,-18.75,225.3985772153361,334.5614175776021,1.4843102459248292
2020,12,Active,725.2899980545044,13,75.34,8.33,314.93002055732813,410.35997749717626,1.3030195621584972
2020,12,Blazers & Jackets,445.78999614715576,4,16.88,33.33,156.95670985789687,288.83328628925887,1.840209867744797
2020,12,Dresses,492.6099967956543,7,14.03,0.00,228.944998154182,263.6649986414723,1.1516521468789997
2020,12,Fashion Hoodies & Sweatshirts,1210.099998474121,21,30.06,23.53,613.8331094319926,596.2668890421285,0.9713827421167962
2020,12,Intimates,750.85999584198,20,18.85,11.11,404.84100729317475,346.0189885488052,0.8547034077954158
2020,12,Jeans,1739.7500076293945,17,19.22,21.43,944.258993005939,795.4910146234555,0.8424500274983902
2020,12,Jumpsuits & Rompers,26.619999885559082,2,-46.79,-33.33,13.529119931575954,13.09087995398313,0.9676076507703946
2020,12,Leggings,70.17999935150146,4,-30.26,0.00,42.39190973029673,27.788089621204737,0.655504547872376
2020,12,Maternity,313.10000228881836,6,374.39,200.00,135.44545156482718,177.65455072399115,1.3116317208995516
2020,12,Outerwear & Coats,1670.2399940490723,12,11.39,-7.69,712.5408180990203,957.6991759500519,1.3440621949281262
2020,12,Pants,622.2200031280518,10,15.72,0.00,288.45685179076077,333.763151337291,1.1570643902728102
2020,12,Pants & Capris,217.11000061035156,5,-15.25,0.00,116.18291012648601,100.92709048386556,0.8686913623870176
2020,12,Plus,186.93999671936035,5,-24.25,-50.00,90.0668982594669,96.87309845989344,1.0755682757145593
2020,12,Shorts,827.3200054168701,19,53.05,90.00,415.677072440869,411.6429329760011,0.9902950156928807
2020,12,Skirts,75.88999938964844,3,279.64,200.00,31.26320958046332,44.62678980918512,1.4274538797536906
2020,12,Sleep & Lounge,1111.6299991607666,21,114.81,75.00,527.8187986743213,583.8112004864453,1.106082621446518
2020,12,Socks,205.23999977111816,9,89.13,50.00,124.8307402163858,80.40925955473236,0.6441463009459708
2020,12,Socks & Hosiery,40.989999771118164,2,-48.09,-60.00,15.242849825378135,25.747149945740027,1.6891296733024992
2020,12,Suits,344.98999786376953,3,-15.23,0.00,212.41959903977215,132.57039882399738,0.6240968320403227
2020,12,Suits & Sport Coats,930.4099884033203,8,67.52,33.33,380.74266336509163,549.6673250382287,1.4436714818879026
2020,12,Sweaters,1268.640001296997,18,50.08,38.46,636.8856804712653,631.7543208257317,0.9919430444067503
2020,12,Swim,1242.1900100708008,16,43.73,6.67,626.1482170856711,616.0417929851296,0.9838593741469382
2020,12,Tops & Tees,1003.4200029373169,23,66.35,35.29,557.1631705180047,446.25683241931216,0.8009445994149598
2020,12,Underwear,255.0,10,-28.36,-9.09,122.61100005544722,132.38899994455278,1.079748145636882
2021,1,Accessories,621.9900045394897,15,11.08,15.38,251.14834097095843,370.8416635685313,1.4765841658950623
2021,1,Active,627.9000053405762,15,-13.43,15.38,253.93938301753892,373.9606223230373,1.4726373588818589
2021,1,Blazers & Jackets,383.8400001525879,3,-13.9,-25.00,141.60432086841047,242.23567928417742,1.710651749880438
2021,1,Clothing Sets,69.98999786376953,1,27.28,0.00,41.0841285708201,28.905869292949433,0.7035775200421254
2021,1,Dresses,1115.4600057601929,13,126.44,85.71,481.87018272503434,633.5898230351585,1.314855838251147
2021,1,Fashion Hoodies & Sweatshirts,1102.1800022125244,23,-8.92,9.52,563.0513118447909,539.1286903677335,0.9575125375364513
2021,1,Intimates,862.5400009155273,22,14.87,10.00,453.0754200145583,409.46458090096905,0.9037448575069733
2021,1,Jeans,1381.3200035095215,17,-20.6,0.00,736.759120836069,644.5608826734525,0.8748597261232537
2021,1,Jumpsuits & Rompers,98.0,1,268.14,-50.00,52.62599995546042,45.37400004453958,0.8621973944997052
2021,1,Leggings,55.03999900817871,4,-21.57,0.00,32.491529498462825,22.548469509715886,0.6939799343943674
2021,1,Maternity,431.8999996185303,9,37.94,50.00,198.33406034069327,233.565939277837,1.1776390745826677
2021,1,Outerwear & Coats,4241.729991912842,16,153.96,33.33,1930.839019109052,2310.8909728037897,1.1968325427099071
2021,1,Pants,1173.7399997711182,19,88.64,90.00,550.7021212175164,623.0378785536018,1.1313518770840438
2021,1,Pants & Capris,62.84000015258789,2,-71.06,-60.00,32.771440068704486,30.068560083883405,0.9175233075154903
2021,1,Plus,447.8400001525879,10,139.56,100.00,225.6916501147751,222.1483500378128,0.9843002606646708
2021,1,Shorts,1074.5599908828735,20,29.88,5.26,539.9961050981626,534.5638857847109,0.9899402620460305
2021,1,Skirts,35.0,1,-53.88,-66.67,12.984999977052212,22.01500002294779,1.6954177945208992
2021,1,Sleep & Lounge,945.3200054168701,23,-14.96,9.52,421.5456508951815,523.7743545216887,1.2425092120139716
2021,1,Socks,230.49999904632568,14,12.31,55.56,138.10437984983332,92.39561919649236,0.6690274363272041
2021,1,Socks & Hosiery,97.21999931335449,7,137.18,250.00,39.641809549234864,57.57818976411963,1.452461187287828
2021,1,Suits,409.11000061035156,3,18.59,0.00,228.27223086859703,180.83776974175453,0.7922022273740876
2021,1,Suits & Sport Coats,1597.3600044250488,11,71.68,37.50,655.4709703288677,941.8890340961811,1.4369652917254438
2021,1,Sweaters,1898.4899950027466,23,49.65,27.78,935.3537063306281,963.1362886721184,1.029702755389168
2021,1,Swim,764.920000076294,15,-38.42,-6.25,405.84718210955936,359.0728179667346,0.8847488261475771
2021,1,Tops & Tees,1028.140009880066,23,2.46,0.00,569.586474356638,458.5535355234279,0.8050639475619141
2021,1,Underwear,327.0000014305115,13,28.24,30.00,156.85428087614596,170.1457205543655,1.0847375003345598
2021,2,Accessories,746.7199897766113,17,20.05,13.33,299.5417848186922,447.17820495791915,1.4928742086136293
2021,2,Active,537.5499973297119,14,-14.39,-6.67,222.1916596889218,315.3583376407901,1.4193077187609375
2021,2,Blazers & Jackets,338.0099935531616,5,-11.94,66.67,119.28359857834278,218.72639497481885,1.8336669716680645
2021,2,Dresses,568.3000001907349,4,-49.05,-69.23,272.398029432067,295.90197075866786,1.0862852839853692
2021,2,Fashion Hoodies & Sweatshirts,912.6099939346313,18,-17.2,-21.74,477.69335765029666,434.9166362843347,0.9104515047553218
2021,2,Intimates,417.6900005340576,17,-51.57,-22.73,223.08043997124392,194.6095605628137,0.872373931967768
2021,2,Jeans,1889.3199996948242,17,36.78,0.00,1054.0884575050334,835.2315421897908,0.7923732930030709
2021,2,Jumpsuits & Rompers,44.970001220703125,2,-54.11,100.00,22.843330574231295,22.12667064647183,0.9686271699553347
2021,2,Leggings,132.88999938964844,3,141.44,-25.00,81.72707977768226,51.162919611966174,0.6260216289526297
2021,2,Maternity,449.839994430542,6,4.15,-33.33,187.76930849684732,262.0706859336947,1.395705656220675
2021,2,Outerwear & Coats,1753.6800003051758,12,-58.66,-25.00,774.7670706750483,978.9129296301273,1.2634932054833052
2021,2,Pants,388.58999824523926,6,-66.89,-68.42,180.22099956020338,208.36899868503582,1.1561860115831257
2021,2,Pants & Capris,268.98000144958496,4,328.04,100.00,139.23538058703662,129.74462086254835,0.9318365800095216
2021,2,Plus,151.1699993610382,6,-66.24,-40.00,78.98650963090897,72.18348973012924,0.9138711163137968
2021,2,Shorts,1602.5400009155273,13,49.13,-35.00,799.1052902832441,803.4347106322832,1.0054178346729559
2021,2,Skirts,163.29000091552734,6,366.54,500.00,65.98759015904236,97.30241075648499,1.4745562085532764
2021,2,Sleep & Lounge,460.5599956512451,9,-51.28,-60.87,209.93017773865506,250.62981791259003,1.193872270353634
2021,2,Socks,162.7200002670288,8,-29.41,-42.86,95.83000041624904,66.88999985077977,0.6980068826070654
2021,2,Socks & Hosiery,107.97999954223633,5,11.07,-28.57,44.41083972587794,63.569159816358386,1.431388377448693
2021,2,Suits,379.0800018310547,3,-7.34,0.00,228.5654814817202,150.51452034933448,0.6585181601945963
2021,2,Suits & Sport Coats,773.2699966430664,7,-51.59,-36.36,310.46183763917895,462.80815900388745,1.4907086891038972
2021,2,Sweaters,1565.810001373291,20,-17.52,-13.04,742.6451599998732,823.1648413734179,1.108422818474382
2021,2,Swim,1198.270004272461,16,56.65,6.67,586.2655646972305,612.0044395752304,1.0439030985749478
2021,2,Tops & Tees,738.6400079727173,16,-28.16,-30.43,428.021064016311,310.61894395640627,0.7257094803740061
2021,2,Underwear,289.9900016784668,9,-11.32,-30.77,138.49350109851267,151.49650057995413,1.093888878382764
2021,3,Accessories,560.6999955177307,13,-24.91,-23.53,219.86014767707084,340.8398478406599,1.5502575225287452
2021,3,Active,1736.3200054168701,19,223.01,35.71,740.3715956028959,995.9484098139742,1.3452007285651717
2021,3,Blazers & Jackets,479.6499996185303,5,41.9,0.00,171.73327057953503,307.9167290389952,1.792994030800743
2021,3,Dresses,1387.4499988555908,14,144.14,250.00,636.5546897194017,750.8953091361891,1.1796241882487577
2021,3,Fashion Hoodies & Sweatshirts,601.8800010681152,12,-34.05,-33.33,310.604000856895,291.2760002112202,0.9377728535616003
2021,3,Intimates,967.0099973678589,23,131.51,35.29,511.26174815839903,455.74824920945986,0.8914186340971083
2021,3,Jeans,1241.3600006103516,15,-34.3,-11.76,665.4172697992469,575.9427308111046,0.865536193529909
2021,3,Jumpsuits & Rompers,550.0,1,1123.04,-50.00,306.3500000163913,243.64999998360872,0.795332136349183
2021,3,Leggings,129.4099998474121,6,-2.62,100.00,77.30402010157799,52.10597974583412,0.6740397158823891
2021,3,Maternity,209.95000076293945,6,-53.33,0.00,97.32999069885932,112.62001006408013,1.1570946350188032
2021,3,Outerwear & Coats,1561.7399978637695,12,-10.94,0.00,698.5684902246392,863.1715076391304,1.2356290323967514
2021,3,Pants,947.7199983596802,14,143.89,133.33,434.6459600946055,513.0740382650746,1.1804412910070494
2021,3,Pants & Capris,202.22000217437744,5,-24.82,25.00,108.03601102306857,94.18399115130887,0.8717833087265512
2021,3,Plus,387.3199996948242,8,156.21,33.33,190.33319984728212,196.98679984754213,1.0349576427317917
2021,3,Shorts,650.8500003814697,16,-59.39,23.08,331.0764204737264,319.77357990774334,0.9658603275044167
2021,3,Skirts,168.98999977111816,2,3.49,-66.67,68.3014596178764,100.68854015324175,1.4741784541144525
2021,3,Sleep & Lounge,888.5200023651123,16,92.92,77.78,437.27418070876377,451.2458216563485,1.0319516714317285
2021,3,Socks,238.82000160217285,11,46.77,37.50,145.8546312863742,92.96537031579865,0.6373837395212251
2021,3,Socks & Hosiery,47.760000228881836,2,-55.77,-60.00,19.70024003300093,28.059760195880912,1.4243359547333687
2021,3,Suits,571.3599853515625,3,50.72,0.00,333.97627200833824,237.38371334322426,0.710780175836257
2021,3,Suits & Sport Coats,1366.4600067138672,12,76.71,71.43,541.1477100137126,825.3122967001545,1.5251146432445242
2021,3,Sweaters,1899.9799938201904,25,21.34,25.00,945.5807772006087,954.3992166195817,1.0093259503911236
2021,3,Swim,837.5299987792969,17,-30.11,6.25,429.7168509535357,407.8131478257611,0.9490275908911402
2021,3,Tops & Tees,1009.5299987792969,25,36.67,56.25,565.920657884295,443.6093408950018,0.7838719698861032
2021,3,Underwear,230.42000198364258,9,-20.54,0.00,108.79413107566059,121.62587090798199,1.117945147458346
2021,4,Accessories,608.6499974727631,19,8.55,46.15,235.06365832793261,373.58633914483045,1.5892985832103728
2021,4,Active,1577.0300035476685,21,-9.17,10.53,690.656815165002,886.3731883826665,1.283377169268802
2021,4,Blazers & Jackets,169.36000061035156,4,-64.69,-20.00,63.8524706824382,105.50752992791337,1.6523640949250198
2021,4,Dresses,706.4300031661987,6,-49.08,-57.14,332.69060040506633,373.7394027611324,1.1233843165574477
2021,4,Fashion Hoodies & Sweatshirts,913.0599956512451,19,51.7,58.33,460.3862481849394,452.6737474663057,0.9832477604423676
2021,4,Intimates,725.9099969863892,17,-24.93,-26.09,387.9880479481507,337.92194903823844,0.8709596876123283
2021,4,Jeans,3031.6599922180176,23,144.22,53.33,1578.4701945509112,1453.1897976671064,0.9206317627559334
2021,4,Jumpsuits & Rompers,108.70000076293945,2,-80.24,100.00,60.35593042419076,48.34407033874869,0.8009829357111908
2021,4,Leggings,122.94999980926514,3,-4.99,-50.00,76.6327001326561,46.31729967660904,0.6044064687324189
2021,4,Maternity,430.54999923706055,8,105.07,33.33,198.98138044736802,231.56861878969252,1.1637702898083173
2021,4,Outerwear & Coats,1331.8199920654297,12,-14.72,0.00,591.8312381220658,739.9887539433639,1.2503374379010737
2021,4,Pants,719.9400014877319,9,-24.03,-35.71,320.0041816617061,399.9358198260258,1.249783105174606
2021,4,Pants & Capris,440.6800022125244,6,117.92,20.00,233.6843706589873,206.99563155353712,0.885791510017601
2021,4,Plus,232.9000005722046,8,-39.87,0.00,119.35732033582062,113.54268023638397,0.9512837580210688
2021,4,Shorts,880.589994430542,18,35.3,12.50,441.24787711309256,439.34211731744944,0.9956809768511257
2021,4,Skirts,182.2199993133545,6,7.83,200.00,73.88601941426589,108.3339798990886,1.466231105125302
2021,4,Sleep & Lounge,755.1799983978271,18,-15.01,12.50,336.6049988095947,418.57499958823246,1.2435198558206952
2021,4,Socks,161.95000076293945,6,-32.19,-45.45,95.35665060418695,66.59335015875249,0.6983608352098357
2021,4,Socks & Hosiery,124.0,7,159.63,250.00,50.79080978922412,73.20919021077589,1.4413865523031708
2021,4,Suits,807.5300006866455,6,41.33,100.00,489.4394513814679,318.0905493051776,0.6499078658398925
2021,4,Suits & Sport Coats,933.1799755096436,7,-31.71,-41.67,395.27174835469464,537.9082271549489,1.3608567508150375
2021,4,Sweaters,1321.5000095367432,16,-30.45,-36.00,646.7331641469511,674.766845389792,1.0433465960877661
2021,4,Swim,836.8400020599365,16,-0.08,-5.88,410.50989250400534,426.33010955593113,1.0385379678804487
2021,4,Tops & Tees,1469.8499965667725,20,45.6,-20.00,840.1460159081535,629.7039806586189,0.7495173085811068
2021,4,Underwear,297.0500011444092,12,28.92,33.33,135.7267006513478,161.32330049306137,1.1885892732887218
2021,5,Accessories,611.5599975585938,10,0.48,-47.37,244.41750796283574,367.142489595758,1.5021120731317776
2021,5,Active,733.7699995040894,17,-53.47,-19.05,305.51184110756765,428.2581583965217,1.4017727000170062
2021,5,Blazers & Jackets,298.04000186920166,5,75.98,25.00,105.81027142288491,192.22973044631675,1.8167397915278463
2021,5,Dresses,829.7600059509277,11,17.46,83.33,378.8869119575919,450.87309399333583,1.1899938471450848
2021,5,Fashion Hoodies & Sweatshirts,447.100004196167,11,-51.03,-42.11,230.620182522915,216.47982167325196,0.9386855014380278
2021,5,Intimates,641.1400022506714,21,-11.68,23.53,337.1341206955473,304.00588155512406,0.9017357273951512
2021,5,Jeans,1953.6300029754639,21,-35.56,-8.70,1053.5895201507133,900.0404828247507,0.8542610434242002
2021,5,Jumpsuits & Rompers,58.239999771118164,2,-46.42,0.00,33.109239843320324,25.13075992779784,0.7590255785612029
2021,5,Leggings,42.34000015258789,3,-65.56,0.00,24.31045014927089,18.029550003317002,0.7416378509082333
2021,5,Maternity,710.9499969482422,11,65.13,37.50,316.9299994604066,394.0199974878356,1.2432398263297246
2021,5,Outerwear & Coats,3691.6900024414062,17,177.19,41.67,1655.9090614402896,2035.7809410011168,1.2294038292358997
2021,5,Pants,1240.6800022125244,17,72.33,88.89,562.1847522621192,678.4952499504052,1.2068901677256023
2021,5,Pants & Capris,181.45999717712402,6,-58.82,0.00,97.18975828739535,84.27023888972866,0.8670691271866016
2021,5,Plus,104.44000053405762,4,-55.16,-50.00,52.98146027404438,51.45854026001324,0.9712556051465191
2021,5,Shorts,1153.730004310608,22,31.02,22.22,576.7448625466203,576.9851417639876,1.0004166126704732
2021,5,Skirts,51.94000053405762,2,-71.5,-66.67,19.580330185722865,32.35967034833475,1.6526621380435165
2021,5,Sleep & Lounge,971.9500122070312,20,28.7,11.11,464.8108846301873,507.139127576844,1.0910655157749456
2021,5,Socks,378.5000009536743,20,133.71,233.33,227.9435610188649,150.55643993480942,0.6604987623333181
2021,5,Socks & Hosiery,101.60000038146973,5,-18.06,-28.57,40.0366000015378,61.56340037993193,1.5376780340380374
2021,5,Suits,89.98999786376953,1,-88.86,-83.33,54.9838888234949,35.00610904027463,0.6366612072974427
2021,5,Suits & Sport Coats,1455.900016784668,8,56.01,14.29,598.5376044366076,857.3624123480604,1.4324286494164051
2021,5,Sweaters,2129.759979248047,25,61.16,56.25,1043.9514997299316,1085.8084795181153,1.0400947551672775
2021,5,Swim,1420.110008239746,23,69.7,43.75,802.5693577571395,617.5406504826065,0.7694545580563724
2021,5,Tops & Tees,833.0400018692017,20,-43.32,0.00,460.4967698817819,372.54323198741974,0.8090029210911914
2021,5,Underwear,287.1599988937378,13,-3.33,8.33,133.2258895487456,153.93410934499218,1.1554369039410295
2021,6,Accessories,537.1500005722046,19,-12.17,90.00,208.01736923253128,329.1326313396733,1.5822362937959948
2021,6,Active,1406.3200101852417,25,91.66,47.06,577.9122660583419,828.4077441268998,1.433448972760287
2021,6,Blazers & Jackets,1189.660011291504,9,299.16,80.00,450.69150681306235,738.9685044784416,1.6396326385288433
2021,6,Dresses,409.87000274658203,9,-50.6,-18.18,178.3339909788773,231.53601176770474,1.298327988381805
2021,6,Fashion Hoodies & Sweatshirts,2136.9100074768066,26,377.95,136.36,1176.869374931465,960.0406325453416,0.8157580212343019
2021,6,Intimates,515.7600054740906,18,-19.56,-14.29,282.6630027944257,233.09700267966488,0.8246463115980939
2021,6,Jeans,3118.400001525879,28,59.62,33.33,1699.344778673921,1419.055222851958,0.8350602188917271
2021,6,Jumpsuits & Rompers,39.46999931335449,3,-32.23,50.00,20.258799615987392,19.2111996973671,0.9482891415840072
2021,6,Leggings,210.82999992370605,8,397.95,166.67,123.6137801698123,87.21621975389375,0.705554183636177
2021,6,Maternity,432.12999534606934,11,-39.22,0.00,181.63696869567661,250.49302665039272,1.379086143361492
2021,6,Outerwear & Coats,1661.8500022888184,13,-54.98,-23.53,754.6738504265227,907.1761518622957,1.2020770977417365
2021,6,Pants,878.6900062561035,13,-29.18,-23.53,399.40207347560704,479.2879327804965,1.200013631901609
2021,6,Pants & Capris,580.2900009155273,12,219.79,100.00,303.38935980462225,276.90064111090504,0.9126906800199733
2021,6,Plus,128.9099998474121,6,23.43,50.00,66.84694995083771,62.0630498965744,0.9284350287068952
2021,6,Shorts,929.4300065040588,23,-19.44,4.55,465.1981334384129,464.2318730656459,0.9979229057399154
2021,6,Skirts,93.6800012588501,3,80.36,50.00,37.63012040387478,56.04988085497532,1.489495123943421
2021,6,Sleep & Lounge,857.9200038909912,18,-11.73,-10.00,462.66297233785247,395.25703155313875,0.8543087629336121
2021,6,Socks,266.07000064849854,13,-29.7,-35.00,163.73963077238938,102.33036987610917,0.6249578638561621
2021,6,Socks & Hosiery,129.88000011444092,8,27.83,60.00,53.351119907361564,76.52888020707935,1.4344381212608743
2021,6,Suits & Sport Coats,1881.9799995422363,10,29.27,25.00,763.4922572956865,1118.4877422465497,1.4649627832615728
2021,6,Sweaters,1015.1600036621094,16,-52.33,-36.00,477.5695210937779,537.5904825683315,1.1256800503874023
2021,6,Swim,1473.6600131988525,25,3.77,8.70,739.6591386147913,734.0008745840612,0.9923501735659932
2021,6,Tops & Tees,562.3100004196167,14,-32.5,-30.00,320.3231795698434,241.9868208497733,0.7554458630647127
2021,6,Underwear,447.94000339508057,15,55.99,15.38,210.1522618908582,237.78774150422237,1.1315021754451378
2021,7,Accessories,991.3699972629547,19,84.56,0.00,401.1098676541293,590.2601296088254,1.4715672118986547
2021,7,Active,874.3900003433228,16,-37.82,-36.00,352.4959320621227,521.8940682812001,1.4805676344350645
2021,7,Blazers & Jackets,1047.0400123596191,8,-11.99,-11.11,400.5955569590189,646.4444554006003,1.61370850018372
2021,7,Dresses,1076.520004272461,10,162.65,11.11,487.16363119239816,589.3563730800628,1.2097708764456292
2021,7,Fashion Hoodies & Sweatshirts,1030.000005722046,21,-51.8,-19.23,519.3823435691556,510.61766215289026,0.9831247990525916
2021,7,Intimates,687.7300024032593,19,33.34,5.56,362.9775307550172,324.7524716482421,0.8946902883292405
2021,7,Jeans,2909.030014038086,27,-6.71,-3.57,1550.7613548987997,1358.2686591392862,0.8758721352247811
2021,7,Jumpsuits & Rompers,80.22999954223633,3,103.27,0.00,44.51425971663162,35.71573982560471,0.8023437894500227
2021,7,Leggings,143.63999938964844,7,-31.87,-12.50,88.55248977969097,55.08750960995747,0.622088771834753
2021,7,Maternity,536.0300025939941,8,24.04,-27.27,243.77339208381963,292.25661051017454,1.1988864248551143
2021,7,Outerwear & Coats,1749.6400051116943,12,5.28,-7.69,784.3661347638638,965.2738703478306,1.230641950953721
2021,7,Pants,841.2700042724609,16,-4.26,23.08,385.85270262482317,455.41730164763777,1.1802879662357957
2021,7,Pants & Capris,425.8800048828125,11,-26.61,-8.33,226.91567240339464,198.96433247941786,0.8768205843698321
2021,7,Plus,76.22999954223633,3,-40.87,-50.00,35.625099873473495,40.60489966876283,1.1397834620246863
2021,7,Shorts,958.9699993133545,23,3.18,0.00,478.0951097026536,480.8748896107009,1.0058142822455896
2021,7,Sleep & Lounge,1089.8000011444092,23,27.03,27.78,577.1606413421968,512.6393598022124,0.8882091450485275
2021,7,Socks,117.80000042915344,10,-55.73,-23.08,70.13347043632596,47.66652999282748,0.6796545172551217
2021,7,Socks & Hosiery,184.98000144958496,8,42.42,0.00,76.84190033132853,108.13810111825643,1.4072804114940454
2021,7,Suits & Sport Coats,1274.9699974060059,11,-32.25,10.00,498.2306473445803,776.7393500614255,1.5589955258698214
2021,7,Sweaters,1092.3499908447266,21,7.6,31.25,532.3378553102643,560.0121355344622,1.051986308973027
2021,7,Swim,1405.2100105285645,22,-4.64,-12.00,750.4545892511379,654.7554212774265,0.8724784026316537
2021,7,Tops & Tees,958.7300033569336,24,70.5,71.43,533.3008402842803,425.42916307265324,0.797728281931592
2021,7,Underwear,410.43000507354736,13,-8.37,-13.33,195.59531267943845,214.8346923941089,1.098363194143624
2021,8,Accessories,908.510006904602,20,-8.36,5.26,354.788911179952,553.72109572465,1.560705755664945
2021,8,Active,386.34999656677246,11,-55.81,-31.25,161.69959919818453,224.65039736858793,1.3893070761001007
2021,8,Blazers & Jackets,738.3100051879883,5,-29.49,-37.50,302.40024445664716,435.9097607313411,1.4414993662276427
2021,8,Dresses,1819.8100032806396,13,69.05,30.00,856.5833505558777,963.2266527247618,1.124498453185762
2021,8,Fashion Hoodies & Sweatshirts,1628.430009841919,30,58.1,42.86,838.3041464198888,790.1258634220302,0.9425288742712158
2021,8,Intimates,1213.1000032424927,33,76.39,73.68,645.4398313688993,567.6601718735934,0.8794935550687278
2021,8,Jeans,2897.420000076294,29,-0.4,7.41,1549.3664984521502,1348.0535016241438,0.8700675424251639
2021,8,Jumpsuits & Rompers,191.96000003814697,3,139.26,0.00,105.3934800195512,86.56652001859577,0.8213650408216627
2021,8,Leggings,275.55999755859375,10,91.84,42.86,164.18933880060337,111.37065875799038,0.67830627476515
2021,8,Maternity,361.9099979400635,8,-32.48,0.00,160.1268795336698,201.78311840639367,1.2601451985702676
2021,8,Outerwear & Coats,3084.159990310669,24,76.27,100.00,1378.0794158763417,1706.0805744343272,1.2380132485684103
2021,8,Pants,1079.3500022888184,18,28.3,12.50,489.5819320572565,589.7680702315619,1.2046361019764689
2021,8,Pants & Capris,330.84000301361084,8,-22.32,-27.27,173.96642135192633,156.8735816616845,0.9017463280706122
2021,8,Plus,499.3499994277954,12,555.06,300.00,260.6418895071909,238.7081099206045,0.9158470665323301
2021,8,Shorts,1453.2800092697144,30,51.55,30.43,739.3467247680113,713.933284501703,0.9656271686680125
2021,8,Skirts,175.6500015258789,4,87.5,33.33,69.3009002294898,106.34910129638911,1.5345991313852239
2021,8,Sleep & Lounge,820.8599987030029,18,-24.68,-21.74,451.7979602907905,369.0620384122124,0.8168740694948539
2021,8,Socks,257.76000213623047,14,118.81,40.00,155.99017164703358,101.76983048919689,0.6524118116843691
2021,8,Socks & Hosiery,166.44999980926514,9,-10.02,12.50,68.18164968423956,98.26835012502558,1.4412726969811156
2021,8,Suits & Sport Coats,829.1399898529053,7,-34.97,-36.36,327.6960348544773,501.4439549984279,1.5302106271170117
2021,8,Sweaters,1717.0500030517578,20,57.19,-4.76,830.3035404517418,886.746462600016,1.0679786600904597
2021,8,Swim,881.5700035095215,17,-37.26,-22.73,465.7186139972963,415.8513895122252,0.8929241327567796
2021,8,Tops & Tees,1197.3200035095215,25,24.89,4.17,674.1283806220348,523.1916228874867,0.7761008702893134
2021,8,Underwear,269.30000019073486,11,-34.39,-15.38,128.18830026467498,141.11169992605988,1.1008157502260463
2021,9,Accessories,792.3900003433228,19,-12.78,-5.00,324.39799907124507,467.99200127207763,1.4426476199358311
2021,9,Active,244.46000480651855,8,-36.73,-27.27,105.18984255084847,139.27016225567007,1.3239886939496774
2021,9,Blazers & Jackets,523.370002746582,10,-29.11,100.00,196.79541206842583,326.5745906781562,1.65946241960461
2021,9,Dresses,1157.9100046157837,11,-36.37,-15.38,524.2172815197159,633.6927230960678,1.208836002618953
2021,9,Fashion Hoodies & Sweatshirts,1066.1300029754639,19,-34.53,-36.67,547.3456218553442,518.7843811201195,0.9478186367173079
2021,9,Intimates,1016.8000054359436,26,-16.18,-21.21,531.6375719967732,485.16243343917034,0.9125811624203924
2021,9,Jeans,2896.920000076294,29,-0.02,0.00,1542.6538481013902,1354.2661519749038,0.8778807725671296
2021,9,Jumpsuits & Rompers,316.98999977111816,4,65.13,33.33,163.3019395713,153.68806019981815,0.9411281984970895
2021,9,Leggings,128.55000114440918,8,-53.35,-20.00,76.21850083488971,52.33150030951947,0.6865983945667461
2021,9,Maternity,555.8899998664856,9,53.6,12.50,230.26484048119733,325.62515938528827,1.4141332159300184
2021,9,Outerwear & Coats,2724.7300033569336,17,-11.65,-29.17,1216.9564533503662,1507.7735500065673,1.2389708324037079
2021,9,Pants,1233.140001296997,18,14.25,0.00,571.9729517891204,661.1670495078766,1.155941111270662
2021,9,Pants & Capris,456.89000511169434,9,38.1,12.50,242.43551237411774,214.4544927375766,0.8845836595368015
2021,9,Plus,621.1999979019165,18,24.4,50.00,312.8006089465051,308.3993889554114,0.9859296310006659
2021,9,Shorts,1356.740005493164,30,-6.64,0.00,670.3102622942093,686.4297431989546,1.0240477907194419
2021,9,Skirts,175.1800022125244,3,-0.27,-25.00,75.52964057987988,99.65036163264456,1.319354373562187
2021,9,Sleep & Lounge,1532.5600092411041,35,86.7,94.44,793.5937642834035,738.9662449577006,0.9311643793282193
2021,9,Socks,361.83000087738037,18,40.37,28.57,220.60305097492278,141.2269499024576,0.640185841847272
2021,9,Socks & Hosiery,90.45999908447266,8,-45.65,-11.11,36.977269493680005,53.48272959079266,1.4463677368047334
2021,9,Suits,261.25000381469727,3,190.31,200.00,156.68007271408692,104.56993110061035,0.6674105346595782
2021,9,Suits & Sport Coats,1246.3000106811523,11,50.31,57.14,511.31949267847114,734.9805180026812,1.437419321044451
2021,9,Sweaters,1456.7300033569336,20,-15.16,0.00,696.2806417996052,760.4493615573284,1.0921592758803016
2021,9,Swim,1514.7200012207031,28,71.82,64.71,811.9241739201917,702.7958273005113,0.8655929332750631
2021,9,Tops & Tees,610.5200073719025,21,-49.01,-16.00,346.38686330401373,264.13314406788874,0.7625379945083735
2021,9,Underwear,279.32000064849854,13,3.72,18.18,125.97556048211507,153.34444016638346,1.2172554706605492
2021,10,Accessories,824.8700008392333,19,4.1,0.00,340.58174931913106,484.2882515201023,1.4219442248102252
2021,10,Active,842.2700099945068,16,244.54,100.00,364.5884757607754,477.6815342337315,1.3101937279749951
2021,10,Blazers & Jackets,1019.1599998474121,7,94.73,-30.00,384.20005279649405,634.9599470509181,1.6526805304403445
2021,10,Dresses,1093.5399980545044,12,-5.56,9.09,473.59223856087425,619.9477594936301,1.309032769154944
2021,10,Fashion Hoodies & Sweatshirts,1530.1800022125244,28,43.53,47.37,782.096721819083,748.0832803934414,0.9565099296842346
2021,10,Intimates,1196.0900058746338,29,17.63,11.54,634.5558719979796,561.5341338766542,0.884924651486705
2021,10,Jeans,2779.7899990081787,28,-4.04,-3.45,1496.0686775244508,1283.721321483728,0.8580630961460308
2021,10,Jumpsuits & Rompers,91.43000030517578,1,-71.16,-75.00,50.92651017270774,40.503490132468045,0.795332136349183
2021,10,Leggings,121.21999931335449,6,-5.7,-25.00,73.26865980658695,47.95133950676754,0.6544590775011917
2021,10,Maternity,385.6500015258789,12,-30.62,33.33,167.66583114149242,217.9841703843865,1.3001108747102483
2021,10,Outerwear & Coats,3325.5,24,22.05,41.18,1475.5125917763578,1849.9874082236422,1.253793033373207
2021,10,Pants,758.2700061798096,13,-38.51,-27.78,348.4078836982976,409.86212248151196,1.1763859018656144
2021,10,Pants & Capris,655.6299991607666,14,43.5,55.56,351.6822892086683,303.94770995209825,0.8642678897365598
2021,10,Plus,441.42000007629395,7,-28.94,-61.11,226.82714008527307,214.59285999102087,0.9460634204105697
2021,10,Shorts,917.439998626709,23,-32.38,-23.33,458.1088995416694,459.33109908503957,1.002667923597627
2021,10,Skirts,639.2299995422363,8,264.9,166.67,252.6304688912199,386.59953065101644,1.530296532907447
2021,10,Sleep & Lounge,973.8400001525879,22,-36.46,-37.14,481.5548597205171,492.2851404320708,1.0222825717464077
2021,10,Socks,294.11999893188477,16,-18.71,-11.11,177.9874697691337,116.13252916275107,0.6524758698653661
2021,10,Socks & Hosiery,190.85000133514404,10,110.98,25.00,76.52765029866099,114.32235103648306,1.4938698704366644
2021,10,Suits,427.239990234375,5,63.54,66.67,262.9730343488809,164.2669558854941,0.624653232192486
2021,10,Suits & Sport Coats,1546.309986114502,12,24.07,9.09,575.8761227407145,970.4338633737874,1.6851434276442827
2021,10,Sweaters,1356.3799991607666,20,-6.89,0.00,649.1001491637636,707.279849997003,1.0896313163819056
2021,10,Swim,2116.4299869537354,33,39.72,17.86,1026.4519375882603,1089.978049365475,1.0618890270950971
2021,10,Tops & Tees,1651.5500001907349,33,170.52,57.14,930.1539876536044,721.3960125371303,0.7755662203383286
2021,10,Underwear,652.0500030517578,24,133.44,84.62,311.75299180698,340.2970112447778,1.0915597289775834
2021,11,Accessories,533.7200016975403,17,-35.3,-10.53,210.55545978875736,323.16454190878295,1.534819102924247
2021,11,Active,775.299994468689,20,-7.95,25.00,324.8603991416268,450.43959532706214,1.386563571667249
2021,11,Blazers & Jackets,929.4100017547607,7,-8.81,0.00,356.85335287916996,572.5566488755908,1.604459210642355
2021,11,Dresses,1092.6600093841553,11,-0.08,-8.33,496.98622378459453,595.6737855995607,1.198572026933567
2021,11,Fashion Hoodies & Sweatshirts,1218.7200050354004,22,-20.35,-21.43,606.8766432033138,611.8433618320865,1.0081840662091666
2021,11,Intimates,1406.4000005722046,31,17.58,6.90,753.755369465626,652.6446311065786,0.8658573557748188
2021,11,Jeans,3145.840005874634,29,13.17,3.57,1689.8514305152632,1455.9885753593703,0.8616074461146065
2021,11,Jumpsuits & Rompers,82.46999835968018,2,-9.8,100.00,45.098219133357254,37.37177922632292,0.8286752768621098
2021,11,Leggings,225.45999813079834,8,85.99,33.33,137.78566937416318,87.67432875663515,0.6363094881700039
2021,11,Maternity,583.569995880127,10,51.32,-16.67,249.26880915275825,334.3011867273687,1.3411272267221386
2021,11,Outerwear & Coats,4707.790004730225,28,41.57,16.67,2116.0787558544744,2591.7112488757502,1.2247706951857824
2021,11,Pants,1344.8800106048584,22,77.36,69.23,622.8057858979341,722.0742247069243,1.1593890761080026
2021,11,Pants & Capris,344.0700044631958,6,-47.52,-57.14,181.71815217452345,162.35185228867235,0.8934267179469689
2021,11,Plus,321.2199954986572,6,-27.23,-14.29,163.04777767301843,158.1722178256388,0.9700973547940209
2021,11,Shorts,947.5500011444092,18,3.28,-21.74,480.37188106205724,467.17812008235194,0.9725342770885441
2021,11,Skirts,112.44000148773193,3,-82.41,-62.50,45.546930439850016,66.89307104788192,1.4686625509532842
2021,11,Sleep & Lounge,1319.4300079345703,30,35.49,36.36,670.19279419789,649.2372137366804,0.968732011679878
2021,11,Socks,364.020001411438,20,23.77,25.00,222.87314142001668,141.14685999142134,0.6333058308063345
2021,11,Socks & Hosiery,144.9199993610382,9,-24.07,-10.00,54.87399952987582,90.04599983116239,1.6409592995337872
2021,11,Suits,624.5500030517578,5,46.18,0.00,377.43713293944495,247.1128701123129,0.6547126621798471
2021,11,Suits & Sport Coats,614.9300003051758,5,-60.23,-58.33,262.482899874071,352.44710043110473,1.3427430914554626
2021,11,Sweaters,2357.680004119873,27,73.82,35.00,1140.4582307864562,1217.2217733334169,1.0673093853634823
2021,11,Swim,1471.9300060272217,28,-30.45,-15.15,741.1528364768425,730.7771695503792,0.9860006379038023
2021,11,Tops & Tees,1517.4100017547607,30,-8.12,-9.09,859.4748290367966,657.9351727179642,0.7655083668422314
2021,11,Underwear,546.1199998855591,18,-16.25,-25.00,255.81739055503778,290.3026093305213,1.1348040440122629
2021,12,Accessories,963.529997587204,28,80.53,64.71,386.7430578380842,576.7869397491197,1.4913957162499352
2021,12,Active,1272.1800003051758,30,64.09,50.00,533.4492820666255,738.7307182385503,1.384819031673729
2021,12,Blazers & Jackets,990.7299995422363,7,6.6,0.00,376.36280266847905,614.3671968737573,1.6323802259888194
2021,12,Clothing Sets,109.0,2,55.74,100.00,71.83999959379435,37.160000406205654,0.5172605876436502
2021,12,Dresses,1651.28999710083,16,51.13,45.45,742.4716071175117,908.8183899833184,1.2240446385709116
2021,12,Fashion Hoodies & Sweatshirts,1383.5799980163574,26,13.53,18.18,689.4401001395356,694.1398978768218,1.0068168325810103
2021,12,Intimates,878.1500005722046,28,-37.56,-9.68,470.0783295463159,408.0716710258887,0.8680929227682728
2021,12,Jeans,2491.0,25,-20.82,-13.79,1309.752357292019,1181.247642707981,0.9018862505811952
2021,12,Jumpsuits & Rompers,29.270000457763672,2,-64.51,0.00,16.053420242005885,13.216580215757787,0.8232874998920708
2021,12,Leggings,162.08999919891357,7,-28.11,-12.50,98.14259976494088,63.947399433972684,0.6515763754692829
2021,12,Maternity,625.2099990844727,8,7.14,-20.00,279.5858705115329,345.62412857293975,1.2362002698512005
2021,12,Outerwear & Coats,2980.789981842041,29,-36.68,3.57,1322.4898042319362,1658.3001776101048,1.253922844851872
2021,12,Pants,1337.7900066375732,19,-0.53,-13.64,620.2237743461319,717.5662322914413,1.1569473180029777
2021,12,Pants & Capris,743.9900197982788,15,116.23,150.00,403.5719405323115,340.4180792659673,0.8435127546700987
2021,12,Plus,228.63000106811523,10,-28.82,66.67,116.52672058446493,112.10328048365031,0.9620392637960813
2021,12,Shorts,1103.700002193451,27,16.48,50.00,550.5478811819412,553.1521210115097,1.0047302694617182
2021,12,Skirts,266.98999977111816,3,137.45,0.00,110.16567939161479,156.82432037950338,1.4235315503481567
2021,12,Sleep & Lounge,1303.4700050354004,26,-1.21,-13.33,673.850652606672,629.6193524287283,0.9343603808843358
2021,12,Socks,198.51999950408936,12,-45.46,-40.00,120.93426005178202,77.58573945230734,0.6415530174748365
2021,12,Socks & Hosiery,130.8100004196167,10,-9.74,11.11,55.898920012673756,74.91108040694294,1.3401167748850717
2021,12,Suits,543.2400131225586,4,-13.02,-20.00,317.5373885909253,225.70262453163332,0.7107907057281996
2021,12,Suits & Sport Coats,1230.129997253418,8,100.04,60.00,470.41048635088487,759.7195109025331,1.6150139781021997
2021,12,Sweaters,3885.770009994507,31,64.81,14.81,1815.8963737633285,2069.8736362311784,1.1398633017486006
2021,12,Swim,1906.1799936294556,29,29.5,3.57,890.9704206730858,1015.2095729563698,1.1394425105486974
2021,12,Tops & Tees,1406.8200092315674,33,-7.29,10.00,773.5915035953219,633.2285056362455,0.8185566965165344
2021,12,Underwear,527.230001449585,21,-3.46,16.67,250.7546010396626,276.4754004099224,1.102573588933634


2025-02-12 07:07:19 - root - INFO - Please check the answer again by reviewing Generate a monthly report for each product category , where each row corresponds to orders that have a status of 'Complete' and were delivered before the year 2022, grouping by the month and year of delivery. For each category, calculate the total revenue (the sum of sale_price), the total number of completed orders, and compute the month-over-month percentage growth for both revenue and orders by comparing each month’s totals to the previous month’s. Then, for the same orders, aggregate and show the total cost (from product costs), total profit (revenue minus total cost), and finally the profit-to-cost ratio for each month., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Year,Month,Category,Total_Revenue,Total_Completed_Orders,Revenue_MoM_Growth(%),Orders_MoM_Growth(%),Total_Cost,Total_Profit,Profit_to_Cost_Ratio
year:int,month:int,category:str,total_revenue:float,total_orders:int,revenue_mom_growth:float,orders_mom_growth:float,total_cost:float,total_profit:float,profit_to_cost_ratio:float
...
```

This report displays, for each product category and for each month and year before 2022, the total revenue from completed orders, the total number of completed orders, the month-over-month growth percentages for both revenue and orders compared to the previous month, the total cost of products sold, the total profit (calculated as revenue minus total cost), and the profit-to-cost ratio for that period. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
year,month,category,total_revenue,total_completed_orders,revenue_mom_growth,orders_mom_growth,total_cost,total_profit,profit_to_cost_ratio
2019,2,Accessories,26.950000762939453,2,,,11.803900280861555,15.146100482077898,1.2831437170504798
2019,2,Active,84.94999694824217,1,,,34.82949891966953,50.12049802857264,1.439024378276878
2019,2,Fashion Hoodies & Sweatshirts,400.2699890136719,4,,,230.10690333794258,170.1630856757293,0.7394957874246049
2019,2,Maternity,62.0,1,,,28.458000045269728,33.54199995473027,1.178649234007068
2019,2,Shorts,83.98999977111816,2,,,40.1587299695839,43.83126980153426,1.0914505970366077
2019,2,Sleep & Lounge,166.5,2,,,60.15849962644279,106.34150037355721,1.7676887062325368
2019,2,Socks,51.81999921798706,4,,,30.17878962317765,21.64120959480941,0.717099985288632
2019,2,Socks & Hosiery,10.0,1,,,4.219999983906746,5.780000016093254,1.3696682554823871
2019,2,Sweaters,42.0,1,,,21.58800001814961,20.41199998185039,0.9455252901931385
2019,2,Tops & Tees,130.0,1,,,74.35999983921647,55.64000016078353,0.7482517520318731
2019,3,Active,66.9900016784668,2,-21.14,100.00,26.697080748638214,40.29292092982858,1.5092631778432881
2019,3,Intimates,46.0,2,,,24.695999963209033,21.304000036790967,0.8626498246083855
2019,3,Jeans,239.9900016784668,2,,,137.73219094341755,102.25781073504925,0.7424394401527984
2019,3,Maternity,38.0,1,-38.71,0.00,17.974000044167042,20.025999955832958,1.1141648996674969
2019,3,Outerwear & Coats,903.0,1,,,419.89500154741114,483.10499845258886,1.1505376264833687
2019,3,Shorts,61.97999954223633,2,-26.21,0.00,30.00771983284384,31.972279709392488,1.0654684823602762
2019,3,Sleep & Lounge,64.0,1,-61.56,-50.00,40.25600004196167,23.74399995803833,0.589825117579697
2019,3,Socks,9.359999656677246,1,-81.94,-75.00,5.718959803619384,3.641039853057862,0.6366612072974425
2019,3,Suits,88.2699966430664,1,,,52.167568181783246,36.10242846128316,0.6920473719511047
2019,3,Sweaters,63.59999847412109,1,51.43,0.00,30.1463992426157,33.453599231505386,1.1097046437378346
2019,3,Swim,41.650001525878906,1,,,25.281550997271015,16.36845052860789,0.6474464533593988
2019,4,Accessories,50.0,1,85.53,-50.00,22.499999962747097,27.500000037252903,1.2222222259015212
2019,4,Active,25.0,1,-62.68,-50.00,9.325000084936617,15.674999915063383,1.680965123033554
2019,4,Fashion Hoodies & Sweatshirts,91.9000015258789,2,-77.04,-50.00,51.9729608638072,39.9270406620717,0.7682271704069104
2019,4,Intimates,42.0,1,-8.7,-50.00,21.16799994930625,20.83200005069375,0.9841269888786299
2019,4,Jeans,34.5,1,-85.62,-50.00,19.802999968640503,14.697000031359497,0.7421602815044827
2019,4,Leggings,19.989999771118164,1,,,11.49424989073351,8.495749880384654,0.7391304314023831
2019,4,Maternity,30.5,2,-19.74,100.00,13.275700017678737,17.224299982321263,1.297430640899111
2019,4,Outerwear & Coats,41.9900016784668,1,-95.35,0.00,20.155200824435056,21.83480085403174,1.083333331393078
2019,4,Pants,95.0,1,,,46.2650001514703,48.7349998485297,1.0533880836263414
2019,4,Pants & Capris,42.9900016784668,1,,,22.397790862309783,20.592210816157014,0.9193857975881391
2019,4,Plus,12.989999771118164,1,,,6.884699869982152,6.105299901136012,0.8867924552173454
2019,4,Shorts,185.70000076293945,2,199.61,0.00,94.07300041953474,91.62700034340472,0.973998915042343
2019,4,Sleep & Lounge,239.93999862670898,2,274.91,100.00,103.23418890256569,136.7058097241433,1.3242299976141503
2019,4,Socks,42.0,2,348.72,100.00,25.677000034600496,16.322999965399504,0.6357051035324918
2019,4,Sweaters,189.89999389648438,2,198.58,100.00,79.71955737863719,110.18043651784718,1.3821004549050937
2019,4,Swim,52.0,1,24.85,0.00,31.98000006005168,20.01999993994832,0.6260162571092869
2019,4,Tops & Tees,61.4300012588501,2,-52.75,100.00,33.98246059634998,27.447540662500117,0.8076972703220975
2019,4,Underwear,29.979999542236328,2,,,13.371079809686243,16.608919732550085,1.2421524640454464
2019,5,Accessories,141.65000343322754,3,183.3,200.00,54.78807118436351,86.86193224886404,1.5854168685108665
2019,5,Active,144.0,3,476.0,200.00,56.24600021960214,87.75399978039786,1.560182047394989
2019,5,Dresses,68.85000038146973,2,,,30.49630012205504,38.35370025941469,1.2576509316183293
2019,5,Intimates,300.8800048828125,5,616.38,400.00,163.69096263941466,137.18904224339784,0.8380978401697327
2019,5,Jeans,86.75,1,151.45,0.00,46.23774990369566,40.51225009630434,0.8761726117876317
2019,5,Jumpsuits & Rompers,15.8100004196167,1,,,8.015670201437473,7.794330218179226,0.9723865905537689
2019,5,Maternity,146.82999801635742,3,381.41,50.00,65.57566925949037,81.25432875686704,1.239092634119134
2019,5,Pants,94.9900016784668,2,-0.01,100.00,44.724950980293755,50.26505069817304,1.1238704480709283
2019,5,Pants & Capris,11.970000267028809,1,-72.16,0.00,6.679260151320845,5.290740115707964,0.7921146947183518
2019,5,Plus,16.989999771118164,1,30.79,0.00,9.259549905639886,7.730449865478278,0.8348623793009365
2019,5,Shorts,84.38000106811523,1,-54.56,-50.00,42.223620457333624,42.15638061078161,0.9984075300548906
2019,5,Sleep & Lounge,47.59000015258789,2,-80.17,0.00,22.638660046156645,24.951340106431243,1.1021562254815174
2019,5,Socks & Hosiery,40.0,2,300.0,100.00,14.814999895170331,25.18500010482967,1.6999662695265993
2019,5,Suits & Sport Coats,299.989990234375,1,,,125.69580527790504,174.29418495646996,1.3866348568364486
2019,5,Sweaters,72.95999908447266,1,-61.58,-50.00,34.5100795158577,38.44991956861496,1.1141649079929494
2019,5,Swim,143.86000061035156,3,176.65,200.00,76.41246068592272,67.44753992442882,0.882677240321545
2019,5,Tops & Tees,49.0,2,-20.23,0.00,25.73399992659688,23.26600007340312,0.9040957542460002
2019,5,Underwear,47.0,2,56.77,0.00,23.09899999492336,23.90100000507664,1.034720118201201
2019,6,Accessories,153.0999984741211,4,8.08,33.33,59.93658919489741,93.16340927922369,1.5543662148722166
2019,6,Active,100.0,2,-30.56,-33.33,39.570000153034925,60.429999846965075,1.5271670359680358
2019,6,Blazers & Jackets,53.180000305175774,1,,,18.13438020391285,35.04562010126293,1.932551303501464
2019,6,Dresses,255.97999954223633,2,271.79,0.00,109.95543970878184,146.02455983345448,1.3280339764926783
2019,6,Fashion Hoodies & Sweatshirts,161.18000030517578,3,75.39,50.00,88.04046018625466,73.1395401189211,0.830749180140474
2019,6,Intimates,148.98999977111816,5,-50.48,0.00,80.20079976015239,68.78920001096577,0.8577121452240624
2019,6,Jeans,362.9900016784668,3,318.43,200.00,195.81501029584348,167.17499138262332,0.8537394101200417
2019,6,Leggings,6.980000019073486,1,-65.08,0.00,4.020480019931197,2.959519999142289,0.7361111072485658
2019,6,Maternity,73.41999816894531,1,-50.0,-66.67,30.689559341835377,42.730438827109936,1.3923444892498238
2019,6,Outerwear & Coats,1182.9399948120117,4,2717.19,300.00,498.4235495672066,684.5164452448051,1.3733629677794872
2019,6,Pants,79.95000076293945,2,-15.83,0.00,35.13940036381632,44.81060039912313,1.2752238209865818
2019,6,Shorts,167.45000076293945,3,98.45,200.00,84.3871503917262,83.06285037121327,0.9843068522356129
2019,6,Sleep & Lounge,14.989999771118164,1,-68.5,-50.00,5.876079882245586,9.113919888872578,1.551020420333297
2019,6,Socks,119.9499969482422,1,185.6,-50.00,74.96874831607565,44.981248632166555,0.5999999952316286
2019,6,Suits & Sport Coats,79.94999694824217,1,-73.35,0.00,34.05869862370491,45.89129832453726,1.3474178456306853
2019,6,Sweaters,272.9799995422363,2,274.15,100.00,136.59576972619772,136.3842298160386,0.9984513436207935
2019,6,Swim,359.2699966430664,5,149.74,66.67,198.9106884289863,160.3593082140801,0.8061874878650901
2019,6,Tops & Tees,57.50000190734863,2,17.35,0.00,33.97233098310426,23.52767092424438,0.6925539179500397
2019,6,Underwear,170.0900001525879,6,261.89,200.00,77.47823010156348,92.61177005102441,1.195326350764891
2019,7,Active,107.98999977111816,3,7.99,50.00,45.359810094130516,62.63018967698765,1.3807418846555508
2019,7,Blazers & Jackets,249.0,1,368.22,0.00,84.41100038588047,164.58899961411953,1.949852493889535
2019,7,Dresses,39.950000762939446,1,-84.39,-50.00,18.65665036343634,21.293350399503105,1.1413276223064253
2019,7,Fashion Hoodies & Sweatshirts,284.03999519348145,5,76.23,66.67,146.88776766553104,137.1522275279504,0.9337212329365041
2019,7,Intimates,224.5900046825409,5,50.74,0.00,113.70957233994298,110.8804323425979,0.9751195968894584
2019,7,Jeans,836.9500045776367,6,130.57,100.00,444.8680318977807,392.081972679856,0.8813444540109063
2019,7,Jumpsuits & Rompers,9.920000076293944,1,-37.25,0.00,5.465920032577515,4.454080043716429,0.8148820358090857
2019,7,Leggings,11.829999923706056,1,69.48,0.00,7.003359967966899,4.826639955739157,0.6891891860215702
2019,7,Maternity,34.97999954223633,1,-52.36,0.00,13.677179912753104,21.302819629483224,1.5575447398787008
2019,7,Outerwear & Coats,165.9499969482422,2,-85.97,-50.00,73.11754892709553,92.83244802114665,1.2696329319478223
2019,7,Pants,135.0,1,68.86,-50.00,56.024999879300594,78.9750001206994,1.409638559408156
2019,7,Pants & Capris,170.89999961853027,4,1327.74,300.00,92.61449962123484,78.28549999729545,0.8452834093739031
2019,7,Plus,98.05999946594238,2,477.16,100.00,51.371239695025835,46.68875977091655,0.9088501669045241
2019,7,Shorts,171.11999988555908,5,2.19,66.67,87.8599898818361,83.26001000372298,0.947644202050334
2019,7,Sleep & Lounge,166.48000144958496,4,1010.61,300.00,77.15549036873877,89.32451108084621,1.1577207358018164
2019,7,Socks,24.210000038146973,2,-79.82,100.00,14.482440074366927,9.727559963780045,0.6716796281447943
2019,7,Socks & Hosiery,12.0,1,-70.0,-50.00,4.811999982688576,7.188000017311424,1.4937655950063662
2019,7,Suits & Sport Coats,71.2400016784668,2,-10.89,100.00,26.586000506073233,44.65400117239356,1.6796058196942005
2019,7,Sweaters,100.8000030517578,1,-63.07,-50.00,55.23840171442032,45.56160133733748,0.8248175168588078
2019,7,Swim,49.5,1,-86.22,-80.00,29.056500060483813,20.443499939516187,0.703577509230676
2019,7,Tops & Tees,269.9400005340576,4,369.46,100.00,152.1400199194881,117.79998061456949,0.7742866122727522
2019,7,Underwear,103.19000053405762,4,-39.33,-33.33,47.60173036493033,55.588270169127284,1.1677783505551067
2019,8,Accessories
Current sql:
SELECT
    "year",
    "month",
    "category",
    "total_revenue",
    "total_completed_orders",
    ROUND(
        (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month")) 
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        2
    ) AS "revenue_mom_growth",
    ROUND(
        (("total_completed_orders" - LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month")) 
         / NULLIF(LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        2
    ) AS "orders_mom_growth",
    "total_cost",
    "total_profit",
    "profit_to_cost_ratio"
FROM (
    SELECT
        EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "year",
        EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "month",
        p."category",
        SUM(oi."sale_price") AS "total_revenue",
        COUNT(DISTINCT o."order_id") AS "total_completed_orders",
        SUM(p."cost") AS "total_cost",
        SUM(oi."sale_price" - p."cost") AS "total_profit",
        SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
    FROM
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        o."status" = 'Complete'
        AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6) < '2022-01-01'
    GROUP BY
        "year", "month", p."category"
) base_data
ORDER BY
    "year", "month", "category";
2025-02-12 07:08:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:08:10 - root - INFO - ```sql
SELECT
    "year",
    "month",
    "category",
    "total_revenue",
    "total_completed_orders",
    ROUND(
        (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        4
    ) AS "Revenue_MoM_Growth(%)",
    ROUND(
        (("total_completed_orders" - LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        4
    ) AS "Orders_MoM_Growth(%)",
    ROUND("total_cost", 4) AS "total_cost",
    ROUND("total_profit", 4) AS "total_profit",
    ROUND("profit_to_cost_ratio", 4) AS "profit_to_cost_ratio"
FROM (
    SELECT
        EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "year",
        EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "month",
        p."category",
        SUM(oi."sale_price") AS "total_revenue",
        COUNT(DISTINCT o."order_id") AS "total_completed_orders",
        SUM(p."cost") AS "total_cost",
        SUM(oi."sale_price" - p."cost") AS "total_profit",
        SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
    FROM
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        o."status" = 'Complete'
        AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6) < '2022-01-01'
    GROUP BY
        "year", "month", p."category"
) base_data
ORDER BY
    "year", "month", "category";
```
2025-02-12 07:08:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:08:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:08:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:08:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 796
2025-02-12 07:08:11 - snowflake.connector.connection - INFO - closed
2025-02-12 07:08:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:08:12 - root - INFO - itercount: 2
2025-02-12 07:08:12 - root - INFO - 0
2025-02-12 07:08:12 - root - INFO - results: 
year,month,category,total_revenue,total_completed_orders,Revenue_MoM_Growth(%),Orders_MoM_Growth(%),total_cost,total_profit,profit_to_cost_ratio
2019,2,Accessories,26.950000762939453,2,,,11.8039,15.1461,1.2831
2019,2,Active,84.94999694824217,1,,,34.8295,50.1205,1.439
2019,2,Fashion Hoodies & Sweatshirts,400.2699890136719,4,,,230.1069,170.1631,0.7395
2019,2,Maternity,62.0,1,,,28.458,33.542,1.1786
2019,2,Shorts,83.98999977111816,2,,,40.1587,43.8313,1.0915
2019,2,Sleep & Lounge,166.5,2,,,60.1585,106.3415,1.7677
2019,2,Socks,51.81999921798706,4,,,30.1788,21.6412,0.7171
2019,2,Socks & Hosiery,10.0,1,,,4.22,5.78,1.3697
2019,2,Sweaters,42.0,1,,,21.588,20.412,0.9455
2019,2,Tops & Tees,130.0,1,,,74.36,55.64,0.7483
2019,3,Active,66.9900016784668,2,-21.1418,100.0000,26.6971,40.2929,1.5093
2019,3,Intimates,46.0,2,,,24.696,21.304,0.8626
2019,3,Jeans,239.9900016784668,2,,,137.7322,102.2578,0.7424
2019,3,Maternity,38.0,1,-38.7097,0.0000,17.974,20.026,1.1142
2019,3,Outerwear & Coats,903.0,1,,,419.895,483.105,1.1505
2019,3,Shorts,61.97999954223633,2,-26.2055,0.0000,30.0077,31.9723,1.0655
2019,3,Sleep & Lounge,64.0,1,-61.5616,-50.0000,40.256,23.744,0.5898
2019,3,Socks,9.359999656677246,1,-81.9375,-75.0000,5.719,3.641,0.6367
2019,3,Suits,88.2699966430664,1,,,52.1676,36.1024,0.692
2019,3,Sweaters,63.59999847412109,1,51.4286,0.0000,30.1464,33.4536,1.1097
2019,3,Swim,41.650001525878906,1,,,25.2816,16.3685,0.6474
2019,4,Accessories,50.0,1,85.5288,-50.0000,22.5,27.5,1.2222
2019,4,Active,25.0,1,-62.681,-50.0000,9.325,15.675,1.681
2019,4,Fashion Hoodies & Sweatshirts,91.9000015258789,2,-77.0405,-50.0000,51.973,39.927,0.7682
2019,4,Intimates,42.0,1,-8.6957,-50.0000,21.168,20.832,0.9841
2019,4,Jeans,34.5,1,-85.6244,-50.0000,19.803,14.697,0.7422
2019,4,Leggings,19.989999771118164,1,,,11.4942,8.4957,0.7391
2019,4,Maternity,30.5,2,-19.7368,100.0000,13.2757,17.2243,1.2974
2019,4,Outerwear & Coats,41.9900016784668,1,-95.3499,0.0000,20.1552,21.8348,1.0833
2019,4,Pants,95.0,1,,,46.265,48.735,1.0534
2019,4,Pants & Capris,42.9900016784668,1,,,22.3978,20.5922,0.9194
2019,4,Plus,12.989999771118164,1,,,6.8847,6.1053,0.8868
2019,4,Shorts,185.70000076293945,2,199.6128,0.0000,94.073,91.627,0.974
2019,4,Sleep & Lounge,239.93999862670898,2,274.9062,100.0000,103.2342,136.7058,1.3242
2019,4,Socks,42.0,2,348.718,100.0000,25.677,16.323,0.6357
2019,4,Sweaters,189.89999389648438,2,198.5849,100.0000,79.7196,110.1804,1.3821
2019,4,Swim,52.0,1,24.8499,0.0000,31.98,20.02,0.626
2019,4,Tops & Tees,61.4300012588501,2,-52.7462,100.0000,33.9825,27.4475,0.8077
2019,4,Underwear,29.979999542236328,2,,,13.3711,16.6089,1.2422
2019,5,Accessories,141.65000343322754,3,183.3,200.0000,54.7881,86.8619,1.5854
2019,5,Active,144.0,3,476.0,200.0000,56.246,87.754,1.5602
2019,5,Dresses,68.85000038146973,2,,,30.4963,38.3537,1.2577
2019,5,Intimates,300.8800048828125,5,616.381,400.0000,163.691,137.189,0.8381
2019,5,Jeans,86.75,1,151.4493,0.0000,46.2377,40.5123,0.8762
2019,5,Jumpsuits & Rompers,15.8100004196167,1,,,8.0157,7.7943,0.9724
2019,5,Maternity,146.82999801635742,3,381.4098,50.0000,65.5757,81.2543,1.2391
2019,5,Pants,94.9900016784668,2,-0.0105,100.0000,44.725,50.2651,1.1239
2019,5,Pants & Capris,11.970000267028809,1,-72.1563,0.0000,6.6793,5.2907,0.7921
2019,5,Plus,16.989999771118164,1,30.7929,0.0000,9.2595,7.7304,0.8349
2019,5,Shorts,84.38000106811523,1,-54.5611,-50.0000,42.2236,42.1564,0.9984
2019,5,Sleep & Lounge,47.59000015258789,2,-80.1659,0.0000,22.6387,24.9513,1.1022
2019,5,Socks & Hosiery,40.0,2,300.0,100.0000,14.815,25.185,1.7
2019,5,Suits & Sport Coats,299.989990234375,1,,,125.6958,174.2942,1.3866
2019,5,Sweaters,72.95999908447266,1,-61.5798,-50.0000,34.5101,38.4499,1.1142
2019,5,Swim,143.86000061035156,3,176.6538,200.0000,76.4125,67.4475,0.8827
2019,5,Tops & Tees,49.0,2,-20.2344,0.0000,25.734,23.266,0.9041
2019,5,Underwear,47.0,2,56.7712,0.0000,23.099,23.901,1.0347
2019,6,Accessories,153.0999984741211,4,8.0833,33.3333,59.9366,93.1634,1.5544
2019,6,Active,100.0,2,-30.5556,-33.3333,39.57,60.43,1.5272
2019,6,Blazers & Jackets,53.180000305175774,1,,,18.1344,35.0456,1.9326
2019,6,Dresses,255.97999954223633,2,271.7938,0.0000,109.9554,146.0246,1.328
2019,6,Fashion Hoodies & Sweatshirts,161.18000030517578,3,75.3863,50.0000,88.0405,73.1395,0.8307
2019,6,Intimates,148.98999977111816,5,-50.4819,0.0000,80.2008,68.7892,0.8577
2019,6,Jeans,362.9900016784668,3,318.4323,200.0000,195.815,167.175,0.8537
2019,6,Leggings,6.980000019073486,1,-65.0825,0.0000,4.0205,2.9595,0.7361
2019,6,Maternity,73.41999816894531,1,-49.9966,-66.6667,30.6896,42.7304,1.3923
2019,6,Outerwear & Coats,1182.9399948120117,4,2717.1944,300.0000,498.4235,684.5164,1.3734
2019,6,Pants,79.95000076293945,2,-15.8332,0.0000,35.1394,44.8106,1.2752
2019,6,Shorts,167.45000076293945,3,98.4475,200.0000,84.3872,83.0629,0.9843
2019,6,Sleep & Lounge,14.989999771118164,1,-68.5018,-50.0000,5.8761,9.1139,1.551
2019,6,Socks,119.9499969482422,1,185.5952,-50.0000,74.9687,44.9812,0.6
2019,6,Suits & Sport Coats,79.94999694824217,1,-73.3491,0.0000,34.0587,45.8913,1.3474
2019,6,Sweaters,272.9799995422363,2,274.1502,100.0000,136.5958,136.3842,0.9985
2019,6,Swim,359.2699966430664,5,149.7359,66.6667,198.9107,160.3593,0.8062
2019,6,Tops & Tees,57.50000190734863,2,17.3469,0.0000,33.9723,23.5277,0.6926
2019,6,Underwear,170.0900001525879,6,261.8936,200.0000,77.4782,92.6118,1.1953
2019,7,Active,107.98999977111816,3,7.99,50.0000,45.3598,62.6302,1.3807
2019,7,Blazers & Jackets,249.0,1,368.2211,0.0000,84.411,164.589,1.9499
2019,7,Dresses,39.950000762939446,1,-84.3933,-50.0000,18.6567,21.2934,1.1413
2019,7,Fashion Hoodies & Sweatshirts,284.03999519348145,5,76.2253,66.6667,146.8878,137.1522,0.9337
2019,7,Intimates,224.5900046825409,5,50.7417,0.0000,113.7096,110.8804,0.9751
2019,7,Jeans,836.9500045776367,6,130.5711,100.0000,444.868,392.082,0.8813
2019,7,Jumpsuits & Rompers,9.920000076293944,1,-37.2549,0.0000,5.4659,4.4541,0.8149
2019,7,Leggings,11.829999923706056,1,69.4842,0.0000,7.0034,4.8266,0.6892
2019,7,Maternity,34.97999954223633,1,-52.3563,0.0000,13.6772,21.3028,1.5575
2019,7,Outerwear & Coats,165.9499969482422,2,-85.9714,-50.0000,73.1175,92.8324,1.2696
2019,7,Pants,135.0,1,68.8555,-50.0000,56.025,78.975,1.4096
2019,7,Pants & Capris,170.89999961853027,4,1327.736,300.0000,92.6145,78.2855,0.8453
2019,7,Plus,98.05999946594238,2,477.163,100.0000,51.3712,46.6888,0.9089
2019,7,Shorts,171.11999988555908,5,2.1917,66.6667,87.86,83.26,0.9476
2019,7,Sleep & Lounge,166.48000144958496,4,1010.6071,300.0000,77.1555,89.3245,1.1577
2019,7,Socks,24.210000038146973,2,-79.8166,100.0000,14.4824,9.7276,0.6717
2019,7,Socks & Hosiery,12.0,1,-70.0,-50.0000,4.812,7.188,1.4938
2019,7,Suits & Sport Coats,71.2400016784668,2,-10.8943,100.0000,26.586,44.654,1.6796
2019,7,Sweaters,100.8000030517578,1,-63.0742,-50.0000,55.2384,45.5616,0.8248
2019,7,Swim,49.5,1,-86.2221,-80.0000,29.0565,20.4435,0.7036
2019,7,Tops & Tees,269.9400005340576,4,369.4609,100.0000,152.14,117.8,0.7743
2019,7,Underwear,103.19000053405762,4,-39.3321,-33.3333,47.6017,55.5883,1.1678
2019,8,Accessories,212.15999794006348,6,38.5761,50.0000,83.5437,128.6163,1.5395
2019,8,Active,222.5400047302246,4,106.0746,33.3333,92.3029,130.2371,1.411
2019,8,Dresses,39.950000762939446,1,0.0,0.0000,17.578,22.372,1.2727
2019,8,Fashion Hoodies & Sweatshirts,367.0799961090088,7,29.2353,40.0000,193.0866,173.9934,0.9011
2019,8,Intimates,146.39000129699707,5,-34.819,0.0000,77.3077,69.0823,0.8936
2019,8,Jeans,680.2299995422363,8,-18.7251,33.3333,351.3454,328.8846,0.9361
2019,8,Leggings,37.69000053405762,2,218.5968,100.0000,21.6162,16.0738,0.7436
2019,8,Maternity,35.720001220703125,1,2.1155,0.0000,15.7525,19.9675,1.2676
2019,8,Outerwear & Coats,554.2500019073486,5,233.9861,150.0000,228.3703,325.8797,1.427
2019,8,Pants,109.9900016784668,2,-18.5259,100.0000,53.7102,56.2798,1.0478
2019,8,Pants & Capris,191.0,2,11.7613,-50.0000,97.773,93.227,0.9535
2019,8,Plus,96.93000221252441,3,-1.1524,50.0000,46.0333,50.8967,1.1056
2019,8,Shorts,363.44000244140625,6,112.389,20.0000,179.9422,183.4978,1.0198
2019,8,Sleep & Lounge,338.8499946594238,6,103.538,50.0000,157.361,181.489,1.1533
2019,8,Socks,12.949999809265137,1,-46.5097,-50.0000,7.3297,5.6203,0.7668
2019,8,Socks & Hosiery,35.989999771118164,2,199.9167,100.0000,14.4602,21.5298,1.4889
2019,8,Suits,200.0,1,126.5776,0.0000,129.6,70.4,0.5432
2019,8,Suits & Sport Coats,334.4000015258789,2,369.3992,0.0000,131.1552,203.2448,1.5497
2019,8,Sweaters,666.7799987792969,9,561.4881,800.0000,337.4545,329.3255,0.9759
2019,8,Swim,272.2899971008301,4,450.0808,300.0000,122.08,150.21,1.2304
2019,8,Tops & Tees,203.22000217437744,6,-24.7166,50.0000,110.2074,93.0126,0.844
2019,8,Underwear,61.0,3,-40.8857,-25.0000,27.405,33.595,1.2259
2019,9,Accessories,222.43000030517578,5,4.8407,-16.6667,83.9071,138.5229,1.6509
2019,9,Active,150.67999649047852,3,-32.2908,-25.0000,64.9987,85.6813,1.3182
2019,9,Blazers & Jackets,10.949999809265137,1,-95.6024,0.0000,4.5661,6.3838,1.3981
2019,9,Dresses,107.11999893188477,2,168.1352,100.0000,47.4812,59.6387,1.256
2019,9,Fashion Hoodies & Sweatshirts,382.2999973297119,7,4.1462,0.0000,203.3563,178.9437,0.88
2019,9,Intimates,360.1900005340576,10,146.0482,100.0000,190.0414,170.1486,0.8953
2019,9,Jeans,444.9900016784668,6,-34.5824,-25.0000,248.3602,196.6298,0.7917
2019,9,Leggings,74.98999977111816,3,98.9652,50.0000,44.6576,30.3324,0.6792
2019,9,Maternity,52.970001220703125,2,48.2923,100.0000,24.8377,28.1323,1.1326
2019,9,Outerwear & Coats,305.9499969482422,3,-44.7993,-40.0000,139.2373,166.7127,1.1973
2019,9,Pants,72.95000076293945,2,-33.6758,0.0000,30.8299,42.1201,1.3662
2019,9,Pants & Capris,69.0,1,-63.8743,-50.0000,38.847,30.153,0.7762
2019,9,Plus,96.98999977111816,2,0.0619,-33.3333,51.857,45.133,0.8703
2019,9,Shorts,181.5,4,-50.0605,-33.3333,87.26,94.24,1.08
2019,9,Skirts,155.0300006866455,3,,,64.113,90.917,1.4181
2019,9,Sleep & Lounge,152.9300022125244,4,-54.8679,-33.3333,67.6912,85.2388,1.2592
2019,9,Socks,74.65000057220459,2,476.4479,100.0000,47.1575,27.4926,0.583
2019,9,Sweaters,220.03999710083008,5,-66.9996,-44.4444,102.227,117.8129,1.1525
2019,9,Swim,89.50000190734863,3,-67.1306,-25.0000,43.752,45.748,1.0456
2019,9,Tops & Tees,299.83999824523926,6,47.5445,0.0000,161.0801,138.7599,0.8614
2019,9,Underwear,79.0,3,29.5082,0.0000,38.152,40.848,1.0707
2019,10,Accessories,61.80000114440918,3,-72.216,-40.0000,25.2388,36.5613,1.4486
2019,10,Active,122.98000144958496,4,-18.3833,33.3333,50.2789,72.7011,1.446
2019,10,Blazers & Jackets,112.04999923706055,2,923.2877,100.0000,42.8184,69.2315,1.6169
2019,10,Dresses,184.57999801635742,2,72.3114,0.0000,76.4992,108.0808,1.4128
2019,10,Fashion Hoodies & Sweatshirts,393.48000717163086,6,2.9244,-14.2857,199.4731,194.0069,0.9726
2019,10,Intimates,132.98999977111816,5,-63.0778,-50.0000,67.9099,65.0801,0.9583
2019,10,Jeans,463.5,5,4.1596,-16.6667,237.361,226.139,0.9527
2019,10,Jumpsuits & Rompers,10.9399995803833,1,10.2823,0.0000,5.3606,5.5794,1.0408
2019,10,Leggings,54.60000038146972,2,-27.1903,-33.3333,33.4137,21.1863,0.6341
2019,10,Outerwear & Coats,279.98999786376953,3,-8.485,0.0000,119.3456,160.6444,1.346
2019,10,Pants,164.94000244140625,3,126.1001,50.0000,78.0319,86.9081,1.1138
2019,10,Pants & Capris,34.900001525878906,1,-49.4203,0.0000,18.5319,16.3681,0.8832
2019,10,Plus,350.9000005722046,4,261.7899,100.0000,171.1062,179.7938,1.0508
2019,10,Shorts,94.84000253677368,5,-47.7466,25.0000,46.2821,48.5579,1.0492
2019,10,Skirts,163.9600067138672,1,5.7602,-66.6667,72.4703,91.4897,1.2624
2019,10,Sleep & Lounge,217.93999862670898,6,42.5096,50.0000,92.2114,125.7286,1.3635
2019,10,Socks,41.43000030517578,3,-44.501,50.0000,25.3149,16.1151,0.6366
2019,10,Socks & Hosiery,12.989999771118164,1,-63.9066,-50.0000,4.6114,8.3785,1.8169
2019,10,Suits,122.59999847412108,1,-38.7,0.0000,71.3532,51.2468,0.7182
2019,10,Suits & Sport Coats,633.9499969482422,4,89.5783,100.0000,272.868,361.082,1.3233
2019,10,Sweaters,256.7100067138672,5,16.6652,0.0000,116.5018,140.2082,1.2035
2019,10,Swim,351.4400005340576,6,292.6704,100.0000,163.6901,187.7499,1.147
2019,10,Tops & Tees,348.5499973297119,7,16.2453,16.6667,188.3437,160.2063,0.8506
2019,10,Underwear,68.0,3,-13.9241,0.0000,31.29,36.71,1.1732
2019,11,Accessories,238.89000320434567,3,286.5534,0.0000,104.4865,134.4035,1.2863
2019,11,Active,71.93999862670898,2,-41.5027,-50.0000,30.3046,41.6354,1.3739
2019,11,Blazers & Jackets,14.81999969482422,1,-86.7738,-50.0000,6.2689,8.5511,1.3641
2019,11,Dresses,521.9799995422363,4,182.7934,100.0000,221.5442,300.4358,1.3561
2019,11,Fashion Hoodies & Sweatshirts,535.6499938964844,7,36.1314,16.6667,290.5748,245.0752,0.8434
2019,11,Intimates,219.9600019454956,10,65.3959,100.0000,119.4026,100.5575,0.8422
2019,11,Jeans,445.0600051879883,6,-3.9784,20.0000,230.8496,214.2104,0.9279
2019,11,Leggings,31.949999809265137,2,-41.4835,0.0000,19.6141,12.3359,0.6289
2019,11,Maternity,97.59000015258789,3,84.2364,50.0000,41.2347,56.3553,1.3667
2019,11,Outerwear & Coats,480.51000213623047,5,71.6168,66.6667,217.07,263.44,1.2136
2019,11,Pants,461.42999839782715,7,179.7563,133.3333,207.0046,254.4253,1.2291
2019,11,Pants & Capris,241.75000762939453,4,592.6934,300.0000,119.0701,122.6799,1.0303
2019,11,Plus,118.71000003814697,4,-66.1698,0.0000,61.9359,56.7741,0.9167
2019,11,Shorts,248.11000061035156,6,161.609,20.0000,125.1674,122.9426,0.9822
2019,11,Skirts,73.44000244140625,2,-55.2086,100.0000,31.0119,42.4281,1.3681
2019,11,Sleep & Lounge,170.27999877929688,4,-21.8684,-33.3333,72.7902,97.4898,1.3393
2019,11,Socks,63.69999980926514,4,53.7533,33.3333,37.0131,26.6868,0.721
2019,11,Socks & Hosiery,66.74000072479248,5,413.7798,400.0000,27.7983,38.9417,1.4009
2019,11,Suits & Sport Coats,474.53001403808594,3,-25.1471,-25.0000,201.4724,273.0576,1.3553
2019,11,Sweaters,419.48999977111816,4,63.4101,-20.0000,202.5936,216.8964,1.0706
2019,11,Swim,390.3799991607666,7,11.0801,16.6667,183.8709,206.5091,1.1231
2019,11,Tops & Tees,305.0599994659424,5,-12.4774,-28.5714,169.159,135.901,0.8034
2019,11,Underwear,177.98000144958496,7,161.7353,133.3333,84.6802,93.2998,1.1018
2019,12,Accessories,195.77000045776367,7,-18.0501,133.3333,76.4495,119.3205,1.5608
2019,12,Active,215.97000312805176,4,200.2085,100.0000,86.4313,129.5387,1.4987
2019,12,Blazers & Jackets,172.72000122070312,2,1065.4521,100.0000,62.7063,110.0137,1.7544
2019,12,Dresses,592.25,3,13.4622,-25.0000,268.9432,323.3068,1.2021
2019,12,Fashion Hoodies & Sweatshirts,377.4700012207031,7,-29.5305,0.0000,193.545,183.925,0.9503
2019,12,Intimates,287.5899991989136,6,30.7465,-40.0000,153.2933,134.2967,0.8761
2019,12,Jeans,373.9499969482422,4,-15.9776,-33.3333,209.8871,164.0629,0.7817
2019,12,Jumpsuits & Rompers,11.090000152587892,1,1.3711,0.0000,5.9997,5.0903,0.8484
2019,12,Leggings,76.9000015258789,3,140.6886,50.0000,48.1207,28.7793,0.5981
2019,12,Maternity,69.95999908447266,1,-28.3123,-66.6667,28.6136,41.3464,1.445
2019,12,Outerwear & Coats,854.4500007629395,5,77.8215,0.0000,385.3213,469.1287,1.2175
2019,12,Pants,69.98999977111816,2,-84.8319,-71.4286,30.835,39.155,1.2698
2019,12,Pants & Capris,25.190000534057617,1,-89.5801,-75.0000,13.5522,11.6378,0.8587
2019,12,Plus,9.949999809265137,1,-91.6182,-75.0000,5.1342,4.8158,0.938
2019,12,Shorts,310.93000316619873,8,25.3194,33.3333,158.5792,152.3508,0.9607
2019,12,Skirts,166.95000076293945,2,127.3284,0.0000,61.6588,105.2912,1.7076
2019,12,Sleep & Lounge,508.2700023651123,10,198.4907,150.0000,223.2123,285.0577,1.2771
2019,12,Socks,48.989999771118164,3,-23.0926,-25.0000,27.7492,21.2408,0.7655
2019,12,Socks & Hosiery,12.949999809265137,1,-80.5963,-80.0000,5.0764,7.8736,1.551
2019,12,Suits,250.2300033569336,2,104.1028,100.0000,147.0279,103.2022,0.7019
2019,12,Sweaters,501.24999618530273,6,19.4903,50.0000,235.7737,265.4762,1.126
2019,12,Swim,141.20000076293945,3,-63.8301,-57.1429,79.2405,61.9595,0.7819
2019,12,Tops & Tees,236.88000106811523,7,-22.3497,40.0000,126.3958,110.4842,0.8741
2019,12,Underwear,166.45000076293945,5,-6.4783,-28.5714,78.9787,87.4713,1.1075
2020,1,Accessories,164.9999988079071,8,-15.7174,14.2857,65.3124,99.6876,1.5263
2020,1,Active,391.22000312805176,8,81.1455,100.0000,160.5331,230.6869,1.437
2020,1,Dresses,11.130000114440918,1,-98.1207,-66.6667,4.9974,6.1326,1.2272
2020,1,Fashion Hoodies & Sweatshirts,483.7700023651123,10,28.1612,42.8571,244.221,239.549,0.9809
2020,1,Intimates,187.82999920845032,9,-34.6883,50.0000,99.9871,87.8429,0.8785
2020,1,Jeans,402.8799991607666,7,7.7363,75.0000,214.9601,187.9199,0.8742
2020,1,Jumpsuits & Rompers,59.77999973297119,2,439.0442,100.0000,32.5683,27.2117,0.8355
2020,1,Leggings,45.839999198913574,3,-40.3901,0.0000,27.0385,18.8015,0.6954
2020,1,Maternity,157.5,2,125.1286,100.0000,70.8015,86.6985,1.2245
2020,1,Outerwear & Coats,902.840015411377,5,5.6633,0.0000,403.8229,499.0171,1.2357
2020,1,Pants,426.1800003051758,6,508.9156,200.0000,202.6087,223.5713,1.1035
2020,1,Pants & Capris,86.75000190734863,3,244.3827,200.0000,48.3423,38.4077,0.7945
2020,1,Plus,382.89000129699707,5,3748.1408,400.0000,183.2489,199.6411,1.0895
2020,1,Shorts,353.78000831604004,8,13.7812,0.0000,177.4155,176.3645,0.9941
2020,1,Skirts,23.450000762939453,1,-85.9539,-50.0000,8.231,15.2191,1.849
2020,1,Sleep & Lounge,561.2499980926514,9,10.4236,-10.0000,270.3793,290.8707,1.0758
2020,1,Socks,51.189998626708984,2,4.4907,-33.3333,30.0551,21.1349,0.7032
2020,1,Socks & Hosiery,76.35999965667725,5,489.6525,400.0000,31.6578,44.7022,1.412
2020,1,Suits,75.98999786376953,1,-69.6319,-50.0000,49.1655,26.8245,0.5456
2020,1,Suits & Sport Coats,879.9300060272217,10,85.4319,233.3333,366.1805,513.7495,1.403
2020,1,Sweaters,516.0,4,2.9426,-33.3333,261.139,254.861,0.976
2020,1,Swim,454.84000396728516,9,222.1246,200.0000,228.8377,226.0023,0.9876
2020,1,Tops & Tees,549.5000019073486,11,131.974,57.1429,306.8057,242.6944,0.791
2020,1,Underwear,97.0,3,-41.7242,-40.0000,42.732,54.268,1.27
2020,2,Accessories,222.98999786376953,3,35.1455,-62.5000,89.1201,133.8699,1.5021
2020,2,Active,1090.6999988555908,13,178.7945,62.5000,421.3648,669.3352,1.5885
2020,2,Blazers & Jackets,17.5,1,-89.868,-50.0000,6.125,11.375,1.8571
2020,2,Dresses,390.9900016784668,4,3412.938,300.0000,179.7418,211.2482,1.1753
2020,2,Fashion Hoodies & Sweatshirts,554.2300052642822,12,14.5648,20.0000,290.2941,263.9359,0.9092
2020,2,Intimates,386.3600034713745,10,105.6966,11.1111,206.4151,179.9449,0.8718
2020,2,Jeans,1078.2600002288818,13,167.638,85.7143,585.5579,492.7021,0.8414
2020,2,Jumpsuits & Rompers,23.5,1,-60.6892,-50.0000,12.6665,10.8335,0.8553
2020,2,Leggings,50.989999771118164,4,11.2347,33.3333,30.376,20.614,0.6786
2020,2,Maternity,205.9799976348877,3,30.781,50.0000,90.6019,115.3781,1.2735
2020,2,Outerwear & Coats,1315.3699989318848,9,45.6925,80.0000,580.5749,734.7951,1.2656
2020,2,Pants,407.3100004196167,6,-4.4277,0.0000,190.4709,216.8391,1.1384
2020,2,Plus,135.98999786376953,3,-64.4833,-40.0000,65.7815,70.2085,1.0673
2020,2,Shorts,380.9200029373169,7,7.6714,-12.5000,191.8609,189.0591,0.9854
2020,2,Skirts,51.39000129699707,2,119.1471,100.0000,19.2673,32.1228,1.6672
2020,2,Sleep & Lounge,527.379994392395,8,-6.0347,-11.1111,255.7193,271.6607,1.0623
2020,2,Socks,44.989999771118164,3,-12.1117,50.0000,26.7438,18.2462,0.6823
2020,2,Socks & Hosiery,61.14999961853027,4,-19.9188,-20.0000,23.282,37.868,1.6265
2020,2,Suits,98.08000183105469,1,29.0696,0.0000,54.5325,43.5475,0.7986
2020,2,Suits & Sport Coats,278.9499969482422,2,-68.2986,-80.0000,116.5071,162.4428,1.3943
2020,2,Sweaters,617.589994430542,10,19.688,150.0000,293.717,323.873,1.1027
2020,2,Swim,752.980001449585,10,65.5483,11.1111,366.9818,385.9982,1.0518
2020,2,Tops & Tees,279.1500024795532,9,-49.1993,-18.1818,150.7994,128.3506,0.8511
2020,2,Underwear,158.48999977111816,6,63.3918,100.0000,75.3011,83.1889,1.1047
2020,3,Accessories,224.97000312805176,7,0.8879,133.3333,88.4145,136.5555,1.5445
2020,3,Active,191.92999935150146,5,-82.403,-61.5385,75.8951,116.0349,1.5289
2020,3,Blazers & Jackets,34.9900016784668,1,99.9429,0.0000,14.9757,20.0143,1.3364
2020,3,Dresses,51.989999771118164,2,-86.703,-50.0000,21.9035,30.0865,1.3736
2020,3,Fashion Hoodies & Sweatshirts,562.8200035095215,11,1.5499,-8.3333,309.3265,253.4935,0.8195
2020,3,Intimates,284.789999961853,10,-26.289,0.0000,153.7379,131.0521,0.8524
2020,3,Jeans,1772.1099948883057,14,64.349,7.6923,938.4638,833.6462,0.8883
2020,3,Leggings,114.88999938964844,3,125.3187,-25.0000,66.9833,47.9067,0.7152
2020,3,Maternity,180.70999908447266,4,-12.2682,33.3333,80.2857,100.4243,1.2508
2020,3,Outerwear & Coats,840.9700012207031,8,-36.0659,-11.1111,389.3298,451.6402,1.16
2020,3,Pants,460.31000328063965,9,13.0122,50.0000,213.6191,246.6909,1.1548
2020,3,Pants & Capris,185.72000217437744,6,114.0865,100.0000,93.7295,91.9905,0.9814
2020,3,Plus,124.97000122070312,5,-8.1035,66.6667,65.6221,59.3479,0.9044
2020,3,Shorts,570.0500068664551,10,49.6508,42.8571,292.0906,277.9594,0.9516
2020,3,Skirts,39.0,1,-24.1098,-50.0000,15.912,23.088,1.451
2020,3,Sleep & Lounge,599.9999961853027,10,13.77,25.0000,260.1582,339.8417,1.3063
2020,3,Socks,149.5299997329712,9,232.3627,200.0000,88.4393,61.0907,0.6908
2020,3,Socks & Hosiery,25.489999771118164,2,-58.3156,-50.0000,9.9485,15.5414,1.5622
2020,3,Suits & Sport Coats,397.0,3,42.3194,50.0000,167.185,229.815,1.3746
2020,3,Sweaters,391.97000312805176,7,-36.5323,-30.0000,178.1191,213.8509,1.2006
2020,3,Swim,457.45000171661377,13,-39.2481,30.0000,244.2451,213.2049,0.8729
2020,3,Tops & Tees,132.9900016784668,4,-52.3589,-55.5556,78.6409,54.3491,0.6911
2020,3,Underwear,191.39000129699707,7,20.7584,16.6667,86.6332,104.7568,1.2092
2020,4,Accessories,298.8700008392334,9,32.8488,28.5714,125.3339,173.5361,1.3846
2020,4,Active,208.91000175476074,7,8.847,40.0000,90.9234,117.9866,1.2976
2020,4,Blazers & Jackets,286.51000213623047,5,718.8339,400.0000,105.1402,181.3698,1.725
2020,4,Dresses,339.45000076293945,5,552.914,150.0000,148.6743,190.7757,1.2832
2020,4,Fashion Hoodies & Sweatshirts,664.2899932861328,12,18.0289,9.0909,354.7976,309.4924,0.8723
2020,4,Intimates,554.7199974060059,15,94.7821,50.0000,300.6771,254.0429,0.8449
2020,4,Jeans,1104.4200057983398,9,-37.6777,-35.7143,582.2872,522.1328,0.8967
2020,4,Jumpsuits & Rompers,32.790000915527344,1,39.5319,0.0000,17.3131,15.4769,0.8939
2020,4,Leggings,150.57999897003174,7,31.0645,133.3333,88.2433,62.3367,0.7064
2020,4,Maternity,279.87999725341797,4,54.878,0.0000,117.4847,162.3953,1.3823
2020,4,Outerwear & Coats,328.04999923706055,3,-60.9915,-62.5000,148.2232,179.8268,1.2132
2020,4,Pants,175.25000381469727,4,-61.9278,-55.5556,81.5956,93.6544,1.1478
2020,4,Pants & Capris,182.45999908447266,3,-1.7553,-50.0000,95.1843,87.2757,0.9169
2020,4,Plus,437.2699966430664,5,249.9,0.0000,219.9983,217.2717,0.9876
2020,4,Shorts,211.39999961853027,4,-62.9155,-60.0000,109.4044,101.9956,0.9323
2020,4,Skirts,73.98999977111816,2,89.7179,100.0000,26.2783,47.7116,1.8156
2020,4,Sleep & Lounge,527.4300012588501,13,-12.095,30.0000,291.3706,236.0594,0.8102
2020,4,Socks,86.6899995803833,6,-42.025,-33.3333,51.9039,34.7861,0.6702
2020,4,Socks & Hosiery,91.15999984741211,6,257.6304,200.0000,35.0174,56.1426,1.6033
2020,4,Suits,194.9900016784668,2,98.8071,100.0000,118.2027,76.7873,0.6496
2020,4,Suits & Sport Coats,298.0,1,-24.937,-66.6667,118.604,179.396,1.5126
2020,4,Sweaters,676.0399913787842,11,72.4724,57.1429,339.2165,336.8235,0.9929
2020,4,Swim,471.8799991607666,11,3.1544,-15.3846,255.1252,216.7548,0.8496
2020,4,Tops & Tees,437.7700090408325,14,229.1751,250.0000,239.4414,198.3286,0.8283
2020,4,Underwear,166.4699993133545,6,-13.0205,-14.2857,78.8013,87.6687,1.1125
2020,5,Accessories,573.3100032806396,10,91.8259,11.1111,224.6985,348.6115,1.5515
2020,5,Active,273.14000129699707,7,30.7453,0.0000,118.7843,154.3557,1.2995
2020,5,Blazers & Jackets,214.04000568389895,2,-25.2941,-60.0000,91.0719,122.9681,1.3502
2020,5,Dresses,601.4399967193604,4,77.1807,-20.0000,283.2044,318.2356,1.1237
2020,5,Fashion Hoodies & Sweatshirts,671.6399993896484,8,1.1064,-33.3333,332.2043,339.4357,1.0218
2020,5,Intimates,448.57000064849854,16,-19.1358,6.6667,237.2511,211.3189,0.8907
2020,5,Jeans,961.25,7,-12.9634,-22.2222,514.4285,446.8215,0.8686
2020,5,Leggings,17.899999618530273,1,-88.1126,-85.7143,9.8629,8.0371,0.8149
2020,5,Maternity,292.0299997329712,5,4.3411,25.0000,125.4118,166.6182,1.3286
2020,5,Outerwear & Coats,1568.77001953125,7,378.2106,133.3333,681.4327,887.3373,1.3022
2020,5,Pants,415.98000144958496,5,137.3638,25.0000,195.599,220.381,1.1267
2020,5,Plus,80.97000122070312,3,-81.4828,-40.0000,40.5193,40.4507,0.9983
2020,5,Shorts,456.0000033378601,14,115.7048,250.0000,224.9471,231.053,1.0271
2020,5,Skirts,103.0,2,39.208,0.0000,40.668,62.332,1.5327
2020,5,Sleep & Lounge,615.9300022125244,9,16.7795,-30.7692,268.5627,347.3673,1.2934
2020,5,Socks,70.30000114440918,4,-18.9064,-33.3333,40.9302,29.3699,0.7176
2020,5,Socks & Hosiery,30.0,1,-67.0908,-83.3333,11.43,18.57,1.6247
2020,5,Suits & Sport Coats,219.5,1,-26.3423,0.0000,93.068,126.432,1.3585
2020,5,Sweaters,423.45999908447266,8,-37.3617,-27.2727,208.39,215.07,1.0321
2020,5,Swim,302.7199993133545,5,-35.8481,-54.5455,149.6851,153.0349,1.0224
2020,5,Tops & Tees,402.86999893188477,10,-7.9722,-28.5714,221.644,181.226,0.8176
2020,5,Underwear,205.29000186920166,8,23.3195,33.3333,96.118,109.1721,1.1358
2020,6,Accessories,354.25,8,-38.2097,-20.0000,134.2298,220.0202,1.6391
2020,6,Active,429.84000396728516,8,57.3698,14.2857,180.8682,248.9718,1.3765
2020,6,Blazers & Jackets,252.47000122070312,2,17.9546,0.0000,90.5104,161.9597,1.7894
2020,6,Dresses,304.9900026321411,4,-49.29,0.0000,138.0005,166.9895,1.2101
2020,6,Fashion Hoodies & Sweatshirts,500.00000190734863,11,-25.5554,37.5000,256.0183,243.9817,0.953
2020,6,Intimates,570.2500019073486,11,27.1262,-31.2500,295.4282,274.8218,0.9302
2020,6,Jeans,1041.2699966430664,11,8.3246,57.1429,539.451,501.8189,0.9302
2020,6,Leggings,292.0099983215332,5,1531.3408,400.0000,179.3114,112.6985,0.6285
2020,6,Maternity,25.0,1,-91.4392,-80.0000,10.925,14.075,1.2883
2020,6,Outerwear & Coats,2166.7499828338623,9,38.1178,28.5714,955.5809,1211.1691,1.2675
2020,6,Pants,452.7300033569336,3,8.8346,-40.0000,219.0036,233.7264,1.0672
2020,6,Pants & Capris,85.44999885559082,3,-53.1678,0.0000,44.2811,41.1689,0.9297
2020,6,Plus,147.27000045776367,6,81.8822,100.0000,75.2535,72.0165,0.957
2020,6,Shorts,605.7400016784668,12,32.8377,-14.2857,303.8481,301.8919,0.9936
2020,6,Skirts,33.88999938964844,1,-67.0971,-50.0000,13.0815,20.8085,1.5907
2020,6,Sleep & Lounge,320.0900020599365,6,-48.0314,-33.3333,144.1232,175.9668,1.2209
2020,6,Socks,126.17000007629395,8,79.4737,100.0000,77.376,48.794,0.6306
2020,6,Socks & Hosiery,41.96000003814697,3,39.8667,200.0000,16.8951,25.0649,1.4836
2020,6,Suits,122.59999847412108,1,-37.125,-50.0000,71.3532,51.2468,0.7182
2020,6,Suits & Sport Coats,264.939998626709,3,20.7016,200.0000,108.4397,156.5003,1.4432
2020,6,Sweaters,671.8900012969971,11,58.6667,37.5000,326.2823,345.6077,1.0592
2020,6,Swim,670.6500034332275,13,121.5414,160.0000,353.0724,317.5776,0.8995
2020,6,Tops & Tees,301.479998588562,9,-25.1669,-10.0000,171.4941,129.9859,0.758
2020,6,Underwear,170.0900001525879,7,-17.1465,-12.5000,80.9481,89.1419,1.1012
2020,7,Accessories,325.0399971008301,14,-8.2456,75.0000,135.0448,189.9952,1.4069
2020,7,Active,513.6199998855591,8,19.491,0.0000,208.6967,304.9233,1.4611
2020,7,Blazers & Jackets,152.98000049591064,3,-39.4067,50.0000,58.7239,94.2561,1.6051
2020,7,Dresses,311.56000232696533,5,2.1542,25.0000,138.2624,173.2977,1.2534
2020,7,Fashion Hoodies & Sweatshirts,697.6900043487549,13,39.538,18.1818,384.5142,313.1758,0.8145
2020,7,Intimates,703.9200029373169,21,23.4406,90.9091,372.6517,331.2683,0.8889
2020,7,Jeans,1171.5300064086914,13,12.5097,18.1818,629.8848,541.6452,0.8599
2020,7,Jumpsuits & Rompers,26.170000076293945,2,-20.1891,100.0000,14.147,12.023,0.8499
2020,7,Leggings,52.950000762939446,1,-81.8671,-80.0000,30.0756,22.8744,0.7606
2020,7,Maternity,163.59000205993652,5,554.36,400.0000,72.8543,90.7358,1.2454
2020,7,Outerwear & Coats,940.6999969482422,6,-56.5847,-33.3333,421.2064,519.4936,1.2333
2020,7,Pants,670.4700012207031,7,48.0949,133.3333,296.8202,373.6498,1.2588
2020,7,Pants & Capris,216.0,3,152.7794,0.0000,110.773,105.227,0.9499
2020,7,Plus,333.9699993133545,6,126.774,0.0000,174.888,159.082,0.9096
2020,7,Shorts,409.18000411987305,7,-32.4496,-41.6667,201.6036,207.5764,1.0296
2020,7,Skirts,134.98999977111816,2,298.3181,100.0000,50.7544,84.2356,1.6597
2020,7,Sleep & Lounge,496.14000129699707,10,55.0002,66.6667,234.4516,261.6884,1.1162
2020,7,Socks,121.30999946594238,6,-3.8519,-25.0000,76.0918,45.2182,0.5943
2020,7,Socks & Hosiery,48.97999954223633,3,16.7302,0.0000,20.3296,28.6504,1.4093
2020,7,Suits,127.51000213623048,1,4.0049,0.0000,73.0632,54.4468,0.7452
2020,7,Suits & Sport Coats,736.9999961853027,7,178.1762,133.3333,293.4419,443.5581,1.5116
2020,7,Sweaters,1170.5399990081787,18,74.216,63.6364,572.7953,597.7447,1.0436
2020,7,Swim,1052.0400009155273,14,56.8687,7.6923,473.0446,578.9954,1.224
2020,7,Tops & Tees,443.4000015258789,11,47.0744,22.2222,250.6165,192.7835,0.7692
2020,7,Underwear,309.8899974822998,8,82.1918,14.2857,151.8416,158.0484,1.0409
2020,8,Accessories,577.3500061035156,13,77.6243,-7.1429,241.8181,335.5319,1.3875
2020,8,Active,307.10000228881836,10,-40.2087,25.0000,129.8964,177.2036,1.3642
2020,8,Blazers & Jackets,277.61000061035156,4,81.4682,33.3333,107.5898,170.0202,1.5803
2020,8,Dresses,758.9300079345703,7,143.5903,40.0000,326.0286,432.9014,1.3278
2020,8,Fashion Hoodies & Sweatshirts,687.2600002288818,14,-1.4949,7.6923,364.112,323.148,0.8875
2020,8,Intimates,567.7399950027466,15,-19.3459,-28.5714,302.0743,265.6657,0.8795
2020,8,Jeans,1955.930009841919,18,66.9552,38.4615,1026.076,929.854,0.9062
2020,8,Leggings,101.08000183105469,5,90.8971,400.0000,62.1611,38.919,0.6261
2020,8,Maternity,125.8700008392334,4,-23.0576,-20.0000,54.8358,71.0342,1.2954
2020,8,Outerwear & Coats,2136.1599922180176,15,127.082,150.0000,971.1777,1164.9823,1.1996
2020,8,Pants,608.4400062561035,10,-9.2517,42.8571,273.0534,335.3866,1.2283
2020,8,Pants & Capris,84.97999954223633,3,-60.6574,0.0000,45.7382,39.2418,0.858
2020,8,Plus,285.6000016927719,9,-14.4833,50.0000,150.871,134.729,0.893
2020,8,Shorts,575.4800062179565,14,40.6423,100.0000,283.3269,292.1531,1.0312
2020,8,Skirts,246.79000091552734,4,82.821,100.0000,93.3264,153.4636,1.6444
2020,8,Sleep & Lounge,604.2500019073486,9,21.7902,-10.0000,285.798,318.452,1.1143
2020,8,Socks,112.94999980926514,6,-6.8914,0.0000,68.2997,44.6503,0.6537
2020,8,Socks & Hosiery,132.8499994277954,8,171.2332,166.6667,54.5213,78.3287,1.4367
2020,8,Suits & Sport Coats,790.4499969482422,5,7.2524,-28.5714,331.7266,458.7233,1.3828
2020,8,Sweaters,629.4100131988525,8,-46.2291,-55.5556,307.945,321.465,1.0439
2020,8,Swim,649.2299957275391,11,-38.2885,-21.4286,320.5367,328.6933,1.0254
2020,8,Tops & Tees,458.2200012207031,13,3.3424,18.1818,251.6097,206.6103,0.8212
2020,8,Underwear,528.8200073242188,12,70.6477,50.0000,247.6017,281.2183,1.1358
2020,9,Accessories,484.68000507354736,13,-16.0509,0.0000,201.3949,283.2851,1.4066
2020,9,Active,710.6899948120117,14,131.4197,40.0000,300.5647,410.1252,1.3645
2020,9,Blazers & Jackets,394.37999725341797,4,42.0626,0.0000,142.4598,251.9202,1.7684
2020,9,Dresses,420.0199909210205,5,-44.6563,-28.5714,182.3603,237.6597,1.3032
2020,9,Fashion Hoodies & Sweatshirts,2075.349992752075,30,201.9745,114.2857,1106.559,968.791,0.8755
2020,9,Intimates,504.1900005340576,14,-11.1935,-6.6667,261.283,242.907,0.9297
2020,9,Jeans,1864.0599918365479,19,-4.697,5.5556,1009.0935,854.9665,0.8473
2020,9,Leggings,111.88000106811523,4,10.6846,-20.0000,67.5702,44.3098,0.6558
2020,9,Maternity,270.9799995422363,5,115.2856,25.0000,119.4995,151.4805,1.2676
2020,9,Outerwear & Coats,1542.01997756958,14,-27.8135,-6.6667,684.5232,857.4968,1.2527
2020,9,Pants,195.63000106811523,4,-67.8473,-60.0000,88.8122,106.8179,1.2027
2020,9,Pants & Capris,29.47000026702881,2,-65.3213,-33.3333,15.1671,14.3029,0.943
2020,9,Plus,94.3700008392334,5,-66.9573,-44.4444,47.3267,47.0433,0.994
2020,9,Shorts,836.120002746582,20,45.2909,42.8571,421.4132,414.7068,0.9841
2020,9,Skirts,74.93000030517578,1,-69.6382,-75.0000,28.2486,46.6814,1.6525
2020,9,Sleep & Lounge,305.8899955749512,9,-49.3769,0.0000,146.2565,159.6335,1.0915
2020,9,Socks,166.71999835968018,9,47.6051,50.0000,101.5301,65.1899,0.6421
2020,9,Socks & Hosiery,50.88000011444092,4,-61.7012,-50.0000,19.888,30.992,1.5583
2020,9,Suits & Sport Coats,1087.7700119018555,9,37.614,80.0000,438.2162,649.5538,1.4823
2020,9,Sweaters,755.0300025939941,9,19.9584,12.5000,379.5063,375.5237,0.9895
2020,9,Swim,626.0600032806396,14,-3.5688,27.2727,317.6085,308.4515,0.9712
2020,9,Tops & Tees,844.9600009918213,20,84.4005,53.8462,462.2229,382.7371,0.828
2020,9,Underwear,354.44999980926514,13,-32.9734,8.3333,162.4953,191.9547,1.1813
2020,10,Accessories,675.2599976062775,16,39.3208,23.0769,281.6066,393.6534,1.3979
2020,10,Active,251.88999843597412,8,-64.557,-42.8571,101.6093,150.2807,1.479
2020,10,Blazers & Jackets,536.7399997711182,6,36.0972,50.0000,202.9239,333.8161,1.645
2020,10,Clothing Sets,54.9900016784668,1,,,35.7985,19.1915,0.5361
2020,10,Dresses,558.7900066375732,12,33.0389,140.0000,251.8804,306.9096,1.2185
2020,10,Fashion Hoodies & Sweatshirts,913.669994354248,20,-55.9751,-33.3333,477.0572,436.6128,0.9152
2020,10,Intimates,324.8500003814697,13,-35.5699,-7.1429,170.3077,154.5423,0.9074
2020,10,Jeans,1067.8099937438965,13,-42.7159,-31.5789,564.7776,503.0324,0.8907
2020,10,Jumpsuits & Rompers,50.02999973297119,3,91.1731,50.0000,27.2448,22.7852,0.8363
2020,10,Leggings,93.17000007629395,4,-16.7233,0.0000,57.8802,35.2898,0.6097
2020,10,Maternity,302.8899955749512,5,11.7758,0.0000,141.5739,161.3161,1.1394
2020,10,Outerwear & Coats,1672.0500087738037,17,8.4324,21.4286,737.3577,934.6923,1.2676
2020,10,Pants,575.2299995422363,9,194.0398,125.0000,268.7207,306.5093,1.1406
2020,10,Pants & Capris,365.49000549316406,4,1140.2104,100.0000,194.5056,170.9844,0.8791
2020,10,Plus,212.98000144958496,4,125.6861,-20.0000,114.1489,98.8311,0.8658
2020,10,Shorts,494.58000564575195,12,-40.8482,-40.0000,243.1757,251.4043,1.0338
2020,10,Sleep & Lounge,686.7400035858154,15,124.5055,66.6667,312.9151,373.8249,1.1947
2020,10,Socks,128.0,8,-23.2246,-11.1111,76.3915,51.6085,0.6756
2020,10,Socks & Hosiery,67.95000076293945,4,33.5495,0.0000,26.205,41.7451,1.593
2020,10,Suits,406.98999786376953,3,219.1828,200.0000,252.5669,154.4231,0.6114
2020,10,Suits & Sport Coats,561.6199989318848,4,-48.3696,-55.5556,213.0757,348.5443,1.6358
2020,10,Sweaters,789.6099967956543,10,4.5799,11.1111,372.9613,416.6487,1.1171
2020,10,Swim,1251.7700004577637,19,99.9441,35.7143,621.5121,630.2579,1.0141
2020,10,Tops & Tees,780.579999923706,17,-7.6193,-15.0000,434.5143,346.0657,0.7964
2020,10,Underwear,193.09000205993652,7,-45.5241,-46.1538,89.5827,103.5073,1.1554
2020,11,Accessories,982.4100036621094,16,45.4862,0.0000,407.9306,574.4794,1.4083
2020,11,Active,413.6399955749512,12,64.2145,50.0000,172.6524,240.9876,1.3958
2020,11,Blazers & Jackets,381.3999996185303,3,-28.9414,-50.0000,147.5085,233.8915,1.5856
2020,11,Dresses,432.0099983215332,7,-22.6883,-41.6667,200.9595,231.0505,1.1497
2020,11,Fashion Hoodies & Sweatshirts,930.4499969482422,17,1.8365,-15.0000,461.2489,469.201,1.0172
2020,11,Intimates,631.760000705719,18,94.4775,38.4615,329.2003,302.5597,0.9191
2020,11,Jeans,1459.2200050354004,14,36.6554,7.6923,792.4232,666.7968,0.8415
2020,11,Leggings,100.63000011444092,4,8.0069,0.0000,59.7566,40.8734,0.684
2020,11,Maternity,66.0,2,-78.2099,-60.0000,27.222,38.778,1.4245
2020,11,Outerwear & Coats,1499.399990081787,13,-10.3256,-23.5294,672.3772,827.0228,1.23
2020,11,Pants,537.7100028991699,10,-6.5226,11.1111,245.6546,292.0554,1.1889
2020,11,Pants & Capris,256.1900005340576,5,-29.9051,25.0000,135.5859,120.6041,0.8895
2020,11,Plus,246.78999948501587,10,15.8747,150.0000,123.6694,123.1206,0.9956
2020,11,Shorts,540.5400009155273,10,9.2927,-16.6667,278.8519,261.6881,0.9384
2020,11,Skirts,19.989999771118164,1,-73.3218,0.0000,8.7156,11.2744,1.2936
2020,11,Sleep & Lounge,517.5,12,-24.644,-20.0000,220.3647,297.1353,1.3484
2020,11,Socks,108.51999950408936,6,-15.2188,-25.0000,64.8912,43.6288,0.6723
2020,11,Socks & Hosiery,78.96999931335449,5,16.2178,25.0000,30.9244,48.0456,1.5536
2020,11,Suits & Sport Coats,555.4100036621094,6,-1.1057,50.0000,220.9869,334.4231,1.5133
2020,11,Sweaters,845.3300037384033,13,7.0566,30.0000,415.7177,429.6123,1.0334
2020,11,Swim,864.2499961853027,15,-30.9578,-21.0526,463.2989,400.9511,0.8654
2020,11,Tops & Tees,603.1900062561035,17,-22.7254,0.0000,335.5411,267.6489,0.7977
2020,11,Underwear,355.9300003051758,11,84.3337,57.1429,166.852,189.078,1.1332
2020,12,Accessories,559.9599947929382,13,-43.0014,-18.7500,225.3986,334.5614,1.4843
2020,12,Active,725.2899980545044,13,75.3433,8.3333,314.93,410.36,1.303
2020,12,Blazers & Jackets,445.78999614715576,4,16.8825,33.3333,156.9567,288.8333,1.8402
2020,12,Dresses,492.6099967956543,7,14.0275,0.0000,228.945,263.665,1.1517
2020,12,Fashion Hoodies & Sweatshirts,1210.099998474121,21,30.0553,23.5294,613.8331,596.2669,0.9714
2020,12,Intimates,750.85999584198,20,18.8521,11.1111,404.841,346.019,0.8547
2020,12,Jeans,1739.7500076293945,17,19.2247,21.4286,944.259,795.491,0.8425
2020,12,Jumpsuits & Rompers,26.619999885559082,2,-46.7919,-33.3333,13.5291,13.0909,0.9676
2020,12,Leggings,70.17999935150146,4,-30.2594,0.0000,42.3919,27.7881,0.6555
2020,12,Maternity,313.10000228881836,6,374.3939,200.0000,135.4455,177.6546,1.3116
2020,12,Outerwear & Coats,1670.2399940490723,12,11.3939,-7.6923,712.5408,957.6992,1.3441
2020,12,Pants,622.2200031280518,10,15.7167,0.0000,288.4569,333.7632,1.1571
2020,12,Pants & Capris,217.11000061035156,5,-15.2543,0.0000,116.1829,100.9271,0.8687
2020,12,Plus,186.93999671936035,5,-24.2514,-50.0000,90.0669,96.8731,1.0756
2020,12,Shorts,827.3200054168701,19,53.0544,90.0000,415.6771,411.6429,0.9903
2020,12,Skirts,75.88999938964844,3,279.6398,200.0000,31.2632,44.6268,1.4275
2020,12,Sleep & Lounge,1111.6299991607666,21,114.8077,75.0000,527.8188,583.8112,1.1061
2020,12,Socks,205.23999977111816,9,89.1264,50.0000,124.8307,80.4093,0.6441
2020,12,Socks & Hosiery,40.989999771118164,2,-48.0942,-60.0000,15.2428,25.7471,1.6891
2020,12,Suits,344.98999786376953,3,-15.2338,0.0000,212.4196,132.5704,0.6241
2020,12,Suits & Sport Coats,930.4099884033203,8,67.5177,33.3333,380.7427,549.6673,1.4437
2020,12,Sweaters,1268.640001296997,18,50.0763,38.4615,636.8857,631.7543,0.9919
2020,12,Swim,1242.1900100708008,16,43.7304,6.6667,626.1482,616.0418,0.9839
2020,12,Tops & Tees,1003.4200029373169,23,66.3522,35.2941,557.1632,446.2568,0.8009
2020,12,Underwear,255.0,10,-28.3567,-9.0909,122.611,132.389,1.0797
2021,1,Accessories,621.9900045394897,15,11.0776,15.3846,251.1483,370.8417,1.4766
2021,1,Active,627.9000053405762,15,-13.4277,15.3846,253.9394,373.9606,1.4726
2021,1,Blazers & Jackets,383.8400001525879,3,-13.8967,-25.0000,141.6043,242.2357,1.7107
2021,1,Clothing Sets,69.98999786376953,1,27.2777,0.0000,41.0841,28.9059,0.7036
2021,1,Dresses,1115.4600057601929,13,126.4388,85.7143,481.8702,633.5898,1.3149
2021,1,Fashion Hoodies & Sweatshirts,1102.1800022125244,23,-8.9183,9.5238,563.0513,539.1287,0.9575
2021,1,Intimates,862.5400009155273,22,14.8736,10.0000,453.0754,409.4646,0.9037
2021,1,Jeans,1381.3200035095215,17,-20.6024,0.0000,736.7591,644.5609,0.8749
2021,1,Jumpsuits & Rompers,98.0,1,268.1443,-50.0000,52.626,45.374,0.8622
2021,1,Leggings,55.03999900817871,4,-21.5731,0.0000,32.4915,22.5485,0.694
2021,1,Maternity,431.8999996185303,9,37.9431,50.0000,198.3341,233.5659,1.1776
2021,1,Outerwear & Coats,4241.729991912842,16,153.9593,33.3333,1930.839,2310.891,1.1968
2021,1,Pants,1173.7399997711182,19,88.6375,90.0000,550.7021,623.0379,1.1314
2021,1,Pants & Capris,62.84000015258789,2,-71.0561,-60.0000,32.7714,30.0686,0.9175
2021,1,Plus,447.8400001525879,10,139.5635,100.0000,225.6917,222.1484,0.9843
2021,1,Shorts,1074.5599908828735,20,29.8844,5.2632,539.9961,534.5639,0.9899
2021,1,Skirts,35.0,1,-53.8806,-66.6667,12.985,22.015,1.6954
2021,1,Sleep & Lounge,945.3200054168701,23,-14.9609,9.5238,421.5457,523.7744,1.2425
2021,1,Socks,230.49999904632568,14,12.3075,55.5556,138.1044,92.3956,0.669
2021,1,Socks & Hosiery,97.21999931335449,7,137.1798,250.0000,39.6418,57.5782,1.4525
2021,1,Suits,409.11000061035156,3,18.586,0.0000,228.2722,180.8378,0.7922
2021,1,Suits & Sport Coats,1597.3600044250488,11,71.6835,37.5000,655.471,941.889,1.437
2021,1,Sweaters,1898.4899950027466,23,49.6477,27.7778,935.3537,963.1363,1.0297
2021,1,Swim,764.920000076294,15,-38.4217,-6.2500,405.8472,359.0728,0.8847
2021,1,Tops & Tees,1028.140009880066,23,2.4636,0.0000,569.5865,458.5535,0.8051
2021,1,Underwear,327.0000014305115,13,28.2353,30.0000,156.8543,170.1457,1.0847
2021,2,Accessories,746.7199897766113,17,20.0534,13.3333,299.5418,447.1782,1.4929
2021,2,Active,537.5499973297119,14,-14.3892,-6.6667,222.1917,315.3583,1.4193
2021,2,Blazers & Jackets,338.0099935531616,5,-11.9399,66.6667,119.2836,218.7264,1.8337
2021,2,Dresses,568.3000001907349,4,-49.0524,-69.2308,272.398,295.902,1.0863
2021,2,Fashion Hoodies & Sweatshirts,912.6099939346313,18,-17.1996,-21.7391,477.6934,434.9166,0.9105
2021,2,Intimates,417.6900005340576,17,-51.5744,-22.7273,223.0804,194.6096,0.8724
2021,2,Jeans,1889.3199996948242,17,36.7764,0.0000,1054.0885,835.2315,0.7924
2021,2,Jumpsuits & Rompers,44.970001220703125,2,-54.1122,100.0000,22.8433,22.1267,0.9686
2021,2,Leggings,132.88999938964844,3,141.4426,-25.0000,81.7271,51.1629,0.626
2021,2,Maternity,449.839994430542,6,4.1537,-33.3333,187.7693,262.0707,1.3957
2021,2,Outerwear & Coats,1753.6800003051758,12,-58.6565,-25.0000,774.7671,978.9129,1.2635
2021,2,Pants,388.58999824523926,6,-66.893,-68.4211,180.221,208.369,1.1562
2021,2,Pants & Capris,268.98000144958496,4,328.0395,100.0000,139.2354,129.7446,0.9318
2021,2,Plus,151.1699993610382,6,-66.2446,-40.0000,78.9865,72.1835,0.9139
2021,2,Shorts,1602.5400009155273,13,49.1345,-35.0000,799.1053,803.4347,1.0054
2021,2,Skirts,163.29000091552734,6,366.5429,500.0000,65.9876,97.3024,1.4746
2021,2,Sleep & Lounge,460.5599956512451,9,-51.28,-60.8696,209.9302,250.6298,1.1939
2021,2,Socks,162.7200002670288,8,-29.4056,-42.8571,95.83,66.89,0.698
2021,2,Socks & Hosiery,107.97999954223633,5,11.0677,-28.5714,44.4108,63.5692,1.4314
2021,2,Suits,379.0800018310547,3,-7.3403,0.0000,228.5655,150.5145,0.6585
2021,2,Suits & Sport Coats,773.2699966430664,7,-51.5908,-36.3636,310.4618,462.8082,1.4907
2021,2,Sweaters,1565.810001373291,20,-17.5234,-13.0435,742.6452,823.1648,1.1084
2021,2,Swim,1198.270004272461,16,56.653,6.6667,586.2656,612.0044,1.0439
2021,2,Tops & Tees,738.6400079727173,16,-28.1576,-30.4348,428.0211,310.6189,0.7257
2021,2,Underwear,289.9900016784668,9,-11.318,-30.7692,138.4935,151.4965,1.0939
2021,3,Accessories,560.6999955177307,13,-24.9116,-23.5294,219.8601,340.8398,1.5503
2021,3,Active,1736.3200054168701,19,223.0062,35.7143,740.3716,995.9484,1.3452
2021,3,Blazers & Jackets,479.6499996185303,5,41.9041,0.0000,171.7333,307.9167,1.793
2021,3,Dresses,1387.4499988555908,14,144.1404,250.0000,636.5547,750.8953,1.1796
2021,3,Fashion Hoodies & Sweatshirts,601.8800010681152,12,-34.0485,-33.3333,310.604,291.276,0.9378
2021,3,Intimates,967.0099973678589,23,131.5138,35.2941,511.2617,455.7482,0.8914
2021,3,Jeans,1241.3600006103516,15,-34.2959,-11.7647,665.4173,575.9427,0.8655
2021,3,Jumpsuits & Rompers,550.0,1,1123.0375,-50.0000,306.35,243.65,0.7953
2021,3,Leggings,129.4099998474121,6,-2.6187,100.0000,77.304,52.106,0.674
2021,3,Maternity,209.95000076293945,6,-53.3278,0.0000,97.33,112.62,1.1571
2021,3,Outerwear & Coats,1561.7399978637695,12,-10.945,0.0000,698.5685,863.1715,1.2356
2021,3,Pants,947.7199983596802,14,143.8869,133.3333,434.646,513.074,1.1804
2021,3,Pants & Capris,202.22000217437744,5,-24.8197,25.0000,108.036,94.184,0.8718
2021,3,Plus,387.3199996948242,8,156.2149,33.3333,190.3332,196.9868,1.035
2021,3,Shorts,650.8500003814697,16,-59.3863,23.0769,331.0764,319.7736,0.9659
2021,3,Skirts,168.98999977111816,2,3.4907,-66.6667,68.3015,100.6885,1.4742
2021,3,Sleep & Lounge,888.5200023651123,16,92.9217,77.7778,437.2742,451.2458,1.032
2021,3,Socks,238.82000160217285,11,46.7675,37.5000,145.8546,92.9654,0.6374
2021,3,Socks & Hosiery,47.760000228881836,2,-55.7696,-60.0000,19.7002,28.0598,1.4243
2021,3,Suits,571.3599853515625,3,50.7228,0.0000,333.9763,237.3837,0.7108
2021,3,Suits & Sport Coats,1366.4600067138672,12,76.7119,71.4286,541.1477,825.3123,1.5251
2021,3,Sweaters,1899.9799938201904,25,21.3417,25.0000,945.5808,954.3992,1.0093
2021,3,Swim,837.5299987792969,17,-30.1051,6.2500,429.7169,407.8131,0.949
2021,3,Tops & Tees,1009.5299987792969,25,36.6742,56.2500,565.9207,443.6093,0.7839
2021,3,Underwear,230.42000198364258,9,-20.5421,0.0000,108.7941,121.6259,1.1179
2021,4,Accessories,608.6499974727631,19,8.5518,46.1538,235.0637,373.5863,1.5893
2021,4,Active,1577.0300035476685,21,-9.174,10.5263,690.6568,886.3732,1.2834
2021,4,Blazers & Jackets,169.36000061035156,4,-64.6909,-20.0000,63.8525,105.5075,1.6524
2021,4,Dresses,706.4300031661987,6,-49.0843,-57.1429,332.6906,373.7394,1.1234
2021,4,Fashion Hoodies & Sweatshirts,913.0599956512451,19,51.7013,58.3333,460.3862,452.6737,0.9832
2021,4,Intimates,725.9099969863892,17,-24.9325,-26.0870,387.988,337.9219,0.871
2021,4,Jeans,3031.6599922180176,23,144.2209,53.3333,1578.4702,1453.1898,0.9206
2021,4,Jumpsuits & Rompers,108.70000076293945,2,-80.2364,100.0000,60.3559,48.3441,0.801
2021,4,Leggings,122.94999980926514,3,-4.9919,-50.0000,76.6327,46.3173,0.6044
2021,4,Maternity,430.54999923706055,8,105.0726,33.3333,198.9814,231.5686,1.1638
2021,4,Outerwear & Coats,1331.8199920654297,12,-14.722,0.0000,591.8312,739.9888,1.2503
2021,4,Pants,719.9400014877319,9,-24.0345,-35.7143,320.0042,399.9358,1.2498
2021,4,Pants & Capris,440.6800022125244,6,117.9211,20.0000,233.6844,206.9956,0.8858
2021,4,Plus,232.9000005722046,8,-39.8688,0.0000,119.3573,113.5427,0.9513
2021,4,Shorts,880.589994430542,18,35.2985,12.5000,441.2479,439.3421,0.9957
2021,4,Skirts,182.2199993133545,6,7.8289,200.0000,73.886,108.334,1.4662
2021,4,Sleep & Lounge,755.1799983978271,18,-15.007,12.5000,336.605,418.575,1.2435
2021,4,Socks,161.95000076293945,6,-32.1874,-45.4545,95.3567,66.5934,0.6984
2021,4,Socks & Hosiery,124.0,7,159.6315,250.0000,50.7908,73.2092,1.4414
2021,4,Suits,807.5300006866455,6,41.3347,100.0000,489.4395,318.0905,0.6499
2021,4,Suits & Sport Coats,933.1799755096436,7,-31.7082,-41.6667,395.2717,537.9082,1.3609
2021,4,Sweaters,1321.5000095367432,16,-30.4466,-36.0000,646.7332,674.7668,1.0433
2021,4,Swim,836.8400020599365,16,-0.0824,-5.8824,410.5099,426.3301,1.0385
2021,4,Tops & Tees,1469.8499965667725,20,45.5975,-20.0000,840.146,629.704,0.7495
2021,4,Underwear,297.0500011444092,12,28.9168,33.3333,135.7267,161.3233,1.1886
2021,5,Accessories,611.5599975585938,10,0.4781,-47.3684,244.4175,367.1425,1.5021
2021,5,Active,733.7699995040894,17,-53.4714,-19.0476,305.5118,428.2582,1.4018
2021,5,Blazers & Jackets,298.04000186920166,5,75.9802,25.0000,105.8103,192.2297,1.8167
2021,5,Dresses,829.7600059509277,11,17.4582,83.3333,378.8869,450.8731,1.19
2021,5,Fashion Hoodies & Sweatshirts,447.100004196167,11,-51.0328,-42.1053,230.6202,216.4798,0.9387
2021,5,Intimates,641.1400022506714,21,-11.6778,23.5294,337.1341,304.0059,0.9017
2021,5,Jeans,1953.6300029754639,21,-35.5591,-8.6957,1053.5895,900.0405,0.8543
2021,5,Jumpsuits & Rompers,58.239999771118164,2,-46.4213,0.0000,33.1092,25.1308,0.759
2021,5,Leggings,42.34000015258789,3,-65.5632,0.0000,24.3105,18.0296,0.7416
2021,5,Maternity,710.9499969482422,11,65.126,37.5000,316.93,394.02,1.2432
2021,5,Outerwear & Coats,3691.6900024414062,17,177.1914,41.6667,1655.9091,2035.7809,1.2294
2021,5,Pants,1240.6800022125244,17,72.331,88.8889,562.1848,678.4952,1.2069
2021,5,Pants & Capris,181.45999717712402,6,-58.8227,0.0000,97.1898,84.2702,0.8671
2021,5,Plus,104.44000053405762,4,-55.1567,-50.0000,52.9815,51.4585,0.9713
2021,5,Shorts,1153.730004310608,22,31.0178,22.2222,576.7449,576.9851,1.0004
2021,5,Skirts,51.94000053405762,2,-71.496,-66.6667,19.5803,32.3597,1.6527
2021,5,Sleep & Lounge,971.9500122070312,20,28.7044,11.1111,464.8109,507.1391,1.0911
2021,5,Socks,378.5000009536743,20,133.7141,233.3333,227.9436,150.5564,0.6605
2021,5,Socks & Hosiery,101.60000038146973,5,-18.0645,-28.5714,40.0366,61.5634,1.5377
2021,5,Suits,89.98999786376953,1,-88.8561,-83.3333,54.9839,35.0061,0.6367
2021,5,Suits & Sport Coats,1455.900016784668,8,56.0149,14.2857,598.5376,857.3624,1.4324
2021,5,Sweaters,2129.759979248047,25,61.1623,56.2500,1043.9515,1085.8085,1.0401
2021,5,Swim,1420.110008239746,23,69.6991,43.7500,802.5694,617.5407,0.7695
2021,5,Tops & Tees,833.0400018692017,20,-43.3248,0.0000,460.4968,372.5432,0.809
2021,5,Underwear,287.1599988937378,13,-3.3294,8.3333,133.2259,153.9341,1.1554
2021,6,Accessories,537.1500005722046,19,-12.1672,90.0000,208.0174,329.1326,1.5822
2021,6,Active,1406.3200101852417,25,91.6568,47.0588,577.9123,828.4077,1.4334
2021,6,Blazers & Jackets,1189.660011291504,9,299.1612,80.0000,450.6915,738.9685,1.6396
2021,6,Dresses,409.87000274658203,9,-50.6038,-18.1818,178.334,231.536,1.2983
2021,6,Fashion Hoodies & Sweatshirts,2136.9100074768066,26,377.949,136.3636,1176.8694,960.0406,0.8158
2021,6,Intimates,515.7600054740906,18,-19.5558,-14.2857,282.663,233.097,0.8246
2021,6,Jeans,3118.400001525879,28,59.6208,33.3333,1699.3448,1419.0552,0.8351
2021,6,Jumpsuits & Rompers,39.46999931335449,3,-32.2287,50.0000,20.2588,19.2112,0.9483
2021,6,Leggings,210.82999992370605,8,397.9452,166.6667,123.6138,87.2162,0.7056
2021,6,Maternity,432.12999534606934,11,-39.2179,0.0000,181.637,250.493,1.3791
2021,6,Outerwear & Coats,1661.8500022888184,13,-54.984,-23.5294,754.6739,907.1762,1.2021
2021,6,Pants,878.6900062561035,13,-29.1767,-23.5294,399.4021,479.2879,1.2
2021,6,Pants & Capris,580.2900009155273,12,219.7895,100.0000,303.3894,276.9006,0.9127
2021,6,Plus,128.9099998474121,6,23.4297,50.0000,66.8469,62.063,0.9284
2021,6,Shorts,929.4300065040588,23,-19.4413,4.5455,465.1981,464.2319,0.9979
2021,6,Skirts,93.6800012588501,3,80.362,50.0000,37.6301,56.0499,1.4895
2021,6,Sleep & Lounge,857.9200038909912,18,-11.7321,-10.0000,462.663,395.257,0.8543
2021,6,Socks,266.07000064849854,13,-29.7041,-35.0000,163.7396,102.3304,0.625
2021,6,Socks & Hosiery,129.88000011444092,8,27.8346,60.0000,53.3511,76.5289,1.4344
2021,6,Suits & Sport Coats,1881.9799995422363,10,29.2657,25.0000,763.4923,1118.4877,1.465
2021,6,Sweaters,1015.1600036621094,16,-52.3345,-36.0000,477.5695,537.5905,1.1257
2021,6,Swim,1473.6600131988525,25,3.7708,8.6957,739.6591,734.0009,0.9924
2021,6,Tops & Tees,562.3100004196167,14,-32.499,-30.0000,320.3232,241.9868,0.7554
2021,6,Underwear,447.94000339508057,15,55.9897,15.3846,210.1523,237.7877,1.1315
2021,7,Accessories,991.3699972629547,19,84.5611,0.0000,401.1099,590.2601,1.4716
2021,7,Active,874.3900003433228,16,-37.8243,-36.0000,352.4959,521.8941,1.4806
2021,7,Blazers & Jackets,1047.0400123596191,8,-11.9883,-11.1111,400.5956,646.4445,1.6137
2021,7,Dresses,1076.520004272461,10,162.6491,11.1111,487.1636,589.3564,1.2098
2021,7,Fashion Hoodies & Sweatshirts,1030.000005722046,21,-51.7996,-19.2308,519.3823,510.6177,0.9831
2021,7,Intimates,687.7300024032593,19,33.343,5.5556,362.9775,324.7525,0.8947
2021,7,Jeans,2909.030014038086,27,-6.714,-3.5714,1550.7614,1358.2687,0.8759
2021,7,Jumpsuits & Rompers,80.22999954223633,3,103.2683,0.0000,44.5143,35.7157,0.8023
2021,7,Leggings,143.63999938964844,7,-31.8693,-12.5000,88.5525,55.0875,0.6221
2021,7,Maternity,536.0300025939941,8,24.0437,-27.2727,243.7734,292.2566,1.1989
2021,7,Outerwear & Coats,1749.6400051116943,12,5.2827,-7.6923,784.3661,965.2739,1.2306
2021,7,Pants,841.2700042724609,16,-4.2586,23.0769,385.8527,455.4173,1.1803
2021,7,Pants & Capris,425.8800048828125,11,-26.6091,-8.3333,226.9157,198.9643,0.8768
2021,7,Plus,76.22999954223633,3,-40.8657,-50.0000,35.6251,40.6049,1.1398
2021,7,Shorts,958.9699993133545,23,3.1783,0.0000,478.0951,480.8749,1.0058
2021,7,Sleep & Lounge,1089.8000011444092,23,27.0282,27.7778,577.1606,512.6394,0.8882
2021,7,Socks,117.80000042915344,10,-55.7259,-23.0769,70.1335,47.6665,0.6797
2021,7,Socks & Hosiery,184.98000144958496,8,42.4238,0.0000,76.8419,108.1381,1.4073
2021,7,Suits & Sport Coats,1274.9699974060059,11,-32.2538,10.0000,498.2306,776.7394,1.559
2021,7,Sweaters,1092.3499908447266,21,7.6037,31.2500,532.3379,560.0121,1.052
2021,7,Swim,1405.2100105285645,22,-4.6449,-12.0000,750.4546,654.7554,0.8725
2021,7,Tops & Tees,958.7300033569336,24,70.4985,71.4286,533.3008,425.4292,0.7977
2021,7,Underwear,410.43000507354736,13,-8.3739,-13.3333,195.5953,214.8347,1.0984
2021,8,Accessories,908.510006904602,20,-8.3581,5.2632,354.7889,553.7211,1.5607
2021,8,Active,386.34999656677246,11,-55.8149,-31.2500,161.6996,224.6504,1.3893
2021,8,Blazers & Jackets,738.3100051879883,5,-29.486,-37.5000,302.4002,435.9098,1.4415
2021,8,Dresses,1819.8100032806396,13,69.0456,30.0000,856.5834,963.2267,1.1245
2021,8,Fashion Hoodies & Sweatshirts,1628.430009841919,30,58.1,42.8571,838.3041,790.1259,0.9425
2021,8,Intimates,1213.1000032424927,33,76.3919,73.6842,645.4398,567.6602,0.8795
2021,8,Jeans,2897.420000076294,29,-0.3991,7.4074,1549.3665,1348.0535,0.8701
2021,8,Jumpsuits & Rompers,191.96000003814697,3,139.2621,0.0000,105.3935,86.5665,0.8214
2021,8,Leggings,275.55999755859375,10,91.8407,42.8571,164.1893,111.3707,0.6783
2021,8,Maternity,361.9099979400635,8,-32.4833,0.0000,160.1269,201.7831,1.2601
2021,8,Outerwear & Coats,3084.159990310669,24,76.274,100.0000,1378.0794,1706.0806,1.238
2021,8,Pants,1079.3500022888184,18,28.3001,12.5000,489.5819,589.7681,1.2046
2021,8,Pants & Capris,330.84000301361084,8,-22.3161,-27.2727,173.9664,156.8736,0.9017
2021,8,Plus,499.3499994277954,12,555.0571,300.0000,260.6419,238.7081,0.9158
2021,8,Shorts,1453.2800092697144,30,51.5459,30.4348,739.3467,713.9333,0.9656
2021,8,Skirts,175.6500015258789,4,87.5,33.3333,69.3009,106.3491,1.5346
2021,8,Sleep & Lounge,820.8599987030029,18,-24.6779,-21.7391,451.798,369.062,0.8169
2021,8,Socks,257.76000213623047,14,118.8115,40.0000,155.9902,101.7698,0.6524
2021,8,Socks & Hosiery,166.44999980926514,9,-10.0173,12.5000,68.1816,98.2684,1.4413
2021,8,Suits & Sport Coats,829.1399898529053,7,-34.9679,-36.3636,327.696,501.444,1.5302
2021,8,Sweaters,1717.0500030517578,20,57.1886,-4.7619,830.3035,886.7465,1.068
2021,8,Swim,881.5700035095215,17,-37.2642,-22.7273,465.7186,415.8514,0.8929
2021,8,Tops & Tees,1197.3200035095215,25,24.886,4.1667,674.1284,523.1916,0.7761
2021,8,Underwear,269.30000019073486,11,-34.3859,-15.3846,128.1883,141.1117,1.1008
2021,9,Accessories,792.3900003433228,19,-12.7814,-5.0000,324.398,467.992,1.4426
2021,9,Active,244.46000480651855,8,-36.7258,-27.2727,105.1898,139.2702,1.324
2021,9,Blazers & Jackets,523.370002746582,10,-29.1124,100.0000,196.7954,326.5746,1.6595
2021,9,Dresses,1157.9100046157837,11,-36.3719,-15.3846,524.2173,633.6927,1.2088
2021,9,Fashion Hoodies & Sweatshirts,1066.1300029754639,19,-34.5302,-36.6667,547.3456,518.7844,0.9478
2021,9,Intimates,1016.8000054359436,26,-16.1817,-21.2121,531.6376,485.1624,0.9126
2021,9,Jeans,2896.920000076294,29,-0.0173,0.0000,1542.6538,1354.2662,0.8779
2021,9,Jumpsuits & Rompers,316.98999977111816,4,65.1334,33.3333,163.3019,153.6881,0.9411
2021,9,Leggings,128.55000114440918,8,-53.3495,-20.0000,76.2185,52.3315,0.6866
2021,9,Maternity,555.8899998664856,9,53.599,12.5000,230.2648,325.6252,1.4141
2021,9,Outerwear & Coats,2724.7300033569336,17,-11.6541,-29.1667,1216.9565,1507.7736,1.239
2021,9,Pants,1233.140001296997,18,14.2484,0.0000,571.973,661.167,1.1559
2021,9,Pants & Capris,456.89000511169434,9,38.1,12.5000,242.4355,214.4545,0.8846
2021,9,Plus,621.1999979019165,18,24.4017,50.0000,312.8006,308.3994,0.9859
2021,9,Shorts,1356.740005493164,30,-6.6429,0.0000,670.3103,686.4297,1.024
2021,9,Skirts,175.1800022125244,3,-0.2676,-25.0000,75.5296,99.6504,1.3194
2021,9,Sleep & Lounge,1532.5600092411041,35,86.7018,94.4444,793.5938,738.9662,0.9312
2021,9,Socks,361.83000087738037,18,40.3748,28.5714,220.6031,141.2269,0.6402
2021,9,Socks & Hosiery,90.45999908447266,8,-45.6533,-11.1111,36.9773,53.4827,1.4464
2021,9,Suits,261.25000381469727,3,190.31,200.0000,156.6801,104.5699,0.6674
2021,9,Suits & Sport Coats,1246.3000106811523,11,50.3124,57.1429,511.3195,734.9805,1.4374
2021,9,Sweaters,1456.7300033569336,20,-15.1609,0.0000,696.2806,760.4494,1.0922
2021,9,Swim,1514.7200012207031,28,71.8207,64.7059,811.9242,702.7958,0.8656
2021,9,Tops & Tees,610.5200073719025,21,-49.0095,-16.0000,346.3869,264.1331,0.7625
2021,9,Underwear,279.32000064849854,13,3.7208,18.1818,125.9756,153.3444,1.2173
2021,10,Accessories,824.8700008392333,19,4.099,0.0000,340.5817,484.2883,1.4219
2021,10,Active,842.2700099945068,16,244.5431,100.0000,364.5885,477.6815,1.3102
2021,10,Blazers & Jackets,1019.1599998474121,7,94.7303,-30.0000,384.2001,634.9599,1.6527
2021,10,Dresses,1093.5399980545044,12,-5.5592,9.0909,473.5922,619.9478,1.309
2021,10,Fashion Hoodies & Sweatshirts,1530.1800022125244,28,43.5266,47.3684,782.0967,748.0833,0.9565
2021,10,Intimates,1196.0900058746338,29,17.6328,11.5385,634.5559,561.5341,0.8849
2021,10,Jeans,2779.7899990081787,28,-4.0433,-3.4483,1496.0687,1283.7213,0.8581
2021,10,Jumpsuits & Rompers,91.43000030517578,1,-71.1568,-75.0000,50.9265,40.5035,0.7953
2021,10,Leggings,121.21999931335449,6,-5.7021,-25.0000,73.2687,47.9513,0.6545
2021,10,Maternity,385.6500015258789,12,-30.6248,33.3333,167.6658,217.9842,1.3001
2021,10,Outerwear & Coats,3325.5,24,22.0488,41.1765,1475.5126,1849.9874,1.2538
2021,10,Pants,758.2700061798096,13,-38.509,-27.7778,348.4079,409.8621,1.1764
2021,10,Pants & Capris,655.6299991607666,14,43.4984,55.5556,351.6823,303.9477,0.8643
2021,10,Plus,441.42000007629395,7,-28.9408,-61.1111,226.8271,214.5929,0.9461
2021,10,Shorts,917.439998626709,23,-32.3791,-23.3333,458.1089,459.3311,1.0027
2021,10,Skirts,639.2299995422363,8,264.899,166.6667,252.6305,386.5995,1.5303
2021,10,Sleep & Lounge,973.8400001525879,22,-36.4566,-37.1429,481.5549,492.2851,1.0223
2021,10,Socks,294.11999893188477,16,-18.7132,-11.1111,177.9875,116.1325,0.6525
2021,10,Socks & Hosiery,190.85000133514404,10,110.9772,25.0000,76.5277,114.3224,1.4939
2021,10,Suits,427.239990234375,5,63.5368,66.6667,262.973,164.267,0.6247
2021,10,Suits & Sport Coats,1546.309986114502,12,24.0721,9.0909,575.8761,970.4339,1.6851
2021,10,Sweaters,1356.3799991607666,20,-6.8887,0.0000,649.1001,707.2798,1.0896
2021,10,Swim,2116.4299869537354,33,39.7242,17.8571,1026.4519,1089.978,1.0619
2021,10,Tops & Tees,1651.5500001907349,33,170.5153,57.1429,930.154,721.396,0.7756
2021,10,Underwear,652.0500030517578,24,133.4419,84.6154,311.753,340.297,1.0916
2021,11,Accessories,533.7200016975403,17,-35.2965,-10.5263,210.5555,323.1645,1.5348
2021,11,Active,775.299994468689,20,-7.9511,25.0000,324.8604,450.4396,1.3866
2021,11,Blazers & Jackets,929.4100017547607,7,-8.8063,0.0000,356.8534,572.5566,1.6045
2021,11,Dresses,1092.6600093841553,11,-0.0805,-8.3333,496.9862,595.6738,1.1986
2021,11,Fashion Hoodies & Sweatshirts,1218.7200050354004,22,-20.3545,-21.4286,606.8766,611.8434,1.0082
2021,11,Intimates,1406.4000005722046,31,17.5831,6.8966,753.7554,652.6446,0.8659
2021,11,Jeans,3145.840005874634,29,13.1683,3.5714,1689.8514,1455.9886,0.8616
2021,11,Jumpsuits & Rompers,82.46999835968018,2,-9.7998,100.0000,45.0982,37.3718,0.8287
2021,11,Leggings,225.45999813079834,8,85.9924,33.3333,137.7857,87.6743,0.6363
2021,11,Maternity,583.569995880127,10,51.3211,-16.6667,249.2688,334.3012,1.3411
2021,11,Outerwear & Coats,4707.790004730225,28,41.5664,16.6667,2116.0788,2591.7112,1.2248
2021,11,Pants,1344.8800106048584,22,77.3616,69.2308,622.8058,722.0742,1.1594
2021,11,Pants & Capris,344.0700044631958,6,-47.5207,-57.1429,181.7182,162.3519,0.8934
2021,11,Plus,321.2199954986572,6,-27.2303,-14.2857,163.0478,158.1722,0.9701
2021,11,Shorts,947.5500011444092,18,3.282,-21.7391,480.3719,467.1781,0.9725
2021,11,Skirts,112.44000148773193,3,-82.4101,-62.5000,45.5469,66.8931,1.4687
2021,11,Sleep & Lounge,1319.4300079345703,30,35.4873,36.3636,670.1928,649.2372,0.9687
2021,11,Socks,364.020001411438,20,23.7658,25.0000,222.8731,141.1469,0.6333
2021,11,Socks & Hosiery,144.9199993610382,9,-24.066,-10.0000,54.874,90.046,1.641
2021,11,Suits,624.5500030517578,5,46.1825,0.0000,377.4371,247.1129,0.6547
2021,11,Suits & Sport Coats,614.9300003051758,5,-60.2324,-58.3333,262.4829,352.4471,1.3427
2021,11,Sweaters,2357.680004119873,27,73.8215,35.0000,1140.4582,1217.2218,1.0673
2021,11,Swim,1471.9300060272217,28,-30.4522,-15.1515,741.1528,730.7772,0.986
2021,11,Tops & Tees,1517.4100017547607,30,-8.1221,-9.0909,859.4748,657.9352,0.7655
2021,11,Underwear,546.1199998855591,18,-16.2457,-25.0000,255.8174,290.3026,1.1348
2021,12,Accessories,963.529997587204,28,80.531,64.7059,386.7431,576.7869,1.4914
2021,12,Active,1272.1800003051758,30,64.0887,50.0000,533.4493,738.7307,1.3848
2021,12,Blazers & Jackets,990.7299995422363,7,6.5977,0.0000,376.3628,614.3672,1.6324
2021,12,Clothing Sets,109.0,2,55.7365,100.0000,71.84,37.16,0.5173
2021,12,Dresses,1651.28999710083,16,51.1257,45.4545,742.4716,908.8184,1.224
2021,12,Fashion Hoodies & Sweatshirts,1383.5799980163574,26,13.5273,18.1818,689.4401,694.1399,1.0068
2021,12,Intimates,878.1500005722046,28,-37.5604,-9.6774,470.0783,408.0717,0.8681
2021,12,Jeans,2491.0,25,-20.8161,-13.7931,1309.7524,1181.2476,0.9019
2021,12,Jumpsuits & Rompers,29.270000457763672,2,-64.5083,0.0000,16.0534,13.2166,0.8233
2021,12,Leggings,162.08999919891357,7,-28.107,-12.5000,98.1426,63.9474,0.6516
2021,12,Maternity,625.2099990844727,8,7.1354,-20.0000,279.5859,345.6241,1.2362
2021,12,Outerwear & Coats,2980.789981842041,29,-36.6839,3.5714,1322.4898,1658.3002,1.2539
2021,12,Pants,1337.7900066375732,19,-0.5272,-13.6364,620.2238,717.5662,1.1569
2021,12,Pants & Capris,743.9900197982788,15,116.2322,150.0000,403.5719,340.4181,0.8435
2021,12,Plus,228.63000106811523,10,-28.8245,66.6667,116.5267,112.1033,0.962
2021,12,Shorts,1103.700002193451,27,16.4793,50.0000,550.5479,553.1521,1.0047
2021,12,Skirts,266.98999977111816,3,137.4511,0.0000,110.1657,156.8243,1.4235
2021,12,Sleep & Lounge,1303.4700050354004,26,-1.2096,-13.3333,673.8507,629.6194,0.9344
2021,12,Socks,198.51999950408936,12,-45.4645,-40.0000,120.9343,77.5857,0.6416
2021,12,Socks & Hosiery,130.8100004196167,10,-9.7364,11.1111,55.8989,74.9111,1.3401
2021,12,Suits,543.2400131225586,4,-13.019,-20.0000,317.5374,225.7026,0.7108
2021,12,Suits & Sport Coats,1230.129997253418,8,100.0439,60.0000,470.4105,759.7195,1.615
2021,12,Sweaters,3885.770009994507,31,64.8133,14.8148,1815.8964,2069.8736,1.1399
2021,12,Swim,1906.1799936294556,29,29.5021,3.5714,890.9704,1015.2096,1.1394
2021,12,Tops & Tees,1406.8200092315674,33,-7.2881,10.0000,773.5915,633.2285,0.8186
2021,12,Underwear,527.230001449585,21,-3.4589,16.6667,250.7546,276.4754,1.1026


2025-02-12 07:08:12 - root - INFO - Please check the answer again by reviewing Generate a monthly report for each product category , where each row corresponds to orders that have a status of 'Complete' and were delivered before the year 2022, grouping by the month and year of delivery. For each category, calculate the total revenue (the sum of sale_price), the total number of completed orders, and compute the month-over-month percentage growth for both revenue and orders by comparing each month’s totals to the previous month’s. Then, for the same orders, aggregate and show the total cost (from product costs), total profit (revenue minus total cost), and finally the profit-to-cost ratio for each month., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Year,Month,Category,Total_Revenue,Total_Completed_Orders,Revenue_MoM_Growth(%),Orders_MoM_Growth(%),Total_Cost,Total_Profit,Profit_to_Cost_Ratio
year:int,month:int,category:str,total_revenue:float,total_orders:int,revenue_mom_growth:float,orders_mom_growth:float,total_cost:float,total_profit:float,profit_to_cost_ratio:float
...
```

This report displays, for each product category and for each month and year before 2022, the total revenue from completed orders, the total number of completed orders, the month-over-month growth percentages for both revenue and orders compared to the previous month, the total cost of products sold, the total profit (calculated as revenue minus total cost), and the profit-to-cost ratio for that period. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
year,month,category,total_revenue,total_completed_orders,Revenue_MoM_Growth(%),Orders_MoM_Growth(%),total_cost,total_profit,profit_to_cost_ratio
2019,2,Accessories,26.950000762939453,2,,,11.8039,15.1461,1.2831
2019,2,Active,84.94999694824217,1,,,34.8295,50.1205,1.439
2019,2,Fashion Hoodies & Sweatshirts,400.2699890136719,4,,,230.1069,170.1631,0.7395
2019,2,Maternity,62.0,1,,,28.458,33.542,1.1786
2019,2,Shorts,83.98999977111816,2,,,40.1587,43.8313,1.0915
2019,2,Sleep & Lounge,166.5,2,,,60.1585,106.3415,1.7677
2019,2,Socks,51.81999921798706,4,,,30.1788,21.6412,0.7171
2019,2,Socks & Hosiery,10.0,1,,,4.22,5.78,1.3697
2019,2,Sweaters,42.0,1,,,21.588,20.412,0.9455
2019,2,Tops & Tees,130.0,1,,,74.36,55.64,0.7483
2019,3,Active,66.9900016784668,2,-21.1418,100.0000,26.6971,40.2929,1.5093
2019,3,Intimates,46.0,2,,,24.696,21.304,0.8626
2019,3,Jeans,239.9900016784668,2,,,137.7322,102.2578,0.7424
2019,3,Maternity,38.0,1,-38.7097,0.0000,17.974,20.026,1.1142
2019,3,Outerwear & Coats,903.0,1,,,419.895,483.105,1.1505
2019,3,Shorts,61.97999954223633,2,-26.2055,0.0000,30.0077,31.9723,1.0655
2019,3,Sleep & Lounge,64.0,1,-61.5616,-50.0000,40.256,23.744,0.5898
2019,3,Socks,9.359999656677246,1,-81.9375,-75.0000,5.719,3.641,0.6367
2019,3,Suits,88.2699966430664,1,,,52.1676,36.1024,0.692
2019,3,Sweaters,63.59999847412109,1,51.4286,0.0000,30.1464,33.4536,1.1097
2019,3,Swim,41.650001525878906,1,,,25.2816,16.3685,0.6474
2019,4,Accessories,50.0,1,85.5288,-50.0000,22.5,27.5,1.2222
2019,4,Active,25.0,1,-62.681,-50.0000,9.325,15.675,1.681
2019,4,Fashion Hoodies & Sweatshirts,91.9000015258789,2,-77.0405,-50.0000,51.973,39.927,0.7682
2019,4,Intimates,42.0,1,-8.6957,-50.0000,21.168,20.832,0.9841
2019,4,Jeans,34.5,1,-85.6244,-50.0000,19.803,14.697,0.7422
2019,4,Leggings,19.989999771118164,1,,,11.4942,8.4957,0.7391
2019,4,Maternity,30.5,2,-19.7368,100.0000,13.2757,17.2243,1.2974
2019,4,Outerwear & Coats,41.9900016784668,1,-95.3499,0.0000,20.1552,21.8348,1.0833
2019,4,Pants,95.0,1,,,46.265,48.735,1.0534
2019,4,Pants & Capris,42.9900016784668,1,,,22.3978,20.5922,0.9194
2019,4,Plus,12.989999771118164,1,,,6.8847,6.1053,0.8868
2019,4,Shorts,185.70000076293945,2,199.6128,0.0000,94.073,91.627,0.974
2019,4,Sleep & Lounge,239.93999862670898,2,274.9062,100.0000,103.2342,136.7058,1.3242
2019,4,Socks,42.0,2,348.718,100.0000,25.677,16.323,0.6357
2019,4,Sweaters,189.89999389648438,2,198.5849,100.0000,79.7196,110.1804,1.3821
2019,4,Swim,52.0,1,24.8499,0.0000,31.98,20.02,0.626
2019,4,Tops & Tees,61.4300012588501,2,-52.7462,100.0000,33.9825,27.4475,0.8077
2019,4,Underwear,29.979999542236328,2,,,13.3711,16.6089,1.2422
2019,5,Accessories,141.65000343322754,3,183.3,200.0000,54.7881,86.8619,1.5854
2019,5,Active,144.0,3,476.0,200.0000,56.246,87.754,1.5602
2019,5,Dresses,68.85000038146973,2,,,30.4963,38.3537,1.2577
2019,5,Intimates,300.8800048828125,5,616.381,400.0000,163.691,137.189,0.8381
2019,5,Jeans,86.75,1,151.4493,0.0000,46.2377,40.5123,0.8762
2019,5,Jumpsuits & Rompers,15.8100004196167,1,,,8.0157,7.7943,0.9724
2019,5,Maternity,146.82999801635742,3,381.4098,50.0000,65.5757,81.2543,1.2391
2019,5,Pants,94.9900016784668,2,-0.0105,100.0000,44.725,50.2651,1.1239
2019,5,Pants & Capris,11.970000267028809,1,-72.1563,0.0000,6.6793,5.2907,0.7921
2019,5,Plus,16.989999771118164,1,30.7929,0.0000,9.2595,7.7304,0.8349
2019,5,Shorts,84.38000106811523,1,-54.5611,-50.0000,42.2236,42.1564,0.9984
2019,5,Sleep & Lounge,47.59000015258789,2,-80.1659,0.0000,22.6387,24.9513,1.1022
2019,5,Socks & Hosiery,40.0,2,300.0,100.0000,14.815,25.185,1.7
2019,5,Suits & Sport Coats,299.989990234375,1,,,125.6958,174.2942,1.3866
2019,5,Sweaters,72.95999908447266,1,-61.5798,-50.0000,34.5101,38.4499,1.1142
2019,5,Swim,143.86000061035156,3,176.6538,200.0000,76.4125,67.4475,0.8827
2019,5,Tops & Tees,49.0,2,-20.2344,0.0000,25.734,23.266,0.9041
2019,5,Underwear,47.0,2,56.7712,0.0000,23.099,23.901,1.0347
2019,6,Accessories,153.0999984741211,4,8.0833,33.3333,59.9366,93.1634,1.5544
2019,6,Active,100.0,2,-30.5556,-33.3333,39.57,60.43,1.5272
2019,6,Blazers & Jackets,53.180000305175774,1,,,18.1344,35.0456,1.9326
2019,6,Dresses,255.97999954223633,2,271.7938,0.0000,109.9554,146.0246,1.328
2019,6,Fashion Hoodies & Sweatshirts,161.18000030517578,3,75.3863,50.0000,88.0405,73.1395,0.8307
2019,6,Intimates,148.98999977111816,5,-50.4819,0.0000,80.2008,68.7892,0.8577
2019,6,Jeans,362.9900016784668,3,318.4323,200.0000,195.815,167.175,0.8537
2019,6,Leggings,6.980000019073486,1,-65.0825,0.0000,4.0205,2.9595,0.7361
2019,6,Maternity,73.41999816894531,1,-49.9966,-66.6667,30.6896,42.7304,1.3923
2019,6,Outerwear & Coats,1182.9399948120117,4,2717.1944,300.0000,498.4235,684.5164,1.3734
2019,6,Pants,79.95000076293945,2,-15.8332,0.0000,35.1394,44.8106,1.2752
2019,6,Shorts,167.45000076293945,3,98.4475,200.0000,84.3872,83.0629,0.9843
2019,6,Sleep & Lounge,14.989999771118164,1,-68.5018,-50.0000,5.8761,9.1139,1.551
2019,6,Socks,119.9499969482422,1,185.5952,-50.0000,74.9687,44.9812,0.6
2019,6,Suits & Sport Coats,79.94999694824217,1,-73.3491,0.0000,34.0587,45.8913,1.3474
2019,6,Sweaters,272.9799995422363,2,274.1502,100.0000,136.5958,136.3842,0.9985
2019,6,Swim,359.2699966430664,5,149.7359,66.6667,198.9107,160.3593,0.8062
2019,6,Tops & Tees,57.50000190734863,2,17.3469,0.0000,33.9723,23.5277,0.6926
2019,6,Underwear,170.0900001525879,6,261.8936,200.0000,77.4782,92.6118,1.1953
2019,7,Active,107.98999977111816,3,7.99,50.0000,45.3598,62.6302,1.3807
2019,7,Blazers & Jackets,249.0,1,368.2211,0.0000,84.411,164.589,1.9499
2019,7,Dresses,39.950000762939446,1,-84.3933,-50.0000,18.6567,21.2934,1.1413
2019,7,Fashion Hoodies & Sweatshirts,284.03999519348145,5,76.2253,66.6667,146.8878,137.1522,0.9337
2019,7,Intimates,224.5900046825409,5,50.7417,0.0000,113.7096,110.8804,0.9751
2019,7,Jeans,836.9500045776367,6,130.5711,100.0000,444.868,392.082,0.8813
2019,7,Jumpsuits & Rompers,9.920000076293944,1,-37.2549,0.0000,5.4659,4.4541,0.8149
2019,7,Leggings,11.829999923706056,1,69.4842,0.0000,7.0034,4.8266,0.6892
2019,7,Maternity,34.97999954223633,1,-52.3563,0.0000,13.6772,21.3028,1.5575
2019,7,Outerwear & Coats,165.9499969482422,2,-85.9714,-50.0000,73.1175,92.8324,1.2696
2019,7,Pants,135.0,1,68.8555,-50.0000,56.025,78.975,1.4096
2019,7,Pants & Capris,170.89999961853027,4,1327.736,300.0000,92.6145,78.2855,0.8453
2019,7,Plus,98.05999946594238,2,477.163,100.0000,51.3712,46.6888,0.9089
2019,7,Shorts,171.11999988555908,5,2.1917,66.6667,87.86,83.26,0.9476
2019,7,Sleep & Lounge,166.48000144958496,4,1010.6071,300.0000,77.1555,89.3245,1.1577
2019,7,Socks,24.210000038146973,2,-79.8166,100.0000,14.4824,9.7276,0.6717
2019,7,Socks & Hosiery,12.0,1,-70.0,-50.0000,4.812,7.188,1.4938
2019,7,Suits & Sport Coats,71.2400016784668,2,-10.8943,100.0000,26.586,44.654,1.6796
2019,7,Sweaters,100.8000030517578,1,-63.0742,-50.0000,55.2384,45.5616,0.8248
2019,7,Swim,49.5,1,-86.2221,-80.0000,29.0565,20.4435,0.7036
2019,7,Tops & Tees,269.9400005340576,4,369.4609,100.0000,152.14,117.8,0.7743
2019,7,Underwear,103.19000053405762,4,-39.3321,-33.3333,47.6017,55.5883,1.1678
2019,8,Accessories,212.15999794006348,6,38.5761,50.0000,83.5437,128.6163,1.5395
2019,8,Active,222.5400047302246,4,106.0746,33.3333,92.3029,130.2371,1.411
2019,8,Dresses,39.950000762939446,1,0.0,0.0000,17.578,22.372,1.2727
2019,8,Fashion Hoodies & Sweatshirts,367.0799961090088,7,29.2353,40.0000,193.0866,173.9934,0.9011
2019,8,Intimates,146.39000129699707,5,-34.819,0.0000,77.3077,69.0823,0.8936
2019,8,Jeans,680.2299995422363,8,-18.7251,33.3333,351.3454,328.8846,0.9361
2019,8,Leggings,37.69000053405762,2,218.5968,100.0000,21.6162,16.0738,0.7436
2019,8,Maternity,35.720001220703125,1,2.1155,0.0000,15.7525,19.9675,1.2676
2019,8,Outerwear & Coats,554.2500019073486,5,233.9861,150.0000,228.3703,325.8797,1.427
2019,8,Pants,109.9900016784668,2,-18.5259,100.0000,53.7102,56.2798,1.0478
2019,8,Pants & Capris,191.0,2,11.7613,-50.0000,97.773,93.227,0.9535
2019,8,Plus,96.93000221252441,3,-1.1524,50.0000,46.0333,50.8967,1.1056
2019,8,Shorts,363.44000244140625,6,112.389,20.0000,179.9422,183.4978,1.0198
2019,8,Sleep & Lounge,338.8499946594238,6,103.538,50.0000,157.361,181.489,1.1533
2019,8,Socks,12.949999809265137,1,-46.5097,-50.0000,7.3297,5.6203,0.7668
2019,8,Socks & Hosiery,35.989999771118164,2,199.9167,100.0000,14.4602,21.5298,1.4889
2019,8,Suits,200.0,1,126.5776,0.0000,129.6,70.4,0.5432
2019,8,Suits & Sport Coats,334.4000015258789,2,369.3992,0.0000,131.1552,203.2448,1.5497
2019,8,Sweaters,666.7799987792969,9,561.4881,800.0000,337.4545,329.3255,0.9759
2019,8,Swim,272.2899971008301,4,450.0808,300.0000,122.08,150.21,1.2304
2019,8,Tops & Tees,203.22000217437744,6,-24.7166,50.0000,110.2074,93.0126,0.844
2019,8,Underwear,61.0,3,-40.8857,-25.0000,27.405,33.595,1.2259
2019,9,Accessories,222.43000030517578,5,4.8407,-16.6667,83.9071,138.5229,1.6509
2019,9,Active,150.67999649047852,3,-32.2908,-25.0000,64.9987,85.6813,1.3182
2019,9,Blazers & Jackets,10.949999809265137,1,-95.6024,0.0000,4.5661,6.3838,1.3981
2019,9,Dresses,107.11999893188477,2,168.1352,100.0000,47.4812,59.6387,1.256
2019,9,Fashion Hoodies & Sweatshirts,382.2999973297119,7,4.1462,0.0000,203.3563,178.9437,0.88
2019,9,Intimates,360.1900005340576,10,146.0482,100.0000,190.0414,170.1486,0.8953
2019,9,Jeans,444.9900016784668,6,-34.5824,-25.0000,248.3602,196.6298,0.7917
2019,9,Leggings,74.98999977111816,3,98.9652,50.0000,44.6576,30.3324,0.6792
2019,9,Maternity,52.970001220703125,2,48.2923,100.0000,24.8377,28.1323,1.1326
2019,9,Outerwear & Coats,305.9499969482422,3,-44.7993,-40.0000,139.2373,166.7127,1.1973
2019,9,Pants,72.95000076293945,2,-33.6758,0.0000,30.8299,42.1201,1.3662
2019,9,Pants & Capris,69.0,1,-63.8743,-50.0000,38.847,30.153,0.7762
2019,9,Plus,96.98999977111816,2,0.0619,-33.3333,51.857,45.133,0.8703
2019,9,Shorts,181.5,4,-50.0605,-33.3333,87.26,94.24,1.08
2019,9,Skirts,155.0300006866455,3,,,64.113,90.917,1.4181
2019,9,Sleep & Lounge,152.9300022125244,4,-54.8679,-33.3333,67.6912,85.2388,1.2592
2019,9,Socks,74.65000057220459,2,476.4479,100.0000,47.1575,27.4926,0.583
2019,9,Sweaters,220.0399971
Current sql:
SELECT
    "year",
    "month",
    "category",
    "total_revenue",
    "total_completed_orders",
    ROUND(
        (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        4
    ) AS "Revenue_MoM_Growth(%)",
    ROUND(
        (("total_completed_orders" - LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        4
    ) AS "Orders_MoM_Growth(%)",
    ROUND("total_cost", 4) AS "total_cost",
    ROUND("total_profit", 4) AS "total_profit",
    ROUND("profit_to_cost_ratio", 4) AS "profit_to_cost_ratio"
FROM (
    SELECT
        EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "year",
        EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "month",
        p."category",
        SUM(oi."sale_price") AS "total_revenue",
        COUNT(DISTINCT o."order_id") AS "total_completed_orders",
        SUM(p."cost") AS "total_cost",
        SUM(oi."sale_price" - p."cost") AS "total_profit",
        SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
    FROM
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        o."status" = 'Complete'
        AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6) < '2022-01-01'
    GROUP BY
        "year", "month", p."category"
) base_data
ORDER BY
    "year", "month", "category";
2025-02-12 07:08:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 07:08:42 - root - INFO - ```sql
SELECT
    "year",
    "month",
    "category",
    "total_revenue",
    "total_completed_orders",
    ROUND(
        (("total_revenue" - LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_revenue") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        4
    ) AS "Revenue_MoM_Growth(%)",
    ROUND(
        (("total_completed_orders" - LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"))
         / NULLIF(LAG("total_completed_orders") OVER (PARTITION BY "category" ORDER BY "year", "month"), 0)) * 100,
        4
    ) AS "Orders_MoM_Growth(%)",
    ROUND("total_cost", 4) AS "total_cost",
    ROUND("total_profit", 4) AS "total_profit",
    ROUND("profit_to_cost_ratio", 4) AS "profit_to_cost_ratio"
FROM (
    SELECT
        EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "year",
        EXTRACT(MONTH FROM TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6)) AS "month",
        p."category",
        SUM(oi."sale_price") AS "total_revenue",
        COUNT(DISTINCT o."order_id") AS "total_completed_orders",
        SUM(p."cost") AS "total_cost",
        SUM(oi."sale_price" - p."cost") AS "total_profit",
        SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
    FROM
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDER_ITEMS" oi
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."ORDERS" o
        ON oi."order_id" = o."order_id"
    JOIN
        "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        o."status" = 'Complete'
        AND TO_TIMESTAMP_NTZ(o."delivered_at" / 1e6) < '2022-01-01'
    GROUP BY
        "year", "month", p."category"
) base_data
ORDER BY
    "year", "month", "category";
```
2025-02-12 07:08:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 07:08:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 07:08:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 07:08:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 796
2025-02-12 07:08:43 - snowflake.connector.connection - INFO - closed
2025-02-12 07:08:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 07:08:44 - root - INFO - itercount: 3
2025-02-12 07:08:44 - root - INFO - 0
2025-02-12 07:08:44 - root - INFO - Total iteration counts: 3
