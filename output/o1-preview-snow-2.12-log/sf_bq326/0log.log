2025-02-11 01:57:26 - openai._base_client - INFO - Retrying request to /chat/completions in 0.407798 seconds
2025-02-11 01:58:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:58:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-02-11 01:58:32 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:33 - root - INFO - SQL:
SELECT DISTINCT "indicator_name"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" ILIKE '%health expenditure%'
   LIMIT 100;
Results:
indicator_name
Current health expenditure per capita (current US$)
Domestic general government health expenditure per capita (current US$)
Domestic private health expenditure (% of current health expenditure)
External health expenditure per capita (current US$)
"External health expenditure per capita, PPP (current international $)"
Out-of-pocket expenditure (% of current health expenditure)
External health expenditure channeled through government (% of external health expenditure)
Domestic general government health expenditure (% of current health expenditure)
Domestic private health expenditure per capita (current US$)
Domestic general government health expenditure (% of GDP)
"Current health expenditure per capita, PPP (current international $)"
External health expenditure (% of current health expenditure)
"Domestic private health expenditure per capita, PPP  (current international $)"
"Domestic general government health expenditure per capita, PPP (current international $)"
Capital health expenditure (% of GDP)
Domestic general government health expenditure (% of general government expenditure)
Current health expenditure (% of GDP)

2025-02-11 01:58:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:34 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:34 - root - INFO - SQL:
SELECT *
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
   LIMIT 100;
Results:
Too long, hard cut:
country_name,country_code,indicator_name,indicator_code,value,year
Brazil,BRA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,833.33392334,2002
Brazil,BRA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,1411.1307373,2016
Cambodia,KHM,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,155.51541138,2008
Uganda,UGA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,135.98130798,2005
United Kingdom,GBR,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,3035.11376953,2006
United Kingdom,GBR,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,3171.75708008,2007
United States,USA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,7410.70068359,2008
Uruguay,URY,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,1553.78601074,2011
Vanuatu,VUT,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,76.88131714,2005
Vanuatu,VUT,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,86.51495361,2008
Zambia,ZMB,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,176.64027405,2013
"Congo, Dem. Rep.",COD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,24.87830925,2007
"Congo, Dem. Rep.",COD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,33.00378799,2014
Croatia,HRV,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,1644.48266602,2012
Cyprus,CYP,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2091.35473633,2012
Czech Republic,CZE,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2441.99023438,2015
Djibouti,DJI,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,103.31958008,2003
Moldova,MDA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,287.74880981,2004
Nauru,NRU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,585.75341797,2009
Nicaragua,NIC,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,310.15368652,2011
Nicaragua,NIC,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,434.65509033,2016
Nigeria,NGA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,194.91674805,2013
North Macedonia,MKD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,543.46282959,2000
North Macedonia,MKD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,585.79418945,2003
Norway,NOR,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,3562.25268555,2003
Oman,OMN,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,986.08129883,2007
Palau,PLW,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2011.51733398,2018
East Asia & Pacific,EAS,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,395.338759235213,2005
Euro area,EMU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2661.74417066721,2004
Euro area,EMU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,4572.35296577739,2017
Europe & Central Asia (IDA & IBRD countries),TEC,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,705.048253253517,2007
European Union,EUU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2173.88984429349,2003
Fragile and conflict affected situations,FCS,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,196.255117181505,2013
Late-demographic dividend,LTE,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,432.388249077357,2007
Late-demographic dividend,LTE,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,905.935923764474,2016
Fiji,FJI,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,286.46136475,2013
Ghana,GHA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,148.41990662,2017
Ghana,GHA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,167.97952271,2018
Guatemala,GTM,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,422.92913818,2012
Guatemala,GTM,"Current health expenditure per capita, PPP (current intern

2025-02-11 01:58:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:35 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:36 - root - INFO - SQL:
SELECT "country_name", "year", "value"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   ORDER BY "country_name", "year"
   LIMIT 100;
Results:
country_name,year,value
Afghanistan,2017,228.18478394
Afghanistan,2018,186.4072876
Africa Eastern and Southern,2017,220.974858439749
Africa Eastern and Southern,2018,223.831853386522
Africa Western and Central,2017,172.544544804834
Africa Western and Central,2018,178.788550681486
Albania,2017,645.47076416
Albania,2018,697.30487061
Algeria,2017,970.26824951
Algeria,2018,962.71936035
Andorra,2017,3319.4050293
Andorra,2018,3607.00097656
Angola,2017,185.65101624
Angola,2018,164.70602417
Antigua and Barbuda,2017,1274.50341797
Antigua and Barbuda,2018,1405.76794434
Arab World,2017,1095.46477198739
Arab World,2018,1059.06696072514
Argentina,2017,2184.91918945
Argentina,2018,1989.63562012
Armenia,2017,996.98303223
Armenia,2018,1036.95446777
Australia,2017,4725.44970703
Australia,2018,5004.86669922
Austria,2017,5674.06201172
Austria,2018,5879.10302734
Azerbaijan,2017,655.41607666
Azerbaijan,2018,633.56213379
"Bahamas, The",2017,2128.2644043
"Bahamas, The",2018,2005.24621582
Bahrain,2017,2263.04296875
Bahrain,2018,1955.35192871
Bangladesh,2017,97.28712463
Bangladesh,2018,109.6439209
Barbados,2017,1204.41601563
Barbados,2018,1203.78686523
Belarus,2017,1095.04614258
Belarus,2018,1132.46948242
Belgium,2017,5289.40039063
Belgium,2018,5404.91601563
Belize,2017,482.94006348
Belize,2018,506.31762695
Benin,2017,82.49481201
Benin,2018,83.21243286
Bhutan,2017,314.59326172
Bhutan,2018,322.09790039
Bolivia,2017,485.4720459
Bolivia,2018,496.09091187
Bosnia and Herzegovina,2017,1226.75231934
Bosnia and Herzegovina,2018,1300.77648926
Botswana,2017,1091.04699707
Botswana,2018,1088.72900391
Brazil,2017,1482.5333252
Brazil,2018,1530.82226563
Brunei Darussalam,2017,1811.43640137
Brunei Darussalam,2018,1952.52880859
Bulgaria,2017,1575.11022949
Bulgaria,2018,1633.80444336
Burkina Faso,2017,129.01049805
Burkina Faso,2018,111.71577454
Burundi,2017,59.39506149
Burundi,2018,65.79267883
Cabo Verde,2017,375.52709961
Cabo Verde,2018,399.53582764
Cambodia,2017,238.10375977
Cambodia,2018,261.15719604
Cameroon,2017,127.29545593
Cameroon,2018,133.60945129
Canada,2017,5023.35107422
Canada,2018,5199.97314453
Caribbean small states,2017,1006.57579886597
Caribbean small states,2018,1014.69874436917
Central African Republic,2017,54.73753357
Central African Republic,2018,97.0058136
Central Europe and the Baltics,2017,1936.82872747859
Central Europe and the Baltics,2018,2059.08574115019
Chad,2017,85.68202972
Chad,2018,79.01350403
Chile,2017,2193.38256836
Chile,2018,2305.67651367
China,2017,837.77270508
China,2018,935.19287109
Colombia,2017,1114.09619141
Colombia,2018,1155.4074707
Comoros,2017,131.12634277
Comoros,2018,134.20884705
"Congo, Dem. Rep.",2017,36.94486618
"Congo, Dem. Rep.",2018,30.71561813
"Congo, Rep.",2017,169.05439758
"Congo, Rep.",2018,125.36307526
Costa Rica,2017,1244.15026855
Costa Rica,2018,1336.52856445
Cote d'Ivoire,2017,174.63523865
Cote d'Ivoire,2018,176.27853394
Croatia,2017,1773.44177246
Croatia,2018,1876.10449219
Cuba,2017,2517.68164063
Cuba,2018,2519.29418945
Cyprus,2017,2498.46508789
Cyprus,2018,2624.85083008

2025-02-11 01:58:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:37 - root - INFO - SQL:
SELECT "country", "year_2017", "year_2018"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
   LIMIT 100;
Results:
country,year_2017,year_2018
Sint Maarten (Dutch part),40574,40654
West Bank and Gaza,4454805,4569087
Serbia,7020858,6982084
Cambodia,16009414,16249798
United Arab Emirates,9487203,9630959
Cyprus,1179680,1189265
Lower middle income,2981420591,3022905169
Maldives,496402,515696
Low income,687449530,705417321
Peru,31444297,31989256
Early-demographic dividend,3207188541,3249140605
Fiji,877459,883483
Chad,15016773,15477751
Middle East & North Africa (excluding high income),376546755,382896715
Middle East & North Africa (IDA & IBRD countries),372091950,378327628
World,7510990456,7594270356
Saudi Arabia,33099147,33699947
Dominican Republic,10513131,10627165
Kenya,50221473,51393010
"Venezuela, RB",29390409,28870195
Canada,36540268,37058856
Guinea,12067539,12414318
Pakistan,207896686,212215030
Latvia,1942248,1926542
Denmark,5764980,5797446
"Hong Kong SAR, China",7391700,7451000
Nauru,12876,12704
Qatar,2724724,2781677
United States,325147121,327167434
Europe & Central Asia (IDA & IBRD countries),457810292,459865205
Brazil,207833831,209469333
Nigeria,190873311,195874740
"Yemen, Rep.",27834821,28498687
North Macedonia,2081996,2082958
Namibia,2402603,2448255
Rwanda,11980937,12301939
Least developed countries: UN classification,986365080,1009662578
Central Europe and the Baltics,102738854,102511922
Cabo Verde,537497,543767
Brunei Darussalam,424473,428962
Philippines,105173264,106651922
Palau,17808,17907
Sri Lanka,21444000,21670000
Sao Tome and Principe,207089,211028
Haiti,10982366,11123176
Pacific island small states,2422086,2457367
China,1386395000,1392730000
Germany,82657002,82927922
St. Martin (French part),36560,37264
Faroe Islands,48331,48497
Norway,5276968,5314336
Small states,39885876,40575321
Ireland,4807388,4853506
Tanzania,54663906,56318348
Bhutan,745568,754394
Kosovo,1830700,1845300
Zambia,16853688,17351822
Europe & Central Asia (excluding high income),415710935,417797257
Isle of Man,83598,84077
Guatemala,16914936,17247807
Oman,4665935,4829483
Tunisia,11433443,11565204
Singapore,5612253,5638676
South Africa,57000451,57779622
Finland,5508214,5518050
Montenegro,622373,622345
Pre-demographic dividend,894512725,919485393
Bosnia and Herzegovina,3351527,3323929
Sierra Leone,7488431,7650154
Barbados,286233,286641
Middle East & North Africa,441255234,448912859
East Asia & Pacific (IDA & IBRD countries),2042687863,2056064424
Marshall Islands,58058,58413
San Marino,33671,33785
Syrian Arab Republic,17068002,16906283
Nicaragua,6384855,6465513
Poland,37974826,37978548
Fragile and conflict affected situations,504119229,515215936
Grenada,110874,111454
Slovenia,2066388,2067372
St. Vincent and the Grenadines,109827,110210
Mexico,124777324,126190788
Morocco,35581294,36029138
Angola,29816748,30809762
Samoa,195352,196130
Cameroon,24566045,25216237
Thailand,69209858,69428524
Vietnam,94596642,95540395
Solomon Islands,636038,652858
Japan,126785797,126529100
Niger,21602472,22442948
Senegal,15419381,15854360
Costa Rica,4949954,4999441
Albania,2873457,2866376
St. Lucia,180955,181889
Andorra,77001,77006
South Asia (IDA & IBRD),1792835608,1814388744
South Asia,1792835608,1814388744
South Sudan,10910759,10975920
Azerbaijan,9854033,9942334

2025-02-11 01:58:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:38 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:38 - root - INFO - SQL:
SELECT "country", "country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
   LIMIT 100;
Results:
country,country_code,population_growth_pct
Sint Maarten (Dutch part),SXM,0.197200
West Bank and Gaza,PSE,2.565400
Serbia,SRB,-0.552300
Cambodia,KHM,1.501500
United Arab Emirates,ARE,1.515300
Cyprus,CYP,0.812500
Lower middle income,LMC,1.391400
Maldives,MDV,3.886800
Low income,LIC,2.613700
Peru,PER,1.733100
Early-demographic dividend,EAR,1.308100
Fiji,FJI,0.686500
Chad,TCD,3.069800
Middle East & North Africa (excluding high income),MNA,1.686400
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800
World,WLD,1.108800
Saudi Arabia,SAU,1.815200
Dominican Republic,DOM,1.084700
Kenya,KEN,2.332700
"Venezuela, RB",VEN,-1.770000
Canada,CAN,1.419200
Guinea,GIN,2.873700
Pakistan,PAK,2.077200
Latvia,LVA,-0.808700
Denmark,DNK,0.563200
"Hong Kong SAR, China",HKG,0.802300
Nauru,NRU,-1.335800
Qatar,QAT,2.090200
United States,USA,0.621400
Europe & Central Asia (IDA & IBRD countries),TEC,0.448900
Brazil,BRA,0.786900
Nigeria,NGA,2.620300
"Yemen, Rep.",YEM,2.385000
North Macedonia,MKD,0.046200
Namibia,NAM,1.900100
Rwanda,RWA,2.679300
Least developed countries: UN classification,LDC,2.362000
Central Europe and the Baltics,CEB,-0.220900
Cabo Verde,CPV,1.166500
Brunei Darussalam,BRN,1.057500
Philippines,PHL,1.405900
Palau,PLW,0.555900
Sri Lanka,LKA,1.053900
Sao Tome and Principe,STP,1.902100
Haiti,HTI,1.282100
Pacific island small states,PSS,1.456600
China,CHN,0.456900
Germany,DEU,0.327800
St. Martin (French part),MAF,1.925600
Faroe Islands,FRO,0.343500
Norway,NOR,0.708100
Small states,SST,1.728500
Ireland,IRL,0.959300
Tanzania,TZA,3.026600
Bhutan,BTN,1.183800
Kosovo,XKX,0.797500
Zambia,ZMB,2.955600
Europe & Central Asia (excluding high income),ECA,0.501900
Isle of Man,IMN,0.573000
Guatemala,GTM,1.967900
Oman,OMN,3.505100
Tunisia,TUN,1.152400
Singapore,SGP,0.470800
South Africa,ZAF,1.367000
Finland,FIN,0.178600
Montenegro,MNE,-0.004500
Pre-demographic dividend,PRE,2.791800
Bosnia and Herzegovina,BIH,-0.823400
Sierra Leone,SLE,2.159600
Barbados,BRB,0.142500
Middle East & North Africa,MEA,1.735400
East Asia & Pacific (IDA & IBRD countries),TEA,0.654900
Marshall Islands,MHL,0.611500
San Marino,SMR,0.338600
Syrian Arab Republic,SYR,-0.947500
Nicaragua,NIC,1.263300
Poland,POL,0.009800
Fragile and conflict affected situations,FCS,2.201200
Grenada,GRD,0.523100
Slovenia,SVN,0.047600
St. Vincent and the Grenadines,VCT,0.348700
Mexico,MEX,1.132800
Morocco,MAR,1.258700
Angola,AGO,3.330400
Samoa,WSM,0.398300
Cameroon,CMR,2.646700
Thailand,THA,0.315900
Vietnam,VNM,0.997700
Solomon Islands,SLB,2.644500
Japan,JPN,-0.202500
Niger,NER,3.890600
Senegal,SEN,2.821000
Costa Rica,CRI,0.999700
Albania,ALB,-0.246400
St. Lucia,LCA,0.516200
Andorra,AND,0.006500
South Asia (IDA & IBRD),TSA,1.202200
South Asia,SAS,1.202200
South Sudan,SSD,0.597200
Azerbaijan,AZE,0.896100

2025-02-11 01:58:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:40 - root - INFO - SQL:
SELECT "country_code", "country_name",
          (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   LIMIT 100;
Results:
country_code,country_name,health_exp_growth_pct
PLW,Palau,-7.063875281157944
EMU,Euro area,2.789134976903903
GHA,Ghana,13.178566497874536
SSD,South Sudan,-23.04966196615966
SDN,Sudan,-5.999668158823738
IRN,"Iran, Islamic Rep.",-3.8462814315901754
BHS,"Bahamas, The",-5.780211717653635
DJI,Djibouti,0.3393334162335949
MUS,Mauritius,8.030903496449127
MNE,Montenegro,
POL,Poland,1.8521743750267778
LCA,St. Lucia,-4.113580351693804
ARG,Argentina,-8.937793684678915
DEU,Germany,2.826478574456307
PER,Peru,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),2.1070114806863676
BHR,Bahrain,-13.596341045612325
CPV,Cabo Verde,6.393341001204444
MEA,Middle East & North Africa,-3.0210868374484248
LBN,Lebanon,0.42266445126028984
NZL,New Zealand,5.470329002749014
THA,Thailand,5.258448761245554
MDV,Maldives,7.064431850180757
KHM,Cambodia,9.682096701147762
HRV,Croatia,5.788897122209604
CHE,Switzerland,2.343144030831746
TUR,Turkey,-0.44562152999858845
VEN,"Venezuela, RB",-51.04958125709261
CYP,Cyprus,5.058535450528741
VCT,St. Vincent and the Grenadines,8.308401617023394
LKA,Sri Lanka,3.803653566530511
CAF,Central African Republic,77.21992072577778
SLV,El Salvador,2.794703820618421
EAP,East Asia & Pacific (excluding high income),10.500331778387803
FRA,France,2.7457406703026312
LBR,Liberia,-16.78114804648813
LSO,Lesotho,8.91761594901471
ALB,Albania,8.030434425245513
BTN,Bhutan,2.3855052167898734
TZA,Tanzania,3.085166725768402
COD,"Congo, Dem. Rep.",-16.86093006711765
MEX,Mexico,-0.5630680127478949
OED,OECD members,3.506250028904982
TSA,South Asia (IDA & IBRD),8.731075175570883
TON,Tonga,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),4.951745881289868
PRT,Portugal,5.128731841342556
BEN,Benin,0.8698981578538698
EGY,"Egypt, Arab Rep.",-7.155292088012925
NER,Niger,0.4849871156818115
COG,"Congo, Rep.",-25.844534626391113
STP,Sao Tome and Principe,0.093806085588137
NAC,North America,3.9835447401525426
TMN,Middle East & North Africa (IDA & IBRD countries),-3.043545348909082
TKM,Turkmenistan,1.9833335356857433
KGZ,Kyrgyz Republic,12.389832856426533
AFW,Africa Western and Central,3.618779071638926
ARE,United Arab Emirates,4.663505847905878
ARM,Armenia,4.009239299749563
BRN,Brunei Darussalam,7.7889793488355865
ZWE,Zimbabwe,-0.4001574625740916
UKR,Ukraine,10.626947332533637
GTM,Guatemala,1.7171133842194721
FSM,"Micronesia, Fed. Sts.",-2.9422577427801175
KOR,"Korea, Rep.",9.716328957481673
CHL,Chile,5.119669816376942
MAR,Morocco,6.26154737133207
HPC,Heavily indebted poor countries (HIPC),-0.7614722546277339
LTU,Lithuania,7.943041631178868
AGO,Angola,-11.281916196420593
GUY,Guyana,9.735342397213454
WSM,Samoa,-1.8071571029766822
COM,Comoros,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),5.5186668997344475
DZA,Algeria,-0.7780208374140188
IND,India,8.56652737658095
CAN,Canada,3.516020833511536
LAC,Latin America & Caribbean (excluding high income),1.0247826301139413
CZE,Czech Republic,10.428450078440672
TGO,Togo,7.758083762284739
AFG,Afghanistan,-18.308624974303797
KAZ,Kazakhstan,-2.8467522636092117
LCN,Latin America & Caribbean,-0.21980787495585355
TEA,East Asia & Pacific (IDA & IBRD countries),10.499561632363628
QAT,Qatar,-6.649542924759741
ZMB,Zambia,15.890200401377808
SRB,Serbia,10.058843469188531
BWA,Botswana,-0.21245584894371833
GRC,Greece,2.9283178857691543
GMB,"Gambia, The",-1.8622231047614777
NGA,Nigeria,5.373821440597682
ECU,Ecuador,0.5343416812705549
KWT,Kuwait,-2.425378258239524
AUS,Australia,5.91302435775189
OMN,Oman,4.722239797281134
UMC,Upper middle income,6.920495089257177
FJI,Fiji,13.145350273636053
TUN,Tunisia,4.336137968605618
SSF,Sub-Saharan Africa,2.1070114806863676
VNM,Vietnam,8.32414383351091

2025-02-11 01:58:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:41 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:42 - root - INFO - SQL:
SELECT "country", "country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
     AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
   LIMIT 100;
Results:
country,country_code,population_growth_pct
West Bank and Gaza,PSE,2.565400
Cambodia,KHM,1.501500
United Arab Emirates,ARE,1.515300
Lower middle income,LMC,1.391400
Maldives,MDV,3.886800
Low income,LIC,2.613700
Peru,PER,1.733100
Early-demographic dividend,EAR,1.308100
Chad,TCD,3.069800
Middle East & North Africa (excluding high income),MNA,1.686400
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800
World,WLD,1.108800
Saudi Arabia,SAU,1.815200
Dominican Republic,DOM,1.084700
Kenya,KEN,2.332700
Canada,CAN,1.419200
Guinea,GIN,2.873700
Pakistan,PAK,2.077200
Qatar,QAT,2.090200
Nigeria,NGA,2.620300
"Yemen, Rep.",YEM,2.385000
Namibia,NAM,1.900100
Rwanda,RWA,2.679300
Least developed countries: UN classification,LDC,2.362000
Cabo Verde,CPV,1.166500
Brunei Darussalam,BRN,1.057500
Philippines,PHL,1.405900
Sri Lanka,LKA,1.053900
Sao Tome and Principe,STP,1.902100
Haiti,HTI,1.282100
Pacific island small states,PSS,1.456600
St. Martin (French part),MAF,1.925600
Small states,SST,1.728500
Tanzania,TZA,3.026600
Bhutan,BTN,1.183800
Zambia,ZMB,2.955600
Guatemala,GTM,1.967900
Oman,OMN,3.505100
Tunisia,TUN,1.152400
South Africa,ZAF,1.367000
Pre-demographic dividend,PRE,2.791800
Sierra Leone,SLE,2.159600
Middle East & North Africa,MEA,1.735400
Nicaragua,NIC,1.263300
Fragile and conflict affected situations,FCS,2.201200
Mexico,MEX,1.132800
Morocco,MAR,1.258700
Angola,AGO,3.330400
Cameroon,CMR,2.646700
Solomon Islands,SLB,2.644500
Niger,NER,3.890600
Senegal,SEN,2.821000
South Asia (IDA & IBRD),TSA,1.202200
South Asia,SAS,1.202200
Equatorial Guinea,GNQ,3.722100
Honduras,HND,1.681100
IDA & IBRD total,IBT,1.223100
Burkina Faso,BFA,2.908600
Channel Islands,CHI,1.087400
Burundi,BDI,3.217400
Afghanistan,AFG,2.413400
Madagascar,MDG,2.705600
Ethiopia,ETH,2.654600
Paraguay,PRY,1.296200
"Macao SAR, China",MAC,1.453800
Mongolia,MNG,1.812200
Other small states,OSS,2.023900
Luxembourg,LUX,1.910300
Mali,MLI,3.053600
Arab World,ARB,1.915900
Bahrain,BHR,5.044300
"Congo, Dem. Rep.",COD,3.279300
Colombia,COL,1.528800
Australia,AUS,1.587300
Chile,CHL,1.400700
Somalia,SOM,2.872200
Benin,BEN,2.772600
IDA total,IDA,2.264400
Tajikistan,TJK,2.483800
Tonga,TON,1.175500
Kyrgyz Republic,KGZ,1.897300
"Congo, Rep.",COG,2.615300
Middle income,MIC,1.057600
Comoros,COM,2.264400
Malta,MLT,3.318600
New Caledonia,NCL,1.323300
Low & middle income,LMY,1.227300
Indonesia,IDN,1.140200
Iraq,IRQ,2.345500
Belize,BLZ,1.943200
Timor-Leste,TLS,1.987600
Zimbabwe,ZWE,1.420800
Sudan,SDN,2.421100
Ecuador,ECU,1.781300
Djibouti,DJI,1.570100
Cayman Islands,CYM,1.249600
Turkmenistan,TKM,1.619400
Malaysia,MYS,1.361700
"Egypt, Arab Rep.",EGY,2.054100
Turks and Caicos Islands,TCA,1.481900

2025-02-11 01:58:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:43 - root - INFO - SQL:
SELECT "country_code", "country_name",
          (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
   LIMIT 100;
Results:
country_code,country_name,health_exp_growth_pct
EMU,Euro area,2.789134976903903
GHA,Ghana,13.178566497874536
MUS,Mauritius,8.030903496449127
POL,Poland,1.8521743750267778
DEU,Germany,2.826478574456307
PER,Peru,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),2.1070114806863676
CPV,Cabo Verde,6.393341001204444
NZL,New Zealand,5.470329002749014
THA,Thailand,5.258448761245554
MDV,Maldives,7.064431850180757
KHM,Cambodia,9.682096701147762
HRV,Croatia,5.788897122209604
CHE,Switzerland,2.343144030831746
CYP,Cyprus,5.058535450528741
VCT,St. Vincent and the Grenadines,8.308401617023394
LKA,Sri Lanka,3.803653566530511
CAF,Central African Republic,77.21992072577778
SLV,El Salvador,2.794703820618421
EAP,East Asia & Pacific (excluding high income),10.500331778387803
FRA,France,2.7457406703026312
LSO,Lesotho,8.91761594901471
ALB,Albania,8.030434425245513
BTN,Bhutan,2.3855052167898734
TZA,Tanzania,3.085166725768402
OED,OECD members,3.506250028904982
TSA,South Asia (IDA & IBRD),8.731075175570883
TON,Tonga,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),4.951745881289868
PRT,Portugal,5.128731841342556
NAC,North America,3.9835447401525426
TKM,Turkmenistan,1.9833335356857433
KGZ,Kyrgyz Republic,12.389832856426533
AFW,Africa Western and Central,3.618779071638926
ARE,United Arab Emirates,4.663505847905878
ARM,Armenia,4.009239299749563
BRN,Brunei Darussalam,7.7889793488355865
UKR,Ukraine,10.626947332533637
GTM,Guatemala,1.7171133842194721
KOR,"Korea, Rep.",9.716328957481673
CHL,Chile,5.119669816376942
MAR,Morocco,6.26154737133207
LTU,Lithuania,7.943041631178868
GUY,Guyana,9.735342397213454
COM,Comoros,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),5.5186668997344475
IND,India,8.56652737658095
CAN,Canada,3.516020833511536
LAC,Latin America & Caribbean (excluding high income),1.0247826301139413
CZE,Czech Republic,10.428450078440672
TGO,Togo,7.758083762284739
TEA,East Asia & Pacific (IDA & IBRD countries),10.499561632363628
ZMB,Zambia,15.890200401377808
SRB,Serbia,10.058843469188531
GRC,Greece,2.9283178857691543
NGA,Nigeria,5.373821440597682
AUS,Australia,5.91302435775189
OMN,Oman,4.722239797281134
UMC,Upper middle income,6.920495089257177
FJI,Fiji,13.145350273636053
TUN,Tunisia,4.336137968605618
SSF,Sub-Saharan Africa,2.1070114806863676
VNM,Vietnam,8.32414383351091
ESP,Spain,2.700058958823298
HND,Honduras,5.245476561131182
PST,Post-demographic dividend,3.867870173090837
BEL,Belgium,2.1839077488751304
COL,Colombia,3.708053183245905
NLD,Netherlands,2.466818982241543
ECS,Europe & Central Asia,3.35960082147429
MRT,Mauritania,4.900233038497389
TLS,Timor-Leste,9.620727328816782
MNG,Mongolia,1.3580223967446232
PHL,Philippines,6.225895901836266
IDN,Indonesia,6.520882793655053
MIC,Middle income,6.101815985663521
ATG,Antigua and Barbuda,10.299268289062342
ROU,Romania,15.24165413416109
PAK,Pakistan,17.164876726309394
HIC,High income,3.534800089198823
PRY,Paraguay,8.354755847720794
SVN,Slovenia,6.680814639667525
SAS,South Asia,8.731075175570883
ISR,Israel,3.8699594203796184
FIN,Finland,2.7020203469470228
HUN,Hungary,5.561813157697172
AUT,Austria,3.613654824294838
RUS,Russian Federation,7.1229421476828465
ERI,Eritrea,23.472064126363087
BGR,Bulgaria,3.726355957259228
MKD,North Macedonia,6.123092927453969
LMC,Lower middle income,4.859841588386322
ITA,Italy,1.4552065516257022
DMA,Dominica,21.686427226054047
EAR,Early-demographic dividend,1.155713263926843
GBR,United Kingdom,3.2750742533610016
GNB,Guinea-Bissau,3.703319526850014
ETH,Ethiopia,1.699153922164326
MHL,Marshall Islands,11.769399246987488
PSS,Pacific island small states,6.218577578310462

2025-02-11 01:58:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:44 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:45 - root - INFO - SQL:
SELECT p."country", p."country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct",
          h."health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
   JOIN (
       SELECT "country_code",
              (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
               MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
               MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
       FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
       WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
         AND "year" IN (2017, 2018)
       GROUP BY "country_code"
   ) h ON p."country_code" = h."country_code"
   WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
   LIMIT 100;
Results:
country,country_code,population_growth_pct,health_exp_growth_pct
Serbia,SRB,-0.552300,10.058843469188531
Cambodia,KHM,1.501500,9.682096701147762
United Arab Emirates,ARE,1.515300,4.663505847905878
Cyprus,CYP,0.812500,5.058535450528741
Lower middle income,LMC,1.391400,4.859841588386322
Maldives,MDV,3.886800,7.064431850180757
Low income,LIC,2.613700,-4.2655355575512415
Peru,PER,1.733100,9.807977642581225
Early-demographic dividend,EAR,1.308100,1.155713263926843
Fiji,FJI,0.686500,13.145350273636053
Chad,TCD,3.069800,-7.782875489518702
Middle East & North Africa (excluding high income),MNA,1.686400,-3.043545348909082
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800,-3.043545348909082
World,WLD,1.108800,3.803807230162976
Saudi Arabia,SAU,1.815200,-6.392527005315368
Dominican Republic,DOM,1.084700,6.597805657430963
Kenya,KEN,2.332700,13.694728244781942
"Venezuela, RB",VEN,-1.770000,-51.04958125709261
Canada,CAN,1.419200,3.516020833511536
Guinea,GIN,2.873700,8.043626497028214
Pakistan,PAK,2.077200,17.164876726309394
Latvia,LVA,-0.808700,11.227458011940097
Denmark,DNK,0.563200,3.6649324886397423
Nauru,NRU,-1.335800,-17.914344696955613
Qatar,QAT,2.090200,-6.649542924759741
United States,USA,0.621400,4.057137380431737
Europe & Central Asia (IDA & IBRD countries),TEC,0.448900,4.951745881289868
Brazil,BRA,0.786900,3.2571908913740963
Nigeria,NGA,2.620300,5.373821440597682
North Macedonia,MKD,0.046200,6.123092927453969
Namibia,NAM,1.900100,-4.1059460982336
Rwanda,RWA,2.679300,17.930277482427908
Least developed countries: UN classification,LDC,2.362000,0.5079618084527765
Central Europe and the Baltics,CEB,-0.220900,6.312226369688209
Cabo Verde,CPV,1.166500,6.393341001204444
Brunei Darussalam,BRN,1.057500,7.7889793488355865
Philippines,PHL,1.405900,6.225895901836266
Palau,PLW,0.555900,-7.063875281157944
Sri Lanka,LKA,1.053900,3.803653566530511
Sao Tome and Principe,STP,1.902100,0.093806085588137
Haiti,HTI,1.282100,-2.2981816246458204
Pacific island small states,PSS,1.456600,6.218577578310462
China,CHN,0.456900,11.628472188133323
Germany,DEU,0.327800,2.826478574456307
Norway,NOR,0.708100,4.641469635457937
Small states,SST,1.728500,0.3733356148596855
Ireland,IRL,0.959300,4.982530621027306
Tanzania,TZA,3.026600,3.085166725768402
Bhutan,BTN,1.183800,2.3855052167898734
Zambia,ZMB,2.955600,15.890200401377808
Europe & Central Asia (excluding high income),ECA,0.501900,5.5186668997344475
Guatemala,GTM,1.967900,1.7171133842194721
Oman,OMN,3.505100,4.722239797281134
Tunisia,TUN,1.152400,4.336137968605618
Singapore,SGP,0.470800,5.850614474042322
South Africa,ZAF,1.367000,3.6050576582534437
Finland,FIN,0.178600,2.7020203469470228
Montenegro,MNE,-0.004500,
Pre-demographic dividend,PRE,2.791800,0.027640701520033784
Bosnia and Herzegovina,BIH,-0.823400,6.034157731189415
Sierra Leone,SLE,2.159600,0.7938218928838047
Barbados,BRB,0.142500,-0.052236967280010066
Middle East & North Africa,MEA,1.735400,-3.0210868374484248
East Asia & Pacific (IDA & IBRD countries),TEA,0.654900,10.499561632363628
Marshall Islands,MHL,0.611500,11.769399246987488
San Marino,SMR,0.338600,1.8130555762403138
Nicaragua,NIC,1.263300,0.19474313578897326
Poland,POL,0.009800,1.8521743750267778
Fragile and conflict affected situations,FCS,2.201200,-7.431140913015866
Grenada,GRD,0.523100,3.0928087481277493
Slovenia,SVN,0.047600,6.680814639667525
St. Vincent and the Grenadines,VCT,0.348700,8.308401617023394
Mexico,MEX,1.132800,-0.5630680127478949
Morocco,MAR,1.258700,6.26154737133207
Angola,AGO,3.330400,-11.281916196420593
Samoa,WSM,0.398300,-1.8071571029766822
Cameroon,CMR,2.646700,4.960110566297106
Thailand,THA,0.315900,5.258448761245554
Vietnam,VNM,0.997700,8.32414383351091
Solomon Islands,SLB,2.644500,-2.6989051392649808
Japan,JPN,-0.202500,2.672329510093784
Niger,NER,3.890600,0.4849871156818115
Senegal,SEN,2.821000,2.147548484177809
Costa Rica,CRI,0.999700,7.425011128893834
Albania,ALB,-0.246400,8.030434425245513
St. Lucia,LCA,0.516200,-4.113580351693804
Andorra,AND,0.006500,8.664081204957636
South Asia (IDA & IBRD),TSA,1.202200,8.731075175570883
South Asia,SAS,1.202200,8.731075175570883
South Sudan,SSD,0.597200,-23.04966196615966
Azerbaijan,AZE,0.896100,-3.334361735734003
East Asia & Pacific (excluding high income),EAP,0.652600,10.500331778387803
Equatorial Guinea,GNQ,3.722100,-5.674867237231175
Honduras,HND,1.681100,5.245476561131182
IDA & IBRD total,IBT,1.223100,5.365268511981853
Burkina Faso,BFA,2.908600,-13.405671454192172
Jamaica,JAM,0.479400,1.265969012259397
Dominica,DMA,0.233700,21.686427226054047
Trinidad and Tobago,TTO,0.418000,-3.9807692412533333
Burundi,BDI,3.217400,10.771295086675051

2025-02-11 01:58:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 76
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:46 - root - INFO - SQL:
SELECT p."country", p."country_code",
           ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct",
           h."health_exp_growth_pct"
    FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
    JOIN (
        SELECT "country_code",
               (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
        FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
        WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND "year" IN (2017, 2018)
        GROUP BY "country_code"
        HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
    ) h ON p."country_code" = h."country_code"
    WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
      AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
    LIMIT 100;
Results:
country,country_code,population_growth_pct,health_exp_growth_pct
Cambodia,KHM,1.501500,9.682096701147762
United Arab Emirates,ARE,1.515300,4.663505847905878
Lower middle income,LMC,1.391400,4.859841588386322
Maldives,MDV,3.886800,7.064431850180757
Peru,PER,1.733100,9.807977642581225
Early-demographic dividend,EAR,1.308100,1.155713263926843
World,WLD,1.108800,3.803807230162976
Dominican Republic,DOM,1.084700,6.597805657430963
Kenya,KEN,2.332700,13.694728244781942
Canada,CAN,1.419200,3.516020833511536
Guinea,GIN,2.873700,8.043626497028214
Pakistan,PAK,2.077200,17.164876726309394
Nigeria,NGA,2.620300,5.373821440597682
Rwanda,RWA,2.679300,17.930277482427908
Cabo Verde,CPV,1.166500,6.393341001204444
Brunei Darussalam,BRN,1.057500,7.7889793488355865
Philippines,PHL,1.405900,6.225895901836266
Sri Lanka,LKA,1.053900,3.803653566530511
Pacific island small states,PSS,1.456600,6.218577578310462
Tanzania,TZA,3.026600,3.085166725768402
Bhutan,BTN,1.183800,2.3855052167898734
Zambia,ZMB,2.955600,15.890200401377808
Guatemala,GTM,1.967900,1.7171133842194721
Oman,OMN,3.505100,4.722239797281134
Tunisia,TUN,1.152400,4.336137968605618
South Africa,ZAF,1.367000,3.6050576582534437
Morocco,MAR,1.258700,6.26154737133207
Cameroon,CMR,2.646700,4.960110566297106
Senegal,SEN,2.821000,2.147548484177809
South Asia (IDA & IBRD),TSA,1.202200,8.731075175570883
South Asia,SAS,1.202200,8.731075175570883
Honduras,HND,1.681100,5.245476561131182
IDA & IBRD total,IBT,1.223100,5.365268511981853
Burundi,BDI,3.217400,10.771295086675051
Ethiopia,ETH,2.654600,1.699153922164326
Paraguay,PRY,1.296200,8.354755847720794
Mongolia,MNG,1.812200,1.3580223967446232
Luxembourg,LUX,1.910300,3.0231099439542266
Colombia,COL,1.528800,3.708053183245905
Australia,AUS,1.587300,5.91302435775189
Chile,CHL,1.400700,5.119669816376942
Tajikistan,TJK,2.483800,7.592042008450771
Tonga,TON,1.175500,2.056613223119864
Kyrgyz Republic,KGZ,1.897300,12.389832856426533
Middle income,MIC,1.057600,6.101815985663521
Comoros,COM,2.264400,2.3507894865998136
Low & middle income,LMY,1.227300,5.795254888549524
Indonesia,IDN,1.140200,6.520882793655053
Belize,BLZ,1.943200,4.840675942588913
Timor-Leste,TLS,1.987600,9.620727328816782
Turkmenistan,TKM,1.619400,1.9833335356857433
Malaysia,MYS,1.361700,7.102137892383236
Bangladesh,BGD,1.055600,12.70136856957698
Panama,PAN,1.707000,9.969733409110255
Sub-Saharan Africa,SSF,2.680800,2.1070114806863676
Sub-Saharan Africa (IDA & IBRD countries),TSS,2.680800,2.1070114806863676
Guinea-Bissau,GNB,2.525100,3.703319526850014
Vanuatu,VUT,2.511300,26.011962324854128
Tuvalu,TUV,1.213700,9.50118379426193
Mauritania,MRT,2.819400,4.900233038497389
Iceland,ISL,2.962700,7.879920585001142
New Zealand,NZL,1.910800,5.470329002749014
Nepal,NPL,1.667700,14.358253733618366
Uzbekistan,UZB,1.750000,10.451726930247599
Ghana,GHA,2.217000,13.178566497874536
India,IND,1.042700,8.56652737658095
Togo,TGO,2.476100,7.758083762284739
Sub-Saharan Africa (excluding high income),SSA,2.681000,2.1044911629600467
Israel,ISR,1.956800,3.8699594203796184
Central African Republic,CAF,1.530600,77.21992072577778
Mozambique,MOZ,2.956300,6.585758068790505
Sweden,SWE,1.247600,3.422344754901739
Kiribati,KIR,1.479500,15.79883792954302
Papua New Guinea,PNG,1.994400,4.339125399358243
Uganda,UGA,3.791500,5.32756876200654
Bolivia,BOL,1.432100,2.1873279954387588

2025-02-11 01:58:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 01:58:47 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:47 - root - INFO - SQL:
SELECT COUNT(*) AS "Number_of_Countries"
    FROM (
        SELECT p."country_code"
        FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
        JOIN (
            SELECT "country_code",
                   (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                    MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                    MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
            FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
            WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
              AND "year" IN (2017, 2018)
            GROUP BY "country_code"
            HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                    MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                    MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
        ) h ON p."country_code" = h."country_code"
        WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
          AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
    ) AS sub;
Results:
Number_of_Countries
76

2025-02-11 01:58:47 - root - INFO - itercount: 0
2025-02-11 01:58:47 - root - INFO - Database Name: WORLD_BANK
Schema Name: WORLD_BANK_GLOBAL_POPULATION
,0
table_name,POPULATION_BY_COUNTRY
description,
DDL,"create or replace TABLE POPULATION_BY_COUNTRY (
	""country"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""year_1960"" NUMBER(38,0),
	""year_1961"" NUMBER(38,0),
	""year_1962"" NUMBER(38,0),
	""year_1963"" NUMBER(38,0),
	""year_1964"" NUMBER(38,0),
	""year_1965"" NUMBER(38,0),
	""year_1966"" NUMBER(38,0),
	""year_1967"" NUMBER(38,0),
	""year_1968"" NUMBER(38,0),
	""year_1969"" NUMBER(38,0),
	""year_1970"" NUMBER(38,0),
	""year_1971"" NUMBER(38,0),
	""year_1972"" NUMBER(38,0),
	""year_1973"" NUMBER(38,0),
	""year_1974"" NUMBER(38,0),
	""year_1975"" NUMBER(38,0),
	""year_1976"" NUMBER(38,0),
	""year_1977"" NUMBER(38,0),
	""year_1978"" NUMBER(38,0),
	""year_1979"" NUMBER(38,0),
	""year_1980"" NUMBER(38,0),
	""year_1981"" NUMBER(38,0),
	""year_1982"" NUMBER(38,0),
	""year_1983"" NUMBER(38,0),
	""year_1984"" NUMBER(38,0),
	""year_1985"" NUMBER(38,0),
	""year_1986"" NUMBER(38,0),
	""year_1987"" NUMBER(38,0),
	""year_1988"" NUMBER(38,0),
	""year_1989"" NUMBER(38,0),
	""year_1990"" NUMBER(38,0),
	""year_1991"" NUMBER(38,0),
	""year_1992"" NUMBER(38,0),
	""year_1993"" NUMBER(38,0),
	""year_1994"" NUMBER(38,0),
	""year_1995"" NUMBER(38,0),
	""year_1996"" NUMBER(38,0),
	""year_1997"" NUMBER(38,0),
	""year_1998"" NUMBER(38,0),
	""year_1999"" NUMBER(38,0),
	""year_2000"" NUMBER(38,0),
	""year_2001"" NUMBER(38,0),
	""year_2002"" NUMBER(38,0),
	""year_2003"" NUMBER(38,0),
	""year_2004"" NUMBER(38,0),
	""year_2005"" NUMBER(38,0),
	""year_2006"" NUMBER(38,0),
	""year_2007"" NUMBER(38,0),
	""year_2008"" NUMBER(38,0),
	""year_2009"" NUMBER(38,0),
	""year_2010"" NUMBER(38,0),
	""year_2011"" NUMBER(38,0),
	""year_2012"" NUMBER(38,0),
	""year_2013"" NUMBER(38,0),
	""year_2014"" NUMBER(38,0),
	""year_2015"" NUMBER(38,0),
	""year_2016"" NUMBER(38,0),
	""year_2017"" NUMBER(38,0),
	""year_2018"" NUMBER(38,0),
	""year_2019"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,0
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,1
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,2
table_name,HEALTH_NUTRITION_POPULATION
description,
DDL,"create or replace TABLE HEALTH_NUTRITION_POPULATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" NUMBER(38,0),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_Income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,1
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,2
table_name,INTERNATIONAL_DEBT
description,
DDL,"create or replace TABLE INTERNATIONAL_DEBT (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_two_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,1
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,2
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,3
table_name,INTERNATIONAL_EDUCATION
description,
DDL,"create or replace TABLE INTERNATIONAL_EDUCATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" VARCHAR(16777216),
	""latest_trade_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,1
table_name,SERIES_TIME
description,
DDL,"create or replace TABLE SERIES_TIME (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,2
table_name,INDICATORS_DATA
description,
DDL,"create or replace TABLE INDICATORS_DATA (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,3
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,4
table_name,FOOTNOTES
description,
DDL,"create or replace TABLE FOOTNOTES (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,5
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SUMMARY', 'SERIES_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_EDUCATION'], 'WORLD_BANK_WDI': ['COUNTRY_SUMMARY', 'SERIES_TIME', 'INDICATORS_DATA', 'COUNTRY_SERIES_DEFINITIONS', 'FOOTNOTES', 'SERIES_SUMMARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY`
   - **"country"**: To identify the country.
   - **"country_code"**: To join with other tables.
   - **"year_2017"**: Population in 2017, used to calculate growth.
   - **"year_2018"**: Population in 2018, used to calculate growth.

2. **Table:** `WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION`
   - **"country_name"**: To identify the country.
   - **"country_code"**: To join with other tables.
   - **"indicator_name"**: To filter for per capita current health expenditure (PPP).
   - **"indicator_code"**: To filter for the specific indicator.
   - **"value"**: The value of the health expenditure.
   - **"year"**: The year of the data (2017 or 2018).

**Conditions that may be used:**

- Filter records where **"indicator_name"** is related to per capita current health expenditure (PPP).
- Filter for **"year"** equal to 2017 and 2018.
- Calculate the percentage increase from 2017 to 2018 for both population and health expenditure.
- Identify countries where both increases are more than 1%.

---

**SQL Queries:**

1. **Retrieve distinct indicator names related to health expenditure:**
   ```sql
   SELECT DISTINCT "indicator_name"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" ILIKE '%health expenditure%'
   LIMIT 100;
   ```

2. **List sample records for the indicator "Current health expenditure per capita, PPP (current international $)":**
   ```sql
   SELECT *
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
   LIMIT 100;
   ```

3. **Retrieve health expenditure data for 2017 and 2018:**
   ```sql
   SELECT "country_name", "year", "value"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   ORDER BY "country_name", "year"
   LIMIT 100;
   ```

4. **Retrieve population data for countries in 2017 and 2018:**
   ```sql
   SELECT "country", "year_2017", "year_2018"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
   LIMIT 100;
   ```

5. **Calculate population growth percentage from 2017 to 2018:**
   ```sql
   SELECT "country", "country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
   LIMIT 100;
   ```

6. **Calculate health expenditure growth percentage per country:**
   ```sql
   SELECT "country_code", "country_name",
          (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   LIMIT 100;
   ```

7. **Identify countries with more than 1% population growth:**
   ```sql
   SELECT "country", "country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
     AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
   LIMIT 100;
   ```

8. **Identify countries with more than 1% health expenditure growth:**
   ```sql
   SELECT "country_code", "country_name",
          (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
   LIMIT 100;
   ```

9. **Join population and health expenditure growth data:**
   ```sql
   SELECT p."country", p."country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct",
          h."health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
   JOIN (
       SELECT "country_code",
              (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
               MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
               MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
       FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
       WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
         AND "year" IN (2017, 2018)
       GROUP BY "country_code"
   ) h ON p."country_code" = h."country_code"
   WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
   LIMIT 100;
   ```

10. **List countries with over 1% growth in both population and health expenditure:**
    ```sql
    SELECT p."country", p."country_code",
           ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct",
           h."health_exp_growth_pct"
    FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
    JOIN (
        SELECT "country_code",
               (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
        FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
        WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND "year" IN (2017, 2018)
        GROUP BY "country_code"
        HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
    ) h ON p."country_code" = h."country_code"
    WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
      AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
    LIMIT 100;
    ```

11. **Count the total number of countries meeting both criteria:**
    ```sql
    SELECT COUNT(*) AS "Number_of_Countries"
    FROM (
        SELECT p."country_code"
        FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
        JOIN (
            SELECT "country_code",
                   (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                    MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                    MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
            FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
            WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
              AND "year" IN (2017, 2018)
            GROUP BY "country_code"
            HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                    MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                    MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
        ) h ON p."country_code" = h."country_code"
        WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
          AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
    ) AS sub;
    ```

These queries help in understanding the data available in the relevant tables and columns, and they progressively build towards identifying the number of countries that meet the specified criteria.Query:
SELECT DISTINCT "indicator_name"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" ILIKE '%health expenditure%'
   LIMIT 100;
Answer:
indicator_name
Current health expenditure per capita (current US$)
Domestic general government health expenditure per capita (current US$)
Domestic private health expenditure (% of current health expenditure)
External health expenditure per capita (current US$)
"External health expenditure per capita, PPP (current international $)"
Out-of-pocket expenditure (% of current health expenditure)
External health expenditure channeled through government (% of external health expenditure)
Domestic general government health expenditure (% of current health expenditure)
Domestic private health expenditure per capita (current US$)
Domestic general government health expenditure (% of GDP)
"Current health expenditure per capita, PPP (current international $)"
External health expenditure (% of current health expenditure)
"Domestic private health expenditure per capita, PPP  (current international $)"
"Domestic general government health expenditure per capita, PPP (current international $)"
Capital health expenditure (% of GDP)
Domestic general government health expenditure (% of general government expenditure)
Current health expenditure (% of GDP)
Query:
SELECT *
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
   LIMIT 100;
Answer:
Too long, hard cut:
country_name,country_code,indicator_name,indicator_code,value,year
Brazil,BRA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,833.33392334,2002
Brazil,BRA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,1411.1307373,2016
Cambodia,KHM,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,155.51541138,2008
Uganda,UGA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,135.98130798,2005
United Kingdom,GBR,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,3035.11376953,2006
United Kingdom,GBR,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,3171.75708008,2007
United States,USA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,7410.70068359,2008
Uruguay,URY,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,1553.78601074,2011
Vanuatu,VUT,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,76.88131714,2005
Vanuatu,VUT,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,86.51495361,2008
Zambia,ZMB,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,176.64027405,2013
"Congo, Dem. Rep.",COD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,24.87830925,2007
"Congo, Dem. Rep.",COD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,33.00378799,2014
Croatia,HRV,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,1644.48266602,2012
Cyprus,CYP,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2091.35473633,2012
Czech Republic,CZE,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2441.99023438,2015
Djibouti,DJI,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,103.31958008,2003
Moldova,MDA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,287.74880981,2004
Nauru,NRU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,585.75341797,2009
Nicaragua,NIC,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,310.15368652,2011
Nicaragua,NIC,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,434.65509033,2016
Nigeria,NGA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,194.91674805,2013
North Macedonia,MKD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,543.46282959,2000
North Macedonia,MKD,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,585.79418945,2003
Norway,NOR,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,3562.25268555,2003
Oman,OMN,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,986.08129883,2007
Palau,PLW,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2011.51733398,2018
East Asia & Pacific,EAS,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,395.338759235213,2005
Euro area,EMU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2661.74417066721,2004
Euro area,EMU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,4572.35296577739,2017
Europe & Central Asia (IDA & IBRD countries),TEC,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,705.048253253517,2007
European Union,EUU,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,2173.88984429349,2003
Fragile and conflict affected situations,FCS,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,196.255117181505,2013
Late-demographic dividend,LTE,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,432.388249077357,2007
Late-demographic dividend,LTE,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,905.935923764474,2016
Fiji,FJI,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,286.46136475,2013
Ghana,GHA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,148.41990662,2017
Ghana,GHA,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,167.97952271,2018
Guatemala,GTM,"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD,422.92913818,2012
Guatemala,GTM,"Current health expenditure per capita, PPP (current intern
Query:
SELECT "country_name", "year", "value"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   ORDER BY "country_name", "year"
   LIMIT 100;
Answer:
country_name,year,value
Afghanistan,2017,228.18478394
Afghanistan,2018,186.4072876
Africa Eastern and Southern,2017,220.974858439749
Africa Eastern and Southern,2018,223.831853386522
Africa Western and Central,2017,172.544544804834
Africa Western and Central,2018,178.788550681486
Albania,2017,645.47076416
Albania,2018,697.30487061
Algeria,2017,970.26824951
Algeria,2018,962.71936035
Andorra,2017,3319.4050293
Andorra,2018,3607.00097656
Angola,2017,185.65101624
Angola,2018,164.70602417
Antigua and Barbuda,2017,1274.50341797
Antigua and Barbuda,2018,1405.76794434
Arab World,2017,1095.46477198739
Arab World,2018,1059.06696072514
Argentina,2017,2184.91918945
Argentina,2018,1989.63562012
Armenia,2017,996.98303223
Armenia,2018,1036.95446777
Australia,2017,4725.44970703
Australia,2018,5004.86669922
Austria,2017,5674.06201172
Austria,2018,5879.10302734
Azerbaijan,2017,655.41607666
Azerbaijan,2018,633.56213379
"Bahamas, The",2017,2128.2644043
"Bahamas, The",2018,2005.24621582
Bahrain,2017,2263.04296875
Bahrain,2018,1955.35192871
Bangladesh,2017,97.28712463
Bangladesh,2018,109.6439209
Barbados,2017,1204.41601563
Barbados,2018,1203.78686523
Belarus,2017,1095.04614258
Belarus,2018,1132.46948242
Belgium,2017,5289.40039063
Belgium,2018,5404.91601563
Belize,2017,482.94006348
Belize,2018,506.31762695
Benin,2017,82.49481201
Benin,2018,83.21243286
Bhutan,2017,314.59326172
Bhutan,2018,322.09790039
Bolivia,2017,485.4720459
Bolivia,2018,496.09091187
Bosnia and Herzegovina,2017,1226.75231934
Bosnia and Herzegovina,2018,1300.77648926
Botswana,2017,1091.04699707
Botswana,2018,1088.72900391
Brazil,2017,1482.5333252
Brazil,2018,1530.82226563
Brunei Darussalam,2017,1811.43640137
Brunei Darussalam,2018,1952.52880859
Bulgaria,2017,1575.11022949
Bulgaria,2018,1633.80444336
Burkina Faso,2017,129.01049805
Burkina Faso,2018,111.71577454
Burundi,2017,59.39506149
Burundi,2018,65.79267883
Cabo Verde,2017,375.52709961
Cabo Verde,2018,399.53582764
Cambodia,2017,238.10375977
Cambodia,2018,261.15719604
Cameroon,2017,127.29545593
Cameroon,2018,133.60945129
Canada,2017,5023.35107422
Canada,2018,5199.97314453
Caribbean small states,2017,1006.57579886597
Caribbean small states,2018,1014.69874436917
Central African Republic,2017,54.73753357
Central African Republic,2018,97.0058136
Central Europe and the Baltics,2017,1936.82872747859
Central Europe and the Baltics,2018,2059.08574115019
Chad,2017,85.68202972
Chad,2018,79.01350403
Chile,2017,2193.38256836
Chile,2018,2305.67651367
China,2017,837.77270508
China,2018,935.19287109
Colombia,2017,1114.09619141
Colombia,2018,1155.4074707
Comoros,2017,131.12634277
Comoros,2018,134.20884705
"Congo, Dem. Rep.",2017,36.94486618
"Congo, Dem. Rep.",2018,30.71561813
"Congo, Rep.",2017,169.05439758
"Congo, Rep.",2018,125.36307526
Costa Rica,2017,1244.15026855
Costa Rica,2018,1336.52856445
Cote d'Ivoire,2017,174.63523865
Cote d'Ivoire,2018,176.27853394
Croatia,2017,1773.44177246
Croatia,2018,1876.10449219
Cuba,2017,2517.68164063
Cuba,2018,2519.29418945
Cyprus,2017,2498.46508789
Cyprus,2018,2624.85083008
Query:
SELECT "country", "year_2017", "year_2018"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
   LIMIT 100;
Answer:
country,year_2017,year_2018
Sint Maarten (Dutch part),40574,40654
West Bank and Gaza,4454805,4569087
Serbia,7020858,6982084
Cambodia,16009414,16249798
United Arab Emirates,9487203,9630959
Cyprus,1179680,1189265
Lower middle income,2981420591,3022905169
Maldives,496402,515696
Low income,687449530,705417321
Peru,31444297,31989256
Early-demographic dividend,3207188541,3249140605
Fiji,877459,883483
Chad,15016773,15477751
Middle East & North Africa (excluding high income),376546755,382896715
Middle East & North Africa (IDA & IBRD countries),372091950,378327628
World,7510990456,7594270356
Saudi Arabia,33099147,33699947
Dominican Republic,10513131,10627165
Kenya,50221473,51393010
"Venezuela, RB",29390409,28870195
Canada,36540268,37058856
Guinea,12067539,12414318
Pakistan,207896686,212215030
Latvia,1942248,1926542
Denmark,5764980,5797446
"Hong Kong SAR, China",7391700,7451000
Nauru,12876,12704
Qatar,2724724,2781677
United States,325147121,327167434
Europe & Central Asia (IDA & IBRD countries),457810292,459865205
Brazil,207833831,209469333
Nigeria,190873311,195874740
"Yemen, Rep.",27834821,28498687
North Macedonia,2081996,2082958
Namibia,2402603,2448255
Rwanda,11980937,12301939
Least developed countries: UN classification,986365080,1009662578
Central Europe and the Baltics,102738854,102511922
Cabo Verde,537497,543767
Brunei Darussalam,424473,428962
Philippines,105173264,106651922
Palau,17808,17907
Sri Lanka,21444000,21670000
Sao Tome and Principe,207089,211028
Haiti,10982366,11123176
Pacific island small states,2422086,2457367
China,1386395000,1392730000
Germany,82657002,82927922
St. Martin (French part),36560,37264
Faroe Islands,48331,48497
Norway,5276968,5314336
Small states,39885876,40575321
Ireland,4807388,4853506
Tanzania,54663906,56318348
Bhutan,745568,754394
Kosovo,1830700,1845300
Zambia,16853688,17351822
Europe & Central Asia (excluding high income),415710935,417797257
Isle of Man,83598,84077
Guatemala,16914936,17247807
Oman,4665935,4829483
Tunisia,11433443,11565204
Singapore,5612253,5638676
South Africa,57000451,57779622
Finland,5508214,5518050
Montenegro,622373,622345
Pre-demographic dividend,894512725,919485393
Bosnia and Herzegovina,3351527,3323929
Sierra Leone,7488431,7650154
Barbados,286233,286641
Middle East & North Africa,441255234,448912859
East Asia & Pacific (IDA & IBRD countries),2042687863,2056064424
Marshall Islands,58058,58413
San Marino,33671,33785
Syrian Arab Republic,17068002,16906283
Nicaragua,6384855,6465513
Poland,37974826,37978548
Fragile and conflict affected situations,504119229,515215936
Grenada,110874,111454
Slovenia,2066388,2067372
St. Vincent and the Grenadines,109827,110210
Mexico,124777324,126190788
Morocco,35581294,36029138
Angola,29816748,30809762
Samoa,195352,196130
Cameroon,24566045,25216237
Thailand,69209858,69428524
Vietnam,94596642,95540395
Solomon Islands,636038,652858
Japan,126785797,126529100
Niger,21602472,22442948
Senegal,15419381,15854360
Costa Rica,4949954,4999441
Albania,2873457,2866376
St. Lucia,180955,181889
Andorra,77001,77006
South Asia (IDA & IBRD),1792835608,1814388744
South Asia,1792835608,1814388744
South Sudan,10910759,10975920
Azerbaijan,9854033,9942334
Query:
SELECT "country", "country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
   LIMIT 100;
Answer:
country,country_code,population_growth_pct
Sint Maarten (Dutch part),SXM,0.197200
West Bank and Gaza,PSE,2.565400
Serbia,SRB,-0.552300
Cambodia,KHM,1.501500
United Arab Emirates,ARE,1.515300
Cyprus,CYP,0.812500
Lower middle income,LMC,1.391400
Maldives,MDV,3.886800
Low income,LIC,2.613700
Peru,PER,1.733100
Early-demographic dividend,EAR,1.308100
Fiji,FJI,0.686500
Chad,TCD,3.069800
Middle East & North Africa (excluding high income),MNA,1.686400
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800
World,WLD,1.108800
Saudi Arabia,SAU,1.815200
Dominican Republic,DOM,1.084700
Kenya,KEN,2.332700
"Venezuela, RB",VEN,-1.770000
Canada,CAN,1.419200
Guinea,GIN,2.873700
Pakistan,PAK,2.077200
Latvia,LVA,-0.808700
Denmark,DNK,0.563200
"Hong Kong SAR, China",HKG,0.802300
Nauru,NRU,-1.335800
Qatar,QAT,2.090200
United States,USA,0.621400
Europe & Central Asia (IDA & IBRD countries),TEC,0.448900
Brazil,BRA,0.786900
Nigeria,NGA,2.620300
"Yemen, Rep.",YEM,2.385000
North Macedonia,MKD,0.046200
Namibia,NAM,1.900100
Rwanda,RWA,2.679300
Least developed countries: UN classification,LDC,2.362000
Central Europe and the Baltics,CEB,-0.220900
Cabo Verde,CPV,1.166500
Brunei Darussalam,BRN,1.057500
Philippines,PHL,1.405900
Palau,PLW,0.555900
Sri Lanka,LKA,1.053900
Sao Tome and Principe,STP,1.902100
Haiti,HTI,1.282100
Pacific island small states,PSS,1.456600
China,CHN,0.456900
Germany,DEU,0.327800
St. Martin (French part),MAF,1.925600
Faroe Islands,FRO,0.343500
Norway,NOR,0.708100
Small states,SST,1.728500
Ireland,IRL,0.959300
Tanzania,TZA,3.026600
Bhutan,BTN,1.183800
Kosovo,XKX,0.797500
Zambia,ZMB,2.955600
Europe & Central Asia (excluding high income),ECA,0.501900
Isle of Man,IMN,0.573000
Guatemala,GTM,1.967900
Oman,OMN,3.505100
Tunisia,TUN,1.152400
Singapore,SGP,0.470800
South Africa,ZAF,1.367000
Finland,FIN,0.178600
Montenegro,MNE,-0.004500
Pre-demographic dividend,PRE,2.791800
Bosnia and Herzegovina,BIH,-0.823400
Sierra Leone,SLE,2.159600
Barbados,BRB,0.142500
Middle East & North Africa,MEA,1.735400
East Asia & Pacific (IDA & IBRD countries),TEA,0.654900
Marshall Islands,MHL,0.611500
San Marino,SMR,0.338600
Syrian Arab Republic,SYR,-0.947500
Nicaragua,NIC,1.263300
Poland,POL,0.009800
Fragile and conflict affected situations,FCS,2.201200
Grenada,GRD,0.523100
Slovenia,SVN,0.047600
St. Vincent and the Grenadines,VCT,0.348700
Mexico,MEX,1.132800
Morocco,MAR,1.258700
Angola,AGO,3.330400
Samoa,WSM,0.398300
Cameroon,CMR,2.646700
Thailand,THA,0.315900
Vietnam,VNM,0.997700
Solomon Islands,SLB,2.644500
Japan,JPN,-0.202500
Niger,NER,3.890600
Senegal,SEN,2.821000
Costa Rica,CRI,0.999700
Albania,ALB,-0.246400
St. Lucia,LCA,0.516200
Andorra,AND,0.006500
South Asia (IDA & IBRD),TSA,1.202200
South Asia,SAS,1.202200
South Sudan,SSD,0.597200
Azerbaijan,AZE,0.896100
Query:
SELECT "country_code", "country_name",
          (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   LIMIT 100;
Answer:
country_code,country_name,health_exp_growth_pct
PLW,Palau,-7.063875281157944
EMU,Euro area,2.789134976903903
GHA,Ghana,13.178566497874536
SSD,South Sudan,-23.04966196615966
SDN,Sudan,-5.999668158823738
IRN,"Iran, Islamic Rep.",-3.8462814315901754
BHS,"Bahamas, The",-5.780211717653635
DJI,Djibouti,0.3393334162335949
MUS,Mauritius,8.030903496449127
MNE,Montenegro,
POL,Poland,1.8521743750267778
LCA,St. Lucia,-4.113580351693804
ARG,Argentina,-8.937793684678915
DEU,Germany,2.826478574456307
PER,Peru,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),2.1070114806863676
BHR,Bahrain,-13.596341045612325
CPV,Cabo Verde,6.393341001204444
MEA,Middle East & North Africa,-3.0210868374484248
LBN,Lebanon,0.42266445126028984
NZL,New Zealand,5.470329002749014
THA,Thailand,5.258448761245554
MDV,Maldives,7.064431850180757
KHM,Cambodia,9.682096701147762
HRV,Croatia,5.788897122209604
CHE,Switzerland,2.343144030831746
TUR,Turkey,-0.44562152999858845
VEN,"Venezuela, RB",-51.04958125709261
CYP,Cyprus,5.058535450528741
VCT,St. Vincent and the Grenadines,8.308401617023394
LKA,Sri Lanka,3.803653566530511
CAF,Central African Republic,77.21992072577778
SLV,El Salvador,2.794703820618421
EAP,East Asia & Pacific (excluding high income),10.500331778387803
FRA,France,2.7457406703026312
LBR,Liberia,-16.78114804648813
LSO,Lesotho,8.91761594901471
ALB,Albania,8.030434425245513
BTN,Bhutan,2.3855052167898734
TZA,Tanzania,3.085166725768402
COD,"Congo, Dem. Rep.",-16.86093006711765
MEX,Mexico,-0.5630680127478949
OED,OECD members,3.506250028904982
TSA,South Asia (IDA & IBRD),8.731075175570883
TON,Tonga,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),4.951745881289868
PRT,Portugal,5.128731841342556
BEN,Benin,0.8698981578538698
EGY,"Egypt, Arab Rep.",-7.155292088012925
NER,Niger,0.4849871156818115
COG,"Congo, Rep.",-25.844534626391113
STP,Sao Tome and Principe,0.093806085588137
NAC,North America,3.9835447401525426
TMN,Middle East & North Africa (IDA & IBRD countries),-3.043545348909082
TKM,Turkmenistan,1.9833335356857433
KGZ,Kyrgyz Republic,12.389832856426533
AFW,Africa Western and Central,3.618779071638926
ARE,United Arab Emirates,4.663505847905878
ARM,Armenia,4.009239299749563
BRN,Brunei Darussalam,7.7889793488355865
ZWE,Zimbabwe,-0.4001574625740916
UKR,Ukraine,10.626947332533637
GTM,Guatemala,1.7171133842194721
FSM,"Micronesia, Fed. Sts.",-2.9422577427801175
KOR,"Korea, Rep.",9.716328957481673
CHL,Chile,5.119669816376942
MAR,Morocco,6.26154737133207
HPC,Heavily indebted poor countries (HIPC),-0.7614722546277339
LTU,Lithuania,7.943041631178868
AGO,Angola,-11.281916196420593
GUY,Guyana,9.735342397213454
WSM,Samoa,-1.8071571029766822
COM,Comoros,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),5.5186668997344475
DZA,Algeria,-0.7780208374140188
IND,India,8.56652737658095
CAN,Canada,3.516020833511536
LAC,Latin America & Caribbean (excluding high income),1.0247826301139413
CZE,Czech Republic,10.428450078440672
TGO,Togo,7.758083762284739
AFG,Afghanistan,-18.308624974303797
KAZ,Kazakhstan,-2.8467522636092117
LCN,Latin America & Caribbean,-0.21980787495585355
TEA,East Asia & Pacific (IDA & IBRD countries),10.499561632363628
QAT,Qatar,-6.649542924759741
ZMB,Zambia,15.890200401377808
SRB,Serbia,10.058843469188531
BWA,Botswana,-0.21245584894371833
GRC,Greece,2.9283178857691543
GMB,"Gambia, The",-1.8622231047614777
NGA,Nigeria,5.373821440597682
ECU,Ecuador,0.5343416812705549
KWT,Kuwait,-2.425378258239524
AUS,Australia,5.91302435775189
OMN,Oman,4.722239797281134
UMC,Upper middle income,6.920495089257177
FJI,Fiji,13.145350273636053
TUN,Tunisia,4.336137968605618
SSF,Sub-Saharan Africa,2.1070114806863676
VNM,Vietnam,8.32414383351091
Query:
SELECT "country", "country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
   WHERE "year_2017" IS NOT NULL AND "year_2018" IS NOT NULL
     AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
   LIMIT 100;
Answer:
country,country_code,population_growth_pct
West Bank and Gaza,PSE,2.565400
Cambodia,KHM,1.501500
United Arab Emirates,ARE,1.515300
Lower middle income,LMC,1.391400
Maldives,MDV,3.886800
Low income,LIC,2.613700
Peru,PER,1.733100
Early-demographic dividend,EAR,1.308100
Chad,TCD,3.069800
Middle East & North Africa (excluding high income),MNA,1.686400
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800
World,WLD,1.108800
Saudi Arabia,SAU,1.815200
Dominican Republic,DOM,1.084700
Kenya,KEN,2.332700
Canada,CAN,1.419200
Guinea,GIN,2.873700
Pakistan,PAK,2.077200
Qatar,QAT,2.090200
Nigeria,NGA,2.620300
"Yemen, Rep.",YEM,2.385000
Namibia,NAM,1.900100
Rwanda,RWA,2.679300
Least developed countries: UN classification,LDC,2.362000
Cabo Verde,CPV,1.166500
Brunei Darussalam,BRN,1.057500
Philippines,PHL,1.405900
Sri Lanka,LKA,1.053900
Sao Tome and Principe,STP,1.902100
Haiti,HTI,1.282100
Pacific island small states,PSS,1.456600
St. Martin (French part),MAF,1.925600
Small states,SST,1.728500
Tanzania,TZA,3.026600
Bhutan,BTN,1.183800
Zambia,ZMB,2.955600
Guatemala,GTM,1.967900
Oman,OMN,3.505100
Tunisia,TUN,1.152400
South Africa,ZAF,1.367000
Pre-demographic dividend,PRE,2.791800
Sierra Leone,SLE,2.159600
Middle East & North Africa,MEA,1.735400
Nicaragua,NIC,1.263300
Fragile and conflict affected situations,FCS,2.201200
Mexico,MEX,1.132800
Morocco,MAR,1.258700
Angola,AGO,3.330400
Cameroon,CMR,2.646700
Solomon Islands,SLB,2.644500
Niger,NER,3.890600
Senegal,SEN,2.821000
South Asia (IDA & IBRD),TSA,1.202200
South Asia,SAS,1.202200
Equatorial Guinea,GNQ,3.722100
Honduras,HND,1.681100
IDA & IBRD total,IBT,1.223100
Burkina Faso,BFA,2.908600
Channel Islands,CHI,1.087400
Burundi,BDI,3.217400
Afghanistan,AFG,2.413400
Madagascar,MDG,2.705600
Ethiopia,ETH,2.654600
Paraguay,PRY,1.296200
"Macao SAR, China",MAC,1.453800
Mongolia,MNG,1.812200
Other small states,OSS,2.023900
Luxembourg,LUX,1.910300
Mali,MLI,3.053600
Arab World,ARB,1.915900
Bahrain,BHR,5.044300
"Congo, Dem. Rep.",COD,3.279300
Colombia,COL,1.528800
Australia,AUS,1.587300
Chile,CHL,1.400700
Somalia,SOM,2.872200
Benin,BEN,2.772600
IDA total,IDA,2.264400
Tajikistan,TJK,2.483800
Tonga,TON,1.175500
Kyrgyz Republic,KGZ,1.897300
"Congo, Rep.",COG,2.615300
Middle income,MIC,1.057600
Comoros,COM,2.264400
Malta,MLT,3.318600
New Caledonia,NCL,1.323300
Low & middle income,LMY,1.227300
Indonesia,IDN,1.140200
Iraq,IRQ,2.345500
Belize,BLZ,1.943200
Timor-Leste,TLS,1.987600
Zimbabwe,ZWE,1.420800
Sudan,SDN,2.421100
Ecuador,ECU,1.781300
Djibouti,DJI,1.570100
Cayman Islands,CYM,1.249600
Turkmenistan,TKM,1.619400
Malaysia,MYS,1.361700
"Egypt, Arab Rep.",EGY,2.054100
Turks and Caicos Islands,TCA,1.481900
Query:
SELECT "country_code", "country_name",
          (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
           MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
           MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
   LIMIT 100;
Answer:
country_code,country_name,health_exp_growth_pct
EMU,Euro area,2.789134976903903
GHA,Ghana,13.178566497874536
MUS,Mauritius,8.030903496449127
POL,Poland,1.8521743750267778
DEU,Germany,2.826478574456307
PER,Peru,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),2.1070114806863676
CPV,Cabo Verde,6.393341001204444
NZL,New Zealand,5.470329002749014
THA,Thailand,5.258448761245554
MDV,Maldives,7.064431850180757
KHM,Cambodia,9.682096701147762
HRV,Croatia,5.788897122209604
CHE,Switzerland,2.343144030831746
CYP,Cyprus,5.058535450528741
VCT,St. Vincent and the Grenadines,8.308401617023394
LKA,Sri Lanka,3.803653566530511
CAF,Central African Republic,77.21992072577778
SLV,El Salvador,2.794703820618421
EAP,East Asia & Pacific (excluding high income),10.500331778387803
FRA,France,2.7457406703026312
LSO,Lesotho,8.91761594901471
ALB,Albania,8.030434425245513
BTN,Bhutan,2.3855052167898734
TZA,Tanzania,3.085166725768402
OED,OECD members,3.506250028904982
TSA,South Asia (IDA & IBRD),8.731075175570883
TON,Tonga,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),4.951745881289868
PRT,Portugal,5.128731841342556
NAC,North America,3.9835447401525426
TKM,Turkmenistan,1.9833335356857433
KGZ,Kyrgyz Republic,12.389832856426533
AFW,Africa Western and Central,3.618779071638926
ARE,United Arab Emirates,4.663505847905878
ARM,Armenia,4.009239299749563
BRN,Brunei Darussalam,7.7889793488355865
UKR,Ukraine,10.626947332533637
GTM,Guatemala,1.7171133842194721
KOR,"Korea, Rep.",9.716328957481673
CHL,Chile,5.119669816376942
MAR,Morocco,6.26154737133207
LTU,Lithuania,7.943041631178868
GUY,Guyana,9.735342397213454
COM,Comoros,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),5.5186668997344475
IND,India,8.56652737658095
CAN,Canada,3.516020833511536
LAC,Latin America & Caribbean (excluding high income),1.0247826301139413
CZE,Czech Republic,10.428450078440672
TGO,Togo,7.758083762284739
TEA,East Asia & Pacific (IDA & IBRD countries),10.499561632363628
ZMB,Zambia,15.890200401377808
SRB,Serbia,10.058843469188531
GRC,Greece,2.9283178857691543
NGA,Nigeria,5.373821440597682
AUS,Australia,5.91302435775189
OMN,Oman,4.722239797281134
UMC,Upper middle income,6.920495089257177
FJI,Fiji,13.145350273636053
TUN,Tunisia,4.336137968605618
SSF,Sub-Saharan Africa,2.1070114806863676
VNM,Vietnam,8.32414383351091
ESP,Spain,2.700058958823298
HND,Honduras,5.245476561131182
PST,Post-demographic dividend,3.867870173090837
BEL,Belgium,2.1839077488751304
COL,Colombia,3.708053183245905
NLD,Netherlands,2.466818982241543
ECS,Europe & Central Asia,3.35960082147429
MRT,Mauritania,4.900233038497389
TLS,Timor-Leste,9.620727328816782
MNG,Mongolia,1.3580223967446232
PHL,Philippines,6.225895901836266
IDN,Indonesia,6.520882793655053
MIC,Middle income,6.101815985663521
ATG,Antigua and Barbuda,10.299268289062342
ROU,Romania,15.24165413416109
PAK,Pakistan,17.164876726309394
HIC,High income,3.534800089198823
PRY,Paraguay,8.354755847720794
SVN,Slovenia,6.680814639667525
SAS,South Asia,8.731075175570883
ISR,Israel,3.8699594203796184
FIN,Finland,2.7020203469470228
HUN,Hungary,5.561813157697172
AUT,Austria,3.613654824294838
RUS,Russian Federation,7.1229421476828465
ERI,Eritrea,23.472064126363087
BGR,Bulgaria,3.726355957259228
MKD,North Macedonia,6.123092927453969
LMC,Lower middle income,4.859841588386322
ITA,Italy,1.4552065516257022
DMA,Dominica,21.686427226054047
EAR,Early-demographic dividend,1.155713263926843
GBR,United Kingdom,3.2750742533610016
GNB,Guinea-Bissau,3.703319526850014
ETH,Ethiopia,1.699153922164326
MHL,Marshall Islands,11.769399246987488
PSS,Pacific island small states,6.218577578310462
Query:
SELECT p."country", p."country_code",
          ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct",
          h."health_exp_growth_pct"
   FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
   JOIN (
       SELECT "country_code",
              (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
               MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
               MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
       FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
       WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
         AND "year" IN (2017, 2018)
       GROUP BY "country_code"
   ) h ON p."country_code" = h."country_code"
   WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
   LIMIT 100;
Answer:
country,country_code,population_growth_pct,health_exp_growth_pct
Serbia,SRB,-0.552300,10.058843469188531
Cambodia,KHM,1.501500,9.682096701147762
United Arab Emirates,ARE,1.515300,4.663505847905878
Cyprus,CYP,0.812500,5.058535450528741
Lower middle income,LMC,1.391400,4.859841588386322
Maldives,MDV,3.886800,7.064431850180757
Low income,LIC,2.613700,-4.2655355575512415
Peru,PER,1.733100,9.807977642581225
Early-demographic dividend,EAR,1.308100,1.155713263926843
Fiji,FJI,0.686500,13.145350273636053
Chad,TCD,3.069800,-7.782875489518702
Middle East & North Africa (excluding high income),MNA,1.686400,-3.043545348909082
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800,-3.043545348909082
World,WLD,1.108800,3.803807230162976
Saudi Arabia,SAU,1.815200,-6.392527005315368
Dominican Republic,DOM,1.084700,6.597805657430963
Kenya,KEN,2.332700,13.694728244781942
"Venezuela, RB",VEN,-1.770000,-51.04958125709261
Canada,CAN,1.419200,3.516020833511536
Guinea,GIN,2.873700,8.043626497028214
Pakistan,PAK,2.077200,17.164876726309394
Latvia,LVA,-0.808700,11.227458011940097
Denmark,DNK,0.563200,3.6649324886397423
Nauru,NRU,-1.335800,-17.914344696955613
Qatar,QAT,2.090200,-6.649542924759741
United States,USA,0.621400,4.057137380431737
Europe & Central Asia (IDA & IBRD countries),TEC,0.448900,4.951745881289868
Brazil,BRA,0.786900,3.2571908913740963
Nigeria,NGA,2.620300,5.373821440597682
North Macedonia,MKD,0.046200,6.123092927453969
Namibia,NAM,1.900100,-4.1059460982336
Rwanda,RWA,2.679300,17.930277482427908
Least developed countries: UN classification,LDC,2.362000,0.5079618084527765
Central Europe and the Baltics,CEB,-0.220900,6.312226369688209
Cabo Verde,CPV,1.166500,6.393341001204444
Brunei Darussalam,BRN,1.057500,7.7889793488355865
Philippines,PHL,1.405900,6.225895901836266
Palau,PLW,0.555900,-7.063875281157944
Sri Lanka,LKA,1.053900,3.803653566530511
Sao Tome and Principe,STP,1.902100,0.093806085588137
Haiti,HTI,1.282100,-2.2981816246458204
Pacific island small states,PSS,1.456600,6.218577578310462
China,CHN,0.456900,11.628472188133323
Germany,DEU,0.327800,2.826478574456307
Norway,NOR,0.708100,4.641469635457937
Small states,SST,1.728500,0.3733356148596855
Ireland,IRL,0.959300,4.982530621027306
Tanzania,TZA,3.026600,3.085166725768402
Bhutan,BTN,1.183800,2.3855052167898734
Zambia,ZMB,2.955600,15.890200401377808
Europe & Central Asia (excluding high income),ECA,0.501900,5.5186668997344475
Guatemala,GTM,1.967900,1.7171133842194721
Oman,OMN,3.505100,4.722239797281134
Tunisia,TUN,1.152400,4.336137968605618
Singapore,SGP,0.470800,5.850614474042322
South Africa,ZAF,1.367000,3.6050576582534437
Finland,FIN,0.178600,2.7020203469470228
Montenegro,MNE,-0.004500,
Pre-demographic dividend,PRE,2.791800,0.027640701520033784
Bosnia and Herzegovina,BIH,-0.823400,6.034157731189415
Sierra Leone,SLE,2.159600,0.7938218928838047
Barbados,BRB,0.142500,-0.052236967280010066
Middle East & North Africa,MEA,1.735400,-3.0210868374484248
East Asia & Pacific (IDA & IBRD countries),TEA,0.654900,10.499561632363628
Marshall Islands,MHL,0.611500,11.769399246987488
San Marino,SMR,0.338600,1.8130555762403138
Nicaragua,NIC,1.263300,0.19474313578897326
Poland,POL,0.009800,1.8521743750267778
Fragile and conflict affected situations,FCS,2.201200,-7.431140913015866
Grenada,GRD,0.523100,3.0928087481277493
Slovenia,SVN,0.047600,6.680814639667525
St. Vincent and the Grenadines,VCT,0.348700,8.308401617023394
Mexico,MEX,1.132800,-0.5630680127478949
Morocco,MAR,1.258700,6.26154737133207
Angola,AGO,3.330400,-11.281916196420593
Samoa,WSM,0.398300,-1.8071571029766822
Cameroon,CMR,2.646700,4.960110566297106
Thailand,THA,0.315900,5.258448761245554
Vietnam,VNM,0.997700,8.32414383351091
Solomon Islands,SLB,2.644500,-2.6989051392649808
Japan,JPN,-0.202500,2.672329510093784
Niger,NER,3.890600,0.4849871156818115
Senegal,SEN,2.821000,2.147548484177809
Costa Rica,CRI,0.999700,7.425011128893834
Albania,ALB,-0.246400,8.030434425245513
St. Lucia,LCA,0.516200,-4.113580351693804
Andorra,AND,0.006500,8.664081204957636
South Asia (IDA & IBRD),TSA,1.202200,8.731075175570883
South Asia,SAS,1.202200,8.731075175570883
South Sudan,SSD,0.597200,-23.04966196615966
Azerbaijan,AZE,0.896100,-3.334361735734003
East Asia & Pacific (excluding high income),EAP,0.652600,10.500331778387803
Equatorial Guinea,GNQ,3.722100,-5.674867237231175
Honduras,HND,1.681100,5.245476561131182
IDA & IBRD total,IBT,1.223100,5.365268511981853
Burkina Faso,BFA,2.908600,-13.405671454192172
Jamaica,JAM,0.479400,1.265969012259397
Dominica,DMA,0.233700,21.686427226054047
Trinidad and Tobago,TTO,0.418000,-3.9807692412533333
Burundi,BDI,3.217400,10.771295086675051
Query:
SELECT p."country", p."country_code",
           ("year_2018" - "year_2017") / "year_2017" * 100 AS "population_growth_pct",
           h."health_exp_growth_pct"
    FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
    JOIN (
        SELECT "country_code",
               (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
        FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
        WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND "year" IN (2017, 2018)
        GROUP BY "country_code"
        HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
    ) h ON p."country_code" = h."country_code"
    WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
      AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
    LIMIT 100;
Answer:
country,country_code,population_growth_pct,health_exp_growth_pct
Cambodia,KHM,1.501500,9.682096701147762
United Arab Emirates,ARE,1.515300,4.663505847905878
Lower middle income,LMC,1.391400,4.859841588386322
Maldives,MDV,3.886800,7.064431850180757
Peru,PER,1.733100,9.807977642581225
Early-demographic dividend,EAR,1.308100,1.155713263926843
World,WLD,1.108800,3.803807230162976
Dominican Republic,DOM,1.084700,6.597805657430963
Kenya,KEN,2.332700,13.694728244781942
Canada,CAN,1.419200,3.516020833511536
Guinea,GIN,2.873700,8.043626497028214
Pakistan,PAK,2.077200,17.164876726309394
Nigeria,NGA,2.620300,5.373821440597682
Rwanda,RWA,2.679300,17.930277482427908
Cabo Verde,CPV,1.166500,6.393341001204444
Brunei Darussalam,BRN,1.057500,7.7889793488355865
Philippines,PHL,1.405900,6.225895901836266
Sri Lanka,LKA,1.053900,3.803653566530511
Pacific island small states,PSS,1.456600,6.218577578310462
Tanzania,TZA,3.026600,3.085166725768402
Bhutan,BTN,1.183800,2.3855052167898734
Zambia,ZMB,2.955600,15.890200401377808
Guatemala,GTM,1.967900,1.7171133842194721
Oman,OMN,3.505100,4.722239797281134
Tunisia,TUN,1.152400,4.336137968605618
South Africa,ZAF,1.367000,3.6050576582534437
Morocco,MAR,1.258700,6.26154737133207
Cameroon,CMR,2.646700,4.960110566297106
Senegal,SEN,2.821000,2.147548484177809
South Asia (IDA & IBRD),TSA,1.202200,8.731075175570883
South Asia,SAS,1.202200,8.731075175570883
Honduras,HND,1.681100,5.245476561131182
IDA & IBRD total,IBT,1.223100,5.365268511981853
Burundi,BDI,3.217400,10.771295086675051
Ethiopia,ETH,2.654600,1.699153922164326
Paraguay,PRY,1.296200,8.354755847720794
Mongolia,MNG,1.812200,1.3580223967446232
Luxembourg,LUX,1.910300,3.0231099439542266
Colombia,COL,1.528800,3.708053183245905
Australia,AUS,1.587300,5.91302435775189
Chile,CHL,1.400700,5.119669816376942
Tajikistan,TJK,2.483800,7.592042008450771
Tonga,TON,1.175500,2.056613223119864
Kyrgyz Republic,KGZ,1.897300,12.389832856426533
Middle income,MIC,1.057600,6.101815985663521
Comoros,COM,2.264400,2.3507894865998136
Low & middle income,LMY,1.227300,5.795254888549524
Indonesia,IDN,1.140200,6.520882793655053
Belize,BLZ,1.943200,4.840675942588913
Timor-Leste,TLS,1.987600,9.620727328816782
Turkmenistan,TKM,1.619400,1.9833335356857433
Malaysia,MYS,1.361700,7.102137892383236
Bangladesh,BGD,1.055600,12.70136856957698
Panama,PAN,1.707000,9.969733409110255
Sub-Saharan Africa,SSF,2.680800,2.1070114806863676
Sub-Saharan Africa (IDA & IBRD countries),TSS,2.680800,2.1070114806863676
Guinea-Bissau,GNB,2.525100,3.703319526850014
Vanuatu,VUT,2.511300,26.011962324854128
Tuvalu,TUV,1.213700,9.50118379426193
Mauritania,MRT,2.819400,4.900233038497389
Iceland,ISL,2.962700,7.879920585001142
New Zealand,NZL,1.910800,5.470329002749014
Nepal,NPL,1.667700,14.358253733618366
Uzbekistan,UZB,1.750000,10.451726930247599
Ghana,GHA,2.217000,13.178566497874536
India,IND,1.042700,8.56652737658095
Togo,TGO,2.476100,7.758083762284739
Sub-Saharan Africa (excluding high income),SSA,2.681000,2.1044911629600467
Israel,ISR,1.956800,3.8699594203796184
Central African Republic,CAF,1.530600,77.21992072577778
Mozambique,MOZ,2.956300,6.585758068790505
Sweden,SWE,1.247600,3.422344754901739
Kiribati,KIR,1.479500,15.79883792954302
Papua New Guinea,PNG,1.994400,4.339125399358243
Uganda,UGA,3.791500,5.32756876200654
Bolivia,BOL,1.432100,2.1873279954387588
Query:
SELECT COUNT(*) AS "Number_of_Countries"
    FROM (
        SELECT p."country_code"
        FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
        JOIN (
            SELECT "country_code",
                   (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                    MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                    MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 AS "health_exp_growth_pct"
            FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
            WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
              AND "year" IN (2017, 2018)
            GROUP BY "country_code"
            HAVING (MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                    MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                    MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100 > 1
        ) h ON p."country_code" = h."country_code"
        WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
          AND ("year_2018" - "year_2017") / "year_2017" * 100 > 1
    ) AS sub;
Answer:
Number_of_Countries
76
End Exploring Related Columns
Task: Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita (current US$)"** or the appropriate PPP-adjusted indicator.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

As the exact data is required to compute the precise number, the final result should be presented in the following format:

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SUMMARY', 'SERIES_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_EDUCATION'], 'WORLD_BANK_WDI': ['COUNTRY_SUMMARY', 'SERIES_TIME', 'INDICATORS_DATA', 'COUNTRY_SERIES_DEFINITIONS', 'FOOTNOTES', 'SERIES_SUMMARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 01:59:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:59:26 - root - INFO - ```sql
SELECT COUNT(*) AS "Number_of_Countries"
FROM (
    SELECT p."country_code"
    FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
    JOIN (
        SELECT "country_code",
               ((MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                 MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100) AS "health_exp_growth_pct"
        FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
        WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND "year" IN (2017, 2018)
        GROUP BY "country_code"
        HAVING ((MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                 MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100) > 1
    ) h ON p."country_code" = h."country_code"
    WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
      AND ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
) AS sub;
```
2025-02-11 01:59:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:59:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:59:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:59:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 01:59:27 - snowflake.connector.connection - INFO - closed
2025-02-11 01:59:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:27 - root - INFO - itercount: 1
2025-02-11 01:59:27 - root - INFO - 0
2025-02-11 01:59:27 - root - INFO - results: 
Number_of_Countries
76


2025-02-11 01:59:27 - root - INFO - Please check the answer again by reviewing Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita (current US$)"** or the appropriate PPP-adjusted indicator.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

As the exact data is required to compute the precise number, the final result should be presented in the following format:

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Countries
76
Current sql:
SELECT COUNT(*) AS "Number_of_Countries"
FROM (
    SELECT p."country_code"
    FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
    JOIN (
        SELECT "country_code",
               ((MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                 MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100) AS "health_exp_growth_pct"
        FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
        WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND "year" IN (2017, 2018)
        GROUP BY "country_code"
        HAVING ((MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                 MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100) > 1
    ) h ON p."country_code" = h."country_code"
    WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
      AND ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
) AS sub;
2025-02-11 01:59:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:59:58 - root - INFO - To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita, PPP (current international $)"**.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

The final result is presented in the following format:

```csv
Number_of_Countries
76
```

Here is the SQL query to obtain this result:

```sql
SELECT COUNT(*) AS "Number_of_Countries"
FROM (
    SELECT p."country_code"
    FROM "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p
    JOIN (
        SELECT "country_code",
               ((MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                 MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100) AS "health_exp_growth_pct"
        FROM "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
        WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND "year" IN (2017, 2018)
        GROUP BY "country_code"
        HAVING ((MAX(CASE WHEN "year" = 2018 THEN "value" END) -
                 MAX(CASE WHEN "year" = 2017 THEN "value" END)) /
                MAX(CASE WHEN "year" = 2017 THEN "value" END) * 100) > 1
    ) h ON p."country_code" = h."country_code"
    WHERE p."year_2017" IS NOT NULL AND p."year_2018" IS NOT NULL
      AND ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
) AS sub;
```

This query performs the required calculations and counts the number of countries that meet both criteria. The final count is **76** countries.
2025-02-11 01:59:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:59:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:59:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:59:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 01:59:59 - snowflake.connector.connection - INFO - closed
2025-02-11 01:59:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:59 - root - INFO - itercount: 2
2025-02-11 01:59:59 - root - INFO - 0
2025-02-11 01:59:59 - root - INFO - Total iteration counts: 2
