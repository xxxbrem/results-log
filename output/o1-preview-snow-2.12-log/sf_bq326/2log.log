2025-02-11 01:57:26 - openai._base_client - INFO - Retrying request to /chat/completions in 0.444175 seconds
2025-02-11 01:58:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:58:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:12 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:12 - root - INFO - SQL:
SELECT 
  "country", 
  "country_code", 
  "year_2017", 
  "year_2018" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" 
LIMIT 100;
Results:
country,country_code,year_2017,year_2018
Sint Maarten (Dutch part),SXM,40574.0,40654.0
Not classified,INX,,
West Bank and Gaza,PSE,4454805.0,4569087.0
Serbia,SRB,7020858.0,6982084.0
Cambodia,KHM,16009414.0,16249798.0
United Arab Emirates,ARE,9487203.0,9630959.0
Cyprus,CYP,1179680.0,1189265.0
Lower middle income,LMC,2981420591.0,3022905169.0
Maldives,MDV,496402.0,515696.0
Low income,LIC,687449530.0,705417321.0
Peru,PER,31444297.0,31989256.0
Early-demographic dividend,EAR,3207188541.0,3249140605.0
Fiji,FJI,877459.0,883483.0
Chad,TCD,15016773.0,15477751.0
Middle East & North Africa (excluding high income),MNA,376546755.0,382896715.0
Middle East & North Africa (IDA & IBRD countries),TMN,372091950.0,378327628.0
World,WLD,7510990456.0,7594270356.0
Saudi Arabia,SAU,33099147.0,33699947.0
Dominican Republic,DOM,10513131.0,10627165.0
Kenya,KEN,50221473.0,51393010.0
"Venezuela, RB",VEN,29390409.0,28870195.0
Canada,CAN,36540268.0,37058856.0
Guinea,GIN,12067539.0,12414318.0
Pakistan,PAK,207896686.0,212215030.0
Latvia,LVA,1942248.0,1926542.0
Denmark,DNK,5764980.0,5797446.0
"Hong Kong SAR, China",HKG,7391700.0,7451000.0
Nauru,NRU,12876.0,12704.0
Qatar,QAT,2724724.0,2781677.0
United States,USA,325147121.0,327167434.0
Europe & Central Asia (IDA & IBRD countries),TEC,457810292.0,459865205.0
Brazil,BRA,207833831.0,209469333.0
Nigeria,NGA,190873311.0,195874740.0
"Yemen, Rep.",YEM,27834821.0,28498687.0
North Macedonia,MKD,2081996.0,2082958.0
Namibia,NAM,2402603.0,2448255.0
Rwanda,RWA,11980937.0,12301939.0
Least developed countries: UN classification,LDC,986365080.0,1009662578.0
Central Europe and the Baltics,CEB,102738854.0,102511922.0
Cabo Verde,CPV,537497.0,543767.0
Brunei Darussalam,BRN,424473.0,428962.0
Philippines,PHL,105173264.0,106651922.0
Palau,PLW,17808.0,17907.0
Sri Lanka,LKA,21444000.0,21670000.0
Sao Tome and Principe,STP,207089.0,211028.0
Haiti,HTI,10982366.0,11123176.0
Pacific island small states,PSS,2422086.0,2457367.0
China,CHN,1386395000.0,1392730000.0
Germany,DEU,82657002.0,82927922.0
St. Martin (French part),MAF,36560.0,37264.0
Faroe Islands,FRO,48331.0,48497.0
Norway,NOR,5276968.0,5314336.0
Small states,SST,39885876.0,40575321.0
Ireland,IRL,4807388.0,4853506.0
Tanzania,TZA,54663906.0,56318348.0
Bhutan,BTN,745568.0,754394.0
Kosovo,XKX,1830700.0,1845300.0
Zambia,ZMB,16853688.0,17351822.0
Europe & Central Asia (excluding high income),ECA,415710935.0,417797257.0
Isle of Man,IMN,83598.0,84077.0
Guatemala,GTM,16914936.0,17247807.0
Oman,OMN,4665935.0,4829483.0
Tunisia,TUN,11433443.0,11565204.0
Singapore,SGP,5612253.0,5638676.0
South Africa,ZAF,57000451.0,57779622.0
Finland,FIN,5508214.0,5518050.0
Montenegro,MNE,622373.0,622345.0
Pre-demographic dividend,PRE,894512725.0,919485393.0
Bosnia and Herzegovina,BIH,3351527.0,3323929.0
Sierra Leone,SLE,7488431.0,7650154.0
Barbados,BRB,286233.0,286641.0
Middle East & North Africa,MEA,441255234.0,448912859.0
East Asia & Pacific (IDA & IBRD countries),TEA,2042687863.0,2056064424.0
Marshall Islands,MHL,58058.0,58413.0
San Marino,SMR,33671.0,33785.0
Syrian Arab Republic,SYR,17068002.0,16906283.0
Nicaragua,NIC,6384855.0,6465513.0
Poland,POL,37974826.0,37978548.0
Fragile and conflict affected situations,FCS,504119229.0,515215936.0
Grenada,GRD,110874.0,111454.0
Slovenia,SVN,2066388.0,2067372.0
St. Vincent and the Grenadines,VCT,109827.0,110210.0
Mexico,MEX,124777324.0,126190788.0
Morocco,MAR,35581294.0,36029138.0
Angola,AGO,29816748.0,30809762.0
Samoa,WSM,195352.0,196130.0
Cameroon,CMR,24566045.0,25216237.0
Thailand,THA,69209858.0,69428524.0
Vietnam,VNM,94596642.0,95540395.0
Solomon Islands,SLB,636038.0,652858.0
Japan,JPN,126785797.0,126529100.0
Niger,NER,21602472.0,22442948.0
Senegal,SEN,15419381.0,15854360.0
Costa Rica,CRI,4949954.0,4999441.0
Albania,ALB,2873457.0,2866376.0
St. Lucia,LCA,180955.0,181889.0
Andorra,AND,77001.0,77006.0
South Asia (IDA & IBRD),TSA,1792835608.0,1814388744.0
South Asia,SAS,1792835608.0,1814388744.0
South Sudan,SSD,10910759.0,10975920.0

2025-02-11 01:58:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 01:58:14 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:14 - root - INFO - SQL:
SELECT DISTINCT 
  "indicator_name" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
LIMIT 100;
Results:
indicator_name
Current health expenditure per capita (current US$)
Domestic general government health expenditure per capita (current US$)
External health expenditure per capita (current US$)
"External health expenditure per capita, PPP (current international $)"
Domestic private health expenditure per capita (current US$)
"Current health expenditure per capita, PPP (current international $)"
"Domestic private health expenditure per capita, PPP  (current international $)"
"Domestic general government health expenditure per capita, PPP (current international $)"

2025-02-11 01:58:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:16 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:16 - root - INFO - SQL:
SELECT 
  "country_code", 
  "country_name", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2017 
LIMIT 100;
Results:
country_code,country_name,value
BFA,Burkina Faso,49.92856979
TKM,Turkmenistan,1.24862432
GBR,United Kingdom,3162.25927734
USA,United States,5130.76904297
VEN,"Venezuela, RB",314.00161743
COM,Comoros,6.83181143
DNK,Denmark,5800.15283203
DJI,Djibouti,37.25012207
NAM,Namibia,428.04586792
NGA,Nigeria,31.36062241
ARB,Arab World,391.382333336795
EMU,Euro area,4572.35296577739
LIC,Low income,22.5202464460893
SLV,El Salvador,367.32601929
SLV,El Salvador,0.39850688
GNQ,Equatorial Guinea,230.1509552
FIN,Finland,954.11553955
GHA,Ghana,148.41990662
STP,Sao Tome and Principe,18.79934502
JAM,Jamaica,364.89474487
KEN,Kenya,31.56469345
LMC,Lower middle income,2.54079486080698
OSS,Other small states,213.630898359584
PSS,Pacific island small states,41.8611576931166
PST,Post-demographic dividend,5924.10963361332
SSF,Sub-Saharan Africa,10.109787360296
TSS,Sub-Saharan Africa (IDA & IBRD countries),10.109787360296
AFG,Afghanistan,44.31379318
AND,Andorra,1789.86120605
MLI,Mali,31.34018135
MHL,Marshall Islands,587.55316162
SSD,South Sudan,147.8605957
SDN,Sudan,192.60665894
SDN,Sudan,311.76040649
TJK,Tajikistan,58.16766357
TON,Tonga,46.62133408
AZE,Azerbaijan,112.46528625
BHS,"Bahamas, The",1208.62634277
BRB,Barbados,23.14829445
BTN,Bhutan,35.13426208
COL,Colombia,1114.09619141
DJI,Djibouti,33.54146957
DJI,Djibouti,18.67774773
MUS,Mauritius,548.3939209
MCO,Monaco,2402.81103516
MNG,Mongolia,14.52910423
MAR,Morocco,0.35790461
NPL,Nepal,11.35226917
NPL,Nepal,31.71228981
NLD,Netherlands,5498.88183594
NGA,Nigeria,10.48568821
ECS,Europe & Central Asia,2872.69957547778
HPC,Heavily indebted poor countries (HIPC),27.6323624559571
LAC,Latin America & Caribbean (excluding high income),1.95186507485968
SWZ,Eswatini,180.67512512
HTI,Haiti,62.72842407
SMR,San Marino,3287.47387695
IRN,"Iran, Islamic Rep.",1758.99145508
MNA,Middle East & North Africa (excluding high income),506.622808713069
TMN,Middle East & North Africa (IDA & IBRD countries),3.51979744563623
PST,Post-demographic dividend,0.293871900441022
WLD,World,583.729041807838
ALB,Albania,4.65915346
DZA,Algeria,639.97625732
THA,Thailand,525.81530762
TLS,Timor-Leste,321.57449341
BHR,Bahrain,950.96466064
BRA,Brazil,391.69564819
UGA,Uganda,41.95800781
ARE,United Arab Emirates,1661.46777344
SVN,Slovenia,1.0
SGP,Singapore,1.0
AUS,Australia,1.0
AUT,Austria,1.0
USA,United States,1.0
NZL,New Zealand,1.0
DNK,Denmark,1.0
FRA,France,1.0
NAC,North America,1.0
USA,United States,1.0
CAN,Canada,1.0
ARE,United Arab Emirates,1.0
RUS,Russian Federation,1.0
TTO,Trinidad and Tobago,1.0
OMN,Oman,1.0
BGR,Bulgaria,1.0
CAN,Canada,1.0
SWE,Sweden,1.0
MEX,Mexico,1.0
CHE,Switzerland,1.0
SVK,Slovak Republic,1.0
BRN,Brunei Darussalam,1.0
CZE,Czech Republic,1.0
MCO,Monaco,1.0
HUN,Hungary,1.0
KWT,Kuwait,1.0
SVN,Slovenia,1.0
IRL,Ireland,1.0
CHE,Switzerland,1.0
AUT,Austria,1.0

2025-02-11 01:58:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:17 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:18 - root - INFO - SQL:
SELECT 
  "country_code", 
  "country_name", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2018 
LIMIT 100;
Results:
country_code,country_name,value
BWA,Botswana,374.17907715
UKR,Ukraine,2.30205011
URY,Uruguay,429.58023071
COM,Comoros,65.22776031
COM,Comoros,102.36206055
COD,"Congo, Dem. Rep.",2.79114175
CRI,Costa Rica,0.05650612
DMA,Dominica,9.2956562
DOM,Dominican Republic,4.37877226
MCO,Monaco,2968.50048828
PLW,Palau,2011.51733398
PLW,Palau,662.62835693
EMU,Euro area,1067.83582859016
TEC,Europe & Central Asia (IDA & IBRD countries),170.921351224296
EUU,European Union,1088.35658972773
HIC,High income,0.624952150180451
LCN,Latin America & Caribbean,1.54613119374784
FRA,France,4690.07226563
DEU,Germany,5472.20214844
GHA,Ghana,167.97952271
PER,Peru,137.32307434
RWA,Rwanda,58.30852127
SLE,Sierra Leone,55.24813843
HND,Honduras,176.24726868
LAO,Lao PDR,81.64137268
LMC,Lower middle income,59.7275955701677
UMC,Upper middle income,0.690429319312342
AFG,Afghanistan,8.19657612
ATG,Antigua and Barbuda,485.82119751
MLI,Mali,32.36968613
MHL,Marshall Islands,98.64823151
MRT,Mauritania,30.77950668
TLS,Timor-Leste,10.6438303
BHR,Bahrain,994.17901611
BRB,Barbados,14.29946041
BEL,Belgium,5404.91601563
BEN,Benin,41.7741394
BIH,Bosnia and Herzegovina,376.87268066
BDI,Burundi,24.02547073
VEN,"Venezuela, RB",199.89640808
TCD,Chad,4.57267809
MUS,Mauritius,368.16949463
NRU,Nauru,49.04381943
HPC,Heavily indebted poor countries (HIPC),13.9419707895972
HPC,Heavily indebted poor countries (HIPC),37.5276060436454
LTE,Late-demographic dividend,239.558049325612
GRC,Greece,750.99975586
GRD,Grenada,22.30875015
PNG,Papua New Guinea,12.88847256
PRT,Portugal,1361.25512695
STP,Sao Tome and Principe,55.12792206
SEN,Senegal,58.90360641
HND,Honduras,145.84317017
IRQ,Iraq,367.75228882
ISR,Israel,3323.65063477
KIR,Kiribati,196.84797668
TSA,South Asia (IDA & IBRD),177.637906691198
SSA,Sub-Saharan Africa (excluding high income),30.192121784093
TSS,Sub-Saharan Africa (IDA & IBRD countries),83.2490352335023
ALB,Albania,274.91409302
AND,Andorra,2821.80126953
ATG,Antigua and Barbuda,0.78491873
MRT,Mauritania,190.13778687
LKA,Sri Lanka,3.52529263
SDN,Sudan,22.31403923
SUR,Suriname,474.1265564
BHS,"Bahamas, The",2005.24621582
BGD,Bangladesh,7.14773178
BRN,Brunei Darussalam,94.87831879
UKR,Ukraine,228.39007568
GBR,United Kingdom,3392.0859375
GBR,United Kingdom,922.77746582
CHL,Chile,1.0
ROU,Romania,1.0
SMR,San Marino,1.0
KWT,Kuwait,1.0
BEL,Belgium,1.0
COL,Colombia,1.0
DNK,Denmark,1.0
SWE,Sweden,1.0
CAN,Canada,1.0
MNE,Montenegro,1.0
NOR,Norway,1.0
JPN,Japan,1.0
SVK,Slovak Republic,1.0
NAC,North America,1.0
BGR,Bulgaria,1.0
DNK,Denmark,1.0
MCO,Monaco,1.0
QAT,Qatar,1.0
RUS,Russian Federation,1.0
CZE,Czech Republic,1.0
BGR,Bulgaria,1.0
HUN,Hungary,1.0
SVN,Slovenia,1.0
HUN,Hungary,1.0
AND,Andorra,1.0
OMN,Oman,1.0
ESP,Spain,1.0
ARE,United Arab Emirates,1.0

2025-02-11 01:58:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:19 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:19 - root - INFO - SQL:
SELECT 
  "country", 
  "country_code", 
  (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) AS "population_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" 
WHERE 
  (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) > 1 
LIMIT 100;
Results:
country,country_code,population_growth_percent
West Bank and Gaza,PSE,2.565400
Cambodia,KHM,1.501500
United Arab Emirates,ARE,1.515300
Lower middle income,LMC,1.391400
Maldives,MDV,3.886800
Low income,LIC,2.613700
Peru,PER,1.733100
Early-demographic dividend,EAR,1.308100
Chad,TCD,3.069800
Middle East & North Africa (excluding high income),MNA,1.686400
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800
World,WLD,1.108800
Saudi Arabia,SAU,1.815200
Dominican Republic,DOM,1.084700
Kenya,KEN,2.332700
Canada,CAN,1.419200
Guinea,GIN,2.873700
Pakistan,PAK,2.077200
Qatar,QAT,2.090200
Nigeria,NGA,2.620300
"Yemen, Rep.",YEM,2.385000
Namibia,NAM,1.900100
Rwanda,RWA,2.679300
Least developed countries: UN classification,LDC,2.362000
Cabo Verde,CPV,1.166500
Brunei Darussalam,BRN,1.057500
Philippines,PHL,1.405900
Sri Lanka,LKA,1.053900
Sao Tome and Principe,STP,1.902100
Haiti,HTI,1.282100
Pacific island small states,PSS,1.456600
St. Martin (French part),MAF,1.925600
Small states,SST,1.728500
Tanzania,TZA,3.026600
Bhutan,BTN,1.183800
Zambia,ZMB,2.955600
Guatemala,GTM,1.967900
Oman,OMN,3.505100
Tunisia,TUN,1.152400
South Africa,ZAF,1.367000
Pre-demographic dividend,PRE,2.791800
Sierra Leone,SLE,2.159600
Middle East & North Africa,MEA,1.735400
Nicaragua,NIC,1.263300
Fragile and conflict affected situations,FCS,2.201200
Mexico,MEX,1.132800
Morocco,MAR,1.258700
Angola,AGO,3.330400
Cameroon,CMR,2.646700
Solomon Islands,SLB,2.644500
Niger,NER,3.890600
Senegal,SEN,2.821000
South Asia (IDA & IBRD),TSA,1.202200
South Asia,SAS,1.202200
Equatorial Guinea,GNQ,3.722100
Honduras,HND,1.681100
IDA & IBRD total,IBT,1.223100
Burkina Faso,BFA,2.908600
Channel Islands,CHI,1.087400
Burundi,BDI,3.217400
Afghanistan,AFG,2.413400
Madagascar,MDG,2.705600
Ethiopia,ETH,2.654600
Paraguay,PRY,1.296200
"Macao SAR, China",MAC,1.453800
Mongolia,MNG,1.812200
Other small states,OSS,2.023900
Luxembourg,LUX,1.910300
Mali,MLI,3.053600
Arab World,ARB,1.915900
Bahrain,BHR,5.044300
"Congo, Dem. Rep.",COD,3.279300
Colombia,COL,1.528800
Australia,AUS,1.587300
Chile,CHL,1.400700
Somalia,SOM,2.872200
Benin,BEN,2.772600
IDA total,IDA,2.264400
Tajikistan,TJK,2.483800
Tonga,TON,1.175500
Kyrgyz Republic,KGZ,1.897300
"Congo, Rep.",COG,2.615300
Middle income,MIC,1.057600
Comoros,COM,2.264400
Malta,MLT,3.318600
New Caledonia,NCL,1.323300
Low & middle income,LMY,1.227300
Indonesia,IDN,1.140200
Iraq,IRQ,2.345500
Belize,BLZ,1.943200
Timor-Leste,TLS,1.987600
Zimbabwe,ZWE,1.420800
Sudan,SDN,2.421100
Ecuador,ECU,1.781300
Djibouti,DJI,1.570100
Cayman Islands,CYM,1.249600
Turkmenistan,TKM,1.619400
Malaysia,MYS,1.361700
"Egypt, Arab Rep.",EGY,2.054100
Turks and Caicos Islands,TCA,1.481900

2025-02-11 01:58:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:20 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:20 - root - INFO - SQL:
SELECT 
  "country_code", 
  "country_name", 
  "year", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" IN (2017, 2018) 
ORDER BY 
  "country_code", 
  "year" 
LIMIT 100;
Results:
country_code,country_name,year,value
AFE,Africa Eastern and Southern,2017,92.8108974560942
AFE,Africa Eastern and Southern,2017,12.1805265384115
AFE,Africa Eastern and Southern,2017,45.8521240340281
AFE,Africa Eastern and Southern,2017,42.0128413737966
AFE,Africa Eastern and Southern,2017,96.1377734894616
AFE,Africa Eastern and Southern,2017,100.045491564991
AFE,Africa Eastern and Southern,2017,220.974858439749
AFE,Africa Eastern and Southern,2017,32.026190816976
AFE,Africa Eastern and Southern,2018,32.7685270624819
AFE,Africa Eastern and Southern,2018,12.1599095499043
AFE,Africa Eastern and Southern,2018,223.831853386522
AFE,Africa Eastern and Southern,2018,41.730514799049
AFE,Africa Eastern and Southern,2018,40.352413993896
AFE,Africa Eastern and Southern,2018,94.8877514685813
AFE,Africa Eastern and Southern,2018,94.2428382114765
AFE,Africa Eastern and Southern,2018,96.1755810685664
AFG,Afghanistan,2017,3.34825993
AFG,Afghanistan,2017,12.76019955
AFG,Afghanistan,2017,172.24311829
AFG,Afghanistan,2017,11.62788296
AFG,Afghanistan,2017,65.70602417
AFG,Afghanistan,2017,228.18478394
AFG,Afghanistan,2017,49.59756851
AFG,Afghanistan,2017,44.31379318
AFG,Afghanistan,2018,49.84260941
AFG,Afghanistan,2018,39.06802368
AFG,Afghanistan,2018,2.57800722
AFG,Afghanistan,2018,30.65452385
AFG,Afghanistan,2018,146.11122131
AFG,Afghanistan,2018,186.4072876
AFG,Afghanistan,2018,8.19657612
AFG,Afghanistan,2018,9.64153671
AFW,Africa Western and Central,2017,19.7056497252775
AFW,Africa Western and Central,2017,61.306286786352
AFW,Africa Western and Central,2017,41.9853160825962
AFW,Africa Western and Central,2017,33.5749452151388
AFW,Africa Western and Central,2017,172.544544804834
AFW,Africa Western and Central,2017,12.2007461085723
AFW,Africa Western and Central,2017,119.263954435824
AFW,Africa Western and Central,2017,7.12022667587668
AFW,Africa Western and Central,2018,46.3294803061782
AFW,Africa Western and Central,2018,67.3838178790827
AFW,Africa Western and Central,2018,13.6722191561302
AFW,Africa Western and Central,2018,178.788550681486
AFW,Africa Western and Central,2018,124.067961135881
AFW,Africa Western and Central,2018,19.3137878888331
AFW,Africa Western and Central,2018,7.38211355104294
AFW,Africa Western and Central,2018,35.4067893665748
AGO,Angola,2017,185.65101624
AGO,Angola,2017,5.78263712
AGO,Angola,2017,114.33460236
AGO,Angola,2017,52.91251755
AGO,Angola,2017,85.91679382
AGO,Angola,2017,93.95159912
AGO,Angola,2017,57.86081314
AGO,Angola,2017,3.56128168
AGO,Angola,2018,69.06031799
AGO,Angola,2018,164.70602417
AGO,Angola,2018,87.61676788
AGO,Angola,2018,36.73722076
AGO,Angola,2018,2.91132259
AGO,Angola,2018,5.47283792
AGO,Angola,2018,47.96822739
AGO,Angola,2018,90.17287445
ALB,Albania,2017,120.75823975
ALB,Albania,2017,287.71487427
ALB,Albania,2017,13.29034233
ALB,Albania,2017,100.86329651
ALB,Albania,2017,4.65915346
ALB,Albania,2017,645.47076416
ALB,Albania,2017,344.46563721
ALB,Albania,2017,226.28067017
ALB,Albania,2018,9.40255356
ALB,Albania,2018,274.91409302
ALB,Albania,2018,3.70697927
ALB,Albania,2018,148.43656921
ALB,Albania,2018,376.50137329
ALB,Albania,2018,122.77055359
ALB,Albania,2018,311.40093994
ALB,Albania,2018,697.30487061
AND,Andorra,2017,3319.4050293
AND,Andorra,2017,1.0
AND,Andorra,2017,2314.09936523
AND,Andorra,2017,777.56268311
AND,Andorra,2017,2567.42382813
AND,Andorra,2017,1005.30554199
AND,Andorra,2017,1789.86120605
AND,Andorra,2017,1.0
AND,Andorra,2018,1.0
AND,Andorra,2018,3607.00097656
AND,Andorra,2018,1.0
AND,Andorra,2018,2821.80126953
AND,Andorra,2018,1916.98449707
AND,Andorra,2018,2450.40795898
AND,Andorra,2018,904.81671143
AND,Andorra,2018,1156.59265137
ARB,Arab World,2017,168.220100869686
ARB,Arab World,2017,5.41718758337942
ARB,Arab World,2017,220.580138729293
ARB,Arab World,2017,391.382333336795

2025-02-11 01:58:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:22 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:22 - root - INFO - SQL:
SELECT DISTINCT 
  p."country_code", 
  p."country" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" h 
ON 
  p."country_code" = h."country_code" 
LIMIT 100;
Results:
country_code,country
CPV,Cabo Verde
ISL,Iceland
LUX,Luxembourg
FRO,Faroe Islands
LCA,St. Lucia
LMY,Low & middle income
UGA,Uganda
TUN,Tunisia
PRY,Paraguay
BLR,Belarus
DOM,Dominican Republic
BRA,Brazil
CYM,Cayman Islands
CAF,Central African Republic
HIC,High income
MWI,Malawi
DNK,Denmark
BMU,Bermuda
ARG,Argentina
DMA,Dominica
BDI,Burundi
LBN,Lebanon
ASM,American Samoa
NLD,Netherlands
GBR,United Kingdom
MAC,"Macao SAR, China"
BTN,Bhutan
ZWE,Zimbabwe
GTM,Guatemala
KOR,"Korea, Rep."
DJI,Djibouti
SLB,Solomon Islands
IND,India
ESP,Spain
WLD,World
BRB,Barbados
TJK,Tajikistan
AZE,Azerbaijan
HPC,Heavily indebted poor countries (HIPC)
AUS,Australia
ZMB,Zambia
IRL,Ireland
LBR,Liberia
AGO,Angola
TCD,Chad
MDV,Maldives
SSD,South Sudan
BLZ,Belize
ITA,Italy
NOR,Norway
IBT,IDA & IBRD total
LBY,Libya
RWA,Rwanda
CSS,Caribbean small states
CHE,Switzerland
SSF,Sub-Saharan Africa
SST,Small states
PNG,Papua New Guinea
LKA,Sri Lanka
TUV,Tuvalu
SLV,El Salvador
XKX,Kosovo
NER,Niger
TSA,South Asia (IDA & IBRD)
SEN,Senegal
SVK,Slovak Republic
ECA,Europe & Central Asia (excluding high income)
GMB,"Gambia, The"
GEO,Georgia
GUM,Guam
RUS,Russian Federation
KGZ,Kyrgyz Republic
MDA,Moldova
MLT,Malta
BHS,"Bahamas, The"
LCN,Latin America & Caribbean
ARE,United Arab Emirates
MIC,Middle income
TON,Tonga
TKM,Turkmenistan
IDN,Indonesia
NAC,North America
MLI,Mali
JAM,Jamaica
VEN,"Venezuela, RB"
CHI,Channel Islands
SLE,Sierra Leone
ROU,Romania
EUU,European Union
MDG,Madagascar
CUB,Cuba
MNG,Mongolia
HND,Honduras
SMR,San Marino
PRI,Puerto Rico
LDC,Least developed countries: UN classification
TGO,Togo
GNQ,Equatorial Guinea
IRQ,Iraq
PER,Peru

2025-02-11 01:58:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:23 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:58:48 - root - INFO - The error message you're encountering indicates that the column name `"country_code"` is ambiguous. This happens because both tables `h2017` and `h2018` in your `JOIN` have a column named `"country_code"`, and the SQL engine doesn't know which one you're referring to in your `SELECT` clause.

To resolve this, you need to specify which table each column is coming from by prefixing the column names with the appropriate table aliases (`h2017` or `h2018`).

Here's the corrected SQL query:

```sql
SELECT 
  h2017."country_code", 
  h2017."country_name", 
  ((h2018."value" - h2017."value") / h2017."value" * 100) AS "expenditure_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2017 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2018 
ON 
  h2017."country_code" = h2018."country_code" 
  AND h2017."indicator_name" = h2018."indicator_name" 
WHERE 
  h2017."indicator_name" ILIKE '%health expenditure per capita%' 
  AND h2017."year" = 2017 
  AND h2018."year" = 2018 
  AND ((h2018."value" - h2017."value") / h2017."value" * 100) > 1 
LIMIT 100;
```

**Explanation:**

- **Specify Table Aliases in SELECT Clause**: By adding `h2017.` before `"country_code"` and `"country_name"`, you eliminate the ambiguity.
  
- **Using Table Aliases**: The `AS` keyword is used to assign aliases to the tables for clarity, although it's optional since aliases were already specified.

Now, with this correction, your query should run without the `ambiguous column name` error.

---

**Additional Note:**

Since you're working towards identifying the number of countries that experienced an increase of more than 1% in both their total population and per capita current health expenditure (PPP) from 2017 to 2018, you'll need to perform similar calculations for the population data and then find the intersection of countries satisfying both conditions.

Here's how you might proceed:

1. **Calculate Population Growth Over 1%**:

   ```sql
   SELECT 
     p."country_code", 
     p."country", 
     ((p."year_2018" - p."year_2017") / p."year_2017" * 100) AS "population_growth_percent"
   FROM 
     "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" AS p
   WHERE 
     p."year_2017" IS NOT NULL 
     AND p."year_2018" IS NOT NULL 
     AND ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
   ```

2. **Calculate Health Expenditure Growth Over 1%**:

   (Using the corrected query from earlier.)

3. **Find Countries Meeting Both Criteria**:

   You can use an `INNER JOIN` or a `WHERE EXISTS` clause to find the countries that satisfy both conditions.

   ```sql
   WITH pop_growth AS (
     SELECT 
       p."country_code", 
       p."country"
     FROM 
       "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" AS p
     WHERE 
       p."year_2017" IS NOT NULL 
       AND p."year_2018" IS NOT NULL 
       AND ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
   ),
   health_exp_growth AS (
     SELECT 
       h2017."country_code", 
       h2017."country_name"
     FROM 
       "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2017 
     JOIN 
       "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2018 
     ON 
       h2017."country_code" = h2018."country_code" 
       AND h2017."indicator_name" = h2018."indicator_name" 
     WHERE 
       h2017."indicator_name" ILIKE '%health expenditure per capita%' 
       AND h2017."year" = 2017 
       AND h2018."year" = 2018 
       AND h2017."value" > 0  -- Ensure no division by zero
       AND ((h2018."value" - h2017."value") / h2017."value" * 100) > 1
   )
   SELECT COUNT(DISTINCT pg."country_code") AS "Number_of_Countries"
   FROM 
     pop_growth AS pg
   INNER JOIN 
     health_exp_growth AS hg ON pg."country_code" = hg."country_code";
   ```

This final query counts the number of countries that have more than a 1% increase in both total population and per capita current health expenditure (PPP) from 2017 to 2018.

**Output Format:**

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
```
2025-02-11 01:58:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:49 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:59:05 - root - INFO - SQL:
SELECT 
  h2017."country_code", 
  h2017."country_name", 
  ((h2018."value" - h2017."value") / h2017."value" * 100) AS "expenditure_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2017 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2018 
ON 
  h2017."country_code" = h2018."country_code" 
  AND h2017."indicator_name" = h2018."indicator_name" 
WHERE 
  h2017."indicator_name" ILIKE '%health expenditure per capita%' 
  AND h2017."year" = 2017 
  AND h2018."year" = 2018 
  AND ((h2018."value" - h2017."value") / h2017."value" * 100) > 1 
LIMIT 100;
Results:
country_code,country_name,expenditure_growth_percent
COM,Comoros,2.704599883946007
ECU,Ecuador,3.2800841295102363
EGY,"Egypt, Arab Rep.",10.151308182601175
EAR,Early-demographic dividend,1.155713263926843
ECS,Europe & Central Asia,6.315958531481322
ECA,Europe & Central Asia (excluding high income),7.204988748194199
ECA,Europe & Central Asia (excluding high income),1.307617289451415
ECA,Europe & Central Asia (excluding high income),3.0831578255986316
KHM,Cambodia,27.608642338764593
CRI,Costa Rica,4.011392070167483
DMA,Dominica,43.568254744429055
FSM,"Micronesia, Fed. Sts.",5.426645173041243
NGA,Nigeria,5.373821440597682
NOR,Norway,3.217734161344436
EAP,East Asia & Pacific (excluding high income),10.500331778387803
ERI,Eritrea,12.341794939106707
ERI,Eritrea,23.472064126363087
CAF,Central African Republic,78.99886135733063
CUB,Cuba,5.078887537202116
MNG,Mongolia,1.3580223967446232
NAM,Namibia,1.2484084872433439
MKD,North Macedonia,12.067379177670121
NOR,Norway,3.9817965774012976
EAS,East Asia & Pacific,8.49430560620561
EMU,Euro area,2.907887921511555
DNK,Denmark,4.595794935672975
DOM,Dominican Republic,6.930425878309028
NZL,New Zealand,8.179795596082402
NGA,Nigeria,4.513946222424116
CEB,Central Europe and the Baltics,6.419767814704741
TEC,Europe & Central Asia (IDA & IBRD countries),1.1174068724290598
LTE,Late-demographic dividend,8.044979325582585
GNQ,Equatorial Guinea,6.9405669076699965
FIN,Finland,3.418657288261298
EST,Estonia,14.71827781377726
FIN,Finland,50.53297787519253
FIN,Finland,44.93860054660787
GAB,Gabon,99.72938060797001
GHA,Ghana,3.491297734154604
GRC,Greece,2.5847274907399687
GRD,Grenada,1.4163346936077668
ETH,Ethiopia,4.247894448915844
HTI,Haiti,11.637676720704606
ROU,Romania,25.54411303079491
LMY,Low & middle income,4.484701964939276
SLV,El Salvador,48.29590334021748
RUS,Russian Federation,9.418493604499975
SLE,Sierra Leone,22.03381262077821
HTI,Haiti,6.495807941506326
PRT,Portugal,10.815947294122953
ROU,Romania,9.298564039513408
SYC,Seychelles,7.099590971637772
KEN,Kenya,12.329293462325758
PRY,Paraguay,12.208367489718519
POL,Poland,1.8521743750267778
RWA,Rwanda,14.015732010237942
STP,Sao Tome and Principe,2.3602247036709856
HND,Honduras,4.600423764734833
ISL,Iceland,7.55294393976271
IND,India,5.491100207050945
IDN,Indonesia,6.520882793655053
IRQ,Iraq,500.1239401149893
ITA,Italy,6.3805049067046395
JPN,Japan,2.519329931211128
OED,OECD members,9.47774945932083
OSS,Other small states,4.407689620475733
PSS,Pacific island small states,4.059565071816022
PRE,Pre-demographic dividend,1.9144433133316132
MIC,Middle income,6.101815985663521
LVA,Latvia,11.059932009164918
MWI,Malawi,10.323664927064353
MWI,Malawi,4.356368490537546
MLI,Mali,7.108581210210809
MLT,Malta,1.0747488529228943
LSO,Lesotho,41.646993002464264
MRT,Mauritania,7.427916630960231
MRT,Mauritania,15.000152222928984
ZAF,South Africa,2.8533569304420463
LKA,Sri Lanka,3.803653566530511
KNA,St. Kitts and Nevis,3.6027033386902767
MYS,Malaysia,10.757405469652564
MDV,Maldives,1177.7244767638965
ZAF,South Africa,5.81632072824824
ZAF,South Africa,5.048564342677041
ESP,Spain,8.47043541460996
ATG,Antigua and Barbuda,10.299268289062342
LTU,Lithuania,5.234118635826519
MLT,Malta,6.17160468137759
TKM,Turkmenistan,361.34509457576473
GBR,United Kingdom,7.267799380236882
USA,United States,4.385659625788704
DNK,Denmark,7.182840430675137
DJI,Djibouti,10.811769025700805
NGA,Nigeria,10.450080317777717
EMU,Euro area,2.789134976903903
SLV,El Salvador,2.964830670326677
SLV,El Salvador,47.579120842280055
GNQ,Equatorial Guinea,6.257701875486288
GHA,Ghana,13.178566497874536
STP,Sao Tome and Principe,8.90972860074675

2025-02-11 01:59:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:59:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:59:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:59:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:59:06 - snowflake.connector.connection - INFO - closed
2025-02-11 01:59:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:07 - root - INFO - SQL:
SELECT 
  "country_code", 
  "country_name", 
  "value" AS "health_expenditure_2018" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2018 
LIMIT 100;
Results:
country_code,country_name,health_expenditure_2018
BWA,Botswana,374.17907715
UKR,Ukraine,2.30205011
URY,Uruguay,429.58023071
COM,Comoros,65.22776031
COM,Comoros,102.36206055
COD,"Congo, Dem. Rep.",2.79114175
CRI,Costa Rica,0.05650612
DMA,Dominica,9.2956562
DOM,Dominican Republic,4.37877226
MCO,Monaco,2968.50048828
PLW,Palau,2011.51733398
PLW,Palau,662.62835693
EMU,Euro area,1067.83582859016
TEC,Europe & Central Asia (IDA & IBRD countries),170.921351224296
EUU,European Union,1088.35658972773
HIC,High income,0.624952150180451
LCN,Latin America & Caribbean,1.54613119374784
FRA,France,4690.07226563
DEU,Germany,5472.20214844
GHA,Ghana,167.97952271
PER,Peru,137.32307434
RWA,Rwanda,58.30852127
SLE,Sierra Leone,55.24813843
HND,Honduras,176.24726868
LAO,Lao PDR,81.64137268
LMC,Lower middle income,59.7275955701677
UMC,Upper middle income,0.690429319312342
AFG,Afghanistan,8.19657612
ATG,Antigua and Barbuda,485.82119751
MLI,Mali,32.36968613
MHL,Marshall Islands,98.64823151
MRT,Mauritania,30.77950668
TLS,Timor-Leste,10.6438303
BHR,Bahrain,994.17901611
BRB,Barbados,14.29946041
BEL,Belgium,5404.91601563
BEN,Benin,41.7741394
BIH,Bosnia and Herzegovina,376.87268066
BDI,Burundi,24.02547073
VEN,"Venezuela, RB",199.89640808
TCD,Chad,4.57267809
MUS,Mauritius,368.16949463
NRU,Nauru,49.04381943
HPC,Heavily indebted poor countries (HIPC),13.9419707895972
HPC,Heavily indebted poor countries (HIPC),37.5276060436454
LTE,Late-demographic dividend,239.558049325612
GRC,Greece,750.99975586
GRD,Grenada,22.30875015
PNG,Papua New Guinea,12.88847256
PRT,Portugal,1361.25512695
STP,Sao Tome and Principe,55.12792206
SEN,Senegal,58.90360641
HND,Honduras,145.84317017
IRQ,Iraq,367.75228882
ISR,Israel,3323.65063477
KIR,Kiribati,196.84797668
TSA,South Asia (IDA & IBRD),177.637906691198
SSA,Sub-Saharan Africa (excluding high income),30.192121784093
TSS,Sub-Saharan Africa (IDA & IBRD countries),83.2490352335023
ALB,Albania,274.91409302
AND,Andorra,2821.80126953
ATG,Antigua and Barbuda,0.78491873
MRT,Mauritania,190.13778687
LKA,Sri Lanka,3.52529263
SDN,Sudan,22.31403923
SUR,Suriname,474.1265564
BHS,"Bahamas, The",2005.24621582
BGD,Bangladesh,7.14773178
BRN,Brunei Darussalam,94.87831879
UKR,Ukraine,228.39007568
GBR,United Kingdom,3392.0859375
GBR,United Kingdom,922.77746582
CHL,Chile,1.0
ROU,Romania,1.0
SMR,San Marino,1.0
KWT,Kuwait,1.0
BEL,Belgium,1.0
COL,Colombia,1.0
DNK,Denmark,1.0
SWE,Sweden,1.0
CAN,Canada,1.0
MNE,Montenegro,1.0
NOR,Norway,1.0
JPN,Japan,1.0
SVK,Slovak Republic,1.0
NAC,North America,1.0
BGR,Bulgaria,1.0
DNK,Denmark,1.0
MCO,Monaco,1.0
QAT,Qatar,1.0
RUS,Russian Federation,1.0
CZE,Czech Republic,1.0
BGR,Bulgaria,1.0
HUN,Hungary,1.0
SVN,Slovenia,1.0
HUN,Hungary,1.0
AND,Andorra,1.0
OMN,Oman,1.0
ESP,Spain,1.0
ARE,United Arab Emirates,1.0

2025-02-11 01:59:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:59:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:59:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:59:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 01:59:08 - snowflake.connector.connection - INFO - closed
2025-02-11 01:59:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:08 - root - INFO - SQL:
SELECT DISTINCT 
  "indicator_code", 
  "indicator_name" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
LIMIT 100;
Results:
indicator_code,indicator_name
SH.XPD.CHEX.PC.CD,Current health expenditure per capita (current US$)
SH.XPD.PVTD.PP.CD,"Domestic private health expenditure per capita, PPP  (current international $)"
SH.XPD.EHEX.PP.CD,"External health expenditure per capita, PPP (current international $)"
SH.XPD.PVTD.PC.CD,Domestic private health expenditure per capita (current US$)
SH.XPD.GHED.PC.CD,Domestic general government health expenditure per capita (current US$)
SH.XPD.CHEX.PP.CD,"Current health expenditure per capita, PPP (current international $)"
SH.XPD.GHED.PP.CD,"Domestic general government health expenditure per capita, PPP (current international $)"
SH.XPD.EHEX.PC.CD,External health expenditure per capita (current US$)

2025-02-11 01:59:08 - root - INFO - itercount: 0
2025-02-11 01:59:08 - root - INFO - Database Name: WORLD_BANK
Schema Name: WORLD_BANK_GLOBAL_POPULATION
,0
table_name,POPULATION_BY_COUNTRY
description,
DDL,"create or replace TABLE POPULATION_BY_COUNTRY (
	""country"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""year_1960"" NUMBER(38,0),
	""year_1961"" NUMBER(38,0),
	""year_1962"" NUMBER(38,0),
	""year_1963"" NUMBER(38,0),
	""year_1964"" NUMBER(38,0),
	""year_1965"" NUMBER(38,0),
	""year_1966"" NUMBER(38,0),
	""year_1967"" NUMBER(38,0),
	""year_1968"" NUMBER(38,0),
	""year_1969"" NUMBER(38,0),
	""year_1970"" NUMBER(38,0),
	""year_1971"" NUMBER(38,0),
	""year_1972"" NUMBER(38,0),
	""year_1973"" NUMBER(38,0),
	""year_1974"" NUMBER(38,0),
	""year_1975"" NUMBER(38,0),
	""year_1976"" NUMBER(38,0),
	""year_1977"" NUMBER(38,0),
	""year_1978"" NUMBER(38,0),
	""year_1979"" NUMBER(38,0),
	""year_1980"" NUMBER(38,0),
	""year_1981"" NUMBER(38,0),
	""year_1982"" NUMBER(38,0),
	""year_1983"" NUMBER(38,0),
	""year_1984"" NUMBER(38,0),
	""year_1985"" NUMBER(38,0),
	""year_1986"" NUMBER(38,0),
	""year_1987"" NUMBER(38,0),
	""year_1988"" NUMBER(38,0),
	""year_1989"" NUMBER(38,0),
	""year_1990"" NUMBER(38,0),
	""year_1991"" NUMBER(38,0),
	""year_1992"" NUMBER(38,0),
	""year_1993"" NUMBER(38,0),
	""year_1994"" NUMBER(38,0),
	""year_1995"" NUMBER(38,0),
	""year_1996"" NUMBER(38,0),
	""year_1997"" NUMBER(38,0),
	""year_1998"" NUMBER(38,0),
	""year_1999"" NUMBER(38,0),
	""year_2000"" NUMBER(38,0),
	""year_2001"" NUMBER(38,0),
	""year_2002"" NUMBER(38,0),
	""year_2003"" NUMBER(38,0),
	""year_2004"" NUMBER(38,0),
	""year_2005"" NUMBER(38,0),
	""year_2006"" NUMBER(38,0),
	""year_2007"" NUMBER(38,0),
	""year_2008"" NUMBER(38,0),
	""year_2009"" NUMBER(38,0),
	""year_2010"" NUMBER(38,0),
	""year_2011"" NUMBER(38,0),
	""year_2012"" NUMBER(38,0),
	""year_2013"" NUMBER(38,0),
	""year_2014"" NUMBER(38,0),
	""year_2015"" NUMBER(38,0),
	""year_2016"" NUMBER(38,0),
	""year_2017"" NUMBER(38,0),
	""year_2018"" NUMBER(38,0),
	""year_2019"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,0
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,1
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,2
table_name,HEALTH_NUTRITION_POPULATION
description,
DDL,"create or replace TABLE HEALTH_NUTRITION_POPULATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" NUMBER(38,0),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_Income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,1
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,2
table_name,INTERNATIONAL_DEBT
description,
DDL,"create or replace TABLE INTERNATIONAL_DEBT (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_two_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,1
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,2
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,3
table_name,INTERNATIONAL_EDUCATION
description,
DDL,"create or replace TABLE INTERNATIONAL_EDUCATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" VARCHAR(16777216),
	""latest_trade_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,1
table_name,SERIES_TIME
description,
DDL,"create or replace TABLE SERIES_TIME (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,2
table_name,INDICATORS_DATA
description,
DDL,"create or replace TABLE INDICATORS_DATA (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,3
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,4
table_name,FOOTNOTES
description,
DDL,"create or replace TABLE FOOTNOTES (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,5
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SUMMARY', 'SERIES_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_EDUCATION'], 'WORLD_BANK_WDI': ['COUNTRY_SUMMARY', 'SERIES_TIME', 'INDICATORS_DATA', 'COUNTRY_SERIES_DEFINITIONS', 'FOOTNOTES', 'SERIES_SUMMARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table**: `"WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"`
   - `"country"`: Used to identify the country by name.
   - `"country_code"`: Used as a unique identifier for each country and for joining tables.
   - `"year_2017"`: Total population of each country in 2017; used to calculate population growth.
   - `"year_2018"`: Total population of each country in 2018; used to calculate population growth.

2. **Table**: `"WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"`
   - `"country_name"`: Used to identify the country by name.
   - `"country_code"`: Used as a unique identifier for each country and for joining tables.
   - `"indicator_name"`: Used to filter records for "per capita current health expenditure (PPP)".
   - `"indicator_code"`: May be used if the specific code for the indicator is known.
   - `"value"`: Represents the per capita health expenditure value; used to calculate growth.
   - `"year"`: Indicates the year of the recorded value; used to filter for 2017 and 2018.

**Conditions that may be used:**

- **Filtering by Indicator Name**: Use `"indicator_name" ILIKE '%health expenditure per capita%'` to select the relevant health expenditure indicator.
- **Filtering by Year**: Use `"year" = 2017` and `"year" = 2018` to retrieve data for the specific years needed.
- **Calculating Growth**: Compare values from 2017 to 2018 to calculate the percentage increase.
- **Joining Tables**: Use `"country_code"` to join population and health expenditure tables for consistent country data.

---

**Sample SQL Queries:**

Below are 10 different SQL queries to explore and understand the relevant data.

---

**Query 1: Retrieve countries and their populations for 2017 and 2018.**

```sql
SELECT 
  "country", 
  "country_code", 
  "year_2017", 
  "year_2018" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" 
LIMIT 100;
```

---

**Query 2: List distinct indicator names related to health expenditure per capita.**

```sql
SELECT DISTINCT 
  "indicator_name" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
LIMIT 100;
```

---

**Query 3: Get health expenditure values for all countries in 2017.**

```sql
SELECT 
  "country_code", 
  "country_name", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2017 
LIMIT 100;
```

---

**Query 4: Get health expenditure values for all countries in 2018.**

```sql
SELECT 
  "country_code", 
  "country_name", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2018 
LIMIT 100;
```

---

**Query 5: Find countries with more than 1% population growth from 2017 to 2018.**

```sql
SELECT 
  "country", 
  "country_code", 
  (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) AS "population_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" 
WHERE 
  (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) > 1 
LIMIT 100;
```

---

**Query 6: Retrieve health expenditure data for both 2017 and 2018 for each country.**

```sql
SELECT 
  "country_code", 
  "country_name", 
  "year", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" IN (2017, 2018) 
ORDER BY 
  "country_code", 
  "year" 
LIMIT 100;
```

---

**Query 7: List countries present in both datasets using country codes.**

```sql
SELECT DISTINCT 
  p."country_code", 
  p."country" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" h 
ON 
  p."country_code" = h."country_code" 
LIMIT 100;
```

---

**Query 8: Identify countries with over 1% increase in health expenditure from 2017 to 2018.**

```sql
SELECT 
  "country_code", 
  "country_name", 
  (( h2018."value" - h2017."value" ) / h2017."value" * 100 ) AS "expenditure_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" h2017 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" h2018 
ON 
  h2017."country_code" = h2018."country_code" 
  AND h2017."indicator_name" = h2018."indicator_name" 
WHERE 
  h2017."indicator_name" ILIKE '%health expenditure per capita%' 
  AND h2017."year" = 2017 
  AND h2018."year" = 2018 
  AND (( h2018."value" - h2017."value" ) / h2017."value" * 100 ) > 1 
LIMIT 100;
```

---

**Query 9: Get the list of all countries and their total health expenditure per capita in 2018.**

```sql
SELECT 
  "country_code", 
  "country_name", 
  "value" AS "health_expenditure_2018" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2018 
LIMIT 100;
```

---

**Query 10: Retrieve the indicator codes related to health expenditure per capita for validation.**

```sql
SELECT DISTINCT 
  "indicator_code", 
  "indicator_name" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
LIMIT 100;
```

---

These queries help in understanding the structure and content of the relevant tables and columns needed to address the task. By exploring the data with these queries, you can identify the necessary information to calculate the number of countries that experienced an increase of more than 1% in both their total population and per capita current health expenditure (PPP) from 2017 to 2018.Query:
SELECT 
  "country", 
  "country_code", 
  "year_2017", 
  "year_2018" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" 
LIMIT 100;
Answer:
country,country_code,year_2017,year_2018
Sint Maarten (Dutch part),SXM,40574.0,40654.0
Not classified,INX,,
West Bank and Gaza,PSE,4454805.0,4569087.0
Serbia,SRB,7020858.0,6982084.0
Cambodia,KHM,16009414.0,16249798.0
United Arab Emirates,ARE,9487203.0,9630959.0
Cyprus,CYP,1179680.0,1189265.0
Lower middle income,LMC,2981420591.0,3022905169.0
Maldives,MDV,496402.0,515696.0
Low income,LIC,687449530.0,705417321.0
Peru,PER,31444297.0,31989256.0
Early-demographic dividend,EAR,3207188541.0,3249140605.0
Fiji,FJI,877459.0,883483.0
Chad,TCD,15016773.0,15477751.0
Middle East & North Africa (excluding high income),MNA,376546755.0,382896715.0
Middle East & North Africa (IDA & IBRD countries),TMN,372091950.0,378327628.0
World,WLD,7510990456.0,7594270356.0
Saudi Arabia,SAU,33099147.0,33699947.0
Dominican Republic,DOM,10513131.0,10627165.0
Kenya,KEN,50221473.0,51393010.0
"Venezuela, RB",VEN,29390409.0,28870195.0
Canada,CAN,36540268.0,37058856.0
Guinea,GIN,12067539.0,12414318.0
Pakistan,PAK,207896686.0,212215030.0
Latvia,LVA,1942248.0,1926542.0
Denmark,DNK,5764980.0,5797446.0
"Hong Kong SAR, China",HKG,7391700.0,7451000.0
Nauru,NRU,12876.0,12704.0
Qatar,QAT,2724724.0,2781677.0
United States,USA,325147121.0,327167434.0
Europe & Central Asia (IDA & IBRD countries),TEC,457810292.0,459865205.0
Brazil,BRA,207833831.0,209469333.0
Nigeria,NGA,190873311.0,195874740.0
"Yemen, Rep.",YEM,27834821.0,28498687.0
North Macedonia,MKD,2081996.0,2082958.0
Namibia,NAM,2402603.0,2448255.0
Rwanda,RWA,11980937.0,12301939.0
Least developed countries: UN classification,LDC,986365080.0,1009662578.0
Central Europe and the Baltics,CEB,102738854.0,102511922.0
Cabo Verde,CPV,537497.0,543767.0
Brunei Darussalam,BRN,424473.0,428962.0
Philippines,PHL,105173264.0,106651922.0
Palau,PLW,17808.0,17907.0
Sri Lanka,LKA,21444000.0,21670000.0
Sao Tome and Principe,STP,207089.0,211028.0
Haiti,HTI,10982366.0,11123176.0
Pacific island small states,PSS,2422086.0,2457367.0
China,CHN,1386395000.0,1392730000.0
Germany,DEU,82657002.0,82927922.0
St. Martin (French part),MAF,36560.0,37264.0
Faroe Islands,FRO,48331.0,48497.0
Norway,NOR,5276968.0,5314336.0
Small states,SST,39885876.0,40575321.0
Ireland,IRL,4807388.0,4853506.0
Tanzania,TZA,54663906.0,56318348.0
Bhutan,BTN,745568.0,754394.0
Kosovo,XKX,1830700.0,1845300.0
Zambia,ZMB,16853688.0,17351822.0
Europe & Central Asia (excluding high income),ECA,415710935.0,417797257.0
Isle of Man,IMN,83598.0,84077.0
Guatemala,GTM,16914936.0,17247807.0
Oman,OMN,4665935.0,4829483.0
Tunisia,TUN,11433443.0,11565204.0
Singapore,SGP,5612253.0,5638676.0
South Africa,ZAF,57000451.0,57779622.0
Finland,FIN,5508214.0,5518050.0
Montenegro,MNE,622373.0,622345.0
Pre-demographic dividend,PRE,894512725.0,919485393.0
Bosnia and Herzegovina,BIH,3351527.0,3323929.0
Sierra Leone,SLE,7488431.0,7650154.0
Barbados,BRB,286233.0,286641.0
Middle East & North Africa,MEA,441255234.0,448912859.0
East Asia & Pacific (IDA & IBRD countries),TEA,2042687863.0,2056064424.0
Marshall Islands,MHL,58058.0,58413.0
San Marino,SMR,33671.0,33785.0
Syrian Arab Republic,SYR,17068002.0,16906283.0
Nicaragua,NIC,6384855.0,6465513.0
Poland,POL,37974826.0,37978548.0
Fragile and conflict affected situations,FCS,504119229.0,515215936.0
Grenada,GRD,110874.0,111454.0
Slovenia,SVN,2066388.0,2067372.0
St. Vincent and the Grenadines,VCT,109827.0,110210.0
Mexico,MEX,124777324.0,126190788.0
Morocco,MAR,35581294.0,36029138.0
Angola,AGO,29816748.0,30809762.0
Samoa,WSM,195352.0,196130.0
Cameroon,CMR,24566045.0,25216237.0
Thailand,THA,69209858.0,69428524.0
Vietnam,VNM,94596642.0,95540395.0
Solomon Islands,SLB,636038.0,652858.0
Japan,JPN,126785797.0,126529100.0
Niger,NER,21602472.0,22442948.0
Senegal,SEN,15419381.0,15854360.0
Costa Rica,CRI,4949954.0,4999441.0
Albania,ALB,2873457.0,2866376.0
St. Lucia,LCA,180955.0,181889.0
Andorra,AND,77001.0,77006.0
South Asia (IDA & IBRD),TSA,1792835608.0,1814388744.0
South Asia,SAS,1792835608.0,1814388744.0
South Sudan,SSD,10910759.0,10975920.0
Query:
SELECT DISTINCT 
  "indicator_name" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
LIMIT 100;
Answer:
indicator_name
Current health expenditure per capita (current US$)
Domestic general government health expenditure per capita (current US$)
External health expenditure per capita (current US$)
"External health expenditure per capita, PPP (current international $)"
Domestic private health expenditure per capita (current US$)
"Current health expenditure per capita, PPP (current international $)"
"Domestic private health expenditure per capita, PPP  (current international $)"
"Domestic general government health expenditure per capita, PPP (current international $)"
Query:
SELECT 
  "country_code", 
  "country_name", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2017 
LIMIT 100;
Answer:
country_code,country_name,value
BFA,Burkina Faso,49.92856979
TKM,Turkmenistan,1.24862432
GBR,United Kingdom,3162.25927734
USA,United States,5130.76904297
VEN,"Venezuela, RB",314.00161743
COM,Comoros,6.83181143
DNK,Denmark,5800.15283203
DJI,Djibouti,37.25012207
NAM,Namibia,428.04586792
NGA,Nigeria,31.36062241
ARB,Arab World,391.382333336795
EMU,Euro area,4572.35296577739
LIC,Low income,22.5202464460893
SLV,El Salvador,367.32601929
SLV,El Salvador,0.39850688
GNQ,Equatorial Guinea,230.1509552
FIN,Finland,954.11553955
GHA,Ghana,148.41990662
STP,Sao Tome and Principe,18.79934502
JAM,Jamaica,364.89474487
KEN,Kenya,31.56469345
LMC,Lower middle income,2.54079486080698
OSS,Other small states,213.630898359584
PSS,Pacific island small states,41.8611576931166
PST,Post-demographic dividend,5924.10963361332
SSF,Sub-Saharan Africa,10.109787360296
TSS,Sub-Saharan Africa (IDA & IBRD countries),10.109787360296
AFG,Afghanistan,44.31379318
AND,Andorra,1789.86120605
MLI,Mali,31.34018135
MHL,Marshall Islands,587.55316162
SSD,South Sudan,147.8605957
SDN,Sudan,192.60665894
SDN,Sudan,311.76040649
TJK,Tajikistan,58.16766357
TON,Tonga,46.62133408
AZE,Azerbaijan,112.46528625
BHS,"Bahamas, The",1208.62634277
BRB,Barbados,23.14829445
BTN,Bhutan,35.13426208
COL,Colombia,1114.09619141
DJI,Djibouti,33.54146957
DJI,Djibouti,18.67774773
MUS,Mauritius,548.3939209
MCO,Monaco,2402.81103516
MNG,Mongolia,14.52910423
MAR,Morocco,0.35790461
NPL,Nepal,11.35226917
NPL,Nepal,31.71228981
NLD,Netherlands,5498.88183594
NGA,Nigeria,10.48568821
ECS,Europe & Central Asia,2872.69957547778
HPC,Heavily indebted poor countries (HIPC),27.6323624559571
LAC,Latin America & Caribbean (excluding high income),1.95186507485968
SWZ,Eswatini,180.67512512
HTI,Haiti,62.72842407
SMR,San Marino,3287.47387695
IRN,"Iran, Islamic Rep.",1758.99145508
MNA,Middle East & North Africa (excluding high income),506.622808713069
TMN,Middle East & North Africa (IDA & IBRD countries),3.51979744563623
PST,Post-demographic dividend,0.293871900441022
WLD,World,583.729041807838
ALB,Albania,4.65915346
DZA,Algeria,639.97625732
THA,Thailand,525.81530762
TLS,Timor-Leste,321.57449341
BHR,Bahrain,950.96466064
BRA,Brazil,391.69564819
UGA,Uganda,41.95800781
ARE,United Arab Emirates,1661.46777344
SVN,Slovenia,1.0
SGP,Singapore,1.0
AUS,Australia,1.0
AUT,Austria,1.0
USA,United States,1.0
NZL,New Zealand,1.0
DNK,Denmark,1.0
FRA,France,1.0
NAC,North America,1.0
USA,United States,1.0
CAN,Canada,1.0
ARE,United Arab Emirates,1.0
RUS,Russian Federation,1.0
TTO,Trinidad and Tobago,1.0
OMN,Oman,1.0
BGR,Bulgaria,1.0
CAN,Canada,1.0
SWE,Sweden,1.0
MEX,Mexico,1.0
CHE,Switzerland,1.0
SVK,Slovak Republic,1.0
BRN,Brunei Darussalam,1.0
CZE,Czech Republic,1.0
MCO,Monaco,1.0
HUN,Hungary,1.0
KWT,Kuwait,1.0
SVN,Slovenia,1.0
IRL,Ireland,1.0
CHE,Switzerland,1.0
AUT,Austria,1.0
Query:
SELECT 
  "country_code", 
  "country_name", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2018 
LIMIT 100;
Answer:
country_code,country_name,value
BWA,Botswana,374.17907715
UKR,Ukraine,2.30205011
URY,Uruguay,429.58023071
COM,Comoros,65.22776031
COM,Comoros,102.36206055
COD,"Congo, Dem. Rep.",2.79114175
CRI,Costa Rica,0.05650612
DMA,Dominica,9.2956562
DOM,Dominican Republic,4.37877226
MCO,Monaco,2968.50048828
PLW,Palau,2011.51733398
PLW,Palau,662.62835693
EMU,Euro area,1067.83582859016
TEC,Europe & Central Asia (IDA & IBRD countries),170.921351224296
EUU,European Union,1088.35658972773
HIC,High income,0.624952150180451
LCN,Latin America & Caribbean,1.54613119374784
FRA,France,4690.07226563
DEU,Germany,5472.20214844
GHA,Ghana,167.97952271
PER,Peru,137.32307434
RWA,Rwanda,58.30852127
SLE,Sierra Leone,55.24813843
HND,Honduras,176.24726868
LAO,Lao PDR,81.64137268
LMC,Lower middle income,59.7275955701677
UMC,Upper middle income,0.690429319312342
AFG,Afghanistan,8.19657612
ATG,Antigua and Barbuda,485.82119751
MLI,Mali,32.36968613
MHL,Marshall Islands,98.64823151
MRT,Mauritania,30.77950668
TLS,Timor-Leste,10.6438303
BHR,Bahrain,994.17901611
BRB,Barbados,14.29946041
BEL,Belgium,5404.91601563
BEN,Benin,41.7741394
BIH,Bosnia and Herzegovina,376.87268066
BDI,Burundi,24.02547073
VEN,"Venezuela, RB",199.89640808
TCD,Chad,4.57267809
MUS,Mauritius,368.16949463
NRU,Nauru,49.04381943
HPC,Heavily indebted poor countries (HIPC),13.9419707895972
HPC,Heavily indebted poor countries (HIPC),37.5276060436454
LTE,Late-demographic dividend,239.558049325612
GRC,Greece,750.99975586
GRD,Grenada,22.30875015
PNG,Papua New Guinea,12.88847256
PRT,Portugal,1361.25512695
STP,Sao Tome and Principe,55.12792206
SEN,Senegal,58.90360641
HND,Honduras,145.84317017
IRQ,Iraq,367.75228882
ISR,Israel,3323.65063477
KIR,Kiribati,196.84797668
TSA,South Asia (IDA & IBRD),177.637906691198
SSA,Sub-Saharan Africa (excluding high income),30.192121784093
TSS,Sub-Saharan Africa (IDA & IBRD countries),83.2490352335023
ALB,Albania,274.91409302
AND,Andorra,2821.80126953
ATG,Antigua and Barbuda,0.78491873
MRT,Mauritania,190.13778687
LKA,Sri Lanka,3.52529263
SDN,Sudan,22.31403923
SUR,Suriname,474.1265564
BHS,"Bahamas, The",2005.24621582
BGD,Bangladesh,7.14773178
BRN,Brunei Darussalam,94.87831879
UKR,Ukraine,228.39007568
GBR,United Kingdom,3392.0859375
GBR,United Kingdom,922.77746582
CHL,Chile,1.0
ROU,Romania,1.0
SMR,San Marino,1.0
KWT,Kuwait,1.0
BEL,Belgium,1.0
COL,Colombia,1.0
DNK,Denmark,1.0
SWE,Sweden,1.0
CAN,Canada,1.0
MNE,Montenegro,1.0
NOR,Norway,1.0
JPN,Japan,1.0
SVK,Slovak Republic,1.0
NAC,North America,1.0
BGR,Bulgaria,1.0
DNK,Denmark,1.0
MCO,Monaco,1.0
QAT,Qatar,1.0
RUS,Russian Federation,1.0
CZE,Czech Republic,1.0
BGR,Bulgaria,1.0
HUN,Hungary,1.0
SVN,Slovenia,1.0
HUN,Hungary,1.0
AND,Andorra,1.0
OMN,Oman,1.0
ESP,Spain,1.0
ARE,United Arab Emirates,1.0
Query:
SELECT 
  "country", 
  "country_code", 
  (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) AS "population_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" 
WHERE 
  (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) > 1 
LIMIT 100;
Answer:
country,country_code,population_growth_percent
West Bank and Gaza,PSE,2.565400
Cambodia,KHM,1.501500
United Arab Emirates,ARE,1.515300
Lower middle income,LMC,1.391400
Maldives,MDV,3.886800
Low income,LIC,2.613700
Peru,PER,1.733100
Early-demographic dividend,EAR,1.308100
Chad,TCD,3.069800
Middle East & North Africa (excluding high income),MNA,1.686400
Middle East & North Africa (IDA & IBRD countries),TMN,1.675800
World,WLD,1.108800
Saudi Arabia,SAU,1.815200
Dominican Republic,DOM,1.084700
Kenya,KEN,2.332700
Canada,CAN,1.419200
Guinea,GIN,2.873700
Pakistan,PAK,2.077200
Qatar,QAT,2.090200
Nigeria,NGA,2.620300
"Yemen, Rep.",YEM,2.385000
Namibia,NAM,1.900100
Rwanda,RWA,2.679300
Least developed countries: UN classification,LDC,2.362000
Cabo Verde,CPV,1.166500
Brunei Darussalam,BRN,1.057500
Philippines,PHL,1.405900
Sri Lanka,LKA,1.053900
Sao Tome and Principe,STP,1.902100
Haiti,HTI,1.282100
Pacific island small states,PSS,1.456600
St. Martin (French part),MAF,1.925600
Small states,SST,1.728500
Tanzania,TZA,3.026600
Bhutan,BTN,1.183800
Zambia,ZMB,2.955600
Guatemala,GTM,1.967900
Oman,OMN,3.505100
Tunisia,TUN,1.152400
South Africa,ZAF,1.367000
Pre-demographic dividend,PRE,2.791800
Sierra Leone,SLE,2.159600
Middle East & North Africa,MEA,1.735400
Nicaragua,NIC,1.263300
Fragile and conflict affected situations,FCS,2.201200
Mexico,MEX,1.132800
Morocco,MAR,1.258700
Angola,AGO,3.330400
Cameroon,CMR,2.646700
Solomon Islands,SLB,2.644500
Niger,NER,3.890600
Senegal,SEN,2.821000
South Asia (IDA & IBRD),TSA,1.202200
South Asia,SAS,1.202200
Equatorial Guinea,GNQ,3.722100
Honduras,HND,1.681100
IDA & IBRD total,IBT,1.223100
Burkina Faso,BFA,2.908600
Channel Islands,CHI,1.087400
Burundi,BDI,3.217400
Afghanistan,AFG,2.413400
Madagascar,MDG,2.705600
Ethiopia,ETH,2.654600
Paraguay,PRY,1.296200
"Macao SAR, China",MAC,1.453800
Mongolia,MNG,1.812200
Other small states,OSS,2.023900
Luxembourg,LUX,1.910300
Mali,MLI,3.053600
Arab World,ARB,1.915900
Bahrain,BHR,5.044300
"Congo, Dem. Rep.",COD,3.279300
Colombia,COL,1.528800
Australia,AUS,1.587300
Chile,CHL,1.400700
Somalia,SOM,2.872200
Benin,BEN,2.772600
IDA total,IDA,2.264400
Tajikistan,TJK,2.483800
Tonga,TON,1.175500
Kyrgyz Republic,KGZ,1.897300
"Congo, Rep.",COG,2.615300
Middle income,MIC,1.057600
Comoros,COM,2.264400
Malta,MLT,3.318600
New Caledonia,NCL,1.323300
Low & middle income,LMY,1.227300
Indonesia,IDN,1.140200
Iraq,IRQ,2.345500
Belize,BLZ,1.943200
Timor-Leste,TLS,1.987600
Zimbabwe,ZWE,1.420800
Sudan,SDN,2.421100
Ecuador,ECU,1.781300
Djibouti,DJI,1.570100
Cayman Islands,CYM,1.249600
Turkmenistan,TKM,1.619400
Malaysia,MYS,1.361700
"Egypt, Arab Rep.",EGY,2.054100
Turks and Caicos Islands,TCA,1.481900
Query:
SELECT 
  "country_code", 
  "country_name", 
  "year", 
  "value" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" IN (2017, 2018) 
ORDER BY 
  "country_code", 
  "year" 
LIMIT 100;
Answer:
country_code,country_name,year,value
AFE,Africa Eastern and Southern,2017,92.8108974560942
AFE,Africa Eastern and Southern,2017,12.1805265384115
AFE,Africa Eastern and Southern,2017,45.8521240340281
AFE,Africa Eastern and Southern,2017,42.0128413737966
AFE,Africa Eastern and Southern,2017,96.1377734894616
AFE,Africa Eastern and Southern,2017,100.045491564991
AFE,Africa Eastern and Southern,2017,220.974858439749
AFE,Africa Eastern and Southern,2017,32.026190816976
AFE,Africa Eastern and Southern,2018,32.7685270624819
AFE,Africa Eastern and Southern,2018,12.1599095499043
AFE,Africa Eastern and Southern,2018,223.831853386522
AFE,Africa Eastern and Southern,2018,41.730514799049
AFE,Africa Eastern and Southern,2018,40.352413993896
AFE,Africa Eastern and Southern,2018,94.8877514685813
AFE,Africa Eastern and Southern,2018,94.2428382114765
AFE,Africa Eastern and Southern,2018,96.1755810685664
AFG,Afghanistan,2017,3.34825993
AFG,Afghanistan,2017,12.76019955
AFG,Afghanistan,2017,172.24311829
AFG,Afghanistan,2017,11.62788296
AFG,Afghanistan,2017,65.70602417
AFG,Afghanistan,2017,228.18478394
AFG,Afghanistan,2017,49.59756851
AFG,Afghanistan,2017,44.31379318
AFG,Afghanistan,2018,49.84260941
AFG,Afghanistan,2018,39.06802368
AFG,Afghanistan,2018,2.57800722
AFG,Afghanistan,2018,30.65452385
AFG,Afghanistan,2018,146.11122131
AFG,Afghanistan,2018,186.4072876
AFG,Afghanistan,2018,8.19657612
AFG,Afghanistan,2018,9.64153671
AFW,Africa Western and Central,2017,19.7056497252775
AFW,Africa Western and Central,2017,61.306286786352
AFW,Africa Western and Central,2017,41.9853160825962
AFW,Africa Western and Central,2017,33.5749452151388
AFW,Africa Western and Central,2017,172.544544804834
AFW,Africa Western and Central,2017,12.2007461085723
AFW,Africa Western and Central,2017,119.263954435824
AFW,Africa Western and Central,2017,7.12022667587668
AFW,Africa Western and Central,2018,46.3294803061782
AFW,Africa Western and Central,2018,67.3838178790827
AFW,Africa Western and Central,2018,13.6722191561302
AFW,Africa Western and Central,2018,178.788550681486
AFW,Africa Western and Central,2018,124.067961135881
AFW,Africa Western and Central,2018,19.3137878888331
AFW,Africa Western and Central,2018,7.38211355104294
AFW,Africa Western and Central,2018,35.4067893665748
AGO,Angola,2017,185.65101624
AGO,Angola,2017,5.78263712
AGO,Angola,2017,114.33460236
AGO,Angola,2017,52.91251755
AGO,Angola,2017,85.91679382
AGO,Angola,2017,93.95159912
AGO,Angola,2017,57.86081314
AGO,Angola,2017,3.56128168
AGO,Angola,2018,69.06031799
AGO,Angola,2018,164.70602417
AGO,Angola,2018,87.61676788
AGO,Angola,2018,36.73722076
AGO,Angola,2018,2.91132259
AGO,Angola,2018,5.47283792
AGO,Angola,2018,47.96822739
AGO,Angola,2018,90.17287445
ALB,Albania,2017,120.75823975
ALB,Albania,2017,287.71487427
ALB,Albania,2017,13.29034233
ALB,Albania,2017,100.86329651
ALB,Albania,2017,4.65915346
ALB,Albania,2017,645.47076416
ALB,Albania,2017,344.46563721
ALB,Albania,2017,226.28067017
ALB,Albania,2018,9.40255356
ALB,Albania,2018,274.91409302
ALB,Albania,2018,3.70697927
ALB,Albania,2018,148.43656921
ALB,Albania,2018,376.50137329
ALB,Albania,2018,122.77055359
ALB,Albania,2018,311.40093994
ALB,Albania,2018,697.30487061
AND,Andorra,2017,3319.4050293
AND,Andorra,2017,1.0
AND,Andorra,2017,2314.09936523
AND,Andorra,2017,777.56268311
AND,Andorra,2017,2567.42382813
AND,Andorra,2017,1005.30554199
AND,Andorra,2017,1789.86120605
AND,Andorra,2017,1.0
AND,Andorra,2018,1.0
AND,Andorra,2018,3607.00097656
AND,Andorra,2018,1.0
AND,Andorra,2018,2821.80126953
AND,Andorra,2018,1916.98449707
AND,Andorra,2018,2450.40795898
AND,Andorra,2018,904.81671143
AND,Andorra,2018,1156.59265137
ARB,Arab World,2017,168.220100869686
ARB,Arab World,2017,5.41718758337942
ARB,Arab World,2017,220.580138729293
ARB,Arab World,2017,391.382333336795
Query:
SELECT DISTINCT 
  p."country_code", 
  p."country" 
FROM 
  "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY" p 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" h 
ON 
  p."country_code" = h."country_code" 
LIMIT 100;
Answer:
country_code,country
CPV,Cabo Verde
ISL,Iceland
LUX,Luxembourg
FRO,Faroe Islands
LCA,St. Lucia
LMY,Low & middle income
UGA,Uganda
TUN,Tunisia
PRY,Paraguay
BLR,Belarus
DOM,Dominican Republic
BRA,Brazil
CYM,Cayman Islands
CAF,Central African Republic
HIC,High income
MWI,Malawi
DNK,Denmark
BMU,Bermuda
ARG,Argentina
DMA,Dominica
BDI,Burundi
LBN,Lebanon
ASM,American Samoa
NLD,Netherlands
GBR,United Kingdom
MAC,"Macao SAR, China"
BTN,Bhutan
ZWE,Zimbabwe
GTM,Guatemala
KOR,"Korea, Rep."
DJI,Djibouti
SLB,Solomon Islands
IND,India
ESP,Spain
WLD,World
BRB,Barbados
TJK,Tajikistan
AZE,Azerbaijan
HPC,Heavily indebted poor countries (HIPC)
AUS,Australia
ZMB,Zambia
IRL,Ireland
LBR,Liberia
AGO,Angola
TCD,Chad
MDV,Maldives
SSD,South Sudan
BLZ,Belize
ITA,Italy
NOR,Norway
IBT,IDA & IBRD total
LBY,Libya
RWA,Rwanda
CSS,Caribbean small states
CHE,Switzerland
SSF,Sub-Saharan Africa
SST,Small states
PNG,Papua New Guinea
LKA,Sri Lanka
TUV,Tuvalu
SLV,El Salvador
XKX,Kosovo
NER,Niger
TSA,South Asia (IDA & IBRD)
SEN,Senegal
SVK,Slovak Republic
ECA,Europe & Central Asia (excluding high income)
GMB,"Gambia, The"
GEO,Georgia
GUM,Guam
RUS,Russian Federation
KGZ,Kyrgyz Republic
MDA,Moldova
MLT,Malta
BHS,"Bahamas, The"
LCN,Latin America & Caribbean
ARE,United Arab Emirates
MIC,Middle income
TON,Tonga
TKM,Turkmenistan
IDN,Indonesia
NAC,North America
MLI,Mali
JAM,Jamaica
VEN,"Venezuela, RB"
CHI,Channel Islands
SLE,Sierra Leone
ROU,Romania
EUU,European Union
MDG,Madagascar
CUB,Cuba
MNG,Mongolia
HND,Honduras
SMR,San Marino
PRI,Puerto Rico
LDC,Least developed countries: UN classification
TGO,Togo
GNQ,Equatorial Guinea
IRQ,Iraq
PER,Peru
Query:
SELECT 
  h2017."country_code", 
  h2017."country_name", 
  ((h2018."value" - h2017."value") / h2017."value" * 100) AS "expenditure_growth_percent" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2017 
JOIN 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" AS h2018 
ON 
  h2017."country_code" = h2018."country_code" 
  AND h2017."indicator_name" = h2018."indicator_name" 
WHERE 
  h2017."indicator_name" ILIKE '%health expenditure per capita%' 
  AND h2017."year" = 2017 
  AND h2018."year" = 2018 
  AND ((h2018."value" - h2017."value") / h2017."value" * 100) > 1 
LIMIT 100;
Answer:
country_code,country_name,expenditure_growth_percent
COM,Comoros,2.704599883946007
ECU,Ecuador,3.2800841295102363
EGY,"Egypt, Arab Rep.",10.151308182601175
EAR,Early-demographic dividend,1.155713263926843
ECS,Europe & Central Asia,6.315958531481322
ECA,Europe & Central Asia (excluding high income),7.204988748194199
ECA,Europe & Central Asia (excluding high income),1.307617289451415
ECA,Europe & Central Asia (excluding high income),3.0831578255986316
KHM,Cambodia,27.608642338764593
CRI,Costa Rica,4.011392070167483
DMA,Dominica,43.568254744429055
FSM,"Micronesia, Fed. Sts.",5.426645173041243
NGA,Nigeria,5.373821440597682
NOR,Norway,3.217734161344436
EAP,East Asia & Pacific (excluding high income),10.500331778387803
ERI,Eritrea,12.341794939106707
ERI,Eritrea,23.472064126363087
CAF,Central African Republic,78.99886135733063
CUB,Cuba,5.078887537202116
MNG,Mongolia,1.3580223967446232
NAM,Namibia,1.2484084872433439
MKD,North Macedonia,12.067379177670121
NOR,Norway,3.9817965774012976
EAS,East Asia & Pacific,8.49430560620561
EMU,Euro area,2.907887921511555
DNK,Denmark,4.595794935672975
DOM,Dominican Republic,6.930425878309028
NZL,New Zealand,8.179795596082402
NGA,Nigeria,4.513946222424116
CEB,Central Europe and the Baltics,6.419767814704741
TEC,Europe & Central Asia (IDA & IBRD countries),1.1174068724290598
LTE,Late-demographic dividend,8.044979325582585
GNQ,Equatorial Guinea,6.9405669076699965
FIN,Finland,3.418657288261298
EST,Estonia,14.71827781377726
FIN,Finland,50.53297787519253
FIN,Finland,44.93860054660787
GAB,Gabon,99.72938060797001
GHA,Ghana,3.491297734154604
GRC,Greece,2.5847274907399687
GRD,Grenada,1.4163346936077668
ETH,Ethiopia,4.247894448915844
HTI,Haiti,11.637676720704606
ROU,Romania,25.54411303079491
LMY,Low & middle income,4.484701964939276
SLV,El Salvador,48.29590334021748
RUS,Russian Federation,9.418493604499975
SLE,Sierra Leone,22.03381262077821
HTI,Haiti,6.495807941506326
PRT,Portugal,10.815947294122953
ROU,Romania,9.298564039513408
SYC,Seychelles,7.099590971637772
KEN,Kenya,12.329293462325758
PRY,Paraguay,12.208367489718519
POL,Poland,1.8521743750267778
RWA,Rwanda,14.015732010237942
STP,Sao Tome and Principe,2.3602247036709856
HND,Honduras,4.600423764734833
ISL,Iceland,7.55294393976271
IND,India,5.491100207050945
IDN,Indonesia,6.520882793655053
IRQ,Iraq,500.1239401149893
ITA,Italy,6.3805049067046395
JPN,Japan,2.519329931211128
OED,OECD members,9.47774945932083
OSS,Other small states,4.407689620475733
PSS,Pacific island small states,4.059565071816022
PRE,Pre-demographic dividend,1.9144433133316132
MIC,Middle income,6.101815985663521
LVA,Latvia,11.059932009164918
MWI,Malawi,10.323664927064353
MWI,Malawi,4.356368490537546
MLI,Mali,7.108581210210809
MLT,Malta,1.0747488529228943
LSO,Lesotho,41.646993002464264
MRT,Mauritania,7.427916630960231
MRT,Mauritania,15.000152222928984
ZAF,South Africa,2.8533569304420463
LKA,Sri Lanka,3.803653566530511
KNA,St. Kitts and Nevis,3.6027033386902767
MYS,Malaysia,10.757405469652564
MDV,Maldives,1177.7244767638965
ZAF,South Africa,5.81632072824824
ZAF,South Africa,5.048564342677041
ESP,Spain,8.47043541460996
ATG,Antigua and Barbuda,10.299268289062342
LTU,Lithuania,5.234118635826519
MLT,Malta,6.17160468137759
TKM,Turkmenistan,361.34509457576473
GBR,United Kingdom,7.267799380236882
USA,United States,4.385659625788704
DNK,Denmark,7.182840430675137
DJI,Djibouti,10.811769025700805
NGA,Nigeria,10.450080317777717
EMU,Euro area,2.789134976903903
SLV,El Salvador,2.964830670326677
SLV,El Salvador,47.579120842280055
GNQ,Equatorial Guinea,6.257701875486288
GHA,Ghana,13.178566497874536
STP,Sao Tome and Principe,8.90972860074675
Query:
SELECT 
  "country_code", 
  "country_name", 
  "value" AS "health_expenditure_2018" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
  AND "year" = 2018 
LIMIT 100;
Answer:
country_code,country_name,health_expenditure_2018
BWA,Botswana,374.17907715
UKR,Ukraine,2.30205011
URY,Uruguay,429.58023071
COM,Comoros,65.22776031
COM,Comoros,102.36206055
COD,"Congo, Dem. Rep.",2.79114175
CRI,Costa Rica,0.05650612
DMA,Dominica,9.2956562
DOM,Dominican Republic,4.37877226
MCO,Monaco,2968.50048828
PLW,Palau,2011.51733398
PLW,Palau,662.62835693
EMU,Euro area,1067.83582859016
TEC,Europe & Central Asia (IDA & IBRD countries),170.921351224296
EUU,European Union,1088.35658972773
HIC,High income,0.624952150180451
LCN,Latin America & Caribbean,1.54613119374784
FRA,France,4690.07226563
DEU,Germany,5472.20214844
GHA,Ghana,167.97952271
PER,Peru,137.32307434
RWA,Rwanda,58.30852127
SLE,Sierra Leone,55.24813843
HND,Honduras,176.24726868
LAO,Lao PDR,81.64137268
LMC,Lower middle income,59.7275955701677
UMC,Upper middle income,0.690429319312342
AFG,Afghanistan,8.19657612
ATG,Antigua and Barbuda,485.82119751
MLI,Mali,32.36968613
MHL,Marshall Islands,98.64823151
MRT,Mauritania,30.77950668
TLS,Timor-Leste,10.6438303
BHR,Bahrain,994.17901611
BRB,Barbados,14.29946041
BEL,Belgium,5404.91601563
BEN,Benin,41.7741394
BIH,Bosnia and Herzegovina,376.87268066
BDI,Burundi,24.02547073
VEN,"Venezuela, RB",199.89640808
TCD,Chad,4.57267809
MUS,Mauritius,368.16949463
NRU,Nauru,49.04381943
HPC,Heavily indebted poor countries (HIPC),13.9419707895972
HPC,Heavily indebted poor countries (HIPC),37.5276060436454
LTE,Late-demographic dividend,239.558049325612
GRC,Greece,750.99975586
GRD,Grenada,22.30875015
PNG,Papua New Guinea,12.88847256
PRT,Portugal,1361.25512695
STP,Sao Tome and Principe,55.12792206
SEN,Senegal,58.90360641
HND,Honduras,145.84317017
IRQ,Iraq,367.75228882
ISR,Israel,3323.65063477
KIR,Kiribati,196.84797668
TSA,South Asia (IDA & IBRD),177.637906691198
SSA,Sub-Saharan Africa (excluding high income),30.192121784093
TSS,Sub-Saharan Africa (IDA & IBRD countries),83.2490352335023
ALB,Albania,274.91409302
AND,Andorra,2821.80126953
ATG,Antigua and Barbuda,0.78491873
MRT,Mauritania,190.13778687
LKA,Sri Lanka,3.52529263
SDN,Sudan,22.31403923
SUR,Suriname,474.1265564
BHS,"Bahamas, The",2005.24621582
BGD,Bangladesh,7.14773178
BRN,Brunei Darussalam,94.87831879
UKR,Ukraine,228.39007568
GBR,United Kingdom,3392.0859375
GBR,United Kingdom,922.77746582
CHL,Chile,1.0
ROU,Romania,1.0
SMR,San Marino,1.0
KWT,Kuwait,1.0
BEL,Belgium,1.0
COL,Colombia,1.0
DNK,Denmark,1.0
SWE,Sweden,1.0
CAN,Canada,1.0
MNE,Montenegro,1.0
NOR,Norway,1.0
JPN,Japan,1.0
SVK,Slovak Republic,1.0
NAC,North America,1.0
BGR,Bulgaria,1.0
DNK,Denmark,1.0
MCO,Monaco,1.0
QAT,Qatar,1.0
RUS,Russian Federation,1.0
CZE,Czech Republic,1.0
BGR,Bulgaria,1.0
HUN,Hungary,1.0
SVN,Slovenia,1.0
HUN,Hungary,1.0
AND,Andorra,1.0
OMN,Oman,1.0
ESP,Spain,1.0
ARE,United Arab Emirates,1.0
Query:
SELECT DISTINCT 
  "indicator_code", 
  "indicator_name" 
FROM 
  "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION" 
WHERE 
  "indicator_name" ILIKE '%health expenditure per capita%' 
LIMIT 100;
Answer:
indicator_code,indicator_name
SH.XPD.CHEX.PC.CD,Current health expenditure per capita (current US$)
SH.XPD.PVTD.PP.CD,"Domestic private health expenditure per capita, PPP  (current international $)"
SH.XPD.EHEX.PP.CD,"External health expenditure per capita, PPP (current international $)"
SH.XPD.PVTD.PC.CD,Domestic private health expenditure per capita (current US$)
SH.XPD.GHED.PC.CD,Domestic general government health expenditure per capita (current US$)
SH.XPD.CHEX.PP.CD,"Current health expenditure per capita, PPP (current international $)"
SH.XPD.GHED.PP.CD,"Domestic general government health expenditure per capita, PPP (current international $)"
SH.XPD.EHEX.PC.CD,External health expenditure per capita (current US$)
End Exploring Related Columns
Task: Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita (current US$)"** or the appropriate PPP-adjusted indicator.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

As the exact data is required to compute the precise number, the final result should be presented in the following format:

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SUMMARY', 'SERIES_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_EDUCATION'], 'WORLD_BANK_WDI': ['COUNTRY_SUMMARY', 'SERIES_TIME', 'INDICATORS_DATA', 'COUNTRY_SERIES_DEFINITIONS', 'FOOTNOTES', 'SERIES_SUMMARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 02:00:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 02:00:22 - root - INFO - ```sql
WITH population_growth AS (
  SELECT
    "country_code",
    (("year_2018" - "year_2017") / "year_2017") * 100 AS "population_growth_percent"
  FROM
    "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
  WHERE
    "year_2017" IS NOT NULL AND
    "year_2018" IS NOT NULL AND
    "year_2017" <> 0
),
health_expenditure_2017 AS (
  SELECT
    "country_code",
    "value" AS "expenditure_2017"
  FROM
    "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
  WHERE
    "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
    AND "year" = 2017
    AND "value" IS NOT NULL
),
health_expenditure_2018 AS (
  SELECT
    "country_code",
    "value" AS "expenditure_2018"
  FROM
    "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
  WHERE
    "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
    AND "year" = 2018
    AND "value" IS NOT NULL
),
health_expenditure_growth AS (
  SELECT
    h2017."country_code",
    ((h2018."expenditure_2018" - h2017."expenditure_2017") / h2017."expenditure_2017") * 100 AS "expenditure_growth_percent"
  FROM
    health_expenditure_2017 h2017
  JOIN
    health_expenditure_2018 h2018 ON h2017."country_code" = h2018."country_code"
  WHERE
    h2017."expenditure_2017" <> 0
)
SELECT
  COUNT(DISTINCT pg."country_code") AS Number_of_Countries
FROM
  population_growth pg
JOIN
  health_expenditure_growth heg ON pg."country_code" = heg."country_code"
WHERE
  pg."population_growth_percent" > 1
  AND heg."expenditure_growth_percent" > 1;
```
2025-02-11 02:00:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 02:00:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 02:00:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 02:00:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 02:00:23 - snowflake.connector.connection - INFO - closed
2025-02-11 02:00:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 02:00:23 - root - INFO - itercount: 1
2025-02-11 02:00:23 - root - INFO - 0
2025-02-11 02:00:23 - root - INFO - results: 
NUMBER_OF_COUNTRIES
76


2025-02-11 02:00:23 - root - INFO - Please check the answer again by reviewing Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita (current US$)"** or the appropriate PPP-adjusted indicator.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

As the exact data is required to compute the precise number, the final result should be presented in the following format:

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
NUMBER_OF_COUNTRIES
76
Current sql:
WITH population_growth AS (
  SELECT
    "country_code",
    (("year_2018" - "year_2017") / "year_2017") * 100 AS "population_growth_percent"
  FROM
    "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
  WHERE
    "year_2017" IS NOT NULL AND
    "year_2018" IS NOT NULL AND
    "year_2017" <> 0
),
health_expenditure_2017 AS (
  SELECT
    "country_code",
    "value" AS "expenditure_2017"
  FROM
    "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
  WHERE
    "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
    AND "year" = 2017
    AND "value" IS NOT NULL
),
health_expenditure_2018 AS (
  SELECT
    "country_code",
    "value" AS "expenditure_2018"
  FROM
    "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
  WHERE
    "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
    AND "year" = 2018
    AND "value" IS NOT NULL
),
health_expenditure_growth AS (
  SELECT
    h2017."country_code",
    ((h2018."expenditure_2018" - h2017."expenditure_2017") / h2017."expenditure_2017") * 100 AS "expenditure_growth_percent"
  FROM
    health_expenditure_2017 h2017
  JOIN
    health_expenditure_2018 h2018 ON h2017."country_code" = h2018."country_code"
  WHERE
    h2017."expenditure_2017" <> 0
)
SELECT
  COUNT(DISTINCT pg."country_code") AS Number_of_Countries
FROM
  population_growth pg
JOIN
  health_expenditure_growth heg ON pg."country_code" = heg."country_code"
WHERE
  pg."population_growth_percent" > 1
  AND heg."expenditure_growth_percent" > 1;
2025-02-11 02:00:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 02:00:51 - root - INFO - ```sql
WITH population_growth AS (
  SELECT
    "country_code",
    (( "year_2018" - "year_2017" ) / "year_2017" ) * 100 AS "population_growth_percent"
  FROM
    "WORLD_BANK"."WORLD_BANK_GLOBAL_POPULATION"."POPULATION_BY_COUNTRY"
  WHERE
    "year_2017" IS NOT NULL
    AND "year_2018" IS NOT NULL
    AND "year_2017" <> 0
),
health_expenditure_2017 AS (
  SELECT
    "country_code",
    "value" AS "expenditure_2017"
  FROM
    "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
  WHERE
    "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
    AND "year" = 2017
    AND "value" IS NOT NULL
),
health_expenditure_2018 AS (
  SELECT
    "country_code",
    "value" AS "expenditure_2018"
  FROM
    "WORLD_BANK"."WORLD_BANK_HEALTH_POPULATION"."HEALTH_NUTRITION_POPULATION"
  WHERE
    "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
    AND "year" = 2018
    AND "value" IS NOT NULL
),
health_expenditure_growth AS (
  SELECT
    h2017."country_code",
    ( ( h2018."expenditure_2018" - h2017."expenditure_2017" ) / h2017."expenditure_2017" ) * 100 AS "expenditure_growth_percent"
  FROM
    health_expenditure_2017 h2017
  JOIN
    health_expenditure_2018 h2018 ON h2017."country_code" = h2018."country_code"
  WHERE
    h2017."expenditure_2017" <> 0
)
SELECT
  COUNT( DISTINCT pg."country_code" ) AS "Number_of_Countries"
FROM
  population_growth pg
JOIN
  health_expenditure_growth heg ON pg."country_code" = heg."country_code"
WHERE
  pg."population_growth_percent" > 1
  AND heg."expenditure_growth_percent" > 1;
```
2025-02-11 02:00:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 02:00:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 02:00:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 02:00:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 02:00:52 - snowflake.connector.connection - INFO - closed
2025-02-11 02:00:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 02:00:52 - root - INFO - itercount: 2
2025-02-11 02:00:52 - root - INFO - 0
2025-02-11 02:00:52 - root - INFO - Total iteration counts: 2
