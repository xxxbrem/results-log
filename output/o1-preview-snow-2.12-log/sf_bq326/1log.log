2025-02-11 01:57:26 - openai._base_client - INFO - Retrying request to /chat/completions in 0.392375 seconds
2025-02-11 01:58:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:58:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:37 - root - INFO - SQL:
SELECT DISTINCT "country_code", "country"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
Results:
country_code,country
SXM,Sint Maarten (Dutch part)
INX,Not classified
PSE,West Bank and Gaza
SRB,Serbia
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
LIC,Low income
EAR,Early-demographic dividend
FJI,Fiji
MNA,Middle East & North Africa (excluding high income)
TMN,Middle East & North Africa (IDA & IBRD countries)
WLD,World
SAU,Saudi Arabia
DOM,Dominican Republic
VEN,"Venezuela, RB"
GIN,Guinea
DNK,Denmark
HKG,"Hong Kong SAR, China"
TEC,Europe & Central Asia (IDA & IBRD countries)
YEM,"Yemen, Rep."
NAM,Namibia
CPV,Cabo Verde
PHL,Philippines
PLW,Palau
DEU,Germany
FRO,Faroe Islands
SST,Small states
BTN,Bhutan
XKX,Kosovo
ECA,Europe & Central Asia (excluding high income)
OMN,Oman
ZAF,South Africa
FIN,Finland
MNE,Montenegro
JAM,Jamaica
LIE,Liechtenstein
MNG,Mongolia
LUX,Luxembourg
ARB,Arab World
CUB,Cuba
UMC,Upper middle income
HRV,Croatia
PAN,Panama
TCD,Chad
KEN,Kenya
PAK,Pakistan
CEB,Central Europe and the Baltics
BRN,Brunei Darussalam
HTI,Haiti
IMN,Isle of Man
BIH,Bosnia and Herzegovina
AGO,Angola
WSM,Samoa
TSA,South Asia (IDA & IBRD)
SSD,South Sudan
COG,"Congo, Rep."
ITA,Italy
NAC,North America
GEO,Georgia
VIR,Virgin Islands (U.S.)
IDN,Indonesia
ARM,Armenia
SSA,Sub-Saharan Africa (excluding high income)
MDV,Maldives
PER,Peru
CAN,Canada
QAT,Qatar
MKD,North Macedonia
RWA,Rwanda
MAF,St. Martin (French part)
TZA,Tanzania
ZMB,Zambia
TUN,Tunisia
PRE,Pre-demographic dividend
MHL,Marshall Islands
DMA,Dominica
AUT,Austria
ATG,Antigua and Barbuda
CHL,Chile
MDA,Moldova
ECU,Ecuador
EGY,"Egypt, Arab Rep."
CYP,Cyprus
NRU,Nauru
USA,United States
BRA,Brazil
LDC,Least developed countries: UN classification
LKA,Sri Lanka
NOR,Norway
IRL,Ireland
SLE,Sierra Leone
MEA,Middle East & North Africa
SMR,San Marino
GRD,Grenada
MEX,Mexico
VNM,Vietnam
SLB,Solomon Islands
SEN,Senegal
SAS,South Asia

2025-02-11 01:58:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:38 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:39 - root - INFO - SQL:
SELECT "country_code", "country", "year_2017", "year_2018"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
Results:
country_code,country,year_2017,year_2018
SXM,Sint Maarten (Dutch part),40574.0,40654.0
INX,Not classified,,
PSE,West Bank and Gaza,4454805.0,4569087.0
SRB,Serbia,7020858.0,6982084.0
KHM,Cambodia,16009414.0,16249798.0
ARE,United Arab Emirates,9487203.0,9630959.0
CYP,Cyprus,1179680.0,1189265.0
LMC,Lower middle income,2981420591.0,3022905169.0
MDV,Maldives,496402.0,515696.0
LIC,Low income,687449530.0,705417321.0
PER,Peru,31444297.0,31989256.0
EAR,Early-demographic dividend,3207188541.0,3249140605.0
FJI,Fiji,877459.0,883483.0
TCD,Chad,15016773.0,15477751.0
MNA,Middle East & North Africa (excluding high income),376546755.0,382896715.0
TMN,Middle East & North Africa (IDA & IBRD countries),372091950.0,378327628.0
WLD,World,7510990456.0,7594270356.0
SAU,Saudi Arabia,33099147.0,33699947.0
DOM,Dominican Republic,10513131.0,10627165.0
KEN,Kenya,50221473.0,51393010.0
VEN,"Venezuela, RB",29390409.0,28870195.0
CAN,Canada,36540268.0,37058856.0
GIN,Guinea,12067539.0,12414318.0
PAK,Pakistan,207896686.0,212215030.0
LVA,Latvia,1942248.0,1926542.0
DNK,Denmark,5764980.0,5797446.0
HKG,"Hong Kong SAR, China",7391700.0,7451000.0
NRU,Nauru,12876.0,12704.0
QAT,Qatar,2724724.0,2781677.0
USA,United States,325147121.0,327167434.0
TEC,Europe & Central Asia (IDA & IBRD countries),457810292.0,459865205.0
BRA,Brazil,207833831.0,209469333.0
NGA,Nigeria,190873311.0,195874740.0
YEM,"Yemen, Rep.",27834821.0,28498687.0
MKD,North Macedonia,2081996.0,2082958.0
NAM,Namibia,2402603.0,2448255.0
RWA,Rwanda,11980937.0,12301939.0
LDC,Least developed countries: UN classification,986365080.0,1009662578.0
CEB,Central Europe and the Baltics,102738854.0,102511922.0
CPV,Cabo Verde,537497.0,543767.0
BRN,Brunei Darussalam,424473.0,428962.0
PHL,Philippines,105173264.0,106651922.0
PLW,Palau,17808.0,17907.0
LKA,Sri Lanka,21444000.0,21670000.0
STP,Sao Tome and Principe,207089.0,211028.0
HTI,Haiti,10982366.0,11123176.0
PSS,Pacific island small states,2422086.0,2457367.0
CHN,China,1386395000.0,1392730000.0
DEU,Germany,82657002.0,82927922.0
MAF,St. Martin (French part),36560.0,37264.0
FRO,Faroe Islands,48331.0,48497.0
NOR,Norway,5276968.0,5314336.0
SST,Small states,39885876.0,40575321.0
IRL,Ireland,4807388.0,4853506.0
TZA,Tanzania,54663906.0,56318348.0
BTN,Bhutan,745568.0,754394.0
XKX,Kosovo,1830700.0,1845300.0
ZMB,Zambia,16853688.0,17351822.0
ECA,Europe & Central Asia (excluding high income),415710935.0,417797257.0
IMN,Isle of Man,83598.0,84077.0
GTM,Guatemala,16914936.0,17247807.0
OMN,Oman,4665935.0,4829483.0
TUN,Tunisia,11433443.0,11565204.0
SGP,Singapore,5612253.0,5638676.0
ZAF,South Africa,57000451.0,57779622.0
FIN,Finland,5508214.0,5518050.0
MNE,Montenegro,622373.0,622345.0
PRE,Pre-demographic dividend,894512725.0,919485393.0
BIH,Bosnia and Herzegovina,3351527.0,3323929.0
SLE,Sierra Leone,7488431.0,7650154.0
BRB,Barbados,286233.0,286641.0
MEA,Middle East & North Africa,441255234.0,448912859.0
TEA,East Asia & Pacific (IDA & IBRD countries),2042687863.0,2056064424.0
MHL,Marshall Islands,58058.0,58413.0
SMR,San Marino,33671.0,33785.0
SYR,Syrian Arab Republic,17068002.0,16906283.0
NIC,Nicaragua,6384855.0,6465513.0
POL,Poland,37974826.0,37978548.0
FCS,Fragile and conflict affected situations,504119229.0,515215936.0
GRD,Grenada,110874.0,111454.0
SVN,Slovenia,2066388.0,2067372.0
VCT,St. Vincent and the Grenadines,109827.0,110210.0
MEX,Mexico,124777324.0,126190788.0
MAR,Morocco,35581294.0,36029138.0
AGO,Angola,29816748.0,30809762.0
WSM,Samoa,195352.0,196130.0
CMR,Cameroon,24566045.0,25216237.0
THA,Thailand,69209858.0,69428524.0
VNM,Vietnam,94596642.0,95540395.0
SLB,Solomon Islands,636038.0,652858.0
JPN,Japan,126785797.0,126529100.0
NER,Niger,21602472.0,22442948.0
SEN,Senegal,15419381.0,15854360.0
CRI,Costa Rica,4949954.0,4999441.0
ALB,Albania,2873457.0,2866376.0
LCA,St. Lucia,180955.0,181889.0
AND,Andorra,77001.0,77006.0
TSA,South Asia (IDA & IBRD),1792835608.0,1814388744.0
SAS,South Asia,1792835608.0,1814388744.0
SSD,South Sudan,10910759.0,10975920.0

2025-02-11 01:58:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:40 - root - INFO - SQL:
SELECT DISTINCT "indicator_name", "indicator_code"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" ILIKE '%health expenditure per capita%'
   LIMIT 100;
Results:
indicator_name,indicator_code
External health expenditure per capita (current US$),SH.XPD.EHEX.PC.CD
Current health expenditure per capita (current US$),SH.XPD.CHEX.PC.CD
Domestic general government health expenditure per capita (current US$),SH.XPD.GHED.PC.CD
"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD
"Domestic private health expenditure per capita, PPP  (current international $)",SH.XPD.PVTD.PP.CD
"External health expenditure per capita, PPP (current international $)",SH.XPD.EHEX.PP.CD
"Domestic general government health expenditure per capita, PPP (current international $)",SH.XPD.GHED.PP.CD
Domestic private health expenditure per capita (current US$),SH.XPD.PVTD.PC.CD

2025-02-11 01:58:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:41 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:42 - root - INFO - SQL:
SELECT "country_code", "country_name", "indicator_name", "year", "value"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   LIMIT 100;
Results:
Too long, hard cut:
country_code,country_name,indicator_name,year,value
PLW,Palau,"Current health expenditure per capita, PPP (current international $)",2018,2011.51733398
EMU,Euro area,"Current health expenditure per capita, PPP (current international $)",2017,4572.35296577739
GHA,Ghana,"Current health expenditure per capita, PPP (current international $)",2017,148.41990662
GHA,Ghana,"Current health expenditure per capita, PPP (current international $)",2018,167.97952271
PST,Post-demographic dividend,"Current health expenditure per capita, PPP (current international $)",2017,5924.10963361332
SSD,South Sudan,"Current health expenditure per capita, PPP (current international $)",2017,147.8605957
SDN,Sudan,"Current health expenditure per capita, PPP (current international $)",2017,311.76040649
BEL,Belgium,"Current health expenditure per capita, PPP (current international $)",2018,5404.91601563
COL,Colombia,"Current health expenditure per capita, PPP (current international $)",2017,1114.09619141
NLD,Netherlands,"Current health expenditure per capita, PPP (current international $)",2017,5498.88183594
ECS,Europe & Central Asia,"Current health expenditure per capita, PPP (current international $)",2017,2872.69957547778
IRN,"Iran, Islamic Rep.","Current health expenditure per capita, PPP (current international $)",2017,1758.99145508
MRT,Mauritania,"Current health expenditure per capita, PPP (current international $)",2018,190.13778687
TLS,Timor-Leste,"Current health expenditure per capita, PPP (current international $)",2017,321.57449341
BHS,"Bahamas, The","Current health expenditure per capita, PPP (current international $)",2018,2005.24621582
DJI,Djibouti,"Current health expenditure per capita, PPP (current international $)",2017,134.43319702
MUS,Mauritius,"Current health expenditure per capita, PPP (current international $)",2018,1380.73596191
MNG,Mongolia,"Current health expenditure per capita, PPP (current international $)",2017,512.30932617
MNE,Montenegro,"Current health expenditure per capita, PPP (current international $)",2018,1711.20996094
NIC,Nicaragua,"Current health expenditure per capita, PPP (current international $)",2017,473.00387573
PHL,Philippines,"Current health expenditure per capita, PPP (current international $)",2018,393.90402222
POL,Poland,"Current health expenditure per capita, PPP (current international $)",2017,1978.63806152
SLE,Sierra Leone,"Current health expenditure per capita, PPP (current international $)",2017,255.2999115
IDN,Indonesia,"Current health expenditure per capita, PPP (current international $)",2017,352.1897583
KGZ,Kyrgyz Republic,"Current health expenditure per capita, PPP (current international $)",2018,259.92599487
MIC,Middle income,"Current health expenditure per capita, PPP (current international $)",2017,613.584403311481
ATG,Antigua and Barbuda,"Current health expenditure per capita, PPP (current international $)",2017,1274.50341797
LCA,St. Lucia,"Current health expenditure per capita, PPP (current international $)",2017,636.71325684
ARG,Argentina,"Current health expenditure per capita, PPP (current international $)",2018,1989.63562012
BEL,Belgium,"Current health expenditure per capita, PPP (current international $)",2017,5289.40039063
BFA,Burkina Faso,"Current health expenditure per capita, PPP (current international $)",2018,111.71577454
MDA,Moldova,"Current health expenditure per capita, PPP (current international $)",2018,479.85287476
DEU,Germany,"Current health expenditure per capita, PPP (current international $)",2017,5930.57617188
PER,Peru,"Current health expenditure per capita, PPP (current international $)",2017,698.16088867
ROU,Romania,"Current health expenditure per capita, PPP (current international $)",2017,1367.82080078
TSS,Sub-Saharan Africa (IDA & IBRD countries),"Current health expenditure per capita, PPP (current international $)",2017,201.156557039325
BHR,Bahrain,"Current health expenditure per capita, PPP (current international $)",2018,1955.35192871
CPV,Cabo Verde,"Current health expenditure per capita, PPP (current international $)",2017,375.52709961
PAK,Pakistan,"Current health expenditure per capita, PPP (current international $)",2017,152.12948608
HIC,High income,"Current health expenditure per capita, PPP (current international $)",2018,6065.06312742882
TLA,Latin America & the Caribbean (IDA & IBRD countries),"Current health expenditure per capita, PPP (current international $)",2018,1228.16209266781
PRY,Paraguay,"Current health expenditure per capita, PPP (current international $)",2018,935.32897949
SMR,San Marino,"Current health expenditure per capita, PPP (current international $)",2017,4262.75585938
SVN,Slovenia,"Current health expenditure per capita, PPP (current international $)",2017,2960.59326172
MEA,Middle East & North Africa,"Current health expenditure per capita, PPP (current international $)",2018,1336.40615439374
LBN,Lebanon,"Current health expenditure per capita, PPP (current international $)",2018,1085.85119629
CUB,Cuba,"Current health expend

2025-02-11 01:58:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:43 - root - INFO - SQL:
SELECT "country_code", "country_name"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   HAVING COUNT(DISTINCT "year") = 2
   LIMIT 100;
Results:
country_code,country_name
GHA,Ghana
BHS,"Bahamas, The"
MUS,Mauritius
KGZ,Kyrgyz Republic
BHR,Bahrain
MEA,Middle East & North Africa
LSO,Lesotho
THA,Thailand
LCA,St. Lucia
GUY,Guyana
EMU,Euro area
VNM,Vietnam
CAF,Central African Republic
PER,Peru
DZA,Algeria
KOR,"Korea, Rep."
CHL,Chile
WSM,Samoa
IND,India
VCT,St. Vincent and the Grenadines
QAT,Qatar
IRN,"Iran, Islamic Rep."
SSF,Sub-Saharan Africa
AFW,Africa Western and Central
GRC,Greece
POL,Poland
HPC,Heavily indebted poor countries (HIPC)
TEC,Europe & Central Asia (IDA & IBRD countries)
TGO,Togo
ARG,Argentina
LBN,Lebanon
DJI,Djibouti
BWA,Botswana
UKR,Ukraine
TSS,Sub-Saharan Africa (IDA & IBRD countries)
MAR,Morocco
NZL,New Zealand
TUR,Turkey
TON,Tonga
TUN,Tunisia
BRN,Brunei Darussalam
EAP,East Asia & Pacific (excluding high income)
LCN,Latin America & Caribbean
FRA,France
PLW,Palau
AFG,Afghanistan
PRT,Portugal
EGY,"Egypt, Arab Rep."
CAN,Canada
VEN,"Venezuela, RB"
COD,"Congo, Dem. Rep."
BTN,Bhutan
AGO,Angola
COM,Comoros
MEX,Mexico
SLV,El Salvador
GTM,Guatemala
KHM,Cambodia
ECA,Europe & Central Asia (excluding high income)
BEN,Benin
COG,"Congo, Rep."
TEA,East Asia & Pacific (IDA & IBRD countries)
ESP,Spain
LBR,Liberia
OED,OECD members
TKM,Turkmenistan
NGA,Nigeria
FSM,"Micronesia, Fed. Sts."
TSA,South Asia (IDA & IBRD)
SRB,Serbia
HRV,Croatia
KWT,Kuwait
LTU,Lithuania
STP,Sao Tome and Principe
AUS,Australia
NER,Niger
CZE,Czech Republic
KAZ,Kazakhstan
UMC,Upper middle income
ZMB,Zambia
OMN,Oman
SSD,South Sudan
SDN,Sudan
DEU,Germany
CPV,Cabo Verde
MDV,Maldives
ALB,Albania
CHE,Switzerland
LAC,Latin America & Caribbean (excluding high income)
TZA,Tanzania
LKA,Sri Lanka
ARE,United Arab Emirates
ZWE,Zimbabwe
GMB,"Gambia, The"
MNA,Middle East & North Africa (excluding high income)
NAC,North America
FJI,Fiji
TMN,Middle East & North Africa (IDA & IBRD countries)
CYP,Cyprus
ECU,Ecuador

2025-02-11 01:58:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:44 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:45 - root - INFO - SQL:
SELECT "country_code", "country",
          "year_2017", "year_2018",
          (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) AS "population_growth_pct"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
Results:
country_code,country,year_2017,year_2018,population_growth_pct
SXM,Sint Maarten (Dutch part),40574.0,40654.0,0.197200
INX,Not classified,,,
PSE,West Bank and Gaza,4454805.0,4569087.0,2.565400
SRB,Serbia,7020858.0,6982084.0,-0.552300
KHM,Cambodia,16009414.0,16249798.0,1.501500
ARE,United Arab Emirates,9487203.0,9630959.0,1.515300
CYP,Cyprus,1179680.0,1189265.0,0.812500
LMC,Lower middle income,2981420591.0,3022905169.0,1.391400
MDV,Maldives,496402.0,515696.0,3.886800
LIC,Low income,687449530.0,705417321.0,2.613700
PER,Peru,31444297.0,31989256.0,1.733100
EAR,Early-demographic dividend,3207188541.0,3249140605.0,1.308100
FJI,Fiji,877459.0,883483.0,0.686500
TCD,Chad,15016773.0,15477751.0,3.069800
MNA,Middle East & North Africa (excluding high income),376546755.0,382896715.0,1.686400
TMN,Middle East & North Africa (IDA & IBRD countries),372091950.0,378327628.0,1.675800
WLD,World,7510990456.0,7594270356.0,1.108800
SAU,Saudi Arabia,33099147.0,33699947.0,1.815200
DOM,Dominican Republic,10513131.0,10627165.0,1.084700
KEN,Kenya,50221473.0,51393010.0,2.332700
VEN,"Venezuela, RB",29390409.0,28870195.0,-1.770000
CAN,Canada,36540268.0,37058856.0,1.419200
GIN,Guinea,12067539.0,12414318.0,2.873700
PAK,Pakistan,207896686.0,212215030.0,2.077200
LVA,Latvia,1942248.0,1926542.0,-0.808700
DNK,Denmark,5764980.0,5797446.0,0.563200
HKG,"Hong Kong SAR, China",7391700.0,7451000.0,0.802300
NRU,Nauru,12876.0,12704.0,-1.335800
QAT,Qatar,2724724.0,2781677.0,2.090200
USA,United States,325147121.0,327167434.0,0.621400
TEC,Europe & Central Asia (IDA & IBRD countries),457810292.0,459865205.0,0.448900
BRA,Brazil,207833831.0,209469333.0,0.786900
NGA,Nigeria,190873311.0,195874740.0,2.620300
YEM,"Yemen, Rep.",27834821.0,28498687.0,2.385000
MKD,North Macedonia,2081996.0,2082958.0,0.046200
NAM,Namibia,2402603.0,2448255.0,1.900100
RWA,Rwanda,11980937.0,12301939.0,2.679300
LDC,Least developed countries: UN classification,986365080.0,1009662578.0,2.362000
CEB,Central Europe and the Baltics,102738854.0,102511922.0,-0.220900
CPV,Cabo Verde,537497.0,543767.0,1.166500
BRN,Brunei Darussalam,424473.0,428962.0,1.057500
PHL,Philippines,105173264.0,106651922.0,1.405900
PLW,Palau,17808.0,17907.0,0.555900
LKA,Sri Lanka,21444000.0,21670000.0,1.053900
STP,Sao Tome and Principe,207089.0,211028.0,1.902100
HTI,Haiti,10982366.0,11123176.0,1.282100
PSS,Pacific island small states,2422086.0,2457367.0,1.456600
CHN,China,1386395000.0,1392730000.0,0.456900
DEU,Germany,82657002.0,82927922.0,0.327800
MAF,St. Martin (French part),36560.0,37264.0,1.925600
FRO,Faroe Islands,48331.0,48497.0,0.343500
NOR,Norway,5276968.0,5314336.0,0.708100
SST,Small states,39885876.0,40575321.0,1.728500
IRL,Ireland,4807388.0,4853506.0,0.959300
TZA,Tanzania,54663906.0,56318348.0,3.026600
BTN,Bhutan,745568.0,754394.0,1.183800
XKX,Kosovo,1830700.0,1845300.0,0.797500
ZMB,Zambia,16853688.0,17351822.0,2.955600
ECA,Europe & Central Asia (excluding high income),415710935.0,417797257.0,0.501900
IMN,Isle of Man,83598.0,84077.0,0.573000
GTM,Guatemala,16914936.0,17247807.0,1.967900
OMN,Oman,4665935.0,4829483.0,3.505100
TUN,Tunisia,11433443.0,11565204.0,1.152400
SGP,Singapore,5612253.0,5638676.0,0.470800
ZAF,South Africa,57000451.0,57779622.0,1.367000
FIN,Finland,5508214.0,5518050.0,0.178600
MNE,Montenegro,622373.0,622345.0,-0.004500
PRE,Pre-demographic dividend,894512725.0,919485393.0,2.791800
BIH,Bosnia and Herzegovina,3351527.0,3323929.0,-0.823400
SLE,Sierra Leone,7488431.0,7650154.0,2.159600
BRB,Barbados,286233.0,286641.0,0.142500
MEA,Middle East & North Africa,441255234.0,448912859.0,1.735400
TEA,East Asia & Pacific (IDA & IBRD countries),2042687863.0,2056064424.0,0.654900
MHL,Marshall Islands,58058.0,58413.0,0.611500
SMR,San Marino,33671.0,33785.0,0.338600
SYR,Syrian Arab Republic,17068002.0,16906283.0,-0.947500
NIC,Nicaragua,6384855.0,6465513.0,1.263300
POL,Poland,37974826.0,37978548.0,0.009800
FCS,Fragile and conflict affected situations,504119229.0,515215936.0,2.201200
GRD,Grenada,110874.0,111454.0,0.523100
SVN,Slovenia,2066388.0,2067372.0,0.047600
VCT,St. Vincent and the Grenadines,109827.0,110210.0,0.348700
MEX,Mexico,124777324.0,126190788.0,1.132800
MAR,Morocco,35581294.0,36029138.0,1.258700
AGO,Angola,29816748.0,30809762.0,3.330400
WSM,Samoa,195352.0,196130.0,0.398300
CMR,Cameroon,24566045.0,25216237.0,2.646700
THA,Thailand,69209858.0,69428524.0,0.315900
VNM,Vietnam,94596642.0,95540395.0,0.997700
SLB,Solomon Islands,636038.0,652858.0,2.644500
JPN,Japan,126785797.0,126529100.0,-0.202500
NER,Niger,21602472.0,22442948.0,3.890600
SEN,Senegal,15419381.0,15854360.0,2.821000
CRI,Costa Rica,4949954.0,4999441.0,0.999700
ALB,Albania,2873457.0,2866376.0,-0.246400
LCA,St. Lucia,180955.0,181889.0,0.516200
AND,Andorra,77001.0,77006.0,0.006500
TSA,South Asia (IDA & IBRD),1792835608.0,1814388744.0,1.202200
SAS,South Asia,1792835608.0,1814388744.0,1.202200
SSD,South Sudan,10910759.0,10975920.0,0.597200

2025-02-11 01:58:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:46 - root - INFO - SQL:
SELECT "country_code", "country_name", "year", "value" AS "health_expenditure"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "country_name" = 'United States'
     AND "year" IN (2017, 2018)
   ORDER BY "year"
   LIMIT 100;
Results:
country_code,country_name,year,health_expenditure
USA,United States,2017,10209.63085938
USA,United States,2018,10623.84960938

2025-02-11 01:58:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-02-11 01:58:47 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:48 - root - INFO - SQL:
SELECT DISTINCT "indicator_name", "indicator_code"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" ILIKE '%health expenditure per capita%PPP%'
   LIMIT 100;
Results:
indicator_name,indicator_code
"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD
"Domestic private health expenditure per capita, PPP  (current international $)",SH.XPD.PVTD.PP.CD
"External health expenditure per capita, PPP (current international $)",SH.XPD.EHEX.PP.CD
"Domestic general government health expenditure per capita, PPP (current international $)",SH.XPD.GHED.PP.CD

2025-02-11 01:58:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:49 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:49 - root - INFO - SQL:
SELECT DISTINCT p."country_code", p."country", h."country_name"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
   INNER JOIN WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
     ON p."country_code" = h."country_code"
   LIMIT 100;
Results:
country_code,country,country_name
CYM,Cayman Islands,Cayman Islands
CAF,Central African Republic,Central African Republic
COL,Colombia,Colombia
COM,Comoros,Comoros
COD,"Congo, Dem. Rep.","Congo, Dem. Rep."
CUB,Cuba,Cuba
CUW,Curacao,Curacao
CIV,Cote d'Ivoire,Cote d'Ivoire
DNK,Denmark,Denmark
ECU,Ecuador,Ecuador
MEX,Mexico,Mexico
MNG,Mongolia,Mongolia
NER,Niger,Niger
PLW,Palau,Palau
FCS,Fragile and conflict affected situations,Fragile and conflict affected situations
ETH,Ethiopia,Ethiopia
GAB,Gabon,Gabon
GMB,"Gambia, The","Gambia, The"
SVK,Slovak Republic,Slovak Republic
MNA,Middle East & North Africa (excluding high income),Middle East & North Africa (excluding high income)
DMA,Dominica,Dominica
NAM,Namibia,Namibia
EAR,Early-demographic dividend,Early-demographic dividend
EMU,Euro area,Euro area
PRY,Paraguay,Paraguay
PRI,Puerto Rico,Puerto Rico
ROU,Romania,Romania
RUS,Russian Federation,Russian Federation
IMN,Isle of Man,Isle of Man
ITA,Italy,Italy
SSA,Sub-Saharan Africa (excluding high income),Sub-Saharan Africa (excluding high income)
LBN,Lebanon,Lebanon
LKA,Sri Lanka,Sri Lanka
LCA,St. Lucia,St. Lucia
TON,Tonga,Tonga
TCA,Turks and Caicos Islands,Turks and Caicos Islands
UKR,Ukraine,Ukraine
VIR,Virgin Islands (U.S.),Virgin Islands (U.S.)
PSE,West Bank and Gaza,West Bank and Gaza
IDN,Indonesia,Indonesia
KAZ,Kazakhstan,Kazakhstan
KOR,"Korea, Rep.","Korea, Rep."
LAO,Lao PDR,Lao PDR
MEA,Middle East & North Africa,Middle East & North Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries),Sub-Saharan Africa (IDA & IBRD countries)
SYR,Syrian Arab Republic,Syrian Arab Republic
TUN,Tunisia,Tunisia
VUT,Vanuatu,Vanuatu
ZMB,Zambia,Zambia
SLV,El Salvador,El Salvador
EAS,East Asia & Pacific,East Asia & Pacific
GEO,Georgia,Georgia
KIR,Kiribati,Kiribati
TMN,Middle East & North Africa (IDA & IBRD countries),Middle East & North Africa (IDA & IBRD countries)
PST,Post-demographic dividend,Post-demographic dividend
SSD,South Sudan,South Sudan
SOM,Somalia,Somalia
BMU,Bermuda,Bermuda
NOR,Norway,Norway
IBT,IDA & IBRD total,IDA & IBRD total
LAC,Latin America & Caribbean (excluding high income),Latin America & Caribbean (excluding high income)
EST,Estonia,Estonia
IRQ,Iraq,Iraq
PRE,Pre-demographic dividend,Pre-demographic dividend
DZA,Algeria,Algeria
AND,Andorra,Andorra
LUX,Luxembourg,Luxembourg
MYS,Malaysia,Malaysia
SDN,Sudan,Sudan
SWE,Sweden,Sweden
TTO,Trinidad and Tobago,Trinidad and Tobago
TUR,Turkey,Turkey
AZE,Azerbaijan,Azerbaijan
BDI,Burundi,Burundi
VNM,Vietnam,Vietnam
LVA,Latvia,Latvia
HTI,Haiti,Haiti
CMR,Cameroon,Cameroon
YEM,"Yemen, Rep.","Yemen, Rep."
PSS,Pacific island small states,Pacific island small states
ZWE,Zimbabwe,Zimbabwe
UGA,Uganda,Uganda
CAN,Canada,Canada
TCD,Chad,Chad
CHN,China,China
COG,"Congo, Rep.","Congo, Rep."
CRI,Costa Rica,Costa Rica
CYP,Cyprus,Cyprus
CZE,Czech Republic,Czech Republic
DJI,Djibouti,Djibouti
MCO,Monaco,Monaco
MNE,Montenegro,Montenegro
NIC,Nicaragua,Nicaragua
NZL,New Zealand,New Zealand
TLA,Latin America & the Caribbean (IDA & IBRD countries),Latin America & the Caribbean (IDA & IBRD countries)
FRO,Faroe Islands,Faroe Islands
PRT,Portugal,Portugal
MOZ,Mozambique,Mozambique
NCL,New Caledonia,New Caledonia
NGA,Nigeria,Nigeria

2025-02-11 01:58:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:50 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:51 - root - INFO - SQL:
SELECT p."country_code", p."country",
           p."year_2018" AS "population_2018",
           h."value" AS "health_expenditure_2018"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      ON p."country_code" = h."country_code"
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" = 2018
    LIMIT 100;
Results:
country_code,country,population_2018,health_expenditure_2018
SRB,Serbia,6982084,1484.64892578
KHM,Cambodia,16249798,261.15719604
ARE,United Arab Emirates,9630959,3172.60766602
CYP,Cyprus,1189265,2624.85083008
LMC,Lower middle income,3022905169,333.591007921496
MDV,Maldives,515696,1442.57324219
LIC,Low income,705417321,109.124446932298
PER,Peru,31989256,766.63635254
EAR,Early-demographic dividend,3249140605,480.325291422422
FJI,Fiji,883483,372.46304321
TCD,Chad,15477751,79.01350403
MNA,Middle East & North Africa (excluding high income),382896715,947.93063782341
TMN,Middle East & North Africa (IDA & IBRD countries),378327628,947.93063782341
WLD,World,7594270356,1459.31871076191
SAU,Saudi Arabia,33699947,3519.90722656
DOM,Dominican Republic,10627165,1017.50299072
KEN,Kenya,51393010,179.18043518
VEN,"Venezuela, RB",28870195,383.50854492
CAN,Canada,37058856,5199.97314453
GIN,Guinea,12414318,109.24282074
PAK,Pakistan,212215030,178.24232483
LVA,Latvia,1926542,1895.77575684
DNK,Denmark,5797446,5794.25927734
NRU,Nauru,12704,1174.43530273
QAT,Qatar,2781677,3165.85791016
USA,United States,327167434,10623.84960938
TEC,Europe & Central Asia (IDA & IBRD countries),459865205,1210.53899563655
BRA,Brazil,209469333,1530.82226563
NGA,Nigeria,195874740,232.99221802
MKD,North Macedonia,2082958,1073.19555664
NAM,Namibia,2448255,882.66326904
RWA,Rwanda,12301939,169.82418823
LDC,Least developed countries: UN classification,1009662578,130.254941480156
CEB,Central Europe and the Baltics,102511922,2059.08574115019
CPV,Cabo Verde,543767,399.53582764
BRN,Brunei Darussalam,428962,1952.52880859
PHL,Philippines,106651922,393.90402222
PLW,Palau,17907,2011.51733398
LKA,Sri Lanka,21670000,516.92150879
STP,Sao Tome and Principe,211028,213.92353821
HTI,Haiti,11123176,143.62878418
PSS,Pacific island small states,2457367,290.443360144599
CHN,China,1392730000,935.19287109
DEU,Germany,82927922,6098.20263672
NOR,Norway,5314336,6818.34619141
SST,Small states,40575321,1093.93478075819
IRL,Ireland,4853506,5896.69189453
TZA,Tanzania,56318348,112.45636749
BTN,Bhutan,754394,322.09790039
ZMB,Zambia,17351822,208.44441223
ECA,Europe & Central Asia (excluding high income),417797257,1130.37029372877
GTM,Guatemala,17247807,482.96057129
OMN,Oman,4829483,1729.54199219
TUN,Tunisia,11565204,912.25427246
SGP,Singapore,5638676,4439.28173828
ZAF,South Africa,57779622,1129.38391113
FIN,Finland,5518050,4457.17089844
MNE,Montenegro,622345,1711.20996094
PRE,Pre-demographic dividend,919485393,178.598043761294
BIH,Bosnia and Herzegovina,3323929,1300.77648926
SLE,Sierra Leone,7650154,257.32653809
BRB,Barbados,286641,1203.78686523
MEA,Middle East & North Africa,448912859,1336.40615439374
TEA,East Asia & Pacific (IDA & IBRD countries),2056064424,777.95938741222
MHL,Marshall Islands,58413,677.16558838
SMR,San Marino,33785,4340.04199219
NIC,Nicaragua,6465513,473.92501831
POL,Poland,37978548,2015.28588867
FCS,Fragile and conflict affected situations,515215936,207.551309936779
GRD,Grenada,111454,693.81774902
SVN,Slovenia,2067372,3158.38500977
VCT,St. Vincent and the Grenadines,110210,549.60974121
MEX,Mexico,126190788,1065.95007324
MAR,Morocco,36029138,467.12515259
AGO,Angola,30809762,164.70602417
WSM,Samoa,196130,355.18405151
CMR,Cameroon,25216237,133.60945129
THA,Thailand,69428524,722.69683838
VNM,Vietnam,95540395,440.16650391
SLB,Solomon Islands,652858,107.63027954
JPN,Japan,126529100,4503.68212891
NER,Niger,22442948,77.98433685
SEN,Senegal,15854360,146.39419556
CRI,Costa Rica,4999441,1336.52856445
ALB,Albania,2866376,697.30487061
LCA,St. Lucia,181889,610.52154541
AND,Andorra,77006,3607.00097656
TSA,South Asia (IDA & IBRD),1814388744,249.034231503484
SAS,South Asia,1814388744,249.034231503484
SSD,South Sudan,10975920,113.77922821
AZE,Azerbaijan,9942334,633.56213379
EAP,East Asia & Pacific (excluding high income),2081651801,777.946582331166
GNQ,Equatorial Guinea,1308974,696.58062744
HND,Honduras,9587522,362.26046753
IBT,IDA & IBRD total,6412522234,614.910672222532
BFA,Burkina Faso,19751535,111.71577454
JAM,Jamaica,2934855,559.11590576
DMA,Dominica,71625,710.24499512
TTO,Trinidad and Tobago,1389858,2099.59667969
BDI,Burundi,11175378,65.79267883

2025-02-11 01:58:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:52 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:53 - root - INFO - SQL:
SELECT h."country_code", h."country_name",
           SUM(CASE WHEN h."year" = 2017 THEN h."value" END) AS "health_expenditure_2017",
           SUM(CASE WHEN h."year" = 2018 THEN h."value" END) AS "health_expenditure_2018",
           (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
              SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
              SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" IN (2017, 2018)
    GROUP BY h."country_code", h."country_name"
    LIMIT 100;
Results:
Too long, hard cut:
country_code,country_name,health_expenditure_2017,health_expenditure_2018,health_expenditure_growth_pct
PLW,Palau,2164.40844727,2011.51733398,-7.063875281157944
EMU,Euro area,4572.35296577739,4699.88206161339,2.789134976903903
GHA,Ghana,148.41990662,167.97952271,13.178566497874536
SSD,South Sudan,147.8605957,113.77922821,-23.04966196615966
SDN,Sudan,311.76040649,293.05581665,-5.999668158823738
IRN,"Iran, Islamic Rep.",1758.99145508,1691.33569336,-3.8462814315901754
BHS,"Bahamas, The",2128.2644043,2005.24621582,-5.780211717653635
DJI,Djibouti,134.43319702,134.88937378,0.3393334162335949
MUS,Mauritius,1278.09350586,1380.73596191,8.030903496449127
MNE,Montenegro,,1711.20996094,
POL,Poland,1978.63806152,2015.28588867,1.8521743750267778
LCA,St. Lucia,636.71325684,610.52154541,-4.113580351693804
ARG,Argentina,2184.91918945,1989.63562012,-8.937793684678915
DEU,Germany,5930.57617188,6098.20263672,2.826478574456307
PER,Peru,698.16088867,766.63635254,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),201.156557039325,205.394948790297,2.1070114806863676
BHR,Bahrain,2263.04296875,1955.35192871,-13.596341045612325
CPV,Cabo Verde,375.52709961,399.53582764,6.393341001204444
MEA,Middle East & North Africa,1378.03787525822,1336.40615439374,-3.0210868374484248
LBN,Lebanon,1081.28100586,1085.85119629,0.42266445126028984
NZL,New Zealand,3815.65722656,4024.38623047,5.470329002749014
THA,Thailand,686.5927124,722.69683838,5.258448761245554
MDV,Maldives,1347.38793945,1442.57324219,7.064431850180757
KHM,Cambodia,238.10375977,261.15719604,9.682096701147762
HRV,Croatia,1773.44177246,1876.10449219,5.788897122209604
CHE,Switzerland,7928.17480469,8113.94335938,2.343144030831746
TUR,Turkey,1176.02050781,1170.77990723,-0.44562152999858845
VEN,"Venezuela, RB",783.46325684,383.50854492,-51.04958125709261
CYP,Cyprus,2498.46508789,2624.85083008,5.058535450528741
VCT,St. Vincent and the Grenadines,507.44885254,549.60974121,8.308401617023394
LKA,Sri Lanka,497.98007202,516.92150879,3.803653566530511
CAF,Central African Republic,54.73753357,97.0058136,77.21992072577778
SLV,El Salvador,576.23730469,592.34143066,2.794703820618421
EAP,East Asia & Pacific (excluding high income),704.021942568792,777.946582331166,10.500331778387803
FRA,France,5110.13427734,5250.4453125,2.7457406703026312
LBR,Liberia,123.56186676,102.82676697,-16.78114804648813
LSO,Lesotho,283.69839478,308.99752808,8.91761594901471
ALB,Albania,645.47076416,697.30487061,8.030434425245513
BTN,Bhutan,314.59326172,322.09790039,2.3855052167898734
TZA,Tanzania,109.09073639,112.45636749,3.085166725768402
COD,"Congo, Dem. Rep.",36.94486618,30.71561813,-16.86093006711765
MEX,Mexico,1071.98608398,1065.95007324,-0.5630680127478949
OED,OECD members,5087.30788659975,5265.68162084414,3.506250028904982
TSA,South Asia (IDA & IBRD),229.036851793622,249.034231503484,8.731075175570883
TON,Tonga,348.17059326,355.33111572,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),1153.4243527552,1210.53899563655,4.951745881289868
PRT,Portugal,3084.17285156,3242.35180664,5.128731841342556
BEN,Benin,82.49481201,83.21243286,0.8698981578538698
EGY,"Egypt, Arab Rep.",661.4362793,614.10858154,-7.155292088012925
NER,Niger,77.6079483,77.98433685,0.4849871156818115
COG,"Congo, Rep.",169.05439758,125.36307526,-25.844534626391113
STP,Sao Tome and Principe,213.72305298,213.92353821,0.093806085588137
NAC,North America,9685.5744676568,10071.4036599167,3.9835447401525426
TMN,Middle East & North Africa (IDA & IBRD countries),977.686984569154,947.93063782341,-3.043545348909082
TKM,Turkmenistan,1250.31787109,1275.11584473,1.9833335356857433
KGZ,Kyrgyz Republic,231.27180481,259.92599487,12.389832856426533
AFW,Africa Western and Central,172.544544804834,178.788550681486,3.618779071638926
ARE,United Arab Emirates,3031.24536133,3172.60766602,4.663505847905878
ARM,Armenia,996.98303223,1036.95446777,4.009239299749563
BRN,Brunei Darussalam,1811.43640137,1952.52880859,7.7889793488355865
ZWE,Zimbabwe,198.81242371,198.01686096,-0.4001574625740916
UKR,Ukraine,616.94689941,682.50952148,10.626947332533637
GTM,Guatemala,474.80758667,482.96057129,1.7171133842194721
FSM,"Micronesia, Fed. Sts.",426.59359741,414.04211426,-2.9422577427801175
KOR,"Korea, Rep.",2929.06567383,3213.66333008,9.716328957481673
CHL,Chile,2193.38256836,2305.67651367,5.119669816376942
MAR,Morocco,439.59942627,467.12515259,6.26154737133207
HPC,Heavily indebted poor countries (HIPC),131.779229316185,130.77576704758,-0.7614722546277339
LTU,Lithuania,2142.75537109,2312.95532227,7.943041631178868
AGO,Angola,185.65101624,164.70602417,-11.281916196420593
GUY,Guyana,467.41693115,512.92156982,9.735342397213454
WSM,Samoa,361.72091675,355.18405151,-1.8071571029766822
COM,Comoros,131.12634277,134.20884705,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),1071.25149221499,1130.37029372877,5.5186668997344475
DZA,Algeria,970.26824951,962.71936035,-0.7780208374140188
IND,India,253.42102051,275.13040161,8.56652737658095
CAN,Canada,5023.35107422,

2025-02-11 01:58:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:54 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:54 - root - INFO - SQL:
SELECT *
    FROM (
      SELECT h."country_code", h."country_name",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code", h."country_name"
    ) sub
    WHERE "health_expenditure_growth_pct" > 1
    LIMIT 100;
Results:
country_code,country_name,health_expenditure_growth_pct
EMU,Euro area,2.789134976903903
GHA,Ghana,13.178566497874536
MUS,Mauritius,8.030903496449127
POL,Poland,1.8521743750267778
DEU,Germany,2.826478574456307
PER,Peru,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),2.1070114806863676
CPV,Cabo Verde,6.393341001204444
NZL,New Zealand,5.470329002749014
THA,Thailand,5.258448761245554
MDV,Maldives,7.064431850180757
KHM,Cambodia,9.682096701147762
HRV,Croatia,5.788897122209604
CHE,Switzerland,2.343144030831746
CYP,Cyprus,5.058535450528741
VCT,St. Vincent and the Grenadines,8.308401617023394
LKA,Sri Lanka,3.803653566530511
CAF,Central African Republic,77.21992072577778
SLV,El Salvador,2.794703820618421
EAP,East Asia & Pacific (excluding high income),10.500331778387803
FRA,France,2.7457406703026312
LSO,Lesotho,8.91761594901471
ALB,Albania,8.030434425245513
BTN,Bhutan,2.3855052167898734
TZA,Tanzania,3.085166725768402
OED,OECD members,3.506250028904982
TSA,South Asia (IDA & IBRD),8.731075175570883
TON,Tonga,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),4.951745881289868
PRT,Portugal,5.128731841342556
NAC,North America,3.9835447401525426
TKM,Turkmenistan,1.9833335356857433
KGZ,Kyrgyz Republic,12.389832856426533
AFW,Africa Western and Central,3.618779071638926
ARE,United Arab Emirates,4.663505847905878
ARM,Armenia,4.009239299749563
BRN,Brunei Darussalam,7.7889793488355865
UKR,Ukraine,10.626947332533637
GTM,Guatemala,1.7171133842194721
KOR,"Korea, Rep.",9.716328957481673
CHL,Chile,5.119669816376942
MAR,Morocco,6.26154737133207
LTU,Lithuania,7.943041631178868
GUY,Guyana,9.735342397213454
COM,Comoros,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),5.5186668997344475
IND,India,8.56652737658095
CAN,Canada,3.516020833511536
LAC,Latin America & Caribbean (excluding high income),1.0247826301139413
CZE,Czech Republic,10.428450078440672
TGO,Togo,7.758083762284739
TEA,East Asia & Pacific (IDA & IBRD countries),10.499561632363628
ZMB,Zambia,15.890200401377808
SRB,Serbia,10.058843469188531
GRC,Greece,2.9283178857691543
NGA,Nigeria,5.373821440597682
AUS,Australia,5.91302435775189
OMN,Oman,4.722239797281134
UMC,Upper middle income,6.920495089257177
FJI,Fiji,13.145350273636053
TUN,Tunisia,4.336137968605618
SSF,Sub-Saharan Africa,2.1070114806863676
VNM,Vietnam,8.32414383351091
ESP,Spain,2.700058958823298
HND,Honduras,5.245476561131182
PST,Post-demographic dividend,3.867870173090837
BEL,Belgium,2.1839077488751304
COL,Colombia,3.708053183245905
NLD,Netherlands,2.466818982241543
ECS,Europe & Central Asia,3.35960082147429
MRT,Mauritania,4.900233038497389
TLS,Timor-Leste,9.620727328816782
MNG,Mongolia,1.3580223967446232
PHL,Philippines,6.225895901836266
IDN,Indonesia,6.520882793655053
MIC,Middle income,6.101815985663521
ATG,Antigua and Barbuda,10.299268289062342
ROU,Romania,15.24165413416109
PAK,Pakistan,17.164876726309394
HIC,High income,3.534800089198823
PRY,Paraguay,8.354755847720794
SVN,Slovenia,6.680814639667525
SAS,South Asia,8.731075175570883
ISR,Israel,3.8699594203796184
FIN,Finland,2.7020203469470228
HUN,Hungary,5.561813157697172
AUT,Austria,3.613654824294838
RUS,Russian Federation,7.1229421476828465
ERI,Eritrea,23.472064126363087
BGR,Bulgaria,3.726355957259228
MKD,North Macedonia,6.123092927453969
LMC,Lower middle income,4.859841588386322
ITA,Italy,1.4552065516257022
DMA,Dominica,21.686427226054047
EAR,Early-demographic dividend,1.155713263926843
GBR,United Kingdom,3.2750742533610016
GNB,Guinea-Bissau,3.703319526850014
ETH,Ethiopia,1.699153922164326
MHL,Marshall Islands,11.769399246987488
PSS,Pacific island small states,6.218577578310462

2025-02-11 01:58:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 01:58:56 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:57 - root - INFO - SQL:
SELECT p."country_code", p."country",
           ((p."year_2018" - p."year_2017") / p."year_2017" * 100) AS "population_growth_pct",
           h."health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN (
      SELECT h."country_code",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code"
    ) h
      ON p."country_code" = h."country_code"
    LIMIT 100;
Results:
country_code,country,population_growth_pct,health_expenditure_growth_pct
SRB,Serbia,-0.552300,10.058843469188531
KHM,Cambodia,1.501500,9.682096701147762
ARE,United Arab Emirates,1.515300,4.663505847905878
CYP,Cyprus,0.812500,5.058535450528741
LMC,Lower middle income,1.391400,4.859841588386322
MDV,Maldives,3.886800,7.064431850180757
LIC,Low income,2.613700,-4.2655355575512415
PER,Peru,1.733100,9.807977642581225
EAR,Early-demographic dividend,1.308100,1.155713263926843
FJI,Fiji,0.686500,13.145350273636053
TCD,Chad,3.069800,-7.782875489518702
MNA,Middle East & North Africa (excluding high income),1.686400,-3.043545348909082
TMN,Middle East & North Africa (IDA & IBRD countries),1.675800,-3.043545348909082
WLD,World,1.108800,3.803807230162976
SAU,Saudi Arabia,1.815200,-6.392527005315368
DOM,Dominican Republic,1.084700,6.597805657430963
KEN,Kenya,2.332700,13.694728244781942
VEN,"Venezuela, RB",-1.770000,-51.04958125709261
CAN,Canada,1.419200,3.516020833511536
GIN,Guinea,2.873700,8.043626497028214
PAK,Pakistan,2.077200,17.164876726309394
LVA,Latvia,-0.808700,11.227458011940097
DNK,Denmark,0.563200,3.6649324886397423
NRU,Nauru,-1.335800,-17.914344696955613
QAT,Qatar,2.090200,-6.649542924759741
USA,United States,0.621400,4.057137380431737
TEC,Europe & Central Asia (IDA & IBRD countries),0.448900,4.951745881289868
BRA,Brazil,0.786900,3.2571908913740963
NGA,Nigeria,2.620300,5.373821440597682
MKD,North Macedonia,0.046200,6.123092927453969
NAM,Namibia,1.900100,-4.1059460982336
RWA,Rwanda,2.679300,17.930277482427908
LDC,Least developed countries: UN classification,2.362000,0.5079618084527765
CEB,Central Europe and the Baltics,-0.220900,6.312226369688209
CPV,Cabo Verde,1.166500,6.393341001204444
BRN,Brunei Darussalam,1.057500,7.7889793488355865
PHL,Philippines,1.405900,6.225895901836266
PLW,Palau,0.555900,-7.063875281157944
LKA,Sri Lanka,1.053900,3.803653566530511
STP,Sao Tome and Principe,1.902100,0.093806085588137
HTI,Haiti,1.282100,-2.2981816246458204
PSS,Pacific island small states,1.456600,6.218577578310462
CHN,China,0.456900,11.628472188133323
DEU,Germany,0.327800,2.826478574456307
NOR,Norway,0.708100,4.641469635457937
SST,Small states,1.728500,0.3733356148596855
IRL,Ireland,0.959300,4.982530621027306
TZA,Tanzania,3.026600,3.085166725768402
BTN,Bhutan,1.183800,2.3855052167898734
ZMB,Zambia,2.955600,15.890200401377808
ECA,Europe & Central Asia (excluding high income),0.501900,5.5186668997344475
GTM,Guatemala,1.967900,1.7171133842194721
OMN,Oman,3.505100,4.722239797281134
TUN,Tunisia,1.152400,4.336137968605618
SGP,Singapore,0.470800,5.850614474042322
ZAF,South Africa,1.367000,3.6050576582534437
FIN,Finland,0.178600,2.7020203469470228
MNE,Montenegro,-0.004500,
PRE,Pre-demographic dividend,2.791800,0.027640701520033784
BIH,Bosnia and Herzegovina,-0.823400,6.034157731189415
SLE,Sierra Leone,2.159600,0.7938218928838047
BRB,Barbados,0.142500,-0.052236967280010066
MEA,Middle East & North Africa,1.735400,-3.0210868374484248
TEA,East Asia & Pacific (IDA & IBRD countries),0.654900,10.499561632363628
MHL,Marshall Islands,0.611500,11.769399246987488
SMR,San Marino,0.338600,1.8130555762403138
NIC,Nicaragua,1.263300,0.19474313578897326
POL,Poland,0.009800,1.8521743750267778
FCS,Fragile and conflict affected situations,2.201200,-7.431140913015866
GRD,Grenada,0.523100,3.0928087481277493
SVN,Slovenia,0.047600,6.680814639667525
VCT,St. Vincent and the Grenadines,0.348700,8.308401617023394
MEX,Mexico,1.132800,-0.5630680127478949
MAR,Morocco,1.258700,6.26154737133207
AGO,Angola,3.330400,-11.281916196420593
WSM,Samoa,0.398300,-1.8071571029766822
CMR,Cameroon,2.646700,4.960110566297106
THA,Thailand,0.315900,5.258448761245554
VNM,Vietnam,0.997700,8.32414383351091
SLB,Solomon Islands,2.644500,-2.6989051392649808
JPN,Japan,-0.202500,2.672329510093784
NER,Niger,3.890600,0.4849871156818115
SEN,Senegal,2.821000,2.147548484177809
CRI,Costa Rica,0.999700,7.425011128893834
ALB,Albania,-0.246400,8.030434425245513
LCA,St. Lucia,0.516200,-4.113580351693804
AND,Andorra,0.006500,8.664081204957636
TSA,South Asia (IDA & IBRD),1.202200,8.731075175570883
SAS,South Asia,1.202200,8.731075175570883
SSD,South Sudan,0.597200,-23.04966196615966
AZE,Azerbaijan,0.896100,-3.334361735734003
EAP,East Asia & Pacific (excluding high income),0.652600,10.500331778387803
GNQ,Equatorial Guinea,3.722100,-5.674867237231175
HND,Honduras,1.681100,5.245476561131182
IBT,IDA & IBRD total,1.223100,5.365268511981853
BFA,Burkina Faso,2.908600,-13.405671454192172
JAM,Jamaica,0.479400,1.265969012259397
DMA,Dominica,0.233700,21.686427226054047
TTO,Trinidad and Tobago,0.418000,-3.9807692412533333
BDI,Burundi,3.217400,10.771295086675051

2025-02-11 01:58:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 76
2025-02-11 01:58:58 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:58:58 - root - INFO - SQL:
SELECT p."country_code", p."country"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN (
      SELECT h."country_code",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code"
    ) h
      ON p."country_code" = h."country_code"
    WHERE ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
      AND h."health_expenditure_growth_pct" > 1
    LIMIT 100;
Results:
country_code,country
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
MDV,Maldives
PER,Peru
EAR,Early-demographic dividend
WLD,World
DOM,Dominican Republic
KEN,Kenya
CAN,Canada
GIN,Guinea
PAK,Pakistan
NGA,Nigeria
RWA,Rwanda
CPV,Cabo Verde
BRN,Brunei Darussalam
PHL,Philippines
LKA,Sri Lanka
PSS,Pacific island small states
TZA,Tanzania
BTN,Bhutan
ZMB,Zambia
GTM,Guatemala
OMN,Oman
TUN,Tunisia
ZAF,South Africa
MAR,Morocco
CMR,Cameroon
SEN,Senegal
TSA,South Asia (IDA & IBRD)
SAS,South Asia
HND,Honduras
IBT,IDA & IBRD total
BDI,Burundi
ETH,Ethiopia
PRY,Paraguay
MNG,Mongolia
LUX,Luxembourg
COL,Colombia
AUS,Australia
CHL,Chile
TJK,Tajikistan
TON,Tonga
KGZ,Kyrgyz Republic
MIC,Middle income
COM,Comoros
LMY,Low & middle income
IDN,Indonesia
BLZ,Belize
TLS,Timor-Leste
TKM,Turkmenistan
MYS,Malaysia
BGD,Bangladesh
PAN,Panama
SSF,Sub-Saharan Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries)
GNB,Guinea-Bissau
VUT,Vanuatu
TUV,Tuvalu
MRT,Mauritania
ISL,Iceland
NZL,New Zealand
NPL,Nepal
UZB,Uzbekistan
GHA,Ghana
IND,India
TGO,Togo
SSA,Sub-Saharan Africa (excluding high income)
ISR,Israel
CAF,Central African Republic
MOZ,Mozambique
SWE,Sweden
KIR,Kiribati
PNG,Papua New Guinea
UGA,Uganda
BOL,Bolivia

2025-02-11 01:58:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:58:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:58:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:58:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 01:58:59 - snowflake.connector.connection - INFO - closed
2025-02-11 01:58:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:00 - root - INFO - SQL:
SELECT COUNT(*) AS "Number_of_Countries"
    FROM (
      SELECT p."country_code"
      FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
      INNER JOIN (
        SELECT h."country_code",
               (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                  SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                  SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
        FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
        WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND h."year" IN (2017, 2018)
        GROUP BY h."country_code"
      ) h
        ON p."country_code" = h."country_code"
      WHERE ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
        AND h."health_expenditure_growth_pct" > 1
    ) sub;
Results:
Number_of_Countries
76

2025-02-11 01:59:00 - root - INFO - itercount: 0
2025-02-11 01:59:00 - root - INFO - Database Name: WORLD_BANK
Schema Name: WORLD_BANK_GLOBAL_POPULATION
,0
table_name,POPULATION_BY_COUNTRY
description,
DDL,"create or replace TABLE POPULATION_BY_COUNTRY (
	""country"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""year_1960"" NUMBER(38,0),
	""year_1961"" NUMBER(38,0),
	""year_1962"" NUMBER(38,0),
	""year_1963"" NUMBER(38,0),
	""year_1964"" NUMBER(38,0),
	""year_1965"" NUMBER(38,0),
	""year_1966"" NUMBER(38,0),
	""year_1967"" NUMBER(38,0),
	""year_1968"" NUMBER(38,0),
	""year_1969"" NUMBER(38,0),
	""year_1970"" NUMBER(38,0),
	""year_1971"" NUMBER(38,0),
	""year_1972"" NUMBER(38,0),
	""year_1973"" NUMBER(38,0),
	""year_1974"" NUMBER(38,0),
	""year_1975"" NUMBER(38,0),
	""year_1976"" NUMBER(38,0),
	""year_1977"" NUMBER(38,0),
	""year_1978"" NUMBER(38,0),
	""year_1979"" NUMBER(38,0),
	""year_1980"" NUMBER(38,0),
	""year_1981"" NUMBER(38,0),
	""year_1982"" NUMBER(38,0),
	""year_1983"" NUMBER(38,0),
	""year_1984"" NUMBER(38,0),
	""year_1985"" NUMBER(38,0),
	""year_1986"" NUMBER(38,0),
	""year_1987"" NUMBER(38,0),
	""year_1988"" NUMBER(38,0),
	""year_1989"" NUMBER(38,0),
	""year_1990"" NUMBER(38,0),
	""year_1991"" NUMBER(38,0),
	""year_1992"" NUMBER(38,0),
	""year_1993"" NUMBER(38,0),
	""year_1994"" NUMBER(38,0),
	""year_1995"" NUMBER(38,0),
	""year_1996"" NUMBER(38,0),
	""year_1997"" NUMBER(38,0),
	""year_1998"" NUMBER(38,0),
	""year_1999"" NUMBER(38,0),
	""year_2000"" NUMBER(38,0),
	""year_2001"" NUMBER(38,0),
	""year_2002"" NUMBER(38,0),
	""year_2003"" NUMBER(38,0),
	""year_2004"" NUMBER(38,0),
	""year_2005"" NUMBER(38,0),
	""year_2006"" NUMBER(38,0),
	""year_2007"" NUMBER(38,0),
	""year_2008"" NUMBER(38,0),
	""year_2009"" NUMBER(38,0),
	""year_2010"" NUMBER(38,0),
	""year_2011"" NUMBER(38,0),
	""year_2012"" NUMBER(38,0),
	""year_2013"" NUMBER(38,0),
	""year_2014"" NUMBER(38,0),
	""year_2015"" NUMBER(38,0),
	""year_2016"" NUMBER(38,0),
	""year_2017"" NUMBER(38,0),
	""year_2018"" NUMBER(38,0),
	""year_2019"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,0
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,1
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,2
table_name,HEALTH_NUTRITION_POPULATION
description,
DDL,"create or replace TABLE HEALTH_NUTRITION_POPULATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" NUMBER(38,0),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_HEALTH_POPULATION
,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_Income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,1
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,2
table_name,INTERNATIONAL_DEBT
description,
DDL,"create or replace TABLE INTERNATIONAL_DEBT (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,3
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_DEBT
,4
table_name,SERIES_TIMES
description,
DDL,"create or replace TABLE SERIES_TIMES (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_two_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" NUMBER(38,0),
	""latest_trade_data"" NUMBER(38,0),
	""latest_water_withdrawal_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,1
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,2
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_INTL_EDUCATION
,3
table_name,INTERNATIONAL_EDUCATION
description,
DDL,"create or replace TABLE INTERNATIONAL_EDUCATION (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,0
table_name,COUNTRY_SUMMARY
description,
DDL,"create or replace TABLE COUNTRY_SUMMARY (
	""country_code"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""table_name"" VARCHAR(16777216),
	""long_name"" VARCHAR(16777216),
	""two_alpha_code"" VARCHAR(16777216),
	""currency_unit"" VARCHAR(16777216),
	""special_notes"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""income_group"" VARCHAR(16777216),
	""wb_2_code"" VARCHAR(16777216),
	""national_accounts_base_year"" VARCHAR(16777216),
	""national_accounts_reference_year"" VARCHAR(16777216),
	""sna_price_valuation"" VARCHAR(16777216),
	""lending_category"" VARCHAR(16777216),
	""other_groups"" VARCHAR(16777216),
	""system_of_national_accounts"" VARCHAR(16777216),
	""alternative_conversion_factor"" VARCHAR(16777216),
	""ppp_survey_year"" VARCHAR(16777216),
	""balance_of_payments_manual_in_use"" VARCHAR(16777216),
	""external_debt_reporting_status"" VARCHAR(16777216),
	""system_of_trade"" VARCHAR(16777216),
	""government_accounting_concept"" VARCHAR(16777216),
	""imf_data_dissemination_standard"" VARCHAR(16777216),
	""latest_population_census"" VARCHAR(16777216),
	""latest_household_survey"" VARCHAR(16777216),
	""source_of_most_recent_income_and_expenditure_data"" VARCHAR(16777216),
	""vital_registration_complete"" VARCHAR(16777216),
	""latest_agricultural_census"" VARCHAR(16777216),
	""latest_industrial_data"" VARCHAR(16777216),
	""latest_trade_data"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,1
table_name,SERIES_TIME
description,
DDL,"create or replace TABLE SERIES_TIME (
	""series_code"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,2
table_name,INDICATORS_DATA
description,
DDL,"create or replace TABLE INDICATORS_DATA (
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""indicator_code"" VARCHAR(16777216),
	""value"" FLOAT,
	""year"" NUMBER(38,0)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,3
table_name,COUNTRY_SERIES_DEFINITIONS
description,
DDL,"create or replace TABLE COUNTRY_SERIES_DEFINITIONS (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,4
table_name,FOOTNOTES
description,
DDL,"create or replace TABLE FOOTNOTES (
	""country_code"" VARCHAR(16777216),
	""series_code"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""description"" VARCHAR(16777216)
);"

Database Name: WORLD_BANK
Schema Name: WORLD_BANK_WDI
,5
table_name,SERIES_SUMMARY
description,
DDL,"create or replace TABLE SERIES_SUMMARY (
	""series_code"" VARCHAR(16777216),
	""topic"" VARCHAR(16777216),
	""indicator_name"" VARCHAR(16777216),
	""short_definition"" VARCHAR(16777216),
	""long_definition"" VARCHAR(16777216),
	""unit_of_measure"" VARCHAR(16777216),
	""periodicity"" VARCHAR(16777216),
	""base_period"" VARCHAR(16777216),
	""other_notes"" VARCHAR(16777216),
	""aggregation_method"" VARCHAR(16777216),
	""limitations_and_exceptions"" VARCHAR(16777216),
	""notes_from_original_source"" VARCHAR(16777216),
	""general_comments"" VARCHAR(16777216),
	""source"" VARCHAR(16777216),
	""statistical_concept_and_methodology"" VARCHAR(16777216),
	""development_relevance"" VARCHAR(16777216),
	""related_source_links"" VARCHAR(16777216),
	""other_web_links"" VARCHAR(16777216),
	""related_indicators"" VARCHAR(16777216),
	""license_type"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SUMMARY', 'SERIES_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_EDUCATION'], 'WORLD_BANK_WDI': ['COUNTRY_SUMMARY', 'SERIES_TIME', 'INDICATORS_DATA', 'COUNTRY_SERIES_DEFINITIONS', 'FOOTNOTES', 'SERIES_SUMMARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY`

   - `"country"`: Country name; used for identification and joining.
   - `"country_code"`: Country code; used for identification and joining.
   - `"year_2017"`: Total population in 2017; used to calculate population growth.
   - `"year_2018"`: Total population in 2018; used to calculate population growth.

2. **Table:** `WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION`

   - `"country_name"`: Country name; used for identification and joining.
   - `"country_code"`: Country code; used for identification and joining.
   - `"indicator_name"`: Name of the indicator; used to filter for per capita health expenditure (PPP).
   - `"indicator_code"`: Code of the indicator; used to filter for per capita health expenditure (PPP).
   - `"value"`: Indicator value; used to calculate health expenditure growth.
   - `"year"`: Year of the data; used to select data from 2017 and 2018.

**Conditions that may be used:**

- Filter the `HEALTH_NUTRITION_POPULATION` table where `"indicator_name"` or `"indicator_code"` matches the per capita current health expenditure (PPP) indicator.
- Select data where `"year"` is 2017 or 2018.
- Join the two tables on `"country_code"` to associate population data with health expenditure data.
- Calculate the percentage increase in population and health expenditure between 2017 and 2018.
- Identify countries where both increases are greater than 1%.

**SQL Queries:**

1. **List unique countries from the population table:**

   ```sql
   SELECT DISTINCT "country_code", "country"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
   ```

2. **Preview the population data for 2017 and 2018:**

   ```sql
   SELECT "country_code", "country", "year_2017", "year_2018"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
   ```

3. **List distinct indicator names related to health expenditure:**

   ```sql
   SELECT DISTINCT "indicator_name", "indicator_code"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" ILIKE '%health expenditure per capita%'
   LIMIT 100;
   ```

4. **Select health expenditure data for 2017 and 2018:**

   ```sql
   SELECT "country_code", "country_name", "indicator_name", "year", "value"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   LIMIT 100;
   ```

5. **Find countries with health expenditure data in both 2017 and 2018:**

   ```sql
   SELECT "country_code", "country_name"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   HAVING COUNT(DISTINCT "year") = 2
   LIMIT 100;
   ```

6. **Calculate population growth percentage between 2017 and 2018:**

   ```sql
   SELECT "country_code", "country",
          "year_2017", "year_2018",
          (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) AS "population_growth_pct"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
   ```

7. **Select health expenditure values for a specific country:**

   ```sql
   SELECT "country_code", "country_name", "year", "value" AS "health_expenditure"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "country_name" = 'United States'
     AND "year" IN (2017, 2018)
   ORDER BY "year"
   LIMIT 100;
   ```

8. **Find the indicator codes for health expenditure per capita (PPP):**

   ```sql
   SELECT DISTINCT "indicator_name", "indicator_code"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" ILIKE '%health expenditure per capita%PPP%'
   LIMIT 100;
   ```

9. **List countries present in both population and health datasets:**

   ```sql
   SELECT DISTINCT p."country_code", p."country", h."country_name"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
   INNER JOIN WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
     ON p."country_code" = h."country_code"
   LIMIT 100;
   ```

10. **Retrieve health expenditure and population data for countries in 2018:**

    ```sql
    SELECT p."country_code", p."country",
           p."year_2018" AS "population_2018",
           h."value" AS "health_expenditure_2018"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      ON p."country_code" = h."country_code"
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" = 2018
    LIMIT 100;
    ```

11. **Calculate health expenditure growth percentage between 2017 and 2018:**

    ```sql
    SELECT h."country_code", h."country_name",
           SUM(CASE WHEN h."year" = 2017 THEN h."value" END) AS "health_expenditure_2017",
           SUM(CASE WHEN h."year" = 2018 THEN h."value" END) AS "health_expenditure_2018",
           (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
              SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
              SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" IN (2017, 2018)
    GROUP BY h."country_code", h."country_name"
    LIMIT 100;
    ```

12. **Find countries where health expenditure growth is greater than 1%:**

    ```sql
    SELECT *
    FROM (
      SELECT h."country_code", h."country_name",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code", h."country_name"
    ) sub
    WHERE "health_expenditure_growth_pct" > 1
    LIMIT 100;
    ```

13. **Combine population and health expenditure growth percentages:**

    ```sql
    SELECT p."country_code", p."country",
           ((p."year_2018" - p."year_2017") / p."year_2017" * 100) AS "population_growth_pct",
           h."health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN (
      SELECT h."country_code",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code"
    ) h
      ON p."country_code" = h."country_code"
    LIMIT 100;
    ```

14. **Identify countries where both growth percentages are greater than 1%:**

    ```sql
    SELECT p."country_code", p."country"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN (
      SELECT h."country_code",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code"
    ) h
      ON p."country_code" = h."country_code"
    WHERE ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
      AND h."health_expenditure_growth_pct" > 1
    LIMIT 100;
    ```

15. **Count the number of countries meeting both growth criteria:**

    ```sql
    SELECT COUNT(*) AS "Number_of_Countries"
    FROM (
      SELECT p."country_code"
      FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
      INNER JOIN (
        SELECT h."country_code",
               (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                  SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                  SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
        FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
        WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND h."year" IN (2017, 2018)
        GROUP BY h."country_code"
      ) h
        ON p."country_code" = h."country_code"
      WHERE ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
        AND h."health_expenditure_growth_pct" > 1
    ) sub;
    ```

These queries progressively explore the necessary data, helping to identify the relevant countries and calculate the required growth percentages.Query:
SELECT DISTINCT "country_code", "country"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
Answer:
country_code,country
SXM,Sint Maarten (Dutch part)
INX,Not classified
PSE,West Bank and Gaza
SRB,Serbia
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
LIC,Low income
EAR,Early-demographic dividend
FJI,Fiji
MNA,Middle East & North Africa (excluding high income)
TMN,Middle East & North Africa (IDA & IBRD countries)
WLD,World
SAU,Saudi Arabia
DOM,Dominican Republic
VEN,"Venezuela, RB"
GIN,Guinea
DNK,Denmark
HKG,"Hong Kong SAR, China"
TEC,Europe & Central Asia (IDA & IBRD countries)
YEM,"Yemen, Rep."
NAM,Namibia
CPV,Cabo Verde
PHL,Philippines
PLW,Palau
DEU,Germany
FRO,Faroe Islands
SST,Small states
BTN,Bhutan
XKX,Kosovo
ECA,Europe & Central Asia (excluding high income)
OMN,Oman
ZAF,South Africa
FIN,Finland
MNE,Montenegro
JAM,Jamaica
LIE,Liechtenstein
MNG,Mongolia
LUX,Luxembourg
ARB,Arab World
CUB,Cuba
UMC,Upper middle income
HRV,Croatia
PAN,Panama
TCD,Chad
KEN,Kenya
PAK,Pakistan
CEB,Central Europe and the Baltics
BRN,Brunei Darussalam
HTI,Haiti
IMN,Isle of Man
BIH,Bosnia and Herzegovina
AGO,Angola
WSM,Samoa
TSA,South Asia (IDA & IBRD)
SSD,South Sudan
COG,"Congo, Rep."
ITA,Italy
NAC,North America
GEO,Georgia
VIR,Virgin Islands (U.S.)
IDN,Indonesia
ARM,Armenia
SSA,Sub-Saharan Africa (excluding high income)
MDV,Maldives
PER,Peru
CAN,Canada
QAT,Qatar
MKD,North Macedonia
RWA,Rwanda
MAF,St. Martin (French part)
TZA,Tanzania
ZMB,Zambia
TUN,Tunisia
PRE,Pre-demographic dividend
MHL,Marshall Islands
DMA,Dominica
AUT,Austria
ATG,Antigua and Barbuda
CHL,Chile
MDA,Moldova
ECU,Ecuador
EGY,"Egypt, Arab Rep."
CYP,Cyprus
NRU,Nauru
USA,United States
BRA,Brazil
LDC,Least developed countries: UN classification
LKA,Sri Lanka
NOR,Norway
IRL,Ireland
SLE,Sierra Leone
MEA,Middle East & North Africa
SMR,San Marino
GRD,Grenada
MEX,Mexico
VNM,Vietnam
SLB,Solomon Islands
SEN,Senegal
SAS,South Asia
Query:
SELECT "country_code", "country", "year_2017", "year_2018"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
Answer:
country_code,country,year_2017,year_2018
SXM,Sint Maarten (Dutch part),40574.0,40654.0
INX,Not classified,,
PSE,West Bank and Gaza,4454805.0,4569087.0
SRB,Serbia,7020858.0,6982084.0
KHM,Cambodia,16009414.0,16249798.0
ARE,United Arab Emirates,9487203.0,9630959.0
CYP,Cyprus,1179680.0,1189265.0
LMC,Lower middle income,2981420591.0,3022905169.0
MDV,Maldives,496402.0,515696.0
LIC,Low income,687449530.0,705417321.0
PER,Peru,31444297.0,31989256.0
EAR,Early-demographic dividend,3207188541.0,3249140605.0
FJI,Fiji,877459.0,883483.0
TCD,Chad,15016773.0,15477751.0
MNA,Middle East & North Africa (excluding high income),376546755.0,382896715.0
TMN,Middle East & North Africa (IDA & IBRD countries),372091950.0,378327628.0
WLD,World,7510990456.0,7594270356.0
SAU,Saudi Arabia,33099147.0,33699947.0
DOM,Dominican Republic,10513131.0,10627165.0
KEN,Kenya,50221473.0,51393010.0
VEN,"Venezuela, RB",29390409.0,28870195.0
CAN,Canada,36540268.0,37058856.0
GIN,Guinea,12067539.0,12414318.0
PAK,Pakistan,207896686.0,212215030.0
LVA,Latvia,1942248.0,1926542.0
DNK,Denmark,5764980.0,5797446.0
HKG,"Hong Kong SAR, China",7391700.0,7451000.0
NRU,Nauru,12876.0,12704.0
QAT,Qatar,2724724.0,2781677.0
USA,United States,325147121.0,327167434.0
TEC,Europe & Central Asia (IDA & IBRD countries),457810292.0,459865205.0
BRA,Brazil,207833831.0,209469333.0
NGA,Nigeria,190873311.0,195874740.0
YEM,"Yemen, Rep.",27834821.0,28498687.0
MKD,North Macedonia,2081996.0,2082958.0
NAM,Namibia,2402603.0,2448255.0
RWA,Rwanda,11980937.0,12301939.0
LDC,Least developed countries: UN classification,986365080.0,1009662578.0
CEB,Central Europe and the Baltics,102738854.0,102511922.0
CPV,Cabo Verde,537497.0,543767.0
BRN,Brunei Darussalam,424473.0,428962.0
PHL,Philippines,105173264.0,106651922.0
PLW,Palau,17808.0,17907.0
LKA,Sri Lanka,21444000.0,21670000.0
STP,Sao Tome and Principe,207089.0,211028.0
HTI,Haiti,10982366.0,11123176.0
PSS,Pacific island small states,2422086.0,2457367.0
CHN,China,1386395000.0,1392730000.0
DEU,Germany,82657002.0,82927922.0
MAF,St. Martin (French part),36560.0,37264.0
FRO,Faroe Islands,48331.0,48497.0
NOR,Norway,5276968.0,5314336.0
SST,Small states,39885876.0,40575321.0
IRL,Ireland,4807388.0,4853506.0
TZA,Tanzania,54663906.0,56318348.0
BTN,Bhutan,745568.0,754394.0
XKX,Kosovo,1830700.0,1845300.0
ZMB,Zambia,16853688.0,17351822.0
ECA,Europe & Central Asia (excluding high income),415710935.0,417797257.0
IMN,Isle of Man,83598.0,84077.0
GTM,Guatemala,16914936.0,17247807.0
OMN,Oman,4665935.0,4829483.0
TUN,Tunisia,11433443.0,11565204.0
SGP,Singapore,5612253.0,5638676.0
ZAF,South Africa,57000451.0,57779622.0
FIN,Finland,5508214.0,5518050.0
MNE,Montenegro,622373.0,622345.0
PRE,Pre-demographic dividend,894512725.0,919485393.0
BIH,Bosnia and Herzegovina,3351527.0,3323929.0
SLE,Sierra Leone,7488431.0,7650154.0
BRB,Barbados,286233.0,286641.0
MEA,Middle East & North Africa,441255234.0,448912859.0
TEA,East Asia & Pacific (IDA & IBRD countries),2042687863.0,2056064424.0
MHL,Marshall Islands,58058.0,58413.0
SMR,San Marino,33671.0,33785.0
SYR,Syrian Arab Republic,17068002.0,16906283.0
NIC,Nicaragua,6384855.0,6465513.0
POL,Poland,37974826.0,37978548.0
FCS,Fragile and conflict affected situations,504119229.0,515215936.0
GRD,Grenada,110874.0,111454.0
SVN,Slovenia,2066388.0,2067372.0
VCT,St. Vincent and the Grenadines,109827.0,110210.0
MEX,Mexico,124777324.0,126190788.0
MAR,Morocco,35581294.0,36029138.0
AGO,Angola,29816748.0,30809762.0
WSM,Samoa,195352.0,196130.0
CMR,Cameroon,24566045.0,25216237.0
THA,Thailand,69209858.0,69428524.0
VNM,Vietnam,94596642.0,95540395.0
SLB,Solomon Islands,636038.0,652858.0
JPN,Japan,126785797.0,126529100.0
NER,Niger,21602472.0,22442948.0
SEN,Senegal,15419381.0,15854360.0
CRI,Costa Rica,4949954.0,4999441.0
ALB,Albania,2873457.0,2866376.0
LCA,St. Lucia,180955.0,181889.0
AND,Andorra,77001.0,77006.0
TSA,South Asia (IDA & IBRD),1792835608.0,1814388744.0
SAS,South Asia,1792835608.0,1814388744.0
SSD,South Sudan,10910759.0,10975920.0
Query:
SELECT DISTINCT "indicator_name", "indicator_code"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" ILIKE '%health expenditure per capita%'
   LIMIT 100;
Answer:
indicator_name,indicator_code
External health expenditure per capita (current US$),SH.XPD.EHEX.PC.CD
Current health expenditure per capita (current US$),SH.XPD.CHEX.PC.CD
Domestic general government health expenditure per capita (current US$),SH.XPD.GHED.PC.CD
"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD
"Domestic private health expenditure per capita, PPP  (current international $)",SH.XPD.PVTD.PP.CD
"External health expenditure per capita, PPP (current international $)",SH.XPD.EHEX.PP.CD
"Domestic general government health expenditure per capita, PPP (current international $)",SH.XPD.GHED.PP.CD
Domestic private health expenditure per capita (current US$),SH.XPD.PVTD.PC.CD
Query:
SELECT "country_code", "country_name", "indicator_name", "year", "value"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   LIMIT 100;
Answer:
Too long, hard cut:
country_code,country_name,indicator_name,year,value
PLW,Palau,"Current health expenditure per capita, PPP (current international $)",2018,2011.51733398
EMU,Euro area,"Current health expenditure per capita, PPP (current international $)",2017,4572.35296577739
GHA,Ghana,"Current health expenditure per capita, PPP (current international $)",2017,148.41990662
GHA,Ghana,"Current health expenditure per capita, PPP (current international $)",2018,167.97952271
PST,Post-demographic dividend,"Current health expenditure per capita, PPP (current international $)",2017,5924.10963361332
SSD,South Sudan,"Current health expenditure per capita, PPP (current international $)",2017,147.8605957
SDN,Sudan,"Current health expenditure per capita, PPP (current international $)",2017,311.76040649
BEL,Belgium,"Current health expenditure per capita, PPP (current international $)",2018,5404.91601563
COL,Colombia,"Current health expenditure per capita, PPP (current international $)",2017,1114.09619141
NLD,Netherlands,"Current health expenditure per capita, PPP (current international $)",2017,5498.88183594
ECS,Europe & Central Asia,"Current health expenditure per capita, PPP (current international $)",2017,2872.69957547778
IRN,"Iran, Islamic Rep.","Current health expenditure per capita, PPP (current international $)",2017,1758.99145508
MRT,Mauritania,"Current health expenditure per capita, PPP (current international $)",2018,190.13778687
TLS,Timor-Leste,"Current health expenditure per capita, PPP (current international $)",2017,321.57449341
BHS,"Bahamas, The","Current health expenditure per capita, PPP (current international $)",2018,2005.24621582
DJI,Djibouti,"Current health expenditure per capita, PPP (current international $)",2017,134.43319702
MUS,Mauritius,"Current health expenditure per capita, PPP (current international $)",2018,1380.73596191
MNG,Mongolia,"Current health expenditure per capita, PPP (current international $)",2017,512.30932617
MNE,Montenegro,"Current health expenditure per capita, PPP (current international $)",2018,1711.20996094
NIC,Nicaragua,"Current health expenditure per capita, PPP (current international $)",2017,473.00387573
PHL,Philippines,"Current health expenditure per capita, PPP (current international $)",2018,393.90402222
POL,Poland,"Current health expenditure per capita, PPP (current international $)",2017,1978.63806152
SLE,Sierra Leone,"Current health expenditure per capita, PPP (current international $)",2017,255.2999115
IDN,Indonesia,"Current health expenditure per capita, PPP (current international $)",2017,352.1897583
KGZ,Kyrgyz Republic,"Current health expenditure per capita, PPP (current international $)",2018,259.92599487
MIC,Middle income,"Current health expenditure per capita, PPP (current international $)",2017,613.584403311481
ATG,Antigua and Barbuda,"Current health expenditure per capita, PPP (current international $)",2017,1274.50341797
LCA,St. Lucia,"Current health expenditure per capita, PPP (current international $)",2017,636.71325684
ARG,Argentina,"Current health expenditure per capita, PPP (current international $)",2018,1989.63562012
BEL,Belgium,"Current health expenditure per capita, PPP (current international $)",2017,5289.40039063
BFA,Burkina Faso,"Current health expenditure per capita, PPP (current international $)",2018,111.71577454
MDA,Moldova,"Current health expenditure per capita, PPP (current international $)",2018,479.85287476
DEU,Germany,"Current health expenditure per capita, PPP (current international $)",2017,5930.57617188
PER,Peru,"Current health expenditure per capita, PPP (current international $)",2017,698.16088867
ROU,Romania,"Current health expenditure per capita, PPP (current international $)",2017,1367.82080078
TSS,Sub-Saharan Africa (IDA & IBRD countries),"Current health expenditure per capita, PPP (current international $)",2017,201.156557039325
BHR,Bahrain,"Current health expenditure per capita, PPP (current international $)",2018,1955.35192871
CPV,Cabo Verde,"Current health expenditure per capita, PPP (current international $)",2017,375.52709961
PAK,Pakistan,"Current health expenditure per capita, PPP (current international $)",2017,152.12948608
HIC,High income,"Current health expenditure per capita, PPP (current international $)",2018,6065.06312742882
TLA,Latin America & the Caribbean (IDA & IBRD countries),"Current health expenditure per capita, PPP (current international $)",2018,1228.16209266781
PRY,Paraguay,"Current health expenditure per capita, PPP (current international $)",2018,935.32897949
SMR,San Marino,"Current health expenditure per capita, PPP (current international $)",2017,4262.75585938
SVN,Slovenia,"Current health expenditure per capita, PPP (current international $)",2017,2960.59326172
MEA,Middle East & North Africa,"Current health expenditure per capita, PPP (current international $)",2018,1336.40615439374
LBN,Lebanon,"Current health expenditure per capita, PPP (current international $)",2018,1085.85119629
CUB,Cuba,"Current health expend
Query:
SELECT "country_code", "country_name"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "year" IN (2017, 2018)
   GROUP BY "country_code", "country_name"
   HAVING COUNT(DISTINCT "year") = 2
   LIMIT 100;
Answer:
country_code,country_name
GHA,Ghana
BHS,"Bahamas, The"
MUS,Mauritius
KGZ,Kyrgyz Republic
BHR,Bahrain
MEA,Middle East & North Africa
LSO,Lesotho
THA,Thailand
LCA,St. Lucia
GUY,Guyana
EMU,Euro area
VNM,Vietnam
CAF,Central African Republic
PER,Peru
DZA,Algeria
KOR,"Korea, Rep."
CHL,Chile
WSM,Samoa
IND,India
VCT,St. Vincent and the Grenadines
QAT,Qatar
IRN,"Iran, Islamic Rep."
SSF,Sub-Saharan Africa
AFW,Africa Western and Central
GRC,Greece
POL,Poland
HPC,Heavily indebted poor countries (HIPC)
TEC,Europe & Central Asia (IDA & IBRD countries)
TGO,Togo
ARG,Argentina
LBN,Lebanon
DJI,Djibouti
BWA,Botswana
UKR,Ukraine
TSS,Sub-Saharan Africa (IDA & IBRD countries)
MAR,Morocco
NZL,New Zealand
TUR,Turkey
TON,Tonga
TUN,Tunisia
BRN,Brunei Darussalam
EAP,East Asia & Pacific (excluding high income)
LCN,Latin America & Caribbean
FRA,France
PLW,Palau
AFG,Afghanistan
PRT,Portugal
EGY,"Egypt, Arab Rep."
CAN,Canada
VEN,"Venezuela, RB"
COD,"Congo, Dem. Rep."
BTN,Bhutan
AGO,Angola
COM,Comoros
MEX,Mexico
SLV,El Salvador
GTM,Guatemala
KHM,Cambodia
ECA,Europe & Central Asia (excluding high income)
BEN,Benin
COG,"Congo, Rep."
TEA,East Asia & Pacific (IDA & IBRD countries)
ESP,Spain
LBR,Liberia
OED,OECD members
TKM,Turkmenistan
NGA,Nigeria
FSM,"Micronesia, Fed. Sts."
TSA,South Asia (IDA & IBRD)
SRB,Serbia
HRV,Croatia
KWT,Kuwait
LTU,Lithuania
STP,Sao Tome and Principe
AUS,Australia
NER,Niger
CZE,Czech Republic
KAZ,Kazakhstan
UMC,Upper middle income
ZMB,Zambia
OMN,Oman
SSD,South Sudan
SDN,Sudan
DEU,Germany
CPV,Cabo Verde
MDV,Maldives
ALB,Albania
CHE,Switzerland
LAC,Latin America & Caribbean (excluding high income)
TZA,Tanzania
LKA,Sri Lanka
ARE,United Arab Emirates
ZWE,Zimbabwe
GMB,"Gambia, The"
MNA,Middle East & North Africa (excluding high income)
NAC,North America
FJI,Fiji
TMN,Middle East & North Africa (IDA & IBRD countries)
CYP,Cyprus
ECU,Ecuador
Query:
SELECT "country_code", "country",
          "year_2017", "year_2018",
          (( "year_2018" - "year_2017" ) / "year_2017" * 100 ) AS "population_growth_pct"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY
   LIMIT 100;
Answer:
country_code,country,year_2017,year_2018,population_growth_pct
SXM,Sint Maarten (Dutch part),40574.0,40654.0,0.197200
INX,Not classified,,,
PSE,West Bank and Gaza,4454805.0,4569087.0,2.565400
SRB,Serbia,7020858.0,6982084.0,-0.552300
KHM,Cambodia,16009414.0,16249798.0,1.501500
ARE,United Arab Emirates,9487203.0,9630959.0,1.515300
CYP,Cyprus,1179680.0,1189265.0,0.812500
LMC,Lower middle income,2981420591.0,3022905169.0,1.391400
MDV,Maldives,496402.0,515696.0,3.886800
LIC,Low income,687449530.0,705417321.0,2.613700
PER,Peru,31444297.0,31989256.0,1.733100
EAR,Early-demographic dividend,3207188541.0,3249140605.0,1.308100
FJI,Fiji,877459.0,883483.0,0.686500
TCD,Chad,15016773.0,15477751.0,3.069800
MNA,Middle East & North Africa (excluding high income),376546755.0,382896715.0,1.686400
TMN,Middle East & North Africa (IDA & IBRD countries),372091950.0,378327628.0,1.675800
WLD,World,7510990456.0,7594270356.0,1.108800
SAU,Saudi Arabia,33099147.0,33699947.0,1.815200
DOM,Dominican Republic,10513131.0,10627165.0,1.084700
KEN,Kenya,50221473.0,51393010.0,2.332700
VEN,"Venezuela, RB",29390409.0,28870195.0,-1.770000
CAN,Canada,36540268.0,37058856.0,1.419200
GIN,Guinea,12067539.0,12414318.0,2.873700
PAK,Pakistan,207896686.0,212215030.0,2.077200
LVA,Latvia,1942248.0,1926542.0,-0.808700
DNK,Denmark,5764980.0,5797446.0,0.563200
HKG,"Hong Kong SAR, China",7391700.0,7451000.0,0.802300
NRU,Nauru,12876.0,12704.0,-1.335800
QAT,Qatar,2724724.0,2781677.0,2.090200
USA,United States,325147121.0,327167434.0,0.621400
TEC,Europe & Central Asia (IDA & IBRD countries),457810292.0,459865205.0,0.448900
BRA,Brazil,207833831.0,209469333.0,0.786900
NGA,Nigeria,190873311.0,195874740.0,2.620300
YEM,"Yemen, Rep.",27834821.0,28498687.0,2.385000
MKD,North Macedonia,2081996.0,2082958.0,0.046200
NAM,Namibia,2402603.0,2448255.0,1.900100
RWA,Rwanda,11980937.0,12301939.0,2.679300
LDC,Least developed countries: UN classification,986365080.0,1009662578.0,2.362000
CEB,Central Europe and the Baltics,102738854.0,102511922.0,-0.220900
CPV,Cabo Verde,537497.0,543767.0,1.166500
BRN,Brunei Darussalam,424473.0,428962.0,1.057500
PHL,Philippines,105173264.0,106651922.0,1.405900
PLW,Palau,17808.0,17907.0,0.555900
LKA,Sri Lanka,21444000.0,21670000.0,1.053900
STP,Sao Tome and Principe,207089.0,211028.0,1.902100
HTI,Haiti,10982366.0,11123176.0,1.282100
PSS,Pacific island small states,2422086.0,2457367.0,1.456600
CHN,China,1386395000.0,1392730000.0,0.456900
DEU,Germany,82657002.0,82927922.0,0.327800
MAF,St. Martin (French part),36560.0,37264.0,1.925600
FRO,Faroe Islands,48331.0,48497.0,0.343500
NOR,Norway,5276968.0,5314336.0,0.708100
SST,Small states,39885876.0,40575321.0,1.728500
IRL,Ireland,4807388.0,4853506.0,0.959300
TZA,Tanzania,54663906.0,56318348.0,3.026600
BTN,Bhutan,745568.0,754394.0,1.183800
XKX,Kosovo,1830700.0,1845300.0,0.797500
ZMB,Zambia,16853688.0,17351822.0,2.955600
ECA,Europe & Central Asia (excluding high income),415710935.0,417797257.0,0.501900
IMN,Isle of Man,83598.0,84077.0,0.573000
GTM,Guatemala,16914936.0,17247807.0,1.967900
OMN,Oman,4665935.0,4829483.0,3.505100
TUN,Tunisia,11433443.0,11565204.0,1.152400
SGP,Singapore,5612253.0,5638676.0,0.470800
ZAF,South Africa,57000451.0,57779622.0,1.367000
FIN,Finland,5508214.0,5518050.0,0.178600
MNE,Montenegro,622373.0,622345.0,-0.004500
PRE,Pre-demographic dividend,894512725.0,919485393.0,2.791800
BIH,Bosnia and Herzegovina,3351527.0,3323929.0,-0.823400
SLE,Sierra Leone,7488431.0,7650154.0,2.159600
BRB,Barbados,286233.0,286641.0,0.142500
MEA,Middle East & North Africa,441255234.0,448912859.0,1.735400
TEA,East Asia & Pacific (IDA & IBRD countries),2042687863.0,2056064424.0,0.654900
MHL,Marshall Islands,58058.0,58413.0,0.611500
SMR,San Marino,33671.0,33785.0,0.338600
SYR,Syrian Arab Republic,17068002.0,16906283.0,-0.947500
NIC,Nicaragua,6384855.0,6465513.0,1.263300
POL,Poland,37974826.0,37978548.0,0.009800
FCS,Fragile and conflict affected situations,504119229.0,515215936.0,2.201200
GRD,Grenada,110874.0,111454.0,0.523100
SVN,Slovenia,2066388.0,2067372.0,0.047600
VCT,St. Vincent and the Grenadines,109827.0,110210.0,0.348700
MEX,Mexico,124777324.0,126190788.0,1.132800
MAR,Morocco,35581294.0,36029138.0,1.258700
AGO,Angola,29816748.0,30809762.0,3.330400
WSM,Samoa,195352.0,196130.0,0.398300
CMR,Cameroon,24566045.0,25216237.0,2.646700
THA,Thailand,69209858.0,69428524.0,0.315900
VNM,Vietnam,94596642.0,95540395.0,0.997700
SLB,Solomon Islands,636038.0,652858.0,2.644500
JPN,Japan,126785797.0,126529100.0,-0.202500
NER,Niger,21602472.0,22442948.0,3.890600
SEN,Senegal,15419381.0,15854360.0,2.821000
CRI,Costa Rica,4949954.0,4999441.0,0.999700
ALB,Albania,2873457.0,2866376.0,-0.246400
LCA,St. Lucia,180955.0,181889.0,0.516200
AND,Andorra,77001.0,77006.0,0.006500
TSA,South Asia (IDA & IBRD),1792835608.0,1814388744.0,1.202200
SAS,South Asia,1792835608.0,1814388744.0,1.202200
SSD,South Sudan,10910759.0,10975920.0,0.597200
Query:
SELECT "country_code", "country_name", "year", "value" AS "health_expenditure"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
     AND "country_name" = 'United States'
     AND "year" IN (2017, 2018)
   ORDER BY "year"
   LIMIT 100;
Answer:
country_code,country_name,year,health_expenditure
USA,United States,2017,10209.63085938
USA,United States,2018,10623.84960938
Query:
SELECT DISTINCT "indicator_name", "indicator_code"
   FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION
   WHERE "indicator_name" ILIKE '%health expenditure per capita%PPP%'
   LIMIT 100;
Answer:
indicator_name,indicator_code
"Current health expenditure per capita, PPP (current international $)",SH.XPD.CHEX.PP.CD
"Domestic private health expenditure per capita, PPP  (current international $)",SH.XPD.PVTD.PP.CD
"External health expenditure per capita, PPP (current international $)",SH.XPD.EHEX.PP.CD
"Domestic general government health expenditure per capita, PPP (current international $)",SH.XPD.GHED.PP.CD
Query:
SELECT DISTINCT p."country_code", p."country", h."country_name"
   FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
   INNER JOIN WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
     ON p."country_code" = h."country_code"
   LIMIT 100;
Answer:
country_code,country,country_name
CYM,Cayman Islands,Cayman Islands
CAF,Central African Republic,Central African Republic
COL,Colombia,Colombia
COM,Comoros,Comoros
COD,"Congo, Dem. Rep.","Congo, Dem. Rep."
CUB,Cuba,Cuba
CUW,Curacao,Curacao
CIV,Cote d'Ivoire,Cote d'Ivoire
DNK,Denmark,Denmark
ECU,Ecuador,Ecuador
MEX,Mexico,Mexico
MNG,Mongolia,Mongolia
NER,Niger,Niger
PLW,Palau,Palau
FCS,Fragile and conflict affected situations,Fragile and conflict affected situations
ETH,Ethiopia,Ethiopia
GAB,Gabon,Gabon
GMB,"Gambia, The","Gambia, The"
SVK,Slovak Republic,Slovak Republic
MNA,Middle East & North Africa (excluding high income),Middle East & North Africa (excluding high income)
DMA,Dominica,Dominica
NAM,Namibia,Namibia
EAR,Early-demographic dividend,Early-demographic dividend
EMU,Euro area,Euro area
PRY,Paraguay,Paraguay
PRI,Puerto Rico,Puerto Rico
ROU,Romania,Romania
RUS,Russian Federation,Russian Federation
IMN,Isle of Man,Isle of Man
ITA,Italy,Italy
SSA,Sub-Saharan Africa (excluding high income),Sub-Saharan Africa (excluding high income)
LBN,Lebanon,Lebanon
LKA,Sri Lanka,Sri Lanka
LCA,St. Lucia,St. Lucia
TON,Tonga,Tonga
TCA,Turks and Caicos Islands,Turks and Caicos Islands
UKR,Ukraine,Ukraine
VIR,Virgin Islands (U.S.),Virgin Islands (U.S.)
PSE,West Bank and Gaza,West Bank and Gaza
IDN,Indonesia,Indonesia
KAZ,Kazakhstan,Kazakhstan
KOR,"Korea, Rep.","Korea, Rep."
LAO,Lao PDR,Lao PDR
MEA,Middle East & North Africa,Middle East & North Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries),Sub-Saharan Africa (IDA & IBRD countries)
SYR,Syrian Arab Republic,Syrian Arab Republic
TUN,Tunisia,Tunisia
VUT,Vanuatu,Vanuatu
ZMB,Zambia,Zambia
SLV,El Salvador,El Salvador
EAS,East Asia & Pacific,East Asia & Pacific
GEO,Georgia,Georgia
KIR,Kiribati,Kiribati
TMN,Middle East & North Africa (IDA & IBRD countries),Middle East & North Africa (IDA & IBRD countries)
PST,Post-demographic dividend,Post-demographic dividend
SSD,South Sudan,South Sudan
SOM,Somalia,Somalia
BMU,Bermuda,Bermuda
NOR,Norway,Norway
IBT,IDA & IBRD total,IDA & IBRD total
LAC,Latin America & Caribbean (excluding high income),Latin America & Caribbean (excluding high income)
EST,Estonia,Estonia
IRQ,Iraq,Iraq
PRE,Pre-demographic dividend,Pre-demographic dividend
DZA,Algeria,Algeria
AND,Andorra,Andorra
LUX,Luxembourg,Luxembourg
MYS,Malaysia,Malaysia
SDN,Sudan,Sudan
SWE,Sweden,Sweden
TTO,Trinidad and Tobago,Trinidad and Tobago
TUR,Turkey,Turkey
AZE,Azerbaijan,Azerbaijan
BDI,Burundi,Burundi
VNM,Vietnam,Vietnam
LVA,Latvia,Latvia
HTI,Haiti,Haiti
CMR,Cameroon,Cameroon
YEM,"Yemen, Rep.","Yemen, Rep."
PSS,Pacific island small states,Pacific island small states
ZWE,Zimbabwe,Zimbabwe
UGA,Uganda,Uganda
CAN,Canada,Canada
TCD,Chad,Chad
CHN,China,China
COG,"Congo, Rep.","Congo, Rep."
CRI,Costa Rica,Costa Rica
CYP,Cyprus,Cyprus
CZE,Czech Republic,Czech Republic
DJI,Djibouti,Djibouti
MCO,Monaco,Monaco
MNE,Montenegro,Montenegro
NIC,Nicaragua,Nicaragua
NZL,New Zealand,New Zealand
TLA,Latin America & the Caribbean (IDA & IBRD countries),Latin America & the Caribbean (IDA & IBRD countries)
FRO,Faroe Islands,Faroe Islands
PRT,Portugal,Portugal
MOZ,Mozambique,Mozambique
NCL,New Caledonia,New Caledonia
NGA,Nigeria,Nigeria
Query:
SELECT p."country_code", p."country",
           p."year_2018" AS "population_2018",
           h."value" AS "health_expenditure_2018"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      ON p."country_code" = h."country_code"
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" = 2018
    LIMIT 100;
Answer:
country_code,country,population_2018,health_expenditure_2018
SRB,Serbia,6982084,1484.64892578
KHM,Cambodia,16249798,261.15719604
ARE,United Arab Emirates,9630959,3172.60766602
CYP,Cyprus,1189265,2624.85083008
LMC,Lower middle income,3022905169,333.591007921496
MDV,Maldives,515696,1442.57324219
LIC,Low income,705417321,109.124446932298
PER,Peru,31989256,766.63635254
EAR,Early-demographic dividend,3249140605,480.325291422422
FJI,Fiji,883483,372.46304321
TCD,Chad,15477751,79.01350403
MNA,Middle East & North Africa (excluding high income),382896715,947.93063782341
TMN,Middle East & North Africa (IDA & IBRD countries),378327628,947.93063782341
WLD,World,7594270356,1459.31871076191
SAU,Saudi Arabia,33699947,3519.90722656
DOM,Dominican Republic,10627165,1017.50299072
KEN,Kenya,51393010,179.18043518
VEN,"Venezuela, RB",28870195,383.50854492
CAN,Canada,37058856,5199.97314453
GIN,Guinea,12414318,109.24282074
PAK,Pakistan,212215030,178.24232483
LVA,Latvia,1926542,1895.77575684
DNK,Denmark,5797446,5794.25927734
NRU,Nauru,12704,1174.43530273
QAT,Qatar,2781677,3165.85791016
USA,United States,327167434,10623.84960938
TEC,Europe & Central Asia (IDA & IBRD countries),459865205,1210.53899563655
BRA,Brazil,209469333,1530.82226563
NGA,Nigeria,195874740,232.99221802
MKD,North Macedonia,2082958,1073.19555664
NAM,Namibia,2448255,882.66326904
RWA,Rwanda,12301939,169.82418823
LDC,Least developed countries: UN classification,1009662578,130.254941480156
CEB,Central Europe and the Baltics,102511922,2059.08574115019
CPV,Cabo Verde,543767,399.53582764
BRN,Brunei Darussalam,428962,1952.52880859
PHL,Philippines,106651922,393.90402222
PLW,Palau,17907,2011.51733398
LKA,Sri Lanka,21670000,516.92150879
STP,Sao Tome and Principe,211028,213.92353821
HTI,Haiti,11123176,143.62878418
PSS,Pacific island small states,2457367,290.443360144599
CHN,China,1392730000,935.19287109
DEU,Germany,82927922,6098.20263672
NOR,Norway,5314336,6818.34619141
SST,Small states,40575321,1093.93478075819
IRL,Ireland,4853506,5896.69189453
TZA,Tanzania,56318348,112.45636749
BTN,Bhutan,754394,322.09790039
ZMB,Zambia,17351822,208.44441223
ECA,Europe & Central Asia (excluding high income),417797257,1130.37029372877
GTM,Guatemala,17247807,482.96057129
OMN,Oman,4829483,1729.54199219
TUN,Tunisia,11565204,912.25427246
SGP,Singapore,5638676,4439.28173828
ZAF,South Africa,57779622,1129.38391113
FIN,Finland,5518050,4457.17089844
MNE,Montenegro,622345,1711.20996094
PRE,Pre-demographic dividend,919485393,178.598043761294
BIH,Bosnia and Herzegovina,3323929,1300.77648926
SLE,Sierra Leone,7650154,257.32653809
BRB,Barbados,286641,1203.78686523
MEA,Middle East & North Africa,448912859,1336.40615439374
TEA,East Asia & Pacific (IDA & IBRD countries),2056064424,777.95938741222
MHL,Marshall Islands,58413,677.16558838
SMR,San Marino,33785,4340.04199219
NIC,Nicaragua,6465513,473.92501831
POL,Poland,37978548,2015.28588867
FCS,Fragile and conflict affected situations,515215936,207.551309936779
GRD,Grenada,111454,693.81774902
SVN,Slovenia,2067372,3158.38500977
VCT,St. Vincent and the Grenadines,110210,549.60974121
MEX,Mexico,126190788,1065.95007324
MAR,Morocco,36029138,467.12515259
AGO,Angola,30809762,164.70602417
WSM,Samoa,196130,355.18405151
CMR,Cameroon,25216237,133.60945129
THA,Thailand,69428524,722.69683838
VNM,Vietnam,95540395,440.16650391
SLB,Solomon Islands,652858,107.63027954
JPN,Japan,126529100,4503.68212891
NER,Niger,22442948,77.98433685
SEN,Senegal,15854360,146.39419556
CRI,Costa Rica,4999441,1336.52856445
ALB,Albania,2866376,697.30487061
LCA,St. Lucia,181889,610.52154541
AND,Andorra,77006,3607.00097656
TSA,South Asia (IDA & IBRD),1814388744,249.034231503484
SAS,South Asia,1814388744,249.034231503484
SSD,South Sudan,10975920,113.77922821
AZE,Azerbaijan,9942334,633.56213379
EAP,East Asia & Pacific (excluding high income),2081651801,777.946582331166
GNQ,Equatorial Guinea,1308974,696.58062744
HND,Honduras,9587522,362.26046753
IBT,IDA & IBRD total,6412522234,614.910672222532
BFA,Burkina Faso,19751535,111.71577454
JAM,Jamaica,2934855,559.11590576
DMA,Dominica,71625,710.24499512
TTO,Trinidad and Tobago,1389858,2099.59667969
BDI,Burundi,11175378,65.79267883
Query:
SELECT h."country_code", h."country_name",
           SUM(CASE WHEN h."year" = 2017 THEN h."value" END) AS "health_expenditure_2017",
           SUM(CASE WHEN h."year" = 2018 THEN h."value" END) AS "health_expenditure_2018",
           (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
              SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
              SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" IN (2017, 2018)
    GROUP BY h."country_code", h."country_name"
    LIMIT 100;
Answer:
Too long, hard cut:
country_code,country_name,health_expenditure_2017,health_expenditure_2018,health_expenditure_growth_pct
PLW,Palau,2164.40844727,2011.51733398,-7.063875281157944
EMU,Euro area,4572.35296577739,4699.88206161339,2.789134976903903
GHA,Ghana,148.41990662,167.97952271,13.178566497874536
SSD,South Sudan,147.8605957,113.77922821,-23.04966196615966
SDN,Sudan,311.76040649,293.05581665,-5.999668158823738
IRN,"Iran, Islamic Rep.",1758.99145508,1691.33569336,-3.8462814315901754
BHS,"Bahamas, The",2128.2644043,2005.24621582,-5.780211717653635
DJI,Djibouti,134.43319702,134.88937378,0.3393334162335949
MUS,Mauritius,1278.09350586,1380.73596191,8.030903496449127
MNE,Montenegro,,1711.20996094,
POL,Poland,1978.63806152,2015.28588867,1.8521743750267778
LCA,St. Lucia,636.71325684,610.52154541,-4.113580351693804
ARG,Argentina,2184.91918945,1989.63562012,-8.937793684678915
DEU,Germany,5930.57617188,6098.20263672,2.826478574456307
PER,Peru,698.16088867,766.63635254,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),201.156557039325,205.394948790297,2.1070114806863676
BHR,Bahrain,2263.04296875,1955.35192871,-13.596341045612325
CPV,Cabo Verde,375.52709961,399.53582764,6.393341001204444
MEA,Middle East & North Africa,1378.03787525822,1336.40615439374,-3.0210868374484248
LBN,Lebanon,1081.28100586,1085.85119629,0.42266445126028984
NZL,New Zealand,3815.65722656,4024.38623047,5.470329002749014
THA,Thailand,686.5927124,722.69683838,5.258448761245554
MDV,Maldives,1347.38793945,1442.57324219,7.064431850180757
KHM,Cambodia,238.10375977,261.15719604,9.682096701147762
HRV,Croatia,1773.44177246,1876.10449219,5.788897122209604
CHE,Switzerland,7928.17480469,8113.94335938,2.343144030831746
TUR,Turkey,1176.02050781,1170.77990723,-0.44562152999858845
VEN,"Venezuela, RB",783.46325684,383.50854492,-51.04958125709261
CYP,Cyprus,2498.46508789,2624.85083008,5.058535450528741
VCT,St. Vincent and the Grenadines,507.44885254,549.60974121,8.308401617023394
LKA,Sri Lanka,497.98007202,516.92150879,3.803653566530511
CAF,Central African Republic,54.73753357,97.0058136,77.21992072577778
SLV,El Salvador,576.23730469,592.34143066,2.794703820618421
EAP,East Asia & Pacific (excluding high income),704.021942568792,777.946582331166,10.500331778387803
FRA,France,5110.13427734,5250.4453125,2.7457406703026312
LBR,Liberia,123.56186676,102.82676697,-16.78114804648813
LSO,Lesotho,283.69839478,308.99752808,8.91761594901471
ALB,Albania,645.47076416,697.30487061,8.030434425245513
BTN,Bhutan,314.59326172,322.09790039,2.3855052167898734
TZA,Tanzania,109.09073639,112.45636749,3.085166725768402
COD,"Congo, Dem. Rep.",36.94486618,30.71561813,-16.86093006711765
MEX,Mexico,1071.98608398,1065.95007324,-0.5630680127478949
OED,OECD members,5087.30788659975,5265.68162084414,3.506250028904982
TSA,South Asia (IDA & IBRD),229.036851793622,249.034231503484,8.731075175570883
TON,Tonga,348.17059326,355.33111572,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),1153.4243527552,1210.53899563655,4.951745881289868
PRT,Portugal,3084.17285156,3242.35180664,5.128731841342556
BEN,Benin,82.49481201,83.21243286,0.8698981578538698
EGY,"Egypt, Arab Rep.",661.4362793,614.10858154,-7.155292088012925
NER,Niger,77.6079483,77.98433685,0.4849871156818115
COG,"Congo, Rep.",169.05439758,125.36307526,-25.844534626391113
STP,Sao Tome and Principe,213.72305298,213.92353821,0.093806085588137
NAC,North America,9685.5744676568,10071.4036599167,3.9835447401525426
TMN,Middle East & North Africa (IDA & IBRD countries),977.686984569154,947.93063782341,-3.043545348909082
TKM,Turkmenistan,1250.31787109,1275.11584473,1.9833335356857433
KGZ,Kyrgyz Republic,231.27180481,259.92599487,12.389832856426533
AFW,Africa Western and Central,172.544544804834,178.788550681486,3.618779071638926
ARE,United Arab Emirates,3031.24536133,3172.60766602,4.663505847905878
ARM,Armenia,996.98303223,1036.95446777,4.009239299749563
BRN,Brunei Darussalam,1811.43640137,1952.52880859,7.7889793488355865
ZWE,Zimbabwe,198.81242371,198.01686096,-0.4001574625740916
UKR,Ukraine,616.94689941,682.50952148,10.626947332533637
GTM,Guatemala,474.80758667,482.96057129,1.7171133842194721
FSM,"Micronesia, Fed. Sts.",426.59359741,414.04211426,-2.9422577427801175
KOR,"Korea, Rep.",2929.06567383,3213.66333008,9.716328957481673
CHL,Chile,2193.38256836,2305.67651367,5.119669816376942
MAR,Morocco,439.59942627,467.12515259,6.26154737133207
HPC,Heavily indebted poor countries (HIPC),131.779229316185,130.77576704758,-0.7614722546277339
LTU,Lithuania,2142.75537109,2312.95532227,7.943041631178868
AGO,Angola,185.65101624,164.70602417,-11.281916196420593
GUY,Guyana,467.41693115,512.92156982,9.735342397213454
WSM,Samoa,361.72091675,355.18405151,-1.8071571029766822
COM,Comoros,131.12634277,134.20884705,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),1071.25149221499,1130.37029372877,5.5186668997344475
DZA,Algeria,970.26824951,962.71936035,-0.7780208374140188
IND,India,253.42102051,275.13040161,8.56652737658095
CAN,Canada,5023.35107422,
Query:
SELECT *
    FROM (
      SELECT h."country_code", h."country_name",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code", h."country_name"
    ) sub
    WHERE "health_expenditure_growth_pct" > 1
    LIMIT 100;
Answer:
country_code,country_name,health_expenditure_growth_pct
EMU,Euro area,2.789134976903903
GHA,Ghana,13.178566497874536
MUS,Mauritius,8.030903496449127
POL,Poland,1.8521743750267778
DEU,Germany,2.826478574456307
PER,Peru,9.807977642581225
TSS,Sub-Saharan Africa (IDA & IBRD countries),2.1070114806863676
CPV,Cabo Verde,6.393341001204444
NZL,New Zealand,5.470329002749014
THA,Thailand,5.258448761245554
MDV,Maldives,7.064431850180757
KHM,Cambodia,9.682096701147762
HRV,Croatia,5.788897122209604
CHE,Switzerland,2.343144030831746
CYP,Cyprus,5.058535450528741
VCT,St. Vincent and the Grenadines,8.308401617023394
LKA,Sri Lanka,3.803653566530511
CAF,Central African Republic,77.21992072577778
SLV,El Salvador,2.794703820618421
EAP,East Asia & Pacific (excluding high income),10.500331778387803
FRA,France,2.7457406703026312
LSO,Lesotho,8.91761594901471
ALB,Albania,8.030434425245513
BTN,Bhutan,2.3855052167898734
TZA,Tanzania,3.085166725768402
OED,OECD members,3.506250028904982
TSA,South Asia (IDA & IBRD),8.731075175570883
TON,Tonga,2.056613223119864
TEC,Europe & Central Asia (IDA & IBRD countries),4.951745881289868
PRT,Portugal,5.128731841342556
NAC,North America,3.9835447401525426
TKM,Turkmenistan,1.9833335356857433
KGZ,Kyrgyz Republic,12.389832856426533
AFW,Africa Western and Central,3.618779071638926
ARE,United Arab Emirates,4.663505847905878
ARM,Armenia,4.009239299749563
BRN,Brunei Darussalam,7.7889793488355865
UKR,Ukraine,10.626947332533637
GTM,Guatemala,1.7171133842194721
KOR,"Korea, Rep.",9.716328957481673
CHL,Chile,5.119669816376942
MAR,Morocco,6.26154737133207
LTU,Lithuania,7.943041631178868
GUY,Guyana,9.735342397213454
COM,Comoros,2.3507894865998136
ECA,Europe & Central Asia (excluding high income),5.5186668997344475
IND,India,8.56652737658095
CAN,Canada,3.516020833511536
LAC,Latin America & Caribbean (excluding high income),1.0247826301139413
CZE,Czech Republic,10.428450078440672
TGO,Togo,7.758083762284739
TEA,East Asia & Pacific (IDA & IBRD countries),10.499561632363628
ZMB,Zambia,15.890200401377808
SRB,Serbia,10.058843469188531
GRC,Greece,2.9283178857691543
NGA,Nigeria,5.373821440597682
AUS,Australia,5.91302435775189
OMN,Oman,4.722239797281134
UMC,Upper middle income,6.920495089257177
FJI,Fiji,13.145350273636053
TUN,Tunisia,4.336137968605618
SSF,Sub-Saharan Africa,2.1070114806863676
VNM,Vietnam,8.32414383351091
ESP,Spain,2.700058958823298
HND,Honduras,5.245476561131182
PST,Post-demographic dividend,3.867870173090837
BEL,Belgium,2.1839077488751304
COL,Colombia,3.708053183245905
NLD,Netherlands,2.466818982241543
ECS,Europe & Central Asia,3.35960082147429
MRT,Mauritania,4.900233038497389
TLS,Timor-Leste,9.620727328816782
MNG,Mongolia,1.3580223967446232
PHL,Philippines,6.225895901836266
IDN,Indonesia,6.520882793655053
MIC,Middle income,6.101815985663521
ATG,Antigua and Barbuda,10.299268289062342
ROU,Romania,15.24165413416109
PAK,Pakistan,17.164876726309394
HIC,High income,3.534800089198823
PRY,Paraguay,8.354755847720794
SVN,Slovenia,6.680814639667525
SAS,South Asia,8.731075175570883
ISR,Israel,3.8699594203796184
FIN,Finland,2.7020203469470228
HUN,Hungary,5.561813157697172
AUT,Austria,3.613654824294838
RUS,Russian Federation,7.1229421476828465
ERI,Eritrea,23.472064126363087
BGR,Bulgaria,3.726355957259228
MKD,North Macedonia,6.123092927453969
LMC,Lower middle income,4.859841588386322
ITA,Italy,1.4552065516257022
DMA,Dominica,21.686427226054047
EAR,Early-demographic dividend,1.155713263926843
GBR,United Kingdom,3.2750742533610016
GNB,Guinea-Bissau,3.703319526850014
ETH,Ethiopia,1.699153922164326
MHL,Marshall Islands,11.769399246987488
PSS,Pacific island small states,6.218577578310462
Query:
SELECT p."country_code", p."country",
           ((p."year_2018" - p."year_2017") / p."year_2017" * 100) AS "population_growth_pct",
           h."health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN (
      SELECT h."country_code",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code"
    ) h
      ON p."country_code" = h."country_code"
    LIMIT 100;
Answer:
country_code,country,population_growth_pct,health_expenditure_growth_pct
SRB,Serbia,-0.552300,10.058843469188531
KHM,Cambodia,1.501500,9.682096701147762
ARE,United Arab Emirates,1.515300,4.663505847905878
CYP,Cyprus,0.812500,5.058535450528741
LMC,Lower middle income,1.391400,4.859841588386322
MDV,Maldives,3.886800,7.064431850180757
LIC,Low income,2.613700,-4.2655355575512415
PER,Peru,1.733100,9.807977642581225
EAR,Early-demographic dividend,1.308100,1.155713263926843
FJI,Fiji,0.686500,13.145350273636053
TCD,Chad,3.069800,-7.782875489518702
MNA,Middle East & North Africa (excluding high income),1.686400,-3.043545348909082
TMN,Middle East & North Africa (IDA & IBRD countries),1.675800,-3.043545348909082
WLD,World,1.108800,3.803807230162976
SAU,Saudi Arabia,1.815200,-6.392527005315368
DOM,Dominican Republic,1.084700,6.597805657430963
KEN,Kenya,2.332700,13.694728244781942
VEN,"Venezuela, RB",-1.770000,-51.04958125709261
CAN,Canada,1.419200,3.516020833511536
GIN,Guinea,2.873700,8.043626497028214
PAK,Pakistan,2.077200,17.164876726309394
LVA,Latvia,-0.808700,11.227458011940097
DNK,Denmark,0.563200,3.6649324886397423
NRU,Nauru,-1.335800,-17.914344696955613
QAT,Qatar,2.090200,-6.649542924759741
USA,United States,0.621400,4.057137380431737
TEC,Europe & Central Asia (IDA & IBRD countries),0.448900,4.951745881289868
BRA,Brazil,0.786900,3.2571908913740963
NGA,Nigeria,2.620300,5.373821440597682
MKD,North Macedonia,0.046200,6.123092927453969
NAM,Namibia,1.900100,-4.1059460982336
RWA,Rwanda,2.679300,17.930277482427908
LDC,Least developed countries: UN classification,2.362000,0.5079618084527765
CEB,Central Europe and the Baltics,-0.220900,6.312226369688209
CPV,Cabo Verde,1.166500,6.393341001204444
BRN,Brunei Darussalam,1.057500,7.7889793488355865
PHL,Philippines,1.405900,6.225895901836266
PLW,Palau,0.555900,-7.063875281157944
LKA,Sri Lanka,1.053900,3.803653566530511
STP,Sao Tome and Principe,1.902100,0.093806085588137
HTI,Haiti,1.282100,-2.2981816246458204
PSS,Pacific island small states,1.456600,6.218577578310462
CHN,China,0.456900,11.628472188133323
DEU,Germany,0.327800,2.826478574456307
NOR,Norway,0.708100,4.641469635457937
SST,Small states,1.728500,0.3733356148596855
IRL,Ireland,0.959300,4.982530621027306
TZA,Tanzania,3.026600,3.085166725768402
BTN,Bhutan,1.183800,2.3855052167898734
ZMB,Zambia,2.955600,15.890200401377808
ECA,Europe & Central Asia (excluding high income),0.501900,5.5186668997344475
GTM,Guatemala,1.967900,1.7171133842194721
OMN,Oman,3.505100,4.722239797281134
TUN,Tunisia,1.152400,4.336137968605618
SGP,Singapore,0.470800,5.850614474042322
ZAF,South Africa,1.367000,3.6050576582534437
FIN,Finland,0.178600,2.7020203469470228
MNE,Montenegro,-0.004500,
PRE,Pre-demographic dividend,2.791800,0.027640701520033784
BIH,Bosnia and Herzegovina,-0.823400,6.034157731189415
SLE,Sierra Leone,2.159600,0.7938218928838047
BRB,Barbados,0.142500,-0.052236967280010066
MEA,Middle East & North Africa,1.735400,-3.0210868374484248
TEA,East Asia & Pacific (IDA & IBRD countries),0.654900,10.499561632363628
MHL,Marshall Islands,0.611500,11.769399246987488
SMR,San Marino,0.338600,1.8130555762403138
NIC,Nicaragua,1.263300,0.19474313578897326
POL,Poland,0.009800,1.8521743750267778
FCS,Fragile and conflict affected situations,2.201200,-7.431140913015866
GRD,Grenada,0.523100,3.0928087481277493
SVN,Slovenia,0.047600,6.680814639667525
VCT,St. Vincent and the Grenadines,0.348700,8.308401617023394
MEX,Mexico,1.132800,-0.5630680127478949
MAR,Morocco,1.258700,6.26154737133207
AGO,Angola,3.330400,-11.281916196420593
WSM,Samoa,0.398300,-1.8071571029766822
CMR,Cameroon,2.646700,4.960110566297106
THA,Thailand,0.315900,5.258448761245554
VNM,Vietnam,0.997700,8.32414383351091
SLB,Solomon Islands,2.644500,-2.6989051392649808
JPN,Japan,-0.202500,2.672329510093784
NER,Niger,3.890600,0.4849871156818115
SEN,Senegal,2.821000,2.147548484177809
CRI,Costa Rica,0.999700,7.425011128893834
ALB,Albania,-0.246400,8.030434425245513
LCA,St. Lucia,0.516200,-4.113580351693804
AND,Andorra,0.006500,8.664081204957636
TSA,South Asia (IDA & IBRD),1.202200,8.731075175570883
SAS,South Asia,1.202200,8.731075175570883
SSD,South Sudan,0.597200,-23.04966196615966
AZE,Azerbaijan,0.896100,-3.334361735734003
EAP,East Asia & Pacific (excluding high income),0.652600,10.500331778387803
GNQ,Equatorial Guinea,3.722100,-5.674867237231175
HND,Honduras,1.681100,5.245476561131182
IBT,IDA & IBRD total,1.223100,5.365268511981853
BFA,Burkina Faso,2.908600,-13.405671454192172
JAM,Jamaica,0.479400,1.265969012259397
DMA,Dominica,0.233700,21.686427226054047
TTO,Trinidad and Tobago,0.418000,-3.9807692412533333
BDI,Burundi,3.217400,10.771295086675051
Query:
SELECT p."country_code", p."country"
    FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
    INNER JOIN (
      SELECT h."country_code",
             (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
      FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
      WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
        AND h."year" IN (2017, 2018)
      GROUP BY h."country_code"
    ) h
      ON p."country_code" = h."country_code"
    WHERE ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
      AND h."health_expenditure_growth_pct" > 1
    LIMIT 100;
Answer:
country_code,country
KHM,Cambodia
ARE,United Arab Emirates
LMC,Lower middle income
MDV,Maldives
PER,Peru
EAR,Early-demographic dividend
WLD,World
DOM,Dominican Republic
KEN,Kenya
CAN,Canada
GIN,Guinea
PAK,Pakistan
NGA,Nigeria
RWA,Rwanda
CPV,Cabo Verde
BRN,Brunei Darussalam
PHL,Philippines
LKA,Sri Lanka
PSS,Pacific island small states
TZA,Tanzania
BTN,Bhutan
ZMB,Zambia
GTM,Guatemala
OMN,Oman
TUN,Tunisia
ZAF,South Africa
MAR,Morocco
CMR,Cameroon
SEN,Senegal
TSA,South Asia (IDA & IBRD)
SAS,South Asia
HND,Honduras
IBT,IDA & IBRD total
BDI,Burundi
ETH,Ethiopia
PRY,Paraguay
MNG,Mongolia
LUX,Luxembourg
COL,Colombia
AUS,Australia
CHL,Chile
TJK,Tajikistan
TON,Tonga
KGZ,Kyrgyz Republic
MIC,Middle income
COM,Comoros
LMY,Low & middle income
IDN,Indonesia
BLZ,Belize
TLS,Timor-Leste
TKM,Turkmenistan
MYS,Malaysia
BGD,Bangladesh
PAN,Panama
SSF,Sub-Saharan Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries)
GNB,Guinea-Bissau
VUT,Vanuatu
TUV,Tuvalu
MRT,Mauritania
ISL,Iceland
NZL,New Zealand
NPL,Nepal
UZB,Uzbekistan
GHA,Ghana
IND,India
TGO,Togo
SSA,Sub-Saharan Africa (excluding high income)
ISR,Israel
CAF,Central African Republic
MOZ,Mozambique
SWE,Sweden
KIR,Kiribati
PNG,Papua New Guinea
UGA,Uganda
BOL,Bolivia
Query:
SELECT COUNT(*) AS "Number_of_Countries"
    FROM (
      SELECT p."country_code"
      FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
      INNER JOIN (
        SELECT h."country_code",
               (( SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
                  SUM(CASE WHEN h."year" = 2017 THEN h."value" END) ) /
                  SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100 ) AS "health_expenditure_growth_pct"
        FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
        WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
          AND h."year" IN (2017, 2018)
        GROUP BY h."country_code"
      ) h
        ON p."country_code" = h."country_code"
      WHERE ((p."year_2018" - p."year_2017") / p."year_2017" * 100) > 1
        AND h."health_expenditure_growth_pct" > 1
    ) sub;
Answer:
Number_of_Countries
76
End Exploring Related Columns
Task: Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita (current US$)"** or the appropriate PPP-adjusted indicator.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

As the exact data is required to compute the precise number, the final result should be presented in the following format:

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'WORLD_BANK': {'WORLD_BANK_GLOBAL_POPULATION': ['POPULATION_BY_COUNTRY'], 'WORLD_BANK_HEALTH_POPULATION': ['COUNTRY_SERIES_DEFINITIONS', 'COUNTRY_SUMMARY', 'HEALTH_NUTRITION_POPULATION', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_DEBT': ['COUNTRY_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_DEBT', 'SERIES_SUMMARY', 'SERIES_TIMES'], 'WORLD_BANK_INTL_EDUCATION': ['COUNTRY_SUMMARY', 'SERIES_SUMMARY', 'COUNTRY_SERIES_DEFINITIONS', 'INTERNATIONAL_EDUCATION'], 'WORLD_BANK_WDI': ['COUNTRY_SUMMARY', 'SERIES_TIME', 'INDICATORS_DATA', 'COUNTRY_SERIES_DEFINITIONS', 'FOOTNOTES', 'SERIES_SUMMARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 01:59:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:59:28 - root - INFO - ```sql
SELECT COUNT(*) AS "Number_of_Countries"
FROM (
  SELECT p."country_code"
  FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
  INNER JOIN (
    SELECT h."country_code",
           (
             (
               SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
               SUM(CASE WHEN h."year" = 2017 THEN h."value" END)
             ) / SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100
           ) AS "health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" IN (2017, 2018)
    GROUP BY h."country_code"
  ) h ON p."country_code" = h."country_code"
  WHERE (
    (p."year_2018" - p."year_2017") / p."year_2017" * 100
  ) > 1
    AND h."health_expenditure_growth_pct" > 1
) sub;
```
2025-02-11 01:59:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:59:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:59:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 01:59:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 01:59:29 - snowflake.connector.connection - INFO - closed
2025-02-11 01:59:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 01:59:29 - root - INFO - itercount: 1
2025-02-11 01:59:29 - root - INFO - 0
2025-02-11 01:59:29 - root - INFO - results: 
Number_of_Countries
76


2025-02-11 01:59:29 - root - INFO - Please check the answer again by reviewing Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - Formula: 
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita (current US$)"** or the appropriate PPP-adjusted indicator.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - Formula:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

As the exact data is required to compute the precise number, the final result should be presented in the following format:

```csv
Number_of_Countries
num:int
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Countries
76
Current sql:
SELECT COUNT(*) AS "Number_of_Countries"
FROM (
  SELECT p."country_code"
  FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
  INNER JOIN (
    SELECT h."country_code",
           (
             (
               SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
               SUM(CASE WHEN h."year" = 2017 THEN h."value" END)
             ) / SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100
           ) AS "health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" IN (2017, 2018)
    GROUP BY h."country_code"
  ) h ON p."country_code" = h."country_code"
  WHERE (
    (p."year_2018" - p."year_2017") / p."year_2017" * 100
  ) > 1
    AND h."health_expenditure_growth_pct" > 1
) sub;
2025-02-11 01:59:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 01:59:59 - root - INFO - To determine the number of countries that experienced an increase of more than 1% from 2017 to 2018 in both their total population and per capita current health expenditure (PPP), you would need to perform the following steps using the specified datasets:

1. **Calculate Population Growth**:
   - From the `POPULATION_BY_COUNTRY` table in the `WORLD_BANK_GLOBAL_POPULATION` schema, calculate the percentage change in total population for each country from 2017 to 2018.
   - **Formula**:
     \[
     \text{Population Growth (\%)} = \left( \frac{\text{Population}_{2018} - \text{Population}_{2017}}{\text{Population}_{2017}} \right) \times 100
     \]

2. **Calculate Health Expenditure Growth**:
   - From the `HEALTH_NUTRITION_POPULATION` table in the `WORLD_BANK_HEALTH_POPULATION` schema, filter the records where `indicator_name` is **"Current health expenditure per capita, PPP (current international $)"**.
   - Calculate the percentage change in per capita health expenditure for each country from 2017 to 2018.
   - **Formula**:
     \[
     \text{Health Expenditure Growth (\%)} = \left( \frac{\text{Expenditure}_{2018} - \text{Expenditure}_{2017}}{\text{Expenditure}_{2017}} \right) \times 100
     \]

3. **Identify Countries Meeting Both Criteria**:
   - Select countries where both the population growth and health expenditure growth are greater than 1%.

4. **Count the Number of Countries**:
   - Count the total number of countries that satisfy both conditions.

Based on the data, the number of countries is:

```csv
Number_of_Countries
76
```

Here is the SQL query to perform this analysis:

```sql
SELECT COUNT(*) AS "Number_of_Countries"
FROM (
  SELECT p."country_code"
  FROM WORLD_BANK.WORLD_BANK_GLOBAL_POPULATION.POPULATION_BY_COUNTRY p
  INNER JOIN (
    SELECT h."country_code",
           (
             (
               SUM(CASE WHEN h."year" = 2018 THEN h."value" END) -
               SUM(CASE WHEN h."year" = 2017 THEN h."value" END)
             ) / SUM(CASE WHEN h."year" = 2017 THEN h."value" END) * 100
           ) AS "health_expenditure_growth_pct"
    FROM WORLD_BANK.WORLD_BANK_HEALTH_POPULATION.HEALTH_NUTRITION_POPULATION h
    WHERE h."indicator_name" = 'Current health expenditure per capita, PPP (current international $)'
      AND h."year" IN (2017, 2018)
    GROUP BY h."country_code"
  ) h ON p."country_code" = h."country_code"
  WHERE (
    (p."year_2018" - p."year_2017") / p."year_2017" * 100
  ) > 1
    AND h."health_expenditure_growth_pct" > 1
) sub;
```

This SQL query performs the following operations:

- **Joins** the population and health expenditure data on `"country_code"`.
- **Calculates** the percentage growth in population and health expenditure between 2017 and 2018.
- **Filters** countries where both growth percentages exceed 1%.
- **Counts** the total number of such countries.

**Note**: The calculations retain all decimal places to four decimal places as per the requirement.
2025-02-11 01:59:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 01:59:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 01:59:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 02:00:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 02:00:00 - snowflake.connector.connection - INFO - closed
2025-02-11 02:00:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 02:00:00 - root - INFO - itercount: 2
2025-02-11 02:00:00 - root - INFO - 0
2025-02-11 02:00:00 - root - INFO - Total iteration counts: 2
