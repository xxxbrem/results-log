2025-02-10 11:53:48 - openai._base_client - INFO - Retrying request to /chat/completions in 0.491965 seconds
2025-02-10 11:55:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:55:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:55:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:55:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:00 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:00 - root - INFO - SQL:
SELECT "player_id", "player_name"
   FROM "IPL"."IPL"."PLAYER"
   LIMIT 100;
Results:
player_id,player_name
1,SC Ganguly
2,BB McCullum
3,RT Ponting
4,DJ Hussey
5,Mohammad Hafeez
6,R Dravid
7,W Jaffer
8,V Kohli
9,JH Kallis
10,CL White
11,MV Boucher
12,B Akhil
13,AA Noffke
14,P Kumar
15,Z Khan
16,SB Joshi
17,PA Patel
18,ML Hayden
19,MEK Hussey
20,MS Dhoni
21,SK Raina
22,JDP Oram
23,S Badrinath
24,K Goel
25,JR Hopes
26,KC Sangakkara
27,Yuvraj Singh
28,SM Katich
29,IK Pathan
30,T Kohli
31,YK Pathan
32,SR Watson
33,M Kaif
34,DS Lehmann
36,M Rawat
37,D Salunkhe
38,SK Warne
39,SK Trivedi
40,G Gambhir
41,V Sehwag
42,S Dhawan
43,L Ronchi
44,ST Jayasuriya
45,DJ Thornely
46,RV Uthappa
47,PR Shah
48,AM Nayar
49,SM Pollock
50,Harbhajan Singh
51,S Chanderpaul
52,LRPL Taylor
53,AC Gilchrist
54,Y Venugopal Rao
55,VVS Laxman
56,A Symonds
57,RG Sharma
58,SB Styris
59,SB Bangar
60,WPUJC Vaas
61,RP Singh
62,WP Saha
63,LR Shukla
64,DPMD Jayawardene
65,S Sohal
66,B Lee
67,PP Chawla
68,WA Mota
69,Kamran Akmal
70,Shahid Afridi
71,DJ Bravo
72,MA Khote
73,A Nehra
74,GC Smith
75,Pankaj Singh
76,RR Sarwan
77,S Sreesanth
78,VRV Singh
79,SS Tiwary
80,DS Kulkarni
81,R Vinay Kumar
82,AB Agarkar
83,M Kartik
84,I Sharma
85,AM Rahane
86,Shoaib Malik
87,MK Tiwary
88,KD Karthik
89,R Bhatia
90,MF Maharoof
91,VY Mahesh
92,TM Srivastava
93,B Chipli
94,DW Steyn
95,DB Das
96,MK Pandey
97,HH Gibbs
98,DNT Zoysa
99,D Kalyankrishna
100,SE Marsh
101,SA Asnodkar

2025-02-10 11:56:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:01 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:02 - root - INFO - SQL:
SELECT "match_id", "over_id", "ball_id", "innings_no", "runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   LIMIT 100;
Results:
match_id,over_id,ball_id,innings_no,runs_scored
335987,1,1,2,1
335987,1,2,1,0
335987,1,3,2,0
335987,1,4,1,0
335987,1,4,2,1
335987,1,5,1,0
335987,1,5,2,1
335987,1,6,1,0
335987,1,6,2,0
335987,1,7,1,0
335987,1,7,2,0
335987,2,1,1,0
335987,2,1,2,0
335987,2,2,1,4
335987,2,2,2,0
335987,2,3,1,4
335987,2,3,2,0
335987,2,4,1,6
335987,2,4,2,1
335987,2,5,1,4
335987,2,5,2,0
335987,2,6,1,0
335987,2,6,2,0
335987,3,1,1,0
335987,3,1,2,0
335987,3,2,1,0
335987,3,2,2,0
335987,3,3,1,0
335987,3,3,2,1
335987,3,4,1,4
335987,3,4,2,0
335987,3,5,1,1
335987,3,6,1,0
335987,3,6,2,0
335987,3,7,2,1
335987,4,1,2,2
335987,4,2,1,6
335987,4,2,2,1
335987,4,3,1,0
335987,4,3,2,0
335987,4,4,1,4
335987,4,4,2,0
335987,4,5,1,0
335987,4,5,2,0
335987,4,6,1,1
335987,4,6,2,0
335987,4,7,1,6
335987,5,1,1,4
335987,5,1,2,1
335987,5,2,1,1
335987,5,2,2,1
335987,5,3,1,4
335987,5,3,2,0
335987,5,4,1,0
335987,5,4,2,6
335987,5,5,1,1
335987,5,5,2,0
335987,5,6,1,0
335987,5,6,2,0
335987,6,1,1,1
335987,6,1,2,0
335987,6,2,1,0
335987,6,2,2,0
335987,6,3,1,0
335987,6,3,2,0
335987,6,4,1,0
335987,6,4,2,1
335987,6,5,1,0
335987,6,5,2,1
335987,6,6,1,0
335987,6,6,2,0
335987,7,1,1,1
335987,7,1,2,0
335987,7,2,1,1
335987,7,2,2,0
335987,7,3,1,1
335987,7,3,2,1
335987,7,4,1,2
335987,7,5,1,1
335987,7,6,1,1
335987,7,6,2,0
335987,7,7,2,0
335987,7,8,2,4
335987,8,1,1,0
335987,8,1,2,1
335987,8,2,1,1
335987,8,2,2,0
335987,8,3,1,1
335987,8,3,2,1
335987,8,4,1,1
335987,8,4,2,2
335987,8,5,1,1
335987,8,5,2,0
335987,8,6,1,1
335987,8,6,2,0
335987,9,1,1,0
335987,9,1,2,0
335987,9,2,1,0
335987,9,2,2,0
335987,9,3,1,0

2025-02-10 11:56:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:03 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:03 - root - INFO - SQL:
SELECT "match_id", "over_id", "ball_id", "innings_no", "striker", "bowler"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   LIMIT 100;
Results:
match_id,over_id,ball_id,innings_no,striker,bowler
335987,1,1,2,6,106
335987,1,2,1,2,14
335987,1,2,2,7,106
335987,1,3,1,2,14
335987,1,3,2,7,106
335987,1,4,1,2,14
335987,1,4,2,7,106
335987,1,5,1,2,14
335987,1,5,2,6,106
335987,1,6,1,2,14
335987,1,6,2,7,106
335987,1,7,1,2,14
335987,1,7,2,7,106
335987,2,1,1,2,15
335987,2,1,2,6,84
335987,2,2,1,2,15
335987,2,2,2,8,84
335987,2,3,1,2,15
335987,2,3,2,8,84
335987,2,4,1,2,15
335987,2,4,2,8,84
335987,2,5,1,2,15
335987,2,5,2,7,84
335987,2,6,1,2,15
335987,2,6,2,7,84
335987,3,1,1,1,14
335987,3,1,2,8,106
335987,3,2,1,1,14
335987,3,2,2,8,106
335987,3,3,1,1,14
335987,3,3,2,9,106
335987,3,4,1,2,14
335987,3,4,2,7,106
335987,3,5,1,2,14
335987,3,5,2,7,106
335987,3,6,1,1,14
335987,3,6,2,7,106
335987,3,7,2,7,106
335987,4,1,1,2,13
335987,4,1,2,7,84
335987,4,2,1,2,13
335987,4,2,2,7,84
335987,4,3,1,2,13
335987,4,3,2,9,84
335987,4,4,1,1,13
335987,4,4,2,9,84
335987,4,5,1,1,13
335987,4,5,2,7,84
335987,4,6,1,1,13
335987,4,6,2,7,84
335987,4,7,1,2,13
335987,5,1,1,1,14
335987,5,1,2,9,82
335987,5,2,1,1,14
335987,5,2,2,7,82
335987,5,3,1,2,14
335987,5,3,2,9,82
335987,5,4,1,2,14
335987,5,4,2,9,82
335987,5,5,1,2,14
335987,5,5,2,9,82
335987,5,6,1,1,14
335987,5,6,2,10,82
335987,6,1,1,2,15
335987,6,1,2,7,106
335987,6,2,1,1,15
335987,6,2,2,7,106
335987,6,3,1,3,15
335987,6,3,2,11,106
335987,6,4,1,3,15
335987,6,4,2,11,106
335987,6,5,1,3,15
335987,6,5,2,10,106
335987,6,6,1,3,15
335987,6,6,2,11,106
335987,7,1,1,2,13
335987,7,1,2,10,82
335987,7,2,1,3,13
335987,7,2,2,10,82
335987,7,3,1,2,13
335987,7,3,2,10,82
335987,7,4,1,3,13
335987,7,4,2,11,82
335987,7,5,1,3,13
335987,7,5,2,11,82
335987,7,6,1,2,13
335987,7,6,2,11,82
335987,7,7,2,11,82
335987,7,8,2,11,82
335987,8,1,1,2,15
335987,8,1,2,10,1
335987,8,2,1,2,15
335987,8,2,2,11,1
335987,8,3,1,3,15
335987,8,3,2,10,1
335987,8,4,1,2,15
335987,8,4,2,11,1
335987,8,5,1,3,15
335987,8,5,2,11,1
335987,8,6,1,2,15

2025-02-10 11:56:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-02-10 11:56:04 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:04 - root - INFO - SQL:
SELECT DISTINCT "kind_out"
   FROM "IPL"."IPL"."WICKET_TAKEN"
   LIMIT 100;
Results:
kind_out
caught
bowled
run out
lbw
retired hurt
stumped
caught and bowled
hit wicket
obstructing the field

2025-02-10 11:56:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:05 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:06 - root - INFO - SQL:
SELECT "match_id", "season_id"
   FROM "IPL"."IPL"."MATCH"
   LIMIT 100;
Results:
match_id,season_id
335987,1
335988,1
335989,1
335990,1
335991,1
335992,1
335993,1
335994,1
335995,1
335996,1
335997,1
335998,1
335999,1
336000,1
336001,1
336002,1
336003,1
336004,1
336005,1
336006,1
336007,1
336008,1
336009,1
336010,1
336011,1
336012,1
336013,1
336014,1
336015,1
336016,1
336017,1
336018,1
336019,1
336020,1
336021,1
336022,1
336023,1
336024,1
336025,1
336026,1
336027,1
336028,1
336029,1
336030,1
336031,1
336032,1
336033,1
336034,1
336036,1
336037,1
336038,1
336039,1
336040,1
336041,1
336042,1
336043,1
336044,1
336045,1
392186,2
392187,2
392188,2
392189,2
392190,2
392191,2
392193,2
392194,2
392196,2
392197,2
392199,2
392200,2
392201,2
392202,2
392203,2
392204,2
392205,2
392206,2
392207,2
392208,2
392209,2
392210,2
392211,2
392212,2
392213,2
392214,2
392215,2
392216,2
392217,2
392218,2
392219,2
392220,2
392221,2
392222,2
392223,2
392224,2
392225,2
392226,2
392227,2
392228,2
392229,2
392230,2

2025-02-10 11:56:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:07 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:07 - root - INFO - SQL:
SELECT bbb."striker", bbb."match_id", SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
     ON bbb."match_id" = bs."match_id"
    AND bbb."over_id" = bs."over_id"
    AND bbb."ball_id" = bs."ball_id"
    AND bbb."innings_no" = bs."innings_no"
   GROUP BY bbb."striker", bbb."match_id"
   LIMIT 100;
Results:
striker,match_id,total_runs
7,335987,6
8,335987,1
1,335987,10
9,335987,8
11,335987,7
13,335987,9
4,335987,12
18,335988,25
20,335988,2
22,335988,13
29,335988,3
30,335989,7
45,335990,0
53,335991,23
32,335992,76
64,335992,2
70,335993,2
49,335994,17
24,335996,18
74,335997,49
15,335987,3
25,335988,71
26,335988,54
27,335988,23
32,335989,17
33,335989,9
38,335989,14
47,335990,19
9,335990,25
54,335991,14
67,335992,24
68,335992,1
60,335993,12
72,335994,9
22,335994,5
55,335995,16
56,335995,117
75,335995,4
79,335996,17
65,335996,0
14,335997,34
24,336000,1
28,336000,75
12,336001,2
99,336004,3
50,335990,2
23,335994,2
53,335995,13
69,335995,12
31,335995,61
48,335996,2
31,335997,21
15,335997,17
71,335999,34
87,336000,39
18,336001,13
20,336001,65
86,336003,6
70,336004,13
50,335996,0
90,336000,18
14,336003,6
20,336012,23
100,336024,115
41,335989,12
36,335989,2
37,335989,26
21,335988,32
31,335989,10
43,335990,8
33,335992,5
18,335994,81
35,335995,1
232,335995,16
37,335995,1
44,335996,1
76,335996,7
80,335996,2
51,335997,2
17,335998,21
55,335999,37
49,335999,31
41,336000,6
27,336000,40
94,336001,1
95,336002,29
53,336004,6
55,336004,48
76,336004,15
5,335991,13
24,335992,26
55,335993,2
19,335994,5
48,335994,45
73,335994,1
49,335996,22
72,335996,8
32,335997,61
33,335997,4
81,335997,1

2025-02-10 11:56:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:08 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:08 - root - INFO - SQL:
SELECT bbb."bowler", bbb."match_id", COUNT(*) AS "wickets"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
     ON bbb."match_id" = wt."match_id"
    AND bbb."over_id" = wt."over_id"
    AND bbb."ball_id" = wt."ball_id"
    AND bbb."innings_no" = wt."innings_no"
   WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
   GROUP BY bbb."bowler", bbb."match_id"
   LIMIT 100;
Results:
bowler,match_id,wickets
106,335987,2
15,335987,1
1,335987,2
9,335987,1
29,335988,2
25,335988,1
121,335988,1
32,335989,1
90,335989,2
50,335990,2
14,335990,1
106,335991,1
5,335991,1
73,335994,1
120,335994,1
121,335994,2
61,335995,1
80,335996,2
14,335997,1
22,335998,3
117,336000,2
71,336002,1
15,336003,1
67,336011,3
78,336011,1
119,335988,1
84,335991,1
25,335992,1
77,335992,1
72,335994,2
60,335995,1
31,335995,2
50,335996,3
82,335998,1
70,335999,2
49,336002,2
67,336004,3
81,336007,3
94,336007,2
29,336011,1
149,336017,4
126,336028,2
38,336028,3
151,336042,2
122,336044,2
38,392187,2
177,392209,2
98,335999,1
99,336004,1
39,336005,2
120,336012,1
136,336020,2
137,336020,2
77,336024,1
25,336024,2
70,336029,2
31,336032,1
115,336041,1
120,336045,1
126,392203,2
181,392204,1
39,392215,1
210,419143,2
54,392201,1
13,335987,1
89,335989,2
39,335992,2
59,335999,2
102,336005,2
131,335991,2
126,335992,1
117,335993,2
73,335996,2
78,335996,1
49,335996,1
15,335997,1
126,335997,2
38,335997,1
119,336001,2
44,336002,3
27,336000,1
29,336004,2
89,336006,1
437,336008,1
41,336009,1
77,336011,2
15,336011,2
143,336012,1
15,336015,1
121,336018,1
117,336014,1
109,392214,2
184,392215,1
32,335997,2
119,335998,1
82,336002,1
77,336004,1
38,336005,1
41,336006,1
117,336006,1

2025-02-10 11:56:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-02-10 11:56:09 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:10 - root - INFO - SQL:
SELECT "season_id", COUNT("match_id") AS "total_matches"
   FROM "IPL"."IPL"."MATCH"
   GROUP BY "season_id"
   ORDER BY "season_id"
   LIMIT 100;
Results:
season_id,total_matches
1,58
2,56
3,58
4,72
5,74
6,74
7,59
8,56
9,60

2025-02-10 11:56:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:11 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:11 - root - INFO - SQL:
SELECT bbb."striker", m."season_id", SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
     ON bbb."match_id" = bs."match_id"
    AND bbb."over_id" = bs."over_id"
    AND bbb."ball_id" = bs."ball_id"
    AND bbb."innings_no" = bs."innings_no"
   JOIN "IPL"."IPL"."MATCH" AS m
     ON bbb."match_id" = m."match_id"
   GROUP BY bbb."striker", m."season_id"
   LIMIT 100;
Results:
striker,season_id,total_runs
10,1,114
18,1,189
25,1,221
12,1,46
22,1,18
28,1,96
41,1,406
55,1,155
30,1,10
32,1,468
50,1,30
53,1,436
56,1,161
58,1,112
63,1,157
67,1,90
72,1,24
85,1,4
88,1,145
93,1,20
95,1,103
64,1,179
92,1,8
97,1,167
101,1,311
106,1,2
102,1,36
109,1,241
116,1,2
118,1,4
120,1,35
119,1,16
128,1,42
137,1,9
133,2,364
154,2,372
50,2,84
15,2,8
101,2,98
161,2,138
54,2,124
87,2,9
131,2,1
169,2,57
62,2,72
65,2,115
193,2,0
198,2,3
109,3,186
218,3,3
222,3,0
42,3,191
237,3,72
181,3,2
9,4,424
252,4,49
29,4,150
232,4,1
234,4,4
21,5,441
31,5,194
81,5,68
323,5,32
255,6,293
42,1,340
37,1,33
44,1,514
43,1,34
103,1,193
104,1,12
113,1,117
117,1,3
124,1,13
131,1,2
135,1,104
149,1,2
151,1,0
71,2,218
156,2,2
157,2,56
158,2,93
138,2,18
159,2,11
137,2,12
126,2,33
26,2,332
27,2,340
57,2,362
63,2,70
124,2,16
30,2,1
121,2,8
68,2,30
167,2,1
160,2,3
94,2,0
174,2,0
136,2,26
177,2,122
96,2,168

2025-02-10 11:56:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:12 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:13 - root - INFO - SQL:
SELECT bbb."bowler", m."season_id", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
      ON bbb."match_id" = m."match_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler", m."season_id"
    LIMIT 100;
Results:
bowler,season_id,total_wickets
106,1,9
63,1,6
120,1,17
32,1,17
118,1,12
25,1,7
50,1,5
44,1,4
12,1,2
37,1,1
117,1,8
72,1,2
102,1,22
58,1,3
71,2,11
50,2,12
137,2,5
94,2,2
160,2,3
131,1,11
149,1,10
137,1,2
194,2,18
124,2,21
126,2,15
121,2,14
75,2,2
181,2,2
174,2,1
81,3,16
218,3,1
278,4,6
84,4,11
116,1,5
215,2,14
57,2,11
54,2,4
15,2,6
177,2,9
77,2,6
56,2,7
242,3,3
90,3,8
116,3,9
126,3,3
32,3,6
9,4,7
135,4,1
273,4,4
89,4,8
157,4,4
258,4,11
109,4,15
4,4,1
228,4,4
439,4,3
242,4,5
305,5,1
276,5,12
32,5,6
131,6,16
211,5,1
422,8,1
119,1,8
151,1,11
124,1,7
436,1,1
156,2,3
159,2,1
38,3,11
67,1,17
109,1,17
41,1,3
115,1,5
135,1,1
89,2,10
193,2,2
192,2,3
135,3,3
238,3,10
234,3,6
94,4,14
32,4,6
29,5,8
188,5,8
221,6,10
22,1,3
439,2,4
158,2,4
154,2,4
66,2,5
61,3,13
83,3,9
63,3,3
215,3,1
57,3,2
9,3,13
94,3,15
109,3,9
119,3,2

2025-02-10 11:56:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:14 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:14 - root - INFO - SQL:
SELECT bbb."striker", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
      ON bbb."match_id" = bs."match_id"
     AND bbb."over_id" = bs."over_id"
     AND bbb."ball_id" = bs."ball_id"
     AND bbb."innings_no" = bs."innings_no"
    GROUP BY bbb."striker"
    ORDER BY "total_runs" DESC
    LIMIT 100;
Results:
striker,total_runs
21,4083
8,3987
57,3874
40,3589
46,3390
162,3356
187,3339
20,3270
110,3161
42,3082
31,2719
41,2702
85,2529
88,2515
185,2490
32,2469
2,2431
9,2414
133,2329
208,2325
27,2281
6,2170
100,2148
147,2146
53,2069
19,1977
221,1959
154,1926
17,1868
96,1800
64,1771
26,1656
35,1552
183,1466
23,1439
320,1426
104,1395
87,1324
4,1322
62,1304
254,1304
1,1303
303,1287
71,1262
306,1212
79,1205
135,1154
29,1079
18,1074
52,1017
351,1015
158,1001
54,985
56,974
109,962
10,949
383,942
305,917
236,897
97,886
339,842
216,789
214,788
50,783
260,781
44,768
345,728
74,724
354,713
191,691
178,676
255,676
48,672
197,663
355,657
163,648
157,604
237,597
334,574
161,530
171,514
204,506
67,505
167,496
308,472
310,470
276,468
393,449
101,423
25,417
280,414
192,409
266,401
11,394
203,390
321,388
63,386
372,379
112,375
65,368

2025-02-10 11:56:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:15 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:16 - root - INFO - SQL:
SELECT bbb."bowler", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler"
    ORDER BY "total_wickets" DESC
    LIMIT 100;
Results:
bowler,total_wickets
194,143
136,123
71,122
67,119
50,118
201,100
81,97
73,97
15,92
61,90
94,90
131,89
299,85
315,85
14,84
109,82
32,81
29,79
35,77
190,75
151,75
232,72
126,72
80,72
364,70
106,68
89,68
39,65
9,65
121,59
221,56
38,55
382,54
84,53
367,52
357,51
310,49
186,47
188,45
124,45
276,42
235,40
270,40
350,40
31,40
374,40
333,39
140,38
77,38
120,37
248,37
166,36
163,35
378,34
27,34
403,34
309,33
83,31
334,31
296,31
280,30
116,30
293,30
386,29
82,29
311,29
321,29
196,28
346,28
223,28
175,28
256,27
267,27
90,27
191,27
375,26
370,25
192,25
66,25
147,24
21,24
154,23
238,23
316,23
102,22
451,22
91,21
177,21
56,20
371,20
258,19
253,19
356,18
162,18
60,18
359,18
137,18
325,17
149,17
460,17

2025-02-10 11:56:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:17 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:17 - root - INFO - SQL:
SELECT DISTINCT p."player_id", p."player_name"
    FROM "IPL"."IPL"."PLAYER" AS p
    JOIN "IPL"."IPL"."BALL_BY_BALL" AS bbb
      ON p."player_id" = bbb."bowler"
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    LIMIT 100;
Results:
player_id,player_name
343,B Laughlin
280,NLTC Perera
315,SP Narine
221,KA Pollard
366,Parvez Rasool
385,BCJ Cutting
362,DJG Sammy
328,MJ Clarke
405,PJ Cummins
117,Mohammad Asif
274,AC Thomas
294,P Parameswaran
268,JJ van der Wath
228,Bipul Sharma
115,RR Raje
66,B Lee
370,PV Tambe
241,PD Collingwood
413,KH Pandya
8,V Kohli
270,S Aravind
56,A Symonds
256,Harmeet Singh
310,JP Faulkner
267,WD Parnell
335,A Chandila
182,LA Carseldine
120,MS Gony
196,A Singh
193,C Nanda
389,M de Lange
68,WA Mota
461,AF Milne
175,DL Vettori
346,JD Unadkat
84,I Sharma
162,CH Gayle
358,LJ Wright
344,AS Rajpoot
412,P Sahu
80,DS Kulkarni
15,Z Khan
374,AR Patel
112,DB Ravi Teja
42,S Dhawan
460,Mustafizur Rahman
368,S Kaul
102,Sohail Tanvir
321,Azhar Mahmood
165,FH Edwards
5,Mohammad Hafeez
318,CJ McKay
57,RG Sharma
54,Y Venugopal Rao
302,BA Bhatt
451,BW Hilfenhaus
124,A Kumble
401,D Wiese
429,BB Sran
293,S Nadeem
284,RN ten Doeschate
432,S Kaushik
371,NM Coulter-Nile
291,L Ablish
418,M Ashwin
311,HV Patel
254,AJ Finch
383,LMP Simmons
160,Kamran Khan
73,A Nehra
211,AA Jhunjhunwala
323,RJ Peterson
189,D du Preez
273,SB Wagh
376,JDS Neesham
356,R Dhawan
186,SB Jakati
126,MM Patel
226,S Narwal
314,Ankit Sharma
86,Shoaib Malik
297,AA Chavan
299,B Kumar
135,TM Dilshan
459,GS Sandhu
90,MF Maharoof
439,AM Salvi
430,A Zampa
352,SMSM Senanayake
179,Shoaib Ahmed
153,RR Powar
464,SM Boland
158,KP Pietersen
10,CL White
363,KW Richardson
298,ND Doshi
136,A Mishra
390,R Tewatia
387,BE Hendricks
94,DW Steyn

2025-02-10 11:56:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-02-10 11:56:18 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:18 - root - INFO - SQL:
SELECT "kind_out", COUNT(*) AS "occurrences"
    FROM "IPL"."IPL"."WICKET_TAKEN"
    GROUP BY "kind_out"
    ORDER BY "occurrences" DESC
    LIMIT 100;
Results:
kind_out,occurrences
caught,3894
bowled,1234
run out,677
lbw,393
stumped,219
caught and bowled,184
retired hurt,8
hit wicket,8
obstructing the field,1

2025-02-10 11:56:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-02-10 11:56:20 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:20 - root - INFO - SQL:
SELECT bbb."striker", p."player_name", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
      ON bbb."match_id" = bs."match_id"
     AND bbb."over_id" = bs."over_id"
     AND bbb."ball_id" = bs."ball_id"
     AND bbb."innings_no" = bs."innings_no"
    JOIN "IPL"."IPL"."PLAYER" AS p
      ON bbb."striker" = p."player_id"
    GROUP BY bbb."striker", p."player_name"
    ORDER BY "total_runs" DESC
    LIMIT 10;
Results:
striker,player_name,total_runs
21,SK Raina,4083
8,V Kohli,3987
57,RG Sharma,3874
40,G Gambhir,3589
46,RV Uthappa,3390
162,CH Gayle,3356
187,DA Warner,3339
20,MS Dhoni,3270
110,AB de Villiers,3161
42,S Dhawan,3082

2025-02-10 11:56:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-02-10 11:56:21 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:22 - root - INFO - SQL:
SELECT bbb."bowler", p."player_name", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."PLAYER" AS p
      ON bbb."bowler" = p."player_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler", p."player_name"
    ORDER BY "total_wickets" DESC
    LIMIT 10;
Results:
bowler,player_name,total_wickets
194,SL Malinga,143
136,A Mishra,123
71,DJ Bravo,122
67,PP Chawla,119
50,Harbhajan Singh,118
201,R Ashwin,100
81,R Vinay Kumar,97
73,A Nehra,97
15,Z Khan,92
61,RP Singh,90

2025-02-10 11:56:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:23 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:23 - root - INFO - SQL:
SELECT DISTINCT p."player_id", p."player_name"
    FROM "IPL"."IPL"."PLAYER" AS p
    WHERE p."player_id" IN (
      SELECT DISTINCT "striker" FROM "IPL"."IPL"."BALL_BY_BALL"
    )
    AND p."player_id" IN (
      SELECT DISTINCT "bowler" FROM "IPL"."IPL"."BALL_BY_BALL"
    )
    LIMIT 100;
Results:
player_id,player_name
346,JD Unadkat
297,AA Chavan
22,JDP Oram
8,V Kohli
356,R Dhawan
226,S Narwal
48,AM Nayar
389,M de Lange
83,M Kartik
334,AD Russell
115,RR Raje
90,MF Maharoof
357,MG Johnson
198,AB McDonald
316,GB Hogg
185,M Vijay
291,L Ablish
332,K Upadhyay
41,V Sehwag
105,Umar Gul
244,A Mithun
213,A Uniyal
350,CH Morris
190,M Morkel
258,DT Christian
181,KP Appanna
432,S Kaushik
199,Y Nagar
378,MA Starc
312,DAJ Bracewell
186,SB Jakati
56,A Symonds
68,WA Mota
180,GR Napier
383,LMP Simmons
189,D du Preez
362,DJG Sammy
309,KK Cooper
234,SJ Srivastava
159,T Henderson
5,Mohammad Hafeez
109,JA Morkel
53,AC Gilchrist
52,LRPL Taylor
89,R Bhatia
1,SC Ganguly
343,B Laughlin
4,DJ Hussey
303,F du Plessis
223,DP Nannes
71,DJ Bravo
192,J Botha
280,NLTC Perera
179,Shoaib Ahmed
73,A Nehra
372,CJ Anderson
238,SW Tait
411,C Munro
166,KV Sharma
70,Shahid Afridi
306,SPD Smith
133,SR Tendulkar
374,AR Patel
85,AM Rahane
416,KJ Abbott
311,HV Patel
158,KP Pietersen
267,WD Parnell
121,M Muralitharan
369,Sachin Baby
229,FY Fazal
120,MS Gony
154,JP Duminy
359,IC Pandey
307,MN Samuels
390,R Tewatia
395,Anureet Singh
335,A Chandila
276,Shakib Al Hasan
305,GJ Maxwell
424,Swapnil Singh
418,M Ashwin
392,Karanveer Singh
144,Shoaib Akhtar
281,NL McCullum
44,ST Jayasuriya
162,CH Gayle
215,YA Abdulla
314,Ankit Sharma
261,AUK Pathan
75,Pankaj Singh
409,MP Stoinis
325,A Ashish Reddy
45,DJ Thornely
153,RR Powar
302,BA Bhatt
270,S Aravind
165,FH Edwards
353,BJ Rohrer
206,Jaskaran Singh

2025-02-10 11:56:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-02-10 11:56:24 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:25 - root - INFO - SQL:
SELECT m."season_id", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BATSMAN_SCORED" AS bs
    JOIN "IPL"."IPL"."MATCH" AS m
      ON bs."match_id" = m."match_id"
    GROUP BY m."season_id"
    ORDER BY m."season_id"
    LIMIT 100;
Results:
season_id,total_runs
1,16799
2,15068
3,17180
4,19865
5,21309
6,20892
7,17634
8,16675
9,17959

2025-02-10 11:56:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-02-10 11:56:26 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:26 - root - INFO - SQL:
SELECT m."season_id", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."WICKET_TAKEN" AS wt
    JOIN "IPL"."IPL"."MATCH" AS m
      ON wt."match_id" = m."match_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY m."season_id"
    ORDER BY m."season_id"
    LIMIT 100;
Results:
season_id,total_wickets
1,602
2,607
3,603
4,736
5,770
6,807
7,594
8,606
9,588

2025-02-10 11:56:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:56:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:56:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:56:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:56:27 - snowflake.connector.connection - INFO - closed
2025-02-10 11:56:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:56:27 - root - INFO - SQL:
SELECT p."player_id", p."player_name", p."bowling_skill"
    FROM "IPL"."IPL"."PLAYER" AS p
    WHERE p."bowling_skill" IS NOT NULL
    LIMIT 100;
Results:
player_id,player_name,bowling_skill
1,SC Ganguly,Right-arm medium
2,BB McCullum,Right-arm medium
3,RT Ponting,Right-arm medium
4,DJ Hussey,Right-arm offbreak
5,Mohammad Hafeez,Right-arm offbreak
6,R Dravid,Right-arm offbreak
7,W Jaffer,Right-arm offbreak
8,V Kohli,Right-arm medium
9,JH Kallis,Right-arm fast-medium
10,CL White,Legbreak googly
11,MV Boucher,Right-arm medium
12,B Akhil,Right-arm medium-fast
13,AA Noffke,Right-arm fast-medium
14,P Kumar,Right-arm medium
15,Z Khan,Left-arm fast-medium
16,SB Joshi,Slow left-arm orthodox
17,PA Patel,Right-arm medium
18,ML Hayden,Right-arm medium
19,MEK Hussey,Right-arm medium
20,MS Dhoni,Right-arm medium
21,SK Raina,Right-arm offbreak
22,JDP Oram,Right-arm fast-medium
23,S Badrinath,Right-arm offbreak
24,K Goel,Right-arm offbreak
25,JR Hopes,Right-arm medium
26,KC Sangakkara,Right-arm offbreak
27,Yuvraj Singh,Slow left-arm orthodox
28,SM Katich,Slow left-arm chinaman
29,IK Pathan,Left-arm medium-fast
30,T Kohli,Right-arm medium
31,YK Pathan,Right-arm offbreak
32,SR Watson,Right-arm fast-medium
33,M Kaif,Right-arm offbreak
34,DS Lehmann,Slow left-arm orthodox
36,M Rawat,Right-arm medium
37,D Salunkhe,Legbreak
38,SK Warne,Legbreak googly
39,SK Trivedi,Right-arm medium
40,G Gambhir,Legbreak
41,V Sehwag,Right-arm offbreak
42,S Dhawan,Right-arm offbreak
43,L Ronchi,Right-arm medium
44,ST Jayasuriya,Slow left-arm orthodox
45,DJ Thornely,Right-arm medium
46,RV Uthappa,Right-arm medium
47,PR Shah,Right-arm medium
48,AM Nayar,Right-arm medium
49,SM Pollock,Right-arm fast-medium
50,Harbhajan Singh,Right-arm offbreak
51,S Chanderpaul,Legbreak
52,LRPL Taylor,Right-arm offbreak
53,AC Gilchrist,Right-arm offbreak
54,Y Venugopal Rao,Right-arm offbreak
55,VVS Laxman,Right-arm offbreak
56,A Symonds,Right-arm offbreak
57,RG Sharma,Right-arm offbreak
58,SB Styris,Right-arm medium
59,SB Bangar,Right-arm medium-fast
60,WPUJC Vaas,Left-arm fast-medium
61,RP Singh,Left-arm fast-medium
62,WP Saha,Right-arm medium
63,LR Shukla,Right-arm medium
64,DPMD Jayawardene,Right-arm medium
65,S Sohal,Legbreak
66,B Lee,Right-arm fast
67,PP Chawla,Legbreak
68,WA Mota,Right-arm medium
69,Kamran Akmal,Right-arm medium
70,Shahid Afridi,Legbreak googly
71,DJ Bravo,Right-arm medium-fast
72,MA Khote,Right-arm medium
73,A Nehra,Left-arm medium-fast
74,GC Smith,Right-arm offbreak
75,Pankaj Singh,Right-arm medium-fast
76,RR Sarwan,Legbreak
77,S Sreesanth,Right-arm fast-medium
78,VRV Singh,Right-arm medium-fast
79,SS Tiwary,Right-arm medium
80,DS Kulkarni,Right-arm medium
81,R Vinay Kumar,Right-arm medium
82,AB Agarkar,Right-arm fast
83,M Kartik,Slow left-arm orthodox
84,I Sharma,Right-arm fast-medium
85,AM Rahane,Right-arm medium
86,Shoaib Malik,Right-arm offbreak
87,MK Tiwary,Legbreak googly
88,KD Karthik,Right-arm medium
89,R Bhatia,Right-arm medium-fast
90,MF Maharoof,Right-arm fast-medium
91,VY Mahesh,Right-arm medium-fast
92,TM Srivastava,Right-arm medium
93,B Chipli,Right-arm medium
94,DW Steyn,Right-arm fast
95,DB Das,Legbreak googly
96,MK Pandey,Right-arm medium
97,HH Gibbs,Right-arm bowler
98,DNT Zoysa,Left-arm fast-medium
99,D Kalyankrishna,Right-arm medium-fast
100,SE Marsh,Slow left-arm orthodox
101,SA Asnodkar,Right-arm offbreak

2025-02-10 11:56:27 - root - INFO - itercount: 0
2025-02-10 11:56:27 - root - INFO - Database Name: IPL
Schema Name: IPL
,0
table_name,PLAYER_MATCH
description,
DDL,"create or replace TABLE PLAYER_MATCH (
	""match_id"" NUMBER(38,0),
	""player_id"" NUMBER(38,0),
	""role"" VARCHAR(16777216),
	""team_id"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,1
table_name,PLAYER
description,
DDL,"create or replace TABLE PLAYER (
	""player_id"" NUMBER(38,0),
	""player_name"" VARCHAR(16777216),
	""dob"" VARCHAR(16777216),
	""batting_hand"" VARCHAR(16777216),
	""bowling_skill"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216)
);"

Database Name: IPL
Schema Name: IPL
,2
table_name,BATSMAN_SCORED
description,
DDL,"create or replace TABLE BATSMAN_SCORED (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""runs_scored"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,3
table_name,WICKET_TAKEN
description,
DDL,"create or replace TABLE WICKET_TAKEN (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""player_out"" NUMBER(38,0),
	""kind_out"" VARCHAR(16777216),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,4
table_name,BALL_BY_BALL
description,
DDL,"create or replace TABLE BALL_BY_BALL (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0),
	""team_batting"" NUMBER(38,0),
	""team_bowling"" NUMBER(38,0),
	""striker_batting_position"" NUMBER(38,0),
	""striker"" NUMBER(38,0),
	""non_striker"" NUMBER(38,0),
	""bowler"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,5
table_name,EXTRA_RUNS
description,
DDL,"create or replace TABLE EXTRA_RUNS (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""extra_type"" VARCHAR(16777216),
	""extra_runs"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,6
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""match_id"" NUMBER(38,0),
	""team_1"" NUMBER(38,0),
	""team_2"" NUMBER(38,0),
	""match_date"" VARCHAR(16777216),
	""season_id"" NUMBER(38,0),
	""venue"" VARCHAR(16777216),
	""toss_winner"" NUMBER(38,0),
	""toss_decision"" VARCHAR(16777216),
	""win_type"" VARCHAR(16777216),
	""win_margin"" NUMBER(38,0),
	""outcome_type"" VARCHAR(16777216),
	""match_winner"" NUMBER(38,0),
	""man_of_the_match"" NUMBER(38,0)
);"

Database Name: IPL
Schema Name: IPL
,7
table_name,TEAM
description,
DDL,"create or replace TABLE TEAM (
	""team_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'IPL': {'IPL': ['PLAYER_MATCH', 'PLAYER', 'BATSMAN_SCORED', 'WICKET_TAKEN', 'BALL_BY_BALL', 'EXTRA_RUNS', 'MATCH', 'TEAM']}}
Begin Exploring Related Columns
**Relevant Tables, Columns, and Their Potential Usage:**

1. **"PLAYER" Table:**
   - `"player_id"`: Used to uniquely identify players; essential for joining player information.
   - `"player_name"`: Player's name; used for output and display purposes.

2. **"BATSMAN_SCORED" Table:**
   - `"match_id"`: Links scoring events to specific matches.
   - `"over_id"`, `"ball_id"`, `"innings_no"`: Used to uniquely identify each ball; essential for joining with "BALL_BY_BALL".
   - `"runs_scored"`: Runs scored on each ball; used to calculate total runs per batsman.

3. **"BALL_BY_BALL" Table:**
   - `"match_id"`, `"over_id"`, `"ball_id"`, `"innings_no"`: Used for joining with "BATSMAN_SCORED" and "WICKET_TAKEN".
   - `"striker"`: Player ID of the batsman facing the delivery; used to associate runs scored with the correct batsman.
   - `"bowler"`: Player ID of the bowler delivering the ball; used to associate wickets taken with the correct bowler.

4. **"WICKET_TAKEN" Table:**
   - `"match_id"`, `"over_id"`, `"ball_id"`, `"innings_no"`: Used to join with "BALL_BY_BALL" to find out who bowled the delivery.
   - `"player_out"`: Player ID of the batsman who got out; used to count dismissals.
   - `"kind_out"`: Method of dismissal; conditions used to exclude 'run out', 'hit wicket', and 'retired hurt'.

5. **"MATCH" Table:**
   - `"match_id"`: Links deliveries and events to specific matches.
   - `"season_id"`: Identifies the IPL season; used to group data by season.

6. **"TEAM" Table:**
   - `"team_id"`: May be used if team-specific aggregations are needed.

**Conditions That May Be Used:**
- Exclude dismissals where `"kind_out"` is 'run out', 'hit wicket', or 'retired hurt'.
- Group data by `"season_id"` to segregate statistics per season.
- Break ties in runs or wickets using the smaller `"player_id"`.
- Join tables on matching `"match_id"`, `"over_id"`, `"ball_id"`, and `"innings_no"` to combine relevant data.
- Use `"striker"` as the batsman and `"bowler"` as the bowler in the "BALL_BY_BALL" table.

---

**SQL Queries to Explore the Data:**

1. **Retrieve the list of players with their IDs and names:**

   ```sql
   SELECT "player_id", "player_name"
   FROM "IPL"."IPL"."PLAYER"
   LIMIT 100;
   ```

2. **View the runs scored on each ball from the "BATSMAN_SCORED" table:**

   ```sql
   SELECT "match_id", "over_id", "ball_id", "innings_no", "runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   LIMIT 100;
   ```

3. **List the striker and bowler for each delivery from the "BALL_BY_BALL" table:**

   ```sql
   SELECT "match_id", "over_id", "ball_id", "innings_no", "striker", "bowler"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   LIMIT 100;
   ```

4. **Retrieve distinct dismissal types from the "WICKET_TAKEN" table:**

   ```sql
   SELECT DISTINCT "kind_out"
   FROM "IPL"."IPL"."WICKET_TAKEN"
   LIMIT 100;
   ```

5. **Get matches along with their season IDs from the "MATCH" table:**

   ```sql
   SELECT "match_id", "season_id"
   FROM "IPL"."IPL"."MATCH"
   LIMIT 100;
   ```

6. **Calculate total runs scored by each batsman in a match:**

   ```sql
   SELECT bbb."striker", bbb."match_id", SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
     ON bbb."match_id" = bs."match_id"
    AND bbb."over_id" = bs."over_id"
    AND bbb."ball_id" = bs."ball_id"
    AND bbb."innings_no" = bs."innings_no"
   GROUP BY bbb."striker", bbb."match_id"
   LIMIT 100;
   ```

7. **Find total wickets taken by each bowler in a match (excluding certain dismissals):**

   ```sql
   SELECT bbb."bowler", bbb."match_id", COUNT(*) AS "wickets"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
     ON bbb."match_id" = wt."match_id"
    AND bbb."over_id" = wt."over_id"
    AND bbb."ball_id" = wt."ball_id"
    AND bbb."innings_no" = wt."innings_no"
   WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
   GROUP BY bbb."bowler", bbb."match_id"
   LIMIT 100;
   ```

8. **List all matches played in each season:**

   ```sql
   SELECT "season_id", COUNT("match_id") AS "total_matches"
   FROM "IPL"."IPL"."MATCH"
   GROUP BY "season_id"
   ORDER BY "season_id"
   LIMIT 100;
   ```

9. **Get total runs scored by each batsman per season:**

   ```sql
   SELECT bbb."striker", m."season_id", SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
     ON bbb."match_id" = bs."match_id"
    AND bbb."over_id" = bs."over_id"
    AND bbb."ball_id" = bs."ball_id"
    AND bbb."innings_no" = bs."innings_no"
   JOIN "IPL"."IPL"."MATCH" AS m
     ON bbb."match_id" = m."match_id"
   GROUP BY bbb."striker", m."season_id"
   LIMIT 100;
   ```

10. **Get total wickets taken by each bowler per season (excluding certain dismissals):**

    ```sql
    SELECT bbb."bowler", m."season_id", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
      ON bbb."match_id" = m."match_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler", m."season_id"
    LIMIT 100;
    ```

11. **List the batsmen with their total runs in descending order:**

    ```sql
    SELECT bbb."striker", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
      ON bbb."match_id" = bs."match_id"
     AND bbb."over_id" = bs."over_id"
     AND bbb."ball_id" = bs."ball_id"
     AND bbb."innings_no" = bs."innings_no"
    GROUP BY bbb."striker"
    ORDER BY "total_runs" DESC
    LIMIT 100;
    ```

12. **List the bowlers with their total wickets in descending order (excluding certain dismissals):**

    ```sql
    SELECT bbb."bowler", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler"
    ORDER BY "total_wickets" DESC
    LIMIT 100;
    ```

13. **Retrieve the names of players who have taken wickets (excluding certain dismissals):**

    ```sql
    SELECT DISTINCT p."player_id", p."player_name"
    FROM "IPL"."IPL"."PLAYER" AS p
    JOIN "IPL"."IPL"."BALL_BY_BALL" AS bbb
      ON p."player_id" = bbb."bowler"
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    LIMIT 100;
    ```

14. **Find the number of times each dismissal type occurred:**

    ```sql
    SELECT "kind_out", COUNT(*) AS "occurrences"
    FROM "IPL"."IPL"."WICKET_TAKEN"
    GROUP BY "kind_out"
    ORDER BY "occurrences" DESC
    LIMIT 100;
    ```

15. **Get the player IDs and names of the top 10 batsmen by total runs scored overall:**

    ```sql
    SELECT bbb."striker", p."player_name", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
      ON bbb."match_id" = bs."match_id"
     AND bbb."over_id" = bs."over_id"
     AND bbb."ball_id" = bs."ball_id"
     AND bbb."innings_no" = bs."innings_no"
    JOIN "IPL"."IPL"."PLAYER" AS p
      ON bbb."striker" = p."player_id"
    GROUP BY bbb."striker", p."player_name"
    ORDER BY "total_runs" DESC
    LIMIT 10;
    ```

16. **Get the player IDs and names of the top 10 bowlers by total wickets taken overall (excluding certain dismissals):**

    ```sql
    SELECT bbb."bowler", p."player_name", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."PLAYER" AS p
      ON bbb."bowler" = p."player_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler", p."player_name"
    ORDER BY "total_wickets" DESC
    LIMIT 10;
    ```

17. **List all players who have both batted and bowled in matches:**

    ```sql
    SELECT DISTINCT p."player_id", p."player_name"
    FROM "IPL"."IPL"."PLAYER" AS p
    WHERE p."player_id" IN (
      SELECT DISTINCT "striker" FROM "IPL"."IPL"."BALL_BY_BALL"
    )
    AND p."player_id" IN (
      SELECT DISTINCT "bowler" FROM "IPL"."IPL"."BALL_BY_BALL"
    )
    LIMIT 100;
    ```

18. **Get the total number of runs scored in each season:**

    ```sql
    SELECT m."season_id", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BATSMAN_SCORED" AS bs
    JOIN "IPL"."IPL"."MATCH" AS m
      ON bs."match_id" = m."match_id"
    GROUP BY m."season_id"
    ORDER BY m."season_id"
    LIMIT 100;
    ```

19. **Find the total number of wickets taken in each season (excluding certain dismissals):**

    ```sql
    SELECT m."season_id", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."WICKET_TAKEN" AS wt
    JOIN "IPL"."IPL"."MATCH" AS m
      ON wt."match_id" = m."match_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY m."season_id"
    ORDER BY m."season_id"
    LIMIT 100;
    ```

20. **Retrieve the player IDs and names of bowlers along with their bowling skills:**

    ```sql
    SELECT p."player_id", p."player_name", p."bowling_skill"
    FROM "IPL"."IPL"."PLAYER" AS p
    WHERE p."bowling_skill" IS NOT NULL
    LIMIT 100;
    ```

These queries progressively explore the data needed to solve the task, starting from simple retrievals to more complex aggregations. They help in understanding the relationships between tables and the data contained within them, which is essential for calculating the top batsmen and bowlers per season as per the task requirements.Query:
SELECT "player_id", "player_name"
   FROM "IPL"."IPL"."PLAYER"
   LIMIT 100;
Answer:
player_id,player_name
1,SC Ganguly
2,BB McCullum
3,RT Ponting
4,DJ Hussey
5,Mohammad Hafeez
6,R Dravid
7,W Jaffer
8,V Kohli
9,JH Kallis
10,CL White
11,MV Boucher
12,B Akhil
13,AA Noffke
14,P Kumar
15,Z Khan
16,SB Joshi
17,PA Patel
18,ML Hayden
19,MEK Hussey
20,MS Dhoni
21,SK Raina
22,JDP Oram
23,S Badrinath
24,K Goel
25,JR Hopes
26,KC Sangakkara
27,Yuvraj Singh
28,SM Katich
29,IK Pathan
30,T Kohli
31,YK Pathan
32,SR Watson
33,M Kaif
34,DS Lehmann
36,M Rawat
37,D Salunkhe
38,SK Warne
39,SK Trivedi
40,G Gambhir
41,V Sehwag
42,S Dhawan
43,L Ronchi
44,ST Jayasuriya
45,DJ Thornely
46,RV Uthappa
47,PR Shah
48,AM Nayar
49,SM Pollock
50,Harbhajan Singh
51,S Chanderpaul
52,LRPL Taylor
53,AC Gilchrist
54,Y Venugopal Rao
55,VVS Laxman
56,A Symonds
57,RG Sharma
58,SB Styris
59,SB Bangar
60,WPUJC Vaas
61,RP Singh
62,WP Saha
63,LR Shukla
64,DPMD Jayawardene
65,S Sohal
66,B Lee
67,PP Chawla
68,WA Mota
69,Kamran Akmal
70,Shahid Afridi
71,DJ Bravo
72,MA Khote
73,A Nehra
74,GC Smith
75,Pankaj Singh
76,RR Sarwan
77,S Sreesanth
78,VRV Singh
79,SS Tiwary
80,DS Kulkarni
81,R Vinay Kumar
82,AB Agarkar
83,M Kartik
84,I Sharma
85,AM Rahane
86,Shoaib Malik
87,MK Tiwary
88,KD Karthik
89,R Bhatia
90,MF Maharoof
91,VY Mahesh
92,TM Srivastava
93,B Chipli
94,DW Steyn
95,DB Das
96,MK Pandey
97,HH Gibbs
98,DNT Zoysa
99,D Kalyankrishna
100,SE Marsh
101,SA Asnodkar
Query:
SELECT "match_id", "over_id", "ball_id", "innings_no", "runs_scored"
   FROM "IPL"."IPL"."BATSMAN_SCORED"
   LIMIT 100;
Answer:
match_id,over_id,ball_id,innings_no,runs_scored
335987,1,1,2,1
335987,1,2,1,0
335987,1,3,2,0
335987,1,4,1,0
335987,1,4,2,1
335987,1,5,1,0
335987,1,5,2,1
335987,1,6,1,0
335987,1,6,2,0
335987,1,7,1,0
335987,1,7,2,0
335987,2,1,1,0
335987,2,1,2,0
335987,2,2,1,4
335987,2,2,2,0
335987,2,3,1,4
335987,2,3,2,0
335987,2,4,1,6
335987,2,4,2,1
335987,2,5,1,4
335987,2,5,2,0
335987,2,6,1,0
335987,2,6,2,0
335987,3,1,1,0
335987,3,1,2,0
335987,3,2,1,0
335987,3,2,2,0
335987,3,3,1,0
335987,3,3,2,1
335987,3,4,1,4
335987,3,4,2,0
335987,3,5,1,1
335987,3,6,1,0
335987,3,6,2,0
335987,3,7,2,1
335987,4,1,2,2
335987,4,2,1,6
335987,4,2,2,1
335987,4,3,1,0
335987,4,3,2,0
335987,4,4,1,4
335987,4,4,2,0
335987,4,5,1,0
335987,4,5,2,0
335987,4,6,1,1
335987,4,6,2,0
335987,4,7,1,6
335987,5,1,1,4
335987,5,1,2,1
335987,5,2,1,1
335987,5,2,2,1
335987,5,3,1,4
335987,5,3,2,0
335987,5,4,1,0
335987,5,4,2,6
335987,5,5,1,1
335987,5,5,2,0
335987,5,6,1,0
335987,5,6,2,0
335987,6,1,1,1
335987,6,1,2,0
335987,6,2,1,0
335987,6,2,2,0
335987,6,3,1,0
335987,6,3,2,0
335987,6,4,1,0
335987,6,4,2,1
335987,6,5,1,0
335987,6,5,2,1
335987,6,6,1,0
335987,6,6,2,0
335987,7,1,1,1
335987,7,1,2,0
335987,7,2,1,1
335987,7,2,2,0
335987,7,3,1,1
335987,7,3,2,1
335987,7,4,1,2
335987,7,5,1,1
335987,7,6,1,1
335987,7,6,2,0
335987,7,7,2,0
335987,7,8,2,4
335987,8,1,1,0
335987,8,1,2,1
335987,8,2,1,1
335987,8,2,2,0
335987,8,3,1,1
335987,8,3,2,1
335987,8,4,1,1
335987,8,4,2,2
335987,8,5,1,1
335987,8,5,2,0
335987,8,6,1,1
335987,8,6,2,0
335987,9,1,1,0
335987,9,1,2,0
335987,9,2,1,0
335987,9,2,2,0
335987,9,3,1,0
Query:
SELECT "match_id", "over_id", "ball_id", "innings_no", "striker", "bowler"
   FROM "IPL"."IPL"."BALL_BY_BALL"
   LIMIT 100;
Answer:
match_id,over_id,ball_id,innings_no,striker,bowler
335987,1,1,2,6,106
335987,1,2,1,2,14
335987,1,2,2,7,106
335987,1,3,1,2,14
335987,1,3,2,7,106
335987,1,4,1,2,14
335987,1,4,2,7,106
335987,1,5,1,2,14
335987,1,5,2,6,106
335987,1,6,1,2,14
335987,1,6,2,7,106
335987,1,7,1,2,14
335987,1,7,2,7,106
335987,2,1,1,2,15
335987,2,1,2,6,84
335987,2,2,1,2,15
335987,2,2,2,8,84
335987,2,3,1,2,15
335987,2,3,2,8,84
335987,2,4,1,2,15
335987,2,4,2,8,84
335987,2,5,1,2,15
335987,2,5,2,7,84
335987,2,6,1,2,15
335987,2,6,2,7,84
335987,3,1,1,1,14
335987,3,1,2,8,106
335987,3,2,1,1,14
335987,3,2,2,8,106
335987,3,3,1,1,14
335987,3,3,2,9,106
335987,3,4,1,2,14
335987,3,4,2,7,106
335987,3,5,1,2,14
335987,3,5,2,7,106
335987,3,6,1,1,14
335987,3,6,2,7,106
335987,3,7,2,7,106
335987,4,1,1,2,13
335987,4,1,2,7,84
335987,4,2,1,2,13
335987,4,2,2,7,84
335987,4,3,1,2,13
335987,4,3,2,9,84
335987,4,4,1,1,13
335987,4,4,2,9,84
335987,4,5,1,1,13
335987,4,5,2,7,84
335987,4,6,1,1,13
335987,4,6,2,7,84
335987,4,7,1,2,13
335987,5,1,1,1,14
335987,5,1,2,9,82
335987,5,2,1,1,14
335987,5,2,2,7,82
335987,5,3,1,2,14
335987,5,3,2,9,82
335987,5,4,1,2,14
335987,5,4,2,9,82
335987,5,5,1,2,14
335987,5,5,2,9,82
335987,5,6,1,1,14
335987,5,6,2,10,82
335987,6,1,1,2,15
335987,6,1,2,7,106
335987,6,2,1,1,15
335987,6,2,2,7,106
335987,6,3,1,3,15
335987,6,3,2,11,106
335987,6,4,1,3,15
335987,6,4,2,11,106
335987,6,5,1,3,15
335987,6,5,2,10,106
335987,6,6,1,3,15
335987,6,6,2,11,106
335987,7,1,1,2,13
335987,7,1,2,10,82
335987,7,2,1,3,13
335987,7,2,2,10,82
335987,7,3,1,2,13
335987,7,3,2,10,82
335987,7,4,1,3,13
335987,7,4,2,11,82
335987,7,5,1,3,13
335987,7,5,2,11,82
335987,7,6,1,2,13
335987,7,6,2,11,82
335987,7,7,2,11,82
335987,7,8,2,11,82
335987,8,1,1,2,15
335987,8,1,2,10,1
335987,8,2,1,2,15
335987,8,2,2,11,1
335987,8,3,1,3,15
335987,8,3,2,10,1
335987,8,4,1,2,15
335987,8,4,2,11,1
335987,8,5,1,3,15
335987,8,5,2,11,1
335987,8,6,1,2,15
Query:
SELECT DISTINCT "kind_out"
   FROM "IPL"."IPL"."WICKET_TAKEN"
   LIMIT 100;
Answer:
kind_out
caught
bowled
run out
lbw
retired hurt
stumped
caught and bowled
hit wicket
obstructing the field
Query:
SELECT "match_id", "season_id"
   FROM "IPL"."IPL"."MATCH"
   LIMIT 100;
Answer:
match_id,season_id
335987,1
335988,1
335989,1
335990,1
335991,1
335992,1
335993,1
335994,1
335995,1
335996,1
335997,1
335998,1
335999,1
336000,1
336001,1
336002,1
336003,1
336004,1
336005,1
336006,1
336007,1
336008,1
336009,1
336010,1
336011,1
336012,1
336013,1
336014,1
336015,1
336016,1
336017,1
336018,1
336019,1
336020,1
336021,1
336022,1
336023,1
336024,1
336025,1
336026,1
336027,1
336028,1
336029,1
336030,1
336031,1
336032,1
336033,1
336034,1
336036,1
336037,1
336038,1
336039,1
336040,1
336041,1
336042,1
336043,1
336044,1
336045,1
392186,2
392187,2
392188,2
392189,2
392190,2
392191,2
392193,2
392194,2
392196,2
392197,2
392199,2
392200,2
392201,2
392202,2
392203,2
392204,2
392205,2
392206,2
392207,2
392208,2
392209,2
392210,2
392211,2
392212,2
392213,2
392214,2
392215,2
392216,2
392217,2
392218,2
392219,2
392220,2
392221,2
392222,2
392223,2
392224,2
392225,2
392226,2
392227,2
392228,2
392229,2
392230,2
Query:
SELECT bbb."striker", bbb."match_id", SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
     ON bbb."match_id" = bs."match_id"
    AND bbb."over_id" = bs."over_id"
    AND bbb."ball_id" = bs."ball_id"
    AND bbb."innings_no" = bs."innings_no"
   GROUP BY bbb."striker", bbb."match_id"
   LIMIT 100;
Answer:
striker,match_id,total_runs
7,335987,6
8,335987,1
1,335987,10
9,335987,8
11,335987,7
13,335987,9
4,335987,12
18,335988,25
20,335988,2
22,335988,13
29,335988,3
30,335989,7
45,335990,0
53,335991,23
32,335992,76
64,335992,2
70,335993,2
49,335994,17
24,335996,18
74,335997,49
15,335987,3
25,335988,71
26,335988,54
27,335988,23
32,335989,17
33,335989,9
38,335989,14
47,335990,19
9,335990,25
54,335991,14
67,335992,24
68,335992,1
60,335993,12
72,335994,9
22,335994,5
55,335995,16
56,335995,117
75,335995,4
79,335996,17
65,335996,0
14,335997,34
24,336000,1
28,336000,75
12,336001,2
99,336004,3
50,335990,2
23,335994,2
53,335995,13
69,335995,12
31,335995,61
48,335996,2
31,335997,21
15,335997,17
71,335999,34
87,336000,39
18,336001,13
20,336001,65
86,336003,6
70,336004,13
50,335996,0
90,336000,18
14,336003,6
20,336012,23
100,336024,115
41,335989,12
36,335989,2
37,335989,26
21,335988,32
31,335989,10
43,335990,8
33,335992,5
18,335994,81
35,335995,1
232,335995,16
37,335995,1
44,335996,1
76,335996,7
80,335996,2
51,335997,2
17,335998,21
55,335999,37
49,335999,31
41,336000,6
27,336000,40
94,336001,1
95,336002,29
53,336004,6
55,336004,48
76,336004,15
5,335991,13
24,335992,26
55,335993,2
19,335994,5
48,335994,45
73,335994,1
49,335996,22
72,335996,8
32,335997,61
33,335997,4
81,335997,1
Query:
SELECT bbb."bowler", bbb."match_id", COUNT(*) AS "wickets"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
     ON bbb."match_id" = wt."match_id"
    AND bbb."over_id" = wt."over_id"
    AND bbb."ball_id" = wt."ball_id"
    AND bbb."innings_no" = wt."innings_no"
   WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
   GROUP BY bbb."bowler", bbb."match_id"
   LIMIT 100;
Answer:
bowler,match_id,wickets
106,335987,2
15,335987,1
1,335987,2
9,335987,1
29,335988,2
25,335988,1
121,335988,1
32,335989,1
90,335989,2
50,335990,2
14,335990,1
106,335991,1
5,335991,1
73,335994,1
120,335994,1
121,335994,2
61,335995,1
80,335996,2
14,335997,1
22,335998,3
117,336000,2
71,336002,1
15,336003,1
67,336011,3
78,336011,1
119,335988,1
84,335991,1
25,335992,1
77,335992,1
72,335994,2
60,335995,1
31,335995,2
50,335996,3
82,335998,1
70,335999,2
49,336002,2
67,336004,3
81,336007,3
94,336007,2
29,336011,1
149,336017,4
126,336028,2
38,336028,3
151,336042,2
122,336044,2
38,392187,2
177,392209,2
98,335999,1
99,336004,1
39,336005,2
120,336012,1
136,336020,2
137,336020,2
77,336024,1
25,336024,2
70,336029,2
31,336032,1
115,336041,1
120,336045,1
126,392203,2
181,392204,1
39,392215,1
210,419143,2
54,392201,1
13,335987,1
89,335989,2
39,335992,2
59,335999,2
102,336005,2
131,335991,2
126,335992,1
117,335993,2
73,335996,2
78,335996,1
49,335996,1
15,335997,1
126,335997,2
38,335997,1
119,336001,2
44,336002,3
27,336000,1
29,336004,2
89,336006,1
437,336008,1
41,336009,1
77,336011,2
15,336011,2
143,336012,1
15,336015,1
121,336018,1
117,336014,1
109,392214,2
184,392215,1
32,335997,2
119,335998,1
82,336002,1
77,336004,1
38,336005,1
41,336006,1
117,336006,1
Query:
SELECT "season_id", COUNT("match_id") AS "total_matches"
   FROM "IPL"."IPL"."MATCH"
   GROUP BY "season_id"
   ORDER BY "season_id"
   LIMIT 100;
Answer:
season_id,total_matches
1,58
2,56
3,58
4,72
5,74
6,74
7,59
8,56
9,60
Query:
SELECT bbb."striker", m."season_id", SUM(bs."runs_scored") AS "total_runs"
   FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
   JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
     ON bbb."match_id" = bs."match_id"
    AND bbb."over_id" = bs."over_id"
    AND bbb."ball_id" = bs."ball_id"
    AND bbb."innings_no" = bs."innings_no"
   JOIN "IPL"."IPL"."MATCH" AS m
     ON bbb."match_id" = m."match_id"
   GROUP BY bbb."striker", m."season_id"
   LIMIT 100;
Answer:
striker,season_id,total_runs
10,1,114
18,1,189
25,1,221
12,1,46
22,1,18
28,1,96
41,1,406
55,1,155
30,1,10
32,1,468
50,1,30
53,1,436
56,1,161
58,1,112
63,1,157
67,1,90
72,1,24
85,1,4
88,1,145
93,1,20
95,1,103
64,1,179
92,1,8
97,1,167
101,1,311
106,1,2
102,1,36
109,1,241
116,1,2
118,1,4
120,1,35
119,1,16
128,1,42
137,1,9
133,2,364
154,2,372
50,2,84
15,2,8
101,2,98
161,2,138
54,2,124
87,2,9
131,2,1
169,2,57
62,2,72
65,2,115
193,2,0
198,2,3
109,3,186
218,3,3
222,3,0
42,3,191
237,3,72
181,3,2
9,4,424
252,4,49
29,4,150
232,4,1
234,4,4
21,5,441
31,5,194
81,5,68
323,5,32
255,6,293
42,1,340
37,1,33
44,1,514
43,1,34
103,1,193
104,1,12
113,1,117
117,1,3
124,1,13
131,1,2
135,1,104
149,1,2
151,1,0
71,2,218
156,2,2
157,2,56
158,2,93
138,2,18
159,2,11
137,2,12
126,2,33
26,2,332
27,2,340
57,2,362
63,2,70
124,2,16
30,2,1
121,2,8
68,2,30
167,2,1
160,2,3
94,2,0
174,2,0
136,2,26
177,2,122
96,2,168
Query:
SELECT bbb."bowler", m."season_id", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
      ON bbb."match_id" = m."match_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler", m."season_id"
    LIMIT 100;
Answer:
bowler,season_id,total_wickets
106,1,9
63,1,6
120,1,17
32,1,17
118,1,12
25,1,7
50,1,5
44,1,4
12,1,2
37,1,1
117,1,8
72,1,2
102,1,22
58,1,3
71,2,11
50,2,12
137,2,5
94,2,2
160,2,3
131,1,11
149,1,10
137,1,2
194,2,18
124,2,21
126,2,15
121,2,14
75,2,2
181,2,2
174,2,1
81,3,16
218,3,1
278,4,6
84,4,11
116,1,5
215,2,14
57,2,11
54,2,4
15,2,6
177,2,9
77,2,6
56,2,7
242,3,3
90,3,8
116,3,9
126,3,3
32,3,6
9,4,7
135,4,1
273,4,4
89,4,8
157,4,4
258,4,11
109,4,15
4,4,1
228,4,4
439,4,3
242,4,5
305,5,1
276,5,12
32,5,6
131,6,16
211,5,1
422,8,1
119,1,8
151,1,11
124,1,7
436,1,1
156,2,3
159,2,1
38,3,11
67,1,17
109,1,17
41,1,3
115,1,5
135,1,1
89,2,10
193,2,2
192,2,3
135,3,3
238,3,10
234,3,6
94,4,14
32,4,6
29,5,8
188,5,8
221,6,10
22,1,3
439,2,4
158,2,4
154,2,4
66,2,5
61,3,13
83,3,9
63,3,3
215,3,1
57,3,2
9,3,13
94,3,15
109,3,9
119,3,2
Query:
SELECT bbb."striker", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
      ON bbb."match_id" = bs."match_id"
     AND bbb."over_id" = bs."over_id"
     AND bbb."ball_id" = bs."ball_id"
     AND bbb."innings_no" = bs."innings_no"
    GROUP BY bbb."striker"
    ORDER BY "total_runs" DESC
    LIMIT 100;
Answer:
striker,total_runs
21,4083
8,3987
57,3874
40,3589
46,3390
162,3356
187,3339
20,3270
110,3161
42,3082
31,2719
41,2702
85,2529
88,2515
185,2490
32,2469
2,2431
9,2414
133,2329
208,2325
27,2281
6,2170
100,2148
147,2146
53,2069
19,1977
221,1959
154,1926
17,1868
96,1800
64,1771
26,1656
35,1552
183,1466
23,1439
320,1426
104,1395
87,1324
4,1322
62,1304
254,1304
1,1303
303,1287
71,1262
306,1212
79,1205
135,1154
29,1079
18,1074
52,1017
351,1015
158,1001
54,985
56,974
109,962
10,949
383,942
305,917
236,897
97,886
339,842
216,789
214,788
50,783
260,781
44,768
345,728
74,724
354,713
191,691
178,676
255,676
48,672
197,663
355,657
163,648
157,604
237,597
334,574
161,530
171,514
204,506
67,505
167,496
308,472
310,470
276,468
393,449
101,423
25,417
280,414
192,409
266,401
11,394
203,390
321,388
63,386
372,379
112,375
65,368
Query:
SELECT bbb."bowler", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler"
    ORDER BY "total_wickets" DESC
    LIMIT 100;
Answer:
bowler,total_wickets
194,143
136,123
71,122
67,119
50,118
201,100
81,97
73,97
15,92
61,90
94,90
131,89
299,85
315,85
14,84
109,82
32,81
29,79
35,77
190,75
151,75
232,72
126,72
80,72
364,70
106,68
89,68
39,65
9,65
121,59
221,56
38,55
382,54
84,53
367,52
357,51
310,49
186,47
188,45
124,45
276,42
235,40
270,40
350,40
31,40
374,40
333,39
140,38
77,38
120,37
248,37
166,36
163,35
378,34
27,34
403,34
309,33
83,31
334,31
296,31
280,30
116,30
293,30
386,29
82,29
311,29
321,29
196,28
346,28
223,28
175,28
256,27
267,27
90,27
191,27
375,26
370,25
192,25
66,25
147,24
21,24
154,23
238,23
316,23
102,22
451,22
91,21
177,21
56,20
371,20
258,19
253,19
356,18
162,18
60,18
359,18
137,18
325,17
149,17
460,17
Query:
SELECT DISTINCT p."player_id", p."player_name"
    FROM "IPL"."IPL"."PLAYER" AS p
    JOIN "IPL"."IPL"."BALL_BY_BALL" AS bbb
      ON p."player_id" = bbb."bowler"
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    LIMIT 100;
Answer:
player_id,player_name
343,B Laughlin
280,NLTC Perera
315,SP Narine
221,KA Pollard
366,Parvez Rasool
385,BCJ Cutting
362,DJG Sammy
328,MJ Clarke
405,PJ Cummins
117,Mohammad Asif
274,AC Thomas
294,P Parameswaran
268,JJ van der Wath
228,Bipul Sharma
115,RR Raje
66,B Lee
370,PV Tambe
241,PD Collingwood
413,KH Pandya
8,V Kohli
270,S Aravind
56,A Symonds
256,Harmeet Singh
310,JP Faulkner
267,WD Parnell
335,A Chandila
182,LA Carseldine
120,MS Gony
196,A Singh
193,C Nanda
389,M de Lange
68,WA Mota
461,AF Milne
175,DL Vettori
346,JD Unadkat
84,I Sharma
162,CH Gayle
358,LJ Wright
344,AS Rajpoot
412,P Sahu
80,DS Kulkarni
15,Z Khan
374,AR Patel
112,DB Ravi Teja
42,S Dhawan
460,Mustafizur Rahman
368,S Kaul
102,Sohail Tanvir
321,Azhar Mahmood
165,FH Edwards
5,Mohammad Hafeez
318,CJ McKay
57,RG Sharma
54,Y Venugopal Rao
302,BA Bhatt
451,BW Hilfenhaus
124,A Kumble
401,D Wiese
429,BB Sran
293,S Nadeem
284,RN ten Doeschate
432,S Kaushik
371,NM Coulter-Nile
291,L Ablish
418,M Ashwin
311,HV Patel
254,AJ Finch
383,LMP Simmons
160,Kamran Khan
73,A Nehra
211,AA Jhunjhunwala
323,RJ Peterson
189,D du Preez
273,SB Wagh
376,JDS Neesham
356,R Dhawan
186,SB Jakati
126,MM Patel
226,S Narwal
314,Ankit Sharma
86,Shoaib Malik
297,AA Chavan
299,B Kumar
135,TM Dilshan
459,GS Sandhu
90,MF Maharoof
439,AM Salvi
430,A Zampa
352,SMSM Senanayake
179,Shoaib Ahmed
153,RR Powar
464,SM Boland
158,KP Pietersen
10,CL White
363,KW Richardson
298,ND Doshi
136,A Mishra
390,R Tewatia
387,BE Hendricks
94,DW Steyn
Query:
SELECT "kind_out", COUNT(*) AS "occurrences"
    FROM "IPL"."IPL"."WICKET_TAKEN"
    GROUP BY "kind_out"
    ORDER BY "occurrences" DESC
    LIMIT 100;
Answer:
kind_out,occurrences
caught,3894
bowled,1234
run out,677
lbw,393
stumped,219
caught and bowled,184
retired hurt,8
hit wicket,8
obstructing the field,1
Query:
SELECT bbb."striker", p."player_name", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
      ON bbb."match_id" = bs."match_id"
     AND bbb."over_id" = bs."over_id"
     AND bbb."ball_id" = bs."ball_id"
     AND bbb."innings_no" = bs."innings_no"
    JOIN "IPL"."IPL"."PLAYER" AS p
      ON bbb."striker" = p."player_id"
    GROUP BY bbb."striker", p."player_name"
    ORDER BY "total_runs" DESC
    LIMIT 10;
Answer:
striker,player_name,total_runs
21,SK Raina,4083
8,V Kohli,3987
57,RG Sharma,3874
40,G Gambhir,3589
46,RV Uthappa,3390
162,CH Gayle,3356
187,DA Warner,3339
20,MS Dhoni,3270
110,AB de Villiers,3161
42,S Dhawan,3082
Query:
SELECT bbb."bowler", p."player_name", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
      ON bbb."match_id" = wt."match_id"
     AND bbb."over_id" = wt."over_id"
     AND bbb."ball_id" = wt."ball_id"
     AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."PLAYER" AS p
      ON bbb."bowler" = p."player_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY bbb."bowler", p."player_name"
    ORDER BY "total_wickets" DESC
    LIMIT 10;
Answer:
bowler,player_name,total_wickets
194,SL Malinga,143
136,A Mishra,123
71,DJ Bravo,122
67,PP Chawla,119
50,Harbhajan Singh,118
201,R Ashwin,100
81,R Vinay Kumar,97
73,A Nehra,97
15,Z Khan,92
61,RP Singh,90
Query:
SELECT DISTINCT p."player_id", p."player_name"
    FROM "IPL"."IPL"."PLAYER" AS p
    WHERE p."player_id" IN (
      SELECT DISTINCT "striker" FROM "IPL"."IPL"."BALL_BY_BALL"
    )
    AND p."player_id" IN (
      SELECT DISTINCT "bowler" FROM "IPL"."IPL"."BALL_BY_BALL"
    )
    LIMIT 100;
Answer:
player_id,player_name
346,JD Unadkat
297,AA Chavan
22,JDP Oram
8,V Kohli
356,R Dhawan
226,S Narwal
48,AM Nayar
389,M de Lange
83,M Kartik
334,AD Russell
115,RR Raje
90,MF Maharoof
357,MG Johnson
198,AB McDonald
316,GB Hogg
185,M Vijay
291,L Ablish
332,K Upadhyay
41,V Sehwag
105,Umar Gul
244,A Mithun
213,A Uniyal
350,CH Morris
190,M Morkel
258,DT Christian
181,KP Appanna
432,S Kaushik
199,Y Nagar
378,MA Starc
312,DAJ Bracewell
186,SB Jakati
56,A Symonds
68,WA Mota
180,GR Napier
383,LMP Simmons
189,D du Preez
362,DJG Sammy
309,KK Cooper
234,SJ Srivastava
159,T Henderson
5,Mohammad Hafeez
109,JA Morkel
53,AC Gilchrist
52,LRPL Taylor
89,R Bhatia
1,SC Ganguly
343,B Laughlin
4,DJ Hussey
303,F du Plessis
223,DP Nannes
71,DJ Bravo
192,J Botha
280,NLTC Perera
179,Shoaib Ahmed
73,A Nehra
372,CJ Anderson
238,SW Tait
411,C Munro
166,KV Sharma
70,Shahid Afridi
306,SPD Smith
133,SR Tendulkar
374,AR Patel
85,AM Rahane
416,KJ Abbott
311,HV Patel
158,KP Pietersen
267,WD Parnell
121,M Muralitharan
369,Sachin Baby
229,FY Fazal
120,MS Gony
154,JP Duminy
359,IC Pandey
307,MN Samuels
390,R Tewatia
395,Anureet Singh
335,A Chandila
276,Shakib Al Hasan
305,GJ Maxwell
424,Swapnil Singh
418,M Ashwin
392,Karanveer Singh
144,Shoaib Akhtar
281,NL McCullum
44,ST Jayasuriya
162,CH Gayle
215,YA Abdulla
314,Ankit Sharma
261,AUK Pathan
75,Pankaj Singh
409,MP Stoinis
325,A Ashish Reddy
45,DJ Thornely
153,RR Powar
302,BA Bhatt
270,S Aravind
165,FH Edwards
353,BJ Rohrer
206,Jaskaran Singh
Query:
SELECT m."season_id", SUM(bs."runs_scored") AS "total_runs"
    FROM "IPL"."IPL"."BATSMAN_SCORED" AS bs
    JOIN "IPL"."IPL"."MATCH" AS m
      ON bs."match_id" = m."match_id"
    GROUP BY m."season_id"
    ORDER BY m."season_id"
    LIMIT 100;
Answer:
season_id,total_runs
1,16799
2,15068
3,17180
4,19865
5,21309
6,20892
7,17634
8,16675
9,17959
Query:
SELECT m."season_id", COUNT(*) AS "total_wickets"
    FROM "IPL"."IPL"."WICKET_TAKEN" AS wt
    JOIN "IPL"."IPL"."MATCH" AS m
      ON wt."match_id" = m."match_id"
    WHERE wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY m."season_id"
    ORDER BY m."season_id"
    LIMIT 100;
Answer:
season_id,total_wickets
1,602
2,607
3,603
4,736
5,770
6,807
7,594
8,606
9,588
Query:
SELECT p."player_id", p."player_name", p."bowling_skill"
    FROM "IPL"."IPL"."PLAYER" AS p
    WHERE p."bowling_skill" IS NOT NULL
    LIMIT 100;
Answer:
player_id,player_name,bowling_skill
1,SC Ganguly,Right-arm medium
2,BB McCullum,Right-arm medium
3,RT Ponting,Right-arm medium
4,DJ Hussey,Right-arm offbreak
5,Mohammad Hafeez,Right-arm offbreak
6,R Dravid,Right-arm offbreak
7,W Jaffer,Right-arm offbreak
8,V Kohli,Right-arm medium
9,JH Kallis,Right-arm fast-medium
10,CL White,Legbreak googly
11,MV Boucher,Right-arm medium
12,B Akhil,Right-arm medium-fast
13,AA Noffke,Right-arm fast-medium
14,P Kumar,Right-arm medium
15,Z Khan,Left-arm fast-medium
16,SB Joshi,Slow left-arm orthodox
17,PA Patel,Right-arm medium
18,ML Hayden,Right-arm medium
19,MEK Hussey,Right-arm medium
20,MS Dhoni,Right-arm medium
21,SK Raina,Right-arm offbreak
22,JDP Oram,Right-arm fast-medium
23,S Badrinath,Right-arm offbreak
24,K Goel,Right-arm offbreak
25,JR Hopes,Right-arm medium
26,KC Sangakkara,Right-arm offbreak
27,Yuvraj Singh,Slow left-arm orthodox
28,SM Katich,Slow left-arm chinaman
29,IK Pathan,Left-arm medium-fast
30,T Kohli,Right-arm medium
31,YK Pathan,Right-arm offbreak
32,SR Watson,Right-arm fast-medium
33,M Kaif,Right-arm offbreak
34,DS Lehmann,Slow left-arm orthodox
36,M Rawat,Right-arm medium
37,D Salunkhe,Legbreak
38,SK Warne,Legbreak googly
39,SK Trivedi,Right-arm medium
40,G Gambhir,Legbreak
41,V Sehwag,Right-arm offbreak
42,S Dhawan,Right-arm offbreak
43,L Ronchi,Right-arm medium
44,ST Jayasuriya,Slow left-arm orthodox
45,DJ Thornely,Right-arm medium
46,RV Uthappa,Right-arm medium
47,PR Shah,Right-arm medium
48,AM Nayar,Right-arm medium
49,SM Pollock,Right-arm fast-medium
50,Harbhajan Singh,Right-arm offbreak
51,S Chanderpaul,Legbreak
52,LRPL Taylor,Right-arm offbreak
53,AC Gilchrist,Right-arm offbreak
54,Y Venugopal Rao,Right-arm offbreak
55,VVS Laxman,Right-arm offbreak
56,A Symonds,Right-arm offbreak
57,RG Sharma,Right-arm offbreak
58,SB Styris,Right-arm medium
59,SB Bangar,Right-arm medium-fast
60,WPUJC Vaas,Left-arm fast-medium
61,RP Singh,Left-arm fast-medium
62,WP Saha,Right-arm medium
63,LR Shukla,Right-arm medium
64,DPMD Jayawardene,Right-arm medium
65,S Sohal,Legbreak
66,B Lee,Right-arm fast
67,PP Chawla,Legbreak
68,WA Mota,Right-arm medium
69,Kamran Akmal,Right-arm medium
70,Shahid Afridi,Legbreak googly
71,DJ Bravo,Right-arm medium-fast
72,MA Khote,Right-arm medium
73,A Nehra,Left-arm medium-fast
74,GC Smith,Right-arm offbreak
75,Pankaj Singh,Right-arm medium-fast
76,RR Sarwan,Legbreak
77,S Sreesanth,Right-arm fast-medium
78,VRV Singh,Right-arm medium-fast
79,SS Tiwary,Right-arm medium
80,DS Kulkarni,Right-arm medium
81,R Vinay Kumar,Right-arm medium
82,AB Agarkar,Right-arm fast
83,M Kartik,Slow left-arm orthodox
84,I Sharma,Right-arm fast-medium
85,AM Rahane,Right-arm medium
86,Shoaib Malik,Right-arm offbreak
87,MK Tiwary,Legbreak googly
88,KD Karthik,Right-arm medium
89,R Bhatia,Right-arm medium-fast
90,MF Maharoof,Right-arm fast-medium
91,VY Mahesh,Right-arm medium-fast
92,TM Srivastava,Right-arm medium
93,B Chipli,Right-arm medium
94,DW Steyn,Right-arm fast
95,DB Das,Legbreak googly
96,MK Pandey,Right-arm medium
97,HH Gibbs,Right-arm bowler
98,DNT Zoysa,Left-arm fast-medium
99,D Kalyankrishna,Right-arm medium-fast
100,SE Marsh,Slow left-arm orthodox
101,SA Asnodkar,Right-arm offbreak
End Exploring Related Columns
Task: For each IPL season, identify the top three batsmen with the highest total runs scored and the top three bowlers with the most wickets taken, excluding ‘run out’, ‘hit wicket’, and ‘retired hurt’ dismissals. In the event of ties in runs or wickets, break the tie using the smaller player ID. Then output these six players in matched positions—batsman 1 with bowler 1, batsman 2 with bowler 2, and batsman 3 with bowler 3—in ascending order of the season ID, along with each player’s total runs or wickets.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
season_id,position,batsman_name,batsman_runs,bowler_name,bowler_wickets
season1:int,1,batsman_name1:str,total_runs1:int,bowler_name1:str,total_wickets1:int
season1:int,2,batsman_name2:str,total_runs2:int,bowler_name2:str,total_wickets2:int
season1:int,3,batsman_name3:str,total_runs3:int,bowler_name3:str,total_wickets3:int
season2:int,1,batsman_name4:str,total_runs4:int,bowler_name4:str,total_wickets4:int
season2:int,2,batsman_name5:str,total_runs5:int,bowler_name5:str,total_wickets5:int
season2:int,3,batsman_name6:str,total_runs6:int,bowler_name6:str,total_wickets6:int
...
```

**Explanation:**

- **season_id** *(int)*: The unique identifier for each IPL season.
- **position** *(1-3)*: The rank position (1 for the top player, 2 for second, 3 for third).
- **batsman_name** *(str)*: The name of the batsman who is among the top three run-scorers for the season.
- **batsman_runs** *(int)*: The total runs scored by the batsman in that season.
- **bowler_name** *(str)*: The name of the bowler who is among the top three wicket-takers (excluding 'run out', 'hit wicket', and 'retired hurt') for the season.
- **bowler_wickets** *(int)*: The total wickets taken by the bowler in that season.

The data is ordered by **season_id** in ascending order. For each season, the top three batsmen and top three bowlers are listed in matched positions—**position** 1 batsman with **position** 1 bowler, and so on. In case of ties in runs or wickets, the player with the smaller player ID is ranked higher..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'IPL': {'IPL': ['PLAYER_MATCH', 'PLAYER', 'BATSMAN_SCORED', 'WICKET_TAKEN', 'BALL_BY_BALL', 'EXTRA_RUNS', 'MATCH', 'TEAM']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 11:57:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:57:00 - root - INFO - ```sql
WITH batsman_totals AS (
    SELECT
        bbb."striker" AS "player_id",
        m."season_id",
        SUM(bs."runs_scored") AS "total_runs"
    FROM
        "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
        ON bbb."match_id" = bs."match_id"
        AND bbb."over_id" = bs."over_id"
        AND bbb."ball_id" = bs."ball_id"
        AND bbb."innings_no" = bs."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
        ON bbb."match_id" = m."match_id"
    GROUP BY
        bbb."striker",
        m."season_id"
),

batsman_ranked AS (
    SELECT
        "season_id",
        "player_id",
        "total_runs",
        ROW_NUMBER() OVER (
            PARTITION BY "season_id"
            ORDER BY "total_runs" DESC, "player_id" ASC
        ) AS "rank"
    FROM
        batsman_totals
),

top_batsmen AS (
    SELECT
        b."season_id",
        b."player_id",
        b."total_runs",
        b."rank"
    FROM
        batsman_ranked b
    WHERE
        b."rank" <= 3
),

batsmen_with_names AS (
    SELECT
        b."season_id",
        b."rank" AS "position",
        p."player_name" AS "batsman_name",
        b."total_runs" AS "batsman_runs"
    FROM
        top_batsmen b
    JOIN
        "IPL"."IPL"."PLAYER" p
    ON
        b."player_id" = p."player_id"
),

bowler_totals AS (
    SELECT
        bbb."bowler" AS "player_id",
        m."season_id",
        COUNT(*) AS "total_wickets"
    FROM
        "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
        ON bbb."match_id" = wt."match_id"
        AND bbb."over_id" = wt."over_id"
        AND bbb."ball_id" = wt."ball_id"
        AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
        ON bbb."match_id" = m."match_id"
    WHERE
        wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY
        bbb."bowler",
        m."season_id"
),

bowler_ranked AS (
    SELECT
        "season_id",
        "player_id",
        "total_wickets",
        ROW_NUMBER() OVER (
            PARTITION BY "season_id"
            ORDER BY "total_wickets" DESC, "player_id" ASC
        ) AS "rank"
    FROM
        bowler_totals
),

top_bowlers AS (
    SELECT
        b."season_id",
        b."player_id",
        b."total_wickets",
        b."rank"
    FROM
        bowler_ranked b
    WHERE
        b."rank" <= 3
),

bowlers_with_names AS (
    SELECT
        b."season_id",
        b."rank" AS "position",
        p."player_name" AS "bowler_name",
        b."total_wickets" AS "bowler_wickets"
    FROM
        top_bowlers b
    JOIN
        "IPL"."IPL"."PLAYER" p
    ON
        b."player_id" = p."player_id"
)

SELECT
    batsmen_with_names."season_id",
    batsmen_with_names."position",
    batsmen_with_names."batsman_name",
    batsmen_with_names."batsman_runs",
    bowlers_with_names."bowler_name",
    bowlers_with_names."bowler_wickets"
FROM
    batsmen_with_names
JOIN
    bowlers_with_names
ON
    batsmen_with_names."season_id" = bowlers_with_names."season_id" AND
    batsmen_with_names."position" = bowlers_with_names."position"
ORDER BY
    batsmen_with_names."season_id" ASC,
    batsmen_with_names."position" ASC;
```
2025-02-10 11:57:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:57:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:57:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:57:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 27
2025-02-10 11:57:01 - snowflake.connector.connection - INFO - closed
2025-02-10 11:57:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:57:02 - root - INFO - itercount: 1
2025-02-10 11:57:02 - root - INFO - 0
2025-02-10 11:57:02 - root - INFO - results: 
season_id,position,batsman_name,batsman_runs,bowler_name,bowler_wickets
1,1,SE Marsh,616,Sohail Tanvir,22
1,2,G Gambhir,534,SK Warne,19
1,3,ST Jayasuriya,514,SR Watson,17
2,1,ML Hayden,572,RP Singh,23
2,2,AC Gilchrist,495,A Kumble,21
2,3,AB de Villiers,465,A Nehra,19
3,1,SR Tendulkar,617,PP Ojha,21
3,2,JH Kallis,572,Harbhajan Singh,17
3,3,SK Raina,505,A Kumble,17
4,1,CH Gayle,604,SL Malinga,28
4,2,V Kohli,557,MM Patel,22
4,3,SR Tendulkar,553,S Aravind,21
5,1,CH Gayle,733,M Morkel,25
5,2,G Gambhir,590,SP Narine,24
5,3,S Dhawan,569,SL Malinga,22
6,1,MEK Hussey,733,DJ Bravo,32
6,2,CH Gayle,694,JP Faulkner,28
6,3,SK Raina,548,Harbhajan Singh,24
7,1,RV Uthappa,660,MM Sharma,23
7,2,DR Smith,566,SP Narine,21
7,3,GJ Maxwell,552,B Kumar,20
8,1,DA Warner,562,DJ Bravo,26
8,2,LMP Simmons,540,SL Malinga,24
8,3,V Kohli,503,A Nehra,22
9,1,V Kohli,969,B Kumar,23
9,2,DA Warner,848,YS Chahal,21
9,3,AB de Villiers,687,SR Watson,20


2025-02-10 11:57:02 - root - INFO - Please check the answer again by reviewing For each IPL season, identify the top three batsmen with the highest total runs scored and the top three bowlers with the most wickets taken, excluding ‘run out’, ‘hit wicket’, and ‘retired hurt’ dismissals. In the event of ties in runs or wickets, break the tie using the smaller player ID. Then output these six players in matched positions—batsman 1 with bowler 1, batsman 2 with bowler 2, and batsman 3 with bowler 3—in ascending order of the season ID, along with each player’s total runs or wickets., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
season_id,position,batsman_name,batsman_runs,bowler_name,bowler_wickets
season1:int,1,batsman_name1:str,total_runs1:int,bowler_name1:str,total_wickets1:int
season1:int,2,batsman_name2:str,total_runs2:int,bowler_name2:str,total_wickets2:int
season1:int,3,batsman_name3:str,total_runs3:int,bowler_name3:str,total_wickets3:int
season2:int,1,batsman_name4:str,total_runs4:int,bowler_name4:str,total_wickets4:int
season2:int,2,batsman_name5:str,total_runs5:int,bowler_name5:str,total_wickets5:int
season2:int,3,batsman_name6:str,total_runs6:int,bowler_name6:str,total_wickets6:int
...
```

**Explanation:**

- **season_id** *(int)*: The unique identifier for each IPL season.
- **position** *(1-3)*: The rank position (1 for the top player, 2 for second, 3 for third).
- **batsman_name** *(str)*: The name of the batsman who is among the top three run-scorers for the season.
- **batsman_runs** *(int)*: The total runs scored by the batsman in that season.
- **bowler_name** *(str)*: The name of the bowler who is among the top three wicket-takers (excluding 'run out', 'hit wicket', and 'retired hurt') for the season.
- **bowler_wickets** *(int)*: The total wickets taken by the bowler in that season.

The data is ordered by **season_id** in ascending order. For each season, the top three batsmen and top three bowlers are listed in matched positions—**position** 1 batsman with **position** 1 bowler, and so on. In case of ties in runs or wickets, the player with the smaller player ID is ranked higher. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
season_id,position,batsman_name,batsman_runs,bowler_name,bowler_wickets
1,1,SE Marsh,616,Sohail Tanvir,22
1,2,G Gambhir,534,SK Warne,19
1,3,ST Jayasuriya,514,SR Watson,17
2,1,ML Hayden,572,RP Singh,23
2,2,AC Gilchrist,495,A Kumble,21
2,3,AB de Villiers,465,A Nehra,19
3,1,SR Tendulkar,617,PP Ojha,21
3,2,JH Kallis,572,Harbhajan Singh,17
3,3,SK Raina,505,A Kumble,17
4,1,CH Gayle,604,SL Malinga,28
4,2,V Kohli,557,MM Patel,22
4,3,SR Tendulkar,553,S Aravind,21
5,1,CH Gayle,733,M Morkel,25
5,2,G Gambhir,590,SP Narine,24
5,3,S Dhawan,569,SL Malinga,22
6,1,MEK Hussey,733,DJ Bravo,32
6,2,CH Gayle,694,JP Faulkner,28
6,3,SK Raina,548,Harbhajan Singh,24
7,1,RV Uthappa,660,MM Sharma,23
7,2,DR Smith,566,SP Narine,21
7,3,GJ Maxwell,552,B Kumar,20
8,1,DA Warner,562,DJ Bravo,26
8,2,LMP Simmons,540,SL Malinga,24
8,3,V Kohli,503,A Nehra,22
9,1,V Kohli,969,B Kumar,23
9,2,DA Warner,848,YS Chahal,21
9,3,AB de Villiers,687,SR Watson,20
Current sql:
WITH batsman_totals AS (
    SELECT
        bbb."striker" AS "player_id",
        m."season_id",
        SUM(bs."runs_scored") AS "total_runs"
    FROM
        "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
        ON bbb."match_id" = bs."match_id"
        AND bbb."over_id" = bs."over_id"
        AND bbb."ball_id" = bs."ball_id"
        AND bbb."innings_no" = bs."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
        ON bbb."match_id" = m."match_id"
    GROUP BY
        bbb."striker",
        m."season_id"
),

batsman_ranked AS (
    SELECT
        "season_id",
        "player_id",
        "total_runs",
        ROW_NUMBER() OVER (
            PARTITION BY "season_id"
            ORDER BY "total_runs" DESC, "player_id" ASC
        ) AS "rank"
    FROM
        batsman_totals
),

top_batsmen AS (
    SELECT
        b."season_id",
        b."player_id",
        b."total_runs",
        b."rank"
    FROM
        batsman_ranked b
    WHERE
        b."rank" <= 3
),

batsmen_with_names AS (
    SELECT
        b."season_id",
        b."rank" AS "position",
        p."player_name" AS "batsman_name",
        b."total_runs" AS "batsman_runs"
    FROM
        top_batsmen b
    JOIN
        "IPL"."IPL"."PLAYER" p
    ON
        b."player_id" = p."player_id"
),

bowler_totals AS (
    SELECT
        bbb."bowler" AS "player_id",
        m."season_id",
        COUNT(*) AS "total_wickets"
    FROM
        "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
        ON bbb."match_id" = wt."match_id"
        AND bbb."over_id" = wt."over_id"
        AND bbb."ball_id" = wt."ball_id"
        AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
        ON bbb."match_id" = m."match_id"
    WHERE
        wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY
        bbb."bowler",
        m."season_id"
),

bowler_ranked AS (
    SELECT
        "season_id",
        "player_id",
        "total_wickets",
        ROW_NUMBER() OVER (
            PARTITION BY "season_id"
            ORDER BY "total_wickets" DESC, "player_id" ASC
        ) AS "rank"
    FROM
        bowler_totals
),

top_bowlers AS (
    SELECT
        b."season_id",
        b."player_id",
        b."total_wickets",
        b."rank"
    FROM
        bowler_ranked b
    WHERE
        b."rank" <= 3
),

bowlers_with_names AS (
    SELECT
        b."season_id",
        b."rank" AS "position",
        p."player_name" AS "bowler_name",
        b."total_wickets" AS "bowler_wickets"
    FROM
        top_bowlers b
    JOIN
        "IPL"."IPL"."PLAYER" p
    ON
        b."player_id" = p."player_id"
)

SELECT
    batsmen_with_names."season_id",
    batsmen_with_names."position",
    batsmen_with_names."batsman_name",
    batsmen_with_names."batsman_runs",
    bowlers_with_names."bowler_name",
    bowlers_with_names."bowler_wickets"
FROM
    batsmen_with_names
JOIN
    bowlers_with_names
ON
    batsmen_with_names."season_id" = bowlers_with_names."season_id" AND
    batsmen_with_names."position" = bowlers_with_names."position"
ORDER BY
    batsmen_with_names."season_id" ASC,
    batsmen_with_names."position" ASC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-10 11:58:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:58:18 - root - INFO - ```sql
WITH batsman_totals AS (
    SELECT
        bbb."striker" AS "player_id",
        m."season_id",
        SUM(bs."runs_scored") AS "total_runs"
    FROM
        "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."BATSMAN_SCORED" AS bs
        ON bbb."match_id" = bs."match_id"
        AND bbb."over_id" = bs."over_id"
        AND bbb."ball_id" = bs."ball_id"
        AND bbb."innings_no" = bs."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
        ON bbb."match_id" = m."match_id"
    GROUP BY
        bbb."striker",
        m."season_id"
),

batsman_ranked AS (
    SELECT
        "season_id",
        "player_id",
        "total_runs",
        ROW_NUMBER() OVER (
            PARTITION BY "season_id"
            ORDER BY "total_runs" DESC NULLS LAST, "player_id" ASC
        ) AS "rank"
    FROM
        batsman_totals
),

top_batsmen AS (
    SELECT
        b."season_id",
        b."player_id",
        b."total_runs",
        b."rank"
    FROM
        batsman_ranked b
    WHERE
        b."rank" <= 3
),

batsmen_with_names AS (
    SELECT
        b."season_id",
        b."rank" AS "position",
        p."player_name" AS "batsman_name",
        b."total_runs" AS "batsman_runs"
    FROM
        top_batsmen b
    JOIN
        "IPL"."IPL"."PLAYER" p
        ON b."player_id" = p."player_id"
),

bowler_totals AS (
    SELECT
        bbb."bowler" AS "player_id",
        m."season_id",
        COUNT(*) AS "total_wickets"
    FROM
        "IPL"."IPL"."BALL_BY_BALL" AS bbb
    JOIN "IPL"."IPL"."WICKET_TAKEN" AS wt
        ON bbb."match_id" = wt."match_id"
        AND bbb."over_id" = wt."over_id"
        AND bbb."ball_id" = wt."ball_id"
        AND bbb."innings_no" = wt."innings_no"
    JOIN "IPL"."IPL"."MATCH" AS m
        ON bbb."match_id" = m."match_id"
    WHERE
        wt."kind_out" NOT IN ('run out', 'hit wicket', 'retired hurt')
    GROUP BY
        bbb."bowler",
        m."season_id"
),

bowler_ranked AS (
    SELECT
        "season_id",
        "player_id",
        "total_wickets",
        ROW_NUMBER() OVER (
            PARTITION BY "season_id"
            ORDER BY "total_wickets" DESC NULLS LAST, "player_id" ASC
        ) AS "rank"
    FROM
        bowler_totals
),

top_bowlers AS (
    SELECT
        b."season_id",
        b."player_id",
        b."total_wickets",
        b."rank"
    FROM
        bowler_ranked b
    WHERE
        b."rank" <= 3
),

bowlers_with_names AS (
    SELECT
        b."season_id",
        b."rank" AS "position",
        p."player_name" AS "bowler_name",
        b."total_wickets" AS "bowler_wickets"
    FROM
        top_bowlers b
    JOIN
        "IPL"."IPL"."PLAYER" p
        ON b."player_id" = p."player_id"
)

SELECT
    batsmen_with_names."season_id",
    batsmen_with_names."position",
    batsmen_with_names."batsman_name",
    batsmen_with_names."batsman_runs",
    bowlers_with_names."bowler_name",
    bowlers_with_names."bowler_wickets"
FROM
    batsmen_with_names
JOIN
    bowlers_with_names
ON
    batsmen_with_names."season_id" = bowlers_with_names."season_id" AND
    batsmen_with_names."position" = bowlers_with_names."position"
ORDER BY
    batsmen_with_names."season_id" ASC,
    batsmen_with_names."position" ASC;
```
2025-02-10 11:58:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:58:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:58:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:58:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 27
2025-02-10 11:58:20 - snowflake.connector.connection - INFO - closed
2025-02-10 11:58:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:58:20 - root - INFO - itercount: 2
2025-02-10 11:58:20 - root - INFO - 0
2025-02-10 11:58:20 - root - INFO - Total iteration counts: 2
