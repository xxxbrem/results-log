2025-02-10 16:37:52 - openai._base_client - INFO - Retrying request to /chat/completions in 0.484359 seconds
2025-02-10 16:38:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:38:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:38:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:38:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:38:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-02-10 16:38:53 - snowflake.connector.connection - INFO - closed
2025-02-10 16:38:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:38:53 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
Results:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA

2025-02-10 16:38:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:38:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:38:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:38:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:38:54 - snowflake.connector.connection - INFO - closed
2025-02-10 16:38:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:38:55 - root - INFO - SQL:
SELECT COUNT(*) AS "first_open_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907';
Results:
first_open_count
64

2025-02-10 16:38:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:38:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:38:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:38:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:38:56 - snowflake.connector.connection - INFO - closed
2025-02-10 16:38:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:38:56 - root - INFO - SQL:
SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180908' AND '20180914'
   LIMIT 100;
Results:
user_pseudo_id
879503A3ED5F2DCB6592E99C42E1BDFE

2025-02-10 16:38:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:38:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:38:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:38:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:38:57 - snowflake.connector.connection - INFO - closed
2025-02-10 16:38:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:38:57 - root - INFO - SQL:
SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180915' AND '20180921'
   LIMIT 100;
Results:
user_pseudo_id
61BB31EC7781341B1D7B8D8A85688DA3

2025-02-10 16:38:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:38:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:38:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:38:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-10 16:38:59 - snowflake.connector.connection - INFO - closed
2025-02-10 16:38:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:38:59 - root - INFO - SQL:
SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180922' AND '20180928'
   LIMIT 100;
Results:
user_pseudo_id
3E336ECE1F533064D663A350DAB00790
879503A3ED5F2DCB6592E99C42E1BDFE

2025-02-10 16:38:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:38:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:38:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:39:00 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:00 - root - INFO - SQL:
SELECT COUNT(DISTINCT "user_pseudo_id") AS "total_new_users"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907';
Results:
total_new_users
64

2025-02-10 16:39:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:39:01 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:02 - root - INFO - SQL:
SELECT e2."user_pseudo_id", COUNT(*) AS "event_count_week1"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
   WHERE e2."user_pseudo_id" IN (
     SELECT DISTINCT "user_pseudo_id"
     FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
     WHERE "event_name" = 'first_open'
       AND "event_date" BETWEEN '20180901' AND '20180907'
   )
     AND e2."event_date" BETWEEN '20180908' AND '20180914'
   GROUP BY e2."user_pseudo_id"
   LIMIT 100;
Results:
user_pseudo_id,event_count_week1
879503A3ED5F2DCB6592E99C42E1BDFE,3

2025-02-10 16:39:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-02-10 16:39:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:03 - root - INFO - SQL:
SELECT t."user_pseudo_id", t."geo":"country"::STRING AS "country"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t
   WHERE t."event_name" = 'first_open'
     AND t."event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
Results:
user_pseudo_id,country
4EEE67C2E335213F6815144829801E0F,India
27C0BAADCE9520F17249A8B85F6477DA,India
9FD6E2CD74490F5DA5F52D249CBB750A,Vietnam
D963E509346C0E5358ECFE56AF3BB2ED,India
4A2A03B50BDA6AC1687703BD39A91E3E,United States
0E9150E8985138A744B88D56F015EDA7,Canada
FCD8DDE7775A7211BCA9F42768C3BB8B,United States
6D6EB70E837A5007BE550C44FF276440,Egypt
96333A5A97DA9F4AEBC7A70483AF6C5C,India
F4CB0B30E0A170AEB6A94EF1156738C8,United States
EA89F979E0D4C374DBC95268982D18DE,United States
1D5A0DC978A69FF28EC9D153F32EA871,India
34CAF47105A2D9D0AC7464BB3AF8DB2A,United States
2C15FFDEDDA69390B7A8EB5808FB7ED6,Brazil
B9A395E297106E5D6F72747F84AC7AE5,Israel
6C333017CEA199B69BB27611BA5DE7B5,United States
531E7B35DE9A21A1942F057C98B4E74C,India
C09F65F2853D03DE23CFD90F97429735,India
14FC1A25D55E89AC7ECD600CD3A08C13,India
7331597E5500811253BA85AF851A193C,United States
5DA9B900E7C9F71714FB1AE9DA631C83,United States
97D9D96077AD3E8859BF5C54C873E59D,Colombia
CEBA063FD7BF190D727CC948185CCEC8,India
61BB31EC7781341B1D7B8D8A85688DA3,United States
5A66BC427F25EFFDFEDED4A07D8F9F91,India
37EFBD2BA398148336F96B4347392A8D,Canada
E0F1ED4167D0C0B2D6DCBA85CB020F52,India
177C0BEFFC69408F88D3377632F1BB60,Brazil
5F5D7A3F5575008A81BB77CFE70C4285,United States
37034A23CAFF85394E2E349C381788A6,India
387B532B7AF7A362DBF783E34C05BF54,United States
1E882F0B9818614D6E47620DD31229F1,India
9F8885F0261FE69A58C8B6AE9176E437,United States
ACA2E31E67D50F779611D7FDB674C370,Japan
551B893D34A2A59971B8FF185C1CD0C8,India
B82793CB1270A48BB2697C51AEED3E4A,India
D771048ADB1B9CACADFE001E6F9BA799,United States
C7DD86F06FD4AA8A0967E27E20750FCD,United States
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,India
D1C57A2E87382A82A40B1816E85277EA,India
D8B77A575B5308D161F95ACF515F9772,India
7AB9D5F7D122A38CA8769C9C93F3A12F,India
D6803CFD38D435F0364EB47684F7CCF6,Peru
3E336ECE1F533064D663A350DAB00790,South Africa
CCE5E30054C510608589FA6240615B0A,United States
3B049329E3090DA7A4339C4A46EF0763,Peru
B9D800D33FDCF7AF2157CB66910A0797,India
8DEB6CB6C3E85D0032D8557C73ADD49F,India
A6E8B0AC5E066F7670116136442F728F,Pakistan
A305B55D5049F38F5139DA95B3DCE247,Saudi Arabia
9E25C5FED0F3F775FBB2A5C76DD0511C,India
C945C989CF380E22E1B1E4B28E26801A,India
D31F0611DE6B94A5F001584286883AB7,United States
ADB20527463A407E77162C54D30435F1,Trinidad & Tobago
D2007D608FBB90EF5363BF5C8E08117A,Mexico
DAD134C77F7E09BC552E290534CB90E8,India
0CBC523581751D977C4121B95429E8A9,United States
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,United States
B1885B70DEFAC440D7DCBB520854A651,United States
66788E34B6E292DE03B1B54E797CADBF,India
879503A3ED5F2DCB6592E99C42E1BDFE,India
2B6D9C77F287F5C021EC7297203D412B,Bahamas
A5302213F1605BE400E8AA34992B18A8,India
2C45FDF91F91AE8A3A9E6F119E8BED13,India

2025-02-10 16:39:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-10 16:39:04 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:05 - root - INFO - SQL:
SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
Results:
platform
ANDROID
IOS

2025-02-10 16:39:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-02-10 16:39:06 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:06 - root - INFO - SQL:
SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    WHERE "event_name" = 'first_open'
      AND "event_date" BETWEEN '20180901' AND '20180907'
    GROUP BY "platform"
    LIMIT 100;
Results:
platform,user_count
ANDROID,55
IOS,9

2025-02-10 16:39:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 16:39:07 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:08 - root - INFO - SQL:
SELECT t."user_pseudo_id", f.value::VARIANT
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
      LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'first_open'
      AND t."event_date" BETWEEN '20180901' AND '20180907'
    LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,F.VALUE::VARIANT
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 4668163508051620607
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
6D6EB70E837A5007BE550C44FF276440,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
6D6EB70E837A5007BE550C44FF276440,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
6D

2025-02-10 16:39:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 63
2025-02-10 16:39:09 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:09 - root - INFO - SQL:
SELECT e1."user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN (
      SELECT DISTINCT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
      WHERE "event_date" BETWEEN '20180908' AND '20180930'
    ) e2 ON e1."user_pseudo_id" = e2."user_pseudo_id"
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907'
      AND e2."user_pseudo_id" IS NULL
    LIMIT 100;
Results:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
9FD6E2CD74490F5DA5F52D249CBB750A
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
1D5A0DC978A69FF28EC9D153F32EA871
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
B9A395E297106E5D6F72747F84AC7AE5
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
C09F65F2853D03DE23CFD90F97429735
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
5DA9B900E7C9F71714FB1AE9DA631C83
97D9D96077AD3E8859BF5C54C873E59D
CEBA063FD7BF190D727CC948185CCEC8
61BB31EC7781341B1D7B8D8A85688DA3
5A66BC427F25EFFDFEDED4A07D8F9F91
37EFBD2BA398148336F96B4347392A8D
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
37034A23CAFF85394E2E349C381788A6
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
ACA2E31E67D50F779611D7FDB674C370
551B893D34A2A59971B8FF185C1CD0C8
B82793CB1270A48BB2697C51AEED3E4A
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
D1C57A2E87382A82A40B1816E85277EA
D8B77A575B5308D161F95ACF515F9772
7AB9D5F7D122A38CA8769C9C93F3A12F
D6803CFD38D435F0364EB47684F7CCF6
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
B9D800D33FDCF7AF2157CB66910A0797
8DEB6CB6C3E85D0032D8557C73ADD49F
A6E8B0AC5E066F7670116136442F728F
A305B55D5049F38F5139DA95B3DCE247
9E25C5FED0F3F775FBB2A5C76DD0511C
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
ADB20527463A407E77162C54D30435F1
D2007D608FBB90EF5363BF5C8E08117A
DAD134C77F7E09BC552E290534CB90E8
0CBC523581751D977C4121B95429E8A9
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
B1885B70DEFAC440D7DCBB520854A651
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
A5302213F1605BE400E8AA34992B18A8
2C45FDF91F91AE8A3A9E6F119E8BED13

2025-02-10 16:39:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:39:10 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:10 - root - INFO - SQL:
SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week1_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180908' AND '20180914'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
Results:
week1_retention_rate
1.562500

2025-02-10 16:39:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:39:12 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:12 - root - INFO - SQL:
SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week2_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180915' AND '20180921'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
Results:
week2_retention_rate
1.562500

2025-02-10 16:39:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 16:39:13 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:14 - root - INFO - SQL:
SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week3_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180922' AND '20180928'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
Results:
week3_retention_rate
3.125000

2025-02-10 16:39:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:39:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:39:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:39:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-02-10 16:39:15 - snowflake.connector.connection - INFO - closed
2025-02-10 16:39:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:39:15 - root - INFO - SQL:
SELECT t."user_pseudo_id", f.value:"value"::STRING AS "property_value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
      LATERAL FLATTEN(input => t."user_properties") f
    WHERE t."event_name" = 'first_open'
      AND t."event_date" BETWEEN '20180901' AND '20180907'
    LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,property_value
4EEE67C2E335213F6815144829801E0F,"{""int_value"":1535855580096000,""set_timestamp_micros"":1535855580096000}"
27C0BAADCE9520F17249A8B85F6477DA,"{""int_value"":1535825903840000,""set_timestamp_micros"":1535825903840000}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{""int_value"":1535800510069000,""set_timestamp_micros"":1535800510069000}"
D963E509346C0E5358ECFE56AF3BB2ED,"{""int_value"":1535796824597000,""set_timestamp_micros"":1535796824597000}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{""int_value"":1535855219914000,""set_timestamp_micros"":1535855219914000}"
0E9150E8985138A744B88D56F015EDA7,"{""int_value"":1535836565290000,""set_timestamp_micros"":1535836565290000}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{""int_value"":1535810901162000,""set_timestamp_micros"":1535810901162000}"
6D6EB70E837A5007BE550C44FF276440,"{""int_value"":1535800915359000,""set_timestamp_micros"":1535800915359000}"
96333A5A97DA9F4AEBC7A70483AF6C5C,"{""int_value"":1535861885300000,""set_timestamp_micros"":1535861885300000}"
F4CB0B30E0A170AEB6A94EF1156738C8,"{""int_value"":1535843461289000,""set_timestamp_micros"":1535843461289000}"
EA89F979E0D4C374DBC95268982D18DE,"{""int_value"":1535827029854000,""set_timestamp_micros"":1535827029854000}"
1D5A0DC978A69FF28EC9D153F32EA871,"{""int_value"":1535807127198000,""set_timestamp_micros"":1535807127198000}"
34CAF47105A2D9D0AC7464BB3AF8DB2A,"{""int_value"":1535852034675000,""set_timestamp_micros"":1535852034675000}"
2C15FFDEDDA69390B7A8EB5808FB7ED6,"{""int_value"":1535851024659000,""set_timestamp_micros"":1535851024659000}"
B9A395E297106E5D6F72747F84AC7AE5,"{""int_value"":1535824322547000,""set_timestamp_micros"":1535824322547000}"
6C333017CEA199B69BB27611BA5DE7B5,"{""int_value"":1535844742760000,""set_timestamp_micros"":1535844742760000}"
531E7B35DE9A21A1942F057C98B4E74C,"{""int_value"":1535801979560000,""set_timestamp_micros"":1535801979560000}"
C09F65F2853D03DE23CFD90F97429735,"{""int_value"":1535820568861000,""set_timestamp_micros"":1535820568861000}"
14FC1A25D55E89AC7ECD600CD3A08C13,"{""int_value"":1535864378333000,""set_timestamp_micros"":1535864378333000}"
7331597E5500811253BA85AF851A193C,"{""int_value"":1535867137394000,""set_timestamp_micros"":1535867137394000}"
5DA9B900E7C9F71714FB1AE9DA631C83,"{""int_value"":1535823083751000,""set_timestamp_micros"":1535823083751000}"
97D9D96077AD3E8859BF5C54C873E59D,"{""int_value"":1535833844071000,""set_timestamp_micros"":1535833844071000}"
CEBA063FD7BF190D727CC948185CCEC8,"{""int_value"":1535786768380000,""set_timestamp_micros"":1535786768380000}"
61BB31EC7781341B1D7B8D8A85688DA3,"{""int_value"":1535834527505000,""set_timestamp_micros"":1535834527505000}"
5A66BC427F25EFFDFEDED4A07D8F9F91,"{""int_value"":1535857954726000,""set_timestamp_micros"":1535857954726000}"
37EFBD2BA398148336F96B4347392A8D,"{""int_value"":1535793454587000,""set_timestamp_micros"":1535793454587000}"
E0F1ED4167D0C0B2D6DCBA85CB020F52,"{""int_value"":1535813813915000,""set_timestamp_micros"":1535813813915000}"
177C0BEFFC69408F88D3377632F1BB60,"{""int_value"":1535851408336000,""set_timestamp_micros"":1535851408336000}"
5F5D7A3F5575008A81BB77CFE70C4285,"{""int_value"":1502934327056000,""set_timestamp_micros"":1535851178598000}"
37034A23CAFF85394E2E349C381788A6,"{""int_value"":1535814119760000,""set_timestamp_micros"":1535814119760000}"
387B532B7AF7A362DBF783E34C05BF54,"{""int_value"":1535818383344000,""set_timestamp_micros"":1535818383344000}"
1E882F0B9818614D6E47620DD31229F1,"{""int_value"":1535865216880000,""set_timestamp_micros"":1535865216880000}"
9F8885F0261FE69A58C8B6AE9176E437,"{""int_value"":1535839822373000,""set_timestamp_micros"":1535839822373000}"
ACA2E31E67D50F779611D7FDB674C370,"{""int_value"":1535851880421000,""set_timestamp_micros"":1535851880421000}"
551B893D34A2A59971B8FF185C1CD0C8,"{""int_value"":1535809874149000,""set_timestamp_micros"":1535809874149000}"
B82793CB1270A48BB2697C51AEED3E4A,"{""int_value"":1535799569882000,""set_timestamp_micros"":1535799569882000}"
D771048ADB1B9CACADFE001E6F9BA799,"{""int_value"":1535867549146000,""set_timestamp_micros"":1535867549146000}"
C7DD86F06FD4AA8A0967E27E20750FCD,"{""int_value"":1535798021434000,""set_timestamp_micros"":1535798021434000}"
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,"{""int_value"":1535846621178000,""set_timestamp_micros"":1535846621178000}"
D1C57A2E87382A82A40B1816E85277EA,"{""int_value"":1535821909295000,""set_timestamp_micros"":1535821909295000}"
D8B77A575B5308D161F95ACF515F9772,"{""int_value"":1535864536964000,""set_timestamp_micros"":1535864536964000}"
7AB9D5F7D122A38CA8769C9C93F3A12F,"{""int_value"":1535860647684000,""set_timestamp_micros"":1535860647684000}"
D6803CFD38D435F0364EB47684F7CCF6,"{""int_value"":1535791708036000,""set_timestamp_micros"":1535791708036000}"
3E336ECE1F533064D663A350DAB00790,"{""int_value"":1535790604676000,""set_timestamp_micros"":1535790604676000}"
CCE5E30054C510608589FA6240615B0A,"{""int_value"":1535844174073000,""set_timestamp_micros"":1535844174073000}"
3B049329E3090DA7A433

2025-02-10 16:39:15 - root - INFO - itercount: 0
2025-02-10 16:39:15 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

To calculate the weekly customer retention rate, we need to identify the relevant tables and columns in the database.

**Tables:**

- **Events Tables:** The data is stored in daily tables named `EVENTS_YYYYMMDD`. For September 2018, we need the tables:
  - From `"EVENTS_20180901"` to `"EVENTS_20180930"`.

**Columns and Potential Usage:**

- **"event_name":** Identifies the type of event (e.g., `"first_open"` for app installs).
  - **Usage:** Filter events to find users who first opened the app.
  
- **"event_date":** The date of the event in 'YYYYMMDD' format.
  - **Usage:** Filter events within specific date ranges (e.g., first week of September).

- **"event_timestamp":** The timestamp of the event.
  - **Usage:** Determine the exact time of events and calculate retention periods.

- **"user_pseudo_id":** Unique identifier for each user.
  - **Usage:** Track user activity across different events and time periods.

- **"platform":** The platform of the app (e.g., iOS, Android).
  - **Usage:** Analyze retention rates by platform.

- **"event_params":** Contains additional event details in VARIANT (JSON) format.
  - **Usage:** Extract specific parameters related to events if needed.

**Conditions That May Be Used:**

- **Event Filtering:**
  - **"event_name" = 'first_open'** to identify new users.
  
- **Date Filtering:**
  - **"event_date" BETWEEN '20180901' AND '20180907'** for users who first opened the app in the first week of September 2018.
  - Weeks for retention calculation:
    - **Week 1:** '20180908' - '20180914'
    - **Week 2:** '20180915' - '20180921'
    - **Week 3:** '20180922' - '20180928'

---

**SQL Queries:**

1. **List New Users Who Opened the App for the First Time Between September 1 and September 7, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
   ```

2. **Count of 'first_open' Events in the First Week of September 2018:**

   ```sql
   SELECT COUNT(*) AS "first_open_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907';
   ```

3. **Identify Users Who Returned in Week 1 After First Use:**

   ```sql
   SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180908' AND '20180914'
   LIMIT 100;
   ```

4. **Identify Users Who Returned in Week 2 After First Use:**

   ```sql
   SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180915' AND '20180921'
   LIMIT 100;
   ```

5. **Identify Users Who Returned in Week 3 After First Use:**

   ```sql
   SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180922' AND '20180928'
   LIMIT 100;
   ```

6. **Calculate Total Number of New Users in First Week of September 2018:**

   ```sql
   SELECT COUNT(DISTINCT "user_pseudo_id") AS "total_new_users"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907';
   ```

7. **Get Event Counts for Each User in Week 1 After First Use:**

   ```sql
   SELECT e2."user_pseudo_id", COUNT(*) AS "event_count_week1"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
   WHERE e2."user_pseudo_id" IN (
     SELECT DISTINCT "user_pseudo_id"
     FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
     WHERE "event_name" = 'first_open'
       AND "event_date" BETWEEN '20180901' AND '20180907'
   )
     AND e2."event_date" BETWEEN '20180908' AND '20180914'
   GROUP BY e2."user_pseudo_id"
   LIMIT 100;
   ```

8. **Extract 'country' Information from 'geo' Column for New Users:**

   ```sql
   SELECT t."user_pseudo_id", t."geo":"country"::STRING AS "country"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t
   WHERE t."event_name" = 'first_open'
     AND t."event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
   ```

9. **List Platforms Used by New Users in First Week:**

   ```sql
   SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
   ```

10. **Count of New Users by Platform in First Week:**

    ```sql
    SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    WHERE "event_name" = 'first_open'
      AND "event_date" BETWEEN '20180901' AND '20180907'
    GROUP BY "platform"
    LIMIT 100;
    ```

11. **Retrieve 'event_params' for 'first_open' Events:**

    ```sql
    SELECT t."user_pseudo_id", f.value::VARIANT
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
      LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'first_open'
      AND t."event_date" BETWEEN '20180901' AND '20180907'
    LIMIT 100;
    ```

12. **Find Users Who Did Not Return After First Week (Churned Users):**

    ```sql
    SELECT e1."user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN (
      SELECT DISTINCT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
      WHERE "event_date" BETWEEN '20180908' AND '20180930'
    ) e2 ON e1."user_pseudo_id" = e2."user_pseudo_id"
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907'
      AND e2."user_pseudo_id" IS NULL
    LIMIT 100;
    ```

13. **Calculate Retention Rate for Week 1:**

    ```sql
    SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week1_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180908' AND '20180914'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
    ```

14. **Calculate Retention Rates for Weeks 2 and 3:**

    ```sql
    SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week2_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180915' AND '20180921'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
    ```

    ```sql
    SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week3_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180922' AND '20180928'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
    ```

15. **Analyze User Properties for New Users:**

    ```sql
    SELECT t."user_pseudo_id", f.value:"value"::STRING AS "property_value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
      LATERAL FLATTEN(input => t."user_properties") f
    WHERE t."event_name" = 'first_open'
      AND t."event_date" BETWEEN '20180901' AND '20180907'
    LIMIT 100;
    ```

These queries help in exploring the data required to calculate the weekly customer retention rates for new users who first opened the app in the first week of September 2018 (Shanghai timezone). By analyzing user activity over subsequent weeks, you can compute the retention rates for weeks 1, 2, and 3.

---

**Explanation:**

- **Queries 1-2:** Identify new users based on the `'first_open'` event within the specified date range.
- **Queries 3-5:** Determine which of these users returned in weeks 1, 2, and 3 after their initial use.
- **Queries 6-7:** Calculate the total number of new users and their engagement in the following weeks.
- **Queries 8-9:** Analyze additional user attributes like country and platform.
- **Query 10-11:** Extract detailed information from nested JSON columns using `LATERAL FLATTEN`.
- **Queries 12-14:** Calculate retention rates by comparing the number of users who returned to the total number of new users.
- **Query 15:** Investigate user properties to understand characteristics that may influence retention.

By executing these queries, you can gather all the necessary data to compute and analyze the weekly retention rates, ultimately displaying them in a column format as per your initial task.Query:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
Answer:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA
Query:
SELECT COUNT(*) AS "first_open_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907';
Answer:
first_open_count
64
Query:
SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180908' AND '20180914'
   LIMIT 100;
Answer:
user_pseudo_id
879503A3ED5F2DCB6592E99C42E1BDFE
Query:
SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180915' AND '20180921'
   LIMIT 100;
Answer:
user_pseudo_id
61BB31EC7781341B1D7B8D8A85688DA3
Query:
SELECT DISTINCT e1."user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
   JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" e2
     ON e1."user_pseudo_id" = e2."user_pseudo_id"
   WHERE e1."event_name" = 'first_open'
     AND e1."event_date" BETWEEN '20180901' AND '20180907'
     AND e2."event_date" BETWEEN '20180922' AND '20180928'
   LIMIT 100;
Answer:
user_pseudo_id
3E336ECE1F533064D663A350DAB00790
879503A3ED5F2DCB6592E99C42E1BDFE
Query:
SELECT COUNT(DISTINCT "user_pseudo_id") AS "total_new_users"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907';
Answer:
total_new_users
64
Query:
SELECT e2."user_pseudo_id", COUNT(*) AS "event_count_week1"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
   WHERE e2."user_pseudo_id" IN (
     SELECT DISTINCT "user_pseudo_id"
     FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
     WHERE "event_name" = 'first_open'
       AND "event_date" BETWEEN '20180901' AND '20180907'
   )
     AND e2."event_date" BETWEEN '20180908' AND '20180914'
   GROUP BY e2."user_pseudo_id"
   LIMIT 100;
Answer:
user_pseudo_id,event_count_week1
879503A3ED5F2DCB6592E99C42E1BDFE,3
Query:
SELECT t."user_pseudo_id", t."geo":"country"::STRING AS "country"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t
   WHERE t."event_name" = 'first_open'
     AND t."event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
Answer:
user_pseudo_id,country
4EEE67C2E335213F6815144829801E0F,India
27C0BAADCE9520F17249A8B85F6477DA,India
9FD6E2CD74490F5DA5F52D249CBB750A,Vietnam
D963E509346C0E5358ECFE56AF3BB2ED,India
4A2A03B50BDA6AC1687703BD39A91E3E,United States
0E9150E8985138A744B88D56F015EDA7,Canada
FCD8DDE7775A7211BCA9F42768C3BB8B,United States
6D6EB70E837A5007BE550C44FF276440,Egypt
96333A5A97DA9F4AEBC7A70483AF6C5C,India
F4CB0B30E0A170AEB6A94EF1156738C8,United States
EA89F979E0D4C374DBC95268982D18DE,United States
1D5A0DC978A69FF28EC9D153F32EA871,India
34CAF47105A2D9D0AC7464BB3AF8DB2A,United States
2C15FFDEDDA69390B7A8EB5808FB7ED6,Brazil
B9A395E297106E5D6F72747F84AC7AE5,Israel
6C333017CEA199B69BB27611BA5DE7B5,United States
531E7B35DE9A21A1942F057C98B4E74C,India
C09F65F2853D03DE23CFD90F97429735,India
14FC1A25D55E89AC7ECD600CD3A08C13,India
7331597E5500811253BA85AF851A193C,United States
5DA9B900E7C9F71714FB1AE9DA631C83,United States
97D9D96077AD3E8859BF5C54C873E59D,Colombia
CEBA063FD7BF190D727CC948185CCEC8,India
61BB31EC7781341B1D7B8D8A85688DA3,United States
5A66BC427F25EFFDFEDED4A07D8F9F91,India
37EFBD2BA398148336F96B4347392A8D,Canada
E0F1ED4167D0C0B2D6DCBA85CB020F52,India
177C0BEFFC69408F88D3377632F1BB60,Brazil
5F5D7A3F5575008A81BB77CFE70C4285,United States
37034A23CAFF85394E2E349C381788A6,India
387B532B7AF7A362DBF783E34C05BF54,United States
1E882F0B9818614D6E47620DD31229F1,India
9F8885F0261FE69A58C8B6AE9176E437,United States
ACA2E31E67D50F779611D7FDB674C370,Japan
551B893D34A2A59971B8FF185C1CD0C8,India
B82793CB1270A48BB2697C51AEED3E4A,India
D771048ADB1B9CACADFE001E6F9BA799,United States
C7DD86F06FD4AA8A0967E27E20750FCD,United States
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,India
D1C57A2E87382A82A40B1816E85277EA,India
D8B77A575B5308D161F95ACF515F9772,India
7AB9D5F7D122A38CA8769C9C93F3A12F,India
D6803CFD38D435F0364EB47684F7CCF6,Peru
3E336ECE1F533064D663A350DAB00790,South Africa
CCE5E30054C510608589FA6240615B0A,United States
3B049329E3090DA7A4339C4A46EF0763,Peru
B9D800D33FDCF7AF2157CB66910A0797,India
8DEB6CB6C3E85D0032D8557C73ADD49F,India
A6E8B0AC5E066F7670116136442F728F,Pakistan
A305B55D5049F38F5139DA95B3DCE247,Saudi Arabia
9E25C5FED0F3F775FBB2A5C76DD0511C,India
C945C989CF380E22E1B1E4B28E26801A,India
D31F0611DE6B94A5F001584286883AB7,United States
ADB20527463A407E77162C54D30435F1,Trinidad & Tobago
D2007D608FBB90EF5363BF5C8E08117A,Mexico
DAD134C77F7E09BC552E290534CB90E8,India
0CBC523581751D977C4121B95429E8A9,United States
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,United States
B1885B70DEFAC440D7DCBB520854A651,United States
66788E34B6E292DE03B1B54E797CADBF,India
879503A3ED5F2DCB6592E99C42E1BDFE,India
2B6D9C77F287F5C021EC7297203D412B,Bahamas
A5302213F1605BE400E8AA34992B18A8,India
2C45FDF91F91AE8A3A9E6F119E8BED13,India
Query:
SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'first_open'
     AND "event_date" BETWEEN '20180901' AND '20180907'
   LIMIT 100;
Answer:
platform
ANDROID
IOS
Query:
SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
    WHERE "event_name" = 'first_open'
      AND "event_date" BETWEEN '20180901' AND '20180907'
    GROUP BY "platform"
    LIMIT 100;
Answer:
platform,user_count
ANDROID,55
IOS,9
Query:
SELECT t."user_pseudo_id", f.value::VARIANT
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
      LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" = 'first_open'
      AND t."event_date" BETWEEN '20180901' AND '20180907'
    LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,F.VALUE::VARIANT
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
4EEE67C2E335213F6815144829801E0F,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
27C0BAADCE9520F17249A8B85F6477DA,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
D963E509346C0E5358ECFE56AF3BB2ED,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""system_app"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""system_app_update"",
  ""value"": {
    ""int_value"": 0
  }
}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 4668163508051620607
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
0E9150E8985138A744B88D56F015EDA7,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""update_with_analytics"",
  ""value"": {
    ""int_value"": 0
  }
}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
6D6EB70E837A5007BE550C44FF276440,"{
  ""key"": ""previous_first_open_count"",
  ""value"": {
    ""int_value"": 0
  }
}"
6D6EB70E837A5007BE550C44FF276440,"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
6D
Query:
SELECT e1."user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN (
      SELECT DISTINCT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
      WHERE "event_date" BETWEEN '20180908' AND '20180930'
    ) e2 ON e1."user_pseudo_id" = e2."user_pseudo_id"
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907'
      AND e2."user_pseudo_id" IS NULL
    LIMIT 100;
Answer:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
9FD6E2CD74490F5DA5F52D249CBB750A
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
1D5A0DC978A69FF28EC9D153F32EA871
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
B9A395E297106E5D6F72747F84AC7AE5
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
C09F65F2853D03DE23CFD90F97429735
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
5DA9B900E7C9F71714FB1AE9DA631C83
97D9D96077AD3E8859BF5C54C873E59D
CEBA063FD7BF190D727CC948185CCEC8
61BB31EC7781341B1D7B8D8A85688DA3
5A66BC427F25EFFDFEDED4A07D8F9F91
37EFBD2BA398148336F96B4347392A8D
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
37034A23CAFF85394E2E349C381788A6
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
ACA2E31E67D50F779611D7FDB674C370
551B893D34A2A59971B8FF185C1CD0C8
B82793CB1270A48BB2697C51AEED3E4A
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
D1C57A2E87382A82A40B1816E85277EA
D8B77A575B5308D161F95ACF515F9772
7AB9D5F7D122A38CA8769C9C93F3A12F
D6803CFD38D435F0364EB47684F7CCF6
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
B9D800D33FDCF7AF2157CB66910A0797
8DEB6CB6C3E85D0032D8557C73ADD49F
A6E8B0AC5E066F7670116136442F728F
A305B55D5049F38F5139DA95B3DCE247
9E25C5FED0F3F775FBB2A5C76DD0511C
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
ADB20527463A407E77162C54D30435F1
D2007D608FBB90EF5363BF5C8E08117A
DAD134C77F7E09BC552E290534CB90E8
0CBC523581751D977C4121B95429E8A9
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
B1885B70DEFAC440D7DCBB520854A651
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
A5302213F1605BE400E8AA34992B18A8
2C45FDF91F91AE8A3A9E6F119E8BED13
Query:
SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week1_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180908' AND '20180914'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
Answer:
week1_retention_rate
1.562500
Query:
SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week2_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180915' AND '20180921'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
Answer:
week2_retention_rate
1.562500
Query:
SELECT
      (COUNT(DISTINCT e2."user_pseudo_id") / COUNT(DISTINCT e1."user_pseudo_id")) * 100 AS "week3_retention_rate"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" e1
    LEFT JOIN "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922" e2
      ON e1."user_pseudo_id" = e2."user_pseudo_id"
      AND e2."event_date" BETWEEN '20180922' AND '20180928'
    WHERE e1."event_name" = 'first_open'
      AND e1."event_date" BETWEEN '20180901' AND '20180907';
Answer:
week3_retention_rate
3.125000
Query:
SELECT t."user_pseudo_id", f.value:"value"::STRING AS "property_value"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
      LATERAL FLATTEN(input => t."user_properties") f
    WHERE t."event_name" = 'first_open'
      AND t."event_date" BETWEEN '20180901' AND '20180907'
    LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,property_value
4EEE67C2E335213F6815144829801E0F,"{""int_value"":1535855580096000,""set_timestamp_micros"":1535855580096000}"
27C0BAADCE9520F17249A8B85F6477DA,"{""int_value"":1535825903840000,""set_timestamp_micros"":1535825903840000}"
9FD6E2CD74490F5DA5F52D249CBB750A,"{""int_value"":1535800510069000,""set_timestamp_micros"":1535800510069000}"
D963E509346C0E5358ECFE56AF3BB2ED,"{""int_value"":1535796824597000,""set_timestamp_micros"":1535796824597000}"
4A2A03B50BDA6AC1687703BD39A91E3E,"{""int_value"":1535855219914000,""set_timestamp_micros"":1535855219914000}"
0E9150E8985138A744B88D56F015EDA7,"{""int_value"":1535836565290000,""set_timestamp_micros"":1535836565290000}"
FCD8DDE7775A7211BCA9F42768C3BB8B,"{""int_value"":1535810901162000,""set_timestamp_micros"":1535810901162000}"
6D6EB70E837A5007BE550C44FF276440,"{""int_value"":1535800915359000,""set_timestamp_micros"":1535800915359000}"
96333A5A97DA9F4AEBC7A70483AF6C5C,"{""int_value"":1535861885300000,""set_timestamp_micros"":1535861885300000}"
F4CB0B30E0A170AEB6A94EF1156738C8,"{""int_value"":1535843461289000,""set_timestamp_micros"":1535843461289000}"
EA89F979E0D4C374DBC95268982D18DE,"{""int_value"":1535827029854000,""set_timestamp_micros"":1535827029854000}"
1D5A0DC978A69FF28EC9D153F32EA871,"{""int_value"":1535807127198000,""set_timestamp_micros"":1535807127198000}"
34CAF47105A2D9D0AC7464BB3AF8DB2A,"{""int_value"":1535852034675000,""set_timestamp_micros"":1535852034675000}"
2C15FFDEDDA69390B7A8EB5808FB7ED6,"{""int_value"":1535851024659000,""set_timestamp_micros"":1535851024659000}"
B9A395E297106E5D6F72747F84AC7AE5,"{""int_value"":1535824322547000,""set_timestamp_micros"":1535824322547000}"
6C333017CEA199B69BB27611BA5DE7B5,"{""int_value"":1535844742760000,""set_timestamp_micros"":1535844742760000}"
531E7B35DE9A21A1942F057C98B4E74C,"{""int_value"":1535801979560000,""set_timestamp_micros"":1535801979560000}"
C09F65F2853D03DE23CFD90F97429735,"{""int_value"":1535820568861000,""set_timestamp_micros"":1535820568861000}"
14FC1A25D55E89AC7ECD600CD3A08C13,"{""int_value"":1535864378333000,""set_timestamp_micros"":1535864378333000}"
7331597E5500811253BA85AF851A193C,"{""int_value"":1535867137394000,""set_timestamp_micros"":1535867137394000}"
5DA9B900E7C9F71714FB1AE9DA631C83,"{""int_value"":1535823083751000,""set_timestamp_micros"":1535823083751000}"
97D9D96077AD3E8859BF5C54C873E59D,"{""int_value"":1535833844071000,""set_timestamp_micros"":1535833844071000}"
CEBA063FD7BF190D727CC948185CCEC8,"{""int_value"":1535786768380000,""set_timestamp_micros"":1535786768380000}"
61BB31EC7781341B1D7B8D8A85688DA3,"{""int_value"":1535834527505000,""set_timestamp_micros"":1535834527505000}"
5A66BC427F25EFFDFEDED4A07D8F9F91,"{""int_value"":1535857954726000,""set_timestamp_micros"":1535857954726000}"
37EFBD2BA398148336F96B4347392A8D,"{""int_value"":1535793454587000,""set_timestamp_micros"":1535793454587000}"
E0F1ED4167D0C0B2D6DCBA85CB020F52,"{""int_value"":1535813813915000,""set_timestamp_micros"":1535813813915000}"
177C0BEFFC69408F88D3377632F1BB60,"{""int_value"":1535851408336000,""set_timestamp_micros"":1535851408336000}"
5F5D7A3F5575008A81BB77CFE70C4285,"{""int_value"":1502934327056000,""set_timestamp_micros"":1535851178598000}"
37034A23CAFF85394E2E349C381788A6,"{""int_value"":1535814119760000,""set_timestamp_micros"":1535814119760000}"
387B532B7AF7A362DBF783E34C05BF54,"{""int_value"":1535818383344000,""set_timestamp_micros"":1535818383344000}"
1E882F0B9818614D6E47620DD31229F1,"{""int_value"":1535865216880000,""set_timestamp_micros"":1535865216880000}"
9F8885F0261FE69A58C8B6AE9176E437,"{""int_value"":1535839822373000,""set_timestamp_micros"":1535839822373000}"
ACA2E31E67D50F779611D7FDB674C370,"{""int_value"":1535851880421000,""set_timestamp_micros"":1535851880421000}"
551B893D34A2A59971B8FF185C1CD0C8,"{""int_value"":1535809874149000,""set_timestamp_micros"":1535809874149000}"
B82793CB1270A48BB2697C51AEED3E4A,"{""int_value"":1535799569882000,""set_timestamp_micros"":1535799569882000}"
D771048ADB1B9CACADFE001E6F9BA799,"{""int_value"":1535867549146000,""set_timestamp_micros"":1535867549146000}"
C7DD86F06FD4AA8A0967E27E20750FCD,"{""int_value"":1535798021434000,""set_timestamp_micros"":1535798021434000}"
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,"{""int_value"":1535846621178000,""set_timestamp_micros"":1535846621178000}"
D1C57A2E87382A82A40B1816E85277EA,"{""int_value"":1535821909295000,""set_timestamp_micros"":1535821909295000}"
D8B77A575B5308D161F95ACF515F9772,"{""int_value"":1535864536964000,""set_timestamp_micros"":1535864536964000}"
7AB9D5F7D122A38CA8769C9C93F3A12F,"{""int_value"":1535860647684000,""set_timestamp_micros"":1535860647684000}"
D6803CFD38D435F0364EB47684F7CCF6,"{""int_value"":1535791708036000,""set_timestamp_micros"":1535791708036000}"
3E336ECE1F533064D663A350DAB00790,"{""int_value"":1535790604676000,""set_timestamp_micros"":1535790604676000}"
CCE5E30054C510608589FA6240615B0A,"{""int_value"":1535844174073000,""set_timestamp_micros"":1535844174073000}"
3B049329E3090DA7A433
End Exploring Related Columns
Task: Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app (first_open event) within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following weeks 1, 2, and 3 period after the initial use and display them in column format.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Week,Retention_Rate
1,rate1:0<=float<=100
2,rate2:0<=float<=100
3,rate3:0<=float<=100
```

The retention rates represent the percentage of new users who first opened the app during the week starting from September 1st, 2018 (Shanghai timezone), and returned in weeks 1, 2, and 3 after their initial use..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180613', 'EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 16:42:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:42:02 - root - INFO - ```sql
WITH
new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" WHERE "event_name" = 'first_open'
    )
),
new_user_count AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_new_users FROM new_users
),
week1_events AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    )
),
week2_events AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    )
),
week3_events AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    )
)
SELECT '1' AS "Week",
       ROUND((COUNT(DISTINCT week1_events."user_pseudo_id") * 100.0 / new_user_count.total_new_users),4) AS "Retention_Rate"
FROM new_users
JOIN week1_events ON new_users."user_pseudo_id" = week1_events."user_pseudo_id",
new_user_count
UNION ALL
SELECT '2' AS "Week",
       ROUND((COUNT(DISTINCT week2_events."user_pseudo_id") * 100.0 / new_user_count.total_new_users),4) AS "Retention_Rate"
FROM new_users
JOIN week2_events ON new_users."user_pseudo_id" = week2_events."user_pseudo_id",
new_user_count
UNION ALL
SELECT '3' AS "Week",
       ROUND((COUNT(DISTINCT week3_events."user_pseudo_id") * 100.0 / new_user_count.total_new_users),4) AS "Retention_Rate"
FROM new_users
JOIN week3_events ON new_users."user_pseudo_id" = week3_events."user_pseudo_id",
new_user_count
ORDER BY "Week";
```
2025-02-10 16:42:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:42:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:42:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:42:03 - snowflake.connector.connection - INFO - closed
2025-02-10 16:42:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:42:03 - root - INFO - itercount: 1
2025-02-10 16:42:03 - root - INFO - 000979 (42601): 01ba4d8a-0004-96e7-0001-11c3010c842e: SQL compilation error:
[NEW_USER_COUNT.TOTAL_NEW_USERS] is not a valid group by expression
2025-02-10 16:42:03 - root - INFO - Input sql:
WITH
new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" WHERE "event_name" = 'first_open'
    )
),
new_user_count AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_new_users FROM new_users
),
week1_events AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    )
),
week2_events AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    )
),
week3_events AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    )
)
SELECT '1' AS "Week",
       ROUND((COUNT(DISTINCT week1_events."user_pseudo_id") * 100.0 / new_user_count.total_new_users),4) AS "Retention_Rate"
FROM new_users
JOIN week1_events ON new_users."user_pseudo_id" = week1_events."user_pseudo_id",
new_user_count
UNION ALL
SELECT '2' AS "Week",
       ROUND((COUNT(DISTINCT week2_events."user_pseudo_id") * 100.0 / new_user_count.total_new_users),4) AS "Retention_Rate"
FROM new_users
JOIN week2_events ON new_users."user_pseudo_id" = week2_events."user_pseudo_id",
new_user_count
UNION ALL
SELECT '3' AS "Week",
       ROUND((COUNT(DISTINCT week3_events."user_pseudo_id") * 100.0 / new_user_count.total_new_users),4) AS "Retention_Rate"
FROM new_users
JOIN week3_events ON new_users."user_pseudo_id" = week3_events."user_pseudo_id",
new_user_count
ORDER BY "Week";
The error information is:
000979 (42601): 01ba4d8a-0004-96e7-0001-11c3010c842e: SQL compilation error:
[NEW_USER_COUNT.TOTAL_NEW_USERS] is not a valid group by expression
Please correct it and output only 1 complete SQL query.
2025-02-10 16:43:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:43:44 - root - INFO - ```sql
WITH
new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" WHERE "event_name" = 'first_open'
    )
),
total_new_users AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_new_users FROM new_users
)
SELECT '1' AS "Week",
       ROUND((COUNT(DISTINCT week1_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    ) AS week1_events
) AS week1_events ON new_users."user_pseudo_id" = week1_events."user_pseudo_id"
UNION ALL
SELECT '2' AS "Week",
       ROUND((COUNT(DISTINCT week2_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    ) AS week2_events
) AS week2_events ON new_users."user_pseudo_id" = week2_events."user_pseudo_id"
UNION ALL
SELECT '3' AS "Week",
       ROUND((COUNT(DISTINCT week3_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    ) AS week3_events
) AS week3_events ON new_users."user_pseudo_id" = week3_events."user_pseudo_id"
ORDER BY "Week";
```
2025-02-10 16:43:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:43:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:43:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:43:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 16:43:46 - snowflake.connector.connection - INFO - closed
2025-02-10 16:43:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:43:47 - root - INFO - itercount: 2
2025-02-10 16:43:47 - root - INFO - 0
2025-02-10 16:43:47 - root - INFO - results: 
Week,Retention_Rate
1,20.7084
2,9.2643
3,5.7221


2025-02-10 16:43:47 - root - INFO - Please check the answer again by reviewing Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app (first_open event) within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following weeks 1, 2, and 3 period after the initial use and display them in column format., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Week,Retention_Rate
1,rate1:0<=float<=100
2,rate2:0<=float<=100
3,rate3:0<=float<=100
```

The retention rates represent the percentage of new users who first opened the app during the week starting from September 1st, 2018 (Shanghai timezone), and returned in weeks 1, 2, and 3 after their initial use. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Retention_Rate
1,20.7084
2,9.2643
3,5.7221
Current sql:
WITH
new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" WHERE "event_name" = 'first_open'
    )
),
total_new_users AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_new_users FROM new_users
)
SELECT '1' AS "Week",
       ROUND((COUNT(DISTINCT week1_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    ) AS week1_events
) AS week1_events ON new_users."user_pseudo_id" = week1_events."user_pseudo_id"
UNION ALL
SELECT '2' AS "Week",
       ROUND((COUNT(DISTINCT week2_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    ) AS week2_events
) AS week2_events ON new_users."user_pseudo_id" = week2_events."user_pseudo_id"
UNION ALL
SELECT '3' AS "Week",
       ROUND((COUNT(DISTINCT week3_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    ) AS week3_events
) AS week3_events ON new_users."user_pseudo_id" = week3_events."user_pseudo_id"
ORDER BY "Week";
2025-02-10 16:45:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 16:45:06 - root - INFO - ```sql
WITH
new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906" WHERE "event_name" = 'first_open'
        UNION ALL
        SELECT "user_pseudo_id"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907" WHERE "event_name" = 'first_open'
    )
),
total_new_users AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_new_users FROM new_users
)
SELECT '1' AS "Week",
       ROUND((COUNT(DISTINCT week1_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    ) AS week1_events
) AS week1_events ON new_users."user_pseudo_id" = week1_events."user_pseudo_id"
UNION ALL
SELECT '2' AS "Week",
       ROUND((COUNT(DISTINCT week2_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    ) AS week2_events
) AS week2_events ON new_users."user_pseudo_id" = week2_events."user_pseudo_id"
UNION ALL
SELECT '3' AS "Week",
       ROUND((COUNT(DISTINCT week3_events."user_pseudo_id") * 100.0 / (SELECT total_new_users FROM total_new_users)),4) AS "Retention_Rate"
FROM new_users
JOIN (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    ) AS week3_events
) AS week3_events ON new_users."user_pseudo_id" = week3_events."user_pseudo_id"
ORDER BY "Week";
```
2025-02-10 16:45:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 16:45:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 16:45:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 16:45:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-10 16:45:08 - snowflake.connector.connection - INFO - closed
2025-02-10 16:45:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 16:45:08 - root - INFO - itercount: 3
2025-02-10 16:45:08 - root - INFO - 0
2025-02-10 16:45:08 - root - INFO - Total iteration counts: 3
