2025-02-11 19:53:30 - openai._base_client - INFO - Retrying request to /chat/completions in 0.379634 seconds
2025-02-11 19:54:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 19:54:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:54:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:54:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:54:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:54:54 - snowflake.connector.connection - INFO - closed
2025-02-11 19:54:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:54:55 - root - INFO - SQL:
SELECT DISTINCT "MEASURE_TAG"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   LIMIT 100;
Results:
MEASURE_TAG
ProceedsFromHedgeFinancingActivities
ShareBasedCompensationSharesAuthorizedUnderStockOptionPlansExercisePriceRangeLowerRangeLimit
MarketRateUsedAsDiscountFactorToDetermineFairValueOfDebt
EffectiveIncomeTaxRateReconciliationNondeductibleExpenseSpinoffPercent
InterestExpenseFederalHomeLoanBankAndFederalReserveBankAdvancesLongTerm
OtherComprehensiveIncomeLossCashFlowHedgeGainLossBeforeReclassificationAfterTax
FinancingReceivableModificationsSubsequentDefaultRecordedInvestment1
NetCashProvidedByUsedInContinuingOperations
StockIssuedDuringPeriodSharesRestrictedStockAwardForfeited
PaymentsToAcquireMachineryAndEquipment
PaymentsForMergerRelatedCosts
NumberOfPatentsIncludedInLitigation
DeferredTaxAssetsTaxDeferredExpenseStateTaxAttributesNet
InvestmentsAndOtherAssets
PreferredStockSharesOutstanding
NumberOfRealEstatePropertiesClassifiedAsHeldForSale
NumberofRemainingWarehouses
DepreciationNonproduction
PrepaidRent
LinesOfCreditFairValueDisclosure
SalesRevenueGoodsGross
PaymentsForDelayedTaxExemptExchange
RelatedPartyTransactionAmountsOfTransaction
RestructuringAndRelatedCostIncurredCost
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsVestedAndExpectedToVestOutstandingWeightedAverageExercisePrice
Amortizationexpense
StockIssuedDuringPeriodValueRestrictedStockAwardGross
DebtSecuritiesAvailableForSaleContinuousUnrealizedLossPosition12MonthsOrLongerAccumulatedLoss
FairValueMeasurementWithUnobservableInputsReconciliationsRecurringBasisLiabilityValue
DiscountedFutureNetCashFlowsRelatingToProvedOilAndGasReservesFutureIncomeTaxExpense1
EffectOfExchangeRateOnCashAndCashEquivalentsDiscontinuedOperations
LiabilitiesOfDisposalGroupIncludingDiscontinuedOperationCurrent
CertainLoansAcquiredinTransferNotAccountedforasDebtSecuritiesCarryingAmountGross
InvestorsInterests
LoansPledgedAsCollateral
FairValueMeasurementWithUnobservableInputsReconciliationRecurringBasisAssetIssues
AdjustmentForAmortization
FairValueMeasurementWithUnobservableInputsReconciliationRecurringBasisLiabilityGainLossIncludedInOtherComprehensiveIncome
MarketableSecuritiesWithinOneYearFairValue
NotesReceivableFairValueDisclosure
CommonStockIssuedInConnectionWithBridgeNotes
ProceedsFromIssuanceOfPreferredStockAndPreferenceStock
IncreaseDecreaseInDeferredRent
DebtInstrumentInterestRateIncreaseDecrease
ProportionOfVotingPowerHeldInSubsidiary
AdditionsCapitalLeasePropertyPlantAndEquipment
IncomeTaxHolidayIncomeTaxBenefitsPerShare
DevelopmentCostsIntangibleAssetsDevelopmentCompleted
InterestAndExchangeRateDifferencesRelatedPartyTransactions
SalesTaxAndAdditions
RalatedPartyTransactionsChargesCreditsOnIncome
ProceedsFromSaleOfOtherAssetsInvestingActivities
TotalCapitalRequirement
ShareBasedCompensationArrangementsByShareBasedPaymentAwardWarrantsGrantsInPeriodWeightedAverageExercisePrice
CommonStockIssuedInConnectionWithNotePayableExtensionAmount
PaymentOfWorkingCapitalAdjustment42west
ImpairmentLossOnCapitalizedSoftwareDevelopmentCost
AdditionsFromPurchasesBiologicalAssets
NetIncomeAttributabletoCommonStockholders
AlternativeRevenueProgramsRevenue
SharebasedCompensationArrangementBySharebasedPaymentAwardOptionsGrantsInPeriodFairValue
ProceedsFromPrincipalAmount
PercentageOfRevenueByEndMarket
AggregateExercisePrice
TierOneLeverageCapitalToAverageAssets
OwnshareLendingArrangementSharesIssued
AvailableForSaleSecuritiesQualitativeDisclosureNumberOfPositions
LossOfHireCoverageAppliesOnlyToRigsOperatingUnderDayrate
FairValueInputProbabilityOfDefault
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsNonvestedCancelledWeightedAverageExercisePrice
AdditionalTaxBenefitRelatedToShareBasedPaymentTransactions
ServicingFee
OtherEmployeeStockPlanActivitiesValue
StockIssuedDuringPeriodWeightedAveragePricePerShareEmployeeStockPurchasePlans
DebtInstrumentConvertibleThresholdTradingDays
AdjustmentsToCurrentSalesYieldsForSpecificProperties
StockIssuedForServicesRelatedParty
ProceedsFromRepaymentOfLoansByEmployeeStockOwnershipPlans
AssetRetirementObligationCashPaidToSettle
CertainLoansAcquiredInTransferNotAccountedForAsDebtSecuritiesNetAdditionsToExistingPortfoliosAccretableYield
CashPaidInLieuOfFractionalSharesStock
IssuanceOfStockForInterestShares
AmountsExpectedToBeSettledAfterTwelveMonths
StockIssuedDuringPeriodSharesCashlessExerciseOfStockOptions
ShareBasedGoodsAndNonemployeeServicesTransactionValuationMethodExpectedVolatilityRate
CommonStockSharesIssuedUponConversionOfDebtValue
PolicyFeesAndContractChargesDirect
RatesAndTaxes
AllegationsSettelmentbOfCommonStockShares
IssuanceOfNoncontrollingInterest
NumberOfWarrantIssued
TotalLoansReceivable
TotalLimitForPropertyDamageForNonNuclearEvents
CashAndCashEquivalentsEndOfYearParentCompany
IncreaseDecreaseInFinanceReceivables
GainLossonInterestforQualifyingHedge
BenefitCostsNonoperating
ProceedsFromSaleOfRestrictedInvestments
DefinedBenefitPlanNetPeriodicBenefitCostIncludingAmountCapitalized
AcquisitionRelatedandintegrationCostsAssociatedwithaBusinessCombination

2025-02-11 19:54:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:54:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:54:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:54:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:54:57 - snowflake.connector.connection - INFO - closed
2025-02-11 19:54:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:54:58 - root - INFO - SQL:
SELECT "MEASURE_TAG", COUNT(*) AS "Record_Count"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   GROUP BY "MEASURE_TAG"
   ORDER BY "Record_Count" DESC
   LIMIT 100;
Results:
MEASURE_TAG,Record_Count
StockholdersEquity,2923032
NetIncomeLoss,2254600
StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest,1811166
Revenues,1778178
OperatingIncomeLoss,1617776
Assets,1304175
CashAndCashEquivalentsAtCarryingValue,1292768
IncomeTaxExpenseBenefit,1213613
RevenueFromContractWithCustomerExcludingAssessedTax,1131226
ProfitLoss,1087011
AvailableForSaleSecurities,980563
InterestExpense,921187
AllocatedShareBasedCompensationExpense,907912
SalesRevenueNet,899862
LoansAndLeasesReceivableGrossCarryingAmount,880028
FinancingReceivableRecordedInvestmentPastDue,801028
PropertyPlantAndEquipmentGross,789608
Goodwill,755317
LiabilitiesAndStockholdersEquity,750383
PropertyPlantAndEquipmentNet,736073
EarningsPerShareBasic,723034
DebtInstrumentInterestRateStatedPercentage,721971
DefinedBenefitPlanFairValueOfPlanAssets,707621
EarningsPerShareDiluted,699558
ComprehensiveIncomeNetOfTax,699081
AccumulatedOtherComprehensiveIncomeLossNetOfTax,697792
GrossProfit,680487
CommonStockSharesOutstanding,665007
AntidilutiveSecuritiesExcludedFromComputationOfEarningsPerShareAmount,664260
AssetsFairValueDisclosure,663211
IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments,654211
ShareBasedCompensation,645505
NetCashProvidedByUsedInOperatingActivities,643522
WeightedAverageNumberOfSharesOutstandingBasic,622658
NetCashProvidedByUsedInFinancingActivities,621946
IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest,621197
OtherComprehensiveIncomeLossNetOfTax,620487
Liabilities,620324
OperatingExpenses,616446
CommonStockSharesIssued,609776
CashAndCashEquivalentsPeriodIncreaseDecrease,605437
GeneralAndAdministrativeExpense,599204
DepreciationDepletionAndAmortization,598099
FiniteLivedIntangibleAssetsAccumulatedAmortization,588601
PaymentsToAcquirePropertyPlantAndEquipment,587940
NetCashProvidedByUsedInInvestingActivities,582377
AssetsCurrent,581612
WeightedAverageNumberOfDilutedSharesOutstanding,580810
LiabilitiesCurrent,578165
CommonStockValue,577415
LongTermDebt,574146
RetainedEarningsAccumulatedDeficit,571889
CommonStockSharesAuthorized,563803
CommonStockParOrStatedValuePerShare,551807
FiniteLivedIntangibleAssetsGross,550736
ConcentrationRiskPercentage1,541129
AvailableForSaleSecuritiesDebtSecurities,540607
AdjustmentsToAdditionalPaidInCapitalSharebasedCompensationRequisiteServicePeriodRecognitionValue,527689
LoansAndLeasesReceivableNetOfDeferredIncome,518607
OtherNonoperatingIncomeExpense,505513
SellingGeneralAndAdministrativeExpense,486171
FiniteLivedIntangibleAssetsNet,485283
DebtInstrumentFaceAmount,474421
LoansAndLeasesReceivableAllowance,470949
IncomeLossFromEquityMethodInvestments,448511
DebtInstrumentCarryingAmount,438858
StockIssuedDuringPeriodValueNewIssues,437598
AmortizationOfIntangibleAssets,423112
DerivativeLiabilities,411427
DerivativeFairValueOfDerivativeLiability,410826
NonoperatingIncomeExpense,409167
AccountsPayableCurrent,407645
DepreciationAndAmortization,405524
SharesOutstanding,403750
AvailableForSaleSecuritiesAmortizedCost,402660
DerivativeFairValueOfDerivativeAsset,399483
NetIncomeLossAvailableToCommonStockholdersBasic,390587
PreferredStockSharesAuthorized,388224
AccountsReceivableNetCurrent,387538
DerivativeAssets,384639
OtherAssetsNoncurrent,384557
DerivativeNotionalAmount,380776
EarningsPerShareBasicAndDiluted,379503
RealEstateAndAccumulatedDepreciationInitialCostOfLand,377924
NetIncomeLossAttributableToNoncontrollingInterest,377545
RealEstateAndAccumulatedDepreciationInitialCostOfBuildingsAndImprovements,372872
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsOutstandingNumber,370390
RestructuringCharges,370211
PreferredStockValue,359536
PreferredStockSharesIssued,353994
FinancingReceivableAllowanceForCreditLosses,353362
SalesRevenueGoodsNet,351342
CashAndCashEquivalentsFairValueDisclosure,350630
PreferredStockParOrStatedValuePerShare,347377
InventoryNet,344767
Depreciation,342944
InvestmentsFairValueDisclosure,342675
FinancingReceivableRecordedInvestmentCurrent,341445
CostsAndExpenses,333822
IntangibleAssetsNetExcludingGoodwill,333589

2025-02-11 19:54:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:54:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:54:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:54:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-02-11 19:54:59 - snowflake.connector.connection - INFO - closed
2025-02-11 19:54:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:55:00 - root - INFO - SQL:
SELECT DISTINCT "fiscal_year"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   ORDER BY "fiscal_year"
   LIMIT 100;
Results:
fiscal_year
1218.0
1905.0
2008.0
2009.0
2010.0
2011.0
2012.0
2013.0
2014.0
2015.0
2016.0
2017.0
2018.0
2019.0
2020.0
2021.0
""

2025-02-11 19:55:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:55:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:55:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:55:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:55:01 - snowflake.connector.connection - INFO - closed
2025-02-11 19:55:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:55:01 - root - INFO - SQL:
SELECT "submission_number", "company_name", "fiscal_year"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "fiscal_year" = 2016
   LIMIT 100;
Results:
Too long, hard cut:
submission_number,company_name,fiscal_year
0001193125-16-519387,NATIONWIDE LIFE INS CO,2016
0000014693-16-000059,BROWN FORMAN CORP,2016
0000015847-16-000057,BUTLER NATIONAL CORP,2016
0001171843-16-008436,AMERICAS CARMART INC,2016
0001056520-16-000213,STAR GOLD CORP.,2016
0000915779-16-000149,DAKTRONICS INC /SD/,2016
0001558370-16-004050,TOROTEL INC,2016
0001140361-16-057315,INVESTORS REAL ESTATE TRUST,2016
0001213900-16-010079,PREVENTION INSURANCE COM INC,2016
0001213900-16-011755,PREVENTION INSURANCE COM INC,2016
0001613103-16-000071,MEDTRONIC PLC,2016
0001393905-16-000765,OAXACA RESOURCES CORP,2016
0001469709-16-000721,ENERGIZER TENNIS INC.,2016
0001469709-16-000731,ENERGIZER TENNIS INC.,2016
0001213900-16-011408,"GUSHEN, INC",2016
0001594062-16-000407,GLOBAL QUEST LTD.,2016
0001393905-16-000762,NOGALES RESOURCES CORP,2016
0001448788-16-000124,"SUNWIN STEVIA INTERNATIONAL, INC.",2016
0001213900-16-011666,LVYUAN GREEN BUILDING MATERIAL TECHNOLOGY CORP.,2016
0001372167-16-000211,"PAN OCEAN CONTAINER SUPPLIES, LTD.",2016
0001056520-16-000212,"DTS8 COFFEE COMPANY, LTD.",2016
0001640334-16-000780,IMPERIAL PLANTATION CORP,2016
0001472375-16-000286,I-MINERALS INC,2016
0001213900-16-011530,ETERNITY HEALTHCARE INC.,2016
0001062993-16-008343,COUNTERPATH CORP,2016
0001628280-16-012260,CHC GROUP LTD.,2016
0001445866-16-001812,APPIPHANY TECHNOLOGIES HOLDINGS CORP,2016
0001096906-16-001453,CANYON GOLD CORP.,2016
0001493152-16-008171,GOLIATH FILM & MEDIA HOLDINGS,2016
0001393905-16-000787,"BIOSHAFT WATER TECHNOLOGY, INC.",2016
0001575872-16-000248,"CROWDGATHER, INC.",2016
0001019687-16-005414,PEREGRINE PHARMACEUTICALS INC,2016
0001640334-16-000794,"ORIENTAL MAGIC SOUP, INC.",2016
0001564590-16-014119,"NETAPP, INC.",2016
0001193125-16-500206,KORN FERRY INTERNATIONAL,2016
0001161697-16-000732,ENVOY GROUP CORP.,2016
0001104659-16-103402,AEROVIRONMENT INC,2016
0001094739-16-000109,FINISAR CORP,2016
0001604232-16-000156,"MARYJANE GROUP, INC.",2016
0001553350-16-001682,"ASPEN GROUP, INC.",2016
0001493152-16-007856,ENHANCE SKIN PRODUCTS INC,2016
0001372167-16-000209,RAZOR RESOURCES INC,2016
0001553350-16-001719,MAJOR LEAGUE FOOTBALL INC,2016
0001517126-16-000296,MOBILE LADS CORP,2016
0001294606-16-000218,OCULUS INC.,2016
0001437749-16-027327,NATIONAL BEVERAGE CORP,2016
0001193125-16-493131,AMERICAN SOFTWARE INC,2016
0000726958-16-000170,CASEYS GENERAL STORES INC,2016
0000915358-16-000027,SIGMATRON INTERNATIONAL INC,2016
0000715812-16-000005,BIOSYNERGY INC,2016
0000065270-16-000045,METHODE ELECTRONICS INC,2016
0001564590-16-013986,SMITH & WESSON HOLDING CORP,2016
0001213900-16-011481,MAGNOLIA LANE INCOME FUND,2016
0001144204-16-088331,"CHAMPIONS ONCOLOGY, INC.",2016
0001019687-16-004858,"PHARMACYTE BIOTECH, INC.",2016
0001019687-16-004860,"PHARMACYTE BIOTECH, INC.",2016
0001019687-16-004872,"PHARMACYTE BIOTECH, INC.",2016
0001019687-16-005399,"PHARMACYTE BIOTECH, INC.",2016
0001213900-16-011765,"PROGREEN PROPERTIES, INC.",2016
0001104659-16-097719,LA-Z-BOY INC,2016
0000891024-16-000007,"PATTERSON COMPANIES, INC.",2016
0001104659-16-100456,ISLE OF CAPRI CASINOS INC,2016
0001517401-16-000062,PEAK RESORTS INC,2016
0001574842-16-000031,H&R BLOCK INC,2016
0001511164-16-000692,FORCE PROTECTION VIDEO EQUIPMENT CORP.,2016
0001193125-16-499403,KEWAUNEE SCIENTIFIC CORP /DE/,2016
0001157523-16-004910,CULP INC,2016
0001437749-16-027419,"OCEAN POWER TECHNOLOGIES, INC.",2016
0001144204-16-088192,AMREP CORP.,2016
0000107140-16-000042,"WILEY JOHN & SONS, INC.",2016
0001634117-16-000038,"BARNES & NOBLE EDUCATION, INC.",2016
0001171520-16-000881,DATARAM CORP,2016
0001062993-16-008335,ROYAL MINES & MINERALS CORP,2016
0001144204-16-088455,NEVADA GOLD & CASINOS INC,2016
0001494733-16-000156,"LINE UP ADVERTISEMENT, INC.",2016
0001477932-16-008964,"BRK, INC.",2016
0001477932-16-009023,"SHARING SERVICES, INC.",2016
0001185185-16-003950,"SPARTA COMMERCIAL SERVICES, INC.",2016
0001477932-16-009120,"WATERMARK GROUP, INC.",2016
0001554795-16-000572,BORNEO INDUSTRIAL FISHERY CORP INC.,2016
0001554795-16-000574,QMIS FINANCE SECURITIES CORP,2016
0001062993-16-008348,JOYMAIN INTERNATIONAL DEVELOPMENT GROUP INC.,2016
0001193125-16-492374,"INFOR, INC.",2016
0001193125-16-436876,"INFOR (US), INC.",2016
0001193125-16-493362,BARNES & NOBLE INC,2016
0001185185-16-003920,FREQUENCY ELECTRONICS INC,2016
0001571049-16-012976,VALUE LINE INC,2016
0000033769-16-000105,BOB EVANS FARMS INC,2016
0000091419-16-000004,J M SMUCKER CO,2016
0001493152-16-006994,WISHBONE PET PRODUCTS INC.,2016
0001493152-16-008180,WISHBONE PET PRODUCTS INC.,2016
0001078782-16-002409,ARBOR ENTECH CORP,2016
0001144204-16-086979,WPCS INTERNATIONAL INC,2016
0001415889-16-005184,PETRO RIVER OIL CORP.,2016
0001330421-16-000017,BAZAARVOICE INC,2016
0001528930-16-000037,"LIBERTY TAX, INC.",2016
0000794619-16-000290,AMERICAN WOODMARK CORP,2016
0001511164-16-000696,BLACK ROCK PETROLEUM CO,2016
0000939802-16-000067,"BRISSET BEER INTERNATIONAL, INC.",2016
0001262463-16-000815,PREAXIA HEALTH CARE PAYMENT SYSTE

2025-02-11 19:55:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:55:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:55:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:55:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:55:02 - snowflake.connector.connection - INFO - closed
2025-02-11 19:55:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:55:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 19:55:25 - root - INFO - ```sql
SELECT s."stprba" AS "State", SUM(n."VALUE") / 1000000000 AS "Total_Revenue_Billions_USD"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
GROUP BY s."stprba"
ORDER BY SUM(n."VALUE") DESC
LIMIT 1;
```
2025-02-11 19:55:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:55:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:55:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:55:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 19:55:27 - snowflake.connector.connection - INFO - closed
2025-02-11 19:55:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:57:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 19:57:23 - root - INFO - SQL:
SELECT s."stprba" AS "State", SUM(n."VALUE") / 1000000000 AS "Total_Revenue_Billions_USD"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
GROUP BY s."stprba"
ORDER BY SUM(n."VALUE") DESC
LIMIT 1;
Results:
State,Total_Revenue_Billions_USD
TX,21374.377055993

2025-02-11 19:57:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:57:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:57:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:57:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:57:24 - snowflake.connector.connection - INFO - closed
2025-02-11 19:57:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:57:24 - root - INFO - SQL:
SELECT "submission_number", "company_name", "stprba"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "stprba" IS NOT NULL AND "stprba" <> ''
   LIMIT 100;
Results:
submission_number,company_name,stprba
0001104659-09-055895,KROGER CO,OH
0001166126-09-000048,J C PENNEY CO INC,TX
0001193125-09-189177,WAL MART STORES INC,AR
0001193125-09-180950,SALESFORCE COM INC,CA
0001193125-09-189281,GAP INC,CA
0001193125-09-183342,AUTODESK INC,CA
0001045810-09-000024,NVIDIA CORP,CA
0000950123-09-040859,HOME DEPOT INC,GA
0000950123-09-039364,TJX COMPANIES INC /DE/,MA
0001104659-09-051480,STAPLES INC,MA
0001104659-09-052321,TARGET CORP,MN
0000060667-09-000096,LOWES COMPANIES INC,NC
0001193125-09-187824,LIMITED BRANDS INC,OH
0001193125-09-188479,"MACY'S, INC.",OH
0000950123-09-042090,GAMESTOP CORP.,TX
0000950123-09-042709,DELL INC,TX
0000950123-09-041984,NORDSTROM INC,WA
0001193125-09-187625,KOHLS CORPORATION,WI
0000950123-09-026905,SUPERVALU INC,MN
0000827054-09-000154,MICROCHIP TECHNOLOGY INC,AZ
0001193125-09-170759,ELECTRONIC ARTS INC.,CA
0000950123-09-026374,MCKESSON CORP,CA
0000950123-09-030335,SYMANTEC CORP,CA
0000704051-09-000121,LEGG MASON INC,MD
0000038074-09-000041,FOREST LABORATORIES INC,NY
0000950123-09-027684,"CA, INC.",NY
0001193125-09-168742,PRECISION CASTPARTS CORP,OR
0001193125-09-165131,BMC SOFTWARE INC,TX
0000023082-09-000045,COMPUTER SCIENCES CORP,VA
0000897101-09-001829,MEDTRONIC INC,MN
0000950123-09-041361,H&R BLOCK INC,MO
0000950123-09-036965,HEINZ H J CO,PA
0001193125-09-195193,ORACLE CORP,CA
0000950123-09-045366,GENERAL MILLS INC,MN
0000950123-09-045262,PAYCHEX INC,NY
0000950123-09-044076,FEDEX CORP,TN
0001193125-09-179839,OPEN TEXT CORP,ON
0001144204-09-043912,ROCKWELL COLLINS INC,IA
0001193125-09-158470,JACOBS ENGINEERING GROUP INC /DE/,CA
0000950123-09-041558,SPDR GOLD TRUST,NY
0001354488-09-001699,INTERNATIONAL GAME TECHNOLOGY,NV
0001193125-09-159667,WALT DISNEY CO/,CA
0000950123-09-024369,QUALCOMM INC/DE,CA
0001193125-09-168564,FRANKLIN RESOURCES INC,CA
0001193125-09-153165,APPLE INC,CA
0001193125-09-159678,VISA INC.,CA
0001193125-09-171667,VARIAN MEDICAL SYSTEMS INC,CA
0001193125-09-166920,HOLOGIC INC,MA
0001144204-09-040507,EMERSON ELECTRIC CO,MO
0000950123-09-032660,BECTON DICKINSON & CO,NJ
0001104659-09-047200,HELMERICH & PAYNE INC,OK
0000950123-09-025125,AIR PRODUCTS & CHEMICALS INC /DE/,PA
0000950123-09-030790,AMERISOURCEBERGEN CORP,PA
0001193125-09-170340,BJ SERVICES CO,TX
0000950123-09-029843,STARBUCKS CORP,WA
0000950123-09-028880,JOHNSON CONTROLS INC,WI
0000950123-09-029309,ROCKWELL AUTOMATION INC,WI
0001047469-09-008166,HEWLETT PACKARD CO,CA
0000950123-09-040145,APPLIED MATERIALS INC /DE,CA
0001104659-09-052248,DEERE & CO,IL
0000950123-09-036183,ANALOG DEVICES INC,MA
0000801898-09-000131,JOY GLOBAL INC,WI
0000950123-09-025033,DOVER CORP,NY
0000950123-09-028093,SHERWIN WILLIAMS CO,OH
0000950123-09-031281,BOSTON SCIENTIFIC CORP,MA
0001104659-09-045366,HOSPIRA INC,IL
0001104659-09-047605,AMPHENOL CORP /DE/,CT
0001104659-09-048013,ABBOTT LABORATORIES,IL
0001193125-09-154417,UNITED TECHNOLOGIES CORP /DE/,CT
0001193125-09-154691,FASTENAL CO,MN
0001193125-09-156797,UNITED STATES STEEL CORP,PA
0001193125-09-157960,MATTEL INC /DE/,CA
0001193125-09-159490,CABOT OIL & GAS CORP,TX
0001193125-09-160726,HARLEY DAVIDSON INC,WI
0001193125-09-170697,FIFTH THIRD BANCORP,OH
0000950123-09-032022,NOBLE CORP,TX
0001193125-09-165283,IMPERIAL OIL LTD,AB
0000016868-09-000037,CANADIAN NATIONAL RAILWAY CO,QC
0001193125-09-167378,TIM HORTONS INC.,ON
0001167379-09-000099,ALCON INC,TX
0001047469-09-007370,LIBERTY MEDIA CORP,CO
0001193125-09-163901,"LIBERTY GLOBAL, INC.",CO
0000950123-09-031364,FEDERAL NATIONAL MORTGAGE ASSOCIATION FANNIE MAE,DC
0000950123-09-030426,"FIDELITY NATIONAL INFORMATION SERVICES, INC.",FL
0000950123-09-030284,INTERCONTINENTALEXCHANGE INC,GA
0001144204-09-046684,GARMIN LTD,KS
0000950123-09-028069,REYNOLDS AMERICAN INC,NC
0001193125-09-168966,COGNIZANT TECHNOLOGY SOLUTIONS CORP,NJ
0001193125-09-165642,ASSURANT INC,NY
0001193125-09-169196,BANK OF NEW YORK MELLON CORP,NY
0001104659-09-048657,BUNGE LTD,NY
0001130310-09-000035,CENTERPOINT ENERGY INC,TX
0000950123-09-029387,ULTRA PETROLEUM CORP,TX
0000950123-09-030911,COOPER INDUSTRIES LTD,TX
0001193125-09-158007,SCHLUMBERGER LTD /NV/,TX
0000950123-09-028100,INVESCO LTD.,GA
0000950123-09-030200,FOSTER WHEELER AG,NJ
0000950123-09-040151,WEATHERFORD INTERNATIONAL LTD./SWITZERLAND,TX
0000708819-09-000013,MCDERMOTT INTERNATIONAL INC,TX
0000950123-09-025764,DUPONT E I DE NEMOURS & CO,DE

2025-02-11 19:57:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:57:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:57:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:57:25 - snowflake.connector.connection - INFO - closed
2025-02-11 19:57:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:57:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 19:57:52 - root - INFO - The error occurs because the column name `"company_name"` does not match the exact case of the column in the "NUMBERS" table when using double quotes. In Snowflake, double-quoted identifiers are case-sensitive. The column is defined as `"COMPANY_NAME"` (in uppercase).

Here is the corrected SQL query:

```sql
SELECT DISTINCT "COMPANY_NAME", "MEASURE_TAG"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
WHERE "MEASURE_TAG" = 'Revenues'
LIMIT 100;
```

Alternatively, you can remove the double quotes from the column names, which makes them case-insensitive and converts them to uppercase internally:

```sql
SELECT DISTINCT COMPANY_NAME, MEASURE_TAG
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
WHERE MEASURE_TAG = 'Revenues'
LIMIT 100;
```

Either of these queries should resolve the error and retrieve the desired data.
2025-02-11 19:57:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:57:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:57:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:57:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:57:53 - snowflake.connector.connection - INFO - closed
2025-02-11 19:57:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:59:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 19:59:09 - root - INFO - SQL:
SELECT DISTINCT "COMPANY_NAME", "MEASURE_TAG"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
WHERE "MEASURE_TAG" = 'Revenues'
LIMIT 100;
Results:
COMPANY_NAME,MEASURE_TAG
FRANKLIN RESOURCES INC,Revenues
QUALCOMM INC/DE,Revenues
HOVNANIAN ENTERPRISES INC,Revenues
"MACOM TECHNOLOGY SOLUTIONS HOLDINGS, INC.",Revenues
PROCTER & GAMBLE CO,Revenues
RESMED INC,Revenues
FLOWERS FOODS INC,Revenues
"LIVING 3D HOLDINGS, INC.",Revenues
PACTERA TECHNOLOGY INTERNATIONAL LTD.,Revenues
UNIVERSAL AMERICAN CORP.,Revenues
SUPERNUS PHARMACEUTICALS INC,Revenues
"ADB INTERNATIONAL GROUP, INC.",Revenues
CATERPILLAR INC,Revenues
HERTZ CORP,Revenues
UNIFI INC,Revenues
"EPAM SYSTEMS, INC.",Revenues
PROOFPOINT INC,Revenues
ENTROPIC COMMUNICATIONS INC,Revenues
US BANCORP DE,Revenues
ASHFORD HOSPITALITY TRUST INC,Revenues
RIDGEWOOD ENERGY O FUND LLC,Revenues
"BOARDWALK PIPELINE PARTNERS, LP",Revenues
"DCP MIDSTREAM, LP",Revenues
INTEST CORP,Revenues
HUNTSMAN CORP,Revenues
LIGHTBRIDGE CORP,Revenues
"SUMMIT WIRELESS TECHNOLOGIES, INC.",Revenues
LIGHTSTONE VALUE PLUS REAL ESTATE INVESTMENT TRUST II INC,Revenues
COSTAMARE INC.,Revenues
"MOLINA HEALTHCARE, INC.",Revenues
OCEANEERING INTERNATIONAL INC,Revenues
STRATUS PROPERTIES INC,Revenues
CIBER INC,Revenues
LADENBURG THALMANN FINANCIAL SERVICES INC,Revenues
RERAISE GAMING CORP,Revenues
"APPLE REIT TEN, INC.",Revenues
"ELEVATE, INC.",Revenues
"ENERGY TRANSFER PARTNERS, L.P.",Revenues
LABORATORY CORP OF AMERICA HOLDINGS,Revenues
"BLACKSTAR ENTERPRISE GROUP, INC.",Revenues
"UNIVERSAL TRUCKLOAD SERVICES, INC.",Revenues
ASPEN TECHNOLOGY INC /DE/,Revenues
DELPHI TECHNOLOGIES PLC,Revenues
"HARLEY-DAVIDSON, INC.",Revenues
BELDEN INC.,Revenues
LEGGETT & PLATT INC,Revenues
INTERNATIONAL PAPER CO /NEW/,Revenues
"GREEN GLOBAL INVESTMENTS, INC.",Revenues
UNIVERSAL DISPLAY CORP \PA\,Revenues
JDA SOFTWARE GROUP INC,Revenues
VADDA ENERGY CORP,Revenues
"AMERICAN RAILCAR INDUSTRIES, INC.",Revenues
"STRATEGIC EDUCATION, INC.",Revenues
CYTOKINETICS INC,Revenues
"VANTIV, INC.",Revenues
EXA CORP,Revenues
NEMAURA MEDICAL INC.,Revenues
CHINA XUEFENG ENVIRONMENTAL ENGINEERING INC.,Revenues
TRIMOL GROUP INC.,Revenues
BRAIN SCIENTIFIC INC.,Revenues
"XPRESSPA GROUP, INC.",Revenues
"BANKWELL FINANCIAL GROUP, INC.",Revenues
"TSS, INC.",Revenues
"INTERDIGITAL, INC.",Revenues
NEXEON MEDSYSTEMS INC,Revenues
"LITHIUM EXPLORATION GROUP, INC.",Revenues
ORPHEUM PROPERTY INC,Revenues
MONSTER OFFERS,Revenues
"HARRIS TEETER SUPERMARKETS, INC.",Revenues
DSI REALTY INCOME FUND IX,Revenues
"PLANDEL RESOURCES, INC.",Revenues
"GRID DYNAMICS HOLDINGS, INC.",Revenues
PLX PHARMA INC.,Revenues
"HUDSON PACIFIC PROPERTIES, INC.",Revenues
WASTE MANAGEMENT INC,Revenues
BIOSTEM U.S. CORP,Revenues
AKERNA CORP.,Revenues
CIMPRESS PLC,Revenues
BOS BETTER ONLINE SOLUTIONS LTD,Revenues
CHEROKEE INC,Revenues
R F INDUSTRIES LTD,Revenues
"MASSROOTS, INC.",Revenues
UNIVERSAL FOREST PRODUCTS INC,Revenues
"ENERGIE HOLDINGS, INC.",Revenues
TANTECH HOLDINGS LTD,Revenues
CARDIOME PHARMA CORP,Revenues
"T-MOBILE US, INC.",Revenues
GATEWAY ENERGY CORP/NE,Revenues
WIKILOAN INC.,Revenues
DIVIDEND CAPITAL TOTAL REALTY TRUST INC.,Revenues
"TEMPUR SEALY INTERNATIONAL, INC.",Revenues
CURRENCYSHARES SINGAPORE DOLLAR TRUST,Revenues
"ICON LEASING FUND ELEVEN, LLC",Revenues
"SGS INTERNATIONAL, INC.",Revenues
"TIANLI AGRITECH, INC.",Revenues
TARGET HOSPITALITY CORP.,Revenues
MAGNA INTERNATIONAL INC,Revenues
"JETPADS, INC.",Revenues
LEASE EQUITY APPRECIATION FUND I LP,Revenues
"XCEL BRANDS, INC.",Revenues

2025-02-11 19:59:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:59:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:59:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:59:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:59:10 - snowflake.connector.connection - INFO - closed
2025-02-11 19:59:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:59:11 - root - INFO - SQL:
SELECT *
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   WHERE "MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
     AND "NUMBER_OF_QUARTERS" = 4
   LIMIT 100;
Results:
Too long, hard cut:
SUBMISSION_NUMBER,COMPANY_NAME,MEASURE_TAG,VERSION,PERIOD_END_DATE,NUMBER_OF_QUARTERS,UNITS,DIMENSION_HASH,IPRX,VALUE,FOOTNOTE,FOOTNOTE_LENGTH,NUM_DIMENSIONS,COREGISTRANT,DURATION_FRACTION,DATE_FRACTION,DECIMAL
0001734342-19-000010,MERCANTIL BANK HOLDING CORP,Revenues,us-gaap/2018,20181231,4,USD,0xcb176a66f13f132d7aa4b385ddf13fa4,0,53948000.0,,0,3,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x00000000,0,2782170000.0,,0,0,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x00000000,1,2782170000.0,,0,0,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x00000000,1,2619996000.0,,0,0,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x94c1611529456c7cf3987f92ddf02327,0,1220633000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x0da7327b1af10ced5e6741fb10f10b2f,0,2782170000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0xcf4dda08fcff63db468ebc4f8f2a4859,1,510057000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0xa6cbd1e258177b2232155b49e0fdca31,0,48246000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x21a6b93f1114101b6d6cfd71a30490e7,0,40000000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x910994d32c9062822c83941e2fab74df,0,2782170000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x01ff1fac0d785d19db6d8f038ea2ff87,0,336157000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20170331,4,USD,0x1e75a457fea012cabd8349eae21d7067,0,143143000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x5526cdc987144239b630a3fae17568cb,0,110379000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20170331,4,USD,0x3af6b8aa58e8e6f01d9d27058fac3c95,0,84069000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20170331,4,USD,0x5526cdc987144239b630a3fae17568cb,0,101654000.0,,0,2,,0.01095891,0.0,-3
0001761088-19-000044,"STWC. HOLDINGS, INC.",Revenues,us-gaap/2019,20190131,4,USD,0x00000000,0,136537.0,,0,0,,0.01095891,0.0,32767
0000092679-18-000024,SPARTON CORP,SalesRevenueNet,us-gaap/2017,20160630,4,USD,0x695ede95b63de800e4adf6c6a8454da5,0,-17273000.0,,0,1,,-0.032876015,-3.0,-3
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0x9bbdaeda1bcf0dd8c843bdc9ed30bf7c,0,0.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0xc95a3417c7ffe5c5ed5eacd57bec9626,0,3896600000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,SalesRevenueNet,us-gaap/2017,20170630,4,USD,0x6b0ba56913a97794c2fc4aef64bab125,0,-8000000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0x79f3e7f88c5e363ed833fcb2fd55b53c,0,322100000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20170630,4,USD,0x6a38719a1a103b653baa823273f460c8,0,10760400000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0x6c751b876743de62a8e930548722f406,0,-9400000.0,,0,1,,0.01095891,0.0,-5
0000017843-18-000047,CARPENTER TECHNOLOGY CORP,Revenues,us-gaap/2018,20180630,4,USD,0xd29a80c66d3e0156655c435124c8051f,0,383000000.0,,0,1,,0.01095891,0.0,-5
0000017843-18-000047,CARPENTER TECHNOLOGY CORP,Revenues,us-gaap/2018,20170630,4,USD,0x290267e3a75f9baee154d04d454732a4,0,1461600000.0,,0,2,,0.01095891,0.0,-5
0000017843-18-000047,CARPENTER TECHNOLOGY CORP,Revenues,us-gaap/2018,20180630,4,USD,0x1e36f745a9e890ad4acf977feb8b49ae,0,429700000.0,,0,2,,0.01095891,0.0,-5
0000021076-18-000011,CLOROX CO /DE/,Revenues,us-gaap/2018,20170630,4,USD,0xbf5bc361eff8ce6692b134c1856fde64,0,972000000.0,,0,1,,0.01095891,0.0,-6
0000021076-18-000011,CLOROX CO /DE/,Revenues,us-gaap/2018,20170630,4,USD,0x9dce50d51227e0513ed8d0fcf77e1563,0,1961000000.0,,0,2,,0.01095891,0.0,-6
0000023197-18-000076,COMTECH TELECOMMUNICATIONS CORP /DE/,Revenues,us-gaap/2018,20180731,4,USD,0x28572cec2418d30c5c4ebcf937b84089,0,0.0,,0,1,,0.01095891,0.0,0
0000023197-18-000076,COMTECH TELECOMMUNICATIONS CORP /DE/,Revenues,us-gaap/2018,20170731,4,USD,0x00000000,0,550368000.0,,0,0,,0.01095891,0.0,0
0000055242-18-000025,KENNAMETAL INC,Revenues,us-gaap/2017,20170630,4,USD,0xbb0127c7a0e84cdac40f87ad14371c5e,0,1126309000.0,,0,1,,0.01095891,0.0,-3
0000055242-18-000025,KENNAMETAL INC,Revenues,us-gaap/2017,20180630,4,USD,0x634c3a92746d0aed253d1e6a0feead6b,0,412610000.0,,0,1,,0.01095891,0.0,-3
0000055242-18-000025,KENNAMETAL INC,Revenues,us-gaap/2017,20180630,4,USD,0xbb0127c7a0e84cdac40f87ad143

2025-02-11 19:59:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:59:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:59:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:59:12 - snowflake.connector.connection - INFO - closed
2025-02-11 19:59:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 19:59:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 19:59:38 - root - INFO - The error occurs because column names are case-sensitive when enclosed in double quotes. In the `"NUMBERS"` table, the column is `"SUBMISSION_NUMBER"` (uppercase), while in the `"SUBMISSION"` table, it's `"submission_number"` (lowercase). Similarly, ensure that all other column names match the exact case.

Here is the corrected SQL query:

```sql
SELECT n."SUBMISSION_NUMBER", n."COMPANY_NAME", n."MEASURE_TAG", n."VALUE", s."fiscal_year", s."stprba"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
LIMIT 100;
```

**Explanation:**

- **Column Name Case Sensitivity:**
  - In the `"NUMBERS"` table:
    - `"SUBMISSION_NUMBER"` is uppercase.
    - `"COMPANY_NAME"` is uppercase.
    - `"MEASURE_TAG"` is uppercase.
    - `"VALUE"` is uppercase.
    - `"NUMBER_OF_QUARTERS"` is uppercase.
  - In the `"SUBMISSION"` table:
    - `"submission_number"` is lowercase.
    - `"fiscal_year"` is lowercase.
    - `"stprba"` is lowercase.

- **Adjustments Made:**
  - Updated `n."submission_number"` to `n."SUBMISSION_NUMBER"`.
  - Ensured that all column names in the `SELECT` clause and `WHERE` conditions match the exact casing as defined in their respective tables.
  - Verified that the join condition uses the correct casing for both tables.

**Note:** If you prefer to avoid case-sensitivity issues, you can remove the double quotes around column names. This makes the identifiers case-insensitive as they are converted to uppercase internally in Snowflake. For example:

```sql
SELECT n.SUBMISSION_NUMBER, n.COMPANY_NAME, n.MEASURE_TAG, n.VALUE, s.fiscal_year, s.stprba
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS".NUMBERS AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS".SUBMISSION AS s
  ON n.SUBMISSION_NUMBER = s.submission_number
WHERE n.MEASURE_TAG IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n.NUMBER_OF_QUARTERS = 4
  AND s.fiscal_year = 2016
LIMIT 100;
```

This approach treats all unquoted identifiers as uppercase, ensuring consistency and reducing potential errors due to case sensitivity.
2025-02-11 19:59:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 19:59:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 19:59:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 19:59:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 19:59:39 - snowflake.connector.connection - INFO - closed
2025-02-11 19:59:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:01:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:01:14 - root - INFO - SQL:
SELECT n."SUBMISSION_NUMBER", n."COMPANY_NAME", n."MEASURE_TAG", n."VALUE", s."fiscal_year", s."stprba"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
LIMIT 100;
Results:
Too long, hard cut:
SUBMISSION_NUMBER,COMPANY_NAME,MEASURE_TAG,VALUE,fiscal_year,stprba
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",SalesRevenueNet,,2016,NY
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",Revenues,,2016,NY
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",Revenues,,2016,NY
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",SalesRevenueNet,,2016,NY
0001594062-18-000064,"EPOXY, INC.",Revenues,30398.0,2016,NV
0001594062-18-000064,"EPOXY, INC.",Revenues,29415.0,2016,NV
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2255235.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,3218491.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,22995123.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2814976.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2515733.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2652261.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,27097836.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2603814.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2390509.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6702566.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueGoodsNet,2760595.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2588802.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueGoodsNet,2925126.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6043863.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6043863.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueGoodsNet,2798774.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2756882.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6813757.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,16734593.0,2016,
0001157523-17-002634,"AURUM, INC.",Revenues,,2016,
0001157523-17-002634,"AURUM, INC.",Revenues,,2016,
0001185185-17-002310,ALL SOFT GELS INC,Revenues,0.0,2016,UT
0001185185-17-002310,ALL SOFT GELS INC,Revenues,0.0,2016,UT
0001498301-15-000090,"ASCENA RETAIL GROUP, INC.",SalesRevenueGoodsNet,7300000000.0,2016,NJ
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,485286783.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,265610.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4763774.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4763774.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4763774.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,5200859.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4935249.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,5200859.0,2016,
0001440024-18-000010,"ROADRUNNER TRANSPORTATION SYSTEMS, INC.",Revenues,252100000.0,2016,WI
0001477932-18-000290,"BLACKSANDS PETROLEUM, INC.",Revenues,,2016,CO
0001477932-18-000290,"BLACKSANDS PETROLEUM, INC.",Revenues,,2016,CO
0001477932-18-000871,"SECTOR 5, INC.",Revenues,197823.0,2016,VA
0001477932-18-000871,"SECTOR 5, INC.",Revenues,,2016,VA
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",Revenues,105775887.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,11086275.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",Revenues,343649468.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,57623925.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,35272834.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGR

2025-02-11 20:01:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:01:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:01:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:01:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 20:01:16 - snowflake.connector.connection - INFO - closed
2025-02-11 20:01:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:01:16 - root - INFO - SQL:
SELECT s."stprba" AS "State", SUM(n."VALUE") AS "Total_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Total_Revenue" DESC
    LIMIT 100;
Results:
State,Total_Revenue
TX,21374377055993.0
NY,20102236969885.0
CA,17804760486480.0
IL,11620467267184.0
WA,8381872716142.0
MA,7854088261842.0
MI,7109722852786.0
MN,6586458022124.0
AR,6485940953393.0
OH,6315329135858.0
NJ,5720089294900.0
PA,5169649361193.0
GA,4632232996092.0
VA,4094668600548.65
MO,3608643044519.07
NE,3571452850643.0
NC,3196528478861.0
FL,3146795671151.0
CT,2865073264116.0
CO,2295431074688.0
TN,2085852691827.0
OK,1845249448189.0
WI,1833880413898.0
KY,1728982240485.0
IN,1557801406069.0
RI,1320266840330.0
MD,1275737926225.0
AZ,1271864593436.0
DE,1015922125750.0
ON,842971769871.0
KS,786060833952.0
NV,611253420924.0
OR,608934264468.0
AB,574998817134.0
AL,480604829301.0
IA,472864175384.0
ID,470341516256.0
LA,454001984392.0
UT,360816550073.0
QC,309839821800.0
DC,261197304000.0
SC,257001370167.0
NS,84792000000.0
HI,82320965068.0
NH,74390322000.0
BC,68381040186.0
ND,51131574472.0
NL,40546000000.0
ME,38354981963.0
SD,37791969906.0
MS,31532508161.0
AK,26990417000.0
WY,16259055639.0
VT,6448822883.0
MT,1181100626.0
WV,1130190928.0
NM,11324899.0

2025-02-11 20:01:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:01:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:01:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:01:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 20:01:19 - snowflake.connector.connection - INFO - closed
2025-02-11 20:01:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:01:19 - root - INFO - SQL:
SELECT s."stprba" AS "State", AVG(n."VALUE") AS "Average_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Average_Revenue" DESC
    LIMIT 100;
Results:
State,Average_Revenue
AR,17295842542.381332
NE,6105047607.936752
RI,5790644036.535088
WA,5663427510.906756
AB,4078005795.2765956
MI,3676175208.2657704
MN,3010264178.3016453
KY,2891274649.640468
NY,2477780965.1035376
DE,2335453162.643678
IL,2296988983.4322987
TN,2242852356.803226
TX,2241440546.9791317
GA,2207928024.8293614
MO,2207121128.14622
NC,1971948475.5465763
MA,1873589757.1187978
VA,1826346387.399041
NJ,1759486095.016918
OH,1749883384.8318093
QC,1721332343.3333333
ID,1697983813.198556
AL,1662992488.930796
CT,1560497420.5424836
CA,1554186494.9790504
OK,1494129107.845344
IN,1412331283.8340888
LA,1384152391.4390244
PA,1353665713.8499608
IA,1317170404.9693594
OR,1279273664.8487394
NL,1267062500.0
MD,1251950859.8871443
DC,1243796685.7142856
KS,1235944707.471698
AZ,1201005281.809254
WI,1063735738.9199536
FL,956182215.4819204
CO,867182121.1514922
ON,832976057.1847826
MS,808525850.2820513
NS,623470588.2352941
NV,586615567.1055663
SC,470698480.1593407
ND,469097013.5045872
UT,413780447.33142203
HI,384677406.8598131
NH,362879619.5121951
WY,345937354.0212766
ME,290568045.17424244
BC,276846316.5425101
SD,192816172.98979592
AK,190073359.15492958
VT,65804315.13265306
MT,34738253.705882356
WV,23545644.333333332
NM,1029536.2727272727

2025-02-11 20:01:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:01:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:01:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:01:20 - snowflake.connector.connection - INFO - closed
2025-02-11 20:01:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:01:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:01:43 - root - INFO - The error you're encountering is due to case sensitivity with quoted identifiers in Snowflake. When you enclose identifiers (like table and column names) in double quotes, they become case-sensitive and must match the exact case as defined in the database schema.

In your query, the column `"company_name"` does not match the exact case of the column in the `"NUMBERS"` table. The correct column name is `"COMPANY_NAME"` (all uppercase).

**Here is the corrected SQL query:**

```sql
SELECT n."COMPANY_NAME", s."stprba" AS "State", n."VALUE" AS "Revenue"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
ORDER BY n."VALUE" DESC
LIMIT 100;
```

**Explanation:**

- **Corrected Column Name:** Changed `n."company_name"` to `n."COMPANY_NAME"` to match the exact case as defined in the `"NUMBERS"` table.
- **Case Sensitivity:** In Snowflake, identifiers enclosed in double quotes are case-sensitive. Therefore, you must use the exact case for column names.
- **Consistency:** Ensured that all other column names and aliases match their exact case in the database schema.

**Alternative Solution:**

If you want to avoid case sensitivity issues, you can remove the double quotes from column names (but keep them for table and schema names if they contain special characters or are case-sensitive). Snowflake treats unquoted identifiers as uppercase internally, making them case-insensitive.

**Rewritten Query Without Double Quotes Around Column Names:**

```sql
SELECT n.COMPANY_NAME, s.stprba AS "State", n.VALUE AS "Revenue"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS".NUMBERS AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS".SUBMISSION AS s
  ON n.SUBMISSION_NUMBER = s.submission_number
WHERE n.MEASURE_TAG IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n.NUMBER_OF_QUARTERS = 4
  AND s.fiscal_year = 2016
  AND s.stprba IS NOT NULL AND s.stprba <> ''
ORDER BY n.VALUE DESC
LIMIT 100;
```

**Benefits of Removing Double Quotes:**

- **Case Insensitivity:** Unquoted identifiers are case-insensitive and are automatically converted to uppercase, matching the column definitions in the database.
- **Simpler Syntax:** Reduces the likelihood of errors due to case mismatches.

**Summary:**

- **Problem:** The identifier `n."company_name"` does not match the case of the column `"COMPANY_NAME"` in the `"NUMBERS"` table.
- **Solution:** Use the correct case for column names when using double quotes, or remove the double quotes to avoid case sensitivity issues.

**Recommendation:**

- **Best Practice:** If your object (database, schema, table, or column) names are all uppercase or you don't need to preserve case sensitivity, it's recommended to avoid using double quotes around identifiers. This practice can prevent similar errors in the future.

**Additional Note:**

- Ensure that any other column names you reference in your queries also match the exact case if you continue to use double-quoted identifiers.
2025-02-11 20:01:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:01:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:01:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:01:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:01:45 - snowflake.connector.connection - INFO - closed
2025-02-11 20:01:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:03:00 - root - INFO - SQL:
SELECT n."COMPANY_NAME", s."stprba" AS "State", n."VALUE" AS "Revenue"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
ORDER BY n."VALUE" DESC
LIMIT 100;
Results:
COMPANY_NAME,State,Revenue
"YANEX GROUP, INC.",CA,
PLYZER TECHNOLOGIES INC.,ON,
SUCCESS ENTERTAINMENT GROUP INTERNATIONAL INC.,IN,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
"CHINA GRAND RESORTS, INC.",NY,
"SOLIGENIX, INC.",NJ,
SEAFARER EXPLORATION CORP,FL,
"MANSFIELD-MARTIN EXPLORATION MINING, INC.",AZ,
"FRESH PROMISE FOODS, INC.",OK,
"BIM HOMES, INC.",CA,
"CRYPTO-SERVICES, INC.",ON,
"CHINA GRAND RESORTS, INC.",NY,
"BIM HOMES, INC.",CA,
"COOL TECHNOLOGIES, INC.",FL,
"YANEX GROUP, INC.",CA,
"STR HOLDINGS, INC.",CT,
SMSA CRANE ACQUISITION CORP.,FL,
"VIVEVE MEDICAL, INC.",CA,
"ONCBIOMUNE PHARMACEUTICALS, INC",LA,
"LEGACYXCHANGE, INC.",FL,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
SMSA CRANE ACQUISITION CORP.,FL,
"SOLARWINDOW TECHNOLOGIES, INC.",MD,
HICKOK INC,OH,
"FRESH PROMISE FOODS, INC.",OK,
DOCASA INC.,IL,
"ONCBIOMUNE PHARMACEUTICALS, INC",LA,
OPTEX SYSTEMS HOLDINGS INC,TX,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
INPIXON,CA,
"OMAGINE, INC.",NY,
INPIXON,CA,
OPTEX SYSTEMS HOLDINGS INC,TX,
"PERKINS OIL & GAS, INC.",BC,
"AFH ACQUISITION IX, INC.",CA,
"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY,
PRESTIGE CAPITAL CORP,UT,
NATIONAL HOLDINGS CORP,NY,
"VIVEVE MEDICAL, INC.",CA,
"GOOD GAMING, INC.",IL,
"LEGACYXCHANGE, INC.",FL,
"PERKINS OIL & GAS, INC.",BC,
"PAYMEON, INC.",FL,
LEGACY VENTURES INTERNATIONAL INC.,NV,
GAIN CITIES LTD,FL,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
NEVADA CANYON GOLD CORP.,NV,
"CHINA GRAND RESORTS, INC.",NY,
"ONCBIOMUNE PHARMACEUTICALS, INC",LA,
GOLD LAKES CORP.,OH,
"ASIA TRAINING INSTITUTE US, INC.",CA,
AVALON GLOBOCARE CORP.,NJ,
FUTURELAND CORP.,FL,
"COOL TECHNOLOGIES, INC.",FL,
PRESTIGE CAPITAL CORP,UT,
"MANSFIELD-MARTIN EXPLORATION MINING, INC.",AZ,
"GLOBAL TECH INDUSTRIES GROUP, INC.",NY,
"FRESH PROMISE FOODS, INC.",OK,
GOLD LAKES CORP.,OH,
"MAKINGORG, INC.",CA,
"OMAGINE, INC.",NY,
CONTINENTAL RAIL CORP,FL,
GAIN CITIES LTD,FL,
"SOLARWINDOW TECHNOLOGIES, INC.",MD,
INPIXON,CA,
"OIL STATES INTERNATIONAL, INC",TX,
OPTEX SYSTEMS HOLDINGS INC,TX,
CYBER APPS WORLD,NV,
OPTEX SYSTEMS HOLDINGS INC,TX,
NATURAL ALTERNATIVES INTERNATIONAL INC,CA,
OPTEX SYSTEMS HOLDINGS INC,TX,
SUCCESS ENTERTAINMENT GROUP INTERNATIONAL INC.,IN,
AMCHI GENDYNAMY SCIENCE CORP,CA,
FUTURELAND CORP.,FL,
"FRESH PROMISE FOODS, INC.",OK,
CYBER APPS WORLD,NV,
SITESTAR CORP,VA,
"MAKINGORG, INC.",CA,
HICKOK INC,OH,
"PAYMEON, INC.",FL,
SITESTAR CORP,VA,
"OIL STATES INTERNATIONAL, INC",TX,
"PAYMEON, INC.",FL,
"AFH ACQUISITION IX, INC.",CA,
"CHINA GRAND RESORTS, INC.",NY,
"OIL STATES INTERNATIONAL, INC",TX,
PLYZER TECHNOLOGIES INC.,ON,
SEAFARER EXPLORATION CORP,FL,
SITESTAR CORP,VA,
NATURAL ALTERNATIVES INTERNATIONAL INC,CA,
"VIVEVE MEDICAL, INC.",CA,
CONTINENTAL RAIL CORP,FL,
BRAVO MULTINATIONAL INC.,ON,
INTERUPS INC,NY,
"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY,
"CRYPTO-SERVICES, INC.",ON,
"SOLIGENIX, INC.",NJ,
INPIXON,CA,
"SOLIGENIX, INC.",NJ,
HICKOK INC,OH,

2025-02-11 20:03:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 20:03:02 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:02 - root - INFO - SQL:
SELECT s."stprba" AS "State", MAX(n."VALUE") AS "Max_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Max_Revenue" DESC
    LIMIT 100;
Results:
State,Max_Revenue
MA,597009000000.0
AR,485873000000.0
TX,394105000000.0
CA,233715000000.0
NE,223604000000.0
MN,184840000000.0
RI,177526000000.0
MI,166380000000.0
PA,146849686000.0
WA,135987000000.0
NY,131620000000.0
OH,121561000000.0
IL,117351000000.0
MO,101751800000.0
GA,94595000000.0
NC,85894000000.0
IN,84863000000.0
NJ,74331000000.0
CT,63155000000.0
KY,54379000000.0
TN,50365000000.0
MD,47248000000.0
FL,43391800000.0
WI,38749000000.0
AB,37641000000.0
ON,36445000000.0
KS,34532000000.0
OR,32376000000.0
VA,31781000000.0
DE,31360000000.0
CO,29033586000.0
AZ,27924657000.0
OK,23125000000.0
AL,19896000000.0
LA,18031000000.0
IA,17880000000.0
DC,16882400000.0
ID,16358000000.0
NV,14584000000.0
QC,12611000000.0
UT,10134400000.0
NL,6838000000.0
SC,5602000000.0
NH,5069762000.0
NS,4277000000.0
ND,4128828000.0
HI,3239542000.0
MS,2816100000.0
BC,2344392000.0
ME,1775423000.0
SD,1572974000.0
WY,1324044000.0
AK,978534000.0
VT,565030000.0
WV,155481145.0
MT,155142000.0
NM,4222000.0

2025-02-11 20:03:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 20:03:04 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:04 - root - INFO - SQL:
SELECT s."stprba" AS "State", COUNT(DISTINCT s."central_index_key") AS "Company_Count"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Company_Count" DESC
    LIMIT 100;
Results:
State,Company_Count
CA,834
NY,463
TX,449
FL,274
MA,215
PA,179
NJ,177
IL,164
CO,149
NV,133
OH,132
MN,111
VA,100
GA,93
CT,89
MD,83
AZ,80
NC,79
WA,76
MI,67
UT,66
MO,57
ON,55
WI,54
IN,49
TN,48
OK,42
BC,29
OR,27
KS,27
IA,27
KY,26
SC,22
NE,20
AR,20
LA,19
AL,19
DE,17
HI,15
RI,13
AB,11
DC,11
ID,10
SD,10
ND,9
NH,9
WV,9
QC,8
VT,7
MS,6
ME,4
AK,4
MT,4
NM,4
WY,3
NS,1
NL,1

2025-02-11 20:03:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 20:03:06 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:06 - root - INFO - SQL:
SELECT DISTINCT s."stprba" AS "State"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    LIMIT 100;
Results:
State
WI
NM
UT
NH
NS
ON
TX
CT
DE
AR
VA
IN
AK
MN
VT
AB
PA
QC
MO
NC
NL
RI
WY
LA
HI
BC
SC
OR
NJ
CO
NE
IA
DC
AL
MD
KY
ME
MS
TN
MI
OK
ID
WV
SD
NY
OH
MT
IL
CA
GA
FL
AZ
ND
WA
MA
NV
KS

2025-02-11 20:03:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:03:07 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:08 - root - INFO - SQL:
SELECT n."MEASURE_TAG", COUNT(*) AS "Total_Submissions"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."NUMBER_OF_QUARTERS" = 4
    GROUP BY n."MEASURE_TAG"
    ORDER BY "Total_Submissions" DESC
    LIMIT 100;
Results:
Too long, hard cut:
MEASURE_TAG,Total_Submissions
NetIncomeLoss,619545
Revenues,412880
OperatingIncomeLoss,334025
ProfitLoss,321610
IncomeTaxExpenseBenefit,287683
AllocatedShareBasedCompensationExpense,262601
SalesRevenueNet,255910
ConcentrationRiskPercentage1,236550
AdjustmentsToAdditionalPaidInCapitalSharebasedCompensationRequisiteServicePeriodRecognitionValue,231416
StockIssuedDuringPeriodValueNewIssues,211398
InterestExpense,210989
PaymentsToAcquirePropertyPlantAndEquipment,199430
ShareBasedCompensation,199122
CashAndCashEquivalentsPeriodIncreaseDecrease,198886
NetCashProvidedByUsedInOperatingActivities,195573
DepreciationDepletionAndAmortization,189713
NetCashProvidedByUsedInFinancingActivities,189691
NetCashProvidedByUsedInInvestingActivities,180347
OtherComprehensiveIncomeLossNetOfTax,175690
StockIssuedDuringPeriodValueStockOptionsExercised,172559
ComprehensiveIncomeNetOfTax,171023
AntidilutiveSecuritiesExcludedFromComputationOfEarningsPerShareAmount,161013
IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments,153458
IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest,142023
RevenueFromContractWithCustomerExcludingAssessedTax,135743
GrossProfit,134514
StockIssuedDuringPeriodValueShareBasedCompensation,131295
StockIssuedDuringPeriodSharesStockOptionsExercised,130533
AmortizationOfIntangibleAssets,128312
GeneralAndAdministrativeExpense,126840
DeferredIncomeTaxExpenseBenefit,126683
OperatingExpenses,126640
IncomeLossFromEquityMethodInvestments,124461
Depreciation,122811
EarningsPerShareBasic,120005
WeightedAverageNumberOfSharesOutstandingBasic,119468
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriod,115884
EarningsPerShareDiluted,115123
OtherNonoperatingIncomeExpense,114738
WeightedAverageNumberOfDilutedSharesOutstanding,112244
RestructuringCharges,111266
EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate,109997
DepreciationAndAmortization,107572
SellingGeneralAndAdministrativeExpense,107489
OtherComprehensiveIncomeLossForeignCurrencyTransactionAndTranslationAdjustmentNetOfTax,99407
IncreaseDecreaseInAccountsReceivable,99045
InterestPaid,98575
ImpairedFinancingReceivableAverageRecordedInvestment,98452
SalesRevenueGoodsNet,98400
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriodWeightedAverageGrantDateFairValue,96439
StockIssuedDuringPeriodSharesNewIssues,96204
CurrentIncomeTaxExpenseBenefit,94058
ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsRiskFreeInterestRate,92169
NetIncomeLossAttributableToNoncontrollingInterest,88944
DividendsCommonStockCash,88342
NetIncomeLossAvailableToCommonStockholdersBasic,87012
ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsExpectedVolatilityRate,86202
PaymentsForRepurchaseOfCommonStock,85266
ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsExpectedDividendRate,85202
CurrentFederalTaxExpenseBenefit,85015
NonoperatingIncomeExpense,84687
ProceedsFromIssuanceOfCommonStock,84017
TreasuryStockValueAcquiredCostMethod,83876
IncreaseDecreaseInInventories,83459
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodGross,82312
EffectiveIncomeTaxRateContinuingOperations,81936
OtherComprehensiveIncomeLossNetOfTaxPortionAttributableToParent,81906
ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest,81749
DeferredFederalIncomeTaxExpenseBenefit,81103
CurrentStateAndLocalTaxExpenseBenefit,81089
ResearchAndDevelopmentExpense,77934
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsVestedInPeriod,77382
ValuationAllowancesAndReservesChargedToCostAndExpense,77274
DefinedBenefitPlanNetPeriodicBenefitCost,76737
IncreaseDecreaseInAccountsPayable,76487
DefinedBenefitPlanInterestCost,76261
ShareBasedCompensationArrangementsByShareBasedPaymentAwardOptionsGrantsInPeriodWeightedAverageExercisePrice,75648
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodWeightedAverageGrantDateFairValue,75212
EffectOfExchangeRateOnCashAndCashEquivalents,75199
IncomeTaxesPaid,74017
ValuationAllowancesAndReservesDeductions,73434
DeferredStateAndLocalIncomeTaxExpenseBenefit,72403
NetCashProvidedByUsedInOperatingActivitiesContinuingOperations,72373
RepaymentsOfLongTermDebt,71825
CostsAndExpenses,71788
PaymentsToAcquireBusinessesNetOfCashAcquired,71385
ProceedsFromStockOptionsExercised,71012
IncreaseDecreaseInPrepaidDeferredExpenseAndOtherAssets,70506
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsForfeitedInPeriod,70329
IncomeTaxReconciliationIncomeTaxExpenseBenefitAtFederalStatutoryIncomeTaxRate,70216
StockIssuedDuringPeriodValueIssuedForServices,69208
StockIssuedDuringPeriodValueConversionOfConvertibleSecurities,68859
LeaseAndRentalExpense,68781
DefinedBenefitPlanServiceCost,6873

2025-02-11 20:03:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 23
2025-02-11 20:03:09 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:10 - root - INFO - SQL:
SELECT DISTINCT n."UNITS"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
    LIMIT 100;
Results:
UNITS
PHP
DKK
EUR
USD
CAD
CHF
EGP
AFN
MXN
JPY
PLN
TWD
CNY
RUB
BRL
KRW
ILS
INR
HKD
MYR
THB
AUD
GBP

2025-02-11 20:03:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:03:12 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:12 - root - INFO - SQL:
SELECT s."stprba" AS "State", s."sic", sc."industry_title", SUM(n."VALUE") AS "Total_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SIC_CODES" AS sc
      ON s."sic" = sc."sic_code"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" = 'CA'  -- Replace 'CA' with the top state after analysis
    GROUP BY s."stprba", s."sic", sc."industry_title"
    ORDER BY "Total_Revenue" DESC
    LIMIT 100;
Results:
Too long, hard cut:
State,sic,industry_title,Total_Revenue
CA,4953,REFUSE SYSTEMS,
CA,3990,MISCELLANEOUS MANUFACTURING INDUSTRIES,
CA,2721,PERIODICALS: PUBLISHING OR PUBLISHING & PRINTING,
CA,2000,FOOD AND KINDRED PRODUCTS,
CA,5400,RETAIL-FOOD STORES,
CA,3523,FARM MACHINERY & EQUIPMENT,
CA,3630,HOUSEHOLD APPLIANCES,
CA,5122,"WHOLESALE-DRUGS, PROPRIETARIES & DRUGGISTS' SUNDRIES",2833747724259.0
CA,3571,ELECTRONIC COMPUTERS,2577695053770.0
CA,3570,COMPUTER & OFFICE EQUIPMENT,1803592000000.0
CA,3674,SEMICONDUCTORS & RELATED DEVICES,1119093217480.0
CA,3576,COMPUTER COMMUNICATIONS EQUIPMENT,1022636209000.0
CA,7372,SERVICES-PREPACKAGED SOFTWARE,1012471846949.0
CA,7370,"SERVICES-COMPUTER PROGRAMMING, DATA PROCESSING, ETC.",836943525000.0
CA,2836,"BIOLOGICAL PRODUCTS, (NO DISGNOSTIC SUBSTANCES)",757604563826.0
CA,4841,CABLE & OTHER PAY TELEVISION SERVICES,540197000000.0
CA,2911,PETROLEUM REFINING,464919000000.0
CA,3572,COMPUTER STORAGE DEVICES,280547659000.0
CA,3663,RADIO & TV BROADCASTING & COMMUNICATIONS EQUIPMENT,260578088904.0
CA,5651,RETAIL-FAMILY CLOTHING STORES,226840433000.0
CA,6324,HOSPITAL & MEDICAL SERVICE PLANS,224429000000.0
CA,7389,"SERVICES-BUSINESS SERVICES, NEC",206386256022.0
CA,5045,WHOLESALE-COMPUTERS & PERIPHERAL EQUIPMENT & SOFTWARE,206075340000.0
CA,5141,"WHOLESALE-GROCERIES, GENERAL LINE",153195737000.0
CA,6798,REAL ESTATE INVESTMENT TRUSTS,148332238677.0
CA,3826,LABORATORY ANALYTICAL INSTRUMENTS,144181161290.0
CA,1600,HEAVY CONSTRUCTION OTHER THAN BLDG CONST - CONTRACTORS,137835424121.0
CA,6500,REAL ESTATE,136075331096.0
CA,4931,ELECTRIC & OTHER SERVICES COMBINED,103177000000.0
CA,4932,GAS & OTHER SERVICES COMBINED,100308153000.0
CA,3842,"ORTHOPEDIC, PROSTHETIC & SURGICAL APPLIANCES & SUPPLIES",87943438000.0
CA,3672,PRINTED CIRCUIT BOARDS,81069728416.0
CA,4911,ELECTRIC SERVICES,75452835938.0
CA,7900,SERVICES-AMUSEMENT & RECREATION SERVICES,74945228768.0
CA,2300,APPAREL & OTHER FINISHD PRODS OF FABRICS & SIMILAR MATL,70776725000.0
CA,7373,SERVICES-COMPUTER INTEGRATED SYSTEMS DESIGN,64132685327.0
CA,1531,OPERATIVE BUILDERS,64093393000.0
CA,6361,TITLE INSURANCE,62241994000.0
CA,2842,"SPECIALTY CLEANING, POLISHING AND SANITATION PREPARATIONS",62206000000.0
CA,6141,PERSONAL CREDIT INSTITUTIONS,61742000000.0
CA,6282,INVESTMENT ADVICE,61722796000.0
CA,2670,CONVERTED PAPER & PAPERBOARD PRODS (NO CONTANERS/BOXES),60249700000.0
CA,5094,"WHOLESALE-JEWELRY, WATCHES, PRECIOUS STONES & METALS",59255496000.0
CA,5051,WHOLESALE-METALS SERVICE CENTERS & OFFICES,57262600000.0
CA,3845,ELECTROMEDICAL & ELECTROTHERAPEUTIC APPARATUS,55665802037.0
CA,3711,MOTOR VEHICLES & PASSENGER CAR BODIES,55487368237.0
CA,3823,"INDUSTRIAL INSTRUMENTS FOR MEASUREMENT, DISPLAY, AND CONTROL",53739000000.0
CA,3577,"COMPUTER PERIPHERAL EQUIPMENT, NEC",53558721000.0
CA,6021,NATIONAL COMMERCIAL BANKS,49232201000.0
CA,7812,SERVICES-MOTION PICTURE & VIDEO TAPE PRODUCTION,47983226274.0
CA,3829,"MEASURING & CONTROLLING DEVICES, NEC",46402086251.0
CA,3841,SURGICAL & MEDICAL INSTRUMENTS & APPARATUS,44987927117.0
CA,5700,"RETAIL-HOME FURNITURE, FURNISHINGS & EQUIPMENT STORES",44275863000.0
CA,7841,SERVICES-VIDEO TAPE RENTAL,42229730422.0
CA,3812,"SEARCH, DETECTION, NAVAGATION, GUIDANCE, AERONAUTICAL SYS",41906261000.0
CA,6211,"SECURITY BROKERS, DEALERS & FLOTATION COMPANIES",39832000000.0
CA,5072,WHOLESALE-HARDWARE,38926312000.0
CA,2834,PHARMACEUTICAL PREPARATIONS,37839890671.0
CA,5812,RETAIL-EATING PLACES,37546235000.0
CA,3661,TELEPHONE & TELEGRAPH APPARATUS,35144600854.0
CA,3559,"SPECIAL INDUSTRY MACHINERY, NEC",34794522000.0
CA,3827,OPTICAL INSTRUMENTS & LENSES,32850632000.0
CA,2086,BOTTLED & CANNED SOFT DRINKS & CARBONATED WATERS,32132717000.0
CA,3140,"FOOTWEAR, (NO RUBBER)",30993885000.0
CA,7374,SERVICES-COMPUTER PROCESSING & DATA PREPARATION,30197112262.0
CA,5331,RETAIL-VARIETY STORES,30180477909.0
CA,5190,WHOLESALE-MISCELLANEOUS NONDURABLE GOODS,28129245000.0
CA,3760,GUIDED MISSILES & SPACE VEHICLES & PARTS,28038600000.0
CA,6199,FINANCE SERVICES,27608396000.0
CA,3851,OPHTHALMIC GOODS,27087976000.0
CA,2340,"WOMEN'S, MISSES', CHILDREN'S & INFANTS' UNDERGARMENTS",26713763365.0
CA,5411,RETAIL-GROCERY STORES,23694038000.0
CA,3942,DOLLS & STUFFED TOYS,23583082000.0
CA,3578,CALCULATING & ACCOUNTING MACHINES (NO ELECTRONIC COMPUTERS),21309690000.0
CA,3350,ROLLING DRAWING & EXTRUDING OF NONFERROUS METALS,20393000000.0
CA,4832,RADIO BROADCASTING STATIONS,18991329000.0
CA,7371,SERVICES-COMPUTER PROGRAMMING SERVICES,16747866000.0
CA,6794,PATENT OWNERS & LESSORS,15294859140.0
CA,5712,RETAIL-FURNITURE STORES,14357469000.0
CA,7363,SERVICES-HELP SUPPLY SERVICES,13203951000.0
CA,4899,"COMMUNICATIONS SERVICES, NEC",13155198788.0
CA,3669,"COMMUNICATIONS EQUIPMENT, NEC",12817015068.0
CA,3021,RUBBER & PLASTICS FOOTWEAR,12548802000.0
CA,7359,"SERVICES-EQUIPMENT RENTAL & LEASING, NEC",12492766749.0
CA,5961,RETAIL-CATALOG & MAIL-ORDER HOUSES,12478590000.0
CA,5063,"WHOLESALE-ELECTRICAL APPARATUS & EQUIPMENT, WIRING SUPPLIES",11940730000.0
CA,8071,SERVICES-MEDICAL LABORATORIES,1

2025-02-11 20:03:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:13 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:03:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:03:41 - root - INFO - The error you're encountering is due to **case sensitivity** with quoted identifiers in Snowflake. When you enclose identifiers (like table and column names) in double quotes, they become case-sensitive and must match the exact case as defined in the database schema.

In your query, the column `"company_name"` does not match the exact case of the column in the `"NUMBERS"` table. The correct column name is `"COMPANY_NAME"` (all uppercase).

---

**Here is the corrected SQL query:**

```sql
SELECT n."VALUE" AS "Revenue", n."COMPANY_NAME", s."stprba" AS "State"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
ORDER BY n."VALUE" DESC
LIMIT 100;
```

---

**Explanation:**

- **Corrected Column Name:** Changed `n."company_name"` to `n."COMPANY_NAME"` to match the exact case as defined in the `"NUMBERS"` table.
- **Case Sensitivity:** In Snowflake, identifiers enclosed in double quotes are case-sensitive. Therefore, you must use the exact case for column names.
- **Consistency:** Ensured that all other column names and aliases match their exact case in the database schema.

---

**Alternative Solution:**

If you want to avoid case sensitivity issues, you can remove the double quotes around column names (but keep them for table and schema names if they contain special characters or are case-sensitive). Snowflake treats unquoted identifiers as uppercase internally, making them case-insensitive.

**Rewritten Query Without Double Quotes Around Column Names:**

```sql
SELECT n.VALUE AS Revenue, n.COMPANY_NAME, s.stprba AS State
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS".NUMBERS AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS".SUBMISSION AS s
  ON n.SUBMISSION_NUMBER = s.submission_number
WHERE n.MEASURE_TAG IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n.NUMBER_OF_QUARTERS = 4
  AND s.fiscal_year = 2016
  AND s.stprba IS NOT NULL AND s.stprba <> ''
ORDER BY n.VALUE DESC
LIMIT 100;
```

---

**Benefits of Removing Double Quotes:**

- **Case Insensitivity:** Unquoted identifiers are case-insensitive and are automatically converted to uppercase, matching the column definitions in the database.
- **Simpler Syntax:** Reduces the likelihood of errors due to case mismatches.

---

**Summary:**

- **Problem:** The identifier `n."company_name"` does not match the case of the column `"COMPANY_NAME"` in the `"NUMBERS"` table.
- **Solution:** Use the correct case for column names when using double quotes, or remove the double quotes to avoid case sensitivity issues.

---

**Recommendation:**

- **Best Practice:** If your object (database, schema, table, or column) names are all uppercase or you don't need to preserve case sensitivity, it's recommended to avoid using double quotes around identifiers. This practice can prevent similar errors in the future.
- **Consistency:** Always ensure that any quoted identifiers match the exact case used in the database schema.

---

**Additional Note:**

- **Verify Column Names:** It's good practice to double-check the column names in your tables to ensure accuracy, especially when using quoted identifiers.
2025-02-11 20:03:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:03:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:03:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:03:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:03:42 - snowflake.connector.connection - INFO - closed
2025-02-11 20:03:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:04:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:04:17 - root - INFO - SQL:
SELECT n."VALUE" AS "Revenue", n."COMPANY_NAME", s."stprba" AS "State"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
ORDER BY n."VALUE" DESC
LIMIT 100;
Results:
Revenue,COMPANY_NAME,State
,GOLD LAKES CORP.,OH
,LEGACY VENTURES INTERNATIONAL INC.,NV
,"SOLIGENIX, INC.",NJ
,CYBER APPS WORLD,NV
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,"YANEX GROUP, INC.",CA
,"VIVEVE MEDICAL, INC.",CA
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,AMANASU ENVIRONMENT CORP,NY
,INPIXON,CA
,FUTURELAND CORP.,FL
,OPTEX SYSTEMS HOLDINGS INC,TX
,WOODLAND HOLDINGS CORP,TN
,WOODLAND HOLDINGS CORP,TN
,"OIL STATES INTERNATIONAL, INC",TX
,HEMCARE HEALTH SERVICES INC.,FL
,OPTEX SYSTEMS HOLDINGS INC,TX
,"VIVEVE MEDICAL, INC.",CA
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,"PAYMEON, INC.",FL
,"AKOUSTIS TECHNOLOGIES, INC.",NC
,"CRYPTO-SERVICES, INC.",ON
,PREMIER BIOMEDICAL INC,TX
,NATURAL ALTERNATIVES INTERNATIONAL INC,CA
,"OIL STATES INTERNATIONAL, INC",TX
,DOCASA INC.,IL
,NEVADA CANYON GOLD CORP.,NV
,CONTINENTAL RAIL CORP,FL
,"MAKINGORG, INC.",CA
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,"SOLIGENIX, INC.",NJ
,PRO DEX INC,CA
,PIVOT PHARMACEUTICALS INC.,BC
,"BALANCE LABS, INC.",FL
,"OMAGINE, INC.",NY
,"CYBERFORT SOFTWARE, INC.",CA
,"CRYPTO-SERVICES, INC.",ON
,WOODLAND HOLDINGS CORP,TN
,"LEGACYXCHANGE, INC.",FL
,"YANEX GROUP, INC.",CA
,"PAYMEON, INC.",FL
,"BIM HOMES, INC.",CA
,"GOOD GAMING, INC.",IL
,INPIXON,CA
,"OIL STATES INTERNATIONAL, INC",TX
,"BIM HOMES, INC.",CA
,"PERKINS OIL & GAS, INC.",BC
,"OMAGINE, INC.",NY
,"COOL TECHNOLOGIES, INC.",FL
,"AKOUSTIS TECHNOLOGIES, INC.",NC
,SITESTAR CORP,VA
,NATURAL ALTERNATIVES INTERNATIONAL INC,CA
,INPIXON,CA
,"AFH ACQUISITION IX, INC.",CA
,CYBER APPS WORLD,NV
,FUTURELAND CORP.,FL
,NATIONAL HOLDINGS CORP,NY
,PRESTIGE CAPITAL CORP,UT
,"AFH ACQUISITION IX, INC.",CA
,INTERUPS INC,NY
,PRO DEX INC,CA
,"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY
,"MAKINGORG, INC.",CA
,"GLOBAL TECH INDUSTRIES GROUP, INC.",NY
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,SITESTAR CORP,VA
,LIBERTY STAR URANIUM & METALS CORP.,AZ
,OPTEX SYSTEMS HOLDINGS INC,TX
,QUANTUM MATERIALS CORP.,TX
,"COOL TECHNOLOGIES, INC.",FL
,INPIXON,CA
,OPTEX SYSTEMS HOLDINGS INC,TX
,"ICAGEN, INC.",NC
,AMCHI GENDYNAMY SCIENCE CORP,CA
,LIBERTY STAR URANIUM & METALS CORP.,AZ
,OPTEX SYSTEMS HOLDINGS INC,TX
,PREMIER BIOMEDICAL INC,TX
,"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY
,"CYBERFORT SOFTWARE, INC.",CA
,"PAYMEON, INC.",FL
,CONTINENTAL RAIL CORP,FL
,"PERKINS OIL & GAS, INC.",BC
,PLYZER TECHNOLOGIES INC.,ON
,"VIVEVE MEDICAL, INC.",CA
,"SOLIGENIX, INC.",NJ
,PLYZER TECHNOLOGIES INC.,ON
,GOLD LAKES CORP.,OH
,"LEGACYXCHANGE, INC.",FL
,"SOLARWINDOW TECHNOLOGIES, INC.",MD
,SITESTAR CORP,VA
,SEAFARER EXPLORATION CORP,FL
,SEAFARER EXPLORATION CORP,FL
,"ASIA TRAINING INSTITUTE US, INC.",CA
,GAIN CITIES LTD,FL
,"SOLARWINDOW TECHNOLOGIES, INC.",MD
,AVALON GLOBOCARE CORP.,NJ
,AMANASU ENVIRONMENT CORP,NY
,HEMCARE HEALTH SERVICES INC.,FL
,PIVOT PHARMACEUTICALS INC.,BC
,PRESTIGE CAPITAL CORP,UT

2025-02-11 20:04:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:04:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:04:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:04:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 22
2025-02-11 20:04:19 - snowflake.connector.connection - INFO - closed
2025-02-11 20:04:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:04:19 - root - INFO - SQL:
SELECT DISTINCT n."UNITS"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."UNITS" <> 'USD'
    LIMIT 100;
Results:
UNITS
PHP
EUR
DKK
CAD
CHF
AFN
EGP
MXN
JPY
PLN
AUD
GBP
BRL
THB
TWD
CNY
HKD
MYR
INR
RUB
KRW
ILS

2025-02-11 20:04:19 - root - INFO - itercount: 0
2025-02-11 20:04:19 - root - INFO - Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,0
table_name,PRESENTATION
description,
DDL,"create or replace TABLE PRESENTATION (
	""submission_number"" VARCHAR(16777216),
	""report"" NUMBER(38,0),
	""line"" NUMBER(38,0),
	""statement"" VARCHAR(16777216),
	""presented_parenthetically"" BOOLEAN,
	""rfile"" VARCHAR(16777216),
	""measure_tag"" VARCHAR(16777216),
	""version"" VARCHAR(16777216),
	""preferred_role"" VARCHAR(16777216),
	""preferred_label"" VARCHAR(16777216),
	""negating"" BOOLEAN
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,1
table_name,QUICK_SUMMARY
description,
DDL,"create or replace TABLE QUICK_SUMMARY (
	""submission_number"" VARCHAR(16777216),
	""company_name"" VARCHAR(16777216),
	""measure_tag"" VARCHAR(16777216),
	""period_end_date"" VARCHAR(16777216),
	""value"" FLOAT,
	""units"" VARCHAR(16777216),
	""number_of_quarters"" NUMBER(38,0),
	""version"" VARCHAR(16777216),
	""central_index_key"" NUMBER(38,0),
	""ein"" VARCHAR(16777216),
	""sic"" VARCHAR(16777216),
	""fiscal_year_end"" VARCHAR(16777216),
	""form"" VARCHAR(16777216),
	""fiscal_year"" NUMBER(38,0),
	""fiscal_period_focus"" VARCHAR(16777216),
	""date_filed"" NUMBER(38,0),
	""date_accepted"" NUMBER(38,0)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,2
table_name,MEASURE_TAG
description,
DDL,"create or replace TABLE MEASURE_TAG (
	MEASURE_TAG VARCHAR(16777216),
	VERSION VARCHAR(16777216),
	CUSTOM BOOLEAN,
	ABSTRACT BOOLEAN,
	DATATYPE VARCHAR(16777216),
	I_OR_D VARCHAR(16777216),
	CREDIT_OR_DEBIT VARCHAR(16777216),
	TAG_LABEL VARCHAR(16777216),
	DOC VARCHAR(16777216)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,3
table_name,NUMBERS
description,
DDL,"create or replace TABLE NUMBERS (
	SUBMISSION_NUMBER VARCHAR(16777216),
	COMPANY_NAME VARCHAR(16777216),
	MEASURE_TAG VARCHAR(16777216),
	VERSION VARCHAR(16777216),
	PERIOD_END_DATE NUMBER(38,0),
	NUMBER_OF_QUARTERS NUMBER(38,0),
	UNITS VARCHAR(16777216),
	DIMENSION_HASH VARCHAR(16777216),
	IPRX NUMBER(38,0),
	VALUE FLOAT,
	FOOTNOTE VARCHAR(16777216),
	FOOTNOTE_LENGTH NUMBER(38,0),
	NUM_DIMENSIONS NUMBER(38,0),
	COREGISTRANT VARCHAR(16777216),
	DURATION_FRACTION FLOAT,
	DATE_FRACTION FLOAT,
	DECIMAL NUMBER(38,0)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,4
table_name,SUBMISSION
description,
DDL,"create or replace TABLE SUBMISSION (
	""submission_number"" VARCHAR(16777216),
	""central_index_key"" NUMBER(38,0),
	""company_name"" VARCHAR(16777216),
	""sic"" VARCHAR(16777216),
	""countryba"" VARCHAR(16777216),
	""stprba"" VARCHAR(16777216),
	""cityba"" VARCHAR(16777216),
	""zipba"" VARCHAR(16777216),
	""ba_street1"" VARCHAR(16777216),
	""ba_street2"" VARCHAR(16777216),
	""ba_phone"" VARCHAR(16777216),
	""countryma"" VARCHAR(16777216),
	""stprma"" VARCHAR(16777216),
	""cityma"" VARCHAR(16777216),
	""zipma"" VARCHAR(16777216),
	""ma_street1"" VARCHAR(16777216),
	""ma_street2"" VARCHAR(16777216),
	""country_inc"" VARCHAR(16777216),
	""state_province_inc"" VARCHAR(16777216),
	""ein"" VARCHAR(16777216),
	""former_name"" VARCHAR(16777216),
	""date_changed"" NUMBER(38,0),
	""filer_status"" VARCHAR(16777216),
	""well_known_seasoned_issuer"" BOOLEAN,
	""fiscal_year_end"" VARCHAR(16777216),
	""form"" VARCHAR(16777216),
	""period"" NUMBER(38,0),
	""fiscal_year"" NUMBER(38,0),
	""fiscal_period_focus"" VARCHAR(16777216),
	""date_filed"" NUMBER(38,0),
	""date_accepted"" NUMBER(38,0),
	""has_previous_report"" BOOLEAN,
	""has_required_detail"" BOOLEAN,
	""instance"" VARCHAR(16777216),
	""num_ciks"" NUMBER(38,0),
	""additional_ciks"" VARCHAR(16777216),
	""public_float_usd"" FLOAT,
	""float_date"" NUMBER(38,0),
	""float_axis"" VARCHAR(16777216),
	""float_terms"" NUMBER(38,0)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,5
table_name,RENDERING
description,
DDL,"create or replace TABLE RENDERING (
	""submission_number"" VARCHAR(16777216),
	""report"" NUMBER(38,0),
	""file_type"" VARCHAR(16777216),
	""menu_category"" VARCHAR(16777216),
	""shortname"" VARCHAR(16777216),
	""longname"" VARCHAR(16777216),
	""roleuri"" VARCHAR(16777216),
	""parentroleuri"" VARCHAR(16777216),
	""parentreport"" NUMBER(38,0),
	""ultimate_parent_report"" NUMBER(38,0)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,6
table_name,TXT
description,
DDL,"create or replace TABLE TXT (
	""submission_number"" VARCHAR(16777216),
	""measure_tag"" VARCHAR(16777216),
	""version"" VARCHAR(16777216),
	""period_end_date"" NUMBER(38,0),
	""num_quarters"" NUMBER(38,0),
	""iprx"" NUMBER(38,0),
	""language"" VARCHAR(16777216),
	""language_decimal"" NUMBER(38,0),
	""duration_fraction"" FLOAT,
	""date_fraction"" FLOAT,
	""dimension_hash"" VARCHAR(16777216),
	""num_dimensions"" NUMBER(38,0),
	""coregistrant"" VARCHAR(16777216),
	""escaped"" BOOLEAN,
	""source_length"" NUMBER(38,0),
	""text_length"" NUMBER(38,0),
	""footnote"" VARCHAR(16777216),
	""footnote_length"" NUMBER(38,0),
	""context"" VARCHAR(16777216),
	""value"" VARCHAR(16777216)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,7
table_name,CALCULATION
description,
DDL,"create or replace TABLE CALCULATION (
	""submission_number"" VARCHAR(16777216),
	""group"" NUMBER(38,0),
	""arc"" NUMBER(38,0),
	""negative"" NUMBER(38,0),
	""parent_tag"" VARCHAR(16777216),
	""parent_version"" VARCHAR(16777216),
	""child_tag"" VARCHAR(16777216),
	""child_version"" VARCHAR(16777216)
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,8
table_name,DIMENSION
description,
DDL,"create or replace TABLE DIMENSION (
	""segments_hash"" VARCHAR(16777216),
	""segments"" VARCHAR(16777216),
	""segment_truncation"" BOOLEAN
);"

Database Name: SEC_QUARTERLY_FINANCIALS
Schema Name: SEC_QUARTERLY_FINANCIALS
,9
table_name,SIC_CODES
description,
DDL,"create or replace TABLE SIC_CODES (
	""sic_code"" VARCHAR(16777216),
	""ad_office"" VARCHAR(16777216),
	""industry_title"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'SEC_QUARTERLY_FINANCIALS': {'SEC_QUARTERLY_FINANCIALS': ['PRESENTATION', 'QUICK_SUMMARY', 'MEASURE_TAG', 'NUMBERS', 'SUBMISSION', 'RENDERING', 'TXT', 'CALCULATION', 'DIMENSION', 'SIC_CODES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **"NUMBERS"."MEASURE_TAG"**: Used to filter for specific measure tags ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet').
- **"NUMBERS"."NUMBER_OF_QUARTERS"**: Identifies companies that provided data for all four quarters (should equal 4).
- **"NUMBERS"."VALUE"**: Contains the revenue values that need to be summed.
- **"NUMBERS"."SUBMISSION_NUMBER"**: Used to join with the "SUBMISSION" table to get additional information.
- **"SUBMISSION"."submission_number"**: Key to join with "NUMBERS" table.
- **"SUBMISSION"."stprba"**: Represents the U.S. state; used for grouping and filtering out null or empty states.
- **"SUBMISSION"."fiscal_year"**: Used to filter data for fiscal year 2016.

**Conditions:**

- **Fiscal Year**: Only consider data from fiscal year 2016 (`"fiscal_year" = 2016`).
- **State Field (stprba)**: Exclude entries where `"stprba"` is null or empty (`"stprba" IS NOT NULL AND "stprba" <> ''`).
- **Number of Quarters**: Only include companies that provided four quarters of data (`"NUMBER_OF_QUARTERS" = 4`).
- **Measure Tags**: Only consider specific measure tags (`"MEASURE_TAG"` in ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')).

---

**SQL Queries:**

1. **List all distinct measure tags in the "NUMBERS" table to understand available measures.**

   ```sql
   SELECT DISTINCT "MEASURE_TAG"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   LIMIT 100;
   ```

2. **Count the number of records for each measure tag to see their frequency.**

   ```sql
   SELECT "MEASURE_TAG", COUNT(*) AS "Record_Count"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   GROUP BY "MEASURE_TAG"
   ORDER BY "Record_Count" DESC
   LIMIT 100;
   ```

3. **Retrieve all distinct fiscal years from the "SUBMISSION" table to check available years.**

   ```sql
   SELECT DISTINCT "fiscal_year"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   ORDER BY "fiscal_year"
   LIMIT 100;
   ```

4. **List submissions for fiscal year 2016 to identify relevant records.**

   ```sql
   SELECT "submission_number", "company_name", "fiscal_year"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "fiscal_year" = 2016
   LIMIT 100;
   ```

5. **Find submissions where the state field ("stprba") is null or empty to understand data completeness.**

   ```sql
   SELECT "submission_number", "company_name", "stprba"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "stprba" IS NULL OR "stprba" = ''
   LIMIT 100;
   ```

6. **List submissions where the state field ("stprba") is not null or empty to focus on valid entries.**

   ```sql
   SELECT "submission_number", "company_name", "stprba"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "stprba" IS NOT NULL AND "stprba" <> ''
   LIMIT 100;
   ```

7. **Identify companies that reported 'Revenues' as a measure tag in the "NUMBERS" table.**

   ```sql
   SELECT DISTINCT "company_name", "MEASURE_TAG"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   WHERE "MEASURE_TAG" = 'Revenues'
   LIMIT 100;
   ```

8. **Retrieve records from "NUMBERS" for specified measure tags and four quarters of data.**

   ```sql
   SELECT *
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   WHERE "MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
     AND "NUMBER_OF_QUARTERS" = 4
   LIMIT 100;
   ```

9. **Join "NUMBERS" and "SUBMISSION" to get fiscal year and state for specified measure tags.**

   ```sql
   SELECT n."submission_number", n."company_name", n."MEASURE_TAG", n."VALUE", s."fiscal_year", s."stprba"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
   JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
     ON n."SUBMISSION_NUMBER" = s."submission_number"
   WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
     AND n."NUMBER_OF_QUARTERS" = 4
     AND s."fiscal_year" = 2016
   LIMIT 100;
   ```

10. **Find total revenue per state for fiscal year 2016 based on specified measure tags and conditions.**

    ```sql
    SELECT s."stprba" AS "State", SUM(n."VALUE") AS "Total_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Total_Revenue" DESC
    LIMIT 100;
    ```

11. **Calculate average revenue per company per state for fiscal year 2016.**

    ```sql
    SELECT s."stprba" AS "State", AVG(n."VALUE") AS "Average_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Average_Revenue" DESC
    LIMIT 100;
    ```

12. **List the top 100 companies by revenue for fiscal year 2016, including their state.**

    ```sql
    SELECT n."company_name", s."stprba" AS "State", n."VALUE" AS "Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    ORDER BY n."VALUE" DESC
    LIMIT 100;
    ```

13. **Identify the maximum revenue reported by any company in each state for fiscal year 2016.**

    ```sql
    SELECT s."stprba" AS "State", MAX(n."VALUE") AS "Max_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Max_Revenue" DESC
    LIMIT 100;
    ```

14. **Count the number of companies per state that meet all criteria for fiscal year 2016.**

    ```sql
    SELECT s."stprba" AS "State", COUNT(DISTINCT s."central_index_key") AS "Company_Count"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Company_Count" DESC
    LIMIT 100;
    ```

15. **List distinct states that have companies meeting all the criteria to understand geographic distribution.**

    ```sql
    SELECT DISTINCT s."stprba" AS "State"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    LIMIT 100;
    ```

16. **Find the total number of submissions for each measure tag to see which tags are most commonly used.**

    ```sql
    SELECT n."MEASURE_TAG", COUNT(*) AS "Total_Submissions"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."NUMBER_OF_QUARTERS" = 4
    GROUP BY n."MEASURE_TAG"
    ORDER BY "Total_Submissions" DESC
    LIMIT 100;
    ```

17. **Identify any discrepancies in the units reported for the revenue values.**

    ```sql
    SELECT DISTINCT n."UNITS"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
    LIMIT 100;
    ```

18. **List the SIC codes and corresponding industries for companies in the top revenue-generating state.**

    ```sql
    SELECT s."stprba" AS "State", s."sic", sc."industry_title", SUM(n."VALUE") AS "Total_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SIC_CODES" AS sc
      ON s."sic" = sc."sic_code"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" = 'CA'  -- Replace 'CA' with the top state after analysis
    GROUP BY s."stprba", s."sic", sc."industry_title"
    ORDER BY "Total_Revenue" DESC
    LIMIT 100;
    ```

19. **Explore the distribution of revenue values to detect outliers or data quality issues.**

    ```sql
    SELECT n."VALUE" AS "Revenue", n."company_name", s."stprba" AS "State"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    ORDER BY n."VALUE" DESC
    LIMIT 100;
    ```

20. **Check for any companies reporting revenue in non-USD units to ensure consistency.**

    ```sql
    SELECT DISTINCT n."UNITS"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."UNITS" <> 'USD'
    LIMIT 100;
    ```

These queries help in understanding the data related to the task by exploring the relevant tables and columns, applying necessary filters, and performing aggregations. They progress from simple data retrieval to more complex joins and aggregations, giving insight into how to approach the original task.Query:
SELECT DISTINCT "MEASURE_TAG"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   LIMIT 100;
Answer:
MEASURE_TAG
ProceedsFromHedgeFinancingActivities
ShareBasedCompensationSharesAuthorizedUnderStockOptionPlansExercisePriceRangeLowerRangeLimit
MarketRateUsedAsDiscountFactorToDetermineFairValueOfDebt
EffectiveIncomeTaxRateReconciliationNondeductibleExpenseSpinoffPercent
InterestExpenseFederalHomeLoanBankAndFederalReserveBankAdvancesLongTerm
OtherComprehensiveIncomeLossCashFlowHedgeGainLossBeforeReclassificationAfterTax
FinancingReceivableModificationsSubsequentDefaultRecordedInvestment1
NetCashProvidedByUsedInContinuingOperations
StockIssuedDuringPeriodSharesRestrictedStockAwardForfeited
PaymentsToAcquireMachineryAndEquipment
PaymentsForMergerRelatedCosts
NumberOfPatentsIncludedInLitigation
DeferredTaxAssetsTaxDeferredExpenseStateTaxAttributesNet
InvestmentsAndOtherAssets
PreferredStockSharesOutstanding
NumberOfRealEstatePropertiesClassifiedAsHeldForSale
NumberofRemainingWarehouses
DepreciationNonproduction
PrepaidRent
LinesOfCreditFairValueDisclosure
SalesRevenueGoodsGross
PaymentsForDelayedTaxExemptExchange
RelatedPartyTransactionAmountsOfTransaction
RestructuringAndRelatedCostIncurredCost
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsVestedAndExpectedToVestOutstandingWeightedAverageExercisePrice
Amortizationexpense
StockIssuedDuringPeriodValueRestrictedStockAwardGross
DebtSecuritiesAvailableForSaleContinuousUnrealizedLossPosition12MonthsOrLongerAccumulatedLoss
FairValueMeasurementWithUnobservableInputsReconciliationsRecurringBasisLiabilityValue
DiscountedFutureNetCashFlowsRelatingToProvedOilAndGasReservesFutureIncomeTaxExpense1
EffectOfExchangeRateOnCashAndCashEquivalentsDiscontinuedOperations
LiabilitiesOfDisposalGroupIncludingDiscontinuedOperationCurrent
CertainLoansAcquiredinTransferNotAccountedforasDebtSecuritiesCarryingAmountGross
InvestorsInterests
LoansPledgedAsCollateral
FairValueMeasurementWithUnobservableInputsReconciliationRecurringBasisAssetIssues
AdjustmentForAmortization
FairValueMeasurementWithUnobservableInputsReconciliationRecurringBasisLiabilityGainLossIncludedInOtherComprehensiveIncome
MarketableSecuritiesWithinOneYearFairValue
NotesReceivableFairValueDisclosure
CommonStockIssuedInConnectionWithBridgeNotes
ProceedsFromIssuanceOfPreferredStockAndPreferenceStock
IncreaseDecreaseInDeferredRent
DebtInstrumentInterestRateIncreaseDecrease
ProportionOfVotingPowerHeldInSubsidiary
AdditionsCapitalLeasePropertyPlantAndEquipment
IncomeTaxHolidayIncomeTaxBenefitsPerShare
DevelopmentCostsIntangibleAssetsDevelopmentCompleted
InterestAndExchangeRateDifferencesRelatedPartyTransactions
SalesTaxAndAdditions
RalatedPartyTransactionsChargesCreditsOnIncome
ProceedsFromSaleOfOtherAssetsInvestingActivities
TotalCapitalRequirement
ShareBasedCompensationArrangementsByShareBasedPaymentAwardWarrantsGrantsInPeriodWeightedAverageExercisePrice
CommonStockIssuedInConnectionWithNotePayableExtensionAmount
PaymentOfWorkingCapitalAdjustment42west
ImpairmentLossOnCapitalizedSoftwareDevelopmentCost
AdditionsFromPurchasesBiologicalAssets
NetIncomeAttributabletoCommonStockholders
AlternativeRevenueProgramsRevenue
SharebasedCompensationArrangementBySharebasedPaymentAwardOptionsGrantsInPeriodFairValue
ProceedsFromPrincipalAmount
PercentageOfRevenueByEndMarket
AggregateExercisePrice
TierOneLeverageCapitalToAverageAssets
OwnshareLendingArrangementSharesIssued
AvailableForSaleSecuritiesQualitativeDisclosureNumberOfPositions
LossOfHireCoverageAppliesOnlyToRigsOperatingUnderDayrate
FairValueInputProbabilityOfDefault
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsNonvestedCancelledWeightedAverageExercisePrice
AdditionalTaxBenefitRelatedToShareBasedPaymentTransactions
ServicingFee
OtherEmployeeStockPlanActivitiesValue
StockIssuedDuringPeriodWeightedAveragePricePerShareEmployeeStockPurchasePlans
DebtInstrumentConvertibleThresholdTradingDays
AdjustmentsToCurrentSalesYieldsForSpecificProperties
StockIssuedForServicesRelatedParty
ProceedsFromRepaymentOfLoansByEmployeeStockOwnershipPlans
AssetRetirementObligationCashPaidToSettle
CertainLoansAcquiredInTransferNotAccountedForAsDebtSecuritiesNetAdditionsToExistingPortfoliosAccretableYield
CashPaidInLieuOfFractionalSharesStock
IssuanceOfStockForInterestShares
AmountsExpectedToBeSettledAfterTwelveMonths
StockIssuedDuringPeriodSharesCashlessExerciseOfStockOptions
ShareBasedGoodsAndNonemployeeServicesTransactionValuationMethodExpectedVolatilityRate
CommonStockSharesIssuedUponConversionOfDebtValue
PolicyFeesAndContractChargesDirect
RatesAndTaxes
AllegationsSettelmentbOfCommonStockShares
IssuanceOfNoncontrollingInterest
NumberOfWarrantIssued
TotalLoansReceivable
TotalLimitForPropertyDamageForNonNuclearEvents
CashAndCashEquivalentsEndOfYearParentCompany
IncreaseDecreaseInFinanceReceivables
GainLossonInterestforQualifyingHedge
BenefitCostsNonoperating
ProceedsFromSaleOfRestrictedInvestments
DefinedBenefitPlanNetPeriodicBenefitCostIncludingAmountCapitalized
AcquisitionRelatedandintegrationCostsAssociatedwithaBusinessCombination
Query:
SELECT "MEASURE_TAG", COUNT(*) AS "Record_Count"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   GROUP BY "MEASURE_TAG"
   ORDER BY "Record_Count" DESC
   LIMIT 100;
Answer:
MEASURE_TAG,Record_Count
StockholdersEquity,2923032
NetIncomeLoss,2254600
StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest,1811166
Revenues,1778178
OperatingIncomeLoss,1617776
Assets,1304175
CashAndCashEquivalentsAtCarryingValue,1292768
IncomeTaxExpenseBenefit,1213613
RevenueFromContractWithCustomerExcludingAssessedTax,1131226
ProfitLoss,1087011
AvailableForSaleSecurities,980563
InterestExpense,921187
AllocatedShareBasedCompensationExpense,907912
SalesRevenueNet,899862
LoansAndLeasesReceivableGrossCarryingAmount,880028
FinancingReceivableRecordedInvestmentPastDue,801028
PropertyPlantAndEquipmentGross,789608
Goodwill,755317
LiabilitiesAndStockholdersEquity,750383
PropertyPlantAndEquipmentNet,736073
EarningsPerShareBasic,723034
DebtInstrumentInterestRateStatedPercentage,721971
DefinedBenefitPlanFairValueOfPlanAssets,707621
EarningsPerShareDiluted,699558
ComprehensiveIncomeNetOfTax,699081
AccumulatedOtherComprehensiveIncomeLossNetOfTax,697792
GrossProfit,680487
CommonStockSharesOutstanding,665007
AntidilutiveSecuritiesExcludedFromComputationOfEarningsPerShareAmount,664260
AssetsFairValueDisclosure,663211
IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments,654211
ShareBasedCompensation,645505
NetCashProvidedByUsedInOperatingActivities,643522
WeightedAverageNumberOfSharesOutstandingBasic,622658
NetCashProvidedByUsedInFinancingActivities,621946
IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest,621197
OtherComprehensiveIncomeLossNetOfTax,620487
Liabilities,620324
OperatingExpenses,616446
CommonStockSharesIssued,609776
CashAndCashEquivalentsPeriodIncreaseDecrease,605437
GeneralAndAdministrativeExpense,599204
DepreciationDepletionAndAmortization,598099
FiniteLivedIntangibleAssetsAccumulatedAmortization,588601
PaymentsToAcquirePropertyPlantAndEquipment,587940
NetCashProvidedByUsedInInvestingActivities,582377
AssetsCurrent,581612
WeightedAverageNumberOfDilutedSharesOutstanding,580810
LiabilitiesCurrent,578165
CommonStockValue,577415
LongTermDebt,574146
RetainedEarningsAccumulatedDeficit,571889
CommonStockSharesAuthorized,563803
CommonStockParOrStatedValuePerShare,551807
FiniteLivedIntangibleAssetsGross,550736
ConcentrationRiskPercentage1,541129
AvailableForSaleSecuritiesDebtSecurities,540607
AdjustmentsToAdditionalPaidInCapitalSharebasedCompensationRequisiteServicePeriodRecognitionValue,527689
LoansAndLeasesReceivableNetOfDeferredIncome,518607
OtherNonoperatingIncomeExpense,505513
SellingGeneralAndAdministrativeExpense,486171
FiniteLivedIntangibleAssetsNet,485283
DebtInstrumentFaceAmount,474421
LoansAndLeasesReceivableAllowance,470949
IncomeLossFromEquityMethodInvestments,448511
DebtInstrumentCarryingAmount,438858
StockIssuedDuringPeriodValueNewIssues,437598
AmortizationOfIntangibleAssets,423112
DerivativeLiabilities,411427
DerivativeFairValueOfDerivativeLiability,410826
NonoperatingIncomeExpense,409167
AccountsPayableCurrent,407645
DepreciationAndAmortization,405524
SharesOutstanding,403750
AvailableForSaleSecuritiesAmortizedCost,402660
DerivativeFairValueOfDerivativeAsset,399483
NetIncomeLossAvailableToCommonStockholdersBasic,390587
PreferredStockSharesAuthorized,388224
AccountsReceivableNetCurrent,387538
DerivativeAssets,384639
OtherAssetsNoncurrent,384557
DerivativeNotionalAmount,380776
EarningsPerShareBasicAndDiluted,379503
RealEstateAndAccumulatedDepreciationInitialCostOfLand,377924
NetIncomeLossAttributableToNoncontrollingInterest,377545
RealEstateAndAccumulatedDepreciationInitialCostOfBuildingsAndImprovements,372872
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsOutstandingNumber,370390
RestructuringCharges,370211
PreferredStockValue,359536
PreferredStockSharesIssued,353994
FinancingReceivableAllowanceForCreditLosses,353362
SalesRevenueGoodsNet,351342
CashAndCashEquivalentsFairValueDisclosure,350630
PreferredStockParOrStatedValuePerShare,347377
InventoryNet,344767
Depreciation,342944
InvestmentsFairValueDisclosure,342675
FinancingReceivableRecordedInvestmentCurrent,341445
CostsAndExpenses,333822
IntangibleAssetsNetExcludingGoodwill,333589
Query:
SELECT DISTINCT "fiscal_year"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   ORDER BY "fiscal_year"
   LIMIT 100;
Answer:
fiscal_year
1218.0
1905.0
2008.0
2009.0
2010.0
2011.0
2012.0
2013.0
2014.0
2015.0
2016.0
2017.0
2018.0
2019.0
2020.0
2021.0
""
Query:
SELECT "submission_number", "company_name", "fiscal_year"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "fiscal_year" = 2016
   LIMIT 100;
Answer:
Too long, hard cut:
submission_number,company_name,fiscal_year
0001193125-16-519387,NATIONWIDE LIFE INS CO,2016
0000014693-16-000059,BROWN FORMAN CORP,2016
0000015847-16-000057,BUTLER NATIONAL CORP,2016
0001171843-16-008436,AMERICAS CARMART INC,2016
0001056520-16-000213,STAR GOLD CORP.,2016
0000915779-16-000149,DAKTRONICS INC /SD/,2016
0001558370-16-004050,TOROTEL INC,2016
0001140361-16-057315,INVESTORS REAL ESTATE TRUST,2016
0001213900-16-010079,PREVENTION INSURANCE COM INC,2016
0001213900-16-011755,PREVENTION INSURANCE COM INC,2016
0001613103-16-000071,MEDTRONIC PLC,2016
0001393905-16-000765,OAXACA RESOURCES CORP,2016
0001469709-16-000721,ENERGIZER TENNIS INC.,2016
0001469709-16-000731,ENERGIZER TENNIS INC.,2016
0001213900-16-011408,"GUSHEN, INC",2016
0001594062-16-000407,GLOBAL QUEST LTD.,2016
0001393905-16-000762,NOGALES RESOURCES CORP,2016
0001448788-16-000124,"SUNWIN STEVIA INTERNATIONAL, INC.",2016
0001213900-16-011666,LVYUAN GREEN BUILDING MATERIAL TECHNOLOGY CORP.,2016
0001372167-16-000211,"PAN OCEAN CONTAINER SUPPLIES, LTD.",2016
0001056520-16-000212,"DTS8 COFFEE COMPANY, LTD.",2016
0001640334-16-000780,IMPERIAL PLANTATION CORP,2016
0001472375-16-000286,I-MINERALS INC,2016
0001213900-16-011530,ETERNITY HEALTHCARE INC.,2016
0001062993-16-008343,COUNTERPATH CORP,2016
0001628280-16-012260,CHC GROUP LTD.,2016
0001445866-16-001812,APPIPHANY TECHNOLOGIES HOLDINGS CORP,2016
0001096906-16-001453,CANYON GOLD CORP.,2016
0001493152-16-008171,GOLIATH FILM & MEDIA HOLDINGS,2016
0001393905-16-000787,"BIOSHAFT WATER TECHNOLOGY, INC.",2016
0001575872-16-000248,"CROWDGATHER, INC.",2016
0001019687-16-005414,PEREGRINE PHARMACEUTICALS INC,2016
0001640334-16-000794,"ORIENTAL MAGIC SOUP, INC.",2016
0001564590-16-014119,"NETAPP, INC.",2016
0001193125-16-500206,KORN FERRY INTERNATIONAL,2016
0001161697-16-000732,ENVOY GROUP CORP.,2016
0001104659-16-103402,AEROVIRONMENT INC,2016
0001094739-16-000109,FINISAR CORP,2016
0001604232-16-000156,"MARYJANE GROUP, INC.",2016
0001553350-16-001682,"ASPEN GROUP, INC.",2016
0001493152-16-007856,ENHANCE SKIN PRODUCTS INC,2016
0001372167-16-000209,RAZOR RESOURCES INC,2016
0001553350-16-001719,MAJOR LEAGUE FOOTBALL INC,2016
0001517126-16-000296,MOBILE LADS CORP,2016
0001294606-16-000218,OCULUS INC.,2016
0001437749-16-027327,NATIONAL BEVERAGE CORP,2016
0001193125-16-493131,AMERICAN SOFTWARE INC,2016
0000726958-16-000170,CASEYS GENERAL STORES INC,2016
0000915358-16-000027,SIGMATRON INTERNATIONAL INC,2016
0000715812-16-000005,BIOSYNERGY INC,2016
0000065270-16-000045,METHODE ELECTRONICS INC,2016
0001564590-16-013986,SMITH & WESSON HOLDING CORP,2016
0001213900-16-011481,MAGNOLIA LANE INCOME FUND,2016
0001144204-16-088331,"CHAMPIONS ONCOLOGY, INC.",2016
0001019687-16-004858,"PHARMACYTE BIOTECH, INC.",2016
0001019687-16-004860,"PHARMACYTE BIOTECH, INC.",2016
0001019687-16-004872,"PHARMACYTE BIOTECH, INC.",2016
0001019687-16-005399,"PHARMACYTE BIOTECH, INC.",2016
0001213900-16-011765,"PROGREEN PROPERTIES, INC.",2016
0001104659-16-097719,LA-Z-BOY INC,2016
0000891024-16-000007,"PATTERSON COMPANIES, INC.",2016
0001104659-16-100456,ISLE OF CAPRI CASINOS INC,2016
0001517401-16-000062,PEAK RESORTS INC,2016
0001574842-16-000031,H&R BLOCK INC,2016
0001511164-16-000692,FORCE PROTECTION VIDEO EQUIPMENT CORP.,2016
0001193125-16-499403,KEWAUNEE SCIENTIFIC CORP /DE/,2016
0001157523-16-004910,CULP INC,2016
0001437749-16-027419,"OCEAN POWER TECHNOLOGIES, INC.",2016
0001144204-16-088192,AMREP CORP.,2016
0000107140-16-000042,"WILEY JOHN & SONS, INC.",2016
0001634117-16-000038,"BARNES & NOBLE EDUCATION, INC.",2016
0001171520-16-000881,DATARAM CORP,2016
0001062993-16-008335,ROYAL MINES & MINERALS CORP,2016
0001144204-16-088455,NEVADA GOLD & CASINOS INC,2016
0001494733-16-000156,"LINE UP ADVERTISEMENT, INC.",2016
0001477932-16-008964,"BRK, INC.",2016
0001477932-16-009023,"SHARING SERVICES, INC.",2016
0001185185-16-003950,"SPARTA COMMERCIAL SERVICES, INC.",2016
0001477932-16-009120,"WATERMARK GROUP, INC.",2016
0001554795-16-000572,BORNEO INDUSTRIAL FISHERY CORP INC.,2016
0001554795-16-000574,QMIS FINANCE SECURITIES CORP,2016
0001062993-16-008348,JOYMAIN INTERNATIONAL DEVELOPMENT GROUP INC.,2016
0001193125-16-492374,"INFOR, INC.",2016
0001193125-16-436876,"INFOR (US), INC.",2016
0001193125-16-493362,BARNES & NOBLE INC,2016
0001185185-16-003920,FREQUENCY ELECTRONICS INC,2016
0001571049-16-012976,VALUE LINE INC,2016
0000033769-16-000105,BOB EVANS FARMS INC,2016
0000091419-16-000004,J M SMUCKER CO,2016
0001493152-16-006994,WISHBONE PET PRODUCTS INC.,2016
0001493152-16-008180,WISHBONE PET PRODUCTS INC.,2016
0001078782-16-002409,ARBOR ENTECH CORP,2016
0001144204-16-086979,WPCS INTERNATIONAL INC,2016
0001415889-16-005184,PETRO RIVER OIL CORP.,2016
0001330421-16-000017,BAZAARVOICE INC,2016
0001528930-16-000037,"LIBERTY TAX, INC.",2016
0000794619-16-000290,AMERICAN WOODMARK CORP,2016
0001511164-16-000696,BLACK ROCK PETROLEUM CO,2016
0000939802-16-000067,"BRISSET BEER INTERNATIONAL, INC.",2016
0001262463-16-000815,PREAXIA HEALTH CARE PAYMENT SYSTE
Query:
SELECT s."stprba" AS "State", SUM(n."VALUE") / 1000000000 AS "Total_Revenue_Billions_USD"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
GROUP BY s."stprba"
ORDER BY SUM(n."VALUE") DESC
LIMIT 1;
Answer:
State,Total_Revenue_Billions_USD
TX,21374.377055993
Query:
SELECT "submission_number", "company_name", "stprba"
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION"
   WHERE "stprba" IS NOT NULL AND "stprba" <> ''
   LIMIT 100;
Answer:
submission_number,company_name,stprba
0001104659-09-055895,KROGER CO,OH
0001166126-09-000048,J C PENNEY CO INC,TX
0001193125-09-189177,WAL MART STORES INC,AR
0001193125-09-180950,SALESFORCE COM INC,CA
0001193125-09-189281,GAP INC,CA
0001193125-09-183342,AUTODESK INC,CA
0001045810-09-000024,NVIDIA CORP,CA
0000950123-09-040859,HOME DEPOT INC,GA
0000950123-09-039364,TJX COMPANIES INC /DE/,MA
0001104659-09-051480,STAPLES INC,MA
0001104659-09-052321,TARGET CORP,MN
0000060667-09-000096,LOWES COMPANIES INC,NC
0001193125-09-187824,LIMITED BRANDS INC,OH
0001193125-09-188479,"MACY'S, INC.",OH
0000950123-09-042090,GAMESTOP CORP.,TX
0000950123-09-042709,DELL INC,TX
0000950123-09-041984,NORDSTROM INC,WA
0001193125-09-187625,KOHLS CORPORATION,WI
0000950123-09-026905,SUPERVALU INC,MN
0000827054-09-000154,MICROCHIP TECHNOLOGY INC,AZ
0001193125-09-170759,ELECTRONIC ARTS INC.,CA
0000950123-09-026374,MCKESSON CORP,CA
0000950123-09-030335,SYMANTEC CORP,CA
0000704051-09-000121,LEGG MASON INC,MD
0000038074-09-000041,FOREST LABORATORIES INC,NY
0000950123-09-027684,"CA, INC.",NY
0001193125-09-168742,PRECISION CASTPARTS CORP,OR
0001193125-09-165131,BMC SOFTWARE INC,TX
0000023082-09-000045,COMPUTER SCIENCES CORP,VA
0000897101-09-001829,MEDTRONIC INC,MN
0000950123-09-041361,H&R BLOCK INC,MO
0000950123-09-036965,HEINZ H J CO,PA
0001193125-09-195193,ORACLE CORP,CA
0000950123-09-045366,GENERAL MILLS INC,MN
0000950123-09-045262,PAYCHEX INC,NY
0000950123-09-044076,FEDEX CORP,TN
0001193125-09-179839,OPEN TEXT CORP,ON
0001144204-09-043912,ROCKWELL COLLINS INC,IA
0001193125-09-158470,JACOBS ENGINEERING GROUP INC /DE/,CA
0000950123-09-041558,SPDR GOLD TRUST,NY
0001354488-09-001699,INTERNATIONAL GAME TECHNOLOGY,NV
0001193125-09-159667,WALT DISNEY CO/,CA
0000950123-09-024369,QUALCOMM INC/DE,CA
0001193125-09-168564,FRANKLIN RESOURCES INC,CA
0001193125-09-153165,APPLE INC,CA
0001193125-09-159678,VISA INC.,CA
0001193125-09-171667,VARIAN MEDICAL SYSTEMS INC,CA
0001193125-09-166920,HOLOGIC INC,MA
0001144204-09-040507,EMERSON ELECTRIC CO,MO
0000950123-09-032660,BECTON DICKINSON & CO,NJ
0001104659-09-047200,HELMERICH & PAYNE INC,OK
0000950123-09-025125,AIR PRODUCTS & CHEMICALS INC /DE/,PA
0000950123-09-030790,AMERISOURCEBERGEN CORP,PA
0001193125-09-170340,BJ SERVICES CO,TX
0000950123-09-029843,STARBUCKS CORP,WA
0000950123-09-028880,JOHNSON CONTROLS INC,WI
0000950123-09-029309,ROCKWELL AUTOMATION INC,WI
0001047469-09-008166,HEWLETT PACKARD CO,CA
0000950123-09-040145,APPLIED MATERIALS INC /DE,CA
0001104659-09-052248,DEERE & CO,IL
0000950123-09-036183,ANALOG DEVICES INC,MA
0000801898-09-000131,JOY GLOBAL INC,WI
0000950123-09-025033,DOVER CORP,NY
0000950123-09-028093,SHERWIN WILLIAMS CO,OH
0000950123-09-031281,BOSTON SCIENTIFIC CORP,MA
0001104659-09-045366,HOSPIRA INC,IL
0001104659-09-047605,AMPHENOL CORP /DE/,CT
0001104659-09-048013,ABBOTT LABORATORIES,IL
0001193125-09-154417,UNITED TECHNOLOGIES CORP /DE/,CT
0001193125-09-154691,FASTENAL CO,MN
0001193125-09-156797,UNITED STATES STEEL CORP,PA
0001193125-09-157960,MATTEL INC /DE/,CA
0001193125-09-159490,CABOT OIL & GAS CORP,TX
0001193125-09-160726,HARLEY DAVIDSON INC,WI
0001193125-09-170697,FIFTH THIRD BANCORP,OH
0000950123-09-032022,NOBLE CORP,TX
0001193125-09-165283,IMPERIAL OIL LTD,AB
0000016868-09-000037,CANADIAN NATIONAL RAILWAY CO,QC
0001193125-09-167378,TIM HORTONS INC.,ON
0001167379-09-000099,ALCON INC,TX
0001047469-09-007370,LIBERTY MEDIA CORP,CO
0001193125-09-163901,"LIBERTY GLOBAL, INC.",CO
0000950123-09-031364,FEDERAL NATIONAL MORTGAGE ASSOCIATION FANNIE MAE,DC
0000950123-09-030426,"FIDELITY NATIONAL INFORMATION SERVICES, INC.",FL
0000950123-09-030284,INTERCONTINENTALEXCHANGE INC,GA
0001144204-09-046684,GARMIN LTD,KS
0000950123-09-028069,REYNOLDS AMERICAN INC,NC
0001193125-09-168966,COGNIZANT TECHNOLOGY SOLUTIONS CORP,NJ
0001193125-09-165642,ASSURANT INC,NY
0001193125-09-169196,BANK OF NEW YORK MELLON CORP,NY
0001104659-09-048657,BUNGE LTD,NY
0001130310-09-000035,CENTERPOINT ENERGY INC,TX
0000950123-09-029387,ULTRA PETROLEUM CORP,TX
0000950123-09-030911,COOPER INDUSTRIES LTD,TX
0001193125-09-158007,SCHLUMBERGER LTD /NV/,TX
0000950123-09-028100,INVESCO LTD.,GA
0000950123-09-030200,FOSTER WHEELER AG,NJ
0000950123-09-040151,WEATHERFORD INTERNATIONAL LTD./SWITZERLAND,TX
0000708819-09-000013,MCDERMOTT INTERNATIONAL INC,TX
0000950123-09-025764,DUPONT E I DE NEMOURS & CO,DE
Query:
SELECT DISTINCT "COMPANY_NAME", "MEASURE_TAG"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
WHERE "MEASURE_TAG" = 'Revenues'
LIMIT 100;
Answer:
COMPANY_NAME,MEASURE_TAG
FRANKLIN RESOURCES INC,Revenues
QUALCOMM INC/DE,Revenues
HOVNANIAN ENTERPRISES INC,Revenues
"MACOM TECHNOLOGY SOLUTIONS HOLDINGS, INC.",Revenues
PROCTER & GAMBLE CO,Revenues
RESMED INC,Revenues
FLOWERS FOODS INC,Revenues
"LIVING 3D HOLDINGS, INC.",Revenues
PACTERA TECHNOLOGY INTERNATIONAL LTD.,Revenues
UNIVERSAL AMERICAN CORP.,Revenues
SUPERNUS PHARMACEUTICALS INC,Revenues
"ADB INTERNATIONAL GROUP, INC.",Revenues
CATERPILLAR INC,Revenues
HERTZ CORP,Revenues
UNIFI INC,Revenues
"EPAM SYSTEMS, INC.",Revenues
PROOFPOINT INC,Revenues
ENTROPIC COMMUNICATIONS INC,Revenues
US BANCORP DE,Revenues
ASHFORD HOSPITALITY TRUST INC,Revenues
RIDGEWOOD ENERGY O FUND LLC,Revenues
"BOARDWALK PIPELINE PARTNERS, LP",Revenues
"DCP MIDSTREAM, LP",Revenues
INTEST CORP,Revenues
HUNTSMAN CORP,Revenues
LIGHTBRIDGE CORP,Revenues
"SUMMIT WIRELESS TECHNOLOGIES, INC.",Revenues
LIGHTSTONE VALUE PLUS REAL ESTATE INVESTMENT TRUST II INC,Revenues
COSTAMARE INC.,Revenues
"MOLINA HEALTHCARE, INC.",Revenues
OCEANEERING INTERNATIONAL INC,Revenues
STRATUS PROPERTIES INC,Revenues
CIBER INC,Revenues
LADENBURG THALMANN FINANCIAL SERVICES INC,Revenues
RERAISE GAMING CORP,Revenues
"APPLE REIT TEN, INC.",Revenues
"ELEVATE, INC.",Revenues
"ENERGY TRANSFER PARTNERS, L.P.",Revenues
LABORATORY CORP OF AMERICA HOLDINGS,Revenues
"BLACKSTAR ENTERPRISE GROUP, INC.",Revenues
"UNIVERSAL TRUCKLOAD SERVICES, INC.",Revenues
ASPEN TECHNOLOGY INC /DE/,Revenues
DELPHI TECHNOLOGIES PLC,Revenues
"HARLEY-DAVIDSON, INC.",Revenues
BELDEN INC.,Revenues
LEGGETT & PLATT INC,Revenues
INTERNATIONAL PAPER CO /NEW/,Revenues
"GREEN GLOBAL INVESTMENTS, INC.",Revenues
UNIVERSAL DISPLAY CORP \PA\,Revenues
JDA SOFTWARE GROUP INC,Revenues
VADDA ENERGY CORP,Revenues
"AMERICAN RAILCAR INDUSTRIES, INC.",Revenues
"STRATEGIC EDUCATION, INC.",Revenues
CYTOKINETICS INC,Revenues
"VANTIV, INC.",Revenues
EXA CORP,Revenues
NEMAURA MEDICAL INC.,Revenues
CHINA XUEFENG ENVIRONMENTAL ENGINEERING INC.,Revenues
TRIMOL GROUP INC.,Revenues
BRAIN SCIENTIFIC INC.,Revenues
"XPRESSPA GROUP, INC.",Revenues
"BANKWELL FINANCIAL GROUP, INC.",Revenues
"TSS, INC.",Revenues
"INTERDIGITAL, INC.",Revenues
NEXEON MEDSYSTEMS INC,Revenues
"LITHIUM EXPLORATION GROUP, INC.",Revenues
ORPHEUM PROPERTY INC,Revenues
MONSTER OFFERS,Revenues
"HARRIS TEETER SUPERMARKETS, INC.",Revenues
DSI REALTY INCOME FUND IX,Revenues
"PLANDEL RESOURCES, INC.",Revenues
"GRID DYNAMICS HOLDINGS, INC.",Revenues
PLX PHARMA INC.,Revenues
"HUDSON PACIFIC PROPERTIES, INC.",Revenues
WASTE MANAGEMENT INC,Revenues
BIOSTEM U.S. CORP,Revenues
AKERNA CORP.,Revenues
CIMPRESS PLC,Revenues
BOS BETTER ONLINE SOLUTIONS LTD,Revenues
CHEROKEE INC,Revenues
R F INDUSTRIES LTD,Revenues
"MASSROOTS, INC.",Revenues
UNIVERSAL FOREST PRODUCTS INC,Revenues
"ENERGIE HOLDINGS, INC.",Revenues
TANTECH HOLDINGS LTD,Revenues
CARDIOME PHARMA CORP,Revenues
"T-MOBILE US, INC.",Revenues
GATEWAY ENERGY CORP/NE,Revenues
WIKILOAN INC.,Revenues
DIVIDEND CAPITAL TOTAL REALTY TRUST INC.,Revenues
"TEMPUR SEALY INTERNATIONAL, INC.",Revenues
CURRENCYSHARES SINGAPORE DOLLAR TRUST,Revenues
"ICON LEASING FUND ELEVEN, LLC",Revenues
"SGS INTERNATIONAL, INC.",Revenues
"TIANLI AGRITECH, INC.",Revenues
TARGET HOSPITALITY CORP.,Revenues
MAGNA INTERNATIONAL INC,Revenues
"JETPADS, INC.",Revenues
LEASE EQUITY APPRECIATION FUND I LP,Revenues
"XCEL BRANDS, INC.",Revenues
Query:
SELECT *
   FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS"
   WHERE "MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
     AND "NUMBER_OF_QUARTERS" = 4
   LIMIT 100;
Answer:
Too long, hard cut:
SUBMISSION_NUMBER,COMPANY_NAME,MEASURE_TAG,VERSION,PERIOD_END_DATE,NUMBER_OF_QUARTERS,UNITS,DIMENSION_HASH,IPRX,VALUE,FOOTNOTE,FOOTNOTE_LENGTH,NUM_DIMENSIONS,COREGISTRANT,DURATION_FRACTION,DATE_FRACTION,DECIMAL
0001734342-19-000010,MERCANTIL BANK HOLDING CORP,Revenues,us-gaap/2018,20181231,4,USD,0xcb176a66f13f132d7aa4b385ddf13fa4,0,53948000.0,,0,3,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x00000000,0,2782170000.0,,0,0,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x00000000,1,2782170000.0,,0,0,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x00000000,1,2619996000.0,,0,0,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x94c1611529456c7cf3987f92ddf02327,0,1220633000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x0da7327b1af10ced5e6741fb10f10b2f,0,2782170000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0xcf4dda08fcff63db468ebc4f8f2a4859,1,510057000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0xa6cbd1e258177b2232155b49e0fdca31,0,48246000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x21a6b93f1114101b6d6cfd71a30490e7,0,40000000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20190331,4,USD,0x910994d32c9062822c83941e2fab74df,0,2782170000.0,,0,1,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x01ff1fac0d785d19db6d8f038ea2ff87,0,336157000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20170331,4,USD,0x1e75a457fea012cabd8349eae21d7067,0,143143000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20180331,4,USD,0x5526cdc987144239b630a3fae17568cb,0,110379000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20170331,4,USD,0x3af6b8aa58e8e6f01d9d27058fac3c95,0,84069000.0,,0,2,,0.01095891,0.0,-3
0001757898-19-000005,STERIS PLC,Revenues,us-gaap/2018,20170331,4,USD,0x5526cdc987144239b630a3fae17568cb,0,101654000.0,,0,2,,0.01095891,0.0,-3
0001761088-19-000044,"STWC. HOLDINGS, INC.",Revenues,us-gaap/2019,20190131,4,USD,0x00000000,0,136537.0,,0,0,,0.01095891,0.0,32767
0000092679-18-000024,SPARTON CORP,SalesRevenueNet,us-gaap/2017,20160630,4,USD,0x695ede95b63de800e4adf6c6a8454da5,0,-17273000.0,,0,1,,-0.032876015,-3.0,-3
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0x9bbdaeda1bcf0dd8c843bdc9ed30bf7c,0,0.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0xc95a3417c7ffe5c5ed5eacd57bec9626,0,3896600000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,SalesRevenueNet,us-gaap/2017,20170630,4,USD,0x6b0ba56913a97794c2fc4aef64bab125,0,-8000000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0x79f3e7f88c5e363ed833fcb2fd55b53c,0,322100000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20170630,4,USD,0x6a38719a1a103b653baa823273f460c8,0,10760400000.0,,0,1,,0.01095891,0.0,-5
0000008670-18-000011,AUTOMATIC DATA PROCESSING INC,Revenues,us-gaap/2017,20180630,4,USD,0x6c751b876743de62a8e930548722f406,0,-9400000.0,,0,1,,0.01095891,0.0,-5
0000017843-18-000047,CARPENTER TECHNOLOGY CORP,Revenues,us-gaap/2018,20180630,4,USD,0xd29a80c66d3e0156655c435124c8051f,0,383000000.0,,0,1,,0.01095891,0.0,-5
0000017843-18-000047,CARPENTER TECHNOLOGY CORP,Revenues,us-gaap/2018,20170630,4,USD,0x290267e3a75f9baee154d04d454732a4,0,1461600000.0,,0,2,,0.01095891,0.0,-5
0000017843-18-000047,CARPENTER TECHNOLOGY CORP,Revenues,us-gaap/2018,20180630,4,USD,0x1e36f745a9e890ad4acf977feb8b49ae,0,429700000.0,,0,2,,0.01095891,0.0,-5
0000021076-18-000011,CLOROX CO /DE/,Revenues,us-gaap/2018,20170630,4,USD,0xbf5bc361eff8ce6692b134c1856fde64,0,972000000.0,,0,1,,0.01095891,0.0,-6
0000021076-18-000011,CLOROX CO /DE/,Revenues,us-gaap/2018,20170630,4,USD,0x9dce50d51227e0513ed8d0fcf77e1563,0,1961000000.0,,0,2,,0.01095891,0.0,-6
0000023197-18-000076,COMTECH TELECOMMUNICATIONS CORP /DE/,Revenues,us-gaap/2018,20180731,4,USD,0x28572cec2418d30c5c4ebcf937b84089,0,0.0,,0,1,,0.01095891,0.0,0
0000023197-18-000076,COMTECH TELECOMMUNICATIONS CORP /DE/,Revenues,us-gaap/2018,20170731,4,USD,0x00000000,0,550368000.0,,0,0,,0.01095891,0.0,0
0000055242-18-000025,KENNAMETAL INC,Revenues,us-gaap/2017,20170630,4,USD,0xbb0127c7a0e84cdac40f87ad14371c5e,0,1126309000.0,,0,1,,0.01095891,0.0,-3
0000055242-18-000025,KENNAMETAL INC,Revenues,us-gaap/2017,20180630,4,USD,0x634c3a92746d0aed253d1e6a0feead6b,0,412610000.0,,0,1,,0.01095891,0.0,-3
0000055242-18-000025,KENNAMETAL INC,Revenues,us-gaap/2017,20180630,4,USD,0xbb0127c7a0e84cdac40f87ad143
Query:
SELECT n."SUBMISSION_NUMBER", n."COMPANY_NAME", n."MEASURE_TAG", n."VALUE", s."fiscal_year", s."stprba"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
LIMIT 100;
Answer:
Too long, hard cut:
SUBMISSION_NUMBER,COMPANY_NAME,MEASURE_TAG,VALUE,fiscal_year,stprba
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",SalesRevenueNet,,2016,NY
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",Revenues,,2016,NY
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",Revenues,,2016,NY
0001477932-18-000286,"CHINA GRAND RESORTS, INC.",SalesRevenueNet,,2016,NY
0001594062-18-000064,"EPOXY, INC.",Revenues,30398.0,2016,NV
0001594062-18-000064,"EPOXY, INC.",Revenues,29415.0,2016,NV
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2255235.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,3218491.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,22995123.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2814976.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2515733.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2652261.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,27097836.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2603814.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2390509.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6702566.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueGoodsNet,2760595.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2588802.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueGoodsNet,2925126.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6043863.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6043863.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueGoodsNet,2798774.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,2756882.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,6813757.0,2016,
0001144204-18-005567,"HEBRON TECHNOLOGY CO., LTD",SalesRevenueNet,16734593.0,2016,
0001157523-17-002634,"AURUM, INC.",Revenues,,2016,
0001157523-17-002634,"AURUM, INC.",Revenues,,2016,
0001185185-17-002310,ALL SOFT GELS INC,Revenues,0.0,2016,UT
0001185185-17-002310,ALL SOFT GELS INC,Revenues,0.0,2016,UT
0001498301-15-000090,"ASCENA RETAIL GROUP, INC.",SalesRevenueGoodsNet,7300000000.0,2016,NJ
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,485286783.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,265610.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4763774.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4763774.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4763774.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,5200859.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,0.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,4935249.0,2016,
0001144204-18-012903,SUNRISE REAL ESTATE GROUP INC,SalesRevenueNet,5200859.0,2016,
0001440024-18-000010,"ROADRUNNER TRANSPORTATION SYSTEMS, INC.",Revenues,252100000.0,2016,WI
0001477932-18-000290,"BLACKSANDS PETROLEUM, INC.",Revenues,,2016,CO
0001477932-18-000290,"BLACKSANDS PETROLEUM, INC.",Revenues,,2016,CO
0001477932-18-000871,"SECTOR 5, INC.",Revenues,197823.0,2016,VA
0001477932-18-000871,"SECTOR 5, INC.",Revenues,,2016,VA
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",Revenues,105775887.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,11086275.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",Revenues,343649468.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,57623925.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,35272834.0,2016,
0001144204-18-017931,"SINO AGRO FOOD, INC.",SalesRevenueGoodsNet,0.0,2016,
0001144204-18-017931,"SINO AGR
Query:
SELECT s."stprba" AS "State", SUM(n."VALUE") AS "Total_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Total_Revenue" DESC
    LIMIT 100;
Answer:
State,Total_Revenue
TX,21374377055993.0
NY,20102236969885.0
CA,17804760486480.0
IL,11620467267184.0
WA,8381872716142.0
MA,7854088261842.0
MI,7109722852786.0
MN,6586458022124.0
AR,6485940953393.0
OH,6315329135858.0
NJ,5720089294900.0
PA,5169649361193.0
GA,4632232996092.0
VA,4094668600548.65
MO,3608643044519.07
NE,3571452850643.0
NC,3196528478861.0
FL,3146795671151.0
CT,2865073264116.0
CO,2295431074688.0
TN,2085852691827.0
OK,1845249448189.0
WI,1833880413898.0
KY,1728982240485.0
IN,1557801406069.0
RI,1320266840330.0
MD,1275737926225.0
AZ,1271864593436.0
DE,1015922125750.0
ON,842971769871.0
KS,786060833952.0
NV,611253420924.0
OR,608934264468.0
AB,574998817134.0
AL,480604829301.0
IA,472864175384.0
ID,470341516256.0
LA,454001984392.0
UT,360816550073.0
QC,309839821800.0
DC,261197304000.0
SC,257001370167.0
NS,84792000000.0
HI,82320965068.0
NH,74390322000.0
BC,68381040186.0
ND,51131574472.0
NL,40546000000.0
ME,38354981963.0
SD,37791969906.0
MS,31532508161.0
AK,26990417000.0
WY,16259055639.0
VT,6448822883.0
MT,1181100626.0
WV,1130190928.0
NM,11324899.0
Query:
SELECT s."stprba" AS "State", AVG(n."VALUE") AS "Average_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Average_Revenue" DESC
    LIMIT 100;
Answer:
State,Average_Revenue
AR,17295842542.381332
NE,6105047607.936752
RI,5790644036.535088
WA,5663427510.906756
AB,4078005795.2765956
MI,3676175208.2657704
MN,3010264178.3016453
KY,2891274649.640468
NY,2477780965.1035376
DE,2335453162.643678
IL,2296988983.4322987
TN,2242852356.803226
TX,2241440546.9791317
GA,2207928024.8293614
MO,2207121128.14622
NC,1971948475.5465763
MA,1873589757.1187978
VA,1826346387.399041
NJ,1759486095.016918
OH,1749883384.8318093
QC,1721332343.3333333
ID,1697983813.198556
AL,1662992488.930796
CT,1560497420.5424836
CA,1554186494.9790504
OK,1494129107.845344
IN,1412331283.8340888
LA,1384152391.4390244
PA,1353665713.8499608
IA,1317170404.9693594
OR,1279273664.8487394
NL,1267062500.0
MD,1251950859.8871443
DC,1243796685.7142856
KS,1235944707.471698
AZ,1201005281.809254
WI,1063735738.9199536
FL,956182215.4819204
CO,867182121.1514922
ON,832976057.1847826
MS,808525850.2820513
NS,623470588.2352941
NV,586615567.1055663
SC,470698480.1593407
ND,469097013.5045872
UT,413780447.33142203
HI,384677406.8598131
NH,362879619.5121951
WY,345937354.0212766
ME,290568045.17424244
BC,276846316.5425101
SD,192816172.98979592
AK,190073359.15492958
VT,65804315.13265306
MT,34738253.705882356
WV,23545644.333333332
NM,1029536.2727272727
Query:
SELECT n."COMPANY_NAME", s."stprba" AS "State", n."VALUE" AS "Revenue"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
ORDER BY n."VALUE" DESC
LIMIT 100;
Answer:
COMPANY_NAME,State,Revenue
"YANEX GROUP, INC.",CA,
PLYZER TECHNOLOGIES INC.,ON,
SUCCESS ENTERTAINMENT GROUP INTERNATIONAL INC.,IN,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
"CHINA GRAND RESORTS, INC.",NY,
"SOLIGENIX, INC.",NJ,
SEAFARER EXPLORATION CORP,FL,
"MANSFIELD-MARTIN EXPLORATION MINING, INC.",AZ,
"FRESH PROMISE FOODS, INC.",OK,
"BIM HOMES, INC.",CA,
"CRYPTO-SERVICES, INC.",ON,
"CHINA GRAND RESORTS, INC.",NY,
"BIM HOMES, INC.",CA,
"COOL TECHNOLOGIES, INC.",FL,
"YANEX GROUP, INC.",CA,
"STR HOLDINGS, INC.",CT,
SMSA CRANE ACQUISITION CORP.,FL,
"VIVEVE MEDICAL, INC.",CA,
"ONCBIOMUNE PHARMACEUTICALS, INC",LA,
"LEGACYXCHANGE, INC.",FL,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
SMSA CRANE ACQUISITION CORP.,FL,
"SOLARWINDOW TECHNOLOGIES, INC.",MD,
HICKOK INC,OH,
"FRESH PROMISE FOODS, INC.",OK,
DOCASA INC.,IL,
"ONCBIOMUNE PHARMACEUTICALS, INC",LA,
OPTEX SYSTEMS HOLDINGS INC,TX,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
INPIXON,CA,
"OMAGINE, INC.",NY,
INPIXON,CA,
OPTEX SYSTEMS HOLDINGS INC,TX,
"PERKINS OIL & GAS, INC.",BC,
"AFH ACQUISITION IX, INC.",CA,
"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY,
PRESTIGE CAPITAL CORP,UT,
NATIONAL HOLDINGS CORP,NY,
"VIVEVE MEDICAL, INC.",CA,
"GOOD GAMING, INC.",IL,
"LEGACYXCHANGE, INC.",FL,
"PERKINS OIL & GAS, INC.",BC,
"PAYMEON, INC.",FL,
LEGACY VENTURES INTERNATIONAL INC.,NV,
GAIN CITIES LTD,FL,
"AKOUSTIS TECHNOLOGIES, INC.",NC,
NEVADA CANYON GOLD CORP.,NV,
"CHINA GRAND RESORTS, INC.",NY,
"ONCBIOMUNE PHARMACEUTICALS, INC",LA,
GOLD LAKES CORP.,OH,
"ASIA TRAINING INSTITUTE US, INC.",CA,
AVALON GLOBOCARE CORP.,NJ,
FUTURELAND CORP.,FL,
"COOL TECHNOLOGIES, INC.",FL,
PRESTIGE CAPITAL CORP,UT,
"MANSFIELD-MARTIN EXPLORATION MINING, INC.",AZ,
"GLOBAL TECH INDUSTRIES GROUP, INC.",NY,
"FRESH PROMISE FOODS, INC.",OK,
GOLD LAKES CORP.,OH,
"MAKINGORG, INC.",CA,
"OMAGINE, INC.",NY,
CONTINENTAL RAIL CORP,FL,
GAIN CITIES LTD,FL,
"SOLARWINDOW TECHNOLOGIES, INC.",MD,
INPIXON,CA,
"OIL STATES INTERNATIONAL, INC",TX,
OPTEX SYSTEMS HOLDINGS INC,TX,
CYBER APPS WORLD,NV,
OPTEX SYSTEMS HOLDINGS INC,TX,
NATURAL ALTERNATIVES INTERNATIONAL INC,CA,
OPTEX SYSTEMS HOLDINGS INC,TX,
SUCCESS ENTERTAINMENT GROUP INTERNATIONAL INC.,IN,
AMCHI GENDYNAMY SCIENCE CORP,CA,
FUTURELAND CORP.,FL,
"FRESH PROMISE FOODS, INC.",OK,
CYBER APPS WORLD,NV,
SITESTAR CORP,VA,
"MAKINGORG, INC.",CA,
HICKOK INC,OH,
"PAYMEON, INC.",FL,
SITESTAR CORP,VA,
"OIL STATES INTERNATIONAL, INC",TX,
"PAYMEON, INC.",FL,
"AFH ACQUISITION IX, INC.",CA,
"CHINA GRAND RESORTS, INC.",NY,
"OIL STATES INTERNATIONAL, INC",TX,
PLYZER TECHNOLOGIES INC.,ON,
SEAFARER EXPLORATION CORP,FL,
SITESTAR CORP,VA,
NATURAL ALTERNATIVES INTERNATIONAL INC,CA,
"VIVEVE MEDICAL, INC.",CA,
CONTINENTAL RAIL CORP,FL,
BRAVO MULTINATIONAL INC.,ON,
INTERUPS INC,NY,
"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY,
"CRYPTO-SERVICES, INC.",ON,
"SOLIGENIX, INC.",NJ,
INPIXON,CA,
"SOLIGENIX, INC.",NJ,
HICKOK INC,OH,
Query:
SELECT s."stprba" AS "State", MAX(n."VALUE") AS "Max_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Max_Revenue" DESC
    LIMIT 100;
Answer:
State,Max_Revenue
MA,597009000000.0
AR,485873000000.0
TX,394105000000.0
CA,233715000000.0
NE,223604000000.0
MN,184840000000.0
RI,177526000000.0
MI,166380000000.0
PA,146849686000.0
WA,135987000000.0
NY,131620000000.0
OH,121561000000.0
IL,117351000000.0
MO,101751800000.0
GA,94595000000.0
NC,85894000000.0
IN,84863000000.0
NJ,74331000000.0
CT,63155000000.0
KY,54379000000.0
TN,50365000000.0
MD,47248000000.0
FL,43391800000.0
WI,38749000000.0
AB,37641000000.0
ON,36445000000.0
KS,34532000000.0
OR,32376000000.0
VA,31781000000.0
DE,31360000000.0
CO,29033586000.0
AZ,27924657000.0
OK,23125000000.0
AL,19896000000.0
LA,18031000000.0
IA,17880000000.0
DC,16882400000.0
ID,16358000000.0
NV,14584000000.0
QC,12611000000.0
UT,10134400000.0
NL,6838000000.0
SC,5602000000.0
NH,5069762000.0
NS,4277000000.0
ND,4128828000.0
HI,3239542000.0
MS,2816100000.0
BC,2344392000.0
ME,1775423000.0
SD,1572974000.0
WY,1324044000.0
AK,978534000.0
VT,565030000.0
WV,155481145.0
MT,155142000.0
NM,4222000.0
Query:
SELECT s."stprba" AS "State", COUNT(DISTINCT s."central_index_key") AS "Company_Count"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    GROUP BY s."stprba"
    ORDER BY "Company_Count" DESC
    LIMIT 100;
Answer:
State,Company_Count
CA,834
NY,463
TX,449
FL,274
MA,215
PA,179
NJ,177
IL,164
CO,149
NV,133
OH,132
MN,111
VA,100
GA,93
CT,89
MD,83
AZ,80
NC,79
WA,76
MI,67
UT,66
MO,57
ON,55
WI,54
IN,49
TN,48
OK,42
BC,29
OR,27
KS,27
IA,27
KY,26
SC,22
NE,20
AR,20
LA,19
AL,19
DE,17
HI,15
RI,13
AB,11
DC,11
ID,10
SD,10
ND,9
NH,9
WV,9
QC,8
VT,7
MS,6
ME,4
AK,4
MT,4
NM,4
WY,3
NS,1
NL,1
Query:
SELECT DISTINCT s."stprba" AS "State"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" IS NOT NULL AND s."stprba" <> ''
    LIMIT 100;
Answer:
State
WI
NM
UT
NH
NS
ON
TX
CT
DE
AR
VA
IN
AK
MN
VT
AB
PA
QC
MO
NC
NL
RI
WY
LA
HI
BC
SC
OR
NJ
CO
NE
IA
DC
AL
MD
KY
ME
MS
TN
MI
OK
ID
WV
SD
NY
OH
MT
IL
CA
GA
FL
AZ
ND
WA
MA
NV
KS
Query:
SELECT n."MEASURE_TAG", COUNT(*) AS "Total_Submissions"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."NUMBER_OF_QUARTERS" = 4
    GROUP BY n."MEASURE_TAG"
    ORDER BY "Total_Submissions" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
MEASURE_TAG,Total_Submissions
NetIncomeLoss,619545
Revenues,412880
OperatingIncomeLoss,334025
ProfitLoss,321610
IncomeTaxExpenseBenefit,287683
AllocatedShareBasedCompensationExpense,262601
SalesRevenueNet,255910
ConcentrationRiskPercentage1,236550
AdjustmentsToAdditionalPaidInCapitalSharebasedCompensationRequisiteServicePeriodRecognitionValue,231416
StockIssuedDuringPeriodValueNewIssues,211398
InterestExpense,210989
PaymentsToAcquirePropertyPlantAndEquipment,199430
ShareBasedCompensation,199122
CashAndCashEquivalentsPeriodIncreaseDecrease,198886
NetCashProvidedByUsedInOperatingActivities,195573
DepreciationDepletionAndAmortization,189713
NetCashProvidedByUsedInFinancingActivities,189691
NetCashProvidedByUsedInInvestingActivities,180347
OtherComprehensiveIncomeLossNetOfTax,175690
StockIssuedDuringPeriodValueStockOptionsExercised,172559
ComprehensiveIncomeNetOfTax,171023
AntidilutiveSecuritiesExcludedFromComputationOfEarningsPerShareAmount,161013
IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments,153458
IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest,142023
RevenueFromContractWithCustomerExcludingAssessedTax,135743
GrossProfit,134514
StockIssuedDuringPeriodValueShareBasedCompensation,131295
StockIssuedDuringPeriodSharesStockOptionsExercised,130533
AmortizationOfIntangibleAssets,128312
GeneralAndAdministrativeExpense,126840
DeferredIncomeTaxExpenseBenefit,126683
OperatingExpenses,126640
IncomeLossFromEquityMethodInvestments,124461
Depreciation,122811
EarningsPerShareBasic,120005
WeightedAverageNumberOfSharesOutstandingBasic,119468
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriod,115884
EarningsPerShareDiluted,115123
OtherNonoperatingIncomeExpense,114738
WeightedAverageNumberOfDilutedSharesOutstanding,112244
RestructuringCharges,111266
EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate,109997
DepreciationAndAmortization,107572
SellingGeneralAndAdministrativeExpense,107489
OtherComprehensiveIncomeLossForeignCurrencyTransactionAndTranslationAdjustmentNetOfTax,99407
IncreaseDecreaseInAccountsReceivable,99045
InterestPaid,98575
ImpairedFinancingReceivableAverageRecordedInvestment,98452
SalesRevenueGoodsNet,98400
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsGrantsInPeriodWeightedAverageGrantDateFairValue,96439
StockIssuedDuringPeriodSharesNewIssues,96204
CurrentIncomeTaxExpenseBenefit,94058
ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsRiskFreeInterestRate,92169
NetIncomeLossAttributableToNoncontrollingInterest,88944
DividendsCommonStockCash,88342
NetIncomeLossAvailableToCommonStockholdersBasic,87012
ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsExpectedVolatilityRate,86202
PaymentsForRepurchaseOfCommonStock,85266
ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsExpectedDividendRate,85202
CurrentFederalTaxExpenseBenefit,85015
NonoperatingIncomeExpense,84687
ProceedsFromIssuanceOfCommonStock,84017
TreasuryStockValueAcquiredCostMethod,83876
IncreaseDecreaseInInventories,83459
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodGross,82312
EffectiveIncomeTaxRateContinuingOperations,81936
OtherComprehensiveIncomeLossNetOfTaxPortionAttributableToParent,81906
ComprehensiveIncomeNetOfTaxIncludingPortionAttributableToNoncontrollingInterest,81749
DeferredFederalIncomeTaxExpenseBenefit,81103
CurrentStateAndLocalTaxExpenseBenefit,81089
ResearchAndDevelopmentExpense,77934
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsVestedInPeriod,77382
ValuationAllowancesAndReservesChargedToCostAndExpense,77274
DefinedBenefitPlanNetPeriodicBenefitCost,76737
IncreaseDecreaseInAccountsPayable,76487
DefinedBenefitPlanInterestCost,76261
ShareBasedCompensationArrangementsByShareBasedPaymentAwardOptionsGrantsInPeriodWeightedAverageExercisePrice,75648
ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodWeightedAverageGrantDateFairValue,75212
EffectOfExchangeRateOnCashAndCashEquivalents,75199
IncomeTaxesPaid,74017
ValuationAllowancesAndReservesDeductions,73434
DeferredStateAndLocalIncomeTaxExpenseBenefit,72403
NetCashProvidedByUsedInOperatingActivitiesContinuingOperations,72373
RepaymentsOfLongTermDebt,71825
CostsAndExpenses,71788
PaymentsToAcquireBusinessesNetOfCashAcquired,71385
ProceedsFromStockOptionsExercised,71012
IncreaseDecreaseInPrepaidDeferredExpenseAndOtherAssets,70506
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsForfeitedInPeriod,70329
IncomeTaxReconciliationIncomeTaxExpenseBenefitAtFederalStatutoryIncomeTaxRate,70216
StockIssuedDuringPeriodValueIssuedForServices,69208
StockIssuedDuringPeriodValueConversionOfConvertibleSecurities,68859
LeaseAndRentalExpense,68781
DefinedBenefitPlanServiceCost,6873
Query:
SELECT DISTINCT n."UNITS"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
    LIMIT 100;
Answer:
UNITS
PHP
DKK
EUR
USD
CAD
CHF
EGP
AFN
MXN
JPY
PLN
TWD
CNY
RUB
BRL
KRW
ILS
INR
HKD
MYR
THB
AUD
GBP
Query:
SELECT s."stprba" AS "State", s."sic", sc."industry_title", SUM(n."VALUE") AS "Total_Revenue"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
      ON n."SUBMISSION_NUMBER" = s."submission_number"
    JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SIC_CODES" AS sc
      ON s."sic" = sc."sic_code"
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."NUMBER_OF_QUARTERS" = 4
      AND s."fiscal_year" = 2016
      AND s."stprba" = 'CA'  -- Replace 'CA' with the top state after analysis
    GROUP BY s."stprba", s."sic", sc."industry_title"
    ORDER BY "Total_Revenue" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
State,sic,industry_title,Total_Revenue
CA,4953,REFUSE SYSTEMS,
CA,3990,MISCELLANEOUS MANUFACTURING INDUSTRIES,
CA,2721,PERIODICALS: PUBLISHING OR PUBLISHING & PRINTING,
CA,2000,FOOD AND KINDRED PRODUCTS,
CA,5400,RETAIL-FOOD STORES,
CA,3523,FARM MACHINERY & EQUIPMENT,
CA,3630,HOUSEHOLD APPLIANCES,
CA,5122,"WHOLESALE-DRUGS, PROPRIETARIES & DRUGGISTS' SUNDRIES",2833747724259.0
CA,3571,ELECTRONIC COMPUTERS,2577695053770.0
CA,3570,COMPUTER & OFFICE EQUIPMENT,1803592000000.0
CA,3674,SEMICONDUCTORS & RELATED DEVICES,1119093217480.0
CA,3576,COMPUTER COMMUNICATIONS EQUIPMENT,1022636209000.0
CA,7372,SERVICES-PREPACKAGED SOFTWARE,1012471846949.0
CA,7370,"SERVICES-COMPUTER PROGRAMMING, DATA PROCESSING, ETC.",836943525000.0
CA,2836,"BIOLOGICAL PRODUCTS, (NO DISGNOSTIC SUBSTANCES)",757604563826.0
CA,4841,CABLE & OTHER PAY TELEVISION SERVICES,540197000000.0
CA,2911,PETROLEUM REFINING,464919000000.0
CA,3572,COMPUTER STORAGE DEVICES,280547659000.0
CA,3663,RADIO & TV BROADCASTING & COMMUNICATIONS EQUIPMENT,260578088904.0
CA,5651,RETAIL-FAMILY CLOTHING STORES,226840433000.0
CA,6324,HOSPITAL & MEDICAL SERVICE PLANS,224429000000.0
CA,7389,"SERVICES-BUSINESS SERVICES, NEC",206386256022.0
CA,5045,WHOLESALE-COMPUTERS & PERIPHERAL EQUIPMENT & SOFTWARE,206075340000.0
CA,5141,"WHOLESALE-GROCERIES, GENERAL LINE",153195737000.0
CA,6798,REAL ESTATE INVESTMENT TRUSTS,148332238677.0
CA,3826,LABORATORY ANALYTICAL INSTRUMENTS,144181161290.0
CA,1600,HEAVY CONSTRUCTION OTHER THAN BLDG CONST - CONTRACTORS,137835424121.0
CA,6500,REAL ESTATE,136075331096.0
CA,4931,ELECTRIC & OTHER SERVICES COMBINED,103177000000.0
CA,4932,GAS & OTHER SERVICES COMBINED,100308153000.0
CA,3842,"ORTHOPEDIC, PROSTHETIC & SURGICAL APPLIANCES & SUPPLIES",87943438000.0
CA,3672,PRINTED CIRCUIT BOARDS,81069728416.0
CA,4911,ELECTRIC SERVICES,75452835938.0
CA,7900,SERVICES-AMUSEMENT & RECREATION SERVICES,74945228768.0
CA,2300,APPAREL & OTHER FINISHD PRODS OF FABRICS & SIMILAR MATL,70776725000.0
CA,7373,SERVICES-COMPUTER INTEGRATED SYSTEMS DESIGN,64132685327.0
CA,1531,OPERATIVE BUILDERS,64093393000.0
CA,6361,TITLE INSURANCE,62241994000.0
CA,2842,"SPECIALTY CLEANING, POLISHING AND SANITATION PREPARATIONS",62206000000.0
CA,6141,PERSONAL CREDIT INSTITUTIONS,61742000000.0
CA,6282,INVESTMENT ADVICE,61722796000.0
CA,2670,CONVERTED PAPER & PAPERBOARD PRODS (NO CONTANERS/BOXES),60249700000.0
CA,5094,"WHOLESALE-JEWELRY, WATCHES, PRECIOUS STONES & METALS",59255496000.0
CA,5051,WHOLESALE-METALS SERVICE CENTERS & OFFICES,57262600000.0
CA,3845,ELECTROMEDICAL & ELECTROTHERAPEUTIC APPARATUS,55665802037.0
CA,3711,MOTOR VEHICLES & PASSENGER CAR BODIES,55487368237.0
CA,3823,"INDUSTRIAL INSTRUMENTS FOR MEASUREMENT, DISPLAY, AND CONTROL",53739000000.0
CA,3577,"COMPUTER PERIPHERAL EQUIPMENT, NEC",53558721000.0
CA,6021,NATIONAL COMMERCIAL BANKS,49232201000.0
CA,7812,SERVICES-MOTION PICTURE & VIDEO TAPE PRODUCTION,47983226274.0
CA,3829,"MEASURING & CONTROLLING DEVICES, NEC",46402086251.0
CA,3841,SURGICAL & MEDICAL INSTRUMENTS & APPARATUS,44987927117.0
CA,5700,"RETAIL-HOME FURNITURE, FURNISHINGS & EQUIPMENT STORES",44275863000.0
CA,7841,SERVICES-VIDEO TAPE RENTAL,42229730422.0
CA,3812,"SEARCH, DETECTION, NAVAGATION, GUIDANCE, AERONAUTICAL SYS",41906261000.0
CA,6211,"SECURITY BROKERS, DEALERS & FLOTATION COMPANIES",39832000000.0
CA,5072,WHOLESALE-HARDWARE,38926312000.0
CA,2834,PHARMACEUTICAL PREPARATIONS,37839890671.0
CA,5812,RETAIL-EATING PLACES,37546235000.0
CA,3661,TELEPHONE & TELEGRAPH APPARATUS,35144600854.0
CA,3559,"SPECIAL INDUSTRY MACHINERY, NEC",34794522000.0
CA,3827,OPTICAL INSTRUMENTS & LENSES,32850632000.0
CA,2086,BOTTLED & CANNED SOFT DRINKS & CARBONATED WATERS,32132717000.0
CA,3140,"FOOTWEAR, (NO RUBBER)",30993885000.0
CA,7374,SERVICES-COMPUTER PROCESSING & DATA PREPARATION,30197112262.0
CA,5331,RETAIL-VARIETY STORES,30180477909.0
CA,5190,WHOLESALE-MISCELLANEOUS NONDURABLE GOODS,28129245000.0
CA,3760,GUIDED MISSILES & SPACE VEHICLES & PARTS,28038600000.0
CA,6199,FINANCE SERVICES,27608396000.0
CA,3851,OPHTHALMIC GOODS,27087976000.0
CA,2340,"WOMEN'S, MISSES', CHILDREN'S & INFANTS' UNDERGARMENTS",26713763365.0
CA,5411,RETAIL-GROCERY STORES,23694038000.0
CA,3942,DOLLS & STUFFED TOYS,23583082000.0
CA,3578,CALCULATING & ACCOUNTING MACHINES (NO ELECTRONIC COMPUTERS),21309690000.0
CA,3350,ROLLING DRAWING & EXTRUDING OF NONFERROUS METALS,20393000000.0
CA,4832,RADIO BROADCASTING STATIONS,18991329000.0
CA,7371,SERVICES-COMPUTER PROGRAMMING SERVICES,16747866000.0
CA,6794,PATENT OWNERS & LESSORS,15294859140.0
CA,5712,RETAIL-FURNITURE STORES,14357469000.0
CA,7363,SERVICES-HELP SUPPLY SERVICES,13203951000.0
CA,4899,"COMMUNICATIONS SERVICES, NEC",13155198788.0
CA,3669,"COMMUNICATIONS EQUIPMENT, NEC",12817015068.0
CA,3021,RUBBER & PLASTICS FOOTWEAR,12548802000.0
CA,7359,"SERVICES-EQUIPMENT RENTAL & LEASING, NEC",12492766749.0
CA,5961,RETAIL-CATALOG & MAIL-ORDER HOUSES,12478590000.0
CA,5063,"WHOLESALE-ELECTRICAL APPARATUS & EQUIPMENT, WIRING SUPPLIES",11940730000.0
CA,8071,SERVICES-MEDICAL LABORATORIES,1
Query:
SELECT n."VALUE" AS "Revenue", n."COMPANY_NAME", s."stprba" AS "State"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" AS s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
ORDER BY n."VALUE" DESC
LIMIT 100;
Answer:
Revenue,COMPANY_NAME,State
,GOLD LAKES CORP.,OH
,LEGACY VENTURES INTERNATIONAL INC.,NV
,"SOLIGENIX, INC.",NJ
,CYBER APPS WORLD,NV
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,"YANEX GROUP, INC.",CA
,"VIVEVE MEDICAL, INC.",CA
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,AMANASU ENVIRONMENT CORP,NY
,INPIXON,CA
,FUTURELAND CORP.,FL
,OPTEX SYSTEMS HOLDINGS INC,TX
,WOODLAND HOLDINGS CORP,TN
,WOODLAND HOLDINGS CORP,TN
,"OIL STATES INTERNATIONAL, INC",TX
,HEMCARE HEALTH SERVICES INC.,FL
,OPTEX SYSTEMS HOLDINGS INC,TX
,"VIVEVE MEDICAL, INC.",CA
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,"PAYMEON, INC.",FL
,"AKOUSTIS TECHNOLOGIES, INC.",NC
,"CRYPTO-SERVICES, INC.",ON
,PREMIER BIOMEDICAL INC,TX
,NATURAL ALTERNATIVES INTERNATIONAL INC,CA
,"OIL STATES INTERNATIONAL, INC",TX
,DOCASA INC.,IL
,NEVADA CANYON GOLD CORP.,NV
,CONTINENTAL RAIL CORP,FL
,"MAKINGORG, INC.",CA
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,"SOLIGENIX, INC.",NJ
,PRO DEX INC,CA
,PIVOT PHARMACEUTICALS INC.,BC
,"BALANCE LABS, INC.",FL
,"OMAGINE, INC.",NY
,"CYBERFORT SOFTWARE, INC.",CA
,"CRYPTO-SERVICES, INC.",ON
,WOODLAND HOLDINGS CORP,TN
,"LEGACYXCHANGE, INC.",FL
,"YANEX GROUP, INC.",CA
,"PAYMEON, INC.",FL
,"BIM HOMES, INC.",CA
,"GOOD GAMING, INC.",IL
,INPIXON,CA
,"OIL STATES INTERNATIONAL, INC",TX
,"BIM HOMES, INC.",CA
,"PERKINS OIL & GAS, INC.",BC
,"OMAGINE, INC.",NY
,"COOL TECHNOLOGIES, INC.",FL
,"AKOUSTIS TECHNOLOGIES, INC.",NC
,SITESTAR CORP,VA
,NATURAL ALTERNATIVES INTERNATIONAL INC,CA
,INPIXON,CA
,"AFH ACQUISITION IX, INC.",CA
,CYBER APPS WORLD,NV
,FUTURELAND CORP.,FL
,NATIONAL HOLDINGS CORP,NY
,PRESTIGE CAPITAL CORP,UT
,"AFH ACQUISITION IX, INC.",CA
,INTERUPS INC,NY
,PRO DEX INC,CA
,"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY
,"MAKINGORG, INC.",CA
,"GLOBAL TECH INDUSTRIES GROUP, INC.",NY
,"ROYAL HAWAIIAN ORCHARDS, L.P.",HI
,SITESTAR CORP,VA
,LIBERTY STAR URANIUM & METALS CORP.,AZ
,OPTEX SYSTEMS HOLDINGS INC,TX
,QUANTUM MATERIALS CORP.,TX
,"COOL TECHNOLOGIES, INC.",FL
,INPIXON,CA
,OPTEX SYSTEMS HOLDINGS INC,TX
,"ICAGEN, INC.",NC
,AMCHI GENDYNAMY SCIENCE CORP,CA
,LIBERTY STAR URANIUM & METALS CORP.,AZ
,OPTEX SYSTEMS HOLDINGS INC,TX
,PREMIER BIOMEDICAL INC,TX
,"LINDBLAD EXPEDITIONS HOLDINGS, INC.",NY
,"CYBERFORT SOFTWARE, INC.",CA
,"PAYMEON, INC.",FL
,CONTINENTAL RAIL CORP,FL
,"PERKINS OIL & GAS, INC.",BC
,PLYZER TECHNOLOGIES INC.,ON
,"VIVEVE MEDICAL, INC.",CA
,"SOLIGENIX, INC.",NJ
,PLYZER TECHNOLOGIES INC.,ON
,GOLD LAKES CORP.,OH
,"LEGACYXCHANGE, INC.",FL
,"SOLARWINDOW TECHNOLOGIES, INC.",MD
,SITESTAR CORP,VA
,SEAFARER EXPLORATION CORP,FL
,SEAFARER EXPLORATION CORP,FL
,"ASIA TRAINING INSTITUTE US, INC.",CA
,GAIN CITIES LTD,FL
,"SOLARWINDOW TECHNOLOGIES, INC.",MD
,AVALON GLOBOCARE CORP.,NJ
,AMANASU ENVIRONMENT CORP,NY
,HEMCARE HEALTH SERVICES INC.,FL
,PIVOT PHARMACEUTICALS INC.,BC
,PRESTIGE CAPITAL CORP,UT
Query:
SELECT DISTINCT n."UNITS"
    FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" AS n
    WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
      AND n."UNITS" <> 'USD'
    LIMIT 100;
Answer:
UNITS
PHP
EUR
DKK
CAD
CHF
AFN
EGP
MXN
JPY
PLN
AUD
GBP
BRL
THB
TWD
CNY
HKD
MYR
INR
RUB
KRW
ILS
End Exploring Related Columns
Task: Which U.S. state reported the highest total annual revenue in billions of dollars during fiscal year 2016, considering companies that provided four quarters of data and reported measure tags in ('Revenues','SalesRevenueNet','SalesRevenueGoodsNet'), excluding any entries where the state field (stprba) is null or empty?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
State,Total_Revenue_Billions_USD
state_name:str,revenue:float
(Attention: answer in one row)
```

The table above identifies the U.S. state (`State`) with the highest total annual revenue, in billions of dollars (`Total_Revenue_Billions_USD`), for fiscal year 2016. This considers companies that provided data for all four quarters and reported measure tags among 'Revenues', 'SalesRevenueNet', or 'SalesRevenueGoodsNet', excluding entries where the state field (`stprba`) is null or empty..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'SEC_QUARTERLY_FINANCIALS': {'SEC_QUARTERLY_FINANCIALS': ['PRESENTATION', 'QUICK_SUMMARY', 'MEASURE_TAG', 'NUMBERS', 'SUBMISSION', 'RENDERING', 'TXT', 'CALCULATION', 'DIMENSION', 'SIC_CODES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 20:04:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:04:37 - root - INFO - ```sql
SELECT s."stprba" AS "State", SUM(n."VALUE") / 1000000000 AS "Total_Revenue_Billions_USD"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
GROUP BY s."stprba"
ORDER BY "Total_Revenue_Billions_USD" DESC
LIMIT 1;
```

And the result would be:

```csv
State,Total_Revenue_Billions_USD
TX,21374.377055993
```
2025-02-11 20:04:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:04:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:04:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:04:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 20:04:39 - snowflake.connector.connection - INFO - closed
2025-02-11 20:04:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:04:39 - root - INFO - itercount: 1
2025-02-11 20:04:39 - root - INFO - 0
2025-02-11 20:04:39 - root - INFO - results: 
State,Total_Revenue_Billions_USD
TX,21374.377055993


2025-02-11 20:04:39 - root - INFO - Please check the answer again by reviewing Which U.S. state reported the highest total annual revenue in billions of dollars during fiscal year 2016, considering companies that provided four quarters of data and reported measure tags in ('Revenues','SalesRevenueNet','SalesRevenueGoodsNet'), excluding any entries where the state field (stprba) is null or empty?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State,Total_Revenue_Billions_USD
state_name:str,revenue:float
(Attention: answer in one row)
```

The table above identifies the U.S. state (`State`) with the highest total annual revenue, in billions of dollars (`Total_Revenue_Billions_USD`), for fiscal year 2016. This considers companies that provided data for all four quarters and reported measure tags among 'Revenues', 'SalesRevenueNet', or 'SalesRevenueGoodsNet', excluding entries where the state field (`stprba`) is null or empty. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Total_Revenue_Billions_USD
TX,21374.377055993
Current sql:
SELECT s."stprba" AS "State", SUM(n."VALUE") / 1000000000 AS "Total_Revenue_Billions_USD"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
GROUP BY s."stprba"
ORDER BY "Total_Revenue_Billions_USD" DESC
LIMIT 1;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-11 20:05:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:05:02 - root - INFO - ```sql
SELECT s."stprba" AS "State", ROUND(SUM(n."VALUE") / 1000000000, 4) AS "Total_Revenue_Billions_USD"
FROM "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."NUMBERS" n
JOIN "SEC_QUARTERLY_FINANCIALS"."SEC_QUARTERLY_FINANCIALS"."SUBMISSION" s
  ON n."SUBMISSION_NUMBER" = s."submission_number"
WHERE n."MEASURE_TAG" IN ('Revenues', 'SalesRevenueNet', 'SalesRevenueGoodsNet')
  AND n."NUMBER_OF_QUARTERS" = 4
  AND s."fiscal_year" = 2016
  AND s."stprba" IS NOT NULL AND s."stprba" <> ''
GROUP BY s."stprba"
ORDER BY "Total_Revenue_Billions_USD" DESC NULLS LAST
LIMIT 1;
```

Result:

```csv
State,Total_Revenue_Billions_USD
TX,21374.3771
```
2025-02-11 20:05:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:05:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:05:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:05:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 20:05:03 - snowflake.connector.connection - INFO - closed
2025-02-11 20:05:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:05:04 - root - INFO - itercount: 2
2025-02-11 20:05:04 - root - INFO - 0
2025-02-11 20:05:04 - root - INFO - Total iteration counts: 2
