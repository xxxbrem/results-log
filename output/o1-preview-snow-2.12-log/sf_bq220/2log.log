2025-02-11 23:01:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:01:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-02-11 23:01:38 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:01:39 - root - INFO - SQL:
SELECT DISTINCT "evaluation_type"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE"
   LIMIT 100;
Results:
evaluation_type
EXPGROW
EXPREMV
EXPMORT
EXPCURR
EXPVOL
EXPALL
EXPCHNG
EXPREGEN
EXPDWM
EXPCRWN
EXPINV
EXPP2VEG
EXPGRNDLYR

2025-02-11 23:01:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 23:01:40 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:01:40 - root - INFO - SQL:
SELECT COUNT(*) AS "num_records"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "condition_status_code" = 1;
Results:
num_records
793241

2025-02-11 23:01:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 51
2025-02-11 23:01:41 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:01:42 - root - INFO - SQL:
SELECT DISTINCT "inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   ORDER BY "inventory_year" ASC
   LIMIT 100;
Results:
inventory_year
1968
1970
1972
1974
1975
1976
1977
1978
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
9999

2025-02-11 23:01:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:01:43 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:01:43 - root - INFO - SQL:
SELECT "condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "condition_status_code" = 1
   LIMIT 100;
Results:
condition_proportion_unadjusted
0.75
1.0
0.18790200352668762
1.0
0.25
0.7734119892120361
0.75
0.11390700191259384
0.75
0.5
1.0
1.0
1.0
1.0
1.0
0.75
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.25
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.25
0.75
0.25
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.25
0.75
0.25
0.75
1.0
1.0
0.5
0.5
0.5
0.75
0.3970780074596405
0.75
0.75
0.75
0.75
0.25
0.5
0.25
1.0
0.75
1.0
1.0
1.0
1.0
0.25
1.0
0.8448169827461243
1.0
0.5
1.0
0.5161150097846985
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0

2025-02-11 23:01:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-11 23:01:44 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:01:45 - root - INFO - SQL:
SELECT DISTINCT "proportion_basis"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   LIMIT 100;
Results:
proportion_basis
SUBP
MACR
""

2025-02-11 23:01:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:01:46 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:01:46 - root - INFO - SQL:
SELECT DISTINCT "expansion_factor"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM"
   LIMIT 100;
Results:
expansion_factor
91039.0
97500.2015991211
97826.0
98934.0
101265.0
101850.0
103636.0
110693.0
118521.0
122971.0
142043.0
142403.0
168646.90014648438
183254.0
196501.0
197403.0
197919.79736328125
205188.0
231703.0
236261.0
242702.0
246691.0
253058.0
255419.0
8544.999877929688
3258.276123046875
10079.999755859375
10321.0
11259.90005493164
11919.999816894531
13591.400230407715
14000.000366210938
14290.000213623047
17058.300006866455
17180.00079345703
27602.0
28340.0
31343.0
36496.0
52410.0
11397.9384765625
55.0
9577.00390625
199191.0
262723.29998779297
12700.0
15438.50040435791
19176.0
22802.0
27720.0
10912.638671875
42763.0
327362.7009277344
444199.0
605838.4000091553
994640.0
56315.49932861328
230.0
5080.000022888184
423013.0
49960.1015625
7865.0
186866.0
8891.000030517578
12424.99997329712
12930.699951171875
17236.0
17835.00018310547
20537.0
3944.0
36930.10014343262
285376.0
9571.185546875
587281.0
65383.49920654297
7510.49755859375
750.0
1620.0
1623.0
2769.9999771118164
7865.458984375
7090.0
219325.0989227295
9430.0
9445.0
10718.800104141235
10800.000122070312
5585.6162109375
18473.200241088867
20110.0
20647.0
21870.0
23029.0
23170.0
23317.90069580078
25999.99951171875
28215.99920654297
28287.0
29464.0
32405.099609375

2025-02-11 23:01:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:01:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:01:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:01:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:01:47 - snowflake.connector.connection - INFO - closed
2025-02-11 23:01:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:02:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:02:49 - root - INFO - ```sql
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."proportion_basis",
        c."inventory_year",
        p."plot_state_code_name" AS "state",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s",
        ps."adjustment_factor_for_the_macroplot" AS "A_m"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
        ON ps."evaluation_sequence_number" = e."evaluation_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND e."evaluation_type" = 'EXPCURR'
        AND c."inventory_year" IN (2015, 2016, 2017)
),
subplot_sizes AS (
    SELECT
        c."inventory_year" AS "Year",
        c."state" AS "State",
        (c."E" * c."P" * c."A_s") AS "Average_Size"
    FROM condition_data c
    WHERE
        c."proportion_basis" = 'SUBP'
        AND c."A_s" IS NOT NULL
        AND c."A_s" > 0
),
macroplot_sizes AS (
    SELECT
        c."inventory_year" AS "Year",
        c."state" AS "State",
        (c."E" * c."P" * c."A_m") AS "Average_Size"
    FROM condition_data c
    WHERE
        c."proportion_basis" = 'MACR'
        AND c."A_m" IS NOT NULL
        AND c."A_m" > 0
),
max_avg_subplot_size AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM (
        SELECT
            'subplot' AS "Type",
            "Year",
            "State",
            AVG("Average_Size") AS "Average_Size"
        FROM subplot_sizes
        GROUP BY "Year", "State"
    )
),
max_avg_macroplot_size AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM (
        SELECT
            'macroplot' AS "Type",
            "Year",
            "State",
            AVG("Average_Size") AS "Average_Size"
        FROM macroplot_sizes
        GROUP BY "Year", "State"
    )
)
SELECT "Type", "Year", "State", "Average_Size"
FROM (
    SELECT "Type", "Year", "State", "Average_Size"
    FROM max_avg_subplot_size
    WHERE "Rank" = 1
    UNION ALL
    SELECT "Type", "Year", "State", "Average_Size"
    FROM max_avg_macroplot_size
    WHERE "Rank" = 1
)
ORDER BY "Type", "Year";
```
2025-02-11 23:02:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:02:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:02:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:02:50 - snowflake.connector.connection - INFO - closed
2025-02-11 23:02:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:03:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:03:31 - root - INFO - I apologize for the error in the previous SQL query. The issue arises because the column `"evaluation_sequence_number"` does not exist in the `"POPULATION_STRATUM"` table. Instead, we should use the `"evaluation_identifier"` from `"POPULATION_STRATUM"` to join with the `"evaluation_sequence_number"` in `"POPULATION_EVALUATION_TYPE"`.

Here is the corrected SQL query:

```sql
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."proportion_basis",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s",
        ps."adjustment_factor_for_the_macroplot" AS "A_m"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
        ON ps."evaluation_identifier" = e."evaluation_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND e."evaluation_type" = 'EXPCURR'
        AND c."inventory_year" IN (2015, 2016, 2017)
),
subplot_sizes AS (
    SELECT
        c."inventory_year" AS "Year",
        c."State",
        (c."E" * c."P" * c."A_s") AS "Size"
    FROM condition_data c
    WHERE
        c."proportion_basis" = 'SUBP'
        AND c."A_s" IS NOT NULL
        AND c."A_s" > 0
),
macroplot_sizes AS (
    SELECT
        c."inventory_year" AS "Year",
        c."State",
        (c."E" * c."P" * c."A_m") AS "Size"
    FROM condition_data c
    WHERE
        c."proportion_basis" = 'MACR'
        AND c."A_m" IS NOT NULL
        AND c."A_m" > 0
),
max_avg_subplot_size AS (
    SELECT
        'subplot' AS "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Year" ORDER BY AVG("Size") DESC) AS "Rank"
    FROM subplot_sizes
    GROUP BY "Year", "State"
),
max_avg_macroplot_size AS (
    SELECT
        'macroplot' AS "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Year" ORDER BY AVG("Size") DESC) AS "Rank"
    FROM macroplot_sizes
    GROUP BY "Year", "State"
)
SELECT "Type", "Year", "State", "Average_Size"
FROM (
    SELECT "Type", "Year", "State", "Average_Size"
    FROM max_avg_subplot_size
    WHERE "Rank" = 1
    UNION ALL
    SELECT "Type", "Year", "State", "Average_Size"
    FROM max_avg_macroplot_size
    WHERE "Rank" = 1
) AS combined_results
ORDER BY "Type", "Year";
```

**Explanation:**

- **Issue Correction:**
  - The error occurred because `"evaluation_sequence_number"` does not exist in `"POPULATION_STRATUM"`.
  - I corrected the join condition to use `"evaluation_identifier"` from `"POPULATION_STRATUM"` to join with `"evaluation_sequence_number"` in `"POPULATION_EVALUATION_TYPE"`.

- **Query Breakdown:**

  - **`condition_data` CTE:**
    - Joins the `CONDITION`, `PLOT`, `POPULATION_STRATUM_ASSIGN`, `POPULATION_STRATUM`, and `POPULATION_EVALUATION_TYPE` tables.
    - Filters records where:
      - `"condition_status_code"` = 1.
      - `"evaluation_type"` = `'EXPCURR'`.
      - `"inventory_year"` IN (2015, 2016, 2017).
    - Selects necessary columns for size calculations:
      - **E**: `"expansion_factor"`.
      - **P**: `"condition_proportion_unadjusted"`.
      - **A_s**: `"adjustment_factor_for_the_subplot"`.
      - **A_m**: `"adjustment_factor_for_the_macroplot"`.
  
  - **`subplot_sizes` and `macroplot_sizes` CTEs:**
    - Calculate sizes for subplots and macroplots using the formulas:
      - **Subplot Size**: \( \text{Size} = E \times P \times A_s \).
      - **Macroplot Size**: \( \text{Size} = E \times P \times A_m \).
    - Include only records where:
      - **Proportion Basis** matches ('SUBP' for subplots, 'MACR' for macroplots).
      - **Adjustment Factors** are greater than 0.
  
  - **`max_avg_subplot_size` and `max_avg_macroplot_size` CTEs:**
    - Group by `"Year"` and `"State"`, calculating the average size.
    - Rank states by average size in descending order for each year.
  
  - **Final SELECT Statement:**
    - Combines the top-ranked states for subplots and macroplots for each year.
    - Orders results by `"Type"` and `"Year"`.

This corrected query should execute without errors and provide the states with the largest average subplot and macroplot sizes for each of the years 2015, 2016, and 2017.

**Note:** Ensure that all referenced columns exist in the respective tables, and adjust any column names if necessary based on your database schema.
2025-02-11 23:03:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:03:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:03:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:03:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 23:03:33 - snowflake.connector.connection - INFO - closed
2025-02-11 23:03:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:04:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:04:32 - root - INFO - ```sql
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."proportion_basis",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s",
        ps."adjustment_factor_for_the_macroplot" AS "A_m"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
),
size_calculations AS (
    SELECT
        CASE WHEN c."proportion_basis" = 'SUBP' THEN 'subplot' ELSE 'macroplot' END AS "Type",
        c."inventory_year" AS "Year",
        c."State",
        (c."E" * c."P" *
        CASE WHEN c."proportion_basis" = 'SUBP' THEN c."A_s"
             ELSE c."A_m" END) AS "Size"
    FROM condition_data c
    WHERE
        ((c."proportion_basis" = 'SUBP' AND c."A_s" IS NOT NULL AND c."A_s" > 0)
         OR
         (c."proportion_basis" = 'MACR' AND c."A_m" IS NOT NULL AND c."A_m" > 0))
),
max_avg_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY AVG("Size") DESC) AS "Rank"
    FROM size_calculations
    GROUP BY "Type", "Year", "State"
)
SELECT "Type", "Year", "State", "Average_Size"
FROM max_avg_sizes
WHERE "Rank" = 1
ORDER BY "Type", "Year";
```
2025-02-11 23:04:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:04:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:04:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:04:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-02-11 23:04:33 - snowflake.connector.connection - INFO - closed
2025-02-11 23:04:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:05:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:05:36 - root - INFO - SQL:
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."proportion_basis",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s",
        ps."adjustment_factor_for_the_macroplot" AS "A_m"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
),
size_calculations AS (
    SELECT
        CASE WHEN c."proportion_basis" = 'SUBP' THEN 'subplot' ELSE 'macroplot' END AS "Type",
        c."inventory_year" AS "Year",
        c."State",
        (c."E" * c."P" *
        CASE WHEN c."proportion_basis" = 'SUBP' THEN c."A_s"
             ELSE c."A_m" END) AS "Size"
    FROM condition_data c
    WHERE
        ((c."proportion_basis" = 'SUBP' AND c."A_s" IS NOT NULL AND c."A_s" > 0)
         OR
         (c."proportion_basis" = 'MACR' AND c."A_m" IS NOT NULL AND c."A_m" > 0))
),
max_avg_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY AVG("Size") DESC) AS "Rank"
    FROM size_calculations
    GROUP BY "Type", "Year", "State"
)
SELECT "Type", "Year", "State", "Average_Size"
FROM max_avg_sizes
WHERE "Rank" = 1
ORDER BY "Type", "Year";
Results:
Type,Year,State,Average_Size
macroplot,2015,California,5499.514912801828
macroplot,2016,California,5671.46321799773
macroplot,2017,California,5626.774530176067
subplot,2015,Maryland,10704.67385403049
subplot,2016,Connecticut,12248.79969241094
subplot,2017,Iowa,11712.025040553008

2025-02-11 23:05:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:05:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:05:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:05:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:05:37 - snowflake.connector.connection - INFO - closed
2025-02-11 23:05:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:05:37 - root - INFO - SQL:
SELECT c."condition_status_code", p."plot_state_code_name", c."inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
   JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
     ON c."plot_sequence_number" = p."plot_sequence_number"
   WHERE c."condition_status_code" = 1
   LIMIT 100;
Results:
condition_status_code,plot_state_code_name,inventory_year
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003

2025-02-11 23:05:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:05:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:05:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:05:38 - snowflake.connector.connection - INFO - closed
2025-02-11 23:05:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:06:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:06:02 - root - INFO - ```sql
SELECT DISTINCT p."plot_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
  ON e."evaluation_sequence_number" = ps."evaluation_identifier"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
  ON ps."stratum_sequence_number" = psa."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
  ON psa."plot_sequence_number" = p."plot_sequence_number"
WHERE e."evaluation_type" = 'EXPCURR'
LIMIT 100;
```
2025-02-11 23:06:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:06:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:06:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:06:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 23:06:04 - snowflake.connector.connection - INFO - closed
2025-02-11 23:06:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:06:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:06:57 - root - INFO - ```sql
WITH size_data AS (
    SELECT
        CASE WHEN c."proportion_basis" = 'SUBP' THEN 'subplot' ELSE 'macroplot' END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" *
            CASE WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                 ELSE ps."adjustment_factor_for_the_macroplot" END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    LEFT JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
      ON c."plot_sequence_number" = p."plot_sequence_number"
    LEFT JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    LEFT JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE c."condition_status_code" = 1
      AND c."inventory_year" IN (2015, 2016, 2017)
      AND (
        (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
        OR
        (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
      )
),
average_sizes AS (
    SELECT "Type", "Year", "State", AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_sizes AS (
    SELECT
        "Type", "Year", "State", "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM average_sizes
)
SELECT "Type", "Year", "State", "Average_Size"
FROM ranked_sizes
WHERE "Rank" = 1
ORDER BY "Type", "Year";
```
2025-02-11 23:06:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:06:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:06:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:06:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-02-11 23:06:59 - snowflake.connector.connection - INFO - closed
2025-02-11 23:06:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:08:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:08:12 - root - INFO - SQL:
WITH size_data AS (
    SELECT
        CASE WHEN c."proportion_basis" = 'SUBP' THEN 'subplot' ELSE 'macroplot' END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" *
            CASE WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                 ELSE ps."adjustment_factor_for_the_macroplot" END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    LEFT JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
      ON c."plot_sequence_number" = p."plot_sequence_number"
    LEFT JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    LEFT JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE c."condition_status_code" = 1
      AND c."inventory_year" IN (2015, 2016, 2017)
      AND (
        (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
        OR
        (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
      )
),
average_sizes AS (
    SELECT "Type", "Year", "State", AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_sizes AS (
    SELECT
        "Type", "Year", "State", "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM average_sizes
)
SELECT "Type", "Year", "State", "Average_Size"
FROM ranked_sizes
WHERE "Rank" = 1
ORDER BY "Type", "Year";
Results:
Type,Year,State,Average_Size
macroplot,2015,California,5499.514912801828
macroplot,2016,California,5671.46321799773
macroplot,2017,California,5626.774530176067
subplot,2015,Maryland,10704.67385403049
subplot,2016,,23424.251869856012
subplot,2017,Iowa,11712.025040553006

2025-02-11 23:08:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:08:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:08:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:08:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 23:08:13 - snowflake.connector.connection - INFO - closed
2025-02-11 23:08:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:08:14 - root - INFO - SQL:
SELECT DISTINCT "plot_state_code", "plot_state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    LIMIT 100;
Results:
plot_state_code,plot_state_code_name
10,Delaware
8,Colorado
64,Federated States of Micronesia
60,American Samoa
41,Oregon
6,California
70,Palau
34,New Jersey
50,Vermont
40,Oklahoma
24,Maryland
30,Montana
21,Kentucky
1,Alabama
47,Tennessee
48,Texas
22,Louisiana
17,Illinois
42,Pennsylvania
26,Michigan
28,Mississippi
78,U.S. Virgin Islands
35,New Mexico
16,Idaho
12,Florida
2,Alaska
20,Kansas
5,Arkansas
33,New Hampshire
31,Nebraska
25,Massachusetts
23,Maine
46,South Dakota
39,Ohio
18,Indiana
49,Utah
56,Wyoming
66,Guam
69,Northern Mariana Islands
19,Iowa
13,Georgia
37,North Carolina
51,Virginia
55,Wisconsin
44,Rhode Island
4,Arizona
45,South Carolina
72,Puerto Rico
9,Connecticut
54,West Virginia
29,Missouri
27,Minnesota
38,North Dakota
15,Hawaii
53,Washington
36,New York
32,Nevada

2025-02-11 23:08:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:08:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:08:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:08:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 50
2025-02-11 23:08:15 - snowflake.connector.connection - INFO - closed
2025-02-11 23:08:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:08:16 - root - INFO - SQL:
SELECT DISTINCT "plot_inventory_year"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    ORDER BY "plot_inventory_year" ASC
    LIMIT 100;
Results:
plot_inventory_year
1968
1970
1972
1974
1975
1976
1977
1978
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
9999

2025-02-11 23:08:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:08:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:08:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:08:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:08:17 - snowflake.connector.connection - INFO - closed
2025-02-11 23:08:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:08:17 - root - INFO - SQL:
SELECT "plot_sequence_number", "stratum_sequence_number"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN"
    LIMIT 100;
Results:
plot_sequence_number,stratum_sequence_number
10672090010497,13319170010497
10670280010497,13319182010497
10669067010497,13319402010497
10669091010497,13319402010497
10670452010497,13319374010497
10668523010497,13319335010497
10669051010497,13319283010497
10668717010497,13319393010497
10671724010497,13319399010497
10669560010497,13319373010497
10668366010497,13319408010497
10668530010497,13319408010497
10668946010497,13319196010497
10667628010497,13319364010497
10668111010497,13319268010497
10668044010497,13319268010497
10667924010497,13319268010497
10667911010497,13319268010497
10668720010497,13319403010497
10668790010497,13319403010497
10671886010497,13319268010497
10672088010497,13319404010497
10669300010497,13319265010497
10669100010497,13319261010497
10668050010497,13319409010497
10667754010497,13319409010497
10671796010497,13319260010497
10671462010497,13319321010497
10671723010497,13319258010497
10670413010497,13319239010497
10668673010497,13319201010497
10668525010497,13319175010497
10668985010497,13319238010497
10668047010497,13319409010497
10669737010497,13319405010497
10670090010497,13319405010497
10671684010497,13319398010497
10669003010497,13319163010497
10667433010497,13319236010497
10670703010497,13319407010497
10670975010497,13319145010497
10668378010497,13319160010497
10670671010497,13319165010497
10670786010497,13319298010497
10669301010497,13319247010497
10670804010497,13319386010497
10671390010497,13319386010497
10672027010497,13319267010497
10671533010497,13319249010497
10668425010497,13319267010497
10667646010497,13319254010497
10671131010497,13319380010497
10667861010497,13319268010497
10669587010497,13319248010497
10670918010497,13319259010497
10671209010497,13319262010497
10670253010497,13319379010497
10669528010497,13319365010497
10668416010497,13319408010497
10668902010497,13319382010497
10668246010497,13319357010497
10669290010497,13319406010497
10671290010497,13319404010497
10671325010497,13319404010497
10671364010497,13319401010497
10669211010497,13319402010497
10670616010497,13319141010497
10667618010497,13319260010497
10669377010497,13319269010497
10670682010497,13319133010497
10672077010497,13319169010497
10669768010497,13319273010497
10669207010497,13319313010497
10670472010497,13319252010497
10667939010497,13319409010497
10668011010497,13319409010497
10671416010497,13319206010497
10670368010497,13319265010497
10670347010497,13319262010497
10670418010497,13319262010497
10672360010497,13319206010497
10671166010497,13319265010497
10668513010497,13319267010497
10667971010497,13319409010497
10668043010497,13319409010497
10670571010497,13319227010497
10669731010497,13319213010497
10669082010497,13319263010497
10672310010497,13319161010497
10671677010497,13319205010497
10667905010497,13319409010497
10667562010497,13319251010497
10669094010497,13319254010497
10669804010497,13319211010497
10671733010497,13319388010497
10670150010497,13319406010497
10672145010497,13319404010497
10668096010497,13319244010497
10670943010497,13319259010497
10669693010497,13319259010497

2025-02-11 23:08:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:08:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:08:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:08:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:08:18 - snowflake.connector.connection - INFO - closed
2025-02-11 23:08:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:08:19 - root - INFO - SQL:
SELECT c."plot_sequence_number",
           c."condition_proportion_unadjusted",
           c."proportion_basis",
           c."condition_status_code",
           c."inventory_year",
           ps."expansion_factor",
           ps."adjustment_factor_for_the_subplot",
           ps."adjustment_factor_for_the_macroplot"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    LIMIT 100;
Results:
Too long, hard cut:
plot_sequence_number,condition_proportion_unadjusted,proportion_basis,condition_status_code,inventory_year,expansion_factor,adjustment_factor_for_the_subplot,adjustment_factor_for_the_macroplot
249882137489998,1.0,SUBP,1,2015,2941.734779129259,1.0,0.0
14532053020004,1.0,SUBP,1,2013,2941.734779129259,1.0,0.0
249881888489998,0.28448399901390076,SUBP,5,2015,3242.325885397263,1.0125941730466428,0.0
249881888489998,0.7155159711837769,SUBP,1,2015,3242.325885397263,1.0125941730466428,0.0
306349565489998,0.5,SUBP,1,2016,3044.2001648309006,1.0,0.0
306349565489998,0.5,SUBP,3,2016,3044.2001648309006,1.0,0.0
249881259489998,1.0,SUBP,1,2015,2710.291407552027,1.0,0.0
14532153020004,0.9882959723472595,SUBP,1,2013,2966.666837622005,1.0,0.0
14532153020004,0.01170399971306324,SUBP,2,2013,2966.666837622005,1.0,0.0
245792699010661,1.0,SUBP,2,2012,3005.9632678903,1.0012785743815447,0.0
373753708489998,1.0,SUBP,2,2017,2999.1628524224693,1.0016462817099119,0.0
245791534010661,0.5988519787788391,SUBP,1,2012,3132.4020081587305,1.0081749219522584,0.0
245791534010661,0.4011479914188385,SUBP,2,2012,3132.4020081587305,1.0081749219522584,0.0
14532204020004,0.25,SUBP,1,2013,3132.4020081587305,1.0081749219522584,0.0
14532204020004,0.75,SUBP,2,2013,3132.4020081587305,1.0081749219522584,0.0
465276459489998,1.0,SUBP,1,2018,2710.292290071204,1.0009930484621552,0.0
14531954020004,1.0,SUBP,2,2013,2953.3357975602717,1.0012468838175972,0.0
249881588489998,0.056418001651763916,SUBP,2,2016,3131.0811700944773,1.01582727599291,0.0
249881588489998,0.9435819983482361,SUBP,1,2016,3131.0811700944773,1.01582727599291,0.0
249881846489998,1.0,SUBP,2,2016,2997.233461691199,1.0007265681763138,0.0
373752958489998,1.0,SUBP,1,2017,2660.0070680314398,1.0,0.0
168270611020004,1.0,SUBP,1,2014,3151.2584954051304,1.0228394926568254,0.0
168272558020004,1.0,SUBP,2,2014,2993.7831881131915,1.0008976660682227,0.0
14531206020004,1.0,SUBP,1,2013,3045.440843038893,1.0,0.0
14532413020004,1.0,SUBP,1,2013,2966.048222430539,1.0,0.0
168270646020004,1.0,SUBP,2,2014,3008.828285607844,1.0008457851467216,0.0
373753777489998,1.0,SUBP,2,2017,3008.828285607844,1.0008457851467216,0.0
306350194489998,1.0,SUBP,2,2016,3008.828285607844,1.0008457851467216,0.0
465278087489998,1.0,SUBP,2,2018,2993.649219144576,1.0007011639321273,0.0
249882270489998,1.0,SUBP,1,2015,3480.4275947701503,1.009009009009009,0.0
373752822489998,1.0,SUBP,2,2017,2975.303736464581,1.0,0.0
168270631020004,1.0,SUBP,2,2015,2953.3357975602717,1.0012468838175972,0.0
168271634020004,1.0,SUBP,2,2014,2981.9487476012973,1.0,0.0
14531524020004,1.0,SUBP,2,2013,3145.588910041915,1.0014785608674224,0.0
249881781489998,1.0,SUBP,1,2015,2880.6706550567596,1.0,0.0
306350275489998,1.0,SUBP,2,2016,3000.376520760631,1.000702740688686,0.0
14532091020004,0.5419480204582214,SUBP,1,2013,3064.8543925314802,1.0109649666581721,0.0
14532091020004,0.45805200934410095,SUBP,1,2013,3064.8543925314802,1.0109649666581721,0.0
373753290489998,1.0,SUBP,2,2017,2993.7831881131915,1.0008976660682227,0.0
245793184010661,1.0,SUBP,2,2012,2993.7831881131915,1.0008976660682227,0.0
245792768010661,1.0,SUBP,1,2012,2955.314051410035,1.0,0.0
14532344020004,1.0,SUBP,1,2013,2955.314051410035,1.0,0.0
465276650489998,0.455161988735199,SUBP,1,2018,3189.534836898099,1.0035052578868302,0.0
465276650489998,0.544838011264801,SUBP,1,2018,3189.534836898099,1.0035052578868302,0.0
465276753489998,0.75,SUBP,1,2018,3292.148751570572,1.0170227500257183,0.0
465276753489998,0.25,SUBP,1,2018,3292.148751570572,1.0170227500257183,0.0
168270947020004,0.75,SUBP,1,2015,3444.1058599068588,1.0101755223511297,0.0
168270947020004,0.25,SUBP,1,2015,3444.1058599068588,1.0101755223511297,0.0
249881669489998,1.0,SUBP,1,2015,50096.129411764705,1.0149253731343284,0.0
465276890489998,1.0,SUBP,2,2018,2999.1628524224693,1.0016462817099119,0.0
14531985020004,1.0,SUBP,2,2013,3089.9256195453695,1.012457472135695,0.0
168270948020004,1.0,SUBP,1,2015,2880.7525112593785,1.0,0.0
465276847489998,1.0,SUBP,2,2018,3005.9632678903,1.0012785743815447,0.0
168272127020004,1.0,SUBP,2,2015,2975.303736464581,1.0,0.0
14532842020004,1.0,SUBP,2,2013,2993.649219144576,1.0007011639321273,0.0
373752877489998,1.0,SUBP,2,2017,2993.649219144576,1.0007011639321273,0.0
245792901010661,1.0,SUBP,1,2012,3480.4275947701503,1.009009009009009,0.0
245793176010661,1.0,SUBP,2,2012,2981.9487476012973,1.0,0.0
14533354020004,0.75,SUBP,1,2013,2660.0070680314398,1.0,0.0
14533354020004,0.25,SUBP,1,2013,2660.0070680314398,1.0,0.0
14533170020004,1.0,SUBP,2,2013,3012.696980817878,1.001880152889805,0.0
14532098020004,1.0,SUBP,2,2013,2997.233461691199,1.0007265681763138,0.0
245791557010661,1.0,SUBP,1,2012,2880.6706550567596,1.0,0.0
245793198010661,1.0,SUBP,2,2012,2692.7927996078743,1.0,0.0
14531744020004,1.0,SUBP,2,2013,2993.7831881131915,1.0008976660682227,0.0
249882348489998,0.5,SUBP,1,2016,3170.2235493723874,1.0129611166500498,0.0
249882348489998,0.5,SUBP,2,2016,3170.2235493723874,1.0129611166500498,0.0
249881616489998,1.0,SUBP,2,2016,2975.303736464581,

2025-02-11 23:08:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:08:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:08:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:08:20 - snowflake.connector.connection - INFO - closed
2025-02-11 23:08:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:08:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:08:28 - root - INFO - ```sql
SELECT ps."stratum_sequence_number", e."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
  ON ps."evaluation_identifier" = e."evaluation_sequence_number"
LIMIT 100;
```
2025-02-11 23:08:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:08:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:08:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:08:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 23:08:29 - snowflake.connector.connection - INFO - closed
2025-02-11 23:08:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:09:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:09:30 - root - INFO - ```sql
SELECT ps."stratum_sequence_number", pe."evaluation_description"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
  ON ps."evaluation_identifier" = pe."evaluation_identifier"
LIMIT 100;
```
2025-02-11 23:09:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:09:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:09:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:09:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:09:32 - snowflake.connector.connection - INFO - closed
2025-02-11 23:09:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:10:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:10:06 - root - INFO - SQL:
SELECT ps."stratum_sequence_number", pe."evaluation_description"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
  ON ps."evaluation_identifier" = pe."evaluation_identifier"
LIMIT 100;
Results:
stratum_sequence_number,evaluation_description
2171,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2172,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2173,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2174,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2175,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2176,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2177,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2178,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2179,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
218,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2180,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2181,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2182,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2183,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2184,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2185,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2186,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2187,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2188,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2189,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
219,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2190,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2191,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2192,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2193,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2194,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2195,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2196,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2197,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2198,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2096,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2097,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2098,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2099,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
210,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2100,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2101,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2102,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2103,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2104,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2105,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2106,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2107,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2108,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2109,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
211,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2110,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2111,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2112,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2113,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2114,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2115,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2116,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2117,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2118,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2119,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
212,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2120,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2121,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2122,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2123,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2124,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2125,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2126,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2127,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2128,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2129,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
213,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2130,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2131,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2132,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2133,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2063,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2134,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2135,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2136,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2137,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2138,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2139,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
214,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2140,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2141,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2142,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2143,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2144,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2145,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2146,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2147,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2148,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2149,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
215,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2150,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2151,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2152,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2153,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
220,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2200,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2201,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2202,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2203,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"

2025-02-11 23:10:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:10:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:10:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:10:07 - snowflake.connector.connection - INFO - closed
2025-02-11 23:10:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:10:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:10:30 - root - INFO - ```sql
SELECT c."plot_sequence_number",
       c."condition_status_code",
       c."inventory_year",
       p."plot_state_code_name",
       e."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
  ON c."plot_sequence_number" = p."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
  ON c."plot_sequence_number" = psa."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
  ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
  ON ps."evaluation_identifier" = e."evaluation_sequence_number"
WHERE c."condition_status_code" = 1
  AND e."evaluation_type" = 'EXPCURR'
LIMIT 100;
```

**Explanation:**

- **Issue Correction:**
  - The error occurred because the column `"evaluation_sequence_number"` does not exist in the `"POPULATION_STRATUM"` table (`ps` alias).
  - I corrected the join condition by replacing `ps."evaluation_sequence_number"` with `ps."evaluation_identifier"`, which aligns with the column available in the `"POPULATION_STRATUM"` table.

- **Query Breakdown:**
  - Selects the desired columns from the `CONDITION`, `PLOT`, and `POPULATION_EVALUATION_TYPE` tables.
  - Joins the tables appropriately:
    - `CONDITION` (`c`) joins with `PLOT` (`p`) on `"plot_sequence_number"`.
    - `CONDITION` (`c`) joins with `POPULATION_STRATUM_ASSIGN` (`psa`) on `"plot_sequence_number"`.
    - `POPULATION_STRATUM_ASSIGN` (`psa`) joins with `POPULATION_STRATUM` (`ps`) on `"stratum_sequence_number"`.
    - `POPULATION_STRATUM` (`ps`) joins with `POPULATION_EVALUATION_TYPE` (`e`) on `"evaluation_identifier" = "evaluation_sequence_number"`.
  - Filters records where:
    - `"condition_status_code"` is `1`.
    - `"evaluation_type"` is `'EXPCURR'`.
  - Limits the results to 100 records.

This corrected query should resolve the `invalid identifier 'PS."evaluation_sequence_number"'` error and return the desired data.
2025-02-11 23:10:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:10:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:10:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:10:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 23:10:31 - snowflake.connector.connection - INFO - closed
2025-02-11 23:10:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:11:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:11:18 - root - INFO - ```sql
SELECT c."plot_sequence_number",
       c."condition_status_code",
       c."inventory_year",
       p."plot_state_code_name",
       pe."evaluation_description"
FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
  ON c."plot_sequence_number" = p."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
  ON c."plot_sequence_number" = psa."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
  ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
  ON ps."evaluation_identifier" = pe."evaluation_identifier"
WHERE c."condition_status_code" = 1
LIMIT 100;
```
2025-02-11 23:11:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:11:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:11:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:11:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:11:20 - snowflake.connector.connection - INFO - closed
2025-02-11 23:11:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:11:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:11:45 - root - INFO - SQL:
SELECT c."plot_sequence_number",
       c."condition_status_code",
       c."inventory_year",
       p."plot_state_code_name",
       pe."evaluation_description"
FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
  ON c."plot_sequence_number" = p."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
  ON c."plot_sequence_number" = psa."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
  ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
  ON ps."evaluation_identifier" = pe."evaluation_identifier"
WHERE c."condition_status_code" = 1
LIMIT 100;
Results:
Too long, hard cut:
plot_sequence_number,condition_status_code,inventory_year,plot_state_code_name,evaluation_description
220859196010661,1,2011,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
14528383020004,1,2013,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
245013033489998,1,2015,South Dakota,"SOUTH DAKOTA 2016: 2006-2011 to 2011-2016: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
245103192010661,1,2012,South Dakota,"SOUTH DAKOTA 2016: 2006-2011 to 2011-2016: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
220858622010661,1,2011,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
14529126020004,1,2013,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
14528330020004,1,2013,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
220858272010661,1,2011,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
220858738010661,1,2011,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
14528231020004,1,2013,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
168246041020004,1,2014,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
14528320020004,1,2013,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
220858526010661,1,2011,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
14528262020004,1,2013,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
169001988010661,1,2010,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
245103577010661,1,2012,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
14528262020004,1,2013,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
169001590010661,1,2010,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
14529126020004,1,2013,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
168246605020004,1,2015,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
220858532010661,1,2011,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
168246031020004,1,2014,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
14529267020004,1,2013,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
168245848020004,1,2014,South Dakota,SOUTH DAKOTA 2016: 2011-2016: ALL AREA
245103218010661,1,2012,South Dakota,SOUTH DAKOTA 2016: 2012-2016: DWM
168246091020004,1,2015,South Dakota,SOUTH DAKOTA 2016: 2012-2016: REGENERATION
108718313010661,1,2009,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
245103265010661,1,2012,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
108717734010661,1,2009,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
169001082010661,1,2010,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
169001584010661,1,2010,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168246033020004,1,2014,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168246033020004,1,2014,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
220858742010661,1,2011,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
245012951489998,1,2015,South Dakota,"SOUTH DAKOTA 2015: 2005-2010 to 2010-2015: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168245950020004,1,2014,South Dakota,"SOUTH DAKOTA 2015: 2005-2010 to 2010-2015: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
220858528010661,1,2011,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
245104631010661,1,2012,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
245103207010661,1,2012,South Dakota,SOUTH DAKOTA 2015: 2012-2015: REGENERATION
14528993020004,1,2013,South Dakota,"SOUTH DAKOTA 2016: 2006-2011 to 2011-2016: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168247306020004,1,2014,South Dakota,SOUTH DAKOTA 2016: 2011-2016: ALL AREA
168245848020004,1,2014,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
245104135010661,1,2012,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
15750114020004,1,2013,Missouri,"MISSOURI 2017: 2006-2011 to 2011-2017: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
451192896489998,1,2018,Missouri,MISSOURI 2018: 2012-2018: VEG PROFILE
15750187020004,1,2013,Missouri,MISSOURI 2017: 2012-2017: REGENERATION
15750187020004,1,2013,Missouri,MISSOURI 2017: 2012-2017: REGENERATION
171800098020004,1,2014,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
171800558020004,1,2015,Missouri,"MISSOURI 2017: 2011-2017: CURRENT AREA, CURRENT VOLUME"
373680304489998,1,2017,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
373680304489998,1,2017,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
171799301020004,1,2014,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
15749929020004,1,2013,Missouri,"MISSOURI 2017: 2006-2011 to 2011-2017: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"

2025-02-11 23:11:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:11:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:11:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:11:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:11:46 - snowflake.connector.connection - INFO - closed
2025-02-11 23:11:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:12:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:12:13 - root - INFO - ```sql
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND ps."adjustment_factor_for_the_subplot" IS NOT NULL
        AND ps."adjustment_factor_for_the_subplot" > 0
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
)
SELECT
    'subplot' AS "Type",
    c."inventory_year" AS "Year",
    c."State",
    AVG(c."E" * c."P" * c."A_s") AS "Average_Size"
FROM condition_data c
GROUP BY c."inventory_year", c."State"
ORDER BY c."inventory_year", "Average_Size" DESC;
```
2025-02-11 23:12:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:12:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:12:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:12:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 146
2025-02-11 23:12:14 - snowflake.connector.connection - INFO - closed
2025-02-11 23:12:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:12:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:12:52 - root - INFO - SQL:
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND ps."adjustment_factor_for_the_subplot" IS NOT NULL
        AND ps."adjustment_factor_for_the_subplot" > 0
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
)
SELECT
    'subplot' AS "Type",
    c."inventory_year" AS "Year",
    c."State",
    AVG(c."E" * c."P" * c."A_s") AS "Average_Size"
FROM condition_data c
GROUP BY c."inventory_year", c."State"
ORDER BY c."inventory_year", "Average_Size" DESC;
Results:
Too long, hard cut:
Type,Year,State,Average_Size
subplot,2015,Maryland,10704.67385403049
subplot,2015,West Virginia,10059.53473742004
subplot,2015,Nebraska,9984.2001338665
subplot,2015,Maine,9902.357259129189
subplot,2015,New York,9894.622577012924
subplot,2015,Texas,9705.883471324289
subplot,2015,Illinois,9649.865174477063
subplot,2015,Massachusetts,9547.468329549349
subplot,2015,Vermont,9324.110466244769
subplot,2015,Connecticut,9172.046927176038
subplot,2015,Iowa,9085.487680029606
subplot,2015,New Hampshire,8782.949373788724
subplot,2015,Indiana,8602.744931288573
subplot,2015,South Dakota,8516.450029686841
subplot,2015,Pennsylvania,8482.130832203402
subplot,2015,Missouri,8449.29594282356
subplot,2015,Alaska,7614.904610597975
subplot,2015,Ohio,7453.035350546701
subplot,2015,Wyoming,7376.064147461428
subplot,2015,Michigan,7325.16352650214
subplot,2015,New Jersey,7151.07762198572
subplot,2015,Kansas,6428.366084684225
subplot,2015,Oklahoma,5831.288799585411
subplot,2015,Rhode Island,5830.557008660188
subplot,2015,Alabama,5801.796867267843
subplot,2015,New Mexico,5574.272282554542
subplot,2015,California,5496.005445350178
subplot,2015,Nevada,5480.864130494596
subplot,2015,Arizona,5457.996908933815
subplot,2015,Utah,5421.315374017792
subplot,2015,North Dakota,5360.22848697917
subplot,2015,Colorado,5313.0175780209065
subplot,2015,Montana,5224.608171570817
subplot,2015,Louisiana,5200.598230113692
subplot,2015,Idaho,5196.834553257898
subplot,2015,Kentucky,5134.4894601779615
subplot,2015,Mississippi,5029.3356334032005
subplot,2015,Delaware,4979.247905033816
subplot,2015,Arkansas,4962.358473789706
subplot,2015,Florida,4951.923394269425
subplot,2015,Minnesota,4946.607082054724
subplot,2015,North Carolina,4825.833066249418
subplot,2015,Georgia,4740.4090167372015
subplot,2015,Virginia,4652.402098350851
subplot,2015,Wisconsin,4603.666066375564
subplot,2015,Tennessee,4505.415187108435
subplot,2015,South Carolina,4095.7694941031996
subplot,2015,Washington,3526.8718766952966
subplot,2015,Oregon,2713.0119740321443
subplot,2015,Northern Mariana Islands,1400.1577212802279
subplot,2016,Connecticut,12248.799692410937
subplot,2016,Maryland,11177.622816586867
subplot,2016,Vermont,10495.089916713314
subplot,2016,Maine,10192.425905069344
subplot,2016,New Hampshire,9911.896611852066
subplot,2016,West Virginia,9776.707599038677
subplot,2016,New York,9235.778599736766
subplot,2016,Indiana,8992.380690761642
subplot,2016,Massachusetts,8697.535029759503
subplot,2016,Nebraska,8541.618384596735
subplot,2016,Illinois,8475.002871837556
subplot,2016,Texas,8438.935702481276
subplot,2016,Kansas,8351.947003413303
subplot,2016,Missouri,8263.459649071514
subplot,2016,Ohio,8254.73219639441
subplot,2016,Pennsylvania,8245.396775849793
subplot,2016,Iowa,8109.361159674122
subplot,2016,Michigan,8105.398847678354
subplot,2016,Alaska,7953.927182856081
subplot,2016,South Dakota,7467.506577979042
subplot,2016,North Dakota,7261.212069921161
subplot,2016,New Jersey,6930.484865925008
subplot,2016,Wyoming,6815.652260073871
subplot,2016,Rhode Island,6322.1756497707665
subplot,2016,Alabama,5990.067667052806
subplot,2016,New Mexico,5939.234365038291
subplot,2016,Louisiana,5766.372005753261
subplot,2016,California,5667.635259846076
subplot,2016,Nevada,5402.833944477592
subplot,2016,Utah,5364.555021706708
subplot,2016,Idaho,5338.3417927897635
subplot,2016,Montana,5263.947646211432
subplot,2016,Arizona,5262.7104960669385
subplot,2016,Puerto Rico,5210.41628570456
subplot,2016,Colorado,5186.1796385088755
subplot,2016,North Carolina,5149.005074774131
subplot,2016,Arkansas,5041.24353734168
subplot,2016,Florida,4921.916202917815
subplot,2016,Delaware,4861.316690543656
subplot,2016,Minnesota,4790.976103273648
subplot,2016,Kentucky,4721.720336145489
subplot,2016,Oklahoma,4679.370100835216
subplot,2016,Virginia,4592.631103810453
subplot,2016,Mississippi,4461.248182943891
subplot,2016,South Carolina,4421.711157160292
subplot,2016,Georgia,4417.928260246422
subplot,2016,Wisconsin,4358.382051295848
subplot,2016,Tennessee,4134.258538338294
subplot,2016,Washington,3701.548923173183
subplot,2016,Oregon,2758.8023915335807
subplot,2016,Federated States of Micronesia,1468.2717044838191
subplot,2017,Iowa,11712.025040553006
subplot,2017,Maine,10921.592583898833
subplot,2017,New York,10585.257727146587
subplot,2017,West Virginia,10171.191605073862
subplot,2017,Massachusetts,9740.224220700093
subplot,2017,Illinois,9456.39023873408
subplot,2017,Maryland,9432.036408362754
subplot,2017,Pennsylvania,8762.134054463086
subplot,2017,Ohio,8751.688694691675
subplot,2017,Nebraska,8699.590666121456
subplot,2017,Indiana,8517.456603934612
subplot,2017,New Hampshire,8478.24635342262
subplot,2017,Vermont,8392.620788592763
subplot,2017,Missouri,8370.031213229076
subplot,2017,Alaska,7961.190089540881
subplot,2017,Connecticut,7861.110028317676
subplot,2017,Michigan,7414.010315538452
subplot,2017,New Jersey,7065.85896023263
subplot,2017,Wyoming,6111.705148928129
subplot,2017,New Mexico,5910.44395052848
subplot,2017,Kansas,584

2025-02-11 23:12:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:12:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:12:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:12:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 58
2025-02-11 23:12:53 - snowflake.connector.connection - INFO - closed
2025-02-11 23:12:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:12:53 - root - INFO - SQL:
SELECT DISTINCT c."state_code", c."state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    LIMIT 100;
Results:
state_code,state_code_name
8,Colorado
6,California
26,Michigan
48,Texas
17,Illinois
16,Idaho
35,New Mexico
27,Minnesota
45,South Carolina
32,Nevada
38,North Dakota
15,Hawaii
54,West Virginia
41,Oregon
60,American Samoa
10,Delaware
70,Palau
64,Federated States of Micronesia
1,Alabama
47,Tennessee
42,Pennsylvania
22,Louisiana
21,Kentucky
28,Mississippi
68,Marshall Islands
40,Oklahoma
24,Maryland
50,Vermont
12,Florida
23,Maine
56,Wyoming
46,South Dakota
39,Ohio
18,Indiana
19,Iowa
5,Arkansas
25,Massachusetts
66,Guam
55,Wisconsin
13,Georgia
4,Arizona
51,Virginia
37,North Carolina
44,Rhode Island
30,Montana
34,New Jersey
78,Virgin Islands of the U.S.
49,Utah
2,Alaska
31,Nebraska
20,Kansas
33,New Hampshire
69,Northern Mariana Islands
29,Missouri
53,Washington
36,New York
72,Puerto Rico
9,Connecticut

2025-02-11 23:12:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:12:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:12:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:12:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 23:12:54 - snowflake.connector.connection - INFO - closed
2025-02-11 23:12:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:12:55 - root - INFO - SQL:
SELECT DISTINCT c."state_code", c."state_code_name", c."inventory_year"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    WHERE c."condition_status_code" = 1
    ORDER BY c."inventory_year" ASC
    LIMIT 100;
Results:
state_code,state_code_name,inventory_year
45,South Carolina,1968
12,Florida,1970
13,Georgia,1972
1,Alabama,1972
22,Louisiana,1974
37,North Carolina,1974
48,Texas,1975
40,Oklahoma,1976
51,Virginia,1977
28,Mississippi,1977
27,Minnesota,1977
45,South Carolina,1978
5,Arkansas,1978
12,Florida,1980
47,Tennessee,1980
46,South Dakota,1980
26,Michigan,1980
38,North Dakota,1980
20,Kansas,1981
1,Alabama,1982
13,Georgia,1982
31,Nebraska,1983
33,New Hampshire,1983
55,Wisconsin,1983
50,Vermont,1983
56,Wyoming,1984
8,Colorado,1984
37,North Carolina,1984
22,Louisiana,1984
44,Rhode Island,1985
25,Massachusetts,1985
9,Connecticut,1985
17,Illinois,1985
4,Arizona,1985
51,Virginia,1985
48,Texas,1986
45,South Carolina,1986
40,Oklahoma,1986
18,Indiana,1986
10,Delaware,1986
24,Maryland,1986
35,New Mexico,1987
12,Florida,1987
34,New Jersey,1987
28,Mississippi,1987
5,Arkansas,1988
21,Kentucky,1988
32,Nevada,1989
54,West Virginia,1989
40,Oklahoma,1989
47,Tennessee,1989
29,Missouri,1989
13,Georgia,1989
30,Montana,1989
42,Pennsylvania,1989
37,North Carolina,1990
1,Alabama,1990
19,Iowa,1990
27,Minnesota,1990
22,Louisiana,1991
16,Idaho,1991
39,Ohio,1991
48,Texas,1992
51,Virginia,1992
36,New York,1993
40,Oklahoma,1993
26,Michigan,1993
49,Utah,1993
45,South Carolina,1993
6,California,1994
31,Nebraska,1994
28,Mississippi,1994
20,Kansas,1994
5,Arkansas,1995
23,Maine,1995
38,North Dakota,1995
2,Alaska,1995
46,South Dakota,1995
12,Florida,1995
55,Wisconsin,1996
2,Alaska,1996
2,Alaska,1997
13,Georgia,1997
33,New Hampshire,1997
50,Vermont,1997
9,Connecticut,1998
18,Indiana,1998
2,Alaska,1998
13,Georgia,1998
17,Illinois,1998
51,Virginia,1998
25,Massachusetts,1998
44,Rhode Island,1998
41,Oregon,1999
34,New Jersey,1999
21,Kentucky,1999
4,Arizona,1999
29,Missouri,1999
24,Maryland,1999
2,Alaska,1999

2025-02-11 23:12:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:12:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:12:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:12:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-11 23:12:56 - snowflake.connector.connection - INFO - closed
2025-02-11 23:12:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:12:56 - root - INFO - SQL:
SELECT DISTINCT c."proportion_basis"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    WHERE c."condition_status_code" = 1
    LIMIT 100;
Results:
proportion_basis
SUBP
MACR
""

2025-02-11 23:12:56 - root - INFO - itercount: 0
2025-02-11 23:12:56 - root - INFO - Database Name: USFS_FIA
Schema Name: USFS_FIA
,0
table_name,POPULATION
description,
DDL,"create or replace TABLE POPULATION (
	""stratum_assign_sequence_number"" VARCHAR(16777216),
	""stratum_sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""inventory_year"" NUMBER(38,0),
	""survey_unit_code"" NUMBER(38,0),
	""county_code"" NUMBER(38,0),
	""phase_2_plot_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""stratum_code"" NUMBER(38,0),
	""stratum_assign_created_by"" VARCHAR(16777216),
	""stratum_assign_created_date"" DATE,
	""stratum_assign_created_in_instance"" NUMBER(38,0),
	""stratum_assign_modified_by"" VARCHAR(16777216),
	""stratum_assign_modified_date"" DATE,
	""stratum_assign_modified_in_instance"" NUMBER(38,0),
	""estimation_unit_sequence_number"" NUMBER(38,0),
	""evaluation_sequence_number"" NUMBER(38,0),
	""estimation_unit_description"" VARCHAR(16777216),
	""land_area_within_the_estimation_unit"" FLOAT,
	""total_area_within_the_estimation_unit"" FLOAT,
	""area_used_to_calculate_all_expansion_factors"" FLOAT,
	""area_source"" VARCHAR(16777216),
	""phase_1_point_count_for_the_estimation_unit"" NUMBER(38,0),
	""phase_1_source"" VARCHAR(16777216),
	""eval_unit_created_by"" VARCHAR(16777216),
	""eval_unit_created_date"" DATE,
	""eval_unit_created_in_instance"" NUMBER(38,0),
	""eval_unit_modified_by"" VARCHAR(16777216),
	""eval_unit_modified_date"" DATE,
	""eval_unit_modified_in_instance"" NUMBER(38,0),
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""location_name"" VARCHAR(16777216),
	""report_year_name"" VARCHAR(16777216),
	""start_inventory_year"" VARCHAR(16777216),
	""end_inventory_year"" VARCHAR(16777216),
	""land_only"" VARCHAR(16777216),
	""timberland_only"" VARCHAR(16777216),
	""growth_accounting"" VARCHAR(16777216),
	""estimation_method"" VARCHAR(16777216),
	""notes"" VARCHAR(16777216),
	""pop_evaluation_created_by"" VARCHAR(16777216),
	""pop_evaluation_created_date"" DATE,
	""pop_evaluation_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_modified_by"" VARCHAR(16777216),
	""pop_evaluation_modified_date"" DATE,
	""pop_evaluation_modified_in_instance"" NUMBER(38,0),
	""evaluation_type_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""eval_type_created_by"" VARCHAR(16777216),
	""eval_type_created_date"" DATE,
	""eval_type_created_in_instance"" NUMBER(38,0),
	""eval_type_modified_by"" VARCHAR(16777216),
	""eval_type_modified_date"" DATE,
	""eval_type_modified_in_instance"" NUMBER(38,0),
	""stratum_description"" VARCHAR(16777216),
	""phase_1_point_count"" NUMBER(38,0),
	""phase_2_point_count"" NUMBER(38,0),
	""expansion_factor"" FLOAT,
	""adjustment_factor_for_the_macroplot"" FLOAT,
	""adjustment_factor_for_the_subplot"" FLOAT,
	""adjustment_factor_for_the_microplot"" FLOAT,
	""adjustment_factor_for_coarse_woody_debris"" FLOAT,
	""adjustment_factor_for_small_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_large_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_the_duff_and_litter_layer"" FLOAT,
	""pop_stratum_created_by"" VARCHAR(16777216),
	""pop_stratum_created_date"" DATE,
	""pop_stratum_created_in_instance"" NUMBER(38,0),
	""pop_stratum_modified_by"" VARCHAR(16777216),
	""pop_stratum_modified_date"" DATE,
	""pop_stratum_modified_in_instance"" NUMBER(38,0),
	""pop_stratum_adjustment_factor_for_piles"" FLOAT,
	""evaluation_group"" NUMBER(38,0),
	""evaluation_group_description"" VARCHAR(16777216),
	""pop_evaluation_group_created_by"" VARCHAR(16777216),
	""pop_evaluation_group_created_date"" DATE,
	""pop_evaluation_group_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_group_modified_by"" VARCHAR(16777216),
	""pop_evaluation_group_modified_date"" DATE,
	""pop_evaluation_group_modified_in_instance"" NUMBER(38,0)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,1
table_name,POPULATION_EVALUATION_GROUP
description,
DDL,"create or replace TABLE POPULATION_EVALUATION_GROUP (
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_group"" NUMBER(38,0),
	""evaluation_group_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""notes"" VARCHAR(16777216),
	""pop_evaluation_group_created_by"" VARCHAR(16777216),
	""pop_evaluation_group_created_date"" DATE,
	""pop_evaluation_group_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_group_modified_by"" VARCHAR(16777216),
	""pop_evaluation_group_modified_date"" DATE,
	""pop_evaluation_group_modified_in_instance"" NUMBER(38,0)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,2
table_name,CONDITION
description,
DDL,"create or replace TABLE CONDITION (
	""sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""inventory_year"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""state_code_name"" VARCHAR(16777216),
	""survey_unit_code"" NUMBER(38,0),
	""survey_unit_code_name"" VARCHAR(16777216),
	""county_code"" NUMBER(38,0),
	""county_code_name"" VARCHAR(16777216),
	""phase_2_plot_number"" NUMBER(38,0),
	""condition_class_number"" NUMBER(38,0),
	""condition_status_code"" NUMBER(38,0),
	""condition_status_code_name"" VARCHAR(16777216),
	""condition_nonsampled_reason_code"" NUMBER(38,0),
	""condition_nonsampled_reason_code_name"" VARCHAR(16777216),
	""reserved_status_code"" NUMBER(38,0),
	""reserved_status_code_name"" VARCHAR(16777216),
	""owner_class_code"" NUMBER(38,0),
	""owner_class_code_name"" VARCHAR(16777216),
	""owner_group_code"" NUMBER(38,0),
	""owner_group_code_name"" VARCHAR(16777216),
	""private_owner_industrial_status_code"" BOOLEAN,
	""private_owner_industrial_status_code_name"" VARCHAR(16777216),
	""administrative_forest_code"" NUMBER(38,0),
	""administrative_forest_code_name"" VARCHAR(16777216),
	""forest_type_code"" NUMBER(38,0),
	""forest_type_code_name"" VARCHAR(16777216),
	""field_forest_type_code"" NUMBER(38,0),
	""field_forest_type_code_name"" VARCHAR(16777216),
	""mapping_density"" NUMBER(38,0),
	""mapping_density_name"" VARCHAR(16777216),
	""stand_age"" NUMBER(38,0),
	""standsize_class_code"" NUMBER(38,0),
	""standsize_class_code_name"" VARCHAR(16777216),
	""field_standsize_class_code"" NUMBER(38,0),
	""field_standsize_class_code_name"" VARCHAR(16777216),
	""site_productivity_class_code"" NUMBER(38,0),
	""site_productivity_class_code_name"" VARCHAR(16777216),
	""site_index_for_the_condition"" NUMBER(38,0),
	""site_index_base_age"" NUMBER(38,0),
	""site_index_species_code"" NUMBER(38,0),
	""stand_origin_code"" BOOLEAN,
	""stand_origin_code_name"" VARCHAR(16777216),
	""stand_origin_species_code"" NUMBER(38,0),
	""stand_origin_species_code_name"" VARCHAR(16777216),
	""proportion_basis"" VARCHAR(16777216),
	""condition_proportion_unadjusted"" FLOAT,
	""microplot_proportion_unadjusted"" FLOAT,
	""subplot_proportion_unadjusted"" FLOAT,
	""macroplot_proportion_unadjusted"" FLOAT,
	""slope"" NUMBER(38,0),
	""aspect"" NUMBER(38,0),
	""physiographic_class_code"" NUMBER(38,0),
	""physiographic_class_code_name"" VARCHAR(16777216),
	""growingstock_stocking_code"" VARCHAR(16777216),
	""growingstock_stocking_code_name"" VARCHAR(16777216),
	""all_live_stocking_code"" NUMBER(38,0),
	""disturbance_code_1"" NUMBER(38,0),
	""disturbance_code_1_name"" VARCHAR(16777216),
	""disturbance_year_1"" NUMBER(38,0),
	""disturbance_code_2"" NUMBER(38,0),
	""disturbance_year_2"" NUMBER(38,0),
	""disturbance_code_3"" NUMBER(38,0),
	""disturbance_year_3"" NUMBER(38,0),
	""treatment_code_1"" NUMBER(38,0),
	""treatment_code_1_name"" VARCHAR(16777216),
	""treatment_year_1"" NUMBER(38,0),
	""treatment_code_2"" NUMBER(38,0),
	""treatment_year_2"" NUMBER(38,0),
	""treatment_code_3"" NUMBER(38,0),
	""treatment_year_3"" NUMBER(38,0),
	""present_nonforest_code"" NUMBER(38,0),
	""present_nonforest_code_name"" VARCHAR(16777216),
	""basal_area_per_acre_of_live_trees"" FLOAT,
	""fieldrecorded_stand_age"" NUMBER(38,0),
	""alllivetree_stocking_percent"" FLOAT,
	""growingstock_stocking_percent"" FLOAT,
	""forest_type_code_calculated"" NUMBER(38,0),
	""habitat_type_code_1"" VARCHAR(16777216),
	""habitat_type_code_1_publication_code"" VARCHAR(16777216),
	""habitat_type_code_1_description_publication_code"" VARCHAR(16777216),
	""habitat_type_code_2"" VARCHAR(16777216),
	""habitat_type_code_2_publication_code"" VARCHAR(16777216),
	""habitat_type_code_2_description_publication_code"" VARCHAR(16777216),
	""mixed_conifer_code"" VARCHAR(16777216),
	""mixed_conifer_code_name"" VARCHAR(16777216),
	""volume_location_group"" VARCHAR(16777216),
	""volume_location_group_name"" VARCHAR(16777216),
	""site_productivity_class_code_estimated"" NUMBER(38,0),
	""site_productivity_class_code_estimated_name"" VARCHAR(16777216),
	""site_tree_tree_number"" NUMBER(38,0),
	""site_class_method"" NUMBER(38,0),
	""site_class_method_name"" VARCHAR(16777216),
	""carbon_in_down_dead"" FLOAT,
	""carbon_in_litter"" FLOAT,
	""carbon_in_soil_organic_material"" FLOAT,
	""carbon_in_standing_dead_trees"" FLOAT,
	""carbon_in_understory_aboveground"" FLOAT,
	""carbon_in_understory_belowground"" FLOAT,
	""created_by"" VARCHAR(16777216),
	""created_date"" DATE,
	""created_in_instance"" NUMBER(38,0),
	""modified_by"" VARCHAR(16777216),
	""modified_date"" DATE,
	""modified_in_instance"" NUMBER(38,0),
	""inventory_cycle_number"" NUMBER(38,0),
	""inventory_subcycle_number"" NUMBER(38,0),
	""soil_rooting_depth_pacific_northwest_research_station"" NUMBER(38,0),
	""soil_rooting_depth_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""present_ground_land_class_pacific_northwest_research_station"" NUMBER(38,0),
	""present_ground_land_class_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""plant_stockability_factor_pacific_northwest_research_station"" FLOAT,
	""stand_condition_code_pacific_northwest_research_station"" NUMBER(38,0),
	""stand_condition_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""stand_structure_code_pacific_northwest_research_station"" NUMBER(38,0),
	""stand_structure_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""stump_code_pacific_northwest_research_station"" VARCHAR(16777216),
	""stump_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""fire_southern_research_station"" BOOLEAN,
	""fire_southern_research_station_name"" VARCHAR(16777216),
	""grazing_southern_research_station"" BOOLEAN,
	""grazing_southern_research_station_name"" VARCHAR(16777216),
	""harvest_type_code_1_southern_research_station"" NUMBER(38,0),
	""harvest_type_code_1_southern_research_station_name"" VARCHAR(16777216),
	""harvest_type_code_2_southern_research_station"" NUMBER(38,0),
	""harvest_type_code_3_southern_research_station"" NUMBER(38,0),
	""land_use_southern_research_station"" NUMBER(38,0),
	""land_use_southern_research_station_name"" VARCHAR(16777216),
	""operability_southern_research_station"" NUMBER(38,0),
	""operability_southern_research_station_name"" VARCHAR(16777216),
	""stand_structure_southern_research_station"" NUMBER(38,0),
	""stand_structure_southern_research_station_name"" VARCHAR(16777216),
	""nonforest_condition_status_code"" NUMBER(38,0),
	""nonforest_condition_status_code_name"" VARCHAR(16777216),
	""nonforest_condition_nonsampled_reason_code"" NUMBER(38,0),
	""nonforest_condition_nonsampled_reason_code_name"" VARCHAR(16777216),
	""canopy_cover_sample_method_code"" NUMBER(38,0),
	""canopy_cover_sample_method_code_name"" VARCHAR(16777216),
	""live_canopy_cover_percent"" NUMBER(38,0),
	""live_plus_missing_canopy_cover_percent"" NUMBER(38,0),
	""number_of_live_stems"" NUMBER(38,0),
	""owner_subclass_code"" VARCHAR(16777216),
	""owner_subclass_code_name"" VARCHAR(16777216),
	""industrial_code_in_fiadb"" VARCHAR(16777216),
	""industrial_code_in_fiadb_name"" VARCHAR(16777216),
	""reserve_code_field"" BOOLEAN,
	""reserve_code_field_name"" VARCHAR(16777216),
	""administratively_withdrawn_code"" VARCHAR(16777216),
	""administratively_withdrawn_code_name"" VARCHAR(16777216),
	""chaining_code"" BOOLEAN,
	""chaining_code_name"" VARCHAR(16777216),
	""land_cover_class"" NUMBER(38,0),
	""land_cover_class_name"" VARCHAR(16777216),
	""current_afforestation_code"" BOOLEAN,
	""current_afforestation_code_name"" VARCHAR(16777216),
	""previous_afforestation_code"" BOOLEAN,
	""previous_afforestation_code_name"" VARCHAR(16777216),
	""dwm_condition_fuelbed_type_code"" VARCHAR(16777216),
	""dwm_condition_fuelbed_type_code_name"" VARCHAR(16777216),
	""unique_condition"" VARCHAR(16777216)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,3
table_name,ESTIMATED_TIMBERLAND_ACRES
description,
DDL,"create or replace TABLE ESTIMATED_TIMBERLAND_ACRES (
	""plot_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""evaluation_group"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""inventory_year"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""macroplot_acres"" FLOAT,
	""subplot_acres"" FLOAT
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,4
table_name,POPULATION_STRATUM
description,
DDL,"create or replace TABLE POPULATION_STRATUM (
	""stratum_sequence_number"" NUMBER(38,0),
	""estimation_unit_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""stratum_code"" NUMBER(38,0),
	""stratum_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""phase_1_point_count"" NUMBER(38,0),
	""phase_2_point_count"" NUMBER(38,0),
	""expansion_factor"" FLOAT,
	""adjustment_factor_for_the_macroplot"" FLOAT,
	""adjustment_factor_for_the_subplot"" FLOAT,
	""adjustment_factor_for_the_microplot"" FLOAT,
	""adjustment_factor_for_coarse_woody_debris"" FLOAT,
	""adjustment_factor_for_small_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_large_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_the_duff_and_litter_layer"" FLOAT,
	""pop_stratum_created_by"" VARCHAR(16777216),
	""pop_stratum_created_date"" DATE,
	""pop_stratum_created_in_instance"" NUMBER(38,0),
	""pop_stratum_modified_by"" VARCHAR(16777216),
	""pop_stratum_modified_date"" DATE,
	""pop_stratum_modified_in_instance"" NUMBER(38,0),
	""pop_stratum_adjustment_factor_for_piles"" FLOAT,
	""adj_factor_regen_micr"" VARCHAR(16777216),
	""adj_factor_inv_subp"" VARCHAR(16777216),
	""adj_factor_p2veg_subp"" VARCHAR(16777216),
	""adj_factor_grndlyr_quad"" VARCHAR(16777216)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,5
table_name,PLOT
description,
DDL,"create or replace TABLE PLOT (
	""plot_sequence_number"" NUMBER(38,0),
	""survey_sequence_number"" NUMBER(38,0),
	""county_sequence_number"" NUMBER(38,0),
	""previous_plot_sequence_number"" NUMBER(38,0),
	""plot_inventory_year"" NUMBER(38,0),
	""plot_state_code"" NUMBER(38,0),
	""plot_state_code_name"" VARCHAR(16777216),
	""plot_survey_unit_code"" NUMBER(38,0),
	""plot_county_code"" NUMBER(38,0),
	""plot_phase_2_plot_number"" NUMBER(38,0),
	""plot_status_code"" NUMBER(38,0),
	""plot_status_code_name"" VARCHAR(16777216),
	""plot_nonsampled_reason_code"" NUMBER(38,0),
	""plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""measurement_year"" NUMBER(38,0),
	""measurement_month"" NUMBER(38,0),
	""measurement_month_name"" VARCHAR(16777216),
	""measurement_day"" NUMBER(38,0),
	""remeasurement_period"" FLOAT,
	""sample_kind_code"" NUMBER(38,0),
	""sample_kind_code_name"" VARCHAR(16777216),
	""plot_design_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code_name"" VARCHAR(16777216),
	""water_on_plot_code"" NUMBER(38,0),
	""water_on_plot_code_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""elevation"" NUMBER(38,0),
	""type_of_annual_volume_growth_code"" NUMBER(38,0),
	""type_of_annual_volume_growth_code_name"" VARCHAR(16777216),
	""type_of_annual_mortality_volume_code"" NUMBER(38,0),
	""type_of_annual_mortality_volume_code_name"" VARCHAR(16777216),
	""phase_2_panel_number"" NUMBER(38,0),
	""phase_3_panel_number"" NUMBER(38,0),
	""ecological_subsection_code"" VARCHAR(16777216),
	""congressional_district_code"" NUMBER(38,0),
	""manual_version_number"" FLOAT,
	""sample_kind_code_north_central"" NUMBER(38,0),
	""quality_assurance_status"" NUMBER(38,0),
	""quality_assurance_status_name"" VARCHAR(16777216),
	""plot_created_by"" VARCHAR(16777216),
	""plot_created_date"" DATE,
	""plot_created_in_instance"" NUMBER(38,0),
	""plot_modified_by"" VARCHAR(16777216),
	""plot_modified_date"" DATE,
	""plot_modified_in_instance"" NUMBER(38,0),
	""microplot_location"" VARCHAR(16777216),
	""declination"" FLOAT,
	""emap_hexagon"" NUMBER(38,0),
	""sample_method_code"" NUMBER(38,0),
	""sample_method_code_name"" VARCHAR(16777216),
	""subplots_examined_code"" NUMBER(38,0),
	""subplots_examined_code_name"" VARCHAR(16777216),
	""macroplot_breakpoint_diameter"" NUMBER(38,0),
	""intensity"" NUMBER(38,0),
	""plot_inventory_cycle_number"" NUMBER(38,0),
	""plot_inventory_subcycle_number"" NUMBER(38,0),
	""ecological_unit_pacific_northwest_research_station"" VARCHAR(16777216),
	""topographic_position_pacific_northwest_research_station"" NUMBER(38,0),
	""topographic_position_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""nonforest_sampling_status_code"" NUMBER(38,0),
	""nonforest_sampling_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_status_code"" NUMBER(38,0),
	""nonforest_plot_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_nonsampled_reason_code"" NUMBER(38,0),
	""nonforest_plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_status_code"" NUMBER(38,0),
	""p2_vegetation_sampling_status_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_level_detail_code"" NUMBER(38,0),
	""p2_vegetation_sampling_level_detail_code_name"" VARCHAR(16777216),
	""invasive_sampling_status_code"" NUMBER(38,0),
	""invasive_sampling_status_code_name"" VARCHAR(16777216),
	""invasive_specimen_rule_code"" NUMBER(38,0),
	""invasive_specimen_rule_code_name"" VARCHAR(16777216),
	""design_code_periodic_to_annual"" NUMBER(38,0),
	""manual_version_of_the_data"" FLOAT,
	""subpanel"" NUMBER(38,0),
	""subpanel_name"" VARCHAR(16777216),
	""unique_plot"" VARCHAR(16777216),
	""colocated_code_rmrs"" VARCHAR(16777216),
	""condchng_code_rmrs"" VARCHAR(16777216),
	""futfor_code_rmrs"" VARCHAR(16777216),
	""manual_ncrs"" VARCHAR(16777216),
	""manual_ners"" VARCHAR(16777216),
	""manual_rmrs"" VARCHAR(16777216),
	""pac_island_pnwrs"" VARCHAR(16777216),
	""plot_season_ners"" VARCHAR(16777216),
	""precipitation"" VARCHAR(16777216),
	""prev_microplot_loc_rmrs"" VARCHAR(16777216),
	""prev_plot_status_code_rmrs"" VARCHAR(16777216),
	""reuse_code_1"" VARCHAR(16777216),
	""reuse_code_2"" VARCHAR(16777216),
	""reuse_code_3"" VARCHAR(16777216)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,6
table_name,POPULATION_EVALUATION_TYPE
description,
DDL,"create or replace TABLE POPULATION_EVALUATION_TYPE (
	""evaluation_type_sequence_number"" NUMBER(38,0),
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""evaluation_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""eval_type_created_by"" VARCHAR(16777216),
	""eval_type_created_date"" DATE,
	""eval_type_created_in_instance"" NUMBER(38,0),
	""eval_type_modified_by"" VARCHAR(16777216),
	""eval_type_modified_date"" DATE,
	""eval_type_modified_in_instance"" NUMBER(38,0)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,7
table_name,POPULATION_STRATUM_ASSIGN
description,
DDL,"create or replace TABLE POPULATION_STRATUM_ASSIGN (
	""stratum_assign_sequence_number"" VARCHAR(16777216),
	""stratum_sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""inventory_year"" NUMBER(38,0),
	""survey_unit_code"" NUMBER(38,0),
	""county_code"" NUMBER(38,0),
	""phase_2_plot_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""stratum_code"" NUMBER(38,0),
	""stratum_assign_created_by"" VARCHAR(16777216),
	""stratum_assign_created_date"" DATE,
	""stratum_assign_created_in_instance"" NUMBER(38,0),
	""stratum_assign_modified_by"" VARCHAR(16777216),
	""stratum_assign_modified_date"" DATE,
	""stratum_assign_modified_in_instance"" NUMBER(38,0)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,8
table_name,ESTIMATED_FORESTLAND_ACRES
description,
DDL,"create or replace TABLE ESTIMATED_FORESTLAND_ACRES (
	""plot_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""evaluation_group"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""inventory_year"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""macroplot_acres"" FLOAT,
	""subplot_acres"" FLOAT
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,9
table_name,PLOT_TREE
description,
DDL,"create or replace TABLE PLOT_TREE (
	""plot_sequence_number"" NUMBER(38,0),
	""survey_sequence_number"" NUMBER(38,0),
	""county_sequence_number"" NUMBER(38,0),
	""previous_plot_sequence_number"" NUMBER(38,0),
	""plot_inventory_year"" NUMBER(38,0),
	""plot_state_code"" NUMBER(38,0),
	""plot_state_code_name"" VARCHAR(16777216),
	""plot_survey_unit_code"" NUMBER(38,0),
	""plot_county_code"" NUMBER(38,0),
	""plot_phase_2_plot_number"" NUMBER(38,0),
	""plot_status_code"" NUMBER(38,0),
	""plot_status_code_name"" VARCHAR(16777216),
	""plot_nonsampled_reason_code"" NUMBER(38,0),
	""plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""measurement_year"" NUMBER(38,0),
	""measurement_month"" NUMBER(38,0),
	""measurement_month_name"" VARCHAR(16777216),
	""measurement_day"" NUMBER(38,0),
	""remeasurement_period"" FLOAT,
	""sample_kind_code"" NUMBER(38,0),
	""sample_kind_code_name"" VARCHAR(16777216),
	""plot_design_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code_name"" VARCHAR(16777216),
	""water_on_plot_code"" NUMBER(38,0),
	""water_on_plot_code_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""elevation"" NUMBER(38,0),
	""type_of_annual_volume_growth_code"" NUMBER(38,0),
	""type_of_annual_volume_growth_code_name"" VARCHAR(16777216),
	""type_of_annual_mortality_volume_code"" NUMBER(38,0),
	""type_of_annual_mortality_volume_code_name"" VARCHAR(16777216),
	""phase_2_panel_number"" NUMBER(38,0),
	""phase_3_panel_number"" NUMBER(38,0),
	""ecological_subsection_code"" VARCHAR(16777216),
	""congressional_district_code"" NUMBER(38,0),
	""manual_version_number"" FLOAT,
	""sample_kind_code_north_central"" NUMBER(38,0),
	""quality_assurance_status"" NUMBER(38,0),
	""quality_assurance_status_name"" VARCHAR(16777216),
	""plot_created_by"" VARCHAR(16777216),
	""plot_created_date"" DATE,
	""plot_created_in_instance"" NUMBER(38,0),
	""plot_modified_by"" VARCHAR(16777216),
	""plot_modified_date"" DATE,
	""plot_modified_in_instance"" NUMBER(38,0),
	""microplot_location"" VARCHAR(16777216),
	""declination"" FLOAT,
	""emap_hexagon"" NUMBER(38,0),
	""sample_method_code"" NUMBER(38,0),
	""sample_method_code_name"" VARCHAR(16777216),
	""subplots_examined_code"" NUMBER(38,0),
	""subplots_examined_code_name"" VARCHAR(16777216),
	""macroplot_breakpoint_diameter"" NUMBER(38,0),
	""intensity"" NUMBER(38,0),
	""plot_inventory_cycle_number"" NUMBER(38,0),
	""plot_inventory_subcycle_number"" NUMBER(38,0),
	""ecological_unit_pacific_northwest_research_station"" VARCHAR(16777216),
	""topographic_position_pacific_northwest_research_station"" NUMBER(38,0),
	""topographic_position_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""nonforest_sampling_status_code"" NUMBER(38,0),
	""nonforest_sampling_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_status_code"" NUMBER(38,0),
	""nonforest_plot_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_nonsampled_reason_code"" NUMBER(38,0),
	""nonforest_plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_status_code"" NUMBER(38,0),
	""p2_vegetation_sampling_status_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_level_detail_code"" NUMBER(38,0),
	""p2_vegetation_sampling_level_detail_code_name"" VARCHAR(16777216),
	""invasive_sampling_status_code"" NUMBER(38,0),
	""invasive_sampling_status_code_name"" VARCHAR(16777216),
	""invasive_specimen_rule_code"" NUMBER(38,0),
	""invasive_specimen_rule_code_name"" VARCHAR(16777216),
	""design_code_periodic_to_annual"" NUMBER(38,0),
	""manual_version_of_the_data"" FLOAT,
	""subpanel"" NUMBER(38,0),
	""subpanel_name"" VARCHAR(16777216),
	""unique_plot"" VARCHAR(16777216),
	""colocated_code_rmrs"" VARCHAR(16777216),
	""condchng_code_rmrs"" VARCHAR(16777216),
	""futfor_code_rmrs"" VARCHAR(16777216),
	""manual_ncrs"" VARCHAR(16777216),
	""manual_ners"" VARCHAR(16777216),
	""manual_rmrs"" VARCHAR(16777216),
	""pac_island_pnwrs"" VARCHAR(16777216),
	""plot_season_ners"" VARCHAR(16777216),
	""precipitation"" VARCHAR(16777216),
	""prev_microplot_loc_rmrs"" VARCHAR(16777216),
	""prev_plot_status_code_rmrs"" VARCHAR(16777216),
	""reuse_code_1"" VARCHAR(16777216),
	""reuse_code_2"" VARCHAR(16777216),
	""reuse_code_3"" VARCHAR(16777216),
	""tree_sequence_number"" NUMBER(38,0),
	""previous_tree_sequence_number"" NUMBER(38,0),
	""tree_inventory_year"" NUMBER(38,0),
	""tree_state_code"" NUMBER(38,0),
	""tree_survey_unit_code"" NUMBER(38,0),
	""tree_county_code"" NUMBER(38,0),
	""tree_phase_2_plot_number"" NUMBER(38,0),
	""subplot_number"" NUMBER(38,0),
	""tree_record_number"" NUMBER(38,0),
	""condition_class_number"" NUMBER(38,0),
	""azimuth"" NUMBER(38,0),
	""horizontal_distance"" FLOAT,
	""previous_condition_number"" NUMBER(38,0),
	""tree_status_code"" NUMBER(38,0),
	""tree_status_code_name"" VARCHAR(16777216),
	""species_code"" NUMBER(38,0),
	""species_common_name"" VARCHAR(16777216),
	""species_scientific_name"" VARCHAR(16777216),
	""species_group_code"" NUMBER(38,0),
	""species_group_code_name"" VARCHAR(16777216),
	""current_diameter"" FLOAT,
	""diameter_height_code"" NUMBER(38,0),
	""diameter_height_code_name"" VARCHAR(16777216),
	""total_height"" NUMBER(38,0),
	""height_method_code"" NUMBER(38,0),
	""height_method_code_name"" VARCHAR(16777216),
	""actual_height"" NUMBER(38,0),
	""tree_class_code"" NUMBER(38,0),
	""tree_class_code_name"" VARCHAR(16777216),
	""compacted_crown_ratio"" NUMBER(38,0),
	""crown_class_code"" NUMBER(38,0),
	""crown_class_code_name"" VARCHAR(16777216),
	""tree_grade_code"" NUMBER(38,0),
	""cause_death_agent_code"" NUMBER(38,0),
	""cause_death_agent_code_name"" VARCHAR(16777216),
	""rotten_and_missing_cull"" NUMBER(38,0),
	""damage_location_1"" NUMBER(38,0),
	""damage_location_1_name"" VARCHAR(16777216),
	""damage_type_1"" NUMBER(38,0),
	""damage_type_1_name"" VARCHAR(16777216),
	""damage_severity_1"" NUMBER(38,0),
	""damage_severity_1_name"" VARCHAR(16777216),
	""damage_location_2"" NUMBER(38,0),
	""damage_location_2_name"" VARCHAR(16777216),
	""damage_type_2"" NUMBER(38,0),
	""damage_type_2_name"" VARCHAR(16777216),
	""damage_severity_2"" NUMBER(38,0),
	""damage_severity_2_name"" VARCHAR(16777216),
	""decay_class_code"" NUMBER(38,0),
	""decay_class_code_name"" VARCHAR(16777216),
	""tree_stocking"" FLOAT,
	""woodland_tree_species_stem_count"" NUMBER(38,0),
	""net_cubicfoot_volume"" FLOAT,
	""gross_cubicfoot_volume"" FLOAT,
	""net_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""net_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""sound_cubicfoot_volume"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_timberland"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_timberland"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_timberland"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_timberland_removal_purposes"" FLOAT,
	""diameter_check_code"" NUMBER(38,0),
	""diameter_check_code_name"" VARCHAR(16777216),
	""mortality_year"" NUMBER(38,0),
	""salvable_dead_code"" NUMBER(38,0),
	""salvable_dead_code_name"" VARCHAR(16777216),
	""uncompacted_live_crown_ratio"" NUMBER(38,0),
	""crown_position_code"" NUMBER(38,0),
	""crown_position_code_name"" VARCHAR(16777216),
	""crown_light_exposure_code"" NUMBER(38,0),
	""crown_light_exposure_code_name"" VARCHAR(16777216),
	""crown_vigor_code_sapling"" NUMBER(38,0),
	""crown_vigor_code_sapling_name"" VARCHAR(16777216),
	""crown_density_code"" NUMBER(38,0),
	""crown_density_code_name"" VARCHAR(16777216),
	""crown_dieback_code"" NUMBER(38,0),
	""crown_dieback_code_name"" VARCHAR(16777216),
	""foliage_transparency_code"" NUMBER(38,0),
	""foliage_transparency_code_name"" VARCHAR(16777216),
	""tree_history_code"" NUMBER(38,0),
	""current_diameter_calculated"" FLOAT,
	""breast_height_age"" NUMBER(38,0),
	""total_age"" NUMBER(38,0),
	""dead_cull"" NUMBER(38,0),
	""form_cull"" NUMBER(38,0),
	""missing_top_cull_field_recorded"" NUMBER(38,0),
	""boardfoot_cull"" NUMBER(38,0),
	""cubicfoot_cull"" NUMBER(38,0),
	""boardfootcull_soundness"" NUMBER(38,0),
	""cubicfootcull_soundness"" NUMBER(38,0),
	""sawlog_height"" NUMBER(38,0),
	""bole_height"" NUMBER(38,0),
	""form_class"" NUMBER(38,0),
	""form_class_name"" VARCHAR(16777216),
	""current_height_calculated"" NUMBER(38,0),
	""hardwood_clump_code"" NUMBER(38,0),
	""calculated_site_index"" NUMBER(38,0),
	""tree_created_by"" NUMBER(38,0),
	""tree_created_date"" DATE,
	""tree_created_in_instance"" NUMBER(38,0),
	""tree_modified_by"" NUMBER(38,0),
	""tree_modified_date"" DATE,
	""tree_modified_in_instance"" NUMBER(38,0),
	""mortality_code"" NUMBER(38,0),
	""mortality_code_name"" VARCHAR(16777216),
	""height_to_diameter_measurement_point"" FLOAT,
	""rough_cull"" NUMBER(38,0),
	""mistletoe_class_code"" NUMBER(38,0),
	""mistletoe_class_code_name"" VARCHAR(16777216),
	""rotten_missing_cull_field_recorded"" NUMBER(38,0),
	""reconcile_code"" NUMBER(38,0),
	""reconcile_code_name"" VARCHAR(16777216),
	""previous_diameter"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_forest_land"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_forest_land"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_forest_land"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_forest_land_removal_purposes"" FLOAT,
	""periodic_annual_growth_removal_mortality_flag"" VARCHAR(16777216),
	""tree_class_code_northeastern_research_station"" NUMBER(38,0),
	""tree_class_code_northeastern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_southern_research_station"" NUMBER(38,0),
	""tree_class_code_southern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_north_central_research_station"" NUMBER(38,0),
	""tree_class_code_north_central_research_station_name"" VARCHAR(16777216),
	""tree_class_code_rocky_mountain_research_station"" NUMBER(38,0),
	""tree_class_code_rocky_mountain_research_station_name"" VARCHAR(16777216),
	""standing_dead_code"" NUMBER(38,0),
	""standing_dead_code_name"" VARCHAR(16777216),
	""previous_tree_status_code"" NUMBER(38,0),
	""previous_tree_status_code_name"" VARCHAR(16777216),
	""previous_woodland_stem_count"" VARCHAR(16777216),
	""trees_per_acre_unadjusted"" FLOAT,
	""mortality_trees_per_acre_per_year_unadjusted"" FLOAT,
	""removal_trees_per_acre_per_year_unadjusted"" FLOAT,
	""growth_trees_per_acre_unadjusted"" FLOAT,
	""dry_biomass_in_the_merchantable_bole"" FLOAT,
	""dry_biomass_top_limbs_tree"" FLOAT,
	""dry_biomass_tree_stump_at_T_1"" FLOAT,
	""aboveground_dry_biomass_saplings"" FLOAT,
	""aboveground_dry_biomass_woodland_tree_species"" FLOAT,
	""belowground_dry_biomass"" FLOAT,
	""aboveground_carbon"" FLOAT,
	""belowground_carbon"" FLOAT,
	""tree_inventory_cycle_number"" NUMBER(38,0),
	""tree_inventory_subcycle_number"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""diameter_check_pacific_northwest_research_station"" NUMBER(38,0),
	""diameter_check_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_agent_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_3_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_1_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_1_a_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_2_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_2_a_pacific_northwest_research_station_starting_2005"" NUMBER(38,0),
	""damage_severity_2_b_pacific_northwest_research_station_starting_2005"" VARCHAR(16777216),
	""damage_severity_3_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""unknown_damage_type_2_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""previous_periodic_prism_point_tree_number_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station_name"" VARCHAR(16777216),
	""dieback_severity_southern_research_station"" NUMBER(38,0),
	""dieback_severity_southern_research_station_name"" VARCHAR(16777216),
	""damage_agent_code_1"" NUMBER(38,0),
	""damage_agent_code_1_name"" VARCHAR(16777216),
	""damage_agent_code_2"" VARCHAR(16777216),
	""damage_agent_code_2_name"" VARCHAR(16777216),
	""damage_agent_code_3"" NUMBER(38,0),
	""damage_agent_code_3_name"" VARCHAR(16777216),
	""centroid_diameter"" FLOAT,
	""calculated_centroid_diameter_height"" FLOAT,
	""actual_centroid_diameter_height"" FLOAT,
	""upper_stem_diameter"" NUMBER(38,0),
	""upper_stem_diameter_height"" NUMBER(38,0),
	""sound_cubicfoot_volume_sawlog_portion"" FLOAT,
	""dry_biomass_sawlog_portion_sawtimber_tree"" FLOAT,
	""damage_agent_code_1_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_2_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_3_southern_research_station"" VARCHAR(16777216),
	""aboveground_dry_biomass"" FLOAT,
	""unique_tree"" VARCHAR(16777216),
	""actualht_calc"" VARCHAR(16777216),
	""actualht_calc_code"" VARCHAR(16777216),
	""cull_bf_rotten"" VARCHAR(16777216),
	""cull_bf_rotten_code"" VARCHAR(16777216),
	""cull_bf_rough"" VARCHAR(16777216),
	""cull_bf_rough_code"" VARCHAR(16777216),
	""prevdia_fld"" VARCHAR(16777216),
	""treecl_code_31_ncrs"" VARCHAR(16777216),
	""tree_grade_ncrs"" VARCHAR(16777216),
	""boughs_available_ncrs"" VARCHAR(16777216),
	""boughs_hrvst_ncrs"" VARCHAR(16777216),
	""treecl_code_31_ners"" VARCHAR(16777216),
	""agent_code_ners"" VARCHAR(16777216),
	""bfsnd_code_ners"" VARCHAR(16777216),
	""agechk_code_rmrs"" VARCHAR(16777216),
	""dia_1yrago_rmrs"" VARCHAR(16777216),
	""growbfscr_rmrs"" VARCHAR(16777216),
	""growcfsawlog_rmrs"" VARCHAR(16777216),
	""ht_1yrago_rmrs"" VARCHAR(16777216),
	""prev_actualht_rmrs"" VARCHAR(16777216),
	""prev_agechk_code_rmrs"" VARCHAR(16777216),
	""prev_bhage_rmrs"" VARCHAR(16777216),
	""prev_ht_rmrs"" VARCHAR(16777216),
	""prev_totage_rmrs"" VARCHAR(16777216),
	""prev_treecl_code_rmrs"" VARCHAR(16777216),
	""radage_code_rmrs"" VARCHAR(16777216),
	""radgrw_rmrs"" VARCHAR(16777216),
	""volbfscrgrs_rmrs"" VARCHAR(16777216),
	""volbfscrnet_rmrs"" VARCHAR(16777216),
	""volcfdeadgrs_rmrs"" VARCHAR(16777216),
	""volcfsawgrs_rmrs"" VARCHAR(16777216),
	""volcfsawnet_rmrs"" VARCHAR(16777216),
	""volcftotnet_rmrs"" VARCHAR(16777216),
	""volcfuppgrs_rmrs"" VARCHAR(16777216),
	""volcfuppnet_rmrs"" VARCHAR(16777216),
	""sapling_fusiform_srs"" VARCHAR(16777216),
	""epiphyte_pnwrs"" VARCHAR(16777216),
	""root_ht_pnwrs"" VARCHAR(16777216),
	""cavity_use_pnwrs"" VARCHAR(16777216),
	""core_length_pnwrs"" VARCHAR(16777216),
	""culturally_killed_pnwrs"" VARCHAR(16777216),
	""dia_est_pnwrs"" VARCHAR(16777216),
	""gst_pnwrs"" VARCHAR(16777216),
	""inc10yr_pnwrs"" VARCHAR(16777216),
	""inc5yrht_pnwrs"" VARCHAR(16777216),
	""inc5yr_pnwrs"" VARCHAR(16777216),
	""ring_count_inner_2inches_pnwrs"" VARCHAR(16777216),
	""ring_count_pnwrs"" VARCHAR(16777216),
	""snag_dis_code_pnwrs"" VARCHAR(16777216)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,10
table_name,POPULATION_ESTIMATION_UNIT
description,
DDL,"create or replace TABLE POPULATION_ESTIMATION_UNIT (
	""estimation_unit_sequence_number"" NUMBER(38,0),
	""evaluation_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""estimation_unit_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""land_area_within_the_estimation_unit"" FLOAT,
	""total_area_within_the_estimation_unit"" FLOAT,
	""area_used_to_calculate_all_expansion_factors"" FLOAT,
	""area_source"" VARCHAR(16777216),
	""phase_1_point_count_for_the_estimation_unit"" NUMBER(38,0),
	""phase_1_source"" VARCHAR(16777216),
	""eval_unit_created_by"" VARCHAR(16777216),
	""eval_unit_created_date"" DATE,
	""eval_unit_created_in_instance"" NUMBER(38,0),
	""eval_unit_modified_by"" VARCHAR(16777216),
	""eval_unit_modified_date"" DATE,
	""eval_unit_modified_in_instance"" NUMBER(38,0)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,11
table_name,POPULATION_EVALUATION
description,
DDL,"create or replace TABLE POPULATION_EVALUATION (
	""evaluation_sequence_number"" NUMBER(38,0),
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""location_name"" VARCHAR(16777216),
	""report_year_name"" VARCHAR(16777216),
	""start_inventory_year"" VARCHAR(16777216),
	""end_inventory_year"" VARCHAR(16777216),
	""land_only"" VARCHAR(16777216),
	""timberland_only"" VARCHAR(16777216),
	""growth_accounting"" VARCHAR(16777216),
	""estimation_method"" VARCHAR(16777216),
	""notes"" VARCHAR(16777216),
	""pop_evaluation_created_by"" VARCHAR(16777216),
	""pop_evaluation_created_date"" DATE,
	""pop_evaluation_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_modified_by"" VARCHAR(16777216),
	""pop_evaluation_modified_date"" DATE,
	""pop_evaluation_modified_in_instance"" NUMBER(38,0)
);"

Database Name: USFS_FIA
Schema Name: USFS_FIA
,12
table_name,TREE
description,
DDL,"create or replace TABLE TREE (
	""tree_sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""previous_tree_sequence_number"" NUMBER(38,0),
	""tree_inventory_year"" NUMBER(38,0),
	""tree_state_code"" NUMBER(38,0),
	""tree_survey_unit_code"" NUMBER(38,0),
	""tree_county_code"" NUMBER(38,0),
	""tree_phase_2_plot_number"" NUMBER(38,0),
	""subplot_number"" NUMBER(38,0),
	""tree_record_number"" NUMBER(38,0),
	""condition_class_number"" NUMBER(38,0),
	""azimuth"" NUMBER(38,0),
	""horizontal_distance"" FLOAT,
	""previous_condition_number"" NUMBER(38,0),
	""tree_status_code"" NUMBER(38,0),
	""tree_status_code_name"" VARCHAR(16777216),
	""species_code"" NUMBER(38,0),
	""species_common_name"" VARCHAR(16777216),
	""species_scientific_name"" VARCHAR(16777216),
	""species_group_code"" NUMBER(38,0),
	""species_group_code_name"" VARCHAR(16777216),
	""current_diameter"" FLOAT,
	""diameter_height_code"" NUMBER(38,0),
	""diameter_height_code_name"" VARCHAR(16777216),
	""total_height"" NUMBER(38,0),
	""height_method_code"" NUMBER(38,0),
	""height_method_code_name"" VARCHAR(16777216),
	""actual_height"" NUMBER(38,0),
	""tree_class_code"" NUMBER(38,0),
	""tree_class_code_name"" VARCHAR(16777216),
	""compacted_crown_ratio"" NUMBER(38,0),
	""crown_class_code"" NUMBER(38,0),
	""crown_class_code_name"" VARCHAR(16777216),
	""tree_grade_code"" NUMBER(38,0),
	""cause_death_agent_code"" NUMBER(38,0),
	""cause_death_agent_code_name"" VARCHAR(16777216),
	""rotten_and_missing_cull"" NUMBER(38,0),
	""damage_location_1"" NUMBER(38,0),
	""damage_location_1_name"" VARCHAR(16777216),
	""damage_type_1"" NUMBER(38,0),
	""damage_type_1_name"" VARCHAR(16777216),
	""damage_severity_1"" NUMBER(38,0),
	""damage_severity_1_name"" VARCHAR(16777216),
	""damage_location_2"" NUMBER(38,0),
	""damage_location_2_name"" VARCHAR(16777216),
	""damage_type_2"" NUMBER(38,0),
	""damage_type_2_name"" VARCHAR(16777216),
	""damage_severity_2"" NUMBER(38,0),
	""damage_severity_2_name"" VARCHAR(16777216),
	""decay_class_code"" NUMBER(38,0),
	""decay_class_code_name"" VARCHAR(16777216),
	""tree_stocking"" FLOAT,
	""woodland_tree_species_stem_count"" NUMBER(38,0),
	""net_cubicfoot_volume"" FLOAT,
	""gross_cubicfoot_volume"" FLOAT,
	""net_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""net_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""sound_cubicfoot_volume"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_timberland"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_timberland"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_timberland"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_timberland_removal_purposes"" FLOAT,
	""diameter_check_code"" NUMBER(38,0),
	""diameter_check_code_name"" VARCHAR(16777216),
	""mortality_year"" NUMBER(38,0),
	""salvable_dead_code"" NUMBER(38,0),
	""salvable_dead_code_name"" VARCHAR(16777216),
	""uncompacted_live_crown_ratio"" NUMBER(38,0),
	""crown_position_code"" NUMBER(38,0),
	""crown_position_code_name"" VARCHAR(16777216),
	""crown_light_exposure_code"" NUMBER(38,0),
	""crown_light_exposure_code_name"" VARCHAR(16777216),
	""crown_vigor_code_sapling"" NUMBER(38,0),
	""crown_vigor_code_sapling_name"" VARCHAR(16777216),
	""crown_density_code"" NUMBER(38,0),
	""crown_density_code_name"" VARCHAR(16777216),
	""crown_dieback_code"" NUMBER(38,0),
	""crown_dieback_code_name"" VARCHAR(16777216),
	""foliage_transparency_code"" NUMBER(38,0),
	""foliage_transparency_code_name"" VARCHAR(16777216),
	""tree_history_code"" NUMBER(38,0),
	""current_diameter_calculated"" FLOAT,
	""breast_height_age"" NUMBER(38,0),
	""total_age"" NUMBER(38,0),
	""dead_cull"" NUMBER(38,0),
	""form_cull"" NUMBER(38,0),
	""missing_top_cull_field_recorded"" NUMBER(38,0),
	""boardfoot_cull"" NUMBER(38,0),
	""cubicfoot_cull"" NUMBER(38,0),
	""boardfootcull_soundness"" NUMBER(38,0),
	""cubicfootcull_soundness"" NUMBER(38,0),
	""sawlog_height"" NUMBER(38,0),
	""bole_height"" NUMBER(38,0),
	""form_class"" NUMBER(38,0),
	""form_class_name"" VARCHAR(16777216),
	""current_height_calculated"" NUMBER(38,0),
	""hardwood_clump_code"" NUMBER(38,0),
	""calculated_site_index"" NUMBER(38,0),
	""tree_created_by"" NUMBER(38,0),
	""tree_created_date"" DATE,
	""tree_created_in_instance"" NUMBER(38,0),
	""tree_modified_by"" NUMBER(38,0),
	""tree_modified_date"" DATE,
	""tree_modified_in_instance"" NUMBER(38,0),
	""mortality_code"" NUMBER(38,0),
	""mortality_code_name"" VARCHAR(16777216),
	""height_to_diameter_measurement_point"" FLOAT,
	""rough_cull"" NUMBER(38,0),
	""mistletoe_class_code"" NUMBER(38,0),
	""mistletoe_class_code_name"" VARCHAR(16777216),
	""rotten_missing_cull_field_recorded"" NUMBER(38,0),
	""reconcile_code"" NUMBER(38,0),
	""reconcile_code_name"" VARCHAR(16777216),
	""previous_diameter"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_forest_land"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_forest_land"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_forest_land"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_forest_land_removal_purposes"" FLOAT,
	""periodic_annual_growth_removal_mortality_flag"" VARCHAR(16777216),
	""tree_class_code_northeastern_research_station"" NUMBER(38,0),
	""tree_class_code_northeastern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_southern_research_station"" NUMBER(38,0),
	""tree_class_code_southern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_north_central_research_station"" NUMBER(38,0),
	""tree_class_code_north_central_research_station_name"" VARCHAR(16777216),
	""tree_class_code_rocky_mountain_research_station"" NUMBER(38,0),
	""tree_class_code_rocky_mountain_research_station_name"" VARCHAR(16777216),
	""standing_dead_code"" NUMBER(38,0),
	""standing_dead_code_name"" VARCHAR(16777216),
	""previous_tree_status_code"" NUMBER(38,0),
	""previous_tree_status_code_name"" VARCHAR(16777216),
	""previous_woodland_stem_count"" VARCHAR(16777216),
	""trees_per_acre_unadjusted"" FLOAT,
	""mortality_trees_per_acre_per_year_unadjusted"" FLOAT,
	""removal_trees_per_acre_per_year_unadjusted"" FLOAT,
	""growth_trees_per_acre_unadjusted"" FLOAT,
	""dry_biomass_in_the_merchantable_bole"" FLOAT,
	""dry_biomass_top_limbs_tree"" FLOAT,
	""dry_biomass_tree_stump_at_t_1"" FLOAT,
	""aboveground_dry_biomass_saplings"" FLOAT,
	""aboveground_dry_biomass_woodland_tree_species"" FLOAT,
	""belowground_dry_biomass"" FLOAT,
	""aboveground_carbon"" FLOAT,
	""belowground_carbon"" FLOAT,
	""tree_inventory_cycle_number"" NUMBER(38,0),
	""tree_inventory_subcycle_number"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""diameter_check_pacific_northwest_research_station"" NUMBER(38,0),
	""diameter_check_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_agent_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_3_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_1_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_1_a_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_2_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_2_a_pacific_northwest_research_station_starting_2005"" NUMBER(38,0),
	""damage_severity_2_b_pacific_northwest_research_station_starting_2005"" VARCHAR(16777216),
	""damage_severity_3_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""unknown_damage_type_2_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""previous_periodic_prism_point_tree_number_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station_name"" VARCHAR(16777216),
	""dieback_severity_southern_research_station"" NUMBER(38,0),
	""dieback_severity_southern_research_station_name"" VARCHAR(16777216),
	""damage_agent_code_1"" NUMBER(38,0),
	""damage_agent_code_1_name"" VARCHAR(16777216),
	""damage_agent_code_2"" VARCHAR(16777216),
	""damage_agent_code_2_name"" VARCHAR(16777216),
	""damage_agent_code_3"" NUMBER(38,0),
	""damage_agent_code_3_name"" VARCHAR(16777216),
	""centroid_diameter"" FLOAT,
	""calculated_centroid_diameter_height"" FLOAT,
	""actual_centroid_diameter_height"" FLOAT,
	""upper_stem_diameter"" NUMBER(38,0),
	""upper_stem_diameter_height"" NUMBER(38,0),
	""sound_cubicfoot_volume_sawlog_portion"" FLOAT,
	""dry_biomass_sawlog_portion_sawtimber_tree"" FLOAT,
	""damage_agent_code_1_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_2_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_3_southern_research_station"" VARCHAR(16777216),
	""aboveground_dry_biomass"" FLOAT,
	""unique_tree"" VARCHAR(16777216),
	""actualht_calc"" VARCHAR(16777216),
	""actualht_calc_code"" VARCHAR(16777216),
	""cull_bf_rotten"" VARCHAR(16777216),
	""cull_bf_rotten_code"" VARCHAR(16777216),
	""cull_bf_rough"" VARCHAR(16777216),
	""cull_bf_rough_code"" VARCHAR(16777216),
	""prevdia_fld"" VARCHAR(16777216),
	""treecl_code_31_ncrs"" VARCHAR(16777216),
	""tree_grade_ncrs"" VARCHAR(16777216),
	""boughs_available_ncrs"" VARCHAR(16777216),
	""boughs_hrvst_ncrs"" VARCHAR(16777216),
	""treecl_code_31_ners"" VARCHAR(16777216),
	""agent_code_ners"" VARCHAR(16777216),
	""bfsnd_code_ners"" VARCHAR(16777216),
	""agechk_code_rmrs"" VARCHAR(16777216),
	""dia_1yrago_rmrs"" VARCHAR(16777216),
	""growbfscr_rmrs"" VARCHAR(16777216),
	""growcfsawlog_rmrs"" VARCHAR(16777216),
	""ht_1yrago_rmrs"" VARCHAR(16777216),
	""prev_actualht_rmrs"" VARCHAR(16777216),
	""prev_agechk_code_rmrs"" VARCHAR(16777216),
	""prev_bhage_rmrs"" VARCHAR(16777216),
	""prev_ht_rmrs"" VARCHAR(16777216),
	""prev_totage_rmrs"" VARCHAR(16777216),
	""prev_treecl_code_rmrs"" VARCHAR(16777216),
	""radage_code_rmrs"" VARCHAR(16777216),
	""radgrw_rmrs"" VARCHAR(16777216),
	""volbfscrgrs_rmrs"" VARCHAR(16777216),
	""volbfscrnet_rmrs"" VARCHAR(16777216),
	""volcfdeadgrs_rmrs"" VARCHAR(16777216),
	""volcfsawgrs_rmrs"" VARCHAR(16777216),
	""volcfsawnet_rmrs"" VARCHAR(16777216),
	""volcftotnet_rmrs"" VARCHAR(16777216),
	""volcfuppgrs_rmrs"" VARCHAR(16777216),
	""volcfuppnet_rmrs"" VARCHAR(16777216),
	""sapling_fusiform_srs"" VARCHAR(16777216),
	""epiphyte_pnwrs"" VARCHAR(16777216),
	""root_ht_pnwrs"" VARCHAR(16777216),
	""cavity_use_pnwrs"" VARCHAR(16777216),
	""core_length_pnwrs"" VARCHAR(16777216),
	""culturally_killed_pnwrs"" VARCHAR(16777216),
	""dia_est_pnwrs"" VARCHAR(16777216),
	""gst_pnwrs"" VARCHAR(16777216),
	""inc10yr_pnwrs"" VARCHAR(16777216),
	""inc5yrht_pnwrs"" VARCHAR(16777216),
	""inc5yr_pnwrs"" VARCHAR(16777216),
	""ring_count_inner_2inches_pnwrs"" VARCHAR(16777216),
	""ring_count_pnwrs"" VARCHAR(16777216),
	""snag_dis_code_pnwrs"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
# Subplot Size and Macroplot Size Calculation Methods

## Overview

In forest inventory analysis, different types of plots are used to estimate forest characteristics. Two commonly used plot sizes are **subplot** and **macroplot**, each serving a distinct purpose for data collection at different scales.

This document provides a detailed explanation of the **subplot size** and **macroplot size** calculation methods using mathematical formulas.

## Subplot Size Calculation

### Definition
A **subplot** is a smaller area within a larger plot, often used to collect more detailed forest data. Subplots are utilized when fine-grained measurements are needed for specific forest conditions.

### Calculation Formula
The size of a subplot is calculated as follows:

\[
\text{Subplot Area} = 
\begin{cases} 
E \times P \times A_s, & \text{if proportion basis} = \text{'SUBP'} \text{ and } A_s > 0 \\
0, & \text{otherwise}
\end{cases}
\]

### Explanation of Terms:
- **E** (Expansion Factor): A multiplier used to adjust the size of the subplot to account for its proportion within a larger area.
- **P** (Condition Proportion Unadjusted): Represents the unadjusted proportion of the forest condition within the subplot.
- **A_s** (Adjustment Factor for Subplot): A factor applied to adjust the subplot size based on specific conditions or measurements.

### Interpretation:
If the **proportion basis** is `'SUBP'` and the **adjustment factor for the subplot** \( A_s \) is greater than 0, the subplot size is calculated by multiplying the **expansion factor** \( E \), **condition proportion** \( P \), and the **adjustment factor** \( A_s \):

\[
\text{Subplot Area} = E \times P \times A_s
\]

If these conditions are not met, the subplot size is set to 0.

## Macroplot Size Calculation

### Definition
A **macroplot** is a larger area within a forest inventory used for broader data collection. Macroplots cover more extensive areas compared to subplots and are used to estimate forest characteristics applicable to large sections of the forest.

### Calculation Formula
The size of a macroplot is calculated as follows:

\[
\text{Macroplot Area} = 
\begin{cases} 
E \times P \times A_m, & \text{if proportion basis} = \text{'MACR'} \text{ and } A_m > 0 \\
0, & \text{otherwise}
\end{cases}
\]

### Explanation of Terms:
- **E** (Expansion Factor): A factor that adjusts the macroplot size to reflect its relative size within the larger forest area.
- **P** (Condition Proportion Unadjusted): The unadjusted proportion of the forest condition within the macroplot.
- **A_m** (Adjustment Factor for Macroplot): A factor used to adjust the macroplot size based on specific forest conditions or measurements.

### Interpretation:
If the **proportion basis** is `'MACR'` and the **adjustment factor for the macroplot** \( A_m \) is greater than 0, the macroplot size is calculated using the following formula:

\[
\text{Macroplot Area} = E \times P \times A_m
\]

If these conditions are not met, the macroplot size is set to 0.

## Summary of Key Differences

| Parameter                     | Subplot Size Calculation                   | Macroplot Size Calculation                  |
|--------------------------------|--------------------------------------------|---------------------------------------------|
| **Proportion Basis**           | `'SUBP'`                                   | `'MACR'`                                    |
| **Adjustment Factor Applied**  | Adjustment Factor for Subplot \( A_s \)     | Adjustment Factor for Macroplot \( A_m \)   |
| **Applicability**              | Used for fine-grained data collection       | Used for broader, large-scale data collection |

### Common Calculation Components:
Both **subplot** and **macroplot** calculations use:
- **E** (Expansion Factor): Reflects how much area the plot represents in the larger forest.
- **P** (Condition Proportion Unadjusted): The proportion of the forest condition applicable to the plot.

These components are scaled based on whether the condition applies to a subplot or macroplot.

The table structure information is ({database name: {schema name: [table name]}}): 
{'USFS_FIA': {'USFS_FIA': ['POPULATION', 'POPULATION_EVALUATION_GROUP', 'CONDITION', 'ESTIMATED_TIMBERLAND_ACRES', 'POPULATION_STRATUM', 'PLOT', 'POPULATION_EVALUATION_TYPE', 'POPULATION_STRATUM_ASSIGN', 'ESTIMATED_FORESTLAND_ACRES', 'PLOT_TREE', 'POPULATION_ESTIMATION_UNIT', 'POPULATION_EVALUATION', 'TREE']}}
Begin Exploring Related Columns
Based on the given task, here are the tables, columns, and conditions that are relevant:

**Tables and Relevant Columns:**

1. **`CONDITION` Table:**
   - `"condition_status_code"`: Used to filter records where `condition_status_code` = 1.
   - `"condition_proportion_unadjusted"`: Represents **P** in the subplot and macroplot size calculations.
   - `"proportion_basis"`: Determines whether the condition applies to a subplot (`'SUBP'`) or macroplot (`'MACR'`).
   - `"plot_sequence_number"`: Used to join with the `PLOT` table and `POPULATION_STRATUM_ASSIGN` table.
   - `"inventory_year"`: The year of the inventory, used to filter records for years 2015, 2016, and 2017.
   - `"state_code"`: State code for identifying the state.
   - `"state_code_name"`: Name of the state.

2. **`PLOT` Table:**
   - `"plot_sequence_number"`: Used to join with the `CONDITION` table.
   - `"plot_state_code"`: State code for identifying the state.
   - `"plot_state_code_name"`: Name of the state.
   - `"plot_inventory_year"`: The year of the inventory.

3. **`POPULATION_STRATUM_ASSIGN` Table:**
   - `"plot_sequence_number"`: Used to join with the `CONDITION` and `PLOT` tables.
   - `"stratum_sequence_number"`: Used to join with the `POPULATION_STRATUM` table.

4. **`POPULATION_STRATUM` Table:**
   - `"stratum_sequence_number"`: Used to join with the `POPULATION_STRATUM_ASSIGN` table.
   - `"expansion_factor"`: Represents **E** in the size calculations.
   - `"adjustment_factor_for_the_subplot"`: Represents **A_s** in the subplot size calculation.
   - `"adjustment_factor_for_the_macroplot"`: Represents **A_m** in the macroplot size calculation.
   - `"evaluation_sequence_number"`: Used to join with the `POPULATION_EVALUATION_TYPE` table.

5. **`POPULATION_EVALUATION_TYPE` Table:**
   - `"evaluation_sequence_number"`: Used to join with the `POPULATION_STRATUM` table.
   - `"evaluation_type"`: Used to filter records where `evaluation_type` = `'EXPCURR'`.

**Conditions that May Be Used:**

- `"condition_status_code"` = 1
- `"evaluation_type"` = 'EXPCURR'
- `"inventory_year"` IN (2015, 2016, 2017)
- `"proportion_basis"` = 'SUBP' or 'MACR'

**SQL Queries:**

Below are at least 10 SQL queries to understand the values in the related columns:

1. **Retrieve Distinct Evaluation Types:**

   ```sql
   SELECT DISTINCT "evaluation_type"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE"
   LIMIT 100;
   ```

2. **Count Records with `condition_status_code` = 1:**

   ```sql
   SELECT COUNT(*) AS "num_records"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "condition_status_code" = 1;
   ```

3. **List Available Inventory Years in `CONDITION`:**

   ```sql
   SELECT DISTINCT "inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   ORDER BY "inventory_year" ASC
   LIMIT 100;
   ```

4. **Retrieve Condition Proportions Where `condition_status_code` = 1:**

   ```sql
   SELECT "condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "condition_status_code" = 1
   LIMIT 100;
   ```

5. **Get Distinct `proportion_basis` Values:**

   ```sql
   SELECT DISTINCT "proportion_basis"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   LIMIT 100;
   ```

6. **Extract Expansion Factors from `POPULATION_STRATUM`:**

   ```sql
   SELECT DISTINCT "expansion_factor"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM"
   LIMIT 100;
   ```

7. **Retrieve Adjustment Factors for Subplot and Macroplot:**

   ```sql
   SELECT "adjustment_factor_for_the_subplot", "adjustment_factor_for_the_macroplot"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM"
   LIMIT 100;
   ```

8. **Join `CONDITION` and `PLOT` Tables to Get State Names and Inventory Years:**

   ```sql
   SELECT c."condition_status_code", p."plot_state_code_name", c."inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
   JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
     ON c."plot_sequence_number" = p."plot_sequence_number"
   WHERE c."condition_status_code" = 1
   LIMIT 100;
   ```

9. **Get Plots with `evaluation_type` = 'EXPCURR':**

   ```sql
   SELECT DISTINCT p."plot_sequence_number"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
   JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
     ON e."evaluation_sequence_number" = ps."evaluation_sequence_number"
   JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
     ON ps."stratum_sequence_number" = psa."stratum_sequence_number"
   JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
     ON psa."plot_sequence_number" = p."plot_sequence_number"
   WHERE e."evaluation_type" = 'EXPCURR'
   LIMIT 100;
   ```

10. **List State Codes and Names from `PLOT` Table:**

    ```sql
    SELECT DISTINCT "plot_state_code", "plot_state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    LIMIT 100;
    ```

11. **Retrieve Inventory Years from `PLOT` Table:**

    ```sql
    SELECT DISTINCT "plot_inventory_year"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    ORDER BY "plot_inventory_year" ASC
    LIMIT 100;
    ```

12. **View Stratum Assignments:**

    ```sql
    SELECT "plot_sequence_number", "stratum_sequence_number"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN"
    LIMIT 100;
    ```

13. **Join `CONDITION`, `POPULATION_STRATUM_ASSIGN`, and `POPULATION_STRATUM` to View Size Factors:**

    ```sql
    SELECT c."plot_sequence_number",
           c."condition_proportion_unadjusted",
           c."proportion_basis",
           c."condition_status_code",
           c."inventory_year",
           ps."expansion_factor",
           ps."adjustment_factor_for_the_subplot",
           ps."adjustment_factor_for_the_macroplot"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    LIMIT 100;
    ```

14. **Get Evaluation Types from `POPULATION_STRATUM`:**

    ```sql
    SELECT ps."stratum_sequence_number", e."evaluation_type"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
      ON ps."evaluation_sequence_number" = e."evaluation_sequence_number"
    LIMIT 100;
    ```

15. **Join All Relevant Tables to View Evaluation Types and Conditions:**

    ```sql
    SELECT c."plot_sequence_number",
           c."condition_status_code",
           c."inventory_year",
           p."plot_state_code_name",
           e."evaluation_type"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
      ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" e
      ON ps."evaluation_sequence_number" = e."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
      AND e."evaluation_type" = 'EXPCURR'
    LIMIT 100;
    ```

16. **Retrieve Adjustment Factors Greater Than 0:**

    ```sql
    SELECT ps."adjustment_factor_for_the_macroplot",
           ps."adjustment_factor_for_the_subplot"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
    WHERE ps."adjustment_factor_for_the_macroplot" > 0
       OR ps."adjustment_factor_for_the_subplot" > 0
    LIMIT 100;
    ```

17. **List Distinct State Codes and Names from `CONDITION`:**

    ```sql
    SELECT DISTINCT c."state_code", c."state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    LIMIT 100;
    ```

18. **Retrieve Inventory Years Where `condition_status_code` = 1:**

    ```sql
    SELECT DISTINCT c."state_code", c."state_code_name", c."inventory_year"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    WHERE c."condition_status_code" = 1
    ORDER BY c."inventory_year" ASC
    LIMIT 100;
    ```

19. **Get Distinct `proportion_basis` Where `condition_status_code` = 1:**

    ```sql
    SELECT DISTINCT c."proportion_basis"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    WHERE c."condition_status_code" = 1
    LIMIT 100;
    ```

These queries help in understanding the values present in the relevant columns across different tables and provide insights necessary to perform the calculations required for the task. They allow us to inspect the data, verify the conditions, and understand how the tables are related.Query:
SELECT DISTINCT "evaluation_type"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE"
   LIMIT 100;
Answer:
evaluation_type
EXPGROW
EXPREMV
EXPMORT
EXPCURR
EXPVOL
EXPALL
EXPCHNG
EXPREGEN
EXPDWM
EXPCRWN
EXPINV
EXPP2VEG
EXPGRNDLYR
Query:
SELECT COUNT(*) AS "num_records"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "condition_status_code" = 1;
Answer:
num_records
793241
Query:
SELECT DISTINCT "inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   ORDER BY "inventory_year" ASC
   LIMIT 100;
Answer:
inventory_year
1968
1970
1972
1974
1975
1976
1977
1978
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
9999
Query:
SELECT "condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "condition_status_code" = 1
   LIMIT 100;
Answer:
condition_proportion_unadjusted
0.75
1.0
0.18790200352668762
1.0
0.25
0.7734119892120361
0.75
0.11390700191259384
0.75
0.5
1.0
1.0
1.0
1.0
1.0
0.75
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.25
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.25
0.75
0.25
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.25
0.75
0.25
0.75
1.0
1.0
0.5
0.5
0.5
0.75
0.3970780074596405
0.75
0.75
0.75
0.75
0.25
0.5
0.25
1.0
0.75
1.0
1.0
1.0
1.0
0.25
1.0
0.8448169827461243
1.0
0.5
1.0
0.5161150097846985
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
Query:
SELECT DISTINCT "proportion_basis"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   LIMIT 100;
Answer:
proportion_basis
SUBP
MACR
""
Query:
SELECT DISTINCT "expansion_factor"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM"
   LIMIT 100;
Answer:
expansion_factor
91039.0
97500.2015991211
97826.0
98934.0
101265.0
101850.0
103636.0
110693.0
118521.0
122971.0
142043.0
142403.0
168646.90014648438
183254.0
196501.0
197403.0
197919.79736328125
205188.0
231703.0
236261.0
242702.0
246691.0
253058.0
255419.0
8544.999877929688
3258.276123046875
10079.999755859375
10321.0
11259.90005493164
11919.999816894531
13591.400230407715
14000.000366210938
14290.000213623047
17058.300006866455
17180.00079345703
27602.0
28340.0
31343.0
36496.0
52410.0
11397.9384765625
55.0
9577.00390625
199191.0
262723.29998779297
12700.0
15438.50040435791
19176.0
22802.0
27720.0
10912.638671875
42763.0
327362.7009277344
444199.0
605838.4000091553
994640.0
56315.49932861328
230.0
5080.000022888184
423013.0
49960.1015625
7865.0
186866.0
8891.000030517578
12424.99997329712
12930.699951171875
17236.0
17835.00018310547
20537.0
3944.0
36930.10014343262
285376.0
9571.185546875
587281.0
65383.49920654297
7510.49755859375
750.0
1620.0
1623.0
2769.9999771118164
7865.458984375
7090.0
219325.0989227295
9430.0
9445.0
10718.800104141235
10800.000122070312
5585.6162109375
18473.200241088867
20110.0
20647.0
21870.0
23029.0
23170.0
23317.90069580078
25999.99951171875
28215.99920654297
28287.0
29464.0
32405.099609375
Query:
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."proportion_basis",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s",
        ps."adjustment_factor_for_the_macroplot" AS "A_m"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
),
size_calculations AS (
    SELECT
        CASE WHEN c."proportion_basis" = 'SUBP' THEN 'subplot' ELSE 'macroplot' END AS "Type",
        c."inventory_year" AS "Year",
        c."State",
        (c."E" * c."P" *
        CASE WHEN c."proportion_basis" = 'SUBP' THEN c."A_s"
             ELSE c."A_m" END) AS "Size"
    FROM condition_data c
    WHERE
        ((c."proportion_basis" = 'SUBP' AND c."A_s" IS NOT NULL AND c."A_s" > 0)
         OR
         (c."proportion_basis" = 'MACR' AND c."A_m" IS NOT NULL AND c."A_m" > 0))
),
max_avg_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY AVG("Size") DESC) AS "Rank"
    FROM size_calculations
    GROUP BY "Type", "Year", "State"
)
SELECT "Type", "Year", "State", "Average_Size"
FROM max_avg_sizes
WHERE "Rank" = 1
ORDER BY "Type", "Year";
Answer:
Type,Year,State,Average_Size
macroplot,2015,California,5499.514912801828
macroplot,2016,California,5671.46321799773
macroplot,2017,California,5626.774530176067
subplot,2015,Maryland,10704.67385403049
subplot,2016,Connecticut,12248.79969241094
subplot,2017,Iowa,11712.025040553008
Query:
SELECT c."condition_status_code", p."plot_state_code_name", c."inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
   JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
     ON c."plot_sequence_number" = p."plot_sequence_number"
   WHERE c."condition_status_code" = 1
   LIMIT 100;
Answer:
condition_status_code,plot_state_code_name,inventory_year
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,Oregon,2010
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,South Dakota,1980
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Nebraska,2007
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
1,Michigan,2003
Query:
WITH size_data AS (
    SELECT
        CASE WHEN c."proportion_basis" = 'SUBP' THEN 'subplot' ELSE 'macroplot' END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" *
            CASE WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                 ELSE ps."adjustment_factor_for_the_macroplot" END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    LEFT JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
      ON c."plot_sequence_number" = p."plot_sequence_number"
    LEFT JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    LEFT JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE c."condition_status_code" = 1
      AND c."inventory_year" IN (2015, 2016, 2017)
      AND (
        (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
        OR
        (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
      )
),
average_sizes AS (
    SELECT "Type", "Year", "State", AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_sizes AS (
    SELECT
        "Type", "Year", "State", "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM average_sizes
)
SELECT "Type", "Year", "State", "Average_Size"
FROM ranked_sizes
WHERE "Rank" = 1
ORDER BY "Type", "Year";
Answer:
Type,Year,State,Average_Size
macroplot,2015,California,5499.514912801828
macroplot,2016,California,5671.46321799773
macroplot,2017,California,5626.774530176067
subplot,2015,Maryland,10704.67385403049
subplot,2016,,23424.251869856012
subplot,2017,Iowa,11712.025040553006
Query:
SELECT DISTINCT "plot_state_code", "plot_state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    LIMIT 100;
Answer:
plot_state_code,plot_state_code_name
10,Delaware
8,Colorado
64,Federated States of Micronesia
60,American Samoa
41,Oregon
6,California
70,Palau
34,New Jersey
50,Vermont
40,Oklahoma
24,Maryland
30,Montana
21,Kentucky
1,Alabama
47,Tennessee
48,Texas
22,Louisiana
17,Illinois
42,Pennsylvania
26,Michigan
28,Mississippi
78,U.S. Virgin Islands
35,New Mexico
16,Idaho
12,Florida
2,Alaska
20,Kansas
5,Arkansas
33,New Hampshire
31,Nebraska
25,Massachusetts
23,Maine
46,South Dakota
39,Ohio
18,Indiana
49,Utah
56,Wyoming
66,Guam
69,Northern Mariana Islands
19,Iowa
13,Georgia
37,North Carolina
51,Virginia
55,Wisconsin
44,Rhode Island
4,Arizona
45,South Carolina
72,Puerto Rico
9,Connecticut
54,West Virginia
29,Missouri
27,Minnesota
38,North Dakota
15,Hawaii
53,Washington
36,New York
32,Nevada
Query:
SELECT DISTINCT "plot_inventory_year"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    ORDER BY "plot_inventory_year" ASC
    LIMIT 100;
Answer:
plot_inventory_year
1968
1970
1972
1974
1975
1976
1977
1978
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
9999
Query:
SELECT "plot_sequence_number", "stratum_sequence_number"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN"
    LIMIT 100;
Answer:
plot_sequence_number,stratum_sequence_number
10672090010497,13319170010497
10670280010497,13319182010497
10669067010497,13319402010497
10669091010497,13319402010497
10670452010497,13319374010497
10668523010497,13319335010497
10669051010497,13319283010497
10668717010497,13319393010497
10671724010497,13319399010497
10669560010497,13319373010497
10668366010497,13319408010497
10668530010497,13319408010497
10668946010497,13319196010497
10667628010497,13319364010497
10668111010497,13319268010497
10668044010497,13319268010497
10667924010497,13319268010497
10667911010497,13319268010497
10668720010497,13319403010497
10668790010497,13319403010497
10671886010497,13319268010497
10672088010497,13319404010497
10669300010497,13319265010497
10669100010497,13319261010497
10668050010497,13319409010497
10667754010497,13319409010497
10671796010497,13319260010497
10671462010497,13319321010497
10671723010497,13319258010497
10670413010497,13319239010497
10668673010497,13319201010497
10668525010497,13319175010497
10668985010497,13319238010497
10668047010497,13319409010497
10669737010497,13319405010497
10670090010497,13319405010497
10671684010497,13319398010497
10669003010497,13319163010497
10667433010497,13319236010497
10670703010497,13319407010497
10670975010497,13319145010497
10668378010497,13319160010497
10670671010497,13319165010497
10670786010497,13319298010497
10669301010497,13319247010497
10670804010497,13319386010497
10671390010497,13319386010497
10672027010497,13319267010497
10671533010497,13319249010497
10668425010497,13319267010497
10667646010497,13319254010497
10671131010497,13319380010497
10667861010497,13319268010497
10669587010497,13319248010497
10670918010497,13319259010497
10671209010497,13319262010497
10670253010497,13319379010497
10669528010497,13319365010497
10668416010497,13319408010497
10668902010497,13319382010497
10668246010497,13319357010497
10669290010497,13319406010497
10671290010497,13319404010497
10671325010497,13319404010497
10671364010497,13319401010497
10669211010497,13319402010497
10670616010497,13319141010497
10667618010497,13319260010497
10669377010497,13319269010497
10670682010497,13319133010497
10672077010497,13319169010497
10669768010497,13319273010497
10669207010497,13319313010497
10670472010497,13319252010497
10667939010497,13319409010497
10668011010497,13319409010497
10671416010497,13319206010497
10670368010497,13319265010497
10670347010497,13319262010497
10670418010497,13319262010497
10672360010497,13319206010497
10671166010497,13319265010497
10668513010497,13319267010497
10667971010497,13319409010497
10668043010497,13319409010497
10670571010497,13319227010497
10669731010497,13319213010497
10669082010497,13319263010497
10672310010497,13319161010497
10671677010497,13319205010497
10667905010497,13319409010497
10667562010497,13319251010497
10669094010497,13319254010497
10669804010497,13319211010497
10671733010497,13319388010497
10670150010497,13319406010497
10672145010497,13319404010497
10668096010497,13319244010497
10670943010497,13319259010497
10669693010497,13319259010497
Query:
SELECT c."plot_sequence_number",
           c."condition_proportion_unadjusted",
           c."proportion_basis",
           c."condition_status_code",
           c."inventory_year",
           ps."expansion_factor",
           ps."adjustment_factor_for_the_subplot",
           ps."adjustment_factor_for_the_macroplot"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
      ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
      ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    LIMIT 100;
Answer:
Too long, hard cut:
plot_sequence_number,condition_proportion_unadjusted,proportion_basis,condition_status_code,inventory_year,expansion_factor,adjustment_factor_for_the_subplot,adjustment_factor_for_the_macroplot
249882137489998,1.0,SUBP,1,2015,2941.734779129259,1.0,0.0
14532053020004,1.0,SUBP,1,2013,2941.734779129259,1.0,0.0
249881888489998,0.28448399901390076,SUBP,5,2015,3242.325885397263,1.0125941730466428,0.0
249881888489998,0.7155159711837769,SUBP,1,2015,3242.325885397263,1.0125941730466428,0.0
306349565489998,0.5,SUBP,1,2016,3044.2001648309006,1.0,0.0
306349565489998,0.5,SUBP,3,2016,3044.2001648309006,1.0,0.0
249881259489998,1.0,SUBP,1,2015,2710.291407552027,1.0,0.0
14532153020004,0.9882959723472595,SUBP,1,2013,2966.666837622005,1.0,0.0
14532153020004,0.01170399971306324,SUBP,2,2013,2966.666837622005,1.0,0.0
245792699010661,1.0,SUBP,2,2012,3005.9632678903,1.0012785743815447,0.0
373753708489998,1.0,SUBP,2,2017,2999.1628524224693,1.0016462817099119,0.0
245791534010661,0.5988519787788391,SUBP,1,2012,3132.4020081587305,1.0081749219522584,0.0
245791534010661,0.4011479914188385,SUBP,2,2012,3132.4020081587305,1.0081749219522584,0.0
14532204020004,0.25,SUBP,1,2013,3132.4020081587305,1.0081749219522584,0.0
14532204020004,0.75,SUBP,2,2013,3132.4020081587305,1.0081749219522584,0.0
465276459489998,1.0,SUBP,1,2018,2710.292290071204,1.0009930484621552,0.0
14531954020004,1.0,SUBP,2,2013,2953.3357975602717,1.0012468838175972,0.0
249881588489998,0.056418001651763916,SUBP,2,2016,3131.0811700944773,1.01582727599291,0.0
249881588489998,0.9435819983482361,SUBP,1,2016,3131.0811700944773,1.01582727599291,0.0
249881846489998,1.0,SUBP,2,2016,2997.233461691199,1.0007265681763138,0.0
373752958489998,1.0,SUBP,1,2017,2660.0070680314398,1.0,0.0
168270611020004,1.0,SUBP,1,2014,3151.2584954051304,1.0228394926568254,0.0
168272558020004,1.0,SUBP,2,2014,2993.7831881131915,1.0008976660682227,0.0
14531206020004,1.0,SUBP,1,2013,3045.440843038893,1.0,0.0
14532413020004,1.0,SUBP,1,2013,2966.048222430539,1.0,0.0
168270646020004,1.0,SUBP,2,2014,3008.828285607844,1.0008457851467216,0.0
373753777489998,1.0,SUBP,2,2017,3008.828285607844,1.0008457851467216,0.0
306350194489998,1.0,SUBP,2,2016,3008.828285607844,1.0008457851467216,0.0
465278087489998,1.0,SUBP,2,2018,2993.649219144576,1.0007011639321273,0.0
249882270489998,1.0,SUBP,1,2015,3480.4275947701503,1.009009009009009,0.0
373752822489998,1.0,SUBP,2,2017,2975.303736464581,1.0,0.0
168270631020004,1.0,SUBP,2,2015,2953.3357975602717,1.0012468838175972,0.0
168271634020004,1.0,SUBP,2,2014,2981.9487476012973,1.0,0.0
14531524020004,1.0,SUBP,2,2013,3145.588910041915,1.0014785608674224,0.0
249881781489998,1.0,SUBP,1,2015,2880.6706550567596,1.0,0.0
306350275489998,1.0,SUBP,2,2016,3000.376520760631,1.000702740688686,0.0
14532091020004,0.5419480204582214,SUBP,1,2013,3064.8543925314802,1.0109649666581721,0.0
14532091020004,0.45805200934410095,SUBP,1,2013,3064.8543925314802,1.0109649666581721,0.0
373753290489998,1.0,SUBP,2,2017,2993.7831881131915,1.0008976660682227,0.0
245793184010661,1.0,SUBP,2,2012,2993.7831881131915,1.0008976660682227,0.0
245792768010661,1.0,SUBP,1,2012,2955.314051410035,1.0,0.0
14532344020004,1.0,SUBP,1,2013,2955.314051410035,1.0,0.0
465276650489998,0.455161988735199,SUBP,1,2018,3189.534836898099,1.0035052578868302,0.0
465276650489998,0.544838011264801,SUBP,1,2018,3189.534836898099,1.0035052578868302,0.0
465276753489998,0.75,SUBP,1,2018,3292.148751570572,1.0170227500257183,0.0
465276753489998,0.25,SUBP,1,2018,3292.148751570572,1.0170227500257183,0.0
168270947020004,0.75,SUBP,1,2015,3444.1058599068588,1.0101755223511297,0.0
168270947020004,0.25,SUBP,1,2015,3444.1058599068588,1.0101755223511297,0.0
249881669489998,1.0,SUBP,1,2015,50096.129411764705,1.0149253731343284,0.0
465276890489998,1.0,SUBP,2,2018,2999.1628524224693,1.0016462817099119,0.0
14531985020004,1.0,SUBP,2,2013,3089.9256195453695,1.012457472135695,0.0
168270948020004,1.0,SUBP,1,2015,2880.7525112593785,1.0,0.0
465276847489998,1.0,SUBP,2,2018,3005.9632678903,1.0012785743815447,0.0
168272127020004,1.0,SUBP,2,2015,2975.303736464581,1.0,0.0
14532842020004,1.0,SUBP,2,2013,2993.649219144576,1.0007011639321273,0.0
373752877489998,1.0,SUBP,2,2017,2993.649219144576,1.0007011639321273,0.0
245792901010661,1.0,SUBP,1,2012,3480.4275947701503,1.009009009009009,0.0
245793176010661,1.0,SUBP,2,2012,2981.9487476012973,1.0,0.0
14533354020004,0.75,SUBP,1,2013,2660.0070680314398,1.0,0.0
14533354020004,0.25,SUBP,1,2013,2660.0070680314398,1.0,0.0
14533170020004,1.0,SUBP,2,2013,3012.696980817878,1.001880152889805,0.0
14532098020004,1.0,SUBP,2,2013,2997.233461691199,1.0007265681763138,0.0
245791557010661,1.0,SUBP,1,2012,2880.6706550567596,1.0,0.0
245793198010661,1.0,SUBP,2,2012,2692.7927996078743,1.0,0.0
14531744020004,1.0,SUBP,2,2013,2993.7831881131915,1.0008976660682227,0.0
249882348489998,0.5,SUBP,1,2016,3170.2235493723874,1.0129611166500498,0.0
249882348489998,0.5,SUBP,2,2016,3170.2235493723874,1.0129611166500498,0.0
249881616489998,1.0,SUBP,2,2016,2975.303736464581,
Query:
SELECT ps."stratum_sequence_number", pe."evaluation_description"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
  ON ps."evaluation_identifier" = pe."evaluation_identifier"
LIMIT 100;
Answer:
stratum_sequence_number,evaluation_description
2171,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2172,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2173,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2174,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2175,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2176,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2177,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2178,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2179,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
218,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2180,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2181,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2182,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2183,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2184,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2185,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2186,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2187,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2188,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2189,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
219,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2190,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2191,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2192,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2193,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2194,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2195,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2196,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2197,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2198,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2096,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2097,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2098,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2099,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
210,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2100,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2101,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2102,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2103,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2104,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2105,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2106,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2107,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2108,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2109,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
211,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2110,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2111,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2112,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2113,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2114,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2115,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2116,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2117,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2118,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2119,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
212,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2120,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2121,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2122,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2123,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2124,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2125,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2126,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2127,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2128,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2129,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
213,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2130,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2131,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2132,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2133,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2063,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2134,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2135,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2136,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2137,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2138,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2139,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
214,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2140,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2141,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2142,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2143,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2144,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2145,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2146,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2147,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2148,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2149,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
215,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2150,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2151,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2152,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2153,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
220,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2200,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2201,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2202,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
2203,"CALIFORNIA 1994, AREA, PERIODIC, no NFS"
Query:
SELECT c."plot_sequence_number",
       c."condition_status_code",
       c."inventory_year",
       p."plot_state_code_name",
       pe."evaluation_description"
FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
  ON c."plot_sequence_number" = p."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
  ON c."plot_sequence_number" = psa."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
  ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
  ON ps."evaluation_identifier" = pe."evaluation_identifier"
WHERE c."condition_status_code" = 1
LIMIT 100;
Answer:
Too long, hard cut:
plot_sequence_number,condition_status_code,inventory_year,plot_state_code_name,evaluation_description
220859196010661,1,2011,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
14528383020004,1,2013,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
245013033489998,1,2015,South Dakota,"SOUTH DAKOTA 2016: 2006-2011 to 2011-2016: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
245103192010661,1,2012,South Dakota,"SOUTH DAKOTA 2016: 2006-2011 to 2011-2016: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
220858622010661,1,2011,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
14529126020004,1,2013,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
14528330020004,1,2013,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
220858272010661,1,2011,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
220858738010661,1,2011,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
14528231020004,1,2013,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
168246041020004,1,2014,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
14528320020004,1,2013,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
220858526010661,1,2011,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
14528262020004,1,2013,South Dakota,SOUTH DAKOTA 2014: 2009-2014: ALL AREA
169001988010661,1,2010,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
245103577010661,1,2012,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
14528262020004,1,2013,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
169001590010661,1,2010,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
14529126020004,1,2013,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
168246605020004,1,2015,South Dakota,SOUTH DAKOTA 2015: 2010-2015: ALL AREA
220858532010661,1,2011,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
168246031020004,1,2014,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
14529267020004,1,2013,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
168245848020004,1,2014,South Dakota,SOUTH DAKOTA 2016: 2011-2016: ALL AREA
245103218010661,1,2012,South Dakota,SOUTH DAKOTA 2016: 2012-2016: DWM
168246091020004,1,2015,South Dakota,SOUTH DAKOTA 2016: 2012-2016: REGENERATION
108718313010661,1,2009,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
245103265010661,1,2012,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
108717734010661,1,2009,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
169001082010661,1,2010,South Dakota,"SOUTH DAKOTA 2014: 2009-2014: CURRENT AREA, CURRENT VOLUME"
169001584010661,1,2010,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168246033020004,1,2014,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168246033020004,1,2014,South Dakota,"SOUTH DAKOTA 2014: 2004-2009 to 2009-2014: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
220858742010661,1,2011,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
245012951489998,1,2015,South Dakota,"SOUTH DAKOTA 2015: 2005-2010 to 2010-2015: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168245950020004,1,2014,South Dakota,"SOUTH DAKOTA 2015: 2005-2010 to 2010-2015: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
220858528010661,1,2011,South Dakota,"SOUTH DAKOTA 2015: 2010-2015: CURRENT AREA, CURRENT VOLUME"
245104631010661,1,2012,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
245103207010661,1,2012,South Dakota,SOUTH DAKOTA 2015: 2012-2015: REGENERATION
14528993020004,1,2013,South Dakota,"SOUTH DAKOTA 2016: 2006-2011 to 2011-2016: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
168247306020004,1,2014,South Dakota,SOUTH DAKOTA 2016: 2011-2016: ALL AREA
168245848020004,1,2014,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
245104135010661,1,2012,South Dakota,"SOUTH DAKOTA 2016: 2011-2016: CURRENT AREA, CURRENT VOLUME"
15750114020004,1,2013,Missouri,"MISSOURI 2017: 2006-2011 to 2011-2017: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
451192896489998,1,2018,Missouri,MISSOURI 2018: 2012-2018: VEG PROFILE
15750187020004,1,2013,Missouri,MISSOURI 2017: 2012-2017: REGENERATION
15750187020004,1,2013,Missouri,MISSOURI 2017: 2012-2017: REGENERATION
171800098020004,1,2014,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
171800558020004,1,2015,Missouri,"MISSOURI 2017: 2011-2017: CURRENT AREA, CURRENT VOLUME"
373680304489998,1,2017,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
373680304489998,1,2017,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
171799301020004,1,2014,Missouri,MISSOURI 2017: 2011-2017: ALL AREA
15749929020004,1,2013,Missouri,"MISSOURI 2017: 2006-2011 to 2011-2017: AREA CHANGE, GROWTH, REMOVALS, MORTALITY"
Query:
WITH condition_data AS (
    SELECT
        c."plot_sequence_number",
        c."condition_status_code",
        c."condition_proportion_unadjusted" AS "P",
        c."inventory_year",
        p."plot_state_code_name" AS "State",
        ps."expansion_factor" AS "E",
        ps."adjustment_factor_for_the_subplot" AS "A_s"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    WHERE
        c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND ps."adjustment_factor_for_the_subplot" IS NOT NULL
        AND ps."adjustment_factor_for_the_subplot" > 0
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
)
SELECT
    'subplot' AS "Type",
    c."inventory_year" AS "Year",
    c."State",
    AVG(c."E" * c."P" * c."A_s") AS "Average_Size"
FROM condition_data c
GROUP BY c."inventory_year", c."State"
ORDER BY c."inventory_year", "Average_Size" DESC;
Answer:
Too long, hard cut:
Type,Year,State,Average_Size
subplot,2015,Maryland,10704.67385403049
subplot,2015,West Virginia,10059.53473742004
subplot,2015,Nebraska,9984.2001338665
subplot,2015,Maine,9902.357259129189
subplot,2015,New York,9894.622577012924
subplot,2015,Texas,9705.883471324289
subplot,2015,Illinois,9649.865174477063
subplot,2015,Massachusetts,9547.468329549349
subplot,2015,Vermont,9324.110466244769
subplot,2015,Connecticut,9172.046927176038
subplot,2015,Iowa,9085.487680029606
subplot,2015,New Hampshire,8782.949373788724
subplot,2015,Indiana,8602.744931288573
subplot,2015,South Dakota,8516.450029686841
subplot,2015,Pennsylvania,8482.130832203402
subplot,2015,Missouri,8449.29594282356
subplot,2015,Alaska,7614.904610597975
subplot,2015,Ohio,7453.035350546701
subplot,2015,Wyoming,7376.064147461428
subplot,2015,Michigan,7325.16352650214
subplot,2015,New Jersey,7151.07762198572
subplot,2015,Kansas,6428.366084684225
subplot,2015,Oklahoma,5831.288799585411
subplot,2015,Rhode Island,5830.557008660188
subplot,2015,Alabama,5801.796867267843
subplot,2015,New Mexico,5574.272282554542
subplot,2015,California,5496.005445350178
subplot,2015,Nevada,5480.864130494596
subplot,2015,Arizona,5457.996908933815
subplot,2015,Utah,5421.315374017792
subplot,2015,North Dakota,5360.22848697917
subplot,2015,Colorado,5313.0175780209065
subplot,2015,Montana,5224.608171570817
subplot,2015,Louisiana,5200.598230113692
subplot,2015,Idaho,5196.834553257898
subplot,2015,Kentucky,5134.4894601779615
subplot,2015,Mississippi,5029.3356334032005
subplot,2015,Delaware,4979.247905033816
subplot,2015,Arkansas,4962.358473789706
subplot,2015,Florida,4951.923394269425
subplot,2015,Minnesota,4946.607082054724
subplot,2015,North Carolina,4825.833066249418
subplot,2015,Georgia,4740.4090167372015
subplot,2015,Virginia,4652.402098350851
subplot,2015,Wisconsin,4603.666066375564
subplot,2015,Tennessee,4505.415187108435
subplot,2015,South Carolina,4095.7694941031996
subplot,2015,Washington,3526.8718766952966
subplot,2015,Oregon,2713.0119740321443
subplot,2015,Northern Mariana Islands,1400.1577212802279
subplot,2016,Connecticut,12248.799692410937
subplot,2016,Maryland,11177.622816586867
subplot,2016,Vermont,10495.089916713314
subplot,2016,Maine,10192.425905069344
subplot,2016,New Hampshire,9911.896611852066
subplot,2016,West Virginia,9776.707599038677
subplot,2016,New York,9235.778599736766
subplot,2016,Indiana,8992.380690761642
subplot,2016,Massachusetts,8697.535029759503
subplot,2016,Nebraska,8541.618384596735
subplot,2016,Illinois,8475.002871837556
subplot,2016,Texas,8438.935702481276
subplot,2016,Kansas,8351.947003413303
subplot,2016,Missouri,8263.459649071514
subplot,2016,Ohio,8254.73219639441
subplot,2016,Pennsylvania,8245.396775849793
subplot,2016,Iowa,8109.361159674122
subplot,2016,Michigan,8105.398847678354
subplot,2016,Alaska,7953.927182856081
subplot,2016,South Dakota,7467.506577979042
subplot,2016,North Dakota,7261.212069921161
subplot,2016,New Jersey,6930.484865925008
subplot,2016,Wyoming,6815.652260073871
subplot,2016,Rhode Island,6322.1756497707665
subplot,2016,Alabama,5990.067667052806
subplot,2016,New Mexico,5939.234365038291
subplot,2016,Louisiana,5766.372005753261
subplot,2016,California,5667.635259846076
subplot,2016,Nevada,5402.833944477592
subplot,2016,Utah,5364.555021706708
subplot,2016,Idaho,5338.3417927897635
subplot,2016,Montana,5263.947646211432
subplot,2016,Arizona,5262.7104960669385
subplot,2016,Puerto Rico,5210.41628570456
subplot,2016,Colorado,5186.1796385088755
subplot,2016,North Carolina,5149.005074774131
subplot,2016,Arkansas,5041.24353734168
subplot,2016,Florida,4921.916202917815
subplot,2016,Delaware,4861.316690543656
subplot,2016,Minnesota,4790.976103273648
subplot,2016,Kentucky,4721.720336145489
subplot,2016,Oklahoma,4679.370100835216
subplot,2016,Virginia,4592.631103810453
subplot,2016,Mississippi,4461.248182943891
subplot,2016,South Carolina,4421.711157160292
subplot,2016,Georgia,4417.928260246422
subplot,2016,Wisconsin,4358.382051295848
subplot,2016,Tennessee,4134.258538338294
subplot,2016,Washington,3701.548923173183
subplot,2016,Oregon,2758.8023915335807
subplot,2016,Federated States of Micronesia,1468.2717044838191
subplot,2017,Iowa,11712.025040553006
subplot,2017,Maine,10921.592583898833
subplot,2017,New York,10585.257727146587
subplot,2017,West Virginia,10171.191605073862
subplot,2017,Massachusetts,9740.224220700093
subplot,2017,Illinois,9456.39023873408
subplot,2017,Maryland,9432.036408362754
subplot,2017,Pennsylvania,8762.134054463086
subplot,2017,Ohio,8751.688694691675
subplot,2017,Nebraska,8699.590666121456
subplot,2017,Indiana,8517.456603934612
subplot,2017,New Hampshire,8478.24635342262
subplot,2017,Vermont,8392.620788592763
subplot,2017,Missouri,8370.031213229076
subplot,2017,Alaska,7961.190089540881
subplot,2017,Connecticut,7861.110028317676
subplot,2017,Michigan,7414.010315538452
subplot,2017,New Jersey,7065.85896023263
subplot,2017,Wyoming,6111.705148928129
subplot,2017,New Mexico,5910.44395052848
subplot,2017,Kansas,584
Query:
SELECT DISTINCT c."state_code", c."state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    LIMIT 100;
Answer:
state_code,state_code_name
8,Colorado
6,California
26,Michigan
48,Texas
17,Illinois
16,Idaho
35,New Mexico
27,Minnesota
45,South Carolina
32,Nevada
38,North Dakota
15,Hawaii
54,West Virginia
41,Oregon
60,American Samoa
10,Delaware
70,Palau
64,Federated States of Micronesia
1,Alabama
47,Tennessee
42,Pennsylvania
22,Louisiana
21,Kentucky
28,Mississippi
68,Marshall Islands
40,Oklahoma
24,Maryland
50,Vermont
12,Florida
23,Maine
56,Wyoming
46,South Dakota
39,Ohio
18,Indiana
19,Iowa
5,Arkansas
25,Massachusetts
66,Guam
55,Wisconsin
13,Georgia
4,Arizona
51,Virginia
37,North Carolina
44,Rhode Island
30,Montana
34,New Jersey
78,Virgin Islands of the U.S.
49,Utah
2,Alaska
31,Nebraska
20,Kansas
33,New Hampshire
69,Northern Mariana Islands
29,Missouri
53,Washington
36,New York
72,Puerto Rico
9,Connecticut
Query:
SELECT DISTINCT c."state_code", c."state_code_name", c."inventory_year"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    WHERE c."condition_status_code" = 1
    ORDER BY c."inventory_year" ASC
    LIMIT 100;
Answer:
state_code,state_code_name,inventory_year
45,South Carolina,1968
12,Florida,1970
13,Georgia,1972
1,Alabama,1972
22,Louisiana,1974
37,North Carolina,1974
48,Texas,1975
40,Oklahoma,1976
51,Virginia,1977
28,Mississippi,1977
27,Minnesota,1977
45,South Carolina,1978
5,Arkansas,1978
12,Florida,1980
47,Tennessee,1980
46,South Dakota,1980
26,Michigan,1980
38,North Dakota,1980
20,Kansas,1981
1,Alabama,1982
13,Georgia,1982
31,Nebraska,1983
33,New Hampshire,1983
55,Wisconsin,1983
50,Vermont,1983
56,Wyoming,1984
8,Colorado,1984
37,North Carolina,1984
22,Louisiana,1984
44,Rhode Island,1985
25,Massachusetts,1985
9,Connecticut,1985
17,Illinois,1985
4,Arizona,1985
51,Virginia,1985
48,Texas,1986
45,South Carolina,1986
40,Oklahoma,1986
18,Indiana,1986
10,Delaware,1986
24,Maryland,1986
35,New Mexico,1987
12,Florida,1987
34,New Jersey,1987
28,Mississippi,1987
5,Arkansas,1988
21,Kentucky,1988
32,Nevada,1989
54,West Virginia,1989
40,Oklahoma,1989
47,Tennessee,1989
29,Missouri,1989
13,Georgia,1989
30,Montana,1989
42,Pennsylvania,1989
37,North Carolina,1990
1,Alabama,1990
19,Iowa,1990
27,Minnesota,1990
22,Louisiana,1991
16,Idaho,1991
39,Ohio,1991
48,Texas,1992
51,Virginia,1992
36,New York,1993
40,Oklahoma,1993
26,Michigan,1993
49,Utah,1993
45,South Carolina,1993
6,California,1994
31,Nebraska,1994
28,Mississippi,1994
20,Kansas,1994
5,Arkansas,1995
23,Maine,1995
38,North Dakota,1995
2,Alaska,1995
46,South Dakota,1995
12,Florida,1995
55,Wisconsin,1996
2,Alaska,1996
2,Alaska,1997
13,Georgia,1997
33,New Hampshire,1997
50,Vermont,1997
9,Connecticut,1998
18,Indiana,1998
2,Alaska,1998
13,Georgia,1998
17,Illinois,1998
51,Virginia,1998
25,Massachusetts,1998
44,Rhode Island,1998
41,Oregon,1999
34,New Jersey,1999
21,Kentucky,1999
4,Arizona,1999
29,Missouri,1999
24,Maryland,1999
2,Alaska,1999
Query:
SELECT DISTINCT c."proportion_basis"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    WHERE c."condition_status_code" = 1
    LIMIT 100;
Answer:
proportion_basis
SUBP
MACR
""
End Exploring Related Columns
Task: Based on the condition, plot_tree, and population tables in bigquery-public-data.usfs_fia, for the evaluation_type set to 'EXPCURR' and condition_status_code equal to 1, which states had the largest average subplot size and the largest average macroplot size, respectively, for each of the years 2015, 2016, and 2017? Please include the type of plot (subplot or macroplot), the specific year, the state, and the corresponding average size in your results.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Type,Year,State,Average_Size
subplot,2015,state_name1:str,average_size1:float
macroplot,2015,state_name2:str,average_size2:float
subplot,2016,state_name3:str,average_size3:float
macroplot,2016,state_name4:str,average_size4:float
subplot,2017,state_name5:str,average_size5:float
macroplot,2017,state_name6:str,average_size6:float
```

To determine the states with the largest average subplot and macroplot sizes for each year (2015, 2016, and 2017), we performed the following steps:

1. **Filtered the Data**: Selected records from the `condition`, `plot_tree`, and `population` tables where:
   - The `evaluation_type` is `'EXPCURR'`.
   - The `condition_status_code` is equal to `1`.
   - The `inventory_year` is `2015`, `2016`, or `2017`.

2. **Calculated Plot Sizes**:
   - **Subplot Size**: For records where the `proportion_basis` is `'SUBP'` and the `adjustment_factor_for_the_subplot` is greater than `0`, we calculated the subplot size using the formula:
     \[
     \text{Subplot Size} = \text{Expansion Factor (E)} \times \text{Condition Proportion (P)} \times \text{Adjustment Factor for Subplot (A}_s\text{)}
     \]
   - **Macroplot Size**: For records where the `proportion_basis` is `'MACR'` and the `adjustment_factor_for_the_macroplot` is greater than `0`, we calculated the macroplot size using the formula:
     \[
     \text{Macroplot Size} = \text{Expansion Factor (E)} \times \text{Condition Proportion (P)} \times \text{Adjustment Factor for Macroplot (A}_m\text{)}
     \]

3. **Aggregated the Data**:
   - Grouped the calculated sizes by `state` and `year`.
   - Computed the average subplot and macroplot sizes for each state in each year.

4. **Identified the Largest Averages**:
   - For each year and plot type (subplot and macroplot), identified the state with the largest average size.

The results are presented in the table above, including the type of plot (`subplot` or `macroplot`), the specific year, the state, and the corresponding average size..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'USFS_FIA': {'USFS_FIA': ['POPULATION', 'POPULATION_EVALUATION_GROUP', 'CONDITION', 'ESTIMATED_TIMBERLAND_ACRES', 'POPULATION_STRATUM', 'PLOT', 'POPULATION_EVALUATION_TYPE', 'POPULATION_STRATUM_ASSIGN', 'ESTIMATED_FORESTLAND_ACRES', 'PLOT_TREE', 'POPULATION_ESTIMATION_UNIT', 'POPULATION_EVALUATION', 'TREE']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 23:13:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:13:24 - root - INFO - ```sql
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON ps."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
```
2025-02-11 23:13:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:13:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:13:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:13:25 - snowflake.connector.connection - INFO - closed
2025-02-11 23:13:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:13:26 - root - INFO - itercount: 1
2025-02-11 23:13:26 - root - INFO - 000904 (42000): 01ba54b1-0004-9c22-0001-11c3010e558a: SQL compilation error: error line 23 at position 11
invalid identifier 'PS."evaluation_sequence_number"'
2025-02-11 23:13:26 - root - INFO - Input sql:
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON ps."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
The error information is:
000904 (42000): 01ba54b1-0004-9c22-0001-11c3010e558a: SQL compilation error: error line 23 at position 11
invalid identifier 'PS."evaluation_sequence_number"'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-11 23:14:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:14:10 - root - INFO - ```sql
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
        ON ps."evaluation_identifier" = pe."evaluation_identifier"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON pe."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC NULLS LAST) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
```
2025-02-11 23:14:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:14:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:14:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:14:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-02-11 23:14:12 - snowflake.connector.connection - INFO - closed
2025-02-11 23:14:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:14:12 - root - INFO - itercount: 2
2025-02-11 23:14:12 - root - INFO - 0
2025-02-11 23:14:12 - root - INFO - results: 
Type,Year,State,Average_Size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Wyoming,6284.792518170388


2025-02-11 23:14:12 - root - INFO - Please check the answer again by reviewing Based on the condition, plot_tree, and population tables in bigquery-public-data.usfs_fia, for the evaluation_type set to 'EXPCURR' and condition_status_code equal to 1, which states had the largest average subplot size and the largest average macroplot size, respectively, for each of the years 2015, 2016, and 2017? Please include the type of plot (subplot or macroplot), the specific year, the state, and the corresponding average size in your results., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Type,Year,State,Average_Size
subplot,2015,state_name1:str,average_size1:float
macroplot,2015,state_name2:str,average_size2:float
subplot,2016,state_name3:str,average_size3:float
macroplot,2016,state_name4:str,average_size4:float
subplot,2017,state_name5:str,average_size5:float
macroplot,2017,state_name6:str,average_size6:float
```

To determine the states with the largest average subplot and macroplot sizes for each year (2015, 2016, and 2017), we performed the following steps:

1. **Filtered the Data**: Selected records from the `condition`, `plot_tree`, and `population` tables where:
   - The `evaluation_type` is `'EXPCURR'`.
   - The `condition_status_code` is equal to `1`.
   - The `inventory_year` is `2015`, `2016`, or `2017`.

2. **Calculated Plot Sizes**:
   - **Subplot Size**: For records where the `proportion_basis` is `'SUBP'` and the `adjustment_factor_for_the_subplot` is greater than `0`, we calculated the subplot size using the formula:
     \[
     \text{Subplot Size} = \text{Expansion Factor (E)} \times \text{Condition Proportion (P)} \times \text{Adjustment Factor for Subplot (A}_s\text{)}
     \]
   - **Macroplot Size**: For records where the `proportion_basis` is `'MACR'` and the `adjustment_factor_for_the_macroplot` is greater than `0`, we calculated the macroplot size using the formula:
     \[
     \text{Macroplot Size} = \text{Expansion Factor (E)} \times \text{Condition Proportion (P)} \times \text{Adjustment Factor for Macroplot (A}_m\text{)}
     \]

3. **Aggregated the Data**:
   - Grouped the calculated sizes by `state` and `year`.
   - Computed the average subplot and macroplot sizes for each state in each year.

4. **Identified the Largest Averages**:
   - For each year and plot type (subplot and macroplot), identified the state with the largest average size.

The results are presented in the table above, including the type of plot (`subplot` or `macroplot`), the specific year, the state, and the corresponding average size. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Type,Year,State,Average_Size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Wyoming,6284.792518170388
Current sql:
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
        ON ps."evaluation_identifier" = pe."evaluation_identifier"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON pe."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC NULLS LAST) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
2025-02-11 23:14:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:14:50 - root - INFO - ```sql
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
        ON ps."evaluation_sequence_number" = pe."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON pe."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC NULLS LAST) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    ROUND("Average_Size", 4) AS "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
```
2025-02-11 23:14:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:14:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:14:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:14:51 - snowflake.connector.connection - INFO - closed
2025-02-11 23:14:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:14:52 - root - INFO - itercount: 3
2025-02-11 23:14:52 - root - INFO - 000904 (42000): 01ba54b2-0004-9c22-0001-11c3010e5596: SQL compilation error: error line 23 at position 11
invalid identifier 'PS."evaluation_sequence_number"'
2025-02-11 23:14:52 - root - INFO - Input sql:
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
        ON ps."evaluation_sequence_number" = pe."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON pe."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC NULLS LAST) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    ROUND("Average_Size", 4) AS "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
The error information is:
000904 (42000): 01ba54b2-0004-9c22-0001-11c3010e5596: SQL compilation error: error line 23 at position 11
invalid identifier 'PS."evaluation_sequence_number"'
Please correct it and output only 1 complete SQL query.
2025-02-11 23:15:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 23:15:54 - root - INFO - ```sql
WITH size_data AS (
    SELECT
        CASE 
            WHEN c."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN c."proportion_basis" = 'MACR' THEN 'macroplot'
        END AS "Type",
        c."inventory_year" AS "Year",
        p."plot_state_code_name" AS "State",
        (ps."expansion_factor" * c."condition_proportion_unadjusted" * 
            CASE 
                WHEN c."proportion_basis" = 'SUBP' THEN ps."adjustment_factor_for_the_subplot"
                WHEN c."proportion_basis" = 'MACR' THEN ps."adjustment_factor_for_the_macroplot"
            END
        ) AS "Size"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION" c
    JOIN "USFS_FIA"."USFS_FIA"."PLOT" p
        ON c."plot_sequence_number" = p."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" psa
        ON c."plot_sequence_number" = psa."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" ps
        ON psa."stratum_sequence_number" = ps."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" pe
        ON ps."evaluation_identifier" = pe."evaluation_identifier"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" pet
        ON pe."evaluation_sequence_number" = pet."evaluation_sequence_number"
    WHERE c."condition_status_code" = 1
        AND c."inventory_year" IN (2015, 2016, 2017)
        AND pet."evaluation_type" = 'EXPCURR'
        AND (
            (c."proportion_basis" = 'SUBP' AND ps."adjustment_factor_for_the_subplot" > 0)
            OR
            (c."proportion_basis" = 'MACR' AND ps."adjustment_factor_for_the_macroplot" > 0)
        )
        AND ps."expansion_factor" IS NOT NULL
        AND c."condition_proportion_unadjusted" IS NOT NULL
),
average_sizes AS (
    SELECT
        "Type",
        "Year",
        "State",
        AVG("Size") AS "Average_Size"
    FROM size_data
    GROUP BY "Type", "Year", "State"
),
ranked_states AS (
    SELECT
        "Type",
        "Year",
        "State",
        "Average_Size",
        ROW_NUMBER() OVER (PARTITION BY "Type", "Year" ORDER BY "Average_Size" DESC NULLS LAST) AS "Rank"
    FROM average_sizes
)
SELECT
    "Type",
    "Year",
    "State",
    ROUND("Average_Size", 4) AS "Average_Size"
FROM ranked_states
WHERE "Rank" = 1
ORDER BY "Type", "Year";
```
2025-02-11 23:15:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 23:15:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 23:15:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 23:15:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-02-11 23:15:56 - snowflake.connector.connection - INFO - closed
2025-02-11 23:15:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 23:15:57 - root - INFO - itercount: 4
2025-02-11 23:15:57 - root - INFO - 0
2025-02-11 23:15:57 - root - INFO - Total iteration counts: 4
