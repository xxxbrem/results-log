2025-01-21 06:39:58 - openai._base_client - INFO - Retrying request to /chat/completions in 0.497808 seconds
2025-01-21 06:41:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:41:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:41:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:41:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:41:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:41:15 - snowflake.connector.connection - INFO - closed
2025-01-21 06:41:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:41:16 - root - INFO - SQL:
-- Query 1: View the first 100 rows of the STATIONS table.
SELECT * 
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
LIMIT 100
Results:
Too long, hard cut:
usaf,wban,name,country,state,call,lat,lon,elev,begin,end
007018,99999,WXPOD 7018                   ,,,,0.0,0.0,+7018.0,20110309,20130730
007026,99999,WXPOD 7026                   ,AF,,,0.0,0.0,+7026.0,20120713,20170822
007070,99999,WXPOD 7070                   ,AF,,,0.0,0.0,+7070.0,20140923,20150926
008268,99999,WXPOD8278                    ,AF,,,32.95,65.567,+1156.7,20100519,20120323
008307,99999,WXPOD 8318                   ,AF,,,0.0,0.0,+8318.0,20100421,20100421
010016,99999,RORVIK/RYUM,NO,,,64.85,11.233,+0014.0,19870116,19910806
010017,99999,FRIGG,NO,,ENFR,59.98,2.25,+0048.0,19880320,20050228
010071,99999,LONGYEARBYEN,SV,,,78.217,15.583,+0037.0,20050210,20050210
010190,99999,SVARTTANGEN,NO,,,77.517,20.817,+0020.0,20100825,20140523
010240,99999,PYRAMIDEN,NO,,,78.65,16.367,+0020.0,19730101,20210918
010303,99999,TROMSO/SKATTURA,NO,,,69.7,19.017,+0014.0,20140522,20150108
010320,99999,OVERBYGD,NO,,,69.017,19.283,+0078.0,19730101,20140523
010340,99999,FUGLOYKALVEN FYR,NO,,,70.317,20.15,+0038.0,19871202,20140523
010470,99999,KAUTOKEINO II,NO,,ENKA,69.017,23.067,+0307.0,19730101,20210917
010510,99999,SUOLOVUOPMI,NO,,,69.583,23.533,+0374.0,19730102,20140523
010530,99999,HAMMERFEST RADIO,NO,,,70.683,23.683,+0070.0,19730101,19871226
010610,99999,BRENNELV,NO,,,70.067,25.117,+0034.0,19730101,19840707
010660,99999,HELNES FYR,NO,,,71.067,26.233,+0033.0,19730101,20040619
010670,99999,LEVAJOK-EVJEN,NO,,,69.9,26.417,+0112.0,19730103,19820924
010671,99999,LEVAJOK-EVJEN,NO,,,69.9,26.417,+0112.0,20070307,20070307
010750,99999,RUSTEFJELBMA,NO,,,70.4,28.2,+0011.2,19730101,20130531
010884,99999,GEITERYGGEN,NO,,ENSN,59.185,9.567,+0141.1,20050103,20151109
011030,99999,LEKA,NO,,,65.1,11.7,+0047.0,19730101,20070307
011051,99999,SKOMVAER (LGT-H)             ,NO,,,67.417,11.883,+0018.0,20070307,20070307
011100,99999,YTTERHOLMEN FYR,NO,,,66.0,11.683,+0033.0,19961201,20050319
011130,99999,GLOMFJORD,NO,,,66.8,13.983,+0039.0,20040406,20091216
011133,99999,DAGALI,NO,,ENDI,60.417,8.513,+0798.0,19860509,20030427
011310,99999,GLAPEN LIGHTHOUSE,NO,,,67.883,13.05,+0031.0,19730101,19850625
011340,99999,MAJAVATN III,NO,,,65.183,13.417,+0339.0,19730101,20070630
011380,99999,TENNHOLMEN (LGT-H)           ,NO,,,67.3,13.5,+0014.0,19850912,20070307
011490,99999,RANA-BASMOEN,NO,,,66.333,14.1,+0042.0,19730101,20070228
011501,99999,HATTFJELLDAL-KRUTA,NO,,,65.683,14.167,+0385.0,20020312,20020312
011530,99999,BODO-VAGONES,NO,,,67.283,14.45,+0033.0,20111003,20140611
011540,99999,LITLOY FYR,NO,,,68.583,14.3,+0030.0,19940406,20170801
011560,99999,BO I VESTERALEN,NO,,,68.6,14.433,+0007.6,20040510,20210913
011630,99999,BOLNA,NO,,,66.5,15.25,+0549.0,19730101,19770823
011680,99999,KLEIVA I SORTLAND,NO,,,68.65,15.283,+0023.0,19730101,20060611
011691,99999,OVRE SALTDAL,NO,,,66.967,15.317,+0026.0,19730101,19781008
011700,99999,FAUSKE-VETEN,NO,,,67.233,15.317,+0165.0,19730101,19900307
011720,99999,FINNOY I HAMAROY,NO,,,68.0,15.617,+0053.0,19730101,20060311
011760,99999,KONGSVIK,NO,,,68.567,16.267,+0025.0,19730101,19780118
011840,99999,SANDSOY I SENJA,NO,,,68.933,16.683,+0045.0,19730101,19780613
011841,99999,SANDSOY,NO,,,68.933,16.683,+0045.0,20070307,20070307
011890,99999,LILAND,NO,,,68.483,16.883,+0019.0,19730102,20050302
011930,99999,NARVIK III/FRAMNES,NO,,ENNK,68.467,17.5,+0023.0,20010706,20170403
011960,99999,TENNEVOLL,NO,,,68.75,17.817,+0021.0,19730101,20020808
011980,99999,DIVIDALEN II,NO,,,68.783,19.7,+0204.0,20100114,20210918
012070,99999,FISKABYGD,NO,,,62.1,5.583,+0041.0,20040510,20180630
012091,99999,ORSTA-VOLDA/HOVD,NO,,ENOV,62.183,6.05,+0074.0,19840910,19841127
012150,99999,HJELVIK MYRBO,NO,,,62.62,7.23,+0035.0,19730101,20090630
012160,99999,HJELVIK I ROMSDAL,NO,,,62.617,7.217,+0016.0,19731226,20020527
012161,99999,GJERMUNDNES,NO,,,62.617,7.167,+0049.0,20040412,20040412
012210,99999,TAGDALEN,NO,,,63.05,9.083,+0415.0,20080115,20210909
012273,99999,TINGVOLL-HANEM,NO,,,62.833,8.3,+0069.0,20050101,20150108
012310,99999,LESJASKOG,NO,,,62.233,8.367,+0621.0,19771030,20080731
012350,99999,DOMBAS-KIRKENAER,NO,,,62.083,9.133,+0645.0,19360101,19760602
012360,99999,KJOREMSGRENDE,NO,,,62.1,9.05,+0626.0,20050218,20100104
012390,99999,HJERKINN II,NO,,,62.217,9.55,+1012.0,20100907,20210906
012430,99999,SONGLI,NO,,,63.333,9.65,+0300.0,19730101,19761119
012520,99999,BERKAK-LYNGHOLT,NO,,,62.817,10.017,+0475.0,19730101,20080930
012580,99999,TRONDHEIM (TYHOLT)           ,NO,,,63.417,10.433,+0113.0,19730101,19810714
012740,99999,SELBU-STUBBE,NO,,,63.2,11.117,+0242.0,19730101,20061115
012771,99999,LEVANGER-EGGEN,NO,,,63.717,11.233,+0097.0,19730101,19730216
012780,99999,VERDAL-REPPE,NO,,,63.783,11.683,+0083.0,19850102,20181031
012823,99999,RORVIK/RYUM,NO,,,64.85,11.233,+0014.0,19910827,19950831
012890,99999,ROROS LUFTHAVN,NO,,ENRO,62.583,11.35,+0626.0,19840909,20041230
012891,99999,ROROS/AIRPORT,NO,,ENRO,62.583,11.383,+0626.0,19790301,19840817
012920,99999,MERAKER-UTSYN,NO,,,63.417,11.7,+0240.0,19730101,20040930
012950,99999,HOYLANDET,NO,,,64.55,12.15,+0027.0,19730101,20070612


2025-01-21 06:41:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:41:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:41:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:41:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:41:17 - snowflake.connector.connection - INFO - closed
2025-01-21 06:41:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:41:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:41:59 - root - INFO - ```sql
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(g."temp") AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "temp"
        FROM
            (
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0
    AND ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat";
```
2025-01-21 06:41:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:41:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:41:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:42:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-21 06:42:01 - snowflake.connector.connection - INFO - closed
2025-01-21 06:42:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:44:08 - root - INFO - SQL:
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(g."temp") AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "temp"
        FROM
            (
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0
    AND ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat";
Results:
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
725086,DANBURY MUNI ARPT,-73.482,41.372,3649
997186,WESTERN LONG ISLAND SOUND,-73.58,40.96,1532
725037,WESTCHESTER COUNTY AIRPORT,-73.705,41.062,3653
999999,BEAR MOUNTAIN WB,-74.0,41.317,1123769
725086,DANBURY MUNICIPAL AIRPORT,-73.483,41.371,3649
999999,WHITE PLAINS WESTCHESTER CO A,-73.708,41.067,1123769

2025-01-21 06:44:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:10 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:10 - root - INFO - SQL:
-- Corrected Query 3: Find all stations located in New York state using latitude and longitude boundaries.
SELECT "usaf", "wban", "name", "state", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE
    "country" = 'US' AND
    "lat" BETWEEN 40.5 AND 45.0 AND
    "lon" BETWEEN -79.8 AND -71.8
LIMIT 100
Results:
Too long, hard cut:
usaf,wban,name,state,lat,lon
724104,99999,SOMERSET ARPT ASOS,NJ,40.633,-74.667
725010,99999,UPTON,NY,40.85,-72.85
725033,94728,NYC CENTRAL PARK,NY,40.779,-73.969
725034,99999,CALVERTON/GRUMMAN,NY,40.917,-72.783
725035,04781,LONG ISLAND MAC ART,NY,40.794,-73.102
725060,94728,NEW YORK CENTRAL PARK,NY,40.779,-73.969
725095,94746,WORCESTER RGNL,MA,42.271,-71.873
725120,14761,PHILIPSBURG AIRPORT,PA,40.9,-78.083
725120,99999,PHILIPSBURG AIRPORT,PA,40.867,-78.067
725121,14761,BURLIGTON/COLCHE,VT,40.9,-78.083
725135,14754,TOBYHANNA,PA,41.183,-75.417
725160,99999,BENNINGTON STATE,VT,42.883,-73.25
725171,99999,ALLENTOWN QUEEN CITY MUNI,PA,40.567,-75.483
725184,99999,ALBANY (NEXRAD)              ,NY,44.517,-73.167
725185,14750,FLOYD BENNETT MEM,NY,43.35,-73.617
725187,94733,CLINTON COUNTY AIRPORT,NY,44.687,-73.523
725188,99999,CAPE VINCENT MARINE AVIATION,,44.12,-76.33
725195,99999,OSWEGO COAST GUARD STATION,NY,43.47,-76.52
725196,14717,GRIFFISS AIRPARK,NY,43.234,-75.407
725197,94794,ONEIDA COUNTY AIRPORT,NY,43.145,-75.384
725198,99999,MILLBROOK/SKY ACRES,NY,41.7,-73.733
725230,94704,DANSVILLE/MUNICIPAL,NY,42.571,-77.713
725230,99999,DANSVILLE MUNICIPAL,NY,42.567,-77.717
725283,99999,CATTARAUGUS CO OLEAN,NY,42.241,-78.371
725285,99999,BUFFALO COAST GUARD STATION,NY,42.88,-78.88
725288,99999,NIAGARA COAST GUARD STATION,NY,43.27,-79.07
725295,99999,ROCHESTER COAST GUARD LIGHT S,,43.25,-77.6
726111,94765,LEBANON MUNICIPAL AP,NH,43.626,-72.305
726120,99999,NEWPORT,VT,44.93,-72.2
726221,94725,MASSENA AP,NY,44.936,-74.846
726225,04742,PLATTSBURGH INTL,NY,44.651,-73.468
744830,99999,WILMINGTON  VT.              ,,42.883,-72.883
744840,99999,WEST DOVER  VT.              ,,42.933,-72.867
744916,99999,PITTSFIELD MUNI,MA,42.433,-73.3
744976,99999,NTPD AIR OPS HELIPORT,NY,40.6,-73.9
749105,99999,MITCHEL FIELD,NY,40.733,-73.6
994320,99999,GALLOO ISLAND  NY,,43.89,-76.45
997190,99999,LAKE ONTARIO BUOY - 20NM NORT,,43.62,-77.41
998168,99999,NIAGARA CG STATION,NY,43.267,-79.067
998436,99999,BARCELONA HARBOR,NY,42.346,-79.596
999999,04727,GENEVA SAMPSON AFB,NY,42.75,-76.9
999999,04741,SCHENECTADY,NY,42.85,-73.95
999999,04782,SCHENECTADY,NY,42.833,-73.917
999999,14708,HEMPSTEAD MITCHELL FLD AFB,NY,40.733,-73.6
999999,14738,BINGHAMTON TRI-CITIES ARPT,NY,42.083,-76.1
999999,14741,BROOKVILLE FAA AP,PA,41.15,-79.1
999999,14743,CANTON 4 SE                  ,NY,44.583,-75.117
999999,14746,CURWENSVILLE,PA,41.05,-78.583
999999,14747,DUNKIRK CHAUTAUQUA CO AP,NY,42.493,-79.272
999999,14748,ELMIRA AIRPORT,NY,42.159,-76.892
999999,14749,FORT PLAIN WB AP,NY,42.967,-74.667
999999,14750,GLENS FALLS AP,NY,43.35,-73.617
999999,14752,HARTFORD BRAINARD FD,CT,41.736,-72.651
999999,14754,TOBYHANNA,PA,41.183,-75.417
999999,14757,POUGHKEEPSIE DUTCHESS CO AP,NY,41.627,-73.884
999999,14760,PARK PLACE 1 NW WB           ,PA,40.85,-76.117
999999,14770,SELINSGROVE PENN VALLEY AP,PA,40.821,-76.864
999999,14772,TICONDEROGA 3 NE             ,NY,43.883,-73.4
999999,14774,UTICA CAA AP,NY,43.167,-75.317
999999,14775,WESTFIELD BARNES MUNI AP,MA,42.158,-72.716
999999,14776,LEBANON MUNICIPAL,NH,43.626,-72.305
999999,14786,NEW YORK FLOYD BENNE,NY,40.583,-73.883
999999,14797,BEAR MOUNTAIN WB,NY,41.317,-74.0
999999,94704,DANSVILLE MUNI AP,NY,42.571,-77.713
999999,94705,MONTPELIER AP,VT,44.204,-72.562
999999,94728,NEW YORK CENTRAL PARK,NY,40.779,-73.969
999999,94741,TETERBORO AIRPORT,NJ,40.85,-74.061
999999,94765,LEBANON AWO,NH,43.626,-72.305
999999,94772,NEW HAVEN,CT,41.3,-72.933
999999,94790,WATERTOWN AP,NY,43.992,-76.022
999999,94794,UTICA ONEIDA COUNTY AP,NY,43.145,-75.384
725264,99999,SAINT MARYS MUNI,PA,41.433,-78.583
994960,99999,PORT JEFFERSON  NY,,40.95,-73.07
997186,99999,WESTERN LONG ISLAND SOUND,,40.96,-73.58
725039,99999,EATONS NECK COAST GUARD STATI,NY,40.95,-73.4
744975,99999,SHORT BEACH COAST GUARD STATI,NY,40.58,-73.55
725089,99999,NEW HAVEN COAST GUARD STATION,CT,41.27,-72.9
998267,99999,ROCHESTER,NY,43.267,-77.617
999999,14707,GROTON AAF,CT,41.328,-72.049
999999,14758,NEW HAVEN TWEED AIRPORT,CT,41.264,-72.887
725028,99999,BAY SHORE / FIRE ISLAND,NY,40.63,-73.27
725049,99999,LITTLE GULF ISLAND LIGHT STAT,CT,41.2,-72.1
720581,99999,LINDEN,NJ,40.617,-74.245
999999,00178,LINDEN AIRPORT,NJ,40.617,-74.25
725026,99999,BRONX / EXECUTION COAST GUARD,,40.88,-73.73
725047,99999,NEW LONDON LEDGE COAST GUARD,CT,41.3,-72.08
744859,99999,FREEPORT,NY,40.65,-73.583
997272,99999,BERGEN POINT,NY,40.639,-74.146
725048,99999,FAULKNER ISLAND COAST GUARD L,CT,41.22,-72.67
749108,99999,ELIZABETH AAF,NY,41.267,-72.017
999999,04725,BINGHAMTON BROOME COUNTY ARPT,NY,42.207,-75.98
999999,04751,BRADFORD REGIONAL AP,PA,41.8,-78.633
999999,14732,NEW YORK LAGUARDIA ARPT,NY,40.779,-73.88
999999,14733,BUFFALO BUFFALO ARPT,NY,42.941,-78.736
999999,14734,NEWARK INTERNATIONAL ARPT,NJ,40.683,-74.169
999999,14735,ALBANY COUNTY AP,NY,42.743,-73.809
999999,14737,ALLENTOWN BETHLEHEM-EASTON AR,PA,40.651,-75.449
999999,14740,HARTFORD BRADLEY INTL AP,CT,41.938,-72.683
999999,14742,BURLNGTN ETAN ALN AP,V

2025-01-21 06:44:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:11 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:12 - root - INFO - SQL:
-- Corrected Query 4: List stations with non-null and non-zero latitude and longitude.
SELECT "usaf", "wban", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL AND "lat" != 0 AND "lon" != 0
LIMIT 100
Results:
usaf,wban,name,lat,lon
008268,99999,WXPOD8278                    ,32.95,65.567
010016,99999,RORVIK/RYUM,64.85,11.233
010017,99999,FRIGG,59.98,2.25
010071,99999,LONGYEARBYEN,78.217,15.583
010190,99999,SVARTTANGEN,77.517,20.817
010240,99999,PYRAMIDEN,78.65,16.367
010303,99999,TROMSO/SKATTURA,69.7,19.017
010320,99999,OVERBYGD,69.017,19.283
010340,99999,FUGLOYKALVEN FYR,70.317,20.15
010470,99999,KAUTOKEINO II,69.017,23.067
010510,99999,SUOLOVUOPMI,69.583,23.533
010530,99999,HAMMERFEST RADIO,70.683,23.683
010610,99999,BRENNELV,70.067,25.117
010660,99999,HELNES FYR,71.067,26.233
010670,99999,LEVAJOK-EVJEN,69.9,26.417
010671,99999,LEVAJOK-EVJEN,69.9,26.417
010750,99999,RUSTEFJELBMA,70.4,28.2
010884,99999,GEITERYGGEN,59.185,9.567
011030,99999,LEKA,65.1,11.7
011051,99999,SKOMVAER (LGT-H)             ,67.417,11.883
011100,99999,YTTERHOLMEN FYR,66.0,11.683
011130,99999,GLOMFJORD,66.8,13.983
011133,99999,DAGALI,60.417,8.513
011310,99999,GLAPEN LIGHTHOUSE,67.883,13.05
011340,99999,MAJAVATN III,65.183,13.417
011380,99999,TENNHOLMEN (LGT-H)           ,67.3,13.5
011490,99999,RANA-BASMOEN,66.333,14.1
011501,99999,HATTFJELLDAL-KRUTA,65.683,14.167
011530,99999,BODO-VAGONES,67.283,14.45
011540,99999,LITLOY FYR,68.583,14.3
011560,99999,BO I VESTERALEN,68.6,14.433
011630,99999,BOLNA,66.5,15.25
011680,99999,KLEIVA I SORTLAND,68.65,15.283
011691,99999,OVRE SALTDAL,66.967,15.317
011700,99999,FAUSKE-VETEN,67.233,15.317
011720,99999,FINNOY I HAMAROY,68.0,15.617
011760,99999,KONGSVIK,68.567,16.267
011840,99999,SANDSOY I SENJA,68.933,16.683
011841,99999,SANDSOY,68.933,16.683
011890,99999,LILAND,68.483,16.883
011930,99999,NARVIK III/FRAMNES,68.467,17.5
011960,99999,TENNEVOLL,68.75,17.817
011980,99999,DIVIDALEN II,68.783,19.7
012070,99999,FISKABYGD,62.1,5.583
012091,99999,ORSTA-VOLDA/HOVD,62.183,6.05
012150,99999,HJELVIK MYRBO,62.62,7.23
012160,99999,HJELVIK I ROMSDAL,62.617,7.217
012161,99999,GJERMUNDNES,62.617,7.167
012210,99999,TAGDALEN,63.05,9.083
012273,99999,TINGVOLL-HANEM,62.833,8.3
012310,99999,LESJASKOG,62.233,8.367
012350,99999,DOMBAS-KIRKENAER,62.083,9.133
012360,99999,KJOREMSGRENDE,62.1,9.05
012390,99999,HJERKINN II,62.217,9.55
012430,99999,SONGLI,63.333,9.65
012520,99999,BERKAK-LYNGHOLT,62.817,10.017
012580,99999,TRONDHEIM (TYHOLT)           ,63.417,10.433
012740,99999,SELBU-STUBBE,63.2,11.117
012771,99999,LEVANGER-EGGEN,63.717,11.233
012780,99999,VERDAL-REPPE,63.783,11.683
012823,99999,RORVIK/RYUM,64.85,11.233
012890,99999,ROROS LUFTHAVN,62.583,11.35
012891,99999,ROROS/AIRPORT,62.583,11.383
012920,99999,MERAKER-UTSYN,63.417,11.7
012950,99999,HOYLANDET,64.55,12.15
012960,99999,BERG I SNASA,64.25,12.417
012980,99999,NORDLI-HOLAND,64.45,13.717
013060,99999,HELLISOY FYR,60.75,4.717
013160,99999,BERGEN-FREDRIKSBERG,60.4,5.317
013180,99999,SANDANE,61.783,6.183
013220,99999,FORDE-TEFRE,61.467,5.917
013250,99999,MODALEN II,60.833,5.95
013280,99999,KVAMSKOGEN,60.4,5.917
013390,99999,VANGSNES,61.167,6.65
013410,99999,EIDFJORD-BU,60.467,6.867
013471,99999,SOGNDAL/HAUKASEN,61.167,7.133
013510,99999,FINSE III,60.6,7.5
013560,99999,FANNARAKI,61.517,7.9
013591,99999,HAUGASTOL,60.517,7.867
013671,99999,BEITOSTOLEN,61.233,8.933
013690,99999,ABJORSBRATEN,60.917,9.283
013720,99999,NESBYEN-SKOGLUND,60.567,9.133
013743,99999,FAGERNES/LEIRIN   &          ,61.0,9.3
013790,99999,SOR-NESSET,61.883,10.15
013801,99999,KITTILBU,61.167,9.967
013839,99999,HAMAR / STAFSBERG,60.817,11.067
013910,99999,FLISA,60.617,12.017
014000,99999,EKOFISK,56.55,3.217
014010,99999,FRIGG,59.983,2.25
014035,99999,KARMOY,59.35,5.217
014110,99999,KVITSOY - NORDBO,59.067,5.417
014120,99999,OBRESTAD,58.65,5.567
014211,99999,INDRE MATRE,59.85,6.0
014280,99999,LISTA,58.099,6.626
014320,99999,SIRDAL-TJORHOM,58.883,6.85
014321,99999,FIDJELAND,58.967,6.933
014330,99999,MIDTLAEGER,59.833,6.983
014450,99999,SKAFSA,59.45,8.0
014460,99999,OYFJELL-TROVATN,59.567,8.2
014611,99999,GAUSTATOPPEN,59.85,8.65

2025-01-21 06:44:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:13 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:13 - root - INFO - SQL:
-- Corrected Query 5: Create geography points for each station with valid coordinates.
SELECT "usaf", "wban", "name", ST_MAKEPOINT("lon", "lat") AS "geom"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL AND "lat" != 0 AND "lon" != 0
LIMIT 100
Results:
Too long, hard cut:
usaf,wban,name,geom
008268,99999,WXPOD8278                    ,"{
  ""coordinates"": [
    6.556699999999999e+01,
    3.295000000000000e+01
  ],
  ""type"": ""Point""
}"
010016,99999,RORVIK/RYUM,"{
  ""coordinates"": [
    1.123300000000000e+01,
    6.484999999999999e+01
  ],
  ""type"": ""Point""
}"
010017,99999,FRIGG,"{
  ""coordinates"": [
    2.250000000000000e+00,
    5.998000000000000e+01
  ],
  ""type"": ""Point""
}"
010071,99999,LONGYEARBYEN,"{
  ""coordinates"": [
    1.558300000000000e+01,
    7.821700000000000e+01
  ],
  ""type"": ""Point""
}"
010190,99999,SVARTTANGEN,"{
  ""coordinates"": [
    2.081700000000000e+01,
    7.751700000000000e+01
  ],
  ""type"": ""Point""
}"
010240,99999,PYRAMIDEN,"{
  ""coordinates"": [
    1.636700000000000e+01,
    7.865000000000001e+01
  ],
  ""type"": ""Point""
}"
010303,99999,TROMSO/SKATTURA,"{
  ""coordinates"": [
    1.901700000000000e+01,
    6.970000000000000e+01
  ],
  ""type"": ""Point""
}"
010320,99999,OVERBYGD,"{
  ""coordinates"": [
    1.928300000000000e+01,
    6.901700000000000e+01
  ],
  ""type"": ""Point""
}"
010340,99999,FUGLOYKALVEN FYR,"{
  ""coordinates"": [
    2.015000000000000e+01,
    7.031699999999999e+01
  ],
  ""type"": ""Point""
}"
010470,99999,KAUTOKEINO II,"{
  ""coordinates"": [
    2.306700000000000e+01,
    6.901700000000000e+01
  ],
  ""type"": ""Point""
}"
010510,99999,SUOLOVUOPMI,"{
  ""coordinates"": [
    2.353300000000000e+01,
    6.958300000000000e+01
  ],
  ""type"": ""Point""
}"
010530,99999,HAMMERFEST RADIO,"{
  ""coordinates"": [
    2.368300000000000e+01,
    7.068300000000001e+01
  ],
  ""type"": ""Point""
}"
010610,99999,BRENNELV,"{
  ""coordinates"": [
    2.511700000000000e+01,
    7.006699999999999e+01
  ],
  ""type"": ""Point""
}"
010660,99999,HELNES FYR,"{
  ""coordinates"": [
    2.623300000000000e+01,
    7.106699999999999e+01
  ],
  ""type"": ""Point""
}"
010670,99999,LEVAJOK-EVJEN,"{
  ""coordinates"": [
    2.641700000000000e+01,
    6.990000000000001e+01
  ],
  ""type"": ""Point""
}"
010671,99999,LEVAJOK-EVJEN,"{
  ""coordinates"": [
    2.641700000000000e+01,
    6.990000000000001e+01
  ],
  ""type"": ""Point""
}"
010750,99999,RUSTEFJELBMA,"{
  ""coordinates"": [
    2.820000000000000e+01,
    7.040000000000001e+01
  ],
  ""type"": ""Point""
}"
010884,99999,GEITERYGGEN,"{
  ""coordinates"": [
    9.567000000000000e+00,
    5.918500000000000e+01
  ],
  ""type"": ""Point""
}"
011030,99999,LEKA,"{
  ""coordinates"": [
    1.170000000000000e+01,
    6.509999999999999e+01
  ],
  ""type"": ""Point""
}"
011051,99999,SKOMVAER (LGT-H)             ,"{
  ""coordinates"": [
    1.188300000000000e+01,
    6.741700000000000e+01
  ],
  ""type"": ""Point""
}"
011100,99999,YTTERHOLMEN FYR,"{
  ""coordinates"": [
    1.168300000000000e+01,
    6.600000000000000e+01
  ],
  ""type"": ""Point""
}"
011130,99999,GLOMFJORD,"{
  ""coordinates"": [
    1.398300000000000e+01,
    6.680000000000000e+01
  ],
  ""type"": ""Point""
}"
011133,99999,DAGALI,"{
  ""coordinates"": [
    8.513000000000000e+00,
    6.041700000000000e+01
  ],
  ""type"": ""Point""
}"
011310,99999,GLAPEN LIGHTHOUSE,"{
  ""coordinates"": [
    1.305000000000000e+01,
    6.788300000000000e+01
  ],
  ""type"": ""Point""
}"
011340,99999,MAJAVATN III,"{
  ""coordinates"": [
    1.341700000000000e+01,
    6.518300000000001e+01
  ],
  ""type"": ""Point""
}"
011380,99999,TENNHOLMEN (LGT-H)           ,"{
  ""coordinates"": [
    1.350000000000000e+01,
    6.730000000000000e+01
  ],
  ""type"": ""Point""
}"
011490,99999,RANA-BASMOEN,"{
  ""coordinates"": [
    1.410000000000000e+01,
    6.633300000000000e+01
  ],
  ""type"": ""Point""
}"
011501,99999,HATTFJELLDAL-KRUTA,"{
  ""coordinates"": [
    1.416700000000000e+01,
    6.568300000000001e+01
  ],
  ""type"": ""Point""
}"
011530,99999,BODO-VAGONES,"{
  ""coordinates"": [
    1.445000000000000e+01,
    6.728300000000000e+01
  ],
  ""type"": ""Point""
}"
011540,99999,LITLOY FYR,"{
  ""coordinates"": [
    1.430000000000000e+01,
    6.858300000000000e+01
  ],
  ""type"": ""Point""
}"
011560,99999,BO I VESTERALEN,"{
  ""coordinates"": [
    1.443300000000000e+01,
    6.859999999999999e+01
  ],
  ""type"": ""Point""
}"
011630,99999,BOLNA,"{
  ""coordinates"": [
    1.525000000000000e+01,
    6.650000000000000e+01
  ],
  ""type"": ""Point""
}"
011680,99999,KLEIVA I SORTLAND,"{
  ""coordinates"": [
    1.528300000000000e+01,
    6.865000000000001e+01
  ],
  ""type"": ""Point""
}"
011691,99999,OVRE SALTDAL,"{
  ""coordinates"": [
    1.531700000000000e+01,
    6.696700000000000e+01
  ],
  ""type"": ""Point""
}"
011700,99999,FAUSKE-VETEN,"{
  ""coordinates"": [
    1.531700000000000e+01,
    6.723300000000000e+01
  ],
  ""type"": ""Point""
}"
011720,99999,FINNOY I HAMAROY,"{
  ""coordinates"": [
    1.561700000000000e+01,
    6.800000000000000e+01
  ],
  ""type"": ""Point""
}"
011760,99999,KONGSVIK,"{
  ""coordinates"": [
    1.626700000000000e+01,
    6.856699999999999e+01
  ],
  ""type"": ""Point""
}"
011840,99999,SANDSOY I

2025-01-21 06:44:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-21 06:44:15 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:16 - root - INFO - SQL:
-- Corrected Query 6: Find stations within a 20-mile radius of Chappaqua, NY.
SELECT "usaf", "wban", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE
    "lat" IS NOT NULL AND "lon" IS NOT NULL AND "lat" != 0 AND "lon" != 0 AND
    ST_DWITHIN(
        ST_MAKEPOINT("lon", "lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
LIMIT 100
Results:
usaf,wban,name,lat,lon
999999,14797,BEAR MOUNTAIN WB,41.317,-74.0
997186,99999,WESTERN LONG ISLAND SOUND,40.96,-73.58
999999,94745,WHITE PLAINS WESTCHESTER CO A,41.067,-73.708
725086,99999,DANBURY MUNI ARPT,41.372,-73.482
725037,94745,WESTCHESTER COUNTY AIRPORT,41.062,-73.705
725086,54734,DANBURY MUNICIPAL AIRPORT,41.371,-73.483

2025-01-21 06:44:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:17 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:17 - root - INFO - SQL:
-- Corrected Query 7: View temperature observations from GSOD2011.
SELECT "stn", "wban", "year", "mo", "da", "temp", "count_temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100
Results:
stn,wban,year,mo,da,temp,count_temp
387340,99999,2011,11,08,28.6,6
387250,99999,2011,02,04,31.5,6
388440,99999,2011,02,07,24.4,7
724293,99999,2011,11,13,24.3,8
061080,99999,2011,07,22,59.9,8
388460,99999,2011,11,09,32.5,4
388440,99999,2011,02,26,17.3,6
388440,99999,2011,11,09,23.8,6
387340,99999,2011,10,05,46.3,6
023020,99999,2011,04,12,32.9,12
021300,99999,2011,02,28,30.5,14
680025,99999,2011,01,28,71.2,16
023020,99999,2011,06,11,62.2,17
023030,99999,2011,08,31,44.7,18
026020,99999,2011,11,27,48.0,19
021300,99999,2011,05,31,42.6,20
022330,99999,2011,01,14,-14.0,23
020540,99999,2011,05,03,29.8,23
025210,99999,2011,06,07,65.2,23
026460,99999,2011,01,25,31.7,23
026460,99999,2011,08,06,66.1,23
023020,99999,2011,10,06,42.9,23
025210,99999,2011,08,08,59.1,23
022560,99999,2011,12,19,23.6,24
023370,99999,2011,03,13,22.9,24
023370,99999,2011,03,25,23.4,24
022160,99999,2011,03,09,30.7,24
023030,99999,2011,04,04,30.3,24
026520,99999,2011,02,22,20.3,24
010231,99999,2011,03,11,34.0,24
023020,99999,2011,12,25,33.6,24
722857,99999,2011,12,03,29.0,24
021230,99999,2011,01,09,13.0,24
024130,99999,2011,12,09,31.5,24
021460,99999,2011,04,10,30.3,24
021460,99999,2011,01,14,-12.5,24
023370,99999,2011,02,11,5.4,24
023110,99999,2011,02,07,24.8,24
022330,99999,2011,03,11,11.3,24
020540,99999,2011,01,16,8.8,24
022170,99999,2011,02,02,30.4,24
022560,99999,2011,11,27,23.0,24
024130,99999,2011,02,23,3.9,24
022170,99999,2011,03,06,25.4,24
026460,99999,2011,02,19,20.6,24
023110,99999,2011,01,08,16.2,24
022920,99999,2011,02,19,4.8,24
024130,99999,2011,02,07,12.5,24
720654,99999,2011,06,26,83.6,19
023020,99999,2011,03,07,28.3,20
025070,99999,2011,08,24,57.8,20
026520,99999,2011,08,18,62.5,21
026460,99999,2011,06,14,60.9,22
026090,99999,2011,09,30,58.4,22
025070,99999,2011,06,05,62.3,22
022560,99999,2011,09,16,43.4,23
026090,99999,2011,12,09,42.0,23
026520,99999,2011,06,22,64.7,23
024720,99999,2011,02,25,26.3,24
021460,99999,2011,12,08,10.9,24
025070,99999,2011,01,04,31.5,24
023370,99999,2011,02,04,16.7,24
022560,99999,2011,12,30,13.9,24
021230,99999,2011,02,22,-10.6,24
021230,99999,2011,02,11,12.5,24
023020,99999,2011,02,18,3.0,24
026460,99999,2011,01,21,28.4,24
023030,99999,2011,02,06,21.7,24
021300,99999,2011,03,28,16.1,24
022170,99999,2011,01,15,13.2,24
022330,99999,2011,12,17,26.6,24
026520,99999,2011,02,21,22.1,24
023020,99999,2011,10,20,32.6,24
025210,99999,2011,03,01,28.6,24
022170,99999,2011,03,22,32.5,24
021700,99999,2011,01,16,14.5,24
023020,99999,2011,01,12,19.2,24
021700,99999,2011,12,21,21.5,24
022160,99999,2011,02,15,7.8,24
022560,99999,2011,01,26,10.5,24
026520,99999,2011,02,23,19.4,24
024130,99999,2011,01,15,6.8,24
020540,99999,2011,01,02,14.5,24
023030,99999,2011,01,06,14.6,24
022170,99999,2011,01,01,25.8,24
022330,99999,2011,12,03,23.9,24
022920,99999,2011,11,28,28.5,24
023490,99999,2011,01,15,-4.8,24
025530,99999,2011,12,05,31.8,24
022560,99999,2011,02,15,-1.0,24
023540,99999,2011,03,14,30.4,24
021300,99999,2011,02,07,6.0,24
023020,99999,2011,08,01,57.0,13
022330,99999,2011,09,14,49.1,15
024130,99999,2011,05,01,41.2,19
022920,99999,2011,11,25,37.0,19
026520,99999,2011,08,17,62.2,20
022160,99999,2011,10,28,41.7,22
025950,99999,2011,06,05,60.1,22
023490,99999,2011,02,24,3.1,23

2025-01-21 06:44:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:18 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:19 - root - INFO - SQL:
-- Corrected Query 8: Count the number of valid temperature observations per station in 2011.
SELECT "stn", COUNT(*) AS "valid_temp_observations_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Results:
stn,valid_temp_observations_2011
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358

2025-01-21 06:44:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:20 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:21 - root - INFO - SQL:
-- Corrected Query 9: Sum the total number of temperature measurements contributing to the mean per station in 2011.
SELECT "stn", SUM("count_temp") AS "total_temp_measurements_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "count_temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Results:
stn,total_temp_measurements_2011
873490,2858
309350,2907
357000,2732
343910,2816
261340,2865
330190,2095
471400,2917
247680,2833
297360,2905
288070,2758
961790,2868
306730,2889
385990,2527
484800,2918
470280,2713
060110,2716
432260,2841
227210,2913
427540,2855
263890,2912
874480,2855
360960,2910
383880,2889
291220,2907
345040,2742
226210,2896
470350,2791
875480,2887
610750,2861
333770,2746
967910,2331
028720,2883
874670,2692
610960,2858
278570,2798
612400,2457
234120,2707
249590,2857
388950,2914
319870,2720
272080,2914
252820,2849
426230,2844
370850,2777
308620,2903
296250,2909
261440,2868
314890,2716
485320,3107
623250,2648
984300,2880
350110,2776
597580,2917
400300,2483
572970,2918
324080,2588
509150,2918
514310,2913
766753,8591
404390,8666
997993,8398
129250,8631
997386,8566
724463,8745
966450,2865
484200,2912
484150,2727
337610,2771
383410,2715
325830,2608
485740,2725
432130,2867
471350,2913
471620,2917
961630,2820
345790,2862
470700,2712
292820,2911
360580,2911
471500,2916
319150,2736
278350,2725
280490,2719
347300,2784
285880,2652
335870,2770
314840,2703
483580,2721
133890,2886
253560,2212
293480,2914
299370,2915
360640,2899
485570,2709
970480,2858
973400,2792
297120,2910
484000,2918
345450,2750
221270,2747

2025-01-21 06:44:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:22 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:23 - root - INFO - SQL:
-- Corrected Query 10: Find stations within 20 miles of Chappaqua and list their temperature observations in 2011.
SELECT s."usaf", s."wban", s."name", g."year", g."mo", g."da", g."temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" g
  ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0 AND
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8
    )
LIMIT 100
Results:
Too long, hard cut:
usaf,wban,name,year,mo,da,temp
997186,99999,WESTERN LONG ISLAND SOUND,2011,01,24,18.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,12,25,43.0
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,27,62.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,06,02,75.7
997186,99999,WESTERN LONG ISLAND SOUND,2011,11,25,51.0
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,26,58.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,10,03,57.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,10,20,62.9
997186,99999,WESTERN LONG ISLAND SOUND,2011,09,22,70.4
999999,14797,BEAR MOUNTAIN WB,2011,06,18,89.1
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,06,18,89.1
997186,99999,WESTERN LONG ISLAND SOUND,2011,05,17,53.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,12,27,43.3
999999,14797,BEAR MOUNTAIN WB,2011,02,16,55.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,16,55.5
997186,99999,WESTERN LONG ISLAND SOUND,2011,01,20,32.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,18,51.9
997186,99999,WESTERN LONG ISLAND SOUND,2011,06,18,64.7
997186,99999,WESTERN LONG ISLAND SOUND,2011,03,25,38.1
997186,99999,WESTERN LONG ISLAND SOUND,2011,09,23,70.7
999999,14797,BEAR MOUNTAIN WB,2011,03,31,62.0
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,03,31,62.0
999999,14797,BEAR MOUNTAIN WB,2011,02,17,54.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,17,54.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,15,50.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,23,80.8
999999,14797,BEAR MOUNTAIN WB,2011,06,11,65.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,06,11,65.6
999999,14797,BEAR MOUNTAIN WB,2011,01,03,63.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,03,63.3
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,18,76.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,08,03,74.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,10,11,66.7
997186,99999,WESTERN LONG ISLAND SOUND,2011,11,04,50.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,12,07,50.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,06,06,69.1
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,09,70.3
997186,99999,WESTERN LONG ISLAND SOUND,2011,05,31,72.9
999999,14797,BEAR MOUNTAIN WB,2011,06,18,84.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,06,18,84.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,22,79.8
997186,99999,WESTERN LONG ISLAND SOUND,2011,08,19,74.0
999999,14797,BEAR MOUNTAIN WB,2011,09,30,71.0
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,09,30,71.0
999999,14797,BEAR MOUNTAIN WB,2011,03,14,60.7
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,03,14,60.7
999999,14797,BEAR MOUNTAIN WB,2011,07,21,77.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,07,21,77.3
999999,14797,BEAR MOUNTAIN WB,2011,08,20,82.9
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,08,20,82.9
999999,14797,BEAR MOUNTAIN WB,2011,04,16,56.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,04,16,56.5
999999,14797,BEAR MOUNTAIN WB,2011,01,14,31.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,14,31.6
999999,14797,BEAR MOUNTAIN WB,2011,02,04,17.1
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,04,17.1
999999,14797,BEAR MOUNTAIN WB,2011,02,17,27.1
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,17,27.1
999999,14797,BEAR MOUNTAIN WB,2011,01,19,31.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,19,31.6
999999,14797,BEAR MOUNTAIN WB,2011,02,16,36.7
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,16,36.7
999999,14797,BEAR MOUNTAIN WB,2011,01,01,-6.9
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,01,-6.9
999999,14797,BEAR MOUNTAIN WB,2011,01,18,31.2
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,18,31.2
999999,14797,BEAR MOUNTAIN WB,2011,02,01,15.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,01,15.6
999999,14797,BEAR MOUNTAIN WB,2011,02,23,29.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,23,29.6
999999,14797,BEAR MOUNTAIN WB,2011,02,27,27.8
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,27,27.8
999999,14797,BEAR MOUNTAIN WB,2011,12,13,24.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,12,13,24.3
999999,14797,BEAR MOUNTAIN WB,2011,12,05,16.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,12,05,16.5
999999,14797,BEAR MOUNTAIN WB,2011,08,12,83.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,08,12,83.3
999999,14797,BEAR MOUNTAIN WB,2011,11,05,33.0
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,11,05,33.0
999999,14797,BEAR MOUNTAIN WB,2011,11,27,68.8
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,11,27,68.8
999999,14797,BEAR MOUNTAIN WB,2011,09,10,70.4
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,09,10,70.4
999999,14797,BEAR MOUNTAIN WB,2011,09,16,65.7
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,09,16,65.7
999999,14797,BEAR MOUNTAIN WB,2011,10,30,47.4
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,10,30,47.4
999999,14797,BEAR MOUNTAIN WB,2011,10,15,65.8
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,10,15,65.8
999999,14797,BEAR MOUNTAIN WB,2011,11,23,38.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,11,23,38.5
999999,14797,BEAR MOUNTAIN WB,2011,10,09,46.7
999999,94745,WHITE PLAI

2025-01-21 06:44:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-21 06:44:24 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:24 - root - INFO - SQL:
-- Corrected Query 11: Find the distinct years available in the GSOD tables (using multiple years).
SELECT DISTINCT "year"
FROM (
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
) AS years
LIMIT 100
Results:
year
2011
2012
2014
2015
2016
2018
2019
2020
2013
2017

2025-01-21 06:44:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:26 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:26 - root - INFO - SQL:
-- Corrected Query 12: List distinct station IDs from GSOD2011.
SELECT DISTINCT "stn"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100
Results:
stn
297120
291220
471560
280490
967910
285880
404170
483600
319150
234120
253560
360580
874480
360640
278570
388950
306730
337610
612400
961630
484150
488300
977220
873490
610960
247680
319870
345040
333770
471500
370850
314890
973400
970480
252820
347300
343910
288070
610750
874670
470350
227210
292820
272080
249590
471350
483580
133890
470600
875480
335870
308620
485320
309350
357000
330190
966450
385990
961790
261340
432260
471400
297360
484800
470280
060110
360960
427540
263890
387250
021230
020540
026090
022170
720605
720406
720743
369740
369820
723761
724833
085020
965050
480200
633310
677650
432210
113080
106164
643900
682905
680300
035660
679770
722907
679750
720411
643600
726603
702755

2025-01-21 06:44:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:27 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:28 - root - INFO - SQL:
-- Corrected Query 13: Count valid temperature observations for each station in 2011.
SELECT "stn", COUNT(*) AS "valid_temp_observations_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Results:
stn,valid_temp_observations_2011
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358

2025-01-21 06:44:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:44:29 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:29 - root - INFO - SQL:
-- Corrected Query 14: List stations with their earliest and latest observation dates in 2011.
SELECT "stn",
    MIN(DATE_FROM_PARTS("year", "mo", "da")) AS "first_observation",
    MAX(DATE_FROM_PARTS("year", "mo", "da")) AS "last_observation"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "year" IS NOT NULL AND "mo" IS NOT NULL AND "da" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Results:
stn,first_observation,last_observation
297120,2011-01-01,2011-12-31
291220,2011-01-01,2011-12-31
337610,2011-01-01,2011-12-31
360580,2011-01-01,2011-12-31
234120,2011-01-01,2011-12-31
471560,2011-01-01,2011-12-31
612400,2011-01-02,2011-12-30
319150,2011-01-01,2011-12-31
285880,2011-01-01,2011-12-31
280490,2011-01-01,2011-12-31
967910,2011-01-01,2011-12-31
404170,2011-01-01,2011-12-31
961630,2011-01-01,2011-12-31
278570,2011-01-01,2011-12-31
306730,2011-01-01,2011-12-31
427540,2011-01-01,2011-12-31
263890,2011-01-01,2011-12-31
343910,2011-01-01,2011-12-31
299370,2011-01-01,2011-12-31
970480,2011-01-01,2011-12-31
426230,2011-01-01,2011-12-31
610960,2011-01-01,2011-12-31
370850,2011-01-01,2011-12-31
977220,2011-01-01,2011-12-31
345450,2011-01-01,2011-12-31
261340,2011-01-01,2011-12-31
308620,2011-01-01,2011-12-31
227210,2011-01-01,2011-12-31
432130,2011-01-01,2011-12-31
973400,2011-01-01,2011-12-31
875480,2011-01-01,2011-12-31
484150,2011-01-01,2011-12-31
028720,2011-01-01,2011-12-31
357000,2011-01-01,2011-12-31
484000,2011-01-01,2011-12-31
296250,2011-01-01,2011-12-31
985380,2011-01-01,2011-12-31
610750,2011-01-01,2011-12-31
335870,2011-01-01,2011-12-31
873490,2011-01-01,2011-12-31
345040,2011-01-01,2011-12-31
292820,2011-01-01,2011-12-31
485320,2011-01-01,2011-12-31
319870,2011-01-01,2011-12-31
249590,2011-01-01,2011-12-31
297360,2011-01-01,2011-12-31
385990,2011-01-01,2011-12-31
350110,2011-01-01,2011-12-31
984300,2011-01-01,2011-12-31
624550,2011-01-01,2011-12-31
572970,2011-01-01,2011-12-31
509150,2011-01-01,2011-12-31
324080,2011-01-01,2011-12-31
471620,2011-01-01,2011-12-31
597580,2011-01-01,2011-12-31
576620,2011-01-01,2011-12-31
766920,2011-01-01,2011-12-31
514310,2011-01-01,2011-12-31
624230,2011-01-01,2011-12-31
404390,2011-01-01,2011-12-31
766753,2011-01-01,2011-12-31
997993,2011-01-01,2011-12-31
129250,2011-01-01,2011-12-31
997386,2011-01-01,2011-12-31
483600,2011-01-02,2011-12-31
253560,2011-01-01,2011-12-31
874480,2011-01-01,2011-12-31
360640,2011-01-01,2011-12-31
345790,2011-01-01,2011-12-31
330190,2011-01-01,2011-12-31
360960,2011-01-01,2011-12-31
260290,2011-01-01,2011-12-31
319690,2011-01-01,2011-12-31
282140,2011-01-01,2011-12-31
471920,2011-01-01,2011-12-31
485570,2011-01-01,2011-12-31
383880,2011-01-01,2011-12-31
383410,2011-01-01,2011-12-31
296450,2011-01-01,2011-12-31
288070,2011-01-01,2011-12-31
470700,2011-01-03,2011-12-31
483720,2011-01-01,2011-12-31
966450,2011-01-01,2011-12-31
961790,2011-01-01,2011-12-31
874670,2011-01-01,2011-12-31
470350,2011-01-02,2011-12-31
309350,2011-01-01,2011-12-31
272080,2011-01-01,2011-12-31
133890,2011-01-01,2011-12-31
294050,2011-01-01,2011-12-31
484800,2011-01-01,2011-12-31
485740,2011-01-01,2011-12-31
483580,2011-01-01,2011-12-31
252820,2011-01-01,2011-12-31
226210,2011-01-01,2011-12-31
402650,2011-01-01,2011-12-31
293480,2011-01-01,2011-12-31
987470,2011-01-01,2011-12-31
221270,2011-01-01,2011-12-31
314890,2011-01-01,2011-12-31

2025-01-21 06:44:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-21 06:44:31 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:44:32 - root - INFO - SQL:
-- Corrected Query 15: Find stations within 20 miles of Chappaqua and their total valid temperature observations in 2015.
SELECT s."usaf", s."wban", s."name", COUNT(*) AS "valid_temp_observations_2015"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" g
  ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0 AND
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8
    ) AND g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100
Results:
usaf,wban,name,valid_temp_observations_2015
997186,99999,WESTERN LONG ISLAND SOUND,51
725086,54734,DANBURY MUNICIPAL AIRPORT,365
999999,94745,WHITE PLAINS WESTCHESTER CO A,181871
725037,94745,WESTCHESTER COUNTY AIRPORT,365
999999,14797,BEAR MOUNTAIN WB,181871
725086,99999,DANBURY MUNI ARPT,365

2025-01-21 06:44:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:44:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:44:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:44:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-21 06:44:33 - snowflake.connector.connection - INFO - closed
2025-01-21 06:44:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:45:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:45:18 - root - INFO - ```sql
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(g."temp") AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "wban", "temp"
        FROM
            (
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat"
LIMIT 100;
```
2025-01-21 06:45:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:45:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:45:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:45:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 06:45:20 - snowflake.connector.connection - INFO - closed
2025-01-21 06:45:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:46:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:46:19 - root - INFO - SQL:
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(g."temp") AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "wban", "temp"
        FROM
            (
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat"
LIMIT 100;
Results:
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
997186,WESTERN LONG ISLAND SOUND,-73.58,40.96,1532
725086,DANBURY MUNICIPAL AIRPORT,-73.483,41.371,3649
725037,WESTCHESTER COUNTY AIRPORT,-73.705,41.062,3653

2025-01-21 06:46:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:46:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:46:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:46:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-21 06:46:21 - snowflake.connector.connection - INFO - closed
2025-01-21 06:46:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:46:21 - root - INFO - SQL:
-- Corrected Query 17: Find the maximum and minimum temperatures recorded by stations within 20 miles of Chappaqua in 2020.
SELECT s."usaf", s."wban", s."name",
    MAX(g."temp") AS "max_temp_2020",
    MIN(g."temp") AS "min_temp_2020"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020" g
  ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    ) AND g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100
Results:
usaf,wban,name,max_temp_2020,min_temp_2020
725086,54734,DANBURY MUNICIPAL AIRPORT,82.4,15.1
725037,94745,WESTCHESTER COUNTY AIRPORT,83.6,17.3

2025-01-21 06:46:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:46:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:46:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:46:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:46:22 - snowflake.connector.connection - INFO - closed
2025-01-21 06:46:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:46:23 - root - INFO - SQL:
-- Corrected Query 18: Retrieve station information along with elevation data.
SELECT "usaf", "wban", "name", "lat", "lon", "elev"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "elev" IS NOT NULL AND "elev" != ''
LIMIT 100
Results:
usaf,wban,name,lat,lon,elev
007018,99999,WXPOD 7018                   ,0.0,0.0,+7018.0
007026,99999,WXPOD 7026                   ,0.0,0.0,+7026.0
007070,99999,WXPOD 7070                   ,0.0,0.0,+7070.0
008268,99999,WXPOD8278                    ,32.95,65.567,+1156.7
008307,99999,WXPOD 8318                   ,0.0,0.0,+8318.0
010016,99999,RORVIK/RYUM,64.85,11.233,+0014.0
010017,99999,FRIGG,59.98,2.25,+0048.0
010071,99999,LONGYEARBYEN,78.217,15.583,+0037.0
010190,99999,SVARTTANGEN,77.517,20.817,+0020.0
010240,99999,PYRAMIDEN,78.65,16.367,+0020.0
010303,99999,TROMSO/SKATTURA,69.7,19.017,+0014.0
010320,99999,OVERBYGD,69.017,19.283,+0078.0
010340,99999,FUGLOYKALVEN FYR,70.317,20.15,+0038.0
010470,99999,KAUTOKEINO II,69.017,23.067,+0307.0
010510,99999,SUOLOVUOPMI,69.583,23.533,+0374.0
010530,99999,HAMMERFEST RADIO,70.683,23.683,+0070.0
010610,99999,BRENNELV,70.067,25.117,+0034.0
010660,99999,HELNES FYR,71.067,26.233,+0033.0
010670,99999,LEVAJOK-EVJEN,69.9,26.417,+0112.0
010671,99999,LEVAJOK-EVJEN,69.9,26.417,+0112.0
010750,99999,RUSTEFJELBMA,70.4,28.2,+0011.2
010884,99999,GEITERYGGEN,59.185,9.567,+0141.1
011030,99999,LEKA,65.1,11.7,+0047.0
011051,99999,SKOMVAER (LGT-H)             ,67.417,11.883,+0018.0
011100,99999,YTTERHOLMEN FYR,66.0,11.683,+0033.0
011130,99999,GLOMFJORD,66.8,13.983,+0039.0
011133,99999,DAGALI,60.417,8.513,+0798.0
011310,99999,GLAPEN LIGHTHOUSE,67.883,13.05,+0031.0
011340,99999,MAJAVATN III,65.183,13.417,+0339.0
011380,99999,TENNHOLMEN (LGT-H)           ,67.3,13.5,+0014.0
011490,99999,RANA-BASMOEN,66.333,14.1,+0042.0
011501,99999,HATTFJELLDAL-KRUTA,65.683,14.167,+0385.0
011530,99999,BODO-VAGONES,67.283,14.45,+0033.0
011540,99999,LITLOY FYR,68.583,14.3,+0030.0
011560,99999,BO I VESTERALEN,68.6,14.433,+0007.6
011630,99999,BOLNA,66.5,15.25,+0549.0
011680,99999,KLEIVA I SORTLAND,68.65,15.283,+0023.0
011691,99999,OVRE SALTDAL,66.967,15.317,+0026.0
011700,99999,FAUSKE-VETEN,67.233,15.317,+0165.0
011720,99999,FINNOY I HAMAROY,68.0,15.617,+0053.0
011760,99999,KONGSVIK,68.567,16.267,+0025.0
011840,99999,SANDSOY I SENJA,68.933,16.683,+0045.0
011841,99999,SANDSOY,68.933,16.683,+0045.0
011890,99999,LILAND,68.483,16.883,+0019.0
011930,99999,NARVIK III/FRAMNES,68.467,17.5,+0023.0
011960,99999,TENNEVOLL,68.75,17.817,+0021.0
011980,99999,DIVIDALEN II,68.783,19.7,+0204.0
012070,99999,FISKABYGD,62.1,5.583,+0041.0
012091,99999,ORSTA-VOLDA/HOVD,62.183,6.05,+0074.0
012150,99999,HJELVIK MYRBO,62.62,7.23,+0035.0
012160,99999,HJELVIK I ROMSDAL,62.617,7.217,+0016.0
012161,99999,GJERMUNDNES,62.617,7.167,+0049.0
012210,99999,TAGDALEN,63.05,9.083,+0415.0
012273,99999,TINGVOLL-HANEM,62.833,8.3,+0069.0
012310,99999,LESJASKOG,62.233,8.367,+0621.0
012350,99999,DOMBAS-KIRKENAER,62.083,9.133,+0645.0
012360,99999,KJOREMSGRENDE,62.1,9.05,+0626.0
012390,99999,HJERKINN II,62.217,9.55,+1012.0
012430,99999,SONGLI,63.333,9.65,+0300.0
012520,99999,BERKAK-LYNGHOLT,62.817,10.017,+0475.0
012580,99999,TRONDHEIM (TYHOLT)           ,63.417,10.433,+0113.0
012740,99999,SELBU-STUBBE,63.2,11.117,+0242.0
012771,99999,LEVANGER-EGGEN,63.717,11.233,+0097.0
012780,99999,VERDAL-REPPE,63.783,11.683,+0083.0
012823,99999,RORVIK/RYUM,64.85,11.233,+0014.0
012890,99999,ROROS LUFTHAVN,62.583,11.35,+0626.0
012891,99999,ROROS/AIRPORT,62.583,11.383,+0626.0
012920,99999,MERAKER-UTSYN,63.417,11.7,+0240.0
012950,99999,HOYLANDET,64.55,12.15,+0027.0
012960,99999,BERG I SNASA,64.25,12.417,+0127.0
012980,99999,NORDLI-HOLAND,64.45,13.717,+0433.0
013060,99999,HELLISOY FYR,60.75,4.717,+0023.0
013160,99999,BERGEN-FREDRIKSBERG,60.4,5.317,+0040.0
013180,99999,SANDANE,61.783,6.183,+0051.0
013220,99999,FORDE-TEFRE,61.467,5.917,+0064.0
013250,99999,MODALEN II,60.833,5.95,+0114.0
013280,99999,KVAMSKOGEN,60.4,5.917,+0408.0
013390,99999,VANGSNES,61.167,6.65,+0053.0
013410,99999,EIDFJORD-BU,60.467,6.867,+0166.0
013471,99999,SOGNDAL/HAUKASEN,61.167,7.133,+0498.0
013510,99999,FINSE III,60.6,7.5,+1224.0
013560,99999,FANNARAKI,61.517,7.9,+2062.0
013591,99999,HAUGASTOL,60.517,7.867,+0988.0
013671,99999,BEITOSTOLEN,61.233,8.933,+0828.0
013690,99999,ABJORSBRATEN,60.917,9.283,+0639.0
013720,99999,NESBYEN-SKOGLUND,60.567,9.133,+0167.0
013743,99999,FAGERNES/LEIRIN   &          ,61.0,9.3,+0822.0
013790,99999,SOR-NESSET,61.883,10.15,+0739.0
013801,99999,KITTILBU,61.167,9.967,+0816.0
013839,99999,HAMAR / STAFSBERG,60.817,11.067,+0223.0
013910,99999,FLISA,60.617,12.017,+0188.0
014000,99999,EKOFISK,56.55,3.217,+0048.8
014010,99999,FRIGG,59.983,2.25,+0048.0
014035,99999,KARMOY,59.35,5.217,+0023.0
014110,99999,KVITSOY - NORDBO,59.067,5.417,+0022.0
014120,99999,OBRESTAD,58.65,5.567,+0026.0
014211,99999,INDRE MATRE,59.85,6.0,+0024.0
014280,99999,LISTA,58.099,6.626,+0008.8
014320,99999,SIRDAL-TJORHOM,58.883,6.85,+0500.0
014321,99999,FIDJELAND,58.967,6.933,+0568.0

2025-01-21 06:46:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:46:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:46:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:46:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:46:24 - snowflake.connector.connection - INFO - closed
2025-01-21 06:46:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:46:25 - root - INFO - SQL:
-- Corrected Query 19: Find the average temperature for each station in 2012.
SELECT "stn", AVG("temp") AS "avg_temp_2012"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Results:
stn,avg_temp_2012
154700,53.93907103825137
154100,55.97158469945355
474130,46.3917808219178
022610,34.33526170798899
039560,49.75714285714285
722069,70.53060109289616
722909,64.1774193548387
032300,45.342739726027396
725374,51.90081967213115
020360,27.020273972602737
720361,68.38587257617728
020130,30.474104683195595
022710,33.9
727675,43.05683060109289
043390,23.689890710382514
025630,45.187704918032786
726818,46.87978142076503
725016,55.28919667590027
474210,47.88360655737705
042110,22.78099173553719
702910,21.757650273224044
027900,43.36092896174863
028890,32.98109589041095
039610,49.46393442622951
039760,50.82568306010929
476530,60.97917808219177
064960,45.21983240223464
725420,55.306830601092905
726410,51.84808743169398
727810,52.156010928961756
725347,52.16393442622951
746410,61.29479452054795
722595,69.82554945054945
745046,62.54508196721312
746120,66.8913407821229
724455,55.11256830601092
722487,68.35218579234972
726654,49.26830601092897
727976,50.384153005464476
742060,50.44836065573771
724505,61.34617486338798
029640,42.664931506849314
478980,64.19999999999999
747950,74.15710382513662
722535,70.86120218579235
071660,50.527348066298345
724066,56.42322404371585
725376,54.8464480874317
726546,47.041256830601085
722416,69.4071038251366
023470,39.80027548209367
725499,55.125136612021855
722151,53.731420765027316
726620,50.53688524590165
723035,63.69016393442622
724040,60.477049180327874
724250,57.48224043715847
747900,64.98825136612022
911650,75.49781420765028
479290,73.28876712328767
035350,48.576502732240435
476180,53.640547945205476
080840,57.58196721311475
062100,50.752459016393445
028760,36.446961325966846
723105,64.15737704918034
722269,67.22213114754099
479420,72.00690607734806
477780,62.62978142076503
477840,59.74767123287672
478290,61.26657534246575
123000,48.34617486338798
474280,50.54520547945206
722485,67.51584699453552
725755,53.6983606557377
064280,51.329201101928376
478990,61.5227397260274
723710,62.6035519125683
725070,53.79016393442623
061470,47.80573770491803
725025,56.980054644808746
722541,67.21120218579235
726667,49.47158469945356
039230,47.621857923497274
724463,61.24999999999999
722195,63.84426229508197
722906,65.36311475409835
030940,40.89310344827586
699604,76.36675824175825
027140,34.70445682451254
476200,51.984931506849314
124650,47.64672131147541
476550,61.50464480874316
723927,59.90523415977962
121050,47.154371584699454
724920,61.2655737704918
723676,62.660109289617495
727850,49.21147540983606
031550,45.41639344262295
722180,64.80081967213114

2025-01-21 06:46:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:46:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:46:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:46:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 06:46:26 - snowflake.connector.connection - INFO - closed
2025-01-21 06:46:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:46:27 - root - INFO - SQL:
-- Corrected Query 20: List stations and the total number of valid temperature observations from 2011 to 2020.
SELECT s."usaf", s."wban", s."name", COUNT(*) AS "valid_temp_observations_2011_to_2020"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN (
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020" WHERE "temp" IS NOT NULL
) g
ON s."usaf" = g."stn" AND s."wban" = g."wban"
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100
Results:
usaf,wban,name,valid_temp_observations_2011_to_2020
575160,99999,JIANGBEI,3642
407980,99999,SHAHRE  KORD,3641
724177,13734,ETRN WV RGNL/SHPHERD FD AP,3650
874530,99999,RIO CUARTO AREA DE MATERIAL,3643
070370,99999,VALLEE DE SEINE,3640
722010,12836,KEY WEST INTERNATIONAL AIRPOR,3647
606110,99999,IN AMENAS,3639
846910,99999,PISCO INTL,3642
722316,12958,NEW ORLEANS NAS,3644
787080,99999,LA MESA INTL,3579
723084,99999,HANOVER CO MUNI,2364
725067,94720,BRNSBL MUNI-BMAN/POL FD AP,3653
722279,53852,PRYOR FIELD REGIONAL ARPT,3627
725214,04849,LORAIN COUNTY RGNL AIRPORT,3648
724468,03967,JOHNSON CO EXECUTIVE ARPT,3653
143080,99999,PAZIN,3641
693254,99999,2 CWSS FMQ-22                ,1242
944290,99999,MOUNT MAGNET AERO,3612
475900,99999,SENDAI,3642
011140,99999,REIPA,3604
722720,93026,BISBEE DOUGLAS INTL ARPT,3380
702770,26438,SEWARD AIRPORT,3614
026640,99999,RONNEBY,3643
725290,14768,GREATER ROCHESTER INTERNATION,3653
724388,14829,GOSHEN MUNICIPAL AIRPORT,3643
720377,13917,NEWPORT MUNICIPAL AIRPORT,2062
999999,53848,NAVAL AUXILIARY LANDING FD,2105
941500,99999,GOVE AIRPORT,3638
076610,99999,CAP CEPET,3246
724237,53803,OWENSBORO-DAVIESS COUNTY AIRP,3609
074380,99999,LA ROCHE,3635
723171,53144,NORTH AUXILIARY AIRFIELD EDWA,3399
717490,99999,THUNDER BAY A,3221
711410,99999,GATESHEAD ISLAND,3148
023250,99999,KLOVSJOHOJDEN,3353
027880,99999,KUOPIO MAANINKA,3533
119680,99999,KOSICE,3642
112250,99999,WEITENSFELD,3594
295510,99999,MARIINSK,3640
714540,99999,WASKESIU LAKE  SASK,3635
044850,99999,SADDLE,715
715420,99999,LA CRETE AGCM,3540
647050,99999,BOUSSO,326
803700,99999,SAN LUIS,3466
170240,99999,INEBOLU,3640
106140,99999,RAMSTEIN AB,3646
406890,99999,BASRAH INTL,3559
471010,99999,CHUNCHEON,3640
654420,99999,KUMASI,2619
994066,99999,WHITEFISH POINT GLOS WEATHER,2824
720644,99999,BUCKEYE MUNI,2019
896660,99999,CAPE ROSS,3636
999999,26494,FAIRBANKS 11 NE              ,3553
998235,99999,NIAGRA INTAKE,3359
999999,63849,BOWLING GREEN 21 NNE         ,3567
724768,24051,GREELEY-WELD COUNTY ARPT,3592
803150,99999,BENITO SALAS,3505
720404,99999,KICKAPOO DOWNTOWN AIRPORT,1336
286610,99999,KURGAN,2916
237340,99999,OKTJABR'SKOE,3010
783480,99999,CAIBARIEN  VILLA CLARA,1839
042410,99999,MANIITSOQ MITTARFIA (SUKKERTO,1101
726130,14755,MT. WASHINGTON OBSERVATORY,3504
747360,93042,MUNICIPAL AIRPORT,3650
743945,14710,MANCHESTER AIRPORT,3653
954820,99999,BIRDSVILLE,3633
722900,23188,SAN DIEGO INTERNATIONAL AIRPO,3653
145570,99999,TUZLA,3638
724019,93773,WAKEFIELD MUNICIPAL ARPT,3646
982320,99999,APARRI,3636
747760,03818,MARIANNA MUNICIPAL AIRPORT,3646
747460,03904,EASTERWOOD FIELD AIRPORT,3653
619960,99999,MARTIN DE VIVIES (ILE AMSTERD,2922
727770,94012,HAVRE CITY-COUNTY AIRPORT,3650
718600,99999,SPRINGBANK A,3639
722106,12835,PAGE FIELD AIRPORT,3653
711870,99999,HOPE,2297
024490,99999,ESKILSTUNA A,3342
238910,99999,BAJKIT,3640
442920,99999,CHINGGIS KHAAN INTL,3642
470160,99999,HYESAN,3636
962530,99999,FATMAWATI SOEKARNO,3638
713290,99999,BEDFORD BASIN,3273
710160,99999,BULLHORN HEADWATERS,2957
715570,99999,MERRITT,3472
712290,99999,MANNING AGDM  ALTA,3516
724065,99999,TIPTON,3410
413150,99999,QAIROON HAIRITI,2928
067980,99999,SCUOL,3642
677790,99999,MOUNT DARWIN,1533
173100,99999,ALANYA,3632
727935,24234,BOEING FLD/KING CO INTL AP,3652
172340,99999,AYDIN,3402
722116,12873,ST PETE-CLWTR INTL AIRPORT,3651
036040,99999,MILFORD HAVEN CONSERVANCY BOA,3640
477770,99999,WAKAYAMA,3620
013700,99999,SKABU,3453
021240,99999,ARJEPLOG,3627
170980,99999,KARS,3642
133780,99999,KOPAONIK,3640

2025-01-21 06:46:27 - root - INFO - itercount: 0
2025-01-21 06:46:27 - root - INFO - Database Name: NEW_YORK_NOAA
Schema Name: NEW_YORK
DDL describes table information.
,0
table_name,_311_SERVICE_REQUESTS
description,
DDL,"create or replace TABLE _311_SERVICE_REQUESTS (
	""unique_key"" NUMBER(38,0),
	""created_date"" NUMBER(38,0),
	""closed_date"" NUMBER(38,0),
	""agency"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""complaint_type"" VARCHAR(16777216),
	""descriptor"" VARCHAR(16777216),
	""location_type"" VARCHAR(16777216),
	""incident_zip"" VARCHAR(16777216),
	""incident_address"" VARCHAR(16777216),
	""street_name"" VARCHAR(16777216),
	""cross_street_1"" VARCHAR(16777216),
	""cross_street_2"" VARCHAR(16777216),
	""intersection_street_1"" VARCHAR(16777216),
	""intersection_street_2"" VARCHAR(16777216),
	""address_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""landmark"" VARCHAR(16777216),
	""facility_type"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""due_date"" NUMBER(38,0),
	""resolution_description"" VARCHAR(16777216),
	""resolution_action_updated_date"" NUMBER(38,0),
	""community_board"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""x_coordinate"" NUMBER(38,0),
	""y_coordinate"" NUMBER(38,0),
	""park_facility_name"" VARCHAR(16777216),
	""park_borough"" VARCHAR(16777216),
	""bbl"" NUMBER(38,0),
	""open_data_channel_type"" VARCHAR(16777216),
	""vehicle_type"" VARCHAR(16777216),
	""taxi_company_borough"" VARCHAR(16777216),
	""taxi_pickup_location"" VARCHAR(16777216),
	""bridge_highway_name"" VARCHAR(16777216),
	""bridge_highway_direction"" VARCHAR(16777216),
	""road_ramp"" VARCHAR(16777216),
	""bridge_highway_segment"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""location"" VARCHAR(16777216)
);"

,1
table_name,TLC_YELLOW_TRIPS_2012
description,
DDL,"create or replace TABLE TLC_YELLOW_TRIPS_2012 (
	""vendor_id"" VARCHAR(16777216),
	""pickup_datetime"" NUMBER(38,0),
	""dropoff_datetime"" NUMBER(38,0),
	""passenger_count"" NUMBER(38,0),
	""trip_distance"" FLOAT,
	""pickup_longitude"" FLOAT,
	""pickup_latitude"" FLOAT,
	""rate_code"" NUMBER(38,0),
	""store_and_fwd_flag"" VARCHAR(16777216),
	""dropoff_longitude"" FLOAT,
	""dropoff_latitude"" FLOAT,
	""payment_type"" VARCHAR(16777216),
	""fare_amount"" FLOAT,
	""extra"" FLOAT,
	""mta_tax"" FLOAT,
	""tip_amount"" FLOAT,
	""tolls_amount"" FLOAT,
	""imp_surcharge"" FLOAT,
	""total_amount"" FLOAT
);"

Some other tables have the similar structure: ['TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016']
,2
table_name,CITIBIKE_STATIONS
description,
DDL,"create or replace TABLE CITIBIKE_STATIONS (
	""station_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""region_id"" NUMBER(38,0),
	""rental_methods"" VARCHAR(16777216),
	""capacity"" NUMBER(38,0),
	""eightd_has_key_dispenser"" BOOLEAN,
	""num_bikes_available"" NUMBER(38,0),
	""num_bikes_disabled"" NUMBER(38,0),
	""num_docks_available"" NUMBER(38,0),
	""num_docks_disabled"" NUMBER(38,0),
	""is_installed"" BOOLEAN,
	""is_renting"" BOOLEAN,
	""is_returning"" BOOLEAN,
	""eightd_has_available_keys"" BOOLEAN,
	""last_reported"" NUMBER(38,0)
);"

,3
table_name,TLC_FHV_TRIPS_2015
description,
DDL,"create or replace TABLE TLC_FHV_TRIPS_2015 (
	""location_id"" NUMBER(38,0),
	""pickup_datetime"" NUMBER(38,0),
	""dispatching_base_num"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""zone"" VARCHAR(16777216),
	""service_zone"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016']
,4
table_name,TREE_CENSUS_2005
description,
DDL,"create or replace TABLE TREE_CENSUS_2005 (
	""objectid"" NUMBER(38,0),
	""cen_year"" NUMBER(38,0),
	""tree_dbh"" NUMBER(38,0),
	""tree_loc"" VARCHAR(16777216),
	""pit_type"" VARCHAR(16777216),
	""soil_lvl"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""spc_latin"" VARCHAR(16777216),
	""spc_common"" VARCHAR(16777216),
	""vert_other"" VARCHAR(16777216),
	""vert_pgrd"" VARCHAR(16777216),
	""vert_tgrd"" VARCHAR(16777216),
	""vert_wall"" VARCHAR(16777216),
	""horz_blck"" VARCHAR(16777216),
	""horz_grate"" VARCHAR(16777216),
	""horz_plant"" VARCHAR(16777216),
	""horz_other"" VARCHAR(16777216),
	""sidw_crack"" VARCHAR(16777216),
	""sidw_raise"" VARCHAR(16777216),
	""wire_htap"" VARCHAR(16777216),
	""wire_prime"" VARCHAR(16777216),
	""wire_2nd"" VARCHAR(16777216),
	""wire_other"" VARCHAR(16777216),
	""inf_canopy"" VARCHAR(16777216),
	""inf_guard"" VARCHAR(16777216),
	""inf_wires"" VARCHAR(16777216),
	""inf_paving"" VARCHAR(16777216),
	""inf_outlet"" VARCHAR(16777216),
	""inf_shoes"" VARCHAR(16777216),
	""inf_lights"" VARCHAR(16777216),
	""inf_other"" VARCHAR(16777216),
	""trunk_dmg"" VARCHAR(16777216),
	""zipcode"" NUMBER(38,0),
	""zip_city"" VARCHAR(16777216),
	""cb_num"" NUMBER(38,0),
	""borocode"" NUMBER(38,0),
	""boroname"" VARCHAR(16777216),
	""cncldist"" NUMBER(38,0),
	""st_assem"" NUMBER(38,0),
	""st_senate"" NUMBER(38,0),
	""nta"" VARCHAR(16777216),
	""nta_name"" VARCHAR(16777216),
	""boro_ct"" NUMBER(38,0),
	""x_sp"" NUMBER(38,0),
	""y_sp"" NUMBER(38,0),
	""objectid_1"" NUMBER(38,0),
	""location_1"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['TREE_CENSUS_2005', 'TREE_CENSUS_1995', 'TREE_CENSUS_2015']
,5
table_name,TREE_SPECIES
description,
DDL,"create or replace TABLE TREE_SPECIES (
	""species_scientific_name"" VARCHAR(16777216),
	""species_common_name"" VARCHAR(16777216),
	""form"" VARCHAR(16777216),
	""growth_rate"" VARCHAR(16777216),
	""fall_color"" VARCHAR(16777216),
	""environmental_tolerances"" VARCHAR(16777216),
	""location_tolerances"" VARCHAR(16777216),
	""notes_suggested_cultivars"" VARCHAR(16777216),
	""tree_size"" VARCHAR(16777216),
	""comments"" VARCHAR(16777216)
);"

,6
table_name,TLC_GREEN_TRIPS_2013
description,
DDL,"create or replace TABLE TLC_GREEN_TRIPS_2013 (
	""vendor_id"" VARCHAR(16777216),
	""pickup_datetime"" NUMBER(38,0),
	""dropoff_datetime"" NUMBER(38,0),
	""store_and_fwd_flag"" VARCHAR(16777216),
	""rate_code"" NUMBER(38,0),
	""pickup_longitude"" FLOAT,
	""pickup_latitude"" FLOAT,
	""dropoff_longitude"" FLOAT,
	""dropoff_latitude"" FLOAT,
	""passenger_count"" NUMBER(38,0),
	""trip_distance"" FLOAT,
	""fare_amount"" FLOAT,
	""extra"" FLOAT,
	""mta_tax"" FLOAT,
	""tip_amount"" FLOAT,
	""tolls_amount"" FLOAT,
	""ehail_fee"" FLOAT,
	""total_amount"" FLOAT,
	""payment_type"" NUMBER(38,0),
	""distance_between_service"" FLOAT,
	""time_between_service"" NUMBER(38,0),
	""trip_type"" NUMBER(38,0),
	""imp_surcharge"" FLOAT
);"

Some other tables have the similar structure: ['TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2016', 'TLC_GREEN_TRIPS_2015']
,7
table_name,CITIBIKE_TRIPS
description,
DDL,"create or replace TABLE CITIBIKE_TRIPS (
	""tripduration"" NUMBER(38,0),
	""starttime"" NUMBER(38,0),
	""stoptime"" NUMBER(38,0),
	""start_station_id"" NUMBER(38,0),
	""start_station_name"" VARCHAR(16777216),
	""start_station_latitude"" FLOAT,
	""start_station_longitude"" FLOAT,
	""end_station_id"" NUMBER(38,0),
	""end_station_name"" VARCHAR(16777216),
	""end_station_latitude"" FLOAT,
	""end_station_longitude"" FLOAT,
	""bikeid"" NUMBER(38,0),
	""usertype"" VARCHAR(16777216),
	""birth_year"" NUMBER(38,0),
	""gender"" VARCHAR(16777216)
);"

,8
table_name,NYPD_MV_COLLISIONS
description,
DDL,"create or replace TABLE NYPD_MV_COLLISIONS (
	""borough"" VARCHAR(16777216),
	""contributing_factor_vehicle_1"" VARCHAR(16777216),
	""contributing_factor_vehicle_2"" VARCHAR(16777216),
	""contributing_factor_vehicle_3"" VARCHAR(16777216),
	""contributing_factor_vehicle_4"" VARCHAR(16777216),
	""contributing_factor_vehicle_5"" VARCHAR(16777216),
	""cross_street_name"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""location"" VARCHAR(16777216),
	""number_of_cyclist_injured"" NUMBER(38,0),
	""number_of_cyclist_killed"" NUMBER(38,0),
	""number_of_motorist_injured"" NUMBER(38,0),
	""number_of_motorist_killed"" NUMBER(38,0),
	""number_of_pedestrians_injured"" NUMBER(38,0),
	""number_of_pedestrians_killed"" NUMBER(38,0),
	""number_of_persons_injured"" NUMBER(38,0),
	""number_of_persons_killed"" NUMBER(38,0),
	""off_street_name"" VARCHAR(16777216),
	""on_street_name"" VARCHAR(16777216),
	""unique_key"" NUMBER(38,0),
	""vehicle_type_code1"" VARCHAR(16777216),
	""vehicle_type_code2"" VARCHAR(16777216),
	""vehicle_type_code_3"" VARCHAR(16777216),
	""vehicle_type_code_4"" VARCHAR(16777216),
	""vehicle_type_code_5"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0)
);"

Database Name: NEW_YORK_NOAA
Schema Name: NOAA_GSOD
DDL describes table information.
,0
table_name,GSOD1935
description,
DDL,"create or replace TABLE GSOD1935 (
	""stn"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""mo"" VARCHAR(16777216),
	""da"" VARCHAR(16777216),
	""temp"" FLOAT,
	""count_temp"" NUMBER(38,0),
	""dewp"" FLOAT,
	""count_dewp"" NUMBER(38,0),
	""slp"" FLOAT,
	""count_slp"" NUMBER(38,0),
	""stp"" FLOAT,
	""count_stp"" NUMBER(38,0),
	""visib"" FLOAT,
	""count_visib"" NUMBER(38,0),
	""wdsp"" VARCHAR(16777216),
	""count_wdsp"" VARCHAR(16777216),
	""mxpsd"" VARCHAR(16777216),
	""gust"" FLOAT,
	""max"" FLOAT,
	""flag_max"" VARCHAR(16777216),
	""min"" FLOAT,
	""flag_min"" VARCHAR(16777216),
	""prcp"" FLOAT,
	""flag_prcp"" VARCHAR(16777216),
	""sndp"" FLOAT,
	""fog"" VARCHAR(16777216),
	""rain_drizzle"" VARCHAR(16777216),
	""snow_ice_pellets"" VARCHAR(16777216),
	""hail"" VARCHAR(16777216),
	""thunder"" VARCHAR(16777216),
	""tornado_funnel_cloud"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['GSOD1935', 'GSOD1946', 'GSOD1951', 'GSOD1961', 'GSOD1964', 'GSOD1970', 'GSOD1976', 'GSOD1977', 'GSOD2008', 'GSOD1962', 'GSOD1965', 'GSOD1978', 'GSOD1983', 'GSOD1985', 'GSOD1992', 'GSOD2000', 'GSOD2019', 'GSOD2021', 'GSOD1967', 'GSOD1975', 'GSOD1986', 'GSOD1997', 'GSOD1996', 'GSOD1960', 'GSOD1930', 'GSOD1936', 'GSOD1939', 'GSOD1940', 'GSOD1948', 'GSOD1953', 'GSOD1959', 'GSOD1968', 'GSOD1973', 'GSOD2013', 'GSOD2023', 'GSOD1982', 'GSOD2001', 'GSOD2006', 'GSOD2010', 'GSOD2011', 'GSOD2024', 'GSOD1981', 'GSOD1991', 'GSOD2015', 'GSOD1931', 'GSOD1934', 'GSOD1937', 'GSOD1938', 'GSOD1942', 'GSOD1944', 'GSOD1947', 'GSOD1949', 'GSOD1955', 'GSOD1958', 'GSOD1980', 'GSOD1994', 'GSOD2004', 'GSOD2007', 'GSOD1941', 'GSOD1952', 'GSOD1969', 'GSOD1999', 'GSOD2012', 'GSOD2020', 'GSOD1987', 'GSOD1988', 'GSOD2005', 'GSOD2022', 'GSOD1972', 'GSOD1929', 'GSOD1932', 'GSOD1933', 'GSOD1943', 'GSOD1945', 'GSOD1950', 'GSOD1956', 'GSOD1957', 'GSOD1966', 'GSOD2003', 'GSOD2014', 'GSOD2016', 'GSOD1954', 'GSOD1963', 'GSOD1971', 'GSOD1974', 'GSOD1979', 'GSOD1990', 'GSOD1993', 'GSOD2009', 'GSOD2017', 'GSOD2018', 'GSOD1984', 'GSOD1995', 'GSOD1989', 'GSOD1998', 'GSOD2002']
,1
table_name,STATIONS
description,
DDL,"create or replace TABLE STATIONS (
	""usaf"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""call"" VARCHAR(16777216),
	""lat"" FLOAT,
	""lon"" FLOAT,
	""elev"" VARCHAR(16777216),
	""begin"" VARCHAR(16777216),
	""end"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
Categories: Geospatial functions


## ST_DWITHIN

Returns TRUE if the minimum geodesic distance between two points (two GEOGRAPHY objects) is within the specified distance. Otherwise, returns FALSE.
If the parameters are GEOGRAPHY values that are not points (e.g. lines or polygons), this returns TRUE or FALSE based on the minimum geodesic distance between the two closest points of the two values.

Tip You can use the search optimization service to improve the performance of queries that call this function.
For details, see Search Optimization Service.

## Syntax

ST_DWITHIN( <geography_expression_1> , <geography_expression_2> , <distance_in_meters> )


## Arguments


geography_expression_1The argument must be an expression of type GEOGRAPHY.

geography_expression_2The argument must be an expression of type GEOGRAPHY.

distance_in_metersThe argument must be an expression of type REAL. The distance is in meters.


## Returns

Returns a BOOLEAN.

## Usage notes


Returns NULL if any input is NULL.


## Examples

This returns TRUE because the distance in meters between two points 1 degree apart along the equator is less than 150,000 meters:

SELECT ST_DWITHIN (ST_MAKEPOINT(0, 0), ST_MAKEPOINT(1, 0), 150000);
+-------------------------------------------------------------+
| ST_DWITHIN (ST_MAKEPOINT(0, 0), ST_MAKEPOINT(1, 0), 150000) |
|-------------------------------------------------------------|
| True                                                        |
+-------------------------------------------------------------+
The table structure information is ({database name: {schema name: {table name}}}): 
{'NEW_YORK_NOAA': {'NEW_YORK': ['CITIBIKE_STATIONS', 'CITIBIKE_TRIPS', 'NYPD_MV_COLLISIONS', 'TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016', 'TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2015', 'TLC_GREEN_TRIPS_2016', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016', 'TREE_CENSUS_1995', 'TREE_CENSUS_2005', 'TREE_CENSUS_2015', 'TREE_SPECIES', '_311_SERVICE_REQUESTS'], 'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS']}}
Begin Exploring Related Columns
Sure! Let's first consider which tables and columns are relevant to the task and their potential usage:

### Relevant Tables and Columns:

1. **Table:** `NEW_YORK_NOAA.NOAA_GSOD.STATIONS`
   - **"usaf"**: Station identifier (could be used to join with GSOD data)
   - **"wban"**: Additional station identifier
   - **"name"**: Station name
   - **"lat"**: Latitude of the station (used to calculate distance)
   - **"lon"**: Longitude of the station (used to calculate distance)
   - **"state"**: State where the station is located (could filter for NY)
   - **Potential Usage:** Identify stations within a 20-mile radius of Chappaqua by calculating the geodesic distance using latitude and longitude.

2. **Tables:** `NEW_YORK_NOAA.NOAA_GSOD.GSOD2011` to `NEW_YORK_NOAA.NOAA_GSOD.GSOD2020`
   - **"stn"**: Station identifier (to join with the `STATIONS` table)
   - **"year"**: Year of observation (filter between 2011 and 2020)
   - **"temp"**: Temperature observation (check for valid (non-null) entries)
   - **"count_temp"**: Number of temperature observations contributing to the mean (could sum up for total observations)
   - **Potential Usage:** Count the number of valid temperature observations recorded by each station from 2011 to 2020.

### Conditions that may be used:

- Use `ST_DWITHIN` function to find stations within 20 miles (32,186.8 meters) of Chappaqua.
- Filter `temp` where it is not null to ensure valid observations.
- Filter data for years between 2011 and 2020 inclusive.

### SQL Queries:

Here are 10 SQL queries to explore the data:

```sql
-- Query 1: View the first 100 rows of the STATIONS table.
SELECT * 
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
LIMIT 100;

-- Query 2: Select station IDs, names, and locations from the STATIONS table.
SELECT "usaf", "wban", "name", "lat", "lon", "state"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
LIMIT 100;

-- Query 3: Find all stations located in New York state.
SELECT "usaf", "wban", "name", "state"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "state" = 'NY'
LIMIT 100;

-- Query 4: List stations with non-null latitude and longitude.
SELECT "usaf", "wban", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
LIMIT 100;

-- Query 5: Create geography points for each station.
SELECT "usaf", "wban", "name", ST_MAKEPOINT("lon", "lat") AS "geom"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
LIMIT 100;

-- Query 6: Find stations within a 20-mile radius of Chappaqua, NY.
SELECT "usaf", "wban", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE ST_DWITHIN(
    ST_MAKEPOINT("lon", "lat"),
    ST_MAKEPOINT(-73.764, 41.197),
    32186.8
)
LIMIT 100;

-- Query 7: View temperature observations from GSOD2011.
SELECT "stn", "wban", "year", "mo", "da", "temp", "count_temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100;

-- Query 8: Count the number of valid temperature observations per station in 2011.
SELECT "stn", COUNT(*) AS "valid_temp_observations_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100;

-- Query 9: Sum the total number of temperature measurements contributing to the mean per station in 2011.
SELECT "stn", SUM("count_temp") AS "total_temp_measurements_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
GROUP BY "stn"
LIMIT 100;

-- Query 10: Find stations within 20 miles of Chappaqua and list their temperature observations in 2011.
SELECT s."usaf", s."wban", s."name", g."year", g."mo", g."da", g."temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" g
  ON s."usaf" = g."stn"
WHERE ST_DWITHIN(
    ST_MAKEPOINT(s."lon", s."lat"),
    ST_MAKEPOINT(-73.764, 41.197),
    32186.8
)
LIMIT 100;

-- Query 11: Find the distinct years available in the GSOD tables (from 2011 to 2020).
SELECT DISTINCT "year"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100;

-- Query 12: List distinct station IDs from GSOD2011.
SELECT DISTINCT "stn"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100;

-- Query 13: Count valid temperature observations for each station between 2011 and 2020 (example year 2011).
SELECT "stn", COUNT(*) AS "valid_temp_observations"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100;

-- Query 14: List stations with their earliest and latest observation dates.
SELECT "stn", MIN(DATE_FROM_PARTS("year", "mo", "da")) AS "first_observation", MAX(DATE_FROM_PARTS("year", "mo", "da")) AS "last_observation"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
GROUP BY "stn"
LIMIT 100;

-- Query 15: Find stations within 20 miles of Chappaqua and their total valid temperature observations in 2015.
SELECT s."usaf", s."wban", s."name", COUNT(*) AS "valid_temp_observations_2015"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" g
  ON s."usaf" = g."stn"
WHERE ST_DWITHIN(
    ST_MAKEPOINT(s."lon", s."lat"),
    ST_MAKEPOINT(-73.764, 41.197),
    32186.8
) AND g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100;

-- Query 16: Aggregate temperature observations from multiple years for a specific station (e.g., station '123456').
SELECT "year", COUNT(*) AS "valid_temp_observations"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '123456' AND "temp" IS NOT NULL
GROUP BY "year"
LIMIT 100;

-- Query 17: Find the maximum and minimum temperatures recorded by stations within 20 miles of Chappaqua in 2020.
SELECT s."usaf", s."wban", s."name", MAX(g."temp") AS "max_temp_2020", MIN(g."temp") AS "min_temp_2020"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020" g
  ON s."usaf" = g."stn"
WHERE ST_DWITHIN(
    ST_MAKEPOINT(s."lon", s."lat"),
    ST_MAKEPOINT(-73.764, 41.197),
    32186.8
) AND g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100;

-- Query 18: Retrieve station information along with elevation data.
SELECT "usaf", "wban", "name", "lat", "lon", "elev"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "elev" IS NOT NULL
LIMIT 100;

-- Query 19: Find the average temperature for each station in 2012.
SELECT "stn", AVG("temp") AS "avg_temp_2012"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100;

-- Query 20: List stations and the total number of valid temperature observations from 2011 to 2020 (example for year 2011).
SELECT s."usaf", s."wban", s."name", COUNT(*) AS "valid_temp_observations_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" g
  ON s."usaf" = g."stn"
WHERE g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100;
```

These queries progressively explore the data, starting from simple selection and filtering, to more complex joins and aggregations relevant to the task.Query:
-- Query 1: View the first 100 rows of the STATIONS table.
SELECT * 
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
LIMIT 100
Answer:
Too long, hard cut:
usaf,wban,name,country,state,call,lat,lon,elev,begin,end
007018,99999,WXPOD 7018                   ,,,,0.0,0.0,+7018.0,20110309,20130730
007026,99999,WXPOD 7026                   ,AF,,,0.0,0.0,+7026.0,20120713,20170822
007070,99999,WXPOD 7070                   ,AF,,,0.0,0.0,+7070.0,20140923,20150926
008268,99999,WXPOD8278                    ,AF,,,32.95,65.567,+1156.7,20100519,20120323
008307,99999,WXPOD 8318                   ,AF,,,0.0,0.0,+8318.0,20100421,20100421
010016,99999,RORVIK/RYUM,NO,,,64.85,11.233,+0014.0,19870116,19910806
010017,99999,FRIGG,NO,,ENFR,59.98,2.25,+0048.0,19880320,20050228
010071,99999,LONGYEARBYEN,SV,,,78.217,15.583,+0037.0,20050210,20050210
010190,99999,SVARTTANGEN,NO,,,77.517,20.817,+0020.0,20100825,20140523
010240,99999,PYRAMIDEN,NO,,,78.65,16.367,+0020.0,19730101,20210918
010303,99999,TROMSO/SKATTURA,NO,,,69.7,19.017,+0014.0,20140522,20150108
010320,99999,OVERBYGD,NO,,,69.017,19.283,+0078.0,19730101,20140523
010340,99999,FUGLOYKALVEN FYR,NO,,,70.317,20.15,+0038.0,19871202,20140523
010470,99999,KAUTOKEINO II,NO,,ENKA,69.017,23.067,+0307.0,19730101,20210917
010510,99999,SUOLOVUOPMI,NO,,,69.583,23.533,+0374.0,19730102,20140523
010530,99999,HAMMERFEST RADIO,NO,,,70.683,23.683,+0070.0,19730101,19871226
010610,99999,BRENNELV,NO,,,70.067,25.117,+0034.0,19730101,19840707
010660,99999,HELNES FYR,NO,,,71.067,26.233,+0033.0,19730101,20040619
010670,99999,LEVAJOK-EVJEN,NO,,,69.9,26.417,+0112.0,19730103,19820924
010671,99999,LEVAJOK-EVJEN,NO,,,69.9,26.417,+0112.0,20070307,20070307
010750,99999,RUSTEFJELBMA,NO,,,70.4,28.2,+0011.2,19730101,20130531
010884,99999,GEITERYGGEN,NO,,ENSN,59.185,9.567,+0141.1,20050103,20151109
011030,99999,LEKA,NO,,,65.1,11.7,+0047.0,19730101,20070307
011051,99999,SKOMVAER (LGT-H)             ,NO,,,67.417,11.883,+0018.0,20070307,20070307
011100,99999,YTTERHOLMEN FYR,NO,,,66.0,11.683,+0033.0,19961201,20050319
011130,99999,GLOMFJORD,NO,,,66.8,13.983,+0039.0,20040406,20091216
011133,99999,DAGALI,NO,,ENDI,60.417,8.513,+0798.0,19860509,20030427
011310,99999,GLAPEN LIGHTHOUSE,NO,,,67.883,13.05,+0031.0,19730101,19850625
011340,99999,MAJAVATN III,NO,,,65.183,13.417,+0339.0,19730101,20070630
011380,99999,TENNHOLMEN (LGT-H)           ,NO,,,67.3,13.5,+0014.0,19850912,20070307
011490,99999,RANA-BASMOEN,NO,,,66.333,14.1,+0042.0,19730101,20070228
011501,99999,HATTFJELLDAL-KRUTA,NO,,,65.683,14.167,+0385.0,20020312,20020312
011530,99999,BODO-VAGONES,NO,,,67.283,14.45,+0033.0,20111003,20140611
011540,99999,LITLOY FYR,NO,,,68.583,14.3,+0030.0,19940406,20170801
011560,99999,BO I VESTERALEN,NO,,,68.6,14.433,+0007.6,20040510,20210913
011630,99999,BOLNA,NO,,,66.5,15.25,+0549.0,19730101,19770823
011680,99999,KLEIVA I SORTLAND,NO,,,68.65,15.283,+0023.0,19730101,20060611
011691,99999,OVRE SALTDAL,NO,,,66.967,15.317,+0026.0,19730101,19781008
011700,99999,FAUSKE-VETEN,NO,,,67.233,15.317,+0165.0,19730101,19900307
011720,99999,FINNOY I HAMAROY,NO,,,68.0,15.617,+0053.0,19730101,20060311
011760,99999,KONGSVIK,NO,,,68.567,16.267,+0025.0,19730101,19780118
011840,99999,SANDSOY I SENJA,NO,,,68.933,16.683,+0045.0,19730101,19780613
011841,99999,SANDSOY,NO,,,68.933,16.683,+0045.0,20070307,20070307
011890,99999,LILAND,NO,,,68.483,16.883,+0019.0,19730102,20050302
011930,99999,NARVIK III/FRAMNES,NO,,ENNK,68.467,17.5,+0023.0,20010706,20170403
011960,99999,TENNEVOLL,NO,,,68.75,17.817,+0021.0,19730101,20020808
011980,99999,DIVIDALEN II,NO,,,68.783,19.7,+0204.0,20100114,20210918
012070,99999,FISKABYGD,NO,,,62.1,5.583,+0041.0,20040510,20180630
012091,99999,ORSTA-VOLDA/HOVD,NO,,ENOV,62.183,6.05,+0074.0,19840910,19841127
012150,99999,HJELVIK MYRBO,NO,,,62.62,7.23,+0035.0,19730101,20090630
012160,99999,HJELVIK I ROMSDAL,NO,,,62.617,7.217,+0016.0,19731226,20020527
012161,99999,GJERMUNDNES,NO,,,62.617,7.167,+0049.0,20040412,20040412
012210,99999,TAGDALEN,NO,,,63.05,9.083,+0415.0,20080115,20210909
012273,99999,TINGVOLL-HANEM,NO,,,62.833,8.3,+0069.0,20050101,20150108
012310,99999,LESJASKOG,NO,,,62.233,8.367,+0621.0,19771030,20080731
012350,99999,DOMBAS-KIRKENAER,NO,,,62.083,9.133,+0645.0,19360101,19760602
012360,99999,KJOREMSGRENDE,NO,,,62.1,9.05,+0626.0,20050218,20100104
012390,99999,HJERKINN II,NO,,,62.217,9.55,+1012.0,20100907,20210906
012430,99999,SONGLI,NO,,,63.333,9.65,+0300.0,19730101,19761119
012520,99999,BERKAK-LYNGHOLT,NO,,,62.817,10.017,+0475.0,19730101,20080930
012580,99999,TRONDHEIM (TYHOLT)           ,NO,,,63.417,10.433,+0113.0,19730101,19810714
012740,99999,SELBU-STUBBE,NO,,,63.2,11.117,+0242.0,19730101,20061115
012771,99999,LEVANGER-EGGEN,NO,,,63.717,11.233,+0097.0,19730101,19730216
012780,99999,VERDAL-REPPE,NO,,,63.783,11.683,+0083.0,19850102,20181031
012823,99999,RORVIK/RYUM,NO,,,64.85,11.233,+0014.0,19910827,19950831
012890,99999,ROROS LUFTHAVN,NO,,ENRO,62.583,11.35,+0626.0,19840909,20041230
012891,99999,ROROS/AIRPORT,NO,,ENRO,62.583,11.383,+0626.0,19790301,19840817
012920,99999,MERAKER-UTSYN,NO,,,63.417,11.7,+0240.0,19730101,20040930
012950,99999,HOYLANDET,NO,,,64.55,12.15,+0027.0,19730101,20070612

Query:
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(g."temp") AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "temp"
        FROM
            (
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0
    AND ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat";
Answer:
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
725086,DANBURY MUNI ARPT,-73.482,41.372,3649
997186,WESTERN LONG ISLAND SOUND,-73.58,40.96,1532
725037,WESTCHESTER COUNTY AIRPORT,-73.705,41.062,3653
999999,BEAR MOUNTAIN WB,-74.0,41.317,1123769
725086,DANBURY MUNICIPAL AIRPORT,-73.483,41.371,3649
999999,WHITE PLAINS WESTCHESTER CO A,-73.708,41.067,1123769
Query:
-- Corrected Query 3: Find all stations located in New York state using latitude and longitude boundaries.
SELECT "usaf", "wban", "name", "state", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE
    "country" = 'US' AND
    "lat" BETWEEN 40.5 AND 45.0 AND
    "lon" BETWEEN -79.8 AND -71.8
LIMIT 100
Answer:
Too long, hard cut:
usaf,wban,name,state,lat,lon
724104,99999,SOMERSET ARPT ASOS,NJ,40.633,-74.667
725010,99999,UPTON,NY,40.85,-72.85
725033,94728,NYC CENTRAL PARK,NY,40.779,-73.969
725034,99999,CALVERTON/GRUMMAN,NY,40.917,-72.783
725035,04781,LONG ISLAND MAC ART,NY,40.794,-73.102
725060,94728,NEW YORK CENTRAL PARK,NY,40.779,-73.969
725095,94746,WORCESTER RGNL,MA,42.271,-71.873
725120,14761,PHILIPSBURG AIRPORT,PA,40.9,-78.083
725120,99999,PHILIPSBURG AIRPORT,PA,40.867,-78.067
725121,14761,BURLIGTON/COLCHE,VT,40.9,-78.083
725135,14754,TOBYHANNA,PA,41.183,-75.417
725160,99999,BENNINGTON STATE,VT,42.883,-73.25
725171,99999,ALLENTOWN QUEEN CITY MUNI,PA,40.567,-75.483
725184,99999,ALBANY (NEXRAD)              ,NY,44.517,-73.167
725185,14750,FLOYD BENNETT MEM,NY,43.35,-73.617
725187,94733,CLINTON COUNTY AIRPORT,NY,44.687,-73.523
725188,99999,CAPE VINCENT MARINE AVIATION,,44.12,-76.33
725195,99999,OSWEGO COAST GUARD STATION,NY,43.47,-76.52
725196,14717,GRIFFISS AIRPARK,NY,43.234,-75.407
725197,94794,ONEIDA COUNTY AIRPORT,NY,43.145,-75.384
725198,99999,MILLBROOK/SKY ACRES,NY,41.7,-73.733
725230,94704,DANSVILLE/MUNICIPAL,NY,42.571,-77.713
725230,99999,DANSVILLE MUNICIPAL,NY,42.567,-77.717
725283,99999,CATTARAUGUS CO OLEAN,NY,42.241,-78.371
725285,99999,BUFFALO COAST GUARD STATION,NY,42.88,-78.88
725288,99999,NIAGARA COAST GUARD STATION,NY,43.27,-79.07
725295,99999,ROCHESTER COAST GUARD LIGHT S,,43.25,-77.6
726111,94765,LEBANON MUNICIPAL AP,NH,43.626,-72.305
726120,99999,NEWPORT,VT,44.93,-72.2
726221,94725,MASSENA AP,NY,44.936,-74.846
726225,04742,PLATTSBURGH INTL,NY,44.651,-73.468
744830,99999,WILMINGTON  VT.              ,,42.883,-72.883
744840,99999,WEST DOVER  VT.              ,,42.933,-72.867
744916,99999,PITTSFIELD MUNI,MA,42.433,-73.3
744976,99999,NTPD AIR OPS HELIPORT,NY,40.6,-73.9
749105,99999,MITCHEL FIELD,NY,40.733,-73.6
994320,99999,GALLOO ISLAND  NY,,43.89,-76.45
997190,99999,LAKE ONTARIO BUOY - 20NM NORT,,43.62,-77.41
998168,99999,NIAGARA CG STATION,NY,43.267,-79.067
998436,99999,BARCELONA HARBOR,NY,42.346,-79.596
999999,04727,GENEVA SAMPSON AFB,NY,42.75,-76.9
999999,04741,SCHENECTADY,NY,42.85,-73.95
999999,04782,SCHENECTADY,NY,42.833,-73.917
999999,14708,HEMPSTEAD MITCHELL FLD AFB,NY,40.733,-73.6
999999,14738,BINGHAMTON TRI-CITIES ARPT,NY,42.083,-76.1
999999,14741,BROOKVILLE FAA AP,PA,41.15,-79.1
999999,14743,CANTON 4 SE                  ,NY,44.583,-75.117
999999,14746,CURWENSVILLE,PA,41.05,-78.583
999999,14747,DUNKIRK CHAUTAUQUA CO AP,NY,42.493,-79.272
999999,14748,ELMIRA AIRPORT,NY,42.159,-76.892
999999,14749,FORT PLAIN WB AP,NY,42.967,-74.667
999999,14750,GLENS FALLS AP,NY,43.35,-73.617
999999,14752,HARTFORD BRAINARD FD,CT,41.736,-72.651
999999,14754,TOBYHANNA,PA,41.183,-75.417
999999,14757,POUGHKEEPSIE DUTCHESS CO AP,NY,41.627,-73.884
999999,14760,PARK PLACE 1 NW WB           ,PA,40.85,-76.117
999999,14770,SELINSGROVE PENN VALLEY AP,PA,40.821,-76.864
999999,14772,TICONDEROGA 3 NE             ,NY,43.883,-73.4
999999,14774,UTICA CAA AP,NY,43.167,-75.317
999999,14775,WESTFIELD BARNES MUNI AP,MA,42.158,-72.716
999999,14776,LEBANON MUNICIPAL,NH,43.626,-72.305
999999,14786,NEW YORK FLOYD BENNE,NY,40.583,-73.883
999999,14797,BEAR MOUNTAIN WB,NY,41.317,-74.0
999999,94704,DANSVILLE MUNI AP,NY,42.571,-77.713
999999,94705,MONTPELIER AP,VT,44.204,-72.562
999999,94728,NEW YORK CENTRAL PARK,NY,40.779,-73.969
999999,94741,TETERBORO AIRPORT,NJ,40.85,-74.061
999999,94765,LEBANON AWO,NH,43.626,-72.305
999999,94772,NEW HAVEN,CT,41.3,-72.933
999999,94790,WATERTOWN AP,NY,43.992,-76.022
999999,94794,UTICA ONEIDA COUNTY AP,NY,43.145,-75.384
725264,99999,SAINT MARYS MUNI,PA,41.433,-78.583
994960,99999,PORT JEFFERSON  NY,,40.95,-73.07
997186,99999,WESTERN LONG ISLAND SOUND,,40.96,-73.58
725039,99999,EATONS NECK COAST GUARD STATI,NY,40.95,-73.4
744975,99999,SHORT BEACH COAST GUARD STATI,NY,40.58,-73.55
725089,99999,NEW HAVEN COAST GUARD STATION,CT,41.27,-72.9
998267,99999,ROCHESTER,NY,43.267,-77.617
999999,14707,GROTON AAF,CT,41.328,-72.049
999999,14758,NEW HAVEN TWEED AIRPORT,CT,41.264,-72.887
725028,99999,BAY SHORE / FIRE ISLAND,NY,40.63,-73.27
725049,99999,LITTLE GULF ISLAND LIGHT STAT,CT,41.2,-72.1
720581,99999,LINDEN,NJ,40.617,-74.245
999999,00178,LINDEN AIRPORT,NJ,40.617,-74.25
725026,99999,BRONX / EXECUTION COAST GUARD,,40.88,-73.73
725047,99999,NEW LONDON LEDGE COAST GUARD,CT,41.3,-72.08
744859,99999,FREEPORT,NY,40.65,-73.583
997272,99999,BERGEN POINT,NY,40.639,-74.146
725048,99999,FAULKNER ISLAND COAST GUARD L,CT,41.22,-72.67
749108,99999,ELIZABETH AAF,NY,41.267,-72.017
999999,04725,BINGHAMTON BROOME COUNTY ARPT,NY,42.207,-75.98
999999,04751,BRADFORD REGIONAL AP,PA,41.8,-78.633
999999,14732,NEW YORK LAGUARDIA ARPT,NY,40.779,-73.88
999999,14733,BUFFALO BUFFALO ARPT,NY,42.941,-78.736
999999,14734,NEWARK INTERNATIONAL ARPT,NJ,40.683,-74.169
999999,14735,ALBANY COUNTY AP,NY,42.743,-73.809
999999,14737,ALLENTOWN BETHLEHEM-EASTON AR,PA,40.651,-75.449
999999,14740,HARTFORD BRADLEY INTL AP,CT,41.938,-72.683
999999,14742,BURLNGTN ETAN ALN AP,V
Query:
-- Corrected Query 4: List stations with non-null and non-zero latitude and longitude.
SELECT "usaf", "wban", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL AND "lat" != 0 AND "lon" != 0
LIMIT 100
Answer:
usaf,wban,name,lat,lon
008268,99999,WXPOD8278                    ,32.95,65.567
010016,99999,RORVIK/RYUM,64.85,11.233
010017,99999,FRIGG,59.98,2.25
010071,99999,LONGYEARBYEN,78.217,15.583
010190,99999,SVARTTANGEN,77.517,20.817
010240,99999,PYRAMIDEN,78.65,16.367
010303,99999,TROMSO/SKATTURA,69.7,19.017
010320,99999,OVERBYGD,69.017,19.283
010340,99999,FUGLOYKALVEN FYR,70.317,20.15
010470,99999,KAUTOKEINO II,69.017,23.067
010510,99999,SUOLOVUOPMI,69.583,23.533
010530,99999,HAMMERFEST RADIO,70.683,23.683
010610,99999,BRENNELV,70.067,25.117
010660,99999,HELNES FYR,71.067,26.233
010670,99999,LEVAJOK-EVJEN,69.9,26.417
010671,99999,LEVAJOK-EVJEN,69.9,26.417
010750,99999,RUSTEFJELBMA,70.4,28.2
010884,99999,GEITERYGGEN,59.185,9.567
011030,99999,LEKA,65.1,11.7
011051,99999,SKOMVAER (LGT-H)             ,67.417,11.883
011100,99999,YTTERHOLMEN FYR,66.0,11.683
011130,99999,GLOMFJORD,66.8,13.983
011133,99999,DAGALI,60.417,8.513
011310,99999,GLAPEN LIGHTHOUSE,67.883,13.05
011340,99999,MAJAVATN III,65.183,13.417
011380,99999,TENNHOLMEN (LGT-H)           ,67.3,13.5
011490,99999,RANA-BASMOEN,66.333,14.1
011501,99999,HATTFJELLDAL-KRUTA,65.683,14.167
011530,99999,BODO-VAGONES,67.283,14.45
011540,99999,LITLOY FYR,68.583,14.3
011560,99999,BO I VESTERALEN,68.6,14.433
011630,99999,BOLNA,66.5,15.25
011680,99999,KLEIVA I SORTLAND,68.65,15.283
011691,99999,OVRE SALTDAL,66.967,15.317
011700,99999,FAUSKE-VETEN,67.233,15.317
011720,99999,FINNOY I HAMAROY,68.0,15.617
011760,99999,KONGSVIK,68.567,16.267
011840,99999,SANDSOY I SENJA,68.933,16.683
011841,99999,SANDSOY,68.933,16.683
011890,99999,LILAND,68.483,16.883
011930,99999,NARVIK III/FRAMNES,68.467,17.5
011960,99999,TENNEVOLL,68.75,17.817
011980,99999,DIVIDALEN II,68.783,19.7
012070,99999,FISKABYGD,62.1,5.583
012091,99999,ORSTA-VOLDA/HOVD,62.183,6.05
012150,99999,HJELVIK MYRBO,62.62,7.23
012160,99999,HJELVIK I ROMSDAL,62.617,7.217
012161,99999,GJERMUNDNES,62.617,7.167
012210,99999,TAGDALEN,63.05,9.083
012273,99999,TINGVOLL-HANEM,62.833,8.3
012310,99999,LESJASKOG,62.233,8.367
012350,99999,DOMBAS-KIRKENAER,62.083,9.133
012360,99999,KJOREMSGRENDE,62.1,9.05
012390,99999,HJERKINN II,62.217,9.55
012430,99999,SONGLI,63.333,9.65
012520,99999,BERKAK-LYNGHOLT,62.817,10.017
012580,99999,TRONDHEIM (TYHOLT)           ,63.417,10.433
012740,99999,SELBU-STUBBE,63.2,11.117
012771,99999,LEVANGER-EGGEN,63.717,11.233
012780,99999,VERDAL-REPPE,63.783,11.683
012823,99999,RORVIK/RYUM,64.85,11.233
012890,99999,ROROS LUFTHAVN,62.583,11.35
012891,99999,ROROS/AIRPORT,62.583,11.383
012920,99999,MERAKER-UTSYN,63.417,11.7
012950,99999,HOYLANDET,64.55,12.15
012960,99999,BERG I SNASA,64.25,12.417
012980,99999,NORDLI-HOLAND,64.45,13.717
013060,99999,HELLISOY FYR,60.75,4.717
013160,99999,BERGEN-FREDRIKSBERG,60.4,5.317
013180,99999,SANDANE,61.783,6.183
013220,99999,FORDE-TEFRE,61.467,5.917
013250,99999,MODALEN II,60.833,5.95
013280,99999,KVAMSKOGEN,60.4,5.917
013390,99999,VANGSNES,61.167,6.65
013410,99999,EIDFJORD-BU,60.467,6.867
013471,99999,SOGNDAL/HAUKASEN,61.167,7.133
013510,99999,FINSE III,60.6,7.5
013560,99999,FANNARAKI,61.517,7.9
013591,99999,HAUGASTOL,60.517,7.867
013671,99999,BEITOSTOLEN,61.233,8.933
013690,99999,ABJORSBRATEN,60.917,9.283
013720,99999,NESBYEN-SKOGLUND,60.567,9.133
013743,99999,FAGERNES/LEIRIN   &          ,61.0,9.3
013790,99999,SOR-NESSET,61.883,10.15
013801,99999,KITTILBU,61.167,9.967
013839,99999,HAMAR / STAFSBERG,60.817,11.067
013910,99999,FLISA,60.617,12.017
014000,99999,EKOFISK,56.55,3.217
014010,99999,FRIGG,59.983,2.25
014035,99999,KARMOY,59.35,5.217
014110,99999,KVITSOY - NORDBO,59.067,5.417
014120,99999,OBRESTAD,58.65,5.567
014211,99999,INDRE MATRE,59.85,6.0
014280,99999,LISTA,58.099,6.626
014320,99999,SIRDAL-TJORHOM,58.883,6.85
014321,99999,FIDJELAND,58.967,6.933
014330,99999,MIDTLAEGER,59.833,6.983
014450,99999,SKAFSA,59.45,8.0
014460,99999,OYFJELL-TROVATN,59.567,8.2
014611,99999,GAUSTATOPPEN,59.85,8.65
Query:
-- Corrected Query 5: Create geography points for each station with valid coordinates.
SELECT "usaf", "wban", "name", ST_MAKEPOINT("lon", "lat") AS "geom"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL AND "lat" != 0 AND "lon" != 0
LIMIT 100
Answer:
Too long, hard cut:
usaf,wban,name,geom
008268,99999,WXPOD8278                    ,"{
  ""coordinates"": [
    6.556699999999999e+01,
    3.295000000000000e+01
  ],
  ""type"": ""Point""
}"
010016,99999,RORVIK/RYUM,"{
  ""coordinates"": [
    1.123300000000000e+01,
    6.484999999999999e+01
  ],
  ""type"": ""Point""
}"
010017,99999,FRIGG,"{
  ""coordinates"": [
    2.250000000000000e+00,
    5.998000000000000e+01
  ],
  ""type"": ""Point""
}"
010071,99999,LONGYEARBYEN,"{
  ""coordinates"": [
    1.558300000000000e+01,
    7.821700000000000e+01
  ],
  ""type"": ""Point""
}"
010190,99999,SVARTTANGEN,"{
  ""coordinates"": [
    2.081700000000000e+01,
    7.751700000000000e+01
  ],
  ""type"": ""Point""
}"
010240,99999,PYRAMIDEN,"{
  ""coordinates"": [
    1.636700000000000e+01,
    7.865000000000001e+01
  ],
  ""type"": ""Point""
}"
010303,99999,TROMSO/SKATTURA,"{
  ""coordinates"": [
    1.901700000000000e+01,
    6.970000000000000e+01
  ],
  ""type"": ""Point""
}"
010320,99999,OVERBYGD,"{
  ""coordinates"": [
    1.928300000000000e+01,
    6.901700000000000e+01
  ],
  ""type"": ""Point""
}"
010340,99999,FUGLOYKALVEN FYR,"{
  ""coordinates"": [
    2.015000000000000e+01,
    7.031699999999999e+01
  ],
  ""type"": ""Point""
}"
010470,99999,KAUTOKEINO II,"{
  ""coordinates"": [
    2.306700000000000e+01,
    6.901700000000000e+01
  ],
  ""type"": ""Point""
}"
010510,99999,SUOLOVUOPMI,"{
  ""coordinates"": [
    2.353300000000000e+01,
    6.958300000000000e+01
  ],
  ""type"": ""Point""
}"
010530,99999,HAMMERFEST RADIO,"{
  ""coordinates"": [
    2.368300000000000e+01,
    7.068300000000001e+01
  ],
  ""type"": ""Point""
}"
010610,99999,BRENNELV,"{
  ""coordinates"": [
    2.511700000000000e+01,
    7.006699999999999e+01
  ],
  ""type"": ""Point""
}"
010660,99999,HELNES FYR,"{
  ""coordinates"": [
    2.623300000000000e+01,
    7.106699999999999e+01
  ],
  ""type"": ""Point""
}"
010670,99999,LEVAJOK-EVJEN,"{
  ""coordinates"": [
    2.641700000000000e+01,
    6.990000000000001e+01
  ],
  ""type"": ""Point""
}"
010671,99999,LEVAJOK-EVJEN,"{
  ""coordinates"": [
    2.641700000000000e+01,
    6.990000000000001e+01
  ],
  ""type"": ""Point""
}"
010750,99999,RUSTEFJELBMA,"{
  ""coordinates"": [
    2.820000000000000e+01,
    7.040000000000001e+01
  ],
  ""type"": ""Point""
}"
010884,99999,GEITERYGGEN,"{
  ""coordinates"": [
    9.567000000000000e+00,
    5.918500000000000e+01
  ],
  ""type"": ""Point""
}"
011030,99999,LEKA,"{
  ""coordinates"": [
    1.170000000000000e+01,
    6.509999999999999e+01
  ],
  ""type"": ""Point""
}"
011051,99999,SKOMVAER (LGT-H)             ,"{
  ""coordinates"": [
    1.188300000000000e+01,
    6.741700000000000e+01
  ],
  ""type"": ""Point""
}"
011100,99999,YTTERHOLMEN FYR,"{
  ""coordinates"": [
    1.168300000000000e+01,
    6.600000000000000e+01
  ],
  ""type"": ""Point""
}"
011130,99999,GLOMFJORD,"{
  ""coordinates"": [
    1.398300000000000e+01,
    6.680000000000000e+01
  ],
  ""type"": ""Point""
}"
011133,99999,DAGALI,"{
  ""coordinates"": [
    8.513000000000000e+00,
    6.041700000000000e+01
  ],
  ""type"": ""Point""
}"
011310,99999,GLAPEN LIGHTHOUSE,"{
  ""coordinates"": [
    1.305000000000000e+01,
    6.788300000000000e+01
  ],
  ""type"": ""Point""
}"
011340,99999,MAJAVATN III,"{
  ""coordinates"": [
    1.341700000000000e+01,
    6.518300000000001e+01
  ],
  ""type"": ""Point""
}"
011380,99999,TENNHOLMEN (LGT-H)           ,"{
  ""coordinates"": [
    1.350000000000000e+01,
    6.730000000000000e+01
  ],
  ""type"": ""Point""
}"
011490,99999,RANA-BASMOEN,"{
  ""coordinates"": [
    1.410000000000000e+01,
    6.633300000000000e+01
  ],
  ""type"": ""Point""
}"
011501,99999,HATTFJELLDAL-KRUTA,"{
  ""coordinates"": [
    1.416700000000000e+01,
    6.568300000000001e+01
  ],
  ""type"": ""Point""
}"
011530,99999,BODO-VAGONES,"{
  ""coordinates"": [
    1.445000000000000e+01,
    6.728300000000000e+01
  ],
  ""type"": ""Point""
}"
011540,99999,LITLOY FYR,"{
  ""coordinates"": [
    1.430000000000000e+01,
    6.858300000000000e+01
  ],
  ""type"": ""Point""
}"
011560,99999,BO I VESTERALEN,"{
  ""coordinates"": [
    1.443300000000000e+01,
    6.859999999999999e+01
  ],
  ""type"": ""Point""
}"
011630,99999,BOLNA,"{
  ""coordinates"": [
    1.525000000000000e+01,
    6.650000000000000e+01
  ],
  ""type"": ""Point""
}"
011680,99999,KLEIVA I SORTLAND,"{
  ""coordinates"": [
    1.528300000000000e+01,
    6.865000000000001e+01
  ],
  ""type"": ""Point""
}"
011691,99999,OVRE SALTDAL,"{
  ""coordinates"": [
    1.531700000000000e+01,
    6.696700000000000e+01
  ],
  ""type"": ""Point""
}"
011700,99999,FAUSKE-VETEN,"{
  ""coordinates"": [
    1.531700000000000e+01,
    6.723300000000000e+01
  ],
  ""type"": ""Point""
}"
011720,99999,FINNOY I HAMAROY,"{
  ""coordinates"": [
    1.561700000000000e+01,
    6.800000000000000e+01
  ],
  ""type"": ""Point""
}"
011760,99999,KONGSVIK,"{
  ""coordinates"": [
    1.626700000000000e+01,
    6.856699999999999e+01
  ],
  ""type"": ""Point""
}"
011840,99999,SANDSOY I
Query:
-- Corrected Query 6: Find stations within a 20-mile radius of Chappaqua, NY.
SELECT "usaf", "wban", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE
    "lat" IS NOT NULL AND "lon" IS NOT NULL AND "lat" != 0 AND "lon" != 0 AND
    ST_DWITHIN(
        ST_MAKEPOINT("lon", "lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
LIMIT 100
Answer:
usaf,wban,name,lat,lon
999999,14797,BEAR MOUNTAIN WB,41.317,-74.0
997186,99999,WESTERN LONG ISLAND SOUND,40.96,-73.58
999999,94745,WHITE PLAINS WESTCHESTER CO A,41.067,-73.708
725086,99999,DANBURY MUNI ARPT,41.372,-73.482
725037,94745,WESTCHESTER COUNTY AIRPORT,41.062,-73.705
725086,54734,DANBURY MUNICIPAL AIRPORT,41.371,-73.483
Query:
-- Corrected Query 7: View temperature observations from GSOD2011.
SELECT "stn", "wban", "year", "mo", "da", "temp", "count_temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100
Answer:
stn,wban,year,mo,da,temp,count_temp
387340,99999,2011,11,08,28.6,6
387250,99999,2011,02,04,31.5,6
388440,99999,2011,02,07,24.4,7
724293,99999,2011,11,13,24.3,8
061080,99999,2011,07,22,59.9,8
388460,99999,2011,11,09,32.5,4
388440,99999,2011,02,26,17.3,6
388440,99999,2011,11,09,23.8,6
387340,99999,2011,10,05,46.3,6
023020,99999,2011,04,12,32.9,12
021300,99999,2011,02,28,30.5,14
680025,99999,2011,01,28,71.2,16
023020,99999,2011,06,11,62.2,17
023030,99999,2011,08,31,44.7,18
026020,99999,2011,11,27,48.0,19
021300,99999,2011,05,31,42.6,20
022330,99999,2011,01,14,-14.0,23
020540,99999,2011,05,03,29.8,23
025210,99999,2011,06,07,65.2,23
026460,99999,2011,01,25,31.7,23
026460,99999,2011,08,06,66.1,23
023020,99999,2011,10,06,42.9,23
025210,99999,2011,08,08,59.1,23
022560,99999,2011,12,19,23.6,24
023370,99999,2011,03,13,22.9,24
023370,99999,2011,03,25,23.4,24
022160,99999,2011,03,09,30.7,24
023030,99999,2011,04,04,30.3,24
026520,99999,2011,02,22,20.3,24
010231,99999,2011,03,11,34.0,24
023020,99999,2011,12,25,33.6,24
722857,99999,2011,12,03,29.0,24
021230,99999,2011,01,09,13.0,24
024130,99999,2011,12,09,31.5,24
021460,99999,2011,04,10,30.3,24
021460,99999,2011,01,14,-12.5,24
023370,99999,2011,02,11,5.4,24
023110,99999,2011,02,07,24.8,24
022330,99999,2011,03,11,11.3,24
020540,99999,2011,01,16,8.8,24
022170,99999,2011,02,02,30.4,24
022560,99999,2011,11,27,23.0,24
024130,99999,2011,02,23,3.9,24
022170,99999,2011,03,06,25.4,24
026460,99999,2011,02,19,20.6,24
023110,99999,2011,01,08,16.2,24
022920,99999,2011,02,19,4.8,24
024130,99999,2011,02,07,12.5,24
720654,99999,2011,06,26,83.6,19
023020,99999,2011,03,07,28.3,20
025070,99999,2011,08,24,57.8,20
026520,99999,2011,08,18,62.5,21
026460,99999,2011,06,14,60.9,22
026090,99999,2011,09,30,58.4,22
025070,99999,2011,06,05,62.3,22
022560,99999,2011,09,16,43.4,23
026090,99999,2011,12,09,42.0,23
026520,99999,2011,06,22,64.7,23
024720,99999,2011,02,25,26.3,24
021460,99999,2011,12,08,10.9,24
025070,99999,2011,01,04,31.5,24
023370,99999,2011,02,04,16.7,24
022560,99999,2011,12,30,13.9,24
021230,99999,2011,02,22,-10.6,24
021230,99999,2011,02,11,12.5,24
023020,99999,2011,02,18,3.0,24
026460,99999,2011,01,21,28.4,24
023030,99999,2011,02,06,21.7,24
021300,99999,2011,03,28,16.1,24
022170,99999,2011,01,15,13.2,24
022330,99999,2011,12,17,26.6,24
026520,99999,2011,02,21,22.1,24
023020,99999,2011,10,20,32.6,24
025210,99999,2011,03,01,28.6,24
022170,99999,2011,03,22,32.5,24
021700,99999,2011,01,16,14.5,24
023020,99999,2011,01,12,19.2,24
021700,99999,2011,12,21,21.5,24
022160,99999,2011,02,15,7.8,24
022560,99999,2011,01,26,10.5,24
026520,99999,2011,02,23,19.4,24
024130,99999,2011,01,15,6.8,24
020540,99999,2011,01,02,14.5,24
023030,99999,2011,01,06,14.6,24
022170,99999,2011,01,01,25.8,24
022330,99999,2011,12,03,23.9,24
022920,99999,2011,11,28,28.5,24
023490,99999,2011,01,15,-4.8,24
025530,99999,2011,12,05,31.8,24
022560,99999,2011,02,15,-1.0,24
023540,99999,2011,03,14,30.4,24
021300,99999,2011,02,07,6.0,24
023020,99999,2011,08,01,57.0,13
022330,99999,2011,09,14,49.1,15
024130,99999,2011,05,01,41.2,19
022920,99999,2011,11,25,37.0,19
026520,99999,2011,08,17,62.2,20
022160,99999,2011,10,28,41.7,22
025950,99999,2011,06,05,60.1,22
023490,99999,2011,02,24,3.1,23
Query:
-- Corrected Query 8: Count the number of valid temperature observations per station in 2011.
SELECT "stn", COUNT(*) AS "valid_temp_observations_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Answer:
stn,valid_temp_observations_2011
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358
Query:
-- Corrected Query 9: Sum the total number of temperature measurements contributing to the mean per station in 2011.
SELECT "stn", SUM("count_temp") AS "total_temp_measurements_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "count_temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Answer:
stn,total_temp_measurements_2011
873490,2858
309350,2907
357000,2732
343910,2816
261340,2865
330190,2095
471400,2917
247680,2833
297360,2905
288070,2758
961790,2868
306730,2889
385990,2527
484800,2918
470280,2713
060110,2716
432260,2841
227210,2913
427540,2855
263890,2912
874480,2855
360960,2910
383880,2889
291220,2907
345040,2742
226210,2896
470350,2791
875480,2887
610750,2861
333770,2746
967910,2331
028720,2883
874670,2692
610960,2858
278570,2798
612400,2457
234120,2707
249590,2857
388950,2914
319870,2720
272080,2914
252820,2849
426230,2844
370850,2777
308620,2903
296250,2909
261440,2868
314890,2716
485320,3107
623250,2648
984300,2880
350110,2776
597580,2917
400300,2483
572970,2918
324080,2588
509150,2918
514310,2913
766753,8591
404390,8666
997993,8398
129250,8631
997386,8566
724463,8745
966450,2865
484200,2912
484150,2727
337610,2771
383410,2715
325830,2608
485740,2725
432130,2867
471350,2913
471620,2917
961630,2820
345790,2862
470700,2712
292820,2911
360580,2911
471500,2916
319150,2736
278350,2725
280490,2719
347300,2784
285880,2652
335870,2770
314840,2703
483580,2721
133890,2886
253560,2212
293480,2914
299370,2915
360640,2899
485570,2709
970480,2858
973400,2792
297120,2910
484000,2918
345450,2750
221270,2747
Query:
-- Corrected Query 10: Find stations within 20 miles of Chappaqua and list their temperature observations in 2011.
SELECT s."usaf", s."wban", s."name", g."year", g."mo", g."da", g."temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" g
  ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0 AND
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8
    )
LIMIT 100
Answer:
Too long, hard cut:
usaf,wban,name,year,mo,da,temp
997186,99999,WESTERN LONG ISLAND SOUND,2011,01,24,18.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,12,25,43.0
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,27,62.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,06,02,75.7
997186,99999,WESTERN LONG ISLAND SOUND,2011,11,25,51.0
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,26,58.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,10,03,57.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,10,20,62.9
997186,99999,WESTERN LONG ISLAND SOUND,2011,09,22,70.4
999999,14797,BEAR MOUNTAIN WB,2011,06,18,89.1
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,06,18,89.1
997186,99999,WESTERN LONG ISLAND SOUND,2011,05,17,53.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,12,27,43.3
999999,14797,BEAR MOUNTAIN WB,2011,02,16,55.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,16,55.5
997186,99999,WESTERN LONG ISLAND SOUND,2011,01,20,32.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,18,51.9
997186,99999,WESTERN LONG ISLAND SOUND,2011,06,18,64.7
997186,99999,WESTERN LONG ISLAND SOUND,2011,03,25,38.1
997186,99999,WESTERN LONG ISLAND SOUND,2011,09,23,70.7
999999,14797,BEAR MOUNTAIN WB,2011,03,31,62.0
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,03,31,62.0
999999,14797,BEAR MOUNTAIN WB,2011,02,17,54.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,17,54.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,04,15,50.2
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,23,80.8
999999,14797,BEAR MOUNTAIN WB,2011,06,11,65.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,06,11,65.6
999999,14797,BEAR MOUNTAIN WB,2011,01,03,63.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,03,63.3
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,18,76.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,08,03,74.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,10,11,66.7
997186,99999,WESTERN LONG ISLAND SOUND,2011,11,04,50.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,12,07,50.4
997186,99999,WESTERN LONG ISLAND SOUND,2011,06,06,69.1
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,09,70.3
997186,99999,WESTERN LONG ISLAND SOUND,2011,05,31,72.9
999999,14797,BEAR MOUNTAIN WB,2011,06,18,84.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,06,18,84.6
997186,99999,WESTERN LONG ISLAND SOUND,2011,07,22,79.8
997186,99999,WESTERN LONG ISLAND SOUND,2011,08,19,74.0
999999,14797,BEAR MOUNTAIN WB,2011,09,30,71.0
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,09,30,71.0
999999,14797,BEAR MOUNTAIN WB,2011,03,14,60.7
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,03,14,60.7
999999,14797,BEAR MOUNTAIN WB,2011,07,21,77.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,07,21,77.3
999999,14797,BEAR MOUNTAIN WB,2011,08,20,82.9
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,08,20,82.9
999999,14797,BEAR MOUNTAIN WB,2011,04,16,56.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,04,16,56.5
999999,14797,BEAR MOUNTAIN WB,2011,01,14,31.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,14,31.6
999999,14797,BEAR MOUNTAIN WB,2011,02,04,17.1
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,04,17.1
999999,14797,BEAR MOUNTAIN WB,2011,02,17,27.1
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,17,27.1
999999,14797,BEAR MOUNTAIN WB,2011,01,19,31.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,19,31.6
999999,14797,BEAR MOUNTAIN WB,2011,02,16,36.7
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,16,36.7
999999,14797,BEAR MOUNTAIN WB,2011,01,01,-6.9
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,01,-6.9
999999,14797,BEAR MOUNTAIN WB,2011,01,18,31.2
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,01,18,31.2
999999,14797,BEAR MOUNTAIN WB,2011,02,01,15.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,01,15.6
999999,14797,BEAR MOUNTAIN WB,2011,02,23,29.6
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,23,29.6
999999,14797,BEAR MOUNTAIN WB,2011,02,27,27.8
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,02,27,27.8
999999,14797,BEAR MOUNTAIN WB,2011,12,13,24.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,12,13,24.3
999999,14797,BEAR MOUNTAIN WB,2011,12,05,16.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,12,05,16.5
999999,14797,BEAR MOUNTAIN WB,2011,08,12,83.3
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,08,12,83.3
999999,14797,BEAR MOUNTAIN WB,2011,11,05,33.0
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,11,05,33.0
999999,14797,BEAR MOUNTAIN WB,2011,11,27,68.8
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,11,27,68.8
999999,14797,BEAR MOUNTAIN WB,2011,09,10,70.4
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,09,10,70.4
999999,14797,BEAR MOUNTAIN WB,2011,09,16,65.7
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,09,16,65.7
999999,14797,BEAR MOUNTAIN WB,2011,10,30,47.4
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,10,30,47.4
999999,14797,BEAR MOUNTAIN WB,2011,10,15,65.8
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,10,15,65.8
999999,14797,BEAR MOUNTAIN WB,2011,11,23,38.5
999999,94745,WHITE PLAINS WESTCHESTER CO A,2011,11,23,38.5
999999,14797,BEAR MOUNTAIN WB,2011,10,09,46.7
999999,94745,WHITE PLAI
Query:
-- Corrected Query 11: Find the distinct years available in the GSOD tables (using multiple years).
SELECT DISTINCT "year"
FROM (
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    UNION
    SELECT "year" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
) AS years
LIMIT 100
Answer:
year
2011
2012
2014
2015
2016
2018
2019
2020
2013
2017
Query:
-- Corrected Query 12: List distinct station IDs from GSOD2011.
SELECT DISTINCT "stn"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
LIMIT 100
Answer:
stn
297120
291220
471560
280490
967910
285880
404170
483600
319150
234120
253560
360580
874480
360640
278570
388950
306730
337610
612400
961630
484150
488300
977220
873490
610960
247680
319870
345040
333770
471500
370850
314890
973400
970480
252820
347300
343910
288070
610750
874670
470350
227210
292820
272080
249590
471350
483580
133890
470600
875480
335870
308620
485320
309350
357000
330190
966450
385990
961790
261340
432260
471400
297360
484800
470280
060110
360960
427540
263890
387250
021230
020540
026090
022170
720605
720406
720743
369740
369820
723761
724833
085020
965050
480200
633310
677650
432210
113080
106164
643900
682905
680300
035660
679770
722907
679750
720411
643600
726603
702755
Query:
-- Corrected Query 13: Count valid temperature observations for each station in 2011.
SELECT "stn", COUNT(*) AS "valid_temp_observations_2011"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Answer:
stn,valid_temp_observations_2011
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358
Query:
-- Corrected Query 14: List stations with their earliest and latest observation dates in 2011.
SELECT "stn",
    MIN(DATE_FROM_PARTS("year", "mo", "da")) AS "first_observation",
    MAX(DATE_FROM_PARTS("year", "mo", "da")) AS "last_observation"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "year" IS NOT NULL AND "mo" IS NOT NULL AND "da" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Answer:
stn,first_observation,last_observation
297120,2011-01-01,2011-12-31
291220,2011-01-01,2011-12-31
337610,2011-01-01,2011-12-31
360580,2011-01-01,2011-12-31
234120,2011-01-01,2011-12-31
471560,2011-01-01,2011-12-31
612400,2011-01-02,2011-12-30
319150,2011-01-01,2011-12-31
285880,2011-01-01,2011-12-31
280490,2011-01-01,2011-12-31
967910,2011-01-01,2011-12-31
404170,2011-01-01,2011-12-31
961630,2011-01-01,2011-12-31
278570,2011-01-01,2011-12-31
306730,2011-01-01,2011-12-31
427540,2011-01-01,2011-12-31
263890,2011-01-01,2011-12-31
343910,2011-01-01,2011-12-31
299370,2011-01-01,2011-12-31
970480,2011-01-01,2011-12-31
426230,2011-01-01,2011-12-31
610960,2011-01-01,2011-12-31
370850,2011-01-01,2011-12-31
977220,2011-01-01,2011-12-31
345450,2011-01-01,2011-12-31
261340,2011-01-01,2011-12-31
308620,2011-01-01,2011-12-31
227210,2011-01-01,2011-12-31
432130,2011-01-01,2011-12-31
973400,2011-01-01,2011-12-31
875480,2011-01-01,2011-12-31
484150,2011-01-01,2011-12-31
028720,2011-01-01,2011-12-31
357000,2011-01-01,2011-12-31
484000,2011-01-01,2011-12-31
296250,2011-01-01,2011-12-31
985380,2011-01-01,2011-12-31
610750,2011-01-01,2011-12-31
335870,2011-01-01,2011-12-31
873490,2011-01-01,2011-12-31
345040,2011-01-01,2011-12-31
292820,2011-01-01,2011-12-31
485320,2011-01-01,2011-12-31
319870,2011-01-01,2011-12-31
249590,2011-01-01,2011-12-31
297360,2011-01-01,2011-12-31
385990,2011-01-01,2011-12-31
350110,2011-01-01,2011-12-31
984300,2011-01-01,2011-12-31
624550,2011-01-01,2011-12-31
572970,2011-01-01,2011-12-31
509150,2011-01-01,2011-12-31
324080,2011-01-01,2011-12-31
471620,2011-01-01,2011-12-31
597580,2011-01-01,2011-12-31
576620,2011-01-01,2011-12-31
766920,2011-01-01,2011-12-31
514310,2011-01-01,2011-12-31
624230,2011-01-01,2011-12-31
404390,2011-01-01,2011-12-31
766753,2011-01-01,2011-12-31
997993,2011-01-01,2011-12-31
129250,2011-01-01,2011-12-31
997386,2011-01-01,2011-12-31
483600,2011-01-02,2011-12-31
253560,2011-01-01,2011-12-31
874480,2011-01-01,2011-12-31
360640,2011-01-01,2011-12-31
345790,2011-01-01,2011-12-31
330190,2011-01-01,2011-12-31
360960,2011-01-01,2011-12-31
260290,2011-01-01,2011-12-31
319690,2011-01-01,2011-12-31
282140,2011-01-01,2011-12-31
471920,2011-01-01,2011-12-31
485570,2011-01-01,2011-12-31
383880,2011-01-01,2011-12-31
383410,2011-01-01,2011-12-31
296450,2011-01-01,2011-12-31
288070,2011-01-01,2011-12-31
470700,2011-01-03,2011-12-31
483720,2011-01-01,2011-12-31
966450,2011-01-01,2011-12-31
961790,2011-01-01,2011-12-31
874670,2011-01-01,2011-12-31
470350,2011-01-02,2011-12-31
309350,2011-01-01,2011-12-31
272080,2011-01-01,2011-12-31
133890,2011-01-01,2011-12-31
294050,2011-01-01,2011-12-31
484800,2011-01-01,2011-12-31
485740,2011-01-01,2011-12-31
483580,2011-01-01,2011-12-31
252820,2011-01-01,2011-12-31
226210,2011-01-01,2011-12-31
402650,2011-01-01,2011-12-31
293480,2011-01-01,2011-12-31
987470,2011-01-01,2011-12-31
221270,2011-01-01,2011-12-31
314890,2011-01-01,2011-12-31
Query:
-- Corrected Query 15: Find stations within 20 miles of Chappaqua and their total valid temperature observations in 2015.
SELECT s."usaf", s."wban", s."name", COUNT(*) AS "valid_temp_observations_2015"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" g
  ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0 AND
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8
    ) AND g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100
Answer:
usaf,wban,name,valid_temp_observations_2015
997186,99999,WESTERN LONG ISLAND SOUND,51
725086,54734,DANBURY MUNICIPAL AIRPORT,365
999999,94745,WHITE PLAINS WESTCHESTER CO A,181871
725037,94745,WESTCHESTER COUNTY AIRPORT,365
999999,14797,BEAR MOUNTAIN WB,181871
725086,99999,DANBURY MUNI ARPT,365
Query:
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(g."temp") AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "wban", "temp"
        FROM
            (
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat"
LIMIT 100;
Answer:
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
997186,WESTERN LONG ISLAND SOUND,-73.58,40.96,1532
725086,DANBURY MUNICIPAL AIRPORT,-73.483,41.371,3649
725037,WESTCHESTER COUNTY AIRPORT,-73.705,41.062,3653
Query:
-- Corrected Query 17: Find the maximum and minimum temperatures recorded by stations within 20 miles of Chappaqua in 2020.
SELECT s."usaf", s."wban", s."name",
    MAX(g."temp") AS "max_temp_2020",
    MIN(g."temp") AS "min_temp_2020"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020" g
  ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    ) AND g."temp" IS NOT NULL
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100
Answer:
usaf,wban,name,max_temp_2020,min_temp_2020
725086,54734,DANBURY MUNICIPAL AIRPORT,82.4,15.1
725037,94745,WESTCHESTER COUNTY AIRPORT,83.6,17.3
Query:
-- Corrected Query 18: Retrieve station information along with elevation data.
SELECT "usaf", "wban", "name", "lat", "lon", "elev"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "elev" IS NOT NULL AND "elev" != ''
LIMIT 100
Answer:
usaf,wban,name,lat,lon,elev
007018,99999,WXPOD 7018                   ,0.0,0.0,+7018.0
007026,99999,WXPOD 7026                   ,0.0,0.0,+7026.0
007070,99999,WXPOD 7070                   ,0.0,0.0,+7070.0
008268,99999,WXPOD8278                    ,32.95,65.567,+1156.7
008307,99999,WXPOD 8318                   ,0.0,0.0,+8318.0
010016,99999,RORVIK/RYUM,64.85,11.233,+0014.0
010017,99999,FRIGG,59.98,2.25,+0048.0
010071,99999,LONGYEARBYEN,78.217,15.583,+0037.0
010190,99999,SVARTTANGEN,77.517,20.817,+0020.0
010240,99999,PYRAMIDEN,78.65,16.367,+0020.0
010303,99999,TROMSO/SKATTURA,69.7,19.017,+0014.0
010320,99999,OVERBYGD,69.017,19.283,+0078.0
010340,99999,FUGLOYKALVEN FYR,70.317,20.15,+0038.0
010470,99999,KAUTOKEINO II,69.017,23.067,+0307.0
010510,99999,SUOLOVUOPMI,69.583,23.533,+0374.0
010530,99999,HAMMERFEST RADIO,70.683,23.683,+0070.0
010610,99999,BRENNELV,70.067,25.117,+0034.0
010660,99999,HELNES FYR,71.067,26.233,+0033.0
010670,99999,LEVAJOK-EVJEN,69.9,26.417,+0112.0
010671,99999,LEVAJOK-EVJEN,69.9,26.417,+0112.0
010750,99999,RUSTEFJELBMA,70.4,28.2,+0011.2
010884,99999,GEITERYGGEN,59.185,9.567,+0141.1
011030,99999,LEKA,65.1,11.7,+0047.0
011051,99999,SKOMVAER (LGT-H)             ,67.417,11.883,+0018.0
011100,99999,YTTERHOLMEN FYR,66.0,11.683,+0033.0
011130,99999,GLOMFJORD,66.8,13.983,+0039.0
011133,99999,DAGALI,60.417,8.513,+0798.0
011310,99999,GLAPEN LIGHTHOUSE,67.883,13.05,+0031.0
011340,99999,MAJAVATN III,65.183,13.417,+0339.0
011380,99999,TENNHOLMEN (LGT-H)           ,67.3,13.5,+0014.0
011490,99999,RANA-BASMOEN,66.333,14.1,+0042.0
011501,99999,HATTFJELLDAL-KRUTA,65.683,14.167,+0385.0
011530,99999,BODO-VAGONES,67.283,14.45,+0033.0
011540,99999,LITLOY FYR,68.583,14.3,+0030.0
011560,99999,BO I VESTERALEN,68.6,14.433,+0007.6
011630,99999,BOLNA,66.5,15.25,+0549.0
011680,99999,KLEIVA I SORTLAND,68.65,15.283,+0023.0
011691,99999,OVRE SALTDAL,66.967,15.317,+0026.0
011700,99999,FAUSKE-VETEN,67.233,15.317,+0165.0
011720,99999,FINNOY I HAMAROY,68.0,15.617,+0053.0
011760,99999,KONGSVIK,68.567,16.267,+0025.0
011840,99999,SANDSOY I SENJA,68.933,16.683,+0045.0
011841,99999,SANDSOY,68.933,16.683,+0045.0
011890,99999,LILAND,68.483,16.883,+0019.0
011930,99999,NARVIK III/FRAMNES,68.467,17.5,+0023.0
011960,99999,TENNEVOLL,68.75,17.817,+0021.0
011980,99999,DIVIDALEN II,68.783,19.7,+0204.0
012070,99999,FISKABYGD,62.1,5.583,+0041.0
012091,99999,ORSTA-VOLDA/HOVD,62.183,6.05,+0074.0
012150,99999,HJELVIK MYRBO,62.62,7.23,+0035.0
012160,99999,HJELVIK I ROMSDAL,62.617,7.217,+0016.0
012161,99999,GJERMUNDNES,62.617,7.167,+0049.0
012210,99999,TAGDALEN,63.05,9.083,+0415.0
012273,99999,TINGVOLL-HANEM,62.833,8.3,+0069.0
012310,99999,LESJASKOG,62.233,8.367,+0621.0
012350,99999,DOMBAS-KIRKENAER,62.083,9.133,+0645.0
012360,99999,KJOREMSGRENDE,62.1,9.05,+0626.0
012390,99999,HJERKINN II,62.217,9.55,+1012.0
012430,99999,SONGLI,63.333,9.65,+0300.0
012520,99999,BERKAK-LYNGHOLT,62.817,10.017,+0475.0
012580,99999,TRONDHEIM (TYHOLT)           ,63.417,10.433,+0113.0
012740,99999,SELBU-STUBBE,63.2,11.117,+0242.0
012771,99999,LEVANGER-EGGEN,63.717,11.233,+0097.0
012780,99999,VERDAL-REPPE,63.783,11.683,+0083.0
012823,99999,RORVIK/RYUM,64.85,11.233,+0014.0
012890,99999,ROROS LUFTHAVN,62.583,11.35,+0626.0
012891,99999,ROROS/AIRPORT,62.583,11.383,+0626.0
012920,99999,MERAKER-UTSYN,63.417,11.7,+0240.0
012950,99999,HOYLANDET,64.55,12.15,+0027.0
012960,99999,BERG I SNASA,64.25,12.417,+0127.0
012980,99999,NORDLI-HOLAND,64.45,13.717,+0433.0
013060,99999,HELLISOY FYR,60.75,4.717,+0023.0
013160,99999,BERGEN-FREDRIKSBERG,60.4,5.317,+0040.0
013180,99999,SANDANE,61.783,6.183,+0051.0
013220,99999,FORDE-TEFRE,61.467,5.917,+0064.0
013250,99999,MODALEN II,60.833,5.95,+0114.0
013280,99999,KVAMSKOGEN,60.4,5.917,+0408.0
013390,99999,VANGSNES,61.167,6.65,+0053.0
013410,99999,EIDFJORD-BU,60.467,6.867,+0166.0
013471,99999,SOGNDAL/HAUKASEN,61.167,7.133,+0498.0
013510,99999,FINSE III,60.6,7.5,+1224.0
013560,99999,FANNARAKI,61.517,7.9,+2062.0
013591,99999,HAUGASTOL,60.517,7.867,+0988.0
013671,99999,BEITOSTOLEN,61.233,8.933,+0828.0
013690,99999,ABJORSBRATEN,60.917,9.283,+0639.0
013720,99999,NESBYEN-SKOGLUND,60.567,9.133,+0167.0
013743,99999,FAGERNES/LEIRIN   &          ,61.0,9.3,+0822.0
013790,99999,SOR-NESSET,61.883,10.15,+0739.0
013801,99999,KITTILBU,61.167,9.967,+0816.0
013839,99999,HAMAR / STAFSBERG,60.817,11.067,+0223.0
013910,99999,FLISA,60.617,12.017,+0188.0
014000,99999,EKOFISK,56.55,3.217,+0048.8
014010,99999,FRIGG,59.983,2.25,+0048.0
014035,99999,KARMOY,59.35,5.217,+0023.0
014110,99999,KVITSOY - NORDBO,59.067,5.417,+0022.0
014120,99999,OBRESTAD,58.65,5.567,+0026.0
014211,99999,INDRE MATRE,59.85,6.0,+0024.0
014280,99999,LISTA,58.099,6.626,+0008.8
014320,99999,SIRDAL-TJORHOM,58.883,6.85,+0500.0
014321,99999,FIDJELAND,58.967,6.933,+0568.0
Query:
-- Corrected Query 19: Find the average temperature for each station in 2012.
SELECT "stn", AVG("temp") AS "avg_temp_2012"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "temp" IS NOT NULL
GROUP BY "stn"
LIMIT 100
Answer:
stn,avg_temp_2012
154700,53.93907103825137
154100,55.97158469945355
474130,46.3917808219178
022610,34.33526170798899
039560,49.75714285714285
722069,70.53060109289616
722909,64.1774193548387
032300,45.342739726027396
725374,51.90081967213115
020360,27.020273972602737
720361,68.38587257617728
020130,30.474104683195595
022710,33.9
727675,43.05683060109289
043390,23.689890710382514
025630,45.187704918032786
726818,46.87978142076503
725016,55.28919667590027
474210,47.88360655737705
042110,22.78099173553719
702910,21.757650273224044
027900,43.36092896174863
028890,32.98109589041095
039610,49.46393442622951
039760,50.82568306010929
476530,60.97917808219177
064960,45.21983240223464
725420,55.306830601092905
726410,51.84808743169398
727810,52.156010928961756
725347,52.16393442622951
746410,61.29479452054795
722595,69.82554945054945
745046,62.54508196721312
746120,66.8913407821229
724455,55.11256830601092
722487,68.35218579234972
726654,49.26830601092897
727976,50.384153005464476
742060,50.44836065573771
724505,61.34617486338798
029640,42.664931506849314
478980,64.19999999999999
747950,74.15710382513662
722535,70.86120218579235
071660,50.527348066298345
724066,56.42322404371585
725376,54.8464480874317
726546,47.041256830601085
722416,69.4071038251366
023470,39.80027548209367
725499,55.125136612021855
722151,53.731420765027316
726620,50.53688524590165
723035,63.69016393442622
724040,60.477049180327874
724250,57.48224043715847
747900,64.98825136612022
911650,75.49781420765028
479290,73.28876712328767
035350,48.576502732240435
476180,53.640547945205476
080840,57.58196721311475
062100,50.752459016393445
028760,36.446961325966846
723105,64.15737704918034
722269,67.22213114754099
479420,72.00690607734806
477780,62.62978142076503
477840,59.74767123287672
478290,61.26657534246575
123000,48.34617486338798
474280,50.54520547945206
722485,67.51584699453552
725755,53.6983606557377
064280,51.329201101928376
478990,61.5227397260274
723710,62.6035519125683
725070,53.79016393442623
061470,47.80573770491803
725025,56.980054644808746
722541,67.21120218579235
726667,49.47158469945356
039230,47.621857923497274
724463,61.24999999999999
722195,63.84426229508197
722906,65.36311475409835
030940,40.89310344827586
699604,76.36675824175825
027140,34.70445682451254
476200,51.984931506849314
124650,47.64672131147541
476550,61.50464480874316
723927,59.90523415977962
121050,47.154371584699454
724920,61.2655737704918
723676,62.660109289617495
727850,49.21147540983606
031550,45.41639344262295
722180,64.80081967213114
Query:
-- Corrected Query 20: List stations and the total number of valid temperature observations from 2011 to 2020.
SELECT s."usaf", s."wban", s."name", COUNT(*) AS "valid_temp_observations_2011_to_2020"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN (
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019" WHERE "temp" IS NOT NULL
    UNION ALL
    SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020" WHERE "temp" IS NOT NULL
) g
ON s."usaf" = g."stn" AND s."wban" = g."wban"
GROUP BY s."usaf", s."wban", s."name"
LIMIT 100
Answer:
usaf,wban,name,valid_temp_observations_2011_to_2020
575160,99999,JIANGBEI,3642
407980,99999,SHAHRE  KORD,3641
724177,13734,ETRN WV RGNL/SHPHERD FD AP,3650
874530,99999,RIO CUARTO AREA DE MATERIAL,3643
070370,99999,VALLEE DE SEINE,3640
722010,12836,KEY WEST INTERNATIONAL AIRPOR,3647
606110,99999,IN AMENAS,3639
846910,99999,PISCO INTL,3642
722316,12958,NEW ORLEANS NAS,3644
787080,99999,LA MESA INTL,3579
723084,99999,HANOVER CO MUNI,2364
725067,94720,BRNSBL MUNI-BMAN/POL FD AP,3653
722279,53852,PRYOR FIELD REGIONAL ARPT,3627
725214,04849,LORAIN COUNTY RGNL AIRPORT,3648
724468,03967,JOHNSON CO EXECUTIVE ARPT,3653
143080,99999,PAZIN,3641
693254,99999,2 CWSS FMQ-22                ,1242
944290,99999,MOUNT MAGNET AERO,3612
475900,99999,SENDAI,3642
011140,99999,REIPA,3604
722720,93026,BISBEE DOUGLAS INTL ARPT,3380
702770,26438,SEWARD AIRPORT,3614
026640,99999,RONNEBY,3643
725290,14768,GREATER ROCHESTER INTERNATION,3653
724388,14829,GOSHEN MUNICIPAL AIRPORT,3643
720377,13917,NEWPORT MUNICIPAL AIRPORT,2062
999999,53848,NAVAL AUXILIARY LANDING FD,2105
941500,99999,GOVE AIRPORT,3638
076610,99999,CAP CEPET,3246
724237,53803,OWENSBORO-DAVIESS COUNTY AIRP,3609
074380,99999,LA ROCHE,3635
723171,53144,NORTH AUXILIARY AIRFIELD EDWA,3399
717490,99999,THUNDER BAY A,3221
711410,99999,GATESHEAD ISLAND,3148
023250,99999,KLOVSJOHOJDEN,3353
027880,99999,KUOPIO MAANINKA,3533
119680,99999,KOSICE,3642
112250,99999,WEITENSFELD,3594
295510,99999,MARIINSK,3640
714540,99999,WASKESIU LAKE  SASK,3635
044850,99999,SADDLE,715
715420,99999,LA CRETE AGCM,3540
647050,99999,BOUSSO,326
803700,99999,SAN LUIS,3466
170240,99999,INEBOLU,3640
106140,99999,RAMSTEIN AB,3646
406890,99999,BASRAH INTL,3559
471010,99999,CHUNCHEON,3640
654420,99999,KUMASI,2619
994066,99999,WHITEFISH POINT GLOS WEATHER,2824
720644,99999,BUCKEYE MUNI,2019
896660,99999,CAPE ROSS,3636
999999,26494,FAIRBANKS 11 NE              ,3553
998235,99999,NIAGRA INTAKE,3359
999999,63849,BOWLING GREEN 21 NNE         ,3567
724768,24051,GREELEY-WELD COUNTY ARPT,3592
803150,99999,BENITO SALAS,3505
720404,99999,KICKAPOO DOWNTOWN AIRPORT,1336
286610,99999,KURGAN,2916
237340,99999,OKTJABR'SKOE,3010
783480,99999,CAIBARIEN  VILLA CLARA,1839
042410,99999,MANIITSOQ MITTARFIA (SUKKERTO,1101
726130,14755,MT. WASHINGTON OBSERVATORY,3504
747360,93042,MUNICIPAL AIRPORT,3650
743945,14710,MANCHESTER AIRPORT,3653
954820,99999,BIRDSVILLE,3633
722900,23188,SAN DIEGO INTERNATIONAL AIRPO,3653
145570,99999,TUZLA,3638
724019,93773,WAKEFIELD MUNICIPAL ARPT,3646
982320,99999,APARRI,3636
747760,03818,MARIANNA MUNICIPAL AIRPORT,3646
747460,03904,EASTERWOOD FIELD AIRPORT,3653
619960,99999,MARTIN DE VIVIES (ILE AMSTERD,2922
727770,94012,HAVRE CITY-COUNTY AIRPORT,3650
718600,99999,SPRINGBANK A,3639
722106,12835,PAGE FIELD AIRPORT,3653
711870,99999,HOPE,2297
024490,99999,ESKILSTUNA A,3342
238910,99999,BAJKIT,3640
442920,99999,CHINGGIS KHAAN INTL,3642
470160,99999,HYESAN,3636
962530,99999,FATMAWATI SOEKARNO,3638
713290,99999,BEDFORD BASIN,3273
710160,99999,BULLHORN HEADWATERS,2957
715570,99999,MERRITT,3472
712290,99999,MANNING AGDM  ALTA,3516
724065,99999,TIPTON,3410
413150,99999,QAIROON HAIRITI,2928
067980,99999,SCUOL,3642
677790,99999,MOUNT DARWIN,1533
173100,99999,ALANYA,3632
727935,24234,BOEING FLD/KING CO INTL AP,3652
172340,99999,AYDIN,3402
722116,12873,ST PETE-CLWTR INTL AIRPORT,3651
036040,99999,MILFORD HAVEN CONSERVANCY BOA,3640
477770,99999,WAKAYAMA,3620
013700,99999,SKABU,3453
021240,99999,ARJEPLOG,3627
170980,99999,KARS,3642
133780,99999,KOPAONIK,3640
End Exploring Related Columns
Task: Can you provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), and tell me the number of valid temperature observations they have recorded from 2011 to 2020?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), along with the number of valid temperature observations they have recorded from 2011 to 2020, the data can be formatted as follows:

```csv
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
station_id1:str,station_name1:str,longitude1:float,latitude1:float,count1:int
station_id2:str,station_name2:str,longitude2:float,latitude2:float,count2:int
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NEW_YORK_NOAA': {'NEW_YORK': ['CITIBIKE_STATIONS', 'CITIBIKE_TRIPS', 'NYPD_MV_COLLISIONS', 'TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016', 'TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2015', 'TLC_GREEN_TRIPS_2016', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016', 'TREE_CENSUS_1995', 'TREE_CENSUS_2005', 'TREE_CENSUS_2015', 'TREE_SPECIES', '_311_SERVICE_REQUESTS'], 'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-21 06:47:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:47:32 - root - INFO - ```sql
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(*) AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0
    AND ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat";
```
2025-01-21 06:47:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:47:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:47:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:47:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 06:47:34 - snowflake.connector.connection - INFO - closed
2025-01-21 06:47:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:47:34 - root - INFO - itercount: 1
2025-01-21 06:47:34 - root - INFO - 0
2025-01-21 06:47:34 - root - INFO - results: 
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
997186,WESTERN LONG ISLAND SOUND,-73.58,40.96,1532
725086,DANBURY MUNICIPAL AIRPORT,-73.483,41.371,3649
725037,WESTCHESTER COUNTY AIRPORT,-73.705,41.062,3653


2025-01-21 06:47:34 - root - INFO - Please check the answer again by reviewing Can you provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), and tell me the number of valid temperature observations they have recorded from 2011 to 2020?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), along with the number of valid temperature observations they have recorded from 2011 to 2020, the data can be formatted as follows:

```csv
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
station_id1:str,station_name1:str,longitude1:float,latitude1:float,count1:int
station_id2:str,station_name2:str,longitude2:float,latitude2:float,count2:int
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
997186,WESTERN LONG ISLAND SOUND,-73.58,40.96,1532
725086,DANBURY MUNICIPAL AIRPORT,-73.483,41.371,3649
725037,WESTCHESTER COUNTY AIRPORT,-73.705,41.062,3653
Current sql:
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    s."lon" AS "longitude",
    s."lat" AS "latitude",
    COUNT(*) AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        WHERE "temp" IS NOT NULL
        UNION ALL
        SELECT "stn", "wban", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0
    AND ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat";
2025-01-21 06:49:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 06:49:18 - root - INFO - To provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), along with the number of valid temperature observations they have recorded from 2011 to 2020, the data can be formatted as follows:

```csv
station_id,station_name,longitude,latitude,number_of_valid_temp_observations
997186,WESTERN LONG ISLAND SOUND,-73.5800,40.9600,1532
725086,DANBURY MUNICIPAL AIRPORT,-73.4830,41.3710,3649
725037,WESTCHESTER COUNTY AIRPORT,-73.7050,41.0620,3653
```

The final SQL query is:

```sql
SELECT
    s."usaf" AS "station_id",
    s."name" AS "station_name",
    ROUND(s."lon", 4) AS "longitude",
    ROUND(s."lat", 4) AS "latitude",
    COUNT(*) AS "number_of_valid_temp_observations"
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "wban", "temp"
        FROM
            (
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
                UNION ALL
                SELECT "stn", "wban", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
            ) AS all_years
        WHERE "temp" IS NOT NULL
    ) g
    ON s."usaf" = g."stn" AND s."wban" = g."wban"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL AND s."lat" != 0 AND s."lon" != 0
    AND ST_DWITHIN(
        ST_MAKEPOINT(s."lon", s."lat"),
        ST_MAKEPOINT(-73.764, 41.197),
        32186.8  -- 20 miles in meters
    )
GROUP BY
    s."usaf",
    s."name",
    s."lon",
    s."lat";
```
2025-01-21 06:49:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 06:49:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 06:49:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 06:49:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 06:49:20 - snowflake.connector.connection - INFO - closed
2025-01-21 06:49:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 06:49:21 - root - INFO - itercount: 2
2025-01-21 06:49:21 - root - INFO - 0
2025-01-21 06:49:21 - root - INFO - Total iteration counts: 2
